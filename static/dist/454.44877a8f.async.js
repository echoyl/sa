!(function(){var Gm=(He,w,x)=>new Promise((F,z)=>{var h=X=>{try{P(x.next(X))}catch(W){z(W)}},D=X=>{try{P(x.throw(X))}catch(W){z(W)}},P=X=>X.done?F(X.value):Promise.resolve(X.value).then(h,D);P((x=x.apply(He,w)).next())});(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[454],{25330:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};w.default=x},67303:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var x={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};w.default=x},83647:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};w.default=x},57583:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};w.default=x},29260:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"};w.default=x},64183:function(He,w,x){"use strict";var F=x(67294),z=x(31934),h=function(){return h=Object.assign||function(P){for(var X,W=1,fe=arguments.length;W<fe;W++){X=arguments[W];for(var J in X)Object.prototype.hasOwnProperty.call(X,J)&&(P[J]=X[J])}return P},h.apply(this,arguments)},D=function(P){return F.createElement(z.P,h({},P,{chartType:"Area"}))};w.Z=D},79611:function(He,w,x){"use strict";var F=x(67294),z=x(31934),h=function(){return h=Object.assign||function(P){for(var X,W=1,fe=arguments.length;W<fe;W++){X=arguments[W];for(var J in X)Object.prototype.hasOwnProperty.call(X,J)&&(P[J]=X[J])}return P},h.apply(this,arguments)},D=function(P){return F.createElement(z.P,h({},P,{chartType:"Bar"}))};w.Z=D},78677:function(He,w,x){"use strict";var F=x(67294),z=x(31934),h=function(){return h=Object.assign||function(P){for(var X,W=1,fe=arguments.length;W<fe;W++){X=arguments[W];for(var J in X)Object.prototype.hasOwnProperty.call(X,J)&&(P[J]=X[J])}return P},h.apply(this,arguments)},D=function(P){return F.createElement(z.P,h({},P,{chartType:"Column"}))};w.Z=D},63430:function(He,w,x){"use strict";var F=x(67294),z=x(31934),h=function(){return h=Object.assign||function(P){for(var X,W=1,fe=arguments.length;W<fe;W++){X=arguments[W];for(var J in X)Object.prototype.hasOwnProperty.call(X,J)&&(P[J]=X[J])}return P},h.apply(this,arguments)},D=function(P){return F.createElement(z.P,h({},P,{chartType:"Pie"}))};w.Z=D},6466:function(He,w,x){"use strict";x.d(w,{Z:function(){return Ze}});var F=x(4942),z=x(1413),h=x(45987),D=x(28459),P=x(93967),X=x.n(P),W=x(67294),fe=x(72120),J=x(44962),Be=x(98082),B=function(se){return(0,F.Z)({},se.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:se.marginLG,marginInline:0,color:se.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function ee(pe){return(0,Be.Xj)("ProCardOperation",function(se){var be=(0,z.Z)((0,z.Z)({},se),{},{componentCls:".".concat(pe)});return[B(be)]})}var U=x(85893),q=function(se){var be=se.className,Te=se.style,de=Te===void 0?{}:Te,Rt=se.children,ye=(0,W.useContext)(D.ZP.ConfigContext),Ve=ye.getPrefixCls,oe=Ve("pro-card-operation"),Re=ee(oe),Se=Re.wrapSSR,et=Re.hashId,st=X()(oe,be,et);return Se((0,U.jsx)("div",{className:st,style:de,children:Rt}))},le=q,j=x(96604),Ce=function(se){return(0,F.Z)({},se.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,F.Z)({flexDirection:"row"},"".concat(se.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(se.colorBorder)}})};function $e(pe){return(0,Be.Xj)("StatisticCard",function(se){var be=(0,z.Z)((0,z.Z)({},se),{},{componentCls:".".concat(pe)});return[Ce(be)]})}var Fe=["children","statistic","className","chart","chartPlacement","footer"],lt=function(se){var be=se.children,Te=se.statistic,de=se.className,Rt=se.chart,ye=se.chartPlacement,Ve=se.footer,oe=(0,h.Z)(se,Fe),Re=(0,W.useContext)(D.ZP.ConfigContext),Se=Re.getPrefixCls,et=Se("pro-statistic-card"),st=$e(et),pt=st.wrapSSR,bt=st.hashId,ke=X()(et,de,bt),ur=Te&&(0,U.jsx)(j.Z,(0,z.Z)({layout:"vertical"},Te)),qt=X()("".concat(et,"-chart"),bt,(0,F.Z)((0,F.Z)({},"".concat(et,"-chart-left"),ye==="left"&&Rt&&Te),"".concat(et,"-chart-right"),ye==="right"&&Rt&&Te)),_n=Rt&&(0,U.jsx)("div",{className:qt,children:Rt}),Zr=X()("".concat(et,"-content "),bt,(0,F.Z)({},"".concat(et,"-content-horizontal"),ye==="left"||ye==="right")),Vr=(_n||ur)&&(ye==="left"?(0,U.jsxs)("div",{className:Zr,children:[_n,ur]}):(0,U.jsxs)("div",{className:Zr,children:[ur,_n]})),rn=Ve&&(0,U.jsx)("div",{className:"".concat(et,"-footer ").concat(bt).trim(),children:Ve});return pt((0,U.jsxs)(fe.Z,(0,z.Z)((0,z.Z)({className:ke},oe),{},{children:[Vr,be,rn]})))},We=function(se){return(0,U.jsx)(lt,(0,z.Z)({bodyStyle:{padding:0}},se))};lt.Statistic=j.Z,lt.Divider=J.Z,lt.Operation=le,lt.isProCard=!0,lt.Group=We;var Ze=lt},96604:function(He,w,x){"use strict";x.d(w,{Z:function(){return ln}});var F=x(1413),z=x(4942),h=x(45987),D=x(87462),P=x(67294),X=x(36688),W=x(5627),fe=function($t,_r){return P.createElement(W.Z,(0,D.Z)({},$t,{ref:_r,icon:X.Z}))},J=P.forwardRef(fe),Be=x(28459),B=x(83062),ee=x(40411),U=x(57838),q=x(96159),le=x(93967),j=x.n(le),Ce=x(64217),$e=x(53124),Fe=x(87564),We=vn=>{const{value:$t,formatter:_r,precision:kt,decimalSeparator:qe,groupSeparator:Sr="",prefixCls:Pe}=vn;let Hr;if(typeof _r=="function")Hr=_r($t);else{const vr=String($t),Ie=vr.match(/^(-?)(\d*)(\.(\d+))?$/);if(!Ie||vr==="-")Hr=vr;else{const gr=Ie[1];let Wr=Ie[2]||"0",Dr=Ie[4]||"";Wr=Wr.replace(/\B(?=(\d{3})+(?!\d))/g,Sr),typeof kt=="number"&&(Dr=Dr.padEnd(kt,"0").slice(0,kt>0?kt:0)),Dr&&(Dr=`${qe}${Dr}`),Hr=[P.createElement("span",{key:"int",className:`${Pe}-content-value-int`},gr,Wr),Dr&&P.createElement("span",{key:"decimal",className:`${Pe}-content-value-decimal`},Dr)]}}return P.createElement("span",{className:`${Pe}-content-value`},Hr)},Ze=x(14747),pe=x(91945),se=x(45503);const be=vn=>{const{componentCls:$t,marginXXS:_r,padding:kt,colorTextDescription:qe,titleFontSize:Sr,colorTextHeading:Pe,contentFontSize:Hr,fontFamily:vr}=vn;return{[`${$t}`]:Object.assign(Object.assign({},(0,Ze.Wf)(vn)),{[`${$t}-title`]:{marginBottom:_r,color:qe,fontSize:Sr},[`${$t}-skeleton`]:{paddingTop:kt},[`${$t}-content`]:{color:Pe,fontSize:Hr,fontFamily:vr,[`${$t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${$t}-content-prefix, ${$t}-content-suffix`]:{display:"inline-block"},[`${$t}-content-prefix`]:{marginInlineEnd:_r},[`${$t}-content-suffix`]:{marginInlineStart:_r}}})}},Te=vn=>{const{fontSizeHeading3:$t,fontSize:_r}=vn;return{titleFontSize:_r,contentFontSize:$t}};var de=(0,pe.I$)("Statistic",vn=>{const $t=(0,se.TS)(vn,{});return[be($t)]},Te),Rt=function(vn,$t){var _r={};for(var kt in vn)Object.prototype.hasOwnProperty.call(vn,kt)&&$t.indexOf(kt)<0&&(_r[kt]=vn[kt]);if(vn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var qe=0,kt=Object.getOwnPropertySymbols(vn);qe<kt.length;qe++)$t.indexOf(kt[qe])<0&&Object.prototype.propertyIsEnumerable.call(vn,kt[qe])&&(_r[kt[qe]]=vn[kt[qe]]);return _r},Ve=vn=>{const{prefixCls:$t,className:_r,rootClassName:kt,style:qe,valueStyle:Sr,value:Pe=0,title:Hr,valueRender:vr,prefix:Ie,suffix:gr,loading:Wr=!1,formatter:Dr,precision:Xr,decimalSeparator:Vn=".",groupSeparator:ni=",",onMouseEnter:Dn,onMouseLeave:Jn}=vn,Yi=Rt(vn,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:bi,direction:ui,statistic:pi}=P.useContext($e.E_),it=bi("statistic",$t),[V,H,Ee]=de(it),Le=P.createElement(We,{decimalSeparator:Vn,groupSeparator:ni,prefixCls:it,formatter:Dr,precision:Xr,value:Pe}),ze=j()(it,{[`${it}-rtl`]:ui==="rtl"},pi==null?void 0:pi.className,_r,kt,H,Ee),xt=(0,Ce.Z)(Yi,{aria:!0,data:!0});return V(P.createElement("div",Object.assign({},xt,{className:ze,style:Object.assign(Object.assign({},pi==null?void 0:pi.style),qe),onMouseEnter:Dn,onMouseLeave:Jn}),Hr&&P.createElement("div",{className:`${it}-title`},Hr),P.createElement(Fe.Z,{paragraph:!1,loading:Wr,className:`${it}-skeleton`},P.createElement("div",{style:Sr,className:`${it}-content`},Ie&&P.createElement("span",{className:`${it}-content-prefix`},Ie),vr?vr(Le):Le,gr&&P.createElement("span",{className:`${it}-content-suffix`},gr)))))};const oe=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Re(vn,$t){let _r=vn;const kt=/\[[^\]]*]/g,qe=($t.match(kt)||[]).map(vr=>vr.slice(1,-1)),Sr=$t.replace(kt,"[]"),Pe=oe.reduce((vr,Ie)=>{let[gr,Wr]=Ie;if(vr.includes(gr)){const Dr=Math.floor(_r/Wr);return _r-=Dr*Wr,vr.replace(new RegExp(`${gr}+`,"g"),Xr=>{const Vn=Xr.length;return Dr.toString().padStart(Vn,"0")})}return vr},Sr);let Hr=0;return Pe.replace(kt,()=>{const vr=qe[Hr];return Hr+=1,vr})}function Se(vn,$t){const{format:_r=""}=$t,kt=new Date(vn).getTime(),qe=Date.now(),Sr=Math.max(kt-qe,0);return Re(Sr,_r)}var et=function(vn,$t){var _r={};for(var kt in vn)Object.prototype.hasOwnProperty.call(vn,kt)&&$t.indexOf(kt)<0&&(_r[kt]=vn[kt]);if(vn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var qe=0,kt=Object.getOwnPropertySymbols(vn);qe<kt.length;qe++)$t.indexOf(kt[qe])<0&&Object.prototype.propertyIsEnumerable.call(vn,kt[qe])&&(_r[kt[qe]]=vn[kt[qe]]);return _r};const st=1e3/30;function pt(vn){return new Date(vn).getTime()}const bt=vn=>{const{value:$t,format:_r="HH:mm:ss",onChange:kt,onFinish:qe}=vn,Sr=et(vn,["value","format","onChange","onFinish"]),Pe=(0,U.Z)(),Hr=P.useRef(null),vr=()=>{qe==null||qe(),Hr.current&&(clearInterval(Hr.current),Hr.current=null)},Ie=()=>{const Dr=pt($t);Dr>=Date.now()&&(Hr.current=setInterval(()=>{Pe(),kt==null||kt(Dr-Date.now()),Dr<Date.now()&&vr()},st))};P.useEffect(()=>(Ie(),()=>{Hr.current&&(clearInterval(Hr.current),Hr.current=null)}),[$t]);const gr=(Dr,Xr)=>Se(Dr,Object.assign(Object.assign({},Xr),{format:_r})),Wr=Dr=>(0,q.Tm)(Dr,{title:void 0});return P.createElement(Ve,Object.assign({},Sr,{value:$t,valueRender:Wr,formatter:gr}))};var ke=P.memo(bt);Ve.Countdown=ke;var ur=Ve,qt=x(98082),_n=function($t){return(0,z.Z)({},$t.componentCls,(0,z.Z)((0,z.Z)((0,z.Z)((0,z.Z)((0,z.Z)({display:"flex",fontSize:$t.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,z.Z)({display:"flex",width:"100%"},"".concat($t.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,z.Z)({width:"100%"},"".concat($t.antCls,"-statistic-content"),{"&-value-int":{fontSize:$t.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat($t.antCls,"-statistic-title"),{color:$t.colorText}),"&-trend-up",(0,z.Z)({},"".concat($t.antCls,"-statistic-content"),(0,z.Z)({color:"#f5222d"},"".concat($t.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,z.Z)({},"".concat($t.antCls,"-statistic-content"),(0,z.Z)({color:"#389e0d"},"".concat($t.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,z.Z)((0,z.Z)((0,z.Z)({display:"flex",justifyContent:"space-between"},"".concat($t.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat($t.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat($t.antCls,"-statistic-title,").concat($t.antCls,"-statistic-content,").concat($t.antCls,"-statistic-content-suffix,").concat($t.antCls,"-statistic-content-prefix,").concat($t.antCls,"-statistic-content-value-decimal"),{fontSize:$t.fontSize})),"& &-layout-inline",(0,z.Z)((0,z.Z)((0,z.Z)({display:"inline-flex",color:$t.colorTextSecondary},"".concat($t.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat($t.antCls,"-statistic-content"),{color:$t.colorTextSecondary}),"".concat($t.antCls,"-statistic-title,").concat($t.antCls,"-statistic-content,").concat($t.antCls,"-statistic-content-suffix,").concat($t.antCls,"-statistic-content-prefix,").concat($t.antCls,"-statistic-content-value-decimal"),{fontSize:$t.fontSizeSM})))};function Zr(vn){return(0,qt.Xj)("Statistic",function($t){var _r=(0,F.Z)((0,F.Z)({},$t),{},{componentCls:".".concat(vn)});return[_n(_r)]})}var Vr=x(85893),rn=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],Qr=function($t){var _r=$t.className,kt=$t.layout,qe=kt===void 0?"inline":kt,Sr=$t.style,Pe=$t.description,Hr=$t.children,vr=$t.title,Ie=$t.tip,gr=$t.status,Wr=$t.trend,Dr=$t.prefix,Xr=$t.icon,Vn=(0,h.Z)($t,rn),ni=(0,P.useContext)(Be.ZP.ConfigContext),Dn=ni.getPrefixCls,Jn=Dn("pro-card-statistic"),Yi=Zr(Jn),bi=Yi.wrapSSR,ui=Yi.hashId,pi=j()(Jn,_r,ui),it=j()("".concat(Jn,"-status"),ui),V=j()("".concat(Jn,"-icon"),ui),H=j()("".concat(Jn,"-wrapper"),ui),Ee=j()("".concat(Jn,"-content"),ui),Le=j()(ui,(0,z.Z)((0,z.Z)({},"".concat(Jn,"-layout-").concat(qe),qe),"".concat(Jn,"-trend-").concat(Wr),Wr)),ze=Ie&&(0,Vr.jsx)(B.Z,{title:Ie,children:(0,Vr.jsx)(J,{className:"".concat(Jn,"-tip ").concat(ui).trim()})}),xt=j()("".concat(Jn,"-trend-icon"),ui,(0,z.Z)({},"".concat(Jn,"-trend-icon-").concat(Wr),Wr)),Ut=Wr&&(0,Vr.jsx)("div",{className:xt}),ir=gr&&(0,Vr.jsx)("div",{className:it,children:(0,Vr.jsx)(ee.Z,{status:gr,text:null})}),Ft=Xr&&(0,Vr.jsx)("div",{className:V,children:Xr});return bi((0,Vr.jsxs)("div",{className:pi,style:Sr,children:[Ft,(0,Vr.jsxs)("div",{className:H,children:[ir,(0,Vr.jsxs)("div",{className:Ee,children:[(0,Vr.jsx)(ur,(0,F.Z)({title:(vr||ze)&&(0,Vr.jsxs)(Vr.Fragment,{children:[vr,ze]}),prefix:(Ut||Dr)&&(0,Vr.jsxs)(Vr.Fragment,{children:[Ut,Dr]}),className:Le},Vn)),Pe&&(0,Vr.jsx)("div",{className:"".concat(Jn,"-description ").concat(ui).trim(),children:Pe})]})]})]}))},ln=Qr},46343:function(He,w,x){"use strict";x.d(w,{S$:function(){return $t},bf:function(){return _r},ni:function(){return ke},oI:function(){return ln},sX:function(){return vn}});var F=x(34155);function z(kt,qe,Sr,Pe){function Hr(vr){return vr instanceof Sr?vr:new Sr(function(Ie){Ie(vr)})}return new(Sr||(Sr=Promise))(function(vr,Ie){function gr(Xr){try{Dr(Pe.next(Xr))}catch(Vn){Ie(Vn)}}function Wr(Xr){try{Dr(Pe.throw(Xr))}catch(Vn){Ie(Vn)}}function Dr(Xr){Xr.done?vr(Xr.value):Hr(Xr.value).then(gr,Wr)}Dr((Pe=Pe.apply(kt,qe||[])).next())})}function h(kt,qe){var Sr={label:0,sent:function(){if(vr[0]&1)throw vr[1];return vr[1]},trys:[],ops:[]},Pe,Hr,vr,Ie;return Ie={next:gr(0),throw:gr(1),return:gr(2)},typeof Symbol=="function"&&(Ie[Symbol.iterator]=function(){return this}),Ie;function gr(Dr){return function(Xr){return Wr([Dr,Xr])}}function Wr(Dr){if(Pe)throw new TypeError("Generator is already executing.");for(;Sr;)try{if(Pe=1,Hr&&(vr=Dr[0]&2?Hr.return:Dr[0]?Hr.throw||((vr=Hr.return)&&vr.call(Hr),0):Hr.next)&&!(vr=vr.call(Hr,Dr[1])).done)return vr;switch(Hr=0,vr&&(Dr=[Dr[0]&2,vr.value]),Dr[0]){case 0:case 1:vr=Dr;break;case 4:return Sr.label++,{value:Dr[1],done:!1};case 5:Sr.label++,Hr=Dr[1],Dr=[0];continue;case 7:Dr=Sr.ops.pop(),Sr.trys.pop();continue;default:if(vr=Sr.trys,!(vr=vr.length>0&&vr[vr.length-1])&&(Dr[0]===6||Dr[0]===2)){Sr=0;continue}if(Dr[0]===3&&(!vr||Dr[1]>vr[0]&&Dr[1]<vr[3])){Sr.label=Dr[1];break}if(Dr[0]===6&&Sr.label<vr[1]){Sr.label=vr[1],vr=Dr;break}if(vr&&Sr.label<vr[2]){Sr.label=vr[2],Sr.ops.push(Dr);break}vr[2]&&Sr.ops.pop(),Sr.trys.pop();continue}Dr=qe.call(kt,Sr)}catch(Xr){Dr=[6,Xr],Hr=0}finally{Pe=vr=0}if(Dr[0]&5)throw Dr[1];return{value:Dr[0]?Dr[1]:void 0,done:!0}}}function D(kt,qe){var Sr=typeof Symbol=="function"&&kt[Symbol.iterator];if(!Sr)return kt;var Pe=Sr.call(kt),Hr,vr=[],Ie;try{for(;(qe===void 0||qe-- >0)&&!(Hr=Pe.next()).done;)vr.push(Hr.value)}catch(gr){Ie={error:gr}}finally{try{Hr&&!Hr.done&&(Sr=Pe.return)&&Sr.call(Pe)}finally{if(Ie)throw Ie.error}}return vr}function P(kt,qe,Sr){if(Sr||arguments.length===2)for(var Pe=0,Hr=qe.length,vr;Pe<Hr;Pe++)(vr||!(Pe in qe))&&(vr||(vr=Array.prototype.slice.call(qe,0,Pe)),vr[Pe]=qe[Pe]);return kt.concat(vr||Array.prototype.slice.call(qe))}function X(kt){return kt&&kt.__esModule&&Object.prototype.hasOwnProperty.call(kt,"default")?kt.default:kt}var W={exports:{}},fe={exports:{}},J={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Sr;function Sr(Pe){return Pe&&typeof Pe.length=="number"&&Pe.length>=0&&Pe.length%1===0}kt.exports=qe.default})(J,J.exports);var Be={},B={exports:{}},ee={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=function(Sr){return function(){for(var Pe=[],Hr=arguments.length;Hr--;)Pe[Hr]=arguments[Hr];var vr=Pe.pop();return Sr.call(this,Pe,vr)}},kt.exports=qe.default})(ee,ee.exports);var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.fallback=Ce,U.wrap=$e;var q=U.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,le=U.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,j=U.hasNextTick=typeof F=="object"&&typeof F.nextTick=="function";function Ce(kt){setTimeout(kt,0)}function $e(kt){return function(qe){for(var Sr=[],Pe=arguments.length-1;Pe-- >0;)Sr[Pe]=arguments[Pe+1];return kt(function(){return qe.apply(void 0,Sr)})}}var Fe;q?Fe=queueMicrotask:le?Fe=setImmediate:j?Fe=F.nextTick:Fe=Ce,U.default=$e(Fe),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Wr;var Sr=ee.exports,Pe=gr(Sr),Hr=U,vr=gr(Hr),Ie=Be;function gr(Vn){return Vn&&Vn.__esModule?Vn:{default:Vn}}function Wr(Vn){return(0,Ie.isAsync)(Vn)?function(){for(var ni=[],Dn=arguments.length;Dn--;)ni[Dn]=arguments[Dn];var Jn=ni.pop(),Yi=Vn.apply(this,ni);return Dr(Yi,Jn)}:(0,Pe.default)(function(ni,Dn){var Jn;try{Jn=Vn.apply(this,ni)}catch(Yi){return Dn(Yi)}if(Jn&&typeof Jn.then=="function")return Dr(Jn,Dn);Dn(null,Jn)})}function Dr(Vn,ni){return Vn.then(function(Dn){Xr(ni,null,Dn)},function(Dn){Xr(ni,Dn&&Dn.message?Dn:new Error(Dn))})}function Xr(Vn,ni,Dn){try{Vn(ni,Dn)}catch(Jn){(0,vr.default)(function(Yi){throw Yi},Jn)}}kt.exports=qe.default}(B,B.exports),Object.defineProperty(Be,"__esModule",{value:!0}),Be.isAsyncIterable=Be.isAsyncGenerator=Be.isAsync=void 0;var lt=B.exports,We=Ze(lt);function Ze(kt){return kt&&kt.__esModule?kt:{default:kt}}function pe(kt){return kt[Symbol.toStringTag]==="AsyncFunction"}function se(kt){return kt[Symbol.toStringTag]==="AsyncGenerator"}function be(kt){return typeof kt[Symbol.asyncIterator]=="function"}function Te(kt){if(typeof kt!="function")throw new Error("expected a function");return pe(kt)?(0,We.default)(kt):kt}Be.default=Te,Be.isAsync=pe,Be.isAsyncGenerator=se,Be.isAsyncIterable=be;var de={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Sr;function Sr(Pe,Hr){if(Hr===void 0&&(Hr=Pe.length),!Hr)throw new Error("arity is undefined");function vr(){for(var Ie=this,gr=[],Wr=arguments.length;Wr--;)gr[Wr]=arguments[Wr];return typeof gr[Hr-1]=="function"?Pe.apply(this,gr):new Promise(function(Dr,Xr){gr[Hr-1]=function(Vn){for(var ni=[],Dn=arguments.length-1;Dn-- >0;)ni[Dn]=arguments[Dn+1];if(Vn)return Xr(Vn);Dr(ni.length>1?ni:ni[0])},Pe.apply(Ie,gr)})}return vr}kt.exports=qe.default})(de,de.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=J.exports,Pe=Wr(Sr),Hr=Be,vr=Wr(Hr),Ie=de.exports,gr=Wr(Ie);function Wr(Dr){return Dr&&Dr.__esModule?Dr:{default:Dr}}qe.default=(0,gr.default)(function(Dr,Xr,Vn){var ni=(0,Pe.default)(Xr)?[]:{};Dr(Xr,function(Dn,Jn,Yi){(0,vr.default)(Dn)(function(bi){for(var ui,pi=[],it=arguments.length-1;it-- >0;)pi[it]=arguments[it+1];pi.length<2&&(ui=pi,pi=ui[0]),ni[Jn]=pi,Yi(bi)})},function(Dn){return Vn(Dn,ni)})},3),kt.exports=qe.default}(fe,fe.exports);var Rt={exports:{}},ye={exports:{}},Ve={exports:{}},oe={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Sr;function Sr(Pe){function Hr(){for(var vr=[],Ie=arguments.length;Ie--;)vr[Ie]=arguments[Ie];if(Pe!==null){var gr=Pe;Pe=null,gr.apply(this,vr)}}return Object.assign(Hr,Pe),Hr}kt.exports=qe.default})(oe,oe.exports);var Re={exports:{}},Se={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=function(Sr){return Sr[Symbol.iterator]&&Sr[Symbol.iterator]()},kt.exports=qe.default})(Se,Se.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Xr;var Sr=J.exports,Pe=Ie(Sr),Hr=Se.exports,vr=Ie(Hr);function Ie(Vn){return Vn&&Vn.__esModule?Vn:{default:Vn}}function gr(Vn){var ni=-1,Dn=Vn.length;return function(){return++ni<Dn?{value:Vn[ni],key:ni}:null}}function Wr(Vn){var ni=-1;return function(){var Jn=Vn.next();return Jn.done?null:(ni++,{value:Jn.value,key:ni})}}function Dr(Vn){var ni=Vn?Object.keys(Vn):[],Dn=-1,Jn=ni.length;return function Yi(){var bi=ni[++Dn];return bi==="__proto__"?Yi():Dn<Jn?{value:Vn[bi],key:bi}:null}}function Xr(Vn){if((0,Pe.default)(Vn))return gr(Vn);var ni=(0,vr.default)(Vn);return ni?Wr(ni):Dr(Vn)}kt.exports=qe.default}(Re,Re.exports);var et={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Sr;function Sr(Pe){return function(){for(var Hr=[],vr=arguments.length;vr--;)Hr[vr]=arguments[vr];if(Pe===null)throw new Error("Callback was already called.");var Ie=Pe;Pe=null,Ie.apply(this,Hr)}}kt.exports=qe.default})(et,et.exports);var st={exports:{}},pt={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr={};qe.default=Sr,kt.exports=qe.default})(pt,pt.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=vr;var Sr=pt.exports,Pe=Hr(Sr);function Hr(Ie){return Ie&&Ie.__esModule?Ie:{default:Ie}}function vr(Ie,gr,Wr,Dr){var Xr=!1,Vn=!1,ni=!1,Dn=0,Jn=0;function Yi(){Dn>=gr||ni||Xr||(ni=!0,Ie.next().then(function(pi){var it=pi.value,V=pi.done;if(!(Vn||Xr)){if(ni=!1,V){Xr=!0,Dn<=0&&Dr(null);return}Dn++,Wr(it,Jn,bi),Jn++,Yi()}}).catch(ui))}function bi(pi,it){if(Dn-=1,!Vn){if(pi)return ui(pi);if(pi===!1){Xr=!0,Vn=!0;return}if(it===Pe.default||Xr&&Dn<=0)return Xr=!0,Dr(null);Yi()}}function ui(pi){Vn||(ni=!1,Xr=!0,Dr(pi))}Yi()}kt.exports=qe.default}(st,st.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=oe.exports,Pe=Dn(Sr),Hr=Re.exports,vr=Dn(Hr),Ie=et.exports,gr=Dn(Ie),Wr=Be,Dr=st.exports,Xr=Dn(Dr),Vn=pt.exports,ni=Dn(Vn);function Dn(Jn){return Jn&&Jn.__esModule?Jn:{default:Jn}}qe.default=function(Jn){return function(Yi,bi,ui){if(ui=(0,Pe.default)(ui),Jn<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Yi)return ui(null);if((0,Wr.isAsyncGenerator)(Yi))return(0,Xr.default)(Yi,Jn,bi,ui);if((0,Wr.isAsyncIterable)(Yi))return(0,Xr.default)(Yi[Symbol.asyncIterator](),Jn,bi,ui);var pi=(0,vr.default)(Yi),it=!1,V=!1,H=0,Ee=!1;function Le(xt,Ut){if(!V)if(H-=1,xt)it=!0,ui(xt);else if(xt===!1)it=!0,V=!0;else{if(Ut===ni.default||it&&H<=0)return it=!0,ui(null);Ee||ze()}}function ze(){for(Ee=!0;H<Jn&&!it;){var xt=pi();if(xt===null){it=!0,H<=0&&ui(null);return}H+=1,bi(xt.value,xt.key,(0,gr.default)(Le))}Ee=!1}ze()}},kt.exports=qe.default}(Ve,Ve.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=Ve.exports,Pe=Wr(Sr),Hr=Be,vr=Wr(Hr),Ie=de.exports,gr=Wr(Ie);function Wr(Xr){return Xr&&Xr.__esModule?Xr:{default:Xr}}function Dr(Xr,Vn,ni,Dn){return(0,Pe.default)(Vn)(Xr,(0,vr.default)(ni),Dn)}qe.default=(0,gr.default)(Dr,4),kt.exports=qe.default}(ye,ye.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=ye.exports,Pe=Ie(Sr),Hr=de.exports,vr=Ie(Hr);function Ie(Wr){return Wr&&Wr.__esModule?Wr:{default:Wr}}function gr(Wr,Dr,Xr){return(0,Pe.default)(Wr,1,Dr,Xr)}qe.default=(0,vr.default)(gr,3),kt.exports=qe.default}(Rt,Rt.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=gr;var Sr=fe.exports,Pe=Ie(Sr),Hr=Rt.exports,vr=Ie(Hr);function Ie(Wr){return Wr&&Wr.__esModule?Wr:{default:Wr}}function gr(Wr,Dr){return(0,Pe.default)(vr.default,Wr,Dr)}kt.exports=qe.default}(W,W.exports);var bt=X(W.exports),ke=function(){function kt(){this.args=[],this.tasks=[]}return kt.prototype.call=function(){for(var qe=arguments,Sr=[],Pe=0;Pe<arguments.length;Pe++)Sr[Pe]=qe[Pe];return this.args=Sr,bt(this.tasks)},kt.prototype.tap=function(qe,Sr){var Pe=this;this.tasks.push(function(Hr){Sr.apply(void 0,P([],D(Pe.args),!1)),Hr(null,qe)})},kt}(),ur={exports:{}},qt={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=J.exports,Pe=bi(Sr),Hr=pt.exports,vr=bi(Hr),Ie=ye.exports,gr=bi(Ie),Wr=oe.exports,Dr=bi(Wr),Xr=et.exports,Vn=bi(Xr),ni=Be,Dn=bi(ni),Jn=de.exports,Yi=bi(Jn);function bi(V){return V&&V.__esModule?V:{default:V}}function ui(V,H,Ee){Ee=(0,Dr.default)(Ee);var Le=0,ze=0,xt=V.length,Ut=!1;xt===0&&Ee(null);function ir(Ft,te){Ft===!1&&(Ut=!0),Ut!==!0&&(Ft?Ee(Ft):(++ze===xt||te===vr.default)&&Ee(null))}for(;Le<xt;Le++)H(V[Le],Le,(0,Vn.default)(ir))}function pi(V,H,Ee){return(0,gr.default)(V,1/0,H,Ee)}function it(V,H,Ee){var Le=(0,Pe.default)(V)?ui:pi;return Le(V,(0,Dn.default)(H),Ee)}qe.default=(0,Yi.default)(it,3),kt.exports=qe.default})(qt,qt.exports),function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=gr;var Sr=qt.exports,Pe=Ie(Sr),Hr=fe.exports,vr=Ie(Hr);function Ie(Wr){return Wr&&Wr.__esModule?Wr:{default:Wr}}function gr(Wr,Dr){return(0,vr.default)(Pe.default,Wr,Dr)}kt.exports=qe.default}(ur,ur.exports);var _n=X(ur.exports),Zr=function(){function kt(){this.tasks=[]}return kt.prototype.promise=function(){return _n(this.tasks)},kt.prototype.tapPromise=function(qe,Sr){var Pe=this;this.tasks.push(function(Hr){return z(Pe,void 0,void 0,function(){return h(this,function(vr){switch(vr.label){case 0:return[4,Sr()];case 1:return vr.sent(),Hr(null,qe),[2]}})})})},kt}(),Vr={exports:{}};(function(kt,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Sr=oe.exports,Pe=Xr(Sr),Hr=et.exports,vr=Xr(Hr),Ie=Be,gr=Xr(Ie),Wr=de.exports,Dr=Xr(Wr);function Xr(ni){return ni&&ni.__esModule?ni:{default:ni}}function Vn(ni,Dn){if(Dn=(0,Pe.default)(Dn),!Array.isArray(ni))return Dn(new Error("First argument to waterfall must be an array of functions"));if(!ni.length)return Dn();var Jn=0;function Yi(ui){var pi=(0,gr.default)(ni[Jn++]);pi.apply(void 0,ui.concat([(0,vr.default)(bi)]))}function bi(ui){for(var pi=[],it=arguments.length-1;it-- >0;)pi[it]=arguments[it+1];if(ui!==!1){if(ui||Jn===ni.length)return Dn.apply(void 0,[ui].concat(pi));Yi(pi)}}Yi([])}qe.default=(0,Dr.default)(Vn),kt.exports=qe.default})(Vr,Vr.exports);var rn=X(Vr.exports),Qr=function(){function kt(){this.tasks=[]}return kt.prototype.call=function(){return rn(this.tasks)},kt.prototype.tap=function(qe,Sr){this.tasks.length===0?this.tasks.push(function(Pe){var Hr=Sr();Pe(Hr?null:!1,Hr)}):this.tasks.push(function(Pe,Hr){var vr=Sr.apply(void 0,P([],D(Pe),!1));Hr(vr?null:!1,qe)})},kt}(),ln=function(){function kt(){this.tasks=[]}return kt.prototype.call=function(){return bt(this.tasks)},kt.prototype.tap=function(qe,Sr){this.tasks.push(function(Pe){var Hr=Sr();Pe(Hr,qe)})},kt}(),vn=function(){function kt(){this.args=[],this.tasks=[]}return kt.prototype.promise=function(){for(var qe=arguments,Sr=[],Pe=0;Pe<arguments.length;Pe++)Sr[Pe]=qe[Pe];return this.args=Sr,bt(this.tasks)},kt.prototype.tapPromise=function(qe,Sr){var Pe=this;this.tasks.push(function(Hr){return z(Pe,void 0,void 0,function(){return h(this,function(vr){switch(vr.label){case 0:return[4,Sr.apply(void 0,P([],D(this.args),!1))];case 1:return vr.sent(),Hr(null,qe),[2]}})})})},kt}(),$t=function(){function kt(){this.args=[],this.tasks=[]}return kt.prototype.promise=function(){for(var qe=arguments,Sr=[],Pe=0;Pe<arguments.length;Pe++)Sr[Pe]=qe[Pe];return this.args=Sr,bt(this.tasks)},kt.prototype.tapPromise=function(qe,Sr){var Pe=this;this.tasks.push(function(Hr){return z(Pe,void 0,void 0,function(){var vr;return h(this,function(Ie){switch(Ie.label){case 0:return[4,Sr.apply(void 0,P([],D(this.args),!1))];case 1:return vr=Ie.sent(),Hr(vr,qe),[2]}})})})},kt}(),_r=function(){function kt(){this.tasks=[]}return kt.prototype.promise=function(){return rn(this.tasks)},kt.prototype.tapPromise=function(qe,Sr){this.tasks.length===0?this.tasks.push(function(Pe){Sr().then(function(Hr){Pe(null,Hr)})}):this.tasks.push(function(Pe,Hr){Sr(Pe).then(function(vr){Hr(null,vr)})})},kt}()},90857:function(He){"use strict";var w=Object.prototype.hasOwnProperty,x="~";function F(){}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(x=!1));function z(X,W,fe){this.fn=X,this.context=W,this.once=fe||!1}function h(X,W,fe,J,Be){if(typeof fe!="function")throw new TypeError("The listener must be a function");var B=new z(fe,J||X,Be),ee=x?x+W:W;return X._events[ee]?X._events[ee].fn?X._events[ee]=[X._events[ee],B]:X._events[ee].push(B):(X._events[ee]=B,X._eventsCount++),X}function D(X,W){--X._eventsCount===0?X._events=new F:delete X._events[W]}function P(){this._events=new F,this._eventsCount=0}P.prototype.eventNames=function(){var W=[],fe,J;if(this._eventsCount===0)return W;for(J in fe=this._events)w.call(fe,J)&&W.push(x?J.slice(1):J);return Object.getOwnPropertySymbols?W.concat(Object.getOwnPropertySymbols(fe)):W},P.prototype.listeners=function(W){var fe=x?x+W:W,J=this._events[fe];if(!J)return[];if(J.fn)return[J.fn];for(var Be=0,B=J.length,ee=new Array(B);Be<B;Be++)ee[Be]=J[Be].fn;return ee},P.prototype.listenerCount=function(W){var fe=x?x+W:W,J=this._events[fe];return J?J.fn?1:J.length:0},P.prototype.emit=function(W,fe,J,Be,B,ee){var U=x?x+W:W;if(!this._events[U])return!1;var q=this._events[U],le=arguments.length,j,Ce;if(q.fn){switch(q.once&&this.removeListener(W,q.fn,void 0,!0),le){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,fe),!0;case 3:return q.fn.call(q.context,fe,J),!0;case 4:return q.fn.call(q.context,fe,J,Be),!0;case 5:return q.fn.call(q.context,fe,J,Be,B),!0;case 6:return q.fn.call(q.context,fe,J,Be,B,ee),!0}for(Ce=1,j=new Array(le-1);Ce<le;Ce++)j[Ce-1]=arguments[Ce];q.fn.apply(q.context,j)}else{var $e=q.length,Fe;for(Ce=0;Ce<$e;Ce++)switch(q[Ce].once&&this.removeListener(W,q[Ce].fn,void 0,!0),le){case 1:q[Ce].fn.call(q[Ce].context);break;case 2:q[Ce].fn.call(q[Ce].context,fe);break;case 3:q[Ce].fn.call(q[Ce].context,fe,J);break;case 4:q[Ce].fn.call(q[Ce].context,fe,J,Be);break;default:if(!j)for(Fe=1,j=new Array(le-1);Fe<le;Fe++)j[Fe-1]=arguments[Fe];q[Ce].fn.apply(q[Ce].context,j)}}return!0},P.prototype.on=function(W,fe,J){return h(this,W,fe,J,!1)},P.prototype.once=function(W,fe,J){return h(this,W,fe,J,!0)},P.prototype.removeListener=function(W,fe,J,Be){var B=x?x+W:W;if(!this._events[B])return this;if(!fe)return D(this,B),this;var ee=this._events[B];if(ee.fn)ee.fn===fe&&(!Be||ee.once)&&(!J||ee.context===J)&&D(this,B);else{for(var U=0,q=[],le=ee.length;U<le;U++)(ee[U].fn!==fe||Be&&!ee[U].once||J&&ee[U].context!==J)&&q.push(ee[U]);q.length?this._events[B]=q.length===1?q[0]:q:D(this,B)}return this},P.prototype.removeAllListeners=function(W){var fe;return W?(fe=x?x+W:W,this._events[fe]&&D(this,fe)):(this._events=new F,this._eventsCount=0),this},P.prototype.off=P.prototype.removeListener,P.prototype.addListener=P.prototype.on,P.prefixed=x,P.EventEmitter=P,He.exports=P},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(He){try{let J=function(){P||(P=!0,h())},Be=function(){try{D.documentElement.doScroll("left")}catch(B){return void setTimeout(Be,50)}J()};var W=J,fe=Be,x=(x=document.getElementsByTagName("script"))[x.length-1],w=x.getAttribute("data-injectcss"),x=x.getAttribute("data-disable-injectsvg");if(!x){var F,z,h,D,P,X=function(ee,U){U.parentNode.insertBefore(ee,U)};if(w&&!He.__iconfont__svg__cssinject__){He.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(B){console&&console.log(B)}}F=function(){var ee,U=document.createElement("div");U.innerHTML=He._iconfont_svg_string_3580659,(U=U.getElementsByTagName("svg")[0])&&(U.setAttribute("aria-hidden","true"),U.style.position="absolute",U.style.width=0,U.style.height=0,U.style.overflow="hidden",U=U,(ee=document.body).firstChild?X(U,ee.firstChild):ee.appendChild(U))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(F,0):(z=function(){document.removeEventListener("DOMContentLoaded",z,!1),F()},document.addEventListener("DOMContentLoaded",z,!1)):document.attachEvent&&(h=F,D=He.document,P=!1,Be(),D.onreadystatechange=function(){D.readyState=="complete"&&(D.onreadystatechange=null,J())})}}catch(J){}}(window)},88120:function(He,w,x){"use strict";x.d(w,{GC:function(){return vr},h0:function(){return _r},lv:function(){return Vr},lo:function(){return Qr},kw:function(){return ln},Or:function(){return vn},KD:function(){return Sr},I9:function(){return Ie},lE:function(){return qe},d:function(){return rn},n3:function(){return zl},vY:function(){return Pe},P7:function(){return to},yn:function(){return kt},ee:function(){return Hr},v2:function(){return Bo},e7:function(){return ps},Hp:function(){return Ul},gl:function(){return W},cO:function(){return Ms},Vb:function(){return Ce}});var F=x(1413),z=x(15671),h=x(43144),D=x(4942),P=x(57059),X=function(S){return S.Normal="normal",S.PostProcessing="post-processing",S}({}),W=function(S){return S[S.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",S[S.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",S[S.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",S[S.POINTS=0]="POINTS",S[S.LINES=1]="LINES",S[S.LINE_LOOP=2]="LINE_LOOP",S[S.LINE_STRIP=3]="LINE_STRIP",S[S.TRIANGLES=4]="TRIANGLES",S[S.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",S[S.TRIANGLE_FAN=6]="TRIANGLE_FAN",S[S.ZERO=0]="ZERO",S[S.ONE=1]="ONE",S[S.SRC_COLOR=768]="SRC_COLOR",S[S.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",S[S.SRC_ALPHA=770]="SRC_ALPHA",S[S.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",S[S.DST_ALPHA=772]="DST_ALPHA",S[S.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",S[S.DST_COLOR=774]="DST_COLOR",S[S.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",S[S.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",S[S.FUNC_ADD=32774]="FUNC_ADD",S[S.BLEND_EQUATION=32777]="BLEND_EQUATION",S[S.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",S[S.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",S[S.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",S[S.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",S[S.MAX_EXT=32776]="MAX_EXT",S[S.MIN_EXT=32775]="MIN_EXT",S[S.BLEND_DST_RGB=32968]="BLEND_DST_RGB",S[S.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",S[S.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",S[S.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",S[S.CONSTANT_COLOR=32769]="CONSTANT_COLOR",S[S.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",S[S.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",S[S.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",S[S.BLEND_COLOR=32773]="BLEND_COLOR",S[S.ARRAY_BUFFER=34962]="ARRAY_BUFFER",S[S.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",S[S.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",S[S.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",S[S.STREAM_DRAW=35040]="STREAM_DRAW",S[S.STATIC_DRAW=35044]="STATIC_DRAW",S[S.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",S[S.BUFFER_SIZE=34660]="BUFFER_SIZE",S[S.BUFFER_USAGE=34661]="BUFFER_USAGE",S[S.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",S[S.FRONT=1028]="FRONT",S[S.BACK=1029]="BACK",S[S.FRONT_AND_BACK=1032]="FRONT_AND_BACK",S[S.CULL_FACE=2884]="CULL_FACE",S[S.BLEND=3042]="BLEND",S[S.DITHER=3024]="DITHER",S[S.STENCIL_TEST=2960]="STENCIL_TEST",S[S.DEPTH_TEST=2929]="DEPTH_TEST",S[S.SCISSOR_TEST=3089]="SCISSOR_TEST",S[S.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",S[S.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",S[S.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",S[S.NO_ERROR=0]="NO_ERROR",S[S.INVALID_ENUM=1280]="INVALID_ENUM",S[S.INVALID_VALUE=1281]="INVALID_VALUE",S[S.INVALID_OPERATION=1282]="INVALID_OPERATION",S[S.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",S[S.CW=2304]="CW",S[S.CCW=2305]="CCW",S[S.LINE_WIDTH=2849]="LINE_WIDTH",S[S.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",S[S.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",S[S.CULL_FACE_MODE=2885]="CULL_FACE_MODE",S[S.FRONT_FACE=2886]="FRONT_FACE",S[S.DEPTH_RANGE=2928]="DEPTH_RANGE",S[S.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",S[S.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",S[S.DEPTH_FUNC=2932]="DEPTH_FUNC",S[S.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",S[S.STENCIL_FUNC=2962]="STENCIL_FUNC",S[S.STENCIL_FAIL=2964]="STENCIL_FAIL",S[S.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",S[S.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",S[S.STENCIL_REF=2967]="STENCIL_REF",S[S.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",S[S.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",S[S.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",S[S.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",S[S.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",S[S.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",S[S.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",S[S.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",S[S.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",S[S.VIEWPORT=2978]="VIEWPORT",S[S.SCISSOR_BOX=3088]="SCISSOR_BOX",S[S.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",S[S.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",S[S.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",S[S.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",S[S.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",S[S.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",S[S.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",S[S.RED_BITS=3410]="RED_BITS",S[S.GREEN_BITS=3411]="GREEN_BITS",S[S.BLUE_BITS=3412]="BLUE_BITS",S[S.ALPHA_BITS=3413]="ALPHA_BITS",S[S.DEPTH_BITS=3414]="DEPTH_BITS",S[S.STENCIL_BITS=3415]="STENCIL_BITS",S[S.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",S[S.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",S[S.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",S[S.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",S[S.SAMPLES=32937]="SAMPLES",S[S.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",S[S.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",S[S.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",S[S.DONT_CARE=4352]="DONT_CARE",S[S.FASTEST=4353]="FASTEST",S[S.NICEST=4354]="NICEST",S[S.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",S[S.BYTE=5120]="BYTE",S[S.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",S[S.SHORT=5122]="SHORT",S[S.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",S[S.INT=5124]="INT",S[S.UNSIGNED_INT=5125]="UNSIGNED_INT",S[S.FLOAT=5126]="FLOAT",S[S.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",S[S.ALPHA=6406]="ALPHA",S[S.RGB=6407]="RGB",S[S.RGBA=6408]="RGBA",S[S.LUMINANCE=6409]="LUMINANCE",S[S.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",S[S.RED=6403]="RED",S[S.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",S[S.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",S[S.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",S[S.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",S[S.VERTEX_SHADER=35633]="VERTEX_SHADER",S[S.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",S[S.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",S[S.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",S[S.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",S[S.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",S[S.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",S[S.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",S[S.SHADER_TYPE=35663]="SHADER_TYPE",S[S.DELETE_STATUS=35712]="DELETE_STATUS",S[S.LINK_STATUS=35714]="LINK_STATUS",S[S.VALIDATE_STATUS=35715]="VALIDATE_STATUS",S[S.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",S[S.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",S[S.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",S[S.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",S[S.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",S[S.NEVER=512]="NEVER",S[S.LESS=513]="LESS",S[S.EQUAL=514]="EQUAL",S[S.LEQUAL=515]="LEQUAL",S[S.GREATER=516]="GREATER",S[S.NOTEQUAL=517]="NOTEQUAL",S[S.GEQUAL=518]="GEQUAL",S[S.ALWAYS=519]="ALWAYS",S[S.KEEP=7680]="KEEP",S[S.REPLACE=7681]="REPLACE",S[S.INCR=7682]="INCR",S[S.DECR=7683]="DECR",S[S.INVERT=5386]="INVERT",S[S.INCR_WRAP=34055]="INCR_WRAP",S[S.DECR_WRAP=34056]="DECR_WRAP",S[S.VENDOR=7936]="VENDOR",S[S.RENDERER=7937]="RENDERER",S[S.VERSION=7938]="VERSION",S[S.NEAREST=9728]="NEAREST",S[S.LINEAR=9729]="LINEAR",S[S.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",S[S.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",S[S.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",S[S.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",S[S.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",S[S.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",S[S.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",S[S.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",S[S.TEXTURE_2D=3553]="TEXTURE_2D",S[S.TEXTURE=5890]="TEXTURE",S[S.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",S[S.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",S[S.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",S[S.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",S[S.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",S[S.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",S[S.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",S[S.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",S[S.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",S[S.TEXTURE0=33984]="TEXTURE0",S[S.TEXTURE1=33985]="TEXTURE1",S[S.TEXTURE2=33986]="TEXTURE2",S[S.TEXTURE3=33987]="TEXTURE3",S[S.TEXTURE4=33988]="TEXTURE4",S[S.TEXTURE5=33989]="TEXTURE5",S[S.TEXTURE6=33990]="TEXTURE6",S[S.TEXTURE7=33991]="TEXTURE7",S[S.TEXTURE8=33992]="TEXTURE8",S[S.TEXTURE9=33993]="TEXTURE9",S[S.TEXTURE10=33994]="TEXTURE10",S[S.TEXTURE11=33995]="TEXTURE11",S[S.TEXTURE12=33996]="TEXTURE12",S[S.TEXTURE13=33997]="TEXTURE13",S[S.TEXTURE14=33998]="TEXTURE14",S[S.TEXTURE15=33999]="TEXTURE15",S[S.TEXTURE16=34e3]="TEXTURE16",S[S.TEXTURE17=34001]="TEXTURE17",S[S.TEXTURE18=34002]="TEXTURE18",S[S.TEXTURE19=34003]="TEXTURE19",S[S.TEXTURE20=34004]="TEXTURE20",S[S.TEXTURE21=34005]="TEXTURE21",S[S.TEXTURE22=34006]="TEXTURE22",S[S.TEXTURE23=34007]="TEXTURE23",S[S.TEXTURE24=34008]="TEXTURE24",S[S.TEXTURE25=34009]="TEXTURE25",S[S.TEXTURE26=34010]="TEXTURE26",S[S.TEXTURE27=34011]="TEXTURE27",S[S.TEXTURE28=34012]="TEXTURE28",S[S.TEXTURE29=34013]="TEXTURE29",S[S.TEXTURE30=34014]="TEXTURE30",S[S.TEXTURE31=34015]="TEXTURE31",S[S.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",S[S.REPEAT=10497]="REPEAT",S[S.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",S[S.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",S[S.FLOAT_VEC2=35664]="FLOAT_VEC2",S[S.FLOAT_VEC3=35665]="FLOAT_VEC3",S[S.FLOAT_VEC4=35666]="FLOAT_VEC4",S[S.INT_VEC2=35667]="INT_VEC2",S[S.INT_VEC3=35668]="INT_VEC3",S[S.INT_VEC4=35669]="INT_VEC4",S[S.BOOL=35670]="BOOL",S[S.BOOL_VEC2=35671]="BOOL_VEC2",S[S.BOOL_VEC3=35672]="BOOL_VEC3",S[S.BOOL_VEC4=35673]="BOOL_VEC4",S[S.FLOAT_MAT2=35674]="FLOAT_MAT2",S[S.FLOAT_MAT3=35675]="FLOAT_MAT3",S[S.FLOAT_MAT4=35676]="FLOAT_MAT4",S[S.SAMPLER_2D=35678]="SAMPLER_2D",S[S.SAMPLER_CUBE=35680]="SAMPLER_CUBE",S[S.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",S[S.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",S[S.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",S[S.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",S[S.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",S[S.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",S[S.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",S[S.COMPILE_STATUS=35713]="COMPILE_STATUS",S[S.LOW_FLOAT=36336]="LOW_FLOAT",S[S.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",S[S.HIGH_FLOAT=36338]="HIGH_FLOAT",S[S.LOW_INT=36339]="LOW_INT",S[S.MEDIUM_INT=36340]="MEDIUM_INT",S[S.HIGH_INT=36341]="HIGH_INT",S[S.FRAMEBUFFER=36160]="FRAMEBUFFER",S[S.RENDERBUFFER=36161]="RENDERBUFFER",S[S.RGBA4=32854]="RGBA4",S[S.RGB5_A1=32855]="RGB5_A1",S[S.RGB565=36194]="RGB565",S[S.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",S[S.STENCIL_INDEX=6401]="STENCIL_INDEX",S[S.STENCIL_INDEX8=36168]="STENCIL_INDEX8",S[S.DEPTH_STENCIL=34041]="DEPTH_STENCIL",S[S.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",S[S.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",S[S.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",S[S.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",S[S.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",S[S.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",S[S.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",S[S.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",S[S.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",S[S.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",S[S.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",S[S.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",S[S.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",S[S.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",S[S.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",S[S.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",S[S.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",S[S.NONE=0]="NONE",S[S.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",S[S.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",S[S.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",S[S.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",S[S.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",S[S.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",S[S.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",S[S.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",S[S.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",S[S.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",S[S.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",S[S.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",S[S.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",S[S.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",S}({}),fe=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,J=P.rU.camelCase,Be=P.rU.isNil,B=P.rU.upperFirst,ee=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"shaderModuleService",void 0),(0,D.Z)(this,"rendererService",void 0),(0,D.Z)(this,"config",void 0),(0,D.Z)(this,"quad",fe),(0,D.Z)(this,"enabled",!0),(0,D.Z)(this,"renderToScreen",!1),(0,D.Z)(this,"model",void 0),(0,D.Z)(this,"name",void 0),(0,D.Z)(this,"optionsToUpdate",{})}return(0,h.Z)(S,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(re){this.name=re}},{key:"getType",value:function(){return X.PostProcessing}},{key:"init",value:function(re,ce){this.config=ce,this.rendererService=re.getContainer().rendererService,this.shaderModuleService=re.getContainer().shaderModuleService;var G=this.rendererService,xe=G.createAttribute,ut=G.createBuffer,Dt=G.createModel,dt=this.setupShaders(),It=dt.vs,Tr=dt.fs,Yr=dt.uniforms;this.model=Dt({vs:It,fs:Tr,attributes:{a_Position:xe({buffer:ut({data:[-4,-4,4,-4,0,4],type:W.FLOAT}),size:2})},uniforms:(0,F.Z)((0,F.Z)({u_Texture:null},Yr),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(re,ce){var G=this,xe=re.multiPassRenderer.getPostProcessor(),ut=this.rendererService,Dt=ut.useFramebuffer,dt=ut.getViewportSize,It=ut.clear,Tr=dt(),Yr=Tr.width,wn=Tr.height;Dt(this.renderToScreen?null:xe.getWriteFBO(),function(){It({framebuffer:xe.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var Bn=(0,F.Z)({u_BloomFinal:0,u_Texture:xe.getReadFBO(),u_ViewportSize:[Yr,wn]},G.convertOptionsToUniforms(G.optionsToUpdate));ce&&(Bn.u_BloomFinal=1,Bn.u_Texture2=ce),G.model.draw({uniforms:Bn})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(re){this.enabled=re}},{key:"setRenderToScreen",value:function(re){this.renderToScreen=re}},{key:"updateOptions",value:function(re){this.optionsToUpdate=(0,F.Z)((0,F.Z)({},this.optionsToUpdate),re)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(re){var ce={};return Object.keys(re).forEach(function(G){Be(re[G])||(ce["u_".concat(B(J(G)))]=re[G])}),ce}}]),S}();function U(S){var Ge=0;switch(S){case"vec2":case"ivec2":Ge=2;break;case"vec3":case"ivec3":Ge=3;break;case"vec4":case"ivec4":case"mat2":Ge=4;break;case"mat3":Ge=9;break;case"mat4":Ge=16;break;default:}return Ge}var q=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function le(S){var Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,re={};return S=S.replace(q,function(ce,G,xe){var ut=xe.split(":"),Dt=ut[0].trim(),dt="";switch(ut.length>1&&(dt=ut[1].trim()),G){case"bool":dt=dt==="true";break;case"float":case"int":dt=Number(dt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":dt?dt=dt.replace("[","").replace("]","").split(",").reduce(function(It,Tr){return It.push(Number(Tr.trim())),It},[]):dt=new Array(U(G)).fill(0);break;default:}return re[Dt]=dt,"".concat(Ge?"uniform ":"").concat(G," ").concat(Dt,`;
`)}),{content:S,uniforms:re}}function j(S){var Ge=le(S,!0),re=Ge.content,ce=Ge.uniforms;return re=re.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,function(G,xe,ut){ut=ut.trim().replace(/^.*$/gm,function(Tr){return"uniform ".concat(Tr)});var Dt=le(ut),dt=Dt.content,It=Dt.uniforms;return Object.assign(ce,It),"".concat(xe,`{
`).concat(dt,`
};`)}),{content:re,uniforms:ce}}function Ce(S){var Ge={};return S.replace(q,function(re,ce,G){var xe=G.trim();return Ge[xe]?"":(Ge[xe]=!0,"uniform ".concat(ce," ").concat(xe,`;
`))})}var $e=null;function Fe(S){return $e.indexOf(S)}var lt=P.rU.clamp,We=2,Ze=4,pe=64,se=128,be=256,Te=512,de=8192,Rt=16384,ye=32768,Ve=null,oe=131072,Re=262144,Se=524288,et=1048576,st=2097152,pt=4194304,bt=8388608,ke=16777216,ur=null;function qt(S,Ge){return S=lt(Math.floor(S),0,255),Ge=lt(Math.floor(Ge),0,255),256*S+Ge}function _n(S){var Ge=S.color,re=S.radius,ce=S.tileX,G=S.tileY,xe=S.shape,ut=S.opacity,Dt=S.stroke,dt=S.strokeWidth,It=S.strokeOpacity,Tr=[],Yr=[],wn=[],Bn=[qt(Ge[0],Ge[1]),qt(Ge[2],Ge[3])],Kn=[qt(Dt[0],Dt[1]),qt(Dt[2],Dt[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(fi){var Gr=_slicedToArray(fi,2),Ri=Gr[0],Pi=Gr[1];Tr.push([].concat(Bn,[(Ri+1)*bt+(Pi+1)*st+getShapeIndex(xe)*oe+re,(ce+512)*Se+(G+512)*pe])),Yr.push([].concat(Kn,[dt,It])),wn.push([ut,0,0,0])}),{packedBuffer:Tr,packedBuffer2:Yr,packedBuffer3:wn}}function Zr(S,Ge){if(S===0&&!Ge)return 0;if(S===1&&Ge)return 4294967295;var re=Ge?1:0,ce=Math.floor(S*127);return ce*ur+re*ke+ce*oe+re*Ve+ce*Te+re*be+ce*We+re}var Vr={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},rn=function(S){return S.TOPRIGHT="topright",S.TOPLEFT="topleft",S.BOTTOMRIGHT="bottomright",S.BOTTOMLEFT="bottomleft",S.TOPCENTER="topcenter",S.BOTTOMCENTER="bottomcenter",S.LEFTCENTER="leftcenter",S.RIGHTCENTER="rightcenter",S.LEFTTOP="lefttop",S.RIGHTTOP="righttop",S.LEFTBOTTOM="leftbottom",S.RIGHTBOTTOM="rightbottom",S}({}),Qr=function(S){return S[S.LNGLAT=1]="LNGLAT",S[S.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",S[S.VECTOR_TILE=3]="VECTOR_TILE",S[S.IDENTITY=4]="IDENTITY",S[S.P20=5]="P20",S[S.P20_OFFSET=6]="P20_OFFSET",S[S.METER_OFFSET=7]="METER_OFFSET",S[S.P20_2=8]="P20_2",S}({}),ln={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},vn={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},$t=function(S){return S.Hover="hover",S.Click="click",S.Select="select",S.Active="active",S.Drag="drag",S}({}),_r=function(S){return S.normal="normal",S.additive="additive",S.subtractive="subtractive",S.min="min",S.max="max",S.none="none",S}({}),kt=function(S){return S.MULTIPLE="MULTIPLE",S.SINGLE="SINGLE",S}({}),qe=function(S){return S.AND="and",S.OR="or",S}({}),Sr=function(S){return S.INIT="init",S.UPDATE="update",S}({}),Pe=function(S){return S.LINEAR="linear",S.SEQUENTIAL="sequential",S.POWER="power",S.LOG="log",S.IDENTITY="identity",S.TIME="time",S.QUANTILE="quantile",S.QUANTIZE="quantize",S.THRESHOLD="threshold",S.CAT="cat",S.DIVERGING="diverging",S.CUSTOM="threshold",S}({}),Hr=function(S){return S.CONSTANT="constant",S.VARIABLE="variable",S}({}),vr=function(S){return S[S.Attribute=0]="Attribute",S[S.InstancedAttribute=1]="InstancedAttribute",S[S.Uniform=2]="Uniform",S}({}),Ie=["mapload","mapchange","mapAfterFrameChange"],gr=x(97326),Wr=x(60136),Dr=x(82963),Xr=x(61120),Vn=x(49296),ni=x.n(Vn),Dn=x(26729),Jn=x.n(Dn);function Yi(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=bi(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function bi(S,Ge){if(S){if(typeof S=="string")return ui(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return ui(S,Ge)}}function ui(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}var pi=30;function it(S){var Ge=S.characterSet,re=S.getFontWidth,ce=S.fontHeight,G=S.buffer,xe=S.maxCanvasWidth,ut=S.mapping,Dt=ut===void 0?{}:ut,dt=S.xOffset,It=dt===void 0?0:dt,Tr=S.yOffset,Yr=Tr===void 0?0:Tr,wn=0,Bn=It;Array.from(Ge).forEach(function(fi,Gr){if(!Dt[fi]){var Ri=re(fi,Gr);Bn+pi>xe&&(Bn=0,wn++),Dt[fi]={x:Bn,y:Yr+wn*pi,width:pi,height:pi,advance:Ri},Bn+=pi}});var Kn=ce+G*2;return{mapping:Dt,xOffset:Bn,yOffset:Yr+wn*Kn,canvasHeight:Ee(Yr+(wn+1)*Kn)}}function V(S,Ge,re){var ce=0,G=0,xe=0,ut=[],Dt={},dt=Yi(S),It;try{for(dt.s();!(It=dt.n()).done;){var Tr=It.value;if(!Dt[Tr.id]){var Yr=Tr.size;ce+Yr+Ge>re&&(H(Dt,ut,G),ce=0,G=xe+G+Ge,xe=0,ut=[]),ut.push({icon:Tr,xOffset:ce}),ce=ce+Yr+Ge,xe=Math.max(xe,Yr)}}}catch(Bn){dt.e(Bn)}finally{dt.f()}ut.length>0&&H(Dt,ut,G);var wn=Ee(xe+G+Ge);return{mapping:Dt,canvasHeight:wn}}function H(S,Ge,re){var ce=Yi(Ge),G;try{for(ce.s();!(G=ce.n()).done;){var xe=G.value,ut=xe.icon,Dt=xe.xOffset;S[ut.id]=(0,F.Z)((0,F.Z)({},ut),{},{x:Dt,y:re,image:ut.image,width:ut.width,height:ut.height})}}catch(dt){ce.e(dt)}finally{ce.f()}}function Ee(S){return Math.pow(2,Math.ceil(Math.log2(S)))}function Le(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=ze(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function ze(S,Ge){if(S){if(typeof S=="string")return xt(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return xt(S,Ge)}}function xt(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}function Ut(S){var Ge=ir();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function ir(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Ft=Lr(),te="sans-serif",Q="normal",ve=24,Oe=3,Xe=.25,ft=8,Et=1024,Ne=1,Ue=1,vt=3,ue=null;function Lr(){for(var S=[],Ge=32;Ge<128;Ge++)S.push(String.fromCharCode(Ge));return S}function lr(S,Ge,re,ce){S.font="".concat(ce," ").concat(re,"px ").concat(Ge),S.fillStyle="black",S.textBaseline="middle"}function $r(S,Ge){for(var re=0;re<S.length;re++)Ge.data[4*re+3]=S[re]}var Rn=function(S){(0,Wr.Z)(re,S);var Ge=Ut(re);function re(){var ce;(0,z.Z)(this,re);for(var G=arguments.length,xe=new Array(G),ut=0;ut<G;ut++)xe[ut]=arguments[ut];return ce=Ge.call.apply(Ge,[this].concat(xe)),(0,D.Z)((0,gr.Z)(ce),"fontAtlas",void 0),(0,D.Z)((0,gr.Z)(ce),"iconFontMap",void 0),(0,D.Z)((0,gr.Z)(ce),"iconFontGlyphs",{}),(0,D.Z)((0,gr.Z)(ce),"fontOptions",void 0),(0,D.Z)((0,gr.Z)(ce),"key",void 0),(0,D.Z)((0,gr.Z)(ce),"cache",new P.z6(vt)),ce}return(0,h.Z)(re,[{key:"scale",get:function(){return Ue}},{key:"canvas",get:function(){var G=this.cache.get(this.key);return G&&G.data}},{key:"mapping",get:function(){var G=this.cache.get(this.key);return G&&G.mapping||{}}},{key:"getCanvasByKey",value:function(G){var xe=this.cache.get(G);return xe&&xe.data}},{key:"getMappingByKey",value:function(G){var xe=this.cache.get(G);return xe&&xe.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:te,fontWeight:Q,characterSet:Ft,fontSize:ve,buffer:Oe,sdf:!0,cutoff:Xe,radius:ft,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(G){var xe=this;G.forEach(function(ut){xe.iconFontGlyphs[ut.name]=ut.unicode})}},{key:"addIconFont",value:function(G,xe){this.iconFontMap.set(G,xe)}},{key:"getIconFontKey",value:function(G){return this.iconFontMap.get(G)||G}},{key:"getGlyph",value:function(G){return this.iconFontGlyphs[G]?String.fromCharCode(parseInt(this.iconFontGlyphs[G],16)):""}},{key:"setFontOptions",value:function(G){this.fontOptions=(0,F.Z)((0,F.Z)({},this.fontOptions),G),this.key=this.getKey();var xe=this.getNewChars(this.key,this.fontOptions.characterSet),ut=this.cache.get(this.key);if(!(ut&&xe.length===0)){var Dt=this.generateFontAtlas(this.key,xe,ut);this.fontAtlas=Dt,this.cache.set(this.key,Dt)}}},{key:"addFontFace",value:function(G,xe){var ut=this,Dt=document.createElement("style");Dt.type="text/css",Dt.innerText=`
        @font-face{
            font-family: '`.concat(G,`';
            src: url('`).concat(xe,`') format('woff2'),
            url('`).concat(xe,`') format('woff'),
            url('`).concat(xe,`') format('truetype');
        }`),Dt.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(G),"L7text"),document.fonts.ready.then(function(){ut.emit("fontloaded",{fontFamily:G})})}catch(dt){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(dt)}},document.getElementsByTagName("head")[0].appendChild(Dt)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(G,xe,ut){var Dt=this.fontOptions,dt=Dt.fontFamily,It=Dt.fontWeight,Tr=Dt.fontSize,Yr=Dt.buffer,wn=Dt.sdf,Bn=Dt.radius,Kn=Dt.cutoff,fi=Dt.iconfont,Gr=ut&&ut.data;Gr||(Gr=window.document.createElement("canvas"),Gr.width=Et);var Ri=Gr.getContext("2d",{willReadFrequently:!0});lr(Ri,dt,Tr,It);var Pi=it((0,F.Z)({getFontWidth:function(mo){return Ri.measureText(mo).width},fontHeight:Tr*Ue,buffer:Yr,characterSet:xe,maxCanvasWidth:Et},ut&&{mapping:ut.mapping,xOffset:ut.xOffset,yOffset:ut.yOffset})),Mi=Pi.mapping,wa=Pi.canvasHeight,Ja=Pi.xOffset,La=Pi.yOffset,ya=Ri.getImageData(0,0,Gr.width,Gr.height);if(Gr.height=wa,Ri.putImageData(ya,0,0),lr(Ri,dt,Tr,It),wn){var Gi=new(ni())(Tr,Yr,Bn,Kn,dt,It),zn=Ri.getImageData(0,0,Gi.size,Gi.size),Fn=Le(xe),$a;try{for(Fn.s();!($a=Fn.n()).done;){var _a=$a.value;if(fi){var Ra=String.fromCharCode(parseInt(_a.replace("&#x","").replace(";",""),16)),Ma=Gi.draw(Ra);$r(Ma,zn)}else $r(Gi.draw(_a),zn);Ri.putImageData(zn,Mi[_a].x,Mi[_a].y)}}catch(ha){Fn.e(ha)}finally{Fn.f()}}else{var da=Le(xe),qo;try{for(da.s();!(qo=da.n()).done;){var Xu=qo.value;Ri.fillText(Xu,Mi[Xu].x,Mi[Xu].y+Tr*Ne)}}catch(ha){da.e(ha)}finally{da.f()}}return{xOffset:Ja,yOffset:La,mapping:Mi,data:Gr,width:Gr.width,height:Gr.height}}},{key:"getKey",value:function(){var G=this.fontOptions,xe=G.fontFamily,ut=G.fontWeight;return"".concat(xe,"_").concat(ut)}},{key:"getNewChars",value:function(G,xe){var ut=this.cache.get(G);if(!ut)return xe;var Dt=[],dt=ut.mapping,It=new Set(Object.keys(dt)),Tr=new Set(xe);return Tr.forEach(function(Yr){It.has(Yr)||Dt.push(Yr)}),Dt}}]),re}(Dn.EventEmitter),nn=x(15861),xr=x(64687),Or=x.n(xr);function sn(S){var Ge=xn();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function xn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var wi=3,Nn=1024,Bi=64,sa=function(S){(0,Wr.Z)(re,S);var Ge=sn(re);function re(){var ce;(0,z.Z)(this,re);for(var G=arguments.length,xe=new Array(G),ut=0;ut<G;ut++)xe[ut]=arguments[ut];return ce=Ge.call.apply(Ge,[this].concat(xe)),(0,D.Z)((0,gr.Z)(ce),"canvasHeight",128),(0,D.Z)((0,gr.Z)(ce),"texture",void 0),(0,D.Z)((0,gr.Z)(ce),"canvas",void 0),(0,D.Z)((0,gr.Z)(ce),"iconData",void 0),(0,D.Z)((0,gr.Z)(ce),"iconMap",void 0),(0,D.Z)((0,gr.Z)(ce),"ctx",void 0),(0,D.Z)((0,gr.Z)(ce),"loadingImageCount",0),ce}return(0,h.Z)(re,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(ut,Dt){var dt,It;return Or().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:return dt=new Image,this.loadingImageCount++,this.hasImage(ut)?console.warn("Image Id already exists"):this.iconData.push({id:ut,size:Bi}),this.updateIconMap(),Yr.next=6,this.loadImage(Dt);case 6:dt=Yr.sent,It=this.iconData.find(function(wn){return wn.id===ut}),It&&(It.image=dt,It.width=dt.width,It.height=dt.height),this.update();case 10:case"end":return Yr.stop()}},xe,this)}));function G(xe,ut){return ce.apply(this,arguments)}return G}()},{key:"addImageMini",value:function(G,xe,ut){var Dt=this,dt=ut.getSceneConfig().canvas,It=dt.createImage();if(this.loadingImageCount++,this.hasImage(G))throw new Error("Image Id already exists");this.iconData.push({id:G,size:Bi}),this.updateIconMap(),this.loadImageMini(xe,dt).then(function(Tr){It=Tr;var Yr=Dt.iconData.find(function(wn){return wn.id===G});Yr&&(Yr.image=It,Yr.width=It.width,Yr.height=It.height),Dt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(G){return this.iconMap.hasOwnProperty(G)}},{key:"removeImage",value:function(G){this.hasImage(G)&&(this.iconData=this.iconData.filter(function(xe){return xe.id!==G}),delete this.iconMap[G],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(G){return new Promise(function(xe,ut){if(G instanceof HTMLImageElement){xe(G);return}var Dt=new Image;Dt.crossOrigin="anonymous",Dt.onload=function(){xe(Dt)},Dt.onerror=function(){ut(new Error("Could not load image at "+G))},Dt.src=G instanceof File?URL.createObjectURL(G):G})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var G=this;this.canvas.width=Nn,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(xe){var ut=G.iconMap[xe],Dt=ut.x,dt=ut.y,It=ut.image,Tr=ut.width,Yr=Tr===void 0?64:Tr,wn=ut.height,Bn=wn===void 0?64:wn,Kn=Math.max(Yr,Bn),fi=Kn/Bi,Gr=Bn/fi,Ri=Yr/fi;It&&G.ctx.drawImage(It,Dt+(Bi-Ri)/2,dt+(Bi-Gr)/2,Ri,Gr)})}},{key:"updateIconMap",value:function(){var G=V(this.iconData,wi,Nn),xe=G.mapping,ut=G.canvasHeight;this.iconMap=xe,this.canvasHeight=ut}},{key:"loadImageMini",value:function(G,xe){return new Promise(function(ut,Dt){var dt=xe.createImage();dt.crossOrigin="anonymous",dt.onload=function(){ut(dt)},dt.onerror=function(){Dt(new Error("Could not load image at "+G))},dt.src=G})}}]),re}(Dn.EventEmitter),Fi=x(97685),bn=x(85975),ei=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"viewport",void 0),(0,D.Z)(this,"overridedViewProjectionMatrix",void 0),(0,D.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,D.Z)(this,"jitteredProjectionMatrix",void 0),(0,D.Z)(this,"viewMatrixInverse",void 0),(0,D.Z)(this,"cameraPosition",void 0)}return(0,h.Z)(S,[{key:"init",value:function(){}},{key:"update",value:function(re){this.viewport=re,this.viewMatrixInverse=bn.create(),bn.invert(this.viewMatrixInverse,re.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var re=this.viewport.getCenter(),ce=(0,Fi.Z)(re,2),G=ce[0],xe=ce[1];return[G,xe]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(re,ce){return this.viewport.projectFlat(re,ce)}},{key:"setViewProjectionMatrix",value:function(re){this.overridedViewProjectionMatrix=re}},{key:"jitterProjectionMatrix",value:function(re,ce){var G=bn.fromTranslation(bn.create(),[re,ce,0]);this.jitteredProjectionMatrix=bn.multiply(bn.create(),G,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=bn.multiply(bn.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),S}(),ga=x(74902);function ua(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=no(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function no(S,Ge){if(S){if(typeof S=="string")return ia(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return ia(S,Ge)}}function ia(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}var zi={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},Nr=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"container",void 0),(0,D.Z)(this,"controlCorners",void 0),(0,D.Z)(this,"controlContainer",void 0),(0,D.Z)(this,"scene",void 0),(0,D.Z)(this,"mapsService",void 0),(0,D.Z)(this,"controls",[]),(0,D.Z)(this,"unAddControls",[])}return(0,h.Z)(S,[{key:"init",value:function(re,ce){this.container=re.container,this.scene=ce,this.mapsService=ce.mapService,this.initControlPos()}},{key:"addControl",value:function(re,ce){var G=ce.mapService;G.map?(re.addTo(this.scene),this.controls.push(re)):this.unAddControls.push(re)}},{key:"getControlByName",value:function(re){return this.controls.find(function(ce){return ce.controlOption.name===re})}},{key:"removeControl",value:function(re){var ce=this.controls.indexOf(re);return ce>-1&&this.controls.splice(ce,1),re.remove(),this}},{key:"addControls",value:function(){var re=this;this.unAddControls.forEach(function(ce){ce.addTo(re.scene),re.controls.push(ce)}),this.unAddControls=[]}},{key:"destroy",value:function(){var re=ua(this.controls),ce;try{for(re.s();!(ce=re.n()).done;){var G=ce.value;G.remove()}}catch(xe){re.e(xe)}finally{re.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var re=this.controlCorners={},ce="l7-",G=this.controlContainer=P.SO.create("div",ce+"control-container",this.container);function xe(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],dt=Dt.map(function(It){return ce+It}).join(" ");re[Dt.filter(function(It){return!["row","column"].includes(It)}).join("")]=P.SO.create("div",dt,G)}function ut(Dt){var dt=Dt.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,ga.Z)(dt),[zi[Dt]])}Object.values(rn).forEach(function(Dt){xe(ut(Dt))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var re in this.controlCorners)this.controlCorners[re]&&P.SO.remove(this.controlCorners[re]);this.controlContainer&&P.SO.remove(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var re=this,ce=window.MutationObserver;if(ce)for(var G=function(){var dt=ut[xe],It=dt.match(/^(top|bottom)(left|right)$/);if(It){var Tr=(0,Fi.Z)(It,3),Yr=Tr[1],wn=Tr[2],Bn=re.controlCorners["".concat(Yr).concat(wn)],Kn=new ce(function(fi){var Gr=(0,Fi.Z)(fi,1),Ri=Gr[0].target;Bn&&(Bn.style[Yr]=Ri.clientHeight+"px")});Kn.observe(re.controlCorners["".concat(wn).concat(Yr)],{childList:!0,attributes:!0})}},xe=0,ut=Object.keys(this.controlCorners);xe<ut.length;xe++)G()}}]),S}(),ji=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"container",void 0),(0,D.Z)(this,"scene",void 0),(0,D.Z)(this,"mapsService",void 0),(0,D.Z)(this,"markers",[]),(0,D.Z)(this,"markerLayers",[]),(0,D.Z)(this,"unAddMarkers",[]),(0,D.Z)(this,"unAddMarkerLayers",[])}return(0,h.Z)(S,[{key:"addMarkerLayer",value:function(re){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(re),re.addTo(this.scene)):this.unAddMarkerLayers.push(re)}},{key:"removeMarkerLayer",value:function(re){re.destroy(),this.markerLayers.indexOf(re);var ce=this.markerLayers.indexOf(re);ce>-1&&this.markerLayers.splice(ce,1)}},{key:"addMarker",value:function(re){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(re),re.addTo(this.scene)):this.unAddMarkers.push(re)}},{key:"addMarkers",value:function(){var re=this;this.unAddMarkers.forEach(function(ce){ce.addTo(re.scene),re.markers.push(ce)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var re=this;this.unAddMarkerLayers.forEach(function(ce){re.markerLayers.push(ce),ce.addTo(re.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(re){re.remove(),this.markers.indexOf(re);var ce=this.markers.indexOf(re);ce>-1&&this.markers.splice(ce,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(re){this.scene=re,this.mapsService=re.mapService}},{key:"destroy",value:function(){this.markers.forEach(function(re){re.remove()}),this.markers=[],this.markerLayers.forEach(function(re){re.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(re){re.destroy()}}]),S}(),Hs=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"scene",void 0),(0,D.Z)(this,"mapsService",void 0),(0,D.Z)(this,"popups",[]),(0,D.Z)(this,"unAddPopups",[])}return(0,h.Z)(S,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(re){re!=null&&re.isOpen()&&re.remove();var ce=this.popups.indexOf(re);ce>-1&&this.popups.splice(ce,1);var G=this.unAddPopups.indexOf(re);G>-1&&this.unAddPopups.splice(G,1)}},{key:"destroy",value:function(){this.popups.forEach(function(re){return re.remove()})}},{key:"addPopup",value:function(re){var ce=this;re&&re.getOptions().autoClose&&[].concat((0,ga.Z)(this.popups),(0,ga.Z)(this.unAddPopups)).forEach(function(G){G.getOptions().autoClose&&ce.removePopup(G)}),this.isMarkerReady?(re.addTo(this.scene),this.popups.push(re)):this.unAddPopups.push(re),re.on("close",function(){ce.removePopup(re)})}},{key:"initPopup",value:function(){var re=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(ce){re.addPopup(ce),re.unAddPopups=[]})}},{key:"init",value:function(re){this.scene=re,this.mapsService=re.mapService}}]),S}(),Da={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Za=Da,Qs=P.rU.merge,cs={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Ka={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:qe.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Do=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"sceneConfigCache",{}),(0,D.Z)(this,"layerConfigCache",{}),(0,D.Z)(this,"layerAttributeConfigCache",{})}return(0,h.Z)(S,[{key:"getSceneConfig",value:function(re){return this.sceneConfigCache[re]}},{key:"getSceneWarninfo",value:function(re){return Za[re]}},{key:"setSceneConfig",value:function(re,ce){this.sceneConfigCache[re]=(0,F.Z)((0,F.Z)({},cs),ce)}},{key:"getLayerConfig",value:function(re){return this.layerConfigCache[re]}},{key:"setLayerConfig",value:function(re,ce,G){this.layerConfigCache[ce]=(0,F.Z)({},Qs({},this.sceneConfigCache[re],Ka,G))}},{key:"getAttributeConfig",value:function(re){return this.layerAttributeConfigCache[re]}},{key:"setAttributeConfig",value:function(re,ce){this.layerAttributeConfigCache[re]=(0,F.Z)((0,F.Z)({},this.layerAttributeConfigCache[re]),ce)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),S}(),qa=x(98333),Qa=Math.PI/180,Pa=512,Na=4003e4;function Lo(S){var Ge=S.latitude,re=Ge===void 0?0:Ge,ce=S.zoom,G=ce===void 0?0:ce,xe=S.scale,ut=S.highPrecision,Dt=ut===void 0?!1:ut,dt=S.flipY,It=dt===void 0?!1:dt;xe=xe!==void 0?xe:Math.pow(2,G);var Tr={},Yr=Pa*xe,wn=Math.cos(re*Qa),Bn=Yr/360,Kn=Bn/wn,fi=Yr/Na/wn;if(Tr.pixelsPerMeter=[fi,-fi,fi],Tr.metersPerPixel=[1/fi,-1/fi,1/fi],Tr.pixelsPerDegree=[Bn,-Kn,fi],Tr.degreesPerPixel=[1/Bn,-1/Kn,1/fi],Dt){var Gr=Qa*Math.tan(re*Qa)/wn,Ri=Bn*Gr/2,Pi=Yr/Na*Gr,Mi=Pi/Kn*fi;Tr.pixelsPerDegree2=[0,-Ri,Pi],Tr.pixelsPerMeter2=[Mi,0,Mi],It&&(Tr.pixelsPerDegree2[1]=-Tr.pixelsPerDegree2[1],Tr.pixelsPerMeter2[1]=-Tr.pixelsPerMeter2[1])}return It&&(Tr.pixelsPerMeter[1]=-Tr.pixelsPerMeter[1],Tr.metersPerPixel[1]=-Tr.metersPerPixel[1],Tr.pixelsPerDegree[1]=-Tr.pixelsPerDegree[1],Tr.degreesPerPixel[1]=-Tr.degreesPerPixel[1]),Tr}var ba=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],so=function(){function S(Ge){(0,z.Z)(this,S),(0,D.Z)(this,"needRefresh",!0),(0,D.Z)(this,"coordinateSystem",void 0),(0,D.Z)(this,"viewportCenter",void 0),(0,D.Z)(this,"viewportCenterProjection",void 0),(0,D.Z)(this,"pixelsPerDegree",void 0),(0,D.Z)(this,"pixelsPerDegree2",void 0),(0,D.Z)(this,"pixelsPerMeter",void 0),this.cameraService=Ge}return(0,h.Z)(S,[{key:"refresh",value:function(re){var ce=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),xe=re||this.cameraService.getCenter(),ut=Lo({latitude:xe[1],zoom:ce}),Dt=ut.pixelsPerMeter,dt=ut.pixelsPerDegree;this.viewportCenter=xe,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Dt,this.pixelsPerDegree=dt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Qr.LNGLAT||this.coordinateSystem===Qr.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Qr.LNGLAT_OFFSET?this.calculateLnglatOffset(xe,ce):this.coordinateSystem===Qr.P20_OFFSET&&this.calculateLnglatOffset(xe,ce,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(re){this.coordinateSystem=re}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(re,ce,G,xe){var ut=Lo({latitude:re[1],zoom:ce,scale:G,flipY:xe,highPrecision:!0}),Dt=ut.pixelsPerMeter,dt=ut.pixelsPerDegree,It=ut.pixelsPerDegree2,Tr=this.cameraService.getViewMatrix(),Yr=this.cameraService.getProjectionMatrix(),wn=bn.multiply([],Yr,Tr),Bn=this.cameraService.projectFlat([Math.fround(re[0]),Math.fround(re[1])],Math.pow(2,ce));this.viewportCenterProjection=qa.fF([],[Bn[0],Bn[1],0,1],wn),Tr=this.cameraService.getViewMatrixUncentered()||Tr,wn=bn.multiply([],Yr,Tr),wn=bn.multiply([],wn,ba),this.cameraService.setViewProjectionMatrix(wn),this.pixelsPerMeter=Dt,this.pixelsPerDegree=dt,this.pixelsPerDegree2=It}}]),S}(),Ao=x(71002);function Y(S){var Ge=vo();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function vo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Va=function(S){(0,Wr.Z)(re,S);var Ge=Y(re);function re(){var ce;(0,z.Z)(this,re);for(var G=arguments.length,xe=new Array(G),ut=0;ut<G;ut++)xe[ut]=arguments[ut];return ce=Ge.call.apply(Ge,[this].concat(xe)),(0,D.Z)((0,gr.Z)(ce),"renderMap",new Map),(0,D.Z)((0,gr.Z)(ce),"enable",!1),(0,D.Z)((0,gr.Z)(ce),"renderEnable",!1),(0,D.Z)((0,gr.Z)(ce),"cacheLogs",{}),ce}return(0,h.Z)(re,[{key:"setEnable",value:function(G){this.enable=!!G}},{key:"log",value:function(G,xe){var ut=this;if(this.enable){var Dt=G.split("."),dt=null;Dt.forEach(function(It,Tr){dt!==null?(dt[It]||(dt[It]={}),Tr!==Dt.length-1&&(dt=dt[It])):(ut.cacheLogs[It]||(ut.cacheLogs[It]={}),Tr!==Dt.length-1&&(dt=ut.cacheLogs[It])),Tr===Dt.length-1&&(dt[It]=(0,F.Z)((0,F.Z)({time:Date.now()},dt[It]),xe))})}}},{key:"getLog",value:function(G){var xe=this;switch((0,Ao.Z)(G)){case"string":return this.cacheLogs[G];case"object":return G.map(function(ut){return xe.cacheLogs[ut]}).filter(function(ut){return ut!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(G){delete this.cacheLogs[G]}},{key:"generateRenderUid",value:function(){return this.renderEnable?(0,P.M8)():""}},{key:"renderDebug",value:function(G){this.renderEnable=G}},{key:"renderStart",value:function(G){if(!(!this.renderEnable||!this.enable)){var xe=this.renderMap.get(G)||{};this.renderMap.set(G,(0,F.Z)((0,F.Z)({},xe),{},{renderUid:G,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(G){if(!(!this.renderEnable||!this.enable)){var xe=this.renderMap.get(G);if(xe){var ut=xe.renderStart,Dt=Date.now();this.emit("renderEnd",(0,F.Z)((0,F.Z)({},xe),{},{renderEnd:Dt,renderDuration:Dt-ut})),this.renderMap.delete(G)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),re}(Dn.EventEmitter),fs=x(50840),Eo=x.n(fs);function Qe(S){var Ge=gt();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function gt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Gt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},Pr=function(S){(0,Wr.Z)(re,S);var Ge=Qe(re);function re(ce){var G;return(0,z.Z)(this,re),G=Ge.call(this),(0,D.Z)((0,gr.Z)(G),"indragging",!1),(0,D.Z)((0,gr.Z)(G),"hammertime",void 0),(0,D.Z)((0,gr.Z)(G),"lastClickTime",0),(0,D.Z)((0,gr.Z)(G),"lastClickXY",[-1,-1]),(0,D.Z)((0,gr.Z)(G),"clickTimer",void 0),(0,D.Z)((0,gr.Z)(G),"$containter",void 0),(0,D.Z)((0,gr.Z)(G),"onDrag",function(xe){var ut=G.interactionEvent(xe);ut.type=Gt[ut.type],ut.type==="dragging"?G.indragging=!0:G.indragging=!1,G.emit($t.Drag,ut)}),(0,D.Z)((0,gr.Z)(G),"onHammer",function(xe){xe.srcEvent.stopPropagation();var ut=G.interactionEvent(xe);G.emit($t.Hover,ut)}),(0,D.Z)((0,gr.Z)(G),"onTouch",function(xe){var ut=xe.touches[0];G.onHover({clientX:ut.clientX,clientY:ut.clientY,type:"touchstart"})}),(0,D.Z)((0,gr.Z)(G),"onTouchEnd",function(xe){if(xe.changedTouches.length>0){var ut=xe.changedTouches[0];G.onHover({clientX:ut.clientX,clientY:ut.clientY,type:"touchend"})}}),(0,D.Z)((0,gr.Z)(G),"onTouchMove",function(xe){var ut=xe.changedTouches[0];G.onHover({clientX:ut.clientX,clientY:ut.clientY,type:"touchmove"})}),(0,D.Z)((0,gr.Z)(G),"onHover",function(xe){var ut=xe.clientX,Dt=xe.clientY,dt=ut,It=Dt,Tr=xe.type,Yr=G.mapService.getMapContainer();if(Yr){var wn=Yr.getBoundingClientRect(),Bn=wn.top,Kn=wn.left;dt=dt-Kn-Yr.clientLeft,It=It-Bn-Yr.clientTop}var fi=G.mapService.containerToLngLat([dt,It]);if(Tr==="click"){G.isDoubleTap(dt,It,fi);return}if(Tr==="touch"){G.isDoubleTap(dt,It,fi);return}Tr!=="click"&&Tr!=="dblclick"&&G.emit($t.Hover,{x:dt,y:It,lngLat:fi,type:Tr,target:xe})}),G.container=ce,G}return(0,h.Z)(re,[{key:"mapService",get:function(){return this.container.mapService}},{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off($t.Hover)}},{key:"triggerHover",value:function(G){var xe=G.x,ut=G.y;this.emit($t.Hover,{x:xe,y:ut})}},{key:"triggerSelect",value:function(G){this.emit($t.Select,{featureId:G})}},{key:"triggerActive",value:function(G){this.emit($t.Active,{featureId:G})}},{key:"addEventListenerOnMap",value:function(){var G=this.mapService.getMapContainer();if(G){var xe=new(Eo()).Manager(G);xe.add(new(Eo()).Tap({event:"dblclick",taps:2})),xe.add(new(Eo()).Tap({event:"click"})),xe.add(new(Eo()).Pan({threshold:0,pointers:0})),xe.add(new(Eo()).Press({})),xe.on("dblclick click",this.onHammer),xe.on("panstart panmove panend pancancel",this.onDrag),G.addEventListener("touchstart",this.onTouch),G.addEventListener("touchend",this.onTouchEnd),G.addEventListener("mousemove",this.onHover),G.addEventListener("touchmove",this.onTouchMove),G.addEventListener("mousedown",this.onHover,!0),G.addEventListener("mouseup",this.onHover),G.addEventListener("contextmenu",this.onHover),this.hammertime=xe}}},{key:"removeEventListenerOnMap",value:function(){var G=this.mapService.getMapContainer();G&&(G.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),G.removeEventListener("touchstart",this.onTouch),G.removeEventListener("touchend",this.onTouchEnd),G.removeEventListener("mousedown",this.onHover),G.removeEventListener("mouseup",this.onHover),G.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(G){var xe=G.type,ut=G.pointerType,Dt,dt;ut==="touch"?(dt=Math.floor(G.pointers[0].clientY),Dt=Math.floor(G.pointers[0].clientX)):(dt=Math.floor(G.srcEvent.y),Dt=Math.floor(G.srcEvent.x));var It=this.mapService.getMapContainer();if(It){var Tr=It.getBoundingClientRect(),Yr=Tr.top,wn=Tr.left;Dt-=wn,dt-=Yr}var Bn=this.mapService.containerToLngLat([Dt,dt]);return{x:Dt,y:dt,lngLat:Bn,type:xe,target:G.srcEvent}}},{key:"isDoubleTap",value:function(G,xe,ut){var Dt=this,dt=new Date().getTime(),It="click";dt-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-G)<10&&Math.abs(this.lastClickXY[1]-xe)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),It="dblclick",this.emit($t.Hover,{x:G,y:xe,lngLat:ut,type:It})):(this.lastClickTime=dt,this.lastClickXY=[G,xe],this.clickTimer=setTimeout(function(){It="click",Dt.emit($t.Hover,{x:G,y:xe,lngLat:ut,type:It})},400))}}]),re}(Jn()),Tn=0;function di(S){var Ge=S;if(typeof S=="string"&&(Ge=document.getElementById(S)),Ge){var re=document.createElement("div");return re.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,re.id="l7-scene-".concat(Tn++),re.classList.add("l7-scene"),Ge.appendChild(re),re}return null}function fa(S){var Ge,re=!0;if((S==null||(Ge=S.target)===null||Ge===void 0?void 0:Ge.target)instanceof HTMLElement)for(var ce,G=S==null||(ce=S.target)===null||ce===void 0?void 0:ce.target;G;){var xe,ut=Array.from(G.classList);if(ut.includes("l7-marker")||ut.includes("l7-popup")){re=!1;break}G=(xe=G)===null||xe===void 0?void 0:xe.parentElement}return re}var Bo=function(S){return S[S.SAMPLED=0]="SAMPLED",S[S.RENDER_TARGET=1]="RENDER_TARGET",S}({});function Ko(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=Po(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function Po(S,Ge){if(S){if(typeof S=="string")return Us(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return Us(S,Ge)}}function Us(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}var ws=function(){function S(Ge){var re=this;(0,z.Z)(this,S),(0,D.Z)(this,"pickedColors",void 0),(0,D.Z)(this,"pickedTileLayers",[]),(0,D.Z)(this,"pickingFBO",void 0),(0,D.Z)(this,"width",0),(0,D.Z)(this,"height",0),(0,D.Z)(this,"alreadyInPicking",!1),(0,D.Z)(this,"pickBufferScale",1),(0,D.Z)(this,"pickFromPickingFBO",function(){var ce=(0,nn.Z)(Or().mark(function G(xe,ut){var Dt,dt,It,Tr,Yr,wn,Bn,Kn,fi,Gr,Ri,Pi,Mi,wa,Ja,La,ya,Gi,zn,Fn,$a,_a,Ra;return Or().wrap(function(da){for(;;)switch(da.prev=da.next){case 0:if(Dt=ut.x,dt=ut.y,It=ut.lngLat,Tr=ut.type,Yr=ut.target,wn=!1,Bn=re.rendererService,Kn=Bn.readPixelsAsync,fi=Bn.getViewportSize,Gr=fi(),Ri=Gr.width,Pi=Gr.height,Mi=xe.getLayerConfig(),wa=Mi.enableHighlight,Ja=Mi.enableSelect,La=Dt*P.SO.DPR,ya=dt*P.SO.DPR,!(La>Ri-1*P.SO.DPR||La<0||ya>Pi-1*P.SO.DPR||ya<0)){da.next=9;break}return da.abrupt("return",!1);case 9:return da.next=11,Kn({x:Math.floor(La/re.pickBufferScale),y:Math.floor((Pi-(dt+1)*P.SO.DPR)/re.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:re.pickingFBO});case 11:return Gi=da.sent,re.pickedColors=Gi,Gi[0]!==0||Gi[1]!==0||Gi[2]!==0?(zn=(0,P.W0)(Gi),Fn=xe.layerPickService.getFeatureById(zn),zn!==xe.getCurrentPickId()&&Tr==="mousemove"&&(Tr="mouseenter"),$a={x:Dt,y:dt,type:Tr,lngLat:It,featureId:zn,feature:Fn,target:Yr},Fn&&(wn=!0,xe.setCurrentPickId(zn),re.triggerHoverOnLayer(xe,$a))):(_a={x:Dt,y:dt,lngLat:It,type:xe.getCurrentPickId()!==null&&Tr==="mousemove"?"mouseout":"un"+Tr,featureId:null,target:Yr,feature:null},re.triggerHoverOnLayer(xe,(0,F.Z)((0,F.Z)({},_a),{},{type:"unpick"})),re.triggerHoverOnLayer(xe,_a),xe.setCurrentPickId(null)),wa&&xe.layerPickService.highlightPickedFeature(Gi),Ja&&Tr==="click"&&(Gi==null?void 0:Gi.toString())!==[0,0,0,0].toString()&&(Ra=(0,P.W0)(Gi),xe.getCurrentSelectedId()===null||Ra!==xe.getCurrentSelectedId()?(xe.layerPickService.selectFeature(Gi),xe.setCurrentSelectedId(Ra)):(xe.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),xe.setCurrentSelectedId(null))),da.abrupt("return",wn);case 17:case"end":return da.stop()}},G)}));return function(G,xe){return ce.apply(this,arguments)}}()),this.container=Ge}return(0,h.Z)(S,[{key:"mapService",get:function(){return this.container.mapService}},{key:"rendererService",get:function(){return this.container.rendererService}},{key:"configService",get:function(){return this.container.globalConfigService}},{key:"interactionService",get:function(){return this.container.interactionService}},{key:"layerService",get:function(){return this.container.layerService}},{key:"init",value:function(re){var ce=this.rendererService,G=ce.createTexture2D,xe=ce.createFramebuffer,ut=ce.getViewportSize,Dt=ut(),dt=Dt.width,It=Dt.height;this.pickBufferScale=this.configService.getSceneConfig(re).pickBufferScale||1,dt=Math.round(dt/this.pickBufferScale),It=Math.round(It/this.pickBufferScale);var Tr=G({width:dt,height:It,usage:Bo.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=xe({color:Tr,depth:!0,width:dt,height:It}),this.interactionService.on($t.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G,xe,ut){var Dt=this,dt,It,Tr,Yr;return Or().wrap(function(Bn){for(;;)switch(Bn.prev=Bn.next){case 0:return dt=this.rendererService,It=dt.useFramebufferAsync,Tr=dt.clear,this.resizePickingFBO(),G.hooks.beforePickingEncode.call(),Bn.next=5,It(this.pickingFBO,(0,nn.Z)(Or().mark(function Kn(){return Or().wrap(function(Gr){for(;;)switch(Gr.prev=Gr.next){case 0:Tr({framebuffer:Dt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),G.renderModels({ispick:!0});case 2:case"end":return Gr.stop()}},Kn)})));case 5:return G.hooks.afterPickingEncode.call(),Bn.next=8,this.pickBox(G,xe);case 8:Yr=Bn.sent,ut(Yr);case 10:case"end":return Bn.stop()}},ce,this)}));function re(ce,G,xe){return Ge.apply(this,arguments)}return re}()},{key:"pickBox",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G,xe){var ut=this,Dt,dt,It,Tr,Yr,wn,Bn,Kn,fi,Gr,Ri,Pi,Mi,wa,Ja,La,ya,Gi,zn,Fn,$a;return Or().wrap(function(Ra){for(;;)switch(Ra.prev=Ra.next){case 0:if(Dt=xe.map(function(Ma){var da=Ma<0?0:Ma;return Math.floor(da*P.SO.DPR/ut.pickBufferScale)}),dt=(0,Fi.Z)(Dt,4),It=dt[0],Tr=dt[1],Yr=dt[2],wn=dt[3],Bn=this.rendererService,Kn=Bn.readPixelsAsync,fi=Bn.getViewportSize,Gr=fi(),Ri=Gr.width,Pi=Gr.height,!(It>(Ri-1)*P.SO.DPR/this.pickBufferScale||Yr<0||Tr>(Pi-1)*P.SO.DPR/this.pickBufferScale||wn<0)){Ra.next=5;break}return Ra.abrupt("return",[]);case 5:return Mi=Math.min(Ri/this.pickBufferScale,Yr)-It,wa=Math.min(Pi/this.pickBufferScale,wn)-Tr,Ra.next=9,Kn({x:It,y:Math.floor(Pi/this.pickBufferScale-(wn+1)),width:Mi,height:wa,data:new Uint8Array(Mi*wa*4),framebuffer:this.pickingFBO});case 9:for(Ja=Ra.sent,La=[],ya={},Gi=0;Gi<Ja.length/4;Gi=Gi+1)zn=Ja.slice(Gi*4,Gi*4+4),Fn=(0,P.W0)(zn),Fn!==-1&&!ya[Fn]&&($a=G.layerPickService.getFeatureById(Fn),La.push((0,F.Z)((0,F.Z)({},$a),{},{pickedFeatureIdx:Fn})),ya[Fn]=!0);return Ra.abrupt("return",La);case 14:case"end":return Ra.stop()}},ce,this)}));function re(ce,G){return Ge.apply(this,arguments)}return re}()},{key:"handleCursor",value:function(re,ce){var G=re.getLayerConfig(),xe=G.cursor,ut=xe===void 0?"":xe,Dt=G.cursorEnabled;if(Dt){var dt=this.mapService.version,It=dt==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),Tr=It==null?void 0:It.style.getPropertyValue("cursor");ce==="unmousemove"&&Tr!==""?It==null||It.style.setProperty("cursor",""):ce==="mousemove"&&(It==null||It.style.setProperty("cursor",ut))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(re){return re.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G){return Or().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:if(!(!this.layerService.needPick(G.type)||!this.isPickingAllLayer())){ut.next=2;break}return ut.abrupt("return");case 2:return this.alreadyInPicking=!0,ut.next=5,this.pickingLayers(G);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return ut.stop()}},ce,this)}));function re(ce){return Ge.apply(this,arguments)}return re}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var re=this.rendererService.getViewportSize,ce=re(),G=ce.width,xe=ce.height;(this.width!==G||this.height!==xe)&&(this.pickingFBO.resize({width:Math.round(G/this.pickBufferScale),height:Math.round(xe/this.pickBufferScale)}),this.width=G,this.height=xe)}},{key:"pickingLayers",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G){var xe=this,ut,Dt,dt,It,Tr,Yr,wn;return Or().wrap(function(Kn){for(;;)switch(Kn.prev=Kn.next){case 0:ut=this.rendererService,Dt=ut.clear,dt=ut.useFramebufferAsync,this.resizePickingFBO(),It=this.layerService.getRenderList(),Tr=Ko(It.filter(function(fi){return fi.needPick(G.type)}).reverse()),Kn.prev=4,wn=Or().mark(function fi(){var Gr,Ri;return Or().wrap(function(Mi){for(;;)switch(Mi.prev=Mi.next){case 0:return Gr=Yr.value,Mi.next=3,dt(xe.pickingFBO,(0,nn.Z)(Or().mark(function wa(){return Or().wrap(function(La){for(;;)switch(La.prev=La.next){case 0:Dt({framebuffer:xe.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Gr.layerPickService.pickRender(G);case 2:case"end":return La.stop()}},wa)})));case 3:return Mi.next=5,xe.pickFromPickingFBO(Gr,G);case 5:if(Ri=Mi.sent,xe.layerService.pickedLayerId=Ri?+Gr.id:-1,!(Ri&&!Gr.getLayerConfig().enablePropagation)){Mi.next=9;break}return Mi.abrupt("return",1);case 9:case"end":return Mi.stop()}},fi)}),Tr.s();case 7:if((Yr=Tr.n()).done){Kn.next=13;break}return Kn.delegateYield(wn(),"t0",9);case 9:if(!Kn.t0){Kn.next=11;break}return Kn.abrupt("break",13);case 11:Kn.next=7;break;case 13:Kn.next=18;break;case 15:Kn.prev=15,Kn.t1=Kn.catch(4),Tr.e(Kn.t1);case 18:return Kn.prev=18,Tr.f(),Kn.finish(18);case 21:case"end":return Kn.stop()}},ce,this,[[4,15,18,21]])}));function re(ce){return Ge.apply(this,arguments)}return re}()},{key:"triggerHoverOnLayer",value:function(re,ce){fa(ce)&&(this.handleCursor(re,ce.type),re.emit(ce.type,ce))}}]),S}(),Yc=function(){function S(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,z.Z)(this,S),(0,D.Z)(this,"autoStart",void 0),(0,D.Z)(this,"startTime",0),(0,D.Z)(this,"oldTime",0),(0,D.Z)(this,"running",!1),(0,D.Z)(this,"elapsedTime",0),this.autoStart=Ge}return(0,h.Z)(S,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var re=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var ce=(typeof performance=="undefined"?Date:performance).now();re=(ce-this.oldTime)/1e3,this.oldTime=ce,this.elapsedTime+=re}return re}}]),S}();function Ml(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=ns(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function ns(S,Ge){if(S){if(typeof S=="string")return Uu(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return Uu(S,Ge)}}function Uu(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}function il(S){var Ge=is();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function is(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Cu=P.rU.throttle,al=function(S){(0,Wr.Z)(re,S);var Ge=il(re);function re(ce){var G;return(0,z.Z)(this,re),G=Ge.call(this),(0,D.Z)((0,gr.Z)(G),"pickedLayerId",-1),(0,D.Z)((0,gr.Z)(G),"clock",new Yc),(0,D.Z)((0,gr.Z)(G),"alreadyInRendering",!1),(0,D.Z)((0,gr.Z)(G),"layers",[]),(0,D.Z)((0,gr.Z)(G),"layerList",[]),(0,D.Z)((0,gr.Z)(G),"layerRenderID",void 0),(0,D.Z)((0,gr.Z)(G),"sceneInited",!1),(0,D.Z)((0,gr.Z)(G),"animateInstanceCount",0),(0,D.Z)((0,gr.Z)(G),"shaderPicking",!0),(0,D.Z)((0,gr.Z)(G),"enableRender",!0),(0,D.Z)((0,gr.Z)(G),"reRender",Cu(function(){G.renderLayers()},32)),(0,D.Z)((0,gr.Z)(G),"throttleRenderLayers",Cu(function(){G.renderLayers()},16)),G.container=ce,G}return(0,h.Z)(re,[{key:"renderService",get:function(){return this.container.rendererService}},{key:"mapService",get:function(){return this.container.mapService}},{key:"debugService",get:function(){return this.container.debugService}},{key:"needPick",value:function(G){return this.updateLayerRenderList(),this.layerList.some(function(xe){return xe.needPick(G)})}},{key:"add",value:function(G){var xe=this;this.layers.push(G),this.sceneInited&&G.init().then(function(){xe.renderLayers()})}},{key:"addMask",value:function(G){var xe=this;this.sceneInited&&G.init().then(function(){xe.renderLayers()})}},{key:"initLayers",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(){var ut=this;return Or().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var It=(0,nn.Z)(Or().mark(function Tr(Yr){return Or().wrap(function(Bn){for(;;)switch(Bn.prev=Bn.next){case 0:if(Yr.startInit){Bn.next=4;break}return Bn.next=3,Yr.init();case 3:ut.updateLayerRenderList();case 4:case"end":return Bn.stop()}},Tr)}));return function(Tr){return It.apply(this,arguments)}}());case 2:case"end":return dt.stop()}},xe,this)}));function G(){return ce.apply(this,arguments)}return G}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(G){return this.layers.find(function(xe){return xe.id===G})}},{key:"getLayerByName",value:function(G){return this.layers.find(function(xe){return xe.name===G})}},{key:"remove",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(ut,Dt){var dt,It;return Or().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:Dt?(dt=Dt.layerChildren.indexOf(ut),dt>-1&&Dt.layerChildren.splice(dt,1)):(It=this.layers.indexOf(ut),It>-1&&this.layers.splice(It,1)),ut.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return Yr.stop()}},xe,this)}));function G(xe,ut){return ce.apply(this,arguments)}return G}()},{key:"removeAllLayers",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(){return Or().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:this.destroy(),this.reRender();case 2:case"end":return Dt.stop()}},xe,this)}));function G(){return ce.apply(this,arguments)}return G}()},{key:"setEnableRender",value:function(G){this.enableRender=G}},{key:"renderLayers",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(){var ut,Dt,dt,It,Tr,Yr,wn,Bn,Kn;return Or().wrap(function(Gr){for(;;)switch(Gr.prev=Gr.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){Gr.next=2;break}return Gr.abrupt("return");case 2:this.updateLayerRenderList(),ut=this.debugService.generateRenderUid(),this.debugService.renderStart(ut),this.alreadyInRendering=!0,this.clear(),Dt=Ml(this.layerList);try{for(Dt.s();!(dt=Dt.n()).done;)It=dt.value,It.prerender()}catch(Ri){Dt.e(Ri)}finally{Dt.f()}this.renderService.beginFrame(),Tr=Ml(this.layerList),Gr.prev=11,Tr.s();case 13:if((Yr=Tr.n()).done){Gr.next=25;break}if(wn=Yr.value,Bn=wn.getLayerConfig(),Kn=Bn.enableMask,wn.masks.filter(function(Ri){return Ri.inited}).length>0&&Kn&&this.renderMask(wn.masks),!wn.getLayerConfig().enableMultiPassRenderer){Gr.next=22;break}return Gr.next=20,wn.renderMultiPass();case 20:Gr.next=23;break;case 22:wn.render();case 23:Gr.next=13;break;case 25:Gr.next=30;break;case 27:Gr.prev=27,Gr.t0=Gr.catch(11),Tr.e(Gr.t0);case 30:return Gr.prev=30,Tr.f(),Gr.finish(30);case 33:this.renderService.endFrame(),this.debugService.renderEnd(ut),this.alreadyInRendering=!1;case 36:case"end":return Gr.stop()}},xe,this,[[11,27,30,33]])}));function G(){return ce.apply(this,arguments)}return G}()},{key:"renderMask",value:function(G){var xe=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var ut=G.length>1?kt.MULTIPLE:kt.SINGLE,Dt=Ml(G),dt;try{for(Dt.s();!(dt=Dt.n()).done;){var It=dt.value;It.render({isStencil:!0,stencilType:ut,stencilIndex:xe++})}}catch(Tr){Dt.e(Tr)}finally{Dt.f()}}},{key:"beforeRenderData",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(ut){var Dt;return Or().wrap(function(It){for(;;)switch(It.prev=It.next){case 0:return It.next=2,ut.hooks.beforeRenderData.promise();case 2:Dt=It.sent,Dt&&this.renderLayers();case 4:case"end":return It.stop()}},xe,this)}));function G(xe){return ce.apply(this,arguments)}return G}()},{key:"renderTileLayerMask",value:function(G){var xe=0,ut=G.getLayerConfig(),Dt=ut.enableMask,dt=Dt===void 0?!0:Dt,It=G.tileMask?1:0,Tr=G.masks.filter(function(fi){return fi.inited});It=It+(dt?Tr.length:1);var Yr=It>1?kt.MULTIPLE:kt.SINGLE;if((G.tileMask||Tr.length&&dt)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),Tr.length&&dt){var wn=Ml(Tr),Bn;try{for(wn.s();!(Bn=wn.n()).done;){var Kn=Bn.value;Kn.render({isStencil:!0,stencilType:Yr,stencilIndex:xe++})}}catch(fi){wn.e(fi)}finally{wn.f()}}G.tileMask&&G.tileMask.render({isStencil:!0,stencilType:Yr,stencilIndex:xe++,stencilOperation:qe.OR})}},{key:"renderTileLayer",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(ut){return Or().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:if(this.renderTileLayerMask(ut),!ut.getLayerConfig().enableMultiPassRenderer){dt.next=6;break}return dt.next=4,ut.renderMultiPass();case 4:dt.next=8;break;case 6:return dt.next=8,ut.render();case 8:case"end":return dt.stop()}},xe,this)}));function G(xe){return ce.apply(this,arguments)}return G}()},{key:"updateLayerRenderList",value:function(){var G=this;this.layerList=[],this.layers.filter(function(xe){return xe.inited}).filter(function(xe){return xe.isVisible()}).sort(function(xe,ut){return xe.zIndex-ut.zIndex}).forEach(function(xe){G.layerList.push(xe)})}},{key:"destroy",value:function(){this.layers.forEach(function(G){G.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var G=(0,P.CI)(this.mapService.bgColor);this.renderService.clear({color:G,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){window.cancelAnimationFrame(this.layerRenderID)}}]),re}(Dn.EventEmitter),Kl=x(45987),cn=P.rU.isNil,Ei=function(){function S(Ge){var re=this;(0,z.Z)(this,S),(0,D.Z)(this,"name",void 0),(0,D.Z)(this,"type",void 0),(0,D.Z)(this,"scale",void 0),(0,D.Z)(this,"descriptor",void 0),(0,D.Z)(this,"featureBufferLayout",[]),(0,D.Z)(this,"needRescale",!1),(0,D.Z)(this,"needRemapping",!1),(0,D.Z)(this,"needRegenerateVertices",!1),(0,D.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,D.Z)(this,"vertexAttribute",void 0),(0,D.Z)(this,"defaultCallback",function(ce){if(ce.length===0){var G;return((G=re.scale)===null||G===void 0?void 0:G.defaultValues)||[]}return ce.map(function(xe,ut){var Dt,dt=(Dt=re.scale)===null||Dt===void 0?void 0:Dt.scalers[ut].func,It=dt(xe);return It})}),this.setProps(Ge)}return(0,h.Z)(S,[{key:"setProps",value:function(re){Object.assign(this,re)}},{key:"mapping",value:function(re){var ce;if((ce=this.scale)!==null&&ce!==void 0&&ce.callback){var G,xe=(G=this.scale)===null||G===void 0?void 0:G.callback.apply(G,(0,ga.Z)(re));if(!cn(xe))return[xe]}return this.defaultCallback(re)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),S}(),Hi=["buffer","update","name"],In=["buffer","update","name"],Co,ol=(Co={},(0,D.Z)(Co,W.FLOAT,4),(0,D.Z)(Co,W.UNSIGNED_BYTE,1),(0,D.Z)(Co,W.UNSIGNED_SHORT,2),Co),ql=function(){function S(Ge){(0,z.Z)(this,S),(0,D.Z)(this,"attributesAndIndices",void 0),(0,D.Z)(this,"attributes",[]),(0,D.Z)(this,"triangulation",void 0),(0,D.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=Ge}return(0,h.Z)(S,[{key:"registerStyleAttribute",value:function(re){var ce=this.getLayerStyleAttribute(re.name||"");return ce?ce.setProps(re):(ce=new Ei(re),this.attributes.push(ce)),ce}},{key:"unRegisterStyleAttribute",value:function(re){var ce=this.attributes.findIndex(function(G){return G.name===re});ce>-1&&this.attributes.splice(ce,1)}},{key:"updateScaleAttribute",value:function(re){this.attributes.forEach(function(ce){var G,xe=ce.name,ut=(G=ce.scale)===null||G===void 0?void 0:G.field;(re[xe]||ut&&re[ut])&&(ce.needRescale=!0,ce.needRemapping=!0,ce.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(re,ce,G){var xe=this.getLayerStyleAttribute(re);xe||(xe=this.registerStyleAttribute((0,F.Z)((0,F.Z)({},ce),{},{name:re})));var ut=ce.scale;ut&&xe&&(xe.scale=ut,xe.needRescale=!0,xe.needRemapping=!0,xe.needRegenerateVertices=!0,G&&G.featureRange&&(xe.featureRange=G.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(re){return this.attributes.find(function(ce){return ce.name===re})}},{key:"getLayerAttributeScale",value:function(re){var ce,G=this.getLayerStyleAttribute(re),xe=G==null||(ce=G.scale)===null||ce===void 0?void 0:ce.scalers;return xe&&xe[0]?xe[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(re,ce){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,xe=arguments.length>3?arguments[3]:void 0,ut=arguments.length>4?arguments[4]:void 0,Dt=this.attributes.find(function(Ja){return Ja.name===re});if(Dt&&Dt.descriptor){var dt=Dt.descriptor,It=dt.update,Tr=dt.buffer,Yr=dt.size,wn=Yr===void 0?0:Yr,Bn=ol[Tr.type||W.FLOAT];if(It){var Kn=this.featureLayout,fi=Kn.elements,Gr=Kn.sizePerElement,Ri=fi.slice(G,xe);if(!Ri.length)return;var Pi=Ri[0].offset,Mi=Pi*wn*Bn,wa=Ri.map(function(Ja,La){for(var ya=Ja.featureIdx,Gi=Ja.vertices,zn=Ja.normals,Fn=Gi.length/Gr,$a=[],_a=0;_a<Fn;_a++){var Ra=zn?zn.slice(_a*3,_a*3+3):[];$a.push.apply($a,(0,ga.Z)(It(ce[ya],ya,Gi.slice(_a*Gr,_a*Gr+Gr),La,Ra)))}return $a}).flat();Dt.vertexAttribute.updateBuffer({data:wa,offset:Mi}),ut==null||ut.emit("legend:".concat(re),ut.getLegend(re))}}}},{key:"createAttributesAndIndices",value:function(re,ce,G,xe){var ut=this;this.featureLayout={sizePerElement:0,elements:[]},ce&&(this.triangulation=ce);var Dt=this.attributes.map(function(Pi){return Pi.resetDescriptor(),Pi.descriptor}),dt=0,It=0,Tr=[],Yr=3;re.forEach(function(Pi,Mi){var wa=ut.triangulation(Pi,G),Ja=wa.indices,La=wa.vertices,ya=wa.normals,Gi=wa.size,zn=wa.indexes,Fn=wa.count;typeof Fn=="number"&&(It+=Fn),Ja.forEach(function(Ma){Tr.push(Ma+dt)}),Yr=Gi;var $a=La.length/Gi;ut.featureLayout.sizePerElement=Yr,ut.featureLayout.elements.push({featureIdx:Mi,vertices:La,normals:ya,offset:dt}),dt+=$a;for(var _a=function(da){var qo=(ya==null?void 0:ya.slice(da*3,da*3+3))||[],Xu=La.slice(da*Gi,da*Gi+Gi),ha=0;zn&&zn[da]!==void 0&&(ha=zn[da]),Dt.forEach(function(mo,Fc){if(mo&&mo.update){var nu;(nu=mo.buffer.data).push.apply(nu,(0,ga.Z)(mo.update(Pi,Mi,Xu,da,qo,ha)))}})},Ra=0;Ra<$a;Ra++)_a(Ra)});var wn=this.rendererService,Bn=wn.createAttribute,Kn=wn.createBuffer,fi=wn.createElements,Gr={};Dt.forEach(function(Pi,Mi){if(Pi){var wa=Pi.buffer,Ja=Pi.update,La=Pi.name,ya=(0,Kl.Z)(Pi,Hi),Gi=Bn((0,F.Z)({buffer:Kn(wa)},ya));Gr[Pi.name||""]=Gi,ut.attributes[Mi].vertexAttribute=Gi}});var Ri=fi({data:Tr,type:W.UNSIGNED_INT,count:Tr.length});return this.attributesAndIndices={attributes:Gr,elements:Ri,count:It},Object.values(this.attributes).filter(function(Pi){return Pi.scale}).forEach(function(Pi){var Mi=Pi.name;xe==null||xe.emit("legend:".concat(Mi),xe.getLegend(Mi))}),this.attributesAndIndices}},{key:"createAttributes",value:function(re,ce){var G=this;this.featureLayout={sizePerElement:0,elements:[]},ce&&(this.triangulation=ce);var xe=this.attributes.map(function(Bn){return Bn.resetDescriptor(),Bn.descriptor}),ut=0,Dt=[],dt=3;re.forEach(function(Bn,Kn){var fi=G.triangulation(Bn),Gr=fi.indices,Ri=fi.vertices,Pi=fi.normals,Mi=fi.size,wa=fi.indexes;Gr.forEach(function(Gi){Dt.push(Gi+ut)}),dt=Mi;var Ja=Ri.length/Mi;G.featureLayout.sizePerElement=dt,G.featureLayout.elements.push({featureIdx:Kn,vertices:Ri,normals:Pi,offset:ut}),ut+=Ja;for(var La=function(zn){var Fn=(Pi==null?void 0:Pi.slice(zn*3,zn*3+3))||[],$a=Ri.slice(zn*Mi,zn*Mi+Mi),_a=0;wa&&wa[zn]!==void 0&&(_a=wa[zn]),xe.forEach(function(Ra,Ma){if(Ra&&Ra.update){var da;(da=Ra.buffer.data).push.apply(da,(0,ga.Z)(Ra.update(Bn,Kn,$a,zn,Fn,_a)))}})},ya=0;ya<Ja;ya++)La(ya)});var It=this.rendererService,Tr=It.createAttribute,Yr=It.createBuffer,wn={};return xe.forEach(function(Bn,Kn){if(Bn){var fi=Bn.buffer,Gr=Bn.update,Ri=Bn.name,Pi=(0,Kl.Z)(Bn,In),Mi=Tr((0,F.Z)({buffer:Yr(fi)},Pi));wn[Bn.name||""]=Mi,G.attributes[Kn].vertexAttribute=Mi}}),{attributes:wn}}},{key:"clearAllAttributes",value:function(){var re;this.attributes.forEach(function(ce){ce.vertexAttribute&&ce.vertexAttribute.destroy()}),(re=this.attributesAndIndices)===null||re===void 0||re.elements.destroy(),this.attributes=[]}}]),S}(),Ic=x(46343),uc=x(63844),Pc=x.n(uc);function Kc(S){var Ge=bf();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function bf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var qc=function(S){(0,Wr.Z)(re,S);var Ge=Kc(re);function re(ce){var G;return(0,z.Z)(this,re),G=Ge.call(this),(0,D.Z)((0,gr.Z)(G),"destroyed",!1),(0,D.Z)((0,gr.Z)(G),"loaded",!1),(0,D.Z)((0,gr.Z)(G),"id",void 0),(0,D.Z)((0,gr.Z)(G),"inited",!1),(0,D.Z)((0,gr.Z)(G),"rendering",!1),(0,D.Z)((0,gr.Z)(G),"$container",void 0),(0,D.Z)((0,gr.Z)(G),"canvas",void 0),(0,D.Z)((0,gr.Z)(G),"markerContainer",void 0),(0,D.Z)((0,gr.Z)(G),"resizeDetector",void 0),(0,D.Z)((0,gr.Z)(G),"hooks",void 0),(0,D.Z)((0,gr.Z)(G),"handleWindowResized",function(){G.emit("resize"),G.$container&&(G.initContainer(),G.coordinateSystemService.needRefresh=!0,G.render())}),(0,D.Z)((0,gr.Z)(G),"handleMapCameraChanged",function(xe){G.cameraService.update(xe),G.render()}),G.container=ce,G.hooks={init:new Ic.sX},G.id=ce.id,G}return(0,h.Z)(re,[{key:"iconService",get:function(){return this.container.iconService}},{key:"fontService",get:function(){return this.container.fontService}},{key:"controlService",get:function(){return this.container.controlService}},{key:"configService",get:function(){return this.container.globalConfigService}},{key:"map",get:function(){return this.container.mapService}},{key:"coordinateSystemService",get:function(){return this.container.coordinateSystemService}},{key:"rendererService",get:function(){return this.container.rendererService}},{key:"layerService",get:function(){return this.container.layerService}},{key:"debugService",get:function(){return this.container.debugService}},{key:"cameraService",get:function(){return this.container.cameraService}},{key:"interactionService",get:function(){return this.container.interactionService}},{key:"pickingService",get:function(){return this.container.pickingService}},{key:"shaderModuleService",get:function(){return this.container.shaderModuleService}},{key:"markerService",get:function(){return this.container.markerService}},{key:"popupService",get:function(){return this.container.popupService}},{key:"init",value:function(G){var xe=this;this.configService.setSceneConfig(this.id,G),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return xe.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,nn.Z)(Or().mark(function ut(){return Or().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:return xe.debugService.log("map.mapInitStart",{type:xe.map.version}),dt.next=3,new Promise(function(It){xe.map.onCameraChanged(function(Tr){xe.cameraService.init(),xe.cameraService.update(Tr),It()}),xe.map.init()});case 3:xe.map.onCameraChanged(xe.handleMapCameraChanged),xe.map.addMarkerContainer(),xe.markerService.addMarkers(),xe.markerService.addMarkerLayers(),xe.popupService.initPopup(),xe.interactionService.init(),xe.interactionService.on($t.Drag,xe.addSceneEvent.bind(xe));case 10:case"end":return dt.stop()}},ut)}))),this.hooks.init.tapPromise("initRenderer",(0,nn.Z)(Or().mark(function ut(){var Dt,dt,It;return Or().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:if(dt=((Dt=xe.map)===null||Dt===void 0?void 0:Dt.getOverlayContainer())||void 0,dt?xe.$container=dt:xe.$container=di(xe.configService.getSceneConfig(xe.id).id||""),!xe.$container){Yr.next=14;break}return xe.canvas=P.SO.create("canvas","",xe.$container),xe.setCanvas(),Yr.next=7,xe.rendererService.init(xe.canvas,xe.configService.getSceneConfig(xe.id),G.gl);case 7:xe.registerContextLost(),xe.initContainer(),xe.resizeDetector=Pc()({strategy:"scroll"}),xe.resizeDetector.listenTo(xe.$container,xe.handleWindowResized),window.matchMedia&&((It=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||It===void 0||It.addListener(xe.handleWindowResized.bind("screen"))),Yr.next=15;break;case 14:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 15:xe.pickingService.init(xe.id);case 16:case"end":return Yr.stop()}},ut)}))),this.render()}},{key:"registerContextLost",value:function(){var G=this,xe=this.rendererService.getCanvas();xe&&xe.addEventListener("webglcontextlost",function(){return G.emit("webglcontextlost")})}},{key:"addLayer",value:function(G){this.layerService.sceneService=this,this.layerService.add(G)}},{key:"addMask",value:function(G){this.layerService.sceneService=this,this.layerService.addMask(G)}},{key:"render",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(){return Or().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(!(this.rendering||this.destroyed)){Dt.next=2;break}return Dt.abrupt("return");case 2:if(this.rendering=!0,this.inited){Dt.next=16;break}return Dt.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),Dt.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,Dt.next=20;break;case 16:return Dt.next=18,this.layerService.initLayers();case 18:return Dt.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return Dt.stop()}},xe,this)}));function G(){return ce.apply(this,arguments)}return G}()},{key:"addFontFace",value:function(G,xe){this.fontService.addFontFace(G,xe)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var ce=(0,nn.Z)(Or().mark(function xe(ut){var Dt,dt,It;return Or().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:return dt=(Dt=this.$container)===null||Dt===void 0?void 0:Dt.getElementsByTagName("canvas")[0],Yr.next=3,this.render();case 3:return It=ut==="jpg"?dt==null?void 0:dt.toDataURL("image/jpeg"):dt==null?void 0:dt.toDataURL("image/png"),Yr.abrupt("return",It);case 5:case"end":return Yr.stop()}},xe,this)}));function G(xe){return ce.apply(this,arguments)}return G}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var G=this.$container.parentElement;G!==null&&(this.markerContainer=P.SO.create("div","l7-marker-container",G))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var G=this,xe;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var ut;(ut=G.$container)===null||ut===void 0||ut.removeChild(G.canvas),G.canvas=null,G.rendererService.destroy()}),(xe=this.$container)===null||xe===void 0||(xe=xe.parentNode)===null||xe===void 0||xe.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var G,xe,ut=P.SO.DPR,Dt=((G=this.$container)===null||G===void 0?void 0:G.clientWidth)||400,dt=((xe=this.$container)===null||xe===void 0?void 0:xe.clientHeight)||300,It=this.canvas;It&&(It.width=Dt*ut,It.height=dt*ut),this.rendererService.viewport({x:0,y:0,width:ut*Dt,height:ut*dt})}},{key:"setCanvas",value:function(){var G,xe,ut=P.SO.DPR,Dt=((G=this.$container)===null||G===void 0?void 0:G.clientWidth)||400,dt=((xe=this.$container)===null||xe===void 0?void 0:xe.clientHeight)||300,It=this.canvas;It.width=Dt*ut,It.height=dt*ut,It.style.width="100%",It.style.height="100%"}},{key:"addSceneEvent",value:function(G){this.emit(G.type,G)}}]),re}(Dn.EventEmitter),Ol=P.rU.uniq,lu="#define PI 3.14159265359",Ef=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,hs=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,gl=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,yl=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Ws=`layout(location = 3) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Js=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_EnableSelect;
  float u_activeMix;
};`,eu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,cu=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)
#define EARTH_CIRCUMFERENCE 40.03e6

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
#pragma include "scene_uniforms"


// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
   if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return lnglat;
  }
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  // if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
 

  //    return vec4(
  //     position.xy,
  //     project_scale(position.z),
  //     position.w);
  // }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}



float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }

  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
   return meter;
  } else  {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

// \u652F\u6301 GaodeV2\u3001Mapbox
vec4 project_common_position_to_clipspace_v2(vec4 position) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    return u_Mvp * position;
  } else {
    return project_common_position_to_clipspace(position);
  }
}
`,zs=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,zu=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};

layout(std140) uniform LayerUniforms {
  mat4 u_Mvp;
  vec2 u_sceneCenterMercator;
};
`,Zu=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,lc=/precision\s+(high|low|medium)p\s+float/,cc=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,ja=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,jf=/void\s+main\s*\([^)]*\)\s*\{\n?/,fc=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"moduleCache",{}),(0,D.Z)(this,"rawContentCache",{})}return(0,h.Z)(S,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:lu,fs:lu}),this.registerModule("decode",{vs:hs,fs:""}),this.registerModule("scene_uniforms",{vs:zu,fs:zu}),this.registerModule("picking_uniforms",{vs:Js,fs:Js}),this.registerModule("projection",{vs:cu,fs:cu}),this.registerModule("project",{vs:eu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Zu}),this.registerModule("lighting",{vs:gl,fs:""}),this.registerModule("light",{vs:Ef,fs:""}),this.registerModule("picking",{vs:Ws,fs:yl}),this.registerModule("rotation_2d",{vs:zs,fs:""})}},{key:"registerModule",value:function(re,ce){ce.vs=ce.vs.replace(/\r\n/g,`
`),ce.fs=ce.fs.replace(/\r\n/g,`
`);var G=ce.vs,xe=ce.fs,ut=ce.uniforms,Dt=ce.inject,dt=j(G),It=dt.content,Tr=dt.uniforms,Yr=j(xe),wn=Yr.content,Bn=Yr.uniforms;this.rawContentCache[re]={fs:wn,inject:Dt,uniforms:(0,F.Z)((0,F.Z)((0,F.Z)({},Tr),Bn),ut),vs:It}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(re){var ce=this,G=this.rawContentCache[re].vs,xe=this.rawContentCache[re].fs,ut=this.rawContentCache[re].inject,Dt={};ut!=null&&ut["vs:#decl"]&&(G=(ut==null?void 0:ut["vs:#decl"])+G,Dt=j(ut==null?void 0:ut["vs:#decl"]).uniforms),ut!=null&&ut["vs:#main-start"]&&(G=G.replace(jf,function(Ri){return Ri+(ut==null?void 0:ut["vs:#main-start"])})),ut!=null&&ut["fs:#decl"]&&(xe=(ut==null?void 0:ut["fs:#decl"])+xe);var dt=this.processModule(G,[],"vs"),It=dt.content,Tr=dt.includeList,Yr=this.processModule(xe,[],"fs"),wn=Yr.content,Bn=Yr.includeList,Kn="",fi=Ol(Tr.concat(Bn).concat(re)).reduce(function(Ri,Pi){return(0,F.Z)((0,F.Z)({},Ri),ce.rawContentCache[Pi].uniforms)},(0,F.Z)({},Dt));lc.test(wn)||(Kn=Kn+cc),Kn=Kn+wn;var Gr="";return lc.test(It)||(Gr=Gr+cc),Gr=Gr+It,this.moduleCache[re]={fs:Kn.trim(),uniforms:fi,vs:Gr.trim()},this.moduleCache[re]}},{key:"processModule",value:function(re,ce,G){var xe=this,ut=re.replace(ja,function(Dt,dt){var It=dt.split(" "),Tr=It[0].replace(/"/g,"");if(ce.indexOf(Tr)>-1)return"";var Yr=xe.rawContentCache[Tr][G];ce.push(Tr);var wn=xe.processModule(Yr,ce,G),Bn=wn.content;return Bn});return{content:ut,includeList:ce}}},{key:"injectDefines",value:function(re){var ce=Object.keys(re).reduce(function(G,xe){return G+"#define ".concat(xe.toUpperCase()," ").concat(re[xe],`;
`)},`
`);return ce}}]),S}(),Il=x(73237),co=function(){function S(){(0,z.Z)(this,S),(0,D.Z)(this,"shaderModuleService",void 0),(0,D.Z)(this,"rendererService",void 0),(0,D.Z)(this,"cameraService",void 0),(0,D.Z)(this,"mapService",void 0),(0,D.Z)(this,"interactionService",void 0),(0,D.Z)(this,"layerService",void 0),(0,D.Z)(this,"config",void 0)}return(0,h.Z)(S,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return X.Normal}},{key:"init",value:function(re,ce){this.config=ce,this.rendererService=re.getContainer().rendererService,this.cameraService=re.getContainer().cameraService,this.mapService=re.getContainer().mapService,this.interactionService=re.getContainer().interactionService,this.layerService=re.getContainer().layerService,this.shaderModuleService=re.getContainer().shaderModuleService}},{key:"render",value:function(re){}}]),S}();function Qc(S){var Ge=Jc();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Jc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Ho=function(S){(0,Wr.Z)(re,S);var Ge=Qc(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(G,xe){(0,Il.Z)((0,Xr.Z)(re.prototype),"init",this).call(this,G,xe)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),re}(co);function wu(S,Ge){var re=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!re){if(Array.isArray(S)||(re=fu(S))||Ge&&S&&typeof S.length=="number"){re&&(S=re);var ce=0,G=function(){};return{s:G,n:function(){return ce>=S.length?{done:!0}:{done:!1,value:S[ce++]}},e:function(It){throw It},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xe=!0,ut=!1,Dt;return{s:function(){re=re.call(S)},n:function(){var It=re.next();return xe=It.done,It},e:function(It){ut=!0,Dt=It},f:function(){try{!xe&&re.return!=null&&re.return()}finally{if(ut)throw Dt}}}}function fu(S,Ge){if(S){if(typeof S=="string")return hu(S,Ge);var re=Object.prototype.toString.call(S).slice(8,-1);if(re==="Object"&&S.constructor&&(re=S.constructor.name),re==="Map"||re==="Set")return Array.from(S);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return hu(S,Ge)}}function hu(S,Ge){(Ge==null||Ge>S.length)&&(Ge=S.length);for(var re=0,ce=new Array(Ge);re<Ge;re++)ce[re]=S[re];return ce}var Ql=function(){function S(Ge){(0,z.Z)(this,S),(0,D.Z)(this,"passes",[]),(0,D.Z)(this,"layer",void 0),(0,D.Z)(this,"renderFlag",void 0),(0,D.Z)(this,"width",0),(0,D.Z)(this,"height",0),this.postProcessor=Ge}return(0,h.Z)(S,[{key:"setLayer",value:function(re){this.layer=re}},{key:"setRenderFlag",value:function(re){this.renderFlag=re}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(){var G,xe,ut;return Or().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:G=wu(this.passes),dt.prev=1,G.s();case 3:if((xe=G.n()).done){dt.next=9;break}return ut=xe.value,dt.next=7,ut.render(this.layer);case 7:dt.next=3;break;case 9:dt.next=14;break;case 11:dt.prev=11,dt.t0=dt.catch(1),G.e(dt.t0);case 14:return dt.prev=14,G.f(),dt.finish(14);case 17:return dt.next=19,this.postProcessor.render(this.layer);case 19:case"end":return dt.stop()}},ce,this,[[1,11,14,17]])}));function re(){return Ge.apply(this,arguments)}return re}()},{key:"resize",value:function(re,ce){(this.width!==re||this.height!==ce)&&(this.postProcessor.resize(re,ce),this.width=re,this.height=ce)}},{key:"add",value:function(re,ce){re.getType()===X.PostProcessing?this.postProcessor.add(re,this.layer,ce):(re.init(this.layer,ce),this.passes.push(re))}},{key:"insert",value:function(re,ce,G){re.init(this.layer,ce),this.passes.splice(G,0,re)}},{key:"destroy",value:function(){this.passes.length=0}}]),S}();function _l(S){var Ge=tu();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function tu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Jl=function(S){(0,Wr.Z)(re,S);var Ge=_l(re);function re(){var ce;(0,z.Z)(this,re);for(var G=arguments.length,xe=new Array(G),ut=0;ut<G;ut++)xe[ut]=arguments[ut];return ce=Ge.call.apply(Ge,[this].concat(xe)),(0,D.Z)((0,gr.Z)(ce),"pickingFBO",void 0),(0,D.Z)((0,gr.Z)(ce),"layer",void 0),(0,D.Z)((0,gr.Z)(ce),"width",0),(0,D.Z)((0,gr.Z)(ce),"height",0),(0,D.Z)((0,gr.Z)(ce),"alreadyInRendering",!1),(0,D.Z)((0,gr.Z)(ce),"pickFromPickingFBO",function(Dt){var dt=Dt.x,It=Dt.y,Tr=Dt.lngLat,Yr=Dt.type;if(!(!ce.layer.isVisible()||!ce.layer.needPick(Yr))){var wn=ce.rendererService,Bn=wn.getViewportSize,Kn=wn.readPixelsAsync,fi=wn.useFramebuffer,Gr=Bn(),Ri=Gr.width,Pi=Gr.height,Mi=ce.layer.getLayerConfig(),wa=Mi.enableHighlight,Ja=Mi.enableSelect,La=dt*P.SO.DPR,ya=It*P.SO.DPR;if(!(La>Ri||La<0||ya>Pi||ya<0)){var Gi;fi(ce.pickingFBO,(0,nn.Z)(Or().mark(function zn(){var Fn,$a,_a,Ra,Ma;return Or().wrap(function(qo){for(;;)switch(qo.prev=qo.next){case 0:return qo.next=2,Kn({x:Math.round(La),y:Math.round(Pi-(It+1)*P.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:ce.pickingFBO});case 2:Gi=qo.sent,Gi[0]!==0||Gi[1]!==0||Gi[2]!==0?($a=(0,P.W0)(Gi),_a=ce.layer.getSource().getFeatureById($a),Ra={x:dt,y:It,type:Yr,lngLat:Tr,featureId:$a,feature:_a},_a&&(ce.layer.setCurrentPickId($a),ce.triggerHoverOnLayer(Ra))):(Ma={x:dt,y:It,lngLat:Tr,type:ce.layer.getCurrentPickId()===null?"un"+Yr:"mouseout",featureId:null,feature:null},ce.triggerHoverOnLayer((0,F.Z)((0,F.Z)({},Ma),{},{type:"unpick"})),ce.triggerHoverOnLayer(Ma),ce.layer.setCurrentPickId(null)),wa&&ce.highlightPickedFeature(Gi),Ja&&Yr==="click"&&((Fn=Gi)===null||Fn===void 0?void 0:Fn.toString())!==[0,0,0,0].toString()&&ce.selectFeature(Gi);case 6:case"end":return qo.stop()}},zn)})))}}}),ce}return(0,h.Z)(re,[{key:"getType",value:function(){return X.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(G,xe){(0,Il.Z)((0,Xr.Z)(re.prototype),"init",this).call(this,G,xe),this.layer=G;var ut=this.rendererService,Dt=ut.createTexture2D,dt=ut.createFramebuffer,It=ut.getViewportSize,Tr=It(),Yr=Tr.width,wn=Tr.height,Bn=Dt({width:Yr,height:wn,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=dt({color:Bn}),this.interactionService.on($t.Hover,this.pickFromPickingFBO),this.interactionService.on($t.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on($t.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(G){var xe=this;if(!this.alreadyInRendering){var ut=this.rendererService,Dt=ut.getViewportSize,dt=ut.useFramebuffer,It=ut.clear,Tr=Dt(),Yr=Tr.width,wn=Tr.height;this.alreadyInRendering=!0,(this.width!==Yr||this.height!==wn)&&(this.pickingFBO.resize({width:Yr,height:wn}),this.width=Yr,this.height=wn),dt(this.pickingFBO,function(){It({framebuffer:xe.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var Bn=xe.layer.multiPassRenderer.getRenderFlag();xe.layer.multiPassRenderer.setRenderFlag(!1),G.hooks.beforePickingEncode.call(),G.render(),G.hooks.afterPickingEncode.call(),xe.layer.multiPassRenderer.setRenderFlag(Bn),xe.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(G){this.layer.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(G){var xe=(0,Fi.Z)(G,3),ut=xe[0],Dt=xe[1],dt=xe[2];this.layer.hooks.beforeHighlight.call([ut,Dt,dt]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(G){var xe=(0,Fi.Z)(G,3),ut=xe[0],Dt=xe[1],dt=xe[2];this.layer.hooks.beforeSelect.call([ut,Dt,dt]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(G){var xe=G.featureId,ut=(0,P.Z6)(xe);this.selectFeature(new Uint8Array(ut))}},{key:"highlightFeatureHandle",value:function(G){var xe=G.featureId,ut=(0,P.Z6)(xe);this.highlightPickedFeature(new Uint8Array(ut))}}]),re}(co),sl=function(){function S(Ge){(0,z.Z)(this,S),(0,D.Z)(this,"passes",[]),(0,D.Z)(this,"readFBO",void 0),(0,D.Z)(this,"writeFBO",void 0),this.rendererService=Ge,this.init()}return(0,h.Z)(S,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var re=this.rendererService,ce=re.getViewportSize,G=re.createTexture2D,xe=ce(),ut=xe.width,Dt=xe.height;return G({x:0,y:0,width:ut,height:Dt,copy:!0})}},{key:"getReadFBOTex",value:function(){var re=this,ce=this.rendererService.useFramebuffer;return new Promise(function(G){ce(re.readFBO,(0,nn.Z)(Or().mark(function xe(){return Or().wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:G(re.getCurrentFBOTex());case 1:case"end":return Dt.stop()}},xe)})))})}},{key:"renderBloomPass",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G,xe){var ut,Dt;return Or().wrap(function(It){for(;;)switch(It.prev=It.next){case 0:return It.next=2,this.getReadFBOTex();case 2:ut=It.sent,Dt=0;case 4:if(!(Dt<4)){It.next=11;break}return It.next=7,xe.render(G,ut);case 7:this.swap(),Dt++,It.next=4;break;case 11:case"end":return It.stop()}},ce,this)}));function re(ce,G){return Ge.apply(this,arguments)}return re}()},{key:"render",value:function(){var Ge=(0,nn.Z)(Or().mark(function ce(G){var xe,ut;return Or().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:xe=0;case 1:if(!(xe<this.passes.length)){dt.next=15;break}if(ut=this.passes[xe],ut.setRenderToScreen(this.isLastEnabledPass(xe)),ut.getName()!=="bloom"){dt.next=9;break}return dt.next=7,this.renderBloomPass(G,ut);case 7:dt.next=12;break;case 9:return dt.next=11,ut.render(G);case 11:xe!==this.passes.length-1&&this.swap();case 12:xe++,dt.next=1;break;case 15:case"end":return dt.stop()}},ce,this)}));function re(ce){return Ge.apply(this,arguments)}return re}()},{key:"resize",value:function(re,ce){this.readFBO.resize({width:re,height:ce}),this.writeFBO.resize({width:re,height:ce})}},{key:"add",value:function(re,ce,G){re.init(ce,G),this.passes.push(re)}},{key:"insert",value:function(re,ce,G,xe){re.init(G,xe),this.passes.splice(ce,0,re)}},{key:"getPostProcessingPassByName",value:function(re){return this.passes.find(function(ce){return ce.getName()===re})}},{key:"init",value:function(){var re=this.rendererService,ce=re.createFramebuffer,G=re.createTexture2D;this.readFBO=ce({color:G({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})}),this.writeFBO=ce({color:G({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(re){for(var ce=re+1;ce<this.passes.length;ce++)if(this.passes[ce].isEnabled())return!1;return!0}},{key:"swap",value:function(){var re=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=re}}]),S}();function ru(S){var Ge=Wo();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Wo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var eo=function(S){(0,Wr.Z)(re,S);var Ge=ru(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"getType",value:function(){return X.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(G,xe){(0,Il.Z)((0,Xr.Z)(re.prototype),"init",this).call(this,G,xe)}},{key:"render",value:function(G){var xe=this.rendererService,ut=xe.useFramebuffer,Dt=xe.clear,dt=G.multiPassRenderer.getPostProcessor().getReadFBO();ut(dt,function(){Dt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:dt}),G.multiPassRenderer.setRenderFlag(!1),G.models.forEach(function(It){It.draw({uniforms:G.layerModel.getUninforms()})}),G.multiPassRenderer.setRenderFlag(!0)})}}]),re}(co);function fo(S){var Ge=Ru();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Ru(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Sf=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,Vu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,hc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Pl(S,Ge){for(var re=0,ce=1/Ge,G=S;G>0;)re=re+ce*(G%Ge),G=Math.floor(G/Ge),ce=ce/Ge;return re}var Zs=1,Mu=function(S){(0,Wr.Z)(re,S);var Ge=fo(re);function re(ce){var G;return(0,z.Z)(this,re),G=Ge.call(this),(0,D.Z)((0,gr.Z)(G),"haltonSequence",[]),(0,D.Z)((0,gr.Z)(G),"accumulatingId",0),(0,D.Z)((0,gr.Z)(G),"frame",0),(0,D.Z)((0,gr.Z)(G),"timer",void 0),(0,D.Z)((0,gr.Z)(G),"sampleRenderTarget",void 0),(0,D.Z)((0,gr.Z)(G),"prevRenderTarget",void 0),(0,D.Z)((0,gr.Z)(G),"outputRenderTarget",void 0),(0,D.Z)((0,gr.Z)(G),"copyRenderTarget",void 0),(0,D.Z)((0,gr.Z)(G),"blendModel",void 0),(0,D.Z)((0,gr.Z)(G),"outputModel",void 0),(0,D.Z)((0,gr.Z)(G),"copyModel",void 0),G.shaderModuleService=ce,G}return(0,h.Z)(re,[{key:"getType",value:function(){return X.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(G,xe){(0,Il.Z)((0,Xr.Z)(re.prototype),"init",this).call(this,G,xe);var ut=this.rendererService,Dt=ut.createFramebuffer,dt=ut.createTexture2D;this.sampleRenderTarget=Dt({color:dt({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})}),this.prevRenderTarget=Dt({color:dt({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})}),this.outputRenderTarget=Dt({color:dt({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})}),this.copyRenderTarget=Dt({color:dt({width:1,height:1,wrapS:W.CLAMP_TO_EDGE,wrapT:W.CLAMP_TO_EDGE})});for(var It=0;It<30;It++)this.haltonSequence.push([Pl(It,2),Pl(It,3)]);this.blendModel=this.createTriangleModel("blend-pass",Sf),this.outputModel=this.createTriangleModel("copy-pass",Vu,{blend:{enable:!0,func:{srcRGB:W.ONE,dstRGB:W.ONE_MINUS_SRC_ALPHA,srcAlpha:W.ONE,dstAlpha:W.ONE_MINUS_SRC_ALPHA},equation:{rgb:W.FUNC_ADD,alpha:W.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Vu)}},{key:"render",value:function(G){var xe=this,ut=this.rendererService,Dt=ut.clear,dt=ut.getViewportSize,It=ut.useFramebuffer,Tr=dt(),Yr=Tr.width,wn=Tr.height;this.sampleRenderTarget.resize({width:Yr,height:wn}),this.prevRenderTarget.resize({width:Yr,height:wn}),this.outputRenderTarget.resize({width:Yr,height:wn}),this.copyRenderTarget.resize({width:Yr,height:wn}),this.resetFrame(),this.stopAccumulating();var Bn=G.multiPassRenderer.getPostProcessor().getReadFBO();It(Bn,function(){Dt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Bn}),G.multiPassRenderer.setRenderFlag(!1),G.render(),G.multiPassRenderer.setRenderFlag(!0)});var Kn=function fi(Gr){!xe.accumulatingId||Gr!==xe.accumulatingId||xe.isFinished()||(xe.doRender(G),window.requestAnimationFrame(function(){fi(Gr)}))};this.accumulatingId=Zs++,this.timer=window.setTimeout(function(){Kn(xe.accumulatingId)},50)}},{key:"doRender",value:function(G){var xe=this,ut=this.rendererService,Dt=ut.clear,dt=ut.getViewportSize,It=ut.useFramebuffer,Tr=dt(),Yr=Tr.width,wn=Tr.height,Bn=G.getLayerConfig(),Kn=Bn.jitterScale,fi=Kn===void 0?1:Kn,Gr=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Gr[0]*2-1)/Yr*fi,(Gr[1]*2-1)/wn*fi),G.multiPassRenderer.setRenderFlag(!1),G.hooks.beforeRender.call(),It(this.sampleRenderTarget,function(){Dt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:xe.sampleRenderTarget}),G.render()}),G.hooks.afterRender.call(),G.multiPassRenderer.setRenderFlag(!0);var Ri=G.getLayerConfig();It(this.outputRenderTarget,function(){xe.blendModel.draw({uniforms:{u_opacity:Ri.opacity||1,u_MixRatio:xe.frame===0?1:.9,u_Diffuse1:xe.sampleRenderTarget,u_Diffuse2:xe.frame===0?G.multiPassRenderer.getPostProcessor().getReadFBO():xe.prevRenderTarget}})}),this.frame===0&&Dt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(It(this.copyRenderTarget,function(){xe.outputModel.draw({uniforms:{u_Texture:xe.outputRenderTarget}})}),It(G.multiPassRenderer.getPostProcessor().getReadFBO(),function(){xe.copyModel.draw({uniforms:{u_Texture:xe.copyRenderTarget}})}),G.multiPassRenderer.getPostProcessor().render(G));var Pi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Pi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(G,xe,ut){this.shaderModuleService.registerModule(G,{vs:hc,fs:xe});var Dt=this.shaderModuleService.getModule(G),dt=Dt.vs,It=Dt.fs,Tr=Dt.uniforms,Yr=this.rendererService,wn=Yr.createAttribute,Bn=Yr.createBuffer,Kn=Yr.createModel;return Kn((0,F.Z)({vs:dt,fs:It,attributes:{a_Position:wn({buffer:Bn({data:[-4,-4,4,-4,0,4],type:W.FLOAT}),size:2})},uniforms:(0,F.Z)({},Tr),depth:{enable:!1},count:3},ut))}}]),re}(co);function pu(S){var Ge=ju();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function ju(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var kl=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,Dl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$u=P.rU.isNil,pc=function(S){(0,Wr.Z)(re,S);var Ge=pu(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Dl,fs:kl});var G=this.shaderModuleService.getModule("blur-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}},{key:"convertOptionsToUniforms",value:function(G){var xe={};return $u(G.bloomRadius)||(xe.u_radius=G.bloomRadius),$u(G.bloomIntensity)||(xe.u_intensity=G.bloomIntensity),$u(G.bloomBaseRadio)||(xe.u_baseRadio=G.bloomBaseRadio),xe}}]),re}(ee);function Hu(S){var Ge=Rs();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Rs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var ef=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,kc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,tf=P.rU.isNil,xl=function(S){(0,Wr.Z)(re,S);var Ge=Hu(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:kc,fs:ef});var G=this.shaderModuleService.getModule("blur-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}},{key:"convertOptionsToUniforms",value:function(G){var xe={};return tf(G.blurRadius)||(xe.u_BlurDir=[G.blurRadius,0]),xe}}]),re}(ee);function Ou(S){var Ge=Ll();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Ll(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Bl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Wu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Tf=P.rU.isNil,dc=function(S){(0,Wr.Z)(re,S);var Ge=Ou(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Wu,fs:Bl});var G=this.shaderModuleService.getModule("blur-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}},{key:"convertOptionsToUniforms",value:function(G){var xe={};return Tf(G.blurRadius)||(xe.u_BlurDir=[0,G.blurRadius]),xe}}]),re}(ee);function rf(S){var Ge=vc();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function vc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var nf=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,ec=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mc=function(S){(0,Wr.Z)(re,S);var Ge=rf(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:ec,fs:nf});var G=this.shaderModuleService.getModule("colorhalftone-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}}]),re}(ee);function Gs(S){var Ge=du();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var as=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Dc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,bl=function(S){(0,Wr.Z)(re,S);var Ge=Gs(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Dc,fs:as}),this.shaderModuleService.getModule("copy-pass")}}]),re}(ee);function uo(S){var Ge=Lc();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Lc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var Vs=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,ul=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ca=function(S){(0,Wr.Z)(re,S);var Ge=uo(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:ul,fs:Vs});var G=this.shaderModuleService.getModule("hexagonalpixelate-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}}]),re}(ee);function lo(S){var Ge=Xs();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Xs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var gc=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Gu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,vu=function(S){(0,Wr.Z)(re,S);var Ge=lo(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Gu,fs:gc});var G=this.shaderModuleService.getModule("ink-pass"),xe=G.vs,ut=G.fs,Dt=G.uniforms,dt=this.rendererService.getViewportSize(),It=dt.width,Tr=dt.height;return{vs:xe,fs:ut,uniforms:(0,F.Z)((0,F.Z)({},Dt),{},{u_ViewportSize:[It,Tr]})}}}]),re}(ee);function Af(S){var Ge=Bc();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Bc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var yc=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Fl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,os=function(S){(0,Wr.Z)(re,S);var Ge=Af(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Fl,fs:yc}),this.shaderModuleService.getModule("noise-pass")}}]),re}(ee);function So(S){var Ge=Nl();return function(){var ce=(0,Xr.Z)(S),G;if(Ge){var xe=(0,Xr.Z)(this).constructor;G=Reflect.construct(ce,arguments,xe)}else G=ce.apply(this,arguments);return(0,Dr.Z)(this,G)}}function Nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(S){return!1}}var af=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,wo=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,ii=function(S){(0,Wr.Z)(re,S);var Ge=So(re);function re(){return(0,z.Z)(this,re),Ge.apply(this,arguments)}return(0,h.Z)(re,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:af,fs:wo}),this.shaderModuleService.getModule("sepia-pass")}}]),re}(ee),Ms=new Do,tc=0;function Ul(){var S=new fc,Ge=new Va,re=new ei,ce=new so(re),G=new Rn,xe=new sa,ut=new ji,Dt=new Hs,dt=new Nr,It={id:"".concat(tc++),globalConfigService:Ms,shaderModuleService:S,debugService:Ge,cameraService:re,coordinateSystemService:ce,fontService:G,iconService:xe,markerService:ut,popupService:Dt,controlService:dt,customRenderService:{}},Tr=new al(It);It.layerService=Tr;var Yr=new qc(It);It.sceneService=Yr;var wn=new Pr(It);It.interactionService=wn;var Bn=new ws(It);It.pickingService=Bn;var Kn={clear:new Ho,pixelPicking:new Jl,render:new eo,taa:new Mu(S)};It.normalPassFactory=function(Gr){return Kn[Gr]};var fi={copy:new bl,bloom:new pc,blurH:new xl,blurV:new dc,noise:new os,sepia:new ii,colorHalftone:new mc,hexagonalPixelate:new Ca,ink:new vu};return It.postProcessingPass=fi,It.postProcessingPassFactory=function(Gr){return fi[Gr]},It}function ps(S){var Ge=(0,F.Z)({},S);return Ge.postProcessor=new sl(Ge.rendererService),Ge.multiPassRenderer=new Ql(Ge.postProcessor),Ge.styleAttributeService=new ql(Ge.rendererService),Ge}var to=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],zl=function(S){return S.IMAGE="image",S.CUSTOMIMAGE="customImage",S.ARRAYBUFFER="arraybuffer",S.RGB="rgb",S.TERRAINRGB="terrainRGB",S.CUSTOMRGB="customRGB",S.CUSTOMARRAYBUFFER="customArrayBuffer",S.CUSTOMTERRAINRGB="customTerrainRGB",S}({})},83366:function(He,w,x){"use strict";x.d(w,{Z:function(){return pi}});var F=x(15671),z=x(43144),h=x(60136),D=x(82963),P=x(61120),X=x(1413),W=function(){function it(V){(0,F.Z)(this,it),this.config=V}return(0,z.Z)(it,[{key:"setContainer",value:function(H,Ee,Le){this.configService=H.globalConfigService,H.mapConfig=(0,X.Z)((0,X.Z)({},this.config),{},{id:Ee,canvas:Le}),H.mapService=new(this.getServiceConstructor())(H)}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),it}(),fe=x(45987),J=x(15861),Be=x(97326),B=x(4942),ee=x(64687),U=x.n(ee),q=x(85975),le=x(77160),j=x(6158),Ce=x.n(j),$e=x(88120),Fe=x(57059),lt=x(26729),We=function(){function it(V){(0,F.Z)(this,it),(0,B.Z)(this,"size",1e4),this.size=V||1e4}return(0,z.Z)(it,[{key:"setSize",value:function(H){this.size=H}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(H){return(180+H)/360*this.size}},{key:"mercatorYfromLat",value:function(H){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(H){return H/this.size*360-180}},{key:"latFromMercatorY",value:function(H){var Ee=180-(1-H/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(Ee*Math.PI/180))-90}},{key:"project",value:function(H){var Ee=this.mercatorXfromLng(H[0]),Le=this.mercatorYfromLat(H[1]);return[Ee,Le]}},{key:"unproject",value:function(H){var Ee=this.lngFromMercatorX(H[0]),Le=this.latFromMercatorY(H[1]);return[Ee,Le]}}]),it}(),Ze={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},pe={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},se=12,be=function(){function it(V){var H=this;(0,F.Z)(this,it),(0,B.Z)(this,"version","DEFAUlTMAP"),(0,B.Z)(this,"simpleMapCoord",new We),(0,B.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,B.Z)(this,"handleCameraChanged",function(Ee){var Le=H.map.getCenter(),ze=Le.lat,xt=Le.lng;H.emit("mapchange"),H.viewport.syncWithMapCamera({bearing:H.map.getBearing(),center:[xt,ze],viewportHeight:H.map.transform.height,pitch:H.map.getPitch(),viewportWidth:H.map.transform.width,zoom:H.map.getZoom(),cameraHeight:0}),H.updateCoordinateSystemService(),H.cameraChangedCallback(H.viewport)}),this.config=V.mapConfig,this.configService=V.globalConfigService,this.coordinateSystemService=V.coordinateSystemService,this.eventEmitter=new lt.EventEmitter}return(0,z.Z)(it,[{key:"setBgColor",value:function(H){this.bgColor=H}},{key:"addMarkerContainer",value:function(){var H=this.map.getCanvasContainer();this.markerContainer=Fe.SO.create("div","l7-marker-container",H),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"getCanvasOverlays",value:function(){}},{key:"on",value:function(H,Ee){$e.I9.indexOf(H)!==-1?this.eventEmitter.on(H,Ee):this.map.on(pe[H]||H,Ee)}},{key:"off",value:function(H,Ee){this.map.off(pe[H]||H,Ee),this.eventEmitter.off(H,Ee)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();var H=this.map.transform;return[H.width,H.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(H){return this.map.setZoom(H)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(H){this.map.setCenter(H)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(H){this.map.setBearing(H)}},{key:"zoomIn",value:function(H,Ee){this.map.zoomIn(H,Ee)}},{key:"zoomOut",value:function(H,Ee){this.map.zoomOut(H,Ee)}},{key:"setPitch",value:function(H){return this.map.setPitch(H)}},{key:"panTo",value:function(H){this.map.panTo(H)}},{key:"panBy",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy([H,Ee])}},{key:"fitBounds",value:function(H,Ee){this.map.fitBounds(H,Ee)}},{key:"setMaxZoom",value:function(H){this.map.setMaxZoom(H)}},{key:"setMinZoom",value:function(H){this.map.setMinZoom(H)}},{key:"setMapStatus",value:function(H){H.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),H.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),H.dragEnable===!1&&this.map.dragPan.disable(),H.dragEnable===!0&&this.map.dragPan.enable(),H.rotateEnable===!1&&this.map.dragRotate.disable(),H.dragEnable===!0&&this.map.dragRotate.enable(),H.keyboardEnable===!1&&this.map.keyboard.disable(),H.keyboardEnable===!0&&this.map.keyboard.enable(),H.zoomEnable===!1&&this.map.scrollZoom.disable(),H.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(H,Ee){this.map.flyTo({zoom:H,center:Ee})}},{key:"setMapStyle",value:function(H){this.map.setStyle(this.getMapStyleValue(H))}},{key:"meterToCoord",value:function(H,Ee){return 1}},{key:"pixelToLngLat",value:function(H){return this.map.unproject(H)}},{key:"lngLatToPixel",value:function(H){return this.map.project(H)}},{key:"containerToLngLat",value:function(H){return this.map.unproject(H)}},{key:"lngLatToContainer",value:function(H){return this.map.project(H)}},{key:"getMapStyle",value:function(){try{var H,Ee=(H=this.map.getStyle().sprite)!==null&&H!==void 0?H:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(Ee)?Ee==null?void 0:Ee.replace(/\/\w+$/,"").replace(/sprites/,"styles"):Ee}catch(Le){return""}}},{key:"getMapStyleConfig",value:function(){return Ze}},{key:"getMapStyleValue",value:function(H){var Ee;return(Ee=this.getMapStyleConfig()[H])!==null&&Ee!==void 0?Ee:H}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(H){for(var Ee,Le=arguments.length,ze=new Array(Le>1?Le-1:0),xt=1;xt<Le;xt++)ze[xt-1]=arguments[xt];(Ee=this.eventEmitter).emit.apply(Ee,[H].concat(ze))}},{key:"once",value:function(H){for(var Ee,Le=arguments.length,ze=new Array(Le>1?Le-1:0),xt=1;xt<Le;xt++)ze[xt-1]=arguments[xt];(Ee=this.eventEmitter).once.apply(Ee,[H].concat(ze))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(H){var Ee=this.map.getCanvas(),Le=H==="jpg"?Ee==null?void 0:Ee.toDataURL("image/jpeg"):Ee==null?void 0:Ee.toDataURL("image/png");return Le}},{key:"onCameraChanged",value:function(H){this.cameraChangedCallback=H}},{key:"creatMapContainer",value:function(H){var Ee=H;return typeof H=="string"&&(Ee=document.getElementById(H)),Ee}},{key:"updateView",value:function(H){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:H.bearing,center:H.center,viewportHeight:H.viewportHeight,pitch:H.pitch,viewportWidth:H.viewportWidth,zoom:H.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var H=this.config.offsetCoordinate,Ee=H===void 0?!0:H;this.viewport.getZoom()>se&&Ee?this.coordinateSystemService.setCoordinateSystem($e.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem($e.lo.LNGLAT)}}]),it}(),Te=x(97685),de=x(98333);function Rt(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ye(it,V){var H=de.fF([],V,it);return de.bA(H,H,1/H[3]),H}function Ve(it,V){var H=it%V;return H<0?V+H:H}function oe(it,V,H){return H*V+(1-H)*it}var Re=x(31437);function Se(it,V){if(!it)throw new Error(V||"viewport-mercator-project: assertion failed.")}var et=Math.PI,st=et/4,pt=et/180,bt=180/et,ke=512,ur=4003e4,qt=1.5;function _n(it){return Math.pow(2,it)}function Zr(it){return Math.log2(it)}function Vr(it,V){var H=(0,Te.Z)(it,2),Ee=H[0],Le=H[1];Se(Number.isFinite(Ee)&&Number.isFinite(V)),Se(Number.isFinite(Le)&&Le>=-90&&Le<=90,"invalid latitude"),V*=ke;var ze=Ee*pt,xt=Le*pt,Ut=V*(ze+et)/(2*et),ir=V*(et-Math.log(Math.tan(st+xt*.5)))/(2*et);return[Ut,ir]}function rn(it,V){var H=(0,Te.Z)(it,2),Ee=H[0],Le=H[1];V*=ke;var ze=Ee/V*(2*et)-et,xt=2*(Math.atan(Math.exp(et-Le/V*(2*et)))-st);return[ze*bt,xt*bt]}function Qr(it){var V=it.latitude;assert(Number.isFinite(V));var H=Math.cos(V*pt);return Zr(ur*H)-9}function ln(it){var V=it.latitude,H=it.longitude,Ee=it.zoom,Le=it.scale,ze=it.highPrecision,xt=ze===void 0?!1:ze;Le=Le!==void 0?Le:_n(Ee),Se(Number.isFinite(V)&&Number.isFinite(H)&&Number.isFinite(Le));var Ut={},ir=ke*Le,Ft=Math.cos(V*pt),te=ir/360,Q=te/Ft,ve=ir/ur/Ft;if(Ut.pixelsPerMeter=[ve,-ve,ve],Ut.metersPerPixel=[1/ve,-1/ve,1/ve],Ut.pixelsPerDegree=[te,-Q,ve],Ut.degreesPerPixel=[1/te,-1/Q,1/ve],xt){var Oe=pt*Math.tan(V*pt)/Ft,Xe=te*Oe/2,ft=ir/ur*Oe,Et=ft/Q*ve;Ut.pixelsPerDegree2=[0,-Xe,ft],Ut.pixelsPerMeter2=[Et,0,Et]}return Ut}function vn(it,V){var H=_slicedToArray(it,3),Ee=H[0],Le=H[1],ze=H[2],xt=_slicedToArray(V,3),Ut=xt[0],ir=xt[1],Ft=xt[2],te=1,Q=ln({longitude:Ee,latitude:Le,scale:te,highPrecision:!0}),ve=Q.pixelsPerMeter,Oe=Q.pixelsPerMeter2,Xe=Vr(it,te);Xe[0]+=Ut*(ve[0]+Oe[0]*ir),Xe[1]+=ir*(ve[1]+Oe[1]*ir);var ft=rn(Xe,te),Et=(ze||0)+(Ft||0);return Number.isFinite(ze)||Number.isFinite(Ft)?[ft[0],ft[1],Et]:ft}function $t(it){var V=it.height,H=it.pitch,Ee=it.bearing,Le=it.altitude,ze=it.center,xt=ze===void 0?null:ze,Ut=it.flipY,ir=Ut===void 0?!1:Ut,Ft=Rt();return q.translate(Ft,Ft,[0,0,-Le]),q.scale(Ft,Ft,[1,1,1/V]),q.rotateX(Ft,Ft,-H*pt),q.rotateZ(Ft,Ft,Ee*pt),ir&&q.scale(Ft,Ft,[1,-1,1]),xt&&q.translate(Ft,Ft,le.negate([],xt)),Ft}function _r(it){var V=it.width,H=it.height,Ee=it.altitude,Le=Ee===void 0?qt:Ee,ze=it.pitch,xt=ze===void 0?0:ze,Ut=it.nearZMultiplier,ir=Ut===void 0?1:Ut,Ft=it.farZMultiplier,te=Ft===void 0?1:Ft,Q=xt*pt,ve=Math.atan(.5/Le),Oe=Math.sin(ve)*Le/Math.sin(Math.PI/2-Q-ve),Xe=Math.cos(Math.PI/2-Q)*Oe+Le;return{fov:2*Math.atan(H/2/Le),aspect:V/H,focalDistance:Le,near:ir,far:Xe*te}}function kt(it){var V=it.width,H=it.height,Ee=it.pitch,Le=it.altitude,ze=it.nearZMultiplier,xt=it.farZMultiplier,Ut=_r({width:V,height:H,altitude:Le,pitch:Ee,nearZMultiplier:ze,farZMultiplier:xt}),ir=Ut.fov,Ft=Ut.aspect,te=Ut.near,Q=Ut.far,ve=q.perspective([],ir,Ft,te,Q);return ve}function qe(it,V){var H=(0,Te.Z)(it,3),Ee=H[0],Le=H[1],ze=H[2],xt=ze===void 0?0:ze;return Se(Number.isFinite(Ee)&&Number.isFinite(Le)&&Number.isFinite(xt)),ye(V,[Ee,Le,xt,1])}function Sr(it,V){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,Ee=(0,Te.Z)(it,3),Le=Ee[0],ze=Ee[1],xt=Ee[2];if(Se(Number.isFinite(Le)&&Number.isFinite(ze),"invalid pixel coordinate"),Number.isFinite(xt)){var Ut=ye(V,[Le,ze,xt,1]);return Ut}var ir=ye(V,[Le,ze,0,1]),Ft=ye(V,[Le,ze,1,1]),te=ir[2],Q=Ft[2],ve=te===Q?0:((H||0)-te)/(Q-te);return Re.t7([],ir,Ft,ve)}var Pe=Rt(),Hr=function(){function it(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},H=V.width,Ee=V.height,Le=V.viewMatrix,ze=Le===void 0?Pe:Le,xt=V.projectionMatrix,Ut=xt===void 0?Pe:xt;(0,F.Z)(this,it),this.width=H||1,this.height=Ee||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=ze,this.projectionMatrix=Ut;var ir=Rt();q.multiply(ir,ir,this.projectionMatrix),q.multiply(ir,ir,this.viewMatrix),this.viewProjectionMatrix=ir;var Ft=Rt();q.scale(Ft,Ft,[this.width/2,-this.height/2,1]),q.translate(Ft,Ft,[1,-1,0]),q.multiply(Ft,Ft,this.viewProjectionMatrix);var te=q.invert(Rt(),Ft);if(!te)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=Ft,this.pixelUnprojectionMatrix=te,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,z.Z)(it,[{key:"equals",value:function(H){return H instanceof it?H.width===this.width&&H.height===this.height&&q.equals(H.projectionMatrix,this.projectionMatrix)&&q.equals(H.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(H){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=Ee.topLeft,ze=Le===void 0?!0:Le,xt=this.projectPosition(H),Ut=qe(xt,this.pixelProjectionMatrix),ir=(0,Te.Z)(Ut,2),Ft=ir[0],te=ir[1],Q=ze?te:this.height-te;return H.length===2?[Ft,Q]:[Ft,Q,Ut[2]]}},{key:"unproject",value:function(H){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=Ee.topLeft,ze=Le===void 0?!0:Le,xt=Ee.targetZ,Ut=(0,Te.Z)(H,3),ir=Ut[0],Ft=Ut[1],te=Ut[2],Q=ze?Ft:this.height-Ft,ve=xt&&xt*this.pixelsPerMeter,Oe=Sr([ir,Q,te],this.pixelUnprojectionMatrix,ve),Xe=this.unprojectPosition(Oe),ft=(0,Te.Z)(Xe,3),Et=ft[0],Ne=ft[1],Ue=ft[2];return Number.isFinite(te)?[Et,Ne,Ue]:Number.isFinite(xt)?[Et,Ne,xt]:[Et,Ne]}},{key:"projectPosition",value:function(H){var Ee=this.projectFlat(H),Le=(0,Te.Z)(Ee,2),ze=Le[0],xt=Le[1],Ut=(H[2]||0)*this.pixelsPerMeter;return[ze,xt,Ut]}},{key:"unprojectPosition",value:function(H){var Ee=this.unprojectFlat(H),Le=(0,Te.Z)(Ee,2),ze=Le[0],xt=Le[1],Ut=(H[2]||0)/this.pixelsPerMeter;return[ze,xt,Ut]}},{key:"projectFlat",value:function(H){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return H}},{key:"unprojectFlat",value:function(H){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return H}}]),it}();function vr(it){var V=it.width,H=it.height,Ee=it.bounds,Le=it.minExtent,ze=Le===void 0?0:Le,xt=it.maxZoom,Ut=xt===void 0?24:xt,ir=it.padding,Ft=ir===void 0?0:ir,te=it.offset,Q=te===void 0?[0,0]:te,ve=(0,Te.Z)(Ee,2),Oe=(0,Te.Z)(ve[0],2),Xe=Oe[0],ft=Oe[1],Et=(0,Te.Z)(ve[1],2),Ne=Et[0],Ue=Et[1];if(Number.isFinite(Ft)){var vt=Ft;Ft={top:vt,bottom:vt,left:vt,right:vt}}else Se(Number.isFinite(Ft.top)&&Number.isFinite(Ft.bottom)&&Number.isFinite(Ft.left)&&Number.isFinite(Ft.right));var ue=new Ie({width:V,height:H,longitude:0,latitude:0,zoom:0}),Lr=ue.project([Xe,Ue]),lr=ue.project([Ne,ft]),$r=[Math.max(Math.abs(lr[0]-Lr[0]),ze),Math.max(Math.abs(lr[1]-Lr[1]),ze)],Rn=[V-Ft.left-Ft.right-Math.abs(Q[0])*2,H-Ft.top-Ft.bottom-Math.abs(Q[1])*2];Se(Rn[0]>0&&Rn[1]>0);var nn=Rn[0]/$r[0],xr=Rn[1]/$r[1],Or=(Ft.right-Ft.left)/2/nn,sn=(Ft.bottom-Ft.top)/2/xr,xn=[(lr[0]+Lr[0])/2+Or,(lr[1]+Lr[1])/2+sn],wi=ue.unproject(xn),Nn=ue.zoom+Math.log2(Math.abs(Math.min(nn,xr)));return{longitude:wi[0],latitude:wi[1],zoom:Math.min(Nn,Ut)}}var Ie=function(it){(0,h.Z)(V,it);function V(){var H,Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Le=Ee.width,ze=Ee.height,xt=Ee.latitude,Ut=xt===void 0?0:xt,ir=Ee.longitude,Ft=ir===void 0?0:ir,te=Ee.zoom,Q=te===void 0?0:te,ve=Ee.pitch,Oe=ve===void 0?0:ve,Xe=Ee.bearing,ft=Xe===void 0?0:Xe,Et=Ee.altitude,Ne=Et===void 0?1.5:Et,Ue=Ee.nearZMultiplier,vt=Ee.farZMultiplier;(0,F.Z)(this,V),Le=Le||1,ze=ze||1;var ue=_n(Q);Ne=Math.max(.75,Ne);var Lr=Vr([Ft,Ut],ue);Lr[2]=0;var lr=kt({width:Le,height:ze,pitch:Oe,bearing:ft,altitude:Ne,nearZMultiplier:Ue||1/ze,farZMultiplier:vt||1.01}),$r=$t({height:ze,center:Lr,pitch:Oe,bearing:ft,altitude:Ne,flipY:!0});return H=(0,D.Z)(this,(0,P.Z)(V).call(this,{width:Le,height:ze,viewMatrix:$r,projectionMatrix:lr})),H.latitude=Ut,H.longitude=Ft,H.zoom=Q,H.pitch=Oe,H.bearing=ft,H.altitude=Ne,H.scale=ue,H.center=Lr,H.pixelsPerMeter=ln((0,Be.Z)((0,Be.Z)(H))).pixelsPerMeter[2],Object.freeze((0,Be.Z)((0,Be.Z)(H))),H}return(0,z.Z)(V,[{key:"projectFlat",value:function(Ee){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Vr(Ee,Le)}},{key:"unprojectFlat",value:function(Ee){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return rn(Ee,Le)}},{key:"getMapCenterByLngLatPosition",value:function(Ee){var Le=Ee.lngLat,ze=Ee.pos,xt=Sr(ze,this.pixelUnprojectionMatrix),Ut=Vr(Le,this.scale),ir=Re.IH([],Ut,Re.tk([],xt)),Ft=Re.IH([],this.center,ir);return rn(Ft,this.scale)}},{key:"getLocationAtPoint",value:function(Ee){var Le=Ee.lngLat,ze=Ee.pos;return this.getMapCenterByLngLatPosition({lngLat:Le,pos:ze})}},{key:"fitBounds",value:function(Ee){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze=this.width,xt=this.height,Ut=vr(Object.assign({width:ze,height:xt,bounds:Ee},Le)),ir=Ut.longitude,Ft=Ut.latitude,te=Ut.zoom;return new V({width:ze,height:xt,longitude:ir,latitude:Ft,zoom:te})}}]),V}(Hr),gr=function(){function it(){(0,F.Z)(this,it)}return(0,z.Z)(it,[{key:"syncWithMapCamera",value:function(H){var Ee=H.center,Le=H.zoom,ze=H.pitch,xt=H.bearing,Ut=H.viewportHeight,ir=H.viewportWidth;this.viewport=new Ie({width:ir,height:Ut,longitude:Ee&&Ee[0],latitude:Ee&&Ee[1],zoom:Le,pitch:ze,bearing:xt})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(H,Ee){return this.viewport.projectFlat(H,Ee)}}]),it}(),Wr=["id","attributionControl","style","token","rotation","mapInstance"];function Dr(it){var V=Xr();return function(){var Ee=(0,P.Z)(it),Le;if(V){var ze=(0,P.Z)(this).constructor;Le=Reflect.construct(Ee,arguments,ze)}else Le=Ee.apply(this,arguments);return(0,D.Z)(this,Le)}}function Xr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(it){return!1}}function Vn(it,V){var H=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ee=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(H||Ee)&&(V||(V=document),!!V)){var Le=V.head||V.getElementsByTagName("head")[0];if(!Le){Le=V.createElement("head");var ze=V.body||V.getElementsByTagName("body")[0];ze?ze.parentNode.insertBefore(Le,ze):V.documentElement.appendChild(Le)}var xt=V.createElement("style");return xt.type="text/css",xt.styleSheet?xt.styleSheet.cssText=it:xt.appendChild(V.createTextNode(it)),Le.appendChild(xt),xt}}Vn(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Ce();var ni=0,Dn="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",Jn=function(it){(0,h.Z)(H,it);var V=Dr(H);function H(){var Ee;(0,F.Z)(this,H);for(var Le=arguments.length,ze=new Array(Le),xt=0;xt<Le;xt++)ze[xt]=arguments[xt];return Ee=V.call.apply(V,[this].concat(ze)),(0,B.Z)((0,Be.Z)(Ee),"version","MAPBOX"),Ee}return(0,z.Z)(H,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(Le){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},xt=this.lngLatToMercator(Le,0),Ut=xt.x,ir=xt.y;return[Ut-ze.x,ir-ze.y]}},{key:"lngLatToMercator",value:function(Le,ze){var xt=window.mapboxgl.MercatorCoordinate.fromLngLat(Le,ze),Ut=xt.x,ir=Ut===void 0?0:Ut,Ft=xt.y,te=Ft===void 0?0:Ft,Q=xt.z,ve=Q===void 0?0:Q;return{x:ir,y:te,z:ve}}},{key:"getModelMatrix",value:function(Le,ze,xt){var Ut=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],ir=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},Ft=window.mapboxgl.MercatorCoordinate.fromLngLat(Le,ze),te=Ft.meterInMercatorCoordinateUnits(),Q=q.create();return q.translate(Q,Q,le.fromValues(Ft.x-ir.x,Ft.y-ir.y,Ft.z||0-ir.z)),q.scale(Q,Q,le.fromValues(te*Ut[0],-te*Ut[1],te*Ut[2])),q.rotateX(Q,Q,xt[0]),q.rotateY(Q,Q,xt[1]),q.rotateZ(Q,Q,xt[2]),Q}},{key:"init",value:function(){var Ee=(0,J.Z)(U().mark(function ze(){var xt=this,Ut,ir,Ft,te,Q,ve,Oe,Xe,ft,Et,Ne,Ue,vt;return U().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:Ut=this.config,ir=Ut.id,Ft=ir===void 0?"map":ir,te=Ut.attributionControl,Q=te===void 0?!1:te,ve=Ut.style,Oe=ve===void 0?"light":ve,Xe=Ut.token,ft=Xe===void 0?Dn:Xe,Et=Ut.rotation,Ne=Et===void 0?0:Et,Ue=Ut.mapInstance,vt=(0,fe.Z)(Ut,Wr),this.viewport=new gr,!Ue&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),ft===Dn&&Oe!=="blank"&&!window.mapboxgl.accessToken&&!Ue&&console.warn(this.configService.getSceneWarninfo("MapToken")),!Ue&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=ft),Ue?(this.map=Ue,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(Ft),this.map=new window.mapboxgl.Map((0,X.Z)({container:this.$mapContainer,style:this.getMapStyleValue(Oe),attributionControl:Q,bearing:Ne},vt))),this.map.on("load",function(){xt.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Lr.stop()}},ze,this)}));function Le(){return Ee.apply(this,arguments)}return Le}()},{key:"destroy",value:function(){var Le;(Le=this.$mapContainer)===null||Le===void 0||(Le=Le.parentNode)===null||Le===void 0||Le.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(Le){for(var ze,xt=arguments.length,Ut=new Array(xt>1?xt-1:0),ir=1;ir<xt;ir++)Ut[ir-1]=arguments[ir];(ze=this.eventEmitter).emit.apply(ze,[Le].concat(Ut))}},{key:"once",value:function(Le){for(var ze,xt=arguments.length,Ut=new Array(xt>1?xt-1:0),ir=1;ir<xt;ir++)Ut[ir-1]=arguments[ir];(ze=this.eventEmitter).once.apply(ze,[Le].concat(Ut))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"getCanvasOverlays",value:function(){var Le;return(Le=this.getMapContainer())===null||Le===void 0?void 0:Le.querySelector(".mapboxgl-canvas-container")}},{key:"meterToCoord",value:function(Le,ze){var xt=new(Ce()).LngLat(Le[0],Le[1]),Ut=new(Ce()).LngLat(ze[0],ze[1]),ir=xt.distanceTo(Ut),Ft=Ce().MercatorCoordinate.fromLngLat({lng:Le[0],lat:Le[1]}),te=Ce().MercatorCoordinate.fromLngLat({lng:ze[0],lat:ze[1]}),Q=Ft.x,ve=Ft.y,Oe=te.x,Xe=te.y,ft=Math.sqrt(Math.pow(Q-Oe,2)+Math.pow(ve-Xe,2))*4194304*2;return ft/ir}},{key:"exportMap",value:function(Le){var ze=this.map.getCanvas(),xt=Le==="jpg"?ze==null?void 0:ze.toDataURL("image/jpeg"):ze==null?void 0:ze.toDataURL("image/png");return xt}},{key:"creatMapContainer",value:function(Le){var ze=Le;typeof Le=="string"&&(ze=document.getElementById(Le));var xt=document.createElement("div");return xt.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,xt.id="l7_mapbox_div"+ni++,ze.appendChild(xt),xt}}]),H}(be);function Yi(it){var V=bi();return function(){var Ee=(0,P.Z)(it),Le;if(V){var ze=(0,P.Z)(this).constructor;Le=Reflect.construct(Ee,arguments,ze)}else Le=Ee.apply(this,arguments);return(0,D.Z)(this,Le)}}function bi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(it){return!1}}function ui(it,V){var H=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ee=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(H||Ee)&&(V||(V=document),!!V)){var Le=V.head||V.getElementsByTagName("head")[0];if(!Le){Le=V.createElement("head");var ze=V.body||V.getElementsByTagName("body")[0];ze?ze.parentNode.insertBefore(Le,ze):V.documentElement.appendChild(Le)}var xt=V.createElement("style");return xt.type="text/css",xt.styleSheet?xt.styleSheet.cssText=it:xt.appendChild(V.createTextNode(it)),Le.appendChild(xt),xt}}ui(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var pi=function(it){(0,h.Z)(H,it);var V=Yi(H);function H(){return(0,F.Z)(this,H),V.apply(this,arguments)}return(0,z.Z)(H,[{key:"getServiceConstructor",value:function(){return Jn}}]),H}(W)},57059:function(He,w,x){"use strict";x.d(w,{SO:function(){return F},z6:function(){return Ho},sN:function(){return m},oX:function(){return E},a5:function(){return z},SA:function(){return q},nx:function(){return ul},Z:function(){return is},rQ:function(){return Se},bV:function(){return Re},zi:function(){return et},ds:function(){return Co},oO:function(){return In},SI:function(){return qc},Rx:function(){return Ol},W0:function(){return ke},LS:function(){return tn},Z6:function(){return ur},We:function(){return Ko},Co:function(){return oe},hj:function(){return Zr},Cl:function(){return qt},Oc:function(){return rn},M4:function(){return _n},NJ:function(){return Vr},ks:function(){return pe},Ol:function(){return lu},fj:function(){return $t},Yu:function(){return be},ZB:function(){return ln},gJ:function(){return Ve},z0:function(){return Xs},jG:function(){return gc},M8:function(){return gl},fg:function(){return ba},if:function(){return Bo},vP:function(){return Yc},rU:function(){return Rn},LF:function(){return lt},Fv:function(){return ol},yA:function(){return Hi},yR:function(){return R},CI:function(){return bt}});var F={};x.r(F),x.d(F,{DPR:function(){return Hs},addClass:function(){return Bi},addStyle:function(){return Da},appendElementType:function(){return Pa},clearChildren:function(){return qa},create:function(){return wi},css2Style:function(){return cs},empty:function(){return ua},findParentElement:function(){return Na},getClass:function(){return ga},getContainer:function(){return xr},getDiffRect:function(){return Ka},getStyleList:function(){return Za},getViewPortScale:function(){return ji},hasClass:function(){return Fi},printCanvas:function(){return Nr},remove:function(){return Nn},removeClass:function(){return sa},removeStyle:function(){return Qs},setChecked:function(){return Do},setClass:function(){return bn},setTransform:function(){return ia},setUnDraggable:function(){return Qa},splitWords:function(){return sn},toggleClass:function(){return ei},triggerResize:function(){return zi},trim:function(){return Or}});var z={};x.r(z),x.d(z,{getColumn:function(){return Jl},getSatByColumn:function(){return sl},max:function(){return wu},mean:function(){return Ql},min:function(){return fu},mode:function(){return _l},statMap:function(){return tu},sum:function(){return hu}});var h=x(1413),D=x(43144),P=x(15671),X=x(60136),W=x(82963),fe=x(61120),J=x(89611);function Be(M){try{return Function.toString.call(M).indexOf("[native code]")!==-1}catch(k){return typeof M=="function"}}var B=x(78814);function ee(M,k,L){if((0,B.Z)())return Reflect.construct.apply(null,arguments);var K=[null];K.push.apply(K,k);var ie=new(M.bind.apply(M,K));return L&&(0,J.Z)(ie,L.prototype),ie}function U(M){var k=typeof Map=="function"?new Map:void 0;return U=function(K){if(K===null||!Be(K))return K;if(typeof K!="function")throw new TypeError("Super expression must either be null or a function");if(typeof k!="undefined"){if(k.has(K))return k.get(K);k.set(K,ie)}function ie(){return ee(K,arguments,(0,fe.Z)(this).constructor)}return ie.prototype=Object.create(K.prototype,{constructor:{value:ie,enumerable:!1,writable:!0,configurable:!0}}),(0,J.Z)(ie,K)},U(M)}var q={REGISTERED_PROTOCOLS:{}};function le(M){var k=j();return function(){var K=(0,fe.Z)(M),ie;if(k){var ne=(0,fe.Z)(this).constructor;ie=Reflect.construct(K,arguments,ne)}else ie=K.apply(this,arguments);return(0,W.Z)(this,ie)}}function j(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var Ce=function(k){return q.REGISTERED_PROTOCOLS[k.substring(0,k.indexOf("://"))]},$e=function(M){(0,X.Z)(L,M);var k=le(L);function L(K,ie,ne,nt){var rt;return(0,P.Z)(this,L),rt=k.call(this,"AJAXError: ".concat(ie," (").concat(K,"): ").concat(ne)),rt.status=K,rt.statusText=ie,rt.url=ne,rt.body=nt,rt}return(0,D.Z)(L)}(U(Error));function Fe(M,k){var L=new XMLHttpRequest,K=Array.isArray(M.url)?M.url[0]:M.url;L.open(M.method||"GET",K,!0),M.type==="arrayBuffer"&&(L.responseType="arraybuffer");for(var ie in M.headers)M.headers.hasOwnProperty(ie)&&L.setRequestHeader(ie,M.headers[ie]);return M.type==="json"&&(L.responseType="text",L.setRequestHeader("Accept","application/json")),L.withCredentials=M.credentials==="include",L.onerror=function(){k(new Error(L.statusText))},L.onload=function(){if((L.status>=200&&L.status<300||L.status===0)&&L.response!==null){var ne=L.response;if(M.type==="json")try{ne=JSON.parse(L.response)}catch(rt){return k(rt)}k(null,ne,L.getResponseHeader("Cache-Control"),L.getResponseHeader("Expires"),L)}else{var nt=new Blob([L.response],{type:L.getResponseHeader("Content-Type")});k(new $e(L.status,L.statusText,K.toString(),nt))}},L.cancel=L.abort,L.send(M.body),L}function lt(M){return new Promise(function(k,L){Fe(M,function(K,ie,ne,nt,rt){K?L({err:K,data:null,xhr:rt}):k({err:null,data:ie,cacheControl:ne,expires:nt,xhr:rt})})})}function We(M,k){return Fe(M,k)}var Ze=function(k,L){var K=Ce(k.url)||We;return K((0,h.Z)((0,h.Z)({},k),{},{type:"json"}),L)},pe=function(k,L){var K=Ce(k.url)||We;return K((0,h.Z)((0,h.Z)({},k),{},{type:"arrayBuffer"}),L)},se=function(k,L){return We(_objectSpread(_objectSpread({},k),{},{method:"POST"}),L)},be=function(k,L){return We((0,h.Z)((0,h.Z)({},k),{},{method:"GET"}),L)};function Te(M){var k=window.document.createElement("a");return k.href=M,k.protocol===window.document.location.protocol&&k.host===window.document.location.host}var de="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Rt(M,k){var L=new window.Image,K=window.URL||window.webkitURL;L.crossOrigin="anonymous",L.onload=function(){k(null,L),K.revokeObjectURL(L.src),L.onload=null,window.requestAnimationFrame(function(){L.src=de})},L.onerror=function(){return k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ie=new Blob([new Uint8Array(M)],{type:"image/png"});L.src=M.byteLength?K.createObjectURL(ie):de}function ye(M,k){var L=new Blob([new Uint8Array(M)],{type:"image/png"});createImageBitmap(L).then(function(K){k(null,K)}).catch(function(K){k(new Error("Could not load image because of ".concat(K.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var Ve=function(k,L,K){var ie=function(nt,rt){if(nt)L(nt);else if(rt){var jt=typeof createImageBitmap=="function",ct=K?K(rt):rt;jt?ye(ct,L):Rt(ct,L)}};return k.type==="json"?Ze(k,ie):pe(k,ie)},oe=function(k,L){var K=typeof createImageBitmap=="function";K?ye(k,L):Rt(k,L)},Re=function(M){return M.CENTER="center",M.TOP="top",M["TOP-LEFT"]="top-left",M["TOP-RIGHT"]="top-right",M.BOTTOM="bottom",M["BOTTOM-LEFT"]="bottom-left",M["BOTTOM-RIGHT"]="bottom-right",M.LEFT="left",M.RIGHT="right",M}({}),Se={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function et(M,k,L){var K=M.classList;for(var ie in Se)Se.hasOwnProperty(ie)&&K.remove("l7-".concat(L,"-anchor-").concat(ie));K.add("l7-".concat(L,"-anchor-").concat(k))}var st=x(37620);function pt(M){return typeof M=="string"?!!d3.color(M):!1}function bt(M){var k=st.ZP(M),L=[0,0,0,0];return k!=null&&(L[0]=k.r/255,L[1]=k.g/255,L[2]=k.b/255,L[3]=k.opacity),L}function ke(M){var k=M&&M[0],L=M&&M[1],K=M&&M[2],ie=k+L*256+K*65536-1;return ie}function ur(M){return[M+1&255,M+1>>8&255,M+1>>8>>8&255]}function qt(M){var k=window.document.createElement("canvas"),L=k.getContext("2d");k.width=256,k.height=1;for(var K=null,ie=L.createLinearGradient(0,0,256,1),ne=M.positions[0],nt=M.positions[M.positions.length-1],rt=0;rt<M.colors.length;++rt){var jt=(M.positions[rt]-ne)/(nt-ne);ie.addColorStop(jt,M.colors[rt])}return L.fillStyle=ie,L.fillRect(0,0,256,1),K=new Uint8ClampedArray(L.getImageData(0,0,256,1).data),k=null,L=null,{data:K,width:256,height:1}}function _n(M,k){var L=window.document.createElement("canvas"),K=L.getContext("2d");L.width=256,L.height=1;for(var ie=K.createLinearGradient(0,0,256,1),ne=k[1]-k[0],nt=0;nt<M.colors.length;++nt){var rt=Math.max((M.positions[nt]-k[0])/ne,0);ie.addColorStop(rt,M.colors[nt])}K.fillStyle=ie,K.fillRect(0,0,256,1);var jt=K.getImageData(0,0,256,1).data,ct=Qr(K,jt);return L=null,K=null,ct}function Zr(M){var k=window.document.createElement("canvas"),L=k.getContext("2d");k.width=256,k.height=1;var K=L.createImageData(256,1);return K.data.fill(0),M.positions.forEach(function(ie,ne){var nt=bt(M.colors[ne]);K.data[ie*4+0]=nt[0]*255,K.data[ie*4+1]=nt[1]*255,K.data[ie*4+2]=nt[2]*255,K.data[ie*4+3]=nt[3]*255}),k=null,L=null,K}function Vr(M){var k=window.document.createElement("canvas"),L=k.getContext("2d");L.globalAlpha=1,k.width=256,k.height=1;for(var K=256/M.colors.length,ie=0;ie<M.colors.length;ie++)L.beginPath(),L.lineWidth=2,L.strokeStyle=M.colors[ie],L.moveTo(ie*K,0),L.lineTo((ie+1)*K,0),L.stroke();var ne=L.getImageData(0,0,256,1).data,nt=Qr(L,ne);return k=null,L=null,nt}function rn(M,k){var L=window.document.createElement("canvas"),K=L.getContext("2d");K.globalAlpha=1,L.width=256,L.height=1;var ie=k[1]-k[0];M.positions.length-M.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var ne=0;ne<M.colors.length;ne++)K.beginPath(),K.lineWidth=2,K.strokeStyle=M.colors[ne],K.moveTo((M.positions[ne]-k[0])/ie*255,0),K.lineTo((M.positions[ne+1]-k[0])/ie*255,0),K.stroke();var nt=K.getImageData(0,0,256,1).data,rt=Qr(K,nt);return L=null,K=null,rt}function Qr(M,k){for(var L=M.createImageData(256,1),K=0;K<L.data.length;K+=4)L.data[K+0]=k[K+0],L.data[K+1]=k[K+1],L.data[K+2]=k[K+2],L.data[K+3]=k[K+3];return L}function ln(M){switch(M==null?void 0:M.type){case"cat":return[0,255];default:return[0,1]}}var vn={BACK:1029,FRONT:1028};function $t(M){switch(M){case"GAODE1.x":return vn.BACK;case"GAODE2.x":return vn.BACK;case"MAPBOX":return vn.FRONT;case"SIMPLE":return vn.FRONT;case"GLOBEL":return vn.BACK;case"DEBAULT":return vn.FRONT;default:return vn.FRONT}}var _r=x(74902),kt=x(97685),qe=x(74691),Sr=x.n(qe),Pe=x(50361),Hr=x.n(Pe),vr=x(23279),Ie=x.n(vr),gr=x(27361),Wr=x.n(gr),Dr=x(51584),Xr=x.n(Dr),Vn=x(18446),ni=x.n(Vn),Dn=x(14293),Jn=x.n(Dn),Yi=x(81763),bi=x.n(Yi),ui=x(68630),pi=x.n(ui),it=x(47037),V=x.n(it),H=x(36719),Ee=x.n(H),Le=x(82492),ze=x.n(Le),xt=x(30236),Ut=x.n(xt),ir=x(97019),Ft=x.n(ir),te=x(23493),Q=x.n(te),ve=x(44908),Oe=x.n(ve),Xe=x(11700),ft=x.n(Xe),Et=x(23560),Ne=x.n(Et),Ue=x(13218),vt=x.n(Ue),ue=x(52353),Lr=x.n(ue),lr=x(68929),$r=x.n(lr),Rn={isNil:Jn(),merge:ze(),throttle:Q(),isString:V(),debounce:Ie(),pull:Ft(),isTypedArray:Ee(),isPlainObject:pi(),isNumber:bi(),isBoolean:Xr(),isEqual:ni(),cloneDeep:Hr(),uniq:Oe(),clamp:Sr(),upperFirst:ft(),get:Wr(),mergeWith:Ut(),isFunction:Ne(),isObject:vt(),isUndefined:Lr(),camelCase:$r()},nn=Rn.pull;function xr(M){var k=M;return typeof M=="string"&&(k=window.document.getElementById(M)),k}function Or(M){return M.trim?M.trim():M.replace(/^\s+|\s+$/g,"")}function sn(M){return Or(M).split(/\s+/)}function xn(M){var k,L=(k=document)===null||k===void 0||(k=k.documentElement)===null||k===void 0?void 0:k.style;if(!L)return M[0];for(var K in M)if(M[K]&&M[K]in L)return M[K];return M[0]}function wi(M,k,L){var K=window.document.createElement(M);return k&&(K.className=k||""),L&&L.appendChild(K),K}function Nn(M){var k=M.parentNode;k&&k.removeChild(M)}function Bi(M,k){if(M.classList!==void 0)for(var L=sn(k),K=0,ie=L.length;K<ie;K++)M.classList.add(L[K]);else if(!Fi(M,k)){var ne=ga(M);bn(M,(ne?ne+" ":"")+k)}}function sa(M,k){if(M.classList!==void 0){var L=sn(k);L.forEach(function(K){M.classList.remove(K)})}else bn(M,Or((" "+ga(M)+" ").replace(" "+k+" "," ")))}function Fi(M,k){if(M.classList!==void 0)return M.classList.contains(k);var L=ga(M);return L.length>0&&new RegExp("(^|\\s)"+k+"(\\s|$)").test(L)}function bn(M,k){M instanceof HTMLElement?M.className=k:M.className.baseVal=k}function ei(M,k,L){L===void 0?Fi(M,k)?sa(M,k):Bi(M,k):L?Bi(M,k):sa(M,k)}function ga(M){return M instanceof SVGElement&&(M=M.correspondingElement),M.className.baseVal===void 0?M.className:M.className.baseVal}function ua(M){for(;M&&M.firstChild;)M.removeChild(M.firstChild)}var no=xn(["transform","WebkitTransform"]);function ia(M,k){M.style[no]=k}function zi(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var M=window.document.createEvent("UIEvents");M.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(M)}}function Nr(M){var k=["padding: "+(M.height/2-8)+"px "+M.width/2+"px;","line-height: "+M.height+"px;","background-image: url("+M.toDataURL()+");"];console.log(`%c
`,k.join(""))}function ji(){var M,k=window.document.querySelector('meta[name="viewport"]');if(!k)return 1;var L=(M=k.content)===null||M===void 0?void 0:M.split(","),K=L.find(function(ie){var ne=ie.split("="),nt=(0,kt.Z)(ne,1),rt=nt[0];return rt==="initial-scale"});return K?K.split("=")[1]*1:1}var Hs=ji()<1?1:window.devicePixelRatio;function Da(M,k){M.setAttribute("style","".concat(M.style.cssText).concat(k))}function Za(M){return M.split(";").map(function(k){return k.trim()}).filter(function(k){return k})}function Qs(M,k){var L,K=Za((L=M.getAttribute("style"))!==null&&L!==void 0?L:""),ie=Za(k),ne=nn.apply(void 0,[K].concat((0,_r.Z)(ie)));M.setAttribute("style",ne.join(";"))}function cs(M){return Object.entries(M).map(function(k){var L=(0,kt.Z)(k,2),K=L[0],ie=L[1];return"".concat(K,": ").concat(ie)}).join(";")}function Ka(M,k){return{left:M.left-k.left,top:M.top-k.top,right:k.left+k.width-M.left-M.width,bottom:k.top+k.height-M.top-M.height}}function Do(M,k){M.checked=k,k?M.setAttribute("checked","true"):M.removeAttribute("checked")}function qa(M){M.innerHTML=""}function Qa(M){M.setAttribute("draggable","false")}function Pa(M,k){if(typeof k=="string"){var L=document.createElement("div");for(L.innerHTML=k;L.firstChild;)M.append(L.firstChild)}else Array.isArray(k)?M.append.apply(M,(0,_r.Z)(k)):M.append(k)}function Na(M,k){for(var L=Array.isArray(k)?k:[k],K=M;K instanceof Element&&K!==window.document.body;){var ie,ne;if(L.find(function(nt){var rt;return(rt=K)===null||rt===void 0?void 0:rt.matches(nt)}))return K;K=(ie=(ne=K)===null||ne===void 0?void 0:ne.parentElement)!==null&&ie!==void 0?ie:null}}var Lo;function ba(M){return typeof ImageBitmap!="undefined"&&M instanceof ImageBitmap}function so(){return typeof importScripts=="function"}var Ao=so()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},Y=(Lo=navigator)===null||Lo===void 0?void 0:Lo.userAgent,vo=!!Y.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Va=Y.indexOf("Android")>-1||Y.indexOf("Adr")>-1;function fs(){for(var M=Y,k=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],L=!0,K=0,ie=k;K<ie.length;K++){var ne=ie[K];if(M.indexOf(ne)>0){L=!1;break}}return L}function Eo(M,k){M.forEach(function(L){k[L]&&(k[L]=k[L].bind(k))})}var Qe=null,gt=x(39034);function Gt(M){var k=[1/0,1/0,-1/0,-1/0];return(0,gt.pZ)(M,function(L){k[0]>L[0]&&(k[0]=L[0]),k[1]>L[1]&&(k[1]=L[1]),k[2]<L[0]&&(k[2]=L[0]),k[3]<L[1]&&(k[3]=L[1])}),k}Gt.default=Gt;var Pr=Gt,Tn=x(1449);function di(M){return typeof M=="number"}var fa=2*Math.PI*6378137/2;function Bo(M,k){var L=(0,kt.Z)(k,4),K=L[0],ie=L[1],ne=L[2],nt=L[3];return M.lng>K&&M.lng<=ne&&M.lat>ie&&M.lat<=nt}function Ko(M){var k=[1/0,1/0,-1/0,-1/0];return M.forEach(function(L){var K=L.coordinates;Po(k,K)}),k}function Po(M,k){return Array.isArray(k[0])?k.forEach(function(L){Po(M,L)}):(M[0]>k[0]&&(M[0]=k[0]),M[1]>k[1]&&(M[1]=k[1]),M[2]<k[0]&&(M[2]=k[0]),M[3]<k[1]&&(M[3]=k[1])),M}function Us(M,k){return ws(M,k)}function ws(M,k){return Array.isArray(M[0])?M.map(function(L){return ws(L,k)}):k(M)}function Yc(M){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};M=il(M,k);var K=M[0],ie=M[1],ne=K*fa/180,nt=Math.log(Math.tan((90+ie)*Math.PI/360))/(Math.PI/180);return nt=nt*fa/180,L.enable&&(ne=Number(ne.toFixed(L.decimal)),nt=Number(nt.toFixed(L.decimal))),M.length===3?[ne,nt,M[2]]:[ne,nt]}function Ml(M){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,L=M[0],K=M[1],ie=L/fa*180,ne=K/fa*180;return ne=180/Math.PI*(2*Math.atan(Math.exp(ne*Math.PI/180))-Math.PI/2),k!=null&&(ie=Number(ie.toFixed(k)),ne=Number(ne.toFixed(k))),M.length===3?[ie,ne,M[2]]:[ie,ne]}function ns(M){if(M==null)throw new Error("lng is required");return(M>180||M<-180)&&(M=M%360,M>180&&(M=-360+M),M<-180&&(M=360+M),M===0&&(M=0)),M}function Uu(M){if(M==null)throw new Error("lat is required");return(M>90||M<-90)&&(M=M%180,M>90&&(M=-180+M),M<-90&&(M=180+M),M===0&&(M=0)),M}function il(M,k){if(k===!1)return M;var L=ns(M[0]),K=Uu(M[1]);return K>85&&(K=85),K<-85&&(K=-85),M.length===3?[L,K,M[2]]:[L,K]}function is(M){var k=85.0511287798,L=Math.max(Math.min(k,M[1]),-k),K=256<<20,ie=Math.PI/180,ne=M[0]*ie,nt=L*ie;nt=Math.log(Math.tan(Math.PI/4+nt/2));var rt=.5/Math.PI,jt=.5,ct=-.5/Math.PI;return ie=.5,ne=K*(rt*ne+jt),nt=K*(ct*nt+ie),[Math.floor(ne),Math.floor(nt)]}function Cu(M){var k=.5/Math.PI,L=.5,K=-.5/Math.PI,ie=.5,ne=256<<20,nt=_slicedToArray(M,2),rt=nt[0],jt=nt[1];rt=(rt/ne-L)/k,jt=(jt/ne-ie)/K,jt=(Math.atan(Math.pow(Math.E,jt))-Math.PI/4)*2,ie=Math.PI/180;var ct=jt/ie,Yt=rt/ie;return[Yt,ct]}function al(M,k){var L=85.0511287798,K=Math.PI/180,ie=6378137;return k=Math.max(Math.min(L,k),-L),M*=K,k*=K,k=Math.log(Math.tan(Math.PI/4+k/2)),[M*ie,k*ie]}function Kl(M,k){var L=Math.PI/180,K=6378137,ie=M/K/L,ne=2*(Math.atan(Math.exp(k/K))-Math.PI/4)/L;return[ie,ne]}function cn(M,k,L){var K=degreesToRadians(k[1]-M[1]),ie=degreesToRadians(k[0]-M[0]),ne=degreesToRadians(M[1]),nt=degreesToRadians(k[1]),rt=Math.pow(Math.sin(K/2),2)+Math.pow(Math.sin(ie/2),2)*Math.cos(ne)*Math.cos(nt);return radiansToLength(2*Math.atan2(Math.sqrt(rt),Math.sqrt(1-rt)),L="meters")}function Ei(M){var k=Math.PI/180,L=85.0511287798,K=6378137,ie=Math.max(Math.min(L,M[1]),-L),ne=Math.sin(ie*k),nt=K*M[0]*k,rt=K*Math.log((1+ne)/(1-ne))/2;return[nt,rt]}function Hi(M,k){var L=Math.abs(M[1][1]-M[0][1])*k,K=Math.abs(M[1][0]-M[0][0])*k;return[[M[0][0]-K,M[0][1]-L],[M[1][0]+K,M[1][1]+L]]}function In(M,k){return M[0][0]<=k[0][0]&&M[0][1]<=k[0][1]&&M[1][0]>=k[1][0]&&M[1][1]>=k[1][1]}function Co(M){return[[M[0],M[1]],[M[2],M[3]]]}function ol(M){var k=ql(M,[0,0]);return[M[0]/k,M[1]/k]}function ql(M,k){return Math.sqrt(Math.pow(M[0]-k[0],2)+Math.pow(M[1]-k[1],2))}function Ic(M,k){return M[0]*k[0]+M[1]*k[1]}function uc(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])}function Pc(M,k){return Math.acos(Ic(M,k)/(uc(M)*uc(k)))*180/Math.PI}function Kc(M,k){return k[0]>0?k[1]>0?90-Math.atan(k[1]/k[0])*180/Math.PI:90+Math.atan(-k[1]/k[0])*180/Math.PI:k[1]<0?180+(90-Math.atan(k[1]/k[0])*180/Math.PI):270+Math.atan(k[1]/-k[0])*180/Math.PI}function bf(M){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!M||M.length<2)){for(var L=[0,1],K=0,ie=[],ne=0;ne<M.length-1;ne++){var nt=M[ne],rt=M[ne+1],jt=ql(nt,rt);K+=jt;var ct=[nt[0]-rt[0],nt[1]-rt[1]],Yt=Kc(L,ct);if(ne>0){var ar=ie[ne-1].rotation;ar-Yt>360-ar+Yt&&(Yt=Yt+360)}ie.push({start:nt,end:rt,dis:jt,rotation:Yt,duration:0})}return ie.map(function(fn){fn.duration=k*(fn.dis/K)}),ie}}function qc(M){if(di(M[0]))return M;if(di(M[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(di(M[0][0][0])){var k=M,L=0,K=0,ie=0;return k.forEach(function(ne){ne.forEach(function(nt){L+=nt[0],K+=nt[1],ie++})}),[L/ie,K/ie,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Ol(M){for(var k=M[0],L=M[1],K=M[0],ie=M[1],ne=0,nt=0,rt=0,jt=0;jt<M.length;jt+=2){var ct=M[jt],Yt=M[jt+1];ct&&Yt&&(k=Math.max(ct,k),L=Math.max(Yt,L),K=Math.min(ct,K),ie=Math.min(Yt,ie),ne+=ct,nt+=Yt,rt++)}return{center:[ne/rt,nt/rt],radius:Math.sqrt(Math.pow(k-K,2)+Math.pow(L-ie,2))/2}}function lu(M){return Pr((0,Tn.uf)([(0,Tn.Tu)(M)]))}function Ef(M){var k=131,L=137,K=0;M+="x";for(var ie=Math.floor(9007199254740991/L),ne=0;ne<M.length;ne++)K>ie&&(K=Math.floor(K/L)),K=K*k+M.charCodeAt(ne);return K}function hs(M){M=M.toString();for(var k=5381,L=M.length;L;)k=k*33^M.charCodeAt(--L);return k>>>0}function gl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(M){var k=Math.random()*16|0,L=M==="x"?k:k&3|8;return L.toString(16)})}var yl=function(M){return M["GAODE1.x"]="GAODE1.x",M["GAODE2.x"]="GAODE2.x",M.MAPBOX="MAPBOX",M.DEFAULT="DEFAUlTMAP",M.SIMPLE="SIMPLE",M.GLOBEL="GLOBEL",M}({});function Ws(M,k,L,K,ie){var ne=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,nt=arguments.length>6?arguments[6]:void 0,rt=L;return nt&&(rt=Math.round(L*(ne-1))/(ne-1)),K?zs(M,k,rt,K,ie):zs(M,k,rt,.314,ie)}function Js(M,k){var L=1-k;return(M[0]*L+M[1]*k)*L+(M[1]*L+M[2]*k)*k}function eu(M,k){return Math.sqrt(Math.pow(M[0]-k[0],2)+Math.pow(M[1]-k[1],2))}function cu(M,k,L){var K=[k[0]-M[0],k[1]-M[1]],ie=eu(K,[0,0]),ne=Math.atan2(K[1],K[0]),nt=ie/2/Math.cos(L),rt=ne+L,jt=[nt*Math.cos(rt)+M[0],nt*Math.sin(rt)+M[1]];return jt}function zs(M,k,L,K,ie){if(ie===MapType["GAODE2.x"]){var ne=amap2Project(M[0],M[1]),nt=amap2Project(k[0],k[1]),rt=cu(ne,nt,K),jt=[ne[0],rt[0],nt[0]],ct=[ne[1],rt[1],nt[1]];return[].concat(_toConsumableArray(amap2UnProject(Js(jt,L),Js(ct,L))),[0])}else{var Yt=cu(M,k,K),ar=[M[0],Yt[0],k[0]],fn=[M[1],Yt[1],k[1]];return[Js(ar,L),Js(fn,L),0]}}function zu(M,k,L,K,ie){var ne=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,nt=arguments.length>6?arguments[6]:void 0,rt=L;return nt&&(rt=Math.round(L*29)/29),ja(M,k,rt,ie)}function Zu(M,k){var L=[k[0]-M[0],k[1]-M[1]],K=calDistance(L,[0,0]),ie=Math.atan2(L[1],L[0]),ne=.314,nt=K/2/Math.cos(ne),rt=ie+ne,jt=[nt*Math.cos(rt)+M[0],nt*Math.sin(rt)+M[1]];return jt}function lc(M,k){var L=1-k;return(M[0]*L+M[1]*k)*L+(M[1]*L+M[2]*k)*k}function cc(M,k){var L=[M[0]-k[0],M[1]-k[1]],K=[Math.sin(L[0]/2),Math.sin(L[1]/2)],ie=K[1]*K[1]+Math.cos(M[1])*Math.cos(k[1])*K[0]*K[0];return 2*Math.atan2(Math.sqrt(ie),Math.sqrt(1-ie))}function ja(M,k,L,K){var ie=[degreesToRadians(M[0]),degreesToRadians(M[1])],ne=[degreesToRadians(k[0]),degreesToRadians(k[1])];if(K==="GAODE2.x"){var nt=Zu(ie,ne),rt=[ie[0],nt[0],ne[0]],jt=[ie[1],nt[1],ne[1]];return[lc(rt,L),lc(jt,L),0]}else{var ct=cc(ie,ne);if(Math.abs(ct-Math.PI)<.001)return[(1-L)*ie[0]+L*ne[0],(1-L)*ie[1]+L*ne[1]];var Yt=Math.sin((1-L)*ct)/Math.sin(ct),ar=Math.sin(L*ct)/Math.sin(ct),fn=[Math.sin(ie[0]),Math.sin(ie[1])],on=[Math.cos(ie[0]),Math.cos(ie[1])],Kr=[Math.sin(ne[0]),Math.sin(ne[1])],Gn=[Math.cos(ne[0]),Math.cos(ne[1])],Zn=Yt*on[1]*on[0]+ar*Gn[1]*Gn[0],jn=Yt*on[1]*fn[0]+ar*Gn[1]*Kr[0],vi=Yt*fn[1]+ar*Kr[1];return[radiansToDegrees(Math.atan2(jn,Zn)),radiansToDegrees(Math.atan2(vi,Math.sqrt(Zn*Zn+jn*jn)))]}}function jf(M,k){for(var L=0,K=[],ie=0;ie<M.length-1;ie++){var ne=M[ie],nt=M[ie+1],rt=Il(ne,nt),jt=L;L+=rt,K.push({p1:ne,p2:nt,totalDistance:L,distance:rt,lastTotalDistance:jt})}for(var ct=L*k,Yt,ar,fn=0,on=K;fn<on.length;fn++){var Kr=on[fn],Gn=Kr.totalDistance;if(Gn>ct){var Zn=Kr.p1,jn=Kr.p2,vi=(ct-Kr.lastTotalDistance)/Kr.distance,Si=fc(jn,Zn,vi);Yt=Si[0],ar=Si[1];break}}return{lng:Yt,lat:ar,height:0}}function fc(M,k,L){return[M[0]*L+k[0]*(1-L),M[1]*L+k[1]*(1-L)]}function Il(M,k){return Math.sqrt(Math.pow(M[0]-k[0],2)+Math.pow(M[1]-k[1],2))}function co(M,k){var L=k.featureId,K=M.data.dataArray;return typeof L=="number"&&(K=K.filter(function(ie){var ne=ie.id;return ne===L})),K.map(function(ie){var ne=Jc(ie,k);return _objectSpread(_objectSpread({},ie),ne)})}function Qc(M,k){return new Promise(function(L){M.inited?L(co(M,k)):M.once("update",function(){L(co(M,k))})})}function Jc(M,k){var L=k.offset,K=k.shape,ie=k.thetaOffset,ne=k.mapVersion,nt=k.segmentNumber,rt=nt===void 0?30:nt,jt=k.autoFit,ct=jt===void 0?!0:jt,Yt=M.coordinates;if(K==="line")return pathLineAtOffset(Yt,L);var ar=Yt[0],fn=Yt[1],on=typeof ie=="string"?M[ie]||0:ie,Kr;switch(K){case"arc":Kr=arcLineAtOffset;break;case"greatcircle":Kr=greatCircleLineAtOffset;break;default:Kr=arcLineAtOffset}var Gn=Kr(ar,fn,L,on,ne,rt,ct),Zn=_slicedToArray(Gn,3),jn=Zn[0],vi=Zn[1],Si=Zn[2];return{lng:jn,lat:vi,height:Si}}var Ho=function(){function M(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,L=arguments.length>1?arguments[1]:void 0;(0,P.Z)(this,M),this.limit=k,this.destroy=L||this.defaultDestroy,this.order=[],this.clear()}return(0,D.Z)(M,[{key:"clear",value:function(){var L=this;this.order.forEach(function(K){L.delete(K)}),this.cache={},this.order=[]}},{key:"get",value:function(L){var K=this.cache[L];return K&&(this.deleteOrder(L),this.appendOrder(L)),K}},{key:"set",value:function(L,K){this.cache[L]?(this.delete(L),this.cache[L]=K,this.appendOrder(L)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[L]=K,this.appendOrder(L))}},{key:"delete",value:function(L){var K=this.cache[L];K&&(this.deleteCache(L),this.deleteOrder(L),this.destroy(K,L))}},{key:"deleteCache",value:function(L){delete this.cache[L]}},{key:"deleteOrder",value:function(L){var K=this.order.findIndex(function(ie){return ie===L});K>=0&&this.order.splice(K,1)}},{key:"appendOrder",value:function(L){this.order.push(L)}},{key:"defaultDestroy",value:function(L,K){return null}}]),M}();function wu(M){if(M.length===0)throw new Error("max requires at least one data point");for(var k=M[0],L=1;L<M.length;L++)M[L]>k&&(k=M[L]);return k*1}function fu(M){if(M.length===0)throw new Error("min requires at least one data point");for(var k=M[0],L=1;L<M.length;L++)M[L]<k&&(k=M[L]);return k*1}function hu(M){if(M.length===0)return 0;for(var k=M[0]*1,L=1;L<M.length;L++)k+=M[L]*1;return k}function Ql(M){if(M.length===0)throw new Error("mean requires at least one data point");return hu(M)/M.length}function _l(M){if(M.length===0)throw new Error("mean requires at least one data point");if(M.length<3)return M[0];M.sort();for(var k=M[0],L=NaN,K=0,ie=1,ne=1;ne<M.length+1;ne++)M[ne]!==k?(ie>K&&(K=ie,L=k),ie=1,k=M[ne]):ie++;return L*1}var tu={min:fu,max:wu,mean:Ql,sum:hu,mode:_l};function Jl(M,k){return M.map(function(L){return L[k]})}function sl(M,k){return tu[M](k)}var ru=x(15861),Wo=x(97326),eo=x(4942),fo=x(64687),Ru=x.n(fo);function Sf(M,k){k===void 0&&(k={});var L=Number(M[0]),K=Number(M[1]),ie=Number(M[2]),ne=Number(M[3]);if(M.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var nt=[L,K],rt=[L,ne],jt=[ie,ne],ct=[ie,K];return(0,Tn.yu)([[nt,ct,jt,rt,nt]],k.properties,{bbox:M,id:k.id})}var Vu=x(26729),hc=x.n(Vu),Pl=function(M){return M.Realtime="realtime",M.Overlap="overlap",M.Replace="replace",M}({}),Zs=function(M){return M.Loading="Loading",M.Loaded="Loaded",M.Failure="Failure",M.Cancelled="Cancelled",M}({}),Mu=0,pu=1,ju=2;function kl(M){M.forEach(function(k){k.isCurrent&&(k.isVisible=k.isLoaded)})}function Dl(M){M.forEach(function(k){k.properties.state=Mu}),M.forEach(function(k){k.isCurrent&&!pc(k)&&Hu(k)}),M.forEach(function(k){k.isVisible=!!(k.properties.state&ju)})}function $u(M){M.forEach(function(L){L.properties.state=Mu}),M.forEach(function(L){L.isCurrent&&pc(L)});var k=M.slice().sort(function(L,K){return L.z-K.z});k.forEach(function(L){L.isVisible=!!(L.properties.state&ju),L.children.length&&(L.isVisible||L.properties.state&pu)?L.children.forEach(function(K){K.properties.state=pu}):L.isCurrent&&Hu(L)})}function pc(M){for(;M;){if(M.isLoaded)return M.properties.state|=ju,!0;M=M.parent}return!1}function Hu(M){M.children.forEach(function(k){k.isLoaded?k.properties.state|=ju:Hu(k)})}var Rs,ef=256,kc=[-1/0,-1/0,1/0,1/0],tf=.2,xl=5,Ou=(Rs={},(0,eo.Z)(Rs,Pl.Realtime,kl),(0,eo.Z)(Rs,Pl.Overlap,Dl),(0,eo.Z)(Rs,Pl.Replace,$u),Rs),Ll=function(){};function Bl(M,k,L){var K=Math.floor((M+180)/360*Math.pow(2,L)),ie=Math.floor((1-Math.log(Math.tan(k*Math.PI/180)+1/Math.cos(k*Math.PI/180))/Math.PI)/2*Math.pow(2,L));return[K,ie]}function Wu(M,k,L){var K=M/Math.pow(2,L)*360-180,ie=Math.PI-2*Math.PI*k/Math.pow(2,L),ne=180/Math.PI*Math.atan(.5*(Math.exp(ie)-Math.exp(-ie)));return[K,ne]}var Tf=function(k,L,K){var ie=Wu(k,L,K),ne=(0,kt.Z)(ie,2),nt=ne[0],rt=ne[1],jt=Wu(k+1,L+1,K),ct=(0,kt.Z)(jt,2),Yt=ct[0],ar=ct[1];return[nt,ar,Yt,rt]};function dc(M){var k=M.zoom,L=M.latLonBounds,K=M.maxZoom,ie=K===void 0?1/0:K,ne=M.minZoom,nt=ne===void 0?0:ne,rt=M.zoomOffset,jt=rt===void 0?0:rt,ct=M.extent,Yt=ct===void 0?kc:ct,ar=Math.ceil(k)+jt;if(Number.isFinite(nt)&&ar<nt)return[];Number.isFinite(ie)&&ar>ie&&(ar=ie);for(var fn=(0,kt.Z)(L,4),on=fn[0],Kr=fn[1],Gn=fn[2],Zn=fn[3],jn=[Math.max(on,Yt[0]),Math.max(Kr,Yt[1]),Math.min(Gn,Yt[2]),Math.min(Zn,Yt[3])],vi=[],Si=Bl(jn[0],jn[1],ar),Oi=(0,kt.Z)(Si,2),Ba=Oi[0],Ha=Oi[1],go=Bl(jn[2],jn[3],ar),Ea=(0,kt.Z)(go,2),qi=Ea[0],Sa=Ea[1],Zo=Ba;Zo<=qi;Zo++)for(var ss=Sa;ss<=Ha;ss++)vi.push({x:Zo,y:ss,z:ar});var Fo=(qi+Ba)/2,Qo=(Ha+Sa)/2,Is=function(Iu,ds){return Math.abs(Iu-Fo)+Math.abs(ds-Qo)};return vi.sort(function(iu,Iu){return Is(iu.x,iu.y)-Is(Iu.x,Iu.y)}),vi}var rf=function(k,L,K){var ie=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,ne=Math.pow(2,K),nt=ne-1,rt=ne,jt=k,ct=L;return ie&&(jt<0?jt=jt+rt:jt>nt&&(jt=jt%rt)),{warpX:jt,warpY:ct}};function vc(M){var k=nf();return function(){var K=(0,fe.Z)(M),ie;if(k){var ne=(0,fe.Z)(this).constructor;ie=Reflect.construct(K,arguments,ne)}else ie=K.apply(this,arguments);return(0,W.Z)(this,ie)}}function nf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var ec=function(M){(0,X.Z)(L,M);var k=vc(L);function L(K){var ie;(0,P.Z)(this,L),ie=k.call(this),(0,eo.Z)((0,Wo.Z)(ie),"tileSize",256),(0,eo.Z)((0,Wo.Z)(ie),"isVisible",!1),(0,eo.Z)((0,Wo.Z)(ie),"isCurrent",!1),(0,eo.Z)((0,Wo.Z)(ie),"isVisibleChange",!1),(0,eo.Z)((0,Wo.Z)(ie),"loadedLayers",0),(0,eo.Z)((0,Wo.Z)(ie),"isLayerLoaded",!1),(0,eo.Z)((0,Wo.Z)(ie),"isLoad",!1),(0,eo.Z)((0,Wo.Z)(ie),"isChildLoad",!1),(0,eo.Z)((0,Wo.Z)(ie),"parent",null),(0,eo.Z)((0,Wo.Z)(ie),"children",[]),(0,eo.Z)((0,Wo.Z)(ie),"data",null),(0,eo.Z)((0,Wo.Z)(ie),"properties",{}),(0,eo.Z)((0,Wo.Z)(ie),"loadDataId",0);var ne=K.x,nt=K.y,rt=K.z,jt=K.tileSize,ct=K.warp,Yt=ct===void 0?!0:ct;return ie.x=ne,ie.y=nt,ie.z=rt,ie.warp=Yt||!0,ie.tileSize=jt,ie}return(0,D.Z)(L,[{key:"isLoading",get:function(){return this.loadStatus===Zs.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===Zs.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===Zs.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===Zs.Cancelled}},{key:"isDone",get:function(){return[Zs.Loaded,Zs.Cancelled,Zs.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return Tf(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var ie=(0,kt.Z)(this.bounds,4),ne=ie[0],nt=ie[1],rt=ie[2],jt=ie[3],ct=[(rt-ne)/2,(jt-nt)/2],Yt=Sf(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:ct,meta:`
      `.concat(this.key,`
      `)}});return Yt}},{key:"key",get:function(){var ie="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return ie}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var K=(0,ru.Z)(Ru().mark(function ne(nt){var rt,jt,ct,Yt,ar,fn,on,Kr,Gn,Zn,jn,vi,Si,Oi,Ba,Ha,go;return Ru().wrap(function(qi){for(;;)switch(qi.prev=qi.next){case 0:return rt=nt.getData,jt=nt.onLoad,ct=nt.onError,this.loadDataId++,Yt=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Zs.Loading,ar=null,qi.prev=7,on=this.x,Kr=this.y,Gn=this.z,Zn=this.bounds,jn=this.tileSize,vi=this.warp,Si=rf(on,Kr,Gn,vi),Oi=Si.warpX,Ba=Si.warpY,Ha=this.abortController.signal,go={x:Oi,y:Ba,z:Gn,bounds:Zn,tileSize:jn,signal:Ha,warp:vi},qi.next=14,rt(go,this);case 14:ar=qi.sent,qi.next=20;break;case 17:qi.prev=17,qi.t0=qi.catch(7),fn=qi.t0;case 20:if(Yt===this.loadDataId){qi.next=22;break}return qi.abrupt("return");case 22:if(!(this.isCancelled&&!ar)){qi.next=24;break}return qi.abrupt("return");case 24:if(!(fn||!ar)){qi.next=28;break}return this.loadStatus=Zs.Failure,ct(fn,this),qi.abrupt("return");case 28:this.loadStatus=Zs.Loaded,this.data=ar,jt(this);case 31:case"end":return qi.stop()}},ne,this,[[7,17]])}));function ie(ne){return K.apply(this,arguments)}return ie}()},{key:"reloadData",value:function(ie){this.isLoading&&this.abortLoad(),this.loadData(ie)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=Zs.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),L}(Vu.EventEmitter),mc=function(k,L){var K=Co(k),ie=Hi(K,L),ne=360*3-180,nt=85.0511287798065,rt=[Math.max(ie[0][0],-ne),Math.max(ie[0][1],-nt),Math.min(ie[1][0],ne),Math.min(ie[1][1],nt)];return rt},Gs=function(k,L){var K=Co(k),ie=Co(L),ne=In(K,ie);return ne};function du(M,k){var L=typeof Symbol!="undefined"&&M[Symbol.iterator]||M["@@iterator"];if(!L){if(Array.isArray(M)||(L=as(M))||k&&M&&typeof M.length=="number"){L&&(M=L);var K=0,ie=function(){};return{s:ie,n:function(){return K>=M.length?{done:!0}:{done:!1,value:M[K++]}},e:function(ct){throw ct},f:ie}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne=!0,nt=!1,rt;return{s:function(){L=L.call(M)},n:function(){var ct=L.next();return ne=ct.done,ct},e:function(ct){nt=!0,rt=ct},f:function(){try{!ne&&L.return!=null&&L.return()}finally{if(nt)throw rt}}}}function as(M,k){if(M){if(typeof M=="string")return Dc(M,k);var L=Object.prototype.toString.call(M).slice(8,-1);if(L==="Object"&&M.constructor&&(L=M.constructor.name),L==="Map"||L==="Set")return Array.from(M);if(L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return Dc(M,k)}}function Dc(M,k){(k==null||k>M.length)&&(k=M.length);for(var L=0,K=new Array(k);L<k;L++)K[L]=M[L];return K}function bl(M){var k=uo();return function(){var K=(0,fe.Z)(M),ie;if(k){var ne=(0,fe.Z)(this).constructor;ie=Reflect.construct(K,arguments,ne)}else ie=K.apply(this,arguments);return(0,W.Z)(this,ie)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var Lc=Rn.throttle,Vs=function(M){return M.TilesLoadStart="tiles-load-start",M.TileLoaded="tile-loaded",M.TileError="tile-error",M.TileUnload="tile-unload",M.TileUpdate="tile-update",M.TilesLoadFinished="tiles-load-finished",M}({}),ul=function(M){(0,X.Z)(L,M);var k=bl(L);function L(K){var ie;return(0,P.Z)(this,L),ie=k.call(this),(0,eo.Z)((0,Wo.Z)(ie),"currentTiles",[]),(0,eo.Z)((0,Wo.Z)(ie),"cacheTiles",new Map),(0,eo.Z)((0,Wo.Z)(ie),"throttleUpdate",Lc(function(ne,nt){ie.update(ne,nt)},16)),(0,eo.Z)((0,Wo.Z)(ie),"onTileLoad",function(ne){ie.emit(Vs.TileLoaded,ne),ie.updateTileVisible(),ie.loadFinished()}),(0,eo.Z)((0,Wo.Z)(ie),"onTileError",function(ne,nt){ie.emit(Vs.TileError,{error:ne,tile:nt}),ie.updateTileVisible(),ie.loadFinished()}),(0,eo.Z)((0,Wo.Z)(ie),"onTileUnload",function(ne){ie.emit(Vs.TileUnload,ne),ie.loadFinished()}),ie.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:kc,getTileData:Ll,warp:!0,updateStrategy:Pl.Replace},ie.updateOptions(K),ie}return(0,D.Z)(L,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(ie){return ie.isDone})}},{key:"tiles",get:function(){var ie=Array.from(this.cacheTiles.values()).sort(function(ne,nt){return ne.z-nt.z});return ie}},{key:"updateOptions",value:function(ie){var ne=ie.minZoom===void 0?this.options.minZoom:Math.ceil(ie.minZoom),nt=ie.maxZoom===void 0?this.options.maxZoom:Math.floor(ie.maxZoom);this.options=(0,h.Z)((0,h.Z)((0,h.Z)({},this.options),ie),{},{minZoom:ne,maxZoom:nt})}},{key:"update",value:function(ie,ne){var nt=this,rt=Math.max(0,Math.ceil(ie));if(!(this.lastViewStates&&this.lastViewStates.zoom===rt&&Gs(this.lastViewStates.latLonBoundsBuffer,ne))){var jt=mc(ne,tf);this.lastViewStates={zoom:rt,latLonBounds:ne,latLonBoundsBuffer:jt},this.currentZoom=rt;var ct=!1,Yt=this.getTileIndices(rt,jt).filter(function(ar){return nt.options.warp||ar.x>=0&&ar.x<Math.pow(2,rt)});this.emit(Vs.TilesLoadStart),this.currentTiles=Yt.map(function(ar){var fn=ar.x,on=ar.y,Kr=ar.z,Gn=nt.getTile(fn,on,Kr);if(Gn){var Zn,jn,vi=((Zn=Gn)===null||Zn===void 0?void 0:Zn.isFailure)||((jn=Gn)===null||jn===void 0?void 0:jn.isCancelled);return vi&&Gn.loadData({getData:nt.options.getTileData,onLoad:nt.onTileLoad,onError:nt.onTileError}),Gn}return Gn=nt.createTile(fn,on,Kr),ct=!0,Gn}),ct&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var ie=du(this.cacheTiles),ne;try{for(ie.s();!(ne=ie.n()).done;){var nt=(0,kt.Z)(ne.value,2),rt=nt[0],jt=nt[1];if(!this.currentTiles.includes(jt)){this.cacheTiles.delete(rt),this.onTileUnload(jt);return}this.onTileUnload(jt),jt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(ct){ie.e(ct)}finally{ie.f()}}},{key:"reloadTileById",value:function(ie,ne,nt){var rt=this.cacheTiles.get("".concat(ne,",").concat(nt,",").concat(ie));rt&&(this.onTileUnload(rt),rt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(ie,ne,nt){var rt=this.getTileByLngLat(ie,ne,nt);rt&&this.reloadTileById(rt.z,rt.x,rt.y)}},{key:"reloadTileByExtent",value:function(ie,ne){var nt=this,rt=this.getTileIndices(ne,ie);rt.forEach(function(jt){nt.reloadTileById(jt.z,jt.x,jt.y)})}},{key:"pruneRequests",value:function(){var ie=[],ne=du(this.cacheTiles.values()),nt;try{for(ne.s();!(nt=ne.n()).done;){var rt=nt.value;rt.isLoading&&!rt.isCurrent&&!rt.isVisible&&ie.push(rt)}}catch(ct){ne.e(ct)}finally{ne.f()}for(;ie.length>0;){var jt=ie.shift();jt.abortLoad()}}},{key:"getTileByLngLat",value:function(ie,ne,nt){var rt=this.options.zoomOffset,jt=Math.ceil(nt)+rt,ct=Bl(ie,ne,jt),Yt=this.tiles.filter(function(ar){return ar.key==="".concat(ct[0],"_").concat(ct[1],"_").concat(jt)});return Yt[0]}},{key:"getTileExtent",value:function(ie,ne){return this.getTileIndices(ne,ie)}},{key:"getTileByZXY",value:function(ie,ne,nt){var rt=this.tiles.filter(function(jt){return jt.key==="".concat(ne,"_").concat(nt,"_").concat(ie)});return rt[0]}},{key:"clear",value:function(){var ie=du(this.cacheTiles.values()),ne;try{for(ie.s();!(ne=ie.n()).done;){var nt=ne.value;nt.isLoading?nt.abortLoad():this.onTileUnload(nt)}}catch(rt){ie.e(rt)}finally{ie.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var ie=this.options.updateStrategy,ne=new Map,nt=du(this.cacheTiles.values()),rt;try{for(nt.s();!(rt=nt.n()).done;){var jt=rt.value;ne.set(jt.key,jt.isVisible),jt.isCurrent=!1,jt.isVisible=!1}}catch(Kr){nt.e(Kr)}finally{nt.f()}var ct=du(this.currentTiles),Yt;try{for(ct.s();!(Yt=ct.n()).done;){var ar=Yt.value;ar.isCurrent=!0,ar.isVisible=!0}}catch(Kr){ct.e(Kr)}finally{ct.f()}var fn=Array.from(this.cacheTiles.values());typeof ie=="function"?ie(fn):Ou[ie](fn);var on=!1;Array.from(this.cacheTiles.values()).forEach(function(Kr){Kr.isVisible!==ne.get(Kr.key)?(Kr.isVisibleChange=!0,on=!0):Kr.isVisibleChange=!1}),on&&this.emit(Vs.TileUpdate)}},{key:"getTileIndices",value:function(ie,ne){var nt=this.options,rt=nt.tileSize,jt=nt.extent,ct=nt.zoomOffset,Yt=Math.floor(this.options.maxZoom),ar=Math.ceil(this.options.minZoom),fn=dc({maxZoom:Yt,minZoom:ar,zoomOffset:ct,tileSize:rt,zoom:ie,latLonBounds:ne,extent:jt});return fn}},{key:"getTileId",value:function(ie,ne,nt){var rt="".concat(ie,",").concat(ne,",").concat(nt);return rt}},{key:"loadFinished",value:function(){var ie=!this.currentTiles.some(function(ne){return!ne.isDone});return ie&&this.emit(Vs.TilesLoadFinished),ie}},{key:"getTile",value:function(ie,ne,nt){var rt=this.getTileId(ie,ne,nt),jt=this.cacheTiles.get(rt);return jt}},{key:"createTile",value:function(ie,ne,nt){var rt=this.getTileId(ie,ne,nt),jt=new ec({x:ie,y:ne,z:nt,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(rt,jt),jt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),jt}},{key:"resizeCacheTiles",value:function(){var ie=xl*this.currentTiles.length,ne=this.cacheTiles.size>ie;if(ne){var nt=du(this.cacheTiles),rt;try{for(nt.s();!(rt=nt.n()).done;){var jt=(0,kt.Z)(rt.value,2),ct=jt[0],Yt=jt[1];if(!Yt.isVisible&&!this.currentTiles.includes(Yt)&&(this.cacheTiles.delete(ct),this.onTileUnload(Yt)),this.cacheTiles.size<=ie)break}}catch(ar){nt.e(ar)}finally{nt.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var ie=du(this.cacheTiles.values()),ne;try{for(ie.s();!(ne=ie.n()).done;){var nt=ne.value;nt.parent=null,nt.children.length=0}}catch(ar){ie.e(ar)}finally{ie.f()}var rt=du(this.cacheTiles.values()),jt;try{for(rt.s();!(jt=rt.n()).done;){var ct=jt.value,Yt=this.getNearestAncestor(ct.x,ct.y,ct.z);ct.parent=Yt,Yt!=null&&Yt.children&&Yt.children.push(ct)}}catch(ar){rt.e(ar)}finally{rt.f()}}},{key:"getNearestAncestor",value:function(ie,ne,nt){for(;nt>this.options.minZoom;){ie=Math.floor(ie/2),ne=Math.floor(ne/2),nt=nt-1;var rt=this.getTile(ie,ne,nt);if(rt)return rt}return null}}]),L}(hc());function Ca(M){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(M)}function lo(M){var k=[],L=/\{([a-z])-([a-z])\}/.exec(M);if(L){var K=L[1].charCodeAt(0),ie=L[2].charCodeAt(0),ne;for(ne=K;ne<=ie;++ne)k.push(M.replace(L[0],String.fromCharCode(ne)));return k}if(L=/\{(\d+)-(\d+)\}/.exec(M),L){for(var nt=parseInt(L[2],10),rt=parseInt(L[1],10);rt<=nt;rt++)k.push(M.replace(L[0],rt.toString()));return k}return k.push(M),k}function Xs(M,k){if(!M||!M.length)throw new Error("url is not allowed to be empty");var L=k.x,K=k.y,ie=k.z,ne=lo(M),nt=Math.abs(L+K)%ne.length,rt=Ce(ne[nt])?"".concat(ne[nt],"/{z}/{x}/{y}"):ne[nt];return rt.replace(/\{x\}/g,L.toString()).replace(/\{y\}/g,K.toString()).replace(/\{z\}/g,ie.toString()).replace(/\{bbox\}/g,Tf(L,K,ie).join(",")).replace(/\{-y\}/g,(Math.pow(2,ie)-K-1).toString())}function gc(M,k){var L=k.x,K=k.y,ie=k.z,ne=k.layer,nt=k.version,rt=nt===void 0?"1.0.0":nt,jt=k.style,ct=jt===void 0?"default":jt,Yt=k.format,ar=k.service,fn=ar===void 0?"WMTS":ar,on=k.tileMatrixset,Kr=lo(M),Gn=Math.abs(L+K)%Kr.length,Zn="".concat(Kr[Gn],"&SERVICE=").concat(fn,"&REQUEST=GetTile&VERSION=").concat(rt,"&LAYER=").concat(ne,"&STYLE=").concat(ct,"&TILEMATRIXSET=").concat(on,"&FORMAT=").concat(Yt,"&TILECOL=").concat(L,"&TILEROW=").concat(K,"&TILEMATRIX=").concat(ie);return Zn}function Gu(M,k){if(!M)throw new Error(k||"web worker helper assertion failed.")}var vu={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},Af=vu.self||vu.window||{},Bc=vu.window||vu.self||{},yc=vu.self||vu.window||{},Fl=vu.document||{},os=typeof importScripts=="function",So=typeof window!="undefined"&&typeof window.orientation!="undefined",Nl=function(){function M(k,L){var K=this;this.name=k,this.workerThread=L,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(ie,ne){K.resolve=ie,K.reject=ne})}return M.prototype.postMessage=function(k,L){this.workerThread.postMessage({source:"Main thread",type:k,payload:L})},M.prototype.done=function(k){Gu(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(k)},M.prototype.error=function(k){Gu(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(k)},M}(),af=Nl,wo=new Map;function ii(M){Gu(M.source&&!M.url||!M.source&&M.url);var k=wo.get(M.source||M.url);return k||(M.url&&(k=Ms(M.url),wo.set(M.url,k)),M.source&&(k=tc(M.source),wo.set(M.source,k))),Gu(k),k}function Ms(M){if(!M.startsWith("http"))return M;var k=Ul(M);return tc(k)}function tc(M){var k=new Blob([M],{type:"application/javascript"});return URL.createObjectURL(k)}function Ul(M){return`try {
  importScripts('`+M+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function ps(M,k,L){k===void 0&&(k=!0);var K=L||new Set;if(M){if(to(M))K.add(M);else if(to(M.buffer))K.add(M.buffer);else if(!ArrayBuffer.isView(M)){if(k&&typeof M=="object")for(var ie in M)ps(M[ie],k,K)}}return L===void 0?Array.from(K):[]}function to(M){return M?M instanceof ArrayBuffer||typeof MessagePort!="undefined"&&M instanceof MessagePort||typeof ImageBitmap!="undefined"&&M instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&M instanceof OffscreenCanvas:!1}var zl=function(){},S=function(){function M(k){this.terminated=!1,this.loadableURL="";var L=k.name,K=k.source,ie=k.url;Gu(K||ie),this.name=L,this.source=K,this.url=ie,this.onMessage=zl,this.onError=function(ne){return console.log(ne)},this.worker=this.createBrowserWorker()}return M.isSupported=function(){return typeof Worker!="undefined"},M.prototype.destroy=function(){this.onMessage=zl,this.onError=zl,this.worker.terminate(),this.terminated=!0},Object.defineProperty(M.prototype,"isRunning",{get:function(){return!!this.onMessage},enumerable:!1,configurable:!0}),M.prototype.postMessage=function(k,L){L=L||ps(k),this.worker.postMessage(k,L)},M.prototype.getErrorFromErrorEvent=function(k){var L="Failed to load ";return L+="worker "+this.name+" from "+this.url+". ",k.message&&(L+=k.message+" in "),k.lineno&&(L+=":"+k.lineno+":"+k.colno),new Error(L)},M.prototype.createBrowserWorker=function(){var k=this;this.loadableURL=ii({source:this.source,url:this.url});var L=new Worker(this.loadableURL,{name:this.name});return L.onmessage=function(K){K.data?k.onMessage(K.data):k.onError(new Error("No data received"))},L.onerror=function(K){k.onError(k.getErrorFromErrorEvent(K)),k.terminated=!0},L.onmessageerror=function(K){return console.error("worker "+k.name+", message error: "+K)},L},M}(),Ge=S,re=function(){return re=Object.assign||function(M){for(var k,L=1,K=arguments.length;L<K;L++){k=arguments[L];for(var ie in k)Object.prototype.hasOwnProperty.call(k,ie)&&(M[ie]=k[ie])}return M},re.apply(this,arguments)},ce=function(M,k,L,K){function ie(ne){return ne instanceof L?ne:new L(function(nt){nt(ne)})}return new(L||(L=Promise))(function(ne,nt){function rt(Yt){try{ct(K.next(Yt))}catch(ar){nt(ar)}}function jt(Yt){try{ct(K.throw(Yt))}catch(ar){nt(ar)}}function ct(Yt){Yt.done?ne(Yt.value):ie(Yt.value).then(rt,jt)}ct((K=K.apply(M,k||[])).next())})},G=function(M,k){var L={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},K,ie,ne,nt;return nt={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(nt[Symbol.iterator]=function(){return this}),nt;function rt(ct){return function(Yt){return jt([ct,Yt])}}function jt(ct){if(K)throw new TypeError("Generator is already executing.");for(;L;)try{if(K=1,ie&&(ne=ct[0]&2?ie.return:ct[0]?ie.throw||((ne=ie.return)&&ne.call(ie),0):ie.next)&&!(ne=ne.call(ie,ct[1])).done)return ne;switch(ie=0,ne&&(ct=[ct[0]&2,ne.value]),ct[0]){case 0:case 1:ne=ct;break;case 4:return L.label++,{value:ct[1],done:!1};case 5:L.label++,ie=ct[1],ct=[0];continue;case 7:ct=L.ops.pop(),L.trys.pop();continue;default:if(ne=L.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(ct[0]===6||ct[0]===2)){L=0;continue}if(ct[0]===3&&(!ne||ct[1]>ne[0]&&ct[1]<ne[3])){L.label=ct[1];break}if(ct[0]===6&&L.label<ne[1]){L.label=ne[1],ne=ct;break}if(ne&&L.label<ne[2]){L.label=ne[2],L.ops.push(ct);break}ne[2]&&L.ops.pop(),L.trys.pop();continue}ct=k.call(M,L)}catch(Yt){ct=[6,Yt],ie=0}finally{K=ne=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}},xe=function(){function M(k){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=k.source,this.url=k.url,this.setProps(k)}return M.prototype.destroy=function(){this.idleQueue.forEach(function(k){return k.destroy()}),this.isDestroyed=!0},M.prototype.setProps=function(k){this.props=re(re({},this.props),k),k.name!==void 0&&(this.name=k.name),k.maxConcurrency!==void 0&&(this.maxConcurrency=k.maxConcurrency),k.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=k.maxMobileConcurrency),k.reuseWorkers!==void 0&&(this.reuseWorkers=k.reuseWorkers),k.onDebug!==void 0&&(this.onDebug=k.onDebug)},M.prototype.startJob=function(k,L,K){return L===void 0&&(L=function(ie,ne,nt){return ie.done(nt)}),K===void 0&&(K=function(ie,ne){return ie.error(ne)}),ce(this,void 0,void 0,function(){var ie,ne=this;return G(this,function(nt){switch(nt.label){case 0:return ie=new Promise(function(rt){return ne.jobQueue.push({name:k,onMessage:L,onError:K,onStart:rt}),ne}),this.startQueuedJob(),[4,ie];case 1:return[2,nt.sent()]}})})},M.prototype.startQueuedJob=function(){return ce(this,void 0,void 0,function(){var k,L,K;return G(this,function(ie){switch(ie.label){case 0:if(!this.jobQueue.length)return[2];if(k=this.getAvailableWorker(),!k)return[2];if(L=this.jobQueue.shift(),!L)return[3,4];this.onDebug({message:"Starting job",name:L.name,backlog:this.jobQueue.length,workerThread:k}),K=new af(L.name,k),k.onMessage=function(ne){return L.onMessage(K,ne.type,ne.payload)},k.onError=function(ne){return L.onError(K,ne)},L.onStart(K),ie.label=1;case 1:return ie.trys.push([1,,3,4]),[4,K.result];case 2:return ie.sent(),[3,4];case 3:return this.returnWorkerToQueue(k),[7];case 4:return[2]}})})},M.prototype.returnWorkerToQueue=function(k){var L=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();L?(k.destroy(),this.count--):this.idleQueue.push(k),this.isDestroyed||this.startQueuedJob()},M.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var k=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Ge({name:k,source:this.source,url:this.url})}return null},M.prototype.getMaxConcurrency=function(){return So?this.maxMobileConcurrency:this.maxConcurrency},M}(),ut=xe,Dt=function(){return Dt=Object.assign||function(M){for(var k,L=1,K=arguments.length;L<K;L++){k=arguments[L];for(var ie in k)Object.prototype.hasOwnProperty.call(k,ie)&&(M[ie]=k[ie])}return M},Dt.apply(this,arguments)},dt=function(M){var k=typeof Symbol=="function"&&Symbol.iterator,L=k&&M[k],K=0;if(L)return L.call(M);if(M&&typeof M.length=="number")return{next:function(){return M&&K>=M.length&&(M=void 0),{value:M&&M[K++],done:!M}}};throw new TypeError(k?"Object is not iterable.":"Symbol.iterator is not defined.")},It={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Tr=function(){function M(k){this.workerPools=new Map,this.props=Dt({},It),this.setProps(k),this.workerPools=new Map}return M.isSupported=function(){return Ge.isSupported()},M.getWorkerFarm=function(k){return k===void 0&&(k={}),M.workerFarm=M.workerFarm||new M({}),M.workerFarm.setProps(k),M.workerFarm},M.prototype.destroy=function(){var k,L;try{for(var K=dt(this.workerPools.values()),ie=K.next();!ie.done;ie=K.next()){var ne=ie.value;ne.destroy()}}catch(nt){k={error:nt}}finally{try{ie&&!ie.done&&(L=K.return)&&L.call(K)}finally{if(k)throw k.error}}},M.prototype.setProps=function(k){var L,K;this.props=Dt(Dt({},this.props),k);try{for(var ie=dt(this.workerPools.values()),ne=ie.next();!ne.done;ne=ie.next()){var nt=ne.value;nt.setProps(this.getWorkerPoolProps())}}catch(rt){L={error:rt}}finally{try{ne&&!ne.done&&(K=ie.return)&&K.call(ie)}finally{if(L)throw L.error}}},M.prototype.getWorkerPool=function(k){var L=k.name,K=k.source,ie=k.url,ne=this.workerPools.get(L);return ne||(ne=new ut({name:L,source:K,url:ie}),ne.setProps(this.getWorkerPoolProps()),this.workerPools.set(L,ne)),ne},M.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},M}(),Yr=null,wn=new Map,Bn=function(){function M(){}return Object.defineProperty(M,"onmessage",{set:function(k){self.onmessage=function(L){if(fi(L)){var K=L.data,ie=K.type,ne=K.payload;k(ie,ne)}}},enumerable:!1,configurable:!0}),M.addEventListener=function(k){var L=wn.get(k);L||(L=function(K){if(fi(K)){var ie=K.data,ne=ie.type,nt=ie.payload;k(ne,nt)}}),self.addEventListener("message",L)},M.removeEventListener=function(k){var L=wn.get(k);wn.delete(k),self.removeEventListener("message",L)},M.postMessage=function(k,L){if(self){var K={source:"Worker thread",type:k,payload:L},ie=ps(L);self.postMessage(K,ie)}},M}(),Kn=null;function fi(M){var k=M.type,L=M.data;return k==="message"&&L&&typeof L.source=="string"&&L.source==="Main thread"}function Gr(M){return JSON.parse(Ri(M))}function Ri(M){var k=new Set;return JSON.stringify(M,function(L,K){if(typeof K=="object"&&K!==null){if(k.has(K))try{return JSON.parse(JSON.stringify(K))}catch(ie){return}k.add(K)}return K})}function Pi(M){return""+M.name}function Mi(M,k){k===void 0&&(k={});var L=k[M.id]||{},K=M.name+".worker.js",ie=L.workerUrl;return k._workerType==="test"&&(ie=M.module+"/dist/"+K),ie||(ie="https://unpkg.com/"+M.module+"/dist/"+K),assert(ie),ie}var wa=function(M,k,L,K){function ie(ne){return ne instanceof L?ne:new L(function(nt){nt(ne)})}return new(L||(L=Promise))(function(ne,nt){function rt(Yt){try{ct(K.next(Yt))}catch(ar){nt(ar)}}function jt(Yt){try{ct(K.throw(Yt))}catch(ar){nt(ar)}}function ct(Yt){Yt.done?ne(Yt.value):ie(Yt.value).then(rt,jt)}ct((K=K.apply(M,k||[])).next())})},Ja=function(M,k){var L={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},K,ie,ne,nt;return nt={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(nt[Symbol.iterator]=function(){return this}),nt;function rt(ct){return function(Yt){return jt([ct,Yt])}}function jt(ct){if(K)throw new TypeError("Generator is already executing.");for(;L;)try{if(K=1,ie&&(ne=ct[0]&2?ie.return:ct[0]?ie.throw||((ne=ie.return)&&ne.call(ie),0):ie.next)&&!(ne=ne.call(ie,ct[1])).done)return ne;switch(ie=0,ne&&(ct=[ct[0]&2,ne.value]),ct[0]){case 0:case 1:ne=ct;break;case 4:return L.label++,{value:ct[1],done:!1};case 5:L.label++,ie=ct[1],ct=[0];continue;case 7:ct=L.ops.pop(),L.trys.pop();continue;default:if(ne=L.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(ct[0]===6||ct[0]===2)){L=0;continue}if(ct[0]===3&&(!ne||ct[1]>ne[0]&&ct[1]<ne[3])){L.label=ct[1];break}if(ct[0]===6&&L.label<ne[1]){L.label=ne[1],ne=ct;break}if(ne&&L.label<ne[2]){L.label=ne[2],L.ops.push(ct);break}ne[2]&&L.ops.pop(),L.trys.pop();continue}ct=k.call(M,L)}catch(Yt){ct=[6,Yt],ie=0}finally{K=ne=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}};function La(M,k){return WorkerFarm.isSupported()?M.worker&&(k==null?void 0:k.worker):!1}function ya(M,k,L,K){return L===void 0&&(L={}),K===void 0&&(K={}),wa(this,void 0,void 0,function(){var ie,ne,nt,rt,jt,ct,Yt,ar;return Ja(this,function(fn){switch(fn.label){case 0:return ie=getWorkerName(M),ne=getWorkerURL(M,L),nt=WorkerFarm.getWorkerFarm(L),rt=nt.getWorkerPool({name:ie,url:ne}),jt=L.jobName||M.name,[4,rt.startJob(jt,Gi.bind(null,K))];case 1:return ct=fn.sent(),Yt=removeNontransferableOptions(L),ct.postMessage("process",{input:k,options:Yt}),[4,ct.result];case 2:return ar=fn.sent(),[2,ar.result]}})})}function Gi(M,k,L,K){return wa(this,void 0,void 0,function(){var ie,ne,nt,rt,jt,ct,Yt;return Ja(this,function(ar){switch(ar.label){case 0:switch(ie=L,ie){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return k.done(K),[3,9];case 2:return k.error(new Error(K.error)),[3,9];case 3:ne=K.id,nt=K.input,rt=K.options,ar.label=4;case 4:return ar.trys.push([4,6,,7]),M.process?[4,M.process(nt,rt)]:(k.postMessage("error",{id:ne,error:"Worker not set up to process on main thread"}),[2]);case 5:return jt=ar.sent(),k.postMessage("done",{id:ne,result:jt}),[3,7];case 6:return ct=ar.sent(),Yt=ct instanceof Error?ct.message:"unknown error",k.postMessage("error",{id:ne,error:Yt}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+L),ar.label=9;case 9:return[2]}})})}var zn=function(){function M(){this._values=[],this._settlers=[],this._closed=!1}return M.prototype[Symbol.asyncIterator]=function(){return this},M.prototype.push=function(k){return this.enqueue(k)},M.prototype.enqueue=function(k){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var L=this._settlers.shift();k instanceof Error?L.reject(k):L.resolve({value:k})}else this._values.push(k)},M.prototype.close=function(){for(;this._settlers.length>0;){var k=this._settlers.shift();k.resolve({done:!0})}this._closed=!0},M.prototype.next=function(){var k=this;if(this._values.length>0){var L=this._values.shift();return L instanceof Error?Promise.reject(L):Promise.resolve({done:!1,value:L})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(K,ie){k._settlers.push({resolve:K,reject:ie})})},M}(),Fn=null,$a=function(M,k,L,K){function ie(ne){return ne instanceof L?ne:new L(function(nt){nt(ne)})}return new(L||(L=Promise))(function(ne,nt){function rt(Yt){try{ct(K.next(Yt))}catch(ar){nt(ar)}}function jt(Yt){try{ct(K.throw(Yt))}catch(ar){nt(ar)}}function ct(Yt){Yt.done?ne(Yt.value):ie(Yt.value).then(rt,jt)}ct((K=K.apply(M,k||[])).next())})},_a=function(M,k){var L={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},K,ie,ne,nt;return nt={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(nt[Symbol.iterator]=function(){return this}),nt;function rt(ct){return function(Yt){return jt([ct,Yt])}}function jt(ct){if(K)throw new TypeError("Generator is already executing.");for(;L;)try{if(K=1,ie&&(ne=ct[0]&2?ie.return:ct[0]?ie.throw||((ne=ie.return)&&ne.call(ie),0):ie.next)&&!(ne=ne.call(ie,ct[1])).done)return ne;switch(ie=0,ne&&(ct=[ct[0]&2,ne.value]),ct[0]){case 0:case 1:ne=ct;break;case 4:return L.label++,{value:ct[1],done:!1};case 5:L.label++,ie=ct[1],ct=[0];continue;case 7:ct=L.ops.pop(),L.trys.pop();continue;default:if(ne=L.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(ct[0]===6||ct[0]===2)){L=0;continue}if(ct[0]===3&&(!ne||ct[1]>ne[0]&&ct[1]<ne[3])){L.label=ct[1];break}if(ct[0]===6&&L.label<ne[1]){L.label=ne[1],ne=ct;break}if(ne&&L.label<ne[2]){L.label=ne[2],L.ops.push(ct);break}ne[2]&&L.ops.pop(),L.trys.pop();continue}ct=k.call(M,L)}catch(Yt){ct=[6,Yt],ie=0}finally{K=ne=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}},Ra=function(M){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k=M[Symbol.asyncIterator],L;return k?k.call(M):(M=typeof __values=="function"?__values(M):M[Symbol.iterator](),L={},K("next"),K("throw"),K("return"),L[Symbol.asyncIterator]=function(){return this},L);function K(ne){L[ne]=M[ne]&&function(nt){return new Promise(function(rt,jt){nt=M[ne](nt),ie(rt,jt,nt.done,nt.value)})}}function ie(ne,nt,rt,jt){Promise.resolve(jt).then(function(ct){ne({value:ct,done:rt})},nt)}},Ma=0,da,qo;function Xu(M,k){var L=this;if(typeof self!="undefined"){var K={process:ha};WorkerBody.onmessage=function(ie,ne){return $a(L,void 0,void 0,function(){var nt,rt,jt,ct,Yt,ar,fn,on,Kr,Gn,Zn;return _a(this,function(jn){switch(jn.label){case 0:switch(jn.trys.push([0,19,,20]),nt=ie,nt){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!M)throw new Error("Worker does not support atomic processing");return[4,M(ne.input,ne.options||{},K)];case 2:return rt=jn.sent(),WorkerBody.postMessage("done",{result:rt}),[3,18];case 3:if(!k)throw new Error("Worker does not support batched processing");da=new AsyncQueue,qo=ne.options||{},jt=k(da,qo,K),jn.label=4;case 4:jn.trys.push([4,9,10,15]),ct=Ra(jt),jn.label=5;case 5:return[4,ct.next()];case 6:if(Yt=jn.sent(),!!Yt.done)return[3,8];ar=Yt.value,WorkerBody.postMessage("output-batch",{result:ar}),jn.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return fn=jn.sent(),Gn={error:fn},[3,15];case 10:return jn.trys.push([10,,13,14]),Yt&&!Yt.done&&(Zn=ct.return)?[4,Zn.call(ct)]:[3,12];case 11:jn.sent(),jn.label=12;case 12:return[3,14];case 13:if(Gn)throw Gn.error;return[7];case 14:return[7];case 15:return WorkerBody.postMessage("done",{}),[3,18];case 16:return da.push(ne.input),[3,18];case 17:return da.close(),[3,18];case 18:return[3,20];case 19:return on=jn.sent(),Kr=on instanceof Error?on.message:"",WorkerBody.postMessage("error",{error:Kr}),[3,20];case 20:return[2]}})})}}}function ha(M,k){return k===void 0&&(k={}),new Promise(function(L,K){var ie=Ma++,ne=function(rt,jt){if(jt.id===ie)switch(rt){case"done":WorkerBody.removeEventListener(ne),L(jt.result);break;case"error":WorkerBody.removeEventListener(ne),K(jt.error);break;default:}};WorkerBody.addEventListener(ne);var nt={id:ie,input:M,options:k};WorkerBody.postMessage("process",nt)})}var mo=function(M,k,L,K){function ie(ne){return ne instanceof L?ne:new L(function(nt){nt(ne)})}return new(L||(L=Promise))(function(ne,nt){function rt(Yt){try{ct(K.next(Yt))}catch(ar){nt(ar)}}function jt(Yt){try{ct(K.throw(Yt))}catch(ar){nt(ar)}}function ct(Yt){Yt.done?ne(Yt.value):ie(Yt.value).then(rt,jt)}ct((K=K.apply(M,k||[])).next())})},Fc=function(M,k){var L={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},K,ie,ne,nt;return nt={next:rt(0),throw:rt(1),return:rt(2)},typeof Symbol=="function"&&(nt[Symbol.iterator]=function(){return this}),nt;function rt(ct){return function(Yt){return jt([ct,Yt])}}function jt(ct){if(K)throw new TypeError("Generator is already executing.");for(;L;)try{if(K=1,ie&&(ne=ct[0]&2?ie.return:ct[0]?ie.throw||((ne=ie.return)&&ne.call(ie),0):ie.next)&&!(ne=ne.call(ie,ct[1])).done)return ne;switch(ie=0,ne&&(ct=[ct[0]&2,ne.value]),ct[0]){case 0:case 1:ne=ct;break;case 4:return L.label++,{value:ct[1],done:!1};case 5:L.label++,ie=ct[1],ct=[0];continue;case 7:ct=L.ops.pop(),L.trys.pop();continue;default:if(ne=L.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(ct[0]===6||ct[0]===2)){L=0;continue}if(ct[0]===3&&(!ne||ct[1]>ne[0]&&ct[1]<ne[3])){L.label=ct[1];break}if(ct[0]===6&&L.label<ne[1]){L.label=ne[1],ne=ct;break}if(ne&&L.label<ne[2]){L.label=ne[2],L.ops.push(ct);break}ne[2]&&L.ops.pop(),L.trys.pop();continue}ct=k.call(M,L)}catch(Yt){ct=[6,Yt],ie=0}finally{K=ne=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}},nu={};function Cf(M,k,L){return k===void 0&&(k=null),L===void 0&&(L={}),mo(this,void 0,void 0,function(){return Fc(this,function(K){switch(K.label){case 0:return k&&(M=Zl(M,k,L)),nu[M]=nu[M]||Os(M),[4,nu[M]];case 1:return[2,K.sent()]}})})}function Zl(M,k,L){if(M.startsWith("http"))return M;var K=L.modules||{};return K[M]?K[M]:L.CDN?(assert(L.CDN.startsWith("http")),L.CDN+"/"+k+"/dist/libs/"+M):isWorker?"../src/libs/"+M:"modules/"+k+"/src/libs/"+M}function Os(M){return mo(this,void 0,void 0,function(){var k,L,K;return Fc(this,function(ie){switch(ie.label){case 0:return M.endsWith("wasm")?[4,fetch(M)]:[3,3];case 1:return k=ie.sent(),[4,k.arrayBuffer()];case 2:return[2,ie.sent()];case 3:return isWorker?[2,importScripts(M)]:[4,fetch(M)];case 4:return L=ie.sent(),[4,L.text()];case 5:return K=ie.sent(),[2,rc(K,M)]}})})}function rc(M,k){if(isWorker)return eval.call(global,M),null;var L=document.createElement("script");L.id=k;try{L.appendChild(document.createTextNode(M))}catch(K){L.text=M}return document.body.appendChild(L),null}var Vl="0.0.3",$f={id:"null",name:"null",module:"web-worker-helper",options:{}};function ll(M){var k=M.color;return!k||!k.length?[1,1,1,1]:k}function El(M,k,L){return L.length===2?[L[0],L[1],0]:[L[0],L[1],L[2]]}function jl(M){var k=M.filter;return k?[1]:[0]}function cl(M,k){return[k]}var fl=x(9187),_c=x.n(fl),Ui=x(31437),mu=Ui.Ue(),wf=Ui.Ue(),To=Ui.Ue(),ho=Ui.Ue(),Yu=Ui.Ue();function $l(M,k,L,K,ie){Ui.IH(M,L,K),Ui.Fv(M,M),k=Ui.al(-M[1],M[0]);var ne=Ui.al(-L[1],L[0]);return[ie/Ui.AK(k,ne),k]}function gu(M,k){return Ui.t8(M,-k[1],k[0])}function Hl(M,k,L){return Ui.lu(M,k,L),Ui.Fv(M,M),M}function l(M,k){return M[0]===k[0]&&M[1]===k[1]}function p(M){for(var k=new Map,L=0;L<M.length;L++){var K=M[0].toString()+"-"+M[1].toString();k.get(K)?(M.splice(L,1),L++):k.set(K,K)}return M}var f=function(){function M(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,P.Z)(this,M),(0,eo.Z)(this,"lastFlip",-1),(0,eo.Z)(this,"miter",Ui.al(0,0)),(0,eo.Z)(this,"started",!1),(0,eo.Z)(this,"dash",!1),(0,eo.Z)(this,"totalDistance",0),(0,eo.Z)(this,"currentIndex",0),this.join=k.join||"miter",this.cap=k.cap||"butt",this.miterLimit=k.miterLimit||10,this.thickness=k.thickness||1,this.dash=k.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,D.Z)(M,[{key:"extrude_gaode2",value:function(L,K){var ie=this.complex;if(L.length<=1)return ie;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ne=L.length,nt=ie.startIndex,rt=1;rt<ne;rt++){var jt,ct,Yt,ar=L[rt-1];ar.push((jt=K[rt-1][2])!==null&&jt!==void 0?jt:0);var fn=K[rt-1],on=L[rt];on.push((ct=K[rt][2])!==null&&ct!==void 0?ct:0);var Kr=K[rt],Gn=rt<L.length-1?[].concat((0,_r.Z)(L[rt+1]),[(Yt=K[rt+1][2])!==null&&Yt!==void 0?Yt:0]):null,Zn=rt<K.length-1?K[rt+1]:null,jn=this.segment_gaode2(ie,nt,ar,on,Gn,fn,Kr,Zn);nt+=jn}if(this.dash)for(var vi=0;vi<ie.positions.length/6;vi++)ie.positions[vi*6+5]=this.totalDistance;return ie.startIndex=ie.positions.length/6,ie}},{key:"simpleExtrude_gaode2",value:function(L,K){var ie=this.complex;if(L.length<=1)return ie;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ne=L.length,nt=ie.startIndex,rt=1;rt<ne;rt++){var jt,ct,Yt,ar=L[rt-1];ar.push((jt=K[rt-1][2])!==null&&jt!==void 0?jt:0);var fn=K[rt-1],on=L[rt];on.push((ct=K[rt][2])!==null&&ct!==void 0?ct:0);var Kr=K[rt],Gn=rt<L.length-1?[].concat((0,_r.Z)(L[rt+1]),[(Yt=K[rt+1][2])!==null&&Yt!==void 0?Yt:0]):null,Zn=rt<K.length-1?K[rt+1]:null,jn=this.simpleSegment(ie,nt,ar,on,Gn,fn,Kr,Zn);nt+=jn}if(this.dash)for(var vi=0;vi<ie.positions.length/6;vi++)ie.positions[vi*6+5]=this.totalDistance;return ie.startIndex=ie.positions.length/6,ie}},{key:"extrude",value:function(L){var K=this.complex;if(L.length<=1)return K;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ie=L.length,ne=K.startIndex,nt=1;nt<ie;nt++){var rt=L[nt-1],jt=L[nt],ct=nt<L.length-1?L[nt+1]:null,Yt=this.segment(K,ne,rt,jt,ct);ne+=Yt}if(this.dash)for(var ar=0;ar<K.positions.length/6;ar++)K.positions[ar*6+5]=this.totalDistance;return K.startIndex=K.positions.length/6,K}},{key:"simpleExtrude",value:function(L){var K=this.complex;if(L.length<=1)return K;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ie=L.length,ne=K.startIndex,nt=1;nt<ie;nt++){var rt=L[nt-1],jt=L[nt],ct=nt<L.length-1?L[nt+1]:null,Yt=this.simpleSegment(K,ne,rt,jt,ct);ne+=Yt}if(this.dash)for(var ar=0;ar<K.positions.length/6;ar++)K.positions[ar*6+5]=this.totalDistance;return K.startIndex=K.positions.length/6,K}},{key:"segment_gaode2",value:function(L,K,ie,ne,nt,rt,jt,ct){var Yt=0,ar=L.indices,fn=L.positions,on=L.normals,Kr=this.cap==="square",Gn=this.join==="bevel",Zn=is([jt[0],jt[1]]),jn=is([rt[0],rt[1]]);Hl(To,ne,ie);var vi=0;if(this.dash&&(vi=this.lineSegmentDistance(Zn,jn),this.totalDistance+=vi),this.normal||(this.normal=Ui.Ue(),gu(this.normal,To)),!this.started)if(this.started=!0,Kr){var Si=Ui.Ue(),Oi=Ui.Ue();Ui.IH(Si,this.normal,To),Ui.IH(Oi,this.normal,To),on.push(Oi[0],Oi[1],0),on.push(Si[0],Si[1],0),fn.push(ie[0],ie[1],ie[2]|0,this.totalDistance-vi,-this.thickness,ie[2]|0),this.complex.indexes.push(this.currentIndex),fn.push(ie[0],ie[1],ie[2]|0,this.totalDistance-vi,this.thickness,ie[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(fn,on,ie,this.normal,this.thickness,this.totalDistance-vi);if(ar.push(K+0,K+1,K+2),nt){l(ne,nt)&&Ui.IH(nt,ne,Ui.Fv(nt,Ui.$X(nt,ne,ie))),Hl(ho,nt,ne);var go=$l(Yu,Ui.Ue(),To,ho,this.thickness),Ea=(0,kt.Z)(go,2),qi=Ea[0],Sa=Ea[1],Zo=Ui.AK(Yu,this.normal)<0?-1:1,ss=Gn;if(!ss&&this.join==="miter"){var Fo=qi;Fo>this.miterLimit&&(ss=!0)}ss?(on.push(this.normal[0],this.normal[1],0),on.push(Sa[0],Sa[1],0),fn.push(ne[0],ne[1],ne[2]|0,this.totalDistance,-this.thickness*Zo,ne[2]|0),this.complex.indexes.push(this.currentIndex),fn.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness*Zo,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,ar.push.apply(ar,(0,_r.Z)(this.lastFlip!==-Zo?[K,K+2,K+3]:[K+2,K+1,K+3])),ar.push(K+2,K+3,K+4),gu(mu,ho),Ui.JG(this.normal,mu),on.push(this.normal[0],this.normal[1],0),fn.push(ne[0],ne[1],ne[2]|0,this.totalDistance,-this.thickness*Zo,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,Yt+=3):(this.extrusions(fn,on,ne,Sa,qi,this.totalDistance),ar.push.apply(ar,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),Zo=-1,Ui.JG(this.normal,Sa),Yt+=2),this.lastFlip=Zo}else{if(gu(this.normal,To),Kr){var Ba=Ui.Ue(),Ha=Ui.Ue();Ui.lu(Ha,To,this.normal),Ui.IH(Ba,To,this.normal),on.push(Ha[0],Ha[1],0),on.push(Ba[0],Ba[1],0),fn.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness,ne[2]|0),this.complex.indexes.push(this.currentIndex),fn.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(fn,on,ne,this.normal,this.thickness,this.totalDistance);ar.push.apply(ar,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),Yt+=2}return Yt}},{key:"simpleSegment",value:function(L,K,ie,ne,nt){var rt=0,jt=L.indices,ct=L.positions,Yt=L.normals,ar=is([ne[0],ne[1]]),fn=is([ie[0],ie[1]]);Hl(To,ar,fn);var on=0;if(this.dash&&(on=this.lineSegmentDistance(ar,fn),this.totalDistance+=on),this.normal||(this.normal=Ui.Ue(),gu(this.normal,To)),this.started||(this.started=!0,this.extrusions(ct,Yt,ie,this.normal,this.thickness,this.totalDistance-on)),jt.push(K+0,K+1,K+2),!nt)gu(this.normal,To),this.extrusions(ct,Yt,ne,this.normal,this.thickness,this.totalDistance),jt.push.apply(jt,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),rt+=2;else{var Kr=is([nt[0],nt[1]]);l(ar,Kr)&&Ui.IH(Kr,ar,Ui.Fv(Kr,Ui.$X(Kr,ar,fn))),Hl(ho,Kr,ar);var Gn=$l(Yu,Ui.Ue(),To,ho,this.thickness),Zn=(0,kt.Z)(Gn,2),jn=Zn[0],vi=Zn[1],Si=Ui.AK(Yu,this.normal)<0?-1:1;this.extrusions(ct,Yt,ne,vi,jn,this.totalDistance),jt.push.apply(jt,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),Si=-1,Ui.JG(this.normal,vi),rt+=2,this.lastFlip=Si}return rt}},{key:"segment",value:function(L,K,ie,ne,nt){var rt=0,jt=L.indices,ct=L.positions,Yt=L.normals,ar=this.cap==="square",fn=this.join==="bevel",on=is([ne[0],ne[1]]),Kr=is([ie[0],ie[1]]);Hl(To,on,Kr);var Gn=0;if(this.dash&&(Gn=this.lineSegmentDistance(on,Kr),this.totalDistance+=Gn),this.normal||(this.normal=Ui.Ue(),gu(this.normal,To)),!this.started)if(this.started=!0,ar){var Zn=Ui.Ue(),jn=Ui.Ue();Ui.IH(Zn,this.normal,To),Ui.IH(jn,this.normal,To),Yt.push(jn[0],jn[1],0),Yt.push(Zn[0],Zn[1],0),ct.push(ie[0],ie[1],ie[2]|0,this.totalDistance-Gn,-this.thickness,ie[2]|0),this.complex.indexes.push(this.currentIndex),ct.push(ie[0],ie[1],ie[2]|0,this.totalDistance-Gn,this.thickness,ie[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(ct,Yt,ie,this.normal,this.thickness,this.totalDistance-Gn);if(jt.push(K+0,K+1,K+2),nt){var Oi=is([nt[0],nt[1]]);l(on,Oi)&&Ui.IH(Oi,on,Ui.Fv(Oi,Ui.$X(Oi,on,Kr))),Hl(ho,Oi,on);var Ba=$l(Yu,Ui.Ue(),To,ho,this.thickness),Ha=(0,kt.Z)(Ba,2),go=Ha[0],Ea=Ha[1],qi=Ui.AK(Yu,this.normal)<0?-1:1,Sa=fn;if(!Sa&&this.join==="miter"){var Zo=go;Zo>this.miterLimit&&(Sa=!0)}Sa?(Yt.push(this.normal[0],this.normal[1],0),Yt.push(Ea[0],Ea[1],0),ct.push(ne[0],ne[1],ne[2]|0,this.totalDistance,-this.thickness*qi,ne[2]|0),this.complex.indexes.push(this.currentIndex),ct.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness*qi,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,jt.push.apply(jt,(0,_r.Z)(this.lastFlip!==-qi?[K,K+2,K+3]:[K+2,K+1,K+3])),jt.push(K+2,K+3,K+4),gu(mu,ho),Ui.JG(this.normal,mu),Yt.push(this.normal[0],this.normal[1],0),ct.push(ne[0],ne[1],ne[2]|0,this.totalDistance,-this.thickness*qi,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,rt+=3):(this.extrusions(ct,Yt,ne,Ea,go,this.totalDistance),jt.push.apply(jt,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),qi=-1,Ui.JG(this.normal,Ea),rt+=2),this.lastFlip=qi}else{if(gu(this.normal,To),ar){var vi=Ui.Ue(),Si=Ui.Ue();Ui.lu(Si,To,this.normal),Ui.IH(vi,To,this.normal),Yt.push(Si[0],Si[1],0),Yt.push(vi[0],vi[1],0),ct.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness,ne[2]|0),this.complex.indexes.push(this.currentIndex),ct.push(ne[0],ne[1],ne[2]|0,this.totalDistance,this.thickness,ne[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(ct,Yt,ne,this.normal,this.thickness,this.totalDistance);jt.push.apply(jt,(0,_r.Z)(this.lastFlip===1?[K,K+2,K+3]:[K+2,K+1,K+3])),rt+=2}return rt}},{key:"extrusions",value:function(L,K,ie,ne,nt,rt){K.push(ne[0],ne[1],0),K.push(ne[0],ne[1],0),L.push(ie[0],ie[1],ie[2]|0,rt,-nt,ie[2]|0),this.complex.indexes.push(this.currentIndex),L.push(ie[0],ie[1],ie[2]|0,rt,nt,ie[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(L,K){var ie=K[0]-L[0],ne=K[1]-L[1];return Math.sqrt(ie*ie+ne*ne)}}]),M}();function m(M){var k=M.coordinates,L=M.originCoordinates,K=M.version,ie=new f({dash:!0,join:"bevel"});if(K==="GAODE2.x"){var ne=k;Array.isArray(ne[0][0])||(ne=[k]);var nt=L;Array.isArray(nt[0][0])||(nt=[L]);for(var rt=0;rt<ne.length;rt++){var jt=ne[rt],ct=nt[rt];ie.extrude_gaode2(jt,ct)}}else{var Yt=k;Yt[0]&&!Array.isArray(Yt[0][0])&&(Yt=[k]),Yt.forEach(function(fn){ie.extrude(fn)})}var ar=ie.complex;return{vertices:ar.positions,indices:ar.indices,normals:ar.normals,indexes:ar.indexes,size:6}}function E(M){var k=qc(M.coordinates);return{vertices:[].concat((0,_r.Z)(k),(0,_r.Z)(k),(0,_r.Z)(k),(0,_r.Z)(k)),indices:[0,1,2,2,3,0],size:k.length}}function R(M){var k=M.coordinates,L=_c().flatten(k),K=L.vertices,ie=L.dimensions,ne=L.holes,nt=_c()(K,ne,ie);return{indices:nt,vertices:K,size:ie}}var O=function(){var M=(0,ru.Z)(Ru().mark(function k(L){var K,ie,ne,nt,rt,jt,ct,Yt,ar;return Ru().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return K=L.descriptors,ie=L.features,ne=L.enablePicking,nt=L.iconMap,rt={a_Color:ll,a_Position:El,filter:jl,a_vertexId:cl,a_PickingColor:function(Gn){var Zn=Gn.id;return ne?ur(Zn):[0,0,0]},a_DistanceAndIndex:function(Gn,Zn,jn,vi,Si,Oi){return Oi===void 0?[jn[3],10]:[jn[3],Oi]},a_Total_Distance:function(Gn,Zn,jn){return[jn[5]]},a_Size:function(Gn){var Zn=Gn.size,jn=Zn===void 0?1:Zn;return Array.isArray(jn)?[jn[0],jn[1]]:[jn,0]},a_Normal:function(Gn,Zn,jn,vi,Si){return Si},a_Miter:function(Gn,Zn,jn){return[jn[4]]},a_iconMapUV:function(Gn){var Zn=Gn.texture,jn=nt[Zn]||{x:0,y:0},vi=jn.x,Si=jn.y;return[vi,Si]}},jt={sizePerElement:0,elements:[]},ct=0,Yt=[],ar=3,ie.forEach(function(Kr,Gn){var Zn=m(Kr),jn=Zn.indices,vi=Zn.vertices,Si=Zn.normals,Oi=Zn.size,Ba=Zn.indexes;jn.forEach(function(qi){Yt.push(qi+ct)}),ar=Oi;var Ha=vi.length/Oi;jt.sizePerElement=ar,jt.elements.push({featureIdx:Gn,vertices:vi,normals:Si,offset:ct}),ct+=Ha;for(var go=function(Sa){var Zo=(Si==null?void 0:Si.slice(Sa*3,Sa*3+3))||[],ss=vi.slice(Sa*Oi,Sa*Oi+Oi),Fo=0;Ba&&Ba[Sa]!==void 0&&(Fo=Ba[Sa]),K.forEach(function(Qo){if(Qo&&rt[Qo.name]){var Is;(Is=Qo.buffer.data).push.apply(Is,(0,_r.Z)(rt[Qo.name](Kr,Gn,ss,Sa,Zo,Fo)))}})},Ea=0;Ea<Ha;Ea++)go(Ea)}),on.abrupt("return",{descriptors:K,featureLayout:jt,indices:Yt});case 8:case"end":return on.stop()}},k)}));return function(L){return M.apply(this,arguments)}}(),$=function(){var M=(0,ru.Z)(Ru().mark(function k(L){var K,ie,ne,nt,rt,jt,ct,Yt,ar;return Ru().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return K=L.descriptors,ie=L.features,ne=L.enablePicking,nt=L.shape2d,rt={a_Color:ll,a_Position:El,filter:jl,a_vertexId:cl,a_PickingColor:function(Gn){var Zn=Gn.id;return ne?ur(Zn):[0,0,0]},a_Shape:function(Gn){var Zn=Gn.shape,jn=Zn===void 0?2:Zn,vi=nt.indexOf(jn);return[vi]},a_Extrude:function(Gn,Zn,jn,vi){var Si=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Oi=vi%4*3;return[Si[Oi],Si[Oi+1],Si[Oi+2]]},a_Size:function(Gn){var Zn=Gn.size,jn=Zn===void 0?5:Zn;return Array.isArray(jn)?[jn[0]]:[jn]}},jt={sizePerElement:0,elements:[]},ct=0,Yt=[],ar=3,ie.forEach(function(Kr,Gn){var Zn=E(Kr),jn=Zn.indices,vi=Zn.vertices,Si=Zn.normals,Oi=Zn.size,Ba=Zn.indexes;jn.forEach(function(qi){Yt.push(qi+ct)}),ar=Oi;var Ha=vi.length/Oi;jt.sizePerElement=ar,jt.elements.push({featureIdx:Gn,vertices:vi,normals:Si,offset:ct}),ct+=Ha;for(var go=function(Sa){var Zo=(Si==null?void 0:Si.slice(Sa*3,Sa*3+3))||[],ss=vi.slice(Sa*Oi,Sa*Oi+Oi),Fo=0;Ba&&Ba[Sa]!==void 0&&(Fo=Ba[Sa]),K.forEach(function(Qo){if(Qo&&rt[Qo.name]){var Is;(Is=Qo.buffer.data).push.apply(Is,(0,_r.Z)(rt[Qo.name](Kr,Gn,ss,Sa,Zo,Fo)))}})},Ea=0;Ea<Ha;Ea++)go(Ea)}),on.abrupt("return",{descriptors:K,featureLayout:jt,indices:Yt});case 8:case"end":return on.stop()}},k)}));return function(L){return M.apply(this,arguments)}}(),ge=function(){var M=(0,ru.Z)(Ru().mark(function k(L){var K,ie,ne,nt,rt,jt,ct,Yt;return Ru().wrap(function(fn){for(;;)switch(fn.prev=fn.next){case 0:return K=L.descriptors,ie=L.features,ne=L.enablePicking,nt={a_Color:ll,a_Position:El,filter:jl,a_vertexId:cl,a_PickingColor:function(Kr){var Gn=Kr.id;return ne?ur(Gn):[0,0,0]}},rt={sizePerElement:0,elements:[]},jt=0,ct=[],Yt=3,ie.forEach(function(on,Kr){var Gn=R(on),Zn=Gn.indices,jn=Gn.vertices,vi=Gn.normals,Si=Gn.size,Oi=Gn.indexes;Zn.forEach(function(Ea){ct.push(Ea+jt)}),Yt=Si;var Ba=jn.length/Si;rt.sizePerElement=Yt,rt.elements.push({featureIdx:Kr,vertices:jn,normals:vi,offset:jt}),jt+=Ba;for(var Ha=function(qi){var Sa=(vi==null?void 0:vi.slice(qi*3,qi*3+3))||[],Zo=jn.slice(qi*Si,qi*Si+Si),ss=0;Oi&&Oi[qi]!==void 0&&(ss=Oi[qi]),K.forEach(function(Fo){if(Fo&&nt[Fo.name]){var Qo;(Qo=Fo.buffer.data).push.apply(Qo,(0,_r.Z)(nt[Fo.name](on,Kr,Zo,qi,Sa,ss)))}})},go=0;go<Ba;go++)Ha(go)}),fn.abrupt("return",{descriptors:K,featureLayout:rt,indices:ct});case 8:case"end":return fn.stop()}},k)}));return function(L){return M.apply(this,arguments)}}(),Me={pointFill:$,line:O,polygonFill:ge},Ye=(0,h.Z)({},Me);function tt(M){return ot.apply(this,arguments)}function ot(){return ot=_asyncToGenerator(_regeneratorRuntime.mark(function M(k){var L,K;return _regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(L=k.workerType,K=k.data,!Ye[L]){ne.next=3;break}return ne.abrupt("return",Ye[L](K));case 3:return ne.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(L,'" non-existent.'))));case 4:case"end":return ne.stop()}},M)})),ot.apply(this,arguments)}var At=new Map;function St(M,k){At.set(M,k)}function Zt(M){var k=At.get(M);return k}var _t="l7-worker",Vt=3,er=!0;function cr(M){registerWorkerSource(_t,M)}function Rr(){var M=getWorkerSource(_t);if(!M)throw new Error("get worker failed by workerName: ".concat(_t,"."));return M}function Er(M,k){return Br.apply(this,arguments)}function Br(){return Br=_asyncToGenerator(_regeneratorRuntime.mark(function M(k,L){var K,ie,ne,nt,rt;return _regeneratorRuntime.wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:return K=Rr(),ie=WorkerFarm.getWorkerFarm({maxConcurrency:Vt,reuseWorkers:er}),ne=ie.getWorkerPool({name:_t,source:K}),ct.next=5,ne.startJob(_t,function(Yt,ar,fn){return Yt.done(fn)});case 5:return nt=ct.sent,nt.postMessage("process",{input:{workerType:k,data:L}}),ct.next=9,nt.result;case 9:return rt=ct.sent,ct.abrupt("return",rt.result);case 11:case"end":return ct.stop()}},M)})),Br.apply(this,arguments)}function tn(M,k){return M==null?k:M}},94221:function(He,w,x){"use strict";x.d(w,{oT:function(){return pu},Ie:function(){return Mm},dW:function(){return Pm},GI:function(){return D1},xs:function(){return OE}});var F={},z={},h=function(r){return z[r]},D=function(r,n){z[r]=n},P=function(r){return F[r]},X=function(r,n){F[r]=n},W={},fe={},J=34,Be=10,B=13;function ee(e){return new Function("d","return {"+e.map(function(r,n){return JSON.stringify(r)+": d["+n+'] || ""'}).join(",")+"}")}function U(e,r){var n=ee(e);return function(i,a){return r(n(i),a,e)}}function q(e){var r=Object.create(null),n=[];return e.forEach(function(i){for(var a in i)a in r||n.push(r[a]=a)}),n}function le(e,r){var n=e+"",i=n.length;return i<r?new Array(r-i+1).join(0)+n:n}function j(e){return e<0?"-"+le(-e,6):e>9999?"+"+le(e,6):le(e,4)}function Ce(e){var r=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":j(e.getUTCFullYear(),4)+"-"+le(e.getUTCMonth()+1,2)+"-"+le(e.getUTCDate(),2)+(a?"T"+le(r,2)+":"+le(n,2)+":"+le(i,2)+"."+le(a,3)+"Z":i?"T"+le(r,2)+":"+le(n,2)+":"+le(i,2)+"Z":n||r?"T"+le(r,2)+":"+le(n,2)+"Z":"")}function $e(e){var r=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(C,N){var ae,we,De=a(C,function(at,Ot){if(ae)return ae(at,Ot-1);we=at,ae=N?U(at,N):ee(at)});return De.columns=we||[],De}function a(C,N){var ae=[],we=C.length,De=0,at=0,Ot,Pt=we<=0,Kt=!1;C.charCodeAt(we-1)===Be&&--we,C.charCodeAt(we-1)===B&&--we;function hr(){if(Pt)return fe;if(Kt)return Kt=!1,W;var pr,rr=De,Ur;if(C.charCodeAt(rr)===J){for(;De++<we&&C.charCodeAt(De)!==J||C.charCodeAt(++De)===J;);return(pr=De)>=we?Pt=!0:(Ur=C.charCodeAt(De++))===Be?Kt=!0:Ur===B&&(Kt=!0,C.charCodeAt(De)===Be&&++De),C.slice(rr+1,pr-1).replace(/""/g,'"')}for(;De<we;){if((Ur=C.charCodeAt(pr=De++))===Be)Kt=!0;else if(Ur===B)Kt=!0,C.charCodeAt(De)===Be&&++De;else if(Ur!==n)continue;return C.slice(rr,pr)}return Pt=!0,C.slice(rr,we)}for(;(Ot=hr())!==fe;){for(var jr=[];Ot!==W&&Ot!==fe;)jr.push(Ot),Ot=hr();N&&(jr=N(jr,at++))==null||ae.push(jr)}return ae}function s(C,N){return C.map(function(ae){return N.map(function(we){return A(ae[we])}).join(e)})}function c(C,N){return N==null&&(N=q(C)),[N.map(A).join(e)].concat(s(C,N)).join(`
`)}function d(C,N){return N==null&&(N=q(C)),s(C,N).join(`
`)}function g(C){return C.map(_).join(`
`)}function _(C){return C.map(A).join(e)}function A(C){return C==null?"":C instanceof Date?Ce(C):r.test(C+="")?'"'+C.replace(/"/g,'""')+'"':C}return{parse:i,parseRows:a,format:c,formatBody:d,formatRows:g,formatRow:_,formatValue:A}}var Fe=$e(","),lt=Fe.parse,We=Fe.parseRows,Ze=Fe.format,pe=Fe.formatBody,se=Fe.formatRows,be=Fe.formatRow,Te=Fe.formatValue,de=x(1413),Rt=x(1449);function ye(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ve(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function oe(e){if(e.length>1&&isNumber(e[0])&&isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return oe(e[0]);throw new Error("coordinates must only contain numbers")}function Re(e,r,n){if(!r||!n)throw new Error("type and name required");if(!e||e.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+e.type)}function Se(e,r,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+e.geometry.type)}function et(e,r,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0,a=e.features;i<a.length;i++){var s=a[i];if(!s||s.type!=="Feature"||!s.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!s.geometry||s.geometry.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+s.geometry.type)}}function st(e){return e.type==="Feature"?e.geometry:e}function pt(e,r){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}var bt=x(39034),ke=x(57059),ur=x(38163),qt=x.n(ur);function _n(e,r){return e.map(function(n){return n[r]*1})}function Zr(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function Vr(e){return Array.isArray(e)?e.length===0?!1:!!Zr(e[0]):!1}function rn(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Qr(e){var r=Object.isFrozen(e)?ke.rU.cloneDeep(e):e;return qt()(r,!0),r}function ln(e,r){var n=r.x,i=r.y,a=r.x1,s=r.y1,c=r.coordinates,d=r.geometry,g=[];if(!Array.isArray(e))return{dataArray:[]};if(d)return e.filter(function(Ot){return Ot[d]&&Ot[d].type&&Ot[d].coordinates&&Ot[d].coordinates.length>0}).forEach(function(Ot,Pt){var Kt=Qr(Ot[d]);(0,bt.nG)(Kt,function(hr){var jr=Ve(hr),pr=(0,de.Z)((0,de.Z)({},Ot),{},{_id:Pt,coordinates:jr});g.push(pr)})}),{dataArray:g};for(var _=0;_<e.length;_++){var A=e[_],C=[];if(c){var N="Polygon";Array.isArray(c[0])||(N="Point"),Array.isArray(c[0])&&!Array.isArray(c[0][0])&&(N="LineString");var ae=Qr({type:N,coordinates:A[c]});C=ae.coordinates}else if(n&&i&&a&&s){var we=[parseFloat(A[n]),parseFloat(A[i])],De=[parseFloat(A[a]),parseFloat(A[s])];C=[we,De]}else n&&i&&(C=[parseFloat(A[n]),parseFloat(A[i])]);var at=(0,de.Z)((0,de.Z)({},A),{},{_id:_,coordinates:C});g.push(at)}return{dataArray:g}}function vn(e,r){var n=lt(e);return ln(n,r)}function $t(e){for(var r=e.toString(),n=5381,i=r.length;i;)n=n*33^r.charCodeAt(--i);return n>>>0}function _r(e,r){return r===void 0?null:typeof(e.properties[r]*1)=="number"?e.properties[r]*1:e.properties&&e.properties[r]?$t(e.properties[r]+"")%1000019:null}function kt(e,r){var n=[],i={};return e.features?(e.features=e.features.filter(function(a){var s=a.geometry;return a!=null&&s&&s.type&&s.coordinates&&s.coordinates.length>0}),e=Qr(e),e.features.length===0?{dataArray:[],featureKeys:i}:((0,bt.nG)(e,function(a,s){var c=_r(a,r==null?void 0:r.featureId);c===null&&(c=s);var d=c,g=Ve(a),_=(0,de.Z)((0,de.Z)({},a.properties),{},{coordinates:g,_id:d});n.push(_)}),{dataArray:n,featureKeys:i})):(e.features=[],{dataArray:[]})}var qe=x(15861),Sr=x(64687),Pe=x.n(Sr);function Hr(e,r,n,i){for(var a=i,s=n-r>>1,c=n-r,d,g=e[r],_=e[r+1],A=e[n],C=e[n+1],N=r+3;N<n;N+=3){var ae=vr(e[N],e[N+1],g,_,A,C);if(ae>a)d=N,a=ae;else if(ae===a){var we=Math.abs(N-s);we<c&&(d=N,c=we)}}a>i&&(d-r>3&&Hr(e,r,d,i),e[d+2]=a,n-d>3&&Hr(e,d,n,i))}function vr(e,r,n,i,a,s){var c=a-n,d=s-i;if(c!==0||d!==0){var g=((e-n)*c+(r-i)*d)/(c*c+d*d);g>1?(n=a,i=s):g>0&&(n+=c*g,i+=d*g)}return c=e-n,d=r-i,c*c+d*d}function Ie(e,r,n,i){var a={id:typeof e=="undefined"?null:e,type:r,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return gr(a),a}function gr(e){var r=e.geometry,n=e.type;if(n==="Point"||n==="MultiPoint"||n==="LineString")Wr(e,r);else if(n==="Polygon"||n==="MultiLineString")for(var i=0;i<r.length;i++)Wr(e,r[i]);else if(n==="MultiPolygon")for(i=0;i<r.length;i++)for(var a=0;a<r[i].length;a++)Wr(e,r[i][a])}function Wr(e,r){for(var n=0;n<r.length;n+=3)e.minX=Math.min(e.minX,r[n]),e.minY=Math.min(e.minY,r[n+1]),e.maxX=Math.max(e.maxX,r[n]),e.maxY=Math.max(e.maxY,r[n+1])}function Dr(e,r){var n=[];if(e.type==="FeatureCollection")for(var i=0;i<e.features.length;i++)Xr(n,e.features[i],r,i);else e.type==="Feature"?Xr(n,e,r):Xr(n,{geometry:e},r);return n}function Xr(e,r,n,i){if(r.geometry){var a=r.geometry.coordinates,s=r.geometry.type,c=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),d=[],g=r.id;if(n.promoteId?g=r.properties[n.promoteId]:n.generateId&&(g=i||0),s==="Point")Vn(a,d);else if(s==="MultiPoint")for(var _=0;_<a.length;_++)Vn(a[_],d);else if(s==="LineString")ni(a,d,c,!1);else if(s==="MultiLineString")if(n.lineMetrics){for(_=0;_<a.length;_++)d=[],ni(a[_],d,c,!1),e.push(Ie(g,"LineString",d,r.properties));return}else Dn(a,d,c,!1);else if(s==="Polygon")Dn(a,d,c,!0);else if(s==="MultiPolygon")for(_=0;_<a.length;_++){var A=[];Dn(a[_],A,c,!0),d.push(A)}else if(s==="GeometryCollection"){for(_=0;_<r.geometry.geometries.length;_++)Xr(e,{id:g,geometry:r.geometry.geometries[_],properties:r.properties},n,i);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Ie(g,s,d,r.properties))}}function Vn(e,r){r.push(Jn(e[0])),r.push(Yi(e[1])),r.push(0)}function ni(e,r,n,i){for(var a,s,c=0,d=0;d<e.length;d++){var g=Jn(e[d][0]),_=Yi(e[d][1]);r.push(g),r.push(_),r.push(0),d>0&&(i?c+=(a*_-g*s)/2:c+=Math.sqrt(Math.pow(g-a,2)+Math.pow(_-s,2))),a=g,s=_}var A=r.length-3;r[2]=1,Hr(r,0,A,n),r[A+2]=1,r.size=Math.abs(c),r.start=0,r.end=r.size}function Dn(e,r,n,i){for(var a=0;a<e.length;a++){var s=[];ni(e[a],s,n,i),r.push(s)}}function Jn(e){return e/360+.5}function Yi(e){var r=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return n<0?0:n>1?1:n}function bi(e,r,n,i,a,s,c,d){if(n/=r,i/=r,s>=n&&c<i)return e;if(c<n||s>=i)return null;for(var g=[],_=0;_<e.length;_++){var A=e[_],C=A.geometry,N=A.type,ae=a===0?A.minX:A.minY,we=a===0?A.maxX:A.maxY;if(ae>=n&&we<i){g.push(A);continue}else if(we<n||ae>=i)continue;var De=[];if(N==="Point"||N==="MultiPoint")ui(C,De,n,i,a);else if(N==="LineString")pi(C,De,n,i,a,!1,d.lineMetrics);else if(N==="MultiLineString")V(C,De,n,i,a,!1);else if(N==="Polygon")V(C,De,n,i,a,!0);else if(N==="MultiPolygon")for(var at=0;at<C.length;at++){var Ot=[];V(C[at],Ot,n,i,a,!0),Ot.length&&De.push(Ot)}if(De.length){if(d.lineMetrics&&N==="LineString"){for(at=0;at<De.length;at++)g.push(Ie(A.id,N,De[at],A.tags));continue}(N==="LineString"||N==="MultiLineString")&&(De.length===1?(N="LineString",De=De[0]):N="MultiLineString"),(N==="Point"||N==="MultiPoint")&&(N=De.length===3?"Point":"MultiPoint"),g.push(Ie(A.id,N,De,A.tags))}}return g.length?g:null}function ui(e,r,n,i,a){for(var s=0;s<e.length;s+=3){var c=e[s+a];c>=n&&c<=i&&(r.push(e[s]),r.push(e[s+1]),r.push(e[s+2]))}}function pi(e,r,n,i,a,s,c){for(var d=it(e),g=a===0?Ee:Le,_=e.start,A,C,N=0;N<e.length-3;N+=3){var ae=e[N],we=e[N+1],De=e[N+2],at=e[N+3],Ot=e[N+4],Pt=a===0?ae:we,Kt=a===0?at:Ot,hr=!1;c&&(A=Math.sqrt(Math.pow(ae-at,2)+Math.pow(we-Ot,2))),Pt<n?Kt>n&&(C=g(d,ae,we,at,Ot,n),c&&(d.start=_+A*C)):Pt>i?Kt<i&&(C=g(d,ae,we,at,Ot,i),c&&(d.start=_+A*C)):H(d,ae,we,De),Kt<n&&Pt>=n&&(C=g(d,ae,we,at,Ot,n),hr=!0),Kt>i&&Pt<=i&&(C=g(d,ae,we,at,Ot,i),hr=!0),!s&&hr&&(c&&(d.end=_+A*C),r.push(d),d=it(e)),c&&(_+=A)}var jr=e.length-3;ae=e[jr],we=e[jr+1],De=e[jr+2],Pt=a===0?ae:we,Pt>=n&&Pt<=i&&H(d,ae,we,De),jr=d.length-3,s&&jr>=3&&(d[jr]!==d[0]||d[jr+1]!==d[1])&&H(d,d[0],d[1],d[2]),d.length&&r.push(d)}function it(e){var r=[];return r.size=e.size,r.start=e.start,r.end=e.end,r}function V(e,r,n,i,a,s){for(var c=0;c<e.length;c++)pi(e[c],r,n,i,a,s,!1)}function H(e,r,n,i){e.push(r),e.push(n),e.push(i)}function Ee(e,r,n,i,a,s){var c=(s-r)/(i-r);return e.push(s),e.push(n+(a-n)*c),e.push(1),c}function Le(e,r,n,i,a,s){var c=(s-n)/(a-n);return e.push(r+(i-r)*c),e.push(s),e.push(1),c}function ze(e,r){var n=r.buffer/r.extent,i=e,a=bi(e,1,-1-n,n,0,-1,2,r),s=bi(e,1,1-n,2+n,0,-1,2,r);return(a||s)&&(i=bi(e,1,-n,1+n,0,-1,2,r)||[],a&&(i=xt(a,1).concat(i)),s&&(i=i.concat(xt(s,-1)))),i}function xt(e,r){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,c;if(s==="Point"||s==="MultiPoint"||s==="LineString")c=Ut(a.geometry,r);else if(s==="MultiLineString"||s==="Polygon"){c=[];for(var d=0;d<a.geometry.length;d++)c.push(Ut(a.geometry[d],r))}else if(s==="MultiPolygon")for(c=[],d=0;d<a.geometry.length;d++){for(var g=[],_=0;_<a.geometry[d].length;_++)g.push(Ut(a.geometry[d][_],r));c.push(g)}n.push(Ie(a.id,s,c,a.tags))}return n}function Ut(e,r){var n=[];n.size=e.size,e.start!==void 0&&(n.start=e.start,n.end=e.end);for(var i=0;i<e.length;i+=3)n.push(e[i]+r,e[i+1],e[i+2]);return n}function ir(e,r){if(e.transformed)return e;var n=1<<e.z,i=e.x,a=e.y,s,c,d;for(s=0;s<e.features.length;s++){var g=e.features[s],_=g.geometry,A=g.type;if(g.geometry=[],A===1)for(c=0;c<_.length;c+=2)g.geometry.push(Ft(_[c],_[c+1],r,n,i,a));else for(c=0;c<_.length;c++){var C=[];for(d=0;d<_[c].length;d+=2)C.push(Ft(_[c][d],_[c][d+1],r,n,i,a));g.geometry.push(C)}}return e.transformed=!0,e}function Ft(e,r,n,i,a,s){return[Math.round(n*(e*i-a)),Math.round(n*(r*i-s))]}function te(e,r,n,i,a){for(var s=r===a.maxZoom?0:a.tolerance/((1<<r)*a.extent),c={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:r,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},d=0;d<e.length;d++){c.numFeatures++,Q(c,e[d],s,a);var g=e[d].minX,_=e[d].minY,A=e[d].maxX,C=e[d].maxY;g<c.minX&&(c.minX=g),_<c.minY&&(c.minY=_),A>c.maxX&&(c.maxX=A),C>c.maxY&&(c.maxY=C)}return c}function Q(e,r,n,i){var a=r.geometry,s=r.type,c=[];if(s==="Point"||s==="MultiPoint")for(var d=0;d<a.length;d+=3)c.push(a[d]),c.push(a[d+1]),e.numPoints++,e.numSimplified++;else if(s==="LineString")ve(c,a,e,n,!1,!1);else if(s==="MultiLineString"||s==="Polygon")for(d=0;d<a.length;d++)ve(c,a[d],e,n,s==="Polygon",d===0);else if(s==="MultiPolygon")for(var g=0;g<a.length;g++){var _=a[g];for(d=0;d<_.length;d++)ve(c,_[d],e,n,!0,d===0)}if(c.length){var A=r.tags||null;if(s==="LineString"&&i.lineMetrics){A={};for(var C in r.tags)A[C]=r.tags[C];A.mapbox_clip_start=a.start/a.size,A.mapbox_clip_end=a.end/a.size}var N={geometry:c,type:s==="Polygon"||s==="MultiPolygon"?3:s==="LineString"||s==="MultiLineString"?2:1,tags:A};r.id!==null&&(N.id=r.id),e.features.push(N)}}function ve(e,r,n,i,a,s){var c=i*i;if(i>0&&r.size<(a?c:i)){n.numPoints+=r.length/3;return}for(var d=[],g=0;g<r.length;g+=3)(i===0||r[g+2]>c)&&(n.numSimplified++,d.push(r[g]),d.push(r[g+1])),n.numPoints++;a&&Oe(d,s),e.push(d)}function Oe(e,r){for(var n=0,i=0,a=e.length,s=a-2;i<a;s=i,i+=2)n+=(e[i]-e[s])*(e[i+1]+e[s+1]);if(n>0===r)for(i=0,a=e.length;i<a/2;i+=2){var c=e[i],d=e[i+1];e[i]=e[a-2-i],e[i+1]=e[a-1-i],e[a-2-i]=c,e[a-1-i]=d}}function Xe(e,r){return new ft(e,r)}function ft(e,r){r=this.options=Ne(Object.create(this.options),r);var n=r.debug;if(n&&console.time("preprocess data"),r.maxZoom<0||r.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(r.promoteId&&r.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=Dr(e,r);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",r.indexMaxZoom,r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=ze(i,r),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}ft.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ft.prototype.splitTile=function(e,r,n,i,a,s,c){for(var d=[e,r,n,i],g=this.options,_=g.debug;d.length;){i=d.pop(),n=d.pop(),r=d.pop(),e=d.pop();var A=1<<r,C=Et(r,n,i),N=this.tiles[C];if(!N&&(_>1&&console.time("creation"),N=this.tiles[C]=te(e,r,n,i,g),this.tileCoords.push({z:r,x:n,y:i}),_)){_>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",r,n,i,N.numFeatures,N.numPoints,N.numSimplified),console.timeEnd("creation"));var ae="z"+r;this.stats[ae]=(this.stats[ae]||0)+1,this.total++}if(N.source=e,a){if(r===g.maxZoom||r===a)continue;var we=1<<a-r;if(n!==Math.floor(s/we)||i!==Math.floor(c/we))continue}else if(r===g.indexMaxZoom||N.numPoints<=g.indexMaxPoints)continue;if(N.source=null,e.length!==0){_>1&&console.time("clipping");var De=.5*g.buffer/g.extent,at=.5-De,Ot=.5+De,Pt=1+De,Kt,hr,jr,pr,rr,Ur;Kt=hr=jr=pr=null,rr=bi(e,A,n-De,n+Ot,0,N.minX,N.maxX,g),Ur=bi(e,A,n+at,n+Pt,0,N.minX,N.maxX,g),e=null,rr&&(Kt=bi(rr,A,i-De,i+Ot,1,N.minY,N.maxY,g),hr=bi(rr,A,i+at,i+Pt,1,N.minY,N.maxY,g),rr=null),Ur&&(jr=bi(Ur,A,i-De,i+Ot,1,N.minY,N.maxY,g),pr=bi(Ur,A,i+at,i+Pt,1,N.minY,N.maxY,g),Ur=null),_>1&&console.timeEnd("clipping"),d.push(Kt||[],r+1,n*2,i*2),d.push(hr||[],r+1,n*2,i*2+1),d.push(jr||[],r+1,n*2+1,i*2),d.push(pr||[],r+1,n*2+1,i*2+1)}}},ft.prototype.getTile=function(e,r,n){var i=this.options,a=i.extent,s=i.debug;if(e<0||e>24)return null;var c=1<<e;r=(r%c+c)%c;var d=Et(e,r,n);if(this.tiles[d])return ir(this.tiles[d],a);s>1&&console.log("drilling down to z%d-%d-%d",e,r,n);for(var g=e,_=r,A=n,C;!C&&g>0;)g--,_=Math.floor(_/2),A=Math.floor(A/2),C=this.tiles[Et(g,_,A)];return!C||!C.source?null:(s>1&&console.log("found parent tile z%d-%d-%d",g,_,A),s>1&&console.time("drilling down"),this.splitTile(C.source,g,_,A,e,r,n),s>1&&console.timeEnd("drilling down"),this.tiles[d]?ir(this.tiles[d],a):null)};function Et(e,r,n){return((1<<e)*n+r)*32+e}function Ne(e,r){for(var n in r)e[n]=r[n];return e}var Ue=x(15671),vt=x(43144),ue=x(4942),Lr=function(){function e(r,n,i,a){(0,Ue.Z)(this,e),(0,ue.Z)(this,"vectorLayerCache",{}),this.x=n,this.y=i,this.z=a,this.vectorTile=r}return(0,vt.Z)(e,[{key:"getTileData",value:function(n){if(!n||!this.vectorTile.layers[n])return[];if(this.vectorLayerCache[n])return this.vectorLayerCache[n];var i=this.vectorTile.layers[n];return i.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),lr={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function $r(e){for(var r=0,n=0,i=e.length,a=i-1,s,c;n<i;a=n++)s=e[n],c=e[a],r+=(c.x-s.x)*(s.y+c.y);return r}function Rn(e){var r=e.length;if(r<=1)return[e];for(var n=[],i,a,s=0;s<r;s++){var c=$r(e[s]);c!==0&&(a===void 0&&(a=c<0),a===c<0?(i&&n.push(i),i=[e[s]]):i.push(e[s]))}return i&&n.push(i),n}var nn=["Unknown","Point","LineString","Polygon"];function xr(e,r,n,i,a){var s=a.geometry,c=a.type,d=a.tags,g=a.id,_=e*Math.pow(2,i),A=e*r,C=e*n,N=nn[c],ae,we;function De(Pt){for(var Kt=0;Kt<Pt.length;Kt++){var hr=Pt[Kt];if(hr[3])break;var jr=180-(hr[1]+C)*360/_,pr=(hr[0]+A)*360/_-180,rr=360/Math.PI*Math.atan(Math.exp(jr*Math.PI/180))-90;Pt[Kt]=[pr,rr,0,1]}}switch(c){case 1:var at=[];for(ae=0;ae<s.length;ae++)at[ae]=s[ae][0];s=at,De(s);break;case 2:for(ae=0;ae<s.length;ae++)De(s[ae]);break;case 3:for(s=Rn(s),ae=0;ae<s.length;ae++)for(we=0;we<s[ae].length;we++)De(s[ae][we]);break}s.length===1?s=s[0]:N="Multi"+N;var Ot={type:"Feature",geometry:{type:N,coordinates:s},properties:d,id:g,tileOrigin:[0,0],coord:""};return Ot}var Or=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(g){var _=i.getTile(n.z,n.x,n.y),A=_?_.features.map(function(ae){return xr(s,a.x,a.y,a.z,ae)}):[],C={layers:{defaultLayer:{features:A}}},N=new Lr(C,n.x,n.y,n.z);g(N)}));case 1:case"end":return d.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}();function sn(e){var r={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?r:(0,de.Z)((0,de.Z)({},r),e.geojsonvtOptions)}function xn(e,r){var n=sn(r),i=n.extent||4096,a=Xe(e,n),s=function(g,_){return Or(_,a,g,i)},c=(0,de.Z)((0,de.Z)((0,de.Z)({},lr),r),{},{getTileData:s});return{data:e,dataArray:[],tilesetOptions:c,isTile:!0}}function wi(e,r){var n=r.extent,i=n===void 0?[121.168,30.2828,121.384,30.4219]:n,a=r.requestParameters,s=a===void 0?{}:a,c=new Promise(function(g){e instanceof HTMLImageElement||(0,ke.fg)(e)?g([e]):Nn(e,s,function(_){g(_)})}),d={originData:e,images:c,_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]};return d}function Nn(e,r,n){var i=[];if(typeof e=="string")(0,ke.gJ)((0,de.Z)((0,de.Z)({},r),{},{url:e}),function(c,d){d&&(i.push(d),n(i))});else{var a=e.length,s=0;e.forEach(function(c){(0,ke.gJ)((0,de.Z)((0,de.Z)({},r),{},{url:c}),function(d,g){s++,g&&i.push(g),s===a&&n(i)})})}return wi}var Bi=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s){var c,d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return c={x:i.x,y:i.y,z:i.z},d=(0,ke.z0)(n,c),_.abrupt("return",new Promise(function(A){s?s(c,function(C,N){if(C||!N){var ae={layers:{defaultLayer:{features:[]}}},we=new Lr(ae,i.x,i.y,i.z);A(we)}else{var De={layers:{defaultLayer:{features:N.features}}},at=new Lr(De,i.x,i.y,i.z);A(at)}}):(0,ke.Yu)((0,de.Z)((0,de.Z)({},a),{},{url:d}),function(C,N){if(C||!N){var ae={layers:{defaultLayer:{features:[]}}},we=new Lr(ae,i.x,i.y,i.z);A(we)}else{var De=JSON.parse(N),at={layers:{defaultLayer:{features:De}}},Ot=new Lr(at,i.x,i.y,i.z);A(Ot)}})}));case 3:case"end":return _.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}();function sa(e,r){var n=function(s,c){return Bi(e,c,r==null?void 0:r.requestParameters,r.getCustomData)},i=(0,de.Z)((0,de.Z)({},r),{},{getTileData:n});return{dataArray:[],tilesetOptions:i,isTile:!0}}var Fi=x(38929),bn=x(3614),ei=x.n(bn),ga=function(){function e(r,n,i,a){(0,Ue.Z)(this,e),(0,ue.Z)(this,"vectorLayerCache",{}),this.x=n,this.y=i,this.z=a,this.vectorTile=new Fi.VectorTile(new(ei())(r))}return(0,vt.Z)(e,[{key:"getTileData",value:function(n){if(!n||!this.vectorTile.layers[n])return[];if(this.vectorLayerCache[n])return this.vectorLayerCache[n];var i=this.vectorTile.layers[n];if(Array.isArray(i.features))return this.vectorLayerCache[n]=i.features,i.features;for(var a=[],s=0;s<i.length;s++){var c=i.feature(s),d=c.toGeoJSON(this.x,this.y,this.z);a.push((0,de.Z)((0,de.Z)({},d),{},{properties:(0,de.Z)({id:d.id},d.properties)}))}return this.vectorLayerCache[n]=a,a}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),ua={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},no=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s,c){var d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=(0,ke.z0)(n,i),_.abrupt("return",new Promise(function(A){if(c)c({x:a.x,y:a.y,z:a.z},function(N,ae){if(N||!ae)A(void 0);else{var we=new ga(ae,a.x,a.y,a.z);A(we)}});else{var C=(0,ke.ks)((0,de.Z)((0,de.Z)({},s),{},{url:d}),function(N,ae){if(N||!ae)A(void 0);else{var we=new ga(ae,a.x,a.y,a.z);A(we)}});a.xhrCancel=function(){return C.cancel()}}}));case 2:case"end":return _.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}();function ia(e,r){var n=Array.isArray(e)?e[0]:e,i=function(c,d){return no(n,c,d,r==null?void 0:r.requestParameters,r==null?void 0:r.getCustomData)},a=(0,de.Z)((0,de.Z)((0,de.Z)({},ua),r),{},{getTileData:i});return{data:n,dataArray:[],tilesetOptions:a,isTile:!0}}var zi=x(71002),Nr=x(74902),ji=x(97685);function Hs(e,r,n){switch(e){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n;case"%":return r%n;case"^":return Math.pow(r,n);case"abs":return Math.abs(r);case"floor":return Math.floor(r);case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"sin":return Math.sin(r);case"cos":return Math.cos(r);case"atan":return n===-1?Math.atan(r):Math.atan2(r,n);case"min":return Math.min(r,n);case"max":return Math.max(r,n);case"log10":return Math.log(r);case"log2":return Math.log2(r);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Da(e,r){for(var n=r[0],i=n.width,a=n.height,s=r.map(function(ae){return ae.rasterData}),c=i*a,d=[],g=JSON.stringify(e),_=0;_<c;_++){var A=JSON.parse(g),C=Za(A,s,_);if(typeof C=="number")d.push(C);else{var N=cs(A);d.push(N)}}return d}function Za(e,r,n){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return r[e[1]][n]}catch(i){return console.warn("Raster Data err!"),0}e.map(function(i,a){if(Array.isArray(i)&&i.length>0)switch(i[0]){case"band":try{e[a]=r[i[1]][n]}catch(s){console.warn("Raster Data err!"),e[a]=0}break;default:Za(i,r,n)}})}function Qs(e){var r=(0,ji.Z)(e,3),n=r[0],i=r[1],a=i===void 0?-1:i,s=r[2],c=s===void 0?-1:s;if(n===void 0)return console.warn("Express err!"),["+",0,0];var d=n.replace(/\s+/g,"");return[d,a,c]}function cs(e){var r=Qs(e),n=r[0],i=r[1],a=r[2];return Array.isArray(i)&&(i=cs(e[1])),Array.isArray(a)&&(a=cs(e[2])),Hs(n,i,a)}var Ka={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Do}};function Do(e,r){for(var n=e[0].rasterData,i=e[1].rasterData,a=e[2].rasterData,s=[],c=(r==null?void 0:r.countCut)||[2,98],d=(0,ji.Z)(c,2),g=d[0],_=d[1],A=(r==null?void 0:r.RMinMax)||qa(n,g,_),C=(r==null?void 0:r.GMinMax)||qa(i,g,_),N=(r==null?void 0:r.BMinMax)||qa(a,g,_),ae=0;ae<n.length;ae++)s.push(Math.max(0,n[ae]-A[0])),s.push(Math.max(0,i[ae]-C[0])),s.push(Math.max(0,a[ae]-N[0]));return{rasterData:s,rMinMax:A,gMinMax:C,bMinMax:N}}function qa(e,r,n){var i=e.slice().sort(function(d,g){return d-g}),a=i.length,s=i[Math.ceil(a*r/100)],c=i[Math.ceil(a*n/100)];return[s,c]}function Qa(e,r,n){return Pa.apply(this,arguments)}function Pa(){return Pa=(0,qe.Z)(Pe().mark(function e(r,n,i){var a,s,c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(r.length!==0){C.next=2;break}return C.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return C.next=4,Promise.all(r.map(function(N){var ae=N.data,we=N.bands,De=we===void 0?[0]:we;return n(ae,De)}));case 4:a=C.sent,s=[],a.forEach(function(N){Array.isArray(N)?s.push.apply(s,(0,Nr.Z)(N)):s.push(N)}),c=s[0],d=c.width,g=c.height,C.t0=(0,zi.Z)(i),C.next=C.t0==="function"?11:C.t0==="object"?13:15;break;case 11:return _=i(s),C.abrupt("break",16);case 13:return Array.isArray(i)?_={rasterData:Da(i,s)}:_=Na(i,s),C.abrupt("break",16);case 15:_={rasterData:s[0].rasterData};case 16:return C.abrupt("return",(0,de.Z)((0,de.Z)({},_),{},{width:d,height:g}));case 17:case"end":return C.stop()}},e)})),Pa.apply(this,arguments)}function Na(e,r){var n=Ka[e.type];if(n.type==="function")return n.method(r,e==null?void 0:e.options);if(n.type==="operation")return e.type==="rgb"?Lo(n.expression,r):{rasterData:Da(n.expression,r)}}function Lo(e,r){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var n=Da(e.r||["band",0],r),i=Da(e.g||["band",0],r),a=Da(e.b||["band",0],r);return[n,i,a]}function ba(e,r,n,i){return so.apply(this,arguments)}function so(){return so=(0,qe.Z)(Pe().mark(function e(r,n,i,a){var s;return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,Qa(r,n,i);case 2:s=d.sent,a(null,{data:s});case 4:case"end":return d.stop()}},e)})),so.apply(this,arguments)}function Ao(e,r){var n=r.extent,i=r.width,a=r.height,s=r.min,c=r.max,d=r.format,g=r.operation,_,A,C;if(d===void 0||rn(e))_=Array.from(e),A=i,C=a;else{var N=Array.isArray(e)?e:[e];_=Qa(N,d,g)}var ae={_id:1,dataArray:[{_id:1,data:_,width:A,height:C,min:s,max:c,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return ae}var Y=x(88120),vo=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",new Promise(function(g,_){i({x:n.x,y:n.y,z:n.z},function(A,C){if(A||C.length===0){_(A);return}C&&ba([{data:C,bands:[0]}],a,s,function(N,ae){N?_(N):ae&&g(ae)})})}));case 1:case"end":return d.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}(),Va=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i){return Pe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise(function(c,d){i({x:n.x,y:n.y,z:n.z},function(g,_){if(g||!_){d(g);return}_ instanceof ArrayBuffer?(0,ke.Co)(_,function(A,C){A&&d(A),c(C)}):_ instanceof HTMLImageElement?c(_):d(g)})}));case 1:case"end":return s.stop()}},r)}));return function(n,i){return e.apply(this,arguments)}}();function fs(e,r){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(n){return(0,ke.z0)(n,r)}):e.map(function(n){return{url:(0,ke.z0)(n.url,r),bands:n.bands||[0]}}):(0,ke.z0)(e,r)}function Eo(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(r){return{url:r,bands:[0]}}):e}function Qe(e,r){e.xhrCancel=function(){r.map(function(n){n.abort()})}}var gt=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s,c){var d,g,_,A,C,N;return Pe().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(d=Eo(i.url),!(d.length>1)){we.next=15;break}return we.next=4,Gt(d,i);case 4:if(g=we.sent,_=g.rasterFiles,A=g.xhrList,C=g.errList,Qe(n,A),!(C.length>0)){we.next=12;break}return a(C,null),we.abrupt("return");case 12:ba(_,s,c,a),we.next=17;break;case 15:N=(0,ke.ks)(i,function(De,at){if(De)a(De);else if(at){var Ot=[{data:at,bands:d[0].bands}];ba(Ot,s,c,a)}}),Qe(n,[N]);case 17:case"end":return we.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}();function Gt(e,r){return Pr.apply(this,arguments)}function Pr(){return Pr=(0,qe.Z)(Pe().mark(function e(r,n){var i,a,s,c,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:i=[],a=[],s=[],c=0;case 4:if(!(c<r.length)){De.next=20;break}return d=r[c],g=(0,de.Z)((0,de.Z)({},n),{},{url:d.url}),_=d.bands,De.next=10,(0,ke.LF)((0,de.Z)((0,de.Z)({},g),{},{type:"arrayBuffer"}));case 10:A=De.sent,C=A.err,N=A.data,ae=A.xhr,C&&s.push(C),a.push(ae),i.push({data:N,bands:_});case 17:c++,De.next=4;break;case 20:return De.abrupt("return",{rasterFiles:i,xhrList:a,errList:s});case 21:case"end":return De.stop()}},e)})),Pr.apply(this,arguments)}var Tn=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s,c){var d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d={url:fs(n,i)},_.abrupt("return",new Promise(function(A,C){gt(a,d,function(N,ae){N?C(N):ae&&A(ae)},s,c)}));case 2:case"end":return _.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}(),di=function(){var e=(0,qe.Z)(Pe().mark(function r(n,i,a,s){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return d=Array.isArray(n)?n[0]:n,s.wmtsOptions?(g=(s==null?void 0:s.getURLFromTemplate)||ke.jG,c=g(d,(0,de.Z)((0,de.Z)({},i),s.wmtsOptions))):(_=(s==null?void 0:s.getURLFromTemplate)||ke.z0,c=_(d,i)),C.abrupt("return",new Promise(function(N,ae){var we,De=(0,ke.gJ)({url:c,type:(s==null||(we=s.requestParameters)===null||we===void 0?void 0:we.type)||"arrayBuffer"},function(at,Ot){at?ae(at):Ot&&N(Ot)},s.transformResponse);a.xhrCancel=function(){return De.cancel()}}));case 3:case"end":return C.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}(),fa=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},Bo={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Ko=[Y.n3.ARRAYBUFFER,Y.n3.RGB];function Po(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function Us(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Po(e))throw new Error("tile server url is error");var n=(r==null?void 0:r.dataType)||Y.n3.IMAGE;n===Y.n3.RGB&&(n=Y.n3.ARRAYBUFFER);var i=function(c,d){switch(n){case Y.n3.IMAGE:return di(e,c,d,r);case Y.n3.CUSTOMIMAGE:case Y.n3.CUSTOMTERRAINRGB:return Va(d,r==null?void 0:r.getCustomData);case Y.n3.ARRAYBUFFER:return Tn(e,c,d,(r==null?void 0:r.format)||fa,r==null?void 0:r.operation);case Y.n3.CUSTOMARRAYBUFFER:case Y.n3.CUSTOMRGB:return vo(d,r==null?void 0:r.getCustomData,(r==null?void 0:r.format)||fa,r==null?void 0:r.operation);default:return di(e,c,d,r)}},a=(0,de.Z)((0,de.Z)((0,de.Z)({},Bo),r),{},{getTileData:i});return{data:e,dataArray:[],tilesetOptions:a,isTile:!0}}var ws=x(45987),Yc=["extent","min","max","width","height","format","operation"];function Ml(e,r){var n=r.extent,i=r.min,a=r.max,s=r.width,c=r.height,d=r.format,g=r.operation,_=(0,ws.Z)(r,Yc),A;if(d===void 0||rn(e))A=Array.from(e);else{var C=Array.isArray(e)?e:[e];A=Qa(C,d,g)}var N={_id:1,dataArray:[(0,de.Z)((0,de.Z)({_id:1,data:A,width:s,height:c},_),{},{min:i,max:a,coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return N}var ns={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Uu=function(){var e=(0,qe.Z)(Pe().mark(function r(n){return Pe().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(s){var c=(0,ji.Z)(n.bounds,4),d=c[0],g=c[1],_=c[2],A=c[3],C={layers:{testTile:{features:[{type:"Feature",properties:{key:n.x+"/"+n.y+"/"+n.z,x:(d+_)/2,y:(g+A)/2},geometry:{type:"LineString",coordinates:[[_,A],[_,g],[d,g],[d,g]]}}]}}};s(C)}));case 1:case"end":return a.stop()}},r)}));return function(n){return e.apply(this,arguments)}}();function il(e,r){var n=function(s){return Uu(s)},i=(0,de.Z)((0,de.Z)((0,de.Z)({},ns),r),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var is=["extent","width","height"];function Cu(e,r){var n=r.extent,i=r.width,a=r.height,s=(0,ws.Z)(r,is);e.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");for(var c=s.bands||[0,1,2],d=(0,ji.Z)(c,3),g=d[0],_=d[1],A=d[2],C=[e[g],e[_],e[A]],N=[],ae=(s==null?void 0:s.countCut)||[2,98],we=(0,ji.Z)(ae,2),De=we[0],at=we[1],Ot=(s==null?void 0:s.RMinMax)||qa(C[0],De,at),Pt=(s==null?void 0:s.GMinMax)||qa(C[1],De,at),Kt=(s==null?void 0:s.BMinMax)||qa(C[2],De,at),hr=0;hr<C[0].length;hr++)N.push(Math.max(0,C[0][hr]-Ot[0])),N.push(Math.max(0,C[1][hr]-Pt[0])),N.push(Math.max(0,C[2][hr]-Kt[0]));var jr={_id:1,dataArray:[(0,de.Z)((0,de.Z)({_id:1,data:N,width:i,height:a,rMinMax:Ot,gMinMax:Pt,bMinMax:Kt},s),{},{coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return jr}var al=["extent","width","height"];function Kl(e,r){var n=r.extent,i=r.width,a=r.height,s=(0,ws.Z)(r,al);e.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");for(var c=s.bands||[0,1],d=(0,ji.Z)(c,2),g=d[0],_=d[1],A=[e[g],e[_]],C=[],N=0;N<A[0].length;N++)C.push((A[1][N]-A[0][N])/(A[1][N]+A[0][N]));var ae={_id:1,dataArray:[(0,de.Z)((0,de.Z)({_id:1,data:C,width:i,height:a},s),{},{coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return ae}var cn=x(97326),Ei=x(60136),Hi=x(82963),In=x(61120),Co=x(46343),ol=x(26729),ql=x.n(ol),Ic=x(69848),uc=x.n(Ic);function Pc(e,r){var n=r.radius,i=n===void 0?40:n,a=r.maxZoom,s=a===void 0?18:a,c=r.minZoom,d=c===void 0?0:c,g=r.zoom,_=g===void 0?2:g;if(e.pointIndex){var A=e.pointIndex.getClusters(e.extent,Math.floor(_));return e.dataArray=Kc(A),e}var C=new(uc())({radius:i,minZoom:d,maxZoom:s}),N={type:"FeatureCollection",features:[]};return N.features=e.dataArray.map(function(ae){return{type:"Feature",geometry:{type:"Point",coordinates:ae.coordinates},properties:(0,de.Z)({},ae)}}),C.load(N.features),C}function Kc(e){return e.map(function(r,n){return(0,de.Z)({coordinates:r.geometry.coordinates,_id:n+1},r.properties)})}function bf(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],n=1;n<e.length;n++)e[n]>r&&(r=e[n]);return r}function qc(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],n=1;n<e.length;n++)e[n]<r&&(r=e[n]);return r}function Ol(e){if(e.length===0)return 0;for(var r=e[0],n=0,i,a=1;a<e.length;a++)i=r+e[a]*1,Math.abs(r)>=Math.abs(e[a])?n+=r-i+e[a]:n+=e[a]-i+r,r=i;return r+n*1}function lu(e){if(e.length===0)throw new Error("mean requires at least one data point");return Ol(e)/e.length}var Ef={min:qc,max:bf,mean:lu,sum:Ol};function hs(e){var r=gl();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function gl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yl=ke.rU.cloneDeep,Ws=ke.rU.isFunction,Js=ke.rU.isString,eu=ke.rU.mergeWith;function cu(e,r){if(Array.isArray(r))return r}var zs=function(e){(0,Ei.Z)(n,e);var r=hs(n);function n(i,a){var s;return(0,Ue.Z)(this,n),s=r.call(this),(0,ue.Z)((0,cn.Z)(s),"type","source"),(0,ue.Z)((0,cn.Z)(s),"isTile",!1),(0,ue.Z)((0,cn.Z)(s),"inited",!1),(0,ue.Z)((0,cn.Z)(s),"hooks",{init:new Co.ni}),(0,ue.Z)((0,cn.Z)(s),"parser",{type:"geojson"}),(0,ue.Z)((0,cn.Z)(s),"transforms",[]),(0,ue.Z)((0,cn.Z)(s),"cluster",!1),(0,ue.Z)((0,cn.Z)(s),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,ue.Z)((0,cn.Z)(s),"invalidExtent",!1),(0,ue.Z)((0,cn.Z)(s),"dataArrayChanged",!1),(0,ue.Z)((0,cn.Z)(s),"cfg",{autoRender:!0}),s.originData=i,s.initCfg(a),s.init().then(function(){s.inited=!0,s.emit("update",{type:"inited"})}),s}return(0,vt.Z)(n,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}},{key:"getClustersLeaves",value:function(a){return this.clusterIndex.getLeaves(a,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(a){var s=this,c=this.clusterOptions,d=c.method,g=d===void 0?"sum":d,_=c.field,A=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,A.forEach(function(C){C.id||(C.properties.point_count=1)}),(_||Ws(g))&&(A=A.map(function(C){var N=C.id;if(N){var ae=s.clusterIndex.getLeaves(N,1/0),we=ae.map(function(Ot){return Ot.properties}),De;if(Js(g)&&_){var at=_n(we,_);De=Ef[g](at)}Ws(g)&&(De=g(we)),C.properties.stat=De}else C.properties.point_count=1;return C})),this.data=h("geojson")({type:"FeatureCollection",features:A}),this.executeTrans()}},{key:"getFeatureById",value:function(a){var s=this.parser,c=s.type,d=c===void 0?"geojson":c,g=s.geometry;if(d==="geojson"&&!this.cluster){var _=a<this.originData.features.length?this.originData.features[a]:"null",A=yl(_);if(A!=null&&A.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var C=this.data.dataArray.find(function(N){return N._id===a});A.properties=C}return A}else return d==="json"&&g?this.data.dataArray.find(function(N){return N._id===a}):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}},{key:"updateFeaturePropertiesById",value:function(a,s){this.data.dataArray=this.data.dataArray.map(function(c){return c._id===a?(0,de.Z)((0,de.Z)({},c),s):c}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(a,s){var c=this.data.dataArray.find(function(d){return d[a]===s});return c==null?void 0:c._id}},{key:"setData",value:function(a,s){var c=this;this.originData=a,this.dataArrayChanged=!1,this.initCfg(s),this.init().then(function(){c.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var a;(a=this.tileset)===null||a===void 0||a.reloadAll()}},{key:"reloadTilebyId",value:function(a,s,c){var d;(d=this.tileset)===null||d===void 0||d.reloadTileById(a,s,c)}},{key:"reloadTileByLnglat",value:function(a,s,c){var d;(d=this.tileset)===null||d===void 0||d.reloadTileByLnglat(a,s,c)}},{key:"getTileExtent",value:function(a,s){var c;return(c=this.tileset)===null||c===void 0?void 0:c.getTileExtent(a,s)}},{key:"getTileByZXY",value:function(a,s,c){var d;return(d=this.tileset)===null||d===void 0?void 0:d.getTileByZXY(a,s,c)}},{key:"reloadTileByExtent",value:function(a,s){var c;(c=this.tileset)===null||c===void 0||c.reloadTileByExtent(a,s)}},{key:"destroy",value:function(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)===null||a===void 0||a.destroy()}},{key:"processData",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c=this;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",new Promise(function(_,A){try{c.excuteParser(),c.initCluster(),c.executeTrans(),_({})}catch(C){A(C)}}));case 1:case"end":return g.stop()}},s)}));function a(){return i.apply(this,arguments)}return a}()},{key:"initCfg",value:function(a){this.cfg=eu(this.cfg,a,cu);var s=this.cfg;s&&(s.parser&&(this.parser=s.parser),s.transforms&&(this.transforms=s.transforms),this.cluster=s.cluster||!1,s.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,de.Z)((0,de.Z)({},this.clusterOptions),s.clusterOptions)))}},{key:"init",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.inited=!1,d.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"excuteParser",value:function(){var a=this.parser,s=a.type||"geojson",c=h(s);this.data=c(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=(0,ke.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var a=this.data.tilesetOptions;if(a){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(a),this.tileset;var s=new ke.nx((0,de.Z)({},a));return s}}},{key:"executeTrans",value:function(){var a=this,s=this.transforms;s.forEach(function(c){var d=c.type,g=P(d)(a.data,c);Object.assign(a.data,g)})}},{key:"initCluster",value:function(){if(this.cluster){var a=this.clusterOptions||{};this.clusterIndex=Pc(this.data,a)}}},{key:"caculClusterExtent",value:function(a){var s=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(s=(0,ke.yA)((0,ke.ds)(this.extent),a)),s[0].concat(s[1])}}]),n}(ol.EventEmitter);function zu(e,r){var n=r.callback;return n&&(e.dataArray=e.dataArray.filter(n)),e}function Zu(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lc(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function lc(e,r){if(e){if(typeof e=="string")return cc(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cc(e,r)}}function cc(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var ja=6378e3;function jf(e,r){var n=e.dataArray,i=r.size,a=i===void 0?10:i,s=a/(2*Math.PI*ja)*(256<<20)/2,c=fc(n,a),d=c.gridHash,g=c.gridOffset,_=Jc(d,g,r);return{yOffset:s,xOffset:s,radius:s,type:"grid",dataArray:_}}function fc(e,r){var n=1/0,i=-1/0,a,s=Zu(e),c;try{for(s.s();!(c=s.n()).done;){var d=c.value;a=d.coordinates[1],Number.isFinite(a)&&(n=a<n?a:n,i=a>i?a:i)}}catch(Kt){s.e(Kt)}finally{s.f()}var g=(n+i)/2,_=Il(r,g);if(_.xOffset<=0||_.yOffset<=0)return{gridHash:{},gridOffset:_};var A={},C=Zu(e),N;try{for(C.s();!(N=C.n()).done;){var ae=N.value,we=ae.coordinates[1],De=ae.coordinates[0];if(Number.isFinite(we)&&Number.isFinite(De)){var at=Math.floor((we+90)/_.yOffset),Ot=Math.floor((De+180)/_.xOffset),Pt="".concat(at,"-").concat(Ot);A[Pt]=A[Pt]||{count:0,points:[]},A[Pt].count+=1,A[Pt].points.push(ae)}}}catch(Kt){C.e(Kt)}finally{C.f()}return{gridHash:A,gridOffset:_}}function Il(e,r){var n=co(e),i=Qc(r,e);return{yOffset:n,xOffset:i}}function co(e){return e/ja*(180/Math.PI)}function Qc(e,r){return r/ja*(180/Math.PI)/Math.cos(e*Math.PI/180)}function Jc(e,r,n){return Object.keys(e).reduce(function(i,a,s){var c=a.split("-"),d=parseInt(c[0],10),g=parseInt(c[1],10),_={};if(n.field&&n.method){var A=ke.a5.getColumn(e[a].points,n.field);_[n.method]=ke.a5.statMap[n.method](A)}return Object.assign(_,{_id:s,coordinates:(0,ke.Z)([-180+r.xOffset*(g+.5),-90+r.yOffset*(d+.5)]),rawData:e[a].points,count:e[a].count}),i.push(_),i},[])}var Ho=Math.PI/3,wu=[0,Ho,2*Ho,3*Ho,4*Ho,5*Ho];function fu(e){return e[0]}function hu(e){return e[1]}function Ql(){var e=0,r=0,n=1,i=1,a=fu,s=hu,c,d,g;function _(C){var N={},ae=[],we,De=C.length;for(we=0;we<De;++we)if(!(isNaN(Ot=+a.call(null,at=C[we],we,C))||isNaN(Pt=+s.call(null,at,we,C)))){var at,Ot,Pt,Kt=Math.round(Pt=Pt/g),hr=Math.round(Ot=Ot/d-(Kt&1)/2),jr=Pt-Kt;if(Math.abs(jr)*3>1){var pr=Ot-hr,rr=hr+(Ot<hr?-1:1)/2,Ur=Kt+(Pt<Kt?-1:1),$n=Ot-rr,Ai=Pt-Ur;pr*pr+jr*jr>$n*$n+Ai*Ai&&(hr=rr+(Kt&1?1:-1)/2,Kt=Ur)}var Wn=hr+"-"+Kt,Xi=N[Wn];Xi?Xi.push(at):(ae.push(Xi=N[Wn]=[at]),Xi.x=(hr+(Kt&1)/2)*d,Xi.y=Kt*g)}return ae}function A(C){var N=0,ae=0;return wu.map(function(we){var De=Math.sin(we)*C,at=-Math.cos(we)*C,Ot=De-N,Pt=at-ae;return N=De,ae=at,[Ot,Pt]})}return _.hexagon=function(C){return"m"+A(C==null?c:+C).join("l")+"z"},_.centers=function(){for(var C=[],N=Math.round(r/g),ae=Math.round(e/d),we=N*g;we<i+c;we+=g,++N)for(var De=ae*d+(N&1)*d/2;De<n+d/2;De+=d)C.push([De,we]);return C},_.mesh=function(){var C=A(c).slice(0,4).join("l");return _.centers().map(function(N){return"M"+N+"m"+C}).join("")},_.x=function(C){return arguments.length?(a=C,_):a},_.y=function(C){return arguments.length?(s=C,_):s},_.radius=function(C){return arguments.length?(c=+C,d=c*2*Math.sin(Ho),g=c*1.5,_):c},_.size=function(C){return arguments.length?(e=r=0,n=+C[0],i=+C[1],_):[n-e,i-r]},_.extent=function(C){return arguments.length?(e=+C[0][0],r=+C[0][1],n=+C[1][0],i=+C[1][1],_):[[e,r],[n,i]]},_.radius(1)}var _l=6378e3;function tu(e,r){var n=e.dataArray,i=r.size,a=i===void 0?10:i,s=r.method,c=s===void 0?"sum":s,d=a/(2*Math.PI*_l)*(256<<20)/2,g=n.map(function(N){var ae=(0,ke.Z)(N.coordinates),we=(0,ji.Z)(ae,2),De=we[0],at=we[1];return(0,de.Z)((0,de.Z)({},N),{},{coordinates:[De,at]})}),_=Ql().radius(d).x(function(N){return N.coordinates[0]}).y(function(N){return N.coordinates[1]}),A=_(g),C={dataArray:A.map(function(N,ae){var we;if(r.field&&c){var De=ke.a5.getColumn(N,r.field);N[c]=ke.a5.statMap[c](De)}return we={},(0,ue.Z)(we,r.method,N[c]),(0,ue.Z)(we,"count",N.length),(0,ue.Z)(we,"rawData",N),(0,ue.Z)(we,"coordinates",[N.x,N.y]),(0,ue.Z)(we,"_id",ae),we}),radius:d,xOffset:d,yOffset:d,type:"hexagon"};return C}function Jl(e,r){var n=r.sourceField,i=r.targetField,a=r.data,s={};return a.forEach(function(c){s[c[n]]=c}),e.dataArray=e.dataArray.map(function(c){var d=c[i];return(0,de.Z)((0,de.Z)({},c),s[d])}),e}function sl(e,r){var n=r.callback;return n&&(e.dataArray=e.dataArray.map(n)),e}D("rasterTile",Us),D("mvt",ia),D("geojsonvt",xn),D("testTile",il),D("geojson",kt),D("jsonTile",sa),D("image",wi),D("csv",vn),D("json",ln),D("raster",Ao),D("rasterRgb",Ml),D("rgb",Cu),D("ndi",Kl),X("cluster",Pc),X("filter",zu),X("join",Jl),X("map",sl),X("grid",jf),X("hexagon",tu);var ru=zs;function Wo(e){var r=eo();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function eo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fo=null;function Ru(e){var r=Sf();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Sf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vu=ke.rU.merge,hc=null,Pl=x(4157);function Zs(e){var r=Mu();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Mu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pu=function(e){(0,Ei.Z)(n,e);var r=Zs(n);function n(i){var a;return(0,Ue.Z)(this,n),a=r.call(this),n.controlCount++,a.controlOption=(0,de.Z)((0,de.Z)({},a.getDefault(i)),i||{}),a}return(0,vt.Z)(n,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(a){var s=this.getDefault(a);Object.entries(a).forEach(function(c){var d=(0,ji.Z)(c,2),g=d[0],_=d[1];_===void 0&&(a[g]=s[g])}),"position"in a&&this.setPosition(a.position),"className"in a&&this.setClassName(a.className),"style"in a&&this.setStyle(a.style),this.controlOption=(0,de.Z)((0,de.Z)({},this.controlOption),a)}},{key:"addTo",value:function(a){this.mapsService=a.mapService,this.renderService=a.rendererService,this.layerService=a.layerService,this.controlService=a.controlService,this.configService=a.globalConfigService,this.scene=a.sceneService,this.sceneContainer=a,this.isShow=!0,this.container=this.onAdd(),ke.SO.addClass(this.container,"l7-control");var s=this.controlOption,c=s.className,d=s.style;return c&&this.setClassName(c),d&&this.setStyle(d),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;ke.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ke.SO.create("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var a=this.container;ke.SO.removeClass(a,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var a=this.container;ke.SO.addClass(a,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(a){return{position:Y.d.TOPRIGHT,name:"".concat(n.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(a){if(this.mapsService&&a&&a.screenX>0&&a.screenY>0){var s=this.mapsService.getContainer();s!==null&&s.focus()}}},{key:"setPosition",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.d.TOPLEFT,s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=a,s&&s.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(a){var s=this.container,c=this.controlOption.className;c&&ke.SO.removeClass(s,c),a&&ke.SO.addClass(s,a)}},{key:"setStyle",value:function(a){var s=this.container;a?s.setAttribute("style",a):s.removeAttribute("style")}},{key:"insertContainer",value:function(){var a=this.controlOption.position,s=this.container;if(a instanceof Element)a.appendChild(s);else{var c=this.controlService.controlCorners[a];["bottomleft","bottomright","righttop","rightbottom"].includes(a)?c.insertBefore(s,c.firstChild):c.appendChild(s)}}},{key:"checkUpdateOption",value:function(a,s){return s.some(function(c){return c in a})}}]),n}(ql());(0,ue.Z)(pu,"controlCount",0);function ju(e){var r=kl();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function kl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Dl=null;function $u(e){var r=pc();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function pc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hu=function(e){(0,Ei.Z)(n,e);var r=$u(n);function n(i,a){var s;return(0,Ue.Z)(this,n),s=r.call(this),(0,ue.Z)((0,cn.Z)(s),"isShow",!1),(0,ue.Z)((0,cn.Z)(s),"timeout",null),(0,ue.Z)((0,cn.Z)(s),"show",function(){return s.isShow||!s.contentDOM.innerHTML||(s.resetPopperPosition(),ke.SO.removeClass(s.popperDOM,"l7-popper-hide"),s.isShow=!0,s.option.unique&&n.conflictPopperList.forEach(function(c){c!==(0,cn.Z)(s)&&c.isShow&&c.hide()}),s.emit("show"),window.addEventListener("pointerdown",s.onPopperUnClick)),(0,cn.Z)(s)}),(0,ue.Z)((0,cn.Z)(s),"hide",function(){return s.isShow&&(ke.SO.addClass(s.popperDOM,"l7-popper-hide"),s.isShow=!1,s.emit("hide"),window.removeEventListener("pointerdown",s.onPopperUnClick)),(0,cn.Z)(s)}),(0,ue.Z)((0,cn.Z)(s),"setHideTimeout",function(){s.timeout||(s.timeout=window.setTimeout(function(){s.isShow&&(s.hide(),s.timeout=null)},300))}),(0,ue.Z)((0,cn.Z)(s),"clearHideTimeout",function(){s.timeout&&(window.clearTimeout(s.timeout),s.timeout=null)}),(0,ue.Z)((0,cn.Z)(s),"onBtnClick",function(){s.isShow?s.hide():s.show()}),(0,ue.Z)((0,cn.Z)(s),"onPopperUnClick",function(c){ke.SO.findParentElement(c.target,[".l7-button-control",".l7-popper-content"])||s.hide()}),(0,ue.Z)((0,cn.Z)(s),"onBtnMouseLeave",function(){s.setHideTimeout()}),(0,ue.Z)((0,cn.Z)(s),"onBtnMouseMove",function(){s.clearHideTimeout(),!s.isShow&&s.show()}),s.button=i,s.option=a,s.init(),a.unique&&n.conflictPopperList.push((0,cn.Z)(s)),s}return(0,vt.Z)(n,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(a){typeof a=="string"?this.contentDOM.innerHTML=a:a instanceof HTMLElement&&(ke.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(a)),this.content=a}},{key:"init",value:function(){var a=this.option.trigger;this.popperDOM=this.createPopper(),a==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),ke.SO.remove(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var a={},s=this.option,c=s.container,d=s.offset,g=d===void 0?[0,0]:d,_=s.placement,A=(0,ji.Z)(g,2),C=A[0],N=A[1],ae=this.button.getBoundingClientRect(),we=c.getBoundingClientRect(),De=ke.SO.getDiffRect(ae,we),at=De.left,Ot=De.right,Pt=De.top,Kt=De.bottom,hr=!1,jr=!1;/^(left|right)/.test(_)?(_.includes("left")?a.right="".concat(ae.width+Ot,"px"):_.includes("right")&&(a.left="".concat(ae.width+at,"px")),_.includes("start")?a.top="".concat(Pt,"px"):_.includes("end")?a.bottom="".concat(Kt,"px"):(a.top="".concat(Pt+ae.height/2,"px"),jr=!0,a.transform="translate(".concat(C,"px, calc(").concat(N,"px - 50%))"))):/^(top|bottom)/.test(_)&&(_.includes("top")?a.bottom="".concat(ae.height+Kt,"px"):_.includes("bottom")&&(a.top="".concat(ae.height+Pt,"px")),_.includes("start")?a.left="".concat(at,"px"):_.includes("end")?a.right="".concat(Ot,"px"):(a.left="".concat(at+ae.width/2,"px"),hr=!0,a.transform="translate(calc(".concat(C,"px - 50%), ").concat(N,"px)"))),a.transform="translate(calc(".concat(C,"px - ").concat(hr?"50%":"0%","), calc(").concat(N,"px - ").concat(jr?"50%":"0%",")");var pr=_.split("-");pr.length&&ke.SO.addClass(this.popperDOM,pr.map(function(rr){return"l7-popper-".concat(rr)}).join(" ")),ke.SO.addStyle(this.popperDOM,ke.SO.css2Style(a))}},{key:"createPopper",value:function(){var a=this.option,s=a.container,c=a.className,d=c===void 0?"":c,g=a.content,_=ke.SO.create("div","l7-popper l7-popper-hide ".concat(d)),A=ke.SO.create("div","l7-popper-content"),C=ke.SO.create("div","l7-popper-arrow");return _.appendChild(A),_.appendChild(C),s.appendChild(_),this.popperDOM=_,this.contentDOM=A,g&&this.setContent(g),_}}]),n}(ol.EventEmitter);(0,ue.Z)(Hu,"conflictPopperList",[]);function Rs(e){var r=ef();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function ef(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kc={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},tf=null;function xl(e){var r=Ou();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Ou(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ll=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(Ll||{}),Bl=null,Wu=function(r){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("l7-iconfont"),n.setAttribute("aria-hidden","true");var i=document.createElementNS("http://www.w3.org/2000/svg","use");return i.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(r)),n.appendChild(i),n};function Tf(e){var r=dc();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function dc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rf=null;function vc(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=nf(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function nf(e,r){if(e){if(typeof e=="string")return ec(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ec(e,r)}}function ec(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var mc=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Gs=function(){if(typeof document=="undefined")return!1;for(var e=mc[0],r={},n=0,i=mc;n<i.length;n++){var a=i[n],s=a==null?void 0:a[1];if(s in document){var c=vc(a.entries()),d;try{for(c.s();!(d=c.n()).done;){var g=(0,ji.Z)(d.value,2),_=g[0],A=g[1];r[e[_]]=A}}catch(C){c.e(C)}finally{c.f()}return r}}return!1}(),du={change:Gs.fullscreenchange,error:Gs.fullscreenerror},as={request:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,n=arguments.length>1?arguments[1]:void 0;return new Promise(function(i,a){var s=function d(){as.off("change",d),i()};as.on("change",s);var c=r[Gs.requestFullscreen](n);c instanceof Promise&&c.then(s).catch(a)})},exit:function(){return new Promise(function(r,n){if(!as.isFullscreen){r();return}var i=function s(){as.off("change",s),r()};as.on("change",i);var a=document[Gs.exitFullscreen]();a instanceof Promise&&a.then(i).catch(n)})},toggle:function(r,n){return as.isFullscreen?as.exit():as.request(r,n)},onchange:function(r){as.on("change",r)},onerror:function(r){as.on("error",r)},on:function(r,n){var i=du[r];i&&document.addEventListener(i,n,!1)},off:function(r,n){var i=du[r];i&&document.removeEventListener(i,n,!1)},raw:Gs};Object.defineProperties(as,{isFullscreen:{get:function(){return!!document[Gs.fullscreenElement]}},element:{enumerable:!0,get:function(){var r;return(r=document[Gs.fullscreenElement])!==null&&r!==void 0?r:void 0}},isEnabled:{enumerable:!0,get:function(){return!!document[Gs.fullscreenEnabled]}}}),Gs||(as={isEnabled:!1});var Dc=null;function bl(e){var r=uo();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Lc=null;function Vs(e){var r=ul();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function ul(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ca=null;function lo(e){var r=Xs();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Xs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function gc(e){return Object.keys(e!=null?e:{}).every(function(r){return["layer","name","img"].includes(r)})}var Gu=null,vu=x(73237);function Af(e){var r=Bc();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Bc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yc=function(e){(0,Ei.Z)(n,e);var r=Af(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getDefault",value:function(){return{position:Y.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var a=ke.SO.create("div","l7-control-logo");return this.setLogoContent(a),a}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(a){(0,vu.Z)((0,In.Z)(n.prototype),"setOptions",this).call(this,a),this.checkUpdateOption(a,["img","href"])&&(ke.SO.clearChildren(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(a){var s=this.controlOption,c=s.href,d=s.img,g=ke.SO.create("img");if(g.setAttribute("src",d),g.setAttribute("aria-label","AntV logo"),ke.SO.setUnDraggable(g),c){var _=ke.SO.create("a","l7-control-logo-link");_.target="_blank",_.href=c,_.rel="noopener nofollow",_.setAttribute("rel","noopener nofollow"),_.appendChild(g),a.appendChild(_)}else a.appendChild(g)}}]),n}(pu),Fl={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},os={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function So(e){var r=Nl();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var af=null;function wo(e){var r=ii();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ms=null;function tc(e){var r=Ul();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Ul(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ps=null,to=ke.rU.cloneDeep,zl=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService,c=i.mapService,d=i.fontService;this.mapService=c,this.fontService=d,n.hooks.init.tapPromise("DataMappingPlugin",(0,qe.Z)(Pe().mark(function g(){return Pe().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:n.log(Y.Or.MappingStart,Y.KD.INIT),a.generateMaping(n,{styleAttributeService:s}),n.log(Y.Or.MappingEnd,Y.KD.INIT);case 3:case"end":return A.stop()}},g)}))),n.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var g=(0,qe.Z)(Pe().mark(function _(A){var C;return Pe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(A){ae.next=2;break}return ae.abrupt("return",A);case 2:return n.dataState.dataMappingNeedUpdate=!1,n.log(Y.Or.MappingStart,Y.KD.UPDATE),C=a.generateMaping(n,{styleAttributeService:s}),n.log(Y.Or.MappingEnd,Y.KD.UPDATE),ae.abrupt("return",C);case 7:case"end":return ae.stop()}},_)}));return function(_){return g.apply(this,arguments)}}()),n.hooks.beforeRender.tap("DataMappingPlugin",function(){var g=n.getSource();if(!(n.layerModelNeedUpdate||!g||!g.inited)){var _=s.getLayerStyleAttributes()||[],A=s.getLayerStyleAttribute("filter"),C=g.data.dataArray;if(!(Array.isArray(C)&&C.length===0)){var N=_.filter(function(De){return De.needRemapping}),ae=C;if(A!=null&&A.needRemapping&&A!==null&&A!==void 0&&A.scale&&(ae=C.filter(function(De){return a.applyAttributeMapping(A,De)[0]})),N.length){var we=a.mapping(n,N,ae,n.getEncodedData());n.setEncodedData(we)}}}})}},{key:"generateMaping",value:function(n,i){var a=this,s=i.styleAttributeService,c=s.getLayerStyleAttributes()||[],d=s.getLayerStyleAttribute("filter"),g=n.getSource().data.dataArray,_=g;d!=null&&d.scale&&(_=g.filter(function(C){return a.applyAttributeMapping(d,C)[0]})),_=n.processData(_);var A=this.mapping(n,c,_,void 0);return n.setEncodedData(A),n.emit("dataUpdate",null),!0}},{key:"mapping",value:function(n,i,a,s){var c=this,d=i.filter(function(_){return _.scale!==void 0}).filter(function(_){return _.name!=="filter"}),g=a.map(function(_,A){var C=s?s[A]:{},N=(0,de.Z)({id:_._id,coordinates:_.coordinates},C);return d.forEach(function(ae){var we=c.applyAttributeMapping(ae,_);(ae.name==="color"||ae.name==="stroke")&&(we=we.map(function(De){return(0,ke.CI)(De)})),N[ae.name]=Array.isArray(we)&&we.length===1?we[0]:we,ae.name==="shape"&&(N.shape=c.fontService.getIconFontKey(N[ae.name]))}),N});return i.forEach(function(_){_.needRemapping=!1}),this.adjustData2Amap2Coordinates(g,n),this.adjustData2SimpleCoordinates(g),g}},{key:"adjustData2Amap2Coordinates",value:function(n,i){var a=this;if(n.length>0&&this.mapService.version==="GAODE2.x"){var s=i.coordCenter||i.getSource().center;n.filter(function(c){return!c.originCoordinates}).map(function(c){c.version="GAODE2.x",c.originCoordinates=to(c.coordinates),c.coordinates=a.mapService.coordToAMap2RelativeCoordinates(c.coordinates,s)})}}},{key:"adjustData2SimpleCoordinates",value:function(n){var i=this;n.length>0&&this.mapService.version==="SIMPLE"&&n.map(function(a){a.simpleCoordinate||(a.coordinates=i.unProjectCoordinates(a.coordinates),a.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(n){var i=this;if(typeof n[0]=="number")return this.mapService.simpleMapCoord.unproject(n);if(n[0]&&n[0][0]instanceof Array){var a=[];return n.map(function(c){var d=[];c.map(function(g){d.push(i.mapService.simpleMapCoord.unproject(g))}),a.push(d)}),a}else{var s=[];return n.map(function(c){s.push(i.mapService.simpleMapCoord.unproject(c))}),s}}},{key:"applyAttributeMapping",value:function(n,i){var a;if(!n.scale)return[];var s=(n==null||(a=n.scale)===null||a===void 0?void 0:a.scalers)||[],c=[];s.forEach(function(g){var _,A=g.field;(i.hasOwnProperty(A)||((_=n.scale)===null||_===void 0?void 0:_.type)==="variable")&&c.push(i[A])});var d=n.mapping?n.mapping(c):[];return d}},{key:"getArrowPoints",value:function(n,i){var a=[i[0]-n[0],i[1]-n[1]],s=(0,ke.Fv)(a),c=[n[0]+s[0]*1e-4,n[1]+s[1]*1e-4];return c}}]),e}(),S=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){var i=this;this.mapService=n.getContainer().mapService,n.hooks.init.tapPromise("DataSourcePlugin",(0,qe.Z)(Pe().mark(function a(){var s,c,d,g;return Pe().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(n.log(Y.Or.SourceInitStart,Y.KD.INIT),s=n.getSource(),s||(c=n.sourceOption||n.defaultSourceConfig,d=c.data,g=c.options,s=new ru(d,g),n.setSource(s)),!s.inited){A.next=8;break}i.updateClusterData(n),n.log(Y.Or.SourceInitEnd,Y.KD.INIT),A.next=10;break;case 8:return A.next=10,new Promise(function(C){s.on("update",function(N){N.type==="inited"&&(i.updateClusterData(n),n.log(Y.Or.SourceInitEnd,Y.KD.INIT)),C(null)})});case 10:case"end":return A.stop()}},a)}))),n.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,qe.Z)(Pe().mark(function a(){var s,c,d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return s=i.updateClusterData(n),c=n.dataState.dataSourceNeedUpdate,n.dataState.dataSourceNeedUpdate=!1,d=s||c,_.abrupt("return",d);case 5:case"end":return _.stop()}},a)})))}},{key:"updateClusterData",value:function(n){if(n.isTileLayer||n.tileLayer||!n.getSource())return!1;var i=n.getSource(),a=i.cluster,s=i.clusterOptions.zoom,c=s===void 0?0:s,d=this.mapService.getZoom()-1,g=n.dataState.dataSourceNeedUpdate;return a&&g&&i.updateClusterData(Math.floor(d)),a&&Math.abs(n.clusterZoom-d)>=1?(c!==Math.floor(d)&&i.updateClusterData(Math.floor(d)),n.clusterZoom=d,!0):!1}}]),e}();function Ge(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function re(e){return e.length===1&&(e=ce(e)),{left:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)<0?i=s+1:a=s}return i},right:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)>0?a=s:i=s+1}return i}}}function ce(e){return function(r,n){return Ge(e(r),n)}}var G=re(Ge),xe=G.right,ut=G.left,Dt=null;function dt(e,r){var n=e.length,i=-1,a,s,c;if(r==null){for(;++i<n;)if((a=e[i])!=null&&a>=a)for(s=c=a;++i<n;)(a=e[i])!=null&&(s>a&&(s=a),c<a&&(c=a))}else for(;++i<n;)if((a=r(e[i],i,e))!=null&&a>=a)for(s=c=a;++i<n;)(a=r(e[i],i,e))!=null&&(s>a&&(s=a),c<a&&(c=a));return[s,c]}var It=Array.prototype,Tr=It.slice,Yr=It.map,wn=Math.sqrt(50),Bn=Math.sqrt(10),Kn=Math.sqrt(2);function fi(e,r,n){var i,a=-1,s,c,d;if(r=+r,e=+e,n=+n,e===r&&n>0)return[e];if((i=r<e)&&(s=e,e=r,r=s),(d=Gr(e,r,n))===0||!isFinite(d))return[];if(d>0)for(e=Math.ceil(e/d),r=Math.floor(r/d),c=new Array(s=Math.ceil(r-e+1));++a<s;)c[a]=(e+a)*d;else for(e=Math.floor(e*d),r=Math.ceil(r*d),c=new Array(s=Math.ceil(e-r+1));++a<s;)c[a]=(e-a)/d;return i&&c.reverse(),c}function Gr(e,r,n){var i=(r-e)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,a);return a>=0?(s>=wn?10:s>=Bn?5:s>=Kn?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(s>=wn?10:s>=Bn?5:s>=Kn?2:1)}function Ri(e,r,n){var i=Math.abs(r-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/a;return s>=wn?a*=10:s>=Bn?a*=5:s>=Kn&&(a*=2),r<e?-a:a}function Pi(){var e=identity,r=extent,n=sturges;function i(a){var s,c=a.length,d,g=new Array(c);for(s=0;s<c;++s)g[s]=e(a[s],s,a);var _=r(g),A=_[0],C=_[1],N=n(g,A,C);Array.isArray(N)||(N=tickStep(A,C,N),N=range(Math.ceil(A/N)*N,C,N));for(var ae=N.length;N[0]<=A;)N.shift(),--ae;for(;N[ae-1]>C;)N.pop(),--ae;var we=new Array(ae+1),De;for(s=0;s<=ae;++s)De=we[s]=[],De.x0=s>0?N[s-1]:A,De.x1=s<ae?N[s]:C;for(s=0;s<c;++s)d=g[s],A<=d&&d<=C&&we[bisect(N,d,0,ae)].push(a[s]);return we}return i.value=function(a){return arguments.length?(e=typeof a=="function"?a:constant(a),i):e},i.domain=function(a){return arguments.length?(r=typeof a=="function"?a:constant([a[0],a[1]]),i):r},i.thresholds=function(a){return arguments.length?(n=typeof a=="function"?a:Array.isArray(a)?constant(slice.call(a)):constant(a),i):n},i}function Mi(e,r,n){return e=map.call(e,number).sort(ascending),Math.ceil((n-r)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}var wa=x(37620);function Ja(e,r,n,i,a){var s=e*e,c=s*e;return((1-3*e+3*s-c)*r+(4-6*s+3*c)*n+(1+3*e+3*s-3*c)*i+c*a)/6}function La(e){var r=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,r-1):Math.floor(n*r),a=e[i],s=e[i+1],c=i>0?e[i-1]:2*a-s,d=i<r-1?e[i+2]:2*s-a;return Ja((n-i/r)*r,c,a,s,d)}}function ya(e){var r=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*r),a=e[(i+r-1)%r],s=e[i%r],c=e[(i+1)%r],d=e[(i+2)%r];return Ja((n-i/r)*r,a,s,c,d)}}function Gi(e){return function(){return e}}function zn(e,r){return function(n){return e+n*r}}function Fn(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(i){return Math.pow(e+i*r,n)}}function $a(e,r){var n=r-e;return n?zn(e,n>180||n<-180?n-360*Math.round(n/360):n):constant(isNaN(e)?r:e)}function _a(e){return(e=+e)==1?Ra:function(r,n){return n-r?Fn(r,n,e):Gi(isNaN(r)?n:r)}}function Ra(e,r){var n=r-e;return n?zn(e,n):Gi(isNaN(e)?r:e)}var Ma=function e(r){var n=_a(r);function i(a,s){var c=n((a=(0,wa.B8)(a)).r,(s=(0,wa.B8)(s)).r),d=n(a.g,s.g),g=n(a.b,s.b),_=Ra(a.opacity,s.opacity);return function(A){return a.r=c(A),a.g=d(A),a.b=g(A),a.opacity=_(A),a+""}}return i.gamma=e,i}(1);function da(e){return function(r){var n=r.length,i=new Array(n),a=new Array(n),s=new Array(n),c,d;for(c=0;c<n;++c)d=(0,wa.B8)(r[c]),i[c]=d.r||0,a[c]=d.g||0,s[c]=d.b||0;return i=e(i),a=e(a),s=e(s),d.opacity=1,function(g){return d.r=i(g),d.g=a(g),d.b=s(g),d+""}}}var qo=da(La),Xu=da(ya);function ha(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function mo(e){return e.length===1&&(e=Fc(e)),{left:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)<0?i=s+1:a=s}return i},right:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)>0?a=s:i=s+1}return i}}}function Fc(e){return function(r,n){return ha(e(r),n)}}var nu=mo(ha),Cf=nu.right,Zl=nu.left,Os=Cf,rc=Array.prototype,Vl=rc.slice,$f=rc.map,ll=Math.sqrt(50),El=Math.sqrt(10),jl=Math.sqrt(2);function cl(e,r,n){var i,a=-1,s,c,d;if(r=+r,e=+e,n=+n,e===r&&n>0)return[e];if((i=r<e)&&(s=e,e=r,r=s),(d=fl(e,r,n))===0||!isFinite(d))return[];if(d>0)for(e=Math.ceil(e/d),r=Math.floor(r/d),c=new Array(s=Math.ceil(r-e+1));++a<s;)c[a]=(e+a)*d;else for(e=Math.floor(e*d),r=Math.ceil(r*d),c=new Array(s=Math.ceil(e-r+1));++a<s;)c[a]=(e-a)/d;return i&&c.reverse(),c}function fl(e,r,n){var i=(r-e)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,a);return a>=0?(s>=ll?10:s>=El?5:s>=jl?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(s>=ll?10:s>=El?5:s>=jl?2:1)}function _c(e,r,n){var i=Math.abs(r-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/a;return s>=ll?a*=10:s>=El?a*=5:s>=jl&&(a*=2),r<e?-a:a}function Ui(){var e=identity,r=extent,n=sturges;function i(a){var s,c=a.length,d,g=new Array(c);for(s=0;s<c;++s)g[s]=e(a[s],s,a);var _=r(g),A=_[0],C=_[1],N=n(g,A,C);Array.isArray(N)||(N=tickStep(A,C,N),N=range(Math.ceil(A/N)*N,C,N));for(var ae=N.length;N[0]<=A;)N.shift(),--ae;for(;N[ae-1]>C;)N.pop(),--ae;var we=new Array(ae+1),De;for(s=0;s<=ae;++s)De=we[s]=[],De.x0=s>0?N[s-1]:A,De.x1=s<ae?N[s]:C;for(s=0;s<c;++s)d=g[s],A<=d&&d<=C&&we[bisect(N,d,0,ae)].push(a[s]);return we}return i.value=function(a){return arguments.length?(e=typeof a=="function"?a:constant(a),i):e},i.domain=function(a){return arguments.length?(r=typeof a=="function"?a:constant([a[0],a[1]]),i):r},i.thresholds=function(a){return arguments.length?(n=typeof a=="function"?a:Array.isArray(a)?constant(slice.call(a)):constant(a),i):n},i}function mu(e,r,n){return e=map.call(e,number).sort(ascending),Math.ceil((n-r)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}function wf(e){return e===null?NaN:+e}function To(e,r,n){if(n==null&&(n=wf),!!(i=e.length)){if((r=+r)<=0||i<2)return+n(e[0],0,e);if(r>=1)return+n(e[i-1],i-1,e);var i,a=(i-1)*r,s=Math.floor(a),c=+n(e[s],s,e),d=+n(e[s+1],s+1,e);return c+(d-c)*(a-s)}}var ho="$";function Yu(){}Yu.prototype=$l.prototype={constructor:Yu,has:function(e){return ho+e in this},get:function(e){return this[ho+e]},set:function(e,r){return this[ho+e]=r,this},remove:function(e){var r=ho+e;return r in this&&delete this[r]},clear:function(){for(var e in this)e[0]===ho&&delete this[e]},keys:function(){var e=[];for(var r in this)r[0]===ho&&e.push(r.slice(1));return e},values:function(){var e=[];for(var r in this)r[0]===ho&&e.push(this[r]);return e},entries:function(){var e=[];for(var r in this)r[0]===ho&&e.push({key:r.slice(1),value:this[r]});return e},size:function(){var e=0;for(var r in this)r[0]===ho&&++e;return e},empty:function(){for(var e in this)if(e[0]===ho)return!1;return!0},each:function(e){for(var r in this)r[0]===ho&&e(this[r],r.slice(1),this)}};function $l(e,r){var n=new Yu;if(e instanceof Yu)e.each(function(d,g){n.set(g,d)});else if(Array.isArray(e)){var i=-1,a=e.length,s;if(r==null)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(r(s=e[i],i,e),s)}else if(e)for(var c in e)n.set(c,e[c]);return n}var gu=$l;function Hl(){var e=[],r=[],n,i,a;function s(d,g,_,A){if(g>=e.length)return n!=null&&d.sort(n),i!=null?i(d):d;for(var C=-1,N=d.length,ae=e[g++],we,De,at=map(),Ot,Pt=_();++C<N;)(Ot=at.get(we=ae(De=d[C])+""))?Ot.push(De):at.set(we,[De]);return at.each(function(Kt,hr){A(Pt,hr,s(Kt,g,_,A))}),Pt}function c(d,g){if(++g>e.length)return d;var _,A=r[g-1];return i!=null&&g>=e.length?_=d.entries():(_=[],d.each(function(C,N){_.push({key:N,values:c(C,g)})})),A!=null?_.sort(function(C,N){return A(C.key,N.key)}):_}return a={object:function(d){return s(d,0,l,p)},map:function(d){return s(d,0,f,m)},entries:function(d){return c(s(d,0,f,m),0)},key:function(d){return e.push(d),a},sortKeys:function(d){return r[e.length-1]=d,a},sortValues:function(d){return n=d,a},rollup:function(d){return i=d,a}}}function l(){return{}}function p(e,r,n){e[r]=n}function f(){return map()}function m(e,r,n){e.set(r,n)}function E(){}var R=gu.prototype;E.prototype=O.prototype={constructor:E,has:R.has,add:function(e){return e+="",this[ho+e]=e,this},remove:R.remove,clear:R.clear,values:R.keys,size:R.size,empty:R.empty,each:R.each};function O(e,r){var n=new E;if(e instanceof E)e.each(function(s){n.add(s)});else if(e){var i=-1,a=e.length;if(r==null)for(;++i<a;)n.add(e[i]);else for(;++i<a;)n.add(r(e[i],i,e))}return n}var $=null,ge=Array.prototype,Me=ge.map,Ye=ge.slice;function tt(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function ot(e,r){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(r).domain(e);break}return this}var At={name:"implicit"};function St(){var e=gu(),r=[],n=[],i=At;function a(s){var c=s+"",d=e.get(c);if(!d){if(i!==At)return i;e.set(c,d=r.push(s))}return n[(d-1)%n.length]}return a.domain=function(s){if(!arguments.length)return r.slice();r=[],e=gu();for(var c=-1,d=s.length,g,_;++c<d;)e.has(_=(g=s[c])+"")||e.set(_,r.push(g));return a},a.range=function(s){return arguments.length?(n=Ye.call(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return St(r,n).unknown(i)},tt.apply(a,arguments),a}function Zt(){var e=ordinal().unknown(void 0),r=e.domain,n=e.range,i=[0,1],a,s,c=!1,d=0,g=0,_=.5;delete e.unknown;function A(){var C=r().length,N=i[1]<i[0],ae=i[N-0],we=i[1-N];a=(we-ae)/Math.max(1,C-d+g*2),c&&(a=Math.floor(a)),ae+=(we-ae-a*(C-d))*_,s=a*(1-d),c&&(ae=Math.round(ae),s=Math.round(s));var De=sequence(C).map(function(at){return ae+a*at});return n(N?De.reverse():De)}return e.domain=function(C){return arguments.length?(r(C),A()):r()},e.range=function(C){return arguments.length?(i=[+C[0],+C[1]],A()):i.slice()},e.rangeRound=function(C){return i=[+C[0],+C[1]],c=!0,A()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(C){return arguments.length?(c=!!C,A()):c},e.padding=function(C){return arguments.length?(d=Math.min(1,g=+C),A()):d},e.paddingInner=function(C){return arguments.length?(d=Math.min(1,C),A()):d},e.paddingOuter=function(C){return arguments.length?(g=+C,A()):g},e.align=function(C){return arguments.length?(_=Math.max(0,Math.min(1,C)),A()):_},e.copy=function(){return Zt(r(),i).round(c).paddingInner(d).paddingOuter(g).align(_)},initRange.apply(A(),arguments)}function _t(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return _t(r())},e}function Vt(){return _t(Zt.apply(null,arguments).paddingInner(1))}function er(e,r){return(isNumberArray(r)?numberArray:cr)(e,r)}function cr(e,r){var n=r?r.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),s=new Array(n),c;for(c=0;c<i;++c)a[c]=nt(e[c],r[c]);for(;c<n;++c)s[c]=r[c];return function(d){for(c=0;c<i;++c)s[c]=a[c](d);return s}}function Rr(e,r){var n=new Date;return e=+e,r=+r,function(i){return n.setTime(e*(1-i)+r*i),n}}function Er(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function Br(e,r){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?n[a]=nt(e[a],r[a]):i[a]=r[a];return function(s){for(a in n)i[a]=n[a](s);return i}}var tn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,M=new RegExp(tn.source,"g");function k(e){return function(){return e}}function L(e){return function(r){return e(r)+""}}function K(e,r){var n=tn.lastIndex=M.lastIndex=0,i,a,s,c=-1,d=[],g=[];for(e=e+"",r=r+"";(i=tn.exec(e))&&(a=M.exec(r));)(s=a.index)>n&&(s=r.slice(n,s),d[c]?d[c]+=s:d[++c]=s),(i=i[0])===(a=a[0])?d[c]?d[c]+=a:d[++c]=a:(d[++c]=null,g.push({i:c,x:Er(i,a)})),n=M.lastIndex;return n<r.length&&(s=r.slice(n),d[c]?d[c]+=s:d[++c]=s),d.length<2?g[0]?L(g[0].x):k(r):(r=g.length,function(_){for(var A=0,C;A<r;++A)d[(C=g[A]).i]=C.x(_);return d.join("")})}function ie(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,i=r.slice(),a;return function(s){for(a=0;a<n;++a)i[a]=e[a]*(1-s)+r[a]*s;return i}}function ne(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function nt(e,r){var n=typeof r,i;return r==null||n==="boolean"?Gi(r):(n==="number"?Er:n==="string"?(i=(0,wa.ZP)(r))?(r=i,Ma):K:r instanceof wa.ZP?Ma:r instanceof Date?Rr:ne(r)?ie:Array.isArray(r)?cr:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?Br:Er)(e,r)}function rt(e,r){return e=+e,r=+r,function(n){return Math.round(e*(1-n)+r*n)}}function jt(e){return function(){return e}}function ct(e){return+e}var Yt=[0,1];function ar(e){return e}function fn(e,r){return(r-=e=+e)?function(n){return(n-e)/r}:jt(isNaN(r)?NaN:.5)}function on(e){var r=e[0],n=e[e.length-1],i;return r>n&&(i=r,r=n,n=i),function(a){return Math.max(r,Math.min(n,a))}}function Kr(e,r,n){var i=e[0],a=e[1],s=r[0],c=r[1];return a<i?(i=fn(a,i),s=n(c,s)):(i=fn(i,a),s=n(s,c)),function(d){return s(i(d))}}function Gn(e,r,n){var i=Math.min(e.length,r.length)-1,a=new Array(i),s=new Array(i),c=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++c<i;)a[c]=fn(e[c],e[c+1]),s[c]=n(r[c],r[c+1]);return function(d){var g=Os(e,d,1,i)-1;return s[g](a[g](d))}}function Zn(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jn(){var e=Yt,r=Yt,n=nt,i,a,s,c=ar,d,g,_;function A(){return d=Math.min(e.length,r.length)>2?Gn:Kr,g=_=null,C}function C(N){return isNaN(N=+N)?s:(g||(g=d(e.map(i),r,n)))(i(c(N)))}return C.invert=function(N){return c(a((_||(_=d(r,e.map(i),Er)))(N)))},C.domain=function(N){return arguments.length?(e=Me.call(N,ct),c===ar||(c=on(e)),A()):e.slice()},C.range=function(N){return arguments.length?(r=Ye.call(N),A()):r.slice()},C.rangeRound=function(N){return r=Ye.call(N),n=rt,A()},C.clamp=function(N){return arguments.length?(c=N?on(e):ar,C):c!==ar},C.interpolate=function(N){return arguments.length?(n=N,A()):n},C.unknown=function(N){return arguments.length?(s=N,C):s},function(N,ae){return i=N,a=ae,A()}}function vi(e,r){return jn()(e,r)}var Si=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Oi(e){if(!(r=Si.exec(e)))throw new Error("invalid format: "+e);var r;return new Ba({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Oi.prototype=Ba.prototype;function Ba(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ba.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ha(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function go(e,r){if((n=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Ea(e){return e=go(Math.abs(e)),e?e[1]:NaN}function qi(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ea(r)/3)))*3-Ea(Math.abs(e)))}function Sa(e,r){return function(n,i){for(var a=n.length,s=[],c=0,d=e[0],g=0;a>0&&d>0&&(g+d+1>i&&(d=Math.max(1,i-g)),s.push(n.substring(a-=d,a+d)),!((g+=d+1)>i));)d=e[c=(c+1)%e.length];return s.reverse().join(r)}}function Zo(e){return function(r){return r.replace(/[0-9]/g,function(n){return e[+n]})}}function ss(e){e:for(var r=e.length,n=1,i=-1,a;n<r;++n)switch(e[n]){case".":i=a=n;break;case"0":i===0&&(i=n),a=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(a+1):e}var Fo;function Qo(e,r){var n=go(e,r);if(!n)return e+"";var i=n[0],a=n[1],s=a-(Fo=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,c=i.length;return s===c?i:s>c?i+new Array(s-c+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+go(e,Math.max(0,r+s-1))[0]}function Is(e,r){var n=go(e,r);if(!n)return e+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}var iu={"%":function(e,r){return(e*100).toFixed(r)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:Ha,e:function(e,r){return e.toExponential(r)},f:function(e,r){return e.toFixed(r)},g:function(e,r){return e.toPrecision(r)},o:function(e){return Math.round(e).toString(8)},p:function(e,r){return Is(e*100,r)},r:Is,s:Qo,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Iu(e){return e}var ds=Array.prototype.map,Vo=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function yu(e){var r=e.grouping===void 0||e.thousands===void 0?Iu:Sa(ds.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Iu:Zo(ds.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"-":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function _(C){C=Oi(C);var N=C.fill,ae=C.align,we=C.sign,De=C.symbol,at=C.zero,Ot=C.width,Pt=C.comma,Kt=C.precision,hr=C.trim,jr=C.type;jr==="n"?(Pt=!0,jr="g"):iu[jr]||(Kt===void 0&&(Kt=12),hr=!0,jr="g"),(at||N==="0"&&ae==="=")&&(at=!0,N="0",ae="=");var pr=De==="$"?n:De==="#"&&/[boxX]/.test(jr)?"0"+jr.toLowerCase():"",rr=De==="$"?i:/[%p]/.test(jr)?c:"",Ur=iu[jr],$n=/[defgprs%]/.test(jr);Kt=Kt===void 0?6:/[gprs]/.test(jr)?Math.max(1,Math.min(21,Kt)):Math.max(0,Math.min(20,Kt));function Ai(Wn){var Xi=pr,oa=rr,Es,Nu,nl;if(jr==="c")oa=Ur(Wn)+oa,Wn="";else{Wn=+Wn;var Wc=Wn<0||1/Wn<0;if(Wn=isNaN(Wn)?g:Ur(Math.abs(Wn),Kt),hr&&(Wn=ss(Wn)),Wc&&+Wn==0&&we!=="+"&&(Wc=!1),Xi=(Wc?we==="("?we:d:we==="-"||we==="("?"":we)+Xi,oa=(jr==="s"?Vo[8+Fo/3]:"")+oa+(Wc&&we==="("?")":""),$n){for(Es=-1,Nu=Wn.length;++Es<Nu;)if(nl=Wn.charCodeAt(Es),48>nl||nl>57){oa=(nl===46?a+Wn.slice(Es+1):Wn.slice(Es))+oa,Wn=Wn.slice(0,Es);break}}}Pt&&!at&&(Wn=r(Wn,1/0));var Mc=Xi.length+Wn.length+oa.length,ml=Mc<Ot?new Array(Ot-Mc+1).join(N):"";switch(Pt&&at&&(Wn=r(ml+Wn,ml.length?Ot-oa.length:1/0),ml=""),ae){case"<":Wn=Xi+Wn+oa+ml;break;case"=":Wn=Xi+ml+Wn+oa;break;case"^":Wn=ml.slice(0,Mc=ml.length>>1)+Xi+Wn+oa+ml.slice(Mc);break;default:Wn=ml+Xi+Wn+oa;break}return s(Wn)}return Ai.toString=function(){return C+""},Ai}function A(C,N){var ae=_((C=Oi(C),C.type="f",C)),we=Math.max(-8,Math.min(8,Math.floor(Ea(N)/3)))*3,De=Math.pow(10,-we),at=Vo[8+we/3];return function(Ot){return ae(De*Ot)+at}}return{format:_,formatPrefix:A}}var _u,Ku,Oa;Ps({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Ps(e){return _u=yu(e),Ku=_u.format,Oa=_u.formatPrefix,_u}function vs(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Ea(r)-Ea(e))+1}function Wl(e){return Math.max(0,-Ea(Math.abs(e)))}function Hf(e,r,n,i){var a=_c(e,r,n),s;switch(i=Oi(i==null?",f":i),i.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(r));return i.precision==null&&!isNaN(s=qi(a,c))&&(i.precision=s),Oa(i,c)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=vs(a,Math.max(Math.abs(e),Math.abs(r))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=Wl(a))&&(i.precision=s-(i.type==="%")*2);break}}return Ku(i)}function hl(e){var r=e.domain;return e.ticks=function(n){var i=r();return cl(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var a=r();return Hf(a[0],a[a.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=r(),a=0,s=i.length-1,c=i[a],d=i[s],g;return d<c&&(g=c,c=d,d=g,g=a,a=s,s=g),g=fl(c,d,n),g>0?(c=Math.floor(c/g)*g,d=Math.ceil(d/g)*g,g=fl(c,d,n)):g<0&&(c=Math.ceil(c*g)/g,d=Math.floor(d*g)/g,g=fl(c,d,n)),g>0?(i[a]=Math.floor(c/g)*g,i[s]=Math.ceil(d/g)*g,r(i)):g<0&&(i[a]=Math.ceil(c*g)/g,i[s]=Math.floor(d*g)/g,r(i)),e},e}function Wf(){var e=vi(ar,ar);return e.copy=function(){return Zn(e,Wf())},tt.apply(e,arguments),hl(e)}function Nc(e){var r;function n(i){return isNaN(i=+i)?r:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=map.call(i,number),n):e.slice()},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return Nc(e).unknown(r)},e=arguments.length?map.call(e,number):[0,1],linearish(n)}function xc(e,r){e=e.slice();var n=0,i=e.length-1,a=e[n],s=e[i],c;return s<a&&(c=n,n=i,i=c,c=a,a=s,s=c),e[n]=r.floor(a),e[i]=r.ceil(s),e}function pl(e){return Math.log(e)}function Rf(e){return Math.exp(e)}function ep(e){return-Math.log(-e)}function of(e){return-Math.exp(-e)}function xu(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Pp(e){return e===10?xu:e===Math.E?Math.exp:function(r){return Math.pow(e,r)}}function kp(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(r){return Math.log(r)/e})}function Mf(e){return function(r){return-e(-r)}}function dd(e){var r=e(pl,Rf),n=r.domain,i=10,a,s;function c(){return a=kp(i),s=Pp(i),n()[0]<0?(a=Mf(a),s=Mf(s),e(ep,of)):e(pl,Rf),r}return r.base=function(d){return arguments.length?(i=+d,c()):i},r.domain=function(d){return arguments.length?(n(d),c()):n()},r.ticks=function(d){var g=n(),_=g[0],A=g[g.length-1],C;(C=A<_)&&(N=_,_=A,A=N);var N=a(_),ae=a(A),we,De,at,Ot=d==null?10:+d,Pt=[];if(!(i%1)&&ae-N<Ot){if(N=Math.round(N)-1,ae=Math.round(ae)+1,_>0){for(;N<ae;++N)for(De=1,we=s(N);De<i;++De)if(at=we*De,!(at<_)){if(at>A)break;Pt.push(at)}}else for(;N<ae;++N)for(De=i-1,we=s(N);De>=1;--De)if(at=we*De,!(at<_)){if(at>A)break;Pt.push(at)}}else Pt=cl(N,ae,Math.min(ae-N,Ot)).map(s);return C?Pt.reverse():Pt},r.tickFormat=function(d,g){if(g==null&&(g=i===10?".0e":","),typeof g!="function"&&(g=Ku(g)),d===1/0)return g;d==null&&(d=10);var _=Math.max(1,i*d/r.ticks().length);return function(A){var C=A/s(Math.round(a(A)));return C*i<i-.5&&(C*=i),C<=_?g(A):""}},r.nice=function(){return n(xc(n(),{floor:function(d){return s(Math.floor(a(d)))},ceil:function(d){return s(Math.ceil(a(d)))}}))},r}function Dp(){var e=dd(jn()).domain([1,10]);return e.copy=function(){return Zn(e,Dp()).base(e.base())},tt.apply(e,arguments),e}function Lp(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function hh(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function vd(e){var r=1,n=e(Lp(r),hh(r));return n.constant=function(i){return arguments.length?e(Lp(r=+i),hh(r)):r},linearish(n)}function Ih(){var e=vd(transformer());return e.copy=function(){return copy(e,Ih()).constant(e.constant())},initRange.apply(e,arguments)}function tp(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function sf(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ph(e){return e<0?-e*e:e*e}function md(e){var r=e(ar,ar),n=1;function i(){return n===1?e(ar,ar):n===.5?e(sf,ph):e(tp(n),tp(1/n))}return r.exponent=function(a){return arguments.length?(n=+a,i()):n},hl(r)}function rp(){var e=md(jn());return e.copy=function(){return Zn(e,rp()).exponent(e.exponent())},tt.apply(e,arguments),e}function pv(){return rp.apply(null,arguments).exponent(.5)}function Bp(){var e=[],r=[],n=[],i;function a(){var c=0,d=Math.max(1,r.length);for(n=new Array(d-1);++c<d;)n[c-1]=To(e,c/d);return s}function s(c){return isNaN(c=+c)?i:r[Os(n,c)]}return s.invertExtent=function(c){var d=r.indexOf(c);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},s.domain=function(c){if(!arguments.length)return e.slice();e=[];for(var d=0,g=c.length,_;d<g;++d)_=c[d],_!=null&&!isNaN(_=+_)&&e.push(_);return e.sort(ha),a()},s.range=function(c){return arguments.length?(r=Ye.call(c),a()):r.slice()},s.unknown=function(c){return arguments.length?(i=c,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return Bp().domain(e).range(r).unknown(i)},tt.apply(s,arguments)}function Fp(){var e=0,r=1,n=1,i=[.5],a=[0,1],s;function c(g){return g<=g?a[Os(i,g,0,n)]:s}function d(){var g=-1;for(i=new Array(n);++g<n;)i[g]=((g+1)*r-(g-n)*e)/(n+1);return c}return c.domain=function(g){return arguments.length?(e=+g[0],r=+g[1],d()):[e,r]},c.range=function(g){return arguments.length?(n=(a=Ye.call(g)).length-1,d()):a.slice()},c.invertExtent=function(g){var _=a.indexOf(g);return _<0?[NaN,NaN]:_<1?[e,i[0]]:_>=n?[i[n-1],r]:[i[_-1],i[_]]},c.unknown=function(g){return arguments.length&&(s=g),c},c.thresholds=function(){return i.slice()},c.copy=function(){return Fp().domain([e,r]).range(a).unknown(s)},tt.apply(hl(c),arguments)}function Ph(){var e=[.5],r=[0,1],n,i=1;function a(s){return s<=s?r[Os(e,s,0,i)]:n}return a.domain=function(s){return arguments.length?(e=Ye.call(s),i=Math.min(e.length,r.length-1),a):e.slice()},a.range=function(s){return arguments.length?(r=Ye.call(s),i=Math.min(e.length,r.length-1),a):r.slice()},a.invertExtent=function(s){var c=r.indexOf(s);return[e[c-1],e[c]]},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return Ph().domain(e).range(r).unknown(n)},tt.apply(a,arguments)}var Gf=new Date,uf=new Date;function au(e,r,n,i){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return e(s=new Date(+s)),s},a.ceil=function(s){return e(s=new Date(s-1)),r(s,1),e(s),s},a.round=function(s){var c=a(s),d=a.ceil(s);return s-c<d-s?c:d},a.offset=function(s,c){return r(s=new Date(+s),c==null?1:Math.floor(c)),s},a.range=function(s,c,d){var g=[],_;if(s=a.ceil(s),d=d==null?1:Math.floor(d),!(s<c)||!(d>0))return g;do g.push(_=new Date(+s)),r(s,d),e(s);while(_<s&&s<c);return g},a.filter=function(s){return au(function(c){if(c>=c)for(;e(c),!s(c);)c.setTime(c-1)},function(c,d){if(c>=c)if(d<0)for(;++d<=0;)for(;r(c,-1),!s(c););else for(;--d>=0;)for(;r(c,1),!s(c););})},n&&(a.count=function(s,c){return Gf.setTime(+s),uf.setTime(+c),e(Gf),e(uf),Math.floor(n(Gf,uf))},a.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(i?function(c){return i(c)%s===0}:function(c){return a.count(0,c)%s===0}):a}),a}var bc=au(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r)},function(e,r){return r.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});bc.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:au(function(r){r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,n){r.setFullYear(r.getFullYear()+n*e)})};var Uc=bc,Jo=bc.range,lf=au(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,r){e.setMonth(e.getMonth()+r)},function(e,r){return r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),kh=lf,Xf=lf.range,Ec=1e3,Gl=6e4,Of=36e5,If=864e5,Sc=6048e5;function Sl(e){return au(function(r){r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},function(r,n){r.setDate(r.getDate()+n*7)},function(r,n){return(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*Gl)/Sc})}var zc=Sl(0),dh=Sl(1),Zc=Sl(2),Pf=Sl(3),Vc=Sl(4),np=Sl(5),ip=Sl(6),Np=zc.range,Tc=dh.range,kf=Zc.range,gd=Pf.range,yd=Vc.range,_d=np.range,xd=ip.range,cf=au(function(e){e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Gl)/If},function(e){return e.getDate()-1}),ap=cf,jc=cf.range,Dh=au(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ec-e.getMinutes()*Gl)},function(e,r){e.setTime(+e+r*Of)},function(e,r){return(r-e)/Of},function(e){return e.getHours()}),Df=Dh,Lf=Dh.range,op=au(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ec)},function(e,r){e.setTime(+e+r*Gl)},function(e,r){return(r-e)/Gl},function(e){return e.getMinutes()}),ff=op,sp=op.range,vh=au(function(e){e.setTime(e-e.getMilliseconds())},function(e,r){e.setTime(+e+r*Ec)},function(e,r){return(r-e)/Ec},function(e){return e.getUTCSeconds()}),bu=vh,Eu=vh.range,es=au(function(){},function(e,r){e.setTime(+e+r)},function(e,r){return r-e});es.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?au(function(r){r.setTime(Math.floor(r/e)*e)},function(r,n){r.setTime(+r+n*e)},function(r,n){return(n-r)/e}):es};var dl=es,bd=es.range;function nc(e){return au(function(r){r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCDate(r.getUTCDate()+n*7)},function(r,n){return(n-r)/Sc})}var up=nc(0),Lh=nc(1),Ed=nc(2),Up=nc(3),Yf=nc(4),zp=nc(5),Su=nc(6),dv=up.range,Sd=Lh.range,Zp=Ed.range,Td=Up.range,Vp=Yf.range,vv=zp.range,mv=Su.range,lp=au(function(e){e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r)},function(e,r){return(r-e)/If},function(e){return e.getUTCDate()-1}),cp=lp,me=lp.range,ht=au(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r)},function(e,r){return r.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ht.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:au(function(r){r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCFullYear(r.getUTCFullYear()+n*e)})};var Lt=ht,wr=ht.range;function qr(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Cr(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function fr(e,r,n){return{y:e,m:r,d:n,H:0,M:0,S:0,L:0}}function Mn(e){var r=e.dateTime,n=e.date,i=e.time,a=e.periods,s=e.days,c=e.shortDays,d=e.months,g=e.shortMonths,_=Ln(a),A=sr(a),C=Ln(s),N=sr(s),ae=Ln(c),we=sr(c),De=Ln(d),at=sr(d),Ot=Ln(g),Pt=sr(g),Kt={a:Wc,A:Mc,b:ml,B:xf,c:null,d:Wa,e:Wa,f:Ro,g:Ta,G:ys,H:ms,I:js,j:Ia,L:us,m:Ss,M:Ts,p:Wm,q:IE,Q:an,s:En,S:Go,u:ks,U:ou,V:la,w:Ys,W:io,x:null,X:null,y:Zi,Y:Ga,Z:ic,"%":mn},hr={a:PE,A:kE,b:DE,B:LE,c:null,d:Ct,e:Ct,f:yo,g:mt,G:Ir,H:Mr,I:yr,j:ai,L:ca,m:Ke,M:yt,p:BE,q:FE,Q:an,s:En,S:Nt,u:br,U:mr,V:Jt,w:tr,W:Mt,x:null,X:null,y:Xt,Y:Qt,Z:zr,"%":mn},jr={a:Ai,A:Wn,b:Xi,B:oa,c:Es,d:ea,e:ea,f:ri,g:Qn,G:An,H:Cn,I:Cn,j:Yn,L:va,m:ki,M:Jr,p:$n,q:Xn,Q:ta,s:Wi,S:Di,u:On,U:qn,V:hn,w:Fr,W:ti,x:Nu,X:nl,y:Qn,Y:An,Z:dn,"%":pa};Kt.x=pr(n,Kt),Kt.X=pr(i,Kt),Kt.c=pr(r,Kt),hr.x=pr(n,hr),hr.X=pr(i,hr),hr.c=pr(r,hr);function pr(Ji,bo){return function(zo){var ci=[],Oc=-1,Cs=0,Gc=Ji.length,Xc,Ip,f0;for(zo instanceof Date||(zo=new Date(+zo));++Oc<Gc;)Ji.charCodeAt(Oc)===37&&(ci.push(Ji.slice(Cs,Oc)),(Ip=gn[Xc=Ji.charAt(++Oc)])!=null?Xc=Ji.charAt(++Oc):Ip=Xc==="e"?" ":"0",(f0=bo[Xc])&&(Xc=f0(zo,Ip)),ci.push(Xc),Cs=Oc+1);return ci.push(Ji.slice(Cs,Oc)),ci.join("")}}function rr(Ji,bo){return function(zo){var ci=fr(1900,void 0,1),Oc=Ur(ci,Ji,zo+="",0),Cs,Gc;if(Oc!=zo.length)return null;if("Q"in ci)return new Date(ci.Q);if("s"in ci)return new Date(ci.s*1e3+("L"in ci?ci.L:0));if(bo&&!("Z"in ci)&&(ci.Z=0),"p"in ci&&(ci.H=ci.H%12+ci.p*12),ci.m===void 0&&(ci.m="q"in ci?ci.q:0),"V"in ci){if(ci.V<1||ci.V>53)return null;"w"in ci||(ci.w=1),"Z"in ci?(Cs=Cr(fr(ci.y,0,1)),Gc=Cs.getUTCDay(),Cs=Gc>4||Gc===0?Lh.ceil(Cs):Lh(Cs),Cs=cp.offset(Cs,(ci.V-1)*7),ci.y=Cs.getUTCFullYear(),ci.m=Cs.getUTCMonth(),ci.d=Cs.getUTCDate()+(ci.w+6)%7):(Cs=qr(fr(ci.y,0,1)),Gc=Cs.getDay(),Cs=Gc>4||Gc===0?dh.ceil(Cs):dh(Cs),Cs=ap.offset(Cs,(ci.V-1)*7),ci.y=Cs.getFullYear(),ci.m=Cs.getMonth(),ci.d=Cs.getDate()+(ci.w+6)%7)}else("W"in ci||"U"in ci)&&("w"in ci||(ci.w="u"in ci?ci.u%7:"W"in ci?1:0),Gc="Z"in ci?Cr(fr(ci.y,0,1)).getUTCDay():qr(fr(ci.y,0,1)).getDay(),ci.m=0,ci.d="W"in ci?(ci.w+6)%7+ci.W*7-(Gc+5)%7:ci.w+ci.U*7-(Gc+6)%7);return"Z"in ci?(ci.H+=ci.Z/100|0,ci.M+=ci.Z%100,Cr(ci)):qr(ci)}}function Ur(Ji,bo,zo,ci){for(var Oc=0,Cs=bo.length,Gc=zo.length,Xc,Ip;Oc<Cs;){if(ci>=Gc)return-1;if(Xc=bo.charCodeAt(Oc++),Xc===37){if(Xc=bo.charAt(Oc++),Ip=jr[Xc in gn?bo.charAt(Oc++):Xc],!Ip||(ci=Ip(Ji,zo,ci))<0)return-1}else if(Xc!=zo.charCodeAt(ci++))return-1}return ci}function $n(Ji,bo,zo){var ci=_.exec(bo.slice(zo));return ci?(Ji.p=A[ci[0].toLowerCase()],zo+ci[0].length):-1}function Ai(Ji,bo,zo){var ci=ae.exec(bo.slice(zo));return ci?(Ji.w=we[ci[0].toLowerCase()],zo+ci[0].length):-1}function Wn(Ji,bo,zo){var ci=C.exec(bo.slice(zo));return ci?(Ji.w=N[ci[0].toLowerCase()],zo+ci[0].length):-1}function Xi(Ji,bo,zo){var ci=Ot.exec(bo.slice(zo));return ci?(Ji.m=Pt[ci[0].toLowerCase()],zo+ci[0].length):-1}function oa(Ji,bo,zo){var ci=De.exec(bo.slice(zo));return ci?(Ji.m=at[ci[0].toLowerCase()],zo+ci[0].length):-1}function Es(Ji,bo,zo){return Ur(Ji,r,bo,zo)}function Nu(Ji,bo,zo){return Ur(Ji,n,bo,zo)}function nl(Ji,bo,zo){return Ur(Ji,i,bo,zo)}function Wc(Ji){return c[Ji.getDay()]}function Mc(Ji){return s[Ji.getDay()]}function ml(Ji){return g[Ji.getMonth()]}function xf(Ji){return d[Ji.getMonth()]}function Wm(Ji){return a[+(Ji.getHours()>=12)]}function IE(Ji){return 1+~~(Ji.getMonth()/3)}function PE(Ji){return c[Ji.getUTCDay()]}function kE(Ji){return s[Ji.getUTCDay()]}function DE(Ji){return g[Ji.getUTCMonth()]}function LE(Ji){return d[Ji.getUTCMonth()]}function BE(Ji){return a[+(Ji.getUTCHours()>=12)]}function FE(Ji){return 1+~~(Ji.getUTCMonth()/3)}return{format:function(Ji){var bo=pr(Ji+="",Kt);return bo.toString=function(){return Ji},bo},parse:function(Ji){var bo=rr(Ji+="",!1);return bo.toString=function(){return Ji},bo},utcFormat:function(Ji){var bo=pr(Ji+="",hr);return bo.toString=function(){return Ji},bo},utcParse:function(Ji){var bo=rr(Ji+="",!0);return bo.toString=function(){return Ji},bo}}}var gn={"-":"",_:" ",0:"0"},yn=/^\s*\d+/,Pn=/^%/,Un=/[\\^$*+?|[\]().{}]/g;function un(e,r,n){var i=e<0?"-":"",a=(i?-e:e)+"",s=a.length;return i+(s<n?new Array(n-s+1).join(r)+a:a)}function Sn(e){return e.replace(Un,"\\$&")}function Ln(e){return new RegExp("^(?:"+e.map(Sn).join("|")+")","i")}function sr(e){for(var r={},n=-1,i=e.length;++n<i;)r[e[n].toLowerCase()]=n;return r}function Fr(e,r,n){var i=yn.exec(r.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function On(e,r,n){var i=yn.exec(r.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function qn(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function hn(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function ti(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function An(e,r,n){var i=yn.exec(r.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function Qn(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function dn(e,r,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Xn(e,r,n){var i=yn.exec(r.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function ki(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ea(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function Yn(e,r,n){var i=yn.exec(r.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function Cn(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function Jr(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function Di(e,r,n){var i=yn.exec(r.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function va(e,r,n){var i=yn.exec(r.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ri(e,r,n){var i=yn.exec(r.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function pa(e,r,n){var i=Pn.exec(r.slice(n,n+1));return i?n+i[0].length:-1}function ta(e,r,n){var i=yn.exec(r.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Wi(e,r,n){var i=yn.exec(r.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function Wa(e,r){return un(e.getDate(),r,2)}function ms(e,r){return un(e.getHours(),r,2)}function js(e,r){return un(e.getHours()%12||12,r,2)}function Ia(e,r){return un(1+ap.count(Uc(e),e),r,3)}function us(e,r){return un(e.getMilliseconds(),r,3)}function Ro(e,r){return us(e,r)+"000"}function Ss(e,r){return un(e.getMonth()+1,r,2)}function Ts(e,r){return un(e.getMinutes(),r,2)}function Go(e,r){return un(e.getSeconds(),r,2)}function ks(e){var r=e.getDay();return r===0?7:r}function ou(e,r){return un(zc.count(Uc(e)-1,e),r,2)}function gs(e){var r=e.getDay();return r>=4||r===0?Vc(e):Vc.ceil(e)}function la(e,r){return e=gs(e),un(Vc.count(Uc(e),e)+(Uc(e).getDay()===4),r,2)}function Ys(e){return e.getDay()}function io(e,r){return un(dh.count(Uc(e)-1,e),r,2)}function Zi(e,r){return un(e.getFullYear()%100,r,2)}function Ta(e,r){return e=gs(e),un(e.getFullYear()%100,r,2)}function Ga(e,r){return un(e.getFullYear()%1e4,r,4)}function ys(e,r){var n=e.getDay();return e=n>=4||n===0?Vc(e):Vc.ceil(e),un(e.getFullYear()%1e4,r,4)}function ic(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+un(r/60|0,"0",2)+un(r%60,"0",2)}function Ct(e,r){return un(e.getUTCDate(),r,2)}function Mr(e,r){return un(e.getUTCHours(),r,2)}function yr(e,r){return un(e.getUTCHours()%12||12,r,2)}function ai(e,r){return un(1+cp.count(Lt(e),e),r,3)}function ca(e,r){return un(e.getUTCMilliseconds(),r,3)}function yo(e,r){return ca(e,r)+"000"}function Ke(e,r){return un(e.getUTCMonth()+1,r,2)}function yt(e,r){return un(e.getUTCMinutes(),r,2)}function Nt(e,r){return un(e.getUTCSeconds(),r,2)}function br(e){var r=e.getUTCDay();return r===0?7:r}function mr(e,r){return un(up.count(Lt(e)-1,e),r,2)}function Ht(e){var r=e.getUTCDay();return r>=4||r===0?Yf(e):Yf.ceil(e)}function Jt(e,r){return e=Ht(e),un(Yf.count(Lt(e),e)+(Lt(e).getUTCDay()===4),r,2)}function tr(e){return e.getUTCDay()}function Mt(e,r){return un(Lh.count(Lt(e)-1,e),r,2)}function Xt(e,r){return un(e.getUTCFullYear()%100,r,2)}function mt(e,r){return e=Ht(e),un(e.getUTCFullYear()%100,r,2)}function Qt(e,r){return un(e.getUTCFullYear()%1e4,r,4)}function Ir(e,r){var n=e.getUTCDay();return e=n>=4||n===0?Yf(e):Yf.ceil(e),un(e.getUTCFullYear()%1e4,r,4)}function zr(){return"+0000"}function mn(){return"%"}function an(e){return+e}function En(e){return Math.floor(+e/1e3)}var mi,hi,_i,Vi,Qi;ao({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ao(e){return mi=Mn(e),hi=mi.format,_i=mi.parse,Vi=mi.utcFormat,Qi=mi.utcParse,mi}var Xo=1e3,qu=Xo*60,Bf=qu*60,Pu=Bf*24,jp=Pu*7,Ac=Pu*30,mh=Pu*365;function gv(e){return new Date(e)}function yv(e){return e instanceof Date?+e:+new Date(+e)}function Ad(e,r,n,i,a,s,c,d,g){var _=vi(ar,ar),A=_.invert,C=_.domain,N=g(".%L"),ae=g(":%S"),we=g("%I:%M"),De=g("%I %p"),at=g("%a %d"),Ot=g("%b %d"),Pt=g("%B"),Kt=g("%Y"),hr=[[c,1,Xo],[c,5,5*Xo],[c,15,15*Xo],[c,30,30*Xo],[s,1,qu],[s,5,5*qu],[s,15,15*qu],[s,30,30*qu],[a,1,Bf],[a,3,3*Bf],[a,6,6*Bf],[a,12,12*Bf],[i,1,Pu],[i,2,2*Pu],[n,1,jp],[r,1,Ac],[r,3,3*Ac],[e,1,mh]];function jr(rr){return(c(rr)<rr?N:s(rr)<rr?ae:a(rr)<rr?we:i(rr)<rr?De:r(rr)<rr?n(rr)<rr?at:Ot:e(rr)<rr?Pt:Kt)(rr)}function pr(rr,Ur,$n,Ai){if(rr==null&&(rr=10),typeof rr=="number"){var Wn=Math.abs($n-Ur)/rr,Xi=mo(function(oa){return oa[2]}).right(hr,Wn);Xi===hr.length?(Ai=_c(Ur/mh,$n/mh,rr),rr=e):Xi?(Xi=hr[Wn/hr[Xi-1][2]<hr[Xi][2]/Wn?Xi-1:Xi],Ai=Xi[1],rr=Xi[0]):(Ai=Math.max(_c(Ur,$n,rr),1),rr=d)}return Ai==null?rr:rr.every(Ai)}return _.invert=function(rr){return new Date(A(rr))},_.domain=function(rr){return arguments.length?C(Me.call(rr,yv)):C().map(gv)},_.ticks=function(rr,Ur){var $n=C(),Ai=$n[0],Wn=$n[$n.length-1],Xi=Wn<Ai,oa;return Xi&&(oa=Ai,Ai=Wn,Wn=oa),oa=pr(rr,Ai,Wn,Ur),oa=oa?oa.range(Ai,Wn+1):[],Xi?oa.reverse():oa},_.tickFormat=function(rr,Ur){return Ur==null?jr:g(Ur)},_.nice=function(rr,Ur){var $n=C();return(rr=pr(rr,$n[0],$n[$n.length-1],Ur))?C(xc($n,rr)):_},_.copy=function(){return Zn(_,Ad(e,r,n,i,a,s,c,d,g))},_}function $p(){return tt.apply(Ad(Uc,kh,zc,ap,Df,ff,bu,dl,hi).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Bh(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Fh(){var e=0,r=1,n,i,a,s,c=ar,d=!1,g;function _(A){return isNaN(A=+A)?g:c(a===0?.5:(A=(s(A)-n)*a,d?Math.max(0,Math.min(1,A)):A))}return _.domain=function(A){return arguments.length?(n=s(e=+A[0]),i=s(r=+A[1]),a=n===i?0:1/(i-n),_):[e,r]},_.clamp=function(A){return arguments.length?(d=!!A,_):d},_.interpolator=function(A){return arguments.length?(c=A,_):c},_.unknown=function(A){return arguments.length?(g=A,_):g},function(A){return s=A,n=A(e),i=A(r),a=n===i?0:1/(i-n),_}}function hf(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Cd(){var e=hl(Fh()(ar));return e.copy=function(){return hf(e,Cd())},ot.apply(e,arguments)}function Ds(){var e=loggish(Fh()).domain([1,10]);return e.copy=function(){return hf(e,Ds()).base(e.base())},initInterpolator.apply(e,arguments)}function jo(){var e=symlogish(Fh());return e.copy=function(){return hf(e,jo()).constant(e.constant())},initInterpolator.apply(e,arguments)}function wd(){var e=powish(Fh());return e.copy=function(){return hf(e,wd()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function vm(){return wd.apply(null,arguments).exponent(.5)}function _v(){var e=[],r=identity;function n(i){if(!isNaN(i=+i))return r((bisect(e,i)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(var a=0,s=i.length,c;a<s;++a)c=i[a],c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ascending),n},n.interpolator=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return _v(r).domain(e)},initInterpolator.apply(n,arguments)}function fp(){var e=0,r=.5,n=1,i,a,s,c,d,g=ar,_,A=!1,C;function N(ae){return isNaN(ae=+ae)?C:(ae=.5+((ae=+_(ae))-a)*(ae<a?c:d),g(A?Math.max(0,Math.min(1,ae)):ae))}return N.domain=function(ae){return arguments.length?(i=_(e=+ae[0]),a=_(r=+ae[1]),s=_(n=+ae[2]),c=i===a?0:.5/(a-i),d=a===s?0:.5/(s-a),N):[e,r,n]},N.clamp=function(ae){return arguments.length?(A=!!ae,N):A},N.interpolator=function(ae){return arguments.length?(g=ae,N):g},N.unknown=function(ae){return arguments.length?(C=ae,N):C},function(ae){return _=ae,i=ae(e),a=ae(r),s=ae(n),c=i===a?0:.5/(a-i),d=a===s?0:.5/(s-a),N}}function Rd(){var e=hl(fp()(ar));return e.copy=function(){return hf(e,Rd())},ot.apply(e,arguments)}function Md(){var e=loggish(fp()).domain([.1,1,10]);return e.copy=function(){return copy(e,Md()).base(e.base())},initInterpolator.apply(e,arguments)}function gh(){var e=symlogish(fp());return e.copy=function(){return copy(e,gh()).constant(e.constant())},initInterpolator.apply(e,arguments)}function Kf(){var e=powish(fp());return e.copy=function(){return copy(e,Kf()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function mm(){return Kf.apply(null,arguments).exponent(.5)}function As(e){var r,n=[];function i(a){return a==null?r:a}return i.invert=i,i.domain=i.range=function(a){return a?(n=a,a):n},i.unknown=function(a){return a?(r=a,a):r},i.copy=function(){return As(e).unknown(r)},i}var Qu,$c=ke.rU.isNil,Hp=ke.rU.isString,Wp=ke.rU.uniq,Od=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Nh=(Qu={},(0,ue.Z)(Qu,Y.vY.LINEAR,Wf),(0,ue.Z)(Qu,Y.vY.POWER,rp),(0,ue.Z)(Qu,Y.vY.LOG,Dp),(0,ue.Z)(Qu,Y.vY.IDENTITY,As),(0,ue.Z)(Qu,Y.vY.SEQUENTIAL,Cd),(0,ue.Z)(Qu,Y.vY.TIME,$p),(0,ue.Z)(Qu,Y.vY.QUANTILE,Bp),(0,ue.Z)(Qu,Y.vY.QUANTIZE,Fp),(0,ue.Z)(Qu,Y.vY.THRESHOLD,Ph),(0,ue.Z)(Qu,Y.vY.CAT,St),(0,ue.Z)(Qu,Y.vY.DIVERGING,Rd),Qu),Ff=function(){function e(){(0,Ue.Z)(this,e),(0,ue.Z)(this,"scaleOptions",{})}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("FeatureScalePlugin",(0,qe.Z)(Pe().mark(function c(){var d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(n.log(Y.Or.ScaleInitStart,Y.KD.INIT),a.scaleOptions=n.getScaleOptions(),g=s.getLayerStyleAttributes(),_=(d=n.getSource())===null||d===void 0?void 0:d.data.dataArray,!(Array.isArray(_)&&_.length===0)){C.next=8;break}return C.abrupt("return");case 8:a.caculateScalesForAttributes(g||[],_);case 9:n.log(Y.Or.ScaleInitEnd,Y.KD.INIT);case 10:case"end":return C.stop()}},c)}))),n.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var c=(0,qe.Z)(Pe().mark(function d(g){var _,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(g){N.next=2;break}return N.abrupt("return",g);case 2:if(n.log(Y.Or.ScaleInitStart,Y.KD.UPDATE),a.scaleOptions=n.getScaleOptions(),_=s.getLayerStyleAttributes(),A=n.getSource().data.dataArray,!(Array.isArray(A)&&A.length===0)){N.next=8;break}return N.abrupt("return",!0);case 8:return a.caculateScalesForAttributes(_||[],A),n.log(Y.Or.ScaleInitEnd,Y.KD.UPDATE),n.layerModelNeedUpdate=!0,N.abrupt("return",!0);case 12:case"end":return N.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),n.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!n.layerModelNeedUpdate){a.scaleOptions=n.getScaleOptions();var c=s.getLayerStyleAttributes(),d=n.getSource().data.dataArray;if(!(Array.isArray(d)&&d.length===0)&&c){var g=c.filter(function(_){return _.needRescale});g.length&&a.caculateScalesForAttributes(g,d)}}})}},{key:"isNumber",value:function(n){return!isNaN(parseFloat(n))&&isFinite(n)}},{key:"caculateScalesForAttributes",value:function(n,i){var a=this;n.forEach(function(s){if(s.scale){var c=s.scale,d=s.scale.field;c.names=a.parseFields($c(d)?[]:d);var g=[];c.names.forEach(function(_){var A;g.push(a.createScale(_,s.name,(A=s.scale)===null||A===void 0?void 0:A.values,i))}),g.some(function(_){return _.type===Y.ee.VARIABLE})?(c.type=Y.ee.VARIABLE,g.forEach(function(_){if(!c.callback&&c.values!=="text"){var A;switch((A=_.option)===null||A===void 0?void 0:A.type){case Y.vY.LOG:case Y.vY.LINEAR:case Y.vY.POWER:if(c.values&&c.values.length>2){var C=_.scale.ticks(c.values.length);_.scale.domain(C)}c.values?_.scale.range(c.values):_.scale.range(_.option.domain);break;case Y.vY.QUANTILE:case Y.vY.QUANTIZE:case Y.vY.THRESHOLD:_.scale.range(c.values);break;case Y.vY.IDENTITY:break;case Y.vY.CAT:c.values?_.scale.range(c.values):_.scale.range(_.option.domain);break;case Y.vY.DIVERGING:case Y.vY.SEQUENTIAL:_.scale.interpolator(qo(c.values));break}}if(c.values==="text"){var N;_.scale.range((N=_.option)===null||N===void 0?void 0:N.domain)}})):(c.type=Y.ee.CONSTANT,c.defaultValues=g.map(function(_,A){return _.scale(c.names[A])})),c.scalers=g.map(function(_){return{field:_.field,func:_.scale,option:_.option}}),s.needRescale=!1}})}},{key:"parseFields",value:function(n){return Array.isArray(n)?n:Hp(n)?n.split("*"):[n]}},{key:"createScale",value:function(n,i,a,s){var c,d,g=this.scaleOptions[i]&&((c=this.scaleOptions[i])===null||c===void 0?void 0:c.field)===n?this.scaleOptions[i]:this.scaleOptions[n],_={field:n,scale:void 0,type:Y.ee.VARIABLE,option:g};if(!s||!s.length)return g&&g.type?_.scale=this.createDefaultScale(g):(_.scale=St([n]),_.type=Y.ee.CONSTANT),_;var A=(d=s.find(function(ae){return!$c(ae[n])}))===null||d===void 0?void 0:d[n];if(this.isNumber(n)||$c(A)&&!g)_.scale=St([n]),_.type=Y.ee.CONSTANT;else{var C=g&&g.type||this.getDefaultType(A);a==="text"&&(C=Y.vY.CAT),a===void 0&&(C=Y.vY.IDENTITY);var N=this.createScaleConfig(C,n,g,s);_.scale=this.createDefaultScale(N),_.option=N}return _}},{key:"getDefaultType",value:function(n){var i=Y.vY.LINEAR;return typeof n=="string"&&(i=Od.test(n)?Y.vY.TIME:Y.vY.CAT),i}},{key:"createScaleConfig",value:function(n,i,a,s){var c={type:n},d=[];if(n===Y.vY.QUANTILE){var g=new Map;s==null||s.forEach(function(C){g.set(C._id,C[i])}),d=Array.from(g.values())}else d=(s==null?void 0:s.map(function(C){return C[i]}))||[];if(a!=null&&a.domain)c.domain=a==null?void 0:a.domain;else if(n===Y.vY.CAT||n===Y.vY.IDENTITY)c.domain=Wp(d);else if(n===Y.vY.QUANTILE)c.domain=d;else if(n===Y.vY.DIVERGING){var _=dt(d),A=(a==null?void 0:a.neutral)!==void 0?a==null?void 0:a.neutral:(_[0]+_[1])/2;c.domain=[_[0],A,_[1]]}else c.domain=dt(d);return(0,de.Z)((0,de.Z)({},c),a)}},{key:"createDefaultScale",value:function(n){var i=n.type,a=n.domain,s=n.unknown,c=n.clamp,d=n.nice,g=Nh[i]();return a&&g.domain&&g.domain(a),s&&g.unknown(s),c!==void 0&&g.clamp&&g.clamp(c),d!==void 0&&g.nice&&g.nice(d),g}}]),e}(),xv=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var i=n.animateStatus;i&&n.models.forEach(function(a){a.addUniforms((0,de.Z)({},n.layerModel.getAnimateUniforms()))})})}}]),e}(),bv=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){n.hooks.afterInit.tap("LayerMaskPlugin",function(){var i=n.getLayerConfig(),a=i.maskLayers,s=i.enableMask;!n.tileLayer&&a&&a.length>0&&n.updateLayerConfig({mask:s})})}}]),e}(),gm=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"build",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a.prepareBuildModel(),c.next=3,a.buildModels();case 3:case"end":return c.stop()}},i)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"initLayerModel",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.build(a);case 2:a.styleNeedUpdate=!1;case 3:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"prepareLayerModel",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.build(a);case 2:a.styleNeedUpdate=!1;case 3:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"apply",value:function(n){var i=this;n.hooks.init.tapPromise("LayerModelPlugin",(0,qe.Z)(Pe().mark(function a(){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!n.getSource().isTile){c.next=3;break}return n.prepareBuildModel(),c.abrupt("return");case 3:return n.log(Y.Or.BuildModelStart,Y.KD.INIT),c.next=6,i.initLayerModel(n);case 6:n.log(Y.Or.BuildModelEnd,Y.KD.INIT);case 7:case"end":return c.stop()}},a)}))),n.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var a=(0,qe.Z)(Pe().mark(function s(c){return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(c){g.next=2;break}return g.abrupt("return",!1);case 2:if(!n.getSource().isTile){g.next=4;break}return g.abrupt("return",!1);case 4:return n.log(Y.Or.BuildModelStart,Y.KD.UPDATE),g.next=7,i.prepareLayerModel(n);case 7:return n.log(Y.Or.BuildModelEnd,Y.KD.UPDATE),g.abrupt("return",!0);case 9:case"end":return g.stop()}},s)}));return function(s){return a.apply(this,arguments)}}())}}]),e}(),Ks=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){n.hooks.afterInit.tap("LayerStylePlugin",function(){var i=n.getLayerConfig(),a=i.autoFit,s=i.fitBoundsOptions;a&&n.fitBounds(s),n.styleNeedUpdate=!1})}}]),e}(),qf=["type"],Id={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},t={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},o={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},u={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function v(e){var r={u_DirectionalLights:new Array(3).fill((0,de.Z)({},o)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,de.Z)({},u)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[t]),e.forEach(function(n){var i=n.type,a=i===void 0?"directional":i,s=(0,ws.Z)(n,qf),c=Id[a].lights,d=Id[a].num,g=r[d];r[c][g]=(0,de.Z)((0,de.Z)({},r[c][g]),s),r[d]++}),r}var y=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("LightingPlugin",function(){var i=n.getLayerConfig(),a=i.enableLighting;a&&n.models.forEach(function(s){return s.addUniforms((0,de.Z)({},v()))})})}}]),e}();function b(e){return e.map(function(r){return typeof r=="string"&&(r=[r,{}]),r})}function T(e,r,n,i){var a=e.multiPassRenderer,s=e.getLayerConfig(),c=s.enableTAA;return c?a.add(i("taa")):a.add(i("render")),b(r).forEach(function(d){var g=(0,ji.Z)(d,2),_=g[0],A=g[1];a.add(n(_),A)}),a.add(n("copy")),a}var I=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.rendererService,c=i.postProcessingPassFactory,d=i.normalPassFactory;n.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var g=n.getLayerConfig(),_=g.enableMultiPassRenderer,A=g.passes,C=A===void 0?[]:A;a.enabled=!!_&&n.getLayerConfig().enableMultiPassRenderer!==!1,a.enabled&&(n.multiPassRenderer=T(n,C,c,d),n.multiPassRenderer.setRenderFlag(!0))}),n.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(a.enabled){var g=s.getViewportSize(),_=g.width,A=g.height;n.multiPassRenderer.resize(_,A)}})}}]),e}(),Z=function(e){return e[e.POSITION=0]="POSITION",e[e.COLOR=1]="COLOR",e[e.VERTEX_ID=2]="VERTEX_ID",e[e.PICKING_COLOR=3]="PICKING_COLOR",e[e.STROKE=4]="STROKE",e[e.OPACITY=5]="OPACITY",e[e.OFFSETS=6]="OFFSETS",e[e.ROTATION=7]="ROTATION",e[e.EXTRUSION_BASE=8]="EXTRUSION_BASE",e[e.SIZE=9]="SIZE",e[e.SHAPE=10]="SHAPE",e[e.EXTRUDE=11]="EXTRUDE",e[e.MAX=12]="MAX",e[e.NORMAL=13]="NORMAL",e[e.UV=14]="UV",e[e.LINEAR=15]="LINEAR",e}({});function he(e){switch(e){case"rotation":return{name:"Rotation",type:Y.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:Z.ROTATION,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(n){var i=n.rotation,a=i===void 0?0:i;return Array.isArray(a)?[a[0]]:[a]}}};case"stroke":return{name:"stroke",type:Y.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:Z.STROKE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(n){var i=n.stroke,a=i===void 0?[1,1,1,1]:i;return a}}};case"opacity":return{name:"opacity",type:Y.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:Z.OPACITY,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(n){var i=n.opacity,a=i===void 0?1:i;return[a]}}};case"extrusionBase":return{name:"extrusionBase",type:Y.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:Z.EXTRUSION_BASE,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(n){var i=n.extrusionBase,a=i===void 0?0:i;return[a]}}};case"offsets":return{name:"offsets",type:Y.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:Z.OFFSETS,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(n){var i=n.offsets;return i}}};case"thetaOffset":return{name:"thetaOffset",type:Y.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:15,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(n){var i=n.thetaOffset,a=i===void 0?1:i;return[a]}}};default:return}}var _e=ke.rU.isNumber,Ae={NONE:0,ENCODE:1,HIGHLIGHT:2},je=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"pickOption2Array",value:function(){var n=[];return this.pickingUniformMap.forEach(function(i){_e(i)?n.push(i):n.push.apply(n,(0,Nr.Z)(i))}),n}},{key:"updatePickOption",value:function(n,i){var a=this;Object.keys(n).forEach(function(g){a.pickingUniformMap.set(g,n[g])});var s=i.getLayerConfig().pickingBuffer||0,c=Number(i.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",s),this.pickingUniformMap.set("u_shaderPick",c);var d=i.getPickingUniformBuffer();d.subData({offset:0,data:this.pickOption2Array()})}},{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_EnableSelect",0],["u_activeMix",0]]),n.hooks.init.tapPromise("PixelPickingPlugin",function(){var c=n.getLayerConfig(),d=c.enablePicking;s.registerStyleAttribute({name:"pickingColor",type:Y.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:Z.PICKING_COLOR,buffer:{data:[],type:Y.gl.FLOAT},size:3,update:function(_){var A=_.id;return d?(0,ke.Z6)(A):[0,0,0]}}})}),n.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var c=n.getLayerConfig(),d=c.enablePicking;d&&n.isVisible()&&(a.updatePickOption({u_PickingStage:Ae.ENCODE},n),n.models.forEach(function(g){return g.addUniforms({u_PickingStage:Ae.ENCODE})}))}),n.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var c=n.getLayerConfig(),d=c.enablePicking;d&&n.isVisible()&&(a.updatePickOption({u_PickingStage:Ae.HIGHLIGHT},n),n.models.forEach(function(g){return g.addUniforms({u_PickingStage:Ae.HIGHLIGHT})}))}),n.hooks.beforeHighlight.tap("PixelPickingPlugin",function(c){var d=n.getLayerConfig(),g=d.highlightColor,_=d.activeMix,A=_===void 0?0:_,C=typeof g=="string"?(0,ke.CI)(g):g||[1,0,0,1];n.updateLayerConfig({pickedFeatureID:(0,ke.W0)(new Uint8Array(c))});var N={u_PickingStage:Ae.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:C.map(function(ae){return ae*255}),u_activeMix:A};a.updatePickOption(N,n),n.models.forEach(function(ae){return ae.addUniforms(N)})}),n.hooks.beforeSelect.tap("PixelPickingPlugin",function(c){var d=n.getLayerConfig(),g=d.selectColor,_=d.selectMix,A=_===void 0?0:_,C=typeof g=="string"?(0,ke.CI)(g):g||[1,0,0,1];n.updateLayerConfig({pickedFeatureID:(0,ke.W0)(new Uint8Array(c))});var N={u_PickingStage:Ae.HIGHLIGHT,u_PickingColor:c,u_HighlightColor:C.map(function(ae){return ae*255}),u_activeMix:A,u_CurrentSelectedId:c,u_SelectColor:C.map(function(ae){return ae*255}),u_EnableSelect:1};a.updatePickOption(N,n),n.models.forEach(function(ae){return ae.addUniforms(N)})})}}]),e}(),Je=["mvt","geojsonvt","testTile"];function Tt(e){var r=e.getSource();return Je.includes(r.parser.type)}var wt=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){Tt(n)||a.registerBuiltinAttributes(s,n)})}},{key:"registerBuiltinAttributes",value:function(n,i){if(i.type==="MaskLayer"){this.registerPositionAttribute(n);return}this.registerPositionAttribute(n),this.registerColorAttribute(n),this.registerVertexIdAttribute(n)}},{key:"registerPositionAttribute",value:function(n){n.registerStyleAttribute({name:"position",type:Y.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:Z.POSITION,buffer:{data:[],type:Y.gl.FLOAT},size:3,update:function(a,s,c){return c.length===2?[c[0],c[1],0]:[c[0],c[1],c[2]]}}})}},{key:"registerColorAttribute",value:function(n){n.registerStyleAttribute({name:"color",type:Y.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:Z.COLOR,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(a){var s=a.color;return!s||!s.length?[1,1,1,1]:s}}})}},{key:"registerVertexIdAttribute",value:function(n){n.registerStyleAttribute({name:"vertexId",type:Y.GC.Attribute,descriptor:{name:"a_vertexId",shaderLocation:Z.VERTEX_ID,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(a,s){return[s]}}})}}]),e}(),Wt=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.rendererService,c=i.mapService,d=i.layerService,g=i.coordinateSystemService,_=i.cameraService;this.rendererService=s,this.mapService=c,this.layerService=d,this.coordinateSystemService=g,this.cameraService=_;var A=this.mapService.version,C=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],N=[0,0],ae;this.rendererService.uniformBuffers[0]||(ae=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0}),this.rendererService.uniformBuffers[0]=ae),n.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var we=n.getLayerConfig().tileOrigin;if(a.coordinateSystemService.refresh(we),A==="GAODE2.x"){a.setLayerCenter(n),C=a.mapService.map.customCoords.getMVPMatrix(),N=a.mapService.getCustomCoordCenter();var De=n.getLayerUniformBuffer();De.subData({offset:0,data:new Uint8Array(new Float32Array([].concat((0,Nr.Z)(C),(0,Nr.Z)(N))).buffer)})}var at=a.rendererService.getViewportSize(),Ot=at.width,Pt=at.height,Kt=a.generateUBO(C,N,Ot,Pt),hr=Kt.data,jr=Kt.uniforms;if(a.layerService.alreadyInRendering&&a.rendererService.uniformBuffers[0]){var pr=a.rendererService.uniformBuffers[0];pr.subData({offset:0,data:hr})}var rr=a.rendererService.queryVerdorInfo();rr==="WebGL1"&&n.models.forEach(function(Ur){Ur.addUniforms((0,de.Z)((0,de.Z)({},jr),{},{u_PickingBuffer:n.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(n.getShaderPickStat())}))})})}},{key:"setLayerCenter",value:function(n){n.coordCenter===void 0&&(n.coordCenter=n.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(n.coordCenter)}},{key:"generateUBO",value:function(n,i,a,s){var c,d=this.cameraService.getProjectionMatrix(),g=this.cameraService.getViewMatrix(),_=this.cameraService.getViewProjectionMatrix(),A=this.cameraService.getModelMatrix(),C=this.coordinateSystemService.getViewportCenterProjection(),N=this.coordinateSystemService.getPixelsPerDegree(),ae=this.cameraService.getZoom(),we=this.coordinateSystemService.getPixelsPerDegree2(),De=this.cameraService.getZoomScale(),at=this.coordinateSystemService.getPixelsPerMeter(),Ot=this.coordinateSystemService.getCoordinateSystem(),Pt=this.cameraService.getCameraPosition(),Kt=window.devicePixelRatio,hr=this.coordinateSystemService.getViewportCenter(),jr=[a,s],pr=this.cameraService.getFocalDistance(),rr=[].concat((0,Nr.Z)(g),(0,Nr.Z)(d),(0,Nr.Z)(_),(0,Nr.Z)(A),(0,Nr.Z)(C),(0,Nr.Z)(N),[ae],(0,Nr.Z)(we),[De],(0,Nr.Z)(at),[Ot],(0,Nr.Z)(Pt),[Kt],(0,Nr.Z)(hr),jr,[pr,0,0,0]);return{data:rr,uniforms:(c={},(0,ue.Z)(c,Y.lv.ProjectionMatrix,d),(0,ue.Z)(c,Y.lv.ViewMatrix,g),(0,ue.Z)(c,Y.lv.ViewProjectionMatrix,_),(0,ue.Z)(c,Y.lv.Zoom,ae),(0,ue.Z)(c,Y.lv.ZoomScale,De),(0,ue.Z)(c,Y.lv.FocalDistance,pr),(0,ue.Z)(c,Y.lv.CameraPosition,Pt),(0,ue.Z)(c,Y.kw.CoordinateSystem,Ot),(0,ue.Z)(c,Y.kw.ViewportCenter,hr),(0,ue.Z)(c,Y.kw.ViewportCenterProjection,C),(0,ue.Z)(c,Y.kw.PixelsPerDegree,N),(0,ue.Z)(c,Y.kw.PixelsPerDegree2,we),(0,ue.Z)(c,Y.kw.PixelsPerMeter,at),(0,ue.Z)(c,Y.kw.Mvp,n),(0,ue.Z)(c,"u_sceneCenterMercator",i),(0,ue.Z)(c,"u_ViewportSize",jr),(0,ue.Z)(c,"u_ModelMatrix",A),(0,ue.Z)(c,"u_DevicePixelRatio",Kt),c)}}}]),e}(),zt=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("UpdateModelPlugin",function(){n.layerModel&&n.layerModel.needUpdate().then(function(i){i&&n.renderLayers()})}),n.hooks.afterRender.tap("UpdateModelPlugin",function(){n.layerModelNeedUpdate=!1})}}]),e}(),or=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){a.initStyleAttribute(n,{styleAttributeService:s})}),n.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){n.layerModelNeedUpdate||n.inited&&a.updateStyleAttribute(n,{styleAttributeService:s})})}},{key:"updateStyleAttribute",value:function(n,i){var a=i.styleAttributeService,s=a.getLayerStyleAttributes()||[],c=a.getLayerStyleAttribute("filter");if(c&&c.needRegenerateVertices){n.layerModelNeedUpdate=!0,s.forEach(function(d){return d.needRegenerateVertices=!1});return}s.filter(function(d){return d.needRegenerateVertices}).forEach(function(d){a.updateAttributeByFeatureRange(d.name,n.getEncodedData(),d.featureRange.startIndex,d.featureRange.endIndex,n),d.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(n,i){var a=i.styleAttributeService,s=a.getLayerStyleAttributes()||[];s.filter(function(c){return c.needRegenerateVertices}).forEach(function(c){a.updateAttributeByFeatureRange(c.name,n.getEncodedData(),c.featureRange.startIndex,c.featureRange.endIndex),c.needRegenerateVertices=!1})}}]),e}();function dr(){return[new S,new wt,new Ff,new zl,new Ks,new bv,new or,new zt,new I,new Wt,new xv,new y,new je,new gm]}var Ar,kr=(Ar={},(0,ue.Z)(Ar,Y.h0.additive,{enable:!0,func:{srcRGB:Y.gl.ONE,dstRGB:Y.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,ue.Z)(Ar,Y.h0.none,{enable:!1}),(0,ue.Z)(Ar,Y.h0.normal,{enable:!0,func:{srcRGB:Y.gl.SRC_ALPHA,dstRGB:Y.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,ue.Z)(Ar,Y.h0.subtractive,{enable:!0,func:{srcRGB:Y.gl.ONE,dstRGB:Y.gl.ONE,srcAlpha:Y.gl.ZERO,dstAlpha:Y.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:Y.gl.FUNC_SUBTRACT,alpha:Y.gl.FUNC_SUBTRACT}}),(0,ue.Z)(Ar,Y.h0.max,{enable:!0,func:{srcRGB:Y.gl.ONE,dstRGB:Y.gl.ONE},equation:{rgb:Y.gl.MAX_EXT}}),(0,ue.Z)(Ar,Y.h0.min,{enable:!0,func:{srcRGB:Y.gl.ONE,dstRGB:Y.gl.ONE},equation:{rgb:Y.gl.MIN_EXT}}),Ar),en=function(){function e(r){(0,Ue.Z)(this,e),this.layer=r}return(0,vt.Z)(e,[{key:"pickRender",value:function(n){var i=this.layer.getContainer(),a=i.layerService,s=this.layer;if(s.tileLayer)return s.tileLayer.pickRender(n);s.hooks.beforePickingEncode.call(),a.renderTileLayerMask(s),s.renderModels({ispick:!0}),s.hooks.afterPickingEncode.call()}},{key:"pick",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s){var c,d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(c=this.layer.getContainer(),d=c.pickingService,a.type!=="RasterLayer"){_.next=4;break}return _.abrupt("return",this.pickRasterLayer(a,s));case 4:return this.pickRender(s),_.abrupt("return",d.pickFromPickingFBO(a,s));case 6:case"end":return _.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"pickRasterLayer",value:function(n,i,a){var s=this.layer.getContainer(),c=s.pickingService,d=s.mapService,g=this.layer.getSource().extent,_=(0,ke.if)(i.lngLat,g),A={x:i.x,y:i.y,type:i.type,lngLat:i.lngLat,target:i,rasterValue:null},C=a||n;if(_){var N=this.readRasterValue(n,g,d,i.x,i.y);return A.rasterValue=N,c.triggerHoverOnLayer(C,A),!0}else return A.type=i.type==="mousemove"?"mouseout":"un"+i.type,c.triggerHoverOnLayer(C,(0,de.Z)((0,de.Z)({},A),{},{type:"unpick"})),c.triggerHoverOnLayer(C,A),!1}},{key:"readRasterValue",value:function(n,i,a,s,c){var d=n.getSource().data.dataArray[0],g=(0,ji.Z)(i,4),_=g[0],A=_===void 0?0:_,C=g[1],N=C===void 0?0:C,ae=g[2],we=ae===void 0?10:ae,De=g[3],at=De===void 0?-10:De,Ot=a.lngLatToContainer([A,N]),Pt=a.lngLatToContainer([we,at]),Kt=Pt.x-Ot.x,hr=Ot.y-Pt.y,jr=[(s-Ot.x)/Kt,(c-Pt.y)/hr],pr=d.width||1,rr=d.height||1,Ur=Math.floor(jr[0]*pr),$n=Math.floor(jr[1]*rr),Ai=Math.max(0,$n-1)*pr+Ur,Wn=d.data[Ai];return Wn}},{key:"selectFeature",value:function(n){var i=this.layer,a=(0,ji.Z)(n,3),s=a[0],c=a[1],d=a[2];i.hooks.beforeSelect.call([s,c,d])}},{key:"highlightPickedFeature",value:function(n){var i=(0,ji.Z)(n,3),a=i[0],s=i[1],c=i[2];this.layer.hooks.beforeHighlight.call([a,s,c])}},{key:"getFeatureById",value:function(n){return this.layer.getSource().getFeatureById(n)}}]),e}(),kn=function(){function e(r){(0,Ue.Z)(this,e),this.layer=r;var n=this.layer.getContainer();this.rendererService=n.rendererService}return(0,vt.Z)(e,[{key:"getColorTexture",value:function(n,i){var a=this.getTextureKey(n,i);return this.key===a?this.colorTexture:(this.createColorTexture(n,i),this.key=a,this.colorTexture)}},{key:"createColorTexture",value:function(n,i){var a=this.rendererService.createTexture2D,s=this.getColorRampBar(n,i),c=a({data:new Uint8Array(s.data),width:s.width,height:s.height,flipY:!1,unorm:!0});return this.colorTexture=c,c}},{key:"setColorTexture",value:function(n,i,a){this.key=this.getTextureKey(i,a),this.colorTexture=n}},{key:"destroy",value:function(){var n;(n=this.colorTexture)===null||n===void 0||n.destroy()}},{key:"getColorRampBar",value:function(n,i){switch(n.type){case"cat":return(0,ke.hj)(n);case"quantize":return(0,ke.NJ)(n);case"custom":return(0,ke.Oc)(n,i);case"linear":return(0,ke.M4)(n,i);default:return(0,ke.Cl)(n)}}},{key:"getTextureKey",value:function(n,i){var a;return"".concat(n.colors.join("_"),"_").concat(n==null||(a=n.positions)===null||a===void 0?void 0:a.join("_"),"_").concat(n.type,"_").concat(i==null?void 0:i.join("_"))}}]),e}(),Hn=["passes"],Ci=["moduleName","vertexShader","fragmentShader","inject","triangulation","styleOption","pickingEnabled"];function oi(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Li(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function Li(e,r){if(e){if(typeof e=="string")return si(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return si(e,r)}}function si(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function ma(e){var r=Ki();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Ki(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xi=ke.rU.isEqual,Aa=ke.rU.isFunction,aa=ke.rU.isNumber,ra=ke.rU.isObject,Ni=ke.rU.isPlainObject,oo=ke.rU.isUndefined,No=0,ko=function(e){(0,Ei.Z)(n,e);var r=ma(n);function n(){var i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,Ue.Z)(this,n),i=r.call(this),(0,ue.Z)((0,cn.Z)(i),"id","".concat(No++)),(0,ue.Z)((0,cn.Z)(i),"name","".concat(No)),(0,ue.Z)((0,cn.Z)(i),"visible",!0),(0,ue.Z)((0,cn.Z)(i),"zIndex",0),(0,ue.Z)((0,cn.Z)(i),"inited",!1),(0,ue.Z)((0,cn.Z)(i),"layerModelNeedUpdate",!1),(0,ue.Z)((0,cn.Z)(i),"pickedFeatureID",null),(0,ue.Z)((0,cn.Z)(i),"selectedFeatureID",null),(0,ue.Z)((0,cn.Z)(i),"styleNeedUpdate",!1),(0,ue.Z)((0,cn.Z)(i),"forceRender",!1),(0,ue.Z)((0,cn.Z)(i),"clusterZoom",0),(0,ue.Z)((0,cn.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,ue.Z)((0,cn.Z)(i),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,ue.Z)((0,cn.Z)(i),"hooks",{init:new Co.S$,afterInit:new Co.oI,beforeRender:new Co.oI,beforeRenderData:new Co.bf,afterRender:new Co.ni,beforePickingEncode:new Co.ni,afterPickingEncode:new Co.ni,beforeHighlight:new Co.ni(["pickedColor"]),afterHighlight:new Co.ni,beforeSelect:new Co.ni(["pickedColor"]),afterSelect:new Co.ni,beforeDestroy:new Co.ni,afterDestroy:new Co.ni}),(0,ue.Z)((0,cn.Z)(i),"models",[]),(0,ue.Z)((0,cn.Z)(i),"startInit",!1),(0,ue.Z)((0,cn.Z)(i),"layerChildren",[]),(0,ue.Z)((0,cn.Z)(i),"masks",[]),(0,ue.Z)((0,cn.Z)(i),"configService",Y.cO),(0,ue.Z)((0,cn.Z)(i),"animateOptions",{enable:!1}),(0,ue.Z)((0,cn.Z)(i),"currentPickId",null),(0,ue.Z)((0,cn.Z)(i),"encodeStyleAttribute",{}),(0,ue.Z)((0,cn.Z)(i),"enableShaderEncodeStyles",[]),(0,ue.Z)((0,cn.Z)(i),"enableDataEncodeStyles",[]),(0,ue.Z)((0,cn.Z)(i),"pendingStyleAttributes",[]),(0,ue.Z)((0,cn.Z)(i),"scaleOptions",{}),(0,ue.Z)((0,cn.Z)(i),"animateStatus",!1),(0,ue.Z)((0,cn.Z)(i),"isDestroyed",!1),(0,ue.Z)((0,cn.Z)(i),"uniformBuffers",[]),(0,ue.Z)((0,cn.Z)(i),"encodeDataLength",0),(0,ue.Z)((0,cn.Z)(i),"sourceEvent",function(){i.dataState.dataSourceNeedUpdate=!0;var s=i.getLayerConfig();s&&s.autoFit&&i.fitBounds(s.fitBoundsOptions);var c=i.layerSource.getSourceCfg().autoRender;c&&setTimeout(function(){i.reRender()},10)}),i.name=a.name||i.id,i.zIndex=a.zIndex||0,i.rawConfig=a,i.masks=a.maskLayers||[],i}return(0,vt.Z)(n,[{key:"shaderModuleService",get:function(){return this.container.shaderModuleService}},{key:"cameraService",get:function(){return this.container.cameraService}},{key:"coordinateService",get:function(){return this.container.coordinateSystemService}},{key:"iconService",get:function(){return this.container.iconService}},{key:"fontService",get:function(){return this.container.fontService}},{key:"pickingService",get:function(){return this.container.pickingService}},{key:"rendererService",get:function(){return this.container.rendererService}},{key:"layerService",get:function(){return this.container.layerService}},{key:"debugService",get:function(){return this.container.debugService}},{key:"interactionService",get:function(){return this.container.interactionService}},{key:"mapService",get:function(){return this.container.mapService}},{key:"normalPassFactory",get:function(){return this.container.normalPassFactory}},{key:"addMask",value:function(a){this.masks.push(a),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}},{key:"removeMask",value:function(a){var s=this.masks.indexOf(a);s>-1&&this.masks.splice(s,1),this.updateLayerConfig({maskLayers:this.masks})}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(a){this.masks.push(a)}},{key:"removeMaskLayer",value:function(a){var s=this.masks.indexOf(a);s>-1&&this.masks.splice(s,1),a.destroy()}},{key:"getAttribute",value:function(a){return this.styleAttributeService.getLayerStyleAttribute(a)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(a){var s=this;if(Object.keys(a).map(function(d){d in s.rawConfig&&(s.rawConfig[d]=a[d])}),!this.startInit)this.needUpdateConfig=(0,de.Z)((0,de.Z)({},this.needUpdateConfig),a);else{var c=this.container.id;this.configService.setLayerConfig(c,this.id,(0,de.Z)((0,de.Z)((0,de.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),a)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(a){this.container=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(a){return this.plugins.push(a),this}},{key:"init",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c=this,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:d=this.container.id,this.startInit=!0,this.configService.setLayerConfig(d,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,g=this.getLayerConfig(),_=g.enableMultiPassRenderer,A=g.passes,_&&A!==null&&A!==void 0&&A.length&&A.length>0&&this.mapService.on("mapAfterFrameChange",function(){c.renderLayers()}),this.postProcessingPassFactory=this.container.postProcessingPassFactory,this.styleAttributeService=this.container.styleAttributeService,_&&(this.multiPassRenderer=this.container.multiPassRenderer,this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(at){var Ot=at.attributeName,Pt=at.attributeField,Kt=at.attributeValues,hr=at.updateOptions;c.styleAttributeService.updateStyleAttribute(Ot,{scale:(0,de.Z)({field:Pt},c.splitValuesAndCallbackInAttribute(Kt,Pt?void 0:c.getLayerConfig()[Ot]))},hr)}),this.pendingStyleAttributes=[],this.plugins=dr(),C=oi(this.plugins);try{for(C.s();!(N=C.n()).done;)ae=N.value,ae.apply(this,this.container)}catch(at){C.e(at)}finally{C.f()}return this.layerPickService=new en(this),this.textureService=new kn(this),this.log(Y.Or.LayerInitStart),De.next=19,this.hooks.init.promise();case 19:this.log(Y.Or.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 24:case"end":return De.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"log",value:function(a){var s,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var d="".concat(this.id,".").concat(c,".").concat(a),g={id:this.id,type:this.type};(s=this.debugService)===null||s===void 0||s.log(d,g)}}},{key:"updateModelData",value:function(a){a.attributes&&a.elements?this.models.map(function(s){s.updateAttributesAndElements(a.attributes,a.elements)}):console.warn("data error")}},{key:"setLayerPickService",value:function(a){this.layerPickService=a}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var a=this.getLayerConfig(),s=a.animateOption;s!=null&&s.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(a,s,c){return this.updateStyleAttribute("color",a,s,c),this}},{key:"texture",value:function(a,s,c){return this.updateStyleAttribute("texture",a,s,c),this}},{key:"rotate",value:function(a,s,c){return this.updateStyleAttribute("rotate",a,s,c),this}},{key:"size",value:function(a,s,c){return this.updateStyleAttribute("size",a,s,c),this}},{key:"filter",value:function(a,s,c){var d=this.updateStyleAttribute("filter",a,s,c);return this.dataState.dataSourceNeedUpdate=d&&this.inited,this}},{key:"shape",value:function(a,s,c){this.shapeOption={field:a,values:s};var d=this.updateStyleAttribute("shape",a,s,c);return this.dataState.dataSourceNeedUpdate=d&&this.inited,this}},{key:"label",value:function(a,s,c){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:a,attributeValues:s,updateOptions:c}),this}},{key:"animate",value:function(a){var s={};return ra(a)?(s.enable=!0,s=(0,de.Z)((0,de.Z)({},s),a)):s.enable=a,this.updateLayerConfig({animateOption:s}),this}},{key:"source",value:function(a,s){return(a==null?void 0:a.type)==="source"?(this.setSource(a),this):(this.sourceOption={data:a,options:s},this.clusterZoom=0,this)}},{key:"setData",value:function(a,s){var c=this;return this.log(Y.Or.SourceInitStart,Y.KD.UPDATE),this.inited?this.layerSource.setData(a,s):this.on("inited",function(){c.layerSource.setData(a,s)}),this.layerSource.once("update",function(){c.log(Y.Or.SourceInitEnd,Y.KD.UPDATE)}),this}},{key:"style",value:function(a){var s=this,c=a.passes,d=(0,ws.Z)(a,Hn);c&&b(c).forEach(function(_){var A=s.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(_[0]);A&&A.updateOptions(_[1])}),d.borderColor&&(d.stroke=d.borderColor),d.borderWidth&&(d.strokeWidth=d.borderWidth);var g=d;return Object.keys(d).forEach(function(_){var A=d[_];Array.isArray(A)&&A.length===2&&!aa(A[0])&&!aa(A[1])&&(g[_]={field:A[0],value:A[1]})}),this.encodeStyle(g),this.updateLayerConfig(g),this}},{key:"encodeStyle",value:function(a){var s=this;Object.keys(a).forEach(function(c){[].concat((0,Nr.Z)(s.enableShaderEncodeStyles),(0,Nr.Z)(s.enableDataEncodeStyles)).includes(c)&&Ni(a[c])&&(a[c].field||a[c].value)&&!xi(s.encodeStyleAttribute[c],a[c])?(s.encodeStyleAttribute[c]=a[c],s.updateStyleAttribute(c,a[c].field,a[c].value),s.inited&&(s.dataState.dataMappingNeedUpdate=!0)):s.encodeStyleAttribute[c]&&(delete s.encodeStyleAttribute[c],s.dataState.dataSourceNeedUpdate=!0)})}},{key:"scale",value:function(a,s){var c=(0,de.Z)({},this.scaleOptions);if(ra(a)?this.scaleOptions=(0,de.Z)((0,de.Z)({},this.scaleOptions),a):this.scaleOptions[a]=s,this.styleAttributeService&&!xi(c,this.scaleOptions)){var d=ra(a)?a:(0,ue.Z)({},a,s);this.styleAttributeService.updateScaleAttribute(d)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"prerender",value:function(){}},{key:"render",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(a),this))}},{key:"renderMultiPass",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){d.next=2;break}return d.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){d.next=7;break}return d.next=5,this.multiPassRenderer.render();case 5:d.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"active",value:function(a){var s={};return s.enableHighlight=ra(a)?!0:a,ra(a)?(s.enableHighlight=!0,a.color&&(s.highlightColor=a.color),a.mix&&(s.activeMix=a.mix)):s.enableHighlight=!!a,this.updateLayerConfig(s),this}},{key:"setActive",value:function(a,s){var c=this;if(ra(a)){var d=a.x,g=d===void 0?0:d,_=a.y,A=_===void 0?0:_;this.updateLayerConfig({highlightColor:ra(s)?s.color:this.getLayerConfig().highlightColor,activeMix:ra(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:g,y:A})}else this.updateLayerConfig({pickedFeatureID:a,highlightColor:ra(s)?s.color:this.getLayerConfig().highlightColor,activeMix:ra(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,ke.Z6)(a)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"select",value:function(a){var s={};return s.enableSelect=ra(a)?!0:a,ra(a)?(s.enableSelect=!0,a.color&&(s.selectColor=a.color),a.mix&&(s.selectMix=a.mix)):s.enableSelect=!!a,this.updateLayerConfig(s),this}},{key:"setSelect",value:function(a,s){var c=this;if(ra(a)){var d=a.x,g=d===void 0?0:d,_=a.y,A=_===void 0?0:_;this.updateLayerConfig({selectColor:ra(s)?s.color:this.getLayerConfig().selectColor,selectMix:ra(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:g,y:A})}else this.updateLayerConfig({pickedFeatureID:a,selectColor:ra(s)?s.color:this.getLayerConfig().selectColor,selectMix:ra(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,ke.Z6)(a)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"setBlend",value:function(a){return this.updateLayerConfig({blend:a}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(a){return this.zIndex=a,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(a){this.currentPickId=a}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(a){this.selectedFeatureID=a}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var a=this.mapService.getZoom(),s=this.getLayerConfig(),c=s.visible,d=s.minZoom,g=d===void 0?-1/0:d,_=s.maxZoom,A=_===void 0?1/0:_;return!!c&&a>=g&&a<A}},{key:"setMultiPass",value:function(a,s){if(this.updateLayerConfig({enableMultiPassRenderer:a}),s&&this.updateLayerConfig({passes:s}),a){var c=this.getLayerConfig(),d=c.passes,g=d===void 0?[]:d;this.multiPassRenderer=T(this,g,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var _=this.rendererService.getViewportSize(),A=_.width,C=_.height;this.multiPassRenderer.resize(A,C)}return this}},{key:"setMinZoom",value:function(a){return this.updateLayerConfig({minZoom:a}),this}},{key:"getMinZoom",value:function(){var a=this.getLayerConfig(),s=a.minZoom;return s}},{key:"getMaxZoom",value:function(){var a=this.getLayerConfig(),s=a.maxZoom;return s}},{key:"get",value:function(a){var s=this.getLayerConfig();return s[a]}},{key:"setMaxZoom",value:function(a){return this.updateLayerConfig({maxZoom:a}),this}},{key:"setAutoFit",value:function(a){return this.updateLayerConfig({autoFit:a}),this}},{key:"fitBounds",value:function(a){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var s=this.getSource(),c=s.extent,d=c.some(function(g){return Math.abs(g)===1/0});return d?this:(this.mapService.fitBounds([[c[0],c[1]],[c[2],c[3]]],a),this)}},{key:"destroy",value:function(){var a,s,c,d,g,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){(a=this.layerModel)===null||a===void 0||a.uniformBuffers.forEach(function(N){N.destroy()}),this.layerChildren.map(function(N){return N.destroy(!1)}),this.layerChildren=[];var A=this.getLayerConfig(),C=A.maskfence;C&&(this.masks.map(function(N){return N.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(s=this.multiPassRenderer)===null||s===void 0||s.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(c=this.layerModel)===null||c===void 0||c.clearModels(_),(d=this.tileLayer)===null||d===void 0||d.destroy(),this.models=[],(g=this.debugService)===null||g===void 0||g.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var a;this.models.forEach(function(s){return s.destroy()}),(a=this.layerModel)===null||a===void 0||a.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(a){return a.needRescale||a.needRemapping||a.needRegenerateVertices}).length}},{key:"setSource",value:function(a){var s=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=a,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var c=this.mapService.getZoom();this.layerSource.updateClusterData(c)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(d){var g=d.type;if(s.coordCenter===void 0){var _,A=s.layerSource.center;s.coordCenter=A,(_=s.mapService)!==null&&_!==void 0&&_.setCoordCenter&&s.mapService.setCoordCenter(A)}if(g==="update"){if(s.tileLayer){s.tileLayer.reload();return}s.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(a){this.encodedData=a,this.encodeDataLength=a.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(a){return this.styleAttributeService.getLayerAttributeScale(a)}},{key:"getLegend",value:function(a){var s,c,d,g=this.styleAttributeService.getLayerStyleAttribute(a),_=(g==null||(s=g.scale)===null||s===void 0?void 0:s.scalers)||[];return{type:(c=_[0])===null||c===void 0||(c=c.option)===null||c===void 0?void 0:c.type,field:g==null||(d=g.scale)===null||d===void 0?void 0:d.field,items:this.getLegendItems(a)}}},{key:"getLegendItems",value:function(a){var s=this.styleAttributeService.getLayerAttributeScale(a);if(!s)return[];if(s.invertExtent){var c=s.range().map(function(_){return(0,ue.Z)({value:s.invertExtent(_)},a,_)});return c}else if(s.ticks){var d=s.ticks().map(function(_){return(0,ue.Z)({value:_},a,s(_))});return d}else if(s!=null&&s.domain){var g=s.domain().filter(function(_){return!oo(_)}).map(function(_){return(0,ue.Z)({value:_},a,s(_))});return g}return[]}},{key:"pick",value:function(a){var s=a.x,c=a.y;this.interactionService.triggerHover({x:s,y:c})}},{key:"boxSelect",value:function(a,s){this.pickingService.boxPickLayer(this,a,s)}},{key:"buildLayerModel",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c){var d=this,g,_,A,C,N,ae,we,De,at,Ot,Pt,Kt,hr,jr;return Pe().wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return g=c.moduleName,_=c.vertexShader,A=c.fragmentShader,C=c.inject,N=c.triangulation,ae=c.styleOption,we=c.pickingEnabled,De=we===void 0?!0:we,at=(0,ws.Z)(c,Ci),this.shaderModuleService.registerModule(g,{vs:_,fs:A,inject:C}),Ot=this.shaderModuleService.getModule(g),Pt=Ot.vs,Kt=Ot.fs,hr=Ot.uniforms,jr=this.rendererService.createModel,rr.abrupt("return",new Promise(function(Ur){var $n=d.styleAttributeService.createAttributesAndIndices(d.encodedData,N,ae,d),Ai=$n.attributes,Wn=$n.elements,Xi=$n.count,oa=[].concat((0,Nr.Z)(d.layerModel.uniformBuffers),(0,Nr.Z)(d.rendererService.uniformBuffers),[d.getLayerUniformBuffer()]);De&&oa.push(d.getPickingUniformBuffer());var Es=(0,de.Z)({attributes:Ai,uniforms:hr,fs:Kt,vs:Pt,elements:Wn,blend:kr[Y.h0.normal],uniformBuffers:oa,textures:d.layerModel.textures},at);Xi&&(Es.count=Xi);var Nu=jr(Es);Ur(Nu)}));case 5:case"end":return rr.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"createAttributes",value:function(a){var s=a.triangulation,c=this.styleAttributeService.createAttributes(this.encodedData,s),d=c.attributes;return d}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(a){var s=this.getLayerConfig(),c=s.enableHighlight,d=c===void 0?!0:c,g=s.enableSelect,_=g===void 0?!0:g,A=this.eventNames().indexOf(a)!==-1||this.eventNames().indexOf("un"+a)!==-1;return(a==="click"||a==="dblclick")&&_&&(A=!0),a==="mousemove"&&(d||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(A=!0),this.isVisible()&&A}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return d.stop()}},s)}));function a(){return i.apply(this,arguments)}return a}()},{key:"rebuildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.buildModels();case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"renderMulPass",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c){return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,c.render();case 2:case"end":return g.stop()}},s)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"renderModels",value:function(){var a=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(c){c.draw({uniforms:a.layerModel.getUninforms(),blend:a.layerModel.getBlend(),stencil:a.layerModel.getStencil(s),textures:a.layerModel.textures},(s==null?void 0:s.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(a,s,c,d){var g=this.configService.getAttributeConfig(this.id)||{};return xi(g[a],{field:s,values:c})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(a)!==-1&&this.configService.setAttributeConfig(this.id,(0,ue.Z)({},a,{field:s,values:c})),this.startInit?this.styleAttributeService.updateStyleAttribute(a,{scale:(0,de.Z)({field:s},this.splitValuesAndCallbackInAttribute(c,this.getLayerConfig()[s]))},d):this.pendingStyleAttributes.push({attributeName:a,attributeField:s,attributeValues:c,updateOptions:d}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(a){console.warn("empty fn")}},{key:"processData",value:function(a){return a}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return this.models.forEach(function(A){return A.destroy()}),this.models=[],this.uniformBuffers.forEach(function(A){A.destroy()}),this.uniformBuffers=[],c=this.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0}),this.uniformBuffers.push(c),d=this.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0}),this.uniformBuffers.push(d),_.next=10,this.layerModel.initModels();case 10:this.models=_.sent;case 11:case"end":return _.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getLayerUniformBuffer",value:function(){return this.uniformBuffers[0]}},{key:"getPickingUniformBuffer",value:function(){return this.uniformBuffers[1]}},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(a){return{values:Aa(a)?void 0:a,callback:Aa(a)?a:void 0}}}]),n}(ol.EventEmitter);function ts(e,r){return{enable:e,mask:255,func:{cmp:Y.gl.EQUAL,ref:r?1:0,mask:1}}}function Uo(e){return e.maskOperation===Y.lE.OR?{enable:!0,mask:255,func:{cmp:Y.gl.ALWAYS,ref:1,mask:255},opFront:{fail:Y.gl.KEEP,zfail:Y.gl.REPLACE,zpass:Y.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===Y.yn.SINGLE||e.stencilIndex===0?Y.gl.ALWAYS:Y.gl.LESS,ref:e.stencilType===Y.yn.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:Y.gl.KEEP,zfail:Y.gl.REPLACE,zpass:Y.gl.REPLACE}}}var ls={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},_s={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};function qs(e){var r="";return Object.keys(e).forEach(function(n){var i=e[n];Array.isArray(i)?r+="vec".concat(i.length," ").concat(n,`;
`):r+="flot ".concat(n,`;
`)}),r}function Tu(e){return Math.max(Math.ceil(e/4)*4,4)}var Ls={opacity:Z.OPACITY,stroke:Z.STROKE,offsets:Z.OFFSETS,rotation:Z.ROTATION,extrusionBase:Z.EXTRUSION_BASE,thetaOffset:15},Ua=function(){function e(r){(0,Ue.Z)(this,e),(0,ue.Z)(this,"uniformBuffers",[]),(0,ue.Z)(this,"textures",[]),(0,ue.Z)(this,"preStyleAttribute",{}),(0,ue.Z)(this,"encodeStyleAttribute",{}),this.layer=r,this.configService=r.getContainer().globalConfigService,this.rendererService=r.getContainer().rendererService,this.pickingService=r.getContainer().pickingService,this.shaderModuleService=r.getContainer().shaderModuleService,this.styleAttributeService=r.getContainer().styleAttributeService,this.mapService=r.getContainer().mapService,this.iconService=r.getContainer().iconService,this.fontService=r.getContainer().fontService,this.cameraService=r.getContainer().cameraService,this.layerService=r.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var n=this.rendererService.createTexture2D;this.createTexture2D=n}return(0,vt.Z)(e,[{key:"getBlend",value:function(){var n=this.layer.getLayerConfig(),i=n.blend,a=i===void 0?"normal":i;return kr[Y.h0[a]]}},{key:"getStencil",value:function(n){var i=this.layer.getLayerConfig(),a=i.mask,s=a===void 0?!1:a,c=i.maskInside,d=c===void 0?!0:c,g=i.enableMask,_=i.maskOperation,A=_===void 0?Y.lE.AND:_;if(this.layer.type==="MaskLayer")return Uo({isStencil:!0,stencilType:Y.yn.SINGLE});if(n.isStencil)return Uo((0,de.Z)((0,de.Z)({},n),{},{maskOperation:A}));var C=s||g&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return ts(C,d)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){var n=this.getCommonUniformsInfo(),i=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();var a=(0,de.Z)((0,de.Z)({},i.uniformsOption),n.uniformsOption);return!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(a.u_texture=this.textures[0]),a}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){return Pe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",!1);case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){return Pe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"initModels",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){return Pe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"prerender",value:function(){}},{key:"render",value:function(n){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(n){return[n.enable?0:1,n.duration||4,n.interval||.2,n.trailLength||.1]}},{key:"startModelAnimate",value:function(){var n=this.layer.getLayerConfig(),i=n.animateOption;i.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var n=this.layer.encodeStyleAttribute,i="",a=[];this.layer.enableShaderEncodeStyles.forEach(function(d){n[d]?i+="#define USE_ATTRIBUTE_".concat(d.toUpperCase(),` 0.0; 

`):a.push("  ".concat(_s[d]," u_").concat(d,";"));var g=Ls[d];!g&&d==="THETA_OFFSET"&&(g=15),i+=`
          #ifdef USE_ATTRIBUTE_`.concat(d.toUpperCase(),`
          layout(location = `).concat(Ls[d],") in ").concat(_s[d]," a_").concat(d.charAt(0).toUpperCase()+d.slice(1),`;
        #endif

        `)});var s=a.length?`
layout(std140) uniform AttributeUniforms {
`.concat(a.join(`
`),`
};
    `):"";i+=s;var c="";return this.layer.enableShaderEncodeStyles.forEach(function(d){c+=`

    #ifdef USE_ATTRIBUTE_`.concat(d.toUpperCase(),`
      `).concat(_s[d]," ").concat(d,"  = a_").concat(d.charAt(0).toUpperCase()+d.slice(1),`;
    #else
      `).concat(_s[d]," ").concat(d," = u_").concat(d,`;
    #endif

    `)}),{"vs:#decl":i,"fs:#decl":s,"vs:#main-start":c}}},{key:"getStyleAttribute",value:function(){var n=this,i={};return this.layer.enableShaderEncodeStyles.forEach(function(a){if(!n.layer.encodeStyleAttribute[a]){var s=n.layer.getLayerConfig()[a],c=typeof s=="undefined"?ls[a]:s;a==="stroke"&&(c=(0,ke.CI)(c)),i["u_"+a]=c}}),i}},{key:"registerStyleAttribute",value:function(){var n=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(i){var a=he(i);a&&(n.styleAttributeService.registerStyleAttribute(a),a.descriptor&&(a.descriptor.shaderLocation=Ls[i]))})}},{key:"updateEncodeAttribute",value:function(n,i){this.encodeStyleAttribute[n]=i}},{key:"initUniformsBuffer",value:function(){var n=this.getUniformsBufferInfo(this.getStyleAttribute()),i=this.getCommonUniformsInfo();n.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(Tu(n.uniformsLength)).fill(0),isUBO:!0}),this.uniformBuffers.push(this.attributeUnifoms)),i.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(Tu(i.uniformsLength)).fill(0),isUBO:!0}),this.uniformBuffers.push(this.commonUnifoms))}},{key:"getUniformsBufferInfo",value:function(n){var i=0,a=[];return Object.values(n).forEach(function(s){Array.isArray(s)?(a.push.apply(a,(0,Nr.Z)(s)),i+=s.length):typeof s=="number"?(a.push(s),i+=1):typeof s=="boolean"&&(a.push(Number(s)),i+=1)}),{uniformsOption:n,uniformsLength:i,uniformsArray:a}}},{key:"getCommonUniformsInfo",value:function(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}},{key:"updateStyleUnifoms",value:function(){var n,i,a=this.getUniformsBufferInfo(this.getStyleAttribute()),s=a.uniformsArray,c=this.getCommonUniformsInfo(),d=c.uniformsArray;(n=this.attributeUnifoms)===null||n===void 0||n.subData({offset:0,data:new Uint8Array(new Float32Array(s).buffer)}),(i=this.commonUnifoms)===null||i===void 0||i.subData({offset:0,data:new Uint8Array(new Float32Array(d).buffer)})}}]),e}(),xs=x(9187),Yo=x.n(xs),ka=100,Mo=36,xo=40;function Xa(e){return e/180*Math.acos(-1)}function ku(e){var r=Xa(e[0])+Math.PI/2,n=Xa(e[1]),i=ka+Math.random()*.4,a=i*Math.cos(n)*Math.cos(r),s=i*Math.cos(n)*Math.sin(r),c=i*Math.sin(n);return[s,c,a]}function Du(e,r){var n=mat4.create(),i=mat4.create(),a=vec3.fromValues(0,1,0),s=vec3.fromValues(0,0,0);r=r||{},e=typeof e!="undefined"?e:1;for(var c=typeof r.segments!="undefined"?r.segments:32,d=2+c,g=2*d,_=[],A=[],C=[],N=[],ae=[],we=[],De=0;De<=d;De++){for(var at=De/d,Ot=at*Math.PI,Pt=0;Pt<=g;Pt++){var Kt=Pt/g,hr=Kt*Math.PI*2;mat4.identity(i),mat4.rotateZ(i,i,-Ot),mat4.identity(n),mat4.rotateY(n,n,hr),vec3.transformMat4(s,a,i),vec3.transformMat4(s,s,n),vec3.scale(s,s,-e),C.push(s.slice()),N.push.apply(N,_toConsumableArray(s.slice())),vec3.normalize(s,s),ae.push.apply(ae,_toConsumableArray(s.slice())),we.push([Kt,1-at]),N.push(Kt,1-at)}if(De>0)for(var jr=C.length,pr=jr-2*(g+1);pr+g+2<jr;pr++)_.push([pr,pr+1,pr+g+1]),A.push(pr,pr+1,pr+g+1),_.push([pr+g+1,pr+1,pr+g+2]),A.push(pr+g+1,pr+1,pr+g+2)}return{cells:_,positions:C,uvs:we,positionsArr:N,indicesArr:A,normalArr:ae}}var gi=x(31437),rs=gi.Ue(),Lu=gi.Ue(),na=gi.Ue(),Ju=gi.Ue(),Au=gi.Ue();function Cc(e,r,n,i,a){gi.IH(e,n,i),gi.Fv(e,e),r=gi.al(-e[1],e[0]);var s=gi.al(-n[1],n[0]);return[a/gi.AK(r,s),r]}function Oo(e,r){return gi.t8(e,-r[1],r[0])}function Tl(e,r,n){return gi.lu(e,r,n),gi.Fv(e,e),e}function Xl(e,r){return e[0]===r[0]&&e[1]===r[1]}function hp(e){for(var r=new Map,n=0;n<e.length;n++){var i=e[0].toString()+"-"+e[1].toString();r.get(i)?(e.splice(n,1),n++):r.set(i,i)}return e}var yh=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Ue.Z)(this,e),(0,ue.Z)(this,"lastFlip",-1),(0,ue.Z)(this,"miter",gi.al(0,0)),(0,ue.Z)(this,"started",!1),(0,ue.Z)(this,"dash",!1),(0,ue.Z)(this,"totalDistance",0),(0,ue.Z)(this,"currentIndex",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,vt.Z)(e,[{key:"simpleExtrude",value:function(n){var i=this.complex;if(n.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=n.length,s=i.startIndex,c=1;c<a;c++){var d=n[c-1],g=n[c],_=c<n.length-1?n[c+1]:null,A=this.simpleSegment(i,s,d,g,_);s+=A}if(this.dash)for(var C=0;C<i.positions.length/6;C++)i.positions[C*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(n,i){var a=this.complex;if(n.length<=1)return a;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=n.length,c=a.startIndex,d=1;d<s;d++){var g,_,A,C=n[d-1];C.push((g=i[d-1][2])!==null&&g!==void 0?g:0);var N=i[d-1],ae=n[d];ae.push((_=i[d][2])!==null&&_!==void 0?_:0);var we=i[d],De=d<n.length-1?[].concat((0,Nr.Z)(n[d+1]),[(A=i[d+1][2])!==null&&A!==void 0?A:0]):null,at=d<i.length-1?i[d+1]:null,Ot=this.simpleSegment(a,c,C,ae,De,N,we,at);c+=Ot}if(this.dash)for(var Pt=0;Pt<a.positions.length/6;Pt++)a.positions[Pt*6+5]=this.totalDistance;return a.startIndex=a.positions.length/6,a}},{key:"extrude_gaode2",value:function(n,i){var a=this.complex;if(n.length<=1)return a;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=n.length,c=a.startIndex,d=1;d<s;d++){var g,_,A,C=n[d-1];C.push((g=i[d-1][2])!==null&&g!==void 0?g:0);var N=i[d-1],ae=n[d];ae.push((_=i[d][2])!==null&&_!==void 0?_:0);var we=i[d],De=d<n.length-1?[].concat((0,Nr.Z)(n[d+1]),[(A=i[d+1][2])!==null&&A!==void 0?A:0]):null,at=d<i.length-1?i[d+1]:null,Ot=this.segment_gaode2(a,c,C,ae,De,N,we,at);c+=Ot}if(this.dash)for(var Pt=0;Pt<a.positions.length/6;Pt++)a.positions[Pt*6+5]=this.totalDistance;return a.startIndex=a.positions.length/6,a}},{key:"extrude",value:function(n){var i=this.complex;if(n.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=n.length,s=i.startIndex,c=1;c<a;c++){var d=n[c-1],g=n[c],_=c<n.length-1?n[c+1]:null,A=this.segment(i,s,d,g,_);s+=A}if(this.dash)for(var C=0;C<i.positions.length/6;C++)i.positions[C*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleSegment",value:function(n,i,a,s,c){var d=0,g=n.indices,_=n.positions,A=n.normals,C=(0,ke.Z)([s[0],s[1]]),N=(0,ke.Z)([a[0],a[1]]);Tl(na,C,N);var ae=0;if(this.dash&&(ae=this.lineSegmentDistance(C,N),this.totalDistance+=ae),this.normal||(this.normal=gi.Ue(),Oo(this.normal,na)),this.started||(this.started=!0,this.extrusions(_,A,a,this.normal,this.thickness,this.totalDistance-ae)),g.push(i+0,i+1,i+2),!c)Oo(this.normal,na),this.extrusions(_,A,s,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),d+=2;else{var we=(0,ke.Z)([c[0],c[1]]);Xl(C,we)&&gi.IH(we,C,gi.Fv(we,gi.$X(we,C,N))),Tl(Ju,we,C);var De=Cc(Au,gi.Ue(),na,Ju,this.thickness),at=(0,ji.Z)(De,2),Ot=at[0],Pt=at[1],Kt=gi.AK(Au,this.normal)<0?-1:1;this.extrusions(_,A,s,Pt,Ot,this.totalDistance),g.push.apply(g,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),Kt=-1,gi.JG(this.normal,Pt),d+=2,this.lastFlip=Kt}return d}},{key:"segment_gaode2",value:function(n,i,a,s,c,d,g,_){var A=0,C=n.indices,N=n.positions,ae=n.normals,we=this.cap==="square",De=this.join==="bevel",at=(0,ke.Z)([g[0],g[1]]),Ot=(0,ke.Z)([d[0],d[1]]);Tl(na,s,a);var Pt=0;if(this.dash&&(Pt=this.lineSegmentDistance(at,Ot),this.totalDistance+=Pt),this.normal||(this.normal=gi.Ue(),Oo(this.normal,na)),!this.started)if(this.started=!0,we){var Kt=gi.Ue(),hr=gi.Ue();gi.IH(Kt,this.normal,na),gi.IH(hr,this.normal,na),ae.push(hr[0],hr[1],0),ae.push(Kt[0],Kt[1],0),N.push(a[0],a[1],a[2]|0,this.totalDistance-Pt,-this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),N.push(a[0],a[1],a[2]|0,this.totalDistance-Pt,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(N,ae,a,this.normal,this.thickness,this.totalDistance-Pt);if(C.push(i+0,i+1,i+2),c){Xl(s,c)&&gi.IH(c,s,gi.Fv(c,gi.$X(c,s,a))),Tl(Ju,c,s);var rr=Cc(Au,gi.Ue(),na,Ju,this.thickness),Ur=(0,ji.Z)(rr,2),$n=Ur[0],Ai=Ur[1],Wn=gi.AK(Au,this.normal)<0?-1:1,Xi=De;if(!Xi&&this.join==="miter"){var oa=$n;oa>this.miterLimit&&(Xi=!0)}Xi?(ae.push(this.normal[0],this.normal[1],0),ae.push(Ai[0],Ai[1],0),N.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Wn,s[2]|0),this.complex.indexes.push(this.currentIndex),N.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*Wn,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,C.push.apply(C,(0,Nr.Z)(this.lastFlip!==-Wn?[i,i+2,i+3]:[i+2,i+1,i+3])),C.push(i+2,i+3,i+4),Oo(rs,Ju),gi.JG(this.normal,rs),ae.push(this.normal[0],this.normal[1],0),N.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*Wn,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,A+=3):(this.extrusions(N,ae,s,Ai,$n,this.totalDistance),C.push.apply(C,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),Wn=-1,gi.JG(this.normal,Ai),A+=2),this.lastFlip=Wn}else{if(Oo(this.normal,na),we){var jr=gi.Ue(),pr=gi.Ue();gi.lu(pr,na,this.normal),gi.IH(jr,na,this.normal),ae.push(pr[0],pr[1],0),ae.push(jr[0],jr[1],0),N.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),N.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(N,ae,s,this.normal,this.thickness,this.totalDistance);C.push.apply(C,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),A+=2}return A}},{key:"segment",value:function(n,i,a,s,c){var d=0,g=n.indices,_=n.positions,A=n.normals,C=this.cap==="square",N=this.join==="bevel",ae=(0,ke.Z)([s[0],s[1]]),we=(0,ke.Z)([a[0],a[1]]);Tl(na,ae,we);var De=0;if(this.dash&&(De=this.lineSegmentDistance(ae,we),this.totalDistance+=De),this.normal||(this.normal=gi.Ue(),Oo(this.normal,na)),!this.started)if(this.started=!0,C){var at=gi.Ue(),Ot=gi.Ue();gi.IH(at,this.normal,na),gi.IH(Ot,this.normal,na),A.push(Ot[0],Ot[1],0),A.push(at[0],at[1],0),_.push(a[0],a[1],a[2]|0,this.totalDistance-De,-this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),_.push(a[0],a[1],a[2]|0,this.totalDistance-De,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(_,A,a,this.normal,this.thickness,this.totalDistance-De);if(g.push(i+0,i+1,i+2),c){var hr=(0,ke.Z)([c[0],c[1]]);Xl(ae,hr)&&gi.IH(hr,ae,gi.Fv(hr,gi.$X(hr,ae,we))),Tl(Ju,hr,ae);var jr=Cc(Au,gi.Ue(),na,Ju,this.thickness),pr=(0,ji.Z)(jr,2),rr=pr[0],Ur=pr[1],$n=gi.AK(Au,this.normal)<0?-1:1,Ai=N;if(!Ai&&this.join==="miter"){var Wn=rr;Wn>this.miterLimit&&(Ai=!0)}Ai?(A.push(this.normal[0],this.normal[1],0),A.push(Ur[0],Ur[1],0),_.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*$n,s[2]|0),this.complex.indexes.push(this.currentIndex),_.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*$n,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,Nr.Z)(this.lastFlip!==-$n?[i,i+2,i+3]:[i+2,i+1,i+3])),g.push(i+2,i+3,i+4),Oo(rs,Ju),gi.JG(this.normal,rs),A.push(this.normal[0],this.normal[1],0),_.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*$n,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,d+=3):(this.extrusions(_,A,s,Ur,rr,this.totalDistance),g.push.apply(g,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),$n=-1,gi.JG(this.normal,Ur),d+=2),this.lastFlip=$n}else{if(Oo(this.normal,na),C){var Pt=gi.Ue(),Kt=gi.Ue();gi.lu(Kt,na,this.normal),gi.IH(Pt,na,this.normal),A.push(Kt[0],Kt[1],0),A.push(Pt[0],Pt[1],0),_.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),_.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(_,A,s,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,Nr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),d+=2}return d}},{key:"extrusions",value:function(n,i,a,s,c,d){i.push(s[0],s[1],0),i.push(s[0],s[1],0),n.push(a[0],a[1],a[2]|0,d,-c,a[2]|0),this.complex.indexes.push(this.currentIndex),n.push(a[0],a[1],a[2]|0,d,c,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(n,i){var a=i[0]-n[0],s=i[1]-n[1];return Math.sqrt(a*a+s*s)}}]),e}(),_o=x(77160);function Qf(e){var r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=earcut.flatten(e),s=a.vertices,c=a.dimensions,d=[],g=[],_=0;_<s.length/c;_++)c===2?d.push(s[_*2],s[_*2+1],1):d.push(s[_*3],s[_*3+1],1);var A=earcut(a.vertices,a.holes,a.dimensions);g.push.apply(g,_toConsumableArray(A));for(var C=function(){var we=a.vertices.slice(N*c,(N+1)*c),De=a.vertices.slice((N+1)*c,(N+2)*c);De.length===0&&(De=a.vertices.slice(0,c));var at=d.length/3;d.push(we[0],we[1],1,De[0],De[1],1,we[0],we[1],0,De[0],De[1],0),g.push.apply(g,_toConsumableArray([0,2,1,2,3,1].map(function(Ot){return Ot+at})))},N=0;N<i;N++)C();return{positions:d,index:g}}function pp(e){var r=earcut.flatten(e),n=earcut(r.vertices,r.holes,r.dimensions);return{positions:r.vertices,index:n}}function dp(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e[0][0],i=e[0][e[0].length-1];n[0]===i[0]&&n[1]===i[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var a=e[0].length,s=Yo().flatten(e),c=s.vertices,d=s.dimensions,g=[],_=[],A=[],C=0;C<c.length/d;C++)g.push(c[C*d],c[C*d+1],1,-1,-1),A.push(0,0,1);var N=Yo()(s.vertices,s.holes,s.dimensions);_.push.apply(_,(0,Nr.Z)(N));for(var ae=function(){var at=s.vertices.slice(we*d,(we+1)*d),Ot=s.vertices.slice((we+1)*d,(we+2)*d);Ot.length===0&&(Ot=s.vertices.slice(0,d));var Pt=g.length/5;g.push(at[0],at[1],1,0,0,Ot[0],Ot[1],1,.1,0,at[0],at[1],0,0,.8,Ot[0],Ot[1],0,.1,.8);var Kt=Uh([Ot[0],Ot[1],1],[at[0],at[1],0],[at[0],at[1],1],r);A.push.apply(A,(0,Nr.Z)(Kt).concat((0,Nr.Z)(Kt),(0,Nr.Z)(Kt),(0,Nr.Z)(Kt))),_.push.apply(_,(0,Nr.Z)([1,2,0,3,2,1].map(function(hr){return hr+Pt})))},we=0;we<a;we++)ae();return{positions:g,index:_,normals:A}}function Uh(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=_o.create(),s=_o.create(),c=_o.create();i&&(e=(0,ke.vP)(e),r=(0,ke.vP)(r),n=(0,ke.vP)(n));var d=_o.fromValues.apply(_o,(0,Nr.Z)(e)),g=_o.fromValues.apply(_o,(0,Nr.Z)(r)),_=_o.fromValues.apply(_o,(0,Nr.Z)(n));_o.sub(a,_,g),_o.sub(s,d,g),_o.cross(c,a,s);var A=_o.create();return _o.normalize(A,c),A}var vl,Jf=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),eh=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function ac(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=Math.PI*2/e,i=[],a=0;a<e;a++)i.push(n*a+r*Math.PI/12);var s=i.map(function(c){var d=Math.sin(c+Math.PI/4),g=Math.cos(c+Math.PI/4);return[d,g,0]});return s}function _h(){return ac(30)}function xh(){return ac(4)}function Nf(){return ac(3)}function bh(){return ac(6,1)}function vp(){return ac(5)}var zh=(vl={},(0,ue.Z)(vl,eh.CIRCLE,_h),(0,ue.Z)(vl,eh.HEXAGON,bh),(0,ue.Z)(vl,eh.TRIANGLE,Nf),(0,ue.Z)(vl,eh.SQUARE,xh),(0,ue.Z)(vl,eh.PENTAGON,vp),(0,ue.Z)(vl,Jf.CYLINDER,_h),(0,ue.Z)(vl,Jf.HEXAGONCOLUMN,bh),(0,ue.Z)(vl,Jf.TRIANGLECOLUMN,Nf),(0,ue.Z)(vl,Jf.SQUARECOLUMN,xh),(0,ue.Z)(vl,Jf.PENTAGONCOLUMN,vp),vl),th={};function rh(e){var r=(0,ke.SI)(e.coordinates);return{vertices:[].concat((0,Nr.Z)(r),(0,Nr.Z)(r),(0,Nr.Z)(r),(0,Nr.Z)(r)),indices:[0,1,2,2,3,0],size:r.length}}function mp(e){var r=(0,ke.SI)(e.coordinates),n=ku(r);return{vertices:[].concat((0,Nr.Z)(n),(0,Nr.Z)(n),(0,Nr.Z)(n),(0,Nr.Z)(n)),indices:[0,1,2,2,3,0],size:n.length}}function Zh(e){var r=e.shape,n=bs(r,!1),i=n.positions,a=n.index,s=n.normals;return{vertices:i,indices:a,normals:s,size:5}}function gp(e){var r=(0,ke.SI)(e.coordinates);return{vertices:(0,Nr.Z)(r),indices:[0],size:r.length}}function yp(e){var r=e.coordinates,n=e.originCoordinates,i=e.version,a=new yh({dash:!0,join:"bevel"});if(i==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=n;Array.isArray(c[0][0])||(c=[n]);for(var d=0;d<s.length;d++){var g=s[d],_=c[d];a.extrude_gaode2(g,_)}}else{var A=r;A[0]&&!Array.isArray(A[0][0])&&(A=[r]),A.forEach(function(N){a.extrude(N)})}var C=a.complex;return{vertices:C.positions,indices:C.indices,normals:C.normals,indexes:C.indexes,size:6}}function Pd(e){var r=e.coordinates.flat(),n=1,i=1;return{vertices:[1,0,0].concat(_toConsumableArray(r),[1,2,-3],_toConsumableArray(r),[1,1,-3],_toConsumableArray(r),[0,1,0],_toConsumableArray(r),[0,0,0],_toConsumableArray(r),[1,0,0],_toConsumableArray(r),[1,2,-3],_toConsumableArray(r),[1,1,-3],_toConsumableArray(r),[0,1,0],_toConsumableArray(r),[0,0,0],_toConsumableArray(r)),normals:[-n,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-n,-i,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Vh(e){var r=e.coordinates,n=e.originCoordinates,i=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var a=Sh(r,n),s=a.results,c=a.totalDistance;return s.map(function(d){i.push(d[0],d[1],d[2],d[3],0,c)}),{vertices:i,indices:[],normals:[],size:6,count:s.length}}function kd(e){var r=e.coordinates,n=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],size:4,count:0};var i=_p(r),a=i.results;return a.map(function(s){n.push(s[0],s[1],s[2],s[3])}),{vertices:n,indices:[],size:4,count:a.length}}function Eh(e,r){var n=r[0]-e[0],i=r[1]-e[1];return Math.sqrt(n*n+i*i)}function pf(e,r){return e.length<3&&e.push(0),r!==void 0&&e.push(r),e}function Sh(e,r){var n=e,i=r||e;Array.isArray(n)&&Array.isArray(n[0])&&Array.isArray(n[0][0])&&(n=r.flat(),i=r.flat());var a=0;if(n.length<2)return{results:n,totalDistance:0};var s=[],c=pf(n[0],a);s.push(c);for(var d=1;d<n.length-1;d++){var g=Eh((0,ke.Z)(i[d-1]),(0,ke.Z)(i[d]));a+=g;var _=pf(n[d],a);s.push(_),s.push(_)}var A=Eh((0,ke.Z)(i[i.length-2]),(0,ke.Z)(i[i.length-1]));return a+=A,s.push(pf(n[n.length-1],a)),{results:s,totalDistance:a}}function _p(e){if(e.length<2)return{results:e};var r=[],n=pf(e[0]);r.push(n);for(var i=1;i<e.length-1;i++){var a=pf(e[i]);r.push(a),r.push(a)}return r.push(pf(e[e.length-1])),{results:r}}function nh(e){var r=e.coordinates,n=Yo().flatten(r),i=n.vertices,a=n.dimensions,s=n.holes;return{indices:Yo()(i,s,a),vertices:i,size:a}}function Dd(e){var r=e.coordinates,n=Yo().flatten(r),i=n.vertices,a=n.dimensions,s=n.holes;return{indices:Yo()(i,s,a),vertices:Ev(i),size:a+4}}function Ev(e){for(var r=[],n=(0,ke.Rx)(e),i=n.center,a=n.radius,s=0;s<e.length;s+=2){var c=e[s],d=e[s+1];r.push.apply(r,[c,d,0].concat((0,Nr.Z)(i),[a]))}return r}function Gp(e){var r=e.coordinates,n=dp(r,!0),i=n.positions,a=n.index,s=n.normals;return{vertices:i,indices:a,normals:s,size:5}}function ym(e){var r=e.shape,n=Bd(r),i=n.positions,a=n.index;return{vertices:i,indices:a,size:3}}function jh(e){var r=e.coordinates,n=[].concat((0,Nr.Z)(r[0]),[0,0,1,r[1][0],r[0][1],0,1,1],(0,Nr.Z)(r[1]),[0,1,0],(0,Nr.Z)(r[0]),[0,0,1],(0,Nr.Z)(r[1]),[0,1,0,r[0][0],r[1][1],0,0,0]),i=[0,1,2,3,4,5];return{vertices:n,indices:i,size:5}}function Ld(e,r){for(var n=r.segmentNumber,i=n===void 0?30:n,a=e.coordinates,s=[],c=[],d=function(A){s.push(A,1,A,a[0][0],a[0][1],a[1][0],a[1][1],A,-1,A,a[0][0],a[0][1],a[1][0],a[1][1]),A!==i-1&&c.push.apply(c,(0,Nr.Z)([0,1,2,1,3,2].map(function(C){return A*2+C})))},g=0;g<i;g++)d(g);return{vertices:s,indices:c,size:7}}function Xp(e){var r=e.coordinates;r.length===2&&r.push(0);var n=xp(-1,1),i=xp(1,1),a=xp(-1,-1),s=xp(1,-1),c=[].concat(_toConsumableArray(r),_toConsumableArray(n),_toConsumableArray(r),_toConsumableArray(a),_toConsumableArray(r),_toConsumableArray(s),_toConsumableArray(r),_toConsumableArray(i)),d=[0,1,2,3,0,2];return{vertices:c,indices:d,size:5}}function bs(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(th&&th[e])return th[e];var n=zh[e]?zh[e]():zh.cylinder(),i=dp([n],r);return th[e]=i,i}function df(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=new Float32Array(e.length/n*3),s,c,d,g=vec3.create(),_=vec3.create(),A=vec3.create(),C=0,N=r.length;C<N;C+=3){s=r[C+0]*3,c=r[C+1]*3,d=r[C+2]*3;var ae=[e[s],e[s+1]],we=[e[c],e[c+1]],De=[e[d],e[d+1]];i&&(ae=lngLatToMeters(ae),we=lngLatToMeters(we),De=lngLatToMeters(De));var at=ae,Ot=_slicedToArray(at,2),Pt=Ot[0],Kt=Ot[1],hr=vec3.fromValues(Pt,Kt,e[s+2]),jr=we,pr=_slicedToArray(jr,2),rr=pr[0],Ur=pr[1],$n=vec3.fromValues(rr,Ur,e[c+2]),Ai=De,Wn=_slicedToArray(Ai,2),Xi=Wn[0],oa=Wn[1],Es=vec3.fromValues(Xi,oa,e[d+2]);vec3.sub(g,Es,$n),vec3.sub(_,hr,$n),vec3.cross(A,g,_),a[s]+=g[0],a[s+1]+=g[1],a[s+2]+=g[2],a[c]+=g[0],a[c+1]+=g[1],a[c+2]+=g[2],a[d]+=g[0],a[d+1]+=g[1],a[d+2]+=g[2]}return _m(a),a}function _m(e){for(var r=0,n=e.length;r<n;r+=3){var i=vec3.fromValues(e[r],e[r+1],e[r+2]),a=vec3.create();vec3.normalize(a,i),e.set(a,r)}}function Th(e){var r=e[0][0],n=e[0][e[0].length-1];return r[0]===n[0]&&r[1]===n[1]}function Bd(e){var r=["cylinder","triangleColumn","hexagonColumn","squareColumn"],n=geometryShape[e]?geometryShape[e]():geometryShape.circle(),i=r.indexOf(e)===-1?fillPolygon([n]):extrudePolygon([n]);return i}function xp(e,r){var n=(e+1)/2,i=(r+1)/2;return[n,i]}function Fd(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),r=e.positionsArr,n=e.indicesArr,i=e.normalArr;return{vertices:r,indices:n,size:5,normals:i}}function Uf(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),r=e.positionsArr,n=e.indicesArr,i=e.normalArr;return{vertices:r,indices:n,size:5,normals:i}}function Yp(e){var r=bp();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function bp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Kp=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,qp=`#define Animate 0.0
#define LineTexture 1.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9



  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  //\u8BA1\u7B97dashArray\u548CdistanceRatio \u8F93\u51FA\u5230\u7247\u5143
  vec2 s = source;
  vec2 t = target;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Nd={solid:0,dash:1},Sv=function(e){(0,Ei.Z)(n,e);var r=Yp(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.NEAREST,min:Y.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.textureBlend,g=d===void 0?"normal":d,_=a.lineType,A=_===void 0?"solid":_,C=a.dashArray,N=C===void 0?[10,5]:C,ae=a.forward,we=ae===void 0?!0:ae,De=a.lineTexture,at=De===void 0?!1:De,Ot=a.iconStep,Pt=Ot===void 0?100:Ot,Kt=a.segmentNumber,hr=Kt===void 0?30:Kt,jr=this.layer.getLayerConfig(),pr=jr.animateOption,rr=N;A!=="dash"&&(rr=[0,0]),rr.length===2&&rr.push(0,0);var Ur=0,$n=[0,0,0,0],Ai=[0,0,0,0];if(s&&c&&($n=(0,ke.CI)(s),Ai=(0,ke.CI)(c),Ur=1),this.rendererService.getDirty()){var Wn;(Wn=this.texture)===null||Wn===void 0||Wn.bind()}var Xi={u_animate:this.animateOption2Array(pr),u_dash_array:rr,u_sourceColor:$n,u_targetColor:Ai,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:hr,u_lineDir:we?1:-1,u_icon_step:Pt,u_line_texture:at?1:0,u_textureBlend:g==="normal"?0:1,u_blur:.9,u_line_type:Nd[A||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Ur},oa=this.getUniformsBufferInfo(Xi);return oa}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){return{frag:Kp,vert:qp,type:""}}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return this.initUniformsBuffer(),c=this.layer.getLayerConfig(),d=c.segmentNumber,g=d===void 0?30:d,_=this.getShaders(),A=_.frag,C=_.vert,N=_.type,De.next=5,this.layer.buildLayerModel({moduleName:"lineArc2d"+N,vertexShader:C,fragmentShader:A,inject:this.getInject(),triangulation:Ld,depth:{enable:!1},styleOption:{segmentNumber:g}});case 5:return ae=De.sent,De.abrupt("return",[ae]);case 7:case"end":return De.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?1:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Y.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(c,d,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.texture,_=d[g]||{x:0,y:0},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua);function Ep(e){var r=Tv();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Tv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Av=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

// varying vec2 v_normal;
in vec4 v_dash_array;
in vec4 v_color;
in vec4 v_line_data;
in float v_segmentIndex;
in vec2 v_iconMapUV;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Cv=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,wv={solid:0,dash:1},Ud=function(e){(0,Ei.Z)(n,e);var r=Ep(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.NEAREST,min:Y.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.textureBlend,g=d===void 0?"normal":d,_=a.lineType,A=_===void 0?"solid":_,C=a.dashArray,N=C===void 0?[10,5]:C,ae=a.lineTexture,we=ae===void 0?!1:ae,De=a.iconStep,at=De===void 0?100:De,Ot=a.segmentNumber,Pt=Ot===void 0?30:Ot,Kt=a.globalArcHeight,hr=Kt===void 0?10:Kt,jr=this.layer.getLayerConfig(),pr=jr.animateOption;N.length===2&&N.push(0,0);var rr=0,Ur=[0,0,0,0],$n=[0,0,0,0];if(s&&c&&(Ur=(0,ke.CI)(s),$n=(0,ke.CI)(c),rr=1),this.rendererService.getDirty()){var Ai;(Ai=this.texture)===null||Ai===void 0||Ai.bind()}var Wn={u_animate:this.animateOption2Array(pr),u_dash_array:N,u_sourceColor:Ur,u_targetColor:$n,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:ka,u_global_height:hr,segmentNumber:Pt,u_line_type:wv[A]||0,u_icon_step:at,u_line_texture:we?1:0,u_textureBlend:g==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:rr},Xi=this.getUniformsBufferInfo(Wn);return Xi}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),d.abrupt("return",this.buildModels());case 4:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){return{frag:Av,vert:Cv,type:""}}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return c=this.layer.getLayerConfig(),d=c.segmentNumber,g=d===void 0?30:d,_=this.getShaders(),A=_.frag,C=_.vert,N=_.type,De.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+N,vertexShader:C,fragmentShader:A,inject:this.getInject(),triangulation:Ld,styleOption:{segmentNumber:g}});case 4:return ae=De.sent,De.abrupt("return",[ae]);case 6:case"end":return De.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?1:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Y.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(c,d,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.texture,_=d[g]||{x:0,y:0},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua),Al={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},el=1/2;function Rv(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?1:a;return{vertices:[0,el*e,1*e*i,-(s+el)*e,1*e*i,(s-el)*e,0,el*e,1*e*i,-(s+el)*e,1*e*i,(s-el)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function vf(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,1*e*i,1*s,1*e*i,-1*s,0,0,1*e*i,1*s,1*e*i,-1*s],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function xm(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?2:a;return{vertices:[0,s/2,e*i*1,s/2,e*i*1,-s/2,0,-s/2,0,s/2,e*i*1,s/2,e*i*1,-s/2,0,-s/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Mv(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,1*i*e,.5*s,2*i*e,0,1*i*e,-.5*s,0,0,1*i*e,.5*s,2*i*e,0,1*i*e,-.5*s],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Ah(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,2*e*i,1*s,1.5*e*i,0,2*e*i,-1*s,0,0,2*e*i,1*s,1.5*e*i,0,2*e*i,-1*s],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function $h(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?2:a,c=_h(),d=Yo().flatten([c]),g=Yo()(d.vertices,d.holes,d.dimensions),_=c.map(function(A){return[A[0]*i*e,A[1]*s]}).flat();return{vertices:[].concat((0,Nr.Z)(_),(0,Nr.Z)(_)),dimensions:2,indices:g.map(function(A){return A+c.length}),outLineIndices:g,normals:[].concat((0,Nr.Z)(c.map(function(A){return[A[1]*s,A[0]*i*e,1]}).flat()),(0,Nr.Z)(new Array(c.length*3).fill(0)))}}function Hh(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=(0,zi.Z)(n.source)==="object"?n.source.type:n.source,a=(0,zi.Z)(n.target)==="object"?n.target.type:n.target,s=(0,zi.Z)(n.source)==="object"?n.source:{},c=s.width,d=c===void 0?i?Al[i]:0:c,g=(0,zi.Z)(n.target)==="object"?n.target:{},_=g.width,A=_===void 0?a?Al[a]:0:_;return{vertices:[0,el,1*d].concat((0,Nr.Z)(e),[1,el,-1*A],(0,Nr.Z)(e),[1,-el,-1*A],(0,Nr.Z)(e),[0,-el,1*d],(0,Nr.Z)(e),[0,el,1*d],(0,Nr.Z)(e),[1,el,-1*A],(0,Nr.Z)(e),[1,-el,-1*A],(0,Nr.Z)(e),[0,-el,1*d],(0,Nr.Z)(e)),outLineIndices:[0,1,2,0,2,3].map(function(C){return C+r}),indices:[4,5,6,4,6,7].map(function(C){return C+r}),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function Ch(e,r){var n=(0,zi.Z)(e)==="object"?e.type:e,i=r==="source"?1:-1,a=(0,zi.Z)(e)==="object"?e:{};switch(n){case"circle":return $h(i,a);case"triangle":return vf(i,a);case"diamond":return Mv(i,a);case"rect":return xm(i,a);case"classic":return Ah(i,a);case"halfTriangle":return Rv(i,a);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function Wh(e){var r=e.coordinates.flat(),n=1,i=1;return{vertices:[1,0,0].concat((0,Nr.Z)(r),[1,2,-3],(0,Nr.Z)(r),[1,1,-3],(0,Nr.Z)(r),[0,1,0],(0,Nr.Z)(r),[0,0,0],(0,Nr.Z)(r),[1,0,0],(0,Nr.Z)(r),[1,2,-3],(0,Nr.Z)(r),[1,1,-3],(0,Nr.Z)(r),[0,1,0],(0,Nr.Z)(r),[0,0,0],(0,Nr.Z)(r)),normals:[-n,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-n,-i,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Ov(e,r){return r?Iv(e,r):Wh(e)}function Iv(e,r){var n=e.coordinates.flat(),i=r,a=i.target,s=a===void 0?"classic":a,c=i.source,d=c===void 0?"circle":c,g=zd(Ch(d,"source"),n,0,0),_=Hh(n,g.vertices.length/7,r),A=zd(Ch(s,"target"),n,1,g.vertices.length/7+_.vertices.length/7),C={vertices:[].concat((0,Nr.Z)(g.vertices),(0,Nr.Z)(_.vertices),(0,Nr.Z)(A.vertices)),indices:[].concat((0,Nr.Z)(g.outLineIndices),(0,Nr.Z)(_.outLineIndices),(0,Nr.Z)(A.outLineIndices),(0,Nr.Z)(g.indices),(0,Nr.Z)(_.indices),(0,Nr.Z)(A.indices)),normals:[].concat((0,Nr.Z)(g.normals),(0,Nr.Z)(_.normals),(0,Nr.Z)(A.normals)),size:7};return C}function zd(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=[],s=e.vertices,c=e.indices,d=e.dimensions,g=e.outLineIndices,_=0;_<s.length;_+=d)a.push.apply(a,[n,s[_+1],s[_]].concat((0,Nr.Z)(r)));return(0,de.Z)((0,de.Z)({},e),{},{vertices:a,indices:c.map(function(A){return A+i}),outLineIndices:g.map(function(A){return A+i})})}function Pv(e){var r=Zd();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Zd(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vd=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,zf=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 13) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {

   vec2 data = project_pixel(offsets);
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return data;
  }

  return vec2(data.x, -data.y);;
}

vec2 line_dir(vec2 target, vec2 source) {

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return normalize(target - source);
  }
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}

float flag_gap() {
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return 1.;
  }
  return -1.;

}


void main() {

// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target,source);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x); // mapbox || \u9AD8\u5FB7
   
  vec2 position = mix(source, target, a_Position.x);
  
  float lengthCommon = length(project_position(vec4(target,0,1)) - project_position(vec4(source,0,1)));  //    
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
   project_pixel(-lengthCommon*.2), project_pixel(lengthCommon*.2)
  );


  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y)); // mapbox || \u9AD8\u5FB7

  float gapCommon = flag_gap() * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir *  (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));



  setPickingColor(a_PickingColor);
}
`,kv=function(e){(0,Ei.Z)(n,e);var r=Pv(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.gapWidth,c=s===void 0?2:s,d=a.strokeWidth,g=d===void 0?1:d,_=a.strokeOpacity,A=_===void 0?1:_,C={u_gap_width:c,u_stroke_width:g,u_stroke_opacity:A},N=this.getUniformsBufferInfo(C);return N}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),d.abrupt("return",this.buildModels());case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:zf,fragmentShader:Vd,inject:this.getInject(),triangulation:Ov,styleOption:this.layer.getLayerConfig().symbol,primitive:Y.gl.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return c=g.sent,g.abrupt("return",[c]);case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s){var c=s.size,d=c===void 0?1:c;return Array.isArray(d)?[d[0],d[1]]:[d,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Y.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(s,c,d){return[d[3],d[4],d[5],d[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s,c,d,g,_){return _}}})}}]),n}(Ua);function jd(e){var r=$d();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function $d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Dv=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_line_data;
in vec2 v_iconMapUV;
in vec4 v_dash_array;
in float v_distance_ratio;
in vec4 v_color;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,Hd=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
  mix(source, target, segmentRatio),
  sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }
  else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,Lv={solid:0,dash:1},Bv=function(e){(0,Ei.Z)(n,e);var r=jd(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.NEAREST,min:Y.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.textureBlend,g=d===void 0?"normal":d,_=a.lineType,A=_===void 0?"solid":_,C=a.dashArray,N=C===void 0?[10,5]:C,ae=a.lineTexture,we=ae===void 0?!1:ae,De=a.iconStep,at=De===void 0?100:De,Ot=a.segmentNumber,Pt=Ot===void 0?30:Ot,Kt=this.layer.getLayerConfig(),hr=Kt.animateOption;if(N.length===2&&N.push(0,0),this.rendererService.getDirty()){var jr;(jr=this.texture)===null||jr===void 0||jr.bind()}var pr=0,rr=[0,0,0,0],Ur=[0,0,0,0];s&&c&&(rr=(0,ke.CI)(s),Ur=(0,ke.CI)(c),pr=1);var $n=this.layer.getLayerAnimateTime();isNaN($n)&&($n=0);var Ai={u_animate:this.animateOption2Array(hr),u_dash_array:N,u_sourceColor:rr,u_targetColor:Ur,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:Pt,u_line_type:Lv[A]||0,u_icon_step:at,u_line_texture:we?1:0,u_textureBlend:g==="normal"?0:1,u_time:$n,u_linearColor:pr},Wn=this.getUniformsBufferInfo(Ai);return Wn}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),d.abrupt("return",this.buildModels());case 4:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.layer.getLayerConfig(),d=c.segmentNumber,g=d===void 0?30:d,C.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:Hd,fragmentShader:Dv,triangulation:Ld,styleOption:{segmentNumber:g},inject:this.getInject(),depth:{enable:!1}});case 3:return _=C.sent,C.abrupt("return",[_]);case 5:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?1:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Y.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(c,d,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.texture,_=d[g]||{x:0,y:0},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua),Fv=function(e){return e[e.solid=0]="solid",e[e.dash=1]="dash",e}({}),Wd=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),Sp=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),Qp=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({}),Gd=function(e){return e.ALWAYS="always",e.DRAGEND="dragend",e}({});function bm(e){var r=Nv();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Nv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Em=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,Sm=`
#define Animate 0.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 10) in vec3 a_DistanceAndIndexAndMiter;
layout(location = 13) in vec4 a_Normal_Total_Distance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};


out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Uv=function(e){(0,Ei.Z)(n,e);var r=bm(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"textureEventFlag",!1),(0,ue.Z)((0,cn.Z)(i),"texture",i.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.textures.length===0&&(i.textures=[i.texture]),i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.NEAREST,min:Y.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.textureBlend,g=d===void 0?"normal":d,_=a.lineType,A=_===void 0?"solid":_,C=a.dashArray,N=C===void 0?[10,5,0,0]:C,ae=a.lineTexture,we=ae===void 0?!1:ae,De=a.iconStep,at=De===void 0?100:De,Ot=a.vertexHeightScale,Pt=Ot===void 0?20:Ot,Kt=a.strokeWidth,hr=Kt===void 0?0:Kt,jr=a.raisingHeight,pr=jr===void 0?0:jr,rr=a.heightfixed,Ur=rr===void 0?!1:rr,$n=a.linearDir,Ai=$n===void 0?Wd.VERTICAL:$n,Wn=a.blur,Xi=Wn===void 0?[1,1,1,0]:Wn,oa=N;if(A!=="dash"&&(oa=[0,0,0,0]),oa.length===2&&oa.push(0,0),this.rendererService.getDirty()&&this.texture){var Es;(Es=this.texture)===null||Es===void 0||Es.bind()}var Nu=this.layer.getLayerConfig(),nl=Nu.animateOption,Wc=0,Mc=[0,0,0,0],ml=[0,0,0,0];s&&c&&(Mc=(0,ke.CI)(s),ml=(0,ke.CI)(c),Wc=1);var xf={u_animate:this.animateOption2Array(nl),u_dash_array:oa,u_blur:Xi,u_sourceColor:Mc,u_targetColor:ml,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:at,u_heightfixed:Number(Ur),u_vertexScale:Pt,u_raisingHeight:Number(pr),u_strokeWidth:hr,u_textureBlend:g===Sp.NORMAL?0:1,u_line_texture:we?1:0,u_linearDir:Ai===Wd.VERTICAL?1:0,u_linearColor:Wc,u_time:this.layer.getLayerAnimateTime()||0},Wm=this.getUniformsBufferInfo(xf);return Wm}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return c=this.layer.getLayerConfig(),d=c.depth,g=d===void 0?!1:d,_=this.getShaders(),A=_.frag,C=_.vert,N=_.type,this.layer.triangulation=ke.sN,De.next=5,this.layer.buildLayerModel({moduleName:"line"+N,vertexShader:C,fragmentShader:A,triangulation:ke.sN,inject:this.getInject(),depth:{enable:g}});case 5:return ae=De.sent,De.abrupt("return",[ae]);case 7:case"end":return De.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:Em,vert:Sm,type:""}}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Y.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:10,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(c,d,g,_,A,C){return C===void 0?[g[3],10,g[4]]:[g[3],C,g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=c.size,g=d===void 0?1:d;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:Y.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(c,d,g,_,A){return[].concat((0,Nr.Z)(A),[g[5]])}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.texture,_=d[g]||{x:0,y:0},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua);function Tm(e){var r=Am();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Am(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cm=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,wm=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color; 
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_SizeDistanceAndTotalDistance.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_SizeDistanceAndTotalDistance.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,Rm=function(e){(0,Ei.Z)(n,e);var r=Tm(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.lineType,g=d===void 0?"solid":d,_=a.dashArray,A=_===void 0?[10,5,0,0]:_,C=a.vertexHeightScale,N=C===void 0?20:C,ae=A;g!=="dash"&&(ae=[0,0,0,0]),ae.length===2&&ae.push(0,0);var we=0,De=[0,0,0,0],at=[0,0,0,0];s&&c&&(De=(0,ke.CI)(s),at=(0,ke.CI)(c),we=1);var Ot={u_sourceColor:De,u_targetColor:at,u_dash_array:ae,u_vertexScale:N,u_linearColor:we},Pt=this.getUniformsBufferInfo(Ot);return Pt}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:Cm,vert:wm,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return this.initUniformsBuffer(),c=this.getShaders(),d=c.frag,g=c.vert,_=c.type,N.next=4,this.layer.buildLayerModel({moduleName:_,vertexShader:g,fragmentShader:d,triangulation:Vh,inject:this.getInject(),primitive:Y.gl.LINES,depth:{enable:!1},pick:!1});case 4:return A=N.sent,N.abrupt("return",[A]);case 6:case"end":return N.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:Y.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:4,update:function(s,c,d){var g=s.size,_=g===void 0?1:g,A=Array.isArray(_)?[_[0],_[1]]:[_,0];return[A[0],A[1],d[3],d[5]]}}})}}]),n}(Ua);function mf(e){var r=Jp();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Jp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zv=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};
in vec2 v_iconMapUV;
in float v_blur;
in float v_radio;
in vec4 v_color;
in vec4 v_dataset;

out vec4 outputColor;
#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,Tp=`#define Animate 0.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 10) in float a_Miter;
layout(location = 11) in float a_Total_Distance;
layout(location = 12) in vec4 a_Instance;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec2 a_iconMapUV;
layout(location = 15) in float a_Distance;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};
#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out float v_radio;
out vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {    
     originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }


  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Zv=function(e){(0,Ei.Z)(n,e);var r=mf(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.NEAREST,min:Y.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,d=a.textureBlend,g=d===void 0?"normal":d,_=a.heightfixed,A=_===void 0?!1:_,C=a.lineTexture,N=C===void 0?!1:C,ae=a.iconStep,we=ae===void 0?100:ae,De=a.iconStepCount,at=De===void 0?1:De,Ot=this.layer.getLayerConfig(),Pt=Ot.animateOption;if(this.rendererService.getDirty()){var Kt;(Kt=this.texture)===null||Kt===void 0||Kt.bind()}var hr=0,jr=[0,0,0,0],pr=[0,0,0,0];s&&c&&(jr=(0,ke.CI)(s),pr=(0,ke.CI)(c),hr=1);var rr={u_animate:this.animateOption2Array(Pt),u_sourceColor:jr,u_targetColor:pr,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:we,u_heightfixed:Number(A),u_linearColor:hr,u_line_texture:N?1:0,u_textureBlend:g==="normal"?0:1,u_iconStepCount:at,u_time:this.layer.getLayerAnimateTime()||0},Ur=this.getUniformsBufferInfo(rr);return Ur}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),d.abrupt("return",this.buildModels());case 4:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:Tp,fragmentShader:zv,triangulation:yp,inject:this.getInject(),depth:{enable:!1},blend:this.getBlend()});case 2:return c=g.sent,g.abrupt("return",[c]);case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Y.GC.Attribute,descriptor:{name:"a_Distance",shaderLocation:15,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c,d,g){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Y.GC.Attribute,descriptor:{name:"a_Total_Distance",shaderLocation:11,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c,d,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=c.size,g=d===void 0?1:d;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(c,d,g,_,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Y.GC.Attribute,descriptor:{name:"a_Miter",shaderLocation:10,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c,d,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.texture,_=d[g]||{x:0,y:0},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua),h0={arc:Sv,arc3d:Ud,greatcircle:Bv,wall:Zv,line:Uv,simple:Rm,flowline:kv,earthArc3d:Ud},p0=h0;function d0(e){var r=v0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function v0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Mm=function(e){(0,Ei.Z)(n,e);var r=d0(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","LineLayer"),(0,ue.Z)((0,cn.Z)(i),"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,ue.Z)((0,cn.Z)(i),"arrowInsertCount",0),(0,ue.Z)((0,cn.Z)(i),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new p0[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}};return s[a]}},{key:"getModelType",value:function(){var a;if(this.layerType)return this.layerType;var s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(a=s.scale)===null||a===void 0?void 0:a.field;return c||"line"}},{key:"processData",value:function(a){if(this.getModelType()!=="simple")return a;var s=[];return a.map(function(c){if(Array.isArray(c.coordinates)&&Array.isArray(c.coordinates[0])&&Array.isArray(c.coordinates[0][0])){var d=(0,de.Z)({},c);c.coordinates.map(function(g){s.push((0,de.Z)((0,de.Z)({},d),{},{coordinates:g}))})}else s.push(c)}),s}}]),n}(ko);function m0(e){var r=g0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function g0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y0=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,_0=`#define pi 3.1415926535

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec3 a_Size;
layout(location = 11) in vec3 a_Extrude;
layout(location = 13) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Extrude.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  gl_Position = project_common_position_to_clipspace_v2(pos);

  setPickingColor(a_PickingColor);
}
`,Xm=function(e){(0,Ei.Z)(n,e);var r=m0(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"raiseCount",0),(0,ue.Z)((0,cn.Z)(i),"raiseRepeat",0),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,d=a.sourceColor,g=a.targetColor,_=a.pickLight,A=_===void 0?!1:_,C=a.heightfixed,N=C===void 0?!1:C,ae=a.opacityLinear,we=ae===void 0?{enable:!1,dir:"up"}:ae,De=a.lightEnable,at=De===void 0?!0:De,Ot=0,Pt=[0,0,0,0],Kt=[0,0,0,0];if(d&&g&&(Pt=(0,ke.CI)(d),Kt=(0,ke.CI)(g),Ot=1),this.raiseCount<1&&this.raiseRepeat>0&&c.enable){var hr=c.speed,jr=hr===void 0?.01:hr;this.raiseCount+=jr,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}var pr={u_pickLight:Number(A),u_heightfixed:Number(N),u_r:c.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:Ot,u_sourceColor:Pt,u_targetColor:Kt,u_opacitylinear:Number(we.enable),u_opacitylinear_dir:we.dir==="up"?1:0,u_lightEnable:Number(at)},rr=this.getUniformsBufferInfo(pr);return rr}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C;return Pe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return c=this.layer.getLayerConfig(),d=c.depth,g=d===void 0?!0:d,_=c.animateOption.repeat,A=_===void 0?1:_,this.raiseRepeat=A,this.initUniformsBuffer(),ae.next=5,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:_0,fragmentShader:y0,triangulation:Zh,inject:this.getInject(),cull:{enable:!0,face:(0,ke.fj)(this.mapService.version)},depth:{enable:g}});case 5:return C=ae.sent,ae.abrupt("return",[C]);case 7:case"end":return ae.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s){var c=s.size;if(c){var d=[];return Array.isArray(c)&&(d=c.length===2?[c[0],c[0],c[1]]:c),Array.isArray(c)||(d=[c,c,c]),d}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s,c,d,g,_){return _}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Y.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:Z.EXTRUDE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s){var c=(0,ke.SI)(s.coordinates);return[c[0],c[1],0]}}})}}]),n}(Ua);function x0(e){var r=b0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function b0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var E0=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,S0=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in float a_Shape;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;   
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
  
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`,Ym=function(e){(0,Ei.Z)(n,e);var r=x0(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.strokeOpacity,c=s===void 0?1:s,d=a.strokeWidth,g=d===void 0?0:d,_=a.blend,A=a.blur,C=A===void 0?0:A,N=a.raisingHeight,ae=N===void 0?0:N,we=a.heightfixed,De=we===void 0?!1:we,at=a.unit,Ot=at===void 0?"pixel":at,Pt=this.getAnimateUniforms().u_time;isNaN(Pt)&&(Pt=-1);var Kt={u_blur_height_fixed:[C,Number(ae),Number(De)],u_stroke_width:g,u_additive:_==="additive"?1:0,u_stroke_opacity:c,u_size_unit:Qp[Ot],u_time:Pt,u_animate:this.getAnimateUniforms().u_animate},hr=this.getUniformsBufferInfo(Kt);return hr}},{key:"getAnimateUniforms",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1}:s;return{u_animate:this.animateOption2Array(c),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),ke.oX)}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return c=this.getShaders(),d=c.frag,g=c.vert,_=c.type,this.layer.triangulation=ke.oX,this.initUniformsBuffer(),N.next=5,this.layer.buildLayerModel({moduleName:_,vertexShader:g,fragmentShader:d,inject:this.getInject(),triangulation:ke.oX,depth:{enable:!1}});case 5:return A=N.sent,N.abrupt("return",[A]);case 7:case"end":return N.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:E0,vert:S0,type:"pointFill"}}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Y.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:Z.EXTRUDE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(c,d,g,_){var A=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],C=_%4*3;return[A[C],A[C+1],A[C+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?5:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Y.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:Z.SHAPE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.shape,g=d===void 0?2:d,_=a.indexOf(g);return[_]}}})}}]),n}(Ua);function T0(e){var r=A0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function A0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var C0=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,w0=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,Km=function(e){(0,Ei.Z)(n,e);var r=T0(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){i.layerService.throttleRenderLayers()});return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.LINEAR,min:Y.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0})}),i}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){if(this.rendererService.getDirty()){var a;(a=this.texture)===null||a===void 0||a.bind()}var s=this.getCommonUniformsInfo(),c=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},s.uniformsOption),c.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,d=a.heightfixed,g=d===void 0?!1:d,_={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(c),u_heightfixed:Number(g),u_texture:this.texture};this.textures=[this.texture];var A=this.getUniformsBufferInfo(_);return A}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:w0,fragmentShader:C0,triangulation:gp,inject:this.getInject(),depth:{enable:!1},primitive:Y.gl.POINTS});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?5:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.shape,_=d[g]||{x:-64,y:-64},A=_.x,C=_.y;return[A,C]}}})}}]),n}(Ua);function R0(e){var r=M0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function M0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O0=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,I0=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2., -a_Size /2., 0., 0.);
    gl_Position = project_common_position_to_clipspace(project_pos);
  }

  gl_PointSize = a_Size * u_size_scale *  2.0  * u_DevicePixelRatio;
}
`;function qm(e){var r=e.coordinates;return{vertices:(0,Nr.Z)(r),indices:[0],size:r.length}}var Qm=function(e){(0,Ei.Z)(n,e);var r=R0(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getCommonUniformsInfo",value:function(){var a={u_size_scale:.5},s=this.getUniformsBufferInfo(a);return s}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=qm,this.initUniformsBuffer(),g.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:I0,fragmentShader:O0,triangulation:qm,inject:this.getInject(),depth:{enable:!1},primitive:Y.gl.POINTS,pick:!1});case 4:return c=g.sent,g.abrupt("return",[c]);case 6:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(s){var c=s.size,d=c===void 0?1:c;return Array.isArray(d)?[d[0]]:[d]}}})}}]),n}(Ua),Om=x(98333),Xd=x(85975);function P0(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=k0(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function k0(e,r){if(e){if(typeof e=="string")return Jm(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jm(e,r)}}function Jm(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var D0=function(){function e(r,n,i){(0,Ue.Z)(this,e),(0,ue.Z)(this,"boxCells",[]);var a=this.boxCells;this.xCellCount=Math.ceil(r/i),this.yCellCount=Math.ceil(n/i);for(var s=0;s<this.xCellCount*this.yCellCount;s++)a.push([]);this.boxKeys=[],this.bboxes=[],this.width=r,this.height=n,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/n,this.boxUid=0}return(0,vt.Z)(e,[{key:"insert",value:function(n,i,a,s,c){this.forEachCell(i,a,s,c,this.insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(s),this.bboxes.push(c)}},{key:"query",value:function(n,i,a,s,c){return this.queryHitTest(n,i,a,s,!1,c)}},{key:"hitTest",value:function(n,i,a,s,c){return this.queryHitTest(n,i,a,s,!0,c)}},{key:"insertBoxCell",value:function(n,i,a,s,c,d){this.boxCells[c].push(d)}},{key:"queryHitTest",value:function(n,i,a,s,c,d){if(a<0||n>this.width||s<0||i>this.height)return c?!1:[];var g=[];if(n<=0&&i<=0&&this.width<=a&&this.height<=s){if(c)return!0;for(var _=0;_<this.boxKeys.length;_++)g.push({key:this.boxKeys[_],x1:this.bboxes[_*4],y1:this.bboxes[_*4+1],x2:this.bboxes[_*4+2],y2:this.bboxes[_*4+3]});return d?g.filter(d):g}var A={hitTest:c,seenUids:{box:{},circle:{}}};return this.forEachCell(n,i,a,s,this.queryCell,g,A,d),c?g.length>0:g}},{key:"queryCell",value:function(n,i,a,s,c,d,g,_){var A=g.seenUids,C=this.boxCells[c];if(C!==null){var N=this.bboxes,ae=P0(C),we;try{for(ae.s();!(we=ae.n()).done;){var De=we.value;if(!A.box[De]){A.box[De]=!0;var at=De*4;if(n<=N[at+2]&&i<=N[at+3]&&a>=N[at+0]&&s>=N[at+1]&&(!_||_(this.boxKeys[De]))){if(g.hitTest)return d.push(!0),!0;d.push({key:this.boxKeys[De],x1:N[at],y1:N[at+1],x2:N[at+2],y2:N[at+3]})}}}}catch(Ot){ae.e(Ot)}finally{ae.f()}}return!1}},{key:"forEachCell",value:function(n,i,a,s,c,d,g,_){for(var A=this.convertToXCellCoord(n),C=this.convertToYCellCoord(i),N=this.convertToXCellCoord(a),ae=this.convertToYCellCoord(s),we=A;we<=N;we++)for(var De=C;De<=ae;De++){var at=this.xCellCount*De+we;if(c.call(this,n,i,a,s,at,d,g,_))return}}},{key:"convertToXCellCoord",value:function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}},{key:"convertToYCellCoord",value:function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}}]),e}(),L0=D0,B0=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"viewportPadding",100),this.width=r,this.height=n,this.viewportPadding=Math.max(r,n),this.grid=new L0(r+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=r+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=r+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return(0,vt.Z)(e,[{key:"placeCollisionBox",value:function(n){var i=n.x1+n.anchorPointX+this.viewportPadding,a=n.y1+n.anchorPointY+this.viewportPadding,s=n.x2+n.anchorPointX+this.viewportPadding,c=n.y2+n.anchorPointY+this.viewportPadding;return!this.isInsideGrid(i,a,s,c)||this.grid.hitTest(i,a,s,c)?{box:[]}:{box:[i,a,s,c]}}},{key:"insertCollisionBox",value:function(n,i){var a={featureIndex:i};this.grid.insert(a,n[0],n[1],n[2],n[3])}},{key:"project",value:function(n,i,a){var s=Om.al(i,a,0,1),c=Om.Ue(),d=Xd.fromValues.apply(Xd,(0,Nr.Z)(n));return Om.fF(c,s,d),{x:(c[0]/c[3]+1)/2*this.width+this.viewportPadding,y:(-c[1]/c[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(n,i,a,s){return a>=0&&n<this.gridRightBoundary&&s>=0&&i<this.gridBottomBoundary}}]),e}();function eg(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=F0(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function F0(e,r){if(e){if(typeof e=="string")return tg(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tg(e,r)}}function tg(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function rg(e){var r=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0;break;default:r=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:r,verticalAlign:n}}function ng(e,r,n,i,a){if(a){var s=e[i],c=s.glyph;if(c)for(var d=r[c].advance*s.scale,g=(e[i].x+d)*a,_=n;_<=i;_++)e[_].x-=g}}function ig(e,r,n,i,a,s,c){var d=(r-n)*a,g=(-i*c+.5)*s,_=eg(e),A;try{for(_.s();!(A=_.n()).done;){var C=A.value;C.x+=d,C.y+=g}}catch(N){_.e(N)}finally{_.f()}}function N0(e,r,n,i,a,s,c){var d=-8,g=0,_=d,A=0,C=e.positionedGlyphs,N=s==="right"?1:s==="left"?0:.5,ae=C.length;n.forEach(function(Pt){if(Pt.split("").forEach(function(hr){var jr=r[hr],pr=0;jr&&(C.push({glyph:hr,x:g,y:_+pr,vertical:!1,scale:1,metrics:jr}),g+=jr.advance+c)}),C.length!==ae){var Kt=g-c;A=Math.max(Kt,A),ng(C,r,ae,C.length-1,N)}g=0,_-=i+5});var we=rg(a),De=we.horizontalAlign,at=we.verticalAlign;ig(C,N,De,at,A,i,n.length);var Ot=_-d;e.top+=-at*Ot,e.bottom=e.top-Ot,e.left+=-De*A,e.right=e.left+A}function U0(e,r,n,i,a,s,c){var d=-8,g=0,_=d,A=0,C=e.positionedGlyphs,N=s==="right"?1:s==="left"?0:.5,ae=C.length;n.forEach(function(Pt){var Kt=r[Pt],hr=0;if(Kt&&(C.push({glyph:Pt,x:Kt.advance/2,y:_+hr,vertical:!1,scale:1,metrics:Kt}),g+=Kt.advance+c),C.length!==ae){var jr=g-c;A=Math.max(jr,A),ng(C,r,ae,C.length-1,N)}g=0,_-=i+5});var we=rg(a),De=we.horizontalAlign,at=we.verticalAlign;ig(C,N,De,at,A,i,n.length);var Ot=_-d;e.top+=-at*Ot,e.bottom=e.top-Ot,e.left+=-De*A,e.right=e.left+A}function z0(e,r,n,i,a,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],d=arguments.length>7?arguments[7]:void 0,g=e.split(`
`),_=[],A={positionedGlyphs:_,top:c[1],bottom:c[1],left:c[0],right:c[0],lineCount:g.length,text:e};return d?U0(A,r,g,n,i,a,s):N0(A,r,g,n,i,a,s),_.length?A:!1}function Z0(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],n=arguments.length>2?arguments[2]:void 0,i=e.positionedGlyphs,a=i===void 0?[]:i,s=[],c=eg(a),d;try{for(c.s();!(d=c.n()).done;){var g=d.value,_=g.metrics,A=4,C=_.advance*g.scale/2,N=n?[g.x+C,g.y]:[0,0],ae=n?[0,0]:[g.x+C+r[0],g.y+r[1]],we=(0-A)*g.scale-C+ae[0],De=(0-A)*g.scale+ae[1],at=we+_.width*g.scale,Ot=De+_.height*g.scale,Pt={x:we,y:De},Kt={x:at,y:De},hr={x:we,y:Ot},jr={x:at,y:Ot};s.push({tl:Pt,tr:Kt,bl:hr,br:jr,tex:_,glyphOffset:N})}}catch(pr){c.e(pr)}finally{c.f()}return s}function V0(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=j0(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function j0(e,r){if(e){if(typeof e=="string")return ag(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ag(e,r)}}function ag(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function $0(e){var r=H0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function H0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var og=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,sg=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in vec2 a_textOffsets;
layout(location = 14) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,Yd=ke.rU.isEqual;function ug(e){var r=this,n=e.id,i=[],a=[];if(!r.glyphInfoMap||!r.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var s=r.glyphInfoMap[n].centroid,c=s.length===2?[s[0],s[1],0]:s;return r.glyphInfoMap[n].glyphQuads.forEach(function(d,g){i.push.apply(i,(0,Nr.Z)(c).concat([d.tex.x,d.tex.y+d.tex.height,d.tl.x,d.tl.y],(0,Nr.Z)(c),[d.tex.x+d.tex.width,d.tex.y+d.tex.height,d.tr.x,d.tr.y],(0,Nr.Z)(c),[d.tex.x+d.tex.width,d.tex.y,d.br.x,d.br.y],(0,Nr.Z)(c),[d.tex.x,d.tex.y,d.bl.x,d.bl.y])),a.push(0+g*4,1+g*4,2+g*4,2+g*4,3+g*4,0+g*4)}),{vertices:i,indices:a,size:7}}var lg=function(e){(0,Ei.Z)(n,e);var r=$0(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"glyphInfoMap",{}),(0,ue.Z)((0,cn.Z)(i),"currentZoom",-1),(0,ue.Z)((0,cn.Z)(i),"textureHeight",0),(0,ue.Z)((0,cn.Z)(i),"textCount",0),(0,ue.Z)((0,cn.Z)(i),"preTextStyle",{}),(0,ue.Z)((0,cn.Z)(i),"mapping",(0,qe.Z)(Pe().mark(function d(){return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return i.initGlyph(),i.updateTexture(),_.next=4,i.reBuildModel();case 4:case"end":return _.stop()}},d)}))),i}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption),{u_sdf_map:this.textures[0]})}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.stroke,c=s===void 0?"#fff":s,d=a.strokeWidth,g=d===void 0?0:d,_=a.halo,A=_===void 0?.5:_,C=a.gamma,N=C===void 0?2:C,ae=a.raisingHeight,we=ae===void 0?0:ae,De=this.getFontServiceMapping(),at=this.getFontServiceCanvas();De&&Object.keys(De).length!==this.textCount&&at&&(this.updateTexture(),this.textCount=Object.keys(De).length),this.preTextStyle=this.getTextStyle();var Ot={u_stroke_color:(0,ke.CI)(c),u_sdf_map_size:[(at==null?void 0:at.width)||1,(at==null?void 0:at.height)||1],u_raisingHeight:Number(we),u_stroke_width:g,u_gamma_scale:N,u_halo_blur:A},Pt=this.getUniformsBufferInfo(Ot);return Pt}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),this.initUniformsBuffer(),d.abrupt("return",this.buildModels());case 6:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.layer.getLayerConfig(),d=c.textAllowOverlap,g=d===void 0?!1:d,this.initGlyph(),this.updateTexture(),g||this.filterGlyphs(),C.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:sg,fragmentShader:og,inject:this.getInject(),triangulation:ug.bind(this),depth:{enable:!1}});case 6:return _=C.sent,C.abrupt("return",[_]);case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"needUpdate",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae,we,De,at,Ot;return Pe().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:if(c=this.getTextStyle(),d=c.textAllowOverlap,g=d===void 0?!1:d,_=c.textAnchor,A=_===void 0?"center":_,C=c.textOffset,N=c.padding,ae=c.fontFamily,we=c.fontWeight,!(!Yd(N,this.preTextStyle.padding)||!Yd(C,this.preTextStyle.textOffset)||!Yd(A,this.preTextStyle.textAnchor)||!Yd(ae,this.preTextStyle.fontFamily)||!Yd(we,this.preTextStyle.fontWeight))){Kt.next=5;break}return Kt.next=4,this.mapping();case 4:return Kt.abrupt("return",!0);case 5:if(!g){Kt.next=7;break}return Kt.abrupt("return",!1);case 7:if(De=this.mapService.getZoom(),at=this.mapService.getBounds(),Ot=(0,ke.oO)(this.extent,at),!(Math.abs(this.currentZoom-De)>.5||!Ot||g!==this.preTextStyle.textAllowOverlap)){Kt.next=14;break}return Kt.next=13,this.reBuildModel();case 13:return Kt.abrupt("return",!0);case 14:return Kt.abrupt("return",!1);case 15:case"end":return Kt.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Y.GC.Attribute,descriptor:{shaderLocation:10,name:"a_textOffsets",buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[5],d[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Y.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[3],d[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(s){var c=s.size,d=c===void 0?12:c;return Array.isArray(d)?[d[0]]:[d]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var a=this.mapService.getBounds();return(0,ke.yA)(a,.5)}},{key:"initTextFont",value:function(){var a=this.getTextStyle(),s=a.fontWeight,c=a.fontFamily,d=this.rawEncodeData,g=[];d.forEach(function(_){var A=_.shape,C=A===void 0?"":A;C=C.toString();var N=V0(C),ae;try{for(N.s();!(ae=N.n()).done;){var we=ae.value;g.indexOf(we)===-1&&g.push(we)}}catch(De){N.e(De)}finally{N.f()}}),this.fontService.setFontOptions({characterSet:g,fontWeight:s,fontFamily:c,iconfont:!1})}},{key:"initIconFontTex",value:function(){var a=this.getTextStyle(),s=a.fontWeight,c=a.fontFamily,d=this.rawEncodeData,g=[];d.forEach(function(_){var A=_.shape,C=A===void 0?"":A;C="".concat(C),g.indexOf(C)===-1&&g.push(C)}),this.fontService.setFontOptions({characterSet:g,fontWeight:s,fontFamily:c,iconfont:!0})}},{key:"getTextStyle",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,d=a.fontFamily,g=d===void 0?"sans-serif":d,_=a.textAllowOverlap,A=_===void 0?!1:_,C=a.padding,N=C===void 0?[0,0]:C,ae=a.textAnchor,we=ae===void 0?"center":ae,De=a.textOffset,at=De===void 0?[0,0]:De,Ot=a.opacity,Pt=Ot===void 0?1:Ot,Kt=a.strokeOpacity,hr=Kt===void 0?1:Kt,jr=a.strokeWidth,pr=jr===void 0?0:jr,rr=a.stroke,Ur=rr===void 0?"#000":rr;return{fontWeight:c,fontFamily:g,textAllowOverlap:A,padding:N,textAnchor:we,textOffset:at,opacity:Pt,strokeOpacity:hr,strokeWidth:pr,stroke:Ur}}},{key:"generateGlyphLayout",value:function(a){var s=this,c=this.getFontServiceMapping(),d=this.layer.getLayerConfig(),g=d.spacing,_=g===void 0?2:g,A=d.textAnchor,C=A===void 0?"center":A,N=d.textOffset,ae=this.rawEncodeData;this.glyphInfo=ae.map(function(we){var De=we.shape,at=De===void 0?"":De,Ot=we.id,Pt=we.size,Kt=Pt===void 0?1:Pt,hr=we.textOffset?we.textOffset:N||[0,0],jr=we.textAnchor?we.textAnchor:C||"center",pr=z0(at.toString(),c,Kt,jr,"left",_,hr,a),rr=Z0(pr,hr,!1);return we.shaping=pr,we.glyphQuads=rr,we.centroid=(0,ke.SI)(we.coordinates),we.originCentroid=we.version==="GAODE2.x"?(0,ke.SI)(we.originCoordinates):we.originCentroid=we.centroid,s.glyphInfoMap[Ot]={shaping:pr,glyphQuads:rr,centroid:(0,ke.SI)(we.coordinates)},we})}},{key:"getFontServiceMapping",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,d=a.fontFamily,g=d===void 0?"sans-serif":d;return this.fontService.getMappingByKey("".concat(g,"_").concat(c))}},{key:"getFontServiceCanvas",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,d=a.fontFamily,g=d===void 0?"sans-serif":d;return this.fontService.getCanvasByKey("".concat(g,"_").concat(c))}},{key:"filterGlyphs",value:function(){var a=this,s=this.layer.getLayerConfig(),c=s.padding,d=c===void 0?[0,0]:c,g=s.textAllowOverlap,_=g===void 0?!1:g;if(!_){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var A=this.rendererService.getViewportSize(),C=A.width,N=A.height,ae=new B0(C,N),we=this.glyphInfo.filter(function(De){var at=De.shaping,Ot=De.id,Pt=Ot===void 0?0:Ot,Kt=De.version==="GAODE2.x"?De.originCentroid:De.centroid,hr=De.size,jr=hr/16,pr=a.mapService.lngLatToContainer(Kt),rr=ae.placeCollisionBox({x1:at.left*jr-d[0],x2:at.right*jr+d[0],y1:at.top*jr-d[1],y2:at.bottom*jr+d[1],anchorPointX:pr.x,anchorPointY:pr.y}),Ur=rr.box;return Ur&&Ur.length?(ae.insertCollisionBox(Ur,Pt),!0):!1});we.forEach(function(De){a.glyphInfoMap[De.id]=De})}}},{key:"initGlyph",value:function(){var a=this.layer.getLayerConfig(),s=a.iconfont,c=s===void 0?!1:s;c?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(c)}},{key:"updateTexture",value:function(){var a=this.rendererService.createTexture2D,s=this.getFontServiceCanvas();this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=a({data:s,mag:Y.gl.LINEAR,min:Y.gl.LINEAR,width:s.width,height:s.height}),this.textures=[this.texture]}},{key:"reBuildModel",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.filterGlyphs(),g.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:sg,fragmentShader:og,triangulation:ug.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:c=g.sent,this.layer.models=[c];case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()}]),n}(Ua);function W0(e){return Im.apply(this,arguments)}function Im(){return Im=(0,qe.Z)(Pe().mark(function e(r){var n,i,a;return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!window.createImageBitmap){c.next=14;break}return c.next=3,fetch(r);case 3:return n=c.sent,c.t0=createImageBitmap,c.next=7,n.blob();case 7:return c.t1=c.sent,c.next=10,(0,c.t0)(c.t1);case 10:return i=c.sent,c.abrupt("return",i);case 14:return a=new window.Image,c.abrupt("return",new Promise(function(d){a.onload=function(){return d(a)},a.src=r,a.crossOrigin="Anonymous"}));case 16:case"end":return c.stop()}},e)})),Im.apply(this,arguments)}function G0(e){var r=X0();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function X0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Y0=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,K0=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


 gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,q0=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,Q0=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;


layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;
   
  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));



  setPickingColor(a_PickingColor);
}
`,J0=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,ey=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;


layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,ty=function(e){(0,Ei.Z)(n,e);var r=G0(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.mapTexture,c=a.heightfixed,d=c===void 0?!1:c,g=a.raisingHeight,_=g===void 0?0:g,A=a.topsurface,C=A===void 0?!0:A,N=a.sidesurface,ae=N===void 0?!0:N,we=a.sourceColor,De=a.targetColor,at=0,Ot=[1,1,1,1],Pt=[1,1,1,1];we&&De&&(Ot=(0,ke.CI)(we),Pt=(0,ke.CI)(De),at=1);var Kt={u_sourceColor:Ot,u_targetColor:Pt,u_linearColor:at,u_topsurface:Number(C),u_sidesurface:Number(ae),u_heightfixed:Number(d),u_raisingHeight:Number(_)};s&&this.texture&&(Kt.u_texture=this.texture,this.textures=[this.texture]);var hr=this.getUniformsBufferInfo(Kt);return hr}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.loadTexture();case 2:return d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return c=this.getShaders(),d=c.frag,g=c.vert,_=c.type,this.initUniformsBuffer(),N.next=4,this.layer.buildLayerModel({moduleName:_,vertexShader:g,fragmentShader:d,depth:{enable:!0},inject:this.getInject(),triangulation:Gp});case 4:return A=N.sent,N.abrupt("return",[A]);case 6:case"end":return N.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){var a=this.layer.getLayerConfig(),s=a.pickLight,c=a.mapTexture;return c?{frag:q0,vert:Q0,type:"polygonExtrudeTexture"}:s?{frag:J0,vert:ey,type:"polygonExtrudePickLight"}:{frag:Y0,vert:K0,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.textures=[]}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=a,c=this.layer.coordCenter||this.layer.getSource().center,d=s[2]-s[0],g=s[3]-s[1];if(this.mapService.version==="GAODE2.x"){var _=this.mapService.coordToAMap2RelativeCoordinates([a[0],a[1]],c),A=(0,ji.Z)(_,2),C=A[0],N=A[1],ae=this.mapService.coordToAMap2RelativeCoordinates([a[2],a[3]],c),we=(0,ji.Z)(ae,2),De=we[0],at=we[1];d=De-C,g=at-N,s=[C,N,De,at]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Y.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:Z.UV,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(Pt,Kt,hr){var jr=hr[0],pr=hr[1];return[(jr-s[0])/d,(pr-s[1])/g,hr[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(Pt,Kt,hr,jr,pr){return pr}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(Pt){var Kt=Pt.size,hr=Kt===void 0?10:Kt;return Array.isArray(hr)?[hr[0]]:[hr]}}})}},{key:"loadTexture",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(c=this.layer.getLayerConfig(),d=c.mapTexture,g=this.rendererService.createTexture2D,this.texture=g({height:1,width:1}),!d){C.next=8;break}return C.next=6,W0(d);case 6:_=C.sent,this.texture=g({data:_,width:_.width,height:_.height,wrapS:Y.gl.CLAMP_TO_EDGE,wrapT:Y.gl.CLAMP_TO_EDGE,min:Y.gl.LINEAR,mag:Y.gl.LINEAR});case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()}]),n}(Ua);function ry(e){var r=ny();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ny(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iy=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,ay=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos);
   float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`,oy=function(e){(0,Ei.Z)(n,e);var r=ry(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a={},s=this.getUniformsBufferInfo(a);return s}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return c=this.getShaders(),d=c.frag,g=c.vert,_=c.type,this.initUniformsBuffer(),N.next=4,this.layer.buildLayerModel({moduleName:_,vertexShader:g,fragmentShader:d,inject:this.getInject(),triangulation:Gp,depth:{enable:!0}});case 4:return A=N.sent,N.abrupt("return",[A]);case 6:case"end":return N.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:iy,vert:ay,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s,c,d,g,_){return _}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(s){var c=s.size,d=c===void 0?10:c;return Array.isArray(d)?[d[0]]:[d]}}})}}]),n}(Ua);function sy(e){var r=uy();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function uy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ly=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,cy=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,fy=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 15) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}`,hy=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};


out vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

 
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,py=function(e){(0,Ei.Z)(n,e);var r=sy(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,d=a.opacityLinear,g=d===void 0?{enable:!1,dir:"in"}:d,_={u_raisingHeight:Number(c),u_opacitylinear:Number(g.enable),u_dir:g.dir==="in"?1:0},A=this.getUniformsBufferInfo(_);return A}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C;return Pe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return c=this.getModelParams(),d=c.frag,g=c.vert,_=c.triangulation,A=c.type,this.initUniformsBuffer(),this.layer.triangulation=_,ae.next=5,this.layer.buildLayerModel({moduleName:A,vertexShader:g,fragmentShader:d,inject:this.getInject(),triangulation:_,primitive:Y.gl.TRIANGLES,depth:{enable:!1}});case 5:return C=ae.sent,ae.abrupt("return",[C]);case 7:case"end":return ae.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getLayerConfig(),s=a.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s;c.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Y.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:Z.LINEAR,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(g,_,A){return[A[3],A[4],A[5]]}}})}},{key:"getModelParams",value:function(){var a=this.layer.getLayerConfig(),s=a.opacityLinear,c=s===void 0?{enable:!1}:s;return c.enable?{frag:cy,vert:fy,type:"polygonLinear",triangulation:Dd}:{frag:ly,vert:hy,type:"polygonFill",triangulation:ke.yR}}}]),n}(Ua);function dy(e){var r=vy();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function vy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gy=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,yy=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};


out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,_y=function(e){(0,Ei.Z)(n,e);var r=dy(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.watercolor,c=s===void 0?"#6D99A8":s,d=a.watercolor2,g=d===void 0?"#0F121C":d,_={u_watercolor:(0,ke.CI)(c),u_watercolor2:(0,ke.CI)(g),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};this.textures=[this.texture1,this.texture2,this.texture3];var A=this.getUniformsBufferInfo(_);return A}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.loadTexture(),d.abrupt("return",this.buildModels());case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:yy,fragmentShader:gy,inject:this.getInject(),triangulation:nh,primitive:Y.gl.TRIANGLES,depth:{enable:!1}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a,s,c;(a=this.texture1)===null||a===void 0||a.destroy(),(s=this.texture2)===null||s===void 0||s.destroy(),(c=this.texture3)===null||c===void 0||c.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=(0,ji.Z)(a,4),c=s[0],d=s[1],g=s[2],_=s[3],A=g-c,C=_-d;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Y.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(ae,we,De,at){var Ot=ae.version==="GAODE2.x"?ae.originCoordinates[0][at]:De,Pt=(0,ji.Z)(Ot,2),Kt=Pt[0],hr=Pt[1];return[(Kt-c)/A,(hr-d)/C]}}})}},{key:"loadTexture",value:function(){var a=this,s=this.rendererService.createTexture2D,c={height:0,width:0};this.texture1=s(c),this.texture2=s(c),this.texture3=s(c),d(function(_){a.texture1=g(_[0]),a.texture2=g(_[1]),a.texture3=g(_[2]),a.layerService.reRender()});function d(_){var A=0,C=[],N=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];N.map(function(ae){var we=new Image;we.crossOrigin="",we.src=ae,C.push(we),we.onload=function(){A++,A===3&&_(C)}})}function g(_){return s({data:_,width:_.width,height:_.height,wrapS:Y.gl.MIRRORED_REPEAT,wrapT:Y.gl.MIRRORED_REPEAT,min:Y.gl.LINEAR,mag:Y.gl.LINEAR})}}}]),n}(Ua);function xy(e){var r=by();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function by(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ey=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,Sy=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 14) in vec2 a_uv;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;


#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,Ty=function(e){(0,Ei.Z)(n,e);var r=xy(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.speed,c=s===void 0?.5:s,d={u_speed:c,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};this.textures=[this.texture];var g=this.getUniformsBufferInfo(d);return g}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.loadTexture(),d.abrupt("return",this.buildModels());case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Sy,fragmentShader:Ey,triangulation:nh,inject:this.getInject(),primitive:Y.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=(0,ji.Z)(a,4),c=s[0],d=s[1],g=s[2],_=s[3],A=g-c,C=_-d;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Y.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(ae,we,De,at){var Ot=ae.version==="GAODE2.x"?ae.originCoordinates[0][at]:De,Pt=(0,ji.Z)(Ot,2),Kt=Pt[0],hr=Pt[1];return[(Kt-c)/A,(hr-d)/C]}}})}},{key:"loadTexture",value:function(){var a=this,s=this.layer.getLayerConfig(),c=s.waterTexture,d=this.rendererService.createTexture2D;this.texture=d({height:1,width:1});var g=new Image;g.crossOrigin="",c?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),g.src=c):g.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",g.onload=function(){a.texture=d({data:g,width:g.width,height:g.height,wrapS:Y.gl.MIRRORED_REPEAT,wrapT:Y.gl.MIRRORED_REPEAT,min:Y.gl.LINEAR,mag:Y.gl.LINEAR}),a.layerService.reRender()}}}]),n}(Ua),Ay={fill:py,line:Uv,extrude:ty,text:lg,point_fill:Ym,point_image:Km,point_normal:Qm,point_extrude:Xm,water:Ty,ocean:_y,extrusion:oy},Cy=Ay;function wy(e){var r=Ry();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Ry(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Pm=function(e){(0,Ei.Z)(n,e);var r=wy(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","PolygonLayer"),(0,ue.Z)((0,cn.Z)(i),"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new Cy[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelType",value:function(){var a,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(a=s.scale)===null||a===void 0?void 0:a.field;return c==="fill"||!c?"fill":c==="extrude"?"extrude":c==="extrusion"?"extrusion":c==="water"?"water":c==="ocean"?"ocean":c==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var a=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,d=s.shape3d,g=this.iconService.getIconMap(),_=a.find(function(C){return C.hasOwnProperty("shape")});if(_){var A=_.shape;return A==="dot"?"point_normal":(c==null?void 0:c.indexOf(A))!==-1?"point_fill":(d==null?void 0:d.indexOf(A))!==-1?"point_extrude":g.hasOwnProperty(A)?"point_image":"text"}else return"fill"}}]),n}(ko),My=function(){function e(r){var n=r.rendererService,i=r.layerService,a=r.parent;(0,Ue.Z)(this,e),(0,ue.Z)(this,"tileResource",new Map),(0,ue.Z)(this,"layerTiles",[]),this.rendererService=n,this.layerService=i,this.parent=a}return(0,vt.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(n){return this.layerTiles.some(function(i){return i.key===n})}},{key:"addTile",value:function(n){this.layerTiles.push(n)}},{key:"getTile",value:function(n){return this.layerTiles.find(function(i){return i.key===n})}},{key:"getVisibleTileBylngLat",value:function(n){return this.layerTiles.find(function(i){return i.isLoaded&&i.visible&&i.lnglatInBounds(n)})}},{key:"removeTile",value:function(n){var i=this.layerTiles.findIndex(function(s){return s.key===n}),a=this.layerTiles.splice(i,1);a[0]&&a[0].destroy()}},{key:"updateTileVisible",value:function(n){var i=this.getTile(n.key);if(n.isVisible)if(n.parent){var a=this.isChildrenLoaded(n.parent);i==null||i.updateVisible(a)}else i==null||i.updateVisible(!0);else if(n.parent){var s=this.isChildrenLoaded(n.parent);i==null||i.updateVisible(!s)}else i==null||i.updateVisible(!1)}},{key:"isParentLoaded",value:function(n){var i=n.parent;if(!i)return!0;var a=this.getTile(i==null?void 0:i.key);return!!(a!=null&&a.isLoaded)}},{key:"isChildrenLoaded",value:function(n){var i=this,a=n==null?void 0:n.children;return a.length===0?!0:a.every(function(s){var c=i.getTile(s==null?void 0:s.key);return c?(c==null?void 0:c.isLoaded)===!0:!0})}},{key:"render",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){var a=this,s,c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return s=this.getRenderLayers(),c=s.map(function(){var _=(0,qe.Z)(Pe().mark(function A(C){return Pe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,a.layerService.renderTileLayer(C);case 2:case"end":return ae.stop()}},A)}));return function(A){return _.apply(this,arguments)}}()),g.next=4,Promise.all(c);case 4:case"end":return g.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getRenderLayers",value:function(){var n=this.layerTiles.filter(function(a){return a.visible&&a.isLoaded}),i=[];return n.map(function(a){return i.push.apply(i,(0,Nr.Z)(a.getLayers()))}),i}},{key:"getLayers",value:function(){var n=this.layerTiles.filter(function(a){return a.isLoaded}),i=[];return n.map(function(a){return i.push.apply(i,(0,Nr.Z)(a.getLayers()))}),i}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(n){return n.destroy()}),this.tileResource.clear()}}]),e}(),Oy=x(32676);function Iy(e,r,n){n===void 0&&(n={});var i=st(e),a=st(r),s=Oy.union(i.coordinates,a.coordinates);return s.length===0?null:s.length===1?(0,Rt.yu)(s[0],n.properties):(0,Rt.tw)(s,n.properties)}var Py=Iy,ky=function(){function e(){(0,Ue.Z)(this,e)}return(0,vt.Z)(e,[{key:"getCombineFeature",value:function(n){var i=null,a=n[0];return n.map(function(s){var c=Rt.yu(s.coordinates);i===null?i=c:i=Py(i,c)}),a&&(i.properties=(0,de.Z)({},a)),i}}]),e}(),Kd="select",qd="active",Dy=function(){function e(r){var n=r.layerService,i=r.tileLayerService,a=r.parent;(0,Ue.Z)(this,e),(0,ue.Z)(this,"tilePickID",new Map),this.layerService=n,this.tileLayerService=i,this.parent=a,this.tileSourceService=new ky}return(0,vt.Z)(e,[{key:"pickRender",value:function(n){var i=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(i){var a=i.getMainLayer();a==null||a.layerPickService.pickRender(n)}}},{key:"pick",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(c=this.parent.getContainer(),d=c.pickingService,a.type!=="RasterLayer"){C.next=8;break}if(g=this.tileLayerService.getVisibleTileBylngLat(s.lngLat),!(g&&g.getMainLayer()!==void 0)){C.next=7;break}return _=g.getMainLayer(),C.abrupt("return",_.layerPickService.pickRasterLayer(_,s,this.parent));case 7:return C.abrupt("return",!1);case 8:return this.pickRender(s),C.abrupt("return",d.pickFromPickingFBO(a,s));case 10:case"end":return C.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"selectFeature",value:function(n){var i=(0,ji.Z)(n,3),a=i[0],s=i[1],c=i[2],d=this.color2PickId(a,s,c);this.tilePickID.set(Kd,d),this.updateHighLight(a,s,c,Kd)}},{key:"highlightPickedFeature",value:function(n){var i=(0,ji.Z)(n,3),a=i[0],s=i[1],c=i[2],d=this.color2PickId(a,s,c);this.tilePickID.set(qd,d),this.updateHighLight(a,s,c,qd)}},{key:"updateHighLight",value:function(n,i,a,s){this.tileLayerService.tiles.map(function(c){var d=c.getMainLayer();switch(s){case Kd:d==null||d.hooks.beforeSelect.call([n,i,a]);break;case qd:d==null||d.hooks.beforeHighlight.call([n,i,a]);break}})}},{key:"setPickState",value:function(){var n=this.tilePickID.get(Kd),i=this.tilePickID.get(qd);if(n){var a=this.pickId2Color(n),s=(0,ji.Z)(a,3),c=s[0],d=s[1],g=s[2];this.updateHighLight(c,d,g,Kd);return}if(i){var _=this.pickId2Color(i),A=(0,ji.Z)(_,3),C=A[0],N=A[1],ae=A[2];this.updateHighLight(C,N,ae,qd);return}}},{key:"color2PickId",value:function(n,i,a){return(0,ke.W0)(new Uint8Array([n,i,a]))}},{key:"pickId2Color",value:function(n){return(0,ke.Z6)(n)}},{key:"getFeatureById",value:function(n){var i=this.tileLayerService.getTiles().filter(function(s){return s.visible}),a=[];return i.forEach(function(s){a.push.apply(a,(0,Nr.Z)(s.getFeatureById(n)))}),a}},{key:"pickRasterLayer",value:function(){return!1}}]),e}();function Ly(e){var r=By();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function By(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fy=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,Ny=`
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }
  
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function cg(e){var r=e.coordinates;return{vertices:(0,Nr.Z)(r),indices:[0],size:r.length}}var Uy=function(e){(0,Ei.Z)(n,e);var r=Ly(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,c=a.strokeOpacity,d=c===void 0?1:c,g=a.strokeWidth,_=g===void 0?0:g,A=a.stroke,C=A===void 0?"#fff":A,N={u_stroke_color:(0,ke.CI)(C),u_additive:s==="additive"?1:0,u_stroke_opacity:d,u_stroke_width:_},ae=this.getUniformsBufferInfo(N);return ae}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=cg,this.initUniformsBuffer(),g.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:Ny,fragmentShader:Fy,inject:this.getInject(),triangulation:cg,depth:{enable:!1},primitive:Y.gl.POINTS});case 4:return c=g.sent,g.abrupt("return",[c]);case 6:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(s){var c=s.size,d=c===void 0?1:c;return Array.isArray(d)?[d[0]]:[d]}}})}}]),n}(Ua);function zy(e){var r=Zy();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Zy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vy=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,jy=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec3 a_Size;
layout(location = 11) in vec3 a_Pos;
layout(location = 13) in vec3 a_Normal;


layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,$y=ke.rU.isNumber,Hy=function(e){(0,Ei.Z)(n,e);var r=zy(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"raiseCount",0),(0,ue.Z)((0,cn.Z)(i),"raiseRepeat",0),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,d=a.opacity,g=d===void 0?1:d,_=a.sourceColor,A=a.targetColor,C=a.pickLight,N=C===void 0?!1:C,ae=a.heightfixed,we=ae===void 0?!0:ae,De=a.opacityLinear,at=De===void 0?{enable:!1,dir:"up"}:De,Ot=a.lightEnable,Pt=Ot===void 0?!0:Ot,Kt=0,hr=[0,0,0,0],jr=[0,0,0,0];if(_&&A&&(hr=(0,ke.CI)(_),jr=(0,ke.CI)(A),Kt=1),this.raiseCount<1&&this.raiseRepeat>0&&c.enable){var pr=c.speed,rr=pr===void 0?.01:pr;this.raiseCount+=rr,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}var Ur={u_sourceColor:hr,u_targetColor:jr,u_linearColor:Kt,u_pickLight:Number(N),u_heightfixed:Number(we),u_r:c.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:$y(g)?g:1,u_opacitylinear:Number(at.enable),u_opacitylinear_dir:at.dir==="up"?1:0,u_lightEnable:Number(Pt)},$n=this.getUniformsBufferInfo(Ur);return $n}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),d.abrupt("return",this.buildModels());case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.layer.getLayerConfig(),d=c.animateOption.repeat,g=d===void 0?1:d,this.raiseRepeat=g,C.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:jy,fragmentShader:Vy,triangulation:Zh,depth:{enable:!0},inject:this.getInject(),cull:{enable:!0,face:(0,ke.fj)(this.mapService.version)},blend:this.getBlend()});case 4:return _=C.sent,C.abrupt("return",[_]);case 6:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s){var c=s.size;if(c){var d=[];return Array.isArray(c)&&(d=c.length===2?[c[0],c[0],c[1]]:c),Array.isArray(c)||(d=[c,c,c]),d}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Y.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:Z.NORMAL,buffer:{usage:Y.gl.STATIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s,c,d,g,_){return _}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Y.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:15,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s){var c=(0,ke.SI)(s.coordinates);return ku([c[0],c[1]])}}})}}]),n}(Ua);function Wy(e){var r=Gy();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Gy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Xy=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,Yy=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in float a_Shape;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}`,Ky=function(e){(0,Ei.Z)(n,e);var r=Wy(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.strokeOpacity,c=s===void 0?1:s,d=a.strokeWidth,g=d===void 0?0:d,_=a.blend,A=a.blur,C=A===void 0?0:A;this.layer.getLayerConfig();var N={u_additive:_==="additive"?1:0,u_stroke_opacity:c,u_stroke_width:g,u_blur:C},ae=this.getUniformsBufferInfo(N);return ae}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.initUniformsBuffer(),d.abrupt("return",this.buildModels());case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=mp,g.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:Yy,fragmentShader:Xy,triangulation:mp,inject:this.getInject(),depth:{enable:!0},blend:this.getBlend()});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Y.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:Z.EXTRUDE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(c,d,g,_){var A=(0,ji.Z)(g,3),C=A[0],N=A[1],ae=A[2],we=_o.fromValues(0,0,1),De=_o.fromValues(C,0,ae),at=C>=0?_o.angle(we,De):Math.PI*2-_o.angle(we,De),Ot=Math.PI*2-Math.asin(N/100),Pt=Xd.create();Xd.rotateY(Pt,Pt,at),Xd.rotateX(Pt,Pt,Ot);var Kt=_o.fromValues(1,1,0);_o.transformMat4(Kt,Kt,Pt),_o.normalize(Kt,Kt);var hr=_o.fromValues(-1,1,0);_o.transformMat4(hr,hr,Pt),_o.normalize(hr,hr);var jr=_o.fromValues(-1,-1,0);_o.transformMat4(jr,jr,Pt),_o.normalize(jr,jr);var pr=_o.fromValues(1,-1,0);_o.transformMat4(pr,pr,Pt),_o.normalize(pr,pr);var rr=[].concat((0,Nr.Z)(Kt),(0,Nr.Z)(hr),(0,Nr.Z)(jr),(0,Nr.Z)(pr)),Ur=_%4*3;return[rr[Ur],rr[Ur+1],rr[Ur+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?5:d;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Y.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:Z.SHAPE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.shape,g=d===void 0?2:d,_=a.layer.getLayerConfig().shape2d,A=_.indexOf(g);return[A]}}})}}]),n}(Ua);function qy(e){var r=Qy();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Qy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jy=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,e_=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 11) in vec3 a_Extrude;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  
  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (extrude.xy * (newSize) + offsets);

  offset = rotate_matrix(offset,rotation);

  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,t_=function(e){(0,Ei.Z)(n,e);var r=qy(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"meter2coord",1),(0,ue.Z)((0,cn.Z)(i),"isMeter",!1),(0,ue.Z)((0,cn.Z)(i),"radian",0),(0,ue.Z)((0,cn.Z)(i),"updateTexture",function(){var d=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),i.layerService.throttleRenderLayers();return}i.texture=d({data:i.iconService.getCanvas(),mag:Y.gl.LINEAR,min:Y.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0}),i.textures=[i.texture]}),i}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,d=a.heightfixed,g=d===void 0?!1:d,_=a.unit,A=_===void 0?"pixel":_;if(this.rendererService.getDirty()){var C;(C=this.texture)===null||C===void 0||C.bind()}var N={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(g),u_raisingHeight:Number(c),u_size_unit:Qp[A]},ae=this.getUniformsBufferInfo(N);return ae}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),rh)}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:e_,fragmentShader:Jy,triangulation:rh,depth:{enable:!1},inject:this.getInject(),cull:{enable:!0,face:(0,ke.fj)(this.mapService.version)}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;this.iconService.off("imageUpdate",this.updateTexture),(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(c){var d=a.iconService.getIconMap(),g=c.shape,_=d[g]||{x:-64,y:-64},A=_.x,C=_.y;return[A,C]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Y.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:Z.EXTRUDE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(c,d,g,_){var A=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],C=_%4*3;return[A[C],A[C+1],A[C+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:Z.SIZE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(c){var d=c.size,g=d===void 0?5:d;return Array.isArray(g)?[g[0]]:[g]}}})}}]),n}(Ua);function r_(e){var r=n_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function n_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var i_=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,a_=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
  offset = project_pixel(offset);
  
  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`,o_=function(e){(0,Ei.Z)(n,e);var r=r_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,c=a.speed,d=c===void 0?1:c,g=a.unit,_=g===void 0?"pixel":g,A={u_additive:s==="additive"?1:0,u_size_unit:Qp[_],u_speed:d,u_time:this.layer.getLayerAnimateTime()},C=this.getUniformsBufferInfo(A);return C}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),rh)}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:a_,fragmentShader:i_,triangulation:rh,inject:this.getInject(),depth:{enable:!1}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Y.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:Z.EXTRUDE,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:3,update:function(s,c,d,g){var _=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],A=g%4*3;return[_[A],_[A+1],_[A+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Y.GC.Attribute,descriptor:{shaderLocation:Z.SIZE,name:"a_Size",buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:1,update:function(s){var c=s.size,d=c===void 0?5:c;return Array.isArray(d)?[d[0]]:[d]}}})}}]),n}(Ua),s_={fillImage:t_,fill:Ym,radar:o_,image:Km,normal:Qm,simplePoint:Uy,extrude:Xm,text:lg,earthFill:Ky,earthExtrude:Hy},u_=s_;function l_(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c_(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function c_(e,r){if(e){if(typeof e=="string")return fg(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fg(e,r)}}function fg(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function f_(e){var r=h_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function h_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var km=function(e){(0,Ei.Z)(n,e);var r=f_(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","PointLayer"),(0,ue.Z)((0,cn.Z)(i),"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,ue.Z)((0,cn.Z)(i),"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,ue.Z)((0,cn.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new u_[c](this),g.next=5,this.initLayerModels();case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"rebuildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.buildModels();case 2:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var a=this.shapeOption,s=a.field,c=a.values,d=this.getLayerConfig(),g=d.shape2d,_=this.iconService.getIconMap();if(s&&(g==null?void 0:g.indexOf(s))!==-1)return"fill";if(c==="text")return"text";if(c&&c instanceof Array){var A=l_(c),C;try{for(A.s();!(C=A.n()).done;){var N=C.value;if(typeof N=="string"&&_.hasOwnProperty(N))return"image"}}catch(ae){A.e(ae)}finally{A.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return s[a]}},{key:"getModelType",value:function(){var a=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,d=s.shape3d,g=s.billboard,_=g===void 0?!0:g,A=this.iconService.getIconMap(),C=a.find(function(ae){return ae.hasOwnProperty("shape")});if(C){var N=C.shape;return N==="dot"?"normal":N==="simple"?"simplePoint":N==="radar"?"radar":this.layerType==="fillImage"||_===!1?"fillImage":(c==null?void 0:c.indexOf(N))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(d==null?void 0:d.indexOf(N))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":A.hasOwnProperty(N)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),n}(ko);function p_(e){return e==="PolygonLayer"?Pm:e==="LineLayer"?Mm:km}function d_(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}function v_(e){var r=m_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function m_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ap=function(e){(0,Ei.Z)(n,e);var r=v_(n);function n(i,a){var s;return(0,Ue.Z)(this,n),s=r.call(this),(0,ue.Z)((0,cn.Z)(s),"visible",!0),(0,ue.Z)((0,cn.Z)(s),"layers",[]),(0,ue.Z)((0,cn.Z)(s),"isLoaded",!1),(0,ue.Z)((0,cn.Z)(s),"tileMaskLayers",[]),s.parent=a,s.sourceTile=i,s.x=i.x,s.y=i.y,s.z=i.z,s.key="".concat(s.x,"_").concat(s.y,"_").concat(s.z),s}return(0,vt.Z)(n,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(a){var s=(0,ji.Z)(this.sourceTile.bounds,4),c=s[0],d=s[1],g=s[2],_=s[3],A=a.lng,C=a.lat;return A>=c&&A<=g&&C>=d&&C<=_}},{key:"getLayerOptions",value:function(){var a,s=this.parent.getLayerConfig();return(0,de.Z)((0,de.Z)({},s),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:d_(this.parent.type),mask:s.mask||((a=s.maskLayers)===null||a===void 0?void 0:a.length)!==0&&s.enableMask})}},{key:"getMaskLayer",value:function(){var a=this,s=this.parent.getLayerConfig(),c=s.maskLayers,d=[];return c==null||c.forEach(function(g){if(!g.tileLayer)return d.push(g),g;var _=g.tileLayer,A=_.getTile(a.sourceTile.key),C=A==null?void 0:A.getLayers()[0];C&&d.push(C)}),d}},{key:"addTileMask",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g;return Pe().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return c=new Pm({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),d=(0,Y.e7)(this.parent.container),c.setContainer(d),A.next=5,c.init();case 5:return this.tileMask=c,g=this.getMainLayer(),g!==void 0&&(g.tileMask=c),A.abrupt("return",c);case 9:case"end":return A.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"addMask",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c,d){var g;return Pe().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return g=(0,Y.e7)(this.parent.container),d.setContainer(g),A.next=4,d.init();case 4:c.addMask(d),this.tileMaskLayers.push(d);case 6:case"end":return A.stop()}},s,this)}));function a(s,c){return i.apply(this,arguments)}return a}()},{key:"addLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c){var d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return c.isTileLayer=!0,d=(0,Y.e7)(this.parent.container),c.setContainer(d),this.layers.push(c),_.next=6,c.init();case 6:case"end":return _.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"updateVisible",value:function(a){this.visible=a,this.updateOptions("visible",a)}},{key:"updateOptions",value:function(a,s){this.layers.forEach(function(c){c.updateLayerConfig((0,ue.Z)({},a,s))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(a){return[]}},{key:"getFeatureById",value:function(a){return[]}},{key:"destroy",value:function(){var a;(a=this.tileMask)===null||a===void 0||a.destroy(),this.layers.forEach(function(s){return s.destroy()})}}]),n}(ol.EventEmitter);function g_(e){var r=y_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function y_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var __=function(e){(0,Ei.Z)(n,e);var r=g_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.getSourceOption(),d=c.data.features[0].properties,g=new Mm().source(c.data,c.options).size(1).shape("line").color("red"),_=new km({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([d],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),C.next=6,this.addLayer(g);case 6:return C.next=8,this.addLayer(_);case 8:this.isLoaded=!0;case 9:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:s},options:{parser:{type:"geojson"},transforms:a.transforms}}}}]),n}(Ap);function x_(e){var r=b_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function b_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var E_=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,S_=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
 
}
`,T_=function(e){(0,Ei.Z)(n,e);var r=x_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=a.brightness,d=a.contrast,g=a.saturation,_=a.gamma,A={u_opacity:(0,ke.LS)(s,1),u_brightness:(0,ke.LS)(c,1),u_contrast:(0,ke.LS)(d,1),u_saturation:(0,ke.LS)(g,1),u_gamma:(0,ke.LS)(_,1)};this.textures=[this.texture];var C=this.getUniformsBufferInfo(A);return C}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.loadTexture();case 2:return d.abrupt("return",this.buildModels());case 3:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"loadTexture",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g;return Pe().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return c=this.rendererService.createTexture2D,this.texture=c({height:1,width:1}),d=this.layer.getSource(),A.next=5,d.data.images;case 5:g=A.sent,this.texture=c({data:g[0],width:g[0].width,height:g[0].height,mag:Y.gl.LINEAR,min:Y.gl.LINEAR});case 7:case"end":return A.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:S_,fragmentShader:E_,triangulation:jh,primitive:Y.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[3],d[4]]}}})}}]),n}(Ua),A_={image:T_},C_=A_;function w_(e){var r=R_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function R_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M_=function(e){(0,Ei.Z)(n,e);var r=w_(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","ImageLayer"),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new C_[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={image:{}};return s[a]}},{key:"getModelType",value:function(){return"image"}}]),n}(ko);function O_(e){var r=I_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function I_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var P_=function(e){(0,Ei.Z)(n,e);var r=O_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=this.getSourceOption(),_=new M_((0,de.Z)({},d)).source(g.data,g.options),c&&Object.keys(c).forEach(function(N){var ae,we,De=N;_[De]((ae=c[De])===null||ae===void 0?void 0:ae.field,(we=c[De])===null||we===void 0?void 0:we.values)}),C.next=7,this.addLayer(_);case 7:this.isLoaded=!0;case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:a.transforms}}}}]),n}(Ap);function k_(e){var r=D_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function D_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L_=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,B_=`layout(location = 0) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,F_=function(e){(0,Ei.Z)(n,e);var r=k_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,d=a.color,g=d===void 0?"#000":d,_={u_color:(0,ke.CI)(g),u_opacity:c||1},A=this.getUniformsBufferInfo(_);return A}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"mask",vertexShader:B_,fragmentShader:L_,triangulation:nh,depth:{enable:!1},pick:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),n}(Ua),N_={fill:F_},U_=N_;function z_(e){var r=Z_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Z_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var hg=function(e){(0,Ei.Z)(n,e);var r=z_(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","MaskLayer"),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new U_[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelType",value:function(){return"fill"}}]),n}(ko);function V_(e){var r=j_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function j_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $_=function(e){(0,Ei.Z)(n,e);var r=V_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=this.getSourceOption(),_=new hg((0,de.Z)({},d)).source(g.data,g.options),c&&Object.keys(c).forEach(function(N){var ae,we,De=N;_[De]((ae=c[De])===null||ae===void 0?void 0:ae.field,(we=c[De])===null||we===void 0?void 0:we.values)}),C.next=7,this.addLayer(_);case 7:this.isLoaded=!0;case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getFeatures",value:function(a){if(!a)return[];var s=this.sourceTile.data;return s.getTileData(a)}},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.parent.getLayerConfig(),c=s.sourceLayer,d=s.featureId,g=this.getFeatures(c);return{data:{type:"FeatureCollection",features:g},options:{parser:{type:"geojson",featureId:d},transforms:a.transforms}}}}]),n}(Ap);function H_(e){var r=W_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function W_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var G_=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,X_=`
layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,pg=function(e){(0,Ei.Z)(n,e);var r=H_(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,d=a.clampLow,g=d===void 0?!0:d,_=a.clampHigh,A=_===void 0?!0:_,C=a.noDataValue,N=C===void 0?-9999999:C,ae=a.domain,we=a.rampColors,De=ae||(0,ke.ZB)(we);this.colorTexture=this.layer.textureService.getColorTexture(we,De);var at={u_domain:De,u_opacity:c||1,u_noDataValue:N,u_clampLow:g?1:0,u_clampHigh:(typeof A!="undefined"?A:g)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};this.textures=[this.texture,this.colorTexture];var Ot=this.getUniformsBufferInfo(at);return Ot}},{key:"getRasterData",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c){var d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!Array.isArray(c.data)){N.next=4;break}return N.abrupt("return",{data:c.data,width:c.width,height:c.height});case 4:return N.next=6,c.data;case 6:return d=N.sent,g=d.rasterData,_=d.width,A=d.height,N.abrupt("return",{data:Array.from(g),width:_,height:A});case 11:case"end":return N.stop()}},s)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.buildModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae,we,De;return Pe().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),d=this.rendererService,g=d.createTexture2D,_=d.queryVerdorInfo,A=c.data.dataArray[0],Ot.next=6,this.getRasterData(A);case 6:return C=Ot.sent,N=C.data,ae=C.width,we=C.height,this.texture=g({data:new Float32Array(N),width:ae,height:we,format:_()==="WebGL1"?Y.gl.LUMINANCE:Y.gl.RED,type:Y.gl.FLOAT,alignment:1}),Ot.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:X_,fragmentShader:G_,triangulation:jh,primitive:Y.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1});case 13:return De=Ot.sent,Ot.abrupt("return",[De]);case 15:case"end":return Ot.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a,s;(a=this.texture)===null||a===void 0||a.destroy(),(s=this.colorTexture)===null||s===void 0||s.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{shaderLocation:Z.UV,name:"a_Uv",buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[3],d[4]]}}})}}]),n}(Ua),Y_=["data"],K_=["rasterData"];function q_(e){var r=Q_();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Q_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var J_=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,e1=`
layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,t1=function(e){(0,Ei.Z)(n,e);var r=q_(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"dataOption",{}),i}return(0,vt.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,de.Z)((0,de.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,d=a.noDataValue,g=d===void 0?0:d,_=this.dataOption,A=_.rMinMax,C=A===void 0?[0,255]:A,N=_.gMinMax,ae=N===void 0?[0,255]:N,we=_.bMinMax,De=we===void 0?[0,255]:we,at={u_rminmax:C,u_gminmax:ae,u_bminmax:De,u_opacity:c||1,u_noDataValue:g,u_texture:this.texture};this.textures=[this.texture];var Ot=this.getUniformsBufferInfo(at);return Ot}},{key:"getRasterData",value:function(){var i=(0,qe.Z)(Pe().mark(function s(c){var d,g,_,A,C;return Pe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(!Array.isArray(c.data)){ae.next=4;break}return d=c.data,g=(0,ws.Z)(c,Y_),this.dataOption=g,ae.abrupt("return",(0,de.Z)({data:d},g));case 4:return ae.next=6,c.data;case 6:if(_=ae.sent,A=_.rasterData,C=(0,ws.Z)(_,K_),this.dataOption=C,!Array.isArray(A)){ae.next=14;break}return ae.abrupt("return",(0,de.Z)({data:A},C));case 14:return ae.abrupt("return",(0,de.Z)({data:Array.from(A)},C));case 15:case"end":return ae.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N,ae;return Pe().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),d=this.rendererService.createTexture2D,g=c.data.dataArray[0],De.next=6,this.getRasterData(g);case 6:return _=De.sent,A=_.data,C=_.width,N=_.height,this.texture=d({data:new Float32Array(A),width:C,height:N,format:Y.gl.RGB,type:Y.gl.FLOAT}),De.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:e1,fragmentShader:J_,triangulation:jh,primitive:Y.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1});case 13:return ae=De.sent,De.abrupt("return",[ae]);case 15:case"end":return De.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.initModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[3],d[4]]}}})}}]),n}(Ua);function r1(e){var r=n1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function n1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var i1=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,a1=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
   vec4 u_unpack;
   vec2 u_domain;
   float u_opacity;
   float u_noDataValue;
   float u_clampLow;
   float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,o1=function(e){(0,Ei.Z)(n,e);var r=r1(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=a.clampLow,d=c===void 0?!0:c,g=a.clampHigh,_=g===void 0?!0:g,A=a.noDataValue,C=A===void 0?-9999999:A,N=a.domain,ae=a.rampColors,we=a.colorTexture,De=a.rScaler,at=De===void 0?6553.6:De,Ot=a.gScaler,Pt=Ot===void 0?25.6:Ot,Kt=a.bScaler,hr=Kt===void 0?.1:Kt,jr=a.offset,pr=jr===void 0?1e4:jr,rr=N||(0,ke.ZB)(ae),Ur=we;we?this.layer.textureService.setColorTexture(we,ae,rr):Ur=this.layer.textureService.getColorTexture(ae,rr);var $n={u_unpack:[at,Pt,hr,pr],u_domain:rr,u_opacity:s||1,u_noDataValue:C,u_clampLow:d,u_clampHigh:typeof _!="undefined"?_:d,u_texture:this.texture,u_colorTexture:Ur};this.textures=[this.texture,Ur];var Ai=this.getUniformsBufferInfo($n);return Ai}},{key:"initModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),d=this.rendererService.createTexture2D,C.next=5,c.data.images;case 5:return g=C.sent,this.texture=d({data:g[0],width:g[0].width,height:g[0].height,min:Y.gl.LINEAR,mag:Y.gl.LINEAR}),C.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:a1,fragmentShader:i1,triangulation:jh,primitive:Y.gl.TRIANGLES,depth:{enable:!1}});case 9:return _=C.sent,C.abrupt("return",[_]);case 11:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.initModels());case 1:case"end":return d.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Y.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:Z.UV,buffer:{usage:Y.gl.DYNAMIC_DRAW,data:[],type:Y.gl.FLOAT},size:2,update:function(s,c,d){return[d[3],d[4]]}}})}}]),n}(Ua),s1={raster:pg,rasterRgb:t1,raster3d:pg,rasterTerrainRgb:o1},u1=s1;function l1(e,r){return{type:e.type,field:"value",items:e.positions.map(function(n,i){var a;return a={},(0,ue.Z)(a,r,i>=e.colors.length?null:e.colors[i]),(0,ue.Z)(a,"value",n),a})}}function c1(e){var r=f1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function f1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Dm=function(e){(0,Ei.Z)(n,e);var r=c1(n);function n(){var i;(0,Ue.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,ue.Z)((0,cn.Z)(i),"type","RasterLayer"),i}return(0,vt.Z)(n,[{key:"buildModels",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c;return Pe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new u1[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return s[a]}},{key:"getModelType",value:function(){var a=this.layerSource.getParserType();switch(a){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}},{key:"getLegend",value:function(a){if(a!=="color")return{type:void 0,field:void 0,items:[]};var s=this.getLayerConfig().rampColors;return l1(s,a)}}]),n}(ko),h1=["rasterData"];function p1(e){var r=d1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function d1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v1=function(e){(0,Ei.Z)(n,e);var r=p1(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=this.getSourceOption(),_=new Dm((0,de.Z)({},d)).source(g.data,g.options),c&&Object.keys(c).forEach(function(N){var ae,we,De=N;_[De]((ae=c[De])===null||ae===void 0?void 0:ae.field,(we=c[De])===null||we===void 0?void 0:we.values)}),C.next=7,this.addLayer(_);case 7:this.isLoaded=!0;case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.data,c=s.rasterData,d=(0,ws.Z)(s,h1);return{data:c,options:{parser:(0,de.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},d),transforms:a.transforms}}}}]),n}(Ap);function m1(e){var r=g1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function g1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y1=function(e){(0,Ei.Z)(n,e);var r=m1(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_;return Pe().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=this.getSourceOption(),_=new Dm((0,de.Z)({},d)).source(g.data,g.options),c&&Object.keys(c).forEach(function(N){var ae,we,De=N;_[De]((ae=c[De])===null||ae===void 0?void 0:ae.field,(we=c[De])===null||we===void 0?void 0:we.values)}),C.next=7,this.addLayer(_);case 7:this.isLoaded=!0;case 8:case"end":return C.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:a.transforms}}}}]),n}(Ap),_1=["rasterData"];function x1(e){var r=b1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function b1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var E1={positions:[0,1],colors:["#000","#fff"]},S1=function(e){(0,Ei.Z)(n,e);var r=x1(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A,C,N;return Pe().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=this.getSourceOption(),_=this.getLayerOptions(),A=_.rampColors,C=_.domain,this.colorTexture=this.parent.textureService.getColorTexture(A,C),N=new Dm((0,de.Z)((0,de.Z)({},d),{},{colorTexture:this.colorTexture})).source(g.data,g.options),c&&Object.keys(c).forEach(function(De){var at,Ot,Pt=De;N[Pt]((at=c[Pt])===null||at===void 0?void 0:at.field,(Ot=c[Pt])===null||Ot===void 0?void 0:Ot.values)}),we.next=9,this.addLayer(N);case 9:this.isLoaded=!0;case 10:case"end":return we.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.data,c=s.rasterData,d=(0,ws.Z)(s,_1);return{data:c,options:{parser:(0,de.Z)({type:"raster",extent:this.sourceTile.bounds},d),transforms:a.transforms}}}},{key:"styleUpdate",value:function(){for(var a=this,s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];var g=c,_=g.rampColors,A=_===void 0?E1:_,C=g.domain;this.colorTexture=this.parent.textureService.getColorTexture(A,C||(0,ke.ZB)(A)),this.layers.forEach(function(N){return N.style({colorTexture:a.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(a){return a.destroy()})}}]),n}(Ap);function T1(e){var r=A1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function A1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Vv=function(e){(0,Ei.Z)(n,e);var r=T1(n);function n(){return(0,Ue.Z)(this,n),r.apply(this,arguments)}return(0,vt.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,qe.Z)(Pe().mark(function s(){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(c=this.parent.getLayerAttributeConfig(),d=this.getLayerOptions(),g=p_(this.parent.type),_=this.getSourceOption(),_){N.next=8;break}return this.isLoaded=!0,this.emit("loaded"),N.abrupt("return");case 8:return A=new g((0,de.Z)({},d)).source(_.data,_.options),Object.keys(c).forEach(function(ae){var we,De,at=ae;A[at]((we=c[at])===null||we===void 0?void 0:we.field,(De=c[at])===null||De===void 0?void 0:De.values)}),N.next=12,this.addLayer(A);case 12:if(!d.tileMask){N.next=15;break}return N.next=15,this.addTileMask();case 15:this.setLayerMinMaxZoom(A),this.isLoaded=!0,this.emit("loaded");case 18:case"end":return N.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.parent.getLayerConfig(),c=s.sourceLayer,d=c===void 0?"defaultLayer":c,g=s.featureId,_=g===void 0?"id":g,A=this.getFeatures(d);return{data:{type:"FeatureCollection",features:A},options:{parser:{type:"geojson",featureId:_},transforms:a.transforms}}}},{key:"setLayerMinMaxZoom",value:function(a){a.getModelType()==="text"&&a.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(a){var s=this.sourceTile.data;return s.getTileData(a)}},{key:"getFeatureById",value:function(a){var s=this.getMainLayer();if(!s)return[];var c=s.getSource().data.dataArray.filter(function(d){return d._id===a});return c}}]),n}(Ap);function C1(e){var r=e.type;switch(r){case"PolygonLayer":return Vv;case"LineLayer":return Vv;case"PointLayer":return Vv;case"TileDebugLayer":return __;case"MaskLayer":return $_;case"RasterLayer":var n=e.getSource().parser.dataType;switch(n){case Y.n3.RGB:case Y.n3.CUSTOMRGB:return v1;case Y.n3.ARRAYBUFFER:case Y.n3.CUSTOMARRAYBUFFER:return S1;case Y.n3.TERRAINRGB:case Y.n3.CUSTOMTERRAINRGB:return y1;default:return P_}default:return Vv}}var w1=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],R1=ke.rU.debounce,M1=function(){function e(r){var n=this;(0,Ue.Z)(this,e),(0,ue.Z)(this,"initedTileset",!1),(0,ue.Z)(this,"mapchange",function(){var a;if(n.parent.isVisible()!==!1){var s=n.getCurrentView(),c=s.latLonBounds,d=s.zoom;if(n.mapService.version==="GAODE1.x"){var g=n.parent.getLayerConfig(),_=g.visible;d<2&&_?(n.parent.updateLayerConfig({visible:!1}),n.layerService.reRender()):d>=2&&!_&&(n.parent.updateLayerConfig({visible:!0}),n.layerService.reRender())}n.lastViewStates&&n.lastViewStates.zoom===d&&n.lastViewStates.latLonBounds.toString()===c.toString()||(n.lastViewStates={zoom:d,latLonBounds:c},(a=n.tilesetManager)===null||a===void 0||a.throttleUpdate(d,c))}}),(0,ue.Z)(this,"viewchange",R1(this.mapchange,24)),this.parent=r;var i=this.parent.getContainer();this.rendererService=i.rendererService,this.layerService=i.layerService,this.mapService=i.mapService,this.pickingService=i.pickingService,this.tileLayerService=new My({rendererService:this.rendererService,layerService:this.layerService,parent:r}),this.tilePickService=new Dy({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:r}),this.parent.setLayerPickService(this.tilePickService),this.proxy(r),this.initTileSetManager()}return(0,vt.Z)(e,[{key:"initTileSetManager",value:function(){var n,i=this.parent.getSource();if(this.tilesetManager=i.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()!==!1){var a=this.getCurrentView(),s=a.latLonBounds,c=a.zoom;(n=this.tilesetManager)===null||n===void 0||n.update(c,s)}}},{key:"getCurrentView",value:function(){var n=this.mapService.getBounds(),i=[n[0][0],n[0][1],n[1][0],n[1][1]],a=this.mapService.getZoom();return{latLonBounds:i,zoom:a}}},{key:"bindTilesetEvent",value:function(){var n=this;this.tilesetManager.on("tile-loaded",function(i){}),this.tilesetManager.on("tile-unload",function(i){n.tileUnLoad(i)}),this.tilesetManager.on("tile-error",function(i,a){n.tileError(i)}),this.tilesetManager.on("tile-update",function(){n.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(n){return this.tileLayerService.getTile(n)}},{key:"tileLoaded",value:function(n){}},{key:"tileError",value:function(n){console.warn("error:",n)}},{key:"destroy",value:function(){var n;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(n=this.tilesetManager)===null||n===void 0||n.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var n;this.tilesetManager.clear();var i=this.getCurrentView(),a=i.latLonBounds,s=i.zoom;(n=this.tilesetManager)===null||n===void 0||n.update(s,a)}},{key:"tileUnLoad",value:function(n){this.tileLayerService.removeTile(n.key)}},{key:"tileUpdate",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){var a=this,s,c,d;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.tilesetManager){_.next=2;break}return _.abrupt("return");case 2:return s=this.parent.getMinZoom(),c=this.parent.getMaxZoom(),d=this.tilesetManager.tiles.filter(function(A){return A.isLoaded}).filter(function(A){return A.isVisibleChange}).filter(function(A){return A.data}).filter(function(A){return A.z>=s&&A.z<c}),_.next=7,Promise.all(d.map(function(){var A=(0,qe.Z)(Pe().mark(function C(N){var ae,we;return Pe().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(a.tileLayerService.hasTile(N.key)){at.next=9;break}return ae=C1(a.parent),we=new ae(N,a.parent),at.next=5,we.initTileLayer();case 5:a.tilePickService.setPickState(),we.getLayers().length!==0&&(a.tileLayerService.addTile(we),a.tileLayerService.updateTileVisible(N),a.layerService.reRender()),at.next=12;break;case 9:a.tileLayerService.updateTileVisible(N),a.tilePickService.setPickState(),a.layerService.reRender();case 12:case"end":return at.stop()}},C)}));return function(C){return A.apply(this,arguments)}}()));case 7:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 8:case"end":return _.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"setPickState",value:function(n){}},{key:"pickRender",value:function(n){this.tilePickService.pickRender(n)}},{key:"selectFeature",value:function(n){this.tilePickService.selectFeature(n)}},{key:"highlightPickedFeature",value:function(n){this.tilePickService.highlightPickedFeature(n)}},{key:"proxy",value:function(n){var i=this;w1.forEach(function(a){var s=n[a].bind(n);n[a]=function(){for(var c=arguments.length,d=new Array(c),g=0;g<c;g++)d[g]=arguments[g];return s.apply(void 0,d),i.getLayers().map(function(_){_[a].apply(_,d)}),a==="style"&&i.getTiles().forEach(function(_){return _.styleUpdate.apply(_,d)}),n}})}}]),e}();function NE(e){var r=O1();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function O1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UE=null;function zE(e){var r=I1();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function I1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZE=null;function P1(e){var r=k1();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function k1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var D1=function(e){(0,Ei.Z)(n,e);var r=P1(n);function n(i){var a;(0,Ue.Z)(this,n),a=r.call(this),(0,ue.Z)((0,cn.Z)(a),"isShow",!0),(0,ue.Z)((0,cn.Z)(a),"onMouseMove",function(c){var d,g=a.mapsService.getMapContainer(),_=(d=g==null?void 0:g.getBoundingClientRect())!==null&&d!==void 0?d:{},A=_.left,C=A===void 0?0:A,N=_.top,ae=N===void 0?0:N;a.setPopupPosition(c.clientX-C,c.clientY-ae)}),(0,ue.Z)((0,cn.Z)(a),"updateLngLatPosition",function(){if(!(!a.mapsService||a.popupOption.followCursor)){var c=a.lngLat,d=c.lng,g=c.lat,_=a.mapsService.lngLatToContainer([d,g]),A=_.x,C=_.y;a.setPopupPosition(A,C)}}),(0,ue.Z)((0,cn.Z)(a),"updateLngLatPositionWhenZoom",function(c){if(!(!a.mapsService||a.popupOption.followCursor)){var d=c.map,g=d.getSize();g.x=g.x/2,g.y=g.y/2;var _=c.center,A=c.zoom,C=d.DE(a.lngLat,A,_);C.x=Math.round(C.x),C.y=Math.round(C.y),a.setPopupPosition(C.x,C.y,!0)}}),(0,ue.Z)((0,cn.Z)(a),"onKeyDown",function(c){c.keyCode===27&&a.remove()}),(0,ue.Z)((0,cn.Z)(a),"onCloseButtonClick",function(c){c.stopPropagation&&c.stopPropagation(),a.hide()}),(0,ue.Z)((0,cn.Z)(a),"updatePosition",function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g=!!a.lngLat,_=a.popupOption,A=_.className,C=_.style,N=_.maxWidth,ae=_.anchor,we=_.stopPropagation;if(!(!a.mapsService||!g||!a.content)){var De=a.mapsService.getMarkerContainer();if(!a.container&&De&&(a.container=ke.SO.create("div","l7-popup ".concat(A!=null?A:""," ").concat(a.isShow?"":"l7-popup-hide"),De),C&&a.container.setAttribute("style",C),a.tip=ke.SO.create("div","l7-popup-tip",a.container),a.container.appendChild(a.content),we&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Pt){a.container.addEventListener(Pt,function(Kt){Kt.stopPropagation()})}),a.container.style.whiteSpace="nowrap"),d?a.updateLngLatPositionWhenZoom(c):a.updateLngLatPosition(),ke.SO.setTransform(a.container,"".concat(ke.rQ[ae])),(0,ke.zi)(a.container,ae,"popup"),N){var at=a.container.getBoundingClientRect(),Ot=at.width;Ot>parseFloat(N)&&(a.container.style.width=N)}else a.container.style.removeProperty("width")}}),(0,ue.Z)((0,cn.Z)(a),"updateWhenZoom",function(c){a.updatePosition(c,!0)}),(0,ue.Z)((0,cn.Z)(a),"update",function(){a.updatePosition(null,!1)}),a.popupOption=(0,de.Z)((0,de.Z)({},a.getDefault(i!=null?i:{})),i);var s=a.popupOption.lngLat;return s&&(a.lngLat=s),a}return(0,vt.Z)(n,[{key:"lngLat",get:function(){var a;return(a=this.popupOption.lngLat)!==null&&a!==void 0?a:{lng:0,lat:0}},set:function(a){this.popupOption.lngLat=a}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(a){this.mapsService=a.mapService,this.sceneService=a.sceneService,this.layerService=a.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=a,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var s=this.popupOption,c=s.html,d=s.text,g=s.title;return c?this.setHTML(c):d&&this.setText(d),g&&this.setTitle(g),this.emit("open"),this}},{key:"remove",value:function(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&ke.SO.remove(this.content),this.container&&(ke.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(a){return this.show(),this.popupOption=(0,de.Z)((0,de.Z)({},this.popupOption),a),this.checkUpdateOption(a,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(ke.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(a,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(a,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(a,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(a,["html"])&&a.html?this.setHTML(a.html):this.checkUpdateOption(a,["text"])&&a.text&&this.setText(a.text),this.checkUpdateOption(a,["lngLat"])&&a.lngLat&&this.setLnglat(a.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&ke.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(this.isShow)return this.container&&ke.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(a){return this.popupOption.html=a,this.setDOMContent(a)}},{key:"setText",value:function(a){return this.popupOption.text=a,this.setDOMContent(window.document.createTextNode(a))}},{key:"setTitle",value:function(a){this.show(),this.popupOption.title=a,a?(this.contentTitle||(this.contentTitle=ke.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),ke.SO.clearChildren(this.contentTitle),ke.SO.appendElementType(this.contentTitle,a)):this.contentTitle&&(ke.SO.remove(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var a=this.lngLat,s=a.lng,c=a.lat;return this.popupOption.autoPan&&this.mapsService.panTo([s,c]),this}},{key:"setLngLat",value:function(a){return this.setLnglat(a)}},{key:"setLnglat",value:function(a){var s=this;return this.show(),this.lngLat=a,Array.isArray(a)&&(this.lngLat={lng:a[0],lat:a[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){s.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(a){return this.popupOption.maxWidth=a,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(a){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:ke.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(a){return this.show(),this.createContent(),ke.SO.appendElementType(this.contentPanel,a),this.update(),this}},{key:"updateCloseOnClick",value:function(a){var s=this,c=this.mapsService;c&&(c==null||c.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!a&&requestAnimationFrame(function(){c==null||c.on("click",s.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(a){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!a&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(a){var s,c=(s=this.mapsService)===null||s===void 0?void 0:s.getContainer();c&&(c==null||c.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!a&&(c==null||c.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var a=this;if(this.content&&ke.SO.remove(this.content),this.contentTitle=void 0,this.content=ke.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var s=Wu("l7-icon-guanbi");ke.SO.addClass(s,"l7-popup-close-button"),this.content.appendChild(s),this.popupOption.closeButtonOffsets&&(s.style.right=this.popupOption.closeButtonOffsets[0]+"px",s.style.top=this.popupOption.closeButtonOffsets[1]+"px"),s.setAttribute("aria-label","Close popup"),s.addEventListener("click",function(){a.hide()}),s.addEventListener("pointerup",function(c){c.stopPropagation()}),s.addEventListener("pointerdown",function(c){c.stopPropagation()}),this.closeButton=s}else this.closeButton=void 0;this.contentPanel=ke.SO.create("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(a,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.container){var d=this.popupOption.offsets;this.container.style.left=a+d[0]+"px",this.container.style.top=s-d[1]+"px",c?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}},{key:"checkUpdateOption",value:function(a,s){return s.some(function(c){return c in a})}}]),n}(ol.EventEmitter);function VE(e){var r=L1();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function L1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jE=ke.rU.get,$E=null;function B1(e,r){var n=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,i=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(n||i)&&(r||(r=document),!!r)){var a=r.head||r.getElementsByTagName("head")[0];if(!a){a=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(a,s):r.documentElement.appendChild(a)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),a.appendChild(c),c}}B1(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-flex: 0;
      -ms-flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
          flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item input[type='radio'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -ms-touch-action: none;
      touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var F1=x(81550),N1=x.n(F1),U1=function(){function e(r,n){(0,Ue.Z)(this,e);var i=n.buffer,a=n.offset,s=n.stride,c=n.normalized,d=n.size,g=n.divisor;this.buffer=i,this.attribute={buffer:i.get(),offset:a||0,stride:s||0,normalized:c||!1,divisor:g||0},d&&(this.attribute.size=d)}return(0,vt.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),wh,Qd,Gh,gf,Jd,Xh,ev,jv,ih,Cp,Cl,ah,oh,$v,z1=(wh={},(0,ue.Z)(wh,Y.gl.POINTS,"points"),(0,ue.Z)(wh,Y.gl.LINES,"lines"),(0,ue.Z)(wh,Y.gl.LINE_LOOP,"line loop"),(0,ue.Z)(wh,Y.gl.LINE_STRIP,"line strip"),(0,ue.Z)(wh,Y.gl.TRIANGLES,"triangles"),(0,ue.Z)(wh,Y.gl.TRIANGLE_FAN,"triangle fan"),(0,ue.Z)(wh,Y.gl.TRIANGLE_STRIP,"triangle strip"),wh),dg=(Qd={},(0,ue.Z)(Qd,Y.gl.STATIC_DRAW,"static"),(0,ue.Z)(Qd,Y.gl.DYNAMIC_DRAW,"dynamic"),(0,ue.Z)(Qd,Y.gl.STREAM_DRAW,"stream"),Qd),Lm=(Gh={},(0,ue.Z)(Gh,Y.gl.BYTE,"int8"),(0,ue.Z)(Gh,Y.gl.INT,"int32"),(0,ue.Z)(Gh,Y.gl.UNSIGNED_BYTE,"uint8"),(0,ue.Z)(Gh,Y.gl.UNSIGNED_SHORT,"uint16"),(0,ue.Z)(Gh,Y.gl.UNSIGNED_INT,"uint32"),(0,ue.Z)(Gh,Y.gl.FLOAT,"float"),Gh),Z1=(gf={},(0,ue.Z)(gf,Y.gl.ALPHA,"alpha"),(0,ue.Z)(gf,Y.gl.LUMINANCE,"luminance"),(0,ue.Z)(gf,Y.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,ue.Z)(gf,Y.gl.RGB,"rgb"),(0,ue.Z)(gf,Y.gl.RGBA,"rgba"),(0,ue.Z)(gf,Y.gl.RGBA4,"rgba4"),(0,ue.Z)(gf,Y.gl.RGB5_A1,"rgb5 a1"),(0,ue.Z)(gf,Y.gl.RGB565,"rgb565"),(0,ue.Z)(gf,Y.gl.DEPTH_COMPONENT,"depth"),(0,ue.Z)(gf,Y.gl.DEPTH_STENCIL,"depth stencil"),gf),V1=(Jd={},(0,ue.Z)(Jd,Y.gl.DONT_CARE,"dont care"),(0,ue.Z)(Jd,Y.gl.NICEST,"nice"),(0,ue.Z)(Jd,Y.gl.FASTEST,"fast"),Jd),vg=(Xh={},(0,ue.Z)(Xh,Y.gl.NEAREST,"nearest"),(0,ue.Z)(Xh,Y.gl.LINEAR,"linear"),(0,ue.Z)(Xh,Y.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,ue.Z)(Xh,Y.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,ue.Z)(Xh,Y.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,ue.Z)(Xh,Y.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Xh),mg=(ev={},(0,ue.Z)(ev,Y.gl.REPEAT,"repeat"),(0,ue.Z)(ev,Y.gl.CLAMP_TO_EDGE,"clamp"),(0,ue.Z)(ev,Y.gl.MIRRORED_REPEAT,"mirror"),ev),j1=(jv={},(0,ue.Z)(jv,Y.gl.NONE,"none"),(0,ue.Z)(jv,Y.gl.BROWSER_DEFAULT_WEBGL,"browser"),jv),$1=(ih={},(0,ue.Z)(ih,Y.gl.NEVER,"never"),(0,ue.Z)(ih,Y.gl.ALWAYS,"always"),(0,ue.Z)(ih,Y.gl.LESS,"less"),(0,ue.Z)(ih,Y.gl.LEQUAL,"lequal"),(0,ue.Z)(ih,Y.gl.GREATER,"greater"),(0,ue.Z)(ih,Y.gl.GEQUAL,"gequal"),(0,ue.Z)(ih,Y.gl.EQUAL,"equal"),(0,ue.Z)(ih,Y.gl.NOTEQUAL,"notequal"),ih),gg=(Cp={},(0,ue.Z)(Cp,Y.gl.FUNC_ADD,"add"),(0,ue.Z)(Cp,Y.gl.MIN_EXT,"min"),(0,ue.Z)(Cp,Y.gl.MAX_EXT,"max"),(0,ue.Z)(Cp,Y.gl.FUNC_SUBTRACT,"subtract"),(0,ue.Z)(Cp,Y.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Cp),Hv=(Cl={},(0,ue.Z)(Cl,Y.gl.ZERO,"zero"),(0,ue.Z)(Cl,Y.gl.ONE,"one"),(0,ue.Z)(Cl,Y.gl.SRC_COLOR,"src color"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,ue.Z)(Cl,Y.gl.SRC_ALPHA,"src alpha"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,ue.Z)(Cl,Y.gl.DST_COLOR,"dst color"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,ue.Z)(Cl,Y.gl.DST_ALPHA,"dst alpha"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,ue.Z)(Cl,Y.gl.CONSTANT_COLOR,"constant color"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,ue.Z)(Cl,Y.gl.CONSTANT_ALPHA,"constant alpha"),(0,ue.Z)(Cl,Y.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,ue.Z)(Cl,Y.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),Cl),H1=(ah={},(0,ue.Z)(ah,Y.gl.NEVER,"never"),(0,ue.Z)(ah,Y.gl.ALWAYS,"always"),(0,ue.Z)(ah,Y.gl.LESS,"less"),(0,ue.Z)(ah,Y.gl.LEQUAL,"lequal"),(0,ue.Z)(ah,Y.gl.GREATER,"greater"),(0,ue.Z)(ah,Y.gl.GEQUAL,"gequal"),(0,ue.Z)(ah,Y.gl.EQUAL,"equal"),(0,ue.Z)(ah,Y.gl.NOTEQUAL,"notequal"),ah),ed=(oh={},(0,ue.Z)(oh,Y.gl.ZERO,"zero"),(0,ue.Z)(oh,Y.gl.KEEP,"keep"),(0,ue.Z)(oh,Y.gl.REPLACE,"replace"),(0,ue.Z)(oh,Y.gl.INVERT,"invert"),(0,ue.Z)(oh,Y.gl.INCR,"increment"),(0,ue.Z)(oh,Y.gl.DECR,"decrement"),(0,ue.Z)(oh,Y.gl.INCR_WRAP,"increment wrap"),(0,ue.Z)(oh,Y.gl.DECR_WRAP,"decrement wrap"),oh),W1=($v={},(0,ue.Z)($v,Y.gl.FRONT,"front"),(0,ue.Z)($v,Y.gl.BACK,"back"),$v),G1=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"isDestroyed",!1);var i=n.data,a=n.usage,s=n.type;this.buffer=r.buffer({data:i,usage:dg[a||Y.gl.STATIC_DRAW],type:Lm[s||Y.gl.UNSIGNED_BYTE]})}return(0,vt.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(n){var i=n.data,a=n.offset;this.buffer.subdata(i,a)}}]),e}(),X1=function(){function e(r,n){(0,Ue.Z)(this,e);var i=n.data,a=n.usage,s=n.type,c=n.count;this.elements=r.elements({data:i,usage:dg[a||Y.gl.STATIC_DRAW],type:Lm[s||Y.gl.UNSIGNED_BYTE],count:c})}return(0,vt.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var i=n.data;this.elements.subdata(i)}},{key:"destroy",value:function(){}}]),e}(),Y1=function(){function e(r,n){(0,Ue.Z)(this,e);var i=n.width,a=n.height,s=n.color,c=n.colors,d={width:i,height:a};Array.isArray(c)&&(d.colors=c.map(function(g){return g.get()})),s&&typeof s!="boolean"&&(d.color=s.get()),this.framebuffer=r.framebuffer(d)}return(0,vt.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var i=n.width,a=n.height;this.framebuffer.resize(i,a)}}]),e}(),yf=x(95147),td=x(25897),K1=x(81957),yi=x(97582),q1=x(90857),yg=q1,Bt;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(Bt||(Bt={}));var po;(function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool",e[e.RenderBundle=11]="RenderBundle"})(po||(po={}));var Fa;(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(Fa||(Fa={}));var tv;(function(e){e[e.CCW=2305]="CCW",e[e.CW=2304]="CW"})(tv||(tv={}));var wc;(function(e){e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(wc||(wc={}));var Ya;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC=768]="SRC",e[e.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",e[e.DST=774]="DST",e[e.ONE_MINUS_DST=775]="ONE_MINUS_DST",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONST=32769]="CONST",e[e.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(Ya||(Ya={}));var tl;(function(e){e[e.ADD=32774]="ADD",e[e.SUBSTRACT=32778]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX"})(tl||(tl={}));var oc;(function(e){e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(oc||(oc={}));var $s;(function(e){e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR"})($s||($s={}));var Bu;(function(e){e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR"})(Bu||(Bu={}));var su;(function(e){e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP"})(su||(su={}));var $o;(function(e){e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE"})($o||($o={}));var Zf;(function(e){e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC"})(Zf||(Zf={}));var wp;(function(e){e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE"})(wp||(wp={}));var _g;(function(e){e.LOADED="loaded"})(_g||(_g={}));var za;(function(e){e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(za||(za={}));var wl;(function(e){e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET",e[e.STORAGE=4]="STORAGE"})(wl||(wl={}));var rl;(function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL"})(rl||(rl={}));var Bs;(function(e){e[e.KEEP=7680]="KEEP",e[e.ZERO=0]="ZERO",e[e.REPLACE=7681]="REPLACE",e[e.INVERT=5386]="INVERT",e[e.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=34055]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(Bs||(Bs={}));function HE(e,r,n,i){var a=za.TEXTURE_2D,s=1,c=wl.SAMPLED;return{dimension:a,format:e,width:r,height:n,depthOrArrayLayers:s,mipLevelCount:i,usage:c}}var Fs;(function(e){e[e.Float=0]="Float",e[e.UnfilterableFloat=1]="UnfilterableFloat",e[e.Uint=2]="Uint",e[e.Sint=3]="Sint",e[e.Depth=4]="Depth"})(Fs||(Fs={}));var sh;(function(e){e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT"})(sh||(sh={}));var rd;(function(e){e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO"})(rd||(rd={}));var Wv;(function(e){e[e.OcclusionConservative=0]="OcclusionConservative"})(Wv||(Wv={}));var pn;(function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8"})(pn||(pn={}));var Ti;(function(e){e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A"})(Ti||(Ti={}));function WE(e){return e}var li;(function(e){e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget",e[e.Luminance=32]="Luminance"})(li||(li={}));function $i(e,r,n){return e<<16|r<<8|n}var nr;(function(e){e[e.ALPHA=$i(pn.U8,Ti.A,li.None)]="ALPHA",e[e.U8_LUMINANCE=$i(pn.U8,Ti.A,li.Luminance)]="U8_LUMINANCE",e[e.F16_LUMINANCE=$i(pn.F16,Ti.A,li.Luminance)]="F16_LUMINANCE",e[e.F32_LUMINANCE=$i(pn.F32,Ti.A,li.Luminance)]="F32_LUMINANCE",e[e.F16_R=$i(pn.F16,Ti.R,li.None)]="F16_R",e[e.F16_RG=$i(pn.F16,Ti.RG,li.None)]="F16_RG",e[e.F16_RGB=$i(pn.F16,Ti.RGB,li.None)]="F16_RGB",e[e.F16_RGBA=$i(pn.F16,Ti.RGBA,li.None)]="F16_RGBA",e[e.F32_R=$i(pn.F32,Ti.R,li.None)]="F32_R",e[e.F32_RG=$i(pn.F32,Ti.RG,li.None)]="F32_RG",e[e.F32_RGB=$i(pn.F32,Ti.RGB,li.None)]="F32_RGB",e[e.F32_RGBA=$i(pn.F32,Ti.RGBA,li.None)]="F32_RGBA",e[e.U8_R=$i(pn.U8,Ti.R,li.None)]="U8_R",e[e.U8_R_NORM=$i(pn.U8,Ti.R,li.Normalized)]="U8_R_NORM",e[e.U8_RG=$i(pn.U8,Ti.RG,li.None)]="U8_RG",e[e.U8_RG_NORM=$i(pn.U8,Ti.RG,li.Normalized)]="U8_RG_NORM",e[e.U8_RGB=$i(pn.U8,Ti.RGB,li.None)]="U8_RGB",e[e.U8_RGB_NORM=$i(pn.U8,Ti.RGB,li.Normalized)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=$i(pn.U8,Ti.RGB,li.sRGB|li.Normalized)]="U8_RGB_SRGB",e[e.U8_RGBA=$i(pn.U8,Ti.RGBA,li.None)]="U8_RGBA",e[e.U8_RGBA_NORM=$i(pn.U8,Ti.RGBA,li.Normalized)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=$i(pn.U8,Ti.RGBA,li.sRGB|li.Normalized)]="U8_RGBA_SRGB",e[e.U16_R=$i(pn.U16,Ti.R,li.None)]="U16_R",e[e.U16_R_NORM=$i(pn.U16,Ti.R,li.Normalized)]="U16_R_NORM",e[e.U16_RG_NORM=$i(pn.U16,Ti.RG,li.Normalized)]="U16_RG_NORM",e[e.U16_RGBA_NORM=$i(pn.U16,Ti.RGBA,li.Normalized)]="U16_RGBA_NORM",e[e.U16_RGBA=$i(pn.U16,Ti.RGBA,li.None)]="U16_RGBA",e[e.U16_RGB=$i(pn.U16,Ti.RGB,li.None)]="U16_RGB",e[e.U16_RG=$i(pn.U16,Ti.RG,li.None)]="U16_RG",e[e.U32_R=$i(pn.U32,Ti.R,li.None)]="U32_R",e[e.U32_RG=$i(pn.U32,Ti.RG,li.None)]="U32_RG",e[e.U32_RGB=$i(pn.U32,Ti.RGB,li.None)]="U32_RGB",e[e.U32_RGBA=$i(pn.U32,Ti.RGBA,li.None)]="U32_RGBA",e[e.S8_R=$i(pn.S8,Ti.R,li.None)]="S8_R",e[e.S8_R_NORM=$i(pn.S8,Ti.R,li.Normalized)]="S8_R_NORM",e[e.S8_RG_NORM=$i(pn.S8,Ti.RG,li.Normalized)]="S8_RG_NORM",e[e.S8_RGB_NORM=$i(pn.S8,Ti.RGB,li.Normalized)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=$i(pn.S8,Ti.RGBA,li.Normalized)]="S8_RGBA_NORM",e[e.S16_R=$i(pn.S16,Ti.R,li.None)]="S16_R",e[e.S16_RG=$i(pn.S16,Ti.RG,li.None)]="S16_RG",e[e.S16_RG_NORM=$i(pn.S16,Ti.RG,li.Normalized)]="S16_RG_NORM",e[e.S16_RGB_NORM=$i(pn.S16,Ti.RGB,li.Normalized)]="S16_RGB_NORM",e[e.S16_RGBA=$i(pn.S16,Ti.RGBA,li.None)]="S16_RGBA",e[e.S16_RGBA_NORM=$i(pn.S16,Ti.RGBA,li.Normalized)]="S16_RGBA_NORM",e[e.S32_R=$i(pn.S32,Ti.R,li.None)]="S32_R",e[e.S32_RG=$i(pn.S32,Ti.RG,li.None)]="S32_RG",e[e.S32_RGB=$i(pn.S32,Ti.RGB,li.None)]="S32_RGB",e[e.S32_RGBA=$i(pn.S32,Ti.RGBA,li.None)]="S32_RGBA",e[e.U16_RGBA_5551=$i(pn.U16_PACKED_5551,Ti.RGBA,li.Normalized)]="U16_RGBA_5551",e[e.U16_RGB_565=$i(pn.U16_PACKED_565,Ti.RGB,li.Normalized)]="U16_RGB_565",e[e.BC1=$i(pn.BC1,Ti.RGBA,li.Normalized)]="BC1",e[e.BC1_SRGB=$i(pn.BC1,Ti.RGBA,li.Normalized|li.sRGB)]="BC1_SRGB",e[e.BC2=$i(pn.BC2,Ti.RGBA,li.Normalized)]="BC2",e[e.BC2_SRGB=$i(pn.BC2,Ti.RGBA,li.Normalized|li.sRGB)]="BC2_SRGB",e[e.BC3=$i(pn.BC3,Ti.RGBA,li.Normalized)]="BC3",e[e.BC3_SRGB=$i(pn.BC3,Ti.RGBA,li.Normalized|li.sRGB)]="BC3_SRGB",e[e.BC4_UNORM=$i(pn.BC4_UNORM,Ti.R,li.Normalized)]="BC4_UNORM",e[e.BC4_SNORM=$i(pn.BC4_SNORM,Ti.R,li.Normalized)]="BC4_SNORM",e[e.BC5_UNORM=$i(pn.BC5_UNORM,Ti.RG,li.Normalized)]="BC5_UNORM",e[e.BC5_SNORM=$i(pn.BC5_SNORM,Ti.RG,li.Normalized)]="BC5_SNORM",e[e.D24=$i(pn.D24,Ti.R,li.Depth)]="D24",e[e.D24_S8=$i(pn.D24S8,Ti.RG,li.Depth|li.Stencil)]="D24_S8",e[e.D32F=$i(pn.D32F,Ti.R,li.Depth)]="D32F",e[e.D32F_S8=$i(pn.D32FS8,Ti.RG,li.Depth|li.Stencil)]="D32F_S8",e[e.U8_RGB_RT=$i(pn.U8,Ti.RGB,li.RenderTarget|li.Normalized)]="U8_RGB_RT",e[e.U8_RGBA_RT=$i(pn.U8,Ti.RGBA,li.RenderTarget|li.Normalized)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=$i(pn.U8,Ti.RGBA,li.RenderTarget|li.Normalized|li.sRGB)]="U8_RGBA_RT_SRGB"})(nr||(nr={}));function Gv(e){return e>>>8&255}function uh(e){return e>>>16&255}function nd(e){return e&255}function xg(e){switch(e){case pn.F32:case pn.U32:case pn.S32:return 4;case pn.U16:case pn.S16:case pn.F16:return 2;case pn.U8:case pn.S8:return 1;default:throw new Error("whoops")}}function bg(e){return xg(uh(e))}function GE(e){return Gv(e)}function Q1(e){var r=xg(uh(e)),n=Gv(e);return r*n}function XE(e,r){return e&4294967040|r}function YE(e,r){return e&4294902015|r<<8}function Eg(e){var r=nd(e);if(r&li.Depth)return Fs.Depth;if(r&li.Normalized)return Fs.Float;var n=uh(e);if(n===pn.F16||n===pn.F32)return Fs.Float;if(n===pn.U8||n===pn.U16||n===pn.U32)return Fs.Uint;if(n===pn.S8||n===pn.S16||n===pn.S32)return Fs.Sint;throw new Error("whoops")}function xa(e,r){if(r===void 0&&(r=""),!e)throw new Error("Assert fail: ".concat(r))}function Rp(e){if(e!=null)return e;throw new Error("Missing object")}function Sg(e,r){return e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a}function Tg(e,r){e.r=r.r,e.g=r.g,e.b=r.b,e.a=r.a}function Ag(e){var r=e.r,n=e.g,i=e.b,a=e.a;return{r,g:n,b:i,a}}function rv(e,r,n,i){return i===void 0&&(i=1),{r:e,g:r,b:n,a:i}}var Xv=rv(0,0,0,0),KE=rv(0,0,0,1),J1=rv(1,1,1,0),qE=rv(1,1,1,1),id=!0;function QE(e,r){r===void 0&&(r=id),r&&(e[10]=-e[10],e[14]=-e[14])}function JE(e,r){r===void 0&&(r=id),r&&(e[10]=-e[10],e[14]=-e[14]+1)}function ex(e,r){if(r===void 0&&(r=id),r)switch(e){case Fa.LESS:return Fa.GREATER;case Fa.LEQUAL:return Fa.GEQUAL;case Fa.GEQUAL:return Fa.LEQUAL;case Fa.GREATER:return Fa.LESS;default:return e}else return e}function e2(e,r){return r===void 0&&(r=id),r?1-e:e}function t2(e,r){return r===void 0&&(r=id),r?-e:e}function r2(e,r,n,i){if(i===void 0&&(i=id),n=ex(n,i),n===Fa.LESS)return e<r;if(n===Fa.LEQUAL)return e<=r;if(n===Fa.GREATER)return e>r;if(n===Fa.GEQUAL)return e>=r;throw new Error("whoops")}function Yv(e){return!!(e&&!(e&e-1))}function ad(e,r){return e!=null?e:r}function tx(e){return e===void 0?null:e}function n2(e,r,n){e.length=r,e.fill(n)}function Kv(e,r){var n=r-1;return e+n&~n}function i2(e,r){return((e+r-1)/r|0)*r}function rx(e,r,n){for(var i=0,a=e.length;i<a;){var s=i+(a-i>>>1),c=n(r,e[s]);c<0?a=s:i=s+1}return i}function a2(e,r,n){var i=rx(e,r,n);e.splice(i,0,r)}function o2(e,r,n){return n?e|=r:e&=~r,e}function nx(e,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=r();return n}function ix(e,r){r===void 0&&(r=1);var n=e.split(`
`);return n.map(function(i,a){return"".concat(ax(""+(r+a),4," "),"  ").concat(i)}).join(`
`)}function ax(e,r,n){for(n===void 0&&(n="0");e.length<r;)e="".concat(n).concat(e);return e}function s2(e,r){for(var n=[],i=e;i<e+r;i++)n.push(i);return n}function Cg(e,r){e.blendDstFactor=r.blendDstFactor,e.blendSrcFactor=r.blendSrcFactor,e.blendMode=r.blendMode}function qv(e,r){return e===void 0&&(e={}),e.compare=r.compare,e.depthFailOp=r.depthFailOp,e.passOp=r.passOp,e.failOp=r.failOp,e.mask=r.mask,e}function wg(e,r){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),Cg(e.rgbBlendState,r.rgbBlendState),Cg(e.alphaBlendState,r.alphaBlendState),e.channelWriteMask=r.channelWriteMask,e}function Bm(e,r){e.length!==r.length&&(e.length=r.length);for(var n=0;n<r.length;n++)e[n]=wg(e[n],r[n])}function ox(e,r){r.attachmentsState!==void 0&&Bm(e.attachmentsState,r.attachmentsState),e.blendConstant&&r.blendConstant&&Tg(e.blendConstant,r.blendConstant),e.depthCompare=ad(r.depthCompare,e.depthCompare),e.depthWrite=ad(r.depthWrite,e.depthWrite),e.stencilWrite=ad(r.stencilWrite,e.stencilWrite),e.stencilFront&&r.stencilFront&&qv(e.stencilFront,r.stencilFront),e.stencilBack&&r.stencilBack&&qv(e.stencilBack,r.stencilBack),e.cullMode=ad(r.cullMode,e.cullMode),e.frontFace=ad(r.frontFace,e.frontFace),e.polygonOffset=ad(r.polygonOffset,e.polygonOffset)}function od(e){var r=Object.assign({},e);return r.attachmentsState=[],Bm(r.attachmentsState,e.attachmentsState),r.blendConstant=r.blendConstant&&Ag(r.blendConstant),r.stencilFront=qv(void 0,e.stencilFront),r.stencilBack=qv(void 0,e.stencilBack),r}function sx(e,r){r.channelWriteMask!==void 0&&(e.channelWriteMask=r.channelWriteMask),r.rgbBlendMode!==void 0&&(e.rgbBlendState.blendMode=r.rgbBlendMode),r.alphaBlendMode!==void 0&&(e.alphaBlendState.blendMode=r.alphaBlendMode),r.rgbBlendSrcFactor!==void 0&&(e.rgbBlendState.blendSrcFactor=r.rgbBlendSrcFactor),r.alphaBlendSrcFactor!==void 0&&(e.alphaBlendState.blendSrcFactor=r.alphaBlendSrcFactor),r.rgbBlendDstFactor!==void 0&&(e.rgbBlendState.blendDstFactor=r.rgbBlendDstFactor),r.alphaBlendDstFactor!==void 0&&(e.alphaBlendState.blendDstFactor=r.alphaBlendDstFactor)}var Rg={blendMode:tl.ADD,blendSrcFactor:Ya.ONE,blendDstFactor:Ya.ZERO},Mp={attachmentsState:[{channelWriteMask:rl.ALL,rgbBlendState:Rg,alphaBlendState:Rg}],blendConstant:Ag(Xv),depthWrite:!0,depthCompare:Fa.LEQUAL,stencilWrite:!1,stencilFront:{compare:Fa.ALWAYS,passOp:Bs.KEEP,depthFailOp:Bs.KEEP,failOp:Bs.KEEP},stencilBack:{compare:Fa.ALWAYS,passOp:Bs.KEEP,depthFailOp:Bs.KEEP,failOp:Bs.KEEP},cullMode:wc.NONE,frontFace:tv.CCW,polygonOffset:!1};function ux(e,r){e===void 0&&(e=null),r===void 0&&(r=Mp);var n=od(r);return e!==null&&ox(n,e),n}var u2=ux({depthCompare:Fa.ALWAYS,depthWrite:!1},Mp);function l2(e,r){return e.attachmentsState===void 0&&(e.attachmentsState=[],Bm(e.attachmentsState,Mp.attachmentsState)),sx(e.attachmentsState[0],r),e}var Mg={texture:null,sampler:null,formatKind:Fs.Float,dimension:za.TEXTURE_2D};function Yh(e,r,n){if(e.length!==r.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],r[i]))return!1;return!0}function sd(e,r){for(var n=Array(e.length),i=0;i<e.length;i++)n[i]=r(e[i]);return n}function lx(e,r){return e.texture===r.texture&&e.binding===r.binding}function Og(e,r){return e.buffer===r.buffer&&e.size===r.size&&e.binding===r.binding&&e.offset===r.offset}function cx(e,r){return e===null?r===null:r===null?!1:e.sampler===r.sampler&&e.texture===r.texture&&e.dimension===r.dimension&&e.formatKind===r.formatKind&&e.comparison===r.comparison}function fx(e,r){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],e.storageBufferBindings=e.storageBufferBindings||[],e.storageTextureBindings=e.storageTextureBindings||[],r.samplerBindings=r.samplerBindings||[],r.uniformBufferBindings=r.uniformBufferBindings||[],r.storageBufferBindings=r.storageBufferBindings||[],r.storageTextureBindings=r.storageTextureBindings||[],!(e.samplerBindings.length!==r.samplerBindings.length||!Yh(e.samplerBindings,r.samplerBindings,cx)||!Yh(e.uniformBufferBindings,r.uniformBufferBindings,Og)||!Yh(e.storageBufferBindings,r.storageBufferBindings,Og)||!Yh(e.storageTextureBindings,r.storageTextureBindings,lx))}function Ig(e,r){return e.blendMode==r.blendMode&&e.blendSrcFactor===r.blendSrcFactor&&e.blendDstFactor===r.blendDstFactor}function hx(e,r){return!(!Ig(e.rgbBlendState,r.rgbBlendState)||!Ig(e.alphaBlendState,r.alphaBlendState)||e.channelWriteMask!==r.channelWriteMask)}function Qv(e,r){return e.compare==r.compare&&e.depthFailOp===r.depthFailOp&&e.failOp===r.failOp&&e.passOp===r.passOp&&e.mask===r.mask}function px(e,r){return!Yh(e.attachmentsState,r.attachmentsState,hx)||e.blendConstant&&r.blendConstant&&!Sg(e.blendConstant,r.blendConstant)||e.stencilFront&&r.stencilFront&&!Qv(e.stencilFront,r.stencilFront)||e.stencilBack&&r.stencilBack&&!Qv(e.stencilBack,r.stencilBack)?!1:e.depthCompare===r.depthCompare&&e.depthWrite===r.depthWrite&&e.stencilWrite===r.stencilWrite&&e.cullMode===r.cullMode&&e.frontFace===r.frontFace&&e.polygonOffset===r.polygonOffset}function Pg(e,r){return e.id===r.id}function dx(e,r){return e===r}function vx(e,r){return!(e.topology!==r.topology||e.inputLayout!==r.inputLayout||e.sampleCount!==r.sampleCount||e.megaStateDescriptor&&r.megaStateDescriptor&&!px(e.megaStateDescriptor,r.megaStateDescriptor)||!Pg(e.program,r.program)||!Yh(e.colorAttachmentFormats,r.colorAttachmentFormats,dx)||e.depthStencilAttachmentFormat!==r.depthStencilAttachmentFormat)}function mx(e,r){return e.offset===r.offset&&e.shaderLocation===r.shaderLocation&&e.format===r.format&&e.divisor===r.divisor}function gx(e,r){return(0,yf.Z)(e)?(0,yf.Z)(r):(0,yf.Z)(r)?!1:e.arrayStride===r.arrayStride&&e.stepMode===r.stepMode&&Yh(e.attributes,r.attributes,mx)}function yx(e,r){return!(e.indexBufferFormat!==r.indexBufferFormat||!Yh(e.vertexBufferDescriptors,r.vertexBufferDescriptors,gx)||!Pg(e.program,r.program))}function c2(e,r){return e.addressModeU===r.addressModeU&&e.addressModeV===r.addressModeV&&e.minFilter===r.minFilter&&e.magFilter===r.magFilter&&e.mipmapFilter===r.mipmapFilter&&e.lodMinClamp===r.lodMinClamp&&e.lodMaxClamp===r.lodMaxClamp&&e.maxAnisotropy===r.maxAnisotropy&&e.compareFunction===r.compareFunction}function _x(e){var r=e.sampler,n=e.texture,i=e.dimension,a=e.formatKind,s=e.comparison;return{sampler:r,texture:n,dimension:i,formatKind:a,comparison:s}}function kg(e){var r=e.buffer,n=e.size,i=e.binding,a=e.offset;return{binding:i,buffer:r,offset:a,size:n}}function xx(e){var r=e.binding,n=e.texture;return{binding:r,texture:n}}function bx(e){var r=e.samplerBindings&&sd(e.samplerBindings,_x),n=e.uniformBufferBindings&&sd(e.uniformBufferBindings,kg),i=e.storageBufferBindings&&sd(e.storageBufferBindings,kg),a=e.storageTextureBindings&&sd(e.storageTextureBindings,xx);return{samplerBindings:r,uniformBufferBindings:n,storageBufferBindings:i,storageTextureBindings:a,pipeline:e.pipeline}}function Ex(e){var r=e.inputLayout,n=e.program,i=e.topology,a=e.megaStateDescriptor&&od(e.megaStateDescriptor),s=e.colorAttachmentFormats.slice(),c=e.depthStencilAttachmentFormat,d=e.sampleCount;return{inputLayout:r,megaStateDescriptor:a,program:n,topology:i,colorAttachmentFormats:s,depthStencilAttachmentFormat:c,sampleCount:d}}function Sx(e){var r=e.shaderLocation,n=e.format,i=e.offset,a=e.divisor;return{shaderLocation:r,format:n,offset:i,divisor:a}}function Tx(e){if((0,yf.Z)(e))return e;var r=e.arrayStride,n=e.stepMode,i=sd(e.attributes,Sx);return{arrayStride:r,stepMode:n,attributes:i}}function Ax(e){var r=sd(e.vertexBufferDescriptors,Tx),n=e.indexBufferFormat,i=e.program;return{vertexBufferDescriptors:r,indexBufferFormat:n,program:i}}var ro,Cx=/([^[]*)(\[[0-9]+\])?/;function Rx(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};var r=e.match(Cx);if(!r||r.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:r[1],length:Number(r[2])||1,isArray:!!r[2]}}function sc(){var e=null;return function(r,n,i){var a=e!==i;return a&&(r.uniform1i(n,i),e=i),a}}function Ns(e,r,n,i){var a=null,s=null;return function(c,d,g){var _=r(g,n),A=_.length,C=!1;if(a===null)a=new Float32Array(A),s=A,C=!0;else{xa(s===A,"Uniform length cannot change.");for(var N=0;N<A;++N)if(_[N]!==a[N]){C=!0;break}}return C&&(i(c,e,d,_),a.set(_)),C}}function Yl(e,r,n,i){e[r](n,i)}function Rh(e,r,n,i){e[r](n,!1,i)}var Mx={},Ox={},Ix={},Dg=[0];function Fm(e,r,n,i){r===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(Dg[0]=e,e=Dg);var a=e.length;if(e instanceof n)return e;var s=i[a];s||(s=new n(a),i[a]=s);for(var c=0;c<a;c++)s[c]=e[c];return s}function Hc(e,r){return Fm(e,r,Float32Array,Mx)}function Kh(e,r){return Fm(e,r,Int32Array,Ox)}function Jv(e,r){return Fm(e,r,Uint32Array,Ix)}var Px=(ro={},ro[Bt.FLOAT]=Ns.bind(null,"uniform1fv",Hc,1,Yl),ro[Bt.FLOAT_VEC2]=Ns.bind(null,"uniform2fv",Hc,2,Yl),ro[Bt.FLOAT_VEC3]=Ns.bind(null,"uniform3fv",Hc,3,Yl),ro[Bt.FLOAT_VEC4]=Ns.bind(null,"uniform4fv",Hc,4,Yl),ro[Bt.INT]=Ns.bind(null,"uniform1iv",Kh,1,Yl),ro[Bt.INT_VEC2]=Ns.bind(null,"uniform2iv",Kh,2,Yl),ro[Bt.INT_VEC3]=Ns.bind(null,"uniform3iv",Kh,3,Yl),ro[Bt.INT_VEC4]=Ns.bind(null,"uniform4iv",Kh,4,Yl),ro[Bt.BOOL]=Ns.bind(null,"uniform1iv",Kh,1,Yl),ro[Bt.BOOL_VEC2]=Ns.bind(null,"uniform2iv",Kh,2,Yl),ro[Bt.BOOL_VEC3]=Ns.bind(null,"uniform3iv",Kh,3,Yl),ro[Bt.BOOL_VEC4]=Ns.bind(null,"uniform4iv",Kh,4,Yl),ro[Bt.FLOAT_MAT2]=Ns.bind(null,"uniformMatrix2fv",Hc,4,Rh),ro[Bt.FLOAT_MAT3]=Ns.bind(null,"uniformMatrix3fv",Hc,9,Rh),ro[Bt.FLOAT_MAT4]=Ns.bind(null,"uniformMatrix4fv",Hc,16,Rh),ro[Bt.UNSIGNED_INT]=Ns.bind(null,"uniform1uiv",Jv,1,Yl),ro[Bt.UNSIGNED_INT_VEC2]=Ns.bind(null,"uniform2uiv",Jv,2,Yl),ro[Bt.UNSIGNED_INT_VEC3]=Ns.bind(null,"uniform3uiv",Jv,3,Yl),ro[Bt.UNSIGNED_INT_VEC4]=Ns.bind(null,"uniform4uiv",Jv,4,Yl),ro[Bt.FLOAT_MAT2x3]=Ns.bind(null,"uniformMatrix2x3fv",Hc,6,Rh),ro[Bt.FLOAT_MAT2x4]=Ns.bind(null,"uniformMatrix2x4fv",Hc,8,Rh),ro[Bt.FLOAT_MAT3x2]=Ns.bind(null,"uniformMatrix3x2fv",Hc,6,Rh),ro[Bt.FLOAT_MAT3x4]=Ns.bind(null,"uniformMatrix3x4fv",Hc,12,Rh),ro[Bt.FLOAT_MAT4x2]=Ns.bind(null,"uniformMatrix4x2fv",Hc,8,Rh),ro[Bt.FLOAT_MAT4x3]=Ns.bind(null,"uniformMatrix4x3fv",Hc,12,Rh),ro[Bt.SAMPLER_2D]=sc,ro[Bt.SAMPLER_CUBE]=sc,ro[Bt.SAMPLER_3D]=sc,ro[Bt.SAMPLER_2D_SHADOW]=sc,ro[Bt.SAMPLER_2D_ARRAY]=sc,ro[Bt.SAMPLER_2D_ARRAY_SHADOW]=sc,ro[Bt.SAMPLER_CUBE_SHADOW]=sc,ro[Bt.INT_SAMPLER_2D]=sc,ro[Bt.INT_SAMPLER_3D]=sc,ro[Bt.INT_SAMPLER_CUBE]=sc,ro[Bt.INT_SAMPLER_2D_ARRAY]=sc,ro[Bt.UNSIGNED_INT_SAMPLER_2D]=sc,ro[Bt.UNSIGNED_INT_SAMPLER_3D]=sc,ro[Bt.UNSIGNED_INT_SAMPLER_CUBE]=sc,ro[Bt.UNSIGNED_INT_SAMPLER_2D_ARRAY]=sc,ro);function Lg(e,r,n){var i=Px[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,e,r)}var kx={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Dx(e){return Object.prototype.toString.call(e)in kx}function nv(e,r){return"#define ".concat(e," ").concat(r)}function Lx(e){var r={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(n,i,a){var s=Number(a);return r[i]=isNaN(s)?a:s,""}),r}function Bx(e,r){var n=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(i,a,s){var c=Number(a);return n.push({location:isNaN(c)?r[a]:c,name:s}),""}),n}function f2(e){var r=[],n=[];return e.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(i,a,s){var c=[];return s.trim().replace(`\r
`,`
`).split(`
`).forEach(function(d){var g=__read(d.trim().split(/\s+/),2),_=g[0],A=g[1];c.push({type:_.trim(),name:A.replace(";","").trim()})}),n.push({type:a.trim(),uniforms:c}),""}),e.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(i,a){return a.trim().replace(`\r
`,`
`).split(`
`).forEach(function(s){var c=s.trim().split(" "),d=c[0]||"",g=c[1]||"",_=g.indexOf("[")>-1;if(g=g.replace(";","").replace("[","").trim(),!d.startsWith("#")){if(d){var A=n.find(function(ae){return d===ae.type});if(A)if(_)for(var C=function(ae){A.uniforms.forEach(function(we){r.push("".concat(g,"[").concat(ae,"].").concat(we.name))})},N=0;N<5;N++)C(N);else A.uniforms.forEach(function(ae){r.push("".concat(g,".").concat(ae.name))})}g&&r.push(g)}}),""}),r}function Bg(e){if(e===void 0)return null;var r=/binding\s*=\s*(\d+)/.exec(e);if(r!==null){var n=parseInt(r[1],10);if(!Number.isNaN(n))return n}return null}function Fg(e){var r="",n=e;return[n,r]}function qh(e,r,n,i,a){var s;i===void 0&&(i=null),a===void 0&&(a=!0);var c=e.glslVersion==="#version 100",d=r==="frag"&&((s=n.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||s===void 0?void 0:s.length)>1,g=n.replace(`\r
`,`
`).split(`
`).map(function(pr){return pr.replace(/[/][/].*$/,"")}).filter(function(pr){var rr=!pr||/^\s+$/.test(pr);return!rr}),_="";i!==null&&(_=Object.keys(i).map(function(pr){return nv(pr,i[pr])}).join(`
`));var A=g.find(function(pr){return pr.startsWith("precision")})||"precision mediump float;",C=a?g.filter(function(pr){return!pr.startsWith("precision")}).join(`
`):g.join(`
`),N="";if(e.viewportOrigin===sh.UPPER_LEFT&&(N+="".concat(nv("VIEWPORT_ORIGIN_TL","1"),`
`)),e.clipSpaceNearZ===rd.ZERO&&(N+="".concat(nv("CLIPSPACE_NEAR_ZERO","1"),`
`)),e.explicitBindingLocations){var ae=0,we=0,De=0;C=C.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(pr,rr,Ur,$n){var Ai=Ur?"".concat(Ur,", "):"";return"layout(".concat(Ai,"set = ").concat(ae,", binding = ").concat(we++,") uniform ").concat($n)}),ae++,we=0,xa(e.separateSamplerTextures),C=C.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(pr,rr,Ur,$n,Ai){var Wn=Bg(Ur);Wn===null&&(Wn=we++);var Xi=(0,yi.CR)(Fg($n),2),oa=Xi[0],Es=Xi[1];return r==="frag"?`
layout(set = `.concat(ae,", binding = ").concat(Wn*2+0,") uniform texture").concat(oa," T_").concat(Ai,`;
layout(set = `).concat(ae,", binding = ").concat(Wn*2+1,") uniform sampler").concat(Es," S_").concat(Ai,";").trim():""}),C=C.replace(r==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(pr,rr){return"layout(location = ".concat(De++,") ").concat(rr)}),N+="".concat(nv("gl_VertexID","gl_VertexIndex"),`
`),N+="".concat(nv("gl_InstanceID","gl_InstanceIndex"),`
`),A=A.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var at=0;C=C.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(pr,rr,Ur,$n,Ai){var Wn=Bg(Ur);return Wn===null&&(Wn=at++),"uniform sampler".concat($n," ").concat(Ai,"; // BINDING=").concat(Wn)})}if(C=C.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return"SAMPLER_".concat(rr,"(P_").concat(Ur,")")}),C=C.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return"PP_SAMPLER_".concat(rr,"(P_").concat(Ur,")")}),C=C.replace(/\bPU_TEXTURE\((.*?)\)/g,function(pr,rr){return"TEXTURE(P_".concat(rr,")")}),e.separateSamplerTextures)C=C.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){var $n=(0,yi.CR)(Fg(rr),2),Ai=$n[0],Wn=$n[1];return"texture".concat(Ai," T_P_").concat(Ur,", sampler").concat(Wn," S_P_").concat(Ur)}),C=C.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return"T_".concat(Ur,", S_").concat(Ur)}),C=C.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return"sampler".concat(rr,"(T_").concat(Ur,", S_").concat(Ur,")")}),C=C.replace(/\bTEXTURE\((.*?)\)/g,function(pr,rr){return"T_".concat(rr)});else{var Ot=[];C=C.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return"sampler".concat(rr," P_").concat(Ur)}),C=C.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return Ur}),C=C.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(pr,rr,Ur){return Ot.push([Ur,rr]),Ur}),c&&Ot.forEach(function(pr){var rr=(0,yi.CR)(pr,2),Ur=rr[0],$n=rr[1];C=C.replace(new RegExp("texture\\(".concat(Ur),"g"),function(){return"texture".concat($n,"(").concat(Ur)})}),C=C.replace(/\bTEXTURE\((.*?)\)/g,function(pr,rr){return rr})}var Pt="".concat(c?"":e.glslVersion,`
`).concat(c&&d?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(c&&r==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(a?A:"",`
`).concat(N||"").concat(_?_+`
`:"",`
`).concat(C,`
`).trim();if(e.explicitBindingLocations&&r==="frag"&&(Pt=Pt.replace(/^\b(out)\b/g,function(pr,rr){return"layout(location = 0) ".concat(rr)})),c){if(r==="frag"&&(Pt=Pt.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(pr,rr,Ur){return"varying ".concat(rr," ").concat(Ur,`;
`)})),r==="vert"&&(Pt=Pt.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(pr,rr,Ur){return"varying ".concat(rr," ").concat(Ur,`;
`)}),Pt=Pt.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(pr,rr,Ur){return"attribute ".concat(rr," ").concat(Ur,`;
`)})),Pt=Pt.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(pr,rr){return rr.trim().replace(/^.*$/gm,function(Ur){var $n=Ur.trim();return $n.startsWith("#")?$n:Ur?"uniform ".concat($n):""})}),r==="frag")if(d){var Kt=[];Pt=Pt.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(pr,rr){return Kt.push(rr),"vec4 ".concat(rr,`;
`)});var hr=Pt.lastIndexOf("}");Pt=Pt.substring(0,hr)+`
    `.concat(Kt.map(function(pr,rr){return"gl_FragData[".concat(rr,"] = ").concat(pr,`;
    `)}).join(`
`))+Pt.substring(hr)}else{var jr;if(Pt=Pt.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(pr,rr,Ur){return jr=Ur,"".concat(rr," ").concat(Ur,`;
`)}),jr){var hr=Pt.lastIndexOf("}");Pt=Pt.substring(0,hr)+`
  gl_FragColor = vec4(`.concat(jr,`);
`)+Pt.substring(hr)}}Pt=Pt.replace(/^\s*layout\((.*)\)/gm,"")}return Pt}function h2(e,r,n,i){i===void 0&&(i=null);var a=qh(e,"vert",r,i),s=qh(e,"frag",n,i);return{vert:r,frag:n,preprocessedVert:a,preprocessedFrag:s}}var _f=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this)||this;return s.id=i,s.device=a,s.device.resourceCreationTracker!==null&&s.device.resourceCreationTracker.trackResourceCreated(s),s}return r.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},r}(yg),Fx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.Bindings;var d=s.uniformBufferBindings,g=s.samplerBindings;return c.uniformBufferBindings=d||[],c.samplerBindings=g||[],c.bindingLayouts=c.createBindingLayouts(),c}return r.prototype.createBindingLayouts=function(){var n=0,i=0,a=[],s=this.uniformBufferBindings.length,c=this.samplerBindings.length;return a.push({firstUniformBuffer:n,numUniformBuffers:s,firstSampler:i,numSamplers:c}),n+=s,i+=c,{numUniformBuffers:n,numSamplers:i,bindingLayoutTables:a}},r}(_f);function Ii(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}function Ng(e){var r=uh(e);switch(r){case pn.BC1:case pn.BC2:case pn.BC3:case pn.BC4_UNORM:case pn.BC4_SNORM:case pn.BC5_UNORM:case pn.BC5_SNORM:return!0;default:return!1}}function Ug(e){var r=nd(e);if(r&li.Normalized)return!1;var n=uh(e);return n===pn.S8||n===pn.S16||n===pn.S32||n===pn.U8||n===pn.U16||n===pn.U32}function Nx(e){switch(e){case Zf.STATIC:return Bt.STATIC_DRAW;case Zf.DYNAMIC:return Bt.DYNAMIC_DRAW}}function zg(e){if(e&$o.INDEX)return Bt.ELEMENT_ARRAY_BUFFER;if(e&$o.VERTEX)return Bt.ARRAY_BUFFER;if(e&$o.UNIFORM)return Bt.UNIFORM_BUFFER}function Ux(e){switch(e){case su.TRIANGLES:return Bt.TRIANGLES;case su.POINTS:return Bt.POINTS;case su.TRIANGLE_STRIP:return Bt.TRIANGLE_STRIP;case su.LINES:return Bt.LINES;case su.LINE_STRIP:return Bt.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function zx(e){switch(e){case pn.U8:return Bt.UNSIGNED_BYTE;case pn.U16:return Bt.UNSIGNED_SHORT;case pn.U32:return Bt.UNSIGNED_INT;case pn.S8:return Bt.BYTE;case pn.S16:return Bt.SHORT;case pn.S32:return Bt.INT;case pn.F16:return Bt.HALF_FLOAT;case pn.F32:return Bt.FLOAT;default:throw new Error("whoops")}}function Zx(e){switch(e){case Ti.R:return 1;case Ti.RG:return 2;case Ti.RGB:return 3;case Ti.RGBA:return 4;default:return 1}}function Vx(e){var r=uh(e),n=Gv(e),i=nd(e),a=zx(r),s=Zx(n),c=!!(i&li.Normalized);return{size:s,type:a,normalized:c}}function jx(e){switch(e){case nr.U8_R:return Bt.UNSIGNED_BYTE;case nr.U16_R:return Bt.UNSIGNED_SHORT;case nr.U32_R:return Bt.UNSIGNED_INT;default:throw new Error("whoops")}}function iv(e){switch(e){case oc.CLAMP_TO_EDGE:return Bt.CLAMP_TO_EDGE;case oc.REPEAT:return Bt.REPEAT;case oc.MIRRORED_REPEAT:return Bt.MIRRORED_REPEAT;default:throw new Error("whoops")}}function em(e,r){if(r===Bu.LINEAR&&e===$s.BILINEAR)return Bt.LINEAR_MIPMAP_LINEAR;if(r===Bu.LINEAR&&e===$s.POINT)return Bt.NEAREST_MIPMAP_LINEAR;if(r===Bu.NEAREST&&e===$s.BILINEAR)return Bt.LINEAR_MIPMAP_NEAREST;if(r===Bu.NEAREST&&e===$s.POINT)return Bt.NEAREST_MIPMAP_NEAREST;if(r===Bu.NO_MIP&&e===$s.BILINEAR)return Bt.LINEAR;if(r===Bu.NO_MIP&&e===$s.POINT)return Bt.NEAREST;throw new Error("Unknown texture filter mode")}function ud(e,r){r===void 0&&(r=0);var n=e;return n.gl_buffer_pages[r/n.pageByteSize|0]}function ld(e){var r=e;return r.gl_texture}function Nm(e){var r=e;return r.gl_sampler}function av(e,r){e.name=r,e.__SPECTOR_Metadata={name:r}}function Zg(e,r){for(var n=[];;){var i=r.exec(e);if(!i)break;n.push(i)}return n}function Qh(e){return e.blendMode==tl.ADD&&e.blendSrcFactor==Ya.ONE&&e.blendDstFactor===Ya.ZERO}function $x(e){switch(e){case Wv.OcclusionConservative:return Bt.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function Hx(e){if(e===za.TEXTURE_2D)return Bt.TEXTURE_2D;if(e===za.TEXTURE_2D_ARRAY)return Bt.TEXTURE_2D_ARRAY;if(e===za.TEXTURE_CUBE_MAP)return Bt.TEXTURE_CUBE_MAP;if(e===za.TEXTURE_3D)return Bt.TEXTURE_3D;throw new Error("whoops")}function Um(e,r,n,i){return!(e%n!==0||r%i!==0)}var Wx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.Buffer;var d=s.viewOrSize,g=s.usage,_=s.hint,A=_===void 0?Zf.STATIC:_,C=a.uniformBufferMaxPageByteSize,N=a.gl,ae=g&$o.UNIFORM;ae||(Ii(N)?N.bindVertexArray(null):a.OES_vertex_array_object.bindVertexArrayOES(null));var we=(0,td.Z)(d)?Kv(d,4):Kv(d.byteLength,4);c.gl_buffer_pages=[];var De;if(ae){for(var at=we;at>0;)c.gl_buffer_pages.push(c.createBufferPage(Math.min(at,C),g,A)),at-=C;De=C}else c.gl_buffer_pages.push(c.createBufferPage(we,g,A)),De=we;return c.pageByteSize=De,c.byteSize=we,c.usage=g,c.gl_target=zg(g),(0,td.Z)(d)||c.setSubData(0,new Uint8Array(d.buffer)),ae||(Ii(N)?N.bindVertexArray(c.device.currentBoundVAO):a.OES_vertex_array_object.bindVertexArrayOES(c.device.currentBoundVAO)),c}return r.prototype.setSubData=function(n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=i.byteLength-a);for(var c=this.device.gl,d=this.pageByteSize,g=n+s,_=n,A=n%d;_<g;){var C=Ii(c)?c.COPY_WRITE_BUFFER:this.gl_target,N=ud(this,_);if(N.ubo)return;c.bindBuffer(C,N),Ii(c)?c.bufferSubData(C,A,i,a,Math.min(g-_,d)):c.bufferSubData(C,A,i),_+=d,A=0,a+=d,this.device.debugGroupStatisticsBufferUpload()}},r.prototype.destroy=function(){e.prototype.destroy.call(this);for(var n=0;n<this.gl_buffer_pages.length;n++)this.gl_buffer_pages[n].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[n]);this.gl_buffer_pages=[]},r.prototype.createBufferPage=function(n,i,a){var s=this.device.gl,c=i&$o.UNIFORM;if(!Ii(s)&&c)return{ubo:!0};var d=this.device.ensureResourceExists(s.createBuffer()),g=zg(i),_=Nx(a);return s.bindBuffer(g,d),s.bufferData(g,n,_),d},r}(_f),Gx=function(e){(0,yi.ZT)(r,e);function r(n){var i,a,s,c,d=n.id,g=n.device,_=n.descriptor,A,C=e.call(this,{id:d,device:g})||this;C.type=po.InputLayout;var N=_.vertexBufferDescriptors,ae=_.indexBufferFormat,we=_.program;xa(ae===nr.U16_R||ae===nr.U32_R||ae===null);var De=ae!==null?jx(ae):null,at=ae!==null?bg(ae):null,Ot=C.device.gl,Pt=C.device.ensureResourceExists(Ii(Ot)?Ot.createVertexArray():g.OES_vertex_array_object.createVertexArrayOES());Ii(Ot)?Ot.bindVertexArray(Pt):g.OES_vertex_array_object.bindVertexArrayOES(Pt),Ot.bindBuffer(Ot.ARRAY_BUFFER,ud(C.device.fallbackVertexBuffer));try{for(var Kt=(0,yi.XA)(_.vertexBufferDescriptors),hr=Kt.next();!hr.done;hr=Kt.next()){var jr=hr.value,pr=jr.stepMode,rr=jr.attributes;try{for(var Ur=(s=void 0,(0,yi.XA)(rr)),$n=Ur.next();!$n.done;$n=Ur.next()){var Ai=$n.value,Wn=Ai.shaderLocation,Xi=Ai.format,oa=Ai.divisor,Es=oa===void 0?1:oa,Nu=Ii(Ot)?Wn:(A=we.attributes[Wn])===null||A===void 0?void 0:A.location,nl=Vx(Xi);if(Ai.vertexFormat=nl,!(0,yf.Z)(Nu)){Ug(Xi);var Wc=nl.size,Mc=nl.type,ml=nl.normalized;Ot.vertexAttribPointer(Nu,Wc,Mc,ml,0,0),pr===wp.INSTANCE&&(Ii(Ot)?Ot.vertexAttribDivisor(Nu,Es):g.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(Nu,Es)),Ot.enableVertexAttribArray(Nu)}}}catch(xf){s={error:xf}}finally{try{$n&&!$n.done&&(c=Ur.return)&&c.call(Ur)}finally{if(s)throw s.error}}}}catch(xf){i={error:xf}}finally{try{hr&&!hr.done&&(a=Kt.return)&&a.call(Kt)}finally{if(i)throw i.error}}return Ii(Ot)?Ot.bindVertexArray(null):g.OES_vertex_array_object.bindVertexArrayOES(null),C.vertexBufferDescriptors=N,C.vao=Pt,C.indexBufferFormat=ae,C.indexBufferType=De,C.indexBufferCompByteSize=at,C.program=we,C}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Ii(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},r}(_f),zm=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=n.fake,d=e.call(this,{id:i,device:a})||this;d.type=po.Texture,s=(0,yi.pi)({dimension:za.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},s);var g=d.device.gl,_,A,C=d.clampmipLevelCount(s);if(d.immutable=s.usage===wl.RENDER_TARGET,d.pixelStore=s.pixelStore,d.format=s.format,d.dimension=s.dimension,d.formatKind=Eg(s.format),d.width=s.width,d.height=s.height,d.depthOrArrayLayers=s.depthOrArrayLayers,d.mipmaps=C>=1,!c){A=d.device.ensureResourceExists(g.createTexture());var N=d.device.translateTextureType(s.format),ae=d.device.translateTextureInternalFormat(s.format);if(d.device.setActiveTexture(g.TEXTURE0),d.device.currentTextures[0]=null,d.preprocessImage(),s.dimension===za.TEXTURE_2D){if(_=Bt.TEXTURE_2D,g.bindTexture(_,A),d.immutable)if(Ii(g))g.texStorage2D(_,C,ae,s.width,s.height);else{var we=(ae===Bt.DEPTH_COMPONENT||d.isNPOT(),0);(d.format===nr.D32F||d.format===nr.D24_S8)&&!Ii(g)&&!a.WEBGL_depth_texture||(g.texImage2D(_,we,ae,s.width,s.height,0,ae,N,null),d.mipmaps&&(d.mipmaps=!1,g.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR),g.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_S,Bt.CLAMP_TO_EDGE),g.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_T,Bt.CLAMP_TO_EDGE)))}xa(s.depthOrArrayLayers===1)}else if(s.dimension===za.TEXTURE_2D_ARRAY)_=Bt.TEXTURE_2D_ARRAY,g.bindTexture(_,A),d.immutable&&Ii(g)&&g.texStorage3D(_,C,ae,s.width,s.height,s.depthOrArrayLayers);else if(s.dimension===za.TEXTURE_3D)_=Bt.TEXTURE_3D,g.bindTexture(_,A),d.immutable&&Ii(g)&&g.texStorage3D(_,C,ae,s.width,s.height,s.depthOrArrayLayers);else if(s.dimension===za.TEXTURE_CUBE_MAP)_=Bt.TEXTURE_CUBE_MAP,g.bindTexture(_,A),d.immutable&&Ii(g)&&g.texStorage2D(_,C,ae,s.width,s.height),xa(s.depthOrArrayLayers===6);else throw new Error("whoops")}return d.gl_texture=A,d.gl_target=_,d.mipLevelCount=C,d}return r.prototype.setImageData=function(n,i){i===void 0&&(i=0);var a=this.device.gl;Ng(this.format);var s=this.gl_target===Bt.TEXTURE_3D||this.gl_target===Bt.TEXTURE_2D_ARRAY,c=this.gl_target===Bt.TEXTURE_CUBE_MAP,d=Dx(n[0]);this.device.setActiveTexture(a.TEXTURE0),this.device.currentTextures[0]=null;var g=n[0],_,A;d?(_=this.width,A=this.height):(_=g.width,A=g.height,this.width=_,this.height=A),a.bindTexture(this.gl_target,this.gl_texture);var C=this.device.translateTextureFormat(this.format),N=Ii(a)?this.device.translateInternalTextureFormat(this.format):C,ae=this.device.translateTextureType(this.format);this.preprocessImage();for(var we=0;we<this.depthOrArrayLayers;we++){var De=n[we],at=this.gl_target;c&&(at=Bt.TEXTURE_CUBE_MAP_POSITIVE_X+we%6),this.immutable?a.texSubImage2D(at,i,0,0,_,A,C,ae,De):Ii(a)?s?a.texImage3D(at,i,N,_,A,this.depthOrArrayLayers,0,C,ae,De):a.texImage2D(at,i,N,_,A,0,C,ae,De):d?a.texImage2D(at,i,C,_,A,0,C,ae,De):a.texImage2D(at,i,C,C,ae,De)}this.mipmaps&&this.generateMipmap(s)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(ld(this))},r.prototype.clampmipLevelCount=function(n){if(n.dimension===za.TEXTURE_2D_ARRAY&&n.depthOrArrayLayers>1){var i=uh(n.format);if(i===pn.BC1)for(var a=n.width,s=n.height,c=0;c<n.mipLevelCount;c++){if(a<=2||s<=2)return c-1;a=Math.max(a/2|0,1),s=Math.max(s/2|0,1)}}return n.mipLevelCount},r.prototype.preprocessImage=function(){var n=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&n.pixelStorei(Bt.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&n.pixelStorei(Bt.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&n.pixelStorei(Bt.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},r.prototype.generateMipmap=function(n){n===void 0&&(n=!1);var i=this.device.gl;return!Ii(i)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(i.bindTexture(this.gl_target,this.gl_texture),n?(i.texParameteri(this.gl_target,Bt.TEXTURE_BASE_LEVEL,0),i.texParameteri(this.gl_target,Bt.TEXTURE_MAX_LEVEL,Math.log2(this.width)),i.texParameteri(this.gl_target,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR_MIPMAP_LINEAR),i.texParameteri(this.gl_target,Bt.TEXTURE_MAG_FILTER,Bt.LINEAR)):i.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.NEAREST_MIPMAP_LINEAR),i.generateMipmap(this.gl_target),i.bindTexture(this.gl_target,null)),this)},r.prototype.isNPOT=function(){var n=this.device.gl;return Ii(n)?!1:!Yv(this.width)||!Yv(this.height)},r}(_f),Xx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.RenderTarget,c.gl_renderbuffer=null,c.texture=null;var d=c.device.gl,g=s.format,_=s.width,A=s.height,C=s.sampleCount,N=C===void 0?1:C,ae=s.texture,we=!1;if((g===nr.D32F||g===nr.D24_S8)&&ae&&!Ii(d)&&!a.WEBGL_depth_texture&&(ae.destroy(),c.texture=null,we=!0),!we&&ae)c.texture=ae;else{c.gl_renderbuffer=c.device.ensureResourceExists(d.createRenderbuffer()),d.bindRenderbuffer(d.RENDERBUFFER,c.gl_renderbuffer);var De=c.device.translateTextureInternalFormat(g,!0);Ii(d)&&N>1?d.renderbufferStorageMultisample(Bt.RENDERBUFFER,N,De,_,A):d.renderbufferStorage(Bt.RENDERBUFFER,De,_,A)}return c.format=g,c.width=_,c.height=A,c.sampleCount=N,c}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},r}(_f),Rc;(function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"})(Rc||(Rc={}));var Yx=function(e){(0,yi.ZT)(r,e);function r(n,i){var a=n.id,s=n.device,c=n.descriptor,d=e.call(this,{id:a,device:s})||this;d.rawVertexGLSL=i,d.type=po.Program,d.uniformSetters={},d.attributes=[];var g=d.device.gl;return d.descriptor=c,d.gl_program=d.device.ensureResourceExists(g.createProgram()),d.gl_shader_vert=null,d.gl_shader_frag=null,d.compileState=Rc.NeedsCompile,d.tryCompileProgram(),d}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},r.prototype.tryCompileProgram=function(){xa(this.compileState===Rc.NeedsCompile);var n=this.descriptor,i=n.vertex,a=n.fragment,s=this.device.gl;i!=null&&i.glsl&&(a!=null&&a.glsl)&&(this.gl_shader_vert=this.compileShader(i.postprocess?i.postprocess(i.glsl):i.glsl,s.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(a.postprocess?a.postprocess(a.glsl):a.glsl,s.FRAGMENT_SHADER),s.attachShader(this.gl_program,this.gl_shader_vert),s.attachShader(this.gl_program,this.gl_shader_frag),s.linkProgram(this.gl_program),this.compileState=Rc.Compiling,Ii(s)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},r.prototype.readAttributesFromLinkedProgram=function(){for(var n,i=this.device.gl,a=i.getProgramParameter(this.gl_program,i.ACTIVE_ATTRIBUTES),s=Lx(this.descriptor.vertex.glsl),c=Bx(this.rawVertexGLSL,s),d=function(A){var C=i.getActiveAttrib(g.gl_program,A),N=C.name,ae=C.type,we=C.size,De=i.getAttribLocation(g.gl_program,N),at=(n=c.find(function(Ot){return Ot.name===N}))===null||n===void 0?void 0:n.location;De>=0&&!(0,yf.Z)(at)&&(g.attributes[at]={name:N,location:De,type:ae,size:we})},g=this,_=0;_<a;_++)d(_)},r.prototype.readUniformLocationsFromLinkedProgram=function(){for(var n=this.device.gl,i=n.getProgramParameter(this.gl_program,n.ACTIVE_UNIFORMS),a=0;a<i;a++){var s=n.getActiveUniform(this.gl_program,a),c=Rx(s.name).name,d=n.getUniformLocation(this.gl_program,c);if(this.uniformSetters[c]=Lg(n,d,s),s&&s.size>1)for(var g=0;g<s.size;g++)d=n.getUniformLocation(this.gl_program,"".concat(c,"[").concat(g,"]")),this.uniformSetters["".concat(c,"[").concat(g,"]")]=Lg(n,d,s)}},r.prototype.compileShader=function(n,i){var a=this.device.gl,s=this.device.ensureResourceExists(a.createShader(i));return a.shaderSource(s,n),a.compileShader(s),s},r.prototype.setUniformsLegacy=function(n){n===void 0&&(n={});var i=this.device.gl;if(!Ii(i)){var a=!1;for(var s in n){a||(i.useProgram(this.gl_program),a=!0);var c=n[s],d=this.uniformSetters[s];if(d){var g=c;g instanceof zm&&(g=g.textureIndex),d(g)}}}return this},r}(_f),Kx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.QueryPool;var d=c.device.gl;if(Ii(d)){var g=s.elemCount,_=s.type;c.gl_query=nx(g,function(){return c.device.ensureResourceExists(d.createQuery())}),c.gl_query_type=$x(_)}return c}return r.prototype.queryResultOcclusion=function(n){var i=this.device.gl;if(Ii(i)){var a=this.gl_query[n];return i.getQueryParameter(a,i.QUERY_RESULT_AVAILABLE)?!!i.getQueryParameter(a,i.QUERY_RESULT):null}return null},r.prototype.destroy=function(){e.prototype.destroy.call(this);var n=this.device.gl;if(Ii(n))for(var i=0;i<this.gl_query.length;i++)n.deleteQuery(this.gl_query[i])},r}(_f),qx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=po.Readback,s.gl_pbo=null,s.gl_sync=null,s}return r.prototype.clientWaitAsync=function(n,i,a){i===void 0&&(i=0),a===void 0&&(a=10);var s=this.device.gl;return new Promise(function(c,d){function g(){var _=s.clientWaitSync(n,i,0);if(_==s.WAIT_FAILED){d();return}if(_==s.TIMEOUT_EXPIRED){setTimeout(g,(0,K1.Z)(a,0,s.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}c()}g()})},r.prototype.getBufferSubDataAsync=function(n,i,a,s,c,d){return(0,yi.mG)(this,void 0,void 0,function(){var g;return(0,yi.Jh)(this,function(_){switch(_.label){case 0:return g=this.device.gl,Ii(g)?(this.gl_sync=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0),g.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return _.sent(),g.bindBuffer(n,i),g.getBufferSubData(n,a,s,c,d),g.bindBuffer(n,null),[2,s];case 2:return[2]}})})},r.prototype.readTexture=function(n,i,a,s,c,d,g,_){return g===void 0&&(g=0),_===void 0&&(_=d.byteLength||0),(0,yi.mG)(this,void 0,void 0,function(){var A,C,N,ae,we;return(0,yi.Jh)(this,function(De){return A=this.device.gl,C=n,N=this.device.translateTextureFormat(C.format),ae=this.device.translateTextureType(C.format),we=Q1(C.format),Ii(A)?(this.gl_pbo=this.device.ensureResourceExists(A.createBuffer()),A.bindBuffer(A.PIXEL_PACK_BUFFER,this.gl_pbo),A.bufferData(A.PIXEL_PACK_BUFFER,_,A.STREAM_READ),A.bindBuffer(A.PIXEL_PACK_BUFFER,null),A.bindFramebuffer(Bt.READ_FRAMEBUFFER,this.device.readbackFramebuffer),A.framebufferTexture2D(Bt.READ_FRAMEBUFFER,Bt.COLOR_ATTACHMENT0,Bt.TEXTURE_2D,C.gl_texture,0),A.bindBuffer(A.PIXEL_PACK_BUFFER,this.gl_pbo),A.readPixels(i,a,s,c,N,ae,g*we),A.bindBuffer(A.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(A.PIXEL_PACK_BUFFER,this.gl_pbo,0,d,g,0)]):[2,this.readTextureSync(n,i,a,s,c,d,g,_)]})})},r.prototype.readTextureSync=function(n,i,a,s,c,d,g,_){_===void 0&&(_=d.byteLength||0);var A=this.device.gl,C=n,N=this.device.translateTextureType(C.format);return A.bindFramebuffer(Bt.FRAMEBUFFER,this.device.readbackFramebuffer),A.framebufferTexture2D(Bt.FRAMEBUFFER,Bt.COLOR_ATTACHMENT0,Bt.TEXTURE_2D,C.gl_texture,0),A.pixelStorei(A.PACK_ALIGNMENT,4),A.readPixels(i,a,s,c,A.RGBA,N,d),d},r.prototype.readBuffer=function(n,i,a,s,c){return(0,yi.mG)(this,void 0,void 0,function(){var d;return(0,yi.Jh)(this,function(g){return d=this.device.gl,Ii(d)?[2,this.getBufferSubDataAsync(d.ARRAY_BUFFER,ud(n,i),i,a,s,c)]:[2,Promise.reject()]})})},r.prototype.destroy=function(){e.prototype.destroy.call(this),Ii(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},r}(_f),Qx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,d,g=e.call(this,{id:i,device:a})||this;return g.type=po.RenderPipeline,g.drawMode=Ux((c=s.topology)!==null&&c!==void 0?c:su.TRIANGLES),g.program=s.program,g.inputLayout=s.inputLayout,g.megaState=(0,yi.pi)((0,yi.pi)({},od(Mp)),s.megaStateDescriptor),g.colorAttachmentFormats=s.colorAttachmentFormats.slice(),g.depthStencilAttachmentFormat=s.depthStencilAttachmentFormat,g.sampleCount=(d=s.sampleCount)!==null&&d!==void 0?d:1,g}return r}(_f),Jx=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=po.ComputePipeline,c.descriptor=s,c}return r}(_f),eb=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(r){this.creationStacks.set(r,new Error().stack),this.liveObjects.add(r)},e.prototype.trackResourceDestroyed=function(r){this.deletionStacks.has(r)&&console.warn("Object double freed:",r,`

Creation stack: `,this.creationStacks.get(r),`

Deletion stack: `,this.deletionStacks.get(r),`

This stack: `,new Error().stack),this.deletionStacks.set(r,new Error().stack),this.liveObjects.delete(r)},e.prototype.checkForLeaks=function(){var r,n;try{for(var i=(0,yi.XA)(this.liveObjects.values()),a=i.next();!a.done;a=i.next()){var s=a.value;console.warn("Object leaked:",s,"Creation stack:",this.creationStacks.get(s))}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.setResourceLeakCheck=function(r,n){n?this.liveObjects.add(r):this.liveObjects.delete(r)},e}(),tb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,d,g=e.call(this,{id:i,device:a})||this;g.type=po.Sampler;var _=g.device.gl;if(Ii(_)){var A=g.device.ensureResourceExists(_.createSampler());_.samplerParameteri(A,Bt.TEXTURE_WRAP_S,iv(s.addressModeU)),_.samplerParameteri(A,Bt.TEXTURE_WRAP_T,iv(s.addressModeV)),_.samplerParameteri(A,Bt.TEXTURE_WRAP_R,iv((c=s.addressModeW)!==null&&c!==void 0?c:s.addressModeU)),_.samplerParameteri(A,Bt.TEXTURE_MIN_FILTER,em(s.minFilter,s.mipmapFilter)),_.samplerParameteri(A,Bt.TEXTURE_MAG_FILTER,em(s.magFilter,Bu.NO_MIP)),s.lodMinClamp!==void 0&&_.samplerParameterf(A,Bt.TEXTURE_MIN_LOD,s.lodMinClamp),s.lodMaxClamp!==void 0&&_.samplerParameterf(A,Bt.TEXTURE_MAX_LOD,s.lodMaxClamp),s.compareFunction!==void 0&&(_.samplerParameteri(A,_.TEXTURE_COMPARE_MODE,_.COMPARE_REF_TO_TEXTURE),_.samplerParameteri(A,_.TEXTURE_COMPARE_FUNC,s.compareFunction));var C=(d=s.maxAnisotropy)!==null&&d!==void 0?d:1;C>1&&g.device.EXT_texture_filter_anisotropic!==null&&(xa(s.minFilter===$s.BILINEAR&&s.magFilter===$s.BILINEAR&&s.mipmapFilter===Bu.LINEAR),_.samplerParameterf(A,g.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C)),g.gl_sampler=A}else g.descriptor=s;return g}return r.prototype.setTextureParameters=function(n,i,a){var s,c=this.device.gl,d=this.descriptor;this.isNPOT(i,a)?c.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR):c.texParameteri(n,Bt.TEXTURE_MIN_FILTER,em(d.minFilter,d.mipmapFilter)),c.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_S,iv(d.addressModeU)),c.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_T,iv(d.addressModeV)),c.texParameteri(n,Bt.TEXTURE_MAG_FILTER,em(d.magFilter,Bu.NO_MIP));var g=(s=d.maxAnisotropy)!==null&&s!==void 0?s:1;g>1&&this.device.EXT_texture_filter_anisotropic!==null&&(xa(d.minFilter===$s.BILINEAR&&d.magFilter===$s.BILINEAR&&d.mipmapFilter===Bu.LINEAR),c.texParameteri(n,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g))},r.prototype.destroy=function(){e.prototype.destroy.call(this),Ii(this.device.gl)&&this.device.gl.deleteSampler(Nm(this))},r.prototype.isNPOT=function(n,i){return!Yv(n)||!Yv(i)},r}(_f),rb=function(){function e(){}return e.prototype.dispatchWorkgroups=function(r,n,i){},e.prototype.dispatchWorkgroupsIndirect=function(r,n){},e.prototype.setPipeline=function(r){},e.prototype.setBindings=function(r){},e.prototype.pushDebugGroup=function(r){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(r){},e}(),nb=function(e){(0,yi.ZT)(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=po.RenderBundle,n.commands=[],n}return r.prototype.push=function(n){this.commands.push(n)},r.prototype.replay=function(){this.commands.forEach(function(n){return n()})},r}(_f),Vg=65536,ib=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,ab=function(){function e(r,n){n===void 0&&(n={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=od(Mp),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=sh.LOWER_LEFT,this.clipSpaceNearZ=rd.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=r,this.contextAttributes=Rp(r.getContextAttributes()),Ii(r)?(this.EXT_texture_norm16=r.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=r.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=r.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=r.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=r.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=r.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=r.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=r.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=r.getExtension("EXT_color_buffer_half_float"),r.getExtension("EXT_frag_depth"),r.getExtension("OES_element_index_uint"),r.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=r.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=r.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=r.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=r.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=r.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=r.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=r.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=r.getExtension("KHR_parallel_shader_compile"),Ii(r)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new zm({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:za.TEXTURE_2D,mipLevelCount:1,usage:wl.RENDER_TARGET,format:this.contextAttributes.alpha===!1?nr.U8_RGB_RT:nr.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Fs.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(za.TEXTURE_2D,Fs.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(za.TEXTURE_2D,Fs.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:$o.VERTEX,hint:Zf.STATIC}),Ii(r)&&(this.fallbackTexture2DArray=this.createFallbackTexture(za.TEXTURE_2D_ARRAY,Fs.Float),this.fallbackTexture3D=this.createFallbackTexture(za.TEXTURE_3D,Fs.Float),this.fallbackTextureCube=this.createFallbackTexture(za.TEXTURE_CUBE_MAP,Fs.Float)),this.currentMegaState.depthCompare=Fa.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=rl.ALL,r.enable(r.DEPTH_TEST),r.enable(r.STENCIL_TEST),this.checkLimits(),n.shaderDebug&&(this.shaderDebug=!0),n.trackResources&&(this.resourceCreationTracker=new eb)}return e.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},e.prototype.createFallbackTexture=function(r,n){var i=r===za.TEXTURE_CUBE_MAP?6:1,a=n===Fs.Depth?nr.D32F:nr.U8_RGBA_NORM,s=this.createTexture({dimension:r,format:a,usage:wl.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1});return n===Fs.Float&&s.setImageData([new Uint8Array(4*i)]),ld(s)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var r=this.gl;if(this.maxVertexAttribs=r.getParameter(Bt.MAX_VERTEX_ATTRIBS),Ii(r)){this.uniformBufferMaxPageByteSize=Math.min(r.getParameter(Bt.MAX_UNIFORM_BLOCK_SIZE),Vg),this.uniformBufferWordAlignment=r.getParameter(r.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var n=r.getInternalformatParameter(r.RENDERBUFFER,r.DEPTH32F_STENCIL8,r.SAMPLES);this.supportedSampleCounts=n?(0,yi.ev)([],(0,yi.CR)(n),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=Vg;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(i,a){return i-a})},e.prototype.configureSwapChain=function(r,n,i){var a=this.scTexture;a.width=r,a.height=n,this.scPlatformFramebuffer=tx(i)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.translateTextureInternalFormat=function(r,n){switch(n===void 0&&(n=!1),r){case nr.ALPHA:return Bt.ALPHA;case nr.U8_LUMINANCE:case nr.F16_LUMINANCE:case nr.F32_LUMINANCE:return Bt.LUMINANCE;case nr.F16_R:return Bt.R16F;case nr.F16_RG:return Bt.RG16F;case nr.F16_RGB:return Bt.RGB16F;case nr.F16_RGBA:return Bt.RGBA16F;case nr.F32_R:return Bt.R32F;case nr.F32_RG:return Bt.RG32F;case nr.F32_RGB:return Bt.RGB32F;case nr.F32_RGBA:return Ii(this.gl)?Bt.RGBA32F:n?this.WEBGL_color_buffer_float.RGBA32F_EXT:Bt.RGBA;case nr.U8_R_NORM:return Bt.R8;case nr.U8_RG_NORM:return Bt.RG8;case nr.U8_RGB_NORM:case nr.U8_RGB_RT:return Bt.RGB8;case nr.U8_RGB_SRGB:return Bt.SRGB8;case nr.U8_RGBA_NORM:case nr.U8_RGBA_RT:return Ii(this.gl)?Bt.RGBA8:n?Bt.RGBA4:Bt.RGBA;case nr.U8_RGBA:return Bt.RGBA;case nr.U8_RGBA_SRGB:case nr.U8_RGBA_RT_SRGB:return Bt.SRGB8_ALPHA8;case nr.U16_R:return Bt.R16UI;case nr.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case nr.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case nr.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case nr.U16_RGBA_5551:return Bt.RGB5_A1;case nr.U16_RGB_565:return Bt.RGB565;case nr.U32_R:return Bt.R32UI;case nr.S8_RGBA_NORM:return Bt.RGBA8_SNORM;case nr.S8_RG_NORM:return Bt.RG8_SNORM;case nr.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case nr.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case nr.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case nr.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case nr.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case nr.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case nr.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case nr.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case nr.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case nr.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case nr.D32F_S8:return Ii(this.gl)?Bt.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?Bt.DEPTH_STENCIL:Bt.DEPTH_COMPONENT16;case nr.D24_S8:return Ii(this.gl)?Bt.DEPTH24_STENCIL8:this.WEBGL_depth_texture?Bt.DEPTH_STENCIL:Bt.DEPTH_COMPONENT16;case nr.D32F:return Ii(this.gl)?Bt.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?Bt.DEPTH_COMPONENT:Bt.DEPTH_COMPONENT16;case nr.D24:return Ii(this.gl)?Bt.DEPTH_COMPONENT24:this.WEBGL_depth_texture?Bt.DEPTH_COMPONENT:Bt.DEPTH_COMPONENT16;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(r){var n=uh(r);switch(n){case pn.U8:return Bt.UNSIGNED_BYTE;case pn.U16:return Bt.UNSIGNED_SHORT;case pn.U32:return Bt.UNSIGNED_INT;case pn.S8:return Bt.BYTE;case pn.F16:return Bt.HALF_FLOAT;case pn.F32:return Bt.FLOAT;case pn.U16_PACKED_5551:return Bt.UNSIGNED_SHORT_5_5_5_1;case pn.D32F:return Ii(this.gl)?Bt.FLOAT:this.WEBGL_depth_texture?Bt.UNSIGNED_INT:Bt.UNSIGNED_BYTE;case pn.D24:return Ii(this.gl)?Bt.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Bt.UNSIGNED_SHORT:Bt.UNSIGNED_BYTE;case pn.D24S8:return Ii(this.gl)?Bt.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Bt.UNSIGNED_INT_24_8_WEBGL:Bt.UNSIGNED_BYTE;case pn.D32FS8:return Bt.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateInternalTextureFormat=function(r){switch(r){case nr.F32_R:return Bt.R32F;case nr.F32_RG:return Bt.RG32F;case nr.F32_RGB:return Bt.RGB32F;case nr.F32_RGBA:return Bt.RGBA32F;case nr.F16_R:return Bt.R16F;case nr.F16_RG:return Bt.RG16F;case nr.F16_RGB:return Bt.RGB16F;case nr.F16_RGBA:return Bt.RGBA16F}return this.translateTextureFormat(r)},e.prototype.translateTextureFormat=function(r){if(Ng(r)||r===nr.F32_LUMINANCE||r===nr.U8_LUMINANCE)return this.translateTextureInternalFormat(r);var n=Ii(this.gl)||!Ii(this.gl)&&!!this.WEBGL_depth_texture;switch(r){case nr.D24_S8:case nr.D32F_S8:return n?Bt.DEPTH_STENCIL:Bt.RGBA;case nr.D24:case nr.D32F:return n?Bt.DEPTH_COMPONENT:Bt.RGBA}var i=Ug(r),a=Gv(r);switch(a){case Ti.A:return Bt.ALPHA;case Ti.R:return i?Bt.RED_INTEGER:Bt.RED;case Ti.RG:return i?Bt.RG_INTEGER:Bt.RG;case Ti.RGB:return i?Bt.RGB_INTEGER:Bt.RGB;case Ti.RGBA:return Bt.RGBA}},e.prototype.setActiveTexture=function(r){this.currentActiveTexture!==r&&(this.gl.activeTexture(r),this.currentActiveTexture=r)},e.prototype.bindVAO=function(r){this.currentBoundVAO!==r&&(Ii(this.gl)?this.gl.bindVertexArray(r):this.OES_vertex_array_object.bindVertexArrayOES(r),this.currentBoundVAO=r)},e.prototype.programCompiled=function(r){xa(r.compileState!==Rc.NeedsCompile),r.compileState===Rc.Compiling&&(r.compileState=Rc.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(r))},e.prototype.useProgram=function(r){this.currentProgram!==r&&(this.programCompiled(r),this.gl.useProgram(r.gl_program),this.currentProgram=r)},e.prototype.ensureResourceExists=function(r){if(r===null){var n=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(n))}else return r},e.prototype.createBuffer=function(r){return new Wx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTexture=function(r){return new zm({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createSampler=function(r){return new tb({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTarget=function(r){return new Xx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTargetFromTexture=function(r){var n=r,i=n.format,a=n.width,s=n.height,c=n.mipLevelCount;return xa(c===1),this.createRenderTarget({format:i,width:a,height:s,sampleCount:1,texture:r})},e.prototype.createProgram=function(r){var n,i,a,s=(n=r.vertex)===null||n===void 0?void 0:n.glsl;return!((i=r.vertex)===null||i===void 0)&&i.glsl&&(r.vertex.glsl=qh(this.queryVendorInfo(),"vert",r.vertex.glsl)),!((a=r.fragment)===null||a===void 0)&&a.glsl&&(r.fragment.glsl=qh(this.queryVendorInfo(),"frag",r.fragment.glsl)),this.createProgramSimple(r,s)},e.prototype.createProgramSimple=function(r,n){var i=new Yx({id:this.getNextUniqueId(),device:this,descriptor:r},n);return i},e.prototype.createBindings=function(r){return new Fx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createInputLayout=function(r){return new Gx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderPipeline=function(r){return new Qx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createComputePass=function(){return new rb},e.prototype.createComputePipeline=function(r){return new Jx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createReadback=function(){return new qx({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(r,n){return new Kx({id:this.getNextUniqueId(),device:this,descriptor:{type:r,elemCount:n}})},e.prototype.formatRenderPassDescriptor=function(r){var n,i,a,s,c,d,g=r.colorAttachment;r.depthClearValue=(n=r.depthClearValue)!==null&&n!==void 0?n:"load",r.stencilClearValue=(i=r.stencilClearValue)!==null&&i!==void 0?i:"load";for(var _=0;_<g.length;_++)r.colorAttachmentLevel||(r.colorAttachmentLevel=[]),r.colorAttachmentLevel[_]=(a=r.colorAttachmentLevel[_])!==null&&a!==void 0?a:0,r.colorResolveToLevel||(r.colorResolveToLevel=[]),r.colorResolveToLevel[_]=(s=r.colorResolveToLevel[_])!==null&&s!==void 0?s:0,r.colorClearColor||(r.colorClearColor=[]),r.colorClearColor[_]=(c=r.colorClearColor[_])!==null&&c!==void 0?c:"load",r.colorStore||(r.colorStore=[]),r.colorStore[_]=(d=r.colorStore[_])!==null&&d!==void 0?d:!1},e.prototype.createRenderBundle=function(){return new nb({id:this.getNextUniqueId(),device:this})},e.prototype.beginBundle=function(r){this.renderBundle=r},e.prototype.endBundle=function(){this.renderBundle=void 0},e.prototype.executeBundles=function(r){r.forEach(function(n){n.replay()})},e.prototype.createRenderPass=function(r){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=r,this.formatRenderPassDescriptor(r);var n=r.colorAttachment,i=r.colorAttachmentLevel,a=r.colorClearColor,s=r.colorResolveTo,c=r.colorResolveToLevel,d=r.depthStencilAttachment,g=r.depthClearValue,_=r.stencilClearValue,A=r.depthStencilResolveTo;this.setRenderPassParametersBegin(n.length);for(var C=0;C<n.length;C++)this.setRenderPassParametersColor(C,n[C],i[C],s[C],c[C]);this.setRenderPassParametersDepthStencil(d,A),this.validateCurrentAttachments();for(var C=0;C<n.length;C++){var N=a[C];N!=="load"&&this.setRenderPassParametersClearColor(C,N.r,N.g,N.b,N.a)}return this.setRenderPassParametersClearDepthStencil(g,_),this},e.prototype.submitPass=function(r){xa(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(r,n,i,a,s,c){var d=this.gl,g=r,_=a;if(xa(_.mipLevelCount===1),xa(g.mipLevelCount===1),Ii(d))g===this.scTexture?d.bindFramebuffer(d.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(d.bindFramebuffer(d.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(d.DRAW_FRAMEBUFFER,d.COLOR_ATTACHMENT0,g,0)),d.bindFramebuffer(d.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(d.READ_FRAMEBUFFER,d.COLOR_ATTACHMENT0,_,0),d.blitFramebuffer(s,c,s+_.width,c+_.height,n,i,n+_.width,i+_.height,d.COLOR_BUFFER_BIT,d.LINEAR),d.bindFramebuffer(d.READ_FRAMEBUFFER,null),d.bindFramebuffer(d.DRAW_FRAMEBUFFER,null);else if(g===this.scTexture){var A=this.createRenderTargetFromTexture(a);this.submitBlitRenderPass(A,g)}},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(r,n,i){switch(r){case nr.BC1_SRGB:case nr.BC2_SRGB:case nr.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?Um(n,i,4,4):!1;case nr.BC1:case nr.BC2:case nr.BC3:return this.WEBGL_compressed_texture_s3tc!==null?Um(n,i,4,4):!1;case nr.BC4_UNORM:case nr.BC4_SNORM:case nr.BC5_UNORM:case nr.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?Um(n,i,4,4):!1;case nr.U16_R_NORM:case nr.U16_RG_NORM:case nr.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case nr.F32_R:case nr.F32_RG:case nr.F32_RGB:case nr.F32_RGBA:return this.OES_texture_float_linear!==null;case nr.F16_R:case nr.F16_RG:case nr.F16_RGB:case nr.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},e.prototype.queryProgramReady=function(r){var n=this.gl;if(r.compileState===Rc.NeedsCompile)throw new Error("whoops");if(r.compileState===Rc.Compiling){var i=void 0;return this.KHR_parallel_shader_compile!==null?i=n.getProgramParameter(r.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):i=!0,i&&this.programCompiled(r),i}return r.compileState===Rc.NeedsBind||r.compileState===Rc.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(r){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(r){var n=r;return n},e.prototype.setResourceName=function(r,n){if(r.name=n,r.type===po.Buffer)for(var i=r.gl_buffer_pages,a=0;a<i.length;a++)av(i[a],"".concat(n," Page ").concat(a));else if(r.type===po.Texture)av(ld(r),n);else if(r.type===po.Sampler)av(Nm(r),n);else if(r.type===po.RenderTarget){var s=r.gl_renderbuffer;s!==null&&av(s,n)}else r.type===po.InputLayout&&av(r.vao,n)},e.prototype.setResourceLeakCheck=function(r,n){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(r,n)},e.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(r){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(r){},e.prototype.programPatched=function(r,n){xa(this.shaderDebug)},e.prototype.getBufferData=function(r,n,i){i===void 0&&(i=0);var a=this.gl;Ii(a)&&(a.bindBuffer(a.COPY_READ_BUFFER,ud(r,i*4)),a.getBufferSubData(a.COPY_READ_BUFFER,i*4,n))},e.prototype.debugGroupStatisticsDrawCall=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].drawCallCount+=r},e.prototype.debugGroupStatisticsBufferUpload=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].bufferUploadCount+=r},e.prototype.debugGroupStatisticsTextureBind=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].textureBindCount+=r},e.prototype.debugGroupStatisticsTriangles=function(r){for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].triangleCount+=r},e.prototype.reportShaderError=function(r,n){var i=this.gl,a=i.getShaderParameter(r,i.COMPILE_STATUS);if(!a){console.error(ix(n));var s=i.getExtension("WEBGL_debug_shaders");s&&console.error(s.getTranslatedShaderSource(r)),console.error(i.getShaderInfoLog(r))}return a},e.prototype.checkProgramCompilationForErrors=function(r){var n=this.gl,i=r.gl_program;if(!n.getProgramParameter(i,n.LINK_STATUS)){var a=r.descriptor;if(!this.reportShaderError(r.gl_shader_vert,a.vertex.glsl)||!this.reportShaderError(r.gl_shader_frag,a.fragment.glsl))return;console.error(n.getProgramInfoLog(r.gl_program))}},e.prototype.bindFramebufferAttachment=function(r,n,i,a){var s=this.gl;if((0,yf.Z)(i))s.framebufferRenderbuffer(r,n,s.RENDERBUFFER,null);else if(i.type===po.RenderTarget)i.gl_renderbuffer!==null?s.framebufferRenderbuffer(r,n,s.RENDERBUFFER,i.gl_renderbuffer):i.texture!==null&&s.framebufferTexture2D(r,n,Bt.TEXTURE_2D,ld(i.texture),a);else if(i.type===po.Texture){var c=ld(i);i.dimension===za.TEXTURE_2D?s.framebufferTexture2D(r,n,Bt.TEXTURE_2D,c,a):Ii(s)&&(i.dimension,za.TEXTURE_2D_ARRAY)}},e.prototype.bindFramebufferDepthStencilAttachment=function(r,n){var i=this.gl,a=(0,yf.Z)(n)?li.Depth|li.Stencil:nd(n.format),s=!!(a&li.Depth),c=!!(a&li.Stencil);if(s&&c){var d=Ii(this.gl)||!Ii(this.gl)&&!!this.WEBGL_depth_texture;d?this.bindFramebufferAttachment(r,i.DEPTH_STENCIL_ATTACHMENT,n,0):this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,n,0)}else s?(this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,n,0),this.bindFramebufferAttachment(r,i.STENCIL_ATTACHMENT,null,0)):c&&(this.bindFramebufferAttachment(r,i.STENCIL_ATTACHMENT,n,0),this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,null,0))},e.prototype.validateCurrentAttachments=function(){for(var r=-1,n=-1,i=-1,a=0;a<this.currentColorAttachments.length;a++){var s=this.currentColorAttachments[a];s!==null&&(r===-1?(r=s.sampleCount,n=s.width,i=s.height):(xa(r===s.sampleCount),xa(n===s.width),xa(i===s.height)))}this.currentDepthStencilAttachment&&(r===-1?r=this.currentDepthStencilAttachment.sampleCount:(xa(r===this.currentDepthStencilAttachment.sampleCount),xa(n===this.currentDepthStencilAttachment.width),xa(i===this.currentDepthStencilAttachment.height))),this.currentSampleCount=r},e.prototype.setRenderPassParametersBegin=function(r){var n=this.gl;if(Ii(n)?n.bindFramebuffer(Bt.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||n.bindFramebuffer(Bt.FRAMEBUFFER,this.renderPassDrawFramebuffer),Ii(n)?n.drawBuffers([Bt.COLOR_ATTACHMENT0,Bt.COLOR_ATTACHMENT1,Bt.COLOR_ATTACHMENT2,Bt.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([Bt.COLOR_ATTACHMENT0_WEBGL,Bt.COLOR_ATTACHMENT1_WEBGL,Bt.COLOR_ATTACHMENT2_WEBGL,Bt.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var i=r;i<this.currentColorAttachments.length;i++){var a=Ii(n)?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,s=Ii(n)?Bt.COLOR_ATTACHMENT0:Bt.COLOR_ATTACHMENT0_WEBGL;n.framebufferRenderbuffer(a,s+i,Bt.RENDERBUFFER,null),n.framebufferTexture2D(a,s+i,Bt.TEXTURE_2D,null,0)}this.currentColorAttachments.length=r},e.prototype.setRenderPassParametersColor=function(r,n,i,a,s){var c=this.gl,d=Ii(c);(this.currentColorAttachments[r]!==n||this.currentColorAttachmentLevels[r]!==i)&&(this.currentColorAttachments[r]=n,this.currentColorAttachmentLevels[r]=i,(d||!d&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(d?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,(d?Bt.COLOR_ATTACHMENT0:Bt.COLOR_ATTACHMENT0_WEBGL)+r,n,i),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[r]!==a||this.currentColorResolveToLevels[r]!==s)&&(this.currentColorResolveTos[r]=a,this.currentColorResolveToLevels[r]=s,a!==null&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(r,n){var i=this.gl;this.currentDepthStencilAttachment!==r&&(this.currentDepthStencilAttachment=r,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(Ii(i)?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==n&&(this.currentDepthStencilResolveTo=n,n&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(r,n,i,a,s){var c=this.gl;if(this.OES_draw_buffers_indexed!==null){var d=this.currentMegaState.attachmentsState[r];d&&d.channelWriteMask!==rl.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(r,!0,!0,!0,!0),d.channelWriteMask=rl.ALL)}else{var d=this.currentMegaState.attachmentsState[0];d&&d.channelWriteMask!==rl.ALL&&(c.colorMask(!0,!0,!0,!0),d.channelWriteMask=rl.ALL)}this.setScissorRectEnabled(!1),Ii(c)?c.clearBufferfv(c.COLOR,r,[n,i,a,s]):(c.clearColor(n,i,a,s),c.clear(c.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(r,n){r===void 0&&(r="load"),n===void 0&&(n="load");var i=this.gl;r!=="load"&&(xa(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(i.depthMask(!0),this.currentMegaState.depthWrite=!0),Ii(i)?i.clearBufferfv(i.DEPTH,0,[r]):(i.clearDepth(r),i.clear(i.DEPTH_BUFFER_BIT))),n!=="load"&&(xa(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(i.enable(i.STENCIL_TEST),i.stencilMask(255),this.currentMegaState.stencilWrite=!0),Ii(i)?i.clearBufferiv(i.STENCIL,0,[n]):(i.clearStencil(n),i.clear(i.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(r){var n=this,i;if(this.renderBundle){this.renderBundle.push(function(){return n.setBindings(r)});return}var a=this.gl,s=r,c=s.uniformBufferBindings,d=s.samplerBindings,g=s.bindingLayouts;xa(0<g.bindingLayoutTables.length);var _=g.bindingLayoutTables[0];xa(c.length>=_.numUniformBuffers),xa(d.length>=_.numSamplers);for(var A=0;A<c.length;A++){var C=c[A];if(C.size!==0){var N=_.firstUniformBuffer+A,ae=C.buffer,we=C.offset||0,De=C.size||ae.byteSize;if(ae!==this.currentUniformBuffers[N]||we!==this.currentUniformBufferByteOffsets[N]||De!==this.currentUniformBufferByteSizes[N]){var at=we%ae.pageByteSize,Ot=ae.gl_buffer_pages[we/ae.pageByteSize|0];xa(at+De<=ae.pageByteSize),Ii(a)&&a.bindBufferRange(a.UNIFORM_BUFFER,N,Ot,at,De),this.currentUniformBuffers[N]=ae,this.currentUniformBufferByteOffsets[N]=we,this.currentUniformBufferByteSizes[N]=De}}}for(var A=0;A<_.numSamplers;A++){var C=d[A],Pt=_.firstSampler+A,Kt=C!==null&&C.sampler!==null?Nm(C.sampler):null,hr=C!==null&&C.texture!==null?ld(C.texture):null;if(this.currentSamplers[Pt]!==Kt&&(Ii(a)&&a.bindSampler(Pt,Kt),this.currentSamplers[Pt]=Kt),this.currentTextures[Pt]!==hr){if(this.setActiveTexture(a.TEXTURE0+Pt),hr!==null){var jr=Rp(C).texture,pr=jr.gl_target,rr=jr.width,Ur=jr.height;C.texture.textureIndex=Pt,a.bindTexture(pr,hr),Ii(a)||(i=C.sampler)===null||i===void 0||i.setTextureParameters(pr,rr,Ur),this.debugGroupStatisticsTextureBind()}else{var $n=(0,yi.pi)((0,yi.pi)({},C),Mg),Ai=$n.dimension,Wn=$n.formatKind,pr=Hx(Ai);a.bindTexture(pr,this.getFallbackTexture((0,yi.pi)({gl_target:pr,formatKind:Wn},$n)))}this.currentTextures[Pt]=hr}}},e.prototype.setViewport=function(r,n,i,a){var s=this.gl;s.viewport(r,n,i,a)},e.prototype.setScissorRect=function(r,n,i,a){var s=this.gl;this.setScissorRectEnabled(!0),s.scissor(r,n,i,a)},e.prototype.applyAttachmentStateIndexed=function(r,n,i){var a=this.gl,s=this.OES_draw_buffers_indexed;n.channelWriteMask!==i.channelWriteMask&&(s.colorMaskiOES(r,!!(i.channelWriteMask&rl.RED),!!(i.channelWriteMask&rl.GREEN),!!(i.channelWriteMask&rl.BLUE),!!(i.channelWriteMask&rl.ALPHA)),n.channelWriteMask=i.channelWriteMask);var c=n.rgbBlendState.blendMode!==i.rgbBlendState.blendMode||n.alphaBlendState.blendMode!==i.alphaBlendState.blendMode,d=n.rgbBlendState.blendSrcFactor!==i.rgbBlendState.blendSrcFactor||n.alphaBlendState.blendSrcFactor!==i.alphaBlendState.blendSrcFactor||n.rgbBlendState.blendDstFactor!==i.rgbBlendState.blendDstFactor||n.alphaBlendState.blendDstFactor!==i.alphaBlendState.blendDstFactor;(d||c)&&(Qh(n.rgbBlendState)&&Qh(n.alphaBlendState)?s.enableiOES(r,a.BLEND):Qh(i.rgbBlendState)&&Qh(i.alphaBlendState)&&s.disableiOES(r,a.BLEND)),c&&(s.blendEquationSeparateiOES(r,i.rgbBlendState.blendMode,i.alphaBlendState.blendMode),n.rgbBlendState.blendMode=i.rgbBlendState.blendMode,n.alphaBlendState.blendMode=i.alphaBlendState.blendMode),d&&(s.blendFuncSeparateiOES(r,i.rgbBlendState.blendSrcFactor,i.rgbBlendState.blendDstFactor,i.alphaBlendState.blendSrcFactor,i.alphaBlendState.blendDstFactor),n.rgbBlendState.blendSrcFactor=i.rgbBlendState.blendSrcFactor,n.alphaBlendState.blendSrcFactor=i.alphaBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor=i.rgbBlendState.blendDstFactor,n.alphaBlendState.blendDstFactor=i.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(r,n){var i=this.gl;r.channelWriteMask!==n.channelWriteMask&&(i.colorMask(!!(n.channelWriteMask&rl.RED),!!(n.channelWriteMask&rl.GREEN),!!(n.channelWriteMask&rl.BLUE),!!(n.channelWriteMask&rl.ALPHA)),r.channelWriteMask=n.channelWriteMask);var a=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,s=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(s||a)&&(Qh(r.rgbBlendState)&&Qh(r.alphaBlendState)?i.enable(i.BLEND):Qh(n.rgbBlendState)&&Qh(n.alphaBlendState)&&i.disable(i.BLEND)),a&&(i.blendEquationSeparate(n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),s&&(i.blendFuncSeparate(n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(r){var n=this.gl,i=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var a=0;a<r.attachmentsState.length;a++)this.applyAttachmentStateIndexed(a,i.attachmentsState[0],r.attachmentsState[0]);else xa(r.attachmentsState.length===1),this.applyAttachmentState(i.attachmentsState[0],r.attachmentsState[0]);if(Sg(i.blendConstant,r.blendConstant)||(n.blendColor(r.blendConstant.r,r.blendConstant.g,r.blendConstant.b,r.blendConstant.a),Tg(i.blendConstant,r.blendConstant)),i.depthCompare!==r.depthCompare&&(n.depthFunc(r.depthCompare),i.depthCompare=r.depthCompare),!!i.depthWrite!=!!r.depthWrite&&(n.depthMask(r.depthWrite),i.depthWrite=r.depthWrite),!!i.stencilWrite!=!!r.stencilWrite&&(n.stencilMask(r.stencilWrite?255:0),i.stencilWrite=r.stencilWrite),!Qv(i.stencilFront,r.stencilFront)){var s=r.stencilFront,c=s.passOp,d=s.failOp,g=s.depthFailOp,_=s.compare;(i.stencilFront.passOp!==c||i.stencilFront.failOp!==d||i.stencilFront.depthFailOp!==g)&&(n.stencilOpSeparate(n.FRONT,d,g,c),i.stencilFront.passOp=c,i.stencilFront.failOp=d,i.stencilFront.depthFailOp=g),i.stencilFront.compare!==_&&(this.setStencilReference(0),i.stencilFront.compare=_)}if(!Qv(i.stencilBack,r.stencilBack)){var A=r.stencilBack,c=A.passOp,d=A.failOp,g=A.depthFailOp,_=A.compare;(i.stencilBack.passOp!==c||i.stencilBack.failOp!==d||i.stencilBack.depthFailOp!==g)&&(n.stencilOpSeparate(n.BACK,d,g,c),i.stencilBack.passOp=c,i.stencilBack.failOp=d,i.stencilBack.depthFailOp=g),i.stencilBack.compare!==_&&(this.setStencilReference(0),i.stencilBack.compare=_)}(i.stencilFront.mask!==r.stencilFront.mask||i.stencilBack.mask!==r.stencilBack.mask)&&(i.stencilFront.mask=r.stencilFront.mask,i.stencilBack.mask=r.stencilBack.mask,this.applyStencil()),i.cullMode!==r.cullMode&&(i.cullMode===wc.NONE?n.enable(n.CULL_FACE):r.cullMode===wc.NONE&&n.disable(n.CULL_FACE),r.cullMode===wc.BACK?n.cullFace(n.BACK):r.cullMode===wc.FRONT?n.cullFace(n.FRONT):r.cullMode===wc.FRONT_AND_BACK&&n.cullFace(n.FRONT_AND_BACK),i.cullMode=r.cullMode),i.frontFace!==r.frontFace&&(n.frontFace(r.frontFace),i.frontFace=r.frontFace),i.polygonOffset!==r.polygonOffset&&(r.polygonOffset?(n.polygonOffset(1,1),n.enable(n.POLYGON_OFFSET_FILL)):n.disable(n.POLYGON_OFFSET_FILL),i.polygonOffset=r.polygonOffset)},e.prototype.validatePipelineFormats=function(r){for(var n=0;n<this.currentColorAttachments.length;n++)var i=this.currentColorAttachments[n];this.currentDepthStencilAttachment&&xa(this.currentDepthStencilAttachment.format===r.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&xa(this.currentSampleCount===r.sampleCount)},e.prototype.setPipeline=function(r){var n=this;if(this.renderBundle){this.renderBundle.push(function(){return n.setPipeline(r)});return}this.currentPipeline=r,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var i=this.currentPipeline.program;if(this.useProgram(i),i.compileState===Rc.NeedsBind){var a=this.gl,s=i.gl_program,c=i.descriptor,d=Zg(c.vertex.glsl,ib);if(Ii(a))for(var g=0;g<d.length;g++){var _=(0,yi.CR)(d[g],2),A=_[1],C=a.getUniformBlockIndex(s,A);C!==-1&&C!==4294967295&&a.uniformBlockBinding(s,C,g)}for(var N=Zg(c.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),g=0;g<N.length;g++){var ae=(0,yi.CR)(N[g],3),we=ae[1],De=ae[2],at=a.getUniformLocation(s,we);a.uniform1i(at,parseInt(De))}i.compileState=Rc.ReadyToUse}},e.prototype.setVertexInput=function(r,n,i){var a,s,c=this,d;if(this.renderBundle){this.renderBundle.push(function(){return c.setVertexInput(r,n,i)});return}if(r!==null){xa(this.currentPipeline.inputLayout===r);var g=r;this.bindVAO(g.vao);for(var _=this.gl,A=0;A<g.vertexBufferDescriptors.length;A++){var C=g.vertexBufferDescriptors[A],N=C.arrayStride,ae=C.attributes;try{for(var we=(a=void 0,(0,yi.XA)(ae)),De=we.next();!De.done;De=we.next()){var at=De.value,Ot=at.shaderLocation,Pt=at.offset,Kt=Ii(_)?Ot:(d=g.program.attributes[Ot])===null||d===void 0?void 0:d.location;if(!(0,yf.Z)(Kt)){var hr=n[A];if(hr===null)continue;var jr=at.vertexFormat;_.bindBuffer(_.ARRAY_BUFFER,ud(hr.buffer));var pr=(hr.offset||0)+Pt;_.vertexAttribPointer(Kt,jr.size,jr.type,jr.normalized,N,pr)}}}catch(Ur){a={error:Ur}}finally{try{De&&!De.done&&(s=we.return)&&s.call(we)}finally{if(a)throw a.error}}}if(xa(i!==null==(g.indexBufferFormat!==null)),i!==null){var rr=i.buffer;xa(rr.usage===$o.INDEX),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,ud(rr)),this.currentIndexBufferByteOffset=i.offset||0}else this.currentIndexBufferByteOffset=null}else xa(this.currentPipeline.inputLayout===null),xa(i===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},e.prototype.setStencilReference=function(r){this.currentStencilRef!==r&&(this.currentStencilRef=r,this.applyStencil())},e.prototype.draw=function(r,n,i,a){var s,c=this;if(this.renderBundle){this.renderBundle.push(function(){return c.draw(r,n,i,a)});return}var d=this.gl,g=this.currentPipeline;if(n){var _=[g.drawMode,i||0,r,n];Ii(d)?d.drawArraysInstanced.apply(d,(0,yi.ev)([],(0,yi.CR)(_),!1)):(s=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(s,(0,yi.ev)([],(0,yi.CR)(_),!1))}else d.drawArrays(g.drawMode,i,r);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(r/3*Math.max(n,1))},e.prototype.drawIndexed=function(r,n,i,a,s){var c,d=this;if(this.renderBundle){this.renderBundle.push(function(){return d.drawIndexed(r,n,i,a,s)});return}var g=this.gl,_=this.currentPipeline,A=Rp(_.inputLayout),C=Rp(this.currentIndexBufferByteOffset)+i*A.indexBufferCompByteSize;if(n){var N=[_.drawMode,r,A.indexBufferType,C,n];Ii(g)?g.drawElementsInstanced.apply(g,(0,yi.ev)([],(0,yi.CR)(N),!1)):(c=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(c,(0,yi.ev)([],(0,yi.CR)(N),!1))}else g.drawElements(_.drawMode,r,A.indexBufferType,C);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(r/3*Math.max(n,1))},e.prototype.drawIndirect=function(r,n){},e.prototype.drawIndexedIndirect=function(r,n){},e.prototype.beginOcclusionQuery=function(r){var n=this.gl;if(Ii(n)){var i=this.currentRenderPassDescriptor.occlusionQueryPool;n.beginQuery(i.gl_query_type,i.gl_query[r])}},e.prototype.endOcclusionQuery=function(){var r=this.gl;if(Ii(r)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;r.endQuery(n.gl_query_type)}},e.prototype.pipelineQueryReady=function(r){var n=r;return this.queryProgramReady(n.program)},e.prototype.pipelineForceReady=function(r){},e.prototype.endPass=function(){for(var r=this.gl,n=Ii(r),i=!1,a=0;a<this.currentColorAttachments.length;a++){var s=this.currentColorAttachments[a];if(s!==null){var c=this.currentColorResolveTos[a],d=!1;c!==null&&(xa(s.width===c.width&&s.height===c.height),this.setScissorRectEnabled(!1),n&&r.bindFramebuffer(r.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&n&&this.bindFramebufferAttachment(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a]),d=!0,c===this.scTexture?r.bindFramebuffer(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,this.scPlatformFramebuffer):(r.bindFramebuffer(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&r.framebufferTexture2D(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c.gl_texture,this.currentColorResolveToLevels[a])),n?(r.blitFramebuffer(0,0,s.width,s.height,0,0,c.width,c.height,r.COLOR_BUFFER_BIT,r.LINEAR),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(s,c),i=!0),this.currentRenderPassDescriptor.colorStore[a]||d||(r.bindFramebuffer(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,r.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a])),r.bindFramebuffer(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var g=this.currentDepthStencilAttachment;if(g){var _=this.currentDepthStencilResolveTo,d=!1;_&&(xa(g.width===_.width&&g.height===_.height),this.setScissorRectEnabled(!1),r.bindFramebuffer(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),r.bindFramebuffer(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,g),this.bindFramebufferDepthStencilAttachment(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,_)),d=!0,n&&r.blitFramebuffer(0,0,g.width,g.height,0,0,_.width,_.height,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,null),i=!0),this.currentRenderPassDescriptor.depthStencilStore||(d||(r.bindFramebuffer(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,g),d=!0),n&&r.invalidateFramebuffer(r.READ_FRAMEBUFFER,[r.DEPTH_STENCIL_ATTACHMENT])),d&&r.bindFramebuffer(n?Bt.READ_FRAMEBUFFER:Bt.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}i||r.bindFramebuffer(n?Bt.DRAW_FRAMEBUFFER:Bt.FRAMEBUFFER,null)},e.prototype.setScissorRectEnabled=function(r){if(this.currentScissorEnabled!==r){var n=this.gl;r?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST),this.currentScissorEnabled=r}},e.prototype.applyStencil=function(){(0,yf.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(Bt.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(Bt.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},e.prototype.getFallbackTexture=function(r){var n=r.gl_target,i=r.formatKind;if(n===Bt.TEXTURE_2D)return i===Fs.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(n===Bt.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(n===Bt.TEXTURE_3D)return this.fallbackTexture3D;if(n===Bt.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(r,n){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:$o.VERTEX|$o.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:wp.VERTEX,attributes:[{format:nr.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:su.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[nr.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:od(Mp)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:r.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:r}));var i=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var a=this.createRenderPass({colorAttachment:[r],colorResolveTo:[n],colorClearColor:[J1]}),s=this.getCanvas(),c=s.width,d=s.height;a.setPipeline(this.blitRenderPipeline),a.setBindings(this.blitBindings),a.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),a.setViewport(0,0,c,d),this.gl.disable(this.gl.BLEND),a.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=i,this.inBlitRenderPass=!1},e}(),ob=function(){function e(r){this.pluginOptions=r}return e.prototype.createSwapChain=function(r){return(0,yi.mG)(this,void 0,void 0,function(){var n,i,a,s,c,d,g,_,A,C,N,ae,we;return(0,yi.Jh)(this,function(De){return n=this.pluginOptions,i=n.targets,a=n.xrCompatible,s=n.antialias,c=s===void 0?!1:s,d=n.preserveDrawingBuffer,g=d===void 0?!1:d,_=n.premultipliedAlpha,A=_===void 0?!0:_,C=n.shaderDebug,N=n.trackResources,ae={antialias:c,preserveDrawingBuffer:g,stencil:!0,premultipliedAlpha:A,xrCompatible:a},this.handleContextEvents(r),i.includes("webgl2")&&(we=r.getContext("webgl2",ae)||r.getContext("experimental-webgl2",ae)),!we&&i.includes("webgl1")&&(we=r.getContext("webgl",ae)||r.getContext("experimental-webgl",ae)),[2,new ab(we,{shaderDebug:C,trackResources:N})]})})},e.prototype.handleContextEvents=function(r){var n=this.pluginOptions,i=n.onContextLost,a=n.onContextRestored,s=n.onContextCreationError;s&&r.addEventListener("webglcontextcreationerror",s,!1),i&&r.addEventListener("webglcontextlost",i,!1),a&&r.addEventListener("webglcontextrestored",a,!1)},e}();let uu;const jg=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&jg.decode();let ov=null;function tm(){return(ov===null||ov.byteLength===0)&&(ov=new Uint8Array(uu.memory.buffer)),ov}function rm(e,r){return e=e>>>0,jg.decode(tm().subarray(e,e+r))}const Mh=new Array(128).fill(void 0);Mh.push(void 0,null,!0,!1);let sv=Mh.length;function sb(e){sv===Mh.length&&Mh.push(Mh.length+1);const r=sv;return sv=Mh[r],Mh[r]=e,r}function nm(e){return Mh[e]}function ub(e){e<132||(Mh[e]=sv,sv=e)}function lb(e){const r=nm(e);return ub(e),r}let uv=0;const im=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},cb=typeof im.encodeInto=="function"?function(e,r){return im.encodeInto(e,r)}:function(e,r){const n=im.encode(e);return r.set(n),{read:e.length,written:n.length}};function Zm(e,r,n){if(n===void 0){const d=im.encode(e),g=r(d.length,1)>>>0;return tm().subarray(g,g+d.length).set(d),uv=d.length,g}let i=e.length,a=r(i,1)>>>0;const s=tm();let c=0;for(;c<i;c++){const d=e.charCodeAt(c);if(d>127)break;s[a+c]=d}if(c!==i){c!==0&&(e=e.slice(c)),a=n(a,i,i=c+e.length*3,1)>>>0;const d=tm().subarray(a+c,a+i),g=cb(e,d);c+=g.written}return uv=c,a}let lv=null;function am(){return(lv===null||lv.byteLength===0)&&(lv=new Int32Array(uu.memory.buffer)),lv}function fb(e,r,n){let i,a;try{const d=uu.__wbindgen_add_to_stack_pointer(-16),g=Zm(e,uu.__wbindgen_malloc,uu.__wbindgen_realloc),_=uv,A=Zm(r,uu.__wbindgen_malloc,uu.__wbindgen_realloc),C=uv;uu.glsl_compile(d,g,_,A,C,n);var s=am()[d/4+0],c=am()[d/4+1];return i=s,a=c,rm(s,c)}finally{uu.__wbindgen_add_to_stack_pointer(16),uu.__wbindgen_free(i,a,1)}}class cv{static __wrap(r){r=r>>>0;const n=Object.create(cv.prototype);return n.__wbg_ptr=r,n}__destroy_into_raw(){const r=this.__wbg_ptr;return this.__wbg_ptr=0,r}free(){const r=this.__destroy_into_raw();uu.__wbg_wgslcomposer_free(r)}constructor(){const r=uu.wgslcomposer_new();return cv.__wrap(r)}wgsl_compile(r){let n,i;try{const c=uu.__wbindgen_add_to_stack_pointer(-16),d=Zm(r,uu.__wbindgen_malloc,uu.__wbindgen_realloc),g=uv;uu.wgslcomposer_wgsl_compile(c,this.__wbg_ptr,d,g);var a=am()[c/4+0],s=am()[c/4+1];return n=a,i=s,rm(a,s)}finally{uu.__wbindgen_add_to_stack_pointer(16),uu.__wbindgen_free(n,i,1)}}}function hb(e,r){return Gm(this,null,function*(){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(e,r)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const n=yield e.arrayBuffer();return yield WebAssembly.instantiate(n,r)}else{const n=yield WebAssembly.instantiate(e,r);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}})}function pb(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(r,n){const i=rm(r,n);return sb(i)},e.wbg.__wbindgen_object_drop_ref=function(r){lb(r)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(r){console.log(nm(r))},e.wbg.__wbg_log_576ca876af0d4a77=function(r,n){console.log(nm(r),nm(n))},e.wbg.__wbindgen_throw=function(r,n){throw new Error(rm(r,n))},e}function db(e,r){return uu=e.exports,$g.__wbindgen_wasm_module=r,lv=null,ov=null,uu}function $g(e){return Gm(this,null,function*(){if(uu!==void 0)return uu;const r=pb();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=yield hb(yield e,r);return db(n,i)})}var Fu;(function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Fu||(Fu={}));var Vm;(function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"})(Vm||(Vm={}));function vb(e){var r=0;return e&wl.SAMPLED&&(r|=Fu.TEXTURE_BINDING|Fu.COPY_DST|Fu.COPY_SRC),e&wl.STORAGE&&(r|=Fu.TEXTURE_BINDING|Fu.STORAGE_BINDING|Fu.COPY_SRC|Fu.COPY_DST),e&wl.RENDER_TARGET&&(r|=Fu.RENDER_ATTACHMENT|Fu.TEXTURE_BINDING|Fu.COPY_SRC|Fu.COPY_DST),r}function jm(e){if(e===nr.U8_R_NORM)return"r8unorm";if(e===nr.S8_R_NORM)return"r8snorm";if(e===nr.U8_RG_NORM)return"rg8unorm";if(e===nr.S8_RG_NORM)return"rg8snorm";if(e===nr.U32_R)return"r32uint";if(e===nr.S32_R)return"r32sint";if(e===nr.F32_R)return"r32float";if(e===nr.U16_RG)return"rg16uint";if(e===nr.S16_RG)return"rg16sint";if(e===nr.F16_RG)return"rg16float";if(e===nr.U8_RGBA_RT)return"bgra8unorm";if(e===nr.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===nr.U8_RGBA_NORM)return"rgba8unorm";if(e===nr.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===nr.S8_RGBA_NORM)return"rgba8snorm";if(e===nr.U32_RG)return"rg32uint";if(e===nr.S32_RG)return"rg32sint";if(e===nr.F32_RG)return"rg32float";if(e===nr.U16_RGBA)return"rgba16uint";if(e===nr.S16_RGBA)return"rgba16sint";if(e===nr.F16_RGBA)return"rgba16float";if(e===nr.F32_RGBA)return"rgba32float";if(e===nr.U32_RGBA)return"rgba32uint";if(e===nr.S32_RGBA)return"rgba32sint";if(e===nr.D24)return"depth24plus";if(e===nr.D24_S8)return"depth24plus-stencil8";if(e===nr.D32F)return"depth32float";if(e===nr.D32F_S8)return"depth32float-stencil8";if(e===nr.BC1)return"bc1-rgba-unorm";if(e===nr.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===nr.BC2)return"bc2-rgba-unorm";if(e===nr.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===nr.BC3)return"bc3-rgba-unorm";if(e===nr.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===nr.BC4_SNORM)return"bc4-r-snorm";if(e===nr.BC4_UNORM)return"bc4-r-unorm";if(e===nr.BC5_SNORM)return"bc5-rg-snorm";if(e===nr.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function mb(e){if(e===za.TEXTURE_2D)return"2d";if(e===za.TEXTURE_CUBE_MAP)return"2d";if(e===za.TEXTURE_2D_ARRAY)return"2d";if(e===za.TEXTURE_3D)return"3d";throw new Error("whoops")}function gb(e){if(e===za.TEXTURE_2D)return"2d";if(e===za.TEXTURE_CUBE_MAP)return"cube";if(e===za.TEXTURE_2D_ARRAY)return"2d-array";if(e===za.TEXTURE_3D)return"3d";throw new Error("whoops")}function yb(e){var r=0;return e&$o.INDEX&&(r|=GPUBufferUsage.INDEX),e&$o.VERTEX&&(r|=GPUBufferUsage.VERTEX),e&$o.UNIFORM&&(r|=GPUBufferUsage.UNIFORM),e&$o.STORAGE&&(r|=GPUBufferUsage.STORAGE),e&$o.COPY_SRC&&(r|=GPUBufferUsage.COPY_SRC),e&$o.INDIRECT&&(r|=GPUBufferUsage.INDIRECT),r|=GPUBufferUsage.COPY_DST,r}function $m(e){if(e===oc.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===oc.REPEAT)return"repeat";if(e===oc.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function Hg(e){if(e===$s.BILINEAR)return"linear";if(e===$s.POINT)return"nearest";throw new Error("whoops")}function _b(e){if(e===Bu.LINEAR)return"linear";if(e===Bu.NEAREST)return"nearest";if(e===Bu.NO_MIP)return"nearest";throw new Error("whoops")}function cd(e){var r=e;return r.gpuBuffer}function xb(e){var r=e;return r.gpuSampler}function bb(e){var r=e;return r.querySet}function Eb(e){if(e===Wv.OcclusionConservative)return"occlusion";throw new Error("whoops")}function Sb(e){switch(e){case su.TRIANGLES:return"triangle-list";case su.POINTS:return"point-list";case su.TRIANGLE_STRIP:return"triangle-strip";case su.LINES:return"line-list";case su.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function Tb(e){if(e===wc.NONE)return"none";if(e===wc.FRONT)return"front";if(e===wc.BACK)return"back";throw new Error("whoops")}function Ab(e){if(e===tv.CCW)return"ccw";if(e===tv.CW)return"cw";throw new Error("whoops")}function Cb(e,r){return{topology:Sb(e),cullMode:Tb(r.cullMode),frontFace:Ab(r.frontFace)}}function Wg(e){if(e===Ya.ZERO)return"zero";if(e===Ya.ONE)return"one";if(e===Ya.SRC)return"src";if(e===Ya.ONE_MINUS_SRC)return"one-minus-src";if(e===Ya.DST)return"dst";if(e===Ya.ONE_MINUS_DST)return"one-minus-dst";if(e===Ya.SRC_ALPHA)return"src-alpha";if(e===Ya.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===Ya.DST_ALPHA)return"dst-alpha";if(e===Ya.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===Ya.CONST)return"constant";if(e===Ya.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===Ya.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function wb(e){if(e===tl.ADD)return"add";if(e===tl.SUBSTRACT)return"subtract";if(e===tl.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===tl.MIN)return"min";if(e===tl.MAX)return"max";throw new Error("whoops")}function Gg(e){return{operation:wb(e.blendMode),srcFactor:Wg(e.blendSrcFactor),dstFactor:Wg(e.blendDstFactor)}}function Xg(e){return e.blendMode===tl.ADD&&e.blendSrcFactor===Ya.ONE&&e.blendDstFactor===Ya.ZERO}function Rb(e){if(!(Xg(e.rgbBlendState)&&Xg(e.alphaBlendState)))return{color:Gg(e.rgbBlendState),alpha:Gg(e.alphaBlendState)}}function Mb(e,r){return{format:jm(r),blend:Rb(e),writeMask:e.channelWriteMask}}function Ob(e,r){return r.attachmentsState.map(function(n,i){return Mb(n,e[i])})}function om(e){if(e===Fa.NEVER)return"never";if(e===Fa.LESS)return"less";if(e===Fa.EQUAL)return"equal";if(e===Fa.LEQUAL)return"less-equal";if(e===Fa.GREATER)return"greater";if(e===Fa.NOTEQUAL)return"not-equal";if(e===Fa.GEQUAL)return"greater-equal";if(e===Fa.ALWAYS)return"always";throw new Error("whoops")}function fd(e){if(e===Bs.KEEP)return"keep";if(e===Bs.REPLACE)return"replace";if(e===Bs.ZERO)return"zero";if(e===Bs.DECREMENT_CLAMP)return"decrement-clamp";if(e===Bs.DECREMENT_WRAP)return"decrement-wrap";if(e===Bs.INCREMENT_CLAMP)return"increment-clamp";if(e===Bs.INCREMENT_WRAP)return"increment-wrap";if(e===Bs.INVERT)return"invert";throw new Error("whoops")}function Ib(e,r){if(!(0,yf.Z)(e))return{format:jm(e),depthWriteEnabled:!!r.depthWrite,depthCompare:om(r.depthCompare),depthBias:r.polygonOffset?1:0,depthBiasSlopeScale:r.polygonOffset?1:0,stencilFront:{compare:om(r.stencilFront.compare),passOp:fd(r.stencilFront.passOp),failOp:fd(r.stencilFront.failOp),depthFailOp:fd(r.stencilFront.depthFailOp)},stencilBack:{compare:om(r.stencilBack.compare),passOp:fd(r.stencilBack.passOp),failOp:fd(r.stencilBack.failOp),depthFailOp:fd(r.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function Pb(e){if(e!==null){if(e===nr.U16_R)return"uint16";if(e===nr.U32_R)return"uint32";throw new Error("whoops")}}function kb(e){if(e===wp.VERTEX)return"vertex";if(e===wp.INSTANCE)return"instance";throw new Error("whoops")}function Db(e){if(e===nr.U8_R)return"uint8x2";if(e===nr.U8_RG)return"uint8x2";if(e===nr.U8_RGB)return"uint8x4";if(e===nr.U8_RGBA)return"uint8x4";if(e===nr.U8_RG_NORM)return"unorm8x2";if(e===nr.U8_RGBA_NORM)return"unorm8x4";if(e===nr.S8_RGB_NORM)return"snorm8x4";if(e===nr.S8_RGBA_NORM)return"snorm8x4";if(e===nr.U16_RG_NORM)return"unorm16x2";if(e===nr.U16_RGBA_NORM)return"unorm16x4";if(e===nr.S16_RG_NORM)return"snorm16x2";if(e===nr.S16_RGBA_NORM)return"snorm16x4";if(e===nr.S16_RG)return"uint16x2";if(e===nr.F16_RG)return"float16x2";if(e===nr.F16_RGBA)return"float16x4";if(e===nr.F32_R)return"float32";if(e===nr.F32_RG)return"float32x2";if(e===nr.F32_RGB)return"float32x3";if(e===nr.F32_RGBA)return"float32x4";throw"whoops"}function Lb(e){var r=uh(e);switch(r){case pn.BC1:case pn.BC2:case pn.BC3:case pn.BC4_SNORM:case pn.BC4_UNORM:case pn.BC5_SNORM:case pn.BC5_UNORM:return!0;default:return!1}}function Bb(e){var r=uh(e);switch(r){case pn.BC1:case pn.BC2:case pn.BC3:case pn.BC4_SNORM:case pn.BC4_UNORM:case pn.BC5_SNORM:case pn.BC5_UNORM:return 4;default:return 1}}function Yg(e,r,n,i){switch(n===void 0&&(n=!1),e){case nr.S8_R:case nr.S8_R_NORM:case nr.S8_RG_NORM:case nr.S8_RGB_NORM:case nr.S8_RGBA_NORM:{var a=r instanceof ArrayBuffer?new Int8Array(r):new Int8Array(r);return i&&a.set(new Int8Array(i)),a}case nr.U8_R:case nr.U8_R_NORM:case nr.U8_RG:case nr.U8_RG_NORM:case nr.U8_RGB:case nr.U8_RGB_NORM:case nr.U8_RGB_SRGB:case nr.U8_RGBA:case nr.U8_RGBA_NORM:case nr.U8_RGBA_SRGB:{var s=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r);return i&&s.set(new Uint8Array(i)),s}case nr.S16_R:case nr.S16_RG:case nr.S16_RG_NORM:case nr.S16_RGB_NORM:case nr.S16_RGBA:case nr.S16_RGBA_NORM:{var c=r instanceof ArrayBuffer?new Int16Array(r):new Int16Array(n?r/2:r);return i&&c.set(new Int16Array(i)),c}case nr.U16_R:case nr.U16_RGB:case nr.U16_RGBA_5551:case nr.U16_RGBA_NORM:case nr.U16_RG_NORM:case nr.U16_R_NORM:{var d=r instanceof ArrayBuffer?new Uint16Array(r):new Uint16Array(n?r/2:r);return i&&d.set(new Uint16Array(i)),d}case nr.S32_R:{var g=r instanceof ArrayBuffer?new Int32Array(r):new Int32Array(n?r/4:r);return i&&g.set(new Int32Array(i)),g}case nr.U32_R:case nr.U32_RG:{var _=r instanceof ArrayBuffer?new Uint32Array(r):new Uint32Array(n?r/4:r);return i&&_.set(new Uint32Array(i)),_}case nr.F32_R:case nr.F32_RG:case nr.F32_RGB:case nr.F32_RGBA:{var A=r instanceof ArrayBuffer?new Float32Array(r):new Float32Array(n?r/4:r);return i&&A.set(new Float32Array(i)),A}}var C=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r);return i&&C.set(new Uint8Array(i)),C}function Fb(e){var r=(e&32768)>>15,n=(e&31744)>>10,i=e&1023;return n===0?(r?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):n==31?i?NaN:(r?-1:1)*(1/0):(r?-1:1)*Math.pow(2,n-15)*(1+i/Math.pow(2,10))}function Kg(e){switch(e){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var Vf=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this)||this;return s.id=i,s.device=a,s}return r.prototype.destroy=function(){},r}(yg),Nb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,d,g=e.call(this,{id:i,device:a})||this;g.type=po.Bindings;var _=s.pipeline;xa(!!_);var A=s.uniformBufferBindings,C=s.storageBufferBindings,N=s.samplerBindings,ae=s.storageTextureBindings;g.numUniformBuffers=(A==null?void 0:A.length)||0;var we=[[],[],[],[]],De=0;if(A&&A.length)for(var at=0;at<A.length;at++){var Ot=s.uniformBufferBindings[at],Pt=Ot.binding,Kt=Ot.size,hr=Ot.offset,jr=Ot.buffer,pr={buffer:cd(jr),offset:hr!=null?hr:0,size:Kt};we[0].push({binding:Pt!=null?Pt:De++,resource:pr})}if(N&&N.length){De=0;for(var at=0;at<N.length;at++){var rr=(0,yi.pi)((0,yi.pi)({},N[at]),Mg),Pt=s.samplerBindings[at],Ur=Pt.texture!==null?Pt.texture:g.device.getFallbackTexture(rr);rr.dimension=Ur.dimension,rr.formatKind=Eg(Ur.format);var $n=Ur.gpuTextureView;if(we[1].push({binding:(c=Pt.textureBinding)!==null&&c!==void 0?c:De++,resource:$n}),Pt.samplerBinding!==-1){var Ai=Pt.sampler!==null?Pt.sampler:g.device.getFallbackSampler(rr),Wn=xb(Ai);we[1].push({binding:(d=Pt.samplerBinding)!==null&&d!==void 0?d:De++,resource:Wn})}}}if(C&&C.length){De=0;for(var at=0;at<C.length;at++){var Xi=s.storageBufferBindings[at],Pt=Xi.binding,Kt=Xi.size,hr=Xi.offset,jr=Xi.buffer,pr={buffer:cd(jr),offset:hr!=null?hr:0,size:Kt};we[2].push({binding:Pt!=null?Pt:De++,resource:pr})}}if(ae&&ae.length){De=0;for(var at=0;at<ae.length;at++){var oa=s.storageTextureBindings[at],Pt=oa.binding,Ur=oa.texture,$n=Ur.gpuTextureView;we[3].push({binding:Pt!=null?Pt:De++,resource:$n})}}var Es=we.findLastIndex(function(Nu){return!!Nu.length});return g.gpuBindGroup=we.map(function(Nu,nl){return nl<=Es&&g.device.device.createBindGroup({layout:_.getBindGroupLayout(nl),entries:Nu})}),g}return r}(Vf),Ub=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.Buffer;var d=s.usage,g=s.viewOrSize,_=!!(d&$o.MAP_READ);c.usage=yb(d),_&&(c.usage=$o.MAP_READ|$o.COPY_DST);var A=!(0,td.Z)(g);if(c.view=(0,td.Z)(g)?null:g,c.size=(0,td.Z)(g)?Kv(g,4):Kv(g.byteLength,4),(0,td.Z)(g))c.gpuBuffer=c.device.device.createBuffer({usage:c.usage,size:c.size,mappedAtCreation:_?A:!1});else{c.gpuBuffer=c.device.device.createBuffer({usage:c.usage,size:c.size,mappedAtCreation:!0});var C=g&&g.constructor||Float32Array;new C(c.gpuBuffer.getMappedRange()).set(g),c.gpuBuffer.unmap()}return c}return r.prototype.setSubData=function(n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=0);var c=this.gpuBuffer;s=s||i.byteLength,s=Math.min(s,this.size-n);var d=i.byteOffset+a,g=d+s,_=s+3&-4;if(_!==s){var A=new Uint8Array(i.buffer.slice(d,g));i=new Uint8Array(_),i.set(A),a=0,d=0,g=_,s=_}for(var C=1024*1024*15,N=0;g-(d+N)>C;)this.device.device.queue.writeBuffer(c,n+N,i.buffer,d+N,C),N+=C;this.device.device.queue.writeBuffer(c,n+N,i.buffer,d+N,s-N)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuBuffer.destroy()},r}(Vf),qg=function(){function e(){this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(r,n,i){this.gpuComputePassEncoder.dispatchWorkgroups(r,n,i)},e.prototype.dispatchWorkgroupsIndirect=function(r,n){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(r.gpuBuffer,n)},e.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},e.prototype.beginComputePass=function(r){xa(this.gpuComputePassEncoder===null),this.frameCommandEncoder=r,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(r){var n=r,i=Rp(n.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(i)},e.prototype.setBindings=function(r){var n=this,i=r;i.gpuBindGroup.forEach(function(a,s){a&&n.gpuComputePassEncoder.setBindGroup(s,i.gpuBindGroup[s])})},e.prototype.pushDebugGroup=function(r){this.gpuComputePassEncoder.pushDebugGroup(r)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(r){this.gpuComputePassEncoder.insertDebugMarker(r)},e}(),zb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.ComputePipeline,c.gpuComputePipeline=null,c.descriptor=s;var d=s.program,g=d.computeStage;if(g===null)return c;var _={layout:"auto",compute:(0,yi.pi)({},g)};return c.gpuComputePipeline=c.device.device.createComputePipeline(_),c.name!==void 0&&(c.gpuComputePipeline.label=c.name),c}return r.prototype.getBindGroupLayout=function(n){return this.gpuComputePipeline.getBindGroupLayout(n)},r}(Vf),Zb=function(e){(0,yi.ZT)(r,e);function r(n){var i,a,s,c,d=n.id,g=n.device,_=n.descriptor,A=e.call(this,{id:d,device:g})||this;A.type=po.InputLayout;var C=[];try{for(var N=(0,yi.XA)(_.vertexBufferDescriptors),ae=N.next();!ae.done;ae=N.next()){var we=ae.value,De=we.arrayStride,at=we.stepMode,Ot=we.attributes;C.push({arrayStride:De,stepMode:kb(at),attributes:[]});try{for(var Pt=(s=void 0,(0,yi.XA)(Ot)),Kt=Pt.next();!Kt.done;Kt=Pt.next()){var hr=Kt.value,jr=hr.shaderLocation,pr=hr.format,rr=hr.offset;C[C.length-1].attributes.push({shaderLocation:jr,format:Db(pr),offset:rr})}}catch(Ur){s={error:Ur}}finally{try{Kt&&!Kt.done&&(c=Pt.return)&&c.call(Pt)}finally{if(s)throw s.error}}}}catch(Ur){i={error:Ur}}finally{try{ae&&!ae.done&&(a=N.return)&&a.call(N)}finally{if(i)throw i.error}}return A.indexFormat=Pb(_.indexBufferFormat),A.buffers=C,A}return r}(Vf),Qg=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=po.Program,c.vertexStage=null,c.fragmentStage=null,c.computeStage=null,c.descriptor=s,s.vertex&&(c.vertexStage=c.createShaderStage(s.vertex,"vertex")),s.fragment&&(c.fragmentStage=c.createShaderStage(s.fragment,"fragment")),s.compute&&(c.computeStage=c.createShaderStage(s.compute,"compute")),c}return r.prototype.setUniformsLegacy=function(n){},r.prototype.createShaderStage=function(n,i){var a,s,c=n.glsl,d=n.wgsl,g=n.entryPoint,_=n.postprocess,A=!1,C=d;if(!C)try{C=this.device.glsl_compile(c,i,A)}catch(Ot){throw console.error(Ot,c),new Error("whoops")}var N=function(Ot){if(!C.includes(Ot))return"continue";C=C.replace("var T_".concat(Ot,": texture_2d<f32>;"),"var T_".concat(Ot,": texture_depth_2d;")),C=C.replace(new RegExp("textureSample\\(T_".concat(Ot,"(.*)\\);$"),"gm"),function(Pt,Kt){return"vec4<f32>(textureSample(T_".concat(Ot).concat(Kt,"), 0.0, 0.0, 0.0);")})};try{for(var ae=(0,yi.XA)(["u_TextureFramebufferDepth"]),we=ae.next();!we.done;we=ae.next()){var De=we.value;N(De)}}catch(Ot){a={error:Ot}}finally{try{we&&!we.done&&(s=ae.return)&&s.call(ae)}finally{if(a)throw a.error}}_&&(C=_(C));var at=this.device.device.createShaderModule({code:C});return{module:at,entryPoint:g||"main"}},r}(Vf),Vb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=po.QueryPool;var d=s.elemCount,g=s.type;return c.querySet=c.device.device.createQuerySet({type:Eb(g),count:d}),c.resolveBuffer=c.device.device.createBuffer({size:d*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),c.cpuBuffer=c.device.device.createBuffer({size:d*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c.results=null,c}return r.prototype.queryResultOcclusion=function(n){return this.results===null?null:this.results[n]!==BigInt(0)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},r}(Vf),jb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=po.Readback,s}return r.prototype.readTexture=function(n,i,a,s,c,d,g,_){return g===void 0&&(g=0),(0,yi.mG)(this,void 0,void 0,function(){var A,C,N,ae,we,De,at,Ot;return(0,yi.Jh)(this,function(Pt){return A=n,C=0,N=Kg(A.gpuTextureformat),ae=Math.ceil(s/N.width)*N.length,we=Math.ceil(ae/256)*256,De=we*c,at=this.device.createBuffer({usage:$o.STORAGE|$o.MAP_READ|$o.COPY_DST,hint:Zf.STATIC,viewOrSize:De}),Ot=this.device.device.createCommandEncoder(),Ot.copyTextureToBuffer({texture:A.gpuTexture,mipLevel:0,origin:{x:i,y:a,z:Math.max(C,0)}},{buffer:at.gpuBuffer,offset:0,bytesPerRow:we},{width:s,height:c,depthOrArrayLayers:1}),this.device.device.queue.submit([Ot.finish()]),[2,this.readBuffer(at,0,d.byteLength===De?d:null,g,De,A.format,!0,!1,ae,we,c)]})})},r.prototype.readTextureSync=function(n,i,a,s,c,d,g,_){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},r.prototype.readBuffer=function(n,i,a,s,c,d,g,_,A,C,N){var ae=this;i===void 0&&(i=0),a===void 0&&(a=null),c===void 0&&(c=0),d===void 0&&(d=nr.U8_RGB),g===void 0&&(g=!1),A===void 0&&(A=0),C===void 0&&(C=0),N===void 0&&(N=0);var we=n,De=c||we.size,at=a||we.view,Ot=at&&at.constructor&&at.constructor.BYTES_PER_ELEMENT||bg(d),Pt=we;if(!(we.usage&$o.MAP_READ&&we.usage&$o.COPY_DST)){var Kt=this.device.device.createCommandEncoder();Pt=this.device.createBuffer({usage:$o.STORAGE|$o.MAP_READ|$o.COPY_DST,hint:Zf.STATIC,viewOrSize:De}),Kt.copyBufferToBuffer(we.gpuBuffer,i,Pt.gpuBuffer,0,De),this.device.device.queue.submit([Kt.finish()])}return new Promise(function(hr,jr){Pt.gpuBuffer.mapAsync(Vm.READ,i,De).then(function(){var pr=Pt.gpuBuffer.getMappedRange(i,De),rr=at;if(g)rr===null?rr=Yg(d,De,!0,pr):rr=Yg(d,rr.buffer,void 0,pr);else if(rr===null)switch(Ot){case 1:rr=new Uint8Array(De),rr.set(new Uint8Array(pr));break;case 2:rr=ae.getHalfFloatAsFloatRGBAArrayBuffer(De/2,pr);break;case 4:rr=new Float32Array(De/4),rr.set(new Float32Array(pr));break}else switch(Ot){case 1:rr=new Uint8Array(rr.buffer),rr.set(new Uint8Array(pr));break;case 2:rr=ae.getHalfFloatAsFloatRGBAArrayBuffer(De/2,pr,at);break;case 4:var Ur=at&&at.constructor||Float32Array;rr=new Ur(rr.buffer),rr.set(new Ur(pr));break}if(A!==C){Ot===1&&!g&&(A*=2,C*=2);for(var $n=new Uint8Array(rr.buffer),Ai=A,Wn=0,Xi=1;Xi<N;++Xi){Wn=Xi*C;for(var oa=0;oa<A;++oa)$n[Ai++]=$n[Wn++]}Ot!==0&&!g?rr=new Float32Array($n.buffer,0,Ai/4):rr=new Uint8Array($n.buffer,0,Ai)}Pt.gpuBuffer.unmap(),hr(rr)},function(pr){return jr(pr)})})},r.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(n,i,a){a||(a=new Float32Array(n));for(var s=new Uint16Array(i);n--;)a[n]=Fb(s[n]);return a},r}(Vf),Jg=function(){function e(r){this.device=r,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return e.prototype.getEncoder=function(){var r;return((r=this.renderBundle)===null||r===void 0?void 0:r.renderBundleEncoder)||this.gpuRenderPassEncoder},e.prototype.getTextureView=function(r,n){return xa(n<r.mipLevelCount),r.mipLevelCount===1?r.gpuTextureView:r.gpuTexture.createView({baseMipLevel:n,mipLevelCount:1})},e.prototype.setRenderPassDescriptor=function(r){var n,i,a,s,c,d;this.descriptor=r,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var g=r.colorAttachment.length;this.gfxColorAttachment.length=g,this.gfxColorResolveTo.length=g;for(var _=0;_<r.colorAttachment.length;_++){var A=r.colorAttachment[_],C=r.colorResolveTo[_];if(A===null&&C!==null&&(A=C,C=null),this.gfxColorAttachment[_]=A,this.gfxColorResolveTo[_]=C,this.gfxColorAttachmentLevel[_]=((n=r.colorAttachmentLevel)===null||n===void 0?void 0:n[_])||0,this.gfxColorResolveToLevel[_]=((i=r.colorResolveToLevel)===null||i===void 0?void 0:i[_])||0,A!==null){this.gpuColorAttachments[_]===void 0&&(this.gpuColorAttachments[_]={});var N=this.gpuColorAttachments[_];N.view=this.getTextureView(A,((a=this.gfxColorAttachmentLevel)===null||a===void 0?void 0:a[_])||0);var ae=(c=(s=r.colorClearColor)===null||s===void 0?void 0:s[_])!==null&&c!==void 0?c:"load";ae==="load"?N.loadOp="load":(N.loadOp="clear",N.clearValue=ae),N.storeOp=!((d=r.colorStore)===null||d===void 0)&&d[_]?"store":"discard",N.resolveTarget=void 0,C!==null&&(A.sampleCount>1?N.resolveTarget=this.getTextureView(C,this.gfxColorResolveToLevel[_]):N.storeOp="store")}else{this.gpuColorAttachments.length=_,this.gfxColorAttachment.length=_,this.gfxColorResolveTo.length=_;break}}if(this.gfxDepthStencilAttachment=r.depthStencilAttachment,this.gfxDepthStencilResolveTo=r.depthStencilResolveTo,r.depthStencilAttachment){var we=r.depthStencilAttachment,N=this.gpuDepthStencilAttachment;N.view=we.gpuTextureView;var De=!!(nd(we.format)&li.Depth);De?(r.depthClearValue==="load"?N.depthLoadOp="load":(N.depthLoadOp="clear",N.depthClearValue=r.depthClearValue),r.depthStencilStore||this.gfxDepthStencilResolveTo!==null?N.depthStoreOp="store":N.depthStoreOp="discard"):(N.depthLoadOp=void 0,N.depthStoreOp=void 0);var at=!!(nd(we.format)&li.Stencil);at?(r.stencilClearValue==="load"?N.stencilLoadOp="load":(N.stencilLoadOp="clear",N.stencilClearValue=r.stencilClearValue),r.depthStencilStore||this.gfxDepthStencilResolveTo!==null?N.stencilStoreOp="store":N.stencilStoreOp="discard"):(N.stencilLoadOp=void 0,N.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,yf.Z)(r.occlusionQueryPool)?void 0:bb(r.occlusionQueryPool)},e.prototype.beginRenderPass=function(r,n){xa(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(n),this.frameCommandEncoder=r,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},e.prototype.flipY=function(r,n){var i=this.device.swapChainHeight;return i-r-n},e.prototype.setViewport=function(r,n,i,a,s,c){s===void 0&&(s=0),c===void 0&&(c=1),this.gpuRenderPassEncoder.setViewport(r,this.flipY(n,a),i,a,s,c)},e.prototype.setScissorRect=function(r,n,i,a){this.gpuRenderPassEncoder.setScissorRect(r,this.flipY(n,a),i,a)},e.prototype.setPipeline=function(r){var n=r,i=Rp(n.gpuRenderPipeline);this.getEncoder().setPipeline(i)},e.prototype.setVertexInput=function(r,n,i){if(r!==null){var a=this.getEncoder(),s=r;i!==null&&a.setIndexBuffer(cd(i.buffer),Rp(s.indexFormat),i.offset);for(var c=0;c<n.length;c++){var d=n[c];d!==null&&a.setVertexBuffer(c,cd(d.buffer),d.offset)}}},e.prototype.setBindings=function(r){var n=r,i=this.getEncoder();n.gpuBindGroup.forEach(function(a,s){a&&i.setBindGroup(s,n.gpuBindGroup[s])})},e.prototype.setStencilReference=function(r){this.gpuRenderPassEncoder.setStencilReference(r)},e.prototype.draw=function(r,n,i,a){this.getEncoder().draw(r,n,i,a)},e.prototype.drawIndexed=function(r,n,i,a,s){this.getEncoder().drawIndexed(r,n,i,a,s)},e.prototype.drawIndirect=function(r,n){this.getEncoder().drawIndirect(cd(r),n)},e.prototype.drawIndexedIndirect=function(r,n){this.getEncoder().drawIndexedIndirect(cd(r),n)},e.prototype.beginOcclusionQuery=function(r){this.gpuRenderPassEncoder.beginOcclusionQuery(r)},e.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},e.prototype.pushDebugGroup=function(r){this.gpuRenderPassEncoder.pushDebugGroup(r)},e.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(r){this.gpuRenderPassEncoder.insertDebugMarker(r)},e.prototype.beginBundle=function(r){this.renderBundle=r},e.prototype.endBundle=function(){this.renderBundle.finish()},e.prototype.executeBundles=function(r){this.gpuRenderPassEncoder.executeBundles(r.map(function(n){return n.renderBundle}))},e.prototype.finish=function(){var r;(r=this.gpuRenderPassEncoder)===null||r===void 0||r.end(),this.gpuRenderPassEncoder=null;for(var n=0;n<this.gfxColorAttachment.length;n++){var i=this.gfxColorAttachment[n],a=this.gfxColorResolveTo[n];i!==null&&a!==null&&i.sampleCount===1&&this.copyAttachment(a,this.gfxColorAttachmentLevel[n],i,this.gfxColorResolveToLevel[n])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},e.prototype.copyAttachment=function(r,n,i,a){xa(i.sampleCount===1);var s={texture:i.gpuTexture,mipLevel:a},c={texture:r.gpuTexture,mipLevel:n};xa(i.width>>>a===r.width>>>n),xa(i.height>>>a===r.height>>>n),xa(!!(i.usage&Fu.COPY_SRC)),xa(!!(r.usage&Fu.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(s,c,[r.width,r.height,1])},e}(),$b=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=po.RenderPipeline,c.isCreatingAsync=!1,c.gpuRenderPipeline=null,c.descriptor=s,c.device.createRenderPipelineInternal(c,!1),c}return r.prototype.getBindGroupLayout=function(n){return this.gpuRenderPipeline.getBindGroupLayout(n)},r}(Vf),Hb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,d,g=e.call(this,{id:i,device:a})||this;g.type=po.Sampler;var _=s.lodMinClamp,A=s.mipmapFilter===Bu.NO_MIP?s.lodMinClamp:s.lodMaxClamp,C=(c=s.maxAnisotropy)!==null&&c!==void 0?c:1;return C>1&&xa(s.minFilter===$s.BILINEAR&&s.magFilter===$s.BILINEAR&&s.mipmapFilter===Bu.LINEAR),g.gpuSampler=g.device.device.createSampler({addressModeU:$m(s.addressModeU),addressModeV:$m(s.addressModeV),addressModeW:$m((d=s.addressModeW)!==null&&d!==void 0?d:s.addressModeU),lodMinClamp:_,lodMaxClamp:A,minFilter:Hg(s.minFilter),magFilter:Hg(s.magFilter),mipmapFilter:_b(s.mipmapFilter),compare:s.compareFunction!==void 0?om(s.compareFunction):void 0,maxAnisotropy:C}),g}return r}(Vf),sm=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=n.skipCreate,d=n.sampleCount,g=e.call(this,{id:i,device:a})||this;g.type=po.Texture,g.flipY=!1;var _=s.format,A=s.dimension,C=s.width,N=s.height,ae=s.depthOrArrayLayers,we=s.mipLevelCount,De=s.usage,at=s.pixelStore;return g.flipY=!!(at!=null&&at.unpackFlipY),g.device.createTextureShared({format:_,dimension:A!=null?A:za.TEXTURE_2D,width:C,height:N,depthOrArrayLayers:ae!=null?ae:1,mipLevelCount:we!=null?we:1,usage:De,sampleCount:d!=null?d:1},g,c),g}return r.prototype.textureFromImageBitmapOrCanvas=function(n,i,a){for(var s=i[0].width,c=i[0].height,d={size:{width:s,height:c,depthOrArrayLayers:a},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},g=n.createTexture(d),_=0;_<i.length;_++)n.queue.copyExternalImageToTexture({source:i[_],flipY:this.flipY},{texture:g,origin:[0,0,_]},[s,c]);return[g,s,c]},r.prototype.isImageBitmapOrCanvases=function(n){var i=n[0];return i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof OffscreenCanvas},r.prototype.isVideo=function(n){var i=n[0];return i instanceof HTMLVideoElement},r.prototype.setImageData=function(n,i){var a,s=this,c=this.device.device,d,g,_;if(this.isImageBitmapOrCanvases(n))a=(0,yi.CR)(this.textureFromImageBitmapOrCanvas(c,n,this.depthOrArrayLayers),3),d=a[0],g=a[1],_=a[2];else if(this.isVideo(n))d=c.importExternalTexture({source:n[0]});else{var A=Kg(this.gpuTextureformat),C=Math.ceil(this.width/A.width)*A.length;n.forEach(function(N){c.queue.writeTexture({texture:s.gpuTexture},N,{bytesPerRow:C},{width:s.width,height:s.height})})}this.width=g,this.height=_,d&&(this.gpuTexture=d),this.gpuTextureView=this.gpuTexture.createView({dimension:gb(this.dimension)})},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuTexture.destroy()},r}(Vf),Wb=function(e){(0,yi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=po.RenderBundle,s.renderBundleEncoder=s.device.device.createRenderBundleEncoder({colorFormats:[s.device.swapChainFormat]}),s}return r.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},r}(Vf),Gb=function(){function e(r,n,i,a,s,c){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Fu.RENDER_ATTACHMENT|Fu.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=sh.UPPER_LEFT,this.clipSpaceNearZ=rd.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=n,this.canvas=i,this.canvasContext=a,this.glsl_compile=s,this.WGSLComposer=c,this.fallbackTexture2D=this.createFallbackTexture(za.TEXTURE_2D,Fs.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(za.TEXTURE_2D,Fs.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(za.TEXTURE_2D_ARRAY,Fs.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(za.TEXTURE_3D,Fs.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(za.TEXTURE_CUBE_MAP,Fs.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:oc.REPEAT,addressModeV:oc.REPEAT,minFilter:$s.POINT,magFilter:$s.POINT,mipmapFilter:Bu.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:oc.REPEAT,addressModeV:oc.REPEAT,minFilter:$s.POINT,magFilter:$s.POINT,mipmapFilter:Bu.NEAREST,compareFunction:Fa.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(d){console.error(d.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return e.prototype.destroy=function(){},e.prototype.configureSwapChain=function(r,n){this.swapChainWidth===r&&this.swapChainHeight===n||(this.swapChainWidth=r,this.swapChainHeight=n)},e.prototype.getOnscreenTexture=function(){var r=this.canvasContext.getCurrentTexture(),n=r.createView(),i=new sm({id:0,device:this,descriptor:{format:nr.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:za.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return i.depthOrArrayLayers=1,i.sampleCount=1,i.gpuTexture=r,i.gpuTextureView=n,i.name="Onscreen",this.setResourceName(i,"Onscreen Texture"),i},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.canvas},e.prototype.beginFrame=function(){xa(this.frameCommandEncoderPool.length===0)},e.prototype.endFrame=function(){xa(this.frameCommandEncoderPool.every(function(r){return r!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(r){return r.finish()})),this.frameCommandEncoderPool=[]},e.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},e.prototype.createBuffer=function(r){return new Ub({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTexture=function(r){return new sm({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createSampler=function(r){return new Hb({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTarget=function(r){var n=new sm({id:this.getNextUniqueId(),device:this,descriptor:(0,yi.pi)((0,yi.pi)({},r),{dimension:za.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:wl.RENDER_TARGET}),sampleCount:r.sampleCount});return n.depthOrArrayLayers=1,n.type=po.RenderTarget,n},e.prototype.createRenderTargetFromTexture=function(r){var n=r,i=n.format,a=n.width,s=n.height,c=n.depthOrArrayLayers,d=n.sampleCount,g=n.mipLevelCount,_=n.gpuTexture,A=n.gpuTextureView,C=n.usage;xa(!!(C&Fu.RENDER_ATTACHMENT));var N=new sm({id:this.getNextUniqueId(),device:this,descriptor:{format:i,width:a,height:s,depthOrArrayLayers:c,dimension:za.TEXTURE_2D,mipLevelCount:g,usage:C},skipCreate:!0});return N.depthOrArrayLayers=c,N.sampleCount=d,N.gpuTexture=_,N.gpuTextureView=A,N},e.prototype.createProgram=function(r){var n,i;return!((n=r.vertex)===null||n===void 0)&&n.glsl&&(r.vertex.glsl=qh(this.queryVendorInfo(),"vert",r.vertex.glsl)),!((i=r.fragment)===null||i===void 0)&&i.glsl&&(r.fragment.glsl=qh(this.queryVendorInfo(),"frag",r.fragment.glsl)),new Qg({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createProgramSimple=function(r){return new Qg({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTextureShared=function(r,n,i){var a={width:r.width,height:r.height,depthOrArrayLayers:r.depthOrArrayLayers},s=r.mipLevelCount,c=jm(r.format),d=mb(r.dimension),g=vb(r.usage);if(n.gpuTextureformat=c,n.dimension=r.dimension,n.format=r.format,n.width=r.width,n.height=r.height,n.depthOrArrayLayers=r.depthOrArrayLayers,n.mipLevelCount=s,n.usage=g,n.sampleCount=r.sampleCount,!i){var _=this.device.createTexture({size:a,mipLevelCount:s,format:c,dimension:d,sampleCount:r.sampleCount,usage:g}),A=_.createView();n.gpuTexture=_,n.gpuTextureView=A}},e.prototype.getFallbackSampler=function(r){var n=r.formatKind;return n===Fs.Depth&&r.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},e.prototype.getFallbackTexture=function(r){var n=r.dimension,i=r.formatKind;if(n===za.TEXTURE_2D)return i===Fs.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(n===za.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(n===za.TEXTURE_3D)return this.fallbackTexture3D;if(n===za.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.createFallbackTexture=function(r,n){var i=r===za.TEXTURE_CUBE_MAP?6:1,a=n===Fs.Float?nr.U8_RGBA_NORM:nr.D24;return this.createTexture({dimension:r,format:a,usage:wl.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1})},e.prototype.createBindings=function(r){return new Nb({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createInputLayout=function(r){return new Zb({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createComputePipeline=function(r){return new zb({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderPipeline=function(r){return new $b({id:this.getNextUniqueId(),device:this,descriptor:(0,yi.pi)({},r)})},e.prototype.createQueryPool=function(r,n){return new Vb({id:this.getNextUniqueId(),device:this,descriptor:{type:r,elemCount:n}})},e.prototype.createRenderPipelineInternal=function(r,n){var i;if(r.gpuRenderPipeline===null){var a=r.descriptor,s=a.program,c=s.vertexStage,d=s.fragmentStage;if(!(c===null||d===null)){var g=a.megaStateDescriptor||{},_=g.stencilBack,A=g.stencilFront,C=(0,yi._T)(g,["stencilBack","stencilFront"]),N=od(Mp);a.megaStateDescriptor=(0,yi.pi)((0,yi.pi)((0,yi.pi)({},N),{stencilBack:(0,yi.pi)((0,yi.pi)({},N.stencilBack),_),stencilFront:(0,yi.pi)((0,yi.pi)({},N.stencilFront),A)}),C);var ae=a.megaStateDescriptor.attachmentsState[0];a.colorAttachmentFormats.forEach(function(hr,jr){a.megaStateDescriptor.attachmentsState[jr]||(a.megaStateDescriptor.attachmentsState[jr]=wg(void 0,ae))});var we=Cb((i=a.topology)!==null&&i!==void 0?i:su.TRIANGLES,a.megaStateDescriptor),De=Ob(a.colorAttachmentFormats,a.megaStateDescriptor),at=Ib(a.depthStencilAttachmentFormat,a.megaStateDescriptor),Ot=void 0;a.inputLayout!==null&&(Ot=a.inputLayout.buffers);var Pt=a.sampleCount,Kt={layout:"auto",vertex:(0,yi.pi)((0,yi.pi)({},c),{buffers:Ot}),primitive:we,depthStencil:at,multisample:{count:Pt},fragment:(0,yi.pi)((0,yi.pi)({},d),{targets:De})};r.gpuRenderPipeline=this.device.createRenderPipeline(Kt)}}},e.prototype.createReadback=function(){return new jb({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderBundle=function(){return new Wb({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderPass=function(r){var n=this.renderPassPool.pop();n===void 0&&(n=new Jg(this));var i=this.frameCommandEncoderPool.pop();return i===void 0&&(i=this.device.createCommandEncoder()),n.beginRenderPass(i,r),n},e.prototype.createComputePass=function(){var r=this.computePassPool.pop();r===void 0&&(r=new qg);var n=this.frameCommandEncoderPool.pop();return n===void 0&&(n=this.device.createCommandEncoder()),r.beginComputePass(n),r},e.prototype.submitPass=function(r){var n=r;n instanceof Jg?(this.frameCommandEncoderPool.push(n.frameCommandEncoder),n.finish(),this.renderPassPool.push(n)):n instanceof qg&&(this.frameCommandEncoderPool.push(n.frameCommandEncoder),n.finish(),this.computePassPool.push(n))},e.prototype.copySubTexture2D=function(r,n,i,a,s,c,d){var g=this.device.createCommandEncoder(),_=r,A=a,C={texture:A.gpuTexture,origin:[s,c,0],mipLevel:0,aspect:"all"},N={texture:_.gpuTexture,origin:[n,i,0],mipLevel:0,aspect:"all"};xa(!!(A.usage&Fu.COPY_SRC)),xa(!!(_.usage&Fu.COPY_DST)),g.copyTextureToTexture(C,N,[A.width,A.height,d||1]),this.device.queue.submit([g.finish()])},e.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},e.prototype.queryTextureFormatSupported=function(r,n,i){if(Lb(r)){if(!this.featureTextureCompressionBC)return!1;var a=Bb(r);return n%a!==0||i%a!==0?!1:this.featureTextureCompressionBC}switch(r){case nr.U16_RGBA_NORM:return!1;case nr.F32_RGBA:return!1}return!0},e.prototype.queryPlatformAvailable=function(){return!0},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(r){var n=r;return n.descriptor},e.prototype.queryRenderTarget=function(r){var n=r;return n},e.prototype.setResourceName=function(r,n){if(r.name=n,r.type===po.Buffer){var i=r;i.gpuBuffer.label=n}else if(r.type===po.Texture){var i=r;i.gpuTexture.label=n,i.gpuTextureView.label=n}else if(r.type===po.RenderTarget){var i=r;i.gpuTexture.label=n,i.gpuTextureView.label=n}else if(r.type===po.Sampler){var i=r;i.gpuSampler.label=n}else if(r.type===po.RenderPipeline){var i=r;i.gpuRenderPipeline!==null&&(i.gpuRenderPipeline.label=n)}},e.prototype.setResourceLeakCheck=function(r,n){},e.prototype.checkForLeaks=function(){},e.prototype.programPatched=function(r){},e.prototype.pipelineQueryReady=function(r){var n=r;return n.gpuRenderPipeline!==null},e.prototype.pipelineForceReady=function(r){var n=r;this.createRenderPipelineInternal(n,!1)},e}(),Xb=function(){function e(r){this.pluginOptions=r}return e.prototype.createSwapChain=function(r){return(0,yi.mG)(this,void 0,void 0,function(){var n,i,a,s,c,d,g,_;return(0,yi.Jh)(this,function(A){switch(A.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];n=null,A.label=1;case 1:return A.trys.push([1,3,,4]),i=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:i})];case 2:return n=A.sent(),[3,4];case 3:return a=A.sent(),console.log(a),[3,4];case 4:return n===null?[2,null]:(s=["depth32float-stencil8","texture-compression-bc","float32-filterable"],c=s.filter(function(C){return n.features.has(C)}),[4,n.requestDevice({requiredFeatures:c})]);case 5:if(d=A.sent(),d&&(g=this.pluginOptions.onContextLost,d.lost.then(function(){g&&g()})),d===null)return[2,null];if(_=r.getContext("webgpu"),!_)return[2,null];A.label=6;case 6:return A.trys.push([6,8,,9]),[4,$g(this.pluginOptions.shaderCompilerPath)];case 7:return A.sent(),[3,9];case 8:return A.sent(),[3,9];case 9:return[2,new Gb(n,d,r,_,fb,cv&&new cv)]}})})},e}(),Yb=ke.rU.isPlainObject,Kb=ke.rU.isTypedArray,qb=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"destroyed",!1),(0,ue.Z)(this,"uniforms",{}),this.reGl=r;var i=n.vs,a=n.fs,s=n.attributes,c=n.uniforms,d=n.primitive,g=n.count,_=n.elements,A=n.depth,C=n.cull,N=n.instances,ae={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:sh.LOWER_LEFT,clipSpaceNearZ:rd.NEGATIVE_ONE,supportMRT:!1},we={};this.options=n,c&&(this.uniforms=this.extractUniforms(c),Object.keys(c).forEach(function(Kt){we[Kt]=r.prop(Kt)}));var De={};Object.keys(s).forEach(function(Kt){De[Kt]=s[Kt].get()});var at=(0,Y.Vb)(qh(ae,"frag",a,null,!1)),Ot=(0,Y.Vb)(qh(ae,"vert",i,null,!1)),Pt={attributes:De,frag:at,uniforms:we,vert:Ot,colorMask:r.prop("colorMask"),lineWidth:1,blend:{enable:r.prop("blend.enable"),func:r.prop("blend.func"),equation:r.prop("blend.equation"),color:r.prop("blend.color")},stencil:{enable:r.prop("stencil.enable"),mask:r.prop("stencil.mask"),func:r.prop("stencil.func"),opFront:r.prop("stencil.opFront"),opBack:r.prop("stencil.opBack")},primitive:z1[d===void 0?Y.gl.TRIANGLES:d]};N&&(Pt.instances=N),g?Pt.count=g:_&&(Pt.elements=_.get()),this.initDepthDrawParams({depth:A},Pt),this.initCullDrawParams({cull:C},Pt),this.drawCommand=r(Pt),this.drawParams=Pt}return(0,vt.Z)(e,[{key:"updateAttributesAndElements",value:function(n,i){var a={};Object.keys(n).forEach(function(s){a[s]=n[s].get()}),this.drawParams.attributes=a,this.drawParams.elements=i.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(n){var i={};Object.keys(n).forEach(function(a){i[a]=n[a].get()}),this.drawParams.attributes=i,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(n){this.uniforms=(0,de.Z)((0,de.Z)({},this.uniforms),this.extractUniforms(n))}},{key:"draw",value:function(n,i){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var a=(0,de.Z)((0,de.Z)({},this.uniforms),this.extractUniforms(n.uniforms||{})),s={};Object.keys(a).forEach(function(c){var d=(0,zi.Z)(a[c]);d==="boolean"||d==="number"||Array.isArray(a[c])||a[c].BYTES_PER_ELEMENT?s[c]=a[c]:s[c]=a[c].get()}),s.blend=i?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(n),s.stencil=this.getStencilDrawParams(n),s.colorMask=this.getColorMaskDrawParams(n,i),this.drawCommand(s)}}},{key:"destroy",value:function(){var n;(n=this.drawParams)===null||n===void 0||(n=n.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i==null||i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(n,i){var a=n.depth;a&&(i.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:$1[a.func||Y.gl.LESS],range:a.range||[0,1]})}},{key:"getBlendDrawParams",value:function(n){var i=n.blend,a=i||{},s=a.enable,c=a.func,d=a.equation,g=a.color,_=g===void 0?[0,0,0,0]:g;return{enable:!!s,func:{srcRGB:Hv[c&&c.srcRGB||Y.gl.SRC_ALPHA],srcAlpha:Hv[c&&c.srcAlpha||Y.gl.SRC_ALPHA],dstRGB:Hv[c&&c.dstRGB||Y.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Hv[c&&c.dstAlpha||Y.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:gg[d&&d.rgb||Y.gl.FUNC_ADD],alpha:gg[d&&d.alpha||Y.gl.FUNC_ADD]},color:_}}},{key:"getStencilDrawParams",value:function(n){var i=n.stencil,a=i||{},s=a.enable,c=a.mask,d=c===void 0?-1:c,g=a.func,_=g===void 0?{cmp:Y.gl.ALWAYS,ref:0,mask:-1}:g,A=a.opFront,C=A===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:A,N=a.opBack,ae=N===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:N;return{enable:!!s,mask:d,func:(0,de.Z)((0,de.Z)({},_),{},{cmp:H1[_.cmp]}),opFront:{fail:ed[C.fail],zfail:ed[C.zfail],zpass:ed[C.zpass]},opBack:{fail:ed[ae.fail],zfail:ed[ae.zfail],zpass:ed[ae.zpass]}}}},{key:"getColorMaskDrawParams",value:function(n,i){var a=n.stencil,s=a!=null&&a.enable&&a.opFront&&!i?[!1,!1,!1,!1]:[!0,!0,!0,!0];return s}},{key:"initCullDrawParams",value:function(n,i){var a=n.cull;if(a){var s=a.enable,c=a.face,d=c===void 0?Y.gl.BACK:c;i.cull={enable:!!s,face:W1[d]}}}},{key:"extractUniforms",value:function(n){var i=this,a={};return Object.keys(n).forEach(function(s){i.extractUniformsRecursively(s,n[s],a,"")}),a}},{key:"extractUniformsRecursively",value:function(n,i,a,s){var c=this;if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||Kb(i)||i===""||"resize"in i){a["".concat(s&&s+".").concat(n)]=i;return}Yb(i)&&Object.keys(i).forEach(function(d){c.extractUniformsRecursively(d,i[d],a,"".concat(s&&s+".").concat(n))}),Array.isArray(i)&&i.forEach(function(d,g){Object.keys(d).forEach(function(_){c.extractUniformsRecursively(_,d[_],a,"".concat(s&&s+".").concat(n,"[").concat(g,"]"))})})}}]),e}(),Qb=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"isDestroy",!1);var i=n.data,a=n.type,s=a===void 0?Y.gl.UNSIGNED_BYTE:a,c=n.width,d=n.height,g=n.flipY,_=g===void 0?!1:g,A=n.format,C=A===void 0?Y.gl.RGBA:A,N=n.mipmap,ae=N===void 0?!1:N,we=n.wrapS,De=we===void 0?Y.gl.CLAMP_TO_EDGE:we,at=n.wrapT,Ot=at===void 0?Y.gl.CLAMP_TO_EDGE:at,Pt=n.aniso,Kt=Pt===void 0?0:Pt,hr=n.alignment,jr=hr===void 0?1:hr,pr=n.premultiplyAlpha,rr=pr===void 0?!1:pr,Ur=n.mag,$n=Ur===void 0?Y.gl.NEAREST:Ur,Ai=n.min,Wn=Ai===void 0?Y.gl.NEAREST:Ai,Xi=n.colorSpace,oa=Xi===void 0?Y.gl.BROWSER_DEFAULT_WEBGL:Xi,Es=n.x,Nu=Es===void 0?0:Es,nl=n.y,Wc=nl===void 0?0:nl,Mc=n.copy,ml=Mc===void 0?!1:Mc;this.width=c,this.height=d;var xf={width:c,height:d,type:Lm[s],format:Z1[C],wrapS:mg[De],wrapT:mg[Ot],mag:vg[$n],min:vg[Wn],alignment:jr,flipY:_,colorSpace:j1[oa],premultiplyAlpha:rr,aniso:Kt,x:Nu,y:Wc,copy:ml};i&&(xf.data=i),typeof ae=="number"?xf.mipmap=V1[ae]:typeof ae=="boolean"&&(xf.mipmap=ae),this.texture=r.texture(xf)}return(0,vt.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(n)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var i=n.width,a=n.height;this.texture.resize(i,a),this.width=i,this.height=a}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var n;(n=this.texture)===null||n===void 0||n.destroy()}this.isDestroy=!0}}]),e}(),Jb=function(){function e(){var r=this;(0,Ue.Z)(this,e),(0,ue.Z)(this,"uniformBuffers",[]),(0,ue.Z)(this,"queryVerdorInfo",function(){return"WebGL1"}),(0,ue.Z)(this,"createModel",function(n){return new qb(r.gl,n)}),(0,ue.Z)(this,"createAttribute",function(n){return new U1(r.gl,n)}),(0,ue.Z)(this,"createBuffer",function(n){return new G1(r.gl,n)}),(0,ue.Z)(this,"createElements",function(n){return new X1(r.gl,n)}),(0,ue.Z)(this,"createTexture2D",function(n){return new Qb(r.gl,n)}),(0,ue.Z)(this,"createFramebuffer",function(n){return new Y1(r.gl,n)}),(0,ue.Z)(this,"useFramebuffer",function(n,i){r.gl({framebuffer:n?n.get():null})(i)}),(0,ue.Z)(this,"useFramebufferAsync",function(){var n=(0,qe.Z)(Pe().mark(function i(a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:r.gl({framebuffer:a?a.get():null})(s);case 1:case"end":return d.stop()}},i)}));return function(i,a){return n.apply(this,arguments)}}()),(0,ue.Z)(this,"clear",function(n){var i,a=n.color,s=n.depth,c=n.stencil,d=n.framebuffer,g=d===void 0?null:d,_={color:a,depth:s,stencil:c};_.framebuffer=g===null?g:g.get(),(i=r.gl)===null||i===void 0||i.clear(_)}),(0,ue.Z)(this,"viewport",function(n){var i=n.x,a=n.y,s=n.width,c=n.height;r.gl._gl.viewport(i,a,s,c),r.width=s,r.height=c,r.gl._refresh()}),(0,ue.Z)(this,"readPixels",function(n){var i=n.framebuffer,a=n.x,s=n.y,c=n.width,d=n.height,g={x:a,y:s,width:c,height:d};return i&&(g.framebuffer=i.get()),r.gl.read(g)}),(0,ue.Z)(this,"readPixelsAsync",function(){var n=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",r.readPixels(a));case 1:case"end":return c.stop()}},i)}));return function(i){return n.apply(this,arguments)}}()),(0,ue.Z)(this,"getViewportSize",function(){return{width:r.gl._gl.drawingBufferWidth,height:r.gl._gl.drawingBufferHeight}}),(0,ue.Z)(this,"getContainer",function(){var n;return(n=r.canvas)===null||n===void 0?void 0:n.parentElement}),(0,ue.Z)(this,"getCanvas",function(){return r.canvas}),(0,ue.Z)(this,"getGLContext",function(){return r.gl._gl}),(0,ue.Z)(this,"destroy",function(){var n;r.canvas=null,(n=r.gl)===null||n===void 0||(n=n._gl)===null||n===void 0||(n=n.getExtension("WEBGL_lose_context"))===null||n===void 0||n.loseContext(),r.gl.destroy(),r.gl=null})}return(0,vt.Z)(e,[{key:"init",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s,c){var d=this;return Pe().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.canvas=a,!c){_.next=5;break}this.gl=c,_.next=8;break;case 5:return _.next=7,new Promise(function(A,C){N1()({canvas:d.canvas,attributes:{alpha:!0,antialias:s.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:s.preserveDrawingBuffer,stencil:s.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(ae,we){(ae||!we)&&C(ae),A(we)}})});case 7:this.gl=_.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return _.stop()}},i,this)}));function n(i,a,s){return r.apply(this,arguments)}return n}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(n){return!!this.getGLContext().getExtension(n)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var n=this.getGLContext();n.disable(n.CULL_FACE)}},{key:"setDirty",value:function(n){this.isDirty=n}},{key:"getDirty",value:function(){return this.isDirty}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),eE=function(){function e(r,n){(0,Ue.Z)(this,e);var i=n.buffer,a=n.offset,s=n.stride,c=n.normalized,d=n.size,g=n.divisor,_=n.shaderLocation;this.buffer=i,this.attribute={shaderLocation:_,buffer:i.get(),offset:a||0,stride:s||0,normalized:c||!1,divisor:g||0},d&&(this.attribute.size=d)}return(0,vt.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Jh,Oh,hd,fv,hv,lh,um,Op,Rl,ch,fh,lm=(Jh={},(0,ue.Z)(Jh,Y.gl.FLOAT,Float32Array),(0,ue.Z)(Jh,Y.gl.UNSIGNED_BYTE,Uint8Array),(0,ue.Z)(Jh,Y.gl.SHORT,Int16Array),(0,ue.Z)(Jh,Y.gl.UNSIGNED_SHORT,Uint16Array),(0,ue.Z)(Jh,Y.gl.INT,Int32Array),(0,ue.Z)(Jh,Y.gl.UNSIGNED_INT,Uint32Array),Jh),tE=(Oh={},(0,ue.Z)(Oh,Y.gl.POINTS,su.POINTS),(0,ue.Z)(Oh,Y.gl.LINES,su.LINES),(0,ue.Z)(Oh,Y.gl.LINE_LOOP,su.LINES),(0,ue.Z)(Oh,Y.gl.LINE_STRIP,su.LINE_STRIP),(0,ue.Z)(Oh,Y.gl.TRIANGLES,su.TRIANGLES),(0,ue.Z)(Oh,Y.gl.TRIANGLE_FAN,su.TRIANGLES),(0,ue.Z)(Oh,Y.gl.TRIANGLE_STRIP,su.TRIANGLE_STRIP),Oh),rE=(hd={},(0,ue.Z)(hd,1,nr.F32_R),(0,ue.Z)(hd,2,nr.F32_RG),(0,ue.Z)(hd,3,nr.F32_RGB),(0,ue.Z)(hd,4,nr.F32_RGBA),hd),nE=(fv={},(0,ue.Z)(fv,Y.gl.STATIC_DRAW,Zf.STATIC),(0,ue.Z)(fv,Y.gl.DYNAMIC_DRAW,Zf.DYNAMIC),(0,ue.Z)(fv,Y.gl.STREAM_DRAW,Zf.DYNAMIC),fv),e0=(hv={},(0,ue.Z)(hv,Y.gl.REPEAT,oc.REPEAT),(0,ue.Z)(hv,Y.gl.CLAMP_TO_EDGE,oc.CLAMP_TO_EDGE),(0,ue.Z)(hv,Y.gl.MIRRORED_REPEAT,oc.MIRRORED_REPEAT),hv),iE=(lh={},(0,ue.Z)(lh,Y.gl.NEVER,Fa.NEVER),(0,ue.Z)(lh,Y.gl.ALWAYS,Fa.ALWAYS),(0,ue.Z)(lh,Y.gl.LESS,Fa.LESS),(0,ue.Z)(lh,Y.gl.LEQUAL,Fa.LEQUAL),(0,ue.Z)(lh,Y.gl.GREATER,Fa.GREATER),(0,ue.Z)(lh,Y.gl.GEQUAL,Fa.GEQUAL),(0,ue.Z)(lh,Y.gl.EQUAL,Fa.EQUAL),(0,ue.Z)(lh,Y.gl.NOTEQUAL,Fa.NOTEQUAL),lh),aE=(um={},(0,ue.Z)(um,Y.gl.FRONT,wc.FRONT),(0,ue.Z)(um,Y.gl.BACK,wc.BACK),um),t0=(Op={},(0,ue.Z)(Op,Y.gl.FUNC_ADD,tl.ADD),(0,ue.Z)(Op,Y.gl.MIN_EXT,tl.MIN),(0,ue.Z)(Op,Y.gl.MAX_EXT,tl.MAX),(0,ue.Z)(Op,Y.gl.FUNC_SUBTRACT,tl.SUBSTRACT),(0,ue.Z)(Op,Y.gl.FUNC_REVERSE_SUBTRACT,tl.REVERSE_SUBSTRACT),Op),cm=(Rl={},(0,ue.Z)(Rl,Y.gl.ZERO,Ya.ZERO),(0,ue.Z)(Rl,Y.gl.ONE,Ya.ONE),(0,ue.Z)(Rl,Y.gl.SRC_COLOR,Ya.SRC),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_SRC_COLOR,Ya.ONE_MINUS_SRC),(0,ue.Z)(Rl,Y.gl.SRC_ALPHA,Ya.SRC_ALPHA),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_SRC_ALPHA,Ya.ONE_MINUS_SRC_ALPHA),(0,ue.Z)(Rl,Y.gl.DST_COLOR,Ya.DST),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_DST_COLOR,Ya.ONE_MINUS_DST),(0,ue.Z)(Rl,Y.gl.DST_ALPHA,Ya.DST_ALPHA),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_DST_ALPHA,Ya.ONE_MINUS_DST_ALPHA),(0,ue.Z)(Rl,Y.gl.CONSTANT_COLOR,Ya.CONST),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_CONSTANT_COLOR,Ya.ONE_MINUS_CONSTANT),(0,ue.Z)(Rl,Y.gl.CONSTANT_ALPHA,Ya.CONST),(0,ue.Z)(Rl,Y.gl.ONE_MINUS_CONSTANT_ALPHA,Ya.ONE_MINUS_CONSTANT),(0,ue.Z)(Rl,Y.gl.SRC_ALPHA_SATURATE,Ya.SRC_ALPHA_SATURATE),Rl),pd=(ch={},(0,ue.Z)(ch,Y.gl.REPLACE,Bs.REPLACE),(0,ue.Z)(ch,Y.gl.KEEP,Bs.KEEP),(0,ue.Z)(ch,Y.gl.ZERO,Bs.ZERO),(0,ue.Z)(ch,Y.gl.INVERT,Bs.INVERT),(0,ue.Z)(ch,Y.gl.INCR,Bs.INCREMENT_CLAMP),(0,ue.Z)(ch,Y.gl.DECR,Bs.DECREMENT_CLAMP),(0,ue.Z)(ch,Y.gl.INCR_WRAP,Bs.INCREMENT_WRAP),(0,ue.Z)(ch,Y.gl.DECR_WRAP,Bs.DECREMENT_WRAP),ch),oE=(fh={},(0,ue.Z)(fh,Y.gl.ALWAYS,Fa.ALWAYS),(0,ue.Z)(fh,Y.gl.EQUAL,Fa.EQUAL),(0,ue.Z)(fh,Y.gl.GEQUAL,Fa.GEQUAL),(0,ue.Z)(fh,Y.gl.GREATER,Fa.GREATER),(0,ue.Z)(fh,Y.gl.LEQUAL,Fa.LEQUAL),(0,ue.Z)(fh,Y.gl.LESS,Fa.LESS),(0,ue.Z)(fh,Y.gl.NEVER,Fa.NEVER),(0,ue.Z)(fh,Y.gl.NOTEQUAL,Fa.NOTEQUAL),fh),sE={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function fm(e){return Object.prototype.toString.call(e)in sE}function uE(e,r){for(var n=e.length,i=Math.ceil(n/3),a=n+i,s=new Float32Array(a),c=0;c<a;c+=4)s[c]=e[c/4*3],s[c+1]=e[c/4*3+1],s[c+2]=e[c/4*3+2],s[c+3]=r;return s}var lE=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"isDestroyed",!1);var i=n.data,a=n.usage,s=n.type,c=n.isUBO,d=n.label,g;fm(i)?g=i:g=new lm[this.type||Y.gl.FLOAT](i),this.type=s,this.size=g.byteLength,this.buffer=r.createBuffer({viewOrSize:g,usage:c?$o.UNIFORM:$o.VERTEX,hint:nE[a||Y.gl.STATIC_DRAW]}),d&&r.setResourceName(this.buffer,d)}return(0,vt.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(n){var i=n.data,a=n.offset,s;fm(i)?s=i:s=new lm[this.type||Y.gl.FLOAT](i),this.buffer.setSubData(a,new Uint8Array(s.buffer))}}]),e}();function r0(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=cE(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function cE(e,r){if(e){if(typeof e=="string")return n0(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return n0(e,r)}}function n0(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function Io(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e+=r,e+=e<<10,e+=e>>>6,e>>>0}function i0(e){return e+=e<<3,e^=e>>>11,e+=e<<15,e>>>0}function a0(){return 0}var fE=(0,vt.Z)(function e(){(0,Ue.Z)(this,e),(0,ue.Z)(this,"keys",[]),(0,ue.Z)(this,"values",[])}),hm=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"buckets",new Map),this.keyEqualFunc=r,this.keyHashFunc=n}return(0,vt.Z)(e,[{key:"findBucketIndex",value:function(n,i){for(var a=0;a<n.keys.length;a++)if(this.keyEqualFunc(i,n.keys[a]))return a;return-1}},{key:"findBucket",value:function(n){var i=this.keyHashFunc(n);return this.buckets.get(i)}},{key:"get",value:function(n){var i=this.findBucket(n);if(i===void 0)return null;var a=this.findBucketIndex(i,n);return a<0?null:i.values[a]}},{key:"add",value:function(n,i){var a=this.keyHashFunc(n);this.buckets.get(a)===void 0&&this.buckets.set(a,new fE);var s=this.buckets.get(a);s.keys.push(n),s.values.push(i)}},{key:"delete",value:function(n){var i=this.findBucket(n);if(i!==void 0){var a=this.findBucketIndex(i,n);a!==-1&&(i.keys.splice(a,1),i.values.splice(a,1))}}},{key:"clear",value:function(){this.buckets.clear()}},{key:"size",value:function(){var n=0,i=r0(this.buckets.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;n+=s.values.length}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"values",value:Pe().mark(function r(){var n,i,a,s;return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:n=r0(this.buckets.values()),d.prev=1,n.s();case 3:if((i=n.n()).done){d.next=14;break}a=i.value,s=a.values.length-1;case 6:if(!(s>=0)){d.next=12;break}return d.next=9,a.values[s];case 9:s--,d.next=6;break;case 12:d.next=3;break;case 14:d.next=19;break;case 16:d.prev=16,d.t0=d.catch(1),n.e(d.t0);case 19:return d.prev=19,n.f(),d.finish(19);case 22:case"end":return d.stop()}},r,this,[[1,16,19,22]])})}]),e}();function pm(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=hE(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(_){throw _},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,d;return{s:function(){n=n.call(e)},n:function(){var _=n.next();return s=_.done,_},e:function(_){c=!0,d=_},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw d}}}}function hE(e,r){if(e){if(typeof e=="string")return o0(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o0(e,r)}}function o0(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function s0(e,r){return e=Io(e,r.blendMode),e=Io(e,r.blendSrcFactor),e=Io(e,r.blendDstFactor),e}function pE(e,r){return e=s0(e,r.rgbBlendState),e=s0(e,r.alphaBlendState),e=Io(e,r.channelWriteMask),e}function dE(e,r){return e=Io(e,r.r<<24|r.g<<16|r.b<<8|r.a),e}function vE(e,r){for(var n,i,a,s,c,d,g,_,A=0;A<r.attachmentsState.length;A++)e=pE(e,r.attachmentsState[A]);return e=dE(e,r.blendConstant||Xv),e=Io(e,r.depthCompare),e=Io(e,r.depthWrite?1:0),e=Io(e,(n=r.stencilFront)===null||n===void 0?void 0:n.compare),e=Io(e,(i=r.stencilFront)===null||i===void 0?void 0:i.passOp),e=Io(e,(a=r.stencilFront)===null||a===void 0?void 0:a.failOp),e=Io(e,(s=r.stencilFront)===null||s===void 0?void 0:s.depthFailOp),e=Io(e,(c=r.stencilBack)===null||c===void 0?void 0:c.compare),e=Io(e,(d=r.stencilBack)===null||d===void 0?void 0:d.passOp),e=Io(e,(g=r.stencilBack)===null||g===void 0?void 0:g.failOp),e=Io(e,(_=r.stencilBack)===null||_===void 0?void 0:_.depthFailOp),e=Io(e,r.stencilWrite?1:0),e=Io(e,r.cullMode),e=Io(e,r.frontFace?1:0),e=Io(e,r.polygonOffset?1:0),e}function mE(e){var r=0;r=Io(r,e.program.id),e.inputLayout!==null&&(r=Io(r,e.inputLayout.id)),r=vE(r,e.megaStateDescriptor);for(var n=0;n<e.colorAttachmentFormats.length;n++)r=Io(r,e.colorAttachmentFormats[n]||0);return r=Io(r,e.depthStencilAttachmentFormat||0),i0(r)}function gE(e){var r=0;if(e.samplerBindings)for(var n=0;n<e.samplerBindings.length;n++){var i=e.samplerBindings[n];i!==null&&i.texture!==null&&(r=Io(r,i.texture.id))}if(e.uniformBufferBindings)for(var a=0;a<e.uniformBufferBindings.length;a++){var s=e.uniformBufferBindings[a];s!==null&&s.buffer!==null&&(r=Io(r,s.buffer.id),r=Io(r,s.binding),r=Io(r,s.offset),r=Io(r,s.size))}if(e.storageBufferBindings)for(var c=0;c<e.storageBufferBindings.length;c++){var d=e.storageBufferBindings[c];d!==null&&d.buffer!==null&&(r=Io(r,d.buffer.id),r=Io(r,d.binding),r=Io(r,d.offset),r=Io(r,d.size))}if(e.storageTextureBindings)for(var g=0;g<e.storageTextureBindings.length;g++){var _=e.storageTextureBindings[g];_!==null&&_.texture!==null&&(r=Io(r,_.texture.id),r=Io(r,_.binding))}return i0(r)}function yE(e,r){var n,i,a,s;return((n=e.vertex)===null||n===void 0?void 0:n.glsl)===((i=r.vertex)===null||i===void 0?void 0:i.glsl)&&((a=e.fragment)===null||a===void 0?void 0:a.glsl)===((s=r.fragment)===null||s===void 0?void 0:s.glsl)}function _E(e){var r,n;return{vertex:{glsl:(r=e.vertex)===null||r===void 0?void 0:r.glsl},fragment:{glsl:(n=e.fragment)===null||n===void 0?void 0:n.glsl}}}var xE=function(){function e(r){(0,Ue.Z)(this,e),(0,ue.Z)(this,"bindingsCache",new hm(fx,gE)),(0,ue.Z)(this,"renderPipelinesCache",new hm(vx,mE)),(0,ue.Z)(this,"inputLayoutsCache",new hm(yx,a0)),(0,ue.Z)(this,"programCache",new hm(yE,a0)),this.device=r}return(0,vt.Z)(e,[{key:"createBindings",value:function(n){var i=this.bindingsCache.get(n);if(i===null){var a,s=bx(n);s.uniformBufferBindings=(a=s.uniformBufferBindings)===null||a===void 0?void 0:a.filter(function(c){var d=c.size;return d&&d>0}),i=this.device.createBindings(s),this.bindingsCache.add(s,i)}return i}},{key:"createRenderPipeline",value:function(n){var i=this.renderPipelinesCache.get(n);if(i===null){var a=Ex(n);a.colorAttachmentFormats=a.colorAttachmentFormats.filter(function(s){return s}),i=this.device.createRenderPipeline(a),this.renderPipelinesCache.add(a,i)}return i}},{key:"createInputLayout",value:function(n){n.vertexBufferDescriptors=n.vertexBufferDescriptors.filter(function(s){return!!s});var i=this.inputLayoutsCache.get(n);if(i===null){var a=Ax(n);i=this.device.createInputLayout(a),this.inputLayoutsCache.add(a,i)}return i}},{key:"createProgram",value:function(n){var i=this.programCache.get(n);if(i===null){var a=_E(n);i=this.device.createProgram(n),this.programCache.add(a,i)}return i}},{key:"destroy",value:function(){var n=pm(this.bindingsCache.values()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.destroy()}}catch(we){n.e(we)}finally{n.f()}var s=pm(this.renderPipelinesCache.values()),c;try{for(s.s();!(c=s.n()).done;){var d=c.value;d.destroy()}}catch(we){s.e(we)}finally{s.f()}var g=pm(this.inputLayoutsCache.values()),_;try{for(g.s();!(_=g.n()).done;){var A=_.value;A.destroy()}}catch(we){g.e(we)}finally{g.f()}var C=pm(this.programCache.values()),N;try{for(C.s();!(N=C.n()).done;){var ae=N.value;ae.destroy()}}catch(we){C.e(we)}finally{C.f()}this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}}]),e}(),bE=function(){function e(r,n){(0,Ue.Z)(this,e);var i=n.data,a=n.type,s=n.count,c=s===void 0?0:s,d;fm(i)?d=i:d=new lm[this.type||Y.gl.UNSIGNED_INT](i),this.type=a,this.count=c,this.indexBuffer=r.createBuffer({viewOrSize:d,usage:$o.INDEX})}return(0,vt.Z)(e,[{key:"get",value:function(){return this.indexBuffer}},{key:"subData",value:function(n){var i=n.data,a;fm(i)?a=i:a=new lm[this.type||Y.gl.UNSIGNED_INT](i),this.indexBuffer.setSubData(0,new Uint8Array(a.buffer))}},{key:"destroy",value:function(){this.indexBuffer.destroy()}}]),e}();function u0(e){return!!(e&&e.texture)}var l0=function(){function e(r,n){(0,Ue.Z)(this,e),(0,ue.Z)(this,"isDestroy",!1),this.device=r,this.options=n;var i=n.wrapS,a=i===void 0?Y.gl.CLAMP_TO_EDGE:i,s=n.wrapT,c=s===void 0?Y.gl.CLAMP_TO_EDGE:s,d=n.aniso,g=n.mag,_=g===void 0?Y.gl.NEAREST:g,A=n.min,C=A===void 0?Y.gl.NEAREST:A;this.createTexture(n),this.sampler=r.createSampler({addressModeU:e0[a],addressModeV:e0[c],minFilter:C===Y.gl.NEAREST?$s.POINT:$s.BILINEAR,magFilter:_===Y.gl.NEAREST?$s.POINT:$s.BILINEAR,mipmapFilter:Bu.NO_MIP,maxAnisotropy:d})}return(0,vt.Z)(e,[{key:"createTexture",value:function(n){var i=n.type,a=i===void 0?Y.gl.UNSIGNED_BYTE:i,s=n.width,c=n.height,d=n.flipY,g=d===void 0?!1:d,_=n.format,A=_===void 0?Y.gl.RGBA:_,C=n.alignment,N=C===void 0?1:C,ae=n.usage,we=ae===void 0?Y.v2.SAMPLED:ae,De=n.unorm,at=De===void 0?!1:De,Ot=n.label,Pt=n.data;this.width=s,this.height=c;var Kt=nr.U8_RGBA_RT;if(a===Y.gl.UNSIGNED_BYTE&&A===Y.gl.RGBA)Kt=at?nr.U8_RGBA_NORM:nr.U8_RGBA_RT;else if(a===Y.gl.UNSIGNED_BYTE&&A===Y.gl.LUMINANCE)Kt=nr.U8_LUMINANCE;else if(a===Y.gl.FLOAT&&A===Y.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(Pt&&(Pt=uE(Pt,0)),Kt=nr.F32_RGBA):Kt=nr.F32_RGB;else if(a===Y.gl.FLOAT&&A===Y.gl.RGBA)Kt=nr.F32_RGBA;else if(a===Y.gl.FLOAT&&A===Y.gl.RED)Kt=nr.F32_R;else throw new Error("create texture error, type: ".concat(a,", format: ").concat(A));this.texture=this.device.createTexture({format:Kt,width:s,height:c,usage:we===Y.v2.SAMPLED?wl.SAMPLED:wl.RENDER_TARGET,pixelStore:{unpackFlipY:g,packAlignment:N},mipLevelCount:1}),Ot&&this.device.setResourceName(this.texture,Ot),Pt&&this.texture.setImageData([Pt])}},{key:"get",value:function(){return this.texture}},{key:"update",value:function(n){var i=n.data;this.texture.setImageData([i])}},{key:"bind",value:function(){}},{key:"resize",value:function(n){var i=n.width,a=n.height;(this.width!==i||this.height!==a)&&this.destroy(),this.options.width=i,this.options.height=a,this.createTexture(this.options),this.isDestroy=!1}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy&&!this.texture.destroyed){var n;(n=this.texture)===null||n===void 0||n.destroy()}this.isDestroy=!0}}]),e}(),c0=function(){function e(r,n){(0,Ue.Z)(this,e),this.device=r,this.options=n,this.createColorRenderTarget(),this.createDepthRenderTarget()}return(0,vt.Z)(e,[{key:"createColorRenderTarget",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.options,a=i.width,s=i.height,c=i.color;c&&(u0(c)?(n&&c.resize({width:a,height:s}),this.colorTexture=c.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=c.width,this.height=c.height):a&&s&&(this.colorTexture=this.device.createTexture({format:nr.U8_RGBA_RT,usage:wl.RENDER_TARGET,width:a,height:s}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=a,this.height=s))}},{key:"createDepthRenderTarget",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.options,a=i.width,s=i.height,c=i.depth;c&&(u0(c)?(n&&c.resize({width:a,height:s}),this.depthTexture=c.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=c.width,this.height=c.height):a&&s&&(this.depthTexture=this.device.createTexture({format:nr.D24_S8,usage:wl.RENDER_TARGET,width:a,height:s}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=a,this.height=s))}},{key:"get",value:function(){return this.colorRenderTarget}},{key:"destroy",value:function(){var n,i;(n=this.colorRenderTarget)===null||n===void 0||n.destroy(),(i=this.depthRenderTarget)===null||i===void 0||i.destroy()}},{key:"resize",value:function(n){var i=n.width,a=n.height;(this.width!==i||this.height!==a)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=i,this.options.height=a,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}}]),e}(),EE=ke.rU.isPlainObject,SE=ke.rU.isTypedArray,TE=function(){function e(r,n,i){var a=this;(0,Ue.Z)(this,e),(0,ue.Z)(this,"destroyed",!1),(0,ue.Z)(this,"uniforms",{}),(0,ue.Z)(this,"vertexBuffers",[]),this.device=r,this.options=n,this.service=i;var s=n.vs,c=n.fs,d=n.attributes,g=n.uniforms,_=n.count,A=n.elements,C=n.diagnosticDerivativeUniformityEnabled;this.options=n;var N=C?"":this.service.viewportOrigin===sh.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=i.renderCache.createProgram({vertex:{glsl:s},fragment:{glsl:c,postprocess:function(Ot){return N+Ot}}}),g&&(this.uniforms=this.extractUniforms(g));var ae=[],we=0;Object.keys(d).forEach(function(at){var Ot=d[at],Pt=Ot.get();a.vertexBuffers.push(Pt.get());var Kt=Ot.attribute,hr=Kt.offset,jr=hr===void 0?0:hr,pr=Kt.stride,rr=pr===void 0?0:pr,Ur=Kt.size,$n=Ur===void 0?1:Ur,Ai=Kt.divisor,Wn=Ai===void 0?0:Ai,Xi=Kt.shaderLocation,oa=Xi===void 0?0:Xi;ae.push({arrayStride:rr||$n*4,stepMode:wp.VERTEX,attributes:[{format:rE[$n],shaderLocation:oa,offset:jr,divisor:Wn}]}),we=Pt.size/$n}),_||(this.options.count=we),A&&(this.indexBuffer=A.get());var De=i.renderCache.createInputLayout({vertexBufferDescriptors:ae,indexBufferFormat:A?nr.U32_R:null,program:this.program});this.inputLayout=De,this.pipeline=this.createPipeline(n)}return(0,vt.Z)(e,[{key:"createPipeline",value:function(n,i){var a=n.primitive,s=a===void 0?Y.gl.TRIANGLES:a,c=n.depth,d=n.cull,g=n.blend,_=n.stencil,A=this.initDepthDrawParams({depth:c}),C=!!(A&&A.enable),N=this.initCullDrawParams({cull:d}),ae=!!(N&&N.enable),we=this.getBlendDrawParams({blend:g}),De=!!(we&&we.enable),at=this.getStencilDrawParams({stencil:_}),Ot=!!(at&&at.enable);return this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:tE[s],colorAttachmentFormats:[nr.U8_RGBA_RT],depthStencilAttachmentFormat:nr.D24_S8,megaStateDescriptor:{attachmentsState:[i?{channelWriteMask:rl.ALL,rgbBlendState:{blendMode:tl.ADD,blendSrcFactor:Ya.ONE,blendDstFactor:Ya.ZERO},alphaBlendState:{blendMode:tl.ADD,blendSrcFactor:Ya.ONE,blendDstFactor:Ya.ZERO}}:{channelWriteMask:Ot&&at.opFront.zpass===Bs.REPLACE?rl.NONE:rl.ALL,rgbBlendState:{blendMode:De&&we.equation.rgb||tl.ADD,blendSrcFactor:De&&we.func.srcRGB||Ya.SRC_ALPHA,blendDstFactor:De&&we.func.dstRGB||Ya.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:De&&we.equation.alpha||tl.ADD,blendSrcFactor:De&&we.func.srcAlpha||Ya.ONE,blendDstFactor:De&&we.func.dstAlpha||Ya.ONE}}],blendConstant:De?Xv:void 0,depthWrite:C,depthCompare:C&&A.func||Fa.LESS,cullMode:ae&&N.face||wc.NONE,stencilWrite:Ot,stencilFront:{compare:Ot?at.func.cmp:Fa.ALWAYS,passOp:at.opFront.zpass,failOp:at.opFront.fail,depthFailOp:at.opFront.zfail,mask:at.opFront.mask},stencilBack:{compare:Ot?at.func.cmp:Fa.ALWAYS,passOp:at.opBack.zpass,failOp:at.opBack.fail,depthFailOp:at.opBack.zfail,mask:at.opBack.mask}}})}},{key:"updateAttributesAndElements",value:function(){}},{key:"updateAttributes",value:function(){}},{key:"addUniforms",value:function(n){this.uniforms=(0,de.Z)((0,de.Z)({},this.uniforms),this.extractUniforms(n))}},{key:"draw",value:function(n,i){var a=this,s=(0,de.Z)((0,de.Z)({},this.options),n),c=s.count,d=c===void 0?0:c,g=s.instances,_=s.elements,A=s.uniforms,C=A===void 0?{}:A,N=s.uniformBuffers,ae=s.textures;this.uniforms=(0,de.Z)((0,de.Z)({},this.uniforms),this.extractUniforms(C));var we=this.service,De=we.renderPass,at=we.currentFramebuffer,Ot=we.width,Pt=we.height,Kt=we.renderCache;this.pipeline=this.createPipeline(s,i);var hr=this.service.device,jr=hr.swapChainHeight;if(hr.swapChainHeight=(at==null?void 0:at.height)||Pt,De.setViewport(0,0,(at==null?void 0:at.width)||Ot,(at==null?void 0:at.height)||Pt),hr.swapChainHeight=jr,De.setPipeline(this.pipeline),De.setStencilReference(1),De.setVertexInput(this.inputLayout,this.vertexBuffers.map(function(rr){return{buffer:rr}}),_?{buffer:this.indexBuffer,offset:0}:null),N&&(this.bindings=Kt.createBindings({pipeline:this.pipeline,uniformBufferBindings:N.map(function(rr,Ur){var $n=rr;return{binding:Ur,buffer:$n.get(),size:$n.size}}),samplerBindings:ae==null?void 0:ae.map(function(rr){return{texture:rr.texture,sampler:rr.sampler}})})),this.bindings&&(De.setBindings(this.bindings),Object.keys(this.uniforms).forEach(function(rr){var Ur=a.uniforms[rr];Ur instanceof l0?a.uniforms[rr]=Ur.get():Ur instanceof c0&&(a.uniforms[rr]=Ur.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),_){var pr=_.count;pr===0?De.draw(d,g):De.drawIndexed(pr,g)}else De.draw(d,g)}},{key:"destroy",value:function(){var n,i,a;this.program.destroy(),(n=this.vertexBuffers)===null||n===void 0||n.forEach(function(s){return s.destroy()}),(i=this.indexBuffer)===null||i===void 0||i.destroy(),(a=this.bindings)===null||a===void 0||a.destroy(),this.inputLayout.destroy(),this.pipeline.destroy(),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(n){var i=n.depth;if(i)return{enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:iE[i.func||Y.gl.LESS],range:i.range||[0,1]}}},{key:"getBlendDrawParams",value:function(n){var i=n.blend,a=i||{},s=a.enable,c=a.func,d=a.equation,g=a.color,_=g===void 0?[0,0,0,0]:g;return{enable:!!s,func:{srcRGB:cm[c&&c.srcRGB||Y.gl.SRC_ALPHA],srcAlpha:cm[c&&c.srcAlpha||Y.gl.SRC_ALPHA],dstRGB:cm[c&&c.dstRGB||Y.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:cm[c&&c.dstAlpha||Y.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:t0[d&&d.rgb||Y.gl.FUNC_ADD],alpha:t0[d&&d.alpha||Y.gl.FUNC_ADD]},color:_}}},{key:"getStencilDrawParams",value:function(n){var i=n.stencil,a=i||{},s=a.enable,c=a.mask,d=c===void 0?4294967295:c,g=a.func,_=g===void 0?{cmp:Y.gl.ALWAYS,ref:0,mask:4294967295}:g,A=a.opFront,C=A===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:A,N=a.opBack,ae=N===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:N;return{enable:!!s,mask:d,func:(0,de.Z)((0,de.Z)({},_),{},{cmp:oE[_.cmp]}),opFront:{fail:pd[C.fail],zfail:pd[C.zfail],zpass:pd[C.zpass],mask:_.mask},opBack:{fail:pd[ae.fail],zfail:pd[ae.zfail],zpass:pd[ae.zpass],mask:_.mask}}}},{key:"initCullDrawParams",value:function(n){var i=n.cull;if(i){var a=i.enable,s=i.face,c=s===void 0?Y.gl.BACK:s;return{enable:!!a,face:aE[c]}}}},{key:"extractUniforms",value:function(n){var i=this,a={};return Object.keys(n).forEach(function(s){i.extractUniformsRecursively(s,n[s],a,"")}),a}},{key:"extractUniformsRecursively",value:function(n,i,a,s){var c=this;if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||SE(i)||i===""||"resize"in i){a["".concat(s&&s+".").concat(n)]=i;return}EE(i)&&Object.keys(i).forEach(function(d){c.extractUniformsRecursively(d,i[d],a,"".concat(s&&s+".").concat(n))}),Array.isArray(i)&&i.forEach(function(d,g){Object.keys(d).forEach(function(_){c.extractUniformsRecursively(_,d[_],a,"".concat(s&&s+".").concat(n,"[").concat(g,"]"))})})}}]),e}();function AE(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}var dm=ke.rU.isUndefined,CE=function(){function e(){var r=this;(0,Ue.Z)(this,e),(0,ue.Z)(this,"uniformBuffers",[]),(0,ue.Z)(this,"queryVerdorInfo",function(){return r.device.queryVendorInfo().platformString}),(0,ue.Z)(this,"createModel",function(n){return new TE(r.device,n,r)}),(0,ue.Z)(this,"createAttribute",function(n){return new eE(r.device,n)}),(0,ue.Z)(this,"createBuffer",function(n){return new lE(r.device,n)}),(0,ue.Z)(this,"createElements",function(n){return new bE(r.device,n)}),(0,ue.Z)(this,"createTexture2D",function(n){return new l0(r.device,n)}),(0,ue.Z)(this,"createFramebuffer",function(n){return new c0(r.device,n)}),(0,ue.Z)(this,"useFramebuffer",function(n,i){r.currentFramebuffer=n,r.beginFrame(),i(),r.endFrame(),r.currentFramebuffer=null}),(0,ue.Z)(this,"useFramebufferAsync",function(){var n=(0,qe.Z)(Pe().mark(function i(a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return r.currentFramebuffer=a,r.preRenderPass=r.renderPass,r.beginFrame(),d.next=5,s();case 5:r.endFrame(),r.currentFramebuffer=null,r.renderPass=r.preRenderPass;case 8:case"end":return d.stop()}},i)}));return function(i,a){return n.apply(this,arguments)}}()),(0,ue.Z)(this,"clear",function(n){var i=n.color,a=n.depth,s=n.stencil,c=n.framebuffer,d=c===void 0?null:c;if(d)d.clearOptions={color:i,depth:a,stencil:s};else{var g=r.queryVerdorInfo();if(g==="WebGL1"){var _=r.getGLContext();dm(s)?dm(a)||(_.clearDepth(a),_.clear(_.DEPTH_BUFFER_BIT)):(_.clearStencil(s),_.clear(_.STENCIL_BUFFER_BIT))}else if(g==="WebGL2"){var A=r.getGLContext();dm(s)?dm(a)||A.clearBufferfv(A.DEPTH,0,[a]):A.clearBufferiv(A.STENCIL,0,[s])}}}),(0,ue.Z)(this,"viewport",function(n){var i=n.width,a=n.height;r.swapChain.configureSwapChain(i,a),r.createMainColorDepthRT(i,a),r.width=i,r.height=a}),(0,ue.Z)(this,"readPixels",function(n){var i=n.framebuffer,a=n.x,s=n.y,c=n.width,d=n.height,g=r.device.createReadback(),_=i.colorTexture,A=g.readTextureSync(_,a,r.viewportOrigin===sh.LOWER_LEFT?s:r.height-s,c,d,new Uint8Array(c*d*4));return g.destroy(),A}),(0,ue.Z)(this,"readPixelsAsync",function(){var n=(0,qe.Z)(Pe().mark(function i(a){var s,c,d,g,_,A,C,N,ae,we;return Pe().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return s=a.framebuffer,c=a.x,d=a.y,g=a.width,_=a.height,A=r.device.createReadback(),C=s.colorTexture,at.next=5,A.readTexture(C,c,r.viewportOrigin===sh.LOWER_LEFT?d:r.height-d,g,_,new Uint8Array(g*_*4));case 5:if(N=at.sent,r.viewportOrigin!==sh.LOWER_LEFT)for(ae=0;ae<N.length;ae+=4)we=N[ae],N[ae]=N[ae+2],N[ae+2]=we;return A.destroy(),at.abrupt("return",N);case 9:case"end":return at.stop()}},i)}));return function(i){return n.apply(this,arguments)}}()),(0,ue.Z)(this,"getViewportSize",function(){return{width:r.width,height:r.height}}),(0,ue.Z)(this,"getContainer",function(){var n;return(n=r.canvas)===null||n===void 0?void 0:n.parentElement}),(0,ue.Z)(this,"getCanvas",function(){return r.canvas}),(0,ue.Z)(this,"getGLContext",function(){return r.device.gl}),(0,ue.Z)(this,"destroy",function(){var n;r.canvas=null,(n=r.uniformBuffers)===null||n===void 0||n.forEach(function(i){i.destroy()}),r.device.destroy(),r.renderCache.destroy()})}return(0,vt.Z)(e,[{key:"init",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s){var c,d,g,_,A;return Pe().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return c=s.enableWebGPU,d=s.shaderCompilerPath,this.canvas=a,g=c?new Xb({shaderCompilerPath:d}):new ob({targets:["webgl2","webgl1"],onContextLost:function(we){console.warn("context lost",we)},onContextCreationError:function(we){console.warn("context creation error",we)},onContextRestored:function(we){console.warn("context restored",we)}}),N.next=5,g.createSwapChain(a);case 5:_=N.sent,_.configureSwapChain(a.width,a.height),this.device=_.getDevice(),this.swapChain=_,this.renderCache=new xE(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin,A=this.device.gl,this.extensionObject={OES_texture_float:!AE(A)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height);case 15:case"end":return N.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"createMainColorDepthRT",value:function(n,i){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:nr.U8_RGBA_RT,width:n,height:i,usage:wl.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:nr.D24_S8,width:n,height:i,usage:wl.RENDER_TARGET}))}},{key:"beginFrame",value:function(){this.device.beginFrame();var n=this.currentFramebuffer,i=this.swapChain,a=this.mainColorRT,s=this.mainDepthRT,c=n?n.colorRenderTarget:a,d=n?null:i.getOnscreenTexture(),g=n?n.depthRenderTarget:s,_=(n==null?void 0:n.clearOptions)||{},A=_.color,C=A===void 0?[0,0,0,0]:A,N=_.depth,ae=N===void 0?1:N,we=_.stencil,De=we===void 0?0:we,at=c?rv(C[0]*255,C[1]*255,C[2]*255,C[3]):Xv,Ot=g?ae:void 0,Pt=g?De:void 0,Kt=this.device.createRenderPass({colorAttachment:[c],colorResolveTo:[d],colorClearColor:[at],colorStore:[!0],depthStencilAttachment:g,depthClearValue:Ot,stencilClearValue:Pt});this.renderPass=Kt}},{key:"endFrame",value:function(){this.device.submitPass(this.renderPass),this.device.endFrame()}},{key:"getPointSizeRange",value:function(){var n=this.device.gl;return n.getParameter(n.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(n){return!!this.getGLContext().getExtension(n)}},{key:"setState",value:function(){}},{key:"setBaseState",value:function(){}},{key:"setCustomLayerDefaults",value:function(){}},{key:"setDirty",value:function(n){this.isDirty=n}},{key:"getDirty",value:function(){return this.isDirty}}]),e}();function wE(e){var r=RE();return function(){var i=(0,In.Z)(e),a;if(r){var s=(0,In.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function RE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hm=["selectstart","selecting","selectend"],ME=function(e){(0,Ei.Z)(n,e);var r=wE(n);function n(i){var a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,Ue.Z)(this,n),a=r.call(this),(0,ue.Z)((0,cn.Z)(a),"isEnable",!1),(0,ue.Z)((0,cn.Z)(a),"onDragStart",function(c){a.box.style.display="block",a.startEvent=a.endEvent=c,a.syncBoxBound(),a.emit("selectstart",a.getLngLatBox(),a.startEvent,a.endEvent)}),(0,ue.Z)((0,cn.Z)(a),"onDragging",function(c){a.endEvent=c,a.syncBoxBound(),a.emit("selecting",a.getLngLatBox(),a.startEvent,a.endEvent)}),(0,ue.Z)((0,cn.Z)(a),"onDragEnd",function(c){a.endEvent=c,a.box.style.display="none",a.emit("selectend",a.getLngLatBox(),a.startEvent,a.endEvent)}),a.scene=i,a.options=s,a}return(0,vt.Z)(n,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var a=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var s=ke.SO.create("div",void 0,this.container);s.classList.add("l7-select-box"),a&&s.classList.add(a),s.style.display="none",this.box=s}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var a=this.startEvent,s=a.x,c=a.y,d=this.endEvent,g=d.x,_=d.y,A=Math.min(s,g),C=Math.min(c,_),N=Math.abs(s-g),ae=Math.abs(c-_);this.box.style.top="".concat(C,"px"),this.box.style.left="".concat(A,"px"),this.box.style.width="".concat(N,"px"),this.box.style.height="".concat(ae,"px")}},{key:"getLngLatBox",value:function(){var a=this.startEvent.lngLat,s=a.lng,c=a.lat,d=this.endEvent.lngLat,g=d.lng,_=d.lat;return(0,ke.Ol)([[s,c],[g,_]])}}]),n}(ol.EventEmitter),OE=function(){function e(r){(0,Ue.Z)(this,e);var n=r.id,i=r.map,a=r.canvas,s=r.renderer,c=s===void 0?"regl":s,d=(0,Y.Hp)();this.container=d,i.setContainer(d,n,a),c==="regl"?d.rendererService=new Jb:d.rendererService=new CE,this.sceneService=d.sceneService,this.mapService=d.mapService,this.iconService=d.iconService,this.fontService=d.fontService,this.controlService=d.controlService,this.layerService=d.layerService,this.debugService=d.debugService,this.debugService.setEnable(r.debug),this.markerService=d.markerService,this.interactionService=d.interactionService,this.popupService=d.popupService,this.boxSelect=new ME(this,{}),this.initComponent(n),this.sceneService.init(r),this.initControl()}return(0,vt.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.sceneService.exportPng(a));case 1:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"exportMap",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a){return Pe().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.sceneService.exportPng(a));case 1:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"registerRenderService",value:function(n){var i=this;if(this.sceneService.loaded){var a=new n(this);a.init()}else this.on("loaded",function(){var s=new n(i);s.init()})}},{key:"setBgColor",value:function(n){this.mapService.setBgColor(n)}},{key:"addLayer",value:function(n){var i=this;this.loaded?this.preAddLayer(n):(console.log("layer not loaded"),this.once("loaded",function(){console.log("layer loaded"),i.preAddLayer(n)}))}},{key:"preAddLayer",value:function(n){var i=this,a=(0,Y.e7)(this.container);if(n.setContainer(a),this.sceneService.addLayer(n),n.inited){this.initTileLayer(n);var s=this.initMask(n);this.addMask(s,n.id)}else n.on("inited",function(){i.initTileLayer(n);var c=i.initMask(n);i.addMask(c,n.id)})}},{key:"initMask",value:function(n){var i=n.getLayerConfig(),a=i.mask,s=i.maskfence,c=i.maskColor,d=c===void 0?"#000":c,g=i.maskOpacity,_=g===void 0?0:g;if(!(!a||!s)){var A=new hg().source(s).shape("fill").style({color:d,opacity:_});return A}}},{key:"addMask",value:function(n,i){if(n){var a=this.getLayer(i);if(a){var s=(0,Y.e7)(this.container);n.setContainer(s),a.addMaskLayer(n),this.sceneService.addMask(n)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(n){return this.layerService.getLayer(n)}},{key:"getLayerByName",value:function(n){return this.layerService.getLayerByName(n)}},{key:"removeLayer",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.layerService.remove(a,s);case 2:case"end":return d.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"removeAllLayer",value:function(){var r=(0,qe.Z)(Pe().mark(function i(){return Pe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layerService.removeAllLayers();case 2:case"end":return s.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(n){this.layerService.setEnableRender(n)}},{key:"addIconFont",value:function(n,i){this.fontService.addIconFont(n,i)}},{key:"addIconFonts",value:function(n){var i=this;n.forEach(function(a){var s=(0,ji.Z)(a,2),c=s[0],d=s[1];i.fontService.addIconFont(c,d)})}},{key:"addFontFace",value:function(n,i){var a=this;this.fontService.once("fontloaded",function(s){a.emit("fontloaded",s)}),this.fontService.addFontFace(n,i)}},{key:"addImage",value:function(){var r=(0,qe.Z)(Pe().mark(function i(a,s){return Pe().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.iconService.addImage(a,s);case 2:case"end":return d.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"hasImage",value:function(n){return this.iconService.hasImage(n)}},{key:"removeImage",value:function(n){this.iconService.removeImage(n)}},{key:"addIconFontGlyphs",value:function(n,i){this.fontService.addIconGlyphs(i)}},{key:"addControl",value:function(n){this.controlService.addControl(n,this.container)}},{key:"removeControl",value:function(n){this.controlService.removeControl(n)}},{key:"getControlByName",value:function(n){return this.controlService.getControlByName(n)}},{key:"addMarker",value:function(n){this.markerService.addMarker(n)}},{key:"addMarkerLayer",value:function(n){this.markerService.addMarkerLayer(n)}},{key:"removeMarkerLayer",value:function(n){this.markerService.removeMarkerLayer(n)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(n){this.popupService.addPopup(n)}},{key:"removePopup",value:function(n){this.popupService.removePopup(n)}},{key:"on",value:function(n,i){if(Hm.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.on(n,i)}else Y.P7.includes(n)?this.sceneService.on(n,i):this.mapService.on(n,i)}},{key:"once",value:function(n,i){if(Hm.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.once(n,i)}else Y.P7.includes(n)?this.sceneService.once(n,i):this.mapService.once(n,i)}},{key:"emit",value:function(n,i){Y.P7.indexOf(n)===-1?this.mapService.on(n,i):this.sceneService.emit(n,i)}},{key:"off",value:function(n,i){if(Hm.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.off(n,i)}else Y.P7.includes(n)?this.sceneService.off(n,i):this.mapService.off(n,i)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(n){return this.mapService.getCenter(n)}},{key:"setCenter",value:function(n,i){return this.mapService.setCenter(n,i)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(n){return this.mapService.setPitch(n)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(n){this.mapService.setRotation(n)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(n){this.mapService.panTo(n)}},{key:"panBy",value:function(n,i){this.mapService.panBy(n,i)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(n){this.mapService.setZoom(n)}},{key:"fitBounds",value:function(n,i){var a=this.sceneService.getSceneConfig(),s=a.fitBoundsOptions,c=a.animate;this.mapService.fitBounds(n,i||(0,de.Z)((0,de.Z)({},s),{},{animate:c}))}},{key:"setZoomAndCenter",value:function(n,i){this.mapService.setZoomAndCenter(n,i)}},{key:"setMapStyle",value:function(n){this.mapService.setMapStyle(n)}},{key:"setMapStatus",value:function(n){this.mapService.setMapStatus(n)}},{key:"pixelToLngLat",value:function(n){return this.mapService.pixelToLngLat(n)}},{key:"lngLatToPixel",value:function(n){return this.mapService.lngLatToPixel(n)}},{key:"containerToLngLat",value:function(n){return this.mapService.containerToLngLat(n)}},{key:"lngLatToContainer",value:function(n){return this.mapService.lngLatToContainer(n)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(n){this.container.postProcessingPass.name=new n}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),i&&this.boxSelect.once("selectend",function(){n.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getProtocol",value:function(n){return ke.SA.REGISTERED_PROTOCOLS[n]}},{key:"startAnimate",value:function(){this.layerService.startAnimate()}},{key:"stopAnimate",value:function(){this.layerService.stopAnimate()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(n){this.controlService.init({container:ke.SO.getContainer(n)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var n=this.sceneService.getSceneConfig(),i=n.logoVisible,a=n.logoPosition;i&&this.addControl(new yc({position:a}))}},{key:"initTileLayer",value:function(n){n.getSource().isTile&&(n.tileLayer=new M1(n))}}],[{key:"addProtocol",value:function(n,i){ke.SA.REGISTERED_PROTOCOLS[n]=i}},{key:"removeProtocol",value:function(n){delete ke.SA.REGISTERED_PROTOCOLS[n]}}]),e}(),p2="2.21.0"},131:function(He,w,x){"use strict";x.r(w),x.d(w,{TinyColor:function(){return F.C},bounds:function(){return We},convertDecimalToHex:function(){return X.Wl},convertHexToDecimal:function(){return X.T6},default:function(){return Ze},fromRatio:function(){return J},hslToRgb:function(){return X.ve},hsvToRgb:function(){return X.WE},inputToRGB:function(){return B.uA},isReadable:function(){return D},isValidCSSUnit:function(){return B.ky},legacyRandom:function(){return Be},mostReadable:function(){return P},names:function(){return z.R},numberInputToObject:function(){return X.Yt},parseIntFromHex:function(){return X.VD},random:function(){return ee},readability:function(){return h},rgbToHex:function(){return X.vq},rgbToHsl:function(){return X.lC},rgbToHsv:function(){return X.py},rgbToRgb:function(){return X.rW},rgbaToArgbHex:function(){return X.GC},rgbaToHex:function(){return X.s},stringInputToObject:function(){return B.uz},tinycolor:function(){return F.H},toMsFilter:function(){return W}});var F=x(10274),z=x(48701);function h(pe,se){var be=new F.C(pe),Te=new F.C(se);return(Math.max(be.getLuminance(),Te.getLuminance())+.05)/(Math.min(be.getLuminance(),Te.getLuminance())+.05)}function D(pe,se,be){var Te,de;be===void 0&&(be={level:"AA",size:"small"});var Rt=h(pe,se);switch(((Te=be.level)!==null&&Te!==void 0?Te:"AA")+((de=be.size)!==null&&de!==void 0?de:"small")){case"AAsmall":case"AAAlarge":return Rt>=4.5;case"AAlarge":return Rt>=3;case"AAAsmall":return Rt>=7;default:return!1}}function P(pe,se,be){be===void 0&&(be={includeFallbackColors:!1,level:"AA",size:"small"});for(var Te=null,de=0,Rt=be.includeFallbackColors,ye=be.level,Ve=be.size,oe=0,Re=se;oe<Re.length;oe++){var Se=Re[oe],et=h(pe,Se);et>de&&(de=et,Te=new F.C(Se))}return D(pe,Te,{level:ye,size:Ve})||!Rt?Te:(be.includeFallbackColors=!1,P(pe,["#fff","#000"],be))}var X=x(86500);function W(pe,se){var be=new F.C(pe),Te="#"+(0,X.GC)(be.r,be.g,be.b,be.a),de=Te,Rt=be.gradientType?"GradientType = 1, ":"";if(se){var ye=new F.C(se);de="#"+(0,X.GC)(ye.r,ye.g,ye.b,ye.a)}return"progid:DXImageTransform.Microsoft.gradient(".concat(Rt,"startColorstr=").concat(Te,",endColorstr=").concat(de,")")}var fe=x(90279);function J(pe,se){var be={r:(0,fe.JX)(pe.r),g:(0,fe.JX)(pe.g),b:(0,fe.JX)(pe.b)};return pe.a!==void 0&&(be.a=Number(pe.a)),new F.C(be,se)}function Be(){return new F.C({r:Math.random(),g:Math.random(),b:Math.random()})}var B=x(1350);function ee(pe){if(pe===void 0&&(pe={}),pe.count!==void 0&&pe.count!==null){var se=pe.count,be=[];for(pe.count=void 0;se>be.length;)pe.count=null,pe.seed&&(pe.seed+=1),be.push(ee(pe));return pe.count=se,be}var Te=U(pe.hue,pe.seed),de=q(Te,pe),Rt=le(Te,de,pe),ye={h:Te,s:de,v:Rt};return pe.alpha!==void 0&&(ye.a=pe.alpha),new F.C(ye)}function U(pe,se){var be=Ce(pe),Te=Fe(be,se);return Te<0&&(Te=360+Te),Te}function q(pe,se){if(se.hue==="monochrome")return 0;if(se.luminosity==="random")return Fe([0,100],se.seed);var be=$e(pe).saturationRange,Te=be[0],de=be[1];switch(se.luminosity){case"bright":Te=55;break;case"dark":Te=de-10;break;case"light":de=55;break;default:break}return Fe([Te,de],se.seed)}function le(pe,se,be){var Te=j(pe,se),de=100;switch(be.luminosity){case"dark":de=Te+20;break;case"light":Te=(de+Te)/2;break;case"random":Te=0,de=100;break;default:break}return Fe([Te,de],be.seed)}function j(pe,se){for(var be=$e(pe).lowerBounds,Te=0;Te<be.length-1;Te++){var de=be[Te][0],Rt=be[Te][1],ye=be[Te+1][0],Ve=be[Te+1][1];if(se>=de&&se<=ye){var oe=(Ve-Rt)/(ye-de),Re=Rt-oe*de;return oe*se+Re}}return 0}function Ce(pe){var se=parseInt(pe,10);if(!Number.isNaN(se)&&se<360&&se>0)return[se,se];if(typeof pe=="string"){var be=We.find(function(ye){return ye.name===pe});if(be){var Te=lt(be);if(Te.hueRange)return Te.hueRange}var de=new F.C(pe);if(de.isValid){var Rt=de.toHsv().h;return[Rt,Rt]}}return[0,360]}function $e(pe){pe>=334&&pe<=360&&(pe-=360);for(var se=0,be=We;se<be.length;se++){var Te=be[se],de=lt(Te);if(de.hueRange&&pe>=de.hueRange[0]&&pe<=de.hueRange[1])return de}throw Error("Color not found")}function Fe(pe,se){if(se===void 0)return Math.floor(pe[0]+Math.random()*(pe[1]+1-pe[0]));var be=pe[1]||1,Te=pe[0]||0;se=(se*9301+49297)%233280;var de=se/233280;return Math.floor(Te+de*(be-Te))}function lt(pe){var se=pe.lowerBounds[0][0],be=pe.lowerBounds[pe.lowerBounds.length-1][0],Te=pe.lowerBounds[pe.lowerBounds.length-1][1],de=pe.lowerBounds[0][1];return{name:pe.name,hueRange:pe.hueRange,lowerBounds:pe.lowerBounds,saturationRange:[se,be],brightnessRange:[Te,de]}}var We=[{name:"monochrome",hueRange:null,lowerBounds:[[0,0],[100,0]]},{name:"red",hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]},{name:"orange",hueRange:[19,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]},{name:"yellow",hueRange:[47,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]},{name:"green",hueRange:[63,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]},{name:"blue",hueRange:[179,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]},{name:"purple",hueRange:[258,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]},{name:"pink",hueRange:[283,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]}],Ze=F.H},38163:function(He){He.exports=w;function w(z,h){var D=z&&z.type,P;if(D==="FeatureCollection")for(P=0;P<z.features.length;P++)w(z.features[P],h);else if(D==="GeometryCollection")for(P=0;P<z.geometries.length;P++)w(z.geometries[P],h);else if(D==="Feature")w(z.geometry,h);else if(D==="Polygon")x(z.coordinates,h);else if(D==="MultiPolygon")for(P=0;P<z.coordinates.length;P++)x(z.coordinates[P],h);return z}function x(z,h){if(z.length!==0){F(z[0],h);for(var D=1;D<z.length;D++)F(z[D],!h)}}function F(z,h){for(var D=0,P=0,X=0,W=z.length,fe=W-1;X<W;fe=X++){var J=(z[X][0]-z[fe][0])*(z[fe][1]+z[X][1]),Be=D+J;P+=Math.abs(D)>=Math.abs(J)?D-Be+J:J-Be+D,D=Be}D+P>=0!=!!h&&z.reverse()}},75550:function(He){"use strict";He.exports=w;function w(x,F){this.x=x,this.y=F}w.prototype={clone:function(){return new w(this.x,this.y)},add:function(x){return this.clone()._add(x)},sub:function(x){return this.clone()._sub(x)},multByPoint:function(x){return this.clone()._multByPoint(x)},divByPoint:function(x){return this.clone()._divByPoint(x)},mult:function(x){return this.clone()._mult(x)},div:function(x){return this.clone()._div(x)},rotate:function(x){return this.clone()._rotate(x)},rotateAround:function(x,F){return this.clone()._rotateAround(x,F)},matMult:function(x){return this.clone()._matMult(x)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(x){return this.x===x.x&&this.y===x.y},dist:function(x){return Math.sqrt(this.distSqr(x))},distSqr:function(x){var F=x.x-this.x,z=x.y-this.y;return F*F+z*z},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(x){return Math.atan2(this.y-x.y,this.x-x.x)},angleWith:function(x){return this.angleWithSep(x.x,x.y)},angleWithSep:function(x,F){return Math.atan2(this.x*F-this.y*x,this.x*x+this.y*F)},_matMult:function(x){var F=x[0]*this.x+x[1]*this.y,z=x[2]*this.x+x[3]*this.y;return this.x=F,this.y=z,this},_add:function(x){return this.x+=x.x,this.y+=x.y,this},_sub:function(x){return this.x-=x.x,this.y-=x.y,this},_mult:function(x){return this.x*=x,this.y*=x,this},_div:function(x){return this.x/=x,this.y/=x,this},_multByPoint:function(x){return this.x*=x.x,this.y*=x.y,this},_divByPoint:function(x){return this.x/=x.x,this.y/=x.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var x=this.y;return this.y=this.x,this.x=-x,this},_rotate:function(x){var F=Math.cos(x),z=Math.sin(x),h=F*this.x-z*this.y,D=z*this.x+F*this.y;return this.x=h,this.y=D,this},_rotateAround:function(x,F){var z=Math.cos(x),h=Math.sin(x),D=F.x+z*(this.x-F.x)-h*(this.y-F.y),P=F.y+h*(this.x-F.x)+z*(this.y-F.y);return this.x=D,this.y=P,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},w.convert=function(x){return x instanceof w?x:Array.isArray(x)?new w(x[0],x[1]):x}},49296:function(He){"use strict";He.exports=x,He.exports.default=x;var w=1e20;function x(P,X,W,fe,J,Be){this.fontSize=P||24,this.buffer=X===void 0?3:X,this.cutoff=fe||.25,this.fontFamily=J||"sans-serif",this.fontWeight=Be||"normal",this.radius=W||8;var B=this.size=this.fontSize+this.buffer*2,ee=B+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=B,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ee*ee),this.gridInner=new Float64Array(ee*ee),this.f=new Float64Array(ee),this.z=new Float64Array(ee+1),this.v=new Uint16Array(ee),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(B/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function F(P,X,W,fe,J,Be,B){Be.fill(w,0,X*W),B.fill(0,0,X*W);for(var ee=(X-fe)/2,U=0;U<J;U++)for(var q=0;q<fe;q++){var le=(U+ee)*X+q+ee,j=P.data[4*(U*fe+q)+3]/255;if(j===1)Be[le]=0,B[le]=w;else if(j===0)Be[le]=w,B[le]=0;else{var Ce=Math.max(0,.5-j),$e=Math.max(0,j-.5);Be[le]=Ce*Ce,B[le]=$e*$e}}}function z(P,X,W,fe,J,Be,B){for(var ee=0;ee<X*W;ee++){var U=Math.sqrt(fe[ee])-Math.sqrt(J[ee]);P[ee]=Math.round(255-255*(U/Be+B))}}x.prototype._draw=function(P,X){var W=this.ctx.measureText(P),fe=W.width,J=2*this.buffer,Be,B,ee,U,q,le,j,Ce;X&&this.useMetrics?(q=Math.floor(W.actualBoundingBoxAscent),Ce=this.buffer+Math.ceil(W.actualBoundingBoxAscent),le=this.buffer,j=this.buffer,B=Math.min(this.size,Math.ceil(W.actualBoundingBoxRight-W.actualBoundingBoxLeft)),U=Math.min(this.size-le,Math.ceil(W.actualBoundingBoxAscent+W.actualBoundingBoxDescent)),Be=B+J,ee=U+J,this.ctx.textBaseline="alphabetic"):(Be=B=this.size,ee=U=this.size,q=19*this.fontSize/24,le=j=0,Ce=this.middle,this.ctx.textBaseline="middle");var $e;B&&U&&(this.ctx.clearRect(j,le,B,U),this.ctx.fillText(P,this.buffer,Ce),$e=this.ctx.getImageData(j,le,B,U));var Fe=new Uint8ClampedArray(Be*ee);return F($e,Be,ee,B,U,this.gridOuter,this.gridInner),h(this.gridOuter,Be,ee,this.f,this.v,this.z),h(this.gridInner,Be,ee,this.f,this.v,this.z),z(Fe,Be,ee,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Fe,metrics:{width:B,height:U,sdfWidth:Be,sdfHeight:ee,top:q,left:0,advance:fe}}},x.prototype.draw=function(P){return this._draw(P,!1).data},x.prototype.drawWithMetrics=function(P){return this._draw(P,!0)};function h(P,X,W,fe,J,Be){for(var B=0;B<X;B++)D(P,B,X,W,fe,J,Be);for(var ee=0;ee<W;ee++)D(P,ee*X,1,X,fe,J,Be)}function D(P,X,W,fe,J,Be,B){var ee,U,q,le;for(Be[0]=0,B[0]=-w,B[1]=w,ee=0;ee<fe;ee++)J[ee]=P[X+ee*W];for(ee=1,U=0,q=0;ee<fe;ee++){do le=Be[U],q=(J[ee]-J[le]+ee*ee-le*le)/(ee-le)/2;while(q<=B[U]&&--U>-1);U++,Be[U]=ee,B[U]=q,B[U+1]=w}for(ee=0,U=0;ee<fe;ee++){for(;B[U+1]<ee;)U++;le=Be[U],P[X+ee*W]=J[le]+(ee-le)*(ee-le)}}},38929:function(He,w,x){He.exports.VectorTile=x(22779),x(66024),x(59701)},22779:function(He,w,x){"use strict";var F=x(59701);He.exports=z;function z(D,P){this.layers=D.readFields(h,{},P)}function h(D,P,X){if(D===3){var W=new F(X,X.readVarint()+X.pos);W.length&&(P[W.name]=W)}}},66024:function(He,w,x){"use strict";var F=x(75550);He.exports=z;function z(W,fe,J,Be,B){this.properties={},this.extent=J,this.type=0,this._pbf=W,this._geometry=-1,this._keys=Be,this._values=B,W.readFields(h,this,fe)}function h(W,fe,J){W==1?fe.id=J.readVarint():W==2?D(J,fe):W==3?fe.type=J.readVarint():W==4&&(fe._geometry=J.pos)}function D(W,fe){for(var J=W.readVarint()+W.pos;W.pos<J;){var Be=fe._keys[W.readVarint()],B=fe._values[W.readVarint()];fe.properties[Be]=B}}z.types=["Unknown","Point","LineString","Polygon"],z.prototype.loadGeometry=function(){var W=this._pbf;W.pos=this._geometry;for(var fe=W.readVarint()+W.pos,J=1,Be=0,B=0,ee=0,U=[],q;W.pos<fe;){if(Be<=0){var le=W.readVarint();J=le&7,Be=le>>3}if(Be--,J===1||J===2)B+=W.readSVarint(),ee+=W.readSVarint(),J===1&&(q&&U.push(q),q=[]),q.push(new F(B,ee));else if(J===7)q&&q.push(q[0].clone());else throw new Error("unknown command "+J)}return q&&U.push(q),U},z.prototype.bbox=function(){var W=this._pbf;W.pos=this._geometry;for(var fe=W.readVarint()+W.pos,J=1,Be=0,B=0,ee=0,U=1/0,q=-1/0,le=1/0,j=-1/0;W.pos<fe;){if(Be<=0){var Ce=W.readVarint();J=Ce&7,Be=Ce>>3}if(Be--,J===1||J===2)B+=W.readSVarint(),ee+=W.readSVarint(),B<U&&(U=B),B>q&&(q=B),ee<le&&(le=ee),ee>j&&(j=ee);else if(J!==7)throw new Error("unknown command "+J)}return[U,le,q,j]},z.prototype.toGeoJSON=function(W,fe,J){var Be=this.extent*Math.pow(2,J),B=this.extent*W,ee=this.extent*fe,U=this.loadGeometry(),q=z.types[this.type],le,j;function Ce(lt){for(var We=0;We<lt.length;We++){var Ze=lt[We],pe=180-(Ze.y+ee)*360/Be;lt[We]=[(Ze.x+B)*360/Be-180,360/Math.PI*Math.atan(Math.exp(pe*Math.PI/180))-90]}}switch(this.type){case 1:var $e=[];for(le=0;le<U.length;le++)$e[le]=U[le][0];U=$e,Ce(U);break;case 2:for(le=0;le<U.length;le++)Ce(U[le]);break;case 3:for(U=P(U),le=0;le<U.length;le++)for(j=0;j<U[le].length;j++)Ce(U[le][j]);break}U.length===1?U=U[0]:q="Multi"+q;var Fe={type:"Feature",geometry:{type:q,coordinates:U},properties:this.properties};return"id"in this&&(Fe.id=this.id),Fe};function P(W){var fe=W.length;if(fe<=1)return[W];for(var J=[],Be,B,ee=0;ee<fe;ee++){var U=X(W[ee]);U!==0&&(B===void 0&&(B=U<0),B===U<0?(Be&&J.push(Be),Be=[W[ee]]):Be.push(W[ee]))}return Be&&J.push(Be),J}function X(W){for(var fe=0,J=0,Be=W.length,B=Be-1,ee,U;J<Be;B=J++)ee=W[J],U=W[B],fe+=(U.x-ee.x)*(ee.y+U.y);return fe}},59701:function(He,w,x){"use strict";var F=x(66024);He.exports=z;function z(P,X){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=P,this._keys=[],this._values=[],this._features=[],P.readFields(h,this,X),this.length=this._features.length}function h(P,X,W){P===15?X.version=W.readVarint():P===1?X.name=W.readString():P===5?X.extent=W.readVarint():P===2?X._features.push(W.pos):P===3?X._keys.push(W.readString()):P===4&&X._values.push(D(W))}function D(P){for(var X=null,W=P.readVarint()+P.pos;P.pos<W;){var fe=P.readVarint()>>3;X=fe===1?P.readString():fe===2?P.readFloat():fe===3?P.readDouble():fe===4?P.readVarint64():fe===5?P.readVarint():fe===6?P.readSVarint():fe===7?P.readBoolean():null}return X}z.prototype.feature=function(P){if(P<0||P>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[P];var X=this._pbf.readVarint()+this._pbf.pos;return new F(this._pbf,X,this.extent,this._keys,this._values)}},45471:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.PresetStatusColorTypes=void 0,w.isPresetColor=X,w.isPresetStatusColor=W;var z=F(x(861)),h=x(36496);const D=h.PresetColors.map(fe=>`${fe}-inverse`),P=w.PresetStatusColorTypes=["success","processing","error","default","warning"];function X(fe){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat((0,z.default)(D),(0,z.default)(h.PresetColors)).includes(fe):h.PresetColors.includes(fe)}function W(fe){return P.includes(fe)}},49314:function(He,w,x){"use strict";"use client";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294)),h=F(x(43273));const D=X=>{let W;return typeof X=="object"&&(X!=null&&X.clearIcon)?W=X:X&&(W={clearIcon:z.default.createElement(h.default,null)}),W};var P=w.default=D},56333:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.containerBaseZIndexOffset=w.consumerBaseZIndexOffset=w.CONTAINER_MAX_OFFSET=void 0,w.useZIndex=B;var z=F(x(67294)),h=F(x(41401)),D=F(x(96877));const P=100,X=10,W=w.CONTAINER_MAX_OFFSET=P*X,fe=w.containerBaseZIndexOffset={Modal:P,Drawer:P,Popover:P,Popconfirm:P,Tooltip:P,Tour:P},J=w.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function Be(ee){return ee in fe}function B(ee,U){const[,q]=(0,h.default)(),le=z.default.useContext(D.default),j=Be(ee);if(U!==void 0)return[U,U];let Ce=le!=null?le:0;return j?(Ce+=(le?0:q.zIndexPopupBase)+fe[ee],Ce=Math.min(Ce,q.zIndexPopupBase+W)):Ce+=J[ee],[le===void 0?U:Ce,Ce]}},53683:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.getTransitionName=w.default=void 0;const x=()=>({height:0,opacity:0}),F=fe=>{const{scrollHeight:J}=fe;return{height:J,opacity:1}},z=fe=>({height:fe?fe.offsetHeight:0}),h=(fe,J)=>(J==null?void 0:J.deadline)===!0||J.propertyName==="height",D=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:x,onEnterStart:x,onAppearActive:F,onEnterActive:F,onLeaveStart:z,onLeaveActive:x,onAppearEnd:h,onEnterEnd:h,onLeaveEnd:h,motionDeadline:500}},P=null,X=(fe,J,Be)=>Be!==void 0?Be:`${fe}-${J}`;w.getTransitionName=X;var W=w.default=D},74132:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=X,w.getOverflowOptions=z;var F=x(9064);function z(W,fe,J,Be){if(Be===!1)return{adjustX:!1,adjustY:!1};const B=Be&&typeof Be=="object"?Be:{},ee={};switch(W){case"top":case"bottom":ee.shiftX=fe.arrowOffsetHorizontal*2+J,ee.shiftY=!0,ee.adjustY=!0;break;case"left":case"right":ee.shiftY=fe.arrowOffsetVertical*2+J,ee.shiftX=!0,ee.adjustX=!0;break}const U=Object.assign(Object.assign({},ee),B);return U.shiftX||(U.adjustX=!0),U.shiftY||(U.adjustY=!0),U}const h={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},D={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},P=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function X(W){const{arrowWidth:fe,autoAdjustOverflow:J,arrowPointAtCenter:Be,offset:B,borderRadius:ee,visibleFirst:U}=W,q=fe/2,le={};return Object.keys(h).forEach(j=>{const Ce=Be&&D[j]||h[j],$e=Object.assign(Object.assign({},Ce),{offset:[0,0],dynamicInset:!0});switch(le[j]=$e,P.has(j)&&($e.autoArrow=!1),j){case"top":case"topLeft":case"topRight":$e.offset[1]=-q-B;break;case"bottom":case"bottomLeft":case"bottomRight":$e.offset[1]=q+B;break;case"left":case"leftTop":case"leftBottom":$e.offset[0]=-q-B;break;case"right":case"rightTop":case"rightBottom":$e.offset[0]=q+B;break}const Fe=(0,F.getArrowOffsetToken)({contentRadius:ee,limitVerticalRadius:!0});if(Be)switch(j){case"topLeft":case"bottomLeft":$e.offset[0]=-Fe.arrowOffsetHorizontal-q;break;case"topRight":case"bottomRight":$e.offset[0]=Fe.arrowOffsetHorizontal+q;break;case"leftTop":case"rightTop":$e.offset[1]=-Fe.arrowOffsetHorizontal-q;break;case"leftBottom":case"rightBottom":$e.offset[1]=Fe.arrowOffsetHorizontal+q;break}$e.overflow=z(j,Fe,fe,J),U&&($e.htmlRegion="visibleFirst")}),le}},47419:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.cloneElement=P,w.isFragment=h,w.replaceElement=void 0;var z=F(x(67294));function h(X){return X&&z.default.isValidElement(X)&&X.type===z.default.Fragment}const D=(X,W,fe)=>z.default.isValidElement(X)?z.default.cloneElement(X,typeof fe=="function"?fe(X.props||{}):fe):W;w.replaceElement=D;function P(X,W){return D(X,X,W)}},71434:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.getMergedStatus=void 0,w.getStatusClassNames=D;var z=F(x(93967));const h=null;function D(X,W,fe){return(0,z.default)({[`${X}-status-success`]:W==="success",[`${X}-status-warning`]:W==="warning",[`${X}-status-error`]:W==="error",[`${X}-status-validating`]:W==="validating",[`${X}-has-feedback`]:fe})}const P=(X,W)=>W||X;w.getMergedStatus=P},38882:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.canUseDocElement=void 0,Object.defineProperty(w,"isStyleSupport",{enumerable:!0,get:function(){return h.isStyleSupport}});var z=F(x(19158)),h=x(3481);const D=()=>(0,z.default)()&&window.document.documentElement;w.canUseDocElement=D},60938:function(He,w,x){"use strict";"use client";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(27712)),D=F(x(67294)),P=function(J,Be){var B={};for(var ee in J)Object.prototype.hasOwnProperty.call(J,ee)&&Be.indexOf(ee)<0&&(B[ee]=J[ee]);if(J!=null&&typeof Object.getOwnPropertySymbols=="function")for(var U=0,ee=Object.getOwnPropertySymbols(J);U<ee.length;U++)Be.indexOf(ee[U])<0&&Object.prototype.propertyIsEnumerable.call(J,ee[U])&&(B[ee[U]]=J[ee[U]]);return B};const X={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},W=D.forwardRef((J,Be)=>{const B=$e=>{const{keyCode:Fe}=$e;Fe===h.default.ENTER&&$e.preventDefault()},ee=$e=>{const{keyCode:Fe}=$e,{onClick:lt}=J;Fe===h.default.ENTER&&lt&&lt()},{style:U,noStyle:q,disabled:le}=J,j=P(J,["style","noStyle","disabled"]);let Ce={};return q||(Ce=Object.assign({},X)),le&&(Ce.pointerEvents="none"),Ce=Object.assign(Object.assign({},Ce),U),D.createElement("div",Object.assign({role:"button",tabIndex:0,ref:Be},j,{onKeyDown:B,onKeyUp:ee,style:Ce}))});var fe=w.default=W},13594:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.devUseWarning=w.default=w.WarningContext=void 0,w.noop=D,w.resetWarned=X;var z=F(x(67294)),h=F(x(45520));function D(){}let P=null;function X(){P=null,(0,h.resetWarned)()}let W=D;const fe=w.WarningContext=z.createContext({}),J=w.devUseWarning=()=>{const B=()=>{};return B.deprecated=D,B};var Be=w.default=W},96877:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294));const h=z.default.createContext(void 0);var D=w.default=h},1028:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(25633)),h=w.default=z.default},93319:function(He,w,x){"use strict";"use client";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=w.DisabledContextProvider=void 0;var z=F(x(67294));const h=z.createContext(!1),D=X=>{let{children:W,disabled:fe}=X;const J=z.useContext(h);return z.createElement(h.Provider,{value:fe!=null?fe:J},W)};w.DisabledContextProvider=D;var P=w.default=h},16722:function(He,w,x){"use strict";"use client";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=P;var z=x(82225),h=F(x(67294)),D=x(3184);function P(X){const{children:W}=X,[,fe]=(0,D.useToken)(),{motion:J}=fe,Be=h.useRef(!1);return Be.current=Be.current||J===!1,Be.current?h.createElement(z.Provider,{motion:J},W):W}},11380:function(He,w,x){"use strict";"use client";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294)),h=x(13594);const D=null;var P=w.default=()=>null},3236:function(He,w,x){"use strict";"use client";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=w.SizeContextProvider=void 0;var z=F(x(67294));const h=z.createContext(void 0),D=X=>{let{children:W,size:fe}=X;const J=z.useContext(h);return z.createElement(h.Provider,{value:fe||J},W)};w.SizeContextProvider=D;var P=w.default=h},7177:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.defaultIconPrefixCls=w.ConfigContext=w.ConfigConsumer=void 0;var z=F(x(67294));const h=w.defaultIconPrefixCls="anticon",D=(W,fe)=>fe||(W?`ant-${W}`:"ant"),P=w.ConfigContext=z.createContext({getPrefixCls:D,iconPrefixCls:h}),{Consumer:X}=P;w.ConfigConsumer=X},56301:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.getStyle=fe,w.registerTheme=J;var z=x(78589),h=x(131),D=F(x(19158)),P=x(93399),X=F(x(13594));const W=`-ant-${Date.now()}-${Math.random()}`;function fe(Be,B){const ee={},U=(j,Ce)=>{let $e=j.clone();return $e=(Ce==null?void 0:Ce($e))||$e,$e.toRgbString()},q=(j,Ce)=>{const $e=new h.TinyColor(j),Fe=(0,z.generate)($e.toRgbString());ee[`${Ce}-color`]=U($e),ee[`${Ce}-color-disabled`]=Fe[1],ee[`${Ce}-color-hover`]=Fe[4],ee[`${Ce}-color-active`]=Fe[6],ee[`${Ce}-color-outline`]=$e.clone().setAlpha(.2).toRgbString(),ee[`${Ce}-color-deprecated-bg`]=Fe[0],ee[`${Ce}-color-deprecated-border`]=Fe[2]};if(B.primaryColor){q(B.primaryColor,"primary");const j=new h.TinyColor(B.primaryColor),Ce=(0,z.generate)(j.toRgbString());Ce.forEach((Fe,lt)=>{ee[`primary-${lt+1}`]=Fe}),ee["primary-color-deprecated-l-35"]=U(j,Fe=>Fe.lighten(35)),ee["primary-color-deprecated-l-20"]=U(j,Fe=>Fe.lighten(20)),ee["primary-color-deprecated-t-20"]=U(j,Fe=>Fe.tint(20)),ee["primary-color-deprecated-t-50"]=U(j,Fe=>Fe.tint(50)),ee["primary-color-deprecated-f-12"]=U(j,Fe=>Fe.setAlpha(Fe.getAlpha()*.12));const $e=new h.TinyColor(Ce[0]);ee["primary-color-active-deprecated-f-30"]=U($e,Fe=>Fe.setAlpha(Fe.getAlpha()*.3)),ee["primary-color-active-deprecated-d-02"]=U($e,Fe=>Fe.darken(2))}return B.successColor&&q(B.successColor,"success"),B.warningColor&&q(B.warningColor,"warning"),B.errorColor&&q(B.errorColor,"error"),B.infoColor&&q(B.infoColor,"info"),`
  :root {
    ${Object.keys(ee).map(j=>`--${Be}-${j}: ${ee[j]};`).join(`
`)}
  }
  `.trim()}function J(Be,B){const ee=fe(Be,B);(0,D.default)()&&(0,P.updateCSS)(ee,`${W}-dynamic-theme`)}},14893:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var F=x(3184);const z=D=>{const[,,,,P]=(0,F.useToken)();return P?`${D}-css-var`:""};var h=w.default=z},5819:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=x(67294),h=F(x(93319)),D=F(x(3236));function P(){const W=(0,z.useContext)(h.default),fe=(0,z.useContext)(D.default);return{componentDisabled:W,componentSize:fe}}var X=w.default=P},65693:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294)),h=F(x(3236));const D=X=>{const W=z.default.useContext(h.default);return z.default.useMemo(()=>X?typeof X=="string"?X!=null?X:W:X instanceof Function?X(W):W:W,[X,W])};var P=w.default=D},25494:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=W;var z=F(x(67265)),h=F(x(11102)),D=x(3184),P=F(x(78459)),X=x(13594);function W(fe,J,Be){var B,ee;const U=(0,X.devUseWarning)("ConfigProvider"),q=fe||{},le=q.inherit===!1||!J?Object.assign(Object.assign({},D.defaultConfig),{hashed:(B=J==null?void 0:J.hashed)!==null&&B!==void 0?B:D.defaultConfig.hashed,cssVar:J==null?void 0:J.cssVar}):J,j=(0,P.default)();return(0,z.default)(()=>{var Ce,$e;if(!fe)return J;const Fe=Object.assign({},le.components);Object.keys(fe.components||{}).forEach(Ze=>{Fe[Ze]=Object.assign(Object.assign({},Fe[Ze]),fe.components[Ze])});const lt=`css-var-${j.replace(/:/g,"")}`,We=((Ce=q.cssVar)!==null&&Ce!==void 0?Ce:le.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:Be==null?void 0:Be.prefixCls},typeof le.cssVar=="object"?le.cssVar:{}),typeof q.cssVar=="object"?q.cssVar:{}),{key:typeof q.cssVar=="object"&&(($e=q.cssVar)===null||$e===void 0?void 0:$e.key)||lt});return Object.assign(Object.assign(Object.assign({},le),q),{token:Object.assign(Object.assign({},le.token),q.token),components:Fe,cssVar:We})},[q,le],(Ce,$e)=>Ce.some((Fe,lt)=>{const We=$e[lt];return!(0,h.default)(Fe,We,!0)}))}},78459:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294));const h=Object.assign({},z),{useId:D}=h,X=typeof D=="undefined"?()=>"":D;var W=w.default=X},31929:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"ConfigConsumer",{enumerable:!0,get:function(){return le.ConfigConsumer}}),Object.defineProperty(w,"ConfigContext",{enumerable:!0,get:function(){return le.ConfigContext}}),w.default=w.configConsumerProps=void 0,Object.defineProperty(w,"defaultIconPrefixCls",{enumerable:!0,get:function(){return le.defaultIconPrefixCls}}),w.warnContext=w.globalConfig=w.defaultPrefixCls=void 0;var h=z(x(67294)),D=x(6731),P=F(x(13357)),X=F(x(67265)),W=x(20059),fe=z(x(13594)),J=F(x(2197)),Be=z(x(24522)),B=F(x(44805)),ee=F(x(18253)),U=x(89329),q=F(x(98411)),le=x(7177),j=x(56301),Ce=x(93319),$e=F(x(5819)),Fe=F(x(25494)),lt=F(x(16722)),We=F(x(11380)),Ze=z(x(3236)),pe=F(x(82932)),se=function(Zr,Vr){var rn={};for(var Qr in Zr)Object.prototype.hasOwnProperty.call(Zr,Qr)&&Vr.indexOf(Qr)<0&&(rn[Qr]=Zr[Qr]);if(Zr!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ln=0,Qr=Object.getOwnPropertySymbols(Zr);ln<Qr.length;ln++)Vr.indexOf(Qr[ln])<0&&Object.prototype.propertyIsEnumerable.call(Zr,Qr[ln])&&(rn[Qr[ln]]=Zr[Qr[ln]]);return rn};let be=!1;const Te=w.warnContext=null,de=w.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"],Rt=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"],ye=w.defaultPrefixCls="ant";let Ve,oe,Re,Se;function et(){return Ve||ye}function st(){return oe||le.defaultIconPrefixCls}function pt(Zr){return Object.keys(Zr).some(Vr=>Vr.endsWith("Color"))}const bt=Zr=>{const{prefixCls:Vr,iconPrefixCls:rn,theme:Qr,holderRender:ln}=Zr;Vr!==void 0&&(Ve=Vr),rn!==void 0&&(oe=rn),"holderRender"in Zr&&(Se=ln),Qr&&(pt(Qr)?(0,j.registerTheme)(et(),Qr):Re=Qr)},ke=()=>({getPrefixCls:(Zr,Vr)=>Vr||(Zr?`${et()}-${Zr}`:et()),getIconPrefixCls:st,getRootPrefixCls:()=>Ve||et(),getTheme:()=>Re,holderRender:Se});w.globalConfig=ke;const ur=Zr=>{const{children:Vr,csp:rn,autoInsertSpaceInButton:Qr,alert:ln,anchor:vn,form:$t,locale:_r,componentSize:kt,direction:qe,space:Sr,virtual:Pe,dropdownMatchSelectWidth:Hr,popupMatchSelectWidth:vr,popupOverflow:Ie,legacyLocale:gr,parentContext:Wr,iconPrefixCls:Dr,theme:Xr,componentDisabled:Vn,segmented:ni,statistic:Dn,spin:Jn,calendar:Yi,carousel:bi,cascader:ui,collapse:pi,typography:it,checkbox:V,descriptions:H,divider:Ee,drawer:Le,skeleton:ze,steps:xt,image:Ut,layout:ir,list:Ft,mentions:te,modal:Q,progress:ve,result:Oe,slider:Xe,breadcrumb:ft,menu:Et,pagination:Ne,input:Ue,textArea:vt,empty:ue,badge:Lr,radio:lr,rate:$r,switch:Rn,transfer:nn,avatar:xr,message:Or,tag:sn,table:xn,card:wi,tabs:Nn,timeline:Bi,timePicker:sa,upload:Fi,notification:bn,tree:ei,colorPicker:ga,datePicker:ua,rangePicker:no,flex:ia,wave:zi,dropdown:Nr,warning:ji,tour:Hs}=Zr,Da=h.useCallback((ba,so)=>{const{prefixCls:Ao}=Zr;if(so)return so;const Y=Ao||Wr.getPrefixCls("");return ba?`${Y}-${ba}`:Y},[Wr.getPrefixCls,Zr.prefixCls]),Za=Dr||Wr.iconPrefixCls||le.defaultIconPrefixCls,Qs=rn||Wr.csp;(0,pe.default)(Za,Qs);const cs=(0,Fe.default)(Xr,Wr.theme,{prefixCls:Da("")}),Ka={csp:Qs,autoInsertSpaceInButton:Qr,alert:ln,anchor:vn,locale:_r||gr,direction:qe,space:Sr,virtual:Pe,popupMatchSelectWidth:vr!=null?vr:Hr,popupOverflow:Ie,getPrefixCls:Da,iconPrefixCls:Za,theme:cs,segmented:ni,statistic:Dn,spin:Jn,calendar:Yi,carousel:bi,cascader:ui,collapse:pi,typography:it,checkbox:V,descriptions:H,divider:Ee,drawer:Le,skeleton:ze,steps:xt,image:Ut,input:Ue,textArea:vt,layout:ir,list:Ft,mentions:te,modal:Q,progress:ve,result:Oe,slider:Xe,breadcrumb:ft,menu:Et,pagination:Ne,empty:ue,badge:Lr,radio:lr,rate:$r,switch:Rn,transfer:nn,avatar:xr,message:Or,tag:sn,table:xn,card:wi,tabs:Nn,timeline:Bi,timePicker:sa,upload:Fi,notification:bn,tree:ei,colorPicker:ga,datePicker:ua,rangePicker:no,flex:ia,wave:zi,dropdown:Nr,warning:ji,tour:Hs},Do=Object.assign({},Wr);Object.keys(Ka).forEach(ba=>{Ka[ba]!==void 0&&(Do[ba]=Ka[ba])}),Rt.forEach(ba=>{const so=Zr[ba];so&&(Do[ba]=so)});const qa=(0,X.default)(()=>Do,Do,(ba,so)=>{const Ao=Object.keys(ba),Y=Object.keys(so);return Ao.length!==Y.length||Ao.some(vo=>ba[vo]!==so[vo])}),Qa=h.useMemo(()=>({prefixCls:Za,csp:Qs}),[Za,Qs]);let Pa=h.createElement(h.Fragment,null,h.createElement(We.default,{dropdownMatchSelectWidth:Hr}),Vr);const Na=h.useMemo(()=>{var ba,so,Ao,Y;return(0,W.merge)(((ba=ee.default.Form)===null||ba===void 0?void 0:ba.defaultValidateMessages)||{},((Ao=(so=qa.locale)===null||so===void 0?void 0:so.Form)===null||Ao===void 0?void 0:Ao.defaultValidateMessages)||{},((Y=qa.form)===null||Y===void 0?void 0:Y.validateMessages)||{},($t==null?void 0:$t.validateMessages)||{})},[qa,$t==null?void 0:$t.validateMessages]);Object.keys(Na).length>0&&(Pa=h.createElement(J.default.Provider,{value:Na},Pa)),_r&&(Pa=h.createElement(Be.default,{locale:_r,_ANT_MARK__:Be.ANT_MARK},Pa)),(Za||Qs)&&(Pa=h.createElement(P.default.Provider,{value:Qa},Pa)),kt&&(Pa=h.createElement(Ze.SizeContextProvider,{size:kt},Pa)),Pa=h.createElement(lt.default,null,Pa);const Lo=h.useMemo(()=>{const ba=cs||{},{algorithm:so,token:Ao,components:Y,cssVar:vo}=ba,Va=se(ba,["algorithm","token","components","cssVar"]),fs=so&&(!Array.isArray(so)||so.length>0)?(0,D.createTheme)(so):U.defaultTheme,Eo={};Object.entries(Y||{}).forEach(gt=>{let[Gt,Pr]=gt;const Tn=Object.assign({},Pr);"algorithm"in Tn&&(Tn.algorithm===!0?Tn.theme=fs:(Array.isArray(Tn.algorithm)||typeof Tn.algorithm=="function")&&(Tn.theme=(0,D.createTheme)(Tn.algorithm)),delete Tn.algorithm),Eo[Gt]=Tn});const Qe=Object.assign(Object.assign({},q.default),Ao);return Object.assign(Object.assign({},Va),{theme:fs,token:Qe,components:Eo,override:Object.assign({override:Qe},Eo),cssVar:vo})},[cs]);return Xr&&(Pa=h.createElement(U.DesignTokenContext.Provider,{value:Lo},Pa)),qa.warning&&(Pa=h.createElement(fe.WarningContext.Provider,{value:qa.warning},Pa)),Vn!==void 0&&(Pa=h.createElement(Ce.DisabledContextProvider,{disabled:Vn},Pa)),h.createElement(le.ConfigContext.Provider,{value:qa},Pa)},qt=Zr=>{const Vr=h.useContext(le.ConfigContext),rn=h.useContext(B.default);return h.createElement(ur,Object.assign({parentContext:Vr,legacyLocale:rn},Zr))};qt.ConfigContext=le.ConfigContext,qt.SizeContext=Ze.default,qt.config=bt,qt.useConfig=$e.default,Object.defineProperty(qt,"SizeContext",{get:()=>Ze.default});var _n=w.default=qt},82932:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return F.useResetIconStyle}});var F=x(3184)},25633:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(27590)),h=F(x(52040));const D={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},z.default),timePickerLocale:Object.assign({},h.default)};var P=w.default=D},51130:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.VariantContext=w.NoStyleItemContext=w.NoFormStyle=w.FormProvider=w.FormItemPrefixContext=w.FormItemInputContext=w.FormContext=void 0;var h=z(x(67294)),D=h,P=x(43589),X=F(x(18475));const W=w.FormContext=D.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),fe=w.NoStyleItemContext=D.createContext(null),J=q=>{const le=(0,X.default)(q,["prefixCls"]);return D.createElement(P.FormProvider,Object.assign({},le))};w.FormProvider=J;const Be=w.FormItemPrefixContext=D.createContext({prefixCls:""}),B=w.FormItemInputContext=D.createContext({}),ee=q=>{let{children:le,status:j,override:Ce}=q;const $e=(0,h.useContext)(B),Fe=(0,h.useMemo)(()=>{const lt=Object.assign({},$e);return Ce&&delete lt.isFormItemInput,j&&(delete lt.status,delete lt.hasFeedback,delete lt.feedbackIcon),lt},[j,Ce,$e]);return D.createElement(B.Provider,{value:Fe},le)};w.NoFormStyle=ee;const U=w.VariantContext=(0,h.createContext)(void 0)},96424:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=w.Variants=void 0;var F=x(67294),z=x(51130);const h=w.Variants=["outlined","borderless","filled"],D=function(X){let W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const fe=(0,F.useContext)(z.VariantContext);let J;typeof X!="undefined"?J=X:W===!1?J="borderless":J=fe!=null?fe:"outlined";const Be=h.includes(J);return[J,Be]};var P=w.default=D},2197:function(He,w,x){"use strict";"use client";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var F=x(67294),z=w.default=(0,F.createContext)(void 0)},10815:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0,w.triggerFocus=We;var h=z(x(67294)),D=F(x(93967)),P=F(x(67656)),X=x(75531),W=F(x(49314)),fe=x(71434),J=x(13594),Be=x(31929),B=F(x(93319)),ee=F(x(14893)),U=F(x(65693)),q=x(51130),le=F(x(96424)),j=x(46549),Ce=F(x(81722)),$e=F(x(89858)),Fe=x(36714),lt=function(se,be){var Te={};for(var de in se)Object.prototype.hasOwnProperty.call(se,de)&&be.indexOf(de)<0&&(Te[de]=se[de]);if(se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Rt=0,de=Object.getOwnPropertySymbols(se);Rt<de.length;Rt++)be.indexOf(de[Rt])<0&&Object.prototype.propertyIsEnumerable.call(se,de[Rt])&&(Te[de[Rt]]=se[de[Rt]]);return Te};function We(se,be){if(!se)return;se.focus(be);const{cursor:Te}=be||{};if(Te){const de=se.value.length;switch(Te){case"start":se.setSelectionRange(0,0);break;case"end":se.setSelectionRange(de,de);break;default:se.setSelectionRange(0,de);break}}}const Ze=(0,h.forwardRef)((se,be)=>{var Te;const{prefixCls:de,bordered:Rt=!0,status:ye,size:Ve,disabled:oe,onBlur:Re,onFocus:Se,suffix:et,allowClear:st,addonAfter:pt,addonBefore:bt,className:ke,style:ur,styles:qt,rootClassName:_n,onChange:Zr,classNames:Vr,variant:rn}=se,Qr=lt(se,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:ln,direction:vn,input:$t}=h.default.useContext(Be.ConfigContext),_r=ln("input",de),kt=(0,h.useRef)(null),qe=(0,ee.default)(_r),[Sr,Pe,Hr]=(0,$e.default)(_r,qe),{compactSize:vr,compactItemClassnames:Ie}=(0,j.useCompactItemContext)(_r,vn),gr=(0,U.default)(ze=>{var xt;return(xt=Ve!=null?Ve:vr)!==null&&xt!==void 0?xt:ze}),Wr=h.default.useContext(B.default),Dr=oe!=null?oe:Wr,{status:Xr,hasFeedback:Vn,feedbackIcon:ni}=(0,h.useContext)(q.FormItemInputContext),Dn=(0,fe.getMergedStatus)(Xr,ye),Jn=(0,Fe.hasPrefixSuffix)(se)||!!Vn,Yi=(0,h.useRef)(Jn),bi=(0,Ce.default)(kt,!0),ui=ze=>{bi(),Re==null||Re(ze)},pi=ze=>{bi(),Se==null||Se(ze)},it=ze=>{bi(),Zr==null||Zr(ze)},V=(Vn||et)&&h.default.createElement(h.default.Fragment,null,et,Vn&&ni),H=(0,W.default)(st!=null?st:$t==null?void 0:$t.allowClear),[Ee,Le]=(0,le.default)(rn,Rt);return Sr(h.default.createElement(P.default,Object.assign({ref:(0,X.composeRef)(be,kt),prefixCls:_r,autoComplete:$t==null?void 0:$t.autoComplete},Qr,{disabled:Dr,onBlur:ui,onFocus:pi,style:Object.assign(Object.assign({},$t==null?void 0:$t.style),ur),styles:Object.assign(Object.assign({},$t==null?void 0:$t.styles),qt),suffix:V,allowClear:H,className:(0,D.default)(ke,_n,Hr,qe,Ie,$t==null?void 0:$t.className),onChange:it,addonAfter:pt&&h.default.createElement(j.NoCompactStyle,null,h.default.createElement(q.NoFormStyle,{override:!0,status:!0},pt)),addonBefore:bt&&h.default.createElement(j.NoCompactStyle,null,h.default.createElement(q.NoFormStyle,{override:!0,status:!0},bt)),classNames:Object.assign(Object.assign(Object.assign({},Vr),$t==null?void 0:$t.classNames),{input:(0,D.default)({[`${_r}-sm`]:gr==="small",[`${_r}-lg`]:gr==="large",[`${_r}-rtl`]:vn==="rtl"},Vr==null?void 0:Vr.input,(Te=$t==null?void 0:$t.classNames)===null||Te===void 0?void 0:Te.input,Pe),variant:(0,D.default)({[`${_r}-${Ee}`]:Le},(0,fe.getStatusClassNames)(_r,Dn)),affixWrapper:(0,D.default)({[`${_r}-affix-wrapper-sm`]:gr==="small",[`${_r}-affix-wrapper-lg`]:gr==="large",[`${_r}-affix-wrapper-rtl`]:vn==="rtl"},Pe),wrapper:(0,D.default)({[`${_r}-group-rtl`]:vn==="rtl"},Pe),groupWrapper:(0,D.default)({[`${_r}-group-wrapper-sm`]:gr==="small",[`${_r}-group-wrapper-lg`]:gr==="large",[`${_r}-group-wrapper-rtl`]:vn==="rtl",[`${_r}-group-wrapper-${Ee}`]:Le},(0,fe.getStatusClassNames)(`${_r}-group-wrapper`,Dn,Vn),Pe)})})))});var pe=w.default=Ze},14104:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=h,P=F(x(93967)),X=F(x(43961)),W=F(x(49314)),fe=x(71434),J=x(13594),Be=x(31929),B=F(x(93319)),ee=F(x(14893)),U=F(x(65693)),q=x(51130),le=F(x(96424)),j=x(10815),Ce=F(x(89858)),$e=function(We,Ze){var pe={};for(var se in We)Object.prototype.hasOwnProperty.call(We,se)&&Ze.indexOf(se)<0&&(pe[se]=We[se]);if(We!=null&&typeof Object.getOwnPropertySymbols=="function")for(var be=0,se=Object.getOwnPropertySymbols(We);be<se.length;be++)Ze.indexOf(se[be])<0&&Object.prototype.propertyIsEnumerable.call(We,se[be])&&(pe[se[be]]=We[se[be]]);return pe};const Fe=(0,h.forwardRef)((We,Ze)=>{var pe,se;const{prefixCls:be,bordered:Te=!0,size:de,disabled:Rt,status:ye,allowClear:Ve,classNames:oe,rootClassName:Re,className:Se,style:et,styles:st,variant:pt}=We,bt=$e(We,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:ke,direction:ur,textArea:qt}=D.useContext(Be.ConfigContext),_n=(0,U.default)(de),Zr=D.useContext(B.default),Vr=Rt!=null?Rt:Zr,{status:rn,hasFeedback:Qr,feedbackIcon:ln}=D.useContext(q.FormItemInputContext),vn=(0,fe.getMergedStatus)(rn,ye),$t=D.useRef(null);D.useImperativeHandle(Ze,()=>{var gr;return{resizableTextArea:(gr=$t.current)===null||gr===void 0?void 0:gr.resizableTextArea,focus:Wr=>{var Dr,Xr;(0,j.triggerFocus)((Xr=(Dr=$t.current)===null||Dr===void 0?void 0:Dr.resizableTextArea)===null||Xr===void 0?void 0:Xr.textArea,Wr)},blur:()=>{var Wr;return(Wr=$t.current)===null||Wr===void 0?void 0:Wr.blur()}}});const _r=ke("input",be),kt=(0,ee.default)(_r),[qe,Sr,Pe]=(0,Ce.default)(_r,kt),[Hr,vr]=(0,le.default)(pt,Te),Ie=(0,W.default)(Ve!=null?Ve:qt==null?void 0:qt.allowClear);return qe(D.createElement(X.default,Object.assign({autoComplete:qt==null?void 0:qt.autoComplete},bt,{style:Object.assign(Object.assign({},qt==null?void 0:qt.style),et),styles:Object.assign(Object.assign({},qt==null?void 0:qt.styles),st),disabled:Vr,allowClear:Ie,className:(0,P.default)(Pe,kt,Se,Re,qt==null?void 0:qt.className),classNames:Object.assign(Object.assign(Object.assign({},oe),qt==null?void 0:qt.classNames),{textarea:(0,P.default)({[`${_r}-sm`]:_n==="small",[`${_r}-lg`]:_n==="large"},Sr,oe==null?void 0:oe.textarea,(pe=qt==null?void 0:qt.classNames)===null||pe===void 0?void 0:pe.textarea),variant:(0,P.default)({[`${_r}-${Hr}`]:vr},(0,fe.getStatusClassNames)(_r,vn)),affixWrapper:(0,P.default)(`${_r}-textarea-affix-wrapper`,{[`${_r}-affix-wrapper-rtl`]:ur==="rtl",[`${_r}-affix-wrapper-sm`]:_n==="small",[`${_r}-affix-wrapper-lg`]:_n==="large",[`${_r}-textarea-show-count`]:We.showCount||((se=We.count)===null||se===void 0?void 0:se.show)},Sr)}),prefixCls:_r,suffix:Qr&&D.createElement("span",{className:`${_r}-textarea-suffix`},ln),ref:$t})))});var lt=w.default=Fe},81722:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=z;var F=x(67294);function z(h,D){const P=(0,F.useRef)([]),X=()=>{P.current.push(setTimeout(()=>{var W,fe,J,Be;!((W=h.current)===null||W===void 0)&&W.input&&((fe=h.current)===null||fe===void 0?void 0:fe.input.getAttribute("type"))==="password"&&(!((J=h.current)===null||J===void 0)&&J.input.hasAttribute("value"))&&((Be=h.current)===null||Be===void 0||Be.input.removeAttribute("value"))}))};return(0,F.useEffect)(()=>(D&&X(),()=>P.current.forEach(W=>{W&&clearTimeout(W)})),[]),X}},89858:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.genPlaceholderStyle=w.genInputSmallStyle=w.genInputGroupStyle=w.genBasicInputStyle=w.genActiveStyle=w.default=void 0,Object.defineProperty(w,"initComponentToken",{enumerable:!0,get:function(){return P.initComponentToken}}),Object.defineProperty(w,"initInputToken",{enumerable:!0,get:function(){return P.initInputToken}});var F=x(6731),z=x(98078),h=x(78793),D=x(3184),P=x(25735),X=x(58594);const W=We=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:We,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}});w.genPlaceholderStyle=W;const fe=We=>({borderColor:We.activeBorderColor,boxShadow:We.activeShadow,outline:0,backgroundColor:We.activeBg});w.genActiveStyle=fe;const J=We=>{const{paddingBlockLG:Ze,lineHeightLG:pe,borderRadiusLG:se,paddingInlineLG:be}=We;return{padding:`${(0,F.unit)(Ze)} ${(0,F.unit)(be)}`,fontSize:We.inputFontSizeLG,lineHeight:pe,borderRadius:se}},Be=We=>({padding:`${(0,F.unit)(We.paddingBlockSM)} ${(0,F.unit)(We.paddingInlineSM)}`,fontSize:We.inputFontSizeSM,borderRadius:We.borderRadiusSM});w.genInputSmallStyle=Be;const B=We=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${(0,F.unit)(We.paddingBlock)} ${(0,F.unit)(We.paddingInline)}`,color:We.colorText,fontSize:We.inputFontSize,lineHeight:We.lineHeight,borderRadius:We.borderRadius,transition:`all ${We.motionDurationMid}`},W(We.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:We.controlHeight,lineHeight:We.lineHeight,verticalAlign:"bottom",transition:`all ${We.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},J(We)),"&-sm":Object.assign({},Be(We)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}});w.genBasicInputStyle=B;const ee=We=>{const{componentCls:Ze,antCls:pe}=We;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,["&[class*='col-']"]:{paddingInlineEnd:We.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${Ze}, &-lg > ${Ze}-group-addon`]:Object.assign({},J(We)),[`&-sm ${Ze}, &-sm > ${Ze}-group-addon`]:Object.assign({},Be(We)),[`&-lg ${pe}-select-single ${pe}-select-selector`]:{height:We.controlHeightLG},[`&-sm ${pe}-select-single ${pe}-select-selector`]:{height:We.controlHeightSM},[`> ${Ze}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${Ze}-group`]:{["&-addon, &-wrap"]:{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${(0,F.unit)(We.paddingInline)}`,color:We.colorText,fontWeight:"normal",fontSize:We.inputFontSize,textAlign:"center",borderRadius:We.borderRadius,transition:`all ${We.motionDurationSlow}`,lineHeight:1,[`${pe}-select`]:{margin:`${(0,F.unit)(We.calc(We.paddingBlock).add(1).mul(-1).equal())} ${(0,F.unit)(We.calc(We.paddingInline).mul(-1).equal())}`,[`&${pe}-select-single:not(${pe}-select-customize-input):not(${pe}-pagination-size-changer)`]:{[`${pe}-select-selector`]:{backgroundColor:"inherit",border:`${(0,F.unit)(We.lineWidth)} ${We.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${pe}-select-selector`]:{color:We.colorPrimary}}},[`${pe}-cascader-picker`]:{margin:`-9px ${(0,F.unit)(We.calc(We.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${pe}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[`${Ze}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${Ze}-search-with-button &`]:{zIndex:0}}},[`> ${Ze}:first-child, ${Ze}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${pe}-select ${pe}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${Ze}-affix-wrapper`]:{[`&:not(:first-child) ${Ze}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${Ze}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${Ze}:last-child, ${Ze}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${pe}-select ${pe}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${Ze}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${Ze}-search &`]:{borderStartStartRadius:We.borderRadius,borderEndStartRadius:We.borderRadius}},[`&:not(:first-child), ${Ze}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${Ze}-group-compact`]:Object.assign(Object.assign({display:"block"},(0,z.clearFix)()),{[`${Ze}-group-addon, ${Ze}-group-wrap, > ${Ze}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:We.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${Ze}-affix-wrapper,
        & > ${Ze}-number-affix-wrapper,
        & > ${pe}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:We.calc(We.lineWidth).mul(-1).equal(),borderInlineEndWidth:We.lineWidth},[`${Ze}`]:{float:"none"},[`& > ${pe}-select > ${pe}-select-selector,
      & > ${pe}-select-auto-complete ${Ze},
      & > ${pe}-cascader-picker ${Ze},
      & > ${Ze}-group-wrapper ${Ze}`]:{borderInlineEndWidth:We.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${pe}-select-focused`]:{zIndex:1},[`& > ${pe}-select > ${pe}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${pe}-select:first-child > ${pe}-select-selector,
      & > ${pe}-select-auto-complete:first-child ${Ze},
      & > ${pe}-cascader-picker:first-child ${Ze}`]:{borderStartStartRadius:We.borderRadius,borderEndStartRadius:We.borderRadius},[`& > *:last-child,
      & > ${pe}-select:last-child > ${pe}-select-selector,
      & > ${pe}-cascader-picker:last-child ${Ze},
      & > ${pe}-cascader-picker-focused:last-child ${Ze}`]:{borderInlineEndWidth:We.lineWidth,borderStartEndRadius:We.borderRadius,borderEndEndRadius:We.borderRadius},[`& > ${pe}-select-auto-complete ${Ze}`]:{verticalAlign:"top"},[`${Ze}-group-wrapper + ${Ze}-group-wrapper`]:{marginInlineStart:We.calc(We.lineWidth).mul(-1).equal(),[`${Ze}-affix-wrapper`]:{borderRadius:0}},[`${Ze}-group-wrapper:not(:last-child)`]:{[`&${Ze}-search > ${Ze}-group`]:{[`& > ${Ze}-group-addon > ${Ze}-search-button`]:{borderRadius:0},[`& > ${Ze}`]:{borderStartStartRadius:We.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:We.borderRadius}}}})}};w.genInputGroupStyle=ee;const U=We=>{const{componentCls:Ze,controlHeightSM:pe,lineWidth:se,calc:be}=We,Te=16,de=be(pe).sub(be(se).mul(2)).sub(Te).div(2).equal();return{[Ze]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,z.resetComponent)(We)),B(We)),(0,X.genOutlinedStyle)(We)),(0,X.genFilledStyle)(We)),(0,X.genBorderlessStyle)(We)),{'&[type="color"]':{height:We.controlHeight,[`&${Ze}-lg`]:{height:We.controlHeightLG},[`&${Ze}-sm`]:{height:pe,paddingTop:de,paddingBottom:de}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},q=We=>{const{componentCls:Ze}=We;return{[`${Ze}-clear-icon`]:{margin:0,color:We.colorTextQuaternary,fontSize:We.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${We.motionDurationSlow}`,"&:hover":{color:We.colorTextTertiary},"&:active":{color:We.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${(0,F.unit)(We.inputAffixPadding)}`}}}},le=We=>{const{componentCls:Ze,inputAffixPadding:pe,colorTextDescription:se,motionDurationSlow:be,colorIcon:Te,colorIconHover:de,iconCls:Rt}=We;return{[`${Ze}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign({},B(We)),{display:"inline-flex",[`&:not(${Ze}-disabled):hover`]:{zIndex:1,[`${Ze}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${Ze}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${Ze}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:We.paddingXS}},"&-show-count-suffix":{color:se},"&-show-count-has-suffix":{marginInlineEnd:We.paddingXXS},"&-prefix":{marginInlineEnd:pe},"&-suffix":{marginInlineStart:pe}}}),q(We)),{[`${Rt}${Ze}-password-icon`]:{color:Te,cursor:"pointer",transition:`all ${be}`,"&:hover":{color:de}}})}},j=We=>{const{componentCls:Ze,borderRadiusLG:pe,borderRadiusSM:se}=We;return{[`${Ze}-group`]:Object.assign(Object.assign(Object.assign({},(0,z.resetComponent)(We)),ee(We)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${Ze}-group-addon`]:{borderRadius:pe,fontSize:We.inputFontSizeLG}},"&-sm":{[`${Ze}-group-addon`]:{borderRadius:se}}},(0,X.genOutlinedGroupStyle)(We)),(0,X.genFilledGroupStyle)(We)),{[`&:not(${Ze}-compact-first-item):not(${Ze}-compact-last-item)${Ze}-compact-item`]:{[`${Ze}, ${Ze}-group-addon`]:{borderRadius:0}},[`&:not(${Ze}-compact-last-item)${Ze}-compact-first-item`]:{[`${Ze}, ${Ze}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${Ze}-compact-first-item)${Ze}-compact-last-item`]:{[`${Ze}, ${Ze}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${Ze}-compact-last-item)${Ze}-compact-item`]:{[`${Ze}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},Ce=We=>{const{componentCls:Ze,antCls:pe}=We,se=`${Ze}-search`;return{[se]:{[`${Ze}`]:{"&:hover, &:focus":{borderColor:We.colorPrimaryHover,[`+ ${Ze}-group-addon ${se}-button:not(${pe}-btn-primary)`]:{borderInlineStartColor:We.colorPrimaryHover}}},[`${Ze}-affix-wrapper`]:{borderRadius:0},[`${Ze}-lg`]:{lineHeight:We.calc(We.lineHeightLG).sub(2e-4).equal({unit:!1})},[`> ${Ze}-group`]:{[`> ${Ze}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${se}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:We.borderRadius,borderEndEndRadius:We.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${se}-button:not(${pe}-btn-primary)`]:{color:We.colorTextDescription,"&:hover":{color:We.colorPrimaryHover},"&:active":{color:We.colorPrimaryActive},[`&${pe}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${se}-button`]:{height:We.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${se}-button`]:{height:We.controlHeightLG},[`&-small ${se}-button`]:{height:We.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${Ze}-compact-item`]:{[`&:not(${Ze}-compact-last-item)`]:{[`${Ze}-group-addon`]:{[`${Ze}-search-button`]:{marginInlineEnd:We.calc(We.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${Ze}-compact-first-item)`]:{[`${Ze},${Ze}-affix-wrapper`]:{borderRadius:0}},[`> ${Ze}-group-addon ${Ze}-search-button,
        > ${Ze},
        ${Ze}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${Ze}-affix-wrapper-focused`]:{zIndex:2}}}}},$e=We=>{const{componentCls:Ze,paddingLG:pe}=We,se=`${Ze}-textarea`;return{[se]:{position:"relative","&-show-count":{[`> ${Ze}`]:{height:"100%"},[`${Ze}-data-count`]:{position:"absolute",bottom:We.calc(We.fontSize).mul(We.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:We.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},"&-allow-clear":{[`> ${Ze}`]:{paddingInlineEnd:pe}},[`&-affix-wrapper${se}-has-feedback`]:{[`${Ze}`]:{paddingInlineEnd:pe}},[`&-affix-wrapper${Ze}-affix-wrapper`]:{padding:0,[`> textarea${Ze}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${Ze}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${Ze}-clear-icon`]:{position:"absolute",insetInlineEnd:We.paddingXS,insetBlockStart:We.paddingXS},[`${se}-suffix`]:{position:"absolute",top:0,insetInlineEnd:We.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}}}}},Fe=We=>{const{componentCls:Ze}=We;return{[`${Ze}-out-of-range`]:{[`&, & input, & textarea, ${Ze}-show-count-suffix, ${Ze}-data-count`]:{color:We.colorError}}}};var lt=w.default=(0,D.genStyleHooks)("Input",We=>{const Ze=(0,D.mergeToken)(We,(0,P.initInputToken)(We));return[U(Ze),$e(Ze),le(Ze),j(Ze),Ce(Ze),Fe(Ze),(0,h.genCompactItemStyle)(Ze)]},P.initComponentToken)},25735:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.initComponentToken=void 0,w.initInputToken=z;var F=x(3184);function z(D){return(0,F.mergeToken)(D,{inputAffixPadding:D.paddingXXS})}const h=D=>{const{controlHeight:P,fontSize:X,lineHeight:W,lineWidth:fe,controlHeightSM:J,controlHeightLG:Be,fontSizeLG:B,lineHeightLG:ee,paddingSM:U,controlPaddingHorizontalSM:q,controlPaddingHorizontal:le,colorFillAlter:j,colorPrimaryHover:Ce,colorPrimary:$e,controlOutlineWidth:Fe,controlOutline:lt,colorErrorOutline:We,colorWarningOutline:Ze,colorBgContainer:pe}=D;return{paddingBlock:Math.max(Math.round((P-X*W)/2*10)/10-fe,0),paddingBlockSM:Math.max(Math.round((J-X*W)/2*10)/10-fe,0),paddingBlockLG:Math.ceil((Be-B*ee)/2*10)/10-fe,paddingInline:U-fe,paddingInlineSM:q-fe,paddingInlineLG:le-fe,addonBg:j,activeBorderColor:$e,hoverBorderColor:Ce,activeShadow:`0 0 0 ${Fe}px ${lt}`,errorActiveShadow:`0 0 0 ${Fe}px ${We}`,warningActiveShadow:`0 0 0 ${Fe}px ${Ze}`,hoverBg:pe,activeBg:pe,inputFontSize:X,inputFontSizeLG:B,inputFontSizeSM:X}};w.initComponentToken=h},58594:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.genOutlinedStyle=w.genOutlinedGroupStyle=w.genHoverStyle=w.genFilledStyle=w.genFilledGroupStyle=w.genDisabledStyle=w.genBorderlessStyle=w.genBaseOutlinedStyle=void 0;var F=x(6731),z=x(3184);const h=j=>({borderColor:j.hoverBorderColor,backgroundColor:j.hoverBg});w.genHoverStyle=h;const D=j=>({color:j.colorTextDisabled,backgroundColor:j.colorBgContainerDisabled,borderColor:j.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},h((0,z.mergeToken)(j,{hoverBorderColor:j.colorBorder,hoverBg:j.colorBgContainerDisabled})))});w.genDisabledStyle=D;const P=(j,Ce)=>({background:j.colorBgContainer,borderWidth:j.lineWidth,borderStyle:j.lineType,borderColor:Ce.borderColor,"&:hover":{borderColor:Ce.hoverBorderColor,backgroundColor:j.hoverBg},"&:focus, &:focus-within":{borderColor:Ce.activeBorderColor,boxShadow:Ce.activeShadow,outline:0,backgroundColor:j.activeBg}});w.genBaseOutlinedStyle=P;const X=(j,Ce)=>({[`&${j.componentCls}-status-${Ce.status}:not(${j.componentCls}-disabled)`]:Object.assign(Object.assign({},P(j,Ce)),{[`${j.componentCls}-prefix, ${j.componentCls}-suffix`]:{color:Ce.affixColor}})}),W=(j,Ce)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},P(j,{borderColor:j.colorBorder,hoverBorderColor:j.hoverBorderColor,activeBorderColor:j.activeBorderColor,activeShadow:j.activeShadow})),{[`&${j.componentCls}-disabled, &[disabled]`]:Object.assign({},D(j))}),X(j,{status:"error",borderColor:j.colorError,hoverBorderColor:j.colorErrorBorderHover,activeBorderColor:j.colorError,activeShadow:j.errorActiveShadow,affixColor:j.colorError})),X(j,{status:"warning",borderColor:j.colorWarning,hoverBorderColor:j.colorWarningBorderHover,activeBorderColor:j.colorWarning,activeShadow:j.warningActiveShadow,affixColor:j.colorWarning})),Ce)});w.genOutlinedStyle=W;const fe=(j,Ce)=>({[`&${j.componentCls}-group-wrapper-status-${Ce.status}`]:{[`${j.componentCls}-group-addon`]:{borderColor:Ce.addonBorderColor,color:Ce.addonColor}}}),J=j=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${j.componentCls}-group`]:{"&-addon":{background:j.addonBg,border:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},fe(j,{status:"error",addonBorderColor:j.colorError,addonColor:j.colorErrorText})),fe(j,{status:"warning",addonBorderColor:j.colorWarning,addonColor:j.colorWarningText})),{[`&${j.componentCls}-group-wrapper-disabled`]:{[`${j.componentCls}-group-addon`]:Object.assign({},D(j))}})});w.genOutlinedGroupStyle=J;const Be=(j,Ce)=>({"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${j.componentCls}-disabled, &[disabled]`]:{color:j.colorTextDisabled}},Ce)});w.genBorderlessStyle=Be;const B=(j,Ce)=>({background:Ce.bg,borderWidth:j.lineWidth,borderStyle:j.lineType,borderColor:"transparent",["input&, & input, textarea&, & textarea"]:{color:Ce==null?void 0:Ce.inputColor},"&:hover":{background:Ce.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:Ce.activeBorderColor,backgroundColor:j.activeBg}}),ee=(j,Ce)=>({[`&${j.componentCls}-status-${Ce.status}:not(${j.componentCls}-disabled)`]:Object.assign(Object.assign({},B(j,Ce)),{[`${j.componentCls}-prefix, ${j.componentCls}-suffix`]:{color:Ce.affixColor}})}),U=(j,Ce)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},B(j,{bg:j.colorFillTertiary,hoverBg:j.colorFillSecondary,activeBorderColor:j.colorPrimary})),{[`&${j.componentCls}-disabled, &[disabled]`]:Object.assign({},D(j))}),ee(j,{status:"error",bg:j.colorErrorBg,hoverBg:j.colorErrorBgHover,activeBorderColor:j.colorError,inputColor:j.colorErrorText,affixColor:j.colorError})),ee(j,{status:"warning",bg:j.colorWarningBg,hoverBg:j.colorWarningBgHover,activeBorderColor:j.colorWarning,inputColor:j.colorWarningText,affixColor:j.colorWarning})),Ce)});w.genFilledStyle=U;const q=(j,Ce)=>({[`&${j.componentCls}-group-wrapper-status-${Ce.status}`]:{[`${j.componentCls}-group-addon`]:{background:Ce.addonBg,color:Ce.addonColor}}}),le=j=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${j.componentCls}-group`]:{"&-addon":{background:j.colorFillTertiary},[`${j.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorSplit}`}}}},q(j,{status:"error",addonBg:j.colorErrorBg,addonColor:j.colorErrorText})),q(j,{status:"warning",addonBg:j.colorWarningBg,addonColor:j.colorWarningText})),{[`&${j.componentCls}-group-wrapper-disabled`]:{[`${j.componentCls}-group`]:{"&-addon":{background:j.colorFillTertiary,color:j.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`,borderTop:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`,borderBottom:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`,borderTop:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`,borderBottom:`${(0,F.unit)(j.lineWidth)} ${j.lineType} ${j.colorBorder}`}}}})});w.genFilledGroupStyle=le},36714:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.hasPrefixSuffix=x;function x(F){return!!(F.prefix||F.suffix||F.allowClear||F.showCount)}},44805:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var F=x(67294);const z=(0,F.createContext)(void 0);var h=w.default=z},18253:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(62273)),h=F(x(1028)),D=F(x(25633)),P=F(x(52040));const X="${label} is not a valid ${type}",W={locale:"en",Pagination:z.default,DatePicker:D.default,TimePicker:P.default,Calendar:h.default,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:X,method:X,array:X,object:X,number:X,date:X,boolean:X,integer:X,float:X,regexp:X,email:X,url:X,hex:X},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty"}};var fe=w.default=W},24522:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=w.ANT_MARK=void 0,Object.defineProperty(w,"useLocale",{enumerable:!0,get:function(){return W.default}});var h=z(x(67294)),D=x(13594),P=x(10625),X=F(x(44805)),W=F(x(76647));const fe=w.ANT_MARK="internalMark",J=B=>{const{locale:ee={},children:U,_ANT_MARK__:q}=B;h.useEffect(()=>(0,P.changeConfirmLocale)(ee&&ee.Modal),[ee]);const le=h.useMemo(()=>Object.assign(Object.assign({},ee),{exist:!0}),[ee]);return h.createElement(X.default.Provider,{value:le},U)};var Be=w.default=J},76647:function(He,w,x){"use strict";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=F(x(44805)),P=F(x(18253));const X=(fe,J)=>{const Be=h.useContext(D.default),B=h.useMemo(()=>{var U;const q=J||P.default[fe],le=(U=Be==null?void 0:Be[fe])!==null&&U!==void 0?U:{};return Object.assign(Object.assign({},typeof q=="function"?q():q),le||{})},[fe,J,Be]),ee=h.useMemo(()=>{const U=Be==null?void 0:Be.locale;return Be!=null&&Be.exist&&!U?P.default.locale:U},[Be]);return[B,ee]};var W=w.default=X},10625:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.changeConfirmLocale=X,w.getConfirmLocale=W;var z=F(x(18253));let h=Object.assign({},z.default.Modal),D=[];const P=()=>D.reduce((fe,J)=>Object.assign(Object.assign({},fe),J),z.default.Modal);function X(fe){if(fe){const J=Object.assign({},fe);return D.push(J),h=P(),()=>{D=D.filter(Be=>Be!==J),h=P()}}h=Object.assign({},z.default.Modal)}function W(){return h}},46549:function(He,w,x){"use strict";"use client";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.useCompactItemContext=w.default=w.SpaceCompactItemContext=w.NoCompactStyle=void 0;var h=z(x(93967)),D=z(x(45598)),P=F(x(67294)),X=x(31929),W=z(x(65693)),fe=z(x(54277)),J=function(j,Ce){var $e={};for(var Fe in j)Object.prototype.hasOwnProperty.call(j,Fe)&&Ce.indexOf(Fe)<0&&($e[Fe]=j[Fe]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function")for(var lt=0,Fe=Object.getOwnPropertySymbols(j);lt<Fe.length;lt++)Ce.indexOf(Fe[lt])<0&&Object.prototype.propertyIsEnumerable.call(j,Fe[lt])&&($e[Fe[lt]]=j[Fe[lt]]);return $e};const Be=w.SpaceCompactItemContext=P.createContext(null),B=(j,Ce)=>{const $e=P.useContext(Be),Fe=P.useMemo(()=>{if(!$e)return"";const{compactDirection:lt,isFirstItem:We,isLastItem:Ze}=$e,pe=lt==="vertical"?"-vertical-":"-";return(0,h.default)(`${j}-compact${pe}item`,{[`${j}-compact${pe}first-item`]:We,[`${j}-compact${pe}last-item`]:Ze,[`${j}-compact${pe}item-rtl`]:Ce==="rtl"})},[j,Ce,$e]);return{compactSize:$e==null?void 0:$e.compactSize,compactDirection:$e==null?void 0:$e.compactDirection,compactItemClassnames:Fe}};w.useCompactItemContext=B;const ee=j=>{let{children:Ce}=j;return P.createElement(Be.Provider,{value:null},Ce)};w.NoCompactStyle=ee;const U=j=>{var{children:Ce}=j,$e=J(j,["children"]);return P.createElement(Be.Provider,{value:$e},Ce)},q=j=>{const{getPrefixCls:Ce,direction:$e}=P.useContext(X.ConfigContext),{size:Fe,direction:lt,block:We,prefixCls:Ze,className:pe,rootClassName:se,children:be}=j,Te=J(j,["size","direction","block","prefixCls","className","rootClassName","children"]),de=(0,W.default)(st=>Fe!=null?Fe:st),Rt=Ce("space-compact",Ze),[ye,Ve]=(0,fe.default)(Rt),oe=(0,h.default)(Rt,Ve,{[`${Rt}-rtl`]:$e==="rtl",[`${Rt}-block`]:We,[`${Rt}-vertical`]:lt==="vertical"},pe,se),Re=P.useContext(Be),Se=(0,D.default)(be),et=P.useMemo(()=>Se.map((st,pt)=>{const bt=st&&st.key||`${Rt}-item-${pt}`;return P.createElement(U,{key:bt,compactSize:de,compactDirection:lt,isFirstItem:pt===0&&(!Re||(Re==null?void 0:Re.isFirstItem)),isLastItem:pt===Se.length-1&&(!Re||(Re==null?void 0:Re.isLastItem))},st)}),[Fe,Se,Re]);return Se.length===0?null:ye(P.createElement("div",Object.assign({className:oe},Te),et))};var le=w.default=q},35969:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const x=z=>{const{componentCls:h}=z;return{[h]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}};var F=w.default=x},54277:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.prepareComponentToken=w.default=void 0;var z=x(3184),h=F(x(35969));const D=fe=>{const{componentCls:J}=fe;return{[J]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${J}-item:empty`]:{display:"none"}}}},P=fe=>{const{componentCls:J}=fe;return{[J]:{"&-gap-row-small":{rowGap:fe.spaceGapSmallSize},"&-gap-row-middle":{rowGap:fe.spaceGapMiddleSize},"&-gap-row-large":{rowGap:fe.spaceGapLargeSize},"&-gap-col-small":{columnGap:fe.spaceGapSmallSize},"&-gap-col-middle":{columnGap:fe.spaceGapMiddleSize},"&-gap-col-large":{columnGap:fe.spaceGapLargeSize}}}},X=()=>({});w.prepareComponentToken=X;var W=w.default=(0,z.genStyleHooks)("Space",fe=>{const J=(0,z.mergeToken)(fe,{spaceGapSmallSize:fe.paddingXS,spaceGapMiddleSize:fe.padding,spaceGapLargeSize:fe.paddingLG});return[D(J),P(J),(0,h.default)(J)]},()=>({}),{resetStyle:!1})},78793:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.genCompactItemStyle=z;function x(h,D,P){const{focusElCls:X,focus:W,borderElCls:fe}=P,J=fe?"> *":"",Be=["hover",W?"focus":null,"active"].filter(Boolean).map(B=>`&:${B} ${J}`).join(",");return{[`&-item:not(${D}-last-item)`]:{marginInlineEnd:h.calc(h.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[Be]:{zIndex:2}},X?{[`&${X}`]:{zIndex:2}}:{}),{[`&[disabled] ${J}`]:{zIndex:0}})}}function F(h,D,P){const{borderElCls:X}=P,W=X?`> ${X}`:"";return{[`&-item:not(${D}-first-item):not(${D}-last-item) ${W}`]:{borderRadius:0},[`&-item:not(${D}-last-item)${D}-first-item`]:{[`& ${W}, &${h}-sm ${W}, &${h}-lg ${W}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${D}-first-item)${D}-last-item`]:{[`& ${W}, &${h}-sm ${W}, &${h}-lg ${W}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function z(h){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:P}=h,X=`${P}-compact`;return{[X]:Object.assign(Object.assign({},x(h,X,D)),F(P,X,D))}}},98078:function(He,w,x){"use strict";"use client";Object.defineProperty(w,"__esModule",{value:!0}),w.genLinkStyle=w.genFocusStyle=w.genFocusOutline=w.genCommonStyle=w.clearFix=void 0,Object.defineProperty(w,"operationUnit",{enumerable:!0,get:function(){return z.operationUnit}}),w.textEllipsis=w.resetIcon=w.resetComponent=void 0;var F=x(6731),z=x(22548);const h=w.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},D=function(B){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:B.colorText,fontSize:B.fontSize,lineHeight:B.lineHeight,listStyle:"none",fontFamily:ee?"inherit":B.fontFamily}};w.resetComponent=D;const P=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});w.resetIcon=P;const X=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});w.clearFix=X;const W=B=>({a:{color:B.colorLink,textDecoration:B.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${B.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:B.colorLinkHover},"&:active":{color:B.colorLinkActive},[`&:active,
  &:hover`]:{textDecoration:B.linkHoverDecoration,outline:0},"&:focus":{textDecoration:B.linkFocusDecoration,outline:0},"&[disabled]":{color:B.colorTextDisabled,cursor:"not-allowed"}}});w.genLinkStyle=W;const fe=(B,ee,U)=>{const{fontFamily:q,fontSize:le}=B,j=`[class^="${ee}"], [class*=" ${ee}"]`;return{[U?`.${U}`:j]:{fontFamily:q,fontSize:le,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[j]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}};w.genCommonStyle=fe;const J=B=>({outline:`${(0,F.unit)(B.lineWidthFocus)} solid ${B.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"});w.genFocusOutline=J;const Be=B=>({"&:focus-visible":Object.assign({},J(B))});w.genFocusStyle=Be},57253:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const x=z=>({[z.componentCls]:{[`${z.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${z.motionDurationMid} ${z.motionEaseInOut},
        opacity ${z.motionDurationMid} ${z.motionEaseInOut} !important`}},[`${z.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${z.motionDurationMid} ${z.motionEaseInOut},
        opacity ${z.motionDurationMid} ${z.motionEaseInOut} !important`}}});var F=w.default=x},84460:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.initFadeMotion=w.fadeOut=w.fadeIn=void 0;var F=x(6731),z=x(94631);const h=w.fadeIn=new F.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),D=w.fadeOut=new F.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),P=function(X){let W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:fe}=X,J=`${fe}-fade`,Be=W?"&":"";return[(0,z.initMotion)(J,h,D,X.motionDurationMid,W),{[`
        ${Be}${J}-enter,
        ${Be}${J}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${Be}${J}-leave`]:{animationTimingFunction:"linear"}}]};w.initFadeMotion=P},42836:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"fadeIn",{enumerable:!0,get:function(){return z.fadeIn}}),Object.defineProperty(w,"fadeOut",{enumerable:!0,get:function(){return z.fadeOut}}),Object.defineProperty(w,"genCollapseMotion",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(w,"initFadeMotion",{enumerable:!0,get:function(){return z.initFadeMotion}}),Object.defineProperty(w,"initMoveMotion",{enumerable:!0,get:function(){return h.initMoveMotion}}),Object.defineProperty(w,"initSlideMotion",{enumerable:!0,get:function(){return D.initSlideMotion}}),Object.defineProperty(w,"initZoomMotion",{enumerable:!0,get:function(){return P.initZoomMotion}}),Object.defineProperty(w,"moveDownIn",{enumerable:!0,get:function(){return h.moveDownIn}}),Object.defineProperty(w,"moveDownOut",{enumerable:!0,get:function(){return h.moveDownOut}}),Object.defineProperty(w,"moveLeftIn",{enumerable:!0,get:function(){return h.moveLeftIn}}),Object.defineProperty(w,"moveLeftOut",{enumerable:!0,get:function(){return h.moveLeftOut}}),Object.defineProperty(w,"moveRightIn",{enumerable:!0,get:function(){return h.moveRightIn}}),Object.defineProperty(w,"moveRightOut",{enumerable:!0,get:function(){return h.moveRightOut}}),Object.defineProperty(w,"moveUpIn",{enumerable:!0,get:function(){return h.moveUpIn}}),Object.defineProperty(w,"moveUpOut",{enumerable:!0,get:function(){return h.moveUpOut}}),Object.defineProperty(w,"slideDownIn",{enumerable:!0,get:function(){return D.slideDownIn}}),Object.defineProperty(w,"slideDownOut",{enumerable:!0,get:function(){return D.slideDownOut}}),Object.defineProperty(w,"slideLeftIn",{enumerable:!0,get:function(){return D.slideLeftIn}}),Object.defineProperty(w,"slideLeftOut",{enumerable:!0,get:function(){return D.slideLeftOut}}),Object.defineProperty(w,"slideRightIn",{enumerable:!0,get:function(){return D.slideRightIn}}),Object.defineProperty(w,"slideRightOut",{enumerable:!0,get:function(){return D.slideRightOut}}),Object.defineProperty(w,"slideUpIn",{enumerable:!0,get:function(){return D.slideUpIn}}),Object.defineProperty(w,"slideUpOut",{enumerable:!0,get:function(){return D.slideUpOut}}),Object.defineProperty(w,"zoomBigIn",{enumerable:!0,get:function(){return P.zoomBigIn}}),Object.defineProperty(w,"zoomBigOut",{enumerable:!0,get:function(){return P.zoomBigOut}}),Object.defineProperty(w,"zoomDownIn",{enumerable:!0,get:function(){return P.zoomDownIn}}),Object.defineProperty(w,"zoomDownOut",{enumerable:!0,get:function(){return P.zoomDownOut}}),Object.defineProperty(w,"zoomIn",{enumerable:!0,get:function(){return P.zoomIn}}),Object.defineProperty(w,"zoomLeftIn",{enumerable:!0,get:function(){return P.zoomLeftIn}}),Object.defineProperty(w,"zoomLeftOut",{enumerable:!0,get:function(){return P.zoomLeftOut}}),Object.defineProperty(w,"zoomOut",{enumerable:!0,get:function(){return P.zoomOut}}),Object.defineProperty(w,"zoomRightIn",{enumerable:!0,get:function(){return P.zoomRightIn}}),Object.defineProperty(w,"zoomRightOut",{enumerable:!0,get:function(){return P.zoomRightOut}}),Object.defineProperty(w,"zoomUpIn",{enumerable:!0,get:function(){return P.zoomUpIn}}),Object.defineProperty(w,"zoomUpOut",{enumerable:!0,get:function(){return P.zoomUpOut}});var z=x(84460),h=x(17060),D=x(17581),P=x(99269),X=F(x(57253))},94631:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.initMotion=void 0;const x=h=>({animationDuration:h,animationFillMode:"both"}),F=h=>({animationDuration:h,animationFillMode:"both"}),z=function(h,D,P,X){const fe=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${fe}${h}-enter,
      ${fe}${h}-appear
    `]:Object.assign(Object.assign({},x(X)),{animationPlayState:"paused"}),[`${fe}${h}-leave`]:Object.assign(Object.assign({},F(X)),{animationPlayState:"paused"}),[`
      ${fe}${h}-enter${h}-enter-active,
      ${fe}${h}-appear${h}-appear-active
    `]:{animationName:D,animationPlayState:"running"},[`${fe}${h}-leave${h}-leave-active`]:{animationName:P,animationPlayState:"running",pointerEvents:"none"}}};w.initMotion=z},17060:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.moveUpOut=w.moveUpIn=w.moveRightOut=w.moveRightIn=w.moveLeftOut=w.moveLeftIn=w.moveDownOut=w.moveDownIn=w.initMoveMotion=void 0;var F=x(6731),z=x(94631);const h=w.moveDownIn=new F.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),D=w.moveDownOut=new F.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),P=w.moveLeftIn=new F.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),X=w.moveLeftOut=new F.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),W=w.moveRightIn=new F.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),fe=w.moveRightOut=new F.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),J=w.moveUpIn=new F.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Be=w.moveUpOut=new F.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),B={"move-up":{inKeyframes:J,outKeyframes:Be},"move-down":{inKeyframes:h,outKeyframes:D},"move-left":{inKeyframes:P,outKeyframes:X},"move-right":{inKeyframes:W,outKeyframes:fe}},ee=(U,q)=>{const{antCls:le}=U,j=`${le}-${q}`,{inKeyframes:Ce,outKeyframes:$e}=B[q];return[(0,z.initMotion)(j,Ce,$e,U.motionDurationMid),{[`
        ${j}-enter,
        ${j}-appear
      `]:{opacity:0,animationTimingFunction:U.motionEaseOutCirc},[`${j}-leave`]:{animationTimingFunction:U.motionEaseInOutCirc}}]};w.initMoveMotion=ee},17581:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.slideUpOut=w.slideUpIn=w.slideRightOut=w.slideRightIn=w.slideLeftOut=w.slideLeftIn=w.slideDownOut=w.slideDownIn=w.initSlideMotion=void 0;var F=x(6731),z=x(94631);const h=w.slideUpIn=new F.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),D=w.slideUpOut=new F.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),P=w.slideDownIn=new F.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),X=w.slideDownOut=new F.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),W=w.slideLeftIn=new F.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),fe=w.slideLeftOut=new F.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),J=w.slideRightIn=new F.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Be=w.slideRightOut=new F.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),B={"slide-up":{inKeyframes:h,outKeyframes:D},"slide-down":{inKeyframes:P,outKeyframes:X},"slide-left":{inKeyframes:W,outKeyframes:fe},"slide-right":{inKeyframes:J,outKeyframes:Be}},ee=(U,q)=>{const{antCls:le}=U,j=`${le}-${q}`,{inKeyframes:Ce,outKeyframes:$e}=B[q];return[(0,z.initMotion)(j,Ce,$e,U.motionDurationMid),{[`
      ${j}-enter,
      ${j}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:U.motionEaseOutQuint,["&-prepare"]:{transform:"scale(1)"}},[`${j}-leave`]:{animationTimingFunction:U.motionEaseInQuint}}]};w.initSlideMotion=ee},99269:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.zoomUpOut=w.zoomUpIn=w.zoomRightOut=w.zoomRightIn=w.zoomOut=w.zoomLeftOut=w.zoomLeftIn=w.zoomIn=w.zoomDownOut=w.zoomDownIn=w.zoomBigOut=w.zoomBigIn=w.initZoomMotion=void 0;var F=x(6731),z=x(94631);const h=w.zoomIn=new F.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),D=w.zoomOut=new F.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),P=w.zoomBigIn=new F.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),X=w.zoomBigOut=new F.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),W=w.zoomUpIn=new F.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),fe=w.zoomUpOut=new F.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),J=w.zoomLeftIn=new F.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Be=w.zoomLeftOut=new F.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),B=w.zoomRightIn=new F.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),ee=w.zoomRightOut=new F.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),U=w.zoomDownIn=new F.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),q=w.zoomDownOut=new F.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),le={zoom:{inKeyframes:h,outKeyframes:D},"zoom-big":{inKeyframes:P,outKeyframes:X},"zoom-big-fast":{inKeyframes:P,outKeyframes:X},"zoom-left":{inKeyframes:J,outKeyframes:Be},"zoom-right":{inKeyframes:B,outKeyframes:ee},"zoom-up":{inKeyframes:W,outKeyframes:fe},"zoom-down":{inKeyframes:U,outKeyframes:q}},j=(Ce,$e)=>{const{antCls:Fe}=Ce,lt=`${Fe}-${$e}`,{inKeyframes:We,outKeyframes:Ze}=le[$e];return[(0,z.initMotion)(lt,We,Ze,$e==="zoom-big-fast"?Ce.motionDurationFast:Ce.motionDurationMid),{[`
        ${lt}-enter,
        ${lt}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:Ce.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${lt}-leave`]:{animationTimingFunction:Ce.motionEaseInOutCirc}}]};w.initZoomMotion=j},22548:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.operationUnit=void 0;const x=F=>({color:F.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${F.motionDurationSlow}`,"&:focus, &:hover":{color:F.colorLinkHover},"&:active":{color:F.colorLinkActive}});w.operationUnit=x},9064:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.MAX_VERTICAL_CONTENT_RADIUS=void 0,w.default=P,w.getArrowOffsetToken=h;var F=x(51337);const z=w.MAX_VERTICAL_CONTENT_RADIUS=8;function h(X){const{contentRadius:W,limitVerticalRadius:fe}=X,J=W>12?W+2:12;return{arrowOffsetHorizontal:J,arrowOffsetVertical:fe?z:J}}function D(X,W){return X?W:{}}function P(X,W,fe){const{componentCls:J,boxShadowPopoverArrow:Be,arrowOffsetVertical:B,arrowOffsetHorizontal:ee}=X,{arrowDistance:U=0,arrowPlacement:q={left:!0,right:!0,top:!0,bottom:!0}}=fe||{};return{[J]:Object.assign(Object.assign(Object.assign(Object.assign({[`${J}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,F.genRoundedArrow)(X,W,Be)),{"&:before":{background:W}})]},D(!!q.top,{[[`&-placement-top > ${J}-arrow`,`&-placement-topLeft > ${J}-arrow`,`&-placement-topRight > ${J}-arrow`].join(",")]:{bottom:U,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${J}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft > ${J}-arrow`]:{left:{_skip_check_:!0,value:ee}},[`&-placement-topRight > ${J}-arrow`]:{right:{_skip_check_:!0,value:ee}}})),D(!!q.bottom,{[[`&-placement-bottom > ${J}-arrow`,`&-placement-bottomLeft > ${J}-arrow`,`&-placement-bottomRight > ${J}-arrow`].join(",")]:{top:U,transform:"translateY(-100%)"},[`&-placement-bottom > ${J}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft > ${J}-arrow`]:{left:{_skip_check_:!0,value:ee}},[`&-placement-bottomRight > ${J}-arrow`]:{right:{_skip_check_:!0,value:ee}}})),D(!!q.left,{[[`&-placement-left > ${J}-arrow`,`&-placement-leftTop > ${J}-arrow`,`&-placement-leftBottom > ${J}-arrow`].join(",")]:{right:{_skip_check_:!0,value:U},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${J}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${J}-arrow`]:{top:B},[`&-placement-leftBottom > ${J}-arrow`]:{bottom:B}})),D(!!q.right,{[[`&-placement-right > ${J}-arrow`,`&-placement-rightTop > ${J}-arrow`,`&-placement-rightBottom > ${J}-arrow`].join(",")]:{left:{_skip_check_:!0,value:U},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${J}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${J}-arrow`]:{top:B},[`&-placement-rightBottom > ${J}-arrow`]:{bottom:B}}))}}},51337:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.genRoundedArrow=void 0,w.getArrowToken=z;var F=x(6731);function z(D){const{sizePopupArrow:P,borderRadiusXS:X,borderRadiusOuter:W}=D,fe=P/2,J=0,Be=fe,B=W*1/Math.sqrt(2),ee=fe-W*(1-1/Math.sqrt(2)),U=fe-X*(1/Math.sqrt(2)),q=W*(Math.sqrt(2)-1)+X*(1/Math.sqrt(2)),le=2*fe-U,j=q,Ce=2*fe-B,$e=ee,Fe=2*fe-J,lt=Be,We=fe*Math.sqrt(2)+W*(Math.sqrt(2)-2),Ze=W*(Math.sqrt(2)-1),pe=`polygon(${Ze}px 100%, 50% ${Ze}px, ${2*fe-Ze}px 100%, ${Ze}px 100%)`,se=`path('M ${J} ${Be} A ${W} ${W} 0 0 0 ${B} ${ee} L ${U} ${q} A ${X} ${X} 0 0 1 ${le} ${j} L ${Ce} ${$e} A ${W} ${W} 0 0 0 ${Fe} ${lt} Z')`;return{arrowShadowWidth:We,arrowPath:se,arrowPolygon:pe}}const h=(D,P,X)=>{const{sizePopupArrow:W,arrowPolygon:fe,arrowPath:J,arrowShadowWidth:Be,borderRadiusXS:B,calc:ee}=D;return{pointerEvents:"none",width:W,height:W,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:W,height:ee(W).div(2).equal(),background:P,clipPath:{_multi_value_:!0,value:[fe,J]},content:'""'},"&::after":{content:'""',position:"absolute",width:Be,height:Be,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,F.unit)(B)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:X,zIndex:0,background:"transparent"}}};w.genRoundedArrow=h},89329:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.defaultTheme=w.defaultConfig=w.DesignTokenContext=void 0;var z=F(x(67294)),h=x(6731),D=F(x(9924)),P=F(x(98411));const X=w.defaultTheme=(0,h.createTheme)(D.default),W=w.defaultConfig={token:P.default,override:{override:P.default},hashed:!0},fe=w.DesignTokenContext=z.default.createContext(W)},36496:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"PresetColors",{enumerable:!0,get:function(){return F.PresetColors}});var F=x(81342)},81342:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.PresetColors=void 0;const x=w.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"]},3184:function(He,w,x){"use strict";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"DesignTokenContext",{enumerable:!0,get:function(){return ee.DesignTokenContext}}),Object.defineProperty(w,"PresetColors",{enumerable:!0,get:function(){return D.PresetColors}}),Object.defineProperty(w,"calc",{enumerable:!0,get:function(){return Be.default}}),Object.defineProperty(w,"defaultConfig",{enumerable:!0,get:function(){return ee.defaultConfig}}),Object.defineProperty(w,"genComponentStyleHook",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(w,"genPresetColor",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(w,"genStyleHooks",{enumerable:!0,get:function(){return X.genStyleHooks}}),Object.defineProperty(w,"genSubStyleComponent",{enumerable:!0,get:function(){return X.genSubStyleComponent}}),Object.defineProperty(w,"getLineHeight",{enumerable:!0,get:function(){return B.getLineHeight}}),Object.defineProperty(w,"mergeToken",{enumerable:!0,get:function(){return fe.merge}}),Object.defineProperty(w,"statisticToken",{enumerable:!0,get:function(){return fe.default}}),Object.defineProperty(w,"useResetIconStyle",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(w,"useStyleRegister",{enumerable:!0,get:function(){return h.useStyleRegister}}),Object.defineProperty(w,"useToken",{enumerable:!0,get:function(){return P.default}});var h=x(6731),D=x(36496),P=z(x(41401)),X=F(x(3737)),W=z(x(36219)),fe=F(x(99636)),J=z(x(54894)),Be=z(x(22996)),B=x(62231),ee=x(89329)},26162:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.getSolidColor=w.getAlphaColor=void 0;var F=x(131);const z=(D,P)=>new F.TinyColor(D).setAlpha(P).toRgbString();w.getAlphaColor=z;const h=(D,P)=>new F.TinyColor(D).darken(P).toHexString();w.getSolidColor=h},80373:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.generateNeutralColorPalettes=w.generateColorPalettes=void 0;var F=x(78589),z=x(26162);const h=P=>{const X=(0,F.generate)(P);return{1:X[0],2:X[1],3:X[2],4:X[3],5:X[4],6:X[5],7:X[6],8:X[4],9:X[5],10:X[6]}};w.generateColorPalettes=h;const D=(P,X)=>{const W=P||"#fff",fe=X||"#000";return{colorBgBase:W,colorTextBase:fe,colorText:(0,z.getAlphaColor)(fe,.88),colorTextSecondary:(0,z.getAlphaColor)(fe,.65),colorTextTertiary:(0,z.getAlphaColor)(fe,.45),colorTextQuaternary:(0,z.getAlphaColor)(fe,.25),colorFill:(0,z.getAlphaColor)(fe,.15),colorFillSecondary:(0,z.getAlphaColor)(fe,.06),colorFillTertiary:(0,z.getAlphaColor)(fe,.04),colorFillQuaternary:(0,z.getAlphaColor)(fe,.02),colorBgLayout:(0,z.getSolidColor)(W,4),colorBgContainer:(0,z.getSolidColor)(W,0),colorBgElevated:(0,z.getSolidColor)(W,0),colorBgSpotlight:(0,z.getAlphaColor)(fe,.85),colorBgBlur:"transparent",colorBorder:(0,z.getSolidColor)(W,15),colorBorderSecondary:(0,z.getSolidColor)(W,6)}};w.generateNeutralColorPalettes=D},9924:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=Be;var z=x(78589),h=F(x(54730)),D=F(x(19216)),P=x(98411),X=F(x(10805)),W=F(x(81594)),fe=x(80373),J=F(x(69853));function Be(B){const ee=Object.keys(P.defaultPresetColors).map(U=>{const q=(0,z.generate)(B[U]);return new Array(10).fill(1).reduce((le,j,Ce)=>(le[`${U}-${Ce+1}`]=q[Ce],le[`${U}${Ce+1}`]=q[Ce],le),{})}).reduce((U,q)=>(U=Object.assign(Object.assign({},U),q),U),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},B),ee),(0,X.default)(B,{generateColorPalettes:fe.generateColorPalettes,generateNeutralColorPalettes:fe.generateNeutralColorPalettes})),(0,J.default)(B.fontSize)),(0,D.default)(B)),(0,h.default)(B)),(0,W.default)(B))}},98411:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.defaultPresetColors=w.default=void 0;const x=w.defaultPresetColors={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},F=Object.assign(Object.assign({},x),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});var z=w.default=F},10805:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=z;var F=x(131);function z(h,D){let{generateColorPalettes:P,generateNeutralColorPalettes:X}=D;const{colorSuccess:W,colorWarning:fe,colorError:J,colorInfo:Be,colorPrimary:B,colorBgBase:ee,colorTextBase:U}=h,q=P(B),le=P(W),j=P(fe),Ce=P(J),$e=P(Be),Fe=X(ee,U),lt=h.colorLink||h.colorInfo,We=P(lt);return Object.assign(Object.assign({},Fe),{colorPrimaryBg:q[1],colorPrimaryBgHover:q[2],colorPrimaryBorder:q[3],colorPrimaryBorderHover:q[4],colorPrimaryHover:q[5],colorPrimary:q[6],colorPrimaryActive:q[7],colorPrimaryTextHover:q[8],colorPrimaryText:q[9],colorPrimaryTextActive:q[10],colorSuccessBg:le[1],colorSuccessBgHover:le[2],colorSuccessBorder:le[3],colorSuccessBorderHover:le[4],colorSuccessHover:le[4],colorSuccess:le[6],colorSuccessActive:le[7],colorSuccessTextHover:le[8],colorSuccessText:le[9],colorSuccessTextActive:le[10],colorErrorBg:Ce[1],colorErrorBgHover:Ce[2],colorErrorBorder:Ce[3],colorErrorBorderHover:Ce[4],colorErrorHover:Ce[5],colorError:Ce[6],colorErrorActive:Ce[7],colorErrorTextHover:Ce[8],colorErrorText:Ce[9],colorErrorTextActive:Ce[10],colorWarningBg:j[1],colorWarningBgHover:j[2],colorWarningBorder:j[3],colorWarningBorderHover:j[4],colorWarningHover:j[4],colorWarning:j[6],colorWarningActive:j[7],colorWarningTextHover:j[8],colorWarningText:j[9],colorWarningTextActive:j[10],colorInfoBg:$e[1],colorInfoBgHover:$e[2],colorInfoBorder:$e[3],colorInfoBorderHover:$e[4],colorInfoHover:$e[4],colorInfo:$e[6],colorInfoActive:$e[7],colorInfoTextHover:$e[8],colorInfoText:$e[9],colorInfoTextActive:$e[10],colorLinkHover:We[4],colorLink:We[6],colorLinkActive:We[7],colorBgMask:new F.TinyColor("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},81594:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=h;var z=F(x(78117));function h(D){const{motionUnit:P,motionBase:X,borderRadius:W,lineWidth:fe}=D;return Object.assign({motionDurationFast:`${(X+P).toFixed(1)}s`,motionDurationMid:`${(X+P*2).toFixed(1)}s`,motionDurationSlow:`${(X+P*3).toFixed(1)}s`,lineWidthBold:fe+1},(0,z.default)(W))}},54730:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const x=z=>{const{controlHeight:h}=z;return{controlHeightSM:h*.75,controlHeightXS:h*.5,controlHeightLG:h*1.25}};var F=w.default=x},69853:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(62231));const h=P=>{const X=(0,z.default)(P),W=X.map(le=>le.size),fe=X.map(le=>le.lineHeight),J=W[1],Be=W[0],B=W[2],ee=fe[1],U=fe[0],q=fe[2];return{fontSizeSM:Be,fontSize:J,fontSizeLG:B,fontSizeXL:W[3],fontSizeHeading1:W[6],fontSizeHeading2:W[5],fontSizeHeading3:W[4],fontSizeHeading4:W[3],fontSizeHeading5:W[2],lineHeight:ee,lineHeightLG:q,lineHeightSM:U,fontHeight:Math.round(ee*J),fontHeightLG:Math.round(q*B),fontHeightSM:Math.round(U*Be),lineHeightHeading1:fe[6],lineHeightHeading2:fe[5],lineHeightHeading3:fe[4],lineHeightHeading4:fe[3],lineHeightHeading5:fe[2]}};var D=w.default=h},62231:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=F,w.getLineHeight=x;function x(z){return(z+8)/z}function F(z){const h=new Array(10).fill(null).map((D,P)=>{const X=P-1,W=z*Math.pow(2.71828,X/5),fe=P>1?Math.floor(W):Math.ceil(W);return Math.floor(fe/2)*2});return h[1]=z,h.map(D=>({size:D,lineHeight:x(D)}))}},78117:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const x=z=>{let h=z,D=z,P=z,X=z;return z<6&&z>=5?h=z+1:z<16&&z>=6?h=z+2:z>=16&&(h=16),z<7&&z>=5?D=4:z<8&&z>=7?D=5:z<14&&z>=8?D=6:z<16&&z>=14?D=7:z>=16&&(D=8),z<6&&z>=2?P=1:z>=6&&(P=2),z>4&&z<8?X=4:z>=8&&(X=6),{borderRadius:z,borderRadiusXS:P,borderRadiusSM:D,borderRadiusLG:h,borderRadiusOuter:X}};var F=w.default=x},19216:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=x;function x(F){const{sizeUnit:z,sizeStep:h}=F;return{sizeXXL:z*(h+8),sizeXL:z*(h+4),sizeLG:z*(h+2),sizeMD:z*(h+1),sizeMS:z*h,size:z*h,sizeSM:z*(h-1),sizeXS:z*(h-2),sizeXXS:z*(h-3)}}},41401:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=U,w.unitless=w.ignore=w.getComputedToken=void 0;var z=F(x(67294)),h=x(6731),D=F(x(87629)),P=x(89329),X=F(x(98411)),W=F(x(27722)),fe=function(q,le){var j={};for(var Ce in q)Object.prototype.hasOwnProperty.call(q,Ce)&&le.indexOf(Ce)<0&&(j[Ce]=q[Ce]);if(q!=null&&typeof Object.getOwnPropertySymbols=="function")for(var $e=0,Ce=Object.getOwnPropertySymbols(q);$e<Ce.length;$e++)le.indexOf(Ce[$e])<0&&Object.prototype.propertyIsEnumerable.call(q,Ce[$e])&&(j[Ce[$e]]=q[Ce[$e]]);return j};const J=w.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0},Be=w.ignore={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},B={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},ee=(q,le,j)=>{const Ce=j.getDerivativeToken(q),{override:$e}=le,Fe=fe(le,["override"]);let lt=Object.assign(Object.assign({},Ce),{override:$e});return lt=(0,W.default)(lt),Fe&&Object.entries(Fe).forEach(We=>{let[Ze,pe]=We;const{theme:se}=pe,be=fe(pe,["theme"]);let Te=be;se&&(Te=ee(Object.assign(Object.assign({},lt),be),{override:be},se)),lt[Ze]=Te}),lt};w.getComputedToken=ee;function U(){const{token:q,hashed:le,theme:j,override:Ce,cssVar:$e}=z.default.useContext(P.DesignTokenContext),Fe=`${D.default}-${le||""}`,lt=j||P.defaultTheme,[We,Ze,pe]=(0,h.useCacheToken)(lt,[X.default,q],{salt:Fe,override:Ce,getComputedToken:ee,formatToken:W.default,cssVar:$e&&{prefix:$e.prefix,key:$e.key,unitless:J,ignore:Be,preserve:B}});return[lt,pe,le?Ze:"",We,$e]}},27722:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=X;var z=x(131),h=F(x(98411)),D=F(x(83609)),P=function(W,fe){var J={};for(var Be in W)Object.prototype.hasOwnProperty.call(W,Be)&&fe.indexOf(Be)<0&&(J[Be]=W[Be]);if(W!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,Be=Object.getOwnPropertySymbols(W);B<Be.length;B++)fe.indexOf(Be[B])<0&&Object.prototype.propertyIsEnumerable.call(W,Be[B])&&(J[Be[B]]=W[Be[B]]);return J};function X(W){const{override:fe}=W,J=P(W,["override"]),Be=Object.assign({},fe);Object.keys(h.default).forEach(Fe=>{delete Be[Fe]});const B=Object.assign(Object.assign({},J),Be),ee=480,U=576,q=768,le=992,j=1200,Ce=1600;if(B.motion===!1){const Fe="0s";B.motionDurationFast=Fe,B.motionDurationMid=Fe,B.motionDurationSlow=Fe}return Object.assign(Object.assign(Object.assign({},B),{colorFillContent:B.colorFillSecondary,colorFillContentHover:B.colorFill,colorFillAlter:B.colorFillQuaternary,colorBgContainerDisabled:B.colorFillTertiary,colorBorderBg:B.colorBgContainer,colorSplit:(0,D.default)(B.colorBorderSecondary,B.colorBgContainer),colorTextPlaceholder:B.colorTextQuaternary,colorTextDisabled:B.colorTextQuaternary,colorTextHeading:B.colorText,colorTextLabel:B.colorTextSecondary,colorTextDescription:B.colorTextTertiary,colorTextLightSolid:B.colorWhite,colorHighlight:B.colorError,colorBgTextHover:B.colorFillSecondary,colorBgTextActive:B.colorFill,colorIcon:B.colorTextTertiary,colorIconHover:B.colorText,colorErrorOutline:(0,D.default)(B.colorErrorBg,B.colorBgContainer),colorWarningOutline:(0,D.default)(B.colorWarningBg,B.colorBgContainer),fontSizeIcon:B.fontSizeSM,lineWidthFocus:B.lineWidth*4,lineWidth:B.lineWidth,controlOutlineWidth:B.lineWidth*2,controlInteractiveSize:B.controlHeight/2,controlItemBgHover:B.colorFillTertiary,controlItemBgActive:B.colorPrimaryBg,controlItemBgActiveHover:B.colorPrimaryBgHover,controlItemBgActiveDisabled:B.colorFill,controlTmpOutline:B.colorFillQuaternary,controlOutline:(0,D.default)(B.colorPrimaryBg,B.colorBgContainer),lineType:B.lineType,borderRadius:B.borderRadius,borderRadiusXS:B.borderRadiusXS,borderRadiusSM:B.borderRadiusSM,borderRadiusLG:B.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:B.sizeXXS,paddingXS:B.sizeXS,paddingSM:B.sizeSM,padding:B.size,paddingMD:B.sizeMD,paddingLG:B.sizeLG,paddingXL:B.sizeXL,paddingContentHorizontalLG:B.sizeLG,paddingContentVerticalLG:B.sizeMS,paddingContentHorizontal:B.sizeMS,paddingContentVertical:B.sizeSM,paddingContentHorizontalSM:B.size,paddingContentVerticalSM:B.sizeXS,marginXXS:B.sizeXXS,marginXS:B.sizeXS,marginSM:B.sizeSM,margin:B.size,marginMD:B.sizeMD,marginLG:B.sizeLG,marginXL:B.sizeXL,marginXXL:B.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:ee,screenXSMin:ee,screenXSMax:U-1,screenSM:U,screenSMMin:U,screenSMMax:q-1,screenMD:q,screenMDMin:q,screenMDMax:le-1,screenLG:le,screenLGMin:le,screenLGMax:j-1,screenXL:j,screenXLMin:j,screenXLMax:Ce-1,screenXXL:Ce,screenXXLMin:Ce,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new z.TinyColor("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new z.TinyColor("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new z.TinyColor("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),Be)}},24312:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(56690)),h=F(x(89728)),D=F(x(76976)),P=F(x(61655)),X=F(x(38194));const W="CALC_UNIT";function fe(Be){return typeof Be=="number"?`${Be}${W}`:Be}let J=w.default=function(Be){(0,P.default)(B,Be);function B(ee){var U;return(0,z.default)(this,B),U=(0,D.default)(this,B),U.result="",ee instanceof B?U.result=`(${ee.result})`:typeof ee=="number"?U.result=fe(ee):typeof ee=="string"&&(U.result=ee),U}return(0,h.default)(B,[{key:"add",value:function(U){return U instanceof B?this.result=`${this.result} + ${U.getResult()}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} + ${fe(U)}`),this.lowPriority=!0,this}},{key:"sub",value:function(U){return U instanceof B?this.result=`${this.result} - ${U.getResult()}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} - ${fe(U)}`),this.lowPriority=!0,this}},{key:"mul",value:function(U){return this.lowPriority&&(this.result=`(${this.result})`),U instanceof B?this.result=`${this.result} * ${U.getResult(!0)}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} * ${U}`),this.lowPriority=!1,this}},{key:"div",value:function(U){return this.lowPriority&&(this.result=`(${this.result})`),U instanceof B?this.result=`${this.result} / ${U.getResult(!0)}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} / ${U}`),this.lowPriority=!1,this}},{key:"getResult",value:function(U){return this.lowPriority||U?`(${this.result})`:this.result}},{key:"equal",value:function(U){const{unit:q=!0}=U||{},le=new RegExp(`${W}`,"g");return this.result=this.result.replace(le,q?"px":""),typeof this.lowPriority!="undefined"?`calc(${this.result})`:this.result}}]),B}(X.default)},14774:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(56690)),h=F(x(89728)),D=F(x(76976)),P=F(x(61655)),X=F(x(38194));let W=w.default=function(fe){(0,P.default)(J,fe);function J(Be){var B;return(0,z.default)(this,J),B=(0,D.default)(this,J),B.result=0,Be instanceof J?B.result=Be.result:typeof Be=="number"&&(B.result=Be),B}return(0,h.default)(J,[{key:"add",value:function(B){return B instanceof J?this.result+=B.result:typeof B=="number"&&(this.result+=B),this}},{key:"sub",value:function(B){return B instanceof J?this.result-=B.result:typeof B=="number"&&(this.result-=B),this}},{key:"mul",value:function(B){return B instanceof J?this.result*=B.result:typeof B=="number"&&(this.result*=B),this}},{key:"div",value:function(B){return B instanceof J?this.result/=B.result:typeof B=="number"&&(this.result/=B),this}},{key:"equal",value:function(){return this.result}}]),J}(X.default)},38194:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(89728)),h=F(x(56690));let D=(0,z.default)(function X(){(0,h.default)(this,X)});var P=w.default=D},22996:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(14774)),h=F(x(24312));const D=X=>{const W=X==="css"?h.default:z.default;return fe=>new W(fe)};var P=w.default=D},3737:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=j,w.genSubStyleComponent=w.genStyleHooks=void 0;var h=z(x(67294)),D=x(6731),P=x(56790),X=x(7177),W=x(98078),fe=z(x(41401)),J=F(x(22996)),Be=F(x(1657)),B=z(x(99636)),ee=F(x(54894));const U=(lt,We,Ze)=>{var pe;return typeof Ze=="function"?Ze((0,B.merge)(We,(pe=We[lt])!==null&&pe!==void 0?pe:{})):Ze!=null?Ze:{}},q=(lt,We,Ze,pe)=>{const se=Object.assign({},We[lt]);if(pe!=null&&pe.deprecatedTokens){const{deprecatedTokens:Te}=pe;Te.forEach(de=>{let[Rt,ye]=de;var Ve;(se!=null&&se[Rt]||se!=null&&se[ye])&&((Ve=se[ye])!==null&&Ve!==void 0||(se[ye]=se==null?void 0:se[Rt]))})}const be=Object.assign(Object.assign({},Ze),se);return Object.keys(be).forEach(Te=>{be[Te]===We[Te]&&delete be[Te]}),be},le=(lt,We)=>`${[We,lt.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-")}`;function j(lt,We,Ze){let pe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const se=Array.isArray(lt)?lt:[lt,lt],[be]=se,Te=se.join("-");return function(de){let Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:de;const[ye,Ve,oe,Re,Se]=(0,fe.default)(),{getPrefixCls:et,iconPrefixCls:st,csp:pt}=(0,h.useContext)(X.ConfigContext),bt=et(),ke=Se?"css":"js",ur=(0,J.default)(ke),{max:qt,min:_n}=(0,Be.default)(ke),Zr={theme:ye,token:Re,hashId:oe,nonce:()=>pt==null?void 0:pt.nonce,clientOnly:pe.clientOnly,order:pe.order||-999};return(0,D.useStyleRegister)(Object.assign(Object.assign({},Zr),{clientOnly:!1,path:["Shared",bt]}),()=>[{"&":(0,W.genLinkStyle)(Re)}]),(0,ee.default)(st,pt),[(0,D.useStyleRegister)(Object.assign(Object.assign({},Zr),{path:[Te,de,st]}),()=>{if(pe.injectStyle===!1)return[];const{token:rn,flush:Qr}=(0,B.default)(Re),ln=U(be,Ve,Ze),vn=`.${de}`,$t=q(be,Ve,ln,{deprecatedTokens:pe.deprecatedTokens});Se&&Object.keys(ln).forEach(qe=>{ln[qe]=`var(${(0,D.token2CSSVar)(qe,le(be,Se.prefix))})`});const _r=(0,B.merge)(rn,{componentCls:vn,prefixCls:de,iconCls:`.${st}`,antCls:`.${bt}`,calc:ur,max:qt,min:_n},Se?ln:$t),kt=We(_r,{hashId:oe,prefixCls:de,rootPrefixCls:bt,iconPrefixCls:st});return Qr(be,$t),[pe.resetStyle===!1?null:(0,W.genCommonStyle)(_r,de,Rt),kt]}),oe]}}const Ce=(lt,We,Ze,pe)=>{const se=j(lt,We,Ze,Object.assign({resetStyle:!1,order:-998},pe));return Te=>{let{prefixCls:de,rootCls:Rt=de}=Te;return se(de,Rt),null}};w.genSubStyleComponent=Ce;const $e=(lt,We,Ze)=>{function pe(ye){return`${lt}${ye.slice(0,1).toUpperCase()}${ye.slice(1)}`}const{unitless:se={},injectStyle:be=!0}=Ze!=null?Ze:{},Te={[pe("zIndexPopup")]:!0};Object.keys(se).forEach(ye=>{Te[pe(ye)]=se[ye]});const de=ye=>{let{rootCls:Ve,cssVar:oe}=ye;const[,Re]=(0,fe.default)();return(0,D.useCSSVarRegister)({path:[lt],prefix:oe.prefix,key:oe==null?void 0:oe.key,unitless:Object.assign(Object.assign({},fe.unitless),Te),ignore:fe.ignore,token:Re,scope:Ve},()=>{const Se=U(lt,Re,We),et=q(lt,Re,Se,{deprecatedTokens:Ze==null?void 0:Ze.deprecatedTokens});return Object.keys(Se).forEach(st=>{et[pe(st)]=et[st],delete et[st]}),et}),null};return ye=>{const[,,,,Ve]=(0,fe.default)();return[oe=>be&&Ve?h.default.createElement(h.default.Fragment,null,h.default.createElement(de,{rootCls:ye,cssVar:Ve,component:lt}),oe):oe,Ve==null?void 0:Ve.key]}},Fe=(lt,We,Ze,pe)=>{const se=j(lt,We,Ze,pe),be=$e(Array.isArray(lt)?lt[0]:lt,Ze,pe);return function(Te){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Te;const[,Rt]=se(Te,de),[ye,Ve]=be(de);return[ye,Rt,Ve]}};w.genStyleHooks=Fe},36219:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=z;var F=x(36496);function z(h,D){return F.PresetColors.reduce((P,X)=>{const W=h[`${X}1`],fe=h[`${X}3`],J=h[`${X}6`],Be=h[`${X}7`];return Object.assign(Object.assign({},P),D(X,{lightColor:W,lightBorderColor:fe,darkColor:J,textColor:Be}))},{})}},83609:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var F=x(131);function z(P){return P>=0&&P<=255}function h(P,X){const{r:W,g:fe,b:J,a:Be}=new F.TinyColor(P).toRgb();if(Be<1)return P;const{r:B,g:ee,b:U}=new F.TinyColor(X).toRgb();for(let q=.01;q<=1;q+=.01){const le=Math.round((W-B*(1-q))/q),j=Math.round((fe-ee*(1-q))/q),Ce=Math.round((J-U*(1-q))/q);if(z(le)&&z(j)&&z(Ce))return new F.TinyColor({r:le,g:j,b:Ce,a:Math.round(q*100)/100}).toRgbString()}return new F.TinyColor({r:W,g:fe,b:J,a:1}).toRgbString()}var D=w.default=h},1657:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=z;var F=x(6731);function z(h){return h==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var D=arguments.length,P=new Array(D),X=0;X<D;X++)P[X]=arguments[X];return`max(${P.map(W=>(0,F.unit)(W)).join(",")})`},min:function(){for(var D=arguments.length,P=new Array(D),X=0;X<D;X++)P[X]=arguments[X];return`min(${P.map(W=>(0,F.unit)(W)).join(",")})`}}}},99636:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=w._statistic_build_=void 0,w.merge=z,w.statistic=void 0;const x=typeof CSSINJS_STATISTIC!="undefined";let F=!0;function z(){for(var fe=arguments.length,J=new Array(fe),Be=0;Be<fe;Be++)J[Be]=arguments[Be];if(!x)return Object.assign.apply(Object,[{}].concat(J));F=!1;const B={};return J.forEach(ee=>{Object.keys(ee).forEach(q=>{Object.defineProperty(B,q,{configurable:!0,enumerable:!0,get:()=>ee[q]})})}),F=!0,B}const h=w.statistic={},D=w._statistic_build_={};function P(){}const X=fe=>{let J,Be=fe,B=P;return x&&typeof Proxy!="undefined"&&(J=new Set,Be=new Proxy(fe,{get(ee,U){return F&&J.add(U),ee[U]}}),B=(ee,U)=>{var q;h[ee]={global:Array.from(J),component:Object.assign(Object.assign({},(q=h[ee])===null||q===void 0?void 0:q.component),U)}}),{token:Be,keys:J,flush:B}};var W=w.default=X},54894:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=x(6731),h=x(98078),D=F(x(41401));const P=(W,fe)=>{const[J,Be]=(0,D.default)();return(0,z.useStyleRegister)({theme:J,token:Be,hashId:"",path:["ant-design-icons",W],nonce:()=>fe==null?void 0:fe.nonce},()=>[{[`.${W}`]:Object.assign(Object.assign({},(0,h.resetIcon)()),{[`.${W} .${W}-icon`]:{display:"block"}})}])};var X=w.default=P},52040:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const x={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};var F=w.default=x},92125:function(He,w,x){"use strict";"use client";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(93967)),D=x(92419),P=F(x(67294)),X=x(31929),W=z(x(15086)),fe=x(48125);const J=B=>{const{prefixCls:ee,className:U,placement:q="top",title:le,color:j,overlayInnerStyle:Ce}=B,{getPrefixCls:$e}=P.useContext(X.ConfigContext),Fe=$e("tooltip",ee),[lt,We,Ze]=(0,W.default)(Fe),pe=(0,fe.parseColor)(Fe,j),se=pe.arrowStyle,be=Object.assign(Object.assign({},Ce),pe.overlayStyle),Te=(0,h.default)(We,Ze,Fe,`${Fe}-pure`,`${Fe}-placement-${q}`,U,pe.className);return lt(P.createElement("div",{className:Te,style:se},P.createElement("div",{className:`${Fe}-arrow`}),P.createElement(D.Popup,Object.assign({},B,{className:We,prefixCls:Fe,overlayInnerStyle:be}),le)))};var Be=w.default=J},94055:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=F(x(93967)),P=F(x(92419)),X=F(x(60869)),W=x(56333),fe=x(53683),J=F(x(74132)),Be=x(47419),B=x(13594),ee=F(x(96877)),U=x(31929),q=x(46549),le=x(3184),j=F(x(92125)),Ce=F(x(15086)),$e=x(48125),Fe=function(Ze,pe){var se={};for(var be in Ze)Object.prototype.hasOwnProperty.call(Ze,be)&&pe.indexOf(be)<0&&(se[be]=Ze[be]);if(Ze!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Te=0,be=Object.getOwnPropertySymbols(Ze);Te<be.length;Te++)pe.indexOf(be[Te])<0&&Object.prototype.propertyIsEnumerable.call(Ze,be[Te])&&(se[be[Te]]=Ze[be[Te]]);return se};const lt=h.forwardRef((Ze,pe)=>{var se,be;const{prefixCls:Te,openClassName:de,getTooltipContainer:Rt,overlayClassName:ye,color:Ve,overlayInnerStyle:oe,children:Re,afterOpenChange:Se,afterVisibleChange:et,destroyTooltipOnHide:st,arrow:pt=!0,title:bt,overlay:ke,builtinPlacements:ur,arrowPointAtCenter:qt=!1,autoAdjustOverflow:_n=!0}=Ze,Zr=!!pt,[,Vr]=(0,le.useToken)(),{getPopupContainer:rn,getPrefixCls:Qr,direction:ln}=h.useContext(U.ConfigContext),vn=(0,B.devUseWarning)("Tooltip"),$t=h.useRef(null),_r=()=>{var ve;(ve=$t.current)===null||ve===void 0||ve.forceAlign()};h.useImperativeHandle(pe,()=>({forceAlign:_r,forcePopupAlign:()=>{vn.deprecated(!1,"forcePopupAlign","forceAlign"),_r()}}));const[kt,qe]=(0,X.default)(!1,{value:(se=Ze.open)!==null&&se!==void 0?se:Ze.visible,defaultValue:(be=Ze.defaultOpen)!==null&&be!==void 0?be:Ze.defaultVisible}),Sr=!bt&&!ke&&bt!==0,Pe=ve=>{var Oe,Xe;qe(Sr?!1:ve),Sr||((Oe=Ze.onOpenChange)===null||Oe===void 0||Oe.call(Ze,ve),(Xe=Ze.onVisibleChange)===null||Xe===void 0||Xe.call(Ze,ve))},Hr=h.useMemo(()=>{var ve,Oe;let Xe=qt;return typeof pt=="object"&&(Xe=(Oe=(ve=pt.pointAtCenter)!==null&&ve!==void 0?ve:pt.arrowPointAtCenter)!==null&&Oe!==void 0?Oe:qt),ur||(0,J.default)({arrowPointAtCenter:Xe,autoAdjustOverflow:_n,arrowWidth:Zr?Vr.sizePopupArrow:0,borderRadius:Vr.borderRadius,offset:Vr.marginXXS,visibleFirst:!0})},[qt,pt,ur,Vr]),vr=h.useMemo(()=>bt===0?bt:ke||bt||"",[ke,bt]),Ie=h.createElement(q.NoCompactStyle,null,typeof vr=="function"?vr():vr),{getPopupContainer:gr,placement:Wr="top",mouseEnterDelay:Dr=.1,mouseLeaveDelay:Xr=.1,overlayStyle:Vn,rootClassName:ni}=Ze,Dn=Fe(Ze,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),Jn=Qr("tooltip",Te),Yi=Qr(),bi=Ze["data-popover-inject"];let ui=kt;!("open"in Ze)&&!("visible"in Ze)&&Sr&&(ui=!1);const pi=h.isValidElement(Re)&&!(0,Be.isFragment)(Re)?Re:h.createElement("span",null,Re),it=pi.props,V=!it.className||typeof it.className=="string"?(0,D.default)(it.className,de||`${Jn}-open`):it.className,[H,Ee,Le]=(0,Ce.default)(Jn,!bi),ze=(0,$e.parseColor)(Jn,Ve),xt=ze.arrowStyle,Ut=Object.assign(Object.assign({},oe),ze.overlayStyle),ir=(0,D.default)(ye,{[`${Jn}-rtl`]:ln==="rtl"},ze.className,ni,Ee,Le),[Ft,te]=(0,W.useZIndex)("Tooltip",Dn.zIndex),Q=h.createElement(P.default,Object.assign({},Dn,{zIndex:Ft,showArrow:Zr,placement:Wr,mouseEnterDelay:Dr,mouseLeaveDelay:Xr,prefixCls:Jn,overlayClassName:ir,overlayStyle:Object.assign(Object.assign({},xt),Vn),getTooltipContainer:gr||Rt||rn,ref:$t,builtinPlacements:Hr,overlay:Ie,visible:ui,onVisibleChange:Pe,afterVisibleChange:Se!=null?Se:et,overlayInnerStyle:Ut,arrowContent:h.createElement("span",{className:`${Jn}-arrow-content`}),motion:{motionName:(0,fe.getTransitionName)(Yi,"zoom-big-fast",Ze.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!st}),ui?(0,Be.cloneElement)(pi,{className:V}):pi);return H(h.createElement(ee.default.Provider,{value:te},Q))});lt._InternalPanelDoNotUseOrYouWillBeFired=j.default;var We=w.default=lt},15086:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.prepareComponentToken=w.default=void 0;var z=x(98078),h=x(42836),D=F(x(9064)),P=x(3184),X=x(6731),W=x(51337);const fe=B=>{const{componentCls:ee,tooltipMaxWidth:U,tooltipColor:q,tooltipBg:le,tooltipBorderRadius:j,zIndexPopup:Ce,controlHeight:$e,boxShadowSecondary:Fe,paddingSM:lt,paddingXS:We}=B;return[{[ee]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,z.resetComponent)(B)),{position:"absolute",zIndex:Ce,display:"block",width:"max-content",maxWidth:U,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":le,[`${ee}-inner`]:{minWidth:$e,minHeight:$e,padding:`${(0,X.unit)(B.calc(lt).div(2).equal())} ${(0,X.unit)(We)}`,color:q,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:le,borderRadius:j,boxShadow:Fe,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${ee}-inner`]:{borderRadius:B.min(j,D.MAX_VERTICAL_CONTENT_RADIUS)}},[`${ee}-content`]:{position:"relative"}}),(0,P.genPresetColor)(B,(Ze,pe)=>{let{darkColor:se}=pe;return{[`&${ee}-${Ze}`]:{[`${ee}-inner`]:{backgroundColor:se},[`${ee}-arrow`]:{"--antd-arrow-background-color":se}}}})),{"&-rtl":{direction:"rtl"}})},(0,D.default)(B,"var(--antd-arrow-background-color)"),{[`${ee}-pure`]:{position:"relative",maxWidth:"none",margin:B.sizePopupArrow}}]},J=B=>Object.assign(Object.assign({zIndexPopup:B.zIndexPopupBase+70},(0,D.getArrowOffsetToken)({contentRadius:B.borderRadius,limitVerticalRadius:!0})),(0,W.getArrowToken)((0,P.mergeToken)(B,{borderRadiusOuter:Math.min(B.borderRadiusOuter,4)})));w.prepareComponentToken=J;var Be=w.default=function(ee){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(0,P.genStyleHooks)("Tooltip",le=>{const{borderRadius:j,colorTextLightSolid:Ce,colorBgSpotlight:$e}=le,Fe=(0,P.mergeToken)(le,{tooltipMaxWidth:250,tooltipColor:Ce,tooltipBorderRadius:j,tooltipBg:$e});return[fe(Fe),(0,h.initZoomMotion)(le,"zoom-big-fast")]},J,{resetStyle:!1,injectStyle:U})(ee)}},48125:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.parseColor=D;var z=F(x(93967)),h=x(45471);function D(P,X){const W=(0,h.isPresetColor)(X),fe=(0,z.default)({[`${P}-${X}`]:X&&W}),J={},Be={};return X&&!W&&(J.background=X,Be["--antd-arrow-background-color"]=X),{className:fe,overlayStyle:J,arrowStyle:Be}}},6847:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=Be;var h=z(x(67294)),D=F(x(83874)),P=F(x(90091)),X=F(x(93967)),W=F(x(60938)),fe=F(x(94055)),J=x(81410);function Be(B){const{prefixCls:ee,copied:U,locale:q={},onCopy:le,iconOnly:j,tooltips:Ce,icon:$e}=B,Fe=(0,J.toList)(Ce),lt=(0,J.toList)($e),{copied:We,copy:Ze}=q,pe=U?(0,J.getNode)(Fe[1],We):(0,J.getNode)(Fe[0],Ze),be=typeof pe=="string"?pe:U?We:Ze;return h.createElement(fe.default,{key:"copy",title:pe},h.createElement(W.default,{className:(0,X.default)(`${ee}-copy`,{[`${ee}-copy-success`]:U,[`${ee}-copy-icon-only`]:j}),onClick:le,"aria-label":be},U?(0,J.getNode)(lt[1],h.createElement(D.default,null),!0):(0,J.getNode)(lt[0],h.createElement(P.default,null),!0)))}},12385:function(He,w,x){"use strict";"use client";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=j;var h=z(x(861)),D=F(x(67294)),P=z(x(45598)),X=z(x(82546));const W=D.forwardRef((Ce,$e)=>{let{style:Fe,children:lt}=Ce;const We=D.useRef(null);return D.useImperativeHandle($e,()=>({isExceed:()=>{const Ze=We.current;return Ze.scrollHeight>Ze.clientHeight},getHeight:()=>We.current.clientHeight})),D.createElement("span",{"aria-hidden":!0,ref:We,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},Fe)},lt)});function fe(Ce){const $e=typeof Ce;return $e==="string"||$e==="number"}function J(Ce){let $e=0;return Ce.forEach(Fe=>{fe(Fe)?$e+=String(Fe).length:$e+=1}),$e}function Be(Ce,$e){let Fe=0;const lt=[];for(let We=0;We<Ce.length;We+=1){if(Fe===$e)return lt;const Ze=Ce[We],se=fe(Ze)?String(Ze).length:1,be=Fe+se;if(be>$e){const Te=$e-Fe;return lt.push(String(Ze).slice(0,Te)),lt}lt.push(Ze),Fe=be}return Ce}const B=0,ee=1,U=2,q=3,le={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function j(Ce){const{enableMeasure:$e,width:Fe,text:lt,children:We,rows:Ze,miscDeps:pe,onEllipsis:se}=Ce,be=D.useMemo(()=>(0,P.default)(lt),[lt]),Te=D.useMemo(()=>J(be),[lt]),de=D.useMemo(()=>We(be,!1,!1),[lt]),[Rt,ye]=D.useState(null),Ve=D.useRef(null),oe=D.useRef(null),[Re,Se]=D.useState(B),[et,st]=D.useState(0);(0,X.default)(()=>{Se($e&&Fe&&Te?ee:B)},[Fe,lt,Ze,$e,be]),(0,X.default)(()=>{var ur,qt;if(Re===ee){const _n=!!(!((ur=oe.current)===null||ur===void 0)&&ur.isExceed());Se(_n?U:q),ye(_n?[0,Te]:null),st((((qt=oe.current)===null||qt===void 0?void 0:qt.getHeight())||0)+1),se(_n)}},[Re]);const pt=Rt?Math.ceil((Rt[0]+Rt[1])/2):0;(0,X.default)(()=>{var ur;const[qt,_n]=Rt||[0,0];if(qt!==_n){const Vr=(((ur=Ve.current)===null||ur===void 0?void 0:ur.getHeight())||0)>et;let rn=pt;_n-qt===1&&(rn=Vr?qt:_n),ye(Vr?[qt,rn]:[rn,_n])}},[Rt,pt]);const bt=D.useMemo(()=>{if(Re!==U||!Rt||Rt[0]!==Rt[1]){const ur=We(be,!1,!1);return Re!==q&&Re!==B?D.createElement("span",{style:Object.assign(Object.assign({},le),{WebkitLineClamp:Ze})},ur):ur}return We(Be(be,Rt[0]),!0,!0)},[Re,Rt,be].concat((0,h.default)(pe))),ke={width:Fe,whiteSpace:"normal",margin:0,padding:0};return D.createElement(D.Fragment,null,bt,Re===ee&&D.createElement(W,{style:Object.assign(Object.assign(Object.assign({},ke),le),{WebkitLineClamp:Ze}),ref:oe},de),Re===U&&Rt&&Rt[0]!==Rt[1]&&D.createElement(W,{style:Object.assign(Object.assign({},ke),{top:400}),ref:Ve},We(Be(be,pt),!0,!0)))}},69274:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=F(x(94055));const P=W=>{let{enableEllipsis:fe,isEllipsis:J,children:Be,tooltipProps:B}=W;return!(B!=null&&B.title)||!fe?Be:h.createElement(D.default,Object.assign({open:J?void 0:!1},B),Be)};var X=w.default=P},28460:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=F(x(10875)),P=F(x(93967)),X=F(x(20640)),W=F(x(9220)),fe=F(x(45598)),J=F(x(82546)),Be=F(x(60869)),B=F(x(18475)),ee=x(75531),U=x(38882),q=F(x(60938)),le=x(31929),j=F(x(76647)),Ce=F(x(94055)),$e=F(x(69425)),Fe=F(x(92759)),lt=F(x(67312)),We=F(x(89652)),Ze=F(x(6847)),pe=F(x(12385)),se=F(x(69274)),be=function(Ve,oe){var Re={};for(var Se in Ve)Object.prototype.hasOwnProperty.call(Ve,Se)&&oe.indexOf(Se)<0&&(Re[Se]=Ve[Se]);if(Ve!=null&&typeof Object.getOwnPropertySymbols=="function")for(var et=0,Se=Object.getOwnPropertySymbols(Ve);et<Se.length;et++)oe.indexOf(Se[et])<0&&Object.prototype.propertyIsEnumerable.call(Ve,Se[et])&&(Re[Se[et]]=Ve[Se[et]]);return Re};function Te(Ve,oe){let{mark:Re,code:Se,underline:et,delete:st,strong:pt,keyboard:bt,italic:ke}=Ve,ur=oe;function qt(_n,Zr){Zr&&(ur=h.createElement(_n,{},ur))}return qt("strong",pt),qt("u",et),qt("del",st),qt("code",Se),qt("mark",Re),qt("kbd",bt),qt("i",ke),ur}const de="...",Rt=h.forwardRef((Ve,oe)=>{var Re,Se,et;const{prefixCls:st,className:pt,style:bt,type:ke,disabled:ur,children:qt,ellipsis:_n,editable:Zr,copyable:Vr,component:rn,title:Qr}=Ve,ln=be(Ve,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:vn,direction:$t}=h.useContext(le.ConfigContext),[_r]=(0,j.default)("Text"),kt=h.useRef(null),qe=h.useRef(null),Sr=vn("typography",st),Pe=(0,B.default)(ln,["mark","code","delete","underline","strong","keyboard","italic"]),[Hr,vr]=(0,Fe.default)(Zr),[Ie,gr]=(0,Be.default)(!1,{value:vr.editing}),{triggerType:Wr=["icon"]}=vr,Dr=bn=>{var ei;bn&&((ei=vr.onStart)===null||ei===void 0||ei.call(vr)),gr(bn)};(0,lt.default)(()=>{var bn;Ie||(bn=qe.current)===null||bn===void 0||bn.focus()},[Ie]);const Xr=bn=>{bn==null||bn.preventDefault(),Dr(!0)},Vn=bn=>{var ei;(ei=vr.onChange)===null||ei===void 0||ei.call(vr,bn),Dr(!1)},ni=()=>{var bn;(bn=vr.onCancel)===null||bn===void 0||bn.call(vr),Dr(!1)},[Dn,Jn]=(0,Fe.default)(Vr),[Yi,bi]=h.useState(!1),ui=h.useRef(null),pi={};Jn.format&&(pi.format=Jn.format);const it=()=>{ui.current&&clearTimeout(ui.current)},V=bn=>{var ei;bn==null||bn.preventDefault(),bn==null||bn.stopPropagation(),(0,X.default)(Jn.text||String(qt)||"",pi),bi(!0),it(),ui.current=setTimeout(()=>{bi(!1)},3e3),(ei=Jn.onCopy)===null||ei===void 0||ei.call(Jn,bn)};h.useEffect(()=>it,[]);const[H,Ee]=h.useState(!1),[Le,ze]=h.useState(!1),[xt,Ut]=h.useState(!1),[ir,Ft]=h.useState(!1),[te,Q]=h.useState(!1),[ve,Oe]=h.useState(!0),[Xe,ft]=(0,Fe.default)(_n,{expandable:!1}),Et=Xe&&!xt,{rows:Ne=1}=ft,Ue=h.useMemo(()=>!Et||ft.suffix!==void 0||ft.onEllipsis||ft.expandable||Hr||Dn,[Et,ft,Hr,Dn]);(0,J.default)(()=>{Xe&&!Ue&&(Ee((0,U.isStyleSupport)("webkitLineClamp")),ze((0,U.isStyleSupport)("textOverflow")))},[Ue,Xe]);const vt=h.useMemo(()=>Ue?!1:Ne===1?Le:H,[Ue,Le,H]),ue=Et&&(vt?te:ir),Lr=Et&&Ne===1&&vt,lr=Et&&Ne>1&&vt,$r=bn=>{var ei;Ut(!0),(ei=ft.onExpand)===null||ei===void 0||ei.call(ft,bn)},[Rn,nn]=h.useState(0),xr=bn=>{let{offsetWidth:ei}=bn;nn(ei)},Or=bn=>{var ei;Ft(bn),ir!==bn&&((ei=ft.onEllipsis)===null||ei===void 0||ei.call(ft,bn))};h.useEffect(()=>{const bn=kt.current;if(Xe&&vt&&bn){const ei=lr?bn.offsetHeight<bn.scrollHeight:bn.offsetWidth<bn.scrollWidth;te!==ei&&Q(ei)}},[Xe,vt,qt,lr,ve,Rn]),h.useEffect(()=>{const bn=kt.current;if(typeof IntersectionObserver=="undefined"||!bn||!vt||!Et)return;const ei=new IntersectionObserver(()=>{Oe(!!bn.offsetParent)});return ei.observe(bn),()=>{ei.disconnect()}},[vt,Et]);let sn={};ft.tooltip===!0?sn={title:(Re=vr.text)!==null&&Re!==void 0?Re:qt}:h.isValidElement(ft.tooltip)?sn={title:ft.tooltip}:typeof ft.tooltip=="object"?sn=Object.assign({title:(Se=vr.text)!==null&&Se!==void 0?Se:qt},ft.tooltip):sn={title:ft.tooltip};const xn=h.useMemo(()=>{const bn=ei=>["string","number"].includes(typeof ei);if(!(!Xe||vt)){if(bn(vr.text))return vr.text;if(bn(qt))return qt;if(bn(Qr))return Qr;if(bn(sn.title))return sn.title}},[Xe,vt,Qr,sn.title,ue]);if(Ie)return h.createElement($e.default,{value:(et=vr.text)!==null&&et!==void 0?et:typeof qt=="string"?qt:"",onSave:Vn,onCancel:ni,onEnd:vr.onEnd,prefixCls:Sr,className:pt,style:bt,direction:$t,component:rn,maxLength:vr.maxLength,autoSize:vr.autoSize,enterIcon:vr.enterIcon});const wi=()=>{const{expandable:bn,symbol:ei}=ft;if(!bn)return null;let ga;return ei?ga=ei:ga=_r==null?void 0:_r.expand,h.createElement("a",{key:"expand",className:`${Sr}-expand`,onClick:$r,"aria-label":_r==null?void 0:_r.expand},ga)},Nn=()=>{if(!Hr)return;const{icon:bn,tooltip:ei}=vr,ga=(0,fe.default)(ei)[0]||(_r==null?void 0:_r.edit),ua=typeof ga=="string"?ga:"";return Wr.includes("icon")?h.createElement(Ce.default,{key:"edit",title:ei===!1?"":ga},h.createElement(q.default,{ref:qe,className:`${Sr}-edit`,onClick:Xr,"aria-label":ua},bn||h.createElement(D.default,{role:"button"}))):null},Bi=()=>Dn?h.createElement(Ze.default,Object.assign({key:"copy"},Jn,{prefixCls:Sr,copied:Yi,locale:_r,onCopy:V,iconOnly:qt==null})):null,sa=bn=>[bn&&wi(),Nn(),Bi()],Fi=bn=>[bn&&h.createElement("span",{"aria-hidden":!0,key:"ellipsis"},de),ft.suffix,sa(bn)];return h.createElement(W.default,{onResize:xr,disabled:!Et},bn=>h.createElement(se.default,{tooltipProps:sn,enableEllipsis:Et,isEllipsis:ue},h.createElement(We.default,Object.assign({className:(0,P.default)({[`${Sr}-${ke}`]:ke,[`${Sr}-disabled`]:ur,[`${Sr}-ellipsis`]:Xe,[`${Sr}-single-line`]:Et&&Ne===1,[`${Sr}-ellipsis-single-line`]:Lr,[`${Sr}-ellipsis-multiple-line`]:lr},pt),prefixCls:st,style:Object.assign(Object.assign({},bt),{WebkitLineClamp:lr?Ne:void 0}),component:rn,ref:(0,ee.composeRef)(bn,kt,oe),direction:$t,onClick:Wr.includes("text")?Xr:void 0,"aria-label":xn==null?void 0:xn.toString(),title:Qr},Pe),h.createElement(pe.default,{enableMeasure:Et&&!vt,text:qt,rows:Ne,width:Rn,onEllipsis:Or,miscDeps:[Yi,xt]},(ei,ga)=>{let ua=ei;return ei.length&&ga&&xn&&(ua=h.createElement("span",{key:"show-content","aria-hidden":!0},ua)),Te(Ve,h.createElement(h.Fragment,null,ua,Fi(ga)))}))))});var ye=w.default=Rt},81410:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.getNode=F,w.toList=x;function x(z){return z===!1?[!1,!1]:Array.isArray(z)?z:[z]}function F(z,h,D){return z===!0||z===void 0?h:z||D&&h}},69425:function(He,w,x){"use strict";"use client";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(7224)),D=z(x(93967)),P=z(x(27712)),X=F(x(67294)),W=x(47419),fe=z(x(14104)),J=z(x(23461));const Be=ee=>{const{prefixCls:U,"aria-label":q,className:le,style:j,direction:Ce,maxLength:$e,autoSize:Fe=!0,value:lt,onSave:We,onCancel:Ze,onEnd:pe,component:se,enterIcon:be=X.createElement(h.default,null)}=ee,Te=X.useRef(null),de=X.useRef(!1),Rt=X.useRef(),[ye,Ve]=X.useState(lt);X.useEffect(()=>{Ve(lt)},[lt]),X.useEffect(()=>{if(Te.current&&Te.current.resizableTextArea){const{textArea:Vr}=Te.current.resizableTextArea;Vr.focus();const{length:rn}=Vr.value;Vr.setSelectionRange(rn,rn)}},[]);const oe=Vr=>{let{target:rn}=Vr;Ve(rn.value.replace(/[\n\r]/g,""))},Re=()=>{de.current=!0},Se=()=>{de.current=!1},et=Vr=>{let{keyCode:rn}=Vr;de.current||(Rt.current=rn)},st=()=>{We(ye.trim())},pt=Vr=>{let{keyCode:rn,ctrlKey:Qr,altKey:ln,metaKey:vn,shiftKey:$t}=Vr;Rt.current===rn&&!de.current&&!Qr&&!ln&&!vn&&!$t&&(rn===P.default.ENTER?(st(),pe==null||pe()):rn===P.default.ESC&&Ze())},bt=()=>{st()},ke=se?`${U}-${se}`:"",[ur,qt,_n]=(0,J.default)(U),Zr=(0,D.default)(U,`${U}-edit-content`,{[`${U}-rtl`]:Ce==="rtl"},le,ke,qt,_n);return ur(X.createElement("div",{className:Zr,style:j},X.createElement(fe.default,{ref:Te,maxLength:$e,value:ye,onChange:oe,onKeyDown:et,onKeyUp:pt,onCompositionStart:Re,onCompositionEnd:Se,onBlur:bt,"aria-label":q,rows:1,autoSize:Fe}),be!==null?(0,W.cloneElement)(be,{className:`${U}-edit-content-confirm`}):null))};var B=w.default=Be},34528:function(He,w,x){"use strict";var F,z=x(64836).default,h=x(75263).default;F={value:!0},w.Z=void 0;var D=h(x(67294)),P=x(13594),X=z(x(28460)),W=function(B,ee){var U={};for(var q in B)Object.prototype.hasOwnProperty.call(B,q)&&ee.indexOf(q)<0&&(U[q]=B[q]);if(B!=null&&typeof Object.getOwnPropertySymbols=="function")for(var le=0,q=Object.getOwnPropertySymbols(B);le<q.length;le++)ee.indexOf(q[le])<0&&Object.prototype.propertyIsEnumerable.call(B,q[le])&&(U[q[le]]=B[q[le]]);return U};const fe=[1,2,3,4,5],J=D.forwardRef((B,ee)=>{const{level:U=1}=B,q=W(B,["level"]);let le;return fe.includes(U)?le=`h${U}`:le="h1",D.createElement(X.default,Object.assign({ref:ee},q,{component:le}))});var Be=w.Z=J},89652:function(He,w,x){"use strict";"use client";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var h=z(x(67294)),D=F(x(93967)),P=x(75531),X=x(13594),W=x(31929),fe=F(x(23461)),J=function(ee,U){var q={};for(var le in ee)Object.prototype.hasOwnProperty.call(ee,le)&&U.indexOf(le)<0&&(q[le]=ee[le]);if(ee!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,le=Object.getOwnPropertySymbols(ee);j<le.length;j++)U.indexOf(le[j])<0&&Object.prototype.propertyIsEnumerable.call(ee,le[j])&&(q[le[j]]=ee[le[j]]);return q};const Be=h.forwardRef((ee,U)=>{const{prefixCls:q,component:le="article",className:j,rootClassName:Ce,setContentRef:$e,children:Fe,direction:lt,style:We}=ee,Ze=J(ee,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:pe,direction:se,typography:be}=h.useContext(W.ConfigContext),Te=lt!=null?lt:se;let de=U;$e&&(de=(0,P.composeRef)(U,$e));const Rt=pe("typography",q),[ye,Ve,oe]=(0,fe.default)(Rt),Re=(0,D.default)(Rt,be==null?void 0:be.className,{[`${Rt}-rtl`]:Te==="rtl"},j,Ce,Ve,oe),Se=Object.assign(Object.assign({},be==null?void 0:be.style),We);return ye(h.createElement(le,Object.assign({className:Re,style:Se,ref:de},Ze),Fe))});var B=w.default=Be},92759:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=h;var z=F(x(67294));function h(D,P){return z.useMemo(()=>{const X=!!D;return[X,Object.assign(Object.assign({},P),X&&typeof D=="object"?D:null)]},[D])}},67312:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(67294));const h=(P,X)=>{const W=z.useRef(!1);z.useEffect(()=>{W.current?P():W.current=!0},X)};var D=w.default=h},23461:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.prepareComponentToken=w.default=void 0;var F=x(98078),z=x(3184),h=x(48385);const D=W=>{const{componentCls:fe,titleMarginTop:J}=W;return{[fe]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:W.colorText,wordBreak:"break-word",lineHeight:W.lineHeight,[`&${fe}-secondary`]:{color:W.colorTextDescription},[`&${fe}-success`]:{color:W.colorSuccess},[`&${fe}-warning`]:{color:W.colorWarning},[`&${fe}-danger`]:{color:W.colorError,"a&:active, a&:focus":{color:W.colorErrorActive},"a&:hover":{color:W.colorErrorHover}},[`&${fe}-disabled`]:{color:W.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},[`
        div&,
        p
      `]:{marginBottom:"1em"}},(0,h.getTitleStyles)(W)),{[`
      & + h1${fe},
      & + h2${fe},
      & + h3${fe},
      & + h4${fe},
      & + h5${fe}
      `]:{marginTop:J},[`
      div,
      ul,
      li,
      p,
      h1,
      h2,
      h3,
      h4,
      h5`]:{[`
        + h1,
        + h2,
        + h3,
        + h4,
        + h5
        `]:{marginTop:J}}}),(0,h.getResetStyles)(W)),(0,h.getLinkStyles)(W)),{[`
        ${fe}-expand,
        ${fe}-edit,
        ${fe}-copy
      `]:Object.assign(Object.assign({},(0,F.operationUnit)(W)),{marginInlineStart:W.marginXXS})}),(0,h.getEditableStyles)(W)),(0,h.getCopyableStyles)(W)),(0,h.getEllipsisStyles)()),{"&-rtl":{direction:"rtl"}})}},P=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"});w.prepareComponentToken=P;var X=w.default=(0,z.genStyleHooks)("Typography",W=>[D(W)],P)},48385:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.getTitleStyles=w.getResetStyles=w.getLinkStyles=w.getEllipsisStyles=w.getEditableStyles=w.getCopyableStyles=void 0;var F=x(78589),z=x(6731),h=x(98078);const D=(B,ee,U,q)=>{const{titleMarginBottom:le,fontWeightStrong:j}=q;return{marginBottom:le,color:U,fontWeight:j,fontSize:B,lineHeight:ee}},P=B=>{const ee=[1,2,3,4,5],U={};return ee.forEach(q=>{U[`
      h${q}&,
      div&-h${q},
      div&-h${q} > textarea,
      h${q}
    `]=D(B[`fontSizeHeading${q}`],B[`lineHeightHeading${q}`],B.colorTextHeading,B)}),U};w.getTitleStyles=P;const X=B=>{const{componentCls:ee}=B;return{"a&, a":Object.assign(Object.assign({},(0,h.operationUnit)(B)),{textDecoration:B.linkDecoration,"&:active, &:hover":{textDecoration:B.linkHoverDecoration},[`&[disabled], &${ee}-disabled`]:{color:B.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:B.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}};w.getLinkStyles=X;const W=B=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:B.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:B.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:F.gold[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:B.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}});w.getResetStyles=W;const fe=B=>{const{componentCls:ee,paddingSM:U}=B,q=U;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:B.calc(B.paddingSM).mul(-1).equal(),marginTop:B.calc(q).mul(-1).equal(),marginBottom:`calc(1em - ${(0,z.unit)(q)})`},[`${ee}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:B.calc(B.marginXS).add(2).equal(),insetBlockEnd:B.marginXS,color:B.colorTextDescription,fontWeight:"normal",fontSize:B.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}};w.getEditableStyles=fe;const J=B=>({[`${B.componentCls}-copy-success`]:{[`
    &,
    &:hover,
    &:focus`]:{color:B.colorSuccess}},[`${B.componentCls}-copy-icon-only`]:{marginInlineStart:0}});w.getCopyableStyles=J;const Be=()=>({[`
  a&-ellipsis,
  span&-ellipsis
  `]:{display:"inline-block",maxWidth:"100%"},"&-single-line":{whiteSpace:"nowrap"},"&-ellipsis-single-line":{overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}});w.getEllipsisStyles=Be},87629:function(He,w,x){"use strict";"use client";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(36245)),h=w.default=z.default},36245:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var x=w.default="5.15.2"},83874:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const F=z(x(71079));function z(D){return D&&D.__esModule?D:{default:D}}const h=F;w.default=h,He.exports=h},43273:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const F=z(x(72225));function z(D){return D&&D.__esModule?D:{default:D}}const h=F;w.default=h,He.exports=h},90091:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const F=z(x(29539));function z(D){return D&&D.__esModule?D:{default:D}}const h=F;w.default=h,He.exports=h},10875:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const F=z(x(54825));function z(D){return D&&D.__esModule?D:{default:D}}const h=F;w.default=h,He.exports=h},7224:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;const F=z(x(43552));function z(D){return D&&D.__esModule?D:{default:D}}const h=F;w.default=h,He.exports=h},26545:function(He,w,x){"use client";"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return se}});var F=U(x(67294)),z=B(x(93967)),h=x(78589),D=B(x(13357)),P=B(x(46648)),X=x(46338),W=x(49458);function fe(be,Te){(Te==null||Te>be.length)&&(Te=be.length);for(var de=0,Rt=new Array(Te);de<Te;de++)Rt[de]=be[de];return Rt}function J(be){if(Array.isArray(be))return be}function Be(be,Te,de){return Te in be?Object.defineProperty(be,Te,{value:de,enumerable:!0,configurable:!0,writable:!0}):be[Te]=de,be}function B(be){return be&&be.__esModule?be:{default:be}}function ee(be){if(typeof WeakMap!="function")return null;var Te=new WeakMap,de=new WeakMap;return(ee=function(Rt){return Rt?de:Te})(be)}function U(be,Te){if(!Te&&be&&be.__esModule)return be;if(be===null||typeof be!="object"&&typeof be!="function")return{default:be};var de=ee(Te);if(de&&de.has(be))return de.get(be);var Rt={__proto__:null},ye=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ve in be)if(Ve!=="default"&&Object.prototype.hasOwnProperty.call(be,Ve)){var oe=ye?Object.getOwnPropertyDescriptor(be,Ve):null;oe&&(oe.get||oe.set)?Object.defineProperty(Rt,Ve,oe):Rt[Ve]=be[Ve]}return Rt.default=be,de&&de.set(be,Rt),Rt}function q(be,Te){var de=be==null?null:typeof Symbol!="undefined"&&be[Symbol.iterator]||be["@@iterator"];if(de!=null){var Rt=[],ye=!0,Ve=!1,oe,Re;try{for(de=de.call(be);!(ye=(oe=de.next()).done)&&(Rt.push(oe.value),!(Te&&Rt.length===Te));ye=!0);}catch(Se){Ve=!0,Re=Se}finally{try{!ye&&de.return!=null&&de.return()}finally{if(Ve)throw Re}}return Rt}}function le(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(be){for(var Te=1;Te<arguments.length;Te++){var de=arguments[Te]!=null?arguments[Te]:{},Rt=Object.keys(de);typeof Object.getOwnPropertySymbols=="function"&&(Rt=Rt.concat(Object.getOwnPropertySymbols(de).filter(function(ye){return Object.getOwnPropertyDescriptor(de,ye).enumerable}))),Rt.forEach(function(ye){Be(be,ye,de[ye])})}return be}function Ce(be,Te){var de=Object.keys(be);if(Object.getOwnPropertySymbols){var Rt=Object.getOwnPropertySymbols(be);Te&&(Rt=Rt.filter(function(ye){return Object.getOwnPropertyDescriptor(be,ye).enumerable})),de.push.apply(de,Rt)}return de}function $e(be,Te){return Te=Te!=null?Te:{},Object.getOwnPropertyDescriptors?Object.defineProperties(be,Object.getOwnPropertyDescriptors(Te)):Ce(Object(Te)).forEach(function(de){Object.defineProperty(be,de,Object.getOwnPropertyDescriptor(Te,de))}),be}function Fe(be,Te){if(be==null)return{};var de=lt(be,Te),Rt,ye;if(Object.getOwnPropertySymbols){var Ve=Object.getOwnPropertySymbols(be);for(ye=0;ye<Ve.length;ye++)Rt=Ve[ye],!(Te.indexOf(Rt)>=0)&&Object.prototype.propertyIsEnumerable.call(be,Rt)&&(de[Rt]=be[Rt])}return de}function lt(be,Te){if(be==null)return{};var de={},Rt=Object.keys(be),ye,Ve;for(Ve=0;Ve<Rt.length;Ve++)ye=Rt[Ve],!(Te.indexOf(ye)>=0)&&(de[ye]=be[ye]);return de}function We(be,Te){return J(be)||q(be,Te)||Ze(be,Te)||le()}function Ze(be,Te){if(be){if(typeof be=="string")return fe(be,Te);var de=Object.prototype.toString.call(be).slice(8,-1);if(de==="Object"&&be.constructor&&(de=be.constructor.name),de==="Map"||de==="Set")return Array.from(de);if(de==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(de))return fe(be,Te)}}(0,X.setTwoToneColor)(h.blue.primary);var pe=F.forwardRef(function(be,Te){var de=be.className,Rt=be.icon,ye=be.spin,Ve=be.rotate,oe=be.tabIndex,Re=be.onClick,Se=be.twoToneColor,et=Fe(be,["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"]),st=F.useContext(D.default),pt=st.prefixCls,bt=pt===void 0?"anticon":pt,ke=st.rootClassName,ur,qt=(0,z.default)(ke,bt,(ur={},Be(ur,"".concat(bt,"-").concat(Rt.name),!!Rt.name),Be(ur,"".concat(bt,"-spin"),!!ye||Rt.name==="loading"),ur),de),_n=oe;_n===void 0&&Re&&(_n=-1);var Zr=Ve?{msTransform:"rotate(".concat(Ve,"deg)"),transform:"rotate(".concat(Ve,"deg)")}:void 0,Vr=We((0,W.normalizeTwoToneColors)(Se),2),rn=Vr[0],Qr=Vr[1];return F.createElement("span",$e(j({role:"img","aria-label":Rt.name},et),{ref:Te,tabIndex:_n,onClick:Re,className:qt}),F.createElement(P.default,{icon:Rt,primaryColor:rn,secondaryColor:Qr,style:Zr}))});pe.displayName="AntdIcon",pe.getTwoToneColor=X.getTwoToneColor,pe.setTwoToneColor=X.setTwoToneColor;var se=pe},13357:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return h}});var F=x(67294),z=(0,F.createContext)({}),h=z},46648:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return le}});var F=P(x(67294)),z=x(49458);function h(j,Ce,$e){return Ce in j?Object.defineProperty(j,Ce,{value:$e,enumerable:!0,configurable:!0,writable:!0}):j[Ce]=$e,j}function D(j){if(typeof WeakMap!="function")return null;var Ce=new WeakMap,$e=new WeakMap;return(D=function(Fe){return Fe?$e:Ce})(j)}function P(j,Ce){if(!Ce&&j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var $e=D(Ce);if($e&&$e.has(j))return $e.get(j);var Fe={__proto__:null},lt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var We in j)if(We!=="default"&&Object.prototype.hasOwnProperty.call(j,We)){var Ze=lt?Object.getOwnPropertyDescriptor(j,We):null;Ze&&(Ze.get||Ze.set)?Object.defineProperty(Fe,We,Ze):Fe[We]=j[We]}return Fe.default=j,$e&&$e.set(j,Fe),Fe}function X(j){for(var Ce=1;Ce<arguments.length;Ce++){var $e=arguments[Ce]!=null?arguments[Ce]:{},Fe=Object.keys($e);typeof Object.getOwnPropertySymbols=="function"&&(Fe=Fe.concat(Object.getOwnPropertySymbols($e).filter(function(lt){return Object.getOwnPropertyDescriptor($e,lt).enumerable}))),Fe.forEach(function(lt){h(j,lt,$e[lt])})}return j}function W(j,Ce){var $e=Object.keys(j);if(Object.getOwnPropertySymbols){var Fe=Object.getOwnPropertySymbols(j);Ce&&(Fe=Fe.filter(function(lt){return Object.getOwnPropertyDescriptor(j,lt).enumerable})),$e.push.apply($e,Fe)}return $e}function fe(j,Ce){return Ce=Ce!=null?Ce:{},Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(Ce)):W(Object(Ce)).forEach(function($e){Object.defineProperty(j,$e,Object.getOwnPropertyDescriptor(Ce,$e))}),j}function J(j,Ce){if(j==null)return{};var $e=Be(j,Ce),Fe,lt;if(Object.getOwnPropertySymbols){var We=Object.getOwnPropertySymbols(j);for(lt=0;lt<We.length;lt++)Fe=We[lt],!(Ce.indexOf(Fe)>=0)&&Object.prototype.propertyIsEnumerable.call(j,Fe)&&($e[Fe]=j[Fe])}return $e}function Be(j,Ce){if(j==null)return{};var $e={},Fe=Object.keys(j),lt,We;for(We=0;We<Fe.length;We++)lt=Fe[We],!(Ce.indexOf(lt)>=0)&&($e[lt]=j[lt]);return $e}var B={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function ee(j){var Ce=j.primaryColor,$e=j.secondaryColor;B.primaryColor=Ce,B.secondaryColor=$e||(0,z.getSecondaryColor)(Ce),B.calculated=!!$e}function U(){return X({},B)}var q=function(j){var Ce=j.icon,$e=j.className,Fe=j.onClick,lt=j.style,We=j.primaryColor,Ze=j.secondaryColor,pe=J(j,["icon","className","onClick","style","primaryColor","secondaryColor"]),se=F.useRef(),be=B;if(We&&(be={primaryColor:We,secondaryColor:Ze||(0,z.getSecondaryColor)(We)}),(0,z.useInsertStyles)(se),(0,z.warning)((0,z.isIconDefinition)(Ce),"icon should be icon definiton, but got ".concat(Ce)),!(0,z.isIconDefinition)(Ce))return null;var Te=Ce;return Te&&typeof Te.icon=="function"&&(Te=fe(X({},Te),{icon:Te.icon(be.primaryColor,be.secondaryColor)})),(0,z.generate)(Te.icon,"svg-".concat(Te.name),fe(X({className:$e,onClick:Fe,style:lt,"data-icon":Te.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},pe),{ref:se}))};q.displayName="IconReact",q.getTwoToneColors=U,q.setTwoToneColors=ee;var le=q},46338:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0});function F(U,q){for(var le in q)Object.defineProperty(U,le,{enumerable:!0,get:q[le]})}F(w,{getTwoToneColor:function(){return ee},setTwoToneColor:function(){return B}});var z=X(x(46648)),h=x(49458);function D(U,q){(q==null||q>U.length)&&(q=U.length);for(var le=0,j=new Array(q);le<q;le++)j[le]=U[le];return j}function P(U){if(Array.isArray(U))return U}function X(U){return U&&U.__esModule?U:{default:U}}function W(U,q){var le=U==null?null:typeof Symbol!="undefined"&&U[Symbol.iterator]||U["@@iterator"];if(le!=null){var j=[],Ce=!0,$e=!1,Fe,lt;try{for(le=le.call(U);!(Ce=(Fe=le.next()).done)&&(j.push(Fe.value),!(q&&j.length===q));Ce=!0);}catch(We){$e=!0,lt=We}finally{try{!Ce&&le.return!=null&&le.return()}finally{if($e)throw lt}}return j}}function fe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(U,q){return P(U)||W(U,q)||Be(U,q)||fe()}function Be(U,q){if(U){if(typeof U=="string")return D(U,q);var le=Object.prototype.toString.call(U).slice(8,-1);if(le==="Object"&&U.constructor&&(le=U.constructor.name),le==="Map"||le==="Set")return Array.from(le);if(le==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(le))return D(U,q)}}function B(U){var q=J((0,h.normalizeTwoToneColors)(U),2),le=q[0],j=q[1];return z.default.setTwoToneColors({primaryColor:le,secondaryColor:j})}function ee(){var U=z.default.getTwoToneColors();return U.calculated?[U.primaryColor,U.secondaryColor]:U.primaryColor}},71079:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return ee}});var F=W(x(67294)),z=P(x(25330)),h=P(x(26545));function D(U,q,le){return q in U?Object.defineProperty(U,q,{value:le,enumerable:!0,configurable:!0,writable:!0}):U[q]=le,U}function P(U){return U&&U.__esModule?U:{default:U}}function X(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,le=new WeakMap;return(X=function(j){return j?le:q})(U)}function W(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var le=X(q);if(le&&le.has(U))return le.get(U);var j={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $e in U)if($e!=="default"&&Object.prototype.hasOwnProperty.call(U,$e)){var Fe=Ce?Object.getOwnPropertyDescriptor(U,$e):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(j,$e,Fe):j[$e]=U[$e]}return j.default=U,le&&le.set(U,j),j}function fe(U){for(var q=1;q<arguments.length;q++){var le=arguments[q]!=null?arguments[q]:{},j=Object.keys(le);typeof Object.getOwnPropertySymbols=="function"&&(j=j.concat(Object.getOwnPropertySymbols(le).filter(function(Ce){return Object.getOwnPropertyDescriptor(le,Ce).enumerable}))),j.forEach(function(Ce){D(U,Ce,le[Ce])})}return U}function J(U,q){var le=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);q&&(j=j.filter(function(Ce){return Object.getOwnPropertyDescriptor(U,Ce).enumerable})),le.push.apply(le,j)}return le}function Be(U,q){return q=q!=null?q:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(q)):J(Object(q)).forEach(function(le){Object.defineProperty(U,le,Object.getOwnPropertyDescriptor(q,le))}),U}var B=function(U,q){return F.createElement(h.default,Be(fe({},U),{ref:q,icon:z.default}))},ee=F.forwardRef(B)},72225:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return ee}});var F=W(x(67294)),z=P(x(67303)),h=P(x(26545));function D(U,q,le){return q in U?Object.defineProperty(U,q,{value:le,enumerable:!0,configurable:!0,writable:!0}):U[q]=le,U}function P(U){return U&&U.__esModule?U:{default:U}}function X(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,le=new WeakMap;return(X=function(j){return j?le:q})(U)}function W(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var le=X(q);if(le&&le.has(U))return le.get(U);var j={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $e in U)if($e!=="default"&&Object.prototype.hasOwnProperty.call(U,$e)){var Fe=Ce?Object.getOwnPropertyDescriptor(U,$e):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(j,$e,Fe):j[$e]=U[$e]}return j.default=U,le&&le.set(U,j),j}function fe(U){for(var q=1;q<arguments.length;q++){var le=arguments[q]!=null?arguments[q]:{},j=Object.keys(le);typeof Object.getOwnPropertySymbols=="function"&&(j=j.concat(Object.getOwnPropertySymbols(le).filter(function(Ce){return Object.getOwnPropertyDescriptor(le,Ce).enumerable}))),j.forEach(function(Ce){D(U,Ce,le[Ce])})}return U}function J(U,q){var le=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);q&&(j=j.filter(function(Ce){return Object.getOwnPropertyDescriptor(U,Ce).enumerable})),le.push.apply(le,j)}return le}function Be(U,q){return q=q!=null?q:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(q)):J(Object(q)).forEach(function(le){Object.defineProperty(U,le,Object.getOwnPropertyDescriptor(q,le))}),U}var B=function(U,q){return F.createElement(h.default,Be(fe({},U),{ref:q,icon:z.default}))},ee=F.forwardRef(B)},29539:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return ee}});var F=W(x(67294)),z=P(x(83647)),h=P(x(26545));function D(U,q,le){return q in U?Object.defineProperty(U,q,{value:le,enumerable:!0,configurable:!0,writable:!0}):U[q]=le,U}function P(U){return U&&U.__esModule?U:{default:U}}function X(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,le=new WeakMap;return(X=function(j){return j?le:q})(U)}function W(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var le=X(q);if(le&&le.has(U))return le.get(U);var j={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $e in U)if($e!=="default"&&Object.prototype.hasOwnProperty.call(U,$e)){var Fe=Ce?Object.getOwnPropertyDescriptor(U,$e):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(j,$e,Fe):j[$e]=U[$e]}return j.default=U,le&&le.set(U,j),j}function fe(U){for(var q=1;q<arguments.length;q++){var le=arguments[q]!=null?arguments[q]:{},j=Object.keys(le);typeof Object.getOwnPropertySymbols=="function"&&(j=j.concat(Object.getOwnPropertySymbols(le).filter(function(Ce){return Object.getOwnPropertyDescriptor(le,Ce).enumerable}))),j.forEach(function(Ce){D(U,Ce,le[Ce])})}return U}function J(U,q){var le=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);q&&(j=j.filter(function(Ce){return Object.getOwnPropertyDescriptor(U,Ce).enumerable})),le.push.apply(le,j)}return le}function Be(U,q){return q=q!=null?q:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(q)):J(Object(q)).forEach(function(le){Object.defineProperty(U,le,Object.getOwnPropertyDescriptor(q,le))}),U}var B=function(U,q){return F.createElement(h.default,Be(fe({},U),{ref:q,icon:z.default}))},ee=F.forwardRef(B)},54825:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return ee}});var F=W(x(67294)),z=P(x(57583)),h=P(x(26545));function D(U,q,le){return q in U?Object.defineProperty(U,q,{value:le,enumerable:!0,configurable:!0,writable:!0}):U[q]=le,U}function P(U){return U&&U.__esModule?U:{default:U}}function X(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,le=new WeakMap;return(X=function(j){return j?le:q})(U)}function W(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var le=X(q);if(le&&le.has(U))return le.get(U);var j={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $e in U)if($e!=="default"&&Object.prototype.hasOwnProperty.call(U,$e)){var Fe=Ce?Object.getOwnPropertyDescriptor(U,$e):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(j,$e,Fe):j[$e]=U[$e]}return j.default=U,le&&le.set(U,j),j}function fe(U){for(var q=1;q<arguments.length;q++){var le=arguments[q]!=null?arguments[q]:{},j=Object.keys(le);typeof Object.getOwnPropertySymbols=="function"&&(j=j.concat(Object.getOwnPropertySymbols(le).filter(function(Ce){return Object.getOwnPropertyDescriptor(le,Ce).enumerable}))),j.forEach(function(Ce){D(U,Ce,le[Ce])})}return U}function J(U,q){var le=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);q&&(j=j.filter(function(Ce){return Object.getOwnPropertyDescriptor(U,Ce).enumerable})),le.push.apply(le,j)}return le}function Be(U,q){return q=q!=null?q:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(q)):J(Object(q)).forEach(function(le){Object.defineProperty(U,le,Object.getOwnPropertyDescriptor(q,le))}),U}var B=function(U,q){return F.createElement(h.default,Be(fe({},U),{ref:q,icon:z.default}))},ee=F.forwardRef(B)},43552:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),Object.defineProperty(w,"default",{enumerable:!0,get:function(){return ee}});var F=W(x(67294)),z=P(x(29260)),h=P(x(26545));function D(U,q,le){return q in U?Object.defineProperty(U,q,{value:le,enumerable:!0,configurable:!0,writable:!0}):U[q]=le,U}function P(U){return U&&U.__esModule?U:{default:U}}function X(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,le=new WeakMap;return(X=function(j){return j?le:q})(U)}function W(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var le=X(q);if(le&&le.has(U))return le.get(U);var j={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $e in U)if($e!=="default"&&Object.prototype.hasOwnProperty.call(U,$e)){var Fe=Ce?Object.getOwnPropertyDescriptor(U,$e):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(j,$e,Fe):j[$e]=U[$e]}return j.default=U,le&&le.set(U,j),j}function fe(U){for(var q=1;q<arguments.length;q++){var le=arguments[q]!=null?arguments[q]:{},j=Object.keys(le);typeof Object.getOwnPropertySymbols=="function"&&(j=j.concat(Object.getOwnPropertySymbols(le).filter(function(Ce){return Object.getOwnPropertyDescriptor(le,Ce).enumerable}))),j.forEach(function(Ce){D(U,Ce,le[Ce])})}return U}function J(U,q){var le=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);q&&(j=j.filter(function(Ce){return Object.getOwnPropertyDescriptor(U,Ce).enumerable})),le.push.apply(le,j)}return le}function Be(U,q){return q=q!=null?q:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(q)):J(Object(q)).forEach(function(le){Object.defineProperty(U,le,Object.getOwnPropertyDescriptor(q,le))}),U}var B=function(U,q){return F.createElement(h.default,Be(fe({},U),{ref:q,icon:z.default}))},ee=F.forwardRef(B)},49458:function(He,w,x){"use strict";Object.defineProperty(w,"__esModule",{value:!0});function F(pe,se){for(var be in se)Object.defineProperty(pe,be,{enumerable:!0,get:se[be]})}F(w,{generate:function(){return Ce},getSecondaryColor:function(){return $e},iconStyles:function(){return We},isIconDefinition:function(){return le},normalizeAttrs:function(){return j},normalizeTwoToneColors:function(){return Fe},svgBaseProps:function(){return lt},useInsertStyles:function(){return Ze},warning:function(){return q}});var z=x(78589),h=x(93399),D=x(63298),P=J(x(45520)),X=B(x(67294)),W=J(x(13357));function fe(pe,se,be){return se in pe?Object.defineProperty(pe,se,{value:be,enumerable:!0,configurable:!0,writable:!0}):pe[se]=be,pe}function J(pe){return pe&&pe.__esModule?pe:{default:pe}}function Be(pe){if(typeof WeakMap!="function")return null;var se=new WeakMap,be=new WeakMap;return(Be=function(Te){return Te?be:se})(pe)}function B(pe,se){if(!se&&pe&&pe.__esModule)return pe;if(pe===null||typeof pe!="object"&&typeof pe!="function")return{default:pe};var be=Be(se);if(be&&be.has(pe))return be.get(pe);var Te={__proto__:null},de=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Rt in pe)if(Rt!=="default"&&Object.prototype.hasOwnProperty.call(pe,Rt)){var ye=de?Object.getOwnPropertyDescriptor(pe,Rt):null;ye&&(ye.get||ye.set)?Object.defineProperty(Te,Rt,ye):Te[Rt]=pe[Rt]}return Te.default=pe,be&&be.set(pe,Te),Te}function ee(pe){for(var se=1;se<arguments.length;se++){var be=arguments[se]!=null?arguments[se]:{},Te=Object.keys(be);typeof Object.getOwnPropertySymbols=="function"&&(Te=Te.concat(Object.getOwnPropertySymbols(be).filter(function(de){return Object.getOwnPropertyDescriptor(be,de).enumerable}))),Te.forEach(function(de){fe(pe,de,be[de])})}return pe}function U(pe){return pe.replace(/-(.)/g,function(se,be){return be.toUpperCase()})}function q(pe,se){(0,P.default)(pe,"[@ant-design/icons] ".concat(se))}function le(pe){return typeof pe=="object"&&typeof pe.name=="string"&&typeof pe.theme=="string"&&(typeof pe.icon=="object"||typeof pe.icon=="function")}function j(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(pe).reduce(function(se,be){var Te=pe[be];switch(be){case"class":se.className=Te,delete se.class;break;default:delete se[be],se[U(be)]=Te}return se},{})}function Ce(pe,se,be){return be?X.default.createElement(pe.tag,ee({key:se},j(pe.attrs),be),(pe.children||[]).map(function(Te,de){return Ce(Te,"".concat(se,"-").concat(pe.tag,"-").concat(de))})):X.default.createElement(pe.tag,ee({key:se},j(pe.attrs)),(pe.children||[]).map(function(Te,de){return Ce(Te,"".concat(se,"-").concat(pe.tag,"-").concat(de))}))}function $e(pe){return(0,z.generate)(pe)[0]}function Fe(pe){return pe?Array.isArray(pe)?pe:[pe]:[]}var lt={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},We=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Ze=function(pe){var se=(0,X.useContext)(W.default),be=se.csp,Te=se.prefixCls,de=We;Te&&(de=de.replace(/anticon/g,Te)),(0,X.useEffect)(function(){var Rt=pe.current,ye=(0,D.getShadowRoot)(Rt);(0,h.updateCSS)(de,"@ant-design-icons",{prepend:!0,csp:be,attachTo:ye})},[])}},98129:function(He,w,x){"use strict";var F=x(60690);He.exports=function(D){D=D||{};var P=D.reporter,X=F.getOption(D,"async",!0),W=F.getOption(D,"auto",!0);W&&!X&&(P&&P.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),X=!0);var fe=z(),J,Be=!1;function B($e,Fe){!Be&&W&&X&&fe.size()===0&&q(),fe.add($e,Fe)}function ee(){for(Be=!0;fe.size();){var $e=fe;fe=z(),$e.process()}Be=!1}function U($e){Be||($e===void 0&&($e=X),J&&(j(J),J=null),$e?q():ee())}function q(){J=Ce(ee)}function le(){fe={},batchSize=0,topLevel=0,bottomLevel=0}function j($e){var Fe=clearTimeout;return Fe($e)}function Ce($e){var Fe=function(lt){return setTimeout(lt,0)};return Fe($e)}return{add:B,force:U}};function z(){var h={},D=0,P=0,X=0;function W(Be,B){B||(B=Be,Be=0),Be>P?P=Be:Be<X&&(X=Be),h[Be]||(h[Be]=[]),h[Be].push(B),D++}function fe(){for(var Be=X;Be<=P;Be++)for(var B=h[Be],ee=0;ee<B.length;ee++){var U=B[ee];U()}}function J(){return D}return{add:W,process:fe,size:J}}},60690:function(He){"use strict";var w=He.exports={};w.getOption=x;function x(F,z,h){var D=F[z];return D==null&&h!==void 0?h:D}},9187:function(He){"use strict";He.exports=w,He.exports.default=w;function w(oe,Re,Se){Se=Se||2;var et=Re&&Re.length,st=et?Re[0]*Se:oe.length,pt=x(oe,0,st,Se,!0),bt=[];if(!pt||pt.next===pt.prev)return bt;var ke,ur,qt,_n,Zr,Vr,rn;if(et&&(pt=W(oe,Re,pt,Se)),oe.length>80*Se){ke=qt=oe[0],ur=_n=oe[1];for(var Qr=Se;Qr<st;Qr+=Se)Zr=oe[Qr],Vr=oe[Qr+1],Zr<ke&&(ke=Zr),Vr<ur&&(ur=Vr),Zr>qt&&(qt=Zr),Vr>_n&&(_n=Vr);rn=Math.max(qt-ke,_n-ur),rn=rn!==0?32767/rn:0}return z(pt,bt,Se,ke,ur,rn,0),bt}function x(oe,Re,Se,et,st){var pt,bt;if(st===Ve(oe,Re,Se,et)>0)for(pt=Re;pt<Se;pt+=et)bt=de(pt,oe[pt],oe[pt+1],bt);else for(pt=Se-et;pt>=Re;pt-=et)bt=de(pt,oe[pt],oe[pt+1],bt);return bt&&Fe(bt,bt.next)&&(Rt(bt),bt=bt.next),bt}function F(oe,Re){if(!oe)return oe;Re||(Re=oe);var Se=oe,et;do if(et=!1,!Se.steiner&&(Fe(Se,Se.next)||$e(Se.prev,Se,Se.next)===0)){if(Rt(Se),Se=Re=Se.prev,Se===Se.next)break;et=!0}else Se=Se.next;while(et||Se!==Re);return Re}function z(oe,Re,Se,et,st,pt,bt){if(oe){!bt&&pt&&ee(oe,et,st,pt);for(var ke=oe,ur,qt;oe.prev!==oe.next;){if(ur=oe.prev,qt=oe.next,pt?D(oe,et,st,pt):h(oe)){Re.push(ur.i/Se|0),Re.push(oe.i/Se|0),Re.push(qt.i/Se|0),Rt(oe),oe=qt.next,ke=qt.next;continue}if(oe=qt,oe===ke){bt?bt===1?(oe=P(F(oe),Re,Se),z(oe,Re,Se,et,st,pt,2)):bt===2&&X(oe,Re,Se,et,st,pt):z(F(oe),Re,Se,et,st,pt,1);break}}}}function h(oe){var Re=oe.prev,Se=oe,et=oe.next;if($e(Re,Se,et)>=0)return!1;for(var st=Re.x,pt=Se.x,bt=et.x,ke=Re.y,ur=Se.y,qt=et.y,_n=st<pt?st<bt?st:bt:pt<bt?pt:bt,Zr=ke<ur?ke<qt?ke:qt:ur<qt?ur:qt,Vr=st>pt?st>bt?st:bt:pt>bt?pt:bt,rn=ke>ur?ke>qt?ke:qt:ur>qt?ur:qt,Qr=et.next;Qr!==Re;){if(Qr.x>=_n&&Qr.x<=Vr&&Qr.y>=Zr&&Qr.y<=rn&&j(st,ke,pt,ur,bt,qt,Qr.x,Qr.y)&&$e(Qr.prev,Qr,Qr.next)>=0)return!1;Qr=Qr.next}return!0}function D(oe,Re,Se,et){var st=oe.prev,pt=oe,bt=oe.next;if($e(st,pt,bt)>=0)return!1;for(var ke=st.x,ur=pt.x,qt=bt.x,_n=st.y,Zr=pt.y,Vr=bt.y,rn=ke<ur?ke<qt?ke:qt:ur<qt?ur:qt,Qr=_n<Zr?_n<Vr?_n:Vr:Zr<Vr?Zr:Vr,ln=ke>ur?ke>qt?ke:qt:ur>qt?ur:qt,vn=_n>Zr?_n>Vr?_n:Vr:Zr>Vr?Zr:Vr,$t=q(rn,Qr,Re,Se,et),_r=q(ln,vn,Re,Se,et),kt=oe.prevZ,qe=oe.nextZ;kt&&kt.z>=$t&&qe&&qe.z<=_r;){if(kt.x>=rn&&kt.x<=ln&&kt.y>=Qr&&kt.y<=vn&&kt!==st&&kt!==bt&&j(ke,_n,ur,Zr,qt,Vr,kt.x,kt.y)&&$e(kt.prev,kt,kt.next)>=0||(kt=kt.prevZ,qe.x>=rn&&qe.x<=ln&&qe.y>=Qr&&qe.y<=vn&&qe!==st&&qe!==bt&&j(ke,_n,ur,Zr,qt,Vr,qe.x,qe.y)&&$e(qe.prev,qe,qe.next)>=0))return!1;qe=qe.nextZ}for(;kt&&kt.z>=$t;){if(kt.x>=rn&&kt.x<=ln&&kt.y>=Qr&&kt.y<=vn&&kt!==st&&kt!==bt&&j(ke,_n,ur,Zr,qt,Vr,kt.x,kt.y)&&$e(kt.prev,kt,kt.next)>=0)return!1;kt=kt.prevZ}for(;qe&&qe.z<=_r;){if(qe.x>=rn&&qe.x<=ln&&qe.y>=Qr&&qe.y<=vn&&qe!==st&&qe!==bt&&j(ke,_n,ur,Zr,qt,Vr,qe.x,qe.y)&&$e(qe.prev,qe,qe.next)>=0)return!1;qe=qe.nextZ}return!0}function P(oe,Re,Se){var et=oe;do{var st=et.prev,pt=et.next.next;!Fe(st,pt)&&lt(st,et,et.next,pt)&&se(st,pt)&&se(pt,st)&&(Re.push(st.i/Se|0),Re.push(et.i/Se|0),Re.push(pt.i/Se|0),Rt(et),Rt(et.next),et=oe=pt),et=et.next}while(et!==oe);return F(et)}function X(oe,Re,Se,et,st,pt){var bt=oe;do{for(var ke=bt.next.next;ke!==bt.prev;){if(bt.i!==ke.i&&Ce(bt,ke)){var ur=Te(bt,ke);bt=F(bt,bt.next),ur=F(ur,ur.next),z(bt,Re,Se,et,st,pt,0),z(ur,Re,Se,et,st,pt,0);return}ke=ke.next}bt=bt.next}while(bt!==oe)}function W(oe,Re,Se,et){var st=[],pt,bt,ke,ur,qt;for(pt=0,bt=Re.length;pt<bt;pt++)ke=Re[pt]*et,ur=pt<bt-1?Re[pt+1]*et:oe.length,qt=x(oe,ke,ur,et,!1),qt===qt.next&&(qt.steiner=!0),st.push(le(qt));for(st.sort(fe),pt=0;pt<st.length;pt++)Se=J(st[pt],Se);return Se}function fe(oe,Re){return oe.x-Re.x}function J(oe,Re){var Se=Be(oe,Re);if(!Se)return Re;var et=Te(Se,oe);return F(et,et.next),F(Se,Se.next)}function Be(oe,Re){var Se=Re,et=oe.x,st=oe.y,pt=-1/0,bt;do{if(st<=Se.y&&st>=Se.next.y&&Se.next.y!==Se.y){var ke=Se.x+(st-Se.y)*(Se.next.x-Se.x)/(Se.next.y-Se.y);if(ke<=et&&ke>pt&&(pt=ke,bt=Se.x<Se.next.x?Se:Se.next,ke===et))return bt}Se=Se.next}while(Se!==Re);if(!bt)return null;var ur=bt,qt=bt.x,_n=bt.y,Zr=1/0,Vr;Se=bt;do et>=Se.x&&Se.x>=qt&&et!==Se.x&&j(st<_n?et:pt,st,qt,_n,st<_n?pt:et,st,Se.x,Se.y)&&(Vr=Math.abs(st-Se.y)/(et-Se.x),se(Se,oe)&&(Vr<Zr||Vr===Zr&&(Se.x>bt.x||Se.x===bt.x&&B(bt,Se)))&&(bt=Se,Zr=Vr)),Se=Se.next;while(Se!==ur);return bt}function B(oe,Re){return $e(oe.prev,oe,Re.prev)<0&&$e(Re.next,oe,oe.next)<0}function ee(oe,Re,Se,et){var st=oe;do st.z===0&&(st.z=q(st.x,st.y,Re,Se,et)),st.prevZ=st.prev,st.nextZ=st.next,st=st.next;while(st!==oe);st.prevZ.nextZ=null,st.prevZ=null,U(st)}function U(oe){var Re,Se,et,st,pt,bt,ke,ur,qt=1;do{for(Se=oe,oe=null,pt=null,bt=0;Se;){for(bt++,et=Se,ke=0,Re=0;Re<qt&&(ke++,et=et.nextZ,!!et);Re++);for(ur=qt;ke>0||ur>0&&et;)ke!==0&&(ur===0||!et||Se.z<=et.z)?(st=Se,Se=Se.nextZ,ke--):(st=et,et=et.nextZ,ur--),pt?pt.nextZ=st:oe=st,st.prevZ=pt,pt=st;Se=et}pt.nextZ=null,qt*=2}while(bt>1);return oe}function q(oe,Re,Se,et,st){return oe=(oe-Se)*st|0,Re=(Re-et)*st|0,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,Re=(Re|Re<<8)&16711935,Re=(Re|Re<<4)&252645135,Re=(Re|Re<<2)&858993459,Re=(Re|Re<<1)&1431655765,oe|Re<<1}function le(oe){var Re=oe,Se=oe;do(Re.x<Se.x||Re.x===Se.x&&Re.y<Se.y)&&(Se=Re),Re=Re.next;while(Re!==oe);return Se}function j(oe,Re,Se,et,st,pt,bt,ke){return(st-bt)*(Re-ke)>=(oe-bt)*(pt-ke)&&(oe-bt)*(et-ke)>=(Se-bt)*(Re-ke)&&(Se-bt)*(pt-ke)>=(st-bt)*(et-ke)}function Ce(oe,Re){return oe.next.i!==Re.i&&oe.prev.i!==Re.i&&!pe(oe,Re)&&(se(oe,Re)&&se(Re,oe)&&be(oe,Re)&&($e(oe.prev,oe,Re.prev)||$e(oe,Re.prev,Re))||Fe(oe,Re)&&$e(oe.prev,oe,oe.next)>0&&$e(Re.prev,Re,Re.next)>0)}function $e(oe,Re,Se){return(Re.y-oe.y)*(Se.x-Re.x)-(Re.x-oe.x)*(Se.y-Re.y)}function Fe(oe,Re){return oe.x===Re.x&&oe.y===Re.y}function lt(oe,Re,Se,et){var st=Ze($e(oe,Re,Se)),pt=Ze($e(oe,Re,et)),bt=Ze($e(Se,et,oe)),ke=Ze($e(Se,et,Re));return!!(st!==pt&&bt!==ke||st===0&&We(oe,Se,Re)||pt===0&&We(oe,et,Re)||bt===0&&We(Se,oe,et)||ke===0&&We(Se,Re,et))}function We(oe,Re,Se){return Re.x<=Math.max(oe.x,Se.x)&&Re.x>=Math.min(oe.x,Se.x)&&Re.y<=Math.max(oe.y,Se.y)&&Re.y>=Math.min(oe.y,Se.y)}function Ze(oe){return oe>0?1:oe<0?-1:0}function pe(oe,Re){var Se=oe;do{if(Se.i!==oe.i&&Se.next.i!==oe.i&&Se.i!==Re.i&&Se.next.i!==Re.i&&lt(Se,Se.next,oe,Re))return!0;Se=Se.next}while(Se!==oe);return!1}function se(oe,Re){return $e(oe.prev,oe,oe.next)<0?$e(oe,Re,oe.next)>=0&&$e(oe,oe.prev,Re)>=0:$e(oe,Re,oe.prev)<0||$e(oe,oe.next,Re)<0}function be(oe,Re){var Se=oe,et=!1,st=(oe.x+Re.x)/2,pt=(oe.y+Re.y)/2;do Se.y>pt!=Se.next.y>pt&&Se.next.y!==Se.y&&st<(Se.next.x-Se.x)*(pt-Se.y)/(Se.next.y-Se.y)+Se.x&&(et=!et),Se=Se.next;while(Se!==oe);return et}function Te(oe,Re){var Se=new ye(oe.i,oe.x,oe.y),et=new ye(Re.i,Re.x,Re.y),st=oe.next,pt=Re.prev;return oe.next=Re,Re.prev=oe,Se.next=st,st.prev=Se,et.next=Se,Se.prev=et,pt.next=et,et.prev=pt,et}function de(oe,Re,Se,et){var st=new ye(oe,Re,Se);return et?(st.next=et.next,st.prev=et,et.next.prev=st,et.next=st):(st.prev=st,st.next=st),st}function Rt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function ye(oe,Re,Se){this.i=oe,this.x=Re,this.y=Se,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}w.deviation=function(oe,Re,Se,et){var st=Re&&Re.length,pt=st?Re[0]*Se:oe.length,bt=Math.abs(Ve(oe,0,pt,Se));if(st)for(var ke=0,ur=Re.length;ke<ur;ke++){var qt=Re[ke]*Se,_n=ke<ur-1?Re[ke+1]*Se:oe.length;bt-=Math.abs(Ve(oe,qt,_n,Se))}var Zr=0;for(ke=0;ke<et.length;ke+=3){var Vr=et[ke]*Se,rn=et[ke+1]*Se,Qr=et[ke+2]*Se;Zr+=Math.abs((oe[Vr]-oe[Qr])*(oe[rn+1]-oe[Vr+1])-(oe[Vr]-oe[rn])*(oe[Qr+1]-oe[Vr+1]))}return bt===0&&Zr===0?0:Math.abs((Zr-bt)/bt)};function Ve(oe,Re,Se,et){for(var st=0,pt=Re,bt=Se-et;pt<Se;pt+=et)st+=(oe[bt]-oe[pt])*(oe[pt+1]+oe[bt+1]),bt=pt;return st}w.flatten=function(oe){for(var Re=oe[0][0].length,Se={vertices:[],holes:[],dimensions:Re},et=0,st=0;st<oe.length;st++){for(var pt=0;pt<oe[st].length;pt++)for(var bt=0;bt<Re;bt++)Se.vertices.push(oe[st][pt][bt]);st>0&&(et+=oe[st-1].length,Se.holes.push(et))}return Se}},2268:function(He){"use strict";var w=He.exports={};w.isIE=function(x){function F(){var h=navigator.userAgent.toLowerCase();return h.indexOf("msie")!==-1||h.indexOf("trident")!==-1||h.indexOf(" edge/")!==-1}if(!F())return!1;if(!x)return!0;var z=function(){var h,D=3,P=document.createElement("div"),X=P.getElementsByTagName("i");do P.innerHTML="<!--[if gt IE "+ ++D+"]><i></i><![endif]-->";while(X[0]);return D>4?D:h}();return x===z},w.isLegacyOpera=function(){return!!window.opera}},17900:function(He){"use strict";var w=He.exports={};w.forEach=function(x,F){for(var z=0;z<x.length;z++){var h=F(x[z]);if(h)return h}}},58229:function(He,w,x){"use strict";var F=x(2268);He.exports=function(z){z=z||{};var h=z.reporter,D=z.batchProcessor,P=z.stateHandler.getState;if(!h)throw new Error("Missing required dependency: reporter.");function X(B,ee){function U(){ee(B)}if(F.isIE(8))P(B).object={proxy:U},B.attachEvent("onresize",U);else{var q=J(B);if(!q)throw new Error("Element is not detectable by this strategy.");q.contentDocument.defaultView.addEventListener("resize",U)}}function W(B){var ee=z.important?" !important; ":"; ";return(B.join(ee)+ee).trim()}function fe(B,ee,U){U||(U=ee,ee=B,B=null),B=B||{};var q=B.debug;function le(j,Ce){var $e=W(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),Fe=!1,lt=window.getComputedStyle(j),We=j.offsetWidth,Ze=j.offsetHeight;P(j).startSize={width:We,height:Ze};function pe(){function se(){if(lt.position==="static"){j.style.setProperty("position","relative",B.important?"important":"");var de=function(Rt,ye,Ve,oe){function Re(et){return et.replace(/[^-\d\.]/g,"")}var Se=Ve[oe];Se!=="auto"&&Re(Se)!=="0"&&(Rt.warn("An element that is positioned static has style."+oe+"="+Se+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+oe+" will be set to 0. Element: ",ye),ye.style.setProperty(oe,"0",B.important?"important":""))};de(h,j,lt,"top"),de(h,j,lt,"right"),de(h,j,lt,"bottom"),de(h,j,lt,"left")}}function be(){Fe||se();function de(ye,Ve){if(!ye.contentDocument){var oe=P(ye);oe.checkForObjectDocumentTimeoutId&&window.clearTimeout(oe.checkForObjectDocumentTimeoutId),oe.checkForObjectDocumentTimeoutId=setTimeout(function(){oe.checkForObjectDocumentTimeoutId=0,de(ye,Ve)},100);return}Ve(ye.contentDocument)}var Rt=this;de(Rt,function(Ve){Ce(j)})}lt.position!==""&&(se(lt),Fe=!0);var Te=document.createElement("object");Te.style.cssText=$e,Te.tabIndex=-1,Te.type="text/html",Te.setAttribute("aria-hidden","true"),Te.onload=be,F.isIE()||(Te.data="about:blank"),P(j)&&(j.appendChild(Te),P(j).object=Te,F.isIE()&&(Te.data="about:blank"))}D?D.add(pe):pe()}F.isIE(8)?U(ee):le(ee,U)}function J(B){return P(B).object}function Be(B){if(P(B)){var ee=J(B);ee&&(F.isIE(8)?B.detachEvent("onresize",ee.proxy):B.removeChild(ee),P(B).checkForObjectDocumentTimeoutId&&window.clearTimeout(P(B).checkForObjectDocumentTimeoutId),delete P(B).object)}}return{makeDetectable:fe,addListener:X,uninstall:Be}}},60787:function(He,w,x){"use strict";var F=x(17900).forEach;He.exports=function(z){z=z||{};var h=z.reporter,D=z.batchProcessor,P=z.stateHandler.getState,X=z.stateHandler.hasState,W=z.idHandler;if(!D)throw new Error("Missing required dependency: batchProcessor");if(!h)throw new Error("Missing required dependency: reporter.");var fe=U(),J="erd_scroll_detection_scrollbar_style",Be="erd_scroll_detection_container";function B(pe){q(pe,J,Be)}B(window.document);function ee(pe){var se=z.important?" !important; ":"; ";return(pe.join(se)+se).trim()}function U(){var pe=500,se=500,be=document.createElement("div");be.style.cssText=ee(["position: absolute","width: "+pe*2+"px","height: "+se*2+"px","visibility: hidden","margin: 0","padding: 0"]);var Te=document.createElement("div");Te.style.cssText=ee(["position: absolute","width: "+pe+"px","height: "+se+"px","overflow: scroll","visibility: none","top: "+-pe*3+"px","left: "+-se*3+"px","visibility: hidden","margin: 0","padding: 0"]),Te.appendChild(be),document.body.insertBefore(Te,document.body.firstChild);var de=pe-Te.clientWidth,Rt=se-Te.clientHeight;return document.body.removeChild(Te),{width:de,height:Rt}}function q(pe,se,be){function Te(Ve,oe){oe=oe||function(Se){pe.head.appendChild(Se)};var Re=pe.createElement("style");return Re.innerHTML=Ve,Re.id=se,oe(Re),Re}if(!pe.getElementById(se)){var de=be+"_animation",Rt=be+"_animation_active",ye=`/* Created by the element-resize-detector library. */
`;ye+="."+be+" > div::-webkit-scrollbar { "+ee(["display: none"])+` }

`,ye+="."+Rt+" { "+ee(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+de,"animation-name: "+de])+` }
`,ye+="@-webkit-keyframes "+de+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,ye+="@keyframes "+de+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",Te(ye)}}function le(pe){pe.className+=" "+Be+"_animation_active"}function j(pe,se,be){if(pe.addEventListener)pe.addEventListener(se,be);else if(pe.attachEvent)pe.attachEvent("on"+se,be);else return h.error("[scroll] Don't know how to add event listeners.")}function Ce(pe,se,be){if(pe.removeEventListener)pe.removeEventListener(se,be);else if(pe.detachEvent)pe.detachEvent("on"+se,be);else return h.error("[scroll] Don't know how to remove event listeners.")}function $e(pe){return P(pe).container.childNodes[0].childNodes[0].childNodes[0]}function Fe(pe){return P(pe).container.childNodes[0].childNodes[0].childNodes[1]}function lt(pe,se){var be=P(pe).listeners;if(!be.push)throw new Error("Cannot add listener to an element that is not detectable.");P(pe).listeners.push(se)}function We(pe,se,be){be||(be=se,se=pe,pe=null),pe=pe||{};function Te(){if(pe.debug){var $t=Array.prototype.slice.call(arguments);if($t.unshift(W.get(se),"Scroll: "),h.log.apply)h.log.apply(null,$t);else for(var _r=0;_r<$t.length;_r++)h.log($t[_r])}}function de($t){function _r(kt){var qe=kt.getRootNode&&kt.getRootNode().contains(kt);return kt===kt.ownerDocument.body||kt.ownerDocument.body.contains(kt)||qe}return!_r($t)||window.getComputedStyle($t)===null}function Rt($t){var _r=P($t).container.childNodes[0],kt=window.getComputedStyle(_r);return!kt.width||kt.width.indexOf("px")===-1}function ye(){var $t=window.getComputedStyle(se),_r={};return _r.position=$t.position,_r.width=se.offsetWidth,_r.height=se.offsetHeight,_r.top=$t.top,_r.right=$t.right,_r.bottom=$t.bottom,_r.left=$t.left,_r.widthCSS=$t.width,_r.heightCSS=$t.height,_r}function Ve(){var $t=ye();P(se).startSize={width:$t.width,height:$t.height},Te("Element start size",P(se).startSize)}function oe(){P(se).listeners=[]}function Re(){if(Te("storeStyle invoked."),!P(se)){Te("Aborting because element has been uninstalled");return}var $t=ye();P(se).style=$t}function Se($t,_r,kt){P($t).lastWidth=_r,P($t).lastHeight=kt}function et($t){return $e($t).childNodes[0]}function st(){return 2*fe.width+1}function pt(){return 2*fe.height+1}function bt($t){return $t+10+st()}function ke($t){return $t+10+pt()}function ur($t){return $t*2+st()}function qt($t){return $t*2+pt()}function _n($t,_r,kt){var qe=$e($t),Sr=Fe($t),Pe=bt(_r),Hr=ke(kt),vr=ur(_r),Ie=qt(kt);qe.scrollLeft=Pe,qe.scrollTop=Hr,Sr.scrollLeft=vr,Sr.scrollTop=Ie}function Zr(){var $t=P(se).container;if(!$t){$t=document.createElement("div"),$t.className=Be,$t.style.cssText=ee(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),P(se).container=$t,le($t),se.appendChild($t);var _r=function(){P(se).onRendered&&P(se).onRendered()};j($t,"animationstart",_r),P(se).onAnimationStart=_r}return $t}function Vr(){function $t(){var ui=P(se).style;if(ui.position==="static"){se.style.setProperty("position","relative",pe.important?"important":"");var pi=function(it,V,H,Ee){function Le(xt){return xt.replace(/[^-\d\.]/g,"")}var ze=H[Ee];ze!=="auto"&&Le(ze)!=="0"&&(it.warn("An element that is positioned static has style."+Ee+"="+ze+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Ee+" will be set to 0. Element: ",V),V.style[Ee]=0)};pi(h,se,ui,"top"),pi(h,se,ui,"right"),pi(h,se,ui,"bottom"),pi(h,se,ui,"left")}}function _r(ui,pi,it,V){return ui=ui?ui+"px":"0",pi=pi?pi+"px":"0",it=it?it+"px":"0",V=V?V+"px":"0",["left: "+ui,"top: "+pi,"right: "+V,"bottom: "+it]}if(Te("Injecting elements"),!P(se)){Te("Aborting because element has been uninstalled");return}$t();var kt=P(se).container;kt||(kt=Zr());var qe=fe.width,Sr=fe.height,Pe=ee(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Hr=ee(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(_r(-(1+qe),-(1+Sr),-Sr,-qe))),vr=ee(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Ie=ee(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),gr=ee(["position: absolute","left: 0","top: 0"]),Wr=ee(["position: absolute","width: 200%","height: 200%"]),Dr=document.createElement("div"),Xr=document.createElement("div"),Vn=document.createElement("div"),ni=document.createElement("div"),Dn=document.createElement("div"),Jn=document.createElement("div");Dr.dir="ltr",Dr.style.cssText=Pe,Dr.className=Be,Xr.className=Be,Xr.style.cssText=Hr,Vn.style.cssText=vr,ni.style.cssText=gr,Dn.style.cssText=Ie,Jn.style.cssText=Wr,Vn.appendChild(ni),Dn.appendChild(Jn),Xr.appendChild(Vn),Xr.appendChild(Dn),Dr.appendChild(Xr),kt.appendChild(Dr);function Yi(){var ui=P(se);ui&&ui.onExpand?ui.onExpand():Te("Aborting expand scroll handler: element has been uninstalled")}function bi(){var ui=P(se);ui&&ui.onShrink?ui.onShrink():Te("Aborting shrink scroll handler: element has been uninstalled")}j(Vn,"scroll",Yi),j(Dn,"scroll",bi),P(se).onExpandScroll=Yi,P(se).onShrinkScroll=bi}function rn(){function $t(vr,Ie,gr){var Wr=et(vr),Dr=bt(Ie),Xr=ke(gr);Wr.style.setProperty("width",Dr+"px",pe.important?"important":""),Wr.style.setProperty("height",Xr+"px",pe.important?"important":"")}function _r(vr){var Ie=se.offsetWidth,gr=se.offsetHeight,Wr=Ie!==P(se).lastWidth||gr!==P(se).lastHeight;Te("Storing current size",Ie,gr),Se(se,Ie,gr),D.add(0,function(){if(Wr){if(!P(se)){Te("Aborting because element has been uninstalled");return}if(!kt()){Te("Aborting because element container has not been initialized");return}if(pe.debug){var Xr=se.offsetWidth,Vn=se.offsetHeight;(Xr!==Ie||Vn!==gr)&&h.warn(W.get(se),"Scroll: Size changed before updating detector elements.")}$t(se,Ie,gr)}}),D.add(1,function(){if(!P(se)){Te("Aborting because element has been uninstalled");return}if(!kt()){Te("Aborting because element container has not been initialized");return}_n(se,Ie,gr)}),Wr&&vr&&D.add(2,function(){if(!P(se)){Te("Aborting because element has been uninstalled");return}if(!kt()){Te("Aborting because element container has not been initialized");return}vr()})}function kt(){return!!P(se).container}function qe(){function vr(){return P(se).lastNotifiedWidth===void 0}Te("notifyListenersIfNeeded invoked");var Ie=P(se);if(vr()&&Ie.lastWidth===Ie.startSize.width&&Ie.lastHeight===Ie.startSize.height)return Te("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Ie.lastWidth===Ie.lastNotifiedWidth&&Ie.lastHeight===Ie.lastNotifiedHeight)return Te("Not notifying: Size already notified");Te("Current size not notified, notifying..."),Ie.lastNotifiedWidth=Ie.lastWidth,Ie.lastNotifiedHeight=Ie.lastHeight,F(P(se).listeners,function(gr){gr(se)})}function Sr(){if(Te("startanimation triggered."),Rt(se)){Te("Ignoring since element is still unrendered...");return}Te("Element rendered.");var vr=$e(se),Ie=Fe(se);(vr.scrollLeft===0||vr.scrollTop===0||Ie.scrollLeft===0||Ie.scrollTop===0)&&(Te("Scrollbars out of sync. Updating detector elements..."),_r(qe))}function Pe(){if(Te("Scroll detected."),Rt(se)){Te("Scroll event fired while unrendered. Ignoring...");return}_r(qe)}if(Te("registerListenersAndPositionElements invoked."),!P(se)){Te("Aborting because element has been uninstalled");return}P(se).onRendered=Sr,P(se).onExpand=Pe,P(se).onShrink=Pe;var Hr=P(se).style;$t(se,Hr.width,Hr.height)}function Qr(){if(Te("finalizeDomMutation invoked."),!P(se)){Te("Aborting because element has been uninstalled");return}var $t=P(se).style;Se(se,$t.width,$t.height),_n(se,$t.width,$t.height)}function ln(){be(se)}function vn(){Te("Installing..."),oe(),Ve(),D.add(0,Re),D.add(1,Vr),D.add(2,rn),D.add(3,Qr),D.add(4,ln)}Te("Making detectable..."),de(se)?(Te("Element is detached"),Zr(),Te("Waiting until element is attached..."),P(se).onRendered=function(){Te("Element is now attached"),vn()}):vn()}function Ze(pe){var se=P(pe);se&&(se.onExpandScroll&&Ce($e(pe),"scroll",se.onExpandScroll),se.onShrinkScroll&&Ce(Fe(pe),"scroll",se.onShrinkScroll),se.onAnimationStart&&Ce(se.container,"animationstart",se.onAnimationStart),se.container&&pe.removeChild(se.container))}return{makeDetectable:We,addListener:lt,uninstall:Ze,initDocument:B}}},63844:function(He,w,x){"use strict";var F=x(17900).forEach,z=x(68452),h=x(96199),D=x(75805),P=x(79799),X=x(71724),W=x(2268),fe=x(98129),J=x(21931),Be=x(58229),B=x(60787);function ee(j){return Array.isArray(j)||j.length!==void 0}function U(j){if(Array.isArray(j))return j;var Ce=[];return F(j,function($e){Ce.push($e)}),Ce}function q(j){return j&&j.nodeType===1}He.exports=function(j){j=j||{};var Ce;if(j.idHandler)Ce={get:function(et){return j.idHandler.get(et,!0)},set:j.idHandler.set};else{var $e=D(),Fe=P({idGenerator:$e,stateHandler:J});Ce=Fe}var lt=j.reporter;if(!lt){var We=lt===!1;lt=X(We)}var Ze=le(j,"batchProcessor",fe({reporter:lt})),pe={};pe.callOnAdd=!!le(j,"callOnAdd",!0),pe.debug=!!le(j,"debug",!1);var se=h(Ce),be=z({stateHandler:J}),Te,de=le(j,"strategy","object"),Rt=le(j,"important",!1),ye={reporter:lt,batchProcessor:Ze,stateHandler:J,idHandler:Ce,important:Rt};if(de==="scroll"&&(W.isLegacyOpera()?(lt.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),de="object"):W.isIE(9)&&(lt.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),de="object")),de==="scroll")Te=B(ye);else if(de==="object")Te=Be(ye);else throw new Error("Invalid strategy name: "+de);var Ve={};function oe(et,st,pt){function bt(Vr){var rn=se.get(Vr);F(rn,function(ln){ln(Vr)})}function ke(Vr,rn,Qr){se.add(rn,Qr),Vr&&Qr(rn)}if(pt||(pt=st,st=et,et={}),!st)throw new Error("At least one element required.");if(!pt)throw new Error("Listener required.");if(q(st))st=[st];else if(ee(st))st=U(st);else return lt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var ur=0,qt=le(et,"callOnAdd",pe.callOnAdd),_n=le(et,"onReady",function(){}),Zr=le(et,"debug",pe.debug);F(st,function(rn){J.getState(rn)||(J.initState(rn),Ce.set(rn));var Qr=Ce.get(rn);if(Zr&&lt.log("Attaching listener to element",Qr,rn),!be.isDetectable(rn)){if(Zr&&lt.log(Qr,"Not detectable."),be.isBusy(rn)){Zr&&lt.log(Qr,"System busy making it detectable"),ke(qt,rn,pt),Ve[Qr]=Ve[Qr]||[],Ve[Qr].push(function(){ur++,ur===st.length&&_n()});return}return Zr&&lt.log(Qr,"Making detectable..."),be.markBusy(rn,!0),Te.makeDetectable({debug:Zr,important:Rt},rn,function(vn){if(Zr&&lt.log(Qr,"onElementDetectable"),J.getState(vn)){be.markAsDetectable(vn),be.markBusy(vn,!1),Te.addListener(vn,bt),ke(qt,vn,pt);var $t=J.getState(vn);if($t&&$t.startSize){var _r=vn.offsetWidth,kt=vn.offsetHeight;($t.startSize.width!==_r||$t.startSize.height!==kt)&&bt(vn)}Ve[Qr]&&F(Ve[Qr],function(qe){qe()})}else Zr&&lt.log(Qr,"Element uninstalled before being detectable.");delete Ve[Qr],ur++,ur===st.length&&_n()})}Zr&&lt.log(Qr,"Already detecable, adding listener."),ke(qt,rn,pt),ur++}),ur===st.length&&_n()}function Re(et){if(!et)return lt.error("At least one element is required.");if(q(et))et=[et];else if(ee(et))et=U(et);else return lt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");F(et,function(st){se.removeAllListeners(st),Te.uninstall(st),J.cleanState(st)})}function Se(et){Te.initDocument&&Te.initDocument(et)}return{listenTo:oe,removeListener:se.removeListener,removeAllListeners:se.removeAllListeners,uninstall:Re,initDocument:Se}};function le(j,Ce,$e){var Fe=j[Ce];return Fe==null&&$e!==void 0?$e:Fe}},68452:function(He){"use strict";He.exports=function(w){var x=w.stateHandler.getState;function F(P){var X=x(P);return X&&!!X.isDetectable}function z(P){x(P).isDetectable=!0}function h(P){return!!x(P).busy}function D(P,X){x(P).busy=!!X}return{isDetectable:F,markAsDetectable:z,isBusy:h,markBusy:D}}},75805:function(He){"use strict";He.exports=function(){var w=1;function x(){return w++}return{generate:x}}},79799:function(He){"use strict";He.exports=function(w){var x=w.idGenerator,F=w.stateHandler.getState;function z(D){var P=F(D);return P&&P.id!==void 0?P.id:null}function h(D){var P=F(D);if(!P)throw new Error("setId required the element to have a resize detection state.");var X=x.generate();return P.id=X,X}return{get:z,set:h}}},96199:function(He){"use strict";He.exports=function(w){var x={};function F(P){var X=w.get(P);return X===void 0?[]:x[X]||[]}function z(P,X){var W=w.get(P);x[W]||(x[W]=[]),x[W].push(X)}function h(P,X){for(var W=F(P),fe=0,J=W.length;fe<J;++fe)if(W[fe]===X){W.splice(fe,1);break}}function D(P){var X=F(P);X&&(X.length=0)}return{get:F,add:z,removeListener:h,removeAllListeners:D}}},71724:function(He){"use strict";He.exports=function(w){function x(){}var F={log:x,warn:x,error:x};if(!w&&window.console){var z=function(h,D){h[D]=function(){var X=console[D];if(X.apply)X.apply(console,arguments);else for(var W=0;W<arguments.length;W++)X(arguments[W])}};z(F,"log"),z(F,"warn"),z(F,"error")}return F}},21931:function(He){"use strict";var w="_erd";function x(h){return h[w]={},F(h)}function F(h){return h[w]}function z(h){delete h[w]}He.exports={initState:x,getState:F,cleanState:z}},26729:function(He){"use strict";var w=Object.prototype.hasOwnProperty,x="~";function F(){}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(x=!1));function z(X,W,fe){this.fn=X,this.context=W,this.once=fe||!1}function h(X,W,fe,J,Be){if(typeof fe!="function")throw new TypeError("The listener must be a function");var B=new z(fe,J||X,Be),ee=x?x+W:W;return X._events[ee]?X._events[ee].fn?X._events[ee]=[X._events[ee],B]:X._events[ee].push(B):(X._events[ee]=B,X._eventsCount++),X}function D(X,W){--X._eventsCount===0?X._events=new F:delete X._events[W]}function P(){this._events=new F,this._eventsCount=0}P.prototype.eventNames=function(){var W=[],fe,J;if(this._eventsCount===0)return W;for(J in fe=this._events)w.call(fe,J)&&W.push(x?J.slice(1):J);return Object.getOwnPropertySymbols?W.concat(Object.getOwnPropertySymbols(fe)):W},P.prototype.listeners=function(W){var fe=x?x+W:W,J=this._events[fe];if(!J)return[];if(J.fn)return[J.fn];for(var Be=0,B=J.length,ee=new Array(B);Be<B;Be++)ee[Be]=J[Be].fn;return ee},P.prototype.listenerCount=function(W){var fe=x?x+W:W,J=this._events[fe];return J?J.fn?1:J.length:0},P.prototype.emit=function(W,fe,J,Be,B,ee){var U=x?x+W:W;if(!this._events[U])return!1;var q=this._events[U],le=arguments.length,j,Ce;if(q.fn){switch(q.once&&this.removeListener(W,q.fn,void 0,!0),le){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,fe),!0;case 3:return q.fn.call(q.context,fe,J),!0;case 4:return q.fn.call(q.context,fe,J,Be),!0;case 5:return q.fn.call(q.context,fe,J,Be,B),!0;case 6:return q.fn.call(q.context,fe,J,Be,B,ee),!0}for(Ce=1,j=new Array(le-1);Ce<le;Ce++)j[Ce-1]=arguments[Ce];q.fn.apply(q.context,j)}else{var $e=q.length,Fe;for(Ce=0;Ce<$e;Ce++)switch(q[Ce].once&&this.removeListener(W,q[Ce].fn,void 0,!0),le){case 1:q[Ce].fn.call(q[Ce].context);break;case 2:q[Ce].fn.call(q[Ce].context,fe);break;case 3:q[Ce].fn.call(q[Ce].context,fe,J);break;case 4:q[Ce].fn.call(q[Ce].context,fe,J,Be);break;default:if(!j)for(Fe=1,j=new Array(le-1);Fe<le;Fe++)j[Fe-1]=arguments[Fe];q[Ce].fn.apply(q[Ce].context,j)}}return!0},P.prototype.on=function(W,fe,J){return h(this,W,fe,J,!1)},P.prototype.once=function(W,fe,J){return h(this,W,fe,J,!0)},P.prototype.removeListener=function(W,fe,J,Be){var B=x?x+W:W;if(!this._events[B])return this;if(!fe)return D(this,B),this;var ee=this._events[B];if(ee.fn)ee.fn===fe&&(!Be||ee.once)&&(!J||ee.context===J)&&D(this,B);else{for(var U=0,q=[],le=ee.length;U<le;U++)(ee[U].fn!==fe||Be&&!ee[U].once||J&&ee[U].context!==J)&&q.push(ee[U]);q.length?this._events[B]=q.length===1?q[0]:q:D(this,B)}return this},P.prototype.removeAllListeners=function(W){var fe;return W?(fe=x?x+W:W,this._events[fe]&&D(this,fe)):(this._events=new F,this._eventsCount=0),this},P.prototype.off=P.prototype.removeListener,P.prototype.addListener=P.prototype.on,P.prefixed=x,P.EventEmitter=P,He.exports=P},50840:function(He,w,x){var F;(function(z,h,D,P){"use strict";var X=["","webkit","Moz","MS","ms","o"],W=h.createElement("div"),fe="function",J=Math.round,Be=Math.abs,B=Date.now;function ee(Qe,gt,Gt){return setTimeout(lt(Qe,Gt),gt)}function U(Qe,gt,Gt){return Array.isArray(Qe)?(q(Qe,Gt[gt],Gt),!0):!1}function q(Qe,gt,Gt){var Pr;if(Qe)if(Qe.forEach)Qe.forEach(gt,Gt);else if(Qe.length!==P)for(Pr=0;Pr<Qe.length;)gt.call(Gt,Qe[Pr],Pr,Qe),Pr++;else for(Pr in Qe)Qe.hasOwnProperty(Pr)&&gt.call(Gt,Qe[Pr],Pr,Qe)}function le(Qe,gt,Gt){var Pr="DEPRECATED METHOD: "+gt+`
`+Gt+` AT 
`;return function(){var Tn=new Error("get-stack-trace"),di=Tn&&Tn.stack?Tn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",fa=z.console&&(z.console.warn||z.console.log);return fa&&fa.call(z.console,Pr,di),Qe.apply(this,arguments)}}var j;typeof Object.assign!="function"?j=function(gt){if(gt===P||gt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Gt=Object(gt),Pr=1;Pr<arguments.length;Pr++){var Tn=arguments[Pr];if(Tn!==P&&Tn!==null)for(var di in Tn)Tn.hasOwnProperty(di)&&(Gt[di]=Tn[di])}return Gt}:j=Object.assign;var Ce=le(function(gt,Gt,Pr){for(var Tn=Object.keys(Gt),di=0;di<Tn.length;)(!Pr||Pr&&gt[Tn[di]]===P)&&(gt[Tn[di]]=Gt[Tn[di]]),di++;return gt},"extend","Use `assign`."),$e=le(function(gt,Gt){return Ce(gt,Gt,!0)},"merge","Use `assign`.");function Fe(Qe,gt,Gt){var Pr=gt.prototype,Tn;Tn=Qe.prototype=Object.create(Pr),Tn.constructor=Qe,Tn._super=Pr,Gt&&j(Tn,Gt)}function lt(Qe,gt){return function(){return Qe.apply(gt,arguments)}}function We(Qe,gt){return typeof Qe==fe?Qe.apply(gt&&gt[0]||P,gt):Qe}function Ze(Qe,gt){return Qe===P?gt:Qe}function pe(Qe,gt,Gt){q(de(gt),function(Pr){Qe.addEventListener(Pr,Gt,!1)})}function se(Qe,gt,Gt){q(de(gt),function(Pr){Qe.removeEventListener(Pr,Gt,!1)})}function be(Qe,gt){for(;Qe;){if(Qe==gt)return!0;Qe=Qe.parentNode}return!1}function Te(Qe,gt){return Qe.indexOf(gt)>-1}function de(Qe){return Qe.trim().split(/\s+/g)}function Rt(Qe,gt,Gt){if(Qe.indexOf&&!Gt)return Qe.indexOf(gt);for(var Pr=0;Pr<Qe.length;){if(Gt&&Qe[Pr][Gt]==gt||!Gt&&Qe[Pr]===gt)return Pr;Pr++}return-1}function ye(Qe){return Array.prototype.slice.call(Qe,0)}function Ve(Qe,gt,Gt){for(var Pr=[],Tn=[],di=0;di<Qe.length;){var fa=gt?Qe[di][gt]:Qe[di];Rt(Tn,fa)<0&&Pr.push(Qe[di]),Tn[di]=fa,di++}return Gt&&(gt?Pr=Pr.sort(function(Ko,Po){return Ko[gt]>Po[gt]}):Pr=Pr.sort()),Pr}function oe(Qe,gt){for(var Gt,Pr,Tn=gt[0].toUpperCase()+gt.slice(1),di=0;di<X.length;){if(Gt=X[di],Pr=Gt?Gt+Tn:gt,Pr in Qe)return Pr;di++}return P}var Re=1;function Se(){return Re++}function et(Qe){var gt=Qe.ownerDocument||Qe;return gt.defaultView||gt.parentWindow||z}var st=/mobile|tablet|ip(ad|hone|od)|android/i,pt="ontouchstart"in z,bt=oe(z,"PointerEvent")!==P,ke=pt&&st.test(navigator.userAgent),ur="touch",qt="pen",_n="mouse",Zr="kinect",Vr=25,rn=1,Qr=2,ln=4,vn=8,$t=1,_r=2,kt=4,qe=8,Sr=16,Pe=_r|kt,Hr=qe|Sr,vr=Pe|Hr,Ie=["x","y"],gr=["clientX","clientY"];function Wr(Qe,gt){var Gt=this;this.manager=Qe,this.callback=gt,this.element=Qe.element,this.target=Qe.options.inputTarget,this.domHandler=function(Pr){We(Qe.options.enable,[Qe])&&Gt.handler(Pr)},this.init()}Wr.prototype={handler:function(){},init:function(){this.evEl&&pe(this.element,this.evEl,this.domHandler),this.evTarget&&pe(this.target,this.evTarget,this.domHandler),this.evWin&&pe(et(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&se(this.element,this.evEl,this.domHandler),this.evTarget&&se(this.target,this.evTarget,this.domHandler),this.evWin&&se(et(this.element),this.evWin,this.domHandler)}};function Dr(Qe){var gt,Gt=Qe.options.inputClass;return Gt?gt=Gt:bt?gt=Q:ke?gt=vt:pt?gt=$r:gt=xt,new gt(Qe,Xr)}function Xr(Qe,gt,Gt){var Pr=Gt.pointers.length,Tn=Gt.changedPointers.length,di=gt&rn&&Pr-Tn===0,fa=gt&(ln|vn)&&Pr-Tn===0;Gt.isFirst=!!di,Gt.isFinal=!!fa,di&&(Qe.session={}),Gt.eventType=gt,Vn(Qe,Gt),Qe.emit("hammer.input",Gt),Qe.recognize(Gt),Qe.session.prevInput=Gt}function Vn(Qe,gt){var Gt=Qe.session,Pr=gt.pointers,Tn=Pr.length;Gt.firstInput||(Gt.firstInput=Jn(gt)),Tn>1&&!Gt.firstMultiple?Gt.firstMultiple=Jn(gt):Tn===1&&(Gt.firstMultiple=!1);var di=Gt.firstInput,fa=Gt.firstMultiple,Bo=fa?fa.center:di.center,Ko=gt.center=Yi(Pr);gt.timeStamp=B(),gt.deltaTime=gt.timeStamp-di.timeStamp,gt.angle=it(Bo,Ko),gt.distance=pi(Bo,Ko),ni(Gt,gt),gt.offsetDirection=ui(gt.deltaX,gt.deltaY);var Po=bi(gt.deltaTime,gt.deltaX,gt.deltaY);gt.overallVelocityX=Po.x,gt.overallVelocityY=Po.y,gt.overallVelocity=Be(Po.x)>Be(Po.y)?Po.x:Po.y,gt.scale=fa?H(fa.pointers,Pr):1,gt.rotation=fa?V(fa.pointers,Pr):0,gt.maxPointers=Gt.prevInput?gt.pointers.length>Gt.prevInput.maxPointers?gt.pointers.length:Gt.prevInput.maxPointers:gt.pointers.length,Dn(Gt,gt);var Us=Qe.element;be(gt.srcEvent.target,Us)&&(Us=gt.srcEvent.target),gt.target=Us}function ni(Qe,gt){var Gt=gt.center,Pr=Qe.offsetDelta||{},Tn=Qe.prevDelta||{},di=Qe.prevInput||{};(gt.eventType===rn||di.eventType===ln)&&(Tn=Qe.prevDelta={x:di.deltaX||0,y:di.deltaY||0},Pr=Qe.offsetDelta={x:Gt.x,y:Gt.y}),gt.deltaX=Tn.x+(Gt.x-Pr.x),gt.deltaY=Tn.y+(Gt.y-Pr.y)}function Dn(Qe,gt){var Gt=Qe.lastInterval||gt,Pr=gt.timeStamp-Gt.timeStamp,Tn,di,fa,Bo;if(gt.eventType!=vn&&(Pr>Vr||Gt.velocity===P)){var Ko=gt.deltaX-Gt.deltaX,Po=gt.deltaY-Gt.deltaY,Us=bi(Pr,Ko,Po);di=Us.x,fa=Us.y,Tn=Be(Us.x)>Be(Us.y)?Us.x:Us.y,Bo=ui(Ko,Po),Qe.lastInterval=gt}else Tn=Gt.velocity,di=Gt.velocityX,fa=Gt.velocityY,Bo=Gt.direction;gt.velocity=Tn,gt.velocityX=di,gt.velocityY=fa,gt.direction=Bo}function Jn(Qe){for(var gt=[],Gt=0;Gt<Qe.pointers.length;)gt[Gt]={clientX:J(Qe.pointers[Gt].clientX),clientY:J(Qe.pointers[Gt].clientY)},Gt++;return{timeStamp:B(),pointers:gt,center:Yi(gt),deltaX:Qe.deltaX,deltaY:Qe.deltaY}}function Yi(Qe){var gt=Qe.length;if(gt===1)return{x:J(Qe[0].clientX),y:J(Qe[0].clientY)};for(var Gt=0,Pr=0,Tn=0;Tn<gt;)Gt+=Qe[Tn].clientX,Pr+=Qe[Tn].clientY,Tn++;return{x:J(Gt/gt),y:J(Pr/gt)}}function bi(Qe,gt,Gt){return{x:gt/Qe||0,y:Gt/Qe||0}}function ui(Qe,gt){return Qe===gt?$t:Be(Qe)>=Be(gt)?Qe<0?_r:kt:gt<0?qe:Sr}function pi(Qe,gt,Gt){Gt||(Gt=Ie);var Pr=gt[Gt[0]]-Qe[Gt[0]],Tn=gt[Gt[1]]-Qe[Gt[1]];return Math.sqrt(Pr*Pr+Tn*Tn)}function it(Qe,gt,Gt){Gt||(Gt=Ie);var Pr=gt[Gt[0]]-Qe[Gt[0]],Tn=gt[Gt[1]]-Qe[Gt[1]];return Math.atan2(Tn,Pr)*180/Math.PI}function V(Qe,gt){return it(gt[1],gt[0],gr)+it(Qe[1],Qe[0],gr)}function H(Qe,gt){return pi(gt[0],gt[1],gr)/pi(Qe[0],Qe[1],gr)}var Ee={mousedown:rn,mousemove:Qr,mouseup:ln},Le="mousedown",ze="mousemove mouseup";function xt(){this.evEl=Le,this.evWin=ze,this.pressed=!1,Wr.apply(this,arguments)}Fe(xt,Wr,{handler:function(gt){var Gt=Ee[gt.type];Gt&rn&&gt.button===0&&(this.pressed=!0),Gt&Qr&&gt.which!==1&&(Gt=ln),this.pressed&&(Gt&ln&&(this.pressed=!1),this.callback(this.manager,Gt,{pointers:[gt],changedPointers:[gt],pointerType:_n,srcEvent:gt}))}});var Ut={pointerdown:rn,pointermove:Qr,pointerup:ln,pointercancel:vn,pointerout:vn},ir={2:ur,3:qt,4:_n,5:Zr},Ft="pointerdown",te="pointermove pointerup pointercancel";z.MSPointerEvent&&!z.PointerEvent&&(Ft="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel");function Q(){this.evEl=Ft,this.evWin=te,Wr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Fe(Q,Wr,{handler:function(gt){var Gt=this.store,Pr=!1,Tn=gt.type.toLowerCase().replace("ms",""),di=Ut[Tn],fa=ir[gt.pointerType]||gt.pointerType,Bo=fa==ur,Ko=Rt(Gt,gt.pointerId,"pointerId");di&rn&&(gt.button===0||Bo)?Ko<0&&(Gt.push(gt),Ko=Gt.length-1):di&(ln|vn)&&(Pr=!0),!(Ko<0)&&(Gt[Ko]=gt,this.callback(this.manager,di,{pointers:Gt,changedPointers:[gt],pointerType:fa,srcEvent:gt}),Pr&&Gt.splice(Ko,1))}});var ve={touchstart:rn,touchmove:Qr,touchend:ln,touchcancel:vn},Oe="touchstart",Xe="touchstart touchmove touchend touchcancel";function ft(){this.evTarget=Oe,this.evWin=Xe,this.started=!1,Wr.apply(this,arguments)}Fe(ft,Wr,{handler:function(gt){var Gt=ve[gt.type];if(Gt===rn&&(this.started=!0),!!this.started){var Pr=Et.call(this,gt,Gt);Gt&(ln|vn)&&Pr[0].length-Pr[1].length===0&&(this.started=!1),this.callback(this.manager,Gt,{pointers:Pr[0],changedPointers:Pr[1],pointerType:ur,srcEvent:gt})}}});function Et(Qe,gt){var Gt=ye(Qe.touches),Pr=ye(Qe.changedTouches);return gt&(ln|vn)&&(Gt=Ve(Gt.concat(Pr),"identifier",!0)),[Gt,Pr]}var Ne={touchstart:rn,touchmove:Qr,touchend:ln,touchcancel:vn},Ue="touchstart touchmove touchend touchcancel";function vt(){this.evTarget=Ue,this.targetIds={},Wr.apply(this,arguments)}Fe(vt,Wr,{handler:function(gt){var Gt=Ne[gt.type],Pr=ue.call(this,gt,Gt);Pr&&this.callback(this.manager,Gt,{pointers:Pr[0],changedPointers:Pr[1],pointerType:ur,srcEvent:gt})}});function ue(Qe,gt){var Gt=ye(Qe.touches),Pr=this.targetIds;if(gt&(rn|Qr)&&Gt.length===1)return Pr[Gt[0].identifier]=!0,[Gt,Gt];var Tn,di,fa=ye(Qe.changedTouches),Bo=[],Ko=this.target;if(di=Gt.filter(function(Po){return be(Po.target,Ko)}),gt===rn)for(Tn=0;Tn<di.length;)Pr[di[Tn].identifier]=!0,Tn++;for(Tn=0;Tn<fa.length;)Pr[fa[Tn].identifier]&&Bo.push(fa[Tn]),gt&(ln|vn)&&delete Pr[fa[Tn].identifier],Tn++;if(Bo.length)return[Ve(di.concat(Bo),"identifier",!0),Bo]}var Lr=2500,lr=25;function $r(){Wr.apply(this,arguments);var Qe=lt(this.handler,this);this.touch=new vt(this.manager,Qe),this.mouse=new xt(this.manager,Qe),this.primaryTouch=null,this.lastTouches=[]}Fe($r,Wr,{handler:function(gt,Gt,Pr){var Tn=Pr.pointerType==ur,di=Pr.pointerType==_n;if(!(di&&Pr.sourceCapabilities&&Pr.sourceCapabilities.firesTouchEvents)){if(Tn)Rn.call(this,Gt,Pr);else if(di&&xr.call(this,Pr))return;this.callback(gt,Gt,Pr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Rn(Qe,gt){Qe&rn?(this.primaryTouch=gt.changedPointers[0].identifier,nn.call(this,gt)):Qe&(ln|vn)&&nn.call(this,gt)}function nn(Qe){var gt=Qe.changedPointers[0];if(gt.identifier===this.primaryTouch){var Gt={x:gt.clientX,y:gt.clientY};this.lastTouches.push(Gt);var Pr=this.lastTouches,Tn=function(){var di=Pr.indexOf(Gt);di>-1&&Pr.splice(di,1)};setTimeout(Tn,Lr)}}function xr(Qe){for(var gt=Qe.srcEvent.clientX,Gt=Qe.srcEvent.clientY,Pr=0;Pr<this.lastTouches.length;Pr++){var Tn=this.lastTouches[Pr],di=Math.abs(gt-Tn.x),fa=Math.abs(Gt-Tn.y);if(di<=lr&&fa<=lr)return!0}return!1}var Or=oe(W.style,"touchAction"),sn=Or!==P,xn="compute",wi="auto",Nn="manipulation",Bi="none",sa="pan-x",Fi="pan-y",bn=ua();function ei(Qe,gt){this.manager=Qe,this.set(gt)}ei.prototype={set:function(Qe){Qe==xn&&(Qe=this.compute()),sn&&this.manager.element.style&&bn[Qe]&&(this.manager.element.style[Or]=Qe),this.actions=Qe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Qe=[];return q(this.manager.recognizers,function(gt){We(gt.options.enable,[gt])&&(Qe=Qe.concat(gt.getTouchAction()))}),ga(Qe.join(" "))},preventDefaults:function(Qe){var gt=Qe.srcEvent,Gt=Qe.offsetDirection;if(this.manager.session.prevented){gt.preventDefault();return}var Pr=this.actions,Tn=Te(Pr,Bi)&&!bn[Bi],di=Te(Pr,Fi)&&!bn[Fi],fa=Te(Pr,sa)&&!bn[sa];if(Tn){var Bo=Qe.pointers.length===1,Ko=Qe.distance<2,Po=Qe.deltaTime<250;if(Bo&&Ko&&Po)return}if(!(fa&&di)&&(Tn||di&&Gt&Pe||fa&&Gt&Hr))return this.preventSrc(gt)},preventSrc:function(Qe){this.manager.session.prevented=!0,Qe.preventDefault()}};function ga(Qe){if(Te(Qe,Bi))return Bi;var gt=Te(Qe,sa),Gt=Te(Qe,Fi);return gt&&Gt?Bi:gt||Gt?gt?sa:Fi:Te(Qe,Nn)?Nn:wi}function ua(){if(!sn)return!1;var Qe={},gt=z.CSS&&z.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Gt){Qe[Gt]=gt?z.CSS.supports("touch-action",Gt):!0}),Qe}var no=1,ia=2,zi=4,Nr=8,ji=Nr,Hs=16,Da=32;function Za(Qe){this.options=j({},this.defaults,Qe||{}),this.id=Se(),this.manager=null,this.options.enable=Ze(this.options.enable,!0),this.state=no,this.simultaneous={},this.requireFail=[]}Za.prototype={defaults:{},set:function(Qe){return j(this.options,Qe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Qe){if(U(Qe,"recognizeWith",this))return this;var gt=this.simultaneous;return Qe=Ka(Qe,this),gt[Qe.id]||(gt[Qe.id]=Qe,Qe.recognizeWith(this)),this},dropRecognizeWith:function(Qe){return U(Qe,"dropRecognizeWith",this)?this:(Qe=Ka(Qe,this),delete this.simultaneous[Qe.id],this)},requireFailure:function(Qe){if(U(Qe,"requireFailure",this))return this;var gt=this.requireFail;return Qe=Ka(Qe,this),Rt(gt,Qe)===-1&&(gt.push(Qe),Qe.requireFailure(this)),this},dropRequireFailure:function(Qe){if(U(Qe,"dropRequireFailure",this))return this;Qe=Ka(Qe,this);var gt=Rt(this.requireFail,Qe);return gt>-1&&this.requireFail.splice(gt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Qe){return!!this.simultaneous[Qe.id]},emit:function(Qe){var gt=this,Gt=this.state;function Pr(Tn){gt.manager.emit(Tn,Qe)}Gt<Nr&&Pr(gt.options.event+Qs(Gt)),Pr(gt.options.event),Qe.additionalEvent&&Pr(Qe.additionalEvent),Gt>=Nr&&Pr(gt.options.event+Qs(Gt))},tryEmit:function(Qe){if(this.canEmit())return this.emit(Qe);this.state=Da},canEmit:function(){for(var Qe=0;Qe<this.requireFail.length;){if(!(this.requireFail[Qe].state&(Da|no)))return!1;Qe++}return!0},recognize:function(Qe){var gt=j({},Qe);if(!We(this.options.enable,[this,gt])){this.reset(),this.state=Da;return}this.state&(ji|Hs|Da)&&(this.state=no),this.state=this.process(gt),this.state&(ia|zi|Nr|Hs)&&this.tryEmit(gt)},process:function(Qe){},getTouchAction:function(){},reset:function(){}};function Qs(Qe){return Qe&Hs?"cancel":Qe&Nr?"end":Qe&zi?"move":Qe&ia?"start":""}function cs(Qe){return Qe==Sr?"down":Qe==qe?"up":Qe==_r?"left":Qe==kt?"right":""}function Ka(Qe,gt){var Gt=gt.manager;return Gt?Gt.get(Qe):Qe}function Do(){Za.apply(this,arguments)}Fe(Do,Za,{defaults:{pointers:1},attrTest:function(Qe){var gt=this.options.pointers;return gt===0||Qe.pointers.length===gt},process:function(Qe){var gt=this.state,Gt=Qe.eventType,Pr=gt&(ia|zi),Tn=this.attrTest(Qe);return Pr&&(Gt&vn||!Tn)?gt|Hs:Pr||Tn?Gt&ln?gt|Nr:gt&ia?gt|zi:ia:Da}});function qa(){Do.apply(this,arguments),this.pX=null,this.pY=null}Fe(qa,Do,{defaults:{event:"pan",threshold:10,pointers:1,direction:vr},getTouchAction:function(){var Qe=this.options.direction,gt=[];return Qe&Pe&&gt.push(Fi),Qe&Hr&&gt.push(sa),gt},directionTest:function(Qe){var gt=this.options,Gt=!0,Pr=Qe.distance,Tn=Qe.direction,di=Qe.deltaX,fa=Qe.deltaY;return Tn&gt.direction||(gt.direction&Pe?(Tn=di===0?$t:di<0?_r:kt,Gt=di!=this.pX,Pr=Math.abs(Qe.deltaX)):(Tn=fa===0?$t:fa<0?qe:Sr,Gt=fa!=this.pY,Pr=Math.abs(Qe.deltaY))),Qe.direction=Tn,Gt&&Pr>gt.threshold&&Tn&gt.direction},attrTest:function(Qe){return Do.prototype.attrTest.call(this,Qe)&&(this.state&ia||!(this.state&ia)&&this.directionTest(Qe))},emit:function(Qe){this.pX=Qe.deltaX,this.pY=Qe.deltaY;var gt=cs(Qe.direction);gt&&(Qe.additionalEvent=this.options.event+gt),this._super.emit.call(this,Qe)}});function Qa(){Do.apply(this,arguments)}Fe(Qa,Do,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Bi]},attrTest:function(Qe){return this._super.attrTest.call(this,Qe)&&(Math.abs(Qe.scale-1)>this.options.threshold||this.state&ia)},emit:function(Qe){if(Qe.scale!==1){var gt=Qe.scale<1?"in":"out";Qe.additionalEvent=this.options.event+gt}this._super.emit.call(this,Qe)}});function Pa(){Za.apply(this,arguments),this._timer=null,this._input=null}Fe(Pa,Za,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wi]},process:function(Qe){var gt=this.options,Gt=Qe.pointers.length===gt.pointers,Pr=Qe.distance<gt.threshold,Tn=Qe.deltaTime>gt.time;if(this._input=Qe,!Pr||!Gt||Qe.eventType&(ln|vn)&&!Tn)this.reset();else if(Qe.eventType&rn)this.reset(),this._timer=ee(function(){this.state=ji,this.tryEmit()},gt.time,this);else if(Qe.eventType&ln)return ji;return Da},reset:function(){clearTimeout(this._timer)},emit:function(Qe){this.state===ji&&(Qe&&Qe.eventType&ln?this.manager.emit(this.options.event+"up",Qe):(this._input.timeStamp=B(),this.manager.emit(this.options.event,this._input)))}});function Na(){Do.apply(this,arguments)}Fe(Na,Do,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Bi]},attrTest:function(Qe){return this._super.attrTest.call(this,Qe)&&(Math.abs(Qe.rotation)>this.options.threshold||this.state&ia)}});function Lo(){Do.apply(this,arguments)}Fe(Lo,Do,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Pe|Hr,pointers:1},getTouchAction:function(){return qa.prototype.getTouchAction.call(this)},attrTest:function(Qe){var gt=this.options.direction,Gt;return gt&(Pe|Hr)?Gt=Qe.overallVelocity:gt&Pe?Gt=Qe.overallVelocityX:gt&Hr&&(Gt=Qe.overallVelocityY),this._super.attrTest.call(this,Qe)&&gt&Qe.offsetDirection&&Qe.distance>this.options.threshold&&Qe.maxPointers==this.options.pointers&&Be(Gt)>this.options.velocity&&Qe.eventType&ln},emit:function(Qe){var gt=cs(Qe.offsetDirection);gt&&this.manager.emit(this.options.event+gt,Qe),this.manager.emit(this.options.event,Qe)}});function ba(){Za.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Fe(ba,Za,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Nn]},process:function(Qe){var gt=this.options,Gt=Qe.pointers.length===gt.pointers,Pr=Qe.distance<gt.threshold,Tn=Qe.deltaTime<gt.time;if(this.reset(),Qe.eventType&rn&&this.count===0)return this.failTimeout();if(Pr&&Tn&&Gt){if(Qe.eventType!=ln)return this.failTimeout();var di=this.pTime?Qe.timeStamp-this.pTime<gt.interval:!0,fa=!this.pCenter||pi(this.pCenter,Qe.center)<gt.posThreshold;this.pTime=Qe.timeStamp,this.pCenter=Qe.center,!fa||!di?this.count=1:this.count+=1,this._input=Qe;var Bo=this.count%gt.taps;if(Bo===0)return this.hasRequireFailures()?(this._timer=ee(function(){this.state=ji,this.tryEmit()},gt.interval,this),ia):ji}return Da},failTimeout:function(){return this._timer=ee(function(){this.state=Da},this.options.interval,this),Da},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ji&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function so(Qe,gt){return gt=gt||{},gt.recognizers=Ze(gt.recognizers,so.defaults.preset),new vo(Qe,gt)}so.VERSION="2.0.7",so.defaults={domEvents:!1,touchAction:xn,enable:!0,inputTarget:null,inputClass:null,preset:[[Na,{enable:!1}],[Qa,{enable:!1},["rotate"]],[Lo,{direction:Pe}],[qa,{direction:Pe},["swipe"]],[ba],[ba,{event:"doubletap",taps:2},["tap"]],[Pa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ao=1,Y=2;function vo(Qe,gt){this.options=j({},so.defaults,gt||{}),this.options.inputTarget=this.options.inputTarget||Qe,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Qe,this.input=Dr(this),this.touchAction=new ei(this,this.options.touchAction),Va(this,!0),q(this.options.recognizers,function(Gt){var Pr=this.add(new Gt[0](Gt[1]));Gt[2]&&Pr.recognizeWith(Gt[2]),Gt[3]&&Pr.requireFailure(Gt[3])},this)}vo.prototype={set:function(Qe){return j(this.options,Qe),Qe.touchAction&&this.touchAction.update(),Qe.inputTarget&&(this.input.destroy(),this.input.target=Qe.inputTarget,this.input.init()),this},stop:function(Qe){this.session.stopped=Qe?Y:Ao},recognize:function(Qe){var gt=this.session;if(!gt.stopped){this.touchAction.preventDefaults(Qe);var Gt,Pr=this.recognizers,Tn=gt.curRecognizer;(!Tn||Tn&&Tn.state&ji)&&(Tn=gt.curRecognizer=null);for(var di=0;di<Pr.length;)Gt=Pr[di],gt.stopped!==Y&&(!Tn||Gt==Tn||Gt.canRecognizeWith(Tn))?Gt.recognize(Qe):Gt.reset(),!Tn&&Gt.state&(ia|zi|Nr)&&(Tn=gt.curRecognizer=Gt),di++}},get:function(Qe){if(Qe instanceof Za)return Qe;for(var gt=this.recognizers,Gt=0;Gt<gt.length;Gt++)if(gt[Gt].options.event==Qe)return gt[Gt];return null},add:function(Qe){if(U(Qe,"add",this))return this;var gt=this.get(Qe.options.event);return gt&&this.remove(gt),this.recognizers.push(Qe),Qe.manager=this,this.touchAction.update(),Qe},remove:function(Qe){if(U(Qe,"remove",this))return this;if(Qe=this.get(Qe),Qe){var gt=this.recognizers,Gt=Rt(gt,Qe);Gt!==-1&&(gt.splice(Gt,1),this.touchAction.update())}return this},on:function(Qe,gt){if(Qe!==P&&gt!==P){var Gt=this.handlers;return q(de(Qe),function(Pr){Gt[Pr]=Gt[Pr]||[],Gt[Pr].push(gt)}),this}},off:function(Qe,gt){if(Qe!==P){var Gt=this.handlers;return q(de(Qe),function(Pr){gt?Gt[Pr]&&Gt[Pr].splice(Rt(Gt[Pr],gt),1):delete Gt[Pr]}),this}},emit:function(Qe,gt){this.options.domEvents&&fs(Qe,gt);var Gt=this.handlers[Qe]&&this.handlers[Qe].slice();if(!(!Gt||!Gt.length)){gt.type=Qe,gt.preventDefault=function(){gt.srcEvent.preventDefault()};for(var Pr=0;Pr<Gt.length;)Gt[Pr](gt),Pr++}},destroy:function(){this.element&&Va(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Va(Qe,gt){var Gt=Qe.element;if(Gt.style){var Pr;q(Qe.options.cssProps,function(Tn,di){Pr=oe(Gt.style,di),gt?(Qe.oldCssProps[Pr]=Gt.style[Pr],Gt.style[Pr]=Tn):Gt.style[Pr]=Qe.oldCssProps[Pr]||""}),gt||(Qe.oldCssProps={})}}function fs(Qe,gt){var Gt=h.createEvent("Event");Gt.initEvent(Qe,!0,!0),Gt.gesture=gt,gt.target.dispatchEvent(Gt)}j(so,{INPUT_START:rn,INPUT_MOVE:Qr,INPUT_END:ln,INPUT_CANCEL:vn,STATE_POSSIBLE:no,STATE_BEGAN:ia,STATE_CHANGED:zi,STATE_ENDED:Nr,STATE_RECOGNIZED:ji,STATE_CANCELLED:Hs,STATE_FAILED:Da,DIRECTION_NONE:$t,DIRECTION_LEFT:_r,DIRECTION_RIGHT:kt,DIRECTION_UP:qe,DIRECTION_DOWN:Sr,DIRECTION_HORIZONTAL:Pe,DIRECTION_VERTICAL:Hr,DIRECTION_ALL:vr,Manager:vo,Input:Wr,TouchAction:ei,TouchInput:vt,MouseInput:xt,PointerEventInput:Q,TouchMouseInput:$r,SingleTouchInput:ft,Recognizer:Za,AttrRecognizer:Do,Tap:ba,Pan:qa,Swipe:Lo,Pinch:Qa,Rotate:Na,Press:Pa,on:pe,off:se,each:q,merge:$e,extend:Ce,assign:j,inherit:Fe,bindFn:lt,prefixed:oe});var Eo=typeof z!="undefined"?z:typeof self!="undefined"?self:{};Eo.Hammer=so,F=function(){return so}.call(w,x,w,He),F!==P&&(He.exports=F)})(window,document,"Hammer")},47443:function(He,w,x){var F=x(42118);function z(h,D){var P=h==null?0:h.length;return!!P&&F(h,D,0)>-1}He.exports=z},1196:function(He){function w(x,F,z){for(var h=-1,D=x==null?0:x.length;++h<D;)if(z(F,x[h]))return!0;return!1}He.exports=w},29750:function(He){function w(x,F,z){return x===x&&(z!==void 0&&(x=x<=z?x:z),F!==void 0&&(x=x>=F?x:F)),x}He.exports=w},41848:function(He){function w(x,F,z,h){for(var D=x.length,P=z+(h?1:-1);h?P--:++P<D;)if(F(x[P],P,x))return P;return-1}He.exports=w},42118:function(He,w,x){var F=x(41848),z=x(62722),h=x(39375);function D(P,X,W){return X===X?h(P,X,W):F(P,z,W)}He.exports=D},74221:function(He){function w(x,F,z,h){for(var D=z-1,P=x.length;++D<P;)if(h(x[D],F))return D;return-1}He.exports=w},62722:function(He){function w(x){return x!==x}He.exports=w},65464:function(He,w,x){var F=x(29932),z=x(42118),h=x(74221),D=x(51717),P=x(6450),X=Array.prototype,W=X.splice;function fe(J,Be,B,ee){var U=ee?h:z,q=-1,le=Be.length,j=J;for(J===Be&&(Be=P(Be)),B&&(j=F(J,D(B)));++q<le;)for(var Ce=0,$e=Be[q],Fe=B?B($e):$e;(Ce=U(j,Fe,Ce,ee))>-1;)j!==J&&W.call(j,Ce,1),W.call(J,Ce,1);return J}He.exports=fe},45652:function(He,w,x){var F=x(88668),z=x(47443),h=x(1196),D=x(74757),P=x(23593),X=x(21814),W=200;function fe(J,Be,B){var ee=-1,U=z,q=J.length,le=!0,j=[],Ce=j;if(B)le=!1,U=h;else if(q>=W){var $e=Be?null:P(J);if($e)return X($e);le=!1,U=D,Ce=new F}else Ce=Be?[]:j;e:for(;++ee<q;){var Fe=J[ee],lt=Be?Be(Fe):Fe;if(Fe=B||Fe!==0?Fe:0,le&&lt===lt){for(var We=Ce.length;We--;)if(Ce[We]===lt)continue e;Be&&Ce.push(lt),j.push(Fe)}else U(Ce,lt,B)||(Ce!==j&&Ce.push(lt),j.push(Fe))}return j}He.exports=fe},23593:function(He,w,x){var F=x(58525),z=x(28117),h=x(21814),D=1/0,P=F&&1/h(new F([,-0]))[1]==D?function(X){return new F(X)}:z;He.exports=P},39375:function(He){function w(x,F,z){for(var h=z-1,D=x.length;++h<D;)if(x[h]===F)return h;return-1}He.exports=w},74691:function(He,w,x){var F=x(29750),z=x(14841);function h(D,P,X){return X===void 0&&(X=P,P=void 0),X!==void 0&&(X=z(X),X=X===X?X:0),P!==void 0&&(P=z(P),P=P===P?P:0),F(z(D),P,X)}He.exports=h},51584:function(He,w,x){var F=x(44239),z=x(37005),h="[object Boolean]";function D(P){return P===!0||P===!1||z(P)&&F(P)==h}He.exports=D},18446:function(He,w,x){var F=x(90939);function z(h,D){return F(h,D)}He.exports=z},14293:function(He){function w(x){return x==null}He.exports=w},81763:function(He,w,x){var F=x(44239),z=x(37005),h="[object Number]";function D(P){return typeof P=="number"||z(P)&&F(P)==h}He.exports=D},52353:function(He){function w(x){return x===void 0}He.exports=w},30236:function(He,w,x){var F=x(42980),z=x(21463),h=z(function(D,P,X,W){F(D,P,X,W)});He.exports=h},28117:function(He){function w(){}He.exports=w},97019:function(He,w,x){var F=x(5976),z=x(45604),h=F(z);He.exports=h},45604:function(He,w,x){var F=x(65464);function z(h,D){return h&&h.length&&D&&D.length?F(h,D):h}He.exports=z},44908:function(He,w,x){var F=x(45652);function z(h){return h&&h.length?F(h):[]}He.exports=z},6158:function(He){(function(w,x){He.exports=x()})(this,function(){"use strict";var w,x,F;function z(h,D){if(!w)w=D;else if(!x)x=D;else{var P="var sharedChunk = {}; ("+w+")(sharedChunk); ("+x+")(sharedChunk);",X={};w(X),F=D(X),typeof window!="undefined"&&(F.workerUrl=window.URL.createObjectURL(new Blob([P],{type:"text/javascript"})))}}return z(["exports"],function(h){"use strict";function D(t,o){return t(o={exports:{}},o.exports),o.exports}var P=X;function X(t,o,u,v){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=v,this.p2x=u,this.p2y=v}X.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},X.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},X.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},X.prototype.solveCurveX=function(t,o){var u,v,y,b,T;for(o===void 0&&(o=1e-6),y=t,T=0;T<8;T++){if(b=this.sampleCurveX(y)-t,Math.abs(b)<o)return y;var I=this.sampleCurveDerivativeX(y);if(Math.abs(I)<1e-6)break;y-=b/I}if((y=t)<(u=0))return u;if(y>(v=1))return v;for(;u<v;){if(b=this.sampleCurveX(y),Math.abs(b-t)<o)return y;t>b?u=y:v=y,y=.5*(v-u)+u}return y},X.prototype.solve=function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))};var W=fe;function fe(t,o){this.x=t,this.y=o}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,o){return this.clone()._rotateAround(t,o)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var o=t.x-this.x,u=t.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,o){return Math.atan2(this.x*o-this.y*t,this.x*t+this.y*o)},_matMult:function(t){var o=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=o,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var o=Math.cos(t),u=Math.sin(t),v=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=v,this},_rotateAround:function(t,o){var u=Math.cos(t),v=Math.sin(t),y=o.y+v*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-v*(this.y-o.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(t){return t instanceof fe?t:Array.isArray(t)?new fe(t[0],t[1]):t};var J=typeof self!="undefined"?self:{},Be=Math.pow(2,53)-1;function B(t,o,u,v){var y=new P(t,o,u,v);return function(b){return y.solve(b)}}var ee=B(.25,.1,.25,1);function U(t,o,u){return Math.min(u,Math.max(o,t))}function q(t,o,u){var v=u-o,y=((t-o)%v+v)%v+o;return y===o?u:y}function le(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,y=o;v<y.length;v+=1){var b=y[v];for(var T in b)t[T]=b[T]}return t}var j=1;function Ce(){return j++}function $e(){return function t(o){return o?(o^16*Math.random()>>o/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Fe(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function lt(t,o){t.forEach(function(u){o[u]&&(o[u]=o[u].bind(o))})}function We(t,o){return t.indexOf(o,t.length-o.length)!==-1}function Ze(t,o,u){var v={};for(var y in t)v[y]=o.call(u||this,t[y],y,t);return v}function pe(t,o,u){var v={};for(var y in t)o.call(u||this,t[y],y,t)&&(v[y]=t[y]);return v}function se(t){return Array.isArray(t)?t.map(se):typeof t=="object"&&t?Ze(t,se):t}var be={};function Te(t){be[t]||(typeof console!="undefined"&&console.warn(t),be[t]=!0)}function de(t,o,u){return(u.y-t.y)*(o.x-t.x)>(o.y-t.y)*(u.x-t.x)}function Rt(t){for(var o=0,u=0,v=t.length,y=v-1,b=void 0,T=void 0;u<v;y=u++)o+=((T=t[y]).x-(b=t[u]).x)*(b.y+T.y);return o}function ye(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Ve(t){var o={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(v,y,b,T){var I=b||T;return o[y]=!I||I.toLowerCase(),""}),o["max-age"]){var u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}var oe=null;function Re(t){if(oe==null){var o=t.navigator?t.navigator.userAgent:null;oe=!!t.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return oe}function Se(t){try{var o=J[t];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var et,st,pt,bt,ke=J.performance&&J.performance.now?J.performance.now.bind(J.performance):Date.now.bind(Date),ur=J.requestAnimationFrame||J.mozRequestAnimationFrame||J.webkitRequestAnimationFrame||J.msRequestAnimationFrame,qt=J.cancelAnimationFrame||J.mozCancelAnimationFrame||J.webkitCancelAnimationFrame||J.msCancelAnimationFrame,_n={now:ke,frame:function(t){var o=ur(t);return{cancel:function(){return qt(o)}}},getImageData:function(t,o){o===void 0&&(o=0);var u=J.document.createElement("canvas"),v=u.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,v.drawImage(t,0,0,t.width,t.height),v.getImageData(-o,-o,t.width+2*o,t.height+2*o)},resolveURL:function(t){return et||(et=J.document.createElement("a")),et.href=t,et.href},hardwareConcurrency:J.navigator&&J.navigator.hardwareConcurrency||4,get devicePixelRatio(){return J.devicePixelRatio},get prefersReducedMotion(){return!!J.matchMedia&&(st==null&&(st=J.matchMedia("(prefers-reduced-motion: reduce)")),st.matches)}},Zr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Vr={supported:!1,testSupport:function(t){!rn&&bt&&(Qr?ln(t):pt=t)}},rn=!1,Qr=!1;function ln(t){var o=t.createTexture();t.bindTexture(t.TEXTURE_2D,o);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,bt),t.isContextLost())return;Vr.supported=!0}catch(u){}t.deleteTexture(o),rn=!0}J.document&&((bt=J.document.createElement("img")).onload=function(){pt&&ln(pt),pt=null,Qr=!0},bt.onerror=function(){rn=!0,pt=null},bt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var vn="01",$t=function(t,o){this._transformRequestFn=t,this._customAccessToken=o,this._createSkuToken()};function _r(t){return t.indexOf("mapbox:")===0}$t.prototype._createSkuToken=function(){var t=function(){for(var o="",u=0;u<10;u++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",vn,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},$t.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},$t.prototype.transformRequest=function(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}},$t.prototype.normalizeStyleURL=function(t,o){if(!_r(t))return t;var u=Pe(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},$t.prototype.normalizeGlyphsURL=function(t,o){if(!_r(t))return t;var u=Pe(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},$t.prototype.normalizeSourceURL=function(t,o){if(!_r(t))return t;var u=Pe(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||o)},$t.prototype.normalizeSpriteURL=function(t,o,u,v){var y=Pe(t);return _r(t)?(y.path="/styles/v1"+y.path+"/sprite"+o+u,this._makeAPIURL(y,this._customAccessToken||v)):(y.path+=""+o+u,Hr(y))},$t.prototype.normalizeTileURL=function(t,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!_r(t))return t;var u=Pe(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(_n.devicePixelRatio>=2||o===512?"@2x":"")+(Vr.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var v=this._customAccessToken||function(y){for(var b=0,T=y;b<T.length;b+=1){var I=T[b].match(/^access_token=(.*)$/);if(I)return I[1]}return null}(u.params)||Zr.ACCESS_TOKEN;return Zr.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,v)},$t.prototype.canonicalizeTileURL=function(t,o){var u=Pe(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var v="mapbox://tiles/";v+=u.path.replace("/v4/","");var y=u.params;return o&&(y=y.filter(function(b){return!b.match(/^access_token=/)})),y.length&&(v+="?"+y.join("&")),v},$t.prototype.canonicalizeTileset=function(t,o){for(var u=!!o&&_r(o),v=[],y=0,b=t.tiles||[];y<b.length;y+=1){var T=b[y];qe(T)?v.push(this.canonicalizeTileURL(T,u)):v.push(T)}return v},$t.prototype._makeAPIURL=function(t,o){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",v=Pe(Zr.API_URL);if(t.protocol=v.protocol,t.authority=v.authority,t.protocol==="http"){var y=t.params.indexOf("secure");y>=0&&t.params.splice(y,1)}if(v.path!=="/"&&(t.path=""+v.path+t.path),!Zr.REQUIRE_ACCESS_TOKEN)return Hr(t);if(!(o=o||Zr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if(o[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(b){return b.indexOf("access_token")===-1}),t.params.push("access_token="+o),Hr(t)};var kt=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function qe(t){return kt.test(t)}var Sr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(t){var o=t.match(Sr);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Hr(t){var o=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+o}function vr(t){if(!t)return null;var o=t.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(J.atob(o[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var Ie=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ie.prototype.getStorageKey=function(t){var o,u=vr(Zr.ACCESS_TOKEN);return o=u&&u.u?J.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(v,y){return String.fromCharCode(+("0x"+y))})):Zr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+o:"mapbox.eventData:"+o},Ie.prototype.fetchEventData=function(){var t=Se("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var v=J.localStorage.getItem(o);v&&(this.eventData=JSON.parse(v));var y=J.localStorage.getItem(u);y&&(this.anonId=y)}catch(b){Te("Unable to read from LocalStorage")}},Ie.prototype.saveEventData=function(){var t=Se("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{J.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&J.localStorage.setItem(o,JSON.stringify(this.eventData))}catch(v){Te("Unable to write to LocalStorage")}},Ie.prototype.processRequests=function(t){},Ie.prototype.postEvent=function(t,o,u,v){var y=this;if(Zr.EVENTS_URL){var b=Pe(Zr.EVENTS_URL);b.params.push("access_token="+(v||Zr.ACCESS_TOKEN||""));var T={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:vn,userId:this.anonId},I=o?le(T,o):T,Z={url:Hr(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=Ft(Z,function(he){y.pendingRequest=null,u(he),y.saveEventData(),y.processRequests(v)})}},Ie.prototype.queueRequest=function(t,o){this.queue.push(t),this.processRequests(o)};var gr,Wr,Dr=function(t){function o(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.postMapLoadEvent=function(u,v,y,b){this.skuToken=y;var T=!(!b&&!Zr.ACCESS_TOKEN),I=Array.isArray(u)&&u.some(function(Z){return _r(Z)||qe(Z)});Zr.EVENTS_URL&&T&&I&&this.queueRequest({id:v,timestamp:Date.now()},b)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){var y=this.queue.shift(),b=y.id,T=y.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),Fe(this.anonId)||(this.anonId=$e()),this.postEvent(T,{skuToken:this.skuToken},function(I){I||b&&(v.success[b]=!0)},u))}},o}(Ie),Xr=new(function(t){function o(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.postTurnstileEvent=function(u,v){Zr.EVENTS_URL&&Zr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return _r(y)||qe(y)})&&this.queueRequest(Date.now(),v)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=vr(Zr.ACCESS_TOKEN),b=y?y.u:Zr.ACCESS_TOKEN,T=b!==this.eventData.tokenU;Fe(this.anonId)||(this.anonId=$e(),T=!0);var I=this.queue.shift();if(this.eventData.lastSuccess){var Z=new Date(this.eventData.lastSuccess),he=new Date(I),_e=(I-this.eventData.lastSuccess)/864e5;T=T||_e>=1||_e<-1||Z.getDate()!==he.getDate()}else T=!0;if(!T)return this.processRequests();this.postEvent(I,{"enabled.telemetry":!1},function(Ae){Ae||(v.eventData.lastSuccess=I,v.eventData.tokenU=b)},u)}},o}(Ie)),Vn=Xr.postTurnstileEvent.bind(Xr),ni=new Dr,Dn=ni.postMapLoadEvent.bind(ni),Jn=500,Yi=50;function bi(){J.caches&&!gr&&(gr=J.caches.open("mapbox-tiles"))}function ui(t){var o=t.indexOf("?");return o<0?t:t.slice(0,o)}var pi,it=1/0;function V(){return pi==null&&(pi=J.OffscreenCanvas&&new J.OffscreenCanvas(1,1).getContext("2d")&&typeof J.createImageBitmap=="function"),pi}var H={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(H);var Ee=function(t){function o(u,v,y){v===401&&qe(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=v,this.url=y,this.name=this.constructor.name,this.message=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},o}(Error),Le=ye()?function(){return self.worker&&self.worker.referrer}:function(){return(J.location.protocol==="blob:"?J.parent:J).location.href},ze,xt,Ut=function(t,o){if(!(/^file:/.test(u=t.url)||/^file:/.test(Le())&&!/^\w+:/.test(u))){if(J.fetch&&J.Request&&J.AbortController&&J.Request.prototype.hasOwnProperty("signal"))return function(v,y){var b,T=new J.AbortController,I=new J.Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,referrer:Le(),signal:T.signal}),Z=!1,he=!1,_e=(b=I.url).indexOf("sku=")>0&&qe(b);v.type==="json"&&I.headers.set("Accept","application/json");var Ae=function(Je,Tt,wt){if(!he){if(Je&&Je.message!=="SecurityError"&&Te(Je),Tt&&wt)return je(Tt);var Wt=Date.now();J.fetch(I).then(function(zt){if(zt.ok){var or=_e?zt.clone():null;return je(zt,or,Wt)}return y(new Ee(zt.statusText,zt.status,v.url))}).catch(function(zt){zt.code!==20&&y(new Error(zt.message))})}},je=function(Je,Tt,wt){(v.type==="arrayBuffer"?Je.arrayBuffer():v.type==="json"?Je.json():Je.text()).then(function(Wt){he||(Tt&&wt&&function(zt,or,dr){if(bi(),gr){var Ar={status:or.status,statusText:or.statusText,headers:new J.Headers};or.headers.forEach(function(en,kn){return Ar.headers.set(kn,en)});var kr=Ve(or.headers.get("Cache-Control")||"");kr["no-store"]||(kr["max-age"]&&Ar.headers.set("Expires",new Date(dr+1e3*kr["max-age"]).toUTCString()),new Date(Ar.headers.get("Expires")).getTime()-dr<42e4||function(en,kn){if(Wr===void 0)try{new Response(new ReadableStream),Wr=!0}catch(Hn){Wr=!1}Wr?kn(en.body):en.blob().then(kn)}(or,function(en){var kn=new J.Response(en,Ar);bi(),gr&&gr.then(function(Hn){return Hn.put(ui(zt.url),kn)}).catch(function(Hn){return Te(Hn.message)})}))}}(I,Tt,wt),Z=!0,y(null,Wt,Je.headers.get("Cache-Control"),Je.headers.get("Expires")))}).catch(function(Wt){he||y(new Error(Wt.message))})};return _e?function(Je,Tt){if(bi(),!gr)return Tt(null);var wt=ui(Je.url);gr.then(function(Wt){Wt.match(wt).then(function(zt){var or=function(dr){if(!dr)return!1;var Ar=new Date(dr.headers.get("Expires")||0),kr=Ve(dr.headers.get("Cache-Control")||"");return Ar>Date.now()&&!kr["no-cache"]}(zt);Wt.delete(wt),or&&Wt.put(wt,zt.clone()),Tt(null,zt,or)}).catch(Tt)}).catch(Tt)}(I,Ae):Ae(null,null),{cancel:function(){he=!0,Z||T.abort()}}}(t,o);if(ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,o,void 0,!0)}var u;return function(v,y){var b=new J.XMLHttpRequest;for(var T in b.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(b.responseType="arraybuffer"),v.headers)b.setRequestHeader(T,v.headers[T]);return v.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=v.credentials==="include",b.onerror=function(){y(new Error(b.statusText))},b.onload=function(){if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){var I=b.response;if(v.type==="json")try{I=JSON.parse(b.response)}catch(Z){return y(Z)}y(null,I,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else y(new Ee(b.statusText,b.status,v.url))},b.send(v.body),{cancel:function(){return b.abort()}}}(t,o)},ir=function(t,o){return Ut(le(t,{type:"arrayBuffer"}),o)},Ft=function(t,o){return Ut(le(t,{method:"POST"}),o)},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ze=[],xt=0;var Q=function(t,o){if(Vr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),xt>=Zr.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:o,cancelled:!1,cancel:function(){this.cancelled=!0}};return ze.push(u),u}xt++;var v=!1,y=function(){if(!v)for(v=!0,xt--;ze.length&&xt<Zr.MAX_PARALLEL_IMAGE_REQUESTS;){var T=ze.shift();T.cancelled||(T.cancel=Q(T.requestParameters,T.callback).cancel)}},b=ir(t,function(T,I,Z,he){y(),T?o(T):I&&(V()?function(_e,Ae){var je=new J.Blob([new Uint8Array(_e)],{type:"image/png"});J.createImageBitmap(je).then(function(Je){Ae(null,Je)}).catch(function(Je){Ae(new Error("Could not load image because of "+Je.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(I,o):function(_e,Ae,je,Je){var Tt=new J.Image,wt=J.URL;Tt.onload=function(){Ae(null,Tt),wt.revokeObjectURL(Tt.src),Tt.onload=null,J.requestAnimationFrame(function(){Tt.src=te})},Tt.onerror=function(){return Ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Wt=new J.Blob([new Uint8Array(_e)],{type:"image/png"});Tt.cacheControl=je,Tt.expires=Je,Tt.src=_e.byteLength?wt.createObjectURL(Wt):te}(I,o,Z,he))});return{cancel:function(){b.cancel(),y()}}};function ve(t,o,u){u[t]&&u[t].indexOf(o)!==-1||(u[t]=u[t]||[],u[t].push(o))}function Oe(t,o,u){if(u&&u[t]){var v=u[t].indexOf(o);v!==-1&&u[t].splice(v,1)}}var Xe=function(t,o){o===void 0&&(o={}),le(this,o),this.type=t},ft=function(t){function o(u,v){v===void 0&&(v={}),t.call(this,"error",le({error:u},v))}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Xe),Et=function(){};Et.prototype.on=function(t,o){return this._listeners=this._listeners||{},ve(t,o,this._listeners),this},Et.prototype.off=function(t,o){return Oe(t,o,this._listeners),Oe(t,o,this._oneTimeListeners),this},Et.prototype.once=function(t,o){return this._oneTimeListeners=this._oneTimeListeners||{},ve(t,o,this._oneTimeListeners),this},Et.prototype.fire=function(t,o){typeof t=="string"&&(t=new Xe(t,o||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var v=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];v<y.length;v+=1)y[v].call(this,t);for(var b=0,T=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];b<T.length;b+=1){var I=T[b];Oe(u,I,this._oneTimeListeners),I.call(this,t)}var Z=this._eventedParent;Z&&(le(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Z.fire(t))}else t instanceof ft&&console.error(t.error);return this},Et.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Et.prototype.setEventedParent=function(t,o){return this._eventedParent=t,this._eventedParentData=o,this};var Ne={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ue=function(t,o,u,v){this.message=(t?t+": ":"")+u,v&&(this.identifier=v),o!=null&&o.__line__&&(this.line=o.__line__)};function vt(t){var o=t.value;return o?[new Ue(t.key,o,"constants have been deprecated as of v8")]:[]}function ue(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,y=o;v<y.length;v+=1){var b=y[v];for(var T in b)t[T]=b[T]}return t}function Lr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function lr(t){if(Array.isArray(t))return t.map(lr);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var o={};for(var u in t)o[u]=lr(t[u]);return o}return Lr(t)}var $r=function(t){function o(u,v){t.call(this,v),this.message=v,this.key=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Error),Rn=function(t,o){o===void 0&&(o=[]),this.parent=t,this.bindings={};for(var u=0,v=o;u<v.length;u+=1){var y=v[u];this.bindings[y[0]]=y[1]}};Rn.prototype.concat=function(t){return new Rn(this,t)},Rn.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Rn.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var nn={kind:"null"},xr={kind:"number"},Or={kind:"string"},sn={kind:"boolean"},xn={kind:"color"},wi={kind:"object"},Nn={kind:"value"},Bi={kind:"collator"},sa={kind:"formatted"},Fi={kind:"resolvedImage"};function bn(t,o){return{kind:"array",itemType:t,N:o}}function ei(t){if(t.kind==="array"){var o=ei(t.itemType);return typeof t.N=="number"?"array<"+o+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+o+">"}return t.kind}var ga=[nn,xr,Or,sn,xn,sa,wi,bn(Nn),Fi];function ua(t,o){if(o.kind==="error")return null;if(t.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!ua(t.itemType,o.itemType))&&(typeof t.N!="number"||t.N===o.N))return null}else{if(t.kind===o.kind)return null;if(t.kind==="value"){for(var u=0,v=ga;u<v.length;u+=1)if(!ua(v[u],o))return null}}return"Expected "+ei(t)+" but found "+ei(o)+" instead."}function no(t,o){return o.some(function(u){return u.kind===t.kind})}function ia(t,o){return o.some(function(u){return u==="null"?t===null:u==="array"?Array.isArray(t):u==="object"?t&&!Array.isArray(t)&&typeof t=="object":u===typeof t})}var zi=D(function(t,o){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function v(I){return(I=Math.round(I))<0?0:I>255?255:I}function y(I){return v(I[I.length-1]==="%"?parseFloat(I)/100*255:parseInt(I))}function b(I){return(Z=I[I.length-1]==="%"?parseFloat(I)/100:parseFloat(I))<0?0:Z>1?1:Z;var Z}function T(I,Z,he){return he<0?he+=1:he>1&&(he-=1),6*he<1?I+(Z-I)*he*6:2*he<1?Z:3*he<2?I+(Z-I)*(2/3-he)*6:I}try{o.parseCSSColor=function(I){var Z,he=I.replace(/ /g,"").toLowerCase();if(he in u)return u[he].slice();if(he[0]==="#")return he.length===4?(Z=parseInt(he.substr(1),16))>=0&&Z<=4095?[(3840&Z)>>4|(3840&Z)>>8,240&Z|(240&Z)>>4,15&Z|(15&Z)<<4,1]:null:he.length===7&&(Z=parseInt(he.substr(1),16))>=0&&Z<=16777215?[(16711680&Z)>>16,(65280&Z)>>8,255&Z,1]:null;var _e=he.indexOf("("),Ae=he.indexOf(")");if(_e!==-1&&Ae+1===he.length){var je=he.substr(0,_e),Je=he.substr(_e+1,Ae-(_e+1)).split(","),Tt=1;switch(je){case"rgba":if(Je.length!==4)return null;Tt=b(Je.pop());case"rgb":return Je.length!==3?null:[y(Je[0]),y(Je[1]),y(Je[2]),Tt];case"hsla":if(Je.length!==4)return null;Tt=b(Je.pop());case"hsl":if(Je.length!==3)return null;var wt=(parseFloat(Je[0])%360+360)%360/360,Wt=b(Je[1]),zt=b(Je[2]),or=zt<=.5?zt*(Wt+1):zt+Wt-zt*Wt,dr=2*zt-or;return[v(255*T(dr,or,wt+1/3)),v(255*T(dr,or,wt)),v(255*T(dr,or,wt-1/3)),Tt];default:return null}}return null}}catch(I){}}).parseCSSColor,Nr=function(t,o,u,v){v===void 0&&(v=1),this.r=t,this.g=o,this.b=u,this.a=v};Nr.parse=function(t){if(t){if(t instanceof Nr)return t;if(typeof t=="string"){var o=zi(t);if(o)return new Nr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3])}}},Nr.prototype.toString=function(){var t=this.toArray(),o=t[1],u=t[2],v=t[3];return"rgba("+Math.round(t[0])+","+Math.round(o)+","+Math.round(u)+","+v+")"},Nr.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Nr.black=new Nr(0,0,0,1),Nr.white=new Nr(1,1,1,1),Nr.transparent=new Nr(0,0,0,0),Nr.red=new Nr(1,0,0,1);var ji=function(t,o,u){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ji.prototype.compare=function(t,o){return this.collator.compare(t,o)},ji.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Hs=function(t,o,u,v,y){this.text=t,this.image=o,this.scale=u,this.fontStack=v,this.textColor=y},Da=function(t){this.sections=t};Da.fromString=function(t){return new Da([new Hs(t,null,null,null,null)])},Da.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},Da.factory=function(t){return t instanceof Da?t:Da.fromString(t)},Da.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},Da.prototype.serialize=function(){for(var t=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];if(v.image)t.push(["image",v.image.name]);else{t.push(v.text);var y={};v.fontStack&&(y["text-font"]=["literal",v.fontStack.split(",")]),v.scale&&(y["font-scale"]=v.scale),v.textColor&&(y["text-color"]=["rgba"].concat(v.textColor.toArray())),t.push(y)}}return t};var Za=function(t){this.name=t.name,this.available=t.available};function Qs(t,o,u,v){return typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:"Invalid rgba value ["+[t,o,u,v].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof v=="number"?[t,o,u,v]:[t,o,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function cs(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Nr||t instanceof ji||t instanceof Da||t instanceof Za)return!0;if(Array.isArray(t)){for(var o=0,u=t;o<u.length;o+=1)if(!cs(u[o]))return!1;return!0}if(typeof t=="object"){for(var v in t)if(!cs(t[v]))return!1;return!0}return!1}function Ka(t){if(t===null)return nn;if(typeof t=="string")return Or;if(typeof t=="boolean")return sn;if(typeof t=="number")return xr;if(t instanceof Nr)return xn;if(t instanceof ji)return Bi;if(t instanceof Da)return sa;if(t instanceof Za)return Fi;if(Array.isArray(t)){for(var o,u=t.length,v=0,y=t;v<y.length;v+=1){var b=Ka(y[v]);if(o){if(o===b)continue;o=Nn;break}o=b}return bn(o||Nn,u)}return wi}function Do(t){var o=typeof t;return t===null?"":o==="string"||o==="number"||o==="boolean"?String(t):t instanceof Nr||t instanceof Da||t instanceof Za?t.toString():JSON.stringify(t)}Za.prototype.toString=function(){return this.name},Za.fromString=function(t){return t?new Za({name:t,available:!1}):null},Za.prototype.serialize=function(){return["image",this.name]};var qa=function(t,o){this.type=t,this.value=o};qa.parse=function(t,o){if(t.length!==2)return o.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!cs(t[1]))return o.error("invalid value");var u=t[1],v=Ka(u),y=o.expectedType;return v.kind!=="array"||v.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(v=y),new qa(v,u)},qa.prototype.evaluate=function(){return this.value},qa.prototype.eachChild=function(){},qa.prototype.outputDefined=function(){return!0},qa.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Nr?["rgba"].concat(this.value.toArray()):this.value instanceof Da?this.value.serialize():this.value};var Qa=function(t){this.name="ExpressionEvaluationError",this.message=t};Qa.prototype.toJSON=function(){return this.message};var Pa={string:Or,number:xr,boolean:sn,object:wi},Na=function(t,o){this.type=t,this.args=o};Na.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u,v=1,y=t[0];if(y==="array"){var b,T;if(t.length>2){var I=t[1];if(typeof I!="string"||!(I in Pa)||I==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Pa[I],v++}else b=Nn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=t[2],v++}u=bn(b,T)}else u=Pa[y];for(var Z=[];v<t.length;v++){var he=o.parse(t[v],v,Nn);if(!he)return null;Z.push(he)}return new Na(u,Z)},Na.prototype.evaluate=function(t){for(var o=0;o<this.args.length;o++){var u=this.args[o].evaluate(t);if(!ua(this.type,Ka(u)))return u;if(o===this.args.length-1)throw new Qa("Expected value to be of type "+ei(this.type)+", but found "+ei(Ka(u))+" instead.")}return null},Na.prototype.eachChild=function(t){this.args.forEach(t)},Na.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Na.prototype.serialize=function(){var t=this.type,o=[t.kind];if(t.kind==="array"){var u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);var v=t.N;(typeof v=="number"||this.args.length>1)&&o.push(v)}}return o.concat(this.args.map(function(y){return y.serialize()}))};var Lo=function(t){this.type=sa,this.sections=t};Lo.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");for(var v=[],y=!1,b=1;b<=t.length-1;++b){var T=t[b];if(y&&typeof T=="object"&&!Array.isArray(T)){y=!1;var I=null;if(T["font-scale"]&&!(I=o.parse(T["font-scale"],1,xr)))return null;var Z=null;if(T["text-font"]&&!(Z=o.parse(T["text-font"],1,bn(Or))))return null;var he=null;if(T["text-color"]&&!(he=o.parse(T["text-color"],1,xn)))return null;var _e=v[v.length-1];_e.scale=I,_e.font=Z,_e.textColor=he}else{var Ae=o.parse(t[b],1,Nn);if(!Ae)return null;var je=Ae.type.kind;if(je!=="string"&&je!=="value"&&je!=="null"&&je!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,v.push({content:Ae,scale:null,font:null,textColor:null})}}return new Lo(v)},Lo.prototype.evaluate=function(t){return new Da(this.sections.map(function(o){var u=o.content.evaluate(t);return Ka(u)===Fi?new Hs("",u,null,null,null):new Hs(Do(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))},Lo.prototype.eachChild=function(t){for(var o=0,u=this.sections;o<u.length;o+=1){var v=u[o];t(v.content),v.scale&&t(v.scale),v.font&&t(v.font),v.textColor&&t(v.textColor)}},Lo.prototype.outputDefined=function(){return!1},Lo.prototype.serialize=function(){for(var t=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];t.push(v.content.serialize());var y={};v.scale&&(y["font-scale"]=v.scale.serialize()),v.font&&(y["text-font"]=v.font.serialize()),v.textColor&&(y["text-color"]=v.textColor.serialize()),t.push(y)}return t};var ba=function(t){this.type=Fi,this.input=t};ba.parse=function(t,o){if(t.length!==2)return o.error("Expected two arguments.");var u=o.parse(t[1],1,Or);return u?new ba(u):o.error("No image name provided.")},ba.prototype.evaluate=function(t){var o=this.input.evaluate(t),u=Za.fromString(o);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(o)>-1),u},ba.prototype.eachChild=function(t){t(this.input)},ba.prototype.outputDefined=function(){return!1},ba.prototype.serialize=function(){return["image",this.input.serialize()]};var so={"to-boolean":sn,"to-color":xn,"to-number":xr,"to-string":Or},Ao=function(t,o){this.type=t,this.args=o};Ao.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u=t[0];if((u==="to-boolean"||u==="to-string")&&t.length!==2)return o.error("Expected one argument.");for(var v=so[u],y=[],b=1;b<t.length;b++){var T=o.parse(t[b],b,Nn);if(!T)return null;y.push(T)}return new Ao(v,y)},Ao.prototype.evaluate=function(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){for(var o,u,v=0,y=this.args;v<y.length;v+=1){if(u=null,(o=y[v].evaluate(t))instanceof Nr)return o;if(typeof o=="string"){var b=t.parseColor(o);if(b)return b}else if(Array.isArray(o)&&!(u=o.length<3||o.length>4?"Invalid rbga value "+JSON.stringify(o)+": expected an array containing either three or four numeric values.":Qs(o[0],o[1],o[2],o[3])))return new Nr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Qa(u||"Could not parse color from value '"+(typeof o=="string"?o:String(JSON.stringify(o)))+"'")}if(this.type.kind==="number"){for(var T=null,I=0,Z=this.args;I<Z.length;I+=1){if((T=Z[I].evaluate(t))===null)return 0;var he=Number(T);if(!isNaN(he))return he}throw new Qa("Could not convert "+JSON.stringify(T)+" to number.")}return this.type.kind==="formatted"?Da.fromString(Do(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Za.fromString(Do(this.args[0].evaluate(t))):Do(this.args[0].evaluate(t))},Ao.prototype.eachChild=function(t){this.args.forEach(t)},Ao.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Ao.prototype.serialize=function(){if(this.type.kind==="formatted")return new Lo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ba(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(o){t.push(o.serialize())}),t};var Y=["Unknown","Point","LineString","Polygon"],vo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};vo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},vo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Y[this.feature.type]:this.feature.type:null},vo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},vo.prototype.canonicalID=function(){return this.canonical},vo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},vo.prototype.parseColor=function(t){var o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Nr.parse(t)),o};var Va=function(t,o,u,v){this.name=t,this.type=o,this._evaluate=u,this.args=v};Va.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Va.prototype.eachChild=function(t){this.args.forEach(t)},Va.prototype.outputDefined=function(){return!1},Va.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Va.parse=function(t,o){var u,v=t[0],y=Va.definitions[v];if(!y)return o.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(y)?y[0]:y.type,T=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,I=T.filter(function(Li){var si=Li[0];return!Array.isArray(si)||si.length===t.length-1}),Z=null,he=0,_e=I;he<_e.length;he+=1){var Ae=_e[he],je=Ae[0],Je=Ae[1];Z=new al(o.registry,o.path,null,o.scope);for(var Tt=[],wt=!1,Wt=1;Wt<t.length;Wt++){var zt=t[Wt],or=Array.isArray(je)?je[Wt-1]:je.type,dr=Z.parse(zt,1+Tt.length,or);if(!dr){wt=!0;break}Tt.push(dr)}if(!wt)if(Array.isArray(je)&&je.length!==Tt.length)Z.error("Expected "+je.length+" arguments, but found "+Tt.length+" instead.");else{for(var Ar=0;Ar<Tt.length;Ar++){var kr=Array.isArray(je)?je[Ar]:je.type,en=Tt[Ar];Z.concat(Ar+1).checkSubtype(kr,en.type)}if(Z.errors.length===0)return new Va(v,b,Je,Tt)}}if(I.length===1)(u=o.errors).push.apply(u,Z.errors);else{for(var kn=(I.length?I:T).map(function(Li){var si;return si=Li[0],Array.isArray(si)?"("+si.map(ei).join(", ")+")":"("+ei(si.type)+"...)"}).join(" | "),Hn=[],Ci=1;Ci<t.length;Ci++){var oi=o.parse(t[Ci],1+Hn.length);if(!oi)return null;Hn.push(ei(oi.type))}o.error("Expected arguments of type "+kn+", but found ("+Hn.join(", ")+") instead.")}return null},Va.register=function(t,o){for(var u in Va.definitions=o,o)t[u]=Va};var fs=function(t,o,u){this.type=Bi,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=o};function Eo(t,o){t[0]=Math.min(t[0],o[0]),t[1]=Math.min(t[1],o[1]),t[2]=Math.max(t[2],o[0]),t[3]=Math.max(t[3],o[1])}function Qe(t,o){return!(t[0]<=o[0]||t[2]>=o[2]||t[1]<=o[1]||t[3]>=o[3])}function gt(t,o){var u=(180+t[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(u*y*8192),Math.round(v*y*8192)]}function Gt(t,o,u){return o[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-o[0])*(t[1]-o[1])/(u[1]-o[1])+o[0]}function Pr(t,o){for(var u,v,y,b,T,I,Z,he=!1,_e=0,Ae=o.length;_e<Ae;_e++)for(var je=o[_e],Je=0,Tt=je.length;Je<Tt-1;Je++){if((b=(u=t)[0]-(v=je[Je])[0])*(Z=u[1]-(y=je[Je+1])[1])-(I=u[0]-y[0])*(T=u[1]-v[1])==0&&b*I<=0&&T*Z<=0)return!1;Gt(t,je[Je],je[Je+1])&&(he=!he)}return he}function Tn(t,o){for(var u=0;u<o.length;u++)if(Pr(t,o[u]))return!0;return!1}function di(t,o,u,v){var y=v[0]-u[0],b=v[1]-u[1],T=(t[0]-u[0])*b-y*(t[1]-u[1]),I=(o[0]-u[0])*b-y*(o[1]-u[1]);return T>0&&I<0||T<0&&I>0}function fa(t,o,u){for(var v=0,y=u;v<y.length;v+=1)for(var b=y[v],T=0;T<b.length-1;++T)if((Ae=[(_e=b[T+1])[0]-(he=b[T])[0],_e[1]-he[1]])[0]*(je=[(Z=o)[0]-(I=t)[0],Z[1]-I[1]])[1]-Ae[1]*je[0]!=0&&di(I,Z,he,_e)&&di(he,_e,I,Z))return!0;var I,Z,he,_e,Ae,je;return!1}function Bo(t,o){for(var u=0;u<t.length;++u)if(!Pr(t[u],o))return!1;for(var v=0;v<t.length-1;++v)if(fa(t[v],t[v+1],o))return!1;return!0}function Ko(t,o){for(var u=0;u<o.length;u++)if(Bo(t,o[u]))return!0;return!1}function Po(t,o,u){for(var v=[],y=0;y<t.length;y++){for(var b=[],T=0;T<t[y].length;T++){var I=gt(t[y][T],u);Eo(o,I),b.push(I)}v.push(b)}return v}function Us(t,o,u){for(var v=[],y=0;y<t.length;y++){var b=Po(t[y],o,u);v.push(b)}return v}function ws(t,o,u,v){if(t[0]<u[0]||t[0]>u[2]){var y=.5*v,b=t[0]-u[0]>y?-v:u[0]-t[0]>y?v:0;b===0&&(b=t[0]-u[2]>y?-v:u[2]-t[0]>y?v:0),t[0]+=b}Eo(o,t)}function Yc(t,o,u,v){for(var y=8192*Math.pow(2,v.z),b=[8192*v.x,8192*v.y],T=[],I=0,Z=t;I<Z.length;I+=1)for(var he=0,_e=Z[I];he<_e.length;he+=1){var Ae=_e[he],je=[Ae.x+b[0],Ae.y+b[1]];ws(je,o,u,y),T.push(je)}return T}function Ml(t,o,u,v){for(var y,b=8192*Math.pow(2,v.z),T=[8192*v.x,8192*v.y],I=[],Z=0,he=t;Z<he.length;Z+=1){for(var _e=[],Ae=0,je=he[Z];Ae<je.length;Ae+=1){var Je=je[Ae],Tt=[Je.x+T[0],Je.y+T[1]];Eo(o,Tt),_e.push(Tt)}I.push(_e)}if(o[2]-o[0]<=b/2){(y=o)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var wt=0,Wt=I;wt<Wt.length;wt+=1)for(var zt=0,or=Wt[wt];zt<or.length;zt+=1)ws(or[zt],o,u,b)}return I}fs.parse=function(t,o){if(t.length!==2)return o.error("Expected one argument.");var u=t[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");var v=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,sn);if(!v)return null;var y=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,sn);if(!y)return null;var b=null;return u.locale&&!(b=o.parse(u.locale,1,Or))?null:new fs(v,y,b)},fs.prototype.evaluate=function(t){return new ji(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},fs.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},fs.prototype.outputDefined=function(){return!1},fs.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ns=function(t,o){this.type=sn,this.geojson=t,this.geometries=o};function Uu(t){if(t instanceof Va&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof ns)return!1;var o=!0;return t.eachChild(function(u){o&&!Uu(u)&&(o=!1)}),o}function il(t){if(t instanceof Va&&t.name==="feature-state")return!1;var o=!0;return t.eachChild(function(u){o&&!il(u)&&(o=!1)}),o}function is(t,o){if(t instanceof Va&&o.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(v){u&&!is(v,o)&&(u=!1)}),u}ns.parse=function(t,o){if(t.length!==2)return o.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(cs(t[1])){var u=t[1];if(u.type==="FeatureCollection")for(var v=0;v<u.features.length;++v){var y=u.features[v].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new ns(u,u.features[v].geometry)}else if(u.type==="Feature"){var b=u.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new ns(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new ns(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ns.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){var T=Po(u.coordinates,y,b),I=Yc(o.geometry(),v,y,b);if(!Qe(v,y))return!1;for(var Z=0,he=I;Z<he.length;Z+=1)if(!Pr(he[Z],T))return!1}if(u.type==="MultiPolygon"){var _e=Us(u.coordinates,y,b),Ae=Yc(o.geometry(),v,y,b);if(!Qe(v,y))return!1;for(var je=0,Je=Ae;je<Je.length;je+=1)if(!Tn(Je[je],_e))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){var T=Po(u.coordinates,y,b),I=Ml(o.geometry(),v,y,b);if(!Qe(v,y))return!1;for(var Z=0,he=I;Z<he.length;Z+=1)if(!Bo(he[Z],T))return!1}if(u.type==="MultiPolygon"){var _e=Us(u.coordinates,y,b),Ae=Ml(o.geometry(),v,y,b);if(!Qe(v,y))return!1;for(var je=0,Je=Ae;je<Je.length;je+=1)if(!Ko(Je[je],_e))return!1}return!0}(t,this.geometries)}return!1},ns.prototype.eachChild=function(){},ns.prototype.outputDefined=function(){return!0},ns.prototype.serialize=function(){return["within",this.geojson]};var Cu=function(t,o){this.type=o.type,this.name=t,this.boundExpression=o};Cu.parse=function(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");var u=t[1];return o.scope.has(u)?new Cu(u,o.scope.get(u)):o.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Cu.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Cu.prototype.eachChild=function(){},Cu.prototype.outputDefined=function(){return!1},Cu.prototype.serialize=function(){return["var",this.name]};var al=function(t,o,u,v,y){o===void 0&&(o=[]),v===void 0&&(v=new Rn),y===void 0&&(y=[]),this.registry=t,this.path=o,this.key=o.map(function(b){return"["+b+"]"}).join(""),this.scope=v,this.errors=y,this.expectedType=u};function Kl(t,o){for(var u,v=t.length-1,y=0,b=v,T=0;y<=b;)if((u=t[T=Math.floor((y+b)/2)])<=o){if(T===v||o<t[T+1])return T;y=T+1}else{if(!(u>o))throw new Qa("Input is not a number.");b=T-1}return 0}al.prototype.parse=function(t,o,u,v,y){return y===void 0&&(y={}),o?this.concat(o,u,v)._parse(t,y):this._parse(t,y)},al.prototype._parse=function(t,o){function u(he,_e,Ae){return Ae==="assert"?new Na(_e,[he]):Ae==="coerce"?new Ao(_e,[he]):he}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var v=t[0];if(typeof v!="string")return this.error("Expression name must be a string, but found "+typeof v+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[v];if(y){var b=y.parse(t,this);if(!b)return null;if(this.expectedType){var T=this.expectedType,I=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||I.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(T,I))return null}else b=u(b,T,o.typeAnnotation||"coerce");else b=u(b,T,o.typeAnnotation||"assert")}if(!(b instanceof qa)&&b.type.kind!=="resolvedImage"&&function he(_e){if(_e instanceof Cu)return he(_e.boundExpression);if(_e instanceof Va&&_e.name==="error"||_e instanceof fs||_e instanceof ns)return!1;var Ae=_e instanceof Ao||_e instanceof Na,je=!0;return _e.eachChild(function(Je){je=Ae?je&&he(Je):je&&Je instanceof qa}),!!je&&Uu(_e)&&is(_e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var Z=new vo;try{b=new qa(b.type,b.evaluate(Z))}catch(he){return this.error(he.message),null}}return b}return this.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},al.prototype.concat=function(t,o,u){var v=typeof t=="number"?this.path.concat(t):this.path,y=u?this.scope.concat(u):this.scope;return new al(this.registry,v,o||null,y,this.errors)},al.prototype.error=function(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];var v=""+this.key+o.map(function(y){return"["+y+"]"}).join("");this.errors.push(new $r(v,t))},al.prototype.checkSubtype=function(t,o){var u=ua(t,o);return u&&this.error(u),u};var cn=function(t,o,u){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(var v=0,y=u;v<y.length;v+=1){var b=y[v],T=b[1];this.labels.push(b[0]),this.outputs.push(T)}};function Ei(t,o,u){return t*(1-u)+o*u}cn.parse=function(t,o){if(t.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");var u=o.parse(t[1],1,xr);if(!u)return null;var v=[],y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(var b=1;b<t.length;b+=2){var T=b===1?-1/0:t[b],I=t[b+1],Z=b,he=b+1;if(typeof T!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(v.length&&v[v.length-1][0]>=T)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);var _e=o.parse(I,he,y);if(!_e)return null;y=y||_e.type,v.push([T,_e])}return new cn(y,u,v)},cn.prototype.evaluate=function(t){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);var v=this.input.evaluate(t);if(v<=o[0])return u[0].evaluate(t);var y=o.length;return v>=o[y-1]?u[y-1].evaluate(t):u[Kl(o,v)].evaluate(t)},cn.prototype.eachChild=function(t){t(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)t(u[o])},cn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},cn.prototype.serialize=function(){for(var t=["step",this.input.serialize()],o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t};var Hi=Object.freeze({__proto__:null,number:Ei,color:function(t,o,u){return new Nr(Ei(t.r,o.r,u),Ei(t.g,o.g,u),Ei(t.b,o.b,u),Ei(t.a,o.a,u))},array:function(t,o,u){return t.map(function(v,y){return Ei(v,o[y],u)})}}),In=6/29*3*(6/29),Co=Math.PI/180,ol=180/Math.PI;function ql(t){return t>.008856451679035631?Math.pow(t,1/3):t/In+4/29}function Ic(t){return t>6/29?t*t*t:In*(t-4/29)}function uc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Pc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Kc(t){var o=Pc(t.r),u=Pc(t.g),v=Pc(t.b),y=ql((.4124564*o+.3575761*u+.1804375*v)/.95047),b=ql((.2126729*o+.7151522*u+.072175*v)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-ql((.0193339*o+.119192*u+.9503041*v)/1.08883)),alpha:t.a}}function bf(t){var o=(t.l+16)/116,u=isNaN(t.a)?o:o+t.a/500,v=isNaN(t.b)?o:o-t.b/200;return o=1*Ic(o),u=.95047*Ic(u),v=1.08883*Ic(v),new Nr(uc(3.2404542*u-1.5371385*o-.4985314*v),uc(-.969266*u+1.8760108*o+.041556*v),uc(.0556434*u-.2040259*o+1.0572252*v),t.alpha)}function qc(t,o,u){var v=o-t;return t+u*(v>180||v<-180?v-360*Math.round(v/360):v)}var Ol={forward:Kc,reverse:bf,interpolate:function(t,o,u){return{l:Ei(t.l,o.l,u),a:Ei(t.a,o.a,u),b:Ei(t.b,o.b,u),alpha:Ei(t.alpha,o.alpha,u)}}},lu={forward:function(t){var o=Kc(t),u=o.l,v=o.a,y=o.b,b=Math.atan2(y,v)*ol;return{h:b<0?b+360:b,c:Math.sqrt(v*v+y*y),l:u,alpha:t.a}},reverse:function(t){var o=t.h*Co,u=t.c;return bf({l:t.l,a:Math.cos(o)*u,b:Math.sin(o)*u,alpha:t.alpha})},interpolate:function(t,o,u){return{h:qc(t.h,o.h,u),c:Ei(t.c,o.c,u),l:Ei(t.l,o.l,u),alpha:Ei(t.alpha,o.alpha,u)}}},Ef=Object.freeze({__proto__:null,lab:Ol,hcl:lu}),hs=function(t,o,u,v,y){this.type=t,this.operator=o,this.interpolation=u,this.input=v,this.labels=[],this.outputs=[];for(var b=0,T=y;b<T.length;b+=1){var I=T[b],Z=I[1];this.labels.push(I[0]),this.outputs.push(Z)}};function gl(t,o,u,v){var y=v-u,b=t-u;return y===0?0:o===1?b/y:(Math.pow(o,b)-1)/(Math.pow(o,y)-1)}hs.interpolationFactor=function(t,o,u,v){var y=0;if(t.name==="exponential")y=gl(o,t.base,u,v);else if(t.name==="linear")y=gl(o,1,u,v);else if(t.name==="cubic-bezier"){var b=t.controlPoints;y=new P(b[0],b[1],b[2],b[3]).solve(gl(o,1,u,v))}return y},hs.parse=function(t,o){var u=t[0],v=t[1],y=t[2],b=t.slice(3);if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){var T=v[1];if(typeof T!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:T}}else{if(v[0]!=="cubic-bezier")return o.error("Unknown interpolation type "+String(v[0]),1,0);var I=v.slice(1);if(I.length!==4||I.some(function(Wt){return typeof Wt!="number"||Wt<0||Wt>1}))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:I}}if(t.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(!(y=o.parse(y,2,xr)))return null;var Z=[],he=null;u==="interpolate-hcl"||u==="interpolate-lab"?he=xn:o.expectedType&&o.expectedType.kind!=="value"&&(he=o.expectedType);for(var _e=0;_e<b.length;_e+=2){var Ae=b[_e],je=b[_e+1],Je=_e+3,Tt=_e+4;if(typeof Ae!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Je);if(Z.length&&Z[Z.length-1][0]>=Ae)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Je);var wt=o.parse(je,Tt,he);if(!wt)return null;he=he||wt.type,Z.push([Ae,wt])}return he.kind==="number"||he.kind==="color"||he.kind==="array"&&he.itemType.kind==="number"&&typeof he.N=="number"?new hs(he,u,v,y,Z):o.error("Type "+ei(he)+" is not interpolatable.")},hs.prototype.evaluate=function(t){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);var v=this.input.evaluate(t);if(v<=o[0])return u[0].evaluate(t);var y=o.length;if(v>=o[y-1])return u[y-1].evaluate(t);var b=Kl(o,v),T=hs.interpolationFactor(this.interpolation,v,o[b],o[b+1]),I=u[b].evaluate(t),Z=u[b+1].evaluate(t);return this.operator==="interpolate"?Hi[this.type.kind.toLowerCase()](I,Z,T):this.operator==="interpolate-hcl"?lu.reverse(lu.interpolate(lu.forward(I),lu.forward(Z),T)):Ol.reverse(Ol.interpolate(Ol.forward(I),Ol.forward(Z),T))},hs.prototype.eachChild=function(t){t(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)t(u[o])},hs.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},hs.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var o=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o};var yl=function(t,o){this.type=t,this.args=o};yl.parse=function(t,o){if(t.length<2)return o.error("Expectected at least one argument.");var u=null,v=o.expectedType;v&&v.kind!=="value"&&(u=v);for(var y=[],b=0,T=t.slice(1);b<T.length;b+=1){var I=o.parse(T[b],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!I)return null;u=u||I.type,y.push(I)}var Z=v&&y.some(function(he){return ua(v,he.type)});return new yl(Z?Nn:u,y)},yl.prototype.evaluate=function(t){for(var o,u=null,v=0,y=0,b=this.args;y<b.length&&(v++,(u=b[y].evaluate(t))&&u instanceof Za&&!u.available&&(o||(o=u.name),u=null,v===this.args.length&&(u=o)),u===null);y+=1);return u},yl.prototype.eachChild=function(t){this.args.forEach(t)},yl.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},yl.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(o){t.push(o.serialize())}),t};var Ws=function(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o};Ws.prototype.evaluate=function(t){return this.result.evaluate(t)},Ws.prototype.eachChild=function(t){for(var o=0,u=this.bindings;o<u.length;o+=1)t(u[o][1]);t(this.result)},Ws.parse=function(t,o){if(t.length<4)return o.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],v=1;v<t.length-1;v+=2){var y=t[v];if(typeof y!="string")return o.error("Expected string, but found "+typeof y+" instead.",v);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",v);var b=o.parse(t[v+1],v+1);if(!b)return null;u.push([y,b])}var T=o.parse(t[t.length-1],t.length-1,o.expectedType,u);return T?new Ws(u,T):null},Ws.prototype.outputDefined=function(){return this.result.outputDefined()},Ws.prototype.serialize=function(){for(var t=["let"],o=0,u=this.bindings;o<u.length;o+=1){var v=u[o];t.push(v[0],v[1].serialize())}return t.push(this.result.serialize()),t};var Js=function(t,o,u){this.type=t,this.index=o,this.input=u};Js.parse=function(t,o){if(t.length!==3)return o.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,xr),v=o.parse(t[2],2,bn(o.expectedType||Nn));return u&&v?new Js(v.type.itemType,u,v):null},Js.prototype.evaluate=function(t){var o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new Qa("Array index out of bounds: "+o+" < 0.");if(o>=u.length)throw new Qa("Array index out of bounds: "+o+" > "+(u.length-1)+".");if(o!==Math.floor(o))throw new Qa("Array index must be an integer, but found "+o+" instead.");return u[o]},Js.prototype.eachChild=function(t){t(this.index),t(this.input)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var eu=function(t,o){this.type=sn,this.needle=t,this.haystack=o};eu.parse=function(t,o){if(t.length!==3)return o.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,Nn),v=o.parse(t[2],2,Nn);return u&&v?no(u.type,[sn,Or,xr,nn,Nn])?new eu(u,v):o.error("Expected first argument to be of type boolean, string, number or null, but found "+ei(u.type)+" instead"):null},eu.prototype.evaluate=function(t){var o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!ia(o,["boolean","string","number","null"]))throw new Qa("Expected first argument to be of type boolean, string, number or null, but found "+ei(Ka(o))+" instead.");if(!ia(u,["string","array"]))throw new Qa("Expected second argument to be of type array or string, but found "+ei(Ka(u))+" instead.");return u.indexOf(o)>=0},eu.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},eu.prototype.outputDefined=function(){return!0},eu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var cu=function(t,o,u){this.type=xr,this.needle=t,this.haystack=o,this.fromIndex=u};cu.parse=function(t,o){if(t.length<=2||t.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,Nn),v=o.parse(t[2],2,Nn);if(!u||!v)return null;if(!no(u.type,[sn,Or,xr,nn,Nn]))return o.error("Expected first argument to be of type boolean, string, number or null, but found "+ei(u.type)+" instead");if(t.length===4){var y=o.parse(t[3],3,xr);return y?new cu(u,v,y):null}return new cu(u,v)},cu.prototype.evaluate=function(t){var o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!ia(o,["boolean","string","number","null"]))throw new Qa("Expected first argument to be of type boolean, string, number or null, but found "+ei(Ka(o))+" instead.");if(!ia(u,["string","array"]))throw new Qa("Expected second argument to be of type array or string, but found "+ei(Ka(u))+" instead.");if(this.fromIndex){var v=this.fromIndex.evaluate(t);return u.indexOf(o,v)}return u.indexOf(o)},cu.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},cu.prototype.outputDefined=function(){return!1},cu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var zs=function(t,o,u,v,y,b){this.inputType=t,this.type=o,this.input=u,this.cases=v,this.outputs=y,this.otherwise=b};zs.parse=function(t,o){if(t.length<5)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return o.error("Expected an even number of arguments.");var u,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(var y={},b=[],T=2;T<t.length-1;T+=2){var I=t[T],Z=t[T+1];Array.isArray(I)||(I=[I]);var he=o.concat(T);if(I.length===0)return he.error("Expected at least one branch label.");for(var _e=0,Ae=I;_e<Ae.length;_e+=1){var je=Ae[_e];if(typeof je!="number"&&typeof je!="string")return he.error("Branch labels must be numbers or strings.");if(typeof je=="number"&&Math.abs(je)>Number.MAX_SAFE_INTEGER)return he.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof je=="number"&&Math.floor(je)!==je)return he.error("Numeric branch labels must be integer values.");if(u){if(he.checkSubtype(u,Ka(je)))return null}else u=Ka(je);if(y[String(je)]!==void 0)return he.error("Branch labels must be unique.");y[String(je)]=b.length}var Je=o.parse(Z,T,v);if(!Je)return null;v=v||Je.type,b.push(Je)}var Tt=o.parse(t[1],1,Nn);if(!Tt)return null;var wt=o.parse(t[t.length-1],t.length-1,v);return wt?Tt.type.kind!=="value"&&o.concat(1).checkSubtype(u,Tt.type)?null:new zs(u,v,Tt,y,b,wt):null},zs.prototype.evaluate=function(t){var o=this.input.evaluate(t);return(Ka(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)},zs.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},zs.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},zs.prototype.serialize=function(){for(var t=this,o=["match",this.input.serialize()],u=[],v={},y=0,b=Object.keys(this.cases).sort();y<b.length;y+=1){var T=b[y];(Ae=v[this.cases[T]])===void 0?(v[this.cases[T]]=u.length,u.push([this.cases[T],[T]])):u[Ae][1].push(T)}for(var I=function(Je){return t.inputType.kind==="number"?Number(Je):Je},Z=0,he=u;Z<he.length;Z+=1){var _e=he[Z],Ae=_e[0],je=_e[1];o.push(je.length===1?I(je[0]):je.map(I)),o.push(this.outputs[outputIndex$1].serialize())}return o.push(this.otherwise.serialize()),o};var zu=function(t,o,u){this.type=t,this.branches=o,this.otherwise=u};zu.parse=function(t,o){if(t.length<4)return o.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return o.error("Expected an odd number of arguments.");var u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);for(var v=[],y=1;y<t.length-1;y+=2){var b=o.parse(t[y],y,sn);if(!b)return null;var T=o.parse(t[y+1],y+1,u);if(!T)return null;v.push([b,T]),u=u||T.type}var I=o.parse(t[t.length-1],t.length-1,u);return I?new zu(u,v,I):null},zu.prototype.evaluate=function(t){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],y=v[1];if(v[0].evaluate(t))return y.evaluate(t)}return this.otherwise.evaluate(t)},zu.prototype.eachChild=function(t){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],y=v[1];t(v[0]),t(y)}t(this.otherwise)},zu.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},zu.prototype.serialize=function(){var t=["case"];return this.eachChild(function(o){t.push(o.serialize())}),t};var Zu=function(t,o,u,v){this.type=t,this.input=o,this.beginIndex=u,this.endIndex=v};function lc(t,o){return t==="=="||t==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function cc(t,o,u,v){return v.compare(o,u)===0}function ja(t,o,u){var v=t!=="=="&&t!=="!=";return function(){function y(b,T,I){this.type=sn,this.lhs=b,this.rhs=T,this.collator=I,this.hasUntypedArgument=b.type.kind==="value"||T.type.kind==="value"}return y.parse=function(b,T){if(b.length!==3&&b.length!==4)return T.error("Expected two or three arguments.");var I=b[0],Z=T.parse(b[1],1,Nn);if(!Z)return null;if(!lc(I,Z.type))return T.concat(1).error('"'+I+`" comparisons are not supported for type '`+ei(Z.type)+"'.");var he=T.parse(b[2],2,Nn);if(!he)return null;if(!lc(I,he.type))return T.concat(2).error('"'+I+`" comparisons are not supported for type '`+ei(he.type)+"'.");if(Z.type.kind!==he.type.kind&&Z.type.kind!=="value"&&he.type.kind!=="value")return T.error("Cannot compare types '"+ei(Z.type)+"' and '"+ei(he.type)+"'.");v&&(Z.type.kind==="value"&&he.type.kind!=="value"?Z=new Na(he.type,[Z]):Z.type.kind!=="value"&&he.type.kind==="value"&&(he=new Na(Z.type,[he])));var _e=null;if(b.length===4){if(Z.type.kind!=="string"&&he.type.kind!=="string"&&Z.type.kind!=="value"&&he.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(!(_e=T.parse(b[3],3,Bi)))return null}return new y(Z,he,_e)},y.prototype.evaluate=function(b){var T=this.lhs.evaluate(b),I=this.rhs.evaluate(b);if(v&&this.hasUntypedArgument){var Z=Ka(T),he=Ka(I);if(Z.kind!==he.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Qa('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+Z.kind+", "+he.kind+") instead.")}if(this.collator&&!v&&this.hasUntypedArgument){var _e=Ka(T),Ae=Ka(I);if(_e.kind!=="string"||Ae.kind!=="string")return o(b,T,I)}return this.collator?u(b,T,I,this.collator.evaluate(b)):o(b,T,I)},y.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var b=[t];return this.eachChild(function(T){b.push(T.serialize())}),b},y}()}Zu.parse=function(t,o){if(t.length<=2||t.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,Nn),v=o.parse(t[2],2,xr);if(!u||!v)return null;if(!no(u.type,[bn(Nn),Or,Nn]))return o.error("Expected first argument to be of type array or string, but found "+ei(u.type)+" instead");if(t.length===4){var y=o.parse(t[3],3,xr);return y?new Zu(u.type,u,v,y):null}return new Zu(u.type,u,v)},Zu.prototype.evaluate=function(t){var o=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!ia(o,["string","array"]))throw new Qa("Expected first argument to be of type array or string, but found "+ei(Ka(o))+" instead.");if(this.endIndex){var v=this.endIndex.evaluate(t);return o.slice(u,v)}return o.slice(u)},Zu.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Zu.prototype.outputDefined=function(){return!1},Zu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jf=ja("==",function(t,o,u){return o===u},cc),fc=ja("!=",function(t,o,u){return o!==u},function(t,o,u,v){return!cc(0,o,u,v)}),Il=ja("<",function(t,o,u){return o<u},function(t,o,u,v){return v.compare(o,u)<0}),co=ja(">",function(t,o,u){return o>u},function(t,o,u,v){return v.compare(o,u)>0}),Qc=ja("<=",function(t,o,u){return o<=u},function(t,o,u,v){return v.compare(o,u)<=0}),Jc=ja(">=",function(t,o,u){return o>=u},function(t,o,u,v){return v.compare(o,u)>=0}),Ho=function(t,o,u,v,y){this.type=Or,this.number=t,this.locale=o,this.currency=u,this.minFractionDigits=v,this.maxFractionDigits=y};Ho.parse=function(t,o){if(t.length!==3)return o.error("Expected two arguments.");var u=o.parse(t[1],1,xr);if(!u)return null;var v=t[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");var y=null;if(v.locale&&!(y=o.parse(v.locale,1,Or)))return null;var b=null;if(v.currency&&!(b=o.parse(v.currency,1,Or)))return null;var T=null;if(v["min-fraction-digits"]&&!(T=o.parse(v["min-fraction-digits"],1,xr)))return null;var I=null;return v["max-fraction-digits"]&&!(I=o.parse(v["max-fraction-digits"],1,xr))?null:new Ho(u,y,b,T,I)},Ho.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Ho.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Ho.prototype.outputDefined=function(){return!1},Ho.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var wu=function(t){this.type=xr,this.input=t};wu.parse=function(t,o){if(t.length!==2)return o.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error("Expected argument of type string or array, but found "+ei(u.type)+" instead."):new wu(u):null},wu.prototype.evaluate=function(t){var o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Qa("Expected value to be of type string or array, but found "+ei(Ka(o))+" instead.")},wu.prototype.eachChild=function(t){t(this.input)},wu.prototype.outputDefined=function(){return!1},wu.prototype.serialize=function(){var t=["length"];return this.eachChild(function(o){t.push(o.serialize())}),t};var fu={"==":jf,"!=":fc,">":co,"<":Il,">=":Jc,"<=":Qc,array:Na,at:Js,boolean:Na,case:zu,coalesce:yl,collator:fs,format:Lo,image:ba,in:eu,"index-of":cu,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:wu,let:Ws,literal:qa,match:zs,number:Na,"number-format":Ho,object:Na,slice:Zu,step:cn,string:Na,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:Cu,within:ns};function hu(t,o){var u=o[0],v=o[1],y=o[2],b=o[3];u=u.evaluate(t),v=v.evaluate(t),y=y.evaluate(t);var T=b?b.evaluate(t):1,I=Qs(u,v,y,T);if(I)throw new Qa(I);return new Nr(u/255*T,v/255*T,y/255*T,T)}function Ql(t,o){return t in o}function _l(t,o){var u=o[t];return u===void 0?null:u}function tu(t){return{type:t}}function Jl(t){return{result:"success",value:t}}function sl(t){return{result:"error",value:t}}function ru(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Wo(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function eo(t){return!!t.expression&&t.expression.interpolated}function fo(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Ru(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Sf(t){return t}function Vu(t,o,u){return t!==void 0?t:o!==void 0?o:u!==void 0?u:void 0}function hc(t,o,u,v,y){return Vu(typeof u===y?v[u]:void 0,t.default,o.default)}function Pl(t,o,u){if(fo(u)!=="number")return Vu(t.default,o.default);var v=t.stops.length;if(v===1||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[v-1][0])return t.stops[v-1][1];var y=Kl(t.stops.map(function(b){return b[0]}),u);return t.stops[y][1]}function Zs(t,o,u){var v=t.base!==void 0?t.base:1;if(fo(u)!=="number")return Vu(t.default,o.default);var y=t.stops.length;if(y===1||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[y-1][0])return t.stops[y-1][1];var b=Kl(t.stops.map(function(Ae){return Ae[0]}),u),T=function(Ae,je,Je,Tt){var wt=Tt-Je,Wt=Ae-Je;return wt===0?0:je===1?Wt/wt:(Math.pow(je,Wt)-1)/(Math.pow(je,wt)-1)}(u,v,t.stops[b][0],t.stops[b+1][0]),I=t.stops[b][1],Z=t.stops[b+1][1],he=Hi[o.type]||Sf;if(t.colorSpace&&t.colorSpace!=="rgb"){var _e=Ef[t.colorSpace];he=function(Ae,je){return _e.reverse(_e.interpolate(_e.forward(Ae),_e.forward(je),T))}}return typeof I.evaluate=="function"?{evaluate:function(){for(var Ae=[],je=arguments.length;je--;)Ae[je]=arguments[je];var Je=I.evaluate.apply(void 0,Ae),Tt=Z.evaluate.apply(void 0,Ae);if(Je!==void 0&&Tt!==void 0)return he(Je,Tt,T)}}:he(I,Z,T)}function Mu(t,o,u){return o.type==="color"?u=Nr.parse(u):o.type==="formatted"?u=Da.fromString(u.toString()):o.type==="resolvedImage"?u=Za.fromString(u.toString()):fo(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),Vu(u,t.default,o.default)}Va.register(fu,{error:[{kind:"error"},[Or],function(t,o){throw new Qa(o[0].evaluate(t))}],typeof:[Or,[Nn],function(t,o){return ei(Ka(o[0].evaluate(t)))}],"to-rgba":[bn(xr,4),[xn],function(t,o){return o[0].evaluate(t).toArray()}],rgb:[xn,[xr,xr,xr],hu],rgba:[xn,[xr,xr,xr,xr],hu],has:{type:sn,overloads:[[[Or],function(t,o){return Ql(o[0].evaluate(t),t.properties())}],[[Or,wi],function(t,o){var u=o[1];return Ql(o[0].evaluate(t),u.evaluate(t))}]]},get:{type:Nn,overloads:[[[Or],function(t,o){return _l(o[0].evaluate(t),t.properties())}],[[Or,wi],function(t,o){var u=o[1];return _l(o[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[Nn,[Or],function(t,o){return _l(o[0].evaluate(t),t.featureState||{})}],properties:[wi,[],function(t){return t.properties()}],"geometry-type":[Or,[],function(t){return t.geometryType()}],id:[Nn,[],function(t){return t.id()}],zoom:[xr,[],function(t){return t.globals.zoom}],"heatmap-density":[xr,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[xr,[],function(t){return t.globals.lineProgress||0}],accumulated:[Nn,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[xr,tu(xr),function(t,o){for(var u=0,v=0,y=o;v<y.length;v+=1)u+=y[v].evaluate(t);return u}],"*":[xr,tu(xr),function(t,o){for(var u=1,v=0,y=o;v<y.length;v+=1)u*=y[v].evaluate(t);return u}],"-":{type:xr,overloads:[[[xr,xr],function(t,o){var u=o[1];return o[0].evaluate(t)-u.evaluate(t)}],[[xr],function(t,o){return-o[0].evaluate(t)}]]},"/":[xr,[xr,xr],function(t,o){var u=o[1];return o[0].evaluate(t)/u.evaluate(t)}],"%":[xr,[xr,xr],function(t,o){var u=o[1];return o[0].evaluate(t)%u.evaluate(t)}],ln2:[xr,[],function(){return Math.LN2}],pi:[xr,[],function(){return Math.PI}],e:[xr,[],function(){return Math.E}],"^":[xr,[xr,xr],function(t,o){var u=o[1];return Math.pow(o[0].evaluate(t),u.evaluate(t))}],sqrt:[xr,[xr],function(t,o){return Math.sqrt(o[0].evaluate(t))}],log10:[xr,[xr],function(t,o){return Math.log(o[0].evaluate(t))/Math.LN10}],ln:[xr,[xr],function(t,o){return Math.log(o[0].evaluate(t))}],log2:[xr,[xr],function(t,o){return Math.log(o[0].evaluate(t))/Math.LN2}],sin:[xr,[xr],function(t,o){return Math.sin(o[0].evaluate(t))}],cos:[xr,[xr],function(t,o){return Math.cos(o[0].evaluate(t))}],tan:[xr,[xr],function(t,o){return Math.tan(o[0].evaluate(t))}],asin:[xr,[xr],function(t,o){return Math.asin(o[0].evaluate(t))}],acos:[xr,[xr],function(t,o){return Math.acos(o[0].evaluate(t))}],atan:[xr,[xr],function(t,o){return Math.atan(o[0].evaluate(t))}],min:[xr,tu(xr),function(t,o){return Math.min.apply(Math,o.map(function(u){return u.evaluate(t)}))}],max:[xr,tu(xr),function(t,o){return Math.max.apply(Math,o.map(function(u){return u.evaluate(t)}))}],abs:[xr,[xr],function(t,o){return Math.abs(o[0].evaluate(t))}],round:[xr,[xr],function(t,o){var u=o[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[xr,[xr],function(t,o){return Math.floor(o[0].evaluate(t))}],ceil:[xr,[xr],function(t,o){return Math.ceil(o[0].evaluate(t))}],"filter-==":[sn,[Or,Nn],function(t,o){var u=o[0],v=o[1];return t.properties()[u.value]===v.value}],"filter-id-==":[sn,[Nn],function(t,o){var u=o[0];return t.id()===u.value}],"filter-type-==":[sn,[Or],function(t,o){var u=o[0];return t.geometryType()===u.value}],"filter-<":[sn,[Or,Nn],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],b=v.value;return typeof y==typeof b&&y<b}],"filter-id-<":[sn,[Nn],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v<y}],"filter->":[sn,[Or,Nn],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],b=v.value;return typeof y==typeof b&&y>b}],"filter-id->":[sn,[Nn],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v>y}],"filter-<=":[sn,[Or,Nn],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],b=v.value;return typeof y==typeof b&&y<=b}],"filter-id-<=":[sn,[Nn],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v<=y}],"filter->=":[sn,[Or,Nn],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],b=v.value;return typeof y==typeof b&&y>=b}],"filter-id->=":[sn,[Nn],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v>=y}],"filter-has":[sn,[Nn],function(t,o){return o[0].value in t.properties()}],"filter-has-id":[sn,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[sn,[bn(Or)],function(t,o){return o[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[sn,[bn(Nn)],function(t,o){return o[0].value.indexOf(t.id())>=0}],"filter-in-small":[sn,[Or,bn(Nn)],function(t,o){var u=o[0];return o[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[sn,[Or,bn(Nn)],function(t,o){var u=o[0],v=o[1];return function(y,b,T,I){for(;T<=I;){var Z=T+I>>1;if(b[Z]===y)return!0;b[Z]>y?I=Z-1:T=Z+1}return!1}(t.properties()[u.value],v.value,0,v.value.length-1)}],all:{type:sn,overloads:[[[sn,sn],function(t,o){var u=o[1];return o[0].evaluate(t)&&u.evaluate(t)}],[tu(sn),function(t,o){for(var u=0,v=o;u<v.length;u+=1)if(!v[u].evaluate(t))return!1;return!0}]]},any:{type:sn,overloads:[[[sn,sn],function(t,o){var u=o[1];return o[0].evaluate(t)||u.evaluate(t)}],[tu(sn),function(t,o){for(var u=0,v=o;u<v.length;u+=1)if(v[u].evaluate(t))return!0;return!1}]]},"!":[sn,[sn],function(t,o){return!o[0].evaluate(t)}],"is-supported-script":[sn,[Or],function(t,o){var u=t.globals&&t.globals.isSupportedScript;return!u||u(o[0].evaluate(t))}],upcase:[Or,[Or],function(t,o){return o[0].evaluate(t).toUpperCase()}],downcase:[Or,[Or],function(t,o){return o[0].evaluate(t).toLowerCase()}],concat:[Or,tu(Nn),function(t,o){return o.map(function(u){return Do(u.evaluate(t))}).join("")}],"resolved-locale":[Or,[Bi],function(t,o){return o[0].evaluate(t).resolvedLocale()}]});var pu=function(t,o){this.expression=t,this._warningHistory={},this._evaluator=new vo,this._defaultValue=o?function(u){return u.type==="color"&&Ru(u.default)?new Nr(0,0,0,0):u.type==="color"?Nr.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null};function ju(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in fu}function kl(t,o){var u=new al(fu,[],o?function(y){var b={color:xn,string:Or,number:xr,enum:Or,boolean:sn,formatted:sa,resolvedImage:Fi};return y.type==="array"?bn(b[y.value]||Nn,y.length):b[y.type]}(o):void 0),v=u.parse(t,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?Jl(new pu(v,o)):sl(u.errors)}pu.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,b){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=v,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},pu.prototype.evaluate=function(t,o,u,v,y,b){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=v,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{var T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Qa("Expected value to be one of "+Object.keys(this._enumValues).map(function(I){return JSON.stringify(I)}).join(", ")+", but found "+JSON.stringify(T)+" instead.");return T}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console!="undefined"&&console.warn(I.message)),this._defaultValue}};var Dl=function(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!il(o.expression)};Dl.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,b){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,v,y,b)},Dl.prototype.evaluate=function(t,o,u,v,y,b){return this._styleExpression.evaluate(t,o,u,v,y,b)};var $u=function(t,o,u,v){this.kind=t,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!il(o.expression),this.interpolationType=v};function pc(t,o){if((t=kl(t,o)).result==="error")return t;var u=t.value.expression,v=Uu(u);if(!v&&!ru(o))return sl([new $r("","data expressions not supported")]);var y=is(u,["zoom"]);if(!y&&!Wo(o))return sl([new $r("","zoom expressions not supported")]);var b=function T(I){var Z=null;if(I instanceof Ws)Z=T(I.result);else if(I instanceof yl)for(var he=0,_e=I.args;he<_e.length&&!(Z=T(_e[he]));he+=1);else(I instanceof cn||I instanceof hs)&&I.input instanceof Va&&I.input.name==="zoom"&&(Z=I);return Z instanceof $r||I.eachChild(function(Ae){var je=T(Ae);je instanceof $r?Z=je:!Z&&je?Z=new $r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):Z&&je&&Z!==je&&(Z=new $r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),Z}(u);return b||y?b instanceof $r?sl([b]):b instanceof hs&&!eo(o)?sl([new $r("",'"interpolate" expressions cannot be used with this property')]):Jl(b?new $u(v?"camera":"composite",t.value,b.labels,b instanceof hs?b.interpolation:void 0):new Dl(v?"constant":"source",t.value)):sl([new $r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}$u.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,b){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,v,y,b)},$u.prototype.evaluate=function(t,o,u,v,y,b){return this._styleExpression.evaluate(t,o,u,v,y,b)},$u.prototype.interpolationFactor=function(t,o,u){return this.interpolationType?hs.interpolationFactor(this.interpolationType,t,o,u):0};var Hu=function(t,o){this._parameters=t,this._specification=o,ue(this,function u(v,y){var b,T,I,Z=y.type==="color",he=v.stops&&typeof v.stops[0][0]=="object",_e=he||!(he||v.property!==void 0),Ae=v.type||(eo(y)?"exponential":"interval");if(Z&&((v=ue({},v)).stops&&(v.stops=v.stops.map(function(oi){return[oi[0],Nr.parse(oi[1])]})),v.default=Nr.parse(v.default?v.default:y.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!Ef[v.colorSpace])throw new Error("Unknown color space: "+v.colorSpace);if(Ae==="exponential")b=Zs;else if(Ae==="interval")b=Pl;else if(Ae==="categorical"){b=hc,T=Object.create(null);for(var je=0,Je=v.stops;je<Je.length;je+=1){var Tt=Je[je];T[Tt[0]]=Tt[1]}I=typeof v.stops[0][0]}else{if(Ae!=="identity")throw new Error('Unknown function type "'+Ae+'"');b=Mu}if(he){for(var wt={},Wt=[],zt=0;zt<v.stops.length;zt++){var or=v.stops[zt],dr=or[0].zoom;wt[dr]===void 0&&(wt[dr]={zoom:dr,type:v.type,property:v.property,default:v.default,stops:[]},Wt.push(dr)),wt[dr].stops.push([or[0].value,or[1]])}for(var Ar=[],kr=0,en=Wt;kr<en.length;kr+=1){var kn=en[kr];Ar.push([wt[kn].zoom,u(wt[kn],y)])}var Hn={name:"linear"};return{kind:"composite",interpolationType:Hn,interpolationFactor:hs.interpolationFactor.bind(void 0,Hn),zoomStops:Ar.map(function(oi){return oi[0]}),evaluate:function(oi,Li){var si=oi.zoom;return Zs({stops:Ar,base:v.base},y,si).evaluate(si,Li)}}}if(_e){var Ci=Ae==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:Ci,interpolationFactor:hs.interpolationFactor.bind(void 0,Ci),zoomStops:v.stops.map(function(oi){return oi[0]}),evaluate:function(oi){return b(v,y,oi.zoom,T,I)}}}return{kind:"source",evaluate:function(oi,Li){var si=Li&&Li.properties?Li.properties[v.property]:void 0;return si===void 0?Vu(v.default,y.default):b(v,y,si,T,I)}}}(this._parameters,this._specification))};function Rs(t){var o=t.key,u=t.value,v=t.valueSpec||{},y=t.objectElementValidators||{},b=t.style,T=t.styleSpec,I=[],Z=fo(u);if(Z!=="object")return[new Ue(o,u,"object expected, "+Z+" found")];for(var he in u){var _e=he.split(".")[0],Ae=v[_e]||v["*"],je=void 0;if(y[_e])je=y[_e];else if(v[_e])je=Ca;else if(y["*"])je=y["*"];else{if(!v["*"]){I.push(new Ue(o,u[he],'unknown property "'+he+'"'));continue}je=Ca}I=I.concat(je({key:(o&&o+".")+he,value:u[he],valueSpec:Ae,style:b,styleSpec:T,object:u,objectKey:he},u))}for(var Je in v)y[Je]||v[Je].required&&v[Je].default===void 0&&u[Je]===void 0&&I.push(new Ue(o,u,'missing required property "'+Je+'"'));return I}function ef(t){var o=t.value,u=t.valueSpec,v=t.style,y=t.styleSpec,b=t.key,T=t.arrayElementValidator||Ca;if(fo(o)!=="array")return[new Ue(b,o,"array expected, "+fo(o)+" found")];if(u.length&&o.length!==u.length)return[new Ue(b,o,"array length "+u.length+" expected, length "+o.length+" found")];if(u["min-length"]&&o.length<u["min-length"])return[new Ue(b,o,"array length at least "+u["min-length"]+" expected, length "+o.length+" found")];var I={type:u.value,values:u.values};y.$version<7&&(I.function=u.function),fo(u.value)==="object"&&(I=u.value);for(var Z=[],he=0;he<o.length;he++)Z=Z.concat(T({array:o,arrayIndex:he,value:o[he],valueSpec:I,style:v,styleSpec:y,key:b+"["+he+"]"}));return Z}function kc(t){var o=t.key,u=t.value,v=t.valueSpec,y=fo(u);return y==="number"&&u!=u&&(y="NaN"),y!=="number"?[new Ue(o,u,"number expected, "+y+" found")]:"minimum"in v&&u<v.minimum?[new Ue(o,u,u+" is less than the minimum value "+v.minimum)]:"maximum"in v&&u>v.maximum?[new Ue(o,u,u+" is greater than the maximum value "+v.maximum)]:[]}function tf(t){var o,u,v,y=t.valueSpec,b=Lr(t.value.type),T={},I=b!=="categorical"&&t.value.property===void 0,Z=!I,he=fo(t.value.stops)==="array"&&fo(t.value.stops[0])==="array"&&fo(t.value.stops[0][0])==="object",_e=Rs({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(Je){if(b==="identity")return[new Ue(Je.key,Je.value,'identity function may not have a "stops" property')];var Tt=[],wt=Je.value;return Tt=Tt.concat(ef({key:Je.key,value:wt,valueSpec:Je.valueSpec,style:Je.style,styleSpec:Je.styleSpec,arrayElementValidator:Ae})),fo(wt)==="array"&&wt.length===0&&Tt.push(new Ue(Je.key,wt,"array must have at least one stop")),Tt},default:function(Je){return Ca({key:Je.key,value:Je.value,valueSpec:y,style:Je.style,styleSpec:Je.styleSpec})}}});return b==="identity"&&I&&_e.push(new Ue(t.key,t.value,'missing required property "property"')),b==="identity"||t.value.stops||_e.push(new Ue(t.key,t.value,'missing required property "stops"')),b==="exponential"&&t.valueSpec.expression&&!eo(t.valueSpec)&&_e.push(new Ue(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(Z&&!ru(t.valueSpec)?_e.push(new Ue(t.key,t.value,"property functions not supported")):I&&!Wo(t.valueSpec)&&_e.push(new Ue(t.key,t.value,"zoom functions not supported"))),b!=="categorical"&&!he||t.value.property!==void 0||_e.push(new Ue(t.key,t.value,'"property" property is required')),_e;function Ae(Je){var Tt=[],wt=Je.value,Wt=Je.key;if(fo(wt)!=="array")return[new Ue(Wt,wt,"array expected, "+fo(wt)+" found")];if(wt.length!==2)return[new Ue(Wt,wt,"array length 2 expected, length "+wt.length+" found")];if(he){if(fo(wt[0])!=="object")return[new Ue(Wt,wt,"object expected, "+fo(wt[0])+" found")];if(wt[0].zoom===void 0)return[new Ue(Wt,wt,"object stop key must have zoom")];if(wt[0].value===void 0)return[new Ue(Wt,wt,"object stop key must have value")];if(v&&v>Lr(wt[0].zoom))return[new Ue(Wt,wt[0].zoom,"stop zoom values must appear in ascending order")];Lr(wt[0].zoom)!==v&&(v=Lr(wt[0].zoom),u=void 0,T={}),Tt=Tt.concat(Rs({key:Wt+"[0]",value:wt[0],valueSpec:{zoom:{}},style:Je.style,styleSpec:Je.styleSpec,objectElementValidators:{zoom:kc,value:je}}))}else Tt=Tt.concat(je({key:Wt+"[0]",value:wt[0],valueSpec:{},style:Je.style,styleSpec:Je.styleSpec},wt));return ju(lr(wt[1]))?Tt.concat([new Ue(Wt+"[1]",wt[1],"expressions are not allowed in function stops.")]):Tt.concat(Ca({key:Wt+"[1]",value:wt[1],valueSpec:y,style:Je.style,styleSpec:Je.styleSpec}))}function je(Je,Tt){var wt=fo(Je.value),Wt=Lr(Je.value),zt=Je.value!==null?Je.value:Tt;if(o){if(wt!==o)return[new Ue(Je.key,zt,wt+" stop domain type must match previous stop domain type "+o)]}else o=wt;if(wt!=="number"&&wt!=="string"&&wt!=="boolean")return[new Ue(Je.key,zt,"stop domain value must be a number, string, or boolean")];if(wt!=="number"&&b!=="categorical"){var or="number expected, "+wt+" found";return ru(y)&&b===void 0&&(or+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ue(Je.key,zt,or)]}return b!=="categorical"||wt!=="number"||isFinite(Wt)&&Math.floor(Wt)===Wt?b!=="categorical"&&wt==="number"&&u!==void 0&&Wt<u?[new Ue(Je.key,zt,"stop domain values must appear in ascending order")]:(u=Wt,b==="categorical"&&Wt in T?[new Ue(Je.key,zt,"stop domain values must be unique")]:(T[Wt]=!0,[])):[new Ue(Je.key,zt,"integer expected, found "+Wt)]}}function xl(t){var o=(t.expressionContext==="property"?pc:kl)(lr(t.value),t.valueSpec);if(o.result==="error")return o.value.map(function(v){return new Ue(""+t.key+v.key,t.value,v.message)});var u=o.value.expression||o.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!u.outputDefined())return[new Ue(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!il(u))return[new Ue(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!il(u))return[new Ue(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!is(u,["zoom","feature-state"]))return[new Ue(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Uu(u))return[new Ue(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ou(t){var o=t.key,u=t.value,v=t.valueSpec,y=[];return Array.isArray(v.values)?v.values.indexOf(Lr(u))===-1&&y.push(new Ue(o,u,"expected one of ["+v.values.join(", ")+"], "+JSON.stringify(u)+" found")):Object.keys(v.values).indexOf(Lr(u))===-1&&y.push(new Ue(o,u,"expected one of ["+Object.keys(v.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function Ll(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var o=0,u=t.slice(1);o<u.length;o+=1){var v=u[o];if(!Ll(v)&&typeof v!="boolean")return!1}return!0;default:return!0}}Hu.deserialize=function(t){return new Hu(t._parameters,t._specification)},Hu.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Bl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Wu(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};Ll(t)||(t=dc(t));var o=kl(t,Bl);if(o.result==="error")throw new Error(o.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,v,y){return o.value.evaluate(u,v,{},y)},needGeometry:function u(v){if(!Array.isArray(v))return!1;if(v[0]==="within")return!0;for(var y=1;y<v.length;y++)if(u(v[y]))return!0;return!1}(t)}}function Tf(t,o){return t<o?-1:t>o?1:0}function dc(t){if(!t)return!0;var o,u=t[0];return t.length<=1?u!=="any":u==="=="?rf(t[1],t[2],"=="):u==="!="?ec(rf(t[1],t[2],"==")):u==="<"||u===">"||u==="<="||u===">="?rf(t[1],t[2],u):u==="any"?(o=t.slice(1),["any"].concat(o.map(dc))):u==="all"?["all"].concat(t.slice(1).map(dc)):u==="none"?["all"].concat(t.slice(1).map(dc).map(ec)):u==="in"?vc(t[1],t.slice(2)):u==="!in"?ec(vc(t[1],t.slice(2))):u==="has"?nf(t[1]):u==="!has"?ec(nf(t[1])):u!=="within"||t}function rf(t,o,u){switch(t){case"$type":return["filter-type-"+u,o];case"$id":return["filter-id-"+u,o];default:return["filter-"+u,t,o]}}function vc(t,o){if(o.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(function(u){return typeof u!=typeof o[0]})?["filter-in-large",t,["literal",o.sort(Tf)]]:["filter-in-small",t,["literal",o]]}}function nf(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ec(t){return["!",t]}function mc(t){return Ll(lr(t.value))?xl(ue({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function o(u){var v=u.value,y=u.key;if(fo(v)!=="array")return[new Ue(y,v,"array expected, "+fo(v)+" found")];var b,T=u.styleSpec,I=[];if(v.length<1)return[new Ue(y,v,"filter array must have at least 1 element")];switch(I=I.concat(Ou({key:y+"[0]",value:v[0],valueSpec:T.filter_operator,style:u.style,styleSpec:u.styleSpec})),Lr(v[0])){case"<":case"<=":case">":case">=":v.length>=2&&Lr(v[1])==="$type"&&I.push(new Ue(y,v,'"$type" cannot be use with operator "'+v[0]+'"'));case"==":case"!=":v.length!==3&&I.push(new Ue(y,v,'filter array for operator "'+v[0]+'" must have 3 elements'));case"in":case"!in":v.length>=2&&(b=fo(v[1]))!=="string"&&I.push(new Ue(y+"[1]",v[1],"string expected, "+b+" found"));for(var Z=2;Z<v.length;Z++)b=fo(v[Z]),Lr(v[1])==="$type"?I=I.concat(Ou({key:y+"["+Z+"]",value:v[Z],valueSpec:T.geometry_type,style:u.style,styleSpec:u.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&I.push(new Ue(y+"["+Z+"]",v[Z],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var he=1;he<v.length;he++)I=I.concat(o({key:y+"["+he+"]",value:v[he],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=fo(v[1]),v.length!==2?I.push(new Ue(y,v,'filter array for "'+v[0]+'" operator must have 2 elements')):b!=="string"&&I.push(new Ue(y+"[1]",v[1],"string expected, "+b+" found"));break;case"within":b=fo(v[1]),v.length!==2?I.push(new Ue(y,v,'filter array for "'+v[0]+'" operator must have 2 elements')):b!=="object"&&I.push(new Ue(y+"[1]",v[1],"object expected, "+b+" found"))}return I}(t)}function Gs(t,o){var u=t.key,v=t.style,y=t.styleSpec,b=t.value,T=t.objectKey,I=y[o+"_"+t.layerType];if(!I)return[];var Z=T.match(/^(.*)-transition$/);if(o==="paint"&&Z&&I[Z[1]]&&I[Z[1]].transition)return Ca({key:u,value:b,valueSpec:y.transition,style:v,styleSpec:y});var he,_e=t.valueSpec||I[T];if(!_e)return[new Ue(u,b,'unknown property "'+T+'"')];if(fo(b)==="string"&&ru(_e)&&!_e.tokens&&(he=/^{([^}]+)}$/.exec(b)))return[new Ue(u,b,'"'+T+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(he[1])+" }`.")];var Ae=[];return t.layerType==="symbol"&&(T==="text-field"&&v&&!v.glyphs&&Ae.push(new Ue(u,b,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Ru(lr(b))&&Lr(b.type)==="identity"&&Ae.push(new Ue(u,b,'"text-font" does not support identity functions'))),Ae.concat(Ca({key:t.key,value:b,valueSpec:_e,style:v,styleSpec:y,expressionContext:"property",propertyType:o,propertyKey:T}))}function du(t){return Gs(t,"paint")}function as(t){return Gs(t,"layout")}function Dc(t){var o=[],u=t.value,v=t.key,y=t.style,b=t.styleSpec;u.type||u.ref||o.push(new Ue(v,u,'either "type" or "ref" is required'));var T,I=Lr(u.type),Z=Lr(u.ref);if(u.id)for(var he=Lr(u.id),_e=0;_e<t.arrayIndex;_e++){var Ae=y.layers[_e];Lr(Ae.id)===he&&o.push(new Ue(v,u.id,'duplicate layer id "'+u.id+'", previously used at line '+Ae.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(Tt){Tt in u&&o.push(new Ue(v,u[Tt],'"'+Tt+'" is prohibited for ref layers'))}),y.layers.forEach(function(Tt){Lr(Tt.id)===Z&&(T=Tt)}),T?T.ref?o.push(new Ue(v,u.ref,"ref cannot reference another ref layer")):I=Lr(T.type):o.push(new Ue(v,u.ref,'ref layer "'+Z+'" not found'));else if(I!=="background")if(u.source){var je=y.sources&&y.sources[u.source],Je=je&&Lr(je.type);je?Je==="vector"&&I==="raster"?o.push(new Ue(v,u.source,'layer "'+u.id+'" requires a raster source')):Je==="raster"&&I!=="raster"?o.push(new Ue(v,u.source,'layer "'+u.id+'" requires a vector source')):Je!=="vector"||u["source-layer"]?Je==="raster-dem"&&I!=="hillshade"?o.push(new Ue(v,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!u.paint||!u.paint["line-gradient"]||Je==="geojson"&&je.lineMetrics||o.push(new Ue(v,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):o.push(new Ue(v,u,'layer "'+u.id+'" must specify a "source-layer"')):o.push(new Ue(v,u.source,'source "'+u.source+'" not found'))}else o.push(new Ue(v,u,'missing required property "source"'));return o=o.concat(Rs({key:v,value:u,valueSpec:b.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ca({key:v+".type",value:u.type,valueSpec:b.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:mc,layout:function(Tt){return Rs({layer:u,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(wt){return as(ue({layerType:I},wt))}}})},paint:function(Tt){return Rs({layer:u,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(wt){return du(ue({layerType:I},wt))}}})}}}))}function bl(t){var o=t.value,u=t.key,v=fo(o);return v!=="string"?[new Ue(u,o,"string expected, "+v+" found")]:[]}var uo={promoteId:function(t){var o=t.key,u=t.value;if(fo(u)==="string")return bl({key:o,value:u});var v=[];for(var y in u)v.push.apply(v,bl({key:o+"."+y,value:u[y]}));return v}};function Lc(t){var o=t.value,u=t.key,v=t.styleSpec,y=t.style;if(!o.type)return[new Ue(u,o,'"type" is required')];var b,T=Lr(o.type);switch(T){case"vector":case"raster":case"raster-dem":return Rs({key:u,value:o,valueSpec:v["source_"+T.replace("-","_")],style:t.style,styleSpec:v,objectElementValidators:uo});case"geojson":if(b=Rs({key:u,value:o,valueSpec:v.source_geojson,style:y,styleSpec:v,objectElementValidators:uo}),o.cluster)for(var I in o.clusterProperties){var Z=o.clusterProperties[I],he=Z[0],_e=typeof he=="string"?[he,["accumulated"],["get",I]]:he;b.push.apply(b,xl({key:u+"."+I+".map",value:Z[1],expressionContext:"cluster-map"})),b.push.apply(b,xl({key:u+"."+I+".reduce",value:_e,expressionContext:"cluster-reduce"}))}return b;case"video":return Rs({key:u,value:o,valueSpec:v.source_video,style:y,styleSpec:v});case"image":return Rs({key:u,value:o,valueSpec:v.source_image,style:y,styleSpec:v});case"canvas":return[new Ue(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ou({key:u+".type",value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:v})}}function Vs(t){var o=t.value,u=t.styleSpec,v=u.light,y=t.style,b=[],T=fo(o);if(o===void 0)return b;if(T!=="object")return b.concat([new Ue("light",o,"object expected, "+T+" found")]);for(var I in o){var Z=I.match(/^(.*)-transition$/);b=b.concat(Z&&v[Z[1]]&&v[Z[1]].transition?Ca({key:I,value:o[I],valueSpec:u.transition,style:y,styleSpec:u}):v[I]?Ca({key:I,value:o[I],valueSpec:v[I],style:y,styleSpec:u}):[new Ue(I,o[I],'unknown property "'+I+'"')])}return b}var ul={"*":function(){return[]},array:ef,boolean:function(t){var o=t.value,u=t.key,v=fo(o);return v!=="boolean"?[new Ue(u,o,"boolean expected, "+v+" found")]:[]},number:kc,color:function(t){var o=t.key,u=t.value,v=fo(u);return v!=="string"?[new Ue(o,u,"color expected, "+v+" found")]:zi(u)===null?[new Ue(o,u,'color expected, "'+u+'" found')]:[]},constants:vt,enum:Ou,filter:mc,function:tf,layer:Dc,object:Rs,source:Lc,light:Vs,string:bl,formatted:function(t){return bl(t).length===0?[]:xl(t)},resolvedImage:function(t){return bl(t).length===0?[]:xl(t)}};function Ca(t){var o=t.value,u=t.valueSpec,v=t.styleSpec;return u.expression&&Ru(Lr(o))?tf(t):u.expression&&ju(lr(o))?xl(t):u.type&&ul[u.type]?ul[u.type](t):Rs(ue({},t,{valueSpec:u.type?v[u.type]:u}))}function lo(t){var o=t.value,u=t.key,v=bl(t);return v.length||(o.indexOf("{fontstack}")===-1&&v.push(new Ue(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&v.push(new Ue(u,o,'"glyphs" url must include a "{range}" token'))),v}function Xs(t,o){o===void 0&&(o=Ne);var u=[];return u=u.concat(Ca({key:"",value:t,valueSpec:o.$root,styleSpec:o,style:t,objectElementValidators:{glyphs:lo,"*":function(){return[]}}})),t.constants&&(u=u.concat(vt({key:"constants",value:t.constants,style:t,styleSpec:o}))),gc(u)}function gc(t){return[].concat(t).sort(function(o,u){return o.line-u.line})}function Gu(t){return function(){for(var o=[],u=arguments.length;u--;)o[u]=arguments[u];return gc(t.apply(this,o))}}Xs.source=Gu(Lc),Xs.light=Gu(Vs),Xs.layer=Gu(Dc),Xs.filter=Gu(mc),Xs.paintProperty=Gu(du),Xs.layoutProperty=Gu(as);var vu=Xs,Af=vu.light,Bc=vu.paintProperty,yc=vu.layoutProperty;function Fl(t,o){var u=!1;if(o&&o.length)for(var v=0,y=o;v<y.length;v+=1)t.fire(new ft(new Error(y[v].message))),u=!0;return u}var os=So;function So(t,o,u){var v=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(o=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var T=y[3+b],I=y[3+b+1];v.push(T===I?null:y.subarray(T,I))}var Z=y[3+v.length+1];this.keys=y.subarray(y[3+v.length],Z),this.bboxes=y.subarray(Z),this.insert=this._insertReadonly}else{this.d=o+2*u;for(var he=0;he<this.d*this.d;he++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=u,this.scale=o/t,this.uid=0;var _e=u/o*t;this.min=-_e,this.max=t+_e}So.prototype.insert=function(t,o,u,v,y){this._forEachCell(o,u,v,y,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(v),this.bboxes.push(y)},So.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},So.prototype._insertCell=function(t,o,u,v,y,b){this.cells[y].push(b)},So.prototype.query=function(t,o,u,v,y){var b=this.min,T=this.max;if(t<=b&&o<=b&&T<=u&&T<=v&&!y)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(t,o,u,v,this._queryCell,I,{},y),I},So.prototype._queryCell=function(t,o,u,v,y,b,T,I){var Z=this.cells[y];if(Z!==null)for(var he=this.keys,_e=this.bboxes,Ae=0;Ae<Z.length;Ae++){var je=Z[Ae];if(T[je]===void 0){var Je=4*je;(I?I(_e[Je+0],_e[Je+1],_e[Je+2],_e[Je+3]):t<=_e[Je+2]&&o<=_e[Je+3]&&u>=_e[Je+0]&&v>=_e[Je+1])?(T[je]=!0,b.push(he[je])):T[je]=!1}}},So.prototype._forEachCell=function(t,o,u,v,y,b,T,I){for(var Z=this._convertToCellCoord(t),he=this._convertToCellCoord(o),_e=this._convertToCellCoord(u),Ae=this._convertToCellCoord(v),je=Z;je<=_e;je++)for(var Je=he;Je<=Ae;Je++){var Tt=this.d*Je+je;if((!I||I(this._convertFromCellCoord(je),this._convertFromCellCoord(Je),this._convertFromCellCoord(je+1),this._convertFromCellCoord(Je+1)))&&y.call(this,t,o,u,v,Tt,b,T,I))return}},So.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},So.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},So.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,o=3+this.cells.length+1+1,u=0,v=0;v<this.cells.length;v++)u+=this.cells[v].length;var y=new Int32Array(o+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=o,T=0;T<t.length;T++){var I=t[T];y[3+T]=b,y.set(I,b),b+=I.length}return y[3+t.length]=b,y.set(this.keys,b),y[3+t.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};var Nl=J.ImageData,af=J.ImageBitmap,wo={};function ii(t,o,u){u===void 0&&(u={}),Object.defineProperty(o,"_classRegistryKey",{value:t,writeable:!1}),wo[t]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}for(var Ms in ii("Object",Object),os.serialize=function(t,o){var u=t.toArrayBuffer();return o&&o.push(u),{buffer:u}},os.deserialize=function(t){return new os(t.buffer)},ii("Grid",os),ii("Color",Nr),ii("Error",Error),ii("ResolvedImage",Za),ii("StylePropertyFunction",Hu),ii("StyleExpression",pu,{omit:["_evaluator"]}),ii("ZoomDependentExpression",$u),ii("ZoomConstantExpression",Dl),ii("CompoundExpression",Va,{omit:["_evaluate"]}),fu)fu[Ms]._classRegistryKey||ii("Expression_"+Ms,fu[Ms]);function tc(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Ul(t){return af&&t instanceof af}function ps(t,o){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(tc(t)||Ul(t))return o&&o.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return o&&o.push(u.buffer),u}if(t instanceof Nl)return o&&o.push(t.data.buffer),t;if(Array.isArray(t)){for(var v=[],y=0,b=t;y<b.length;y+=1)v.push(ps(b[y],o));return v}if(typeof t=="object"){var T=t.constructor,I=T._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class");var Z=T.serialize?T.serialize(t,o):{};if(!T.serialize){for(var he in t)if(t.hasOwnProperty(he)&&!(wo[I].omit.indexOf(he)>=0)){var _e=t[he];Z[he]=wo[I].shallow.indexOf(he)>=0?_e:ps(_e,o)}t instanceof Error&&(Z.message=t.message)}if(Z.$name)throw new Error("$name property is reserved for worker serialization logic.");return I!=="Object"&&(Z.$name=I),Z}throw new Error("can't serialize object of type "+typeof t)}function to(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||tc(t)||Ul(t)||ArrayBuffer.isView(t)||t instanceof Nl)return t;if(Array.isArray(t))return t.map(to);if(typeof t=="object"){var o=t.$name||"Object",u=wo[o].klass;if(!u)throw new Error("can't deserialize unregistered class "+o);if(u.deserialize)return u.deserialize(t);for(var v=Object.create(u.prototype),y=0,b=Object.keys(t);y<b.length;y+=1){var T=b[y];if(T!=="$name"){var I=t[T];v[T]=wo[o].shallow.indexOf(T)>=0?I:to(I)}}return v}throw new Error("can't deserialize object of type "+typeof t)}var zl=function(){this.first=!0};zl.prototype.update=function(t,o){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var S={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Ge(t){for(var o=0,u=t;o<u.length;o+=1)if(re(u[o].charCodeAt(0)))return!0;return!1}function re(t){return!(t!==746&&t!==747&&(t<4352||!(S["Bopomofo Extended"](t)||S.Bopomofo(t)||S["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||S["CJK Compatibility Ideographs"](t)||S["CJK Compatibility"](t)||S["CJK Radicals Supplement"](t)||S["CJK Strokes"](t)||!(!S["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||S["CJK Unified Ideographs Extension A"](t)||S["CJK Unified Ideographs"](t)||S["Enclosed CJK Letters and Months"](t)||S["Hangul Compatibility Jamo"](t)||S["Hangul Jamo Extended-A"](t)||S["Hangul Jamo Extended-B"](t)||S["Hangul Jamo"](t)||S["Hangul Syllables"](t)||S.Hiragana(t)||S["Ideographic Description Characters"](t)||S.Kanbun(t)||S["Kangxi Radicals"](t)||S["Katakana Phonetic Extensions"](t)||S.Katakana(t)&&t!==12540||!(!S["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!S["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||S["Unified Canadian Aboriginal Syllabics"](t)||S["Unified Canadian Aboriginal Syllabics Extended"](t)||S["Vertical Forms"](t)||S["Yijing Hexagram Symbols"](t)||S["Yi Syllables"](t)||S["Yi Radicals"](t))))}function ce(t){return!(re(t)||function(o){return!!(S["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||S["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||S["Letterlike Symbols"](o)||S["Number Forms"](o)||S["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||S["Control Pictures"](o)&&o!==9251||S["Optical Character Recognition"](o)||S["Enclosed Alphanumerics"](o)||S["Geometric Shapes"](o)||S["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||S["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||S["CJK Symbols and Punctuation"](o)||S.Katakana(o)||S["Private Use Area"](o)||S["CJK Compatibility Forms"](o)||S["Small Form Variants"](o)||S["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(t))}function G(t){return t>=1424&&t<=2303||S["Arabic Presentation Forms-A"](t)||S["Arabic Presentation Forms-B"](t)}function xe(t,o){return!(!o&&G(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||S.Khmer(t))}function ut(t){for(var o=0,u=t;o<u.length;o+=1)if(G(u[o].charCodeAt(0)))return!0;return!1}var Dt=null,dt="unavailable",It=null,Tr=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(dt="error"),Dt&&Dt(t)};function Yr(){wn.fire(new Xe("pluginStateChange",{pluginStatus:dt,pluginURL:It}))}var wn=new Et,Bn=function(){return dt},Kn=function(){if(dt!=="deferred"||!It)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");dt="loading",Yr(),It&&ir({url:It},function(t){t?Tr(t):(dt="loaded",Yr())})},fi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return dt==="loaded"||fi.applyArabicShaping!=null},isLoading:function(){return dt==="loading"},setState:function(t){dt=t.pluginStatus,It=t.pluginURL},isParsed:function(){return fi.applyArabicShaping!=null&&fi.processBidirectionalText!=null&&fi.processStyledBidirectionalText!=null},getPluginURL:function(){return It}},Gr=function(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new zl,this.transition={})};Gr.prototype.isSupportedScript=function(t){return function(o,u){for(var v=0,y=o;v<y.length;v+=1)if(!xe(y[v].charCodeAt(0),u))return!1;return!0}(t,fi.isLoaded())},Gr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Gr.prototype.getCrossfadeParameters=function(){var t=this.zoom,o=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}};var Ri=function(t,o){this.property=t,this.value=o,this.expression=function(u,v){if(Ru(u))return new Hu(u,v);if(ju(u)){var y=pc(u,v);if(y.result==="error")throw new Error(y.value.map(function(T){return T.key+": "+T.message}).join(", "));return y.value}var b=u;return typeof u=="string"&&v.type==="color"&&(b=Nr.parse(u)),{kind:"constant",evaluate:function(){return b}}}(o===void 0?t.specification.default:o,t.specification)};Ri.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ri.prototype.possiblyEvaluate=function(t,o,u){return this.property.possiblyEvaluate(this,t,o,u)};var Pi=function(t){this.property=t,this.value=new Ri(t,void 0)};Pi.prototype.transitioned=function(t,o){return new wa(this.property,this.value,o,le({},t.transition,this.transition),t.now)},Pi.prototype.untransitioned=function(){return new wa(this.property,this.value,null,{},0)};var Mi=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Mi.prototype.getValue=function(t){return se(this._values[t].value.value)},Mi.prototype.setValue=function(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Pi(this._values[t].property)),this._values[t].value=new Ri(this._values[t].property,o===null?void 0:se(o))},Mi.prototype.getTransition=function(t){return se(this._values[t].transition)},Mi.prototype.setTransition=function(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Pi(this._values[t].property)),this._values[t].transition=se(o)||void 0},Mi.prototype.serialize=function(){for(var t={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],y=this.getValue(v);y!==void 0&&(t[v]=y);var b=this.getTransition(v);b!==void 0&&(t[v+"-transition"]=b)}return t},Mi.prototype.transitioned=function(t,o){for(var u=new Ja(this._properties),v=0,y=Object.keys(this._values);v<y.length;v+=1){var b=y[v];u._values[b]=this._values[b].transitioned(t,o._values[b])}return u},Mi.prototype.untransitioned=function(){for(var t=new Ja(this._properties),o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o];t._values[v]=this._values[v].untransitioned()}return t};var wa=function(t,o,u,v,y){this.property=t,this.value=o,this.begin=y+v.delay||0,this.end=this.begin+v.duration||0,t.specification.transition&&(v.delay||v.duration)&&(this.prior=u)};wa.prototype.possiblyEvaluate=function(t,o,u){var v=t.now||0,y=this.value.possiblyEvaluate(t,o,u),b=this.prior;if(b){if(v>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(v<this.begin)return b.possiblyEvaluate(t,o,u);var T=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(t,o,u),y,function(I){if(I<=0)return 0;if(I>=1)return 1;var Z=I*I,he=Z*I;return 4*(I<.5?he:3*(I-Z)+he-.75)}(T))}return y};var Ja=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Ja.prototype.possiblyEvaluate=function(t,o,u){for(var v=new Gi(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var T=b[y];v._values[T]=this._values[T].possiblyEvaluate(t,o,u)}return v},Ja.prototype.hasTransition=function(){for(var t=0,o=Object.keys(this._values);t<o.length;t+=1)if(this._values[o[t]].prior)return!0;return!1};var La=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};La.prototype.getValue=function(t){return se(this._values[t].value)},La.prototype.setValue=function(t,o){this._values[t]=new Ri(this._values[t].property,o===null?void 0:se(o))},La.prototype.serialize=function(){for(var t={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],y=this.getValue(v);y!==void 0&&(t[v]=y)}return t},La.prototype.possiblyEvaluate=function(t,o,u){for(var v=new Gi(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var T=b[y];v._values[T]=this._values[T].possiblyEvaluate(t,o,u)}return v};var ya=function(t,o,u){this.property=t,this.value=o,this.parameters=u};ya.prototype.isConstant=function(){return this.value.kind==="constant"},ya.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},ya.prototype.evaluate=function(t,o,u,v){return this.property.evaluate(this.value,this.parameters,t,o,u,v)};var Gi=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Gi.prototype.get=function(t){return this._values[t]};var zn=function(t){this.specification=t};zn.prototype.possiblyEvaluate=function(t,o){return t.expression.evaluate(o)},zn.prototype.interpolate=function(t,o,u){var v=Hi[this.specification.type];return v?v(t,o,u):t};var Fn=function(t,o){this.specification=t,this.overrides=o};Fn.prototype.possiblyEvaluate=function(t,o,u,v){return new ya(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},u,v)}:t.expression,o)},Fn.prototype.interpolate=function(t,o,u){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ya(this,{kind:"constant",value:void 0},t.parameters);var v=Hi[this.specification.type];return v?new ya(this,{kind:"constant",value:v(t.value.value,o.value.value,u)},t.parameters):t},Fn.prototype.evaluate=function(t,o,u,v,y,b){return t.kind==="constant"?t.value:t.evaluate(o,u,v,y,b)};var $a=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v,y,b){if(u.value===void 0)return new ya(this,{kind:"constant",value:void 0},v);if(u.expression.kind==="constant"){var T=u.expression.evaluate(v,null,{},y,b),I=u.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,Z=this._calculate(I,I,I,v);return new ya(this,{kind:"constant",value:Z},v)}if(u.expression.kind==="camera"){var he=this._calculate(u.expression.evaluate({zoom:v.zoom-1}),u.expression.evaluate({zoom:v.zoom}),u.expression.evaluate({zoom:v.zoom+1}),v);return new ya(this,{kind:"constant",value:he},v)}return new ya(this,u.expression,v)},o.prototype.evaluate=function(u,v,y,b,T,I){if(u.kind==="source"){var Z=u.evaluate(v,y,b,T,I);return this._calculate(Z,Z,Z,v)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(v.zoom)-1},y,b),u.evaluate({zoom:Math.floor(v.zoom)},y,b),u.evaluate({zoom:Math.floor(v.zoom)+1},y,b),v):u.value},o.prototype._calculate=function(u,v,y,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:u,to:v}:{from:y,to:v}},o.prototype.interpolate=function(u){return u},o}(Fn),_a=function(t){this.specification=t};_a.prototype.possiblyEvaluate=function(t,o,u,v){if(t.value!==void 0){if(t.expression.kind==="constant"){var y=t.expression.evaluate(o,null,{},u,v);return this._calculate(y,y,y,o)}return this._calculate(t.expression.evaluate(new Gr(Math.floor(o.zoom-1),o)),t.expression.evaluate(new Gr(Math.floor(o.zoom),o)),t.expression.evaluate(new Gr(Math.floor(o.zoom+1),o)),o)}},_a.prototype._calculate=function(t,o,u,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:u,to:o}},_a.prototype.interpolate=function(t){return t};var Ra=function(t){this.specification=t};Ra.prototype.possiblyEvaluate=function(t,o,u,v){return!!t.expression.evaluate(o,null,{},u,v)},Ra.prototype.interpolate=function(){return!1};var Ma=function(t){for(var o in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[o];u.specification.overridable&&this.overridableProperties.push(o);var v=this.defaultPropertyValues[o]=new Ri(u,void 0),y=this.defaultTransitionablePropertyValues[o]=new Pi(u);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=v.possiblyEvaluate({})}};ii("DataDrivenProperty",Fn),ii("DataConstantProperty",zn),ii("CrossFadedDataDrivenProperty",$a),ii("CrossFadedProperty",_a),ii("ColorRampProperty",Ra);var da=function(t){function o(u,v){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},u.type!=="custom"&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),v.layout&&(this._unevaluatedLayout=new La(v.layout)),v.paint)){for(var y in this._transitionablePaint=new Mi(v.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var b in u.layout)this.setLayoutProperty(b,u.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gi(v.paint)}}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},o.prototype.getLayoutProperty=function(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)},o.prototype.setLayoutProperty=function(u,v,y){y===void 0&&(y={}),v!=null&&this._validate(yc,"layers."+this.id+".layout."+u,u,v,y)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,v):this.visibility=v)},o.prototype.getPaintProperty=function(u){return We(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},o.prototype.setPaintProperty=function(u,v,y){if(y===void 0&&(y={}),v!=null&&this._validate(Bc,"layers."+this.id+".paint."+u,u,v,y))return!1;if(We(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),v||void 0),!1;var b=this._transitionablePaint._values[u],T=b.property.specification["property-type"]==="cross-faded-data-driven",I=b.value.isDataDriven(),Z=b.value;this._transitionablePaint.setValue(u,v),this._handleSpecialPaintPropertyUpdate(u);var he=this._transitionablePaint._values[u].value;return he.isDataDriven()||I||T||this._handleOverridablePaintPropertyUpdate(u,Z,he)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,y){return!1},o.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"},o.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},o.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},o.prototype.recalculate=function(u,v){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,v)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,v)},o.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),pe(u,function(v,y){return!(v===void 0||y==="layout"&&!Object.keys(v).length||y==="paint"&&!Object.keys(v).length)})},o.prototype._validate=function(u,v,y,b,T){return T===void 0&&(T={}),(!T||T.validate!==!1)&&Fl(this,u.call(vu,{key:v,layerType:this.type,objectKey:y,value:b,styleSpec:Ne,style:{glyphs:!0,sprite:!0}}))},o.prototype.is3D=function(){return!1},o.prototype.isTileClipped=function(){return!1},o.prototype.hasOffscreenPass=function(){return!1},o.prototype.resize=function(){},o.prototype.isStateDependent=function(){for(var u in this.paint._values){var v=this.paint.get(u);if(v instanceof ya&&ru(v.property.specification)&&(v.value.kind==="source"||v.value.kind==="composite")&&v.value.isStateDependent)return!0}return!1},o}(Et),qo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Xu=function(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ha=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function mo(t,o){o===void 0&&(o=1);var u=0,v=0;return{members:t.map(function(y){var b=qo[y.type].BYTES_PER_ELEMENT,T=u=Fc(u,Math.max(o,b)),I=y.components||1;return v=Math.max(v,b),u+=b*I,{name:y.name,type:y.type,components:I,offset:T}}),size:Fc(u,Math.max(v,o)),alignment:o}}function Fc(t,o){return Math.ceil(t/o)*o}ha.serialize=function(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},ha.deserialize=function(t){var o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o},ha.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ha.prototype.clear=function(){this.length=0},ha.prototype.resize=function(t){this.reserve(t),this.length=t},ha.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}},ha.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var nu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var b=2*u;return this.int16[b+0]=v,this.int16[b+1]=y,u},o}(ha);nu.prototype.bytesPerElement=4,ii("StructArrayLayout2i4",nu);var Cf=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b){var T=this.length;return this.resize(T+1),this.emplace(T,u,v,y,b)},o.prototype.emplace=function(u,v,y,b,T){var I=4*u;return this.int16[I+0]=v,this.int16[I+1]=y,this.int16[I+2]=b,this.int16[I+3]=T,u},o}(ha);Cf.prototype.bytesPerElement=8,ii("StructArrayLayout4i8",Cf);var Zl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I){var Z=this.length;return this.resize(Z+1),this.emplace(Z,u,v,y,b,T,I)},o.prototype.emplace=function(u,v,y,b,T,I,Z){var he=6*u;return this.int16[he+0]=v,this.int16[he+1]=y,this.int16[he+2]=b,this.int16[he+3]=T,this.int16[he+4]=I,this.int16[he+5]=Z,u},o}(ha);Zl.prototype.bytesPerElement=12,ii("StructArrayLayout2i4i12",Zl);var Os=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I){var Z=this.length;return this.resize(Z+1),this.emplace(Z,u,v,y,b,T,I)},o.prototype.emplace=function(u,v,y,b,T,I,Z){var he=4*u,_e=8*u;return this.int16[he+0]=v,this.int16[he+1]=y,this.uint8[_e+4]=b,this.uint8[_e+5]=T,this.uint8[_e+6]=I,this.uint8[_e+7]=Z,u},o}(ha);Os.prototype.bytesPerElement=8,ii("StructArrayLayout2i4ub8",Os);var rc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var b=2*u;return this.float32[b+0]=v,this.float32[b+1]=y,u},o}(ha);rc.prototype.bytesPerElement=8,ii("StructArrayLayout2f8",rc);var Vl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I,Z,he,_e,Ae){var je=this.length;return this.resize(je+1),this.emplace(je,u,v,y,b,T,I,Z,he,_e,Ae)},o.prototype.emplace=function(u,v,y,b,T,I,Z,he,_e,Ae,je){var Je=10*u;return this.uint16[Je+0]=v,this.uint16[Je+1]=y,this.uint16[Je+2]=b,this.uint16[Je+3]=T,this.uint16[Je+4]=I,this.uint16[Je+5]=Z,this.uint16[Je+6]=he,this.uint16[Je+7]=_e,this.uint16[Je+8]=Ae,this.uint16[Je+9]=je,u},o}(ha);Vl.prototype.bytesPerElement=20,ii("StructArrayLayout10ui20",Vl);var $f=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je){var Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,u,v,y,b,T,I,Z,he,_e,Ae,je,Je)},o.prototype.emplace=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt){var wt=12*u;return this.int16[wt+0]=v,this.int16[wt+1]=y,this.int16[wt+2]=b,this.int16[wt+3]=T,this.uint16[wt+4]=I,this.uint16[wt+5]=Z,this.uint16[wt+6]=he,this.uint16[wt+7]=_e,this.int16[wt+8]=Ae,this.int16[wt+9]=je,this.int16[wt+10]=Je,this.int16[wt+11]=Tt,u},o}(ha);$f.prototype.bytesPerElement=24,ii("StructArrayLayout4i4ui4i24",$f);var ll=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,v,y)},o.prototype.emplace=function(u,v,y,b){var T=3*u;return this.float32[T+0]=v,this.float32[T+1]=y,this.float32[T+2]=b,u},o}(ha);ll.prototype.bytesPerElement=12,ii("StructArrayLayout3f12",ll);var El=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint32[1*u+0]=v,u},o}(ha);El.prototype.bytesPerElement=4,ii("StructArrayLayout1ul4",El);var jl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I,Z,he,_e){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,v,y,b,T,I,Z,he,_e)},o.prototype.emplace=function(u,v,y,b,T,I,Z,he,_e,Ae){var je=10*u,Je=5*u;return this.int16[je+0]=v,this.int16[je+1]=y,this.int16[je+2]=b,this.int16[je+3]=T,this.int16[je+4]=I,this.int16[je+5]=Z,this.uint32[Je+3]=he,this.uint16[je+8]=_e,this.uint16[je+9]=Ae,u},o}(ha);jl.prototype.bytesPerElement=20,ii("StructArrayLayout6i1ul2ui20",jl);var cl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I){var Z=this.length;return this.resize(Z+1),this.emplace(Z,u,v,y,b,T,I)},o.prototype.emplace=function(u,v,y,b,T,I,Z){var he=6*u;return this.int16[he+0]=v,this.int16[he+1]=y,this.int16[he+2]=b,this.int16[he+3]=T,this.int16[he+4]=I,this.int16[he+5]=Z,u},o}(ha);cl.prototype.bytesPerElement=12,ii("StructArrayLayout2i2i2i12",cl);var fl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T){var I=this.length;return this.resize(I+1),this.emplace(I,u,v,y,b,T)},o.prototype.emplace=function(u,v,y,b,T,I){var Z=4*u,he=8*u;return this.float32[Z+0]=v,this.float32[Z+1]=y,this.float32[Z+2]=b,this.int16[he+6]=T,this.int16[he+7]=I,u},o}(ha);fl.prototype.bytesPerElement=16,ii("StructArrayLayout2f1f2i16",fl);var _c=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b){var T=this.length;return this.resize(T+1),this.emplace(T,u,v,y,b)},o.prototype.emplace=function(u,v,y,b,T){var I=12*u,Z=3*u;return this.uint8[I+0]=v,this.uint8[I+1]=y,this.float32[Z+1]=b,this.float32[Z+2]=T,u},o}(ha);_c.prototype.bytesPerElement=12,ii("StructArrayLayout2ub2f12",_c);var Ui=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,v,y)},o.prototype.emplace=function(u,v,y,b){var T=3*u;return this.uint16[T+0]=v,this.uint16[T+1]=y,this.uint16[T+2]=b,u},o}(ha);Ui.prototype.bytesPerElement=6,ii("StructArrayLayout3ui6",Ui);var mu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or){var dr=this.length;return this.resize(dr+1),this.emplace(dr,u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or)},o.prototype.emplace=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or,dr){var Ar=24*u,kr=12*u,en=48*u;return this.int16[Ar+0]=v,this.int16[Ar+1]=y,this.uint16[Ar+2]=b,this.uint16[Ar+3]=T,this.uint32[kr+2]=I,this.uint32[kr+3]=Z,this.uint32[kr+4]=he,this.uint16[Ar+10]=_e,this.uint16[Ar+11]=Ae,this.uint16[Ar+12]=je,this.float32[kr+7]=Je,this.float32[kr+8]=Tt,this.uint8[en+36]=wt,this.uint8[en+37]=Wt,this.uint8[en+38]=zt,this.uint32[kr+10]=or,this.int16[Ar+22]=dr,u},o}(ha);mu.prototype.bytesPerElement=48,ii("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",mu);var wf=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or,dr,Ar,kr,en,kn,Hn,Ci,oi,Li,si,ma){var Ki=this.length;return this.resize(Ki+1),this.emplace(Ki,u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or,dr,Ar,kr,en,kn,Hn,Ci,oi,Li,si,ma)},o.prototype.emplace=function(u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt,Wt,zt,or,dr,Ar,kr,en,kn,Hn,Ci,oi,Li,si,ma,Ki){var xi=34*u,Aa=17*u;return this.int16[xi+0]=v,this.int16[xi+1]=y,this.int16[xi+2]=b,this.int16[xi+3]=T,this.int16[xi+4]=I,this.int16[xi+5]=Z,this.int16[xi+6]=he,this.int16[xi+7]=_e,this.uint16[xi+8]=Ae,this.uint16[xi+9]=je,this.uint16[xi+10]=Je,this.uint16[xi+11]=Tt,this.uint16[xi+12]=wt,this.uint16[xi+13]=Wt,this.uint16[xi+14]=zt,this.uint16[xi+15]=or,this.uint16[xi+16]=dr,this.uint16[xi+17]=Ar,this.uint16[xi+18]=kr,this.uint16[xi+19]=en,this.uint16[xi+20]=kn,this.uint16[xi+21]=Hn,this.uint16[xi+22]=Ci,this.uint32[Aa+12]=oi,this.float32[Aa+13]=Li,this.float32[Aa+14]=si,this.float32[Aa+15]=ma,this.float32[Aa+16]=Ki,u},o}(ha);wf.prototype.bytesPerElement=68,ii("StructArrayLayout8i15ui1ul4f68",wf);var To=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.float32[1*u+0]=v,u},o}(ha);To.prototype.bytesPerElement=4,ii("StructArrayLayout1f4",To);var ho=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,v,y)},o.prototype.emplace=function(u,v,y,b){var T=3*u;return this.int16[T+0]=v,this.int16[T+1]=y,this.int16[T+2]=b,u},o}(ha);ho.prototype.bytesPerElement=6,ii("StructArrayLayout3i6",ho);var Yu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,v,y)},o.prototype.emplace=function(u,v,y,b){var T=4*u;return this.uint32[2*u+0]=v,this.uint16[T+2]=y,this.uint16[T+3]=b,u},o}(ha);Yu.prototype.bytesPerElement=8,ii("StructArrayLayout1ul2ui8",Yu);var $l=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var b=2*u;return this.uint16[b+0]=v,this.uint16[b+1]=y,u},o}(ha);$l.prototype.bytesPerElement=4,ii("StructArrayLayout2ui4",$l);var gu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint16[1*u+0]=v,u},o}(ha);gu.prototype.bytesPerElement=2,ii("StructArrayLayout1ui2",gu);var Hl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,b){var T=this.length;return this.resize(T+1),this.emplace(T,u,v,y,b)},o.prototype.emplace=function(u,v,y,b,T){var I=4*u;return this.float32[I+0]=v,this.float32[I+1]=y,this.float32[I+2]=b,this.float32[I+3]=T,u},o}(ha);Hl.prototype.bytesPerElement=16,ii("StructArrayLayout4f16",Hl);var l=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new W(this.anchorPointX,this.anchorPointY)},Object.defineProperties(o.prototype,u),o}(Xu);l.prototype.size=20;var p=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new l(this,u)},o}(jl);ii("CollisionBoxArray",p);var f=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(v){this._structArray.uint8[this._pos1+37]=v},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(v){this._structArray.uint8[this._pos1+38]=v},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+10]=v},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(o.prototype,u),o}(Xu);f.prototype.size=48;var m=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new f(this,u)},o}(mu);ii("PlacedSymbolArray",m);var E=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+12]=v},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(o.prototype,u),o}(Xu);E.prototype.size=68;var R=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new E(this,u)},o}(wf);ii("SymbolInstanceArray",R);var O=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getoffsetX=function(u){return this.float32[1*u+0]},o}(To);ii("GlyphOffsetArray",O);var $=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getx=function(u){return this.int16[3*u+0]},o.prototype.gety=function(u){return this.int16[3*u+1]},o.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},o}(ho);ii("SymbolLineVertexArray",$);var ge=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(o.prototype,u),o}(Xu);ge.prototype.size=8;var Me=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new ge(this,u)},o}(Yu);ii("FeatureIndexArray",Me);var Ye=mo([{name:"a_pos",components:2,type:"Int16"}],4).members,tt=function(t){t===void 0&&(t=[]),this.segments=t};function ot(t,o){return 256*(t=U(Math.floor(t),0,255))+U(Math.floor(o),0,255)}tt.prototype.prepareSegment=function(t,o,u,v){var y=this.segments[this.segments.length-1];return t>tt.MAX_VERTEX_ARRAY_LENGTH&&Te("Max vertices per segment is "+tt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!y||y.vertexLength+t>tt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==v)&&(y={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},v!==void 0&&(y.sortKey=v),this.segments.push(y)),y},tt.prototype.get=function(){return this.segments},tt.prototype.destroy=function(){for(var t=0,o=this.segments;t<o.length;t+=1){var u=o[t];for(var v in u.vaos)u.vaos[v].destroy()}},tt.simpleSegment=function(t,o,u,v){return new tt([{vertexOffset:t,primitiveOffset:o,vertexLength:u,primitiveLength:v,vaos:{},sortKey:0}])},tt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ii("SegmentVector",tt);var At=mo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),St=D(function(t){t.exports=function(o,u){var v,y,b,T,I,Z,he,_e;for(y=o.length-(v=3&o.length),b=u,I=3432918353,Z=461845907,_e=0;_e<y;)he=255&o.charCodeAt(_e)|(255&o.charCodeAt(++_e))<<8|(255&o.charCodeAt(++_e))<<16|(255&o.charCodeAt(++_e))<<24,++_e,b=27492+(65535&(T=5*(65535&(b=(b^=he=(65535&(he=(he=(65535&he)*I+(((he>>>16)*I&65535)<<16)&4294967295)<<15|he>>>17))*Z+(((he>>>16)*Z&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(he=0,v){case 3:he^=(255&o.charCodeAt(_e+2))<<16;case 2:he^=(255&o.charCodeAt(_e+1))<<8;case 1:b^=he=(65535&(he=(he=(65535&(he^=255&o.charCodeAt(_e)))*I+(((he>>>16)*I&65535)<<16)&4294967295)<<15|he>>>17))*Z+(((he>>>16)*Z&65535)<<16)&4294967295}return b^=o.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),Zt=D(function(t){t.exports=function(o,u){for(var v,y=o.length,b=u^y,T=0;y>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(T)|(255&o.charCodeAt(++T))<<8|(255&o.charCodeAt(++T))<<16|(255&o.charCodeAt(++T))<<24))+((1540483477*(v>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),y-=4,++T;switch(y){case 3:b^=(255&o.charCodeAt(T+2))<<16;case 2:b^=(255&o.charCodeAt(T+1))<<8;case 1:b=1540483477*(65535&(b^=255&o.charCodeAt(T)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),_t=St,Vt=Zt;_t.murmur3=St,_t.murmur2=Vt;var er=function(){this.ids=[],this.positions=[],this.indexed=!1};er.prototype.add=function(t,o,u,v){this.ids.push(Rr(t)),this.positions.push(o,u,v)},er.prototype.getPositions=function(t){for(var o=Rr(t),u=0,v=this.ids.length-1;u<v;){var y=u+v>>1;this.ids[y]>=o?v=y:u=y+1}for(var b=[];this.ids[u]===o;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b},er.serialize=function(t,o){var u=new Float64Array(t.ids),v=new Uint32Array(t.positions);return function y(b,T,I,Z){for(;I<Z;){for(var he=b[I+Z>>1],_e=I-1,Ae=Z+1;;){do _e++;while(b[_e]<he);do Ae--;while(b[Ae]>he);if(_e>=Ae)break;Er(b,_e,Ae),Er(T,3*_e,3*Ae),Er(T,3*_e+1,3*Ae+1),Er(T,3*_e+2,3*Ae+2)}Ae-I<Z-Ae?(y(b,T,I,Ae),I=Ae+1):(y(b,T,Ae+1,Z),Z=Ae)}}(u,v,0,u.length-1),o&&o.push(u.buffer,v.buffer),{ids:u,positions:v}},er.deserialize=function(t){var o=new er;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o};var cr=Math.pow(2,53)-1;function Rr(t){var o=+t;return!isNaN(o)&&o<=cr?o:_t(String(t))}function Er(t,o,u){var v=t[o];t[o]=t[u],t[u]=v}ii("FeaturePositionMap",er);var Br=function(t,o){this.gl=t.gl,this.location=o},tn=function(t){function o(u,v){t.call(this,u,v),this.current=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},o}(Br),M=function(t){function o(u,v){t.call(this,u,v),this.current=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},o}(Br),k=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},o}(Br),L=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},o}(Br),K=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0,0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},o}(Br),ie=function(t){function o(u,v){t.call(this,u,v),this.current=Nr.transparent}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},o}(Br),ne=new Float32Array(16),nt=function(t){function o(u,v){t.call(this,u,v),this.current=ne}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var v=1;v<16;v++)if(u[v]!==this.current[v]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},o}(Br);function rt(t){return[ot(255*t.r,255*t.g),ot(255*t.b,255*t.a)]}var jt=function(t,o,u){this.value=t,this.uniformNames=o.map(function(v){return"u_"+v}),this.type=u};jt.prototype.setUniform=function(t,o,u){t.set(u.constantOr(this.value))},jt.prototype.getBinding=function(t,o,u){return this.type==="color"?new ie(t,o):new M(t,o)};var ct=function(t,o){this.uniformNames=o.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ct.prototype.setConstantPatternPositions=function(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr},ct.prototype.setUniform=function(t,o,u,v){var y=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)},ct.prototype.getBinding=function(t,o,u){return u.substr(0,9)==="u_pattern"?new K(t,o):new M(t,o)};var Yt=function(t,o,u,v){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(function(y){return{name:"a_"+y,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new v};Yt.prototype.populatePaintArray=function(t,o,u,v,y){var b=this.paintVertexArray.length,T=this.expression.evaluate(new Gr(0),o,{},v,[],y);this.paintVertexArray.resize(t),this._setPaintValue(b,t,T)},Yt.prototype.updatePaintArray=function(t,o,u,v){var y=this.expression.evaluate({zoom:0},u,v);this._setPaintValue(t,o,y)},Yt.prototype._setPaintValue=function(t,o,u){if(this.type==="color")for(var v=rt(u),y=t;y<o;y++)this.paintVertexArray.emplace(y,v[0],v[1]);else{for(var b=t;b<o;b++)this.paintVertexArray.emplace(b,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Yt.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Yt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ar=function(t,o,u,v,y,b){this.expression=t,this.uniformNames=o.map(function(T){return"u_"+T+"_t"}),this.type=u,this.useIntegerZoom=v,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(function(T){return{name:"a_"+T,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new b};ar.prototype.populatePaintArray=function(t,o,u,v,y){var b=this.expression.evaluate(new Gr(this.zoom),o,{},v,[],y),T=this.expression.evaluate(new Gr(this.zoom+1),o,{},v,[],y),I=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(I,t,b,T)},ar.prototype.updatePaintArray=function(t,o,u,v){var y=this.expression.evaluate({zoom:this.zoom},u,v),b=this.expression.evaluate({zoom:this.zoom+1},u,v);this._setPaintValue(t,o,y,b)},ar.prototype._setPaintValue=function(t,o,u,v){if(this.type==="color")for(var y=rt(u),b=rt(v),T=t;T<o;T++)this.paintVertexArray.emplace(T,y[0],y[1],b[0],b[1]);else{for(var I=t;I<o;I++)this.paintVertexArray.emplace(I,u,v);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(v))}},ar.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ar.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ar.prototype.setUniform=function(t,o){var u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=U(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(v)},ar.prototype.getBinding=function(t,o,u){return new M(t,o)};var fn=function(t,o,u,v,y,b){this.expression=t,this.type=o,this.useIntegerZoom=u,this.zoom=v,this.layerId=b,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y};fn.prototype.populatePaintArray=function(t,o,u){var v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(v,t,o.patterns&&o.patterns[this.layerId],u)},fn.prototype.updatePaintArray=function(t,o,u,v,y){this._setPaintValues(t,o,u.patterns&&u.patterns[this.layerId],y)},fn.prototype._setPaintValues=function(t,o,u,v){if(v&&u){var y=v[u.min],b=v[u.mid],T=v[u.max];if(y&&b&&T)for(var I=t;I<o;I++)this.zoomInPaintVertexArray.emplace(I,b.tl[0],b.tl[1],b.br[0],b.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],b.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,b.tl[0],b.tl[1],b.br[0],b.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],b.pixelRatio,T.pixelRatio)}},fn.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,At.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,At.members,this.expression.isStateDependent))},fn.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var on=function(t,o,u){this.binders={},this._buffers=[];var v=[];for(var y in t.paint._values)if(u(y)){var b=t.paint.get(y);if(b instanceof ya&&ru(b.property.specification)){var T=Gn(y,t.type),I=b.value,Z=b.property.specification.type,he=b.property.useIntegerZoom,_e=b.property.specification["property-type"],Ae=_e==="cross-faded"||_e==="cross-faded-data-driven";if(I.kind==="constant")this.binders[y]=Ae?new ct(I.value,T):new jt(I.value,T,Z),v.push("/u_"+y);else if(I.kind==="source"||Ae){var je=Zn(y,Z,"source");this.binders[y]=Ae?new fn(I,Z,he,o,je,t.id):new Yt(I,T,Z,je),v.push("/a_"+y)}else{var Je=Zn(y,Z,"composite");this.binders[y]=new ar(I,T,Z,he,o,Je),v.push("/z_"+y)}}}this.cacheKey=v.sort().join("")};on.prototype.getMaxValue=function(t){var o=this.binders[t];return o instanceof Yt||o instanceof ar?o.maxValue:0},on.prototype.populatePaintArrays=function(t,o,u,v,y){for(var b in this.binders){var T=this.binders[b];(T instanceof Yt||T instanceof ar||T instanceof fn)&&T.populatePaintArray(t,o,u,v,y)}},on.prototype.setConstantPatternPositions=function(t,o){for(var u in this.binders){var v=this.binders[u];v instanceof ct&&v.setConstantPatternPositions(t,o)}},on.prototype.updatePaintArrays=function(t,o,u,v,y){var b=!1;for(var T in t)for(var I=0,Z=o.getPositions(T);I<Z.length;I+=1){var he=Z[I],_e=u.feature(he.index);for(var Ae in this.binders){var je=this.binders[Ae];if((je instanceof Yt||je instanceof ar||je instanceof fn)&&je.expression.isStateDependent===!0){var Je=v.paint.get(Ae);je.expression=Je.value,je.updatePaintArray(he.start,he.end,_e,t[T],y),b=!0}}}return b},on.prototype.defines=function(){var t=[];for(var o in this.binders){var u=this.binders[o];(u instanceof jt||u instanceof ct)&&t.push.apply(t,u.uniformNames.map(function(v){return"#define HAS_UNIFORM_"+v}))}return t},on.prototype.getBinderAttributes=function(){var t=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Yt||u instanceof ar)for(var v=0;v<u.paintVertexAttributes.length;v++)t.push(u.paintVertexAttributes[v].name);else if(u instanceof fn)for(var y=0;y<At.members.length;y++)t.push(At.members[y].name)}return t},on.prototype.getBinderUniforms=function(){var t=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof jt||u instanceof ct||u instanceof ar)for(var v=0,y=u.uniformNames;v<y.length;v+=1)t.push(y[v])}return t},on.prototype.getPaintVertexBuffers=function(){return this._buffers},on.prototype.getUniforms=function(t,o){var u=[];for(var v in this.binders){var y=this.binders[v];if(y instanceof jt||y instanceof ct||y instanceof ar)for(var b=0,T=y.uniformNames;b<T.length;b+=1){var I=T[b];if(o[I]){var Z=y.getBinding(t,o[I],I);u.push({name:I,property:v,binding:Z})}}}return u},on.prototype.setUniforms=function(t,o,u,v){for(var y=0,b=o;y<b.length;y+=1){var T=b[y],I=T.name,Z=T.property;this.binders[Z].setUniform(T.binding,v,u.get(Z),I)}},on.prototype.updatePaintBuffers=function(t){for(var o in this._buffers=[],this.binders){var u=this.binders[o];if(t&&u instanceof fn){var v=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(u instanceof Yt||u instanceof ar)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},on.prototype.upload=function(t){for(var o in this.binders){var u=this.binders[o];(u instanceof Yt||u instanceof ar||u instanceof fn)&&u.upload(t)}this.updatePaintBuffers()},on.prototype.destroy=function(){for(var t in this.binders){var o=this.binders[t];(o instanceof Yt||o instanceof ar||o instanceof fn)&&o.destroy()}};var Kr=function(t,o,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var v=0,y=t;v<y.length;v+=1){var b=y[v];this.programConfigurations[b.id]=new on(b,o,u)}this.needsUpload=!1,this._featureMap=new er,this._bufferOffset=0};function Gn(t,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(o+"-","").replace(/-/g,"_")]}function Zn(t,o,u){var v={color:{source:rc,composite:Hl},number:{source:To,composite:rc}},y=function(b){return{"line-pattern":{source:Vl,composite:Vl},"fill-pattern":{source:Vl,composite:Vl},"fill-extrusion-pattern":{source:Vl,composite:Vl}}[b]}(t);return y&&y[u]||v[o][u]}Kr.prototype.populatePaintArrays=function(t,o,u,v,y,b){for(var T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,o,v,y,b);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Kr.prototype.updatePaintArrays=function(t,o,u,v){for(var y=0,b=u;y<b.length;y+=1){var T=b[y];this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(t,this._featureMap,o,T,v)||this.needsUpload}},Kr.prototype.get=function(t){return this.programConfigurations[t]},Kr.prototype.upload=function(t){if(this.needsUpload){for(var o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}},Kr.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},ii("ConstantBinder",jt),ii("CrossFadedConstantBinder",ct),ii("SourceExpressionBinder",Yt),ii("CrossFadedCompositeBinder",fn),ii("CompositeExpressionBinder",ar),ii("ProgramConfiguration",on,{omit:["_buffers"]}),ii("ProgramConfigurationSet",Kr);var jn=Math.pow(2,14)-1,vi=-jn-1;function Si(t){for(var o=8192/t.extent,u=t.loadGeometry(),v=0;v<u.length;v++)for(var y=u[v],b=0;b<y.length;b++){var T=y[b],I=Math.round(T.x*o),Z=Math.round(T.y*o);T.x=U(I,vi,jn),T.y=U(Z,vi,jn),(I<T.x||I>T.x+1||Z<T.y||Z>T.y+1)&&Te("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Oi(t,o){return{type:t.type,id:t.id,properties:t.properties,geometry:o?Si(t):[]}}function Ba(t,o,u,v,y){t.emplaceBack(2*o+(v+1)/2,2*u+(y+1)/2)}var Ha=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new nu,this.indexArray=new Ui,this.segments=new tt,this.programConfigurations=new Kr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};function go(t,o){for(var u=0;u<t.length;u++)if(iu(o,t[u]))return!0;for(var v=0;v<o.length;v++)if(iu(t,o[v]))return!0;return!!Zo(t,o)}function Ea(t,o,u){return!!iu(t,o)||!!Fo(o,t,u)}function qi(t,o){if(t.length===1)return Is(o,t[0]);for(var u=0;u<o.length;u++)for(var v=o[u],y=0;y<v.length;y++)if(iu(t,v[y]))return!0;for(var b=0;b<t.length;b++)if(Is(o,t[b]))return!0;for(var T=0;T<o.length;T++)if(Zo(t,o[T]))return!0;return!1}function Sa(t,o,u){if(t.length>1){if(Zo(t,o))return!0;for(var v=0;v<o.length;v++)if(Fo(o[v],t,u))return!0}for(var y=0;y<t.length;y++)if(Fo(t[y],o,u))return!0;return!1}function Zo(t,o){if(t.length===0||o.length===0)return!1;for(var u=0;u<t.length-1;u++)for(var v=t[u],y=t[u+1],b=0;b<o.length-1;b++)if(ss(v,y,o[b],o[b+1]))return!0;return!1}function ss(t,o,u,v){return de(t,u,v)!==de(o,u,v)&&de(t,o,u)!==de(t,o,v)}function Fo(t,o,u){var v=u*u;if(o.length===1)return t.distSqr(o[0])<v;for(var y=1;y<o.length;y++)if(Qo(t,o[y-1],o[y])<v)return!0;return!1}function Qo(t,o,u){var v=o.distSqr(u);if(v===0)return t.distSqr(o);var y=((t.x-o.x)*(u.x-o.x)+(t.y-o.y)*(u.y-o.y))/v;return t.distSqr(y<0?o:y>1?u:u.sub(o)._mult(y)._add(o))}function Is(t,o){for(var u,v,y,b=!1,T=0;T<t.length;T++)for(var I=0,Z=(u=t[T]).length-1;I<u.length;Z=I++)(v=u[I]).y>o.y!=(y=u[Z]).y>o.y&&o.x<(y.x-v.x)*(o.y-v.y)/(y.y-v.y)+v.x&&(b=!b);return b}function iu(t,o){for(var u=!1,v=0,y=t.length-1;v<t.length;y=v++){var b=t[v],T=t[y];b.y>o.y!=T.y>o.y&&o.x<(T.x-b.x)*(o.y-b.y)/(T.y-b.y)+b.x&&(u=!u)}return u}function Iu(t,o,u){var v=u[0],y=u[2];if(t.x<v.x&&o.x<v.x||t.x>y.x&&o.x>y.x||t.y<v.y&&o.y<v.y||t.y>y.y&&o.y>y.y)return!1;var b=de(t,o,u[0]);return b!==de(t,o,u[1])||b!==de(t,o,u[2])||b!==de(t,o,u[3])}function ds(t,o,u){var v=o.paint.get(t).value;return v.kind==="constant"?v.value:u.programConfigurations.get(o.id).getMaxValue(t)}function Vo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function yu(t,o,u,v,y){if(!o[0]&&!o[1])return t;var b=W.convert(o)._mult(y);u==="viewport"&&b._rotate(-v);for(var T=[],I=0;I<t.length;I++)T.push(t[I].sub(b));return T}Ha.prototype.populate=function(t,o,u){var v=this.layers[0],y=[],b=null;v.type==="circle"&&(b=v.layout.get("circle-sort-key"));for(var T=0,I=t;T<I.length;T+=1){var Z=I[T],he=Z.feature,_e=Z.id,Ae=Z.index,je=Z.sourceLayerIndex,Je=this.layers[0]._featureFilter.needGeometry,Tt=Oi(he,Je);if(this.layers[0]._featureFilter.filter(new Gr(this.zoom),Tt,u)){var wt=b?b.evaluate(Tt,{},u):void 0,Wt={id:_e,properties:he.properties,type:he.type,sourceLayerIndex:je,index:Ae,geometry:Je?Tt.geometry:Si(he),patterns:{},sortKey:wt};y.push(Wt)}}b&&y.sort(function(Hn,Ci){return Hn.sortKey-Ci.sortKey});for(var zt=0,or=y;zt<or.length;zt+=1){var dr=or[zt],Ar=dr.geometry,kr=dr.index,en=dr.sourceLayerIndex,kn=t[kr].feature;this.addFeature(dr,Ar,kr,u),o.featureIndex.insert(kn,Ar,kr,en,this.index)}},Ha.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Ha.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ha.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ye),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ha.prototype.addFeature=function(t,o,u,v){for(var y=0,b=o;y<b.length;y+=1)for(var T=0,I=b[y];T<I.length;T+=1){var Z=I[T],he=Z.x,_e=Z.y;if(!(he<0||he>=8192||_e<0||_e>=8192)){var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),je=Ae.vertexLength;Ba(this.layoutVertexArray,he,_e,-1,-1),Ba(this.layoutVertexArray,he,_e,1,-1),Ba(this.layoutVertexArray,he,_e,1,1),Ba(this.layoutVertexArray,he,_e,-1,1),this.indexArray.emplaceBack(je,je+1,je+2),this.indexArray.emplaceBack(je,je+3,je+2),Ae.vertexLength+=4,Ae.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},v)},ii("CircleBucket",Ha,{omit:["layers"]});var _u=new Ma({"circle-sort-key":new Fn(Ne.layout_circle["circle-sort-key"])}),Ku={paint:new Ma({"circle-radius":new Fn(Ne.paint_circle["circle-radius"]),"circle-color":new Fn(Ne.paint_circle["circle-color"]),"circle-blur":new Fn(Ne.paint_circle["circle-blur"]),"circle-opacity":new Fn(Ne.paint_circle["circle-opacity"]),"circle-translate":new zn(Ne.paint_circle["circle-translate"]),"circle-translate-anchor":new zn(Ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zn(Ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zn(Ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fn(Ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fn(Ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fn(Ne.paint_circle["circle-stroke-opacity"])}),layout:_u},Oa=typeof Float32Array!="undefined"?Float32Array:Array;function Ps(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vs(t,o,u){var v=o[0],y=o[1],b=o[2],T=o[3],I=o[4],Z=o[5],he=o[6],_e=o[7],Ae=o[8],je=o[9],Je=o[10],Tt=o[11],wt=o[12],Wt=o[13],zt=o[14],or=o[15],dr=u[0],Ar=u[1],kr=u[2],en=u[3];return t[0]=dr*v+Ar*I+kr*Ae+en*wt,t[1]=dr*y+Ar*Z+kr*je+en*Wt,t[2]=dr*b+Ar*he+kr*Je+en*zt,t[3]=dr*T+Ar*_e+kr*Tt+en*or,t[4]=(dr=u[4])*v+(Ar=u[5])*I+(kr=u[6])*Ae+(en=u[7])*wt,t[5]=dr*y+Ar*Z+kr*je+en*Wt,t[6]=dr*b+Ar*he+kr*Je+en*zt,t[7]=dr*T+Ar*_e+kr*Tt+en*or,t[8]=(dr=u[8])*v+(Ar=u[9])*I+(kr=u[10])*Ae+(en=u[11])*wt,t[9]=dr*y+Ar*Z+kr*je+en*Wt,t[10]=dr*b+Ar*he+kr*Je+en*zt,t[11]=dr*T+Ar*_e+kr*Tt+en*or,t[12]=(dr=u[12])*v+(Ar=u[13])*I+(kr=u[14])*Ae+(en=u[15])*wt,t[13]=dr*y+Ar*Z+kr*je+en*Wt,t[14]=dr*b+Ar*he+kr*Je+en*zt,t[15]=dr*T+Ar*_e+kr*Tt+en*or,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,o=0,u=arguments.length;u--;)o+=t[u]*t[u];return Math.sqrt(o)});var Wl,Hf=vs;function hl(t,o,u){var v=o[0],y=o[1],b=o[2],T=o[3];return t[0]=u[0]*v+u[4]*y+u[8]*b+u[12]*T,t[1]=u[1]*v+u[5]*y+u[9]*b+u[13]*T,t[2]=u[2]*v+u[6]*y+u[10]*b+u[14]*T,t[3]=u[3]*v+u[7]*y+u[11]*b+u[15]*T,t}Wl=new Oa(3),Oa!=Float32Array&&(Wl[0]=0,Wl[1]=0,Wl[2]=0),function(){var t=new Oa(4);Oa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Wf=(function(){var t=new Oa(2);Oa!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function o(u){t.call(this,u,Ku)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Ha(u)},o.prototype.queryRadius=function(u){var v=u;return ds("circle-radius",this,v)+ds("circle-stroke-width",this,v)+Vo(this.paint.get("circle-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,b,T,I,Z,he){for(var _e=yu(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),I.angle,Z),Ae=this.paint.get("circle-radius").evaluate(v,y)+this.paint.get("circle-stroke-width").evaluate(v,y),je=this.paint.get("circle-pitch-alignment")==="map",Je=je?_e:function(kn,Hn){return kn.map(function(Ci){return Nc(Ci,Hn)})}(_e,he),Tt=je?Ae*Z:Ae,wt=0,Wt=b;wt<Wt.length;wt+=1)for(var zt=0,or=Wt[wt];zt<or.length;zt+=1){var dr=or[zt],Ar=je?dr:Nc(dr,he),kr=Tt,en=hl([],[dr.x,dr.y,0,1],he);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?kr*=en[3]/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(kr*=I.cameraToCenterDistance/en[3]),Ea(Je,Ar,kr))return!0}return!1},o}(da));function Nc(t,o){var u=hl([],[t.x,t.y,0,1],o);return new W(u[0]/u[3],u[1]/u[3])}var xc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Ha);function pl(t,o,u,v){var y=o.width,b=o.height;if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==y*b*u)throw new RangeError("mismatched image size")}else v=new Uint8Array(y*b*u);return t.width=y,t.height=b,t.data=v,t}function Rf(t,o,u){var v=o.width,y=o.height;if(v!==t.width||y!==t.height){var b=pl({},{width:v,height:y},u);ep(t,b,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,v),height:Math.min(t.height,y)},u),t.width=v,t.height=y,t.data=b.data}}function ep(t,o,u,v,y,b){if(y.width===0||y.height===0)return o;if(y.width>t.width||y.height>t.height||u.x>t.width-y.width||u.y>t.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||v.x>o.width-y.width||v.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var T=t.data,I=o.data,Z=0;Z<y.height;Z++)for(var he=((u.y+Z)*t.width+u.x)*b,_e=((v.y+Z)*o.width+v.x)*b,Ae=0;Ae<y.width*b;Ae++)I[_e+Ae]=T[he+Ae];return o}ii("HeatmapBucket",xc,{omit:["layers"]});var of=function(t,o){pl(this,t,1,o)};of.prototype.resize=function(t){Rf(this,t,1)},of.prototype.clone=function(){return new of({width:this.width,height:this.height},new Uint8Array(this.data))},of.copy=function(t,o,u,v,y){ep(t,o,u,v,y,1)};var xu=function(t,o){pl(this,t,4,o)};xu.prototype.resize=function(t){Rf(this,t,4)},xu.prototype.replace=function(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},xu.prototype.clone=function(){return new xu({width:this.width,height:this.height},new Uint8Array(this.data))},xu.copy=function(t,o,u,v,y){ep(t,o,u,v,y,4)},ii("AlphaImage",of),ii("RGBAImage",xu);var Pp={paint:new Ma({"heatmap-radius":new Fn(Ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fn(Ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zn(Ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ra(Ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zn(Ne.paint_heatmap["heatmap-opacity"])})};function kp(t){var o={},u=t.resolution||256,v=t.clips?t.clips.length:1,y=t.image||new xu({width:u,height:v}),b=function(Tt,wt,Wt){o[t.evaluationKey]=Wt;var zt=t.expression.evaluate(o);y.data[Tt+wt+0]=Math.floor(255*zt.r/zt.a),y.data[Tt+wt+1]=Math.floor(255*zt.g/zt.a),y.data[Tt+wt+2]=Math.floor(255*zt.b/zt.a),y.data[Tt+wt+3]=Math.floor(255*zt.a)};if(t.clips)for(var T=0,I=0;T<v;++T,I+=4*u)for(var Z=0,he=0;Z<u;Z++,he+=4){var _e=Z/(u-1),Ae=t.clips[T];b(I,he,Ae.start*(1-_e)+Ae.end*_e)}else for(var je=0,Je=0;je<u;je++,Je+=4)b(0,Je,je/(u-1));return y}var Mf=function(t){function o(u){t.call(this,u,Pp),this._updateColorRamp()}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new xc(u)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="heatmap-color"&&this._updateColorRamp()},o.prototype._updateColorRamp=function(){this.colorRamp=kp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},o.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},o}(da),dd={paint:new Ma({"hillshade-illumination-direction":new zn(Ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zn(Ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zn(Ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zn(Ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zn(Ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zn(Ne.paint_hillshade["hillshade-accent-color"])})},Dp=function(t){function o(u){t.call(this,u,dd)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},o}(da),Lp=mo([{name:"a_pos",components:2,type:"Int16"}],4).members,hh=Ih,vd=Ih;function Ih(t,o,u){u=u||2;var v,y,b,T,I,Z,he,_e=o&&o.length,Ae=_e?o[0]*u:t.length,je=tp(t,0,Ae,u,!0),Je=[];if(!je||je.next===je.prev)return Je;if(_e&&(je=function(wt,Wt,zt,or){var dr,Ar,kr,en=[];for(dr=0,Ar=Wt.length;dr<Ar;dr++)(kr=tp(wt,Wt[dr]*or,dr<Ar-1?Wt[dr+1]*or:wt.length,or,!1))===kr.next&&(kr.steiner=!0),en.push(au(kr));for(en.sort(Fp),dr=0;dr<en.length;dr++)Ph(en[dr],zt),zt=sf(zt,zt.next);return zt}(t,o,je,u)),t.length>80*u){v=b=t[0],y=T=t[1];for(var Tt=u;Tt<Ae;Tt+=u)(I=t[Tt])<v&&(v=I),(Z=t[Tt+1])<y&&(y=Z),I>b&&(b=I),Z>T&&(T=Z);he=(he=Math.max(b-v,T-y))!==0?1/he:0}return ph(je,Je,u,v,y,he),Je}function tp(t,o,u,v,y){var b,T;if(y===zc(t,o,u,v)>0)for(b=o;b<u;b+=v)T=If(b,t[b],t[b+1],T);else for(b=u-v;b>=o;b-=v)T=If(b,t[b],t[b+1],T);return T&&lf(T,T.next)&&(Sc(T),T=T.next),T}function sf(t,o){if(!t)return t;o||(o=t);var u,v=t;do if(u=!1,v.steiner||!lf(v,v.next)&&Jo(v.prev,v,v.next)!==0)v=v.next;else{if(Sc(v),(v=o=v.prev)===v.next)break;u=!0}while(u||v!==o);return o}function ph(t,o,u,v,y,b,T){if(t){!T&&b&&function(_e,Ae,je,Je){var Tt=_e;do Tt.z===null&&(Tt.z=uf(Tt.x,Tt.y,Ae,je,Je)),Tt.prevZ=Tt.prev,Tt.nextZ=Tt.next,Tt=Tt.next;while(Tt!==_e);Tt.prevZ.nextZ=null,Tt.prevZ=null,function(wt){var Wt,zt,or,dr,Ar,kr,en,kn,Hn=1;do{for(zt=wt,wt=null,Ar=null,kr=0;zt;){for(kr++,or=zt,en=0,Wt=0;Wt<Hn&&(en++,or=or.nextZ);Wt++);for(kn=Hn;en>0||kn>0&&or;)en!==0&&(kn===0||!or||zt.z<=or.z)?(dr=zt,zt=zt.nextZ,en--):(dr=or,or=or.nextZ,kn--),Ar?Ar.nextZ=dr:wt=dr,dr.prevZ=Ar,Ar=dr;zt=or}Ar.nextZ=null,Hn*=2}while(kr>1)}(Tt)}(t,v,y,b);for(var I,Z,he=t;t.prev!==t.next;)if(I=t.prev,Z=t.next,b?rp(t,v,y,b):md(t))o.push(I.i/u),o.push(t.i/u),o.push(Z.i/u),Sc(t),t=Z.next,he=Z.next;else if((t=Z)===he){T?T===1?ph(t=pv(sf(t),o,u),o,u,v,y,b,2):T===2&&Bp(t,o,u,v,y,b):ph(sf(t),o,u,v,y,b,1);break}}}function md(t){var o=t.prev,u=t,v=t.next;if(Jo(o,u,v)>=0)return!1;for(var y=t.next.next;y!==t.prev;){if(bc(o.x,o.y,u.x,u.y,v.x,v.y,y.x,y.y)&&Jo(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function rp(t,o,u,v){var y=t.prev,b=t,T=t.next;if(Jo(y,b,T)>=0)return!1;for(var I=y.x>b.x?y.x>T.x?y.x:T.x:b.x>T.x?b.x:T.x,Z=y.y>b.y?y.y>T.y?y.y:T.y:b.y>T.y?b.y:T.y,he=uf(y.x<b.x?y.x<T.x?y.x:T.x:b.x<T.x?b.x:T.x,y.y<b.y?y.y<T.y?y.y:T.y:b.y<T.y?b.y:T.y,o,u,v),_e=uf(I,Z,o,u,v),Ae=t.prevZ,je=t.nextZ;Ae&&Ae.z>=he&&je&&je.z<=_e;){if(Ae!==t.prev&&Ae!==t.next&&bc(y.x,y.y,b.x,b.y,T.x,T.y,Ae.x,Ae.y)&&Jo(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,je!==t.prev&&je!==t.next&&bc(y.x,y.y,b.x,b.y,T.x,T.y,je.x,je.y)&&Jo(je.prev,je,je.next)>=0))return!1;je=je.nextZ}for(;Ae&&Ae.z>=he;){if(Ae!==t.prev&&Ae!==t.next&&bc(y.x,y.y,b.x,b.y,T.x,T.y,Ae.x,Ae.y)&&Jo(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;je&&je.z<=_e;){if(je!==t.prev&&je!==t.next&&bc(y.x,y.y,b.x,b.y,T.x,T.y,je.x,je.y)&&Jo(je.prev,je,je.next)>=0)return!1;je=je.nextZ}return!0}function pv(t,o,u){var v=t;do{var y=v.prev,b=v.next.next;!lf(y,b)&&kh(y,v,v.next,b)&&Gl(y,b)&&Gl(b,y)&&(o.push(y.i/u),o.push(v.i/u),o.push(b.i/u),Sc(v),Sc(v.next),v=t=b),v=v.next}while(v!==t);return sf(v)}function Bp(t,o,u,v,y,b){var T=t;do{for(var I=T.next.next;I!==T.prev;){if(T.i!==I.i&&Uc(T,I)){var Z=Of(T,I);return T=sf(T,T.next),Z=sf(Z,Z.next),ph(T,o,u,v,y,b),void ph(Z,o,u,v,y,b)}I=I.next}T=T.next}while(T!==t)}function Fp(t,o){return t.x-o.x}function Ph(t,o){if(o=function(v,y){var b,T=y,I=v.x,Z=v.y,he=-1/0;do{if(Z<=T.y&&Z>=T.next.y&&T.next.y!==T.y){var _e=T.x+(Z-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(_e<=I&&_e>he){if(he=_e,_e===I){if(Z===T.y)return T;if(Z===T.next.y)return T.next}b=T.x<T.next.x?T:T.next}}T=T.next}while(T!==y);if(!b)return null;if(I===he)return b;var Ae,je=b,Je=b.x,Tt=b.y,wt=1/0;T=b;do I>=T.x&&T.x>=Je&&I!==T.x&&bc(Z<Tt?I:he,Z,Je,Tt,Z<Tt?he:I,Z,T.x,T.y)&&(Ae=Math.abs(Z-T.y)/(I-T.x),Gl(T,v)&&(Ae<wt||Ae===wt&&(T.x>b.x||T.x===b.x&&Gf(b,T)))&&(b=T,wt=Ae)),T=T.next;while(T!==je);return b}(t,o)){var u=Of(o,t);sf(o,o.next),sf(u,u.next)}}function Gf(t,o){return Jo(t.prev,t,o.prev)<0&&Jo(o.next,t,t.next)<0}function uf(t,o,u,v,y){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*y)|t<<8))|t<<4))|t<<2))|t<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-v)*y)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function au(t){var o=t,u=t;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==t);return u}function bc(t,o,u,v,y,b,T,I){return(y-T)*(o-I)-(t-T)*(b-I)>=0&&(t-T)*(v-I)-(u-T)*(o-I)>=0&&(u-T)*(b-I)-(y-T)*(v-I)>=0}function Uc(t,o){return t.next.i!==o.i&&t.prev.i!==o.i&&!function(u,v){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==v.i&&y.next.i!==v.i&&kh(y,y.next,u,v))return!0;y=y.next}while(y!==u);return!1}(t,o)&&(Gl(t,o)&&Gl(o,t)&&function(u,v){var y=u,b=!1,T=(u.x+v.x)/2,I=(u.y+v.y)/2;do y.y>I!=y.next.y>I&&y.next.y!==y.y&&T<(y.next.x-y.x)*(I-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next;while(y!==u);return b}(t,o)&&(Jo(t.prev,t,o.prev)||Jo(t,o.prev,o))||lf(t,o)&&Jo(t.prev,t,t.next)>0&&Jo(o.prev,o,o.next)>0)}function Jo(t,o,u){return(o.y-t.y)*(u.x-o.x)-(o.x-t.x)*(u.y-o.y)}function lf(t,o){return t.x===o.x&&t.y===o.y}function kh(t,o,u,v){var y=Ec(Jo(t,o,u)),b=Ec(Jo(t,o,v)),T=Ec(Jo(u,v,t)),I=Ec(Jo(u,v,o));return y!==b&&T!==I||!(y!==0||!Xf(t,u,o))||!(b!==0||!Xf(t,v,o))||!(T!==0||!Xf(u,t,v))||!(I!==0||!Xf(u,o,v))}function Xf(t,o,u){return o.x<=Math.max(t.x,u.x)&&o.x>=Math.min(t.x,u.x)&&o.y<=Math.max(t.y,u.y)&&o.y>=Math.min(t.y,u.y)}function Ec(t){return t>0?1:t<0?-1:0}function Gl(t,o){return Jo(t.prev,t,t.next)<0?Jo(t,o,t.next)>=0&&Jo(t,t.prev,o)>=0:Jo(t,o,t.prev)<0||Jo(t,t.next,o)<0}function Of(t,o){var u=new Sl(t.i,t.x,t.y),v=new Sl(o.i,o.x,o.y),y=t.next,b=o.prev;return t.next=o,o.prev=t,u.next=y,y.prev=u,v.next=u,u.prev=v,b.next=v,v.prev=b,v}function If(t,o,u,v){var y=new Sl(t,o,u);return v?(y.next=v.next,y.prev=v,v.next.prev=y,v.next=y):(y.prev=y,y.next=y),y}function Sc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Sl(t,o,u){this.i=t,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function zc(t,o,u,v){for(var y=0,b=o,T=u-v;b<u;b+=v)y+=(t[T]-t[b])*(t[b+1]+t[T+1]),T=b;return y}function dh(t,o,u,v,y){(function b(T,I,Z,he,_e){for(;he>Z;){if(he-Z>600){var Ae=he-Z+1,je=I-Z+1,Je=Math.log(Ae),Tt=.5*Math.exp(2*Je/3),wt=.5*Math.sqrt(Je*Tt*(Ae-Tt)/Ae)*(je-Ae/2<0?-1:1);b(T,I,Math.max(Z,Math.floor(I-je*Tt/Ae+wt)),Math.min(he,Math.floor(I+(Ae-je)*Tt/Ae+wt)),_e)}var Wt=T[I],zt=Z,or=he;for(Zc(T,Z,I),_e(T[he],Wt)>0&&Zc(T,Z,he);zt<or;){for(Zc(T,zt,or),zt++,or--;_e(T[zt],Wt)<0;)zt++;for(;_e(T[or],Wt)>0;)or--}_e(T[Z],Wt)===0?Zc(T,Z,or):Zc(T,++or,he),or<=I&&(Z=or+1),I<=or&&(he=or-1)}})(t,o,u||0,v||t.length-1,y||Pf)}function Zc(t,o,u){var v=t[o];t[o]=t[u],t[u]=v}function Pf(t,o){return t<o?-1:t>o?1:0}function Vc(t,o){var u=t.length;if(u<=1)return[t];for(var v,y,b=[],T=0;T<u;T++){var I=Rt(t[T]);I!==0&&(t[T].area=Math.abs(I),y===void 0&&(y=I<0),y===I<0?(v&&b.push(v),v=[t[T]]):v.push(t[T]))}if(v&&b.push(v),o>1)for(var Z=0;Z<b.length;Z++)b[Z].length<=o||(dh(b[Z],o,1,b[Z].length-1,np),b[Z]=b[Z].slice(0,o));return b}function np(t,o){return o.area-t.area}function ip(t,o,u){for(var v=u.patternDependencies,y=!1,b=0,T=o;b<T.length;b+=1){var I=T[b].paint.get(t+"-pattern");I.isConstant()||(y=!0);var Z=I.constantOr(null);Z&&(y=!0,v[Z.to]=!0,v[Z.from]=!0)}return y}function Np(t,o,u,v,y){for(var b=y.patternDependencies,T=0,I=o;T<I.length;T+=1){var Z=I[T],he=Z.paint.get(t+"-pattern").value;if(he.kind!=="constant"){var _e=he.evaluate({zoom:v-1},u,{},y.availableImages),Ae=he.evaluate({zoom:v},u,{},y.availableImages),je=he.evaluate({zoom:v+1},u,{},y.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,je=je&&je.name?je.name:je,b[_e=_e&&_e.name?_e.name:_e]=!0,b[Ae]=!0,b[je]=!0,u.patterns[Z.id]={min:_e,mid:Ae,max:je}}}return u}Ih.deviation=function(t,o,u,v){var y=o&&o.length,b=Math.abs(zc(t,0,y?o[0]*u:t.length,u));if(y)for(var T=0,I=o.length;T<I;T++)b-=Math.abs(zc(t,o[T]*u,T<I-1?o[T+1]*u:t.length,u));var Z=0;for(T=0;T<v.length;T+=3){var he=v[T]*u,_e=v[T+1]*u,Ae=v[T+2]*u;Z+=Math.abs((t[he]-t[Ae])*(t[_e+1]-t[he+1])-(t[he]-t[_e])*(t[Ae+1]-t[he+1]))}return b===0&&Z===0?0:Math.abs((Z-b)/b)},Ih.flatten=function(t){for(var o=t[0][0].length,u={vertices:[],holes:[],dimensions:o},v=0,y=0;y<t.length;y++){for(var b=0;b<t[y].length;b++)for(var T=0;T<o;T++)u.vertices.push(t[y][b][T]);y>0&&u.holes.push(v+=t[y-1].length)}return u},hh.default=vd;var Tc=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new nu,this.indexArray=new Ui,this.indexArray2=new $l,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new tt,this.segments2=new tt,this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};Tc.prototype.populate=function(t,o,u){this.hasPattern=ip("fill",this.layers,o);for(var v=this.layers[0].layout.get("fill-sort-key"),y=[],b=0,T=t;b<T.length;b+=1){var I=T[b],Z=I.feature,he=I.id,_e=I.index,Ae=I.sourceLayerIndex,je=this.layers[0]._featureFilter.needGeometry,Je=Oi(Z,je);if(this.layers[0]._featureFilter.filter(new Gr(this.zoom),Je,u)){var Tt=v?v.evaluate(Je,{},u,o.availableImages):void 0,wt={id:he,properties:Z.properties,type:Z.type,sourceLayerIndex:Ae,index:_e,geometry:je?Je.geometry:Si(Z),patterns:{},sortKey:Tt};y.push(wt)}}v&&y.sort(function(kn,Hn){return kn.sortKey-Hn.sortKey});for(var Wt=0,zt=y;Wt<zt.length;Wt+=1){var or=zt[Wt],dr=or.geometry,Ar=or.index,kr=or.sourceLayerIndex;if(this.hasPattern){var en=Np("fill",this.layers,or,this.zoom,o);this.patternFeatures.push(en)}else this.addFeature(or,dr,Ar,u,{});o.featureIndex.insert(t[Ar].feature,dr,Ar,kr,this.index)}},Tc.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Tc.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.patternFeatures;v<y.length;v+=1){var b=y[v];this.addFeature(b,b.geometry,b.index,o,u)}},Tc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tc.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Lp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Tc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Tc.prototype.addFeature=function(t,o,u,v,y){for(var b=0,T=Vc(o,500);b<T.length;b+=1){for(var I=T[b],Z=0,he=0,_e=I;he<_e.length;he+=1)Z+=_e[he].length;for(var Ae=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray),je=Ae.vertexLength,Je=[],Tt=[],wt=0,Wt=I;wt<Wt.length;wt+=1){var zt=Wt[wt];if(zt.length!==0){zt!==I[0]&&Tt.push(Je.length/2);var or=this.segments2.prepareSegment(zt.length,this.layoutVertexArray,this.indexArray2),dr=or.vertexLength;this.layoutVertexArray.emplaceBack(zt[0].x,zt[0].y),this.indexArray2.emplaceBack(dr+zt.length-1,dr),Je.push(zt[0].x),Je.push(zt[0].y);for(var Ar=1;Ar<zt.length;Ar++)this.layoutVertexArray.emplaceBack(zt[Ar].x,zt[Ar].y),this.indexArray2.emplaceBack(dr+Ar-1,dr+Ar),Je.push(zt[Ar].x),Je.push(zt[Ar].y);or.vertexLength+=zt.length,or.primitiveLength+=zt.length}}for(var kr=hh(Je,Tt),en=0;en<kr.length;en+=3)this.indexArray.emplaceBack(je+kr[en],je+kr[en+1],je+kr[en+2]);Ae.vertexLength+=Z,Ae.primitiveLength+=kr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},ii("FillBucket",Tc,{omit:["layers","patternFeatures"]});var kf=new Ma({"fill-sort-key":new Fn(Ne.layout_fill["fill-sort-key"])}),gd={paint:new Ma({"fill-antialias":new zn(Ne.paint_fill["fill-antialias"]),"fill-opacity":new Fn(Ne.paint_fill["fill-opacity"]),"fill-color":new Fn(Ne.paint_fill["fill-color"]),"fill-outline-color":new Fn(Ne.paint_fill["fill-outline-color"]),"fill-translate":new zn(Ne.paint_fill["fill-translate"]),"fill-translate-anchor":new zn(Ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new $a(Ne.paint_fill["fill-pattern"])}),layout:kf},yd=function(t){function o(u){t.call(this,u,gd)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.recalculate=function(u,v){t.prototype.recalculate.call(this,u,v);var y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},o.prototype.createBucket=function(u){return new Tc(u)},o.prototype.queryRadius=function(){return Vo(this.paint.get("fill-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,b,T,I,Z){return qi(yu(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),I.angle,Z),b)},o.prototype.isTileClipped=function(){return!0},o}(da),_d=mo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,xd=cf;function cf(t,o,u,v,y){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=v,this._values=y,t.readFields(ap,this,o)}function ap(t,o,u){t==1?o.id=u.readVarint():t==2?function(v,y){for(var b=v.readVarint()+v.pos;v.pos<b;){var T=y._keys[v.readVarint()],I=y._values[v.readVarint()];y.properties[T]=I}}(u,o):t==3?o.type=u.readVarint():t==4&&(o._geometry=u.pos)}function jc(t){for(var o,u,v=0,y=0,b=t.length,T=b-1;y<b;T=y++)v+=((u=t[T]).x-(o=t[y]).x)*(o.y+u.y);return v}cf.types=["Unknown","Point","LineString","Polygon"],cf.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var o,u=t.readVarint()+t.pos,v=1,y=0,b=0,T=0,I=[];t.pos<u;){if(y<=0){var Z=t.readVarint();v=7&Z,y=Z>>3}if(y--,v===1||v===2)b+=t.readSVarint(),T+=t.readSVarint(),v===1&&(o&&I.push(o),o=[]),o.push(new W(b,T));else{if(v!==7)throw new Error("unknown command "+v);o&&o.push(o[0].clone())}}return o&&I.push(o),I},cf.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var o=t.readVarint()+t.pos,u=1,v=0,y=0,b=0,T=1/0,I=-1/0,Z=1/0,he=-1/0;t.pos<o;){if(v<=0){var _e=t.readVarint();u=7&_e,v=_e>>3}if(v--,u===1||u===2)(y+=t.readSVarint())<T&&(T=y),y>I&&(I=y),(b+=t.readSVarint())<Z&&(Z=b),b>he&&(he=b);else if(u!==7)throw new Error("unknown command "+u)}return[T,Z,I,he]},cf.prototype.toGeoJSON=function(t,o,u){var v,y,b=this.extent*Math.pow(2,u),T=this.extent*t,I=this.extent*o,Z=this.loadGeometry(),he=cf.types[this.type];function _e(Je){for(var Tt=0;Tt<Je.length;Tt++){var wt=Je[Tt];Je[Tt]=[360*(wt.x+T)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(wt.y+I)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var Ae=[];for(v=0;v<Z.length;v++)Ae[v]=Z[v][0];_e(Z=Ae);break;case 2:for(v=0;v<Z.length;v++)_e(Z[v]);break;case 3:for(Z=function(Je){var Tt=Je.length;if(Tt<=1)return[Je];for(var wt,Wt,zt=[],or=0;or<Tt;or++){var dr=jc(Je[or]);dr!==0&&(Wt===void 0&&(Wt=dr<0),Wt===dr<0?(wt&&zt.push(wt),wt=[Je[or]]):wt.push(Je[or]))}return wt&&zt.push(wt),zt}(Z),v=0;v<Z.length;v++)for(y=0;y<Z[v].length;y++)_e(Z[v][y])}Z.length===1?Z=Z[0]:he="Multi"+he;var je={type:"Feature",geometry:{type:he,coordinates:Z},properties:this.properties};return"id"in this&&(je.id=this.id),je};var Dh=Df;function Df(t,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Lf,this,o),this.length=this._features.length}function Lf(t,o,u){t===15?o.version=u.readVarint():t===1?o.name=u.readString():t===5?o.extent=u.readVarint():t===2?o._features.push(u.pos):t===3?o._keys.push(u.readString()):t===4&&o._values.push(function(v){for(var y=null,b=v.readVarint()+v.pos;v.pos<b;){var T=v.readVarint()>>3;y=T===1?v.readString():T===2?v.readFloat():T===3?v.readDouble():T===4?v.readVarint64():T===5?v.readVarint():T===6?v.readSVarint():T===7?v.readBoolean():null}return y}(u))}function op(t,o,u){if(t===3){var v=new Dh(u,u.readVarint()+u.pos);v.length&&(o[v.name]=v)}}Df.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var o=this._pbf.readVarint()+this._pbf.pos;return new xd(this._pbf,o,this.extent,this._keys,this._values)};var ff={VectorTile:function(t,o){this.layers=t.readFields(op,{},o)},VectorTileFeature:xd,VectorTileLayer:Dh},sp=ff.VectorTileFeature.types,vh=Math.pow(2,13);function bu(t,o,u,v,y,b,T,I){t.emplaceBack(o,u,2*Math.floor(v*vh)+T,y*vh*2,b*vh*2,Math.round(I))}var Eu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Zl,this.indexArray=new Ui,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new tt,this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};function es(t,o){return t.x===o.x&&(t.x<0||t.x>8192)||t.y===o.y&&(t.y<0||t.y>8192)}Eu.prototype.populate=function(t,o,u){this.features=[],this.hasPattern=ip("fill-extrusion",this.layers,o);for(var v=0,y=t;v<y.length;v+=1){var b=y[v],T=b.feature,I=b.id,Z=b.index,he=b.sourceLayerIndex,_e=this.layers[0]._featureFilter.needGeometry,Ae=Oi(T,_e);if(this.layers[0]._featureFilter.filter(new Gr(this.zoom),Ae,u)){var je={id:I,sourceLayerIndex:he,index:Z,geometry:_e?Ae.geometry:Si(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(Np("fill-extrusion",this.layers,je,this.zoom,o)):this.addFeature(je,je.geometry,Z,u,{}),o.featureIndex.insert(T,je.geometry,Z,he,this.index,!0)}}},Eu.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.features;v<y.length;v+=1){var b=y[v];this.addFeature(b,b.geometry,b.index,o,u)}},Eu.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Eu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Eu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Eu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_d),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Eu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Eu.prototype.addFeature=function(t,o,u,v,y){for(var b=0,T=Vc(o,500);b<T.length;b+=1){for(var I=T[b],Z=0,he=0,_e=I;he<_e.length;he+=1)Z+=_e[he].length;for(var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),je=0,Je=I;je<Je.length;je+=1){var Tt=Je[je];if(Tt.length!==0&&!((Aa=Tt).every(function(aa){return aa.x<0})||Aa.every(function(aa){return aa.x>8192})||Aa.every(function(aa){return aa.y<0})||Aa.every(function(aa){return aa.y>8192})))for(var wt=0,Wt=0;Wt<Tt.length;Wt++){var zt=Tt[Wt];if(Wt>=1){var or=Tt[Wt-1];if(!es(zt,or)){Ae.vertexLength+4>tt.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var dr=zt.sub(or)._perp()._unit(),Ar=or.dist(zt);wt+Ar>32768&&(wt=0),bu(this.layoutVertexArray,zt.x,zt.y,dr.x,dr.y,0,0,wt),bu(this.layoutVertexArray,zt.x,zt.y,dr.x,dr.y,0,1,wt),bu(this.layoutVertexArray,or.x,or.y,dr.x,dr.y,0,0,wt+=Ar),bu(this.layoutVertexArray,or.x,or.y,dr.x,dr.y,0,1,wt);var kr=Ae.vertexLength;this.indexArray.emplaceBack(kr,kr+2,kr+1),this.indexArray.emplaceBack(kr+1,kr+2,kr+3),Ae.vertexLength+=4,Ae.primitiveLength+=2}}}}if(Ae.vertexLength+Z>tt.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),sp[t.type]==="Polygon"){for(var en=[],kn=[],Hn=Ae.vertexLength,Ci=0,oi=I;Ci<oi.length;Ci+=1){var Li=oi[Ci];if(Li.length!==0){Li!==I[0]&&kn.push(en.length/2);for(var si=0;si<Li.length;si++){var ma=Li[si];bu(this.layoutVertexArray,ma.x,ma.y,0,0,1,1,0),en.push(ma.x),en.push(ma.y)}}}for(var Ki=hh(en,kn),xi=0;xi<Ki.length;xi+=3)this.indexArray.emplaceBack(Hn+Ki[xi],Hn+Ki[xi+2],Hn+Ki[xi+1]);Ae.primitiveLength+=Ki.length/3,Ae.vertexLength+=Z}}var Aa;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},ii("FillExtrusionBucket",Eu,{omit:["layers","features"]});var dl={paint:new Ma({"fill-extrusion-opacity":new zn(Ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zn(Ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zn(Ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $a(Ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zn(Ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},bd=function(t){function o(u){t.call(this,u,dl)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Eu(u)},o.prototype.queryRadius=function(){return Vo(this.paint.get("fill-extrusion-translate"))},o.prototype.is3D=function(){return!0},o.prototype.queryIntersectsFeature=function(u,v,y,b,T,I,Z,he){var _e=yu(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),I.angle,Z),Ae=this.paint.get("fill-extrusion-height").evaluate(v,y),je=this.paint.get("fill-extrusion-base").evaluate(v,y),Je=function(wt,Wt,zt,or){for(var dr=[],Ar=0,kr=wt;Ar<kr.length;Ar+=1){var en=kr[Ar],kn=[en.x,en.y,0,1];hl(kn,kn,Wt),dr.push(new W(kn[0]/kn[3],kn[1]/kn[3]))}return dr}(_e,he),Tt=function(wt,Wt,zt,or){for(var dr=[],Ar=[],kr=or[8]*Wt,en=or[9]*Wt,kn=or[10]*Wt,Hn=or[11]*Wt,Ci=or[8]*zt,oi=or[9]*zt,Li=or[10]*zt,si=or[11]*zt,ma=0,Ki=wt;ma<Ki.length;ma+=1){for(var xi=[],Aa=[],aa=0,ra=Ki[ma];aa<ra.length;aa+=1){var Ni=ra[aa],oo=Ni.x,No=Ni.y,ko=or[0]*oo+or[4]*No+or[12],ts=or[1]*oo+or[5]*No+or[13],Uo=or[2]*oo+or[6]*No+or[14],ls=or[3]*oo+or[7]*No+or[15],_s=Uo+kn,qs=ls+Hn,Tu=ko+Ci,Ls=ts+oi,Ua=Uo+Li,xs=ls+si,Yo=new W((ko+kr)/qs,(ts+en)/qs);Yo.z=_s/qs,xi.push(Yo);var ka=new W(Tu/xs,Ls/xs);ka.z=Ua/xs,Aa.push(ka)}dr.push(xi),Ar.push(Aa)}return[dr,Ar]}(b,je,Ae,he);return function(wt,Wt,zt){var or=1/0;qi(zt,Wt)&&(or=up(zt,Wt[0]));for(var dr=0;dr<Wt.length;dr++)for(var Ar=Wt[dr],kr=wt[dr],en=0;en<Ar.length-1;en++){var kn=Ar[en],Hn=[kn,Ar[en+1],kr[en+1],kr[en],kn];go(zt,Hn)&&(or=Math.min(or,up(zt,Hn)))}return or!==1/0&&or}(Tt[0],Tt[1],Je)},o}(da);function nc(t,o){return t.x*o.x+t.y*o.y}function up(t,o){if(t.length===1){for(var u,v=0,y=o[v++];!u||y.equals(u);)if(!(u=o[v++]))return 1/0;for(;v<o.length;v++){var b=o[v],T=t[0],I=u.sub(y),Z=b.sub(y),he=T.sub(y),_e=nc(I,I),Ae=nc(I,Z),je=nc(Z,Z),Je=nc(he,I),Tt=nc(he,Z),wt=_e*je-Ae*Ae,Wt=(je*Je-Ae*Tt)/wt,zt=(_e*Tt-Ae*Je)/wt,or=y.z*(1-Wt-zt)+u.z*Wt+b.z*zt;if(isFinite(or))return or}return 1/0}for(var dr=1/0,Ar=0,kr=o;Ar<kr.length;Ar+=1)dr=Math.min(dr,kr[Ar].z);return dr}var Lh=mo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ed=mo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Up=ff.VectorTileFeature.types,Yf=Math.cos(Math.PI/180*37.5),zp=Math.pow(2,14)/.5,Su=function(t){var o=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){o.gradients[u.id]={}}),this.layoutVertexArray=new Os,this.layoutVertexArray2=new rc,this.indexArray=new Ui,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new tt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Su.prototype.populate=function(t,o,u){this.hasPattern=ip("line",this.layers,o);for(var v=this.layers[0].layout.get("line-sort-key"),y=[],b=0,T=t;b<T.length;b+=1){var I=T[b],Z=I.feature,he=I.id,_e=I.index,Ae=I.sourceLayerIndex,je=this.layers[0]._featureFilter.needGeometry,Je=Oi(Z,je);if(this.layers[0]._featureFilter.filter(new Gr(this.zoom),Je,u)){var Tt=v?v.evaluate(Je,{},u):void 0,wt={id:he,properties:Z.properties,type:Z.type,sourceLayerIndex:Ae,index:_e,geometry:je?Je.geometry:Si(Z),patterns:{},sortKey:Tt};y.push(wt)}}v&&y.sort(function(kn,Hn){return kn.sortKey-Hn.sortKey});for(var Wt=0,zt=y;Wt<zt.length;Wt+=1){var or=zt[Wt],dr=or.geometry,Ar=or.index,kr=or.sourceLayerIndex;if(this.hasPattern){var en=Np("line",this.layers,or,this.zoom,o);this.patternFeatures.push(en)}else this.addFeature(or,dr,Ar,u,{});o.featureIndex.insert(t[Ar].feature,dr,Ar,kr,this.index)}},Su.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Su.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.patternFeatures;v<y.length;v+=1){var b=y[v];this.addFeature(b,b.geometry,b.index,o,u)}},Su.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Su.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Su.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ed)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Lh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Su.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Su.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Su.prototype.addFeature=function(t,o,u,v,y){var b=this.layers[0].layout,T=b.get("line-join").evaluate(t,{}),I=b.get("line-cap"),Z=b.get("line-miter-limit"),he=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var _e=0,Ae=o;_e<Ae.length;_e+=1)this.addLine(Ae[_e],t,T,I,Z,he);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},Su.prototype.addLine=function(t,o,u,v,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var T=0;T<t.length-1;T++)this.totalDistance+=t[T].dist(t[T+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var I=Up[o.type]==="Polygon",Z=t.length;Z>=2&&t[Z-1].equals(t[Z-2]);)Z--;for(var he=0;he<Z-1&&t[he].equals(t[he+1]);)he++;if(!(Z<(I?3:2))){u==="bevel"&&(y=1.05);var _e,Ae=this.overscaling<=16?122880/(512*this.overscaling):0,je=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray),Je=void 0,Tt=void 0,wt=void 0,Wt=void 0;this.e1=this.e2=-1,I&&(Wt=t[he].sub(_e=t[Z-2])._unit()._perp());for(var zt=he;zt<Z;zt++)if(!(Tt=zt===Z-1?I?t[he+1]:void 0:t[zt+1])||!t[zt].equals(Tt)){Wt&&(wt=Wt),_e&&(Je=_e),_e=t[zt],Wt=Tt?Tt.sub(_e)._unit()._perp():wt;var or=(wt=wt||Wt).add(Wt);or.x===0&&or.y===0||or._unit();var dr=wt.x*Wt.x+wt.y*Wt.y,Ar=or.x*Wt.x+or.y*Wt.y,kr=Ar!==0?1/Ar:1/0,en=2*Math.sqrt(2-2*Ar),kn=Ar<Yf&&Je&&Tt,Hn=wt.x*Wt.y-wt.y*Wt.x>0;if(kn&&zt>he){var Ci=_e.dist(Je);if(Ci>2*Ae){var oi=_e.sub(_e.sub(Je)._mult(Ae/Ci)._round());this.updateDistance(Je,oi),this.addCurrentVertex(oi,wt,0,0,je),Je=oi}}var Li=Je&&Tt,si=Li?u:I?"butt":v;if(Li&&si==="round"&&(kr<b?si="miter":kr<=2&&(si="fakeround")),si==="miter"&&kr>y&&(si="bevel"),si==="bevel"&&(kr>2&&(si="flipbevel"),kr<y&&(si="miter")),Je&&this.updateDistance(Je,_e),si==="miter")or._mult(kr),this.addCurrentVertex(_e,or,0,0,je);else if(si==="flipbevel"){if(kr>100)or=Wt.mult(-1);else{var ma=kr*wt.add(Wt).mag()/wt.sub(Wt).mag();or._perp()._mult(ma*(Hn?-1:1))}this.addCurrentVertex(_e,or,0,0,je),this.addCurrentVertex(_e,or.mult(-1),0,0,je)}else if(si==="bevel"||si==="fakeround"){var Ki=-Math.sqrt(kr*kr-1),xi=Hn?Ki:0,Aa=Hn?0:Ki;if(Je&&this.addCurrentVertex(_e,wt,xi,Aa,je),si==="fakeround")for(var aa=Math.round(180*en/Math.PI/20),ra=1;ra<aa;ra++){var Ni=ra/aa;if(Ni!==.5){var oo=Ni-.5;Ni+=Ni*oo*(Ni-1)*((1.0904+dr*(dr*(3.55645-1.43519*dr)-3.2452))*oo*oo+(.848013+dr*(.215638*dr-1.06021)))}var No=Wt.sub(wt)._mult(Ni)._add(wt)._unit()._mult(Hn?-1:1);this.addHalfVertex(_e,No.x,No.y,!1,Hn,0,je)}Tt&&this.addCurrentVertex(_e,Wt,-xi,-Aa,je)}else if(si==="butt")this.addCurrentVertex(_e,or,0,0,je);else if(si==="square"){var ko=Je?1:-1;this.addCurrentVertex(_e,or,ko,ko,je)}else si==="round"&&(Je&&(this.addCurrentVertex(_e,wt,0,0,je),this.addCurrentVertex(_e,wt,1,1,je,!0)),Tt&&(this.addCurrentVertex(_e,Wt,-1,-1,je,!0),this.addCurrentVertex(_e,Wt,0,0,je)));if(kn&&zt<Z-1){var ts=_e.dist(Tt);if(ts>2*Ae){var Uo=_e.add(Tt.sub(_e)._mult(Ae/ts)._round());this.updateDistance(_e,Uo),this.addCurrentVertex(Uo,Wt,0,0,je),_e=Uo}}}}},Su.prototype.addCurrentVertex=function(t,o,u,v,y,b){b===void 0&&(b=!1);var T=o.y*v-o.x,I=-o.y-o.x*v;this.addHalfVertex(t,o.x+o.y*u,o.y-o.x*u,b,!1,u,y),this.addHalfVertex(t,T,I,b,!0,-v,y),this.distance>zp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,o,u,v,y,b))},Su.prototype.addHalfVertex=function(t,o,u,v,y,b,T){var I=.5*(this.lineClips?this.scaledDistance*(zp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(v?1:0),(t.y<<1)+(y?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var Z=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Z),T.primitiveLength++),y?this.e2=Z:this.e1=Z},Su.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Su.prototype.updateDistance=function(t,o){this.distance+=t.dist(o),this.updateScaledDistance()},ii("LineBucket",Su,{omit:["layers","patternFeatures"]});var dv=new Ma({"line-cap":new zn(Ne.layout_line["line-cap"]),"line-join":new Fn(Ne.layout_line["line-join"]),"line-miter-limit":new zn(Ne.layout_line["line-miter-limit"]),"line-round-limit":new zn(Ne.layout_line["line-round-limit"]),"line-sort-key":new Fn(Ne.layout_line["line-sort-key"])}),Sd={paint:new Ma({"line-opacity":new Fn(Ne.paint_line["line-opacity"]),"line-color":new Fn(Ne.paint_line["line-color"]),"line-translate":new zn(Ne.paint_line["line-translate"]),"line-translate-anchor":new zn(Ne.paint_line["line-translate-anchor"]),"line-width":new Fn(Ne.paint_line["line-width"]),"line-gap-width":new Fn(Ne.paint_line["line-gap-width"]),"line-offset":new Fn(Ne.paint_line["line-offset"]),"line-blur":new Fn(Ne.paint_line["line-blur"]),"line-dasharray":new _a(Ne.paint_line["line-dasharray"]),"line-pattern":new $a(Ne.paint_line["line-pattern"]),"line-gradient":new Ra(Ne.paint_line["line-gradient"])}),layout:dv},Zp=new(function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v){return v=new Gr(Math.floor(v.zoom),{now:v.now,fadeDuration:v.fadeDuration,zoomHistory:v.zoomHistory,transition:v.transition}),t.prototype.possiblyEvaluate.call(this,u,v)},o.prototype.evaluate=function(u,v,y,b){return v=le({},v,{zoom:Math.floor(v.zoom)}),t.prototype.evaluate.call(this,u,v,y,b)},o}(Fn))(Sd.paint.properties["line-width"].specification);Zp.useIntegerZoom=!0;var Td=function(t){function o(u){t.call(this,u,Sd),this.gradientVersion=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof cn,this.gradientVersion=(this.gradientVersion+1)%Be)},o.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},o.prototype.recalculate=function(u,v){t.prototype.recalculate.call(this,u,v),this.paint._values["line-floorwidth"]=Zp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},o.prototype.createBucket=function(u){return new Su(u)},o.prototype.queryRadius=function(u){var v=u,y=Vp(ds("line-width",this,v),ds("line-gap-width",this,v)),b=ds("line-offset",this,v);return y/2+Math.abs(b)+Vo(this.paint.get("line-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,b,T,I,Z){var he=yu(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),I.angle,Z),_e=Z/2*Vp(this.paint.get("line-width").evaluate(v,y),this.paint.get("line-gap-width").evaluate(v,y)),Ae=this.paint.get("line-offset").evaluate(v,y);return Ae&&(b=function(je,Je){for(var Tt=[],wt=new W(0,0),Wt=0;Wt<je.length;Wt++){for(var zt=je[Wt],or=[],dr=0;dr<zt.length;dr++){var Ar=zt[dr],kr=zt[dr+1],en=dr===0?wt:Ar.sub(zt[dr-1])._unit()._perp(),kn=dr===zt.length-1?wt:kr.sub(Ar)._unit()._perp(),Hn=en._add(kn)._unit();Hn._mult(1/(Hn.x*kn.x+Hn.y*kn.y)),or.push(Hn._mult(Je)._add(Ar))}Tt.push(or)}return Tt}(b,Ae*Z)),function(je,Je,Tt){for(var wt=0;wt<Je.length;wt++){var Wt=Je[wt];if(je.length>=3){for(var zt=0;zt<Wt.length;zt++)if(iu(je,Wt[zt]))return!0}if(Sa(je,Wt,Tt))return!0}return!1}(he,b,_e)},o.prototype.isTileClipped=function(){return!0},o}(da);function Vp(t,o){return o>0?o+2*t:t}var vv=mo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mv=mo([{name:"a_projected_pos",components:3,type:"Float32"}],4),lp=(mo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),mo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),cp=(mo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),mo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),me=mo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ht(t,o,u){return t.sections.forEach(function(v){v.text=function(y,b,T){var I=b.layout.get("text-transform").evaluate(T,{});return I==="uppercase"?y=y.toLocaleUpperCase():I==="lowercase"&&(y=y.toLocaleLowerCase()),fi.applyArabicShaping&&(y=fi.applyArabicShaping(y)),y}(v.text,o,u)}),t}mo([{name:"triangle",components:3,type:"Uint16"}]),mo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),mo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),mo([{type:"Float32",name:"offsetX"}]),mo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Lt={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},wr=function(t,o,u,v,y){var b,T,I=8*y-v-1,Z=(1<<I)-1,he=Z>>1,_e=-7,Ae=u?y-1:0,je=u?-1:1,Je=t[o+Ae];for(Ae+=je,b=Je&(1<<-_e)-1,Je>>=-_e,_e+=I;_e>0;b=256*b+t[o+Ae],Ae+=je,_e-=8);for(T=b&(1<<-_e)-1,b>>=-_e,_e+=v;_e>0;T=256*T+t[o+Ae],Ae+=je,_e-=8);if(b===0)b=1-he;else{if(b===Z)return T?NaN:1/0*(Je?-1:1);T+=Math.pow(2,v),b-=he}return(Je?-1:1)*T*Math.pow(2,b-v)},qr=function(t,o,u,v,y,b){var T,I,Z,he=8*b-y-1,_e=(1<<he)-1,Ae=_e>>1,je=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,Je=v?0:b-1,Tt=v?1:-1,wt=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(I=isNaN(o)?1:0,T=_e):(T=Math.floor(Math.log(o)/Math.LN2),o*(Z=Math.pow(2,-T))<1&&(T--,Z*=2),(o+=T+Ae>=1?je/Z:je*Math.pow(2,1-Ae))*Z>=2&&(T++,Z/=2),T+Ae>=_e?(I=0,T=_e):T+Ae>=1?(I=(o*Z-1)*Math.pow(2,y),T+=Ae):(I=o*Math.pow(2,Ae-1)*Math.pow(2,y),T=0));y>=8;t[u+Je]=255&I,Je+=Tt,I/=256,y-=8);for(T=T<<y|I,he+=y;he>0;t[u+Je]=255&T,Je+=Tt,T/=256,he-=8);t[u+Je-Tt]|=128*wt},Cr=fr;function fr(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}fr.Varint=0,fr.Fixed64=1,fr.Bytes=2,fr.Fixed32=5;var Mn=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function gn(t){return t.type===fr.Bytes?t.readVarint()+t.pos:t.pos+1}function yn(t,o,u){return u?4294967296*o+(t>>>0):4294967296*(o>>>0)+(t>>>0)}function Pn(t,o,u){var v=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(v);for(var y=u.pos-1;y>=t;y--)u.buf[y+v]=u.buf[y]}function Un(t,o){for(var u=0;u<t.length;u++)o.writeVarint(t[u])}function un(t,o){for(var u=0;u<t.length;u++)o.writeSVarint(t[u])}function Sn(t,o){for(var u=0;u<t.length;u++)o.writeFloat(t[u])}function Ln(t,o){for(var u=0;u<t.length;u++)o.writeDouble(t[u])}function sr(t,o){for(var u=0;u<t.length;u++)o.writeBoolean(t[u])}function Fr(t,o){for(var u=0;u<t.length;u++)o.writeFixed32(t[u])}function On(t,o){for(var u=0;u<t.length;u++)o.writeSFixed32(t[u])}function qn(t,o){for(var u=0;u<t.length;u++)o.writeFixed64(t[u])}function hn(t,o){for(var u=0;u<t.length;u++)o.writeSFixed64(t[u])}function ti(t,o){return(t[o]|t[o+1]<<8|t[o+2]<<16)+16777216*t[o+3]}function An(t,o,u){t[u]=o,t[u+1]=o>>>8,t[u+2]=o>>>16,t[u+3]=o>>>24}function Qn(t,o){return(t[o]|t[o+1]<<8|t[o+2]<<16)+(t[o+3]<<24)}function dn(t,o,u){t===1&&u.readMessage(Xn,o)}function Xn(t,o,u){if(t===3){var v=u.readMessage(ki,{}),y=v.width,b=v.height,T=v.left,I=v.top,Z=v.advance;o.push({id:v.id,bitmap:new of({width:y+6,height:b+6},v.bitmap),metrics:{width:y,height:b,left:T,top:I,advance:Z}})}}function ki(t,o,u){t===1?o.id=u.readVarint():t===2?o.bitmap=u.readBytes():t===3?o.width=u.readVarint():t===4?o.height=u.readVarint():t===5?o.left=u.readSVarint():t===6?o.top=u.readSVarint():t===7&&(o.advance=u.readVarint())}function ea(t){for(var o=0,u=0,v=0,y=t;v<y.length;v+=1){var b=y[v];o+=b.w*b.h,u=Math.max(u,b.w)}t.sort(function(wt,Wt){return Wt.h-wt.h});for(var T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}],I=0,Z=0,he=0,_e=t;he<_e.length;he+=1)for(var Ae=_e[he],je=T.length-1;je>=0;je--){var Je=T[je];if(!(Ae.w>Je.w||Ae.h>Je.h)){if(Ae.x=Je.x,Ae.y=Je.y,Z=Math.max(Z,Ae.y+Ae.h),I=Math.max(I,Ae.x+Ae.w),Ae.w===Je.w&&Ae.h===Je.h){var Tt=T.pop();je<T.length&&(T[je]=Tt)}else Ae.h===Je.h?(Je.x+=Ae.w,Je.w-=Ae.w):Ae.w===Je.w?(Je.y+=Ae.h,Je.h-=Ae.h):(T.push({x:Je.x+Ae.w,y:Je.y,w:Je.w-Ae.w,h:Ae.h}),Je.y+=Ae.h,Je.h-=Ae.h);break}}return{w:I,h:Z,fill:o/(I*Z)||0}}fr.prototype={destroy:function(){this.buf=null},readFields:function(t,o,u){for(u=u||this.length;this.pos<u;){var v=this.readVarint(),y=v>>3,b=this.pos;this.type=7&v,t(y,o,this),this.pos===b&&this.skip(v)}return o},readMessage:function(t,o){return this.readFields(t,o,this.readVarint()+this.pos)},readFixed32:function(){var t=ti(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Qn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ti(this.buf,this.pos)+4294967296*ti(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ti(this.buf,this.pos)+4294967296*Qn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=wr(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=wr(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var o,u,v=this.buf;return o=127&(u=v[this.pos++]),u<128?o:(o|=(127&(u=v[this.pos++]))<<7,u<128?o:(o|=(127&(u=v[this.pos++]))<<14,u<128?o:(o|=(127&(u=v[this.pos++]))<<21,u<128?o:function(y,b,T){var I,Z,he=T.buf;if(I=(112&(Z=he[T.pos++]))>>4,Z<128||(I|=(127&(Z=he[T.pos++]))<<3,Z<128)||(I|=(127&(Z=he[T.pos++]))<<10,Z<128)||(I|=(127&(Z=he[T.pos++]))<<17,Z<128)||(I|=(127&(Z=he[T.pos++]))<<24,Z<128)||(I|=(1&(Z=he[T.pos++]))<<31,Z<128))return yn(y,I,b);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(u=v[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,o=this.pos;return this.pos=t,t-o>=12&&Mn?function(u,v,y){return Mn.decode(u.subarray(v,y))}(this.buf,o,t):function(u,v,y){for(var b="",T=v;T<y;){var I,Z,he,_e=u[T],Ae=null,je=_e>239?4:_e>223?3:_e>191?2:1;if(T+je>y)break;je===1?_e<128&&(Ae=_e):je===2?(192&(I=u[T+1]))==128&&(Ae=(31&_e)<<6|63&I)<=127&&(Ae=null):je===3?(Z=u[T+2],(192&(I=u[T+1]))==128&&(192&Z)==128&&((Ae=(15&_e)<<12|(63&I)<<6|63&Z)<=2047||Ae>=55296&&Ae<=57343)&&(Ae=null)):je===4&&(Z=u[T+2],he=u[T+3],(192&(I=u[T+1]))==128&&(192&Z)==128&&(192&he)==128&&((Ae=(15&_e)<<18|(63&I)<<12|(63&Z)<<6|63&he)<=65535||Ae>=1114112)&&(Ae=null)),Ae===null?(Ae=65533,je=1):Ae>65535&&(Ae-=65536,b+=String.fromCharCode(Ae>>>10&1023|55296),Ae=56320|1023&Ae),b+=String.fromCharCode(Ae),T+=je}return b}(this.buf,o,t)},readBytes:function(){var t=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,t);return this.pos=t,o},readPackedVarint:function(t,o){if(this.type!==fr.Bytes)return t.push(this.readVarint(o));var u=gn(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(o));return t},readPackedSVarint:function(t){if(this.type!==fr.Bytes)return t.push(this.readSVarint());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==fr.Bytes)return t.push(this.readBoolean());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==fr.Bytes)return t.push(this.readFloat());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==fr.Bytes)return t.push(this.readDouble());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==fr.Bytes)return t.push(this.readFixed32());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==fr.Bytes)return t.push(this.readSFixed32());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==fr.Bytes)return t.push(this.readFixed64());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==fr.Bytes)return t.push(this.readSFixed64());var o=gn(this);for(t=t||[];this.pos<o;)t.push(this.readSFixed64());return t},skip:function(t){var o=7&t;if(o===fr.Varint)for(;this.buf[this.pos++]>127;);else if(o===fr.Bytes)this.pos=this.readVarint()+this.pos;else if(o===fr.Fixed32)this.pos+=4;else{if(o!==fr.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(t,o){this.writeVarint(t<<3|o)},realloc:function(t){for(var o=this.length||16;o<this.pos+t;)o*=2;if(o!==this.length){var u=new Uint8Array(o);u.set(this.buf),this.buf=u,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),An(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),An(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),An(this.buf,-1&t,this.pos),An(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),An(this.buf,-1&t,this.pos),An(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(o,u){var v,y;if(o>=0?(v=o%4294967296|0,y=o/4294967296|0):(y=~(-o/4294967296),4294967295^(v=~(-o%4294967296))?v=v+1|0:(v=0,y=y+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(b,T,I){I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,I.buf[I.pos]=127&(b>>>=7)}(v,0,u),function(b,T){var I=(7&b)<<4;T.buf[T.pos++]|=I|((b>>>=3)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b)))))}(y,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var o=this.pos;this.pos=function(v,y,b){for(var T,I,Z=0;Z<y.length;Z++){if((T=y.charCodeAt(Z))>55295&&T<57344){if(!I){T>56319||Z+1===y.length?(v[b++]=239,v[b++]=191,v[b++]=189):I=T;continue}if(T<56320){v[b++]=239,v[b++]=191,v[b++]=189,I=T;continue}T=I-55296<<10|T-56320|65536,I=null}else I&&(v[b++]=239,v[b++]=191,v[b++]=189,I=null);T<128?v[b++]=T:(T<2048?v[b++]=T>>6|192:(T<65536?v[b++]=T>>12|224:(v[b++]=T>>18|240,v[b++]=T>>12&63|128),v[b++]=T>>6&63|128),v[b++]=63&T|128)}return b}(this.buf,t,this.pos);var u=this.pos-o;u>=128&&Pn(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),qr(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),qr(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var o=t.length;this.writeVarint(o),this.realloc(o);for(var u=0;u<o;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,o){this.pos++;var u=this.pos;t(o,this);var v=this.pos-u;v>=128&&Pn(u,v,this),this.pos=u-1,this.writeVarint(v),this.pos+=v},writeMessage:function(t,o,u){this.writeTag(t,fr.Bytes),this.writeRawMessage(o,u)},writePackedVarint:function(t,o){o.length&&this.writeMessage(t,Un,o)},writePackedSVarint:function(t,o){o.length&&this.writeMessage(t,un,o)},writePackedBoolean:function(t,o){o.length&&this.writeMessage(t,sr,o)},writePackedFloat:function(t,o){o.length&&this.writeMessage(t,Sn,o)},writePackedDouble:function(t,o){o.length&&this.writeMessage(t,Ln,o)},writePackedFixed32:function(t,o){o.length&&this.writeMessage(t,Fr,o)},writePackedSFixed32:function(t,o){o.length&&this.writeMessage(t,On,o)},writePackedFixed64:function(t,o){o.length&&this.writeMessage(t,qn,o)},writePackedSFixed64:function(t,o){o.length&&this.writeMessage(t,hn,o)},writeBytesField:function(t,o){this.writeTag(t,fr.Bytes),this.writeBytes(o)},writeFixed32Field:function(t,o){this.writeTag(t,fr.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(t,o){this.writeTag(t,fr.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(t,o){this.writeTag(t,fr.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(t,o){this.writeTag(t,fr.Fixed64),this.writeSFixed64(o)},writeVarintField:function(t,o){this.writeTag(t,fr.Varint),this.writeVarint(o)},writeSVarintField:function(t,o){this.writeTag(t,fr.Varint),this.writeSVarint(o)},writeStringField:function(t,o){this.writeTag(t,fr.Bytes),this.writeString(o)},writeFloatField:function(t,o){this.writeTag(t,fr.Fixed32),this.writeFloat(o)},writeDoubleField:function(t,o){this.writeTag(t,fr.Fixed64),this.writeDouble(o)},writeBooleanField:function(t,o){this.writeVarintField(t,!!o)}};var Yn=function(t,o){var u=o.pixelRatio,v=o.version,y=o.stretchX,b=o.stretchY,T=o.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=y,this.stretchY=b,this.content=T,this.version=v},Cn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Cn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Cn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Cn.tlbr.get=function(){return this.tl.concat(this.br)},Cn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Yn.prototype,Cn);var Jr=function(t,o){var u={},v={};this.haveRenderCallbacks=[];var y=[];this.addImages(t,u,y),this.addImages(o,v,y);var b=ea(y),T=new xu({width:b.w||1,height:b.h||1});for(var I in t){var Z=t[I],he=u[I].paddedRect;xu.copy(Z.data,T,{x:0,y:0},{x:he.x+1,y:he.y+1},Z.data)}for(var _e in o){var Ae=o[_e],je=v[_e].paddedRect,Je=je.x+1,Tt=je.y+1,wt=Ae.data.width,Wt=Ae.data.height;xu.copy(Ae.data,T,{x:0,y:0},{x:Je,y:Tt},Ae.data),xu.copy(Ae.data,T,{x:0,y:Wt-1},{x:Je,y:Tt-1},{width:wt,height:1}),xu.copy(Ae.data,T,{x:0,y:0},{x:Je,y:Tt+Wt},{width:wt,height:1}),xu.copy(Ae.data,T,{x:wt-1,y:0},{x:Je-1,y:Tt},{width:1,height:Wt}),xu.copy(Ae.data,T,{x:0,y:0},{x:Je+wt,y:Tt},{width:1,height:Wt})}this.image=T,this.iconPositions=u,this.patternPositions=v};Jr.prototype.addImages=function(t,o,u){for(var v in t){var y=t[v],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(b),o[v]=new Yn(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(v)}},Jr.prototype.patchUpdatedImages=function(t,o){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),o)},Jr.prototype.patchUpdatedImage=function(t,o,u){if(t&&o&&t.version!==o.version){t.version=o.version;var v=t.tl;u.update(o.data,void 0,{x:v[0],y:v[1]})}},ii("ImagePosition",Yn),ii("ImageAtlas",Jr);var Di={horizontal:1,vertical:2,horizontalOnly:3},va=function(){this.scale=1,this.fontStack="",this.imageName=null};va.forText=function(t,o){var u=new va;return u.scale=t||1,u.fontStack=o,u},va.forImage=function(t){var o=new va;return o.imageName=t,o};var ri=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function pa(t,o,u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt){var Wt,zt=ri.fromFeature(t,y);Ae===Di.vertical&&zt.verticalizePunctuation();var or=fi.processBidirectionalText,dr=fi.processStyledBidirectionalText;if(or&&zt.sections.length===1){Wt=[];for(var Ar=0,kr=or(zt.toString(),us(zt,he,b,o,v,Je,Tt));Ar<kr.length;Ar+=1){var en=kr[Ar],kn=new ri;kn.text=en,kn.sections=zt.sections;for(var Hn=0;Hn<en.length;Hn++)kn.sectionIndex.push(0);Wt.push(kn)}}else if(dr){Wt=[];for(var Ci=0,oi=dr(zt.text,zt.sectionIndex,us(zt,he,b,o,v,Je,Tt));Ci<oi.length;Ci+=1){var Li=oi[Ci],si=new ri;si.text=Li[0],si.sectionIndex=Li[1],si.sections=zt.sections,Wt.push(si)}}else Wt=function(xi,Aa){for(var aa=[],ra=xi.text,Ni=0,oo=0,No=Aa;oo<No.length;oo+=1){var ko=No[oo];aa.push(xi.substring(Ni,ko)),Ni=ko}return Ni<ra.length&&aa.push(xi.substring(Ni,ra.length)),aa}(zt,us(zt,he,b,o,v,Je,Tt));var ma=[],Ki={positionedLines:ma,text:zt.toString(),top:_e[1],bottom:_e[1],left:_e[0],right:_e[0],writingMode:Ae,iconsInText:!1,verticalizable:!1};return function(xi,Aa,aa,ra,Ni,oo,No,ko,ts,Uo,ls,_s){for(var qs=0,Tu=-17,Ls=0,Ua=0,xs=ko==="right"?1:ko==="left"?0:.5,Yo=0,ka=0,Mo=Ni;ka<Mo.length;ka+=1){var xo=Mo[ka];xo.trim();var Xa=xo.getMaxScale(),ku=24*(Xa-1),Du={positionedGlyphs:[],lineOffset:0};xi.positionedLines[Yo]=Du;var gi=Du.positionedGlyphs,rs=0;if(xo.length()){for(var Lu=0;Lu<xo.length();Lu++){var na=xo.getSection(Lu),Ju=xo.getSectionIndex(Lu),Au=xo.getCharCode(Lu),Cc=0,Oo=null,Tl=null,Xl=null,hp=24,yh=!(ts===Di.horizontal||!ls&&!re(Au)||ls&&(ta[Au]||(ac=Au,S.Arabic(ac)||S["Arabic Supplement"](ac)||S["Arabic Extended-A"](ac)||S["Arabic Presentation Forms-A"](ac)||S["Arabic Presentation Forms-B"](ac))));if(na.imageName){var _o=ra[na.imageName];if(!_o)continue;Xl=na.imageName,xi.iconsInText=xi.iconsInText||!0,Tl=_o.paddedRect;var Qf=_o.displaySize;na.scale=24*na.scale/_s,Cc=ku+(24-Qf[1]*na.scale),hp=(Oo={width:Qf[0],height:Qf[1],left:1,top:-3,advance:yh?Qf[1]:Qf[0]}).advance;var pp=yh?Qf[0]*na.scale-24*Xa:Qf[1]*na.scale-24*Xa;pp>0&&pp>rs&&(rs=pp)}else{var dp=aa[na.fontStack],Uh=dp&&dp[Au];if(Uh&&Uh.rect)Tl=Uh.rect,Oo=Uh.metrics;else{var vl=Aa[na.fontStack],Jf=vl&&vl[Au];if(!Jf)continue;Oo=Jf.metrics}Cc=24*(Xa-na.scale)}yh?(xi.verticalizable=!0,gi.push({glyph:Au,imageName:Xl,x:qs,y:Tu+Cc,vertical:yh,scale:na.scale,fontStack:na.fontStack,sectionIndex:Ju,metrics:Oo,rect:Tl}),qs+=hp*na.scale+Uo):(gi.push({glyph:Au,imageName:Xl,x:qs,y:Tu+Cc,vertical:yh,scale:na.scale,fontStack:na.fontStack,sectionIndex:Ju,metrics:Oo,rect:Tl}),qs+=Oo.advance*na.scale+Uo)}gi.length!==0&&(Ls=Math.max(qs-Uo,Ls),Ss(gi,0,gi.length-1,xs,rs)),qs=0;var eh=oo*Xa+rs;Du.lineOffset=Math.max(rs,ku),Tu+=eh,Ua=Math.max(eh,Ua),++Yo}else Tu+=oo,++Yo}var ac,_h=Tu- -17,xh=Ro(No),Nf=xh.horizontalAlign,bh=xh.verticalAlign;(function(vp,zh,th,rh,mp,Zh,gp,yp,Pd){var Vh,kd=(zh-th)*mp;Vh=Zh!==gp?-yp*rh- -17:(-rh*Pd+.5)*gp;for(var Eh=0,pf=vp;Eh<pf.length;Eh+=1)for(var Sh=0,_p=pf[Eh].positionedGlyphs;Sh<_p.length;Sh+=1){var nh=_p[Sh];nh.x+=kd,nh.y+=Vh}})(xi.positionedLines,xs,Nf,bh,Ls,Ua,oo,_h,Ni.length),xi.top+=-bh*_h,xi.bottom=xi.top+_h,xi.left+=-Nf*Ls,xi.right=xi.left+Ls}(Ki,o,u,v,Wt,T,I,Z,Ae,he,je,wt),!function(xi){for(var Aa=0,aa=xi;Aa<aa.length;Aa+=1)if(aa[Aa].positionedGlyphs.length!==0)return!1;return!0}(ma)&&Ki}ri.fromFeature=function(t,o){for(var u=new ri,v=0;v<t.sections.length;v++){var y=t.sections[v];y.image?u.addImageSection(y):u.addTextSection(y,o)}return u},ri.prototype.length=function(){return this.text.length},ri.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ri.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ri.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ri.prototype.verticalizePunctuation=function(){this.text=function(t){for(var o="",u=0;u<t.length;u++){var v=t.charCodeAt(u+1)||null,y=t.charCodeAt(u-1)||null;o+=v&&ce(v)&&!Lt[t[u+1]]||y&&ce(y)&&!Lt[t[u-1]]||!Lt[t[u]]?t[u]:Lt[t[u]]}return o}(this.text)},ri.prototype.trim=function(){for(var t=0,o=0;o<this.text.length&&ta[this.text.charCodeAt(o)];o++)t++;for(var u=this.text.length,v=this.text.length-1;v>=0&&v>=t&&ta[this.text.charCodeAt(v)];v--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},ri.prototype.substring=function(t,o){var u=new ri;return u.text=this.text.substring(t,o),u.sectionIndex=this.sectionIndex.slice(t,o),u.sections=this.sections,u},ri.prototype.toString=function(){return this.text},ri.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(o,u){return Math.max(o,t.sections[u].scale)},0)},ri.prototype.addTextSection=function(t,o){this.text+=t.text,this.sections.push(va.forText(t.scale,t.fontStack||o));for(var u=this.sections.length-1,v=0;v<t.text.length;++v)this.sectionIndex.push(u)},ri.prototype.addImageSection=function(t){var o=t.image?t.image.name:"";if(o.length!==0){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(va.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Te("Reached maximum number of images 6401")}else Te("Can't add FormattedSection with an empty image.")},ri.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ta={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Wi={};function Wa(t,o,u,v,y,b){if(o.imageName){var T=v[o.imageName];return T?T.displaySize[0]*o.scale*24/b+y:0}var I=u[o.fontStack],Z=I&&I[t];return Z?Z.metrics.advance*o.scale+y:0}function ms(t,o,u,v){var y=Math.pow(t-o,2);return v?t<o?y/2:2*y:y+Math.abs(u)*u}function js(t,o,u){var v=0;return t===10&&(v-=1e4),u&&(v+=150),t!==40&&t!==65288||(v+=50),o!==41&&o!==65289||(v+=50),v}function Ia(t,o,u,v,y,b){for(var T=null,I=ms(o,u,y,b),Z=0,he=v;Z<he.length;Z+=1){var _e=he[Z],Ae=ms(o-_e.x,u,y,b)+_e.badness;Ae<=I&&(T=_e,I=Ae)}return{index:t,x:o,priorBreak:T,badness:I}}function us(t,o,u,v,y,b,T){if(b!=="point")return[];if(!t)return[];for(var I,Z=[],he=function(Wt,zt,or,dr,Ar,kr){for(var en=0,kn=0;kn<Wt.length();kn++){var Hn=Wt.getSection(kn);en+=Wa(Wt.getCharCode(kn),Hn,dr,Ar,zt,kr)}return en/Math.max(1,Math.ceil(en/or))}(t,o,u,v,y,T),_e=t.text.indexOf("\u200B")>=0,Ae=0,je=0;je<t.length();je++){var Je=t.getSection(je),Tt=t.getCharCode(je);if(ta[Tt]||(Ae+=Wa(Tt,Je,v,y,o,T)),je<t.length()-1){var wt=!((I=Tt)<11904||!(S["Bopomofo Extended"](I)||S.Bopomofo(I)||S["CJK Compatibility Forms"](I)||S["CJK Compatibility Ideographs"](I)||S["CJK Compatibility"](I)||S["CJK Radicals Supplement"](I)||S["CJK Strokes"](I)||S["CJK Symbols and Punctuation"](I)||S["CJK Unified Ideographs Extension A"](I)||S["CJK Unified Ideographs"](I)||S["Enclosed CJK Letters and Months"](I)||S["Halfwidth and Fullwidth Forms"](I)||S.Hiragana(I)||S["Ideographic Description Characters"](I)||S["Kangxi Radicals"](I)||S["Katakana Phonetic Extensions"](I)||S.Katakana(I)||S["Vertical Forms"](I)||S["Yi Radicals"](I)||S["Yi Syllables"](I)));(Wi[Tt]||wt||Je.imageName)&&Z.push(Ia(je+1,Ae,he,Z,js(Tt,t.getCharCode(je+1),wt&&_e),!1))}}return function Wt(zt){return zt?Wt(zt.priorBreak).concat(zt.index):[]}(Ia(t.length(),Ae,he,Z,0,!0))}function Ro(t){var o=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function Ss(t,o,u,v,y){if(v||y)for(var b=t[u],T=(t[u].x+b.metrics.advance*b.scale)*v,I=o;I<=u;I++)t[I].x-=T,t[I].y+=y}function Ts(t,o,u,v,y,b){var T,I=t.image;if(I.content){var Z=I.content,he=I.pixelRatio||1;T=[Z[0]/he,Z[1]/he,I.displaySize[0]-Z[2]/he,I.displaySize[1]-Z[3]/he]}var _e,Ae,je,Je,Tt=o.left*b,wt=o.right*b;u==="width"||u==="both"?(Je=y[0]+Tt-v[3],Ae=y[0]+wt+v[1]):Ae=(Je=y[0]+(Tt+wt-I.displaySize[0])/2)+I.displaySize[0];var Wt=o.top*b,zt=o.bottom*b;return u==="height"||u==="both"?(_e=y[1]+Wt-v[0],je=y[1]+zt+v[2]):je=(_e=y[1]+(Wt+zt-I.displaySize[1])/2)+I.displaySize[1],{image:I,top:_e,right:Ae,bottom:je,left:Je,collisionPadding:T}}Wi[10]=!0,Wi[32]=!0,Wi[38]=!0,Wi[40]=!0,Wi[41]=!0,Wi[43]=!0,Wi[45]=!0,Wi[47]=!0,Wi[173]=!0,Wi[183]=!0,Wi[8203]=!0,Wi[8208]=!0,Wi[8211]=!0,Wi[8231]=!0;var Go=function(t){function o(u,v,y,b){t.call(this,u,v),this.angle=y,b!==void 0&&(this.segment=b)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.clone=function(){return new o(this.x,this.y,this.angle,this.segment)},o}(W);function ks(t,o){var u=o.expression;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Gr(t+1))};if(u.kind==="source")return{kind:"source"};for(var v=u.zoomStops,y=u.interpolationType,b=0;b<v.length&&v[b]<=t;)b++;for(var T=b=Math.max(0,b-1);T<v.length&&v[T]<t+1;)T++;T=Math.min(v.length-1,T);var I=v[b],Z=v[T];return u.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:Z,interpolationType:y}:{kind:"camera",minZoom:I,maxZoom:Z,minSize:u.evaluate(new Gr(I)),maxSize:u.evaluate(new Gr(Z)),interpolationType:y}}function ou(t,o,u){var v=o.uSize,y=u.lowerSize;return t.kind==="source"?y/128:t.kind==="composite"?Ei(y/128,u.upperSize/128,o.uSizeT):v}function gs(t,o){var u=0,v=0;if(t.kind==="constant")v=t.layoutSize;else if(t.kind!=="source"){var y=t.interpolationType,b=y?U(hs.interpolationFactor(y,o,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?v=Ei(t.minSize,t.maxSize,b):u=b}return{uSizeT:u,uSize:v}}ii("Anchor",Go);var la=Object.freeze({__proto__:null,getSizeData:ks,evaluateSizeForFeature:ou,evaluateSizeForZoom:gs,SIZE_PACK_FACTOR:128});function Ys(t,o,u,v,y){if(o.segment===void 0)return!0;for(var b=o,T=o.segment+1,I=0;I>-u/2;){if(--T<0)return!1;I-=t[T].dist(b),b=t[T]}I+=t[T].dist(t[T+1]),T++;for(var Z=[],he=0;I<u/2;){var _e=t[T],Ae=t[T+1];if(!Ae)return!1;var je=t[T-1].angleTo(_e)-_e.angleTo(Ae);for(je=Math.abs((je+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:I,angleDelta:je}),he+=je;I-Z[0].distance>v;)he-=Z.shift().angleDelta;if(he>y)return!1;T++,I+=_e.dist(Ae)}return!0}function io(t){for(var o=0,u=0;u<t.length-1;u++)o+=t[u].dist(t[u+1]);return o}function Zi(t,o,u){return t?.6*o*u:0}function Ta(t,o){return Math.max(t?t.right-t.left:0,o?o.right-o.left:0)}function Ga(t,o,u,v,y,b){for(var T=Zi(u,y,b),I=Ta(u,v)*b,Z=0,he=io(t)/2,_e=0;_e<t.length-1;_e++){var Ae=t[_e],je=t[_e+1],Je=Ae.dist(je);if(Z+Je>he){var Tt=(he-Z)/Je,wt=Ei(Ae.x,je.x,Tt),Wt=Ei(Ae.y,je.y,Tt),zt=new Go(wt,Wt,je.angleTo(Ae),_e);return zt._round(),!T||Ys(t,zt,I,T,o)?zt:void 0}Z+=Je}}function ys(t,o,u,v,y,b,T,I,Z){var he=Zi(v,b,T),_e=Ta(v,y),Ae=_e*T,je=t[0].x===0||t[0].x===Z||t[0].y===0||t[0].y===Z;return o-Ae<o/4&&(o=Ae+o/4),function Je(Tt,wt,Wt,zt,or,dr,Ar,kr,en){for(var kn=dr/2,Hn=io(Tt),Ci=0,oi=wt-Wt,Li=[],si=0;si<Tt.length-1;si++){for(var ma=Tt[si],Ki=Tt[si+1],xi=ma.dist(Ki),Aa=Ki.angleTo(ma);oi+Wt<Ci+xi;){var aa=((oi+=Wt)-Ci)/xi,ra=Ei(ma.x,Ki.x,aa),Ni=Ei(ma.y,Ki.y,aa);if(ra>=0&&ra<en&&Ni>=0&&Ni<en&&oi-kn>=0&&oi+kn<=Hn){var oo=new Go(ra,Ni,Aa,si);oo._round(),zt&&!Ys(Tt,oo,dr,zt,or)||Li.push(oo)}}Ci+=xi}return kr||Li.length||Ar||(Li=Je(Tt,Ci/2,Wt,zt,or,dr,Ar,!0,en)),Li}(t,je?o/2*I%o:(_e/2+2*b)*T*I%o,o,he,u,Ae,je,!1,Z)}function ic(t,o,u,v,y){for(var b=[],T=0;T<t.length;T++)for(var I=t[T],Z=void 0,he=0;he<I.length-1;he++){var _e=I[he],Ae=I[he+1];_e.x<o&&Ae.x<o||(_e.x<o?_e=new W(o,_e.y+(o-_e.x)/(Ae.x-_e.x)*(Ae.y-_e.y))._round():Ae.x<o&&(Ae=new W(o,_e.y+(o-_e.x)/(Ae.x-_e.x)*(Ae.y-_e.y))._round()),_e.y<u&&Ae.y<u||(_e.y<u?_e=new W(_e.x+(u-_e.y)/(Ae.y-_e.y)*(Ae.x-_e.x),u)._round():Ae.y<u&&(Ae=new W(_e.x+(u-_e.y)/(Ae.y-_e.y)*(Ae.x-_e.x),u)._round()),_e.x>=v&&Ae.x>=v||(_e.x>=v?_e=new W(v,_e.y+(v-_e.x)/(Ae.x-_e.x)*(Ae.y-_e.y))._round():Ae.x>=v&&(Ae=new W(v,_e.y+(v-_e.x)/(Ae.x-_e.x)*(Ae.y-_e.y))._round()),_e.y>=y&&Ae.y>=y||(_e.y>=y?_e=new W(_e.x+(y-_e.y)/(Ae.y-_e.y)*(Ae.x-_e.x),y)._round():Ae.y>=y&&(Ae=new W(_e.x+(y-_e.y)/(Ae.y-_e.y)*(Ae.x-_e.x),y)._round()),Z&&_e.equals(Z[Z.length-1])||b.push(Z=[_e]),Z.push(Ae)))))}return b}function Ct(t,o,u,v){var y=[],b=t.image,T=b.pixelRatio,I=b.paddedRect.w-2,Z=b.paddedRect.h-2,he=t.right-t.left,_e=t.bottom-t.top,Ae=b.stretchX||[[0,I]],je=b.stretchY||[[0,Z]],Je=function(ra,Ni){return ra+Ni[1]-Ni[0]},Tt=Ae.reduce(Je,0),wt=je.reduce(Je,0),Wt=I-Tt,zt=Z-wt,or=0,dr=Tt,Ar=0,kr=wt,en=0,kn=Wt,Hn=0,Ci=zt;if(b.content&&v){var oi=b.content;or=Mr(Ae,0,oi[0]),Ar=Mr(je,0,oi[1]),dr=Mr(Ae,oi[0],oi[2]),kr=Mr(je,oi[1],oi[3]),en=oi[0]-or,Hn=oi[1]-Ar,kn=oi[2]-oi[0]-dr,Ci=oi[3]-oi[1]-kr}var Li=function(ra,Ni,oo,No){var ko=ai(ra.stretch-or,dr,he,t.left),ts=ca(ra.fixed-en,kn,ra.stretch,Tt),Uo=ai(Ni.stretch-Ar,kr,_e,t.top),ls=ca(Ni.fixed-Hn,Ci,Ni.stretch,wt),_s=ai(oo.stretch-or,dr,he,t.left),qs=ca(oo.fixed-en,kn,oo.stretch,Tt),Tu=ai(No.stretch-Ar,kr,_e,t.top),Ls=ca(No.fixed-Hn,Ci,No.stretch,wt),Ua=new W(ko,Uo),xs=new W(_s,Uo),Yo=new W(_s,Tu),ka=new W(ko,Tu),Mo=new W(ts/T,ls/T),xo=new W(qs/T,Ls/T),Xa=o*Math.PI/180;if(Xa){var ku=Math.sin(Xa),Du=Math.cos(Xa),gi=[Du,-ku,ku,Du];Ua._matMult(gi),xs._matMult(gi),ka._matMult(gi),Yo._matMult(gi)}var rs=ra.stretch+ra.fixed,Lu=Ni.stretch+Ni.fixed;return{tl:Ua,tr:xs,bl:ka,br:Yo,tex:{x:b.paddedRect.x+1+rs,y:b.paddedRect.y+1+Lu,w:oo.stretch+oo.fixed-rs,h:No.stretch+No.fixed-Lu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mo,pixelOffsetBR:xo,minFontScaleX:kn/T/he,minFontScaleY:Ci/T/_e,isSDF:u}};if(v&&(b.stretchX||b.stretchY))for(var si=yr(Ae,Wt,Tt),ma=yr(je,zt,wt),Ki=0;Ki<si.length-1;Ki++)for(var xi=si[Ki],Aa=si[Ki+1],aa=0;aa<ma.length-1;aa++)y.push(Li(xi,ma[aa],Aa,ma[aa+1]));else y.push(Li({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:Z+1}));return y}function Mr(t,o,u){for(var v=0,y=0,b=t;y<b.length;y+=1){var T=b[y];v+=Math.max(o,Math.min(u,T[1]))-Math.max(o,Math.min(u,T[0]))}return v}function yr(t,o,u){for(var v=[{fixed:-1,stretch:0}],y=0,b=t;y<b.length;y+=1){var T=b[y],I=T[0],Z=T[1],he=v[v.length-1];v.push({fixed:I-he.stretch,stretch:he.stretch}),v.push({fixed:I-he.stretch,stretch:he.stretch+(Z-I)})}return v.push({fixed:o+1,stretch:u}),v}function ai(t,o,u,v){return t/o*u+v}function ca(t,o,u,v){return t-o*u/v}var yo=function(t,o,u,v,y,b,T,I,Z,he){if(this.boxStartIndex=t.length,Z){var _e=b.top,Ae=b.bottom,je=b.collisionPadding;je&&(_e-=je[1],Ae+=je[3]);var Je=Ae-_e;Je>0&&(Je=Math.max(10,Je),this.circleDiameter=Je)}else{var Tt=b.top*T-I,wt=b.bottom*T+I,Wt=b.left*T-I,zt=b.right*T+I,or=b.collisionPadding;if(or&&(Wt-=or[0]*T,Tt-=or[1]*T,zt+=or[2]*T,wt+=or[3]*T),he){var dr=new W(Wt,Tt),Ar=new W(zt,Tt),kr=new W(Wt,wt),en=new W(zt,wt),kn=he*Math.PI/180;dr._rotate(kn),Ar._rotate(kn),kr._rotate(kn),en._rotate(kn),Wt=Math.min(dr.x,Ar.x,kr.x,en.x),zt=Math.max(dr.x,Ar.x,kr.x,en.x),Tt=Math.min(dr.y,Ar.y,kr.y,en.y),wt=Math.max(dr.y,Ar.y,kr.y,en.y)}t.emplaceBack(o.x,o.y,Wt,Tt,zt,wt,u,v,y)}this.boxEndIndex=t.length},Ke=function(t,o){if(t===void 0&&(t=[]),o===void 0&&(o=yt),this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function yt(t,o){return t<o?-1:t>o?1:0}function Nt(t,o,u){o===void 0&&(o=1),u===void 0&&(u=!1);for(var v=1/0,y=1/0,b=-1/0,T=-1/0,I=t[0],Z=0;Z<I.length;Z++){var he=I[Z];(!Z||he.x<v)&&(v=he.x),(!Z||he.y<y)&&(y=he.y),(!Z||he.x>b)&&(b=he.x),(!Z||he.y>T)&&(T=he.y)}var _e=Math.min(b-v,T-y),Ae=_e/2,je=new Ke([],br);if(_e===0)return new W(v,y);for(var Je=v;Je<b;Je+=_e)for(var Tt=y;Tt<T;Tt+=_e)je.push(new mr(Je+Ae,Tt+Ae,Ae,t));for(var wt=function(or){for(var dr=0,Ar=0,kr=0,en=or[0],kn=0,Hn=en.length,Ci=Hn-1;kn<Hn;Ci=kn++){var oi=en[kn],Li=en[Ci],si=oi.x*Li.y-Li.x*oi.y;Ar+=(oi.x+Li.x)*si,kr+=(oi.y+Li.y)*si,dr+=3*si}return new mr(Ar/dr,kr/dr,0,or)}(t),Wt=je.length;je.length;){var zt=je.pop();(zt.d>wt.d||!wt.d)&&(wt=zt,u&&console.log("found best %d after %d probes",Math.round(1e4*zt.d)/1e4,Wt)),zt.max-wt.d<=o||(je.push(new mr(zt.p.x-(Ae=zt.h/2),zt.p.y-Ae,Ae,t)),je.push(new mr(zt.p.x+Ae,zt.p.y-Ae,Ae,t)),je.push(new mr(zt.p.x-Ae,zt.p.y+Ae,Ae,t)),je.push(new mr(zt.p.x+Ae,zt.p.y+Ae,Ae,t)),Wt+=4)}return u&&(console.log("num probes: "+Wt),console.log("best distance: "+wt.d)),wt.p}function br(t,o){return o.max-t.max}function mr(t,o,u,v){this.p=new W(t,o),this.h=u,this.d=function(y,b){for(var T=!1,I=1/0,Z=0;Z<b.length;Z++)for(var he=b[Z],_e=0,Ae=he.length,je=Ae-1;_e<Ae;je=_e++){var Je=he[_e],Tt=he[je];Je.y>y.y!=Tt.y>y.y&&y.x<(Tt.x-Je.x)*(y.y-Je.y)/(Tt.y-Je.y)+Je.x&&(T=!T),I=Math.min(I,Qo(y,Je,Tt))}return(T?1:-1)*Math.sqrt(I)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}Ke.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Ke.prototype.pop=function(){if(this.length!==0){var t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}},Ke.prototype.peek=function(){return this.data[0]},Ke.prototype._up=function(t){for(var o=this.data,u=this.compare,v=o[t];t>0;){var y=t-1>>1,b=o[y];if(u(v,b)>=0)break;o[t]=b,t=y}o[t]=v},Ke.prototype._down=function(t){for(var o=this.data,u=this.compare,v=this.length>>1,y=o[t];t<v;){var b=1+(t<<1),T=o[b],I=b+1;if(I<this.length&&u(o[I],T)<0&&(b=I,T=o[I]),u(T,y)>=0)break;o[t]=T,t=b}o[t]=y};var Ht=Number.POSITIVE_INFINITY;function Jt(t,o){return o[1]!==Ht?function(u,v,y){var b=0,T=0;switch(v=Math.abs(v),y=Math.abs(y),u){case"top-right":case"top-left":case"top":T=y-7;break;case"bottom-right":case"bottom-left":case"bottom":T=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-v;break;case"top-left":case"bottom-left":case"left":b=v}return[b,T]}(t,o[0],o[1]):function(u,v){var y=0,b=0;v<0&&(v=0);var T=v/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=T-7;break;case"bottom-right":case"bottom-left":b=7-T;break;case"bottom":b=7-v;break;case"top":b=v-7}switch(u){case"top-right":case"bottom-right":y=-T;break;case"top-left":case"bottom-left":y=T;break;case"left":y=v;break;case"right":y=-v}return[y,b]}(t,o[0])}function tr(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mt(t,o,u,v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt){var wt=function(Ar,kr,en,kn,Hn,Ci,oi,Li){for(var si=kn.layout.get("text-rotate").evaluate(Ci,{})*Math.PI/180,ma=[],Ki=0,xi=kr.positionedLines;Ki<xi.length;Ki+=1)for(var Aa=xi[Ki],aa=0,ra=Aa.positionedGlyphs;aa<ra.length;aa+=1){var Ni=ra[aa];if(Ni.rect){var oo=Ni.rect||{},No=4,ko=!0,ts=1,Uo=0,ls=(Hn||Li)&&Ni.vertical,_s=Ni.metrics.advance*Ni.scale/2;if(Li&&kr.verticalizable&&(Uo=Aa.lineOffset/2-(Ni.imageName?-(24-Ni.metrics.width*Ni.scale)/2:24*(Ni.scale-1))),Ni.imageName){var qs=oi[Ni.imageName];ko=qs.sdf,No=1/(ts=qs.pixelRatio)}var Tu=Hn?[Ni.x+_s,Ni.y]:[0,0],Ls=Hn?[0,0]:[Ni.x+_s+en[0],Ni.y+en[1]-Uo],Ua=[0,0];ls&&(Ua=Ls,Ls=[0,0]);var xs=(Ni.metrics.left-No)*Ni.scale-_s+Ls[0],Yo=(-Ni.metrics.top-No)*Ni.scale+Ls[1],ka=xs+oo.w*Ni.scale/ts,Mo=Yo+oo.h*Ni.scale/ts,xo=new W(xs,Yo),Xa=new W(ka,Yo),ku=new W(xs,Mo),Du=new W(ka,Mo);if(ls){var gi=new W(-_s,_s- -17),rs=-Math.PI/2,Lu=12-_s,na=new W(22-Lu,-(Ni.imageName?Lu:0)),Ju=new(Function.prototype.bind.apply(W,[null].concat(Ua)));xo._rotateAround(rs,gi)._add(na)._add(Ju),Xa._rotateAround(rs,gi)._add(na)._add(Ju),ku._rotateAround(rs,gi)._add(na)._add(Ju),Du._rotateAround(rs,gi)._add(na)._add(Ju)}if(si){var Au=Math.sin(si),Cc=Math.cos(si),Oo=[Cc,-Au,Au,Cc];xo._matMult(Oo),Xa._matMult(Oo),ku._matMult(Oo),Du._matMult(Oo)}var Tl=new W(0,0),Xl=new W(0,0);ma.push({tl:xo,tr:Xa,bl:ku,br:Du,tex:oo,writingMode:kr.writingMode,glyphOffset:Tu,sectionIndex:Ni.sectionIndex,isSDF:ko,pixelOffsetTL:Tl,pixelOffsetBR:Xl,minFontScaleX:0,minFontScaleY:0})}}return ma}(0,u,I,y,b,T,v,t.allowVerticalPlacement),Wt=t.textSizeData,zt=null;Wt.kind==="source"?(zt=[128*y.layout.get("text-size").evaluate(T,{})])[0]>32640&&Te(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Wt.kind==="composite"&&((zt=[128*Je.compositeTextSizes[0].evaluate(T,{},Tt),128*Je.compositeTextSizes[1].evaluate(T,{},Tt)])[0]>32640||zt[1]>32640)&&Te(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,wt,zt,I,b,T,he,o,Z.lineStartIndex,Z.lineLength,je,Tt);for(var or=0,dr=_e;or<dr.length;or+=1)Ae[dr[or]]=t.text.placedSymbolArray.length-1;return 4*wt.length}function Xt(t){for(var o in t)return t[o];return null}function mt(t,o,u,v){var y=t.compareText;if(o in y){for(var b=y[o],T=b.length-1;T>=0;T--)if(v.dist(b[T])<u)return!0}else y[o]=[];return y[o].push(v),!1}var Qt=ff.VectorTileFeature.types,Ir=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zr(t,o,u,v,y,b,T,I,Z,he,_e,Ae,je){var Je=I?Math.min(32640,Math.round(I[0])):0,Tt=I?Math.min(32640,Math.round(I[1])):0;t.emplaceBack(o,u,Math.round(32*v),Math.round(32*y),b,T,(Je<<1)+(Z?1:0),Tt,16*he,16*_e,256*Ae,256*je)}function mn(t,o,u){t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u)}function an(t){for(var o=0,u=t.sections;o<u.length;o+=1)if(ut(u[o].text))return!0;return!1}var En=function(t){this.layoutVertexArray=new $f,this.indexArray=new Ui,this.programConfigurations=t,this.segments=new tt,this.dynamicLayoutVertexArray=new ll,this.opacityVertexArray=new El,this.placedSymbolArray=new m};En.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},En.prototype.upload=function(t,o,u,v){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vv.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,mv.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ir,!0),this.opacityVertexBuffer.itemSize=1),(u||v)&&this.programConfigurations.upload(t))},En.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ii("SymbolBuffers",En);var mi=function(t,o,u){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new u,this.segments=new tt,this.collisionVertexArray=new _c};mi.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,lp.members,!0)},mi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ii("CollisionBuffers",mi);var hi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(b){return b.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ps([]),this.placementViewportMatrix=Ps([]);var o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ks(this.zoom,o["text-size"]),this.iconSizeData=ks(this.zoom,o["icon-size"]);var u=this.layers[0].layout,v=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(b){return Di[b]})),this.stateDependentLayerIds=this.layers.filter(function(b){return b.isStateDependent()}).map(function(b){return b.id}),this.sourceID=t.sourceID};hi.prototype.createArrays=function(){this.text=new En(new Kr(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new En(new Kr(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new O,this.lineVertexArray=new $,this.symbolInstances=new R},hi.prototype.calculateGlyphDependencies=function(t,o,u,v,y){for(var b=0;b<t.length;b++)if(o[t.charCodeAt(b)]=!0,(u||v)&&y){var T=Lt[t.charAt(b)];T&&(o[T.charCodeAt(0)]=!0)}},hi.prototype.populate=function(t,o,u){var v=this.layers[0],y=v.layout,b=y.get("text-font"),T=y.get("text-field"),I=y.get("icon-image"),Z=(T.value.kind!=="constant"||T.value.value instanceof Da&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),he=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,_e=y.get("symbol-sort-key");if(this.features=[],Z||he){for(var Ae=o.iconDependencies,je=o.glyphDependencies,Je=o.availableImages,Tt=new Gr(this.zoom),wt=0,Wt=t;wt<Wt.length;wt+=1){var zt=Wt[wt],or=zt.feature,dr=zt.id,Ar=zt.index,kr=zt.sourceLayerIndex,en=v._featureFilter.needGeometry,kn=Oi(or,en);if(v._featureFilter.filter(Tt,kn,u)){en||(kn.geometry=Si(or));var Hn=void 0;if(Z){var Ci=v.getValueAndResolveTokens("text-field",kn,u,Je),oi=Da.factory(Ci);an(oi)&&(this.hasRTLText=!0),(!this.hasRTLText||Bn()==="unavailable"||this.hasRTLText&&fi.isParsed())&&(Hn=ht(oi,v,kn))}var Li=void 0;if(he){var si=v.getValueAndResolveTokens("icon-image",kn,u,Je);Li=si instanceof Za?si:Za.fromString(si)}if(Hn||Li){var ma=this.sortFeaturesByKey?_e.evaluate(kn,{},u):void 0;if(this.features.push({id:dr,text:Hn,icon:Li,index:Ar,sourceLayerIndex:kr,geometry:kn.geometry,properties:or.properties,type:Qt[or.type],sortKey:ma}),Li&&(Ae[Li.name]=!0),Hn){var Ki=b.evaluate(kn,{},u).join(","),xi=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Di.vertical)>=0;for(var Aa=0,aa=Hn.sections;Aa<aa.length;Aa+=1){var ra=aa[Aa];if(ra.image)Ae[ra.image.name]=!0;else{var Ni=Ge(Hn.toString()),oo=ra.fontStack||Ki,No=je[oo]=je[oo]||{};this.calculateGlyphDependencies(ra.text,No,xi,this.allowVerticalPlacement,Ni)}}}}}}y.get("symbol-placement")==="line"&&(this.features=function(ko){var ts={},Uo={},ls=[],_s=0;function qs(gi){ls.push(ko[gi]),_s++}function Tu(gi,rs,Lu){var na=Uo[gi];return delete Uo[gi],Uo[rs]=na,ls[na].geometry[0].pop(),ls[na].geometry[0]=ls[na].geometry[0].concat(Lu[0]),na}function Ls(gi,rs,Lu){var na=ts[rs];return delete ts[rs],ts[gi]=na,ls[na].geometry[0].shift(),ls[na].geometry[0]=Lu[0].concat(ls[na].geometry[0]),na}function Ua(gi,rs,Lu){var na=Lu?rs[0][rs[0].length-1]:rs[0][0];return gi+":"+na.x+":"+na.y}for(var xs=0;xs<ko.length;xs++){var Yo=ko[xs],ka=Yo.geometry,Mo=Yo.text?Yo.text.toString():null;if(Mo){var xo=Ua(Mo,ka),Xa=Ua(Mo,ka,!0);if(xo in Uo&&Xa in ts&&Uo[xo]!==ts[Xa]){var ku=Ls(xo,Xa,ka),Du=Tu(xo,Xa,ls[ku].geometry);delete ts[xo],delete Uo[Xa],Uo[Ua(Mo,ls[Du].geometry,!0)]=Du,ls[ku].geometry=null}else xo in Uo?Tu(xo,Xa,ka):Xa in ts?Ls(xo,Xa,ka):(qs(xs),ts[xo]=_s-1,Uo[Xa]=_s-1)}else qs(xs)}return ls.filter(function(gi){return gi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ko,ts){return ko.sortKey-ts.sortKey})}},hi.prototype.update=function(t,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,u))},hi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},hi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hi.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hi.prototype.addToLineVertexArray=function(t,o){var u=this.lineVertexArray.length;if(t.segment!==void 0){for(var v=t.dist(o[t.segment+1]),y=t.dist(o[t.segment]),b={},T=t.segment+1;T<o.length;T++)b[T]={x:o[T].x,y:o[T].y,tileUnitDistanceFromAnchor:v},T<o.length-1&&(v+=o[T+1].dist(o[T]));for(var I=t.segment||0;I>=0;I--)b[I]={x:o[I].x,y:o[I].y,tileUnitDistanceFromAnchor:y},I>0&&(y+=o[I-1].dist(o[I]));for(var Z=0;Z<o.length;Z++){var he=b[Z];this.lineVertexArray.emplaceBack(he.x,he.y,he.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},hi.prototype.addSymbols=function(t,o,u,v,y,b,T,I,Z,he,_e,Ae){for(var je=t.indexArray,Je=t.layoutVertexArray,Tt=t.segments.prepareSegment(4*o.length,Je,je,this.canOverlap?b.sortKey:void 0),wt=this.glyphOffsetArray.length,Wt=Tt.vertexLength,zt=this.allowVerticalPlacement&&T===Di.vertical?Math.PI/2:0,or=b.text&&b.text.sections,dr=0;dr<o.length;dr++){var Ar=o[dr],kr=Ar.tl,en=Ar.tr,kn=Ar.bl,Hn=Ar.br,Ci=Ar.tex,oi=Ar.pixelOffsetTL,Li=Ar.pixelOffsetBR,si=Ar.minFontScaleX,ma=Ar.minFontScaleY,Ki=Ar.glyphOffset,xi=Ar.isSDF,Aa=Ar.sectionIndex,aa=Tt.vertexLength,ra=Ki[1];zr(Je,I.x,I.y,kr.x,ra+kr.y,Ci.x,Ci.y,u,xi,oi.x,oi.y,si,ma),zr(Je,I.x,I.y,en.x,ra+en.y,Ci.x+Ci.w,Ci.y,u,xi,Li.x,oi.y,si,ma),zr(Je,I.x,I.y,kn.x,ra+kn.y,Ci.x,Ci.y+Ci.h,u,xi,oi.x,Li.y,si,ma),zr(Je,I.x,I.y,Hn.x,ra+Hn.y,Ci.x+Ci.w,Ci.y+Ci.h,u,xi,Li.x,Li.y,si,ma),mn(t.dynamicLayoutVertexArray,I,zt),je.emplaceBack(aa,aa+1,aa+2),je.emplaceBack(aa+1,aa+2,aa+3),Tt.vertexLength+=4,Tt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ki[0]),dr!==o.length-1&&Aa===o[dr+1].sectionIndex||t.programConfigurations.populatePaintArrays(Je.length,b,b.index,{},Ae,or&&or[Aa])}t.placedSymbolArray.emplaceBack(I.x,I.y,wt,this.glyphOffsetArray.length-wt,Wt,Z,he,I.segment,u?u[0]:0,u?u[1]:0,v[0],v[1],T,0,!1,0,_e)},hi.prototype._addCollisionDebugVertex=function(t,o,u,v,y,b){return o.emplaceBack(0,0),t.emplaceBack(u.x,u.y,v,y,Math.round(b.x),Math.round(b.y))},hi.prototype.addCollisionDebugVertices=function(t,o,u,v,y,b,T){var I=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),Z=I.vertexLength,he=y.layoutVertexArray,_e=y.collisionVertexArray,Ae=T.anchorX,je=T.anchorY;this._addCollisionDebugVertex(he,_e,b,Ae,je,new W(t,o)),this._addCollisionDebugVertex(he,_e,b,Ae,je,new W(u,o)),this._addCollisionDebugVertex(he,_e,b,Ae,je,new W(u,v)),this._addCollisionDebugVertex(he,_e,b,Ae,je,new W(t,v)),I.vertexLength+=4;var Je=y.indexArray;Je.emplaceBack(Z,Z+1),Je.emplaceBack(Z+1,Z+2),Je.emplaceBack(Z+2,Z+3),Je.emplaceBack(Z+3,Z),I.primitiveLength+=4},hi.prototype.addDebugCollisionBoxes=function(t,o,u,v){for(var y=t;y<o;y++){var b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,v?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}},hi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mi(cl,cp.members,$l),this.iconCollisionBox=new mi(cl,cp.members,$l);for(var t=0;t<this.symbolInstances.length;t++){var o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}},hi.prototype._deserializeCollisionBoxesForSymbol=function(t,o,u,v,y,b,T,I,Z){for(var he={},_e=o;_e<u;_e++){var Ae=t.get(_e);he.textBox={x1:Ae.x1,y1:Ae.y1,x2:Ae.x2,y2:Ae.y2,anchorPointX:Ae.anchorPointX,anchorPointY:Ae.anchorPointY},he.textFeatureIndex=Ae.featureIndex;break}for(var je=v;je<y;je++){var Je=t.get(je);he.verticalTextBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},he.verticalTextFeatureIndex=Je.featureIndex;break}for(var Tt=b;Tt<T;Tt++){var wt=t.get(Tt);he.iconBox={x1:wt.x1,y1:wt.y1,x2:wt.x2,y2:wt.y2,anchorPointX:wt.anchorPointX,anchorPointY:wt.anchorPointY},he.iconFeatureIndex=wt.featureIndex;break}for(var Wt=I;Wt<Z;Wt++){var zt=t.get(Wt);he.verticalIconBox={x1:zt.x1,y1:zt.y1,x2:zt.x2,y2:zt.y2,anchorPointX:zt.anchorPointX,anchorPointY:zt.anchorPointY},he.verticalIconFeatureIndex=zt.featureIndex;break}return he},hi.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var o=0;o<this.symbolInstances.length;o++){var u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},hi.prototype.hasTextData=function(){return this.text.segments.get().length>0},hi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hi.prototype.addIndicesForPlacedSymbol=function(t,o){for(var u=t.placedSymbolArray.get(o),v=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<v;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)},hi.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var o=Math.sin(t),u=Math.cos(t),v=[],y=[],b=[],T=0;T<this.symbolInstances.length;++T){b.push(T);var I=this.symbolInstances.get(T);v.push(0|Math.round(o*I.anchorX+u*I.anchorY)),y.push(I.featureIndex)}return b.sort(function(Z,he){return v[Z]-v[he]||y[he]-y[Z]}),b},hi.prototype.addToSortKeyRanges=function(t,o){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})},hi.prototype.sortFeatures=function(t){var o=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,v=this.symbolInstanceIndexes;u<v.length;u+=1){var y=this.symbolInstances.get(v[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(b,T,I){b>=0&&I.indexOf(b)===T&&o.addIndicesForPlacedSymbol(o.text,b)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ii("SymbolBucket",hi,{omit:["layers","collisionBoxArray","features","compareText"]}),hi.MAX_GLYPHS=65535,hi.addDynamicAttributes=mn;var _i=new Ma({"symbol-placement":new zn(Ne.layout_symbol["symbol-placement"]),"symbol-spacing":new zn(Ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zn(Ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fn(Ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zn(Ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zn(Ne.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new zn(Ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new zn(Ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zn(Ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fn(Ne.layout_symbol["icon-size"]),"icon-text-fit":new zn(Ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zn(Ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fn(Ne.layout_symbol["icon-image"]),"icon-rotate":new Fn(Ne.layout_symbol["icon-rotate"]),"icon-padding":new zn(Ne.layout_symbol["icon-padding"]),"icon-keep-upright":new zn(Ne.layout_symbol["icon-keep-upright"]),"icon-offset":new Fn(Ne.layout_symbol["icon-offset"]),"icon-anchor":new Fn(Ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zn(Ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zn(Ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zn(Ne.layout_symbol["text-rotation-alignment"]),"text-field":new Fn(Ne.layout_symbol["text-field"]),"text-font":new Fn(Ne.layout_symbol["text-font"]),"text-size":new Fn(Ne.layout_symbol["text-size"]),"text-max-width":new Fn(Ne.layout_symbol["text-max-width"]),"text-line-height":new zn(Ne.layout_symbol["text-line-height"]),"text-letter-spacing":new Fn(Ne.layout_symbol["text-letter-spacing"]),"text-justify":new Fn(Ne.layout_symbol["text-justify"]),"text-radial-offset":new Fn(Ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zn(Ne.layout_symbol["text-variable-anchor"]),"text-anchor":new Fn(Ne.layout_symbol["text-anchor"]),"text-max-angle":new zn(Ne.layout_symbol["text-max-angle"]),"text-writing-mode":new zn(Ne.layout_symbol["text-writing-mode"]),"text-rotate":new Fn(Ne.layout_symbol["text-rotate"]),"text-padding":new zn(Ne.layout_symbol["text-padding"]),"text-keep-upright":new zn(Ne.layout_symbol["text-keep-upright"]),"text-transform":new Fn(Ne.layout_symbol["text-transform"]),"text-offset":new Fn(Ne.layout_symbol["text-offset"]),"text-allow-overlap":new zn(Ne.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new zn(Ne.layout_symbol["text-ignore-placement"]),"text-optional":new zn(Ne.layout_symbol["text-optional"])}),Vi={paint:new Ma({"icon-opacity":new Fn(Ne.paint_symbol["icon-opacity"]),"icon-color":new Fn(Ne.paint_symbol["icon-color"]),"icon-halo-color":new Fn(Ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fn(Ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fn(Ne.paint_symbol["icon-halo-blur"]),"icon-translate":new zn(Ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new zn(Ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fn(Ne.paint_symbol["text-opacity"]),"text-color":new Fn(Ne.paint_symbol["text-color"],{runtimeType:xn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Fn(Ne.paint_symbol["text-halo-color"]),"text-halo-width":new Fn(Ne.paint_symbol["text-halo-width"]),"text-halo-blur":new Fn(Ne.paint_symbol["text-halo-blur"]),"text-translate":new zn(Ne.paint_symbol["text-translate"]),"text-translate-anchor":new zn(Ne.paint_symbol["text-translate-anchor"])}),layout:_i},Qi=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:nn,this.defaultValue=t};Qi.prototype.evaluate=function(t){if(t.formattedSection){var o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Qi.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Qi.prototype.outputDefined=function(){return!1},Qi.prototype.serialize=function(){return null},ii("FormatSectionOverride",Qi,{omit:["defaultValue"]});var ao=function(t){function o(u){t.call(this,u,Vi)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.recalculate=function(u,v){if(t.prototype.recalculate.call(this,u,v),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var y=this.layout.get("text-writing-mode");if(y){for(var b=[],T=0,I=y;T<I.length;T+=1){var Z=I[T];b.indexOf(Z)<0&&b.push(Z)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},o.prototype.getValueAndResolveTokens=function(u,v,y,b){var T=this.layout.get(u).evaluate(v,{},y,b),I=this._unevaluatedLayout._values[u];return I.isDataDriven()||ju(I.value)||!T?T:function(Z,he){return he.replace(/{([^{}]+)}/g,function(_e,Ae){return Ae in Z?String(Z[Ae]):""})}(v.properties,T)},o.prototype.createBucket=function(u){return new hi(u)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype._setPaintOverrides=function(){for(var u=0,v=Vi.paint.overridableProperties;u<v.length;u+=1){var y=v[u];if(o.hasPaintOverride(this.layout,y)){var b,T=this.paint.get(y),I=new Qi(T),Z=new pu(I,T.property.specification);b=T.value.kind==="constant"||T.value.kind==="source"?new Dl("source",Z):new $u("composite",Z,T.value.zoomStops,T.value._interpolationType),this.paint._values[y]=new ya(T.property,b,T.parameters)}}},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,y){return!(!this.layout||v.isDataDriven()||y.isDataDriven())&&o.hasPaintOverride(this.layout,u)},o.hasPaintOverride=function(u,v){var y=u.get("text-field"),b=Vi.paint.properties[v],T=!1,I=function(_e){for(var Ae=0,je=_e;Ae<je.length;Ae+=1)if(b.overrides&&b.overrides.hasOverride(je[Ae]))return void(T=!0)};if(y.value.kind==="constant"&&y.value.value instanceof Da)I(y.value.value.sections);else if(y.value.kind==="source"){var Z=function(_e){T||(_e instanceof qa&&Ka(_e.value)===sa?I(_e.value.sections):_e instanceof Lo?I(_e.sections):_e.eachChild(Z))},he=y.value;he._styleExpression&&Z(he._styleExpression.expression)}return T},o}(da),Xo={paint:new Ma({"background-color":new zn(Ne.paint_background["background-color"]),"background-pattern":new _a(Ne.paint_background["background-pattern"]),"background-opacity":new zn(Ne.paint_background["background-opacity"])})},qu=function(t){function o(u){t.call(this,u,Xo)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(da),Bf={paint:new Ma({"raster-opacity":new zn(Ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new zn(Ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zn(Ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zn(Ne.paint_raster["raster-brightness-max"]),"raster-saturation":new zn(Ne.paint_raster["raster-saturation"]),"raster-contrast":new zn(Ne.paint_raster["raster-contrast"]),"raster-resampling":new zn(Ne.paint_raster["raster-resampling"]),"raster-fade-duration":new zn(Ne.paint_raster["raster-fade-duration"])})},Pu=function(t){function o(u){t.call(this,u,Bf)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(da),jp=function(t){function o(u){t.call(this,u,{}),this.implementation=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},o.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},o.prototype.recalculate=function(){},o.prototype.updateTransitions=function(){},o.prototype.hasTransition=function(){},o.prototype.serialize=function(){},o.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},o.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},o}(da),Ac={circle:Wf,heatmap:Mf,hillshade:Dp,fill:yd,"fill-extrusion":bd,line:Td,symbol:ao,background:qu,raster:Pu},mh=J.HTMLImageElement,gv=J.HTMLCanvasElement,yv=J.HTMLVideoElement,Ad=J.ImageData,$p=J.ImageBitmap,Bh=function(t,o,u,v){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(o,v)};Bh.prototype.update=function(t,o,u){var v=t.width,y=t.height,b=!(this.size&&this.size[0]===v&&this.size[1]===y||u),T=this.context,I=T.gl;if(this.useMipmap=!!(o&&o.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!o||o.premultiply!==!1)),b)this.size=[v,y],t instanceof mh||t instanceof gv||t instanceof yv||t instanceof Ad||$p&&t instanceof $p?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,t):I.texImage2D(I.TEXTURE_2D,0,this.format,v,y,0,this.format,I.UNSIGNED_BYTE,t.data);else{var Z=u||{x:0,y:0},he=Z.x,_e=Z.y;t instanceof mh||t instanceof gv||t instanceof yv||t instanceof Ad||$p&&t instanceof $p?I.texSubImage2D(I.TEXTURE_2D,0,he,_e,I.RGBA,I.UNSIGNED_BYTE,t):I.texSubImage2D(I.TEXTURE_2D,0,he,_e,v,y,I.RGBA,I.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)},Bh.prototype.bind=function(t,o,u){var v=this.context.gl;v.bindTexture(v.TEXTURE_2D,this.texture),u!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=v.LINEAR),t!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,t),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,u||t),this.filter=t),o!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,o),this.wrap=o)},Bh.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Bh.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Fh=function(t){var o=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){o._triggered=!1,o._callback()})};Fh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Fh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var hf=function(t,o,u){this.target=t,this.parent=o,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},lt(["receive","process"],this),this.invoker=new Fh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ye()?t:J};function Cd(t,o,u){var v=2*Math.PI*6378137/256/Math.pow(2,u);return[t*v-2*Math.PI*6378137/2,o*v-2*Math.PI*6378137/2]}hf.prototype.send=function(t,o,u,v,y){var b=this;y===void 0&&(y=!1);var T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[T]=u);var I=Re(this.globalScope)?void 0:[];return this.target.postMessage({id:T,type:t,hasCallback:!!u,targetMapId:v,mustQueue:y,sourceMapId:this.mapId,data:ps(o,I)},I),{cancel:function(){u&&delete b.callbacks[T],b.target.postMessage({id:T,type:"<cancel>",targetMapId:v,sourceMapId:b.mapId})}}},hf.prototype.receive=function(t){var o=t.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[u];var v=this.cancelCallbacks[u];delete this.cancelCallbacks[u],v&&v()}else ye()||o.mustQueue?(this.tasks[u]=o,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,o)},hf.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),o=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(t,o)}},hf.prototype.processTask=function(t,o){var u=this;if(o.type==="<response>"){var v=this.callbacks[t];delete this.callbacks[t],v&&(o.error?v(to(o.error)):v(null,to(o.data)))}else{var y=!1,b=Re(this.globalScope)?void 0:[],T=o.hasCallback?function(_e,Ae){y=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:_e?ps(_e):null,data:ps(Ae,b)},b)}:function(_e){y=!0},I=null,Z=to(o.data);if(this.parent[o.type])I=this.parent[o.type](o.sourceMapId,Z,T);else if(this.parent.getWorkerSource){var he=o.type.split(".");I=this.parent.getWorkerSource(o.sourceMapId,he[0],Z.source)[he[1]](Z,T)}else T(new Error("Could not find function "+o.type));!y&&I&&I.cancel&&(this.cancelCallbacks[t]=I.cancel)}},hf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ds=function(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ds.prototype.setNorthEast=function(t){return this._ne=t instanceof jo?new jo(t.lng,t.lat):jo.convert(t),this},Ds.prototype.setSouthWest=function(t){return this._sw=t instanceof jo?new jo(t.lng,t.lat):jo.convert(t),this},Ds.prototype.extend=function(t){var o,u,v=this._sw,y=this._ne;if(t instanceof jo)o=t,u=t;else{if(!(t instanceof Ds))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ds.convert(t)):this.extend(jo.convert(t)):this;if(u=t._ne,!(o=t._sw)||!u)return this}return v||y?(v.lng=Math.min(o.lng,v.lng),v.lat=Math.min(o.lat,v.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new jo(o.lng,o.lat),this._ne=new jo(u.lng,u.lat)),this},Ds.prototype.getCenter=function(){return new jo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ds.prototype.getSouthWest=function(){return this._sw},Ds.prototype.getNorthEast=function(){return this._ne},Ds.prototype.getNorthWest=function(){return new jo(this.getWest(),this.getNorth())},Ds.prototype.getSouthEast=function(){return new jo(this.getEast(),this.getSouth())},Ds.prototype.getWest=function(){return this._sw.lng},Ds.prototype.getSouth=function(){return this._sw.lat},Ds.prototype.getEast=function(){return this._ne.lng},Ds.prototype.getNorth=function(){return this._ne.lat},Ds.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ds.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ds.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ds.prototype.contains=function(t){var o=jo.convert(t),u=o.lng,v=o.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&y},Ds.convert=function(t){return!t||t instanceof Ds?t:new Ds(t)};var jo=function(t,o){if(isNaN(t)||isNaN(o))throw new Error("Invalid LngLat object: ("+t+", "+o+")");if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};jo.prototype.wrap=function(){return new jo(q(this.lng,-180,180),this.lat)},jo.prototype.toArray=function(){return[this.lng,this.lat]},jo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},jo.prototype.distanceTo=function(t){var o=Math.PI/180,u=this.lat*o,v=t.lat*o,y=Math.sin(u)*Math.sin(v)+Math.cos(u)*Math.cos(v)*Math.cos((t.lng-this.lng)*o);return 63710088e-1*Math.acos(Math.min(y,1))},jo.prototype.toBounds=function(t){t===void 0&&(t=0);var o=360*t/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Ds(new jo(this.lng-u,this.lat-o),new jo(this.lng+u,this.lat+o))},jo.convert=function(t){if(t instanceof jo)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new jo(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new jo(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var wd=2*Math.PI*63710088e-1;function vm(t){return wd*Math.cos(t*Math.PI/180)}function _v(t){return(180+t)/360}function fp(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Rd(t,o){return t/vm(o)}function Md(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var gh=function(t,o,u){u===void 0&&(u=0),this.x=+t,this.y=+o,this.z=+u};gh.fromLngLat=function(t,o){o===void 0&&(o=0);var u=jo.convert(t);return new gh(_v(u.lng),fp(u.lat),Rd(o,u.lat))},gh.prototype.toLngLat=function(){return new jo(360*this.x-180,Md(this.y))},gh.prototype.toAltitude=function(){return this.z*vm(Md(this.y))},gh.prototype.meterInMercatorCoordinateUnits=function(){return 1/wd*(t=Md(this.y),1/Math.cos(t*Math.PI/180));var t};var Kf=function(t,o,u){this.z=t,this.x=o,this.y=u,this.key=Qu(0,t,t,o,u)};Kf.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Kf.prototype.url=function(t,o){var u,v,y,b,T,I=(v=this.y,y=this.z,b=Cd(256*(u=this.x),256*(v=Math.pow(2,y)-v-1),y),T=Cd(256*(u+1),256*(v+1),y),b[0]+","+b[1]+","+T[0]+","+T[1]),Z=function(he,_e,Ae){for(var je,Je="",Tt=he;Tt>0;Tt--)Je+=(_e&(je=1<<Tt-1)?1:0)+(Ae&je?2:0);return Je}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Z).replace("{bbox-epsg-3857}",I)},Kf.prototype.getTilePoint=function(t){var o=Math.pow(2,this.z);return new W(8192*(t.x*o-this.x),8192*(t.y*o-this.y))},Kf.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var mm=function(t,o){this.wrap=t,this.canonical=o,this.key=Qu(t,o.z,o.z,o.x,o.y)},As=function(t,o,u,v,y){this.overscaledZ=t,this.wrap=o,this.canonical=new Kf(u,+v,+y),this.key=Qu(o,t,u,v,y)};function Qu(t,o,u,v,y){(t*=2)<0&&(t=-1*t-1);var b=1<<u;return(b*b*t+b*y+v).toString(36)+u.toString(36)+o.toString(36)}As.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},As.prototype.scaledTo=function(t){var o=this.canonical.z-t;return t>this.canonical.z?new As(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new As(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)},As.prototype.calculateScaledKey=function(t,o){var u=this.canonical.z-t;return t>this.canonical.z?Qu(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):Qu(this.wrap*+o,t,t,this.canonical.x>>u,this.canonical.y>>u)},As.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o},As.prototype.children=function(t){if(this.overscaledZ>=t)return[new As(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var o=this.canonical.z+1,u=2*this.canonical.x,v=2*this.canonical.y;return[new As(o,this.wrap,o,u,v),new As(o,this.wrap,o,u+1,v),new As(o,this.wrap,o,u,v+1),new As(o,this.wrap,o,u+1,v+1)]},As.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},As.prototype.wrapped=function(){return new As(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},As.prototype.unwrapTo=function(t){return new As(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},As.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},As.prototype.toUnwrapped=function(){return new mm(this.wrap,this.canonical)},As.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},As.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new gh(t.x-this.wrap,t.y))},ii("CanonicalTileID",Kf),ii("OverscaledTileID",As,{omit:["posMatrix"]});var $c=function(t,o,u){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Te('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=o.height;var v=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=u||"mapbox";for(var y=0;y<v;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(v,y)]=this.data[this._idx(v-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,v)]=this.data[this._idx(y,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]};$c.prototype.get=function(t,o){var u=new Uint8Array(this.data.buffer),v=4*this._idx(t,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[v],u[v+1],u[v+2])},$c.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},$c.prototype._idx=function(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)},$c.prototype._unpackMapbox=function(t,o,u){return(256*t*256+256*o+u)/10-1e4},$c.prototype._unpackTerrarium=function(t,o,u){return 256*t+o+u/256-32768},$c.prototype.getPixels=function(){return new xu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},$c.prototype.backfillBorder=function(t,o,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var v=o*this.dim,y=o*this.dim+this.dim,b=u*this.dim,T=u*this.dim+this.dim;switch(o){case-1:v=y-1;break;case 1:y=v+1}switch(u){case-1:b=T-1;break;case 1:T=b+1}for(var I=-o*this.dim,Z=-u*this.dim,he=b;he<T;he++)for(var _e=v;_e<y;_e++)this.data[this._idx(_e,he)]=t.data[this._idx(_e+I,he+Z)]},ii("DEMData",$c);var Hp=function(t){this._stringToNumber={},this._numberToString=[];for(var o=0;o<t.length;o++){var u=t[o];this._stringToNumber[u]=o,this._numberToString[o]=u}};Hp.prototype.encode=function(t){return this._stringToNumber[t]},Hp.prototype.decode=function(t){return this._numberToString[t]};var Wp=function(t,o,u,v,y){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=u,t._y=v,this.properties=t.properties,this.id=y},Od={geometry:{configurable:!0}};Od.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Od.geometry.set=function(t){this._geometry=t},Wp.prototype.toJSON=function(){var t={geometry:this.geometry};for(var o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t},Object.defineProperties(Wp.prototype,Od);var Nh=function(){this.state={},this.stateChanges={},this.deletedStates={}};Nh.prototype.updateState=function(t,o,u){var v=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][v]=this.stateChanges[t][v]||{},le(this.stateChanges[t][v],u),this.deletedStates[t]===null)for(var y in this.deletedStates[t]={},this.state[t])y!==v&&(this.deletedStates[t][y]=null);else if(this.deletedStates[t]&&this.deletedStates[t][v]===null)for(var b in this.deletedStates[t][v]={},this.state[t][v])u[b]||(this.deletedStates[t][v][b]=null);else for(var T in u)this.deletedStates[t]&&this.deletedStates[t][v]&&this.deletedStates[t][v][T]===null&&delete this.deletedStates[t][v][T]},Nh.prototype.removeFeatureState=function(t,o,u){if(this.deletedStates[t]!==null){var v=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&o!==void 0)this.deletedStates[t][v]!==null&&(this.deletedStates[t][v]=this.deletedStates[t][v]||{},this.deletedStates[t][v][u]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][v])for(u in this.deletedStates[t][v]={},this.stateChanges[t][v])this.deletedStates[t][v][u]=null;else this.deletedStates[t][v]=null;else this.deletedStates[t]=null}},Nh.prototype.getState=function(t,o){var u=String(o),v=le({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var y=this.deletedStates[t][o];if(y===null)return{};for(var b in y)delete v[b]}return v},Nh.prototype.initializeTileState=function(t,o){t.setFeatureState(this.state,o)},Nh.prototype.coalesceChanges=function(t,o){var u={};for(var v in this.stateChanges){this.state[v]=this.state[v]||{};var y={};for(var b in this.stateChanges[v])this.state[v][b]||(this.state[v][b]={}),le(this.state[v][b],this.stateChanges[v][b]),y[b]=this.state[v][b];u[v]=y}for(var T in this.deletedStates){this.state[T]=this.state[T]||{};var I={};if(this.deletedStates[T]===null)for(var Z in this.state[T])I[Z]={},this.state[T][Z]={};else for(var he in this.deletedStates[T]){if(this.deletedStates[T][he]===null)this.state[T][he]={};else for(var _e=0,Ae=Object.keys(this.deletedStates[T][he]);_e<Ae.length;_e+=1)delete this.state[T][he][Ae[_e]];I[he]=this.state[T][he]}u[T]=u[T]||{},le(u[T],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(var je in t)t[je].setFeatureState(u,o)};var Ff=function(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new os(8192,16,0),this.grid3D=new os(8192,16,0),this.featureIndexArray=new Me,this.promoteId=o};function xv(t,o,u,v,y){return Ze(t,function(b,T){var I=o instanceof Gi?o.get(T):null;return I&&I.evaluate?I.evaluate(u,v,y):I})}function bv(t){for(var o=1/0,u=1/0,v=-1/0,y=-1/0,b=0,T=t;b<T.length;b+=1){var I=T[b];o=Math.min(o,I.x),u=Math.min(u,I.y),v=Math.max(v,I.x),y=Math.max(y,I.y)}return{minX:o,minY:u,maxX:v,maxY:y}}function gm(t,o){return o-t}Ff.prototype.insert=function(t,o,u,v,y,b){var T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,v,y);for(var I=b?this.grid3D:this.grid,Z=0;Z<o.length;Z++){for(var he=o[Z],_e=[1/0,1/0,-1/0,-1/0],Ae=0;Ae<he.length;Ae++){var je=he[Ae];_e[0]=Math.min(_e[0],je.x),_e[1]=Math.min(_e[1],je.y),_e[2]=Math.max(_e[2],je.x),_e[3]=Math.max(_e[3],je.y)}_e[0]<8192&&_e[1]<8192&&_e[2]>=0&&_e[3]>=0&&I.insert(T,_e[0],_e[1],_e[2],_e[3])}},Ff.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ff.VectorTile(new Cr(this.rawTileData)).layers,this.sourceLayerCoder=new Hp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ff.prototype.query=function(t,o,u,v){var y=this;this.loadVTLayers();for(var b=t.params||{},T=8192/t.tileSize/t.scale,I=Wu(b.filter),Z=t.queryGeometry,he=t.queryPadding*T,_e=bv(Z),Ae=this.grid.query(_e.minX-he,_e.minY-he,_e.maxX+he,_e.maxY+he),je=bv(t.cameraQueryGeometry),Je=this.grid3D.query(je.minX-he,je.minY-he,je.maxX+he,je.maxY+he,function(Ar,kr,en,kn){return function(Hn,Ci,oi,Li,si){for(var ma=0,Ki=Hn;ma<Ki.length;ma+=1){var xi=Ki[ma];if(Ci<=xi.x&&oi<=xi.y&&Li>=xi.x&&si>=xi.y)return!0}var Aa=[new W(Ci,oi),new W(Ci,si),new W(Li,si),new W(Li,oi)];if(Hn.length>2){for(var aa=0,ra=Aa;aa<ra.length;aa+=1)if(iu(Hn,ra[aa]))return!0}for(var Ni=0;Ni<Hn.length-1;Ni++)if(Iu(Hn[Ni],Hn[Ni+1],Aa))return!0;return!1}(t.cameraQueryGeometry,Ar-he,kr-he,en+he,kn+he)}),Tt=0,wt=Je;Tt<wt.length;Tt+=1)Ae.push(wt[Tt]);Ae.sort(gm);for(var Wt,zt={},or=function(Ar){var kr=Ae[Ar];if(kr!==Wt){Wt=kr;var en=y.featureIndexArray.get(kr),kn=null;y.loadMatchingFeature(zt,en.bucketIndex,en.sourceLayerIndex,en.featureIndex,I,b.layers,b.availableImages,o,u,v,function(Hn,Ci,oi){return kn||(kn=Si(Hn)),Ci.queryIntersectsFeature(Z,Hn,oi,kn,y.z,t.transform,T,t.pixelPosMatrix)})}},dr=0;dr<Ae.length;dr++)or(dr);return zt},Ff.prototype.loadMatchingFeature=function(t,o,u,v,y,b,T,I,Z,he,_e){var Ae=this.bucketLayerIDs[o];if(!b||function(Hn,Ci){for(var oi=0;oi<Hn.length;oi++)if(Ci.indexOf(Hn[oi])>=0)return!0;return!1}(b,Ae)){var je=this.sourceLayerCoder.decode(u),Je=this.vtLayers[je].feature(v);if(y.needGeometry){var Tt=Oi(Je,!0);if(!y.filter(new Gr(this.tileID.overscaledZ),Tt,this.tileID.canonical))return}else if(!y.filter(new Gr(this.tileID.overscaledZ),Je))return;for(var wt=this.getId(Je,je),Wt=0;Wt<Ae.length;Wt++){var zt=Ae[Wt];if(!(b&&b.indexOf(zt)<0)){var or=I[zt];if(or){var dr={};wt!==void 0&&he&&(dr=he.getState(or.sourceLayer||"_geojsonTileLayer",wt));var Ar=le({},Z[zt]);Ar.paint=xv(Ar.paint,or.paint,Je,dr,T),Ar.layout=xv(Ar.layout,or.layout,Je,dr,T);var kr=!_e||_e(Je,or,dr);if(kr){var en=new Wp(Je,this.z,this.x,this.y,wt);en.layer=Ar;var kn=t[zt];kn===void 0&&(kn=t[zt]=[]),kn.push({featureIndex:v,feature:en,intersectionZ:kr})}}}}}},Ff.prototype.lookupSymbolFeatures=function(t,o,u,v,y,b,T,I){var Z={};this.loadVTLayers();for(var he=Wu(y),_e=0,Ae=t;_e<Ae.length;_e+=1)this.loadMatchingFeature(Z,u,v,Ae[_e],he,b,T,I,o);return Z},Ff.prototype.hasLayer=function(t){for(var o=0,u=this.bucketLayerIDs;o<u.length;o+=1)for(var v=0,y=u[o];v<y.length;v+=1)if(t===y[v])return!0;return!1},Ff.prototype.getId=function(t,o){var u=t.id;return this.promoteId&&typeof(u=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]])=="boolean"&&(u=Number(u)),u},ii("FeatureIndex",Ff,{omit:["rawTileData","sourceLayerCoder"]});var Ks=function(t,o){this.tileID=t,this.uid=Ce(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ks.prototype.registerFadeDuration=function(t){var o=t+this.timeAdded;o<_n.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)},Ks.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Ks.prototype.loadVectorData=function(t,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var v in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(he,_e){var Ae={};if(!_e)return Ae;for(var je=function(){var wt=Tt[Je],Wt=wt.layerIds.map(function(dr){return _e.getLayer(dr)}).filter(Boolean);if(Wt.length!==0){wt.layers=Wt,wt.stateDependentLayerIds&&(wt.stateDependentLayers=wt.stateDependentLayerIds.map(function(dr){return Wt.filter(function(Ar){return Ar.id===dr})[0]}));for(var zt=0,or=Wt;zt<or.length;zt+=1)Ae[or[zt].id]=wt}},Je=0,Tt=he;Je<Tt.length;Je+=1)je();return Ae}(t.buckets,o.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[v];if(y instanceof hi){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var T=this.buckets[b];if(T instanceof hi&&T.hasRTLText){this.hasRTLText=!0,fi.isLoading()||fi.isLoaded()||Bn()!=="deferred"||Kn();break}}for(var I in this.queryPadding=0,this.buckets){var Z=this.buckets[I];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(I).queryRadius(Z))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new p},Ks.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ks.prototype.getBucket=function(t){return this.buckets[t.id]},Ks.prototype.upload=function(t){for(var o in this.buckets){var u=this.buckets[o];u.uploadPending()&&u.upload(t)}var v=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Bh(t,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Bh(t,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)},Ks.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Ks.prototype.queryRenderedFeatures=function(t,o,u,v,y,b,T,I,Z,he){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:he,transform:I,params:T,queryPadding:this.queryPadding*Z},t,o,u):{}},Ks.prototype.querySourceFeatures=function(t,o){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var v=u.loadVTLayers(),y=o?o.sourceLayer:"",b=v._geojsonTileLayer||v[y];if(b)for(var T=Wu(o&&o.filter),I=this.tileID.canonical,Z=I.z,he=I.x,_e=I.y,Ae={z:Z,x:he,y:_e},je=0;je<b.length;je++){var Je=b.feature(je);if(T.needGeometry){var Tt=Oi(Je,!0);if(!T.filter(new Gr(this.tileID.overscaledZ),Tt,this.tileID.canonical))continue}else if(!T.filter(new Gr(this.tileID.overscaledZ),Je))continue;var wt=u.getId(Je,y),Wt=new Wp(Je,Z,he,_e,wt);Wt.tile=Ae,t.push(Wt)}}},Ks.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Ks.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ks.prototype.setExpiryData=function(t){var o=this.expirationTime;if(t.cacheControl){var u=Ve(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var v=Date.now(),y=!1;if(this.expirationTime>v)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{var b=this.expirationTime-o;b?this.expirationTime=v+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ks.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Ks.prototype.setFeatureState=function(t,o){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var u=this.latestFeatureIndex.loadVTLayers();for(var v in this.buckets)if(o.style.hasLayer(v)){var y=this.buckets[v],b=y.layers[0].sourceLayer||"_geojsonTileLayer",T=u[b],I=t[b];if(T&&I&&Object.keys(I).length!==0){y.update(I,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Z=o&&o.style&&o.style.getLayer(v);Z&&(this.queryPadding=Math.max(this.queryPadding,Z.queryRadius(y)))}}}},Ks.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Ks.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_n.now()},Ks.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ks.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=_n.now()+t},Ks.prototype.setDependencies=function(t,o){for(var u={},v=0,y=o;v<y.length;v+=1)u[y[v]]=!0;this.dependencies[t]=u},Ks.prototype.hasDependency=function(t,o){for(var u=0,v=t;u<v.length;u+=1){var y=this.dependencies[v[u]];if(y){for(var b=0,T=o;b<T.length;b+=1)if(y[T[b]])return!0}}return!1};var qf=J.performance,Id=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},qf.mark(this._marks.start)};Id.prototype.finish=function(){qf.mark(this._marks.end);var t=qf.getEntriesByName(this._marks.measure);return t.length===0&&(qf.measure(this._marks.measure,this._marks.start,this._marks.end),t=qf.getEntriesByName(this._marks.measure),qf.clearMarks(this._marks.start),qf.clearMarks(this._marks.end),qf.clearMeasures(this._marks.measure)),t},h.Actor=hf,h.AlphaImage=of,h.CanonicalTileID=Kf,h.CollisionBoxArray=p,h.Color=Nr,h.DEMData=$c,h.DataConstantProperty=zn,h.DictionaryCoder=Hp,h.EXTENT=8192,h.ErrorEvent=ft,h.EvaluationParameters=Gr,h.Event=Xe,h.Evented=Et,h.FeatureIndex=Ff,h.FillBucket=Tc,h.FillExtrusionBucket=Eu,h.ImageAtlas=Jr,h.ImagePosition=Yn,h.LineBucket=Su,h.LngLat=jo,h.LngLatBounds=Ds,h.MercatorCoordinate=gh,h.ONE_EM=24,h.OverscaledTileID=As,h.Point=W,h.Point$1=W,h.Properties=Ma,h.Protobuf=Cr,h.RGBAImage=xu,h.RequestManager=$t,h.RequestPerformance=Id,h.ResourceType=H,h.SegmentVector=tt,h.SourceFeatureState=Nh,h.StructArrayLayout1ui2=gu,h.StructArrayLayout2f1f2i16=fl,h.StructArrayLayout2i4=nu,h.StructArrayLayout3ui6=Ui,h.StructArrayLayout4i8=Cf,h.SymbolBucket=hi,h.Texture=Bh,h.Tile=Ks,h.Transitionable=Mi,h.Uniform1f=M,h.Uniform1i=tn,h.Uniform2f=k,h.Uniform3f=L,h.Uniform4f=K,h.UniformColor=ie,h.UniformMatrix4f=nt,h.UnwrappedTileID=mm,h.ValidationError=Ue,h.WritingMode=Di,h.ZoomHistory=zl,h.add=function(t,o,u){return t[0]=o[0]+u[0],t[1]=o[1]+u[1],t[2]=o[2]+u[2],t},h.addDynamicAttributes=mn,h.asyncAll=function(t,o,u){if(!t.length)return u(null,[]);var v=t.length,y=new Array(t.length),b=null;t.forEach(function(T,I){o(T,function(Z,he){Z&&(b=Z),y[I]=he,--v==0&&u(b,y)})})},h.bezier=B,h.bindAll=lt,h.browser=_n,h.cacheEntryPossiblyAdded=function(t){++it>Yi&&(t.getActor().send("enforceCacheSizeLimit",Jn),it=0)},h.clamp=U,h.clearTileCache=function(t){var o=J.caches.delete("mapbox-tiles");t&&o.catch(t).then(function(){return t()})},h.clipLine=ic,h.clone=function(t){var o=new Oa(16);return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.clone$1=se,h.clone$2=function(t){var o=new Oa(3);return o[0]=t[0],o[1]=t[1],o[2]=t[2],o},h.collisionCircleLayout=me,h.config=Zr,h.create=function(){var t=new Oa(16);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},h.create$1=function(){var t=new Oa(9);return Oa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},h.create$2=function(){var t=new Oa(4);return Oa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},h.createCommonjsModule=D,h.createExpression=kl,h.createLayout=mo,h.createStyleLayer=function(t){return t.type==="custom"?new jp(t):new Ac[t.type](t)},h.cross=function(t,o,u){var v=o[0],y=o[1],b=o[2],T=u[0],I=u[1],Z=u[2];return t[0]=y*Z-b*I,t[1]=b*T-v*Z,t[2]=v*I-y*T,t},h.deepEqual=function t(o,u){if(Array.isArray(o)){if(!Array.isArray(u)||o.length!==u.length)return!1;for(var v=0;v<o.length;v++)if(!t(o[v],u[v]))return!1;return!0}if(typeof o=="object"&&o!==null&&u!==null){if(typeof u!="object"||Object.keys(o).length!==Object.keys(u).length)return!1;for(var y in o)if(!t(o[y],u[y]))return!1;return!0}return o===u},h.dot=function(t,o){return t[0]*o[0]+t[1]*o[1]+t[2]*o[2]},h.dot$1=function(t,o){return t[0]*o[0]+t[1]*o[1]+t[2]*o[2]+t[3]*o[3]},h.ease=ee,h.emitValidationErrors=Fl,h.endsWith=We,h.enforceCacheSizeLimit=function(t){bi(),gr&&gr.then(function(o){o.keys().then(function(u){for(var v=0;v<u.length-t;v++)o.delete(u[v])})})},h.evaluateSizeForFeature=ou,h.evaluateSizeForZoom=gs,h.evaluateVariableOffset=Jt,h.evented=wn,h.extend=le,h.featureFilter=Wu,h.filterObject=pe,h.fromRotation=function(t,o){var u=Math.sin(o),v=Math.cos(o);return t[0]=v,t[1]=u,t[2]=0,t[3]=-u,t[4]=v,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.getAnchorAlignment=Ro,h.getAnchorJustification=tr,h.getArrayBuffer=ir,h.getImage=Q,h.getJSON=function(t,o){return Ut(le(t,{type:"json"}),o)},h.getRTLTextPluginStatus=Bn,h.getReferrer=Le,h.getVideo=function(t,o){var u,v,y=J.document.createElement("video");y.muted=!0,y.onloadstart=function(){o(null,y)};for(var b=0;b<t.length;b++){var T=J.document.createElement("source");u=t[b],v=void 0,(v=J.document.createElement("a")).href=u,(v.protocol!==J.document.location.protocol||v.host!==J.document.location.host)&&(y.crossOrigin="Anonymous"),T.src=t[b],y.appendChild(T)}return{cancel:function(){}}},h.identity=Ps,h.invert=function(t,o){var u=o[0],v=o[1],y=o[2],b=o[3],T=o[4],I=o[5],Z=o[6],he=o[7],_e=o[8],Ae=o[9],je=o[10],Je=o[11],Tt=o[12],wt=o[13],Wt=o[14],zt=o[15],or=u*I-v*T,dr=u*Z-y*T,Ar=u*he-b*T,kr=v*Z-y*I,en=v*he-b*I,kn=y*he-b*Z,Hn=_e*wt-Ae*Tt,Ci=_e*Wt-je*Tt,oi=_e*zt-Je*Tt,Li=Ae*Wt-je*wt,si=Ae*zt-Je*wt,ma=je*zt-Je*Wt,Ki=or*ma-dr*si+Ar*Li+kr*oi-en*Ci+kn*Hn;return Ki?(t[0]=(I*ma-Z*si+he*Li)*(Ki=1/Ki),t[1]=(y*si-v*ma-b*Li)*Ki,t[2]=(wt*kn-Wt*en+zt*kr)*Ki,t[3]=(je*en-Ae*kn-Je*kr)*Ki,t[4]=(Z*oi-T*ma-he*Ci)*Ki,t[5]=(u*ma-y*oi+b*Ci)*Ki,t[6]=(Wt*Ar-Tt*kn-zt*dr)*Ki,t[7]=(_e*kn-je*Ar+Je*dr)*Ki,t[8]=(T*si-I*oi+he*Hn)*Ki,t[9]=(v*oi-u*si-b*Hn)*Ki,t[10]=(Tt*en-wt*Ar+zt*or)*Ki,t[11]=(Ae*Ar-_e*en-Je*or)*Ki,t[12]=(I*Ci-T*Li-Z*Hn)*Ki,t[13]=(u*Li-v*Ci+y*Hn)*Ki,t[14]=(wt*dr-Tt*kr-Wt*or)*Ki,t[15]=(_e*kr-Ae*dr+je*or)*Ki,t):null},h.isChar=S,h.isMapboxURL=_r,h.keysDifference=function(t,o){var u=[];for(var v in t)v in o||u.push(v);return u},h.makeRequest=Ut,h.mapObject=Ze,h.mercatorXfromLng=_v,h.mercatorYfromLat=fp,h.mercatorZfromAltitude=Rd,h.mul=Hf,h.multiply=vs,h.mvt=ff,h.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},h.normalize=function(t,o){var u=o[0],v=o[1],y=o[2],b=u*u+v*v+y*y;return b>0&&(b=1/Math.sqrt(b)),t[0]=o[0]*b,t[1]=o[1]*b,t[2]=o[2]*b,t},h.number=Ei,h.offscreenCanvasSupported=V,h.ortho=function(t,o,u,v,y,b,T){var I=1/(o-u),Z=1/(v-y),he=1/(b-T);return t[0]=-2*I,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*Z,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*he,t[11]=0,t[12]=(o+u)*I,t[13]=(y+v)*Z,t[14]=(T+b)*he,t[15]=1,t},h.parseGlyphPBF=function(t){return new Cr(t).readFields(dn,[])},h.pbf=Cr,h.performSymbolLayout=function(t,o,u,v,y,b,T){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var I=t.layers[0].layout,Z=t.layers[0]._unevaluatedLayout._values,he={};if(t.textSizeData.kind==="composite"){var _e=t.textSizeData,Ae=_e.maxZoom;he.compositeTextSizes=[Z["text-size"].possiblyEvaluate(new Gr(_e.minZoom),T),Z["text-size"].possiblyEvaluate(new Gr(Ae),T)]}if(t.iconSizeData.kind==="composite"){var je=t.iconSizeData,Je=je.maxZoom;he.compositeIconSizes=[Z["icon-size"].possiblyEvaluate(new Gr(je.minZoom),T),Z["icon-size"].possiblyEvaluate(new Gr(Je),T)]}he.layoutTextSize=Z["text-size"].possiblyEvaluate(new Gr(t.zoom+1),T),he.layoutIconSize=Z["icon-size"].possiblyEvaluate(new Gr(t.zoom+1),T),he.textMaxSize=Z["text-size"].possiblyEvaluate(new Gr(18));for(var Tt=24*I.get("text-line-height"),wt=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",Wt=I.get("text-keep-upright"),zt=I.get("text-size"),or=function(){var kr=Ar[dr],en=I.get("text-font").evaluate(kr,{},T).join(","),kn=zt.evaluate(kr,{},T),Hn=he.layoutTextSize.evaluate(kr,{},T),Ci=he.layoutIconSize.evaluate(kr,{},T),oi={horizontal:{},vertical:void 0},Li=kr.text,si=[0,0];if(Li){var ma=Li.toString(),Ki=24*I.get("text-letter-spacing").evaluate(kr,{},T),xi=function(ka){for(var Mo=0,xo=ka;Mo<xo.length;Mo+=1)if(Xa=xo[Mo].charCodeAt(0),S.Arabic(Xa)||S["Arabic Supplement"](Xa)||S["Arabic Extended-A"](Xa)||S["Arabic Presentation Forms-A"](Xa)||S["Arabic Presentation Forms-B"](Xa))return!1;var Xa;return!0}(ma)?Ki:0,Aa=I.get("text-anchor").evaluate(kr,{},T),aa=I.get("text-variable-anchor");if(!aa){var ra=I.get("text-radial-offset").evaluate(kr,{},T);si=ra?Jt(Aa,[24*ra,Ht]):I.get("text-offset").evaluate(kr,{},T).map(function(ka){return 24*ka})}var Ni=wt?"center":I.get("text-justify").evaluate(kr,{},T),oo=I.get("symbol-placement"),No=oo==="point"?24*I.get("text-max-width").evaluate(kr,{},T):0,ko=function(){t.allowVerticalPlacement&&Ge(ma)&&(oi.vertical=pa(Li,o,u,y,en,No,Tt,Aa,"left",xi,si,Di.vertical,!0,oo,Hn,kn))};if(!wt&&aa){for(var ts=Ni==="auto"?aa.map(function(ka){return tr(ka)}):[Ni],Uo=!1,ls=0;ls<ts.length;ls++){var _s=ts[ls];if(!oi.horizontal[_s])if(Uo)oi.horizontal[_s]=oi.horizontal[0];else{var qs=pa(Li,o,u,y,en,No,Tt,"center",_s,xi,si,Di.horizontal,!1,oo,Hn,kn);qs&&(oi.horizontal[_s]=qs,Uo=qs.positionedLines.length===1)}}ko()}else{Ni==="auto"&&(Ni=tr(Aa));var Tu=pa(Li,o,u,y,en,No,Tt,Aa,Ni,xi,si,Di.horizontal,!1,oo,Hn,kn);Tu&&(oi.horizontal[Ni]=Tu),ko(),Ge(ma)&&wt&&Wt&&(oi.vertical=pa(Li,o,u,y,en,No,Tt,Aa,Ni,xi,si,Di.vertical,!1,oo,Hn,kn))}}var Ls=void 0,Ua=!1;if(kr.icon&&kr.icon.name){var xs=v[kr.icon.name];xs&&(Ls=function(ka,Mo,xo){var Xa=Ro(xo),ku=Mo[0]-ka.displaySize[0]*Xa.horizontalAlign,Du=Mo[1]-ka.displaySize[1]*Xa.verticalAlign;return{image:ka,top:Du,bottom:Du+ka.displaySize[1],left:ku,right:ku+ka.displaySize[0]}}(y[kr.icon.name],I.get("icon-offset").evaluate(kr,{},T),I.get("icon-anchor").evaluate(kr,{},T)),Ua=xs.sdf,t.sdfIcons===void 0?t.sdfIcons=xs.sdf:t.sdfIcons!==xs.sdf&&Te("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xs.pixelRatio!==t.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var Yo=Xt(oi.horizontal)||oi.vertical;t.iconsInText=!!Yo&&Yo.iconsInText,(Yo||Ls)&&function(ka,Mo,xo,Xa,ku,Du,gi,rs,Lu,na,Ju){var Au=Du.textMaxSize.evaluate(Mo,{});Au===void 0&&(Au=gi);var Cc,Oo=ka.layers[0].layout,Tl=Oo.get("icon-offset").evaluate(Mo,{},Ju),Xl=Xt(xo.horizontal),hp=gi/24,yh=ka.tilePixelRatio*hp,_o=ka.tilePixelRatio*Au/24,Qf=ka.tilePixelRatio*rs,pp=ka.tilePixelRatio*Oo.get("symbol-spacing"),dp=Oo.get("text-padding")*ka.tilePixelRatio,Uh=Oo.get("icon-padding")*ka.tilePixelRatio,vl=Oo.get("text-max-angle")/180*Math.PI,Jf=Oo.get("text-rotation-alignment")==="map"&&Oo.get("symbol-placement")!=="point",eh=Oo.get("icon-rotation-alignment")==="map"&&Oo.get("symbol-placement")!=="point",ac=Oo.get("symbol-placement"),_h=pp/2,xh=Oo.get("icon-text-fit");Xa&&xh!=="none"&&(ka.allowVerticalPlacement&&xo.vertical&&(Cc=Ts(Xa,xo.vertical,xh,Oo.get("icon-text-fit-padding"),Tl,hp)),Xl&&(Xa=Ts(Xa,Xl,xh,Oo.get("icon-text-fit-padding"),Tl,hp)));var Nf=function(Ld,Xp){Xp.x<0||Xp.x>=8192||Xp.y<0||Xp.y>=8192||function(bs,df,_m,Th,Bd,xp,Fd,Uf,Yp,bp,Kp,qp,Nd,Sv,Ep,Tv,Av,Cv,wv,Ud,Al,el,Rv,vf,xm){var Mv,Ah,$h,Hh,Ch,Wh=bs.addToLineVertexArray(df,_m),Ov=0,Iv=0,zd=0,Pv=0,Zd=-1,Vd=-1,zf={},kv=_t(""),jd=0,$d=0;if(Uf._unevaluatedLayout.getValue("text-radial-offset")===void 0?(jd=(Mv=Uf.layout.get("text-offset").evaluate(Al,{},vf).map(function(Tp){return 24*Tp}))[0],$d=Mv[1]):(jd=24*Uf.layout.get("text-radial-offset").evaluate(Al,{},vf),$d=Ht),bs.allowVerticalPlacement&&Th.vertical){var Dv=Uf.layout.get("text-rotate").evaluate(Al,{},vf)+90;Hh=new yo(Yp,df,bp,Kp,qp,Th.vertical,Nd,Sv,Ep,Dv),Fd&&(Ch=new yo(Yp,df,bp,Kp,qp,Fd,Av,Cv,Ep,Dv))}if(Bd){var Hd=Uf.layout.get("icon-rotate").evaluate(Al,{}),Lv=Uf.layout.get("icon-text-fit")!=="none",Bv=Ct(Bd,Hd,Rv,Lv),Fv=Fd?Ct(Fd,Hd,Rv,Lv):void 0;$h=new yo(Yp,df,bp,Kp,qp,Bd,Av,Cv,!1,Hd),Ov=4*Bv.length;var Wd=bs.iconSizeData,Sp=null;Wd.kind==="source"?(Sp=[128*Uf.layout.get("icon-size").evaluate(Al,{})])[0]>32640&&Te(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Wd.kind==="composite"&&((Sp=[128*el.compositeIconSizes[0].evaluate(Al,{},vf),128*el.compositeIconSizes[1].evaluate(Al,{},vf)])[0]>32640||Sp[1]>32640)&&Te(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),bs.addSymbols(bs.icon,Bv,Sp,Ud,wv,Al,!1,df,Wh.lineStartIndex,Wh.lineLength,-1,vf),Zd=bs.icon.placedSymbolArray.length-1,Fv&&(Iv=4*Fv.length,bs.addSymbols(bs.icon,Fv,Sp,Ud,wv,Al,Di.vertical,df,Wh.lineStartIndex,Wh.lineLength,-1,vf),Vd=bs.icon.placedSymbolArray.length-1)}for(var Qp in Th.horizontal){var Gd=Th.horizontal[Qp];if(!Ah){kv=_t(Gd.text);var bm=Uf.layout.get("text-rotate").evaluate(Al,{},vf);Ah=new yo(Yp,df,bp,Kp,qp,Gd,Nd,Sv,Ep,bm)}var Nv=Gd.positionedLines.length===1;if(zd+=Mt(bs,df,Gd,xp,Uf,Ep,Al,Tv,Wh,Th.vertical?Di.horizontal:Di.horizontalOnly,Nv?Object.keys(Th.horizontal):[Qp],zf,Zd,el,vf),Nv)break}Th.vertical&&(Pv+=Mt(bs,df,Th.vertical,xp,Uf,Ep,Al,Tv,Wh,Di.vertical,["vertical"],zf,Vd,el,vf));var Em=Ah?Ah.boxStartIndex:bs.collisionBoxArray.length,Sm=Ah?Ah.boxEndIndex:bs.collisionBoxArray.length,Uv=Hh?Hh.boxStartIndex:bs.collisionBoxArray.length,Tm=Hh?Hh.boxEndIndex:bs.collisionBoxArray.length,Am=$h?$h.boxStartIndex:bs.collisionBoxArray.length,Cm=$h?$h.boxEndIndex:bs.collisionBoxArray.length,wm=Ch?Ch.boxStartIndex:bs.collisionBoxArray.length,Rm=Ch?Ch.boxEndIndex:bs.collisionBoxArray.length,mf=-1,Jp=function(Tp,Zv){return Tp&&Tp.circleDiameter?Math.max(Tp.circleDiameter,Zv):Zv};mf=Jp(Ah,mf),mf=Jp(Hh,mf),mf=Jp($h,mf);var zv=(mf=Jp(Ch,mf))>-1?1:0;zv&&(mf*=xm/24),bs.glyphOffsetArray.length>=hi.MAX_GLYPHS&&Te("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Al.sortKey!==void 0&&bs.addToSortKeyRanges(bs.symbolInstances.length,Al.sortKey),bs.symbolInstances.emplaceBack(df.x,df.y,zf.right>=0?zf.right:-1,zf.center>=0?zf.center:-1,zf.left>=0?zf.left:-1,zf.vertical||-1,Zd,Vd,kv,Em,Sm,Uv,Tm,Am,Cm,wm,Rm,bp,zd,Pv,Ov,Iv,zv,0,Nd,jd,$d,mf)}(ka,Xp,Ld,xo,Xa,ku,Cc,ka.layers[0],ka.collisionBoxArray,Mo.index,Mo.sourceLayerIndex,ka.index,yh,dp,Jf,Lu,Qf,Uh,eh,Tl,Mo,Du,na,Ju,gi)};if(ac==="line")for(var bh=0,vp=ic(Mo.geometry,0,0,8192,8192);bh<vp.length;bh+=1)for(var zh=vp[bh],th=0,rh=ys(zh,pp,vl,xo.vertical||Xl,Xa,24,_o,ka.overscaling,8192);th<rh.length;th+=1){var mp=rh[th];Xl&&mt(ka,Xl.text,_h,mp)||Nf(zh,mp)}else if(ac==="line-center")for(var Zh=0,gp=Mo.geometry;Zh<gp.length;Zh+=1){var yp=gp[Zh];if(yp.length>1){var Pd=Ga(yp,vl,xo.vertical||Xl,Xa,24,_o);Pd&&Nf(yp,Pd)}}else if(Mo.type==="Polygon")for(var Vh=0,kd=Vc(Mo.geometry,0);Vh<kd.length;Vh+=1){var Eh=kd[Vh],pf=Nt(Eh,16);Nf(Eh[0],new Go(pf.x,pf.y,0))}else if(Mo.type==="LineString")for(var Sh=0,_p=Mo.geometry;Sh<_p.length;Sh+=1){var nh=_p[Sh];Nf(nh,new Go(nh[0].x,nh[0].y,0))}else if(Mo.type==="Point")for(var Dd=0,Ev=Mo.geometry;Dd<Ev.length;Dd+=1)for(var Gp=0,ym=Ev[Dd];Gp<ym.length;Gp+=1){var jh=ym[Gp];Nf([jh],new Go(jh.x,jh.y,0))}}(t,kr,oi,Ls,v,he,Hn,Ci,si,Ua,T)},dr=0,Ar=t.features;dr<Ar.length;dr+=1)or();b&&t.generateCollisionDebugBuffers()},h.perspective=function(t,o,u,v,y){var b,T=1/Math.tan(o/2);return t[0]=T/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=T,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,y!=null&&y!==1/0?(t[10]=(y+v)*(b=1/(v-y)),t[14]=2*y*v*b):(t[10]=-1,t[14]=-2*v),t},h.pick=function(t,o){for(var u={},v=0;v<o.length;v++){var y=o[v];y in t&&(u[y]=t[y])}return u},h.plugin=fi,h.polygonIntersectsPolygon=go,h.postMapLoadEvent=Dn,h.postTurnstileEvent=Vn,h.potpack=ea,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=ii,h.registerForPluginStateChange=function(t){return t({pluginStatus:dt,pluginURL:It}),wn.on("pluginStateChange",t),t},h.renderColorRamp=kp,h.rotate=function(t,o,u){var v=o[0],y=o[1],b=o[2],T=o[3],I=Math.sin(u),Z=Math.cos(u);return t[0]=v*Z+b*I,t[1]=y*Z+T*I,t[2]=v*-I+b*Z,t[3]=y*-I+T*Z,t},h.rotateX=function(t,o,u){var v=Math.sin(u),y=Math.cos(u),b=o[4],T=o[5],I=o[6],Z=o[7],he=o[8],_e=o[9],Ae=o[10],je=o[11];return o!==t&&(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15]),t[4]=b*y+he*v,t[5]=T*y+_e*v,t[6]=I*y+Ae*v,t[7]=Z*y+je*v,t[8]=he*y-b*v,t[9]=_e*y-T*v,t[10]=Ae*y-I*v,t[11]=je*y-Z*v,t},h.rotateZ=function(t,o,u){var v=Math.sin(u),y=Math.cos(u),b=o[0],T=o[1],I=o[2],Z=o[3],he=o[4],_e=o[5],Ae=o[6],je=o[7];return o!==t&&(t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15]),t[0]=b*y+he*v,t[1]=T*y+_e*v,t[2]=I*y+Ae*v,t[3]=Z*y+je*v,t[4]=he*y-b*v,t[5]=_e*y-T*v,t[6]=Ae*y-I*v,t[7]=je*y-Z*v,t},h.scale=function(t,o,u){var v=u[0],y=u[1],b=u[2];return t[0]=o[0]*v,t[1]=o[1]*v,t[2]=o[2]*v,t[3]=o[3]*v,t[4]=o[4]*y,t[5]=o[5]*y,t[6]=o[6]*y,t[7]=o[7]*y,t[8]=o[8]*b,t[9]=o[9]*b,t[10]=o[10]*b,t[11]=o[11]*b,t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},h.scale$1=function(t,o,u){return t[0]=o[0]*u,t[1]=o[1]*u,t[2]=o[2]*u,t[3]=o[3]*u,t},h.scale$2=function(t,o,u){return t[0]=o[0]*u,t[1]=o[1]*u,t[2]=o[2]*u,t},h.setCacheLimits=function(t,o){Jn=t,Yi=o},h.setRTLTextPlugin=function(t,o,u){if(u===void 0&&(u=!1),dt==="deferred"||dt==="loading"||dt==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");It=_n.resolveURL(t),dt="deferred",Dt=o,Yr(),u||Kn()},h.sphericalToCartesian=function(t){var o=t[0],u=t[1],v=t[2];return u+=90,u*=Math.PI/180,v*=Math.PI/180,{x:o*Math.cos(u)*Math.sin(v),y:o*Math.sin(u)*Math.sin(v),z:o*Math.cos(v)}},h.sqrLen=function(t){var o=t[0],u=t[1];return o*o+u*u},h.styleSpec=Ne,h.sub=function(t,o,u){return t[0]=o[0]-u[0],t[1]=o[1]-u[1],t[2]=o[2]-u[2],t},h.symbolSize=la,h.transformMat3=function(t,o,u){var v=o[0],y=o[1],b=o[2];return t[0]=v*u[0]+y*u[3]+b*u[6],t[1]=v*u[1]+y*u[4]+b*u[7],t[2]=v*u[2]+y*u[5]+b*u[8],t},h.transformMat4=hl,h.translate=function(t,o,u){var v,y,b,T,I,Z,he,_e,Ae,je,Je,Tt,wt=u[0],Wt=u[1],zt=u[2];return o===t?(t[12]=o[0]*wt+o[4]*Wt+o[8]*zt+o[12],t[13]=o[1]*wt+o[5]*Wt+o[9]*zt+o[13],t[14]=o[2]*wt+o[6]*Wt+o[10]*zt+o[14],t[15]=o[3]*wt+o[7]*Wt+o[11]*zt+o[15]):(y=o[1],b=o[2],T=o[3],I=o[4],Z=o[5],he=o[6],_e=o[7],Ae=o[8],je=o[9],Je=o[10],Tt=o[11],t[0]=v=o[0],t[1]=y,t[2]=b,t[3]=T,t[4]=I,t[5]=Z,t[6]=he,t[7]=_e,t[8]=Ae,t[9]=je,t[10]=Je,t[11]=Tt,t[12]=v*wt+I*Wt+Ae*zt+o[12],t[13]=y*wt+Z*Wt+je*zt+o[13],t[14]=b*wt+he*Wt+Je*zt+o[14],t[15]=T*wt+_e*Wt+Tt*zt+o[15]),t},h.triggerPluginCompletionEvent=Tr,h.uniqueId=Ce,h.validateCustomStyleLayer=function(t){var o=[],u=t.id;return u===void 0&&o.push({message:"layers."+u+': missing required property "id"'}),t.render===void 0&&o.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&o.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),o},h.validateLight=Af,h.validateStyle=vu,h.values=function(t){var o=[];for(var u in t)o.push(t[u]);return o},h.vectorTile=ff,h.version="1.13.3",h.warnOnce=Te,h.webpSupported=Vr,h.window=J,h.wrap=q}),z(["./shared"],function(h){"use strict";function D(te){var Q=typeof te;if(Q==="number"||Q==="boolean"||Q==="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){for(var ve="[",Oe=0,Xe=te;Oe<Xe.length;Oe+=1)ve+=D(Xe[Oe])+",";return ve+"]"}for(var ft=Object.keys(te).sort(),Et="{",Ne=0;Ne<ft.length;Ne++)Et+=JSON.stringify(ft[Ne])+":"+D(te[ft[Ne]])+",";return Et+"}"}function P(te){for(var Q="",ve=0,Oe=h.refProperties;ve<Oe.length;ve+=1)Q+="/"+D(te[Oe[ve]]);return Q}var X=function(te){this.keyCache={},te&&this.replace(te)};X.prototype.replace=function(te){this._layerConfigs={},this._layers={},this.update(te,[])},X.prototype.update=function(te,Q){for(var ve=this,Oe=0,Xe=te;Oe<Xe.length;Oe+=1){var ft=Xe[Oe];this._layerConfigs[ft.id]=ft;var Et=this._layers[ft.id]=h.createStyleLayer(ft);Et._featureFilter=h.featureFilter(Et.filter),this.keyCache[ft.id]&&delete this.keyCache[ft.id]}for(var Ne=0,Ue=Q;Ne<Ue.length;Ne+=1){var vt=Ue[Ne];delete this.keyCache[vt],delete this._layerConfigs[vt],delete this._layers[vt]}this.familiesBySource={};for(var ue=0,Lr=function(sn,xn){for(var wi={},Nn=0;Nn<sn.length;Nn++){var Bi=xn&&xn[sn[Nn].id]||P(sn[Nn]);xn&&(xn[sn[Nn].id]=Bi);var sa=wi[Bi];sa||(sa=wi[Bi]=[]),sa.push(sn[Nn])}var Fi=[];for(var bn in wi)Fi.push(wi[bn]);return Fi}(h.values(this._layerConfigs),this.keyCache);ue<Lr.length;ue+=1){var lr=Lr[ue].map(function(sn){return ve._layers[sn.id]}),$r=lr[0];if($r.visibility!=="none"){var Rn=$r.source||"",nn=this.familiesBySource[Rn];nn||(nn=this.familiesBySource[Rn]={});var xr=$r.sourceLayer||"_geojsonTileLayer",Or=nn[xr];Or||(Or=nn[xr]=[]),Or.push(lr)}}};var W=function(te){var Q={},ve=[];for(var Oe in te){var Xe=te[Oe],ft=Q[Oe]={};for(var Et in Xe){var Ne=Xe[+Et];if(Ne&&Ne.bitmap.width!==0&&Ne.bitmap.height!==0){var Ue={x:0,y:0,w:Ne.bitmap.width+2,h:Ne.bitmap.height+2};ve.push(Ue),ft[Et]={rect:Ue,metrics:Ne.metrics}}}}var vt=h.potpack(ve),ue=new h.AlphaImage({width:vt.w||1,height:vt.h||1});for(var Lr in te){var lr=te[Lr];for(var $r in lr){var Rn=lr[+$r];if(Rn&&Rn.bitmap.width!==0&&Rn.bitmap.height!==0){var nn=Q[Lr][$r].rect;h.AlphaImage.copy(Rn.bitmap,ue,{x:0,y:0},{x:nn.x+1,y:nn.y+1},Rn.bitmap)}}}this.image=ue,this.positions=Q};h.register("GlyphAtlas",W);var fe=function(te){this.tileID=new h.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId};function J(te,Q,ve){for(var Oe=new h.EvaluationParameters(Q),Xe=0,ft=te;Xe<ft.length;Xe+=1)ft[Xe].recalculate(Oe,ve)}function Be(te,Q){var ve=h.getArrayBuffer(te.request,function(Oe,Xe,ft,Et){Oe?Q(Oe):Xe&&Q(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(Xe)),rawData:Xe,cacheControl:ft,expires:Et})});return function(){ve.cancel(),Q()}}fe.prototype.parse=function(te,Q,ve,Oe,Xe){var ft=this;this.status="parsing",this.data=te,this.collisionBoxArray=new h.CollisionBoxArray;var Et=new h.DictionaryCoder(Object.keys(te.layers).sort()),Ne=new h.FeatureIndex(this.tileID,this.promoteId);Ne.bucketLayerIDs=[];var Ue,vt,ue,Lr,lr={},$r={featureIndex:Ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ve},Rn=Q.familiesBySource[this.source];for(var nn in Rn){var xr=te.layers[nn];if(xr){xr.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+nn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Or=Et.encode(nn),sn=[],xn=0;xn<xr.length;xn++){var wi=xr.feature(xn),Nn=Ne.getId(wi,nn);sn.push({feature:wi,id:Nn,index:xn,sourceLayerIndex:Or})}for(var Bi=0,sa=Rn[nn];Bi<sa.length;Bi+=1){var Fi=sa[Bi],bn=Fi[0];bn.minzoom&&this.zoom<Math.floor(bn.minzoom)||bn.maxzoom&&this.zoom>=bn.maxzoom||bn.visibility!=="none"&&(J(Fi,this.zoom,ve),(lr[bn.id]=bn.createBucket({index:Ne.bucketLayerIDs.length,layers:Fi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Or,sourceID:this.source})).populate(sn,$r,this.tileID.canonical),Ne.bucketLayerIDs.push(Fi.map(function(ia){return ia.id})))}}}var ei=h.mapObject($r.glyphDependencies,function(ia){return Object.keys(ia).map(Number)});Object.keys(ei).length?Oe.send("getGlyphs",{uid:this.uid,stacks:ei},function(ia,zi){Ue||(Ue=ia,vt=zi,no.call(ft))}):vt={};var ga=Object.keys($r.iconDependencies);ga.length?Oe.send("getImages",{icons:ga,source:this.source,tileID:this.tileID,type:"icons"},function(ia,zi){Ue||(Ue=ia,ue=zi,no.call(ft))}):ue={};var ua=Object.keys($r.patternDependencies);function no(){if(Ue)return Xe(Ue);if(vt&&ue&&Lr){var ia=new W(vt),zi=new h.ImageAtlas(ue,Lr);for(var Nr in lr){var ji=lr[Nr];ji instanceof h.SymbolBucket?(J(ji.layers,this.zoom,ve),h.performSymbolLayout(ji,vt,ia.positions,ue,zi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ji.hasPattern&&(ji instanceof h.LineBucket||ji instanceof h.FillBucket||ji instanceof h.FillExtrusionBucket)&&(J(ji.layers,this.zoom,ve),ji.addFeatures($r,this.tileID.canonical,zi.patternPositions))}this.status="done",Xe(null,{buckets:h.values(lr).filter(function(Hs){return!Hs.isEmpty()}),featureIndex:Ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ia.image,imageAtlas:zi,glyphMap:this.returnDependencies?vt:null,iconMap:this.returnDependencies?ue:null,glyphPositions:this.returnDependencies?ia.positions:null})}}ua.length?Oe.send("getImages",{icons:ua,source:this.source,tileID:this.tileID,type:"patterns"},function(ia,zi){Ue||(Ue=ia,Lr=zi,no.call(ft))}):Lr={},no.call(this)};var B=function(te,Q,ve,Oe){this.actor=te,this.layerIndex=Q,this.availableImages=ve,this.loadVectorData=Oe||Be,this.loading={},this.loaded={}};B.prototype.loadTile=function(te,Q){var ve=this,Oe=te.uid;this.loading||(this.loading={});var Xe=!!(te&&te.request&&te.request.collectResourceTiming)&&new h.RequestPerformance(te.request),ft=this.loading[Oe]=new fe(te);ft.abort=this.loadVectorData(te,function(Et,Ne){if(delete ve.loading[Oe],Et||!Ne)return ft.status="done",ve.loaded[Oe]=ft,Q(Et);var Ue=Ne.rawData,vt={};Ne.expires&&(vt.expires=Ne.expires),Ne.cacheControl&&(vt.cacheControl=Ne.cacheControl);var ue={};if(Xe){var Lr=Xe.finish();Lr&&(ue.resourceTiming=JSON.parse(JSON.stringify(Lr)))}ft.vectorTile=Ne.vectorTile,ft.parse(Ne.vectorTile,ve.layerIndex,ve.availableImages,ve.actor,function(lr,$r){if(lr||!$r)return Q(lr);Q(null,h.extend({rawTileData:Ue.slice(0)},$r,vt,ue))}),ve.loaded=ve.loaded||{},ve.loaded[Oe]=ft})},B.prototype.reloadTile=function(te,Q){var ve=this,Oe=this.loaded,Xe=te.uid,ft=this;if(Oe&&Oe[Xe]){var Et=Oe[Xe];Et.showCollisionBoxes=te.showCollisionBoxes;var Ne=function(Ue,vt){var ue=Et.reloadCallback;ue&&(delete Et.reloadCallback,Et.parse(Et.vectorTile,ft.layerIndex,ve.availableImages,ft.actor,ue)),Q(Ue,vt)};Et.status==="parsing"?Et.reloadCallback=Ne:Et.status==="done"&&(Et.vectorTile?Et.parse(Et.vectorTile,this.layerIndex,this.availableImages,this.actor,Ne):Ne())}},B.prototype.abortTile=function(te,Q){var ve=this.loading,Oe=te.uid;ve&&ve[Oe]&&ve[Oe].abort&&(ve[Oe].abort(),delete ve[Oe]),Q()},B.prototype.removeTile=function(te,Q){var ve=this.loaded,Oe=te.uid;ve&&ve[Oe]&&delete ve[Oe],Q()};var ee=h.window.ImageBitmap,U=function(){this.loaded={}};function q(te,Q){if(te.length!==0){le(te[0],Q);for(var ve=1;ve<te.length;ve++)le(te[ve],!Q)}}function le(te,Q){for(var ve=0,Oe=0,Xe=0,ft=te.length,Et=ft-1;Xe<ft;Et=Xe++){var Ne=(te[Xe][0]-te[Et][0])*(te[Et][1]+te[Xe][1]),Ue=ve+Ne;Oe+=Math.abs(ve)>=Math.abs(Ne)?ve-Ue+Ne:Ne-Ue+ve,ve=Ue}ve+Oe>=0!=!!Q&&te.reverse()}U.prototype.loadTile=function(te,Q){var ve=te.uid,Oe=te.encoding,Xe=te.rawImageData,ft=ee&&Xe instanceof ee?this.getImageData(Xe):Xe,Et=new h.DEMData(ve,ft,Oe);this.loaded=this.loaded||{},this.loaded[ve]=Et,Q(null,Et)},U.prototype.getImageData=function(te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);var Q=this.offscreenCanvasContext.getImageData(-1,-1,te.width+2,te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:Q.width,height:Q.height},Q.data)},U.prototype.removeTile=function(te){var Q=this.loaded,ve=te.uid;Q&&Q[ve]&&delete Q[ve]};var j=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ce=function(te){this._feature=te,this.extent=h.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))};Ce.prototype.loadGeometry=function(){if(this._feature.type===1){for(var te=[],Q=0,ve=this._feature.geometry;Q<ve.length;Q+=1){var Oe=ve[Q];te.push([new h.Point$1(Oe[0],Oe[1])])}return te}for(var Xe=[],ft=0,Et=this._feature.geometry;ft<Et.length;ft+=1){for(var Ne=[],Ue=0,vt=Et[ft];Ue<vt.length;Ue+=1){var ue=vt[Ue];Ne.push(new h.Point$1(ue[0],ue[1]))}Xe.push(Ne)}return Xe},Ce.prototype.toGeoJSON=function(te,Q,ve){return j.call(this,te,Q,ve)};var $e=function(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=te.length,this._features=te};$e.prototype.feature=function(te){return new Ce(this._features[te])};var Fe=h.vectorTile.VectorTileFeature,lt=We;function We(te,Q){this.options=Q||{},this.features=te,this.length=te.length}function Ze(te,Q){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=Q||4096}We.prototype.feature=function(te){return new Ze(this.features[te],this.options.extent)},Ze.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var Q=0;Q<te.length;Q++){for(var ve=te[Q],Oe=[],Xe=0;Xe<ve.length;Xe++)Oe.push(new h.Point$1(ve[Xe][0],ve[Xe][1]));this.geometry.push(Oe)}return this.geometry},Ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,Q=1/0,ve=-1/0,Oe=1/0,Xe=-1/0,ft=0;ft<te.length;ft++)for(var Et=te[ft],Ne=0;Ne<Et.length;Ne++){var Ue=Et[Ne];Q=Math.min(Q,Ue.x),ve=Math.max(ve,Ue.x),Oe=Math.min(Oe,Ue.y),Xe=Math.max(Xe,Ue.y)}return[Q,Oe,ve,Xe]},Ze.prototype.toGeoJSON=Fe.prototype.toGeoJSON;var pe=be,se=lt;function be(te){var Q=new h.pbf;return function(ve,Oe){for(var Xe in ve.layers)Oe.writeMessage(3,Te,ve.layers[Xe])}(te,Q),Q.finish()}function Te(te,Q){var ve;Q.writeVarintField(15,te.version||1),Q.writeStringField(1,te.name||""),Q.writeVarintField(5,te.extent||4096);var Oe={keys:[],values:[],keycache:{},valuecache:{}};for(ve=0;ve<te.length;ve++)Oe.feature=te.feature(ve),Q.writeMessage(2,de,Oe);var Xe=Oe.keys;for(ve=0;ve<Xe.length;ve++)Q.writeStringField(3,Xe[ve]);var ft=Oe.values;for(ve=0;ve<ft.length;ve++)Q.writeMessage(4,Re,ft[ve])}function de(te,Q){var ve=te.feature;ve.id!==void 0&&Q.writeVarintField(1,ve.id),Q.writeMessage(2,Rt,te),Q.writeVarintField(3,ve.type),Q.writeMessage(4,oe,ve)}function Rt(te,Q){var ve=te.feature,Oe=te.keys,Xe=te.values,ft=te.keycache,Et=te.valuecache;for(var Ne in ve.properties){var Ue=ft[Ne];Ue===void 0&&(Oe.push(Ne),ft[Ne]=Ue=Oe.length-1),Q.writeVarint(Ue);var vt=ve.properties[Ne],ue=typeof vt;ue!=="string"&&ue!=="boolean"&&ue!=="number"&&(vt=JSON.stringify(vt));var Lr=ue+":"+vt,lr=Et[Lr];lr===void 0&&(Xe.push(vt),Et[Lr]=lr=Xe.length-1),Q.writeVarint(lr)}}function ye(te,Q){return(Q<<3)+(7&te)}function Ve(te){return te<<1^te>>31}function oe(te,Q){for(var ve=te.loadGeometry(),Oe=te.type,Xe=0,ft=0,Et=ve.length,Ne=0;Ne<Et;Ne++){var Ue=ve[Ne],vt=1;Oe===1&&(vt=Ue.length),Q.writeVarint(ye(1,vt));for(var ue=Oe===3?Ue.length-1:Ue.length,Lr=0;Lr<ue;Lr++){Lr===1&&Oe!==1&&Q.writeVarint(ye(2,ue-1));var lr=Ue[Lr].x-Xe,$r=Ue[Lr].y-ft;Q.writeVarint(Ve(lr)),Q.writeVarint(Ve($r)),Xe+=lr,ft+=$r}Oe===3&&Q.writeVarint(ye(7,1))}}function Re(te,Q){var ve=typeof te;ve==="string"?Q.writeStringField(1,te):ve==="boolean"?Q.writeBooleanField(7,te):ve==="number"&&(te%1!=0?Q.writeDoubleField(3,te):te<0?Q.writeSVarintField(6,te):Q.writeVarintField(5,te))}function Se(te,Q,ve,Oe){et(te,ve,Oe),et(Q,2*ve,2*Oe),et(Q,2*ve+1,2*Oe+1)}function et(te,Q,ve){var Oe=te[Q];te[Q]=te[ve],te[ve]=Oe}function st(te,Q,ve,Oe){var Xe=te-ve,ft=Q-Oe;return Xe*Xe+ft*ft}pe.fromVectorTileJs=be,pe.fromGeojsonVt=function(te,Q){Q=Q||{};var ve={};for(var Oe in te)ve[Oe]=new lt(te[Oe].features,Q),ve[Oe].name=Oe,ve[Oe].version=Q.version,ve[Oe].extent=Q.extent;return be({layers:ve})},pe.GeoJSONWrapper=se;var pt=function(te){return te[0]},bt=function(te){return te[1]},ke=function(te,Q,ve,Oe,Xe){Q===void 0&&(Q=pt),ve===void 0&&(ve=bt),Oe===void 0&&(Oe=64),Xe===void 0&&(Xe=Float64Array),this.nodeSize=Oe,this.points=te;for(var ft=te.length<65536?Uint16Array:Uint32Array,Et=this.ids=new ft(te.length),Ne=this.coords=new Xe(2*te.length),Ue=0;Ue<te.length;Ue++)Et[Ue]=Ue,Ne[2*Ue]=Q(te[Ue]),Ne[2*Ue+1]=ve(te[Ue]);(function vt(ue,Lr,lr,$r,Rn,nn){if(!(Rn-$r<=lr)){var xr=$r+Rn>>1;(function Or(sn,xn,wi,Nn,Bi,sa){for(;Bi>Nn;){if(Bi-Nn>600){var Fi=Bi-Nn+1,bn=wi-Nn+1,ei=Math.log(Fi),ga=.5*Math.exp(2*ei/3),ua=.5*Math.sqrt(ei*ga*(Fi-ga)/Fi)*(bn-Fi/2<0?-1:1);Or(sn,xn,wi,Math.max(Nn,Math.floor(wi-bn*ga/Fi+ua)),Math.min(Bi,Math.floor(wi+(Fi-bn)*ga/Fi+ua)),sa)}var no=xn[2*wi+sa],ia=Nn,zi=Bi;for(Se(sn,xn,Nn,wi),xn[2*Bi+sa]>no&&Se(sn,xn,Nn,Bi);ia<zi;){for(Se(sn,xn,ia,zi),ia++,zi--;xn[2*ia+sa]<no;)ia++;for(;xn[2*zi+sa]>no;)zi--}xn[2*Nn+sa]===no?Se(sn,xn,Nn,zi):Se(sn,xn,++zi,Bi),zi<=wi&&(Nn=zi+1),wi<=zi&&(Bi=zi-1)}})(ue,Lr,xr,$r,Rn,nn%2),vt(ue,Lr,lr,$r,xr-1,nn+1),vt(ue,Lr,lr,xr+1,Rn,nn+1)}})(Et,Ne,Oe,0,Et.length-1,0)};ke.prototype.range=function(te,Q,ve,Oe){return function(Xe,ft,Et,Ne,Ue,vt,ue){for(var Lr,lr,$r=[0,Xe.length-1,0],Rn=[];$r.length;){var nn=$r.pop(),xr=$r.pop(),Or=$r.pop();if(xr-Or<=ue)for(var sn=Or;sn<=xr;sn++)lr=ft[2*sn+1],(Lr=ft[2*sn])>=Et&&Lr<=Ue&&lr>=Ne&&lr<=vt&&Rn.push(Xe[sn]);else{var xn=Math.floor((Or+xr)/2);lr=ft[2*xn+1],(Lr=ft[2*xn])>=Et&&Lr<=Ue&&lr>=Ne&&lr<=vt&&Rn.push(Xe[xn]);var wi=(nn+1)%2;(nn===0?Et<=Lr:Ne<=lr)&&($r.push(Or),$r.push(xn-1),$r.push(wi)),(nn===0?Ue>=Lr:vt>=lr)&&($r.push(xn+1),$r.push(xr),$r.push(wi))}}return Rn}(this.ids,this.coords,te,Q,ve,Oe,this.nodeSize)},ke.prototype.within=function(te,Q,ve){return function(Oe,Xe,ft,Et,Ne,Ue){for(var vt=[0,Oe.length-1,0],ue=[],Lr=Ne*Ne;vt.length;){var lr=vt.pop(),$r=vt.pop(),Rn=vt.pop();if($r-Rn<=Ue)for(var nn=Rn;nn<=$r;nn++)st(Xe[2*nn],Xe[2*nn+1],ft,Et)<=Lr&&ue.push(Oe[nn]);else{var xr=Math.floor((Rn+$r)/2),Or=Xe[2*xr],sn=Xe[2*xr+1];st(Or,sn,ft,Et)<=Lr&&ue.push(Oe[xr]);var xn=(lr+1)%2;(lr===0?ft-Ne<=Or:Et-Ne<=sn)&&(vt.push(Rn),vt.push(xr-1),vt.push(xn)),(lr===0?ft+Ne>=Or:Et+Ne>=sn)&&(vt.push(xr+1),vt.push($r),vt.push(xn))}}return ue}(this.ids,this.coords,te,Q,ve,this.nodeSize)};var ur={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},qt=function(te){this.options=vn(Object.create(ur),te),this.trees=new Array(this.options.maxZoom+1)};function _n(te,Q,ve,Oe,Xe){return{x:te,y:Q,zoom:1/0,id:ve,parentId:-1,numPoints:Oe,properties:Xe}}function Zr(te,Q){var ve=te.geometry.coordinates,Oe=ve[1];return{x:Qr(ve[0]),y:ln(Oe),zoom:1/0,index:Q,parentId:-1}}function Vr(te){return{type:"Feature",id:te.id,properties:rn(te),geometry:{type:"Point",coordinates:[(Oe=te.x,360*(Oe-.5)),(Q=te.y,ve=(180-360*Q)*Math.PI/180,360*Math.atan(Math.exp(ve))/Math.PI-90)]}};var Q,ve,Oe}function rn(te){var Q=te.numPoints,ve=Q>=1e4?Math.round(Q/1e3)+"k":Q>=1e3?Math.round(Q/100)/10+"k":Q;return vn(vn({},te.properties),{cluster:!0,cluster_id:te.id,point_count:Q,point_count_abbreviated:ve})}function Qr(te){return te/360+.5}function ln(te){var Q=Math.sin(te*Math.PI/180),ve=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ve<0?0:ve>1?1:ve}function vn(te,Q){for(var ve in Q)te[ve]=Q[ve];return te}function $t(te){return te.x}function _r(te){return te.y}function kt(te,Q,ve,Oe,Xe,ft){var Et=Xe-ve,Ne=ft-Oe;if(Et!==0||Ne!==0){var Ue=((te-ve)*Et+(Q-Oe)*Ne)/(Et*Et+Ne*Ne);Ue>1?(ve=Xe,Oe=ft):Ue>0&&(ve+=Et*Ue,Oe+=Ne*Ue)}return(Et=te-ve)*Et+(Ne=Q-Oe)*Ne}function qe(te,Q,ve,Oe){var Xe={id:te===void 0?null:te,type:Q,geometry:ve,tags:Oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ft){var Et=ft.geometry,Ne=ft.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")Sr(ft,Et);else if(Ne==="Polygon"||Ne==="MultiLineString")for(var Ue=0;Ue<Et.length;Ue++)Sr(ft,Et[Ue]);else if(Ne==="MultiPolygon")for(Ue=0;Ue<Et.length;Ue++)for(var vt=0;vt<Et[Ue].length;vt++)Sr(ft,Et[Ue][vt])}(Xe),Xe}function Sr(te,Q){for(var ve=0;ve<Q.length;ve+=3)te.minX=Math.min(te.minX,Q[ve]),te.minY=Math.min(te.minY,Q[ve+1]),te.maxX=Math.max(te.maxX,Q[ve]),te.maxY=Math.max(te.maxY,Q[ve+1])}function Pe(te,Q,ve,Oe){if(Q.geometry){var Xe=Q.geometry.coordinates,ft=Q.geometry.type,Et=Math.pow(ve.tolerance/((1<<ve.maxZoom)*ve.extent),2),Ne=[],Ue=Q.id;if(ve.promoteId?Ue=Q.properties[ve.promoteId]:ve.generateId&&(Ue=Oe||0),ft==="Point")Hr(Xe,Ne);else if(ft==="MultiPoint")for(var vt=0;vt<Xe.length;vt++)Hr(Xe[vt],Ne);else if(ft==="LineString")vr(Xe,Ne,Et,!1);else if(ft==="MultiLineString"){if(ve.lineMetrics){for(vt=0;vt<Xe.length;vt++)vr(Xe[vt],Ne=[],Et,!1),te.push(qe(Ue,"LineString",Ne,Q.properties));return}Ie(Xe,Ne,Et,!1)}else if(ft==="Polygon")Ie(Xe,Ne,Et,!0);else{if(ft!=="MultiPolygon"){if(ft==="GeometryCollection"){for(vt=0;vt<Q.geometry.geometries.length;vt++)Pe(te,{id:Ue,geometry:Q.geometry.geometries[vt],properties:Q.properties},ve,Oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(vt=0;vt<Xe.length;vt++){var ue=[];Ie(Xe[vt],ue,Et,!0),Ne.push(ue)}}te.push(qe(Ue,ft,Ne,Q.properties))}}function Hr(te,Q){Q.push(gr(te[0])),Q.push(Wr(te[1])),Q.push(0)}function vr(te,Q,ve,Oe){for(var Xe,ft,Et=0,Ne=0;Ne<te.length;Ne++){var Ue=gr(te[Ne][0]),vt=Wr(te[Ne][1]);Q.push(Ue),Q.push(vt),Q.push(0),Ne>0&&(Et+=Oe?(Xe*vt-Ue*ft)/2:Math.sqrt(Math.pow(Ue-Xe,2)+Math.pow(vt-ft,2))),Xe=Ue,ft=vt}var ue=Q.length-3;Q[2]=1,function Lr(lr,$r,Rn,nn){for(var xr,Or=nn,sn=Rn-$r>>1,xn=Rn-$r,wi=lr[$r],Nn=lr[$r+1],Bi=lr[Rn],sa=lr[Rn+1],Fi=$r+3;Fi<Rn;Fi+=3){var bn=kt(lr[Fi],lr[Fi+1],wi,Nn,Bi,sa);if(bn>Or)xr=Fi,Or=bn;else if(bn===Or){var ei=Math.abs(Fi-sn);ei<xn&&(xr=Fi,xn=ei)}}Or>nn&&(xr-$r>3&&Lr(lr,$r,xr,nn),lr[xr+2]=Or,Rn-xr>3&&Lr(lr,xr,Rn,nn))}(Q,0,ue,ve),Q[ue+2]=1,Q.size=Math.abs(Et),Q.start=0,Q.end=Q.size}function Ie(te,Q,ve,Oe){for(var Xe=0;Xe<te.length;Xe++){var ft=[];vr(te[Xe],ft,ve,Oe),Q.push(ft)}}function gr(te){return te/360+.5}function Wr(te){var Q=Math.sin(te*Math.PI/180),ve=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ve<0?0:ve>1?1:ve}function Dr(te,Q,ve,Oe,Xe,ft,Et,Ne){if(Oe/=Q,ft>=(ve/=Q)&&Et<Oe)return te;if(Et<ve||ft>=Oe)return null;for(var Ue=[],vt=0;vt<te.length;vt++){var ue=te[vt],Lr=ue.geometry,lr=ue.type,$r=Xe===0?ue.minX:ue.minY,Rn=Xe===0?ue.maxX:ue.maxY;if($r>=ve&&Rn<Oe)Ue.push(ue);else if(!(Rn<ve||$r>=Oe)){var nn=[];if(lr==="Point"||lr==="MultiPoint")Xr(Lr,nn,ve,Oe,Xe);else if(lr==="LineString")Vn(Lr,nn,ve,Oe,Xe,!1,Ne.lineMetrics);else if(lr==="MultiLineString")Dn(Lr,nn,ve,Oe,Xe,!1);else if(lr==="Polygon")Dn(Lr,nn,ve,Oe,Xe,!0);else if(lr==="MultiPolygon")for(var xr=0;xr<Lr.length;xr++){var Or=[];Dn(Lr[xr],Or,ve,Oe,Xe,!0),Or.length&&nn.push(Or)}if(nn.length){if(Ne.lineMetrics&&lr==="LineString"){for(xr=0;xr<nn.length;xr++)Ue.push(qe(ue.id,lr,nn[xr],ue.tags));continue}lr!=="LineString"&&lr!=="MultiLineString"||(nn.length===1?(lr="LineString",nn=nn[0]):lr="MultiLineString"),lr!=="Point"&&lr!=="MultiPoint"||(lr=nn.length===3?"Point":"MultiPoint"),Ue.push(qe(ue.id,lr,nn,ue.tags))}}}return Ue.length?Ue:null}function Xr(te,Q,ve,Oe,Xe){for(var ft=0;ft<te.length;ft+=3){var Et=te[ft+Xe];Et>=ve&&Et<=Oe&&(Q.push(te[ft]),Q.push(te[ft+1]),Q.push(te[ft+2]))}}function Vn(te,Q,ve,Oe,Xe,ft,Et){for(var Ne,Ue,vt=ni(te),ue=Xe===0?Yi:bi,Lr=te.start,lr=0;lr<te.length-3;lr+=3){var $r=te[lr],Rn=te[lr+1],nn=te[lr+2],xr=te[lr+3],Or=te[lr+4],sn=Xe===0?$r:Rn,xn=Xe===0?xr:Or,wi=!1;Et&&(Ne=Math.sqrt(Math.pow($r-xr,2)+Math.pow(Rn-Or,2))),sn<ve?xn>ve&&(Ue=ue(vt,$r,Rn,xr,Or,ve),Et&&(vt.start=Lr+Ne*Ue)):sn>Oe?xn<Oe&&(Ue=ue(vt,$r,Rn,xr,Or,Oe),Et&&(vt.start=Lr+Ne*Ue)):Jn(vt,$r,Rn,nn),xn<ve&&sn>=ve&&(Ue=ue(vt,$r,Rn,xr,Or,ve),wi=!0),xn>Oe&&sn<=Oe&&(Ue=ue(vt,$r,Rn,xr,Or,Oe),wi=!0),!ft&&wi&&(Et&&(vt.end=Lr+Ne*Ue),Q.push(vt),vt=ni(te)),Et&&(Lr+=Ne)}var Nn=te.length-3;$r=te[Nn],Rn=te[Nn+1],nn=te[Nn+2],(sn=Xe===0?$r:Rn)>=ve&&sn<=Oe&&Jn(vt,$r,Rn,nn),Nn=vt.length-3,ft&&Nn>=3&&(vt[Nn]!==vt[0]||vt[Nn+1]!==vt[1])&&Jn(vt,vt[0],vt[1],vt[2]),vt.length&&Q.push(vt)}function ni(te){var Q=[];return Q.size=te.size,Q.start=te.start,Q.end=te.end,Q}function Dn(te,Q,ve,Oe,Xe,ft){for(var Et=0;Et<te.length;Et++)Vn(te[Et],Q,ve,Oe,Xe,ft,!1)}function Jn(te,Q,ve,Oe){te.push(Q),te.push(ve),te.push(Oe)}function Yi(te,Q,ve,Oe,Xe,ft){var Et=(ft-Q)/(Oe-Q);return te.push(ft),te.push(ve+(Xe-ve)*Et),te.push(1),Et}function bi(te,Q,ve,Oe,Xe,ft){var Et=(ft-ve)/(Xe-ve);return te.push(Q+(Oe-Q)*Et),te.push(ft),te.push(1),Et}function ui(te,Q){for(var ve=[],Oe=0;Oe<te.length;Oe++){var Xe,ft=te[Oe],Et=ft.type;if(Et==="Point"||Et==="MultiPoint"||Et==="LineString")Xe=pi(ft.geometry,Q);else if(Et==="MultiLineString"||Et==="Polygon"){Xe=[];for(var Ne=0;Ne<ft.geometry.length;Ne++)Xe.push(pi(ft.geometry[Ne],Q))}else if(Et==="MultiPolygon")for(Xe=[],Ne=0;Ne<ft.geometry.length;Ne++){for(var Ue=[],vt=0;vt<ft.geometry[Ne].length;vt++)Ue.push(pi(ft.geometry[Ne][vt],Q));Xe.push(Ue)}ve.push(qe(ft.id,Et,Xe,ft.tags))}return ve}function pi(te,Q){var ve=[];ve.size=te.size,te.start!==void 0&&(ve.start=te.start,ve.end=te.end);for(var Oe=0;Oe<te.length;Oe+=3)ve.push(te[Oe]+Q,te[Oe+1],te[Oe+2]);return ve}function it(te,Q){if(te.transformed)return te;var ve,Oe,Xe,ft=1<<te.z,Et=te.x,Ne=te.y;for(ve=0;ve<te.features.length;ve++){var Ue=te.features[ve],vt=Ue.geometry,ue=Ue.type;if(Ue.geometry=[],ue===1)for(Oe=0;Oe<vt.length;Oe+=2)Ue.geometry.push(V(vt[Oe],vt[Oe+1],Q,ft,Et,Ne));else for(Oe=0;Oe<vt.length;Oe++){var Lr=[];for(Xe=0;Xe<vt[Oe].length;Xe+=2)Lr.push(V(vt[Oe][Xe],vt[Oe][Xe+1],Q,ft,Et,Ne));Ue.geometry.push(Lr)}}return te.transformed=!0,te}function V(te,Q,ve,Oe,Xe,ft){return[Math.round(ve*(te*Oe-Xe)),Math.round(ve*(Q*Oe-ft))]}function H(te,Q,ve,Oe,Xe){for(var ft=Q===Xe.maxZoom?0:Xe.tolerance/((1<<Q)*Xe.extent),Et={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ve,y:Oe,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ne=0;Ne<te.length;Ne++){Et.numFeatures++,Ee(Et,te[Ne],ft,Xe);var Ue=te[Ne].minX,vt=te[Ne].minY,ue=te[Ne].maxX,Lr=te[Ne].maxY;Ue<Et.minX&&(Et.minX=Ue),vt<Et.minY&&(Et.minY=vt),ue>Et.maxX&&(Et.maxX=ue),Lr>Et.maxY&&(Et.maxY=Lr)}return Et}function Ee(te,Q,ve,Oe){var Xe=Q.geometry,ft=Q.type,Et=[];if(ft==="Point"||ft==="MultiPoint")for(var Ne=0;Ne<Xe.length;Ne+=3)Et.push(Xe[Ne]),Et.push(Xe[Ne+1]),te.numPoints++,te.numSimplified++;else if(ft==="LineString")Le(Et,Xe,te,ve,!1,!1);else if(ft==="MultiLineString"||ft==="Polygon")for(Ne=0;Ne<Xe.length;Ne++)Le(Et,Xe[Ne],te,ve,ft==="Polygon",Ne===0);else if(ft==="MultiPolygon")for(var Ue=0;Ue<Xe.length;Ue++){var vt=Xe[Ue];for(Ne=0;Ne<vt.length;Ne++)Le(Et,vt[Ne],te,ve,!0,Ne===0)}if(Et.length){var ue=Q.tags||null;if(ft==="LineString"&&Oe.lineMetrics){for(var Lr in ue={},Q.tags)ue[Lr]=Q.tags[Lr];ue.mapbox_clip_start=Xe.start/Xe.size,ue.mapbox_clip_end=Xe.end/Xe.size}var lr={geometry:Et,type:ft==="Polygon"||ft==="MultiPolygon"?3:ft==="LineString"||ft==="MultiLineString"?2:1,tags:ue};Q.id!==null&&(lr.id=Q.id),te.features.push(lr)}}function Le(te,Q,ve,Oe,Xe,ft){var Et=Oe*Oe;if(Oe>0&&Q.size<(Xe?Et:Oe))ve.numPoints+=Q.length/3;else{for(var Ne=[],Ue=0;Ue<Q.length;Ue+=3)(Oe===0||Q[Ue+2]>Et)&&(ve.numSimplified++,Ne.push(Q[Ue]),Ne.push(Q[Ue+1])),ve.numPoints++;Xe&&function(vt,ue){for(var Lr=0,lr=0,$r=vt.length,Rn=$r-2;lr<$r;Rn=lr,lr+=2)Lr+=(vt[lr]-vt[Rn])*(vt[lr+1]+vt[Rn+1]);if(Lr>0===ue)for(lr=0,$r=vt.length;lr<$r/2;lr+=2){var nn=vt[lr],xr=vt[lr+1];vt[lr]=vt[$r-2-lr],vt[lr+1]=vt[$r-1-lr],vt[$r-2-lr]=nn,vt[$r-1-lr]=xr}}(Ne,ft),te.push(Ne)}}function ze(te,Q){var ve=(Q=this.options=function(Xe,ft){for(var Et in ft)Xe[Et]=ft[Et];return Xe}(Object.create(this.options),Q)).debug;if(ve&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var Oe=function(Xe,ft){var Et=[];if(Xe.type==="FeatureCollection")for(var Ne=0;Ne<Xe.features.length;Ne++)Pe(Et,Xe.features[Ne],ft,Ne);else Pe(Et,Xe.type==="Feature"?Xe:{geometry:Xe},ft);return Et}(te,Q);this.tiles={},this.tileCoords=[],ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Oe=function(Xe,ft){var Et=ft.buffer/ft.extent,Ne=Xe,Ue=Dr(Xe,1,-1-Et,Et,0,-1,2,ft),vt=Dr(Xe,1,1-Et,2+Et,0,-1,2,ft);return(Ue||vt)&&(Ne=Dr(Xe,1,-Et,1+Et,0,-1,2,ft)||[],Ue&&(Ne=ui(Ue,1).concat(Ne)),vt&&(Ne=Ne.concat(ui(vt,-1)))),Ne}(Oe,Q)).length&&this.splitTile(Oe,0,0,0),ve&&(Oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(te,Q,ve){return 32*((1<<te)*ve+Q)+te}function Ut(te,Q){var ve=te.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);var Oe=this._geoJSONIndex.getTile(ve.z,ve.x,ve.y);if(!Oe)return Q(null,null);var Xe=new $e(Oe.features),ft=pe(Xe);ft.byteOffset===0&&ft.byteLength===ft.buffer.byteLength||(ft=new Uint8Array(ft)),Q(null,{vectorTile:Xe,rawData:ft.buffer})}qt.prototype.load=function(te){var Q=this.options,ve=Q.log,Oe=Q.minZoom,Xe=Q.maxZoom,ft=Q.nodeSize;ve&&console.time("total time");var Et="prepare "+te.length+" points";ve&&console.time(Et),this.points=te;for(var Ne=[],Ue=0;Ue<te.length;Ue++)te[Ue].geometry&&Ne.push(Zr(te[Ue],Ue));this.trees[Xe+1]=new ke(Ne,$t,_r,ft,Float32Array),ve&&console.timeEnd(Et);for(var vt=Xe;vt>=Oe;vt--){var ue=+Date.now();Ne=this._cluster(Ne,vt),this.trees[vt]=new ke(Ne,$t,_r,ft,Float32Array),ve&&console.log("z%d: %d clusters in %dms",vt,Ne.length,+Date.now()-ue)}return ve&&console.timeEnd("total time"),this},qt.prototype.getClusters=function(te,Q){var ve=((te[0]+180)%360+360)%360-180,Oe=Math.max(-90,Math.min(90,te[1])),Xe=te[2]===180?180:((te[2]+180)%360+360)%360-180,ft=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)ve=-180,Xe=180;else if(ve>Xe){var Et=this.getClusters([ve,Oe,180,ft],Q),Ne=this.getClusters([-180,Oe,Xe,ft],Q);return Et.concat(Ne)}for(var Ue=this.trees[this._limitZoom(Q)],vt=[],ue=0,Lr=Ue.range(Qr(ve),ln(ft),Qr(Xe),ln(Oe));ue<Lr.length;ue+=1){var lr=Ue.points[Lr[ue]];vt.push(lr.numPoints?Vr(lr):this.points[lr.index])}return vt},qt.prototype.getChildren=function(te){var Q=this._getOriginId(te),ve=this._getOriginZoom(te),Oe="No cluster with the specified id.",Xe=this.trees[ve];if(!Xe)throw new Error(Oe);var ft=Xe.points[Q];if(!ft)throw new Error(Oe);for(var Et=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),Ne=[],Ue=0,vt=Xe.within(ft.x,ft.y,Et);Ue<vt.length;Ue+=1){var ue=Xe.points[vt[Ue]];ue.parentId===te&&Ne.push(ue.numPoints?Vr(ue):this.points[ue.index])}if(Ne.length===0)throw new Error(Oe);return Ne},qt.prototype.getLeaves=function(te,Q,ve){var Oe=[];return this._appendLeaves(Oe,te,Q=Q||10,ve=ve||0,0),Oe},qt.prototype.getTile=function(te,Q,ve){var Oe=this.trees[this._limitZoom(te)],Xe=Math.pow(2,te),ft=this.options,Et=ft.radius/ft.extent,Ne=(ve-Et)/Xe,Ue=(ve+1+Et)/Xe,vt={features:[]};return this._addTileFeatures(Oe.range((Q-Et)/Xe,Ne,(Q+1+Et)/Xe,Ue),Oe.points,Q,ve,Xe,vt),Q===0&&this._addTileFeatures(Oe.range(1-Et/Xe,Ne,1,Ue),Oe.points,Xe,ve,Xe,vt),Q===Xe-1&&this._addTileFeatures(Oe.range(0,Ne,Et/Xe,Ue),Oe.points,-1,ve,Xe,vt),vt.features.length?vt:null},qt.prototype.getClusterExpansionZoom=function(te){for(var Q=this._getOriginZoom(te)-1;Q<=this.options.maxZoom;){var ve=this.getChildren(te);if(Q++,ve.length!==1)break;te=ve[0].properties.cluster_id}return Q},qt.prototype._appendLeaves=function(te,Q,ve,Oe,Xe){for(var ft=0,Et=this.getChildren(Q);ft<Et.length;ft+=1){var Ne=Et[ft],Ue=Ne.properties;if(Ue&&Ue.cluster?Xe+Ue.point_count<=Oe?Xe+=Ue.point_count:Xe=this._appendLeaves(te,Ue.cluster_id,ve,Oe,Xe):Xe<Oe?Xe++:te.push(Ne),te.length===ve)break}return Xe},qt.prototype._addTileFeatures=function(te,Q,ve,Oe,Xe,ft){for(var Et=0,Ne=te;Et<Ne.length;Et+=1){var Ue=Q[Ne[Et]],vt=Ue.numPoints,ue={type:1,geometry:[[Math.round(this.options.extent*(Ue.x*Xe-ve)),Math.round(this.options.extent*(Ue.y*Xe-Oe))]],tags:vt?rn(Ue):this.points[Ue.index].properties},Lr=void 0;vt?Lr=Ue.id:this.options.generateId?Lr=Ue.index:this.points[Ue.index].id&&(Lr=this.points[Ue.index].id),Lr!==void 0&&(ue.id=Lr),ft.features.push(ue)}},qt.prototype._limitZoom=function(te){return Math.max(this.options.minZoom,Math.min(+te,this.options.maxZoom+1))},qt.prototype._cluster=function(te,Q){for(var ve=[],Oe=this.options,Xe=Oe.reduce,ft=Oe.minPoints,Et=Oe.radius/(Oe.extent*Math.pow(2,Q)),Ne=0;Ne<te.length;Ne++){var Ue=te[Ne];if(!(Ue.zoom<=Q)){Ue.zoom=Q;for(var vt=this.trees[Q+1],ue=vt.within(Ue.x,Ue.y,Et),Lr=Ue.numPoints||1,lr=Lr,$r=0,Rn=ue;$r<Rn.length;$r+=1){var nn=vt.points[Rn[$r]];nn.zoom>Q&&(lr+=nn.numPoints||1)}if(lr>=ft){for(var xr=Ue.x*Lr,Or=Ue.y*Lr,sn=Xe&&Lr>1?this._map(Ue,!0):null,xn=(Ne<<5)+(Q+1)+this.points.length,wi=0,Nn=ue;wi<Nn.length;wi+=1){var Bi=vt.points[Nn[wi]];if(!(Bi.zoom<=Q)){Bi.zoom=Q;var sa=Bi.numPoints||1;xr+=Bi.x*sa,Or+=Bi.y*sa,Bi.parentId=xn,Xe&&(sn||(sn=this._map(Ue,!0)),Xe(sn,this._map(Bi)))}}Ue.parentId=xn,ve.push(_n(xr/lr,Or/lr,xn,lr,sn))}else if(ve.push(Ue),lr>1)for(var Fi=0,bn=ue;Fi<bn.length;Fi+=1){var ei=vt.points[bn[Fi]];ei.zoom<=Q||(ei.zoom=Q,ve.push(ei))}}}return ve},qt.prototype._getOriginId=function(te){return te-this.points.length>>5},qt.prototype._getOriginZoom=function(te){return(te-this.points.length)%32},qt.prototype._map=function(te,Q){if(te.numPoints)return Q?vn({},te.properties):te.properties;var ve=this.points[te.index].properties,Oe=this.options.map(ve);return Q&&Oe===ve?vn({},Oe):Oe},ze.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ze.prototype.splitTile=function(te,Q,ve,Oe,Xe,ft,Et){for(var Ne=[te,Q,ve,Oe],Ue=this.options,vt=Ue.debug;Ne.length;){Oe=Ne.pop(),ve=Ne.pop(),Q=Ne.pop(),te=Ne.pop();var ue=1<<Q,Lr=xt(Q,ve,Oe),lr=this.tiles[Lr];if(!lr&&(vt>1&&console.time("creation"),lr=this.tiles[Lr]=H(te,Q,ve,Oe,Ue),this.tileCoords.push({z:Q,x:ve,y:Oe}),vt)){vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ve,Oe,lr.numFeatures,lr.numPoints,lr.numSimplified),console.timeEnd("creation"));var $r="z"+Q;this.stats[$r]=(this.stats[$r]||0)+1,this.total++}if(lr.source=te,Xe){if(Q===Ue.maxZoom||Q===Xe)continue;var Rn=1<<Xe-Q;if(ve!==Math.floor(ft/Rn)||Oe!==Math.floor(Et/Rn))continue}else if(Q===Ue.indexMaxZoom||lr.numPoints<=Ue.indexMaxPoints)continue;if(lr.source=null,te.length!==0){vt>1&&console.time("clipping");var nn,xr,Or,sn,xn,wi,Nn=.5*Ue.buffer/Ue.extent,Bi=.5-Nn,sa=.5+Nn,Fi=1+Nn;nn=xr=Or=sn=null,xn=Dr(te,ue,ve-Nn,ve+sa,0,lr.minX,lr.maxX,Ue),wi=Dr(te,ue,ve+Bi,ve+Fi,0,lr.minX,lr.maxX,Ue),te=null,xn&&(nn=Dr(xn,ue,Oe-Nn,Oe+sa,1,lr.minY,lr.maxY,Ue),xr=Dr(xn,ue,Oe+Bi,Oe+Fi,1,lr.minY,lr.maxY,Ue),xn=null),wi&&(Or=Dr(wi,ue,Oe-Nn,Oe+sa,1,lr.minY,lr.maxY,Ue),sn=Dr(wi,ue,Oe+Bi,Oe+Fi,1,lr.minY,lr.maxY,Ue),wi=null),vt>1&&console.timeEnd("clipping"),Ne.push(nn||[],Q+1,2*ve,2*Oe),Ne.push(xr||[],Q+1,2*ve,2*Oe+1),Ne.push(Or||[],Q+1,2*ve+1,2*Oe),Ne.push(sn||[],Q+1,2*ve+1,2*Oe+1)}}},ze.prototype.getTile=function(te,Q,ve){var Oe=this.options,Xe=Oe.extent,ft=Oe.debug;if(te<0||te>24)return null;var Et=1<<te,Ne=xt(te,Q=(Q%Et+Et)%Et,ve);if(this.tiles[Ne])return it(this.tiles[Ne],Xe);ft>1&&console.log("drilling down to z%d-%d-%d",te,Q,ve);for(var Ue,vt=te,ue=Q,Lr=ve;!Ue&&vt>0;)vt--,ue=Math.floor(ue/2),Lr=Math.floor(Lr/2),Ue=this.tiles[xt(vt,ue,Lr)];return Ue&&Ue.source?(ft>1&&console.log("found parent tile z%d-%d-%d",vt,ue,Lr),ft>1&&console.time("drilling down"),this.splitTile(Ue.source,vt,ue,Lr,te,Q,ve),ft>1&&console.timeEnd("drilling down"),this.tiles[Ne]?it(this.tiles[Ne],Xe):null):null};var ir=function(te){function Q(ve,Oe,Xe,ft){te.call(this,ve,Oe,Xe,Ut),ft&&(this.loadGeoJSON=ft)}return te&&(Q.__proto__=te),(Q.prototype=Object.create(te&&te.prototype)).constructor=Q,Q.prototype.loadData=function(ve,Oe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Oe,this._pendingLoadDataParams=ve,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Q.prototype._loadData=function(){var ve=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Oe=this._pendingCallback,Xe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ft=!!(Xe&&Xe.request&&Xe.request.collectResourceTiming)&&new h.RequestPerformance(Xe.request);this.loadGeoJSON(Xe,function(Et,Ne){if(Et||!Ne)return Oe(Et);if(typeof Ne!="object")return Oe(new Error("Input data given to '"+Xe.source+"' is not a valid GeoJSON object."));(function lr($r,Rn){var nn,xr=$r&&$r.type;if(xr==="FeatureCollection")for(nn=0;nn<$r.features.length;nn++)lr($r.features[nn],Rn);else if(xr==="GeometryCollection")for(nn=0;nn<$r.geometries.length;nn++)lr($r.geometries[nn],Rn);else if(xr==="Feature")lr($r.geometry,Rn);else if(xr==="Polygon")q($r.coordinates,Rn);else if(xr==="MultiPolygon")for(nn=0;nn<$r.coordinates.length;nn++)q($r.coordinates[nn],Rn);return $r})(Ne,!0);try{if(Xe.filter){var Ue=h.createExpression(Xe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ue.result==="error")throw new Error(Ue.value.map(function(lr){return lr.key+": "+lr.message}).join(", "));var vt=Ne.features.filter(function(lr){return Ue.value.evaluate({zoom:0},lr)});Ne={type:"FeatureCollection",features:vt}}ve._geoJSONIndex=Xe.cluster?new qt(function(lr){var $r=lr.superclusterOptions,Rn=lr.clusterProperties;if(!Rn||!$r)return $r;for(var nn={},xr={},Or={accumulated:null,zoom:0},sn={properties:null},xn=Object.keys(Rn),wi=0,Nn=xn;wi<Nn.length;wi+=1){var Bi=Nn[wi],sa=Rn[Bi],Fi=sa[0],bn=h.createExpression(sa[1]),ei=h.createExpression(typeof Fi=="string"?[Fi,["accumulated"],["get",Bi]]:Fi);nn[Bi]=bn.value,xr[Bi]=ei.value}return $r.map=function(ga){sn.properties=ga;for(var ua={},no=0,ia=xn;no<ia.length;no+=1){var zi=ia[no];ua[zi]=nn[zi].evaluate(Or,sn)}return ua},$r.reduce=function(ga,ua){sn.properties=ua;for(var no=0,ia=xn;no<ia.length;no+=1){var zi=ia[no];Or.accumulated=ga[zi],ga[zi]=xr[zi].evaluate(Or,sn)}},$r}(Xe)).load(Ne.features):function(lr,$r){return new ze(lr,$r)}(Ne,Xe.geojsonVtOptions)}catch(lr){return Oe(lr)}ve.loaded={};var ue={};if(ft){var Lr=ft.finish();Lr&&(ue.resourceTiming={},ue.resourceTiming[Xe.source]=JSON.parse(JSON.stringify(Lr)))}Oe(null,ue)})}},Q.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Q.prototype.reloadTile=function(ve,Oe){var Xe=this.loaded;return Xe&&Xe[ve.uid]?te.prototype.reloadTile.call(this,ve,Oe):this.loadTile(ve,Oe)},Q.prototype.loadGeoJSON=function(ve,Oe){if(ve.request)h.getJSON(ve.request,Oe);else{if(typeof ve.data!="string")return Oe(new Error("Input data given to '"+ve.source+"' is not a valid GeoJSON object."));try{return Oe(null,JSON.parse(ve.data))}catch(Xe){return Oe(new Error("Input data given to '"+ve.source+"' is not a valid GeoJSON object."))}}},Q.prototype.removeSource=function(ve,Oe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Oe()},Q.prototype.getClusterExpansionZoom=function(ve,Oe){try{Oe(null,this._geoJSONIndex.getClusterExpansionZoom(ve.clusterId))}catch(Xe){Oe(Xe)}},Q.prototype.getClusterChildren=function(ve,Oe){try{Oe(null,this._geoJSONIndex.getChildren(ve.clusterId))}catch(Xe){Oe(Xe)}},Q.prototype.getClusterLeaves=function(ve,Oe){try{Oe(null,this._geoJSONIndex.getLeaves(ve.clusterId,ve.limit,ve.offset))}catch(Xe){Oe(Xe)}},Q}(B),Ft=function(te){var Q=this;this.self=te,this.actor=new h.Actor(te,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:B,geojson:ir},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ve,Oe){if(Q.workerSourceTypes[ve])throw new Error('Worker source with name "'+ve+'" already registered.');Q.workerSourceTypes[ve]=Oe},this.self.registerRTLTextPlugin=function(ve){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=ve.applyArabicShaping,h.plugin.processBidirectionalText=ve.processBidirectionalText,h.plugin.processStyledBidirectionalText=ve.processStyledBidirectionalText}};return Ft.prototype.setReferrer=function(te,Q){this.referrer=Q},Ft.prototype.setImages=function(te,Q,ve){for(var Oe in this.availableImages[te]=Q,this.workerSources[te]){var Xe=this.workerSources[te][Oe];for(var ft in Xe)Xe[ft].availableImages=Q}ve()},Ft.prototype.setLayers=function(te,Q,ve){this.getLayerIndex(te).replace(Q),ve()},Ft.prototype.updateLayers=function(te,Q,ve){this.getLayerIndex(te).update(Q.layers,Q.removedIds),ve()},Ft.prototype.loadTile=function(te,Q,ve){this.getWorkerSource(te,Q.type,Q.source).loadTile(Q,ve)},Ft.prototype.loadDEMTile=function(te,Q,ve){this.getDEMWorkerSource(te,Q.source).loadTile(Q,ve)},Ft.prototype.reloadTile=function(te,Q,ve){this.getWorkerSource(te,Q.type,Q.source).reloadTile(Q,ve)},Ft.prototype.abortTile=function(te,Q,ve){this.getWorkerSource(te,Q.type,Q.source).abortTile(Q,ve)},Ft.prototype.removeTile=function(te,Q,ve){this.getWorkerSource(te,Q.type,Q.source).removeTile(Q,ve)},Ft.prototype.removeDEMTile=function(te,Q){this.getDEMWorkerSource(te,Q.source).removeTile(Q)},Ft.prototype.removeSource=function(te,Q,ve){if(this.workerSources[te]&&this.workerSources[te][Q.type]&&this.workerSources[te][Q.type][Q.source]){var Oe=this.workerSources[te][Q.type][Q.source];delete this.workerSources[te][Q.type][Q.source],Oe.removeSource!==void 0?Oe.removeSource(Q,ve):ve()}},Ft.prototype.loadWorkerSource=function(te,Q,ve){try{this.self.importScripts(Q.url),ve()}catch(Oe){ve(Oe.toString())}},Ft.prototype.syncRTLPluginState=function(te,Q,ve){try{h.plugin.setState(Q);var Oe=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&Oe!=null){this.self.importScripts(Oe);var Xe=h.plugin.isParsed();ve(Xe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Oe),Xe)}}catch(ft){ve(ft.toString())}},Ft.prototype.getAvailableImages=function(te){var Q=this.availableImages[te];return Q||(Q=[]),Q},Ft.prototype.getLayerIndex=function(te){var Q=this.layerIndexes[te];return Q||(Q=this.layerIndexes[te]=new X),Q},Ft.prototype.getWorkerSource=function(te,Q,ve){var Oe=this;return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][Q]||(this.workerSources[te][Q]={}),this.workerSources[te][Q][ve]||(this.workerSources[te][Q][ve]=new this.workerSourceTypes[Q]({send:function(Xe,ft,Et){Oe.actor.send(Xe,ft,Et,te)}},this.getLayerIndex(te),this.getAvailableImages(te))),this.workerSources[te][Q][ve]},Ft.prototype.getDEMWorkerSource=function(te,Q){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][Q]||(this.demWorkerSources[te][Q]=new U),this.demWorkerSources[te][Q]},Ft.prototype.enforceCacheSizeLimit=function(te,Q){h.enforceCacheSizeLimit(Q)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Ft(self)),Ft}),z(["./shared"],function(h){"use strict";var D=h.createCommonjsModule(function(l){function p(E){return!f(E)}function f(E){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var O,$,ge=new Blob([""],{type:"text/javascript"}),Me=URL.createObjectURL(ge);try{$=new Worker(Me),O=!0}catch(Ye){O=!1}return $&&$.terminate(),URL.revokeObjectURL(Me),O}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var O=document.createElement("canvas");O.width=O.height=1;var $=O.getContext("2d");if(!$)return!1;var ge=$.getImageData(0,0,1,1);return ge&&ge.width===O.width}()?(m[R=E&&E.failIfMajorPerformanceCaveat]===void 0&&(m[R]=function(O){var $=function(Me){var Ye=document.createElement("canvas"),tt=Object.create(p.webGLContextAttributes);return tt.failIfMajorPerformanceCaveat=Me,Ye.probablySupportsContext?Ye.probablySupportsContext("webgl",tt)||Ye.probablySupportsContext("experimental-webgl",tt):Ye.supportsContext?Ye.supportsContext("webgl",tt)||Ye.supportsContext("experimental-webgl",tt):Ye.getContext("webgl",tt)||Ye.getContext("experimental-webgl",tt)}(O);if(!$)return!1;var ge=$.createShader($.VERTEX_SHADER);return!(!ge||$.isContextLost())&&($.shaderSource(ge,"void main() {}"),$.compileShader(ge),$.getShaderParameter(ge,$.COMPILE_STATUS)===!0)}(R)),m[R]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var R}l.exports?l.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=f);var m={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),P={create:function(l,p,f){var m=h.window.document.createElement(l);return p!==void 0&&(m.className=p),f&&f.appendChild(m),m},createNS:function(l,p){return h.window.document.createElementNS(l,p)}},X=h.window.document&&h.window.document.documentElement.style;function W(l){if(!X)return l[0];for(var p=0;p<l.length;p++)if(l[p]in X)return l[p];return l[0]}var fe,J=W(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);P.disableDrag=function(){X&&J&&(fe=X[J],X[J]="none")},P.enableDrag=function(){X&&J&&(X[J]=fe)};var Be=W(["transform","WebkitTransform"]);P.setTransform=function(l,p){l.style[Be]=p};var B=!1;try{var ee=Object.defineProperty({},"passive",{get:function(){B=!0}});h.window.addEventListener("test",ee,ee),h.window.removeEventListener("test",ee,ee)}catch(l){B=!1}P.addEventListener=function(l,p,f,m){m===void 0&&(m={}),l.addEventListener(p,f,"passive"in m&&B?m:m.capture)},P.removeEventListener=function(l,p,f,m){m===void 0&&(m={}),l.removeEventListener(p,f,"passive"in m&&B?m:m.capture)};var U=function(l){l.preventDefault(),l.stopPropagation(),h.window.removeEventListener("click",U,!0)};function q(l){var p=l.userImage;return!!(p&&p.render&&p.render())&&(l.data.replace(new Uint8Array(p.data.buffer)),!0)}P.suppressClick=function(){h.window.addEventListener("click",U,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",U,!0)},0)},P.mousePos=function(l,p){var f=l.getBoundingClientRect();return new h.Point(p.clientX-f.left-l.clientLeft,p.clientY-f.top-l.clientTop)},P.touchPos=function(l,p){for(var f=l.getBoundingClientRect(),m=[],E=0;E<p.length;E++)m.push(new h.Point(p[E].clientX-f.left-l.clientLeft,p[E].clientY-f.top-l.clientTop));return m},P.mouseButton=function(l){return h.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},P.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var le=function(l){function p(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(f){if(this.loaded!==f&&(this.loaded=f,f)){for(var m=0,E=this.requestors;m<E.length;m+=1){var R=E[m];this._notify(R.ids,R.callback)}this.requestors=[]}},p.prototype.getImage=function(f){return this.images[f]},p.prototype.addImage=function(f,m){this._validate(f,m)&&(this.images[f]=m)},p.prototype._validate=function(f,m){var E=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "stretchY" value'))),E=!1),this._validateContent(m.content,m)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "content" value'))),E=!1),E},p.prototype._validateStretch=function(f,m){if(!f)return!0;for(var E=0,R=0,O=f;R<O.length;R+=1){var $=O[R];if($[0]<E||$[1]<$[0]||m<$[1])return!1;E=$[1]}return!0},p.prototype._validateContent=function(f,m){return!(f&&(f.length!==4||f[0]<0||m.data.width<f[0]||f[1]<0||m.data.height<f[1]||f[2]<0||m.data.width<f[2]||f[3]<0||m.data.height<f[3]||f[2]<f[0]||f[3]<f[1]))},p.prototype.updateImage=function(f,m){m.version=this.images[f].version+1,this.images[f]=m,this.updatedImages[f]=!0},p.prototype.removeImage=function(f){var m=this.images[f];delete this.images[f],delete this.patterns[f],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(f,m){var E=!0;if(!this.isLoaded())for(var R=0,O=f;R<O.length;R+=1)this.images[O[R]]||(E=!1);this.isLoaded()||E?this._notify(f,m):this.requestors.push({ids:f,callback:m})},p.prototype._notify=function(f,m){for(var E={},R=0,O=f;R<O.length;R+=1){var $=O[R];this.images[$]||this.fire(new h.Event("styleimagemissing",{id:$}));var ge=this.images[$];ge?E[$]={data:ge.data.clone(),pixelRatio:ge.pixelRatio,sdf:ge.sdf,version:ge.version,stretchX:ge.stretchX,stretchY:ge.stretchY,content:ge.content,hasRenderCallback:!!(ge.userImage&&ge.userImage.render)}:h.warnOnce('Image "'+$+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,E)},p.prototype.getPixelSize=function(){var f=this.atlasImage;return{width:f.width,height:f.height}},p.prototype.getPattern=function(f){var m=this.patterns[f],E=this.getImage(f);if(!E)return null;if(m&&m.position.version===E.version)return m.position;if(m)m.position.version=E.version;else{var R={w:E.data.width+2,h:E.data.height+2,x:0,y:0},O=new h.ImagePosition(R,E);this.patterns[f]={bin:R,position:O}}return this._updatePatternAtlas(),this.patterns[f].position},p.prototype.bind=function(f){var m=f.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(f,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var f=[];for(var m in this.patterns)f.push(this.patterns[m].bin);var E=h.potpack(f),R=E.w,O=E.h,$=this.atlasImage;for(var ge in $.resize({width:R||1,height:O||1}),this.patterns){var Me=this.patterns[ge].bin,Ye=Me.x+1,tt=Me.y+1,ot=this.images[ge].data,At=ot.width,St=ot.height;h.RGBAImage.copy(ot,$,{x:0,y:0},{x:Ye,y:tt},{width:At,height:St}),h.RGBAImage.copy(ot,$,{x:0,y:St-1},{x:Ye,y:tt-1},{width:At,height:1}),h.RGBAImage.copy(ot,$,{x:0,y:0},{x:Ye,y:tt+St},{width:At,height:1}),h.RGBAImage.copy(ot,$,{x:At-1,y:0},{x:Ye-1,y:tt},{width:1,height:St}),h.RGBAImage.copy(ot,$,{x:0,y:0},{x:Ye+At,y:tt},{width:1,height:St})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(f){for(var m=0,E=f;m<E.length;m+=1){var R=E[m];if(!this.callbackDispatchedThisFrame[R]){this.callbackDispatchedThisFrame[R]=!0;var O=this.images[R];q(O)&&this.updateImage(R,O)}}},p}(h.Evented),j=Fe,Ce=Fe,$e=1e20;function Fe(l,p,f,m,E,R){this.fontSize=l||24,this.buffer=p===void 0?3:p,this.cutoff=m||.25,this.fontFamily=E||"sans-serif",this.fontWeight=R||"normal",this.radius=f||8;var O=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=O,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.d=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Int16Array(O),this.middle=Math.round(O/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function lt(l,p,f,m,E,R,O){for(var $=0;$<p;$++){for(var ge=0;ge<f;ge++)m[ge]=l[ge*p+$];for(We(m,E,R,O,f),ge=0;ge<f;ge++)l[ge*p+$]=E[ge]}for(ge=0;ge<f;ge++){for($=0;$<p;$++)m[$]=l[ge*p+$];for(We(m,E,R,O,p),$=0;$<p;$++)l[ge*p+$]=Math.sqrt(E[$])}}function We(l,p,f,m,E){f[0]=0,m[0]=-$e,m[1]=+$e;for(var R=1,O=0;R<E;R++){for(var $=(l[R]+R*R-(l[f[O]]+f[O]*f[O]))/(2*R-2*f[O]);$<=m[O];)O--,$=(l[R]+R*R-(l[f[O]]+f[O]*f[O]))/(2*R-2*f[O]);f[++O]=R,m[O]=$,m[O+1]=+$e}for(R=0,O=0;R<E;R++){for(;m[O+1]<R;)O++;p[R]=(R-f[O])*(R-f[O])+l[f[O]]}}Fe.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),f=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var E=p.data[4*m+3]/255;this.gridOuter[m]=E===1?0:E===0?$e:Math.pow(Math.max(0,.5-E),2),this.gridInner[m]=E===1?$e:E===0?0:Math.pow(Math.max(0,E-.5),2)}for(lt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),lt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)f[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return f},j.default=Ce;var Ze=function(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}};Ze.prototype.setURL=function(l){this.url=l},Ze.prototype.getGlyphs=function(l,p){var f=this,m=[];for(var E in l)for(var R=0,O=l[E];R<O.length;R+=1)m.push({stack:E,id:O[R]});h.asyncAll(m,function($,ge){var Me=$.stack,Ye=$.id,tt=f.entries[Me];tt||(tt=f.entries[Me]={glyphs:{},requests:{},ranges:{}});var ot=tt.glyphs[Ye];if(ot===void 0){if(ot=f._tinySDF(tt,Me,Ye))return tt.glyphs[Ye]=ot,void ge(null,{stack:Me,id:Ye,glyph:ot});var At=Math.floor(Ye/256);if(256*At>65535)ge(new Error("glyphs > 65535 not supported"));else if(tt.ranges[At])ge(null,{stack:Me,id:Ye,glyph:ot});else{var St=tt.requests[At];St||(St=tt.requests[At]=[],Ze.loadGlyphRange(Me,At,f.url,f.requestManager,function(Zt,_t){if(_t){for(var Vt in _t)f._doesCharSupportLocalGlyph(+Vt)||(tt.glyphs[+Vt]=_t[+Vt]);tt.ranges[At]=!0}for(var er=0,cr=St;er<cr.length;er+=1)(0,cr[er])(Zt,_t);delete tt.requests[At]})),St.push(function(Zt,_t){Zt?ge(Zt):_t&&ge(null,{stack:Me,id:Ye,glyph:_t[Ye]||null})})}}else ge(null,{stack:Me,id:Ye,glyph:ot})},function($,ge){if($)p($);else if(ge){for(var Me={},Ye=0,tt=ge;Ye<tt.length;Ye+=1){var ot=tt[Ye],At=ot.stack,St=ot.id,Zt=ot.glyph;(Me[At]||(Me[At]={}))[St]=Zt&&{id:Zt.id,bitmap:Zt.bitmap.clone(),metrics:Zt.metrics}}p(null,Me)}})},Ze.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](l)||h.isChar["Hangul Syllables"](l)||h.isChar.Hiragana(l)||h.isChar.Katakana(l))},Ze.prototype._tinySDF=function(l,p,f){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(f)){var E=l.tinySDF;if(!E){var R="400";/bold/i.test(p)?R="900":/medium/i.test(p)?R="500":/light/i.test(p)&&(R="200"),E=l.tinySDF=new Ze.TinySDF(24,3,8,.25,m,R)}return{id:f,bitmap:new h.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(f))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ze.loadGlyphRange=function(l,p,f,m,E){var R=256*p,O=R+255,$=m.transformRequest(m.normalizeGlyphsURL(f).replace("{fontstack}",l).replace("{range}",R+"-"+O),h.ResourceType.Glyphs);h.getArrayBuffer($,function(ge,Me){if(ge)E(ge);else if(Me){for(var Ye={},tt=0,ot=h.parseGlyphPBF(Me);tt<ot.length;tt+=1){var At=ot[tt];Ye[At.id]=At}E(null,Ye)}})},Ze.TinySDF=j;var pe=function(){this.specification=h.styleSpec.light.position};pe.prototype.possiblyEvaluate=function(l,p){return h.sphericalToCartesian(l.expression.evaluate(p))},pe.prototype.interpolate=function(l,p,f){return{x:h.number(l.x,p.x,f),y:h.number(l.y,p.y,f),z:h.number(l.z,p.z,f)}};var se=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new pe,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),be=function(l){function p(f){l.call(this),this._transitionable=new h.Transitionable(se),this.setLight(f),this._transitioning=this._transitionable.untransitioned()}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(f,m){if(m===void 0&&(m={}),!this._validate(h.validateLight,f,m))for(var E in f){var R=f[E];h.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-11),R):this._transitionable.setValue(E,R)}},p.prototype.updateTransitions=function(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(f){this.properties=this._transitioning.possiblyEvaluate(f)},p.prototype._validate=function(f,m,E){return(!E||E.validate!==!1)&&h.emitValidationErrors(this,f.call(h.validateStyle,h.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},p}(h.Evented),Te=function(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Te.prototype.getDash=function(l,p){var f=l.join(",")+String(p);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(l,p)),this.dashEntry[f]},Te.prototype.getDashRanges=function(l,p,f){var m=[],E=l.length%2==1?-l[l.length-1]*f:0,R=l[0]*f,O=!0;m.push({left:E,right:R,isDash:O,zeroLength:l[0]===0});for(var $=l[0],ge=1;ge<l.length;ge++){var Me=l[ge];m.push({left:E=$*f,right:R=($+=Me)*f,isDash:O=!O,zeroLength:Me===0})}return m},Te.prototype.addRoundDash=function(l,p,f){for(var m=p/2,E=-f;E<=f;E++)for(var R=this.width*(this.nextRow+f+E),O=0,$=l[O],ge=0;ge<this.width;ge++){ge/$.right>1&&($=l[++O]);var Me=Math.abs(ge-$.left),Ye=Math.abs(ge-$.right),tt=Math.min(Me,Ye),ot=void 0,At=E/f*(m+1);if($.isDash){var St=m-Math.abs(At);ot=Math.sqrt(tt*tt+St*St)}else ot=m-Math.sqrt(tt*tt+At*At);this.data[R+ge]=Math.max(0,Math.min(255,ot+128))}},Te.prototype.addRegularDash=function(l){for(var p=l.length-1;p>=0;--p){var f=l[p],m=l[p+1];f.zeroLength?l.splice(p,1):m&&m.isDash===f.isDash&&(m.left=f.left,l.splice(p,1))}var E=l[0],R=l[l.length-1];E.isDash===R.isDash&&(E.left=R.left-this.width,R.right=E.right+this.width);for(var O=this.width*this.nextRow,$=0,ge=l[$],Me=0;Me<this.width;Me++){Me/ge.right>1&&(ge=l[++$]);var Ye=Math.abs(Me-ge.left),tt=Math.abs(Me-ge.right),ot=Math.min(Ye,tt);this.data[O+Me]=Math.max(0,Math.min(255,(ge.isDash?ot:-ot)+128))}},Te.prototype.addDash=function(l,p){var f=p?7:0,m=2*f+1;if(this.nextRow+m>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var E=0,R=0;R<l.length;R++)E+=l[R];if(E!==0){var O=this.width/E,$=this.getDashRanges(l,this.width,O);p?this.addRoundDash($,O,f):this.addRegularDash($)}var ge={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:E};return this.nextRow+=m,this.dirty=!0,ge},Te.prototype.bind=function(l){var p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var de=function l(p,f){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var m=this.workerPool.acquire(this.id),E=0;E<m.length;E++){var R=new l.Actor(m[E],f,this.id);R.name="Worker "+E,this.actors.push(R)}};function Rt(l,p,f){var m=function(E,R){if(E)return f(E);if(R){var O=h.pick(h.extend(R,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(O.vectorLayers=R.vector_layers,O.vectorLayerIds=O.vectorLayers.map(function($){return $.id})),O.tiles=p.canonicalizeTileset(O,l.url),f(null,O)}};return l.url?h.getJSON(p.transformRequest(p.normalizeSourceURL(l.url),h.ResourceType.Source),m):h.browser.frame(function(){return m(null,l)})}de.prototype.broadcast=function(l,p,f){h.asyncAll(this.actors,function(m,E){m.send(l,p,E)},f=f||function(){})},de.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},de.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},de.Actor=h.Actor;var ye=function(l,p,f){this.bounds=h.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=f||24};ye.prototype.validateBounds=function(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},ye.prototype.contains=function(l){var p=Math.pow(2,l.z),f=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*p),m=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*p),E=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*p),R=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*p);return l.x>=f&&l.x<E&&l.y>=m&&l.y<R};var Ve=function(l){function p(f,m,E,R){if(l.call(this),this.id=f,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(m,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(R)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var f=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,function(m,E){f._tileJSONRequest=null,f._loaded=!0,m?f.fire(new h.ErrorEvent(m)):E&&(h.extend(f,E),E.bounds&&(f.tileBounds=new ye(E.bounds,f.minzoom,f.maxzoom)),h.postTurnstileEvent(E.tiles,f.map._requestManager._customAccessToken),h.postMapLoadEvent(E.tiles,f.map._getMapId(),f.map._requestManager._skuToken,f.map._requestManager._customAccessToken),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)},p.prototype.onAdd=function(f){this.map=f,this.load()},p.prototype.setSourceProperty=function(f){this._tileJSONRequest&&this._tileJSONRequest.cancel(),f(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(f){var m=this;return this.setSourceProperty(function(){m._options.tiles=f}),this},p.prototype.setUrl=function(f){var m=this;return this.setSourceProperty(function(){m.url=f,m._options.url=f}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return h.extend({},this._options)},p.prototype.loadTile=function(f,m){var E=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),R={request:this.map._requestManager.transformRequest(E,h.ResourceType.Tile),uid:f.uid,tileID:f.tileID,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function O($,ge){return delete f.request,f.aborted?m(null):$&&$.status!==404?m($):(ge&&ge.resourceTiming&&(f.resourceTiming=ge.resourceTiming),this.map._refreshExpiredTiles&&ge&&f.setExpiryData(ge),f.loadVectorData(ge,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}R.request.collectResourceTiming=this._collectResourceTiming,f.actor&&f.state!=="expired"?f.state==="loading"?f.reloadCallback=m:f.request=f.actor.send("reloadTile",R,O.bind(this)):(f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",R,O.bind(this)))},p.prototype.abortTile=function(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(h.Evented),oe=function(l){function p(f,m,E,R){l.call(this),this.id=f,this.dispatcher=E,this.setEventedParent(R),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},m),h.extend(this,h.pick(m,["url","scheme","tileSize"]))}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var f=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,function(m,E){f._tileJSONRequest=null,f._loaded=!0,m?f.fire(new h.ErrorEvent(m)):E&&(h.extend(f,E),E.bounds&&(f.tileBounds=new ye(E.bounds,f.minzoom,f.maxzoom)),h.postTurnstileEvent(E.tiles),h.postMapLoadEvent(E.tiles,f.map._getMapId(),f.map._requestManager._skuToken),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(f){this.map=f,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return h.extend({},this._options)},p.prototype.hasTile=function(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)},p.prototype.loadTile=function(f,m){var E=this,R=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);f.request=h.getImage(this.map._requestManager.transformRequest(R,h.ResourceType.Tile),function(O,$){if(delete f.request,f.aborted)f.state="unloaded",m(null);else if(O)f.state="errored",m(O);else if($){E.map._refreshExpiredTiles&&f.setExpiryData($),delete $.cacheControl,delete $.expires;var ge=E.map.painter.context,Me=ge.gl;f.texture=E.map.painter.getTileTexture($.width),f.texture?f.texture.update($,{useMipmap:!0}):(f.texture=new h.Texture(ge,$,Me.RGBA,{useMipmap:!0}),f.texture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),ge.extTextureFilterAnisotropic&&Me.texParameterf(Me.TEXTURE_2D,ge.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ge.extTextureFilterAnisotropicMax)),f.state="loaded",h.cacheEntryPossiblyAdded(E.dispatcher),m(null)}})},p.prototype.abortTile=function(f,m){f.request&&(f.request.cancel(),delete f.request),m()},p.prototype.unloadTile=function(f,m){f.texture&&this.map.painter.saveTileTexture(f.texture),m()},p.prototype.hasTransition=function(){return!1},p}(h.Evented),Re=function(l){function p(f,m,E,R){l.call(this,f,m,E,R),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(f,m){var E=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function R(O,$){O&&(f.state="errored",m(O)),$&&(f.dem=$,f.needsHillshadePrepare=!0,f.state="loaded",m(null))}f.request=h.getImage(this.map._requestManager.transformRequest(E,h.ResourceType.Tile),function(O,$){if(delete f.request,f.aborted)f.state="unloaded",m(null);else if(O)f.state="errored",m(O);else if($){this.map._refreshExpiredTiles&&f.setExpiryData($),delete $.cacheControl,delete $.expires;var ge=h.window.ImageBitmap&&$ instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?$:h.browser.getImageData($,1),Me={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:ge,encoding:this.encoding};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Me,R.bind(this)))}}.bind(this)),f.neighboringTiles=this._getNeighboringTiles(f.tileID)},p.prototype._getNeighboringTiles=function(f){var m=f.canonical,E=Math.pow(2,m.z),R=(m.x-1+E)%E,O=m.x===0?f.wrap-1:f.wrap,$=(m.x+1+E)%E,ge=m.x+1===E?f.wrap+1:f.wrap,Me={};return Me[new h.OverscaledTileID(f.overscaledZ,O,m.z,R,m.y).key]={backfilled:!1},Me[new h.OverscaledTileID(f.overscaledZ,ge,m.z,$,m.y).key]={backfilled:!1},m.y>0&&(Me[new h.OverscaledTileID(f.overscaledZ,O,m.z,R,m.y-1).key]={backfilled:!1},Me[new h.OverscaledTileID(f.overscaledZ,f.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},Me[new h.OverscaledTileID(f.overscaledZ,ge,m.z,$,m.y-1).key]={backfilled:!1}),m.y+1<E&&(Me[new h.OverscaledTileID(f.overscaledZ,O,m.z,R,m.y+1).key]={backfilled:!1},Me[new h.OverscaledTileID(f.overscaledZ,f.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},Me[new h.OverscaledTileID(f.overscaledZ,ge,m.z,$,m.y+1).key]={backfilled:!1}),Me},p.prototype.unloadTile=function(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded",f.actor&&f.actor.send("removeDEMTile",{uid:f.uid,source:this.id})},p}(oe),Se=function(l){function p(f,m,E,R){l.call(this),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(R),this._data=m.data,this._options=h.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var O=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*O,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*O,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:h.EXTENT,radius:(m.clusterRadius||50)*O,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var f=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)f.fire(new h.ErrorEvent(m));else{var E={dataType:"source",sourceDataType:"metadata"};f._collectResourceTiming&&f._resourceTiming&&f._resourceTiming.length>0&&(E.resourceTiming=f._resourceTiming,f._resourceTiming=[]),f.fire(new h.Event("data",E))}})},p.prototype.onAdd=function(f){this.map=f,this.load()},p.prototype.setData=function(f){var m=this;return this._data=f,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)m.fire(new h.ErrorEvent(E));else{var R={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(R.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new h.Event("data",R))}}),this},p.prototype.getClusterExpansionZoom=function(f,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},m),this},p.prototype.getClusterChildren=function(f,m){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},m),this},p.prototype.getClusterLeaves=function(f,m,E,R){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:m,offset:E},R),this},p.prototype._updateWorkerData=function(f){var m=this;this._loaded=!1;var E=h.extend({},this.workerOptions),R=this._data;typeof R=="string"?(E.request=this.map._requestManager.transformRequest(h.browser.resolveURL(R),h.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(R),this.actor.send(this.type+".loadData",E,function(O,$){m._removed||$&&$.abandoned||(m._loaded=!0,$&&$.resourceTiming&&$.resourceTiming[m.id]&&(m._resourceTiming=$.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:E.source},null),f(O))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(f,m){var E=this,R=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(R,{type:this.type,uid:f.uid,tileID:f.tileID,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(O,$){return delete f.request,f.unloadVectorData(),f.aborted?m(null):O?m(O):(f.loadVectorData($,E.map.painter,R==="reloadTile"),m(null))})},p.prototype.abortTile=function(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0},p.prototype.unloadTile=function(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(h.Evented),et=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),st=function(l){function p(f,m,E,R){l.call(this),this.id=f,this.dispatcher=E,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(R),this.options=m}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(f,m){var E=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(R,O){E._loaded=!0,R?E.fire(new h.ErrorEvent(R)):O&&(E.image=O,f&&(E.coordinates=f),m&&m(),E._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(f){var m=this;return this.image&&f.url?(this.options.url=f.url,this.load(f.coordinates,function(){m.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(f){this.map=f,this.load()},p.prototype.setCoordinates=function(f){var m=this;this.coordinates=f;var E=f.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(O){for(var $=1/0,ge=1/0,Me=-1/0,Ye=-1/0,tt=0,ot=O;tt<ot.length;tt+=1){var At=ot[tt];$=Math.min($,At.x),ge=Math.min(ge,At.y),Me=Math.max(Me,At.x),Ye=Math.max(Ye,At.y)}var St=Math.max(Me-$,Ye-ge),Zt=Math.max(0,Math.floor(-Math.log(St)/Math.LN2)),_t=Math.pow(2,Zt);return new h.CanonicalTileID(Zt,Math.floor(($+Me)/2*_t),Math.floor((ge+Ye)/2*_t))}(E),this.minzoom=this.maxzoom=this.tileID.z;var R=E.map(function(O){return m.tileID.getTilePoint(O)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(R[0].x,R[0].y,0,0),this._boundsArray.emplaceBack(R[1].x,R[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(R[3].x,R[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(R[2].x,R[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var f=this.map.painter.context,m=f.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(f,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var R=this.tiles[E];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},p.prototype.loadTile=function(f,m){this.tileID&&this.tileID.equals(f.tileID.canonical)?(this.tiles[String(f.tileID.wrap)]=f,f.buckets={},m(null)):(f.state="errored",m(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(h.Evented),pt=function(l){function p(f,m,E,R){l.call(this,f,m,E,R),this.roundZoom=!0,this.type="video",this.options=m}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var f=this;this._loaded=!1;var m=this.options;this.urls=[];for(var E=0,R=m.urls;E<R.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(R[E],h.ResourceType.Source).url);h.getVideo(this.urls,function(O,$){f._loaded=!0,O?f.fire(new h.ErrorEvent(O)):$&&(f.video=$,f.video.loop=!0,f.video.setAttribute("playsinline",""),f.video.addEventListener("playing",function(){f.map.triggerRepaint()}),f.map&&f.video.play(),f._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(f){if(this.video){var m=this.video.seekable;f<m.start(0)||f>m.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=f}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var f=this.map.painter.context,m=f.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(f,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var R=this.tiles[E];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(st),bt=function(l){function p(f,m,E,R){l.call(this,f,m,E,R),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(function(O){return!Array.isArray(O)||O.length!==2||O.some(function($){return typeof $!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var m=this.map.painter.context,E=m.gl;for(var R in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(m,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var O=this.tiles[R];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var f=0,m=[this.canvas.width,this.canvas.height];f<m.length;f+=1){var E=m[f];if(isNaN(E)||E<=0)return!0}return!1},p}(st),ke={vector:Ve,raster:oe,"raster-dem":Re,geojson:Se,video:pt,image:st,canvas:bt};function ur(l,p){var f=h.identity([]);return h.translate(f,f,[1,1,0]),h.scale(f,f,[.5*l.width,.5*l.height,1]),h.multiply(f,f,l.calculatePosMatrix(p.toUnwrapped()))}function qt(l,p,f,m,E,R){var O=function(Zt,_t,Vt){if(Zt)for(var er=0,cr=Zt;er<cr.length;er+=1){var Rr=_t[cr[er]];if(Rr&&Rr.source===Vt&&Rr.type==="fill-extrusion")return!0}else for(var Er in _t){var Br=_t[Er];if(Br.source===Vt&&Br.type==="fill-extrusion")return!0}return!1}(E&&E.layers,p,l.id),$=R.maxPitchScaleFactor(),ge=l.tilesIn(m,$,O);ge.sort(_n);for(var Me=[],Ye=0,tt=ge;Ye<tt.length;Ye+=1){var ot=tt[Ye];Me.push({wrappedTileID:ot.tileID.wrapped().key,queryResults:ot.tile.queryRenderedFeatures(p,f,l._state,ot.queryGeometry,ot.cameraQueryGeometry,ot.scale,E,R,$,ur(l.transform,ot.tileID))})}var At=function(Zt){for(var _t={},Vt={},er=0,cr=Zt;er<cr.length;er+=1){var Rr=cr[er],Er=Rr.queryResults,Br=Rr.wrappedTileID,tn=Vt[Br]=Vt[Br]||{};for(var M in Er)for(var k=Er[M],L=tn[M]=tn[M]||{},K=_t[M]=_t[M]||[],ie=0,ne=k;ie<ne.length;ie+=1){var nt=ne[ie];L[nt.featureIndex]||(L[nt.featureIndex]=!0,K.push(nt))}}return _t}(Me);for(var St in At)At[St].forEach(function(Zt){var _t=Zt.feature,Vt=l.getFeatureState(_t.layer["source-layer"],_t.id);_t.source=_t.layer.source,_t.layer["source-layer"]&&(_t.sourceLayer=_t.layer["source-layer"]),_t.state=Vt});return At}function _n(l,p){var f=l.tileID,m=p.tileID;return f.overscaledZ-m.overscaledZ||f.canonical.y-m.canonical.y||f.wrap-m.wrap||f.canonical.x-m.canonical.x}var Zr=function(l,p){this.max=l,this.onRemove=p,this.reset()};Zr.prototype.reset=function(){for(var l in this.data)for(var p=0,f=this.data[l];p<f.length;p+=1){var m=f[p];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},Zr.prototype.add=function(l,p,f){var m=this,E=l.wrapped().key;this.data[E]===void 0&&(this.data[E]=[]);var R={value:p,timeout:void 0};if(f!==void 0&&(R.timeout=setTimeout(function(){m.remove(l,R)},f)),this.data[E].push(R),this.order.push(E),this.order.length>this.max){var O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this},Zr.prototype.has=function(l){return l.wrapped().key in this.data},Zr.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},Zr.prototype._getAndRemoveByKey=function(l){var p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value},Zr.prototype.getByKey=function(l){var p=this.data[l];return p?p[0].value:null},Zr.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},Zr.prototype.remove=function(l,p){if(!this.has(l))return this;var f=l.wrapped().key,m=p===void 0?0:this.data[f].indexOf(p),E=this.data[f][m];return this.data[f].splice(m,1),E.timeout&&clearTimeout(E.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(E.value),this.order.splice(this.order.indexOf(f),1),this},Zr.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},Zr.prototype.filter=function(l){var p=[];for(var f in this.data)for(var m=0,E=this.data[f];m<E.length;m+=1){var R=E[m];l(R.value)||p.push(R)}for(var O=0,$=p;O<$.length;O+=1){var ge=$[O];this.remove(ge.value.tileID,ge)}};var Vr=function(l,p,f){this.context=l;var m=l.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Vr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Vr.prototype.updateData=function(l){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},Vr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Qr=function(l,p,f,m){this.length=p.length,this.attributes=f,this.itemSize=p.bytesPerElement,this.dynamicDraw=m,this.context=l;var E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Qr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Qr.prototype.updateData=function(l){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)},Qr.prototype.enableAttributes=function(l,p){for(var f=0;f<this.attributes.length;f++){var m=p.attributes[this.attributes[f].name];m!==void 0&&l.enableVertexAttribArray(m)}},Qr.prototype.setVertexAttribPointers=function(l,p,f){for(var m=0;m<this.attributes.length;m++){var E=this.attributes[m],R=p.attributes[E.name];R!==void 0&&l.vertexAttribPointer(R,E.components,l[rn[E.type]],!1,this.itemSize,E.offset+this.itemSize*(f||0))}},Qr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ln=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ln.prototype.get=function(){return this.current},ln.prototype.set=function(l){},ln.prototype.getDefault=function(){return this.default},ln.prototype.setDefault=function(){this.set(this.default)};var vn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return h.Color.transparent},p.prototype.set=function(f){var m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.clearColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)},p}(ln),$t=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.clearDepth(f),this.current=f,this.dirty=!1)},p}(ln),_r=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.clearStencil(f),this.current=f,this.dirty=!1)},p}(ln),kt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.colorMask(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)},p}(ln),qe=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.depthMask(f),this.current=f,this.dirty=!1)},p}(ln),Sr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.stencilMask(f),this.current=f,this.dirty=!1)},p}(ln),Pe=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(f){var m=this.current;(f.func!==m.func||f.ref!==m.ref||f.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(f.func,f.ref,f.mask),this.current=f,this.dirty=!1)},p}(ln),Hr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var f=this.gl;return[f.KEEP,f.KEEP,f.KEEP]},p.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(f[0],f[1],f[2]),this.current=f,this.dirty=!1)},p}(ln),vr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=f,this.dirty=!1}},p}(ln),Ie=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.depthRange(f[0],f[1]),this.current=f,this.dirty=!1)},p}(ln),gr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=f,this.dirty=!1}},p}(ln),Wr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.depthFunc(f),this.current=f,this.dirty=!1)},p}(ln),Dr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.BLEND):m.disable(m.BLEND),this.current=f,this.dirty=!1}},p}(ln),Xr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var f=this.gl;return[f.ONE,f.ZERO]},p.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(f[0],f[1]),this.current=f,this.dirty=!1)},p}(ln),Vn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return h.Color.transparent},p.prototype.set=function(f){var m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.blendColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)},p}(ln),ni=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.blendEquation(f),this.current=f,this.dirty=!1)},p}(ln),Dn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=f,this.dirty=!1}},p}(ln),Jn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.cullFace(f),this.current=f,this.dirty=!1)},p}(ln),Yi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.frontFace(f),this.current=f,this.dirty=!1)},p}(ln),bi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)},p}(ln),ui=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.activeTexture(f),this.current=f,this.dirty=!1)},p}(ln),pi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var f=this.gl;return[0,0,f.drawingBufferWidth,f.drawingBufferHeight]},p.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.viewport(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)},p}(ln),it=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,f),this.current=f,this.dirty=!1}},p}(ln),V=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,f),this.current=f,this.dirty=!1}},p}(ln),H=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,f),this.current=f,this.dirty=!1}},p}(ln),Ee=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,f),this.current=f,this.dirty=!1}},p}(ln),Le=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,f),this.current=f,this.dirty=!1},p}(ln),ze=function(l){function p(f){l.call(this,f),this.vao=f.extVertexArrayObject}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(f){this.vao&&(f!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(f),this.current=f,this.dirty=!1)},p}(ln),xt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,f),this.current=f,this.dirty=!1}},p}(ln),Ut=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),this.current=f,this.dirty=!1}},p}(ln),ir=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,f),this.current=f,this.dirty=!1}},p}(ln),Ft=function(l){function p(f,m){l.call(this,f),this.context=f,this.parent=m}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(ln),te=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(f){if(f!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}},p}(Ft),Q=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.set=function(f){if(f!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,f),this.current=f,this.dirty=!1}},p}(Ft),ve=function(l,p,f,m){this.context=l,this.width=p,this.height=f;var E=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new te(l,E),m&&(this.depthAttachment=new Q(l,E))};ve.prototype.destroy=function(){var l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){var f=this.depthAttachment.get();f&&l.deleteRenderbuffer(f)}l.deleteFramebuffer(this.framebuffer)};var Oe=function(l,p,f){this.func=l,this.mask=p,this.range=f};Oe.ReadOnly=!1,Oe.ReadWrite=!0,Oe.disabled=new Oe(519,Oe.ReadOnly,[0,1]);var Xe=function(l,p,f,m,E,R){this.test=l,this.ref=p,this.mask=f,this.fail=m,this.depthFail=E,this.pass=R};Xe.disabled=new Xe({func:519,mask:0},0,0,7680,7680,7680);var ft=function(l,p,f){this.blendFunction=l,this.blendColor=p,this.mask=f};ft.disabled=new ft(ft.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),ft.unblended=new ft(ft.Replace,h.Color.transparent,[!0,!0,!0,!0]),ft.alphaBlended=new ft([1,771],h.Color.transparent,[!0,!0,!0,!0]);var Et=function(l,p,f){this.enable=l,this.mode=p,this.frontFace=f};Et.disabled=new Et(!1,1029,2305),Et.backCCW=new Et(!0,1029,2305);var Ne=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new vn(this),this.clearDepth=new $t(this),this.clearStencil=new _r(this),this.colorMask=new kt(this),this.depthMask=new qe(this),this.stencilMask=new Sr(this),this.stencilFunc=new Pe(this),this.stencilOp=new Hr(this),this.stencilTest=new vr(this),this.depthRange=new Ie(this),this.depthTest=new gr(this),this.depthFunc=new Wr(this),this.blend=new Dr(this),this.blendFunc=new Xr(this),this.blendColor=new Vn(this),this.blendEquation=new ni(this),this.cullFace=new Dn(this),this.cullFaceSide=new Jn(this),this.frontFace=new Yi(this),this.program=new bi(this),this.activeTexture=new ui(this),this.viewport=new pi(this),this.bindFramebuffer=new it(this),this.bindRenderbuffer=new V(this),this.bindTexture=new H(this),this.bindVertexBuffer=new Ee(this),this.bindElementBuffer=new Le(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ze(this),this.pixelStoreUnpack=new xt(this),this.pixelStoreUnpackPremultiplyAlpha=new Ut(this),this.pixelStoreUnpackFlipY=new ir(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};Ne.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ne.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ne.prototype.createIndexBuffer=function(l,p){return new Vr(this,l,p)},Ne.prototype.createVertexBuffer=function(l,p,f){return new Qr(this,l,p,f)},Ne.prototype.createRenderbuffer=function(l,p,f){var m=this.gl,E=m.createRenderbuffer();return this.bindRenderbuffer.set(E),m.renderbufferStorage(m.RENDERBUFFER,l,p,f),this.bindRenderbuffer.set(null),E},Ne.prototype.createFramebuffer=function(l,p,f){return new ve(this,l,p,f)},Ne.prototype.clear=function(l){var p=l.color,f=l.depth,m=this.gl,E=0;p&&(E|=m.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(E|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),m.clear(E)},Ne.prototype.setCullFace=function(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},Ne.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},Ne.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},Ne.prototype.setColorMode=function(l){h.deepEqual(l.blendFunction,ft.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},Ne.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ue=function(l){function p(f,m,E){var R=this;l.call(this),this.id=f,this.dispatcher=E,this.on("data",function(O){O.dataType==="source"&&O.sourceDataType==="metadata"&&(R._sourceLoaded=!0),R._sourceLoaded&&!R._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(R.reload(),R.transform&&R.update(R.transform))}),this.on("error",function(){R._sourceErrored=!0}),this._source=function(O,$,ge,Me){var Ye=new ke[$.type](O,$,ge,Me);if(Ye.id!==O)throw new Error("Expected Source id to be "+O+" instead of "+Ye.id);return h.bindAll(["load","abort","unload","serialize","prepare"],Ye),Ye}(f,m,E,this),this._tiles={},this._cache=new Zr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.onAdd=function(f){this.map=f,this._maxTileCacheSize=f?f._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(f)},p.prototype.onRemove=function(f){this._source&&this._source.onRemove&&this._source.onRemove(f)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var f in this._tiles){var m=this._tiles[f];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var f=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,f&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(f,m){return this._source.loadTile(f,m)},p.prototype._unloadTile=function(f){if(this._source.unloadTile)return this._source.unloadTile(f,function(){})},p.prototype._abortTile=function(f){if(this._source.abortTile)return this._source.abortTile(f,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(f){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[m];E.upload(f),E.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return h.values(this._tiles).map(function(f){return f.tileID}).sort(vt).map(function(f){return f.key})},p.prototype.getRenderableIds=function(f){var m=this,E=[];for(var R in this._tiles)this._isIdRenderable(R,f)&&E.push(this._tiles[R]);return f?E.sort(function(O,$){var ge=O.tileID,Me=$.tileID,Ye=new h.Point(ge.canonical.x,ge.canonical.y)._rotate(m.transform.angle),tt=new h.Point(Me.canonical.x,Me.canonical.y)._rotate(m.transform.angle);return ge.overscaledZ-Me.overscaledZ||tt.y-Ye.y||tt.x-Ye.x}).map(function(O){return O.tileID.key}):E.map(function(O){return O.tileID}).sort(vt).map(function(O){return O.key})},p.prototype.hasRenderableParent=function(f){var m=this.findLoadedParent(f,0);return!!m&&this._isIdRenderable(m.tileID.key)},p.prototype._isIdRenderable=function(f,m){return this._tiles[f]&&this._tiles[f].hasData()&&!this._coveredTiles[f]&&(m||!this._tiles[f].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var f in this._cache.reset(),this._tiles)this._tiles[f].state!=="errored"&&this._reloadTile(f,"reloading")},p.prototype._reloadTile=function(f,m){var E=this._tiles[f];E&&(E.state!=="loading"&&(E.state=m),this._loadTile(E,this._tileLoaded.bind(this,E,f,m)))},p.prototype._tileLoaded=function(f,m,E,R){if(R)return f.state="errored",void(R.status!==404?this._source.fire(new h.ErrorEvent(R,{tile:f})):this.update(this.transform));f.timeAdded=h.browser.now(),E==="expired"&&(f.refreshedUponExpiration=!0),this._setTileReloadTimer(m,f),this.getSource().type==="raster-dem"&&f.dem&&this._backfillDEM(f),this._state.initializeTileState(f,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:f,coord:f.tileID}))},p.prototype._backfillDEM=function(f){for(var m=this.getRenderableIds(),E=0;E<m.length;E++){var R=m[E];if(f.neighboringTiles&&f.neighboringTiles[R]){var O=this.getTileByID(R);$(f,O),$(O,f)}}function $(ge,Me){ge.needsHillshadePrepare=!0;var Ye=Me.tileID.canonical.x-ge.tileID.canonical.x,tt=Me.tileID.canonical.y-ge.tileID.canonical.y,ot=Math.pow(2,ge.tileID.canonical.z),At=Me.tileID.key;Ye===0&&tt===0||Math.abs(tt)>1||(Math.abs(Ye)>1&&(Math.abs(Ye+ot)===1?Ye+=ot:Math.abs(Ye-ot)===1&&(Ye-=ot)),Me.dem&&ge.dem&&(ge.dem.backfillBorder(Me.dem,Ye,tt),ge.neighboringTiles&&ge.neighboringTiles[At]&&(ge.neighboringTiles[At].backfilled=!0)))}},p.prototype.getTile=function(f){return this.getTileByID(f.key)},p.prototype.getTileByID=function(f){return this._tiles[f]},p.prototype._retainLoadedChildren=function(f,m,E,R){for(var O in this._tiles){var $=this._tiles[O];if(!(R[O]||!$.hasData()||$.tileID.overscaledZ<=m||$.tileID.overscaledZ>E)){for(var ge=$.tileID;$&&$.tileID.overscaledZ>m+1;){var Me=$.tileID.scaledTo($.tileID.overscaledZ-1);($=this._tiles[Me.key])&&$.hasData()&&(ge=Me)}for(var Ye=ge;Ye.overscaledZ>m;)if(f[(Ye=Ye.scaledTo(Ye.overscaledZ-1)).key]){R[ge.key]=ge;break}}}},p.prototype.findLoadedParent=function(f,m){if(f.key in this._loadedParentTiles){var E=this._loadedParentTiles[f.key];return E&&E.tileID.overscaledZ>=m?E:null}for(var R=f.overscaledZ-1;R>=m;R--){var O=f.scaledTo(R),$=this._getLoadedTile(O);if($)return $}},p.prototype._getLoadedTile=function(f){var m=this._tiles[f.key];return m&&m.hasData()?m:this._cache.getByKey(f.wrapped().key)},p.prototype.updateCacheSize=function(f){var m=Math.ceil(f.width/this._source.tileSize)+1,E=Math.ceil(f.height/this._source.tileSize)+1,R=Math.floor(m*E*5),O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,R):R;this._cache.setMaxSize(O)},p.prototype.handleWrapJump=function(f){var m=Math.round((f-(this._prevLng===void 0?f:this._prevLng))/360);if(this._prevLng=f,m){var E={};for(var R in this._tiles){var O=this._tiles[R];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+m),E[O.tileID.key]=O}for(var $ in this._tiles=E,this._timers)clearTimeout(this._timers[$]),delete this._timers[$];for(var ge in this._tiles)this._setTileReloadTimer(ge,this._tiles[ge])}},p.prototype.update=function(f){var m=this;if(this.transform=f,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(f),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=f.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(tn){return new h.OverscaledTileID(tn.canonical.z,tn.wrap,tn.canonical.z,tn.canonical.x,tn.canonical.y)}):(E=f.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(tn){return m._source.hasTile(tn)}))):E=[];var R=f.coveringZoomLevel(this._source),O=Math.max(R-p.maxOverzooming,this._source.minzoom),$=Math.max(R+p.maxUnderzooming,this._source.minzoom),ge=this._updateRetainedTiles(E,R);if(ue(this._source.type)){for(var Me={},Ye={},tt=0,ot=Object.keys(ge);tt<ot.length;tt+=1){var At=ot[tt],St=ge[At],Zt=this._tiles[At];if(Zt&&!(Zt.fadeEndTime&&Zt.fadeEndTime<=h.browser.now())){var _t=this.findLoadedParent(St,O);_t&&(this._addTile(_t.tileID),Me[_t.tileID.key]=_t.tileID),Ye[At]=St}}for(var Vt in this._retainLoadedChildren(Ye,R,$,ge),Me)ge[Vt]||(this._coveredTiles[Vt]=!0,ge[Vt]=Me[Vt])}for(var er in ge)this._tiles[er].clearFadeHold();for(var cr=0,Rr=h.keysDifference(this._tiles,ge);cr<Rr.length;cr+=1){var Er=Rr[cr],Br=this._tiles[Er];Br.hasSymbolBuckets&&!Br.holdingForFade()?Br.setHoldDuration(this.map._fadeDuration):Br.hasSymbolBuckets&&!Br.symbolFadeFinished()||this._removeTile(Er)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var f in this._tiles)this._tiles[f].holdingForFade()&&this._removeTile(f)},p.prototype._updateRetainedTiles=function(f,m){for(var E={},R={},O=Math.max(m-p.maxOverzooming,this._source.minzoom),$=Math.max(m+p.maxUnderzooming,this._source.minzoom),ge={},Me=0,Ye=f;Me<Ye.length;Me+=1){var tt=Ye[Me],ot=this._addTile(tt);E[tt.key]=tt,ot.hasData()||m<this._source.maxzoom&&(ge[tt.key]=tt)}this._retainLoadedChildren(ge,m,$,E);for(var At=0,St=f;At<St.length;At+=1){var Zt=St[At],_t=this._tiles[Zt.key];if(!_t.hasData()){if(m+1>this._source.maxzoom){var Vt=Zt.children(this._source.maxzoom)[0],er=this.getTile(Vt);if(er&&er.hasData()){E[Vt.key]=Vt;continue}}else{var cr=Zt.children(this._source.maxzoom);if(E[cr[0].key]&&E[cr[1].key]&&E[cr[2].key]&&E[cr[3].key])continue}for(var Rr=_t.wasRequested(),Er=Zt.overscaledZ-1;Er>=O;--Er){var Br=Zt.scaledTo(Er);if(R[Br.key]||(R[Br.key]=!0,!(_t=this.getTile(Br))&&Rr&&(_t=this._addTile(Br)),_t&&(E[Br.key]=Br,Rr=_t.wasRequested(),_t.hasData())))break}}}return E},p.prototype._updateLoadedParentTileCache=function(){for(var f in this._loadedParentTiles={},this._tiles){for(var m=[],E=void 0,R=this._tiles[f].tileID;R.overscaledZ>0;){if(R.key in this._loadedParentTiles){E=this._loadedParentTiles[R.key];break}m.push(R.key);var O=R.scaledTo(R.overscaledZ-1);if(E=this._getLoadedTile(O))break;R=O}for(var $=0,ge=m;$<ge.length;$+=1)this._loadedParentTiles[ge[$]]=E}},p.prototype._addTile=function(f){var m=this._tiles[f.key];if(m)return m;(m=this._cache.getAndRemove(f))&&(this._setTileReloadTimer(f.key,m),m.tileID=f,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[f.key]&&(clearTimeout(this._cacheTimers[f.key]),delete this._cacheTimers[f.key],this._setTileReloadTimer(f.key,m)));var E=!!m;return E||(m=new h.Tile(f,this._source.tileSize*f.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,f.key,m.state))),m?(m.uses++,this._tiles[f.key]=m,E||this._source.fire(new h.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},p.prototype._setTileReloadTimer=function(f,m){var E=this;f in this._timers&&(clearTimeout(this._timers[f]),delete this._timers[f]);var R=m.getExpiryTimeout();R&&(this._timers[f]=setTimeout(function(){E._reloadTile(f,"expired"),delete E._timers[f]},R))},p.prototype._removeTile=function(f){var m=this._tiles[f];m&&(m.uses--,delete this._tiles[f],this._timers[f]&&(clearTimeout(this._timers[f]),delete this._timers[f]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},p.prototype.clearTiles=function(){for(var f in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(f);this._cache.reset()},p.prototype.tilesIn=function(f,m,E){var R=this,O=[],$=this.transform;if(!$)return O;for(var ge=E?$.getCameraQueryGeometry(f):f,Me=f.map(function(Er){return $.pointCoordinate(Er)}),Ye=ge.map(function(Er){return $.pointCoordinate(Er)}),tt=this.getIds(),ot=1/0,At=1/0,St=-1/0,Zt=-1/0,_t=0,Vt=Ye;_t<Vt.length;_t+=1){var er=Vt[_t];ot=Math.min(ot,er.x),At=Math.min(At,er.y),St=Math.max(St,er.x),Zt=Math.max(Zt,er.y)}for(var cr=function(Er){var Br=R._tiles[tt[Er]];if(!Br.holdingForFade()){var tn=Br.tileID,M=Math.pow(2,$.zoom-Br.tileID.overscaledZ),k=m*Br.queryPadding*h.EXTENT/Br.tileSize/M,L=[tn.getTilePoint(new h.MercatorCoordinate(ot,At)),tn.getTilePoint(new h.MercatorCoordinate(St,Zt))];if(L[0].x-k<h.EXTENT&&L[0].y-k<h.EXTENT&&L[1].x+k>=0&&L[1].y+k>=0){var K=Me.map(function(ne){return tn.getTilePoint(ne)}),ie=Ye.map(function(ne){return tn.getTilePoint(ne)});O.push({tile:Br,tileID:tn,queryGeometry:K,cameraQueryGeometry:ie,scale:M})}}},Rr=0;Rr<tt.length;Rr++)cr(Rr);return O},p.prototype.getVisibleCoordinates=function(f){for(var m=this,E=this.getRenderableIds(f).map(function(ge){return m._tiles[ge].tileID}),R=0,O=E;R<O.length;R+=1){var $=O[R];$.posMatrix=this.transform.calculatePosMatrix($.toUnwrapped())}return E},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ue(this._source.type))for(var f in this._tiles){var m=this._tiles[f];if(m.fadeEndTime!==void 0&&m.fadeEndTime>=h.browser.now())return!0}return!1},p.prototype.setFeatureState=function(f,m,E){this._state.updateState(f=f||"_geojsonTileLayer",m,E)},p.prototype.removeFeatureState=function(f,m,E){this._state.removeFeatureState(f=f||"_geojsonTileLayer",m,E)},p.prototype.getFeatureState=function(f,m){return this._state.getState(f=f||"_geojsonTileLayer",m)},p.prototype.setDependencies=function(f,m,E){var R=this._tiles[f];R&&R.setDependencies(m,E)},p.prototype.reloadTilesForDependencies=function(f,m){for(var E in this._tiles)this._tiles[E].hasDependency(f,m)&&this._reloadTile(E,"reloading");this._cache.filter(function(R){return!R.hasDependency(f,m)})},p}(h.Evented);function vt(l,p){var f=Math.abs(2*l.wrap)-+(l.wrap<0),m=Math.abs(2*p.wrap)-+(p.wrap<0);return l.overscaledZ-p.overscaledZ||m-f||p.canonical.y-l.canonical.y||p.canonical.x-l.canonical.x}function ue(l){return l==="raster"||l==="image"||l==="video"}function Lr(){return new h.window.Worker(Hl.workerUrl)}Ue.maxOverzooming=10,Ue.maxUnderzooming=3;var lr="mapboxgl_preloaded_worker_pool",$r=function(){this.active={}};$r.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<$r.workerCount;)this.workers.push(new Lr);return this.active[l]=!0,this.workers.slice()},$r.prototype.release=function(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},$r.prototype.isPreloaded=function(){return!!this.active[lr]},$r.prototype.numActive=function(){return Object.keys(this.active).length};var Rn,nn=Math.floor(h.browser.hardwareConcurrency/2);function xr(){return Rn||(Rn=new $r),Rn}function Or(l,p){var f={};for(var m in l)m!=="ref"&&(f[m]=l[m]);return h.refProperties.forEach(function(E){E in p&&(f[E]=p[E])}),f}function sn(l){l=l.slice();for(var p=Object.create(null),f=0;f<l.length;f++)p[l[f].id]=l[f];for(var m=0;m<l.length;m++)"ref"in l[m]&&(l[m]=Or(l[m],p[l[m].ref]));return l}$r.workerCount=Math.max(Math.min(nn,6),1);var xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wi(l,p,f){f.push({command:xn.addSource,args:[l,p[l]]})}function Nn(l,p,f){p.push({command:xn.removeSource,args:[l]}),f[l]=!0}function Bi(l,p,f,m){Nn(l,f,m),wi(l,p,f)}function sa(l,p,f){var m;for(m in l[f])if(l[f].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(l[f][m],p[f][m]))return!1;for(m in p[f])if(p[f].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(l[f][m],p[f][m]))return!1;return!0}function Fi(l,p,f,m,E,R){var O;for(O in p=p||{},l=l||{})l.hasOwnProperty(O)&&(h.deepEqual(l[O],p[O])||f.push({command:R,args:[m,O,p[O],E]}));for(O in p)p.hasOwnProperty(O)&&!l.hasOwnProperty(O)&&(h.deepEqual(l[O],p[O])||f.push({command:R,args:[m,O,p[O],E]}))}function bn(l){return l.id}function ei(l,p){return l[p.id]=p,l}var ga=function(l,p){this.reset(l,p)};ga.prototype.reset=function(l,p){this.points=l||[],this._distances=[0];for(var f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ga.prototype.lerp=function(l){if(this.points.length===1)return this.points[0];l=h.clamp(l,0,1);for(var p=1,f=this._distances[p],m=l*this.paddedLength+this.padding;f<m&&p<this._distances.length;)f=this._distances[++p];var E=p-1,R=this._distances[E],O=f-R,$=O>0?(m-R)/O:0;return this.points[E].mult(1-$).add(this.points[p].mult($))};var ua=function(l,p,f){var m=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/f),this.yCellCount=Math.ceil(p/f);for(var R=0;R<this.xCellCount*this.yCellCount;R++)m.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function no(l,p,f,m,E){var R=h.create();return p?(h.scale(R,R,[1/E,1/E,1]),f||h.rotateZ(R,R,m.angle)):h.multiply(R,m.labelPlaneMatrix,l),R}function ia(l,p,f,m,E){if(p){var R=h.clone(l);return h.scale(R,R,[E,E,1]),f||h.rotateZ(R,R,-m.angle),R}return m.glCoordMatrix}function zi(l,p){var f=[l.x,l.y,0,1];Qa(f,f,p);var m=f[3];return{point:new h.Point(f[0]/m,f[1]/m),signedDistanceFromCamera:m}}function Nr(l,p){return .5+l/p*.5}function ji(l,p){var f=l[0]/l[3],m=l[1]/l[3];return f>=-p[0]&&f<=p[0]&&m>=-p[1]&&m<=p[1]}function Hs(l,p,f,m,E,R,O,$){var ge=m?l.textSizeData:l.iconSizeData,Me=h.evaluateSizeForZoom(ge,f.transform.zoom),Ye=[256/f.width*2+1,256/f.height*2+1],tt=m?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;tt.clear();for(var ot=l.lineVertexArray,At=m?l.text.placedSymbolArray:l.icon.placedSymbolArray,St=f.transform.width/f.transform.height,Zt=!1,_t=0;_t<At.length;_t++){var Vt=At.get(_t);if(Vt.hidden||Vt.writingMode===h.WritingMode.vertical&&!Zt)qa(Vt.numGlyphs,tt);else{Zt=!1;var er=[Vt.anchorX,Vt.anchorY,0,1];if(h.transformMat4(er,er,p),ji(er,Ye)){var cr=Nr(f.transform.cameraToCenterDistance,er[3]),Rr=h.evaluateSizeForFeature(ge,Me,Vt),Er=O?Rr/cr:Rr*cr,Br=new h.Point(Vt.anchorX,Vt.anchorY),tn=zi(Br,E).point,M={},k=Qs(Vt,Er,!1,$,p,E,R,l.glyphOffsetArray,ot,tt,tn,Br,M,St);Zt=k.useVertical,(k.notEnoughRoom||Zt||k.needsFlipping&&Qs(Vt,Er,!0,$,p,E,R,l.glyphOffsetArray,ot,tt,tn,Br,M,St).notEnoughRoom)&&qa(Vt.numGlyphs,tt)}else qa(Vt.numGlyphs,tt)}}m?l.text.dynamicLayoutVertexBuffer.updateData(tt):l.icon.dynamicLayoutVertexBuffer.updateData(tt)}function Da(l,p,f,m,E,R,O,$,ge,Me,Ye){var tt=$.glyphStartIndex+$.numGlyphs,ot=$.lineStartIndex,At=$.lineStartIndex+$.lineLength,St=p.getoffsetX($.glyphStartIndex),Zt=p.getoffsetX(tt-1),_t=Ka(l*St,f,m,E,R,O,$.segment,ot,At,ge,Me,Ye);if(!_t)return null;var Vt=Ka(l*Zt,f,m,E,R,O,$.segment,ot,At,ge,Me,Ye);return Vt?{first:_t,last:Vt}:null}function Za(l,p,f,m){return l===h.WritingMode.horizontal&&Math.abs(f.y-p.y)>Math.abs(f.x-p.x)*m?{useVertical:!0}:(l===h.WritingMode.vertical?p.y<f.y:p.x>f.x)?{needsFlipping:!0}:null}function Qs(l,p,f,m,E,R,O,$,ge,Me,Ye,tt,ot,At){var St,Zt=p/24,_t=l.lineOffsetX*Zt,Vt=l.lineOffsetY*Zt;if(l.numGlyphs>1){var er=l.glyphStartIndex+l.numGlyphs,cr=l.lineStartIndex,Rr=l.lineStartIndex+l.lineLength,Er=Da(Zt,$,_t,Vt,f,Ye,tt,l,ge,R,ot);if(!Er)return{notEnoughRoom:!0};var Br=zi(Er.first.point,O).point,tn=zi(Er.last.point,O).point;if(m&&!f){var M=Za(l.writingMode,Br,tn,At);if(M)return M}St=[Er.first];for(var k=l.glyphStartIndex+1;k<er-1;k++)St.push(Ka(Zt*$.getoffsetX(k),_t,Vt,f,Ye,tt,l.segment,cr,Rr,ge,R,ot));St.push(Er.last)}else{if(m&&!f){var L=zi(tt,E).point,K=l.lineStartIndex+l.segment+1,ie=new h.Point(ge.getx(K),ge.gety(K)),ne=zi(ie,E),nt=ne.signedDistanceFromCamera>0?ne.point:cs(tt,ie,L,1,E),rt=Za(l.writingMode,L,nt,At);if(rt)return rt}var jt=Ka(Zt*$.getoffsetX(l.glyphStartIndex),_t,Vt,f,Ye,tt,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,ge,R,ot);if(!jt)return{notEnoughRoom:!0};St=[jt]}for(var ct=0,Yt=St;ct<Yt.length;ct+=1){var ar=Yt[ct];h.addDynamicAttributes(Me,ar.point,ar.angle)}return{}}function cs(l,p,f,m,E){var R=zi(l.add(l.sub(p)._unit()),E).point,O=f.sub(R);return f.add(O._mult(m/O.mag()))}function Ka(l,p,f,m,E,R,O,$,ge,Me,Ye,tt){var ot=m?l-p:l+p,At=ot>0?1:-1,St=0;m&&(At*=-1,St=Math.PI),At<0&&(St+=Math.PI);for(var Zt=At>0?$+O:$+O+1,_t=E,Vt=E,er=0,cr=0,Rr=Math.abs(ot),Er=[];er+cr<=Rr;){if((Zt+=At)<$||Zt>=ge)return null;if(Vt=_t,Er.push(_t),(_t=tt[Zt])===void 0){var Br=new h.Point(Me.getx(Zt),Me.gety(Zt)),tn=zi(Br,Ye);if(tn.signedDistanceFromCamera>0)_t=tt[Zt]=tn.point;else{var M=Zt-At;_t=cs(er===0?R:new h.Point(Me.getx(M),Me.gety(M)),Br,Vt,Rr-er+1,Ye)}}er+=cr,cr=Vt.dist(_t)}var k=(Rr-er)/cr,L=_t.sub(Vt),K=L.mult(k)._add(Vt);K._add(L._unit()._perp()._mult(f*At));var ie=St+Math.atan2(_t.y-Vt.y,_t.x-Vt.x);return Er.push(K),{point:K,angle:ie,path:Er}}ua.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ua.prototype.insert=function(l,p,f,m,E){this._forEachCell(p,f,m,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(E)},ua.prototype.insertCircle=function(l,p,f,m){this._forEachCell(p-m,f-m,p+m,f+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(f),this.circles.push(m)},ua.prototype._insertBoxCell=function(l,p,f,m,E,R){this.boxCells[E].push(R)},ua.prototype._insertCircleCell=function(l,p,f,m,E,R){this.circleCells[E].push(R)},ua.prototype._query=function(l,p,f,m,E,R){if(f<0||l>this.width||m<0||p>this.height)return!E&&[];var O=[];if(l<=0&&p<=0&&this.width<=f&&this.height<=m){if(E)return!0;for(var $=0;$<this.boxKeys.length;$++)O.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(var ge=0;ge<this.circleKeys.length;ge++){var Me=this.circles[3*ge],Ye=this.circles[3*ge+1],tt=this.circles[3*ge+2];O.push({key:this.circleKeys[ge],x1:Me-tt,y1:Ye-tt,x2:Me+tt,y2:Ye+tt})}return R?O.filter(R):O}return this._forEachCell(l,p,f,m,this._queryCell,O,{hitTest:E,seenUids:{box:{},circle:{}}},R),E?O.length>0:O},ua.prototype._queryCircle=function(l,p,f,m,E){var R=l-f,O=l+f,$=p-f,ge=p+f;if(O<0||R>this.width||ge<0||$>this.height)return!m&&[];var Me=[];return this._forEachCell(R,$,O,ge,this._queryCellCircle,Me,{hitTest:m,circle:{x:l,y:p,radius:f},seenUids:{box:{},circle:{}}},E),m?Me.length>0:Me},ua.prototype.query=function(l,p,f,m,E){return this._query(l,p,f,m,!1,E)},ua.prototype.hitTest=function(l,p,f,m,E){return this._query(l,p,f,m,!0,E)},ua.prototype.hitTestCircle=function(l,p,f,m){return this._queryCircle(l,p,f,!0,m)},ua.prototype._queryCell=function(l,p,f,m,E,R,O,$){var ge=O.seenUids,Me=this.boxCells[E];if(Me!==null)for(var Ye=this.bboxes,tt=0,ot=Me;tt<ot.length;tt+=1){var At=ot[tt];if(!ge.box[At]){ge.box[At]=!0;var St=4*At;if(l<=Ye[St+2]&&p<=Ye[St+3]&&f>=Ye[St+0]&&m>=Ye[St+1]&&(!$||$(this.boxKeys[At]))){if(O.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[At],x1:Ye[St],y1:Ye[St+1],x2:Ye[St+2],y2:Ye[St+3]})}}}var Zt=this.circleCells[E];if(Zt!==null)for(var _t=this.circles,Vt=0,er=Zt;Vt<er.length;Vt+=1){var cr=er[Vt];if(!ge.circle[cr]){ge.circle[cr]=!0;var Rr=3*cr;if(this._circleAndRectCollide(_t[Rr],_t[Rr+1],_t[Rr+2],l,p,f,m)&&(!$||$(this.circleKeys[cr]))){if(O.hitTest)return R.push(!0),!0;var Er=_t[Rr],Br=_t[Rr+1],tn=_t[Rr+2];R.push({key:this.circleKeys[cr],x1:Er-tn,y1:Br-tn,x2:Er+tn,y2:Br+tn})}}}},ua.prototype._queryCellCircle=function(l,p,f,m,E,R,O,$){var ge=O.circle,Me=O.seenUids,Ye=this.boxCells[E];if(Ye!==null)for(var tt=this.bboxes,ot=0,At=Ye;ot<At.length;ot+=1){var St=At[ot];if(!Me.box[St]){Me.box[St]=!0;var Zt=4*St;if(this._circleAndRectCollide(ge.x,ge.y,ge.radius,tt[Zt+0],tt[Zt+1],tt[Zt+2],tt[Zt+3])&&(!$||$(this.boxKeys[St])))return R.push(!0),!0}}var _t=this.circleCells[E];if(_t!==null)for(var Vt=this.circles,er=0,cr=_t;er<cr.length;er+=1){var Rr=cr[er];if(!Me.circle[Rr]){Me.circle[Rr]=!0;var Er=3*Rr;if(this._circlesCollide(Vt[Er],Vt[Er+1],Vt[Er+2],ge.x,ge.y,ge.radius)&&(!$||$(this.circleKeys[Rr])))return R.push(!0),!0}}},ua.prototype._forEachCell=function(l,p,f,m,E,R,O,$){for(var ge=this._convertToXCellCoord(l),Me=this._convertToYCellCoord(p),Ye=this._convertToXCellCoord(f),tt=this._convertToYCellCoord(m),ot=ge;ot<=Ye;ot++)for(var At=Me;At<=tt;At++)if(E.call(this,l,p,f,m,this.xCellCount*At+ot,R,O,$))return},ua.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},ua.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},ua.prototype._circlesCollide=function(l,p,f,m,E,R){var O=m-l,$=E-p,ge=f+R;return ge*ge>O*O+$*$},ua.prototype._circleAndRectCollide=function(l,p,f,m,E,R,O){var $=(R-m)/2,ge=Math.abs(l-(m+$));if(ge>$+f)return!1;var Me=(O-E)/2,Ye=Math.abs(p-(E+Me));if(Ye>Me+f)return!1;if(ge<=$||Ye<=Me)return!0;var tt=ge-$,ot=Ye-Me;return tt*tt+ot*ot<=f*f};var Do=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qa(l,p){for(var f=0;f<l;f++){var m=p.length;p.resize(m+4),p.float32.set(Do,3*m)}}function Qa(l,p,f){var m=p[0],E=p[1];return l[0]=f[0]*m+f[4]*E+f[12],l[1]=f[1]*m+f[5]*E+f[13],l[3]=f[3]*m+f[7]*E+f[15],l}var Pa=function(l,p,f){p===void 0&&(p=new ua(l.width+200,l.height+200,25)),f===void 0&&(f=new ua(l.width+200,l.height+200,25)),this.transform=l,this.grid=p,this.ignoredGrid=f,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Na(l,p,f){return p*(h.EXTENT/(l.tileSize*Math.pow(2,f-l.tileID.overscaledZ)))}Pa.prototype.placeCollisionBox=function(l,p,f,m,E){var R=this.projectAndGetPerspectiveRatio(m,l.anchorPointX,l.anchorPointY),O=f*R.perspectiveRatio,$=l.x1*O+R.point.x,ge=l.y1*O+R.point.y,Me=l.x2*O+R.point.x,Ye=l.y2*O+R.point.y;return!this.isInsideGrid($,ge,Me,Ye)||!p&&this.grid.hitTest($,ge,Me,Ye,E)?{box:[],offscreen:!1}:{box:[$,ge,Me,Ye],offscreen:this.isOffscreen($,ge,Me,Ye)}},Pa.prototype.placeCollisionCircles=function(l,p,f,m,E,R,O,$,ge,Me,Ye,tt,ot){var At=[],St=new h.Point(p.anchorX,p.anchorY),Zt=zi(St,R),_t=Nr(this.transform.cameraToCenterDistance,Zt.signedDistanceFromCamera),Vt=(Me?E/_t:E*_t)/h.ONE_EM,er=zi(St,O).point,cr=Da(Vt,m,p.lineOffsetX*Vt,p.lineOffsetY*Vt,!1,er,St,p,f,O,{}),Rr=!1,Er=!1,Br=!0;if(cr){for(var tn=.5*tt*_t+ot,M=new h.Point(-100,-100),k=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),L=new ga,K=cr.first,ie=cr.last,ne=[],nt=K.path.length-1;nt>=1;nt--)ne.push(K.path[nt]);for(var rt=1;rt<ie.path.length;rt++)ne.push(ie.path[rt]);var jt=2.5*tn;if($){var ct=ne.map(function(Sa){return zi(Sa,$)});ne=ct.some(function(Sa){return Sa.signedDistanceFromCamera<=0})?[]:ct.map(function(Sa){return Sa.point})}var Yt=[];if(ne.length>0){for(var ar=ne[0].clone(),fn=ne[0].clone(),on=1;on<ne.length;on++)ar.x=Math.min(ar.x,ne[on].x),ar.y=Math.min(ar.y,ne[on].y),fn.x=Math.max(fn.x,ne[on].x),fn.y=Math.max(fn.y,ne[on].y);Yt=ar.x>=M.x&&fn.x<=k.x&&ar.y>=M.y&&fn.y<=k.y?[ne]:fn.x<M.x||ar.x>k.x||fn.y<M.y||ar.y>k.y?[]:h.clipLine([ne],M.x,M.y,k.x,k.y)}for(var Kr=0,Gn=Yt;Kr<Gn.length;Kr+=1){var Zn;L.reset(Gn[Kr],.25*tn),Zn=L.length<=.5*tn?1:Math.ceil(L.paddedLength/jt)+1;for(var jn=0;jn<Zn;jn++){var vi=jn/Math.max(Zn-1,1),Si=L.lerp(vi),Oi=Si.x+100,Ba=Si.y+100;At.push(Oi,Ba,tn,0);var Ha=Oi-tn,go=Ba-tn,Ea=Oi+tn,qi=Ba+tn;if(Br=Br&&this.isOffscreen(Ha,go,Ea,qi),Er=Er||this.isInsideGrid(Ha,go,Ea,qi),!l&&this.grid.hitTestCircle(Oi,Ba,tn,Ye)&&(Rr=!0,!ge))return{circles:[],offscreen:!1,collisionDetected:Rr}}}}return{circles:!ge&&Rr||!Er?[]:At,offscreen:Br,collisionDetected:Rr}},Pa.prototype.queryRenderedSymbols=function(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var p=[],f=1/0,m=1/0,E=-1/0,R=-1/0,O=0,$=l;O<$.length;O+=1){var ge=$[O],Me=new h.Point(ge.x+100,ge.y+100);f=Math.min(f,Me.x),m=Math.min(m,Me.y),E=Math.max(E,Me.x),R=Math.max(R,Me.y),p.push(Me)}for(var Ye={},tt={},ot=0,At=this.grid.query(f,m,E,R).concat(this.ignoredGrid.query(f,m,E,R));ot<At.length;ot+=1){var St=At[ot],Zt=St.key;if(Ye[Zt.bucketInstanceId]===void 0&&(Ye[Zt.bucketInstanceId]={}),!Ye[Zt.bucketInstanceId][Zt.featureIndex]){var _t=[new h.Point(St.x1,St.y1),new h.Point(St.x2,St.y1),new h.Point(St.x2,St.y2),new h.Point(St.x1,St.y2)];h.polygonIntersectsPolygon(p,_t)&&(Ye[Zt.bucketInstanceId][Zt.featureIndex]=!0,tt[Zt.bucketInstanceId]===void 0&&(tt[Zt.bucketInstanceId]=[]),tt[Zt.bucketInstanceId].push(Zt.featureIndex))}}return tt},Pa.prototype.insertCollisionBox=function(l,p,f,m,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:m,collisionGroupID:E},l[0],l[1],l[2],l[3])},Pa.prototype.insertCollisionCircles=function(l,p,f,m,E){for(var R=p?this.ignoredGrid:this.grid,O={bucketInstanceId:f,featureIndex:m,collisionGroupID:E},$=0;$<l.length;$+=4)R.insertCircle(O,l[$],l[$+1],l[$+2])},Pa.prototype.projectAndGetPerspectiveRatio=function(l,p,f){var m=[p,f,0,1];return Qa(m,m,l),{point:new h.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},Pa.prototype.isOffscreen=function(l,p,f,m){return f<100||l>=this.screenRightBoundary||m<100||p>this.screenBottomBoundary},Pa.prototype.isInsideGrid=function(l,p,f,m){return f>=0&&l<this.gridRightBoundary&&m>=0&&p<this.gridBottomBoundary},Pa.prototype.getViewportMatrix=function(){var l=h.identity([]);return h.translate(l,l,[-100,-100,0]),l};var Lo=function(l,p,f,m){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):m&&f?1:0,this.placed=f};Lo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ba=function(l,p,f,m,E){this.text=new Lo(l?l.text:null,p,f,E),this.icon=new Lo(l?l.icon:null,p,m,E)};ba.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var so=function(l,p,f){this.text=l,this.icon=p,this.skipFade=f},Ao=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},Y=function(l,p,f,m,E){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=f,this.bucketIndex=m,this.tileID=E},vo=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function Va(l,p,f,m,E){var R=h.getAnchorAlignment(l),O=-(R.horizontalAlign-.5)*p,$=-(R.verticalAlign-.5)*f,ge=h.evaluateVariableOffset(l,m);return new h.Point(O+ge[0]*E,$+ge[1]*E)}function fs(l,p,f,m,E,R){var O=l.x1,$=l.x2,ge=l.y1,Me=l.y2,Ye=l.anchorPointX,tt=l.anchorPointY,ot=new h.Point(p,f);return m&&ot._rotate(E?R:-R),{x1:O+ot.x,y1:ge+ot.y,x2:$+ot.x,y2:Me+ot.y,anchorPointX:Ye,anchorPointY:tt}}vo.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:function(f){return f.collisionGroupID===p}}}return this.collisionGroups[l]};var Eo=function(l,p,f,m){this.transform=l.clone(),this.collisionIndex=new Pa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new vo(f),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}};function Qe(l,p,f,m,E){l.emplaceBack(p?1:0,f?1:0,m||0,E||0),l.emplaceBack(p?1:0,f?1:0,m||0,E||0),l.emplaceBack(p?1:0,f?1:0,m||0,E||0),l.emplaceBack(p?1:0,f?1:0,m||0,E||0)}Eo.prototype.getBucketParts=function(l,p,f,m){var E=f.getBucket(p),R=f.latestFeatureIndex;if(E&&R&&p.id===E.layerIds[0]){var O=f.collisionBoxArray,$=E.layers[0].layout,ge=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Me=f.tileSize/h.EXTENT,Ye=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),tt=$.get("text-pitch-alignment")==="map",ot=$.get("text-rotation-alignment")==="map",At=Na(f,1,this.transform.zoom),St=no(Ye,tt,ot,this.transform,At),Zt=null;if(tt){var _t=ia(Ye,tt,ot,this.transform,At);Zt=h.multiply([],this.transform.labelPlaneMatrix,_t)}this.retainedQueryData[E.bucketInstanceId]=new Y(E.bucketInstanceId,R,E.sourceLayerIndex,E.index,f.tileID);var Vt={bucket:E,layout:$,posMatrix:Ye,textLabelPlaneMatrix:St,labelToScreenMatrix:Zt,scale:ge,textPixelRatio:Me,holdingForFade:f.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(m)for(var er=0,cr=E.sortKeyRanges;er<cr.length;er+=1){var Rr=cr[er];l.push({sortKey:Rr.sortKey,symbolInstanceStart:Rr.symbolInstanceStart,symbolInstanceEnd:Rr.symbolInstanceEnd,parameters:Vt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Vt})}},Eo.prototype.attemptAnchorPlacement=function(l,p,f,m,E,R,O,$,ge,Me,Ye,tt,ot,At,St){var Zt,_t=[tt.textOffset0,tt.textOffset1],Vt=Va(l,f,m,_t,E),er=this.collisionIndex.placeCollisionBox(fs(p,Vt.x,Vt.y,R,O,this.transform.angle),Ye,$,ge,Me.predicate);if(!St||this.collisionIndex.placeCollisionBox(fs(St,Vt.x,Vt.y,R,O,this.transform.angle),Ye,$,ge,Me.predicate).box.length!==0)return er.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID]&&this.prevPlacement.placements[tt.crossTileID].text&&(Zt=this.prevPlacement.variableOffsets[tt.crossTileID].anchor),this.variableOffsets[tt.crossTileID]={textOffset:_t,width:f,height:m,anchor:l,textBoxScale:E,prevAnchor:Zt},this.markUsedJustification(ot,l,tt,At),ot.allowVerticalPlacement&&(this.markUsedOrientation(ot,At,tt),this.placedOrientations[tt.crossTileID]=At),{shift:Vt,placedGlyphBoxes:er}):void 0},Eo.prototype.placeLayerBucketPart=function(l,p,f){var m=this,E=l.parameters,R=E.bucket,O=E.layout,$=E.posMatrix,ge=E.textLabelPlaneMatrix,Me=E.labelToScreenMatrix,Ye=E.textPixelRatio,tt=E.holdingForFade,ot=E.collisionBoxArray,At=E.partiallyEvaluatedTextSize,St=E.collisionGroup,Zt=O.get("text-optional"),_t=O.get("icon-optional"),Vt=O.get("text-allow-overlap"),er=O.get("icon-allow-overlap"),cr=O.get("text-rotation-alignment")==="map",Rr=O.get("text-pitch-alignment")==="map",Er=O.get("icon-text-fit")!=="none",Br=O.get("symbol-z-order")==="viewport-y",tn=Vt&&(er||!R.hasIconData()||_t),M=er&&(Vt||!R.hasTextData()||Zt);!R.collisionArrays&&ot&&R.deserializeCollisionBoxes(ot);var k=function(rt,jt){if(!p[rt.crossTileID])if(tt)m.placements[rt.crossTileID]=new so(!1,!1,!1);else{var ct,Yt=!1,ar=!1,fn=!0,on=null,Kr={box:null,offscreen:null},Gn={box:null,offscreen:null},Zn=null,jn=null,vi=0,Si=0,Oi=0;jt.textFeatureIndex?vi=jt.textFeatureIndex:rt.useRuntimeCollisionCircles&&(vi=rt.featureIndex),jt.verticalTextFeatureIndex&&(Si=jt.verticalTextFeatureIndex);var Ba=jt.textBox;if(Ba){var Ha=function(Oa){var Ps=h.WritingMode.horizontal;if(R.allowVerticalPlacement&&!Oa&&m.prevPlacement){var vs=m.prevPlacement.placedOrientations[rt.crossTileID];vs&&(m.placedOrientations[rt.crossTileID]=vs,m.markUsedOrientation(R,Ps=vs,rt))}return Ps},go=function(Oa,Ps){if(R.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&jt.verticalTextBox)for(var vs=0,Wl=R.writingModes;vs<Wl.length&&(Wl[vs]===h.WritingMode.vertical?(Kr=Ps(),Gn=Kr):Kr=Oa(),!(Kr&&Kr.box&&Kr.box.length));vs+=1);else Kr=Oa()};if(O.get("text-variable-anchor")){var Ea=O.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[rt.crossTileID]){var qi=m.prevPlacement.variableOffsets[rt.crossTileID];Ea.indexOf(qi.anchor)>0&&(Ea=Ea.filter(function(Oa){return Oa!==qi.anchor})).unshift(qi.anchor)}var Sa=function(Oa,Ps,vs){for(var Wl=Oa.x2-Oa.x1,Hf=Oa.y2-Oa.y1,hl=rt.textBoxScale,Wf=Er&&!er?Ps:null,Nc={box:[],offscreen:!1},xc=Vt?2*Ea.length:Ea.length,pl=0;pl<xc;++pl){var Rf=m.attemptAnchorPlacement(Ea[pl%Ea.length],Oa,Wl,Hf,hl,cr,Rr,Ye,$,St,pl>=Ea.length,rt,R,vs,Wf);if(Rf&&(Nc=Rf.placedGlyphBoxes)&&Nc.box&&Nc.box.length){Yt=!0,on=Rf.shift;break}}return Nc};go(function(){return Sa(Ba,jt.iconBox,h.WritingMode.horizontal)},function(){var Oa=jt.verticalTextBox;return R.allowVerticalPlacement&&!(Kr&&Kr.box&&Kr.box.length)&&rt.numVerticalGlyphVertices>0&&Oa?Sa(Oa,jt.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),Kr&&(Yt=Kr.box,fn=Kr.offscreen);var Zo=Ha(Kr&&Kr.box);if(!Yt&&m.prevPlacement){var ss=m.prevPlacement.variableOffsets[rt.crossTileID];ss&&(m.variableOffsets[rt.crossTileID]=ss,m.markUsedJustification(R,ss.anchor,rt,Zo))}}else{var Fo=function(Oa,Ps){var vs=m.collisionIndex.placeCollisionBox(Oa,Vt,Ye,$,St.predicate);return vs&&vs.box&&vs.box.length&&(m.markUsedOrientation(R,Ps,rt),m.placedOrientations[rt.crossTileID]=Ps),vs};go(function(){return Fo(Ba,h.WritingMode.horizontal)},function(){var Oa=jt.verticalTextBox;return R.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&Oa?Fo(Oa,h.WritingMode.vertical):{box:null,offscreen:null}}),Ha(Kr&&Kr.box&&Kr.box.length)}}if(Yt=(ct=Kr)&&ct.box&&ct.box.length>0,fn=ct&&ct.offscreen,rt.useRuntimeCollisionCircles){var Qo=R.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex),Is=h.evaluateSizeForFeature(R.textSizeData,At,Qo),iu=O.get("text-padding");Zn=m.collisionIndex.placeCollisionCircles(Vt,Qo,R.lineVertexArray,R.glyphOffsetArray,Is,$,ge,Me,f,Rr,St.predicate,rt.collisionCircleDiameter,iu),Yt=Vt||Zn.circles.length>0&&!Zn.collisionDetected,fn=fn&&Zn.offscreen}if(jt.iconFeatureIndex&&(Oi=jt.iconFeatureIndex),jt.iconBox){var Iu=function(Oa){var Ps=Er&&on?fs(Oa,on.x,on.y,cr,Rr,m.transform.angle):Oa;return m.collisionIndex.placeCollisionBox(Ps,er,Ye,$,St.predicate)};ar=Gn&&Gn.box&&Gn.box.length&&jt.verticalIconBox?(jn=Iu(jt.verticalIconBox)).box.length>0:(jn=Iu(jt.iconBox)).box.length>0,fn=fn&&jn.offscreen}var ds=Zt||rt.numHorizontalGlyphVertices===0&&rt.numVerticalGlyphVertices===0,Vo=_t||rt.numIconVertices===0;if(ds||Vo?Vo?ds||(ar=ar&&Yt):Yt=ar&&Yt:ar=Yt=ar&&Yt,Yt&&ct&&ct.box&&m.collisionIndex.insertCollisionBox(ct.box,O.get("text-ignore-placement"),R.bucketInstanceId,Gn&&Gn.box&&Si?Si:vi,St.ID),ar&&jn&&m.collisionIndex.insertCollisionBox(jn.box,O.get("icon-ignore-placement"),R.bucketInstanceId,Oi,St.ID),Zn&&(Yt&&m.collisionIndex.insertCollisionCircles(Zn.circles,O.get("text-ignore-placement"),R.bucketInstanceId,vi,St.ID),f)){var yu=R.bucketInstanceId,_u=m.collisionCircleArrays[yu];_u===void 0&&(_u=m.collisionCircleArrays[yu]=new Ao);for(var Ku=0;Ku<Zn.circles.length;Ku+=4)_u.circles.push(Zn.circles[Ku+0]),_u.circles.push(Zn.circles[Ku+1]),_u.circles.push(Zn.circles[Ku+2]),_u.circles.push(Zn.collisionDetected?1:0)}m.placements[rt.crossTileID]=new so(Yt||tn,ar||M,fn||R.justReloaded),p[rt.crossTileID]=!0}};if(Br)for(var L=R.getSortedSymbolIndexes(this.transform.angle),K=L.length-1;K>=0;--K){var ie=L[K];k(R.symbolInstances.get(ie),R.collisionArrays[ie])}else for(var ne=l.symbolInstanceStart;ne<l.symbolInstanceEnd;ne++)k(R.symbolInstances.get(ne),R.collisionArrays[ne]);if(f&&R.bucketInstanceId in this.collisionCircleArrays){var nt=this.collisionCircleArrays[R.bucketInstanceId];h.invert(nt.invProjMatrix,$),nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}R.justReloaded=!1},Eo.prototype.markUsedJustification=function(l,p,f,m){var E;E=m===h.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(p)];for(var R=0,O=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];R<O.length;R+=1){var $=O[R];$>=0&&(l.text.placedSymbolArray.get($).crossTileID=E>=0&&$!==E?0:f.crossTileID)}},Eo.prototype.markUsedOrientation=function(l,p,f){for(var m=p===h.WritingMode.horizontal||p===h.WritingMode.horizontalOnly?p:0,E=p===h.WritingMode.vertical?p:0,R=0,O=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];R<O.length;R+=1)l.text.placedSymbolArray.get(O[R]).placedOrientation=m;f.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=E)},Eo.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,f=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var m=p?p.symbolFadeChange(l):1,E=p?p.opacities:{},R=p?p.variableOffsets:{},O=p?p.placedOrientations:{};for(var $ in this.placements){var ge=this.placements[$],Me=E[$];Me?(this.opacities[$]=new ba(Me,m,ge.text,ge.icon),f=f||ge.text!==Me.text.placed||ge.icon!==Me.icon.placed):(this.opacities[$]=new ba(null,m,ge.text,ge.icon,ge.skipFade),f=f||ge.text||ge.icon)}for(var Ye in E){var tt=E[Ye];if(!this.opacities[Ye]){var ot=new ba(tt,m,!1,!1);ot.isHidden()||(this.opacities[Ye]=ot,f=f||tt.text.placed||tt.icon.placed)}}for(var At in R)this.variableOffsets[At]||!this.opacities[At]||this.opacities[At].isHidden()||(this.variableOffsets[At]=R[At]);for(var St in O)this.placedOrientations[St]||!this.opacities[St]||this.opacities[St].isHidden()||(this.placedOrientations[St]=O[St]);f?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)},Eo.prototype.updateLayerOpacities=function(l,p){for(var f={},m=0,E=p;m<E.length;m+=1){var R=E[m],O=R.getBucket(l);O&&R.latestFeatureIndex&&l.id===O.layerIds[0]&&this.updateBucketOpacities(O,f,R.collisionBoxArray)}},Eo.prototype.updateBucketOpacities=function(l,p,f){var m=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var E=l.layers[0].layout,R=new ba(null,0,!1,!1,!0),O=E.get("text-allow-overlap"),$=E.get("icon-allow-overlap"),ge=E.get("text-variable-anchor"),Me=E.get("text-rotation-alignment")==="map",Ye=E.get("text-pitch-alignment")==="map",tt=E.get("icon-text-fit")!=="none",ot=new ba(null,0,O&&($||!l.hasIconData()||E.get("icon-optional")),$&&(O||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&f&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(f);for(var At=function(Vt,er,cr){for(var Rr=0;Rr<er/4;Rr++)Vt.opacityVertexArray.emplaceBack(cr)},St=function(Vt){var er=l.symbolInstances.get(Vt),cr=er.numHorizontalGlyphVertices,Rr=er.numVerticalGlyphVertices,Er=er.crossTileID,Br=m.opacities[Er];p[Er]?Br=R:Br||(m.opacities[Er]=Br=ot),p[Er]=!0;var tn=er.numIconVertices>0,M=m.placedOrientations[er.crossTileID],k=M===h.WritingMode.vertical,L=M===h.WritingMode.horizontal||M===h.WritingMode.horizontalOnly;if(cr>0||Rr>0){var K=Ko(Br.text);At(l.text,cr,k?Po:K),At(l.text,Rr,L?Po:K);var ie=Br.text.isHidden();[er.rightJustifiedTextSymbolIndex,er.centerJustifiedTextSymbolIndex,er.leftJustifiedTextSymbolIndex].forEach(function(Kr){Kr>=0&&(l.text.placedSymbolArray.get(Kr).hidden=ie||k?1:0)}),er.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(er.verticalPlacedTextSymbolIndex).hidden=ie||L?1:0);var ne=m.variableOffsets[er.crossTileID];ne&&m.markUsedJustification(l,ne.anchor,er,M);var nt=m.placedOrientations[er.crossTileID];nt&&(m.markUsedJustification(l,"left",er,nt),m.markUsedOrientation(l,nt,er))}if(tn){var rt=Ko(Br.icon),jt=!(tt&&er.verticalPlacedIconSymbolIndex&&k);er.placedIconSymbolIndex>=0&&(At(l.icon,er.numIconVertices,jt?rt:Po),l.icon.placedSymbolArray.get(er.placedIconSymbolIndex).hidden=Br.icon.isHidden()),er.verticalPlacedIconSymbolIndex>=0&&(At(l.icon,er.numVerticalIconVertices,jt?Po:rt),l.icon.placedSymbolArray.get(er.verticalPlacedIconSymbolIndex).hidden=Br.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var ct=l.collisionArrays[Vt];if(ct){var Yt=new h.Point(0,0);if(ct.textBox||ct.verticalTextBox){var ar=!0;if(ge){var fn=m.variableOffsets[Er];fn?(Yt=Va(fn.anchor,fn.width,fn.height,fn.textOffset,fn.textBoxScale),Me&&Yt._rotate(Ye?m.transform.angle:-m.transform.angle)):ar=!1}ct.textBox&&Qe(l.textCollisionBox.collisionVertexArray,Br.text.placed,!ar||k,Yt.x,Yt.y),ct.verticalTextBox&&Qe(l.textCollisionBox.collisionVertexArray,Br.text.placed,!ar||L,Yt.x,Yt.y)}var on=!!(!L&&ct.verticalIconBox);ct.iconBox&&Qe(l.iconCollisionBox.collisionVertexArray,Br.icon.placed,on,tt?Yt.x:0,tt?Yt.y:0),ct.verticalIconBox&&Qe(l.iconCollisionBox.collisionVertexArray,Br.icon.placed,!on,tt?Yt.x:0,tt?Yt.y:0)}}},Zt=0;Zt<l.symbolInstances.length;Zt++)St(Zt);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var _t=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=_t.invProjMatrix,l.placementViewportMatrix=_t.viewportMatrix,l.collisionCircleArray=_t.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},Eo.prototype.symbolFadeChange=function(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Eo.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},Eo.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},Eo.prototype.stillRecent=function(l,p){var f=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*f>l},Eo.prototype.setStale=function(){this.stale=!0};var gt=Math.pow(2,25),Gt=Math.pow(2,24),Pr=Math.pow(2,17),Tn=Math.pow(2,16),di=Math.pow(2,9),fa=Math.pow(2,8),Bo=Math.pow(2,1);function Ko(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;var p=l.placed?1:0,f=Math.floor(127*l.opacity);return f*gt+p*Gt+f*Pr+p*Tn+f*di+p*fa+f*Bo+p}var Po=0,Us=function(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Us.prototype.continuePlacement=function(l,p,f,m,E){for(var R=this._bucketParts;this._currentTileIndex<l.length;)if(p.getBucketParts(R,m,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort(function(O,$){return O.sortKey-$.sortKey}));this._currentPartIndex<R.length;)if(p.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,E())return!0;return!1};var ws=function(l,p,f,m,E,R,O){this.placement=new Eo(l,E,R,O),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=m,this._done=!1};ws.prototype.isDone=function(){return this._done},ws.prototype.continuePlacement=function(l,p,f){for(var m=this,E=h.browser.now(),R=function(){var ge=h.browser.now()-E;return!m._forceFullPlacement&&ge>2};this._currentPlacementIndex>=0;){var O=p[l[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=$)&&(!O.maxzoom||O.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new Us(O)),this._inProgressLayer.continuePlacement(f[O.source],this.placement,this._showCollisionBoxes,O,R))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ws.prototype.commit=function(l){return this.placement.commit(l),this.placement};var Yc=512/h.EXTENT/2,Ml=function(l,p,f){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(var m=0;m<p.length;m++){var E=p.get(m),R=E.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,l)})}};Ml.prototype.getScaledCoordinates=function(l,p){var f=Yc/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*h.EXTENT+l.anchorX)*f),y:Math.floor((p.canonical.y*h.EXTENT+l.anchorY)*f)}},Ml.prototype.findMatches=function(l,p,f){for(var m=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),E=0;E<l.length;E++){var R=l.get(E);if(!R.crossTileID){var O=this.indexedSymbolInstances[R.key];if(O)for(var $=this.getScaledCoordinates(R,p),ge=0,Me=O;ge<Me.length;ge+=1){var Ye=Me[ge];if(Math.abs(Ye.coord.x-$.x)<=m&&Math.abs(Ye.coord.y-$.y)<=m&&!f[Ye.crossTileID]){f[Ye.crossTileID]=!0,R.crossTileID=Ye.crossTileID;break}}}}};var ns=function(){this.maxCrossTileID=0};ns.prototype.generate=function(){return++this.maxCrossTileID};var Uu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Uu.prototype.handleWrapJump=function(l){var p=Math.round((l-this.lng)/360);if(p!==0)for(var f in this.indexes){var m=this.indexes[f],E={};for(var R in m){var O=m[R];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+p),E[O.tileID.key]=O}this.indexes[f]=E}this.lng=l},Uu.prototype.addBucket=function(l,p,f){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var m=0;m<p.symbolInstances.length;m++)p.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var E=this.usedCrossTileIDs[l.overscaledZ];for(var R in this.indexes){var O=this.indexes[R];if(Number(R)>l.overscaledZ)for(var $ in O){var ge=O[$];ge.tileID.isChildOf(l)&&ge.findMatches(p.symbolInstances,l,E)}else{var Me=O[l.scaledTo(Number(R)).key];Me&&Me.findMatches(p.symbolInstances,l,E)}}for(var Ye=0;Ye<p.symbolInstances.length;Ye++){var tt=p.symbolInstances.get(Ye);tt.crossTileID||(tt.crossTileID=f.generate(),E[tt.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Ml(l,p.symbolInstances,p.bucketInstanceId),!0},Uu.prototype.removeBucketCrossTileIDs=function(l,p){for(var f in p.indexedSymbolInstances)for(var m=0,E=p.indexedSymbolInstances[f];m<E.length;m+=1)delete this.usedCrossTileIDs[l][E[m].crossTileID]},Uu.prototype.removeStaleBuckets=function(l){var p=!1;for(var f in this.indexes){var m=this.indexes[f];for(var E in m)l[m[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,m[E]),delete m[E],p=!0)}return p};var il=function(){this.layerIndexes={},this.crossTileIDs=new ns,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};il.prototype.addLayer=function(l,p,f){var m=this.layerIndexes[l.id];m===void 0&&(m=this.layerIndexes[l.id]=new Uu);var E=!1,R={};m.handleWrapJump(f);for(var O=0,$=p;O<$.length;O+=1){var ge=$[O],Me=ge.getBucket(l);Me&&l.id===Me.layerIds[0]&&(Me.bucketInstanceId||(Me.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(ge.tileID,Me,this.crossTileIDs)&&(E=!0),R[Me.bucketInstanceId]=!0)}return m.removeStaleBuckets(R)&&(E=!0),E},il.prototype.pruneUnusedLayers=function(l){var p={};for(var f in l.forEach(function(m){p[m]=!0}),this.layerIndexes)p[f]||delete this.layerIndexes[f]};var is=function(l,p){return h.emitValidationErrors(l,p&&p.filter(function(f){return f.identifier!=="source.canvas"}))},Cu=h.pick(xn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),al=h.pick(xn,["setCenter","setZoom","setBearing","setPitch"]),Kl=function(){var l={},p=h.styleSpec.$version;for(var f in h.styleSpec.$root){var m,E=h.styleSpec.$root[f];E.required&&(m=f==="version"?p:E.type==="array"?[]:{})!=null&&(l[f]=m)}return l}(),cn=function(l){function p(f,m){var E=this;m===void 0&&(m={}),l.call(this),this.map=f,this.dispatcher=new de(xr(),this),this.imageManager=new le,this.imageManager.setEventedParent(this),this.glyphManager=new Ze(f._requestManager,m.localIdeographFontFamily),this.lineAtlas=new Te(256,512),this.crossTileSymbolIndex=new il,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var R=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(O){R.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},function($,ge){if(h.triggerPluginCompletionEvent($),ge&&ge.every(function(Ye){return Ye}))for(var Me in R.sourceCaches)R.sourceCaches[Me].reload()})}),this.on("data",function(O){if(O.dataType==="source"&&O.sourceDataType==="metadata"){var $=E.sourceCaches[O.sourceId];if($){var ge=$.getSource();if(ge&&ge.vectorLayerIds)for(var Me in E._layers){var Ye=E._layers[Me];Ye.source===ge.id&&E._validateLayer(Ye)}}}})}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.loadURL=function(f,m){var E=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var R=typeof m.validate=="boolean"?m.validate:!h.isMapboxURL(f);f=this.map._requestManager.normalizeStyleURL(f,m.accessToken);var O=this.map._requestManager.transformRequest(f,h.ResourceType.Style);this._request=h.getJSON(O,function($,ge){E._request=null,$?E.fire(new h.ErrorEvent($)):ge&&E._load(ge,R)})},p.prototype.loadJSON=function(f,m){var E=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){E._request=null,E._load(f,m.validate!==!1)})},p.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Kl,!1)},p.prototype._load=function(f,m){if(!m||!is(this,h.validateStyle(f))){for(var E in this._loaded=!0,this.stylesheet=f,f.sources)this.addSource(E,f.sources[E],{validate:!1});f.sprite?this._loadSprite(f.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(f.glyphs);var R=sn(this.stylesheet.layers);this._order=R.map(function(Me){return Me.id}),this._layers={},this._serializedLayers={};for(var O=0,$=R;O<$.length;O+=1){var ge=$[O];(ge=h.createStyleLayer(ge)).setEventedParent(this,{layer:{id:ge.id}}),this._layers[ge.id]=ge,this._serializedLayers[ge.id]=ge.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new be(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},p.prototype._loadSprite=function(f){var m=this;this._spriteRequest=function(E,R,O){var $,ge,Me,Ye=h.browser.devicePixelRatio>1?"@2x":"",tt=h.getJSON(R.transformRequest(R.normalizeSpriteURL(E,Ye,".json"),h.ResourceType.SpriteJSON),function(St,Zt){tt=null,Me||(Me=St,$=Zt,At())}),ot=h.getImage(R.transformRequest(R.normalizeSpriteURL(E,Ye,".png"),h.ResourceType.SpriteImage),function(St,Zt){ot=null,Me||(Me=St,ge=Zt,At())});function At(){if(Me)O(Me);else if($&&ge){var St=h.browser.getImageData(ge),Zt={};for(var _t in $){var Vt=$[_t],er=Vt.width,cr=Vt.height,Rr=Vt.x,Er=Vt.y,Br=Vt.sdf,tn=Vt.pixelRatio,M=Vt.stretchX,k=Vt.stretchY,L=Vt.content,K=new h.RGBAImage({width:er,height:cr});h.RGBAImage.copy(St,K,{x:Rr,y:Er},{x:0,y:0},{width:er,height:cr}),Zt[_t]={data:K,pixelRatio:tn,sdf:Br,stretchX:M,stretchY:k,content:L}}O(null,Zt)}}return{cancel:function(){tt&&(tt.cancel(),tt=null),ot&&(ot.cancel(),ot=null)}}}(f,this.map._requestManager,function(E,R){if(m._spriteRequest=null,E)m.fire(new h.ErrorEvent(E));else if(R)for(var O in R)m.imageManager.addImage(O,R[O]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new h.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(f){var m=this.sourceCaches[f.source];if(m){var E=f.sourceLayer;if(E){var R=m.getSource();(R.type==="geojson"||R.vectorLayerIds&&R.vectorLayerIds.indexOf(E)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+R.id+'" as specified by style layer "'+f.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var f in this.sourceCaches)if(!this.sourceCaches[f].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(f){for(var m=[],E=0,R=f;E<R.length;E+=1){var O=this._layers[R[E]];O.type!=="custom"&&m.push(O.serialize())}return m},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(f){if(this._loaded){var m=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),R=Object.keys(this._removedLayers);for(var O in(E.length||R.length)&&this._updateWorkerLayers(E,R),this._updatedSources){var $=this._updatedSources[O];$==="reload"?this._reloadSource(O):$==="clear"&&this._clearSource(O)}for(var ge in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ge].updateTransitions(f);this.light.updateTransitions(f),this._resetUpdates()}var Me={};for(var Ye in this.sourceCaches){var tt=this.sourceCaches[Ye];Me[Ye]=tt.used,tt.used=!1}for(var ot=0,At=this._order;ot<At.length;ot+=1){var St=this._layers[At[ot]];St.recalculate(f,this._availableImages),!St.isHidden(f.zoom)&&St.source&&(this.sourceCaches[St.source].used=!0)}for(var Zt in Me){var _t=this.sourceCaches[Zt];Me[Zt]!==_t.used&&_t.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Zt}))}this.light.recalculate(f),this.z=f.zoom,m&&this.fire(new h.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var f=Object.keys(this._changedImages);if(f.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],f);this._changedImages={}}},p.prototype._updateWorkerLayers=function(f,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(f),removedIds:m})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(f){var m=this;if(this._checkLoaded(),is(this,h.validateStyle(f)))return!1;(f=h.clone$1(f)).layers=sn(f.layers);var E=function(O,$){if(!O)return[{command:xn.setStyle,args:[$]}];var ge=[];try{if(!h.deepEqual(O.version,$.version))return[{command:xn.setStyle,args:[$]}];h.deepEqual(O.center,$.center)||ge.push({command:xn.setCenter,args:[$.center]}),h.deepEqual(O.zoom,$.zoom)||ge.push({command:xn.setZoom,args:[$.zoom]}),h.deepEqual(O.bearing,$.bearing)||ge.push({command:xn.setBearing,args:[$.bearing]}),h.deepEqual(O.pitch,$.pitch)||ge.push({command:xn.setPitch,args:[$.pitch]}),h.deepEqual(O.sprite,$.sprite)||ge.push({command:xn.setSprite,args:[$.sprite]}),h.deepEqual(O.glyphs,$.glyphs)||ge.push({command:xn.setGlyphs,args:[$.glyphs]}),h.deepEqual(O.transition,$.transition)||ge.push({command:xn.setTransition,args:[$.transition]}),h.deepEqual(O.light,$.light)||ge.push({command:xn.setLight,args:[$.light]});var Me={},Ye=[];(function(ot,At,St,Zt){var _t;for(_t in At=At||{},ot=ot||{})ot.hasOwnProperty(_t)&&(At.hasOwnProperty(_t)||Nn(_t,St,Zt));for(_t in At)At.hasOwnProperty(_t)&&(ot.hasOwnProperty(_t)?h.deepEqual(ot[_t],At[_t])||(ot[_t].type==="geojson"&&At[_t].type==="geojson"&&sa(ot,At,_t)?St.push({command:xn.setGeoJSONSourceData,args:[_t,At[_t].data]}):Bi(_t,At,St,Zt)):wi(_t,At,St))})(O.sources,$.sources,Ye,Me);var tt=[];O.layers&&O.layers.forEach(function(ot){Me[ot.source]?ge.push({command:xn.removeLayer,args:[ot.id]}):tt.push(ot)}),ge=ge.concat(Ye),function(ot,At,St){At=At||[];var Zt,_t,Vt,er,cr,Rr,Er,Br=(ot=ot||[]).map(bn),tn=At.map(bn),M=ot.reduce(ei,{}),k=At.reduce(ei,{}),L=Br.slice(),K=Object.create(null);for(Zt=0,_t=0;Zt<Br.length;Zt++)k.hasOwnProperty(Vt=Br[Zt])?_t++:(St.push({command:xn.removeLayer,args:[Vt]}),L.splice(L.indexOf(Vt,_t),1));for(Zt=0,_t=0;Zt<tn.length;Zt++)L[L.length-1-Zt]!==(Vt=tn[tn.length-1-Zt])&&(M.hasOwnProperty(Vt)?(St.push({command:xn.removeLayer,args:[Vt]}),L.splice(L.lastIndexOf(Vt,L.length-_t),1)):_t++,St.push({command:xn.addLayer,args:[k[Vt],Rr=L[L.length-Zt]]}),L.splice(L.length-Zt,0,Vt),K[Vt]=!0);for(Zt=0;Zt<tn.length;Zt++)if(er=M[Vt=tn[Zt]],cr=k[Vt],!K[Vt]&&!h.deepEqual(er,cr))if(h.deepEqual(er.source,cr.source)&&h.deepEqual(er["source-layer"],cr["source-layer"])&&h.deepEqual(er.type,cr.type)){for(Er in Fi(er.layout,cr.layout,St,Vt,null,xn.setLayoutProperty),Fi(er.paint,cr.paint,St,Vt,null,xn.setPaintProperty),h.deepEqual(er.filter,cr.filter)||St.push({command:xn.setFilter,args:[Vt,cr.filter]}),h.deepEqual(er.minzoom,cr.minzoom)&&h.deepEqual(er.maxzoom,cr.maxzoom)||St.push({command:xn.setLayerZoomRange,args:[Vt,cr.minzoom,cr.maxzoom]}),er)er.hasOwnProperty(Er)&&Er!=="layout"&&Er!=="paint"&&Er!=="filter"&&Er!=="metadata"&&Er!=="minzoom"&&Er!=="maxzoom"&&(Er.indexOf("paint.")===0?Fi(er[Er],cr[Er],St,Vt,Er.slice(6),xn.setPaintProperty):h.deepEqual(er[Er],cr[Er])||St.push({command:xn.setLayerProperty,args:[Vt,Er,cr[Er]]}));for(Er in cr)cr.hasOwnProperty(Er)&&!er.hasOwnProperty(Er)&&Er!=="layout"&&Er!=="paint"&&Er!=="filter"&&Er!=="metadata"&&Er!=="minzoom"&&Er!=="maxzoom"&&(Er.indexOf("paint.")===0?Fi(er[Er],cr[Er],St,Vt,Er.slice(6),xn.setPaintProperty):h.deepEqual(er[Er],cr[Er])||St.push({command:xn.setLayerProperty,args:[Vt,Er,cr[Er]]}))}else St.push({command:xn.removeLayer,args:[Vt]}),Rr=L[L.lastIndexOf(Vt)+1],St.push({command:xn.addLayer,args:[cr,Rr]})}(tt,$.layers,ge)}catch(ot){console.warn("Unable to compute style diff:",ot),ge=[{command:xn.setStyle,args:[$]}]}return ge}(this.serialize(),f).filter(function(O){return!(O.command in al)});if(E.length===0)return!1;var R=E.filter(function(O){return!(O.command in Cu)});if(R.length>0)throw new Error("Unimplemented: "+R.map(function(O){return O.command}).join(", ")+".");return E.forEach(function(O){O.command!=="setTransition"&&m[O.command].apply(m,O.args)}),this.stylesheet=f,!0},p.prototype.addImage=function(f,m){if(this.getImage(f))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(f,m),this._afterImageUpdated(f)},p.prototype.updateImage=function(f,m){this.imageManager.updateImage(f,m)},p.prototype.getImage=function(f){return this.imageManager.getImage(f)},p.prototype.removeImage=function(f){if(!this.getImage(f))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(f),this._afterImageUpdated(f)},p.prototype._afterImageUpdated=function(f){this._availableImages=this.imageManager.listImages(),this._changedImages[f]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(f,m,E){var R=this;if(E===void 0&&(E={}),this._checkLoaded(),this.sourceCaches[f]!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(h.validateStyle.source,"sources."+f,m,null,E))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var O=this.sourceCaches[f]=new Ue(f,m,this.dispatcher);O.style=this,O.setEventedParent(this,function(){return{isSourceLoaded:R.loaded(),source:O.serialize(),sourceId:f}}),O.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(f){if(this._checkLoaded(),this.sourceCaches[f]===void 0)throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===f)return this.fire(new h.ErrorEvent(new Error('Source "'+f+'" cannot be removed while layer "'+m+'" is using it.')));var E=this.sourceCaches[f];delete this.sourceCaches[f],delete this._updatedSources[f],E.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:f})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(f,m){this._checkLoaded(),this.sourceCaches[f].getSource().setData(m),this._changed=!0},p.prototype.getSource=function(f){return this.sourceCaches[f]&&this.sourceCaches[f].getSource()},p.prototype.addLayer=function(f,m,E){E===void 0&&(E={}),this._checkLoaded();var R=f.id;if(this.getLayer(R))this.fire(new h.ErrorEvent(new Error('Layer with id "'+R+'" already exists on this map')));else{var O;if(f.type==="custom"){if(is(this,h.validateCustomStyleLayer(f)))return;O=h.createStyleLayer(f)}else{if(typeof f.source=="object"&&(this.addSource(R,f.source),f=h.clone$1(f),f=h.extend(f,{source:R})),this._validate(h.validateStyle.layer,"layers."+R,f,{arrayIndex:-1},E))return;O=h.createStyleLayer(f),this._validateLayer(O),O.setEventedParent(this,{layer:{id:R}}),this._serializedLayers[O.id]=O.serialize()}var $=m?this._order.indexOf(m):this._order.length;if(m&&$===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice($,0,R),this._layerOrderChanged=!0,this._layers[R]=O,this._removedLayers[R]&&O.source&&O.type!=="custom"){var ge=this._removedLayers[R];delete this._removedLayers[R],ge.type!==O.type?this._updatedSources[O.source]="clear":(this._updatedSources[O.source]="reload",this.sourceCaches[O.source].pause())}this._updateLayer(O),O.onAdd&&O.onAdd(this.map)}}},p.prototype.moveLayer=function(f,m){if(this._checkLoaded(),this._changed=!0,this._layers[f]){if(f!==m){var E=this._order.indexOf(f);this._order.splice(E,1);var R=m?this._order.indexOf(m):this._order.length;m&&R===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(R,0,f),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(f){this._checkLoaded();var m=this._layers[f];if(m){m.setEventedParent(null);var E=this._order.indexOf(f);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[f]=m,delete this._layers[f],delete this._serializedLayers[f],delete this._updatedLayers[f],delete this._updatedPaintProps[f],m.onRemove&&m.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(f){return this._layers[f]},p.prototype.hasLayer=function(f){return f in this._layers},p.prototype.setLayerZoomRange=function(f,m,E){this._checkLoaded();var R=this.getLayer(f);R?R.minzoom===m&&R.maxzoom===E||(m!=null&&(R.minzoom=m),E!=null&&(R.maxzoom=E),this._updateLayer(R)):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(f,m,E){E===void 0&&(E={}),this._checkLoaded();var R=this.getLayer(f);if(R){if(!h.deepEqual(R.filter,m))return m==null?(R.filter=void 0,void this._updateLayer(R)):void(this._validate(h.validateStyle.filter,"layers."+R.id+".filter",m,null,E)||(R.filter=h.clone$1(m),this._updateLayer(R)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(f){return h.clone$1(this.getLayer(f).filter)},p.prototype.setLayoutProperty=function(f,m,E,R){R===void 0&&(R={}),this._checkLoaded();var O=this.getLayer(f);O?h.deepEqual(O.getLayoutProperty(m),E)||(O.setLayoutProperty(m,E,R),this._updateLayer(O)):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(f,m){var E=this.getLayer(f);if(E)return E.getLayoutProperty(m);this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(f,m,E,R){R===void 0&&(R={}),this._checkLoaded();var O=this.getLayer(f);O?h.deepEqual(O.getPaintProperty(m),E)||(O.setPaintProperty(m,E,R)&&this._updateLayer(O),this._changed=!0,this._updatedPaintProps[f]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(f,m){return this.getLayer(f).getPaintProperty(m)},p.prototype.setFeatureState=function(f,m){this._checkLoaded();var E=f.source,R=f.sourceLayer,O=this.sourceCaches[E];if(O!==void 0){var $=O.getSource().type;$==="geojson"&&R?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):$!=="vector"||R?(f.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),O.setFeatureState(R,f.id,m)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(f,m){this._checkLoaded();var E=f.source,R=this.sourceCaches[E];if(R!==void 0){var O=R.getSource().type,$=O==="vector"?f.sourceLayer:void 0;O!=="vector"||$?m&&typeof f.id!="string"&&typeof f.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):R.removeFeatureState($,f.id,m):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(f){this._checkLoaded();var m=f.source,E=f.sourceLayer,R=this.sourceCaches[m];if(R!==void 0){if(R.getSource().type!=="vector"||E)return f.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),R.getFeatureState(E,f.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(f){return f.serialize()}),layers:this._serializeLayers(this._order)},function(f){return f!==void 0})},p.prototype._updateLayer=function(f){this._updatedLayers[f.id]=!0,f.source&&!this._updatedSources[f.source]&&this.sourceCaches[f.source].getSource().type!=="raster"&&(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(f){for(var m=this,E=function(M){return m._layers[M].type==="fill-extrusion"},R={},O=[],$=this._order.length-1;$>=0;$--){var ge=this._order[$];if(E(ge)){R[ge]=$;for(var Me=0,Ye=f;Me<Ye.length;Me+=1){var tt=Ye[Me][ge];if(tt)for(var ot=0,At=tt;ot<At.length;ot+=1)O.push(At[ot])}}}O.sort(function(M,k){return k.intersectionZ-M.intersectionZ});for(var St=[],Zt=this._order.length-1;Zt>=0;Zt--){var _t=this._order[Zt];if(E(_t))for(var Vt=O.length-1;Vt>=0;Vt--){var er=O[Vt].feature;if(R[er.layer.id]<Zt)break;St.push(er),O.pop()}else for(var cr=0,Rr=f;cr<Rr.length;cr+=1){var Er=Rr[cr][_t];if(Er)for(var Br=0,tn=Er;Br<tn.length;Br+=1)St.push(tn[Br].feature)}}return St},p.prototype.queryRenderedFeatures=function(f,m,E){m&&m.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var R={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var O=0,$=m.layers;O<$.length;O+=1){var ge=$[O],Me=this._layers[ge];if(!Me)return this.fire(new h.ErrorEvent(new Error("The layer '"+ge+"' does not exist in the map's style and cannot be queried for features."))),[];R[Me.source]=!0}}var Ye=[];for(var tt in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!R[tt]||Ye.push(qt(this.sourceCaches[tt],this._layers,this._serializedLayers,f,m,E));return this.placement&&Ye.push(function(ot,At,St,Zt,_t,Vt,er){for(var cr={},Rr=Vt.queryRenderedSymbols(Zt),Er=[],Br=0,tn=Object.keys(Rr).map(Number);Br<tn.length;Br+=1)Er.push(er[tn[Br]]);Er.sort(_n);for(var M=function(){var ne=L[k],nt=ne.featureIndex.lookupSymbolFeatures(Rr[ne.bucketInstanceId],At,ne.bucketIndex,ne.sourceLayerIndex,_t.filter,_t.layers,_t.availableImages,ot);for(var rt in nt){var jt=cr[rt]=cr[rt]||[],ct=nt[rt];ct.sort(function(fn,on){var Kr=ne.featureSortOrder;if(Kr){var Gn=Kr.indexOf(fn.featureIndex);return Kr.indexOf(on.featureIndex)-Gn}return on.featureIndex-fn.featureIndex});for(var Yt=0,ar=ct;Yt<ar.length;Yt+=1)jt.push(ar[Yt])}},k=0,L=Er;k<L.length;k+=1)M();var K=function(ne){cr[ne].forEach(function(nt){var rt=nt.feature,jt=St[ot[ne].source].getFeatureState(rt.layer["source-layer"],rt.id);rt.source=rt.layer.source,rt.layer["source-layer"]&&(rt.sourceLayer=rt.layer["source-layer"]),rt.state=jt})};for(var ie in cr)K(ie);return cr}(this._layers,this._serializedLayers,this.sourceCaches,f,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ye)},p.prototype.querySourceFeatures=function(f,m){m&&m.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var E=this.sourceCaches[f];return E?function(R,O){for(var $=R.getRenderableIds().map(function(At){return R.getTileByID(At)}),ge=[],Me={},Ye=0;Ye<$.length;Ye++){var tt=$[Ye],ot=tt.tileID.canonical.key;Me[ot]||(Me[ot]=!0,tt.querySourceFeatures(ge,O))}return ge}(E,m):[]},p.prototype.addSourceType=function(f,m,E){return p.getSourceType(f)?E(new Error('A source type called "'+f+'" already exists.')):(p.setSourceType(f,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:f,url:m.workerSourceURL},E):E(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(f,m){m===void 0&&(m={}),this._checkLoaded();var E=this.light.getLight(),R=!1;for(var O in f)if(!h.deepEqual(f[O],E[O])){R=!0;break}if(R){var $={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(f,m),this.light.updateTransitions($)}},p.prototype._validate=function(f,m,E,R,O){return O===void 0&&(O={}),(!O||O.validate!==!1)&&is(this,f.call(h.validateStyle,h.extend({key:m,style:this.serialize(),value:E,styleSpec:h.styleSpec},R)))},p.prototype._remove=function(){for(var f in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[f].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(f){this.sourceCaches[f].clearTiles()},p.prototype._reloadSource=function(f){this.sourceCaches[f].resume(),this.sourceCaches[f].reload()},p.prototype._updateSources=function(f){for(var m in this.sourceCaches)this.sourceCaches[m].update(f)},p.prototype._generateCollisionBoxes=function(){for(var f in this.sourceCaches)this._reloadSource(f)},p.prototype._updatePlacement=function(f,m,E,R,O){O===void 0&&(O=!1);for(var $=!1,ge=!1,Me={},Ye=0,tt=this._order;Ye<tt.length;Ye+=1){var ot=this._layers[tt[Ye]];if(ot.type==="symbol"){if(!Me[ot.source]){var At=this.sourceCaches[ot.source];Me[ot.source]=At.getRenderableIds(!0).map(function(er){return At.getTileByID(er)}).sort(function(er,cr){return cr.tileID.overscaledZ-er.tileID.overscaledZ||(er.tileID.isLessThan(cr.tileID)?-1:1)})}var St=this.crossTileSymbolIndex.addLayer(ot,Me[ot.source],f.center.lng);$=$||St}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((O=O||this._layerOrderChanged||E===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),f.zoom))&&(this.pauseablePlacement=new ws(f,this._order,O,m,E,R,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Me),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),ge=!0),$&&this.pauseablePlacement.placement.setStale()),ge||$)for(var Zt=0,_t=this._order;Zt<_t.length;Zt+=1){var Vt=this._layers[_t[Zt]];Vt.type==="symbol"&&this.placement.updateLayerOpacities(Vt,Me[Vt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var f in this.sourceCaches)this.sourceCaches[f].releaseSymbolFadeTiles()},p.prototype.getImages=function(f,m,E){this.imageManager.getImages(m.icons,E),this._updateTilesForChangedImages();var R=this.sourceCaches[m.source];R&&R.setDependencies(m.tileID.key,m.type,m.icons)},p.prototype.getGlyphs=function(f,m,E){this.glyphManager.getGlyphs(m.stacks,E)},p.prototype.getResource=function(f,m,E){return h.makeRequest(m,E)},p}(h.Evented);cn.getSourceType=function(l){return ke[l]},cn.setSourceType=function(l,p){ke[l]=p},cn.registerForPluginStateChange=h.registerForPluginStateChange;var Ei=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Hi=ja(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),In=ja(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Co=ja(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),ol=ja(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ql=ja("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ic=ja(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),uc=ja(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Pc=ja("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Kc=ja("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),bf=ja("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),qc=ja(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ol=ja(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),lu=ja(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ef=ja(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),hs=ja(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),gl=ja(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),yl=ja(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ws=ja(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Js=ja(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),eu=ja(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cu=ja(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),zs=ja(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),zu=ja(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Zu=ja(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),lc=ja(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),cc=ja(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ja(l,p){var f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=p.match(/attribute ([\w]+) ([\w]+)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=R?R.concat(E):E,$={};return{fragmentSource:l=l.replace(f,function(ge,Me,Ye,tt,ot){return $[ot]=!0,Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ot+`
varying `+Ye+" "+tt+" "+ot+`;
#else
uniform `+Ye+" "+tt+" u_"+ot+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ot+`
    `+Ye+" "+tt+" "+ot+" = u_"+ot+`;
#endif
`}),vertexSource:p=p.replace(f,function(ge,Me,Ye,tt,ot){var At=tt==="float"?"vec2":"vec4",St=ot.match(/color/)?"color":At;return $[ot]?Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ot+`
uniform lowp float u_`+ot+`_t;
attribute `+Ye+" "+At+" a_"+ot+`;
varying `+Ye+" "+tt+" "+ot+`;
#else
uniform `+Ye+" "+tt+" u_"+ot+`;
#endif
`:St==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ot+`
    `+ot+" = a_"+ot+`;
#else
    `+Ye+" "+tt+" "+ot+" = u_"+ot+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ot+`
    `+ot+" = unpack_mix_"+St+"(a_"+ot+", u_"+ot+`_t);
#else
    `+Ye+" "+tt+" "+ot+" = u_"+ot+`;
#endif
`:Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ot+`
uniform lowp float u_`+ot+`_t;
attribute `+Ye+" "+At+" a_"+ot+`;
#else
uniform `+Ye+" "+tt+" u_"+ot+`;
#endif
`:St==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ot+`
    `+Ye+" "+tt+" "+ot+" = a_"+ot+`;
#else
    `+Ye+" "+tt+" "+ot+" = u_"+ot+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ot+`
    `+Ye+" "+tt+" "+ot+" = unpack_mix_"+St+"(a_"+ot+", u_"+ot+`_t);
#else
    `+Ye+" "+tt+" "+ot+" = u_"+ot+`;
#endif
`}),staticAttributes:m,staticUniforms:O}}var jf=Object.freeze({__proto__:null,prelude:Hi,background:In,backgroundPattern:Co,circle:ol,clippingMask:ql,heatmap:Ic,heatmapTexture:uc,collisionBox:Pc,collisionCircle:Kc,debug:bf,fill:qc,fillOutline:Ol,fillOutlinePattern:lu,fillPattern:Ef,fillExtrusion:hs,fillExtrusionPattern:gl,hillshadePrepare:yl,hillshade:Ws,line:Js,lineGradient:eu,linePattern:cu,lineSDF:zs,raster:zu,symbolIcon:Zu,symbolSDF:lc,symbolTextAndIcon:cc}),fc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Il(l){for(var p=[],f=0;f<l.length;f++)if(l[f]!==null){var m=l[f].split(" ");p.push(m.pop())}return p}fc.prototype.bind=function(l,p,f,m,E,R,O,$){this.context=l;for(var ge=this.boundPaintVertexBuffers.length!==m.length,Me=0;!ge&&Me<m.length;Me++)this.boundPaintVertexBuffers[Me]!==m[Me]&&(ge=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===f&&!ge&&this.boundIndexBuffer===E&&this.boundVertexOffset===R&&this.boundDynamicVertexBuffer===O&&this.boundDynamicVertexBuffer2===$?(l.bindVertexArrayOES.set(this.vao),O&&O.bind(),E&&E.dynamicDraw&&E.bind(),$&&$.bind()):this.freshBind(p,f,m,E,R,O,$)},fc.prototype.freshBind=function(l,p,f,m,E,R,O){var $,ge=l.numAttributes,Me=this.context,Ye=Me.gl;if(Me.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Me.extVertexArrayObject.createVertexArrayOES(),Me.bindVertexArrayOES.set(this.vao),$=0,this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=m,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=O;else{$=Me.currentNumAttributes||0;for(var tt=ge;tt<$;tt++)Ye.disableVertexAttribArray(tt)}p.enableAttributes(Ye,l);for(var ot=0,At=f;ot<At.length;ot+=1)At[ot].enableAttributes(Ye,l);R&&R.enableAttributes(Ye,l),O&&O.enableAttributes(Ye,l),p.bind(),p.setVertexAttribPointers(Ye,l,E);for(var St=0,Zt=f;St<Zt.length;St+=1){var _t=Zt[St];_t.bind(),_t.setVertexAttribPointers(Ye,l,E)}R&&(R.bind(),R.setVertexAttribPointers(Ye,l,E)),m&&m.bind(),O&&(O.bind(),O.setVertexAttribPointers(Ye,l,E)),Me.currentNumAttributes=ge},fc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var co=function(l,p,f,m,E,R){var O=l.gl;this.program=O.createProgram();for(var $=Il(f.staticAttributes),ge=m?m.getBinderAttributes():[],Me=$.concat(ge),Ye=f.staticUniforms?Il(f.staticUniforms):[],tt=m?m.getBinderUniforms():[],ot=[],At=0,St=Ye.concat(tt);At<St.length;At+=1){var Zt=St[At];ot.indexOf(Zt)<0&&ot.push(Zt)}var _t=m?m.defines():[];R&&_t.push("#define OVERDRAW_INSPECTOR;");var Vt=_t.concat(Hi.fragmentSource,f.fragmentSource).join(`
`),er=_t.concat(Hi.vertexSource,f.vertexSource).join(`
`),cr=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(cr,Vt),O.compileShader(cr),O.attachShader(this.program,cr);var Rr=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(Rr,er),O.compileShader(Rr),O.attachShader(this.program,Rr),this.attributes={};var Er={};this.numAttributes=Me.length;for(var Br=0;Br<this.numAttributes;Br++)Me[Br]&&(O.bindAttribLocation(this.program,Br,Me[Br]),this.attributes[Me[Br]]=Br);O.linkProgram(this.program),O.deleteShader(Rr),O.deleteShader(cr);for(var tn=0;tn<ot.length;tn++){var M=ot[tn];if(M&&!Er[M]){var k=O.getUniformLocation(this.program,M);k&&(Er[M]=k)}}this.fixedUniforms=E(l,Er),this.binderUniforms=m?m.getUniforms(l,Er):[]}}};function Qc(l,p,f){var m=1/Na(f,1,p.transform.tileZoom),E=Math.pow(2,f.tileID.overscaledZ),R=f.tileSize*Math.pow(2,p.transform.tileZoom)/E,O=R*(f.tileID.canonical.x+f.tileID.wrap*E),$=R*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[m,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[O>>16,$>>16],u_pixel_coord_lower:[65535&O,65535&$]}}co.prototype.draw=function(l,p,f,m,E,R,O,$,ge,Me,Ye,tt,ot,At,St,Zt){var _t,Vt=l.gl;if(!this.failedToCreate){for(var er in l.program.set(this.program),l.setDepthMode(f),l.setStencilMode(m),l.setColorMode(E),l.setCullFace(R),this.fixedUniforms)this.fixedUniforms[er].set(O[er]);At&&At.setUniforms(l,this.binderUniforms,tt,{zoom:ot});for(var cr=(_t={},_t[Vt.LINES]=2,_t[Vt.TRIANGLES]=3,_t[Vt.LINE_STRIP]=1,_t)[p],Rr=0,Er=Ye.get();Rr<Er.length;Rr+=1){var Br=Er[Rr],tn=Br.vaos||(Br.vaos={});(tn[$]||(tn[$]=new fc)).bind(l,this,ge,At?At.getPaintVertexBuffers():[],Me,Br.vertexOffset,St,Zt),Vt.drawElements(p,Br.primitiveLength*cr,Vt.UNSIGNED_SHORT,Br.primitiveOffset*cr*2)}}};var Jc=function(l,p,f,m){var E=p.style.light,R=E.properties.get("position"),O=[R.x,R.y,R.z],$=h.create$1();E.properties.get("anchor")==="viewport"&&h.fromRotation($,-p.transform.angle),h.transformMat3(O,O,$);var ge=E.properties.get("color");return{u_matrix:l,u_lightpos:O,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[ge.r,ge.g,ge.b],u_vertical_gradient:+f,u_opacity:m}},Ho=function(l,p,f,m,E,R,O){return h.extend(Jc(l,p,f,m),Qc(R,p,O),{u_height_factor:-Math.pow(2,E.overscaledZ)/O.tileSize/8})},wu=function(l){return{u_matrix:l}},fu=function(l,p,f,m){return h.extend(wu(l),Qc(f,p,m))},hu=function(l,p){return{u_matrix:l,u_world:p}},Ql=function(l,p,f,m,E){return h.extend(fu(l,p,f,m),{u_world:E})},_l=function(l,p,f,m){var E,R,O=l.transform;if(m.paint.get("circle-pitch-alignment")==="map"){var $=Na(f,1,O.zoom);E=!0,R=[$,$]}else E=!1,R=O.pixelsToGLUnits;return{u_camera_to_center_distance:O.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:l.translatePosMatrix(p.posMatrix,f,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:R}},tu=function(l,p,f){var m=Na(f,1,p.zoom),E=Math.pow(2,p.zoom-f.tileID.overscaledZ),R=f.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[p.pixelsToGLUnits[0]/(m*E),p.pixelsToGLUnits[1]/(m*E)],u_overscale_factor:R}},Jl=function(l,p,f){return{u_matrix:l,u_inv_matrix:p,u_camera_to_center_distance:f.cameraToCenterDistance,u_viewport_size:[f.width,f.height]}},sl=function(l,p,f){return f===void 0&&(f=1),{u_matrix:l,u_color:p,u_overlay:0,u_overlay_scale:f}},ru=function(l){return{u_matrix:l}},Wo=function(l,p,f,m){return{u_matrix:l,u_extrude_scale:Na(p,1,f),u_intensity:m}},eo=function(l,p,f){var m=l.transform;return{u_matrix:hc(l,p,f),u_ratio:1/Na(p,1,m.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},fo=function(l,p,f,m){return h.extend(eo(l,p,f),{u_image:0,u_image_height:m})},Ru=function(l,p,f,m){var E=l.transform,R=Vu(p,E);return{u_matrix:hc(l,p,f),u_texsize:p.imageAtlasTexture.size,u_ratio:1/Na(p,1,E.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[R,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Sf=function(l,p,f,m,E){var R=l.lineAtlas,O=Vu(p,l.transform),$=f.layout.get("line-cap")==="round",ge=R.getDash(m.from,$),Me=R.getDash(m.to,$),Ye=ge.width*E.fromScale,tt=Me.width*E.toScale;return h.extend(eo(l,p,f),{u_patternscale_a:[O/Ye,-ge.height/2],u_patternscale_b:[O/tt,-Me.height/2],u_sdfgamma:R.width/(256*Math.min(Ye,tt)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:ge.y,u_tex_y_b:Me.y,u_mix:E.t})};function Vu(l,p){return 1/Na(l,1,p.tileZoom)}function hc(l,p,f){return l.translatePosMatrix(p.tileID.posMatrix,p,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}var Pl=function(l,p,f,m,E){return{u_matrix:l,u_tl_parent:p,u_scale_parent:f,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(O=E.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(R=E.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Zs(E.paint.get("raster-hue-rotate"))};var R,O};function Zs(l){l*=Math.PI/180;var p=Math.sin(l),f=Math.cos(l);return[(2*f+1)/3,(-Math.sqrt(3)*p-f+1)/3,(Math.sqrt(3)*p-f+1)/3]}var Mu,pu=function(l,p,f,m,E,R,O,$,ge,Me){var Ye=E.transform;return{u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:Ye.cameraToCenterDistance,u_pitch:Ye.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:Ye.width/Ye.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:R,u_label_plane_matrix:O,u_coord_matrix:$,u_is_text:+ge,u_pitch_with_map:+m,u_texsize:Me,u_texture:0}},ju=function(l,p,f,m,E,R,O,$,ge,Me,Ye){var tt=E.transform;return h.extend(pu(l,p,f,m,E,R,O,$,ge,Me),{u_gamma_scale:m?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+Ye})},kl=function(l,p,f,m,E,R,O,$,ge,Me){return h.extend(ju(l,p,f,m,E,R,O,$,!0,ge,!0),{u_texsize_icon:Me,u_texture_icon:1})},Dl=function(l,p,f){return{u_matrix:l,u_opacity:p,u_color:f}},$u=function(l,p,f,m,E,R){return h.extend(function(O,$,ge,Me){var Ye=ge.imageManager.getPattern(O.from.toString()),tt=ge.imageManager.getPattern(O.to.toString()),ot=ge.imageManager.getPixelSize(),At=ot.width,St=ot.height,Zt=Math.pow(2,Me.tileID.overscaledZ),_t=Me.tileSize*Math.pow(2,ge.transform.tileZoom)/Zt,Vt=_t*(Me.tileID.canonical.x+Me.tileID.wrap*Zt),er=_t*Me.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ye.tl,u_pattern_br_a:Ye.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[At,St],u_mix:$.t,u_pattern_size_a:Ye.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:$.fromScale,u_scale_b:$.toScale,u_tile_units_to_pixels:1/Na(Me,1,ge.transform.tileZoom),u_pixel_coord_upper:[Vt>>16,er>>16],u_pixel_coord_lower:[65535&Vt,65535&er]}}(m,R,f,E),{u_matrix:l,u_opacity:p})},pc={fillExtrusion:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_lightpos:new h.Uniform3f(l,p.u_lightpos),u_lightintensity:new h.Uniform1f(l,p.u_lightintensity),u_lightcolor:new h.Uniform3f(l,p.u_lightcolor),u_vertical_gradient:new h.Uniform1f(l,p.u_vertical_gradient),u_opacity:new h.Uniform1f(l,p.u_opacity)}},fillExtrusionPattern:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_lightpos:new h.Uniform3f(l,p.u_lightpos),u_lightintensity:new h.Uniform1f(l,p.u_lightintensity),u_lightcolor:new h.Uniform3f(l,p.u_lightcolor),u_vertical_gradient:new h.Uniform1f(l,p.u_vertical_gradient),u_height_factor:new h.Uniform1f(l,p.u_height_factor),u_image:new h.Uniform1i(l,p.u_image),u_texsize:new h.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,p.u_scale),u_fade:new h.Uniform1f(l,p.u_fade),u_opacity:new h.Uniform1f(l,p.u_opacity)}},fill:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix)}},fillPattern:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_image:new h.Uniform1i(l,p.u_image),u_texsize:new h.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,p.u_scale),u_fade:new h.Uniform1f(l,p.u_fade)}},fillOutline:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_world:new h.Uniform2f(l,p.u_world)}},fillOutlinePattern:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_world:new h.Uniform2f(l,p.u_world),u_image:new h.Uniform1i(l,p.u_image),u_texsize:new h.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,p.u_scale),u_fade:new h.Uniform1f(l,p.u_fade)}},circle:function(l,p){return{u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(l,p.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(l,p.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(l,p.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(l,p.u_matrix)}},collisionBox:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(l,p.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(l,p.u_extrude_scale),u_overscale_factor:new h.Uniform1f(l,p.u_overscale_factor)}},collisionCircle:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_inv_matrix:new h.UniformMatrix4f(l,p.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(l,p.u_viewport_size)}},debug:function(l,p){return{u_color:new h.UniformColor(l,p.u_color),u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_overlay:new h.Uniform1i(l,p.u_overlay),u_overlay_scale:new h.Uniform1f(l,p.u_overlay_scale)}},clippingMask:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix)}},heatmap:function(l,p){return{u_extrude_scale:new h.Uniform1f(l,p.u_extrude_scale),u_intensity:new h.Uniform1f(l,p.u_intensity),u_matrix:new h.UniformMatrix4f(l,p.u_matrix)}},heatmapTexture:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_world:new h.Uniform2f(l,p.u_world),u_image:new h.Uniform1i(l,p.u_image),u_color_ramp:new h.Uniform1i(l,p.u_color_ramp),u_opacity:new h.Uniform1f(l,p.u_opacity)}},hillshade:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_image:new h.Uniform1i(l,p.u_image),u_latrange:new h.Uniform2f(l,p.u_latrange),u_light:new h.Uniform2f(l,p.u_light),u_shadow:new h.UniformColor(l,p.u_shadow),u_highlight:new h.UniformColor(l,p.u_highlight),u_accent:new h.UniformColor(l,p.u_accent)}},hillshadePrepare:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_image:new h.Uniform1i(l,p.u_image),u_dimension:new h.Uniform2f(l,p.u_dimension),u_zoom:new h.Uniform1f(l,p.u_zoom),u_unpack:new h.Uniform4f(l,p.u_unpack)}},line:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_ratio:new h.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,p.u_units_to_pixels)}},lineGradient:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_ratio:new h.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,p.u_units_to_pixels),u_image:new h.Uniform1i(l,p.u_image),u_image_height:new h.Uniform1f(l,p.u_image_height)}},linePattern:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_texsize:new h.Uniform2f(l,p.u_texsize),u_ratio:new h.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_image:new h.Uniform1i(l,p.u_image),u_units_to_pixels:new h.Uniform2f(l,p.u_units_to_pixels),u_scale:new h.Uniform3f(l,p.u_scale),u_fade:new h.Uniform1f(l,p.u_fade)}},lineSDF:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_ratio:new h.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,p.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(l,p.u_patternscale_a),u_patternscale_b:new h.Uniform2f(l,p.u_patternscale_b),u_sdfgamma:new h.Uniform1f(l,p.u_sdfgamma),u_image:new h.Uniform1i(l,p.u_image),u_tex_y_a:new h.Uniform1f(l,p.u_tex_y_a),u_tex_y_b:new h.Uniform1f(l,p.u_tex_y_b),u_mix:new h.Uniform1f(l,p.u_mix)}},raster:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_tl_parent:new h.Uniform2f(l,p.u_tl_parent),u_scale_parent:new h.Uniform1f(l,p.u_scale_parent),u_buffer_scale:new h.Uniform1f(l,p.u_buffer_scale),u_fade_t:new h.Uniform1f(l,p.u_fade_t),u_opacity:new h.Uniform1f(l,p.u_opacity),u_image0:new h.Uniform1i(l,p.u_image0),u_image1:new h.Uniform1i(l,p.u_image1),u_brightness_low:new h.Uniform1f(l,p.u_brightness_low),u_brightness_high:new h.Uniform1f(l,p.u_brightness_high),u_saturation_factor:new h.Uniform1f(l,p.u_saturation_factor),u_contrast_factor:new h.Uniform1f(l,p.u_contrast_factor),u_spin_weights:new h.Uniform3f(l,p.u_spin_weights)}},symbolIcon:function(l,p){return{u_is_size_zoom_constant:new h.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,p.u_size_t),u_size:new h.Uniform1f(l,p.u_size),u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,p.u_pitch),u_rotate_symbol:new h.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,p.u_fade_change),u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new h.Uniform1i(l,p.u_is_text),u_pitch_with_map:new h.Uniform1i(l,p.u_pitch_with_map),u_texsize:new h.Uniform2f(l,p.u_texsize),u_texture:new h.Uniform1i(l,p.u_texture)}},symbolSDF:function(l,p){return{u_is_size_zoom_constant:new h.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,p.u_size_t),u_size:new h.Uniform1f(l,p.u_size),u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,p.u_pitch),u_rotate_symbol:new h.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,p.u_fade_change),u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new h.Uniform1i(l,p.u_is_text),u_pitch_with_map:new h.Uniform1i(l,p.u_pitch_with_map),u_texsize:new h.Uniform2f(l,p.u_texsize),u_texture:new h.Uniform1i(l,p.u_texture),u_gamma_scale:new h.Uniform1f(l,p.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(l,p.u_is_halo)}},symbolTextAndIcon:function(l,p){return{u_is_size_zoom_constant:new h.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,p.u_size_t),u_size:new h.Uniform1f(l,p.u_size),u_camera_to_center_distance:new h.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,p.u_pitch),u_rotate_symbol:new h.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,p.u_fade_change),u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new h.Uniform1i(l,p.u_is_text),u_pitch_with_map:new h.Uniform1i(l,p.u_pitch_with_map),u_texsize:new h.Uniform2f(l,p.u_texsize),u_texsize_icon:new h.Uniform2f(l,p.u_texsize_icon),u_texture:new h.Uniform1i(l,p.u_texture),u_texture_icon:new h.Uniform1i(l,p.u_texture_icon),u_gamma_scale:new h.Uniform1f(l,p.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(l,p.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(l,p.u_is_halo)}},background:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_opacity:new h.Uniform1f(l,p.u_opacity),u_color:new h.UniformColor(l,p.u_color)}},backgroundPattern:function(l,p){return{u_matrix:new h.UniformMatrix4f(l,p.u_matrix),u_opacity:new h.Uniform1f(l,p.u_opacity),u_image:new h.Uniform1i(l,p.u_image),u_pattern_tl_a:new h.Uniform2f(l,p.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(l,p.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(l,p.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(l,p.u_pattern_br_b),u_texsize:new h.Uniform2f(l,p.u_texsize),u_mix:new h.Uniform1f(l,p.u_mix),u_pattern_size_a:new h.Uniform2f(l,p.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(l,p.u_pattern_size_b),u_scale_a:new h.Uniform1f(l,p.u_scale_a),u_scale_b:new h.Uniform1f(l,p.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,p.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(l,p.u_tile_units_to_pixels)}}};function Hu(l,p,f,m,E,R,O){for(var $=l.context,ge=$.gl,Me=l.useProgram("collisionBox"),Ye=[],tt=0,ot=0,At=0;At<m.length;At++){var St=m[At],Zt=p.getTile(St),_t=Zt.getBucket(f);if(_t){var Vt=St.posMatrix;E[0]===0&&E[1]===0||(Vt=l.translatePosMatrix(St.posMatrix,Zt,E,R));var er=O?_t.textCollisionBox:_t.iconCollisionBox,cr=_t.collisionCircleArray;if(cr.length>0){var Rr=h.create(),Er=Vt;h.mul(Rr,_t.placementInvProjMatrix,l.transform.glCoordMatrix),h.mul(Rr,Rr,_t.placementViewportMatrix),Ye.push({circleArray:cr,circleOffset:ot,transform:Er,invTransform:Rr}),ot=tt+=cr.length/4}er&&Me.draw($,ge.LINES,Oe.disabled,Xe.disabled,l.colorModeForRenderPass(),Et.disabled,tu(Vt,l.transform,Zt),f.id,er.layoutVertexBuffer,er.indexBuffer,er.segments,null,l.transform.zoom,null,null,er.collisionVertexBuffer)}}if(O&&Ye.length){var Br=l.useProgram("collisionCircle"),tn=new h.StructArrayLayout2f1f2i16;tn.resize(4*tt),tn._trim();for(var M=0,k=0,L=Ye;k<L.length;k+=1)for(var K=L[k],ie=0;ie<K.circleArray.length/4;ie++){var ne=4*ie,nt=K.circleArray[ne+0],rt=K.circleArray[ne+1],jt=K.circleArray[ne+2],ct=K.circleArray[ne+3];tn.emplace(M++,nt,rt,jt,ct,0),tn.emplace(M++,nt,rt,jt,ct,1),tn.emplace(M++,nt,rt,jt,ct,2),tn.emplace(M++,nt,rt,jt,ct,3)}(!Mu||Mu.length<2*tt)&&(Mu=function(Zn){var jn=2*Zn,vi=new h.StructArrayLayout3ui6;vi.resize(jn),vi._trim();for(var Si=0;Si<jn;Si++){var Oi=6*Si;vi.uint16[Oi+0]=4*Si+0,vi.uint16[Oi+1]=4*Si+1,vi.uint16[Oi+2]=4*Si+2,vi.uint16[Oi+3]=4*Si+2,vi.uint16[Oi+4]=4*Si+3,vi.uint16[Oi+5]=4*Si+0}return vi}(tt));for(var Yt=$.createIndexBuffer(Mu,!0),ar=$.createVertexBuffer(tn,h.collisionCircleLayout.members,!0),fn=0,on=Ye;fn<on.length;fn+=1){var Kr=on[fn],Gn=Jl(Kr.transform,Kr.invTransform,l.transform);Br.draw($,ge.TRIANGLES,Oe.disabled,Xe.disabled,l.colorModeForRenderPass(),Et.disabled,Gn,f.id,ar,Yt,h.SegmentVector.simpleSegment(0,2*Kr.circleOffset,Kr.circleArray.length,Kr.circleArray.length/2),null,l.transform.zoom,null,null,null)}ar.destroy(),Yt.destroy()}}var Rs=h.identity(new Float32Array(16));function ef(l,p,f,m,E,R){var O=h.getAnchorAlignment(l),$=-(O.horizontalAlign-.5)*p,ge=-(O.verticalAlign-.5)*f,Me=h.evaluateVariableOffset(l,m);return new h.Point(($/E+Me[0])*R,(ge/E+Me[1])*R)}function kc(l,p,f,m,E,R,O,$,ge,Me,Ye){var tt=l.text.placedSymbolArray,ot=l.text.dynamicLayoutVertexArray,At=l.icon.dynamicLayoutVertexArray,St={};ot.clear();for(var Zt=0;Zt<tt.length;Zt++){var _t=tt.get(Zt),Vt=_t.hidden||!_t.crossTileID||l.allowVerticalPlacement&&!_t.placedOrientation?null:m[_t.crossTileID];if(Vt){var er=new h.Point(_t.anchorX,_t.anchorY),cr=zi(er,f?$:O),Rr=Nr(R.cameraToCenterDistance,cr.signedDistanceFromCamera),Er=E.evaluateSizeForFeature(l.textSizeData,Me,_t)*Rr/h.ONE_EM;f&&(Er*=l.tilePixelRatio/ge);for(var Br=ef(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale,Er),tn=f?zi(er.add(Br),O).point:cr.point.add(p?Br.rotate(-R.angle):Br),M=l.allowVerticalPlacement&&_t.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,k=0;k<_t.numGlyphs;k++)h.addDynamicAttributes(ot,tn,M);Ye&&_t.associatedIconIndex>=0&&(St[_t.associatedIconIndex]={shiftedAnchor:tn,angle:M})}else qa(_t.numGlyphs,ot)}if(Ye){At.clear();for(var L=l.icon.placedSymbolArray,K=0;K<L.length;K++){var ie=L.get(K);if(ie.hidden)qa(ie.numGlyphs,At);else{var ne=St[K];if(ne)for(var nt=0;nt<ie.numGlyphs;nt++)h.addDynamicAttributes(At,ne.shiftedAnchor,ne.angle);else qa(ie.numGlyphs,At)}}l.icon.dynamicLayoutVertexBuffer.updateData(At)}l.text.dynamicLayoutVertexBuffer.updateData(ot)}function tf(l,p,f){return f.iconsInText&&p?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function xl(l,p,f,m,E,R,O,$,ge,Me,Ye,tt){for(var ot=l.context,At=ot.gl,St=l.transform,Zt=$==="map",_t=ge==="map",Vt=Zt&&f.layout.get("symbol-placement")!=="point",er=Zt&&!_t&&!Vt,cr=f.layout.get("symbol-sort-key").constantOr(1)!==void 0,Rr=!1,Er=l.depthModeForSublayer(0,Oe.ReadOnly),Br=f.layout.get("text-variable-anchor"),tn=[],M=0,k=m;M<k.length;M+=1){var L=k[M],K=p.getTile(L),ie=K.getBucket(f);if(ie){var ne=E?ie.text:ie.icon;if(ne&&ne.segments.get().length){var nt=ne.programConfigurations.get(f.id),rt=E||ie.sdfIcons,jt=E?ie.textSizeData:ie.iconSizeData,ct=_t||St.pitch!==0,Yt=l.useProgram(tf(rt,E,ie),nt),ar=h.evaluateSizeForZoom(jt,St.zoom),fn=void 0,on=[0,0],Kr=void 0,Gn=void 0,Zn=null,jn=void 0;if(E)Kr=K.glyphAtlasTexture,Gn=At.LINEAR,fn=K.glyphAtlasTexture.size,ie.iconsInText&&(on=K.imageAtlasTexture.size,Zn=K.imageAtlasTexture,jn=ct||l.options.rotating||l.options.zooming||jt.kind==="composite"||jt.kind==="camera"?At.LINEAR:At.NEAREST);else{var vi=f.layout.get("icon-size").constantOr(0)!==1||ie.iconsNeedLinear;Kr=K.imageAtlasTexture,Gn=rt||l.options.rotating||l.options.zooming||vi||ct?At.LINEAR:At.NEAREST,fn=K.imageAtlasTexture.size}var Si=Na(K,1,l.transform.zoom),Oi=no(L.posMatrix,_t,Zt,l.transform,Si),Ba=ia(L.posMatrix,_t,Zt,l.transform,Si),Ha=Br&&ie.hasTextData(),go=f.layout.get("icon-text-fit")!=="none"&&Ha&&ie.hasIconData();Vt&&Hs(ie,L.posMatrix,l,E,Oi,Ba,_t,Me);var Ea=l.translatePosMatrix(L.posMatrix,K,R,O),qi=Vt||E&&Br||go?Rs:Oi,Sa=l.translatePosMatrix(Ba,K,R,O,!0),Zo=rt&&f.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ss={program:Yt,buffers:ne,uniformValues:rt?ie.iconsInText?kl(jt.kind,ar,er,_t,l,Ea,qi,Sa,fn,on):ju(jt.kind,ar,er,_t,l,Ea,qi,Sa,E,fn,!0):pu(jt.kind,ar,er,_t,l,Ea,qi,Sa,E,fn),atlasTexture:Kr,atlasTextureIcon:Zn,atlasInterpolation:Gn,atlasInterpolationIcon:jn,isSDF:rt,hasHalo:Zo};if(cr&&ie.canOverlap){Rr=!0;for(var Fo=0,Qo=ne.segments.get();Fo<Qo.length;Fo+=1){var Is=Qo[Fo];tn.push({segments:new h.SegmentVector([Is]),sortKey:Is.sortKey,state:ss})}}else tn.push({segments:ne.segments,sortKey:0,state:ss})}}}Rr&&tn.sort(function(_u,Ku){return _u.sortKey-Ku.sortKey});for(var iu=0,Iu=tn;iu<Iu.length;iu+=1){var ds=Iu[iu],Vo=ds.state;if(ot.activeTexture.set(At.TEXTURE0),Vo.atlasTexture.bind(Vo.atlasInterpolation,At.CLAMP_TO_EDGE),Vo.atlasTextureIcon&&(ot.activeTexture.set(At.TEXTURE1),Vo.atlasTextureIcon&&Vo.atlasTextureIcon.bind(Vo.atlasInterpolationIcon,At.CLAMP_TO_EDGE)),Vo.isSDF){var yu=Vo.uniformValues;Vo.hasHalo&&(yu.u_is_halo=1,Ou(Vo.buffers,ds.segments,f,l,Vo.program,Er,Ye,tt,yu)),yu.u_is_halo=0}Ou(Vo.buffers,ds.segments,f,l,Vo.program,Er,Ye,tt,Vo.uniformValues)}}function Ou(l,p,f,m,E,R,O,$,ge){var Me=m.context;E.draw(Me,Me.gl.TRIANGLES,R,O,$,Et.disabled,ge,f.id,l.layoutVertexBuffer,l.indexBuffer,p,f.paint,m.transform.zoom,l.programConfigurations.get(f.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function Ll(l,p,f,m,E,R,O){var $,ge,Me,Ye,tt,ot=l.context.gl,At=f.paint.get("fill-pattern"),St=At&&At.constantOr(1),Zt=f.getCrossfadeParameters();O?(ge=St&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=ot.LINES):(ge=St?"fillPattern":"fill",$=ot.TRIANGLES);for(var _t=0,Vt=m;_t<Vt.length;_t+=1){var er=Vt[_t],cr=p.getTile(er);if(!St||cr.patternsLoaded()){var Rr=cr.getBucket(f);if(Rr){var Er=Rr.programConfigurations.get(f.id),Br=l.useProgram(ge,Er);St&&(l.context.activeTexture.set(ot.TEXTURE0),cr.imageAtlasTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE),Er.updatePaintBuffers(Zt));var tn=At.constantOr(null);if(tn&&cr.imageAtlas){var M=cr.imageAtlas,k=M.patternPositions[tn.to.toString()],L=M.patternPositions[tn.from.toString()];k&&L&&Er.setConstantPatternPositions(k,L)}var K=l.translatePosMatrix(er.posMatrix,cr,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(O){Ye=Rr.indexBuffer2,tt=Rr.segments2;var ie=[ot.drawingBufferWidth,ot.drawingBufferHeight];Me=ge==="fillOutlinePattern"&&St?Ql(K,l,Zt,cr,ie):hu(K,ie)}else Ye=Rr.indexBuffer,tt=Rr.segments,Me=St?fu(K,l,Zt,cr):wu(K);Br.draw(l.context,$,E,l.stencilModeForClipping(er),R,Et.disabled,Me,f.id,Rr.layoutVertexBuffer,Ye,tt,f.paint,l.transform.zoom,Er)}}}}function Bl(l,p,f,m,E,R,O){for(var $=l.context,ge=$.gl,Me=f.paint.get("fill-extrusion-pattern"),Ye=Me.constantOr(1),tt=f.getCrossfadeParameters(),ot=f.paint.get("fill-extrusion-opacity"),At=0,St=m;At<St.length;At+=1){var Zt=St[At],_t=p.getTile(Zt),Vt=_t.getBucket(f);if(Vt){var er=Vt.programConfigurations.get(f.id),cr=l.useProgram(Ye?"fillExtrusionPattern":"fillExtrusion",er);Ye&&(l.context.activeTexture.set(ge.TEXTURE0),_t.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),er.updatePaintBuffers(tt));var Rr=Me.constantOr(null);if(Rr&&_t.imageAtlas){var Er=_t.imageAtlas,Br=Er.patternPositions[Rr.to.toString()],tn=Er.patternPositions[Rr.from.toString()];Br&&tn&&er.setConstantPatternPositions(Br,tn)}var M=l.translatePosMatrix(Zt.posMatrix,_t,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),k=f.paint.get("fill-extrusion-vertical-gradient"),L=Ye?Ho(M,l,k,ot,Zt,tt,_t):Jc(M,l,k,ot);cr.draw($,$.gl.TRIANGLES,E,R,O,Et.backCCW,L,f.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,f.paint,l.transform.zoom,er)}}}function Wu(l,p,f,m,E,R){var O=l.context,$=O.gl,ge=p.fbo;if(ge){var Me=l.useProgram("hillshade");O.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,ge.colorAttachment.get());var Ye=function(tt,ot,At){var St=At.paint.get("hillshade-shadow-color"),Zt=At.paint.get("hillshade-highlight-color"),_t=At.paint.get("hillshade-accent-color"),Vt=At.paint.get("hillshade-illumination-direction")*(Math.PI/180);At.paint.get("hillshade-illumination-anchor")==="viewport"&&(Vt-=tt.transform.angle);var er,cr,Rr,Er=!tt.options.moving;return{u_matrix:tt.transform.calculatePosMatrix(ot.tileID.toUnwrapped(),Er),u_image:0,u_latrange:(er=ot.tileID,cr=Math.pow(2,er.canonical.z),Rr=er.canonical.y,[new h.MercatorCoordinate(0,Rr/cr).toLngLat().lat,new h.MercatorCoordinate(0,(Rr+1)/cr).toLngLat().lat]),u_light:[At.paint.get("hillshade-exaggeration"),Vt],u_shadow:St,u_highlight:Zt,u_accent:_t}}(l,p,f);Me.draw(O,$.TRIANGLES,m,E,R,Et.disabled,Ye,f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Tf(l,p,f,m,E,R){var O=l.context,$=O.gl,ge=p.dem;if(ge&&ge.data){var Me=ge.dim,Ye=ge.stride,tt=ge.getPixels();if(O.activeTexture.set($.TEXTURE1),O.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||l.getTileTexture(Ye),p.demTexture){var ot=p.demTexture;ot.update(tt,{premultiply:!1}),ot.bind($.NEAREST,$.CLAMP_TO_EDGE)}else p.demTexture=new h.Texture(O,tt,$.RGBA,{premultiply:!1}),p.demTexture.bind($.NEAREST,$.CLAMP_TO_EDGE);O.activeTexture.set($.TEXTURE0);var At=p.fbo;if(!At){var St=new h.Texture(O,{width:Me,height:Me,data:null},$.RGBA);St.bind($.LINEAR,$.CLAMP_TO_EDGE),(At=p.fbo=O.createFramebuffer(Me,Me,!0)).colorAttachment.set(St.texture)}O.bindFramebuffer.set(At.framebuffer),O.viewport.set([0,0,Me,Me]),l.useProgram("hillshadePrepare").draw(O,$.TRIANGLES,m,E,R,Et.disabled,function(Zt,_t){var Vt=_t.stride,er=h.create();return h.ortho(er,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(er,er,[0,-h.EXTENT,0]),{u_matrix:er,u_image:1,u_dimension:[Vt,Vt],u_zoom:Zt.overscaledZ,u_unpack:_t.getUnpackVector()}}(p.tileID,ge),f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function dc(l,p,f,m,E){var R=m.paint.get("raster-fade-duration");if(R>0){var O=h.browser.now(),$=(O-l.timeAdded)/R,ge=p?(O-p.timeAdded)/R:-1,Me=f.getSource(),Ye=E.coveringZoomLevel({tileSize:Me.tileSize,roundZoom:Me.roundZoom}),tt=!p||Math.abs(p.tileID.overscaledZ-Ye)>Math.abs(l.tileID.overscaledZ-Ye),ot=tt&&l.refreshedUponExpiration?1:h.clamp(tt?$:1-ge,0,1);return l.refreshedUponExpiration&&$>=1&&(l.refreshedUponExpiration=!1),p?{opacity:1,mix:1-ot}:{opacity:ot,mix:0}}return{opacity:1,mix:0}}var rf=new h.Color(1,0,0,1),vc=new h.Color(0,1,0,1),nf=new h.Color(0,0,1,1),ec=new h.Color(1,0,1,1),mc=new h.Color(0,1,1,1);function Gs(l,p,f,m){as(l,0,p+f/2,l.transform.width,f,m)}function du(l,p,f,m){as(l,p-f/2,0,f,l.transform.height,m)}function as(l,p,f,m,E,R){var O=l.context,$=O.gl;$.enable($.SCISSOR_TEST),$.scissor(p*h.browser.devicePixelRatio,f*h.browser.devicePixelRatio,m*h.browser.devicePixelRatio,E*h.browser.devicePixelRatio),O.clear({color:R}),$.disable($.SCISSOR_TEST)}function Dc(l,p,f){var m=l.context,E=m.gl,R=f.posMatrix,O=l.useProgram("debug"),$=Oe.disabled,ge=Xe.disabled,Me=l.colorModeForRenderPass();m.activeTexture.set(E.TEXTURE0),l.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),O.draw(m,E.LINE_STRIP,$,ge,Me,Et.disabled,sl(R,h.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var Ye=p.getTileByID(f.key).latestRawTileData,tt=Math.floor((Ye&&Ye.byteLength||0)/1024),ot=p.getTile(f).tileSize,At=512/Math.min(ot,512)*(f.overscaledZ/l.transform.zoom)*.5,St=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(St+=" => "+f.overscaledZ),function(Zt,_t){Zt.initDebugOverlayCanvas();var Vt=Zt.debugOverlayCanvas,er=Zt.context.gl,cr=Zt.debugOverlayCanvas.getContext("2d");cr.clearRect(0,0,Vt.width,Vt.height),cr.shadowColor="white",cr.shadowBlur=2,cr.lineWidth=1.5,cr.strokeStyle="white",cr.textBaseline="top",cr.font="bold 36px Open Sans, sans-serif",cr.fillText(_t,5,5),cr.strokeText(_t,5,5),Zt.debugOverlayTexture.update(Vt),Zt.debugOverlayTexture.bind(er.LINEAR,er.CLAMP_TO_EDGE)}(l,St+" "+tt+"kb"),O.draw(m,E.TRIANGLES,$,ge,ft.alphaBlended,Et.disabled,sl(R,h.Color.transparent,At),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var bl={symbol:function(l,p,f,m,E){if(l.renderPass==="translucent"){var R=Xe.disabled,O=l.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function($,ge,Me,Ye,tt,ot,At){for(var St=ge.transform,Zt=tt==="map",_t=ot==="map",Vt=0,er=$;Vt<er.length;Vt+=1){var cr=er[Vt],Rr=Ye.getTile(cr),Er=Rr.getBucket(Me);if(Er&&Er.text&&Er.text.segments.get().length){var Br=h.evaluateSizeForZoom(Er.textSizeData,St.zoom),tn=Na(Rr,1,ge.transform.zoom),M=no(cr.posMatrix,_t,Zt,ge.transform,tn),k=Me.layout.get("icon-text-fit")!=="none"&&Er.hasIconData();if(Br){var L=Math.pow(2,St.zoom-Rr.tileID.overscaledZ);kc(Er,Zt,_t,At,h.symbolSize,St,M,cr.posMatrix,L,Br,k)}}}}(m,l,f,p,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),E),f.paint.get("icon-opacity").constantOr(1)!==0&&xl(l,p,f,m,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),R,O),f.paint.get("text-opacity").constantOr(1)!==0&&xl(l,p,f,m,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),R,O),p.map.showCollisionBoxes&&(Hu(l,p,f,m,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Hu(l,p,f,m,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))}},circle:function(l,p,f,m){if(l.renderPass==="translucent"){var E=f.paint.get("circle-opacity"),R=f.paint.get("circle-stroke-width"),O=f.paint.get("circle-stroke-opacity"),$=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(E.constantOr(1)!==0||R.constantOr(1)!==0&&O.constantOr(1)!==0){for(var ge=l.context,Me=ge.gl,Ye=l.depthModeForSublayer(0,Oe.ReadOnly),tt=Xe.disabled,ot=l.colorModeForRenderPass(),At=[],St=0;St<m.length;St++){var Zt=m[St],_t=p.getTile(Zt),Vt=_t.getBucket(f);if(Vt){var er=Vt.programConfigurations.get(f.id),cr={programConfiguration:er,program:l.useProgram("circle",er),layoutVertexBuffer:Vt.layoutVertexBuffer,indexBuffer:Vt.indexBuffer,uniformValues:_l(l,Zt,_t,f)};if($)for(var Rr=0,Er=Vt.segments.get();Rr<Er.length;Rr+=1){var Br=Er[Rr];At.push({segments:new h.SegmentVector([Br]),sortKey:Br.sortKey,state:cr})}else At.push({segments:Vt.segments,sortKey:0,state:cr})}}$&&At.sort(function(K,ie){return K.sortKey-ie.sortKey});for(var tn=0,M=At;tn<M.length;tn+=1){var k=M[tn],L=k.state;L.program.draw(ge,Me.TRIANGLES,Ye,tt,ot,Et.disabled,L.uniformValues,f.id,L.layoutVertexBuffer,L.indexBuffer,k.segments,f.paint,l.transform.zoom,L.programConfiguration)}}}},heatmap:function(l,p,f,m){if(f.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){var E=l.context,R=E.gl,O=Xe.disabled,$=new ft([R.ONE,R.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(At,St,Zt){var _t=At.gl;At.activeTexture.set(_t.TEXTURE1),At.viewport.set([0,0,St.width/4,St.height/4]);var Vt=Zt.heatmapFbo;if(Vt)_t.bindTexture(_t.TEXTURE_2D,Vt.colorAttachment.get()),At.bindFramebuffer.set(Vt.framebuffer);else{var er=_t.createTexture();_t.bindTexture(_t.TEXTURE_2D,er),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_WRAP_S,_t.CLAMP_TO_EDGE),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_WRAP_T,_t.CLAMP_TO_EDGE),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_MIN_FILTER,_t.LINEAR),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_MAG_FILTER,_t.LINEAR),Vt=Zt.heatmapFbo=At.createFramebuffer(St.width/4,St.height/4,!1),function(cr,Rr,Er,Br){var tn=cr.gl;tn.texImage2D(tn.TEXTURE_2D,0,tn.RGBA,Rr.width/4,Rr.height/4,0,tn.RGBA,cr.extRenderToTextureHalfFloat?cr.extTextureHalfFloat.HALF_FLOAT_OES:tn.UNSIGNED_BYTE,null),Br.colorAttachment.set(Er)}(At,St,er,Vt)}})(E,l,f),E.clear({color:h.Color.transparent});for(var ge=0;ge<m.length;ge++){var Me=m[ge];if(!p.hasRenderableParent(Me)){var Ye=p.getTile(Me),tt=Ye.getBucket(f);if(tt){var ot=tt.programConfigurations.get(f.id);l.useProgram("heatmap",ot).draw(E,R.TRIANGLES,Oe.disabled,O,$,Et.disabled,Wo(Me.posMatrix,Ye,l.transform.zoom,f.paint.get("heatmap-intensity")),f.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,f.paint,l.transform.zoom,ot)}}}E.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(At,St){var Zt=At.context,_t=Zt.gl,Vt=St.heatmapFbo;if(Vt){Zt.activeTexture.set(_t.TEXTURE0),_t.bindTexture(_t.TEXTURE_2D,Vt.colorAttachment.get()),Zt.activeTexture.set(_t.TEXTURE1);var er=St.colorRampTexture;er||(er=St.colorRampTexture=new h.Texture(Zt,St.colorRamp,_t.RGBA)),er.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),At.useProgram("heatmapTexture").draw(Zt,_t.TRIANGLES,Oe.disabled,Xe.disabled,At.colorModeForRenderPass(),Et.disabled,function(cr,Rr,Er,Br){var tn=h.create();h.ortho(tn,0,cr.width,cr.height,0,0,1);var M=cr.context.gl;return{u_matrix:tn,u_world:[M.drawingBufferWidth,M.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Rr.paint.get("heatmap-opacity")}}(At,St),St.id,At.viewportBuffer,At.quadTriangleIndexBuffer,At.viewportSegments,St.paint,At.transform.zoom)}}(l,f))},line:function(l,p,f,m){if(l.renderPass==="translucent"){var E=f.paint.get("line-opacity"),R=f.paint.get("line-width");if(E.constantOr(1)!==0&&R.constantOr(1)!==0)for(var O=l.depthModeForSublayer(0,Oe.ReadOnly),$=l.colorModeForRenderPass(),ge=f.paint.get("line-dasharray"),Me=f.paint.get("line-pattern"),Ye=Me.constantOr(1),tt=f.paint.get("line-gradient"),ot=f.getCrossfadeParameters(),At=Ye?"linePattern":ge?"lineSDF":tt?"lineGradient":"line",St=l.context,Zt=St.gl,_t=!0,Vt=0,er=m;Vt<er.length;Vt+=1){var cr=er[Vt],Rr=p.getTile(cr);if(!Ye||Rr.patternsLoaded()){var Er=Rr.getBucket(f);if(Er){var Br=Er.programConfigurations.get(f.id),tn=l.context.program.get(),M=l.useProgram(At,Br),k=_t||M.program!==tn,L=Me.constantOr(null);if(L&&Rr.imageAtlas){var K=Rr.imageAtlas,ie=K.patternPositions[L.to.toString()],ne=K.patternPositions[L.from.toString()];ie&&ne&&Br.setConstantPatternPositions(ie,ne)}var nt=Ye?Ru(l,Rr,f,ot):ge?Sf(l,Rr,f,ge,ot):tt?fo(l,Rr,f,Er.lineClipsArray.length):eo(l,Rr,f);if(Ye)St.activeTexture.set(Zt.TEXTURE0),Rr.imageAtlasTexture.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE),Br.updatePaintBuffers(ot);else if(ge&&(k||l.lineAtlas.dirty))St.activeTexture.set(Zt.TEXTURE0),l.lineAtlas.bind(St);else if(tt){var rt=Er.gradients[f.id],jt=rt.texture;if(f.gradientVersion!==rt.version){var ct=256;if(f.stepInterpolant){var Yt=p.getSource().maxzoom,ar=cr.canonical.z===Yt?Math.ceil(1<<l.transform.maxZoom-cr.canonical.z):1;ct=h.clamp(h.nextPowerOfTwo(Er.maxLineLength/h.EXTENT*1024*ar),256,St.maxTextureSize)}rt.gradient=h.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:ct,image:rt.gradient||void 0,clips:Er.lineClipsArray}),rt.texture?rt.texture.update(rt.gradient):rt.texture=new h.Texture(St,rt.gradient,Zt.RGBA),rt.version=f.gradientVersion,jt=rt.texture}St.activeTexture.set(Zt.TEXTURE0),jt.bind(f.stepInterpolant?Zt.NEAREST:Zt.LINEAR,Zt.CLAMP_TO_EDGE)}M.draw(St,Zt.TRIANGLES,O,l.stencilModeForClipping(cr),$,Et.disabled,nt,f.id,Er.layoutVertexBuffer,Er.indexBuffer,Er.segments,f.paint,l.transform.zoom,Br,Er.layoutVertexBuffer2),_t=!1}}}}},fill:function(l,p,f,m){var E=f.paint.get("fill-color"),R=f.paint.get("fill-opacity");if(R.constantOr(1)!==0){var O=l.colorModeForRenderPass(),$=f.paint.get("fill-pattern"),ge=l.opaquePassEnabledForLayer()&&!$.constantOr(1)&&E.constantOr(h.Color.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===ge){var Me=l.depthModeForSublayer(1,l.renderPass==="opaque"?Oe.ReadWrite:Oe.ReadOnly);Ll(l,p,f,m,Me,O,!1)}if(l.renderPass==="translucent"&&f.paint.get("fill-antialias")){var Ye=l.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,Oe.ReadOnly);Ll(l,p,f,m,Ye,O,!0)}}},"fill-extrusion":function(l,p,f,m){var E=f.paint.get("fill-extrusion-opacity");if(E!==0&&l.renderPass==="translucent"){var R=new Oe(l.context.gl.LEQUAL,Oe.ReadWrite,l.depthRangeFor3D);if(E!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Bl(l,p,f,m,R,Xe.disabled,ft.disabled),Bl(l,p,f,m,R,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var O=l.colorModeForRenderPass();Bl(l,p,f,m,R,Xe.disabled,O)}}},hillshade:function(l,p,f,m){if(l.renderPass==="offscreen"||l.renderPass==="translucent"){for(var E=l.context,R=l.depthModeForSublayer(0,Oe.ReadOnly),O=l.colorModeForRenderPass(),$=l.renderPass==="translucent"?l.stencilConfigForOverlap(m):[{},m],ge=$[0],Me=0,Ye=$[1];Me<Ye.length;Me+=1){var tt=Ye[Me],ot=p.getTile(tt);ot.needsHillshadePrepare&&l.renderPass==="offscreen"?Tf(l,ot,f,R,Xe.disabled,O):l.renderPass==="translucent"&&Wu(l,ot,f,R,ge[tt.overscaledZ],O)}E.viewport.set([0,0,l.width,l.height])}},raster:function(l,p,f,m){if(l.renderPass==="translucent"&&f.paint.get("raster-opacity")!==0&&m.length)for(var E=l.context,R=E.gl,O=p.getSource(),$=l.useProgram("raster"),ge=l.colorModeForRenderPass(),Me=O instanceof st?[{},m]:l.stencilConfigForOverlap(m),Ye=Me[0],tt=Me[1],ot=tt[tt.length-1].overscaledZ,At=!l.options.moving,St=0,Zt=tt;St<Zt.length;St+=1){var _t=Zt[St],Vt=l.depthModeForSublayer(_t.overscaledZ-ot,f.paint.get("raster-opacity")===1?Oe.ReadWrite:Oe.ReadOnly,R.LESS),er=p.getTile(_t),cr=l.transform.calculatePosMatrix(_t.toUnwrapped(),At);er.registerFadeDuration(f.paint.get("raster-fade-duration"));var Rr=p.findLoadedParent(_t,0),Er=dc(er,Rr,p,f,l.transform),Br=void 0,tn=void 0,M=f.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;E.activeTexture.set(R.TEXTURE0),er.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(R.TEXTURE1),Rr?(Rr.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Br=Math.pow(2,Rr.tileID.overscaledZ-er.tileID.overscaledZ),tn=[er.tileID.canonical.x*Br%1,er.tileID.canonical.y*Br%1]):er.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);var k=Pl(cr,tn||[0,0],Br||1,Er,f);O instanceof st?$.draw(E,R.TRIANGLES,Vt,Xe.disabled,ge,Et.disabled,k,f.id,O.boundsBuffer,l.quadTriangleIndexBuffer,O.boundsSegments):$.draw(E,R.TRIANGLES,Vt,Ye[_t.overscaledZ],ge,Et.disabled,k,f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,p,f){var m=f.paint.get("background-color"),E=f.paint.get("background-opacity");if(E!==0){var R=l.context,O=R.gl,$=l.transform,ge=$.tileSize,Me=f.paint.get("background-pattern");if(!l.isPatternMissing(Me)){var Ye=!Me&&m.a===1&&E===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===Ye){var tt=Xe.disabled,ot=l.depthModeForSublayer(0,Ye==="opaque"?Oe.ReadWrite:Oe.ReadOnly),At=l.colorModeForRenderPass(),St=l.useProgram(Me?"backgroundPattern":"background"),Zt=$.coveringTiles({tileSize:ge});Me&&(R.activeTexture.set(O.TEXTURE0),l.imageManager.bind(l.context));for(var _t=f.getCrossfadeParameters(),Vt=0,er=Zt;Vt<er.length;Vt+=1){var cr=er[Vt],Rr=l.transform.calculatePosMatrix(cr.toUnwrapped()),Er=Me?$u(Rr,E,l,Me,{tileID:cr,tileSize:ge},_t):Dl(Rr,E,m);St.draw(R,O.TRIANGLES,ot,tt,At,Et.disabled,Er,f.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,p,f){for(var m=0;m<f.length;m++)Dc(l,p,f[m])},custom:function(l,p,f){var m=l.context,E=f.implementation;if(l.renderPass==="offscreen"){var R=E.prerender;R&&(l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),R.call(E,m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),m.setStencilMode(Xe.disabled);var O=E.renderingMode==="3d"?new Oe(l.context.gl.LEQUAL,Oe.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,Oe.ReadOnly);m.setDepthMode(O),E.render(m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState(),m.bindFramebuffer.set(null)}}},uo=function(l,p){this.context=new Ne(l),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=Ue.maxUnderzooming+Ue.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new il,this.gpuTimers={}};uo.prototype.resize=function(l,p){if(this.width=l*h.browser.devicePixelRatio,this.height=p*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var f=0,m=this.style._order;f<m.length;f+=1)this.style._layers[m[f]].resize()},uo.prototype.setup=function(){var l=this.context,p=new h.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(h.EXTENT,0),p.emplaceBack(0,h.EXTENT),p.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(p,Ei.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(h.EXTENT,0),f.emplaceBack(0,h.EXTENT),f.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=l.createVertexBuffer(f,Ei.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var m=new h.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(h.EXTENT,0,h.EXTENT,0),m.emplaceBack(0,h.EXTENT,0,h.EXTENT),m.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(m,et.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var E=new h.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Ei.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var R=new h.StructArrayLayout1ui2;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(R);var O=new h.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(O),this.emptyTexture=new h.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var $=this.context.gl;this.stencilClearMode=new Xe({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)},uo.prototype.clearStencil=function(){var l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var f=h.create();h.ortho(f,0,this.width,this.height,0,0,1),h.scale(f,f,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,p.TRIANGLES,Oe.disabled,this.stencilClearMode,ft.disabled,Et.disabled,ru(f),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},uo.prototype._renderTileClippingMasks=function(l,p){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&p&&p.length){this.currentStencilSource=l.source;var f=this.context,m=f.gl;this.nextStencilID+p.length>256&&this.clearStencil(),f.setColorMode(ft.disabled),f.setDepthMode(Oe.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var R=0,O=p;R<O.length;R+=1){var $=O[R],ge=this._tileClippingMaskIDs[$.key]=this.nextStencilID++;E.draw(f,m.TRIANGLES,Oe.disabled,new Xe({func:m.ALWAYS,mask:0},ge,255,m.KEEP,m.KEEP,m.REPLACE),ft.disabled,Et.disabled,ru($.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},uo.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,p=this.context.gl;return new Xe({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)},uo.prototype.stencilModeForClipping=function(l){var p=this.context.gl;return new Xe({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)},uo.prototype.stencilConfigForOverlap=function(l){var p,f=this.context.gl,m=l.sort(function(ge,Me){return Me.overscaledZ-ge.overscaledZ}),E=m[m.length-1].overscaledZ,R=m[0].overscaledZ-E+1;if(R>1){this.currentStencilSource=void 0,this.nextStencilID+R>256&&this.clearStencil();for(var O={},$=0;$<R;$++)O[$+E]=new Xe({func:f.GEQUAL,mask:255},$+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=R,[O,m]}return[(p={},p[E]=Xe.disabled,p),m]},uo.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new ft([l.CONSTANT_COLOR,l.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ft.unblended:ft.alphaBlended},uo.prototype.depthModeForSublayer=function(l,p,f){if(!this.opaquePassEnabledForLayer())return Oe.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Oe(f||this.context.gl.LEQUAL,p,[m,m])},uo.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},uo.prototype.render=function(l,p){var f=this;this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var m=this.style._order,E=this.style.sourceCaches;for(var R in E){var O=E[R];O.used&&O.prepare(this.context)}var $,ge,Me={},Ye={},tt={};for(var ot in E){var At=E[ot];Me[ot]=At.getVisibleCoordinates(),Ye[ot]=Me[ot].slice().reverse(),tt[ot]=At.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var St=0;St<m.length;St++)if(this.style._layers[m[St]].is3D()){this.opaquePassCutoff=St;break}this.renderPass="offscreen";for(var Zt=0,_t=m;Zt<_t.length;Zt+=1){var Vt=this.style._layers[_t[Zt]];if(Vt.hasOffscreenPass()&&!Vt.isHidden(this.transform.zoom)){var er=Ye[Vt.source];(Vt.type==="custom"||er.length)&&this.renderLayer(this,E[Vt.source],Vt,er)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var cr=this.style._layers[m[this.currentLayer]],Rr=E[cr.source],Er=Me[cr.source];this._renderTileClippingMasks(cr,Er),this.renderLayer(this,Rr,cr,Er)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var Br=this.style._layers[m[this.currentLayer]],tn=E[Br.source],M=(Br.type==="symbol"?tt:Ye)[Br.source];this._renderTileClippingMasks(Br,Me[Br.source]),this.renderLayer(this,tn,Br,M)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(k){k.source&&!k.isHidden(f.transform.zoom)&&(k.source!==(ge&&ge.id)&&(ge=f.style.sourceCaches[k.source]),(!$||$.getSource().maxzoom<ge.getSource().maxzoom)&&($=ge))}),$&&bl.debug(this,$,$.getVisibleCoordinates())),this.options.showPadding&&function(k){var L=k.transform.padding;Gs(k,k.transform.height-(L.top||0),3,rf),Gs(k,L.bottom||0,3,vc),du(k,L.left||0,3,nf),du(k,k.transform.width-(L.right||0),3,ec);var K=k.transform.centerPoint;(function(ie,ne,nt,rt){as(ie,ne-1,nt-10,2,20,rt),as(ie,ne-10,nt-1,20,2,rt)})(k,K.x,k.transform.height-K.y,mc)}(this),this.context.setDefault()},uo.prototype.renderLayer=function(l,p,f,m){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||m.length)&&(this.id=f.id,this.gpuTimingStart(f),bl[f.type](l,p,f,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},uo.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var p=this.context.extTimerQuery,f=this.gpuTimers[l.id];f||(f=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),f.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,f.query)}},uo.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},uo.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},uo.prototype.queryGpuTimers=function(l){var p={};for(var f in l){var m=l[f],E=this.context.extTimerQuery,R=E.getQueryObjectEXT(m.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(m.query),p[f]=R}return p},uo.prototype.translatePosMatrix=function(l,p,f,m,E){if(!f[0]&&!f[1])return l;var R=E?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(R){var O=Math.sin(R),$=Math.cos(R);f=[f[0]*$-f[1]*O,f[0]*O+f[1]*$]}var ge=[E?f[0]:Na(p,f[0],this.transform.zoom),E?f[1]:Na(p,f[1],this.transform.zoom),0],Me=new Float32Array(16);return h.translate(Me,l,ge),Me},uo.prototype.saveTileTexture=function(l){var p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]},uo.prototype.getTileTexture=function(l){var p=this._tileTextures[l];return p&&p.length>0?p.pop():null},uo.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var p=this.imageManager.getPattern(l.from.toString()),f=this.imageManager.getPattern(l.to.toString());return!p||!f},uo.prototype.useProgram=function(l,p){this.cache=this.cache||{};var f=""+l+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[f]||(this.cache[f]=new co(this.context,l,jf[l],p,pc[l],this._showOverdrawInspector)),this.cache[f]},uo.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},uo.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},uo.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},uo.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Lc=function(l,p){this.points=l,this.planes=p};Lc.fromInvProjectionMatrix=function(l,p,f){var m=Math.pow(2,f),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(O){return h.transformMat4([],O,l)}).map(function(O){return h.scale$1([],O,1/O[3]/p*m)}),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(O){var $=h.sub([],E[O[0]],E[O[1]]),ge=h.sub([],E[O[2]],E[O[1]]),Me=h.normalize([],h.cross([],$,ge)),Ye=-h.dot(Me,E[O[1]]);return Me.concat(Ye)});return new Lc(E,R)};var Vs=function(l,p){this.min=l,this.max=p,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};Vs.prototype.quadrant=function(l){for(var p=[l%2==0,l<2],f=h.clone$2(this.min),m=h.clone$2(this.max),E=0;E<p.length;E++)f[E]=p[E]?this.min[E]:this.center[E],m[E]=p[E]?this.center[E]:this.max[E];return m[2]=this.max[2],new Vs(f,m)},Vs.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Vs.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Vs.prototype.intersects=function(l){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],f=!0,m=0;m<l.planes.length;m++){for(var E=l.planes[m],R=0,O=0;O<p.length;O++)R+=h.dot$1(E,p[O])>=0;if(R===0)return 0;R!==p.length&&(f=!1)}if(f)return 2;for(var $=0;$<3;$++){for(var ge=Number.MAX_VALUE,Me=-Number.MAX_VALUE,Ye=0;Ye<l.points.length;Ye++){var tt=l.points[Ye][$]-this.min[$];ge=Math.min(ge,tt),Me=Math.max(Me,tt)}if(Me<0||ge>this.max[$]-this.min[$])return 0}return 1};var ul=function(l,p,f,m){if(l===void 0&&(l=0),p===void 0&&(p=0),f===void 0&&(f=0),m===void 0&&(m=0),isNaN(l)||l<0||isNaN(p)||p<0||isNaN(f)||f<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=f,this.right=m};ul.prototype.interpolate=function(l,p,f){return p.top!=null&&l.top!=null&&(this.top=h.number(l.top,p.top,f)),p.bottom!=null&&l.bottom!=null&&(this.bottom=h.number(l.bottom,p.bottom,f)),p.left!=null&&l.left!=null&&(this.left=h.number(l.left,p.left,f)),p.right!=null&&l.right!=null&&(this.right=h.number(l.right,p.right,f)),this},ul.prototype.getCenter=function(l,p){var f=h.clamp((this.left+l-this.right)/2,0,l),m=h.clamp((this.top+p-this.bottom)/2,0,p);return new h.Point(f,m)},ul.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},ul.prototype.clone=function(){return new ul(this.top,this.bottom,this.left,this.right)},ul.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ca=function(l,p,f,m,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=E===void 0||E,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=f==null?0:f,this._maxPitch=m==null?60:m,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ul,this._posMatrixCache={},this._alignedPosMatrixCache={}},lo={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ca.prototype.clone=function(){var l=new Ca(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},lo.minZoom.get=function(){return this._minZoom},lo.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},lo.maxZoom.get=function(){return this._maxZoom},lo.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},lo.minPitch.get=function(){return this._minPitch},lo.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},lo.maxPitch.get=function(){return this._maxPitch},lo.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},lo.renderWorldCopies.get=function(){return this._renderWorldCopies},lo.renderWorldCopies.set=function(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l},lo.worldSize.get=function(){return this.tileSize*this.scale},lo.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},lo.size.get=function(){return new h.Point(this.width,this.height)},lo.bearing.get=function(){return-this.angle/Math.PI*180},lo.bearing.set=function(l){var p=-h.wrap(l,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},lo.pitch.get=function(){return this._pitch/Math.PI*180},lo.pitch.set=function(l){var p=h.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},lo.fov.get=function(){return this._fov/Math.PI*180},lo.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},lo.zoom.get=function(){return this._zoom},lo.zoom.set=function(l){var p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},lo.center.get=function(){return this._center},lo.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},lo.padding.get=function(){return this._edgeInsets.toJSON()},lo.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},lo.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ca.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},Ca.prototype.interpolatePadding=function(l,p,f){this._unmodified=!1,this._edgeInsets.interpolate(l,p,f),this._constrain(),this._calcMatrices()},Ca.prototype.coveringZoomLevel=function(l){var p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)},Ca.prototype.getVisibleUnwrappedCoordinates=function(l){var p=[new h.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var f=this.pointCoordinate(new h.Point(0,0)),m=this.pointCoordinate(new h.Point(this.width,0)),E=this.pointCoordinate(new h.Point(this.width,this.height)),R=this.pointCoordinate(new h.Point(0,this.height)),O=Math.floor(Math.min(f.x,m.x,E.x,R.x)),$=Math.floor(Math.max(f.x,m.x,E.x,R.x)),ge=O-1;ge<=$+1;ge++)ge!==0&&p.push(new h.UnwrappedTileID(ge,l));return p},Ca.prototype.coveringTiles=function(l){var p=this.coveringZoomLevel(l),f=p;if(l.minzoom!==void 0&&p<l.minzoom)return[];l.maxzoom!==void 0&&p>l.maxzoom&&(p=l.maxzoom);var m=h.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,p),R=[E*m.x,E*m.y,0],O=Lc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),$=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&($=p);var ge=function(k){return{aabb:new Vs([k*E,0,0],[(k+1)*E,E,0]),zoom:0,x:0,y:0,wrap:k,fullyVisible:!1}},Me=[],Ye=[],tt=p,ot=l.reparseOverscaled?f:p;if(this._renderWorldCopies)for(var At=1;At<=3;At++)Me.push(ge(-At)),Me.push(ge(At));for(Me.push(ge(0));Me.length>0;){var St=Me.pop(),Zt=St.x,_t=St.y,Vt=St.fullyVisible;if(!Vt){var er=St.aabb.intersects(O);if(er===0)continue;Vt=er===2}var cr=St.aabb.distanceX(R),Rr=St.aabb.distanceY(R),Er=Math.max(Math.abs(cr),Math.abs(Rr));if(St.zoom===tt||Er>3+(1<<tt-St.zoom)-2&&St.zoom>=$)Ye.push({tileID:new h.OverscaledTileID(St.zoom===tt?ot:St.zoom,St.wrap,St.zoom,Zt,_t),distanceSq:h.sqrLen([R[0]-.5-Zt,R[1]-.5-_t])});else for(var Br=0;Br<4;Br++){var tn=(Zt<<1)+Br%2,M=(_t<<1)+(Br>>1);Me.push({aabb:St.aabb.quadrant(Br),zoom:St.zoom+1,x:tn,y:M,wrap:St.wrap,fullyVisible:Vt})}}return Ye.sort(function(k,L){return k.distanceSq-L.distanceSq}).map(function(k){return k.tileID})},Ca.prototype.resize=function(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()},lo.unmodified.get=function(){return this._unmodified},Ca.prototype.zoomScale=function(l){return Math.pow(2,l)},Ca.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},Ca.prototype.project=function(l){var p=h.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(l.lng)*this.worldSize,h.mercatorYfromLat(p)*this.worldSize)},Ca.prototype.unproject=function(l){return new h.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},lo.point.get=function(){return this.project(this.center)},Ca.prototype.setLocationAtPoint=function(l,p){var f=this.pointCoordinate(p),m=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),R=new h.MercatorCoordinate(E.x-(f.x-m.x),E.y-(f.y-m.y));this.center=this.coordinateLocation(R),this._renderWorldCopies&&(this.center=this.center.wrap())},Ca.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},Ca.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},Ca.prototype.locationCoordinate=function(l){return h.MercatorCoordinate.fromLngLat(l)},Ca.prototype.coordinateLocation=function(l){return l.toLngLat()},Ca.prototype.pointCoordinate=function(l){var p=[l.x,l.y,0,1],f=[l.x,l.y,1,1];h.transformMat4(p,p,this.pixelMatrixInverse),h.transformMat4(f,f,this.pixelMatrixInverse);var m=p[3],E=f[3],R=p[1]/m,O=f[1]/E,$=p[2]/m,ge=f[2]/E,Me=$===ge?0:(0-$)/(ge-$);return new h.MercatorCoordinate(h.number(p[0]/m,f[0]/E,Me)/this.worldSize,h.number(R,O,Me)/this.worldSize)},Ca.prototype.coordinatePoint=function(l){var p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return h.transformMat4(p,p,this.pixelMatrix),new h.Point(p[0]/p[3],p[1]/p[3])},Ca.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},Ca.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ca.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ca.prototype.calculatePosMatrix=function(l,p){p===void 0&&(p=!1);var f=l.key,m=p?this._alignedPosMatrixCache:this._posMatrixCache;if(m[f])return m[f];var E=l.canonical,R=this.worldSize/this.zoomScale(E.z),O=E.x+Math.pow(2,E.z)*l.wrap,$=h.identity(new Float64Array(16));return h.translate($,$,[O*R,E.y*R,0]),h.scale($,$,[R/h.EXTENT,R/h.EXTENT,1]),h.multiply($,p?this.alignedProjMatrix:this.projMatrix,$),m[f]=new Float32Array($),m[f]},Ca.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ca.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,p,f,m,E=-90,R=90,O=-180,$=180,ge=this.size,Me=this._unmodified;if(this.latRange){var Ye=this.latRange;E=h.mercatorYfromLat(Ye[1])*this.worldSize,l=(R=h.mercatorYfromLat(Ye[0])*this.worldSize)-E<ge.y?ge.y/(R-E):0}if(this.lngRange){var tt=this.lngRange;O=h.mercatorXfromLng(tt[0])*this.worldSize,p=($=h.mercatorXfromLng(tt[1])*this.worldSize)-O<ge.x?ge.x/($-O):0}var ot=this.point,At=Math.max(p||0,l||0);if(At)return this.center=this.unproject(new h.Point(p?($+O)/2:ot.x,l?(R+E)/2:ot.y)),this.zoom+=this.scaleZoom(At),this._unmodified=Me,void(this._constraining=!1);if(this.latRange){var St=ot.y,Zt=ge.y/2;St-Zt<E&&(m=E+Zt),St+Zt>R&&(m=R-Zt)}if(this.lngRange){var _t=ot.x,Vt=ge.x/2;_t-Vt<O&&(f=O+Vt),_t+Vt>$&&(f=$-Vt)}f===void 0&&m===void 0||(this.center=this.unproject(new h.Point(f!==void 0?f:ot.x,m!==void 0?m:ot.y))),this._unmodified=Me,this._constraining=!1}},Ca.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,f=this._fov*(.5+l.y/this.height),m=Math.sin(f)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-p-f,.01,Math.PI-.01)),E=this.point,R=E.x,O=E.y,$=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),ge=this.height/50,Me=new Float64Array(16);h.perspective(Me,this._fov,this.width/this.height,ge,$),Me[8]=2*-l.x/this.width,Me[9]=2*l.y/this.height,h.scale(Me,Me,[1,-1,1]),h.translate(Me,Me,[0,0,-this.cameraToCenterDistance]),h.rotateX(Me,Me,this._pitch),h.rotateZ(Me,Me,this.angle),h.translate(Me,Me,[-R,-O,0]),this.mercatorMatrix=h.scale([],Me,[this.worldSize,this.worldSize,this.worldSize]),h.scale(Me,Me,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Me,this.invProjMatrix=h.invert([],this.projMatrix);var Ye=this.width%2/2,tt=this.height%2/2,ot=Math.cos(this.angle),At=Math.sin(this.angle),St=R-Math.round(R)+ot*Ye+At*tt,Zt=O-Math.round(O)+ot*tt+At*Ye,_t=new Float64Array(Me);if(h.translate(_t,_t,[St>.5?St-1:St,Zt>.5?Zt-1:Zt,0]),this.alignedProjMatrix=_t,Me=h.create(),h.scale(Me,Me,[this.width/2,-this.height/2,1]),h.translate(Me,Me,[1,-1,0]),this.labelPlaneMatrix=Me,Me=h.create(),h.scale(Me,Me,[1,-1,1]),h.translate(Me,Me,[-1,-1,0]),h.scale(Me,Me,[2/this.width,2/this.height,1]),this.glCoordMatrix=Me,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Me=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Me,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ca.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new h.Point(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return h.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ca.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,l))},Ca.prototype.getCameraQueryGeometry=function(l){var p=this.getCameraPoint();if(l.length===1)return[l[0],p];for(var f=p.x,m=p.y,E=p.x,R=p.y,O=0,$=l;O<$.length;O+=1){var ge=$[O];f=Math.min(f,ge.x),m=Math.min(m,ge.y),E=Math.max(E,ge.x),R=Math.max(R,ge.y)}return[new h.Point(f,m),new h.Point(E,m),new h.Point(E,R),new h.Point(f,R),new h.Point(f,m)]},Object.defineProperties(Ca.prototype,lo);var Xs=function(l){var p,f,m,E;this._hashName=l&&encodeURIComponent(l),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),f=!1,m=null,E=function(){m=null,f&&(p(),m=setTimeout(E,300),f=!1)},function(){return f=!0,m||E(),m})};Xs.prototype.addTo=function(l){return this._map=l,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Xs.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Xs.prototype.getHashString=function(l){var p=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,m=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,m),R=Math.round(p.lng*E)/E,O=Math.round(p.lat*E)/E,$=this._map.getBearing(),ge=this._map.getPitch(),Me="";if(Me+=l?"/"+R+"/"+O+"/"+f:f+"/"+O+"/"+R,($||ge)&&(Me+="/"+Math.round(10*$)/10),ge&&(Me+="/"+Math.round(ge)),this._hashName){var Ye=this._hashName,tt=!1,ot=h.window.location.hash.slice(1).split("&").map(function(At){var St=At.split("=")[0];return St===Ye?(tt=!0,St+"="+Me):At}).filter(function(At){return At});return tt||ot.push(Ye+"="+Me),"#"+ot.join("&")}return"#"+Me},Xs.prototype._getCurrentHash=function(){var l,p=this,f=h.window.location.hash.replace("#","");return this._hashName?(f.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===p._hashName&&(l=m)}),(l&&l[1]||"").split("/")):f.split("/")},Xs.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(f){return isNaN(f)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1},Xs.prototype._updateHashUnthrottled=function(){var l=h.window.location.href.replace(/(#.+)?$/,this.getHashString());try{h.window.history.replaceState(h.window.history.state,null,l)}catch(p){}};var gc={linearity:.3,easing:h.bezier(0,0,.3,1)},Gu=h.extend({deceleration:2500,maxSpeed:1400},gc),vu=h.extend({deceleration:20,maxSpeed:1400},gc),Af=h.extend({deceleration:1e3,maxSpeed:360},gc),Bc=h.extend({deceleration:1e3,maxSpeed:90},gc),yc=function(l){this._map=l,this.clear()};function Fl(l,p){(!l.duration||l.duration<p.duration)&&(l.duration=p.duration,l.easing=p.easing)}function os(l,p,f){var m=f.maxSpeed,E=f.linearity,R=f.deceleration,O=h.clamp(l*E/(p/1e3),-m,m),$=Math.abs(O)/(R*E);return{easing:f.easing,duration:1e3*$,amount:O*($/2)}}yc.prototype.clear=function(){this._inertiaBuffer=[]},yc.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:l})},yc.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,p=h.browser.now();l.length>0&&p-l[0].time>160;)l.shift()},yc.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},f=0,m=this._inertiaBuffer;f<m.length;f+=1){var E=m[f].settings;p.zoom+=E.zoomDelta||0,p.bearing+=E.bearingDelta||0,p.pitch+=E.pitchDelta||0,E.panDelta&&p.pan._add(E.panDelta),E.around&&(p.around=E.around),E.pinchAround&&(p.pinchAround=E.pinchAround)}var R=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(p.pan.mag()){var $=os(p.pan.mag(),R,h.extend({},Gu,l||{}));O.offset=p.pan.mult($.amount/p.pan.mag()),O.center=this._map.transform.center,Fl(O,$)}if(p.zoom){var ge=os(p.zoom,R,vu);O.zoom=this._map.transform.zoom+ge.amount,Fl(O,ge)}if(p.bearing){var Me=os(p.bearing,R,Af);O.bearing=this._map.transform.bearing+h.clamp(Me.amount,-179,179),Fl(O,Me)}if(p.pitch){var Ye=os(p.pitch,R,Bc);O.pitch=this._map.transform.pitch+Ye.amount,Fl(O,Ye)}if(O.zoom||O.bearing){var tt=p.pinchAround===void 0?p.around:p.pinchAround;O.around=tt?this._map.unproject(tt):this._map.getCenter()}return this.clear(),h.extend(O,{noMoveStart:!0})}};var So=function(l){function p(m,E,R,O){O===void 0&&(O={});var $=P.mousePos(E.getCanvasContainer(),R),ge=E.unproject($);l.call(this,m,h.extend({point:$,lngLat:ge,originalEvent:R},O)),this._defaultPrevented=!1,this.target=E}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var f={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,f),p}(h.Event),Nl=function(l){function p(m,E,R){var O=m==="touchend"?R.changedTouches:R.touches,$=P.touchPos(E.getCanvasContainer(),O),ge=$.map(function(tt){return E.unproject(tt)}),Me=$.reduce(function(tt,ot,At,St){return tt.add(ot.div(St.length))},new h.Point(0,0)),Ye=E.unproject(Me);l.call(this,m,{points:$,point:Me,lngLats:ge,lngLat:Ye,originalEvent:R}),this._defaultPrevented=!1}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var f={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,f),p}(h.Event),af=function(l){function p(m,E,R){l.call(this,m,{originalEvent:R}),this._defaultPrevented=!1}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var f={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,f),p}(h.Event),wo=function(l,p){this._map=l,this._clickTolerance=p.clickTolerance};wo.prototype.reset=function(){delete this._mousedownPos},wo.prototype.wheel=function(l){return this._firePreventable(new af(l.type,this._map,l))},wo.prototype.mousedown=function(l,p){return this._mousedownPos=p,this._firePreventable(new So(l.type,this._map,l))},wo.prototype.mouseup=function(l){this._map.fire(new So(l.type,this._map,l))},wo.prototype.click=function(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new So(l.type,this._map,l))},wo.prototype.dblclick=function(l){return this._firePreventable(new So(l.type,this._map,l))},wo.prototype.mouseover=function(l){this._map.fire(new So(l.type,this._map,l))},wo.prototype.mouseout=function(l){this._map.fire(new So(l.type,this._map,l))},wo.prototype.touchstart=function(l){return this._firePreventable(new Nl(l.type,this._map,l))},wo.prototype.touchmove=function(l){this._map.fire(new Nl(l.type,this._map,l))},wo.prototype.touchend=function(l){this._map.fire(new Nl(l.type,this._map,l))},wo.prototype.touchcancel=function(l){this._map.fire(new Nl(l.type,this._map,l))},wo.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},wo.prototype.isEnabled=function(){return!0},wo.prototype.isActive=function(){return!1},wo.prototype.enable=function(){},wo.prototype.disable=function(){};var ii=function(l){this._map=l};ii.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ii.prototype.mousemove=function(l){this._map.fire(new So(l.type,this._map,l))},ii.prototype.mousedown=function(){this._delayContextMenu=!0},ii.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new So("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ii.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new So(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},ii.prototype.isEnabled=function(){return!0},ii.prototype.isActive=function(){return!1},ii.prototype.enable=function(){},ii.prototype.disable=function(){};var Ms=function(l,p){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1};function tc(l,p){for(var f={},m=0;m<l.length;m++)f[l[m].identifier]=p[m];return f}Ms.prototype.isEnabled=function(){return!!this._enabled},Ms.prototype.isActive=function(){return!!this._active},Ms.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ms.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ms.prototype.mousedown=function(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(P.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},Ms.prototype.mousemoveWindow=function(l,p){if(this._active){var f=p;if(!(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=f,this._box||(this._box=P.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var E=Math.min(m.x,f.x),R=Math.max(m.x,f.x),O=Math.min(m.y,f.y),$=Math.max(m.y,f.y);P.setTransform(this._box,"translate("+E+"px,"+O+"px)"),this._box.style.width=R-E+"px",this._box.style.height=$-O+"px"}}},Ms.prototype.mouseupWindow=function(l,p){var f=this;if(this._active&&l.button===0){var m=this._startPos,E=p;if(this.reset(),P.suppressClick(),m.x!==E.x||m.y!==E.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(R){return R.fitScreenCoordinates(m,E,f._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},Ms.prototype.keydown=function(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))},Ms.prototype.blur=function(){this.reset()},Ms.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(P.remove(this._box),this._box=null),P.enableDrag(),delete this._startPos,delete this._lastPos},Ms.prototype._fireEvent=function(l,p){return this._map.fire(new h.Event(l,{originalEvent:p}))};var Ul=function(l){this.reset(),this.numTouches=l.numTouches};Ul.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ul.prototype.touchstart=function(l,p,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),f.length===this.numTouches&&(this.centroid=function(m){for(var E=new h.Point(0,0),R=0,O=m;R<O.length;R+=1)E._add(O[R]);return E.div(m.length)}(p),this.touches=tc(f,p)))},Ul.prototype.touchmove=function(l,p,f){if(!this.aborted&&this.centroid){var m=tc(f,p);for(var E in this.touches){var R=m[E];(!R||R.dist(this.touches[E])>30)&&(this.aborted=!0)}}},Ul.prototype.touchend=function(l,p,f){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var ps=function(l){this.singleTap=new Ul(l),this.numTaps=l.numTaps,this.reset()};ps.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ps.prototype.touchstart=function(l,p,f){this.singleTap.touchstart(l,p,f)},ps.prototype.touchmove=function(l,p,f){this.singleTap.touchmove(l,p,f)},ps.prototype.touchend=function(l,p,f){var m=this.singleTap.touchend(l,p,f);if(m){var E=l.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(m)<30;if(E&&R||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var to=function(){this._zoomIn=new ps({numTouches:1,numTaps:2}),this._zoomOut=new ps({numTouches:2,numTaps:1}),this.reset()};to.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},to.prototype.touchstart=function(l,p,f){this._zoomIn.touchstart(l,p,f),this._zoomOut.touchstart(l,p,f)},to.prototype.touchmove=function(l,p,f){this._zoomIn.touchmove(l,p,f),this._zoomOut.touchmove(l,p,f)},to.prototype.touchend=function(l,p,f){var m=this,E=this._zoomIn.touchend(l,p,f),R=this._zoomOut.touchend(l,p,f);return E?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(O){return O.easeTo({duration:300,zoom:O.getZoom()+1,around:O.unproject(E)},{originalEvent:l})}}):R?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(O){return O.easeTo({duration:300,zoom:O.getZoom()-1,around:O.unproject(R)},{originalEvent:l})}}):void 0},to.prototype.touchcancel=function(){this.reset()},to.prototype.enable=function(){this._enabled=!0},to.prototype.disable=function(){this._enabled=!1,this.reset()},to.prototype.isEnabled=function(){return this._enabled},to.prototype.isActive=function(){return this._active};var zl={0:1,2:2},S=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};S.prototype.blur=function(){this.reset()},S.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},S.prototype._correctButton=function(l,p){return!1},S.prototype._move=function(l,p){return{}},S.prototype.mousedown=function(l,p){if(!this._lastPoint){var f=P.mouseButton(l);this._correctButton(l,f)&&(this._lastPoint=p,this._eventButton=f)}},S.prototype.mousemoveWindow=function(l,p){var f=this._lastPoint;if(f){if(l.preventDefault(),function(m,E){var R=zl[E];return m.buttons===void 0||(m.buttons&R)!==R}(l,this._eventButton))this.reset();else if(this._moved||!(p.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(f,p)}},S.prototype.mouseupWindow=function(l){this._lastPoint&&P.mouseButton(l)===this._eventButton&&(this._moved&&P.suppressClick(),this.reset())},S.prototype.enable=function(){this._enabled=!0},S.prototype.disable=function(){this._enabled=!1,this.reset()},S.prototype.isEnabled=function(){return this._enabled},S.prototype.isActive=function(){return this._active};var Ge=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.mousedown=function(f,m){l.prototype.mousedown.call(this,f,m),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(f,m){return m===0&&!f.ctrlKey},p.prototype._move=function(f,m){return{around:m,panDelta:m.sub(f)}},p}(S),re=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype._correctButton=function(f,m){return m===0&&f.ctrlKey||m===2},p.prototype._move=function(f,m){var E=.8*(m.x-f.x);if(E)return this._active=!0,{bearingDelta:E}},p.prototype.contextmenu=function(f){f.preventDefault()},p}(S),ce=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype._correctButton=function(f,m){return m===0&&f.ctrlKey||m===2},p.prototype._move=function(f,m){var E=-.5*(m.y-f.y);if(E)return this._active=!0,{pitchDelta:E}},p.prototype.contextmenu=function(f){f.preventDefault()},p}(S),G=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};G.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},G.prototype.touchstart=function(l,p,f){return this._calculateTransform(l,p,f)},G.prototype.touchmove=function(l,p,f){if(this._active&&!(f.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,p,f)},G.prototype.touchend=function(l,p,f){this._calculateTransform(l,p,f),this._active&&f.length<this._minTouches&&this.reset()},G.prototype.touchcancel=function(){this.reset()},G.prototype._calculateTransform=function(l,p,f){f.length>0&&(this._active=!0);var m=tc(f,p),E=new h.Point(0,0),R=new h.Point(0,0),O=0;for(var $ in m){var ge=m[$],Me=this._touches[$];Me&&(E._add(ge),R._add(ge.sub(Me)),O++,m[$]=ge)}if(this._touches=m,!(O<this._minTouches)&&R.mag()){var Ye=R.div(O);if(this._sum._add(Ye),!(this._sum.mag()<this._clickTolerance))return{around:E.div(O),panDelta:Ye}}},G.prototype.enable=function(){this._enabled=!0},G.prototype.disable=function(){this._enabled=!1,this.reset()},G.prototype.isEnabled=function(){return this._enabled},G.prototype.isActive=function(){return this._active};var xe=function(){this.reset()};function ut(l,p,f){for(var m=0;m<l.length;m++)if(l[m].identifier===f)return p[m]}function Dt(l,p){return Math.log(l/p)/Math.LN2}xe.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},xe.prototype._start=function(l){},xe.prototype._move=function(l,p,f){return{}},xe.prototype.touchstart=function(l,p,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([p[0],p[1]]))},xe.prototype.touchmove=function(l,p,f){if(this._firstTwoTouches){l.preventDefault();var m=this._firstTwoTouches,E=m[1],R=ut(f,p,m[0]),O=ut(f,p,E);if(R&&O){var $=this._aroundCenter?null:R.add(O).div(2);return this._move([R,O],$,l)}}},xe.prototype.touchend=function(l,p,f){if(this._firstTwoTouches){var m=this._firstTwoTouches,E=m[1],R=ut(f,p,m[0]),O=ut(f,p,E);R&&O||(this._active&&P.suppressClick(),this.reset())}},xe.prototype.touchcancel=function(){this.reset()},xe.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"},xe.prototype.disable=function(){this._enabled=!1,this.reset()},xe.prototype.isEnabled=function(){return this._enabled},xe.prototype.isActive=function(){return this._active};var dt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(f){this._startDistance=this._distance=f[0].dist(f[1])},p.prototype._move=function(f,m){var E=this._distance;if(this._distance=f[0].dist(f[1]),this._active||!(Math.abs(Dt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dt(this._distance,E),pinchAround:m}},p}(xe);function It(l,p){return 180*l.angleWith(p)/Math.PI}var Tr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(f){this._startVector=this._vector=f[0].sub(f[1]),this._minDiameter=f[0].dist(f[1])},p.prototype._move=function(f,m){var E=this._vector;if(this._vector=f[0].sub(f[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:It(this._vector,E),pinchAround:m}},p.prototype._isBelowThreshold=function(f){this._minDiameter=Math.min(this._minDiameter,f.mag());var m=25/(Math.PI*this._minDiameter)*360,E=It(f,this._startVector);return Math.abs(E)<m},p}(xe);function Yr(l){return Math.abs(l.y)>Math.abs(l.x)}var wn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(f){this._lastPoints=f,Yr(f[0].sub(f[1]))&&(this._valid=!1)},p.prototype._move=function(f,m,E){var R=f[0].sub(this._lastPoints[0]),O=f[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(R,O,E.timeStamp),this._valid)return this._lastPoints=f,this._active=!0,{pitchDelta:(R.y+O.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(f,m,E){if(this._valid!==void 0)return this._valid;var R=f.mag()>=2,O=m.mag()>=2;if(R||O){if(!R||!O)return this._firstMove===void 0&&(this._firstMove=E),E-this._firstMove<100&&void 0;var $=f.y>0==m.y>0;return Yr(f)&&Yr(m)&&$}},p}(xe),Bn={panStep:100,bearingStep:15,pitchStep:10},Kn=function(){var l=Bn;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function fi(l){return l*(2-l)}Kn.prototype.blur=function(){this.reset()},Kn.prototype.reset=function(){this._active=!1},Kn.prototype.keydown=function(l){var p=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var f=0,m=0,E=0,R=0,O=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),R=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),R=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),O=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(m=0,E=0),{cameraAnimation:function($){var ge=$.getZoom();$.easeTo({duration:300,easeId:"keyboardHandler",easing:fi,zoom:f?Math.round(ge)+f*(l.shiftKey?2:1):ge,bearing:$.getBearing()+m*p._bearingStep,pitch:$.getPitch()+E*p._pitchStep,offset:[-R*p._panStep,-O*p._panStep],center:$.getCenter()},{originalEvent:l})}}}},Kn.prototype.enable=function(){this._enabled=!0},Kn.prototype.disable=function(){this._enabled=!1,this.reset()},Kn.prototype.isEnabled=function(){return this._enabled},Kn.prototype.isActive=function(){return this._active},Kn.prototype.disableRotation=function(){this._rotationDisabled=!0},Kn.prototype.enableRotation=function(){this._rotationDisabled=!1};var Gr=function(l,p){this._map=l,this._el=l.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};Gr.prototype.setZoomRate=function(l){this._defaultZoomRate=l},Gr.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},Gr.prototype.isEnabled=function(){return!!this._enabled},Gr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Gr.prototype.isZooming=function(){return!!this._zooming},Gr.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")},Gr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gr.prototype.wheel=function(l){if(this.isEnabled()){var p=l.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,f=h.browser.now(),m=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,p!==0&&p%4.000244140625==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(m*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}},Gr.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},Gr.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=P.mousePos(this._el,l);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Gr.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(this._delta!==0){var f=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*f)));this._delta<0&&m!==0&&(m=1/m);var E=typeof this._targetZoom=="number"?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(E*m))),this._type==="wheel"&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var R,O=typeof this._targetZoom=="number"?this._targetZoom:p.zoom,$=this._startZoom,ge=this._easing,Me=!1;if(this._type==="wheel"&&$&&ge){var Ye=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),tt=ge(Ye);R=h.number($,O,tt),Ye<1?this._frameId||(this._frameId=!0):Me=!0}else R=O,Me=!0;return this._active=!0,Me&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Me,zoomDelta:R-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Gr.prototype._smoothOutEasing=function(l){var p=h.ease;if(this._prevEase){var f=this._prevEase,m=(h.browser.now()-f.start)/f.duration,E=f.easing(m+.01)-f.easing(m),R=.27/Math.sqrt(E*E+1e-4)*.01,O=Math.sqrt(.0729-R*R);p=h.bezier(R,O,.25,1)}return this._prevEase={start:h.browser.now(),duration:l,easing:p},p},Gr.prototype.blur=function(){this.reset()},Gr.prototype.reset=function(){this._active=!1};var Ri=function(l,p){this._clickZoom=l,this._tapZoom=p};Ri.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ri.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ri.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ri.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Pi=function(){this.reset()};Pi.prototype.reset=function(){this._active=!1},Pi.prototype.blur=function(){this.reset()},Pi.prototype.dblclick=function(l,p){return l.preventDefault(),{cameraAnimation:function(f){f.easeTo({duration:300,zoom:f.getZoom()+(l.shiftKey?-1:1),around:f.unproject(p)},{originalEvent:l})}}},Pi.prototype.enable=function(){this._enabled=!0},Pi.prototype.disable=function(){this._enabled=!1,this.reset()},Pi.prototype.isEnabled=function(){return this._enabled},Pi.prototype.isActive=function(){return this._active};var Mi=function(){this._tap=new ps({numTouches:1,numTaps:1}),this.reset()};Mi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Mi.prototype.touchstart=function(l,p,f){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=p[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(l,p,f))},Mi.prototype.touchmove=function(l,p,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;var m=p[0],E=m.y-this._swipePoint.y;return this._swipePoint=m,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,p,f)},Mi.prototype.touchend=function(l,p,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(l,p,f)&&(this._tapTime=l.timeStamp)},Mi.prototype.touchcancel=function(){this.reset()},Mi.prototype.enable=function(){this._enabled=!0},Mi.prototype.disable=function(){this._enabled=!1,this.reset()},Mi.prototype.isEnabled=function(){return this._enabled},Mi.prototype.isActive=function(){return this._active};var wa=function(l,p,f){this._el=l,this._mousePan=p,this._touchPan=f};wa.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},wa.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},wa.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},wa.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ja=function(l,p,f){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=f};Ja.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ja.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ja.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ja.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var La=function(l,p,f,m){this._el=l,this._touchZoom=p,this._touchRotate=f,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0};La.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},La.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},La.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},La.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},La.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},La.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ya=function(l){return l.zoom||l.drag||l.pitch||l.rotate},Gi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p}(h.Event);function zn(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var Fn=function(l,p){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yc(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),h.bindAll(["handleEvent","handleWindowEvent"],this);var f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[h.window,"blur",void 0]];for(var m=0,E=this._listeners;m<E.length;m+=1){var R=E[m],O=R[0];P.addEventListener(O,R[1],O===h.window.document?this.handleWindowEvent:this.handleEvent,R[2])}};Fn.prototype.destroy=function(){for(var l=0,p=this._listeners;l<p.length;l+=1){var f=p[l],m=f[0];P.removeEventListener(m,f[1],m===h.window.document?this.handleWindowEvent:this.handleEvent,f[2])}},Fn.prototype._addDefaultHandlers=function(l){var p=this._map,f=p.getCanvasContainer();this._add("mapEvent",new wo(p,l));var m=p.boxZoom=new Ms(p,l);this._add("boxZoom",m);var E=new to,R=new Pi;p.doubleClickZoom=new Ri(R,E),this._add("tapZoom",E),this._add("clickZoom",R);var O=new Mi;this._add("tapDragZoom",O);var $=p.touchPitch=new wn;this._add("touchPitch",$);var ge=new re(l),Me=new ce(l);p.dragRotate=new Ja(l,ge,Me),this._add("mouseRotate",ge,["mousePitch"]),this._add("mousePitch",Me,["mouseRotate"]);var Ye=new Ge(l),tt=new G(l);p.dragPan=new wa(f,Ye,tt),this._add("mousePan",Ye),this._add("touchPan",tt,["touchZoom","touchRotate"]);var ot=new Tr,At=new dt;p.touchZoomRotate=new La(f,At,ot,O),this._add("touchRotate",ot,["touchPan","touchZoom"]),this._add("touchZoom",At,["touchPan","touchRotate"]);var St=p.scrollZoom=new Gr(p,this);this._add("scrollZoom",St,["mousePan"]);var Zt=p.keyboard=new Kn;this._add("keyboard",Zt),this._add("blockableMapEvent",new ii(p));for(var _t=0,Vt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];_t<Vt.length;_t+=1){var er=Vt[_t];l.interactive&&l[er]&&p[er].enable(l[er])}},Fn.prototype._add=function(l,p,f){this._handlers.push({handlerName:l,handler:p,allowed:f}),this._handlersById[l]=p},Fn.prototype.stop=function(l){if(!this._updatingCamera){for(var p=0,f=this._handlers;p<f.length;p+=1)f[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},Fn.prototype.isActive=function(){for(var l=0,p=this._handlers;l<p.length;l+=1)if(p[l].handler.isActive())return!0;return!1},Fn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Fn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Fn.prototype.isMoving=function(){return!!ya(this._eventsInProgress)||this.isZooming()},Fn.prototype._blockedByActive=function(l,p,f){for(var m in l)if(m!==f&&(!p||p.indexOf(m)<0))return!0;return!1},Fn.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},Fn.prototype._getMapTouches=function(l){for(var p=[],f=0,m=l;f<m.length;f+=1){var E=m[f];this._el.contains(E.target)&&p.push(E)}return p},Fn.prototype.handleEvent=function(l,p){this._updatingCamera=!0;for(var f=l.type==="renderFrame"?void 0:l,m={needsRenderFrame:!1},E={},R={},O=l.touches?this._getMapTouches(l.touches):void 0,$=O?P.touchPos(this._el,O):P.mousePos(this._el,l),ge=0,Me=this._handlers;ge<Me.length;ge+=1){var Ye=Me[ge],tt=Ye.handlerName,ot=Ye.handler,At=Ye.allowed;if(ot.isEnabled()){var St=void 0;this._blockedByActive(R,At,tt)?ot.reset():ot[p||l.type]&&(St=ot[p||l.type](l,$,O),this.mergeHandlerResult(m,E,St,tt,f),St&&St.needsRenderFrame&&this._triggerRenderFrame()),(St||ot.isActive())&&(R[tt]=ot)}}var Zt={};for(var _t in this._previousActiveHandlers)R[_t]||(Zt[_t]=f);this._previousActiveHandlers=R,(Object.keys(Zt).length||zn(m))&&(this._changes.push([m,E,Zt]),this._triggerRenderFrame()),(Object.keys(R).length||zn(m))&&this._map._stop(!0),this._updatingCamera=!1;var Vt=m.cameraAnimation;Vt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Vt(this._map))},Fn.prototype.mergeHandlerResult=function(l,p,f,m,E){if(f){h.extend(l,f);var R={handlerName:m,originalEvent:f.originalEvent||E};f.zoomDelta!==void 0&&(p.zoom=R),f.panDelta!==void 0&&(p.drag=R),f.pitchDelta!==void 0&&(p.pitch=R),f.bearingDelta!==void 0&&(p.rotate=R)}},Fn.prototype._applyChanges=function(){for(var l={},p={},f={},m=0,E=this._changes;m<E.length;m+=1){var R=E[m],O=R[0],$=R[1],ge=R[2];O.panDelta&&(l.panDelta=(l.panDelta||new h.Point(0,0))._add(O.panDelta)),O.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(l.around=O.around),O.pinchAround!==void 0&&(l.pinchAround=O.pinchAround),O.noInertia&&(l.noInertia=O.noInertia),h.extend(p,$),h.extend(f,ge)}this._updateMapTransform(l,p,f),this._changes=[]},Fn.prototype._updateMapTransform=function(l,p,f){var m=this._map,E=m.transform;if(!zn(l))return this._fireEvents(p,f,!0);var R=l.panDelta,O=l.zoomDelta,$=l.bearingDelta,ge=l.pitchDelta,Me=l.around,Ye=l.pinchAround;Ye!==void 0&&(Me=Ye),m._stop(!0),Me=Me||m.transform.centerPoint;var tt=E.pointLocation(R?Me.sub(R):Me);$&&(E.bearing+=$),ge&&(E.pitch+=ge),O&&(E.zoom+=O),E.setLocationAtPoint(tt,Me),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,f,!0)},Fn.prototype._fireEvents=function(l,p,f){var m=this,E=ya(this._eventsInProgress),R=ya(l),O={};for(var $ in l)this._eventsInProgress[$]||(O[$+"start"]=l[$].originalEvent),this._eventsInProgress[$]=l[$];for(var ge in!E&&R&&this._fireEvent("movestart",R.originalEvent),O)this._fireEvent(ge,O[ge]);for(var Me in R&&this._fireEvent("move",R.originalEvent),l)this._fireEvent(Me,l[Me].originalEvent);var Ye,tt={};for(var ot in this._eventsInProgress){var At=this._eventsInProgress[ot],St=At.handlerName,Zt=At.originalEvent;this._handlersById[St].isActive()||(delete this._eventsInProgress[ot],tt[ot+"end"]=Ye=p[St]||Zt)}for(var _t in tt)this._fireEvent(_t,tt[_t]);var Vt=ya(this._eventsInProgress);if(f&&(E||R)&&!Vt){this._updatingCamera=!0;var er=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),cr=function(Rr){return Rr!==0&&-m._bearingSnap<Rr&&Rr<m._bearingSnap};er?(cr(er.bearing||this._map.getBearing())&&(er.bearing=0),this._map.easeTo(er,{originalEvent:Ye})):(this._map.fire(new h.Event("moveend",{originalEvent:Ye})),cr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Fn.prototype._fireEvent=function(l,p){this._map.fire(new h.Event(l,p?{originalEvent:p}:{}))},Fn.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete l._frameId,l.handleEvent(new Gi("renderFrame",{timeStamp:p})),l._applyChanges()})},Fn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var $a=function(l){function p(f,m){l.call(this),this._moving=!1,this._zooming=!1,this.transform=f,this._bearingSnap=m.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(f,m){return this.jumpTo({center:f},m)},p.prototype.panBy=function(f,m,E){return f=h.Point.convert(f).mult(-1),this.panTo(this.transform.center,h.extend({offset:f},m),E)},p.prototype.panTo=function(f,m,E){return this.easeTo(h.extend({center:f},m),E)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(f,m){return this.jumpTo({zoom:f},m),this},p.prototype.zoomTo=function(f,m,E){return this.easeTo(h.extend({zoom:f},m),E)},p.prototype.zoomIn=function(f,m){return this.zoomTo(this.getZoom()+1,f,m),this},p.prototype.zoomOut=function(f,m){return this.zoomTo(this.getZoom()-1,f,m),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(f,m){return this.jumpTo({bearing:f},m),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(f,m){return this.jumpTo({padding:f},m),this},p.prototype.rotateTo=function(f,m,E){return this.easeTo(h.extend({bearing:f},m),E)},p.prototype.resetNorth=function(f,m){return this.rotateTo(0,h.extend({duration:1e3},f),m),this},p.prototype.resetNorthPitch=function(f,m){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},f),m),this},p.prototype.snapToNorth=function(f,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(f,m):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(f,m){return this.jumpTo({pitch:f},m),this},p.prototype.cameraForBounds=function(f,m){f=h.LngLatBounds.convert(f);var E=m&&m.bearing||0;return this._cameraForBoxAndBearing(f.getNorthWest(),f.getSouthEast(),E,m)},p.prototype._cameraForBoxAndBearing=function(f,m,E,R){var O={top:0,bottom:0,right:0,left:0};if(typeof(R=h.extend({padding:O,offset:[0,0],maxZoom:this.transform.maxZoom},R)).padding=="number"){var $=R.padding;R.padding={top:$,bottom:$,right:$,left:$}}R.padding=h.extend(O,R.padding);var ge=this.transform,Me=ge.padding,Ye=ge.project(h.LngLat.convert(f)),tt=ge.project(h.LngLat.convert(m)),ot=Ye.rotate(-E*Math.PI/180),At=tt.rotate(-E*Math.PI/180),St=new h.Point(Math.max(ot.x,At.x),Math.max(ot.y,At.y)),Zt=new h.Point(Math.min(ot.x,At.x),Math.min(ot.y,At.y)),_t=St.sub(Zt),Vt=(ge.width-(Me.left+Me.right+R.padding.left+R.padding.right))/_t.x,er=(ge.height-(Me.top+Me.bottom+R.padding.top+R.padding.bottom))/_t.y;if(!(er<0||Vt<0)){var cr=Math.min(ge.scaleZoom(ge.scale*Math.min(Vt,er)),R.maxZoom),Rr=typeof R.offset.x=="number"?new h.Point(R.offset.x,R.offset.y):h.Point.convert(R.offset),Er=new h.Point((R.padding.left-R.padding.right)/2,(R.padding.top-R.padding.bottom)/2).rotate(E*Math.PI/180),Br=Rr.add(Er).mult(ge.scale/ge.zoomScale(cr));return{center:ge.unproject(Ye.add(tt).div(2).sub(Br)),zoom:cr,bearing:E}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(f,m,E){return this._fitInternal(this.cameraForBounds(f,m),m,E)},p.prototype.fitScreenCoordinates=function(f,m,E,R,O){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(f)),this.transform.pointLocation(h.Point.convert(m)),E,R),R,O)},p.prototype._fitInternal=function(f,m,E){return f?(delete(m=h.extend(f,m)).padding,m.linear?this.easeTo(m,E):this.flyTo(m,E)):this},p.prototype.jumpTo=function(f,m){this.stop();var E=this.transform,R=!1,O=!1,$=!1;return"zoom"in f&&E.zoom!==+f.zoom&&(R=!0,E.zoom=+f.zoom),f.center!==void 0&&(E.center=h.LngLat.convert(f.center)),"bearing"in f&&E.bearing!==+f.bearing&&(O=!0,E.bearing=+f.bearing),"pitch"in f&&E.pitch!==+f.pitch&&($=!0,E.pitch=+f.pitch),f.padding==null||E.isPaddingEqual(f.padding)||(E.padding=f.padding),this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),R&&this.fire(new h.Event("zoomstart",m)).fire(new h.Event("zoom",m)).fire(new h.Event("zoomend",m)),O&&this.fire(new h.Event("rotatestart",m)).fire(new h.Event("rotate",m)).fire(new h.Event("rotateend",m)),$&&this.fire(new h.Event("pitchstart",m)).fire(new h.Event("pitch",m)).fire(new h.Event("pitchend",m)),this.fire(new h.Event("moveend",m))},p.prototype.easeTo=function(f,m){var E=this;this._stop(!1,f.easeId),((f=h.extend({offset:[0,0],duration:500,easing:h.ease},f)).animate===!1||!f.essential&&h.browser.prefersReducedMotion)&&(f.duration=0);var R=this.transform,O=this.getZoom(),$=this.getBearing(),ge=this.getPitch(),Me=this.getPadding(),Ye="zoom"in f?+f.zoom:O,tt="bearing"in f?this._normalizeBearing(f.bearing,$):$,ot="pitch"in f?+f.pitch:ge,At="padding"in f?f.padding:R.padding,St=h.Point.convert(f.offset),Zt=R.centerPoint.add(St),_t=R.pointLocation(Zt),Vt=h.LngLat.convert(f.center||_t);this._normalizeCenter(Vt);var er,cr,Rr=R.project(_t),Er=R.project(Vt).sub(Rr),Br=R.zoomScale(Ye-O);f.around&&(er=h.LngLat.convert(f.around),cr=R.locationPoint(er));var tn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ye!==O,this._rotating=this._rotating||$!==tt,this._pitching=this._pitching||ot!==ge,this._padding=!R.isPaddingEqual(At),this._easeId=f.easeId,this._prepareEase(m,f.noMoveStart,tn),this._ease(function(M){if(E._zooming&&(R.zoom=h.number(O,Ye,M)),E._rotating&&(R.bearing=h.number($,tt,M)),E._pitching&&(R.pitch=h.number(ge,ot,M)),E._padding&&(R.interpolatePadding(Me,At,M),Zt=R.centerPoint.add(St)),er)R.setLocationAtPoint(er,cr);else{var k=R.zoomScale(R.zoom-O),L=Ye>O?Math.min(2,Br):Math.max(.5,Br),K=Math.pow(L,1-M),ie=R.unproject(Rr.add(Er.mult(M*K)).mult(k));R.setLocationAtPoint(R.renderWorldCopies?ie.wrap():ie,Zt)}E._fireMoveEvents(m)},function(M){E._afterEase(m,M)},f),this},p.prototype._prepareEase=function(f,m,E){E===void 0&&(E={}),this._moving=!0,m||E.moving||this.fire(new h.Event("movestart",f)),this._zooming&&!E.zooming&&this.fire(new h.Event("zoomstart",f)),this._rotating&&!E.rotating&&this.fire(new h.Event("rotatestart",f)),this._pitching&&!E.pitching&&this.fire(new h.Event("pitchstart",f))},p.prototype._fireMoveEvents=function(f){this.fire(new h.Event("move",f)),this._zooming&&this.fire(new h.Event("zoom",f)),this._rotating&&this.fire(new h.Event("rotate",f)),this._pitching&&this.fire(new h.Event("pitch",f))},p.prototype._afterEase=function(f,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var E=this._zooming,R=this._rotating,O=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new h.Event("zoomend",f)),R&&this.fire(new h.Event("rotateend",f)),O&&this.fire(new h.Event("pitchend",f)),this.fire(new h.Event("moveend",f))}},p.prototype.flyTo=function(f,m){var E=this;if(!f.essential&&h.browser.prefersReducedMotion){var R=h.pick(f,["center","zoom","bearing","pitch","around"]);return this.jumpTo(R,m)}this.stop(),f=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},f);var O=this.transform,$=this.getZoom(),ge=this.getBearing(),Me=this.getPitch(),Ye=this.getPadding(),tt="zoom"in f?h.clamp(+f.zoom,O.minZoom,O.maxZoom):$,ot="bearing"in f?this._normalizeBearing(f.bearing,ge):ge,At="pitch"in f?+f.pitch:Me,St="padding"in f?f.padding:O.padding,Zt=O.zoomScale(tt-$),_t=h.Point.convert(f.offset),Vt=O.centerPoint.add(_t),er=O.pointLocation(Vt),cr=h.LngLat.convert(f.center||er);this._normalizeCenter(cr);var Rr=O.project(er),Er=O.project(cr).sub(Rr),Br=f.curve,tn=Math.max(O.width,O.height),M=tn/Zt,k=Er.mag();if("minZoom"in f){var L=h.clamp(Math.min(f.minZoom,$,tt),O.minZoom,O.maxZoom),K=tn/O.zoomScale(L-$);Br=Math.sqrt(K/k*2)}var ie=Br*Br;function ne(on){var Kr=(M*M-tn*tn+(on?-1:1)*ie*ie*k*k)/(2*(on?M:tn)*ie*k);return Math.log(Math.sqrt(Kr*Kr+1)-Kr)}function nt(on){return(Math.exp(on)-Math.exp(-on))/2}function rt(on){return(Math.exp(on)+Math.exp(-on))/2}var jt=ne(0),ct=function(on){return rt(jt)/rt(jt+Br*on)},Yt=function(on){return tn*((rt(jt)*(nt(Kr=jt+Br*on)/rt(Kr))-nt(jt))/ie)/k;var Kr},ar=(ne(1)-jt)/Br;if(Math.abs(k)<1e-6||!isFinite(ar)){if(Math.abs(tn-M)<1e-6)return this.easeTo(f,m);var fn=M<tn?-1:1;ar=Math.abs(Math.log(M/tn))/Br,Yt=function(){return 0},ct=function(on){return Math.exp(fn*Br*on)}}return f.duration="duration"in f?+f.duration:1e3*ar/("screenSpeed"in f?+f.screenSpeed/Br:+f.speed),f.maxDuration&&f.duration>f.maxDuration&&(f.duration=0),this._zooming=!0,this._rotating=ge!==ot,this._pitching=At!==Me,this._padding=!O.isPaddingEqual(St),this._prepareEase(m,!1),this._ease(function(on){var Kr=on*ar,Gn=1/ct(Kr);O.zoom=on===1?tt:$+O.scaleZoom(Gn),E._rotating&&(O.bearing=h.number(ge,ot,on)),E._pitching&&(O.pitch=h.number(Me,At,on)),E._padding&&(O.interpolatePadding(Ye,St,on),Vt=O.centerPoint.add(_t));var Zn=on===1?cr:O.unproject(Rr.add(Er.mult(Yt(Kr))).mult(Gn));O.setLocationAtPoint(O.renderWorldCopies?Zn.wrap():Zn,Vt),E._fireMoveEvents(m)},function(){return E._afterEase(m)},f),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(f,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,m)}if(!f){var R=this.handlers;R&&R.stop(!1)}return this},p.prototype._ease=function(f,m,E){E.animate===!1||E.duration===0?(f(1),m()):(this._easeStart=h.browser.now(),this._easeOptions=E,this._onEaseFrame=f,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var f=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(f,m){f=h.wrap(f,-180,180);var E=Math.abs(f-m);return Math.abs(f-360-m)<E&&(f-=360),Math.abs(f+360-m)<E&&(f+=360),f},p.prototype._normalizeCenter=function(f){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var E=f.lng-m.center.lng;f.lng+=E>180?-360:E<-180?360:0}},p}(h.Evented),_a=function(l){l===void 0&&(l={}),this.options=l,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_a.prototype.getDefaultPosition=function(){return"bottom-right"},_a.prototype.onAdd=function(l){var p=this.options&&this.options.compact;return this._map=l,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=P.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_a.prototype.onRemove=function(){P.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_a.prototype._setElementTitle=function(l,p){var f=this._map._getUIString("AttributionControl."+p);l.title=f,l.setAttribute("aria-label",f)},_a.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_a.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(l){var f=p.reduce(function(m,E,R){return E.value&&(m+=E.key+"="+E.value+(R<p.length-1?"&":"")),m},"?");l.href=h.config.FEEDBACK_URL+"/"+f+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},_a.prototype._updateData=function(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},_a.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function($){return typeof $!="string"?"":$})):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var f=this._map.style.sourceCaches;for(var m in f){var E=f[m];if(E.used){var R=E.getSource();R.attribution&&l.indexOf(R.attribution)<0&&l.push(R.attribution)}}l.sort(function($,ge){return $.length-ge.length});var O=(l=l.filter(function($,ge){for(var Me=ge+1;Me<l.length;Me++)if(l[Me].indexOf($)>=0)return!1;return!0})).join(" | ");O!==this._attribHTML&&(this._attribHTML=O,l.length?(this._innerContainer.innerHTML=O,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_a.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ra=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};Ra.prototype.onAdd=function(l){this._map=l,this._container=P.create("div","mapboxgl-ctrl");var p=P.create("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ra.prototype.onRemove=function(){P.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ra.prototype.getDefaultPosition=function(){return"bottom-left"},Ra.prototype._updateLogo=function(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ra.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var p in l)if(l[p].getSource().mapbox_logo)return!0;return!1}},Ra.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var p=l[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}};var Ma=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ma.prototype.add=function(l){var p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p},Ma.prototype.remove=function(l){for(var p=this._currentlyRunning,f=0,m=p?this._queue.concat(p):this._queue;f<m.length;f+=1){var E=m[f];if(E.id===l)return void(E.cancelled=!0)}},Ma.prototype.run=function(l){l===void 0&&(l=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var f=0,m=p;f<m.length;f+=1){var E=m[f];if(!E.cancelled&&(E.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ma.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var da={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},qo=h.window.HTMLImageElement,Xu=h.window.HTMLElement,ha=h.window.ImageBitmap,mo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Fc=function(l){function p(m){var E=this;if((m=h.extend({},mo,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var R=new Ca(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(l.call(this,R,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Ma,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},da,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new h.RequestManager(m.transformRequest,m.accessToken),typeof m.container=="string"){if(this._container=h.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof Xu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Fn(this,m),this._hash=m.hash&&new Xs(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,h.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new _a({customAttribution:m.customAttribution})),this.addControl(new Ra,m.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(O){E._update(O.dataType==="style"),E.fire(new h.Event(O.dataType+"data",O))}),this.on("dataloading",function(O){E.fire(new h.Event(O.dataType+"dataloading",O))})}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var f={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(m,E){if(E===void 0&&(E=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var R=m.onAdd(this);this._controls.push(m);var O=this._controlPositions[E];return E.indexOf("bottom")!==-1?O.insertBefore(R,O.firstChild):O.appendChild(R),this},p.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(m);return E>-1&&this._controls.splice(E,1),m.onRemove(this),this},p.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},p.prototype.resize=function(m){var E=this._containerDimensions(),R=E[0],O=E[1];if(R===this.transform.width&&O===this.transform.height)return this;this._resizeCanvas(R,O),this.transform.resize(R,O),this.painter.resize(R,O);var $=!this._moving;return $&&this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),this.fire(new h.Event("resize",m)),$&&this.fire(new h.Event("moveend",m)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(h.LngLatBounds.convert(m)),this._update()},p.prototype.setMinZoom=function(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(m){if((m=m==null?60:m)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},p.prototype.project=function(m){return this.transform.locationPoint(h.LngLat.convert(m))},p.prototype.unproject=function(m){return this.transform.pointLocation(h.Point.convert(m))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(m,E,R){var O,$=this;if(m==="mouseenter"||m==="mouseover"){var ge=!1;return{layer:E,listener:R,delegates:{mousemove:function(Ye){var tt=$.getLayer(E)?$.queryRenderedFeatures(Ye.point,{layers:[E]}):[];tt.length?ge||(ge=!0,R.call($,new So(m,$,Ye.originalEvent,{features:tt}))):ge=!1},mouseout:function(){ge=!1}}}}if(m==="mouseleave"||m==="mouseout"){var Me=!1;return{layer:E,listener:R,delegates:{mousemove:function(Ye){($.getLayer(E)?$.queryRenderedFeatures(Ye.point,{layers:[E]}):[]).length?Me=!0:Me&&(Me=!1,R.call($,new So(m,$,Ye.originalEvent)))},mouseout:function(Ye){Me&&(Me=!1,R.call($,new So(m,$,Ye.originalEvent)))}}}}return{layer:E,listener:R,delegates:(O={},O[m]=function(Ye){var tt=$.getLayer(E)?$.queryRenderedFeatures(Ye.point,{layers:[E]}):[];tt.length&&(Ye.features=tt,R.call($,Ye),delete Ye.features)},O)}},p.prototype.on=function(m,E,R){if(R===void 0)return l.prototype.on.call(this,m,E);var O=this._createDelegatedListener(m,E,R);for(var $ in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(O),O.delegates)this.on($,O.delegates[$]);return this},p.prototype.once=function(m,E,R){if(R===void 0)return l.prototype.once.call(this,m,E);var O=this._createDelegatedListener(m,E,R);for(var $ in O.delegates)this.once($,O.delegates[$]);return this},p.prototype.off=function(m,E,R){var O=this;return R===void 0?l.prototype.off.call(this,m,E):(this._delegatedListeners&&this._delegatedListeners[m]&&function($){for(var ge=$[m],Me=0;Me<ge.length;Me++){var Ye=ge[Me];if(Ye.layer===E&&Ye.listener===R){for(var tt in Ye.delegates)O.off(tt,Ye.delegates[tt]);return ge.splice(Me,1),O}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(m,E){if(!this.style)return[];var R;if(E!==void 0||m===void 0||m instanceof h.Point||Array.isArray(m)||(E=m,m=void 0),E=E||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof m[0]=="number")R=[h.Point.convert(m)];else{var O=h.Point.convert(m[0]),$=h.Point.convert(m[1]);R=[O,new h.Point($.x,O.y),$,new h.Point(O.x,$.y),O]}return this.style.queryRenderedFeatures(R,E,this.transform)},p.prototype.querySourceFeatures=function(m,E){return this.style.querySourceFeatures(m,E)},p.prototype.setStyle=function(m,E){return(E=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff!==!1&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(m,E))},p.prototype._getUIString=function(m){var E=this._locale[m];if(E==null)throw new Error("Missing UI string '"+m+"'");return E},p.prototype._updateStyle=function(m,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new cn(this,E||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new cn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(m,E){var R=this;if(typeof m=="string"){var O=this._requestManager.normalizeStyleURL(m),$=this._requestManager.transformRequest(O,h.ResourceType.Style);h.getJSON($,function(ge,Me){ge?R.fire(new h.ErrorEvent(ge)):Me&&R._updateDiff(Me,E)})}else typeof m=="object"&&this._updateDiff(m,E)},p.prototype._updateDiff=function(m,E){try{this.style.setState(m)&&this._update(!0)}catch(R){h.warnOnce("Unable to perform style diff: "+(R.message||R.error||R)+".  Rebuilding the style from scratch."),this._updateStyle(m,E)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(m,E){return this._lazyInitEmptyStyle(),this.style.addSource(m,E),this._update(!0)},p.prototype.isSourceLoaded=function(m){var E=this.style&&this.style.sourceCaches[m];if(E!==void 0)return E.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},p.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var E in m){var R=m[E]._tiles;for(var O in R){var $=R[O];if($.state!=="loaded"&&$.state!=="errored")return!1}}return!0},p.prototype.addSourceType=function(m,E,R){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,E,R)},p.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},p.prototype.getSource=function(m){return this.style.getSource(m)},p.prototype.addImage=function(m,E,R){R===void 0&&(R={});var O=R.pixelRatio;O===void 0&&(O=1);var $=R.sdf;$===void 0&&($=!1);var ge=R.stretchX,Me=R.stretchY,Ye=R.content;if(this._lazyInitEmptyStyle(),E instanceof qo||ha&&E instanceof ha){var tt=h.browser.getImageData(E);this.style.addImage(m,{data:new h.RGBAImage({width:tt.width,height:tt.height},tt.data),pixelRatio:O,stretchX:ge,stretchY:Me,content:Ye,sdf:$,version:0})}else{if(E.width===void 0||E.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ot=E;this.style.addImage(m,{data:new h.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:O,stretchX:ge,stretchY:Me,content:Ye,sdf:$,version:0,userImage:ot}),ot.onAdd&&ot.onAdd(this,m)}},p.prototype.updateImage=function(m,E){var R=this.style.getImage(m);if(!R)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var O=E instanceof qo||ha&&E instanceof ha?h.browser.getImageData(E):E,$=O.width,ge=O.height,Me=O.data;return $===void 0||ge===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):$!==R.data.width||ge!==R.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(R.data.replace(Me,!(E instanceof qo||ha&&E instanceof ha)),void this.style.updateImage(m,R))},p.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(m){this.style.removeImage(m)},p.prototype.loadImage=function(m,E){h.getImage(this._requestManager.transformRequest(m,h.ResourceType.Image),E)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(m,E){return this._lazyInitEmptyStyle(),this.style.addLayer(m,E),this._update(!0)},p.prototype.moveLayer=function(m,E){return this.style.moveLayer(m,E),this._update(!0)},p.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},p.prototype.getLayer=function(m){return this.style.getLayer(m)},p.prototype.setLayerZoomRange=function(m,E,R){return this.style.setLayerZoomRange(m,E,R),this._update(!0)},p.prototype.setFilter=function(m,E,R){return R===void 0&&(R={}),this.style.setFilter(m,E,R),this._update(!0)},p.prototype.getFilter=function(m){return this.style.getFilter(m)},p.prototype.setPaintProperty=function(m,E,R,O){return O===void 0&&(O={}),this.style.setPaintProperty(m,E,R,O),this._update(!0)},p.prototype.getPaintProperty=function(m,E){return this.style.getPaintProperty(m,E)},p.prototype.setLayoutProperty=function(m,E,R,O){return O===void 0&&(O={}),this.style.setLayoutProperty(m,E,R,O),this._update(!0)},p.prototype.getLayoutProperty=function(m,E){return this.style.getLayoutProperty(m,E)},p.prototype.setLight=function(m,E){return E===void 0&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(m,E),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(m,E){return this.style.setFeatureState(m,E),this._update()},p.prototype.removeFeatureState=function(m,E){return this.style.removeFeatureState(m,E),this._update()},p.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var m=0,E=0;return this._container&&(m=this._container.clientWidth||400,E=this._container.clientHeight||300),[m,E]},p.prototype._detectMissingCSS=function(){h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},p.prototype._setupContainer=function(){var m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=P.create("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();var E=this._canvasContainer=P.create("div","mapboxgl-canvas-container",m);this._interactive&&E.classList.add("mapboxgl-interactive"),this._canvas=P.create("canvas","mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var R=this._containerDimensions();this._resizeCanvas(R[0],R[1]);var O=this._controlContainer=P.create("div","mapboxgl-control-container",m),$=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ge){$[ge]=P.create("div","mapboxgl-ctrl-"+ge,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(m,E){var R=h.browser.devicePixelRatio||1;this._canvas.width=R*m,this._canvas.height=R*E,this._canvas.style.width=m+"px",this._canvas.style.height=E+"px"},p.prototype._setupPainter=function(){var m=h.extend({},D.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);E?(this.painter=new uo(E,this.transform),h.webpSupported.testSupport(E)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:m}))},p.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:m}))},p.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},p.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},p.prototype._render=function(m){var E,R=this,O=0,$=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=$.createQueryEXT(),$.beginQueryEXT($.TIME_ELAPSED_EXT,E),O=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var ge=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Me=this.transform.zoom,Ye=h.browser.now();this.style.zoomHistory.update(Me,Ye);var tt=new h.EvaluationParameters(Me,{now:Ye,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ot=tt.crossFadingFactor();ot===1&&ot===this._crossFadingFactor||(ge=!0,this._crossFadingFactor=ot),this.style.update(tt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||ge)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var At=h.browser.now()-O;$.endQueryEXT($.TIME_ELAPSED_EXT,E),setTimeout(function(){var _t=$.getQueryObjectEXT(E,$.QUERY_RESULT_EXT)/1e6;$.deleteQueryEXT(E),R.fire(new h.Event("gpu-timing-frame",{cpuTime:At,gpuTime:_t}))},50)}if(this.listens("gpu-timing-layer")){var St=this.painter.collectGpuTimers();setTimeout(function(){var _t=R.painter.queryGpuTimers(St);R.fire(new h.Event("gpu-timing-layer",{layerTimes:_t}))},50)}var Zt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Zt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||Zt||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,E=this._controls;m<E.length;m+=1)E[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var R=this.painter.context.gl.getExtension("WEBGL_lose_context");R&&R.loseContext(),nu(this._canvasContainer),nu(this._controlContainer),nu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},p.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(E){m._frame=null,m._render(E)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},f.showTileBoundaries.get=function(){return!!this._showTileBoundaries},f.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},f.showPadding.get=function(){return!!this._showPadding},f.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},f.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},f.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},f.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},f.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},f.repaint.get=function(){return!!this._repaint},f.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},f.vertices.get=function(){return!!this._vertices},f.vertices.set=function(m){this._vertices=m,this._update()},p.prototype._setCacheLimits=function(m,E){h.setCacheLimits(m,E)},f.version.get=function(){return h.version},Object.defineProperties(p.prototype,f),p}($a);function nu(l){l.parentNode&&l.parentNode.removeChild(l)}var Cf={showCompass:!0,showZoom:!0,visualizePitch:!1},Zl=function(l){var p=this;this.options=h.extend({},Cf,l),this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(f){return f.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(f){return p._map.zoomIn({},{originalEvent:f})}),P.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(f){return p._map.zoomOut({},{originalEvent:f})}),P.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(f){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:f}):p._map.resetNorth({},{originalEvent:f})}),this._compassIcon=P.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Zl.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),p=l===this._map.getMaxZoom(),f=l===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},Zl.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},Zl.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Os(this._map,this._compass,this.options.visualizePitch)),this._container},Zl.prototype.onRemove=function(){P.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Zl.prototype._createButton=function(l,p){var f=P.create("button",l,this._container);return f.type="button",f.addEventListener("click",p),f},Zl.prototype._setButtonTitle=function(l,p){var f=this._map._getUIString("NavigationControl."+p);l.title=f,l.setAttribute("aria-label",f)};var Os=function(l,p,f){f===void 0&&(f=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new re({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,f&&(this.mousePitch=new ce({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),P.addEventListener(p,"mousedown",this.mousedown),P.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),P.addEventListener(p,"touchmove",this.touchmove),P.addEventListener(p,"touchend",this.touchend),P.addEventListener(p,"touchcancel",this.reset)};function rc(l,p,f){if(l=new h.LngLat(l.lng,l.lat),p){var m=new h.LngLat(l.lng-360,l.lat),E=new h.LngLat(l.lng+360,l.lat),R=f.locationPoint(l).distSqr(p);f.locationPoint(m).distSqr(p)<R?l=m:f.locationPoint(E).distSqr(p)<R&&(l=E)}for(;Math.abs(l.lng-f.center.lng)>180;){var O=f.locationPoint(l);if(O.x>=0&&O.y>=0&&O.x<=f.width&&O.y<=f.height)break;l.lng>f.center.lng?l.lng-=360:l.lng+=360}return l}Os.prototype.down=function(l,p){this.mouseRotate.mousedown(l,p),this.mousePitch&&this.mousePitch.mousedown(l,p),P.disableDrag()},Os.prototype.move=function(l,p){var f=this.map,m=this.mouseRotate.mousemoveWindow(l,p);if(m&&m.bearingDelta&&f.setBearing(f.getBearing()+m.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(l,p);E&&E.pitchDelta&&f.setPitch(f.getPitch()+E.pitchDelta)}},Os.prototype.off=function(){var l=this.element;P.removeEventListener(l,"mousedown",this.mousedown),P.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),P.removeEventListener(l,"touchmove",this.touchmove),P.removeEventListener(l,"touchend",this.touchend),P.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},Os.prototype.offTemp=function(){P.enableDrag(),P.removeEventListener(h.window,"mousemove",this.mousemove),P.removeEventListener(h.window,"mouseup",this.mouseup)},Os.prototype.mousedown=function(l){this.down(h.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),P.mousePos(this.element,l)),P.addEventListener(h.window,"mousemove",this.mousemove),P.addEventListener(h.window,"mouseup",this.mouseup)},Os.prototype.mousemove=function(l){this.move(l,P.mousePos(this.element,l))},Os.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},Os.prototype.touchstart=function(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=P.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},Os.prototype.touchmove=function(l){l.targetTouches.length!==1?this.reset():(this._lastPos=P.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},Os.prototype.touchend=function(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Os.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function $f(l,p,f){var m=l.classList;for(var E in Vl)m.remove("mapboxgl-"+f+"-anchor-"+E);m.add("mapboxgl-"+f+"-anchor-"+p)}var ll,El=function(l){function p(f,m){if(l.call(this),(f instanceof h.window.HTMLElement||m)&&(f=h.extend({element:f},m)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=f&&f.anchor||"center",this._color=f&&f.color||"#3FB1CE",this._scale=f&&f.scale||1,this._draggable=f&&f.draggable||!1,this._clickTolerance=f&&f.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=f&&f.rotation||0,this._rotationAlignment=f&&f.rotationAlignment||"auto",this._pitchAlignment=f&&f.pitchAlignment&&f.pitchAlignment!=="auto"?f.pitchAlignment:this._rotationAlignment,f&&f.element)this._element=f.element,this._offset=h.Point.convert(f&&f.offset||[0,0]);else{this._defaultMarker=!0,this._element=P.create("div"),this._element.setAttribute("aria-label","Map marker");var E=P.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var R=P.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"stroke","none"),R.setAttributeNS(null,"stroke-width","1"),R.setAttributeNS(null,"fill","none"),R.setAttributeNS(null,"fill-rule","evenodd");var O=P.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");var $=P.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");for(var ge=0,Me=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ge<Me.length;ge+=1){var Ye=Me[ge],tt=P.createNS("http://www.w3.org/2000/svg","ellipse");tt.setAttributeNS(null,"opacity","0.04"),tt.setAttributeNS(null,"cx","10.5"),tt.setAttributeNS(null,"cy","5.80029008"),tt.setAttributeNS(null,"rx",Ye.rx),tt.setAttributeNS(null,"ry",Ye.ry),$.appendChild(tt)}var ot=P.createNS("http://www.w3.org/2000/svg","g");ot.setAttributeNS(null,"fill",this._color);var At=P.createNS("http://www.w3.org/2000/svg","path");At.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ot.appendChild(At);var St=P.createNS("http://www.w3.org/2000/svg","g");St.setAttributeNS(null,"opacity","0.25"),St.setAttributeNS(null,"fill","#000000");var Zt=P.createNS("http://www.w3.org/2000/svg","path");Zt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),St.appendChild(Zt);var _t=P.createNS("http://www.w3.org/2000/svg","g");_t.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_t.setAttributeNS(null,"fill","#FFFFFF");var Vt=P.createNS("http://www.w3.org/2000/svg","g");Vt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var er=P.createNS("http://www.w3.org/2000/svg","circle");er.setAttributeNS(null,"fill","#000000"),er.setAttributeNS(null,"opacity","0.25"),er.setAttributeNS(null,"cx","5.5"),er.setAttributeNS(null,"cy","5.5"),er.setAttributeNS(null,"r","5.4999962");var cr=P.createNS("http://www.w3.org/2000/svg","circle");cr.setAttributeNS(null,"fill","#FFFFFF"),cr.setAttributeNS(null,"cx","5.5"),cr.setAttributeNS(null,"cy","5.5"),cr.setAttributeNS(null,"r","5.4999962"),Vt.appendChild(er),Vt.appendChild(cr),O.appendChild($),O.appendChild(ot),O.appendChild(St),O.appendChild(_t),O.appendChild(Vt),E.appendChild(O),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=h.Point.convert(f&&f.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Rr){Rr.preventDefault()}),this._element.addEventListener("mousedown",function(Rr){Rr.preventDefault()}),$f(this._element,this._anchor,"marker"),this._popup=null}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.addTo=function(f){return this.remove(),this._map=f,f.getCanvasContainer().appendChild(this._element),f.on("move",this._update),f.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),P.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(f){return this._lngLat=h.LngLat.convert(f),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(f){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),f){if(!("offset"in f.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);f.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=f,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(f){var m=f.code,E=f.charCode||f.keyCode;m!=="Space"&&m!=="Enter"&&E!==32&&E!==13||this.togglePopup()},p.prototype._onMapClick=function(f){var m=f.originalEvent.target,E=this._element;this._popup&&(m===E||E.contains(m))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var f=this._popup;return f?(f.isOpen()?f.remove():f.addTo(this._map),this):this},p.prototype._update=function(f){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=rc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?E="rotateX(0deg)":this._pitchAlignment==="map"&&(E="rotateX("+this._map.getPitch()+"deg)"),f&&f.type!=="moveend"||(this._pos=this._pos.round()),P.setTransform(this._element,Vl[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+m)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(f){return this._offset=h.Point.convert(f),this._update(),this},p.prototype._onMove=function(f){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(f){this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(f){return this._draggable=!!f,this._map&&(f?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(f){return this._rotation=f||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(f){return this._rotationAlignment=f||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(f){return this._pitchAlignment=f&&f!=="auto"?f:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(h.Evented),jl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},cl=0,fl=!1,_c=function(l){function p(f){l.call(this),this.options=h.extend({},jl,f),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.onAdd=function(f){var m;return this._map=f,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,ll!==void 0?m(ll):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(E){m(ll=E.state!=="denied")}):m(ll=!!h.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),P.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,cl=0,fl=!1},p.prototype._isOutOfMapMaxBounds=function(f){var m=this._map.getMaxBounds(),E=f.coords;return m&&(E.longitude<m.getWest()||E.longitude>m.getEast()||E.latitude<m.getSouth()||E.latitude>m.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",f)),this._finish()}},p.prototype._updateCamera=function(f){var m=new h.LngLat(f.coords.longitude,f.coords.latitude),E=f.coords.accuracy,R=this._map.getBearing(),O=h.extend({bearing:R},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(E),O,{geolocateSource:!0})},p.prototype._updateMarker=function(f){if(f){var m=new h.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var f=this._map._container.clientHeight/2,m=this._map.unproject([0,f]),E=this._map.unproject([1,f]),R=m.distanceTo(E),O=Math.ceil(2*this._accuracy/R);this._circleElement.style.width=O+"px",this._circleElement.style.height=O+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&fl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",f)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(f){var m=this;if(this._container.addEventListener("contextmenu",function(O){return O.preventDefault()}),this._geolocateButton=P.create("button","mapboxgl-ctrl-geolocate",this._container),P.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",f===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var R=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=R,this._geolocateButton.setAttribute("aria-label",R)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new El(this._dotElement),this._circleElement=P.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new El({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(O){O.geolocateSource||m._watchState!=="ACTIVE_LOCK"||O.originalEvent&&O.originalEvent.type==="resize"||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),m.fire(new h.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":cl--,fl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++cl>1?(f={maximumAge:6e5,timeout:0},fl=!0):(f=this.options.positionOptions,fl=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(h.Evented),Ui={maxWidth:100,unit:"metric"},mu=function(l){this.options=h.extend({},Ui,l),h.bindAll(["_onMove","setUnit"],this)};function wf(l,p,f){var m=f&&f.maxWidth||100,E=l._container.clientHeight/2,R=l.unproject([0,E]),O=l.unproject([m,E]),$=R.distanceTo(O);if(f&&f.unit==="imperial"){var ge=3.2808*$;ge>5280?To(p,m,ge/5280,l._getUIString("ScaleControl.Miles")):To(p,m,ge,l._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?To(p,m,$/1852,l._getUIString("ScaleControl.NauticalMiles")):$>=1e3?To(p,m,$/1e3,l._getUIString("ScaleControl.Kilometers")):To(p,m,$,l._getUIString("ScaleControl.Meters"))}function To(l,p,f,m){var E,R,O,$=(E=f,(R=Math.pow(10,(""+Math.floor(E)).length-1))*(O=(O=E/R)>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(ge){var Me=Math.pow(10,Math.ceil(-Math.log(ge)/Math.LN10));return Math.round(ge*Me)/Me}(O)));l.style.width=p*($/f)+"px",l.innerHTML=$+"&nbsp;"+m}mu.prototype.getDefaultPosition=function(){return"bottom-left"},mu.prototype._onMove=function(){wf(this._map,this._container,this.options)},mu.prototype.onAdd=function(l){return this._map=l,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},mu.prototype.onRemove=function(){P.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},mu.prototype.setUnit=function(l){this.options.unit=l,wf(this._map,this._container,this.options)};var ho=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof h.window.HTMLElement?this._container=l.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};ho.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ho.prototype.onRemove=function(){P.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ho.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},ho.prototype._setupUI=function(){var l=this._fullscreenButton=P.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);P.create("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ho.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},ho.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ho.prototype._isFullscreen=function(){return this._fullscreen},ho.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ho.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Yu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},$l=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),gu=function(l){function p(f){l.call(this),this.options=h.extend(Object.create(Yu),f),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.addTo=function(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&P.remove(this._content),this._container&&(P.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(f){return this._lngLat=h.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(f){return this.setDOMContent(h.window.document.createTextNode(f))},p.prototype.setHTML=function(f){var m,E=h.window.document.createDocumentFragment(),R=h.window.document.createElement("body");for(R.innerHTML=f;m=R.firstChild;)E.appendChild(m);return this.setDOMContent(E)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(f){return this.options.maxWidth=f,this._update(),this},p.prototype.setDOMContent=function(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=P.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(f){this._container&&this._container.classList.add(f)},p.prototype.removeClassName=function(f){this._container&&this._container.classList.remove(f)},p.prototype.setOffset=function(f){return this.options.offset=f,this._update(),this},p.prototype.toggleClassName=function(f){if(this._container)return this._container.classList.toggle(f)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=P.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(f){this._update(f.point)},p.prototype._onMouseMove=function(f){this._update(f.point)},p.prototype._onDrag=function(f){this._update(f.point)},p.prototype._update=function(f){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=P.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=P.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(tt){return m._container.classList.add(tt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=rc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||f)){var E=this._pos=this._trackPointer&&f?f:this._map.project(this._lngLat),R=this.options.anchor,O=function tt(ot){if(ot){if(typeof ot=="number"){var At=Math.round(Math.sqrt(.5*Math.pow(ot,2)));return{center:new h.Point(0,0),top:new h.Point(0,ot),"top-left":new h.Point(At,At),"top-right":new h.Point(-At,At),bottom:new h.Point(0,-ot),"bottom-left":new h.Point(At,-At),"bottom-right":new h.Point(-At,-At),left:new h.Point(ot,0),right:new h.Point(-ot,0)}}if(ot instanceof h.Point||Array.isArray(ot)){var St=h.Point.convert(ot);return{center:St,top:St,"top-left":St,"top-right":St,bottom:St,"bottom-left":St,"bottom-right":St,left:St,right:St}}return{center:h.Point.convert(ot.center||[0,0]),top:h.Point.convert(ot.top||[0,0]),"top-left":h.Point.convert(ot["top-left"]||[0,0]),"top-right":h.Point.convert(ot["top-right"]||[0,0]),bottom:h.Point.convert(ot.bottom||[0,0]),"bottom-left":h.Point.convert(ot["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(ot["bottom-right"]||[0,0]),left:h.Point.convert(ot.left||[0,0]),right:h.Point.convert(ot.right||[0,0])}}return tt(new h.Point(0,0))}(this.options.offset);if(!R){var $,ge=this._container.offsetWidth,Me=this._container.offsetHeight;$=E.y+O.bottom.y<Me?["top"]:E.y>this._map.transform.height-Me?["bottom"]:[],E.x<ge/2?$.push("left"):E.x>this._map.transform.width-ge/2&&$.push("right"),R=$.length===0?"bottom":$.join("-")}var Ye=E.add(O[R]).round();P.setTransform(this._container,Vl[R]+" translate("+Ye.x+"px,"+Ye.y+"px)"),$f(this._container,R,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var f=this._container.querySelector($l);f&&f.focus()}},p.prototype._onClose=function(){this.remove()},p}(h.Evented),Hl={version:h.version,supported:D,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:Fc,NavigationControl:Zl,GeolocateControl:_c,AttributionControl:_a,ScaleControl:mu,FullscreenControl:ho,Popup:gu,Marker:El,Style:cn,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,prewarm:function(){xr().acquire(lr)},clearPrewarmedResources:function(){var l=Rn;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(lr),Rn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(l){h.config.ACCESS_TOKEN=l},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(l){h.config.API_URL=l},get workerCount(){return $r.workerCount},set workerCount(l){$r.workerCount=l},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){h.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){h.clearTileCache(l)},workerUrl:""};return Hl}),F})},92077:function(He,w,x){var F,z;(function(h,D){F=D,z=typeof F=="function"?F.call(w,x,w,He):F,z!==void 0&&(He.exports=z)})(this,function(){var h,D,P="2.0.6",X={},W={},fe={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},J={currentLocale:fe.currentLocale,zeroFormat:fe.zeroFormat,nullFormat:fe.nullFormat,defaultFormat:fe.defaultFormat,scalePercentBy100:fe.scalePercentBy100};function Be(B,ee){this._input=B,this._value=ee}return h=function(B){var ee,U,q,le;if(h.isNumeral(B))ee=B.value();else if(B===0||typeof B=="undefined")ee=0;else if(B===null||D.isNaN(B))ee=null;else if(typeof B=="string")if(J.zeroFormat&&B===J.zeroFormat)ee=0;else if(J.nullFormat&&B===J.nullFormat||!B.replace(/[^0-9]+/g,"").length)ee=null;else{for(U in X)if(le=typeof X[U].regexps.unformat=="function"?X[U].regexps.unformat():X[U].regexps.unformat,le&&B.match(le)){q=X[U].unformat;break}q=q||h._.stringToNumber,ee=q(B)}else ee=Number(B)||null;return new Be(B,ee)},h.version=P,h.isNumeral=function(B){return B instanceof Be},h._=D={numberToFormat:function(B,ee,U){var q=W[h.options.currentLocale],le=!1,j=!1,Ce=0,$e="",Fe=1e12,lt=1e9,We=1e6,Ze=1e3,pe="",se=!1,be,Te,de,Rt,ye,Ve,oe,Re,Se,et;if(B=B||0,Te=Math.abs(B),h._.includes(ee,"(")?(le=!0,ee=ee.replace(/[\(|\)]/g,"")):(h._.includes(ee,"+")||h._.includes(ee,"-"))&&(Re=h._.includes(ee,"+")?ee.indexOf("+"):B<0?ee.indexOf("-"):-1,ee=ee.replace(/[\+|\-]/g,"")),h._.includes(ee,"a")&&(be=ee.match(/a(k|m|b|t)?/),be=be?be[1]:!1,h._.includes(ee," a")&&($e=" "),ee=ee.replace(new RegExp($e+"a[kmbt]?"),""),Te>=Fe&&!be||be==="t"?($e+=q.abbreviations.trillion,B=B/Fe):Te<Fe&&Te>=lt&&!be||be==="b"?($e+=q.abbreviations.billion,B=B/lt):Te<lt&&Te>=We&&!be||be==="m"?($e+=q.abbreviations.million,B=B/We):(Te<We&&Te>=Ze&&!be||be==="k")&&($e+=q.abbreviations.thousand,B=B/Ze)),h._.includes(ee,"[.]")&&(j=!0,ee=ee.replace("[.]",".")),Ve=B.toString().split(".")[0],oe=ee.split(".")[1],Se=ee.indexOf(","),Ce=(ee.split(".")[0].split(",")[0].match(/0/g)||[]).length,oe?(h._.includes(oe,"[")?(oe=oe.replace("]",""),oe=oe.split("["),pe=h._.toFixed(B,oe[0].length+oe[1].length,U,oe[1].length)):pe=h._.toFixed(B,oe.length,U),Ve=pe.split(".")[0],h._.includes(pe,".")?pe=q.delimiters.decimal+pe.split(".")[1]:pe="",j&&Number(pe.slice(1))===0&&(pe="")):Ve=h._.toFixed(B,0,U),$e&&!be&&Number(Ve)>=1e3&&$e!==q.abbreviations.trillion)switch(Ve=String(Number(Ve)/1e3),$e){case q.abbreviations.thousand:$e=q.abbreviations.million;break;case q.abbreviations.million:$e=q.abbreviations.billion;break;case q.abbreviations.billion:$e=q.abbreviations.trillion;break}if(h._.includes(Ve,"-")&&(Ve=Ve.slice(1),se=!0),Ve.length<Ce)for(var st=Ce-Ve.length;st>0;st--)Ve="0"+Ve;return Se>-1&&(Ve=Ve.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+q.delimiters.thousands)),ee.indexOf(".")===0&&(Ve=""),et=Ve+pe+($e||""),le?et=(le&&se?"(":"")+et+(le&&se?")":""):Re>=0?et=Re===0?(se?"-":"+")+et:et+(se?"-":"+"):se&&(et="-"+et),et},stringToNumber:function(B){var ee=W[J.currentLocale],U=B,q={thousand:3,million:6,billion:9,trillion:12},le,j,Ce,$e;if(J.zeroFormat&&B===J.zeroFormat)j=0;else if(J.nullFormat&&B===J.nullFormat||!B.replace(/[^0-9]+/g,"").length)j=null;else{j=1,ee.delimiters.decimal!=="."&&(B=B.replace(/\./g,"").replace(ee.delimiters.decimal,"."));for(le in q)if($e=new RegExp("[^a-zA-Z]"+ee.abbreviations[le]+"(?:\\)|(\\"+ee.currency.symbol+")?(?:\\))?)?$"),U.match($e)){j*=Math.pow(10,q[le]);break}j*=(B.split("-").length+Math.min(B.split("(").length-1,B.split(")").length-1))%2?1:-1,B=B.replace(/[^0-9\.]+/g,""),j*=Number(B)}return j},isNaN:function(B){return typeof B=="number"&&isNaN(B)},includes:function(B,ee){return B.indexOf(ee)!==-1},insert:function(B,ee,U){return B.slice(0,U)+ee+B.slice(U)},reduce:function(B,ee){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof ee!="function")throw new TypeError(ee+" is not a function");var U=Object(B),q=U.length>>>0,le=0,j;if(arguments.length===3)j=arguments[2];else{for(;le<q&&!(le in U);)le++;if(le>=q)throw new TypeError("Reduce of empty array with no initial value");j=U[le++]}for(;le<q;le++)le in U&&(j=ee(j,U[le],le,U));return j},multiplier:function(B){var ee=B.toString().split(".");return ee.length<2?1:Math.pow(10,ee[1].length)},correctionFactor:function(){var B=Array.prototype.slice.call(arguments);return B.reduce(function(ee,U){var q=D.multiplier(U);return ee>q?ee:q},1)},toFixed:function(B,ee,U,q){var le=B.toString().split("."),j=ee-(q||0),Ce,$e,Fe,lt;return le.length===2?Ce=Math.min(Math.max(le[1].length,j),ee):Ce=j,Fe=Math.pow(10,Ce),lt=(U(B+"e+"+Ce)/Fe).toFixed(Ce),q>ee-Ce&&($e=new RegExp("\\.?0{1,"+(q-(ee-Ce))+"}$"),lt=lt.replace($e,"")),lt}},h.options=J,h.formats=X,h.locales=W,h.locale=function(B){return B&&(J.currentLocale=B.toLowerCase()),J.currentLocale},h.localeData=function(B){if(!B)return W[J.currentLocale];if(B=B.toLowerCase(),!W[B])throw new Error("Unknown locale : "+B);return W[B]},h.reset=function(){for(var B in fe)J[B]=fe[B]},h.zeroFormat=function(B){J.zeroFormat=typeof B=="string"?B:null},h.nullFormat=function(B){J.nullFormat=typeof B=="string"?B:null},h.defaultFormat=function(B){J.defaultFormat=typeof B=="string"?B:"0.0"},h.register=function(B,ee,U){if(ee=ee.toLowerCase(),this[B+"s"][ee])throw new TypeError(ee+" "+B+" already registered.");return this[B+"s"][ee]=U,U},h.validate=function(B,ee){var U,q,le,j,Ce,$e,Fe,lt;if(typeof B!="string"&&(B+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",B)),B=B.trim(),B.match(/^\d+$/))return!0;if(B==="")return!1;try{Fe=h.localeData(ee)}catch(We){Fe=h.localeData(h.locale())}return le=Fe.currency.symbol,Ce=Fe.abbreviations,U=Fe.delimiters.decimal,Fe.delimiters.thousands==="."?q="\\.":q=Fe.delimiters.thousands,lt=B.match(/^[^\d]+/),lt!==null&&(B=B.substr(1),lt[0]!==le)||(lt=B.match(/[^\d]+$/),lt!==null&&(B=B.slice(0,-1),lt[0]!==Ce.thousand&&lt[0]!==Ce.million&&lt[0]!==Ce.billion&&lt[0]!==Ce.trillion))?!1:($e=new RegExp(q+"{2}"),B.match(/[^\d.,]/g)?!1:(j=B.split(U),j.length>2?!1:j.length<2?!!j[0].match(/^\d+.*\d$/)&&!j[0].match($e):j[0].length===1?!!j[0].match(/^\d+$/)&&!j[0].match($e)&&!!j[1].match(/^\d+$/):!!j[0].match(/^\d+.*\d$/)&&!j[0].match($e)&&!!j[1].match(/^\d+$/)))},h.fn=Be.prototype={clone:function(){return h(this)},format:function(B,ee){var U=this._value,q=B||J.defaultFormat,le,j,Ce;if(ee=ee||Math.round,U===0&&J.zeroFormat!==null)j=J.zeroFormat;else if(U===null&&J.nullFormat!==null)j=J.nullFormat;else{for(le in X)if(q.match(X[le].regexps.format)){Ce=X[le].format;break}Ce=Ce||h._.numberToFormat,j=Ce(U,q,ee)}return j},value:function(){return this._value},input:function(){return this._input},set:function(B){return this._value=Number(B),this},add:function(B){var ee=D.correctionFactor.call(null,this._value,B);function U(q,le,j,Ce){return q+Math.round(ee*le)}return this._value=D.reduce([this._value,B],U,0)/ee,this},subtract:function(B){var ee=D.correctionFactor.call(null,this._value,B);function U(q,le,j,Ce){return q-Math.round(ee*le)}return this._value=D.reduce([B],U,Math.round(this._value*ee))/ee,this},multiply:function(B){function ee(U,q,le,j){var Ce=D.correctionFactor(U,q);return Math.round(U*Ce)*Math.round(q*Ce)/Math.round(Ce*Ce)}return this._value=D.reduce([this._value,B],ee,1),this},divide:function(B){function ee(U,q,le,j){var Ce=D.correctionFactor(U,q);return Math.round(U*Ce)/Math.round(q*Ce)}return this._value=D.reduce([this._value,B],ee),this},difference:function(B){return Math.abs(h(this._value).subtract(B).value())}},h.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(B){var ee=B%10;return~~(B%100/10)===1?"th":ee===1?"st":ee===2?"nd":ee===3?"rd":"th"},currency:{symbol:"$"}}),function(){h.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(B,ee,U){var q=h._.includes(ee," BPS")?" ":"",le;return B=B*1e4,ee=ee.replace(/\s?BPS/,""),le=h._.numberToFormat(B,ee,U),h._.includes(le,")")?(le=le.split(""),le.splice(-1,0,q+"BPS"),le=le.join("")):le=le+q+"BPS",le},unformat:function(B){return+(h._.stringToNumber(B)*1e-4).toFixed(15)}})}(),function(){var B={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},ee={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},U=B.suffixes.concat(ee.suffixes.filter(function(le){return B.suffixes.indexOf(le)<0})),q=U.join("|");q="("+q.replace("B","B(?!PS)")+")",h.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(q)},format:function(le,j,Ce){var $e,Fe=h._.includes(j,"ib")?ee:B,lt=h._.includes(j," b")||h._.includes(j," ib")?" ":"",We,Ze,pe;for(j=j.replace(/\s?i?b/,""),We=0;We<=Fe.suffixes.length;We++)if(Ze=Math.pow(Fe.base,We),pe=Math.pow(Fe.base,We+1),le===null||le===0||le>=Ze&&le<pe){lt+=Fe.suffixes[We],Ze>0&&(le=le/Ze);break}return $e=h._.numberToFormat(le,j,Ce),$e+lt},unformat:function(le){var j=h._.stringToNumber(le),Ce,$e;if(j){for(Ce=B.suffixes.length-1;Ce>=0;Ce--){if(h._.includes(le,B.suffixes[Ce])){$e=Math.pow(B.base,Ce);break}if(h._.includes(le,ee.suffixes[Ce])){$e=Math.pow(ee.base,Ce);break}}j*=$e||1}return j}})}(),function(){h.register("format","currency",{regexps:{format:/(\$)/},format:function(B,ee,U){var q=h.locales[h.options.currentLocale],le={before:ee.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:ee.match(/([\+|\-|\)|\s|\$]*)$/)[0]},j,Ce,$e;for(ee=ee.replace(/\s?\$\s?/,""),j=h._.numberToFormat(B,ee,U),B>=0?(le.before=le.before.replace(/[\-\(]/,""),le.after=le.after.replace(/[\-\)]/,"")):B<0&&!h._.includes(le.before,"-")&&!h._.includes(le.before,"(")&&(le.before="-"+le.before),$e=0;$e<le.before.length;$e++)switch(Ce=le.before[$e],Ce){case"$":j=h._.insert(j,q.currency.symbol,$e);break;case" ":j=h._.insert(j," ",$e+q.currency.symbol.length-1);break}for($e=le.after.length-1;$e>=0;$e--)switch(Ce=le.after[$e],Ce){case"$":j=$e===le.after.length-1?j+q.currency.symbol:h._.insert(j,q.currency.symbol,-(le.after.length-(1+$e)));break;case" ":j=$e===le.after.length-1?j+" ":h._.insert(j," ",-(le.after.length-(1+$e)+q.currency.symbol.length-1));break}return j}})}(),function(){h.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(B,ee,U){var q,le=typeof B=="number"&&!h._.isNaN(B)?B.toExponential():"0e+0",j=le.split("e");return ee=ee.replace(/e[\+|\-]{1}0/,""),q=h._.numberToFormat(Number(j[0]),ee,U),q+"e"+j[1]},unformat:function(B){var ee=h._.includes(B,"e+")?B.split("e+"):B.split("e-"),U=Number(ee[0]),q=Number(ee[1]);q=h._.includes(B,"e-")?q*=-1:q;function le(j,Ce,$e,Fe){var lt=h._.correctionFactor(j,Ce),We=j*lt*(Ce*lt)/(lt*lt);return We}return h._.reduce([U,Math.pow(10,q)],le,1)}})}(),function(){h.register("format","ordinal",{regexps:{format:/(o)/},format:function(B,ee,U){var q=h.locales[h.options.currentLocale],le,j=h._.includes(ee," o")?" ":"";return ee=ee.replace(/\s?o/,""),j+=q.ordinal(B),le=h._.numberToFormat(B,ee,U),le+j}})}(),function(){h.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(B,ee,U){var q=h._.includes(ee," %")?" ":"",le;return h.options.scalePercentBy100&&(B=B*100),ee=ee.replace(/\s?\%/,""),le=h._.numberToFormat(B,ee,U),h._.includes(le,")")?(le=le.split(""),le.splice(-1,0,q+"%"),le=le.join("")):le=le+q+"%",le},unformat:function(B){var ee=h._.stringToNumber(B);return h.options.scalePercentBy100?ee*.01:ee}})}(),function(){h.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(B,ee,U){var q=Math.floor(B/60/60),le=Math.floor((B-q*60*60)/60),j=Math.round(B-q*60*60-le*60);return q+":"+(le<10?"0"+le:le)+":"+(j<10?"0"+j:j)},unformat:function(B){var ee=B.split(":"),U=0;return ee.length===3?(U=U+Number(ee[0])*60*60,U=U+Number(ee[1])*60,U=U+Number(ee[2])):ee.length===2&&(U=U+Number(ee[0])*60,U=U+Number(ee[1])),Number(U)}})}(),h})},3614:function(He,w,x){"use strict";He.exports=z;var F=x(80645);function z(ye){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ye)?ye:new Uint8Array(ye||0),this.pos=0,this.type=0,this.length=this.buf.length}z.Varint=0,z.Fixed64=1,z.Bytes=2,z.Fixed32=5;var h=65536*65536,D=1/h,P=12,X=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");z.prototype={destroy:function(){this.buf=null},readFields:function(ye,Ve,oe){for(oe=oe||this.length;this.pos<oe;){var Re=this.readVarint(),Se=Re>>3,et=this.pos;this.type=Re&7,ye(Se,Ve,this),this.pos===et&&this.skip(Re)}return Ve},readMessage:function(ye,Ve){return this.readFields(ye,Ve,this.readVarint()+this.pos)},readFixed32:function(){var ye=pe(this.buf,this.pos);return this.pos+=4,ye},readSFixed32:function(){var ye=be(this.buf,this.pos);return this.pos+=4,ye},readFixed64:function(){var ye=pe(this.buf,this.pos)+pe(this.buf,this.pos+4)*h;return this.pos+=8,ye},readSFixed64:function(){var ye=pe(this.buf,this.pos)+be(this.buf,this.pos+4)*h;return this.pos+=8,ye},readFloat:function(){var ye=F.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ye},readDouble:function(){var ye=F.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ye},readVarint:function(ye){var Ve=this.buf,oe,Re;return Re=Ve[this.pos++],oe=Re&127,Re<128||(Re=Ve[this.pos++],oe|=(Re&127)<<7,Re<128)||(Re=Ve[this.pos++],oe|=(Re&127)<<14,Re<128)||(Re=Ve[this.pos++],oe|=(Re&127)<<21,Re<128)?oe:(Re=Ve[this.pos],oe|=(Re&15)<<28,W(oe,ye,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ye=this.readVarint();return ye%2===1?(ye+1)/-2:ye/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ye=this.readVarint()+this.pos,Ve=this.pos;return this.pos=ye,ye-Ve>=P&&X?de(this.buf,Ve,ye):Te(this.buf,Ve,ye)},readBytes:function(){var ye=this.readVarint()+this.pos,Ve=this.buf.subarray(this.pos,ye);return this.pos=ye,Ve},readPackedVarint:function(ye,Ve){if(this.type!==z.Bytes)return ye.push(this.readVarint(Ve));var oe=fe(this);for(ye=ye||[];this.pos<oe;)ye.push(this.readVarint(Ve));return ye},readPackedSVarint:function(ye){if(this.type!==z.Bytes)return ye.push(this.readSVarint());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readSVarint());return ye},readPackedBoolean:function(ye){if(this.type!==z.Bytes)return ye.push(this.readBoolean());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readBoolean());return ye},readPackedFloat:function(ye){if(this.type!==z.Bytes)return ye.push(this.readFloat());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readFloat());return ye},readPackedDouble:function(ye){if(this.type!==z.Bytes)return ye.push(this.readDouble());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readDouble());return ye},readPackedFixed32:function(ye){if(this.type!==z.Bytes)return ye.push(this.readFixed32());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readFixed32());return ye},readPackedSFixed32:function(ye){if(this.type!==z.Bytes)return ye.push(this.readSFixed32());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readSFixed32());return ye},readPackedFixed64:function(ye){if(this.type!==z.Bytes)return ye.push(this.readFixed64());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readFixed64());return ye},readPackedSFixed64:function(ye){if(this.type!==z.Bytes)return ye.push(this.readSFixed64());var Ve=fe(this);for(ye=ye||[];this.pos<Ve;)ye.push(this.readSFixed64());return ye},skip:function(ye){var Ve=ye&7;if(Ve===z.Varint)for(;this.buf[this.pos++]>127;);else if(Ve===z.Bytes)this.pos=this.readVarint()+this.pos;else if(Ve===z.Fixed32)this.pos+=4;else if(Ve===z.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Ve)},writeTag:function(ye,Ve){this.writeVarint(ye<<3|Ve)},realloc:function(ye){for(var Ve=this.length||16;Ve<this.pos+ye;)Ve*=2;if(Ve!==this.length){var oe=new Uint8Array(Ve);oe.set(this.buf),this.buf=oe,this.length=Ve}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ye){this.realloc(4),se(this.buf,ye,this.pos),this.pos+=4},writeSFixed32:function(ye){this.realloc(4),se(this.buf,ye,this.pos),this.pos+=4},writeFixed64:function(ye){this.realloc(8),se(this.buf,ye&-1,this.pos),se(this.buf,Math.floor(ye*D),this.pos+4),this.pos+=8},writeSFixed64:function(ye){this.realloc(8),se(this.buf,ye&-1,this.pos),se(this.buf,Math.floor(ye*D),this.pos+4),this.pos+=8},writeVarint:function(ye){if(ye=+ye||0,ye>268435455||ye<0){Be(ye,this);return}this.realloc(4),this.buf[this.pos++]=ye&127|(ye>127?128:0),!(ye<=127)&&(this.buf[this.pos++]=(ye>>>=7)&127|(ye>127?128:0),!(ye<=127)&&(this.buf[this.pos++]=(ye>>>=7)&127|(ye>127?128:0),!(ye<=127)&&(this.buf[this.pos++]=ye>>>7&127)))},writeSVarint:function(ye){this.writeVarint(ye<0?-ye*2-1:ye*2)},writeBoolean:function(ye){this.writeVarint(!!ye)},writeString:function(ye){ye=String(ye),this.realloc(ye.length*4),this.pos++;var Ve=this.pos;this.pos=Rt(this.buf,ye,this.pos);var oe=this.pos-Ve;oe>=128&&U(Ve,oe,this),this.pos=Ve-1,this.writeVarint(oe),this.pos+=oe},writeFloat:function(ye){this.realloc(4),F.write(this.buf,ye,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ye){this.realloc(8),F.write(this.buf,ye,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ye){var Ve=ye.length;this.writeVarint(Ve),this.realloc(Ve);for(var oe=0;oe<Ve;oe++)this.buf[this.pos++]=ye[oe]},writeRawMessage:function(ye,Ve){this.pos++;var oe=this.pos;ye(Ve,this);var Re=this.pos-oe;Re>=128&&U(oe,Re,this),this.pos=oe-1,this.writeVarint(Re),this.pos+=Re},writeMessage:function(ye,Ve,oe){this.writeTag(ye,z.Bytes),this.writeRawMessage(Ve,oe)},writePackedVarint:function(ye,Ve){Ve.length&&this.writeMessage(ye,q,Ve)},writePackedSVarint:function(ye,Ve){Ve.length&&this.writeMessage(ye,le,Ve)},writePackedBoolean:function(ye,Ve){Ve.length&&this.writeMessage(ye,$e,Ve)},writePackedFloat:function(ye,Ve){Ve.length&&this.writeMessage(ye,j,Ve)},writePackedDouble:function(ye,Ve){Ve.length&&this.writeMessage(ye,Ce,Ve)},writePackedFixed32:function(ye,Ve){Ve.length&&this.writeMessage(ye,Fe,Ve)},writePackedSFixed32:function(ye,Ve){Ve.length&&this.writeMessage(ye,lt,Ve)},writePackedFixed64:function(ye,Ve){Ve.length&&this.writeMessage(ye,We,Ve)},writePackedSFixed64:function(ye,Ve){Ve.length&&this.writeMessage(ye,Ze,Ve)},writeBytesField:function(ye,Ve){this.writeTag(ye,z.Bytes),this.writeBytes(Ve)},writeFixed32Field:function(ye,Ve){this.writeTag(ye,z.Fixed32),this.writeFixed32(Ve)},writeSFixed32Field:function(ye,Ve){this.writeTag(ye,z.Fixed32),this.writeSFixed32(Ve)},writeFixed64Field:function(ye,Ve){this.writeTag(ye,z.Fixed64),this.writeFixed64(Ve)},writeSFixed64Field:function(ye,Ve){this.writeTag(ye,z.Fixed64),this.writeSFixed64(Ve)},writeVarintField:function(ye,Ve){this.writeTag(ye,z.Varint),this.writeVarint(Ve)},writeSVarintField:function(ye,Ve){this.writeTag(ye,z.Varint),this.writeSVarint(Ve)},writeStringField:function(ye,Ve){this.writeTag(ye,z.Bytes),this.writeString(Ve)},writeFloatField:function(ye,Ve){this.writeTag(ye,z.Fixed32),this.writeFloat(Ve)},writeDoubleField:function(ye,Ve){this.writeTag(ye,z.Fixed64),this.writeDouble(Ve)},writeBooleanField:function(ye,Ve){this.writeVarintField(ye,!!Ve)}};function W(ye,Ve,oe){var Re=oe.buf,Se,et;if(et=Re[oe.pos++],Se=(et&112)>>4,et<128||(et=Re[oe.pos++],Se|=(et&127)<<3,et<128)||(et=Re[oe.pos++],Se|=(et&127)<<10,et<128)||(et=Re[oe.pos++],Se|=(et&127)<<17,et<128)||(et=Re[oe.pos++],Se|=(et&127)<<24,et<128)||(et=Re[oe.pos++],Se|=(et&1)<<31,et<128))return J(ye,Se,Ve);throw new Error("Expected varint not more than 10 bytes")}function fe(ye){return ye.type===z.Bytes?ye.readVarint()+ye.pos:ye.pos+1}function J(ye,Ve,oe){return oe?Ve*4294967296+(ye>>>0):(Ve>>>0)*4294967296+(ye>>>0)}function Be(ye,Ve){var oe,Re;if(ye>=0?(oe=ye%4294967296|0,Re=ye/4294967296|0):(oe=~(-ye%4294967296),Re=~(-ye/4294967296),oe^4294967295?oe=oe+1|0:(oe=0,Re=Re+1|0)),ye>=18446744073709552e3||ye<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Ve.realloc(10),B(oe,Re,Ve),ee(Re,Ve)}function B(ye,Ve,oe){oe.buf[oe.pos++]=ye&127|128,ye>>>=7,oe.buf[oe.pos++]=ye&127|128,ye>>>=7,oe.buf[oe.pos++]=ye&127|128,ye>>>=7,oe.buf[oe.pos++]=ye&127|128,ye>>>=7,oe.buf[oe.pos]=ye&127}function ee(ye,Ve){var oe=(ye&7)<<4;Ve.buf[Ve.pos++]|=oe|((ye>>>=3)?128:0),ye&&(Ve.buf[Ve.pos++]=ye&127|((ye>>>=7)?128:0),ye&&(Ve.buf[Ve.pos++]=ye&127|((ye>>>=7)?128:0),ye&&(Ve.buf[Ve.pos++]=ye&127|((ye>>>=7)?128:0),ye&&(Ve.buf[Ve.pos++]=ye&127|((ye>>>=7)?128:0),ye&&(Ve.buf[Ve.pos++]=ye&127)))))}function U(ye,Ve,oe){var Re=Ve<=16383?1:Ve<=2097151?2:Ve<=268435455?3:Math.floor(Math.log(Ve)/(Math.LN2*7));oe.realloc(Re);for(var Se=oe.pos-1;Se>=ye;Se--)oe.buf[Se+Re]=oe.buf[Se]}function q(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeVarint(ye[oe])}function le(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeSVarint(ye[oe])}function j(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeFloat(ye[oe])}function Ce(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeDouble(ye[oe])}function $e(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeBoolean(ye[oe])}function Fe(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeFixed32(ye[oe])}function lt(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeSFixed32(ye[oe])}function We(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeFixed64(ye[oe])}function Ze(ye,Ve){for(var oe=0;oe<ye.length;oe++)Ve.writeSFixed64(ye[oe])}function pe(ye,Ve){return(ye[Ve]|ye[Ve+1]<<8|ye[Ve+2]<<16)+ye[Ve+3]*16777216}function se(ye,Ve,oe){ye[oe]=Ve,ye[oe+1]=Ve>>>8,ye[oe+2]=Ve>>>16,ye[oe+3]=Ve>>>24}function be(ye,Ve){return(ye[Ve]|ye[Ve+1]<<8|ye[Ve+2]<<16)+(ye[Ve+3]<<24)}function Te(ye,Ve,oe){for(var Re="",Se=Ve;Se<oe;){var et=ye[Se],st=null,pt=et>239?4:et>223?3:et>191?2:1;if(Se+pt>oe)break;var bt,ke,ur;pt===1?et<128&&(st=et):pt===2?(bt=ye[Se+1],(bt&192)===128&&(st=(et&31)<<6|bt&63,st<=127&&(st=null))):pt===3?(bt=ye[Se+1],ke=ye[Se+2],(bt&192)===128&&(ke&192)===128&&(st=(et&15)<<12|(bt&63)<<6|ke&63,(st<=2047||st>=55296&&st<=57343)&&(st=null))):pt===4&&(bt=ye[Se+1],ke=ye[Se+2],ur=ye[Se+3],(bt&192)===128&&(ke&192)===128&&(ur&192)===128&&(st=(et&15)<<18|(bt&63)<<12|(ke&63)<<6|ur&63,(st<=65535||st>=1114112)&&(st=null))),st===null?(st=65533,pt=1):st>65535&&(st-=65536,Re+=String.fromCharCode(st>>>10&1023|55296),st=56320|st&1023),Re+=String.fromCharCode(st),Se+=pt}return Re}function de(ye,Ve,oe){return X.decode(ye.subarray(Ve,oe))}function Rt(ye,Ve,oe){for(var Re=0,Se,et;Re<Ve.length;Re++){if(Se=Ve.charCodeAt(Re),Se>55295&&Se<57344)if(et)if(Se<56320){ye[oe++]=239,ye[oe++]=191,ye[oe++]=189,et=Se;continue}else Se=et-55296<<10|Se-56320|65536,et=null;else{Se>56319||Re+1===Ve.length?(ye[oe++]=239,ye[oe++]=191,ye[oe++]=189):et=Se;continue}else et&&(ye[oe++]=239,ye[oe++]=191,ye[oe++]=189,et=null);Se<128?ye[oe++]=Se:(Se<2048?ye[oe++]=Se>>6|192:(Se<65536?ye[oe++]=Se>>12|224:(ye[oe++]=Se>>18|240,ye[oe++]=Se>>12&63|128),ye[oe++]=Se>>6&63|128),ye[oe++]=Se&63|128)}return oe}},32676:function(He,w,x){var F=x(34155);(function(z,h){He.exports=h()})(this,function(){"use strict";function z(it,V){var H={label:0,sent:function(){if(ze[0]&1)throw ze[1];return ze[1]},trys:[],ops:[]},Ee,Le,ze,xt;return xt={next:Ut(0),throw:Ut(1),return:Ut(2)},typeof Symbol=="function"&&(xt[Symbol.iterator]=function(){return this}),xt;function Ut(Ft){return function(te){return ir([Ft,te])}}function ir(Ft){if(Ee)throw new TypeError("Generator is already executing.");for(;H;)try{if(Ee=1,Le&&(ze=Ft[0]&2?Le.return:Ft[0]?Le.throw||((ze=Le.return)&&ze.call(Le),0):Le.next)&&!(ze=ze.call(Le,Ft[1])).done)return ze;switch(Le=0,ze&&(Ft=[Ft[0]&2,ze.value]),Ft[0]){case 0:case 1:ze=Ft;break;case 4:return H.label++,{value:Ft[1],done:!1};case 5:H.label++,Le=Ft[1],Ft=[0];continue;case 7:Ft=H.ops.pop(),H.trys.pop();continue;default:if(ze=H.trys,!(ze=ze.length>0&&ze[ze.length-1])&&(Ft[0]===6||Ft[0]===2)){H=0;continue}if(Ft[0]===3&&(!ze||Ft[1]>ze[0]&&Ft[1]<ze[3])){H.label=Ft[1];break}if(Ft[0]===6&&H.label<ze[1]){H.label=ze[1],ze=Ft;break}if(ze&&H.label<ze[2]){H.label=ze[2],H.ops.push(Ft);break}ze[2]&&H.ops.pop(),H.trys.pop();continue}Ft=V.call(it,H)}catch(te){Ft=[6,te],Le=0}finally{Ee=ze=0}if(Ft[0]&5)throw Ft[1];return{value:Ft[0]?Ft[1]:void 0,done:!0}}}var h=function(){function it(V,H){this.next=null,this.key=V,this.data=H,this.left=null,this.right=null}return it}();function D(it,V){return it>V?1:it<V?-1:0}function P(it,V,H){for(var Ee=new h(null,null),Le=Ee,ze=Ee;;){var xt=H(it,V.key);if(xt<0){if(V.left===null)break;if(H(it,V.left.key)<0){var Ut=V.left;if(V.left=Ut.right,Ut.right=V,V=Ut,V.left===null)break}ze.left=V,ze=V,V=V.left}else if(xt>0){if(V.right===null)break;if(H(it,V.right.key)>0){var Ut=V.right;if(V.right=Ut.left,Ut.left=V,V=Ut,V.right===null)break}Le.right=V,Le=V,V=V.right}else break}return Le.right=V.left,ze.left=V.right,V.left=Ee.right,V.right=Ee.left,V}function X(it,V,H,Ee){var Le=new h(it,V);if(H===null)return Le.left=Le.right=null,Le;H=P(it,H,Ee);var ze=Ee(it,H.key);return ze<0?(Le.left=H.left,Le.right=H,H.left=null):ze>=0&&(Le.right=H.right,Le.left=H,H.right=null),Le}function W(it,V,H){var Ee=null,Le=null;if(V){V=P(it,V,H);var ze=H(V.key,it);ze===0?(Ee=V.left,Le=V.right):ze<0?(Le=V.right,V.right=null,Ee=V):(Ee=V.left,V.left=null,Le=V)}return{left:Ee,right:Le}}function fe(it,V,H){return V===null?it:(it===null||(V=P(it.key,V,H),V.left=it),V)}function J(it,V,H,Ee,Le){if(it){Ee(""+V+(H?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+Le(it)+`
`);var ze=V+(H?"    ":"\u2502   ");it.left&&J(it.left,ze,!1,Ee,Le),it.right&&J(it.right,ze,!0,Ee,Le)}}var Be=function(){function it(V){V===void 0&&(V=D),this._root=null,this._size=0,this._comparator=V}return it.prototype.insert=function(V,H){return this._size++,this._root=X(V,H,this._root,this._comparator)},it.prototype.add=function(V,H){var Ee=new h(V,H);this._root===null&&(Ee.left=Ee.right=null,this._size++,this._root=Ee);var Le=this._comparator,ze=P(V,this._root,Le),xt=Le(V,ze.key);return xt===0?this._root=ze:(xt<0?(Ee.left=ze.left,Ee.right=ze,ze.left=null):xt>0&&(Ee.right=ze.right,Ee.left=ze,ze.right=null),this._size++,this._root=Ee),this._root},it.prototype.remove=function(V){this._root=this._remove(V,this._root,this._comparator)},it.prototype._remove=function(V,H,Ee){var Le;if(H===null)return null;H=P(V,H,Ee);var ze=Ee(V,H.key);return ze===0?(H.left===null?Le=H.right:(Le=P(V,H.left,Ee),Le.right=H.right),this._size--,Le):H},it.prototype.pop=function(){var V=this._root;if(V){for(;V.left;)V=V.left;return this._root=P(V.key,this._root,this._comparator),this._root=this._remove(V.key,this._root,this._comparator),{key:V.key,data:V.data}}return null},it.prototype.findStatic=function(V){for(var H=this._root,Ee=this._comparator;H;){var Le=Ee(V,H.key);if(Le===0)return H;Le<0?H=H.left:H=H.right}return null},it.prototype.find=function(V){return this._root&&(this._root=P(V,this._root,this._comparator),this._comparator(V,this._root.key)!==0)?null:this._root},it.prototype.contains=function(V){for(var H=this._root,Ee=this._comparator;H;){var Le=Ee(V,H.key);if(Le===0)return!0;Le<0?H=H.left:H=H.right}return!1},it.prototype.forEach=function(V,H){for(var Ee=this._root,Le=[],ze=!1;!ze;)Ee!==null?(Le.push(Ee),Ee=Ee.left):Le.length!==0?(Ee=Le.pop(),V.call(H,Ee),Ee=Ee.right):ze=!0;return this},it.prototype.range=function(V,H,Ee,Le){for(var ze=[],xt=this._comparator,Ut=this._root,ir;ze.length!==0||Ut;)if(Ut)ze.push(Ut),Ut=Ut.left;else{if(Ut=ze.pop(),ir=xt(Ut.key,H),ir>0)break;if(xt(Ut.key,V)>=0&&Ee.call(Le,Ut))return this;Ut=Ut.right}return this},it.prototype.keys=function(){var V=[];return this.forEach(function(H){var Ee=H.key;return V.push(Ee)}),V},it.prototype.values=function(){var V=[];return this.forEach(function(H){var Ee=H.data;return V.push(Ee)}),V},it.prototype.min=function(){return this._root?this.minNode(this._root).key:null},it.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},it.prototype.minNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.left;)V=V.left;return V},it.prototype.maxNode=function(V){if(V===void 0&&(V=this._root),V)for(;V.right;)V=V.right;return V},it.prototype.at=function(V){for(var H=this._root,Ee=!1,Le=0,ze=[];!Ee;)if(H)ze.push(H),H=H.left;else if(ze.length>0){if(H=ze.pop(),Le===V)return H;Le++,H=H.right}else Ee=!0;return null},it.prototype.next=function(V){var H=this._root,Ee=null;if(V.right){for(Ee=V.right;Ee.left;)Ee=Ee.left;return Ee}for(var Le=this._comparator;H;){var ze=Le(V.key,H.key);if(ze===0)break;ze<0?(Ee=H,H=H.left):H=H.right}return Ee},it.prototype.prev=function(V){var H=this._root,Ee=null;if(V.left!==null){for(Ee=V.left;Ee.right;)Ee=Ee.right;return Ee}for(var Le=this._comparator;H;){var ze=Le(V.key,H.key);if(ze===0)break;ze<0?H=H.left:(Ee=H,H=H.right)}return Ee},it.prototype.clear=function(){return this._root=null,this._size=0,this},it.prototype.toList=function(){return U(this._root)},it.prototype.load=function(V,H,Ee){H===void 0&&(H=[]),Ee===void 0&&(Ee=!1);var Le=V.length,ze=this._comparator;if(Ee&&j(V,H,0,Le-1,ze),this._root===null)this._root=B(V,H,0,Le),this._size=Le;else{var xt=le(this.toList(),ee(V,H),ze);Le=this._size+Le,this._root=q({head:xt},0,Le)}return this},it.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(it.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(it.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),it.prototype.toString=function(V){V===void 0&&(V=function(Ee){return String(Ee.key)});var H=[];return J(this._root,"",!0,function(Ee){return H.push(Ee)},V),H.join("")},it.prototype.update=function(V,H,Ee){var Le=this._comparator,ze=W(V,this._root,Le),xt=ze.left,Ut=ze.right;Le(V,H)<0?Ut=X(H,Ee,Ut,Le):xt=X(H,Ee,xt,Le),this._root=fe(xt,Ut,Le)},it.prototype.split=function(V){return W(V,this._root,this._comparator)},it.prototype[Symbol.iterator]=function(){var V,H,Ee;return z(this,function(Le){switch(Le.label){case 0:V=this._root,H=[],Ee=!1,Le.label=1;case 1:return Ee?[3,6]:V===null?[3,2]:(H.push(V),V=V.left,[3,5]);case 2:return H.length===0?[3,4]:(V=H.pop(),[4,V]);case 3:return Le.sent(),V=V.right,[3,5];case 4:Ee=!0,Le.label=5;case 5:return[3,1];case 6:return[2]}})},it}();function B(it,V,H,Ee){var Le=Ee-H;if(Le>0){var ze=H+Math.floor(Le/2),xt=it[ze],Ut=V[ze],ir=new h(xt,Ut);return ir.left=B(it,V,H,ze),ir.right=B(it,V,ze+1,Ee),ir}return null}function ee(it,V){for(var H=new h(null,null),Ee=H,Le=0;Le<it.length;Le++)Ee=Ee.next=new h(it[Le],V[Le]);return Ee.next=null,H.next}function U(it){for(var V=it,H=[],Ee=!1,Le=new h(null,null),ze=Le;!Ee;)V?(H.push(V),V=V.left):H.length>0?(V=ze=ze.next=H.pop(),V=V.right):Ee=!0;return ze.next=null,Le.next}function q(it,V,H){var Ee=H-V;if(Ee>0){var Le=V+Math.floor(Ee/2),ze=q(it,V,Le),xt=it.head;return xt.left=ze,it.head=it.head.next,xt.right=q(it,Le+1,H),xt}return null}function le(it,V,H){for(var Ee=new h(null,null),Le=Ee,ze=it,xt=V;ze!==null&&xt!==null;)H(ze.key,xt.key)<0?(Le.next=ze,ze=ze.next):(Le.next=xt,xt=xt.next),Le=Le.next;return ze!==null?Le.next=ze:xt!==null&&(Le.next=xt),Ee.next}function j(it,V,H,Ee,Le){if(!(H>=Ee)){for(var ze=it[H+Ee>>1],xt=H-1,Ut=Ee+1;;){do xt++;while(Le(it[xt],ze)<0);do Ut--;while(Le(it[Ut],ze)>0);if(xt>=Ut)break;var ir=it[xt];it[xt]=it[Ut],it[Ut]=ir,ir=V[xt],V[xt]=V[Ut],V[Ut]=ir}j(it,V,H,Ut,Le),j(it,V,Ut+1,Ee,Le)}}const Ce=(it,V)=>it.ll.x<=V.x&&V.x<=it.ur.x&&it.ll.y<=V.y&&V.y<=it.ur.y,$e=(it,V)=>{if(V.ur.x<it.ll.x||it.ur.x<V.ll.x||V.ur.y<it.ll.y||it.ur.y<V.ll.y)return null;const H=it.ll.x<V.ll.x?V.ll.x:it.ll.x,Ee=it.ur.x<V.ur.x?it.ur.x:V.ur.x,Le=it.ll.y<V.ll.y?V.ll.y:it.ll.y,ze=it.ur.y<V.ur.y?it.ur.y:V.ur.y;return{ll:{x:H,y:Le},ur:{x:Ee,y:ze}}};let Fe=Number.EPSILON;Fe===void 0&&(Fe=Math.pow(2,-52));const lt=Fe*Fe,We=(it,V)=>{if(-Fe<it&&it<Fe&&-Fe<V&&V<Fe)return 0;const H=it-V;return H*H<lt*it*V?0:it<V?-1:1};class Ze{constructor(){this.reset()}reset(){this.xRounder=new pe,this.yRounder=new pe}round(V,H){return{x:this.xRounder.round(V),y:this.yRounder.round(H)}}}class pe{constructor(){this.tree=new Be,this.round(0)}round(V){const H=this.tree.add(V),Ee=this.tree.prev(H);if(Ee!==null&&We(H.key,Ee.key)===0)return this.tree.remove(V),Ee.key;const Le=this.tree.next(H);return Le!==null&&We(H.key,Le.key)===0?(this.tree.remove(V),Le.key):V}}const se=new Ze,be=11102230246251565e-32,Te=134217729,de=(3+8*be)*be;function Rt(it,V,H,Ee,Le){let ze,xt,Ut,ir,Ft=V[0],te=Ee[0],Q=0,ve=0;te>Ft==te>-Ft?(ze=Ft,Ft=V[++Q]):(ze=te,te=Ee[++ve]);let Oe=0;if(Q<it&&ve<H)for(te>Ft==te>-Ft?(xt=Ft+ze,Ut=ze-(xt-Ft),Ft=V[++Q]):(xt=te+ze,Ut=ze-(xt-te),te=Ee[++ve]),ze=xt,Ut!==0&&(Le[Oe++]=Ut);Q<it&&ve<H;)te>Ft==te>-Ft?(xt=ze+Ft,ir=xt-ze,Ut=ze-(xt-ir)+(Ft-ir),Ft=V[++Q]):(xt=ze+te,ir=xt-ze,Ut=ze-(xt-ir)+(te-ir),te=Ee[++ve]),ze=xt,Ut!==0&&(Le[Oe++]=Ut);for(;Q<it;)xt=ze+Ft,ir=xt-ze,Ut=ze-(xt-ir)+(Ft-ir),Ft=V[++Q],ze=xt,Ut!==0&&(Le[Oe++]=Ut);for(;ve<H;)xt=ze+te,ir=xt-ze,Ut=ze-(xt-ir)+(te-ir),te=Ee[++ve],ze=xt,Ut!==0&&(Le[Oe++]=Ut);return(ze!==0||Oe===0)&&(Le[Oe++]=ze),Oe}function ye(it,V){let H=V[0];for(let Ee=1;Ee<it;Ee++)H+=V[Ee];return H}function Ve(it){return new Float64Array(it)}const oe=(3+16*be)*be,Re=(2+12*be)*be,Se=(9+64*be)*be*be,et=Ve(4),st=Ve(8),pt=Ve(12),bt=Ve(16),ke=Ve(4);function ur(it,V,H,Ee,Le,ze,xt){let Ut,ir,Ft,te,Q,ve,Oe,Xe,ft,Et,Ne,Ue,vt,ue,Lr,lr,$r,Rn;const nn=it-Le,xr=H-Le,Or=V-ze,sn=Ee-ze;ue=nn*sn,ve=Te*nn,Oe=ve-(ve-nn),Xe=nn-Oe,ve=Te*sn,ft=ve-(ve-sn),Et=sn-ft,Lr=Xe*Et-(ue-Oe*ft-Xe*ft-Oe*Et),lr=Or*xr,ve=Te*Or,Oe=ve-(ve-Or),Xe=Or-Oe,ve=Te*xr,ft=ve-(ve-xr),Et=xr-ft,$r=Xe*Et-(lr-Oe*ft-Xe*ft-Oe*Et),Ne=Lr-$r,Q=Lr-Ne,et[0]=Lr-(Ne+Q)+(Q-$r),Ue=ue+Ne,Q=Ue-ue,vt=ue-(Ue-Q)+(Ne-Q),Ne=vt-lr,Q=vt-Ne,et[1]=vt-(Ne+Q)+(Q-lr),Rn=Ue+Ne,Q=Rn-Ue,et[2]=Ue-(Rn-Q)+(Ne-Q),et[3]=Rn;let xn=ye(4,et),wi=Re*xt;if(xn>=wi||-xn>=wi||(Q=it-nn,Ut=it-(nn+Q)+(Q-Le),Q=H-xr,Ft=H-(xr+Q)+(Q-Le),Q=V-Or,ir=V-(Or+Q)+(Q-ze),Q=Ee-sn,te=Ee-(sn+Q)+(Q-ze),Ut===0&&ir===0&&Ft===0&&te===0)||(wi=Se*xt+de*Math.abs(xn),xn+=nn*te+sn*Ut-(Or*Ft+xr*ir),xn>=wi||-xn>=wi))return xn;ue=Ut*sn,ve=Te*Ut,Oe=ve-(ve-Ut),Xe=Ut-Oe,ve=Te*sn,ft=ve-(ve-sn),Et=sn-ft,Lr=Xe*Et-(ue-Oe*ft-Xe*ft-Oe*Et),lr=ir*xr,ve=Te*ir,Oe=ve-(ve-ir),Xe=ir-Oe,ve=Te*xr,ft=ve-(ve-xr),Et=xr-ft,$r=Xe*Et-(lr-Oe*ft-Xe*ft-Oe*Et),Ne=Lr-$r,Q=Lr-Ne,ke[0]=Lr-(Ne+Q)+(Q-$r),Ue=ue+Ne,Q=Ue-ue,vt=ue-(Ue-Q)+(Ne-Q),Ne=vt-lr,Q=vt-Ne,ke[1]=vt-(Ne+Q)+(Q-lr),Rn=Ue+Ne,Q=Rn-Ue,ke[2]=Ue-(Rn-Q)+(Ne-Q),ke[3]=Rn;const Nn=Rt(4,et,4,ke,st);ue=nn*te,ve=Te*nn,Oe=ve-(ve-nn),Xe=nn-Oe,ve=Te*te,ft=ve-(ve-te),Et=te-ft,Lr=Xe*Et-(ue-Oe*ft-Xe*ft-Oe*Et),lr=Or*Ft,ve=Te*Or,Oe=ve-(ve-Or),Xe=Or-Oe,ve=Te*Ft,ft=ve-(ve-Ft),Et=Ft-ft,$r=Xe*Et-(lr-Oe*ft-Xe*ft-Oe*Et),Ne=Lr-$r,Q=Lr-Ne,ke[0]=Lr-(Ne+Q)+(Q-$r),Ue=ue+Ne,Q=Ue-ue,vt=ue-(Ue-Q)+(Ne-Q),Ne=vt-lr,Q=vt-Ne,ke[1]=vt-(Ne+Q)+(Q-lr),Rn=Ue+Ne,Q=Rn-Ue,ke[2]=Ue-(Rn-Q)+(Ne-Q),ke[3]=Rn;const Bi=Rt(Nn,st,4,ke,pt);ue=Ut*te,ve=Te*Ut,Oe=ve-(ve-Ut),Xe=Ut-Oe,ve=Te*te,ft=ve-(ve-te),Et=te-ft,Lr=Xe*Et-(ue-Oe*ft-Xe*ft-Oe*Et),lr=ir*Ft,ve=Te*ir,Oe=ve-(ve-ir),Xe=ir-Oe,ve=Te*Ft,ft=ve-(ve-Ft),Et=Ft-ft,$r=Xe*Et-(lr-Oe*ft-Xe*ft-Oe*Et),Ne=Lr-$r,Q=Lr-Ne,ke[0]=Lr-(Ne+Q)+(Q-$r),Ue=ue+Ne,Q=Ue-ue,vt=ue-(Ue-Q)+(Ne-Q),Ne=vt-lr,Q=vt-Ne,ke[1]=vt-(Ne+Q)+(Q-lr),Rn=Ue+Ne,Q=Rn-Ue,ke[2]=Ue-(Rn-Q)+(Ne-Q),ke[3]=Rn;const sa=Rt(Bi,pt,4,ke,bt);return bt[sa-1]}function qt(it,V,H,Ee,Le,ze){const xt=(V-ze)*(H-Le),Ut=(it-Le)*(Ee-ze),ir=xt-Ut,Ft=Math.abs(xt+Ut);return Math.abs(ir)>=oe*Ft?ir:-ur(it,V,H,Ee,Le,ze,Ft)}const _n=(it,V)=>it.x*V.y-it.y*V.x,Zr=(it,V)=>it.x*V.x+it.y*V.y,Vr=(it,V,H)=>{const Ee=qt(it.x,it.y,V.x,V.y,H.x,H.y);return Ee>0?-1:Ee<0?1:0},rn=it=>Math.sqrt(Zr(it,it)),Qr=(it,V,H)=>{const Ee={x:V.x-it.x,y:V.y-it.y},Le={x:H.x-it.x,y:H.y-it.y};return _n(Le,Ee)/rn(Le)/rn(Ee)},ln=(it,V,H)=>{const Ee={x:V.x-it.x,y:V.y-it.y},Le={x:H.x-it.x,y:H.y-it.y};return Zr(Le,Ee)/rn(Le)/rn(Ee)},vn=(it,V,H)=>V.y===0?null:{x:it.x+V.x/V.y*(H-it.y),y:H},$t=(it,V,H)=>V.x===0?null:{x:H,y:it.y+V.y/V.x*(H-it.x)},_r=(it,V,H,Ee)=>{if(V.x===0)return $t(H,Ee,it.x);if(Ee.x===0)return $t(it,V,H.x);if(V.y===0)return vn(H,Ee,it.y);if(Ee.y===0)return vn(it,V,H.y);const Le=_n(V,Ee);if(Le==0)return null;const ze={x:H.x-it.x,y:H.y-it.y},xt=_n(ze,V)/Le,Ut=_n(ze,Ee)/Le,ir=it.x+Ut*V.x,Ft=H.x+xt*Ee.x,te=it.y+Ut*V.y,Q=H.y+xt*Ee.y,ve=(ir+Ft)/2,Oe=(te+Q)/2;return{x:ve,y:Oe}};class kt{static compare(V,H){const Ee=kt.comparePoints(V.point,H.point);return Ee!==0?Ee:(V.point!==H.point&&V.link(H),V.isLeft!==H.isLeft?V.isLeft?1:-1:Sr.compare(V.segment,H.segment))}static comparePoints(V,H){return V.x<H.x?-1:V.x>H.x?1:V.y<H.y?-1:V.y>H.y?1:0}constructor(V,H){V.events===void 0?V.events=[this]:V.events.push(this),this.point=V,this.isLeft=H}link(V){if(V.point===this.point)throw new Error("Tried to link already linked events");const H=V.point.events;for(let Ee=0,Le=H.length;Ee<Le;Ee++){const ze=H[Ee];this.point.events.push(ze),ze.point=this.point}this.checkForConsuming()}checkForConsuming(){const V=this.point.events.length;for(let H=0;H<V;H++){const Ee=this.point.events[H];if(Ee.segment.consumedBy===void 0)for(let Le=H+1;Le<V;Le++){const ze=this.point.events[Le];ze.consumedBy===void 0&&Ee.otherSE.point.events===ze.otherSE.point.events&&Ee.segment.consume(ze.segment)}}}getAvailableLinkedEvents(){const V=[];for(let H=0,Ee=this.point.events.length;H<Ee;H++){const Le=this.point.events[H];Le!==this&&!Le.segment.ringOut&&Le.segment.isInResult()&&V.push(Le)}return V}getLeftmostComparator(V){const H=new Map,Ee=Le=>{const ze=Le.otherSE;H.set(Le,{sine:Qr(this.point,V.point,ze.point),cosine:ln(this.point,V.point,ze.point)})};return(Le,ze)=>{H.has(Le)||Ee(Le),H.has(ze)||Ee(ze);const{sine:xt,cosine:Ut}=H.get(Le),{sine:ir,cosine:Ft}=H.get(ze);return xt>=0&&ir>=0?Ut<Ft?1:Ut>Ft?-1:0:xt<0&&ir<0?Ut<Ft?-1:Ut>Ft?1:0:ir<xt?-1:ir>xt?1:0}}}let qe=0;class Sr{static compare(V,H){const Ee=V.leftSE.point.x,Le=H.leftSE.point.x,ze=V.rightSE.point.x,xt=H.rightSE.point.x;if(xt<Ee)return 1;if(ze<Le)return-1;const Ut=V.leftSE.point.y,ir=H.leftSE.point.y,Ft=V.rightSE.point.y,te=H.rightSE.point.y;if(Ee<Le){if(ir<Ut&&ir<Ft)return 1;if(ir>Ut&&ir>Ft)return-1;const Q=V.comparePoint(H.leftSE.point);if(Q<0)return 1;if(Q>0)return-1;const ve=H.comparePoint(V.rightSE.point);return ve!==0?ve:-1}if(Ee>Le){if(Ut<ir&&Ut<te)return-1;if(Ut>ir&&Ut>te)return 1;const Q=H.comparePoint(V.leftSE.point);if(Q!==0)return Q;const ve=V.comparePoint(H.rightSE.point);return ve<0?1:ve>0?-1:1}if(Ut<ir)return-1;if(Ut>ir)return 1;if(ze<xt){const Q=H.comparePoint(V.rightSE.point);if(Q!==0)return Q}if(ze>xt){const Q=V.comparePoint(H.rightSE.point);if(Q<0)return 1;if(Q>0)return-1}if(ze!==xt){const Q=Ft-Ut,ve=ze-Ee,Oe=te-ir,Xe=xt-Le;if(Q>ve&&Oe<Xe)return 1;if(Q<ve&&Oe>Xe)return-1}return ze>xt?1:ze<xt||Ft<te?-1:Ft>te?1:V.id<H.id?-1:V.id>H.id?1:0}constructor(V,H,Ee,Le){this.id=++qe,this.leftSE=V,V.segment=this,V.otherSE=H,this.rightSE=H,H.segment=this,H.otherSE=V,this.rings=Ee,this.windings=Le}static fromRing(V,H,Ee){let Le,ze,xt;const Ut=kt.comparePoints(V,H);if(Ut<0)Le=V,ze=H,xt=1;else if(Ut>0)Le=H,ze=V,xt=-1;else throw new Error(`Tried to create degenerate segment at [${V.x}, ${V.y}]`);const ir=new kt(Le,!0),Ft=new kt(ze,!1);return new Sr(ir,Ft,[Ee],[xt])}replaceRightSE(V){this.rightSE=V,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const V=this.leftSE.point.y,H=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:V<H?V:H},ur:{x:this.rightSE.point.x,y:V>H?V:H}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(V){return V.x===this.leftSE.point.x&&V.y===this.leftSE.point.y||V.x===this.rightSE.point.x&&V.y===this.rightSE.point.y}comparePoint(V){if(this.isAnEndpoint(V))return 0;const H=this.leftSE.point,Ee=this.rightSE.point,Le=this.vector();if(H.x===Ee.x)return V.x===H.x?0:V.x<H.x?1:-1;const ze=(V.y-H.y)/Le.y,xt=H.x+ze*Le.x;if(V.x===xt)return 0;const Ut=(V.x-H.x)/Le.x,ir=H.y+Ut*Le.y;return V.y===ir?0:V.y<ir?-1:1}getIntersection(V){const H=this.bbox(),Ee=V.bbox(),Le=$e(H,Ee);if(Le===null)return null;const ze=this.leftSE.point,xt=this.rightSE.point,Ut=V.leftSE.point,ir=V.rightSE.point,Ft=Ce(H,Ut)&&this.comparePoint(Ut)===0,te=Ce(Ee,ze)&&V.comparePoint(ze)===0,Q=Ce(H,ir)&&this.comparePoint(ir)===0,ve=Ce(Ee,xt)&&V.comparePoint(xt)===0;if(te&&Ft)return ve&&!Q?xt:!ve&&Q?ir:null;if(te)return Q&&ze.x===ir.x&&ze.y===ir.y?null:ze;if(Ft)return ve&&xt.x===Ut.x&&xt.y===Ut.y?null:Ut;if(ve&&Q)return null;if(ve)return xt;if(Q)return ir;const Oe=_r(ze,this.vector(),Ut,V.vector());return Oe===null||!Ce(Le,Oe)?null:se.round(Oe.x,Oe.y)}split(V){const H=[],Ee=V.events!==void 0,Le=new kt(V,!0),ze=new kt(V,!1),xt=this.rightSE;this.replaceRightSE(ze),H.push(ze),H.push(Le);const Ut=new Sr(Le,xt,this.rings.slice(),this.windings.slice());return kt.comparePoints(Ut.leftSE.point,Ut.rightSE.point)>0&&Ut.swapEvents(),kt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Ee&&(Le.checkForConsuming(),ze.checkForConsuming()),H}swapEvents(){const V=this.rightSE;this.rightSE=this.leftSE,this.leftSE=V,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let H=0,Ee=this.windings.length;H<Ee;H++)this.windings[H]*=-1}consume(V){let H=this,Ee=V;for(;H.consumedBy;)H=H.consumedBy;for(;Ee.consumedBy;)Ee=Ee.consumedBy;const Le=Sr.compare(H,Ee);if(Le!==0){if(Le>0){const ze=H;H=Ee,Ee=ze}if(H.prev===Ee){const ze=H;H=Ee,Ee=ze}for(let ze=0,xt=Ee.rings.length;ze<xt;ze++){const Ut=Ee.rings[ze],ir=Ee.windings[ze],Ft=H.rings.indexOf(Ut);Ft===-1?(H.rings.push(Ut),H.windings.push(ir)):H.windings[Ft]+=ir}Ee.rings=null,Ee.windings=null,Ee.consumedBy=H,Ee.leftSE.consumedBy=H.leftSE,Ee.rightSE.consumedBy=H.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const V=this.prev.consumedBy||this.prev;this._beforeState=V.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const V=this.beforeState();this._afterState={rings:V.rings.slice(0),windings:V.windings.slice(0),multiPolys:[]};const H=this._afterState.rings,Ee=this._afterState.windings,Le=this._afterState.multiPolys;for(let Ut=0,ir=this.rings.length;Ut<ir;Ut++){const Ft=this.rings[Ut],te=this.windings[Ut],Q=H.indexOf(Ft);Q===-1?(H.push(Ft),Ee.push(te)):Ee[Q]+=te}const ze=[],xt=[];for(let Ut=0,ir=H.length;Ut<ir;Ut++){if(Ee[Ut]===0)continue;const Ft=H[Ut],te=Ft.poly;if(xt.indexOf(te)===-1)if(Ft.isExterior)ze.push(te);else{xt.indexOf(te)===-1&&xt.push(te);const Q=ze.indexOf(Ft.poly);Q!==-1&&ze.splice(Q,1)}}for(let Ut=0,ir=ze.length;Ut<ir;Ut++){const Ft=ze[Ut].multiPoly;Le.indexOf(Ft)===-1&&Le.push(Ft)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const V=this.beforeState().multiPolys,H=this.afterState().multiPolys;switch(Dn.type){case"union":{const Ee=V.length===0,Le=H.length===0;this._isInResult=Ee!==Le;break}case"intersection":{let Ee,Le;V.length<H.length?(Ee=V.length,Le=H.length):(Ee=H.length,Le=V.length),this._isInResult=Le===Dn.numMultiPolys&&Ee<Le;break}case"xor":{const Ee=Math.abs(V.length-H.length);this._isInResult=Ee%2===1;break}case"difference":{const Ee=Le=>Le.length===1&&Le[0].isSubject;this._isInResult=Ee(V)!==Ee(H);break}default:throw new Error(`Unrecognized operation type found ${Dn.type}`)}return this._isInResult}}class Pe{constructor(V,H,Ee){if(!Array.isArray(V)||V.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=H,this.isExterior=Ee,this.segments=[],typeof V[0][0]!="number"||typeof V[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const Le=se.round(V[0][0],V[0][1]);this.bbox={ll:{x:Le.x,y:Le.y},ur:{x:Le.x,y:Le.y}};let ze=Le;for(let xt=1,Ut=V.length;xt<Ut;xt++){if(typeof V[xt][0]!="number"||typeof V[xt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let ir=se.round(V[xt][0],V[xt][1]);ir.x===ze.x&&ir.y===ze.y||(this.segments.push(Sr.fromRing(ze,ir,this)),ir.x<this.bbox.ll.x&&(this.bbox.ll.x=ir.x),ir.y<this.bbox.ll.y&&(this.bbox.ll.y=ir.y),ir.x>this.bbox.ur.x&&(this.bbox.ur.x=ir.x),ir.y>this.bbox.ur.y&&(this.bbox.ur.y=ir.y),ze=ir)}(Le.x!==ze.x||Le.y!==ze.y)&&this.segments.push(Sr.fromRing(ze,Le,this))}getSweepEvents(){const V=[];for(let H=0,Ee=this.segments.length;H<Ee;H++){const Le=this.segments[H];V.push(Le.leftSE),V.push(Le.rightSE)}return V}}class Hr{constructor(V,H){if(!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Pe(V[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let Ee=1,Le=V.length;Ee<Le;Ee++){const ze=new Pe(V[Ee],this,!1);ze.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ze.bbox.ll.x),ze.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ze.bbox.ll.y),ze.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ze.bbox.ur.x),ze.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ze.bbox.ur.y),this.interiorRings.push(ze)}this.multiPoly=H}getSweepEvents(){const V=this.exteriorRing.getSweepEvents();for(let H=0,Ee=this.interiorRings.length;H<Ee;H++){const Le=this.interiorRings[H].getSweepEvents();for(let ze=0,xt=Le.length;ze<xt;ze++)V.push(Le[ze])}return V}}class vr{constructor(V,H){if(!Array.isArray(V))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof V[0][0][0]=="number"&&(V=[V])}catch(Ee){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let Ee=0,Le=V.length;Ee<Le;Ee++){const ze=new Hr(V[Ee],this);ze.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ze.bbox.ll.x),ze.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ze.bbox.ll.y),ze.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ze.bbox.ur.x),ze.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ze.bbox.ur.y),this.polys.push(ze)}this.isSubject=H}getSweepEvents(){const V=[];for(let H=0,Ee=this.polys.length;H<Ee;H++){const Le=this.polys[H].getSweepEvents();for(let ze=0,xt=Le.length;ze<xt;ze++)V.push(Le[ze])}return V}}class Ie{static factory(V){const H=[];for(let Ee=0,Le=V.length;Ee<Le;Ee++){const ze=V[Ee];if(!ze.isInResult()||ze.ringOut)continue;let xt=null,Ut=ze.leftSE,ir=ze.rightSE;const Ft=[Ut],te=Ut.point,Q=[];for(;xt=Ut,Ut=ir,Ft.push(Ut),Ut.point!==te;)for(;;){const ve=Ut.getAvailableLinkedEvents();if(ve.length===0){const ft=Ft[0].point,Et=Ft[Ft.length-1].point;throw new Error(`Unable to complete output ring starting at [${ft.x}, ${ft.y}]. Last matching segment found ends at [${Et.x}, ${Et.y}].`)}if(ve.length===1){ir=ve[0].otherSE;break}let Oe=null;for(let ft=0,Et=Q.length;ft<Et;ft++)if(Q[ft].point===Ut.point){Oe=ft;break}if(Oe!==null){const ft=Q.splice(Oe)[0],Et=Ft.splice(ft.index);Et.unshift(Et[0].otherSE),H.push(new Ie(Et.reverse()));continue}Q.push({index:Ft.length,point:Ut.point});const Xe=Ut.getLeftmostComparator(xt);ir=ve.sort(Xe)[0].otherSE;break}H.push(new Ie(Ft))}return H}constructor(V){this.events=V;for(let H=0,Ee=V.length;H<Ee;H++)V[H].segment.ringOut=this;this.poly=null}getGeom(){let V=this.events[0].point;const H=[V];for(let Ft=1,te=this.events.length-1;Ft<te;Ft++){const Q=this.events[Ft].point,ve=this.events[Ft+1].point;Vr(Q,V,ve)!==0&&(H.push(Q),V=Q)}if(H.length===1)return null;const Ee=H[0],Le=H[1];Vr(Ee,V,Le)===0&&H.shift(),H.push(H[0]);const ze=this.isExteriorRing()?1:-1,xt=this.isExteriorRing()?0:H.length-1,Ut=this.isExteriorRing()?H.length:-1,ir=[];for(let Ft=xt;Ft!=Ut;Ft+=ze)ir.push([H[Ft].x,H[Ft].y]);return ir}isExteriorRing(){if(this._isExteriorRing===void 0){const V=this.enclosingRing();this._isExteriorRing=V?!V.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let V=this.events[0];for(let Le=1,ze=this.events.length;Le<ze;Le++){const xt=this.events[Le];kt.compare(V,xt)>0&&(V=xt)}let H=V.segment.prevInResult(),Ee=H?H.prevInResult():null;for(;;){if(!H)return null;if(!Ee)return H.ringOut;if(Ee.ringOut!==H.ringOut)return Ee.ringOut.enclosingRing()!==H.ringOut?H.ringOut:H.ringOut.enclosingRing();H=Ee.prevInResult(),Ee=H?H.prevInResult():null}}}class gr{constructor(V){this.exteriorRing=V,V.poly=this,this.interiorRings=[]}addInterior(V){this.interiorRings.push(V),V.poly=this}getGeom(){const V=[this.exteriorRing.getGeom()];if(V[0]===null)return null;for(let H=0,Ee=this.interiorRings.length;H<Ee;H++){const Le=this.interiorRings[H].getGeom();Le!==null&&V.push(Le)}return V}}class Wr{constructor(V){this.rings=V,this.polys=this._composePolys(V)}getGeom(){const V=[];for(let H=0,Ee=this.polys.length;H<Ee;H++){const Le=this.polys[H].getGeom();Le!==null&&V.push(Le)}return V}_composePolys(V){const H=[];for(let Ee=0,Le=V.length;Ee<Le;Ee++){const ze=V[Ee];if(!ze.poly)if(ze.isExteriorRing())H.push(new gr(ze));else{const xt=ze.enclosingRing();xt.poly||H.push(new gr(xt)),xt.poly.addInterior(ze)}}return H}}class Dr{constructor(V){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sr.compare;this.queue=V,this.tree=new Be(H),this.segments=[]}process(V){const H=V.segment,Ee=[];if(V.consumedBy)return V.isLeft?this.queue.remove(V.otherSE):this.tree.remove(H),Ee;const Le=V.isLeft?this.tree.add(H):this.tree.find(H);if(!Le)throw new Error(`Unable to find segment #${H.id} [${H.leftSE.point.x}, ${H.leftSE.point.y}] -> [${H.rightSE.point.x}, ${H.rightSE.point.y}] in SweepLine tree.`);let ze=Le,xt=Le,Ut,ir;for(;Ut===void 0;)ze=this.tree.prev(ze),ze===null?Ut=null:ze.key.consumedBy===void 0&&(Ut=ze.key);for(;ir===void 0;)xt=this.tree.next(xt),xt===null?ir=null:xt.key.consumedBy===void 0&&(ir=xt.key);if(V.isLeft){let Ft=null;if(Ut){const Q=Ut.getIntersection(H);if(Q!==null&&(H.isAnEndpoint(Q)||(Ft=Q),!Ut.isAnEndpoint(Q))){const ve=this._splitSafely(Ut,Q);for(let Oe=0,Xe=ve.length;Oe<Xe;Oe++)Ee.push(ve[Oe])}}let te=null;if(ir){const Q=ir.getIntersection(H);if(Q!==null&&(H.isAnEndpoint(Q)||(te=Q),!ir.isAnEndpoint(Q))){const ve=this._splitSafely(ir,Q);for(let Oe=0,Xe=ve.length;Oe<Xe;Oe++)Ee.push(ve[Oe])}}if(Ft!==null||te!==null){let Q=null;Ft===null?Q=te:te===null?Q=Ft:Q=kt.comparePoints(Ft,te)<=0?Ft:te,this.queue.remove(H.rightSE),Ee.push(H.rightSE);const ve=H.split(Q);for(let Oe=0,Xe=ve.length;Oe<Xe;Oe++)Ee.push(ve[Oe])}Ee.length>0?(this.tree.remove(H),Ee.push(V)):(this.segments.push(H),H.prev=Ut)}else{if(Ut&&ir){const Ft=Ut.getIntersection(ir);if(Ft!==null){if(!Ut.isAnEndpoint(Ft)){const te=this._splitSafely(Ut,Ft);for(let Q=0,ve=te.length;Q<ve;Q++)Ee.push(te[Q])}if(!ir.isAnEndpoint(Ft)){const te=this._splitSafely(ir,Ft);for(let Q=0,ve=te.length;Q<ve;Q++)Ee.push(te[Q])}}}this.tree.remove(H)}return Ee}_splitSafely(V,H){this.tree.remove(V);const Ee=V.rightSE;this.queue.remove(Ee);const Le=V.split(H);return Le.push(Ee),V.consumedBy===void 0&&this.tree.add(V),Le}}const Xr=typeof F!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Vn=typeof F!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class ni{run(V,H,Ee){Dn.type=V,se.reset();const Le=[new vr(H,!0)];for(let Q=0,ve=Ee.length;Q<ve;Q++)Le.push(new vr(Ee[Q],!1));if(Dn.numMultiPolys=Le.length,Dn.type==="difference"){const Q=Le[0];let ve=1;for(;ve<Le.length;)$e(Le[ve].bbox,Q.bbox)!==null?ve++:Le.splice(ve,1)}if(Dn.type==="intersection")for(let Q=0,ve=Le.length;Q<ve;Q++){const Oe=Le[Q];for(let Xe=Q+1,ft=Le.length;Xe<ft;Xe++)if($e(Oe.bbox,Le[Xe].bbox)===null)return[]}const ze=new Be(kt.compare);for(let Q=0,ve=Le.length;Q<ve;Q++){const Oe=Le[Q].getSweepEvents();for(let Xe=0,ft=Oe.length;Xe<ft;Xe++)if(ze.insert(Oe[Xe]),ze.size>Xr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const xt=new Dr(ze);let Ut=ze.size,ir=ze.pop();for(;ir;){const Q=ir.key;if(ze.size===Ut){const Oe=Q.segment;throw new Error(`Unable to pop() ${Q.isLeft?"left":"right"} SweepEvent [${Q.point.x}, ${Q.point.y}] from segment #${Oe.id} [${Oe.leftSE.point.x}, ${Oe.leftSE.point.y}] -> [${Oe.rightSE.point.x}, ${Oe.rightSE.point.y}] from queue.`)}if(ze.size>Xr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(xt.segments.length>Vn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const ve=xt.process(Q);for(let Oe=0,Xe=ve.length;Oe<Xe;Oe++){const ft=ve[Oe];ft.consumedBy===void 0&&ze.insert(ft)}Ut=ze.size,ir=ze.pop()}se.reset();const Ft=Ie.factory(xt.segments);return new Wr(Ft).getGeom()}}const Dn=new ni;var pi={union:function(it){for(var V=arguments.length,H=new Array(V>1?V-1:0),Ee=1;Ee<V;Ee++)H[Ee-1]=arguments[Ee];return Dn.run("union",it,H)},intersection:function(it){for(var V=arguments.length,H=new Array(V>1?V-1:0),Ee=1;Ee<V;Ee++)H[Ee-1]=arguments[Ee];return Dn.run("intersection",it,H)},xor:function(it){for(var V=arguments.length,H=new Array(V>1?V-1:0),Ee=1;Ee<V;Ee++)H[Ee-1]=arguments[Ee];return Dn.run("xor",it,H)},difference:function(it){for(var V=arguments.length,H=new Array(V>1?V-1:0),Ee=1;Ee<V;Ee++)H[Ee-1]=arguments[Ee];return Dn.run("difference",it,H)}};return pi})},62273:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var x={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},F=w.default=x},27590:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var x={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},F=w.default=x},45598:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=D;var z=F(x(67294)),h=x(11805);function D(P){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=[];return z.default.Children.forEach(P,function(fe){fe==null&&!X.keepEmpty||(Array.isArray(fe)?W=W.concat(D(fe)):(0,h.isFragment)(fe)&&fe.props?W=W.concat(D(fe.props.children,X)):W.push(fe))}),W}},3481:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.isStyleSupport=P;var z=F(x(19158)),h=function(W){if((0,z.default)()&&window.document.documentElement){var fe=Array.isArray(W)?W:[W],J=window.document.documentElement;return fe.some(function(Be){return Be in J.style})}return!1},D=function(W,fe){if(!h(W))return!1;var J=document.createElement("div"),Be=J.style[W];return J.style[W]=fe,J.style[W]!==Be};function P(X,W){return!Array.isArray(X)&&W!==void 0?D(X,W):h(X)}},27712:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var x={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(h){var D=h.keyCode;if(h.altKey&&!h.ctrlKey||h.metaKey||D>=x.F1&&D<=x.F12)return!1;switch(D){case x.ALT:case x.CAPS_LOCK:case x.CONTEXT_MENU:case x.CTRL:case x.DOWN:case x.END:case x.ESC:case x.HOME:case x.INSERT:case x.LEFT:case x.MAC_FF_META:case x.META:case x.NUMLOCK:case x.NUM_CENTER:case x.PAGE_DOWN:case x.PAGE_UP:case x.PAUSE:case x.PRINT_SCREEN:case x.RIGHT:case x.SHIFT:case x.UP:case x.WIN_KEY:case x.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(h){if(h>=x.ZERO&&h<=x.NINE||h>=x.NUM_ZERO&&h<=x.NUM_MULTIPLY||h>=x.A&&h<=x.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&h===0)return!0;switch(h){case x.SPACE:case x.QUESTION_MARK:case x.NUM_PLUS:case x.NUM_MINUS:case x.NUM_PERIOD:case x.NUM_DIVISION:case x.SEMICOLON:case x.DASH:case x.EQUALS:case x.COMMA:case x.PERIOD:case x.SLASH:case x.APOSTROPHE:case x.SINGLE_QUOTE:case x.OPEN_SQUARE_BRACKET:case x.BACKSLASH:case x.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},F=w.default=x},18545:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=h;var z=F(x(67294));function h(D){var P=z.useRef();P.current=D;var X=z.useCallback(function(){for(var W,fe=arguments.length,J=new Array(fe),Be=0;Be<fe;Be++)J[Be]=arguments[Be];return(W=P.current)===null||W===void 0?void 0:W.call.apply(W,[P].concat(J))},[]);return X}},82546:function(He,w,x){"use strict";var F=x(64836).default,z=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.useLayoutUpdateEffect=w.default=void 0;var h=z(x(67294)),D=F(x(19158)),P=(0,D.default)()?h.useLayoutEffect:h.useEffect,X=function(Be,B){var ee=h.useRef(!0);P(function(){return Be(ee.current)},B),P(function(){return ee.current=!1,function(){ee.current=!0}},[])},W=w.useLayoutUpdateEffect=function(Be,B){X(function(ee){if(!ee)return Be()},B)},fe=w.default=X},67265:function(He,w,x){"use strict";var F=x(75263).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=h;var z=F(x(67294));function h(D,P,X){var W=z.useRef({});return(!("value"in W.current)||X(W.current.condition,P))&&(W.current.value=D(),W.current.condition=P),W.current.value}},60869:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=W;var z=F(x(27424)),h=F(x(18545)),D=x(82546),P=F(x(78423));function X(fe){return fe!==void 0}function W(fe,J){var Be=J||{},B=Be.defaultValue,ee=Be.value,U=Be.onChange,q=Be.postState,le=(0,P.default)(function(){return X(ee)?ee:X(B)?typeof B=="function"?B():B:typeof fe=="function"?fe():fe}),j=(0,z.default)(le,2),Ce=j[0],$e=j[1],Fe=ee!==void 0?ee:Ce,lt=q?q(Fe):Fe,We=(0,h.default)(U),Ze=(0,P.default)([Fe]),pe=(0,z.default)(Ze,2),se=pe[0],be=pe[1];(0,D.useLayoutUpdateEffect)(function(){var de=se[0];Ce!==de&&We(Ce,de)},[se]),(0,D.useLayoutUpdateEffect)(function(){X(ee)||$e(ee)},[ee]);var Te=(0,h.default)(function(de,Rt){$e(de,Rt),be([Fe],Rt)});return[lt,Te]}},78423:function(He,w,x){"use strict";var F=x(75263).default,z=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=P;var h=z(x(27424)),D=F(x(67294));function P(X){var W=D.useRef(!1),fe=D.useState(X),J=(0,h.default)(fe,2),Be=J[0],B=J[1];D.useEffect(function(){return W.current=!1,function(){W.current=!0}},[]);function ee(U,q){q&&W.current||B(U)}return[Be,ee]}},11102:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var z=F(x(18698)),h=F(x(45520));function D(X,W){var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,J=new Set;function Be(B,ee){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,q=J.has(B);if((0,h.default)(!q,"Warning: There may be circular references"),q)return!1;if(B===ee)return!0;if(fe&&U>1)return!1;J.add(B);var le=U+1;if(Array.isArray(B)){if(!Array.isArray(ee)||B.length!==ee.length)return!1;for(var j=0;j<B.length;j++)if(!Be(B[j],ee[j],le))return!1;return!0}if(B&&ee&&(0,z.default)(B)==="object"&&(0,z.default)(ee)==="object"){var Ce=Object.keys(B);return Ce.length!==Object.keys(ee).length?!1:Ce.every(function($e){return Be(B[$e],ee[$e],le)})}return!1}return Be(X,W)}var P=w.default=D},18475:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=h;var z=F(x(42122));function h(D,P){var X=(0,z.default)({},D);return Array.isArray(P)&&P.forEach(function(W){delete X[W]}),X}},75531:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.composeRef=W,w.fillRef=X,w.supportNodeRef=Be,w.supportRef=J,w.useComposeRef=fe;var z=F(x(18698)),h=x(67294),D=x(11805),P=F(x(67265));function X(B,ee){typeof B=="function"?B(ee):(0,z.default)(B)==="object"&&B&&"current"in B&&(B.current=ee)}function W(){for(var B=arguments.length,ee=new Array(B),U=0;U<B;U++)ee[U]=arguments[U];var q=ee.filter(function(le){return le});return q.length<=1?q[0]:function(le){ee.forEach(function(j){X(j,le)})}}function fe(){for(var B=arguments.length,ee=new Array(B),U=0;U<B;U++)ee[U]=arguments[U];return(0,P.default)(function(){return W.apply(void 0,ee)},ee,function(q,le){return q.length!==le.length||q.every(function(j,Ce){return j!==le[Ce]})})}function J(B){var ee,U,q=(0,D.isMemo)(B)?B.type.type:B.type;return!(typeof q=="function"&&!((ee=q.prototype)!==null&&ee!==void 0&&ee.render)&&q.$$typeof!==D.ForwardRef||typeof B=="function"&&!((U=B.prototype)!==null&&U!==void 0&&U.render)&&B.$$typeof!==D.ForwardRef)}function Be(B){return!(0,h.isValidElement)(B)||(0,D.isFragment)(B)?!1:J(B)}},94787:function(He,w){"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.default=x;function x(F,z){for(var h=F,D=0;D<z.length;D+=1){if(h==null)return;h=h[z[D]]}return h}},20059:function(He,w,x){"use strict";var F=x(64836).default;Object.defineProperty(w,"__esModule",{value:!0}),w.default=fe,w.merge=ee;var z=F(x(18698)),h=F(x(42122)),D=F(x(861)),P=F(x(51589)),X=F(x(94787));function W(U,q,le,j){if(!q.length)return le;var Ce=(0,P.default)(q),$e=Ce[0],Fe=Ce.slice(1),lt;return!U&&typeof $e=="number"?lt=[]:Array.isArray(U)?lt=(0,D.default)(U):lt=(0,h.default)({},U),j&&le===void 0&&Fe.length===1?delete lt[$e][Fe[0]]:lt[$e]=W(lt[$e],Fe,le,j),lt}function fe(U,q,le){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return q.length&&j&&le===void 0&&!(0,X.default)(U,q.slice(0,-1))?U:W(U,q,le,j)}function J(U){return(0,z.default)(U)==="object"&&U!==null&&Object.getPrototypeOf(U)===Object.prototype}function Be(U){return Array.isArray(U)?[]:{}}var B=typeof Reflect=="undefined"?Object.keys:Reflect.ownKeys;function ee(){for(var U=arguments.length,q=new Array(U),le=0;le<U;le++)q[le]=arguments[le];var j=Be(q[0]);return q.forEach(function(Ce){function $e(Fe,lt){var We=new Set(lt),Ze=(0,X.default)(Ce,Fe),pe=Array.isArray(Ze);if(pe||J(Ze)){if(!We.has(Ze)){We.add(Ze);var se=(0,X.default)(j,Fe);pe?j=fe(j,Fe,[]):(!se||(0,z.default)(se)!=="object")&&(j=fe(j,Fe,Be(Ze))),B(Ze).forEach(function(be){$e([].concat((0,D.default)(Fe),[be]),We)})}}else j=fe(j,Fe,Ze)}$e([])}),j}},81550:function(He){(function(w,x){He.exports=x()})(this,function(){"use strict";var w=function(me){return me instanceof Uint8Array||me instanceof Uint16Array||me instanceof Uint32Array||me instanceof Int8Array||me instanceof Int16Array||me instanceof Int32Array||me instanceof Float32Array||me instanceof Float64Array||me instanceof Uint8ClampedArray},x=function(me,ht){for(var Lt=Object.keys(ht),wr=0;wr<Lt.length;++wr)me[Lt[wr]]=ht[Lt[wr]];return me},F=`
`;function z(me){return typeof atob!="undefined"?atob(me):"base64:"+me}function h(me){var ht=new Error("(regl) "+me);throw console.error(ht),ht}function D(me,ht){me||h(ht)}function P(me){return me?": "+me:""}function X(me,ht,Lt){me in ht||h("unknown parameter ("+me+")"+P(Lt)+". possible values: "+Object.keys(ht).join())}function W(me,ht){w(me)||h("invalid parameter type"+P(ht)+". must be a typed array")}function fe(me,ht){switch(ht){case"number":return typeof me=="number";case"object":return typeof me=="object";case"string":return typeof me=="string";case"boolean":return typeof me=="boolean";case"function":return typeof me=="function";case"undefined":return typeof me=="undefined";case"symbol":return typeof me=="symbol"}}function J(me,ht,Lt){fe(me,ht)||h("invalid parameter type"+P(Lt)+". expected "+ht+", got "+typeof me)}function Be(me,ht){me>=0&&(me|0)===me||h("invalid parameter type, ("+me+")"+P(ht)+". must be a nonnegative integer")}function B(me,ht,Lt){ht.indexOf(me)<0&&h("invalid value"+P(Lt)+". must be one of: "+ht)}var ee=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function U(me){Object.keys(me).forEach(function(ht){ee.indexOf(ht)<0&&h('invalid regl constructor argument "'+ht+'". must be one of '+ee)})}function q(me,ht){for(me=me+"";me.length<ht;)me=" "+me;return me}function le(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function j(me,ht){this.number=me,this.line=ht,this.errors=[]}function Ce(me,ht,Lt){this.file=me,this.line=ht,this.message=Lt}function $e(){var me=new Error,ht=(me.stack||me).toString(),Lt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ht);if(Lt)return Lt[1];var wr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ht);return wr?wr[1]:"unknown"}function Fe(){var me=new Error,ht=(me.stack||me).toString(),Lt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ht);if(Lt)return Lt[1];var wr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ht);return wr?wr[1]:"unknown"}function lt(me,ht){var Lt=me.split(`
`),wr=1,qr=0,Cr={unknown:new le,0:new le};Cr.unknown.name=Cr[0].name=ht||$e(),Cr.unknown.lines.push(new j(0,""));for(var fr=0;fr<Lt.length;++fr){var Mn=Lt[fr],gn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Mn);if(gn)switch(gn[1]){case"line":var yn=/(\d+)(\s+\d+)?/.exec(gn[2]);yn&&(wr=yn[1]|0,yn[2]&&(qr=yn[2]|0,qr in Cr||(Cr[qr]=new le)));break;case"define":var Pn=/SHADER_NAME(_B64)?\s+(.*)$/.exec(gn[2]);Pn&&(Cr[qr].name=Pn[1]?z(Pn[2]):Pn[2]);break}Cr[qr].lines.push(new j(wr++,Mn))}return Object.keys(Cr).forEach(function(Un){var un=Cr[Un];un.lines.forEach(function(Sn){un.index[Sn.number]=Sn})}),Cr}function We(me){var ht=[];return me.split(`
`).forEach(function(Lt){if(!(Lt.length<5)){var wr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Lt);wr?ht.push(new Ce(wr[1]|0,wr[2]|0,wr[3].trim())):Lt.length>0&&ht.push(new Ce("unknown",0,Lt))}}),ht}function Ze(me,ht){ht.forEach(function(Lt){var wr=me[Lt.file];if(wr){var qr=wr.index[Lt.line];if(qr){qr.errors.push(Lt),wr.hasErrors=!0;return}}me.unknown.hasErrors=!0,me.unknown.lines[0].errors.push(Lt)})}function pe(me,ht,Lt,wr,qr){if(!me.getShaderParameter(ht,me.COMPILE_STATUS)){var Cr=me.getShaderInfoLog(ht),fr=wr===me.FRAGMENT_SHADER?"fragment":"vertex";Ve(Lt,"string",fr+" shader source must be a string",qr);var Mn=lt(Lt,qr),gn=We(Cr);Ze(Mn,gn),Object.keys(Mn).forEach(function(yn){var Pn=Mn[yn];if(!Pn.hasErrors)return;var Un=[""],un=[""];function Sn(Ln,sr){Un.push(Ln),un.push(sr||"")}Sn("file number "+yn+": "+Pn.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Pn.lines.forEach(function(Ln){if(Ln.errors.length>0){Sn(q(Ln.number,4)+"|  ","background-color:yellow; font-weight:bold"),Sn(Ln.line+F,"color:red; background-color:yellow; font-weight:bold");var sr=0;Ln.errors.forEach(function(Fr){var On=Fr.message,qn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(On);if(qn){var hn=qn[1];switch(On=qn[2],hn){case"assign":hn="=";break}sr=Math.max(Ln.line.indexOf(hn,sr),0)}else sr=0;Sn(q("| ",6)),Sn(q("^^^",sr+3)+F,"font-weight:bold"),Sn(q("| ",6)),Sn(On+F,"font-weight:bold")}),Sn(q("| ",6)+F)}else Sn(q(Ln.number,4)+"|  "),Sn(Ln.line+F,"color:red")}),typeof document!="undefined"&&!window.chrome?(un[0]=Un.join("%c"),console.log.apply(console,un)):console.log(Un.join(""))}),D.raise("Error compiling "+fr+" shader, "+Mn[0].name)}}function se(me,ht,Lt,wr,qr){if(!me.getProgramParameter(ht,me.LINK_STATUS)){var Cr=me.getProgramInfoLog(ht),fr=lt(Lt,qr),Mn=lt(wr,qr),gn='Error linking program with vertex shader, "'+Mn[0].name+'", and fragment shader "'+fr[0].name+'"';typeof document!="undefined"?console.log("%c"+gn+F+"%c"+Cr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(gn+F+Cr),D.raise(gn)}}function be(me){me._commandRef=$e()}function Te(me,ht,Lt,wr){be(me);function qr(gn){return gn?wr.id(gn):0}me._fragId=qr(me.static.frag),me._vertId=qr(me.static.vert);function Cr(gn,yn){Object.keys(yn).forEach(function(Pn){gn[wr.id(Pn)]=!0})}var fr=me._uniformSet={};Cr(fr,ht.static),Cr(fr,ht.dynamic);var Mn=me._attributeSet={};Cr(Mn,Lt.static),Cr(Mn,Lt.dynamic),me._hasCount="count"in me.static||"count"in me.dynamic||"elements"in me.static||"elements"in me.dynamic}function de(me,ht){var Lt=Fe();h(me+" in command "+(ht||$e())+(Lt==="unknown"?"":" called from "+Lt))}function Rt(me,ht,Lt){me||de(ht,Lt||$e())}function ye(me,ht,Lt,wr){me in ht||de("unknown parameter ("+me+")"+P(Lt)+". possible values: "+Object.keys(ht).join(),wr||$e())}function Ve(me,ht,Lt,wr){fe(me,ht)||de("invalid parameter type"+P(Lt)+". expected "+ht+", got "+typeof me,wr||$e())}function oe(me){me()}function Re(me,ht,Lt){me.texture?B(me.texture._texture.internalformat,ht,"unsupported texture format for attachment"):B(me.renderbuffer._renderbuffer.format,Lt,"unsupported renderbuffer format for attachment")}var Se=33071,et=9728,st=9984,pt=9985,bt=9986,ke=9987,ur=5120,qt=5121,_n=5122,Zr=5123,Vr=5124,rn=5125,Qr=5126,ln=32819,vn=32820,$t=33635,_r=34042,kt=36193,qe={};qe[ur]=qe[qt]=1,qe[_n]=qe[Zr]=qe[kt]=qe[$t]=qe[ln]=qe[vn]=2,qe[Vr]=qe[rn]=qe[Qr]=qe[_r]=4;function Sr(me,ht){return me===vn||me===ln||me===$t?2:me===_r?4:qe[me]*ht}function Pe(me){return!(me&me-1)&&!!me}function Hr(me,ht,Lt){var wr,qr=ht.width,Cr=ht.height,fr=ht.channels;D(qr>0&&qr<=Lt.maxTextureSize&&Cr>0&&Cr<=Lt.maxTextureSize,"invalid texture shape"),(me.wrapS!==Se||me.wrapT!==Se)&&D(Pe(qr)&&Pe(Cr),"incompatible wrap mode for texture, both width and height must be power of 2"),ht.mipmask===1?qr!==1&&Cr!==1&&D(me.minFilter!==st&&me.minFilter!==bt&&me.minFilter!==pt&&me.minFilter!==ke,"min filter requires mipmap"):(D(Pe(qr)&&Pe(Cr),"texture must be a square power of 2 to support mipmapping"),D(ht.mipmask===(qr<<1)-1,"missing or incomplete mipmap data")),ht.type===Qr&&(Lt.extensions.indexOf("oes_texture_float_linear")<0&&D(me.minFilter===et&&me.magFilter===et,"filter not supported, must enable oes_texture_float_linear"),D(!me.genMipmaps,"mipmap generation not supported with float textures"));var Mn=ht.images;for(wr=0;wr<16;++wr)if(Mn[wr]){var gn=qr>>wr,yn=Cr>>wr;D(ht.mipmask&1<<wr,"missing mipmap data");var Pn=Mn[wr];if(D(Pn.width===gn&&Pn.height===yn,"invalid shape for mip images"),D(Pn.format===ht.format&&Pn.internalformat===ht.internalformat&&Pn.type===ht.type,"incompatible type for mip image"),!Pn.compressed)if(Pn.data){var Un=Math.ceil(Sr(Pn.type,fr)*gn/Pn.unpackAlignment)*Pn.unpackAlignment;D(Pn.data.byteLength===Un*yn,"invalid data for image, buffer size is inconsistent with image format")}else Pn.element||Pn.copy}else me.genMipmaps||D((ht.mipmask&1<<wr)===0,"extra mipmap data");ht.compressed&&D(!me.genMipmaps,"mipmap generation for compressed images not supported")}function vr(me,ht,Lt,wr){var qr=me.width,Cr=me.height,fr=me.channels;D(qr>0&&qr<=wr.maxTextureSize&&Cr>0&&Cr<=wr.maxTextureSize,"invalid texture shape"),D(qr===Cr,"cube map must be square"),D(ht.wrapS===Se&&ht.wrapT===Se,"wrap mode not supported by cube map");for(var Mn=0;Mn<Lt.length;++Mn){var gn=Lt[Mn];D(gn.width===qr&&gn.height===Cr,"inconsistent cube map face shape"),ht.genMipmaps&&(D(!gn.compressed,"can not generate mipmap for compressed textures"),D(gn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var yn=gn.images,Pn=0;Pn<16;++Pn){var Un=yn[Pn];if(Un){var un=qr>>Pn,Sn=Cr>>Pn;D(gn.mipmask&1<<Pn,"missing mipmap data"),D(Un.width===un&&Un.height===Sn,"invalid shape for mip images"),D(Un.format===me.format&&Un.internalformat===me.internalformat&&Un.type===me.type,"incompatible type for mip image"),Un.compressed||(Un.data?D(Un.data.byteLength===un*Sn*Math.max(Sr(Un.type,fr),Un.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Un.element||Un.copy)}}}}var Ie=x(D,{optional:oe,raise:h,commandRaise:de,command:Rt,parameter:X,commandParameter:ye,constructor:U,type:J,commandType:Ve,isTypedArray:W,nni:Be,oneOf:B,shaderError:pe,linkError:se,callSite:Fe,saveCommandRef:be,saveDrawInfo:Te,framebufferFormat:Re,guessCommand:$e,texture2D:Hr,textureCube:vr}),gr=0,Wr=0;function Dr(me,ht){this.id=gr++,this.type=me,this.data=ht}function Xr(me){return me.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Vn(me){if(me.length===0)return[];var ht=me.charAt(0),Lt=me.charAt(me.length-1);if(me.length>1&&ht===Lt&&(ht==='"'||ht==="'"))return['"'+Xr(me.substr(1,me.length-2))+'"'];var wr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(me);if(wr)return Vn(me.substr(0,wr.index)).concat(Vn(wr[1])).concat(Vn(me.substr(wr.index+wr[0].length)));var qr=me.split(".");if(qr.length===1)return['"'+Xr(me)+'"'];for(var Cr=[],fr=0;fr<qr.length;++fr)Cr=Cr.concat(Vn(qr[fr]));return Cr}function ni(me){return"["+Vn(me).join("][")+"]"}function Dn(me,ht){return new Dr(me,ni(ht+""))}function Jn(me){return typeof me=="function"&&!me._reglType||me instanceof Dr}function Yi(me,ht){return typeof me=="function"?new Dr(Wr,me):me}var bi={DynamicVariable:Dr,define:Dn,isDynamic:Jn,unbox:Yi,accessor:ni},ui={next:typeof requestAnimationFrame=="function"?function(me){return requestAnimationFrame(me)}:function(me){return setTimeout(me,16)},cancel:typeof cancelAnimationFrame=="function"?function(me){return cancelAnimationFrame(me)}:clearTimeout},pi=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function it(){var me={"":0},ht=[""];return{id:function(Lt){var wr=me[Lt];return wr||(wr=me[Lt]=ht.length,ht.push(Lt),wr)},str:function(Lt){return ht[Lt]}}}function V(me,ht,Lt){var wr=document.createElement("canvas");x(wr.style,{border:0,margin:0,padding:0,top:0,left:0}),me.appendChild(wr),me===document.body&&(wr.style.position="absolute",x(me.style,{margin:0,padding:0}));function qr(){var Mn=window.innerWidth,gn=window.innerHeight;if(me!==document.body){var yn=me.getBoundingClientRect();Mn=yn.right-yn.left,gn=yn.bottom-yn.top}wr.width=Lt*Mn,wr.height=Lt*gn,x(wr.style,{width:Mn+"px",height:gn+"px"})}var Cr;me!==document.body&&typeof ResizeObserver=="function"?(Cr=new ResizeObserver(function(){setTimeout(qr)}),Cr.observe(me)):window.addEventListener("resize",qr,!1);function fr(){Cr?Cr.disconnect():window.removeEventListener("resize",qr),me.removeChild(wr)}return qr(),{canvas:wr,onDestroy:fr}}function H(me,ht){function Lt(wr){try{return me.getContext(wr,ht)}catch(qr){return null}}return Lt("webgl")||Lt("experimental-webgl")||Lt("webgl-experimental")}function Ee(me){return typeof me.nodeName=="string"&&typeof me.appendChild=="function"&&typeof me.getBoundingClientRect=="function"}function Le(me){return typeof me.drawArrays=="function"||typeof me.drawElements=="function"}function ze(me){return typeof me=="string"?me.split():(Ie(Array.isArray(me),"invalid extension array"),me)}function xt(me){return typeof me=="string"?(Ie(typeof document!="undefined","not supported outside of DOM"),document.querySelector(me)):me}function Ut(me){var ht=me||{},Lt,wr,qr,Cr,fr={},Mn=[],gn=[],yn=typeof window=="undefined"?1:window.devicePixelRatio,Pn=!1,Un=function(Ln){Ln&&Ie.raise(Ln)},un=function(){};if(typeof ht=="string"?(Ie(typeof document!="undefined","selector queries only supported in DOM enviroments"),Lt=document.querySelector(ht),Ie(Lt,"invalid query string for element")):typeof ht=="object"?Ee(ht)?Lt=ht:Le(ht)?(Cr=ht,qr=Cr.canvas):(Ie.constructor(ht),"gl"in ht?Cr=ht.gl:"canvas"in ht?qr=xt(ht.canvas):"container"in ht&&(wr=xt(ht.container)),"attributes"in ht&&(fr=ht.attributes,Ie.type(fr,"object","invalid context attributes")),"extensions"in ht&&(Mn=ze(ht.extensions)),"optionalExtensions"in ht&&(gn=ze(ht.optionalExtensions)),"onDone"in ht&&(Ie.type(ht.onDone,"function","invalid or missing onDone callback"),Un=ht.onDone),"profile"in ht&&(Pn=!!ht.profile),"pixelRatio"in ht&&(yn=+ht.pixelRatio,Ie(yn>0,"invalid pixel ratio"))):Ie.raise("invalid arguments to regl"),Lt&&(Lt.nodeName.toLowerCase()==="canvas"?qr=Lt:wr=Lt),!Cr){if(!qr){Ie(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Sn=V(wr||document.body,Un,yn);if(!Sn)return null;qr=Sn.canvas,un=Sn.onDestroy}fr.premultipliedAlpha===void 0&&(fr.premultipliedAlpha=!0),Cr=H(qr,fr)}return Cr?{gl:Cr,canvas:qr,container:wr,extensions:Mn,optionalExtensions:gn,pixelRatio:yn,profile:Pn,onDone:Un,onDestroy:un}:(un(),Un("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ir(me,ht){var Lt={};function wr(fr){Ie.type(fr,"string","extension name must be string");var Mn=fr.toLowerCase(),gn;try{gn=Lt[Mn]=me.getExtension(Mn)}catch(yn){}return!!gn}for(var qr=0;qr<ht.extensions.length;++qr){var Cr=ht.extensions[qr];if(!wr(Cr))return ht.onDestroy(),ht.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ht.optionalExtensions.forEach(wr),{extensions:Lt,restore:function(){Object.keys(Lt).forEach(function(fr){if(Lt[fr]&&!wr(fr))throw new Error("(regl): error restoring extension "+fr)})}}}function Ft(me,ht){for(var Lt=Array(me),wr=0;wr<me;++wr)Lt[wr]=ht(wr);return Lt}var te=5120,Q=5121,ve=5122,Oe=5123,Xe=5124,ft=5125,Et=5126;function Ne(me){for(var ht=16;ht<=1<<28;ht*=16)if(me<=ht)return ht;return 0}function Ue(me){var ht,Lt;return ht=(me>65535)<<4,me>>>=ht,Lt=(me>255)<<3,me>>>=Lt,ht|=Lt,Lt=(me>15)<<2,me>>>=Lt,ht|=Lt,Lt=(me>3)<<1,me>>>=Lt,ht|=Lt,ht|me>>1}function vt(){var me=Ft(8,function(){return[]});function ht(Cr){var fr=Ne(Cr),Mn=me[Ue(fr)>>2];return Mn.length>0?Mn.pop():new ArrayBuffer(fr)}function Lt(Cr){me[Ue(Cr.byteLength)>>2].push(Cr)}function wr(Cr,fr){var Mn=null;switch(Cr){case te:Mn=new Int8Array(ht(fr),0,fr);break;case Q:Mn=new Uint8Array(ht(fr),0,fr);break;case ve:Mn=new Int16Array(ht(2*fr),0,fr);break;case Oe:Mn=new Uint16Array(ht(2*fr),0,fr);break;case Xe:Mn=new Int32Array(ht(4*fr),0,fr);break;case ft:Mn=new Uint32Array(ht(4*fr),0,fr);break;case Et:Mn=new Float32Array(ht(4*fr),0,fr);break;default:return null}return Mn.length!==fr?Mn.subarray(0,fr):Mn}function qr(Cr){Lt(Cr.buffer)}return{alloc:ht,free:Lt,allocType:wr,freeType:qr}}var ue=vt();ue.zero=vt();var Lr=3408,lr=3410,$r=3411,Rn=3412,nn=3413,xr=3414,Or=3415,sn=33901,xn=33902,wi=3379,Nn=3386,Bi=34921,sa=36347,Fi=36348,bn=35661,ei=35660,ga=34930,ua=36349,no=34076,ia=34024,zi=7936,Nr=7937,ji=7938,Hs=35724,Da=34047,Za=36063,Qs=34852,cs=3553,Ka=34067,Do=34069,qa=33984,Qa=6408,Pa=5126,Na=5121,Lo=36160,ba=36053,so=36064,Ao=16384,Y=function(me,ht){var Lt=1;ht.ext_texture_filter_anisotropic&&(Lt=me.getParameter(Da));var wr=1,qr=1;ht.webgl_draw_buffers&&(wr=me.getParameter(Qs),qr=me.getParameter(Za));var Cr=!!ht.oes_texture_float;if(Cr){var fr=me.createTexture();me.bindTexture(cs,fr),me.texImage2D(cs,0,Qa,1,1,0,Qa,Pa,null);var Mn=me.createFramebuffer();if(me.bindFramebuffer(Lo,Mn),me.framebufferTexture2D(Lo,so,cs,fr,0),me.bindTexture(cs,null),me.checkFramebufferStatus(Lo)!==ba)Cr=!1;else{me.viewport(0,0,1,1),me.clearColor(1,0,0,1),me.clear(Ao);var gn=ue.allocType(Pa,4);me.readPixels(0,0,1,1,Qa,Pa,gn),me.getError()?Cr=!1:(me.deleteFramebuffer(Mn),me.deleteTexture(fr),Cr=gn[0]===1),ue.freeType(gn)}}var yn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Pn=!0;if(!yn){var Un=me.createTexture(),un=ue.allocType(Na,36);me.activeTexture(qa),me.bindTexture(Ka,Un),me.texImage2D(Do,0,Qa,3,3,0,Qa,Na,un),ue.freeType(un),me.bindTexture(Ka,null),me.deleteTexture(Un),Pn=!me.getError()}return{colorBits:[me.getParameter(lr),me.getParameter($r),me.getParameter(Rn),me.getParameter(nn)],depthBits:me.getParameter(xr),stencilBits:me.getParameter(Or),subpixelBits:me.getParameter(Lr),extensions:Object.keys(ht).filter(function(Sn){return!!ht[Sn]}),maxAnisotropic:Lt,maxDrawbuffers:wr,maxColorAttachments:qr,pointSizeDims:me.getParameter(sn),lineWidthDims:me.getParameter(xn),maxViewportDims:me.getParameter(Nn),maxCombinedTextureUnits:me.getParameter(bn),maxCubeMapSize:me.getParameter(no),maxRenderbufferSize:me.getParameter(ia),maxTextureUnits:me.getParameter(ga),maxTextureSize:me.getParameter(wi),maxAttributes:me.getParameter(Bi),maxVertexUniforms:me.getParameter(sa),maxVertexTextureUnits:me.getParameter(ei),maxVaryingVectors:me.getParameter(Fi),maxFragmentUniforms:me.getParameter(ua),glsl:me.getParameter(Hs),renderer:me.getParameter(Nr),vendor:me.getParameter(zi),version:me.getParameter(ji),readFloat:Cr,npotTextureCube:Pn}};function vo(me){return!!me&&typeof me=="object"&&Array.isArray(me.shape)&&Array.isArray(me.stride)&&typeof me.offset=="number"&&me.shape.length===me.stride.length&&(Array.isArray(me.data)||w(me.data))}var Va=function(me){return Object.keys(me).map(function(ht){return me[ht]})},fs={shape:Tn,flatten:Pr};function Eo(me,ht,Lt){for(var wr=0;wr<ht;++wr)Lt[wr]=me[wr]}function Qe(me,ht,Lt,wr){for(var qr=0,Cr=0;Cr<ht;++Cr)for(var fr=me[Cr],Mn=0;Mn<Lt;++Mn)wr[qr++]=fr[Mn]}function gt(me,ht,Lt,wr,qr,Cr){for(var fr=Cr,Mn=0;Mn<ht;++Mn)for(var gn=me[Mn],yn=0;yn<Lt;++yn)for(var Pn=gn[yn],Un=0;Un<wr;++Un)qr[fr++]=Pn[Un]}function Gt(me,ht,Lt,wr,qr){for(var Cr=1,fr=Lt+1;fr<ht.length;++fr)Cr*=ht[fr];var Mn=ht[Lt];if(ht.length-Lt===4){var gn=ht[Lt+1],yn=ht[Lt+2],Pn=ht[Lt+3];for(fr=0;fr<Mn;++fr)gt(me[fr],gn,yn,Pn,wr,qr),qr+=Cr}else for(fr=0;fr<Mn;++fr)Gt(me[fr],ht,Lt+1,wr,qr),qr+=Cr}function Pr(me,ht,Lt,wr){var qr=1;if(ht.length)for(var Cr=0;Cr<ht.length;++Cr)qr*=ht[Cr];else qr=0;var fr=wr||ue.allocType(Lt,qr);switch(ht.length){case 0:break;case 1:Eo(me,ht[0],fr);break;case 2:Qe(me,ht[0],ht[1],fr);break;case 3:gt(me,ht[0],ht[1],ht[2],fr,0);break;default:Gt(me,ht,0,fr,0)}return fr}function Tn(me){for(var ht=[],Lt=me;Lt.length;Lt=Lt[0])ht.push(Lt.length);return ht}var di={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},fa=5120,Bo=5122,Ko=5124,Po=5121,Us=5123,ws=5125,Yc=5126,Ml=5126,ns={int8:fa,int16:Bo,int32:Ko,uint8:Po,uint16:Us,uint32:ws,float:Yc,float32:Ml},Uu=35048,il=35040,is={dynamic:Uu,stream:il,static:35044},Cu=fs.flatten,al=fs.shape,Kl=35044,cn=35040,Ei=5121,Hi=5126,In=[];In[5120]=1,In[5122]=2,In[5124]=4,In[5121]=1,In[5123]=2,In[5125]=4,In[5126]=4;function Co(me){return di[Object.prototype.toString.call(me)]|0}function ol(me,ht){for(var Lt=0;Lt<ht.length;++Lt)me[Lt]=ht[Lt]}function ql(me,ht,Lt,wr,qr,Cr,fr){for(var Mn=0,gn=0;gn<Lt;++gn)for(var yn=0;yn<wr;++yn)me[Mn++]=ht[qr*gn+Cr*yn+fr]}function Ic(me,ht,Lt,wr){var qr=0,Cr={};function fr(sr){this.id=qr++,this.buffer=me.createBuffer(),this.type=sr,this.usage=Kl,this.byteLength=0,this.dimension=1,this.dtype=Ei,this.persistentData=null,Lt.profile&&(this.stats={size:0})}fr.prototype.bind=function(){me.bindBuffer(this.type,this.buffer)},fr.prototype.destroy=function(){un(this)};var Mn=[];function gn(sr,Fr){var On=Mn.pop();return On||(On=new fr(sr)),On.bind(),Un(On,Fr,cn,0,1,!1),On}function yn(sr){Mn.push(sr)}function Pn(sr,Fr,On){sr.byteLength=Fr.byteLength,me.bufferData(sr.type,Fr,On)}function Un(sr,Fr,On,qn,hn,ti){var An;if(sr.usage=On,Array.isArray(Fr)){if(sr.dtype=qn||Hi,Fr.length>0){var Qn;if(Array.isArray(Fr[0])){An=al(Fr);for(var dn=1,Xn=1;Xn<An.length;++Xn)dn*=An[Xn];sr.dimension=dn,Qn=Cu(Fr,An,sr.dtype),Pn(sr,Qn,On),ti?sr.persistentData=Qn:ue.freeType(Qn)}else if(typeof Fr[0]=="number"){sr.dimension=hn;var ki=ue.allocType(sr.dtype,Fr.length);ol(ki,Fr),Pn(sr,ki,On),ti?sr.persistentData=ki:ue.freeType(ki)}else w(Fr[0])?(sr.dimension=Fr[0].length,sr.dtype=qn||Co(Fr[0])||Hi,Qn=Cu(Fr,[Fr.length,Fr[0].length],sr.dtype),Pn(sr,Qn,On),ti?sr.persistentData=Qn:ue.freeType(Qn)):Ie.raise("invalid buffer data")}}else if(w(Fr))sr.dtype=qn||Co(Fr),sr.dimension=hn,Pn(sr,Fr,On),ti&&(sr.persistentData=new Uint8Array(new Uint8Array(Fr.buffer)));else if(vo(Fr)){An=Fr.shape;var ea=Fr.stride,Yn=Fr.offset,Cn=0,Jr=0,Di=0,va=0;An.length===1?(Cn=An[0],Jr=1,Di=ea[0],va=0):An.length===2?(Cn=An[0],Jr=An[1],Di=ea[0],va=ea[1]):Ie.raise("invalid shape"),sr.dtype=qn||Co(Fr.data)||Hi,sr.dimension=Jr;var ri=ue.allocType(sr.dtype,Cn*Jr);ql(ri,Fr.data,Cn,Jr,Di,va,Yn),Pn(sr,ri,On),ti?sr.persistentData=ri:ue.freeType(ri)}else Fr instanceof ArrayBuffer?(sr.dtype=Ei,sr.dimension=hn,Pn(sr,Fr,On),ti&&(sr.persistentData=new Uint8Array(new Uint8Array(Fr)))):Ie.raise("invalid buffer data")}function un(sr){ht.bufferCount--,wr(sr);var Fr=sr.buffer;Ie(Fr,"buffer must not be deleted already"),me.deleteBuffer(Fr),sr.buffer=null,delete Cr[sr.id]}function Sn(sr,Fr,On,qn){ht.bufferCount++;var hn=new fr(Fr);Cr[hn.id]=hn;function ti(dn){var Xn=Kl,ki=null,ea=0,Yn=0,Cn=1;return Array.isArray(dn)||w(dn)||vo(dn)||dn instanceof ArrayBuffer?ki=dn:typeof dn=="number"?ea=dn|0:dn&&(Ie.type(dn,"object","buffer arguments must be an object, a number or an array"),"data"in dn&&(Ie(ki===null||Array.isArray(ki)||w(ki)||vo(ki),"invalid data for buffer"),ki=dn.data),"usage"in dn&&(Ie.parameter(dn.usage,is,"invalid buffer usage"),Xn=is[dn.usage]),"type"in dn&&(Ie.parameter(dn.type,ns,"invalid buffer type"),Yn=ns[dn.type]),"dimension"in dn&&(Ie.type(dn.dimension,"number","invalid dimension"),Cn=dn.dimension|0),"length"in dn&&(Ie.nni(ea,"buffer length must be a nonnegative integer"),ea=dn.length|0)),hn.bind(),ki?Un(hn,ki,Xn,Yn,Cn,qn):(ea&&me.bufferData(hn.type,ea,Xn),hn.dtype=Yn||Ei,hn.usage=Xn,hn.dimension=Cn,hn.byteLength=ea),Lt.profile&&(hn.stats.size=hn.byteLength*In[hn.dtype]),ti}function An(dn,Xn){Ie(Xn+dn.byteLength<=hn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+dn.byteLength+" starting from offset "+Xn+" to a buffer of size "+hn.byteLength),me.bufferSubData(hn.type,Xn,dn)}function Qn(dn,Xn){var ki=(Xn||0)|0,ea;if(hn.bind(),w(dn)||dn instanceof ArrayBuffer)An(dn,ki);else if(Array.isArray(dn)){if(dn.length>0)if(typeof dn[0]=="number"){var Yn=ue.allocType(hn.dtype,dn.length);ol(Yn,dn),An(Yn,ki),ue.freeType(Yn)}else if(Array.isArray(dn[0])||w(dn[0])){ea=al(dn);var Cn=Cu(dn,ea,hn.dtype);An(Cn,ki),ue.freeType(Cn)}else Ie.raise("invalid buffer data")}else if(vo(dn)){ea=dn.shape;var Jr=dn.stride,Di=0,va=0,ri=0,pa=0;ea.length===1?(Di=ea[0],va=1,ri=Jr[0],pa=0):ea.length===2?(Di=ea[0],va=ea[1],ri=Jr[0],pa=Jr[1]):Ie.raise("invalid shape");var ta=Array.isArray(dn.data)?hn.dtype:Co(dn.data),Wi=ue.allocType(ta,Di*va);ql(Wi,dn.data,Di,va,ri,pa,dn.offset),An(Wi,ki),ue.freeType(Wi)}else Ie.raise("invalid data for buffer subdata");return ti}return On||ti(sr),ti._reglType="buffer",ti._buffer=hn,ti.subdata=Qn,Lt.profile&&(ti.stats=hn.stats),ti.destroy=function(){un(hn)},ti}function Ln(){Va(Cr).forEach(function(sr){sr.buffer=me.createBuffer(),me.bindBuffer(sr.type,sr.buffer),me.bufferData(sr.type,sr.persistentData||sr.byteLength,sr.usage)})}return Lt.profile&&(ht.getTotalBufferSize=function(){var sr=0;return Object.keys(Cr).forEach(function(Fr){sr+=Cr[Fr].stats.size}),sr}),{create:Sn,createStream:gn,destroyStream:yn,clear:function(){Va(Cr).forEach(un),Mn.forEach(un)},getBuffer:function(sr){return sr&&sr._buffer instanceof fr?sr._buffer:null},restore:Ln,_initBuffer:Un}}var uc=0,Pc=0,Kc=1,bf=1,qc=4,Ol=4,lu={points:uc,point:Pc,lines:Kc,line:bf,triangles:qc,triangle:Ol,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ef=0,hs=1,gl=4,yl=5120,Ws=5121,Js=5122,eu=5123,cu=5124,zs=5125,zu=34963,Zu=35040,lc=35044;function cc(me,ht,Lt,wr){var qr={},Cr=0,fr={uint8:Ws,uint16:eu};ht.oes_element_index_uint&&(fr.uint32=zs);function Mn(Ln){this.id=Cr++,qr[this.id]=this,this.buffer=Ln,this.primType=gl,this.vertCount=0,this.type=0}Mn.prototype.bind=function(){this.buffer.bind()};var gn=[];function yn(Ln){var sr=gn.pop();return sr||(sr=new Mn(Lt.create(null,zu,!0,!1)._buffer)),Un(sr,Ln,Zu,-1,-1,0,0),sr}function Pn(Ln){gn.push(Ln)}function Un(Ln,sr,Fr,On,qn,hn,ti){Ln.buffer.bind();var An;if(sr){var Qn=ti;!ti&&(!w(sr)||vo(sr)&&!w(sr.data))&&(Qn=ht.oes_element_index_uint?zs:eu),Lt._initBuffer(Ln.buffer,sr,Fr,Qn,3)}else me.bufferData(zu,hn,Fr),Ln.buffer.dtype=An||Ws,Ln.buffer.usage=Fr,Ln.buffer.dimension=3,Ln.buffer.byteLength=hn;if(An=ti,!ti){switch(Ln.buffer.dtype){case Ws:case yl:An=Ws;break;case eu:case Js:An=eu;break;case zs:case cu:An=zs;break;default:Ie.raise("unsupported type for element array")}Ln.buffer.dtype=An}Ln.type=An,Ie(An!==zs||!!ht.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var dn=qn;dn<0&&(dn=Ln.buffer.byteLength,An===eu?dn>>=1:An===zs&&(dn>>=2)),Ln.vertCount=dn;var Xn=On;if(On<0){Xn=gl;var ki=Ln.buffer.dimension;ki===1&&(Xn=Ef),ki===2&&(Xn=hs),ki===3&&(Xn=gl)}Ln.primType=Xn}function un(Ln){wr.elementsCount--,Ie(Ln.buffer!==null,"must not double destroy elements"),delete qr[Ln.id],Ln.buffer.destroy(),Ln.buffer=null}function Sn(Ln,sr){var Fr=Lt.create(null,zu,!0),On=new Mn(Fr._buffer);wr.elementsCount++;function qn(hn){if(!hn)Fr(),On.primType=gl,On.vertCount=0,On.type=Ws;else if(typeof hn=="number")Fr(hn),On.primType=gl,On.vertCount=hn|0,On.type=Ws;else{var ti=null,An=lc,Qn=-1,dn=-1,Xn=0,ki=0;Array.isArray(hn)||w(hn)||vo(hn)?ti=hn:(Ie.type(hn,"object","invalid arguments for elements"),"data"in hn&&(ti=hn.data,Ie(Array.isArray(ti)||w(ti)||vo(ti),"invalid data for element buffer")),"usage"in hn&&(Ie.parameter(hn.usage,is,"invalid element buffer usage"),An=is[hn.usage]),"primitive"in hn&&(Ie.parameter(hn.primitive,lu,"invalid element buffer primitive"),Qn=lu[hn.primitive]),"count"in hn&&(Ie(typeof hn.count=="number"&&hn.count>=0,"invalid vertex count for elements"),dn=hn.count|0),"type"in hn&&(Ie.parameter(hn.type,fr,"invalid buffer type"),ki=fr[hn.type]),"length"in hn?Xn=hn.length|0:(Xn=dn,ki===eu||ki===Js?Xn*=2:(ki===zs||ki===cu)&&(Xn*=4))),Un(On,ti,An,Qn,dn,Xn,ki)}return qn}return qn(Ln),qn._reglType="elements",qn._elements=On,qn.subdata=function(hn,ti){return Fr.subdata(hn,ti),qn},qn.destroy=function(){un(On)},qn}return{create:Sn,createStream:yn,destroyStream:Pn,getElements:function(Ln){return typeof Ln=="function"&&Ln._elements instanceof Mn?Ln._elements:null},clear:function(){Va(qr).forEach(un)}}}var ja=new Float32Array(1),jf=new Uint32Array(ja.buffer),fc=5123;function Il(me){for(var ht=ue.allocType(fc,me.length),Lt=0;Lt<me.length;++Lt)if(isNaN(me[Lt]))ht[Lt]=65535;else if(me[Lt]===1/0)ht[Lt]=31744;else if(me[Lt]===-1/0)ht[Lt]=64512;else{ja[0]=me[Lt];var wr=jf[0],qr=wr>>>31<<15,Cr=(wr<<1>>>24)-127,fr=wr>>13&1024-1;if(Cr<-24)ht[Lt]=qr;else if(Cr<-14){var Mn=-14-Cr;ht[Lt]=qr+(fr+1024>>Mn)}else Cr>15?ht[Lt]=qr+31744:ht[Lt]=qr+(Cr+15<<10)+fr}return ht}function co(me){return Array.isArray(me)||w(me)}var Qc=function(me){return!(me&me-1)&&!!me},Jc=34467,Ho=3553,wu=34067,fu=34069,hu=6408,Ql=6406,_l=6407,tu=6409,Jl=6410,sl=32854,ru=32855,Wo=36194,eo=32819,fo=32820,Ru=33635,Sf=34042,Vu=6402,hc=34041,Pl=35904,Zs=35906,Mu=36193,pu=33776,ju=33777,kl=33778,Dl=33779,$u=35986,pc=35987,Hu=34798,Rs=35840,ef=35841,kc=35842,tf=35843,xl=36196,Ou=5121,Ll=5123,Bl=5125,Wu=5126,Tf=10242,dc=10243,rf=10497,vc=33071,nf=33648,ec=10240,mc=10241,Gs=9728,du=9729,as=9984,Dc=9985,bl=9986,uo=9987,Lc=33170,Vs=4352,ul=4353,Ca=4354,lo=34046,Xs=3317,gc=37440,Gu=37441,vu=37443,Af=37444,Bc=33984,yc=[as,bl,Dc,uo],Fl=[0,tu,Jl,_l,hu],os={};os[tu]=os[Ql]=os[Vu]=1,os[hc]=os[Jl]=2,os[_l]=os[Pl]=3,os[hu]=os[Zs]=4;function So(me){return"[object "+me+"]"}var Nl=So("HTMLCanvasElement"),af=So("OffscreenCanvas"),wo=So("CanvasRenderingContext2D"),ii=So("ImageBitmap"),Ms=So("HTMLImageElement"),tc=So("HTMLVideoElement"),Ul=Object.keys(di).concat([Nl,af,wo,ii,Ms,tc]),ps=[];ps[Ou]=1,ps[Wu]=4,ps[Mu]=2,ps[Ll]=2,ps[Bl]=4;var to=[];to[sl]=2,to[ru]=2,to[Wo]=2,to[hc]=4,to[pu]=.5,to[ju]=.5,to[kl]=1,to[Dl]=1,to[$u]=.5,to[pc]=1,to[Hu]=1,to[Rs]=.5,to[ef]=.25,to[kc]=.5,to[tf]=.25,to[xl]=.5;function zl(me){return Array.isArray(me)&&(me.length===0||typeof me[0]=="number")}function S(me){if(!Array.isArray(me))return!1;var ht=me.length;return!(ht===0||!co(me[0]))}function Ge(me){return Object.prototype.toString.call(me)}function re(me){return Ge(me)===Nl}function ce(me){return Ge(me)===af}function G(me){return Ge(me)===wo}function xe(me){return Ge(me)===ii}function ut(me){return Ge(me)===Ms}function Dt(me){return Ge(me)===tc}function dt(me){if(!me)return!1;var ht=Ge(me);return Ul.indexOf(ht)>=0?!0:zl(me)||S(me)||vo(me)}function It(me){return di[Object.prototype.toString.call(me)]|0}function Tr(me,ht){var Lt=ht.length;switch(me.type){case Ou:case Ll:case Bl:case Wu:var wr=ue.allocType(me.type,Lt);wr.set(ht),me.data=wr;break;case Mu:me.data=Il(ht);break;default:Ie.raise("unsupported texture type, must specify a typed array")}}function Yr(me,ht){return ue.allocType(me.type===Mu?Wu:me.type,ht)}function wn(me,ht){me.type===Mu?(me.data=Il(ht),ue.freeType(ht)):me.data=ht}function Bn(me,ht,Lt,wr,qr,Cr){for(var fr=me.width,Mn=me.height,gn=me.channels,yn=fr*Mn*gn,Pn=Yr(me,yn),Un=0,un=0;un<Mn;++un)for(var Sn=0;Sn<fr;++Sn)for(var Ln=0;Ln<gn;++Ln)Pn[Un++]=ht[Lt*Sn+wr*un+qr*Ln+Cr];wn(me,Pn)}function Kn(me,ht,Lt,wr,qr,Cr){var fr;if(typeof to[me]!="undefined"?fr=to[me]:fr=os[me]*ps[ht],Cr&&(fr*=6),qr){for(var Mn=0,gn=Lt;gn>=1;)Mn+=fr*gn*gn,gn/=2;return Mn}else return fr*Lt*wr}function fi(me,ht,Lt,wr,qr,Cr,fr){var Mn={"don't care":Vs,"dont care":Vs,nice:Ca,fast:ul},gn={repeat:rf,clamp:vc,mirror:nf},yn={nearest:Gs,linear:du},Pn=x({mipmap:uo,"nearest mipmap nearest":as,"linear mipmap nearest":Dc,"nearest mipmap linear":bl,"linear mipmap linear":uo},yn),Un={none:0,browser:Af},un={uint8:Ou,rgba4:eo,rgb565:Ru,"rgb5 a1":fo},Sn={alpha:Ql,luminance:tu,"luminance alpha":Jl,rgb:_l,rgba:hu,rgba4:sl,"rgb5 a1":ru,rgb565:Wo},Ln={};ht.ext_srgb&&(Sn.srgb=Pl,Sn.srgba=Zs),ht.oes_texture_float&&(un.float32=un.float=Wu),ht.oes_texture_half_float&&(un.float16=un["half float"]=Mu),ht.webgl_depth_texture&&(x(Sn,{depth:Vu,"depth stencil":hc}),x(un,{uint16:Ll,uint32:Bl,"depth stencil":Sf})),ht.webgl_compressed_texture_s3tc&&x(Ln,{"rgb s3tc dxt1":pu,"rgba s3tc dxt1":ju,"rgba s3tc dxt3":kl,"rgba s3tc dxt5":Dl}),ht.webgl_compressed_texture_atc&&x(Ln,{"rgb atc":$u,"rgba atc explicit alpha":pc,"rgba atc interpolated alpha":Hu}),ht.webgl_compressed_texture_pvrtc&&x(Ln,{"rgb pvrtc 4bppv1":Rs,"rgb pvrtc 2bppv1":ef,"rgba pvrtc 4bppv1":kc,"rgba pvrtc 2bppv1":tf}),ht.webgl_compressed_texture_etc1&&(Ln["rgb etc1"]=xl);var sr=Array.prototype.slice.call(me.getParameter(Jc));Object.keys(Ln).forEach(function(Ct){var Mr=Ln[Ct];sr.indexOf(Mr)>=0&&(Sn[Ct]=Mr)});var Fr=Object.keys(Sn);Lt.textureFormats=Fr;var On=[];Object.keys(Sn).forEach(function(Ct){var Mr=Sn[Ct];On[Mr]=Ct});var qn=[];Object.keys(un).forEach(function(Ct){var Mr=un[Ct];qn[Mr]=Ct});var hn=[];Object.keys(yn).forEach(function(Ct){var Mr=yn[Ct];hn[Mr]=Ct});var ti=[];Object.keys(Pn).forEach(function(Ct){var Mr=Pn[Ct];ti[Mr]=Ct});var An=[];Object.keys(gn).forEach(function(Ct){var Mr=gn[Ct];An[Mr]=Ct});var Qn=Fr.reduce(function(Ct,Mr){var yr=Sn[Mr];return yr===tu||yr===Ql||yr===tu||yr===Jl||yr===Vu||yr===hc||ht.ext_srgb&&(yr===Pl||yr===Zs)?Ct[yr]=yr:yr===ru||Mr.indexOf("rgba")>=0?Ct[yr]=hu:Ct[yr]=_l,Ct},{});function dn(){this.internalformat=hu,this.format=hu,this.type=Ou,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Af,this.width=0,this.height=0,this.channels=0}function Xn(Ct,Mr){Ct.internalformat=Mr.internalformat,Ct.format=Mr.format,Ct.type=Mr.type,Ct.compressed=Mr.compressed,Ct.premultiplyAlpha=Mr.premultiplyAlpha,Ct.flipY=Mr.flipY,Ct.unpackAlignment=Mr.unpackAlignment,Ct.colorSpace=Mr.colorSpace,Ct.width=Mr.width,Ct.height=Mr.height,Ct.channels=Mr.channels}function ki(Ct,Mr){if(!(typeof Mr!="object"||!Mr)){if("premultiplyAlpha"in Mr&&(Ie.type(Mr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ct.premultiplyAlpha=Mr.premultiplyAlpha),"flipY"in Mr&&(Ie.type(Mr.flipY,"boolean","invalid texture flip"),Ct.flipY=Mr.flipY),"alignment"in Mr&&(Ie.oneOf(Mr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ct.unpackAlignment=Mr.alignment),"colorSpace"in Mr&&(Ie.parameter(Mr.colorSpace,Un,"invalid colorSpace"),Ct.colorSpace=Un[Mr.colorSpace]),"type"in Mr){var yr=Mr.type;Ie(ht.oes_texture_float||!(yr==="float"||yr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Ie(ht.oes_texture_half_float||!(yr==="half float"||yr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Ie(ht.webgl_depth_texture||!(yr==="uint16"||yr==="uint32"||yr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Ie.parameter(yr,un,"invalid texture type"),Ct.type=un[yr]}var ai=Ct.width,ca=Ct.height,yo=Ct.channels,Ke=!1;"shape"in Mr?(Ie(Array.isArray(Mr.shape)&&Mr.shape.length>=2,"shape must be an array"),ai=Mr.shape[0],ca=Mr.shape[1],Mr.shape.length===3&&(yo=Mr.shape[2],Ie(yo>0&&yo<=4,"invalid number of channels"),Ke=!0),Ie(ai>=0&&ai<=Lt.maxTextureSize,"invalid width"),Ie(ca>=0&&ca<=Lt.maxTextureSize,"invalid height")):("radius"in Mr&&(ai=ca=Mr.radius,Ie(ai>=0&&ai<=Lt.maxTextureSize,"invalid radius")),"width"in Mr&&(ai=Mr.width,Ie(ai>=0&&ai<=Lt.maxTextureSize,"invalid width")),"height"in Mr&&(ca=Mr.height,Ie(ca>=0&&ca<=Lt.maxTextureSize,"invalid height")),"channels"in Mr&&(yo=Mr.channels,Ie(yo>0&&yo<=4,"invalid number of channels"),Ke=!0)),Ct.width=ai|0,Ct.height=ca|0,Ct.channels=yo|0;var yt=!1;if("format"in Mr){var Nt=Mr.format;Ie(ht.webgl_depth_texture||!(Nt==="depth"||Nt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Ie.parameter(Nt,Sn,"invalid texture format");var br=Ct.internalformat=Sn[Nt];Ct.format=Qn[br],Nt in un&&("type"in Mr||(Ct.type=un[Nt])),Nt in Ln&&(Ct.compressed=!0),yt=!0}!Ke&&yt?Ct.channels=os[Ct.format]:Ke&&!yt?Ct.channels!==Fl[Ct.format]&&(Ct.format=Ct.internalformat=Fl[Ct.channels]):yt&&Ke&&Ie(Ct.channels===os[Ct.format],"number of channels inconsistent with specified format")}}function ea(Ct){me.pixelStorei(gc,Ct.flipY),me.pixelStorei(Gu,Ct.premultiplyAlpha),me.pixelStorei(vu,Ct.colorSpace),me.pixelStorei(Xs,Ct.unpackAlignment)}function Yn(){dn.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Cn(Ct,Mr){var yr=null;if(dt(Mr)?yr=Mr:Mr&&(Ie.type(Mr,"object","invalid pixel data type"),ki(Ct,Mr),"x"in Mr&&(Ct.xOffset=Mr.x|0),"y"in Mr&&(Ct.yOffset=Mr.y|0),dt(Mr.data)&&(yr=Mr.data)),Ie(!Ct.compressed||yr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Mr.copy){Ie(!yr,"can not specify copy and data field for the same texture");var ai=qr.viewportWidth,ca=qr.viewportHeight;Ct.width=Ct.width||ai-Ct.xOffset,Ct.height=Ct.height||ca-Ct.yOffset,Ct.needsCopy=!0,Ie(Ct.xOffset>=0&&Ct.xOffset<ai&&Ct.yOffset>=0&&Ct.yOffset<ca&&Ct.width>0&&Ct.width<=ai&&Ct.height>0&&Ct.height<=ca,"copy texture read out of bounds")}else if(!yr)Ct.width=Ct.width||1,Ct.height=Ct.height||1,Ct.channels=Ct.channels||4;else if(w(yr))Ct.channels=Ct.channels||4,Ct.data=yr,!("type"in Mr)&&Ct.type===Ou&&(Ct.type=It(yr));else if(zl(yr))Ct.channels=Ct.channels||4,Tr(Ct,yr),Ct.alignment=1,Ct.needsFree=!0;else if(vo(yr)){var yo=yr.data;!Array.isArray(yo)&&Ct.type===Ou&&(Ct.type=It(yo));var Ke=yr.shape,yt=yr.stride,Nt,br,mr,Ht,Jt,tr;Ke.length===3?(mr=Ke[2],tr=yt[2]):(Ie(Ke.length===2,"invalid ndarray pixel data, must be 2 or 3D"),mr=1,tr=1),Nt=Ke[0],br=Ke[1],Ht=yt[0],Jt=yt[1],Ct.alignment=1,Ct.width=Nt,Ct.height=br,Ct.channels=mr,Ct.format=Ct.internalformat=Fl[mr],Ct.needsFree=!0,Bn(Ct,yo,Ht,Jt,tr,yr.offset)}else if(re(yr)||ce(yr)||G(yr))re(yr)||ce(yr)?Ct.element=yr:Ct.element=yr.canvas,Ct.width=Ct.element.width,Ct.height=Ct.element.height,Ct.channels=4;else if(xe(yr))Ct.element=yr,Ct.width=yr.width,Ct.height=yr.height,Ct.channels=4;else if(ut(yr))Ct.element=yr,Ct.width=yr.naturalWidth,Ct.height=yr.naturalHeight,Ct.channels=4;else if(Dt(yr))Ct.element=yr,Ct.width=yr.videoWidth,Ct.height=yr.videoHeight,Ct.channels=4;else if(S(yr)){var Mt=Ct.width||yr[0].length,Xt=Ct.height||yr.length,mt=Ct.channels;co(yr[0][0])?mt=mt||yr[0][0].length:mt=mt||1;for(var Qt=fs.shape(yr),Ir=1,zr=0;zr<Qt.length;++zr)Ir*=Qt[zr];var mn=Yr(Ct,Ir);fs.flatten(yr,Qt,"",mn),wn(Ct,mn),Ct.alignment=1,Ct.width=Mt,Ct.height=Xt,Ct.channels=mt,Ct.format=Ct.internalformat=Fl[mt],Ct.needsFree=!0}Ct.type===Wu?Ie(Lt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ct.type===Mu&&Ie(Lt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Jr(Ct,Mr,yr){var ai=Ct.element,ca=Ct.data,yo=Ct.internalformat,Ke=Ct.format,yt=Ct.type,Nt=Ct.width,br=Ct.height;ea(Ct),ai?me.texImage2D(Mr,yr,Ke,Ke,yt,ai):Ct.compressed?me.compressedTexImage2D(Mr,yr,yo,Nt,br,0,ca):Ct.needsCopy?(wr(),me.copyTexImage2D(Mr,yr,Ke,Ct.xOffset,Ct.yOffset,Nt,br,0)):me.texImage2D(Mr,yr,Ke,Nt,br,0,Ke,yt,ca||null)}function Di(Ct,Mr,yr,ai,ca){var yo=Ct.element,Ke=Ct.data,yt=Ct.internalformat,Nt=Ct.format,br=Ct.type,mr=Ct.width,Ht=Ct.height;ea(Ct),yo?me.texSubImage2D(Mr,ca,yr,ai,Nt,br,yo):Ct.compressed?me.compressedTexSubImage2D(Mr,ca,yr,ai,yt,mr,Ht,Ke):Ct.needsCopy?(wr(),me.copyTexSubImage2D(Mr,ca,yr,ai,Ct.xOffset,Ct.yOffset,mr,Ht)):me.texSubImage2D(Mr,ca,yr,ai,mr,Ht,Nt,br,Ke)}var va=[];function ri(){return va.pop()||new Yn}function pa(Ct){Ct.needsFree&&ue.freeType(Ct.data),Yn.call(Ct),va.push(Ct)}function ta(){dn.call(this),this.genMipmaps=!1,this.mipmapHint=Vs,this.mipmask=0,this.images=Array(16)}function Wi(Ct,Mr,yr){var ai=Ct.images[0]=ri();Ct.mipmask=1,ai.width=Ct.width=Mr,ai.height=Ct.height=yr,ai.channels=Ct.channels=4}function Wa(Ct,Mr){var yr=null;if(dt(Mr))yr=Ct.images[0]=ri(),Xn(yr,Ct),Cn(yr,Mr),Ct.mipmask=1;else if(ki(Ct,Mr),Array.isArray(Mr.mipmap))for(var ai=Mr.mipmap,ca=0;ca<ai.length;++ca)yr=Ct.images[ca]=ri(),Xn(yr,Ct),yr.width>>=ca,yr.height>>=ca,Cn(yr,ai[ca]),Ct.mipmask|=1<<ca;else yr=Ct.images[0]=ri(),Xn(yr,Ct),Cn(yr,Mr),Ct.mipmask=1;Xn(Ct,Ct.images[0]),Ct.compressed&&(Ct.internalformat===pu||Ct.internalformat===ju||Ct.internalformat===kl||Ct.internalformat===Dl)&&Ie(Ct.width%4===0&&Ct.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ms(Ct,Mr){for(var yr=Ct.images,ai=0;ai<yr.length;++ai){if(!yr[ai])return;Jr(yr[ai],Mr,ai)}}var js=[];function Ia(){var Ct=js.pop()||new ta;dn.call(Ct),Ct.mipmask=0;for(var Mr=0;Mr<16;++Mr)Ct.images[Mr]=null;return Ct}function us(Ct){for(var Mr=Ct.images,yr=0;yr<Mr.length;++yr)Mr[yr]&&pa(Mr[yr]),Mr[yr]=null;js.push(Ct)}function Ro(){this.minFilter=Gs,this.magFilter=Gs,this.wrapS=vc,this.wrapT=vc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Vs}function Ss(Ct,Mr){if("min"in Mr){var yr=Mr.min;Ie.parameter(yr,Pn),Ct.minFilter=Pn[yr],yc.indexOf(Ct.minFilter)>=0&&!("faces"in Mr)&&(Ct.genMipmaps=!0)}if("mag"in Mr){var ai=Mr.mag;Ie.parameter(ai,yn),Ct.magFilter=yn[ai]}var ca=Ct.wrapS,yo=Ct.wrapT;if("wrap"in Mr){var Ke=Mr.wrap;typeof Ke=="string"?(Ie.parameter(Ke,gn),ca=yo=gn[Ke]):Array.isArray(Ke)&&(Ie.parameter(Ke[0],gn),Ie.parameter(Ke[1],gn),ca=gn[Ke[0]],yo=gn[Ke[1]])}else{if("wrapS"in Mr){var yt=Mr.wrapS;Ie.parameter(yt,gn),ca=gn[yt]}if("wrapT"in Mr){var Nt=Mr.wrapT;Ie.parameter(Nt,gn),yo=gn[Nt]}}if(Ct.wrapS=ca,Ct.wrapT=yo,"anisotropic"in Mr){var br=Mr.anisotropic;Ie(typeof br=="number"&&br>=1&&br<=Lt.maxAnisotropic,"aniso samples must be between 1 and "),Ct.anisotropic=Mr.anisotropic}if("mipmap"in Mr){var mr=!1;switch(typeof Mr.mipmap){case"string":Ie.parameter(Mr.mipmap,Mn,"invalid mipmap hint"),Ct.mipmapHint=Mn[Mr.mipmap],Ct.genMipmaps=!0,mr=!0;break;case"boolean":mr=Ct.genMipmaps=Mr.mipmap;break;case"object":Ie(Array.isArray(Mr.mipmap),"invalid mipmap type"),Ct.genMipmaps=!1,mr=!0;break;default:Ie.raise("invalid mipmap type")}mr&&!("min"in Mr)&&(Ct.minFilter=as)}}function Ts(Ct,Mr){me.texParameteri(Mr,mc,Ct.minFilter),me.texParameteri(Mr,ec,Ct.magFilter),me.texParameteri(Mr,Tf,Ct.wrapS),me.texParameteri(Mr,dc,Ct.wrapT),ht.ext_texture_filter_anisotropic&&me.texParameteri(Mr,lo,Ct.anisotropic),Ct.genMipmaps&&(me.hint(Lc,Ct.mipmapHint),me.generateMipmap(Mr))}var Go=0,ks={},ou=Lt.maxTextureUnits,gs=Array(ou).map(function(){return null});function la(Ct){dn.call(this),this.mipmask=0,this.internalformat=hu,this.id=Go++,this.refCount=1,this.target=Ct,this.texture=me.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ro,fr.profile&&(this.stats={size:0})}function Ys(Ct){me.activeTexture(Bc),me.bindTexture(Ct.target,Ct.texture)}function io(){var Ct=gs[0];Ct?me.bindTexture(Ct.target,Ct.texture):me.bindTexture(Ho,null)}function Zi(Ct){var Mr=Ct.texture;Ie(Mr,"must not double destroy texture");var yr=Ct.unit,ai=Ct.target;yr>=0&&(me.activeTexture(Bc+yr),me.bindTexture(ai,null),gs[yr]=null),me.deleteTexture(Mr),Ct.texture=null,Ct.params=null,Ct.pixels=null,Ct.refCount=0,delete ks[Ct.id],Cr.textureCount--}x(la.prototype,{bind:function(){var Ct=this;Ct.bindCount+=1;var Mr=Ct.unit;if(Mr<0){for(var yr=0;yr<ou;++yr){var ai=gs[yr];if(ai){if(ai.bindCount>0)continue;ai.unit=-1}gs[yr]=Ct,Mr=yr;break}Mr>=ou&&Ie.raise("insufficient number of texture units"),fr.profile&&Cr.maxTextureUnits<Mr+1&&(Cr.maxTextureUnits=Mr+1),Ct.unit=Mr,me.activeTexture(Bc+Mr),me.bindTexture(Ct.target,Ct.texture)}return Mr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Zi(this)}});function Ta(Ct,Mr){var yr=new la(Ho);ks[yr.id]=yr,Cr.textureCount++;function ai(Ke,yt){var Nt=yr.texInfo;Ro.call(Nt);var br=Ia();return typeof Ke=="number"?typeof yt=="number"?Wi(br,Ke|0,yt|0):Wi(br,Ke|0,Ke|0):Ke?(Ie.type(Ke,"object","invalid arguments to regl.texture"),Ss(Nt,Ke),Wa(br,Ke)):Wi(br,1,1),Nt.genMipmaps&&(br.mipmask=(br.width<<1)-1),yr.mipmask=br.mipmask,Xn(yr,br),Ie.texture2D(Nt,br,Lt),yr.internalformat=br.internalformat,ai.width=br.width,ai.height=br.height,Ys(yr),ms(br,Ho),Ts(Nt,Ho),io(),us(br),fr.profile&&(yr.stats.size=Kn(yr.internalformat,yr.type,br.width,br.height,Nt.genMipmaps,!1)),ai.format=On[yr.internalformat],ai.type=qn[yr.type],ai.mag=hn[Nt.magFilter],ai.min=ti[Nt.minFilter],ai.wrapS=An[Nt.wrapS],ai.wrapT=An[Nt.wrapT],ai}function ca(Ke,yt,Nt,br){Ie(!!Ke,"must specify image data");var mr=yt|0,Ht=Nt|0,Jt=br|0,tr=ri();return Xn(tr,yr),tr.width=0,tr.height=0,Cn(tr,Ke),tr.width=tr.width||(yr.width>>Jt)-mr,tr.height=tr.height||(yr.height>>Jt)-Ht,Ie(yr.type===tr.type&&yr.format===tr.format&&yr.internalformat===tr.internalformat,"incompatible format for texture.subimage"),Ie(mr>=0&&Ht>=0&&mr+tr.width<=yr.width&&Ht+tr.height<=yr.height,"texture.subimage write out of bounds"),Ie(yr.mipmask&1<<Jt,"missing mipmap data"),Ie(tr.data||tr.element||tr.needsCopy,"missing image data"),Ys(yr),Di(tr,Ho,mr,Ht,Jt),io(),pa(tr),ai}function yo(Ke,yt){var Nt=Ke|0,br=yt|0||Nt;if(Nt===yr.width&&br===yr.height)return ai;ai.width=yr.width=Nt,ai.height=yr.height=br,Ys(yr);for(var mr=0;yr.mipmask>>mr;++mr){var Ht=Nt>>mr,Jt=br>>mr;if(!Ht||!Jt)break;me.texImage2D(Ho,mr,yr.format,Ht,Jt,0,yr.format,yr.type,null)}return io(),fr.profile&&(yr.stats.size=Kn(yr.internalformat,yr.type,Nt,br,!1,!1)),ai}return ai(Ct,Mr),ai.subimage=ca,ai.resize=yo,ai._reglType="texture2d",ai._texture=yr,fr.profile&&(ai.stats=yr.stats),ai.destroy=function(){yr.decRef()},ai}function Ga(Ct,Mr,yr,ai,ca,yo){var Ke=new la(wu);ks[Ke.id]=Ke,Cr.cubeCount++;var yt=new Array(6);function Nt(Ht,Jt,tr,Mt,Xt,mt){var Qt,Ir=Ke.texInfo;for(Ro.call(Ir),Qt=0;Qt<6;++Qt)yt[Qt]=Ia();if(typeof Ht=="number"||!Ht){var zr=Ht|0||1;for(Qt=0;Qt<6;++Qt)Wi(yt[Qt],zr,zr)}else if(typeof Ht=="object")if(Jt)Wa(yt[0],Ht),Wa(yt[1],Jt),Wa(yt[2],tr),Wa(yt[3],Mt),Wa(yt[4],Xt),Wa(yt[5],mt);else if(Ss(Ir,Ht),ki(Ke,Ht),"faces"in Ht){var mn=Ht.faces;for(Ie(Array.isArray(mn)&&mn.length===6,"cube faces must be a length 6 array"),Qt=0;Qt<6;++Qt)Ie(typeof mn[Qt]=="object"&&!!mn[Qt],"invalid input for cube map face"),Xn(yt[Qt],Ke),Wa(yt[Qt],mn[Qt])}else for(Qt=0;Qt<6;++Qt)Wa(yt[Qt],Ht);else Ie.raise("invalid arguments to cube map");for(Xn(Ke,yt[0]),Lt.npotTextureCube||Ie(Qc(Ke.width)&&Qc(Ke.height),"your browser does not support non power or two texture dimensions"),Ir.genMipmaps?Ke.mipmask=(yt[0].width<<1)-1:Ke.mipmask=yt[0].mipmask,Ie.textureCube(Ke,Ir,yt,Lt),Ke.internalformat=yt[0].internalformat,Nt.width=yt[0].width,Nt.height=yt[0].height,Ys(Ke),Qt=0;Qt<6;++Qt)ms(yt[Qt],fu+Qt);for(Ts(Ir,wu),io(),fr.profile&&(Ke.stats.size=Kn(Ke.internalformat,Ke.type,Nt.width,Nt.height,Ir.genMipmaps,!0)),Nt.format=On[Ke.internalformat],Nt.type=qn[Ke.type],Nt.mag=hn[Ir.magFilter],Nt.min=ti[Ir.minFilter],Nt.wrapS=An[Ir.wrapS],Nt.wrapT=An[Ir.wrapT],Qt=0;Qt<6;++Qt)us(yt[Qt]);return Nt}function br(Ht,Jt,tr,Mt,Xt){Ie(!!Jt,"must specify image data"),Ie(typeof Ht=="number"&&Ht===(Ht|0)&&Ht>=0&&Ht<6,"invalid face");var mt=tr|0,Qt=Mt|0,Ir=Xt|0,zr=ri();return Xn(zr,Ke),zr.width=0,zr.height=0,Cn(zr,Jt),zr.width=zr.width||(Ke.width>>Ir)-mt,zr.height=zr.height||(Ke.height>>Ir)-Qt,Ie(Ke.type===zr.type&&Ke.format===zr.format&&Ke.internalformat===zr.internalformat,"incompatible format for texture.subimage"),Ie(mt>=0&&Qt>=0&&mt+zr.width<=Ke.width&&Qt+zr.height<=Ke.height,"texture.subimage write out of bounds"),Ie(Ke.mipmask&1<<Ir,"missing mipmap data"),Ie(zr.data||zr.element||zr.needsCopy,"missing image data"),Ys(Ke),Di(zr,fu+Ht,mt,Qt,Ir),io(),pa(zr),Nt}function mr(Ht){var Jt=Ht|0;if(Jt!==Ke.width){Nt.width=Ke.width=Jt,Nt.height=Ke.height=Jt,Ys(Ke);for(var tr=0;tr<6;++tr)for(var Mt=0;Ke.mipmask>>Mt;++Mt)me.texImage2D(fu+tr,Mt,Ke.format,Jt>>Mt,Jt>>Mt,0,Ke.format,Ke.type,null);return io(),fr.profile&&(Ke.stats.size=Kn(Ke.internalformat,Ke.type,Nt.width,Nt.height,!1,!0)),Nt}}return Nt(Ct,Mr,yr,ai,ca,yo),Nt.subimage=br,Nt.resize=mr,Nt._reglType="textureCube",Nt._texture=Ke,fr.profile&&(Nt.stats=Ke.stats),Nt.destroy=function(){Ke.decRef()},Nt}function ys(){for(var Ct=0;Ct<ou;++Ct)me.activeTexture(Bc+Ct),me.bindTexture(Ho,null),gs[Ct]=null;Va(ks).forEach(Zi),Cr.cubeCount=0,Cr.textureCount=0}fr.profile&&(Cr.getTotalTextureSize=function(){var Ct=0;return Object.keys(ks).forEach(function(Mr){Ct+=ks[Mr].stats.size}),Ct});function ic(){for(var Ct=0;Ct<ou;++Ct){var Mr=gs[Ct];Mr&&(Mr.bindCount=0,Mr.unit=-1,gs[Ct]=null)}Va(ks).forEach(function(yr){yr.texture=me.createTexture(),me.bindTexture(yr.target,yr.texture);for(var ai=0;ai<32;++ai)if(yr.mipmask&1<<ai)if(yr.target===Ho)me.texImage2D(Ho,ai,yr.internalformat,yr.width>>ai,yr.height>>ai,0,yr.internalformat,yr.type,null);else for(var ca=0;ca<6;++ca)me.texImage2D(fu+ca,ai,yr.internalformat,yr.width>>ai,yr.height>>ai,0,yr.internalformat,yr.type,null);Ts(yr.texInfo,yr.target)})}return{create2D:Ta,createCube:Ga,clear:ys,getTexture:function(Ct){return null},restore:ic}}var Gr=36161,Ri=32854,Pi=32855,Mi=36194,wa=33189,Ja=36168,La=34041,ya=35907,Gi=34836,zn=34842,Fn=34843,$a=[];$a[Ri]=2,$a[Pi]=2,$a[Mi]=2,$a[wa]=2,$a[Ja]=1,$a[La]=4,$a[ya]=4,$a[Gi]=16,$a[zn]=8,$a[Fn]=6;function _a(me,ht,Lt){return $a[me]*ht*Lt}var Ra=function(me,ht,Lt,wr,qr){var Cr={rgba4:Ri,rgb565:Mi,"rgb5 a1":Pi,depth:wa,stencil:Ja,"depth stencil":La};ht.ext_srgb&&(Cr.srgba=ya),ht.ext_color_buffer_half_float&&(Cr.rgba16f=zn,Cr.rgb16f=Fn),ht.webgl_color_buffer_float&&(Cr.rgba32f=Gi);var fr=[];Object.keys(Cr).forEach(function(Sn){var Ln=Cr[Sn];fr[Ln]=Sn});var Mn=0,gn={};function yn(Sn){this.id=Mn++,this.refCount=1,this.renderbuffer=Sn,this.format=Ri,this.width=0,this.height=0,qr.profile&&(this.stats={size:0})}yn.prototype.decRef=function(){--this.refCount<=0&&Pn(this)};function Pn(Sn){var Ln=Sn.renderbuffer;Ie(Ln,"must not double destroy renderbuffer"),me.bindRenderbuffer(Gr,null),me.deleteRenderbuffer(Ln),Sn.renderbuffer=null,Sn.refCount=0,delete gn[Sn.id],wr.renderbufferCount--}function Un(Sn,Ln){var sr=new yn(me.createRenderbuffer());gn[sr.id]=sr,wr.renderbufferCount++;function Fr(qn,hn){var ti=0,An=0,Qn=Ri;if(typeof qn=="object"&&qn){var dn=qn;if("shape"in dn){var Xn=dn.shape;Ie(Array.isArray(Xn)&&Xn.length>=2,"invalid renderbuffer shape"),ti=Xn[0]|0,An=Xn[1]|0}else"radius"in dn&&(ti=An=dn.radius|0),"width"in dn&&(ti=dn.width|0),"height"in dn&&(An=dn.height|0);"format"in dn&&(Ie.parameter(dn.format,Cr,"invalid renderbuffer format"),Qn=Cr[dn.format])}else typeof qn=="number"?(ti=qn|0,typeof hn=="number"?An=hn|0:An=ti):qn?Ie.raise("invalid arguments to renderbuffer constructor"):ti=An=1;if(Ie(ti>0&&An>0&&ti<=Lt.maxRenderbufferSize&&An<=Lt.maxRenderbufferSize,"invalid renderbuffer size"),!(ti===sr.width&&An===sr.height&&Qn===sr.format))return Fr.width=sr.width=ti,Fr.height=sr.height=An,sr.format=Qn,me.bindRenderbuffer(Gr,sr.renderbuffer),me.renderbufferStorage(Gr,Qn,ti,An),Ie(me.getError()===0,"invalid render buffer format"),qr.profile&&(sr.stats.size=_a(sr.format,sr.width,sr.height)),Fr.format=fr[sr.format],Fr}function On(qn,hn){var ti=qn|0,An=hn|0||ti;return ti===sr.width&&An===sr.height||(Ie(ti>0&&An>0&&ti<=Lt.maxRenderbufferSize&&An<=Lt.maxRenderbufferSize,"invalid renderbuffer size"),Fr.width=sr.width=ti,Fr.height=sr.height=An,me.bindRenderbuffer(Gr,sr.renderbuffer),me.renderbufferStorage(Gr,sr.format,ti,An),Ie(me.getError()===0,"invalid render buffer format"),qr.profile&&(sr.stats.size=_a(sr.format,sr.width,sr.height))),Fr}return Fr(Sn,Ln),Fr.resize=On,Fr._reglType="renderbuffer",Fr._renderbuffer=sr,qr.profile&&(Fr.stats=sr.stats),Fr.destroy=function(){sr.decRef()},Fr}qr.profile&&(wr.getTotalRenderbufferSize=function(){var Sn=0;return Object.keys(gn).forEach(function(Ln){Sn+=gn[Ln].stats.size}),Sn});function un(){Va(gn).forEach(function(Sn){Sn.renderbuffer=me.createRenderbuffer(),me.bindRenderbuffer(Gr,Sn.renderbuffer),me.renderbufferStorage(Gr,Sn.format,Sn.width,Sn.height)}),me.bindRenderbuffer(Gr,null)}return{create:Un,clear:function(){Va(gn).forEach(Pn)},restore:un}},Ma=36160,da=36161,qo=3553,Xu=34069,ha=36064,mo=36096,Fc=36128,nu=33306,Cf=36053,Zl=36054,Os=36055,rc=36057,Vl=36061,$f=36193,ll=5121,El=5126,jl=6407,cl=6408,fl=6402,_c=[jl,cl],Ui=[];Ui[cl]=4,Ui[jl]=3;var mu=[];mu[ll]=1,mu[El]=4,mu[$f]=2;var wf=32854,To=32855,ho=36194,Yu=33189,$l=36168,gu=34041,Hl=35907,l=34836,p=34842,f=34843,m=[wf,To,ho,Hl,p,f,l],E={};E[Cf]="complete",E[Zl]="incomplete attachment",E[rc]="incomplete dimensions",E[Os]="incomplete, missing attachment",E[Vl]="unsupported";function R(me,ht,Lt,wr,qr,Cr){var fr={cur:null,next:null,dirty:!1,setFBO:null},Mn=["rgba"],gn=["rgba4","rgb565","rgb5 a1"];ht.ext_srgb&&gn.push("srgba"),ht.ext_color_buffer_half_float&&gn.push("rgba16f","rgb16f"),ht.webgl_color_buffer_float&&gn.push("rgba32f");var yn=["uint8"];ht.oes_texture_half_float&&yn.push("half float","float16"),ht.oes_texture_float&&yn.push("float","float32");function Pn(Yn,Cn,Jr){this.target=Yn,this.texture=Cn,this.renderbuffer=Jr;var Di=0,va=0;Cn?(Di=Cn.width,va=Cn.height):Jr&&(Di=Jr.width,va=Jr.height),this.width=Di,this.height=va}function Un(Yn){Yn&&(Yn.texture&&Yn.texture._texture.decRef(),Yn.renderbuffer&&Yn.renderbuffer._renderbuffer.decRef())}function un(Yn,Cn,Jr){if(Yn)if(Yn.texture){var Di=Yn.texture._texture,va=Math.max(1,Di.width),ri=Math.max(1,Di.height);Ie(va===Cn&&ri===Jr,"inconsistent width/height for supplied texture"),Di.refCount+=1}else{var pa=Yn.renderbuffer._renderbuffer;Ie(pa.width===Cn&&pa.height===Jr,"inconsistent width/height for renderbuffer"),pa.refCount+=1}}function Sn(Yn,Cn){Cn&&(Cn.texture?me.framebufferTexture2D(Ma,Yn,Cn.target,Cn.texture._texture.texture,0):me.framebufferRenderbuffer(Ma,Yn,da,Cn.renderbuffer._renderbuffer.renderbuffer))}function Ln(Yn){var Cn=qo,Jr=null,Di=null,va=Yn;typeof Yn=="object"&&(va=Yn.data,"target"in Yn&&(Cn=Yn.target|0)),Ie.type(va,"function","invalid attachment data");var ri=va._reglType;return ri==="texture2d"?(Jr=va,Ie(Cn===qo)):ri==="textureCube"?(Jr=va,Ie(Cn>=Xu&&Cn<Xu+6,"invalid cube map target")):ri==="renderbuffer"?(Di=va,Cn=da):Ie.raise("invalid regl object for attachment"),new Pn(Cn,Jr,Di)}function sr(Yn,Cn,Jr,Di,va){if(Jr){var ri=wr.create2D({width:Yn,height:Cn,format:Di,type:va});return ri._texture.refCount=0,new Pn(qo,ri,null)}else{var pa=qr.create({width:Yn,height:Cn,format:Di});return pa._renderbuffer.refCount=0,new Pn(da,null,pa)}}function Fr(Yn){return Yn&&(Yn.texture||Yn.renderbuffer)}function On(Yn,Cn,Jr){Yn&&(Yn.texture?Yn.texture.resize(Cn,Jr):Yn.renderbuffer&&Yn.renderbuffer.resize(Cn,Jr),Yn.width=Cn,Yn.height=Jr)}var qn=0,hn={};function ti(){this.id=qn++,hn[this.id]=this,this.framebuffer=me.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function An(Yn){Yn.colorAttachments.forEach(Un),Un(Yn.depthAttachment),Un(Yn.stencilAttachment),Un(Yn.depthStencilAttachment)}function Qn(Yn){var Cn=Yn.framebuffer;Ie(Cn,"must not double destroy framebuffer"),me.deleteFramebuffer(Cn),Yn.framebuffer=null,Cr.framebufferCount--,delete hn[Yn.id]}function dn(Yn){var Cn;me.bindFramebuffer(Ma,Yn.framebuffer);var Jr=Yn.colorAttachments;for(Cn=0;Cn<Jr.length;++Cn)Sn(ha+Cn,Jr[Cn]);for(Cn=Jr.length;Cn<Lt.maxColorAttachments;++Cn)me.framebufferTexture2D(Ma,ha+Cn,qo,null,0);me.framebufferTexture2D(Ma,nu,qo,null,0),me.framebufferTexture2D(Ma,mo,qo,null,0),me.framebufferTexture2D(Ma,Fc,qo,null,0),Sn(mo,Yn.depthAttachment),Sn(Fc,Yn.stencilAttachment),Sn(nu,Yn.depthStencilAttachment);var Di=me.checkFramebufferStatus(Ma);!me.isContextLost()&&Di!==Cf&&Ie.raise("framebuffer configuration not supported, status = "+E[Di]),me.bindFramebuffer(Ma,fr.next?fr.next.framebuffer:null),fr.cur=fr.next,me.getError()}function Xn(Yn,Cn){var Jr=new ti;Cr.framebufferCount++;function Di(ri,pa){var ta;Ie(fr.next!==Jr,"can not update framebuffer which is currently in use");var Wi=0,Wa=0,ms=!0,js=!0,Ia=null,us=!0,Ro="rgba",Ss="uint8",Ts=1,Go=null,ks=null,ou=null,gs=!1;if(typeof ri=="number")Wi=ri|0,Wa=pa|0||Wi;else if(!ri)Wi=Wa=1;else{Ie.type(ri,"object","invalid arguments for framebuffer");var la=ri;if("shape"in la){var Ys=la.shape;Ie(Array.isArray(Ys)&&Ys.length>=2,"invalid shape for framebuffer"),Wi=Ys[0],Wa=Ys[1]}else"radius"in la&&(Wi=Wa=la.radius),"width"in la&&(Wi=la.width),"height"in la&&(Wa=la.height);("color"in la||"colors"in la)&&(Ia=la.color||la.colors,Array.isArray(Ia)&&Ie(Ia.length===1||ht.webgl_draw_buffers,"multiple render targets not supported")),Ia||("colorCount"in la&&(Ts=la.colorCount|0,Ie(Ts>0,"invalid color buffer count")),"colorTexture"in la&&(us=!!la.colorTexture,Ro="rgba4"),"colorType"in la&&(Ss=la.colorType,us?(Ie(ht.oes_texture_float||!(Ss==="float"||Ss==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Ie(ht.oes_texture_half_float||!(Ss==="half float"||Ss==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ss==="half float"||Ss==="float16"?(Ie(ht.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ro="rgba16f"):(Ss==="float"||Ss==="float32")&&(Ie(ht.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ro="rgba32f"),Ie.oneOf(Ss,yn,"invalid color type")),"colorFormat"in la&&(Ro=la.colorFormat,Mn.indexOf(Ro)>=0?us=!0:gn.indexOf(Ro)>=0?us=!1:us?Ie.oneOf(la.colorFormat,Mn,"invalid color format for texture"):Ie.oneOf(la.colorFormat,gn,"invalid color format for renderbuffer"))),("depthTexture"in la||"depthStencilTexture"in la)&&(gs=!!(la.depthTexture||la.depthStencilTexture),Ie(!gs||ht.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in la&&(typeof la.depth=="boolean"?ms=la.depth:(Go=la.depth,js=!1)),"stencil"in la&&(typeof la.stencil=="boolean"?js=la.stencil:(ks=la.stencil,ms=!1)),"depthStencil"in la&&(typeof la.depthStencil=="boolean"?ms=js=la.depthStencil:(ou=la.depthStencil,ms=!1,js=!1))}var io=null,Zi=null,Ta=null,Ga=null;if(Array.isArray(Ia))io=Ia.map(Ln);else if(Ia)io=[Ln(Ia)];else for(io=new Array(Ts),ta=0;ta<Ts;++ta)io[ta]=sr(Wi,Wa,us,Ro,Ss);Ie(ht.webgl_draw_buffers||io.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Ie(io.length<=Lt.maxColorAttachments,"too many color attachments, not supported"),Wi=Wi||io[0].width,Wa=Wa||io[0].height,Go?Zi=Ln(Go):ms&&!js&&(Zi=sr(Wi,Wa,gs,"depth","uint32")),ks?Ta=Ln(ks):js&&!ms&&(Ta=sr(Wi,Wa,!1,"stencil","uint8")),ou?Ga=Ln(ou):!Go&&!ks&&js&&ms&&(Ga=sr(Wi,Wa,gs,"depth stencil","depth stencil")),Ie(!!Go+!!ks+!!ou<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ys=null;for(ta=0;ta<io.length;++ta)if(un(io[ta],Wi,Wa),Ie(!io[ta]||io[ta].texture&&_c.indexOf(io[ta].texture._texture.format)>=0||io[ta].renderbuffer&&m.indexOf(io[ta].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ta+" is invalid"),io[ta]&&io[ta].texture){var ic=Ui[io[ta].texture._texture.format]*mu[io[ta].texture._texture.type];ys===null?ys=ic:Ie(ys===ic,"all color attachments much have the same number of bits per pixel.")}return un(Zi,Wi,Wa),Ie(!Zi||Zi.texture&&Zi.texture._texture.format===fl||Zi.renderbuffer&&Zi.renderbuffer._renderbuffer.format===Yu,"invalid depth attachment for framebuffer object"),un(Ta,Wi,Wa),Ie(!Ta||Ta.renderbuffer&&Ta.renderbuffer._renderbuffer.format===$l,"invalid stencil attachment for framebuffer object"),un(Ga,Wi,Wa),Ie(!Ga||Ga.texture&&Ga.texture._texture.format===gu||Ga.renderbuffer&&Ga.renderbuffer._renderbuffer.format===gu,"invalid depth-stencil attachment for framebuffer object"),An(Jr),Jr.width=Wi,Jr.height=Wa,Jr.colorAttachments=io,Jr.depthAttachment=Zi,Jr.stencilAttachment=Ta,Jr.depthStencilAttachment=Ga,Di.color=io.map(Fr),Di.depth=Fr(Zi),Di.stencil=Fr(Ta),Di.depthStencil=Fr(Ga),Di.width=Jr.width,Di.height=Jr.height,dn(Jr),Di}function va(ri,pa){Ie(fr.next!==Jr,"can not resize a framebuffer which is currently in use");var ta=Math.max(ri|0,1),Wi=Math.max(pa|0||ta,1);if(ta===Jr.width&&Wi===Jr.height)return Di;for(var Wa=Jr.colorAttachments,ms=0;ms<Wa.length;++ms)On(Wa[ms],ta,Wi);return On(Jr.depthAttachment,ta,Wi),On(Jr.stencilAttachment,ta,Wi),On(Jr.depthStencilAttachment,ta,Wi),Jr.width=Di.width=ta,Jr.height=Di.height=Wi,dn(Jr),Di}return Di(Yn,Cn),x(Di,{resize:va,_reglType:"framebuffer",_framebuffer:Jr,destroy:function(){Qn(Jr),An(Jr)},use:function(ri){fr.setFBO({framebuffer:Di},ri)}})}function ki(Yn){var Cn=Array(6);function Jr(va){var ri;Ie(Cn.indexOf(fr.next)<0,"can not update framebuffer which is currently in use");var pa={color:null},ta=0,Wi=null,Wa="rgba",ms="uint8",js=1;if(typeof va=="number")ta=va|0;else if(!va)ta=1;else{Ie.type(va,"object","invalid arguments for framebuffer");var Ia=va;if("shape"in Ia){var us=Ia.shape;Ie(Array.isArray(us)&&us.length>=2,"invalid shape for framebuffer"),Ie(us[0]===us[1],"cube framebuffer must be square"),ta=us[0]}else"radius"in Ia&&(ta=Ia.radius|0),"width"in Ia?(ta=Ia.width|0,"height"in Ia&&Ie(Ia.height===ta,"must be square")):"height"in Ia&&(ta=Ia.height|0);("color"in Ia||"colors"in Ia)&&(Wi=Ia.color||Ia.colors,Array.isArray(Wi)&&Ie(Wi.length===1||ht.webgl_draw_buffers,"multiple render targets not supported")),Wi||("colorCount"in Ia&&(js=Ia.colorCount|0,Ie(js>0,"invalid color buffer count")),"colorType"in Ia&&(Ie.oneOf(Ia.colorType,yn,"invalid color type"),ms=Ia.colorType),"colorFormat"in Ia&&(Wa=Ia.colorFormat,Ie.oneOf(Ia.colorFormat,Mn,"invalid color format for texture"))),"depth"in Ia&&(pa.depth=Ia.depth),"stencil"in Ia&&(pa.stencil=Ia.stencil),"depthStencil"in Ia&&(pa.depthStencil=Ia.depthStencil)}var Ro;if(Wi)if(Array.isArray(Wi))for(Ro=[],ri=0;ri<Wi.length;++ri)Ro[ri]=Wi[ri];else Ro=[Wi];else{Ro=Array(js);var Ss={radius:ta,format:Wa,type:ms};for(ri=0;ri<js;++ri)Ro[ri]=wr.createCube(Ss)}for(pa.color=Array(Ro.length),ri=0;ri<Ro.length;++ri){var Ts=Ro[ri];Ie(typeof Ts=="function"&&Ts._reglType==="textureCube","invalid cube map"),ta=ta||Ts.width,Ie(Ts.width===ta&&Ts.height===ta,"invalid cube map shape"),pa.color[ri]={target:Xu,data:Ro[ri]}}for(ri=0;ri<6;++ri){for(var Go=0;Go<Ro.length;++Go)pa.color[Go].target=Xu+ri;ri>0&&(pa.depth=Cn[0].depth,pa.stencil=Cn[0].stencil,pa.depthStencil=Cn[0].depthStencil),Cn[ri]?Cn[ri](pa):Cn[ri]=Xn(pa)}return x(Jr,{width:ta,height:ta,color:Ro})}function Di(va){var ri,pa=va|0;if(Ie(pa>0&&pa<=Lt.maxCubeMapSize,"invalid radius for cube fbo"),pa===Jr.width)return Jr;var ta=Jr.color;for(ri=0;ri<ta.length;++ri)ta[ri].resize(pa);for(ri=0;ri<6;++ri)Cn[ri].resize(pa);return Jr.width=Jr.height=pa,Jr}return Jr(Yn),x(Jr,{faces:Cn,resize:Di,_reglType:"framebufferCube",destroy:function(){Cn.forEach(function(va){va.destroy()})}})}function ea(){fr.cur=null,fr.next=null,fr.dirty=!0,Va(hn).forEach(function(Yn){Yn.framebuffer=me.createFramebuffer(),dn(Yn)})}return x(fr,{getFramebuffer:function(Yn){if(typeof Yn=="function"&&Yn._reglType==="framebuffer"){var Cn=Yn._framebuffer;if(Cn instanceof ti)return Cn}return null},create:Xn,createCube:ki,clear:function(){Va(hn).forEach(Qn)},restore:ea})}var O=5126,$=34962;function ge(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=O,this.offset=0,this.stride=0,this.divisor=0}function Me(me,ht,Lt,wr,qr){for(var Cr=Lt.maxAttributes,fr=new Array(Cr),Mn=0;Mn<Cr;++Mn)fr[Mn]=new ge;var gn=0,yn={},Pn={Record:ge,scope:{},state:fr,currentVAO:null,targetVAO:null,restore:un()?hn:function(){},createVAO:ti,getVAO:Ln,destroyBuffer:Un,setVAO:un()?sr:Fr,clear:un()?On:function(){}};function Un(An){for(var Qn=0;Qn<fr.length;++Qn){var dn=fr[Qn];dn.buffer===An&&(me.disableVertexAttribArray(Qn),dn.buffer=null)}}function un(){return ht.oes_vertex_array_object}function Sn(){return ht.angle_instanced_arrays}function Ln(An){return typeof An=="function"&&An._vao?An._vao:null}function sr(An){if(An!==Pn.currentVAO){var Qn=un();An?Qn.bindVertexArrayOES(An.vao):Qn.bindVertexArrayOES(null),Pn.currentVAO=An}}function Fr(An){if(An!==Pn.currentVAO){if(An)An.bindAttrs();else for(var Qn=Sn(),dn=0;dn<fr.length;++dn){var Xn=fr[dn];Xn.buffer?(me.enableVertexAttribArray(dn),me.vertexAttribPointer(dn,Xn.size,Xn.type,Xn.normalized,Xn.stride,Xn.offfset),Qn&&Qn.vertexAttribDivisorANGLE(dn,Xn.divisor)):(me.disableVertexAttribArray(dn),me.vertexAttrib4f(dn,Xn.x,Xn.y,Xn.z,Xn.w))}Pn.currentVAO=An}}function On(){Va(yn).forEach(function(An){An.destroy()})}function qn(){this.id=++gn,this.attributes=[];var An=un();An?this.vao=An.createVertexArrayOES():this.vao=null,yn[this.id]=this,this.buffers=[]}qn.prototype.bindAttrs=function(){for(var An=Sn(),Qn=this.attributes,dn=0;dn<Qn.length;++dn){var Xn=Qn[dn];Xn.buffer?(me.enableVertexAttribArray(dn),me.bindBuffer($,Xn.buffer.buffer),me.vertexAttribPointer(dn,Xn.size,Xn.type,Xn.normalized,Xn.stride,Xn.offset),An&&An.vertexAttribDivisorANGLE(dn,Xn.divisor)):(me.disableVertexAttribArray(dn),me.vertexAttrib4f(dn,Xn.x,Xn.y,Xn.z,Xn.w))}for(var ki=Qn.length;ki<Cr;++ki)me.disableVertexAttribArray(ki)},qn.prototype.refresh=function(){var An=un();An&&(An.bindVertexArrayOES(this.vao),this.bindAttrs(),Pn.currentVAO=this)},qn.prototype.destroy=function(){if(this.vao){var An=un();this===Pn.currentVAO&&(Pn.currentVAO=null,An.bindVertexArrayOES(null)),An.deleteVertexArrayOES(this.vao),this.vao=null}yn[this.id]&&(delete yn[this.id],wr.vaoCount-=1)};function hn(){var An=un();An&&Va(yn).forEach(function(Qn){Qn.refresh()})}function ti(An){var Qn=new qn;wr.vaoCount+=1;function dn(Xn){Ie(Array.isArray(Xn),"arguments to vertex array constructor must be an array"),Ie(Xn.length<Cr,"too many attributes"),Ie(Xn.length>0,"must specify at least one attribute");for(var ki=0;ki<Qn.buffers.length;++ki)Qn.buffers[ki].destroy();Qn.buffers.length=0;var ea=Qn.attributes;ea.length=Xn.length;for(var Yn=0;Yn<Xn.length;++Yn){var Cn=Xn[Yn],Jr=ea[Yn]=new ge;if(Array.isArray(Cn)||w(Cn)||vo(Cn)){var Di=qr.create(Cn,$,!1,!0);Jr.buffer=qr.getBuffer(Di),Jr.size=Jr.buffer.dimension|0,Jr.normalized=!1,Jr.type=Jr.buffer.dtype,Jr.offset=0,Jr.stride=0,Jr.divisor=0,Jr.state=1,Qn.buffers.push(Di)}else qr.getBuffer(Cn)?(Jr.buffer=qr.getBuffer(Cn),Jr.size=Jr.buffer.dimension|0,Jr.normalized=!1,Jr.type=Jr.buffer.dtype,Jr.offset=0,Jr.stride=0,Jr.divisor=0,Jr.state=1):qr.getBuffer(Cn.buffer)?(Jr.buffer=qr.getBuffer(Cn.buffer),Jr.size=(+Cn.size||Jr.buffer.dimension)|0,Jr.normalized=!!Cn.normalized||!1,"type"in Cn?(Ie.parameter(Cn.type,ns,"invalid buffer type"),Jr.type=ns[Cn.type]):Jr.type=Jr.buffer.dtype,Jr.offset=(Cn.offset||0)|0,Jr.stride=(Cn.stride||0)|0,Jr.divisor=(Cn.divisor||0)|0,Jr.state=1,Ie(Jr.size>=1&&Jr.size<=4,"size must be between 1 and 4"),Ie(Jr.offset>=0,"invalid offset"),Ie(Jr.stride>=0&&Jr.stride<=255,"stride must be between 0 and 255"),Ie(Jr.divisor>=0,"divisor must be positive"),Ie(!Jr.divisor||!!ht.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Cn?(Ie(Yn>0,"first attribute must not be a constant"),Jr.x=+Cn.x||0,Jr.y=+Cn.y||0,Jr.z=+Cn.z||0,Jr.w=+Cn.w||0,Jr.state=2):Ie(!1,"invalid attribute spec for location "+Yn)}return Qn.refresh(),dn}return dn.destroy=function(){Qn.destroy()},dn._vao=Qn,dn._reglType="vao",dn(An)}return Pn}var Ye=35632,tt=35633,ot=35718,At=35721;function St(me,ht,Lt,wr){var qr={},Cr={};function fr(sr,Fr,On,qn){this.name=sr,this.id=Fr,this.location=On,this.info=qn}function Mn(sr,Fr){for(var On=0;On<sr.length;++On)if(sr[On].id===Fr.id){sr[On].location=Fr.location;return}sr.push(Fr)}function gn(sr,Fr,On){var qn=sr===Ye?qr:Cr,hn=qn[Fr];if(!hn){var ti=ht.str(Fr);hn=me.createShader(sr),me.shaderSource(hn,ti),me.compileShader(hn),Ie.shaderError(me,hn,ti,sr,On),qn[Fr]=hn}return hn}var yn={},Pn=[],Un=0;function un(sr,Fr){this.id=Un++,this.fragId=sr,this.vertId=Fr,this.program=null,this.uniforms=[],this.attributes=[],wr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Sn(sr,Fr,On){var qn,hn,ti=gn(Ye,sr.fragId),An=gn(tt,sr.vertId),Qn=sr.program=me.createProgram();if(me.attachShader(Qn,ti),me.attachShader(Qn,An),On)for(qn=0;qn<On.length;++qn){var dn=On[qn];me.bindAttribLocation(Qn,dn[0],dn[1])}me.linkProgram(Qn),Ie.linkError(me,Qn,ht.str(sr.fragId),ht.str(sr.vertId),Fr);var Xn=me.getProgramParameter(Qn,ot);wr.profile&&(sr.stats.uniformsCount=Xn);var ki=sr.uniforms;for(qn=0;qn<Xn;++qn)if(hn=me.getActiveUniform(Qn,qn),hn)if(hn.size>1)for(var ea=0;ea<hn.size;++ea){var Yn=hn.name.replace("[0]","["+ea+"]");Mn(ki,new fr(Yn,ht.id(Yn),me.getUniformLocation(Qn,Yn),hn))}else Mn(ki,new fr(hn.name,ht.id(hn.name),me.getUniformLocation(Qn,hn.name),hn));var Cn=me.getProgramParameter(Qn,At);wr.profile&&(sr.stats.attributesCount=Cn);var Jr=sr.attributes;for(qn=0;qn<Cn;++qn)hn=me.getActiveAttrib(Qn,qn),hn&&Mn(Jr,new fr(hn.name,ht.id(hn.name),me.getAttribLocation(Qn,hn.name),hn))}wr.profile&&(Lt.getMaxUniformsCount=function(){var sr=0;return Pn.forEach(function(Fr){Fr.stats.uniformsCount>sr&&(sr=Fr.stats.uniformsCount)}),sr},Lt.getMaxAttributesCount=function(){var sr=0;return Pn.forEach(function(Fr){Fr.stats.attributesCount>sr&&(sr=Fr.stats.attributesCount)}),sr});function Ln(){qr={},Cr={};for(var sr=0;sr<Pn.length;++sr)Sn(Pn[sr],null,Pn[sr].attributes.map(function(Fr){return[Fr.location,Fr.name]}))}return{clear:function(){var sr=me.deleteShader.bind(me);Va(qr).forEach(sr),qr={},Va(Cr).forEach(sr),Cr={},Pn.forEach(function(Fr){me.deleteProgram(Fr.program)}),Pn.length=0,yn={},Lt.shaderCount=0},program:function(sr,Fr,On,qn){Ie.command(sr>=0,"missing vertex shader",On),Ie.command(Fr>=0,"missing fragment shader",On);var hn=yn[Fr];hn||(hn=yn[Fr]={});var ti=hn[sr];if(ti&&!qn)return ti;var An=new un(Fr,sr);return Lt.shaderCount++,Sn(An,On,qn),ti||(hn[sr]=An),Pn.push(An),An},restore:Ln,shader:gn,frag:-1,vert:-1}}var Zt=6408,_t=5121,Vt=3333,er=5126;function cr(me,ht,Lt,wr,qr,Cr,fr){function Mn(Pn){var Un;ht.next===null?(Ie(qr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Un=_t):(Ie(ht.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Un=ht.next.colorAttachments[0].texture._texture.type,Cr.oes_texture_float?(Ie(Un===_t||Un===er,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Un===er&&Ie(fr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Ie(Un===_t,"Reading from a framebuffer is only allowed for the type 'uint8'"));var un=0,Sn=0,Ln=wr.framebufferWidth,sr=wr.framebufferHeight,Fr=null;w(Pn)?Fr=Pn:Pn&&(Ie.type(Pn,"object","invalid arguments to regl.read()"),un=Pn.x|0,Sn=Pn.y|0,Ie(un>=0&&un<wr.framebufferWidth,"invalid x offset for regl.read"),Ie(Sn>=0&&Sn<wr.framebufferHeight,"invalid y offset for regl.read"),Ln=(Pn.width||wr.framebufferWidth-un)|0,sr=(Pn.height||wr.framebufferHeight-Sn)|0,Fr=Pn.data||null),Fr&&(Un===_t?Ie(Fr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Un===er&&Ie(Fr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Ie(Ln>0&&Ln+un<=wr.framebufferWidth,"invalid width for read pixels"),Ie(sr>0&&sr+Sn<=wr.framebufferHeight,"invalid height for read pixels"),Lt();var On=Ln*sr*4;return Fr||(Un===_t?Fr=new Uint8Array(On):Un===er&&(Fr=Fr||new Float32Array(On))),Ie.isTypedArray(Fr,"data buffer for regl.read() must be a typedarray"),Ie(Fr.byteLength>=On,"data buffer for regl.read() too small"),me.pixelStorei(Vt,4),me.readPixels(un,Sn,Ln,sr,Zt,Un,Fr),Fr}function gn(Pn){var Un;return ht.setFBO({framebuffer:Pn.framebuffer},function(){Un=Mn(Pn)}),Un}function yn(Pn){return!Pn||!("framebuffer"in Pn)?Mn(Pn):gn(Pn)}return yn}function Rr(me){return Array.prototype.slice.call(me)}function Er(me){return Rr(me).join("")}function Br(){var me=0,ht=[],Lt=[];function wr(Un){for(var un=0;un<Lt.length;++un)if(Lt[un]===Un)return ht[un];var Sn="g"+me++;return ht.push(Sn),Lt.push(Un),Sn}function qr(){var Un=[];function un(){Un.push.apply(Un,Rr(arguments))}var Sn=[];function Ln(){var sr="v"+me++;return Sn.push(sr),arguments.length>0&&(Un.push(sr,"="),Un.push.apply(Un,Rr(arguments)),Un.push(";")),sr}return x(un,{def:Ln,toString:function(){return Er([Sn.length>0?"var "+Sn.join(",")+";":"",Er(Un)])}})}function Cr(){var Un=qr(),un=qr(),Sn=Un.toString,Ln=un.toString;function sr(Fr,On){un(Fr,On,"=",Un.def(Fr,On),";")}return x(function(){Un.apply(Un,Rr(arguments))},{def:Un.def,entry:Un,exit:un,save:sr,set:function(Fr,On,qn){sr(Fr,On),Un(Fr,On,"=",qn,";")},toString:function(){return Sn()+Ln()}})}function fr(){var Un=Er(arguments),un=Cr(),Sn=Cr(),Ln=un.toString,sr=Sn.toString;return x(un,{then:function(){return un.apply(un,Rr(arguments)),this},else:function(){return Sn.apply(Sn,Rr(arguments)),this},toString:function(){var Fr=sr();return Fr&&(Fr="else{"+Fr+"}"),Er(["if(",Un,"){",Ln(),"}",Fr])}})}var Mn=qr(),gn={};function yn(Un,un){var Sn=[];function Ln(){var hn="a"+Sn.length;return Sn.push(hn),hn}un=un||0;for(var sr=0;sr<un;++sr)Ln();var Fr=Cr(),On=Fr.toString,qn=gn[Un]=x(Fr,{arg:Ln,toString:function(){return Er(["function(",Sn.join(),"){",On(),"}"])}});return qn}function Pn(){var Un=['"use strict";',Mn,"return {"];Object.keys(gn).forEach(function(Ln){Un.push('"',Ln,'":',gn[Ln].toString(),",")}),Un.push("}");var un=Er(Un).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Sn=Function.apply(null,ht.concat(un));return Sn.apply(null,Lt)}return{global:Mn,link:wr,block:qr,proc:yn,scope:Cr,cond:fr,compile:Pn}}var tn="xyzw".split(""),M=5121,k=1,L=2,K=0,ie=1,ne=2,nt=3,rt=4,jt="dither",ct="blend.enable",Yt="blend.color",ar="blend.equation",fn="blend.func",on="depth.enable",Kr="depth.func",Gn="depth.range",Zn="depth.mask",jn="colorMask",vi="cull.enable",Si="cull.face",Oi="frontFace",Ba="lineWidth",Ha="polygonOffset.enable",go="polygonOffset.offset",Ea="sample.alpha",qi="sample.enable",Sa="sample.coverage",Zo="stencil.enable",ss="stencil.mask",Fo="stencil.func",Qo="stencil.opFront",Is="stencil.opBack",iu="scissor.enable",Iu="scissor.box",ds="viewport",Vo="profile",yu="framebuffer",_u="vert",Ku="frag",Oa="elements",Ps="primitive",vs="count",Wl="offset",Hf="instances",hl="vao",Wf="Width",Nc="Height",xc=yu+Wf,pl=yu+Nc,Rf=ds+Wf,ep=ds+Nc,of="drawingBuffer",xu=of+Wf,Pp=of+Nc,kp=[fn,ar,Fo,Qo,Is,Sa,ds,Iu,go],Mf=34962,dd=34963,Dp=35632,Lp=35633,hh=3553,vd=34067,Ih=2884,tp=3042,sf=3024,ph=2960,md=2929,rp=3089,pv=32823,Bp=32926,Fp=32928,Ph=5126,Gf=35664,uf=35665,au=35666,bc=5124,Uc=35667,Jo=35668,lf=35669,kh=35670,Xf=35671,Ec=35672,Gl=35673,Of=35674,If=35675,Sc=35676,Sl=35678,zc=35680,dh=4,Zc=1028,Pf=1029,Vc=2304,np=2305,ip=32775,Np=32776,Tc=519,kf=7680,gd=0,yd=1,_d=32774,xd=513,cf=36160,ap=36064,jc={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Dh=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Df={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Lf={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},op={frag:Dp,vert:Lp},ff={cw:Vc,ccw:np};function sp(me){return Array.isArray(me)||w(me)||vo(me)}function vh(me){return me.sort(function(ht,Lt){return ht===ds?-1:Lt===ds?1:ht<Lt?-1:1})}function bu(me,ht,Lt,wr){this.thisDep=me,this.contextDep=ht,this.propDep=Lt,this.append=wr}function Eu(me){return me&&!(me.thisDep||me.contextDep||me.propDep)}function es(me){return new bu(!1,!1,!1,me)}function dl(me,ht){var Lt=me.type;if(Lt===K){var wr=me.data.length;return new bu(!0,wr>=1,wr>=2,ht)}else if(Lt===rt){var qr=me.data;return new bu(qr.thisDep,qr.contextDep,qr.propDep,ht)}else return new bu(Lt===nt,Lt===ne,Lt===ie,ht)}var bd=new bu(!1,!1,!1,function(){});function nc(me,ht,Lt,wr,qr,Cr,fr,Mn,gn,yn,Pn,Un,un,Sn,Ln){var sr=yn.Record,Fr={add:32774,subtract:32778,"reverse subtract":32779};Lt.ext_blend_minmax&&(Fr.min=ip,Fr.max=Np);var On=Lt.angle_instanced_arrays,qn=Lt.webgl_draw_buffers,hn={dirty:!0,profile:Ln.profile},ti={},An=[],Qn={},dn={};function Xn(Ke){return Ke.replace(".","_")}function ki(Ke,yt,Nt){var br=Xn(Ke);An.push(Ke),ti[br]=hn[br]=!!Nt,Qn[br]=yt}function ea(Ke,yt,Nt){var br=Xn(Ke);An.push(Ke),Array.isArray(Nt)?(hn[br]=Nt.slice(),ti[br]=Nt.slice()):hn[br]=ti[br]=Nt,dn[br]=yt}ki(jt,sf),ki(ct,tp),ea(Yt,"blendColor",[0,0,0,0]),ea(ar,"blendEquationSeparate",[_d,_d]),ea(fn,"blendFuncSeparate",[yd,gd,yd,gd]),ki(on,md,!0),ea(Kr,"depthFunc",xd),ea(Gn,"depthRange",[0,1]),ea(Zn,"depthMask",!0),ea(jn,jn,[!0,!0,!0,!0]),ki(vi,Ih),ea(Si,"cullFace",Pf),ea(Oi,Oi,np),ea(Ba,Ba,1),ki(Ha,pv),ea(go,"polygonOffset",[0,0]),ki(Ea,Bp),ki(qi,Fp),ea(Sa,"sampleCoverage",[1,!1]),ki(Zo,ph),ea(ss,"stencilMask",-1),ea(Fo,"stencilFunc",[Tc,0,-1]),ea(Qo,"stencilOpSeparate",[Zc,kf,kf,kf]),ea(Is,"stencilOpSeparate",[Pf,kf,kf,kf]),ki(iu,rp),ea(Iu,"scissor",[0,0,me.drawingBufferWidth,me.drawingBufferHeight]),ea(ds,ds,[0,0,me.drawingBufferWidth,me.drawingBufferHeight]);var Yn={gl:me,context:un,strings:ht,next:ti,current:hn,draw:Un,elements:Cr,buffer:qr,shader:Pn,attributes:yn.state,vao:yn,uniforms:gn,framebuffer:Mn,extensions:Lt,timer:Sn,isBufferArgs:sp},Cn={primTypes:lu,compareFuncs:Df,blendFuncs:jc,blendEquations:Fr,stencilOps:Lf,glTypes:ns,orientationType:ff};Ie.optional(function(){Yn.isArrayLike=co}),qn&&(Cn.backBuffer=[Pf],Cn.drawBuffer=Ft(wr.maxDrawbuffers,function(Ke){return Ke===0?[0]:Ft(Ke,function(yt){return ap+yt})}));var Jr=0;function Di(){var Ke=Br(),yt=Ke.link,Nt=Ke.global;Ke.id=Jr++,Ke.batchId="0";var br=yt(Yn),mr=Ke.shared={props:"a0"};Object.keys(Yn).forEach(function(Xt){mr[Xt]=Nt.def(br,".",Xt)}),Ie.optional(function(){Ke.CHECK=yt(Ie),Ke.commandStr=Ie.guessCommand(),Ke.command=yt(Ke.commandStr),Ke.assert=function(Xt,mt,Qt){Xt("if(!(",mt,"))",this.CHECK,".commandRaise(",yt(Qt),",",this.command,");")},Cn.invalidBlendCombinations=Dh});var Ht=Ke.next={},Jt=Ke.current={};Object.keys(dn).forEach(function(Xt){Array.isArray(hn[Xt])&&(Ht[Xt]=Nt.def(mr.next,".",Xt),Jt[Xt]=Nt.def(mr.current,".",Xt))});var tr=Ke.constants={};Object.keys(Cn).forEach(function(Xt){tr[Xt]=Nt.def(JSON.stringify(Cn[Xt]))}),Ke.invoke=function(Xt,mt){switch(mt.type){case K:var Qt=["this",mr.context,mr.props,Ke.batchId];return Xt.def(yt(mt.data),".call(",Qt.slice(0,Math.max(mt.data.length+1,4)),")");case ie:return Xt.def(mr.props,mt.data);case ne:return Xt.def(mr.context,mt.data);case nt:return Xt.def("this",mt.data);case rt:return mt.data.append(Ke,Xt),mt.data.ref}},Ke.attribCache={};var Mt={};return Ke.scopeAttrib=function(Xt){var mt=ht.id(Xt);if(mt in Mt)return Mt[mt];var Qt=yn.scope[mt];Qt||(Qt=yn.scope[mt]=new sr);var Ir=Mt[mt]=yt(Qt);return Ir},Ke}function va(Ke){var yt=Ke.static,Nt=Ke.dynamic,br;if(Vo in yt){var mr=!!yt[Vo];br=es(function(Jt,tr){return mr}),br.enable=mr}else if(Vo in Nt){var Ht=Nt[Vo];br=dl(Ht,function(Jt,tr){return Jt.invoke(tr,Ht)})}return br}function ri(Ke,yt){var Nt=Ke.static,br=Ke.dynamic;if(yu in Nt){var mr=Nt[yu];return mr?(mr=Mn.getFramebuffer(mr),Ie.command(mr,"invalid framebuffer object"),es(function(Jt,tr){var Mt=Jt.link(mr),Xt=Jt.shared;tr.set(Xt.framebuffer,".next",Mt);var mt=Xt.context;return tr.set(mt,"."+xc,Mt+".width"),tr.set(mt,"."+pl,Mt+".height"),Mt})):es(function(Jt,tr){var Mt=Jt.shared;tr.set(Mt.framebuffer,".next","null");var Xt=Mt.context;return tr.set(Xt,"."+xc,Xt+"."+xu),tr.set(Xt,"."+pl,Xt+"."+Pp),"null"})}else if(yu in br){var Ht=br[yu];return dl(Ht,function(Jt,tr){var Mt=Jt.invoke(tr,Ht),Xt=Jt.shared,mt=Xt.framebuffer,Qt=tr.def(mt,".getFramebuffer(",Mt,")");Ie.optional(function(){Jt.assert(tr,"!"+Mt+"||"+Qt,"invalid framebuffer object")}),tr.set(mt,".next",Qt);var Ir=Xt.context;return tr.set(Ir,"."+xc,Qt+"?"+Qt+".width:"+Ir+"."+xu),tr.set(Ir,"."+pl,Qt+"?"+Qt+".height:"+Ir+"."+Pp),Qt})}else return null}function pa(Ke,yt,Nt){var br=Ke.static,mr=Ke.dynamic;function Ht(Mt){if(Mt in br){var Xt=br[Mt];Ie.commandType(Xt,"object","invalid "+Mt,Nt.commandStr);var mt=!0,Qt=Xt.x|0,Ir=Xt.y|0,zr,mn;return"width"in Xt?(zr=Xt.width|0,Ie.command(zr>=0,"invalid "+Mt,Nt.commandStr)):mt=!1,"height"in Xt?(mn=Xt.height|0,Ie.command(mn>=0,"invalid "+Mt,Nt.commandStr)):mt=!1,new bu(!mt&&yt&&yt.thisDep,!mt&&yt&&yt.contextDep,!mt&&yt&&yt.propDep,function(mi,hi){var _i=mi.shared.context,Vi=zr;"width"in Xt||(Vi=hi.def(_i,".",xc,"-",Qt));var Qi=mn;return"height"in Xt||(Qi=hi.def(_i,".",pl,"-",Ir)),[Qt,Ir,Vi,Qi]})}else if(Mt in mr){var an=mr[Mt],En=dl(an,function(mi,hi){var _i=mi.invoke(hi,an);Ie.optional(function(){mi.assert(hi,_i+"&&typeof "+_i+'==="object"',"invalid "+Mt)});var Vi=mi.shared.context,Qi=hi.def(_i,".x|0"),ao=hi.def(_i,".y|0"),Xo=hi.def('"width" in ',_i,"?",_i,".width|0:","(",Vi,".",xc,"-",Qi,")"),qu=hi.def('"height" in ',_i,"?",_i,".height|0:","(",Vi,".",pl,"-",ao,")");return Ie.optional(function(){mi.assert(hi,Xo+">=0&&"+qu+">=0","invalid "+Mt)}),[Qi,ao,Xo,qu]});return yt&&(En.thisDep=En.thisDep||yt.thisDep,En.contextDep=En.contextDep||yt.contextDep,En.propDep=En.propDep||yt.propDep),En}else return yt?new bu(yt.thisDep,yt.contextDep,yt.propDep,function(mi,hi){var _i=mi.shared.context;return[0,0,hi.def(_i,".",xc),hi.def(_i,".",pl)]}):null}var Jt=Ht(ds);if(Jt){var tr=Jt;Jt=new bu(Jt.thisDep,Jt.contextDep,Jt.propDep,function(Mt,Xt){var mt=tr.append(Mt,Xt),Qt=Mt.shared.context;return Xt.set(Qt,"."+Rf,mt[2]),Xt.set(Qt,"."+ep,mt[3]),mt})}return{viewport:Jt,scissor_box:Ht(Iu)}}function ta(Ke,yt){var Nt=Ke.static,br=typeof Nt[Ku]=="string"&&typeof Nt[_u]=="string";if(br){if(Object.keys(yt.dynamic).length>0)return null;var mr=yt.static,Ht=Object.keys(mr);if(Ht.length>0&&typeof mr[Ht[0]]=="number"){for(var Jt=[],tr=0;tr<Ht.length;++tr)Ie(typeof mr[Ht[tr]]=="number","must specify all vertex attribute locations when using vaos"),Jt.push([mr[Ht[tr]]|0,Ht[tr]]);return Jt}}return null}function Wi(Ke,yt,Nt){var br=Ke.static,mr=Ke.dynamic;function Ht(mt){if(mt in br){var Qt=ht.id(br[mt]);Ie.optional(function(){Pn.shader(op[mt],Qt,Ie.guessCommand())});var Ir=es(function(){return Qt});return Ir.id=Qt,Ir}else if(mt in mr){var zr=mr[mt];return dl(zr,function(mn,an){var En=mn.invoke(an,zr),mi=an.def(mn.shared.strings,".id(",En,")");return Ie.optional(function(){an(mn.shared.shader,".shader(",op[mt],",",mi,",",mn.command,");")}),mi})}return null}var Jt=Ht(Ku),tr=Ht(_u),Mt=null,Xt;return Eu(Jt)&&Eu(tr)?(Mt=Pn.program(tr.id,Jt.id,null,Nt),Xt=es(function(mt,Qt){return mt.link(Mt)})):Xt=new bu(Jt&&Jt.thisDep||tr&&tr.thisDep,Jt&&Jt.contextDep||tr&&tr.contextDep,Jt&&Jt.propDep||tr&&tr.propDep,function(mt,Qt){var Ir=mt.shared.shader,zr;Jt?zr=Jt.append(mt,Qt):zr=Qt.def(Ir,".",Ku);var mn;tr?mn=tr.append(mt,Qt):mn=Qt.def(Ir,".",_u);var an=Ir+".program("+mn+","+zr;return Ie.optional(function(){an+=","+mt.command}),Qt.def(an+")")}),{frag:Jt,vert:tr,progVar:Xt,program:Mt}}function Wa(Ke,yt){var Nt=Ke.static,br=Ke.dynamic;function mr(){if(Oa in Nt){var mt=Nt[Oa];sp(mt)?mt=Cr.getElements(Cr.create(mt,!0)):mt&&(mt=Cr.getElements(mt),Ie.command(mt,"invalid elements",yt.commandStr));var Qt=es(function(zr,mn){if(mt){var an=zr.link(mt);return zr.ELEMENTS=an,an}return zr.ELEMENTS=null,null});return Qt.value=mt,Qt}else if(Oa in br){var Ir=br[Oa];return dl(Ir,function(zr,mn){var an=zr.shared,En=an.isBufferArgs,mi=an.elements,hi=zr.invoke(mn,Ir),_i=mn.def("null"),Vi=mn.def(En,"(",hi,")"),Qi=zr.cond(Vi).then(_i,"=",mi,".createStream(",hi,");").else(_i,"=",mi,".getElements(",hi,");");return Ie.optional(function(){zr.assert(Qi.else,"!"+hi+"||"+_i,"invalid elements")}),mn.entry(Qi),mn.exit(zr.cond(Vi).then(mi,".destroyStream(",_i,");")),zr.ELEMENTS=_i,_i})}return null}var Ht=mr();function Jt(){if(Ps in Nt){var mt=Nt[Ps];return Ie.commandParameter(mt,lu,"invalid primitve",yt.commandStr),es(function(Ir,zr){return lu[mt]})}else if(Ps in br){var Qt=br[Ps];return dl(Qt,function(Ir,zr){var mn=Ir.constants.primTypes,an=Ir.invoke(zr,Qt);return Ie.optional(function(){Ir.assert(zr,an+" in "+mn,"invalid primitive, must be one of "+Object.keys(lu))}),zr.def(mn,"[",an,"]")})}else if(Ht)return Eu(Ht)?Ht.value?es(function(Ir,zr){return zr.def(Ir.ELEMENTS,".primType")}):es(function(){return dh}):new bu(Ht.thisDep,Ht.contextDep,Ht.propDep,function(Ir,zr){var mn=Ir.ELEMENTS;return zr.def(mn,"?",mn,".primType:",dh)});return null}function tr(mt,Qt){if(mt in Nt){var Ir=Nt[mt]|0;return Ie.command(!Qt||Ir>=0,"invalid "+mt,yt.commandStr),es(function(mn,an){return Qt&&(mn.OFFSET=Ir),Ir})}else if(mt in br){var zr=br[mt];return dl(zr,function(mn,an){var En=mn.invoke(an,zr);return Qt&&(mn.OFFSET=En,Ie.optional(function(){mn.assert(an,En+">=0","invalid "+mt)})),En})}else if(Qt&&Ht)return es(function(mn,an){return mn.OFFSET="0",0});return null}var Mt=tr(Wl,!0);function Xt(){if(vs in Nt){var mt=Nt[vs]|0;return Ie.command(typeof mt=="number"&&mt>=0,"invalid vertex count",yt.commandStr),es(function(){return mt})}else if(vs in br){var Qt=br[vs];return dl(Qt,function(mn,an){var En=mn.invoke(an,Qt);return Ie.optional(function(){mn.assert(an,"typeof "+En+'==="number"&&'+En+">=0&&"+En+"===("+En+"|0)","invalid vertex count")}),En})}else if(Ht)if(Eu(Ht)){if(Ht)return Mt?new bu(Mt.thisDep,Mt.contextDep,Mt.propDep,function(mn,an){var En=an.def(mn.ELEMENTS,".vertCount-",mn.OFFSET);return Ie.optional(function(){mn.assert(an,En+">=0","invalid vertex offset/element buffer too small")}),En}):es(function(mn,an){return an.def(mn.ELEMENTS,".vertCount")});var Ir=es(function(){return-1});return Ie.optional(function(){Ir.MISSING=!0}),Ir}else{var zr=new bu(Ht.thisDep||Mt.thisDep,Ht.contextDep||Mt.contextDep,Ht.propDep||Mt.propDep,function(mn,an){var En=mn.ELEMENTS;return mn.OFFSET?an.def(En,"?",En,".vertCount-",mn.OFFSET,":-1"):an.def(En,"?",En,".vertCount:-1")});return Ie.optional(function(){zr.DYNAMIC=!0}),zr}return null}return{elements:Ht,primitive:Jt(),count:Xt(),instances:tr(Hf,!1),offset:Mt}}function ms(Ke,yt){var Nt=Ke.static,br=Ke.dynamic,mr={};return An.forEach(function(Ht){var Jt=Xn(Ht);function tr(Mt,Xt){if(Ht in Nt){var mt=Mt(Nt[Ht]);mr[Jt]=es(function(){return mt})}else if(Ht in br){var Qt=br[Ht];mr[Jt]=dl(Qt,function(Ir,zr){return Xt(Ir,zr,Ir.invoke(zr,Qt))})}}switch(Ht){case vi:case ct:case jt:case Zo:case on:case iu:case Ha:case Ea:case qi:case Zn:return tr(function(Mt){return Ie.commandType(Mt,"boolean",Ht,yt.commandStr),Mt},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,"typeof "+mt+'==="boolean"',"invalid flag "+Ht,Mt.commandStr)}),mt});case Kr:return tr(function(Mt){return Ie.commandParameter(Mt,Df,"invalid "+Ht,yt.commandStr),Df[Mt]},function(Mt,Xt,mt){var Qt=Mt.constants.compareFuncs;return Ie.optional(function(){Mt.assert(Xt,mt+" in "+Qt,"invalid "+Ht+", must be one of "+Object.keys(Df))}),Xt.def(Qt,"[",mt,"]")});case Gn:return tr(function(Mt){return Ie.command(co(Mt)&&Mt.length===2&&typeof Mt[0]=="number"&&typeof Mt[1]=="number"&&Mt[0]<=Mt[1],"depth range is 2d array",yt.commandStr),Mt},function(Mt,Xt,mt){Ie.optional(function(){Mt.assert(Xt,Mt.shared.isArrayLike+"("+mt+")&&"+mt+".length===2&&typeof "+mt+'[0]==="number"&&typeof '+mt+'[1]==="number"&&'+mt+"[0]<="+mt+"[1]","depth range must be a 2d array")});var Qt=Xt.def("+",mt,"[0]"),Ir=Xt.def("+",mt,"[1]");return[Qt,Ir]});case fn:return tr(function(Mt){Ie.commandType(Mt,"object","blend.func",yt.commandStr);var Xt="srcRGB"in Mt?Mt.srcRGB:Mt.src,mt="srcAlpha"in Mt?Mt.srcAlpha:Mt.src,Qt="dstRGB"in Mt?Mt.dstRGB:Mt.dst,Ir="dstAlpha"in Mt?Mt.dstAlpha:Mt.dst;return Ie.commandParameter(Xt,jc,Jt+".srcRGB",yt.commandStr),Ie.commandParameter(mt,jc,Jt+".srcAlpha",yt.commandStr),Ie.commandParameter(Qt,jc,Jt+".dstRGB",yt.commandStr),Ie.commandParameter(Ir,jc,Jt+".dstAlpha",yt.commandStr),Ie.command(Dh.indexOf(Xt+", "+Qt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Xt+", "+Qt+")",yt.commandStr),[jc[Xt],jc[Qt],jc[mt],jc[Ir]]},function(Mt,Xt,mt){var Qt=Mt.constants.blendFuncs;Ie.optional(function(){Mt.assert(Xt,mt+"&&typeof "+mt+'==="object"',"invalid blend func, must be an object")});function Ir(_i,Vi){var Qi=Xt.def('"',_i,Vi,'" in ',mt,"?",mt,".",_i,Vi,":",mt,".",_i);return Ie.optional(function(){Mt.assert(Xt,Qi+" in "+Qt,"invalid "+Ht+"."+_i+Vi+", must be one of "+Object.keys(jc))}),Qi}var zr=Ir("src","RGB"),mn=Ir("dst","RGB");Ie.optional(function(){var _i=Mt.constants.invalidBlendCombinations;Mt.assert(Xt,_i+".indexOf("+zr+'+", "+'+mn+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var an=Xt.def(Qt,"[",zr,"]"),En=Xt.def(Qt,"[",Ir("src","Alpha"),"]"),mi=Xt.def(Qt,"[",mn,"]"),hi=Xt.def(Qt,"[",Ir("dst","Alpha"),"]");return[an,mi,En,hi]});case ar:return tr(function(Mt){if(typeof Mt=="string")return Ie.commandParameter(Mt,Fr,"invalid "+Ht,yt.commandStr),[Fr[Mt],Fr[Mt]];if(typeof Mt=="object")return Ie.commandParameter(Mt.rgb,Fr,Ht+".rgb",yt.commandStr),Ie.commandParameter(Mt.alpha,Fr,Ht+".alpha",yt.commandStr),[Fr[Mt.rgb],Fr[Mt.alpha]];Ie.commandRaise("invalid blend.equation",yt.commandStr)},function(Mt,Xt,mt){var Qt=Mt.constants.blendEquations,Ir=Xt.def(),zr=Xt.def(),mn=Mt.cond("typeof ",mt,'==="string"');return Ie.optional(function(){function an(En,mi,hi){Mt.assert(En,hi+" in "+Qt,"invalid "+mi+", must be one of "+Object.keys(Fr))}an(mn.then,Ht,mt),Mt.assert(mn.else,mt+"&&typeof "+mt+'==="object"',"invalid "+Ht),an(mn.else,Ht+".rgb",mt+".rgb"),an(mn.else,Ht+".alpha",mt+".alpha")}),mn.then(Ir,"=",zr,"=",Qt,"[",mt,"];"),mn.else(Ir,"=",Qt,"[",mt,".rgb];",zr,"=",Qt,"[",mt,".alpha];"),Xt(mn),[Ir,zr]});case Yt:return tr(function(Mt){return Ie.command(co(Mt)&&Mt.length===4,"blend.color must be a 4d array",yt.commandStr),Ft(4,function(Xt){return+Mt[Xt]})},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,Mt.shared.isArrayLike+"("+mt+")&&"+mt+".length===4","blend.color must be a 4d array")}),Ft(4,function(Qt){return Xt.def("+",mt,"[",Qt,"]")})});case ss:return tr(function(Mt){return Ie.commandType(Mt,"number",Jt,yt.commandStr),Mt|0},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,"typeof "+mt+'==="number"',"invalid stencil.mask")}),Xt.def(mt,"|0")});case Fo:return tr(function(Mt){Ie.commandType(Mt,"object",Jt,yt.commandStr);var Xt=Mt.cmp||"keep",mt=Mt.ref||0,Qt="mask"in Mt?Mt.mask:-1;return Ie.commandParameter(Xt,Df,Ht+".cmp",yt.commandStr),Ie.commandType(mt,"number",Ht+".ref",yt.commandStr),Ie.commandType(Qt,"number",Ht+".mask",yt.commandStr),[Df[Xt],mt,Qt]},function(Mt,Xt,mt){var Qt=Mt.constants.compareFuncs;Ie.optional(function(){function an(){Mt.assert(Xt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}an(mt+"&&typeof ",mt,'==="object"'),an('!("cmp" in ',mt,")||(",mt,".cmp in ",Qt,")")});var Ir=Xt.def('"cmp" in ',mt,"?",Qt,"[",mt,".cmp]",":",kf),zr=Xt.def(mt,".ref|0"),mn=Xt.def('"mask" in ',mt,"?",mt,".mask|0:-1");return[Ir,zr,mn]});case Qo:case Is:return tr(function(Mt){Ie.commandType(Mt,"object",Jt,yt.commandStr);var Xt=Mt.fail||"keep",mt=Mt.zfail||"keep",Qt=Mt.zpass||"keep";return Ie.commandParameter(Xt,Lf,Ht+".fail",yt.commandStr),Ie.commandParameter(mt,Lf,Ht+".zfail",yt.commandStr),Ie.commandParameter(Qt,Lf,Ht+".zpass",yt.commandStr),[Ht===Is?Pf:Zc,Lf[Xt],Lf[mt],Lf[Qt]]},function(Mt,Xt,mt){var Qt=Mt.constants.stencilOps;Ie.optional(function(){Mt.assert(Xt,mt+"&&typeof "+mt+'==="object"',"invalid "+Ht)});function Ir(zr){return Ie.optional(function(){Mt.assert(Xt,'!("'+zr+'" in '+mt+")||("+mt+"."+zr+" in "+Qt+")","invalid "+Ht+"."+zr+", must be one of "+Object.keys(Lf))}),Xt.def('"',zr,'" in ',mt,"?",Qt,"[",mt,".",zr,"]:",kf)}return[Ht===Is?Pf:Zc,Ir("fail"),Ir("zfail"),Ir("zpass")]});case go:return tr(function(Mt){Ie.commandType(Mt,"object",Jt,yt.commandStr);var Xt=Mt.factor|0,mt=Mt.units|0;return Ie.commandType(Xt,"number",Jt+".factor",yt.commandStr),Ie.commandType(mt,"number",Jt+".units",yt.commandStr),[Xt,mt]},function(Mt,Xt,mt){Ie.optional(function(){Mt.assert(Xt,mt+"&&typeof "+mt+'==="object"',"invalid "+Ht)});var Qt=Xt.def(mt,".factor|0"),Ir=Xt.def(mt,".units|0");return[Qt,Ir]});case Si:return tr(function(Mt){var Xt=0;return Mt==="front"?Xt=Zc:Mt==="back"&&(Xt=Pf),Ie.command(!!Xt,Jt,yt.commandStr),Xt},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,mt+'==="front"||'+mt+'==="back"',"invalid cull.face")}),Xt.def(mt,'==="front"?',Zc,":",Pf)});case Ba:return tr(function(Mt){return Ie.command(typeof Mt=="number"&&Mt>=wr.lineWidthDims[0]&&Mt<=wr.lineWidthDims[1],"invalid line width, must be a positive number between "+wr.lineWidthDims[0]+" and "+wr.lineWidthDims[1],yt.commandStr),Mt},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,"typeof "+mt+'==="number"&&'+mt+">="+wr.lineWidthDims[0]+"&&"+mt+"<="+wr.lineWidthDims[1],"invalid line width")}),mt});case Oi:return tr(function(Mt){return Ie.commandParameter(Mt,ff,Jt,yt.commandStr),ff[Mt]},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,mt+'==="cw"||'+mt+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Xt.def(mt+'==="cw"?'+Vc+":"+np)});case jn:return tr(function(Mt){return Ie.command(co(Mt)&&Mt.length===4,"color.mask must be length 4 array",yt.commandStr),Mt.map(function(Xt){return!!Xt})},function(Mt,Xt,mt){return Ie.optional(function(){Mt.assert(Xt,Mt.shared.isArrayLike+"("+mt+")&&"+mt+".length===4","invalid color.mask")}),Ft(4,function(Qt){return"!!"+mt+"["+Qt+"]"})});case Sa:return tr(function(Mt){Ie.command(typeof Mt=="object"&&Mt,Jt,yt.commandStr);var Xt="value"in Mt?Mt.value:1,mt=!!Mt.invert;return Ie.command(typeof Xt=="number"&&Xt>=0&&Xt<=1,"sample.coverage.value must be a number between 0 and 1",yt.commandStr),[Xt,mt]},function(Mt,Xt,mt){Ie.optional(function(){Mt.assert(Xt,mt+"&&typeof "+mt+'==="object"',"invalid sample.coverage")});var Qt=Xt.def('"value" in ',mt,"?+",mt,".value:1"),Ir=Xt.def("!!",mt,".invert");return[Qt,Ir]})}}),mr}function js(Ke,yt){var Nt=Ke.static,br=Ke.dynamic,mr={};return Object.keys(Nt).forEach(function(Ht){var Jt=Nt[Ht],tr;if(typeof Jt=="number"||typeof Jt=="boolean")tr=es(function(){return Jt});else if(typeof Jt=="function"){var Mt=Jt._reglType;Mt==="texture2d"||Mt==="textureCube"?tr=es(function(Xt){return Xt.link(Jt)}):Mt==="framebuffer"||Mt==="framebufferCube"?(Ie.command(Jt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ht+'"',yt.commandStr),tr=es(function(Xt){return Xt.link(Jt.color[0])})):Ie.commandRaise('invalid data for uniform "'+Ht+'"',yt.commandStr)}else co(Jt)?tr=es(function(Xt){var mt=Xt.global.def("[",Ft(Jt.length,function(Qt){return Ie.command(typeof Jt[Qt]=="number"||typeof Jt[Qt]=="boolean","invalid uniform "+Ht,Xt.commandStr),Jt[Qt]}),"]");return mt}):Ie.commandRaise('invalid or missing data for uniform "'+Ht+'"',yt.commandStr);tr.value=Jt,mr[Ht]=tr}),Object.keys(br).forEach(function(Ht){var Jt=br[Ht];mr[Ht]=dl(Jt,function(tr,Mt){return tr.invoke(Mt,Jt)})}),mr}function Ia(Ke,yt){var Nt=Ke.static,br=Ke.dynamic,mr={};return Object.keys(Nt).forEach(function(Ht){var Jt=Nt[Ht],tr=ht.id(Ht),Mt=new sr;if(sp(Jt))Mt.state=k,Mt.buffer=qr.getBuffer(qr.create(Jt,Mf,!1,!0)),Mt.type=0;else{var Xt=qr.getBuffer(Jt);if(Xt)Mt.state=k,Mt.buffer=Xt,Mt.type=0;else if(Ie.command(typeof Jt=="object"&&Jt,"invalid data for attribute "+Ht,yt.commandStr),"constant"in Jt){var mt=Jt.constant;Mt.buffer="null",Mt.state=L,typeof mt=="number"?Mt.x=mt:(Ie.command(co(mt)&&mt.length>0&&mt.length<=4,"invalid constant for attribute "+Ht,yt.commandStr),tn.forEach(function(mi,hi){hi<mt.length&&(Mt[mi]=mt[hi])}))}else{sp(Jt.buffer)?Xt=qr.getBuffer(qr.create(Jt.buffer,Mf,!1,!0)):Xt=qr.getBuffer(Jt.buffer),Ie.command(!!Xt,'missing buffer for attribute "'+Ht+'"',yt.commandStr);var Qt=Jt.offset|0;Ie.command(Qt>=0,'invalid offset for attribute "'+Ht+'"',yt.commandStr);var Ir=Jt.stride|0;Ie.command(Ir>=0&&Ir<256,'invalid stride for attribute "'+Ht+'", must be integer betweeen [0, 255]',yt.commandStr);var zr=Jt.size|0;Ie.command(!("size"in Jt)||zr>0&&zr<=4,'invalid size for attribute "'+Ht+'", must be 1,2,3,4',yt.commandStr);var mn=!!Jt.normalized,an=0;"type"in Jt&&(Ie.commandParameter(Jt.type,ns,"invalid type for attribute "+Ht,yt.commandStr),an=ns[Jt.type]);var En=Jt.divisor|0;"divisor"in Jt&&(Ie.command(En===0||On,'cannot specify divisor for attribute "'+Ht+'", instancing not supported',yt.commandStr),Ie.command(En>=0,'invalid divisor for attribute "'+Ht+'"',yt.commandStr)),Ie.optional(function(){var mi=yt.commandStr,hi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Jt).forEach(function(_i){Ie.command(hi.indexOf(_i)>=0,'unknown parameter "'+_i+'" for attribute pointer "'+Ht+'" (valid parameters are '+hi+")",mi)})}),Mt.buffer=Xt,Mt.state=k,Mt.size=zr,Mt.normalized=mn,Mt.type=an||Xt.dtype,Mt.offset=Qt,Mt.stride=Ir,Mt.divisor=En}}mr[Ht]=es(function(mi,hi){var _i=mi.attribCache;if(tr in _i)return _i[tr];var Vi={isStream:!1};return Object.keys(Mt).forEach(function(Qi){Vi[Qi]=Mt[Qi]}),Mt.buffer&&(Vi.buffer=mi.link(Mt.buffer),Vi.type=Vi.type||Vi.buffer+".dtype"),_i[tr]=Vi,Vi})}),Object.keys(br).forEach(function(Ht){var Jt=br[Ht];function tr(Mt,Xt){var mt=Mt.invoke(Xt,Jt),Qt=Mt.shared,Ir=Mt.constants,zr=Qt.isBufferArgs,mn=Qt.buffer;Ie.optional(function(){Mt.assert(Xt,mt+"&&(typeof "+mt+'==="object"||typeof '+mt+'==="function")&&('+zr+"("+mt+")||"+mn+".getBuffer("+mt+")||"+mn+".getBuffer("+mt+".buffer)||"+zr+"("+mt+'.buffer)||("constant" in '+mt+"&&(typeof "+mt+'.constant==="number"||'+Qt.isArrayLike+"("+mt+".constant))))",'invalid dynamic attribute "'+Ht+'"')});var an={isStream:Xt.def(!1)},En=new sr;En.state=k,Object.keys(En).forEach(function(Vi){an[Vi]=Xt.def(""+En[Vi])});var mi=an.buffer,hi=an.type;Xt("if(",zr,"(",mt,")){",an.isStream,"=true;",mi,"=",mn,".createStream(",Mf,",",mt,");",hi,"=",mi,".dtype;","}else{",mi,"=",mn,".getBuffer(",mt,");","if(",mi,"){",hi,"=",mi,".dtype;",'}else if("constant" in ',mt,"){",an.state,"=",L,";","if(typeof "+mt+'.constant === "number"){',an[tn[0]],"=",mt,".constant;",tn.slice(1).map(function(Vi){return an[Vi]}).join("="),"=0;","}else{",tn.map(function(Vi,Qi){return an[Vi]+"="+mt+".constant.length>"+Qi+"?"+mt+".constant["+Qi+"]:0;"}).join(""),"}}else{","if(",zr,"(",mt,".buffer)){",mi,"=",mn,".createStream(",Mf,",",mt,".buffer);","}else{",mi,"=",mn,".getBuffer(",mt,".buffer);","}",hi,'="type" in ',mt,"?",Ir.glTypes,"[",mt,".type]:",mi,".dtype;",an.normalized,"=!!",mt,".normalized;");function _i(Vi){Xt(an[Vi],"=",mt,".",Vi,"|0;")}return _i("size"),_i("offset"),_i("stride"),_i("divisor"),Xt("}}"),Xt.exit("if(",an.isStream,"){",mn,".destroyStream(",mi,");","}"),an}mr[Ht]=dl(Jt,tr)}),mr}function us(Ke,yt){var Nt=Ke.static,br=Ke.dynamic;if(hl in Nt){var mr=Nt[hl];return mr!==null&&yn.getVAO(mr)===null&&(mr=yn.createVAO(mr)),es(function(Jt){return Jt.link(yn.getVAO(mr))})}else if(hl in br){var Ht=br[hl];return dl(Ht,function(Jt,tr){var Mt=Jt.invoke(tr,Ht);return tr.def(Jt.shared.vao+".getVAO("+Mt+")")})}return null}function Ro(Ke){var yt=Ke.static,Nt=Ke.dynamic,br={};return Object.keys(yt).forEach(function(mr){var Ht=yt[mr];br[mr]=es(function(Jt,tr){return typeof Ht=="number"||typeof Ht=="boolean"?""+Ht:Jt.link(Ht)})}),Object.keys(Nt).forEach(function(mr){var Ht=Nt[mr];br[mr]=dl(Ht,function(Jt,tr){return Jt.invoke(tr,Ht)})}),br}function Ss(Ke,yt,Nt,br,mr){var Ht=Ke.static,Jt=Ke.dynamic;Ie.optional(function(){var _i=[yu,_u,Ku,Oa,Ps,Wl,vs,Hf,Vo,hl].concat(An);function Vi(Qi){Object.keys(Qi).forEach(function(ao){Ie.command(_i.indexOf(ao)>=0,'unknown parameter "'+ao+'"',mr.commandStr)})}Vi(Ht),Vi(Jt)});var tr=ta(Ke,yt),Mt=ri(Ke,mr),Xt=pa(Ke,Mt,mr),mt=Wa(Ke,mr),Qt=ms(Ke,mr),Ir=Wi(Ke,mr,tr);function zr(_i){var Vi=Xt[_i];Vi&&(Qt[_i]=Vi)}zr(ds),zr(Xn(Iu));var mn=Object.keys(Qt).length>0,an={framebuffer:Mt,draw:mt,shader:Ir,state:Qt,dirty:mn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(an.profile=va(Ke,mr),an.uniforms=js(Nt,mr),an.drawVAO=an.scopeVAO=us(Ke,mr),!an.drawVAO&&Ir.program&&!tr&&Lt.angle_instanced_arrays){var En=!0,mi=Ir.program.attributes.map(function(_i){var Vi=yt.static[_i];return En=En&&!!Vi,Vi});if(En&&mi.length>0){var hi=yn.getVAO(yn.createVAO(mi));an.drawVAO=new bu(null,null,null,function(_i,Vi){return _i.link(hi)}),an.useVAO=!0}}return tr?an.useVAO=!0:an.attributes=Ia(yt,mr),an.context=Ro(br,mr),an}function Ts(Ke,yt,Nt){var br=Ke.shared,mr=br.context,Ht=Ke.scope();Object.keys(Nt).forEach(function(Jt){yt.save(mr,"."+Jt);var tr=Nt[Jt];Ht(mr,".",Jt,"=",tr.append(Ke,yt),";")}),yt(Ht)}function Go(Ke,yt,Nt,br){var mr=Ke.shared,Ht=mr.gl,Jt=mr.framebuffer,tr;qn&&(tr=yt.def(mr.extensions,".webgl_draw_buffers"));var Mt=Ke.constants,Xt=Mt.drawBuffer,mt=Mt.backBuffer,Qt;Nt?Qt=Nt.append(Ke,yt):Qt=yt.def(Jt,".next"),br||yt("if(",Qt,"!==",Jt,".cur){"),yt("if(",Qt,"){",Ht,".bindFramebuffer(",cf,",",Qt,".framebuffer);"),qn&&yt(tr,".drawBuffersWEBGL(",Xt,"[",Qt,".colorAttachments.length]);"),yt("}else{",Ht,".bindFramebuffer(",cf,",null);"),qn&&yt(tr,".drawBuffersWEBGL(",mt,");"),yt("}",Jt,".cur=",Qt,";"),br||yt("}")}function ks(Ke,yt,Nt){var br=Ke.shared,mr=br.gl,Ht=Ke.current,Jt=Ke.next,tr=br.current,Mt=br.next,Xt=Ke.cond(tr,".dirty");An.forEach(function(mt){var Qt=Xn(mt);if(!(Qt in Nt.state)){var Ir,zr;if(Qt in Jt){Ir=Jt[Qt],zr=Ht[Qt];var mn=Ft(hn[Qt].length,function(En){return Xt.def(Ir,"[",En,"]")});Xt(Ke.cond(mn.map(function(En,mi){return En+"!=="+zr+"["+mi+"]"}).join("||")).then(mr,".",dn[Qt],"(",mn,");",mn.map(function(En,mi){return zr+"["+mi+"]="+En}).join(";"),";"))}else{Ir=Xt.def(Mt,".",Qt);var an=Ke.cond(Ir,"!==",tr,".",Qt);Xt(an),Qt in Qn?an(Ke.cond(Ir).then(mr,".enable(",Qn[Qt],");").else(mr,".disable(",Qn[Qt],");"),tr,".",Qt,"=",Ir,";"):an(mr,".",dn[Qt],"(",Ir,");",tr,".",Qt,"=",Ir,";")}}}),Object.keys(Nt.state).length===0&&Xt(tr,".dirty=false;"),yt(Xt)}function ou(Ke,yt,Nt,br){var mr=Ke.shared,Ht=Ke.current,Jt=mr.current,tr=mr.gl;vh(Object.keys(Nt)).forEach(function(Mt){var Xt=Nt[Mt];if(!(br&&!br(Xt))){var mt=Xt.append(Ke,yt);if(Qn[Mt]){var Qt=Qn[Mt];Eu(Xt)?mt?yt(tr,".enable(",Qt,");"):yt(tr,".disable(",Qt,");"):yt(Ke.cond(mt).then(tr,".enable(",Qt,");").else(tr,".disable(",Qt,");")),yt(Jt,".",Mt,"=",mt,";")}else if(co(mt)){var Ir=Ht[Mt];yt(tr,".",dn[Mt],"(",mt,");",mt.map(function(zr,mn){return Ir+"["+mn+"]="+zr}).join(";"),";")}else yt(tr,".",dn[Mt],"(",mt,");",Jt,".",Mt,"=",mt,";")}})}function gs(Ke,yt){On&&(Ke.instancing=yt.def(Ke.shared.extensions,".angle_instanced_arrays"))}function la(Ke,yt,Nt,br,mr){var Ht=Ke.shared,Jt=Ke.stats,tr=Ht.current,Mt=Ht.timer,Xt=Nt.profile;function mt(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Qt,Ir;function zr(_i){Qt=yt.def(),_i(Qt,"=",mt(),";"),typeof mr=="string"?_i(Jt,".count+=",mr,";"):_i(Jt,".count++;"),Sn&&(br?(Ir=yt.def(),_i(Ir,"=",Mt,".getNumPendingQueries();")):_i(Mt,".beginQuery(",Jt,");"))}function mn(_i){_i(Jt,".cpuTime+=",mt(),"-",Qt,";"),Sn&&(br?_i(Mt,".pushScopeStats(",Ir,",",Mt,".getNumPendingQueries(),",Jt,");"):_i(Mt,".endQuery();"))}function an(_i){var Vi=yt.def(tr,".profile");yt(tr,".profile=",_i,";"),yt.exit(tr,".profile=",Vi,";")}var En;if(Xt){if(Eu(Xt)){Xt.enable?(zr(yt),mn(yt.exit),an("true")):an("false");return}En=Xt.append(Ke,yt),an(En)}else En=yt.def(tr,".profile");var mi=Ke.block();zr(mi),yt("if(",En,"){",mi,"}");var hi=Ke.block();mn(hi),yt.exit("if(",En,"){",hi,"}")}function Ys(Ke,yt,Nt,br,mr){var Ht=Ke.shared;function Jt(Mt){switch(Mt){case Gf:case Uc:case Xf:return 2;case uf:case Jo:case Ec:return 3;case au:case lf:case Gl:return 4;default:return 1}}function tr(Mt,Xt,mt){var Qt=Ht.gl,Ir=yt.def(Mt,".location"),zr=yt.def(Ht.attributes,"[",Ir,"]"),mn=mt.state,an=mt.buffer,En=[mt.x,mt.y,mt.z,mt.w],mi=["buffer","normalized","offset","stride"];function hi(){yt("if(!",zr,".buffer){",Qt,".enableVertexAttribArray(",Ir,");}");var Vi=mt.type,Qi;if(mt.size?Qi=yt.def(mt.size,"||",Xt):Qi=Xt,yt("if(",zr,".type!==",Vi,"||",zr,".size!==",Qi,"||",mi.map(function(Xo){return zr+"."+Xo+"!=="+mt[Xo]}).join("||"),"){",Qt,".bindBuffer(",Mf,",",an,".buffer);",Qt,".vertexAttribPointer(",[Ir,Qi,Vi,mt.normalized,mt.stride,mt.offset],");",zr,".type=",Vi,";",zr,".size=",Qi,";",mi.map(function(Xo){return zr+"."+Xo+"="+mt[Xo]+";"}).join(""),"}"),On){var ao=mt.divisor;yt("if(",zr,".divisor!==",ao,"){",Ke.instancing,".vertexAttribDivisorANGLE(",[Ir,ao],");",zr,".divisor=",ao,";}")}}function _i(){yt("if(",zr,".buffer){",Qt,".disableVertexAttribArray(",Ir,");",zr,".buffer=null;","}if(",tn.map(function(Vi,Qi){return zr+"."+Vi+"!=="+En[Qi]}).join("||"),"){",Qt,".vertexAttrib4f(",Ir,",",En,");",tn.map(function(Vi,Qi){return zr+"."+Vi+"="+En[Qi]+";"}).join(""),"}")}mn===k?hi():mn===L?_i():(yt("if(",mn,"===",k,"){"),hi(),yt("}else{"),_i(),yt("}"))}br.forEach(function(Mt){var Xt=Mt.name,mt=Nt.attributes[Xt],Qt;if(mt){if(!mr(mt))return;Qt=mt.append(Ke,yt)}else{if(!mr(bd))return;var Ir=Ke.scopeAttrib(Xt);Ie.optional(function(){Ke.assert(yt,Ir+".state","missing attribute "+Xt)}),Qt={},Object.keys(new sr).forEach(function(zr){Qt[zr]=yt.def(Ir,".",zr)})}tr(Ke.link(Mt),Jt(Mt.info.type),Qt)})}function io(Ke,yt,Nt,br,mr){for(var Ht=Ke.shared,Jt=Ht.gl,tr,Mt=0;Mt<br.length;++Mt){var Xt=br[Mt],mt=Xt.name,Qt=Xt.info.type,Ir=Nt.uniforms[mt],zr=Ke.link(Xt),mn=zr+".location",an;if(Ir){if(!mr(Ir))continue;if(Eu(Ir)){var En=Ir.value;if(Ie.command(En!==null&&typeof En!="undefined",'missing uniform "'+mt+'"',Ke.commandStr),Qt===Sl||Qt===zc){Ie.command(typeof En=="function"&&(Qt===Sl&&(En._reglType==="texture2d"||En._reglType==="framebuffer")||Qt===zc&&(En._reglType==="textureCube"||En._reglType==="framebufferCube")),"invalid texture for uniform "+mt,Ke.commandStr);var mi=Ke.link(En._texture||En.color[0]._texture);yt(Jt,".uniform1i(",mn,",",mi+".bind());"),yt.exit(mi,".unbind();")}else if(Qt===Of||Qt===If||Qt===Sc){Ie.optional(function(){Ie.command(co(En),"invalid matrix for uniform "+mt,Ke.commandStr),Ie.command(Qt===Of&&En.length===4||Qt===If&&En.length===9||Qt===Sc&&En.length===16,"invalid length for matrix uniform "+mt,Ke.commandStr)});var hi=Ke.global.def("new Float32Array(["+Array.prototype.slice.call(En)+"])"),_i=2;Qt===If?_i=3:Qt===Sc&&(_i=4),yt(Jt,".uniformMatrix",_i,"fv(",mn,",false,",hi,");")}else{switch(Qt){case Ph:Ie.commandType(En,"number","uniform "+mt,Ke.commandStr),tr="1f";break;case Gf:Ie.command(co(En)&&En.length===2,"uniform "+mt,Ke.commandStr),tr="2f";break;case uf:Ie.command(co(En)&&En.length===3,"uniform "+mt,Ke.commandStr),tr="3f";break;case au:Ie.command(co(En)&&En.length===4,"uniform "+mt,Ke.commandStr),tr="4f";break;case kh:Ie.commandType(En,"boolean","uniform "+mt,Ke.commandStr),tr="1i";break;case bc:Ie.commandType(En,"number","uniform "+mt,Ke.commandStr),tr="1i";break;case Xf:Ie.command(co(En)&&En.length===2,"uniform "+mt,Ke.commandStr),tr="2i";break;case Uc:Ie.command(co(En)&&En.length===2,"uniform "+mt,Ke.commandStr),tr="2i";break;case Ec:Ie.command(co(En)&&En.length===3,"uniform "+mt,Ke.commandStr),tr="3i";break;case Jo:Ie.command(co(En)&&En.length===3,"uniform "+mt,Ke.commandStr),tr="3i";break;case Gl:Ie.command(co(En)&&En.length===4,"uniform "+mt,Ke.commandStr),tr="4i";break;case lf:Ie.command(co(En)&&En.length===4,"uniform "+mt,Ke.commandStr),tr="4i";break}yt(Jt,".uniform",tr,"(",mn,",",co(En)?Array.prototype.slice.call(En):En,");")}continue}else an=Ir.append(Ke,yt)}else{if(!mr(bd))continue;an=yt.def(Ht.uniforms,"[",ht.id(mt),"]")}Qt===Sl?yt("if(",an,"&&",an,'._reglType==="framebuffer"){',an,"=",an,".color[0];","}"):Qt===zc&&yt("if(",an,"&&",an,'._reglType==="framebufferCube"){',an,"=",an,".color[0];","}"),Ie.optional(function(){function qu(Ac,mh){Ke.assert(yt,Ac,'bad data or missing for uniform "'+mt+'".  '+mh)}function Bf(Ac){qu("typeof "+an+'==="'+Ac+'"',"invalid type, expected "+Ac)}function Pu(Ac,mh){qu(Ht.isArrayLike+"("+an+")&&"+an+".length==="+Ac,"invalid vector, should have length "+Ac,Ke.commandStr)}function jp(Ac){qu("typeof "+an+'==="function"&&'+an+'._reglType==="texture'+(Ac===hh?"2d":"Cube")+'"',"invalid texture type",Ke.commandStr)}switch(Qt){case bc:Bf("number");break;case Uc:Pu(2,"number");break;case Jo:Pu(3,"number");break;case lf:Pu(4,"number");break;case Ph:Bf("number");break;case Gf:Pu(2,"number");break;case uf:Pu(3,"number");break;case au:Pu(4,"number");break;case kh:Bf("boolean");break;case Xf:Pu(2,"boolean");break;case Ec:Pu(3,"boolean");break;case Gl:Pu(4,"boolean");break;case Of:Pu(4,"number");break;case If:Pu(9,"number");break;case Sc:Pu(16,"number");break;case Sl:jp(hh);break;case zc:jp(vd);break}});var Vi=1;switch(Qt){case Sl:case zc:var Qi=yt.def(an,"._texture");yt(Jt,".uniform1i(",mn,",",Qi,".bind());"),yt.exit(Qi,".unbind();");continue;case bc:case kh:tr="1i";break;case Uc:case Xf:tr="2i",Vi=2;break;case Jo:case Ec:tr="3i",Vi=3;break;case lf:case Gl:tr="4i",Vi=4;break;case Ph:tr="1f";break;case Gf:tr="2f",Vi=2;break;case uf:tr="3f",Vi=3;break;case au:tr="4f",Vi=4;break;case Of:tr="Matrix2fv";break;case If:tr="Matrix3fv";break;case Sc:tr="Matrix4fv";break}if(yt(Jt,".uniform",tr,"(",mn,","),tr.charAt(0)==="M"){var ao=Math.pow(Qt-Of+2,2),Xo=Ke.global.def("new Float32Array(",ao,")");yt("false,(Array.isArray(",an,")||",an," instanceof Float32Array)?",an,":(",Ft(ao,function(qu){return Xo+"["+qu+"]="+an+"["+qu+"]"}),",",Xo,")")}else Vi>1?yt(Ft(Vi,function(qu){return an+"["+qu+"]"})):yt(an);yt(");")}}function Zi(Ke,yt,Nt,br){var mr=Ke.shared,Ht=mr.gl,Jt=mr.draw,tr=br.draw;function Mt(){var Qi=tr.elements,ao,Xo=yt;return Qi?((Qi.contextDep&&br.contextDynamic||Qi.propDep)&&(Xo=Nt),ao=Qi.append(Ke,Xo)):ao=Xo.def(Jt,".",Oa),ao&&Xo("if("+ao+")"+Ht+".bindBuffer("+dd+","+ao+".buffer.buffer);"),ao}function Xt(){var Qi=tr.count,ao,Xo=yt;return Qi?((Qi.contextDep&&br.contextDynamic||Qi.propDep)&&(Xo=Nt),ao=Qi.append(Ke,Xo),Ie.optional(function(){Qi.MISSING&&Ke.assert(yt,"false","missing vertex count"),Qi.DYNAMIC&&Ke.assert(Xo,ao+">=0","missing vertex count")})):(ao=Xo.def(Jt,".",vs),Ie.optional(function(){Ke.assert(Xo,ao+">=0","missing vertex count")})),ao}var mt=Mt();function Qt(Qi){var ao=tr[Qi];return ao?ao.contextDep&&br.contextDynamic||ao.propDep?ao.append(Ke,Nt):ao.append(Ke,yt):yt.def(Jt,".",Qi)}var Ir=Qt(Ps),zr=Qt(Wl),mn=Xt();if(typeof mn=="number"){if(mn===0)return}else Nt("if(",mn,"){"),Nt.exit("}");var an,En;On&&(an=Qt(Hf),En=Ke.instancing);var mi=mt+".type",hi=tr.elements&&Eu(tr.elements);function _i(){function Qi(){Nt(En,".drawElementsInstancedANGLE(",[Ir,mn,mi,zr+"<<(("+mi+"-"+M+")>>1)",an],");")}function ao(){Nt(En,".drawArraysInstancedANGLE(",[Ir,zr,mn,an],");")}mt?hi?Qi():(Nt("if(",mt,"){"),Qi(),Nt("}else{"),ao(),Nt("}")):ao()}function Vi(){function Qi(){Nt(Ht+".drawElements("+[Ir,mn,mi,zr+"<<(("+mi+"-"+M+")>>1)"]+");")}function ao(){Nt(Ht+".drawArrays("+[Ir,zr,mn]+");")}mt?hi?Qi():(Nt("if(",mt,"){"),Qi(),Nt("}else{"),ao(),Nt("}")):ao()}On&&(typeof an!="number"||an>=0)?typeof an=="string"?(Nt("if(",an,">0){"),_i(),Nt("}else if(",an,"<0){"),Vi(),Nt("}")):_i():Vi()}function Ta(Ke,yt,Nt,br,mr){var Ht=Di(),Jt=Ht.proc("body",mr);return Ie.optional(function(){Ht.commandStr=yt.commandStr,Ht.command=Ht.link(yt.commandStr)}),On&&(Ht.instancing=Jt.def(Ht.shared.extensions,".angle_instanced_arrays")),Ke(Ht,Jt,Nt,br),Ht.compile().body}function Ga(Ke,yt,Nt,br){gs(Ke,yt),Nt.useVAO?Nt.drawVAO?yt(Ke.shared.vao,".setVAO(",Nt.drawVAO.append(Ke,yt),");"):yt(Ke.shared.vao,".setVAO(",Ke.shared.vao,".targetVAO);"):(yt(Ke.shared.vao,".setVAO(null);"),Ys(Ke,yt,Nt,br.attributes,function(){return!0})),io(Ke,yt,Nt,br.uniforms,function(){return!0}),Zi(Ke,yt,yt,Nt)}function ys(Ke,yt){var Nt=Ke.proc("draw",1);gs(Ke,Nt),Ts(Ke,Nt,yt.context),Go(Ke,Nt,yt.framebuffer),ks(Ke,Nt,yt),ou(Ke,Nt,yt.state),la(Ke,Nt,yt,!1,!0);var br=yt.shader.progVar.append(Ke,Nt);if(Nt(Ke.shared.gl,".useProgram(",br,".program);"),yt.shader.program)Ga(Ke,Nt,yt,yt.shader.program);else{Nt(Ke.shared.vao,".setVAO(null);");var mr=Ke.global.def("{}"),Ht=Nt.def(br,".id"),Jt=Nt.def(mr,"[",Ht,"]");Nt(Ke.cond(Jt).then(Jt,".call(this,a0);").else(Jt,"=",mr,"[",Ht,"]=",Ke.link(function(tr){return Ta(Ga,Ke,yt,tr,1)}),"(",br,");",Jt,".call(this,a0);"))}Object.keys(yt.state).length>0&&Nt(Ke.shared.current,".dirty=true;")}function ic(Ke,yt,Nt,br){Ke.batchId="a1",gs(Ke,yt);function mr(){return!0}Ys(Ke,yt,Nt,br.attributes,mr),io(Ke,yt,Nt,br.uniforms,mr),Zi(Ke,yt,yt,Nt)}function Ct(Ke,yt,Nt,br){gs(Ke,yt);var mr=Nt.contextDep,Ht=yt.def(),Jt="a0",tr="a1",Mt=yt.def();Ke.shared.props=Mt,Ke.batchId=Ht;var Xt=Ke.scope(),mt=Ke.scope();yt(Xt.entry,"for(",Ht,"=0;",Ht,"<",tr,";++",Ht,"){",Mt,"=",Jt,"[",Ht,"];",mt,"}",Xt.exit);function Qt(mi){return mi.contextDep&&mr||mi.propDep}function Ir(mi){return!Qt(mi)}if(Nt.needsContext&&Ts(Ke,mt,Nt.context),Nt.needsFramebuffer&&Go(Ke,mt,Nt.framebuffer),ou(Ke,mt,Nt.state,Qt),Nt.profile&&Qt(Nt.profile)&&la(Ke,mt,Nt,!1,!0),br)Nt.useVAO?Nt.drawVAO?Qt(Nt.drawVAO)?mt(Ke.shared.vao,".setVAO(",Nt.drawVAO.append(Ke,mt),");"):Xt(Ke.shared.vao,".setVAO(",Nt.drawVAO.append(Ke,Xt),");"):Xt(Ke.shared.vao,".setVAO(",Ke.shared.vao,".targetVAO);"):(Xt(Ke.shared.vao,".setVAO(null);"),Ys(Ke,Xt,Nt,br.attributes,Ir),Ys(Ke,mt,Nt,br.attributes,Qt)),io(Ke,Xt,Nt,br.uniforms,Ir),io(Ke,mt,Nt,br.uniforms,Qt),Zi(Ke,Xt,mt,Nt);else{var zr=Ke.global.def("{}"),mn=Nt.shader.progVar.append(Ke,mt),an=mt.def(mn,".id"),En=mt.def(zr,"[",an,"]");mt(Ke.shared.gl,".useProgram(",mn,".program);","if(!",En,"){",En,"=",zr,"[",an,"]=",Ke.link(function(mi){return Ta(ic,Ke,Nt,mi,2)}),"(",mn,");}",En,".call(this,a0[",Ht,"],",Ht,");")}}function Mr(Ke,yt){var Nt=Ke.proc("batch",2);Ke.batchId="0",gs(Ke,Nt);var br=!1,mr=!0;Object.keys(yt.context).forEach(function(zr){br=br||yt.context[zr].propDep}),br||(Ts(Ke,Nt,yt.context),mr=!1);var Ht=yt.framebuffer,Jt=!1;Ht?(Ht.propDep?br=Jt=!0:Ht.contextDep&&br&&(Jt=!0),Jt||Go(Ke,Nt,Ht)):Go(Ke,Nt,null),yt.state.viewport&&yt.state.viewport.propDep&&(br=!0);function tr(zr){return zr.contextDep&&br||zr.propDep}ks(Ke,Nt,yt),ou(Ke,Nt,yt.state,function(zr){return!tr(zr)}),(!yt.profile||!tr(yt.profile))&&la(Ke,Nt,yt,!1,"a1"),yt.contextDep=br,yt.needsContext=mr,yt.needsFramebuffer=Jt;var Mt=yt.shader.progVar;if(Mt.contextDep&&br||Mt.propDep)Ct(Ke,Nt,yt,null);else{var Xt=Mt.append(Ke,Nt);if(Nt(Ke.shared.gl,".useProgram(",Xt,".program);"),yt.shader.program)Ct(Ke,Nt,yt,yt.shader.program);else{Nt(Ke.shared.vao,".setVAO(null);");var mt=Ke.global.def("{}"),Qt=Nt.def(Xt,".id"),Ir=Nt.def(mt,"[",Qt,"]");Nt(Ke.cond(Ir).then(Ir,".call(this,a0,a1);").else(Ir,"=",mt,"[",Qt,"]=",Ke.link(function(zr){return Ta(Ct,Ke,yt,zr,2)}),"(",Xt,");",Ir,".call(this,a0,a1);"))}}Object.keys(yt.state).length>0&&Nt(Ke.shared.current,".dirty=true;")}function yr(Ke,yt){var Nt=Ke.proc("scope",3);Ke.batchId="a2";var br=Ke.shared,mr=br.current;Ts(Ke,Nt,yt.context),yt.framebuffer&&yt.framebuffer.append(Ke,Nt),vh(Object.keys(yt.state)).forEach(function(Jt){var tr=yt.state[Jt],Mt=tr.append(Ke,Nt);co(Mt)?Mt.forEach(function(Xt,mt){Nt.set(Ke.next[Jt],"["+mt+"]",Xt)}):Nt.set(br.next,"."+Jt,Mt)}),la(Ke,Nt,yt,!0,!0),[Oa,Wl,vs,Hf,Ps].forEach(function(Jt){var tr=yt.draw[Jt];tr&&Nt.set(br.draw,"."+Jt,""+tr.append(Ke,Nt))}),Object.keys(yt.uniforms).forEach(function(Jt){Nt.set(br.uniforms,"["+ht.id(Jt)+"]",yt.uniforms[Jt].append(Ke,Nt))}),Object.keys(yt.attributes).forEach(function(Jt){var tr=yt.attributes[Jt].append(Ke,Nt),Mt=Ke.scopeAttrib(Jt);Object.keys(new sr).forEach(function(Xt){Nt.set(Mt,"."+Xt,tr[Xt])})}),yt.scopeVAO&&Nt.set(br.vao,".targetVAO",yt.scopeVAO.append(Ke,Nt));function Ht(Jt){var tr=yt.shader[Jt];tr&&Nt.set(br.shader,"."+Jt,tr.append(Ke,Nt))}Ht(_u),Ht(Ku),Object.keys(yt.state).length>0&&(Nt(mr,".dirty=true;"),Nt.exit(mr,".dirty=true;")),Nt("a1(",Ke.shared.context,",a0,",Ke.batchId,");")}function ai(Ke){if(!(typeof Ke!="object"||co(Ke))){for(var yt=Object.keys(Ke),Nt=0;Nt<yt.length;++Nt)if(bi.isDynamic(Ke[yt[Nt]]))return!0;return!1}}function ca(Ke,yt,Nt){var br=yt.static[Nt];if(!br||!ai(br))return;var mr=Ke.global,Ht=Object.keys(br),Jt=!1,tr=!1,Mt=!1,Xt=Ke.global.def("{}");Ht.forEach(function(Qt){var Ir=br[Qt];if(bi.isDynamic(Ir)){typeof Ir=="function"&&(Ir=br[Qt]=bi.unbox(Ir));var zr=dl(Ir,null);Jt=Jt||zr.thisDep,Mt=Mt||zr.propDep,tr=tr||zr.contextDep}else{switch(mr(Xt,".",Qt,"="),typeof Ir){case"number":mr(Ir);break;case"string":mr('"',Ir,'"');break;case"object":Array.isArray(Ir)&&mr("[",Ir.join(),"]");break;default:mr(Ke.link(Ir));break}mr(";")}});function mt(Qt,Ir){Ht.forEach(function(zr){var mn=br[zr];if(bi.isDynamic(mn)){var an=Qt.invoke(Ir,mn);Ir(Xt,".",zr,"=",an,";")}})}yt.dynamic[Nt]=new bi.DynamicVariable(rt,{thisDep:Jt,contextDep:tr,propDep:Mt,ref:Xt,append:mt}),delete yt.static[Nt]}function yo(Ke,yt,Nt,br,mr){var Ht=Di();Ht.stats=Ht.link(mr),Object.keys(yt.static).forEach(function(tr){ca(Ht,yt,tr)}),kp.forEach(function(tr){ca(Ht,Ke,tr)});var Jt=Ss(Ke,yt,Nt,br,Ht);return ys(Ht,Jt),yr(Ht,Jt),Mr(Ht,Jt),Ht.compile()}return{next:ti,current:hn,procs:function(){var Ke=Di(),yt=Ke.proc("poll"),Nt=Ke.proc("refresh"),br=Ke.block();yt(br),Nt(br);var mr=Ke.shared,Ht=mr.gl,Jt=mr.next,tr=mr.current;br(tr,".dirty=false;"),Go(Ke,yt),Go(Ke,Nt,null,!0);var Mt;On&&(Mt=Ke.link(On)),Lt.oes_vertex_array_object&&Nt(Ke.link(Lt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Xt=0;Xt<wr.maxAttributes;++Xt){var mt=Nt.def(mr.attributes,"[",Xt,"]"),Qt=Ke.cond(mt,".buffer");Qt.then(Ht,".enableVertexAttribArray(",Xt,");",Ht,".bindBuffer(",Mf,",",mt,".buffer.buffer);",Ht,".vertexAttribPointer(",Xt,",",mt,".size,",mt,".type,",mt,".normalized,",mt,".stride,",mt,".offset);").else(Ht,".disableVertexAttribArray(",Xt,");",Ht,".vertexAttrib4f(",Xt,",",mt,".x,",mt,".y,",mt,".z,",mt,".w);",mt,".buffer=null;"),Nt(Qt),On&&Nt(Mt,".vertexAttribDivisorANGLE(",Xt,",",mt,".divisor);")}return Nt(Ke.shared.vao,".currentVAO=null;",Ke.shared.vao,".setVAO(",Ke.shared.vao,".targetVAO);"),Object.keys(Qn).forEach(function(Ir){var zr=Qn[Ir],mn=br.def(Jt,".",Ir),an=Ke.block();an("if(",mn,"){",Ht,".enable(",zr,")}else{",Ht,".disable(",zr,")}",tr,".",Ir,"=",mn,";"),Nt(an),yt("if(",mn,"!==",tr,".",Ir,"){",an,"}")}),Object.keys(dn).forEach(function(Ir){var zr=dn[Ir],mn=hn[Ir],an,En,mi=Ke.block();if(mi(Ht,".",zr,"("),co(mn)){var hi=mn.length;an=Ke.global.def(Jt,".",Ir),En=Ke.global.def(tr,".",Ir),mi(Ft(hi,function(_i){return an+"["+_i+"]"}),");",Ft(hi,function(_i){return En+"["+_i+"]="+an+"["+_i+"];"}).join("")),yt("if(",Ft(hi,function(_i){return an+"["+_i+"]!=="+En+"["+_i+"]"}).join("||"),"){",mi,"}")}else an=br.def(Jt,".",Ir),En=br.def(tr,".",Ir),mi(an,");",tr,".",Ir,"=",an,";"),yt("if(",an,"!==",En,"){",mi,"}");Nt(mi)}),Ke.compile()}(),compile:yo}}function up(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Lh=34918,Ed=34919,Up=35007,Yf=function(me,ht){if(!ht.ext_disjoint_timer_query)return null;var Lt=[];function wr(){return Lt.pop()||ht.ext_disjoint_timer_query.createQueryEXT()}function qr(On){Lt.push(On)}var Cr=[];function fr(On){var qn=wr();ht.ext_disjoint_timer_query.beginQueryEXT(Up,qn),Cr.push(qn),Sn(Cr.length-1,Cr.length,On)}function Mn(){ht.ext_disjoint_timer_query.endQueryEXT(Up)}function gn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var yn=[];function Pn(){return yn.pop()||new gn}function Un(On){yn.push(On)}var un=[];function Sn(On,qn,hn){var ti=Pn();ti.startQueryIndex=On,ti.endQueryIndex=qn,ti.sum=0,ti.stats=hn,un.push(ti)}var Ln=[],sr=[];function Fr(){var On,qn,hn=Cr.length;if(hn!==0){sr.length=Math.max(sr.length,hn+1),Ln.length=Math.max(Ln.length,hn+1),Ln[0]=0,sr[0]=0;var ti=0;for(On=0,qn=0;qn<Cr.length;++qn){var An=Cr[qn];ht.ext_disjoint_timer_query.getQueryObjectEXT(An,Ed)?(ti+=ht.ext_disjoint_timer_query.getQueryObjectEXT(An,Lh),qr(An)):Cr[On++]=An,Ln[qn+1]=ti,sr[qn+1]=On}for(Cr.length=On,On=0,qn=0;qn<un.length;++qn){var Qn=un[qn],dn=Qn.startQueryIndex,Xn=Qn.endQueryIndex;Qn.sum+=Ln[Xn]-Ln[dn];var ki=sr[dn],ea=sr[Xn];ea===ki?(Qn.stats.gpuTime+=Qn.sum/1e6,Un(Qn)):(Qn.startQueryIndex=ki,Qn.endQueryIndex=ea,un[On++]=Qn)}un.length=On}}return{beginQuery:fr,endQuery:Mn,pushScopeStats:Sn,update:Fr,getNumPendingQueries:function(){return Cr.length},clear:function(){Lt.push.apply(Lt,Cr);for(var On=0;On<Lt.length;On++)ht.ext_disjoint_timer_query.deleteQueryEXT(Lt[On]);Cr.length=0,Lt.length=0},restore:function(){Cr.length=0,Lt.length=0}}},zp=16384,Su=256,dv=1024,Sd=34962,Zp="webglcontextlost",Td="webglcontextrestored",Vp=1,vv=2,mv=3;function lp(me,ht){for(var Lt=0;Lt<me.length;++Lt)if(me[Lt]===ht)return Lt;return-1}function cp(me){var ht=Ut(me);if(!ht)return null;var Lt=ht.gl,wr=Lt.getContextAttributes(),qr=Lt.isContextLost(),Cr=ir(Lt,ht);if(!Cr)return null;var fr=it(),Mn=up(),gn=Cr.extensions,yn=Yf(Lt,gn),Pn=pi(),Un=Lt.drawingBufferWidth,un=Lt.drawingBufferHeight,Sn={tick:0,time:0,viewportWidth:Un,viewportHeight:un,framebufferWidth:Un,framebufferHeight:un,drawingBufferWidth:Un,drawingBufferHeight:un,pixelRatio:ht.pixelRatio},Ln={},sr={elements:null,primitive:4,count:-1,offset:0,instances:-1},Fr=Y(Lt,gn),On=Ic(Lt,Mn,ht,hn),qn=Me(Lt,gn,Fr,Mn,On);function hn(Zi){return qn.destroyBuffer(Zi)}var ti=cc(Lt,gn,On,Mn),An=St(Lt,fr,Mn,ht),Qn=fi(Lt,gn,Fr,function(){ki.procs.poll()},Sn,Mn,ht),dn=Ra(Lt,gn,Fr,Mn,ht),Xn=R(Lt,gn,Fr,Qn,dn,Mn),ki=nc(Lt,fr,gn,Fr,On,ti,Qn,Xn,Ln,qn,An,sr,Sn,yn,ht),ea=cr(Lt,Xn,ki.procs.poll,Sn,wr,gn,Fr),Yn=ki.next,Cn=Lt.canvas,Jr=[],Di=[],va=[],ri=[ht.onDestroy],pa=null;function ta(){if(Jr.length===0){yn&&yn.update(),pa=null;return}pa=ui.next(ta),ou();for(var Zi=Jr.length-1;Zi>=0;--Zi){var Ta=Jr[Zi];Ta&&Ta(Sn,null,0)}Lt.flush(),yn&&yn.update()}function Wi(){!pa&&Jr.length>0&&(pa=ui.next(ta))}function Wa(){pa&&(ui.cancel(ta),pa=null)}function ms(Zi){Zi.preventDefault(),qr=!0,Wa(),Di.forEach(function(Ta){Ta()})}function js(Zi){Lt.getError(),qr=!1,Cr.restore(),An.restore(),On.restore(),Qn.restore(),dn.restore(),Xn.restore(),qn.restore(),yn&&yn.restore(),ki.procs.refresh(),Wi(),va.forEach(function(Ta){Ta()})}Cn&&(Cn.addEventListener(Zp,ms,!1),Cn.addEventListener(Td,js,!1));function Ia(){Jr.length=0,Wa(),Cn&&(Cn.removeEventListener(Zp,ms),Cn.removeEventListener(Td,js)),An.clear(),Xn.clear(),dn.clear(),Qn.clear(),ti.clear(),On.clear(),qn.clear(),yn&&yn.clear(),ri.forEach(function(Zi){Zi()})}function us(Zi){Ie(!!Zi,"invalid args to regl({...})"),Ie.type(Zi,"object","invalid args to regl({...})");function Ta(mr){var Ht=x({},mr);delete Ht.uniforms,delete Ht.attributes,delete Ht.context,delete Ht.vao,"stencil"in Ht&&Ht.stencil.op&&(Ht.stencil.opBack=Ht.stencil.opFront=Ht.stencil.op,delete Ht.stencil.op);function Jt(tr){if(tr in Ht){var Mt=Ht[tr];delete Ht[tr],Object.keys(Mt).forEach(function(Xt){Ht[tr+"."+Xt]=Mt[Xt]})}}return Jt("blend"),Jt("depth"),Jt("cull"),Jt("stencil"),Jt("polygonOffset"),Jt("scissor"),Jt("sample"),"vao"in mr&&(Ht.vao=mr.vao),Ht}function Ga(mr){var Ht={},Jt={};return Object.keys(mr).forEach(function(tr){var Mt=mr[tr];bi.isDynamic(Mt)?Jt[tr]=bi.unbox(Mt,tr):Ht[tr]=Mt}),{dynamic:Jt,static:Ht}}var ys=Ga(Zi.context||{}),ic=Ga(Zi.uniforms||{}),Ct=Ga(Zi.attributes||{}),Mr=Ga(Ta(Zi)),yr={gpuTime:0,cpuTime:0,count:0},ai=ki.compile(Mr,Ct,ic,ys,yr),ca=ai.draw,yo=ai.batch,Ke=ai.scope,yt=[];function Nt(mr){for(;yt.length<mr;)yt.push(null);return yt}function br(mr,Ht){var Jt;if(qr&&Ie.raise("context lost"),typeof mr=="function")return Ke.call(this,null,mr,0);if(typeof Ht=="function")if(typeof mr=="number")for(Jt=0;Jt<mr;++Jt)Ke.call(this,null,Ht,Jt);else if(Array.isArray(mr))for(Jt=0;Jt<mr.length;++Jt)Ke.call(this,mr[Jt],Ht,Jt);else return Ke.call(this,mr,Ht,0);else if(typeof mr=="number"){if(mr>0)return yo.call(this,Nt(mr|0),mr|0)}else if(Array.isArray(mr)){if(mr.length)return yo.call(this,mr,mr.length)}else return ca.call(this,mr)}return x(br,{stats:yr})}var Ro=Xn.setFBO=us({framebuffer:bi.define.call(null,Vp,"framebuffer")});function Ss(Zi,Ta){var Ga=0;ki.procs.poll();var ys=Ta.color;ys&&(Lt.clearColor(+ys[0]||0,+ys[1]||0,+ys[2]||0,+ys[3]||0),Ga|=zp),"depth"in Ta&&(Lt.clearDepth(+Ta.depth),Ga|=Su),"stencil"in Ta&&(Lt.clearStencil(Ta.stencil|0),Ga|=dv),Ie(!!Ga,"called regl.clear with no buffer specified"),Lt.clear(Ga)}function Ts(Zi){if(Ie(typeof Zi=="object"&&Zi,"regl.clear() takes an object as input"),"framebuffer"in Zi)if(Zi.framebuffer&&Zi.framebuffer_reglType==="framebufferCube")for(var Ta=0;Ta<6;++Ta)Ro(x({framebuffer:Zi.framebuffer.faces[Ta]},Zi),Ss);else Ro(Zi,Ss);else Ss(null,Zi)}function Go(Zi){Ie.type(Zi,"function","regl.frame() callback must be a function"),Jr.push(Zi);function Ta(){var Ga=lp(Jr,Zi);Ie(Ga>=0,"cannot cancel a frame twice");function ys(){var ic=lp(Jr,ys);Jr[ic]=Jr[Jr.length-1],Jr.length-=1,Jr.length<=0&&Wa()}Jr[Ga]=ys}return Wi(),{cancel:Ta}}function ks(){var Zi=Yn.viewport,Ta=Yn.scissor_box;Zi[0]=Zi[1]=Ta[0]=Ta[1]=0,Sn.viewportWidth=Sn.framebufferWidth=Sn.drawingBufferWidth=Zi[2]=Ta[2]=Lt.drawingBufferWidth,Sn.viewportHeight=Sn.framebufferHeight=Sn.drawingBufferHeight=Zi[3]=Ta[3]=Lt.drawingBufferHeight}function ou(){Sn.tick+=1,Sn.time=la(),ks(),ki.procs.poll()}function gs(){ks(),ki.procs.refresh(),yn&&yn.update()}function la(){return(pi()-Pn)/1e3}gs();function Ys(Zi,Ta){Ie.type(Ta,"function","listener callback must be a function");var Ga;switch(Zi){case"frame":return Go(Ta);case"lost":Ga=Di;break;case"restore":Ga=va;break;case"destroy":Ga=ri;break;default:Ie.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ga.push(Ta),{cancel:function(){for(var ys=0;ys<Ga.length;++ys)if(Ga[ys]===Ta){Ga[ys]=Ga[Ga.length-1],Ga.pop();return}}}}var io=x(us,{clear:Ts,prop:bi.define.bind(null,Vp),context:bi.define.bind(null,vv),this:bi.define.bind(null,mv),draw:us({}),buffer:function(Zi){return On.create(Zi,Sd,!1,!1)},elements:function(Zi){return ti.create(Zi,!1)},texture:Qn.create2D,cube:Qn.createCube,renderbuffer:dn.create,framebuffer:Xn.create,framebufferCube:Xn.createCube,vao:qn.createVAO,attributes:wr,frame:Go,on:Ys,limits:Fr,hasExtension:function(Zi){return Fr.extensions.indexOf(Zi.toLowerCase())>=0},read:ea,destroy:Ia,_gl:Lt,_refresh:gs,poll:function(){ou(),yn&&yn.update()},now:la,stats:Mn});return ht.onDone(null,io),io}return cp})},69848:function(He){(function(w,x){He.exports=x()})(this,function(){"use strict";function w(pe,se,be,Te,de,Rt){if(!(de-Te<=be)){var ye=Te+de>>1;x(pe,se,ye,Te,de,Rt%2),w(pe,se,be,Te,ye-1,Rt+1),w(pe,se,be,ye+1,de,Rt+1)}}function x(pe,se,be,Te,de,Rt){for(;de>Te;){if(de-Te>600){var ye=de-Te+1,Ve=be-Te+1,oe=Math.log(ye),Re=.5*Math.exp(2*oe/3),Se=.5*Math.sqrt(oe*Re*(ye-Re)/ye)*(Ve-ye/2<0?-1:1),et=Math.max(Te,Math.floor(be-Ve*Re/ye+Se)),st=Math.min(de,Math.floor(be+(ye-Ve)*Re/ye+Se));x(pe,se,be,et,st,Rt)}var pt=se[2*be+Rt],bt=Te,ke=de;for(F(pe,se,Te,be),se[2*de+Rt]>pt&&F(pe,se,Te,de);bt<ke;){for(F(pe,se,bt,ke),bt++,ke--;se[2*bt+Rt]<pt;)bt++;for(;se[2*ke+Rt]>pt;)ke--}se[2*Te+Rt]===pt?F(pe,se,Te,ke):(ke++,F(pe,se,ke,de)),ke<=be&&(Te=ke+1),be<=ke&&(de=ke-1)}}function F(pe,se,be,Te){z(pe,be,Te),z(se,2*be,2*Te),z(se,2*be+1,2*Te+1)}function z(pe,se,be){var Te=pe[se];pe[se]=pe[be],pe[be]=Te}function h(pe,se,be,Te,de,Rt,ye){for(var Ve=[0,pe.length-1,0],oe=[],Re,Se;Ve.length;){var et=Ve.pop(),st=Ve.pop(),pt=Ve.pop();if(st-pt<=ye){for(var bt=pt;bt<=st;bt++)Re=se[2*bt],Se=se[2*bt+1],Re>=be&&Re<=de&&Se>=Te&&Se<=Rt&&oe.push(pe[bt]);continue}var ke=Math.floor((pt+st)/2);Re=se[2*ke],Se=se[2*ke+1],Re>=be&&Re<=de&&Se>=Te&&Se<=Rt&&oe.push(pe[ke]);var ur=(et+1)%2;(et===0?be<=Re:Te<=Se)&&(Ve.push(pt),Ve.push(ke-1),Ve.push(ur)),(et===0?de>=Re:Rt>=Se)&&(Ve.push(ke+1),Ve.push(st),Ve.push(ur))}return oe}function D(pe,se,be,Te,de,Rt){for(var ye=[0,pe.length-1,0],Ve=[],oe=de*de;ye.length;){var Re=ye.pop(),Se=ye.pop(),et=ye.pop();if(Se-et<=Rt){for(var st=et;st<=Se;st++)P(se[2*st],se[2*st+1],be,Te)<=oe&&Ve.push(pe[st]);continue}var pt=Math.floor((et+Se)/2),bt=se[2*pt],ke=se[2*pt+1];P(bt,ke,be,Te)<=oe&&Ve.push(pe[pt]);var ur=(Re+1)%2;(Re===0?be-de<=bt:Te-de<=ke)&&(ye.push(et),ye.push(pt-1),ye.push(ur)),(Re===0?be+de>=bt:Te+de>=ke)&&(ye.push(pt+1),ye.push(Se),ye.push(ur))}return Ve}function P(pe,se,be,Te){var de=pe-be,Rt=se-Te;return de*de+Rt*Rt}var X=function(pe){return pe[0]},W=function(pe){return pe[1]},fe=function(se,be,Te,de,Rt){be===void 0&&(be=X),Te===void 0&&(Te=W),de===void 0&&(de=64),Rt===void 0&&(Rt=Float64Array),this.nodeSize=de,this.points=se;for(var ye=se.length<65536?Uint16Array:Uint32Array,Ve=this.ids=new ye(se.length),oe=this.coords=new Rt(se.length*2),Re=0;Re<se.length;Re++)Ve[Re]=Re,oe[2*Re]=be(se[Re]),oe[2*Re+1]=Te(se[Re]);w(Ve,oe,de,0,Ve.length-1,0)};fe.prototype.range=function(se,be,Te,de){return h(this.ids,this.coords,se,be,Te,de,this.nodeSize)},fe.prototype.within=function(se,be,Te){return D(this.ids,this.coords,se,be,Te,this.nodeSize)};var J={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(pe){return pe}},Be=Math.fround||function(pe){return function(se){return pe[0]=+se,pe[0]}}(new Float32Array(1)),B=function(se){this.options=lt(Object.create(J),se),this.trees=new Array(this.options.maxZoom+1)};B.prototype.load=function(se){var be=this.options,Te=be.log,de=be.minZoom,Rt=be.maxZoom,ye=be.nodeSize;Te&&console.time("total time");var Ve="prepare "+se.length+" points";Te&&console.time(Ve),this.points=se;for(var oe=[],Re=0;Re<se.length;Re++)se[Re].geometry&&oe.push(U(se[Re],Re));this.trees[Rt+1]=new fe(oe,We,Ze,ye,Float32Array),Te&&console.timeEnd(Ve);for(var Se=Rt;Se>=de;Se--){var et=+Date.now();oe=this._cluster(oe,Se),this.trees[Se]=new fe(oe,We,Ze,ye,Float32Array),Te&&console.log("z%d: %d clusters in %dms",Se,oe.length,+Date.now()-et)}return Te&&console.timeEnd("total time"),this},B.prototype.getClusters=function(se,be){var Te=((se[0]+180)%360+360)%360-180,de=Math.max(-90,Math.min(90,se[1])),Rt=se[2]===180?180:((se[2]+180)%360+360)%360-180,ye=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)Te=-180,Rt=180;else if(Te>Rt){var Ve=this.getClusters([Te,de,180,ye],be),oe=this.getClusters([-180,de,Rt,ye],be);return Ve.concat(oe)}for(var Re=this.trees[this._limitZoom(be)],Se=Re.range(j(Te),Ce(ye),j(Rt),Ce(de)),et=[],st=0,pt=Se;st<pt.length;st+=1){var bt=pt[st],ke=Re.points[bt];et.push(ke.numPoints?q(ke):this.points[ke.index])}return et},B.prototype.getChildren=function(se){var be=this._getOriginId(se),Te=this._getOriginZoom(se),de="No cluster with the specified id.",Rt=this.trees[Te];if(!Rt)throw new Error(de);var ye=Rt.points[be];if(!ye)throw new Error(de);for(var Ve=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),oe=Rt.within(ye.x,ye.y,Ve),Re=[],Se=0,et=oe;Se<et.length;Se+=1){var st=et[Se],pt=Rt.points[st];pt.parentId===se&&Re.push(pt.numPoints?q(pt):this.points[pt.index])}if(Re.length===0)throw new Error(de);return Re},B.prototype.getLeaves=function(se,be,Te){be=be||10,Te=Te||0;var de=[];return this._appendLeaves(de,se,be,Te,0),de},B.prototype.getTile=function(se,be,Te){var de=this.trees[this._limitZoom(se)],Rt=Math.pow(2,se),ye=this.options,Ve=ye.extent,oe=ye.radius,Re=oe/Ve,Se=(Te-Re)/Rt,et=(Te+1+Re)/Rt,st={features:[]};return this._addTileFeatures(de.range((be-Re)/Rt,Se,(be+1+Re)/Rt,et),de.points,be,Te,Rt,st),be===0&&this._addTileFeatures(de.range(1-Re/Rt,Se,1,et),de.points,Rt,Te,Rt,st),be===Rt-1&&this._addTileFeatures(de.range(0,Se,Re/Rt,et),de.points,-1,Te,Rt,st),st.features.length?st:null},B.prototype.getClusterExpansionZoom=function(se){for(var be=this._getOriginZoom(se)-1;be<=this.options.maxZoom;){var Te=this.getChildren(se);if(be++,Te.length!==1)break;se=Te[0].properties.cluster_id}return be},B.prototype._appendLeaves=function(se,be,Te,de,Rt){for(var ye=this.getChildren(be),Ve=0,oe=ye;Ve<oe.length;Ve+=1){var Re=oe[Ve],Se=Re.properties;if(Se&&Se.cluster?Rt+Se.point_count<=de?Rt+=Se.point_count:Rt=this._appendLeaves(se,Se.cluster_id,Te,de,Rt):Rt<de?Rt++:se.push(Re),se.length===Te)break}return Rt},B.prototype._addTileFeatures=function(se,be,Te,de,Rt,ye){for(var Ve=0,oe=se;Ve<oe.length;Ve+=1){var Re=oe[Ve],Se=be[Re],et=Se.numPoints,st=void 0,pt=void 0,bt=void 0;if(et)st=le(Se),pt=Se.x,bt=Se.y;else{var ke=this.points[Se.index];st=ke.properties,pt=j(ke.geometry.coordinates[0]),bt=Ce(ke.geometry.coordinates[1])}var ur={type:1,geometry:[[Math.round(this.options.extent*(pt*Rt-Te)),Math.round(this.options.extent*(bt*Rt-de))]],tags:st},qt=void 0;et?qt=Se.id:this.options.generateId?qt=Se.index:this.points[Se.index].id&&(qt=this.points[Se.index].id),qt!==void 0&&(ur.id=qt),ye.features.push(ur)}},B.prototype._limitZoom=function(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))},B.prototype._cluster=function(se,be){for(var Te=[],de=this.options,Rt=de.radius,ye=de.extent,Ve=de.reduce,oe=de.minPoints,Re=Rt/(ye*Math.pow(2,be)),Se=0;Se<se.length;Se++){var et=se[Se];if(!(et.zoom<=be)){et.zoom=be;for(var st=this.trees[be+1],pt=st.within(et.x,et.y,Re),bt=et.numPoints||1,ke=bt,ur=0,qt=pt;ur<qt.length;ur+=1){var _n=qt[ur],Zr=st.points[_n];Zr.zoom>be&&(ke+=Zr.numPoints||1)}if(ke>bt&&ke>=oe){for(var Vr=et.x*bt,rn=et.y*bt,Qr=Ve&&bt>1?this._map(et,!0):null,ln=(Se<<5)+(be+1)+this.points.length,vn=0,$t=pt;vn<$t.length;vn+=1){var _r=$t[vn],kt=st.points[_r];if(!(kt.zoom<=be)){kt.zoom=be;var qe=kt.numPoints||1;Vr+=kt.x*qe,rn+=kt.y*qe,kt.parentId=ln,Ve&&(Qr||(Qr=this._map(et,!0)),Ve(Qr,this._map(kt)))}}et.parentId=ln,Te.push(ee(Vr/ke,rn/ke,ln,ke,Qr))}else if(Te.push(et),ke>1)for(var Sr=0,Pe=pt;Sr<Pe.length;Sr+=1){var Hr=Pe[Sr],vr=st.points[Hr];vr.zoom<=be||(vr.zoom=be,Te.push(vr))}}}return Te},B.prototype._getOriginId=function(se){return se-this.points.length>>5},B.prototype._getOriginZoom=function(se){return(se-this.points.length)%32},B.prototype._map=function(se,be){if(se.numPoints)return be?lt({},se.properties):se.properties;var Te=this.points[se.index].properties,de=this.options.map(Te);return be&&de===Te?lt({},de):de};function ee(pe,se,be,Te,de){return{x:Be(pe),y:Be(se),zoom:1/0,id:be,parentId:-1,numPoints:Te,properties:de}}function U(pe,se){var be=pe.geometry.coordinates,Te=be[0],de=be[1];return{x:Be(j(Te)),y:Be(Ce(de)),zoom:1/0,index:se,parentId:-1}}function q(pe){return{type:"Feature",id:pe.id,properties:le(pe),geometry:{type:"Point",coordinates:[$e(pe.x),Fe(pe.y)]}}}function le(pe){var se=pe.numPoints,be=se>=1e4?Math.round(se/1e3)+"k":se>=1e3?Math.round(se/100)/10+"k":se;return lt(lt({},pe.properties),{cluster:!0,cluster_id:pe.id,point_count:se,point_count_abbreviated:be})}function j(pe){return pe/360+.5}function Ce(pe){var se=Math.sin(pe*Math.PI/180),be=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return be<0?0:be>1?1:be}function $e(pe){return(pe-.5)*360}function Fe(pe){var se=(180-pe*360)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function lt(pe,se){for(var be in se)pe[be]=se[be];return pe}function We(pe){return pe.x}function Ze(pe){return pe.y}return B})},73897:function(He){function w(x,F){(F==null||F>x.length)&&(F=x.length);for(var z=0,h=new Array(F);z<F;z++)h[z]=x[z];return h}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},85372:function(He){function w(x){if(Array.isArray(x))return x}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},63405:function(He,w,x){var F=x(73897);function z(h){if(Array.isArray(h))return F(h)}He.exports=z,He.exports.__esModule=!0,He.exports.default=He.exports},66115:function(He){function w(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},76976:function(He,w,x){var F=x(73808),z=x(69617),h=x(94993);function D(P,X,W){return X=F(X),h(P,z()?Reflect.construct(X,W||[],F(P).constructor):X.apply(P,W))}He.exports=D,He.exports.__esModule=!0,He.exports.default=He.exports},56690:function(He){function w(x,F){if(!(x instanceof F))throw new TypeError("Cannot call a class as a function")}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},89728:function(He,w,x){var F=x(64062);function z(D,P){for(var X=0;X<P.length;X++){var W=P[X];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(D,F(W.key),W)}}function h(D,P,X){return P&&z(D.prototype,P),X&&z(D,X),Object.defineProperty(D,"prototype",{writable:!1}),D}He.exports=h,He.exports.__esModule=!0,He.exports.default=He.exports},73808:function(He){function w(x){return He.exports=w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(z){return z.__proto__||Object.getPrototypeOf(z)},He.exports.__esModule=!0,He.exports.default=He.exports,w(x)}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},61655:function(He,w,x){var F=x(6015);function z(h,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(D&&D.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),Object.defineProperty(h,"prototype",{writable:!1}),D&&F(h,D)}He.exports=z,He.exports.__esModule=!0,He.exports.default=He.exports},75263:function(He,w,x){var F=x(18698).default;function z(D){if(typeof WeakMap!="function")return null;var P=new WeakMap,X=new WeakMap;return(z=function(fe){return fe?X:P})(D)}function h(D,P){if(!P&&D&&D.__esModule)return D;if(D===null||F(D)!="object"&&typeof D!="function")return{default:D};var X=z(P);if(X&&X.has(D))return X.get(D);var W={__proto__:null},fe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var J in D)if(J!=="default"&&Object.prototype.hasOwnProperty.call(D,J)){var Be=fe?Object.getOwnPropertyDescriptor(D,J):null;Be&&(Be.get||Be.set)?Object.defineProperty(W,J,Be):W[J]=D[J]}return W.default=D,X&&X.set(D,W),W}He.exports=h,He.exports.__esModule=!0,He.exports.default=He.exports},69617:function(He){function w(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(F){}return(He.exports=w=function(){return!!x},He.exports.__esModule=!0,He.exports.default=He.exports)()}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},79498:function(He){function w(x){if(typeof Symbol!="undefined"&&x[Symbol.iterator]!=null||x["@@iterator"]!=null)return Array.from(x)}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},68872:function(He){function w(x,F){var z=x==null?null:typeof Symbol!="undefined"&&x[Symbol.iterator]||x["@@iterator"];if(z!=null){var h,D,P,X,W=[],fe=!0,J=!1;try{if(P=(z=z.call(x)).next,F===0){if(Object(z)!==z)return;fe=!1}else for(;!(fe=(h=P.call(z)).done)&&(W.push(h.value),W.length!==F);fe=!0);}catch(Be){J=!0,D=Be}finally{try{if(!fe&&z.return!=null&&(X=z.return(),Object(X)!==X))return}finally{if(J)throw D}}return W}}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},12218:function(He){function w(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},42281:function(He){function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},94993:function(He,w,x){var F=x(18698).default,z=x(66115);function h(D,P){if(P&&(F(P)==="object"||typeof P=="function"))return P;if(P!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z(D)}He.exports=h,He.exports.__esModule=!0,He.exports.default=He.exports},17061:function(He,w,x){var F=x(18698).default;function z(){"use strict";He.exports=z=function(){return D},He.exports.__esModule=!0,He.exports.default=He.exports;var h,D={},P=Object.prototype,X=P.hasOwnProperty,W=Object.defineProperty||function(st,pt,bt){st[pt]=bt.value},fe=typeof Symbol=="function"?Symbol:{},J=fe.iterator||"@@iterator",Be=fe.asyncIterator||"@@asyncIterator",B=fe.toStringTag||"@@toStringTag";function ee(st,pt,bt){return Object.defineProperty(st,pt,{value:bt,enumerable:!0,configurable:!0,writable:!0}),st[pt]}try{ee({},"")}catch(st){ee=function(bt,ke,ur){return bt[ke]=ur}}function U(st,pt,bt,ke){var ur=pt&&pt.prototype instanceof lt?pt:lt,qt=Object.create(ur.prototype),_n=new Se(ke||[]);return W(qt,"_invoke",{value:ye(st,bt,_n)}),qt}function q(st,pt,bt){try{return{type:"normal",arg:st.call(pt,bt)}}catch(ke){return{type:"throw",arg:ke}}}D.wrap=U;var le="suspendedStart",j="suspendedYield",Ce="executing",$e="completed",Fe={};function lt(){}function We(){}function Ze(){}var pe={};ee(pe,J,function(){return this});var se=Object.getPrototypeOf,be=se&&se(se(et([])));be&&be!==P&&X.call(be,J)&&(pe=be);var Te=Ze.prototype=lt.prototype=Object.create(pe);function de(st){["next","throw","return"].forEach(function(pt){ee(st,pt,function(bt){return this._invoke(pt,bt)})})}function Rt(st,pt){function bt(ur,qt,_n,Zr){var Vr=q(st[ur],st,qt);if(Vr.type!=="throw"){var rn=Vr.arg,Qr=rn.value;return Qr&&F(Qr)=="object"&&X.call(Qr,"__await")?pt.resolve(Qr.__await).then(function(ln){bt("next",ln,_n,Zr)},function(ln){bt("throw",ln,_n,Zr)}):pt.resolve(Qr).then(function(ln){rn.value=ln,_n(rn)},function(ln){return bt("throw",ln,_n,Zr)})}Zr(Vr.arg)}var ke;W(this,"_invoke",{value:function(qt,_n){function Zr(){return new pt(function(Vr,rn){bt(qt,_n,Vr,rn)})}return ke=ke?ke.then(Zr,Zr):Zr()}})}function ye(st,pt,bt){var ke=le;return function(ur,qt){if(ke===Ce)throw new Error("Generator is already running");if(ke===$e){if(ur==="throw")throw qt;return{value:h,done:!0}}for(bt.method=ur,bt.arg=qt;;){var _n=bt.delegate;if(_n){var Zr=Ve(_n,bt);if(Zr){if(Zr===Fe)continue;return Zr}}if(bt.method==="next")bt.sent=bt._sent=bt.arg;else if(bt.method==="throw"){if(ke===le)throw ke=$e,bt.arg;bt.dispatchException(bt.arg)}else bt.method==="return"&&bt.abrupt("return",bt.arg);ke=Ce;var Vr=q(st,pt,bt);if(Vr.type==="normal"){if(ke=bt.done?$e:j,Vr.arg===Fe)continue;return{value:Vr.arg,done:bt.done}}Vr.type==="throw"&&(ke=$e,bt.method="throw",bt.arg=Vr.arg)}}}function Ve(st,pt){var bt=pt.method,ke=st.iterator[bt];if(ke===h)return pt.delegate=null,bt==="throw"&&st.iterator.return&&(pt.method="return",pt.arg=h,Ve(st,pt),pt.method==="throw")||bt!=="return"&&(pt.method="throw",pt.arg=new TypeError("The iterator does not provide a '"+bt+"' method")),Fe;var ur=q(ke,st.iterator,pt.arg);if(ur.type==="throw")return pt.method="throw",pt.arg=ur.arg,pt.delegate=null,Fe;var qt=ur.arg;return qt?qt.done?(pt[st.resultName]=qt.value,pt.next=st.nextLoc,pt.method!=="return"&&(pt.method="next",pt.arg=h),pt.delegate=null,Fe):qt:(pt.method="throw",pt.arg=new TypeError("iterator result is not an object"),pt.delegate=null,Fe)}function oe(st){var pt={tryLoc:st[0]};1 in st&&(pt.catchLoc=st[1]),2 in st&&(pt.finallyLoc=st[2],pt.afterLoc=st[3]),this.tryEntries.push(pt)}function Re(st){var pt=st.completion||{};pt.type="normal",delete pt.arg,st.completion=pt}function Se(st){this.tryEntries=[{tryLoc:"root"}],st.forEach(oe,this),this.reset(!0)}function et(st){if(st||st===""){var pt=st[J];if(pt)return pt.call(st);if(typeof st.next=="function")return st;if(!isNaN(st.length)){var bt=-1,ke=function ur(){for(;++bt<st.length;)if(X.call(st,bt))return ur.value=st[bt],ur.done=!1,ur;return ur.value=h,ur.done=!0,ur};return ke.next=ke}}throw new TypeError(F(st)+" is not iterable")}return We.prototype=Ze,W(Te,"constructor",{value:Ze,configurable:!0}),W(Ze,"constructor",{value:We,configurable:!0}),We.displayName=ee(Ze,B,"GeneratorFunction"),D.isGeneratorFunction=function(st){var pt=typeof st=="function"&&st.constructor;return!!pt&&(pt===We||(pt.displayName||pt.name)==="GeneratorFunction")},D.mark=function(st){return Object.setPrototypeOf?Object.setPrototypeOf(st,Ze):(st.__proto__=Ze,ee(st,B,"GeneratorFunction")),st.prototype=Object.create(Te),st},D.awrap=function(st){return{__await:st}},de(Rt.prototype),ee(Rt.prototype,Be,function(){return this}),D.AsyncIterator=Rt,D.async=function(st,pt,bt,ke,ur){ur===void 0&&(ur=Promise);var qt=new Rt(U(st,pt,bt,ke),ur);return D.isGeneratorFunction(pt)?qt:qt.next().then(function(_n){return _n.done?_n.value:qt.next()})},de(Te),ee(Te,B,"Generator"),ee(Te,J,function(){return this}),ee(Te,"toString",function(){return"[object Generator]"}),D.keys=function(st){var pt=Object(st),bt=[];for(var ke in pt)bt.push(ke);return bt.reverse(),function ur(){for(;bt.length;){var qt=bt.pop();if(qt in pt)return ur.value=qt,ur.done=!1,ur}return ur.done=!0,ur}},D.values=et,Se.prototype={constructor:Se,reset:function(pt){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(Re),!pt)for(var bt in this)bt.charAt(0)==="t"&&X.call(this,bt)&&!isNaN(+bt.slice(1))&&(this[bt]=h)},stop:function(){this.done=!0;var pt=this.tryEntries[0].completion;if(pt.type==="throw")throw pt.arg;return this.rval},dispatchException:function(pt){if(this.done)throw pt;var bt=this;function ke(rn,Qr){return _n.type="throw",_n.arg=pt,bt.next=rn,Qr&&(bt.method="next",bt.arg=h),!!Qr}for(var ur=this.tryEntries.length-1;ur>=0;--ur){var qt=this.tryEntries[ur],_n=qt.completion;if(qt.tryLoc==="root")return ke("end");if(qt.tryLoc<=this.prev){var Zr=X.call(qt,"catchLoc"),Vr=X.call(qt,"finallyLoc");if(Zr&&Vr){if(this.prev<qt.catchLoc)return ke(qt.catchLoc,!0);if(this.prev<qt.finallyLoc)return ke(qt.finallyLoc)}else if(Zr){if(this.prev<qt.catchLoc)return ke(qt.catchLoc,!0)}else{if(!Vr)throw new Error("try statement without catch or finally");if(this.prev<qt.finallyLoc)return ke(qt.finallyLoc)}}}},abrupt:function(pt,bt){for(var ke=this.tryEntries.length-1;ke>=0;--ke){var ur=this.tryEntries[ke];if(ur.tryLoc<=this.prev&&X.call(ur,"finallyLoc")&&this.prev<ur.finallyLoc){var qt=ur;break}}qt&&(pt==="break"||pt==="continue")&&qt.tryLoc<=bt&&bt<=qt.finallyLoc&&(qt=null);var _n=qt?qt.completion:{};return _n.type=pt,_n.arg=bt,qt?(this.method="next",this.next=qt.finallyLoc,Fe):this.complete(_n)},complete:function(pt,bt){if(pt.type==="throw")throw pt.arg;return pt.type==="break"||pt.type==="continue"?this.next=pt.arg:pt.type==="return"?(this.rval=this.arg=pt.arg,this.method="return",this.next="end"):pt.type==="normal"&&bt&&(this.next=bt),Fe},finish:function(pt){for(var bt=this.tryEntries.length-1;bt>=0;--bt){var ke=this.tryEntries[bt];if(ke.finallyLoc===pt)return this.complete(ke.completion,ke.afterLoc),Re(ke),Fe}},catch:function(pt){for(var bt=this.tryEntries.length-1;bt>=0;--bt){var ke=this.tryEntries[bt];if(ke.tryLoc===pt){var ur=ke.completion;if(ur.type==="throw"){var qt=ur.arg;Re(ke)}return qt}}throw new Error("illegal catch attempt")},delegateYield:function(pt,bt,ke){return this.delegate={iterator:et(pt),resultName:bt,nextLoc:ke},this.method==="next"&&(this.arg=h),Fe}},D}He.exports=z,He.exports.__esModule=!0,He.exports.default=He.exports},6015:function(He){function w(x,F){return He.exports=w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,D){return h.__proto__=D,h},He.exports.__esModule=!0,He.exports.default=He.exports,w(x,F)}He.exports=w,He.exports.__esModule=!0,He.exports.default=He.exports},27424:function(He,w,x){var F=x(85372),z=x(68872),h=x(86116),D=x(12218);function P(X,W){return F(X)||z(X,W)||h(X,W)||D()}He.exports=P,He.exports.__esModule=!0,He.exports.default=He.exports},51589:function(He,w,x){var F=x(85372),z=x(79498),h=x(86116),D=x(12218);function P(X){return F(X)||z(X)||h(X)||D()}He.exports=P,He.exports.__esModule=!0,He.exports.default=He.exports},861:function(He,w,x){var F=x(63405),z=x(79498),h=x(86116),D=x(42281);function P(X){return F(X)||z(X)||h(X)||D()}He.exports=P,He.exports.__esModule=!0,He.exports.default=He.exports},86116:function(He,w,x){var F=x(73897);function z(h,D){if(h){if(typeof h=="string")return F(h,D);var P=Object.prototype.toString.call(h).slice(8,-1);if(P==="Object"&&h.constructor&&(P=h.constructor.name),P==="Map"||P==="Set")return Array.from(h);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return F(h,D)}}He.exports=z,He.exports.__esModule=!0,He.exports.default=He.exports},64687:function(He,w,x){var F=x(17061)();He.exports=F;try{regeneratorRuntime=F}catch(z){typeof globalThis=="object"?globalThis.regeneratorRuntime=F:Function("r","regeneratorRuntime = r")(F)}},73237:function(He,w,x){"use strict";x.d(w,{Z:function(){return h}});var F=x(61120);function z(D,P){for(;!Object.prototype.hasOwnProperty.call(D,P)&&(D=(0,F.Z)(D),D!==null););return D}function h(){return typeof Reflect!="undefined"&&Reflect.get?h=Reflect.get.bind():h=function(P,X,W){var fe=z(P,X);if(fe){var J=Object.getOwnPropertyDescriptor(fe,X);return J.get?J.get.call(arguments.length<3?P:W):J.value}},h.apply(this,arguments)}},1449:function(He,w,x){"use strict";x.d(w,{Tu:function(){return B},tw:function(){return j},uf:function(){return U},yu:function(){return J},zL:function(){return P}});var F=63710088e-1,z={centimeters:F*100,centimetres:F*100,degrees:F/111325,feet:F*3.28084,inches:F*39.37,kilometers:F/1e3,kilometres:F/1e3,meters:F,metres:F,miles:F/1609.344,millimeters:F*1e3,millimetres:F*1e3,nauticalmiles:F/1852,radians:1,yards:F*1.0936},h={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/F,yards:1.0936133},D={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function P(oe,Re,Se){Se===void 0&&(Se={});var et={type:"Feature"};return(Se.id===0||Se.id)&&(et.id=Se.id),Se.bbox&&(et.bbox=Se.bbox),et.properties=Re||{},et.geometry=oe,et}function X(oe,Re,Se){switch(Se===void 0&&(Se={}),oe){case"Point":return W(Re).geometry;case"LineString":return B(Re).geometry;case"Polygon":return J(Re).geometry;case"MultiPoint":return le(Re).geometry;case"MultiLineString":return q(Re).geometry;case"MultiPolygon":return j(Re).geometry;default:throw new Error(oe+" is invalid")}}function W(oe,Re,Se){if(Se===void 0&&(Se={}),!oe)throw new Error("coordinates is required");if(!Array.isArray(oe))throw new Error("coordinates must be an Array");if(oe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!de(oe[0])||!de(oe[1]))throw new Error("coordinates must contain numbers");var et={type:"Point",coordinates:oe};return P(et,Re,Se)}function fe(oe,Re,Se){return Se===void 0&&(Se={}),U(oe.map(function(et){return W(et,Re)}),Se)}function J(oe,Re,Se){Se===void 0&&(Se={});for(var et=0,st=oe;et<st.length;et++){var pt=st[et];if(pt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var bt=0;bt<pt[pt.length-1].length;bt++)if(pt[pt.length-1][bt]!==pt[0][bt])throw new Error("First and last Position are not equivalent.")}var ke={type:"Polygon",coordinates:oe};return P(ke,Re,Se)}function Be(oe,Re,Se){return Se===void 0&&(Se={}),U(oe.map(function(et){return J(et,Re)}),Se)}function B(oe,Re,Se){if(Se===void 0&&(Se={}),oe.length<2)throw new Error("coordinates must be an array of two or more positions");var et={type:"LineString",coordinates:oe};return P(et,Re,Se)}function ee(oe,Re,Se){return Se===void 0&&(Se={}),U(oe.map(function(et){return B(et,Re)}),Se)}function U(oe,Re){Re===void 0&&(Re={});var Se={type:"FeatureCollection"};return Re.id&&(Se.id=Re.id),Re.bbox&&(Se.bbox=Re.bbox),Se.features=oe,Se}function q(oe,Re,Se){Se===void 0&&(Se={});var et={type:"MultiLineString",coordinates:oe};return P(et,Re,Se)}function le(oe,Re,Se){Se===void 0&&(Se={});var et={type:"MultiPoint",coordinates:oe};return P(et,Re,Se)}function j(oe,Re,Se){Se===void 0&&(Se={});var et={type:"MultiPolygon",coordinates:oe};return P(et,Re,Se)}function Ce(oe,Re,Se){Se===void 0&&(Se={});var et={type:"GeometryCollection",geometries:oe};return P(et,Re,Se)}function $e(oe,Re){if(Re===void 0&&(Re=0),Re&&!(Re>=0))throw new Error("precision must be a positive number");var Se=Math.pow(10,Re||0);return Math.round(oe*Se)/Se}function Fe(oe,Re){Re===void 0&&(Re="kilometers");var Se=z[Re];if(!Se)throw new Error(Re+" units is invalid");return oe*Se}function lt(oe,Re){Re===void 0&&(Re="kilometers");var Se=z[Re];if(!Se)throw new Error(Re+" units is invalid");return oe/Se}function We(oe,Re){return pe(lt(oe,Re))}function Ze(oe){var Re=oe%360;return Re<0&&(Re+=360),Re}function pe(oe){var Re=oe%(2*Math.PI);return Re*180/Math.PI}function se(oe){var Re=oe%360;return Re*Math.PI/180}function be(oe,Re,Se){if(Re===void 0&&(Re="kilometers"),Se===void 0&&(Se="kilometers"),!(oe>=0))throw new Error("length must be a positive number");return Fe(lt(oe,Re),Se)}function Te(oe,Re,Se){if(Re===void 0&&(Re="meters"),Se===void 0&&(Se="kilometers"),!(oe>=0))throw new Error("area must be a positive number");var et=D[Re];if(!et)throw new Error("invalid original units");var st=D[Se];if(!st)throw new Error("invalid final units");return oe/et*st}function de(oe){return!isNaN(oe)&&oe!==null&&!Array.isArray(oe)}function Rt(oe){return!!oe&&oe.constructor===Object}function ye(oe){if(!oe)throw new Error("bbox is required");if(!Array.isArray(oe))throw new Error("bbox must be an Array");if(oe.length!==4&&oe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");oe.forEach(function(Re){if(!de(Re))throw new Error("bbox must only contain numbers")})}function Ve(oe){if(!oe)throw new Error("id is required");if(["string","number"].indexOf(typeof oe)===-1)throw new Error("id must be a number or a string")}},39034:function(He,w,x){"use strict";x.d(w,{nG:function(){return B},pZ:function(){return z}});var F=x(1449);function z(Fe,lt,We){if(Fe!==null)for(var Ze,pe,se,be,Te,de,Rt,ye=0,Ve=0,oe,Re=Fe.type,Se=Re==="FeatureCollection",et=Re==="Feature",st=Se?Fe.features.length:1,pt=0;pt<st;pt++){Rt=Se?Fe.features[pt].geometry:et?Fe.geometry:Fe,oe=Rt?Rt.type==="GeometryCollection":!1,Te=oe?Rt.geometries.length:1;for(var bt=0;bt<Te;bt++){var ke=0,ur=0;if(be=oe?Rt.geometries[bt]:Rt,be!==null){de=be.coordinates;var qt=be.type;switch(ye=We&&(qt==="Polygon"||qt==="MultiPolygon")?1:0,qt){case null:break;case"Point":if(lt(de,Ve,pt,ke,ur)===!1)return!1;Ve++,ke++;break;case"LineString":case"MultiPoint":for(Ze=0;Ze<de.length;Ze++){if(lt(de[Ze],Ve,pt,ke,ur)===!1)return!1;Ve++,qt==="MultiPoint"&&ke++}qt==="LineString"&&ke++;break;case"Polygon":case"MultiLineString":for(Ze=0;Ze<de.length;Ze++){for(pe=0;pe<de[Ze].length-ye;pe++){if(lt(de[Ze][pe],Ve,pt,ke,ur)===!1)return!1;Ve++}qt==="MultiLineString"&&ke++,qt==="Polygon"&&ur++}qt==="Polygon"&&ke++;break;case"MultiPolygon":for(Ze=0;Ze<de.length;Ze++){for(ur=0,pe=0;pe<de[Ze].length;pe++){for(se=0;se<de[Ze][pe].length-ye;se++){if(lt(de[Ze][pe][se],Ve,pt,ke,ur)===!1)return!1;Ve++}ur++}ke++}break;case"GeometryCollection":for(Ze=0;Ze<be.geometries.length;Ze++)if(z(be.geometries[Ze],lt,We)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function h(Fe,lt,We,Ze){var pe=We;return z(Fe,function(se,be,Te,de,Rt){be===0&&We===void 0?pe=se:pe=lt(pe,se,be,Te,de,Rt)},Ze),pe}function D(Fe,lt){var We;switch(Fe.type){case"FeatureCollection":for(We=0;We<Fe.features.length&&lt(Fe.features[We].properties,We)!==!1;We++);break;case"Feature":lt(Fe.properties,0);break}}function P(Fe,lt,We){var Ze=We;return D(Fe,function(pe,se){se===0&&We===void 0?Ze=pe:Ze=lt(Ze,pe,se)}),Ze}function X(Fe,lt){if(Fe.type==="Feature")lt(Fe,0);else if(Fe.type==="FeatureCollection")for(var We=0;We<Fe.features.length&&lt(Fe.features[We],We)!==!1;We++);}function W(Fe,lt,We){var Ze=We;return X(Fe,function(pe,se){se===0&&We===void 0?Ze=pe:Ze=lt(Ze,pe,se)}),Ze}function fe(Fe){var lt=[];return z(Fe,function(We){lt.push(We)}),lt}function J(Fe,lt){var We,Ze,pe,se,be,Te,de,Rt,ye,Ve,oe=0,Re=Fe.type==="FeatureCollection",Se=Fe.type==="Feature",et=Re?Fe.features.length:1;for(We=0;We<et;We++){for(Te=Re?Fe.features[We].geometry:Se?Fe.geometry:Fe,Rt=Re?Fe.features[We].properties:Se?Fe.properties:{},ye=Re?Fe.features[We].bbox:Se?Fe.bbox:void 0,Ve=Re?Fe.features[We].id:Se?Fe.id:void 0,de=Te?Te.type==="GeometryCollection":!1,be=de?Te.geometries.length:1,pe=0;pe<be;pe++){if(se=de?Te.geometries[pe]:Te,se===null){if(lt(null,oe,Rt,ye,Ve)===!1)return!1;continue}switch(se.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(lt(se,oe,Rt,ye,Ve)===!1)return!1;break}case"GeometryCollection":{for(Ze=0;Ze<se.geometries.length;Ze++)if(lt(se.geometries[Ze],oe,Rt,ye,Ve)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}oe++}}function Be(Fe,lt,We){var Ze=We;return J(Fe,function(pe,se,be,Te,de){se===0&&We===void 0?Ze=pe:Ze=lt(Ze,pe,se,be,Te,de)}),Ze}function B(Fe,lt){J(Fe,function(We,Ze,pe,se,be){var Te=We===null?null:We.type;switch(Te){case null:case"Point":case"LineString":case"Polygon":return lt((0,F.zL)(We,pe,{bbox:se,id:be}),Ze,0)===!1?!1:void 0}var de;switch(Te){case"MultiPoint":de="Point";break;case"MultiLineString":de="LineString";break;case"MultiPolygon":de="Polygon";break}for(var Rt=0;Rt<We.coordinates.length;Rt++){var ye=We.coordinates[Rt],Ve={type:de,coordinates:ye};if(lt((0,F.zL)(Ve,pe),Ze,Rt)===!1)return!1}})}function ee(Fe,lt,We){var Ze=We;return B(Fe,function(pe,se,be){se===0&&be===0&&We===void 0?Ze=pe:Ze=lt(Ze,pe,se,be)}),Ze}function U(Fe,lt){B(Fe,function(We,Ze,pe){var se=0;if(We.geometry){var be=We.geometry.type;if(!(be==="Point"||be==="MultiPoint")){var Te,de=0,Rt=0,ye=0;if(z(We,function(Ve,oe,Re,Se,et){if(Te===void 0||Ze>de||Se>Rt||et>ye){Te=Ve,de=Ze,Rt=Se,ye=et,se=0;return}var st=lineString([Te,Ve],We.properties);if(lt(st,Ze,pe,et,se)===!1)return!1;se++,Te=Ve})===!1)return!1}}})}function q(Fe,lt,We){var Ze=We,pe=!1;return U(Fe,function(se,be,Te,de,Rt){pe===!1&&We===void 0?Ze=se:Ze=lt(Ze,se,be,Te,de,Rt),pe=!0}),Ze}function le(Fe,lt){if(!Fe)throw new Error("geojson is required");B(Fe,function(We,Ze,pe){if(We.geometry!==null){var se=We.geometry.type,be=We.geometry.coordinates;switch(se){case"LineString":if(lt(We,Ze,pe,0,0)===!1)return!1;break;case"Polygon":for(var Te=0;Te<be.length;Te++)if(lt(lineString(be[Te],We.properties),Ze,pe,Te)===!1)return!1;break}}})}function j(Fe,lt,We){var Ze=We;return le(Fe,function(pe,se,be,Te){se===0&&We===void 0?Ze=pe:Ze=lt(Ze,pe,se,be,Te)}),Ze}function Ce(Fe,lt){if(lt=lt||{},!isObject(lt))throw new Error("options is invalid");var We=lt.featureIndex||0,Ze=lt.multiFeatureIndex||0,pe=lt.geometryIndex||0,se=lt.segmentIndex||0,be=lt.properties,Te;switch(Fe.type){case"FeatureCollection":We<0&&(We=Fe.features.length+We),be=be||Fe.features[We].properties,Te=Fe.features[We].geometry;break;case"Feature":be=be||Fe.properties,Te=Fe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Te=Fe;break;default:throw new Error("geojson is invalid")}if(Te===null)return null;var de=Te.coordinates;switch(Te.type){case"Point":case"MultiPoint":return null;case"LineString":return se<0&&(se=de.length+se-1),lineString([de[se],de[se+1]],be,lt);case"Polygon":return pe<0&&(pe=de.length+pe),se<0&&(se=de[pe].length+se-1),lineString([de[pe][se],de[pe][se+1]],be,lt);case"MultiLineString":return Ze<0&&(Ze=de.length+Ze),se<0&&(se=de[Ze].length+se-1),lineString([de[Ze][se],de[Ze][se+1]],be,lt);case"MultiPolygon":return Ze<0&&(Ze=de.length+Ze),pe<0&&(pe=de[Ze].length+pe),se<0&&(se=de[Ze][pe].length-se-1),lineString([de[Ze][pe][se],de[Ze][pe][se+1]],be,lt)}throw new Error("geojson is invalid")}function $e(Fe,lt){if(lt=lt||{},!isObject(lt))throw new Error("options is invalid");var We=lt.featureIndex||0,Ze=lt.multiFeatureIndex||0,pe=lt.geometryIndex||0,se=lt.coordIndex||0,be=lt.properties,Te;switch(Fe.type){case"FeatureCollection":We<0&&(We=Fe.features.length+We),be=be||Fe.features[We].properties,Te=Fe.features[We].geometry;break;case"Feature":be=be||Fe.properties,Te=Fe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Te=Fe;break;default:throw new Error("geojson is invalid")}if(Te===null)return null;var de=Te.coordinates;switch(Te.type){case"Point":return point(de,be,lt);case"MultiPoint":return Ze<0&&(Ze=de.length+Ze),point(de[Ze],be,lt);case"LineString":return se<0&&(se=de.length+se),point(de[se],be,lt);case"Polygon":return pe<0&&(pe=de.length+pe),se<0&&(se=de[pe].length+se),point(de[pe][se],be,lt);case"MultiLineString":return Ze<0&&(Ze=de.length+Ze),se<0&&(se=de[Ze].length+se),point(de[Ze][se],be,lt);case"MultiPolygon":return Ze<0&&(Ze=de.length+Ze),pe<0&&(pe=de[Ze].length+pe),se<0&&(se=de[Ze][pe].length-se),point(de[Ze][pe][se],be,lt)}throw new Error("geojson is invalid")}}}]);
}());