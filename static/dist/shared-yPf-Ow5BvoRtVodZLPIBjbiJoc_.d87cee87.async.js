!(function(){var $X=Object.defineProperty,YX=Object.defineProperties;var XX=Object.getOwnPropertyDescriptors;var jO=Object.getOwnPropertySymbols;var mF=Object.prototype.hasOwnProperty,yF=Object.prototype.propertyIsEnumerable;var p7=($t,Qt)=>(Qt=Symbol[$t])?Qt:Symbol.for("Symbol."+$t),qX=$t=>{throw TypeError($t)},Ai=Math.pow,vF=($t,Qt,L)=>Qt in $t?$X($t,Qt,{enumerable:!0,configurable:!0,writable:!0,value:L}):$t[Qt]=L,To=($t,Qt)=>{for(var L in Qt||(Qt={}))mF.call(Qt,L)&&vF($t,L,Qt[L]);if(jO)for(var L of jO(Qt))yF.call(Qt,L)&&vF($t,L,Qt[L]);return $t},fc=($t,Qt)=>YX($t,XX(Qt));var g7=($t,Qt)=>{var L={};for(var Y in $t)mF.call($t,Y)&&Qt.indexOf(Y)<0&&(L[Y]=$t[Y]);if($t!=null&&jO)for(var Y of jO($t))Qt.indexOf(Y)<0&&yF.call($t,Y)&&(L[Y]=$t[Y]);return L};var KX=function($t,Qt){this[0]=$t,this[1]=Qt};var _F=$t=>{var Qt=$t[p7("asyncIterator")],L=!1,Y,Z={};return Qt==null?(Qt=$t[p7("iterator")](),Y=tt=>Z[tt]=yt=>Qt[tt](yt)):(Qt=Qt.call($t),Y=tt=>Z[tt]=yt=>{if(L){if(L=!1,tt==="throw")throw yt;return yt}return L=!0,{done:!1,value:new KX(new Promise(G=>{var Ot=Qt[tt](yt);Ot instanceof Object||qX("Object expected"),G(Ot)}),1)}}),Z[p7("iterator")]=()=>Z,Y("next"),"throw"in Qt?Y("throw"):Z.throw=tt=>{throw tt},"return"in Qt&&Y("return"),Z};(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[772],{79611:function($t,Qt,L){"use strict";var Y=L(46309),Z=(0,Y.i)("Bar");Qt.Z=Z},78677:function($t,Qt,L){"use strict";var Y=L(46309),Z=(0,Y.i)("Column");Qt.Z=Z},80652:function($t,Qt,L){"use strict";var Y=L(46309),Z=(0,Y.i)("Line");Qt.Z=Z},63430:function($t,Qt,L){"use strict";var Y=L(46309),Z=(0,Y.i)("Pie");Qt.Z=Z},46309:function($t,Qt,L){"use strict";L.d(Qt,{i:function(){return WX}});var Y={};L.r(Y),L.d(Y,{area:function(){return wI},bottom:function(){return Ba},bottomLeft:function(){return Ba},bottomRight:function(){return Ba},inside:function(){return Ba},left:function(){return Ba},outside:function(){return tp},right:function(){return Ba},spider:function(){return AI},surround:function(){return mM},top:function(){return Ba},topLeft:function(){return Ba},topRight:function(){return Ba}});var Z={};L.r(Z),L.d(Z,{interpolateBlues:function(){return l5},interpolateBrBG:function(){return BI},interpolateBuGn:function(){return Ff},interpolateBuPu:function(){return y2},interpolateCividis:function(){return h5},interpolateCool:function(){return Xv},interpolateCubehelixDefault:function(){return WI},interpolateGnBu:function(){return i5},interpolateGreens:function(){return u5},interpolateGreys:function(){return f5},interpolateInferno:function(){return n3},interpolateMagma:function(){return k5},interpolateOrRd:function(){return Dr},interpolateOranges:function(){return N2},interpolatePRGn:function(){return jI},interpolatePiYG:function(){return zI},interpolatePlasma:function(){return D5},interpolatePuBu:function(){return o5},interpolatePuBuGn:function(){return Bf},interpolatePuOr:function(){return UI},interpolatePuRd:function(){return a5},interpolatePurples:function(){return R2},interpolateRainbow:function(){return M5},interpolateRdBu:function(){return v2},interpolateRdGy:function(){return jv},interpolateRdPu:function(){return s5},interpolateRdYlBu:function(){return ZI},interpolateRdYlGn:function(){return Nf},interpolateReds:function(){return d5},interpolateSinebow:function(){return L5},interpolateSpectral:function(){return zv},interpolateTurbo:function(){return I5},interpolateViridis:function(){return R5},interpolateWarm:function(){return e3},interpolateYlGn:function(){return c5},interpolateYlGnBu:function(){return w2},interpolateYlOrBr:function(){return A2},interpolateYlOrRd:function(){return M2},schemeAccent:function(){return jc},schemeBlues:function(){return C2},schemeBrBG:function(){return g2},schemeBuGn:function(){return wp},schemeBuPu:function(){return m2},schemeCategory10:function(){return NM},schemeDark2:function(){return r2},schemeGnBu:function(){return qi},schemeGreens:function(){return P2},schemeGreys:function(){return L2},schemeObservable10:function(){return FM},schemeOrRd:function(){return _2},schemeOranges:function(){return D2},schemePRGn:function(){return JM},schemePaired:function(){return BM},schemePastel1:function(){return jM},schemePastel2:function(){return zM},schemePiYG:function(){return t5},schemePuBu:function(){return Jl},schemePuBuGn:function(){return b2},schemePuOr:function(){return e5},schemePuRd:function(){return x2},schemePurples:function(){return I2},schemeRdBu:function(){return Bv},schemeRdGy:function(){return n5},schemeRdPu:function(){return S2},schemeRdYlBu:function(){return Ql},schemeRdYlGn:function(){return Sp},schemeReds:function(){return k2},schemeSet1:function(){return UM},schemeSet2:function(){return ZM},schemeSet3:function(){return LI},schemeSpectral:function(){return r5},schemeTableau10:function(){return II},schemeYlGn:function(){return O2},schemeYlGnBu:function(){return Uv},schemeYlOrBr:function(){return E2},schemeYlOrRd:function(){return T2}});var tt={};L.r(tt),L.d(tt,{geoAlbers:function(){return n9},geoAlbersUsa:function(){return NW},geoAzimuthalEqualArea:function(){return FW},geoAzimuthalEqualAreaRaw:function(){return P6},geoAzimuthalEquidistant:function(){return BW},geoAzimuthalEquidistantRaw:function(){return L6},geoConicConformal:function(){return zW},geoConicConformalRaw:function(){return o9},geoConicEqualArea:function(){return mO},geoConicEqualAreaRaw:function(){return e9},geoConicEquidistant:function(){return ZW},geoConicEquidistantRaw:function(){return a9},geoEqualEarth:function(){return WW},geoEqualEarthRaw:function(){return I6},geoEquirectangular:function(){return UW},geoEquirectangularRaw:function(){return Qy},geoGnomonic:function(){return VW},geoGnomonicRaw:function(){return R6},geoIdentity:function(){return GW},geoMercator:function(){return jW},geoMercatorRaw:function(){return Ky},geoNaturalEarth1:function(){return $W},geoNaturalEarth1Raw:function(){return k6},geoOrthographic:function(){return YW},geoOrthographicRaw:function(){return D6},geoProjection:function(){return lc},geoProjectionMutator:function(){return M6},geoStereographic:function(){return XW},geoStereographicRaw:function(){return N6},geoTransverseMercator:function(){return qW},geoTransverseMercatorRaw:function(){return F6}});var yt={};L.r(yt),L.d(yt,{frequency:function(){return pG},id:function(){return gG},name:function(){return vG},weight:function(){return hG}});var G=L(67294),Ot=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},bt=function(t,e){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},r,o,c,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=u(0),l.throw=u(1),l.return=u(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(h){return function(g){return d([h,g])}}function d(h){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,h[0]&&(n=0)),n;)try{if(r=1,o&&(c=h[0]&2?o.return:h[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,h[1])).done)return c;switch(o=0,c&&(h=[h[0]&2,c.value]),h[0]){case 0:case 1:c=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,o=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!c||h[1]>c[0]&&h[1]<c[3])){n.label=h[1];break}if(h[0]===6&&n.label<c[1]){n.label=c[1],c=h;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(h);break}c[2]&&n.ops.pop(),n.trys.pop();continue}h=e.call(t,n)}catch(g){h=[6,g],o=0}finally{r=c=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Et="__rc_react_root__",pt,Vt,K,X=!1;function Zt(){return Ot(this,void 0,void 0,function(){var t,e,n,r,o;return bt(this,function(c){switch(c.label){case 0:if(X)return[2];X=!0,c.label=1;case 1:return c.trys.push([1,6,,7]),t=G.version||"",e=parseInt(t.split(".")[0],10),e>=18?[4,Promise.resolve().then(L.t.bind(L,20745,19))]:[3,3];case 2:return n=c.sent(),pt=n.createRoot,[3,5];case 3:return[4,Promise.resolve().then(L.t.bind(L,73935,19))];case 4:r=c.sent(),Vt=r.render,K=r.unmountComponentAtNode,c.label=5;case 5:return[3,7];case 6:return o=c.sent(),console.warn("[react-render] Failed to load ReactDOM API:",o),[3,7];case 7:return[2]}})})}function Mt(t,e){e[Et]||(e[Et]=pt(e)),e[Et].render(t)}function zt(t,e){if(!Vt)throw new Error("ReactDOM.render not available");Vt(t,e)}function Rt(t,e){return Ot(this,void 0,void 0,function(){return bt(this,function(n){switch(n.label){case 0:return[4,Zt()];case 1:return n.sent(),pt?Mt(t,e):zt(t,e),[2]}})})}function Gt(t){if(!K)throw new Error("ReactDOM.unmountComponentAtNode not available");K(t)}function ve(t){return Ot(this,void 0,void 0,function(){var e,n;return bt(this,function(r){return(n=(e=t[Et])===null||e===void 0?void 0:e.unmount)===null||n===void 0||n.call(e),delete t[Et],[2]})})}function Me(t){return Ot(this,void 0,void 0,function(){return bt(this,function(e){switch(e.label){case 0:return[4,Zt()];case 1:return e.sent(),pt?[2,ve(t)]:[2,Gt(t)]}})})}var Ue=new Map;typeof document!="undefined"&&Ue.set("tooltip",document.createElement("div"));var Ke=function(t,e){e===void 0&&(e=!1);var n=null;if(e)n=Ue.get("tooltip");else if(n=document.createElement("div"),t!=null&&t.key){var r=Ue.get(t.key);r?n=r:Ue.set(t.key,n)}return Rt(t,n),n},we=function(){return we=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},we.apply(this,arguments)},Ut=function(t,e){if(e===void 0&&(e={}),typeof document=="undefined")return"loading";var n="";e&&Object.keys(e).forEach(function(l){n+="".concat(l,": ").concat(e[l],`;
`)});var r=t.attachShadow({mode:"open"}),o=document.createElement("div"),c=document.createElement("style");c.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
    `.concat(n,`
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `),o.classList.add("loading"),o.innerHTML="<div></div><div></div><div></div><div></div>",r.appendChild(c),r.appendChild(o)},nt=function(t){var e=t.loadingTemplate,n=t.theme,r=n===void 0?"light":n,o=t.loading,c=G.useRef(null),l=typeof o=="object"?o:{},u=l.container,d=u===void 0?{}:u,h=l.icon,g=h===void 0?{}:h;G.useEffect(function(){!e&&c.current&&Ut(c.current,g)},[]);var v=function(){return e||G.createElement("div",{ref:c})};return G.createElement("div",{className:"charts-loading-container",style:we({position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,background:r==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"},d)},v())},ie=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(t){ie(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state={hasError:!1},n.renderError=function(r){var o=n.props.errorTemplate;switch(r){default:return typeof o=="function"?o(r):o||G.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",r.message)}},n}return e.getDerivedStateFromError=function(n){return{hasError:!0,error:n}},e.getDerivedStateFromProps=function(n,r){return r.children!==n.children?{children:n.children,hasError:!1,error:void 0}:null},e.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):G.createElement(G.Fragment,null,this.props.children)},e}(G.Component),At=L(96486),Pe,it=function(){return Pe||(Pe=document.createElement("canvas").getContext("2d")),Pe},Pt=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))},q=(0,At.memoize)(function(t,e){e===void 0&&(e={});var n=e.fontSize,r=e.fontFamily,o=r===void 0?"sans-serif":r,c=e.fontWeight,l=e.fontStyle,u=e.fontVariant,d=it();return d.font=[l,c,u,"".concat(n,"px"),o].join(" "),d.measureText((0,At.isString)(t)?t:"")},function(t,e){return e===void 0&&(e={}),Pt([t],(0,At.values)(e),!0).join("")}),Nt=function(t,e){return e===void 0&&(e={}),q(t,e).width},It=function(t,e){e===void 0&&(e={});var n=q(t,e);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent},U=function(t){var e=[/\breact\b/i,/\.jsx/,/children:\s*\[/,/\*\s*[#@]__PURE__\s*\*/],n=/(\w+)?\.createElement\(\s*(['"`])([^'"`]+)\2/g,r=new Set(["g","circle","ellipse","image","rect","line","polyline","polygon","text","path","html","mesh"]);if(e.some(function(c){return c.test(t)}))return!0;var o=t.match(n);return o?o.some(function(c){var l=c.match(/\.createElement\(\s*(['"`])([^'"`]+)\1/);return l&&!r.has(l[2].toLowerCase())}):!1},ht=function(){return ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ht.apply(this,arguments)};function ne(t,e){var n=(0,G.useRef)(null),r=(0,G.useRef)(null),o=(0,G.useRef)(null),c=e.onReady,l=e.onEvent,u=function(g,v){var m;g===void 0&&(g="image/png");var _=(m=o.current)===null||m===void 0?void 0:m.getElementsByTagName("canvas")[0];return _==null?void 0:_.toDataURL(g,v)},d=function(g,v,m){g===void 0&&(g="download"),v===void 0&&(v="image/png");var _=g;g.indexOf(".")===-1&&(_="".concat(g,".").concat(v.split("/")[1]));var b=u(v,m),S=document.createElement("a");return S.href=b,S.download=_,document.body.appendChild(S),S.click(),document.body.removeChild(S),S=null,_},h=function(g,v){if(v===void 0&&(v=!1),!!(0,At.isObject)(g)){var m=Object.keys(g),_=v;m.forEach(function(b){var S=g[b];b==="tooltip"&&(_=!0),(0,At.isFunction)(S)&&U("".concat(S))?g[b]=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];return Ke(S.apply(void 0,w),_)}:(0,At.isArray)(S)?S.forEach(function(w){h(w,_)}):(0,At.isObject)(S)?h(S,_):_=v})}};return(0,G.useEffect)(function(){n.current&&!(0,At.isEqual)(r.current,e)&&(r.current=(0,At.cloneDeep)(e),h(e),n.current.update(e),n.current.render())},[e]),(0,G.useEffect)(function(){if(!o.current)return function(){return null};r.current||(r.current=(0,At.cloneDeep)(e)),h(e);var g=new t(o.current,ht({},e));g.toDataURL=u,g.downloadImage=d,g.render(),n.current=g,c&&c(g);var v=function(m){l&&l(g,m)};return g.on("*",v),function(){n.current&&(n.current.destroy(),n.current.off("*",v),n.current=void 0)}},[]),{chart:n,container:o}}var xe="*",_e=function(){function t(){this._events={}}return t.prototype.on=function(e,n,r){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:n,once:!!r}),this},t.prototype.once=function(e,n){return this.on(e,n,!0)},t.prototype.emit=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var c=this._events[e]||[],l=this._events[xe]||[],u=function(d){for(var h=d.length,g=0;g<h;g++)if(d[g]){var v=d[g],m=v.callback,_=v.once;_&&(d.splice(g,1),d.length===0&&delete n._events[e],h--,g--),m.apply(n,r)}};u(c),u(l)},t.prototype.off=function(e,n){if(!e)this._events={};else if(!n)delete this._events[e];else{for(var r=this._events[e]||[],o=r.length,c=0;c<o;c++)r[c].callback===n&&(r.splice(c,1),o--,c--);r.length===0&&delete this._events[e]}return this},t.prototype.getEvents=function(){return this._events},t}(),Xe=_e;const Re="main-layer",un="label-layer",cn="element",Jt="view",ct="plot",Ct="component",me="label",he="area",Tt="mask",re="axis-breaks",Yt="axis-breaks-group";var N=L(4559),kt=L(15671),oe=L(43144),C=L(53640),z=L(60136),Ft=L(74902),te=L(97685),se=L(81957),Se=L(25897),be=L(95147),Ze=L(76714),tn=L(80450),Ge=L(32945),Be=L(85975),jt=L(77160),ce=L(91),ae=L(46020),ye=L(1413),st=L(4942),D=L(71937);var H=function(t){function e(n,r,o,c){var l;return(0,kt.Z)(this,e),l=(0,C.Z)(this,e,[n]),l.currentTime=o,l.timelineTime=c,l.target=r,l.type="finish",l.bubbles=!1,l.currentTarget=r,l.defaultPrevented=!1,l.eventPhase=l.AT_TARGET,l.timeStamp=Date.now(),l.currentTime=o,l.timelineTime=c,l}return(0,z.Z)(e,t),(0,oe.Z)(e)}(N.xA),at=0,St=function(){function t(e,n){var r;(0,kt.Z)(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(at++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return(0,oe.Z)(t,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var n=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(r,o){n.resolveReadyPromise=function(){r(n)},n.rejectReadyPromise=function(){o(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var n=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(r,o){n.resolveFinishedPromise=function(){r(n)},n.rejectFinishedPromise=function(){o(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(n){if(n=Number(n),!isNaN(n)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var r;this._startTime=Number((r=this.timeline)===null||r===void 0?void 0:r.currentTime)-n/this.playbackRate}this.currentTimePending=!1,this._currentTime!==n&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(n,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(n){if(n!==null){if(this.updatePromises(),n=Number(n),isNaN(n)||this._paused||this._idle)return;this._startTime=n,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(n){if(n!==this._playbackRate){this.updatePromises();var r=this.currentTime;this._playbackRate=n,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),r!==null&&(this.currentTime=r),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var n;if((n=this.effect.target)!==null&&n!==void 0&&n.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var r=this.oldPlayState,o=this.pending?"pending":this.playState;return this.readyPromise&&o!==r&&(o==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):r==="pending"?this.resolveReadyPromise():o==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&o!==r&&(o==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):o==="finished"?this.resolveFinishedPromise():r==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=o,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var n=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=null,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var r=new H(null,this,this.currentTime,null);setTimeout(function(){n.oncancel(r)})}}},{key:"reverse",value:function(){this.updatePromises();var n=this.currentTime;this.playbackRate*=-1,this.play(),n!==null&&(this.currentTime=n),this.updatePromises()}},{key:"updatePlaybackRate",value:function(n){this.playbackRate=n}},{key:"targetAnimations",value:function(){var n,r=(n=this.effect)===null||n===void 0?void 0:n.target;return r.getAnimations()}},{key:"markTarget",value:function(){var n=this.targetAnimations();n.indexOf(this)===-1&&n.push(this)}},{key:"unmarkTarget",value:function(){var n=this.targetAnimations(),r=n.indexOf(this);r!==-1&&n.splice(r,1)}},{key:"tick",value:function(n,r){!this._idle&&!this._paused&&(this._startTime===null?r&&(this.startTime=n-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((n-this._startTime)*this.playbackRate)),r&&(this.currentTimePending=!1,this.fireEvents(n))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(N.jf)}},{key:"addEventListener",value:function(n,r,o){throw new Error(N.jf)}},{key:"removeEventListener",value:function(n,r,o){throw new Error(N.jf)}},{key:"dispatchEvent",value:function(n){throw new Error(N.jf)}},{key:"commitStyles",value:function(){throw new Error(N.jf)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var n;this._inEffect=!!((n=this.effect)!==null&&n!==void 0&&n.update(-1))}else{var r;this._inEffect=!!((r=this.effect)!==null&&r!==void 0&&r.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(n,r){n!==this._currentTime&&(this._currentTime=n,this._isFinished&&!r&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(n){var r=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var o=new H(null,this,this.currentTime,n);setTimeout(function(){r.onfinish&&r.onfinish(o)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var c=new H(null,this,this.currentTime,n);this.onframe(c)}this._finishedFlag=!1}}}])}(),Lt=4,ge=.001,de=1e-7,ze=10,Ne=11,sn=1/(Ne-1),Ce=typeof Float32Array=="function",en=function(e,n){return 1-3*n+3*e},dn=function(e,n){return 3*n-6*e},En=function(e){return 3*e},mn=function(e,n,r){return((en(n,r)*e+dn(n,r))*e+En(n))*e},jn=function(e,n,r){return 3*en(n,r)*e*e+2*dn(n,r)*e+En(n)},Wn=function(e,n,r,o,c){var l,u,d=0;do u=n+(r-n)/2,l=mn(u,o,c)-e,l>0?r=u:n=u;while(Math.abs(l)>de&&++d<ze);return u},tr=function(e,n,r,o){for(var c=0;c<Lt;++c){var l=jn(n,r,o);if(l===0)return n;var u=mn(n,r,o)-e;n-=u/l}return n},pr=function(e,n,r,o){if(!(e>=0&&e<=1&&r>=0&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===n&&r===o)return function(d){return d};for(var c=Ce?new Float32Array(Ne):new Array(Ne),l=0;l<Ne;++l)c[l]=mn(l*sn,e,r);var u=function(h){for(var g=0,v=1,m=Ne-1;v!==m&&c[v]<=h;++v)g+=sn;--v;var _=(h-c[v])/(c[v+1]-c[v]),b=g+_*sn,S=jn(b,e,r);return S>=ge?tr(h,b,e,r):S===0?b:Wn(h,g,g+sn,e,r)};return function(d){return d===0||d===1?d:mn(u(d),n,o)}},Mr=function(e){return e=e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},Qr=function(e){return Math.pow(e,2)},Nr=function(e){return Math.pow(e,3)},Lr=function(e){return Math.pow(e,4)},Fr=function(e){return Math.pow(e,5)},vi=function(e){return Math.pow(e,6)},Li=function(e){return 1-Math.cos(e*Math.PI/2)},Ii=function(e){return 1-Math.sqrt(1-e*e)},mi=function(e){return e*e*(3*e-2)},Hi=function(e){for(var n,r=4;e<((n=Math.pow(2,--r))-1)/11;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((n*3-2)/22-e,2)},io=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=(0,te.Z)(n,2),o=r[0],c=o===void 0?1:o,l=r[1],u=l===void 0?.5:l,d=(0,se.Z)(Number(c),1,10),h=(0,se.Z)(Number(u),.1,2);return e===0||e===1?e:-d*Math.pow(2,10*(e-1))*Math.sin((e-1-h/(Math.PI*2)*Math.asin(1/d))*(Math.PI*2)/h)},Ko=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,o=(0,te.Z)(n,4),c=o[0],l=c===void 0?1:c,u=o[1],d=u===void 0?100:u,h=o[2],g=h===void 0?10:h,v=o[3],m=v===void 0?0:v;l=(0,se.Z)(l,.1,1e3),d=(0,se.Z)(d,.1,1e3),g=(0,se.Z)(g,.1,1e3),m=(0,se.Z)(m,.1,1e3);var _=Math.sqrt(d/l),b=g/(2*Math.sqrt(d*l)),S=b<1?_*Math.sqrt(1-b*b):0,w=1,E=b<1?(b*_+-m)/S:-m+_,T=r?r*e/1e3:e;return b<1?T=Math.exp(-T*b*_)*(w*Math.cos(S*T)+E*Math.sin(S*T)):T=(w+E*T)*Math.exp(-T*_),e===0||e===1?e:1-T},So=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=n,o=(0,te.Z)(r,2),c=o[0],l=c===void 0?10:c,u=o[1],d=u==="start"?Math.ceil:Math.floor;return d((0,se.Z)(e,0,1)*l)/l},fa=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=(0,te.Z)(n,4),o=r[0],c=r[1],l=r[2],u=r[3];return pr(o,c,l,u)(e)},li=pr(.42,0,1,1),Cr=function(e){return function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return 1-e(1-n,r,o)}},ft=function(e){return function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return n<.5?e(n*2,r,o)/2:1-e(n*-2+2,r,o)/2}},_t=function(e){return function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return n<.5?(1-e(1-n*2,r,o))/2:(e(n*2-1,r,o)+1)/2}},ee={steps:So,"step-start":function(e){return So(e,[1,"start"])},"step-end":function(e){return So(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":fa,ease:function(e){return fa(e,[.25,.1,.25,1])},in:li,out:Cr(li),"in-out":ft(li),"out-in":_t(li),"in-quad":Qr,"out-quad":Cr(Qr),"in-out-quad":ft(Qr),"out-in-quad":_t(Qr),"in-cubic":Nr,"out-cubic":Cr(Nr),"in-out-cubic":ft(Nr),"out-in-cubic":_t(Nr),"in-quart":Lr,"out-quart":Cr(Lr),"in-out-quart":ft(Lr),"out-in-quart":_t(Lr),"in-quint":Fr,"out-quint":Cr(Fr),"in-out-quint":ft(Fr),"out-in-quint":_t(Fr),"in-expo":vi,"out-expo":Cr(vi),"in-out-expo":ft(vi),"out-in-expo":_t(vi),"in-sine":Li,"out-sine":Cr(Li),"in-out-sine":ft(Li),"out-in-sine":_t(Li),"in-circ":Ii,"out-circ":Cr(Ii),"in-out-circ":ft(Ii),"out-in-circ":_t(Ii),"in-back":mi,"out-back":Cr(mi),"in-out-back":ft(mi),"out-in-back":_t(mi),"in-bounce":Hi,"out-bounce":Cr(Hi),"in-out-bounce":ft(Hi),"out-in-bounce":_t(Hi),"in-elastic":io,"out-elastic":Cr(io),"in-out-elastic":ft(io),"out-in-elastic":_t(io),spring:Ko,"spring-in":Ko,"spring-out":Cr(Ko),"spring-in-out":ft(Ko),"spring-out-in":_t(Ko)},pe=function(e){return Mr(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},Ie=function(e){return ee[pe(e)]||ee.linear},je=function(e){return e},Oe=1,Ee=.5,Ve=0;function $e(t,e){return function(n){if(n>=1)return 1;var r=1/t;return n+=e*r,n-n%r}}var pn="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Sn=new RegExp("cubic-bezier\\(".concat(pn,",").concat(pn,",").concat(pn,",").concat(pn,"\\)")),Dn=/steps\(\s*(\d+)\s*\)/,vn=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Mn(t){var e=Sn.exec(t);if(e)return pr.apply(void 0,(0,Ft.Z)(e.slice(1).map(Number)));var n=Dn.exec(t);if(n)return $e(Number(n[1]),Ve);var r=vn.exec(t);return r?$e(Number(r[1]),{start:Oe,middle:Ee,end:Ve}[r[2]]):Ie(t)}function Pn(t){return Math.abs(yn(t)/(t.playbackRate||1))}function yn(t){var e;return t.duration===0||t.iterations===0?0:(t.duration==="auto"?0:Number(t.duration))*((e=t.iterations)!==null&&e!==void 0?e:1)}var $n=0,kn=1,Vn=2,Ln=3;function zn(t,e,n){if(e===null)return $n;var r=n.endTime;return e<Math.min(n.delay,r)?kn:e>=Math.min(n.delay+t+n.endDelay,r)?Vn:Ln}function ir(t,e,n,r,o){switch(r){case kn:return e==="backwards"||e==="both"?0:null;case Ln:return n-o;case Vn:return e==="forwards"||e==="both"?t:null;case $n:return null}}function Qi(t,e,n,r,o){var c=o;return t===0?e!==kn&&(c+=n):c+=r/t,c}function Wi(t,e,n,r,o,c){var l=t===1/0?e%1:t%1;return l===0&&n===Vn&&r!==0&&(o!==0||c===0)&&(l=1),l}function fi(t,e,n,r){return t===Vn&&e===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function Ji(t,e,n){var r=t;if(t!=="normal"&&t!=="reverse"){var o=e;t==="alternate-reverse"&&(o+=1),r="normal",o!==1/0&&o%2!==0&&(r="reverse")}return r==="normal"?n:1-n}function to(t,e,n){var r=zn(t,e,n),o=ir(t,n.fill,e,r,n.delay);if(o===null)return null;var c=n.duration==="auto"?0:n.duration,l=Qi(c,r,n.iterations,o,n.iterationStart),u=Wi(l,n.iterationStart,r,n.iterations,o,c),d=fi(r,n.iterations,u,l),h=Ji(n.direction,d,u);return n.currentIteration=d,n.progress=h,n.easingFunction(h)}function Dt(t,e,n){var r=Ae(t,e),o=Qe(r,n);return function(c,l){if(l!==null)o.filter(function(d){return l>=d.applyFrom&&l<d.applyTo}).forEach(function(d){var h=l-d.startOffset,g=d.endOffset-d.startOffset,v=g===0?0:h/g;c.setAttribute(d.property,d.interpolation(v),!1,!1)});else for(var u in r)Xt(u)&&c.setAttribute(u,null)}}function Xt(t){return t!=="offset"&&t!=="easing"&&t!=="composite"&&t!=="computedOffset"}function Ae(t,e){for(var n={},r=0;r<t.length;r++)for(var o in t[r])if(Xt(o)){var c={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:Mn(t[r].easing)||e.easingFunction,value:t[r][o]};n[o]=n[o]||[],n[o].push(c)}return n}function Qe(t,e){var n=[];for(var r in t)for(var o=t[r],c=0;c<o.length-1;c++){var l=c,u=c+1,d=o[l].computedOffset,h=o[u].computedOffset,g=d,v=h;c===0&&(g=-1/0,h===0&&(u=l)),c===o.length-2&&(v=1/0,d===1&&(l=u)),n.push({applyFrom:g,applyTo:v,startOffset:o[l].computedOffset,endOffset:o[u].computedOffset,easingFunction:o[l].easingFunction,property:r,interpolation:In(r,o[l].value,o[u].value,e)})}return n.sort(function(m,_){return m.startOffset-_.startOffset}),n}var gn=function(e,n,r){return function(o){var c=Xn(e,n,o);return(0,Se.Z)(c)?c:r(c)}};function In(t,e,n,r){var o=N.N1[t];if(o&&o.syntax&&o.int){var c=N.GZ.styleValueRegistry.getPropertySyntax(o.syntax);if(c){var l=c.parser,u=l?l(e,r):e,d=l?l(n,r):n,h=c.mixer(u,d,r);if(h){var g=gn.apply(void 0,(0,Ft.Z)(h));return function(v){return v===0?e:v===1?n:g(v)}}}}return gn(!1,!0,function(v){return v?n:e})}function Xn(t,e,n){if(typeof t=="number"&&typeof e=="number")return t*(1-n)+e*n;if(typeof t=="boolean"&&typeof e=="boolean"||typeof t=="string"&&typeof e=="string")return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,o=e.length,c=Math.max(r,o),l=[],u=0;u<c;u++)l.push(Xn(t[u<r?u:r-1],e[u<o?u:o-1],n));return l}throw new Error("Mismatched interpolation arguments ".concat(t,":").concat(e))}var ri=function(){function t(){(0,kt.Z)(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=je,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return(0,oe.Z)(t,[{key:"easing",get:function(){return this._easing},set:function(n){this.easingFunction=Mn(n),this._easing=n}}])}();function di(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var o=r.length,c=0;c<o;c++){if(!e[c]){var l={};"offset"in t&&(l.offset=Number(t.offset)),"easing"in t&&(l.easing=t.easing),"composite"in t&&(l.composite=t.composite),e[c]=l}r[c]!==void 0&&r[c]!==null&&(e[c][n]=r[c])}}return e.sort(function(u,d){return(u.computedOffset||0)-(d.computedOffset||0)}),e}function Pr(t,e){if(t===null)return[];Array.isArray(t)||(t=di(t));for(var n=t.map(function(d){var h={};e!=null&&e.composite&&(h.composite="auto");for(var g in d){var v=d[g];if(g==="offset"){if(v!==null){if(v=Number(v),!isFinite(v))throw new Error("Keyframe offsets must be numbers.");if(v<0||v>1)throw new Error("Keyframe offsets must be between 0 and 1.");h.computedOffset=v}}else if(g==="composite"&&["replace","add","accumulate","auto"].indexOf(v)===-1)throw new Error("".concat(v," compositing is not supported"));h[g]=v}return h.offset===void 0&&(h.offset=null),h.easing===void 0&&(h.easing=(e==null?void 0:e.easing)||"linear"),h.composite===void 0&&(h.composite="auto"),h}),r=!0,o=-1/0,c=0;c<n.length;c++){var l=n[c].offset;if((0,be.Z)(l))r=!1;else{if(l<o)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");o=l}}n=n.filter(function(d){return Number(d.offset)>=0&&Number(d.offset)<=1});function u(){var d,h=n,g=h.length;if(n[g-1].computedOffset=Number((d=n[g-1].offset)!==null&&d!==void 0?d:1),g>1){var v;n[0].computedOffset=Number((v=n[0].offset)!==null&&v!==void 0?v:0)}for(var m=0,_=Number(n[0].computedOffset),b=1;b<g;b++){var S=n[b].computedOffset;if(!(0,be.Z)(S)&&!(0,be.Z)(_)){for(var w=1;w<b-m;w++)n[m+w].computedOffset=_+(Number(S)-_)*w/(b-m);m=b,_=Number(S)}}}return r||u(),n}var wi="backwards|forwards|both|none".split("|"),v7="reverse|alternate|alternate-reverse".split("|");function Gr(t,e){var n=new ri;return e&&(n.fill="both",n.duration="auto"),typeof t=="number"&&!isNaN(t)?n.duration=t:t!==void 0&&Object.keys(t).forEach(function(r){if(t[r]!==void 0&&t[r]!==null&&t[r]!=="auto"){if((typeof n[r]=="number"||r==="duration")&&(typeof t[r]!="number"||isNaN(t[r]))||r==="fill"&&wi.indexOf(t[r])===-1||r==="direction"&&v7.indexOf(t[r])===-1)return;n[r]=t[r]}}),n}function dc(t,e){return t=ul(t!=null?t:{duration:"auto"}),Gr(t,e)}function ul(t){return typeof t=="number"&&(isNaN(t)?t={duration:"auto"}:t={duration:t}),t}var zO=function(){function t(e,n,r){var o=this;(0,kt.Z)(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=dc(r,!1),this.timing.effect=this,this.timing.activeDuration=Pn(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Pr(n,this.timing),this.interpolations=Dt(this.normalizedKeyframes,this.timing,this.target);var c=N.GZ.globalThis.Proxy;this.computedTiming=c?new c(this.timing,{get:function(u,d){return d==="duration"?u.duration==="auto"?0:u.duration:d==="fill"?u.fill==="auto"?"none":u.fill:d==="localTime"?o.animation&&o.animation.currentTime||null:d==="currentIteration"?!o.animation||o.animation.playState!=="running"?null:u.currentIteration||0:d==="progress"?!o.animation||o.animation.playState!=="running"?null:u.progress||0:u[d]},set:function(){return!0}}):this.timing}return(0,oe.Z)(t,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(n){return n===null?!1:(this.timeFraction=to(this.timing.activeDuration,n,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(n){this.normalizedKeyframes=Pr(n)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(n){var r=this;Object.keys(n||{}).forEach(function(o){r.timing[o]=n[o]})}}])}();function f1(t,e){return Number(t.id)-Number(e.id)}var UO=function(){function t(e){var n=this;(0,kt.Z)(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){n.currentTime=r,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(r){var o=n.rafCallbacks;n.rafCallbacks=[],r<Number(n.currentTime)&&(r=Number(n.currentTime)),n.animations.sort(f1),n.animations=n.tick(r,!0,n.animations)[0],o.forEach(function(c){c[1](r)}),n.applyPendingEffects()},this.document=e}return(0,oe.Z)(t,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(n,r,o){var c=new zO(n,r,o),l=new St(c,this);return this.animations.push(l),this.restartWebAnimationsNextTick(),l.updatePromises(),l.play(),l.updatePromises(),l}},{key:"applyDirtiedAnimation",value:function(n){var r=this;if(!this.inTick){n.markTarget();var o=n.targetAnimations();o.sort(f1);var c=this.tick(Number(this.currentTime),!1,o.slice())[1];c.forEach(function(l){var u=r.animations.indexOf(l);u!==-1&&r.animations.splice(u,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(n){n==null||n.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(n){return n.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(n){return n.playState!=="finished"&&n.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(n){var r=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([r,n]),r}},{key:"requestAnimationFrame",value:function(n){var r=this;return this.rAF(function(o){r.updateAnimationsPromises(),n(o),r.updateAnimationsPromises()})}},{key:"tick",value:function(n,r,o){var c=this,l,u;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=n,this.ticking=!1;var d=[],h=[],g=[],v=[];return o.forEach(function(m){m.tick(n,r),m._inEffect?(h.push(m.effect),m.markTarget()):(d.push(m.effect),m.unmarkTarget()),m._needsTick&&(c.ticking=!0);var _=m._inEffect||m._needsTick;m._inTimeline=_,_?g.push(m):v.push(m)}),(l=this.pendingEffects).push.apply(l,d),(u=this.pendingEffects).push.apply(u,h),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[g,v]}}])}();N.GZ.EasingFunction=Mn,N.GZ.AnimationTimeline=UO;var ZO=function(t){function e(){var n;(0,kt.Z)(this,e);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=(0,C.Z)(this,e,[].concat(o)),n.landmarks=[],n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"rotate",value:function(r,o,c){if(this.relElevation=(0,N._O)(o),this.relAzimuth=(0,N._O)(r),this.relRoll=(0,N._O)(c),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===N.iM.EXPLORING){var l=Ge.yY(Ge.Ue(),[1,0,0],(0,N.Vl)((this.rotateWorld?1:-1)*this.relElevation)),u=Ge.yY(Ge.Ue(),[0,1,0],(0,N.Vl)((this.rotateWorld?1:-1)*this.relAzimuth)),d=Ge.yY(Ge.Ue(),[0,0,1],(0,N.Vl)(this.relRoll)),h=Ge.Jp(Ge.Ue(),u,l);h=Ge.Jp(Ge.Ue(),h,d);var g=Be.fromQuat(Be.create(),h);Be.translate(this.matrix,this.matrix,[0,0,-this.distance]),Be.multiply(this.matrix,this.matrix,g),Be.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===N.iM.ORBITING||this.type===N.iM.EXPLORING?this._getPosition():this.type===N.iM.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(r,o){var c=(0,N.O4)(r,o,0),l=jt.d9(this.position);return jt.IH(l,l,jt.bA(jt.Ue(),this.right,c[0])),jt.IH(l,l,jt.bA(jt.Ue(),this.up,c[1])),this._setPosition(l),this.triggerUpdate(),this}},{key:"dolly",value:function(r){var o=this.forward,c=jt.d9(this.position),l=r*this.dollyingStep,u=this.distance+r*this.dollyingStep;return l=Math.max(Math.min(u,this.maxDistance),this.minDistance)-this.distance,c[0]+=l*o[0],c[1]+=l*o[1],c[2]+=l*o[2],this._setPosition(c),this.type===N.iM.ORBITING||this.type===N.iM.EXPLORING?this._getDistance():this.type===N.iM.TRACKING&&jt.IH(this.focalPoint,c,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(r){var o,c,l,u,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=d.position,g=h===void 0?this.position:h,v=d.focalPoint,m=v===void 0?this.focalPoint:v,_=d.roll,b=d.zoom,S=new N.GZ.CameraContribution;S.setType(this.type,void 0),S.setPosition(g[0],(o=g[1])!==null&&o!==void 0?o:this.position[1],(c=g[2])!==null&&c!==void 0?c:this.position[2]),S.setFocalPoint(m[0],(l=m[1])!==null&&l!==void 0?l:this.focalPoint[1],(u=m[2])!==null&&u!==void 0?u:this.focalPoint[2]),S.setRoll(_!=null?_:this.roll),S.setZoom(b!=null?b:this.zoom);var w={name:r,matrix:Be.clone(S.getWorldTransform()),right:jt.d9(S.right),up:jt.d9(S.up),forward:jt.d9(S.forward),position:jt.d9(S.getPosition()),focalPoint:jt.d9(S.getFocalPoint()),distanceVector:jt.d9(S.getDistanceVector()),distance:S.getDistance(),dollyingStep:S.getDollyingStep(),azimuth:S.getAzimuth(),elevation:S.getElevation(),roll:S.getRoll(),relAzimuth:S.relAzimuth,relElevation:S.relElevation,relRoll:S.relRoll,zoom:S.getZoom()};return this.landmarks.push(w),w}},{key:"gotoLandmark",value:function(r){var o=this,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=(0,Ze.Z)(r)?this.landmarks.find(function(et){return et.name===r}):r;if(l){var u=(0,Se.Z)(c)?{duration:c}:c,d=u.easing,h=d===void 0?"linear":d,g=u.duration,v=g===void 0?100:g,m=u.easingFunction,_=m===void 0?void 0:m,b=u.onfinish,S=b===void 0?void 0:b,w=u.onframe,E=w===void 0?void 0:w,T=.01;this.cancelLandmarkAnimation();var M=l.position,P=l.focalPoint,R=l.zoom,k=l.roll,F=_||N.GZ.EasingFunction(h),W,$=function(){o.setFocalPoint(P),o.setPosition(M),o.setRoll(k),o.setZoom(R),o.computeMatrix(),o.triggerUpdate(),S==null||S()};if(v===0)return $();var rt=function(ut){W===void 0&&(W=ut);var J=ut-W;if(J>=v){$();return}var lt=F(J/v),vt=jt.Ue(),xt=jt.Ue(),Ht=1,gt=0;jt.t7(vt,o.focalPoint,P,lt),jt.t7(xt,o.position,M,lt),gt=o.roll*(1-lt)+k*lt,Ht=o.zoom*(1-lt)+R*lt,o.setFocalPoint(vt),o.setPosition(xt),o.setRoll(gt),o.setZoom(Ht);var wt=jt.TK(vt,P)+jt.TK(xt,M);if(wt<=T&&R===void 0&&k===void 0)return $();o.computeMatrix(),o.triggerUpdate(),J<v&&(E==null||E(lt),o.landmarkAnimationID=o.canvas.requestAnimationFrame(rt))};this.canvas.requestAnimationFrame(rt)}}}])}(N.V1);N.GZ.CameraContribution=ZO;var m7=null,d1=null;function Ad(t,e,n){var r=t+e;return n?r*2:r}function h1(t,e){var n=e?[[t*.25,t*.25],[t*.75,t*.75]]:[[t*.5,t*.5]];return n}var HO={size:6,padding:2,backgroundColor:"transparent",opacity:1,fill:"#fff",fillOpacity:1,stroke:"transparent",strokeOpacity:1,lineWidth:0,isStagger:!0};function y7(t){var e=_objectSpread(_objectSpread({},HO),t),n=e.size,r=e.padding,o=e.isStagger,c=e.backgroundColor,l=e.backgroundOpacity,u=e.opacity,d=e.fill,h=e.fillOpacity,g=e.lineWidth,v=e.stroke,m=e.strokeOpacity,_=Ad(n,r,o),b=h1(_,o),S=new Rect({style:{width:_,height:_,fill:c,opacity:1,fillOpacity:l}}),w=_createForOfIteratorHelper(b),E;try{for(w.s();!(E=w.n()).done;){var T=_slicedToArray(E.value,2),M=T[0],P=T[1],R=new Circle({style:{opacity:u,fill:d,fillOpacity:h,cx:M,cy:P,r:n/2,lineWidth:g,stroke:v,strokeOpacity:m}});S.appendChild(R)}}catch(k){w.e(k)}finally{w.f()}return S}var WO={spacing:5,opacity:1,backgroundColor:"transparent",backgroundOpacity:1,strokeOpacity:1,stroke:"#fff",lineWidth:2};function _7(t){var e=_objectSpread(_objectSpread({},WO),t),n=e.spacing,r=e.lineWidth,o=e.backgroundColor,c=e.backgroundOpacity,l=e.opacity,u=e.stroke,d=e.strokeOpacity,h=n+r||1,g=n+r||1,v=`
            M 0 0 L `.concat(h,` 0
            M 0 `).concat(g," L ").concat(h," ").concat(g,`
            `),m=new Rect({style:{width:h,height:g,fill:o,opacity:1,fillOpacity:c}}),_=new Path({style:{d:v,opacity:l,stroke:u,strokeOpacity:d,fillOpacity:1,lineWidth:r}});return m.appendChild(_),m}var VO={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,fill:"#fff",fillOpacity:1,stroke:"transparent",lineWidth:0};function b7(t){var e=_objectSpread(_objectSpread({},VO),t),n=e.size,r=e.padding,o=e.isStagger,c=e.backgroundColor,l=e.backgroundOpacity,u=e.opacity,d=e.fill,h=e.fillOpacity,g=e.stroke,v=e.strokeOpacity,m=e.lineWidth,_=Ad(n,r,o),b=h1(_,o),S=new Rect({style:{width:_,height:_,fill:c,opacity:1,fillOpacity:l}}),w=_createForOfIteratorHelper(b),E;try{for(w.s();!(E=w.n()).done;){var T=_slicedToArray(E.value,2),M=T[0],P=T[1],R=new Rect({style:{opacity:u,fill:d,fillOpacity:h,x:M-n/2,y:P-n/2,width:n,height:n,lineWidth:m,stroke:g,strokeOpacity:v}});S.appendChild(R)}}catch(k){w.e(k)}finally{w.f()}return S}var GO=["body","startHead","endHead","startHeadOffset","endHeadOffset"],$O=["body","startHead","endHead","startHeadOffset","endHeadOffset"],YO=["body","startHead","endHead","startHeadOffset","endHeadOffset"],p1=function(t){function e(n){var r;(0,kt.Z)(this,e),r=(0,C.Z)(this,e,[(0,ye.Z)((0,ye.Z)({},n),{},{type:e.tag})]);var o=r.attributes,c=o.body,l=o.startHead,u=o.endHead;o.startHeadOffset,o.endHeadOffset;var d=(0,ce.Z)(o,GO);if(!c)throw new Error("Arrow's body is required");return r.body=c,r.appendChild(r.body),r.handleBodyAttributeChanged(r.body),l&&r.appendArrowHead(r.getArrowHeadType(l),!0),u&&r.appendArrowHead(r.getArrowHeadType(u),!1),r.applyArrowStyle(d,[r.body,r.startHead,r.endHead]),r}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"handleBodyAttributeChanged",value:function(r){var o=this;r.addEventListener(N.Dk.ATTR_MODIFIED,function(c){var l=c.attrName;l==="x1"||l==="y1"?o.startHead&&o.transformArrowHead(o.startHead,!0):(l==="x2"||l==="y2")&&o.endHead&&o.transformArrowHead(o.endHead,!1)})}},{key:"getBody",value:function(){return this.body}},{key:"getStartHead",value:function(){return this.startHead}},{key:"getEndHead",value:function(){return this.endHead}},{key:"attributeChangedCallback",value:function(r,o,c){if(r==="opacity"||r==="strokeOpacity"||r==="stroke"||r==="lineWidth"||r==="increasedLineWidthForHitTesting")this.applyArrowStyle((0,st.Z)({},r,c),[this.body,this.startHead,this.endHead]);else if(r==="startHead"||r==="endHead"){var l=r==="startHead";if(this.destroyArrowHead(l),c){var u=this.attributes;u.body,u.startHead,u.endHead,u.startHeadOffset,u.endHeadOffset;var d=(0,ce.Z)(u,$O);this.appendArrowHead(this.getArrowHeadType(c),l),this.applyArrowStyle(d,[l?this.startHead:this.endHead])}}else if(r==="body"){var h=this.attributes;h.body,h.startHead,h.endHead,h.startHeadOffset,h.endHeadOffset;var g=(0,ce.Z)(h,YO);this.body.destroy(),this.body=c,this.appendChild(this.body),this.applyArrowStyle(g,[this.body])}else r==="startHeadOffset"?this.moveArrowHeadAlongTangent(c,!0):r==="endHeadOffset"&&this.moveArrowHeadAlongTangent(c,!1)}},{key:"getArrowHeadType",value:function(r){return typeof r=="boolean"?"default":"custom"}},{key:"appendArrowHead",value:function(r,o){var c;r==="default"?c=this.createDefaultArrowHead():c=o?this.attributes.startHead:this.attributes.endHead,this.transformArrowHead(c,o),c.setAttribute("zIndex",1),o?this.startHead=c:this.endHead=c,this.appendChild(c);var l=o?this.attributes.startHeadOffset:this.attributes.endHeadOffset;l&&this.moveArrowHeadAlongTangent(l,o)}},{key:"transformArrowHead",value:function(r,o){var c=jt.Ue(),l=0,u=0,d=0,h=0,g=0,v=this.body&&this.body.nodeName;if(v===N.bn.LINE){var m=this.body.attributes,_=m.x1,b=m.x2,S=m.y1,w=m.y2;u=o?b:_,d=o?_:b,h=o?w:S,g=o?S:w}else if(v===N.bn.POLYLINE){var E=this.body.attributes.points,T=E.length;u=o?E[1][0]:E[T-2][0],h=o?E[1][1]:E[T-2][1],d=o?E[0][0]:E[T-1][0],g=o?E[0][1]:E[T-1][1]}else if(v===N.bn.PATH){var M=this.getTangent(this.body,o),P=(0,te.Z)(M,2),R=P[0],k=P[1];u=R[0],h=R[1],d=k[0],g=k[1]}var F=u-d,W=h-g;l=Math.atan2(W,F),c=jt.al(d,g,0),o?(this.startHeadPosition=c,this.startHeadRad=l):(this.endHeadPosition=c,this.endHeadRad=l),r.setLocalPosition(c),r.setLocalEulerAngles(l*180/Math.PI+r.getLocalEulerAngles())}},{key:"moveArrowHeadAlongTangent",value:function(r,o){var c=o?this.startHead:this.endHead;c&&c.setLocalPosition(jt.lu(jt.Ue(),o?this.startHeadPosition:this.endHeadPosition,jt.al(Math.cos(o?this.startHeadRad:this.endHeadRad)*r,Math.sin(o?this.startHeadRad:this.endHeadRad)*r,0))),this.body}},{key:"destroyArrowHead",value:function(r){r&&this.startHead&&(this.startHead.destroy(),this.startHead=void 0),!r&&this.endHead&&(this.endHead.destroy(),this.endHead=void 0)}},{key:"getTangent",value:function(r,o){return o?r.getStartTangent():r.getEndTangent()}},{key:"createDefaultArrowHead",value:function(){var r=this.attributes,o=r.stroke,c=r.lineWidth,l=Math.sin,u=Math.cos,d=Math.PI,h=10*u(d/6);return new N.y$({style:{d:"M".concat(h/2,",").concat(10*l(d/6)," L-").concat(h/2,",0 L").concat(h/2,",-").concat(10*l(d/6)),stroke:o,lineWidth:c,transformOrigin:"center"}})}},{key:"applyArrowStyle",value:function(r,o){var c=r.opacity,l=r.stroke,u=r.strokeOpacity,d=r.lineWidth,h=r.increasedLineWidthForHitTesting;o.forEach(function(g){g&&((0,be.Z)(c)||(g.style.opacity=c),(0,be.Z)(l)||(g.style.stroke=l),(0,be.Z)(u)||(g.style.strokeOpacity=u),(0,be.Z)(d)||(g.style.lineWidth=d),(0,be.Z)(h)||(g.style.increasedLineWidthForHitTesting=h))})}}])}(N.b_);p1.tag="arrow",p1.PARSED_STYLE_LIST=new Set([].concat((0,Ft.Z)(N.b_.PARSED_STYLE_LIST),["body","startHead","endHead","startHeadOffset","endHeadOffset","stroke","lineWidth","opacity","strokeOpacity"]));var C0=Math.PI,XO=C0*2,zu=Math.sin,Td=Math.cos,qO=Math.acos,yo=Math.atan2,Uu=Math.sqrt,P0=Math.max,wa=Math.min,fl=1e-4,KO=[{name:"sr",inherits:!1,interpolable:!0,syntax:N.h0.LENGTH_PERCENTAGE},{name:"sr0",inherits:!1,interpolable:!0,syntax:N.h0.LENGTH_PERCENTAGE},{name:"startAngle",inherits:!1,interpolable:!0,syntax:N.h0.ANGLE},{name:"endAngle",inherits:!1,interpolable:!0,syntax:N.h0.ANGLE}];KO.forEach(function(t){N.ux.registerProperty(t)});var da=function(e,n,r,o){return{x:e+r*Math.cos(o),y:n+r*Math.sin(o)}};function QO(t,e,n,r,o,c,l,u){var d=n-t,h=r-e,g=l-o,v=u-c,m=v*d-g*h;if(!(m*m<fl))return m=(g*(e-c)-v*(t-o))/m,[t+m*d,e+m*h]}function Md(t,e,n,r,o,c,l){var u=t-n,d=e-r,h=(l?c:-c)/Uu(u*u+d*d),g=h*d,v=-h*u,m=t+g,_=e+v,b=n+g,S=r+v,w=(m+b)/2,E=(_+S)/2,T=b-m,M=S-_,P=T*T+M*M,R=o-c,k=m*S-b*_,F=(M<0?-1:1)*Uu(P0(0,R*R*P-k*k)),W=(k*M-T*F)/P,$=(-k*T-M*F)/P,rt=(k*M+T*F)/P,et=(-k*T+M*F)/P,ut=W-w,J=$-E,lt=rt-w,vt=et-E;return ut*ut+J*J>lt*lt+vt*vt&&(W=rt,$=et),{cx:W,cy:$,x0:-g,y0:-v,x1:W*(o/R-1),y1:$*(o/R-1)}}function ns(t,e){return e=e<0&&t>=0?e+XO:e,e-t<=C0?0:1}var JO=function(t){function e(n){var r;return(0,kt.Z)(this,e),r=(0,C.Z)(this,e,[n]),r.updatePath(),r}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"setAttribute",value:function(r,o,c){(0,D.Z)(e,"setAttribute",this,3)([r,o,c]),["startAngle","endAngle","sr","sr0","radius"].indexOf(r)>-1&&this.updatePath()}},{key:"updatePath",value:function(){var r=this.parsedStyle,o=r.x,c=r.y,l=r.startAngle,u=r.endAngle,d=r.sr,h=r.sr0,g=r.radius,v=this.createPath(o,c,l?(0,N.Vl)(l):0,u?(0,N.Vl)(u):Math.PI*2,d||0,h||0,g||[0,0,0,0]);(0,D.Z)(e,"setAttribute",this,3)(["d",v])}},{key:"createPath",value:function(r,o,c,l,u,d,h){if(!(u<=0)){var g=da(r,o,u,c),v=da(r,o,u,l),m=da(r,o,d,c),_=da(r,o,d,l);if((0,tn.Z)(l-c,Math.PI*2)){var b=da(r,o,u,c+Math.PI),S=da(r,o,d,c+Math.PI),w=[["M",g.x,g.y],["A",u,u,0,1,1,b.x,b.y],["A",u,u,0,1,1,v.x,v.y],["M",m.x,m.y]];return d&&(w.push(["A",d,d,0,1,0,S.x,S.y]),w.push(["A",d,d,0,1,0,_.x,_.y])),w.push(["M",g.x,g.y]),w.push(["Z"]),w}var E=l-c,T=u*Td(c),M=u*zu(c),P=d*Td(l),R=d*zu(l),k=u*Td(l),F=u*zu(l),W=d*Td(c),$=d*zu(c),rt=(0,te.Z)(h,4),et=rt[0],ut=rt[1],J=rt[2],lt=rt[3],vt=(u-d)/2,xt=wa(vt,et),Ht=wa(vt,ut),gt=wa(vt,J),wt=wa(vt,lt),Wt=P0(xt,Ht),fe=P0(gt,wt),le=Wt,Te=fe;if((Wt>fl||fe>fl)&&E<C0){var Fe=QO(T,M,W,$,k,F,P,R);if(Fe){var De=T-Fe[0],Je=M-Fe[1],qe=k-Fe[0],We=F-Fe[1],fn=1/zu(qO((De*qe+Je*We)/(Uu(De*De+Je*Je)*Uu(qe*qe+We*We)))/2),_n=Uu(Fe[0]*Fe[0]+Fe[1]*Fe[1]);le=wa(Wt,(u-_n)/(fn+1)),Te=wa(fe,(d-_n)/(fn-1))}}var An=ns(c,l),xn=!0,On=[];if(le>fl){var Fn=wa(et,le),Hn=wa(ut,le),qn=Md(W,$,T,M,u,Fn,xn),Rn=Md(k,F,P,R,u,Hn,xn);if(On.push(["M",r+qn.cx+qn.x0,o+qn.cy+qn.y0]),le<Wt&&Fn===Hn){var Bn=yo(qn.y0,qn.x0),Yn=yo(Rn.y0,Rn.x0);On.push(["A",le,le,0,ns(Bn,Yn),1,r+Rn.cx+Rn.x0,o+Rn.cy+Rn.y0])}else{if(Fn>0){var ti=yo(qn.y0,qn.x0),ei=yo(qn.y1,qn.x1),Ar=da(r,o,u,ei);On.push(["A",Fn,Fn,0,ns(ti,ei),1,Ar.x,Ar.y])}var Bi=yo(qn.cy+qn.y1,qn.cx+qn.x1),Si=yo(Rn.cy+Rn.y1,Rn.cx+Rn.x1),Zi=da(r,o,u,Si);if(On.push(["A",u,u,0,ns(Bi,Si),1,Zi.x,Zi.y]),Hn>0){var ci=yo(Rn.y1,Rn.x1),gi=yo(Rn.y0,Rn.x0);On.push(["A",Hn,Hn,0,ns(ci,gi),1,r+Rn.cx+Rn.x0,o+Rn.cy+Rn.y0])}}}else On.push(["M",g.x,g.y]),On.push(["A",u,u,0,An,1,v.x,v.y]);if(d<fl)On.push(["L",_.x,_.y]);else if(Te>fl){var Ei=wa(lt,Te),ni=wa(J,Te),fr=Md(P,R,0,0,d-u,ni,xn),Vr=Md(0,0,W,$,d-u,Ei,xn);if(On.push(["L",r+fr.cx+fr.x0,o+fr.cy+fr.y0]),Te<fe&&Ei===ni){var Pi=yo(fr.y0,fr.x0),Do=yo(Vr.y0,Vr.x0),uc=da(r,o,d,Do);On.push(["A",le,le,0,ns(Pi,Do),1,uc.x,uc.y])}else{if(ni>0){var ju=yo(fr.y0,fr.x0),Ed=yo(fr.y1,fr.x1),FO=da(r,o,d-u,Ed);On.push(["A",ni,ni,0,ns(ju,Ed),1,FO.x,FO.y])}var h7=yo(fr.cy+fr.y1,fr.cx+fr.x1),gF=yo(Vr.cy+Vr.y1,Vr.cx+Vr.x1),BO=da(r,o,d,gF);if(On.push(["A",d,d,0,ns(gF,h7),0,BO.x,BO.y]),On.push(["L",BO.x,BO.y]),Ei>0){var VX=yo(Vr.y1,Vr.x1),GX=yo(Vr.y0,Vr.x0);On.push(["A",Ei,Ei,0,ns(VX,GX),1,r+Vr.cx+Vr.x0,o+Vr.cy+Vr.y0])}}}else On.push(["L",_.x,_.y]),On.push(["A",d,d,0,An,0,m.x,m.y]);return On.push(["Z"]),On}}}])}(N.y$);JO.PARSED_STYLE_LIST=new Set([].concat((0,Ft.Z)(N.y$.PARSED_STYLE_LIST),["x","y","sr","sr0","radius","startAngle","endAngle"]));var tE=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const L0=(t,e,n)=>[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]];L0.style=["fill"];const g1=L0.bind(void 0);g1.style=["stroke","lineWidth"];const Cd=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]];Cd.style=["fill"];const v1=Cd.bind(void 0);v1.style=["fill"];const m1=Cd.bind(void 0);m1.style=["stroke","lineWidth"];const I0=(t,e,n)=>{const r=n*.618;return[["M",t-r,e],["L",t,e-n],["L",t+r,e],["L",t,e+n],["Z"]]};I0.style=["fill"];const y1=I0.bind(void 0);y1.style=["stroke","lineWidth"];const R0=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]};R0.style=["fill"];const _1=R0.bind(void 0);_1.style=["stroke","lineWidth"];const k0=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]};k0.style=["fill"];const b1=k0.bind(void 0);b1.style=["stroke","lineWidth"];const D0=(t,e,n)=>{const r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]};D0.style=["fill"];const x1=D0.bind(void 0);x1.style=["stroke","lineWidth"];const N0=(t,e,n)=>{const r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]};N0.style=["fill"];const S1=N0.bind(void 0);S1.style=["stroke","lineWidth"];const w1=(t,e,n)=>[["M",t,e+n],["L",t,e-n]];w1.style=["stroke","lineWidth"];const hi=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]];hi.style=["stroke","lineWidth"];const O1=(t,e,n)=>[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]];O1.style=["stroke","lineWidth"];const E1=(t,e,n)=>[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]];E1.style=["stroke","lineWidth"];const F0=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];F0.style=["stroke","lineWidth"];const Pd=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];Pd.style=["stroke","lineWidth"];const A1=Pd.bind(void 0);A1.style=["stroke","lineWidth"];const Vi=(t,e,n)=>[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]];Vi.style=["stroke","lineWidth"];const Oa=(t,e,n)=>[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]];Oa.style=["stroke","lineWidth"];const Ea=(t,e,n)=>[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]];Ea.style=["stroke","lineWidth"];const hc=(t,e,n)=>[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]];hc.style=["stroke","lineWidth"];const B0=(t,e,n)=>[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]];B0.style=["stroke","lineWidth"];const pc=new Map([["bowtie",N0],["cross",hi],["dash",A1],["diamond",I0],["dot",Pd],["hexagon",D0],["hollowBowtie",S1],["hollowDiamond",y1],["hollowHexagon",x1],["hollowPoint",g1],["hollowSquare",m1],["hollowTriangle",_1],["hollowTriangleDown",b1],["hv",Oa],["hvh",hc],["hyphen",F0],["line",w1],["plus",E1],["point",L0],["rect",v1],["smooth",Vi],["square",Cd],["tick",O1],["triangleDown",k0],["triangle",R0],["vh",Ea],["vhv",B0]]);function x7(t,e){var{d:n,fill:r,lineWidth:o,path:c,stroke:l,color:u}=e,d=tE(e,["d","fill","lineWidth","path","stroke","color"]);const h=pc.get(t)||pc.get("point");return(...g)=>new N.y$({style:Object.assign(Object.assign({},d),{d:h(...g),stroke:h.style.includes("stroke")?u||l:"",fill:h.style.includes("fill")?u||r:"",lineWidth:h.style.includes("lineWidth")?o||o||2:0})})}function j0(t,e){pc.set(t,e)}function bF(t){pc.delete(t)}const T1={};function M1(t,e){t.startsWith("symbol.")?j0(t.split(".").pop(),e):Object.assign(T1,{[t]:e})}function rs(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var S7=0;function eE(t){return"__private_"+S7+++"_"+t}var Mo=L(74873),z0=L(37762),gc=L(55850),C1=L(15861),dl=L(11702);var Ri=eE("renderState"),nE=function(){function t(e){(0,kt.Z)(this,t),this.renderQueue=[],Object.defineProperty(this,Ri,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Be.create(),this.dprMatrix=Be.create(),this.tmpMat4=Be.create(),this.vec3a=jt.Ue(),this.vec3b=jt.Ue(),this.vec3c=jt.Ue(),this.vec3d=jt.Ue(),this.canvasRendererPluginOptions=e}return(0,oe.Z)(t,[{key:"apply",value:function(n,r){var o=this;this.context=n;var c=this.context,l=c.config,u=c.camera,d=c.renderingService,h=c.renderingContext,g=c.pathGeneratorFactory,v=l.renderer.getConfig().enableRenderingOptimization;l.renderer.getConfig().enableDirtyCheck=!1,l.renderer.getConfig().enableDirtyRectangleRendering=!1,this.pathGeneratorFactory=g;var m=n.contextService,_=h.root.ownerDocument.defaultView;d.hooks.init.tap(t.tag,function(){var w=m.getDPR(),E=l.width,T=l.height,M=m.getContext();o.clearRect(M,0,0,E*w,T*w,l.background)}),d.hooks.destroy.tap(t.tag,function(){o.renderQueue=[],rs(o,Ri)[Ri]={restoreStack:[],prevObject:null,currentContext:null}});var b=function(){var E,T=m.getContext(),M=m.getDPR(),P=l.width,R=l.height,k=o.canvasRendererPluginOptions,F=k.dirtyObjectNumThreshold,W=k.dirtyObjectRatioThreshold,$=d.getStats(),rt=$.total,et=$.rendered,ut=et/rt;o.clearFullScreen=o.clearFullScreenLastFrame||!((E=_.context.renderingPlugins[1])!==null&&E!==void 0&&E.isFirstTimeRenderingFinished)||d.disableDirtyRectangleRendering()||et>F&&ut>W,T&&(typeof T.resetTransform=="function"?T.resetTransform():T.setTransform(1,0,0,1,0,0),o.clearFullScreen&&o.clearRect(T,0,0,P*M,R*M,l.background))},S=function(E,T){for(var M=[E];M.length>0;){var P,R=M.pop();R.isVisible()&&!R.isCulled()&&(v?o.renderDisplayObjectOptimized(R,T,o.context,rs(o,Ri)[Ri],r):o.renderDisplayObject(R,T,o.context,rs(o,Ri)[Ri],r));for(var k=((P=R.sortable)===null||P===void 0||(P=P.sorted)===null||P===void 0?void 0:P.length)>0?R.sortable.sorted:R.childNodes,F=k.length-1;F>=0;F--)M.push(k[F])}};d.hooks.endFrame.tap(t.tag,function(){if(b(),h.root.childNodes.length===0){o.clearFullScreenLastFrame=!0;return}v=l.renderer.getConfig().enableRenderingOptimization,rs(o,Ri)[Ri]={restoreStack:[],prevObject:null,currentContext:rs(o,Ri)[Ri].currentContext},rs(o,Ri)[Ri].currentContext.clear(),o.clearFullScreenLastFrame=!1;var w=m.getContext(),E=m.getDPR();if(Be.fromScaling(o.dprMatrix,[E,E,1]),Be.multiply(o.vpMatrix,o.dprMatrix,u.getOrthoMatrix()),o.clearFullScreen)v?(w.save(),S(h.root,w),w.restore()):S(h.root,w);else{var T=o.safeMergeAABB(o.mergeDirtyAABBs(o.renderQueue));if(N.mN.isEmpty(T)){o.renderQueue=[];return}var M=o.convertAABB2Rect(T),P=M.x,R=M.y,k=M.width,F=M.height,W=jt.fF(o.vec3a,[P,R,0],o.vpMatrix),$=jt.fF(o.vec3b,[P+k,R,0],o.vpMatrix),rt=jt.fF(o.vec3c,[P,R+F,0],o.vpMatrix),et=jt.fF(o.vec3d,[P+k,R+F,0],o.vpMatrix),ut=Math.min(W[0],$[0],et[0],rt[0]),J=Math.min(W[1],$[1],et[1],rt[1]),lt=Math.max(W[0],$[0],et[0],rt[0]),vt=Math.max(W[1],$[1],et[1],rt[1]),xt=Math.floor(ut),Ht=Math.floor(J),gt=Math.ceil(lt-ut),wt=Math.ceil(vt-J);w.save(),o.clearRect(w,xt,Ht,gt,wt,l.background),w.beginPath(),w.rect(xt,Ht,gt,wt),w.clip(),w.setTransform(o.vpMatrix[0],o.vpMatrix[1],o.vpMatrix[4],o.vpMatrix[5],o.vpMatrix[12],o.vpMatrix[13]);var Wt=l.renderer.getConfig(),fe=Wt.enableDirtyRectangleRenderingDebug;fe&&_.dispatchEvent(new N.Aw(N.$6.DIRTY_RECTANGLE,{dirtyRect:{x:xt,y:Ht,width:gt,height:wt}}));var le=T.getMin(),Te=(0,te.Z)(le,2),Fe=Te[0],De=Te[1],Je=T.getMax(),qe=(0,te.Z)(Je,2),We=qe[0],fn=qe[1],_n=h.root.ownerDocument.elementsFromBBox(Fe,De,We,fn);_n.sort(function(An,xn){return An.sortable.renderOrder-xn.sortable.renderOrder}).forEach(function(An){An&&An.isVisible()&&!An.isCulled()&&o.renderDisplayObject(An,w,o.context,rs(o,Ri)[Ri],r)}),w.restore(),o.renderQueue.forEach(function(An){o.saveDirtyAABB(An)}),o.renderQueue=[]}rs(o,Ri)[Ri].restoreStack.forEach(function(){w.restore()}),rs(o,Ri)[Ri].restoreStack=[]}),d.hooks.render.tap(t.tag,function(w){o.clearFullScreen||o.renderQueue.push(w)})}},{key:"clearRect",value:function(n,r,o,c,l,u){n.clearRect(r,o,c,l),u&&(n.fillStyle=u,n.fillRect(r,o,c,l))}},{key:"renderDisplayObjectOptimized",value:function(n,r,o,c,l){var u=n.nodeName,d=!1,h=!1,g=this.context.styleRendererFactory[u],v=this.pathGeneratorFactory[u],m=n.parsedStyle.clipPath;if(m){d=!c.prevObject||!Be.exactEquals(m.getWorldTransform(),c.prevObject.getWorldTransform()),d&&(this.applyWorldTransform(r,m),c.prevObject=null);var _=this.pathGeneratorFactory[m.nodeName];_&&(r.save(),h=!0,r.beginPath(),_(r,m.parsedStyle),r.closePath(),r.clip())}if(g){d=!c.prevObject||!Be.exactEquals(n.getWorldTransform(),c.prevObject.getWorldTransform()),d&&this.applyWorldTransform(r,n);var b=!c.prevObject;if(!b){var S=c.prevObject.nodeName;u===N.bn.TEXT?b=S!==N.bn.TEXT:u===N.bn.IMAGE?b=S!==N.bn.IMAGE:b=S===N.bn.TEXT||S===N.bn.IMAGE}g.applyStyleToContext(r,n,b,c),c.prevObject=n}v&&(r.beginPath(),v(r,n.parsedStyle),u!==N.bn.LINE&&u!==N.bn.PATH&&u!==N.bn.POLYLINE&&r.closePath()),g&&g.drawToContext(r,n,rs(this,Ri)[Ri],this,l),h&&r.restore(),n.dirty(!1)}},{key:"renderDisplayObject",value:function(n,r,o,c,l){var u=n.nodeName,d=c.restoreStack[c.restoreStack.length-1];d&&!(n.compareDocumentPosition(d)&N.NB.DOCUMENT_POSITION_CONTAINS)&&(r.restore(),c.restoreStack.pop());var h=this.context.styleRendererFactory[u],g=this.pathGeneratorFactory[u],v=n.parsedStyle.clipPath;if(v){this.applyWorldTransform(r,v);var m=this.pathGeneratorFactory[v.nodeName];m&&(r.save(),c.restoreStack.push(n),r.beginPath(),m(r,v.parsedStyle),r.closePath(),r.clip())}h&&(this.applyWorldTransform(r,n),r.save(),this.applyAttributesToContext(r,n)),g&&(r.beginPath(),g(r,n.parsedStyle),u!==N.bn.LINE&&u!==N.bn.PATH&&u!==N.bn.POLYLINE&&r.closePath()),h&&(h.render(r,n.parsedStyle,n,o,this,l),r.restore()),n.dirty(!1)}},{key:"applyAttributesToContext",value:function(n,r){var o=r.parsedStyle,c=o.stroke,l=o.fill,u=o.opacity,d=o.lineDash,h=o.lineDashOffset;d&&n.setLineDash(d),(0,be.Z)(h)||(n.lineDashOffset=h),(0,be.Z)(u)||(n.globalAlpha*=u),!(0,be.Z)(c)&&!Array.isArray(c)&&!c.isNone&&(n.strokeStyle=r.attributes.stroke),!(0,be.Z)(l)&&!Array.isArray(l)&&!l.isNone&&(n.fillStyle=r.attributes.fill)}},{key:"convertAABB2Rect",value:function(n){var r=n.getMin(),o=n.getMax(),c=Math.floor(r[0]),l=Math.floor(r[1]),u=Math.ceil(o[0]),d=Math.ceil(o[1]),h=u-c,g=d-l;return{x:c,y:l,width:h,height:g}}},{key:"mergeDirtyAABBs",value:function(n){var r=new N.mN;return n.forEach(function(o){var c=o.getRenderBounds();r.add(c);var l=o.renderable.dirtyRenderBounds;l&&r.add(l)}),r}},{key:"saveDirtyAABB",value:function(n){var r=n.renderable;r.dirtyRenderBounds||(r.dirtyRenderBounds=new N.mN);var o=n.getRenderBounds();o&&r.dirtyRenderBounds.update(o.center,o.halfExtents)}},{key:"applyWorldTransform",value:function(n,r,o){o?(Be.copy(this.tmpMat4,r.getLocalTransform()),Be.multiply(this.tmpMat4,o,this.tmpMat4),Be.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Be.copy(this.tmpMat4,r.getWorldTransform()),Be.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),n.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var n=new N.mN,r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return o.forEach(function(l){n.add(l)}),n}}])}();nE.tag="CanvasRenderer";function hl(t,e,n,r,o,c,l){var u,d;if(t.image.nodeName==="rect"){var h=t.image.parsedStyle,g=h.width,v=h.height;d=r.contextService.getDPR();var m=r.config.offscreenCanvas;u=c.offscreenCanvasCreator.getOrCreateCanvas(m),u.width=g*d,u.height=v*d;var _=c.offscreenCanvasCreator.getOrCreateContext(m),b={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach(function(w){o.renderDisplayObject(w,_,r,b,c)}),b.restoreStack.forEach(function(){_.restore()})}var S=l.getOrCreatePatternSync(e,t,n,u,d,e.getGeometryBounds().min,function(){e.dirty(),r.renderingService.dirty()});return S}function Ld(t,e,n,r){var o;if(t.type===N.GL.LinearGradient||t.type===N.GL.RadialGradient){var c=e.getGeometryBounds(),l=c&&c.halfExtents[0]*2||1,u=c&&c.halfExtents[1]*2||1,d=c&&c.min||[0,0];o=r.getOrCreateGradient((0,ye.Z)((0,ye.Z)({type:t.type},t.value),{},{min:d,width:l,height:u}),n)}return o}var Zu=["shadowBlur","shadowOffsetX","shadowOffsetY"],P1=["lineCap","lineJoin","miterLimit"],ji={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},L1={};function Ti(t,e,n,r){var o=r.has(e)?r.get(e):ji[e];return o!==n&&(e==="lineDash"?t.setLineDash(n):t[e]=n,r.set(e,n)),o}var Id=function(){function t(e){(0,kt.Z)(this,t),this.imagePool=e}return(0,oe.Z)(t,[{key:"applyAttributesToContext",value:function(n,r){}},{key:"render",value:function(n,r,o,c,l,u){}},{key:"applyCommonStyleToContext",value:function(n,r,o,c){var l=o?L1:c.prevObject.parsedStyle,u=r.parsedStyle;(o||u.opacity!==l.opacity)&&Ti(n,"globalAlpha",(0,be.Z)(u.opacity)?ji.globalAlpha:u.opacity,c.currentContext),(o||u.blend!==l.blend)&&Ti(n,"globalCompositeOperation",(0,be.Z)(u.blend)?ji.globalCompositeOperation:u.blend,c.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(n,r,o,c){var l=o?L1:c.prevObject.parsedStyle,u=r.parsedStyle,d=u.lineWidth,h=d===void 0?ji.lineWidth:d,g=u.fill&&!u.fill.isNone,v=u.stroke&&!u.stroke.isNone&&h>0;if(v){if(o||r.attributes.stroke!==c.prevObject.attributes.stroke){var m=!(0,be.Z)(u.stroke)&&!Array.isArray(u.stroke)&&!u.stroke.isNone?r.attributes.stroke:ji.strokeStyle;Ti(n,"strokeStyle",m,c.currentContext)}(o||u.lineWidth!==l.lineWidth)&&Ti(n,"lineWidth",(0,be.Z)(u.lineWidth)?ji.lineWidth:u.lineWidth,c.currentContext),(o||u.lineDash!==l.lineDash)&&Ti(n,"lineDash",u.lineDash||ji.lineDash,c.currentContext),(o||u.lineDashOffset!==l.lineDashOffset)&&Ti(n,"lineDashOffset",(0,be.Z)(u.lineDashOffset)?ji.lineDashOffset:u.lineDashOffset,c.currentContext);for(var _=0;_<P1.length;_++){var b=P1[_];(o||u[b]!==l[b])&&Ti(n,b,(0,be.Z)(u[b])?ji[b]:u[b],c.currentContext)}}if(g&&(o||r.attributes.fill!==c.prevObject.attributes.fill)){var S=!(0,be.Z)(u.fill)&&!Array.isArray(u.fill)&&!u.fill.isNone?r.attributes.fill:ji.fillStyle;Ti(n,"fillStyle",S,c.currentContext)}}},{key:"applyStyleToContext",value:function(n,r,o,c){var l=r.nodeName;this.applyCommonStyleToContext(n,r,o,c),l===N.bn.IMAGE||this.applyStrokeFillStyleToContext(n,r,o,c)}},{key:"applyShadowAndFilterStyleToContext",value:function(n,r,o,c){var l=r.parsedStyle;if(o){Ti(n,"shadowColor",l.shadowColor.toString(),c.currentContext);for(var u=0;u<Zu.length;u++){var d=Zu[u];Ti(n,d,l[d]||ji[d],c.currentContext)}}l.filter&&l.filter.length&&Ti(n,"filter",r.attributes.filter,c.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(n,r,o,c){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(r){Ti(n,"shadowColor",ji.shadowColor,c.currentContext);for(var u=0;u<Zu.length;u++){var d=Zu[u];Ti(n,d,ji[d],c.currentContext)}}if(o)if(r&&l){var h=n.filter;!(0,be.Z)(h)&&h.indexOf("drop-shadow")>-1&&Ti(n,"filter",h.replace(/drop-shadow\([^)]*\)/,"").trim()||ji.filter,c.currentContext)}else Ti(n,"filter",ji.filter,c.currentContext)}},{key:"fillToContext",value:function(n,r,o,c,l){var u=this,d=r.parsedStyle,h=d.fill,g=d.fillRule,v=null;if(Array.isArray(h)&&h.length>0)h.forEach(function(_){var b=Ti(n,"fillStyle",Ld(_,r,n,u.imagePool),o.currentContext);v=v!=null?v:b,g?n.fill(g):n.fill()});else{if((0,N.R)(h)){var m=hl(h,r,n,r.ownerDocument.defaultView.context,c,l,this.imagePool);m&&(n.fillStyle=m,v=!0)}g?n.fill(g):n.fill()}v!==null&&Ti(n,"fillStyle",v,o.currentContext)}},{key:"strokeToContext",value:function(n,r,o,c,l){var u=this,d=r.parsedStyle.stroke,h=null;if(Array.isArray(d)&&d.length>0)d.forEach(function(m){var _=Ti(n,"strokeStyle",Ld(m,r,n,u.imagePool),o.currentContext);h=h!=null?h:_,n.stroke()});else{if((0,N.R)(d)){var g=hl(d,r,n,r.ownerDocument.defaultView.context,c,l,this.imagePool);if(g){var v=Ti(n,"strokeStyle",g,o.currentContext);h=h!=null?h:v}}n.stroke()}h!==null&&Ti(n,"strokeStyle",h,o.currentContext)}},{key:"drawToContext",value:function(n,r,o,c,l){var u,d=r.nodeName,h=r.parsedStyle,g=h.opacity,v=g===void 0?ji.globalAlpha:g,m=h.fillOpacity,_=m===void 0?ji.fillOpacity:m,b=h.strokeOpacity,S=b===void 0?ji.strokeOpacity:b,w=h.lineWidth,E=w===void 0?ji.lineWidth:w,T=h.fill&&!h.fill.isNone,M=h.stroke&&!h.stroke.isNone&&E>0;if(!(!T&&!M)){var P=!(0,be.Z)(h.shadowColor)&&h.shadowBlur>0,R=h.shadowType==="inner",k=((u=h.fill)===null||u===void 0?void 0:u.alpha)===0,F=!!(h.filter&&h.filter.length),W=P&&M&&(d===N.bn.PATH||d===N.bn.LINE||d===N.bn.POLYLINE||k||R),$=null;if(T){W||this.applyShadowAndFilterStyleToContext(n,r,P,o);var rt=v*_;$=Ti(n,"globalAlpha",rt,o.currentContext),this.fillToContext(n,r,o,c,l),W||this.clearShadowAndFilterStyleForContext(n,P,F,o)}if(M){var et=!1,ut=v*S,J=Ti(n,"globalAlpha",ut,o.currentContext);if($=T?$:J,W&&(this.applyShadowAndFilterStyleToContext(n,r,P,o),et=!0,R)){var lt=n.globalCompositeOperation;n.globalCompositeOperation="source-atop",this.strokeToContext(n,r,o,c,l),n.globalCompositeOperation=lt,this.clearShadowAndFilterStyleForContext(n,P,F,o,!0)}this.strokeToContext(n,r,o,c,l),et&&this.clearShadowAndFilterStyleForContext(n,P,F,o)}$!==null&&Ti(n,"globalAlpha",$,o.currentContext)}}}])}(),Aa=function(t){function e(){return(0,kt.Z)(this,e),(0,C.Z)(this,e,arguments)}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"render",value:function(r,o,c,l,u,d){var h=o.fill,g=o.fillRule,v=o.opacity,m=v===void 0?1:v,_=o.fillOpacity,b=_===void 0?1:_,S=o.stroke,w=o.strokeOpacity,E=w===void 0?1:w,T=o.lineWidth,M=T===void 0?1:T,P=o.lineCap,R=o.lineJoin,k=o.shadowType,F=o.shadowColor,W=o.shadowBlur,$=o.filter,rt=o.miterLimit,et=h&&!h.isNone,ut=S&&!S.isNone&&M>0,J=(h==null?void 0:h.alpha)===0,lt=!!($&&$.length),vt=!(0,be.Z)(F)&&W>0,xt=c.nodeName,Ht=k==="inner",gt=ut&&vt&&(xt===N.bn.PATH||xt===N.bn.LINE||xt===N.bn.POLYLINE||J||Ht);et&&(r.globalAlpha=m*b,gt||U0(c,r,vt),rE(r,c,h,g,l,u,d,this.imagePool),gt||this.clearShadowAndFilter(r,lt,vt)),ut&&(r.globalAlpha=m*E,r.lineWidth=M,(0,be.Z)(rt)||(r.miterLimit=rt),(0,be.Z)(P)||(r.lineCap=P),(0,be.Z)(R)||(r.lineJoin=R),gt&&(Ht&&(r.globalCompositeOperation="source-atop"),U0(c,r,!0),Ht&&(I1(r,c,S,l,u,d,this.imagePool),r.globalCompositeOperation=ji.globalCompositeOperation,this.clearShadowAndFilter(r,lt,!0))),I1(r,c,S,l,u,d,this.imagePool))}},{key:"clearShadowAndFilter",value:function(r,o,c){if(c&&(r.shadowColor="transparent",r.shadowBlur=0),o){var l=r.filter;!(0,be.Z)(l)&&l.indexOf("drop-shadow")>-1&&(r.filter=l.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(Id);function U0(t,e,n){var r=t.parsedStyle,o=r.filter,c=r.shadowColor,l=r.shadowBlur,u=r.shadowOffsetX,d=r.shadowOffsetY;o&&o.length&&(e.filter=t.style.filter),n&&(e.shadowColor=c.toString(),e.shadowBlur=l||0,e.shadowOffsetX=u||0,e.shadowOffsetY=d||0)}function rE(t,e,n,r,o,c,l,u){var d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(n)?n.forEach(function(h){t.fillStyle=Ld(h,e,t,u),d||(r?t.fill(r):t.fill())}):((0,N.R)(n)&&(t.fillStyle=hl(n,e,t,o,c,l,u)),d||(r?t.fill(r):t.fill()))}function I1(t,e,n,r,o,c,l){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(n)?n.forEach(function(d){t.strokeStyle=Ld(d,e,t,l),u||t.stroke()}):((0,N.R)(n)&&(t.strokeStyle=hl(n,e,t,r,o,c,l)),u||t.stroke())}function w7(t,e){var n=(0,te.Z)(t,4),r=n[0],o=n[1],c=n[2],l=n[3],u=(0,te.Z)(e,4),d=u[0],h=u[1],g=u[2],v=u[3],m=Math.max(r,d),_=Math.max(o,h),b=Math.min(r+c,d+g),S=Math.min(o+l,h+v);return b<=m||S<=_?null:[m,_,b-m,S-_]}function Z0(t,e){var n=jt.fF(jt.Ue(),[t[0],t[1],0],e),r=jt.fF(jt.Ue(),[t[0]+t[2],t[1],0],e),o=jt.fF(jt.Ue(),[t[0],t[1]+t[3],0],e),c=jt.fF(jt.Ue(),[t[0]+t[2],t[1]+t[3],0],e);return[Math.min(n[0],r[0],o[0],c[0]),Math.min(n[1],r[1],o[1],c[1]),Math.max(n[0],r[0],o[0],c[0])-Math.min(n[0],r[0],o[0],c[0]),Math.max(n[1],r[1],o[1],c[1])-Math.min(n[1],r[1],o[1],c[1])]}var R1=function(t){function e(){return(0,kt.Z)(this,e),(0,C.Z)(this,e,arguments)}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"renderDownSampled",value:function(r,o,c,l){var u=l.src,d=l.imageCache;if(!d.downSampled){this.imagePool.createDownSampledImage(u,c).then(function(){c.ownerDocument&&(c.dirty(),c.ownerDocument.defaultView.context.renderingService.dirty())}).catch(function(h){console.error(h)});return}r.drawImage(d.downSampled,Math.floor(l.drawRect[0]),Math.floor(l.drawRect[1]),Math.ceil(l.drawRect[2]),Math.ceil(l.drawRect[3]))}},{key:"renderTile",value:function(r,o,c,l){var u=l.src,d=l.imageCache,h=l.imageRect,g=l.drawRect,v=d.size,m=r.getTransform(),_=m.a,b=m.b,S=m.c,w=m.d,E=m.e,T=m.f;if(r.resetTransform(),!(d!=null&&d.gridSize)){this.imagePool.createImageTiles(u,[],function(){c.ownerDocument&&(c.dirty(),c.ownerDocument.defaultView.context.renderingService.dirty())},c).catch(function(vt){console.error(vt)});return}for(var M=[v[0]/h[2],v[1]/h[3]],P=[d.tileSize[0]/M[0],d.tileSize[1]/M[1]],R=[Math.floor((g[0]-h[0])/P[0]),Math.ceil((g[0]+g[2]-h[0])/P[0])],k=R[0],F=R[1],W=[Math.floor((g[1]-h[1])/P[1]),Math.ceil((g[1]+g[3]-h[1])/P[1])],$=W[0],rt=W[1],et=$;et<=rt;et++)for(var ut=k;ut<=F;ut++){var J=d.tiles[et][ut];if(J){var lt=[Math.floor(h[0]+J.tileX*P[0]),Math.floor(h[1]+J.tileY*P[1]),Math.ceil(P[0]),Math.ceil(P[1])];r.drawImage(J.data,lt[0],lt[1],lt[2],lt[3])}}r.setTransform(_,b,S,w,E,T)}},{key:"render",value:function(r,o,c){var l=o.x,u=l===void 0?0:l,d=o.y,h=d===void 0?0:d,g=o.width,v=o.height,m=o.src,_=o.shadowColor,b=o.shadowBlur,S=this.imagePool.getImageSync(m,c),w=S==null?void 0:S.img,E=g,T=v;if(w){E||(E=w.width),T||(T=w.height);var M=!(0,be.Z)(_)&&b>0;U0(c,r,M);try{var P=c.ownerDocument.defaultView.getContextService().getDomElement(),R=P.width,k=P.height,F=r.getTransform(),W=F.a,$=F.b,rt=F.c,et=F.d,ut=F.e,J=F.f,lt=Be.fromValues(W,rt,0,0,$,et,0,0,0,0,1,0,ut,J,0,1),vt=Z0([u,h,E,T],lt),xt=w7([0,0,R,k],vt);if(!xt)return;if(!c.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){e.renderFull(r,o,c,{image:w,drawRect:[u,h,E,T]});return}var Ht=vt[2]/S.size[0];if(Ht<(S.downSamplingRate||.5)){this.renderDownSampled(r,o,c,{src:m,imageCache:S,drawRect:[u,h,E,T]});return}if(!ImagePool.isSupportTile){e.renderFull(r,o,c,{image:w,drawRect:[u,h,E,T]});return}this.renderTile(r,o,c,{src:m,imageCache:S,imageRect:vt,drawRect:xt})}catch(gt){}}}},{key:"drawToContext",value:function(r,o,c,l,u){this.render(r,o.parsedStyle,o)}}],[{key:"renderFull",value:function(r,o,c,l){r.drawImage(l.image,Math.floor(l.drawRect[0]),Math.floor(l.drawRect[1]),Math.ceil(l.drawRect[2]),Math.ceil(l.drawRect[3]))}}])}(Aa),Rd=function(t){function e(){return(0,kt.Z)(this,e),(0,C.Z)(this,e,arguments)}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"render",value:function(r,o,c,l,u,d){c.getBounds();var h=o.lineWidth,g=h===void 0?1:h,v=o.textAlign,m=v===void 0?"start":v,_=o.textBaseline,b=_===void 0?"alphabetic":_,S=o.lineJoin,w=S===void 0?"miter":S,E=o.miterLimit,T=E===void 0?10:E,M=o.letterSpacing,P=M===void 0?0:M,R=o.stroke,k=o.fill,F=o.fillRule,W=o.fillOpacity,$=W===void 0?1:W,rt=o.strokeOpacity,et=rt===void 0?1:rt,ut=o.opacity,J=ut===void 0?1:ut,lt=o.metrics,vt=o.x,xt=vt===void 0?0:vt,Ht=o.y,gt=Ht===void 0?0:Ht,wt=o.dx,Wt=o.dy,fe=o.shadowColor,le=o.shadowBlur,Te=o.textDecorationLine,Fe=lt.font,De=lt.lines,Je=lt.height,qe=lt.lineHeight,We=lt.lineMetrics;r.font=Fe,r.lineWidth=g,r.textAlign=m==="middle"?"center":m;var fn=b;fn==="alphabetic"&&(fn="bottom"),r.lineJoin=w,(0,be.Z)(T)||(r.miterLimit=T);var _n=gt;b==="middle"?_n+=-Je/2-qe/2:b==="bottom"||b==="alphabetic"||b==="ideographic"?_n+=-Je:(b==="top"||b==="hanging")&&(_n+=-qe);var An=xt+(wt||0);_n+=Wt||0,De.length===1&&(fn==="bottom"?(fn="middle",_n-=.5*Je):fn==="top"&&(fn="middle",_n+=.5*Je)),r.textBaseline=fn;var xn=!(0,be.Z)(fe)&&le>0;U0(c,r,xn);for(var On=0;On<De.length;On++){var Fn=g/2+An;_n+=qe,!(0,be.Z)(R)&&!R.isNone&&g&&this.drawLetterSpacing(r,c,De[On],We[On],m,Fn,_n,P,k,F,$,R,et,J,!0,l,u,d),(0,be.Z)(k)||this.drawLetterSpacing(r,c,De[On],We[On],m,Fn,_n,P,k,F,$,R,et,J,!1,l,u,d)}Te&&Te!=="none"&&this.drawTextDecorations(r,o,c,De,qe,An,gt+(Wt||0),l,u,d)}},{key:"drawLetterSpacing",value:function(r,o,c,l,u,d,h,g,v,m,_,b,S,w,E,T,M,P){if(g===0){E?this.strokeText(r,o,c,d,h,b,S,T,M,P):this.fillText(r,o,c,d,h,v,m,_,w,T,M,P);return}var R=r.textAlign;r.textAlign="left";var k=d;u==="center"||u==="middle"?k=d-l.width/2:(u==="right"||u==="end")&&(k=d-l.width);for(var F=Array.from(c),W=r.measureText(c).width,$=0,rt=0;rt<F.length;++rt){var et=F[rt];E?this.strokeText(r,o,et,k,h,b,S,T,M,P):this.fillText(r,o,et,k,h,v,m,_,w,T,M,P),$=r.measureText(c.substring(rt+1)).width,k+=W-$+g,W=$}r.textAlign=R}},{key:"fillText",value:function(r,o,c,l,u,d,h,g,v,m,_,b){rE(r,o,d,h,m,_,b,this.imagePool,!0);var S,w=!(0,be.Z)(g)&&g!==1;w&&(S=r.globalAlpha,r.globalAlpha=g*v),r.fillText(c,l,u),w&&(r.globalAlpha=S)}},{key:"strokeText",value:function(r,o,c,l,u,d,h,g,v,m){I1(r,o,d,g,v,m,this.imagePool,!0);var _,b=!(0,be.Z)(h)&&h!==1;b&&(_=r.globalAlpha,r.globalAlpha=h),r.strokeText(c,l,u),b&&(r.globalAlpha=_)}},{key:"drawTextDecorations",value:function(r,o,c,l,u,d,h,g,v,m){var _=o.textDecorationLine,b=o.textDecorationColor,S=o.textDecorationStyle,w=o.textDecorationThickness,E=w===void 0?1:w,T=o.textAlign,M=T===void 0?"start":T,P=o.lineWidth,R=P===void 0?1:P,k=o.metrics;if(!(!_||_==="none")){var F=k.lineMetrics,W=_.split(" ");switch(r.lineWidth=E,b&&(r.strokeStyle="rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", ").concat(b.alpha,")")),S){case"dashed":r.setLineDash([5,5]);break;case"dotted":r.setLineDash([2,2]);break;case"wavy":r.setLineDash([]);break;default:r.setLineDash([]);break}var $=h,rt=o.textBaseline,et=rt===void 0?"alphabetic":rt;et==="middle"?$+=-k.height/2-u/2:et==="bottom"||et==="alphabetic"||et==="ideographic"?$+=-k.height:(et==="top"||et==="hanging")&&($+=-u);for(var ut=0;ut<l.length;ut++){$+=u;var J=F[ut];if(J){var lt=R/2,vt=d,xt=d+J.width;M==="center"||M==="middle"?(vt=d-J.width/2,xt=d+J.width/2):(M==="right"||M==="end")&&(vt=d-J.width,xt=d),vt+=lt,xt+=lt;var Ht=(0,z0.Z)(W),gt;try{for(Ht.s();!(gt=Ht.n()).done;){var wt=gt.value,Wt=$;switch(wt){case"underline":Wt+=2;break;case"overline":Wt-=u-2;break;case"line-through":Wt-=u/2;break;default:continue}S==="wavy"?this.drawWavyLine(r,vt,xt,Wt):(r.beginPath(),r.moveTo(vt,Wt),r.lineTo(xt,Wt),r.stroke())}}catch(fe){Ht.e(fe)}finally{Ht.f()}}}r.setLineDash([])}}},{key:"drawWavyLine",value:function(r,o,c,l){var u=2,d=10,h=Math.floor((c-o)/d);r.beginPath(),r.moveTo(o,l);for(var g=0;g<h;g++){var v=o+g*d+d/4,m=l+u,_=o+g*d+d/2,b=l;r.quadraticCurveTo(v,m,_,b);var S=o+g*d+d*3/4,w=l-u,E=o+(g+1)*d,T=l;r.quadraticCurveTo(S,w,E,T)}r.stroke()}},{key:"drawToContext",value:function(r,o,c,l,u){this.render(r,o.parsedStyle,o,o.ownerDocument.defaultView.context,l,u)}}])}(Aa),ki=function(t){function e(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,kt.Z)(this,e),n=(0,C.Z)(this,e),n.name="canvas-renderer",n.options=r,n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"init",value:function(){var r,o=(0,ye.Z)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),c=this.context.imagePool,l=new Aa(c),u=(r={},(0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)(r,N.bn.CIRCLE,l),N.bn.ELLIPSE,l),N.bn.RECT,l),N.bn.IMAGE,new R1(c)),N.bn.TEXT,new Rd(c)),N.bn.LINE,l),N.bn.POLYLINE,l),N.bn.POLYGON,l),N.bn.PATH,l),N.bn.GROUP,void 0),(0,st.Z)((0,st.Z)((0,st.Z)(r,N.bn.HTML,void 0),N.bn.MESH,void 0),N.bn.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=u,this.context.styleRendererFactory=u,this.addRenderingPlugin(new nE(o))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(N.F6),H0=Object.freeze({__proto__:null,CircleRenderer:Aa,DefaultRenderer:Aa,EllipseRenderer:Aa,ImageRenderer:R1,LineRenderer:Aa,PathRenderer:Aa,Plugin:ki,PolygonRenderer:Aa,PolylineRenderer:Aa,RectRenderer:Aa,TextRenderer:Rd}),iE=jt.Ue(),oE=jt.Ue(),k1=jt.Ue(),O7=Be.create(),W0=function(){function t(){var e=this;(0,kt.Z)(this,t),this.isHit=function(n,r,o,c){var l=e.context.pointInPathPickerFactory[n.nodeName];if(l){var u=Be.invert(O7,o),d=jt.fF(oE,jt.t8(k1,r[0],r[1],0),u);if(l(n,new N.E9(d[0],d[1]),c,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(n,r){var o=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),c=e.context.pathGeneratorFactory[n.nodeName];return c&&(o.beginPath(),c(o,n.parsedStyle),o.closePath()),o.isPointInPath(r.x,r.y)}}return(0,oe.Z)(t,[{key:"apply",value:function(n,r){var o,c=this,l=n.renderingService,u=n.renderingContext;this.context=n,this.runtime=r;var d=(o=u.root)===null||o===void 0?void 0:o.ownerDocument;l.hooks.pick.tapPromise(t.tag,function(){var h=(0,C1.Z)((0,gc.Z)().mark(function g(v){return(0,gc.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",c.pick(d,v));case 1:case"end":return m.stop()}},g)}));return function(g){return h.apply(this,arguments)}}()),l.hooks.pickSync.tap(t.tag,function(h){return c.pick(d,h)})}},{key:"pick",value:function(n,r){var o=r.topmost,c=r.position,l=c.x,u=c.y,d=jt.t8(iE,l,u,0),h=n.elementsFromBBox(d[0],d[1],d[0],d[1]),g=[],v=(0,z0.Z)(h),m;try{for(v.s();!(m=v.n()).done;){var _=m.value,b=_.getWorldTransform(),S=this.isHit(_,d,b,!1);if(S){var w=(0,N.Oi)(_);if(w){var E=w.parsedStyle.clipPath,T=this.isHit(E,d,E.getWorldTransform(),!0);if(T){if(o)return r.picked=[_],r;g.push(_)}}else{if(o)return r.picked=[_],r;g.push(_)}}}}catch(M){v.e(M)}finally{v.f()}return r.picked=g,r}}])}();W0.tag="CanvasPicker";function kd(t,e,n){var r=t.parsedStyle,o=r.cx,c=o===void 0?0:o,l=r.cy,u=l===void 0?0:l,d=r.r,h=r.fill,g=r.stroke,v=r.lineWidth,m=v===void 0?1:v,_=r.increasedLineWidthForHitTesting,b=_===void 0?0:_,S=r.pointerEvents,w=S===void 0?"auto":S,E=(m+b)/2,T=(0,dl.TE)(c,u,e.x,e.y),M=(0,N.L1)(w,h,g),P=(0,te.Z)(M,2),R=P[0],k=P[1];return R&&k||n?T<=d+E:R?T<=d:k?T>=d-E&&T<=d+E:!1}function V0(t,e,n,r){return t/(n*n)+e/(r*r)}function aE(t,e,n){var r=t.parsedStyle,o=r.cx,c=o===void 0?0:o,l=r.cy,u=l===void 0?0:l,d=r.rx,h=r.ry,g=r.fill,v=r.stroke,m=r.lineWidth,_=m===void 0?1:m,b=r.increasedLineWidthForHitTesting,S=b===void 0?0:b,w=r.pointerEvents,E=w===void 0?"auto":w,T=e.x,M=e.y,P=(0,N.L1)(E,g,v),R=(0,te.Z)(P,2),k=R[0],F=R[1],W=(_+S)/2,$=(T-c)*(T-c),rt=(M-u)*(M-u);return k&&F||n?V0($,rt,d+W,h+W)<=1:k?V0($,rt,d,h)<=1:F?V0($,rt,d-W,h-W)>=1&&V0($,rt,d+W,h+W)<=1:!1}function vc(t,e,n,r,o,c){return o>=t&&o<=t+n&&c>=e&&c<=e+r}function sE(t,e,n,r,o,c,l){var u=o/2;return vc(t-u,e-u,n,o,c,l)||vc(t+n-u,e-u,o,r,c,l)||vc(t+u,e+r-u,n,o,c,l)||vc(t-u,e+u,o,r,c,l)}function wo(t,e,n,r,o,c,l,u){var d=(Math.atan2(u-e,l-t)+Math.PI*2)%(Math.PI*2),h={x:t+n*Math.cos(d),y:e+n*Math.sin(d)};return(0,dl.TE)(h.x,h.y,l,u)<=c/2}function mc(t,e,n,r,o,c,l){var u=Math.min(t,n),d=Math.max(t,n),h=Math.min(e,r),g=Math.max(e,r),v=o/2;return c>=u-v&&c<=d+v&&l>=h-v&&l<=g+v?(0,dl._x)(t,e,n,r,c,l)<=o/2:!1}function cE(t,e,n,r,o){var c=t.length;if(c<2)return!1;for(var l=0;l<c-1;l++){var u=t[l][0],d=t[l][1],h=t[l+1][0],g=t[l+1][1];if(mc(u,d,h,g,e,n,r))return!0}if(o){var v=t[0],m=t[c-1];if(mc(v[0],v[1],m[0],m[1],e,n,r))return!0}return!1}var E7=1e-6;function D1(t){return Math.abs(t)<E7?0:t<0?-1:1}function A7(t,e,n){return(n[0]-t[0])*(e[1]-t[1])===(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function Dd(t,e,n){var r=!1,o=t.length;if(o<=2)return!1;for(var c=0;c<o;c++){var l=t[c],u=t[(c+1)%o];if(A7(l,u,[e,n]))return!0;D1(l[1]-n)>0!=D1(u[1]-n)>0&&D1(e-(n-l[1])*(l[0]-u[0])/(l[1]-u[1])-l[0])<0&&(r=!r)}return r}function G0(t,e,n){for(var r=!1,o=0;o<t.length;o++){var c=t[o];if(r=Dd(c,e,n),r)break}return r}function Nd(t,e,n){var r=t.parsedStyle,o=r.x1,c=r.y1,l=r.x2,u=r.y2,d=r.lineWidth,h=d===void 0?1:d,g=r.increasedLineWidthForHitTesting,v=g===void 0?0:g,m=r.pointerEvents,_=m===void 0?"auto":m,b=r.fill,S=r.stroke,w=(0,N.L1)(_,b,S),E=(0,te.Z)(w,2),T=E[1];return!T&&!n||!h?!1:mc(o,c,l,u,h+v,e.x,e.y)}function lE(t,e,n,r,o){for(var c=!1,l=e/2,u=0;u<t.length;u++){var d=t[u],h=d.currentPoint,g=d.params,v=d.prePoint,m=d.box;if(!(m&&!vc(m.x-l,m.y-l,m.width+e,m.height+e,n,r)))switch(d.command){case"L":case"Z":if(c=mc(v[0],v[1],h[0],h[1],e,n,r),c)return!0;break;case"Q":var _=(0,dl.Y1)(v[0],v[1],g[1],g[2],g[3],g[4],n,r);if(c=_<=e/2,c)return!0;break;case"C":var b=(0,dl.ph)(v[0],v[1],g[1],g[2],g[3],g[4],g[5],g[6],n,r,o);if(c=b<=e/2,c)return!0;break;case"A":d.cubicParams||(d.cubicParams=(0,Mo.W)(v[0],v[1],g[1],g[2],g[3],g[4],g[5],g[6],g[7],void 0));for(var S=d.cubicParams,w=v,E=0;E<S.length;E+=6){var T=(0,dl.ph)(w[0],w[1],S[E],S[E+1],S[E+2],S[E+3],S[E+4],S[E+5],n,r,o);if(w=[S[E+4],S[E+5]],c=T<=e/2,c)return!0}break}}return c}function N1(t,e,n,r,o,c){var l=t.parsedStyle,u=l.lineWidth,d=u===void 0?1:u,h=l.increasedLineWidthForHitTesting,g=h===void 0?0:h,v=l.stroke,m=l.fill,_=l.d,b=l.pointerEvents,S=b===void 0?"auto":b,w=_.segments,E=_.hasArc,T=_.polylines,M=_.polygons,P=(0,N.L1)(S,(M==null?void 0:M.length)&&m,v),R=(0,te.Z)(P,2),k=R[0],F=R[1],W=(0,N.gz)(t),$=!1;return k||n?(E?$=r(t,e):$=G0(M,e.x,e.y)||G0(T,e.x,e.y),$):((F||n)&&($=lE(w,d+g,e.x,e.y,W)),$)}function uE(t,e,n){var r=t.parsedStyle,o=r.stroke,c=r.fill,l=r.lineWidth,u=l===void 0?1:l,d=r.increasedLineWidthForHitTesting,h=d===void 0?0:d,g=r.points,v=r.pointerEvents,m=v===void 0?"auto":v,_=(0,N.L1)(m,c,o),b=(0,te.Z)(_,2),S=b[0],w=b[1],E=!1;return(w||n)&&(E=cE(g.points,u+h,e.x,e.y,!0)),!E&&(S||n)&&(E=Dd(g.points,e.x,e.y)),E}function F1(t,e,n){var r=t.parsedStyle,o=r.lineWidth,c=o===void 0?1:o,l=r.increasedLineWidthForHitTesting,u=l===void 0?0:l,d=r.points,h=r.pointerEvents,g=h===void 0?"auto":h,v=r.fill,m=r.stroke,_=(0,N.L1)(g,v,m),b=(0,te.Z)(_,2),S=b[1];return!S&&!n||!c?!1:cE(d.points,c+u,e.x,e.y,!1)}function T7(t,e,n,r,o){var c=t.parsedStyle,l=c.radius,u=c.fill,d=c.stroke,h=c.lineWidth,g=h===void 0?1:h,v=c.increasedLineWidthForHitTesting,m=v===void 0?0:v,_=c.x,b=_===void 0?0:_,S=c.y,w=S===void 0?0:S,E=c.width,T=c.height,M=c.pointerEvents,P=M===void 0?"auto":M,R=(0,N.L1)(P,u,d),k=(0,te.Z)(R,2),F=k[0],W=k[1],$=l&&l.some(function(J){return J!==0}),rt=g+m;if($){var ut=!1;return(W||n)&&(ut=fE(b,w,E,T,l.map(function(J){return(0,se.Z)(J,0,Math.min(Math.abs(E)/2,Math.abs(T)/2))}),rt,e.x,e.y)),!ut&&(F||n)&&(ut=r(t,e)),ut}else{var et=rt/2;if(F&&W||n)return vc(b-et,w-et,E+et,T+et,e.x,e.y);if(F)return vc(b,w,E,T,e.x,e.y);if(W)return sE(b,w,E,T,rt,e.x,e.y)}return!1}function fE(t,e,n,r,o,c,l,u){var d=(0,te.Z)(o,4),h=d[0],g=d[1],v=d[2],m=d[3];return mc(t+h,e,t+n-g,e,c,l,u)||mc(t+n,e+g,t+n,e+r-v,c,l,u)||mc(t+n-v,e+r,t+m,e+r,c,l,u)||mc(t,e+r-m,t,e+h,c,l,u)||wo(t+n-g,e+g,g,1.5*Math.PI,2*Math.PI,c,l,u)||wo(t+n-v,e+r-v,v,0,.5*Math.PI,c,l,u)||wo(t+m,e+r-m,m,.5*Math.PI,Math.PI,c,l,u)||wo(t+h,e+h,h,Math.PI,1.5*Math.PI,c,l,u)}function M7(t,e,n,r,o,c){var l=t.parsedStyle,u=l.pointerEvents,d=u===void 0?"auto":u,h=l.x,g=h===void 0?0:h,v=l.y,m=v===void 0?0:v,_=l.width,b=l.height;if(d==="non-transparent-pixel"){var S=o.config.offscreenCanvas,w=c.offscreenCanvasCreator.getOrCreateCanvas(S),E=c.offscreenCanvasCreator.getOrCreateContext(S,{willReadFrequently:!0});w.width=_,w.height=b,o.defaultStyleRendererFactory[N.bn.IMAGE].render(E,(0,ye.Z)((0,ye.Z)({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0);var T=E.getImageData(e.x-g,e.y-m,1,1).data;return T.every(function(M){return M!==0})}return!0}function yc(t,e,n,r){var o=t.getGeometryBounds();return e.x>=o.min[0]&&e.y>=o.min[1]&&e.x<=o.max[0]&&e.y<=o.max[1]}var B1=function(t){function e(){var n;(0,kt.Z)(this,e);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=(0,C.Z)(this,e,[].concat(o)),n.name="canvas-picker",n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"init",value:function(){var r,o=(r={},(0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)(r,N.bn.CIRCLE,kd),N.bn.ELLIPSE,aE),N.bn.RECT,T7),N.bn.LINE,Nd),N.bn.POLYLINE,F1),N.bn.POLYGON,uE),N.bn.PATH,N1),N.bn.TEXT,yc),N.bn.GROUP,null),N.bn.IMAGE,M7),(0,st.Z)((0,st.Z)(r,N.bn.HTML,null),N.bn.MESH,null));this.context.pointInPathPickerFactory=o,this.addRenderingPlugin(new W0)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(N.F6),C7=Object.freeze({__proto__:null,Plugin:B1});function P7(t,e){var n=e.cx,r=n===void 0?0:n,o=e.cy,c=o===void 0?0:o,l=e.r;t.arc(r,c,l,0,Math.PI*2,!1)}function L7(t,e){var n=e.cx,r=n===void 0?0:n,o=e.cy,c=o===void 0?0:o,l=e.rx,u=e.ry;if(t.ellipse)t.ellipse(r,c,l,u,0,0,Math.PI*2,!1);else{var d=l>u?l:u,h=l>u?1:l/u,g=l>u?u/l:1;t.save(),t.scale(h,g),t.arc(r,c,d,0,Math.PI*2)}}function dE(t,e){var n=e.x1,r=e.y1,o=e.x2,c=e.y2,l=e.markerStart,u=e.markerEnd,d=e.markerStartOffset,h=e.markerEndOffset,g=0,v=0,m=0,_=0,b=0,S,w;l&&(0,N.RV)(l)&&d&&(S=o-n,w=c-r,b=Math.atan2(w,S),g=Math.cos(b)*(d||0),v=Math.sin(b)*(d||0)),u&&(0,N.RV)(u)&&h&&(S=n-o,w=r-c,b=Math.atan2(w,S),m=Math.cos(b)*(h||0),_=Math.sin(b)*(h||0)),t.moveTo(n+g,r+v),t.lineTo(o+m,c+_)}function I7(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.d,u=l.absolutePath,d=l.segments,h=0,g=0,v=0,m=0,_=0,b,S;if(n&&(0,N.RV)(n)&&o){var w=n.parentNode.getStartTangent(),E=(0,te.Z)(w,2),T=E[0],M=E[1];b=T[0]-M[0],S=T[1]-M[1],_=Math.atan2(S,b),h=Math.cos(_)*(o||0),g=Math.sin(_)*(o||0)}if(r&&(0,N.RV)(r)&&c){var P=r.parentNode.getEndTangent(),R=(0,te.Z)(P,2),k=R[0],F=R[1];b=k[0]-F[0],S=k[1]-F[1],_=Math.atan2(S,b),v=Math.cos(_)*(c||0),m=Math.sin(_)*(c||0)}for(var W=0;W<u.length;W++){var $=u[W],rt=$[0],et=u[W+1],ut=W===0&&(h!==0||g!==0),J=(W===u.length-1||et&&(et[0]==="M"||et[0]==="Z"))&&v!==0&&m!==0,lt=ut?[h,g]:[0,0],vt=(0,te.Z)(lt,2),xt=vt[0],Ht=vt[1],gt=J?[v,m]:[0,0],wt=(0,te.Z)(gt,2),Wt=wt[0],fe=wt[1];switch(rt){case"M":t.moveTo($[1]+xt,$[2]+Ht);break;case"L":t.lineTo($[1]+Wt,$[2]+fe);break;case"Q":t.quadraticCurveTo($[1],$[2],$[3]+Wt,$[4]+fe);break;case"C":t.bezierCurveTo($[1],$[2],$[3],$[4],$[5]+Wt,$[6]+fe);break;case"A":{var le=d[W].arcParams,Te=le.cx,Fe=le.cy,De=le.rx,Je=le.ry,qe=le.startAngle,We=le.endAngle,fn=le.xRotation,_n=le.sweepFlag;if(t.ellipse)t.ellipse(Te,Fe,De,Je,fn,qe,We,!!(1-_n));else{var An=De>Je?De:Je,xn=De>Je?1:De/Je,On=De>Je?Je/De:1;t.translate(Te,Fe),t.rotate(fn),t.scale(xn,On),t.arc(0,0,An,qe,We,!!(1-_n)),t.scale(1/xn,1/On),t.rotate(-fn),t.translate(-Te,-Fe)}J&&t.lineTo($[6]+v,$[7]+m);break}case"Z":t.closePath();break}}}function j1(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.points.points,u=l.length,d=l[0][0],h=l[0][1],g=l[u-1][0],v=l[u-1][1],m=0,_=0,b=0,S=0,w=0,E,T;n&&(0,N.RV)(n)&&o&&(E=l[1][0]-l[0][0],T=l[1][1]-l[0][1],w=Math.atan2(T,E),m=Math.cos(w)*(o||0),_=Math.sin(w)*(o||0)),r&&(0,N.RV)(r)&&c&&(E=l[u-1][0]-l[0][0],T=l[u-1][1]-l[0][1],w=Math.atan2(T,E),b=Math.cos(w)*(c||0),S=Math.sin(w)*(c||0)),t.moveTo(d+(m||b),h+(_||S));for(var M=1;M<u-1;M++){var P=l[M];t.lineTo(P[0],P[1])}t.lineTo(g,v)}function hE(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.points.points,u=l.length,d=l[0][0],h=l[0][1],g=l[u-1][0],v=l[u-1][1],m=0,_=0,b=0,S=0,w=0,E,T;n&&(0,N.RV)(n)&&o&&(E=l[1][0]-l[0][0],T=l[1][1]-l[0][1],w=Math.atan2(T,E),m=Math.cos(w)*(o||0),_=Math.sin(w)*(o||0)),r&&(0,N.RV)(r)&&c&&(E=l[u-2][0]-l[u-1][0],T=l[u-2][1]-l[u-1][1],w=Math.atan2(T,E),b=Math.cos(w)*(c||0),S=Math.sin(w)*(c||0)),t.moveTo(d+m,h+_);for(var M=1;M<u-1;M++){var P=l[M];t.lineTo(P[0],P[1])}t.lineTo(g+b,v+S)}function pE(t,e){var n=e.x,r=n===void 0?0:n,o=e.y,c=o===void 0?0:o,l=e.radius,u=e.width,d=e.height,h=u,g=d,v=l&&l.some(function(R){return R!==0});if(!v)t.rect(r,c,h,g);else{var m=u>0?1:-1,_=d>0?1:-1,b=m+_===0,S=l.map(function(R){return(0,se.Z)(R,0,Math.min(Math.abs(h)/2,Math.abs(g)/2))}),w=(0,te.Z)(S,4),E=w[0],T=w[1],M=w[2],P=w[3];t.moveTo(m*E+r,c),t.lineTo(h-m*T+r,c),T!==0&&t.arc(h-m*T+r,_*T+c,T,-_*Math.PI/2,m>0?0:Math.PI,b),t.lineTo(h+r,g-_*M+c),M!==0&&t.arc(h-m*M+r,g-_*M+c,M,m>0?0:Math.PI,_>0?Math.PI/2:1.5*Math.PI,b),t.lineTo(m*P+r,g+c),P!==0&&t.arc(m*P+r,g-_*P+c,P,_>0?Math.PI/2:-Math.PI/2,m>0?Math.PI:0,b),t.lineTo(r,_*E+c),E!==0&&t.arc(m*E+r,_*E+c,E,m>0?Math.PI:0,_>0?Math.PI*1.5:Math.PI/2,b)}}var $0=function(t){function e(){var n;(0,kt.Z)(this,e);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=(0,C.Z)(this,e,[].concat(o)),n.name="canvas-path-generator",n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"init",value:function(){var r,o=(r={},(0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)((0,st.Z)(r,N.bn.CIRCLE,P7),N.bn.ELLIPSE,L7),N.bn.RECT,pE),N.bn.LINE,dE),N.bn.POLYLINE,hE),N.bn.POLYGON,j1),N.bn.PATH,I7),N.bn.TEXT,void 0),N.bn.GROUP,void 0),N.bn.IMAGE,void 0),(0,st.Z)((0,st.Z)((0,st.Z)(r,N.bn.HTML,void 0),N.bn.MESH,void 0),N.bn.FRAGMENT,void 0));this.context.pathGeneratorFactory=o}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(N.F6),xF=Object.freeze({__proto__:null,Plugin:$0}),gE=function(){function t(e){(0,kt.Z)(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return(0,oe.Z)(t,[{key:"init",value:function(){var n=this.canvasConfig,r=n.container,o=n.canvas;if(o)this.$canvas=o,r&&o.parentElement!==r&&r.appendChild(o),this.$container=o.parentElement,this.canvasConfig.container=this.$container;else if(r&&(this.$container=(0,Ze.Z)(r)?document.getElementById(r):r,this.$container)){var c=document.createElement("canvas");this.$container.appendChild(c),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=c}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(n,r){var o=this.canvasConfig.devicePixelRatio;this.dpr=o,this.$canvas&&(this.$canvas.width=this.dpr*n,this.$canvas.height=this.dpr*r,(0,N.$p)(this.$canvas,n,r)),this.renderingContext.renderReasons.add(N.Rr.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(n){this.$container&&this.$container.style&&(this.$container.style.cursor=n)}},{key:"toDataURL",value:function(){var e=(0,C1.Z)((0,gc.Z)().mark(function r(){var o,c,l,u=arguments;return(0,gc.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=u.length>0&&u[0]!==void 0?u[0]:{},c=o.type,l=o.encoderOptions,d.abrupt("return",this.context.canvas.toDataURL(c,l));case 1:case"end":return d.stop()}},r,this)}));function n(){return e.apply(this,arguments)}return n}()}])}(),vE=function(t){function e(){var n;(0,kt.Z)(this,e);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=(0,C.Z)(this,e,[].concat(o)),n.name="canvas-context-register",n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"init",value:function(){this.context.ContextService=gE}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(N.F6),mE=function(t){function e(n){var r;return(0,kt.Z)(this,e),r=(0,C.Z)(this,e,[n]),r.registerPlugin(new vE),r.registerPlugin(new N.S3.Plugin),r.registerPlugin(new $0),r.registerPlugin(new ki),r.registerPlugin(new N.sC.Plugin),r.registerPlugin(new B1),r.registerPlugin(new N.MD.Plugin),r}return(0,z.Z)(e,t),(0,oe.Z)(e)}(N.I8),yE=L(44078);var z1=function(){function t(e){(0,kt.Z)(this,t),this.dragndropPluginOptions=e}return(0,oe.Z)(t,[{key:"apply",value:function(n){var r=this,o=n.renderingService,c=n.renderingContext,l=c.root.ownerDocument,u=l.defaultView,d=function(g){var v=g.target,m=v===l,_=m&&r.dragndropPluginOptions.isDocumentDraggable?l:v.closest&&v.closest("[draggable=true]");if(_){var b=!1,S=g.timeStamp,w=[g.clientX,g.clientY],E=null,T=[g.clientX,g.clientY],M=function(){var R=(0,C1.Z)((0,gc.Z)().mark(function k(F){var W,$,rt,et,ut,J;return(0,gc.Z)().wrap(function(lt){for(;;)switch(lt.prev=lt.next){case 0:if(b){lt.next=2;break}if(W=F.timeStamp-S,$=(0,yE.y)([F.clientX,F.clientY],w),!(W<=r.dragndropPluginOptions.dragstartTimeThreshold||$<=r.dragndropPluginOptions.dragstartDistanceThreshold)){lt.next=1;break}return lt.abrupt("return");case 1:F.type="dragstart",_.dispatchEvent(F),b=!0;case 2:if(F.type="drag",F.dx=F.clientX-T[0],F.dy=F.clientY-T[1],_.dispatchEvent(F),T=[F.clientX,F.clientY],m){lt.next=4;break}return rt=r.dragndropPluginOptions.overlap==="pointer"?[F.canvasX,F.canvasY]:v.getBounds().center,lt.next=3,l.elementsFromPoint(rt[0],rt[1]);case 3:et=lt.sent,ut=et[et.indexOf(v)+1],J=(ut==null?void 0:ut.closest("[droppable=true]"))||(r.dragndropPluginOptions.isDocumentDroppable?l:null),E!==J&&(E&&(F.type="dragleave",F.target=E,E.dispatchEvent(F)),J&&(F.type="dragenter",F.target=J,J.dispatchEvent(F)),E=J,E&&(F.type="dragover",F.target=E,E.dispatchEvent(F)));case 4:case"end":return lt.stop()}},k)}));return function(F){return R.apply(this,arguments)}}();u.addEventListener("pointermove",M);var P=function(k){if(b){k.detail={preventClick:!0};var F=k.clone();E&&(F.type="drop",F.target=E,E.dispatchEvent(F)),F.type="dragend",_.dispatchEvent(F),b=!1}u.removeEventListener("pointermove",M)};v.addEventListener("pointerup",P,{once:!0}),v.addEventListener("pointerupoutside",P,{once:!0})}};o.hooks.init.tap(t.tag,function(){u.addEventListener("pointerdown",d)}),o.hooks.destroy.tap(t.tag,function(){u.removeEventListener("pointerdown",d)})}}])}();z1.tag="Dragndrop";var U1=function(t){function e(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,kt.Z)(this,e),n=(0,C.Z)(this,e),n.name="dragndrop",n.options=r,n}return(0,z.Z)(e,t),(0,oe.Z)(e,[{key:"init",value:function(){this.addRenderingPlugin(new z1((0,ye.Z)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(r){Object.assign(this.plugins[0].dragndropPluginOptions,r)}}])}(N.F6);function Z1(t,e,n){var r;return function(){var o=this,c=arguments,l=function(){r=null,n||t.apply(o,c)},u=n&&!r;clearTimeout(r),r=setTimeout(l,e),u&&t.apply(o,c)}}var H1=Z1,er=function(t,e,n){for(var r=0,o=(0,Ze.Z)(e)?e.split("."):e;t&&r<o.length;)t=t[o[r++]];return t===void 0||r<o.length?n:t};class W1 extends Map{constructor(e,n=G1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,o]of e)this.set(r,o)}get(e){return super.get(Fd(this,e))}has(e){return super.has(Fd(this,e))}set(e,n){return super.set(bE(this,e),n)}delete(e){return super.delete(V1(this,e))}}class _E extends null{constructor(e,n=G1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const r of e)this.add(r)}has(e){return super.has(Fd(this,e))}add(e){return super.add(bE(this,e))}delete(e){return super.delete(V1(this,e))}}function Fd({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function bE({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function V1({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function G1(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Hu(t){return t}function $r(t,...e){return Ta(t,Hu,Hu,e)}function Wu(t,...e){return Ta(t,Array.from,Hu,e)}function $1(t,e){for(let n=1,r=e.length;n<r;++n)t=t.flatMap(o=>o.pop().map(([c,l])=>[...o,c,l]));return t}function R7(t,...e){return $1(Wu(t,...e),e)}function Y1(t,e,...n){return $1(Y0(t,e,...n),n)}function Bd(t,e,...n){return Ta(t,Hu,e,n)}function Y0(t,e,...n){return Ta(t,Array.from,e,n)}function k7(t,...e){return Ta(t,identity,jd,e)}function No(t,...e){return Ta(t,Array.from,jd,e)}function jd(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function Ta(t,e,n,r){return function o(c,l){if(l>=r.length)return n(c);const u=new W1,d=r[l++];let h=-1;for(const g of c){const v=d(g,++h,c),m=u.get(v);m?m.push(g):u.set(v,[g])}for(const[g,v]of u)u.set(g,o(v,l));return e(u)}(t,0)}var Br=L(5199),X1=function(t){return typeof t=="object"&&t!==null},zd=X1,Ud=L(95456),xE=function(t){if(!zd(t)||!(0,Ud.Z)(t,"Object"))return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},is=xE,SE=5;function q1(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(t==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function Zd(t,e,n,r){n=n||0,r=r||SE;for(var o in e)if(q1(e,o)){var c=e[o];c!==null&&is(c)?(is(t[o])||(t[o]={}),n<r?Zd(t[o],c,n+1,r):t[o]=e[o]):(0,Br.Z)(c)?(t[o]=[],t[o]=t[o].concat(c)):c!==void 0&&(t[o]=c)}}var D7=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Zd(t,e[r]);return t},nn=D7,K1=function(t){return(0,be.Z)(t)?"":t.toString()},wE=function(t){var e=K1(t);return e.charAt(0).toLowerCase()+e.substring(1)},Q1=wE;function J1({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function X0({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function t_({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function e_(t){return typeof t=="object"?t.valueOf():t}class n_ extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=e_,e!==null)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(J1({map:this.map,initKey:this.initKey},e))}has(e){return super.has(J1({map:this.map,initKey:this.initKey},e))}set(e,n){return super.set(X0({map:this.map,initKey:this.initKey},e),n)}delete(e){return super.delete(t_({map:this.map,initKey:this.initKey},e))}}class Vu{transformBreaks(e){return e}constructor(e){var n;this.options=nn({},this.getDefaultOptions()),this.update(!((n=e==null?void 0:e.breaks)===null||n===void 0)&&n.length?this.transformBreaks(e):e)}getOptions(){return this.options}update(e={}){const n=e.breaks?this.transformBreaks(e):e;this.options=nn({},this.options,n),this.rescale(n)}rescale(e){}}const Hd=Symbol("defaultUnknown");function r_(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function i_(t){const{value:e,from:n,to:r,mapper:o,notFoundReturn:c}=t;let l=o.get(e);if(l===void 0){if(c!==Hd)return c;l=n.push(e)-1,o.set(e,l)}return r[l%r.length]}function o_(t){return t instanceof Date?e=>`${e}`:typeof t=="object"?e=>JSON.stringify(e):e=>e}class Wd extends Vu{getDefaultOptions(){return{domain:[],range:[],unknown:Hd}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&r_(this.domainIndexMap,this.getDomain(),this.domainKey),i_({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&r_(this.rangeIndexMap,this.getRange(),this.rangeKey),i_({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=o_(n),this.rangeKey=o_(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new Wd(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:n}=this.options;return this.sortedDomain=n?[...e].sort(n):e,this.sortedDomain}}function OE(t){const e=t.reduce((n,r)=>Math.min(n,r),1/0);return e===1/0?[]:t.map(n=>n/e)}function EE(t,e){const n=t.length,r=e-n;return r>0?[...t,...new Array(r).fill(1)]:r<0?t.slice(0,e):t}function a_(t){return Math.round(t*1e12)/1e12}function AE(t){const{domain:e,range:n,paddingOuter:r,paddingInner:o,flex:c,round:l,align:u}=t,d=e.length,h=EE(c,d),[g,v]=n,m=v-g,_=2/d*r+1-1/d*o,b=m/_,S=b*o/d,w=b-d*S,E=OE(h),T=E.reduce((ut,J)=>ut+J),M=w/T,P=new n_(e.map((ut,J)=>{const lt=E[J]*M;return[ut,l?Math.floor(lt):lt]})),R=new n_(e.map((ut,J)=>{const vt=E[J]*M+S;return[ut,l?Math.floor(vt):vt]})),k=Array.from(R.values()).reduce((ut,J)=>ut+J),W=(m-(k-k/d*o))*u,$=g+W;let rt=l?Math.round($):$;const et=new Array(d);for(let ut=0;ut<d;ut+=1){et[ut]=a_(rt);const J=e[ut];rt+=R.get(J)}return{valueBandWidth:P,valueStep:R,adjustedRange:et}}function TE(t){var e;const{domain:n}=t,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=t.flex)===null||e===void 0)&&e.length))return AE(t);const{range:c,paddingOuter:l,paddingInner:u,round:d,align:h}=t;let g,v,m=c[0];const b=c[1]-m,S=l*2,w=r-u;g=b/Math.max(1,S+w),d&&(g=Math.floor(g)),m+=(b-g*(r-u))*h,v=g*(1-u),d&&(m=Math.round(m),v=Math.round(v));const E=new Array(r).fill(0).map((T,M)=>m+M*g);return{valueStep:g,valueBandWidth:v,adjustedRange:E}}class Ms extends Wd{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:Hd,flex:[]}}constructor(e){super(e)}clone(){return new Ms(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:n}=this.options;return e>0?e:n}getPaddingOuter(){const{padding:e,paddingOuter:n}=this.options;return e>0?e:n}rescale(){super.rescale();const{align:e,domain:n,range:r,round:o,flex:c}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:d}=TE({align:e,range:r,round:o,flex:c,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=d,this.valueBandWidth=u,this.adjustedRange=l}}const Vd=Math.sqrt(50),q0=Math.sqrt(10),K0=Math.sqrt(2);function Gd(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),c=r/Ai(10,o);return o>=0?(c>=Vd?10:c>=q0?5:c>=K0?2:1)*Ai(10,o):-Ai(10,-o)/(c>=Vd?10:c>=q0?5:c>=K0?2:1)}function s_(t,e,n){const r=Math.abs(e-t)/Math.max(0,n);let o=Ai(10,Math.floor(Math.log(r)/Math.LN10));const c=r/o;return c>=Vd?o*=10:c>=q0?o*=5:c>=K0&&(o*=2),e<t?-o:o}const N7=(t,e)=>{if(!(e!=null&&e.length))return t;const n=[...t,...e.flatMap(c=>[c.start,c.end])],o=Array.from(new Set(n)).sort((c,l)=>c-l).filter(c=>!e.some(({start:l,end:u})=>c>l&&c<u));return o.length?o:t},os=(t,e,n,r)=>{let o,c,l=t,u=e;if(l===u&&n>0)return[l];let d=Gd(l,u,n);if(d===0||!Number.isFinite(d))return[];if(d>0){l=Math.ceil(l/d),u=Math.floor(u/d),c=new Array(o=Math.ceil(u-l+1));for(let h=0;h<o;h+=1)c[h]=(l+h)*d}else{d=-d,l=Math.ceil(l*d),u=Math.floor(u*d),c=new Array(o=Math.ceil(u-l+1));for(let h=0;h<o;h+=1)c[h]=(l+h)/d}return N7(c,r)};class Ma extends Vu{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:os}}map(e){const[n]=this.options.range;return n!==void 0?n:this.options.unknown}invert(e){const[n]=this.options.range;return e===n&&n!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:e,domain:n,tickCount:r}=this.options,[o,c]=n;return!(0,Se.Z)(o)||!(0,Se.Z)(c)?[]:e(o,c,r)}clone(){return new Ma(this.options)}}var ME=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};function pl(t){var e;let n=t;for(;n;){if(((e=n.attributes)===null||e===void 0?void 0:e.class)==="view")return n;n=n.parentNode}return null}function $d(t){const{markType:e,nodeName:n}=t;return e==="heatmap"&&n==="image"}function Q0(t,e){const n=e!=null?e:pl(t).__data__,r=t.__data__,{markKey:o,index:c,seriesIndex:l,normalized:u={x:0}}=r,{markState:d}=n,h=Array.from(d.keys()).find(g=>g.key===o);if(h)return l?l.map(g=>h.data[g]):$d(t)?h.data[Math.round(h.data.length*u.x)]:h.data[c]}function F7(t){const e=pl(t).__data__,{scale:n}=e;return PE(n,t.__data__)}function CE(t,e){var n,r,o,c;const l=(n=e.markKey)!==null&&n!==void 0?n:(o=(r=e.element)===null||r===void 0?void 0:r.__data__)===null||o===void 0?void 0:o.markKey,u=Object.keys(t).find(d=>{if(d.startsWith("series")){const h=t[d].getOptions();return h.name==="series"&&h.markKey===l}});return(c=t[u])!==null&&c!==void 0?c:t.series}function PE(t,e){const{color:n,facet:r=!1}=t,{color:o,series:c}=e,l=CE(t,e),u=d=>d&&d.invert&&!(d instanceof Ms)&&!(d instanceof Ma);if(u(l))return l.clone().invert(c);if(c&&l instanceof Ms&&l.invert(c)!==o&&!r)return l.invert(c);if(u(n)){const d=n.invert(o);return Array.isArray(d)?null:d}return null}function Cs(t){return t}function Gu(t){return t.reduce((e,n)=>(r,...o)=>n(e(r,...o),...o),Cs)}function gl(t){return t.reduce((e,n)=>r=>ME(this,void 0,void 0,function*(){const o=yield e(r);return n(o)}),Cs)}function J0(t){return t.replace(/( |^)[a-z]/g,e=>e.toUpperCase())}function vl(t=""){throw new Error(t)}function Yd(t,e){const{attributes:n}=e,r=new Set(["id","className"]);for(const[o,c]of Object.entries(n))r.has(o)||t.attr(o,c)}function Ur(t){return t!=null&&!Number.isNaN(t)}function B7(t,e){return t+(e-t)*Math.random()}function LE(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const r=t(n);return e.set(n,r),r}}function c_(t,e){const{transform:n}=t.style,o=(c=>c==="none"||c===void 0)(n)?"":n;t.style.transform=`${o} ${e}`.trimStart()}function wn(t,e){return tg(t,e)||{}}function tg(t,e){const n=Object.entries(t||{}).filter(([r])=>r.startsWith(e)).map(([r,o])=>[Q1(r.replace(e,"").trim()),o]).filter(([r])=>!!r);return n.length===0?null:Object.fromEntries(n)}function IE(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[`${e}${upperFirst(n)}`,r]))}function RE(t,e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.find(r=>n.startsWith(r))))}function Xd(t,...e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.every(r=>!n.startsWith(r))))}function l_(t,e){if(t===void 0)return null;if(typeof t=="number")return t;const n=+t.replace("%","");return Number.isNaN(n)?null:n/100*e}function ml(t){return typeof t=="object"&&!(t instanceof Date)&&t!==null&&!Array.isArray(t)}function Ca(t){return t===null||t===!1}function u_(t,e,n=5,r=0){if(!(r>=n)){for(const o of Object.keys(e)){const c=e[o];!is(c)||!is(t[o])?t[o]=c:u_(t[o],c,n,r+1)}return t}}function Kn(t){return new Mi([t],null,t,t.ownerDocument)}class Mi{constructor(e=null,n=null,r=null,o=null,c=[null,null,null,null,null],l=[],u=[]){this._elements=Array.from(e),this._data=n,this._parent=r,this._document=o,this._enter=c[0],this._update=c[1],this._exit=c[2],this._merge=c[3],this._split=c[4],this._transitions=l,this._facetElements=u}selectAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new Mi(n,null,this._elements[0],this._document)}selectFacetAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new Mi(this._elements,null,this._parent,this._document,void 0,void 0,n)}select(e){const n=typeof e=="string"?this._parent.querySelectorAll(e)[0]||null:e;return new Mi([n],null,n,this._document)}append(e){const n=typeof e=="function"?e:()=>this.createElement(e),r=[];if(this._data!==null){for(let o=0;o<this._data.length;o++){const c=this._data[o],[l,u]=Array.isArray(c)?c:[c,null],d=n(l,o);d.__data__=l,u!==null&&(d.__fromElements__=u),this._parent.appendChild(d),r.push(d)}return new Mi(r,null,this._parent,this._document)}else{for(let o=0;o<this._elements.length;o++){const c=this._elements[o],l=c.__data__,u=n(l,o);c.appendChild(u),r.push(u)}return new Mi(r,null,r[0],this._document)}}maybeAppend(e,n,r){const o=this._elements[0],c=o.getElementById(e);if(c)return new Mi([c],null,this._parent,this._document);const l=typeof n=="string"?this.createElement(n):n();return l.id=e,r&&(l.className=r),o.appendChild(l),new Mi([l],null,this._parent,this._document)}data(e,n=o=>o,r=()=>null){const o=[],c=[],l=new Set(this._elements),u=[],d=new Set,h=new Map(this._elements.map((_,b)=>[n(_.__data__,b),_])),g=new Map(this._facetElements.map((_,b)=>[n(_.__data__,b),_])),v=$r(this._elements,_=>r(_.__data__));for(let _=0;_<e.length;_++){const b=e[_],S=n(b,_),w=r(b,_);if(h.has(S)){const E=h.get(S);E.__data__=b,E.__facet__=!1,c.push(E),l.delete(E),h.delete(S)}else if(g.has(S)){const E=g.get(S);E.__data__=b,E.__facet__=!0,c.push(E),g.delete(S)}else if(v.has(S)){const E=v.get(S);u.push([b,E]);for(const T of E)l.delete(T);v.delete(S)}else if(h.has(w)){const E=h.get(w);E.__toData__?E.__toData__.push(b):E.__toData__=[b],d.add(E),l.delete(E)}else o.push(b)}const m=[new Mi([],o,this._parent,this._document),new Mi(c,null,this._parent,this._document),new Mi(l,null,this._parent,this._document),new Mi([],u,this._parent,this._document),new Mi(d,null,this._parent,this._document)];return new Mi(this._elements,null,this._parent,this._document,m)}merge(e){const n=[...this._elements,...e._elements],r=[...this._transitions,...e._transitions];return new Mi(n,null,this._parent,this._document,void 0,r)}createElement(e){if(this._document)return this._document.createElement(e,{});const n=Mi.registry[e];return n?new n:vl(`Unknown node type: ${e}`)}join(e=l=>l,n=l=>l,r=l=>l.remove(),o=l=>l,c=l=>l.remove()){const l=e(this._enter),u=n(this._update),d=r(this._exit),h=o(this._merge),g=c(this._split);return u.merge(l).merge(d).merge(h).merge(g)}remove(){for(let e=0;e<this._elements.length;e++){const n=this._transitions[e];if(this._elements[e].__removed__=!0,n){const r=Array.isArray(n)?n:[n];Promise.all(r.map(o=>o.finished)).then(()=>{const o=this._elements[e];o.__removed__&&o.remove()})}else{const r=this._elements[e];r.__removed__&&r.remove()}}return new Mi([],null,this._parent,this._document,void 0,this._transitions)}each(e){for(let n=0;n<this._elements.length;n++){const r=this._elements[n],o=r.__data__;e(o,n,r)}return this}attr(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(o,c,l){n!==void 0&&(l[e]=r(o,c,l))})}style(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(o,c,l){n!==void 0&&(l.style[e]=r(o,c,l))})}transition(e){const n=typeof e!="function"?()=>e:e,{_transitions:r}=this;return this.each(function(o,c,l){r[c]=n(o,c,l)})}on(e,n){return this.each(function(r,o,c){c.addEventListener(e,n)}),this}call(e,...n){return e(this,...n),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}Mi.registry={g:N.ZA,rect:N.UL,circle:N.Cd,path:N.y$,text:N.xv,ellipse:N.Pj,image:N.Ee,line:N.x1,polygon:N.mg,polyline:N.aH,html:N.k9};const Ir={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"},f_={abs:Math.abs,ceil:Math.ceil,floor:Math.floor,max:Math.max,min:Math.min,round:Math.round,sqrt:Math.sqrt,pow:Math.pow};function j7(t,e){f_[t]=e}class zi extends Error{constructor(e,n,r){super(e),this.position=n,this.token=r,this.name="ExpressionError"}}var rr;(function(t){t[t.STRING=0]="STRING",t[t.NUMBER=1]="NUMBER",t[t.BOOLEAN=2]="BOOLEAN",t[t.NULL=3]="NULL",t[t.IDENTIFIER=4]="IDENTIFIER",t[t.OPERATOR=5]="OPERATOR",t[t.FUNCTION=6]="FUNCTION",t[t.DOT=7]="DOT",t[t.BRACKET_LEFT=8]="BRACKET_LEFT",t[t.BRACKET_RIGHT=9]="BRACKET_RIGHT",t[t.PAREN_LEFT=10]="PAREN_LEFT",t[t.PAREN_RIGHT=11]="PAREN_RIGHT",t[t.COMMA=12]="COMMA",t[t.QUESTION=13]="QUESTION",t[t.COLON=14]="COLON",t[t.DOLLAR=15]="DOLLAR"})(rr||(rr={}));const eg=new Set([32,9,10,13]),kE=new Set([43,45,42,47,37,33,38,124,61,60,62]),$u=new Map([["true",rr.BOOLEAN],["false",rr.BOOLEAN],["null",rr.NULL]]),ng=new Map([["===",!0],["!==",!0],["<=",!0],[">=",!0],["&&",!0],["||",!0],["+",!0],["-",!0],["*",!0],["/",!0],["%",!0],["!",!0],["<",!0],[">",!0]]),rg=new Map([[46,rr.DOT],[91,rr.BRACKET_LEFT],[93,rr.BRACKET_RIGHT],[40,rr.PAREN_LEFT],[41,rr.PAREN_RIGHT],[44,rr.COMMA],[63,rr.QUESTION],[58,rr.COLON],[36,rr.DOLLAR]]),d_=new Map;for(const[t,e]of rg.entries())d_.set(t,{type:e,value:String.fromCharCode(t)});function Ps(t){return t>=48&&t<=57}function qd(t){return t>=97&&t<=122||t>=65&&t<=90||t===95}function Kd(t){return qd(t)||Ps(t)}function ig(t){return kE.has(t)}var yi;(function(t){t[t.Program=0]="Program",t[t.Literal=1]="Literal",t[t.Identifier=2]="Identifier",t[t.MemberExpression=3]="MemberExpression",t[t.CallExpression=4]="CallExpression",t[t.BinaryExpression=5]="BinaryExpression",t[t.UnaryExpression=6]="UnaryExpression",t[t.ConditionalExpression=7]="ConditionalExpression"})(yi||(yi={}));const h_=new Map([["||",2],["&&",3],["===",4],["!==",4],[">",5],[">=",5],["<",5],["<=",5],["+",6],["-",6],["*",7],["/",7],["%",7],["!",8]]),as={type:yi.Literal,value:null},DE={type:yi.Literal,value:!0},p_={type:yi.Literal,value:!1},g_=t=>{let e=0;const n=t.length,r=()=>e>=n?null:t[e],o=()=>t[e++],c=v=>{const m=r();return m!==null&&m.type===v},l=v=>v.type===rr.OPERATOR?h_.get(v.value)||-1:v.type===rr.DOT||v.type===rr.BRACKET_LEFT?9:v.type===rr.QUESTION?1:-1,u=v=>{let m,_;if(o().type===rr.DOT){if(!c(rr.IDENTIFIER)){const S=r();throw new zi("Expected property name",e,S?S.value:"<end of input>")}const b=o();m={type:yi.Identifier,name:b.value},_=!1}else{if(m=h(0),!c(rr.BRACKET_RIGHT)){const b=r();throw new zi("Expected closing bracket",e,b?b.value:"<end of input>")}o(),_=!0}return{type:yi.MemberExpression,object:v,property:m,computed:_}},d=()=>{const v=r();if(!v)throw new zi("Unexpected end of input",e,"<end of input>");if(v.type===rr.OPERATOR&&(v.value==="!"||v.value==="-")){o();const m=d();return{type:yi.UnaryExpression,operator:v.value,argument:m,prefix:!0}}switch(v.type){case rr.NUMBER:return o(),{type:yi.Literal,value:Number(v.value)};case rr.STRING:return o(),{type:yi.Literal,value:v.value};case rr.BOOLEAN:return o(),v.value==="true"?DE:p_;case rr.NULL:return o(),as;case rr.IDENTIFIER:return o(),{type:yi.Identifier,name:v.value};case rr.FUNCTION:return(()=>{const m=o(),_=[];if(!c(rr.PAREN_LEFT)){const b=r();throw new zi("Expected opening parenthesis after function name",e,b?b.value:"<end of input>")}for(o();;){if(c(rr.PAREN_RIGHT)){o();break}if(!r()){const S=r();throw new zi("Expected closing parenthesis",e,S?S.value:"<end of input>")}if(_.length>0){if(!c(rr.COMMA)){const S=r();throw new zi("Expected comma between function arguments",e,S?S.value:"<end of input>")}o()}const b=h(0);_.push(b)}return{type:yi.CallExpression,callee:{type:yi.Identifier,name:m.value},arguments:_}})();case rr.PAREN_LEFT:{o();const m=h(0);if(!c(rr.PAREN_RIGHT)){const _=r();throw new zi("Expected closing parenthesis",e,_?_.value:"<end of input>")}return o(),m}default:throw new zi(`Unexpected token: ${v.type}`,e,v.value)}},h=(v=0)=>{let m=d();for(;e<n;){const _=t[e],b=l(_);if(b<=v)break;if(_.type!==rr.QUESTION)if(_.type!==rr.OPERATOR){if(_.type!==rr.DOT&&_.type!==rr.BRACKET_LEFT)break;m=u(m)}else{o();const S=h(b);m={type:yi.BinaryExpression,operator:_.value,left:m,right:S}}else{o();const S=h(0);if(!c(rr.COLON)){const E=r();throw new zi("Expected : in conditional expression",e,E?E.value:"<end of input>")}o();const w=h(0);m={type:yi.ConditionalExpression,test:m,consequent:S,alternate:w}}}return m},g=h();return{type:yi.Program,body:g}},og=(t,e,n)=>{let r=e;n&&(r=fc(To({},e),{context:To(To({},e.context),n)}));const o=c=>{switch(c.type){case yi.Literal:return(l=>l.value)(c);case yi.Identifier:return(l=>{if(!(l.name in r.context))throw new zi(`Undefined variable: ${l.name}`);return r.context[l.name]})(c);case yi.MemberExpression:return(l=>{const u=o(l.object);if(u==null)throw new zi("Cannot access property of null or undefined");return u[l.computed?o(l.property):l.property.name]})(c);case yi.CallExpression:return(l=>{const u=r.functions[l.callee.name];if(!u)throw new zi(`Undefined function: ${l.callee.name}`);return u(...l.arguments.map(d=>o(d)))})(c);case yi.BinaryExpression:return(l=>{if(l.operator==="&&"){const h=o(l.left);return h&&o(l.right)}if(l.operator==="||")return o(l.left)||o(l.right);const u=o(l.left),d=o(l.right);switch(l.operator){case"+":return u+d;case"-":return u-d;case"*":return u*d;case"/":return u/d;case"%":return u%d;case"===":return u===d;case"!==":return u!==d;case">":return u>d;case">=":return u>=d;case"<":return u<d;case"<=":return u<=d;default:throw new zi(`Unknown operator: ${l.operator}`)}})(c);case yi.UnaryExpression:return(l=>{const u=o(l.argument);if(l.prefix)switch(l.operator){case"!":return!u;case"-":if(typeof u!="number")throw new zi(`Cannot apply unary - to non-number: ${u}`);return-u;default:throw new zi(`Unknown operator: ${l.operator}`)}throw new zi(`Postfix operators are not supported: ${l.operator}`)})(c);case yi.ConditionalExpression:return(l=>{const u=o(l.test);return o(u?l.consequent:l.alternate)})(c);default:throw new zi(`Evaluation error: Unsupported node type: ${c.type}`)}};return o(t.body)};function Qd(t){const e=(o=>{const c=o,l=c.length,u=new Array(Math.ceil(l/3));let d=0,h=0;function g(w){const E=h+1;h++;let T="",M=!1;for(;h<l;){const P=c.charCodeAt(h);if(P===w)return M||(T=c.substring(E,h)),h++,{type:rr.STRING,value:T};P===92?(M||(T=c.substring(E,h),M=!0),h++,T+=c[h]):M&&(T+=c[h]),h++}throw new zi(`Unterminated string starting with ${String.fromCharCode(w)}`,h,c.substring(Math.max(0,h-10),h))}function v(){const w=h;for(c.charCodeAt(h)===45&&h++;h<l&&Ps(c.charCodeAt(h));)h++;if(h<l&&c.charCodeAt(h)===46)for(h++;h<l&&Ps(c.charCodeAt(h));)h++;const E=c.slice(w,h);return{type:rr.NUMBER,value:E}}function m(){h++;const w=h;if(h<l&&qd(c.charCodeAt(h)))for(h++;h<l&&Kd(c.charCodeAt(h));)h++;const E=c.slice(w,h);return{type:rr.FUNCTION,value:E}}function _(){const w=h++;for(;h<l&&Kd(c.charCodeAt(h));)h++;const E=c.slice(w,h),T=$u.get(E);return T?{type:T,value:E}:{type:rr.IDENTIFIER,value:E}}function b(){if(h+2<l){const E=c.substring(h,h+3);if(ng.has(E))return h+=3,{type:rr.OPERATOR,value:E}}if(h+1<l){const E=c.substring(h,h+2);if(ng.has(E))return h+=2,{type:rr.OPERATOR,value:E}}const w=c[h];if(ng.has(w))return h++,{type:rr.OPERATOR,value:w};throw new zi(`Unknown operator at position ${h}: ${c.substring(h,h+1)}`,h,c.substring(Math.max(0,h-10),h))}for(;h<l;){const w=c.charCodeAt(h);if(S=w,eg.has(S)){h++;continue}const E=d_.get(w);if(E)u[d++]=E,h++;else if(w!==34&&w!==39)if(Ps(w)||w===45&&h+1<l&&Ps(c.charCodeAt(h+1)))u[d++]=v();else if(w!==64)if(qd(w))u[d++]=_();else{if(!ig(w))throw new zi(`Unexpected character: ${c[h]}`,h,c.substring(Math.max(0,h-10),h));u[d++]=b()}else u[d++]=m();else u[d++]=g(w)}var S;return d===u.length?u:u.slice(0,d)})(t),n=g_(e),r=((o={},c={})=>({context:o,functions:c}))({},f_);return(o={})=>og(n,r,o)}function z7(t,e={}){return Qd(t)(e)}var Jd=L(4637),NE=function(t){return t},v_=function(t,e){e===void 0&&(e=NE);var n={};return(0,Jd.Z)(t)&&!(0,be.Z)(t)&&Object.keys(t).forEach(function(r){n[r]=e(t[r],r)}),n};function th(t){var e,n,r,o=t||1;function c(u,d){++e>o&&(r=n,l(1),++e),n[u]=d}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var d=n[u];if(d!==void 0)return d;if((d=r[u])!==void 0)return c(u,d),d},set:function(u,d){n[u]!==void 0?n[u]=d:c(u,d)}}}const FE=th(3);function ag(t,e=(...r)=>`${r[0]}`,n=16){const r=th(n);return(...o)=>{const c=e(...o);let l=r.get(c);return r.has(c)?r.get(c):(l=t(...o),r.set(c,l),l)}}const BE=["style","encode","labels","children"],jE=ag(t=>{const e=Qd(t);return(...n)=>{const r=Array.from({length:n.length},(c,l)=>String.fromCharCode(97+l)),o=Object.fromEntries(n.map((c,l)=>[r[l],c]));return e(Object.assign(Object.assign({},o),{global:Object.assign({},o)}))}},t=>t,128);function yl(t,e=!0){if(Array.isArray(t))return t.map((n,r)=>yl(t[r],e));if(typeof t=="object"&&t)return v_(t,(n,r)=>e&&BE.includes(r)?yl(n,r==="children"):e?n:yl(n,!1));if(typeof t=="string"){const n=t.trim();if(n.startsWith("{")&&n.endsWith("}"))return jE(n.slice(1,-1))}return t}var zE=function(t){var e=K1(t);return e.charAt(0).toUpperCase()+e.substring(1)},Ls=zE;function eh(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function _l(t,e){if(!isFinite(t)||t===0)return null;var n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function UE(t){return t=_l(Math.abs(t)),t?t[1]:NaN}function Yu(t,e){return function(n,r){for(var o=n.length,c=[],l=0,u=t[0],d=0;o>0&&u>0&&(d+u+1>r&&(u=Math.max(1,r-d)),c.push(n.substring(o-=u,o+u)),!((d+=u+1)>r));)u=t[l=(l+1)%t.length];return c.reverse().join(e)}}function ZE(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var HE=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sg(t){if(!(e=HE.exec(t)))throw new Error("invalid format: "+t);var e;return new nh({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}sg.prototype=nh.prototype;function nh(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}nh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function WE(t){t:for(var e=t.length,n=1,r=-1,o;n<e;++n)switch(t[n]){case".":r=o=n;break;case"0":r===0&&(r=n),o=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(o+1):t}var rh;function m_(t,e){var n=_l(t,e);if(!n)return rh=void 0,t.toPrecision(e);var r=n[0],o=n[1],c=o-(rh=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,l=r.length;return c===l?r:c>l?r+new Array(c-l+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+_l(t,Math.max(0,e+c-1))[0]}function Xu(t,e){var n=_l(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}var y_={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:eh,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Xu(t*100,e),r:Xu,s:m_,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function __(t){return t}var b_=Array.prototype.map,x_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function VE(t){var e=t.grouping===void 0||t.thousands===void 0?__:Yu(b_.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",c=t.numerals===void 0?__:ZE(b_.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"\u2212":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function h(v,m){v=sg(v);var _=v.fill,b=v.align,S=v.sign,w=v.symbol,E=v.zero,T=v.width,M=v.comma,P=v.precision,R=v.trim,k=v.type;k==="n"?(M=!0,k="g"):y_[k]||(P===void 0&&(P=12),R=!0,k="g"),(E||_==="0"&&b==="=")&&(E=!0,_="0",b="=");var F=(m&&m.prefix!==void 0?m.prefix:"")+(w==="$"?n:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),W=(w==="$"?r:/[%p]/.test(k)?l:"")+(m&&m.suffix!==void 0?m.suffix:""),$=y_[k],rt=/[defgprs%]/.test(k);P=P===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,P)):Math.max(0,Math.min(20,P));function et(ut){var J=F,lt=W,vt,xt,Ht;if(k==="c")lt=$(ut)+lt,ut="";else{ut=+ut;var gt=ut<0||1/ut<0;if(ut=isNaN(ut)?d:$(Math.abs(ut),P),R&&(ut=WE(ut)),gt&&+ut==0&&S!=="+"&&(gt=!1),J=(gt?S==="("?S:u:S==="-"||S==="("?"":S)+J,lt=(k==="s"&&!isNaN(ut)&&rh!==void 0?x_[8+rh/3]:"")+lt+(gt&&S==="("?")":""),rt){for(vt=-1,xt=ut.length;++vt<xt;)if(Ht=ut.charCodeAt(vt),48>Ht||Ht>57){lt=(Ht===46?o+ut.slice(vt+1):ut.slice(vt))+lt,ut=ut.slice(0,vt);break}}}M&&!E&&(ut=e(ut,1/0));var wt=J.length+ut.length+lt.length,Wt=wt<T?new Array(T-wt+1).join(_):"";switch(M&&E&&(ut=e(Wt+ut,Wt.length?T-lt.length:1/0),Wt=""),b){case"<":ut=J+ut+lt+Wt;break;case"=":ut=J+Wt+ut+lt;break;case"^":ut=Wt.slice(0,wt=Wt.length>>1)+J+ut+lt+Wt.slice(wt);break;default:ut=Wt+J+ut+lt;break}return c(ut)}return et.toString=function(){return v+""},et}function g(v,m){var _=Math.max(-8,Math.min(8,Math.floor(UE(m)/3)))*3,b=Math.pow(10,-_),S=h((v=sg(v),v.type="f",v),{suffix:x_[8+_/3]});return function(w){return S(b*w)}}return{format:h,formatPrefix:g}}var ih,ss,GE;$E({thousands:",",grouping:[3],currency:["$",""]});function $E(t){return ih=VE(t),ss=ih.format,GE=ih.formatPrefix,ih}function Pa(t,e){return Object.entries(t).reduce((n,[r,o])=>(n[r]=e(o,r,t),n),{})}function _c(t){return t.map((e,n)=>n)}function U7(t){const e=t.length,n=t[0].length,r=new Array(n).fill(0).map(()=>new Array(e));for(let o=0;o<n;o++)for(let c=0;c<e;c++)r[o][c]=t[c][o];return r}function YE(t){return t[0]}function cg(t){return t[t.length-1]}function Z7(t){return!t.some(Array.isArray)}function XE(t){return Array.from(new Set(t))}function lg(t,e){const n=[[],[]];return t.forEach(r=>{n[e(r)?0:1].push(r)}),n}function ug(t,e=t.length){if(e===1)return t.map(r=>[r]);const n=[];for(let r=0;r<t.length;r++){const o=t.slice(r+1);ug(o,e-1).forEach(l=>{n.push([t[r],...l])})}return n}function S_(t){if(t.length===1)return[t];const e=[];for(let n=1;n<=t.length;n++)e.push(...ug(t,n));return e}var w_=function(t){return t!==null&&typeof t!="function"&&isFinite(t.length)},bc=w_,fg=function(t,e){if(t===e)return!0;if(!t||!e||(0,Ze.Z)(t)||(0,Ze.Z)(e))return!1;if(bc(t)||bc(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=fg(t[r],e[r]),!!n);r++);return n}if(zd(t)||zd(e)){var o=Object.keys(t),c=Object.keys(e);if(o.length!==c.length)return!1;for(var n=!0,r=0;r<o.length&&(n=fg(t[o[r]],e[o[r]]),!!n);r++);return n}return!1},dg=fg;function Qo(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let o of t)(o=+e(o,++r,t))&&(n+=o)}return n}function Rr(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}function H7(t){return t*Math.PI/180}function W7(t){return t*180/Math.PI}function O_(t,e){return t=t%(2*Math.PI),e=e%(2*Math.PI),t<0&&(t=2*Math.PI+t),e<0&&(e=2*Math.PI+e),t>=e&&(e=e+2*Math.PI),{startAngle:t,endAngle:e}}const hg=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},n=Object.assign(Object.assign({},e),t);return Object.assign(Object.assign({},n),O_(n.startAngle,n.endAngle))},bl=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=hg(t);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",e,n,r,o]]};bl.props={};const E_=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},pg=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=E_(t);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...bl({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};pg.props={};function oh(t,e,n){return Math.max(e,Math.min(t,n))}function ah(t,e=10){return typeof t!="number"||Math.abs(t)<1e-15?t:parseFloat(t.toFixed(e))}const cs="g2-";function xc(t){return`.${cs}${t}`}const qE=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]],gg=["lineX","lineY","rangeX","rangeY","range","connector"];var A_=L(17816);function Yr(t){const{transformations:e}=t.getOptions();return e.map(([r])=>r).filter(r=>r==="transpose").length%2!==0}function kr(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="polar")}function qu(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="reflect")&&e.some(([n])=>n.startsWith("transpose"))}function vg(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="helix")}function xl(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="parallel")}function T_(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="fisheye")}function M_(t){return xl(t)&&kr(t)}function Sl(t){return vg(t)||kr(t)}function C_(t){return kr(t)&&Yr(t)}function V7(t){return kr(t)||xl(t)||qu(t)||C_(t)}function P_(t){if(Sl(t)){const[e,n]=t.getSize(),r=t.getOptions().transformations.find(o=>o[0]==="polar");if(r)return Math.max(e,n)/2*r[4]}return 0}function sh(t){const{transformations:e}=t.getOptions(),[,,,n,r]=e.find(o=>o[0]==="polar");return[+n,+r]}function mg(t,e=!0){const{transformations:n}=t.getOptions(),[,r,o]=n.find(c=>c[0]==="polar");return e?[+r*180/Math.PI,+o*180/Math.PI]:[r,o]}function L_(t,e){const{transformations:n}=t.getOptions(),[,...r]=n.find(o=>o[0]===e);return r}var Q=L(97582);function yg(t,e){e(t),t.children&&t.children.forEach(function(n){n&&yg(n,e)})}function Ku(t){ch(t,!0)}function Is(t){ch(t,!1)}function ch(t,e){var n=e?"visible":"hidden";yg(t,function(r){r.attr("visibility",n)})}function KE(t){return typeof t=="boolean"?!1:"enter"in t&&"update"in t&&"exit"in t}function I_(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter(function(r){var o=(0,Q.CR)(r,1),c=o[0];return!e.includes(c)}));return Object.fromEntries(e.map(function(r){return KE(t)?t[r]===!1?[r,!1]:[r,(0,Q.pi)((0,Q.pi)({},t[r]),n)]:[r,n]}))}function La(t,e){t?t.finished.then(e):e()}function R_(t,e){t.length===0?e():Promise.all(t.map(function(n){return n==null?void 0:n.finished})).then(e)}function k_(t,e){"update"in t?t.update(e):t.attr(e)}function lh(t,e,n){if(e.length===0)return null;if(!n){var r=e.slice(-1)[0];return k_(t,{style:r}),null}return t.animate(e,n)}function QE(t,e){return!(t.nodeName!=="text"||e.nodeName!=="text"||t.attributes.text!==e.attributes.text)}function JE(t,e,n,r){if(r===void 0&&(r="destroy"),QE(t,e))return t.remove(),[null];var o=function(){r==="destroy"?t.destroy():r==="hide"&&Is(t),e.isVisible()&&Ku(e)};if(!n)return o(),[null];var c=n.duration,l=c===void 0?0:c,u=n.delay,d=u===void 0?0:u,h=Math.ceil(+l/2),g=+l/4,v=(0,Q.CR)(t.getGeometryBounds().center,2),m=v[0],_=v[1],b=(0,Q.CR)(e.getGeometryBounds().center,2),S=b[0],w=b[1],E=(0,Q.CR)([(m+S)/2-m,(_+w)/2-_],2),T=E[0],M=E[1],P=t.style.opacity,R=P===void 0?1:P,k=e.style.opacity,F=k===void 0?1:k,W=t.style.transform||"",$=e.style.transform||"",rt=t.animate([{opacity:R,transform:"translate(0, 0) ".concat(W)},{opacity:0,transform:"translate(".concat(T,", ").concat(M,") ").concat(W)}],(0,Q.pi)((0,Q.pi)({fill:"both"},n),{duration:d+h+g})),et=e.animate([{opacity:0,transform:"translate(".concat(-T,", ").concat(-M,") ").concat($),offset:.01},{opacity:F,transform:"translate(0, 0) ".concat($)}],(0,Q.pi)((0,Q.pi)({fill:"both"},n),{duration:h+g,delay:d+h-g}));return La(et,o),[rt,et]}function _o(t,e,n){var r={},o={};return Object.entries(e).forEach(function(c){var l=(0,Q.CR)(c,2),u=l[0],d=l[1];if(!(0,be.Z)(d)){var h=t.style[u]||t.parsedStyle[u]||0;h!==d&&(r[u]=h,o[u]=d)}}),n?lh(t,[r,o],(0,Q.pi)({fill:"both"},n)):(k_(t,o),null)}var tA=5,D_=function(t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=tA),Object.entries(e).forEach(function(o){var c=(0,Q.CR)(o,2),l=c[0],u=c[1],d=t;Object.prototype.hasOwnProperty.call(e,l)&&(u?is(u)?(is(t[l])||(d[l]={}),n<r?D_(t[l],u,n+1,r):d[l]=e[l]):(0,Br.Z)(u)?(d[l]=[],d[l]=d[l].concat(u)):d[l]=u:d[l]=u)})},ha=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)D_(t,e[r]);return t},N_=function(t){(0,Q.ZT)(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(this,(0,Q.ev)([],(0,Q.CR)(n),!1))||this;return o.isMutationObserved=!0,o.addEventListener(N.Dk.INSERTED,function(){Is(o)}),o}return e}(N.ZA);function F_(t){var e=t.appendChild(new N_({class:"offscreen"}));return Is(e),e}function eA(t){for(var e=t;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}function B_(){ch(this,this.attributes.visibility!=="hidden")}var Gi=function(t){(0,Q.ZT)(e,t);function e(n,r){r===void 0&&(r={});var o=t.call(this,ha({},{style:r},n))||this;return o.initialized=!1,o._defaultOptions=r,o}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=F_(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e.prototype.attributeChangedCallback=function(n){n==="visibility"&&B_.call(this)},e.prototype.update=function(n,r){var o;return this.attr(ha({},this.attributes,n||{})),(o=this.render)===null||o===void 0?void 0:o.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(n,r){},e.prototype.getSubShapeStyle=function(n){var r=n.x,o=n.y,c=n.transform,l=n.transformOrigin,u=n.class,d=n.className,h=n.zIndex,g=(0,Q._T)(n,["x","y","transform","transformOrigin","class","className","zIndex"]);return g},e}(N.b_);function Oo(t,e,n,r,o){return r===void 0&&(r=!0),o===void 0&&(o=function(c){c.node().removeChildren()}),t?n(e):(r&&o(e),null)}function j_(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],o=0;o<t.length;o+=n)r.push(t[o]);return r}var _g=function(t){if(!(0,Br.Z)(t))return[];for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e},nA=_g,bg=function(t){(0,Q.ZT)(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=(0,Q._T)(n,["style"]);return t.call(this,(0,Q.pi)({style:(0,Q.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},o))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=F_(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e}(N.xv);function xg(t,e){var n=new Map;return t.forEach(function(r){var o=e(r);n.has(o)||n.set(o,[]),n.get(o).push(r)}),n}function rA(t){throw new Error(t)}var on=function(){function t(o,c,l,u,d,h,g){o===void 0&&(o=null),c===void 0&&(c=null),l===void 0&&(l=null),u===void 0&&(u=null),d===void 0&&(d=[null,null,null,null,null]),h===void 0&&(h=[]),g===void 0&&(g=[]),e.add(this),this._elements=Array.from(o),this._data=c,this._parent=l,this._document=u,this._enter=d[0],this._update=d[1],this._exit=d[2],this._merge=d[3],this._split=d[4],this._transitions=h,this._facetElements=g}t.prototype.selectAll=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o):o;return new n(c,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o):o;return new n(this._elements,null,this._parent,this._document,void 0,void 0,c)},t.prototype.select=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o)[0]||null:o;return new n([c],null,c,this._document)},t.prototype.append=function(o){var c=this,l=typeof o=="function"?o:function(){return c.createElement(o)},u=[];if(this._data!==null){for(var d=0;d<this._data.length;d++){var h=this._data[d],g=(0,Q.CR)(Array.isArray(h)?h:[h,null],2),v=g[0],m=g[1],_=l(v,d);_.__data__=v,m!==null&&(_.__fromElements__=m),this._parent.appendChild(_),u.push(_)}return new n(u,null,this._parent,this._document)}for(var d=0;d<this._elements.length;d++){var b=this._elements[d],v=b.__data__,_=l(v,d);b.appendChild(_),u.push(_)}return new n(u,null,u[0],this._document)},t.prototype.maybeAppend=function(o,c){var l=(0,Q.Q_)(this,e,"m",r).call(this,o[0]==="#"?o:"#".concat(o),c);return l.attr("id",o),l},t.prototype.maybeAppendByClassName=function(o,c){var l=o.toString(),u=(0,Q.Q_)(this,e,"m",r).call(this,l[0]==="."?l:".".concat(l),c);return u.attr("className",l),u},t.prototype.maybeAppendByName=function(o,c){var l=(0,Q.Q_)(this,e,"m",r).call(this,'[name="'.concat(o,'"]'),c);return l.attr("name",o),l},t.prototype.data=function(o,c,l){var u,d;c===void 0&&(c=function(rt){return rt}),l===void 0&&(l=function(){return null});for(var h=[],g=[],v=new Set(this._elements),m=[],_=new Set,b=new Map(this._elements.map(function(rt,et){return[c(rt.__data__,et),rt]})),S=new Map(this._facetElements.map(function(rt,et){return[c(rt.__data__,et),rt]})),w=xg(this._elements,function(rt){return l(rt.__data__)}),E=0;E<o.length;E++){var T=o[E],M=c(T,E),P=l(T,E);if(b.has(M)){var R=b.get(M);R.__data__=T,R.__facet__=!1,g.push(R),v.delete(R),b.delete(M)}else if(S.has(M)){var R=S.get(M);R.__data__=T,R.__facet__=!0,g.push(R),S.delete(M)}else if(w.has(M)){var k=w.get(M);m.push([T,k]);try{for(var F=(u=void 0,(0,Q.XA)(k)),W=F.next();!W.done;W=F.next()){var R=W.value;v.delete(R)}}catch(rt){u={error:rt}}finally{try{W&&!W.done&&(d=F.return)&&d.call(F)}finally{if(u)throw u.error}}w.delete(M)}else if(b.has(P)){var R=b.get(P);R.__toData__?R.__toData__.push(T):R.__toData__=[T],_.add(R),v.delete(R)}else h.push(T)}var $=[new n([],h,this._parent,this._document),new n(g,null,this._parent,this._document),new n(v,null,this._parent,this._document),new n([],m,this._parent,this._document),new n(_,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,$)},t.prototype.merge=function(o){var c=(0,Q.ev)((0,Q.ev)([],(0,Q.CR)(this._elements),!1),(0,Q.CR)(o._elements),!1),l=(0,Q.ev)((0,Q.ev)([],(0,Q.CR)(this._transitions),!1),(0,Q.CR)(o._transitions),!1);return new n(c,null,this._parent,this._document,void 0,l)},t.prototype.createElement=function(o){if(this._document)return this._document.createElement(o,{});var c=n.registry[o];return c?new c:rA("Unknown node type: ".concat(o))},t.prototype.join=function(o,c,l,u,d){o===void 0&&(o=function(b){return b}),c===void 0&&(c=function(b){return b}),l===void 0&&(l=function(b){return b.remove()}),u===void 0&&(u=function(b){return b}),d===void 0&&(d=function(b){return b.remove()});var h=o(this._enter),g=c(this._update),v=l(this._exit),m=u(this._merge),_=d(this._split);return g.merge(h).merge(v).merge(m).merge(_)},t.prototype.remove=function(){for(var o=function(u){var d=c._elements[u],h=c._transitions[u];h?h.then(function(){return d.remove()}):d.remove()},c=this,l=0;l<this._elements.length;l++)o(l);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(o){for(var c=0;c<this._elements.length;c++){var l=this._elements[c],u=l.__data__;o.call(l,u,c)}return this},t.prototype.attr=function(o,c){var l=typeof c!="function"?function(){return c}:c;return this.each(function(u,d){c!==void 0&&(this[o]=l.call(this,u,d))})},t.prototype.style=function(o,c,l){l===void 0&&(l=!0);var u=typeof c!="function"||!l?function(){return c}:c;return this.each(function(d,h){c!==void 0&&(this.style[o]=u.call(this,d,h))})},t.prototype.styles=function(o,c){return o===void 0&&(o={}),c===void 0&&(c=!0),this.each(function(l,u){var d=this;Object.entries(o).forEach(function(h){var g=(0,Q.CR)(h,2),v=g[0],m=g[1],_=typeof m!="function"||!c?function(){return m}:m;m!==void 0&&d.attr(v,_.call(d,l,u))})})},t.prototype.update=function(o,c){c===void 0&&(c=!0);var l=typeof o!="function"||!c?function(){return o}:o;return this.each(function(u,d){o&&this.update&&this.update(l.call(this,u,d))})},t.prototype.maybeUpdate=function(o,c){c===void 0&&(c=!0);var l=typeof o!="function"||!c?function(){return o}:o;return this.each(function(u,d){o&&this.update&&this.update(l.call(this,u,d))})},t.prototype.transition=function(o){var c=this._transitions,l=new Array(this._elements.length);return this.each(function(u,d){l[d]=o.call(this,u,d)}),this._transitions=nA(l),this},t.prototype.on=function(o,c){return this.each(function(){this.addEventListener(o,c)}),this},t.prototype.call=function(o){for(var c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];return o.call.apply(o,(0,Q.ev)([this._parent,this],(0,Q.CR)(c),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter(function(o){return!!o})},t.prototype.parent=function(){return this._parent};var e,n,r;return n=t,e=new WeakSet,r=function(c,l){var u=this._elements[0],d=u.querySelector(c);if(d)return new n([d],null,this._parent,this._document);var h=typeof l=="string"?this.createElement(l):l();return u.appendChild(h),new n([h],null,this._parent,this._document)},t.registry={g:N.ZA,rect:N.UL,circle:N.Cd,path:N.y$,text:bg,ellipse:N.Pj,image:N.Ee,line:N.x1,polygon:N.mg,polyline:N.aH,html:N.k9},t}();function ot(t){return new on([t],null,t,t.ownerDocument)}function Qu(t,e,n){return t.querySelector(e)?ot(t).select(e):ot(t).append(n)}var dt=function(t,e){var n=function(o){return"".concat(e,"-").concat(o)},r=Object.fromEntries(Object.entries(t).map(function(o){var c=(0,Q.CR)(o,2),l=c[0],u=c[1],d=n(u);return[l,{name:d,class:".".concat(d),id:"#".concat(d),toString:function(){return d}}]}));return Object.assign(r,{prefix:n}),r},jr={gridGroup:"grid-group",mainGroup:"main-group",lineGroup:"line-group",tickGroup:"tick-group",labelGroup:"label-group",titleGroup:"title-group",grid:"grid",line:"line",lineFirst:"line-first",lineSecond:"line-second",tick:"tick",tickItem:"tick-item",label:"label",labelItem:"label-item",title:"title"},Sg={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new N.y$({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},G7=nn({},Sg,{style:{type:"arc"}}),$7=nn({},Sg,{style:{}}),Qn=dt({mainGroup:jr.mainGroup,gridGroup:jr.gridGroup,grid:jr.grid,lineGroup:jr.lineGroup,line:jr.line,tickGroup:jr.tickGroup,tick:jr.tick,tickItem:jr.tickItem,labelGroup:jr.labelGroup,label:jr.label,labelItem:jr.labelItem,titleGroup:jr.titleGroup,title:jr.title,lineFirst:jr.lineFirst,lineSecond:jr.lineSecond},"axis"),Eo=L(45607);function Ia(t,e){return[t[0]*e,t[1]*e]}function wl(t,e){return[t[0]+e[0],t[1]+e[1]]}function Ju(t,e){return[t[0]-e[0],t[1]-e[1]]}function Rs(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function Sc(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function uh(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function wg(t){if(t[0]===0&&t[1]===0)return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function Y7(t,e,n){var r=__read(t,2),o=r[0],c=r[1],l=__read(e,2),u=l[0],d=l[1],h=o-u,g=c-d,v=Math.sin(n),m=Math.cos(n);return[h*m-g*v+u,h*v+g*m+d]}function X7(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}function Ol(t){return t*Math.PI/180}function iA(t){return Number((t*180/Math.PI).toPrecision(5))}function Og(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function oA(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}function q7(t,e){return"".concat(e).concat(Og(t))}function aA(t,e,n){var r;n===void 0&&(n=!0);var o=e||((r=t.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",c=t.replace(new RegExp("^(".concat(o,")")),"");return n?oA(c):c}function K7(t,e){Object.entries(e).forEach(function(n){var r=(0,Q.CR)(n,2),o=r[0],c=r[1];(0,Q.ev)([t],(0,Q.CR)(t.querySelectorAll(o)),!1).filter(function(l){return l.matches(o)}).forEach(function(l){if(l){var u=l;u.style.cssText+=Object.entries(c).reduce(function(d,h){return"".concat(d).concat(h.join(":"),";")},"")}})})}var fh=function(t,e){if(!(t!=null&&t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function or(t,e,n){n===void 0&&(n=!1);var r={};return Object.entries(t).forEach(function(o){var c=(0,Q.CR)(o,2),l=c[0],u=c[1];if(!(l==="className"||l==="class")){if(fh(l,"show")&&fh(aA(l,"show"),e)!==n)l===q7(e,"show")?r[l]=u:r[l.replace(new RegExp(Og(e)),"")]=u;else if(!fh(l,"show")&&fh(l,e)!==n){var d=aA(l,e);d==="filter"&&typeof u=="function"||(r[d]=u)}}}),r}function ls(t,e){return Object.entries(t).reduce(function(n,r){var o=(0,Q.CR)(r,2),c=o[0],l=o[1];return c.startsWith("show")?n["show".concat(e).concat(c.slice(4))]=l:n["".concat(e).concat(Og(c))]=l,n},{})}function us(t,e){e===void 0&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},o={};return Object.entries(t).forEach(function(c){var l=(0,Q.CR)(c,2),u=l[0],d=l[1];e.includes(u)||(n.indexOf(u)!==-1?o[u]=d:r[u]=d)}),[r,o]}function Fo(t,e){return(0,Eo.Z)(t)?t.apply(void 0,(0,Q.ev)([],(0,Q.CR)(e),!1)):t}function dh(t,e){return t.style.opacity||(t.style.opacity=1),_o(t,{opacity:0},e)}var Q7=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function sA(t){return Q7.includes(t)}function z_(t){var e={};for(var n in t)sA(n)&&(e[n]=t[n]);return e}var El=dt({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function tf(t){return t.reduce(function(e,n,r){return e.push((0,Q.ev)([r===0?"M":"L"],(0,Q.CR)(n),!1)),e},[])}function J7(t,e,n){var r=e.connect,o=r===void 0?"line":r,c=e.center;if(o==="line")return tf(t);if(!c)return[];var l=uh(t[0],c),u=n?0:1;return t.reduce(function(d,h,g){return g===0?d.push((0,Q.ev)(["M"],(0,Q.CR)(h),!1)):d.push((0,Q.ev)(["A",l,l,0,0,u],(0,Q.CR)(h),!1)),d},[])}function U_(t,e,n){return e.type==="surround"?J7(t,e,n):tf(t)}function wc(t,e,n){var r=n.type,o=n.connect,c=n.center,l=n.closed,u=l?[["Z"]]:[],d=(0,Q.CR)([U_(t,n),U_(e.slice().reverse(),n,!0)],2),h=d[0],g=d[1],v=(0,Q.CR)([t[0],e.slice(-1)[0]],2),m=v[0],_=v[1],b=function(T,M){return[h,T,g,M,u].flat()};if(o==="line"||r==="surround")return b([(0,Q.ev)(["L"],(0,Q.CR)(_),!1)],[(0,Q.ev)(["L"],(0,Q.CR)(m),!1)]);if(!c)throw new Error("Arc grid need to specified center");var S=(0,Q.CR)([uh(_,c),uh(m,c)],2),w=S[0],E=S[1];return b([(0,Q.ev)(["A",w,w,0,0,1],(0,Q.CR)(_),!1),(0,Q.ev)(["L"],(0,Q.CR)(_),!1)],[(0,Q.ev)(["A",E,E,0,0,0],(0,Q.CR)(m),!1),(0,Q.ev)(["L"],(0,Q.CR)(m),!1)])}function hh(t,e,n,r){var o=n.animate,c=n.isBillboard,l=e.map(function(u,d){return{id:u.id||"grid-line-".concat(d),d:U_(u.points,n)}});return t.selectAll(El.line.class).data(l,function(u){return u.id}).join(function(u){return u.append("path").each(function(d,h){var g=Fo(z_((0,Q.pi)({d:d.d},r)),[d,h,l]);this.attr((0,Q.pi)({class:El.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:c},g))})},function(u){return u.transition(function(d,h){var g=Fo(z_((0,Q.pi)({d:d.d},r)),[d,h,l]);return _o(this,g,o.update)})},function(u){return u.transition(function(){var d=this,h=dh(this,o.exit);return La(h,function(){return d.remove()}),h})}).transitions()}function ph(t,e,n){var r=n.animate,o=n.connect,c=n.areaFill;if(e.length<2||!c||!o)return[];for(var l=Array.isArray(c)?c:[c,"transparent"],u=function(b){return l[b%l.length]},d=[],h=0;h<e.length-1;h++){var g=(0,Q.CR)([e[h].points,e[h+1].points],2),v=g[0],m=g[1],_=wc(v,m,n);d.push({d:_,fill:u(h)})}return t.selectAll(El.region.class).data(d,function(b,S){return S}).join(function(b){return b.append("path").each(function(S,w){var E=Fo(S,[S,w,d]);this.attr(E)}).attr("className",El.region.name)},function(b){return b.transition(function(S,w){var E=Fo(S,[S,w,d]);return _o(this,E,r.update)})},function(b){return b.transition(function(){var S=this,w=dh(this,r.exit);return La(w,function(){return S.remove()}),w})}).transitions()}function Al(t){var e=t.data,n=e===void 0?[]:e,r=t.closed;return r?n.map(function(o){var c=o.points,l=(0,Q.CR)(c,1),u=l[0];return(0,Q.pi)((0,Q.pi)({},o),{points:(0,Q.ev)((0,Q.ev)([],(0,Q.CR)(c),!1),[u],!1)})}):n}var $i=function(t){(0,Q.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.type,c=n.center,l=n.areaFill,u=n.closed,d=(0,Q._T)(n,["type","center","areaFill","closed"]),h=Al(n),g=ot(r).maybeAppendByClassName(El.lineGroup,"g"),v=ot(r).maybeAppendByClassName(El.regionGroup,"g"),m=hh(g,h,n,d),_=ph(v,h,n);return(0,Q.ev)((0,Q.ev)([],(0,Q.CR)(m),!1),(0,Q.CR)(_),!1)},e}(Gi),Co=function(t,e){return function(n){return t*(1-n)+e*n}};function ks(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(o){var c=new Array(r),l=new Array(n),u=0;for(u=0;u<r;++u)c[u]=Tl(t[u],e[u]);for(;u<n;++u)l[u]=e[u];for(u=0;u<r;++u)l[u]=c[u](o);return l}}function Oc(t,e){t===void 0&&(t={}),e===void 0&&(e={});var n={},r={};return Object.entries(e).forEach(function(o){var c=(0,Q.CR)(o,2),l=c[0],u=c[1];l in t?n[l]=Tl(t[l],u):r[l]=u}),function(o){return Object.entries(n).forEach(function(c){var l=(0,Q.CR)(c,2),u=l[0],d=l[1];return r[u]=d(o)}),r}}function Tl(t,e){return typeof t=="number"&&typeof e=="number"?Co(t,e):Array.isArray(t)&&Array.isArray(e)?ks(t,e):typeof t=="object"&&typeof e=="object"?Oc(t,e):function(n){return t}}function oo(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var o=r.duration,c=o===void 0?0:o,l=Tl(e,n),u=Math.ceil(+c/16),d=new Array(u).fill(0).map(function(h,g,v){return{__keyframe_data__:l(g/(v.length-1))}});return t.animate(d,(0,Q.pi)({fill:"both"},r))}function _r(t){return typeof t=="function"?t():(0,Ze.Z)(t)||(0,Se.Z)(t)?new bg({style:{text:String(t)}}):t}function Ml(t,e){return typeof t=="function"?t():(0,Ze.Z)(t)||(0,Se.Z)(t)?new N.k9({style:(0,Q.pi)((0,Q.pi)({pointerEvents:"auto"},e),{innerHTML:t})}):t}function Nn(t,e,n){n===void 0&&(n=!1);var r=t.getBBox(),o=r.width,c=r.height,l=e/Math.max(o,c);return n&&(t.style.transform="scale(".concat(l,")")),l}function Eg(t,e){var n={},r=Array.isArray(e)?e:[e];for(var o in t)r.includes(o)||(n[o]=t[o]);return n}function Z_(t,e){return Object.fromEntries(Object.entries(t).map(function(n){var r=(0,Q.CR)(n,2),o=r[0],c=r[1];return[o,Fo(c,e)]}))}function tI(t){if(t.type==="linear"){var e=t.startPos,n=t.endPos;return __spreadArray(__spreadArray([],__read(e),!1),__read(n),!1)}var r=t.startAngle,o=t.endAngle,c=t.center,l=t.radius;return __spreadArray(__spreadArray([r,o],__read(c),!1),[l],!1)}function Ec(t,e){return e&&(0,Eo.Z)(e)?t.filter(e):t}function H_(t,e){var n=e.startAngle,r=e.endAngle;return(r-n)*t+n}function gh(t,e){if(e.type==="linear"){var n=(0,Q.CR)(e.startPos,2),r=n[0],o=n[1],c=(0,Q.CR)(e.endPos,2),l=c[0],u=c[1],d=(0,Q.CR)([l-r,u-o],2),h=d[0],g=d[1];return wg([h,g])}var v=Ol(H_(t,e));return[-Math.sin(v),Math.cos(v)]}function vh(t,e,n){var r=gh(t,n);return X7(r,e!=="positive")}function Ac(t,e){return vh(t,e.labelDirection,e)}function ef(t,e,n){return n?"".concat(t," ").concat(n,"axis-").concat(e):t}function eI(t,e,n){var r=t.classNamePrefix,o=r===void 0?"":r;return ef(e.name,n,o)}function Bo(t,e,n,r){return r&&t.attr("className",ef(e.name,n,r)),t}function cA(t,e){var n=(0,Q.CR)(e.startPos,2),r=n[0],o=n[1],c=(0,Q.CR)(e.endPos,2),l=c[0],u=c[1],d=(0,Q.CR)([l-r,u-o],2),h=d[0],g=d[1];return[r+h*t,o+g*t]}function lA(t,e){var n=e.radius,r=(0,Q.CR)(e.center,2),o=r[0],c=r[1],l=Ol(H_(t,e));return[o+n*Math.cos(l),c+n*Math.sin(l)]}function mh(t,e){return e.type==="linear"?cA(t,e):lA(t,e)}function Ag(t){return gh(0,t)[1]===0}function Tg(t){return gh(0,t)[0]===0}function W_(t,e){return e-t===360}function Mg(t,e,n,r,o){var c=e-t,l=(0,Q.CR)([o,o],2),u=l[0],d=l[1],h=(0,Q.CR)([Ol(t),Ol(e)],2),g=h[0],v=h[1],m=function(rt){return[n+o*Math.cos(rt),r+o*Math.sin(rt)]},_=(0,Q.CR)(m(g),2),b=_[0],S=_[1],w=(0,Q.CR)(m(v),2),E=w[0],T=w[1];if(W_(t,e)){var M=(v+g)/2,P=(0,Q.CR)(m(M),2),R=P[0],k=P[1];return[["M",b,S],["A",u,d,0,1,0,R,k],["A",u,d,0,1,0,E,T]]}var F=c>180?1:0,W=t>e?0:1,$=!1;return $?"M".concat(n,",").concat(r,",L").concat(b,",").concat(S,",A").concat(u,",").concat(d,",0,").concat(F,",").concat(W,",").concat(E,",").concat(T,",L").concat(n,",").concat(r):"M".concat(b,",").concat(S,",A").concat(u,",").concat(d,",0,").concat(F,",").concat(W,",").concat(E,",").concat(T)}function uA(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,o=e.center,c=e.radius;return(0,Q.ev)((0,Q.ev)([n,r],(0,Q.CR)(o),!1),[c],!1)}function nI(t,e,n,r){var o=e.startAngle,c=e.endAngle,l=e.center,u=e.radius,d=e.classNamePrefix;return t.selectAll(Qn.line.class).data([{d:Mg.apply(void 0,(0,Q.ev)((0,Q.ev)([o,c],(0,Q.CR)(l),!1),[u],!1))}],function(h,g){return g}).join(function(h){var g=h.append("path").attr("className",Qn.line.name).styles(e).styles({d:function(v){return v.d}});return Bo(g,Qn.line,jr.line,d),g},function(h){return h.transition(function(){var g=this,v=oo(this,uA(this),(0,Q.ev)((0,Q.ev)([o,c],(0,Q.CR)(l),!1),[u],!1),r.update);if(v){var m=function(){var _=er(g.attributes,"__keyframe_data__");g.style.d=Mg.apply(void 0,(0,Q.ev)([],(0,Q.CR)(_),!1))};v.onframe=m,v.onfinish=m}return v}).styles(e)},function(h){return h.remove()}).styles(n).transitions()}function fA(t,e){var n=e.truncRange,r=e.truncShape,o=e.lineExtension}function V_(t,e,n){n===void 0&&(n=[0,0]);var r=(0,Q.CR)([t,e,n],3),o=(0,Q.CR)(r[0],2),c=o[0],l=o[1],u=(0,Q.CR)(r[1],2),d=u[0],h=u[1],g=(0,Q.CR)(r[2],2),v=g[0],m=g[1],_=(0,Q.CR)([d-c,h-l],2),b=_[0],S=_[1],w=Math.sqrt(Math.pow(b,2)+Math.pow(S,2)),E=(0,Q.CR)([-v/w,m/w],2),T=E[0],M=E[1];return[T*b,T*S,M*b,M*S]}function Cg(t){var e=(0,Q.CR)(t,2),n=(0,Q.CR)(e[0],2),r=n[0],o=n[1],c=(0,Q.CR)(e[1],2),l=c[0],u=c[1];return{x1:r,y1:o,x2:l,y2:u}}function dA(t,e,n,r){var o=e.showTrunc,c=e.startPos,l=e.endPos,u=e.truncRange,d=e.lineExtension,h=e.classNamePrefix,g=(0,Q.CR)([c,l],2),v=(0,Q.CR)(g[0],2),m=v[0],_=v[1],b=(0,Q.CR)(g[1],2),S=b[0],w=b[1],E=(0,Q.CR)(d?V_(c,l,d):new Array(4).fill(0),4),T=E[0],M=E[1],P=E[2],R=E[3],k=function(wt){return t.selectAll(Qn.line.class).data(wt,function(Wt,fe){return fe}).join(function(Wt){var fe=Wt.append("line").styles(n).transition(function(le){return _o(this,Cg(le.line),!1)});return fe.attr("className",function(le){if(!h)return"".concat(Qn.line.name," ").concat(le.className);var Te=ef(Qn.line.name,jr.line,h);if(le.className===Qn.lineFirst.name){var Fe=ef(Qn.lineFirst.name,jr.lineFirst,h);return"".concat(Te," ").concat(Fe)}if(le.className===Qn.lineSecond.name){var Fe=ef(Qn.lineSecond.name,jr.lineSecond,h);return"".concat(Te," ").concat(Fe)}return Te}),fe},function(Wt){return Wt.styles(n).transition(function(fe){var le=fe.line;return _o(this,Cg(le),r.update)})},function(Wt){return Wt.remove()}).transitions()};if(!o||!u)return k([{line:[[m+T,_+M],[S+P,w+R]],className:Qn.line.name}]);var F=(0,Q.CR)(u,2),W=F[0],$=F[1],rt=S-m,et=w-_,ut=(0,Q.CR)([m+rt*W,_+et*W],2),J=ut[0],lt=ut[1],vt=(0,Q.CR)([m+rt*$,_+et*$],2),xt=vt[0],Ht=vt[1],gt=k([{line:[[m+T,_+M],[J,lt]],className:Qn.lineFirst.name},{line:[[xt,Ht],[S+P,w+R]],className:Qn.lineSecond.name}]);return fA(t,e),gt}function ln(t,e,n,r){var o=n.showArrow,c=n.showTrunc,l=n.lineArrow,u=n.lineArrowOffset,d=n.lineArrowSize,h;if(e==="arc"?h=t.select(Qn.line.class):c?h=t.select(Qn.lineSecond.class):h=t.select(Qn.line.class),!o||!l||n.type==="arc"&&W_(n.startAngle,n.endAngle)){var g=h.node();g&&(g.style.markerEnd=void 0);return}var v=_r(l);v.attr(r),Nn(v,d,!0),h.style("markerEnd",v).style("markerEndOffset",-u)}function hA(t,e,n){var r=e.type,o,c=or(e,"line");return r==="linear"?o=dA(t,e,Eg(c,"arrow"),n):o=nI(t,e,Eg(c,"arrow"),n),ln(t,r,e,c),o}function G_(t,e){return vh(t,e.gridDirection,e)}function Cl(t){var e=t.type,n=t.gridCenter;return e==="linear"?n:n||t.center}function pA(t,e){var n=e.gridLength;return t.map(function(r,o){var c=r.value,l=(0,Q.CR)(mh(c,e),2),u=l[0],d=l[1],h=(0,Q.CR)(Ia(G_(c,e),n),2),g=h[0],v=h[1];return{id:o,points:[[u,d],[u+g,d+v]]}})}function Zr(t,e){var n=e.gridControlAngles,r=Cl(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||n.length===0)throw new Error("Invalid gridControlAngles");var o=(0,Q.CR)(r,2),c=o[0],l=o[1];return t.map(function(u,d){var h=u.value,g=(0,Q.CR)(mh(h,e),2),v=g[0],m=g[1],_=(0,Q.CR)([v-c,m-l],2),b=_[0],S=_[1],w=[];return n.forEach(function(E){var T=Ol(E),M=(0,Q.CR)([Math.cos(T),Math.sin(T)],2),P=M[0],R=M[1],k=b*P-S*R+c,F=b*R+S*P+l;w.push([k,F])}),{points:w,id:d}})}function gA(t,e,n,r){var o=n.classNamePrefix,c=or(n,"grid"),l=c.type,u=c.areaFill,d=Cl(n),h=Ec(e,n.gridFilter),g=l==="segment"?pA(h,n):Zr(h,n),v=(0,Q.pi)((0,Q.pi)({},c),{center:d,areaFill:(0,Eo.Z)(u)?h.map(function(m,_){return Fo(u,[m,_,h])}):u,animate:r,data:g});return t.selectAll(Qn.grid.class).data([1]).join(function(m){var _=m.append(function(){return new $i({style:v})}).attr("className",Qn.grid.name);return Bo(_,Qn.grid,jr.grid,o),_},function(m){return m.transition(function(){return this.update(v)})},function(m){return m.remove()}).transitions()}function ao(t,e,n,r,o){return r===void 0&&(r=!0),o===void 0&&(o=!1),r&&t===e||o&&t===n?!0:t>e&&t<n}var vA=function(t){var e=new DOMParser,n=e.parseFromString(t,"text/html"),r=n.body.firstElementChild;if(console.log(r==null?void 0:r.getClientRects(),11),!r)return 0;var o=r.getAttribute("style")||"",c=Object.fromEntries(o.split(";").map(function(w){return w.trim()}).filter(function(w){return w.includes(":")}).map(function(w){var E=(0,Q.CR)(w.split(":").map(function(P){return P.trim()}),2),T=E[0],M=E[1];return[T.toLowerCase(),M]})),l=function(w){if(!w)return 0;var E=w.match(/([\d.]+)px/);return E?parseFloat(E[1]):0};if(c.height)return l(c.height);var u=l(c["font-size"])||16,d=c["line-height"],h;!d||d==="normal"?h=1.2*u:d.endsWith("px")?h=l(d):/^[\d.]+$/.test(d)?h=parseFloat(d)*u:h=u;var g=l(c["padding-top"]),v=l(c["padding-bottom"]);if(c.padding){var m=c.padding.split(/\s+/).map(l);m.length===1||m.length===2?(g=m[0],v=m[0]):(m.length===3||m.length===4)&&(g=m[0],v=m[2])}var _=l(c["border-top-width"]),b=l(c["border-bottom-width"]);if(c.border){var S=c.border.match(/([\d.]+)px/);S&&(_=parseFloat(S[1]),b=parseFloat(S[1]))}if(c["border-width"]){var m=c["border-width"].split(/\s+/).map(l);m.length===1||m.length===2?(_=m[0],b=m[0]):(m.length===3||m.length===4)&&(_=m[0],b=m[2])}return h+g+v+_+b};function mA(t){var e,n,r,o=t||1;function c(u,d){++e>o&&(r=n,l(1),++e),n[u]=d}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var d=n[u];if(d!==void 0)return d;if((d=r[u])!==void 0)return c(u,d),d},set:function(u,d){n[u]!==void 0?n[u]=d:c(u,d)}}}var Pg=new Map;function rI(t,e,n){n===void 0&&(n=128);var r=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];var l=e?e.apply(this,o):o[0];Pg.has(t)||Pg.set(t,mA(n));var u=Pg.get(t);if(u.has(l))return u.get(l);var d=t.apply(this,o);return u.set(l,d),d};return r}var yh,Lg;function iI(t){Lg=t}var $_=rI(function(t,e){var n=e.fontSize,r=e.fontFamily,o=e.fontWeight,c=e.fontStyle,l=e.fontVariant;return Lg?Lg(t,n):(yh||(yh=N.GZ.offscreenCanvasCreator.getOrCreateContext(void 0)),yh.font=[c,l,o,"".concat(n,"px"),r].join(" "),yh.measureText(t).width)},function(t,e){return[t,Object.values(e||Y_(t)).join()].join("")},4096),Y_=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",o=t.style.fontVariant,c=t.style.fontSize;return c=typeof c=="object"?c.value:c,{fontSize:c,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:o}};function Tc(t){return t.nodeName==="text"?t:t.nodeName==="g"&&t.children.length===1&&t.children[0].nodeName==="text"?t.children[0]:null}function _h(t,e){var n=Tc(t);n&&n.attr(e)}function Ig(t,e,n){n===void 0&&(n="..."),_h(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function X_(t,e,n,r){n===void 0&&(n=2),r===void 0&&(r="top"),_h(t,{wordWrap:!0,wordWrapWidth:e,maxLines:n,textBaseline:r})}function q_(t,e,n){var r=t.getBBox(),o=r.width,c=r.height,l=(0,Q.CR)([e,n].map(function(h,g){var v;return h.includes("%")?parseFloat(((v=h.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||v===void 0?void 0:v[0])||"0")/100*(g===0?o:c):h}),2),u=l[0],d=l[1];return[u,d]}function K_(t,e){if(e)try{var n=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(n,function(o,c,l){return"translate(".concat(q_(t,c,l),")")});t.attr("transform",r)}catch(o){}}function so(t){if((0,Se.Z)(t))return[t,t,t,t];if((0,Br.Z)(t)){var e=t.length;if(e===1)return[t[0],t[0],t[0],t[0]];if(e===2)return[t[0],t[1],t[0],t[1]];if(e===3)return[t[0],t[1],t[2],t[1]];if(e===4)return t}return[0,0,0,0]}var Rg=function(){function t(e,n,r,o){this.set(e,n,r,o)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(e,n,r){var o=this,c=o.x1,l=o.y1,u=o.x2,d=o.y2,h=Math.cos(e),g=Math.sin(e),v=n-n*h+r*g,m=r-n*g-r*h,_=[[h*c-g*d+v,g*c+h*d+m],[h*u-g*d+v,g*u+h*d+m],[h*c-g*l+v,g*c+h*l+m],[h*u-g*l+v,g*u+h*l+m]];return _},t.prototype.set=function(e,n,r,o){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),o<n?(this.y2=n,this.y1=o):(this.y1=n,this.y2=o),this},t.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},t}();function bh(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),o=(0,Q.CR)(r.min,2),c=o[0],l=o[1],u=(0,Q.CR)(r.max,2),d=u[0],h=u[1],g=t.getBBox(),v=g.width,m=g.height,_=m,b=0,S=0,w=c,E=l,T=Tc(t);if(T){_-=1.5;var M=T.style.textAlign,P=T.style.textBaseline;M==="center"?w=(c+d)/2:(M==="right"||M==="end")&&(w=d),P==="middle"?E=(l+h)/2:P==="bottom"&&(E=h)}var R=(0,Q.CR)(so(e),4),k=R[0],F=k===void 0?0:k,W=R[1],$=W===void 0?0:W,rt=R[2],et=rt===void 0?F:rt,ut=R[3],J=ut===void 0?$:ut,lt=new Rg((b+=c)-J,(S+=l)-F,b+v+$,S+_+et);return t.setEulerAngles(n),lt.rotatedPoints(Ol(n),w,E)}function fs(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function nf(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r<0?2:1}function yA(t,e){var n=nf(t[0],t[1],e[0]),r=nf(t[0],t[1],e[1]),o=nf(e[0],e[1],t[0]),c=nf(e[0],e[1],t[1]);return!!(n!==r&&o!==c||n===0&&fs(t,e[0])||r===0&&fs(t,e[1])||o===0&&fs(e,t[0])||c===0&&fs(e,t[1]))}function _A(t,e){var n=t.length;if(n<3)return!1;var r=[e,[9999,e[1]]],o=0,c=0;do{var l=[t[c],t[(c+1)%n]];if(yA(l,r)){if(nf(l[0],e,l[1])===0)return fs(l,e);o++}c=(c+1)%n}while(c!==0);return!!(o&1)}function bA(t,e){return e.every(function(n){return _A(t,n)})}function xA(t,e,n){var r=t.x1,o=t.x2,c=t.y1,l=t.y2,u=[[r,c],[o,c],[o,l],[r,l]],d=bh(e,n);return bA(u,d)}function Pl(t,e){var n=(0,Q.CR)(t,4),r=n[0],o=n[1],c=n[2],l=n[3],u=(0,Q.CR)(e,4),d=u[0],h=u[1],g=u[2],v=u[3],m=c-r,_=l-o,b=g-d,S=v-h,w=m*S-b*_;if(w===0)return!1;var E=w>0,T=r-d,M=o-h,P=m*M-_*T;if(P<0===E)return!1;var R=b*M-S*T;return!(R<0===E||P>w===E||R>w===E)}function Q_(t,e){var n=[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]];return n.some(function(r){return Pl(e,r)})}var oI={lineToLine:Pl,intersectBoxLine:Q_,getBounds:bh};function J_(t,e,n){var r,o,c=bh(t,n).flat(1),l=bh(e,n).flat(1),u=[[c[0],c[1],c[2],c[3]],[c[0],c[1],c[4],c[5]],[c[4],c[5],c[6],c[7]],[c[2],c[3],c[6],c[7]]];try{for(var d=(0,Q.XA)(u),h=d.next();!h.done;h=d.next()){var g=h.value;if(Q_(l,g))return!0}}catch(v){r={error:v}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return!1}function SA(t,e){var n=t.type,r=t.labelDirection,o=t.crossSize;if(!o)return!1;if(n==="arc"){var c=t.center,l=t.radius,u=(0,Q.CR)(c,2),d=u[0],h=u[1],g=r==="negative"?0:o,v=-l-g,m=l+g,_=(0,Q.CR)(so(e),4),b=_[0],S=_[1],w=_[2],E=_[3];return new Rg(d+v-E,h+v-b,d+m+S,h+m+w)}var T=(0,Q.CR)(t.startPos,2),M=T[0],P=T[1],R=(0,Q.CR)(t.endPos,2),k=R[0],F=R[1],W=(0,Q.CR)(Tg(t)?[-e,0,e,0]:[0,e,0,-e],4),$=W[0],rt=W[1],et=W[2],ut=W[3],J=Ac(0,t),lt=Ia(J,o),vt=new Rg(M,P,k,F);return vt.x1+=ut,vt.y1+=$,vt.x2+=rt+lt[0],vt.y2+=et+lt[1],vt}function jo(t,e,n){var r,o,c=e.crossPadding,l=new Set,u=null,d=SA(e,c),h=function(b){return d?xA(d,b):!0},g=function(b,S){return!b||!b.firstChild?!0:!J_(b.firstChild,S.firstChild,so(n))};try{for(var v=(0,Q.XA)(t),m=v.next();!m.done;m=v.next()){var _=m.value;h(_)?!u||g(u,_)?u=_:(l.add(u),l.add(_)):l.add(_)}}catch(b){r={error:b}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}return Array.from(l)}function kg(t,e){return e===void 0&&(e={}),(0,be.Z)(t)?0:typeof t=="number"?t:Math.floor($_(t,e))}function wA(t,e,n,r){if(!(t.length<=0)){var o=e.suffix,c=o===void 0?"...":o,l=e.minLength,u=e.maxLength,d=u===void 0?1/0:u,h=e.step,g=h===void 0?" ":h,v=e.margin,m=v===void 0?[0,0,0,0]:v,_=Y_(r.getTextShape(t[0])),b=kg(g,_),S=l?kg(l,_):b,w=kg(d,_);((0,be.Z)(w)||w===1/0)&&(w=Math.max.apply(null,t.map(function(lt){return lt.getBBox().width})));for(var E=t.slice(),T=(0,Q.CR)(m,4),M=T[0],P=M===void 0?0:M,R=T[1],k=R===void 0?0:R,F=T[2],W=F===void 0?P:F,$=T[3],rt=$===void 0?k:$,et=function(lt){if(E.forEach(function(vt){r.ellipsis(r.getTextShape(vt),lt,c)}),E=jo(t,n,m),E.length<1)return{value:void 0}},ut=w;ut>S+b;ut-=b){var J=et(ut);if(typeof J=="object")return J.value}}}var OA=function(t){return t!==void 0&&t!=null&&!Number.isNaN(t)};function aI(t){var e=t&&t.getRenderBounds();if(!e)return{width:0,height:0};var n=e.getMax(),r=e.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function tb(t){var e=t.getLocalBounds(),n=e.min,r=e.max,o=(0,Q.CR)([n,r],2),c=(0,Q.CR)(o[0],2),l=c[0],u=c[1],d=(0,Q.CR)(o[1],2),h=d[0],g=d[1];return{x:l,y:u,width:h-l,height:g-u,left:l,bottom:g,top:u,right:h}}function sI(t,e){var n=select(t).append("text").node();return n.attr(__assign(__assign({},e),{visibility:"hidden"})),n}function Dg(t,e){var n=(0,Q.CR)(t,2),r=n[0],o=n[1],c=(0,Q.CR)(e,2),l=c[0],u=c[1];return r!==l&&o===u}function eb(t,e){var n=__read(t,2),r=n[0],o=n[1],c=__read(e,2),l=c[0],u=c[1];return r===l&&o!==u}function Ng(t,e){var n,r,o=e.attributes;try{for(var c=(0,Q.XA)(Object.entries(o)),l=c.next();!l.done;l=c.next()){var u=(0,Q.CR)(l.value,2),d=u[0],h=u[1];d!=="id"&&d!=="className"&&t.attr(d,h)}}catch(g){n={error:g}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}var xh={parity:function(t,e){var n=e.seq,r=n===void 0?2:n;return t.filter(function(o,c){return c%r?(Is(o),!1):!0})}},Sh=function(t){return t.filter(OA)};function Fg(t,e,n,r){var o=t.length,c=e.keepHeader,l=e.keepTail;if(!(o<=1||o===2&&c&&l)){var u=xh.parity,d=function(M){return M.forEach(r.show),M},h=2,g=t.slice(),v=t.slice(),m=Math.min.apply(Math,(0,Q.ev)([1],(0,Q.CR)(t.map(function(M){return M.getBBox().width})),!1));if(n.type==="linear"&&(Ag(n)||Tg(n))){var _=tb(t[0]).left,b=tb(t[o-1]).right,S=Math.abs(b-_)||1;h=Math.max(Math.floor(o*m/S),h)}var w,E;for(c&&(w=g.splice(0,1)[0]),l&&(E=g.splice(-1,1)[0],g.reverse()),d(g);h<t.length&&jo(Sh(E?(0,Q.ev)((0,Q.ev)([E],(0,Q.CR)(v),!1),[w],!1):(0,Q.ev)([w],(0,Q.CR)(v),!1)),n,e==null?void 0:e.margin).length;){if(E&&!w&&h%2===0){var T=g.splice(0,1);T.forEach(r.hide)}else if(E&&w){var T=g.splice(0,1);T.forEach(r.hide)}v=u(d(g),{seq:h}),h++}}}function Bg(t,e,n,r){var o,c,l=e.optionalAngles,u=l===void 0?[0,45,90]:l,d=e.margin,h=e.recoverWhenFailed,g=h===void 0?!0:h,v=t.map(function(E){return E.getLocalEulerAngles()}),m=function(){return jo(t,n,d).length<1},_=function(E){return t.forEach(function(T,M){var P=Array.isArray(E)?E[M]:E;r.rotate(T,+P)})};try{for(var b=(0,Q.XA)(u),S=b.next();!S.done;S=b.next()){var w=S.value;if(_(w),m())return}}catch(E){o={error:E}}finally{try{S&&!S.done&&(c=b.return)&&c.call(b)}finally{if(o)throw o.error}}g&&_(v)}function wh(t){var e=t.type,n=t.labelDirection;return e==="linear"&&Ag(t)?n==="negative"?"bottom":"top":"middle"}function rf(t,e,n,r,o){var c,l=e.maxLines,u=l===void 0?3:l,d=e.recoverWhenFailed,h=d===void 0?!0:d,g=e.margin,v=g===void 0?[0,0,0,0]:g,m=Fo((c=e.wordWrapWidth)!==null&&c!==void 0?c:50,[o]),_=t.map(function(M){return M.attr("maxLines")||1}),b=Math.min.apply(Math,(0,Q.ev)([],(0,Q.CR)(_),!1)),S=function(){return jo(t,n,v).length<1},w=wh(n),E=function(M){return t.forEach(function(P,R){var k=Array.isArray(M)?M[R]:M;r.wrap(P,m,k,w)})};if(!(b>u)){if(n.type==="linear"&&Ag(n)){if(E(u),S())return}else for(var T=b;T<=u;T++)if(E(T),S())return;h&&E(_)}}var Po=new Map([["hide",Fg],["rotate",Bg],["ellipsis",wA],["wrap",rf]]);function jg(t,e,n){return e.labelOverlap.length<1?!1:n==="hide"?!eA(t[0]):n==="rotate"?!t.some(function(r){var o;return!!(!((o=r.attr("transform"))===null||o===void 0)&&o.includes("rotate"))}):n==="ellipsis"||n==="wrap"?t.filter(function(r){return r.querySelector("text")}).length>=1:!0}function zg(t,e,n,r){var o=e.labelOverlap,c=o===void 0?[]:o;c.length&&c.forEach(function(l){var u=l.type,d=Po.get(u);jg(t,e,u)&&(d==null||d(t,l,e,r,n))})}function Ds(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(r){return r==="positive"?-1:1};return t.reduce(function(r,o){return r*n(o)},1)}function nb(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function Ug(t,e){var n=(0,Q.CR)(t,2),r=n[0],o=n[1],c=(0,Q.CR)(e,2),l=c[0],u=c[1],d=(0,Q.CR)([r*l+o*u,r*u-o*l],2),h=d[0],g=d[1];return Math.atan2(g,h)}function EA(t){var e=(t+360)%180;return ao(e,-90,90)||(e+=180),e}function rb(t,e,n){var r,o=n.labelAlign,c=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(c)return e.getLocalEulerAngles();var l=0,u=Ac(t.value,n),d=gh(t.value,n);return o==="horizontal"?0:(o==="perpendicular"?l=Ug([1,0],u):l=Ug([d[0]<0?-1:1,0],d),EA(iA(l)))}function Zg(t,e,n){var r=n.type,o=n.labelAlign,c=Ac(t,n),l=nb(e),u=nb(iA(Ug([1,0],c))),d="center",h="middle";return r==="linear"?[90,270].includes(u)&&l===0?(d="center",h=c[1]===1?"top":"bottom"):!(u%180)&&[90,270].includes(l)?d="center":u===0?(ao(l,0,90,!1,!0)||ao(l,0,90)||ao(l,270,360))&&(d="start"):u===90?ao(l,0,90,!1,!0)?d="start":(ao(l,90,180)||ao(l,270,360))&&(d="end"):u===270?ao(l,0,90,!1,!0)?d="end":(ao(l,90,180)||ao(l,270,360))&&(d="start"):u===180&&(l===90?d="start":(ao(l,0,90)||ao(l,270,360))&&(d="end")):o==="parallel"?ao(u,0,180,!0)?h="top":h="bottom":o==="horizontal"?ao(u,90,270,!1)?d="end":(ao(u,270,360,!1)||ao(u,0,90))&&(d="start"):o==="perpendicular"&&(ao(u,90,270)?d="end":d="start"),{textAlign:d,textBaseline:h}}function of(t,e,n){e.setLocalEulerAngles(t);var r=e.__data__.value,o=Zg(r,t,n),c=e.querySelector(Qn.labelItem.class);c&&ab(c,o)}function ib(t,e,n){var r=n.showTick,o=n.tickLength,c=n.tickDirection,l=n.labelDirection,u=n.labelSpacing,d=e.indexOf(t),h=Fo(u,[t,d,e]),g=(0,Q.CR)([Ac(t.value,n),Ds(l,c)],2),v=g[0],m=g[1],_=m===1?Fo(r?o:0,[t,d,e]):0,b=(0,Q.CR)(wl(Ia(v,h+_),mh(t.value,n)),2),S=b[0],w=b[1];return{x:S,y:w}}function AA(t,e,n,r){var o=r.labelFormatter,c=(0,Eo.Z)(o)?function(){return _r(Fo(o,[t,e,n,Ac(t.value,r)]))}:function(){return _r(t.label||"")};return c}function TA(t,e,n,r){var o=r.labelRender,c=(er(r,"endPos.0",400)-er(r,"startPos.0",0))/n.length,l=(0,Eo.Z)(o)?Fo(o,[t,e,n,Ac(t.value,r)]):t.label||"",u=vA(l)||30;return function(){return Ml(l,{width:c,height:u})}}var ob={html:["fill"],text:[]};function ab(t,e){["text","html"].includes(t.nodeName)&&t.attr(Eg(e,ob[t.nodeName]))}function MA(t,e){zg(this.node().childNodes,t,e,{hide:Is,show:Ku,rotate:function(n,r){of(+r,n,t)},ellipsis:function(n,r,o){n&&Ig(n,r||1/0,o)},wrap:function(n,r,o){n&&X_(n,r,o)},getTextShape:function(n){return n.querySelector(Qn.labelItem.class)}})}function sb(t,e,n,r,o){var c=n.indexOf(e),l=o.labelRender,u=o.classNamePrefix,d=ot(t).append(l?TA(e,c,n,o):AA(e,c,n,o)).attr("className",Qn.labelItem.name).node();Bo(ot(d),Qn.labelItem,jr.labelItem,u);var h=(0,Q.CR)(us(Z_(r,[e,c,n])),2),g=h[0],v=h[1],m=v.transform,_=(0,Q._T)(v,["transform"]);K_(d,m);var b=rb(e,d,o);if(d.getLocalEulerAngles()||d.setLocalEulerAngles(b),ab(d,(0,Q.pi)((0,Q.pi)({},Zg(e.value,b,o)),g)),d.nodeName==="html"){var S=d.getBBox(),w=d.style.x||0;d.attr("x",w-S.width/2)}return t.attr(_),d}function Mc(t,e,n,r,o){var c=n.classNamePrefix,l=Ec(e,n.labelFilter),u=or(n,"label"),d,h=t.selectAll(Qn.label.class).data(l,function(g,v){return v}).join(function(g){var v=g.append("g").attr("className",Qn.label.name).transition(function(m){sb(this,m,e,u,n);var _=ib(m,e,n),b=_.x,S=_.y;return this.style.transform="translate(".concat(b,", ").concat(S,")"),null});return Bo(v,Qn.label,jr.label,c),v},function(g){return g.transition(function(v){var m=this.querySelector(Qn.labelItem.class),_=sb(this,v,e,u,n),b=JE(m,_,r.update),S=ib(v,e,n),w=S.x,E=S.y,T=_o(this,{transform:"translate(".concat(w,", ").concat(E,")")},r.update);return(0,Q.ev)((0,Q.ev)([],(0,Q.CR)(b),!1),[T],!1)})},function(g){return d=g,g.transition(function(){var v=this,m=dh(this.childNodes[0],r.exit);return La(m,function(){return ot(v).remove()}),m}),d}).transitions();return R_(h,function(){MA.call(t,n,o)}),h}function Oh(t,e){return vh(t,e.tickDirection,e)}function Eh(t,e){var n=(0,Q.CR)(t,2),r=n[0],o=n[1];return[[0,0],[r*e,o*e]]}function Hg(t,e,n,r,o){var c=o.tickLength,l=(0,Q.CR)(Eh(r,Fo(c,[t,e,n])),2),u=(0,Q.CR)(l[0],2),d=u[0],h=u[1],g=(0,Q.CR)(l[1],2),v=g[0],m=g[1];return{x1:d,x2:v,y1:h,y2:m}}function af(t,e,n,r,o){var c=o.tickFormatter,l=o.classNamePrefix,u=Oh(e.value,o),d="line";(0,Eo.Z)(c)&&(d=function(){return Fo(c,[e,n,r,u])});var h=t.append(d).attr("className",Qn.tickItem.name);return Bo(h,Qn.tickItem,jr.tickItem,l),h}function Wg(t,e,n,r,o,c,l){var u=Oh(t.value,c),d=Hg(t,e,n,u,c),h=d.x1,g=d.x2,v=d.y1,m=d.y2,_=(0,Q.CR)(us(Z_(l,[t,e,n,u])),2),b=_[0],S=_[1];r.node().nodeName==="line"&&r.styles((0,Q.pi)({x1:h,x2:g,y1:v,y2:m},b)),o.attr(S),r.styles(b)}function Ah(t,e,n,r,o,c){var l=af(ot(this),t,e,n,r);Wg(t,e,n,l,this,r,o);var u=(0,Q.CR)(mh(t.value,r),2),d=u[0],h=u[1];return _o(this,{transform:"translate(".concat(d,", ").concat(h,")")},c)}function sf(t,e,n,r){var o=n.classNamePrefix,c=Ec(e,n.tickFilter),l=or(n,"tick");return t.selectAll(Qn.tick.class).data(c,function(u){return u.id||u.label}).join(function(u){var d=u.append("g").attr("className",Qn.tick.name).transition(function(h,g){return Ah.call(this,h,g,c,n,l,!1)});return Bo(d,Qn.tick,jr.tick,o),d},function(u){return u.transition(function(d,h){return this.removeChildren(),Ah.call(this,d,h,c,n,l,r.update)})},function(u){return u.transition(function(){var d=this,h=dh(this.childNodes[0],r.exit);return La(h,function(){return d.remove()}),h})}).transitions()}function Ll(t){return/\S+-\S+/g.test(t)?t.split("-").map(function(e){return e[0]}):t.length>2?[t[0]]:t.split("")}function cf(t,e,n){var r=n.titlePosition,o=r===void 0?"lb":r,c=n.titleSpacing,l=Ll(o),u=t.node().getLocalBounds(),d=(0,Q.CR)(u.min,2),h=d[0],g=d[1],v=(0,Q.CR)(u.halfExtents,2),m=v[0],_=v[1],b=(0,Q.CR)(e.node().getLocalBounds().halfExtents,2),S=b[0],w=b[1],E=(0,Q.CR)([h+m,g+_],2),T=E[0],M=E[1],P=(0,Q.CR)(so(c),4),R=P[0],k=P[1],F=P[2],W=P[3];if(["start","end"].includes(o)&&n.type==="linear"){var $=n.startPos,rt=n.endPos,et=(0,Q.CR)(o==="start"?[$,rt]:[rt,$],2),ut=et[0],J=et[1],lt=wg([-J[0]+ut[0],-J[1]+ut[1]]),vt=(0,Q.CR)(Ia(lt,R),2),xt=vt[0],Ht=vt[1];return{x:ut[0]+xt,y:ut[1]+Ht}}return l.includes("t")&&(M-=_+w+R),l.includes("r")&&(T+=m+S+k),l.includes("l")&&(T-=m+S+W),l.includes("b")&&(M+=_+w+F),{x:T,y:M}}function Th(t,e,n){var r=t.getGeometryBounds().halfExtents,o=r[1]*2;if(e==="vertical"){if(n==="left")return"rotate(-90) translate(0, ".concat(o/2,")");if(n==="right")return"rotate(-90) translate(0, -".concat(o/2,")")}return""}function pa(t,e,n,r,o){var c=or(r,"title"),l=(0,Q.CR)(us(c),2),u=l[0],d=l[1],h=d.transform,g=d.transformOrigin,v=(0,Q._T)(d,["transform","transformOrigin"]);e.styles(v);var m=h||Th(t.node(),u.direction,u.position);t.styles((0,Q.pi)((0,Q.pi)({},u),{transformOrigin:g})),K_(t.node(),m);var _=cf(ot(n._offscreen||n.querySelector(Qn.mainGroup.class)),e,r),b=_.x,S=_.y,w=_o(e.node(),{transform:"translate(".concat(b,", ").concat(S,")")},o);return w}function Vg(t,e,n,r){var o=n.titleText,c=n.classNamePrefix;return t.selectAll(Qn.title.class).data([{title:o}].filter(function(l){return!!l.title}),function(l,u){return l.title}).join(function(l){var u=l.append(function(){return _r(o)}).attr("className",Qn.title.name).transition(function(){return pa(ot(this),t,e,n,r.enter)});return Bo(u,Qn.title,jr.title,c),u},function(l){return l.transition(function(){return pa(ot(this),t,e,n,r.update)})},function(l){return l.remove()}).transitions()}function Mh(t,e,n,r){var o=t.showLine,c=t.showTick,l=t.showLabel,u=t.classNamePrefix,d=e.maybeAppendByClassName(Qn.lineGroup,"g");Bo(d,Qn.lineGroup,jr.lineGroup,u);var h=Oo(o,d,function(b){return hA(b,t,r)})||[],g=e.maybeAppendByClassName(Qn.tickGroup,"g");Bo(g,Qn.tickGroup,jr.tickGroup,u);var v=Oo(c,g,function(b){return sf(b,n,t,r)})||[],m=e.maybeAppendByClassName(Qn.labelGroup,"g");Bo(m,Qn.labelGroup,jr.labelGroup,u);var _=Oo(l,m,function(b){return Mc(b,n,t,r,e.node())})||[];return(0,Q.ev)((0,Q.ev)((0,Q.ev)([],(0,Q.CR)(h),!1),(0,Q.CR)(v),!1),(0,Q.CR)(_),!1).filter(function(b){return!!b})}var Gg=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,Sg)||this}return e.prototype.render=function(n,r,o){var c=this,l=n.titleText,u=n.data,d=n.animate,h=n.showTitle,g=n.showGrid,v=n.dataThreshold,m=n.truncRange,_=n.classNamePrefix,b=r.className||"axis";_?r.attr("className","".concat(b," ").concat(_,"axis")):r.className||r.attr("className","axis");var S=j_(u,v).filter(function(F){var W=F.value;return!(m&&W>m[0]&&W<m[1])}),w=I_(o===void 0?d:o),E=ot(r).maybeAppendByClassName(Qn.gridGroup,"g");Bo(E,Qn.gridGroup,jr.gridGroup,_);var T=Oo(g,E,function(F){return gA(F,S,n,w)})||[],M=ot(r).maybeAppendByClassName(Qn.mainGroup,"g");Bo(M,Qn.mainGroup,jr.mainGroup,_),l&&(!this.initialized&&w.enter||this.initialized&&w.update)&&Mh(n,ot(this.offscreenGroup),S,I_(!1));var P=Mh(n,ot(M.node()),S,w),R=ot(r).maybeAppendByClassName(Qn.titleGroup,"g");Bo(R,Qn.titleGroup,jr.titleGroup,_);var k=Oo(h,R,function(F){return Vg(F,c,n,w)})||[];return(0,Q.ev)((0,Q.ev)((0,Q.ev)([],(0,Q.CR)(T),!1),(0,Q.CR)(P),!1),(0,Q.CR)(k),!1).flat().filter(function(F){return!!F})},e}(Gi);function Jo(t){if(bc(t)){var e=t;return e[e.length-1]}}var ta=function(t){return t};function lf(t,e){return e-t?n=>(n-t)/(e-t):n=>.5}function uf(t,...e){return e.reduce((n,r)=>o=>n(r(o)),t)}function Ch(t,e,n,r,o){let c=n||0,l=r||t.length;const u=o||(d=>d);for(;c<l;){const d=Math.floor((c+l)/2);u(t[d])>e?l=d:c=d+1}return c}var CA=L(19818),cb=L.n(CA);function $g(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function PA(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,o=t[3];if(n===0)return[r*255,r*255,r*255,o];const c=r<.5?r*(1+n):r+n-r*n,l=2*r-c,u=$g(l,c,e+1/3),d=$g(l,c,e),h=$g(l,c,e-1/3);return[u*255,d*255,h*255,o]}function lb(t){const e=cb().get(t);if(!e)return null;const{model:n,value:r}=e;return n==="rgb"?r:n==="hsl"?PA(r):null}const Il=(t,e)=>n=>t*(1-n)+e*n,LA=(t,e)=>{const n=lb(t),r=lb(e);return n===null||r===null?n?()=>t:()=>e:o=>{const c=new Array(4);for(let g=0;g<4;g+=1){const v=n[g],m=r[g];c[g]=v*(1-o)+m*o}const[l,u,d,h]=c;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(d)}, ${h})`}},Rl=(t,e)=>typeof t=="number"&&typeof e=="number"?Il(t,e):typeof t=="string"&&typeof e=="string"?LA(t,e):()=>t,IA=(t,e)=>{const n=Il(t,e);return r=>Math.round(n(r))};var kl=L(71154);function ub(t){return t===null}function Ph(t){return!(0,kl.Z)(t)&&!ub(t)&&!Number.isNaN(t)}const Yg=(t,e,n=5)=>{const r=[t,e];let o=0,c=r.length-1,l=r[o],u=r[c],d;return u<l&&([l,u]=[u,l],[o,c]=[c,o]),d=Gd(l,u,n),d>0?(l=Math.floor(l/d)*d,u=Math.ceil(u/d)*d,d=Gd(l,u,n)):d<0&&(l=Math.ceil(l*d)/d,u=Math.floor(u*d)/d,d=Gd(l,u,n)),d>0?(r[o]=Math.floor(l/d)*d,r[c]=Math.ceil(u/d)*d):d<0&&(r[o]=Math.ceil(l*d)/d,r[c]=Math.floor(u*d)/d),r};function fb(t,e){const n=e<t?e:t,r=t>e?t:e;return o=>Math.min(Math.max(n,o),r)}const RA=(t,e,n)=>{const[r,o]=t,[c,l]=e;let u,d;return r<o?(u=lf(r,o),d=n(c,l)):(u=lf(o,r),d=n(l,c)),uf(d,u)},db=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,o=new Array(r),c=new Array(r),l=t[0]>t[r],u=l?[...t].reverse():t,d=l?[...e].reverse():e;for(let h=0;h<r;h+=1)o[h]=lf(u[h],u[h+1]),c[h]=n(d[h],d[h+1]);return h=>{const g=Ch(t,h,1,r)-1,v=o[g],m=c[g];return uf(m,v)(h)}},hb=(t,e,n,r)=>(Math.min(t.length,e.length)>2?db:RA)(t,e,r?IA:n);class ff extends Vu{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Il,tickCount:5}}map(e){return Ph(e)?this.output(e):this.options.unknown}invert(e){return Ph(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice||(0,Br.Z)(this.options.breaks))return;const[e,n,r,...o]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,n,r,...o)}getTicks(){const{tickMethod:e}=this.options,[n,r,o,...c]=this.getTickMethodOptions();return e(n,r,o,...c)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],o=e[e.length-1];return[r,o,n]}chooseNice(){return Yg}rescale(){this.nice();const[e,n]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,n,this.chooseClamp(n))}chooseClamp(e){const{clamp:n,range:r}=this.options,o=this.options.domain.map(e),c=Math.min(o.length,r.length);return n?fb(o[0],o[c-1]):ta}composeOutput(e,n){const{domain:r,range:o,round:c,interpolate:l}=this.options,u=hb(r.map(e),o,l,c);this.output=uf(u,n,e)}composeInput(e,n,r){const{domain:o,range:c}=this.options,l=hb(c,o.map(e),Il);this.input=uf(n,r,l)}}class ga extends ff{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Rl,tickMethod:os,tickCount:5}}removeUnsortedValues(e,n,r){let o=-1/0;return n.reduce((l,u,d)=>{if(d===0)return l;const h=o>0?o:u;return o>0&&(r?u>o:u<o)?l.push(d):(h-n[d-1])*(r?-1:1)<0?(o<0&&(o=n[d-1]),l.push(d)):o=-1/0,l},[]).slice().reverse().forEach(l=>{e.splice(l,1),n.splice(l,1)}),{breaksDomain:e,breaksRange:n}}transformDomain(e){const n=[.2,.8],r=.03,{domain:o=[],range:c=[1,0],breaks:l=[],tickCount:u=5,nice:d}=e,[h,g]=[Math.min(...o),Math.max(...o)];let v=h,m=g;if(d&&l.length<2){const $=this.chooseNice()(h,g,u);v=$[0],m=$[$.length-1]}const _=Math.min(v,h);let b=Math.max(m,g);const S=l.filter(({end:$})=>$<b).sort(($,rt)=>$.start-rt.start),w=os(_,b,u,S);if(Jo(w)<b){const $=Yg(0,b-Jo(w),3);w.push(Jo(w)+Jo($)),b=Jo(w)}const[E,T]=[c[0],Jo(c)],M=b-_,P=Math.abs(T-E),R=E>T,k=w.map($=>{const rt=($-_)/M;return R?E-rt*P:E+rt*P}),[F,W]=n;return S.forEach(({start:$,end:rt,gap:et=r,compress:ut="middle"})=>{const J=w.indexOf($),lt=w.indexOf(rt);let vt=(k[J]+k[lt])/2;ut==="start"&&(vt=k[J]),ut==="end"&&(vt=k[lt]);const xt=et*P/2;let Ht=R?vt+xt:vt-xt,gt=R?vt-xt:vt+xt;Ht<F&&(gt+=F-Ht,Ht=F),gt>W&&(Ht-=gt-W,gt=W),Ht>W&&(gt-=Ht-W,Ht=W),gt<F&&(Ht+=F-gt,gt=F),k[J]=Ht,k[lt]=gt}),this.removeUnsortedValues(w,k,R)}transformBreaks(e){const{domain:n,breaks:r=[]}=e;if(!(0,Br.Z)(e.breaks))return e;const o=Math.max(...n),c=r.filter(({end:h})=>h<o),l=fc(To({},e),{breaks:c}),{breaksDomain:u,breaksRange:d}=this.transformDomain(l);return fc(To({},e),{domain:u,range:d,breaks:c,tickMethod:()=>[...u]})}chooseTransforms(){return[ta,ta]}clone(){return new ga(this.options)}}function pb(t,e){if(t){var n;if((0,Br.Z)(t))for(var r=0,o=t.length;r<o&&(n=e(t[r],r),n!==!1);r++);else if((0,Jd.Z)(t)){for(var c in t)if(t.hasOwnProperty(c)&&(n=e(t[c],c),n===!1))break}}}var Lh=pb,kA=function(t,e,n){if(!(0,Br.Z)(t)&&!is(t))return t;var r=n;return Lh(t,function(o,c){r=e(r,o,c)}),r},gb=kA,Xg=function(t,e){return gb(t,function(n,r,o){return e.includes(o)||(n[o]=r),n},{})};function ds(t,e){let n,r;if(e===void 0)for(const o of t)o!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)));else{let o=-1;for(let c of t)(c=e(c,++o,t))!=null&&(n===void 0?c>=c&&(n=r=c):(n>c&&(n=c),r<c&&(r=c)))}return[n,r]}var Jr=function(){function t(e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=0),o===void 0&&(o=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=n,this.width=r,this.height=o}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(e,n){return e>=this.left&&e<=this.right&&n>=this.top&&n<=this.bottom},t}();function cI(t){var e=t.getRenderBounds(),n=__read(e.min,2),r=n[0],o=n[1],c=__read(e.max,2),l=c[0],u=c[1],d=l-r,h=u-o;return new Jr(r,o,d,h)}function vb(t){for(var e=1/0,n=1/0,r=-1/0,o=-1/0,c=0;c<t.length;c++){var l=t[c],u=l.x,d=l.y,h=l.width,g=l.height,v=(0,Q.CR)([u+h,d+g],2),m=v[0],_=v[1];u<e&&(e=u),d<n&&(n=d),m>r&&(r=m),_>o&&(o=_)}return new Jr(e,n,r-e,o-n)}var DA=function(t,e,n){var r=t.width,o=t.height,c=n.flexDirection,l=c===void 0?"row":c,u=n.flexWrap,d=u===void 0?"nowrap":u,h=n.justifyContent,g=h===void 0?"flex-start":h,v=n.alignContent,m=v===void 0?"flex-start":v,_=n.alignItems,b=_===void 0?"flex-start":_,S=l==="row",w=l==="row"||l==="column",E=S?w?[1,0]:[-1,0]:w?[0,1]:[0,-1],T=(0,Q.CR)([0,0],2),M=T[0],P=T[1],R=e.map(function(J){var lt,vt=J.width,xt=J.height,Ht=(0,Q.CR)([M,P],2),gt=Ht[0],wt=Ht[1];return lt=(0,Q.CR)([M+vt*E[0],P+xt*E[1]],2),M=lt[0],P=lt[1],new Jr(gt,wt,vt,xt)}),k=vb(R),F={"flex-start":0,"flex-end":S?r-k.width:o-k.height,center:S?(r-k.width)/2:(o-k.height)/2},W=R.map(function(J){var lt=J.x,vt=J.y,xt=Jr.fromRect(J);return xt.x=S?lt+F[g]:lt,xt.y=S?vt:vt+F[g],xt}),$=vb(W),rt=function(J){var lt=(0,Q.CR)(S?["height",o]:["width",r],2),vt=lt[0],xt=lt[1];switch(b){case"flex-start":return 0;case"flex-end":return xt-J[vt];case"center":return xt/2-J[vt]/2;default:return 0}},et=W.map(function(J){var lt=J.x,vt=J.y,xt=Jr.fromRect(J);return xt.x=S?lt:lt+rt(xt),xt.y=S?vt+rt(xt):vt,xt}),ut=et.map(function(J){var lt,vt,xt=Jr.fromRect(J);return xt.x+=(lt=t.x)!==null&&lt!==void 0?lt:0,xt.y+=(vt=t.y)!==null&&vt!==void 0?vt:0,xt});return ut},NA=function(t,e,n){return[]},FA=function(t,e,n){if(e.length===0)return[];var r={flex:DA,grid:NA},o=n.display in r?r[n.display]:null;return(o==null?void 0:o.call(null,t,e,n))||[]},BA=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n)||this;r.layoutEvents=[N.Dk.BOUNDS_CHANGED,N.Dk.INSERTED,N.Dk.REMOVED],r.$margin=so(0),r.$padding=so(0);var o=n.style||{},c=o.margin,l=c===void 0?0:c,u=o.padding,d=u===void 0?0:u;return r.margin=l,r.padding=d,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(n){this.$margin=so(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(n){this.$padding=so(n)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.x,o=r===void 0?0:r,c=n.y,l=c===void 0?0:c,u=n.width,d=n.height,h=(0,Q.CR)(this.$margin,4),g=h[0],v=h[1],m=h[2],_=h[3];return new Jr(o-_,l-g,u+_+v,d+g+m)},e.prototype.appendChild=function(n,r){return n.isMutationObserved=!0,t.prototype.appendChild.call(this,n,r),n},e.prototype.getAvailableSpace=function(){var n=this.attributes,r=n.width,o=n.height,c=(0,Q.CR)(this.$padding,4),l=c[0],u=c[1],d=c[2],h=c[3],g=(0,Q.CR)(this.$margin,4),v=g[0],m=g[3];return new Jr(h+m,l+v,r-h-u,o-l-d)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(l){return!l.isConnected}))try{var n=this.attributes,r=n.x,o=n.y;this.style.transform="translate(".concat(r,", ").concat(o,")");var c=FA(this.getAvailableSpace(),this.children.map(function(l){return l.getBBox()}),this.attributes);this.children.forEach(function(l,u){var d=c[u],h=d.x,g=d.y;l.style.transform="translate(".concat(h,", ").concat(g,")")})}catch(l){}},e.prototype.bindEvents=function(){var n=this;this.layoutEvents.forEach(function(r){n.addEventListener(r,function(o){o.target&&(o.target.isMutationObserved=!0,n.layout())})})},e.prototype.attributeChangedCallback=function(n,r,o){n==="margin"?this.margin=o:n==="padding"&&(this.padding=o),this.layout()},e}(N.ZA),jA=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function qg(t){return class extends N.b_{constructor(e){super(e),this.descriptor=t}connectedCallback(){var e,n;(n=(e=this.descriptor).render)===null||n===void 0||n.call(e,this.attributes,this)}update(e={}){var n,r;this.attr(nn({},this.attributes,e)),(r=(n=this.descriptor).render)===null||r===void 0||r.call(n,this.attributes,this)}}}function mb(t,e,n){return t.querySelector(e)?Kn(t).select(e):Kn(t).append(n)}function Ih(t){return Array.isArray(t)?t.join(", "):`${t||""}`}function yb(t,e){const n={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:r,justifyContent:o,alignItems:c}=n;const l={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return t in l&&([r,o,c]=l[t]),Object.assign({display:"flex",flexDirection:r,justifyContent:o,alignItems:c},e)}class _b extends BA{get child(){var e;return(e=this.children)===null||e===void 0?void 0:e[0]}update(e){var n;const{subOptions:r}=e;(n=this.child)===null||n===void 0||n.update(r),this.attr(e)}}class zA extends _b{update(e){var n;const{subOptions:r}=e;(n=this.child)===null||n===void 0||n.update(r),this.attr(e)}}function Ra(t,e){var n;return(n=t.filter(r=>r.getOptions().name===e))===null||n===void 0?void 0:n[0]}function UA(t){return t==="horizontal"||t===0}function ZA(t){return t==="vertical"||t===-Math.PI/2}function bb(t,e,n){const{bbox:r}=t,{position:o="top",size:c,length:l}=e,u=["top","bottom","center"].includes(o),[d,h]=u?[r.height,r.width]:[r.width,r.height],{defaultSize:g,defaultLength:v}=n.props,m=c||g||d,_=l||v||h,b=u?"horizontal":"vertical",[S,w]=u?[_,m]:[m,_];return{orientation:b,width:S,height:w,size:m,length:_}}function HA(t){return t.find(e=>e.getOptions().domain.length>0).getOptions().domain}function Rh(t){const e=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:n}=t,r=jA(t,["style"]),o={};return Object.entries(r).forEach(([c,l])=>{e.includes(c)?o[`show${Ls(c)}`]=l:o[c]=l}),Object.assign(Object.assign({},o),n)}var xb=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Sb(t,e){const{eulerAngles:n,origin:r}=e;r&&t.setOrigin(r),n&&t.rotate(n[0],n[1],n[2])}function wb(t){const{innerWidth:e,innerHeight:n,depth:r}=t.getOptions();return[e,n,r]}function WA(t,e){const{width:n,height:r}=e.getOptions();return o=>{if(!T_(e))return o;const c=t==="bottom"?[o,1]:[0,o],l=e.map(c);if(t==="bottom"){const u=l[0];return new ga({domain:[0,n],range:[0,1]}).map(u)}else if(t==="left"){const u=l[1];return new ga({domain:[0,r],range:[0,1]}).map(u)}return o}}function VA(t,e,n){if(t.getTicks)return t.getTicks();if(!n)return e;const[r,o]=ds(e,l=>+l),{tickCount:c}=t.getOptions();return n(r,o,c)}function GA(t,e){if(kr(e))return _=>_;const n=e.getOptions(),{innerWidth:r,innerHeight:o,insetTop:c,insetBottom:l,insetLeft:u,insetRight:d}=n,[h,g,v]=t==="left"||t==="right"?[c,l,o]:[u,d,r],m=new ga({domain:[0,1],range:[h/v,1-g/v]});return _=>m.map(_)}function Ob(t,e,n,r,o,c,l,u){var d;(n!==void 0||c!==void 0)&&t.update(Object.assign(Object.assign({},n&&{tickCount:n}),c&&{tickMethod:c}));const h=VA(t,e,c),g=o?h.filter(o):h,v=E=>E instanceof Date?String(E):typeof E=="object"&&E?E:String(E),m=r||((d=t.getFormatter)===null||d===void 0?void 0:d.call(t))||v,_=GA(l,u),b=WA(l,u),S=E=>["top","bottom","center","outer"].includes(E),w=E=>["left","right"].includes(E);return kr(u)||Yr(u)?g.map((E,T,M)=>{var P,R;const k=((P=t.getBandWidth)===null||P===void 0?void 0:P.call(t,E))/2||0,F=_(t.map(E)+k);return{value:qu(u)&&l==="center"||Yr(u)&&((R=t.getTicks)===null||R===void 0?void 0:R.call(t))&&S(l)||Yr(u)&&w(l)?1-F:F,label:v(m(ah(E),T,M)),id:String(T)}}):g.map((E,T,M)=>{var P;const R=((P=t.getBandWidth)===null||P===void 0?void 0:P.call(t,E))/2||0,k=b(_(t.map(E)+R));return{value:w(l)?1-k:k,label:v(m(ah(E),T,M)),id:String(T)}})}function $A(t,e,n="xy"){const[r,o,c]=wb(e);return n==="xy"?t.includes("bottom")||t.includes("top")?o:r:n==="xz"?t.includes("bottom")||t.includes("top")?c:r:t.includes("bottom")||t.includes("top")?o:c}function YA(t=[],e){if(t.length>0)return t;const{labelAutoRotate:n,labelAutoHide:r,labelAutoEllipsis:o,labelAutoWrap:c}=e,l=[],u=(d,h)=>{h&&l.push(Object.assign(Object.assign({},d),h))};return u({type:"rotate",optionalAngles:[0,15,30,45,60,90]},n),u({type:"ellipsis",minLength:20},o),u({type:"hide"},r),u({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},c),l}function XA(t,e,n,r,o){const{x:c,y:l,width:u,height:d}=e,h=[c+u/2,l+d/2],g=Math.min(u,d)/2,[v,m]=mg(o),[_,b]=wb(o),S=Math.min(_,b)/2,w={center:h,radius:g,startAngle:v,endAngle:m,gridLength:(r-n)*S};if(t==="inner"){const{insetLeft:E,insetTop:T}=o.getOptions();return Object.assign(Object.assign({},w),{center:[h[0]-E,h[1]-T],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},w),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function qA(t,e,n){return C_(e)||xl(e)?!1:t===void 0?!!n.getTicks:t}function KA(t){const{depth:e}=t.getOptions();return e?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function QA(t,e,n,r,o){const{x:c,y:l,width:u,height:d}=n;if(t==="bottom")return{startPos:[c,l],endPos:[c+u,l]};if(t==="left")return{startPos:[c+u,l+d],endPos:[c+u,l]};if(t==="right")return{startPos:[c,l+d],endPos:[c,l]};if(t==="top")return{startPos:[c,l+d],endPos:[c+u,l+d]};if(t==="center"){if(e==="vertical")return{startPos:[c,l],endPos:[c,l+d]};if(e==="horizontal")return{startPos:[c,l],endPos:[c+u,l]};if(typeof e=="number"){const[h,g]=r.getCenter(),[v,m]=sh(r),[_,b]=mg(r),S=Math.min(u,d)/2,{insetLeft:w,insetTop:E}=r.getOptions(),T=v*S,M=m*S,[P,R]=[h+c-w,g+l-E],[k,F]=[Math.cos(e),Math.sin(e)],W=[P+M*k,R+M*F],$=[P+T*k,R+T*F],rt=()=>{const{domain:ut}=o.getOptions();return ut.length},et=kr(r)&&o?rt():3;return{startPos:W,endPos:$,gridClosed:Math.abs(b-_-360)<1e-6,gridCenter:[P,R],gridControlAngles:new Array(et).fill(0).map((ut,J,lt)=>(b-_)/et*J)}}}return{}}const JA=t=>{const{order:e,size:n,position:r,orientation:o,labelFormatter:c,tickFilter:l,tickCount:u,tickMethod:d,tickLength:h,important:g={},style:v={},indexBBox:m,title:_,grid:b=!1}=t,S=xb(t,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","tickLength","important","style","indexBBox","title","grid"]);return({scales:[w],value:E,coordinate:T,theme:M})=>{const{bbox:P}=E,{domain:R}=w.getOptions(),k=Ob(w,R,u,c,l,d,r,T),F=m?k.map((lt,vt)=>{const xt=m.get(vt);return!xt||xt[0]!==lt.label?lt:Object.assign(Object.assign({},lt),{bbox:xt[1]})}):k,[W,$]=sh(T),rt=XA(r,P,W,$,T),{axis:et,axisArc:ut={}}=M,J=Rh(nn({},et,ut,rt,Object.assign(Object.assign(Object.assign({type:"arc",data:F,titleText:Ih(_),grid:b,classNamePrefix:cs},h!==void 0?{tickLength:h}:null),S),g)));return new Gg({style:Xg(J,["transform"])})}};function tT(t,e,n,r,o,c){const l=n.axis,u=["top","right","bottom","left"].includes(o)?n[`axis${J0(o)}`]:n.axisLinear,d=t.getOptions().name,h=n[`axis${Ls(d)}`]||{};return Object.assign({},l,u,h)}function eT(t,e,n,r,o,c){const l=tT(t,e,n,r,o,c);return o==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},l),{labelDirection:r==="right"?"negative":"positive"}),r==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:r==="right"?"negative":"positive",labelSpacing:r==="center"?0:4,titleSpacing:ZA(c)?10:0,tick:r==="center"?!1:void 0}):l}const Eb=t=>{const{direction:e="left",important:n={},labelFormatter:r,order:o,orientation:c,actualPosition:l,position:u,size:d,style:h={},title:g,tickCount:v,tickFilter:m,tickMethod:_,tickLength:b,transform:S,indexBBox:w}=t,E=xb(t,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","tickLength","transform","indexBBox"]);return({scales:T,value:M,coordinate:P,theme:R})=>{const{bbox:k}=M,[F]=T,{domain:W,xScale:$}=F.getOptions(),rt=eT(F,P,R,e,u,c),et=Object.assign(Object.assign(Object.assign({},rt),h),E),ut=$A(l||u,P,t.plane),J=QA(u,c,k,P,$),lt=KA(P),vt=Ob(F,W,v,r,m,_,u,P),xt=w?vt.map((wt,Wt)=>{const fe=w.get(Wt);return!fe||fe[0]!==wt.label?wt:Object.assign(Object.assign({},wt),{bbox:fe[1]})}):vt,Ht=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},et),{type:"linear",data:xt,crossSize:d,titleText:Ih(g),labelOverlap:YA(S,et),grid:qA(et.grid,P,F),gridLength:ut,line:!0,indexBBox:w,classNamePrefix:cs}),b!==void 0?{tickLength:b}:null),et.line?null:{lineOpacity:0}),J),lt),n);return Ht.labelOverlap.find(wt=>wt.type==="hide")&&(Ht.crossSize=!1),new Gg({className:"axis",style:Rh(Ht)})}},Ab=t=>e=>{const{labelFormatter:n,labelFilter:r=()=>!0}=e;return o=>{var c;const{scales:[l]}=o,u=((c=l.getTicks)===null||c===void 0?void 0:c.call(l))||l.getOptions().domain,d=typeof n=="string"?ss(n):n,h=(v,m,_)=>r(u[m],m,u),g=Object.assign(Object.assign({},e),{labelFormatter:d,labelFilter:h,scale:l});return t(g)(o)}},Ns=Ab(Eb),Dl=Ab(JA);Ns.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},Dl.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var kh=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function co(t){const e=t%(Math.PI*2);return e===Math.PI/2?{titleTransform:"translate(0, 50%)"}:e>-Math.PI/2&&e<Math.PI/2?{titleTransform:"translate(50%, 0)"}:e>Math.PI/2&&e<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function Tb(t,e,n,r){const{radar:o}=t,[c]=r,l=c.getOptions().name,[u,d]=mg(n),{axisRadar:h={}}=e;return Object.assign(Object.assign({},h),{grid:l==="position",gridConnect:"line",gridControlAngles:new Array(o.count).fill(0).map((g,v)=>(d-u)/o.count*v)})}const Mb=t=>{const{important:e={}}=t,n=kh(t,["important"]);return r=>{const{theme:o,coordinate:c,scales:l}=r;return Ns(Object.assign(Object.assign(Object.assign({},n),co(t.orientation)),{important:Object.assign(Object.assign({},Tb(t,o,c,l)),e)}))(r)}};Mb.props=Object.assign(Object.assign({},Ns.props),{defaultPosition:"center"});class Cb{constructor(e){this.options=nn({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=nn({},this.options,e),this.rescale(e)}rescale(e){}}function Kg(t,e){return e-t?n=>(n-t)/(e-t):n=>.5}function Dh(t,...e){return e.reduce((n,r)=>o=>n(r(o)),t)}function Pb(t,e,n,r,o){let c=n||0,l=r||t.length;const u=o||(d=>d);for(;c<l;){const d=Math.floor((c+l)/2);u(t[d])>e?l=d:c=d+1}return c}function Qg(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function nT(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,o=t[3];if(n===0)return[r*255,r*255,r*255,o];const c=r<.5?r*(1+n):r+n-r*n,l=2*r-c,u=Qg(l,c,e+1/3),d=Qg(l,c,e),h=Qg(l,c,e-1/3);return[u*255,d*255,h*255,o]}function Lb(t){const e=cb().get(t);if(!e)return null;const{model:n,value:r}=e;return n==="rgb"?r:n==="hsl"?nT(r):null}const df=(t,e)=>n=>t*(1-n)+e*n,rT=(t,e)=>{const n=Lb(t),r=Lb(e);return n===null||r===null?n?()=>t:()=>e:o=>{const c=new Array(4);for(let g=0;g<4;g+=1){const v=n[g],m=r[g];c[g]=v*(1-o)+m*o}const[l,u,d,h]=c;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(d)}, ${h})`}},iT=(t,e)=>typeof t=="number"&&typeof e=="number"?df(t,e):typeof t=="string"&&typeof e=="string"?rT(t,e):()=>t,Ib=(t,e)=>{const n=df(t,e);return r=>Math.round(n(r))};function Jg(t){return!(0,kl.Z)(t)&&!ub(t)&&!Number.isNaN(t)}const Nh=Math.sqrt(50),Fh=Math.sqrt(10),tv=Math.sqrt(2);function Bh(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),c=r/Ai(10,o);return o>=0?(c>=Nh?10:c>=Fh?5:c>=tv?2:1)*Ai(10,o):-Ai(10,-o)/(c>=Nh?10:c>=Fh?5:c>=tv?2:1)}function lI(t,e,n){const r=Math.abs(e-t)/Math.max(0,n);let o=Ai(10,Math.floor(Math.log(r)/Math.LN10));const c=r/o;return c>=Nh?o*=10:c>=Fh?o*=5:c>=tv&&(o*=2),e<t?-o:o}const oT=(t,e,n=5)=>{const r=[t,e];let o=0,c=r.length-1,l=r[o],u=r[c],d;return u<l&&([l,u]=[u,l],[o,c]=[c,o]),d=Bh(l,u,n),d>0?(l=Math.floor(l/d)*d,u=Math.ceil(u/d)*d,d=Bh(l,u,n)):d<0&&(l=Math.ceil(l*d)/d,u=Math.floor(u*d)/d,d=Bh(l,u,n)),d>0?(r[o]=Math.floor(l/d)*d,r[c]=Math.ceil(u/d)*d):d<0&&(r[o]=Math.ceil(l*d)/d,r[c]=Math.floor(u*d)/d),r};function aT(t,e){const n=e<t?e:t,r=t>e?t:e;return o=>Math.min(Math.max(n,o),r)}const Rb=(t,e,n)=>{const[r,o]=t,[c,l]=e;let u,d;return r<o?(u=Kg(r,o),d=n(c,l)):(u=Kg(o,r),d=n(l,c)),Dh(d,u)},sT=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,o=new Array(r),c=new Array(r),l=t[0]>t[r],u=l?[...t].reverse():t,d=l?[...e].reverse():e;for(let h=0;h<r;h+=1)o[h]=Kg(u[h],u[h+1]),c[h]=n(d[h],d[h+1]);return h=>{const g=Pb(t,h,1,r)-1,v=o[g],m=c[g];return Dh(m,v)(h)}},kb=(t,e,n,r)=>(Math.min(t.length,e.length)>2?sT:Rb)(t,e,r?Ib:n);class Db extends Cb{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:df,tickCount:5}}map(e){return Jg(e)?this.output(e):this.options.unknown}invert(e){return Jg(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,n,r,...o]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,n,r,...o)}getTicks(){const{tickMethod:e}=this.options,[n,r,o,...c]=this.getTickMethodOptions();return e(n,r,o,...c)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],o=e[e.length-1];return[r,o,n]}chooseNice(){return oT}rescale(){this.nice();const[e,n]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,n,this.chooseClamp(n))}chooseClamp(e){const{clamp:n,range:r}=this.options,o=this.options.domain.map(e),c=Math.min(o.length,r.length);return n?aT(o[0],o[c-1]):ta}composeOutput(e,n){const{domain:r,range:o,round:c,interpolate:l}=this.options,u=kb(r.map(e),o,l,c);this.output=Dh(u,n,e)}composeInput(e,n,r){const{domain:o,range:c}=this.options,l=kb(c,o.map(e),df);this.input=Dh(n,r,l)}}const jh=(t,e,n)=>{let r,o,c=t,l=e;if(c===l&&n>0)return[c];let u=Bh(c,l,n);if(u===0||!Number.isFinite(u))return[];if(u>0){c=Math.ceil(c/u),l=Math.floor(l/u),o=new Array(r=Math.ceil(l-c+1));for(let d=0;d<r;d+=1)o[d]=(c+d)*u}else{u=-u,c=Math.ceil(c*u),l=Math.floor(l*u),o=new Array(r=Math.ceil(l-c+1));for(let d=0;d<r;d+=1)o[d]=(c+d)/u}return o};class Fs extends Db{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:iT,tickMethod:jh,tickCount:5}}chooseTransforms(){return[ta,ta]}clone(){return new Fs(this.options)}}function hf(t,e){return+t.toPrecision(e)}function uI(t){return t.toLocaleString()}function cT(t){return t.toExponential()}function lT(t,e){return e===void 0&&(e=0),Math.abs(t)<1e3?String(t):"".concat(hf(t/1e3,e).toLocaleString(),"K")}var fI=function(t,e,n){return t<0&&Number.isFinite(t)?e:n},dI=function(t,e,n){return t>0&&Number.isFinite(t)?e:n},hI=function(t,e){return t*e},uT=function(t,e){return t/2+(e||0)/2};function Nb(t){var e=t.canvas,n=t.touches,r=t.offsetX,o=t.offsetY;if(e){var c=e.x,l=e.y;return[c,l]}if(n){var u=n[0],d=u.clientX,h=u.clientY;return[d,h]}return r&&o?[r,o]:[0,0]}function Fb(t){var e=t.nativeEvent,n=t.touches,r=t.clientX,o=t.clientY;if(e)return[e.clientX,e.clientY];if(n){var c=n[0],l=c.clientX,u=c.clientY;return[l,u]}return typeof r=="number"&&typeof o=="number"?[r,o]:[0,0]}var Bb={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},zh=dt({background:"background",labelGroup:"label-group",label:"label"},"indicator"),fT=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,Bb)||this;return r.point=[0,0],r.group=r.appendChild(new N.ZA({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var n=this.attributes,r=n.position,o=n.padding,c=(0,Q.CR)(so(o),4),l=c[0],u=c[1],d=c[2],h=c[3],g=this.label.node().getLocalBounds(),v=g.min,m=g.max,_=new Jr(v[0]-h,v[1]-l,m[0]+u-v[0]+h,m[1]+d-v[1]+l),b=this.getPath(r,_),S=or(this.attributes,"background");this.background=ot(this.group).maybeAppendByClassName(zh.background,"path").styles((0,Q.pi)((0,Q.pi)({},S),{d:b})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var n=this.attributes,r=n.formatter,o=n.labelText,c=or(this.attributes,"label"),l=(0,Q.CR)(us(c),2),u=l[0],d=l[1],h=u.text,g=(0,Q._T)(u,["text"]);if(this.label=ot(this.group).maybeAppendByClassName(zh.labelGroup,"g").styles(d),!!o){var v=this.label.maybeAppendByClassName(zh.label,function(){return _r(r(o))}).style("text",r(o).toString());v.selectAll("text").styles(g)}},e.prototype.adjustLayout=function(){var n=(0,Q.CR)(this.point,2),r=n[0],o=n[1],c=this.attributes,l=c.x,u=c.y;this.group.attr("transform","translate(".concat(l-r,", ").concat(u-o,")"))},e.prototype.getPath=function(n,r){var o=this.attributes.radius,c=r.x,l=r.y,u=r.width,d=r.height,h=[["M",c+o,l],["L",c+u-o,l],["A",o,o,0,0,1,c+u,l+o],["L",c+u,l+d-o],["A",o,o,0,0,1,c+u-o,l+d],["L",c+o,l+d],["A",o,o,0,0,1,c,l+d-o],["L",c,l+o],["A",o,o,0,0,1,c+o,l],["Z"]],g={top:4,right:6,bottom:0,left:2},v=g[n],m=this.createCorner([h[v].slice(-2),h[v+1].slice(-2)]);return h.splice.apply(h,(0,Q.ev)([v+1,1],(0,Q.CR)(m),!1)),h[0][0]="M",h},e.prototype.createCorner=function(n,r){r===void 0&&(r=10);var o=.8,c=Dg.apply(void 0,(0,Q.ev)([],(0,Q.CR)(n),!1)),l=(0,Q.CR)(n,2),u=(0,Q.CR)(l[0],2),d=u[0],h=u[1],g=(0,Q.CR)(l[1],2),v=g[0],m=g[1],_=(0,Q.CR)(c?[v-d,[d,v]]:[m-h,[h,m]],2),b=_[0],S=(0,Q.CR)(_[1],2),w=S[0],E=S[1],T=b/2,M=b/Math.abs(b),P=r*M,R=P/2,k=P*Math.sqrt(3)/2*o,F=(0,Q.CR)([w,w+T-R,w+T,w+T+R,E],5),W=F[0],$=F[1],rt=F[2],et=F[3],ut=F[4];return c?(this.point=[rt,h-k],[["L",W,h],["L",$,h],["L",rt,h-k],["L",et,h],["L",ut,h]]):(this.point=[d+k,rt],[["L",d,W],["L",d,$],["L",d+k,rt],["L",d,et],["L",d,ut]])},e.prototype.applyVisibility=function(){var n=this.attributes.visibility;n==="hidden"?Is(this):Ku(this)},e.prototype.bindEvents=function(){this.label.on(N.Dk.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Gi),jb={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},dT={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},zb={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},ka=dt({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),ea=dt({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),hT=function(t){(0,Q.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.x,c=n.y,l=n.size,u=l===void 0?10:l,d=n.radius,h=d===void 0?u/4:d,g=n.orientation,v=n.classNamePrefix,m=(0,Q._T)(n,["x","y","size","radius","orientation","classNamePrefix"]),_=u,b=_*2.4,S=v?"".concat(ea.iconRect.name," ").concat(v,"handle-icon-rect"):ea.iconRect.name,w=function(k){return v?"".concat(ea.iconLine,"-").concat(k," ").concat(v,"handle-icon-line"):"".concat(ea.iconLine,"-").concat(k)},E=ot(r).maybeAppendByClassName(ea.iconRect,"rect").attr("className",S).styles((0,Q.pi)((0,Q.pi)({},m),{width:_,height:b,radius:h,x:o-_/2,y:c-b/2,transformOrigin:"center"})),T=o+1/3*_-_/2,M=o+2/3*_-_/2,P=c+1/4*b-b/2,R=c+3/4*b-b/2;E.maybeAppendByClassName("".concat(ea.iconLine,"-1"),"line").attr("className",w(1)).styles((0,Q.pi)({x1:T,x2:T,y1:P,y2:R},m)),E.maybeAppendByClassName("".concat(ea.iconLine,"-2"),"line").attr("className",w(2)).styles((0,Q.pi)({x1:M,x2:M,y1:P,y2:R},m)),g==="vertical"&&(E.node().style.transform="rotate(90)")},e}(Gi),Ub=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,zb)||this}return e.prototype.renderLabel=function(n){var r=this,o=this.attributes,c=o.x,l=o.y,u=o.showLabel,d=or(this.attributes,"label"),h=d.x,g=h===void 0?0:h,v=d.y,m=v===void 0?0:v,_=d.transform,b=d.transformOrigin,S=(0,Q._T)(d,["x","y","transform","transformOrigin"]),w=(0,Q.CR)(us(S,[]),2),E=w[0],T=w[1],M=ot(n).maybeAppendByClassName(ea.labelGroup,"g").styles(T),P=(0,Q.pi)((0,Q.pi)({},dT),E),R=P.text,k=(0,Q._T)(P,["text"]);Oo(!!u,M,function(F){r.label=F.maybeAppendByClassName(ea.label,"text").styles((0,Q.pi)((0,Q.pi)({},k),{x:c+g,y:l+m,transform:_,transformOrigin:b,text:"".concat(R)})),r.label.on("mousedown",function(W){W.stopPropagation()}),r.label.on("touchstart",function(W){W.stopPropagation()})})},e.prototype.renderIcon=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.orientation,u=r.type,d=r.classNamePrefix,h=(0,Q.pi)((0,Q.pi)({x:o,y:c,orientation:l,classNamePrefix:d},jb),or(this.attributes,"icon")),g=this.attributes.iconShape,v=g===void 0?function(){return new hT({style:h})}:g,m=ot(n).maybeAppendByClassName(ea.iconGroup,"g");m.selectAll(ea.icon.class).data([v]).join(function(_){return _.append(typeof v=="string"?v:function(){return v(u)}).attr("className",ea.icon.name)},function(_){return _.update(h)},function(_){return _.remove()})},e.prototype.render=function(n,r){this.renderIcon(r),this.renderLabel(r)},e}(Gi);function ii(t,e,n){return n?"".concat(t," ").concat(n,"legend-").concat(e):t}function pT(t,e,n){var r=t.classNamePrefix,o=r===void 0?"":r;return ii(e.name,n,o)}var _i={title:"title",item:"item",marker:"marker",label:"label",value:"value",focusIcon:"focus-icon",background:"background",ribbon:"ribbon",track:"track",selection:"selection",handle:"handle",handleMarker:"handle-marker",handleLabel:"handle-label",indicator:"indicator",prevBtn:"prev-btn",nextBtn:"next-btn",pageInfo:"page-info"},Uh=dt({text:"text"},"title");function gT(t,e){var n=t.attributes,r=n.position,o=n.spacing,c=n.inset,l=n.text,u=t.getBBox(),d=e.getBBox(),h=Ll(r),g=(0,Q.CR)(so(l?o:0),4),v=g[0],m=g[1],_=g[2],b=g[3],S=(0,Q.CR)(so(c),4),w=S[0],E=S[1],T=S[2],M=S[3],P=(0,Q.CR)([b+m,v+_],2),R=P[0],k=P[1],F=(0,Q.CR)([M+E,w+T],2),W=F[0],$=F[1];if(h[0]==="l")return new Jr(u.x,u.y,d.width+u.width+R+W,Math.max(d.height+$,u.height));if(h[0]==="t")return new Jr(u.x,u.y,Math.max(d.width+W,u.width),d.height+u.height+k+$);var rt=(0,Q.CR)([e.attributes.width||d.width,e.attributes.height||d.height],2),et=rt[0],ut=rt[1];return new Jr(d.x,d.y,et+u.width+R+W,ut+u.height+k+$)}function vT(t,e){var n=Object.entries(e).reduce(function(r,o){var c=(0,Q.CR)(o,2),l=c[0],u=c[1],d=t.node().attr(l);return d||(r[l]=u),r},{});t.styles(n)}function mT(t){var e,n,r,o,c=t,l=c.width,u=c.height,d=c.position,h=(0,Q.CR)([+l/2,+u/2],2),g=h[0],v=h[1],m=(0,Q.CR)([+g,+v,"center","middle"],4),_=m[0],b=m[1],S=m[2],w=m[3],E=Ll(d);return E.includes("l")&&(e=(0,Q.CR)([0,"start"],2),_=e[0],S=e[1]),E.includes("r")&&(n=(0,Q.CR)([+l,"end"],2),_=n[0],S=n[1]),E.includes("t")&&(r=(0,Q.CR)([0,"top"],2),b=r[0],w=r[1]),E.includes("b")&&(o=(0,Q.CR)([+u,"bottom"],2),b=o[0],w=o[1]),{x:_,y:b,textAlign:S,textBaseline:w}}var Zb=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var n=this,r=this.attributes,o=r.width,c=r.height,l=r.position,u=r.spacing,d=r.inset,h=n.querySelector(Uh.text.class);if(!h)return new Jr(0,0,+o,+c);var g=h.getBBox(),v=g.width,m=g.height,_=(0,Q.CR)(so(u),4),b=_[0],S=_[1],w=_[2],E=_[3],T=(0,Q.CR)([0,0,+o,+c],4),M=T[0],P=T[1],R=T[2],k=T[3],F=Ll(l);if(F.includes("i"))return new Jr(M,P,R,k);F.forEach(function(xt,Ht){var gt,wt,Wt,fe;xt==="t"&&(gt=(0,Q.CR)(Ht===0?[m+w,+c-m-w]:[0,+c],2),P=gt[0],k=gt[1]),xt==="r"&&(wt=(0,Q.CR)([+o-v-E],1),R=wt[0]),xt==="b"&&(Wt=(0,Q.CR)([+c-m-b],1),k=Wt[0]),xt==="l"&&(fe=(0,Q.CR)(Ht===0?[v+S,+o-v-S]:[0,+o],2),M=fe[0],R=fe[1])});var W=(0,Q.CR)(so(d),4),$=W[0],rt=W[1],et=W[2],ut=W[3],J=(0,Q.CR)([ut+rt,$+et],2),lt=J[0],vt=J[1];return new Jr(M+ut,P+$,R-lt,k-vt)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new Jr(0,0,0,0)},e.prototype.render=function(n,r){var o=this,c=n.width,l=n.height,u=n.position,d=n.spacing,h=n.classNamePrefix,g=(0,Q._T)(n,["width","height","position","spacing","classNamePrefix"]),v=(0,Q.CR)(us(g),1),m=v[0],_=mT(n),b=_.x,S=_.y,w=_.textAlign,E=_.textBaseline;Oo(!!g.text,ot(r),function(T){var M=ii(Uh.text.name,_i.title,h);o.title=T.maybeAppendByClassName(Uh.text,"text").attr("className",M).styles(m).call(vT,{x:b,y:S,textAlign:w,textBaseline:E}).node()})},e}(Gi),Hb=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},yT=Hb,_T=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]},Zh=function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]},Wb=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]},Vb=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]},Gb=function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]},bT=function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]},$b=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},xT=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]},ST=function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]},wT=function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]},OT=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},Yb=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},Hh=Yb,Xb=function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]},qb=function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]},Kb=function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]},ET=function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]};function AT(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}var TT=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]},MT=function(t,e,n){var r=n,o=n*.2,c=n*.7;return[["M",t-r,e],["A",r,r,0,1,0,t+r,e],["A",r,r,0,1,0,t-r,e],["Z"],["M",t-c,e],["L",t-o,e],["M",t+o,e],["L",t+c,e],["M",t,e-c],["L",t,e-o],["M",t,e+o],["L",t,e+c]]};function CT(t){var e="default";if((0,Jd.Z)(t)&&t instanceof Image)e="image";else if((0,Eo.Z)(t))e="symbol";else if((0,Ze.Z)(t)){var n=new RegExp("data:(image|text)");t.match(n)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?e="url":e="symbol"}return e}function PT(t){var e=CT(t);return["base64","url","image"].includes(e)?"image":t&&e==="symbol"?"path":null}var Er=function(t){(0,Q.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.x,c=o===void 0?0:o,l=n.y,u=l===void 0?0:l,d=this.getSubShapeStyle(n),h=d.symbol,g=d.size,v=g===void 0?16:g,m=(0,Q._T)(d,["symbol","size"]),_=PT(h);Oo(!!_,ot(r),function(b){b.maybeAppendByClassName("marker",_).attr("className","marker ".concat(_,"-marker")).call(function(S){if(_==="image"){var w=v*2;S.styles({img:h,width:w,height:w,x:c-v,y:u-v})}else{var w=v/2,E=(0,Eo.Z)(h)?h:e.getSymbol(h);S.styles((0,Q.pi)({d:E==null?void 0:E(c,u,w)},m))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(n,r){e.MARKER_SYMBOL_MAP.set(n,r)},e.getSymbol=function(n){return e.MARKER_SYMBOL_MAP.get(n)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Gi);Er.registerSymbol("cross",xT),Er.registerSymbol("hyphen",OT),Er.registerSymbol("line",$b),Er.registerSymbol("plus",wT),Er.registerSymbol("tick",ST),Er.registerSymbol("circle",Hb),Er.registerSymbol("point",yT),Er.registerSymbol("bowtie",bT),Er.registerSymbol("hexagon",Gb),Er.registerSymbol("square",_T),Er.registerSymbol("diamond",Zh),Er.registerSymbol("triangle",Wb),Er.registerSymbol("triangle-down",Vb),Er.registerSymbol("line",$b),Er.registerSymbol("dot",Yb),Er.registerSymbol("dash",Hh),Er.registerSymbol("smooth",Xb),Er.registerSymbol("hv",qb),Er.registerSymbol("vh",Kb),Er.registerSymbol("hvh",ET),Er.registerSymbol("vhv",AT),Er.registerSymbol("focus",MT);function Qb(t,e,n){var r=Math.round((t-n)/e);return n+r*e}function LT(t,e,n){var r=1.4,o=r*n;return[["M",t-n,e-o],["L",t+n,e-o],["L",t+n,e+o],["L",t-n,e+o],["Z"]]}var Jb=1.4,ev=.4;function tx(t,e,n){var r=n,o=r*Jb,c=r/2,l=r/6,u=t+o*ev;return[["M",t,e],["L",u,e+c],["L",t+o,e+c],["L",t+o,e-c],["L",u,e-c],["Z"],["M",u,e+l],["L",t+o-2,e+l],["M",u,e-l],["L",t+o-2,e-l]]}function IT(t,e,n){var r=n,o=r*Jb,c=r/2,l=r/6,u=e+o*ev;return[["M",t,e],["L",t-c,u],["L",t-c,e+o],["L",t+c,e+o],["L",t+c,u],["Z"],["M",t-l,u],["L",t-l,e+o-2],["M",t+l,u],["L",t+l,e+o-2]]}Er.registerSymbol("hiddenHandle",LT),Er.registerSymbol("verticalHandle",tx),Er.registerSymbol("horizontalHandle",IT);var pI=function(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n};function RT(t,e,n,r){var o;r===void 0&&(r=4);var c=(0,Q.CR)(t,2),l=c[0],u=c[1],d=(0,Q.CR)(e,2),h=d[0],g=d[1],v=(0,Q.CR)(n,2),m=v[0],_=v[1],b=(0,Q.CR)([h,g],2),S=b[0],w=b[1],E=w-S;return S>w&&(o=(0,Q.CR)([w,S],2),S=o[0],w=o[1]),E>u-l?[l,u]:S<l?m===l&&_===w?[l,w]:[l,E+l]:w>u?_===u&&m===S?[S,u]:[u-E,u]:[S,w]}function Da(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n}var Cc=dt({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),ex={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},kT=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,ex)||this}return e.prototype.render=function(n,r){var o=ot(r).maybeAppendByClassName(Cc.markerGroup,"g");this.renderMarker(o);var c=ot(r).maybeAppendByClassName(Cc.labelGroup,"g");this.renderLabel(c)},e.prototype.renderMarker=function(n){var r=this,o=this.attributes,c=o.orientation,l=o.classNamePrefix,u=o.markerSymbol,d=u===void 0?Da(c,"horizontalHandle","verticalHandle"):u;Oo(!!d,n,function(h){var g=or(r.attributes,"marker"),v=(0,Q.pi)({symbol:d},g),m=ii(Cc.marker.name,_i.handleMarker,l);if(r.marker=h.maybeAppendByClassName(Cc.marker,function(){return new Er({style:v,className:m})}).update(v),l){var _=r.marker.node().querySelector(".marker");if(_){var b=_.getAttribute("class")||"",S=b.split(" ")[0],w=ii(S,_i.handleMarker,l);_.setAttribute("class",w)}}})},e.prototype.renderLabel=function(n){var r=this,o=this.attributes,c=o.showLabel,l=o.orientation,u=o.spacing,d=u===void 0?0:u,h=o.formatter,g=o.classNamePrefix;Oo(c,n,function(v){var m,_=or(r.attributes,"label"),b=_.text,S=(0,Q._T)(_,["text"]),w=((m=v.select(Cc.marker.class))===null||m===void 0?void 0:m.node().getBBox())||{},E=w.width,T=E===void 0?0:E,M=w.height,P=M===void 0?0:M,R=(0,Q.CR)(Da(l,[0,P+d,"center","top"],[T+d,0,"start","middle"]),4),k=R[0],F=R[1],W=R[2],$=R[3],rt=ii(Cc.label.name,_i.handleLabel,g);v.maybeAppendByClassName(Cc.label,"text").attr("className",rt).styles((0,Q.pi)((0,Q.pi)({},S),{x:k,y:F,text:h(b).toString(),textAlign:W,textBaseline:$}))})},e}(Gi),nx={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},rx=ha({},nx,{}),DT=ha({},nx,ls(ex,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),NT=.01,FT=.5,Ci=dt({title:"title",html:"html",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend");function ix(t,e){for(var n=1;n<t.length;n+=1){var r=t[n-1],o=t[n];if(e>=r&&e<=o)return[r,o]}return[e,e]}function BT(t,e,n){var r=Array.from(e),o=t.length;return new Array(o).fill(0).reduce(function(c,l,u){var d=r[u%r.length];return c+=" ".concat(t[u],":").concat(d).concat(u<o-1?" ".concat(t[u+1],":").concat(d):"")},"l(".concat(n==="horizontal"?"0":"270",")"))}function ox(t,e){var n=(0,Q.CR)(ix(t,e),2),r=n[0],o=n[1];return{tick:e>(r+o)/2?o:r,range:[r,o]}}var Pc=dt({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function nv(t){var e=t.orientation,n=t.size,r=t.length;return Da(e,[r,n],[n,r])}function ax(t){var e=t.type,n=(0,Q.CR)(nv(t),2),r=n[0],o=n[1];return e==="size"?[["M",0,o],["L",0+r,0],["L",0+r,o],["Z"]]:[["M",0,o],["L",0,0],["L",0+r,0],["L",0+r,o],["Z"]]}function jT(t){return ax(t)}function zT(t){var e=t.orientation,n=t.color,r=t.block,o=t.partition,c;if((0,Eo.Z)(n)){var l=20;c=new Array(l).fill(0).map(function(h,g,v){return n(g/(v.length-1))})}else c=n;var u=c.length,d=c.map(function(h){return(0,N.lu)(h).toString()});return u?u===1?d[0]:r?BT(o,d,e):d.reduce(function(h,g,v){return h+=" ".concat(v/(u-1),":").concat(g)},"l(".concat(Da(e,"0","270"),")")):""}function sx(t){var e=t.orientation,n=t.range;if(!n)return[];var r=(0,Q.CR)(nv(t),2),o=r[0],c=r[1],l=(0,Q.CR)(n,2),u=l[0],d=l[1],h=Da(e,u*o,0),g=Da(e,0,u*c),v=Da(e,d*o,o),m=Da(e,c,d*c);return[["M",h,g],["L",h,m],["L",v,m],["L",v,g],["Z"]]}function UT(t,e){var n=or(e,"track"),r=e.classNamePrefix,o=ii(Pc.track.name,_i.track,r);t.maybeAppendByClassName(Pc.track,"path").attr("className",o).styles((0,Q.pi)({d:ax(e)},n))}function ZT(t,e){var n=or(e,"selection"),r=zT(e),o=e.classNamePrefix,c=ii(Pc.selection.name,_i.selection,o),l=t.maybeAppendByClassName(Pc.selection,"path").attr("className",c).styles((0,Q.pi)({d:jT(e),fill:r},n)),u=l.maybeAppendByClassName(Pc.clipPath,"path").styles({d:sx(e)}).node();l.style("clipPath",u)}var cx=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return e.prototype.render=function(n,r){var o=ot(r).maybeAppendByClassName(Pc.trackGroup,"g");UT(o,n);var c=ot(r).maybeAppendByClassName(Pc.selectionGroup,"g");ZT(c,n)},e}(Gi);function pf(t){return{min:Math.min.apply(Math,(0,Q.ev)([],(0,Q.CR)(t.map(function(e){return e.value})),!1)),max:Math.max.apply(Math,(0,Q.ev)([],(0,Q.CR)(t.map(function(e){return e.value})),!1))}}var lx=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,DT)||this;return r.eventToOffsetScale=new Fs({}),r.innerRibbonScale=new Fs({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(o){var c=r.attributes,l=c.data,u=c.block;o.stopPropagation();var d=r.getValueByCanvasPoint(o);if(u){var h=ox(l.map(function(m){var _=m.value;return _}),d).range,g=r.getRealSelection(h);r.showIndicator((h[0]+h[1])/2,"".concat(g[0],"-").concat(g[1])),r.dispatchIndicated(d,h)}else{var v=r.getTickValue(d);r.showIndicator(v,"".concat(r.getRealValue(v))),r.dispatchIndicated(v)}},r.onDragStart=function(o){return function(c){c.stopPropagation(),r.attributes.slidable&&(r.target=o,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(c)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(o){var c=r.target;r.updateMouse();var l=(0,Q.CR)(r.selection,2),u=l[0],d=l[1],h=r.getTickValue(r.getValueByCanvasPoint(o)),g=h-r.prevValue;c==="start"?u!==h&&r.updateSelection(h,d):c==="end"?d!==h&&r.updateSelection(u,h):c==="ribbon"&&g!==0&&(r.prevValue=h,r.updateSelection(g,g,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(e.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.width,o=n.height;return new Jr(0,0,r,o)},e.prototype.render=function(n,r){var o=this,c=n.classNamePrefix,l=r.className||"legend-continuous";c?r.attr("className","".concat(l," ").concat(c,"legend")):r.className||r.attr("className","legend-continuous");var u=n.showLabel;this.renderTitle(ot(r));var d=this.availableSpace,h=d.x,g=d.y,v=ot(r).maybeAppendByClassName(Ci.contentGroup,"g").styles({transform:"translate(".concat(h,", ").concat(g,")")}),m=v.maybeAppendByClassName(Ci.labelGroup,"g").styles({zIndex:1});Oo(!!u,m,function(b){o.renderLabel(b)});var _=v.maybeAppendByClassName(Ci.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=v.maybeAppendByClassName(Ci.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(_),this.renderIndicator(v),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(e.prototype,"range",{get:function(){var n=this.attributes,r=n.data,o=n.domain;return o?{min:o[0],max:o[1]}:pf(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonScale",{get:function(){var n=this.range,r=n.min,o=n.max;return this.innerRibbonScale.update({domain:[r,o],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonRange",{get:function(){var n=(0,Q.CR)(this.selection,2),r=n[0],o=n[1],c=this.ribbonScale;return[c.map(r),c.map(o)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var n=this.range,r=n.min,o=n.max,c=this.attributes.defaultValue,l=c===void 0?[r,o]:c,u=(0,Q.CR)(l,2),d=u[0],h=u[1];return[d,h]},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){return Da(this.attributes.orientation,typeof n=="function"?n():n,typeof r=="function"?r():r)},e.prototype.renderTitle=function(n){var r=this.attributes,o=r.showTitle,c=r.titleText,l=r.width,u=r.height,d=r.classNamePrefix,h=or(this.attributes,"title"),g=(0,Q.pi)((0,Q.pi)({},h),{width:l,height:u,text:c,classNamePrefix:d}),v=this;n.selectAll(Ci.title.class).data(o?[c]:[]).join(function(m){return m.append(function(){return new Zb({style:g})}).attr("className",Ci.title.name).each(function(){v.title=this})},function(m){return m.update(g)},function(m){return m.each(function(){v.title=void 0}).remove()})},Object.defineProperty(e.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var n=this.attributes,r=n.width,o=n.height;return new Jr(0,0,r,o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelFixedSpacing",{get:function(){var n=this.attributes.showTick;return n?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){var n=this.attributes,r=n.orientation,o=n.labelDirection,c={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return c[r][o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelBBox",{get:function(){var n,r=this.attributes.showLabel;if(!r)return new Jr(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var o=((n=this.label.querySelector(Qn.labelGroup.class))===null||n===void 0?void 0:n.children.slice(-1)[0]).getBBox(),c=o.width,l=o.height;return this.cacheLabelBBox=new Jr(0,0,c,l),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelShape",{get:function(){var n=this.attributes,r=n.showLabel,o=n.labelSpacing,c=o===void 0?0:o;if(!r)return{width:0,height:0,size:0,length:0};var l=this.labelBBox,u=l.width,d=l.height,h=this.ifHorizontal(d,u)+c+this.labelFixedSpacing,g=this.ifHorizontal(u,d);return{width:u,height:d,size:h,length:g}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonBBox",{get:function(){var n=this.attributes,r=n.showHandle,o=n.ribbonSize,c=this.availableSpace,l=c.width,u=c.height,d=this.labelShape,h=d.size,g=d.length,v=(0,Q.CR)(this.ifHorizontal([u,l],[l,u]),2),m=v[0],_=v[1],b=r?this.handleShape:{size:0,length:0},S=b.size,w=b.length,E=this.handleOffsetRatio,T=0,M=this.labelPosition;o?T=o:["bottom","right"].includes(M)?T=Math.min(m-h,(m-S)/E):m*(1-E)>S?T=Math.max(m-h,0):T=Math.max((m-h-S)/E,0);var P=Math.max(w,g),R=_-P,k=(0,Q.CR)(this.ifHorizontal([R,T],[T,R]),2),F=k[0],W=k[1],$=["top","left"].includes(M)?h:0,rt=(0,Q.CR)(this.ifHorizontal([P/2,$],[$,P/2]),2),et=rt[0],ut=rt[1];return new Jr(et,ut,F,W)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonShape",{get:function(){var n=this.ribbonBBox,r=n.width,o=n.height;return this.ifHorizontal({size:o,length:r},{size:r,length:o})},enumerable:!1,configurable:!0}),e.prototype.renderRibbon=function(n){var r=this.attributes,o=r.data,c=r.type,l=r.orientation,u=r.color,d=r.block,h=r.classNamePrefix,g=or(this.attributes,"ribbon"),v=this.range,m=v.min,_=v.max,b=this.ribbonBBox,S=b.x,w=b.y,E=this.ribbonShape,T=E.length,M=E.size,P=ha({transform:"translate(".concat(S,", ").concat(w,")"),length:T,size:M,type:c,orientation:l,color:u,block:d,partition:o.map(function(k){return(k.value-m)/(_-m)}),range:this.ribbonRange,classNamePrefix:h},g),R=ii(Ci.ribbon.name,_i.ribbon,h);this.ribbon=n.maybeAppendByClassName(Ci.ribbon,function(){return new cx({style:P,className:R})}).update(P)},e.prototype.getHandleClassName=function(n){return"".concat(Ci.prefix("".concat(n,"-handle")))},e.prototype.renderHandles=function(){var n=this.attributes,r=n.showHandle,o=n.orientation,c=n.classNamePrefix,l=or(this.attributes,"handle"),u=(0,Q.CR)(this.selection,2),d=u[0],h=u[1],g=(0,Q.pi)((0,Q.pi)({},l),{orientation:o,classNamePrefix:c}),v=l.shape,m=v===void 0?"slider":v,_=m==="basic"?kT:Ub,b=this,S=ii(Ci.handle.name,_i.handle,c);this.handlesGroup.selectAll(Ci.handle.class).data(r?[{value:d,type:"start"},{value:h,type:"end"}]:[],function(w){return w.type}).join(function(w){return w.append(function(){return new _({style:g,className:S})}).attr("className",function(E){var T=E.type;return"".concat(S," ").concat(b.getHandleClassName(T))}).each(function(E){var T=E.type,M=E.value;this.update({labelText:M});var P="".concat(T,"Handle");b[P]=this,this.addEventListener("pointerdown",b.onDragStart(T))})},function(w){return w.update(g).each(function(E){var T=E.value;this.update({labelText:T})})},function(w){return w.each(function(E){var T=E.type,M="".concat(T,"Handle");b[M]=void 0}).remove()})},e.prototype.adjustHandles=function(){var n=(0,Q.CR)(this.selection,2),r=n[0],o=n[1];this.setHandlePosition("start",r),this.setHandlePosition("end",o);var c=this.attributes,l=c.classNamePrefix,u=c.showHandle,d=or(this.attributes,"handle").shape,h=d===void 0?"slider":d;u&&h==="slider"&&l&&(this.startHandle&&this.updateSliderHandleClassNames(this.startHandle,l),this.endHandle&&this.updateSliderHandleClassNames(this.endHandle,l))},e.prototype.updateSliderHandleClassNames=function(n,r){var o=n.container||n,c=o.querySelector(".handle-icon-rect");if(c){var l=ii("handle-icon-rect",_i.handleMarker,r);c.setAttribute("class",l);var u=c.querySelectorAll("line");u.forEach(function(g){var v=g.getAttribute("class")||"",m=v.split(" ")[0],_=ii(m,_i.handleMarker,r);g.setAttribute("class",_)})}var d=o.querySelector(".handle-label");if(d){var h=ii("handle-label",_i.handleLabel,r);d.setAttribute("class",h)}},Object.defineProperty(e.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new Jr(0,0,0,0);var n=this.startHandle.getBBox(),r=n.width,o=n.height,c=this.endHandle.getBBox(),l=c.width,u=c.height,d=(0,Q.CR)([Math.max(r,l),Math.max(o,u)],2),h=d[0],g=d[1];return this.cacheHandleBBox=new Jr(0,0,h,g),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"handleShape",{get:function(){var n=this.handleBBox,r=n.width,o=n.height,c=(0,Q.CR)(this.ifHorizontal([o,r],[r,o]),2),l=c[0],u=c[1];return{width:r,height:o,size:l,length:u}},enumerable:!1,configurable:!0}),e.prototype.setHandlePosition=function(n,r){var o=this.attributes.handleFormatter,c=this.ribbonBBox,l=c.x,u=c.y,d=this.ribbonShape.size,h=this.getOffset(r),g=(0,Q.CR)(this.ifHorizontal([l+h,u+d*this.handleOffsetRatio],[l+d*this.handleOffsetRatio,u+h]),2),v=g[0],m=g[1],_=this.handlesGroup.select(".".concat(this.getHandleClassName(n))).node();_==null||_.update({transform:"translate(".concat(v,", ").concat(m,")"),formatter:o})},e.prototype.renderIndicator=function(n){var r=this.attributes.classNamePrefix,o=or(this.attributes,"indicator"),c=ii(Ci.indicator.name,_i.indicator,r);this.indicator=n.maybeAppendByClassName(Ci.indicator,function(){return new fT({style:o,className:c})}).update(o)},Object.defineProperty(e.prototype,"labelData",{get:function(){var n=this,r=this.attributes.data;return r.reduce(function(o,c,l,u){var d,h,g=(d=c==null?void 0:c.id)!==null&&d!==void 0?d:l.toString();if(o.push((0,Q.pi)((0,Q.pi)({},c),{id:g,index:l,type:"value",label:(h=c==null?void 0:c.label)!==null&&h!==void 0?h:c.value.toString(),value:n.ribbonScale.map(c.value)})),l<u.length-1){var v=u[l+1],m=(0,Q.CR)([c.value,v.value],2),_=m[0],b=m[1],S=(_+b)/2;o.push((0,Q.pi)((0,Q.pi)({},c),{id:g,index:l,type:"range",range:[_,b],label:[_,b].join("~"),value:n.ribbonScale.map(S)}))}return o},[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){var n=(0,Q.CR)(["center","middle"],2),r=n[0],o=n[1],c=this.labelPosition;return c==="top"?o="bottom":c==="bottom"?o="top":c==="left"?r="end":c==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:o}},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(n){var r=this.attributes,o=r.showTick,c=o===void 0?!1:o,l=r.labelFilter,u=r.labelFormatter,d=or(this.attributes,"tick"),h=or(this.attributes,"label"),g=h.align,v=ha((0,Q.pi)({showLine:!1,showGrid:!1,showTick:c,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),ls(d,"tick"),ls(h,"label"),{data:this.labelData}),m={tickFilter:function(b,S,w){return(b==null?void 0:b.type)!=="value"?!1:l?l(b,b.index,w.filter(function(E){return E.type!=="value"})):!0},labelFilter:function(b,S,w){return(b==null?void 0:b.type)!==g?!1:l?l(b,b.index,w.filter(function(E){return E.type===g})):!0},labelFormatter:u},_=(0,Q.pi)((0,Q.pi)((0,Q.pi)({},v),m),{labelOverlap:[{type:"hide"}]});this.label=n.maybeAppendByClassName(Ci.label,function(){return new Gg({style:_})}).node(),this.label.update(_,!1)},Object.defineProperty(e.prototype,"labelAxisStyle",{get:function(){var n=this.attributes,r=n.showTick,o=n.labelDirection,c=n.labelSpacing,l=n.tickLength,u=this.ribbonShape.size,d=this.labelPosition,h=this.labelFixedSpacing,g=(0,Q.CR)([0,0,0],3),v=g[0],m=g[1],_=g[2],b=l!=null?l:u;return r?(_=b,m=h,o==="positive"?d==="right"?(v=b,_=b):d==="bottom"&&(v=_):o==="negative"&&(d==="top"||d==="left")&&(v=u)):o==="positive"?d==="right"?m=b:d==="bottom"&&(v=u+h,m=c):o==="negative"&&(d==="left"||d==="top")&&(m=c),{offset:v,spacing:m,tickLength:_}},enumerable:!1,configurable:!0}),e.prototype.adjustLabel=function(){var n=this.attributes.showLabel;if(n){var r=this.ribbonBBox,o=r.x,c=r.y,l=r.width,u=r.height,d=this.labelAxisStyle,h=d.offset,g=d.spacing,v=d.tickLength,m=(0,Q.CR)(this.ifHorizontal([[o,c+h],[o+l,c+h]],[[o+h,c+u],[o+h,c]]),2),_=m[0],b=m[1];this.label.update({startPos:_,endPos:b,tickLength:v,labelSpacing:g},!1)}},e.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},e.prototype.showIndicator=function(n,r){r===void 0&&(r="".concat(n));var o=this.attributes.showIndicator;if(!o||typeof n!="number"){this.hideIndicator();return}var c=this.range,l=c.min,u=c.max,d=this.ribbonBBox,h=d.x,g=d.y,v=(0,se.Z)(n,l,u),m=this.getOffset(v),_=this.ifHorizontal([m+h,g],[h,m+g]);this.indicator.update({x:_[0],y:_[1],position:this.ifHorizontal("top","left"),labelText:r}),Ku(this.indicator.node())},e.prototype.hideIndicator=function(){Is(this.indicator.node())},e.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},e.prototype.setSelection=function(n,r){this.updateSelection(n,r)},e.prototype.updateSelection=function(n,r,o){var c;o===void 0&&(o=!1);var l=(0,Q.CR)(this.selection,2),u=l[0],d=l[1],h=(0,Q.CR)([n,r],2),g=h[0],v=h[1];o&&(g+=u,v+=d);var m=this.range,_=m.min,b=m.max;c=(0,Q.CR)(RT([_,b],[g,v],this.selection),2),g=c[0],v=c[1],this.update({defaultValue:[g,v]}),this.dispatchSelection()},Object.defineProperty(e.prototype,"step",{get:function(){var n=this.attributes.step,r=n===void 0?1:n,o=this.range,c=o.min,l=o.max;return(0,kl.Z)(r)?hf((l-c)*NT,0):r},enumerable:!1,configurable:!0}),e.prototype.getTickValue=function(n){var r=this.attributes,o=r.data,c=r.block,l=this.range.min;return c?ox(o.map(function(u){var d=u.value;return d}),n).tick:Qb(n,this.step,l)},e.prototype.getValueByCanvasPoint=function(n){var r=this.range,o=r.min,c=r.max,l=(0,Q.CR)(this.ribbon.node().getPosition(),2),u=l[0],d=l[1],h=this.ifHorizontal(u,d),g=this.ifHorizontal.apply(this,(0,Q.ev)([],(0,Q.CR)(Nb(n)),!1)),v=g-h,m=(0,se.Z)(this.getOffset(v,!0),o,c);return m},e.prototype.getOffset=function(n,r){r===void 0&&(r=!1);var o=this.range,c=o.min,l=o.max,u=this.ribbonShape.length,d=this.eventToOffsetScale;return d.update({domain:[c,l],range:[0,u]}),r?d.invert(n):d.map(n)},e.prototype.getRealSelection=function(n){var r=this.range.max,o=(0,Q.CR)(n,2),c=o[0],l=o[1];return this.ifHorizontal([c,l],[r-l,r-c])},e.prototype.getRealValue=function(n){var r=this.range.max;return this.ifHorizontal(n,r-n)},e.prototype.dispatchSelection=function(){var n=this.getRealSelection(this.selection),r=new N.Aw("valuechange",{detail:{value:n}});this.dispatchEvent(r)},e.prototype.dispatchIndicated=function(n,r){var o=this,c=this.range.max,l=this.ifHorizontal(function(){return{value:n,range:r}},function(){return{value:c-n,range:r?o.getRealSelection(r):void 0}}),u=new N.Aw("indicate",{detail:l});this.dispatchEvent(u)},e}(Gi);class Nl extends Vu{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(e){super(e)}map(e){if(!Ph(e))return this.options.unknown;const n=Ch(this.thresholds,e,0,this.n);return this.options.range[n]}invert(e){const{range:n}=this.options,r=n.indexOf(e),o=this.thresholds;return[o[r-1],o[r]]}clone(){return new Nl(this.options)}rescale(){const{domain:e,range:n}=this.options;this.n=Math.min(e.length,n.length-1),this.thresholds=e}}function Fl(t){return(0,be.Z)(t)?0:bc(t)?t.length:Object.keys(t).length}var HT=function(t,e){if(!bc(t))return-1;var n=Array.prototype.indexOf;if(n)return n.call(t,e);for(var r=-1,o=0;o<t.length;o++)if(t[o]===e){r=o;break}return r},ux=HT;function gf(t){return Math.abs(t)<1e-14?t:parseFloat(t.toFixed(14))}const WT=[1,5,2,2.5,4,3],gI=null,Wh=Number.EPSILON*100;function VT(t,e){return(t%e+e)%e}function GT(t){return Math.round(t*1e12)/1e12}function $T(t,e,n,r,o,c){const l=Fl(e),u=ux(e,t);let d=0;const h=VT(r,c);return(h<Wh||c-h<Wh)&&r<=0&&o>=0&&(d=1),1-u/(l-1)-n+d}function YT(t,e,n){const r=Fl(e);return 1-ux(e,t)/(r-1)-n+1}function XT(t,e,n,r,o,c){const l=(t-1)/(c-o),u=(e-1)/(Math.max(c,r)-Math.min(n,o));return 2-Math.max(l/u,u/l)}function qT(t,e){return t>=e?2-(t-1)/(e-1):1}function Bl(t,e,n,r){const o=e-t;return 1-.5*(Ai(e-r,2)+Ai(t-n,2))/Ai(.1*o,2)}function KT(t,e,n){const r=e-t;if(n>r){const o=(n-r)/2;return 1-Ai(o,2)/Ai(.1*r,2)}return 1}function QT(){return 1}const rv=(t,e,n=5,r=!0,o=WT,c=[.25,.2,.5,.05])=>{const l=n<0?0:Math.round(n);if(Number.isNaN(t)||Number.isNaN(e)||typeof t!="number"||typeof e!="number"||!l)return[];if(e-t<1e-15||l===1)return[t];const u={score:-2,lmin:0,lmax:0,lstep:0};let d=1;for(;d<1/0;){for(let b=0;b<o.length;b+=1){const S=o[b],w=YT(S,o,d);if(c[0]*w+c[1]+c[2]+c[3]<u.score){d=1/0;break}let E=2;for(;E<1/0;){const T=qT(E,l);if(c[0]*w+c[1]+c[2]*T+c[3]<u.score)break;const M=(e-t)/(E+1)/d/S;let P=Math.ceil(Math.log10(M));for(;P<1/0;){const R=d*S*Ai(10,P),k=KT(t,e,R*(E-1));if(c[0]*w+c[1]*k+c[2]*T+c[3]<u.score)break;const F=Math.floor(e/R)*d-(E-1)*d,W=Math.ceil(t/R)*d;if(F<=W){const $=W-F;for(let rt=0;rt<=$;rt+=1){const ut=(F+rt)*(R/d),J=ut+R*(E-1),lt=R,vt=$T(S,o,d,ut,J,lt),xt=Bl(t,e,ut,J),Ht=XT(E,l,t,e,ut,J),gt=QT(),wt=c[0]*vt+c[1]*xt+c[2]*Ht+c[3]*gt;wt>u.score&&(!r||ut<=t&&J>=e)&&(u.lmin=ut,u.lmax=J,u.lstep=lt,u.score=wt)}}P+=1}E+=1}}d+=1}const h=gf(u.lmax),g=gf(u.lmin),v=gf(u.lstep),m=Math.floor(GT((h-g)/v))+1,_=new Array(m);_[0]=gf(g);for(let b=1;b<m;b+=1)_[b]=gf(_[b-1]+v);return _};class Vh extends Nl{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:rv}}constructor(e){super(e)}nice(){const{nice:e}=this.options;if(e){const[n,r,o]=this.getTickMethodOptions();this.options.domain=Yg(n,r,o)}}getTicks(){const{tickMethod:e}=this.options,[n,r,o]=this.getTickMethodOptions();return e(n,r,o)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],o=e[e.length-1];return[r,o,n]}rescale(){this.nice();const{range:e,domain:n}=this.options,[r,o]=n;this.n=e.length-1,this.thresholds=new Array(this.n);for(let c=0;c<this.n;c+=1)this.thresholds[c]=((c+1)*o-(c-this.n)*r)/(this.n+1)}invert(e){const[n,r]=super.invert(e),[o,c]=this.options.domain;return n===void 0&&r===void 0?[n,r]:[n||o,r||c]}getThresholds(){return this.thresholds}clone(){return new Vh(this.options)}}function JT(t,e){const n=t.length;if(!n)return;if(n<2)return t[n-1];const r=(n-1)*e,o=Math.floor(r),c=t[o],l=t[o+1];return c+(l-c)*(r-o)}function tM(t,e,n=!1){const r=t;n||r.sort((c,l)=>c-l);const o=[];for(let c=1;c<e;c+=1)o.push(JT(r,c/e));return o}class Gh extends Nl{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:rv}}constructor(e){super(e)}rescale(){const{domain:e,range:n}=this.options;this.n=n.length-1,this.thresholds=tM(e,this.n+1,!1)}invert(e){const[n,r]=super.invert(e),{domain:o}=this.options,c=o[0],l=o[o.length-1];return n===void 0&&r===void 0?[n,r]:[n||c,r||l]}getThresholds(){return this.thresholds}clone(){return new Gh(this.options)}getTicks(){const{tickCount:e,domain:n,tickMethod:r}=this.options,o=n.length-1,c=n[0],l=n[o];return r(c,l,e)}}var fx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function eM(t,e,n){return t.size=e,UA(n)?t.height=e:t.width=e,t}function nM(t,e,n){const{size:r}=e,o=bb(t,e,n);return eM(o,r,o.orientation)}function dx(t){return e=>({value:e/t,label:String(e),domainValue:e})}function rM(t,e,n,r,o){const c=e.thresholds,l=dx(r);return Object.assign(Object.assign({},t),{color:o,data:[n,...c,r].map(l)})}function iM(t,e,n){const o=[-1/0,...e.thresholds,1/0].map((c,l)=>({value:l,domainValue:c,label:c}));return Object.assign(Object.assign({},t),{data:o,color:n,labelFilter:(c,l)=>l>0&&l<o.length-1})}function iv(t){const{domain:e}=t.getOptions(),[n,r]=[e[0],cg(e)];return[n,r]}function oM(t,e){const n=t.getOptions(),r=t.clone();return r.update(Object.assign(Object.assign({},n),{range:[(0,N.lu)(e).toString()]})),r}function aM(t,e,n,r,o,c){const{length:l}=t,u=n||r,d=o.color?c.legendContinuous.ribbonFill||"black":c.color,h=e||oM(u,d),[g,v]=iv(h),[m,_]=iv([e,n,r].filter(b=>b!==void 0).find(b=>!(b instanceof Ma)));return Object.assign(Object.assign({},t),{domain:[m,_],data:h.getTicks().map(b=>({value:b})),color:new Array(Math.floor(l)).fill(0).map((b,S)=>{const w=(v-g)/(l-1)*S+g,E=h.map(w)||d,T=r?r.map(w):1;return E.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(M,P,R,k)=>`rgba(${P}, ${R}, ${k}, ${T})`)})})}function hx(t,e,n,r,o,c){const l=Ra(t,"color"),u=nM(n,r,o);if(l instanceof Nl){const{range:g}=l.getOptions(),[v,m]=iv(l);return l instanceof Vh||l instanceof Gh?rM(u,l,v,m,g):iM(u,l,g)}const d=Ra(t,"size"),h=Ra(t,"opacity");return aM(u,l,d,h,e,c)}const Bs=t=>{const{labelFormatter:e,layout:n,order:r,orientation:o,position:c,size:l,title:u,style:d,crossPadding:h,padding:g}=t,v=fx(t,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:m,value:_,theme:b,scale:S})=>{const{bbox:w}=_,{x:E,y:T,width:M,height:P}=w,R=yb(c,n),{legendContinuous:k={}}=b,F=Rh(Object.assign({},k,Object.assign(Object.assign(Object.assign({titleText:Ih(u),labelAlign:"value",labelFormatter:typeof e=="string"?$=>ss(e)($.label):e},hx(m,S,_,t,Bs,b)),d),{classNamePrefix:cs}),v)),W=new _b({style:Object.assign(Object.assign({x:E,y:T,width:M,height:P},R),{subOptions:F})});return W.appendChild(new lx({className:"legend-continuous",style:F})),W}};Bs.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]};const px=t=>(...e)=>Bs(Object.assign({},{block:!0},t))(...e);px.props=Object.assign(Object.assign({},Bs.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const $h=t=>e=>{const{scales:n}=e,r=Ra(n,"size");return Bs(Object.assign({},{type:"size",data:r.getTicks().map((o,c)=>({value:o,label:String(o)}))},t))(e)};$h.props=Object.assign(Object.assign({},Bs.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const ov=t=>$h(Object.assign({},{block:!0},t));ov.props=Object.assign(Object.assign({},Bs.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var sM=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const gx=({static:t=!1}={})=>e=>{const{width:n,height:r,depth:o,paddingLeft:c,paddingRight:l,paddingTop:u,paddingBottom:d,padding:h,inset:g,insetLeft:v,insetTop:m,insetRight:_,insetBottom:b,margin:S,marginLeft:w,marginBottom:E,marginTop:T,marginRight:M,data:P,coordinate:R,theme:k,component:F,interaction:W,x:$,y:rt,z:et,key:ut,frame:J,labelTransform:lt,parentKey:vt,clip:xt,viewStyle:Ht,title:gt}=e,wt=sM(e,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:$,y:rt,z:et,key:ut,width:n,height:r,depth:o,padding:h,paddingLeft:c,paddingRight:l,paddingTop:u,inset:g,insetLeft:v,insetTop:m,insetRight:_,insetBottom:b,paddingBottom:d,theme:k,coordinate:R,component:F,interaction:W,frame:J,labelTransform:lt,margin:S,marginLeft:w,marginBottom:E,marginTop:T,marginRight:M,parentKey:vt,clip:xt,style:Ht},!t&&{title:gt}),{marks:[Object.assign(Object.assign(Object.assign({},wt),{key:`${ut}-0`,data:P}),t&&{title:gt})]})]};gx.props={};var vI=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function vf(t){return(e,...n)=>nn({},t(e,...n),e)}function Lc(t){return(e,...n)=>nn({},e,t(e,...n))}function cM(t){return t instanceof Date?!1:typeof t=="object"}function mf(t,e){if(!t)return e;if(Array.isArray(t))return t;if(cM(t)){const{value:n=e}=t,r=vI(t,["value"]);return Object.assign(Object.assign({},r),{value:n})}return t}var av=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const vx=()=>t=>{const{children:e}=t,n=av(t,["children"]);if(!Array.isArray(e))return[];const{data:r,scale:o={},axis:c={},legend:l={},encode:u={},transform:d=[],slider:h={}}=n,g=av(n,["data","scale","axis","legend","encode","transform","slider"]),v=e.map(m=>{var{data:_,scale:b={},axis:S={},legend:w={},encode:E={},transform:T=[],slider:M={}}=m,P=av(m,["data","scale","axis","legend","encode","transform","slider"]);return Object.assign({data:mf(_,r),scale:nn({},o,b),encode:nn({},u,E),transform:[...d,...T],axis:S&&c?nn({},c,S):!1,legend:w&&l?nn({},l,w):!1,slider:nn({},h,M)},P)});return[Object.assign(Object.assign({},g),{marks:v,type:"standardView",slider:h})]};vx.props={};function bi([t,e],[n,r]){return[t-n,e-r]}function yf([t,e],[n,r]){return[t+n,e+r]}function pi([t,e],[n,r]){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))}function na([t,e]){return Math.atan2(e,t)}function jl([t,e]){return na([t,e])+Math.PI/2}function lM(t,e){const n=na(t),r=na(e);return n<r?r-n:Math.PI*2-(n-r)}function sv(t){let e=1/0,n=-1/0,r=1/0,o=-1/0;for(const[u,d]of t)e=Math.min(u,e),n=Math.max(u,n),r=Math.min(d,r),o=Math.max(d,o);const c=n-e,l=o-r;return[e,r,c,l]}function mx([t,e],[n,r]){return[(t+n)/2,(e+r)/2]}function Zn(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function uM(t,e){return e.forEach((n,r)=>r===0?t.moveTo(n[0],n[1]):t.lineTo(n[0],n[1])),t.closePath(),t}function mI(t,e,n){const{arrowSize:r}=n,o=typeof r=="string"?+parseFloat(r)/100*pi(t,e):r,c=Math.PI/6,l=Math.atan2(e[1]-t[1],e[0]-t[0]),u=Math.PI/2-l-c,d=[e[0]-o*Math.sin(u),e[1]-o*Math.cos(u)],h=l-c,g=[e[0]-o*Math.cos(h),e[1]-o*Math.sin(h)];return[d,g]}function Yh(t,e,n,r,o){const c=na(bi(r,e))+Math.PI,l=na(bi(r,n))+Math.PI;return t.arc(r[0],r[1],o,c,l,l-c<0),t}function Ic(t,e,n,r="y",o="between",c=!1){const l=(w,E)=>w==="y"||w===!0?E?180:90:E?90:0,u=r==="y"||r===!0?n:e,d=l(r,c),h=_c(u),[g,v]=ds(h,w=>u[w]),m=new ga({domain:[g,v],range:[0,100]}),_=w=>(0,Se.Z)(u[w])&&!Number.isNaN(u[w])?m.map(u[w]):0,b={between:w=>`${t[w]} ${_(w)}%`,start:w=>w===0?`${t[w]} ${_(w)}%`:`${t[w-1]} ${_(w)}%, ${t[w]} ${_(w)}%`,end:w=>w===t.length-1?`${t[w]} ${_(w)}%`:`${t[w]} ${_(w)}%, ${t[w+1]} ${_(w)}%`},S=h.sort((w,E)=>_(w)-_(E)).map(b[o]||b.between).join(",");return`linear-gradient(${d}deg, ${S})`}function cv(t){const[e,n,r,o]=t;return[o,e,n,r]}function Na(t,e,n){const[r,o,,c]=Yr(t)?cv(e):e,[l,u]=n,d=t.getCenter(),h=jl(bi(r,d)),g=jl(bi(o,d)),v=g===h&&l!==u?g+Math.PI*2:g,m=1e-4;return{startAngle:h+m,endAngle:(v-h>=0?v:Math.PI*2+v)-m,innerRadius:pi(c,d),outerRadius:pi(r,d)}}function yI(t){const e="connect";return Object.fromEntries(Object.entries(t).filter(([n])=>n.startsWith(e)).map(([n,r])=>[lowerFirst(n.replace(e,"").trim()),r]).filter(([n])=>n!==void 0))}function yx(t){const{colorAttribute:e,opacityAttribute:n=e}=t;return`${n}Opacity`}function js(t,e){if(!kr(t))return"";const n=t.getCenter(),{transform:r}=e;return`translate(${n[0]}, ${n[1]}) ${r||""}`}function _x(t){if(t.length===1)return t[0];const[[e,n,r=0],[o,c,l=0]]=t;return[(e+o)/2,(n+c)/2,(r+l)/2]}function lv(t){return t.replace(/-(\w)/g,function(e,n){return n.toUpperCase()})}function _I(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}var fM=Array.prototype.slice;function Fa(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function oi(t){return function(){return t}}function zo(t){this._context=t}zo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Xh(t){return new zo(t)}const bx=Math.PI,xx=2*bx,zs=1e-6,bI=xx-zs;function Sx(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xI(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Sx;const n=Ai(10,e);return function(r){this._+=r[0];for(let o=1,c=r.length;o<c;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}class uv{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Sx:xI(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,o){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(e,n,r,o,c,l){this._append`C${+e},${+n},${+r},${+o},${this._x1=+c},${this._y1=+l}`}arcTo(e,n,r,o,c){if(e=+e,n=+n,r=+r,o=+o,c=+c,c<0)throw new Error(`negative radius: ${c}`);let l=this._x1,u=this._y1,d=r-e,h=o-n,g=l-e,v=u-n,m=g*g+v*v;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(m>zs)if(!(Math.abs(v*d-h*g)>zs)||!c)this._append`L${this._x1=e},${this._y1=n}`;else{let _=r-l,b=o-u,S=d*d+h*h,w=_*_+b*b,E=Math.sqrt(S),T=Math.sqrt(m),M=c*Math.tan((bx-Math.acos((S+m-w)/(2*E*T)))/2),P=M/T,R=M/E;Math.abs(P-1)>zs&&this._append`L${e+P*g},${n+P*v}`,this._append`A${c},${c},0,0,${+(v*_>g*b)},${this._x1=e+R*d},${this._y1=n+R*h}`}}arc(e,n,r,o,c,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(o),d=r*Math.sin(o),h=e+u,g=n+d,v=1^l,m=l?o-c:c-o;this._x1===null?this._append`M${h},${g}`:(Math.abs(this._x1-h)>zs||Math.abs(this._y1-g)>zs)&&this._append`L${h},${g}`,r&&(m<0&&(m=m%xx+xx),m>bI?this._append`A${r},${r},0,1,${v},${e-u},${n-d}A${r},${r},0,1,${v},${this._x1=h},${this._y1=g}`:m>zs&&this._append`A${r},${r},0,${+(m>=bx)},${v},${this._x1=e+r*Math.cos(c)},${this._y1=n+r*Math.sin(c)}`)}rect(e,n,r,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function va(){return new uv}va.prototype=uv.prototype;function SF(t=3){return new uv(+t)}function Ox(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new uv(e)}function Ex(t){return t[0]}function Ax(t){return t[1]}function Rc(t,e){var n=oi(!0),r=null,o=Xh,c=null,l=Ox(u);t=typeof t=="function"?t:t===void 0?Ex:oi(t),e=typeof e=="function"?e:e===void 0?Ax:oi(e);function u(d){var h,g=(d=Fa(d)).length,v,m=!1,_;for(r==null&&(c=o(_=l())),h=0;h<=g;++h)!(h<g&&n(v=d[h],h,d))===m&&((m=!m)?c.lineStart():c.lineEnd()),m&&c.point(+t(v,h,d),+e(v,h,d));if(_)return c=null,_+""||null}return u.x=function(d){return arguments.length?(t=typeof d=="function"?d:oi(+d),u):t},u.y=function(d){return arguments.length?(e=typeof d=="function"?d:oi(+d),u):e},u.defined=function(d){return arguments.length?(n=typeof d=="function"?d:oi(!!d),u):n},u.curve=function(d){return arguments.length?(o=d,r!=null&&(c=o(r)),u):o},u.context=function(d){return arguments.length?(d==null?r=c=null:c=o(r=d),u):r},u}function kc(t){const e=typeof t=="function"?t:t.render;return class extends N.b_{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){e(this)}}}var qh=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Tx(t){const{min:[e,n],max:[r,o]}=t.getLocalBounds();let c=0,l=0;return e>0&&(c=e),r<0&&(c=r),n>0&&(l=n),o<0&&(l=o),[c,l]}function dM(t,e=[]){const[n=0,r=0,o=n,c=r]=e,l=t.parentNode,u=l.getEulerAngles();l.setEulerAngles(0);const{min:d,halfExtents:h}=t.getLocalBounds(),[g,v]=d,[m,_]=h;return l.setEulerAngles(u),{x:g-c,y:v-n,width:m*2+c+r,height:_*2+n+o}}const SI=(t,e,n)=>{const r=dist(t,e),o=dist(e,n),c=dist(n,t);return(Math.pow(r,2)+Math.pow(o,2)-Math.pow(c,2))/(2*r*o)};function Mx(t,e,n,r,o=!0,c=!0){const l=v=>Rc()(v);if(!e[0]&&!e[1])return l([Tx(t),e]);if(!n.length)return l([[0,0],e]);const[u,d]=n,h=[...d],g=[...u];if(d[0]!==u[0]){const v=o?-4:4;h[1]=d[1],c&&!o&&(h[0]=Math.max(u[0],d[0]-v),d[1]<u[1]?g[1]=h[1]:(g[1]=u[1],g[0]=Math.max(g[0],h[0]-v))),!c&&!o&&(h[0]=Math.max(u[0],d[0]-v),d[1]>u[1]?g[1]=h[1]:(g[1]=u[1],g[0]=Math.max(g[0],h[0]-v))),!c&&o&&(h[0]=Math.min(u[0],d[0]-v),d[1]>u[1]?g[1]=h[1]:(g[1]=u[1],g[0]=Math.min(g[0],h[0]-v))),c&&o&&(h[0]=Math.min(u[0],d[0]-v),d[1]<u[1]?g[1]=h[1]:(g[1]=u[1],g[0]=Math.min(g[0],h[0]-v)))}return l([d,h,g,u,e])}const fv=kc(t=>{const e=t.attributes,{className:n,class:r,transform:o,rotate:c,labelTransform:l,labelTransformOrigin:u,x:d,y:h,x0:g=d,y0:v=h,text:m,background:_,connector:b,startMarker:S,endMarker:w,coordCenter:E,innerHTML:T}=e,M=qh(e,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(t.style.transform=`translate(${d}, ${h})`,[d,h,g,v].some(gt=>!(0,Se.Z)(gt))){t.children.forEach(gt=>gt.remove());return}const P=wn(M,"background"),{padding:R}=P,k=qh(P,["padding"]),F=wn(M,"connector"),{points:W=[]}=F,$=qh(F,["points"]);let rt;T?rt=Kn(t).maybeAppend("html","html",n).style("zIndex",0).style("innerHTML",T).call(Zn,Object.assign({transform:l,transformOrigin:u},M)).node():rt=Kn(t).maybeAppend("text","text").style("zIndex",0).style("text",m).call(Zn,Object.assign({textBaseline:"middle",transform:l,transformOrigin:u},M)).node();const et=Kn(t).maybeAppend("background","rect").style("zIndex",-1).call(Zn,dM(rt,R)).call(Zn,_?k:{}).node(),ut=+g<E[0],J=+v<E[1],lt=[+g-+d,+v-+h],vt=Mx(et,lt,W,E,ut,J),xt=S&&new Er({id:"startMarker",style:Object.assign({x:0,y:0},wn(M,"startMarker"))}),Ht=w&&new Er({id:"endMarker",style:Object.assign({x:0,y:0},wn(M,"endMarker"))});Kn(t).maybeAppend("connector","path").style("zIndex",0).style("d",vt).style("markerStart",xt).style("markerEnd",Ht).call(Zn,b?$:{})});function zl(t,e){let n,r=-1,o=-1;if(e===void 0)for(const c of t)++o,c!=null&&(n<c||n===void 0&&c>=c)&&(n=c,r=o);else for(let c of t)(c=e(c,++o,t))!=null&&(n<c||n===void 0&&c>=c)&&(n=c,r=o);return r}function wI(t,e,n,r){const o=e.length/2,c=e.slice(0,o),l=e.slice(o);let u=zl(c,(_,b)=>Math.abs(_[1]-l[b][1]));u=Math.max(Math.min(u,o-2),1);const d=_=>[c[_][0],(c[_][1]+l[_][1])/2],h=d(u),g=d(u-1),v=d(u+1),m=na(bi(v,g))/Math.PI*180;return{x:h[0],y:h[1],transform:`rotate(${m})`,textAlign:"center",textBaseline:"middle"}}function Cx(t,e,n,r){const{bounds:o}=n,[[c,l],[u,d]]=o,h=u-c,g=d-l,v=m=>{const{x:_,y:b}=m,S=l_(n.x,h),w=l_(n.y,g);return Object.assign(Object.assign({},m),{x:(S||_)+c,y:(w||b)+l})};return v(t==="left"?{x:0,y:g/2,textAlign:"start",textBaseline:"middle"}:t==="right"?{x:h,y:g/2,textAlign:"end",textBaseline:"middle"}:t==="top"?{x:h/2,y:0,textAlign:"center",textBaseline:"top"}:t==="bottom"?{x:h/2,y:g,textAlign:"center",textBaseline:"bottom"}:t==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:t==="top-right"?{x:h,y:0,textAlign:"end",textBaseline:"top"}:t==="bottom-left"?{x:0,y:g,textAlign:"start",textBaseline:"bottom"}:t==="bottom-right"?{x:h,y:g,textAlign:"end",textBaseline:"bottom"}:{x:h/2,y:g/2,textAlign:"center",textBaseline:"middle"})}function dv(t,e,n,r){const{y:o,y1:c,autoRotate:l,rotateToAlignArc:u}=n,d=r.getCenter(),h=Na(r,e,[o,c]),{innerRadius:g,outerRadius:v,startAngle:m,endAngle:_}=h,b=t==="inside"?(m+_)/2:_,S=Qh(b,l,u),w=(()=>{const[E,T]=e,M=g+(v-g)*.5,[P,R]=t==="inside"?Kh(d,b,M):mx(E,T);return{x:P,y:R}})();return Object.assign(Object.assign({},w),{textAlign:t==="inside"?"center":"start",textBaseline:"middle",rotate:S})}function Kh(t,e,n){return[t[0]+Math.sin(e)*n,t[1]-Math.cos(e)*n]}function Qh(t,e,n){if(!e)return 0;const r=n?0:Math.sin(t)<0?90:-90;return t/Math.PI*180+r}function hM(t,e,n,r){const{y:o,y1:c,autoRotate:l,rotateToAlignArc:u,radius:d=.5,offset:h=0}=n,g=Na(r,e,[o,c]),{startAngle:v,endAngle:m}=g,_=r.getCenter(),b=(v+m)/2,w={textAlign:"center",textBaseline:"middle",rotate:Qh(b,l,u)},{innerRadius:E,outerRadius:T}=g,P=E+(T-E)*d+h,[R,k]=Kh(_,b,P);return Object.assign({x:R,y:k},w)}function pM(t){return t===void 0?null:t}function Jh(t,e,n,r){const{bounds:o}=n,[c]=o;return{x:pM(c[0]),y:pM(c[1])}}function Ba(t,e,n,r){const{bounds:o}=n;return o.length===1?Jh(t,e,n,r):(qu(r)?dv:Sl(r)?hM:Cx)(t,e,n,r)}function gM(t,e,n,r,o){const[c,l]=Kh(t,e,n),[u,d]=Kh(t,e,r),h=Math.sin(e)>0?1:-1;return[[c,l],[u,d],[u+h*o,d]]}function hv(t,e,n){const r=Na(n,t,[e.y,e.y1]),{innerRadius:o,outerRadius:c}=r;return o+(c-o)}function Px(t,e,n){const r=Na(n,t,[e.y,e.y1]),{startAngle:o,endAngle:c}=r;return(o+c)/2}function Lx(t,e,n,r){const{autoRotate:o,rotateToAlignArc:c,offset:l=0,connector:u=!0,connectorLength:d=l,connectorLength2:h=0,connectorDistance:g=0}=n,v=r.getCenter(),m=Px(e,n,r),_=Math.sin(m)>0?1:-1,b=Qh(m,o,c),S={textAlign:_>0||qu(r)?"start":"end",textBaseline:"middle",rotate:b},w=hv(e,n,r),E=w+(u?d:l),[[T,M],[P,R],[k,F]]=gM(v,m,w,E,u?h:0),W=u?+g*_:0,$=k+W,rt=F,et={connector:u,connectorPoints:[[P-$,R-rt],[k-$,F-rt]]};return Object.assign(Object.assign({x0:T,y0:M,x:k+W,y:F},S),et)}function tp(t,e,n,r){const{bounds:o}=n;return o.length===1?Jh(t,e,n,r):(qu(r)?dv:Sl(r)?Lx:Cx)(t,e,n,r)}function xi(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function OI(t,e){return Array.from(e,n=>t[n])}function ja(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const r=Uint32Array.from(t,(o,c)=>c);return e.length>1?(e=e.map(o=>t.map(o)),r.sort((o,c)=>{for(const l of e){const u=Dc(l[o],l[c]);if(u)return u}})):(n=t.map(n),r.sort((o,c)=>Dc(n[o],n[c]))),OI(t,r)}return t.sort(ep(n))}function ep(t=xi){if(t===xi)return Dc;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Dc(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function np(t,e={}){const{labelHeight:n=14,height:r}=e,o=ja(t,h=>h.y),c=o.length,l=new Array(c);for(let h=0;h<c;h++){const g=o[h],{y:v}=g;l[h]={y:v,y1:v+n,labels:[v]}}let u=!0;for(;u;){u=!1;for(let h=l.length-1;h>0;h--){const g=l[h],v=l[h-1];if(v.y1>g.y){u=!0,v.labels.push(...g.labels),l.splice(h,1),v.y1+=g.y1-g.y;const m=v.y1-v.y;v.y1=Math.max(Math.min(v.y1,r),m),v.y=v.y1-m}}}let d=0;for(const h of l){const{y:g,labels:v}=h;let m=g-n;for(const _ of v){const b=o[d++],w=m+n-_;b.connectorPoints[0][1]-=w,b.y=m+n,m+=n}}}function pv(t,e){const n=ja(t,u=>u.y),{height:r,labelHeight:o=14}=e,c=Math.ceil(r/o);if(n.length<=c)return np(n,e);const l=[];for(let u=0;u<n.length;u++)u<n.length-c?(n[u].opacity=0,n[u].connector=!1):l.push(n[u]);np(l,e)}var rp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Ul=new WeakMap;function EI(t,e,n){const{connectorLength:r,connectorLength2:o,connectorDistance:c}=e,l=rp(Lx("outside",t,e,n),[]),u=n.getCenter(),d=hv(t,e,n),h=Px(t,e,n),g=d+r+o,v=Math.sin(h)>0?1:-1,m=u[0]+(g+ +c)*v,{x:_}=l,b=m-_;return l.x+=b,l.connectorPoints[0][0]-=b,l}function AI(t,e,n,r,o,c){if(!Sl(r))return{};if(Ul.has(e))return Ul.get(e);const l=c.map(m=>EI(m,n,r)),{width:u,height:d}=r.getOptions(),h=l.filter(m=>m.x<u/2),g=l.filter(m=>m.x>=u/2),v=Object.assign(Object.assign({},o),{height:d});return pv(h,v),pv(g,v),l.forEach((m,_)=>Ul.set(c[_],m)),Ul.get(e)}var vM=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function mM(t,e,n,r){if(!Sl(r))return{};const{connectorLength:o,connectorLength2:c,connectorDistance:l}=n,u=vM(Lx("outside",e,n,r),[]),{x0:d,y0:h}=u,g=r.getCenter(),m=P_(r)+o,_=jl([d-g[0],h-g[1]]),b=Math.sin(_)>0?1:-1,[S,w]=Kh(g,_,m);return u.x=S+(c+l)*b,u.y=w,u}var Uo=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function ip(t,e){return t!==void 0?t:Sl(e)?"inside":Yr(e)?"right":"top"}function Ix(t,e,n,r,o,c){const{position:l}=e,{render:u}=o,d=ip(l,n),g=r[u?"htmlLabel":d==="inside"?"innerLabel":"label"],v=Object.assign({},g,e),m=Y[lv(d)];if(!m)throw new Error(`Unknown position: ${d}`);return Object.assign(Object.assign({},g),m(d,t,v,n,o,c))}const op=(t,e)=>{const{coordinate:n,theme:r}=e,{render:o}=t;return(c,l,u,d)=>{const{text:h,x:g,y:v,transform:m="",transformOrigin:_,className:b=""}=l,S=Uo(l,["text","x","y","transform","transformOrigin","className"]),w=Ix(c,l,n,r,t,d),{rotate:E=0,transform:T=""}=w,M=Uo(w,["rotate","transform"]);return Kn(new fv).call(Zn,M).style("text",`${h}`).style("className",`${b} g2-label`).style("innerHTML",o?o(h,l.datum,l.index):void 0).style("labelTransform",`${T} rotate(${+E}) ${m}`.trim()).style("labelTransformOrigin",_).style("coordCenter",n.getCenter()).call(Zn,S).node()}};op.props={defaultMarker:"point"};var gv=function(t,e,n){var r=t,o=(0,Ze.Z)(e)?e.split("."):e;return o.forEach(function(c,l){l<o.length-1?((0,Jd.Z)(r[c])||(r[c]=(0,Se.Z)(o[l+1])?[]:{}),r=r[c]):r[c]=n}),t},ap=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},yM=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Rx=.03,kx={fill:"#fff",stroke:"#aaa",lineDash:"4 3",lineWidth:.5,fillOpacity:1,strokeOpacity:1},za=0,Nc=(t,e,n,r,o,c)=>{const l=[],u=[],d=r-1;for(let h=1;h<d;h++){const g=h/d*e,v=t+(h%2===0?n:-n);l.push(`${g},${v}`),u.push(`${g},${o?v-c:v+c}`)}return l.push(`${e},${t}`),u.push(`${e+c},${t}`),[l,u]},Dx=(t,e)=>{const{context:n,selection:r,view:o}=e,c=r.select(`.${ct}`).node(),{document:l}=n.canvas,{scale:u}=o,d=new Map,h=(v,m,_)=>ap(void 0,void 0,void 0,function*(){const{update:b,setState:S}=n.externals;S("options",w=>{const{marks:E}=w;if(!E||!E.length)return w;const T=E.map(M=>{const P=er(M,"scale.y.breaks",[]),R=P.filter(k=>k.start!==m&&k.end!==_&&!k.collapsed);return P.forEach(k=>{k.start===m&&k.end===_&&(k.collapsed=!0)}),console.log("breaks group:",P,R),nn({},M,{scale:{y:{breaks:R}}})});return d.set(v,{start:m,end:_}),Object.assign(Object.assign({},w),{marks:T})}),yield b()}),g=()=>ap(void 0,void 0,void 0,function*(){if(!d.size)return;const{update:v,setState:m}=n.externals;m("options",_=>{const{marks:b}=_,S=b.map(w=>{const E=er(w,"scale.y.breaks",[]);return gv(w,"scale.y.breaks",E.map(T=>Object.assign(Object.assign({},T),{collapsed:!1}))),w});return d.clear(),Object.assign(Object.assign({},_),{marks:S})}),yield v()});return v=>{const{key:m,start:_,end:b,gap:S=Rx,vertices:w=50,lineWidth:E=.5,verticeOffset:T=3}=v,M=yM(v,["key","start","end","gap","vertices","lineWidth","verticeOffset"]),P=l.createElement("g",{id:`break-group-${m}`,className:Yt}),R=er(u,"x.sortedDomain",[]),k=u.y.getOptions(),{range:F,domain:W}=k,$=W.indexOf(_),rt=W.indexOf(b),{width:et,height:ut}=c.getBBox();if($===-1||rt===-1||!R.length)return P;const J=F[0]>F[1],lt=F[$]*ut,vt=F[rt]*ut;let xt="",Ht="";for(const[wt,{y:Wt,isLower:fe}]of[{y:vt,isLower:!1},{y:lt,isLower:!0}].entries()){const le=J?E:-E,[Te,Fe]=Nc(Wt,et-za,T,w,fe,le);wt===0?(xt=`M ${za},${Wt} L ${Te.join(" L ")} `,Ht=`M ${za-E},${Wt+le} L ${Fe.join(" L ")} `):(xt+=`L ${et-za},${Wt} L ${[...Te].reverse().join(" L ")} L ${za},${Wt} Z`,Ht+=`L ${et-za+E+2},${Wt-le} L ${[...Fe].reverse().join(" L ")} L ${za-E},${Wt-le} Z`)}const gt=Object.assign(Object.assign({},kx),M);try{const wt=new N.y$({style:Object.assign(Object.assign({},gt),{d:xt})}),Wt=new N.y$({style:Object.assign(Object.assign({},gt),{d:Ht,lineWidth:0,cursor:"pointer"})});Wt.addEventListener("click",fe=>ap(void 0,void 0,void 0,function*(){fe.stopPropagation(),fe.detail===2&&(yield h(m,_,b))})),P.appendChild(wt),P.appendChild(Wt),c.addEventListener("click",fe=>ap(void 0,void 0,void 0,function*(){fe.detail===2&&(yield g())})),c.appendChild(P)}catch(wt){console.error("Failed to create break path:",wt)}return P}};Dx.props={};function TI(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ua(t){let e,n,r;t.length!==2?(e=xi,n=(u,d)=>xi(t(u),d),r=(u,d)=>t(u)-d):(e=t===xi||t===TI?t:Nx,n=t,r=t);function o(u,d,h=0,g=u.length){if(h<g){if(e(d,d)!==0)return g;do{const v=h+g>>>1;n(u[v],d)<0?h=v+1:g=v}while(h<g)}return h}function c(u,d,h=0,g=u.length){if(h<g){if(e(d,d)!==0)return g;do{const v=h+g>>>1;n(u[v],d)<=0?h=v+1:g=v}while(h<g)}return h}function l(u,d,h=0,g=u.length){const v=o(u,d,h,g-1);return v>h&&r(u[v-1],d)>-r(u[v],d)?v-1:v}return{left:o,center:l,right:c}}function Nx(){return 0}var Fc=function(t,e){if(!bc(t))return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];e(o,r)&&n.push(o)}return n},hs=Fc;function sp(t){return t===null?NaN:+t}function*Fx(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const _f=Ua(xi),Bx=_f.right,jx=_f.left,MI=Ua(sp).center;var zx=Bx;function _M(t,e,n){return Math.min(n,Math.max(e,t))}function ps(t){return!!t.getBandWidth}function Us(t,e,n){if(!ps(t))return t.invert(e);const{adjustedRange:r}=t;if(r.includes(e))return t.invert(e);const{domain:o}=t.getOptions(),c=n?-1:0,l=t.getStep(),u=n?r:r.map(g=>g+l),d=jx(u,e),h=_M(d+c,0,o.length-1);return o[h]}function gs(t,e,n){if(!e)return t.getOptions().domain;if(!ps(t)){const d=ja(e);if(!n)return d;const[h]=d,{range:g}=t.getOptions(),[v,m]=g,_=v>m?-1:1,b=t.invert(t.map(h)+_*n);return[h,b]}const{domain:r}=t.getOptions(),o=e[0],c=r.indexOf(o);if(n){const d=c+Math.round(r.length*n);return r.slice(c,d)}const l=e[e.length-1],u=r.indexOf(l);return r.slice(c,u+1)}function cp(t,e,n,r,o,c){const{x:l,y:u}=o,d=(_,b)=>{const[S,w]=c.invert(_);return[Us(l,S,b),Us(u,w,b)]},h=d([t,e],!0),g=d([n,r],!1),v=gs(l,[h[0],g[0]]),m=gs(u,[h[1],g[1]]);return[v,m]}function bM(t,e){const[n,r]=t,o=c=>c.getStep?c.getStep():0;return[e.map(n),e.map(r)+o(e)]}const Ux=(t,e)=>{var n,r;const[o,c]=t,l=((r=(n=e.getOptions)===null||n===void 0?void 0:n.call(e))===null||r===void 0?void 0:r.domain)||[],u=l.indexOf(o),d=l.indexOf(c);if(u===-1||d===-1)return[e.map(o),e.map(c)];const h=l.length;return h<=1?[0,1]:[u/(h-1),d/(h-1)]};function Zx(t,e,n){const{x:r,y:o}=e,[c,l]=t,u=bM(c,r),d=bM(l,o),h=[u[0],d[0]],g=[u[1],d[1]],[v,m]=n.map(h),[_,b]=n.map(g);return[v,m,_,b]}const vv=Math.abs,lo=Math.atan2,Zl=Math.cos,CI=Math.max,Hx=Math.min,ma=Math.sin,Hl=Math.sqrt,Yi=1e-12,bf=Math.PI,Wl=bf/2,mv=2*bf;function xM(t){return t>1?0:t<-1?bf:Math.acos(t)}function Wx(t){return t>=1?Wl:t<=-1?-Wl:Math.asin(t)}function SM(t){return t.innerRadius}function wM(t){return t.outerRadius}function OM(t){return t.startAngle}function yv(t){return t.endAngle}function EM(t){return t&&t.padAngle}function AM(t,e,n,r,o,c,l,u){var d=n-t,h=r-e,g=l-o,v=u-c,m=v*d-g*h;if(!(m*m<Yi))return m=(g*(e-c)-v*(t-o))/m,[t+m*d,e+m*h]}function lp(t,e,n,r,o,c,l){var u=t-n,d=e-r,h=(l?c:-c)/Hl(u*u+d*d),g=h*d,v=-h*u,m=t+g,_=e+v,b=n+g,S=r+v,w=(m+b)/2,E=(_+S)/2,T=b-m,M=S-_,P=T*T+M*M,R=o-c,k=m*S-b*_,F=(M<0?-1:1)*Hl(CI(0,R*R*P-k*k)),W=(k*M-T*F)/P,$=(-k*T-M*F)/P,rt=(k*M+T*F)/P,et=(-k*T+M*F)/P,ut=W-w,J=$-E,lt=rt-w,vt=et-E;return ut*ut+J*J>lt*lt+vt*vt&&(W=rt,$=et),{cx:W,cy:$,x01:-g,y01:-v,x11:W*(o/R-1),y11:$*(o/R-1)}}function up(){var t=SM,e=wM,n=oi(0),r=null,o=OM,c=yv,l=EM,u=null,d=Ox(h);function h(){var g,v,m=+t.apply(this,arguments),_=+e.apply(this,arguments),b=o.apply(this,arguments)-Wl,S=c.apply(this,arguments)-Wl,w=vv(S-b),E=S>b;if(u||(u=g=d()),_<m&&(v=_,_=m,m=v),!(_>Yi))u.moveTo(0,0);else if(w>mv-Yi)u.moveTo(_*Zl(b),_*ma(b)),u.arc(0,0,_,b,S,!E),m>Yi&&(u.moveTo(m*Zl(S),m*ma(S)),u.arc(0,0,m,S,b,E));else{var T=b,M=S,P=b,R=S,k=w,F=w,W=l.apply(this,arguments)/2,$=W>Yi&&(r?+r.apply(this,arguments):Hl(m*m+_*_)),rt=Hx(vv(_-m)/2,+n.apply(this,arguments)),et=rt,ut=rt,J,lt;if($>Yi){var vt=Wx($/m*ma(W)),xt=Wx($/_*ma(W));(k-=vt*2)>Yi?(vt*=E?1:-1,P+=vt,R-=vt):(k=0,P=R=(b+S)/2),(F-=xt*2)>Yi?(xt*=E?1:-1,T+=xt,M-=xt):(F=0,T=M=(b+S)/2)}var Ht=_*Zl(T),gt=_*ma(T),wt=m*Zl(R),Wt=m*ma(R);if(rt>Yi){var fe=_*Zl(M),le=_*ma(M),Te=m*Zl(P),Fe=m*ma(P),De;if(w<bf)if(De=AM(Ht,gt,Te,Fe,fe,le,wt,Wt)){var Je=Ht-De[0],qe=gt-De[1],We=fe-De[0],fn=le-De[1],_n=1/ma(xM((Je*We+qe*fn)/(Hl(Je*Je+qe*qe)*Hl(We*We+fn*fn)))/2),An=Hl(De[0]*De[0]+De[1]*De[1]);et=Hx(rt,(m-An)/(_n-1)),ut=Hx(rt,(_-An)/(_n+1))}else et=ut=0}F>Yi?ut>Yi?(J=lp(Te,Fe,Ht,gt,_,ut,E),lt=lp(fe,le,wt,Wt,_,ut,E),u.moveTo(J.cx+J.x01,J.cy+J.y01),ut<rt?u.arc(J.cx,J.cy,ut,lo(J.y01,J.x01),lo(lt.y01,lt.x01),!E):(u.arc(J.cx,J.cy,ut,lo(J.y01,J.x01),lo(J.y11,J.x11),!E),u.arc(0,0,_,lo(J.cy+J.y11,J.cx+J.x11),lo(lt.cy+lt.y11,lt.cx+lt.x11),!E),u.arc(lt.cx,lt.cy,ut,lo(lt.y11,lt.x11),lo(lt.y01,lt.x01),!E))):(u.moveTo(Ht,gt),u.arc(0,0,_,T,M,!E)):u.moveTo(Ht,gt),!(m>Yi)||!(k>Yi)?u.lineTo(wt,Wt):et>Yi?(J=lp(wt,Wt,fe,le,m,-et,E),lt=lp(Ht,gt,Te,Fe,m,-et,E),u.lineTo(J.cx+J.x01,J.cy+J.y01),et<rt?u.arc(J.cx,J.cy,et,lo(J.y01,J.x01),lo(lt.y01,lt.x01),!E):(u.arc(J.cx,J.cy,et,lo(J.y01,J.x01),lo(J.y11,J.x11),!E),u.arc(0,0,m,lo(J.cy+J.y11,J.cx+J.x11),lo(lt.cy+lt.y11,lt.cx+lt.x11),E),u.arc(lt.cx,lt.cy,et,lo(lt.y11,lt.x11),lo(lt.y01,lt.x01),!E))):u.arc(0,0,m,R,P,E)}if(u.closePath(),g)return u=null,g+""||null}return h.centroid=function(){var g=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,v=(+o.apply(this,arguments)+ +c.apply(this,arguments))/2-bf/2;return[Zl(v)*g,ma(v)*g]},h.innerRadius=function(g){return arguments.length?(t=typeof g=="function"?g:oi(+g),h):t},h.outerRadius=function(g){return arguments.length?(e=typeof g=="function"?g:oi(+g),h):e},h.cornerRadius=function(g){return arguments.length?(n=typeof g=="function"?g:oi(+g),h):n},h.padRadius=function(g){return arguments.length?(r=g==null?null:typeof g=="function"?g:oi(+g),h):r},h.startAngle=function(g){return arguments.length?(o=typeof g=="function"?g:oi(+g),h):o},h.endAngle=function(g){return arguments.length?(c=typeof g=="function"?g:oi(+g),h):c},h.padAngle=function(g){return arguments.length?(l=typeof g=="function"?g:oi(+g),h):l},h.context=function(g){return arguments.length?(u=g==null?null:g,h):u},h}var Xi=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function fp(t,e,n,r,o={}){const{inset:c=0,radius:l=0,insetLeft:u=c,insetTop:d=c,insetRight:h=c,insetBottom:g=c,radiusBottomLeft:v=l,radiusBottomRight:m=l,radiusTopLeft:_=l,radiusTopRight:b=l,minWidth:S=-1/0,maxWidth:w=1/0,minHeight:E=-1/0}=o,T=Xi(o,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!kr(r)&&!vg(r)){const W=!!Yr(r),[$,,rt]=W?cv(e):e,[et,ut]=$,[J,lt]=bi(rt,$),vt=J>0?et:et+J,xt=lt>0?ut:ut+lt,Ht=Math.abs(J),gt=Math.abs(lt),wt=vt+u,Wt=xt+d,fe=Ht-(u+h),le=gt-(d+g),Te=W?oh(fe,E,1/0):oh(fe,S,w),Fe=W?oh(le,S,w):oh(le,E,1/0),De=W?wt:wt-(Te-fe)/2,Je=W?Wt-(Fe-le)/2:Wt-(Fe-le);return Kn(t.createElement("rect",{})).style("x",De).style("y",Je).style("width",Te).style("height",Fe).style("radius",[_,b,m,v]).call(Zn,T).node()}const{y:M,y1:P}=n,R=r.getCenter(),k=Na(r,e,[M,P]),F=up().cornerRadius(l).padAngle(c*Math.PI/180);return Kn(t.createElement("path",{})).style("d",F(k)).style("transform",`translate(${R[0]}, ${R[1]})`).style("radius",l).style("inset",c).call(Zn,T).node()}const Vl=(t,e)=>{const{colorAttribute:n,opacityAttribute:r="fill",first:o=!0,last:c=!0}=t,l=Xi(t,["colorAttribute","opacityAttribute","first","last"]),{coordinate:u,document:d}=e;return(h,g,v)=>{const{color:m,radius:_=0}=v,b=Xi(v,["color","radius"]),S=b.lineWidth||1,{stroke:w,radius:E=_,radiusTopLeft:T=E,radiusTopRight:M=E,radiusBottomRight:P=E,radiusBottomLeft:R=E,innerRadius:k=0,innerRadiusTopLeft:F=k,innerRadiusTopRight:W=k,innerRadiusBottomRight:$=k,innerRadiusBottomLeft:rt=k,lineWidth:et=n==="stroke"||w?S:0,inset:ut=0,insetLeft:J=ut,insetRight:lt=ut,insetBottom:vt=ut,insetTop:xt=ut,minWidth:Ht,maxWidth:gt,minHeight:wt}=l,Wt=Xi(l,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:fe=m,opacity:le}=g,Te=[o?T:F,o?M:W,c?P:$,c?R:rt],Fe=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];Yr(u)&&Fe.push(Fe.shift());const De=Object.assign(Object.assign({radius:E},Object.fromEntries(Fe.map((Je,qe)=>[Je,Te[qe]]))),{inset:ut,insetLeft:J,insetRight:lt,insetBottom:vt,insetTop:xt,minWidth:Ht,maxWidth:gt,minHeight:wt});return Kn(fp(d,h,g,u,De)).call(Zn,b).style("fill","transparent").style(n,fe).style(yx(t),le).style("lineWidth",et).style("stroke",w===void 0?fe:w).call(Zn,Wt).node()}};Vl.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};function xf(t,e){if(e(t))return!0;if(t.tagName==="g"){const{childNodes:n=[]}=t;for(const r of n)if(xf(r,e))return!0}return!1}const TM={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function dp(t,e){let n;return xf(t,r=>{var o;return r.tagName!=="g"&&((o=r.style)===null||o===void 0?void 0:o[e])!==void 0?(n=r.style[e],!0):!1}),n!=null?n:TM[e]}function Sf(t,e,n,r){t.style[e]=n,r&&t.children.forEach(o=>Sf(o,e,n,r))}function hp(t){Sf(t,"visibility","hidden",!0)}function pp(t){Sf(t,"visibility","visible",!0)}var Zs=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function ya(t){return Kn(t).selectAll(`.${cn}`).nodes().filter(e=>!e.__removed__)}function Vx(t,e){return Gl(t,e).flatMap(({container:n})=>ya(n))}function Gl(t,e){return e.filter(n=>n!==t&&n.options.parentKey===t.options.key)}function uo(t){return Kn(t).select(`.${ct}`).node()}function wf(t){if(t.tagName==="g")return t.getRenderBounds();const e=t.getGeometryBounds(),n=new N.mN;return n.setFromTransformedAABB(e,t.getWorldTransform()),n}function Bc(t,e){const{offsetX:n,offsetY:r}=e,o=wf(t),{min:[c,l],max:[u,d]}=o,h=n<c||n>u,g=r<l||r>d;return h||g?null:[n-c,r-l]}function _v(t,e){const{offsetX:n,offsetY:r}=e,[o,c,l,u]=MM(t);return[Math.min(l,Math.max(o,n))-o,Math.min(u,Math.max(c,r))-c]}function MM(t){const e=t.getRenderBounds(),{min:[n,r],max:[o,c]}=e;return[n,r,o,c]}function bv(t){return e=>e.__data__.color}function Of(t){return e=>e.__data__.x}function vs(t){const e=Array.isArray(t)?t:[t],n=new Map(e.flatMap(r=>Array.from(r.markState.keys()).map(c=>[$l(r.key,c.key),c.data])));return r=>{const{index:o,markKey:c,viewKey:l}=r.__data__;return n.get($l(l,c))[o]}}const xv={selected:3,unselected:3,active:2,inactive:2,default:1},Gx={selection:["selected","unselected"],highlight:["active","inactive"]},Sv=(t,e,n)=>{xf(t,r=>{"setAttribute"in r&&typeof r.setAttribute=="function"&&r.setAttribute(e,n)})};function gp(t,e){return e.forEach(n=>{const r=n.__interactionStyle__;r?n.__interactionStyle__=Object.assign(Object.assign({},r),t):n.__interactionStyle__=t}),(n=(o,c)=>o,r=Sv)=>Hs(void 0,n,r)}function Hs(t,e=(r,o)=>r,n=Sv){const r="__states__",o="__ordinal__",c=_=>xv[_]||xv.default,l=_=>{var b;return(b=Object.entries(Gx).find(([S,w])=>w.includes(_)))===null||b===void 0?void 0:b[0]},u=_=>{var b;const{[r]:S=[],[o]:w={}}=_,E=[...S].sort((P,R)=>c(R)-c(P)),T=new Map;for(const P of E){const R=((b=t!=null?t:_.__interactionStyle__)===null||b===void 0?void 0:b[P])||{};for(const[k,F]of Object.entries(R))T.has(k)||T.set(k,F)}const M=Object.assign({},w);for(const[P,R]of T.entries())M[P]=R;if(Object.keys(M).length!==0){for(const[P,R]of Object.entries(M)){const k=dp(_,P),F=e(R,_);n(_,P,F),P in w||(w[P]=k)}_[o]=w}},d=_=>{_[r]||(_[r]=[])};return{setState:(_,...b)=>{d(_),_[r]=[...b],u(_)},updateState:(_,...b)=>{d(_);const S=_[r],w=new Set(b.map(T=>l(T)).filter(T=>T!==void 0)),E=S.filter(T=>!w.has(l(T)));_[r]=[...E,...b],u(_)},removeState:(_,...b)=>{d(_);for(const S of b){const w=_[r].indexOf(S);w!==-1&&_[r].splice(w,1)}u(_)},hasState:(_,b)=>(d(_),_[r].indexOf(b)!==-1)}}function vp(t){return t===void 0?!0:typeof t!="object"?!1:Object.keys(t).length===0}function $l(t,e){return`${t},${e}`}function Ws(t,e){const r=(Array.isArray(t)?t:[t]).flatMap(c=>c.marks.map(l=>[$l(c.key,l.key),l.state])),o={};for(const c of e){const[l,u]=Array.isArray(c)?c:[c,{}];o[l]=r.reduce((d,h)=>{const[g,v={}]=h,m=vp(v[l])?u:v[l];for(const[_,b]of Object.entries(m)){const S=d[_],w=(E,T,M,P)=>{const R=$l(P.__data__.viewKey,P.__data__.markKey);return g!==R?S==null?void 0:S(E,T,M,P):typeof b!="function"?b:b(E,T,M,P)};d[_]=w}return d},{})}return o}function Yl(t,e){const n=new Map(t.map((o,c)=>[o,c])),r=e?t.map(e):t;return(o,c)=>{if(typeof o!="function")return o;const l=n.get(c),u=e?e(c):c;return o(u,l,r,c)}}function $x(t){var{link:e=!1,valueof:n=(g,v)=>g,coordinate:r}=t,o=Zs(t,["link","valueof","coordinate"]);const c="element-link";if(!e)return[()=>{},()=>{}];const l=g=>g.__data__.points,u=(g,v)=>{const[,m,_]=g,[b,,,S]=v;return[m,b,S,_]};return[g=>{var v;if(g.length<=1)return;const m=ja(g,(_,b)=>{const{x:S}=_.__data__,{x:w}=b.__data__;return S-w});for(let _=1;_<m.length;_++){const b=va(),S=m[_-1],w=m[_],[E,T,M,P]=u(l(S),l(w));b.moveTo(...E),b.lineTo(...T),b.lineTo(...M),b.lineTo(...P),b.closePath();const R=Pa(o,$=>n($,S)),{fill:k=S.getAttribute("fill")}=R,F=Zs(R,["fill"]),W=new N.y$({className:c,style:Object.assign({d:b.toString(),fill:k,zIndex:-2},F)});(v=S.link)===null||v===void 0||v.remove(),S.parentNode.appendChild(W),S.link=W}},g=>{var v;(v=g.link)===null||v===void 0||v.remove(),g.link=null}]}function Yx(t,e,n){const r=o=>{const{transform:c}=t.style;return c?`${c} ${o}`:o};if(kr(n)){const{points:o}=t.__data__,[c,l]=Yr(n)?cv(o):o,u=n.getCenter(),d=bi(c,u),h=bi(l,u),g=na(d),v=lM(d,h),m=g+v/2,_=e*Math.cos(m),b=e*Math.sin(m);return r(`translate(${_}, ${b})`)}return Yr(n)?r(`translate(${e}, 0)`):r(`translate(0, ${-e})`)}function Xx(t){var{document:e,background:n,scale:r,coordinate:o,valueof:c}=t,l=Zs(t,["document","background","scale","coordinate","valueof"]);const u="element-background";if(!n)return[()=>{},()=>{}];const d=(E,T,M)=>{const P=E.invert(T),R=T+E.getBandWidth(P)/2,k=E.getStep(P)/2,F=k*M;return[R-k+F,R+k-F]},h=(E,T)=>{const{x:M}=r;if(!ps(M))return[0,1];const{__data__:P}=E,{x:R}=P,[k,F]=d(M,R,T);return[k,F]},g=(E,T)=>{const{y:M}=r;if(!ps(M))return[0,1];const{__data__:P}=E,{y:R}=P,[k,F]=d(M,R,T);return[k,F]},v=(E,T)=>{const{padding:M}=T,[P,R]=h(E,M),[k,F]=g(E,M),W=[[P,k],[R,k],[R,F],[P,F]].map(ut=>o.map(ut)),{__data__:$}=E,{y:rt,y1:et}=$;return fp(e,W,{y:rt,y1:et},o,T)},m=(E,T)=>{const{transform:M="scale(1.2, 1.2)",transformOrigin:P="center center",stroke:R=""}=T,k=Zs(T,["transform","transformOrigin","stroke"]),F=Object.assign({transform:M,transformOrigin:P,stroke:R},k),W=E.cloneNode(!0);for(const[$,rt]of Object.entries(F))W.style[$]=rt;return W},_=()=>{const{x:E,y:T}=r;return[E,T].some(ps)};return[E=>{E.background&&E.background.remove();const T=Pa(l,ut=>c(ut,E)),{fill:M="#CCD6EC",fillOpacity:P=.3,zIndex:R=-2,padding:k=.001,lineWidth:F=0}=T,W=Zs(T,["fill","fillOpacity","zIndex","padding","lineWidth"]),$=Object.assign(Object.assign({},W),{fill:M,fillOpacity:P,zIndex:R,padding:k,lineWidth:F}),et=(_()?v:m)(E,$);et.className=u,E.parentNode.parentNode.appendChild(et),E.background=et},E=>{var T;(T=E.background)===null||T===void 0||T.remove(),E.background=null},E=>E.className===u]}function ra(t,e){const r=t.getRootNode().defaultView.getContextService().getDomElement();r!=null&&r.style&&(t.cursor=r.style.cursor,r.style.cursor=e)}function qx(t){ra(t,t.cursor)}function mp(t,e,n){return t.find(r=>Object.entries(e).every(([o,c])=>n(r)[o]===c))}function Ef(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Xl(t,e=!1){const n=hs(t,r=>!!r).map((r,o)=>[o===0?"M":"L",...r]);return e&&n.push(["Z"]),n}function wv(t){return t.querySelectorAll(".element")}function CM(t,e,n=0){const r=[["M",...e[1]]],o=Ef(t,e[1]),c=Ef(t,e[0]);return o===0?r.push(["L",...e[3]],["A",c,c,0,n,1,...e[0]],["Z"]):r.push(["A",o,o,0,n,0,...e[2]],["L",...e[3]],["A",c,c,0,n,1,...e[0]],["Z"]),r}function Af(t,e){if(e(t))return t;let n=t.parent;for(;n&&!e(n);)n=n.parent;return n}const Ov=["interval","point","density"];function Kx({elementsof:t,root:e,coordinate:n,scale:r,validFindByXMarks:o=Ov}){var c,l;let u=t(e);const d=g=>o.includes(g.markType);if(u.find(d)){u=u.filter(d);const g=r.x,v=r.series,m=(l=(c=g==null?void 0:g.getBandWidth)===null||c===void 0?void 0:c.call(g))!==null&&l!==void 0?l:0,_=v?b=>{var S,w;const E=Math.round(1/((S=v.valueBandWidth)!==null&&S!==void 0?S:1));return b.__data__.x+((w=b.__data__.series)!==null&&w!==void 0?w:0)*m+m/(E*2)}:b=>b.__data__.x+m/2;return u.sort((b,S)=>_(b)-_(S)),b=>{const S=Bc(e,b);if(!S)return;const[w]=n.invert(S),E=Ua(_).center,T=E(u,w);return u[T]}}return g=>{const{target:v}=g;return Af(v,m=>m.classList?m.classList.includes("element"):!1)}}function PM(t){const c=.01/Math.max(t,1e-4);return Math.max(.1,Math.min(100,c))}function Ev(t){return t===!1||t===null||t===void 0}function LM(t){var e,n;const r=[],o=[],c=[],l=t.markState;if(l){for(const[u,d]of l.entries())if(d!=null&&d.channels){const h={};for(const m of d.channels)if((m==null?void 0:m.name)==="x"&&((e=m.values)===null||e===void 0?void 0:e.length)>0){let _=[];for(const b of m.values)b!=null&&b.value&&(_=_.concat(b.value),r.push(b.value));h.x=_}else if(m&&(m.name==="y"||m.name.startsWith("y"))&&((n=m.values)===null||n===void 0?void 0:n.length)>0){const _=m.name,b=[];for(const S of m.values)if(S!=null&&S.value){const w=S.value;b.push(w),(_==="y"||_==="y1")&&(Array.isArray(w)?o.push(w.flat()):o.push([w]))}h[_]=b}const g=h.x||[],v=h.y||[];g.length>0&&v.length>0&&c.push({markKey:u.key||`mark_${c.length}`,channelData:h})}}return{xChannelValues:r.flat(),yChannelValues:o.flat(),markDataPairs:c}}function Av(t,e){const n=new Set;for(const r of e){const{scale:o}=r,c=o==null?void 0:o[t];if(!c)continue;if(c.independent)return!0;const l=c.key||"default";if(n.add(l),n.size>1)return!0}return!1}function Qx(t,e,n,r,o){var c,l,u,d;const h={x:e.x||n.getOptions().domain||[],y:e.y||r.getOptions().domain||[]},g=o||Tv(t),{hasIndependentX:v,hasIndependentY:m}=g;if(v||m){let _=1,b=1;for(const[S,w]of t.markState.entries())if(w!=null&&w.channels){if(v){const E=w.channels.find(T=>T.name==="x");if(!((l=(c=S==null?void 0:S.scale)===null||c===void 0?void 0:c.x)===null||l===void 0)&&l.independent){const T=`x${_}`;h[T]=E.scale.domain,_++}}if(m){const E=w.channels.find(T=>T.name==="y");if(!((d=(u=S==null?void 0:S.scale)===null||u===void 0?void 0:u.y)===null||d===void 0)&&d.independent){const T=`y${b}`;h[T]=E.scale.domain,b++}}}}return h}function Tv(t){var e,n,r,o,c,l,u,d;const h=Array.from(t.markState.keys()),g=Av("x",h),v=Av("y",h),m=[],_=[],b=[],S=[],w=new Map,E=new Map,T=new Map,M=new Map;let P=1,R=1;for(const[k]of t.markState.entries()){const F=k.key,W=((n=(e=k==null?void 0:k.scale)===null||e===void 0?void 0:e.x)===null||n===void 0?void 0:n.key)||"x";if(!!(!((o=(r=k==null?void 0:k.scale)===null||r===void 0?void 0:r.x)===null||o===void 0)&&o.independent)||g&&W!=="x"){_.push(F),T.has(W)||T.set(W,P++);const ut=T.get(W);w.set(F,`x${ut}`)}else m.push(F),w.set(F,"x");const rt=((l=(c=k==null?void 0:k.scale)===null||c===void 0?void 0:c.y)===null||l===void 0?void 0:l.key)||"y";if(!!(!((d=(u=k==null?void 0:k.scale)===null||u===void 0?void 0:u.y)===null||d===void 0)&&d.independent)||v&&rt!=="y"){S.push(F),M.has(rt)||M.set(rt,R++);const ut=M.get(rt);E.set(F,`y${ut}`)}else b.push(F),E.set(F,"y")}return{hasIndependentX:g,hasIndependentY:v,marksWithSharedX:m,marksWithIndependentX:_,marksWithSharedY:b,marksWithIndependentY:S,markToXScaleMap:w,markToYScaleMap:E}}function IM(t){return Af(t,e=>e.className==="component")}function RM(t){return Af(t,e=>e.className==="element")}function Jx(t){return Af(t,e=>e.className==="label")}function eo(t,e,n,r=o=>!0){return o=>{if(!r(o))return;n.emit(`plot:${t}`,o);const{target:c}=o;if(!c)return;const{className:l}=c;if(l==="plot")return;const u=RM(c),d=IM(c),h=Jx(c),g=u||d||h;if(!g)return;const{className:v,markType:m}=g,_=Object.assign(Object.assign({},o),{nativeEvent:!0});v==="element"?(_.data={data:Q0(g,e)},n.emit(`element:${t}`,_),n.emit(`${m}:${t}`,_)):v==="label"?(_.data={data:g.attributes.datum},n.emit(`label:${t}`,_),l.split(/\s+/).filter(Boolean).forEach(S=>{n.emit(`${S}:${t}`,_)})):(n.emit(`component:${t}`,_),l.split(/\s+/).filter(Boolean).forEach(S=>{n.emit(`${S}:${t}`,_)}))}}function t2(){return(t,e,n)=>{const{container:r,view:o}=t,c=eo(Ir.CLICK,o,n,F=>F.detail===1),l=eo(Ir.DBLCLICK,o,n,F=>F.detail===2),u=eo(Ir.POINTER_TAP,o,n),d=eo(Ir.POINTER_DOWN,o,n),h=eo(Ir.POINTER_UP,o,n),g=eo(Ir.POINTER_OVER,o,n),v=eo(Ir.POINTER_OUT,o,n),m=eo(Ir.POINTER_MOVE,o,n),_=eo(Ir.POINTER_ENTER,o,n),b=eo(Ir.POINTER_LEAVE,o,n),S=eo(Ir.POINTER_UPOUTSIDE,o,n),w=eo(Ir.DRAG_START,o,n),E=eo(Ir.DRAG,o,n),T=eo(Ir.DRAG_END,o,n),M=eo(Ir.DRAG_ENTER,o,n),P=eo(Ir.DRAG_LEAVE,o,n),R=eo(Ir.DRAG_OVER,o,n),k=eo(Ir.DROP,o,n);return r.addEventListener("click",c),r.addEventListener("click",l),r.addEventListener("pointertap",u),r.addEventListener("pointerdown",d),r.addEventListener("pointerup",h),r.addEventListener("pointerover",g),r.addEventListener("pointerout",v),r.addEventListener("pointermove",m),r.addEventListener("pointerenter",_),r.addEventListener("pointerleave",b),r.addEventListener("pointerupoutside",S),r.addEventListener("dragstart",w),r.addEventListener("drag",E),r.addEventListener("dragend",T),r.addEventListener("dragenter",M),r.addEventListener("dragleave",P),r.addEventListener("dragover",R),r.addEventListener("drop",k),()=>{r.removeEventListener("click",c),r.removeEventListener("click",l),r.removeEventListener("pointertap",u),r.removeEventListener("pointerdown",d),r.removeEventListener("pointerup",h),r.removeEventListener("pointerover",g),r.removeEventListener("pointerout",v),r.removeEventListener("pointermove",m),r.removeEventListener("pointerenter",_),r.removeEventListener("pointerleave",b),r.removeEventListener("pointerupoutside",S),r.removeEventListener("dragstart",w),r.removeEventListener("drag",E),r.removeEventListener("dragend",T),r.removeEventListener("dragenter",M),r.removeEventListener("dragleave",P),r.removeEventListener("dragover",R),r.removeEventListener("drop",k)}}}t2.props={reapplyWhenUpdate:!0};function kM(){return{"component.axisRadar":Mb,"component.axisLinear":Ns,"component.axisArc":Dl,"component.legendContinuousBlock":px,"component.legendContinuousBlockSize":ov,"component.legendContinuousSize":$h,"interaction.event":t2,"composition.mark":gx,"composition.view":vx,"shape.label.label":op,"shape.break":Dx}}var Mv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function ui(t,e){const n=Object.assign(Object.assign({},kM()),e),r=c=>{if(typeof c!="string")return c;const l=`${t}.${c}`;return n[l]||vl(`Unknown Component: ${l}`)};return[(c,l)=>{const{type:u}=c,d=Mv(c,["type"]);u||vl("Plot type is required!");const h=r(u);return h==null?void 0:h(d,l)},r]}function Cv(t){const{canvas:e,group:n}=t;return(e==null?void 0:e.document)||(n==null?void 0:n.ownerDocument)||vl("Cannot find library document")}var Pv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function e2(t,e,n){const[r]=ui("coordinate",n),{innerHeight:o,innerWidth:c,insetLeft:l,insetTop:u,insetRight:d,insetBottom:h}=t,{coordinates:g=[]}=e,v=n2(g),m=v[0].type==="cartesian3D",_=Object.assign(Object.assign({},t),{x:l,y:u,width:c-l-d,height:o-h-u,transformations:v.flatMap(r)});return m?new A_.Coordinate3D(_):new A_.Coordinate(_)}function yp(t,e){const{coordinate:n={},coordinates:r}=t,o=Pv(t,["coordinate","coordinates"]);if(r)return t;const{type:c,transform:l=[]}=n,u=Pv(n,["type","transform"]);if(!c)return Object.assign(Object.assign({},o),{coordinates:l});const[,d]=ui("coordinate",e),{transform:h=!1}=d(c).props||{};if(h)throw new Error(`Unknown coordinate: ${c}.`);return Object.assign(Object.assign({},o),{coordinates:[Object.assign({type:c},u),...l]})}function Zo(t,e){return t.filter(n=>n.type===e)}function fo(t){return Zo(t,"polar").length>0}function Lv(t){return Zo(t,"helix").length>0}function ql(t){return Zo(t,"transpose").length%2===1}function PI(t){return Zo(t,"parallel").length>0}function Iv(t){return Zo(t,"theta").length>0}function DM(t){return Zo(t,"reflect").length>0}function _p(t){return Zo(t,"radial").length>0}function Tf(t){return Zo(t,"radar").length>0}function Mf(t){return Zo(t,"reflectY").length>0}function n2(t){return t.find(e=>e.type==="cartesian"||e.type==="cartesian3D")?t:[...t,{type:"cartesian"}]}function sr(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}var NM=sr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),jc=sr("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),r2=sr("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),FM=sr("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),BM=sr("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),jM=sr("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),zM=sr("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),UM=sr("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),ZM=sr("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),LI=sr("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),II=sr("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function Rv(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i2(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Cf(){}var Kl=.7,Pf=1/Kl,zc="\\s*([+-]?\\d+)\\s*",Lf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ms="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o2=/^#([0-9a-f]{3,8})$/,HM=new RegExp("^rgb\\(".concat(zc,",").concat(zc,",").concat(zc,"\\)$")),RI=new RegExp("^rgb\\(".concat(ms,",").concat(ms,",").concat(ms,"\\)$")),a2=new RegExp("^rgba\\(".concat(zc,",").concat(zc,",").concat(zc,",").concat(Lf,"\\)$")),WM=new RegExp("^rgba\\(".concat(ms,",").concat(ms,",").concat(ms,",").concat(Lf,"\\)$")),kI=new RegExp("^hsl\\(".concat(Lf,",").concat(ms,",").concat(ms,"\\)$")),s2=new RegExp("^hsla\\(".concat(Lf,",").concat(ms,",").concat(ms,",").concat(Lf,"\\)$")),c2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Rv(Cf,If,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:VM,formatHex:VM,formatHex8:bp,formatHsl:GM,formatRgb:$M,toString:$M});function VM(){return this.rgb().formatHex()}function bp(){return this.rgb().formatHex8()}function GM(){return Zc(this).formatHsl()}function $M(){return this.rgb().formatRgb()}function If(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=o2.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xp(e):n===3?new Ao(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ia(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ia(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=HM.exec(t))?new Ao(e[1],e[2],e[3],1):(e=RI.exec(t))?new Ao(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=a2.exec(t))?ia(e[1],e[2],e[3],e[4]):(e=WM.exec(t))?ia(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kI.exec(t))?u2(e[1],e[2]/100,e[3]/100,1):(e=s2.exec(t))?u2(e[1],e[2]/100,e[3]/100,e[4]):c2.hasOwnProperty(t)?xp(c2[t]):t==="transparent"?new Ao(NaN,NaN,NaN,0):null}function xp(t){return new Ao(t>>16&255,t>>8&255,t&255,1)}function ia(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ao(t,e,n,r)}function YM(t){return t instanceof Cf||(t=If(t)),t?(t=t.rgb(),new Ao(t.r,t.g,t.b,t.opacity)):new Ao}function Rf(t,e,n,r){return arguments.length===1?YM(t):new Ao(t,e,n,r==null?1:r)}function Ao(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Rv(Ao,Rf,i2(Cf,{brighter:function(e){return e=e==null?Pf:Math.pow(Pf,e),new Ao(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Kl:Math.pow(Kl,e),new Ao(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new Ao(Za(this.r),Za(this.g),Za(this.b),kf(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kv,formatHex:kv,formatHex8:l2,formatRgb:Vs,toString:Vs}));function kv(){return"#".concat(Uc(this.r)).concat(Uc(this.g)).concat(Uc(this.b))}function l2(){return"#".concat(Uc(this.r)).concat(Uc(this.g)).concat(Uc(this.b)).concat(Uc((isNaN(this.opacity)?1:this.opacity)*255))}function Vs(){var t=kf(this.opacity);return"".concat(t===1?"rgb(":"rgba(").concat(Za(this.r),", ").concat(Za(this.g),", ").concat(Za(this.b)).concat(t===1?")":", ".concat(t,")"))}function kf(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Za(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Uc(t){return t=Za(t),(t<16?"0":"")+t.toString(16)}function u2(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new _a(t,e,n,r)}function Zc(t){if(t instanceof _a)return new _a(t.h,t.s,t.l,t.opacity);if(t instanceof Cf||(t=If(t)),!t)return new _a;if(t instanceof _a)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),c=Math.max(e,n,r),l=NaN,u=c-o,d=(c+o)/2;return u?(e===c?l=(n-r)/u+(n<r)*6:n===c?l=(r-e)/u+2:l=(e-n)/u+4,u/=d<.5?c+o:2-c-o,l*=60):u=d>0&&d<1?0:l,new _a(l,u,d,t.opacity)}function XM(t,e,n,r){return arguments.length===1?Zc(t):new _a(t,e,n,r==null?1:r)}function _a(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Rv(_a,XM,i2(Cf,{brighter:function(e){return e=e==null?Pf:Math.pow(Pf,e),new _a(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Kl:Math.pow(Kl,e),new _a(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*n,c=2*r-o;return new Ao(f2(e>=240?e-240:e+120,c,o),f2(e,c,o),f2(e<120?e+240:e-120,c,o),this.opacity)},clamp:function(){return new _a(qM(this.h),Dv(this.s),Dv(this.l),kf(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=kf(this.opacity);return"".concat(e===1?"hsl(":"hsla(").concat(qM(this.h),", ").concat(Dv(this.s)*100,"%, ").concat(Dv(this.l)*100,"%").concat(e===1?")":", ".concat(e,")"))}}));function qM(t){return t=(t||0)%360,t<0?t+360:t}function Dv(t){return Math.max(0,Math.min(1,t||0))}function f2(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function KM(t,e,n,r,o){var c=t*t,l=c*t;return((1-3*t+3*c-l)*e+(4-6*c+3*l)*n+(1+3*t+3*c-3*l)*r+l*o)/6}function DI(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],c=t[r+1],l=r>0?t[r-1]:2*o-c,u=r<e-1?t[r+2]:2*c-o;return KM((n-r/e)*e,l,o,c,u)}}function NI(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],c=t[r%e],l=t[(r+1)%e],u=t[(r+2)%e];return KM((n-r/e)*e,o,c,l,u)}}var d2=function(t){return function(){return t}};function Nv(t,e){return function(n){return t+n*e}}function h2(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function FI(t,e){var n=e-t;return n?Nv(t,n>180||n<-180?n-360*Math.round(n/360):n):d2(isNaN(t)?e:t)}function Hc(t){return(t=+t)==1?Wc:function(e,n){return n-e?h2(e,n,t):d2(isNaN(e)?n:e)}}function Wc(t,e){var n=e-t;return n?Nv(t,n):d2(isNaN(t)?e:t)}var Fv=function t(e){var n=Hc(e);function r(o,c){var l=n((o=Rf(o)).r,(c=Rf(c)).r),u=n(o.g,c.g),d=n(o.b,c.b),h=Wc(o.opacity,c.opacity);return function(g){return o.r=l(g),o.g=u(g),o.b=d(g),o.opacity=h(g),o+""}}return r.gamma=t,r}(1);function p2(t){return function(e){var n=e.length,r=new Array(n),o=new Array(n),c=new Array(n),l,u;for(l=0;l<n;++l)u=Rf(e[l]),r[l]=u.r||0,o[l]=u.g||0,c[l]=u.b||0;return r=t(r),o=t(o),c=t(c),u.opacity=1,function(d){return u.r=r(d),u.g=o(d),u.b=c(d),u+""}}}var QM=p2(DI),Df=p2(NI),ai=t=>QM(t[t.length-1]),g2=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(sr),BI=ai(g2),JM=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(sr),jI=ai(JM),t5=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(sr),zI=ai(t5),e5=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(sr),UI=ai(e5),Bv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(sr),v2=ai(Bv),n5=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(sr),jv=ai(n5),Ql=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(sr),ZI=ai(Ql),Sp=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(sr),Nf=ai(Sp),r5=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(sr),zv=ai(r5),wp=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(sr),Ff=ai(wp),m2=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(sr),y2=ai(m2),qi=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(sr),i5=ai(qi),_2=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(sr),Dr=ai(_2),b2=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(sr),Bf=ai(b2),Jl=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(sr),o5=ai(Jl),x2=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(sr),a5=ai(x2),S2=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(sr),s5=ai(S2),Uv=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(sr),w2=ai(Uv),O2=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(sr),c5=ai(O2),E2=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(sr),A2=ai(E2),T2=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(sr),M2=ai(T2),C2=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(sr),l5=ai(C2),P2=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(sr),u5=ai(P2),L2=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(sr),f5=ai(L2),I2=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(sr),R2=ai(I2),k2=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(sr),d5=ai(k2),D2=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(sr),N2=ai(D2);function h5(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}function Op(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function tu(){}var Vc=.7,eu=1/Vc,Gc="\\s*([+-]?\\d+)\\s*",jf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ha="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",p5=/^#([0-9a-f]{3,8})$/,g5=new RegExp("^rgb\\(".concat(Gc,",").concat(Gc,",").concat(Gc,"\\)$")),v5=new RegExp("^rgb\\(".concat(Ha,",").concat(Ha,",").concat(Ha,"\\)$")),m5=new RegExp("^rgba\\(".concat(Gc,",").concat(Gc,",").concat(Gc,",").concat(jf,"\\)$")),y5=new RegExp("^rgba\\(".concat(Ha,",").concat(Ha,",").concat(Ha,",").concat(jf,"\\)$")),_5=new RegExp("^hsl\\(".concat(jf,",").concat(Ha,",").concat(Ha,"\\)$")),F2=new RegExp("^hsla\\(".concat(jf,",").concat(Ha,",").concat(Ha,",").concat(jf,"\\)$")),B2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Op(tu,Hv,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:j2,formatHex:j2,formatHex8:b5,formatHsl:z2,formatRgb:U2,toString:U2});function j2(){return this.rgb().formatHex()}function b5(){return this.rgb().formatHex8()}function z2(){return Y2(this).formatHsl()}function U2(){return this.rgb().formatRgb()}function Hv(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=p5.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Z2(e):n===3?new ho(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ep(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ep(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=g5.exec(t))?new ho(e[1],e[2],e[3],1):(e=v5.exec(t))?new ho(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=m5.exec(t))?Ep(e[1],e[2],e[3],e[4]):(e=y5.exec(t))?Ep(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=_5.exec(t))?$2(e[1],e[2]/100,e[3]/100,1):(e=F2.exec(t))?$2(e[1],e[2]/100,e[3]/100,e[4]):B2.hasOwnProperty(t)?Z2(B2[t]):t==="transparent"?new ho(NaN,NaN,NaN,0):null}function Z2(t){return new ho(t>>16&255,t>>8&255,t&255,1)}function Ep(t,e,n,r){return r<=0&&(t=e=n=NaN),new ho(t,e,n,r)}function H2(t){return t instanceof tu||(t=Hv(t)),t?(t=t.rgb(),new ho(t.r,t.g,t.b,t.opacity)):new ho}function W2(t,e,n,r){return arguments.length===1?H2(t):new ho(t,e,n,r==null?1:r)}function ho(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Op(ho,W2,Zv(tu,{brighter:function(e){return e=e==null?eu:Math.pow(eu,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Vc:Math.pow(Vc,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new ho($c(this.r),$c(this.g),$c(this.b),Ap(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:V2,formatHex:V2,formatHex8:x5,formatRgb:G2,toString:G2}));function V2(){return"#".concat(Yc(this.r)).concat(Yc(this.g)).concat(Yc(this.b))}function x5(){return"#".concat(Yc(this.r)).concat(Yc(this.g)).concat(Yc(this.b)).concat(Yc((isNaN(this.opacity)?1:this.opacity)*255))}function G2(){var t=Ap(this.opacity);return"".concat(t===1?"rgb(":"rgba(").concat($c(this.r),", ").concat($c(this.g),", ").concat($c(this.b)).concat(t===1?")":", ".concat(t,")"))}function Ap(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function $c(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Yc(t){return t=$c(t),(t<16?"0":"")+t.toString(16)}function $2(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new oa(t,e,n,r)}function Y2(t){if(t instanceof oa)return new oa(t.h,t.s,t.l,t.opacity);if(t instanceof tu||(t=Hv(t)),!t)return new oa;if(t instanceof oa)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),c=Math.max(e,n,r),l=NaN,u=c-o,d=(c+o)/2;return u?(e===c?l=(n-r)/u+(n<r)*6:n===c?l=(r-e)/u+2:l=(e-n)/u+4,u/=d<.5?c+o:2-c-o,l*=60):u=d>0&&d<1?0:l,new oa(l,u,d,t.opacity)}function X2(t,e,n,r){return arguments.length===1?Y2(t):new oa(t,e,n,r==null?1:r)}function oa(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Op(oa,X2,Zv(tu,{brighter:function(e){return e=e==null?eu:Math.pow(eu,e),new oa(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Vc:Math.pow(Vc,e),new oa(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*n,c=2*r-o;return new ho(Tp(e>=240?e-240:e+120,c,o),Tp(e,c,o),Tp(e<120?e+240:e-120,c,o),this.opacity)},clamp:function(){return new oa(Wv(this.h),ys(this.s),ys(this.l),Ap(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=Ap(this.opacity);return"".concat(e===1?"hsl(":"hsla(").concat(Wv(this.h),", ").concat(ys(this.s)*100,"%, ").concat(ys(this.l)*100,"%").concat(e===1?")":", ".concat(e,")"))}}));function Wv(t){return t=(t||0)%360,t<0?t+360:t}function ys(t){return Math.max(0,Math.min(1,t||0))}function Tp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var S5=Math.PI/180,w5=180/Math.PI,q2=-.14861,Vv=1.78277,Xc=-.29227,Gs=-.90649,_s=1.97294,nu=_s*Gs,K2=_s*Vv,Gv=Vv*Xc-Gs*q2;function $v(t){if(t instanceof qc)return new qc(t.h,t.s,t.l,t.opacity);t instanceof ho||(t=H2(t));var e=t.r/255,n=t.g/255,r=t.b/255,o=(Gv*r+nu*e-K2*n)/(Gv+nu-K2),c=r-o,l=(_s*(n-o)-Xc*c)/Gs,u=Math.sqrt(l*l+c*c)/(_s*o*(1-o)),d=u?Math.atan2(l,c)*w5-120:NaN;return new qc(d<0?d+360:d,u,o,t.opacity)}function $s(t,e,n,r){return arguments.length===1?$v(t):new qc(t,e,n,r==null?1:r)}function qc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Op(qc,$s,Zv(tu,{brighter:function(e){return e=e==null?eu:Math.pow(eu,e),new qc(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Vc:Math.pow(Vc,e),new qc(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*S5,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),o=Math.cos(e),c=Math.sin(e);return new ho(255*(n+r*(q2*o+Vv*c)),255*(n+r*(Xc*o+Gs*c)),255*(n+r*(_s*o)),this.opacity)}}));var Q2=Math.PI/180,O5=180/Math.PI,E5=-.14861,ru=1.78277,Kc=-.29227,zf=-.90649,Uf=1.97294,J2=Uf*zf,Yv=Uf*ru,A5=ru*Kc-zf*E5;function T5(t){if(t instanceof Ys)return new Ys(t.h,t.s,t.l,t.opacity);t instanceof Ao||(t=YM(t));var e=t.r/255,n=t.g/255,r=t.b/255,o=(A5*r+J2*e-Yv*n)/(A5+J2-Yv),c=r-o,l=(Uf*(n-o)-Kc*c)/zf,u=Math.sqrt(l*l+c*c)/(Uf*o*(1-o)),d=u?Math.atan2(l,c)*O5-120:NaN;return new Ys(d<0?d+360:d,u,o,t.opacity)}function iu(t,e,n,r){return arguments.length===1?T5(t):new Ys(t,e,n,r==null?1:r)}function Ys(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Rv(Ys,iu,i2(Cf,{brighter:function(e){return e=e==null?Pf:Math.pow(Pf,e),new Ys(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Kl:Math.pow(Kl,e),new Ys(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Q2,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),o=Math.cos(e),c=Math.sin(e);return new Ao(255*(n+r*(E5*o+ru*c)),255*(n+r*(Kc*o+zf*c)),255*(n+r*(Uf*o)),this.opacity)}}));function t3(t){return function e(n){n=+n;function r(o,c){var l=t((o=iu(o)).h,(c=iu(c)).h),u=Wc(o.s,c.s),d=Wc(o.l,c.l),h=Wc(o.opacity,c.opacity);return function(g){return o.h=l(g),o.s=u(g),o.l=d(Math.pow(g,n)),o.opacity=h(g),o+""}}return r.gamma=e,r}(1)}var HI=t3(FI),Mp=t3(Wc),WI=Mp($s(300,.5,0),$s(-240,.5,1)),e3=Mp($s(-100,.75,.35),$s(80,1.5,.8)),Xv=Mp($s(260,.75,.35),$s(80,1.5,.8)),Cp=$s();function M5(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Cp.h=360*t-100,Cp.s=1.5-1.5*e,Cp.l=.8-.9*e,Cp+""}var Pp=W2(),C5=Math.PI/3,P5=Math.PI*2/3;function L5(t){var e;return t=(.5-t)*Math.PI,Pp.r=255*(e=Math.sin(t))*e,Pp.g=255*(e=Math.sin(t+C5))*e,Pp.b=255*(e=Math.sin(t+P5))*e,Pp+""}function I5(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function Lp(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var R5=Lp(sr("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),k5=Lp(sr("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),n3=Lp(sr("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),D5=Lp(sr("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function N5(t,e,n,r,o,c){const{guide:l={}}=n,u=H5(t,e,n);if(typeof u!="string")return n;const d=W5(u,t,e,n),h=ou(u,d,n);return Object.assign(Object.assign(Object.assign({},n),G5(u,t,e,n,r)),{domain:h,range:V5(u,t,e,n,h,o,c),expectedDomain:d,guide:l,name:t,type:u})}function F5(t,e){const n={};for(const r of t){const{values:o,name:c}=r,l=e[c];for(const u of o){const{name:d,value:h}=u;n[d]=h.map(g=>l.map(g))}}return n}function B5(t,e){const n=Array.from(t.values()).flatMap(o=>o.channels);Y0(n,o=>o.map(c=>e.get(c.scale.uid)),o=>o.name).filter(([,o])=>o.some(c=>typeof c.getOptions().groupTransform=="function")&&o.every(c=>c.getTicks)).map(o=>o[1]).forEach(o=>{const c=o.map(l=>l.getOptions().groupTransform)[0];c(o)})}function j5(t,e){var n;const{components:r=[]}=e,o=["scale","encode","axis","legend","data","transform"],c=Array.from(new Set(t.flatMap(u=>u.channels.map(d=>d.scale)))),l=new Map(c.map(u=>[u.name,u]));for(const u of r){const d=z5(u);for(const h of d){const g=l.get(h),v=((n=u.scale)===null||n===void 0?void 0:n[h])||{},{independent:m=!1}=v;if(g&&!m){const{guide:_}=g,b=typeof _=="boolean"?{}:_;g.guide=nn({},b,u),Object.assign(g,v)}else{const _=Object.assign(Object.assign({},v),{expectedDomain:v.domain,name:h,guide:Xg(u,o)});c.push(_)}}}return c}function r3(t){if(!t||!Array.isArray(t))return[Cs,Cs];let e,n;return[c=>{var l;e=c.map.bind(c),n=(l=c.invert)===null||l===void 0?void 0:l.bind(c);const u=t.filter(([m])=>typeof m=="function"),d=t.filter(([m])=>typeof m!="function"),h=new Map(d);if(c.map=m=>{for(const[_,b]of u)if(_(m))return b;return h.has(m)?h.get(m):e(m)},!n)return c;const g=new Map(d.map(([m,_])=>[_,m])),v=new Map(u.map(([m,_])=>[_,m]));return c.invert=m=>v.has(m)?m:g.has(m)?g.get(m):n(m),c},c=>(e!==null&&(c.map=e),n!==null&&(c.invert=n),c)]}function qv(t,e){const n=Object.keys(t);for(const r of Object.values(e)){const{name:o}=r.getOptions();if(!(o in t))t[o]=r;else{const c=n.filter(d=>d.startsWith(o)).map(d=>+(d.replace(o,"")||0)),l=Rr(c)+1,u=`${o}${l}`;t[u]=r,r.getOptions().key=u}}return t}function i3(t,e){const[n]=ui("scale",e),{relations:r}=t,[o]=r3(r),c=n(t);return o(c)}function Xs(t){const e=t.flatMap(n=>Array.from(n.values())).flatMap(n=>n.channels.map(r=>r.scale));o3(e,"x"),o3(e,"y")}function z5(t){const{channels:e=[],type:n,scale:r={}}=t,o=["shape","color","opacity","size"];return e.length!==0?e:n==="axisX"?["x"]:n==="axisY"?["y"]:n==="legends"?Object.keys(r).filter(c=>o.includes(c)):[]}function o3(t,e){const n=t.filter(({name:c,facet:l=!0})=>l&&c===e),r=n.flatMap(c=>c.domain),o=n.every(a3)?ds(r):n.every(s3)?Array.from(new Set(r)):null;if(o!==null)for(const c of n)c.domain=o}function ou(t,e,n){const{ratio:r}=n;return r==null?e:a3({type:t})?U5(e,r,t):s3({type:t})?Z5(e,r):e}function U5(t,e,n){const r=t.map(Number),o=new ga({domain:r,range:[r[0],r[0]+(r[r.length-1]-r[0])*e]});return n==="time"?t.map(c=>new Date(o.map(c))):t.map(c=>o.map(c))}function Z5(t,e){const n=Math.round(t.length*e);return t.slice(0,n)}function a3(t){const{type:e}=t;return typeof e!="string"?!1:["linear","log","pow","time"].includes(e)}function s3(t){const{type:e}=t;return typeof e!="string"?!1:["band","point","ordinal"].includes(e)}function H5(t,e,n){const{type:r,domain:o,range:c,quantitative:l,ordinal:u}=n;return r!==void 0?r:J5(e)?"identity":typeof c=="string"?"linear":(o||c||[]).length>2?Ip(t,u):o!==void 0?h3([o])?Ip(t,u):Zf(e)?"time":no(t,c,l):h3(e)?Ip(t,u):Zf(e)?"time":no(t,c,l)}function W5(t,e,n,r){const{domain:o}=r;if(o!==void 0)return o;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return l3(K5(n,r),r);case"band":case"ordinal":case"point":return u3(n);case"quantile":return au(n);case"sequential":return l3(Q5(n),r);default:return[]}}function V5(t,e,n,r,o,c,l){const{range:u}=r;if(typeof u=="string")return $5(u);if(u!==void 0)return u;const{rangeMin:d,rangeMax:h}=r;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":{const g=Kv(n,r,o,c,l),[v,m]=f3(e,g);return[d!=null?d:v,h!=null?h:m]}case"band":case"point":{const g=e==="size"?5:0,v=e==="size"?10:1;return[d!=null?d:g,h!=null?h:v]}case"ordinal":return Kv(n,r,o,c,l);case"sequential":return;case"constant":return[n[0][0]];default:return[]}}function G5(t,e,n,r,o){switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":return q5(o,r);case"band":case"point":return Qv(t,e,o,r);case"sequential":return X5(r);default:return r}}function Kv(t,e,n,r,o){const[c]=ui("palette",o),{category10:l,category20:u}=r,d=XE(n).length<=l.length?l:u,{palette:h=d,offset:g}=e;if(Array.isArray(h))return h;try{return c({type:h})}catch(v){const m=Y5(h,n,g);if(m)return m;throw new Error(`Unknown Component: ${h} `)}}function $5(t){return t.split("-")}function Y5(t,e,n=r=>r){if(!t)return null;const r=Ls(t),o=Z[`scheme${r}`],c=Z[`interpolate${r}`];if(!o&&!c)return null;if(o){if(!o.some(Array.isArray))return o;const l=o[e.length];if(l)return l}return e.map((l,u)=>c(n(u/e.length)))}function X5(t){const{palette:e="ylGnBu",offset:n}=t,r=Ls(e),o=Z[`interpolate${r}`];if(!o)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?c=>o(n(c)):o}}function q5(t,e){const{interpolate:n=Rl,nice:r=!1,tickCount:o=5}=e;return Object.assign(Object.assign({},e),{interpolate:n,nice:r,tickCount:o})}function Qv(t,e,n,r){if(r.padding!==void 0||r.paddingInner!==void 0||r.paddingOuter!==void 0)return Object.assign(Object.assign({},r),{unknown:NaN});const o=c3(t,e,n),{paddingInner:c=o,paddingOuter:l=o}=r;return Object.assign(Object.assign({},r),{paddingInner:c,paddingOuter:l,padding:o,unknown:NaN})}function c3(t,e,n){return e==="enterDelay"||e==="enterDuration"||e==="size"?0:t==="band"?Iv(n)?0:.1:t==="point"?.5:0}function Ip(t,e){return e||(p3(t)?"point":"ordinal")}function no(t,e,n){return n||(t!=="color"||e?"linear":"sequential")}function l3(t,e){if(t.length===0)return t;const{domainMin:n,domainMax:r}=e,[o,c]=t;return[n!=null?n:o,r!=null?r:c]}function K5(t,e){const{zero:n=!1}=e;let r=1/0,o=-1/0;for(const c of t)for(const l of c)Ur(l)&&(r=Math.min(r,+l),o=Math.max(o,+l));return r===1/0?[]:n?[Math.min(0,r),o]:[r,o]}function u3(t){return Array.from(new Set(t.flat()))}function au(t){return t.flat().sort()}function Q5(t){let e=1/0,n=-1/0;for(const r of t)for(const o of r)Ur(o)&&(e=Math.min(e,+o),n=Math.max(n,+o));return e===1/0?[]:[e<0?-n:e,n]}function f3(t,e){return t==="enterDelay"?[0,1e3]:t=="enterDuration"?[300,1e3]:t.startsWith("y")||t.startsWith("position")?[1,0]:t==="color"?[YE(e),cg(e)]:t==="opacity"?[0,1]:t==="size"?[1,10]:[0,1]}function h3(t){return Qc(t,e=>{const n=typeof e;return n==="string"||n==="boolean"})}function Zf(t){return Qc(t,e=>e instanceof Date)}function J5(t){return Qc(t,ml)}function Qc(t,e){for(const n of t)if(n.some(e))return!0;return!1}function p3(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t.startsWith("size")}function g3(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t==="enterDelay"||t==="enterDuration"||t==="updateDelay"||t==="updateDuration"||t==="exitDelay"||t==="exitDuration"}function v3(t){if(!t||!t.type)return!1;if(typeof t.type=="function")return!0;const{type:e,domain:n,range:r,interpolator:o}=t,c=n&&n.length>0,l=r&&r.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(e)&&c&&l||["sequential"].includes(e)&&c&&(l||o)||["constant","identity"].includes(e)&&l)}const si={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},tC={threshold:"threshold",quantize:"quantize",quantile:"quantile"},m3={ordinal:"ordinal",band:"band",point:"point"},VI={constant:"constant"};var Jc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function y3(t,e,n){const{coordinates:r=[],title:o}=e,[,c]=ui("component",n),l=t.filter(({guide:g})=>g!==null),u=[],d=eC(e,t,n);if(u.push(...d),o){const{props:g}=c("title"),{defaultPosition:v,defaultOrientation:m,defaultOrder:_,defaultSize:b,defaultCrossPadding:S}=g,w=typeof o=="string"?{title:o}:o;u.push(Object.assign({type:"title",position:v,orientation:m,order:_,crossPadding:S[0],defaultSize:b},w))}return Rp(l,r).forEach(([g,v])=>{const{props:m}=c(g),{defaultPosition:_,defaultPlane:b="xy",defaultOrientation:S,defaultSize:w,defaultOrder:E,defaultLength:T,defaultPadding:M=[0,0],defaultCrossPadding:P=[0,0]}=m,R=nn({},...v),{guide:k,field:F}=R,W=Array.isArray(k)?k:[k];for(const $ of W){const[rt,et]=_3(g,_,S,$,v,l,r);if(!rt&&!et)continue;const ut=rt==="left"||rt==="right",J=ut?M[1]:M[0],lt=ut?P[1]:P[0],{size:vt,order:xt=E,length:Ht=T,padding:gt=J,crossPadding:wt=lt}=$;u.push(Object.assign(Object.assign({title:F},$),{defaultSize:w,length:Ht,position:rt,plane:b,orientation:et,padding:gt,order:xt,crossPadding:wt,size:vt,type:g,scales:v}))}}),u}function Jv(t,e,n,r,o){const[c]=ui("component",r),{scaleInstances:l,scale:u,bbox:d}=t,h=Jc(t,["scaleInstances","scale","bbox"]),g={bbox:d,library:r};return c(h)({coordinate:e,library:r,markState:o,scales:l,theme:n,value:g,scale:u})}function GI(t){return t.map(e=>{const n=nn(e,e.style);return delete n.style,n})}function dr(t){return t.flatMap(e=>e.type=="group"?e.children:e)}function tm(t,e){const n=["left","right","bottom","top"];return Wu(t,({type:c,position:l,group:u})=>n.includes(l)?u===void 0?c.startsWith("legend")?`legend-${l}`:Symbol("independent"):u==="independent"?Symbol("independent"):u:Symbol("independent")).flatMap(([,c])=>{if(c.length===1)return c[0];if(e!==void 0){const g=c.filter(S=>S.length!==void 0).map(S=>S.length),v=Qo(g);if(v>e)return c.forEach(S=>S.group=Symbol("independent")),c;const m=e-v,_=c.length-g.length,b=m/_;c.forEach(S=>{S.length===void 0&&(S.length=b)})}const l=Rr(c,g=>g.size),u=Rr(c,g=>g.order),d=Rr(c,g=>g.crossPadding),h=c[0].position;return{type:"group",size:l,order:u,position:h,children:c,crossPadding:d}})}function $I(t,e){const n=["shape","size","color","opacity"],r=(m,_)=>m==="constant"&&_==="size",o=t.filter(({type:m,name:_})=>typeof m=="string"&&n.includes(_)&&!r(m,_)),c=o.filter(({type:m})=>m==="constant"),l=o.filter(({type:m})=>m!=="constant"),d=Wu(l,m=>m.field?m.field:Symbol("independent")).map(([m,_])=>[m,[..._,...c]]).filter(([,m])=>m.some(_=>_.type!=="constant")),h=new Map(d);if(h.size===0)return[];const g=m=>m.sort(([_],[b])=>_.localeCompare(b));return Array.from(h).map(([,m])=>{const b=S_(m).sort((S,w)=>w.length-S.length).map(S=>({combination:S,option:S.map(w=>[w.name,aa(w)])}));for(const{option:S,combination:w}of b)if(!S.every(E=>E[1]==="constant")&&S.every(E=>E[1]==="discrete"||E[1]==="constant"))return["legendCategory",w];for(const[S,w]of qE)for(const{option:E,combination:T}of b)if(w.some(M=>dg(g(M),g(E))))return[S,T];return null}).filter(Ur)}function aa(t){const{type:e}=t;return typeof e!="string"?null:e in si?"continuous":e in m3?"discrete":e in tC?"distribution":e in VI?"constant":null}function Hf(t,e){return t.map(n=>{const{name:r}=n;if(Lv(e)||Iv(e)||ql(e)&&(fo(e)||_p(e)))return null;if(r.startsWith("x"))return fo(e)?["axisArc",[n]]:_p(e)?["axisLinear",[n]]:[ql(e)?"axisY":"axisX",[n]];if(r.startsWith("y"))return fo(e)?["axisLinear",[n]]:_p(e)?["axisArc",[n]]:[ql(e)?"axisX":"axisY",[n]];if(r.startsWith("z"))return["axisZ",[n]];if(r.startsWith("position")){if(Tf(e))return["axisRadar",[n]];if(!fo(e))return["axisY",[n]]}return null}).filter(Ur)}function Rp(t,e){const n=t.filter(r=>v3(r));return[...$I(n,e),...Hf(n,e)]}function kp(t){const e=Zo(t,"polar");if(e.length){const r=e[e.length-1],{startAngle:o,endAngle:c}=hg(r);return[o,c]}const n=Zo(t,"radial");if(n.length){const r=n[n.length-1],{startAngle:o,endAngle:c}=E_(r);return[o,c]}return[-Math.PI/2,Math.PI/2*3]}function Wf(t){const e=/position(\d*)/g.exec(t);return e?+e[1]:null}function Dp(t,e,n,r,o){const{name:c}=n[0];if(t==="axisRadar"){const l=r.filter(m=>m.name.startsWith("position")),u=Wf(c);if(u===null)return[null,null];const[d,h]=kp(o),g=Tf(o)?l.length:l.length-1;return["center",(h-d)/g*u+d]}if(t==="axisY"&&PI(o))return ql(o)?["center","horizontal"]:["center","vertical"];if(t==="axisLinear"){const[l]=kp(o);return["center",l]}return t==="axisArc"?e[0]==="inner"?["inner",null]:["outer",null]:fo(o)?["center",null]:_p(o)?["center",null]:t==="axisX"&&DM(o)||t==="axisX"&&Mf(o)?["top",null]:e}function _3(t,e,n,r,o,c,l){const[u]=kp(l),d=[r.position||e,u!=null?u:n];return typeof t=="string"&&t.startsWith("axis")?Dp(t,d,o,c,l):typeof t=="string"&&t.startsWith("legend")&&fo(l)&&r.position==="center"?["center","vertical"]:d}function YI(t,e,n=[]){return t==="x"?ql(n)?`${e}Y`:`${e}X`:t==="y"?ql(n)?`${e}X`:`${e}Y`:null}function eC(t,e,n){const[,r]=ui("component",n),{coordinates:o}=t;function c(l,u,d,h){const g=YI(u,l,o);if(!h||!g)return;const{props:v}=r(g),{defaultPosition:m,defaultSize:_,defaultOrder:b,defaultCrossPadding:[S]}=v;return Object.assign(Object.assign({position:m,defaultSize:_,order:b,type:g,crossPadding:S},h),{scales:[d]})}return e.filter(l=>l.slider||l.scrollbar).flatMap(l=>{const{slider:u,scrollbar:d,name:h}=l;return[c("slider",h,l,u),c("scrollbar",h,l,d)]}).filter(l=>!!l)}function su(t,e,n,r,o,c){const{type:l}=t;if(!["left","right","bottom","top"].includes(r)||typeof l!="string")return;const d=l;return(d.startsWith("axis")?x3:d.startsWith("group")?Vf:d.startsWith("legendContinuous")?S3:d==="legendCategory"?w3:d.startsWith("slider")?b3:d==="title"?em:d.startsWith("scrollbar")?Gf:()=>{})(t,e,n,r,o,c)}function Vf(t,e,n,r,o,c){const{children:l}=t,u=Rr(l,h=>h.crossPadding);l.forEach(h=>h.crossPadding=u),l.forEach(h=>su(h,e,n,r,o,c));const d=Rr(l,h=>h.size);t.size=d,l.forEach(h=>h.size=d)}function Gf(t,e,n,r,o,c){const{trackSize:l=6}=nn({},o.scrollbar,t);t.size=l}function em(t,e,n,r,o,c){const l=nn({},o.title,t),{title:u,subtitle:d,spacing:h=0}=l,g=Jc(l,["title","subtitle","spacing"]);if(u){const v=wn(g,"title"),m=$f(u,v);t.size=m.height}if(d){const v=wn(g,"subtitle"),m=$f(d,v);t.size+=h+m.height}}function b3(t,e,n,r,o,c){const l=()=>{const{slider:g}=o;return nn({},g,t)},{trackSize:u,handleIconSize:d}=l(),h=Math.max(u,d*2.4);t.size=h}function x3(t,e,n,r,o,c){var l,u;t.transform=t.transform||[{type:"hide"}];const d=r==="left"||r==="right",h=nC(t,r,o),{tickLength:g=0,labelSpacing:v=0,titleSpacing:m=0,labelAutoRotate:_}=h,b=Jc(h,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),S=cu(t,c),w=Tr(b,S);let E=g;if(typeof t.tickLength=="function"){const R=(((l=S.getTicks)===null||l===void 0?void 0:l.call(S))||S.getOptions().domain).map((k,F,W)=>t.tickLength(k,F,W));E=Math.max(...R,0)}const T=E+v;if(w&&w.length){const P=Rr(w,k=>k.width),R=Rr(w,k=>k.height);if(d)t.size=P+T;else{const{tickFilter:k,labelTransform:F}=t;tl(S,w,e,n,k)&&!F&&_!==!1&&_!==null?(t.labelTransform="rotate(90)",t.size=P+T):(t.labelTransform=(u=t.labelTransform)!==null&&u!==void 0?u:"rotate(0)",t.size=R+T)}}else t.size=E;const M=nm(b);M&&(d?t.size+=m+M.width:t.size+=m+M.height)}function S3(t,e,n,r,o,c){const u=(()=>{const{legendContinuous:P}=o;return nn({},P,t)})(),{labelSpacing:d=0,titleSpacing:h=0}=u,g=Jc(u,["labelSpacing","titleSpacing"]),v=r==="left"||r==="right",m=wn(g,"ribbon"),{size:_}=m,b=wn(g,"handleIcon"),{size:S}=b,w=Math.max(_,S*2.4);t.size=w;const E=cu(t,c),T=Tr(g,E);if(T){const P=v?"width":"height",R=Rr(T,k=>k[P]);t.size+=R+d}const M=nm(g);M&&(v?t.size=Math.max(t.size,M.width):t.size+=h+M.height)}function w3(t,e,n,r,o,c){const u=(()=>{const{legendCategory:gt}=o,{title:wt}=t,[Wt,fe]=Array.isArray(wt)?[wt,void 0]:[void 0,wt];return nn({title:Wt},gt,Object.assign(Object.assign({},t),{title:fe}))})(),{focus:d,itemSpacing:h,focusMarkerSize:g,itemMarkerSize:v,titleSpacing:m,rowPadding:_,colPadding:b,maxCols:S=1/0,maxRows:w=1/0}=u,E=Jc(u,["focus","itemSpacing","focusMarkerSize","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:T,length:M}=t,P=gt=>Math.min(gt,w),R=gt=>Math.min(gt,S),k=r==="left"||r==="right",F=M===void 0?e+(k?0:n[0]+n[1]):M,W=cu(t,c),{render:$}=t;if($&&typeof document!="undefined"){const gt=W.getOptions().domain,{labelFormatter:wt}=E,Wt=We=>wt?typeof wt=="string"?ss(wt)(We):wt(We):`${We}`,fe=gt.map((We,fn)=>({id:We,index:fn,label:Wt(We),value:We,color:W.map(We)})),le=$(fe,E),Te=document.createElement("div"),{width:Fe,height:De}=t,Je={position:"absolute",visibility:"hidden",top:"-9999px"};Fe?Je.width=`${Fe}px`:k||(Je.width=`${F}px`),De?Je.height=`${De}px`:k&&(Je.height=`${F}px`),Object.assign(Te.style,Je),typeof le=="string"?Te.innerHTML=le:le instanceof HTMLElement&&Te.appendChild(le),document.body.appendChild(Te);const qe=Te.getBoundingClientRect();document.body.removeChild(Te),t.size=k?qe.width:qe.height;return}const rt=nm(E),et=Tr(E,W,"itemLabel"),ut=E.itemValueText!==void 0?Tr(E,W,"itemValue"):null,J=Math.max(et[0].height,v,...ut!=null&&ut[0]?[ut[0].height]:[])+_,lt=(gt,wt=0)=>{let Wt=v+gt+h[0]+wt;return ut!=null&&ut[0]&&(Wt+=ut[0].width+h[1]),d&&(Wt+=g+h[2]),Wt};k?(()=>{let gt=-1/0,wt=0,Wt=1,fe=0,le=-1/0,Te=-1/0;const Fe=rt?rt.height:0,De=F-Fe;for(const{width:Je}of et){const qe=lt(Je,b);gt=Math.max(gt,qe),wt+J>De?(Wt++,le=Math.max(le,fe),Te=Math.max(Te,wt),fe=1,wt=J):(wt+=J,fe++)}Wt<=1&&(le=fe,Te=wt),t.size=gt*R(Wt),t.length=Te+Fe,nn(t,{cols:R(Wt),gridRow:le})})():typeof T=="number"?(()=>{const gt=Math.ceil(et.length/T),wt=Rr(et,Wt=>lt(Wt.width))*T;t.size=J*P(gt)-_,t.length=Math.min(wt,F)})():(()=>{let gt=1,wt=0,Wt=-1/0;for(const{width:fe}of et){const le=lt(fe,b);wt+le>F?(Wt=Math.max(Wt,wt),wt=le,gt++):wt+=le}gt===1&&(Wt=wt),t.size=J*P(gt)-_,t.length=Wt})(),rt&&(k?t.size=Math.max(t.size,rt.width):t.size+=m+rt.height)}function cu(t,e){const[n]=ui("scale",e),{scales:r,tickCount:o,tickMethod:c}=t,l=r.find(u=>u.type!=="constant"&&u.type!=="identity");return o!==void 0&&(l.tickCount=o),c!==void 0&&(l.tickMethod=c),n(l)}function Tr(t,e,n="label"){const{labelFormatter:r,tickFilter:o,label:c=!0}=t,l=Jc(t,["labelFormatter","tickFilter","label"]);if(!c)return null;const u=rC(e,r,o),d=wn(l,n),h=u.map((m,_)=>Object.fromEntries(Object.entries(d).map(([b,S])=>[b,typeof S=="function"?S(m,_):S]))),g=u.map((m,_)=>{const b=h[_];return $f(m,b)});if(!h.some(m=>m.transform)){const m=u.map((_,b)=>b);t.indexBBox=new Map(m.map(_=>[_,[u[_],g[_]]]))}return g}function nm(t){const e=h=>h===!1||h===null,{title:n}=t,r=Jc(t,["title"]);if(e(n)||n===void 0)return null;const o=wn(r,"title"),{direction:c,transform:l}=o,u=Array.isArray(n)?n.join(","):n;return typeof u!="string"?null:$f(u,Object.assign(Object.assign({},o),{transform:l||(c==="vertical"?"rotate(-90)":"")}))}function nC(t,e,n){const{title:r}=t,[o,c]=Array.isArray(r)?[r,void 0]:[void 0,r],{axis:l,[`axis${J0(e)}`]:u}=n;return nn({title:o},l,u,Object.assign(Object.assign({},t),{title:c}))}function rm(t,e){const n=t.getTicks?t.getTicks():t.getOptions().domain;return e?n.filter(e):n}function rC(t,e,n){const o=rm(t,n).map(l=>typeof l=="number"?ah(l):l),c=e?typeof e=="string"?ss(e):e:t.getFormatter?t.getFormatter():l=>`${l}`;return o.map(c)}function Np(t,e){return t.getBandWidth?t.getBandWidth(e)/2:0}function tl(t,e,n,r,o){if(Qo(e,_=>_.width)>n)return!0;const l=t.clone();l.update({range:[0,n]});const u=rm(t,o),d=u.map(_=>l.map(_)+Np(l,_)),h=u.map((_,b)=>b),g=-r[0],v=n+r[1],m=(_,b)=>{const{width:S}=b;return[_-S/2,_+S/2]};for(let _=0;_<h.length;_++){const b=d[_],[S,w]=m(b,e[_]);if(S<g||w>v)return!0;const E=d[_+1];if(E){const[T]=m(E,e[_+1]);if(w>T)return!0}}return!1}function $f(t,e){const n=O3(t),{filter:r}=e,o=Jc(e,["filter"]);return n.attr(Object.assign(Object.assign({},o),{visibility:"none"})),n.getBBox()}function O3(t){return t instanceof N.s$?t:new N.xv({style:{text:`${t}`}})}function Ho(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n>o||n===void 0&&o>=o)&&(n=o)}return n}function im(t){if(bc(t))return t[0]}const iC=16;function oC(t){const e=t.find(({type:o})=>o==="axisX"),n=t.find(({type:o})=>o==="axisY"),r=t.find(({type:o})=>o==="axisZ");e&&n&&r&&(e.plane="xy",n.plane="xy",r.plane="yz",r.origin=[e.bbox.x,e.bbox.y,0],r.eulerAngles=[0,-90,0],r.bbox.x=e.bbox.x,r.bbox.y=e.bbox.y,t.push(Object.assign(Object.assign({},e),{plane:"xz",showLabel:!1,showTitle:!1,origin:[e.bbox.x,e.bbox.y,0],eulerAngles:[-90,0,0]})),t.push(Object.assign(Object.assign({},n),{plane:"yz",showLabel:!1,showTitle:!1,origin:[n.bbox.x+n.bbox.width,n.bbox.y,0],eulerAngles:[0,-90,0]})),t.push(Object.assign(Object.assign({},r),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function XI(t,e,n,r){var o,c,l,u;const{width:d,height:h,depth:g,x:v=0,y:m=0,z:_=0,inset:b=(o=n.inset)!==null&&o!==void 0?o:0,insetLeft:S=b,insetTop:w=b,insetBottom:E=b,insetRight:T=b,margin:M=(c=n.margin)!==null&&c!==void 0?c:0,marginLeft:P=M,marginBottom:R=M,marginTop:k=M,marginRight:F=M,padding:W=n.padding,paddingBottom:$=W,paddingLeft:rt=W,paddingRight:et=W,paddingTop:ut=W}=lu(t,e,n,r),J=P===iC&&rt==="auto",lt=F===iC&&et==="auto",vt=er(e,"coordinates",[]).some(Bn=>Bn.type==="transpose"),xt=t.find(({type:Bn})=>Bn==="axisX"),{size:Ht,labelTransform:gt}=xt||{},wt=1/4,Wt=(Bn,Yn,ti,ei,Ar)=>{const{marks:Bi}=e;if(Bi.length===0)return[ei,Ar];if(Bn-ei-Ar-Bn*wt>0)return[ei,Ar];const ci=Bn*(1-wt);return[Yn==="auto"?ci*ei/(ei+Ar):ei,ti==="auto"?ci*Ar/(ei+Ar):Ar]},fe=Bn=>Bn==="auto"?20:Bn!=null?Bn:20,le=fe(ut),Te=fe($),Fe=A3(t,h-le-Te,[le+k,Te+R],["left","right"],e,n,r),{paddingLeft:De,paddingRight:Je}=Fe,qe=d-P-F;let[We,fn]=Wt(qe,rt,et,De,Je),_n=qe-We-fn;const An=A3(t,_n,[We+P,fn+F],["bottom","top"],e,n,r),{paddingTop:xn,paddingBottom:On}=An,Fn=h-R-k,[Hn,qn]=Wt(Fn,$,ut,On,xn),Rn=Fn-Hn-qn;if(Ht&&!vt&&!gt){const{fontSize:Bn=12,fontFamily:Yn="sans-serif",scales:ti=[]}=xt,ei=(u=(l=ti==null?void 0:ti[0])===null||l===void 0?void 0:l.domain)!==null&&u!==void 0?u:[];if(!ei.length)return;const Ar=(Bi,Si,Zi,ci)=>{const gi=$_(Si,{fontSize:Bn,fontFamily:Yn}),Ei=gi/2-Zi-ci;Ei>0&&(_n-=Ei,Bi==="left"?We+=gi/2-Zi:fn+=gi/2-Zi)};J&&Ar("left",im(ei),P,We),lt&&Ar("right",Jo(ei),F,fn)}return{width:d,height:h,depth:g,insetLeft:S,insetTop:w,insetBottom:E,insetRight:T,innerWidth:_n,innerHeight:Rn,paddingLeft:We,paddingRight:fn,paddingTop:qn,paddingBottom:Hn,marginLeft:P,marginBottom:R,marginTop:k,marginRight:F,x:v,y:m,z:_}}function E3(t){const{height:e,width:n,padding:r=0,paddingLeft:o=r,paddingRight:c=r,paddingTop:l=r,paddingBottom:u=r,margin:d=16,marginLeft:h=d,marginRight:g=d,marginTop:v=d,marginBottom:m=d,inset:_=0,insetLeft:b=_,insetRight:S=_,insetTop:w=_,insetBottom:E=_}=t,T=R=>R==="auto"?20:R,M=n-T(o)-T(c)-h-g-b-S,P=e-T(l)-T(u)-v-m-w-E;return{width:M,height:P}}function lu(t,e,n,r){const{coordinates:o}=e;if(!fo(o)&&!_p(o))return e;const c=t.filter(E=>typeof E.type=="string"&&E.type.startsWith("axis"));if(c.length===0)return e;const l=c.map(E=>{const T=E.type==="axisArc"?"arc":"linear";return nC(E,T,n)}),u=Rr(l,E=>{var T;return(T=E.labelSpacing)!==null&&T!==void 0?T:0}),d=c.flatMap((E,T)=>{const M=l[T],P=cu(E,r);return Tr(M,P)}).filter(Ur),h=Rr(d,E=>E.height)+u,g=c.flatMap((E,T)=>{const M=l[T];return nm(M)}).filter(E=>E!==null),v=g.length===0?0:Rr(g,E=>E.height),{inset:m=h,insetLeft:_=m,insetBottom:b=m,insetTop:S=m+v,insetRight:w=m}=e;return Object.assign(Object.assign({},e),{insetLeft:_,insetBottom:b,insetTop:S,insetRight:w})}function A3(t,e,n,r,o,c,l){const u=$r(t,b=>b.position),{padding:d=c.padding,paddingLeft:h=d,paddingRight:g=d,paddingBottom:v=d,paddingTop:m=d}=o,_={paddingBottom:v,paddingLeft:h,paddingTop:m,paddingRight:g};for(const b of r){const S=`padding${J0(lv(b))}`,w=u.get(b)||[],E=_[S],T=$=>{$.size===void 0&&($.size=$.defaultSize)},M=$=>{$.type==="group"?($.children.forEach(T),$.size=Rr($.children,rt=>rt.size)):$.size=$.defaultSize},P=$=>{$.size||(E!=="auto"?M($):(su($,e,n,b,c,l),T($)))},R=$=>{$.type.startsWith("axis")&&$.labelAutoHide===void 0&&($.labelAutoHide=!0)},k=b==="bottom"||b==="top",F=Ho(w,$=>$.order),W=w.filter($=>$.type.startsWith("axis")&&$.order==F);if(W.length&&(W[0].crossPadding=0),typeof E=="number")w.forEach(T),w.forEach(R);else if(w.length===0)_[S]=0;else{const $=k?e+n[0]+n[1]:e,rt=tm(w,$);rt.forEach(P);const et=rt.reduce((ut,{size:J,crossPadding:lt=12})=>ut+J+lt,0);_[S]=et}}return _}function aC(t,e,n){const r=$r(t,k=>`${k.plane||"xy"}-${k.position}`),{paddingLeft:o,paddingRight:c,paddingTop:l,paddingBottom:u,marginLeft:d,marginTop:h,marginBottom:g,marginRight:v,innerHeight:m,innerWidth:_,insetBottom:b,insetLeft:S,insetRight:w,insetTop:E,height:T,width:M,depth:P}=n,R={xy:el({width:M,height:T,paddingLeft:o,paddingRight:c,paddingTop:l,paddingBottom:u,marginLeft:d,marginTop:h,marginBottom:g,marginRight:v,innerHeight:m,innerWidth:_,insetBottom:b,insetLeft:S,insetRight:w,insetTop:E}),yz:el({width:P,height:T,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:P,innerHeight:T,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:el({width:M,height:P,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:M,innerHeight:P,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[k,F]of r.entries()){const[W,$]=k.split("-"),rt=R[W][$],[et,ut]=lg(F,J=>typeof J.type!="string"?!1:!!($==="center"||J.type.startsWith("axis")&&["inner","outer"].includes($)));et.length&&sC(et,e,rt,$),ut.length&&uC(F,e,rt)}}function el({width:t,height:e,paddingLeft:n,paddingRight:r,paddingTop:o,paddingBottom:c,marginLeft:l,marginTop:u,marginBottom:d,marginRight:h,innerHeight:g,innerWidth:v,insetBottom:m,insetLeft:_,insetRight:b,insetTop:S}){const w=n+l,E=o+u,T=r+h,M=c+d,P=t-l-h,R=[w+_,E+S,v-_-b,g-S-m,"center",null,null];return{top:[w,0,v,E,"vertical",!0,xi,l,P],right:[t-T,E,T,g,"horizontal",!1,xi],bottom:[w,e-M,v,M,"vertical",!1,xi,l,P],left:[0,E,w,g,"horizontal",!0,xi],"top-left":[w,0,v,E,"vertical",!0,xi],"top-right":[w,0,v,E,"vertical",!0,xi],"bottom-left":[w,e-M,v,M,"vertical",!1,xi],"bottom-right":[w,e-M,v,M,"vertical",!1,xi],center:R,inner:R,outer:R}}function sC(t,e,n,r){const[o,c]=lg(t,l=>!!(typeof l.type=="string"&&l.type.startsWith("axis")));cC(o,e,n,r),JI(c,e,n)}function cC(t,e,n,r){r==="center"?M_(e)?QI(t,e,n,r):kr(e)?Fp(t,e,n):xl(e)&&om(t,e,n,t[0].orientation):r==="inner"?T3(t,e,n):r==="outer"&&qI(t,e,n)}function T3(t,e,n){const[r,o,,c]=n,[l,u]=e.getCenter(),[d]=sh(e),h=c/2,g=d*h,v=l-g,m=u-g;for(let _=0;_<t.length;_++){const b=t[_];b.bbox={x:r+v,y:o+m,width:g*2,height:g*2}}}function qI(t,e,n){const[r,o,c,l]=n;for(const u of t)u.bbox={x:r,y:o,width:c,height:l}}function Fp(t,e,n){const[r,o,c,l]=n;for(const u of t)u.bbox={x:r,y:o,width:c,height:l}}function om(t,e,n,r){r==="horizontal"?lC(t,e,n):r==="vertical"&&KI(t,e,n)}function KI(t,e,n){const[r,o,,c]=n,l=new Array(t.length).fill(0),d=e.map(l).filter((h,g)=>g%2===0).map(h=>h+r);for(let h=0;h<t.length;h++){const g=t[h],v=d[h],m=d[h+1]-v;g.bbox={x:v,y:o,width:m,height:c}}}function lC(t,e,n){const[r,o,c]=n,l=new Array(t.length).fill(0),d=e.map(l).filter((h,g)=>g%2===1).map(h=>h+o);for(let h=0;h<t.length;h++){const g=t[h],v=d[h],m=d[h+1]-v;g.bbox={x:r,y:v,width:c,height:m}}}function QI(t,e,n,r){const[o,c,l,u]=n;for(const d of t)d.bbox={x:o,y:c,width:l,height:u},d.radar={index:t.indexOf(d),count:t.length}}function uC(t,e,n){const[r,o,c,l,u,d,h,g,v]=n,[m,_,b,S,w,E,T,M]=u==="vertical"?["y",o,"x",r,"height",l,"width",c]:["x",r,"y",o,"width",c,"height",l];t.sort(($,rt)=>h==null?void 0:h($.order,rt.order));const P=$=>$==="title"||$==="group"||$.startsWith("legend"),R=($,rt,et)=>et===void 0?rt:P($)?et:rt,k=($,rt,et)=>et===void 0?rt:P($)?et:rt,F=d?_+E:_;for(let $=0,rt=F;$<t.length;$++){const et=t[$],{crossPadding:ut=0,type:J}=et,{size:lt}=et;et.bbox={[m]:d?rt-lt-ut:rt+ut,[b]:k(J,S,g),[w]:lt,[T]:R(J,M,v)},rt+=(lt+ut)*(d?-1:1)}const W=t.filter($=>$.type==="group");for(const $ of W){const{bbox:rt,children:et}=$,ut=rt[T],J=ut/et.length,lt=et.reduce((wt,Wt)=>{var fe;const le=(fe=Wt.layout)===null||fe===void 0?void 0:fe.justifyContent;return le||wt},"flex-start"),vt=et.map((wt,Wt)=>{const{length:fe=J,padding:le=0}=wt;return fe+(Wt===et.length-1?0:le)}),xt=Qo(vt),Ht=ut-xt,gt=lt==="flex-start"?0:lt==="center"?Ht/2:Ht;for(let wt=0,Wt=rt[b]+gt;wt<et.length;wt++){const fe=et[wt],{padding:le=0}=fe,Te=wt===et.length-1?0:le;fe.bbox={[w]:rt[w],[m]:rt[m],[b]:Wt,[T]:vt[wt]-Te},nn(fe,{layout:{justifyContent:lt}}),Wt+=vt[wt]}}}function JI(t,e,n){if(t.length===0)return;const[r,o,c,l]=n,[u]=sh(e),d=l/2*u/Math.sqrt(2),h=r+c/2,g=o+l/2;for(let v=0;v<t.length;v++){const m=t[v];m.bbox={x:h-d,y:g-d,width:d*2,height:d*2}}}function Wa(t,e,n={},r=!1){if(Ca(t)||Array.isArray(t)&&r)return t;const o=wn(t,e);return nn(n,o)}function nl(t,e={}){return Ca(t)||Array.isArray(t)||!fC(t)?t:nn(e,t)}function fC(t){if(Object.keys(t).length===0)return!0;const{title:e,items:n}=t;return e!==void 0||n!==void 0}function bs(t,e){return typeof t=="object"?wn(t,e):t}var dC=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},uu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const am=Symbol("CALLBACK_ITEM");function hC(t,e,n){const{encode:r={},scale:o={},transform:c=[]}=e,l=uu(e,["encode","scale","transform"]);return[t,Object.assign(Object.assign({},l),{encode:r,scale:o,transform:c})]}function M3(t,e,n){return dC(this,void 0,void 0,function*(){const{library:r}=n,{data:o}=e,[c]=ui("data",r),l=wC(o),{transform:u=[]}=l,g=[uu(l,["transform"]),...u].map(_=>c(_,n)),v=yield gl(g)(o),m=o&&!Array.isArray(o)&&!Array.isArray(v)?{value:v}:v;return[Array.isArray(v)?_c(v):[],Object.assign(Object.assign({},e),{data:m})]})}function pC(t,e,n){const{encode:r}=e;if(!r)return[t,e];const o={};for(const[c,l]of Object.entries(r))if(Array.isArray(l))for(let u=0;u<l.length;u++){const d=`${c}${u===0?"":u}`;o[d]=l[u]}else o[c]=l;return[t,Object.assign(Object.assign({},e),{encode:o})]}function gC(t,e,n){const{encode:r,data:o}=e;if(!r)return[t,e];const c=Pa(r,l=>xC(l)?l:{type:SC(o,l),value:l});return[t,Object.assign(Object.assign({},e),{encode:c})]}function C3(t,e,n){const{encode:r}=e;if(!r)return[t,e];const o=Pa(r,(c,l)=>{const{type:u}=c;return u!=="constant"||g3(l)?c:Object.assign(Object.assign({},c),{constant:!0})});return[t,Object.assign(Object.assign({},e),{encode:o})]}function P3(t,e,n){const{encode:r,data:o}=e;if(!r)return[t,e];const{library:c}=n,l=EC(c),u=Pa(r,d=>l(o,d));return[t,Object.assign(Object.assign({},e),{encode:u})]}function Lo(t,e,n){const{tooltip:r={}}=e;return Ca(r)?[t,e]:Array.isArray(r)?[t,Object.assign(Object.assign({},e),{tooltip:{items:r}})]:ml(r)&&fC(r)?[t,Object.assign(Object.assign({},e),{tooltip:r})]:[t,Object.assign(Object.assign({},e),{tooltip:{items:[r]}})]}function vC(t,e,n){const{data:r,encode:o,tooltip:c={}}=e;if(Ca(c))return[t,e];const l=v=>{if(!v)return v;if(typeof v=="string")return t.map(m=>({name:v,value:r[m][v]}));if(ml(v)){const{field:m,channel:_,color:b,name:S=m,valueFormatter:w=k=>k}=v,E=typeof w=="string"?ss(w):w,T=_&&o[_],M=T&&o[_].field,P=S||M||_,R=[];for(const k of t){const F=m?r[k][m]:T?o[_].value[k]:null;R[k]={name:P,color:b,value:E(F)}}return R}if(typeof v=="function"){const m=[];for(const _ of t){const b=v(r[_],_,r,o);ml(b)?m[_]=Object.assign(Object.assign({},b),{[am]:!0}):m[_]={value:b}}return m}return v},{title:u,items:d=[]}=c,h=uu(c,["title","items"]),g=Object.assign({title:l(u),items:Array.isArray(d)?d.map(l):[]},h);return[t,Object.assign(Object.assign({},e),{tooltip:g})]}function mC(t,e,n){const{encode:r}=e,o=uu(e,["encode"]);if(!r)return[t,e];const c=Object.entries(r),l=c.filter(([,d])=>{const{value:h}=d;return Array.isArray(h[0])}).flatMap(([d,h])=>{const g=[[d,new Array(t.length).fill(void 0)]],{value:v}=h,m=uu(h,["value"]);for(let _=0;_<v.length;_++){const b=v[_];if(Array.isArray(b))for(let S=0;S<b.length;S++){const w=g[S]||[`${d}${S}`,new Array(t).fill(void 0)];w[1][_]=b[S],g[S]=w}}return g.map(([_,b])=>[_,Object.assign({type:"column",value:b},m)])}),u=Object.fromEntries([...c,...l]);return[t,Object.assign(Object.assign({},o),{encode:u})]}function yC(t,e,n){const{axis:r={},legend:o={},slider:c={},scrollbar:l={}}=e,u=(h,g)=>{if(typeof h=="boolean")return h?{}:null;const v=h[g];return v===void 0||v?v:null},d=typeof r=="object"?Array.from(new Set(["x","y","z",...Object.keys(r)])):["x","y","z"];return nn(e,{scale:Object.assign(Object.assign({},Object.fromEntries(d.map(h=>{const g=u(l,h);return[h,Object.assign({guide:u(r,h),slider:u(c,h),scrollbar:g},g&&{ratio:g.ratio===void 0?.5:g.ratio})]}))),{color:{guide:u(o,"color")},size:{guide:u(o,"size")},shape:{guide:u(o,"shape")},opacity:{guide:u(o,"opacity")}})}),[t,e]}function _C(t,e,n){const{animate:r}=e;return r||r===void 0?[t,e]:(nn(e,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[t,e])}function bC(t,e,n){var r,o;return nn(e,{scale:{series:Object.assign({key:`DEFAULT_${e.type}_SERIES_KEY`},(o=(r=e==null?void 0:e.scale)===null||r===void 0?void 0:r.series)!==null&&o!==void 0?o:{})}}),[t,e]}function xC(t){if(typeof t!="object"||t instanceof Date||t===null)return!1;const{type:e}=t;return Ur(e)}function SC(t,e){return typeof e=="function"?"transform":typeof e=="string"&&L3(t,e)?"field":"constant"}function L3(t,e){return Array.isArray(t)?t.some(n=>n[e]!==void 0):!1}function wC(t){if((0,Se.Z)(t))return{type:"inline",value:t};if(!t)return{type:"inline",value:null};if(Array.isArray(t))return{type:"inline",value:t};const{type:e="inline"}=t,n=uu(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}var I3=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},OC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function R3(t,e,n){return I3(this,void 0,void 0,function*(){const[r,o]=yield AC(t,e,n),{encode:c,scale:l,data:u,tooltip:d,key:h}=o;if(Array.isArray(u)===!1)return null;const{channels:g}=e,v=Y0(Object.entries(c).filter(([,_])=>Ur(_)),_=>_.map(([b,S])=>Object.assign({name:b},S)),([_])=>{var b;const S=(b=/([^\d]+)\d*$/.exec(_))===null||b===void 0?void 0:b[1],w=g.find(E=>E.name===S);return w!=null&&w.independent?_:S}),m=g.filter(_=>{const{name:b,required:S}=_;if(v.find(([w])=>w===b))return!0;if(S)throw new Error(`Missing encoding for channel: ${b}.`);return!1}).flatMap(_=>{const{name:b,scale:S,scaleKey:w,range:E,quantitative:T,ordinal:M}=_;return v.filter(([R])=>R.startsWith(b)).map(([R,k],F)=>{const W=k.some(Ht=>Ht.visual),$=k.some(Ht=>Ht.constant),rt=l[R]||{},{independent:et=!1,key:ut=w||R,type:J=$?"constant":W?"identity":S}=rt,lt=OC(rt,["independent","key","type"]),vt=J==="constant",xt=vt?void 0:E;return{name:R,values:k,scaleKey:et||vt?Symbol("independent"):ut,scale:Object.assign(Object.assign({type:J,markKey:h,range:xt},lt),{quantitative:T,ordinal:M})}})});return[o,Object.assign(Object.assign({},e),{index:r,channels:m,tooltip:d})]})}function EC(t){const[e]=ui("encode",t);return(n,r)=>r===void 0||n===void 0?null:Object.assign(Object.assign({},r),{type:"column",value:e(r)(n),field:TC(r)})}function AC(t,e,n){return I3(this,void 0,void 0,function*(){const{library:r}=n,[o]=ui("transform",r),{preInference:c=[],postInference:l=[]}=e,{transform:u=[]}=t,d=[hC,M3,pC,gC,C3,P3,mC,_C,yC,Lo,bC,...c.map(o),...u.map(o),...l.map(o),vC];let h=[],g=t;for(const v of d)[h,g]=yield v(h,g,n);return[h,g]})}function TC(t){const{type:e,value:n}=t;return e==="field"&&typeof n=="string"?n:null}var xs=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},qs=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function sm(t,e,n){return xs(this,void 0,void 0,function*(){var r;const{library:o}=n,[c]=ui("composition",o),[l]=ui("interaction",o),u=new Set(Object.keys(o).map(J=>{var lt;return(lt=/mark\.(.*)/.exec(J))===null||lt===void 0?void 0:lt[1]}).filter(Ur)),d=new Set(Object.keys(o).map(J=>{var lt;return(lt=/component\.(.*)/.exec(J))===null||lt===void 0?void 0:lt[1]}).filter(Ur)),h=J=>{const{type:lt}=J;if(typeof lt=="function"){const{props:vt={}}=lt,{composite:xt=!0}=vt;if(xt)return"mark"}return typeof lt!="string"?lt:u.has(lt)||d.has(lt)?"mark":lt},g=J=>h(J)==="mark",v=J=>h(J)==="standardView",m=J=>{const{type:lt}=J;return typeof lt!="string"?!1:!!d.has(lt)},_=J=>{if(v(J))return[J];const lt=h(J);return c({type:lt,static:m(J)})(J)},b=[],S=new Map,w=new Map,E=[t],T=[];for(;E.length;){const J=E.shift();if(v(J)){const lt=w.get(J),[vt,xt]=lt?F3(lt,J,o):yield Bp(J,n);S.set(vt,J),b.push(vt);const Ht=xt.flatMap(_).map(gt=>yp(gt,o));if(E.push(...Ht),Ht.every(v)){const gt=yield Promise.all(Ht.map(wt=>N3(wt,n)));Xs(gt);for(let wt=0;wt<Ht.length;wt++){const Wt=Ht[wt],fe=gt[wt];w.set(Wt,fe)}}}else{const lt=g(J)?J:yield U3(J,n),vt=_(lt);Array.isArray(vt)?E.push(...vt):typeof vt=="function"&&T.push(vt())}}n.emitter.emit(Ir.BEFORE_PAINT);const M=new Map,P=new Map,R=[];e.selectAll(Wo(Jt)).data(b,J=>J.key).join(J=>J.append("g").attr("className",Jt).attr("id",lt=>lt.key).call(k3).each(function(lt,vt,xt){cm(lt,Kn(xt),R,n),M.set(lt,xt)}),J=>J.call(k3).each(function(lt,vt,xt){cm(lt,Kn(xt),R,n),P.set(lt,xt)}),J=>J.each(function(lt,vt,xt){const Ht=xt.nameInteraction.values();for(const gt of Ht)gt.destroy()}).remove());const k=(J,lt,vt)=>Array.from(J.entries()).map(([xt,Ht])=>{const gt=vt||new Map,wt=(Te,Fe=De=>De)=>gt.set(Te,Fe),Wt=S.get(xt),fe=D3(Kn(Ht),Wt,n),le={view:xt,container:Ht,options:Wt,setState:wt,update:(Te,Fe)=>xs(this,void 0,void 0,function*(){const Je=Gu(Array.from(gt.values()))(Wt);return yield fe(Je,Te,()=>{(0,Br.Z)(Fe)&&lt(J,Fe,gt)})})};return n.externals.update=le.update,n.externals.setState=wt,le}),F=(J=P,lt,vt)=>{var xt;const Ht=k(J,F,vt);for(const gt of Ht){const{options:wt,container:Wt}=gt,fe=Wt.nameInteraction;let le=Yf(wt);lt&&(le=le.filter(Te=>lt.includes(Te[0])));for(const Te of le){const[Fe,De]=Te,Je=fe.get(Fe);if(Je&&((xt=Je.destroy)===null||xt===void 0||xt.call(Je)),De){const We=jp(gt.view,Fe,De,l)(gt,Ht,n.emitter);fe.set(Fe,{destroy:We})}}}},W=k(M,F);for(const J of W){const{options:lt}=J,vt=new Map;J.container.nameInteraction=vt;for(const xt of Yf(lt)){const[Ht,gt]=xt;if(gt){const Wt=jp(J.view,Ht,gt,l)(J,W,n.emitter);vt.set(Ht,{destroy:Wt})}}}F();const{width:$,height:rt}=t,et=[];for(const J of T){const lt=new Promise(vt=>xs(this,void 0,void 0,function*(){for(const xt of J){const Ht=Object.assign({width:$,height:rt},xt);yield sm(Ht,e,n)}vt()}));et.push(lt)}n.views=b,(r=n.animations)===null||r===void 0||r.forEach(J=>J==null?void 0:J.cancel()),n.animations=R,n.emitter.emit(Ir.AFTER_PAINT);const ut=R.filter(Ur).map(z3).map(J=>J.finished);return Promise.all([...ut,...et])})}function k3(t){t.style("transform",e=>`translate(${e.layout.x}, ${e.layout.y})`)}function t8(t){const[,e]=ui("interaction",t);return n=>{const[r,o]=n;try{return[r,e(r)]}catch(c){return[r,o.type]}}}function D3(t,e,n){const{library:r}=n,o=t8(r),c=d=>d[1]&&d[1].props&&d[1].props.reapplyWhenUpdate,u=Yf(e).map(o).filter(c).map(d=>d[0]);return(d,h,g)=>xs(this,void 0,void 0,function*(){const v=[],[m,_]=yield Bp(d,n);cm(m,t,v,n);for(const b of u.filter(S=>S!==h))MC(b,t,d,m,n);for(const b of _)sm(b,t,n);return g(),{options:d,view:m}})}function MC(t,e,n,r,o){var c;const{library:l}=o,[u]=ui("interaction",l),h=e.node().nameInteraction,g=Yf(n).find(([S])=>S===t),v=h.get(t);if(!v||((c=v.destroy)===null||c===void 0||c.call(v),!g[1]))return;const m=jp(r,t,g[1],u),_={options:n,view:r,container:e.node(),update:S=>Promise.resolve(S)},b=m(_,[],o.emitter);h.set(t,{destroy:b})}function Bp(t,e){return xs(this,void 0,void 0,function*(){const{library:n}=e,r=yield CC(t,e),o=e8(r);t.interaction=o.interaction,t.coordinate=o.coordinate,t.marks=[...o.marks,...o.components];const c=yp(o,n),l=yield N3(c,e);return F3(l,c,n)})}function e8(t){const{coordinate:e={},interaction:n={},style:r={},marks:o}=t,c=qs(t,["coordinate","interaction","style","marks"]),l=o.map(m=>m.coordinate||{}),u=o.map(m=>m.interaction||{}),d=o.map(m=>m.viewStyle||{}),h=[...l,e].reduceRight((m,_)=>nn(m,_),{}),g=[n,...u].reduce((m,_)=>nn(m,_),{}),v=[...d,r].reduce((m,_)=>nn(m,_),{});return Object.assign(Object.assign({},c),{marks:o,coordinate:h,interaction:g,style:v})}function CC(t,e){return xs(this,void 0,void 0,function*(){const{library:n}=e,[r,o]=ui("mark",n),c=new Set(Object.keys(n).map(_=>{var b;return(b=/component\.(.*)/.exec(_))===null||b===void 0?void 0:b[1]}).filter(Ur)),{marks:l}=t,u=[],d=[],h=[...l],{width:g,height:v}=E3(t),m={options:t,width:g,height:v};for(;h.length;){const[_]=h.splice(0,1),b=yield U3(_,e),{type:S=vl("G2Mark type is required."),key:w}=b;if(c.has(S))d.push(b);else{const{props:E={}}=o(S),{composite:T=!0}=E;if(!T)u.push(b);else{const{data:M}=b,P=Object.assign(Object.assign({},b),{data:M&&(Array.isArray(M)?M:M.value)}),R=yield r(P,m),k=Array.isArray(R)?R:[R];h.unshift(...k.map((F,W)=>Object.assign(Object.assign({},F),{key:`${w}-${W}`})))}}}return Object.assign(Object.assign({},t),{marks:u,components:d})})}function N3(t,e){return xs(this,void 0,void 0,function*(){const{library:n}=e,[r]=ui("theme",n),[,o]=ui("mark",n),{theme:c,marks:l,coordinates:u=[]}=t,d=r(dm(c)),h=new Map;for(const v of l){const{type:m}=v,{props:_={}}=o(m),b=yield R3(v,_,e);if(b){const[S,w]=b;h.set(S,w)}}const g=$r(Array.from(h.values()).flatMap(v=>v.channels),({scaleKey:v})=>v);for(const v of g.values()){const m=v.reduce((P,{scale:R})=>nn(P,R),{}),{scaleKey:_}=v[0],{values:b}=v[0],S=Array.from(new Set(b.map(P=>P.field).filter(Ur))),w=nn({guide:{title:S.length===0?void 0:S},field:S[0]},m),{name:E}=v[0],T=v.flatMap(({values:P})=>P.map(R=>R.value)),M=Object.assign(Object.assign({},N5(E,T,w,u,d,n)),{uid:Symbol("scale"),key:_});v.forEach(P=>P.scale=M)}return h})}function jp(t,e,n,r){const o=t.theme,c=typeof e=="string"?o[e]||{}:{};return r(nn(c,Object.assign({type:e},n)))}function F3(t,e,n){var r;const[o]=ui("mark",n),[c]=ui("theme",n),[l]=ui("labelTransform",n),{key:u,frame:d=!1,theme:h,clip:g,style:v={},labelTransform:m=[]}=e,_=c(dm(h)),b=Array.from(t.values()),S=j5(b,e),w=GI(y3(UC(Array.from(S),b,t),e,n)),E=XI(w,e,_,n),T=e2(E,e,n),M=d?nn({mainLineWidth:1,mainStroke:"#000"},v):v;aC(tm(w),T,E),oC(w);const P=new Map(Array.from(t.values()).flatMap($=>{const{channels:rt}=$;return rt.map(({scale:et})=>[et.uid,i3(et,n)])}));B5(t,P);const R={};for(const $ of w){const{scales:rt=[]}=$,et=[];for(const ut of rt){const{name:J,uid:lt}=ut,vt=(r=P.get(lt))!==null&&r!==void 0?r:i3(ut,n);et.push(vt),J==="y"&&vt.update(Object.assign(Object.assign({},vt.getOptions()),{xScale:R.x})),qv(R,{[J]:vt})}$.scaleInstances=et}const k=[],F=new Map;for(const[$,rt]of t.entries()){const{children:et,dataDomain:ut,modifier:J,key:lt,data:vt}=$;F.set(lt,vt);const{index:xt,channels:Ht,tooltip:gt}=rt,wt=Object.fromEntries(Ht.map(({name:xn,scale:On})=>[xn,On])),Wt=Pa(wt,({uid:xn})=>P.get(xn));qv(R,Wt);const fe=F5(Ht,Wt),le=o($),[Te,Fe,De]=RC(le(xt,Wt,fe,T)),Je=ut||Te.length,qe=J?J(Fe,Je,E):[],We=xn=>{var On,Fn;return(Fn=(On=gt.title)===null||On===void 0?void 0:On[xn])===null||Fn===void 0?void 0:Fn.value},fn=xn=>gt.items.map(On=>On[xn]),_n=Te.map((xn,On)=>{const Fn=Object.assign({points:Fe[On],transform:qe[On],index:xn,markKey:lt,viewKey:u,data:vt[xn]},gt&&{title:We(xn),items:fn(xn)});for(const[Hn,qn]of Object.entries(fe))Fn[Hn]=qn[xn],De&&(Fn[`series${Ls(Hn)}`]=De[On].map(Rn=>qn[Rn]));return De&&(Fn.seriesIndex=De[On]),De&&gt&&(Fn.seriesItems=De[On].map(Hn=>fn(Hn)),Fn.seriesTitle=De[On].map(Hn=>We(Hn))),Fn});rt.data=_n,rt.index=Te;const An=et==null?void 0:et(_n,Wt,E);k.push(...An||[])}return[{layout:E,theme:_,coordinate:T,markState:t,key:u,clip:g,scale:R,style:M,components:w,data:F,options:e,labelTransform:Gu(m.map(l))},k]}function cm(t,e,n,r){return xs(this,void 0,void 0,function*(){const{library:o}=r,{components:c,theme:l,layout:u,markState:d,coordinate:h,key:g,style:v,clip:m,scale:_}=t,{x:b,y:S,width:w,height:E}=u,T=qs(u,["x","y","width","height"]),M=["view","plot","main","content"],P=M.map((gt,wt)=>wt),R=["a","margin","padding","inset"],k=M.map(gt=>tg(Object.assign({},l.view,v),gt)),F=R.map(gt=>wn(T,gt)),W=gt=>gt.style("x",wt=>J[wt].x).style("y",wt=>J[wt].y).style("width",wt=>J[wt].width).style("height",wt=>J[wt].height).each(function(wt,Wt,fe){ZC(Kn(fe),k[wt])});let $=0,rt=0,et=w,ut=E;const J=P.map(gt=>{const wt=F[gt],{left:Wt=0,top:fe=0,bottom:le=0,right:Te=0}=wt;return $+=Wt,rt+=fe,et-=Wt+Te,ut-=fe+le,{x:$,y:rt,width:et,height:ut}});e.selectAll(Wo(he)).data(P.filter(gt=>Ur(k[gt])),gt=>M[gt]).join(gt=>gt.append("rect").attr("className",he).style("zIndex",-2).call(W),gt=>gt.call(W),gt=>gt.remove());const lt=DC(d),vt=lt?{duration:lt[1]}:!1;for(const[,gt]of Wu(c,wt=>`${wt.type}-${wt.position}`))gt.forEach((wt,Wt)=>wt.index=Wt);const xt=e.selectAll(Wo(Ct)).data(c,gt=>`${gt.type}-${gt.position}-${gt.index}`).join(gt=>gt.append("g").style("zIndex",({zIndex:wt})=>wt||-1).attr("className",Ct).append(wt=>Jv(nn({animate:vt,scale:_},wt),h,l,o,d)),gt=>gt.transition(function(wt,Wt,fe){const{preserve:le=!1}=wt;if(le)return;const Te=Jv(nn({animate:vt,scale:_},wt),h,l,o,d),{attributes:Fe}=Te,[De]=fe.childNodes;return De.update(Fe,!1)})).transitions();n.push(...xt.flat().filter(Ur));const Ht=e.selectAll(Wo(ct)).data([u],()=>g).join(gt=>gt.append("rect").style("zIndex",0).style("fill","transparent").attr("className",ct).call(Z3).call(pm,Array.from(d.keys())).call(H3,m),gt=>gt.call(pm,Array.from(d.keys())).call(Z3).call(H3,m)).transitions();n.push(...Ht.flat());for(const[gt,wt]of d.entries()){const{data:Wt}=wt,{key:fe,class:le,type:Te}=gt,Fe=e.select(`#${fe}`),De=FC(gt,wt,t,r),Je=BC(gt,wt,t,o),qe=jC(gt,wt,t,o),We=zC(gt,wt,t,o),fn=j3(e,Fe,le,"element"),_n=Fe.selectAll(Wo(cn)).selectFacetAll(fn).data(Wt,An=>An.key,An=>An.groupKey).join(An=>An.append(De).attr("className",cn).attr("markType",Te).transition(function(xn,On,Fn){return Je(xn,[Fn])}),An=>An.call(xn=>{const On=xn.parent(),Fn=LE(Hn=>{const[qn,Rn]=Hn.getBounds().min;return[qn,Rn]});xn.transition(function(Hn,qn,Rn){NC(Rn,On,Fn);const Bn=De(Hn,qn),Yn=qe(Hn,[Rn],[Bn]);return Yn!=null&&Yn.length||(Rn.nodeName===Bn.nodeName&&Bn.nodeName!=="g"?Yd(Rn,Bn):(Rn.parentNode.replaceChild(Bn,Rn),Bn.className=cn,Bn.markType=Te,Bn.__data__=Rn.__data__)),Yn}).each(function(Hn,qn,Rn){Rn.__removed__&&(Rn.__removed__=!1)}).attr("markType",Te).attr("className",cn)}),An=>An.each(function(xn,On,Fn){Fn.__removed__=!0}).transition(function(xn,On,Fn){return We(xn,[Fn])}).remove(),An=>An.append(De).attr("className",cn).attr("markType",Te).transition(function(xn,On,Fn){const{__fromElements__:Hn}=Fn,qn=qe(xn,Hn,[Fn]);return new Mi(Hn,null,Fn.parentNode).transition(qn).remove(),qn}),An=>An.transition(function(xn,On,Fn){const qn=new Mi([],Fn.__toData__,Fn.parentNode).append(De).attr("className",cn).attr("markType",Te).nodes();return qe(xn,[Fn],qn)}).remove()).transitions();n.push(..._n.flat())}PC(t,e,n,o,r),IC(t,e,o,r)})}function PC(t,e,n,r,o){const[c]=ui("labelTransform",r),{markState:l,labelTransform:u}=t,d=e.select(Wo(un)).node(),h=new Map,g=new Map,v=Array.from(l.entries()).flatMap(([E,T])=>{const{labels:M=[],key:P}=E,R=lm(E,T,t,r,o),k=e.select(`#${P}`).selectAll(Wo(cn)).nodes().filter(F=>{var W;return F.__removed__?!1:!(((W=F.style)===null||W===void 0?void 0:W.visibility)==="hidden"||F.children&&F.children.some(rt=>{var et;return((et=rt.style)===null||et===void 0?void 0:et.visibility)==="hidden"}))});return M.flatMap((F,W)=>{const{transform:$=[]}=F,rt=qs(F,["transform"]);return k.flatMap(et=>{const ut=LC(rt,W,et);return ut.forEach(J=>{h.set(J,lt=>R(Object.assign(Object.assign({},lt),{element:et}))),g.set(J,F)}),ut})})}),m=Kn(d).selectAll(Wo(me)).data(v,E=>E.key).join(E=>E.append(T=>h.get(T)(T)).attr("className",me),E=>E.each(function(T,M,P){const k=h.get(T)(T);Yd(P,k)}),E=>E.remove()).nodes(),_=$r(m,E=>g.get(E.__data__)),{coordinate:b,layout:S}=t,w={canvas:o.canvas,coordinate:b,layout:S};for(const[E,T]of _){const{transform:M=[]}=E;Gu(M.map(c))(T,w)}u&&u(m,w)}function LC(t,e,n){const{seriesIndex:r,seriesKey:o,points:c,key:l,index:u}=n.__data__,d=kC(n);if(!r)return[Object.assign(Object.assign({},t),{key:`${l}-${e}`,bounds:d,index:u,points:c,dependentElement:n})];const h=n8(t),g=r.map((v,m)=>Object.assign(Object.assign({},t),{key:`${o[m]}-${e}`,bounds:[c[m]],index:v,points:c,dependentElement:n}));return h?h(g):g}function IC(t,e,n,r){const o=t.scale,c=er(o,"y.options.breaks",[]),{document:l}=r.canvas;if([re,Yt].forEach(g=>{l.getElementsByClassName(g).forEach(v=>{v.remove()})}),!c.length)return;const u=e.select(Wo(ct)).node(),[d]=ui("shape",n),h=new Map;c.forEach((g,v)=>{h.set(g,d({type:"break"},{view:t,selection:e,context:r}))}),Kn(u).selectAll(Wo(re)).data(c,g=>g.key).join(g=>g.append((v,m)=>h.get(v)(v,m)).attr("className",re),g=>g.each(function(v,m,_){const S=h.get(v)(v,m);Yd(_,S)}),g=>g.remove()).nodes()}function RC([t,e,n]){if(n)return[t,e,n];const r=[],o=[];for(let c=0;c<t.length;c++){const l=t[c],u=e[c];u.every(([d,h])=>Ur(d)&&Ur(h))&&(r.push(l),o.push(u))}return[r,o]}function n8(t){const{selector:e}=t;if(!e)return null;if(typeof e=="function")return e;if(e==="first")return n=>[n[0]];if(e==="last")return n=>[n[n.length-1]];throw new Error(`Unknown selector: ${e}`)}function kC(t){const e=t.cloneNode(!0),n=t.getAnimations();e.style.visibility="hidden",n.forEach(l=>{const u=l.effect.getKeyframes();e.attr(u[u.length-1])}),t.parentNode.appendChild(e);const r=e.getLocalBounds();e.destroy();const{min:o,max:c}=r;return[o,c]}function lm(t,e,n,r,o){const[c]=ui("shape",r),{data:l,encode:u}=t,{data:d,defaultLabelShape:h}=e,g=d.map(S=>S.points),v=Pa(u,S=>S.value),{theme:m,coordinate:_}=n,b=Object.assign(Object.assign({},o),{document:Cv(o),theme:m,coordinate:_});return S=>{const{index:w,points:E}=S,T=l[w],{formatter:M=wt=>`${wt}`,transform:P,style:R,render:k,selector:F,element:W}=S,$=qs(S,["formatter","transform","style","render","selector","element"]),rt=Pa(Object.assign(Object.assign({},$),R),wt=>B3(wt,T,w,l,{channel:v,element:W})),{shape:et=h,text:ut}=rt,J=qs(rt,["shape","text"]),lt=typeof M=="string"?ss(M):M,vt=Object.assign(Object.assign({},J),{text:lt(ut,T,w,l),datum:T}),xt=Object.assign({type:`label.${et}`,render:k},J),Ht=c(xt,b),gt=um(m,"label",et,"label");return Ht(E,vt,gt,g)}}function B3(t,e,n,r,o){return typeof t=="function"?t(e,n,r,o):typeof t!="string"?t:ml(e)&&e[t]!==void 0?e[t]:t}function DC(t){let e=-1/0,n=1/0;for(const[r,o]of t){const{animate:c={}}=r,{data:l}=o,{enter:u={},update:d={},exit:h={}}=c,{type:g,duration:v=300,delay:m=0}=d,{type:_,duration:b=300,delay:S=0}=u,{type:w,duration:E=300,delay:T=0}=h;for(const M of l){const{updateType:P=g,updateDuration:R=v,updateDelay:k=m,enterType:F=_,enterDuration:W=b,enterDelay:$=S,exitDuration:rt=E,exitDelay:et=T,exitType:ut=w}=M;(P===void 0||P)&&(e=Math.max(e,R+k),n=Math.min(n,k)),(ut===void 0||ut)&&(e=Math.max(e,rt+et),n=Math.min(n,et)),(F===void 0||F)&&(e=Math.max(e,W+$),n=Math.min(n,$))}}return e===-1/0?null:[n,e-n]}function j3(t,e,n,r){const o=t.node().parentElement;return!o||typeof o.findAll!="function"?[]:o.findAll(c=>c.style.facet!==void 0&&c.style.facet===n&&c!==e.node()).flatMap(c=>c.getElementsByClassName(r))}function NC(t,e,n){if(!t.__facet__)return;const r=t.parentNode.parentNode,o=e.parentNode,[c,l]=n(r),[u,d]=n(o),h=`translate(${c-u}, ${l-d})`;c_(t,h),e.append(t)}function FC(t,e,n,r){const{library:o}=r,[c]=ui("shape",o),{data:l,encode:u}=t,{defaultShape:d,data:h,shape:g}=e,v=Pa(u,T=>T.value),m=h.map(T=>T.points),{theme:_,coordinate:b}=n,{type:S,style:w={}}=t,E=Object.assign(Object.assign({},r),{document:Cv(r),coordinate:b,theme:_});return T=>{const{shape:M=d}=w,{shape:P=M,points:R,seriesIndex:k,index:F}=T,W=qs(T,["shape","points","seriesIndex","index"]),$=Object.assign(Object.assign({},W),{index:F}),rt=k?k.map(vt=>l[vt]):l[F],et=k||F,ut=Pa(w,vt=>B3(vt,rt,et,l,{channel:v})),J=g[P]?g[P](ut,E):c(Object.assign(Object.assign({},ut),{type:hm(t,P)}),E),lt=um(_,S,P,d);return J(R,$,lt,m)}}function um(t,e,n,r){if(typeof e!="string")return;const{color:o}=t,c=t[e]||{},l=c[n]||c[r];return Object.assign({color:o},l)}function fm(t,e,n,r,o){var c,l;const[,u]=ui("shape",o),[d]=ui("animation",o),{defaultShape:h,shape:g}=n,{theme:v,coordinate:m}=r,b=`default${Ls(t)}Animation`,{[b]:S}=((c=g[h])===null||c===void 0?void 0:c.props)||u(hm(e,h)).props,{[t]:w={}}=v,E=((l=e.animate)===null||l===void 0?void 0:l[t])||{},T={coordinate:m};return(M,P,R)=>{const{[`${t}Type`]:k,[`${t}Delay`]:F,[`${t}Duration`]:W,[`${t}Easing`]:$}=M,rt=Object.assign({type:k||S},E);if(!rt.type)return null;const J=d(rt,T)(P,R,nn(w,{delay:F,duration:W,easing:$}));let lt=[];return Array.isArray(J)?lt=J:lt=[J],lt.filter(Boolean)}}function BC(t,e,n,r){return fm("enter",t,e,n,r)}function z3(t){return t.finished.then(()=>{t.cancel()}),t}function jC(t,e,n,r){return fm("update",t,e,n,r)}function zC(t,e,n,r){return fm("exit",t,e,n,r)}function dm(t={}){if(typeof t=="string")return{type:t};const{type:e="light"}=t,n=qs(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}function Yf(t){const e={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:n={}}=t;return Object.entries(nn(e,n)).reverse()}function U3(t,e){return xs(this,void 0,void 0,function*(){const{data:n}=t,r=qs(t,["data"]);if(n==null)return t;const[,{data:o}]=yield M3([],{data:n},e);return Object.assign({data:o},r)})}function Z3(t){t.style("transform",e=>`translate(${e.paddingLeft+e.marginLeft}, ${e.paddingTop+e.marginTop})`).style("width",e=>e.innerWidth).style("height",e=>e.innerHeight)}function r8(t,e){const[n,r]=e;t.transition(function(o,c,l){const{transform:u,width:d,height:h}=l.style,{paddingLeft:g,paddingTop:v,innerWidth:m,innerHeight:_,marginLeft:b,marginTop:S}=o,w=[{transform:u,width:d,height:h},{transform:`translate(${g+b}, ${v+S})`,width:m,height:_}];return l.animate(w,{delay:n,duration:r,fill:"both"})})}function hm(t,e){const{type:n}=t;return typeof e=="string"?`${n}.${e}`:e}function pm(t,e){const n=c=>c.class!==void 0?`${c.class}`:"";t.nodes().length===0||(t.selectAll(Wo(Re)).data(e,c=>c.key).join(c=>c.append("g").attr("className",Re).attr("id",l=>l.key).style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),c=>c.style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),c=>c.remove()),t.select(Wo(un)).node())||t.append("g").attr("className",un).style("zIndex",0)}function Wo(...t){return t.map(e=>`.${e}`).join("")}function H3(t,e){t.node()&&t.style("clipPath",n=>{if(!e)return null;const{paddingTop:r,paddingLeft:o,marginLeft:c,marginTop:l,innerWidth:u,innerHeight:d}=n;return new N.UL({style:{x:o+c,y:r+l,width:u,height:d}})})}function UC(t,e,n){var r;for(const[h]of n.entries())if(h.type==="cell")return t.filter(g=>g.name!=="shape");if(e.length!==1||t.some(h=>h.name==="shape"))return t;const{defaultShape:o}=e[0];if(!["point","line","rect","hollow"].includes(o))return t;const l={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},d={field:((r=t.find(h=>h.name==="color"))===null||r===void 0?void 0:r.field)||null,name:"shape",type:"constant",domain:[],range:[l[o]]};return[...t,d]}function ZC(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function HC(...t){return e=>t.reduce((n,r)=>r(n),e)}function W3(t){const{style:e,scale:n,type:r}=t,o={},c=er(e,"columnWidthRatio");return c&&r==="interval"&&(o.x=Object.assign(Object.assign({},n==null?void 0:n.x),{padding:1-c})),Object.assign(Object.assign({},t),{scale:Object.assign(Object.assign({},n),o)})}const V3=t=>{if(!t||typeof t!="string")return t;const e=t.endsWith("%")?parseFloat(t.slice(0,-1))/100:parseFloat(t);if(isNaN(e)||e<0||e>1)throw new Error(`Invalid gap value: ${t}. It should be between 0 and 1.`);return e};function Xf(t){const{axis:e}=t,n=er(e,"y.breaks");return n&&gv(t,"scale.y.breaks",n.map(r=>Object.assign(Object.assign({key:`break-${r.start}-${r.end}`},r),{gap:V3(r.gap)}))),t}function gm(t){const e=G3(t);return e.children&&Array.isArray(e.children)&&(e.children=e.children.map(n=>gm(n))),e}function G3(t){return HC(W3,Xf)(t)}function $3(t){const e=nn({},t),n=new Map([[e,null]]),r=new Map([[null,-1]]),o=[e];for(;o.length;){const c=o.shift();if(c.key===void 0){const u=n.get(c),d=r.get(c),h=u===null?"0":`${u.key}-${d}`;c.key=h}const{children:l=[]}=c;if(Array.isArray(l))for(let u=0;u<l.length;u++){const d=nn({},l[u]);l[u]=d,n.set(d,c),r.set(d,u),o.push(d)}}return e}function vm(t,e){const n=new mE;return n.registerPlugin(new U1),new N.Xz({width:t,height:e,container:document.createElement("div"),renderer:n})}function WC(t,e={},n=()=>{},r=o=>{throw o}){const o=yl(t),{width:c=640,height:l=480,depth:u=0}=o,d=gm(o),h=$3(d),{canvas:g=vm(c,l),emitter:v=new Xe,library:m}=e;e.canvas=g,e.emitter=v,e.externals={};const{width:_,height:b}=g.getConfig();(_!==c||b!==l)&&g.resize(c,l),v.emit(Ir.BEFORE_RENDER);const S=Kn(g.document.documentElement);return g.ready.then(()=>sm(Object.assign(Object.assign({},h),{width:c,height:l,depth:u}),S,e)).then(()=>{if(u){const[w,E]=g.document.documentElement.getPosition();g.document.documentElement.setPosition(w,E,-u/2)}g.requestAnimationFrame(()=>{g.requestAnimationFrame(()=>{v.emit(Ir.AFTER_RENDER),n==null||n()})})}).catch(w=>{r==null||r(w)}),GC(g.getConfig().container)}function i8(t,e={},n=()=>{},r=o=>{throw o}){var o;const{width:c=640,height:l=480}=t,u=$3(t),{group:d=new Group,emitter:h=new EventEmitter,library:g}=e;d!=null&&d.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const v=select(d);return e.group=d,e.emitter=h,e.externals={},e.canvas=e.canvas||((o=d==null?void 0:d.ownerDocument)===null||o===void 0?void 0:o.defaultView),h.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},u),{width:c,height:l}),v,e).then(()=>{var m;(m=e.canvas)===null||m===void 0||m.requestAnimationFrame(()=>{h.emit(ChartEvent.AFTER_RENDER),n==null||n()})}).catch(m=>{r==null||r(m)}),d}function Y3(t,e={},n=!1,r=!0){const{canvas:o,emitter:c}=e;o&&(VC(o),n?o.destroy():o.destroyChildren()),r&&c.off()}function VC(t){const e=t.getRoot().querySelectorAll(`.${Jt}`);e==null||e.forEach(n=>{const{nameInteraction:r=new Map}=n;(r==null?void 0:r.size)>0&&Array.from(r==null?void 0:r.values()).forEach(o=>{o==null||o.destroy()})})}function GC(t){return typeof t=="string"?document.getElementById(t):t}function qf(t,e){let n,r=-1,o=-1;if(e===void 0)for(const c of t)++o,c!=null&&(n>c||n===void 0&&c>=c)&&(n=c,r=o);else for(let c of t)(c=e(c,++o,t))!=null&&(n>c||n===void 0&&c>=c)&&(n=c,r=o);return r}function Kf(t,e){let n=0,r=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(++n,r+=o);else{let o=-1;for(let c of t)(c=e(c,++o,t))!=null&&(c=+c)>=c&&(++n,r+=c)}if(n)return r/n}var rl=function(t,e,n){var r,o,c,l,u=0;n||(n={});var d=function(){u=n.leading===!1?0:Date.now(),r=null,l=t.apply(o,c),r||(o=c=null)},h=function(){var g=Date.now();!u&&n.leading===!1&&(u=g);var v=e-(g-u);return o=this,c=arguments,v<=0||v>e?(r&&(clearTimeout(r),r=null),u=g,l=t.apply(o,c),r||(o=c=null)):!r&&n.trailing!==!1&&(r=setTimeout(d,v)),l};return h.cancel=function(){clearTimeout(r),u=0,r=o=c=null},h};function X3(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}function $C(t,e){return!t||!e?t:t.replace(/\\?\{([^{}]+)\}/g,function(n,r){return n.charAt(0)==="\\"?n.slice(1):e[r]===void 0?"":e[r]})}var YC=$C,q3=function(t,e){if(e==null){t.innerHTML="";return}t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,(0,Q.ev)([],(0,Q.CR)(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach(function(n){return t.appendChild(n)}):t.appendChild(e))};function mm(t){return t===void 0&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var K3={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function XC(t){var e;t===void 0&&(t="");var n=mm(t);return e={},e[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=(0,Q.pi)({flex:1},K3),e[".".concat(n.VALUE)]=(0,Q.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},K3),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var qC=function(t){(0,Q.ZT)(e,t);function e(n){var r=this,o,c,l=(c=(o=n.style)===null||o===void 0?void 0:o.template)===null||c===void 0?void 0:c.prefixCls,u=mm(l);return r=t.call(this,n,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(u.NAME,`">
          <span class="`).concat(u.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(u.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(u.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:XC(l)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var n=this.element.offsetWidth,r=this.element.offsetHeight;return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var n=this.attributes,r=n.data,o=n.template;return r.map(function(c,l){var u=c.name,d=u===void 0?"":u,h=c.color,g=h===void 0?"black":h,v=c.index,m=(0,Q._T)(c,["name","color","index"]),_=(0,Q.pi)({name:d,color:g,index:v!=null?v:l},m);return X3(YC(o.item,_))})},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var n;(n=this.element)===null||n===void 0||n.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(n,r){var o=this;if(n!==void 0&&r!==void 0){var c=this.element.style.visibility==="hidden",l=function(){o.attributes.x=n!=null?n:o.attributes.x,o.attributes.y=r!=null?r:o.attributes.y,o.updatePosition()};c?this.closeTransition(l):l()}this.element.style.visibility="visible"},e.prototype.hide=function(n,r){n===void 0&&(n=0),r===void 0&&(r=0);var o=this.attributes.enterable;o&&this.isCursorEntered(n,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var n=this.attributes.template;this.element=X3(n.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var n=this.attributes.content;n&&(typeof n=="string"?this.element.innerHTML=n:q3(this.element,n))}},e.prototype.renderHTMLTooltipElement=function(){var n,r,o=this.attributes,c=o.template,l=o.title,u=o.enterable,d=o.style,h=o.content,g=mm(c.prefixCls),v=this.element;if(this.element.style.pointerEvents=u?"auto":"none",h)this.renderCustomContent();else{l?(v.innerHTML=c.title,v.getElementsByClassName(g.TITLE)[0].innerHTML=l):(r=(n=v.getElementsByClassName(g.TITLE))===null||n===void 0?void 0:n[0])===null||r===void 0||r.remove();var m=this.HTMLTooltipItemsElements,_=document.createElement("ul");_.className=g.LIST,q3(_,m);var b=this.element.querySelector(".".concat(g.LIST));b?b.replaceWith(_):v.appendChild(_)}K7(v,d)},e.prototype.getRelativeOffsetFromCursor=function(n){var r=this.attributes,o=r.position,c=r.offset,l=n||o,u=l.split("-"),d={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},h=this.elementSize,g=h.width,v=h.height,m=[-g/2,-v/2];return u.forEach(function(_){var b=(0,Q.CR)(m,2),S=b[0],w=b[1],E=(0,Q.CR)(d[_],2),T=E[0],M=E[1];m=[S+(g/2+c[0])*T,w+(v/2+c[1])*M]}),m},e.prototype.setOffsetPosition=function(n){var r=(0,Q.CR)(n,2),o=r[0],c=r[1],l=this.attributes,u=l.x,d=u===void 0?0:u,h=l.y,g=h===void 0?0:h,v=l.container,m=v.x,_=v.y;this.element.style.left="".concat(+d+m+o,"px"),this.element.style.top="".concat(+g+_+c,"px")},e.prototype.updatePosition=function(){var n=this.attributes.showDelay,r=n===void 0?60:n,o=Date.now();this.timestamp>0&&o-this.timestamp<r||(this.timestamp=o,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(n){var r=(0,Q.CR)(n,2),o=r[0],c=r[1],l=this.attributes,u=l.x,d=l.y,h=l.bounding,g=l.position;if(!h)return[o,c];var v=this.element,m=v.offsetWidth,_=v.offsetHeight,b=(0,Q.CR)([+u+o,+d+c],2),S=b[0],w=b[1],E={left:"right",right:"left",top:"bottom",bottom:"top"},T=h.x,M=h.y,P=h.width,R=h.height,k={left:S<T,right:S+m>T+P,top:w<M,bottom:w+_>M+R},F=[];g.split("-").forEach(function($){k[$]?F.push(E[$]):F.push($)});var W=F.join("-");return this.getRelativeOffsetFromCursor(W)},e.prototype.isCursorEntered=function(n,r){if(this.element){var o=this.element.getBoundingClientRect(),c=o.x,l=o.y,u=o.width,d=o.height;return new Jr(c,l,u,d).isPointIn(n,r)}return!1},e.prototype.closeTransition=function(n){var r=this,o=this.element.style.transition;this.element.style.transition="none",n(),setTimeout(function(){r.element.style.transition=o},10)},e.tag="tooltip",e}(Gi),Ks=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Ss="tooltipLocked";function zp(t,e){var n;if(e)return typeof e=="string"?document.querySelector(e):e;const r=(n=t.ownerDocument)===null||n===void 0?void 0:n.defaultView;return r?r.getContextService().getDomElement().parentElement:void 0}function KC(t){const e=t.getRenderBounds(),{min:[n,r],max:[o,c]}=e;return{x:n,y:r,width:o-n,height:c-r}}function QC(t,e){const n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:n.x-r.x,y:n.y-r.y}}function o8(t,e,n,r,o,c,l,u={},d=[10,10]){const h={[xc("tooltip")]:{},[xc("tooltip-title")]:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},g=new qC({className:"tooltip",style:{x:e,y:n,container:l,data:[],bounding:c,position:r,enterable:o,title:"",offset:d,template:{prefixCls:cs},style:nn(h,u)}});return t.appendChild(g.HTMLTooltipElement),g}function Q3({root:t,data:e,x:n,y:r,render:o,event:c,single:l,position:u="right-bottom",enterable:d=!1,css:h,mount:g,bounding:v,offset:m}){const _=zp(t,g),b=zp(t),S=l?b:t,w=v||KC(t),E=QC(b,_),{tooltipElement:T=o8(_,n,r,u,d,w,E,h,m)}=S,{items:M,title:P=""}=e;T.update(Object.assign({x:n,y:r,data:M.map(R=>Object.assign(Object.assign({},R),{value:!R.value&&R.value!==0?"":R.value})),title:P,position:u,enterable:d,container:E},o!==void 0&&{content:o(c,{items:M,title:P})})),S.tooltipElement=T}function Va({root:t,single:e,emitter:n,nativeEvent:r=!0,event:o=null}){r&&n.emit("tooltip:hide",{nativeEvent:r});const c=zp(t),l=e?c:t,{tooltipElement:u}=l;u&&u.hide(o==null?void 0:o.clientX,o==null?void 0:o.clientY),J3(t),xm(t),tS(t)}function ym({root:t,single:e}){const n=zp(t),r=e?n:t;if(!r)return;const{tooltipElement:o}=r;o&&(o.destroy(),r.tooltipElement=void 0),J3(t),xm(t),tS(t)}function _m(t){const{value:e}=t;return Object.assign(Object.assign({},t),{value:e===void 0?"undefined":e})}function JC(t){var e,n,r,o,c,l,u;const{__data__:d}=t,{title:h,items:g=[]}=d;if(g.some(k=>am in k)){const k=g.filter(Ur).map(F=>{var{color:W=bm(t)}=F,$=Ks(F,["color"]);return Object.assign(Object.assign({},$),{color:W})}).map(_m);return Object.assign(Object.assign({},h&&{title:h}),{items:k})}const m=(n=(e=d==null?void 0:d.normalized)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,_=(r=t.parentNode)===null||r===void 0?void 0:r.__data__,b=(o=_==null?void 0:_.encode)!==null&&o!==void 0?o:{},{x:S={},y:w={},color:E={}}=b,{value:T=[]}=S,{value:M=[]}=w,{value:P=[]}=E,R=Math.min(Math.round(T.length*m),T.length-1);return{title:`${T[R]}, ${M[R]}`,items:[{name:(c=E.field)!==null&&c!==void 0?c:"value",value:P[R],color:((l=t.style)===null||l===void 0?void 0:l.fill)||((u=t.getAttribute)===null||u===void 0?void 0:u.call(t,"color"))||"#000"}]}}function t4(t){const{__data__:e}=t;if($d(t))return JC(t);const{title:n,items:r=[]}=e,o=r.filter(Ur).map(c=>{var{color:l=bm(t)}=c,u=Ks(c,["color"]);return Object.assign(Object.assign({},u),{color:l})}).map(_m);return Object.assign(Object.assign({},n&&{title:n}),{items:o})}function bm(t){const e=t.getAttribute("fill"),n=t.getAttribute("stroke"),{__data__:r}=t,{color:o=e&&e!=="transparent"?e:n}=r;return o}function fu(t,e=n=>n){const n=new Map(t.map(r=>[e(r),r]));return Array.from(n.values())}function du(t,e,n,r=t.map(c=>c.__data__),o={}){const c=d=>d instanceof Date?+d:d,l=fu(r.map(d=>d.title),c).filter(Ur),u=r.flatMap((d,h)=>{const g=d.element||t[h],{items:v=[],title:m}=d,_=v.filter(Ur),b=n!==void 0?n:v.length<=1;return _.map(S=>{var{color:w=bm(g)||o.color,name:E}=S,T=Ks(S,["color","name"]);const M=PE(e,d),P=b&&!(am in T)?M||E:E||M;return Object.assign(Object.assign({},T),{color:w,name:P||m})})}).map(_m);return Object.assign(Object.assign({},l.length>0&&{title:l.join(",")}),{items:fu(u,d=>`(${c(d.name)}, ${c(d.value)}, ${c(d.color)})`)})}function e4(t,e,n,r){var{plotWidth:o,plotHeight:c,mainWidth:l,mainHeight:u,startX:d,startY:h,transposed:g,polar:v,insetLeft:m,insetTop:_}=r,b=Ks(r,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const S=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},b),w=(k,F,W)=>{const $=new N.Cd({style:Object.assign({cx:k,cy:F,r:W},S)});return t.appendChild($),$},E=(k,F,W,$)=>{const rt=new N.x1({style:Object.assign({x1:k,x2:F,y1:W,y2:$},S)});return t.appendChild(rt),rt},M=((k,F)=>{if(F.length===1)return F[0];const W=F.map(rt=>pi(rt,k)),$=qf(W,rt=>rt);return F[$]})(n,e),P=()=>g?[d+M[0],d+M[0],h,h+c]:[d,d+o,M[1]+h,M[1]+h],R=()=>{const k=d+m+l/2,F=h+_+u/2,W=pi([k,F],M);return[k,F,W]};if(v){const[k,F,W]=R(),$=t.ruleX||w(k,F,W);$.style.cx=k,$.style.cy=F,$.style.r=W,t.ruleX=$}else{const[k,F,W,$]=P(),rt=t.ruleX||E(k,F,W,$);rt.style.x1=k,rt.style.x2=F,rt.style.y1=W,rt.style.y2=$,t.ruleX=rt}}function n4(t,e,n){var{plotWidth:r,plotHeight:o,mainWidth:c,mainHeight:l,startX:u,startY:d,transposed:h,polar:g,insetLeft:v,insetTop:m}=n,_=Ks(n,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const b=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},_),S=e.map($=>$[1]),w=e.map($=>$[0]),E=Kf(S),T=Kf(w),M=()=>{if(g){const $=Math.min(c,l)/2,rt=u+v+c/2,et=d+m+l/2,ut=na(bi([T,E],[rt,et])),J=rt+$*Math.cos(ut),lt=et+$*Math.sin(ut);return[rt,J,et,lt]}return h?[u,u+r,E+d,E+d]:[T+u,T+u,d,d+o]},[P,R,k,F]=M(),W=()=>{const $=new N.x1({style:Object.assign({x1:P,x2:R,y1:k,y2:F},b)});return t.appendChild($),$};if(w.length>0){const $=t.ruleY||W();$.style.x1=P,$.style.x2=R,$.style.y1=k,$.style.y2=F,t.ruleY=$}}function J3(t){t.ruleY&&(t.ruleY.remove(),t.ruleY=void 0)}function xm(t){t.ruleX&&(t.ruleX.remove(),t.ruleX=void 0)}function r4(t,{data:e,style:n,theme:r}){t.markers&&t.markers.forEach(l=>l.remove());const{type:o=""}=n,c=e.filter(l=>{const[{x:u,y:d}]=l;return Ur(u)&&Ur(d)}).map(l=>{const[{color:u,element:d},h]=l,g=u||d.style.fill||d.style.stroke||r.color,v=o==="hollow"?"transparent":g,m=o==="hollow"?g:"#fff";return new N.Cd({className:`${cs}tooltip-marker`,style:Object.assign({cx:h[0],cy:h[1],fill:v,r:4,stroke:m,lineWidth:2,pointerEvents:"none"},n)})});for(const l of c)t.appendChild(l);t.markers=c}function tS(t){t.markers&&(t.markers.forEach(e=>e.remove()),t.markers=[])}function eS(t,e){return Array.from(t.values()).some(n=>{var r;return(r=n.interaction)===null||r===void 0?void 0:r[e]})}function Ga(t,e){return t===void 0?e:t}function nS(t){const{title:e,items:n}=t;return n.length===0&&e===void 0}function i4(t){return Array.from(t.values()).some(e=>{var n;return((n=e.interaction)===null||n===void 0?void 0:n.seriesTooltip)&&e.tooltip})}function o4(t,e){const{innerWidth:n,innerHeight:r,marginLeft:o,paddingLeft:c,insetLeft:l,marginTop:u,paddingTop:d,insetTop:h}=t.getOptions();return{x:(e.x-o-c-l)/n,y:(e.y-u-d-h)/r}}function a4(t){const{x:e}=t;if(!e||!e.valueBandWidth)return!0;const{valueBandWidth:n}=e;return(0,Se.Z)(n)?!0:new Set(n.values()).size===1}function s4(t,e){const{adjustedRange:n,valueBandWidth:r,valueStep:o}=t,c=Array.from(r.values()),l=Array.from(o.values()),d=n.map((h,g)=>{const v=(l[g]-c[g])/2;return[h-v,h+c[g]+v]}).findIndex(([h,g])=>h<=e&&e<=g);return d!==-1?d:e>.5?n.length-1:0}function rS({root:t,event:e,elements:n=[],coordinate:r,scale:o,shared:c}){var l,u;const d=M=>M.markType==="interval",h=M=>gg.includes(M.markType),g=n.filter(M=>!h(M)),v=g.length>0&&g.every(d)&&!kr(r),m=o.x,_=a4(o),b=o.series,S=(u=(l=m==null?void 0:m.getBandWidth)===null||l===void 0?void 0:l.call(m))!==null&&u!==void 0?u:0,w=b&&b.valueBandWidth?M=>{const P=Math.round(1/b.valueBandWidth);return M.__data__.x+M.__data__.series*S+S/(P*2)}:M=>M.__data__.x+S/2;v&&g.sort((M,P)=>w(M)-w(P));const E=M=>{const{target:P=Jo(n)}=M;return Af(P,R=>R.classList?($d(R)&&gv(R,"__data__.normalized",o4(r,{x:M.offsetX,y:M.offsetY})),R.classList.includes("element")):!1)};return(v?M=>{const P=Bc(t,M);if(!P)return;const[R]=r.invert(P),k=Ua(w).center,F=_?k(g,R):s4(m,R),W=g[F];if(!c){const $=g.find(rt=>rt!==W&&w(rt)===w(W));if($)return E(M)||$}return W}:E)(e)}function iS({root:t,event:e,elements:n,coordinate:r,scale:o,startX:c,startY:l}){const u=Yr(r),d=[],h=[];for(const Ht of n){if(gg.includes(Ht.markType))continue;const{__data__:gt}=Ht,{seriesX:wt,title:Wt,items:fe}=gt;wt?d.push(Ht):(Wt||fe)&&h.push(Ht)}const g=Ht=>Ht.markType==="interval",v=h.length&&h.every(g)&&!kr(r),m=Ht=>Ht.__data__.x,b=!!o.x.getBandWidth&&h.length>0;d.sort((Ht,gt)=>{const wt=u?0:1,Wt=fe=>fe.getBounds().min[wt];return u?Wt(gt)-Wt(Ht):Wt(Ht)-Wt(gt)});const S=Ht=>{const gt=u?1:0,{min:wt,max:Wt}=Ht.getLocalBounds();return ja([wt[gt],Wt[gt]])};v?h.sort((Ht,gt)=>m(Ht)-m(gt)):h.sort((Ht,gt)=>{const[wt,Wt]=S(Ht),[fe,le]=S(gt),Te=(wt+Wt)/2,Fe=(fe+le)/2;return u?Fe-Te:Te-Fe});const w=new Map(d.map(Ht=>{const{__data__:gt}=Ht,{seriesX:wt}=gt,Wt=wt.map((le,Te)=>Te),fe=ja(Wt,le=>wt[+le]);return[Ht,[fe,wt]]})),{x:E}=o,T=E!=null&&E.getBandWidth?E.getBandWidth()/2:0,M=Ht=>{const[gt]=r.invert(Ht);return gt-T},P=(Ht,gt,wt,Wt)=>{const{_x:fe}=Ht,le=fe!==void 0?E.map(fe):M(gt),Te=Wt.filter(Ur),[Fe,De]=ja([Te[0],Te[Te.length-1]]),Je=Fe===De;if(!b&&(le<Fe||le>De)&&!Je)return null;const qe=Ua(fn=>Wt[+fn]).center,We=qe(wt,le);return wt[We]},R=v?(Ht,gt)=>{const wt=Ua(m).center,Wt=wt(gt,M(Ht)),fe=gt[Wt];return $r(gt,m).get(m(fe))}:(Ht,gt)=>{const Wt=Ht[u?1:0],fe=gt.filter(Fe=>{const[De,Je]=S(Fe);return Wt>=De&&Wt<=Je});if(!b||fe.length>0)return fe;const le=Ua(Fe=>{const[De,Je]=S(Fe);return(De+Je)/2}).center,Te=le(gt,Wt);return[gt[Te]].filter(Ur)},k=(Ht,gt)=>{const{__data__:wt}=Ht;return Object.fromEntries(Object.entries(wt).filter(([Wt])=>Wt.startsWith("series")&&Wt!=="series").map(([Wt,fe])=>{const le=fe[gt];return[Q1(Wt.replace("series","")),le]}))},F=Bc(t,e);if(!F)return;const W=[F[0]-c,F[1]-l];if(!W)return;const $=R(W,h),rt=[],et=[];for(const Ht of d){const[gt,wt]=w.get(Ht),Wt=P(e,W,gt,wt);if(Wt!==null){rt.push(Ht);const fe=k(Ht,Wt),{x:le,y:Te}=fe,Fe=r.map([(le||0)+T,Te||0]);et.push([Object.assign(Object.assign({},fe),{element:Ht}),Fe])}}const ut=Array.from(new Set(et.map(Ht=>Ht[0].x))),J=ut[qf(ut,Ht=>Math.abs(Ht-M(W)))],lt=et.filter(Ht=>Ht[0].x===J),vt=[...lt.map(Ht=>Ht[0]),...$.map(Ht=>Ht.__data__)];return{selectedElements:[...rt,...$],selectedData:vt,filteredSeriesData:lt,abstractX:M}}function oS(t,e){var{elements:n,sort:r,filter:o,scale:c,coordinate:l,crosshairs:u,crosshairsX:d,crosshairsY:h,render:g,groupName:v,emitter:m,wait:_=50,leading:b=!0,trailing:S=!1,startX:w=0,startY:E=0,body:T=!0,single:M=!0,position:P,enterable:R,mount:k,bounding:F,theme:W,offset:$,disableNative:rt=!1,marker:et=!0,preserve:ut=!1,style:J={},css:lt={},clickLock:vt=!1,disableAutoHide:xt=!1}=e,Ht=Ks(e,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css","clickLock","disableAutoHide"]);const gt=n(t),wt=nn(J,Ht),Wt=kr(l),fe=Yr(l),{innerWidth:le,innerHeight:Te,width:Fe,height:De,insetLeft:Je,insetTop:qe}=l.getOptions(),We=rl(Yn=>{var ti;if(vt&&t.getAttribute(Ss))return;const ei=Bc(t,Yn);if(!ei)return;const Ar=wf(t),Bi=Ar.min[0],Si=Ar.min[1],{selectedElements:Zi,selectedData:ci,filteredSeriesData:gi,abstractX:Ei}=iS({root:t,event:Yn,elements:gt,coordinate:l,scale:c,startX:w,startY:E}),ni=du(Zi,c,v,ci,W);if(r&&ni.items.sort((Pi,Do)=>r(Pi)-r(Do)),o&&(ni.items=ni.items.filter(o)),Zi.length===0||nS(ni)){fn(Yn);return}if(T&&Q3({root:t,data:ni,x:ei[0]+Bi,y:ei[1]+Si,render:g,event:Yn,single:M,position:P,enterable:R,mount:k,bounding:F,css:lt,offset:$}),u||d||h){const Pi=wn(wt,"crosshairs"),Do=Object.assign(Object.assign({},Pi),wn(wt,"crosshairsX")),uc=Object.assign(Object.assign({},Pi),wn(wt,"crosshairsY")),ju=gi.map(Ed=>Ed[1]);d&&e4(t,ju,ei,Object.assign(Object.assign({},Do),{plotWidth:le,plotHeight:Te,mainWidth:Fe,mainHeight:De,insetLeft:Je,insetTop:qe,startX:w,startY:E,transposed:fe,polar:Wt})),h&&n4(t,ju,Object.assign(Object.assign({},uc),{plotWidth:le,plotHeight:Te,mainWidth:Fe,mainHeight:De,insetLeft:Je,insetTop:qe,startX:w,startY:E,transposed:fe,polar:Wt}))}if(et){const Pi=wn(wt,"marker");r4(t,{data:gi,style:Pi,theme:W})}const fr=(ti=gi[0])===null||ti===void 0?void 0:ti[0].x,Vr=fr!=null?fr:Ei(focus);m.emit("tooltip:show",Object.assign(Object.assign({},Yn),{nativeEvent:!0,data:Object.assign(Object.assign({},ni),{data:{x:Us(c.x,Vr,!0)}})}))},_,{leading:b,trailing:S}),fn=Yn=>{vt&&t.getAttribute(Ss)||xt||Va({root:t,single:M,emitter:m,event:Yn})},_n=()=>{ym({root:t,single:M})},An=Yn=>{var ti,{nativeEvent:ei,data:Ar,offsetX:Bi,offsetY:Si}=Yn,Zi=Ks(Yn,["nativeEvent","data","offsetX","offsetY"]);if(ei)return;const ci=(ti=Ar==null?void 0:Ar.data)===null||ti===void 0?void 0:ti.x,Ei=c.x.map(ci),[ni,fr]=l.map([Ei,.5]),Vr=wf(t),Pi=Vr.min[0],Do=Vr.min[1];We(Object.assign(Object.assign({},Zi),{offsetX:Bi!==void 0?Bi:Pi+ni,offsetY:Si!==void 0?Si:Do+fr,_x:ci}))},xn=()=>{Va({root:t,single:M,emitter:m,nativeEvent:!1})},On=()=>{Bn(),_n()},Fn=Yn=>{Bc(t,Yn)||fn(Yn)},Hn=()=>{Rn()},qn=Yn=>{vt&&t.setAttribute(Ss,!t.getAttribute(Ss)),We(Yn)},Rn=()=>{rt||(t.addEventListener("pointerdown",qn),t.addEventListener("pointerenter",We),t.addEventListener("pointermove",We),t.addEventListener("pointerleave",Fn),t.addEventListener("pointerup",fn))},Bn=()=>{rt||(t.removeEventListener("pointerdown",qn),t.removeEventListener("pointerenter",We),t.removeEventListener("pointermove",We),t.removeEventListener("pointerleave",Fn),t.removeEventListener("pointerup",fn))};return Rn(),m.on("tooltip:show",An),m.on("tooltip:hide",xn),m.on("tooltip:disable",On),m.on("tooltip:enable",Hn),()=>{Bn(),m.off("tooltip:show",An),m.off("tooltip:hide",xn),m.off("tooltip:disable",On),m.off("tooltip:enable",Hn),ut?Va({root:t,single:M,emitter:m,nativeEvent:!1}):_n()}}function c4(t,{elements:e,coordinate:n,scale:r,render:o,groupName:c,sort:l,filter:u,emitter:d,wait:h=50,leading:g=!0,trailing:v=!1,groupKey:m=J=>J,single:_=!0,position:b,enterable:S,datum:w,view:E,mount:T,bounding:M,theme:P,offset:R,shared:k=!1,body:F=!0,disableNative:W=!1,preserve:$=!1,css:rt={},clickLock:et=!1,disableAutoHide:ut=!1}){const J=e(t),lt=$r(J,m),vt=rl(Fe=>{if(et&&t.getAttribute(Ss))return;const De=rS({root:t,event:Fe,elements:J,coordinate:n,scale:r,shared:k});if(!De){ut||Va({root:t,single:_,emitter:d,event:Fe});return}const Je=m(De),qe=lt.get(Je);if(!qe)return;const We=qe.length===1&&!k?t4(qe[0]):du(qe,r,c,void 0,P);if(l&&We.items.sort((An,xn)=>l(An)-l(xn)),u&&(We.items=We.items.filter(u)),nS(We)){ut||Va({root:t,single:_,emitter:d,event:Fe});return}const{offsetX:fn,offsetY:_n}=Fe;F&&Q3({root:t,data:We,x:fn,y:_n,render:o,event:Fe,single:_,position:b,enterable:S,mount:T,bounding:M,css:rt,offset:R}),d.emit("tooltip:show",Object.assign(Object.assign({},Fe),{nativeEvent:!0,data:Object.assign(Object.assign({},We),{data:Q0(De,E)})}))},h,{leading:g,trailing:v}),xt=Fe=>{ut||Va({root:t,single:_,emitter:d,event:Fe})},Ht=Fe=>{et&&t.setAttribute(Ss,!t.getAttribute(Ss)),vt(Fe)},gt=()=>{W||(t.addEventListener("pointerdown",Ht),t.addEventListener("pointermove",vt),t.addEventListener("pointerleave",xt),t.addEventListener("pointerup",xt))},wt=()=>{W||(t.removeEventListener("pointerdown",Ht),t.removeEventListener("pointermove",vt),t.removeEventListener("pointerleave",xt),t.removeEventListener("pointerup",xt))},Wt=({nativeEvent:Fe,offsetX:De,offsetY:Je,data:qe})=>{if(Fe)return;const{data:We}=qe,fn=mp(J,We,w);if(!fn)return;const _n=fn.getBBox(),{x:An,y:xn,width:On,height:Fn}=_n,Hn=t.getBBox();vt({target:fn,offsetX:De!==void 0?De+Hn.x:An+On/2,offsetY:Je!==void 0?Je+Hn.y:xn+Fn/2})},fe=({nativeEvent:Fe}={})=>{Fe||Va({root:t,single:_,emitter:d,nativeEvent:!1})},le=()=>{wt(),ym({root:t,single:_})},Te=()=>{gt()};return d.on("tooltip:show",Wt),d.on("tooltip:hide",fe),d.on("tooltip:enable",Te),d.on("tooltip:disable",le),gt(),()=>{wt(),d.off("tooltip:show",Wt),d.off("tooltip:hide",fe),d.off("tooltip:enable",Te),d.off("tooltip:disable",le),$?Va({root:t,single:_,emitter:d,nativeEvent:!1}):ym({root:t,single:_})}}function aS(t){const{shared:e,crosshairs:n,crosshairsX:r,crosshairsY:o,series:c,name:l,item:u=()=>({}),facet:d=!1}=t,h=Ks(t,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(g,v,m)=>{const{container:_,view:b}=g,{scale:S,markState:w,coordinate:E,theme:T}=b,M=eS(w,"seriesTooltip"),P=eS(w,"crosshairs"),R=uo(_),k=Ga(c,M),F=Ga(n,P);if(h.clickLock&&!d&&R.setAttribute(Ss,!1),k&&i4(w)&&!d)return oS(R,Object.assign(Object.assign({},h),{theme:T,elements:ya,scale:S,coordinate:E,crosshairs:F,crosshairsX:Ga(Ga(r,n),!1),crosshairsY:Ga(o,F),item:u,emitter:m}));if(k&&d){const W=v.filter(vt=>vt!==g&&vt.options.parentKey===g.options.key),$=Vx(g,v),rt=W[0].view.scale,et=R.getBounds(),ut=et.min[0],J=et.min[1];Object.assign(rt,{facet:!0});const lt=R.parentNode.parentNode;return h.clickLock&&lt.setAttribute(Ss,!1),oS(lt,Object.assign(Object.assign({},h),{theme:T,elements:()=>$,scale:rt,coordinate:E,crosshairs:Ga(n,P),crosshairsX:Ga(Ga(r,n),!1),crosshairsY:Ga(o,F),item:u,startX:ut,startY:J,emitter:m}))}return c4(R,Object.assign(Object.assign({},h),{datum:vs(b),elements:ya,scale:S,coordinate:E,groupKey:e?Of(b):void 0,item:u,emitter:m,view:b,theme:T,shared:e}))}}aS.props={reapplyWhenUpdate:!0};const Qf=t=>t?parseInt(t):0;function l4(t){const e=getComputedStyle(t),n=t.clientWidth||Qf(e.width),r=t.clientHeight||Qf(e.height),o=Qf(e.paddingLeft)+Qf(e.paddingRight),c=Qf(e.paddingTop)+Qf(e.paddingBottom);return{width:n-o,height:r-c}}function sS(t){const{height:e,width:n,padding:r=0,paddingLeft:o=r,paddingRight:c=r,paddingTop:l=r,paddingBottom:u=r,margin:d=0,marginLeft:h=d,marginRight:g=d,marginTop:v=d,marginBottom:m=d,inset:_=0,insetLeft:b=_,insetRight:S=_,insetTop:w=_,insetBottom:E=_}=t,T=R=>R==="auto"?20:R,M=n-T(o)-T(c)-h-g-b-S,P=e-T(l)-T(u)-v-m-w-E;return{width:M,height:P}}function Sm(t,e){const n=[t];for(;n.length;){const r=n.shift();e&&e(r);const o=r.children||[];for(const c of o)n.push(c)}}class wm{constructor(e={},n){this.parentNode=null,this.children=[],this.index=0,this.type=n,this.value=e}map(e=n=>n){const n=e(this.value);return this.value=n,this}attr(e,n){return arguments.length===1?this.value[e]:this.map(r=>(r[e]=n,r))}append(e){const n=new e({});return n.children=[],this.push(n),n}push(e){return e.parentNode=this,e.index=this.children.length,this.children.push(e),this}remove(){const e=this.parentNode;if(e){const{children:n}=e,r=n.findIndex(o=>o===this);n.splice(r,1)}return this}getNodeByKey(e){let n=null;return Sm(this,o=>{e===o.attr("key")&&(n=o)}),n}getNodesByType(e){const n=[];return Sm(this,o=>{e===o.type&&n.push(o)}),n}getNodeByType(e){let n=null;return Sm(this,r=>{n||e===r.type&&(n=r)}),n}call(e,...n){return e(this.map(),...n),this}getRoot(){let e=this;for(;e&&e.parentNode;)e=e.parentNode;return e}}var Qs=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Om=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title","interaction"],cS="__remove__",lS="__callback__",uS=1,u4=1;function f4(t){if(t===void 0){const e=document.createElement("div");return e[cS]=!0,e}return typeof t=="string"?document.getElementById(t):t}function d4(t){const e=t.parentNode;e&&e.removeChild(t)}function h4(t){if(t.type!==null)return t;const e=t.children[t.children.length-1];for(const n of Om)e.attr(n,t.attr(n));return e}function fS(t){return Object.assign(Object.assign({},t.value),{type:t.type})}function Em(t,e){const{width:n,height:r,autoFit:o,depth:c=0}=t;let l=640,u=480;if(o){const{width:d,height:h}=l4(e);l=d||l,u=h||u}return l=n||l,u=r||u,{width:Math.max((0,Se.Z)(l)?l:uS,uS),height:Math.max((0,Se.Z)(u)?u:u4,u4),depth:c}}function p4(t){const e=h4(t),n=[e],r=new Map;for(r.set(e,fS(e));n.length;){const o=n.pop(),c=r.get(o),{children:l=[]}=o;for(const u of l)if(u.type===lS)c.children=u.value;else{const d=fS(u),{children:h=[]}=c;h.push(d),n.push(u),r.set(u,d),c.children=h}}return r.get(e)}function a8(t,e){return typeof t=="function"?!0:new Set(Object.keys(e)).has(t)}function g4(t,e){return typeof t!="function"&&new Set(Object.keys(e)).has(t)}function dS(t,e,n,r,o){const{type:c}=t,{type:l=n||c}=e;if(g4(l,o)){for(const u of Om)t.attr(u)!==void 0&&e[u]===void 0&&(e[u]=t.attr(u));return e}if(a8(l,r)){const u={type:"view"},d=Object.assign({},e);for(const h of Om)d[h]!==void 0&&(u[h]=d[h],delete d[h]);return Object.assign(Object.assign({},u),{children:[d]})}return e}function v4(t,e,n){if(typeof t=="function")return e.mark;const o=Object.assign(Object.assign({},e),n)[t];if(!o)throw new Error(`Unknown mark: ${t}.`);return o}function m4(t,e,n){if(typeof t=="function"){const d=new wm;return d.value=t,d.type=lS,d}const{type:r,children:o}=t,c=Qs(t,["type","children"]),l=v4(r,e,n),u=new l;return u.value=c,u.type=r,u}function y4(t,e){const{type:n,children:r}=e,o=Qs(e,["type","children"]);t.type===n||n===void 0?u_(t.value,o):typeof n=="string"&&(t.type=n,t.value=o)}function _4(t,e,n,r){if(!t)return;const o=[[t,e]];for(;o.length;){const[c,l]=o.shift(),u=m4(l,n,r);Array.isArray(c.children)&&c.push(u);const{children:d}=l;if(Array.isArray(d))for(const h of d)o.push([u,h]);else typeof d=="function"&&o.push([u,d])}}function hS(t,e,n,r,o){const c=dS(t,e,n,r,o),l=[[null,t,c]];for(;l.length;){const[u,d,h]=l.shift();if(!d)_4(u,h,r,o);else if(!h)d.remove();else{y4(d,h);const{children:g}=h,{children:v}=d;if(Array.isArray(g)&&Array.isArray(v)){const m=Math.max(g.length,v.length);for(let _=0;_<m;_++){const b=g[_],S=v[_];l.push([d,S,b])}}else typeof g=="function"&&l.push([d,null,g])}}}function b4(){let t,e;return[new Promise((r,o)=>{e=r,t=o}),e,t]}function x4(t,e,{key:n=e}){t.prototype[e]=function(r){return arguments.length===0?this.attr(n):this.attr(n,r)}}function S4(t,e,{key:n=e}){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(n);if(Array.isArray(r))return this.attr(n,r);const o=[...this.attr(n)||[],r];return this.attr(n,o)}}function w4(t,e,{key:n=e}){t.prototype[e]=function(r,o){if(arguments.length===0)return this.attr(n);if(arguments.length===1&&typeof r!="string")return this.attr(n,r);const c=this.attr(n)||{};return c[r]=arguments.length===1?!0:o,this.attr(n,c)}}function O4(t,e,n){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(e);if(Array.isArray(r))return this.attr(e,{items:r});if(ml(r)&&(r.title!==void 0||r.items!==void 0))return this.attr(e,r);if(r===null||r===!1)return this.attr(e,r);const o=this.attr(e)||{},{items:c=[]}=o;return c.push(r),o.items=c,this.attr(e,o)}}function E4(t,e,{ctor:n}){t.prototype[e]=function(r){const o=this.append(n);return e==="mark"&&(o.type=r),o}}function A4(t,e,{ctor:n}){t.prototype[e]=function(){return this.type=null,this.append(n)}}function Up(t){return e=>{for(const[n,r]of Object.entries(t)){const{type:o}=r;o==="value"?x4(e,n,r):o==="array"?S4(e,n,r):o==="object"?w4(e,n,r):o==="node"?E4(e,n,r):o==="container"?A4(e,n,r):o==="mix"&&O4(e,n,r)}return e}}function T4(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{type:"node",ctor:n}]))}const pS={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},Am=Object.assign(Object.assign({},pS),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),M4=Object.assign(Object.assign({},pS),{labelTransform:{type:"array"}});var C4=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c};let Zp=class extends wm{changeData(e){var n;const r=this.getRoot();if(r)return this.attr("data",e),!((n=this.children)===null||n===void 0)&&n.length&&this.children.forEach(o=>{o.attr("data",e)}),r==null?void 0:r.render()}getView(){const e=this.getRoot(),{views:n}=e.getContext();if(n!=null&&n.length)return n.find(r=>r.key===this._key)}getScale(){var e;return(e=this.getView())===null||e===void 0?void 0:e.scale}getScaleByChannel(e){const n=this.getScale();if(n)return n[e]}getCoordinate(){var e;return(e=this.getView())===null||e===void 0?void 0:e.coordinate}getTheme(){var e;return(e=this.getView())===null||e===void 0?void 0:e.theme}getGroup(){const e=this._key;return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}show(){const e=this.getGroup();e&&!e.isVisible()&&pp(e)}hide(){const e=this.getGroup();e&&e.isVisible()&&hp(e)}};Zp=C4([Up(M4)],Zp);var P4=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c};let Tm=class extends wm{changeData(e){const n=this.getRoot();if(n)return this.attr("data",e),n==null?void 0:n.render()}getMark(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(!n)return;const{markState:r}=n,o=Array.from(r.keys()).find(c=>c.key===this.attr("key"));return r.get(o)}getScale(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(n)return n==null?void 0:n.scale}getScaleByChannel(e){var n,r;const o=(n=this.getRoot())===null||n===void 0?void 0:n.getView();if(o)return(r=o==null?void 0:o.scale)===null||r===void 0?void 0:r[e]}getGroup(){const e=this.attr("key");return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}};Tm=P4([Up(Am)],Tm);var L4=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},Hp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const I4="G2_CHART_KEY";class R4 extends Zp{constructor(e){const{container:n,canvas:r,renderer:o,plugins:c,lib:l,createCanvas:u}=e,d=Hp(e,["container","canvas","renderer","plugins","lib","createCanvas"]);super(d,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailingClear=null,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=H1(()=>{this.forceFit()},300),this._renderer=o||new mE,this._plugins=c||[],this._container=f4(n),this._emitter=new Xe,this._context={library:Object.assign(Object.assign({},l),T1),emitter:this._emitter,canvas:r,createCanvas:u},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._bindAutoFit(),this._rendering=!0;const e=new Promise((c,l)=>WC(this._computedOptions(),this._context,this._createResolve(c),this._createReject(l))),[n,r,o]=b4();return e.then(r).then(()=>{if(this._trailingClear){const c=this.options();this._trailingClear(),this._trailing&&this.options(c)}}).catch(o).then(()=>{this._trailingClear=null,this._renderTrailing()}),n}options(e){if(arguments.length===0)return p4(this);const{type:n}=e;return n&&(this._previousDefinedType=n),hS(this,e,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(e,n,r){return this._emitter.on(e,n,r),this}once(e,n){return this._emitter.once(e,n),this}emit(e,...n){return this._emitter.emit(e,...n),this}off(e,n){return this._emitter.off(e,n),this}clear(e=!0){if(this._rendering){this._trailingClear=()=>{this.clear(e)},this._reset();return}const n=this.options();this.emit(Ir.BEFORE_CLEAR),this._reset(),Y3(n,this._context,!1,e),this.emit(Ir.AFTER_CLEAR)}destroy(){const e=this.options();this.emit(Ir.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),Y3(e,this._context,!0),this._container[cS]&&d4(this._container),this.emit(Ir.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:e,height:n}=Em(this.options(),this._container);if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(Ir.BEFORE_CHANGE_SIZE);const r=this.render();return r.then(()=>{this.emit(Ir.AFTER_CHANGE_SIZE)}),r}changeSize(e,n){if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(Ir.BEFORE_CHANGE_SIZE),this.attr("width",e),this.attr("height",n);const r=this.render();return r.then(()=>{this.emit(Ir.AFTER_CHANGE_SIZE)}),r}getDataByXY(e,n={}){const{shared:r=!1,series:o,facet:c=!1,startX:l=0,startY:u=0}=n,{canvas:d,views:h}=this._context,{document:g}=d,{x:v,y:m}=e,{coordinate:_,scale:b,markState:S,data:w,key:E}=h[0],T=g.getElementsByClassName(cn),M=r?et=>et.__data__.x:et=>et,P=$r(T,M),R=g.getElementsByClassName(Jt)[0],k=uo(R),F=et=>Array.from(et.values()).some(ut=>{var J,lt;return((J=ut.interaction)===null||J===void 0?void 0:J.seriesTooltip)||((lt=ut.channels)===null||lt===void 0?void 0:lt.some(vt=>vt.name==="series"&&vt.values!==void 0))}),W=Ga(o,F(S)),$=et=>er(et,"__data__.data",null),rt=et=>et.map($);try{if(W&&F(S)&&!c){const{selectedData:lt}=iS({root:k,event:{offsetX:v,offsetY:m},elements:T,coordinate:_,scale:b,startX:l,startY:u}),vt=w.get(`${E}-0`);return lt.map(({index:xt})=>vt[xt])}const et=rS({root:k,event:{offsetX:v,offsetY:m},elements:T,coordinate:_,scale:b,shared:r});if($d(et))return Q0(et,w.get(E));const ut=M(et),J=P.get(ut);return J?rt(J):[]}catch(et){const ut=d.document.elementFromPointSync(v,m);return ut?$(ut):[]}}_create(){const{library:e}=this._context,n=c=>c.startsWith("mark.")||c==="component.axisX"||c==="component.axisY"||c==="component.legends",r=["mark.mark",...Object.keys(e).filter(n)];this._marks={};for(const c of r){const l=c.split(".").pop();class u extends Tm{constructor(){super({},l)}}this._marks[l]=u,this[l]=function(d){const h=this.append(u);return l==="mark"&&(h.type=d),h}}const o=["composition.view",...Object.keys(e).filter(c=>c.startsWith("composition.")&&c!=="composition.mark")];this._compositions=Object.fromEntries(o.map(c=>{const l=c.split(".").pop();let u=class extends Zp{constructor(){super({},l)}};return u=L4([Up(T4(this._marks))],u),[l,u]}));for(const c of Object.values(this._compositions))Up(T4(this._compositions))(c);for(const c of o){const l=c.split(".").pop();this[l]=function(){const u=this._compositions[l];return this.type=null,this.append(u)}}}_reset(){const e=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([n])=>n.startsWith("margin")||n.startsWith("padding")||n.startsWith("inset")||e.includes(n))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const e=this._trailingResolve.bind(this);this._trailingResolve=null,e(this)}).catch(e=>{const n=this._trailingReject.bind(this);this._trailingReject=null,n(e)}))}_createResolve(e){return()=>{this._rendering=!1,e(this)}}_createReject(e){return n=>{this._rendering=!1,e(n)}}_computedOptions(){const e=this.options(),{key:n=I4}=e,{width:r,height:o,depth:c}=Em(e,this._container);return this._width=r,this._height=o,this._key=n,Object.assign(Object.assign({key:this._key},e),{width:r,height:o,depth:c})}_createCanvas(){var e,n;const{width:r,height:o}=Em(this.options(),this._container);this._plugins.push(new U1),this._plugins.forEach(l=>this._renderer.registerPlugin(l)),this._context.canvas=new N.Xz({container:this._container,width:r,height:o,renderer:this._renderer});const c=(n=(e=this._context.canvas)===null||e===void 0?void 0:e.getContextService())===null||n===void 0?void 0:n.getDomElement();c&&(c.style.display="block")}_addToTrailing(){var e;return(e=this._trailingResolve)===null||e===void 0||e.call(this,this),this._trailing=!0,new Promise((r,o)=>{this._trailingResolve=r,this._trailingReject=o})}_bindAutoFit(){const e=this.options(),{autoFit:n}=e;if(this._hasBindAutoFit){n||this._unbindAutoFit();return}n&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function k4(t,e){class n extends t{constructor(o){super(Object.assign(Object.assign({},o),{lib:e}))}}return n}var D4=Object.prototype.hasOwnProperty,Wp=function(t,e){if(t===null||!is(t))return{};var n={};return Lh(e,function(r){D4.call(t,r)&&(n[r]=t[r])}),n};function N4(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Jf(t,e,n,r,o){for(var c=t.children,l,u=-1,d=c.length,h=t.value&&(r-e)/t.value;++u<d;)l=c[u],l.y0=n,l.y1=o,l.x0=e,l.x1=e+=l.value*h}function F4(){var t=1,e=1,n=0,r=!1;function o(l){var u=l.height+1;return l.x0=l.y0=n,l.x1=t,l.y1=e/u,l.eachBefore(c(e,u)),r&&l.eachBefore(N4),l}function c(l,u){return function(d){d.children&&Jf(d,d.x0,l*(d.depth+1)/u,d.x1,l*(d.depth+2)/u);var h=d.x0,g=d.y0,v=d.x1-n,m=d.y1-n;v<h&&(h=v=(h+v)/2),m<g&&(g=m=(g+m)/2),d.x0=h,d.y0=g,d.x1=v,d.y1=m}}return o.round=function(l){return arguments.length?(r=!!l,o):r},o.size=function(l){return arguments.length?(t=+l[0],e=+l[1],o):[t,e]},o.padding=function(l){return arguments.length?(n=+l,o):n},o}var s8=L(9783);function B4(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function j4(){return this.eachAfter(B4)}var Mm=L(64599);function z4(t,e){var n=-1,r=Mm(this),o;try{for(r.s();!(o=r.n()).done;){var c=o.value;t.call(e,c,++n,this)}}catch(l){r.e(l)}finally{r.f()}return this}function U4(t,e){for(var n=this,r=[n],o,c,l=-1;n=r.pop();)if(t.call(e,n,++l,this),o=n.children)for(c=o.length-1;c>=0;--c)r.push(o[c]);return this}function gS(t,e){for(var n=this,r=[n],o=[],c,l,u,d=-1;n=r.pop();)if(o.push(n),c=n.children)for(l=0,u=c.length;l<u;++l)r.push(c[l]);for(;n=o.pop();)t.call(e,n,++d,this);return this}function Cm(t,e){var n=-1,r=Mm(this),o;try{for(r.s();!(o=r.n()).done;){var c=o.value;if(t.call(e,c,++n,this))return c}}catch(l){r.e(l)}finally{r.f()}}function Z4(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,o=r&&r.length;--o>=0;)n+=r[o].value;e.value=n})}function H4(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function vS(t){for(var e=this,n=mS(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var o=r.length;t!==n;)r.splice(o,0,t),t=t.parent;return r}function mS(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),o=null;for(t=n.pop(),e=r.pop();t===e;)o=t,t=n.pop(),e=r.pop();return o}function W4(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function V4(){return Array.from(this)}function yS(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Vp(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}var _S=L(15009),hu=_S().mark(bS);function bS(){var t,e,n,r,o,c;return _S().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=this,n=[t];case 1:e=n.reverse(),n=[];case 2:if(!(t=e.pop())){u.next=8;break}return u.next=5,t;case 5:if(r=t.children)for(o=0,c=r.length;o<c;++o)n.push(r[o]);u.next=2;break;case 8:if(n.length){u.next=1;break}case 9:case"end":return u.stop()}},hu,this)}function pu(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=an)):e===void 0&&(e=$4);for(var n=new gu(t),r,o=[n],c,l,u,d;r=o.pop();)if((l=e(r.data))&&(d=(l=Array.from(l)).length))for(r.children=l,u=d-1;u>=0;--u)o.push(c=l[u]=new gu(l[u])),c.parent=r,c.depth=r.depth+1;return n.eachBefore(xS)}function G4(){return pu(this).eachBefore(Y4)}function $4(t){return t.children}function an(t){return Array.isArray(t)?t[1]:null}function Y4(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function xS(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function gu(t){this.data=t,this.depth=this.height=0,this.parent=null}gu.prototype=pu.prototype=s8({constructor:gu,count:j4,each:z4,eachAfter:gS,eachBefore:U4,find:Cm,sum:Z4,sort:H4,path:vS,ancestors:W4,descendants:V4,leaves:yS,links:Vp,copy:G4},Symbol.iterator,bS);function Gp(t,e){for(var n in e)e.hasOwnProperty(n)&&n!=="constructor"&&e[n]!==void 0&&(t[n]=e[n])}function SS(t,e,n,r){return e&&Gp(t,e),n&&Gp(t,n),r&&Gp(t,r),t}const X4={field:"value",size:[1,1],round:!1,padding:0,sort:(t,e)=>e.value-t.value,as:["x","y"],ignoreParentValue:!0},wS="nodeIndex",ws="childNodeCount",q4="nodeAncestor",Pm="Invalid field: it must be a string!";function K4(t,e){const{field:n,fields:r}=t;if((0,Ze.Z)(n))return n;if((0,Br.Z)(n))return console.warn(Pm),n[0];if(console.warn(`${Pm} will try to get fields instead.`),(0,Ze.Z)(r))return r;if((0,Br.Z)(r)&&r.length)return r[0];if(e)return e;throw new TypeError(Pm)}function Q4(t){const e=[];if(t&&t.each){let n,r;t.each(o=>{var c,l;o.parent!==n?(n=o.parent,r=0):r+=1;const u=hs((((c=o.ancestors)===null||c===void 0?void 0:c.call(o))||[]).map(d=>e.find(h=>h.name===d.name)||d),({depth:d})=>d>0&&d<o.depth);o[q4]=u,o[ws]=((l=o.children)===null||l===void 0?void 0:l.length)||0,o[wS]=r,e.push(o)})}else t&&t.eachNode&&t.eachNode(n=>{e.push(n)});return e}function J4(t,e){e=SS({},X4,e);const n=e.as;if(!(0,Br.Z)(n)||n.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let r;try{r=K4(e)}catch(d){console.warn(d)}const c=(d=>F4().size(e.size).round(e.round).padding(e.padding)(pu(d).sum(h=>Fl(h.children)?e.ignoreParentValue?0:h[r]-gb(h.children,(g,v)=>g+v[r],0):h[r]).sort(e.sort)))(t),l=n[0],u=n[1];return c.each(d=>{var h,g;d[l]=[d.x0,d.x1,d.x1,d.x0],d[u]=[d.y1,d.y1,d.y0,d.y0],d.name=d.name||((h=d.data)===null||h===void 0?void 0:h.name)||((g=d.data)===null||g===void 0?void 0:g.label),d.data.name=d.name,["x0","x1","y0","y1"].forEach(v=>{n.indexOf(v)===-1&&delete d[v]})}),Q4(c)}var Lm=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const vu="sunburst",Im="markType",Rm="value",OS="path",$p="ancestor-node";function tP(t){const{data:e,encode:n}=t,{color:r,value:o}=n,l=J4(e,{field:o,type:"hierarchy.partition",as:["x","y"]}),u=[];return l.forEach(d=>{var h,g,v,m;if(d.depth===0)return null;let _=d.data.name;const b=[_];let S=Object.assign({},d);for(;S.depth>1;)_=`${(h=S.parent.data)===null||h===void 0?void 0:h.name} / ${_}`,b.unshift((g=S.parent.data)===null||g===void 0?void 0:g.name),S=S.parent;const w=Object.assign(Object.assign(Object.assign({},Wp(d.data,[o])),{[OS]:_,[$p]:S.data.name}),d);r&&r!==$p&&(w[r]=d.data[r]||((m=(v=d.parent)===null||v===void 0?void 0:v.data)===null||m===void 0?void 0:m[r])),u.push(w)}),u.map(d=>{const h=d.x.slice(0,2),g=[d.y[2],d.y[0]];return h[0]===h[1]&&(g[0]=g[1]=(d.y[2]+d.y[0])/2),Object.assign(Object.assign({},d),{x:h,y:g,fillOpacity:Math.pow(.85,d.depth)})})}const km={id:vu,encode:{x:"x",y:"y",key:OS,color:$p,value:"value"},axis:{x:!1,y:!1},style:{[Im]:vu,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[ws]:ws,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},ES=t=>{const{encode:e,data:n=[]}=t,r=Lm(t,["encode","data"]),o=Object.assign(Object.assign({},r.coordinate),{innerRadius:Math.max(er(r,["coordinate","innerRadius"],.2),1e-5)}),c=Object.assign(Object.assign({},km.encode),e),{value:l}=c,u=tP({encode:c,data:n});return[nn({},km,Object.assign(Object.assign({type:"rect",data:u,encode:c,tooltip:{title:"path",items:[d=>({name:l,value:d[l]})]}},r),{coordinate:o}))]};ES.props={};var eP=Object.keys?function(t){return Object.keys(t)}:function(t){var e=[];return Lh(t,function(n,r){(0,Eo.Z)(t)&&r==="prototype"||e.push(r)}),e},td=eP,Yp=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const mu=t=>t.querySelectorAll(".element").filter(e=>er(e,["style",Im])===vu);function nP(t){return Kn(t).select(`.${ct}`).node()}const rP={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function Xp(t={}){const{breadCrumb:e={},isFixedColor:n=!1}=t,r=nn({},rP,e);return o=>{const{update:c,setState:l,container:u,view:d,options:h}=o,g=u.ownerDocument,v=nP(u),m=h.marks.find(({id:M})=>M===vu),{state:_}=m,b=g.createElement("g");v.appendChild(b);const S=(M,P)=>Yp(this,void 0,void 0,function*(){if(b.removeChildren(),M){const R=g.createElement("text",{style:Object.assign({x:0,text:r.rootText,depth:0},r.style)});b.appendChild(R);let k="";const F=M==null?void 0:M.split(" / ");let W=r.style.y,$=b.getBBox().width;const rt=v.getBBox().width,et=F.map((ut,J)=>{const lt=g.createElement("text",{style:Object.assign(Object.assign({x:$,text:" / "},r.style),{y:W})});b.appendChild(lt),$+=lt.getBBox().width,k=`${k}${ut} / `;const vt=g.createElement("text",{name:k.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:ut,x:$,depth:J+1},r.style),{y:W})});return b.appendChild(vt),$+=vt.getBBox().width,$>rt&&(W=b.getBBox().height,$=0,lt.attr({x:$,y:W}),$+=lt.getBBox().width,vt.attr({x:$,y:W}),$+=vt.getBBox().width),vt});[R,...et].forEach((ut,J)=>{if(J===et.length)return;const lt=Object.assign({},ut.attributes);ut.attr("cursor","pointer"),ut.addEventListener("mouseenter",()=>{ut.attr(r.active)}),ut.addEventListener("mouseleave",()=>{ut.attr(lt)}),ut.addEventListener("click",()=>{S(ut.name,er(ut,["style","depth"]))})})}l("drillDown",R=>{const{marks:k}=R,F=k.map(W=>{if(W.id!==vu&&W.type!=="rect")return W;const{data:$}=W,rt=Object.fromEntries(["color"].map(ut=>[ut,{domain:d.scale[ut].getOptions().domain}])),et=$.filter(ut=>{const J=ut.path;return n||(ut[$p]=J.split(" / ")[P]),M?new RegExp(`^${M}.+`).test(J):!0});return nn({},W,n?{data:et,scale:rt}:{data:et})});return Object.assign(Object.assign({},R),{marks:F})}),yield c()}),w=M=>{const P=M.target;if(er(P,["style",Im])!==vu||er(P,["markType"])!=="rect"||!er(P,["style",ws]))return;const R=er(P,["__data__","key"]),k=er(P,["style","depth"]);P.style.cursor="pointer",S(R,k)};v.addEventListener("click",w);const E=td(Object.assign(Object.assign({},_.active),_.inactive)),T=()=>{mu(v).forEach(P=>{const R=er(P,["style",ws]);if(er(P,["style","cursor"])!=="pointer"&&R){P.style.cursor="pointer";const F=Wp(P.attributes,E);P.addEventListener("mouseenter",()=>{P.attr(_.active)}),P.addEventListener("mouseleave",()=>{P.attr(nn(F,_.inactive))})}})};return v.addEventListener("mousemove",T),()=>{b.remove(),v.removeEventListener("click",w),v.removeEventListener("mousemove",T)}}}function iP(){return{"interaction.drillDown":Xp,"mark.sunburst":ES}}const AS=()=>[["cartesian"]];AS.props={};const Sr=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];Sr.props={transform:!0};const TS=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},Dm=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=TS(t);return[...Sr(),...bl({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};Dm.props={};const Nm=()=>[["parallel",0,1,0,1]];Nm.props={};const ed=({focusX:t=0,focusY:e=0,distortionX:n=2,distortionY:r=2,visual:o=!1})=>[["fisheye",t,e,n,r,o]];ed.props={transform:!0};const Fm=t=>{const{startAngle:e=-Math.PI/2,endAngle:n=Math.PI*3/2,innerRadius:r=0,outerRadius:o=1}=t;return[...Nm(),...bl({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};Fm.props={};const MS=({startAngle:t=0,endAngle:e=Math.PI*6,innerRadius:n=0,outerRadius:r=1})=>[["translate",.5,.5],["reflect.y"],["translate",-.5,-.5],["helix",t,e,n,r]];MS.props={};const CS=({value:t})=>e=>e.map(()=>t);CS.props={};const PS=({value:t})=>e=>e.map(n=>n[t]);PS.props={};const LS=({value:t})=>e=>e.map(t);LS.props={};const IS=({value:t})=>()=>t;IS.props={};function Xr(t,e){if(t!==null)return{type:"column",value:t,field:e}}function nd(t,e){const n=Xr(t,e);return Object.assign(Object.assign({},n),{inferred:!0})}function qp(t,e){if(t!==null)return{type:"column",value:t,field:e,visual:!0}}function oP(t,e){const n=Xr(t,e);return Object.assign(Object.assign({},n),{constant:!1})}function Os(t,e){const n=[];for(const r of t)n[r]=e;return n}function br(t,e){const n=t[e];if(!n)return[null,null];const{value:r,field:o=null}=n;return[r,o]}function rd(t,...e){for(const n of e)if(typeof n=="string"){const[r,o]=br(t,n);if(r!==null)return[r,o]}else return[n,null];return[null,null]}function id(t){return t instanceof Date?!1:typeof t=="object"}const od=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;return r!==void 0?[t,e]:[t,nn({},e,{encode:{y1:nd(Os(t,0))}})]};od.props={};const Js=()=>(t,e)=>{const{encode:n}=e,{x:r}=n;return r!==void 0?[t,e]:[t,nn({},e,{encode:{x:nd(Os(t,0))},scale:{x:{guide:null}}})]};Js.props={};const tc=(t,e)=>Vl(Object.assign({colorAttribute:"fill"},t),e);tc.props=Object.assign(Object.assign({},Vl.props),{defaultMarker:"square"});const Kp=(t,e)=>Vl(Object.assign({colorAttribute:"stroke"},t),e);Kp.props=Object.assign(Object.assign({},Vl.props),{defaultMarker:"hollowSquare"});function yu(){}function Bm(t){this._context=t}Bm.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function Es(t){return new Bm(t)}var RS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function aP(t,e,n,r,o){const[c,l,u,d]=t;if(Yr(r)){if(o){const _=[n?n[1][0]:c[0],c[1]],b=[n?n[2][0]:d[0],d[1]];return[_,l,u,b]}const v=[e?e[0][0]:l[0],l[1]],m=[e?e[3][0]:u[0],u[1]];return[c,v,m,d]}if(o){const v=[c[0],n?n[1][1]:c[1]],m=[d[0],n?n[2][1]:d[1]];return[v,l,u,m]}const h=[l[0],e?e[0][1]:l[1]],g=[u[0],e?e[3][1]:u[1]];return[c,h,g,d]}const sP=(t,e,n)=>{const r=Math.cos(t)*e,o=Math.sin(t)*e;return{x:r*n,y:o}},ad=(t,e)=>e/Math.tan(t/2);function cP(t,e){const[n,r,o,c]=t,[l,u,d,h]=e,g=r[0]-n[0]>o[0]-c[0],v=Math.atan2(Math.abs(r[1]-o[1]),Math.abs(r[0]-o[0])),m=g?[ad(v,l),ad(v,u),d,h]:[l,u,ad(v,d),ad(v,h)],_=g?1:-1,b=m.map(S=>sP(v,S,_));return[`M${n[0]+m[0]} ${n[1]}`,`L${r[0]-m[1]} ${r[1]}`,`Q${r[0]} ${r[1]} ${r[0]-b[1].x} ${r[1]+b[1].y}`,`L${o[0]+b[2].x} ${o[1]-b[2].y}`,`Q${o[0]} ${o[1]} ${o[0]-m[2]} ${o[1]}`,`L${c[0]+m[3]} ${c[1]}`,`Q${c[0]} ${c[1]} ${c[0]-b[3].x} ${c[1]-b[3].y}`,`L${n[0]+b[0].x} ${n[1]+b[0].y}`,`Q${n[0]} ${n[1]} ${n[0]+m[0]} ${n[1]}`,"Z"].join(" ")}const jm=(t,e)=>{const{adjustPoints:n=aP,radius:r,radiusTopLeft:o=r,radiusTopRight:c=r,radiusBottomRight:l=r,radiusBottomLeft:u=r,innerRadius:d=0,innerRadiusTopLeft:h=d,innerRadiusTopRight:g=d,innerRadiusBottomRight:v=d,innerRadiusBottomLeft:m=d,first:_=!0,last:b=!0}=t,S=RS(t,["adjustPoints","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","first","last"]),{coordinate:w,document:E}=e;return(T,M,P,R)=>{const{index:k}=M,{color:F}=P,W=RS(P,["color"]),$=R[k+1],rt=R[k-1],et=n(T,$,rt,w,S.reverse),ut=!!Yr(w),[J,lt,vt,xt]=ut?cv(et):et,{color:Ht=F,opacity:gt}=M,wt=[_&&o!=null?o:h,_&&c!=null?c:g,b&&l!=null?l:v,b&&u!=null?u:m],Wt=wt.find(fe=>fe>0)?cP([J,lt,vt,xt],wt):Rc().curve(Es)([J,lt,vt,xt]);return Kn(E.createElement("path",{})).call(Zn,W).style("d",Wt).style("fill",Ht).style("fillOpacity",gt).call(Zn,S).node()}};jm.props={defaultMarker:"square"};function zm(t,e,n,r,o){const[c,l,u,d]=t;if(Yr(r)){if(o){const _=[n?n[1][0]:(c[0]+d[0])/2,c[1]],b=[n?n[2][0]:(c[0]+d[0])/2,d[1]];return[_,l,u,b]}const v=[e?e[0][0]:(l[0]+u[0])/2,l[1]],m=[e?e[3][0]:(l[0]+u[0])/2,u[1]];return[c,v,m,d]}if(o){const v=[c[0],n?n[1][1]:(c[1]+d[1])/2],m=[d[0],n?n[2][1]:(c[1]+d[1])/2];return[v,l,u,m]}const h=[l[0],e?e[0][1]:(l[1]+u[1])/2],g=[u[0],e?e[3][1]:(l[1]+u[1])/2];return[c,h,g,d]}const sd=(t,e)=>jm(Object.assign({adjustPoints:zm},t),e);sd.props={defaultMarker:"square"};function cd(t){return Math.abs(t)>10?String(t):t.toString().padStart(2,"0")}function Um(t){const e=t.getFullYear(),n=cd(t.getMonth()+1),r=cd(t.getDate()),o=`${e}-${n}-${r}`,c=t.getHours(),l=t.getMinutes(),u=t.getSeconds();return c||l||u?`${o} ${cd(c)}:${cd(l)}:${cd(u)}`:o}const Qp=(t={})=>{const{channel:e="x"}=t;return(n,r)=>{const{encode:o}=r,{tooltip:c}=r;if(Ca(c))return[n,r];const{title:l}=c;if(l!==void 0)return[n,r];const u=Object.keys(o).filter(h=>h.startsWith(e)).filter(h=>!o[h].inferred).map(h=>br(o,h)).filter(([h])=>h).map(h=>h[0]);if(u.length===0)return[n,r];const d=[];for(const h of n)d[h]={value:u.map(g=>g[h]instanceof Date?Um(g[h]):g[h]).join(", ")};return[n,nn({},r,{tooltip:{title:d}})]}};Qp.props={};const Jp=t=>{const{channel:e}=t;return(n,r)=>{const{encode:o,tooltip:c}=r;if(Ca(c))return[n,r];const{items:l=[]}=c;if(!l||l.length>0)return[n,r];const d=(Array.isArray(e)?e:[e]).flatMap(h=>Object.keys(o).filter(g=>g.startsWith(h)).map(g=>{const{field:v,value:m,inferred:_=!1,aggregate:b}=o[g];return _?null:b&&m?{channel:g}:v?{field:v}:m?{channel:g}:null}).filter(g=>g!==null));return[n,nn({},r,{tooltip:{items:d}})]}};Jp.props={};var lP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const kS=()=>(t,e)=>{const{encode:n}=e,{key:r}=n,o=lP(n,["key"]);if(r!==void 0)return[t,e];const c=Object.values(o).map(({value:u})=>u),l=t.map(u=>c.filter(Array.isArray).map(d=>d[u]).join("-"));return[t,nn({},e,{encode:{key:Xr(l)}})]};kS.props={};function Zm(t={}){const{shapes:e}=t;return[{name:"color"},{name:"opacity"},{name:"shape",range:e},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function bo(t={}){return[...Zm(t),{name:"title",scale:"identity"}]}function c8(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function $a(){return[{type:Qp,channel:"color"},{type:Jp,channel:["x","y"]}]}function _u(){return[{type:Qp,channel:"x"},{type:Jp,channel:["y"]}]}function uP(){return[{type:Qp,channel:"color"},{type:Jp,channel:["position"]}]}function Ya(t={}){return Zm(t)}function Oi(){return[{type:kS}]}function Di(){return[]}function Hm(t,e){return t.getBandWidth(t.invert(e))}function ec(t,e,n={}){const{x:r,y:o,series:c}=e,{x:l,y:u,series:d}=t,{style:{bandOffset:h=d?0:.5,bandOffsetX:g=h,bandOffsetY:v=h}={}}=n,m=!!(l!=null&&l.getBandWidth),_=!!(u!=null&&u.getBandWidth),b=!!(d!=null&&d.getBandWidth);return!m&&!_?S=>S:(S,w)=>{const E=m?Hm(l,r[w]):0,T=_?Hm(u,o[w]):0,P=b&&c?(Hm(d,c[w])/2+ +c[w])*E:0,[R,k]=S;return[R+g*E+P,k+v*T]}}function nc(t){return parseFloat(t)/100}function t0(t,e,n,r){const{x:o,y:c}=n,{innerWidth:l,innerHeight:u}=r.getOptions(),d=Array.from(t,h=>{const g=o[h],v=c[h],m=typeof g=="string"?nc(g)*l:+g,_=typeof v=="string"?nc(v)*u:+v;return[[m,_]]});return[t,d]}function ba(t){return typeof t=="function"?t:e=>e[t]}function Wm(t,e){return Array.from(t,ba(e))}function fP(t){return Array.isArray(t)?{links:t}:t&&typeof t=="object"?{links:t.links||[],nodes:t.nodes}:{links:[]}}function Vm(t,e){const n=fP(t),{source:r=v=>v.source,target:o=v=>v.target,value:c=v=>v.value}=e,{links:l,nodes:u}=n;if(!l.length)return{links:[],nodes:u||[]};const d=Wm(l,r),h=Wm(l,o),g=Wm(l,c);return{links:l.map((v,m)=>({target:h[m],source:d[m],value:g[m]})),nodes:u||Array.from(new Set([...d,...h]),v=>({key:v}))}}function ld(t,e){return t.getBandWidth(t.invert(e))}const Vo={rect:tc,hollow:Kp,funnel:jm,pyramid:sd},bu=()=>(t,e,n,r)=>{const{x:o,y1:c,series:l,size:u}=n;let{y:d}=n;d=d.map(S=>S!==void 0?S:1);const h=e.x,g=e.series,[v]=r.getSize(),m=u?u.map(S=>+S/v):null,_=u?(S,w,E)=>{const T=S+w/2,M=m[E];return[T-M/2,T+M/2]}:(S,w,E)=>[S,S+w],b=Array.from(t,S=>{const w=ld(h,o[S]),E=g?ld(g,l==null?void 0:l[S]):1,T=w*E,M=(+(l==null?void 0:l[S])||0)*w,P=+o[S]+M,[R,k]=_(P,T,S),F=+d[S],W=+c[S];return[[R,F],[k,F],[k,W],[R,W]].map(J=>r.map(J))});return[t,b]};bu.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:Vo,channels:[...bo({shapes:Object.keys(Vo)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...Oi(),{type:od},{type:Js}],postInference:[...Di(),..._u()],interaction:{shareTooltip:!0}};const ud={rect:tc,hollow:Kp},dP=()=>(t,e,n,r)=>{const{x:o,x1:c,y:l,y1:u}=n,d=Array.from(t,h=>{const g=[+o[h],+l[h]],v=[+c[h],+l[h]],m=[+c[h],+u[h]],_=[+o[h],+u[h]];return[g,v,m,_].map(b=>r.map(b))});return[t,d]};dP.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:ud,channels:[...bo({shapes:Object.keys(ud)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi(),{type:od}],postInference:[...Di(),..._u()],interaction:{shareTooltip:!0}};var hP=Go(Xh);function rc(t){this._curve=t}rc.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function Go(t){function e(n){return new rc(t(n))}return e._curve=t,e}function xu(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(Go(n)):e()._curve},t}function As(){return xu(Rc().curve(hP))}var Gm=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const $m=kc(t=>{const{d1:e,d2:n,style1:r,style2:o}=t.attributes,c=t.ownerDocument;Kn(t).maybeAppend("line",()=>c.createElement("path",{})).style("d",e).call(Zn,r),Kn(t).maybeAppend("line1",()=>c.createElement("path",{})).style("d",n).call(Zn,o)});function Ym(t,e){const n=[],r=[];let o=!1,c=null;for(const l of t)!e(l[0])||!e(l[1])?o=!0:(n.push(l),o&&(o=!1,r.push([c,l])),c=l);return[n,r]}const sa=(t,e)=>{const{curve:n,gradient:r=!1,gradientColor:o="between",defined:c=g=>!Number.isNaN(g)&&g!==void 0&&g!==null,connect:l=!1}=t,u=Gm(t,["curve","gradient","gradientColor","defined","connect"]),{coordinate:d,document:h}=e;return(g,v,m)=>{const{color:_,lineWidth:b}=m,S=Gm(m,["color","lineWidth"]),{color:w=_,size:E=b,seriesColor:T,seriesX:M,seriesY:P}=v,R=js(d,v),k=Yr(d),F=r&&T?Ic(T,M,P,r,o,k):w,W=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},S),F&&{stroke:F}),E&&{lineWidth:E}),R&&{transform:R}),u);let $;if(kr(d)){const vt=d.getCenter();$=xt=>As().angle((Ht,gt)=>jl(bi(xt[gt],vt))).radius((Ht,gt)=>pi(xt[gt],vt)).defined(([Ht,gt])=>c(Ht)&&c(gt)).curve(n)(xt)}else $=Rc().x(vt=>vt[0]).y(vt=>vt[1]).defined(([vt,xt])=>c(vt)&&c(xt)).curve(n);const[rt,et]=Ym(g,c),ut=wn(W,"connect"),J=!!et.length;if(!J||l&&!Object.keys(ut).length)return Kn(h.createElement("path",{})).style("d",$(rt)||[]).call(Zn,W).node();if(J&&!l)return Kn(h.createElement("path",{})).style("d",$(g)).call(Zn,W).node();const lt=vt=>vt.map($).join(",");return Kn(new $m).style("style1",Object.assign(Object.assign({},W),ut)).style("style2",W).style("d1",lt(et)).style("d2",$(g)).node()}};sa.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Xm=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const o=kr(n)?Es:Xh;return sa(Object.assign({curve:o},t),e)(...r)}};Xm.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"line"});function qm(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Su(t,e){this._context=t,this._k=(1-e)/6}Su.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:qm(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:qm(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var DS=function t(e){function n(r){return new Su(r,e)}return n.tension=function(r){return t(+r)},n}(0);function NS(t,e){this._context=t,this._k=(1-e)/6}NS.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:qm(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var pP=function t(e){function n(r){return new NS(r,e)}return n.tension=function(r){return t(+r)},n}(0);function gP(t,e,n){var r=t._x1,o=t._y1,c=t._x2,l=t._y2;if(t._l01_a>Yi){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,d=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/d,o=(o*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/d}if(t._l23_a>Yi){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,g=3*t._l23_a*(t._l23_a+t._l12_a);c=(c*h+t._x1*t._l23_2a-e*t._l12_2a)/g,l=(l*h+t._y1*t._l23_2a-n*t._l12_2a)/g}t._context.bezierCurveTo(r,o,c,l,t._x2,t._y2)}function FS(t,e){this._context=t,this._alpha=e}FS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:gP(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var l8=function t(e){function n(r){return e?new FS(r,e):new Su(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function BS(t,e){this._context=t,this._alpha=e}BS.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:gP(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var jS=function t(e){function n(r){return e?new BS(r,e):new NS(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function Km(t){return t<0?-1:1}function Qm(t,e,n){var r=t._x1-t._x0,o=e-t._x1,c=(t._y1-t._y0)/(r||o<0&&-0),l=(n-t._y1)/(o||r<0&&-0),u=(c*o+l*r)/(r+o);return(Km(c)+Km(l))*Math.min(Math.abs(c),Math.abs(l),.5*Math.abs(u))||0}function zS(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jm(t,e,n){var r=t._x0,o=t._y0,c=t._x1,l=t._y1,u=(c-r)/3;t._context.bezierCurveTo(r+u,o+u*e,c-u,l-u*n,c,l)}function wu(t){this._context=t}wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jm(this,this._t0,zS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Jm(this,zS(this,n=Qm(this,t,e)),n);break;default:Jm(this,this._t0,n=Qm(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function US(t){this._context=new ZS(t)}(US.prototype=Object.create(wu.prototype)).point=function(t,e){wu.prototype.point.call(this,e,t)};function ZS(t){this._context=t}ZS.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,o,c){this._context.bezierCurveTo(e,t,r,n,c,o)}};function HS(t){return new wu(t)}function vP(t){return new US(t)}var u8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const mP=(t,e)=>{const n=u8(t,[]),{coordinate:r}=e;return(...o)=>{const c=kr(r)?jS:Yr(r)?vP:HS;return sa(Object.assign({curve:c},n),e)(...o)}};mP.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"smooth"});function e0(t,e){this._context=t,this._t=e}e0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function yP(t){return new e0(t,.5)}function fd(t){return new e0(t,0)}function _P(t){return new e0(t,1)}const ty=(t,e)=>sa(Object.assign({curve:_P},t),e);ty.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"hv"});const bP=(t,e)=>sa(Object.assign({curve:fd},t),e);bP.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"vh"});const ey=(t,e)=>sa(Object.assign({curve:yP},t),e);ey.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"hvh"});var f8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function d8(t,e,n,r,o){const c=bi(n,e),l=na(c),u=l+Math.PI/2,d=[r/2*Math.cos(u),r/2*Math.sin(u)],h=[o/2*Math.cos(u),o/2*Math.sin(u)],g=[o/2*Math.cos(l),o/2*Math.sin(l)],v=[r/2*Math.cos(l),r/2*Math.sin(l)],m=yf(e,d),_=yf(n,h),b=yf(_,g),S=yf(n,g),w=bi(S,h),E=bi(n,h),T=bi(e,d),M=bi(T,v),P=bi(e,v),R=bi(m,v);t.moveTo(...m),t.lineTo(..._),t.arcTo(...b,...S,o/2),t.arcTo(...w,...E,o/2),t.lineTo(...T),t.arcTo(...M,...P,r/2),t.arcTo(...R,...m,r/2),t.closePath()}const ny=(t,e)=>{const{document:n}=e;return(r,o,c)=>{const{seriesSize:l,color:u}=o,{color:d}=c,h=f8(c,["color"]),g=va();for(let v=0;v<r.length-1;v++){const m=r[v],_=r[v+1],b=l[v],S=l[v+1];[...m,..._].every(Ur)&&d8(g,m,_,b,S)}return Kn(n.createElement("path",{})).call(Zn,h).style("fill",u||d).style("d",g.toString()).call(Zn,t).node()}};ny.props=Object.assign(Object.assign({},sa.props),{defaultMarker:"line"});const n0=()=>(t,e)=>{const{style:n={},encode:r}=e,{series:o}=r,{gradient:c}=n;return!c||o?[t,e]:[t,nn({},e,{encode:{series:qp(Os(t,void 0))}})]};n0.props={};const ry=()=>(t,e)=>{const{encode:n}=e,{series:r,color:o}=n;if(r!==void 0||o===void 0)return[t,e];const[c,l]=br(n,"color");return[t,nn({},e,{encode:{series:Xr(c,l)}})]};ry.props={};const WS={line:Xm,smooth:mP,hv:ty,vh:bP,hvh:ey,trail:ny},h8=(t,e,n,r)=>{var o,c;const{series:l,x:u,y:d}=n,{x:h,y:g}=e;if(u===void 0||d===void 0)throw new Error("Missing encode for x or y channel.");const v=l?Array.from($r(t,w=>l[w]).values()):[t],m=v.map(w=>w[0]).filter(w=>w!==void 0),_=(((o=h==null?void 0:h.getBandWidth)===null||o===void 0?void 0:o.call(h))||0)/2,b=(((c=g==null?void 0:g.getBandWidth)===null||c===void 0?void 0:c.call(g))||0)/2,S=Array.from(v,w=>w.map(E=>r.map([+u[E]+_,+d[E]+b])));return[m,S,v]},xP=(t,e,n,r)=>{const o=Object.entries(n).filter(([l])=>l.startsWith("position")).map(([,l])=>l);if(o.length===0)throw new Error("Missing encode for position channel.");kr(r)&&o.push(o[0]);const c=Array.from(t,l=>{const u=o.map(g=>+g[l]),d=r.map(u),h=[];for(let g=0;g<d.length;g+=2)h.push([d[g],d[g+1]]);return h});return[t,c]},VS=()=>(t,e,n,r)=>(xl(r)?xP:h8)(t,e,n,r);VS.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:WS,channels:[...bo({shapes:Object.keys(WS)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...Oi(),{type:n0},{type:ry}],postInference:[...Di(),..._u(),...uP()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var iy=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function qr(t,e,n,r){if(e.length===1)return;const{size:o}=n;if(t==="fixed")return o;if(t==="normal"||T_(r)){const[[c,l],[u,d]]=e,h=Math.abs((u-c)/2),g=Math.abs((d-l)/2);return Math.max(0,(h+g)/2)}return o}const gr=(t,e)=>{const{colorAttribute:n,symbol:r,mode:o="auto"}=t,c=iy(t,["colorAttribute","symbol","mode"]),l=pc.get(lv(r))||pc.get("point"),{coordinate:u,document:d}=e;return(h,g,v)=>{const{lineWidth:m,color:_}=v,b=c.stroke?m||1:m,{color:S=_,transform:w,opacity:E}=g,[T,M]=_x(h),R=qr(o,h,g,u)||c.r||v.r;return Kn(d.createElement("path",{})).call(Zn,v).style("fill","transparent").style("d",l(T,M,R)).style("lineWidth",b).style("transform",w).style("transformOrigin",`${T-R} ${M-R}`).style("stroke",S).style(yx(t),E).style(n,S).call(Zn,c).node()}};gr.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const GS=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"point"},t),e);GS.props=Object.assign({defaultMarker:"hollowPoint"},gr.props);const $S=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"diamond"},t),e);$S.props=Object.assign({defaultMarker:"hollowDiamond"},gr.props);const YS=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},t),e);YS.props=Object.assign({defaultMarker:"hollowHexagon"},gr.props);const r0=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"square"},t),e);r0.props=Object.assign({defaultMarker:"hollowSquare"},gr.props);const il=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},t),e);il.props=Object.assign({defaultMarker:"hollowTriangleDown"},gr.props);const i0=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"triangle"},t),e);i0.props=Object.assign({defaultMarker:"hollowTriangle"},gr.props);const o0=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},t),e);o0.props=Object.assign({defaultMarker:"hollowBowtie"},gr.props);var SP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const XS=(t,e)=>{const{colorAttribute:n,mode:r="auto"}=t,o=SP(t,["colorAttribute","mode"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{lineWidth:g,color:v}=h,m=o.stroke?g||1:g,{color:_=v,transform:b,opacity:S}=d,[w,E]=_x(u),M=qr(r,u,d,c)||o.r||h.r;return Kn(l.createElement("circle",{})).call(Zn,h).style("fill","transparent").style("cx",w).style("cy",E).style("r",M).style("lineWidth",m).style("transform",b).style("transformOrigin",`${w} ${E}`).style("stroke",_).style(yx(t),S).style(n,_).call(Zn,o).node()}},a0=(t,e)=>XS(Object.assign({colorAttribute:"fill"},t),e);a0.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const oy=(t,e)=>XS(Object.assign({colorAttribute:"stroke"},t),e);oy.props=Object.assign({defaultMarker:"hollowPoint"},a0.props);const dd=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"point"},t),e);dd.props=Object.assign({defaultMarker:"point"},gr.props);const ay=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"plus"},t),e);ay.props=Object.assign({defaultMarker:"plus"},gr.props);const sy=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"diamond"},t),e);sy.props=Object.assign({defaultMarker:"diamond"},gr.props);const s0=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"square"},t),e);s0.props=Object.assign({defaultMarker:"square"},gr.props);const ic=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"triangle"},t),e);ic.props=Object.assign({defaultMarker:"triangle"},gr.props);const c0=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"hexagon"},t),e);c0.props=Object.assign({defaultMarker:"hexagon"},gr.props);const qS=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"cross"},t),e);qS.props=Object.assign({defaultMarker:"cross"},gr.props);const cy=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"bowtie"},t),e);cy.props=Object.assign({defaultMarker:"bowtie"},gr.props);const ly=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},t),e);ly.props=Object.assign({defaultMarker:"hyphen"},gr.props);const hd=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"line"},t),e);hd.props=Object.assign({defaultMarker:"line"},gr.props);const KS=(t,e)=>gr(Object.assign({colorAttribute:"stroke",symbol:"tick"},t),e);KS.props=Object.assign({defaultMarker:"tick"},gr.props);const QS=(t,e)=>gr(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},t),e);QS.props=Object.assign({defaultMarker:"triangleDown"},gr.props);const Ou=()=>(t,e)=>{const{encode:n}=e,{y:r}=n;return r!==void 0?[t,e]:[t,nn({},e,{encode:{y:nd(Os(t,0))},scale:{y:{guide:null}}})]};Ou.props={};const Eu=()=>(t,e)=>{const{encode:n}=e,{size:r}=n;return r!==void 0?[t,e]:[t,nn({},e,{encode:{size:qp(Os(t,3))}})]};Eu.props={};const uy={hollow:GS,hollowDiamond:$S,hollowHexagon:YS,hollowSquare:r0,hollowTriangleDown:il,hollowTriangle:i0,hollowBowtie:o0,hollowCircle:oy,point:dd,plus:ay,diamond:sy,square:s0,triangle:ic,hexagon:c0,cross:qS,bowtie:cy,hyphen:ly,line:hd,tick:KS,triangleDown:QS,circle:a0},wP=t=>(e,n,r,o)=>{const{x:c,y:l,x1:u,y1:d,size:h,dx:g,dy:v}=r,[m,_]=o.getSize(),b=ec(n,r,t),S=E=>{const T=+((g==null?void 0:g[E])||0),M=+((v==null?void 0:v[E])||0),P=u?(+c[E]+ +u[E])/2:+c[E],R=d?(+l[E]+ +d[E])/2:+l[E],k=P+T,F=R+M;return[k,F]},w=h?Array.from(e,E=>{const[T,M]=S(E),P=+h[E],R=P/m,k=P/_,F=[T-R,M-k],W=[T+R,M+k];return[o.map(b(F,E)),o.map(b(W,E))]}):Array.from(e,E=>[o.map(b(S(E),E))]);return[e,w]};wP.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:uy,channels:[...bo({shapes:Object.keys(uy)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...Oi(),{type:Js},{type:Ou}],postInference:[...Di(),{type:Eu},...$a()]};const OP=(t,e)=>{const{coordinate:n}=e;return(r,o,c)=>{const{color:l,text:u="",fontSize:d,rotate:h=0,transform:g=""}=o,v={text:String(u),stroke:l,fill:l,fontSize:d},[[m,_]]=r;return Kn(new fv).style("x",m).style("y",_).call(Zn,c).style("transform",`${g}rotate(${+h})`).style("coordCenter",n.getCenter()).call(Zn,v).call(Zn,t).node()}};OP.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var JS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function p8(t){const e=t/Math.sqrt(2),n=t*Math.sqrt(2),[r,o]=[-e,e-n],[c,l]=[0,0],[u,d]=[e,e-n];return[["M",r,o],["A",t,t,0,1,1,u,d],["L",c,l],["Z"]]}function EP(t){const{min:e,max:n}=t.getLocalBounds();return[(e[0]+n[0])*.5,(e[1]+n[1])*.5]}const g8=kc(t=>{const e=t.attributes,{class:n,x:r,y:o,transform:c}=e,l=JS(e,["class","x","y","transform"]),u=wn(l,"marker"),{size:d=24}=u,h=()=>p8(d/2),g=Kn(t).maybeAppend("marker",()=>new Er({})).call(_=>_.node().update(Object.assign({symbol:h},u))).node(),[v,m]=EP(g);Kn(t).maybeAppend("text","text").style("x",v).style("y",m).call(Zn,l)}),tw=(t,e)=>{const n=JS(t,[]);return(r,o,c)=>{const{color:l}=c,u=JS(c,["color"]),{color:d=l,text:h=""}=o,g={text:String(h),stroke:d,fill:d},[[v,m]]=r;return Kn(new g8).call(Zn,u).style("transform",`translate(${v},${m})`).call(Zn,g).call(Zn,n).node()}};tw.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const AP=(t,e)=>{const{coordinate:n}=e;return(r,o,c)=>{const{color:l,text:u="",fontSize:d,rotate:h=0,transform:g=""}=o,v={text:String(u),stroke:l,fill:l,fontSize:d,textAlign:"center",textBaseline:"middle"},[[m,_]]=r;return Kn(new N.xv).style("x",m).style("y",_).call(Zn,c).style("transformOrigin","center center").style("transform",`${g}rotate(${h}deg)`).style("coordCenter",n.getCenter()).call(Zn,v).call(Zn,t).node()}};AP.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const fy=()=>(t,e)=>{const{data:n}=e;if(!Array.isArray(n)||n.some(id))return[t,e];const r=Array.isArray(n[0])?n:[n],o=r.map(l=>l[0]),c=r.map(l=>l[1]);return[t,nn({},e,{encode:{x:Xr(o),y:Xr(c)}})]};fy.props={};var TP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const l0=()=>(t,e)=>{const{data:n,style:r={}}=e,o=TP(e,["data","style"]),{x:c,y:l}=r,u=TP(r,["x","y"]);if(c==null||l==null)return[t,e];const d=c||0,h=l||0;return[[0],nn({},o,{data:[0],cartesian:!0,encode:{x:Xr([d]),y:Xr([h])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:u})]};l0.props={};const ew={text:OP,badge:tw,tag:AP},nw=t=>{const{cartesian:e=!1}=t;return e?t0:(n,r,o,c)=>{const{x:l,y:u}=o,d=ec(r,o,t),h=Array.from(n,g=>{const v=[+l[g],+u[g]];return[c.map(d(v,g))]});return[n,h]}};nw.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:ew,channels:[...bo({shapes:Object.keys(ew)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...Oi(),{type:fy},{type:l0}],postInference:[...Di(),...$a()]};const dy=()=>(t,e)=>[t,nn({scale:{x:{padding:0},y:{padding:0}}},e)];dy.props={};const MP={cell:tc,hollow:Kp},CP=()=>(t,e,n,r)=>{const{x:o,y:c}=n,l=e.x,u=e.y,d=Array.from(t,h=>{const g=l.getBandWidth(l.invert(+o[h])),v=u.getBandWidth(u.invert(+c[h])),m=+o[h],_=+c[h],b=[m,_],S=[m+g,_],w=[m+g,_+v],E=[m,_+v];return[b,S,w,E].map(T=>r.map(T))});return[t,d]};CP.props={defaultShape:"cell",defaultLabelShape:"label",shape:MP,composite:!1,channels:[...bo({shapes:Object.keys(MP)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...Oi(),{type:Js},{type:Ou},{type:dy}],postInference:[...Di(),...$a()]};function pd(t,e,n){var r=null,o=oi(!0),c=null,l=Xh,u=null,d=Ox(h);t=typeof t=="function"?t:t===void 0?Ex:oi(+t),e=typeof e=="function"?e:oi(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Ax:oi(+n);function h(v){var m,_,b,S=(v=Fa(v)).length,w,E=!1,T,M=new Array(S),P=new Array(S);for(c==null&&(u=l(T=d())),m=0;m<=S;++m){if(!(m<S&&o(w=v[m],m,v))===E)if(E=!E)_=m,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),b=m-1;b>=_;--b)u.point(M[b],P[b]);u.lineEnd(),u.areaEnd()}E&&(M[m]=+t(w,m,v),P[m]=+e(w,m,v),u.point(r?+r(w,m,v):M[m],n?+n(w,m,v):P[m]))}if(T)return u=null,T+""||null}function g(){return Rc().defined(o).curve(l).context(c)}return h.x=function(v){return arguments.length?(t=typeof v=="function"?v:oi(+v),r=null,h):t},h.x0=function(v){return arguments.length?(t=typeof v=="function"?v:oi(+v),h):t},h.x1=function(v){return arguments.length?(r=v==null?null:typeof v=="function"?v:oi(+v),h):r},h.y=function(v){return arguments.length?(e=typeof v=="function"?v:oi(+v),n=null,h):e},h.y0=function(v){return arguments.length?(e=typeof v=="function"?v:oi(+v),h):e},h.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:oi(+v),h):n},h.lineX0=h.lineY0=function(){return g().x(t).y(e)},h.lineY1=function(){return g().x(t).y(n)},h.lineX1=function(){return g().x(r).y(e)},h.defined=function(v){return arguments.length?(o=typeof v=="function"?v:oi(!!v),h):o},h.curve=function(v){return arguments.length?(l=v,c!=null&&(u=l(c)),h):l},h.context=function(v){return arguments.length?(v==null?c=u=null:u=l(c=v),h):c},h}function rw(){var t=pd().curve(hP),e=t.curve,n=t.lineX0,r=t.lineX1,o=t.lineY0,c=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return xu(n())},delete t.lineX0,t.lineEndAngle=function(){return xu(r())},delete t.lineX1,t.lineInnerRadius=function(){return xu(o())},delete t.lineY0,t.lineOuterRadius=function(){return xu(c())},delete t.lineY1,t.curve=function(l){return arguments.length?e(Go(l)):e()._curve},t}var hy=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function v8(t,e){const n=[],r=[],o=[];let c=!1,l=null;const u=t.length/2;for(let d=0;d<u;d++){const h=t[d],g=t[d+u];if([...h,...g].some(v=>!e(v)))c=!0;else{if(n.push(h),r.push(g),c&&l){c=!1;const[v,m]=l;o.push([v,h,m,g])}l=[h,g]}}return[n.concat(r),o]}const PP=kc(t=>{const{areaPath:e,connectPath:n,areaStyle:r,connectStyle:o}=t.attributes,c=t.ownerDocument;Kn(t).maybeAppend("connect-path",()=>c.createElement("path",{})).style("d",n).call(Zn,o),Kn(t).maybeAppend("area-path",()=>c.createElement("path",{})).style("d",e).call(Zn,r)}),Xa=(t,e)=>{const{curve:n,gradient:r=!1,defined:o=h=>!Number.isNaN(h)&&h!==void 0&&h!==null,connect:c=!1}=t,l=hy(t,["curve","gradient","defined","connect"]),{coordinate:u,document:d}=e;return(h,g,v)=>{const{color:m}=v,{color:_=m,seriesColor:b,seriesX:S,seriesY:w}=g,E=Yr(u),T=js(u,g),M=r&&b?Ic(b,S,w,r,void 0,E):_,P=Object.assign(Object.assign(Object.assign(Object.assign({},v),{stroke:M,fill:M}),T&&{transform:T}),l),[R,k]=v8(h,o),F=wn(P,"connect"),W=!!k.length,$=rt=>Kn(d.createElement("path",{})).style("d",rt||"").call(Zn,P).node();if(kr(u)){const rt=et=>{const ut=u.getCenter(),J=et.slice(0,et.length/2),lt=et.slice(et.length/2);return rw().angle((vt,xt)=>jl(bi(J[xt],ut))).outerRadius((vt,xt)=>pi(J[xt],ut)).innerRadius((vt,xt)=>pi(lt[xt],ut)).defined((vt,xt)=>[...J[xt],...lt[xt]].every(o)).curve(n)(lt)};return!W||c&&!Object.keys(F).length?$(rt(R)):W&&!c?$(rt(h)):Kn(new PP).style("areaStyle",P).style("connectStyle",Object.assign(Object.assign({},F),l)).style("areaPath",rt(h)).style("connectPath",k.map(rt).join("")).node()}else{const rt=et=>{const ut=et.slice(0,et.length/2),J=et.slice(et.length/2);return E?pd().y((lt,vt)=>ut[vt][1]).x1((lt,vt)=>ut[vt][0]).x0((lt,vt)=>J[vt][0]).defined((lt,vt)=>[...ut[vt],...J[vt]].every(o)).curve(n)(ut):pd().x((lt,vt)=>ut[vt][0]).y1((lt,vt)=>ut[vt][1]).y0((lt,vt)=>J[vt][1]).defined((lt,vt)=>[...ut[vt],...J[vt]].every(o)).curve(n)(ut)};return!W||c&&!Object.keys(F).length?$(rt(R)):W&&!c?$(rt(h)):Kn(new PP).style("areaStyle",P).style("connectStyle",Object.assign(Object.assign({},F),l)).style("areaPath",rt(h)).style("connectPath",k.map(rt).join("")).node()}}};Xa.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const py=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const o=kr(n)?Es:Xh;return Xa(Object.assign({curve:o},t),e)(...r)}};py.props=Object.assign(Object.assign({},Xa.props),{defaultMarker:"square"});var LP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const iw=(t,e)=>{const n=LP(t,[]),{coordinate:r}=e;return(...o)=>{const c=kr(r)?jS:Yr(r)?vP:HS;return Xa(Object.assign({curve:c},n),e)(...o)}};iw.props=Object.assign(Object.assign({},Xa.props),{defaultMarker:"smooth"});const ow=(t,e)=>(...n)=>Xa(Object.assign({curve:yP},t),e)(...n);ow.props=Object.assign(Object.assign({},Xa.props),{defaultMarker:"hvh"});const IP=(t,e)=>(...n)=>Xa(Object.assign({curve:fd},t),e)(...n);IP.props=Object.assign(Object.assign({},Xa.props),{defaultMarker:"vh"});const RP=(t,e)=>(...n)=>Xa(Object.assign({curve:_P},t),e)(...n);RP.props=Object.assign(Object.assign({},Xa.props),{defaultMarker:"hv"});const kP={area:py,smooth:iw,hvh:ow,vh:IP,hv:RP},DP=()=>(t,e,n,r)=>{var o,c;const{x:l,y:u,y1:d,series:h}=n,{x:g,y:v}=e,m=h?Array.from($r(t,E=>h[E]).values()):[t],_=m.map(E=>E[0]).filter(E=>E!==void 0),b=(((o=g==null?void 0:g.getBandWidth)===null||o===void 0?void 0:o.call(g))||0)/2,S=(((c=v==null?void 0:v.getBandWidth)===null||c===void 0?void 0:c.call(v))||0)/2,w=Array.from(m,E=>{const T=E.length,M=new Array(T*2);for(let P=0;P<E.length;P++){const R=E[P];M[P]=r.map([+l[R]+b,+u[R]+S]),M[T+P]=r.map([+l[R]+b,+d[R]+S])}return M});return[_,w,m]};DP.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:kP,channels:[...bo({shapes:Object.keys(kP)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...Oi(),{type:ry},{type:od},{type:dy}],postInference:[...Di(),..._u()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const NP=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;if(r)return[t,e];const[o]=br(n,"y");return[t,nn({},e,{encode:{y1:Xr([...o])}})]};NP.props={};const FP=()=>(t,e)=>{const{encode:n}=e,{x1:r}=n;if(r)return[t,e];const[o]=br(n,"x");return[t,nn({},e,{encode:{x1:Xr([...o])}})]};FP.props={};var aw=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const gy=(t,e)=>{const{arrow:n=!0,arrowSize:r="40%"}=t,o=aw(t,["arrow","arrowSize"]),{document:c}=e;return(l,u,d)=>{const{defaultColor:h}=d,g=aw(d,["defaultColor"]),{color:v=h,transform:m}=u,[_,b]=l,S=va();if(S.moveTo(..._),S.lineTo(...b),n){const[w,E]=mI(_,b,{arrowSize:r});S.moveTo(...w),S.lineTo(...b),S.lineTo(...E)}return Kn(c.createElement("path",{})).call(Zn,g).style("d",S.toString()).style("stroke",v).style("transform",m).call(Zn,o).node()}};gy.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const sw=(t,e)=>{const{arrow:n=!1}=t;return(...r)=>gy(Object.assign(Object.assign({},t),{arrow:n}),e)(...r)};sw.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var vy=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const cw=(t,e)=>{const n=vy(t,[]),{coordinate:r,document:o}=e;return(c,l,u)=>{const{color:d}=u,h=vy(u,["color"]),{color:g=d,transform:v}=l,[m,_]=c,b=va();if(b.moveTo(m[0],m[1]),kr(r)){const S=r.getCenter();b.quadraticCurveTo(S[0],S[1],_[0],_[1])}else{const S=mx(m,_),w=pi(m,_)/2;Yh(b,m,_,S,w)}return Kn(o.createElement("path",{})).call(Zn,h).style("d",b.toString()).style("stroke",g).style("transform",v).call(Zn,n).node()}};cw.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var BP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const jP=(t,e)=>{const n=BP(t,[]),{document:r}=e;return(o,c,l)=>{const{color:u}=l,d=BP(l,["color"]),{color:h=u,transform:g}=c,[v,m]=o,_=va();return _.moveTo(v[0],v[1]),_.bezierCurveTo(v[0]/2+m[0]/2,v[1],v[0]/2+m[0]/2,m[1],m[0],m[1]),Kn(r.createElement("path",{})).call(Zn,d).style("d",_.toString()).style("stroke",h).style("transform",g).call(Zn,n).node()}};jP.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var zP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function m8(t,e,n,r){const o=va();if(kr(n)){const c=n.getCenter(),l=pi(t,c),d=(pi(e,c)-l)*r+l;return o.moveTo(t[0],t[1]),Yh(o,t,e,c,d),o.lineTo(e[0],e[1]),o}return Yr(n)?(o.moveTo(t[0],t[1]),o.lineTo(t[0]+(e[0]-t[0])*r,t[1]),o.lineTo(t[0]+(e[0]-t[0])*r,e[1]),o.lineTo(e[0],e[1]),o):(o.moveTo(t[0],t[1]),o.lineTo(t[0],t[1]+(e[1]-t[1])*r),o.lineTo(e[0],t[1]+(e[1]-t[1])*r),o.lineTo(e[0],e[1]),o)}const UP=(t,e)=>{const{cornerRatio:n=1/3}=t,r=zP(t,["cornerRatio"]),{coordinate:o,document:c}=e;return(l,u,d)=>{const{defaultColor:h}=d,g=zP(d,["defaultColor"]),{color:v=h,transform:m}=u,[_,b]=l,S=m8(_,b,o,n);return Kn(c.createElement("path",{})).call(Zn,g).style("d",S.toString()).style("stroke",v).style("transform",m).call(Zn,r).node()}};UP.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const gd={link:sw,arc:cw,smooth:jP,vhv:UP},yy=t=>(e,n,r,o)=>{const{x:c,y:l,x1:u=c,y1:d=l}=r,h=ec(n,r,t),g=e.map(v=>[o.map(h([+c[v],+l[v]],v)),o.map(h([+u[v],+d[v]],v))]);return[e,g]};yy.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:gd,channels:[...bo({shapes:Object.keys(gd)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi(),{type:NP},{type:FP}],postInference:[...Di(),...$a()]};var lw=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ZP=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u}=l,d=lw(l,["color"]),{color:h=u,src:g="",size:v=32,transform:m=""}=c;let{width:_=v,height:b=v}=t;const[[S,w]]=o,[E,T]=n.getSize();_=typeof _=="string"?nc(_)*E:_,b=typeof b=="string"?nc(b)*T:b;const M=S-Number(_)/2,P=w-Number(b)/2;return Kn(r.createElement("image",{})).call(Zn,d).style("x",M).style("y",P).style("src",g).style("stroke",h).style("transform",m).call(Zn,t).style("width",_).style("height",b).node()}};ZP.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const uw={image:ZP},_y=t=>{const{cartesian:e}=t;return e?t0:(n,r,o,c)=>{const{x:l,y:u}=o,d=ec(r,o,t),h=Array.from(n,g=>{const v=[+l[g],+u[g]];return[c.map(d(v,g))]});return[n,h]}};_y.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:uw,channels:[...bo({shapes:Object.keys(uw)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...Oi(),{type:fy},{type:l0}],postInference:[...Di(),...$a()]};var y8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function by(t,e){const n=va();if(kr(e)){const r=e.getCenter(),o=[...t,t[0]],c=o.map(l=>pi(l,r));return o.forEach((l,u)=>{if(u===0){n.moveTo(l[0],l[1]);return}const d=c[u],h=t[u-1],g=c[u-1];g!==void 0&&Math.abs(d-g)<1e-10?Yh(n,h,l,r,d):n.lineTo(l[0],l[1])}),n.closePath(),n}return uM(n,t)}const fw=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u}=l,d=y8(l,["color"]),{color:h=u,transform:g}=c,v=by(o,n);return Kn(r.createElement("path",{})).call(Zn,d).style("d",v.toString()).style("stroke",h).style("fill",h).style("transform",g).call(Zn,t).node()}};fw.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var HP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function u0(t,e){const[n,r,o,c]=t,l=va();if(kr(e)){const u=e.getCenter(),d=pi(u,n);return l.moveTo(n[0],n[1]),l.quadraticCurveTo(u[0],u[1],o[0],o[1]),Yh(l,o,c,u,d),l.quadraticCurveTo(u[0],u[1],r[0],r[1]),Yh(l,r,n,u,d),l.closePath(),l}return l.moveTo(n[0],n[1]),l.bezierCurveTo(n[0]/2+o[0]/2,n[1],n[0]/2+o[0]/2,o[1],o[0],o[1]),l.lineTo(c[0],c[1]),l.bezierCurveTo(c[0]/2+r[0]/2,c[1],c[0]/2+r[0]/2,r[1],r[0],r[1]),l.lineTo(n[0],n[1]),l.closePath(),l}const dw=(t,e)=>{const n=HP(t,[]),{coordinate:r,document:o}=e;return(c,l,u)=>{const{color:d}=u,h=HP(u,["color"]),{color:g=d,transform:v}=l,m=u0(c,r);return Kn(o.createElement("path",{})).call(Zn,h).style("d",m.toString()).style("fill",g||d).style("stroke",g||d).style("transform",v).call(Zn,n).node()}};dw.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const hw={polygon:fw,ribbon:dw},pw=()=>(t,e,n,r)=>{const o=Object.entries(n).filter(([u])=>u.startsWith("x")).map(([,u])=>u),c=Object.entries(n).filter(([u])=>u.startsWith("y")).map(([,u])=>u),l=t.map(u=>{const d=[];for(let h=0;h<o.length;h++){const g=o[h][u];if(g===void 0)break;const v=c[h][u];d.push(r.map([+g,+v]))}return d});return[t,l]};pw.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:hw,channels:[...bo({shapes:Object.keys(hw)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi()],postInference:[...Di(),...$a()]};var WP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function _8(t,e){const n=va();if(!kr(e))n.moveTo(...t[0]),n.lineTo(...t[1]),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.lineTo(...t[5]),n.lineTo(...t[6]),n.lineTo(...t[7]),n.closePath(),n.moveTo(...t[8]),n.lineTo(...t[9]),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.lineTo(...t[13]);else{const r=e.getCenter(),[o,c]=r,l=na(bi(t[0],r)),u=na(bi(t[1],r)),d=pi(r,t[2]),h=pi(r,t[3]),g=pi(r,t[8]),v=pi(r,t[10]),m=pi(r,t[11]);n.moveTo(...t[0]),n.arc(o,c,d,l,u),n.arc(o,c,d,u,l,!0),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.arc(o,c,h,l,u),n.lineTo(...t[6]),n.arc(o,c,v,u,l,!0),n.closePath(),n.moveTo(...t[8]),n.arc(o,c,g,l,u),n.arc(o,c,g,u,l,!0),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.arc(o,c,m,l,u),n.arc(o,c,m,u,l,!0)}return n}const vd=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u,transform:d}=c,{color:h,fill:g=h,stroke:v=h}=l,m=WP(l,["color","fill","stroke"]),_=_8(o,n);return Kn(r.createElement("path",{})).call(Zn,m).style("d",_.toString()).style("stroke",v).style("fill",u||g).style("transform",d).call(Zn,t).node()}};vd.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var f0=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function d0(t,e,n=4){const r=va();if(!kr(e))return r.moveTo(...t[2]),r.lineTo(...t[3]),r.lineTo(t[3][0]-n,t[3][1]),r.lineTo(t[10][0]-n,t[10][1]),r.lineTo(t[10][0]+n,t[10][1]),r.lineTo(t[3][0]+n,t[3][1]),r.lineTo(...t[3]),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]),r.moveTo(t[3][0]+n/2,t[8][1]),r.arc(t[3][0],t[8][1],n/2,0,Math.PI*2),r.closePath(),r;const o=e.getCenter(),[c,l]=o,u=pi(o,t[3]),d=pi(o,t[8]),h=pi(o,t[10]),g=na(bi(t[2],o)),v=Math.asin(n/d),m=g-v,_=g+v;r.moveTo(...t[2]),r.lineTo(...t[3]),r.moveTo(Math.cos(m)*u+c,Math.sin(m)*u+l),r.arc(c,l,u,m,_),r.lineTo(Math.cos(_)*h+c,Math.sin(_)*h+l),r.arc(c,l,h,_,m,!0),r.lineTo(Math.cos(m)*u+c,Math.sin(m)*u+l),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]);const b=(m+_)/2;return r.moveTo(Math.cos(b)*(d+n/2)+c,Math.sin(b)*(d+n/2)+l),r.arc(Math.cos(b)*d+c,Math.sin(b)*d+l,n/2,b,Math.PI*2+b),r.closePath(),r}const gw=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u,transform:d}=c,h=4,{color:g,fill:v=g,stroke:m=g}=l,_=f0(l,["color","fill","stroke"]),b=d0(o,n,h);return Kn(r.createElement("path",{})).call(Zn,_).style("d",b.toString()).style("stroke",m).style("fill",u||v).style("transform",d).call(Zn,t).node()}};gw.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const h0={box:vd,violin:gw},VP=()=>(t,e,n,r)=>{const{x:o,y:c,y1:l,y2:u,y3:d,y4:h,series:g}=n,v=e.x,m=e.series,_=Array.from(t,b=>{const S=v.getBandWidth(v.invert(+o[b])),w=m?m.getBandWidth(m.invert(+(g==null?void 0:g[b]))):1,E=S*w,T=(+(g==null?void 0:g[b])||0)*S,M=+o[b]+T+E/2,[P,R,k,F,W]=[+c[b],+l[b],+u[b],+d[b],+h[b]];return[[M-E/2,W],[M+E/2,W],[M,W],[M,F],[M-E/2,F],[M+E/2,F],[M+E/2,R],[M-E/2,R],[M-E/2,k],[M+E/2,k],[M,R],[M,P],[M-E/2,P],[M+E/2,P]].map(rt=>r.map(rt))});return[t,_]};VP.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:h0,channels:[...bo({shapes:Object.keys(h0)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...Oi(),{type:Js}],postInference:[...Di(),..._u()],interaction:{shareTooltip:!0}};const GP={vector:gy},vw=()=>(t,e,n,r)=>{const{x:o,y:c,size:l,rotate:u}=n,[d,h]=r.getSize(),g=t.map(v=>{const m=+u[v]/180*Math.PI,_=+l[v],b=_/d,S=_/h,w=b*Math.cos(m),E=-S*Math.sin(m);return[r.map([+o[v]-w/2,+c[v]-E/2]),r.map([+o[v]+w/2,+c[v]+E/2])]});return[t,g]};vw.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:GP,channels:[...bo({shapes:Object.keys(GP)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...Oi()],postInference:[...Di(),...$a()]};var md=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function mw(t,e,n){return t.createElement("path",{style:Object.assign({d:`M ${e},${e} L -${e},0 L ${e},-${e} L 0,0 Z`,transformOrigin:"center"},n)})}function oc(t,e){if(!kr(e))return Rc().x(r=>r[0]).y(r=>r[1])(t);const n=e.getCenter();return up()({startAngle:0,endAngle:Math.PI*2,outerRadius:pi(t[0],n),innerRadius:pi(t[1],n)})}function yw(t,e){if(!kr(t))return e;const[n,r]=t.getCenter();return`translate(${n}, ${r}) ${e||""}`}const Au=(t,e)=>{const{arrow:n,arrowSize:r=4}=t,o=md(t,["arrow","arrowSize"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{color:g,lineWidth:v}=h,m=md(h,["color","lineWidth"]),{color:_=g,size:b=v}=d,S=n?mw(l,r,Object.assign({fill:o.stroke||_,stroke:o.stroke||_},wn(o,"arrow"))):null,w=oc(u,c),E=yw(c,d.transform);return Kn(l.createElement("path",{})).call(Zn,m).style("d",w).style("stroke",_).style("lineWidth",b).style("transform",E).style("markerEnd",S).call(Zn,o).node()}};Au.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const _w=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(id)?[t,e]:[t,nn({},e,{encode:{x:Xr(n)}})]};_w.props={};const $P={line:Au},bw=t=>(e,n,r,o)=>{const{x:c}=r,l=ec(n,r,nn({style:{bandOffset:0}},t)),u=Array.from(e,d=>{const h=[c[d],1],g=[c[d],0];return[h,g].map(v=>o.map(l(v,d)))});return[e,u]};bw.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:$P,channels:[...Ya({shapes:Object.keys($P)}),{name:"x",required:!0}],preInference:[...Oi(),{type:_w}],postInference:[...Di()]};const xy=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(id)?[t,e]:[t,nn({},e,{encode:{y:Xr(n)}})]};xy.props={};const xw={line:Au},Sw=t=>(e,n,r,o)=>{const{y:c}=r,l=ec(n,r,nn({style:{bandOffset:0}},t)),u=Array.from(e,d=>{const h=[0,c[d]],g=[1,c[d]];return[h,g].map(v=>o.map(l(v,d)))});return[e,u]};Sw.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:xw,channels:[...Ya({shapes:Object.keys(xw)}),{name:"y",required:!0}],preInference:[...Oi(),{type:xy}],postInference:[...Di()]};var ww=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function YP(t,e,n){return[["M",t,e],["L",t+2*n,e-n],["L",t+2*n,e+n],["Z"]]}function XP(t){return Rc().x(e=>e[0]).y(e=>e[1])(t)}function Ow(t,e,n,r,o,c,l=0){const[[u,d],[h,g]]=e;if(Yr(t)){const w=u+n,E=h+r,T=w+l,M=d+o,P=g+c;return[[w,M],[T,M],[T,P],[E,P]]}const v=d-n,m=g-r,_=v-l,b=u-o,S=h-c;return[[b,v],[b,_],[S,_],[S,m]]}const Ew=(t,e)=>{const{offsetX:n=0,sourceOffsetX:r=n,targetOffsetX:o=n,offsetY:c=0,sourceOffsetY:l=c,targetOffsetY:u=c,connectLength1:d,endMarker:h=!0}=t,g=ww(t,["offsetX","sourceOffsetX","targetOffsetX","offsetY","sourceOffsetY","targetOffsetY","connectLength1","endMarker"]),{coordinate:v}=e;return(m,_,b)=>{const{color:S,connectLength1:w}=b,E=ww(b,["color","connectLength1"]),{color:T,transform:M}=_,P=Ow(v,m,l,u,r,o,d!=null?d:w),R=wn(Object.assign(Object.assign({},g),b),"endMarker");return Kn(new N.y$).call(Zn,E).style("d",XP(P)).style("stroke",T||S).style("transform",M).style("markerEnd",h?new Er({className:"marker",style:Object.assign(Object.assign({},R),{symbol:YP})}):null).call(Zn,g).node()}};Ew.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Aw={connector:Ew},Tw=(...t)=>yy(...t);Tw.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:Aw,channels:[...Ya({shapes:Object.keys(Aw)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi()],postInference:[...Di()]};function Mw(t,e,n,r){if(e)return()=>[0,1];const{[t]:o,[`${t}1`]:c}=n;return l=>{var u;const d=((u=r.getBandWidth)===null||u===void 0?void 0:u.call(r,r.invert(+c[l])))||0;return[o[l],c[l]+d]}}function Sy(t={}){const{extendX:e=!1,extendY:n=!1}=t;return(r,o,c,l)=>{const u=Mw("x",e,c,o.x),d=Mw("y",n,c,o.y),h=Array.from(r,g=>{const[v,m]=u(g),[_,b]=d(g);return[[v,_],[m,_],[m,b],[v,b]].map(M=>l.map(M))});return[r,h]}}const Cw={range:tc},Pw=()=>Sy();Pw.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:Cw,channels:[...Ya({shapes:Object.keys(Cw)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi()],postInference:[...Di()]};const a=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(id))){const r=(o,c)=>Array.isArray(o[0])?o.map(l=>l[c]):[o[c]];return[t,nn({},e,{encode:{x:Xr(r(n,0)),x1:Xr(r(n,1))}})]}return[t,e]};a.props={};const i={range:tc},s=()=>Sy({extendY:!0});s.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:i,channels:[...Ya({shapes:Object.keys(i)}),{name:"x",required:!0}],preInference:[...Oi(),{type:a}],postInference:[...Di()]};const f=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(id))){const r=(o,c)=>Array.isArray(o[0])?o.map(l=>l[c]):[o[c]];return[t,nn({},e,{encode:{y:Xr(r(n,0)),y1:Xr(r(n,1))}})]}return[t,e]};f.props={};const p={range:tc},y=()=>Sy({extendX:!0});y.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:p,channels:[...Ya({shapes:Object.keys(p)}),{name:"y",required:!0}],preInference:[...Oi(),{type:f}],postInference:[...Di()]};var x=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const O=(t,e)=>{const{arrow:n,colorAttribute:r}=t,o=x(t,["arrow","colorAttribute"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{color:g,stroke:v}=h,m=x(h,["color","stroke"]),{d:_,color:b=g}=d,[S,w]=c.getSize();return Kn(l.createElement("path",{})).call(Zn,m).style("d",typeof _=="function"?_({width:S,height:w}):_).style(r,b).call(Zn,o).node()}};O.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const A=(t,e)=>O(Object.assign({colorAttribute:"fill"},t),e);A.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const I=(t,e)=>O(Object.assign({fill:"none",colorAttribute:"stroke"},t),e);I.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const B={path:A,hollow:I},j=t=>(e,n,r,o)=>[e,e.map(()=>[[0,0]])];j.props={defaultShape:"path",defaultLabelShape:"label",shape:B,composite:!1,channels:[...bo({shapes:Object.keys(B)}),{name:"d",scale:"identity"}],preInference:[...Oi()],postInference:[...Di()]};var V=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const mt=(t,e)=>{const{render:n}=t,r=V(t,["render"]);return o=>{const[[c,l]]=o;return n(Object.assign(Object.assign({},r),{x:c,y:l}),e)}};mt.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Bt=()=>(t,e)=>{const{style:n={}}=e;return[t,nn({},e,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter(([,r])=>typeof r=="function").map(([r,o])=>[r,()=>o])))})]};Bt.props={};const Kt={shape:mt},ue=t=>{const{cartesian:e}=t;return e?t0:(n,r,o,c)=>{const{x:l,y:u}=o,d=ec(r,o,t),h=Array.from(n,g=>{const v=[+l[g],+u[g]];return[c.map(d(v,g))]});return[n,h]}};ue.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:Kt,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Oi(),{type:fy},{type:l0},{type:Bt}]};var Le=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ke=(t,e)=>{const{document:n}=e;return(r,o,c)=>{const{transform:l}=o,{color:u}=c,d=Le(c,["color"]),{color:h=u}=o,[g,...v]=r,m=va();return m.moveTo(...g),v.forEach(([_,b])=>{m.lineTo(_,b)}),m.closePath(),Kn(n.createElement("path",{})).call(Zn,d).style("d",m.toString()).style("stroke",h||u).style("fill",h||u).style("fillOpacity",.4).style("transform",l).call(Zn,t).node()}};ke.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const He={density:ke},Ye=()=>(t,e,n,r)=>{const{x:o,series:c}=n,l=Object.entries(n).filter(([v])=>v.startsWith("y")).map(([,v])=>v),u=Object.entries(n).filter(([v])=>v.startsWith("size")).map(([,v])=>v);if(o===void 0||l===void 0||u===void 0)throw new Error("Missing encode for x or y or size channel.");const d=e.x,h=e.series,g=Array.from(t,v=>{const m=d.getBandWidth(d.invert(+o[v])),_=h?h.getBandWidth(h.invert(+(c==null?void 0:c[v]))):1,b=m*_,S=(+(c==null?void 0:c[v])||0)*m,w=+o[v]+S+b/2;return[...l.map((T,M)=>[w+ +u[M][v]/t.length,+l[M][v]]),...l.map((T,M)=>[w-+u[M][v]/t.length,+l[M][v]]).reverse()].map(T=>r.map(T))});return[t,g]};Ye.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:He,channels:[...bo({shapes:Object.keys(He)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...Oi(),{type:od},{type:Js}],postInference:[...Di(),..._u()],interaction:{shareTooltip:!0}};function rn(t){return typeof t=="string"?t.split(" ").map(e=>{const[n,r]=e.split(":");return[+n,r]}):t}function bn(t,e,n){const r=t?t():document.createElement("canvas");return r.width=e,r.height=n,r}const hn=ag((t,e,n)=>{const r=bn(n,t*2,t*2),o=r.getContext("2d"),c=t,l=t;if(e===1)o.beginPath(),o.arc(c,l,t,0,2*Math.PI,!1),o.fillStyle="rgba(0,0,0,1)",o.fill();else{const u=o.createRadialGradient(c,l,t*e,c,l,t);u.addColorStop(0,"rgba(0,0,0,1)"),u.addColorStop(1,"rgba(0,0,0,0)"),o.fillStyle=u,o.fillRect(0,0,2*t,2*t)}return r},t=>`${t}`);function Cn(t,e){const r=bn(e,256,1).getContext("2d"),o=r.createLinearGradient(0,0,256,1);return rn(t).forEach(([c,l])=>{o.addColorStop(c,l)}),r.fillStyle=o,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}function Jn(t,e,n,r,o,c){const{blur:l}=o;let u=r.length;for(;u--;){const{x:d,y:h,value:g,radius:v}=r[u],m=Math.min(g,n),_=d-v,b=h-v,S=hn(v,1-l,c),w=(m-e)/(n-e);t.globalAlpha=Math.max(w,.001),t.drawImage(S,_,b)}return t}function cr(t,e,n,r,o){const{minOpacity:c,opacity:l,maxOpacity:u,useGradientOpacity:d}=o,h=0,g=0,v=e,m=n,_=t.getImageData(h,g,v,m),b=_.data,S=b.length;for(let w=3;w<S;w+=4){const E=b[w],T=E*4;if(!T)continue;const M=l||Math.max(0,Math.min(u,Math.max(c,E)));b[w-3]=r[T],b[w-2]=r[T+1],b[w-1]=r[T+2],b[w]=d?r[T+3]:M}return _}function Gn(t,e,n,r,o,c,l){const u=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},c);u.minOpacity*=255,u.opacity*=255,u.maxOpacity*=255;const h=bn(l,t,e).getContext("2d"),g=Cn(u.gradient,l);h.clearRect(0,0,t,e),Jn(h,n,r,o,u,l);const v=cr(h,t,e,g,u),_=bn(l,t,e).getContext("2d");return _.putImageData(v,0,0),_}var ar=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function mr(t,e){return Object.keys(t).reduce((n,r)=>{const o=t[r];return e(o,r)||(n[r]=o),n},{})}const po=(t,e)=>{const{gradient:n,opacity:r,maxOpacity:o,minOpacity:c,blur:l,useGradientOpacity:u}=t,d=ar(t,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:h,createCanvas:g,document:v}=e;return(m,_,b)=>{const{transform:S}=_,[w,E]=h.getSize(),T=m.map(F=>({x:F[0],y:F[1],value:F[2],radius:F[3]})),M=Ho(m,F=>F[2]),P=Rr(m,F=>F[2]),k=w&&E?Gn(w,E,M,P,T,mr({gradient:n,opacity:r,minOpacity:c,maxOpacity:o,blur:l,useGradientOpacity:u},F=>F===void 0),g):{canvas:null};return Kn(v.createElement("image",{})).call(Zn,b).style("x",0).style("y",0).style("width",w).style("height",E).style("src",k.canvas.toDataURL()).style("transform",S).call(Zn,d).node()}};po.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const xa={heatmap:po},go=t=>(e,n,r,o)=>{const{x:c,y:l,size:u,color:d}=r,h=Array.from(e,g=>{const v=u?+u[g]:40;return[...o.map([+c[g],+l[g]]),d[g],v]});return[[0],[h]]};go.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:xa,channels:[...bo({shapes:Object.keys(xa)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...Oi(),{type:Js},{type:Ou}],postInference:[...Di(),...$a()]};var xr=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},vo=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Io(t,e){const{text:n="text",value:r="value"}=e;return t.map(o=>Object.assign(Object.assign({},o),{text:o[n],value:o[r]}))}const p0=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:t=>t.fontFamily},tooltip:{items:[t=>({name:t.text,value:t.value})]}}),wy=(t,e)=>xr(void 0,void 0,void 0,function*(){const{width:n,height:r}=e,{data:o,encode:c={},scale:l,style:u={},layout:d={}}=t,h=vo(t,["data","encode","scale","style","layout"]),g=Io(o,c);return nn({},p0(),Object.assign(Object.assign({data:{value:g,transform:[Object.assign({type:"wordCloud",size:[n,r]},d)]},encode:c,scale:l,style:u},h),{axis:!1}))});wy.props={};var qP={value:function(){}};function Lw(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new g0(n)}function g0(t){this._=t}function KP(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}g0.prototype=Lw.prototype={constructor:g0,on:function(e,n){var r=this._,o=KP(e+"",r),c,l=-1,u=o.length;if(arguments.length<2){for(;++l<u;)if((c=(e=o[l]).type)&&(c=QP(r[c],e.name)))return c;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++l<u;)if(c=(e=o[l]).type)r[c]=Iw(r[c],e.name,n);else if(n==null)for(c in r)r[c]=Iw(r[c],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new g0(e)},call:function(e,n){if((c=arguments.length-2)>0)for(var r=new Array(c),o=0,c,l;o<c;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],o=0,c=l.length;o<c;++o)l[o].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],c=0,l=o.length;c<l;++c)o[c].value.apply(n,r)}};function QP(t,e){for(var n=0,r=t.length,o;n<r;++n)if((o=t[n]).name===e)return o.value}function Iw(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=qP,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var JP=Lw,Un=0,hr=0,wr=0,Tn=1e3,mo,Hr,xo=0,Ki=0,qa=0,Tu=typeof performance=="object"&&performance.now?performance:Date,b8=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function x8(){return Ki||(b8(wF),Ki=Tu.now()+qa)}function wF(){Ki=0}function tL(){this._call=this._time=this._next=null}tL.prototype=S8.prototype={constructor:tL,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?x8():+n)+(e==null?0:+e),!this._next&&Hr!==this&&(Hr?Hr._next=this:mo=this,Hr=this),this._call=t,this._time=n,eL()},stop:function(){this._call&&(this._call=null,this._time=1/0,eL())}};function S8(t,e,n){var r=new tL;return r.restart(t,e,n),r}function OF(){x8(),++Un;for(var t=mo,e;t;)(e=Ki-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Un}function w8(){Ki=(xo=Tu.now())+qa,Un=hr=0;try{OF()}finally{Un=0,AF(),Ki=0}}function EF(){var t=Tu.now(),e=t-xo;e>Tn&&(qa-=e,xo=t)}function AF(){for(var t,e=mo,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:mo=n);Hr=t,eL(r)}function eL(t){if(!Un){hr&&(hr=clearTimeout(hr));var e=t-Ki;e>24?(t<1/0&&(hr=setTimeout(w8,t-Tu.now()-qa)),wr&&(wr=clearInterval(wr))):(wr||(xo=Tu.now(),wr=setInterval(EF,Tn)),Un=1,b8(w8))}}const TF=1664525,MF=1013904223,O8=4294967296;function CF(){let t=1;return()=>(t=(TF*t+MF)%O8)/O8}function PF(t){return t.x}function LF(t){return t.y}var IF=10,RF=Math.PI*(3-Math.sqrt(5));function E8(t){var e,n=1,r=.001,o=1-Math.pow(r,1/300),c=0,l=.6,u=new Map,d=S8(v),h=JP("tick","end"),g=CF();t==null&&(t=[]);function v(){m(),h.call("tick",e),n<r&&(d.stop(),h.call("end",e))}function m(S){var w,E=t.length,T;S===void 0&&(S=1);for(var M=0;M<S;++M)for(n+=(c-n)*o,u.forEach(function(P){P(n)}),w=0;w<E;++w)T=t[w],T.fx==null?T.x+=T.vx*=l:(T.x=T.fx,T.vx=0),T.fy==null?T.y+=T.vy*=l:(T.y=T.fy,T.vy=0);return e}function _(){for(var S=0,w=t.length,E;S<w;++S){if(E=t[S],E.index=S,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),isNaN(E.x)||isNaN(E.y)){var T=IF*Math.sqrt(.5+S),M=S*RF;E.x=T*Math.cos(M),E.y=T*Math.sin(M)}(isNaN(E.vx)||isNaN(E.vy))&&(E.vx=E.vy=0)}}function b(S){return S.initialize&&S.initialize(t,g),S}return _(),e={tick:m,restart:function(){return d.restart(v),e},stop:function(){return d.stop(),e},nodes:function(S){return arguments.length?(t=S,_(),u.forEach(b),e):t},alpha:function(S){return arguments.length?(n=+S,e):n},alphaMin:function(S){return arguments.length?(r=+S,e):r},alphaDecay:function(S){return arguments.length?(o=+S,e):+o},alphaTarget:function(S){return arguments.length?(c=+S,e):c},velocityDecay:function(S){return arguments.length?(l=1-S,e):1-l},randomSource:function(S){return arguments.length?(g=S,u.forEach(b),e):g},force:function(S,w){return arguments.length>1?(w==null?u.delete(S):u.set(S,b(w)),e):u.get(S)},find:function(S,w,E){var T=0,M=t.length,P,R,k,F,W;for(E==null?E=1/0:E*=E,T=0;T<M;++T)F=t[T],P=S-F.x,R=w-F.y,k=P*P+R*R,k<E&&(W=F,E=k);return W},on:function(S,w){return arguments.length>1?(h.on(S,w),e):h.on(S)}}}function kF(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return A8(this.cover(e,n),e,n,t)}function A8(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var o,c=t._root,l={data:r},u=t._x0,d=t._y0,h=t._x1,g=t._y1,v,m,_,b,S,w,E,T;if(!c)return t._root=l,t;for(;c.length;)if((S=e>=(v=(u+h)/2))?u=v:h=v,(w=n>=(m=(d+g)/2))?d=m:g=m,o=c,!(c=c[E=w<<1|S]))return o[E]=l,t;if(_=+t._x.call(null,c.data),b=+t._y.call(null,c.data),e===_&&n===b)return l.next=c,o?o[E]=l:t._root=l,t;do o=o?o[E]=new Array(4):t._root=new Array(4),(S=e>=(v=(u+h)/2))?u=v:h=v,(w=n>=(m=(d+g)/2))?d=m:g=m;while((E=w<<1|S)===(T=(b>=m)<<1|_>=v));return o[T]=c,o[E]=l,t}function DF(t){var e,n,r=t.length,o,c,l=new Array(r),u=new Array(r),d=1/0,h=1/0,g=-1/0,v=-1/0;for(n=0;n<r;++n)isNaN(o=+this._x.call(null,e=t[n]))||isNaN(c=+this._y.call(null,e))||(l[n]=o,u[n]=c,o<d&&(d=o),o>g&&(g=o),c<h&&(h=c),c>v&&(v=c));if(d>g||h>v)return this;for(this.cover(d,h).cover(g,v),n=0;n<r;++n)A8(this,l[n],u[n],t[n]);return this}function NF(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,o=this._x1,c=this._y1;if(isNaN(n))o=(n=Math.floor(t))+1,c=(r=Math.floor(e))+1;else{for(var l=o-n||1,u=this._root,d,h;n>t||t>=o||r>e||e>=c;)switch(h=(e<r)<<1|t<n,d=new Array(4),d[h]=u,u=d,l*=2,h){case 0:o=n+l,c=r+l;break;case 1:n=o-l,c=r+l;break;case 2:o=n+l,r=c-l;break;case 3:n=o-l,r=c-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=o,this._y1=c,this}function FF(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function BF(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function $o(t,e,n,r,o){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=o}function jF(t,e,n){var r,o=this._x0,c=this._y0,l,u,d,h,g=this._x1,v=this._y1,m=[],_=this._root,b,S;for(_&&m.push(new $o(_,o,c,g,v)),n==null?n=1/0:(o=t-n,c=e-n,g=t+n,v=e+n,n*=n);b=m.pop();)if(!(!(_=b.node)||(l=b.x0)>g||(u=b.y0)>v||(d=b.x1)<o||(h=b.y1)<c))if(_.length){var w=(l+d)/2,E=(u+h)/2;m.push(new $o(_[3],w,E,d,h),new $o(_[2],l,E,w,h),new $o(_[1],w,u,d,E),new $o(_[0],l,u,w,E)),(S=(e>=E)<<1|t>=w)&&(b=m[m.length-1],m[m.length-1]=m[m.length-1-S],m[m.length-1-S]=b)}else{var T=t-+this._x.call(null,_.data),M=e-+this._y.call(null,_.data),P=T*T+M*M;if(P<n){var R=Math.sqrt(n=P);o=t-R,c=e-R,g=t+R,v=e+R,r=_.data}}return r}function zF(t){if(isNaN(g=+this._x.call(null,t))||isNaN(v=+this._y.call(null,t)))return this;var e,n=this._root,r,o,c,l=this._x0,u=this._y0,d=this._x1,h=this._y1,g,v,m,_,b,S,w,E;if(!n)return this;if(n.length)for(;;){if((b=g>=(m=(l+d)/2))?l=m:d=m,(S=v>=(_=(u+h)/2))?u=_:h=_,e=n,!(n=n[w=S<<1|b]))return this;if(!n.length)break;(e[w+1&3]||e[w+2&3]||e[w+3&3])&&(r=e,E=w)}for(;n.data!==t;)if(o=n,!(n=n.next))return this;return(c=n.next)&&delete n.next,o?(c?o.next=c:delete o.next,this):e?(c?e[w]=c:delete e[w],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=c,this)}function UF(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function ZF(){return this._root}function HF(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function WF(t){var e=[],n,r=this._root,o,c,l,u,d;for(r&&e.push(new $o(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,c=n.x0,l=n.y0,u=n.x1,d=n.y1)&&r.length){var h=(c+u)/2,g=(l+d)/2;(o=r[3])&&e.push(new $o(o,h,g,u,d)),(o=r[2])&&e.push(new $o(o,c,g,h,d)),(o=r[1])&&e.push(new $o(o,h,l,u,g)),(o=r[0])&&e.push(new $o(o,c,l,h,g))}return this}function VF(t){var e=[],n=[],r;for(this._root&&e.push(new $o(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var o=r.node;if(o.length){var c,l=r.x0,u=r.y0,d=r.x1,h=r.y1,g=(l+d)/2,v=(u+h)/2;(c=o[0])&&e.push(new $o(c,l,u,g,v)),(c=o[1])&&e.push(new $o(c,g,u,d,v)),(c=o[2])&&e.push(new $o(c,l,v,g,h)),(c=o[3])&&e.push(new $o(c,g,v,d,h))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function GF(t){return t[0]}function $F(t){return arguments.length?(this._x=t,this):this._x}function YF(t){return t[1]}function XF(t){return arguments.length?(this._y=t,this):this._y}function nL(t,e,n){var r=new rL(e==null?GF:e,n==null?YF:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function rL(t,e,n,r,o,c){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=o,this._y1=c,this._root=void 0}function T8(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Yo=nL.prototype=rL.prototype;Yo.copy=function(){var t=new rL(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=T8(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var o=0;o<4;++o)(r=e.source[o])&&(r.length?n.push({source:r,target:e.target[o]=new Array(4)}):e.target[o]=T8(r));return t},Yo.add=kF,Yo.addAll=DF,Yo.cover=NF,Yo.data=FF,Yo.extent=BF,Yo.find=jF,Yo.remove=zF,Yo.removeAll=UF,Yo.root=ZF,Yo.size=HF,Yo.visit=WF,Yo.visitAfter=VF,Yo.x=$F,Yo.y=XF;function Xo(t){return function(){return t}}function Mu(t){return(t()-.5)*1e-6}function qF(t){return t.x+t.vx}function KF(t){return t.y+t.vy}function QF(t){var e,n,r,o=1,c=1;typeof t!="function"&&(t=Xo(t==null?1:+t));function l(){for(var h,g=e.length,v,m,_,b,S,w,E=0;E<c;++E)for(v=nL(e,qF,KF).visitAfter(u),h=0;h<g;++h)m=e[h],S=n[m.index],w=S*S,_=m.x+m.vx,b=m.y+m.vy,v.visit(T);function T(M,P,R,k,F){var W=M.data,$=M.r,rt=S+$;if(W){if(W.index>m.index){var et=_-W.x-W.vx,ut=b-W.y-W.vy,J=et*et+ut*ut;J<rt*rt&&(et===0&&(et=Mu(r),J+=et*et),ut===0&&(ut=Mu(r),J+=ut*ut),J=(rt-(J=Math.sqrt(J)))/J*o,m.vx+=(et*=J)*(rt=($*=$)/(w+$)),m.vy+=(ut*=J)*rt,W.vx-=et*(rt=1-rt),W.vy-=ut*rt)}return}return P>_+rt||k<_-rt||R>b+rt||F<b-rt}}function u(h){if(h.data)return h.r=n[h.data.index];for(var g=h.r=0;g<4;++g)h[g]&&h[g].r>h.r&&(h.r=h[g].r)}function d(){if(e){var h,g=e.length,v;for(n=new Array(g),h=0;h<g;++h)v=e[h],n[v.index]=+t(v,h,e)}}return l.initialize=function(h,g){e=h,r=g,d()},l.iterations=function(h){return arguments.length?(c=+h,l):c},l.strength=function(h){return arguments.length?(o=+h,l):o},l.radius=function(h){return arguments.length?(t=typeof h=="function"?h:Xo(+h),d(),l):t},l}function M8(t){var e=Xo(.1),n,r,o;typeof t!="function"&&(t=Xo(t==null?0:+t));function c(u){for(var d=0,h=n.length,g;d<h;++d)g=n[d],g.vx+=(o[d]-g.x)*r[d]*u}function l(){if(n){var u,d=n.length;for(r=new Array(d),o=new Array(d),u=0;u<d;++u)r[u]=isNaN(o[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return c.initialize=function(u){n=u,l()},c.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Xo(+u),l(),c):e},c.x=function(u){return arguments.length?(t=typeof u=="function"?u:Xo(+u),l(),c):t},c}function C8(t){var e=Xo(.1),n,r,o;typeof t!="function"&&(t=Xo(t==null?0:+t));function c(u){for(var d=0,h=n.length,g;d<h;++d)g=n[d],g.vy+=(o[d]-g.y)*r[d]*u}function l(){if(n){var u,d=n.length;for(r=new Array(d),o=new Array(d),u=0;u<d;++u)r[u]=isNaN(o[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return c.initialize=function(u){n=u,l()},c.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Xo(+u),l(),c):e},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:Xo(+u),l(),c):t},c}const P8={hollow:GS,hollowDiamond:$S,hollowHexagon:YS,hollowSquare:r0,hollowTriangleDown:il,hollowTriangle:i0,hollowBowtie:o0,hollowCircle:oy,point:dd,plus:ay,diamond:sy,square:s0,triangle:ic,hexagon:c0,cross:qS,bowtie:cy,hyphen:ly,line:hd,tick:KS,triangleDown:QS,circle:a0},JF=4,tB=200,L8=t=>(e,n,r,o)=>{const{x:c,y:l,size:u}=r;if(!c.length||!l.length)return[e,l.map(()=>[[]])];const[d,h]=o.getSize(),g=ec(n,r,t),v=Array.from(e,S=>{const w=+c[S]*d,E=+l[S]*h,T=+u[S]||JF;return{i:S,x:w,y:E,r:T}}),m=E8(v).stop().force("collide",QF().radius(S=>S.r+1).strength(1));m.force("x",M8(S=>S.x).strength(0)),m.force("y",C8(S=>S.y).strength(5));for(let S=0;S<tB;S++)m.tick();m.stop();const _=S=>{const w=v.find(E=>E.i===S);return[w.x/d,w.y/h]},b=u?Array.from(e,S=>{const[w,E]=_(S),T=+u[S],M=T/d,P=T/h,R=[w-M,E-P],k=[w+M,E+P];return[o.map(g(R,S)),o.map(g(k,S))]}):Array.from(e,S=>[o.map(g(_(S),S))]);return[e,b]};L8.props={defaultShape:"point",defaultLabelShape:"label",composite:!1,shape:P8,channels:[...bo({shapes:Object.keys(P8)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"}],preInference:[...Oi(),{type:Js},{type:Ou}],postInference:[...Di(),{type:Eu},...$a()]};const I8=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];I8.props={};const R8=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];R8.props={};const k8=t=>new ga(t);k8.props={};const D8=t=>new Wd(t);D8.props={};const N8=t=>new Ms(t);N8.props={};class Rw extends Vu{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:rv}}map(e){return Ph(e)?e:this.options.unknown}invert(e){return this.map(e)}clone(){return new Rw(this.options)}getTicks(){const{domain:e,tickCount:n,tickMethod:r}=this.options,[o,c]=e;return!(0,Se.Z)(o)||!(0,Se.Z)(c)?[]:r(o,c,n)}}const F8=t=>new Rw(t);F8.props={};class iL extends Ms{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:Hd,paddingInner:1,paddingOuter:0}}constructor(e){super(e)}getPaddingInner(){return 1}clone(){return new iL(this.options)}update(e){super.update(e)}getPaddingOuter(){return this.options.padding}}const B8=t=>new iL(t);B8.props={};var j8=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Cu="\\d\\d?",Pu="\\d\\d",eB="\\d{3}",nB="\\d{4}",Oy="[^\\s]+",z8=/\[([^]*?)\]/gm;function U8(t,e){for(var n=[],r=0,o=t.length;r<o;r++)n.push(t[r].substr(0,e));return n}var Z8=function(t){return function(e,n){var r=n[t].map(function(c){return c.toLowerCase()}),o=r.indexOf(e.toLowerCase());return o>-1?o:null}};function yd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,o=e;r<o.length;r++){var c=o[r];for(var l in c)t[l]=c[l]}return t}var H8=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],W8=["January","February","March","April","May","June","July","August","September","October","November","December"],rB=U8(W8,3),iB=U8(H8,3),V8={dayNamesShort:iB,dayNames:H8,monthNamesShort:rB,monthNames:W8,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!==10?1:0)*t%10]}},kw=yd({},V8),oB=function(t){return kw=yd(kw,t)},G8=function(t){return t.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},ca=function(t,e){for(e===void 0&&(e=2),t=String(t);t.length<e;)t="0"+t;return t},aB={D:function(t){return String(t.getDate())},DD:function(t){return ca(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return ca(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return ca(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return ca(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return ca(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return ca(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return ca(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return ca(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return ca(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return ca(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return ca(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+ca(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+ca(Math.floor(Math.abs(e)/60),2)+":"+ca(Math.abs(e)%60,2)}},$8=function(t){return+t-1},Y8=[null,Cu],X8=[null,Oy],q8=["isPm",Oy,function(t,e){var n=t.toLowerCase();return n===e.amPm[0]?0:n===e.amPm[1]?1:null}],K8=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(t){var e=(t+"").match(/([+-]|\d\d)/gi);if(e){var n=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?n:-n}return 0}],sB={D:["day",Cu],DD:["day",Pu],Do:["day",Cu+Oy,function(t){return parseInt(t,10)}],M:["month",Cu,$8],MM:["month",Pu,$8],YY:["year",Pu,function(t){var e=new Date,n=+(""+e.getFullYear()).substr(0,2);return+(""+(+t>68?n-1:n)+t)}],h:["hour",Cu,void 0,"isPm"],hh:["hour",Pu,void 0,"isPm"],H:["hour",Cu],HH:["hour",Pu],m:["minute",Cu],mm:["minute",Pu],s:["second",Cu],ss:["second",Pu],YYYY:["year",nB],S:["millisecond","\\d",function(t){return+t*100}],SS:["millisecond",Pu,function(t){return+t*10}],SSS:["millisecond",eB],d:Y8,dd:Y8,ddd:X8,dddd:X8,MMM:["month",Oy,Z8("monthNamesShort")],MMMM:["month",Oy,Z8("monthNames")],a:q8,A:q8,ZZ:K8,Z:K8},Dw={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},cB=function(t){return yd(Dw,t)},Q8=function(t,e,n){if(e===void 0&&(e=Dw.default),n===void 0&&(n={}),typeof t=="number"&&(t=new Date(t)),Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");e=Dw[e]||e;var r=[];e=e.replace(z8,function(c,l){return r.push(l),"@@@"});var o=yd(yd({},kw),n);return e=e.replace(j8,function(c){return aB[c](t,o)}),e.replace(/@@@/g,function(){return r.shift()})};function lB(t,e,n){if(n===void 0&&(n={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=Dw[e]||e,t.length>1e3)return null;var r=new Date,o={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},c=[],l=[],u=e.replace(z8,function(P,R){return l.push(G8(R)),"@@@"}),d={},h={};u=G8(u).replace(j8,function(P){var R=sB[P],k=R[0],F=R[1],W=R[3];if(d[k])throw new Error("Invalid format. "+k+" specified twice in format");return d[k]=!0,W&&(h[W]=!0),c.push(R),"("+F+")"}),Object.keys(h).forEach(function(P){if(!d[P])throw new Error("Invalid format. "+P+" is required in specified format")}),u=u.replace(/@@@/g,function(){return l.shift()});var g=t.match(new RegExp(u,"i"));if(!g)return null;for(var v=yd(yd({},kw),n),m=1;m<g.length;m++){var _=c[m-1],b=_[0],S=_[2],w=S?S(g[m],v):+g[m];if(w==null)return null;o[b]=w}o.isPm===1&&o.hour!=null&&+o.hour!=12?o.hour=+o.hour+12:o.isPm===0&&+o.hour==12&&(o.hour=0);var E;if(o.timezoneOffset==null){E=new Date(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond);for(var T=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],m=0,M=T.length;m<M;m++)if(d[T[m][0]]&&o[T[m][0]]!==E[T[m][1]]())return null}else if(E=new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute-o.timezoneOffset,o.second,o.millisecond)),o.month>11||o.month<0||o.day>31||o.day<1||o.hour>23||o.hour<0||o.minute>59||o.minute<0||o.second>59||o.second<0)return null;return E}var QX={format:Q8,parse:lB,defaultI18n:V8,setGlobalDateI18n:oB,setGlobalDateMasks:cB},JX=null;const Ey=1e3,Ay=Ey*60,Ty=Ay*60,_d=Ty*24,My=_d*7,J8=_d*30,tR=_d*365;function Ro(t,e,n,r){const o=(h,g)=>{const v=_=>r(_)%g===0;let m=g;for(;m&&!v(h);)n(h,-1),m-=1;return h},c=(h,g)=>{g&&o(h,g),e(h)},l=(h,g)=>{const v=new Date(+h);return c(v,g),v},u=(h,g)=>{const v=new Date(+h-1);return c(v,g),n(v,g),c(v),v};return{ceil:u,floor:l,range:(h,g,v,m)=>{const _=[],b=Math.floor(v),S=m?u(h,v):u(h);for(let w=S;w<g;n(w,b),c(w))_.push(new Date(+w));return _},duration:t}}const uB=Ro(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),fB=Ro(Ey,t=>{t.setMilliseconds(0)},(t,e=1)=>{t.setTime(+t+Ey*e)},t=>t.getSeconds()),dB=Ro(Ay,t=>{t.setSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Ay*e)},t=>t.getMinutes()),hB=Ro(Ty,t=>{t.setMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+Ty*e)},t=>t.getHours()),pB=Ro(_d,t=>{t.setHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+_d*e)},t=>t.getDate()-1),eR=Ro(J8,t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getMonth();t.setMonth(n+e)},t=>t.getMonth()),gB=Ro(My,t=>{t.setDate(t.getDate()-t.getDay()%7),t.setHours(0,0,0,0)},(t,e=1)=>{t.setDate(t.getDate()+7*e)},t=>{const e=eR.floor(t),n=new Date(+t);return Math.floor((+n-+e)/My)}),vB=Ro(tR,t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getFullYear();t.setFullYear(n+e)},t=>t.getFullYear()),nR={millisecond:uB,second:fB,minute:dB,hour:hB,day:pB,week:gB,month:eR,year:vB},mB=Ro(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),yB=Ro(Ey,t=>{t.setUTCMilliseconds(0)},(t,e=1)=>{t.setTime(+t+Ey*e)},t=>t.getUTCSeconds()),_B=Ro(Ay,t=>{t.setUTCSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Ay*e)},t=>t.getUTCMinutes()),bB=Ro(Ty,t=>{t.setUTCMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+Ty*e)},t=>t.getUTCHours()),xB=Ro(_d,t=>{t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+_d*e)},t=>t.getUTCDate()-1),rR=Ro(J8,t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCMonth();t.setUTCMonth(n+e)},t=>t.getUTCMonth()),SB=Ro(My,t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7)%7),t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+My*e)},t=>{const e=rR.floor(t),n=new Date(+t);return Math.floor((+n-+e)/My)}),wB=Ro(tR,t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCFullYear();t.setUTCFullYear(n+e)},t=>t.getUTCFullYear()),iR={millisecond:mB,second:yB,minute:_B,hour:bB,day:xB,week:SB,month:rR,year:wB};function OB(t){const e=t?iR:nR,{year:n,month:r,week:o,day:c,hour:l,minute:u,second:d,millisecond:h}=e;return{tickIntervals:[[d,1],[d,5],[d,15],[d,30],[u,1],[u,5],[u,15],[u,30],[l,1],[l,3],[l,6],[l,12],[c,1],[c,2],[o,1],[r,1],[r,3],[n,1]],year:n,millisecond:h}}function oR(t,e,n,r,o){const c=+t,l=+e,{tickIntervals:u,year:d,millisecond:h}=OB(o),g=([w,E])=>w.duration*E,v=r?(l-c)/r:n||5,m=r||(l-c)/v,_=u.length,b=Ch(u,m,0,_,g);let S;if(b===_){const w=s_(c/d.duration,l/d.duration,v);S=[d,w]}else if(b){const w=m/g(u[b-1])<g(u[b])/m,[E,T]=w?u[b-1]:u[b],M=r?Math.ceil(r/E.duration):T;S=[E,M]}else{const w=Math.max(s_(c,l,v),1);S=[h,w]}return S}const EB=(t,e,n,r,o)=>{const c=t>e,l=c?e:t,u=c?t:e,[d,h]=oR(l,u,n,r,o),g=d.range(l,new Date(+u+1),h,!0);return c?g.reverse():g},AB=(t,e,n,r,o)=>{const c=t>e,l=c?e:t,u=c?t:e,[d,h]=oR(l,u,n,r,o),g=[d.floor(l,h),d.ceil(u,h)];return c?g.reverse():g};function TB(t,e){const{second:n,minute:r,hour:o,day:c,week:l,month:u,year:d}=e;return n.floor(t)<t?".SSS":r.floor(t)<t?":ss":o.floor(t)<t?"hh:mm":c.floor(t)<t?"hh A":u.floor(t)<t?l.floor(t)<t?"MMM DD":"ddd DD":d.floor(t)<t?"MMMM":"YYYY"}function MB(t){const e=t.getTimezoneOffset(),n=new Date(t);return n.setMinutes(n.getMinutes()+e,n.getSeconds(),n.getMilliseconds()),n}class oL extends ff{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:EB,interpolate:Il,mask:void 0,utc:!1}}chooseTransforms(){return[r=>+r,r=>new Date(r)]}chooseNice(){return AB}getTickMethodOptions(){const{domain:e,tickCount:n,tickInterval:r,utc:o}=this.options,c=e[0],l=e[e.length-1];return[c,l,n,r,o]}getFormatter(){const{mask:e,utc:n}=this.options,r=n?iR:nR,o=n?MB:ta;return c=>Q8(o(c),e||TB(c,r))}clone(){return new oL(this.options)}}const aR=t=>new oL(t);aR.props={};const sR=t=>e=>-t(-e),aL=(t,e)=>{const n=Math.log(t),r=t===Math.E?Math.log:t===10?Math.log10:t===2?Math.log2:o=>Math.log(o)/n;return e?sR(r):r},sL=(t,e)=>{const n=t===Math.E?Math.exp:r=>Ai(t,r);return e?sR(n):n},CB=(t,e,n,r=10)=>{const o=t<0,c=sL(r,o),l=aL(r,o),u=e<t,d=u?e:t,h=u?t:e;let g=l(d),v=l(h),m=[];if(!(r%1)&&v-g<n){if(g=Math.floor(g),v=Math.ceil(v),o)for(;g<=v;g+=1){const _=c(g);for(let b=r-1;b>=1;b-=1){const S=_*b;if(S>h)break;S>=d&&m.push(S)}}else for(;g<=v;g+=1){const _=c(g);for(let b=1;b<r;b+=1){const S=_*b;if(S>h)break;S>=d&&m.push(S)}}m.length*2<n&&(m=os(d,h,n))}else{const _=n===-1?v-g:Math.min(v-g,n);m=os(g,v,_).map(c)}return u?m.reverse():m},PB=(t,e,n,r)=>{const o=t<0,c=aL(r,o),l=sL(r,o),u=t>e,d=u?e:t,h=u?t:e,g=[l(Math.floor(c(d))),l(Math.ceil(c(h)))];return u?g.reverse():g};class cL extends ff{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:Rl,tickMethod:CB,tickCount:5}}chooseNice(){return PB}getTickMethodOptions(){const{domain:e,tickCount:n,base:r}=this.options,o=e[0],c=e[e.length-1];return[o,c,n,r]}chooseTransforms(){const{base:e,domain:n}=this.options,r=n[0]<0;return[aL(e,r),sL(e,r)]}clone(){return new cL(this.options)}}const cR=t=>new cL(t);cR.props={};const LB=t=>e=>e<0?-Ai(-e,t):Ai(e,t),IB=t=>e=>e<0?-Ai(-e,1/t):Ai(e,1/t),RB=t=>t<0?-Math.sqrt(-t):Math.sqrt(t);class Nw extends ff{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:Rl,tickMethod:os,tickCount:5}}constructor(e){super(e)}chooseTransforms(){const{exponent:e}=this.options;if(e===1)return[ta,ta];const n=e===.5?RB:LB(e),r=IB(e);return[n,r]}clone(){return new Nw(this.options)}}const lR=t=>new Nw(t);lR.props={};class lL extends Nw{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Rl,tickMethod:os,tickCount:5,exponent:.5}}constructor(e){super(e)}update(e){super.update(e)}clone(){return new lL(this.options)}}const uR=t=>new lL(t);uR.props={};const fR=t=>new Nl(t);fR.props={};const dR=t=>new Gh(t);dR.props={};const hR=t=>new Vh(t);hR.props={};const kB=t=>e=>{const n=t(e);return(0,Se.Z)(n)?Math.round(n):n};function DB(t,e){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[r]=this.chooseTransforms();this.composeOutput(r,this.chooseClamp(r))},n.prototype.initRange=function(){const{interpolator:r}=this.options;this.options.range=t(r)},n.prototype.composeOutput=function(r,o){const{domain:c,interpolator:l,round:u}=this.getOptions(),d=e(c.map(r)),h=u?kB(l):l;this.output=uf(h,d,o,r)},n.prototype.invert=void 0}}var NB=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},uL;function FB(t){return[t(0),t(1)]}const BB=t=>{const[e,n]=t;return uf(Il(0,1),lf(e,n))};let fL=uL=class extends ga{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:ta,tickMethod:os,tickCount:5}}constructor(e){super(e)}clone(){return new uL(this.options)}};fL=uL=NB([DB(FB,BB)],fL);const pR=t=>new fL(t);pR.props={};const gR=t=>new Ma(t);gR.props={};function dL({colorDefault:t,colorBlack:e,colorWhite:n,colorStroke:r,colorBackground:o,padding1:c,padding2:l,padding3:u,alpha90:d,alpha65:h,alpha45:g,alpha25:v,alpha10:m,category10:_,category20:b,sizeDefault:S=1,padding:w="auto",margin:E=16}){return{padding:w,margin:E,size:S,color:t,category10:_,category20:b,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:o,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:e,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:r,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:r,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:r,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:r,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:r,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:r,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:r,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:e,gridStrokeOpacity:m,labelAlign:"horizontal",labelFill:e,labelOpacity:g,labelFontSize:12,labelFontWeight:"normal",labelSpacing:c,line:!1,lineLineWidth:.5,lineStroke:e,lineStrokeOpacity:g,tickLength:4,tickLineWidth:1,tickStroke:e,tickOpacity:g,titleFill:e,titleOpacity:d,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:e,itemLabelFillOpacity:d,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,focusMarkerSize:12,itemSpacing:[c,c,c/2],itemValueFill:e,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:e,navButtonFillOpacity:.65,navPageNumFill:e,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:e,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:e,tickStrokeOpacity:.25,rowPadding:c,colPadding:l,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:e,handleLabelFillOpacity:g,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:e,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:e,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:e,labelFillOpacity:g,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:d,tickStroke:e,tickStrokeOpacity:g},label:{fill:e,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:e,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:n,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:e,fontWeight:"normal"},slider:{trackSize:16,trackFill:r,trackFillOpacity:1,selectionFill:t,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:e,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:e,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:e,titleFillOpacity:d,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:e,subtitleFillOpacity:h,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{[xc("tooltip")]:{"font-family":"sans-serif"}}}}}const jB=dL({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),hL=t=>nn({},jB,t);hL.props={};const vR=t=>nn({},hL(),{category10:"category10",category20:"category20"},t);vR.props={};const zB=dL({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),mR=t=>nn({},zB,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{[xc("tooltip")]:{background:"#1f1f1f",opacity:.95},[xc("tooltip-title")]:{color:"#A6A6A6"},[xc("tooltip-list-item-name-label")]:{color:"#A6A6A6"},[xc("tooltip-list-item-value")]:{color:"#A6A6A6"}}}},t),yR=t=>Object.assign({},mR(),{category10:"category10",category20:"category20"},t);yR.props={};const UB=dL({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),_R=t=>nn({},UB,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(e,n)=>n!==0},axisRight:{gridFilter:(e,n)=>n!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},t);_R.props={};const bR=t=>(...e)=>{const n=Ns(Object.assign({},{crossPadding:50},t))(...e);return Sb(n,t),n};bR.props=Object.assign(Object.assign({},Ns.props),{defaultPosition:"bottom"});function rq(){}const xR=t=>(...e)=>{const n=Ns(Object.assign({},{crossPadding:10},t))(...e);return Sb(n,t),n};xR.props=Object.assign(Object.assign({},Ns.props),{defaultPosition:"left"});var pL=function(){};function ZB(t,e){return t.reduce(function(n,r){return(n[r[e]]=n[r[e]]||[]).push(r),n},{})}function HB(t){var e;return((e=t[0])===null||e===void 0?void 0:e.map(function(n,r){return t.map(function(o){return o[r]})}))||[]}var qo=dt({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),WB=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:TT(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(o,c){return"".concat(o,"/").concat(c)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new N.ZA({class:qo.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new N.ZA({class:qo.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var n=this.attributes.defaultPage;return(0,se.Z)(n,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var n=this.pageViews,r=(0,Q.CR)(HB(n.map(function(v){var m=v.getBBox(),_=m.width,b=m.height;return[_,b]})).map(function(v){return Math.max.apply(Math,(0,Q.ev)([],(0,Q.CR)(v),!1))}),2),o=r[0],c=r[1],l=this.attributes,u=l.pageWidth,d=u===void 0?o:u,h=l.pageHeight,g=h===void 0?c:h;return{pageWidth:d,pageHeight:g}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=t.prototype.getBBox.call(this),r=n.x,o=n.y,c=this.controllerShape,l=this.pageShape,u=l.pageWidth,d=l.pageHeight;return new Jr(r,o,u+c.width,d)},e.prototype.goTo=function(n){var r=this,o=this.attributes.animate,c=this,l=c.currPage,u=c.playState,d=c.playWindow,h=c.pageViews;if(u!=="idle"||n<0||h.length<=0||n>=h.length)return null;h[l].setLocalPosition(0,0),this.prepareFollowingPage(n);var g=(0,Q.CR)(this.getFollowingPageDiff(n),2),v=g[0],m=g[1];this.playState="running";var _=lh(d,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-v,", ").concat(-m,")")}],o);return La(_,function(){r.innerCurrPage=n,r.playState="idle",r.setVisiblePages([n]),r.updatePageInfo()}),_},e.prototype.prev=function(){var n=this.attributes.loop,r=this.pageViews.length,o=this.currPage;if(!n&&o<=0)return null;var c=n?(o-1+r)%r:(0,se.Z)(o-1,0,r);return this.goTo(c)},e.prototype.next=function(){var n=this.attributes.loop,r=this.pageViews.length,o=this.currPage;if(!n&&o>=r-1)return null;var c=n?(o+1)%r:(0,se.Z)(o+1,0,r);return this.goTo(c)},e.prototype.renderClipPath=function(n){var r=this.pageShape,o=r.pageWidth,c=r.pageHeight;if(!o||!c){this.contentGroup.style.clipPath=void 0;return}this.clipPath=n.maybeAppendByClassName(qo.clipPath,"rect").styles({width:o,height:c}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(n){this.playWindow.children.forEach(function(r,o){n.includes(o)?Ku(r):Is(r)})},e.prototype.adjustControllerLayout=function(){var n=this,r=n.prevBtnGroup,o=n.nextBtnGroup,c=n.pageInfoGroup,l=this.attributes,u=l.orientation,d=l.controllerPadding,h=c.getBBox(),g=h.width,v=h.height,m=(0,Q.CR)(u==="horizontal"?[-180,0]:[-90,90],2),_=m[0],b=m[1];r.setLocalEulerAngles(_),o.setLocalEulerAngles(b);var S=r.getBBox(),w=S.width,E=S.height,T=o.getBBox(),M=T.width,P=T.height,R=Math.max(w,g,M),k=u==="horizontal"?{offset:[[0,0],[w/2+d,0],[w+g+d*2,0]],textAlign:"start"}:{offset:[[R/2,-E-d],[R/2,0],[R/2,P+d]],textAlign:"center"},F=(0,Q.CR)(k.offset,3),W=(0,Q.CR)(F[0],2),$=W[0],rt=W[1],et=(0,Q.CR)(F[1],2),ut=et[0],J=et[1],lt=(0,Q.CR)(F[2],2),vt=lt[0],xt=lt[1],Ht=k.textAlign,gt=c.querySelector("text");gt&&(gt.style.textAlign=Ht),r.setLocalPosition($,rt),c.setLocalPosition(ut,J),o.setLocalPosition(vt,xt)},e.prototype.updatePageInfo=function(){var n,r=this,o=r.currPage,c=r.pageViews,l=r.attributes.formatter;c.length<2||((n=this.pageInfoGroup.querySelector(qo.pageInfo.class))===null||n===void 0||n.attr("text",l(o+1,c.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(n){var r=this.currPage;if(r===n)return[0,0];var o=this.attributes.orientation,c=this.pageShape,l=c.pageWidth,u=c.pageHeight,d=n<r?-1:1;return o==="horizontal"?[d*l,0]:[0,d*u]},e.prototype.prepareFollowingPage=function(n){var r=this,o=r.currPage,c=r.pageViews;if(this.setVisiblePages([n,o]),n!==o){var l=(0,Q.CR)(this.getFollowingPageDiff(n),2),u=l[0],d=l[1];c[n].setLocalPosition(u,d)}},e.prototype.renderController=function(n){var r=this,o=this.attributes,c=o.controllerSpacing,l=o.classNamePrefix,u=l===void 0?"":l,d=this.pageShape,h=d.pageWidth,g=d.pageHeight,v=this.pageViews.length>=2,m=n.maybeAppendByClassName(qo.controller,"g");if(ch(m.node(),v),!!v){var _=or(this.attributes,"button"),b=or(this.attributes,"pageNum"),S=(0,Q.CR)(us(_),2),w=S[0],E=S[1],T=w.size,M=(0,Q._T)(w,["size"]),P=!m.select(qo.prevBtnGroup.class).node(),R=m.maybeAppendByClassName(qo.prevBtnGroup,"g").styles(E);this.prevBtnGroup=R.node();var k=R.maybeAppendByClassName(qo.prevBtn,"path");if(u){var F=ii(qo.prevBtn.name,_i.prevBtn,u);k.node().setAttribute("class",F)}var W=m.maybeAppendByClassName(qo.nextBtnGroup,"g").styles(E);this.nextBtnGroup=W.node();var $=W.maybeAppendByClassName(qo.nextBtn,"path");if(u){var rt=ii(qo.nextBtn.name,_i.nextBtn,u);$.node().setAttribute("class",rt)}[k,$].forEach(function(lt){lt.styles((0,Q.pi)((0,Q.pi)({},M),{transformOrigin:"center"})),Nn(lt.node(),T,!0)});var et=m.maybeAppendByClassName(qo.pageInfoGroup,"g");this.pageInfoGroup=et.node();var ut=et.maybeAppendByClassName(qo.pageInfo,"text");if(ut.styles(b),u){var J=ii(qo.pageInfo.name,_i.pageInfo,u);ut.node().setAttribute("class",J)}this.updatePageInfo(),m.node().setLocalPosition(h+c,g/2),P&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(n,r){var o=n.x,c=o===void 0?0:o,l=n.y,u=l===void 0?0:l;this.attr("transform","translate(".concat(c,", ").concat(u,")"));var d=ot(r);this.renderClipPath(d),this.renderController(d),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var n=this,r=H1(function(){return n.render(n.attributes,n)},50);this.playWindow.addEventListener(N.Dk.INSERTED,r),this.playWindow.addEventListener(N.Dk.REMOVED,r)},e}(Gi);function VB(t){return t instanceof Element||t instanceof Document}var vr,GB="component-poptip",lr={CONTAINER:"component-poptip",ARROW:"component-poptip-arrow",TEXT:"component-poptip-text"},SR=(vr={},vr[".".concat(lr.CONTAINER)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},vr[".".concat(lr.TEXT)]={"text-align":"center"},vr[".".concat(lr.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, -100%)"},vr[".".concat(lr.CONTAINER,"[data-position='left']")]={transform:"translate(-100%, -50%)"},vr[".".concat(lr.CONTAINER,"[data-position='right']")]={transform:"translate(0, -50%)"},vr[".".concat(lr.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},vr[".".concat(lr.CONTAINER,"[data-position='top-left']")]={transform:"translate(0,-100%)"},vr[".".concat(lr.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},vr[".".concat(lr.CONTAINER,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},vr[".".concat(lr.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},vr[".".concat(lr.CONTAINER,"[data-position='right-top']")]={transform:"translate(0, 0)"},vr[".".concat(lr.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},vr[".".concat(lr.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},vr[".".concat(lr.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},vr[".".concat(lr.ARROW)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},vr[".".concat(lr.CONTAINER,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},vr["[data-position='top'] .".concat(lr.ARROW)]={bottom:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},vr["[data-position='left'] .".concat(lr.ARROW)]={right:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='right']")]={transform:"translate(5px, -50%)"},vr["[data-position='right'] .".concat(lr.ARROW)]={left:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},vr["[data-position='bottom'] .".concat(lr.ARROW)]={top:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},vr["[data-position='top-left'] .".concat(lr.ARROW)]={left:"10px",bottom:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},vr["[data-position='top-right'] .".concat(lr.ARROW)]={right:"10px",bottom:"-2px"},vr[".".concat(lr.CONTAINER,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},vr["[data-position='left-top'] .".concat(lr.ARROW)]={right:"-2px",top:"8px"},vr[".".concat(lr.CONTAINER,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},vr["[data-position='left-bottom'] .".concat(lr.ARROW)]={right:"-2px",bottom:"8px"},vr[".".concat(lr.CONTAINER,"[data-position='right-top']")]={transform:"translate(5px, 0)"},vr["[data-position='right-top'] .".concat(lr.ARROW)]={left:"-2px",top:"8px"},vr[".".concat(lr.CONTAINER,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},vr["[data-position='right-bottom'] .".concat(lr.ARROW)]={left:"-2px",bottom:"8px"},vr[".".concat(lr.CONTAINER,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},vr["[data-position='bottom-left'] .".concat(lr.ARROW)]={top:"-2px",left:"8px"},vr[".".concat(lr.CONTAINER,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},vr["[data-position='bottom-right'] .".concat(lr.ARROW)]={top:"-2px",right:"8px"},vr),$B=void 0;function YB(t,e,n,r,o,c){if(o===void 0&&(o=!1),c===void 0&&(c=!1),c)return[t,e];var l=n.getBoundingClientRect(),u=l.x,d=l.y,h=l.width,g=l.height;switch(r){case"top":return o?[u+h/2,d]:[t,d];case"left":return o?[u,d+g/2]:[u,e];case"bottom":return o?[u+h/2,d+g]:[t,d+g];case"right":return o?[u+h,d+g/2]:[u+h,e];case"top-right":case"right-top":return[u+h,d];case"left-bottom":case"bottom-left":return[u,d+g];case"right-bottom":case"bottom-right":return[u+h,d+g];case"top-left":case"left-top":default:return[u,d]}}var XB=function(t){var e;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e||(e=t.apply($B,n)),e}};function qB(t){var e=t&&document.getElementById(t);return e||(e=document.createElement("div"),e.setAttribute("id",t),document.body.appendChild(e)),e}function KB(t){var e=XB(qB)(t);return e}var QB=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,nn({style:{id:GB}},e.defaultOptions,n))||this;return r.visibility="visible",r.map=new Map,r.domStyles="",r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"visible",{get:function(){return this.visibility==="visible"},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){this.visibility=this.style.visibility,this.updatePoptipElement()},e.prototype.update=function(n){this.attr(nn({},this.style,n)),this.render(this.attributes,this)},e.prototype.bind=function(n,r){var o=this;if(n){var c=this.style.text,l=function(d){var h=n,g=o.style,v=c;if(r){var m=typeof r=="function"?r.call(null,d):r,_=m.html,b=m.target,S=(0,Q._T)(m,["html","target"]);g=SS({},o.style,S),(b||b===!1)&&(h=b),typeof _=="string"&&(v=_)}var w=g.position,E=g.arrowPointAtCenter,T=g.follow,M=g.offset;if(h){var P=d,R=P.clientX,k=P.clientY,F=(0,Q.CR)(YB(R,k,h,w,E,T),2),W=F[0],$=F[1];o.showTip(W,$,{text:v,position:w,offset:M})}else o.hideTip()},u=function(){o.hideTip()};n.addEventListener("mousemove",l),n.addEventListener("mouseleave",u),this.map.set(n,[l,u])}},e.prototype.unbind=function(n){if(this.map.has(n)){var r=(0,Q.CR)(this.map.get(n)||[],2),o=r[0],c=r[1];o&&n.removeEventListener("mousemove",o),c&&n.removeEventListener("mouseleave",c),this.map.delete(n)}},e.prototype.clear=function(){this.container.innerHTML=""},e.prototype.destroy=function(){var n=this,r;(0,Q.ev)([],(0,Q.CR)(this.map.keys()),!1).forEach(function(o){return n.unbind(o)}),(r=this.container)===null||r===void 0||r.remove(),t.prototype.destroy.call(this)},e.prototype.showTip=function(n,r,o){var c=er(o,"text");if(!(c&&typeof c!="string")&&(this.applyStyles(),n&&r&&o)){var l=o.offset,u=o.position;if(u&&this.container.setAttribute("data-position",u),this.setOffsetPosition(n,r,l),typeof c=="string"){var d=this.container.querySelector(".".concat(lr.TEXT));d&&(d.innerHTML=c)}this.visibility="visible",this.container.style.visibility="visible"}},e.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},e.prototype.getContainer=function(){return this.container},e.prototype.getClassName=function(){var n=this.style.containerClassName;return"".concat(lr.CONTAINER).concat(n?" ".concat(n):"")},e.prototype.initShape=function(){var n=this,r=this.style.id;this.container=KB(r),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",function(){return n.showTip()}),this.container.addEventListener("mouseleave",function(){return n.hideTip()})},e.prototype.updatePoptipElement=function(){var n=this.container;this.clear();var r=this.style,o=r.id,c=r.template,l=r.text;this.container.setAttribute("id",o),this.container.className=this.getClassName();var u='<span class="'.concat(lr.ARROW,'"></span>');n.innerHTML=u,(0,Ze.Z)(c)?n.innerHTML+=c:c&&VB(c)&&n.appendChild(c),l&&(n.getElementsByClassName(lr.TEXT)[0].textContent=l),this.applyStyles(),this.container.style.visibility=this.visibility},e.prototype.applyStyles=function(){var n=ha({},SR,this.style.domStyles),r=Object.entries(n).reduce(function(c,l){var u=(0,Q.CR)(l,2),d=u[0],h=u[1],g=Object.entries(h).reduce(function(v,m){var _=(0,Q.CR)(m,2),b=_[0],S=_[1];return"".concat(v).concat(b,": ").concat(S,";")},"");return"".concat(c).concat(d,"{").concat(g,"}")},"");if(this.domStyles!==r){this.domStyles=r;var o=this.container.querySelector("style");o&&this.container.removeChild(o),o=document.createElement("style"),o.innerHTML=r,this.container.appendChild(o)}},e.prototype.setOffsetPosition=function(n,r,o){o===void 0&&(o=this.style.offset);var c=(0,Q.CR)(o,2),l=c[0],u=l===void 0?0:l,d=c[1],h=d===void 0?0:d;this.container.style.left="".concat(n+u,"px"),this.container.style.top="".concat(r+h,"px")},e.tag="poptip",e.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:SR,template:'<div class="'.concat(lr.TEXT,'"></div>')}},e}(Gi),ro=dt({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",focusGroup:"focus-group",focus:"focus",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),JB={offset:[0,20],domStyles:{".component-poptip":{opacity:"1",padding:"8px 12px",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},".component-poptip-arrow":{display:"none"},".component-poptip-text":{color:"#000",lineHeight:"20px"}}};function tj(t){var e=t.querySelector(ro.marker.class);return e?e.style:{}}var ej=function(t){(0,Q.ZT)(e,t);function e(n,r){var o=t.call(this,n,{span:[1,1],marker:function(){return new N.Cd({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this;return o.keyFields={},o.keyFields=r||{},o}return Object.defineProperty(e.prototype,"showValue",{get:function(){var n=this.attributes.valueText;return n?typeof n=="string"||typeof n=="number"?n!=="":typeof n=="function"?!0:n.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var n=this.labelGroup,r=this.valueGroup,o=this.attributes,c=o.markerSize,l=o.focus,u=o.focusMarkerSize,d=n.node().getBBox(),h=d.width,g=d.height,v=r.node().getBBox(),m=v.width,_=v.height,b=l?u!=null?u:12:0;return{markerWidth:c,labelWidth:h,valueWidth:m,focusWidth:b,height:Math.max(c,g,_)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var n=this.attributes.span;if(!n)return[1,1];var r=(0,Q.CR)(so(n),2),o=r[0],c=r[1],l=this.showValue?c:0,u=o+l;return[o/u,l/u]},enumerable:!1,configurable:!0}),e.prototype.setAttribute=function(n,r){t.prototype.setAttribute.call(this,n,r)},Object.defineProperty(e.prototype,"shape",{get:function(){var n,r=this.attributes,o=r.markerSize,c=r.width,l=this.actualSpace,u=l.markerWidth,d=l.focusWidth,h=l.height,g=this.actualSpace,v=g.labelWidth,m=g.valueWidth,_=(0,Q.CR)(this.spacing,3),b=_[0],S=_[1],w=_[2];if(c){var E=c-o-b-S-d-w,T=(0,Q.CR)(this.span,2),M=T[0],P=T[1];n=(0,Q.CR)([M*E,P*E],2),v=n[0],m=n[1]}var R=u+v+m+b+S+d+w;return{width:R,height:h,markerWidth:u,labelWidth:v,valueWidth:m,focusWidth:d}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var n=this.attributes,r=n.spacing,o=n.focus;if(!r)return[0,0,0];var c=(0,Q.CR)(so(r),3),l=c[0],u=c[1],d=c[2];return[l,this.showValue?u:0,o?d:0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var n=this.shape,r=n.markerWidth,o=n.labelWidth,c=n.valueWidth,l=n.focusWidth,u=n.width,d=n.height,h=(0,Q.CR)(this.spacing,3),g=h[0],v=h[1],m=h[2];return{height:d,width:u,markerWidth:r,labelWidth:o,valueWidth:c,focusWidth:l,position:[r/2,r+g,r+o+g+v,r+o+c+g+v+m+l/2]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var n=tj(this.markerGroup.node()),r=this.attributes,o=r.markerSize,c=r.markerStrokeWidth,l=c===void 0?n.strokeWidth:c,u=r.markerLineWidth,d=u===void 0?n.lineWidth:u,h=r.markerStroke,g=h===void 0?n.stroke:h,v=+(l||d||(g?1:0))*Math.sqrt(2),m=this.markerGroup.node().getBBox(),_=m.width,b=m.height;return(1-v/Math.max(_,b))*o},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(n){var r=this,o=this.attributes,c=o.marker,l=o.classNamePrefix,u=or(this.attributes,"marker");this.markerGroup=n.maybeAppendByClassName(ro.markerGroup,"g").style("zIndex",0),Oo(!!c,this.markerGroup,function(){var d,h=r.markerGroup.node(),g=(d=h.childNodes)===null||d===void 0?void 0:d[0],v=ii(ro.marker.name,_i.marker,l),m=typeof c=="string"?new Er({style:{symbol:c},className:v}):c();if(g)if(m.nodeName===g.nodeName)g instanceof Er?g.update((0,Q.pi)((0,Q.pi)({},u),{symbol:c})):(Ng(g,m),ot(g).styles(u));else{if(g.remove(),!(m instanceof Er)){var b=ii(ro.marker.name,_i.marker,l);m.className=b}ot(m).styles(u),h.appendChild(m)}else{if(!(m instanceof Er)){var _=ii(ro.marker.name,_i.marker,l);m.className=_,ot(m).styles(u)}h.appendChild(m)}r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var S=Nn(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(S,")")})},e.prototype.renderLabel=function(n){var r=or(this.attributes,"label"),o=r.text,c=(0,Q._T)(r,["text"]),l=this.attributes.classNamePrefix;this.labelGroup=n.maybeAppendByClassName(ro.labelGroup,"g").style("zIndex",0);var u=ii(ro.label.name,_i.label,l),d=this.labelGroup.maybeAppendByClassName(ro.label,function(){return _r(o)});d.node().setAttribute("class",u),d.styles(c)},e.prototype.renderValue=function(n){var r=this,o=or(this.attributes,"value"),c=o.text,l=(0,Q._T)(o,["text"]),u=this.attributes.classNamePrefix;this.valueGroup=n.maybeAppendByClassName(ro.valueGroup,"g").style("zIndex",0),Oo(this.showValue,this.valueGroup,function(){var d=ii(ro.value.name,_i.value,u),h=r.valueGroup.maybeAppendByClassName(ro.value,function(){return _r(c)});h.node().setAttribute("class",d),h.styles(l)})},e.prototype.createPoptip=function(){var n=this.attributes.poptip,r=n||{},o=r.render,c=(0,Q._T)(r,["render"]),l=new QB({style:ha(JB,c)});return this.poptipGroup=l,l},e.prototype.bindPoptip=function(n){var r=this,o=this.attributes.poptip;if(o){var c=this.poptipGroup||this.createPoptip();c.bind(n,function(){var l=r.attributes,u=l.labelText,d=l.valueText,h=l.markerFill,g=typeof u=="string"?u:u==null?void 0:u.attr("text"),v=typeof d=="string"?d:d==null?void 0:d.attr("text");if(typeof o.render=="function")return{html:o.render((0,Q.pi)((0,Q.pi)({},r.keyFields),{label:g,value:v,color:h}))};var m="";return(typeof g=="string"||typeof g=="number")&&(m+='<div class="component-poptip-label">'.concat(g,"</div>")),(typeof v=="string"||typeof v=="number")&&(m+='<div class="component-poptip-value">'.concat(v,"</div>")),{html:m}})}},e.prototype.renderFocus=function(n){var r=this,o=this.attributes,c=o.focus,l=o.focusMarkerSize,u=o.classNamePrefix,d={x:0,y:0,size:l,opacity:.6,symbol:"focus",stroke:"#aaaaaa",lineWidth:1};(0,kl.Z)(c)||(this.focusGroup=n.maybeAppendByClassName(ro.focusGroup,"g").style("zIndex",0),Oo(c,this.focusGroup,function(){var h=ii(ro.focus.name,_i.focusIcon,u),g=new Er({style:(0,Q.pi)((0,Q.pi)({},d),{symbol:"focus"}),className:h}),v=new N.Cd({style:{r:d.size/2,fill:"transparent"}}),m=r.focusGroup.node();m.appendChild(v),m.appendChild(g),g.update({opacity:0}),n.node().addEventListener("pointerenter",function(){g.update({opacity:1})}),n.node().addEventListener("pointerleave",function(){g.update({opacity:0})})}))},e.prototype.renderPoptip=function(n){var r=this,o=this.attributes.poptip;if(o){var c=n.maybeAppendByClassName(ro.value,"g").node(),l=n.maybeAppendByClassName(ro.label,"g").node();[c,l].forEach(function(u){u&&r.bindPoptip(u)})}},e.prototype.renderBackground=function(n){var r=this.shape,o=r.width,c=r.height,l=or(this.attributes,"background");this.background=n.maybeAppendByClassName(ro.backgroundGroup,"g").style("zIndex",-1);var u=this.background.maybeAppendByClassName(ro.background,"rect");u.styles((0,Q.pi)({width:o,height:c},l));var d=this.attributes.classNamePrefix,h=d===void 0?"":d;if(h){var g=ii(ro.background.name,_i.background,h);u.node().setAttribute("class",g)}},e.prototype.adjustLayout=function(){var n=this.layout,r=n.labelWidth,o=n.valueWidth,c=n.height,l=(0,Q.CR)(n.position,4),u=l[0],d=l[1],h=l[2],g=l[3],v=c/2;this.markerGroup.styles({transform:"translate(".concat(u,", ").concat(v,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(d,", ").concat(v,")")}),this.focusGroup&&this.focusGroup.styles({transform:"translate(".concat(g,", ").concat(v,")")}),Ig(this.labelGroup.select(ro.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(h,", ").concat(v,")")}),Ig(this.valueGroup.select(ro.value.class).node(),Math.ceil(o)))},e.prototype.render=function(n,r){var o=ot(r),c=n.x,l=c===void 0?0:c,u=n.y,d=u===void 0?0:u;o.styles({transform:"translate(".concat(l,", ").concat(d,")")}),this.renderMarker(o),this.renderLabel(o),this.renderValue(o),this.renderBackground(o),this.renderPoptip(o),this.renderFocus(o),this.adjustLayout()},e}(Gi),bd=dt({page:"item-page",navigator:"navigator",item:"item"},"items"),wR=function(t,e,n){return n===void 0&&(n=!0),t?e(t):n},nj=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:pL,mouseenter:pL,mouseleave:pL})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var n=this.attributes,r=n.gridRow,o=n.gridCol,c=n.data;if(!r&&!o)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&o?[r,o]:r?[r,c.length]:[c.length,o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var n=this.attributes,r=n.data,o=n.layout,c=n.poptip,l=n.focus,u=n.focusMarkerSize,d=n.classNamePrefix,h=or(this.attributes,"item"),g=r.map(function(v,m){var _=v.id,b=_===void 0?m:_,S=v.label,w=v.value;return{id:"".concat(b),index:m,style:(0,Q.pi)({layout:o,labelText:S,valueText:w,poptip:c,focus:l,focusMarkerSize:u,classNamePrefix:d},Object.fromEntries(Object.entries(h).map(function(E){var T=(0,Q.CR)(E,2),M=T[0],P=T[1];return[M,Fo(P,[v,m,r])]})))}});return g},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var n=this,r=this.attributes,o=r.orientation,c=r.width,l=r.rowPadding,u=r.colPadding,d=(0,Q.CR)(this.navigatorShape,1),h=d[0],g=(0,Q.CR)(this.grid,2),v=g[0],m=g[1],_=m*v,b=0;return this.pageViews.children.map(function(S,w){var E,T,M=Math.floor(w/_),P=w%_,R=n.ifHorizontal(m,v),k=[Math.floor(P/R),P%R];o==="vertical"&&k.reverse();var F=(0,Q.CR)(k,2),W=F[0],$=F[1],rt=(c-h-(m-1)*u)/m,et=S.getBBox().height,ut=(0,Q.CR)([0,0],2),J=ut[0],lt=ut[1];return o==="horizontal"?(E=(0,Q.CR)([b,W*(et+l)],2),J=E[0],lt=E[1],b=$===m-1?0:b+rt+u):(T=(0,Q.CR)([$*(rt+u),b],2),J=T[0],lt=T[1],b=W===v-1?0:b+et+l),{page:M,index:w,row:W,col:$,pageIndex:P,width:rt,height:et,x:J,y:lt}})},e.prototype.getFlexLayout=function(){var n=this.attributes,r=n.width,o=n.height,c=n.rowPadding,l=n.colPadding,u=(0,Q.CR)(this.navigatorShape,1),d=u[0],h=(0,Q.CR)(this.grid,2),g=h[0],v=h[1],m=(0,Q.CR)([r-d,o],2),_=m[0],b=m[1],S=(0,Q.CR)([0,0,0,0,0,0,0,0],8),w=S[0],E=S[1],T=S[2],M=S[3],P=S[4],R=S[5],k=S[6],F=S[7];return this.pageViews.children.map(function(W,$){var rt,et,ut,J,lt=W.getBBox(),vt=lt.width,xt=lt.height,Ht=k===0?0:l,gt=k+Ht+vt;if(gt<=_&&wR(P,function(Wt){return Wt<v}))return rt=(0,Q.CR)([k+Ht,F,gt],3),w=rt[0],E=rt[1],k=rt[2],{width:vt,height:xt,x:w,y:E,page:T,index:$,pageIndex:M++,row:R,col:P++};et=(0,Q.CR)([R+1,0,0,F+xt+c],4),R=et[0],P=et[1],k=et[2],F=et[3];var wt=F+xt;return wt<=b&&wR(R,function(Wt){return Wt<g})?(ut=(0,Q.CR)([k,F,vt],3),w=ut[0],E=ut[1],k=ut[2],{width:vt,height:xt,x:w,y:E,page:T,index:$,pageIndex:M++,row:R,col:P++}):(J=(0,Q.CR)([0,0,vt,0,T+1,0,0,0],8),w=J[0],E=J[1],k=J[2],F=J[3],T=J[4],M=J[5],R=J[6],P=J[7],{width:vt,height:xt,x:w,y:E,page:T,index:$,pageIndex:M++,row:R,col:P++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var n=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=n.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],n.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){var o=this.attributes.orientation;return Da(o,n,r)},e.prototype.flattenPage=function(n){n.querySelectorAll(bd.item.class).forEach(function(r){n.appendChild(r)}),n.querySelectorAll(bd.page.class).forEach(function(r){var o=n.removeChild(r);o.destroy()})},e.prototype.renderItems=function(n){var r=this.attributes,o=r.click,c=r.mouseenter,l=r.mouseleave,u=r.classNamePrefix;this.flattenPage(n);var d=this.dispatchCustomEvent.bind(this),h=ii(bd.item.name,_i.item,u);ot(n).selectAll(bd.item.class).data(this.renderData,function(g){return g.id}).join(function(g){return g.append(function(v){var m=v.style,_=(0,Q._T)(v,["style"]);return new ej({style:m},_)}).attr("className",h).on("click",function(){o==null||o(this),d("itemClick",{item:this})}).on("pointerenter",function(){c==null||c(this),d("itemMouseenter",{item:this})}).on("pointerleave",function(){l==null||l(this),d("itemMouseleave",{item:this})})},function(g){return g.each(function(v){var m=v.style;this.update(m)})},function(g){return g.remove()})},e.prototype.relayoutNavigator=function(){var n,r=this.attributes,o=r.layout,c=r.width,l=((n=this.pageViews.children[0])===null||n===void 0?void 0:n.getBBox().height)||0,u=(0,Q.CR)(this.navigatorShape,2),d=u[0],h=u[1];this.navigator.update(o==="grid"?{pageWidth:c-d,pageHeight:l-h}:{})},e.prototype.adjustLayout=function(){var n=this,r=Object.entries(ZB(this.itemsLayout,"page")).map(function(c){var l=(0,Q.CR)(c,2),u=l[0],d=l[1];return{page:u,layouts:d}}),o=(0,Q.ev)([],(0,Q.CR)(this.navigator.getContainer().children),!1);r.forEach(function(c){var l=c.layouts,u=n.pageViews.appendChild(new N.ZA({className:bd.page.name}));l.forEach(function(d){var h=d.x,g=d.y,v=d.index,m=d.width,_=d.height,b=o[v];u.appendChild(b),gv(b,"__layout__",d),b.update({x:h,y:g,width:m,height:_})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(n){var r=this.attributes,o=r.orientation,c=r.classNamePrefix,l=or(this.attributes,"nav"),u=ha({orientation:o,classNamePrefix:c},l),d=this;return n.selectAll(bd.navigator.class).data(["nav"]).join(function(h){return h.append(function(){return new WB({style:u})}).attr("className",bd.navigator.name).each(function(){d.navigator=this})},function(h){return h.each(function(){this.update(u)})},function(h){return h.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(n,r){var o=this.attributes.data;if(!(!o||o.length===0)){var c=this.renderNavigator(ot(r));this.renderItems(c.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(n,r){var o=new N.Aw(n,{detail:r});this.dispatchEvent(o)},e}(Gi),rj=function(t){(0,Q.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.update=function(n){this.attr(n)},e}(N.k9),OR=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,rx)||this}return e.prototype.renderTitle=function(n,r,o){var c=this.attributes,l=c.showTitle,u=c.titleText,d=c.classNamePrefix,h=or(this.attributes,"title"),g=(0,Q.CR)(us(h),2),v=g[0],m=g[1];this.titleGroup=n.maybeAppendByClassName(Ci.titleGroup,"g").styles(m);var _=(0,Q.pi)((0,Q.pi)({width:r,height:o},v),{text:l?u:"",classNamePrefix:d});this.title=this.titleGroup.maybeAppendByClassName(Ci.title,function(){return new Zb({style:_})}).update(_)},e.prototype.renderCustom=function(n){var r=this.attributes.data,o={innerHTML:this.attributes.render(r),pointerEvents:"auto"};n.maybeAppendByClassName(Ci.html,function(){return new rj({className:Ci.html.name,style:o})}).update(o)},e.prototype.renderItems=function(n,r){var o=r.x,c=r.y,l=r.width,u=r.height,d=or(this.attributes,"title",!0),h=(0,Q.CR)(us(d),2),g=h[0],v=h[1],m=(0,Q.pi)((0,Q.pi)({},g),{width:l,height:u,x:0,y:0});this.itemsGroup=n.maybeAppendByClassName(Ci.itemsGroup,"g").styles((0,Q.pi)((0,Q.pi)({},v),{transform:"translate(".concat(o,", ").concat(c,")")}));var _=this;this.itemsGroup.selectAll(Ci.items.class).data(["items"]).join(function(b){return b.append(function(){return new nj({style:m})}).attr("className",Ci.items.name).each(function(){_.items=ot(this)})},function(b){return b.update(m)},function(b){return b.remove()})},e.prototype.adjustLayout=function(){var n=this.attributes.showTitle;if(n){var r=this.title.node().getAvailableSpace(),o=r.x,c=r.y;this.itemsGroup.node().style.transform="translate(".concat(o,", ").concat(c,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.showTitle,o=n.width,c=n.height;return r?this.title.node().getAvailableSpace():new Jr(0,0,o,c)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n,r,o=(n=this.title)===null||n===void 0?void 0:n.node(),c=(r=this.items)===null||r===void 0?void 0:r.node();return!o||!c?t.prototype.getBBox.call(this):gT(o,c)},e.prototype.render=function(n,r){var o=this.attributes,c=o.width,l=o.height,u=o.x,d=u===void 0?0:u,h=o.y,g=h===void 0?0:h,v=o.classNamePrefix,m=o.render,_=ot(r),b=r.className||"legend-category";v?r.attr("className","".concat(b," ").concat(v,"legend")):r.className||r.attr("className","legend-category"),r.style.transform="translate(".concat(d,", ").concat(g,")"),m?this.renderCustom(_):(this.renderTitle(_,c,l),this.renderItems(_,this.availableSpace),this.adjustLayout())},e}(Gi),ac=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const ER="legend-category",gL="legend-html-category",ij="legend-continuous",oj="items-item",aj="legend-category-item-marker",sj="legend-category-item-label",cj="legend-category-item-focus-group";function AR(t){return t.getElementsByClassName(aj)[0]}function TR(t){return t.getElementsByClassName(sj)[0]}function MR(t){return t.getElementsByClassName(cj)[0]}function CR(t){return t.getElementsByClassName(oj)}function vL(t){return t.getElementsByClassName(ER)}function lj(t){return t.getElementsByClassName(gL)}function PR(t){return t.getElementsByClassName(ij)}function uj(t,e){[...vL(t),...PR(t)].forEach(r=>{e(r,o=>o)})}function mL(t){let e=t.parentNode;for(;e&&!e.__data__;)e=e.parentNode;return e.__data__}function iq(t){let e=t;for(;e&&!e.attr("class").startsWith("legend");)e=e.children[0];return e.attributes}function fj(t,e,n){var r;const o=Object.keys(t).find(c=>{if(c.startsWith(n)){const l=t[c].getOptions();return l.name===n&&l.markKey===e}});return(r=t[o])!==null&&r!==void 0?r:t[n]}function dj(t,{legends:e,marker:n,label:r,datum:o,filter:c,defaultSelect:l,emitter:u,channel:d,state:h={}}){const g=new Map,v=new Map,m=new Map,_=new Map,{unselected:b={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=h,S={unselected:wn(b,"marker")},w={unselected:wn(b,"label")},{setState:E,removeState:T}=Hs(S,void 0),{setState:M,removeState:P}=Hs(w,void 0),R=Array.from(e(t));let k=R.map(o);const F=()=>{for(const et of R){const ut=o(et),J=n(et),lt=r(et);k.includes(ut)?(T(J,"unselected"),P(lt,"unselected")):(E(J,"unselected"),M(lt,"unselected"))}};for(const et of R){const ut=()=>{ra(t,"pointer")},J=()=>{qx(t)},lt=xt=>ac(this,void 0,void 0,function*(){const Ht=o(et),gt=k.indexOf(Ht);gt===-1?k.push(Ht):k.splice(gt,1),yield c(k),F();const{nativeEvent:wt=!0}=xt;wt&&(k.length===R.length?u.emit("legend:reset",{nativeEvent:wt}):u.emit("legend:filter",Object.assign(Object.assign({},xt),{nativeEvent:wt,data:{channel:d,values:k}})))});et.addEventListener("click",lt),et.addEventListener("pointerenter",ut),et.addEventListener("pointerout",J),g.set(et,lt),v.set(et,ut),m.set(et,J);const vt=MR(et);if(vt){const xt=Ht=>ac(this,void 0,void 0,function*(){Ht.stopPropagation();const gt=o(et),wt=k.indexOf(gt),{nativeEvent:Wt=!0}=Ht;if(wt!==-1&&k.length===1){if(!Wt)return;k=R.map(o),yield c(k),F(),u.emit("legend:reset",{nativeEvent:Wt})}else{if(k=[gt],yield c(k),F(),!Wt)return;u.emit("legend:focus",Object.assign(Object.assign({},Ht),{nativeEvent:Wt,data:{channel:d,value:gt}}))}});vt.addEventListener("click",xt),_.set(et,xt)}}const W=et=>ac(this,void 0,void 0,function*(){const{nativeEvent:ut}=et;if(ut)return;const{data:J}=et,{channel:lt,value:vt}=J;lt===d&&(k=[vt],yield c(k),F())}),$=et=>ac(this,void 0,void 0,function*(){const{nativeEvent:ut}=et;if(ut)return;const{data:J}=et,{channel:lt,values:vt}=J;lt===d&&(k=vt,yield c(k),F())}),rt=et=>ac(this,void 0,void 0,function*(){const{nativeEvent:ut}=et;ut||(k=R.map(o),yield c(k),F())});return u.on("legend:filter",$),u.on("legend:focus",W),u.on("legend:reset",rt),l&&u.emit("legend:filter",{data:{channel:d,values:l}}),()=>{for(const et of R){et.removeEventListener("click",g.get(et)),et.removeEventListener("pointerenter",v.get(et)),et.removeEventListener("pointerout",m.get(et));const ut=MR(et);ut&&ut.removeEventListener("click",_.get(et))}u.off("legend:focus",W),u.off("legend:filter",$),u.off("legend:reset",rt)}}function hj(t,{domain:e,filter:n,defaultSelect:r,emitter:o,channel:c}){const l=new Map,u=new Map,d=new Map;let h=[...e];const g=()=>{var w;const E=(w=t.ownerDocument)===null||w===void 0?void 0:w.defaultView;return E&&E.getContextService().getDomElement().parentElement||document.body},v=()=>{const E=g().querySelector(".legend-html"),T=M=>ac(this,void 0,void 0,function*(){let P=M.target;for(;P&&!P.hasAttribute("legend-value")&&(P=P.parentElement,P!==E););if(!P||!P.hasAttribute("legend-value"))return;M.preventDefault(),M.stopPropagation();const R=P.getAttribute("legend-value");if(!R)return;const k=h.indexOf(R);k===-1?h.push(R):h.splice(k,1),yield n(h),m(),h.length===e.length?o.emit("legend:reset",{nativeEvent:!0}):o.emit("legend:filter",{nativeEvent:!0,data:{channel:c,values:h}})});E.addEventListener("click",T),l.set(E,T)},m=()=>{g().querySelectorAll("[legend-value]").forEach(T=>{const M=T.getAttribute("legend-value");if(!M||!e.includes(M))return;const P=h.includes(M),R=T;P?(R.style.opacity="1",R.classList.remove("legend-item-inactive")):(R.style.opacity="0.4",R.classList.add("legend-item-inactive"))})};v();const _=w=>ac(this,void 0,void 0,function*(){const{nativeEvent:E}=w;if(E)return;const{data:T}=w,{channel:M,value:P}=T;M===c&&(h=[P],yield n(h),m())}),b=w=>ac(this,void 0,void 0,function*(){const{nativeEvent:E}=w;if(E)return;const{data:T}=w,{channel:M,values:P}=T;M===c&&(h=P,yield n(h),m())}),S=w=>ac(this,void 0,void 0,function*(){const{nativeEvent:E}=w;E||(h=[...e],yield n(h),m())});return o.on("legend:filter",b),o.on("legend:focus",_),o.on("legend:reset",S),r&&o.emit("legend:filter",{data:{channel:c,values:r}}),()=>{g().querySelectorAll("[legend-value]").forEach(T=>{const M=T.getAttribute("legend-value");if(!M||!e.includes(M))return;const P=l.get(T),R=u.get(T),k=d.get(T);P&&T.removeEventListener("click",P),R&&T.removeEventListener("pointerenter",R),k&&T.removeEventListener("pointerout",k)}),l.clear(),u.clear(),d.clear(),o.off("legend:filter",b),o.off("legend:focus",_),o.off("legend:reset",S)}}function pj(t,{legend:e,filter:n,emitter:r,channel:o}){const{attributes:c}=e,l=u=>{const{value:d}=u.detail,h=d.map(g=>{var v,m;const _=(v=c.data)===null||v===void 0?void 0:v.find(b=>b.value===g);return _&&(m=_.domainValue)!==null&&m!==void 0?m:g});n(h),r.emit({nativeEvent:!0,data:{channel:o,values:h}})};return e.addEventListener("valuechange",l),()=>{e.removeEventListener("valuechange",l)}}function LR(t,e){return ac(this,arguments,void 0,function*(n,{legend:r,channel:o,value:c,ordinal:l,channels:u,allChannels:d,facet:h=!1}){const{view:g,update:v,setState:m}=n;m(r,_=>{var b,S;const{marks:w}=_,E=(S=(b=r.attributes)===null||b===void 0?void 0:b.scales)===null||S===void 0?void 0:S.find(M=>M.name===o),T=w.map(M=>{var P,R;if(((P=M.scale[o].key)!==null&&P!==void 0?P:o)!==((R=E==null?void 0:E.key)!==null&&R!==void 0?R:E==null?void 0:E.name)||M.type==="legends"||gg.includes(M.type))return M;const{transform:k=[],data:F=[]}=M,W=k.findIndex(({type:et})=>et.startsWith("group")||et.startsWith("bin")),$=[...k];F.length&&$.splice(W+1,0,{type:"filter",[o]:{value:c,ordinal:l}});const rt=Object.fromEntries(u.map(et=>{const ut=fj(g.scale,_.key,et);return[et,{domain:ut.getOptions().domain}]}));return nn({},M,Object.assign(Object.assign({transform:$,scale:rt},!l&&{animate:!1}),{legend:h?!1:Object.fromEntries(d.map(et=>[et,{preserve:!0}]))}))});return Object.assign(Object.assign({},_),{marks:T})}),yield v()})}function gj(t,e){for(const n of t)LR(n,Object.assign(Object.assign({},e),{facet:!0}))}function vj(){return(t,e,n)=>{const{container:r}=t,o=e.filter(v=>v!==t),c=o.length>0,l=v=>mL(v).scales.map(m=>m.name),u=[...vL(r),...lj(r),...PR(r)],d=u.flatMap(l),h=c?rl(gj,50,{trailing:!0}):rl(LR,50,{trailing:!0}),g=u.map(v=>{const{name:m,domain:_}=mL(v).scales[0],b=l(v),S={legend:v,channel:m,channels:b,allChannels:d};return v.className===ER?dj(v,{legends:CR,marker:AR,label:TR,datum:w=>{const{__data__:E}=w,{index:T}=E;return _[T]},filter:w=>{const E=Object.assign(Object.assign({},S),{value:w,ordinal:!0});h(c?o:t,E)},state:v.attributes.state,defaultSelect:v.attributes.defaultSelect,channel:m,emitter:n}):v.className===gL?hj(r,{domain:_,filter:w=>{const E=Object.assign(Object.assign({},S),{value:w,ordinal:!0});h(c?o:t,E)},defaultSelect:v.attributes.defaultSelect,channel:m,emitter:n}):pj(r,{legend:v,filter:w=>{const E=Object.assign(Object.assign({},S),{value:w,ordinal:!1});h(c?o:t,E)},emitter:n,channel:m})});return()=>{g.forEach(v=>v())}}}var mj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function IR(t,e){const n=Ra(t,"shape"),r=Ra(t,"color"),o=n?n.clone():null,c=[];for(const[u,d]of e){const h=u.type,v=((r==null?void 0:r.getOptions().domain.length)>0?r==null?void 0:r.getOptions().domain:d.data).map((m,_)=>{var b;return o?o.map(m||"point"):((b=u==null?void 0:u.style)===null||b===void 0?void 0:b.shape)||d.defaultShape||"point"});typeof h=="string"&&c.push([h,v])}if(c.length===0)return["point",["point"]];if(c.length===1||!n)return c[0];const{range:l}=n.getOptions();return c.map(([u,d])=>{let h=0;for(let g=0;g<c.length;g++){const v=l[g%l.length];d[g]===v&&h++}return[h/d.length,[u,d]]}).sort((u,d)=>d[0]-u[0])[0][1]}function yj(t,e){const{scales:n,library:r,markState:o}=e,[c,l]=IR(n,o),{itemMarker:u,itemMarkerSize:d}=t,h=(m,_)=>{var b,S,w;const E=((w=(S=(b=r[`mark.${c}`])===null||b===void 0?void 0:b.props)===null||S===void 0?void 0:S.shape[m])===null||w===void 0?void 0:w.props.defaultMarker)||Jo(m.split(".")),T=typeof d=="function"?d(_):d;return()=>x7(E,{color:_.color})(0,0,T)},g=m=>`${l[m]}`;return Ra(n,"shape")&&!u?(m,_)=>h(g(_),m):typeof u=="function"?(m,_)=>{const b=u(m.id,_);return typeof b=="string"?h(b,m):b}:(m,_)=>h(u||g(_),m)}function _j(t){const e=Ra(t,"opacity");if(e){const{range:n}=e.getOptions();return(r,o)=>n[o]}}function bj(t,e){const n=Ra(t,"size");return n instanceof Rw?n.map(NaN)*2:e}function xj(t,e){const{scales:n,markState:r}=e,[o,c]=IR(n,r),{itemMarker:l,itemMarkerLineWidth:u}=t;if(u!==void 0)return u;const d=["line","hyphen","dash","smooth","hv","hvh","vh","vhv"];if(typeof l=="string"&&d.includes(l))return 4;if(typeof l=="function")return(v,m)=>{const _=l(v.id,m);if(typeof _=="string"&&d.includes(_))return 4};if((Array.isArray(c)?c:[c]).some(v=>d.includes(v)))return 4}function Sj(t,e){const{labelFormatter:n=m=>`${m}`}=t,{scales:r,theme:o}=e,c=o.legendCategory.itemMarkerSize,l=bj(r,c),u={itemMarker:yj(Object.assign(Object.assign({},t),{itemMarkerSize:l}),e),itemMarkerSize:l,itemMarkerOpacity:_j(r),itemMarkerLineWidth:xj(t,e)},d=typeof n=="string"?ss(n):n,h=Ra(r,"color"),g=HA(r),v=h?m=>h.map(m):()=>e.theme.color;return Object.assign(Object.assign({},u),{data:g.map(m=>({id:m,label:d(m),color:v(m)}))})}function wj(t,e,n){const{position:r}=e;if(r==="center"){const{bbox:l}=t,{width:u,height:d}=l;return{width:u,height:d}}const{width:o,height:c}=bb(t,e,n);return{width:o,height:c}}function Oj(t){return Object.assign(Object.assign({},t),{data:(t==null?void 0:t.data.filter(e=>e.id!==""&&e.id!==void 0))||[]})}const yL=t=>{const{labelFormatter:e,layout:n,order:r,orientation:o,position:c,size:l,title:u,cols:d,itemMarker:h,render:g}=t,v=mj(t,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker","render"]),{gridRow:m}=v;return _=>{const{value:b,theme:S}=_,{bbox:w}=b,{width:E,height:T}=wj(b,t,yL),M=yb(c,n),P=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(c)?"vertical":"horizontal",width:E,height:T,layout:d!==void 0?"grid":"flex"},d!==void 0&&{gridCol:d}),m!==void 0&&{gridRow:m}),{titleText:Ih(u)}),Sj(t,_)),{legendCategory:R={}}=S,k=Rh(Object.assign({},R,Oj(P),v,{classNamePrefix:cs}));if(g)return new OR({className:gL,style:Object.assign(Object.assign({},k),{x:w.x,y:w.y,render:g})});const F=new zA({style:Object.assign(Object.assign({x:w.x,y:w.y,width:w.width,height:w.height},M),{subOptions:k})});return F.appendChild(new OR({className:"legend-category",style:k})),F}};yL.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const RR=t=>()=>new N.ZA;RR.props={};var Ej=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function kR(t,e,n,r){switch(r){case"center":return{x:t+n/2,y:e,textAlign:"middle"};case"right":return{x:t+n,y:e,textAlign:"right"};default:return{x:t,y:e,textAlign:"left"}}}const Aj=qg({render(t,e){const{width:n,title:r,subtitle:o,spacing:c=2,align:l="left",x:u,y:d}=t,h=Ej(t,["width","title","subtitle","spacing","align","x","y"]);e.style.transform=`translate(${u}, ${d})`;const g=wn(h,"title"),v=wn(h,"subtitle"),_=mb(e,".title","text").attr("className","title").call(Zn,Object.assign(Object.assign(Object.assign({},kR(0,0,n,l)),{fontSize:14,textBaseline:"top",text:r}),g)).node().getLocalBounds();mb(e,".sub-title","text").attr("className","sub-title").call(b=>{if(!o)return b.node().remove();b.node().attr(Object.assign(Object.assign(Object.assign({},kR(0,_.max[1]+c,n,l)),{fontSize:12,textBaseline:"top",text:o}),v))})}}),DR=t=>({value:e,theme:n})=>{const{x:r,y:o,width:c,height:l}=e.bbox;return new Aj({style:nn({},n.title,Object.assign({x:r,y:o,width:c,height:l},t))})};DR.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};function NR({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Tj({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Mj({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Cj(t){return typeof t=="object"?t.valueOf():t}class FR extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=Cj,e!==null)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(NR({map:this.map,initKey:this.initKey},e))}has(e){return super.has(NR({map:this.map,initKey:this.initKey},e))}set(e,n){return super.set(Tj({map:this.map,initKey:this.initKey},e),n)}delete(e){return super.delete(Mj({map:this.map,initKey:this.initKey},e))}}const _L=Symbol("defaultUnknown");function BR(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function jR(t){const{value:e,from:n,to:r,mapper:o,notFoundReturn:c}=t;let l=o.get(e);if(l===void 0){if(c!==_L)return c;l=n.push(e)-1,o.set(e,l)}return r[l%r.length]}function zR(t){return t instanceof Date?e=>`${e}`:typeof t=="object"?e=>JSON.stringify(e):e=>e}class bL extends Cb{getDefaultOptions(){return{domain:[],range:[],unknown:_L}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&BR(this.domainIndexMap,this.getDomain(),this.domainKey),jR({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&BR(this.rangeIndexMap,this.getRange(),this.rangeKey),jR({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=zR(n),this.rangeKey=zR(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new bL(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:n}=this.options;return this.sortedDomain=n?[...e].sort(n):e,this.sortedDomain}}function Pj(t){const e=Math.min(...t);return t.map(n=>n/e)}function Lj(t,e){const n=t.length,r=e-n;return r>0?[...t,...new Array(r).fill(1)]:r<0?t.slice(0,e):t}function Ij(t){return Math.round(t*1e12)/1e12}function Rj(t){const{domain:e,range:n,paddingOuter:r,paddingInner:o,flex:c,round:l,align:u}=t,d=e.length,h=Lj(c,d),[g,v]=n,m=v-g,_=2/d*r+1-1/d*o,b=m/_,S=b*o/d,w=b-d*S,E=Pj(h),T=E.reduce((ut,J)=>ut+J),M=w/T,P=new FR(e.map((ut,J)=>{const lt=E[J]*M;return[ut,l?Math.floor(lt):lt]})),R=new FR(e.map((ut,J)=>{const vt=E[J]*M+S;return[ut,l?Math.floor(vt):vt]})),k=Array.from(R.values()).reduce((ut,J)=>ut+J),W=(m-(k-k/d*o))*u,$=g+W;let rt=l?Math.round($):$;const et=new Array(d);for(let ut=0;ut<d;ut+=1){et[ut]=Ij(rt);const J=e[ut];rt+=R.get(J)}return{valueBandWidth:P,valueStep:R,adjustedRange:et}}function kj(t){var e;const{domain:n}=t,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=t.flex)===null||e===void 0)&&e.length))return Rj(t);const{range:c,paddingOuter:l,paddingInner:u,round:d,align:h}=t;let g,v,m=c[0];const b=c[1]-m,S=l*2,w=r-u;g=b/Math.max(1,S+w),d&&(g=Math.floor(g)),m+=(b-g*(r-u))*h,v=g*(1-u),d&&(m=Math.round(m),v=Math.round(v));const E=new Array(r).fill(0).map((T,M)=>m+M*g);return{valueStep:g,valueBandWidth:v,adjustedRange:E}}class xL extends bL{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:_L,flex:[]}}constructor(e){super(e)}clone(){return new xL(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:n}=this.options;return e>0?e:n}getPaddingOuter(){const{padding:e,paddingOuter:n}=this.options;return e>0?e:n}rescale(){super.rescale();const{align:e,domain:n,range:r,round:o,flex:c}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:d}=kj({align:e,range:r,round:o,flex:c,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=d,this.valueBandWidth=u,this.adjustedRange=l}}var SL=function(t){if(typeof t!="object"||t===null)return t;var e;if((0,Br.Z)(t)){e=[];for(var n=0,r=t.length;n<r;n++)typeof t[n]=="object"&&t[n]!=null?e[n]=SL(t[n]):e[n]=t[n]}else{e={};for(var o in t)typeof t[o]=="object"&&t[o]!=null?e[o]=SL(t[o]):e[o]=t[o]}return e},wL=SL,Dj=function(t){(0,Q.ZT)(e,t);function e(n){var r=this,o=n.style,c=(0,Q._T)(n,["style"]);return r=t.call(this,nn({},{type:"column"},(0,Q.pi)({style:o},c)))||this,r.columnsGroup=new N.ZA({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.columns,o=n.x,c=n.y;this.columnsGroup.style.transform="translate(".concat(o,", ").concat(c,")"),ot(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(l){return l.append("rect").attr("className","column").each(function(u){this.attr(u)})},function(l){return l.each(function(u){this.attr(u)})},function(l){return l.remove()})},e.prototype.update=function(n){this.attr(ha({},this.attributes,n)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(N.s$),Nj=function(t){(0,Q.ZT)(e,t);function e(n){var r=this,o=n.style,c=(0,Q._T)(n,["style"]);return r=t.call(this,nn({},{type:"lines"},(0,Q.pi)({style:o},c)))||this,r.linesGroup=r.appendChild(new N.ZA),r.areasGroup=r.appendChild(new N.ZA),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.lines,o=n.areas,c=n.x,l=n.y;this.style.transform="translate(".concat(c,", ").concat(l,")"),r&&this.renderLines(r),o&&this.renderAreas(o)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(n){this.attr(ha({},this.attributes,n)),this.render()},e.prototype.renderLines=function(n){ot(this.linesGroup).selectAll(".line").data(n).join(function(r){return r.append("path").attr("className","line").each(function(o){this.attr(o)})},function(r){return r.each(function(o){this.attr(o)})},function(r){return r.remove()})},e.prototype.renderAreas=function(n){ot(this.linesGroup).selectAll(".area").data(n).join(function(r){return r.append("path").attr("className","area").each(function(o){this.attr(o)})},function(r){return r.each(function(o){this.style(o)})},function(r){return r.remove()})},e}(N.s$);function Fj(t,e,n,r){var o,c=[],l=!!r,u,d,h=[1/0,1/0],g=[-1/0,-1/0],v,m,_;if(l){o=(0,Q.CR)(r,2),h=o[0],g=o[1];for(var b=0,S=t.length;b<S;b+=1){var w=t[b];h=Rs(h,w),g=Sc(g,w)}}for(var b=0,E=t.length;b<E;b+=1){var w=t[b];if(b===0&&!n)_=w;else if(b===E-1&&!n)m=w,c.push(_),c.push(m);else{var T=[b?b-1:E-1,b-1][n?0:1];u=t[T],d=t[n?(b+1)%E:b+1];var M=[0,0];M=Ju(d,u),M=Ia(M,e);var P=uh(w,u),R=uh(w,d),k=P+R;k!==0&&(P/=k,R/=k);var F=Ia(M,-P),W=Ia(M,R);m=wl(w,F),v=wl(w,W),v=Rs(v,Sc(d,w)),v=Sc(v,Rs(d,w)),F=Ju(v,w),F=Ia(F,-P/R),m=wl(w,F),m=Rs(m,Sc(u,w)),m=Sc(m,Rs(u,w)),W=Ju(w,m),W=Ia(W,R/P),v=wl(w,W),l&&(m=Sc(m,h),m=Rs(m,g),v=Sc(v,h),v=Rs(v,g)),c.push(_),c.push(m),_=v}}return n&&c.push(c.shift()),c}function Bj(t,e,n){var r;e===void 0&&(e=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var o=!!e,c=[],l=0,u=t.length;l<u;l+=2)c.push([t[l],t[l+1]]);for(var d=Fj(c,.4,o,n),h=c.length,g=[],v,m,_,l=0;l<h-1;l+=1)v=d[l*2],m=d[l*2+1],_=c[l+1],g.push(["C",v[0],v[1],m[0],m[1],_[0],_[1]]);return o&&(v=d[h],m=d[h+1],r=(0,Q.CR)(c,1),_=r[0],g.push(["C",v[0],v[1],m[0],m[1],_[0],_[1]])),g}function jj(t,e){var n,r=e.x,o=e.y,c=(0,Q.CR)(o.getOptions().range||[0,0],2),l=c[0],u=c[1];return u>l&&(n=(0,Q.CR)([l,u],2),u=n[0],l=n[1]),t.map(function(d){var h=d.map(function(g,v){return[r.map(v),(0,se.Z)(o.map(g),u,l)]});return h})}function Cy(t,e){e===void 0&&(e=!1);var n=e?t.length-1:0,r=t.map(function(o,c){return(0,Q.ev)([c===n?"M":"L"],(0,Q.CR)(o),!1)});return e?r.reverse():r}function Fw(t,e){if(e===void 0&&(e=!1),t.length<=2)return Cy(t);for(var n=[],r=t.length,o=0;o<r;o+=1){var c=e?t[r-o-1]:t[o];dg(c,n.slice(-2))||n.push.apply(n,(0,Q.ev)([],(0,Q.CR)(c),!1))}var l=Bj(n,!1);return e?l.unshift((0,Q.ev)(["M"],(0,Q.CR)(t[r-1]),!1)):l.unshift((0,Q.ev)(["M"],(0,Q.CR)(t[0]),!1)),l}function OL(t,e,n){var r=wL(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}function zj(t,e,n,r){return t.map(function(o){return OL(e?Fw(o):Cy(o),n,r)})}function Uj(t,e,n){for(var r=[],o=t.length-1;o>=0;o-=1){var c=t[o],l=Cy(c),u=void 0;if(o===0)u=OL(l,e,n);else{var d=t[o-1],h=Cy(d,!0);h[0][0]="L",u=(0,Q.ev)((0,Q.ev)((0,Q.ev)([],(0,Q.CR)(l),!1),(0,Q.CR)(h),!1),[["Z"]],!1)}r.push(u)}return r}function Zj(t,e,n){for(var r=[],o=t.length-1;o>=0;o-=1){var c=t[o],l=Fw(c),u=void 0;if(o===0)u=OL(l,e,n);else{var d=t[o-1],h=Fw(d,!0),g=c[0];h[0][0]="L",u=(0,Q.ev)((0,Q.ev)((0,Q.ev)([],(0,Q.CR)(l),!1),(0,Q.CR)(h),!1),[(0,Q.ev)(["M"],(0,Q.CR)(g),!1),["Z"]],!1)}r.push(u)}return r}var UR=L(71523),Hj=function(t,e){if((0,Br.Z)(t)){for(var n,r=1/0,o=0;o<t.length;o++){var c=t[o],l=(0,Eo.Z)(e)?e(c):c[e];l<r&&(n=c,r=l)}return n}},ZR=L(13882),Wj=function(t,e){if((0,Br.Z)(t)){for(var n,r=-1/0,o=0;o<t.length;o++){var c=t[o],l=(0,Eo.Z)(e)?e(c):c[e];l>r&&(n=c,r=l)}return n}};function HR(t){return t.length===0?[0,0]:[(0,UR.Z)(Hj(t,function(e){return(0,UR.Z)(e)||0})),(0,ZR.Z)(Wj(t,function(e){return(0,ZR.Z)(e)||0}))]}function WR(t){for(var e=wL(t),n=e[0].length,r=(0,Q.CR)([Array(n).fill(0),Array(n).fill(0)],2),o=r[0],c=r[1],l=0;l<e.length;l+=1)for(var u=e[l],d=0;d<n;d+=1)u[d]>=0?(u[d]+=o[d],o[d]=u[d]):(u[d]+=c[d],c[d]=u[d]);return e}var Vj=function(t){(0,Q.ZT)(e,t);function e(n){return t.call(this,n,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var n=this.attributes.data;if(!n||(n==null?void 0:n.length)===0)return[[]];var r=wL(n);return(0,Se.Z)(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?WR(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var n=this.scales.y,r=(0,Q.CR)(n.getOptions().domain||[0,0],2),o=r[0],c=r[1];return c<0?n.map(c):n.map(o<0?0:o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var n=this.attributes,r=n.width,o=n.height;return{width:r,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var n=this,r=this.attributes,o=r.type,c=r.isStack,l=r.smooth;if(o!=="line")throw new Error("linesStyle can only be used in line type");var u=or(this.attributes,"area"),d=or(this.attributes,"line"),h=this.containerShape.width,g=this.data;if(g[0].length===0)return{lines:[],areas:[]};var v=this.scales,m=v.x,_=v.y,b=jj(g,{type:"line",x:m,y:_}),S=[];if(u){var w=this.baseline;c?S=l?Zj(b,h,w):Uj(b,h,w):S=zj(b,l,h,w)}return{lines:b.map(function(E,T){return(0,Q.pi)({stroke:n.getColor(T),d:l?Fw(E):Cy(E)},d)}),areas:S.map(function(E,T){return(0,Q.pi)({d:E,fill:n.getColor(T)},u)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var n=this,r=or(this.attributes,"column"),o=this.attributes,c=o.isStack,l=o.type,u=o.scale;if(l!=="column")throw new Error("columnsStyle can only be used in column type");var d=this.containerShape.height,h=this.rawData;if(!h)return{columns:[]};c&&(h=WR(h));var g=this.createScales(h),v=g.x,m=g.y,_=(0,Q.CR)(HR(h),2),b=_[0],S=_[1],w=new Fs({domain:[0,S-(b>0?0:b)],range:[0,d*u]}),E=v.getBandWidth(),T=this.rawData;return{columns:h.map(function(M,P){return M.map(function(R,k){var F=E/h.length,W=function(){return{x:v.map(k)+F*P,y:R>=0?m.map(R):m.map(0),width:F,height:w.map(Math.abs(R))}},$=function(){return{x:v.map(k),y:m.map(R),width:E,height:w.map(T[P][k])}};return(0,Q.pi)((0,Q.pi)({fill:n.getColor(P)},r),c?$():W())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){Qu(r,".container","rect").attr("className","container").node();var o=n.type,c=n.x,l=n.y,u="spark".concat(o),d=(0,Q.pi)({x:c,y:l},o==="line"?this.linesStyle:this.columnsStyle);ot(r).selectAll(".spark").data([o]).join(function(h){return h.append(function(g){return g==="line"?new Nj({className:u,style:d}):new Dj({className:u,style:d})}).attr("className","spark ".concat(u))},function(h){return h.update(d)},function(h){return h.remove()})},e.prototype.getColor=function(n){var r=this.attributes.color;return(0,Br.Z)(r)?r[n%r.length]:(0,Eo.Z)(r)?r.call(null,n):r},e.prototype.createScales=function(n){var r,o,c=this.attributes,l=c.type,u=c.scale,d=c.range,h=d===void 0?[]:d,g=c.spacing,v=this.containerShape,m=v.width,_=v.height,b=(0,Q.CR)(HR(n),2),S=b[0],w=b[1],E=new Fs({domain:[(r=h[0])!==null&&r!==void 0?r:S,(o=h[1])!==null&&o!==void 0?o:w],range:[_,_*(1-u)]});return l==="line"?{type:l,x:new Fs({domain:[0,n[0].length-1],range:[0,m]}),y:E}:{type:l,x:new xL({domain:n[0].map(function(T,M){return M}),range:[0,m],paddingInner:g,paddingOuter:g/2,align:.5}),y:E}},e.tag="sparkline",e}(Gi),VR=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,(0,Q.pi)((0,Q.pi)((0,Q.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(o){return o.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},ls(zb,"handle")),ls(jb,"handleIcon")),ls(dT,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(o){return function(c){c.stopPropagation(),r.target=o,r.prevPos=r.getOrientVal(Fb(c));var l=r.availableSpace,u=l.x,d=l.y,h=r.getBBox(),g=h.x,v=h.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([u,d])-r.getOrientVal([+g,+v])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(o){var c=r.attributes,l=c.slidable,u=c.brushable,d=c.type;o.stopPropagation();var h=r.getOrientVal(Fb(o)),g=h-r.prevPos;if(g){var v=r.getRatio(g);switch(r.target){case"start":l&&r.setValuesOffset(v);break;case"end":l&&r.setValuesOffset(0,v);break;case"selection":l&&r.setValuesOffset(v,v);break;case"track":if(!u)return;r.selectionWidth+=v,d==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=h}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(o){var c=r.attributes,l=c.onChange,u=c.type,d=u==="range"?o:o[1],h=u==="range"?r.getValues():r.getValues()[1],g=new N.Aw("valuechange",{detail:{oldValue:d,value:h}});r.dispatchEvent(g),l==null||l(h)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(n){this.attributes.values=this.clampValues(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var n=this.attributes.orientation;if(n!=="horizontal")return null;var r=or(this.attributes,"sparkline");return(0,Q.pi)((0,Q.pi)({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var n=this.attributes,r=n.trackLength,o=n.trackSize,c=(0,Q.CR)(this.getOrientVal([[r,o],[o,r]]),2),l=c[0],u=c[1];return{width:l,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.x,o=n.y,c=n.padding,l=(0,Q.CR)(so(c),4),u=l[0],d=l[1],h=l[2],g=l[3],v=this.shape,m=v.width,_=v.height;return{x:g,y:u,width:m-(g+d),height:_-(u+h)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1),this.attributes.values=n;var o=r===!1?!1:this.attributes.animate;this.updateSelectionArea(o),this.updateHandlesPosition(o)},e.prototype.updateSelectionArea=function(n){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(ka.selection.class).each(function(o,c){_o(this,r[c],n)})},e.prototype.updateHandlesPosition=function(n){this.attributes.showHandle&&(this.startHandle&&_o(this.startHandle,this.getHandleStyle("start"),n),this.endHandle&&_o(this.endHandle,this.getHandleStyle("end"),n))},e.prototype.innerSetValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1);var o=this.values,c=this.clampValues(n);this.attributes.values=c,this.setValues(c),r&&this.onValueChange(o)},e.prototype.renderTrack=function(n){var r=this.attributes,o=r.x,c=r.y,l=or(this.attributes,"track");this.trackShape=ot(n).maybeAppendByClassName(ka.track,"rect").styles((0,Q.pi)((0,Q.pi)({x:o,y:c},this.shape),l))},e.prototype.renderBrushArea=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.brushable;this.brushArea=ot(n).maybeAppendByClassName(ka.brushArea,"rect").styles((0,Q.pi)({x:o,y:c,fill:"transparent",cursor:l?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(n){var r=this,o=this.attributes,c=o.x,l=o.y,u=o.orientation,d=ot(n).maybeAppendByClassName(ka.sparklineGroup,"g");Oo(u==="horizontal",d,function(h){var g=(0,Q.pi)((0,Q.pi)({},r.sparklineStyle),{x:c,y:l});h.maybeAppendByClassName(ka.sparkline,function(){return new Vj({style:g})}).update(g)})},e.prototype.renderHandles=function(){var n=this,r,o=this.attributes,c=o.showHandle,l=o.type,u=l==="range"?["start","end"]:["end"],d=c?u:[],h=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(ka.handle.class).data(d.map(function(g){return{type:g}}),function(g){return g.type}).join(function(g){return g.append(function(v){var m=v.type;return new Ub({style:n.getHandleStyle(m)})}).each(function(v){var m=v.type;this.attr("class","".concat(ka.handle.name," ").concat(m,"-handle"));var _="".concat(m,"Handle");h[_]=this,this.addEventListener("pointerdown",h.onDragStart(m))})},function(g){return g.each(function(v){var m=v.type;this.update(h.getHandleStyle(m))})},function(g){return g.each(function(v){var m=v.type,_="".concat(m,"Handle");h[_]=void 0}).remove()})},e.prototype.renderSelection=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.type,u=r.selectionType;this.foregroundGroup=ot(n).maybeAppendByClassName(ka.foreground,"g");var d=or(this.attributes,"selection"),h=function(v){return v.style("visibility",function(m){return m.show?"visible":"hidden"}).style("cursor",function(m){return u==="select"?"grab":u==="invert"?"crosshair":"default"}).styles((0,Q.pi)((0,Q.pi)({},d),{transform:"translate(".concat(o,", ").concat(c,")")}))},g=this;this.foregroundGroup.selectAll(ka.selection.class).data(l==="value"?[]:this.calcSelectionArea().map(function(v,m){return{style:(0,Q.pi)({},v),index:m,show:u==="select"?m===1:m!==1}}),function(v){return v.index}).join(function(v){return v.append("rect").attr("className",ka.selection.name).call(h).each(function(m,_){var b=this;_===1?(g.selectionShape=ot(this),this.on("pointerdown",function(S){b.attr("cursor","grabbing"),g.onDragStart("selection")(S)}),g.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),g.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),g.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){b.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){b.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){b.attr("cursor","pointer")})):this.on("pointerdown",g.onDragStart("track"))})},function(v){return v.call(h)},function(v){return v.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(n,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(n,r){var o;r===void 0&&(r=4);var c=(0,Q.CR)(this.range,2),l=c[0],u=c[1],d=(0,Q.CR)(this.getValues().map(function(w){return hf(w,r)}),2),h=d[0],g=d[1],v=Array.isArray(n)?n:[h,n!=null?n:g],m=(0,Q.CR)((v||[h,g]).map(function(w){return hf(w,r)}),2),_=m[0],b=m[1];if(this.attributes.type==="value")return[0,(0,se.Z)(b,l,u)];_>b&&(o=(0,Q.CR)([b,_],2),_=o[0],b=o[1]);var S=b-_;return S>u-l?[l,u]:_<l?h===l&&g===b?[l,b]:[l,S+l]:b>u?g===u&&h===_?[_,u]:[u-S,u]:[_,b]},e.prototype.calcSelectionArea=function(n){var r=(0,Q.CR)(this.clampValues(n),2),o=r[0],c=r[1],l=this.availableSpace,u=l.x,d=l.y,h=l.width,g=l.height;return this.getOrientVal([[{y:d,height:g,x:u,width:o*h},{y:d,height:g,x:o*h+u,width:(c-o)*h},{y:d,height:g,x:c*h,width:(1-c)*h}],[{x:u,width:h,y:d,height:o*g},{x:u,width:h,y:o*g+d,height:(c-o)*g},{x:u,width:h,y:c*g,height:(1-c)*g}]])},e.prototype.calcHandlePosition=function(n){var r=this.attributes.handleIconOffset,o=this.availableSpace,c=o.x,l=o.y,u=o.width,d=o.height,h=(0,Q.CR)(this.clampValues(),2),g=h[0],v=h[1],m=n==="start"?-r:r,_=(n==="start"?g:v)*this.getOrientVal([u,d])+m;return{x:c+this.getOrientVal([_,u/2]),y:l+this.getOrientVal([d/2,_])}},e.prototype.inferTextStyle=function(n){var r=this.attributes.orientation;return r==="horizontal"?{}:n==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:n==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(n){var r,o=this.attributes,c=o.type,l=o.orientation,u=o.formatter,d=o.autoFitLabel,h=or(this.attributes,"handle"),g=or(h,"label"),v=h.spacing,m=this.getHandleSize(),_=this.clampValues(),b=n==="start"?_[0]:_[1],S=u(b),w=new bg({style:(0,Q.pi)((0,Q.pi)((0,Q.pi)({},g),this.inferTextStyle(n)),{text:S})}),E=w.getBBox(),T=E.width,M=E.height;if(w.destroy(),!d){if(c==="value")return{text:S,x:0,y:-M-v};var P=v+m+(l==="horizontal"?T/2:0);return r={text:S},r[l==="horizontal"?"x":"y"]=n==="start"?-P:P,r}var R=0,k=0,F=this.availableSpace,W=F.width,$=F.height,rt=this.calcSelectionArea()[1],et=rt.x,ut=rt.y,J=rt.width,lt=rt.height,vt=v+m;if(l==="horizontal"){var xt=vt+T/2;if(n==="start"){var Ht=et-vt-T;R=Ht>0?-xt:xt}else{var gt=W-et-J-vt>T;R=gt?xt:-xt}}else{var wt=vt,Wt=M+vt;n==="start"?k=ut-m>M?-Wt:wt:k=$-(ut+lt)-m>M?Wt:-wt}return{x:R,y:k,text:S}},e.prototype.getHandleLabelStyle=function(n){var r=or(this.attributes,"handleLabel");return(0,Q.pi)((0,Q.pi)((0,Q.pi)({},r),this.calcHandleText(n)),this.inferTextStyle(n))},e.prototype.getHandleIconStyle=function(){var n=this.attributes.handleIconShape,r=or(this.attributes,"handleIcon"),o=this.getOrientVal(["ew-resize","ns-resize"]),c=this.getHandleSize();return(0,Q.pi)({cursor:o,shape:n,size:c},r)},e.prototype.getHandleStyle=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.showLabel,u=r.showLabelOnInteraction,d=r.orientation,h=this.calcHandlePosition(n),g=h.x,v=h.y,m=this.calcHandleText(n),_=l;return!l&&u&&(this.target?_=!0:_=!1),(0,Q.pi)((0,Q.pi)((0,Q.pi)({},ls(this.getHandleIconStyle(),"icon")),ls((0,Q.pi)((0,Q.pi)({},this.getHandleLabelStyle(n)),m),"label")),{transform:"translate(".concat(g+o,", ").concat(v+c,")"),orientation:d,showLabel:_,type:n,zIndex:3})},e.prototype.getHandleSize=function(){var n=this.attributes,r=n.handleIconSize,o=n.width,c=n.height;return r||Math.floor((this.getOrientVal([+c,+o])+4)/2.4)},e.prototype.getOrientVal=function(n){var r=(0,Q.CR)(n,2),o=r[0],c=r[1],l=this.attributes.orientation;return l==="horizontal"?o:c},e.prototype.setValuesOffset=function(n,r){r===void 0&&(r=0);var o=this.attributes.type,c=(0,Q.CR)(this.getValues(),2),l=c[0],u=c[1],d=o==="range"?n:0,h=[l+d,u+r].sort();this.innerSetValues(h,!0)},e.prototype.getRatio=function(n){var r=this.availableSpace,o=r.width,c=r.height;return n/this.getOrientVal([o,c])},e.prototype.dispatchCustomEvent=function(n,r,o){var c=this;n.on(r,function(l){l.stopPropagation(),c.dispatchEvent(new N.Aw(o,{detail:l}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var n=this.brushArea;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(n,"pointerleave","trackMouseleave"),n.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(n){var r=this.attributes.scrollable;if(r){var o=n.deltaX,c=n.deltaY,l=c||o,u=this.getRatio(l);this.setValuesOffset(u,u)}},e.tag="slider",e}(Gi),Gj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function $j(t,e,n){const{x:r,y:o,width:c,height:l}=t;if(e==="left")return[r+c-n,o];if(e==="right")return[r,o];if(e==="bottom")return[r,o];if(e==="top")return[r,o+l-n]}const Py=t=>{const{orientation:e,labelFormatter:n,size:r,style:o={},position:c}=t,l=Gj(t,["orientation","labelFormatter","size","style","position"]);return u=>{var d;const{scales:[h],value:g,theme:v,coordinate:m}=u,{bbox:_}=g,{width:b,height:S}=_,{slider:w={}}=v,E=((d=h.getFormatter)===null||d===void 0?void 0:d.call(h))||(W=>W+""),T=typeof n=="string"?ss(n):n,M=e==="horizontal",P=Yr(m)&&M,{trackSize:R=w.trackSize}=o,[k,F]=$j(_,c,R);return new VR({className:"slider",style:Object.assign({},w,Object.assign(Object.assign({x:k,y:F,trackLength:M?b:S,orientation:e,formatter:W=>{const $=T||E,rt=P?1-W:W,et=Us(h,rt,!0);return $(et)},sparklineData:Xj(t,u)},o),l))})}};function Yj(t,e){const[n]=Array.from(t.entries()).filter(([o])=>o.type==="line"||o.type==="area"||o.type==="interval").filter(([o])=>o.slider).map(([o])=>{const{encode:c,slider:l}=o;if(l!=null&&l.x){const u=d=>{const h=c[d];return[d,h?h.value:void 0]};return Object.fromEntries(e.map(u))}});if(!(n!=null&&n.series))return n==null?void 0:n.y;const r=n.series.reduce((o,c,l)=>(o[c]=o[c]||[],o[c].push(n.y[l]),o),{});return Object.values(r)}function Xj(t,e){const{markState:n}=e;return(0,Br.Z)(t.sparklineData)?t.sparklineData:Yj(n,["y","series"])}Py.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const GR=t=>Py(Object.assign(Object.assign({},t),{orientation:"horizontal"}));GR.props=Object.assign(Object.assign({},Py.props),{defaultPosition:"bottom"});const $R=t=>Py(Object.assign(Object.assign({},t),{orientation:"vertical"}));$R.props=Object.assign(Object.assign({},Py.props),{defaultPosition:"left"});var qj=function(t){(0,Q.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(o){var c=r.attributes.value;if(o!==c){var l={detail:{oldValue:o,value:c}};r.dispatchEvent(new N.Aw("scroll",l)),r.dispatchEvent(new N.Aw("valuechange",l))}},r.onTrackClick=function(o){var c=r.attributes.slidable;if(c){var l=(0,Q.CR)(r.getLocalPosition(),2),u=l[0],d=l[1],h=(0,Q.CR)(r.padding,4),g=h[0],v=h[3],m=r.getOrientVal([u+v,d+g]),_=r.getOrientVal(Nb(o)),b=(_-m)/r.trackLength;r.setValue(b,!0)}},r.onThumbMouseenter=function(o){r.dispatchEvent(new N.Aw("thumbMouseenter",{detail:o.detail}))},r.onTrackMouseenter=function(o){r.dispatchEvent(new N.Aw("trackMouseenter",{detail:o.detail}))},r.onThumbMouseleave=function(o){r.dispatchEvent(new N.Aw("thumbMouseleave",{detail:o.detail}))},r.onTrackMouseleave=function(o){r.dispatchEvent(new N.Aw("trackMouseleave",{detail:o.detail}))},r}return Object.defineProperty(e.prototype,"padding",{get:function(){var n=this.attributes.padding;return so(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var n=this.attributes.value,r=(0,Q.CR)(this.range,2),o=r[0],c=r[1];return(0,se.Z)(n,o,c)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLength",{get:function(){var n=this.attributes,r=n.viewportLength,o=n.trackLength,c=o===void 0?r:o;return c},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes.trackSize,r=this.trackLength,o=(0,Q.CR)(this.padding,4),c=o[0],l=o[1],u=o[2],d=o[3],h=(0,Q.CR)(this.getOrientVal([[r,n],[n,r]]),2),g=h[0],v=h[1];return{x:d,y:c,width:+g-(d+l),height:+v-(c+u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackRadius",{get:function(){var n=this.attributes,r=n.isRound,o=n.trackSize;return r?o/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbRadius",{get:function(){var n=this.attributes,r=n.isRound,o=n.thumbRadius;if(!r)return 0;var c=this.availableSpace,l=c.width,u=c.height;return o||this.getOrientVal([u,l])/2},enumerable:!1,configurable:!0}),e.prototype.getValues=function(n){n===void 0&&(n=this.value);var r=this.attributes,o=r.viewportLength,c=r.contentLength,l=o/c,u=(0,Q.CR)(this.range,2),d=u[0],h=u[1],g=n*(h-d-l);return[g,g+l]},e.prototype.getValue=function(){return this.value},e.prototype.renderSlider=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.orientation,u=r.trackSize,d=r.padding,h=r.slidable,g=or(this.attributes,"track"),v=or(this.attributes,"thumb"),m=(0,Q.pi)((0,Q.pi)({x:o,y:c,brushable:!1,orientation:l,padding:d,selectionRadius:this.thumbRadius,showHandle:!1,slidable:h,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:u,values:this.getValues()},ls(g,"track")),ls(v,"selection"));this.slider=ot(n).maybeAppendByClassName("scrollbar",function(){return new VR({style:m})}).update(m).node()},e.prototype.render=function(n,r){this.renderSlider(r)},e.prototype.setValue=function(n,r){r===void 0&&(r=!1);var o=this.attributes.value,c=(0,Q.CR)(this.range,2),l=c[0],u=c[1];this.slider.setValues(this.getValues((0,se.Z)(n,l,u)),r),this.onValueChange(o)},e.prototype.bindEvents=function(){var n=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),n.onTrackClick(r.detail)}),this.onHover()},e.prototype.getOrientVal=function(n){var r=this.attributes.orientation;return r==="horizontal"?n[0]:n[1]},e.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},e.tag="scrollbar",e}(Gi),Kj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Ly=t=>{const{orientation:e,labelFormatter:n,style:r}=t,o=Kj(t,["orientation","labelFormatter","style"]);return({scales:[c],value:l,theme:u})=>{const{bbox:d}=l,{x:h,y:g,width:v,height:m}=d,{scrollbar:_={}}=u,{ratio:b,range:S}=c.getOptions(),w=e==="horizontal"?v:m,E=w/b,[T,M]=S,P=M>T?0:1;return new qj({className:`${cs}scrollbar`,style:Object.assign({},_,Object.assign(Object.assign(Object.assign(Object.assign({},r),{x:h,y:g,trackLength:w,value:P}),o),{orientation:e,contentLength:E,viewportLength:w}))})}};Ly.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const YR=t=>Ly(Object.assign(Object.assign({},t),{orientation:"horizontal"}));YR.props=Object.assign(Object.assign({},Ly.props),{defaultPosition:"bottom"});const XR=t=>Ly(Object.assign(Object.assign({},t),{orientation:"vertical"}));XR.props=Object.assign(Object.assign({},Ly.props),{defaultPosition:"left"});const EL=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:g=1,opacity:v=1}=u.style,[m,_]=Yr(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],b=[{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:g,opacity:v,offset:.01},{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:g,opacity:v}];return u.animate(b,Object.assign(Object.assign({},l),t))}},Qj=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:g=1,opacity:v=1}=u.style,[m,_]=Yr(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],b=[{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m},{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:g,opacity:v,offset:.99},{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(b,Object.assign(Object.assign({},l),t))}},qR=(t,e)=>{const{coordinate:r}=e;return N.ux.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:N.h0.NUMBER}),(o,c,l)=>{const[u]=o,d=g=>{const{__data__:v,style:m}=g,{fillOpacity:_=1,strokeOpacity:b=1,opacity:S=1}=m,{points:w,y:E,y1:T}=v,M=Na(r,w,[E,T]),{innerRadius:P,outerRadius:R}=M,k=[{scaleInYRadius:P+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:P+1e-4,fillOpacity:_,strokeOpacity:b,opacity:S,offset:.01},{scaleInYRadius:R,fillOpacity:_,strokeOpacity:b,opacity:S}];return g.animate(k,Object.assign(Object.assign({},l),t))},h=g=>{const{style:v}=g,{transform:m="",fillOpacity:_=1,strokeOpacity:b=1,opacity:S=1}=v,[w,E]=Yr(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],T=[{transform:`${m} ${E}`.trimStart(),transformOrigin:w,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${m} ${E}`.trimStart(),transformOrigin:w,fillOpacity:_,strokeOpacity:b,opacity:S,offset:.01},{transform:`${m} scale(1, 1)`.trimStart(),transformOrigin:w,fillOpacity:_,strokeOpacity:b,opacity:S}];return g.animate(T,Object.assign(Object.assign({},l),t))};return kr(r)?d(u):h(u)}},Jj=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:g=1,opacity:v=1}=u.style,[m,_]=Yr(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],b=[{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m},{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:g,opacity:v,offset:.99},{transform:`${d} ${_}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(b,Object.assign(Object.assign({},l),t))}},KR=(t,e)=>{N.ux.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:N.h0.NUMBER});const{coordinate:r}=e;return(o,c,l)=>{const[u]=o;if(!kr(r))return EL(t,e)(o,c,l);const{__data__:d,style:h}=u,{radius:g=0,inset:v=0,fillOpacity:m=1,strokeOpacity:_=1,opacity:b=1}=h,{points:S,y:w,y1:E}=d,T=up().cornerRadius(g).padAngle(v*Math.PI/180),M=Na(r,S,[w,E]),{startAngle:P,endAngle:R}=M,k=[{waveInArcAngle:P+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:P+1e-4,fillOpacity:m,strokeOpacity:_,opacity:b,offset:.01},{waveInArcAngle:R,fillOpacity:m,strokeOpacity:_,opacity:b}],F=u.animate(k,Object.assign(Object.assign({},l),t));return F.onframe=function(){u.style.d=T(Object.assign(Object.assign({},M),{endAngle:Number(u.style.waveInArcAngle)}))},F.onfinish=function(){u.style.d=T(Object.assign(Object.assign({},M),{endAngle:R}))},F}};KR.props={};const QR=t=>(e,n,r)=>{const[o]=e,{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=o.style,d=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:c,strokeOpacity:l,opacity:u}];return o.animate(d,Object.assign(Object.assign({},r),t))};QR.props={};const JR=t=>(e,n,r)=>{const[o]=e,{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=o.style,d=[{fillOpacity:c,strokeOpacity:l,opacity:u},{fillOpacity:0,strokeOpacity:0,opacity:0}];return o.animate(d,Object.assign(Object.assign({},r),t))};JR.props={};const tz=t=>(n,r,o)=>{const[c]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:d=1,opacity:h=1}=c.style,g="center center",v=[{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:g,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:g,fillOpacity:u,strokeOpacity:d,opacity:h,offset:.01},{transform:`${l} scale(1)`.trimStart(),transformOrigin:g,fillOpacity:u,strokeOpacity:d,opacity:h}];return c.animate(v,Object.assign(Object.assign({},o),t))},ez=t=>(n,r,o)=>{const[c]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:d=1,opacity:h=1}=c.style,g="center center",v=[{transform:`${l} scale(1)`.trimStart(),transformOrigin:g},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:g,fillOpacity:u,strokeOpacity:d,opacity:h,offset:.99},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:g,fillOpacity:0,strokeOpacity:0,opacity:0}];return c.animate(v,Object.assign(Object.assign({},o),t))},tk=t=>(e,n,r)=>{var o,c;const[l]=e,u=((c=(o=l).getTotalLength)===null||c===void 0?void 0:c.call(o))||0,d=[{lineDash:[0,u]},{lineDash:[u,0]}];return l.animate(d,Object.assign(Object.assign({},r),t))};tk.props={};const nz={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},rz={[N.bn.CIRCLE]:["cx","cy","r"],[N.bn.ELLIPSE]:["cx","cy","rx","ry"],[N.bn.RECT]:["x","y","width","height"],[N.bn.IMAGE]:["x","y","width","height"],[N.bn.LINE]:["x1","y1","x2","y2"],[N.bn.POLYLINE]:["points"],[N.bn.POLYGON]:["points"]};function v0(t,e,n=!1){const r={};for(const o of e){const c=t.style[o];c?r[o]=c:n&&(r[o]=nz[o])}return r}const Iy=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function AL(t){const{min:e,max:n}=t.getLocalBounds(),[r,o]=e,[c,l]=n,u=l-o,d=c-r;return[r,o,d,u]}function iz(t){const[e,n,r,o]=t;return`
    M ${e} ${n}
    L ${e+r} ${n}
    L ${e+r} ${n+o}
    L ${e} ${n+o}
    Z
  `}function oz(t,e){const[n,r,o,c]=AL(t),l=c/o,u=Math.ceil(Math.sqrt(e/l)),d=Math.ceil(e/u),h=[],g=c/d;let v=0,m=e;for(;m>0;){const _=Math.min(m,u),b=o/_;for(let S=0;S<_;S++){const w=n+S*b,E=r+v*g;h.push(iz([w,E,b,g]))}m-=_,v+=1}return h}function az(t="pack"){return typeof t=="function"?t:oz}function sz(t,e,n){let{transform:r}=t.style;const{transform:o}=e.style;ek(e,t);let c=Iy;if(t.nodeName===N.bn.GROUP){const[d,h,g,v]=AL(t),[m,_,b,S]=AL(e),w=d-m,E=h-_,T=g/b,M=v/S;r=`translate(${w}, ${E}) scale(${T}, ${M})`}else c=c.concat(rz[t.nodeName]||[]);const l=[Object.assign({transform:r!=null?r:"none"},v0(t,c,!0)),Object.assign({transform:o!=null?o:"none"},v0(e,c,!0))];return e.animate(l,n)}function ek(t,e){t.__data__=e.__data__,t.className=e.className,t.markType=e.markType,e.parentNode.replaceChild(t,e)}function cz(t,e){const{nodeName:n}=t;if(n==="path")return t;const r=new N.y$({style:Object.assign(Object.assign({},v0(t,Iy)),{d:e})});return ek(r,t),r}function nk(t,e){const n=t.indexOf(e),r=t.lastIndexOf(e);return n===r}function lz(t){return!nk(t,"m")||!nk(t,"M")}function rk(t){const e=(0,N.YR)(t);if(e&&!lz(e))return e}function ik(t){const{nodeName:e}=t;if(e==="path"){const n=er(t,"attributes");return n.markerEnd||n.markerStart}return!1}function TL(t,e,n,r){const{nodeName:o}=e,{nodeName:c}=n,l=rk(e),u=rk(n),{opacity:d=1,strokeOpacity:h=1,fillOpacity:g=1}=e.style,{opacity:v=1,strokeOpacity:m=1,fillOpacity:_=1}=n.style,b=o===c&&o!=="path",S=l===void 0||u===void 0,w=ik(e)||ik(n);if(b||S||w)return sz(e,n,r);const E=cz(t,l),T=Object.assign(Object.assign({},v0(e,Iy)),{opacity:d,strokeOpacity:h,fillOpacity:g}),M=Object.assign(Object.assign({},v0(n,Iy)),{opacity:v,strokeOpacity:m,fillOpacity:_}),P=[T,M];if(l!==u){P[0].d=l,P[1].d=u;const R=E.animate(P,r);return R.onfinish=()=>{Yd(E,n),E.style.d=u,E.style.transform="none"},E.style.transform="none",R}return dg(T,M)?null:E.animate(P,r)}function uz(t,e,n,r){t.style.visibility="hidden";const o=r(t,e.length);return e.map((c,l)=>{const u=new N.y$({style:Object.assign({d:o[l]},v0(t,Iy))});return TL(c,u,c,n)})}function fz(t,e,n,r){const o=r(e,t.length),{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=e.style,d=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:c,strokeOpacity:l,opacity:u}],h=e.animate(d,n);return[...t.map((v,m)=>{const _=new N.y$({style:{d:o[m],fill:e.style.fill}});return TL(v,v,_,n)}),h]}const ok=t=>(e,n,r)=>{const o=az(t.split),c=Object.assign(Object.assign({},r),t),{length:l}=e,{length:u}=n;if(l===1&&u===1||l>1&&u>1){const[d]=e,[h]=n;return TL(d,d,h,c)}if(l===1&&u>1){const[d]=e;return uz(d,n,c,o)}if(l>1&&u===1){const[d]=n;return fz(e,d,c,o)}return null};ok.props={};const ak=(t,e)=>(n,r,o)=>{const[c]=n,{min:[l,u],halfExtents:d}=c.getLocalBounds(),h=d[0]*2,g=d[1]*2,v=new N.y$({style:{d:`M${l},${u}L${l+h},${u}L${l+h},${u+g}L${l},${u+g}Z`}});return c.appendChild(v),c.style.clipPath=v,EL(t,e)([v],r,o)};ak.props={};const sk=(t,e)=>(n,r,o)=>{const[c]=n,{min:[l,u],halfExtents:d}=c.getLocalBounds(),h=d[0]*2,g=d[1]*2,v=new N.y$({style:{d:`M${l},${u}L${l+h},${u}L${l+h},${u+g}L${l},${u+g}Z`}});return c.appendChild(v),c.style.clipPath=v,qR(t,e)([v],r,o)};sk.props={};var dz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function hz(t,{elements:e,datum:n,groupKey:r=b=>b,regionGroupKey:o=b=>b,link:c=!1,background:l=!1,delay:u=60,scale:d,coordinate:h,emitter:g,state:v={},region:m=!1,regionEleFilter:_=b=>Ov.includes(b.markType)}){var b,S;const w=(b=e(t))!==null&&b!==void 0?b:[],E=m?w.filter(_):w,T=new Set(E),M=m?o:r,P=$r(E,M),R=Kx({elementsof:e,root:t,coordinate:h,scale:d}),k=Yl(E,n),[F,W]=$x(Object.assign({elements:E,valueof:k,link:c,coordinate:h},wn(v.active,"link"))),[$,rt,et]=Xx(Object.assign({document:t.ownerDocument,scale:d,coordinate:h,background:l,valueof:k},wn(v.active,"background"))),ut=nn(v,{active:Object.assign({},((S=v.active)===null||S===void 0?void 0:S.offset)&&{transform:(...De)=>{const Je=v.active.offset(...De),[,qe]=De;return Yx(E[qe],Je,h)}})}),J=gp(ut,E),{updateState:lt,removeState:vt,hasState:xt}=J(k);let Ht;const gt=De=>{const{nativeEvent:Je=!0}=De;let qe=De.target;if(m&&(qe=R(De)),!T.has(qe))return;Ht&&clearTimeout(Ht);const We=M(qe),fn=P.get(We),_n=new Set(fn);for(const An of E)_n.has(An)?xt(An,"active")||lt(An,"active"):(lt(An,"inactive"),W(An)),An!==qe&&rt(An);$(qe),F(fn),Je&&g.emit("element:highlight",{nativeEvent:Je,data:{data:n(qe),group:fn.map(n)}})},wt=()=>{Ht&&clearTimeout(Ht),Ht=setTimeout(()=>{Wt(),Ht=null},u)},Wt=(De=!0)=>{for(const Je of E)vt(Je,"active","inactive"),rt(Je),W(Je);De&&g.emit("element:unhighlight",{nativeEvent:De})},fe=De=>{let Je=De.target;if(m&&(Je=R(De)),!Je){u>0?wt():Wt();return}l&&!et(Je)||!l&&!T.has(Je)||(u>0?wt():Wt())},le=()=>{Wt()};t.addEventListener("pointerover",gt),t.addEventListener("pointermove",gt),t.addEventListener("pointerout",fe),t.addEventListener("pointerleave",le);const Te=De=>{const{nativeEvent:Je}=De;Je||Wt(!1)},Fe=De=>{const{nativeEvent:Je}=De;if(Je)return;const{data:qe}=De.data,We=mp(E,qe,n);We&&gt({target:We,nativeEvent:!1})};return g.on("element:highlight",Fe),g.on("element:unhighlight",Te),()=>{t.removeEventListener("pointerover",gt),t.removeEventListener("pointermove",gt),t.removeEventListener("pointerout",fe),t.removeEventListener("pointerleave",le),g.off("element:highlight",Fe),g.off("element:unhighlight",Te);for(const De of E)rt(De),W(De)}}function Bw(t){var{delay:e,createGroup:n,createRegionGroup:r,background:o=!1,link:c=!1}=t,l=dz(t,["delay","createGroup","createRegionGroup","background","link"]);return(u,d,h)=>{const{container:g,view:v,options:m}=u,{scale:_,coordinate:b}=v,S=uo(g);return hz(S,Object.assign({elements:ya,datum:vs(v),groupKey:n?n(v):void 0,regionGroupKey:r?r(v):Of(v),coordinate:b,scale:_,state:Ws(m,[["active",o?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:o,link:c,delay:e,emitter:h},l))}}Bw.props={reapplyWhenUpdate:!0};function ck(t){return Bw(Object.assign(Object.assign({},t),{createGroup:Of}))}ck.props={reapplyWhenUpdate:!0};function lk(t){return Bw(Object.assign(Object.assign({},t),{createGroup:bv}))}lk.props={reapplyWhenUpdate:!0};var pz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function gz(t,{elements:e,datum:n,groupKey:r=S=>S,scaleFactor:o=1.04,shadow:c=!0,shadowColor:l="rgba(0, 0, 0, 0.4)",shadowBlur:u=10,shadowOffsetX:d=0,shadowOffsetY:h=2,zIndex:g=10,delay:v=60,emitter:m,state:_={},coordinate:b}){const S=()=>{var gt;return(gt=e(t))!==null&&gt!==void 0?gt:[]},w=S(),E=Yl(w,n),T=nn(_,{active:{}}),M=gp(T,w),{updateState:P,removeState:R,hasState:k}=M(E),F=new Map;let W;const $=gt=>{if(F.has(gt))return;const wt=gt.style.transform||"",Wt=gt.style.transformOrigin||"",fe=wt==="none"?"":wt;if(F.set(gt,{transform:wt,transformOrigin:Wt,zIndex:gt.style.zIndex||0,shadowColor:gt.style.shadowColor||"",shadowBlur:gt.style.shadowBlur||0,shadowOffsetX:gt.style.shadowOffsetX||0,shadowOffsetY:gt.style.shadowOffsetY||0}),b&&kr(b)&&!fe){const Te=b.getCenter();gt.style.transformOrigin=`${Te[0]}px ${Te[1]}px`}const le=`scale(${o})`;gt.style.transform=fe?`${fe} ${le}`:le,gt.style.zIndex=g,c&&(gt.style.shadowColor=l,gt.style.shadowBlur=u,gt.style.shadowOffsetX=d,gt.style.shadowOffsetY=h)},rt=gt=>{const wt=F.get(gt);wt&&(gt.style.transform=wt.transform,gt.style.transformOrigin=wt.transformOrigin,gt.style.zIndex=wt.zIndex,gt.style.shadowColor=wt.shadowColor,gt.style.shadowBlur=wt.shadowBlur,gt.style.shadowOffsetX=wt.shadowOffsetX,gt.style.shadowOffsetY=wt.shadowOffsetY,F.delete(gt))},et=gt=>{const{nativeEvent:wt=!0}=gt,Wt=gt.target,fe=S();if(!new Set(fe).has(Wt))return;W&&clearTimeout(W);const Te=$r(fe,r),Fe=r(Wt),De=Te.get(Fe);if(!De)return;const Je=new Set(De);for(const qe of fe)Je.has(qe)||(R(qe,"active"),rt(qe));for(const qe of De)k(qe,"active")||P(qe,"active"),$(qe);wt&&m.emit("element:hoverscale",{nativeEvent:wt,data:{data:n(Wt),group:De.map(n)}})},ut=()=>{W&&clearTimeout(W),W=setTimeout(()=>{J(),W=null},v)},J=(gt=!0)=>{const wt=S();for(const Wt of wt)R(Wt,"active"),rt(Wt);gt&&m.emit("element:unhoverscale",{nativeEvent:gt})},lt=()=>{v>0?ut():J()},vt=()=>{J()};t.addEventListener("pointerover",et),t.addEventListener("pointermove",et),t.addEventListener("pointerout",lt),t.addEventListener("pointerleave",vt);const xt=gt=>{const{nativeEvent:wt}=gt;wt||J(!1)},Ht=gt=>{const{nativeEvent:wt}=gt;if(wt)return;const{data:Wt}=gt.data,fe=S(),le=mp(fe,Wt,n);le&&et({target:le,nativeEvent:!1})};return m.on("element:hoverscale",Ht),m.on("element:unhoverscale",xt),()=>{t.removeEventListener("pointerover",et),t.removeEventListener("pointermove",et),t.removeEventListener("pointerout",lt),t.removeEventListener("pointerleave",vt),m.off("element:hoverscale",Ht),m.off("element:unhoverscale",xt);const gt=S();for(const wt of gt)rt(wt);F.clear()}}function uk(t){var{delay:e,createGroup:n,scale:r,shadow:o,shadowColor:c,shadowBlur:l,shadowOffsetX:u,shadowOffsetY:d,zIndex:h}=t,g=pz(t,["delay","createGroup","scale","shadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","zIndex"]);return(v,m,_)=>{const{container:b,view:S,options:w}=v,E=uo(b),T=vs(S),{coordinate:M}=S;return gz(E,Object.assign({elements:ya,datum:T,groupKey:n?P=>n(S)(T(P)):void 0,state:Ws(w,["active"]),scaleFactor:r,shadow:o,shadowColor:c,shadowBlur:l,shadowOffsetX:u,shadowOffsetY:d,zIndex:h,delay:e,emitter:_,coordinate:M},g))}}uk.props={reapplyWhenUpdate:!0};var vz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function mz(t,{elements:e,datum:n,groupKey:r=S=>S,regionGroupKey:o=S=>S,link:c=!1,single:l=!1,multipleSelectHotkey:u,coordinate:d,background:h=!1,scale:g,emitter:v,state:m={},region:_=!1,regionEleFilter:b=S=>Ov.includes(S.markType)}){var S;const w=e(t),E=new Set(w),T=Kx({elementsof:e,root:t,coordinate:d,scale:g}),M=$r(w,r),P=$r(w,o),R=Yl(w,n),[k,F]=$x(Object.assign({link:c,elements:w,valueof:R,coordinate:d},wn(m.selected,"link"))),[W,$]=Xx(Object.assign({document:t.ownerDocument,background:h,coordinate:d,scale:g,valueof:R},wn(m.selected,"background"))),rt=nn(m,{selected:Object.assign({},((S=m.selected)===null||S===void 0?void 0:S.offset)&&{transform:(...We)=>{const fn=m.selected.offset(...We),[,_n]=We;return Yx(w[_n],fn,d)}})}),et=gp(rt,w),{updateState:ut,removeState:J,hasState:lt}=et(R);let vt=!l,xt=null;const Ht=(We=!0)=>{for(const fn of w)J(fn,"selected","unselected"),F(fn),$(fn);We&&v.emit("element:unselect",{nativeEvent:!0})},gt=({event:We,element:fn,nativeEvent:_n=!0,filter:An=Fn=>!0,groupBy:xn=r,groupMap:On=M})=>{const Fn=w.filter(An);if(lt(fn,"selected"))Ht();else{const Hn=xn(fn),qn=On.get(Hn),Rn=new Set(qn);for(const Bn of Fn)Rn.has(Bn)?ut(Bn,"selected"):(ut(Bn,"unselected"),F(Bn)),Bn!==fn&&$(Bn);if(k(qn),W(fn),!_n)return;v.emit("element:select",Object.assign(Object.assign({},We),{nativeEvent:_n,data:{data:[n(fn),...qn.map(n)]}}))}},wt=({event:We,element:fn,nativeEvent:_n=!0,filter:An=Fn=>!0,groupBy:xn=r,groupMap:On=M})=>{const Fn=xn(fn),Hn=On.get(Fn),qn=new Set(Hn),Rn=w.filter(An);if(lt(fn,"selected")){if(!w.some(Yn=>!qn.has(Yn)&&lt(Yn,"selected")))return Ht();for(const Yn of Hn)ut(Yn,"unselected"),F(Yn),$(Yn)}else{const Bn=Hn.some(Yn=>lt(Yn,"selected"));for(const Yn of Rn)qn.has(Yn)?ut(Yn,"selected"):lt(Yn,"selected")||ut(Yn,"unselected");!Bn&&c&&k(Hn),W(fn)}_n&&v.emit("element:select",Object.assign(Object.assign({},We),{nativeEvent:_n,data:{data:w.filter(Bn=>lt(Bn,"selected")).map(n)}}))},Wt=We=>{if(E.has(We))return!0;for(const fn of E)if(xf(fn,An=>An===We))return!0;return!1},fe=We=>{if(E.has(We))return We;for(const fn of E){let _n=null;if(xf(fn,An=>{An===We&&(_n=fn)}),_n)return _n}return We},le=We=>{const{target:fn,nativeEvent:_n=!0}=We,An=vt?wt:gt;let xn=fn;const On=Wt(fn);return!_||On?On?An({event:We,element:fe(xn),nativeEvent:_n,groupBy:r}):Ht():(xn=T(We),E.has(xn)?An({event:We,element:xn,nativeEvent:_n,filter:b,groupBy:o,groupMap:P}):Ht())},Te=Array.isArray(u)?u:[u],Fe=We=>{Te.includes(We.code)&&!xt&&(xt=We.code,vt=!0)},De=We=>{We.code===xt&&(xt=null,vt=!1)};t.addEventListener("click",le),u&&(vt=!1,document.addEventListener("keydown",Fe),document.addEventListener("keyup",De));const Je=We=>{const{nativeEvent:fn,data:_n}=We;if(fn)return;const An=vt?_n.data:_n.data.slice(0,1);for(const xn of An){const On=mp(w,xn,n);le({target:On,nativeEvent:!1})}},qe=()=>{Ht(!1)};return v.on("element:select",Je),v.on("element:unselect",qe),()=>{for(const We of w)F(We);t.removeEventListener("click",le),u&&(document.removeEventListener("keydown",Fe),document.removeEventListener("keyup",De)),v.off("element:select",Je),v.off("element:unselect",qe)}}function jw(t){var{createGroup:e,createRegionGroup:n,background:r=!1,link:o=!1}=t,c=vz(t,["createGroup","createRegionGroup","background","link"]);return(l,u,d)=>{const{container:h,view:g,options:v}=l,{coordinate:m,scale:_}=g,b=uo(h);return mz(b,Object.assign({elements:ya,datum:vs(g),groupKey:e?e(g):void 0,regionGroupKey:n?n(g):Of(g),coordinate:m,scale:_,state:Ws(v,[["selected",r?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:r,link:o,emitter:d},c))}}jw.props={reapplyWhenUpdate:!0};function fk(t){return jw(Object.assign(Object.assign({},t),{createGroup:Of}))}fk.props={reapplyWhenUpdate:!0};function dk(t){return jw(Object.assign(Object.assign({},t),{createGroup:bv}))}dk.props={reapplyWhenUpdate:!0};function yz(t){const{coordinate:e={}}=t,{transform:n=[]}=e,r=n.find(c=>c.type==="fisheye");if(r)return r;const o={type:"fisheye"};return n.push(o),e.transform=n,t.coordinate=e,o}function _z({wait:t=30,leading:e,trailing:n=!1}){return r=>{const{options:o,update:c,setState:l,container:u}=r,d=uo(u),h=rl(g=>{const v=Bc(d,g);if(!v){l("fisheye"),c();return}l("fisheye",m=>{const _=nn({},m,{interaction:{tooltip:{preserve:!0}}});for(const E of _.marks)E.animate=!1;const[b,S]=v,w=yz(_);return w.focusX=b,w.focusY=S,w.visual=!0,_}),c()},t,{leading:e,trailing:n});return d.addEventListener("pointerenter",h),d.addEventListener("pointermove",h),d.addEventListener("pointerleave",h),()=>{d.removeEventListener("pointerenter",h),d.removeEventListener("pointermove",h),d.removeEventListener("pointerleave",h)}}}var bz=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},xz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Sz(t){const{transform:e=[]}=t,n=e.find(o=>o.type==="normalizeY");if(n)return n;const r={type:"normalizeY"};return e.push(r),t.transform=e,r}function wz(t,e,n){const[r]=Array.from(t.entries()).filter(([o])=>o.type===e).map(([o])=>{const{encode:c}=o,l=u=>{const d=c[u];return[u,d?d.value:void 0]};return Object.fromEntries(n.map(l))});return r}function hk(t){var{wait:e=20,leading:n,trailing:r=!1,labelFormatter:o=l=>`${l}`}=t,c=xz(t,["wait","leading","trailing","labelFormatter"]);return l=>{const{view:u,container:d,update:h,setState:g}=l,{markState:v,scale:m,coordinate:_}=u,b=wz(v,"line",["x","y","series"]);if(!b)return;const{y:S,x:w,series:E=[]}=b,T=S.map((Ht,gt)=>gt),M=ja(T.map(Ht=>w[Ht])),P=uo(d),R=d.getElementsByClassName(cn),k=d.getElementsByClassName(me),W=$r(k,Ht=>Ht.__data__.key.split("-")[0]),$=new N.x1({style:Object.assign({x1:0,y1:0,x2:0,y2:P.getAttribute("height"),stroke:"black",lineWidth:1},wn(c,"rule"))}),rt=new N.xv({style:Object.assign({x:0,y:P.getAttribute("height"),text:"",fontSize:10},wn(c,"label"))});$.append(rt),P.appendChild($);const et=(Ht,gt,wt)=>{const[Wt]=Ht.invert(wt),fe=gt.invert(Wt);return M[MI(M,fe)]},ut=(Ht,gt)=>{$.setAttribute("x1",Ht[0]),$.setAttribute("x2",Ht[0]),rt.setAttribute("text",o(gt))};let J;const lt=Ht=>bz(this,void 0,void 0,function*(){const{x:gt}=m,wt=et(_,gt,Ht);ut(Ht,wt),g("chartIndex",fe=>{const le=nn({},fe),Te=le.marks.find(We=>We.type==="line"),De=Rr(Bd(T,We=>Rr(We,fn=>+S[fn])/Ho(We,fn=>+S[fn]),We=>E[We]).values()),Je=[1/De,De];nn(Te,{scale:{y:{domain:Je}}});const qe=Sz(Te);qe.groupBy="color",qe.basis=(We,fn)=>{const _n=We[Ua(An=>w[+An]).center(We,wt)];return fn[_n]};for(const We of le.marks)We.animate=!1;return le}),J=(yield h("chartIndex")).view}),vt=Ht=>{const{scale:gt,coordinate:wt}=J,{x:Wt,y:fe}=gt,le=et(wt,Wt,Ht);ut(Ht,le);for(const Te of R){const{seriesIndex:Fe,key:De}=Te.__data__,Je=Fe[Ua(On=>w[+On]).center(Fe,le)],qe=[0,fe.map(1)],We=[0,fe.map(S[Je]/S[Fe[0]])],[,fn]=wt.map(qe),[,_n]=wt.map(We),An=fn-_n;Te.setAttribute("transform",`translate(0, ${An})`);const xn=W.get(De)||[];for(const On of xn)On.setAttribute("dy",An)}},xt=rl(Ht=>{const gt=Bc(P,Ht);gt&&vt(gt)},e,{leading:n,trailing:r});return lt([0,0]),P.addEventListener("pointerenter",xt),P.addEventListener("pointermove",xt),P.addEventListener("pointerleave",xt),()=>{$.remove(),P.removeEventListener("pointerenter",xt),P.removeEventListener("pointermove",xt),P.removeEventListener("pointerleave",xt)}}}hk.props={reapplyWhenUpdate:!0};function Oz(){return(t,e,n)=>{const{container:r,view:o,options:c}=t,l=vL(r),u=ya(r),d=_=>mL(_).scales[0].name,h=_=>{const{scale:{[_]:b}}=o;return b},g=Ws(c,["active","inactive"]),v=Yl(u,vs(o)),m=[];for(const _ of l){const b=Wt=>{const{data:fe}=_.attributes,{__data__:le}=Wt,{index:Te}=le;return fe[Te].label},S=d(_),w=CR(_),E=h(S),T=$r(u,Wt=>E.invert(Wt.__data__[S])),{state:M={}}=_.attributes,{inactive:P={}}=M,{setState:R,removeState:k}=Hs(g,v),F={inactive:wn(P,"marker")},W={inactive:wn(P,"label")},{setState:$,removeState:rt}=Hs(F),{setState:et,removeState:ut}=Hs(W),J=Wt=>{for(const fe of w){const le=AR(fe),Te=TR(fe);fe===Wt||Wt===null?(rt(le,"inactive"),ut(Te,"inactive")):($(le,"inactive"),et(Te,"inactive"))}},lt=(Wt,fe)=>{const le=b(fe),Te=new Set(T.get(le));for(const De of u)Te.has(De)?R(De,"active"):R(De,"inactive");J(fe);const{nativeEvent:Fe=!0}=Wt;Fe&&n.emit("legend:highlight",Object.assign(Object.assign({},Wt),{nativeEvent:Fe,data:{channel:S,value:le}}))},vt=new Map;for(const Wt of w){const fe=le=>{lt(le,Wt)};Wt.addEventListener("pointerover",fe),vt.set(Wt,fe)}const xt=Wt=>{for(const le of u)k(le,"inactive","active");J(null);const{nativeEvent:fe=!0}=Wt;fe&&n.emit("legend:unhighlight",{nativeEvent:fe})},Ht=Wt=>{const{nativeEvent:fe,data:le}=Wt;if(fe)return;const{channel:Te,value:Fe}=le;if(Te!==S)return;const De=w.find(Je=>b(Je)===Fe);De&&lt({nativeEvent:!1},De)},gt=Wt=>{const{nativeEvent:fe}=Wt;fe||xt({nativeEvent:!1})};_.addEventListener("pointerleave",xt),n.on("legend:highlight",Ht),n.on("legend:unhighlight",gt);const wt=()=>{_.removeEventListener(xt),n.off("legend:highlight",Ht),n.off("legend:unhighlight",gt);for(const[Wt,fe]of vt)Wt.removeEventListener(fe)};m.push(wt)}return()=>m.forEach(_=>_())}}var Ka=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Ez(t,e){const[n,r,o,c]=t,[l,u,d,h]=e;return!(l>o||d<n||u>c||h<r)}function Az(t,e,n,r,o){const[c,l,u,d]=o;return[Math.max(c,Math.min(t,n)),Math.max(l,Math.min(e,r)),Math.min(u,Math.max(t,n)),Math.min(d,Math.max(e,r))]}function Tz(t){const{width:e,height:n}=t.getBBox();return[0,0,e,n]}function ol(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}const pk=kc(t=>{const e=t.attributes,{x:n,y:r,width:o,height:c,class:l,renders:u={},handleSize:d=10,document:h}=e,g=Ka(e,["x","y","width","height","class","renders","handleSize","document"]);if(!h||o===void 0||c===void 0||n===void 0||r===void 0)return;const v=d/2,m=(Fe,De,Je)=>{Fe.handle||(Fe.handle=Je.createElement("rect"),Fe.append(Fe.handle));const{handle:qe}=Fe;return qe.attr(De),qe},_=wn(Xd(g,"handleNW","handleNE"),"handleN"),{render:b=m}=_,S=Ka(_,["render"]),w=wn(g,"handleE"),{render:E=m}=w,T=Ka(w,["render"]),M=wn(Xd(g,"handleSE","handleSW"),"handleS"),{render:P=m}=M,R=Ka(M,["render"]),k=wn(g,"handleW"),{render:F=m}=k,W=Ka(k,["render"]),$=wn(g,"handleNW"),{render:rt=m}=$,et=Ka($,["render"]),ut=wn(g,"handleNE"),{render:J=m}=ut,lt=Ka(ut,["render"]),vt=wn(g,"handleSE"),{render:xt=m}=vt,Ht=Ka(vt,["render"]),gt=wn(g,"handleSW"),{render:wt=m}=gt,Wt=Ka(gt,["render"]),fe=(Fe,De)=>{const{id:Je}=Fe,qe=De(Fe,Fe.attributes,h);qe.id=Je,qe.style.draggable=!0},le=Fe=>()=>{const De=kc(Je=>fe(Je,Fe));return new De({})},Te=Kn(t).attr("className",l).style("transform",`translate(${n}, ${r})`).style("draggable",!0);Te.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(ol,Object.assign(Object.assign({width:o,height:c},Xd(g,"handle")),{transform:void 0})),Te.maybeAppend("handle-n",le(b)).style("x",v).style("y",-v).style("width",o-d).style("height",d).style("fill","transparent").call(ol,S),Te.maybeAppend("handle-e",le(E)).style("x",o-v).style("y",v).style("width",d).style("height",c-d).style("fill","transparent").call(ol,T),Te.maybeAppend("handle-s",le(P)).style("x",v).style("y",c-v).style("width",o-d).style("height",d).style("fill","transparent").call(ol,R),Te.maybeAppend("handle-w",le(F)).style("x",-v).style("y",v).style("width",d).style("height",c-d).style("fill","transparent").call(ol,W),Te.maybeAppend("handle-nw",le(rt)).style("x",-v).style("y",-v).style("width",d).style("height",d).style("fill","transparent").call(ol,et),Te.maybeAppend("handle-ne",le(J)).style("x",o-v).style("y",-v).style("width",d).style("height",d).style("fill","transparent").call(ol,lt),Te.maybeAppend("handle-se",le(xt)).style("x",o-v).style("y",c-v).style("width",d).style("height",d).style("fill","transparent").call(ol,Ht),Te.maybeAppend("handle-sw",le(wt)).style("x",-v).style("y",c-v).style("width",d).style("height",d).style("fill","transparent").call(ol,Wt)});function ML(t,e){var{brushed:n=()=>{},brushended:r=()=>{},brushcreated:o=()=>{},brushstarted:c=()=>{},brushupdated:l=()=>{},extent:u=Tz(t),brushRegion:d=(qe,We,fn,_n,An)=>[qe,We,fn,_n],reverse:h=!1,fill:g="#777",fillOpacity:v="0.3",stroke:m="#fff",selectedHandles:_=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=e,b=Ka(e,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let S=null,w=null,E=null,T=null,M=null,P=!1;const[R,k,F,W]=u;ra(t,"crosshair"),t.style.draggable=!0;const $=(qe,We,fn)=>{if(c(fn),T&&T.remove(),M&&M.remove(),S=[qe,We],h)return rt();et()},rt=()=>{M=new N.y$({style:Object.assign(Object.assign({},b),{fill:g,fillOpacity:v,stroke:m,pointerEvents:"none"})}),T=new pk({style:{x:0,y:0,width:0,height:0,draggable:!0,document:t.ownerDocument},className:"mask"}),t.appendChild(M),t.appendChild(T)},et=()=>{T=new pk({style:Object.assign(Object.assign({document:t.ownerDocument,x:0,y:0},b),{fill:g,fillOpacity:v,stroke:m,draggable:!0}),className:"mask"}),t.appendChild(T)},ut=(qe=!0)=>{T&&T.remove(),M&&M.remove(),S=null,w=null,E=null,P=!1,T=null,M=null,r(qe)},J=(qe,We,fn=!0)=>{const[_n,An,xn,On]=Az(qe[0],qe[1],We[0],We[1],u),[Fn,Hn,qn,Rn]=d(_n,An,xn,On,u);return h?vt(Fn,Hn,qn,Rn):lt(Fn,Hn,qn,Rn),n(Fn,Hn,qn,Rn,fn),[Fn,Hn,qn,Rn]},lt=(qe,We,fn,_n)=>{T.style.x=qe,T.style.y=We,T.style.width=fn-qe,T.style.height=_n-We},vt=(qe,We,fn,_n)=>{M.style.d=`
      M${R},${k}L${F},${k}L${F},${W}L${R},${W}Z
      M${qe},${We}L${qe},${_n}L${fn},${_n}L${fn},${We}Z
    `,T.style.x=qe,T.style.y=We,T.style.width=fn-qe,T.style.height=_n-We},xt=qe=>{const We=(Hn,qn,Rn,Bn,Yn)=>Hn+qn<Bn?Bn-qn:Hn+Rn>Yn?Yn-Rn:Hn,fn=qe[0]-E[0],_n=qe[1]-E[1],An=We(fn,S[0],w[0],R,F),xn=We(_n,S[1],w[1],k,W),On=[S[0]+An,S[1]+xn],Fn=[w[0]+An,w[1]+xn];J(On,Fn)},Ht={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},gt=qe=>Wt(qe)||wt(qe),wt=qe=>{const{id:We}=qe;return _.indexOf(We)===-1?!1:new Set(Object.keys(Ht)).has(We)},Wt=qe=>qe===T.getElementById("selection"),fe=qe=>{const{target:We}=qe,[fn,_n]=_v(t,qe);if(!T||!gt(We)){$(fn,_n,qe),P=!0;return}gt(We)&&(E=[fn,_n])},le=qe=>{const{target:We}=qe,fn=_v(t,qe);if(!S)return;if(!E)return J(S,fn);if(Wt(We))return xt(fn);const[_n,An]=[fn[0]-E[0],fn[1]-E[1]],{id:xn}=We;if(Ht[xn]){const[On,Fn,Hn,qn]=Ht[xn].vector;return J([S[0]+_n*On,S[1]+An*Fn],[w[0]+_n*Hn,w[1]+An*qn])}},Te=qe=>{if(E){E=null;const{x:xn,y:On,width:Fn,height:Hn}=T.style;S=[xn,On],w=[xn+Fn,On+Hn],l(xn,On,xn+Fn,On+Hn,qe);return}w=_v(t,qe);const[We,fn,_n,An]=J(S,w);P=!1,o(We,fn,_n,An,qe)},Fe=qe=>{const{target:We}=qe;T&&!gt(We)&&ut()},De=qe=>{const{target:We}=qe;!T||!gt(We)||P?ra(t,"crosshair"):Wt(We)?ra(t,"move"):wt(We)&&ra(t,Ht[We.id].cursor)},Je=()=>{ra(t,"default")};return t.addEventListener("dragstart",fe),t.addEventListener("drag",le),t.addEventListener("dragend",Te),t.addEventListener("click",Fe),t.addEventListener("pointermove",De),t.addEventListener("pointerleave",Je),{mask:T,move(qe,We,fn,_n,An=!0){T||$(qe,We,{}),S=[qe,We],w=[fn,_n],J([qe,We],[fn,_n],An)},remove(qe=!0){T&&ut(qe)},destroy(){T&&ut(!1),ra(t,"default"),t.removeEventListener("dragstart",fe),t.removeEventListener("drag",le),t.removeEventListener("dragend",Te),t.removeEventListener("click",Fe),t.removeEventListener("pointermove",De),t.removeEventListener("pointerleave",Je)}}}function CL(t,e,n){return e.filter(r=>{if(r===t)return!1;const{interaction:o={}}=r.options;return Object.values(o).find(c=>c.brushKey===n)})}function Mz(t,e,n){return CL(t,e,n).map(r=>uo(r.container))}function Cz(t,e,n){return CL(t,e,n).map(r=>r.options)}function gk(t,e){var{elements:n,selectedHandles:r,siblings:o=le=>[],datum:c,brushRegion:l,extent:u,reverse:d,scale:h,coordinate:g,series:v=!1,key:m=le=>le,bboxOf:_=le=>{const{x:Te,y:Fe,width:De,height:Je}=le.style;return{x:Te,y:Fe,width:De,height:Je}},state:b={},emitter:S}=e,w=Ka(e,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const E=n(t),T=o(t),M=T.flatMap(n),P=Yl(E,c),R=wn(w,"mask"),{setState:k,removeState:F}=Hs(b,P),W=new Map,{width:$,height:rt,x:et=0,y:ut=0}=_(t),J=u||[0,0,$,rt],lt=()=>{for(const le of[...E,...M])F(le,"active","inactive")},vt=(le,Te,Fe,De)=>{var Je;for(const We of T)(Je=We.brush)===null||Je===void 0||Je.remove();const qe=new Set;for(const We of E){const{min:fn,max:_n}=We.getLocalBounds(),[An,xn]=fn,[On,Fn]=_n;Ez([An,xn,On,Fn],[le,Te,Fe,De])?(k(We,"active"),qe.add(m(We))):k(We,"inactive")}for(const We of M)qe.has(m(We))?k(We,"active"):k(We,"inactive")},xt=()=>{for(const le of E)F(le,"inactive");for(const le of W.values())le.remove();W.clear()},Ht=(le,Te,Fe,De)=>{const Je=We=>{const fn=We.cloneNode();return fn.__data__=We.__data__,We.parentNode.appendChild(fn),W.set(We,fn),fn},qe=new N.UL({style:{x:le+et,y:Te+ut,width:Fe-le,height:De-Te}});t.appendChild(qe);for(const We of E){const fn=W.get(We)||Je(We);fn.style.clipPath=qe,k(We,"inactive"),k(fn,"active")}},gt=ML(t,Object.assign(Object.assign({},R),{extent:J,brushRegion:l,reverse:d,selectedHandles:r,brushended:le=>{const Te=v?xt:lt;le&&S.emit("brush:remove",{nativeEvent:!0}),Te()},brushed:(le,Te,Fe,De,Je)=>{const qe=cp(le,Te,Fe,De,h,g);Je&&S.emit("brush:highlight",{nativeEvent:!0,data:{selection:qe}}),(v?Ht:vt)(le,Te,Fe,De)},brushcreated:(le,Te,Fe,De,Je)=>{const qe=cp(le,Te,Fe,De,h,g);S.emit("brush:end",Object.assign(Object.assign({},Je),{nativeEvent:!0,data:{selection:qe}}))},brushupdated:(le,Te,Fe,De,Je)=>{const qe=cp(le,Te,Fe,De,h,g);S.emit("brush:end",Object.assign(Object.assign({},Je),{nativeEvent:!0,data:{selection:qe}}))},brushstarted:le=>{S.emit("brush:start",le)}})),wt=({nativeEvent:le,data:Te})=>{if(le)return;const{selection:Fe}=Te,[De,Je,qe,We]=Zx(Fe,h,g);gt.move(De,Je,qe,We,!1)};S.on("brush:highlight",wt);const Wt=({nativeEvent:le}={})=>{le||gt.remove(!1)};S.on("brush:remove",Wt);const fe=gt.destroy.bind(gt);return gt.destroy=()=>{S.off("brush:highlight",wt),S.off("brush:remove",Wt),fe()},gt}function zw(t){var{facet:e,brushKey:n}=t,r=Ka(t,["facet","brushKey"]);return(o,c,l)=>{const{container:u,view:d,options:h}=o,g=uo(u),v={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},m=["active",["inactive",{opacity:.5}]],{scale:_,coordinate:b}=d;if(e){const w=g.getBounds(),E=w.min[0],T=w.min[1],M=w.max[0],P=w.max[1];return gk(g.parentNode.parentNode,Object.assign(Object.assign({elements:()=>Vx(o,c),datum:vs(Gl(o,c).map(R=>R.view)),brushRegion:(R,k,F,W)=>[R,k,F,W],extent:[E,T,M,P],state:Ws(Gl(o,c).map(R=>R.options),m),emitter:l,scale:_,coordinate:b,selectedHandles:void 0},v),r))}const S=gk(g,Object.assign(Object.assign({elements:ya,key:w=>w.__data__.key,siblings:()=>Mz(o,c,n),datum:vs([d,...CL(o,c,n).map(w=>w.view)]),brushRegion:(w,E,T,M)=>[w,E,T,M],extent:void 0,state:Ws([h,...Cz(o,c,n)],m),emitter:l,scale:_,coordinate:b,selectedHandles:void 0},v),r));return g.brush=S,()=>S.destroy()}}zw.props={reapplyWhenUpdate:!0};function PL(t,e,n,r,o){const[,c,,l]=o;return[t,c,n,l]}function Pz(t){return zw(Object.assign(Object.assign({},t),{brushRegion:PL,selectedHandles:["handle-e","handle-w"]}))}function LL(t,e,n,r,o){const[c,,l]=o;return[c,e,l,r]}function Lz(t){return zw(Object.assign(Object.assign({},t),{brushRegion:LL,selectedHandles:["handle-n","handle-s"]}))}var IL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Iz="axis",Rz="axis-line",kz="axis-main-group",vk="axis-hot-area";function Dz(t){return t.getElementsByClassName(Iz)}function mk(t){return t.getElementsByClassName(Rz)[0]}function Nz(t){return t.getElementsByClassName(kz)[0]}function yk(t){return Nz(t).getLocalBounds()}function Fz(t,e){var{cross:n,offsetX:r,offsetY:o}=e,c=IL(e,["cross","offsetX","offsetY"]);const l=yk(t),u=mk(t),[d]=u.getLocalBounds().min,[h,g]=l.min,[v,m]=l.max,_=(v-h)*2;return{brushRegion:LL,hotZone:new N.UL({className:vk,style:Object.assign({width:n?_/2:_,transform:`translate(${(n?h:d-_/2).toFixed(2)}, ${g})`,height:m-g},c)}),extent:n?(b,S,w,E)=>[-1/0,S,1/0,E]:(b,S,w,E)=>[Math.floor(h-r),S,Math.ceil(v-r),E]}}function Bz(t,e){var{offsetY:n,offsetX:r,cross:o=!1}=e,c=IL(e,["offsetY","offsetX","cross"]);const l=yk(t),u=mk(t),[,d]=u.getLocalBounds().min,[h,g]=l.min,[v,m]=l.max,_=m-g;return{brushRegion:PL,hotZone:new N.UL({className:vk,style:Object.assign({width:v-h,height:o?_:_*2,transform:`translate(${h}, ${o?g:d-_})`},c)}),extent:o?(b,S,w,E)=>[b,-1/0,w,1/0]:(b,S,w,E)=>[b,Math.floor(g-n),w,Math.ceil(m-n)]}}function jz(t,e){var{axes:n,elements:r,points:o,horizontal:c,datum:l,offsetY:u,offsetX:d,reverse:h=!1,state:g={},emitter:v,coordinate:m}=e,_=IL(e,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const b=r(t),S=n(t),w=Yl(b,l),{setState:E,removeState:T}=Hs(g,w),M=new Map,P=wn(_,"mask"),R=wt=>Array.from(M.values()).every(([Wt,fe,le,Te])=>wt.some(([Fe,De])=>Fe>=Wt&&Fe<=le&&De>=fe&&De<=Te)),k=S.map(wt=>wt.attributes.scale),F=wt=>wt.length>2?[wt[0],wt[wt.length-1]]:wt,W=new Map,$=()=>{W.clear();for(let wt=0;wt<S.length;wt++){const Wt=k[wt],{domain:fe}=Wt.getOptions();W.set(wt,F(fe))}};$();const rt=(wt,Wt)=>{const fe=[];for(const Te of b){const Fe=o(Te);R(Fe)?(E(Te,"active"),fe.push(Te)):E(Te,"inactive")}if(W.set(wt,ut(fe,wt)),!Wt)return;const le=()=>{if(!J)return Array.from(W.values());const Te=[];for(const[Fe,De]of W){const Je=k[Fe],{name:qe}=Je.getOptions();qe==="x"?Te[0]=De:Te[1]=De}return Te};v.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:le()}})},et=wt=>{for(const Wt of b)T(Wt,"active","inactive");$(),wt&&v.emit("brushAxis:remove",{nativeEvent:!0})},ut=(wt,Wt)=>{const fe=k[Wt],{name:le}=fe.getOptions(),Te=wt.map(Fe=>{const De=Fe.__data__;return fe.invert(De[le])});return F(gs(fe,Te))},J=S.some(c)&&S.some(wt=>!c(wt)),lt=[];for(let wt=0;wt<S.length;wt++){const Wt=S[wt],fe=c(Wt)?Bz:Fz,{hotZone:le,brushRegion:Te,extent:Fe}=fe(Wt,{offsetY:u,offsetX:d,cross:J,zIndex:999,fill:"transparent"});Wt.parentNode.appendChild(le);const De=ML(le,Object.assign(Object.assign({},P),{reverse:h,brushRegion:Te,brushended(Je){M.delete(Wt),Array.from(M.entries()).length===0?et(Je):rt(wt,Je)},brushed(Je,qe,We,fn,_n){M.set(Wt,Fe(Je,qe,We,fn)),rt(wt,_n)}}));lt.push(De)}const vt=(wt={})=>{const{nativeEvent:Wt}=wt;Wt||lt.forEach(fe=>fe.remove(!1))},xt=(wt,Wt,fe)=>{const[le,Te]=wt,Fe=qe=>qe.getStep?qe.getStep():0,De=Ht(le,Wt,fe),Je=Ht(Te,Wt,fe)+Fe(Wt);return c(fe)?[De,-1/0,Je,1/0]:[-1/0,De,1/0,Je]},Ht=(wt,Wt,fe)=>{const{height:le,width:Te}=m.getOptions(),Fe=Wt.clone();return c(fe)?Fe.update({range:[0,Te]}):Fe.update({range:[le,0]}),Fe.map(wt)},gt=wt=>{const{nativeEvent:Wt}=wt;if(Wt)return;const{selection:fe}=wt.data;for(let le=0;le<lt.length;le++){const Te=fe[le],Fe=lt[le],De=S[le];if(Te){const Je=k[le];Fe.move(...xt(Te,Je,De),!1)}else Fe.remove(!1)}};return v.on("brushAxis:remove",vt),v.on("brushAxis:highlight",gt),()=>{lt.forEach(wt=>wt.destroy()),v.off("brushAxis:remove",vt),v.off("brushAxis:highlight",gt)}}function zz(t){return(e,n,r)=>{const{container:o,view:c,options:l}=e,u=uo(o),{x:d,y:h}=u.getBBox(),{coordinate:g}=c;return jz(o,Object.assign({elements:ya,axes:Dz,offsetY:h,offsetX:d,points:v=>v.__data__.points,horizontal:v=>{const{startPos:[m,_],endPos:[b,S]}=v.attributes;return m!==b&&_===S},datum:vs(c),state:Ws(l,["active",["inactive",{opacity:.5}]]),coordinate:g,emitter:r},t))}}var Uz=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},_k=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Zz(t=300){let e=null;return n=>{const{timeStamp:r}=n;return e!==null&&r-e<t?(e=r,!0):(e=r,!1)}}function Hz(t,e){var{filter:n,reset:r,brushRegion:o,extent:c,reverse:l,emitter:u,scale:d,coordinate:h,selection:g,series:v=!1}=e,m=_k(e,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const _=wn(m,"mask"),{width:b,height:S}=t.getBBox(),w=c||[0,0,b,S],E=Zz(),T=ML(t,Object.assign(Object.assign({},_),{extent:w,brushRegion:o,reverse:l,brushcreated:M}));t.addEventListener("click",P);function M(k,F,W,$,rt){k===W&&F===$||(rt.nativeEvent=!0,n(g(k,F,W,$),rt),T.remove())}function P(k){E(k)&&(k.nativeEvent=!0,r(k))}const R=({nativeEvent:k,data:F})=>{if(k)return;const{selection:W}=F;n(W,{nativeEvent:!1})};return u.on("brush:filter",R),()=>{T.destroy(),u.off("brush:filter",R),t.removeEventListener("click",P)}}function RL(t){var{hideX:e=!0,hideY:n=!0}=t,r=_k(t,["hideX","hideY"]);return(o,c,l)=>{const{container:u,view:d,options:h,update:g,setState:v}=o,m=uo(u),_={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let b=!1,S=!1,w=d;const{scale:E,coordinate:T}=d;return Hz(m,Object.assign(Object.assign({brushRegion:(M,P,R,k)=>[M,P,R,k],selection:(M,P,R,k)=>{const{scale:F,coordinate:W}=w;return cp(M,P,R,k,F,W)},filter:(M,P)=>Uz(this,void 0,void 0,function*(){if(S)return;S=!0;const[R,k]=M;v("brushFilter",W=>{const{marks:$}=W,rt=$.map(et=>nn({axis:Object.assign(Object.assign({},e&&{x:{transform:[{type:"hide"}]}}),n&&{y:{transform:[{type:"hide"}]}})},et,{scale:{x:{domain:R,nice:!1},y:{domain:k,nice:!1}}}));return Object.assign(Object.assign({},h),{marks:rt,clip:!0})}),l.emit("brush:filter",Object.assign(Object.assign({},P),{data:{selection:[R,k]}})),w=(yield g()).view,S=!1,b=!0}),reset:M=>{if(S||!b)return;const{scale:P}=d,{x:R,y:k}=P,F=R.getOptions().domain,W=k.getOptions().domain;l.emit("brush:filter",Object.assign(Object.assign({},M),{data:{selection:[F,W]}})),b=!1,w=d,v("brushFilter"),g()},extent:void 0,emitter:l,scale:E,coordinate:T},_),r))}}function Wz(t){return RL(Object.assign(Object.assign({hideX:!0},t),{brushRegion:PL}))}function Vz(t){return RL(Object.assign(Object.assign({hideY:!0},t),{brushRegion:LL}))}function bk(t,e,n){const r=t?n:e,o=t?e:n,c=ps(r),l=ps(o),u=o.getOptions().domain,d=!l&&u&&u.length>=2&&u[0]===0;return{currentScale:r,targetScale:o,isSourceDiscrete:c,isTargetDiscrete:l,shouldPreserveZeroBaseline:d}}function Gz(t,e,n,r,o){const c=t?r:n,l=_=>{const b={};return Object.keys(o).forEach(S=>{(S===_||S.match(new RegExp(`^${_}\\d+$`)))&&(b[S]=o[S])}),b},u=l(t?"x":"y"),d=Object.keys(u),h=d.map(_=>e[_]),g=ps(c),v=h.map(_=>ps(_)),m=h.map((_,b)=>{const S=_.getOptions().domain;return!v[b]&&S&&S.length>=2&&S[0]===0});return{currentScale:c,targetScales:h,isSourceDiscrete:g,isTargetDiscrete:v,shouldPreserveZeroBaseline:m,targetScaleKeys:d}}function $z(t){return Array.from(new Set(t)).sort((n,r)=>n-r)}function Yz({isTargetDiscrete:t,filteredValues:e,shouldPreserveZeroBaseline:n}){if(t)return $z(e);{const r=Math.min(...e),o=Math.max(...e);return n?[0,o]:[r,o]}}function Ry(t){return t instanceof Date?t.getTime():typeof t=="string"?parseFloat(t):Number(t)}function kL(t,e,n,r,o,c="filter",l=!1){if(Ev(c))return[];const u=l?"y":"x",d=l?"x":"y",h=[];for(const g of t){const{channelData:v}=g,m=v[u]||[],_=v[d]||[],b=Array.isArray(m[0])?m[0]:m,S=Array.isArray(_[0]);if(b.length===0)continue;const w=b.length;for(let E=0;E<w;E++){const T=b[E];let M=!1;if(n)M=e.includes(T);else if(e.length>=2){const P=Ry(T),R=Ry(e[0]),k=Ry(e[e.length-1]);!isNaN(P)&&!isNaN(R)&&!isNaN(k)&&(M=P>=R&&P<=k)}if(c==="filter"&&M){if(S){const P=_.length;for(let R=0;R<P;R++){const k=_[R];if(Array.isArray(k)&&E<k.length){const F=k[E],W=Ry(F);isNaN(W)||h.push(W)}}}else if(E<_.length){const P=_[E],R=Ry(P);isNaN(R)||h.push(R)}}}}return h.length>0?Yz({isTargetDiscrete:r,filteredValues:h,shouldPreserveZeroBaseline:o}):[]}function Xz({markDataPairs:t,domain:e,scaleInfo:n,adaptiveMode:r,shouldFilterXAxis:o=!1}){const{isSourceDiscrete:c,isTargetDiscrete:l,shouldPreserveZeroBaseline:u}=n;return kL(t,e,c,l,u,r,o)}function qz({markDataPairs:t,domain:e,scaleInfo:n,markToScaleMap:r,adaptiveMode:o,shouldFilterXAxis:c=!1}){const l=new Map,{isSourceDiscrete:u,isTargetDiscrete:d,shouldPreserveZeroBaseline:h,targetScaleKeys:g}=n;return t.forEach(v=>{const m=r.get(v.markKey);if(!m)return;const _=g.indexOf(m);if(_===-1)return;const b=d[_],S=h[_],w=kL([v],e,u,b,S,o,c);l.set(m,w)}),l}function Kz(t,e,n,r,o,c,l=!1,u){const d=new Map;if(t.length===0||e.length===0)return d;const{isSourceDiscrete:h,isTargetDiscrete:g,shouldPreserveZeroBaseline:v}=n,m=u?t.filter(b=>u.get(b.markKey)===o):t.filter(b=>b.markKey===r);if(m.length===0)return d;const _=kL(m,e,h,g,v,c,l);return d.set(o,_),d}function xk(t,e,n,r){r&&e instanceof Map?e.forEach((o,c)=>{o&&Array.isArray(o)&&o.length>0&&(t[c]=o)}):!r&&Array.isArray(e)&&e.length>0&&(t[n?"x":"y"]=e)}var Qz=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const Sk="slider";function wk(t){var e,n,r,o;if(!(t!=null&&t.markState))return 0;let c=0;for(const[l,u]of t.markState.entries()){if(l.type!=="point"||!(u!=null&&u.channels))continue;const d=(e=u.channels)===null||e===void 0?void 0:e.find(h=>h.name==="size");if(d){if(((r=(n=d.scale)===null||n===void 0?void 0:n.range)===null||r===void 0?void 0:r.length)>0){const h=Math.max(...d.scale.range.filter(g=>typeof g=="number"));c=Math.max(c,h);continue}if(((o=d.values)===null||o===void 0?void 0:o.length)>0){const h=d.values.filter(g=>g.value!==void 0).flatMap(g=>Array.isArray(g.value)?g.value:[g.value]).filter(g=>typeof g=="number"&&!isNaN(g));h.length>0&&(c=Math.max(c,...h))}}}return c}function Ok(t,e,n,r,o,c,l){if(l){const u=c?r:o.x,d=c?o.y:r;t.emit(e,Object.assign(Object.assign({},n),{nativeEvent:l,data:{selection:[Uw(u),Uw(d)]}}))}}function Ek(t,e,n,r){const{domain0:o,filteredDomain:c,channel0:l,channel1:u,prefix:d,hasState:h,isMultiAxis:g,markToScaleMap:v,enableAdaptiveFiltering:m}=r;g&&c instanceof Map?t(e,_=>Object.assign({},tU(_,n,{[l]:{domain:o,nice:!1}},d,h,l,u,v||new Map,c))):t(e,_=>Object.assign({},Jz(_,n,Object.assign({[l]:{domain:o,nice:!1}},m&&Array.isArray(c)?{[u]:{domain:c,nice:!0}}:{}),d,h,l,u)))}function Jz(t,e,n,r,o=!1,c="x",l="y"){const{marks:u}=t,d=wk(e),h=u.map(g=>{var v,m;return nn({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},g,{scale:n,[r]:Object.assign(Object.assign({},((v=g[r])===null||v===void 0?void 0:v[c])&&{[c]:Object.assign({preserve:!0},o&&{ratio:null})}),((m=g[r])===null||m===void 0?void 0:m[l])&&{[l]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},t),{marks:h,insetLeft:d,insetRight:d,insetTop:d,insetBottom:d,clip:!0,animate:!1})}function tU(t,e,n,r,o=!1,c="x",l="y",u=new Map,d=new Map){const{marks:h}=t,g=wk(e),v=h.map(m=>{var _,b;const S=typeof(m==null?void 0:m.key)=="string"?m.key:String((m==null?void 0:m.key)||""),w=u.get(S),E=d.get(w),T=E&&{y:Object.assign({domain:E,nice:!0},w!=="y"?{independent:!0}:void 0)};return nn({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},m,{scale:Object.assign(Object.assign({},n),T),[r]:Object.assign(Object.assign({},((_=m[r])===null||_===void 0?void 0:_[c])&&{[c]:Object.assign({preserve:!0},o&&{ratio:null})}),((b=m[r])===null||b===void 0?void 0:b[l])&&{[l]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},t),{marks:v,insetLeft:g,insetRight:g,insetTop:g,insetBottom:g,clip:!0,animate:!1})}function eU(t,e,n){const[r,o]=t,c=n?d=>1-d:d=>d,l=Us(e,c(r),!0),u=Us(e,c(o),!1);return gs(e,[l,u])}function Uw(t){return[t[0],t[t.length-1]]}function Ak({initDomain:t={},className:e=Sk,prefix:n="slider",setValue:r=(g,v)=>g.setValues(v),hasState:o=!1,wait:c=50,leading:l=!0,trailing:u=!1,adaptiveMode:d="filter",getInitValues:h=g=>{var v;const m=(v=g==null?void 0:g.attributes)===null||v===void 0?void 0:v.values;if(m[0]!==0||m[1]!==1)return m}}){return(g,v,m)=>{const{container:_,view:b,update:S,setState:w}=g,E=_.getElementsByClassName(e);if(!E.length)return()=>{};let T=!1;const{scale:M,coordinate:P}=b,{x:R,y:k}=M,F=Yr(P),W=gt=>{const wt=gt==="vertical"?"y":"x",Wt=gt==="vertical"?"x":"y";return F?[Wt,wt]:[wt,Wt]},$=new Map,rt=new Set,et=Tv(b),ut=Qx(b,t,R,k,et),J=Array.from(E),lt=gt=>J.some(wt=>{const{orientation:Wt}=wt.attributes,[fe]=W(Wt);return fe===gt}),vt=lt("x")&&!lt("y"),xt=lt("y")&&!lt("x"),Ht=!Ev(d)&&(vt||xt);for(const gt of E){const{orientation:wt}=gt.attributes,[Wt,fe]=W(wt),le=`${n}${Ls(Wt)}:filter`,Te=Wt==="x",{ratio:Fe}=R.getOptions(),{ratio:De}=k.getOptions(),Je=xn=>{if(xn.data){const{selection:Rn}=xn.data,[Bn=Uw(ut.x),Yn=Uw(ut.y)]=Rn;return Te?[gs(R,Bn,Fe),gs(k,Yn,De)]:[gs(k,Yn,De),gs(R,Bn,Fe)]}const{value:On}=xn.detail,Fn=M[Wt],Hn=eU(On,Fn,F&&wt==="horizontal"),qn=ut[fe];return[Hn,qn]};let qe=!1;const fn=oU({getFiltering:()=>qe,setFiltering:xn=>{qe=xn,xn||(T=!1)},domainsOf:Je,view:b,independentScaleInfo:et,enableAdaptiveFiltering:Ht,hasOnlyXSlider:vt,hasOnlyYSlider:xt,adaptiveMode:d,scaleX:R,scaleY:k,scale:M,channelDomain:ut,channel0:Wt,channel1:fe,isX:Te,emitter:m,eventName:le,setState:w,slider:gt,prefix:n,hasState:o,update:S,wait:c,leading:l,trailing:u}),_n=xn=>{const{nativeEvent:On}=xn;if(On)return;const{data:Fn}=xn,{selection:Hn}=Fn,[qn,Rn]=Hn;gt.dispatchEvent(new N.Aw("valuechange",{data:Fn,nativeEvent:!1}));const Bn=Te?Ux(qn,R):Ux(Rn,k);r(gt,Bn)};m.on(le,_n),gt.addEventListener("valuechange",fn),$.set(gt,fn),rt.add([le,_n]);const An=h(gt);An&&gt.dispatchEvent(new N.Aw("valuechange",{detail:{value:An},nativeEvent:!1,initValue:!0}))}return()=>{for(const[gt,wt]of $)gt.removeEventListener("valuechange",wt);for(const[gt,wt]of rt)m.off(gt,wt)}}}function nU({view:t,domain0:e,shouldFilterXAxis:n,enableAdaptiveFiltering:r,markDataPairs:o,adaptiveMode:c,scaleX:l,scaleY:u,scale:d,channelDomain:h,independentScaleInfo:g,channel0:v}){const m=new Map,_=new Map;if(!r||o.length===0||!(e!=null&&e.length))return{filteredDomain:m,markToScaleMap:_};const b=er(t,"options.slider");if(Object.keys(b).length>0&&Object.prototype.hasOwnProperty.call(b,v)){const w=Gz(n,d,l,u,h);(n?g.markToXScaleMap:g.markToYScaleMap).forEach((M,P)=>{_.set(P,M)});const T=qz({markDataPairs:o,domain:e,scaleInfo:w,markToScaleMap:_,adaptiveMode:c,isViewSlider:!0,shouldFilterXAxis:n});return xk(h,T,n,!0),{filteredDomain:T,markToScaleMap:_}}else{const w=rU(t,v);if(w){const E=bk(n,l,u),T=n?g.markToXScaleMap:g.markToYScaleMap,M=T.get(w)||"";if(M)return _.set(w,M),{filteredDomain:Kz(o,e,E,w,M,c,n,T),markToScaleMap:_}}}return{filteredDomain:m,markToScaleMap:_}}function rU(t,e){for(const[n]of t.markState.entries()){const r=er(n,"slider");if(Object.keys(r||{}).length>0&&Object.prototype.hasOwnProperty.call(r,e))return String(n.key||"")}return null}function iU({domain0:t,domain1:e,shouldFilterXAxis:n,enableAdaptiveFiltering:r,markDataPairs:o,adaptiveMode:c,scaleX:l,scaleY:u,channelDomain:d,hasOnlyXSlider:h,hasOnlyYSlider:g,isX:v}){let m=e;if(r&&o.length>0&&(h&&v||g&&!v)&&(t==null?void 0:t.length)>0){const _=bk(n,l,u);m=Xz({markDataPairs:o,domain:t,scaleInfo:_,adaptiveMode:c,shouldFilterXAxis:n}),xk(d,m,n,!1)}return m}function oU({getFiltering:t,setFiltering:e,domainsOf:n,view:r,independentScaleInfo:o,enableAdaptiveFiltering:c,hasOnlyXSlider:l,hasOnlyYSlider:u,adaptiveMode:d,scaleX:h,scaleY:g,scale:v,channelDomain:m,channel0:_,channel1:b,isX:S,emitter:w,eventName:E,setState:T,slider:M,prefix:P,hasState:R,update:k,wait:F,leading:W,trailing:$}){return rl(rt=>Qz(this,void 0,void 0,function*(){const{initValue:et=!1}=rt;if(t()&&!et)return;e(!0);const{nativeEvent:ut=!0}=rt,{markDataPairs:J}=LM(r);if(o[`hasIndependent${b.toUpperCase()}`]){const[vt]=n(rt),xt=u&&!S,{filteredDomain:Ht,markToScaleMap:gt}=nU({view:r,domain0:vt,shouldFilterXAxis:xt,enableAdaptiveFiltering:c&&(l&&S||u&&!S),markDataPairs:J,adaptiveMode:d,scaleX:h,scaleY:g,scale:v,channelDomain:m,independentScaleInfo:o,channel0:_});m[_]=vt,Ok(w,E,rt,vt,m,S,ut),Ek(T,M,r,{domain0:vt,filteredDomain:Ht,channel0:_,channel1:b,prefix:P,hasState:R,isMultiAxis:!0,markToScaleMap:gt,enableAdaptiveFiltering:c})}else{const[vt,xt]=n(rt),gt=iU({domain0:vt,domain1:xt,shouldFilterXAxis:u&&!S,enableAdaptiveFiltering:c,markDataPairs:J,adaptiveMode:d,scaleX:h,scaleY:g,channelDomain:m,hasOnlyXSlider:l,hasOnlyYSlider:u,isX:S});m[_]=vt,Ok(w,E,rt,vt,m,S,ut),Ek(T,M,r,{domain0:vt,filteredDomain:gt,channel0:_,channel1:b,prefix:P,hasState:R,isMultiAxis:!1,markToScaleMap:void 0,enableAdaptiveFiltering:c})}yield k(),e(!1)}),F,{leading:W,trailing:$})}function aU(t){var e;try{const n=(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView;if(!n||typeof n.getContextService!="function")return null;const r=n.getContextService().getDomElement();return r instanceof HTMLElement?r:null}catch(n){return null}}function Tk({className:t=Sk,setValue:e=(l,u)=>l.setValues(u),minRange:n=.01,wheelSensitivity:r=.05,x:o=!0,y:c=!0}={}){return l=>{const{container:u,view:d}=l,{coordinate:h}=d,g=Yr(h),v=aU(u),m=Math.max(1e-6,Math.min(1,n)),_=u.getElementsByClassName(t);if(!_.length)return()=>{};const b=(T,M)=>T===!0?!0:T===!1?!1:T==="shift"?M.shiftKey&&!M.ctrlKey&&!M.altKey:T==="ctrl"?M.ctrlKey&&!M.shiftKey&&!M.altKey:T==="alt"?M.altKey&&!M.shiftKey&&!M.ctrlKey:!1,S=(T,M)=>{e(T,M),T.dispatchEvent(new N.Aw("valuechange",{detail:{value:M},nativeEvent:!0}))},w=(T,M,P,R,k)=>{const W=(T-M)/P,$=Math.max(0,Math.min(1,W));return Math.max(R,Math.min(k,$))},E=T=>{if(!v)return;const M=T.target;if(!v.contains(M))return;const P=v.getBoundingClientRect(),R=T.clientX-P.left,k=T.clientY-P.top,F=[];for(const W of _){const{values:$,orientation:rt}=W.attributes;if(!$)continue;const et=rt==="horizontal";b((g?et?"y":"x":et?"x":"y")==="x"?o:c,T)&&F.push(W)}if(F.length!==0){T.preventDefault(),T.stopPropagation();for(const W of F){const{values:$,orientation:rt,x:et,y:ut,trackLength:J}=W.attributes,[lt,vt]=$,xt=vt-lt,gt=rt==="horizontal"?w(R,et,J,lt,vt):w(k,ut,J,lt,vt),wt=r*PM(xt),fe=1+T.deltaY*wt,le=Math.max(m,Math.min(1,xt*fe)),Te=(gt-lt)/xt,Fe=(vt-gt)/xt;let De=gt-le*Te,Je=gt+le*Fe;De<0?(De=0,Je=Math.min(1,le)):Je>1&&(Je=1,De=Math.max(0,1-le)),S(W,[De,Je])}}};return v&&v.addEventListener("wheel",E,{passive:!1,capture:!0}),()=>{v&&v.removeEventListener("wheel",E,{capture:!0})}}}Tk.props={reapplyWhenUpdate:!0};const Mk=`${cs}scrollbar`;function sU(t={}){return(e,n,r)=>{const{view:o,container:c}=e;if(!c.getElementsByClassName(Mk).length)return()=>{};const{scale:u}=o,{x:d,y:h}=u,g={x:[...d.getOptions().domain],y:[...h.getOptions().domain]};return d.update({domain:d.getOptions().expectedDomain}),h.update({domain:h.getOptions().expectedDomain}),Ak(Object.assign({initDomain:g,className:Mk,prefix:"scrollbar",hasState:!0,setValue:(m,_)=>m.setValue(_[0]),getInitValues:m=>{const _=m.slider.attributes.values;if(_[0]!==0||_[1]!==1)return _},adaptiveMode:!1},t))(e,n,r)}}var cU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function lU(t,e,n){return`<${t} style="${Object.entries(n).map(([r,o])=>`${_I(r)}:${o}`).join(";")}">${e}</${t}>`}const uU={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function Ck(t){return t.nodeName!=="text"?!1:!!t.isOverflowing()}function Pk(t){var{offsetX:e=8,offsetY:n=8}=t,r=cU(t,["offsetX","offsetY"]);return o=>{const{container:c}=o,[l,u]=c.getBounds().min,d=wn(r,"tip"),h=new Set,g=m=>{const{target:_}=m;if(!Ck(_)){m.stopPropagation();return}const{offsetX:b,offsetY:S}=m,w=b+e-l,E=S+n-u;if(_.tip){_.tip.style.x=w,_.tip.style.y=E;return}const{text:T}=_.style,M=new N.k9({className:"poptip",style:{innerHTML:lU("div",T,Object.assign(Object.assign({},uU),d)),x:w,y:E}});c.appendChild(M),_.tip=M,h.add(M)},v=m=>{const{target:_}=m;if(!Ck(_)){m.stopPropagation();return}_.tip&&(_.tip.remove(),_.tip=null,h.delete(_.tip))};return c.addEventListener("pointerover",g),c.addEventListener("pointerout",v),()=>{c.removeEventListener("pointerover",g),c.removeEventListener("pointerout",v),h.forEach(m=>m.remove())}}}Pk.props={reapplyWhenUpdate:!0};function fU(t,e){var n=td(e),r=n.length;if((0,be.Z)(t))return!r;for(var o=0;o<r;o+=1){var c=n[o];if(e[c]!==t[c]||!(c in t))return!1}return!0}var dU=fU;function hU(t,e){if(!(0,Br.Z)(t))return null;var n;if((0,Eo.Z)(e)&&(n=e),is(e)&&(n=function(o){return dU(o,e)}),n){for(var r=0;r<t.length;r+=1)if(n(t[r]))return t[r]}return null}var m0=hU;function Zw(t){return t==null?null:Lk(t)}function Lk(t){if(typeof t!="function")throw new Error;return t}var pU={depth:-1},Ik={},DL={};function gU(t){return t.id}function vU(t){return t.parentId}function NL(){var t=gU,e=vU,n;function r(o){var c=Array.from(o),l=t,u=e,d,h,g,v,m,_,b,S,w=new Map;if(n!=null){var E=c.map(function(W,$){return mU(n(W,$,o))}),T=E.map(Rk),M=new Set(E).add(""),P=Mm(T),R;try{for(P.s();!(R=P.n()).done;){var k=R.value;M.has(k)||(M.add(k),E.push(k),T.push(Rk(k)),c.push(DL))}}catch(W){P.e(W)}finally{P.f()}l=function($,rt){return E[rt]},u=function($,rt){return T[rt]}}for(g=0,d=c.length;g<d;++g)h=c[g],_=c[g]=new gu(h),(b=l(h,g,o))!=null&&(b+="")&&(S=_.id=b,w.set(S,w.has(S)?Ik:_)),(b=u(h,g,o))!=null&&(b+="")&&(_.parent=b);for(g=0;g<d;++g)if(_=c[g],b=_.parent){if(m=w.get(b),!m)throw new Error("missing: "+b);if(m===Ik)throw new Error("ambiguous: "+b);m.children?m.children.push(_):m.children=[_],_.parent=m}else{if(v)throw new Error("multiple roots");v=_}if(!v)throw new Error("no root");if(n!=null){for(;v.data===DL&&v.children.length===1;)v=v.children[0],--d;for(var F=c.length-1;F>=0&&(_=c[F],_.data===DL);--F)_.data=null}if(v.parent=pU,v.eachBefore(function(W){W.depth=W.parent.depth+1,--d}).eachBefore(xS),v.parent=null,d>0)throw new Error("cycle");return v}return r.id=function(o){return arguments.length?(t=Zw(o),r):t},r.parentId=function(o){return arguments.length?(e=Zw(o),r):e},r.path=function(o){return arguments.length?(n=Zw(o),r):n},r}function mU(t){t="".concat(t);var e=t.length;return FL(t,e-1)&&!FL(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:"/".concat(t)}function Rk(t){var e=t.length;if(e<2)return"";for(;--e>1&&!FL(t,e););return t.slice(0,e)}function FL(t,e){if(t[e]==="/"){for(var n=0;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}function yU(t,e,n,r,o){var c=t.children,l,u=c.length,d,h=new Array(u+1);for(h[0]=d=l=0;l<u;++l)h[l+1]=d+=c[l].value;g(0,u,t.value,e,n,r,o);function g(v,m,_,b,S,w,E){if(v>=m-1){var T=c[v];T.x0=b,T.y0=S,T.x1=w,T.y1=E;return}for(var M=h[v],P=_/2+M,R=v+1,k=m-1;R<k;){var F=R+k>>>1;h[F]<P?R=F+1:k=F}P-h[R-1]<h[R]-P&&v+1<R&&--R;var W=h[R]-M,$=_-W;if(w-b>E-S){var rt=_?(b*$+w*W)/_:w;g(v,R,W,b,S,rt,E),g(R,m,$,rt,S,w,E)}else{var et=_?(S*$+E*W)/_:E;g(v,R,W,b,S,w,et),g(R,m,$,b,et,w,E)}}}function Hw(t,e,n,r,o){for(var c=t.children,l,u=-1,d=c.length,h=t.value&&(o-n)/t.value;++u<d;)l=c[u],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*h}function _U(t,e,n,r,o){(t.depth&1?Hw:Jf)(t,e,n,r,o)}var kk=(1+Math.sqrt(5))/2;function Dk(t,e,n,r,o,c){for(var l=[],u=e.children,d,h,g=0,v=0,m=u.length,_,b,S=e.value,w,E,T,M,P,R,k;g<m;){_=o-n,b=c-r;do w=u[v++].value;while(!w&&v<m);for(E=T=w,R=Math.max(b/_,_/b)/(S*t),k=w*w*R,P=Math.max(T/k,k/E);v<m;++v){if(w+=h=u[v].value,h<E&&(E=h),h>T&&(T=h),k=w*w*R,M=Math.max(T/k,k/E),M>P){w-=h;break}P=M}l.push(d={value:w,dice:_<b,children:u.slice(g,v)}),d.dice?Jf(d,n,r,o,S?r+=b*w/S:c):Hw(d,n,r,S?n+=_*w/S:o,c),S-=w,g=v}return l}var Nk=function t(e){function n(r,o,c,l,u){Dk(e,r,o,c,l,u)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(kk),bU=function t(e){function n(r,o,c,l,u){if((d=r._squarify)&&d.ratio===e)for(var d,h,g,v,m=-1,_,b=d.length,S=r.value;++m<b;){for(h=d[m],g=h.children,v=h.value=0,_=g.length;v<_;++v)h.value+=g[v].value;h.dice?Jf(h,o,c,l,S?c+=(u-c)*h.value/S:u):Hw(h,o,c,S?o+=(l-o)*h.value/S:l,u),S-=h.value}else r._squarify=d=Dk(e,r,o,c,l,u),d.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(kk);function xd(){return 0}function y0(t){return function(){return t}}function xU(){var t=Nk,e=!1,n=1,r=1,o=[0],c=xd,l=xd,u=xd,d=xd,h=xd;function g(m){return m.x0=m.y0=0,m.x1=n,m.y1=r,m.eachBefore(v),o=[0],e&&m.eachBefore(N4),m}function v(m){var _=o[m.depth],b=m.x0+_,S=m.y0+_,w=m.x1-_,E=m.y1-_;w<b&&(b=w=(b+w)/2),E<S&&(S=E=(S+E)/2),m.x0=b,m.y0=S,m.x1=w,m.y1=E,m.children&&(_=o[m.depth+1]=c(m)/2,b+=h(m)-_,S+=l(m)-_,w-=u(m)-_,E-=d(m)-_,w<b&&(b=w=(b+w)/2),E<S&&(S=E=(S+E)/2),t(m,b,S,w,E))}return g.round=function(m){return arguments.length?(e=!!m,g):e},g.size=function(m){return arguments.length?(n=+m[0],r=+m[1],g):[n,r]},g.tile=function(m){return arguments.length?(t=Lk(m),g):t},g.padding=function(m){return arguments.length?g.paddingInner(m).paddingOuter(m):g.paddingInner()},g.paddingInner=function(m){return arguments.length?(c=typeof m=="function"?m:y0(+m),g):c},g.paddingOuter=function(m){return arguments.length?g.paddingTop(m).paddingRight(m).paddingBottom(m).paddingLeft(m):g.paddingTop()},g.paddingTop=function(m){return arguments.length?(l=typeof m=="function"?m:y0(+m),g):l},g.paddingRight=function(m){return arguments.length?(u=typeof m=="function"?m:y0(+m),g):u},g.paddingBottom=function(m){return arguments.length?(d=typeof m=="function"?m:y0(+m),g):d},g.paddingLeft=function(m){return arguments.length?(h=typeof m=="function"?m:y0(+m),g):h},g}function SU(t,e){return Array.isArray(t)?typeof e=="function"?NL().path(e)(t):NL()(t):pu(t)}function Fk(t,e=[t.data.name]){t.id=t.id||t.data.name,t.path=e,t.children&&t.children.forEach(n=>{n.id=`${t.id}/${n.data.name}`,n.path=[...e,n.data.name],Fk(n,n.path)})}function Bk(t){const e=er(t,["data","name"]);e.replaceAll&&(t.path=e.replaceAll(".","/").split("/")),t.children&&t.children.forEach(n=>{Bk(n)})}function wU(t,e){const n={treemapBinary:yU,treemapDice:Jf,treemapSlice:Hw,treemapSliceDice:_U,treemapSquarify:Nk,treemapResquarify:bU},r=t==="treemapSquarify"?n[t].ratio(e):n[t];if(!r)throw new TypeError("Invalid tile method!");return r}function jk(t,e,n){const{value:r}=n,o=wU(e.tile,e.ratio),c=SU(t,e.path);(0,Br.Z)(t)?Bk(c):Fk(c),r?c.sum(d=>e.ignoreParentValue&&d.children?0:ba(r)(d)).sort(e.sort):c.count(),xU().tile(o).size(e.size).round(e.round).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(c);const l=c.descendants().map(d=>Object.assign(d,{id:d.id.replace(/^\//,""),x:[d.x0,d.x1],y:[d.y0,d.y1]}));return[l.filter(typeof e.layer=="function"?e.layer:d=>d.height===e.layer),l]}var OU=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},EU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function AU(t){return Kn(t).select(`.${ct}`).node()}const TU={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function MU(t={}){const{originData:e=[],layout:n}=t,r=EU(t,["originData","layout"]),o=nn({},TU,r),c=wn(o,"breadCrumb"),l=wn(o,"active");return u=>{const{update:d,setState:h,container:g,options:v}=u,m=AU(g),_=v.marks[0],{state:b}=_,S=new N.ZA;m.appendChild(S);const w=(k,F)=>OU(this,void 0,void 0,function*(){if(S.removeChildren(),F){let W="",$=c.y,rt=0;const et=[],ut=m.getBBox().width,J=k.map((lt,vt)=>{W=`${W}${lt}/`,et.push(lt);const xt=new N.xv({name:W.replace(/\/$/,""),style:Object.assign(Object.assign({text:lt,x:rt,path:[...et],depth:vt},c),{y:$})});S.appendChild(xt),rt+=xt.getBBox().width;const Ht=new N.xv({style:Object.assign(Object.assign({x:rt,text:" / "},c),{y:$})});return S.appendChild(Ht),rt+=Ht.getBBox().width,rt>ut&&($=S.getBBox().height+c.y,rt=0,xt.attr({x:rt,y:$}),rt+=xt.getBBox().width,Ht.attr({x:rt,y:$}),rt+=Ht.getBBox().width),vt===Fl(k)-1&&Ht.remove(),xt});J.forEach((lt,vt)=>{if(vt===Fl(J)-1)return;const xt=Object.assign({},lt.attributes);lt.attr("cursor","pointer"),lt.addEventListener("mouseenter",()=>{lt.attr(l)}),lt.addEventListener("mouseleave",()=>{lt.attr(xt)}),lt.addEventListener("click",()=>{w(er(lt,["style","path"]),er(lt,["style","depth"]))})})}uj(g,h),h("treemapDrillDown",W=>{const{marks:$}=W,rt=k.join("/"),et=$.map(ut=>{if(ut.type!=="rect")return ut;let J=e;if(F){const vt=e.filter(Wt=>{const fe=er(Wt,["id"]);return fe&&(fe.match(`${rt}/`)||rt.match(fe))}).map(Wt=>({value:Wt.height===0?er(Wt,["value"]):void 0,name:er(Wt,["id"])})),{paddingLeft:xt,paddingBottom:Ht,paddingRight:gt}=n,wt=Object.assign(Object.assign({},n),{paddingTop:(n.paddingTop||S.getBBox().height+10)/(F+1),paddingLeft:xt/(F+1),paddingBottom:Ht/(F+1),paddingRight:gt/(F+1),path:Wt=>Wt.name,layer:Wt=>Wt.depth===F+1});J=jk(vt,wt,{value:"value"})[0]}else J=e.filter(vt=>vt.depth===1);const lt=[];return J.forEach(({path:vt})=>{lt.push(Jo(vt))}),nn({},ut,{data:J,scale:{color:{domain:lt}}})});return Object.assign(Object.assign({},W),{marks:et})}),yield d(void 0,["legendFilter"])}),E=k=>k.attributes.key.split("-")[0],T=k=>er(k,["__data__","key"]),M=k=>{const F=k.target,{markType:W,nodeName:$,attributes:rt}=F||{};if(W!=="rect"&&$!==N.bn.TEXT)return;const et=$===N.bn.TEXT&&er(rt,"isTreemapLabel")===!0?E(F):T(F),ut=m0(e,J=>J.id===et);er(ut,"height")&&w(er(ut,"path"),er(ut,"depth"))};m.addEventListener("click",M);const P=td(Object.assign(Object.assign({},b.active),b.inactive)),R=()=>{wv(m).forEach(F=>{const W=er(F,["style","cursor"]),$=m0(e,rt=>rt.id===er(F,["__data__","key"]));if(W!=="pointer"&&($!=null&&$.height)){F.style.cursor="pointer";const rt=Wp(F.attributes,P);F.addEventListener("mouseenter",()=>{F.attr(b.active)}),F.addEventListener("mouseleave",()=>{F.attr(nn(rt,b.inactive))})}})};return R(),m.addEventListener("mousemove",R),()=>{S.remove(),m.removeEventListener("click",M),m.removeEventListener("mousemove",R)}}}var CU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function PU(t,e={}){const{valueField:n="value",sort:r,fillParent:o=!0,nameField:c="name"}=e;if(!t||t.length===0)return[];const l=(h,g=null,v=0)=>{const m={data:h,depth:v,parent:g,children:[],x0:0,x1:0,value:h[n]||0};return h.children&&h.children.length>0&&(m.children=h.children.map(_=>l(_,m,v+1))),m},u=[];let d=0;return t.forEach(h=>{const g=l(h),v=(b,S=0,w=!1,E=0)=>{if(w||b.depth===0)b.x0=w?S:0,b.x1=b.x0+b.value;else if(b.x0=S,o&&E>0){const R=b.parent?b.parent.children.reduce((W,$)=>W+$.value,0):b.value,k=b.parent?b.parent.children.length:1,F=R>0?b.value/R:1/k;b.x1=S+E*F}else b.x1=S+b.value;let T=b.x0;const M=b.x1-b.x0,P=r?[...b.children].sort((R,k)=>r(R.data,k.data)):b.children;if(o&&P.length>0){const R=b.children.reduce((k,F)=>k+F.value,0);P.forEach(k=>{v(k,T,!1,M);const F=R>0?k.value/R:1/P.length;T+=M*F})}else P.forEach(R=>{v(R,T,!1,0),T+=R.x1-R.x0})};v(g,d,!0),d+=g.value;const m=b=>{var S,w,E;const T=R=>{var k;return(k=R[c])!==null&&k!==void 0?k:R.name},M=[T(b.data)];let P=b;for(;P.parent;)M.unshift(T(P.parent.data)),P=P.parent;return Object.assign(Object.assign({},Wp(b.data,[n])),{[zk]:M,[jL]:(E=(w=(S=P.parent)===null||S===void 0?void 0:S.data)===null||w===void 0?void 0:w[c])!==null&&E!==void 0?E:b.data[c],name:b.data[c],depth:b.depth,value:b.value,x:[b.x0,b.x1],y:[b.depth,b.depth+1],[Ww]:b.children.length})},_=b=>{u.push(m(b)),b.children.forEach(_)};_(g)}),u}const _0="partition",BL="markType",zk="path",jL="ancestor-node",Ww="childNodeCount";function LU(t){const{data:e,encode:n,fillParent:r,sort:o}=t,{color:c,value:l,name:u}=n;return PU(e,{valueField:l,fillParent:r,nameField:u,sort:o}).map(h=>{const g=Object.assign({},h);return c&&c!==jL&&(g[c]=h[c]),g})}const Uk={id:_0,encode:{x:"x",y:"y",key:zk,color:jL,value:"value",name:"name"},labels:[{style:{pointerEvents:"none"},text:"value",position:"inside",transform:[{type:"overflowHide"}]}],axis:{x:{title:"Time/Order",label:!0},y:!1},style:{[BL]:_0,[Ww]:"childNodeCount"},state:{active:{zIndex:2},inactive:{zIndex:1}},legend:!1,coordinate:{type:"cartesian",grid:!1},interaction:{drillDown:!0}},Zk=t=>{const{encode:e,data:n=[],layout:r={}}=t,o=CU(t,["encode","data","layout"]),{fillParent:c=!0,sort:l}=r,u=Object.assign(Object.assign({},Uk.encode),e),{value:d}=u,h=LU({encode:u,data:n,fillParent:c,sort:l});return[nn({},Uk,Object.assign({type:"rect",data:h,encode:u,tooltip:{title:"path",items:[g=>({name:d,value:g[d]})]},interaction:{elementHighlight:!0}},o))]};Zk.props={};var IU=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const RU=t=>t.querySelectorAll(".element").filter(e=>(e.style||{})[BL]===_0);function kU(t){return Kn(t).select(`.${ct}`).node()}const DU={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.6)",fontSize:11},y:4,active:{fill:"rgba(0, 0, 0, 0.4)"}};function NU(t={}){const{breadCrumb:e={}}=t,n=nn({},DU,e);return r=>{const{update:o,setState:c,container:l,view:u,options:d}=r,h=l.ownerDocument,g=kU(l),v=d.marks.find(({id:T})=>T===_0);if(!v)return;const{state:m}=v,_=h.createElement("g");_.style.transform=`translate(${n.x||0}px, ${n.y||0}px)`,_.setAttribute("x","drilldown-breadcrumb"),g.appendChild(_);const b=T=>IU(this,void 0,void 0,function*(){if(_.removeChildren(),T&&T.length>0){const M=h.createElement("text",{style:Object.assign({text:n.rootText},n.style)});_.appendChild(M);let P="";const R=T;let k=n.style.y,F=M.getBBox().width;const W=g.getBBox().width,$=R.map((et,ut)=>{const J=h.createElement("text",{style:Object.assign(Object.assign({x:F,text:" / "},n.style),{y:k})});_.appendChild(J),F+=J.getBBox().width,P=`${P}${et} / `;const lt=h.createElement("text",{name:P.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:et,x:F},n.style),{y:k})});return _.appendChild(lt),F+=lt.getBBox().width,F>W&&(k=_.getBBox().height,F=0,J.attr({x:F,y:k}),F+=J.getBBox().width,lt.attr({x:F,y:k}),F+=lt.getBBox().width),lt});[M,...$].forEach((et,ut)=>{if(ut===$.length)return;const J=Object.assign({},et.attributes);et.attr("cursor","pointer"),et.addEventListener("mouseenter",()=>{et.attr(n.active)}),et.addEventListener("mouseleave",()=>{et.attr(J)}),et.addEventListener("click",()=>{b(T.slice(0,ut))})})}c("drillDown",M=>{const{marks:P}=M,R=P.map(k=>{if(k.id!==_0&&k.type!=="rect")return k;const{data:F}=k,W=F.filter($=>{var rt;const et=(rt=$.path)!==null&&rt!==void 0?rt:[];if(T.length===0)return!0;if(!Array.isArray(et)||et.length<T.length)return!1;for(let ut=0;ut<T.length;ut++)if(et[ut]!==T[ut])return!1;return!0});return nn({},k,{data:W})});return Object.assign(Object.assign({},M),{marks:R})}),yield o()}),S=T=>{var M,P;const R=T.target,k=R.markType,F=R.style||{},W=F[BL],$=F[Ww],rt=R.__data__;if(k!=="rect"||W!==_0||!$)return;const et=(P=(M=rt==null?void 0:rt.data)===null||M===void 0?void 0:M.path)!==null&&P!==void 0?P:[];b(et)};g.addEventListener("click",S);const w=td(Object.assign(Object.assign({},m.active),m.inactive)),E=()=>{RU(g).forEach(M=>{const P=er(M,["style",Ww]);if(er(M,["style","cursor"])!=="pointer"&&P){M.style.cursor="pointer";const k=Wp(M.attributes,w);M.addEventListener("mouseenter",()=>{M.attr(m.active)}),M.addEventListener("mouseleave",()=>{M.attr(nn(k,m.inactive))})}})};return g.addEventListener("mousemove",E),()=>{_.remove(),g.removeEventListener("click",S),g.removeEventListener("mousemove",E)}}}var zL=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},FU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const BU={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},UL="movePoint",Hk=t=>{const e=t.target,{markType:n}=e;n==="line"&&(e.attr("_lineWidth",e.attr("lineWidth")||1),e.attr("lineWidth",e.attr("_lineWidth")+3)),n==="interval"&&(e.attr("_opacity",e.attr("opacity")||1),e.attr("opacity",.7*e.attr("_opacity")))},Wk=t=>{const e=t.target,{markType:n}=e;n==="line"&&e.attr("lineWidth",e.attr("_lineWidth")),n==="interval"&&e.attr("opacity",e.attr("_opacity"))},jU=(t,e,n)=>e.map(r=>["x","color"].reduce((c,l)=>{const u=n[l];return u&&r[u]!==t[u]?!1:c},!0)?Object.assign(Object.assign({},r),t):r),zU=t=>{const e=er(t,["__data__","y"]),r=er(t,["__data__","y1"])-e,{__data__:{data:o,encode:c,transform:l},childNodes:u}=t.parentNode,d=m0(l,({type:v})=>v==="normalizeY"),h=er(c,["y","field"]),g=o[u.indexOf(t)][h];return(v,m=!1)=>d||m?v/(1-v)/(r/(1-r))*g:v},UU=(t,e)=>{const n=er(t,["__data__","seriesItems",e,"0","value"]),r=er(t,["__data__","seriesIndex",e]),{__data__:{data:o,encode:c,transform:l}}=t.parentNode,u=m0(l,({type:g})=>g==="normalizeY"),d=er(c,["y","field"]),h=o[r][d];return g=>u?n===1?g:g/(1-g)/(n/(1-n))*h:g},Vk=(t,e,n)=>{t.forEach((r,o)=>{r.attr("stroke",e[1]===o?n.activeStroke:n.stroke)})},Gk=(t,e,n,r)=>{const o=new N.y$({style:n}),c=new N.xv({style:r});return e.appendChild(c),t.appendChild(o),[o,c]},$k=(t,e)=>{if(!er(t,["options","range","indexOf"]))return;const r=t.options.range.indexOf(e);return t.sortedDomain[r]},ZL=(t,e,n)=>{const r=Ef(t,e),c=Ef(t,n)/r,l=t[0]+(e[0]-t[0])*c,u=t[1]+(e[1]-t[1])*c;return[l,u]};function ZU(t={}){const{selection:e=[],precision:n=2}=t,r=FU(t,["selection","precision"]),o=Object.assign(Object.assign({},BU),r||{}),c=wn(o,"path"),l=wn(o,"label"),u=wn(o,"point");return(d,h,g)=>{const{update:v,setState:m,container:_,view:b,options:{marks:S,coordinate:w}}=d,E=uo(_);let T=wv(E),M,P=e;const{transform:R=[],type:k}=w,F=!!m0(R,({type:gt})=>gt==="transpose"),W=k==="polar",$=k==="theta",rt=!!m0(T,({markType:gt})=>gt==="area");rt&&(T=T.filter(({markType:gt})=>gt==="area"));const et=new N.ZA({style:{zIndex:2}});E.appendChild(et);const ut=()=>{g.emit("element-point:select",{nativeEvent:!0,data:{selection:P}})},J=(gt,wt)=>{g.emit("element-point:moved",{nativeEvent:!0,data:{changeData:gt,data:wt}})},lt=gt=>{const wt=gt.target;P=[wt.parentNode.childNodes.indexOf(wt)],ut(),xt(wt)},vt=gt=>{const{data:{selection:wt},nativeEvent:Wt}=gt;if(Wt)return;P=wt;const fe=er(T,[P==null?void 0:P[0]]);fe&&xt(fe)},xt=gt=>{const{attributes:wt,markType:Wt,__data__:fe}=gt,{stroke:le}=wt,{points:Te,seriesTitle:Fe,color:De,title:Je,seriesX:qe,y1:We}=fe;if(F&&Wt!=="interval")return;const{scale:fn,coordinate:_n}=(M==null?void 0:M.view)||b,{color:An,y:xn,x:On}=fn,Fn=_n.getCenter();et.removeChildren();let Hn;const qn=(Rn,Bn,Yn,ti)=>zL(this,void 0,void 0,function*(){return m("elementPointMove",ei=>{var Ar;const Bi=(((Ar=M==null?void 0:M.options)===null||Ar===void 0?void 0:Ar.marks)||S).map(Si=>{if(!ti.includes(Si.type))return Si;const{data:Zi,encode:ci}=Si,Ei=Object.keys(ci).reduce((fr,Vr)=>{const Pi=ci[Vr];return Vr==="x"&&(fr[Pi]=Rn),Vr==="y"&&(fr[Pi]=Bn),Vr==="color"&&(fr[Pi]=Yn),fr},{}),ni=jU(Ei,Zi,ci);return J(Ei,ni),nn({},Si,{data:ni,animate:!1})});return Object.assign(Object.assign({},ei),{marks:Bi})}),yield v("elementPointMove")});if(["line","area"].includes(Wt))Te.forEach((Rn,Bn)=>{const Yn=On.invert(qe[Bn]);if(!Yn)return;const ti=new N.Cd({name:UL,style:Object.assign({cx:Rn[0],cy:Rn[1],fill:le},u)}),ei=UU(gt,Bn);ti.addEventListener("mousedown",Ar=>{const Bi=_n.output([qe[Bn],0]),Si=Fe==null?void 0:Fe.length;_.attr("cursor","move"),P[1]!==Bn&&(P[1]=Bn,ut()),Vk(et.childNodes,P,u);const[Zi,ci]=Gk(et,ti,c,l),gi=ni=>{const fr=Rn[1]+ni.clientY-Hn[1];if(rt)if(W){const Vr=Rn[0]+ni.clientX-Hn[0],[Pi,Do]=ZL(Fn,Bi,[Vr,fr]),[,uc]=_n.output([1,xn.output(0)]),[,ju]=_n.invert([Pi,uc-(Te[Bn+Si][1]-Do)]),Ed=(Bn+1)%Si,FO=(Bn-1+Si)%Si,h7=Xl([Te[FO],[Pi,Do],Fe[Ed]&&Te[Ed]]);ci.attr("text",ei(xn.invert(ju)).toFixed(n)),Zi.attr("d",h7),ti.attr("cx",Pi),ti.attr("cy",Do)}else{const[,Vr]=_n.output([1,xn.output(0)]),[,Pi]=_n.invert([Rn[0],Vr-(Te[Bn+Si][1]-fr)]),Do=Xl([Te[Bn-1],[Rn[0],fr],Fe[Bn+1]&&Te[Bn+1]]);ci.attr("text",ei(xn.invert(Pi)).toFixed(n)),Zi.attr("d",Do),ti.attr("cy",fr)}else{const[,Vr]=_n.invert([Rn[0],fr]),Pi=Xl([Te[Bn-1],[Rn[0],fr],Te[Bn+1]]);ci.attr("text",xn.invert(Vr).toFixed(n)),Zi.attr("d",Pi),ti.attr("cy",fr)}};Hn=[Ar.clientX,Ar.clientY],window.addEventListener("mousemove",gi);const Ei=()=>zL(this,void 0,void 0,function*(){if(_.attr("cursor","default"),window.removeEventListener("mousemove",gi),_.removeEventListener("mouseup",Ei),(0,kl.Z)(ci.attr("text")))return;const ni=Number(ci.attr("text")),fr=$k(An,De);M=yield qn(Yn,ni,fr,["line","area"]),ci.remove(),Zi.remove(),xt(gt)});_.addEventListener("mouseup",Ei)}),et.appendChild(ti)}),Vk(et.childNodes,P,u);else if(Wt==="interval"){let Rn=[(Te[0][0]+Te[1][0])/2,Te[0][1]];F?Rn=[Te[0][0],(Te[0][1]+Te[1][1])/2]:$&&(Rn=Te[0]);const Bn=zU(gt),Yn=new N.Cd({name:UL,style:Object.assign(Object.assign({cx:Rn[0],cy:Rn[1],fill:le},u),{stroke:u.activeStroke})});Yn.addEventListener("mousedown",ti=>{_.attr("cursor","move");const ei=$k(An,De),[Ar,Bi]=Gk(et,Yn,c,l),Si=ci=>{if(F){const gi=Rn[0]+ci.clientX-Hn[0],[Ei]=_n.output([xn.output(0),xn.output(0)]),[,ni]=_n.invert([Ei+(gi-Te[2][0]),Rn[1]]),fr=Xl([[gi,Te[0][1]],[gi,Te[1][1]],Te[2],Te[3]],!0);Bi.attr("text",Bn(xn.invert(ni)).toFixed(n)),Ar.attr("d",fr),Yn.attr("cx",gi)}else if($){const gi=Rn[1]+ci.clientY-Hn[1],Ei=Rn[0]+ci.clientX-Hn[0],[ni,fr]=ZL(Fn,[Ei,gi],Rn),[Vr,Pi]=ZL(Fn,[Ei,gi],Te[1]),Do=_n.invert([ni,fr])[1],uc=We-Do;if(uc<0)return;const ju=CM(Fn,[[ni,fr],[Vr,Pi],Te[2],Te[3]],uc>.5?1:0);Bi.attr("text",Bn(uc,!0).toFixed(n)),Ar.attr("d",ju),Yn.attr("cx",ni),Yn.attr("cy",fr)}else{const gi=Rn[1]+ci.clientY-Hn[1],[,Ei]=_n.output([1,xn.output(0)]),[,ni]=_n.invert([Rn[0],Ei-(Te[2][1]-gi)]),fr=Xl([[Te[0][0],gi],[Te[1][0],gi],Te[2],Te[3]],!0);Bi.attr("text",Bn(xn.invert(ni)).toFixed(n)),Ar.attr("d",fr),Yn.attr("cy",gi)}};Hn=[ti.clientX,ti.clientY],window.addEventListener("mousemove",Si);const Zi=()=>zL(this,void 0,void 0,function*(){if(_.attr("cursor","default"),_.removeEventListener("mouseup",Zi),window.removeEventListener("mousemove",Si),(0,kl.Z)(Bi.attr("text")))return;const ci=Number(Bi.attr("text"));M=yield qn(Je,ci,ei,[Wt]),Bi.remove(),Ar.remove(),xt(gt)});_.addEventListener("mouseup",Zi)}),et.appendChild(Yn)}};T.forEach((gt,wt)=>{P[0]===wt&&xt(gt),gt.addEventListener("click",lt),gt.addEventListener("mouseenter",Hk),gt.addEventListener("mouseleave",Wk)});const Ht=gt=>{const wt=gt==null?void 0:gt.target;(!wt||wt.name!==UL&&!T.includes(wt))&&(P=[],ut(),et.removeChildren())};return g.on("element-point:select",vt),g.on("element-point:unselect",Ht),_.addEventListener("mousedown",Ht),()=>{et.remove(),g.off("element-point:select",vt),g.off("element-point:unselect",Ht),_.removeEventListener("mousedown",Ht),T.forEach(gt=>{gt.removeEventListener("click",lt),gt.removeEventListener("mouseenter",Hk),gt.removeEventListener("mouseleave",Wk)})}}}var HU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Yk=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{x:n=0,y:r=0,width:o,height:c,data:l}=t;return e.map(u=>{var{data:d,x:h,y:g,width:v,height:m}=u,_=HU(u,["data","x","y","width","height"]);return Object.assign(Object.assign({},_),{data:mf(d,l),x:h!=null?h:n,y:g!=null?g:r,width:v!=null?v:o,height:m!=null?m:c})})};Yk.props={};var WU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Xk=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{direction:n="row",ratio:r=e.map(()=>1),padding:o=0,data:c}=t,[l,u,d,h]=n==="col"?["y","height","width","x"]:["x","width","height","y"],g=r.reduce((S,w)=>S+w),v=t[u]-o*(e.length-1),m=r.map(S=>v*(S/g)),_=[];let b=t[l]||0;for(let S=0;S<m.length;S+=1){const w=e[S],{data:E}=w,T=WU(w,["data"]),M=mf(E,c);_.push(Object.assign({[l]:b,[u]:m[S],[h]:t[h]||0,[d]:t[d],data:M},T)),b+=m[S]+o}return _};Xk.props={};class ky{constructor(e){this.$value=e}static of(e){return new ky(e)}call(e,...n){return this.$value=e(this.$value,...n),this}value(){return this.$value}}var VU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const GU=vf(t=>{const{encode:e,data:n,scale:r,shareSize:o=!1}=t,{x:c,y:l}=e,u=(d,h)=>{var g;if(d===void 0||!o)return{};const v=$r(n,b=>b[d]),m=((g=r==null?void 0:r[h])===null||g===void 0?void 0:g.domain)||Array.from(v.keys()),_=m.map(b=>v.has(b)?v.get(b).length:1);return{domain:m,flex:_}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:c===void 0?null:{position:"top"}},c===void 0&&{paddingInner:0}),u(c,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:l===void 0?null:{position:"right"}},l===void 0&&{paddingInner:0}),u(l,"y"))}}}),HL=Lc(t=>{const{data:e,scale:n,legend:r}=t,o=[t];let c,l,u;for(;o.length;){const m=o.shift(),{children:_,encode:b={},scale:S={},legend:w={}}=m,{color:E}=b,{color:T}=S,{color:M}=w;E!==void 0&&(c=E),T!==void 0&&(l=T),M!==void 0&&(u=M),Array.isArray(_)&&o.push(..._)}const d=()=>{var m;const _=(m=n==null?void 0:n.color)===null||m===void 0?void 0:m.domain;if(_!==void 0)return[_];if(c===void 0)return[void 0];const b=typeof c=="function"?c:w=>w[c],S=e.map(b);return S.some(w=>typeof w=="number")?[ds(S)]:[Array.from(new Set(S)),"ordinal"]},h=typeof c=="string"?c:"",[g,v]=d();return Object.assign({encode:{color:{type:"column",value:g!=null?g:[]}},scale:{color:nn({},l,{domain:g,type:v})}},r===void 0&&{legend:{color:nn({title:h},u)}})}),WL=vf(()=>({animate:{enterType:"fadeIn"}})),VL=Lc(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),GL=Lc(()=>({type:"cell"})),qk=Lc(t=>{const{data:e}=t;return{data:{type:"inline",value:e,transform:[{type:"custom",callback:()=>{const{data:r,encode:o}=t,{x:c,y:l}=o,u=c?Array.from(new Set(r.map(g=>g[c]))):[],d=l?Array.from(new Set(r.map(g=>g[l]))):[];return(()=>{if(u.length&&d.length){const g=[];for(const v of u)for(const m of d)g.push({[c]:v,[l]:m});return g}if(u.length)return u.map(g=>({[c]:g}));if(d.length)return d.map(g=>({[l]:g}))})()}}]}}}),Kk=Lc((t,e=$U,n=YU,r=XU,o={})=>{const{data:c,encode:l,children:u,scale:d,x:h=0,y:g=0,shareData:v=!1,key:m}=t,{value:_}=c,{x:b,y:S}=l,{color:w}=d,{domain:E}=w;return{children:(M,P,R)=>{const{x:k,y:F}=P,{paddingLeft:W,paddingTop:$,marginLeft:rt,marginTop:et}=R,{domain:ut}=k.getOptions(),{domain:J}=F.getOptions(),lt=_c(M),vt=M.map(e),xt=M.map(({x:le,y:Te})=>[k.invert(le),F.invert(Te)]),gt=xt.map(([le,Te])=>Fe=>{const{[b]:De,[S]:Je}=Fe;return(b!==void 0?De===le:!0)&&(S!==void 0?Je===Te:!0)}).map(le=>_.filter(le)),wt=v?Rr(gt,le=>le.length):void 0,Wt=xt.map(([le,Te])=>({columnField:b,columnIndex:ut.indexOf(le),columnValue:le,columnValuesLength:ut.length,rowField:S,rowIndex:J.indexOf(Te),rowValue:Te,rowValuesLength:J.length})),fe=Wt.map(le=>Array.isArray(u)?u:[u(le)].flat(1));return lt.flatMap(le=>{const[Te,Fe,De,Je]=vt[le],qe=Wt[le],We=gt[le];return fe[le].map(_n=>{var An,xn,{scale:On,key:Fn,facet:Hn=!0,axis:qn={},legend:Rn={}}=_n,Bn=VU(_n,["scale","key","facet","axis","legend"]);const Yn=((An=On==null?void 0:On.y)===null||An===void 0?void 0:An.guide)||qn.y,ti=((xn=On==null?void 0:On.x)===null||xn===void 0?void 0:xn.guide)||qn.x,ei={x:{tickCount:b?5:void 0},y:{tickCount:S?5:void 0}},Ar=Hn?We:We.length===0?[]:_,Bi={color:{domain:E}},Si={x:Qk(ti,n)(qe,Ar),y:Qk(Yn,r)(qe,Ar)};return Object.assign(Object.assign({key:`${Fn}-${le}`,data:Ar,margin:0,x:Te+W+h+rt,y:Fe+$+g+et,parentKey:m,width:De,height:Je,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!Ar.length,dataDomain:wt,scale:nn(ei,On,Bi),axis:nn({},qn,Si),legend:!1},Bn),o)})})}}});function $U(t){const{points:e}=t;return sv(e)}function Vw(t,e){return e.length?nn({title:!1,tick:null,label:null},t):nn({title:!1,tick:null,label:null,grid:null},t)}function YU(t){return(e,n)=>{const{rowIndex:r,rowValuesLength:o,columnIndex:c,columnValuesLength:l}=e;if(r!==o-1)return Vw(t,n);const u=c!==l-1?!1:void 0,d=n.length?void 0:null;return nn({title:u,grid:d},t)}}function XU(t){return(e,n)=>{const{rowIndex:r,columnIndex:o}=e;if(o!==0)return Vw(t,n);const c=r!==0?!1:void 0,l=n.length?void 0:null;return nn({title:c,grid:l},t)}}function Qk(t,e){return typeof t=="function"?t:t===null||t===!1?()=>null:e(t)}const Jk=()=>t=>[ky.of(t).call(GL).call(HL).call(WL).call(GU).call(VL).call(qk).call(Kk).value()];Jk.props={};var $L=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const qU=vf(t=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),KU=Lc(t=>{const{data:e,children:n,x:r=0,y:o=0,key:c}=t;return{children:(u,d,h)=>{const{x:g,y:v}=d,{paddingLeft:m,paddingTop:_,marginLeft:b,marginTop:S}=h,{domain:w}=g.getOptions(),{domain:E}=v.getOptions(),T=_c(u),M=u.map(({points:F})=>sv(F)),P=u.map(({x:F,y:W})=>[g.invert(F),v.invert(W)]),R=P.map(([F,W])=>({columnField:F,columnIndex:w.indexOf(F),columnValue:F,columnValuesLength:w.length,rowField:W,rowIndex:E.indexOf(W),rowValue:W,rowValuesLength:E.length})),k=R.map(F=>Array.isArray(n)?n:[n(F)].flat(1));return T.flatMap(F=>{const[W,$,rt,et]=M[F],[ut,J]=P[F],lt=R[F];return k[F].map(xt=>{var Ht,gt;const{scale:wt,key:Wt,encode:fe,axis:le,interaction:Te}=xt,Fe=$L(xt,["scale","key","encode","axis","interaction"]),De=(Ht=wt==null?void 0:wt.y)===null||Ht===void 0?void 0:Ht.guide,Je=(gt=wt==null?void 0:wt.x)===null||gt===void 0?void 0:gt.guide,qe={x:{facet:!1},y:{facet:!1}},We={x:JU(Je)(lt,e),y:tZ(De)(lt,e)},fn={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:e,parentKey:c,key:`${Wt}-${F}`,x:W+m+r+b,y:$+_+o+S,width:rt,height:et,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:nn(qe,wt),axis:nn(fn,le,We),legend:!1,encode:nn({},fe,{x:ut,y:J}),interaction:nn({},Te,{legendFilter:!1})},Fe)})})}}}),QU=Lc(t=>{const{encode:e}=t,n=$L(t,["encode"]),{position:r=[],x:o=r,y:c=[...r].reverse()}=e,l=$L(e,["position","x","y"]),u=[];for(const d of[o].flat(1))for(const h of[c].flat(1))u.push({$x:d,$y:h});return Object.assign(Object.assign({},n),{data:u,encode:Object.assign(Object.assign({},l),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[o].flat(1).length===1&&{x:{paddingInner:0}}),[c].flat(1).length===1&&{y:{paddingInner:0}})})});function JU(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{rowIndex:r,rowValuesLength:o}=e;if(r!==o-1)return Vw(t,n)}}function tZ(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{columnIndex:r}=e;if(r!==0)return Vw(t,n)}}const eZ=()=>t=>[ky.of(t).call(GL).call(HL).call(KU).call(QU).call(WL).call(VL).call(qU).value()];var nZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const rZ=vf(t=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),iZ=vf(t=>({coordinate:{type:"polar"}})),oZ=t=>{const{encode:e}=t,n=nZ(t,["encode"]),{position:r}=e;return Object.assign(Object.assign({},n),{encode:{x:r}})};function tD(t){return e=>null}function aZ(t){const{points:e}=t,[n,r,o,c]=e,l=pi(n,c),u=bi(n,c),d=bi(r,o),h=lM(u,d),g=1/Math.sin(h/2),v=l/(1+g),m=v*Math.sqrt(2),[_,b]=o,w=jl(u)+h/2,E=v*g,T=_+E*Math.sin(w),M=b-E*Math.cos(w);return[T-m/2,M-m/2,m,m]}const sZ=()=>t=>[ky.of(t).call(GL).call(oZ).call(HL).call(iZ).call(qk).call(Kk,aZ,tD,tD,{frame:!1}).call(WL).call(VL).call(rZ).value()];function cZ(t,e,n){const o=n,c=[0,o],l=[-o+1,1];if(t==="normal")return c;if(t==="reverse")return l;if(t==="alternate")return e%2===0?c:l;if(t==="reverse-alternate")return e%2===0?l:c}function lZ(t,e,n){const r=[t];for(;r.length;){const o=r.pop();o.animate=nn({enter:{duration:e},update:{duration:e,easing:n,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:e}},o.animate||{});const{children:c}=o;Array.isArray(c)&&r.push(...c)}return t}const eD=()=>t=>{const{children:e=[],duration:n=1e3,iterationCount:r=1,direction:o="normal",easing:c="ease-in-out-sine"}=t,l=e.length;if(!Array.isArray(e)||l===0)return[];const{key:u}=e[0],d=e.map(h=>Object.assign(Object.assign({},h),{key:u})).map(h=>lZ(h,n,c));return function*(){let h=0,g;for(;r==="infinite"||h<r;){const[v,m]=cZ(o,h,l);for(let _=v;_<m;_+=1){const b=Math.abs(_);g!==b&&(yield d[b]),g=b}h++}}};eD.props={};function Lu(t,e,n){const{encode:r}=n;if(t===null)return[e];const o=uZ(t).map(l=>{var u;return[l,(u=br(r,l))===null||u===void 0?void 0:u[0]]}).filter(([,l])=>Ur(l)),c=l=>o.map(([,u])=>u[l]).join("-");return Array.from($r(e,c).values())}function nD(t){return Array.isArray(t)?hZ(t):typeof t=="function"?dZ(t):t==="series"?fZ:t==="value"?pZ:t==="sum"?gZ:t==="maxIndex"?vZ:null}function rD(t,e){for(const n of t)n.sort(e)}function iD(t,e){return(e==null?void 0:e.domain)||Array.from(new Set(t))}function uZ(t){return Array.isArray(t)?t:[t]}function fZ(t,e,n){return Dy(r=>n[r])}function dZ(t){return(e,n,r)=>Dy(o=>t(e[o]))}function hZ(t){return(e,n,r)=>(o,c)=>t.reduce((l,u)=>l!==0?l:xi(e[o][u],e[c][u]),0)}function pZ(t,e,n){return Dy(r=>e[r])}function gZ(t,e,n){const r=_c(t),o=Array.from($r(r,l=>n[+l]).entries()),c=new Map(o.map(([l,u])=>[l,u.reduce((d,h)=>d+ +e[h])]));return Dy(l=>c.get(n[l]))}function vZ(t,e,n){const r=_c(t),o=Array.from($r(r,l=>n[+l]).entries()),c=new Map(o.map(([l,u])=>[l,zl(u,d=>e[d])]));return Dy(l=>c.get(n[l]))}function Dy(t){return(e,n)=>xi(t(e),t(n))}const oD=(t={})=>{const{groupBy:e="x",orderBy:n=null,reverse:r=!1,y:o="y",y1:c="y1",series:l=!0}=t;return(u,d)=>{var h;const{data:g,encode:v,style:m={}}=d,[_,b]=br(v,"y"),[S,w]=br(v,"y1"),[E]=l?rd(v,"series","color"):br(v,"color"),T=Lu(e,u,d),P=((h=nD(n))!==null&&h!==void 0?h:()=>null)(g,_,E);P&&rD(T,P);const R=new Array(u.length),k=new Array(u.length),F=new Array(u.length),W=[],$=[];for(const vt of T){r&&vt.reverse();const xt=S?+S[vt[0]]:0,Ht=[],gt=[];for(const De of vt){const Je=F[De]=+_[De]-xt;Je<0?gt.push(De):Je>=0&&Ht.push(De)}const wt=Ht.length>0?Ht:gt,Wt=gt.length>0?gt:Ht;let fe=Ht.length-1,le=0;for(;fe>0&&_[wt[fe]]===0;)fe--;for(;le<Wt.length-1&&_[Wt[le]]===0;)le++;W.push(wt[fe]),$.push(Wt[le]);let Te=xt;for(const De of gt.reverse()){const Je=F[De];Te=R[De]=(k[De]=Te)+Je}let Fe=xt;for(const De of Ht){const Je=F[De];Je>0?Fe=R[De]=(k[De]=Fe)+Je:R[De]=k[De]=Fe}}const rt=new Set(W),et=new Set($),ut=o==="y"?R:k,J=c==="y"?R:k;let lt;return d.type==="point"?lt={y0:nd(_,b),y:Xr(ut,b)}:lt={y0:nd(_,b),y:Xr(ut,b),y1:Xr(J,w)},[u,nn({},d,{encode:Object.assign({},lt),style:Object.assign({first:(vt,xt)=>rt.has(xt),last:(vt,xt)=>et.has(xt)},m)})]}};oD.props={};function aD(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(o=+o)>=o&&++n}return n}function mZ(t,e){let n=0,r,o=0,c=0;if(e===void 0)for(let l of t)l!=null&&(l=+l)>=l&&(r=l-o,o+=r/++n,c+=r*(l-o));else{let l=-1;for(let u of t)(u=e(u,++l,t))!=null&&(u=+u)>=u&&(r=u-o,o+=r/++n,c+=r*(u-o))}if(n>1)return c/(n-1)}function sD(t,e){const n=mZ(t,e);return n&&Math.sqrt(n)}function yZ(t,e,n){const r=aD(t),o=sD(t);return r&&o?Math.ceil((n-e)*Math.cbrt(r)/(3.49*o)):1}var cD=Array.prototype,_Z=cD.slice,oq=cD.map;function YL(t){return()=>t}const bZ=Math.sqrt(50),xZ=Math.sqrt(10),SZ=Math.sqrt(2);function Gw(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(r)),c=r/Math.pow(10,o),l=c>=bZ?10:c>=xZ?5:c>=SZ?2:1;let u,d,h;return o<0?(h=Math.pow(10,-o)/l,u=Math.round(t*h),d=Math.round(e*h),u/h<t&&++u,d/h>e&&--d,h=-h):(h=Math.pow(10,o)*l,u=Math.round(t/h),d=Math.round(e/h),u*h<t&&++u,d*h>e&&--d),d<u&&.5<=n&&n<2?Gw(t,e,n*2):[u,d,h]}function wZ(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[o,c,l]=r?Gw(e,t,n):Gw(t,e,n);if(!(c>=o))return[];const u=c-o+1,d=new Array(u);if(r)if(l<0)for(let h=0;h<u;++h)d[h]=(c-h)/-l;else for(let h=0;h<u;++h)d[h]=(c-h)*l;else if(l<0)for(let h=0;h<u;++h)d[h]=(o+h)/-l;else for(let h=0;h<u;++h)d[h]=(o+h)*l;return d}function Ny(t,e,n){return e=+e,t=+t,n=+n,Gw(t,e,n)[2]}function aq(t,e,n){e=+e,t=+t,n=+n;const r=e<t,o=r?Ny(e,t,n):Ny(t,e,n);return(r?-1:1)*(o<0?1/-o:o)}function OZ(t,e,n){let r;for(;;){const o=Ny(t,e,n);if(o===r||o===0||!isFinite(o))return[t,e];o>0?(t=Math.floor(t/o)*o,e=Math.ceil(e/o)*o):o<0&&(t=Math.ceil(t*o)/o,e=Math.floor(e*o)/o),r=o}}function EZ(t){return Math.max(1,Math.ceil(Math.log(aD(t))/Math.LN2)+1)}function AZ(){var t=Hu,e=ds,n=EZ;function r(o){Array.isArray(o)||(o=Array.from(o));var c,l=o.length,u,d,h=new Array(l);for(c=0;c<l;++c)h[c]=t(o[c],c,o);var g=e(h),v=g[0],m=g[1],_=n(h,v,m);if(!Array.isArray(_)){const M=m,P=+_;if(e===ds&&([v,m]=OZ(v,m,P)),_=wZ(v,m,P),_[0]<=v&&(d=Ny(v,m,P)),_[_.length-1]>=m)if(M>=m&&e===ds){const R=Ny(v,m,P);isFinite(R)&&(R>0?m=(Math.floor(m/R)+1)*R:R<0&&(m=(Math.ceil(m*-R)+1)/-R))}else _.pop()}for(var b=_.length,S=0,w=b;_[S]<=v;)++S;for(;_[w-1]>m;)--w;(S||w<b)&&(_=_.slice(S,w),b=w-S);var E=new Array(b+1),T;for(c=0;c<=b;++c)T=E[c]=[],T.x0=c>0?_[c-1]:v,T.x1=c<b?_[c]:m;if(isFinite(d)){if(d>0)for(c=0;c<l;++c)(u=h[c])!=null&&v<=u&&u<=m&&E[Math.min(b,Math.floor((u-v)/d))].push(o[c]);else if(d<0){for(c=0;c<l;++c)if((u=h[c])!=null&&v<=u&&u<=m){const M=Math.floor((v-u)*d);E[Math.min(b,M+(_[M]<=u))].push(o[c])}}}else for(c=0;c<l;++c)(u=h[c])!=null&&v<=u&&u<=m&&E[zx(_,u,0,b)].push(o[c]);return E}return r.value=function(o){return arguments.length?(t=typeof o=="function"?o:YL(o),r):t},r.domain=function(o){return arguments.length?(e=typeof o=="function"?o:YL([o[0],o[1]]),r):e},r.thresholds=function(o){return arguments.length?(n=typeof o=="function"?o:YL(Array.isArray(o)?_Z.call(o):o),r):n},r}function XL(t,e,n=0,r=1/0,o){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(o=o===void 0?Dc:ep(o);r>n;){if(r-n>600){const d=r-n+1,h=e-n+1,g=Math.log(d),v=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*v*(d-v)/d)*(h-d/2<0?-1:1),_=Math.max(n,Math.floor(e-h*v/d+m)),b=Math.min(r,Math.floor(e+(d-h)*v/d+m));XL(t,e,_,b,o)}const c=t[e];let l=n,u=r;for(Fy(t,n,e),o(t[r],c)>0&&Fy(t,n,r);l<u;){for(Fy(t,l,u),++l,--u;o(t[l],c)<0;)++l;for(;o(t[u],c)>0;)--u}o(t[n],c)===0?Fy(t,n,u):(++u,Fy(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function Fy(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function TZ(t,e=xi){let n,r=!1;if(e.length===1){let o;for(const c of t){const l=e(c);(r?xi(l,o)>0:xi(l,l)===0)&&(n=c,o=l,r=!0)}}else for(const o of t)(r?e(o,n)>0:e(o,o)===0)&&(n=o,r=!0);return n}function $w(t,e,n){if(t=Float64Array.from(Fx(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return Ho(t);if(e>=1)return Rr(t);var r,o=(r-1)*e,c=Math.floor(o),l=Rr(XL(t,c).subarray(0,c+1)),u=Ho(t.subarray(c+1));return l+(u-l)*(o-c)}}function sq(t,e,n=number){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,c=Math.floor(o),l=+n(t[c],c,t),u=+n(t[c+1],c+1,t);return l+(u-l)*(o-c)}}function MZ(t,e,n=sp){if(!isNaN(e=+e)){if(r=Float64Array.from(t,(u,d)=>sp(n(t[d],d,t))),e<=0)return qf(r);if(e>=1)return zl(r);var r,o=Uint32Array.from(t,(u,d)=>d),c=r.length-1,l=Math.floor(c*e);return XL(o,l,0,c,(u,d)=>Dc(r[u],r[d])),l=TZ(o.subarray(0,l+1),u=>r[u]),l>=0?l:-1}}function qL(t,e){return $w(t,.5,e)}function CZ(t,e){return MZ(t,.5,e)}var PZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Iu(t){return e=>e===null?t:`${t} of ${e}`}function LZ(t){if(typeof t=="function")return[t,null];const n={mean:IZ,max:kZ,count:NZ,first:BZ,last:jZ,sum:FZ,min:DZ,median:RZ}[t];if(!n)throw new Error(`Unknown reducer: ${t}.`);return n()}function IZ(){const t=(n,r)=>Kf(n,o=>+r[o]),e=Iu("mean");return[t,e]}function RZ(){const t=(n,r)=>qL(n,o=>+r[o]),e=Iu("median");return[t,e]}function kZ(){const t=(n,r)=>Rr(n,o=>+r[o]),e=Iu("max");return[t,e]}function DZ(){const t=(n,r)=>Ho(n,o=>+r[o]),e=Iu("min");return[t,e]}function NZ(){const t=(n,r)=>n.length,e=Iu("count");return[t,e]}function FZ(){const t=(n,r)=>Qo(n,o=>+r[o]),e=Iu("sum");return[t,e]}function BZ(){const t=(n,r)=>r[n[0]],e=Iu("first");return[t,e]}function jZ(){const t=(n,r)=>r[n[n.length-1]],e=Iu("last");return[t,e]}const KL=(t={})=>{const{groupBy:e}=t,n=PZ(t,["groupBy"]);return(r,o)=>{const{data:c,encode:l}=o,u=e(r,o);if(!u)return[r,o];const d=(_,b)=>{if(_)return _;const{from:S}=b;if(!S)return _;const[,w]=br(l,S);return w},h=Object.entries(n).map(([_,b])=>{const[S,w]=LZ(b),[E,T]=br(l,_),M=d(T,b),P=u.map(R=>S(R,E!=null?E:c));return[_,Object.assign(Object.assign({},oP(P,(w==null?void 0:w(M))||M)),{aggregate:!0})]}),g=Object.keys(l).map(_=>{const[b,S]=br(l,_),w=u.map(E=>b[E[0]]);return[_,Xr(w,S)]}),v=u.map(_=>c[_[0]]);return[_c(u),nn({},o,{data:v,encode:Object.fromEntries([...g,...h])})]}};KL.props={};var zZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const lD="thresholds";function UZ(t){const[e,n]=ds(t);return Math.min(200,yZ(t,e,n))}const QL=(t={})=>{const{groupChannels:e=["color"],binChannels:n=["x","y"]}=t,r=zZ(t,["groupChannels","binChannels"]),o={},c=(l,u)=>{const{encode:d}=u,h=n.map(b=>{const[S]=br(d,b);return S}),g=wn(r,lD),v=l.filter(b=>h.every(S=>Ur(S[b]))),m=[...e.map(b=>{const[S]=br(d,b);return S}).filter(Ur).map(b=>S=>b[S]),...n.map((b,S)=>{const w=h[S],E=g[b]||UZ(w),T=AZ().thresholds(E).value(P=>+w[P])(v),M=new Map(T.flatMap(P=>{const{x0:R,x1:k}=P,F=`${R},${k}`;return P.map(W=>[W,F])}));return o[b]=M,P=>M.get(P)})],_=b=>m.map(S=>S(b)).join("-");return Array.from($r(v,_).values())};return KL(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter(([l])=>!l.startsWith(lD)))),Object.fromEntries(n.flatMap(l=>{const u=([h])=>+o[l].get(h).split(",")[0],d=([h])=>+o[l].get(h).split(",")[1];return d.from=l,[[l,u],[`${l}1`,d]]}))),{groupBy:c}))};QL.props={};const uD=(t={})=>{const{thresholds:e}=t;return QL(Object.assign(Object.assign({},t),{thresholdsX:e,groupChannels:["color"],binChannels:["x"]}))};uD.props={};var ZZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const fD=(t={})=>{const{groupBy:e="x",reverse:n=!1,orderBy:r,padding:o}=t,c=ZZ(t,["groupBy","reverse","orderBy","padding"]);return(l,u)=>{const{data:d,encode:h,scale:g}=u,{series:v}=g,[m]=br(h,"y"),[_]=rd(h,"series","color"),b=iD(_,v),S=nn({},u,{scale:{series:{domain:b,paddingInner:o}}}),w=Lu(e,l,u),E=nD(r);if(!E)return[l,nn(S,{encode:{series:Xr(_)}})];const T=E(d,m,_);T&&rD(w,T);const M=new Array(l.length);for(const P of w){n&&P.reverse();for(let R=0;R<P.length;R++)M[P[R]]=b[R]}return[l,nn(S,{encode:{series:Xr(r?M:_)}})]}};fD.props={};function Yw(t,e,n){if(t===null)return[-.5,.5];const r=iD(t,e),c=new Ms({domain:r,range:[0,1],padding:n}).getBandWidth();return[-c/2,c/2]}function Xw(t,e,n){return e*(1-t)+n*t}const dD=(t={})=>{const{padding:e=0,paddingX:n=e,paddingY:r=e,random:o=Math.random}=t;return(c,l)=>{const{encode:u,scale:d}=l,{x:h,y:g}=d,[v]=br(u,"x"),[m]=br(u,"y"),_=Yw(v,h,n),b=Yw(m,g,r),S=c.map(()=>Xw(o(),...b)),w=c.map(()=>Xw(o(),..._));return[c,nn({scale:{x:{padding:.5},y:{padding:.5}}},l,{encode:{dy:Xr(S),dx:Xr(w)}})]}};dD.props={};const hD=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,o)=>{const{encode:c,scale:l}=o,{x:u}=l,[d]=br(c,"x"),h=Yw(d,u,e),g=r.map(()=>Xw(n(),...h));return[r,nn({scale:{x:{padding:.5}}},o,{encode:{dx:Xr(g)}})]}};hD.props={};const pD=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,o)=>{const{encode:c,scale:l}=o,{y:u}=l,[d]=br(c,"y"),h=Yw(d,u,e),g=r.map(()=>Xw(n(),...h));return[r,nn({scale:{y:{padding:.5}}},o,{encode:{dy:Xr(g)}})]}};pD.props={};var HZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const gD=(t={})=>{const{groupBy:e="x"}=t;return(n,r)=>{const{encode:o,style:c={}}=r,{x:l}=o,u=HZ(o,["x"]),d=Object.entries(u).filter(([_])=>_.startsWith("y")).map(([_])=>[_,br(o,_)[0]]),h=d.map(([_])=>[_,new Array(n.length)]),g=Lu(e,n,r),v=new Array(g.length);for(let _=0;_<g.length;_++){const S=g[_].flatMap(T=>d.map(([,M])=>+M[T])),[w,E]=ds(S);v[_]=(w+E)/2}const m=Math.max(...v);for(let _=0;_<g.length;_++){const b=m-v[_],S=g[_];for(const w of S)for(let E=0;E<d.length;E++){const[,T]=d[E],[,M]=h[E];M[w]=+T[w]+b}}return[n,nn({},r,{encode:Object.fromEntries(h.map(([_,b])=>[_,Xr(b,br(o,_)[1])])),style:Object.assign({first:(_,b)=>b===0,last:(_,b)=>b===g.length-1},c)})]}};gD.props={};const vD=(t={})=>{const{groupBy:e="x"}=t;return(n,r)=>{const{encode:o}=r,[c]=br(o,"y"),[l,u]=br(o,"y1"),d=Lu(e,n,r),h=new Array(n.length);for(const g of d){const v=g.map(m=>+c[m]);for(let m=0;m<g.length;m++){const _=g[m],b=Math.max(...v.filter((S,w)=>w!==m));h[_]=+c[_]>b?b:c[_]}}return[n,nn({},r,{encode:{y1:Xr(h,u)}})]}};vD.props={};const mD=t=>{const{groupBy:e=["x"],reducer:n=(l,u)=>u[l[0]],orderBy:r=null,reverse:o=!1,duration:c}=t;return(l,u)=>{const{encode:d}=u,g=(Array.isArray(e)?e:[e]).map(w=>[w,br(d,w)[0]]);if(g.length===0)return[l,u];let v=[l];for(const[,w]of g){const E=[];for(const T of v){const M=Array.from($r(T,P=>w[P]).values());E.push(...M)}v=E}if(r){const[w]=br(d,r);w&&v.sort((E,T)=>n(E,w)-n(T,w)),o&&v.reverse()}const m=(c||3e3)/v.length,[_]=c?[Os(l,m)]:rd(d,"enterDuration",Os(l,m)),[b]=rd(d,"enterDelay",Os(l,0)),S=new Array(l.length);for(let w=0,E=0;w<v.length;w++){const T=v[w],M=Rr(T,P=>+_[P]);for(const P of T)S[P]=+b[P]+E;E+=M}return[l,nn({},u,{encode:{enterDuration:qp(_),enterDelay:qp(S)}})]}};mD.props={};var WZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function VZ(t){return typeof t=="function"?t:{min:(n,r)=>Ho(n,o=>r[+o]),max:(n,r)=>Rr(n,o=>r[+o]),first:(n,r)=>r[n[0]],last:(n,r)=>r[n[n.length-1]],mean:(n,r)=>Kf(n,o=>r[+o]),median:(n,r)=>qL(n,o=>r[+o]),sum:(n,r)=>Qo(n,o=>r[+o]),deviation:(n,r)=>sD(n,o=>r[+o])}[t]||Rr}const yD=(t={})=>{const{groupBy:e="x",basis:n="max"}=t;return(r,o)=>{const{encode:c,tooltip:l}=o,{x:u}=c,d=WZ(c,["x"]),h=Object.entries(d).filter(([S])=>S.startsWith("y")).map(([S])=>[S,br(c,S)[0]]),[,g]=h.find(([S])=>S==="y"),v=h.map(([S])=>[S,new Array(r.length)]),m=Lu(e,r,o),_=VZ(n);for(const S of m){const w=_(S,g);for(const E of S)for(let T=0;T<h.length;T++){const[,M]=h[T],[,P]=v[T];P[E]=+M[E]/w}}const b=Ca(l)||(l==null?void 0:l.items)&&(l==null?void 0:l.items.length)!==0;return[r,nn({},o,Object.assign({encode:Object.fromEntries(v.map(([S,w])=>[S,Xr(w,br(c,S)[1])]))},!b&&c.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};yD.props={};function _D(t,e){return[t[0]]}function GZ(t,e){const n=t.length-1;return[t[n]]}function $Z(t,e){const n=zl(t,r=>e[r]);return[t[n]]}function YZ(t,e){const n=qf(t,r=>e[r]);return[t[n]]}function XZ(t){return typeof t=="function"?t:{first:_D,last:GZ,max:$Z,min:YZ}[t]||_D}const qw=(t={})=>{const{groupBy:e="series",channel:n,selector:r}=t;return(o,c)=>{const{encode:l}=c,u=Lu(e,o,c),[d]=br(l,n),h=XZ(r);return[u.flatMap(g=>h(g,d)),c]}};qw.props={};var qZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const bD=(t={})=>{const{selector:e}=t,n=qZ(t,["selector"]);return qw(Object.assign({channel:"x",selector:e},n))};bD.props={};var KZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const xD=(t={})=>{const{selector:e}=t,n=KZ(t,["selector"]);return qw(Object.assign({channel:"y",selector:e},n))};xD.props={};var QZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const By=(t={})=>{const{channels:e=["x","y"]}=t,n=QZ(t,["channels"]),r=(o,c)=>Lu(e,o,c);return KL(Object.assign(Object.assign({},n),{groupBy:r}))};By.props={};const SD=(t={})=>By(Object.assign(Object.assign({},t),{channels:["x","color","series"]}));SD.props={};const wD=(t={})=>By(Object.assign(Object.assign({},t),{channels:["y","color","series"]}));wD.props={};const OD=(t={})=>By(Object.assign(Object.assign({},t),{channels:["color"]}));OD.props={};function JZ(t,e,n){return(e.length!==2?ja(Bd(t,e,n),([r,o],[c,l])=>xi(o,l)||xi(r,c)):ja($r(t,n),([r,o],[c,l])=>e(o,l)||xi(r,c))).map(([r])=>r)}function tH(t,e,n){const{by:r=t,reducer:o="max"}=e,[c]=br(n,r);if(typeof o=="function")return l=>o(l,c);if(o==="max")return l=>Rr(l,u=>+c[u]);if(o==="min")return l=>Ho(l,u=>+c[u]);if(o==="sum")return l=>Qo(l,u=>+c[u]);if(o==="median")return l=>qL(l,u=>+c[u]);if(o==="mean")return l=>Kf(l,u=>+c[u]);if(o==="first")return l=>c[l[0]];if(o==="last")return l=>c[l[l.length-1]];throw new Error(`Unknown reducer: ${o}`)}function eH(t,e,n){if(!Array.isArray(n))return t;const r=new Set(n);return t.filter(o=>r.has(e[o]))}const Kw=(t={})=>(e,n)=>{const{reverse:r,slice:o,channel:c,by:l,ordinal:u=!0,reducer:d}=t,{encode:h,scale:g={}}=n,v=g[c].domain,[m]=br(h,l!=null?l:c),[_]=br(h,c),b=tH(c,{by:l,reducer:d},h),S=eH(e,_,v),w=JZ(S,b,P=>_[P]),E=u?e:ja(e,P=>m[P]);r&&(!u&&E.reverse(),w.reverse());const T=typeof o=="number"?[0,o]:o,M=o?w.slice(...T):w;return[E,nn(n,{scale:{[c]:{domain:M}}})]};Kw.props={};const ED=(t={})=>Kw(Object.assign(Object.assign({},t),{channel:"x"}));ED.props={};const AD=(t={})=>Kw(Object.assign(Object.assign({},t),{channel:"y"}));AD.props={};const TD=(t={})=>Kw(Object.assign(Object.assign({},t),{channel:"color"}));TD.props={};function nH(t,e){return typeof e=="string"?t.map(n=>n[e]):t.map(e)}function rH(t,e){if(typeof t=="function")return n=>t(n,e);if(t==="sum")return n=>Qo(n,r=>+e[r]);throw new Error(`Unknown reducer: ${t}`)}const MD=(t={})=>{const{field:e,channel:n="y",reducer:r="sum"}=t;return(o,c)=>{const{data:l,encode:u}=c,[d]=br(u,"x"),h=e?nH(l,e):br(u,n)[0],g=rH(r,h),v=Y0(o,g,m=>d[m]).map(m=>m[1]);return[o,nn({},c,{scale:{x:{flex:v}}})]}};MD.props={};function iH(t){const{padding:e=0,direction:n="col"}=t;return(r,o,c)=>{const l=r.length;if(l===0)return[];const{innerWidth:u,innerHeight:d}=c,h=d/u;let g=Math.ceil(Math.sqrt(o/h)),v=u/g,m=Math.ceil(o/g),_=m*v;for(;_>d;)g=g+1,v=u/g,m=Math.ceil(o/g),_=m*v;const b=d-m*v,S=m<=1?0:b/(m-1),[w,E]=m<=1?[(u-l*v)/(l-1),(d-v)/2]:[0,0];return r.map((T,M)=>{const[P,R,k,F]=sv(T),W=n==="col"?M%g:Math.floor(M/m),$=n==="col"?Math.floor(M/g):M%m,rt=W*v,et=(m-$-1)*v+b,ut=(v-e)/k,J=(v-e)/F,lt=rt-P+w*W+1/2*e,vt=et-R-S*$-E+1/2*e;return`translate(${lt}, ${vt}) scale(${ut}, ${J})`})}}const CD=t=>(e,n)=>[e,nn({},n,{modifier:iH(t),axis:!1})];CD.props={};function oH(t,e,n,r){const o=t.length;if(r>=o||r===0)return t;const c=_=>e[t[_]]*1,l=_=>n[t[_]]*1,u=[],d=(o-2)/(r-2);let h=0,g,v,m;u.push(h);for(let _=0;_<r-2;_++){let b=0,S=0,w=Math.floor((_+1)*d)+1,E=Math.floor((_+2)*d)+1;E=Math.min(E,o);const T=E-w;for(;w<E;w++)b+=c(w),S+=l(w);b/=T,S/=T;let M=Math.floor((_+0)*d)+1;const P=Math.floor((_+1)*d)+1,R=[c(h),l(h)];for(g=v=-1;M<P;M++)v=Math.abs((R[0]-b)*(c(M)-R[1])-(R[0]-l(M))*(S-R[0]))*.5,v>g&&(g=v,m=M);u.push(m),h=m}return u.push(o-1),u.map(_=>t[_])}function aH(t){if(typeof t=="function")return t;if(t==="lttb")return oH;const e={first:r=>[r[0]],last:r=>[r[r.length-1]],min:(r,o,c)=>[r[qf(r,l=>c[l])]],max:(r,o,c)=>[r[zl(r,l=>c[l])]],median:(r,o,c)=>[r[CZ(r,l=>c[l])]]},n=e[t]||e.median;return(r,o,c,l)=>{const u=Math.max(1,Math.floor(r.length/l));return sH(r,u).flatMap(h=>n(h,o,c))}}function sH(t,e){const n=t.length,r=[];let o=0;for(;o<n;)r.push(t.slice(o,o+=e));return r}const PD=(t={})=>{const{strategy:e="median",thresholds:n=2e3,groupBy:r=["series","color"]}=t,o=aH(e);return(c,l)=>{const{encode:u}=l,d=Lu(r,c,l),[h]=br(u,"x"),[g]=br(u,"y");return[d.flatMap(v=>o(v,h,g,n)),l]}};PD.props={};function cH(t){return typeof t=="object"?[t.value,t.ordinal]:[t,!0]}function lH(t){var e;const{encode:n}=t,r=Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),{y:Object.assign(Object.assign({},t.encode.y),{value:[]})})}),o=(e=n==null?void 0:n.color)===null||e===void 0?void 0:e.field;if(!n||!o)return r;let c;for(const[l,u]of Object.entries(n))(l==="x"||l==="y")&&u.field===o&&(c=Object.assign(Object.assign({},c),{[l]:Object.assign(Object.assign({},u),{value:[]})}));return c?Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),c)}):r}const LD=(t={})=>(e,n)=>{const{encode:r,data:o}=n,c=Object.keys(t).length>0,l=Object.entries(t).map(([v,m])=>{const[_]=br(r,v);if(!_)return null;const[b,S=!0]=cH(m);if(typeof b=="function")return w=>b(_[w]);if(S){const w=Array.isArray(b)?b:[b];return w.length===0?null:E=>w.includes(_[E])}else{const[w,E]=b;return T=>_[T]>=w&&_[T]<=E}}).filter(Ur),u=v=>l.every(m=>m(v)),d=e.filter(u),h=d.map((v,m)=>m);if(l.length===0&&c){const v=lH(n);return[[],v]}const g=Object.entries(r).map(([v,m])=>[v,Object.assign(Object.assign({},m),{value:h.map(_=>m.value[d[_]]).filter(_=>_!==void 0)})]);return[h,nn({},n,{encode:Object.fromEntries(g),data:d.map(v=>o[v])})]};LD.props={};var ID={},JL={},t6=34,jy=10,e6=13;function RD(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function uH(t,e){var n=RD(t);return function(r,o){return e(n(r),o,t)}}function kD(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var o in r)o in e||n.push(e[o]=o)}),n}function la(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function fH(t){return t<0?"-"+la(-t,6):t>9999?"+"+la(t,6):la(t,4)}function dH(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":fH(t.getUTCFullYear(),4)+"-"+la(t.getUTCMonth()+1,2)+"-"+la(t.getUTCDate(),2)+(o?"T"+la(e,2)+":"+la(n,2)+":"+la(r,2)+"."+la(o,3)+"Z":r?"T"+la(e,2)+":"+la(n,2)+":"+la(r,2)+"Z":n||e?"T"+la(e,2)+":"+la(n,2)+"Z":"")}function hH(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(v,m){var _,b,S=o(v,function(w,E){if(_)return _(w,E-1);b=w,_=m?uH(w,m):RD(w)});return S.columns=b||[],S}function o(v,m){var _=[],b=v.length,S=0,w=0,E,T=b<=0,M=!1;v.charCodeAt(b-1)===jy&&--b,v.charCodeAt(b-1)===e6&&--b;function P(){if(T)return JL;if(M)return M=!1,ID;var k,F=S,W;if(v.charCodeAt(F)===t6){for(;S++<b&&v.charCodeAt(S)!==t6||v.charCodeAt(++S)===t6;);return(k=S)>=b?T=!0:(W=v.charCodeAt(S++))===jy?M=!0:W===e6&&(M=!0,v.charCodeAt(S)===jy&&++S),v.slice(F+1,k-1).replace(/""/g,'"')}for(;S<b;){if((W=v.charCodeAt(k=S++))===jy)M=!0;else if(W===e6)M=!0,v.charCodeAt(S)===jy&&++S;else if(W!==n)continue;return v.slice(F,k)}return T=!0,v.slice(F,b)}for(;(E=P())!==JL;){for(var R=[];E!==ID&&E!==JL;)R.push(E),E=P();m&&(R=m(R,w++))==null||_.push(R)}return _}function c(v,m){return v.map(function(_){return m.map(function(b){return g(_[b])}).join(t)})}function l(v,m){return m==null&&(m=kD(v)),[m.map(g).join(t)].concat(c(v,m)).join(`
`)}function u(v,m){return m==null&&(m=kD(v)),c(v,m).join(`
`)}function d(v){return v.map(h).join(`
`)}function h(v){return v.map(g).join(t)}function g(v){return v==null?"":v instanceof Date?dH(v):e.test(v+="")?'"'+v.replace(/"/g,'""')+'"':v}return{parse:r,parseRows:o,format:l,formatBody:u,formatRows:d,formatRow:h,formatValue:g}}function pH(t){for(var e in t){var n=t[e].trim(),r,o;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(o=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))gH&&o[4]&&!o[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;t[e]=n}return t}const gH=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var vH=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const DD=t=>{const{value:e,format:n=e.split(".").pop(),delimiter:r=",",autoType:o=!0}=t;return()=>vH(void 0,void 0,void 0,function*(){const c=yield fetch(e);if(n==="csv"){const l=yield c.text();return hH(r).parse(l,o?pH:Cs)}if(n==="json")return yield c.json();throw new Error(`Unknown format: ${n}.`)})};DD.props={};const ND=t=>{const{value:e}=t;return()=>e};ND.props={};function mH(t,e){return t.map(n=>{if(Array.isArray(n)){const[r,o=e]=n;return[r,o]}return[n,e]})}const FD=t=>{const{fields:e=[]}=t,n=mH(e,!0);return r=>{const o=(c,l)=>n.reduce((u,[d,h=!0])=>u!==0?u:h?c[d]<l[d]?-1:+(c[d]!==l[d]):c[d]>l[d]?-1:+(c[d]!==l[d]),0);return[...r].sort(o)}};FD.props={};function cq(t){return t!=null&&!Number.isNaN(t)}const BD=t=>{const{callback:e}=t;return n=>Array.isArray(n)?[...n].sort(e):n};BD.props={};function yH(t){return t!=null&&!Number.isNaN(t)}const jD=t=>{const{callback:e=yH}=t;return n=>n.filter(e)};jD.props={};function _H(t,e=[]){return e.reduce((n,r)=>(r in t&&(n[r]=t[r]),n),{})}const zD=t=>{const{fields:e}=t;return n=>n.map(r=>_H(r,e))};zD.props={};function bH(t){return Object.keys(t).length===0}const UD=t=>e=>{if(!t||bH(t))return e;const n=r=>Object.entries(r).reduce((o,[c,l])=>(o[t[c]||c]=l,o),{});return e.map(n)};UD.props={};function xH(t){return!t||Object.keys(t).length===0}const ZD=t=>{const{fields:e,key:n="key",value:r="value"}=t;return o=>xH(e)?o:o.flatMap(c=>e.map(l=>Object.assign(Object.assign({},c),{[n]:l,[r]:c[l]})))};ZD.props={};const HD=t=>{const{start:e,end:n}=t;return r=>r.slice(e,n)};HD.props={};const WD=t=>{const{callback:e=Cs}=t;return n=>e(n)};WD.props={};const VD=t=>{const{callback:e=Cs}=t;return n=>Array.isArray(n)?n.map(e):n};VD.props={};function GD(t){return typeof t=="string"?e=>e[t]:t}const $D=t=>{const{join:e,on:n,select:r=[],as:o=r,unknown:c=NaN}=t,[l,u]=n,d=GD(u),h=GD(l),g=Bd(e,([v])=>v,v=>d(v));return v=>v.map(m=>{const _=g.get(h(m));return Object.assign(Object.assign({},m),r.reduce((b,S,w)=>(b[o[w]]=_?_[S]:c,b),{}))})};$D.props={};var SH=L(53843),wH=L.n(SH);function lq(t){return t!=null&&!Number.isNaN(t)}const YD=t=>{const{field:e,groupBy:n,as:r=["y","size"],min:o,max:c,size:l=10,width:u}=t,[d,h]=r;return g=>Array.from($r(g,m=>n.map(_=>m[_]).join("-")).values()).map(m=>{const _=wH().create(m.map(w=>w[e]),{min:o,max:c,size:l,width:u}),b=_.map(w=>w.x),S=_.map(w=>w.y);return Object.assign(Object.assign({},m[0]),{[d]:b,[h]:S})})};YD.props={};const XD=()=>t=>(console.log("G2 data section:",t),t);XD.props={};var OH=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};function EH(t,e){return{set(n,r,o){if(e[n]===void 0)return this;const c=r?r.call(null,e[n]):e[n];return o?o.call(null,c):typeof t[n]=="function"?t[n](c):t[n]=c,this},setAsync(n,r,o){return OH(this,void 0,void 0,function*(){if(e[n]===void 0)return this;const c=r?yield r.call(null,e[n]):e[n];return o?o.call(null,c):typeof t[n]=="function"?t[n](c):t[n]=c,this})}}}const n6=Math.PI/180,zy=64,Qw=2048;function AH(t){return t.text}function TH(){return"serif"}function qD(){return"normal"}function MH(t){return t.value}function CH(){return~~(Math.random()*2)*90}function PH(){return 1}function LH(){}function IH(t,e,n,r){if(e.sprite)return;const o=t.context,c=t.ratio;o.clearRect(0,0,(zy<<5)/c,Qw/c);let l=0,u=0,d=0;const h=n.length;for(--r;++r<h;){e=n[r],o.save(),o.font=e.style+" "+e.weight+" "+~~((e.size+1)/c)+"px "+e.font;let m=o.measureText(e.text+"m").width*c,_=e.size<<1;if(e.rotate){const b=Math.sin(e.rotate*n6),S=Math.cos(e.rotate*n6),w=m*S,E=m*b,T=_*S,M=_*b;m=Math.max(Math.abs(w+M),Math.abs(w-M))+31>>5<<5,_=~~Math.max(Math.abs(E+T),Math.abs(E-T))}else m=m+31>>5<<5;if(_>d&&(d=_),l+m>=zy<<5&&(l=0,u+=d,d=0),u+_>=Qw)break;o.translate((l+(m>>1))/c,(u+(_>>1))/c),e.rotate&&o.rotate(e.rotate*n6),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=m,e.height=_,e.xoff=l,e.yoff=u,e.x1=m>>1,e.y1=_>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,l+=m}const g=o.getImageData(0,0,(zy<<5)/c,Qw/c).data,v=[];for(;--r>=0;){if(e=n[r],!e.hasText)continue;const m=e.width,_=m>>5;let b=e.y1-e.y0;for(let E=0;E<b*_;E++)v[E]=0;if(l=e.xoff,l==null)return;u=e.yoff;let S=0,w=-1;for(let E=0;E<b;E++){for(let T=0;T<m;T++){const M=_*E+(T>>5),P=g[(u+E)*(zy<<5)+(l+T)<<2]?1<<31-T%32:0;v[M]|=P,S|=P}S?w=E:(e.y0++,b--,E--,u++)}e.y1=e.y0+w,e.sprite=v.slice(0,(e.y1-e.y0)*_)}}function RH(t,e,n){n>>=5;const r=t.sprite,o=t.width>>5,c=t.x-(o<<4),l=c&127,u=32-l,d=t.y1-t.y0;let h=(t.y+t.y0)*n+(c>>5),g;for(let v=0;v<d;v++){g=0;for(let m=0;m<=o;m++)if((g<<u|(m<o?(g=r[v*o+m])>>>l:0))&e[h+m])return!0;h+=n}return!1}function kH(t,e){const n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function DH(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function KD(t){const e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function NH(t){const n=4*t[0]/t[1];let r=0,o=0;return function(c){const l=c<0?-1:1;switch(Math.sqrt(1+4*l*c)-l&3){case 0:r+=n;break;case 1:o+=4;break;case 2:r-=n;break;default:o-=4;break}return[r,o]}}function QD(t){const e=[];let n=-1;for(;++n<t;)e[n]=0;return e}function FH(){return document.createElement("canvas")}function al(t){return typeof t=="function"?t:function(){return t}}const BH={archimedean:KD,rectangular:NH};function jH(){let t=[256,256],e=AH,n=TH,r=MH,o=qD,c=CH,l=PH,u=KD,d=Math.random,h=LH,g=[],v=null,m=1/0,_=FH;const b=qD,S={};S.start=function(){const[T,M]=t,P=w(_()),R=S.board?S.board:QD((t[0]>>5)*t[1]),k=g.length,F=[],W=g.map(function(ut,J,lt){return ut.text=e.call(this,ut,J,lt),ut.font=n.call(this,ut,J,lt),ut.style=b.call(this,ut,J,lt),ut.weight=o.call(this,ut,J,lt),ut.rotate=c.call(this,ut,J,lt),ut.size=~~r.call(this,ut,J,lt),ut.padding=l.call(this,ut,J,lt),ut}).sort(function(ut,J){return J.size-ut.size});let $=-1,rt=S.board?[{x:0,y:0},{x:T,y:M}]:void 0;v&&clearInterval(v),v=setInterval(et,0),et();function et(){const ut=Date.now();for(;Date.now()-ut<m&&++$<k;){const J=W[$];J.x=T*(d()+.5)>>1,J.y=M*(d()+.5)>>1,IH(P,J,W,$),J.hasText&&E(R,J,rt)&&(h.call(null,"word",{cloud:S,word:J}),F.push(J),rt?S.hasImage||kH(rt,J):rt=[{x:J.x+J.x0,y:J.y+J.y0},{x:J.x+J.x1,y:J.y+J.y1}],J.x-=t[0]>>1,J.y-=t[1]>>1)}S._tags=F,S._bounds=rt,$>=k&&(S.stop(),h.call(null,"end",{cloud:S,words:F,bounds:rt}))}return S},S.stop=function(){return v&&(clearInterval(v),v=null),S};function w(T){T.width=T.height=1;const M=Math.sqrt(T.getContext("2d").getImageData(0,0,1,1).data.length>>2);T.width=(zy<<5)/M,T.height=Qw/M;const P=T.getContext("2d");return P.fillStyle=P.strokeStyle="red",P.textAlign="center",P.textBaseline="middle",{context:P,ratio:M}}function E(T,M,P){const R=M.x,k=M.y,F=Math.sqrt(t[0]*t[0]+t[1]*t[1]),W=u(t),$=d()<.5?1:-1;let rt,et=-$,ut,J;for(;(rt=W(et+=$))&&(ut=~~rt[0],J=~~rt[1],!(Math.min(Math.abs(ut),Math.abs(J))>=F));)if(M.x=R+ut,M.y=k+J,!(M.x+M.x0<0||M.y+M.y0<0||M.x+M.x1>t[0]||M.y+M.y1>t[1])&&(!P||!RH(M,T,t[0]))&&(!P||DH(M,P))){const lt=M.sprite,vt=M.width>>5,xt=t[0]>>5,Ht=M.x-(vt<<4),gt=Ht&127,wt=32-gt,Wt=M.y1-M.y0;let fe,le=(M.y+M.y0)*xt+(Ht>>5);for(let Te=0;Te<Wt;Te++){fe=0;for(let Fe=0;Fe<=vt;Fe++)T[le+Fe]|=fe<<wt|(Fe<vt?(fe=lt[Te*vt+Fe])>>>gt:0);le+=xt}return delete M.sprite,!0}return!1}return S.createMask=T=>{const M=document.createElement("canvas"),[P,R]=t;if(!P||!R)return;const k=P>>5,F=QD((P>>5)*R);M.width=P,M.height=R;const W=M.getContext("2d");W.drawImage(T,0,0,T.width,T.height,0,0,P,R);const $=W.getImageData(0,0,P,R).data;for(let rt=0;rt<R;rt++)for(let et=0;et<P;et++){const ut=k*rt+(et>>5),J=rt*P+et<<2,vt=$[J]>=250&&$[J+1]>=250&&$[J+2]>=250?1<<31-et%32:0;F[ut]|=vt}S.board=F,S.hasImage=!0},S.timeInterval=function(T){m=T==null?1/0:T},S.words=function(T){g=T},S.size=function(T=[]){t=[+T[0],+T[1]]},S.text=function(T){e=al(T)},S.font=function(T){n=al(T)},S.fontWeight=function(T){o=al(T)},S.rotate=function(T){c=al(T)},S.canvas=function(T){_=al(T)},S.spiral=function(T){u=BH[T]||T},S.fontSize=function(T){r=al(T)},S.padding=function(T){l=al(T)},S.random=function(T){d=al(T)},S.on=function(T){h=al(T)},S}var zH=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(g){try{h(r.next(g))}catch(v){l(v)}}function d(g){try{h(r.throw(g))}catch(v){l(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},UH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ZH={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function HH(t){return new Promise((e,n)=>{if(t instanceof HTMLImageElement){e(t);return}if(typeof t=="string"){const r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=()=>e(r),r.onerror=()=>{console.error(`'image ${t} load failed !!!'`),n()};return}n()})}function WH(t,e){if(typeof t=="function")return t;if(Array.isArray(t)){const[n,r]=t;if(!e)return()=>(r+n)/2;const[o,c]=e;return c===o?()=>(r+n)/2:({value:l})=>(r-n)/(c-o)*(l-o)+n}return()=>t}const JD=(t,e)=>n=>zH(void 0,void 0,void 0,function*(){const r=Object.assign({},ZH,t,{canvas:e.createCanvas}),o=jH();yield EH(o,r).set("fontSize",T=>{const M=n.map(P=>P.value);return WH(T,[Ho(M),Rr(M)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",HH,o.createMask),o.words([...n]);const c=o.start(),[l,u]=r.size,d=[{x:0,y:0},{x:l,y:u}],{_bounds:h=d,_tags:g,hasImage:v}=c,m=g.map(T=>{var{x:M,y:P,font:R}=T,k=UH(T,["x","y","font"]);return Object.assign(Object.assign({},k),{x:M+l/2,y:P+u/2,fontFamily:R})}),[{x:_,y:b},{x:S,y:w}]=h,E={text:"",value:0,opacity:0,fontSize:0};return m.push(Object.assign(Object.assign({},E),{x:v?0:_,y:v?0:b}),Object.assign(Object.assign({},E),{x:v?l:S,y:v?u:w})),m});JD.props={};function VH(t,e){if(e<0||e>1)throw new Error("alpha must be between 0 and 1.");if(t.length===0)return[];let n=t[0];const r=[];for(const o of t){if(o==null){r.push(o),console.warn("EMA\uFF1AThe value is null or undefined",t);continue}n==null&&(n=o);const c=n*e+(1-e)*o;r.push(c),n=c}return r}const tN=t=>{const{field:e="y",alpha:n=.6,as:r=e}=t;return o=>{const c=o.map(u=>u[e]),l=VH(c,n);return o.map((u,d)=>Object.assign(Object.assign({},u),{[r]:l[d]}))}};tN.props={};const eN=.01;function Uy(t){const{min:e,max:n}=t;return[[e[0],e[1]],[n[0],n[1]]]}function nN(t,e,n=eN){const[r,o]=t,[c,l]=e;return r>=c[0]-n&&r<=l[0]+n&&o>=c[1]-n&&o<=l[1]+n}function rN(t,e,n=eN){const[r,o]=t;return!(nN(r,e,n)&&nN(o,e,n))}function GH(t,e){const[n,r]=t,[o,c]=e;return n[0]<c[0]&&r[0]>o[0]&&n[1]<c[1]&&r[1]>o[1]}const $H=t=>{const{priority:e}=t;return n=>{const r=[];return e&&n.sort(e),n.forEach(o=>{pp(o);const c=o.getLocalBounds();r.some(u=>GH(Uy(c),Uy(u.getLocalBounds())))?hp(o):r.push(o)}),n}};function YH([t,e],[n,r]){return r>t&&e>n}function Jw(){const t=new Map;return[r=>t.get(r),(r,o)=>t.set(r,o)]}function XH(t){const e=t.cloneNode(!0),n=e.getElementById("connector");n&&e.removeChild(n);const{min:r,max:o}=e.getRenderBounds();return e.destroy(),{min:r,max:o}}const qH=t=>{const{maxIterations:e=10,maxError:n=.1,padding:r=1}=t;return o=>{const c=o.length;if(c<=1)return o;const[l,u]=Jw(),[d,h]=Jw(),[g,v]=Jw(),[m,_]=Jw();for(const b of o){const{min:S,max:w}=XH(b),[E,T]=S,[M,P]=w;u(b,T),h(b,T),v(b,P-T),_(b,[E,M])}for(let b=0;b<e;b++){o.sort((w,E)=>xi(d(w),d(E)));let S=0;for(let w=0;w<c-1;w++){const E=o[w];let T=w+1,M;for(;(M=o[T])&&!YH(m(E),m(M));)T+=1;if(M){const P=d(E),R=g(E),k=d(M),F=k-(P+R);if(F<r){const W=(r-F)/2;S=Math.max(S,W),h(E,P-W),h(M,k+W)}}}if(S<n)break}for(const b of o)b.style.y+=d(b)-l(b);return o}},KH=()=>t=>(t.forEach(e=>{pp(e);const n=e.attr("bounds"),r=e.getLocalBounds();rN(Uy(r),n)&&hp(e)}),t);function iN(t){return typeof t=="object"?t:(0,N.lu)(t)}function r6(t){let e=t/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),e}function oN(t,e,n){return .2126*r6(t)+.7152*r6(e)+.0722*r6(n)}function aN(t,e){if(!t||!e||t===e)return 1;const{r:n,g:r,b:o}=t,{r:c,g:l,b:u}=e,d=oN(n,r,o),h=oN(c,l,u);return(Math.max(d,h)+.05)/(Math.min(d,h)+.05)}function sN(t,e){const n=zl(e,r=>aN(t,iN(r)));return e[n]}const QH=t=>{const{threshold:e=4.5,palette:n=["#000","#fff"]}=t;return r=>(r.forEach(o=>{const c=o.attr("dependentElement").parsedStyle.fill,l=o.parsedStyle.fill;aN(l,c)<e&&o.attr("fill",sN(c,n))}),r)};function cN(t){var e;const n=t.getAnimations();if(!n||n.length===0)return wf(t);const r=t.cloneNode(!0);r.style.visibility="hidden",n.forEach(c=>{const l=c.effect.getKeyframes();l&&l.length>0&&r.attr(l[l.length-1])}),(e=t.parentNode)===null||e===void 0||e.appendChild(r);const o=wf(r);return r.destroy(),o}const JH=t=>{const{palette:e=["#000","#fff"],threshold:n=2}=t;return r=>(r.forEach(o=>{var c,l;const u=o.attr("dependentElement"),d=(l=(c=o.attributes.fill)!==null&&c!==void 0?c:o.parsedStyle.fill)!==null&&l!==void 0?l:"#fff",h=Uy(cN(o)),g=Uy(cN(u));if(rN(h,g,n)){const v=sN(iN(d),e);o.attr("stroke",v)}else o.removeAttribute("stroke")}),r)},tW=(t,e)=>{const[[n,r],[o,c]]=e,[[l,u],[d,h]]=t;let g=0,v=0;return l<n?g=n-l:d>o&&(g=o-d),u<r?v=r-u:h>c&&(v=c-h),[g,v]},eW=(t,e)=>!t||!t.min||!t.max?!e||!e.min||!e.max?{min:[0,0],max:[0,0]}:e:!e||!e.min||!e.max?t:{min:[Math.min(t.min[0],e.min[0]),Math.min(t.min[1],e.min[1])],max:[Math.max(t.max[0],e.max[0]),Math.max(t.max[1],e.max[1])]},nW=(t={})=>(e,{canvas:n,layout:r})=>{const{bounds:o="view",offsetX:c=0,offsetY:l=0}=t,d=(()=>{if(o==="main"){const{x:h=0,y:g=0,width:v=0,height:m=0,marginLeft:_=0,marginRight:b=0,marginTop:S=0,marginBottom:w=0,paddingLeft:E=0,paddingRight:T=0,paddingTop:M=0,paddingBottom:P=0}=r;return[[h+_+E+c,g+S+M+l],[h+v-b-T-c,g+m-w-P-l]]}else{const{x:h=0,y:g=0,width:v=0,height:m=0}=r;return[[h+c,g+l],[h+v-c,g+m-l]]}})();return e.forEach(h=>{pp(h);const{max:g,min:v}=eW(h.getRenderBounds(),h.getBounds());if(!g||!v||g[0]===0&&g[1]===0&&v[0]===0&&v[1]===0)return;const[m,_]=g,[b,S]=v,w=tW([[b,S],[m,_]],d);h.style.connector&&h.style.connectorPoints&&(h.style.connectorPoints[0][0]-=w[0],h.style.connectorPoints[0][1]-=w[1]),h.style.x+=w[0],h.style.y+=w[1]}),e};function rW(){return{"data.fetch":DD,"data.inline":ND,"data.sortBy":FD,"data.sort":BD,"data.filter":jD,"data.pick":zD,"data.rename":UD,"data.fold":ZD,"data.slice":HD,"data.custom":WD,"data.map":VD,"data.join":$D,"data.kde":YD,"data.log":XD,"data.wordCloud":JD,"data.ema":tN,"transform.stackY":oD,"transform.binX":uD,"transform.bin":QL,"transform.dodgeX":fD,"transform.jitter":dD,"transform.jitterX":hD,"transform.jitterY":pD,"transform.symmetryY":gD,"transform.diffY":vD,"transform.stackEnter":mD,"transform.normalizeY":yD,"transform.select":qw,"transform.selectX":bD,"transform.selectY":xD,"transform.groupX":SD,"transform.groupY":wD,"transform.groupColor":OD,"transform.group":By,"transform.sortX":ED,"transform.sortY":AD,"transform.sortColor":TD,"transform.flexX":MD,"transform.pack":CD,"transform.sample":PD,"transform.filter":LD,"coordinate.cartesian":AS,"coordinate.polar":bl,"coordinate.transpose":Sr,"coordinate.theta":Dm,"coordinate.parallel":Nm,"coordinate.fisheye":ed,"coordinate.radial":pg,"coordinate.radar":Fm,"coordinate.helix":MS,"encode.constant":CS,"encode.field":PS,"encode.transform":LS,"encode.column":IS,"mark.interval":bu,"mark.rect":dP,"mark.line":VS,"mark.point":wP,"mark.text":nw,"mark.cell":CP,"mark.area":DP,"mark.link":yy,"mark.image":_y,"mark.polygon":pw,"mark.box":VP,"mark.vector":vw,"mark.lineX":bw,"mark.lineY":Sw,"mark.connector":Tw,"mark.range":Pw,"mark.rangeX":s,"mark.rangeY":y,"mark.path":j,"mark.shape":ue,"mark.density":Ye,"mark.heatmap":go,"mark.wordCloud":wy,"mark.beeswarm":L8,"palette.category10":I8,"palette.category20":R8,"scale.linear":k8,"scale.ordinal":D8,"scale.band":N8,"scale.identity":F8,"scale.point":B8,"scale.time":aR,"scale.log":cR,"scale.pow":lR,"scale.sqrt":uR,"scale.threshold":fR,"scale.quantile":dR,"scale.quantize":hR,"scale.sequential":pR,"scale.constant":gR,"theme.classic":vR,"theme.classicDark":yR,"theme.academy":_R,"theme.light":hL,"theme.dark":mR,"component.axisX":bR,"component.axisY":xR,"component.legendCategory":yL,"component.legendContinuous":Bs,"component.legends":RR,"component.title":DR,"component.sliderX":GR,"component.sliderY":$R,"component.scrollbarX":YR,"component.scrollbarY":XR,"animation.scaleInX":EL,"animation.scaleOutX":Qj,"animation.scaleInY":qR,"animation.scaleOutY":Jj,"animation.waveIn":KR,"animation.fadeIn":QR,"animation.fadeOut":JR,"animation.zoomIn":tz,"animation.zoomOut":ez,"animation.pathIn":tk,"animation.morphing":ok,"animation.growInX":ak,"animation.growInY":sk,"interaction.elementHighlight":Bw,"interaction.elementHighlightByX":ck,"interaction.elementHighlightByColor":lk,"interaction.elementHoverScale":uk,"interaction.elementSelect":jw,"interaction.elementSelectByX":fk,"interaction.elementSelectByColor":dk,"interaction.fisheye":_z,"interaction.chartIndex":hk,"interaction.tooltip":aS,"interaction.legendFilter":vj,"interaction.legendHighlight":Oz,"interaction.brushHighlight":zw,"interaction.brushXHighlight":Pz,"interaction.brushYHighlight":Lz,"interaction.brushAxisHighlight":zz,"interaction.brushFilter":RL,"interaction.brushXFilter":Wz,"interaction.brushYFilter":Vz,"interaction.sliderFilter":Ak,"interaction.sliderWheel":Tk,"interaction.scrollbarFilter":sU,"interaction.poptip":Pk,"interaction.treemapDrillDown":MU,"interaction.drillDown":NU,"interaction.elementPointMove":ZU,"composition.spaceLayer":Yk,"composition.spaceFlex":Xk,"composition.facetRect":Jk,"composition.repeatMatrix":eZ,"composition.facetCircle":sZ,"composition.timingKeyframe":eD,"labelTransform.overlapHide":$H,"labelTransform.overlapDodgeY":qH,"labelTransform.overflowHide":KH,"labelTransform.contrastReverse":QH,"labelTransform.overflowStroke":JH,"labelTransform.exceedAdjust":nW}}var Zy=t=>t;function tO(t,e){t&&uN.hasOwnProperty(t.type)&&uN[t.type](t,e)}var lN={Feature:function(t,e){tO(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)tO(n[r].geometry,e)}},uN={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){i6(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)i6(n[r],e,0)},Polygon:function(t,e){fN(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)fN(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)tO(n[r],e)}};function i6(t,e,n){var r=-1,o=t.length-n,c;for(e.lineStart();++r<o;)c=t[r],e.point(c[0],c[1],c[2]);e.lineEnd()}function fN(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)i6(t[n],e,1);e.polygonEnd()}function b0(t,e){t&&lN.hasOwnProperty(t.type)?lN[t.type](t,e):tO(t,e)}class sl{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let o=0;o<this._n&&o<32;o++){const c=n[o],l=e+c,u=Math.abs(e)<Math.abs(c)?e-(l-c):c-(l-e);u&&(n[r++]=u),e=l}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,o,c,l=0;if(n>0){for(l=e[--n];n>0&&(r=l,o=e[--n],l=r+o,c=o-(l-r),!c););n>0&&(c<0&&e[n-1]<0||c>0&&e[n-1]>0)&&(o=c*2,r=l+o,o==r-l&&(l=r))}return l}}function uq(t,e){const n=new sl;if(e===void 0)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let o of t)(o=+e(o,++r,t))&&n.add(o)}return+n}function fq(t,e){const n=new sl;let r=-1;return Float64Array.from(t,e===void 0?o=>n.add(+o||0):o=>n.add(+e(o,++r,t)||0))}var nr=1e-6,dN=1e-12,Or=Math.PI,Ui=Or/2,hN=Or/4,Sa=Or*2,ko=180/Or,Ni=Or/180,Wr=Math.abs,x0=Math.atan,cl=Math.atan2,yr=Math.cos,eO=Math.ceil,pN=Math.exp,dq=Math.floor,hq=Math.hypot,nO=Math.log,o6=Math.pow,ur=Math.sin,Qa=Math.sign||function(t){return t>0?1:t<0?-1:0},ua=Math.sqrt,a6=Math.tan;function gN(t){return t>1?0:t<-1?Or:Math.acos(t)}function Ja(t){return t>1?Ui:t<-1?-Ui:Math.asin(t)}function pq(t){return(t=ur(t/2))*t}function ts(){}var s6=new sl,c6=new sl,vN,mN,l6,u6,Ru={point:ts,lineStart:ts,lineEnd:ts,polygonStart:function(){Ru.lineStart=iW,Ru.lineEnd=aW},polygonEnd:function(){Ru.lineStart=Ru.lineEnd=Ru.point=ts,s6.add(Wr(c6)),c6=new sl},result:function(){var t=s6/2;return s6=new sl,t}};function iW(){Ru.point=oW}function oW(t,e){Ru.point=yN,vN=l6=t,mN=u6=e}function yN(t,e){c6.add(u6*t-l6*e),l6=t,u6=e}function aW(){yN(vN,mN)}var _N=Ru,S0=1/0,rO=S0,Hy=-S0,iO=Hy,sW={point:cW,lineStart:ts,lineEnd:ts,polygonStart:ts,polygonEnd:ts,result:function(){var t=[[S0,rO],[Hy,iO]];return Hy=iO=-(rO=S0=1/0),t}};function cW(t,e){t<S0&&(S0=t),t>Hy&&(Hy=t),e<rO&&(rO=e),e>iO&&(iO=e)}var oO=sW,f6=0,d6=0,Wy=0,aO=0,sO=0,w0=0,h6=0,p6=0,Vy=0,bN,xN,sc,cc,Ts={point:Sd,lineStart:SN,lineEnd:wN,polygonStart:function(){Ts.lineStart=fW,Ts.lineEnd=dW},polygonEnd:function(){Ts.point=Sd,Ts.lineStart=SN,Ts.lineEnd=wN},result:function(){var t=Vy?[h6/Vy,p6/Vy]:w0?[aO/w0,sO/w0]:Wy?[f6/Wy,d6/Wy]:[NaN,NaN];return f6=d6=Wy=aO=sO=w0=h6=p6=Vy=0,t}};function Sd(t,e){f6+=t,d6+=e,++Wy}function SN(){Ts.point=lW}function lW(t,e){Ts.point=uW,Sd(sc=t,cc=e)}function uW(t,e){var n=t-sc,r=e-cc,o=ua(n*n+r*r);aO+=o*(sc+t)/2,sO+=o*(cc+e)/2,w0+=o,Sd(sc=t,cc=e)}function wN(){Ts.point=Sd}function fW(){Ts.point=hW}function dW(){ON(bN,xN)}function hW(t,e){Ts.point=ON,Sd(bN=sc=t,xN=cc=e)}function ON(t,e){var n=t-sc,r=e-cc,o=ua(n*n+r*r);aO+=o*(sc+t)/2,sO+=o*(cc+e)/2,w0+=o,o=cc*t-sc*e,h6+=o*(sc+t),p6+=o*(cc+e),Vy+=o*3,Sd(sc=t,cc=e)}var EN=Ts;function AN(t){this._context=t}AN.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Sa);break}}},result:ts};var g6=new sl,v6,TN,MN,Gy,$y,cO={point:ts,lineStart:function(){cO.point=pW},lineEnd:function(){v6&&CN(TN,MN),cO.point=ts},polygonStart:function(){v6=!0},polygonEnd:function(){v6=null},result:function(){var t=+g6;return g6=new sl,t}};function pW(t,e){cO.point=CN,TN=Gy=t,MN=$y=e}function CN(t,e){Gy-=t,$y-=e,g6.add(ua(Gy*Gy+$y*$y)),Gy=t,$y=e}var PN=cO;let LN,lO,IN,RN;class kN{constructor(e){this._append=e==null?DN:gW(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==IN||this._append!==lO){const r=this._radius,o=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,IN=r,lO=this._append,RN=this._,this._=o}this._+=RN;break}}}result(){const e=this._;return this._="",e.length?e:null}}function DN(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function gW(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return DN;if(e!==LN){const n=Ai(10,e);LN=e,lO=function(o){let c=1;this._+=o[0];for(const l=o.length;c<l;++c)this._+=Math.round(arguments[c]*n)/n+o[c]}}return lO}function NN(t,e){let n=3,r=4.5,o,c;function l(u){return u&&(typeof r=="function"&&c.pointRadius(+r.apply(this,arguments)),b0(u,o(c))),c.result()}return l.area=function(u){return b0(u,o(_N)),_N.result()},l.measure=function(u){return b0(u,o(PN)),PN.result()},l.bounds=function(u){return b0(u,o(oO)),oO.result()},l.centroid=function(u){return b0(u,o(EN)),EN.result()},l.projection=function(u){return arguments.length?(o=u==null?(t=null,Zy):(t=u).stream,l):t},l.context=function(u){return arguments.length?(c=u==null?(e=null,new kN(n)):new AN(e=u),typeof r!="function"&&c.pointRadius(r),l):e},l.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(c.pointRadius(+u),+u),l):r},l.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const d=Math.floor(u);if(!(d>=0))throw new RangeError(`invalid digits: ${u}`);n=d}return e===null&&(c=new kN(n)),l},l.projection(t).digits(n).context(e)}function O0(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=Math.max(0,Math.ceil((e-t)/n))|0,c=new Array(o);++r<o;)c[r]=t+r*n;return c}function FN(t,e,n){var r=O0(t,e-nr,n).concat(e);return function(o){return r.map(function(c){return[o,c]})}}function BN(t,e,n){var r=O0(t,e-nr,n).concat(e);return function(o){return r.map(function(c){return[c,o]})}}function vW(){var t,e,n,r,o,c,l,u,d=10,h=d,g=90,v=360,m,_,b,S,w=2.5;function E(){return{type:"MultiLineString",coordinates:T()}}function T(){return O0(eO(r/g)*g,n,g).map(b).concat(O0(eO(u/v)*v,l,v).map(S)).concat(O0(eO(e/d)*d,t,d).filter(function(M){return Wr(M%g)>nr}).map(m)).concat(O0(eO(c/h)*h,o,h).filter(function(M){return Wr(M%v)>nr}).map(_))}return E.lines=function(){return T().map(function(M){return{type:"LineString",coordinates:M}})},E.outline=function(){return{type:"Polygon",coordinates:[b(r).concat(S(l).slice(1),b(n).reverse().slice(1),S(u).reverse().slice(1))]}},E.extent=function(M){return arguments.length?E.extentMajor(M).extentMinor(M):E.extentMinor()},E.extentMajor=function(M){return arguments.length?(r=+M[0][0],n=+M[1][0],u=+M[0][1],l=+M[1][1],r>n&&(M=r,r=n,n=M),u>l&&(M=u,u=l,l=M),E.precision(w)):[[r,u],[n,l]]},E.extentMinor=function(M){return arguments.length?(e=+M[0][0],t=+M[1][0],c=+M[0][1],o=+M[1][1],e>t&&(M=e,e=t,t=M),c>o&&(M=c,c=o,o=M),E.precision(w)):[[e,c],[t,o]]},E.step=function(M){return arguments.length?E.stepMajor(M).stepMinor(M):E.stepMinor()},E.stepMajor=function(M){return arguments.length?(g=+M[0],v=+M[1],E):[g,v]},E.stepMinor=function(M){return arguments.length?(d=+M[0],h=+M[1],E):[d,h]},E.precision=function(M){return arguments.length?(w=+M,m=FN(c,o,90),_=BN(e,t,w),b=FN(u,l,90),S=BN(r,n,w),E):w},E.extentMajor([[-180,-90+nr],[180,90-nr]]).extentMinor([[-180,-80-nr],[180,80+nr]])}function mW(){return vW()()}function jN(){var t=[],e;return{point:function(n,r,o){e.push([n,r,o])},lineStart:function(){t.push(e=[])},lineEnd:ts,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function uO(t,e){return Wr(t[0]-e[0])<nr&&Wr(t[1]-e[1])<nr}function fO(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function zN(t,e,n,r,o){var c=[],l=[],u,d;if(t.forEach(function(b){if(!((S=b.length-1)<=0)){var S,w=b[0],E=b[S],T;if(uO(w,E)){if(!w[2]&&!E[2]){for(o.lineStart(),u=0;u<S;++u)o.point((w=b[u])[0],w[1]);o.lineEnd();return}E[0]+=2*nr}c.push(T=new fO(w,b,null,!0)),l.push(T.o=new fO(w,null,T,!1)),c.push(T=new fO(E,b,null,!1)),l.push(T.o=new fO(E,null,T,!0))}}),!!c.length){for(l.sort(e),UN(c),UN(l),u=0,d=l.length;u<d;++u)l[u].e=n=!n;for(var h=c[0],g,v;;){for(var m=h,_=!0;m.v;)if((m=m.n)===h)return;g=m.z,o.lineStart();do{if(m.v=m.o.v=!0,m.e){if(_)for(u=0,d=g.length;u<d;++u)o.point((v=g[u])[0],v[1]);else r(m.x,m.n.x,1,o);m=m.n}else{if(_)for(g=m.p.z,u=g.length-1;u>=0;--u)o.point((v=g[u])[0],v[1]);else r(m.x,m.p.x,-1,o);m=m.p}m=m.o,g=m.z,_=!_}while(!m.v);o.lineEnd()}}}function UN(t){if(e=t.length){for(var e,n=0,r=t[0],o;++n<e;)r.n=o=t[n],o.p=r,r=o;r.n=o=t[0],o.p=r}}function m6(t){return[cl(t[1],t[0]),Ja(t[2])]}function E0(t){var e=t[0],n=t[1],r=yr(n);return[r*yr(e),r*ur(e),ur(n)]}function dO(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hO(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function y6(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function pO(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function _6(t){var e=ua(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function b6(t){return Wr(t[0])<=Or?t[0]:Qa(t[0])*((Wr(t[0])+Or)%Sa-Or)}function yW(t,e){var n=b6(e),r=e[1],o=ur(r),c=[ur(n),-yr(n),0],l=0,u=0,d=new sl;o===1?r=Ui+nr:o===-1&&(r=-Ui-nr);for(var h=0,g=t.length;h<g;++h)if(m=(v=t[h]).length)for(var v,m,_=v[m-1],b=b6(_),S=_[1]/2+hN,w=ur(S),E=yr(S),T=0;T<m;++T,b=P,w=k,E=F,_=M){var M=v[T],P=b6(M),R=M[1]/2+hN,k=ur(R),F=yr(R),W=P-b,$=W>=0?1:-1,rt=$*W,et=rt>Or,ut=w*k;if(d.add(cl(ut*$*ur(rt),E*F+ut*yr(rt))),l+=et?W+$*Sa:W,et^b>=n^P>=n){var J=hO(E0(_),E0(M));_6(J);var lt=hO(c,J);_6(lt);var vt=(et^W>=0?-1:1)*Ja(lt[2]);(r>vt||r===vt&&(J[0]||J[1]))&&(u+=et^W>=0?1:-1)}}return(l<-nr||l<nr&&d<-dN)^u&1}function*_W(t){for(const e of t)yield*_F(e)}function ZN(t){return Array.from(_W(t))}function HN(t,e,n,r){return function(o){var c=e(o),l=jN(),u=e(l),d=!1,h,g,v,m={point:_,lineStart:S,lineEnd:w,polygonStart:function(){m.point=E,m.lineStart=T,m.lineEnd=M,g=[],h=[]},polygonEnd:function(){m.point=_,m.lineStart=S,m.lineEnd=w,g=ZN(g);var P=yW(h,r);g.length?(d||(o.polygonStart(),d=!0),zN(g,xW,P,n,o)):P&&(d||(o.polygonStart(),d=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),d&&(o.polygonEnd(),d=!1),g=h=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function _(P,R){t(P,R)&&o.point(P,R)}function b(P,R){c.point(P,R)}function S(){m.point=b,c.lineStart()}function w(){m.point=_,c.lineEnd()}function E(P,R){v.push([P,R]),u.point(P,R)}function T(){u.lineStart(),v=[]}function M(){E(v[0][0],v[0][1]),u.lineEnd();var P=u.clean(),R=l.result(),k,F=R.length,W,$,rt;if(v.pop(),h.push(v),v=null,!!F){if(P&1){if($=R[0],(W=$.length-1)>0){for(d||(o.polygonStart(),d=!0),o.lineStart(),k=0;k<W;++k)o.point((rt=$[k])[0],rt[1]);o.lineEnd()}return}F>1&&P&2&&R.push(R.pop().concat(R.shift())),g.push(R.filter(bW))}}return m}}function bW(t){return t.length>1}function xW(t,e){return((t=t.x)[0]<0?t[1]-Ui-nr:Ui-t[1])-((e=e.x)[0]<0?e[1]-Ui-nr:Ui-e[1])}var WN=HN(function(){return!0},SW,OW,[-Or,-Ui]);function SW(t){var e=NaN,n=NaN,r=NaN,o;return{lineStart:function(){t.lineStart(),o=1},point:function(c,l){var u=c>0?Or:-Or,d=Wr(c-e);Wr(d-Or)<nr?(t.point(e,n=(n+l)/2>0?Ui:-Ui),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(c,n),o=0):r!==u&&d>=Or&&(Wr(e-r)<nr&&(e-=r*nr),Wr(c-u)<nr&&(c-=u*nr),n=wW(e,n,c,l),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),o=0),t.point(e=c,n=l),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-o}}}function wW(t,e,n,r){var o,c,l=ur(t-n);return Wr(l)>nr?x0((ur(e)*(c=yr(r))*ur(n)-ur(r)*(o=yr(e))*ur(t))/(o*c*l)):(e+r)/2}function OW(t,e,n,r){var o;if(t==null)o=n*Ui,r.point(-Or,o),r.point(0,o),r.point(Or,o),r.point(Or,0),r.point(Or,-o),r.point(0,-o),r.point(-Or,-o),r.point(-Or,0),r.point(-Or,o);else if(Wr(t[0]-e[0])>nr){var c=t[0]<e[0]?Or:-Or;o=n*c/2,r.point(-c,o),r.point(0,o),r.point(c,o)}else r.point(e[0],e[1])}function VN(t,e,n,r,o,c){if(n){var l=yr(e),u=ur(e),d=r*n;o==null?(o=e+r*Sa,c=e-d/2):(o=GN(l,o),c=GN(l,c),(r>0?o<c:o>c)&&(o+=r*Sa));for(var h,g=o;r>0?g>c:g<c;g-=d)h=m6([l,-u*yr(g),-u*ur(g)]),t.point(h[0],h[1])}}function GN(t,e){e=E0(e),e[0]-=t,_6(e);var n=gN(-e[1]);return((-e[2]<0?-n:n)+Sa-nr)%Sa}function gq(){var t=constant([0,0]),e=constant(90),n=constant(2),r,o,c={point:l};function l(d,h){r.push(d=o(d,h)),d[0]*=degrees,d[1]*=degrees}function u(){var d=t.apply(this,arguments),h=e.apply(this,arguments)*radians,g=n.apply(this,arguments)*radians;return r=[],o=rotateRadians(-d[0]*radians,-d[1]*radians,0).invert,VN(c,h,g,1),d={type:"Polygon",coordinates:[r]},r=o=null,d}return u.center=function(d){return arguments.length?(t=typeof d=="function"?d:constant([+d[0],+d[1]]),u):t},u.radius=function(d){return arguments.length?(e=typeof d=="function"?d:constant(+d),u):e},u.precision=function(d){return arguments.length?(n=typeof d=="function"?d:constant(+d),u):n},u}function EW(t){var e=yr(t),n=2*Ni,r=e>0,o=Wr(e)>nr;function c(g,v,m,_){VN(_,t,n,m,g,v)}function l(g,v){return yr(g)*yr(v)>e}function u(g){var v,m,_,b,S;return{lineStart:function(){b=_=!1,S=1},point:function(w,E){var T=[w,E],M,P=l(w,E),R=r?P?0:h(w,E):P?h(w+(w<0?Or:-Or),E):0;if(!v&&(b=_=P)&&g.lineStart(),P!==_&&(M=d(v,T),(!M||uO(v,M)||uO(T,M))&&(T[2]=1)),P!==_)S=0,P?(g.lineStart(),M=d(T,v),g.point(M[0],M[1])):(M=d(v,T),g.point(M[0],M[1],2),g.lineEnd()),v=M;else if(o&&v&&r^P){var k;!(R&m)&&(k=d(T,v,!0))&&(S=0,r?(g.lineStart(),g.point(k[0][0],k[0][1]),g.point(k[1][0],k[1][1]),g.lineEnd()):(g.point(k[1][0],k[1][1]),g.lineEnd(),g.lineStart(),g.point(k[0][0],k[0][1],3)))}P&&(!v||!uO(v,T))&&g.point(T[0],T[1]),v=T,_=P,m=R},lineEnd:function(){_&&g.lineEnd(),v=null},clean:function(){return S|(b&&_)<<1}}}function d(g,v,m){var _=E0(g),b=E0(v),S=[1,0,0],w=hO(_,b),E=dO(w,w),T=w[0],M=E-T*T;if(!M)return!m&&g;var P=e*E/M,R=-e*T/M,k=hO(S,w),F=pO(S,P),W=pO(w,R);y6(F,W);var $=k,rt=dO(F,$),et=dO($,$),ut=rt*rt-et*(dO(F,F)-1);if(!(ut<0)){var J=ua(ut),lt=pO($,(-rt-J)/et);if(y6(lt,F),lt=m6(lt),!m)return lt;var vt=g[0],xt=v[0],Ht=g[1],gt=v[1],wt;xt<vt&&(wt=vt,vt=xt,xt=wt);var Wt=xt-vt,fe=Wr(Wt-Or)<nr,le=fe||Wt<nr;if(!fe&&gt<Ht&&(wt=Ht,Ht=gt,gt=wt),le?fe?Ht+gt>0^lt[1]<(Wr(lt[0]-vt)<nr?Ht:gt):Ht<=lt[1]&&lt[1]<=gt:Wt>Or^(vt<=lt[0]&&lt[0]<=xt)){var Te=pO($,(-rt+J)/et);return y6(Te,F),[lt,m6(Te)]}}}function h(g,v){var m=r?t:Or-t,_=0;return g<-m?_|=1:g>m&&(_|=2),v<-m?_|=4:v>m&&(_|=8),_}return HN(l,u,c,r?[0,-t]:[-Or,t-Or])}function AW(t,e,n,r,o,c){var l=t[0],u=t[1],d=e[0],h=e[1],g=0,v=1,m=d-l,_=h-u,b;if(b=n-l,!(!m&&b>0)){if(b/=m,m<0){if(b<g)return;b<v&&(v=b)}else if(m>0){if(b>v)return;b>g&&(g=b)}if(b=o-l,!(!m&&b<0)){if(b/=m,m<0){if(b>v)return;b>g&&(g=b)}else if(m>0){if(b<g)return;b<v&&(v=b)}if(b=r-u,!(!_&&b>0)){if(b/=_,_<0){if(b<g)return;b<v&&(v=b)}else if(_>0){if(b>v)return;b>g&&(g=b)}if(b=c-u,!(!_&&b<0)){if(b/=_,_<0){if(b>v)return;b>g&&(g=b)}else if(_>0){if(b<g)return;b<v&&(v=b)}return g>0&&(t[0]=l+g*m,t[1]=u+g*_),v<1&&(e[0]=l+v*m,e[1]=u+v*_),!0}}}}}var Yy=1e9,gO=-Yy;function $N(t,e,n,r){function o(h,g){return t<=h&&h<=n&&e<=g&&g<=r}function c(h,g,v,m){var _=0,b=0;if(h==null||(_=l(h,v))!==(b=l(g,v))||d(h,g)<0^v>0)do m.point(_===0||_===3?t:n,_>1?r:e);while((_=(_+v+4)%4)!==b);else m.point(g[0],g[1])}function l(h,g){return Wr(h[0]-t)<nr?g>0?0:3:Wr(h[0]-n)<nr?g>0?2:1:Wr(h[1]-e)<nr?g>0?1:0:g>0?3:2}function u(h,g){return d(h.x,g.x)}function d(h,g){var v=l(h,1),m=l(g,1);return v!==m?v-m:v===0?g[1]-h[1]:v===1?h[0]-g[0]:v===2?h[1]-g[1]:g[0]-h[0]}return function(h){var g=h,v=jN(),m,_,b,S,w,E,T,M,P,R,k,F={point:W,lineStart:ut,lineEnd:J,polygonStart:rt,polygonEnd:et};function W(vt,xt){o(vt,xt)&&g.point(vt,xt)}function $(){for(var vt=0,xt=0,Ht=_.length;xt<Ht;++xt)for(var gt=_[xt],wt=1,Wt=gt.length,fe=gt[0],le,Te,Fe=fe[0],De=fe[1];wt<Wt;++wt)le=Fe,Te=De,fe=gt[wt],Fe=fe[0],De=fe[1],Te<=r?De>r&&(Fe-le)*(r-Te)>(De-Te)*(t-le)&&++vt:De<=r&&(Fe-le)*(r-Te)<(De-Te)*(t-le)&&--vt;return vt}function rt(){g=v,m=[],_=[],k=!0}function et(){var vt=$(),xt=k&&vt,Ht=(m=ZN(m)).length;(xt||Ht)&&(h.polygonStart(),xt&&(h.lineStart(),c(null,null,1,h),h.lineEnd()),Ht&&zN(m,u,vt,c,h),h.polygonEnd()),g=h,m=_=b=null}function ut(){F.point=lt,_&&_.push(b=[]),R=!0,P=!1,T=M=NaN}function J(){m&&(lt(S,w),E&&P&&v.rejoin(),m.push(v.result())),F.point=W,P&&g.lineEnd()}function lt(vt,xt){var Ht=o(vt,xt);if(_&&b.push([vt,xt]),R)S=vt,w=xt,E=Ht,R=!1,Ht&&(g.lineStart(),g.point(vt,xt));else if(Ht&&P)g.point(vt,xt);else{var gt=[T=Math.max(gO,Math.min(Yy,T)),M=Math.max(gO,Math.min(Yy,M))],wt=[vt=Math.max(gO,Math.min(Yy,vt)),xt=Math.max(gO,Math.min(Yy,xt))];AW(gt,wt,t,e,n,r)?(P||(g.lineStart(),g.point(gt[0],gt[1])),g.point(wt[0],wt[1]),Ht||g.lineEnd(),k=!1):Ht&&(g.lineStart(),g.point(vt,xt),k=!1)}T=vt,M=xt,P=Ht}return F}}function x6(t,e){function n(r,o){return r=t(r,o),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,o){return r=e.invert(r,o),r&&t.invert(r[0],r[1])}),n}function S6(t,e){return Wr(t)>Or&&(t-=Math.round(t/Sa)*Sa),[t,e]}S6.invert=S6;function YN(t,e,n){return(t%=Sa)?e||n?x6(qN(t),KN(e,n)):qN(t):e||n?KN(e,n):S6}function XN(t){return function(e,n){return e+=t,Wr(e)>Or&&(e-=Math.round(e/Sa)*Sa),[e,n]}}function qN(t){var e=XN(t);return e.invert=XN(-t),e}function KN(t,e){var n=yr(t),r=ur(t),o=yr(e),c=ur(e);function l(u,d){var h=yr(d),g=yr(u)*h,v=ur(u)*h,m=ur(d),_=m*n+g*r;return[cl(v*o-_*c,g*n-m*r),Ja(_*o+v*c)]}return l.invert=function(u,d){var h=yr(d),g=yr(u)*h,v=ur(u)*h,m=ur(d),_=m*o-v*c;return[cl(v*o+m*c,g*n+_*r),Ja(_*n-g*r)]},l}function TW(t){t=YN(t[0]*Ni,t[1]*Ni,t.length>2?t[2]*Ni:0);function e(n){return n=t(n[0]*Ni,n[1]*Ni),n[0]*=ko,n[1]*=ko,n}return e.invert=function(n){return n=t.invert(n[0]*Ni,n[1]*Ni),n[0]*=ko,n[1]*=ko,n},e}function vq(t){return{stream:Xy(t)}}function Xy(t){return function(e){var n=new w6;for(var r in t)n[r]=t[r];return n.stream=e,n}}function w6(){}w6.prototype={constructor:w6,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function O6(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),b0(n,t.stream(oO)),e(oO.result()),r!=null&&t.clipExtent(r),t}function vO(t,e,n){return O6(t,function(r){var o=e[1][0]-e[0][0],c=e[1][1]-e[0][1],l=Math.min(o/(r[1][0]-r[0][0]),c/(r[1][1]-r[0][1])),u=+e[0][0]+(o-l*(r[1][0]+r[0][0]))/2,d=+e[0][1]+(c-l*(r[1][1]+r[0][1]))/2;t.scale(150*l).translate([u,d])},n)}function E6(t,e,n){return vO(t,[[0,0],e],n)}function A6(t,e,n){return O6(t,function(r){var o=+e,c=o/(r[1][0]-r[0][0]),l=(o-c*(r[1][0]+r[0][0]))/2,u=-c*r[0][1];t.scale(150*c).translate([l,u])},n)}function T6(t,e,n){return O6(t,function(r){var o=+e,c=o/(r[1][1]-r[0][1]),l=-c*r[0][0],u=(o-c*(r[1][1]+r[0][1]))/2;t.scale(150*c).translate([l,u])},n)}var QN=16,MW=yr(30*Ni);function JN(t,e){return+e?PW(t,e):CW(t)}function CW(t){return Xy({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function PW(t,e){function n(r,o,c,l,u,d,h,g,v,m,_,b,S,w){var E=h-r,T=g-o,M=E*E+T*T;if(M>4*e&&S--){var P=l+m,R=u+_,k=d+b,F=ua(P*P+R*R+k*k),W=Ja(k/=F),$=Wr(Wr(k)-1)<nr||Wr(c-v)<nr?(c+v)/2:cl(R,P),rt=t($,W),et=rt[0],ut=rt[1],J=et-r,lt=ut-o,vt=T*J-E*lt;(vt*vt/M>e||Wr((E*J+T*lt)/M-.5)>.3||l*m+u*_+d*b<MW)&&(n(r,o,c,l,u,d,et,ut,$,P/=F,R/=F,k,S,w),w.point(et,ut),n(et,ut,$,P,R,k,h,g,v,m,_,b,S,w))}}return function(r){var o,c,l,u,d,h,g,v,m,_,b,S,w={point:E,lineStart:T,lineEnd:P,polygonStart:function(){r.polygonStart(),w.lineStart=R},polygonEnd:function(){r.polygonEnd(),w.lineStart=T}};function E(W,$){W=t(W,$),r.point(W[0],W[1])}function T(){v=NaN,w.point=M,r.lineStart()}function M(W,$){var rt=E0([W,$]),et=t(W,$);n(v,m,g,_,b,S,v=et[0],m=et[1],g=W,_=rt[0],b=rt[1],S=rt[2],QN,r),r.point(v,m)}function P(){w.point=E,r.lineEnd()}function R(){T(),w.point=k,w.lineEnd=F}function k(W,$){M(o=W,$),c=v,l=m,u=_,d=b,h=S,w.point=M}function F(){n(v,m,g,_,b,S,c,l,o,u,d,h,QN,r),w.lineEnd=P,P()}return w}}var LW=Xy({point:function(t,e){this.stream.point(t*Ni,e*Ni)}});function IW(t){return Xy({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function RW(t,e,n,r,o){function c(l,u){return l*=r,u*=o,[e+t*l,n-t*u]}return c.invert=function(l,u){return[(l-e)/t*r,(n-u)/t*o]},c}function t9(t,e,n,r,o,c){if(!c)return RW(t,e,n,r,o);var l=yr(c),u=ur(c),d=l*t,h=u*t,g=l/t,v=u/t,m=(u*n-l*e)/t,_=(u*e+l*n)/t;function b(S,w){return S*=r,w*=o,[d*S-h*w+e,n-h*S-d*w]}return b.invert=function(S,w){return[r*(g*S-v*w+m),o*(_-v*S-g*w)]},b}function lc(t){return M6(function(){return t})()}function M6(t){var e,n=150,r=480,o=250,c=0,l=0,u=0,d=0,h=0,g,v=0,m=1,_=1,b=null,S=WN,w=null,E,T,M,P=Zy,R=.5,k,F,W,$,rt;function et(vt){return W(vt[0]*Ni,vt[1]*Ni)}function ut(vt){return vt=W.invert(vt[0],vt[1]),vt&&[vt[0]*ko,vt[1]*ko]}et.stream=function(vt){return $&&rt===vt?$:$=LW(IW(g)(S(k(P(rt=vt)))))},et.preclip=function(vt){return arguments.length?(S=vt,b=void 0,lt()):S},et.postclip=function(vt){return arguments.length?(P=vt,w=E=T=M=null,lt()):P},et.clipAngle=function(vt){return arguments.length?(S=+vt?EW(b=vt*Ni):(b=null,WN),lt()):b*ko},et.clipExtent=function(vt){return arguments.length?(P=vt==null?(w=E=T=M=null,Zy):$N(w=+vt[0][0],E=+vt[0][1],T=+vt[1][0],M=+vt[1][1]),lt()):w==null?null:[[w,E],[T,M]]},et.scale=function(vt){return arguments.length?(n=+vt,J()):n},et.translate=function(vt){return arguments.length?(r=+vt[0],o=+vt[1],J()):[r,o]},et.center=function(vt){return arguments.length?(c=vt[0]%360*Ni,l=vt[1]%360*Ni,J()):[c*ko,l*ko]},et.rotate=function(vt){return arguments.length?(u=vt[0]%360*Ni,d=vt[1]%360*Ni,h=vt.length>2?vt[2]%360*Ni:0,J()):[u*ko,d*ko,h*ko]},et.angle=function(vt){return arguments.length?(v=vt%360*Ni,J()):v*ko},et.reflectX=function(vt){return arguments.length?(m=vt?-1:1,J()):m<0},et.reflectY=function(vt){return arguments.length?(_=vt?-1:1,J()):_<0},et.precision=function(vt){return arguments.length?(k=JN(F,R=vt*vt),lt()):ua(R)},et.fitExtent=function(vt,xt){return vO(et,vt,xt)},et.fitSize=function(vt,xt){return E6(et,vt,xt)},et.fitWidth=function(vt,xt){return A6(et,vt,xt)},et.fitHeight=function(vt,xt){return T6(et,vt,xt)};function J(){var vt=t9(n,0,0,m,_,v).apply(null,e(c,l)),xt=t9(n,r-vt[0],o-vt[1],m,_,v);return g=YN(u,d,h),F=x6(e,xt),W=x6(g,F),k=JN(F,R),lt()}function lt(){return $=rt=null,et}return function(){return e=t.apply(this,arguments),et.invert=e.invert&&ut,J()}}function C6(t){var e=0,n=Or/3,r=M6(t),o=r(e,n);return o.parallels=function(c){return arguments.length?r(e=c[0]*Ni,n=c[1]*Ni):[e*ko,n*ko]},o}function kW(t){var e=yr(t);function n(r,o){return[r*e,ur(o)/e]}return n.invert=function(r,o){return[r/e,Ja(o*e)]},n}function e9(t,e){var n=ur(t),r=(n+ur(e))/2;if(Wr(r)<nr)return kW(t);var o=1+n*(2*r-n),c=ua(o)/r;function l(u,d){var h=ua(o-2*r*ur(d))/r;return[h*ur(u*=r),c-h*yr(u)]}return l.invert=function(u,d){var h=c-d,g=cl(u,Wr(h))*Qa(h);return h*r<0&&(g-=Or*Qa(u)*Qa(h)),[g/r,Ja((o-(u*u+h*h)*r*r)/(2*r))]},l}function mO(){return C6(e9).scale(155.424).center([0,33.6442])}function n9(){return mO().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function DW(t){var e=t.length;return{point:function(n,r){for(var o=-1;++o<e;)t[o].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function NW(){var t,e,n=n9(),r,o=mO().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c,l=mO().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,d,h={point:function(m,_){d=[m,_]}};function g(m){var _=m[0],b=m[1];return d=null,r.point(_,b),d||(c.point(_,b),d)||(u.point(_,b),d)}g.invert=function(m){var _=n.scale(),b=n.translate(),S=(m[0]-b[0])/_,w=(m[1]-b[1])/_;return(w>=.12&&w<.234&&S>=-.425&&S<-.214?o:w>=.166&&w<.234&&S>=-.214&&S<-.115?l:n).invert(m)},g.stream=function(m){return t&&e===m?t:t=DW([n.stream(e=m),o.stream(m),l.stream(m)])},g.precision=function(m){return arguments.length?(n.precision(m),o.precision(m),l.precision(m),v()):n.precision()},g.scale=function(m){return arguments.length?(n.scale(m),o.scale(m*.35),l.scale(m),g.translate(n.translate())):n.scale()},g.translate=function(m){if(!arguments.length)return n.translate();var _=n.scale(),b=+m[0],S=+m[1];return r=n.translate(m).clipExtent([[b-.455*_,S-.238*_],[b+.455*_,S+.238*_]]).stream(h),c=o.translate([b-.307*_,S+.201*_]).clipExtent([[b-.425*_+nr,S+.12*_+nr],[b-.214*_-nr,S+.234*_-nr]]).stream(h),u=l.translate([b-.205*_,S+.212*_]).clipExtent([[b-.214*_+nr,S+.166*_+nr],[b-.115*_-nr,S+.234*_-nr]]).stream(h),v()},g.fitExtent=function(m,_){return vO(g,m,_)},g.fitSize=function(m,_){return E6(g,m,_)},g.fitWidth=function(m,_){return A6(g,m,_)},g.fitHeight=function(m,_){return T6(g,m,_)};function v(){return t=e=null,g}return g.scale(1070)}function r9(t){return function(e,n){var r=yr(e),o=yr(n),c=t(r*o);return c===1/0?[2,0]:[c*o*ur(e),c*ur(n)]}}function qy(t){return function(e,n){var r=ua(e*e+n*n),o=t(r),c=ur(o),l=yr(o);return[cl(e*c,r*l),Ja(r&&n*c/r)]}}var P6=r9(function(t){return ua(2/(1+t))});P6.invert=qy(function(t){return 2*Ja(t/2)});function FW(){return lc(P6).scale(124.75).clipAngle(180-.001)}var L6=r9(function(t){return(t=gN(t))&&t/ur(t)});L6.invert=qy(function(t){return t});function BW(){return lc(L6).scale(79.4188).clipAngle(180-.001)}function Ky(t,e){return[t,nO(a6((Ui+e)/2))]}Ky.invert=function(t,e){return[t,2*x0(pN(e))-Ui]};function jW(){return i9(Ky).scale(961/Sa)}function i9(t){var e=lc(t),n=e.center,r=e.scale,o=e.translate,c=e.clipExtent,l=null,u,d,h;e.scale=function(v){return arguments.length?(r(v),g()):r()},e.translate=function(v){return arguments.length?(o(v),g()):o()},e.center=function(v){return arguments.length?(n(v),g()):n()},e.clipExtent=function(v){return arguments.length?(v==null?l=u=d=h=null:(l=+v[0][0],u=+v[0][1],d=+v[1][0],h=+v[1][1]),g()):l==null?null:[[l,u],[d,h]]};function g(){var v=Or*r(),m=e(TW(e.rotate()).invert([0,0]));return c(l==null?[[m[0]-v,m[1]-v],[m[0]+v,m[1]+v]]:t===Ky?[[Math.max(m[0]-v,l),u],[Math.min(m[0]+v,d),h]]:[[l,Math.max(m[1]-v,u)],[d,Math.min(m[1]+v,h)]])}return g()}function yO(t){return a6((Ui+t)/2)}function o9(t,e){var n=yr(t),r=t===e?ur(t):nO(n/yr(e))/nO(yO(e)/yO(t)),o=n*o6(yO(t),r)/r;if(!r)return Ky;function c(l,u){o>0?u<-Ui+nr&&(u=-Ui+nr):u>Ui-nr&&(u=Ui-nr);var d=o/o6(yO(u),r);return[d*ur(r*l),o-d*yr(r*l)]}return c.invert=function(l,u){var d=o-u,h=Qa(r)*ua(l*l+d*d),g=cl(l,Wr(d))*Qa(d);return d*r<0&&(g-=Or*Qa(l)*Qa(d)),[g/r,2*x0(o6(o/h,1/r))-Ui]},c}function zW(){return C6(o9).scale(109.5).parallels([30,30])}function Qy(t,e){return[t,e]}Qy.invert=Qy;function UW(){return lc(Qy).scale(152.63)}function a9(t,e){var n=yr(t),r=t===e?ur(t):(n-yr(e))/(e-t),o=n/r+t;if(Wr(r)<nr)return Qy;function c(l,u){var d=o-u,h=r*l;return[d*ur(h),o-d*yr(h)]}return c.invert=function(l,u){var d=o-u,h=cl(l,Wr(d))*Qa(d);return d*r<0&&(h-=Or*Qa(l)*Qa(d)),[h/r,o-Qa(r)*ua(l*l+d*d)]},c}function ZW(){return C6(a9).scale(131.154).center([0,13.9389])}var Jy=1.340264,t1=-.081106,e1=893e-6,n1=.003796,_O=ua(3)/2,HW=12;function I6(t,e){var n=Ja(_O*ur(e)),r=n*n,o=r*r*r;return[t*yr(n)/(_O*(Jy+3*t1*r+o*(7*e1+9*n1*r))),n*(Jy+t1*r+o*(e1+n1*r))]}I6.invert=function(t,e){for(var n=e,r=n*n,o=r*r*r,c=0,l,u,d;c<HW&&(u=n*(Jy+t1*r+o*(e1+n1*r))-e,d=Jy+3*t1*r+o*(7*e1+9*n1*r),n-=l=u/d,r=n*n,o=r*r*r,!(Wr(l)<dN));++c);return[_O*t*(Jy+3*t1*r+o*(7*e1+9*n1*r))/yr(n),Ja(ur(n)/_O)]};function WW(){return lc(I6).scale(177.158)}function R6(t,e){var n=yr(e),r=yr(t)*n;return[n*ur(t)/r,ur(e)/r]}R6.invert=qy(x0);function VW(){return lc(R6).scale(144.049).clipAngle(60)}function GW(){var t=1,e=0,n=0,r=1,o=1,c=0,l,u,d=null,h,g,v,m=1,_=1,b=Xy({point:function(P,R){var k=M([P,R]);this.stream.point(k[0],k[1])}}),S=Zy,w,E;function T(){return m=t*r,_=t*o,w=E=null,M}function M(P){var R=P[0]*m,k=P[1]*_;if(c){var F=k*l-R*u;R=R*l+k*u,k=F}return[R+e,k+n]}return M.invert=function(P){var R=P[0]-e,k=P[1]-n;if(c){var F=k*l+R*u;R=R*l-k*u,k=F}return[R/m,k/_]},M.stream=function(P){return w&&E===P?w:w=b(S(E=P))},M.postclip=function(P){return arguments.length?(S=P,d=h=g=v=null,T()):S},M.clipExtent=function(P){return arguments.length?(S=P==null?(d=h=g=v=null,Zy):$N(d=+P[0][0],h=+P[0][1],g=+P[1][0],v=+P[1][1]),T()):d==null?null:[[d,h],[g,v]]},M.scale=function(P){return arguments.length?(t=+P,T()):t},M.translate=function(P){return arguments.length?(e=+P[0],n=+P[1],T()):[e,n]},M.angle=function(P){return arguments.length?(c=P%360*Ni,u=ur(c),l=yr(c),T()):c*ko},M.reflectX=function(P){return arguments.length?(r=P?-1:1,T()):r<0},M.reflectY=function(P){return arguments.length?(o=P?-1:1,T()):o<0},M.fitExtent=function(P,R){return vO(M,P,R)},M.fitSize=function(P,R){return E6(M,P,R)},M.fitWidth=function(P,R){return A6(M,P,R)},M.fitHeight=function(P,R){return T6(M,P,R)},M}function k6(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),e*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}k6.invert=function(t,e){var n=e,r=25,o;do{var c=n*n,l=c*c;n-=o=(n*(1.007226+c*(.015085+l*(-.044475+.028874*c-.005916*l)))-e)/(1.007226+c*(.015085*3+l*(-.044475*7+.028874*9*c-.005916*11*l)))}while(Wr(o)>nr&&--r>0);return[t/(.8707+(c=n*n)*(-.131979+c*(-.013791+c*c*c*(.003971-.001529*c)))),n]};function $W(){return lc(k6).scale(175.295)}function D6(t,e){return[yr(e)*ur(t),ur(e)]}D6.invert=qy(Ja);function YW(){return lc(D6).scale(249.5).clipAngle(90+nr)}function N6(t,e){var n=yr(e),r=1+yr(t)*n;return[n*ur(t)/r,ur(e)/r]}N6.invert=qy(function(t){return 2*x0(t)});function XW(){return lc(N6).scale(250).clipAngle(142)}function F6(t,e){return[nO(a6((Ui+e)/2)),-t]}F6.invert=function(t,e){return[-e,2*x0(pN(t))-Ui]};function qW(){var t=i9(F6),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):(r=e(),[r[1],-r[0]])},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var KW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function QW(t){if(typeof t=="function")return t;const e=`geo${Ls(t)}`,n=tt[e];if(!n)throw new Error(`Unknown coordinate: ${t}`);return n}function JW(t){return{type:"FeatureCollection",features:t.flatMap(e=>tV(e).features)}}function tV(t){const e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!t||!t.type)return null;const n=e[t.type];if(!n)return null;if(n==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if(n==="feature")return{type:"FeatureCollection",features:[t]};if(n==="featureCollection")return t}function eV(t,e){var n;for(const[r,o]of Object.entries(e))(n=t[r])===null||n===void 0||n.call(t,o)}function nV(t,e,n,r){const o=()=>{const u=e.filter(s9);return u.find(h=>h.sphere)?{type:"Sphere"}:JW(u.filter(h=>!h.sphere).flatMap(h=>h.data.value))},{outline:c=o()}=r,{size:l="fitExtent"}=r;if(l==="fitExtent")return rV(t,c,n);if(l==="fitWidth")return iV(t,c,n)}function rV(t,e,n){const{x:r,y:o,width:c,height:l}=n;t.fitExtent([[r,o],[c,l]],e)}function iV(t,e,n){const{width:r,height:o}=n,[[c,l],[u,d]]=NN(t.fitWidth(r,e)).bounds(e),h=Math.ceil(d-l),g=Math.min(Math.ceil(u-c),h),v=t.scale()*(g-1)/g,[m,_]=t.translate(),b=_+(o-h)/2;t.scale(v).translate([m,b]).precision(.2)}function oV(t){const{data:e}=t;if(Array.isArray(e))return Object.assign(Object.assign({},t),{data:{value:e}});const{type:n}=e;return n==="graticule10"?Object.assign(Object.assign({},t),{data:{value:[mW()]}}):n==="sphere"?Object.assign(Object.assign({},t),{sphere:!0,data:{value:[{type:"Sphere"}]}}):t}function s9(t){return t.type==="geoPath"}const c9=()=>t=>{const{children:e,coordinate:n={}}=t;if(!Array.isArray(e))return[];const{type:r="equalEarth"}=n,o=KW(n,["type"]),c=QW(r),l=e.map(v=>Object.assign(Object.assign({},v),{data:mf(v.data,t.data)})).map(oV);let u;function d(){return[["custom",(v,m,_,b)=>{const S=c();nV(S,l,{x:v,y:m,width:_,height:b},o),eV(S,o),u=NN(S);const E=new ga({domain:[v,v+_]}),T=new ga({domain:[m,m+b]}),M=R=>{const k=S(R);if(!k)return[null,null];const[F,W]=k;return[E.map(F),T.map(W)]},P=R=>{if(!R)return null;const[k,F]=R,W=[E.invert(k),T.invert(F)];return S.invert(W)};return{transform:R=>M(R),untransform:R=>P(R)}}]]}function h(v){const{style:m,tooltip:_={}}=v;return Object.assign(Object.assign({},v),{type:"path",tooltip:nl(_,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},m),{d:b=>u(b)||[]})})}const g=v=>s9(v)?h(v):v;return[Object.assign(Object.assign({},t),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:d},children:l.flatMap(g)})]};c9.props={};var aV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const l9=()=>t=>{const{type:e,data:n,scale:r,encode:o,style:c,animate:l,key:u,state:d,tooltip:h}=t,g=aV(t,["type","data","scale","encode","style","animate","key","state","tooltip"]);return[Object.assign(Object.assign({type:"geoView"},g),{children:[{type:"geoPath",key:`${u}-0`,data:{value:n},scale:r,encode:o,style:c,animate:l,state:d,tooltip:h}]})]};l9.props={};function sV(){return{"composition.geoView":c9,"composition.geoPath":l9}}function cV(){var t,e,n,r,o=Xo(-30),c,l=1,u=1/0,d=.81;function h(_){var b,S=t.length,w=nL(t,PF,LF).visitAfter(v);for(r=_,b=0;b<S;++b)e=t[b],w.visit(m)}function g(){if(t){var _,b=t.length,S;for(c=new Array(b),_=0;_<b;++_)S=t[_],c[S.index]=+o(S,_,t)}}function v(_){var b=0,S,w,E=0,T,M,P;if(_.length){for(T=M=P=0;P<4;++P)(S=_[P])&&(w=Math.abs(S.value))&&(b+=S.value,E+=w,T+=w*S.x,M+=w*S.y);_.x=T/E,_.y=M/E}else{S=_,S.x=S.data.x,S.y=S.data.y;do b+=c[S.data.index];while(S=S.next)}_.value=b}function m(_,b,S,w){if(!_.value)return!0;var E=_.x-e.x,T=_.y-e.y,M=w-b,P=E*E+T*T;if(M*M/d<P)return P<u&&(E===0&&(E=Mu(n),P+=E*E),T===0&&(T=Mu(n),P+=T*T),P<l&&(P=Math.sqrt(l*P)),e.vx+=E*_.value*r/P,e.vy+=T*_.value*r/P),!0;if(_.length||P>=u)return;(_.data!==e||_.next)&&(E===0&&(E=Mu(n),P+=E*E),T===0&&(T=Mu(n),P+=T*T),P<l&&(P=Math.sqrt(l*P)));do _.data!==e&&(M=c[_.data.index]*r/P,e.vx+=E*M,e.vy+=T*M);while(_=_.next)}return h.initialize=function(_,b){t=_,n=b,g()},h.strength=function(_){return arguments.length?(o=typeof _=="function"?_:Xo(+_),g(),h):o},h.distanceMin=function(_){return arguments.length?(l=_*_,h):Math.sqrt(l)},h.distanceMax=function(_){return arguments.length?(u=_*_,h):Math.sqrt(u)},h.theta=function(_){return arguments.length?(d=_*_,h):Math.sqrt(d)},h}function lV(t){return t.index}function u9(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function uV(t){var e=lV,n=v,r,o=Xo(30),c,l,u,d,h,g=1;t==null&&(t=[]);function v(w){return 1/Math.min(u[w.source.index],u[w.target.index])}function m(w){for(var E=0,T=t.length;E<g;++E)for(var M=0,P,R,k,F,W,$,rt;M<T;++M)P=t[M],R=P.source,k=P.target,F=k.x+k.vx-R.x-R.vx||Mu(h),W=k.y+k.vy-R.y-R.vy||Mu(h),$=Math.sqrt(F*F+W*W),$=($-c[M])/$*w*r[M],F*=$,W*=$,k.vx-=F*(rt=d[M]),k.vy-=W*rt,R.vx+=F*(rt=1-rt),R.vy+=W*rt}function _(){if(l){var w,E=l.length,T=t.length,M=new Map(l.map((R,k)=>[e(R,k,l),R])),P;for(w=0,u=new Array(E);w<T;++w)P=t[w],P.index=w,typeof P.source!="object"&&(P.source=u9(M,P.source)),typeof P.target!="object"&&(P.target=u9(M,P.target)),u[P.source.index]=(u[P.source.index]||0)+1,u[P.target.index]=(u[P.target.index]||0)+1;for(w=0,d=new Array(T);w<T;++w)P=t[w],d[w]=u[P.source.index]/(u[P.source.index]+u[P.target.index]);r=new Array(T),b(),c=new Array(T),S()}}function b(){if(l)for(var w=0,E=t.length;w<E;++w)r[w]=+n(t[w],w,t)}function S(){if(l)for(var w=0,E=t.length;w<E;++w)c[w]=+o(t[w],w,t)}return m.initialize=function(w,E){l=w,h=E,_()},m.links=function(w){return arguments.length?(t=w,_(),m):t},m.id=function(w){return arguments.length?(e=w,m):e},m.iterations=function(w){return arguments.length?(g=+w,m):g},m.strength=function(w){return arguments.length?(n=typeof w=="function"?w:Xo(+w),b(),m):n},m.distance=function(w){return arguments.length?(o=typeof w=="function"?w:Xo(+w),S(),m):o},m}function fV(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function o(){var c,l=n.length,u,d=0,h=0;for(c=0;c<l;++c)u=n[c],d+=u.x,h+=u.y;for(d=(d/l-t)*r,h=(h/l-e)*r,c=0;c<l;++c)u=n[c],u.x-=d,u.y-=h}return o.initialize=function(c){n=c},o.x=function(c){return arguments.length?(t=+c,o):t},o.y=function(c){return arguments.length?(e=+c,o):e},o.strength=function(c){return arguments.length?(r=+c,o):r},o}var dV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const hV={joint:!0},pV={type:"link",axis:!1,legend:!1,encode:{x:[t=>t.source.x,t=>t.target.x],y:[t=>t.source.y,t=>t.target.y]},style:{stroke:"#999",strokeOpacity:.6}},gV={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},vV={text:""};function mV(t,e,n){const{nodes:r,links:o}=t,{joint:c,nodeStrength:l,linkStrength:u}=e,{nodeKey:d=b=>b.id,linkKey:h=b=>b.id}=n,g=cV(),v=uV(o).id(ba(h));typeof l=="function"&&g.strength(l),typeof u=="function"&&v.strength(u);const m=E8(r).force("link",v).force("charge",g);c?m.force("center",fV()):m.force("x",M8()).force("y",C8()),m.stop();const _=Math.ceil(Math.log(m.alphaMin())/Math.log(1-m.alphaDecay()));for(let b=0;b<_;b++)m.tick();return{nodesData:r,linksData:o}}const f9=t=>{const{data:e,encode:n={},scale:r,style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={}}=t,{nodeKey:g=k=>k.id,linkKey:v=k=>k.id}=n,m=dV(n,["nodeKey","linkKey"]),_=Object.assign({nodeKey:g,linkKey:v},m),b=wn(_,"node"),S=wn(_,"link"),{links:w,nodes:E}=Vm(e,_),{nodesData:T,linksData:M}=mV({links:w,nodes:E},nn({},hV,c),_),P=Wa(h,"link",{items:[k=>({name:"source",value:ba(v)(k.source)}),k=>({name:"target",value:ba(v)(k.target)})]}),R=Wa(h,"node",{items:[k=>({name:"key",value:ba(g)(k)})]},!0);return[nn({},pV,{data:M,encode:S,labels:u,style:wn(o,"link"),tooltip:P,animate:bs(d,"link")}),nn({},gV,{data:T,encode:Object.assign({},b),scale:r,style:wn(o,"node"),tooltip:R,labels:[Object.assign(Object.assign({},vV),wn(o,"label")),...l],animate:bs(d,"link")})]};f9.props={};function yV(t,e){return t.parent===e.parent?1:2}function B6(t){var e=t.children;return e?e[0]:t.t}function j6(t){var e=t.children;return e?e[e.length-1]:t.t}function _V(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function bV(t){for(var e=0,n=0,r=t.children,o=r.length,c;--o>=0;)c=r[o],c.z+=e,c.m+=e,e+=c.s+(n+=c.c)}function xV(t,e,n){return t.a.parent===e.parent?t.a:n}function bO(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}bO.prototype=Object.create(gu.prototype);function SV(t){for(var e=new bO(t,0),n,r=[e],o,c,l,u;n=r.pop();)if(c=n._.children)for(n.children=new Array(u=c.length),l=u-1;l>=0;--l)r.push(o=n.children[l]=new bO(c[l],l)),o.parent=n;return(e.parent=new bO(null,0)).children=[e],e}function wV(){var t=yV,e=1,n=1,r=null;function o(h){var g=SV(h);if(g.eachAfter(c),g.parent.m=-g.z,g.eachBefore(l),r)h.eachBefore(d);else{var v=h,m=h,_=h;h.eachBefore(function(T){T.x<v.x&&(v=T),T.x>m.x&&(m=T),T.depth>_.depth&&(_=T)});var b=v===m?1:t(v,m)/2,S=b-v.x,w=e/(m.x+b+S),E=n/(_.depth||1);h.eachBefore(function(T){T.x=(T.x+S)*w,T.y=T.depth*E})}return h}function c(h){var g=h.children,v=h.parent.children,m=h.i?v[h.i-1]:null;if(g){bV(h);var _=(g[0].z+g[g.length-1].z)/2;m?(h.z=m.z+t(h._,m._),h.m=h.z-_):h.z=_}else m&&(h.z=m.z+t(h._,m._));h.parent.A=u(h,m,h.parent.A||v[0])}function l(h){h._.x=h.z+h.parent.m,h.m+=h.parent.m}function u(h,g,v){if(g){for(var m=h,_=h,b=g,S=m.parent.children[0],w=m.m,E=_.m,T=b.m,M=S.m,P;b=j6(b),m=B6(m),b&&m;)S=B6(S),_=j6(_),_.a=h,P=b.z+T-m.z-w+t(b._,m._),P>0&&(_V(xV(b,h,v),h,P),w+=P,E+=P),T+=b.m,w+=m.m,M+=S.m,E+=_.m;b&&!j6(_)&&(_.t=b,_.m+=T-E),m&&!B6(S)&&(S.t=m,S.m+=w-M,v=h)}return v}function d(h){h.x*=e,h.y=h.depth*n}return o.separation=function(h){return arguments.length?(t=h,o):t},o.size=function(h){return arguments.length?(r=!1,e=+h[0],n=+h[1],o):r?null:[e,n]},o.nodeSize=function(h){return arguments.length?(r=!0,e=+h[0],n=+h[1],o):r?[e,n]:null},o}function OV(t,e){return t.parent===e.parent?1:2}function EV(t){return t.reduce(AV,0)/t.length}function AV(t,e){return t+e.x}function TV(t){return 1+t.reduce(MV,0)}function MV(t,e){return Math.max(t,e.y)}function CV(t){for(var e;e=t.children;)t=e[0];return t}function PV(t){for(var e;e=t.children;)t=e[e.length-1];return t}function LV(){var t=OV,e=1,n=1,r=!1;function o(c){var l,u=0;c.eachAfter(function(m){var _=m.children;_?(m.x=EV(_),m.y=TV(_)):(m.x=l?u+=t(m,l):0,m.y=0,l=m)});var d=CV(c),h=PV(c),g=d.x-t(d,h)/2,v=h.x+t(h,d)/2;return c.eachAfter(r?function(m){m.x=(m.x-c.x)*e,m.y=(c.y-m.y)*n}:function(m){m.x=(m.x-g)/(v-g)*e,m.y=(1-(c.y?m.y/c.y:1))*n})}return o.separation=function(c){return arguments.length?(t=c,o):t},o.size=function(c){return arguments.length?(r=!1,e=+c[0],n=+c[1],o):r?null:[e,n]},o.nodeSize=function(c){return arguments.length?(r=!0,e=+c[0],n=+c[1],o):r?[e,n]:null},o}const d9=t=>e=>n=>{const{field:r="value",nodeSize:o,separation:c,sortBy:l,as:u=["x","y"]}=e,[d,h]=u,g=pu(n,b=>b.children).sum(b=>b[r]).sort(l),v=t();v.size([1,1]),o&&v.nodeSize(o),c&&v.separation(c),v(g);const m=[];g.each(b=>{b[d]=b.x,b[h]=b.y,b.name=b.data.name,m.push(b)});const _=g.links();return _.forEach(b=>{b[d]=[b.source[d],b.target[d]],b[h]=[b.source[h],b.target[h]]}),{nodes:m,edges:_}},h9=t=>d9(LV)(t);h9.props={};const p9=t=>d9(wV)(t);p9.props={};const IV={sortBy:(t,e)=>e.value-t.value},RV={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},kV={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},DV={text:"",fontSize:10},g9=t=>{const{data:e,encode:n={},scale:r={},style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={}}=t,g=n==null?void 0:n.value,{nodes:v,edges:m}=p9(Object.assign(Object.assign(Object.assign({},IV),c),{field:g}))(e),_=Wa(h,"node",{title:"name",items:["value"]},!0),b=Wa(h,"link",{title:"",items:[S=>({name:"source",value:S.source.name}),S=>({name:"target",value:S.target.name})]});return[nn({},kV,{data:m,encode:wn(n,"link"),scale:wn(r,"link"),labels:u,style:Object.assign({stroke:"#999"},wn(o,"link")),tooltip:b,animate:bs(d,"link")}),nn({},RV,{data:v,scale:wn(r,"node"),encode:wn(n,"node"),labels:[Object.assign(Object.assign({},DV),wn(o,"label")),...l],style:Object.assign({},wn(o,"node")),tooltip:_,animate:bs(d,"node")})]};g9.props={};var NV=1664525,FV=1013904223,v9=4294967296;function BV(){var t=1;return function(){return(t=(NV*t+FV)%v9)/v9}}var jV=L(52677);function zV(t){return jV(t)==="object"&&"length"in t?t:Array.from(t)}function UV(t,e){for(var n=t.length,r,o;n;)o=e()*n--|0,r=t[n],t[n]=t[o],t[o]=r;return t}function mq(t){return m9(t,lcg())}function m9(t,e){for(var n=0,r=(t=UV(Array.from(t),e)).length,o=[],c,l;n<r;)c=t[n],l&&y9(l,c)?++n:(l=HV(o=ZV(o,c)),n=0);return l}function ZV(t,e){var n,r;if(z6(e,t))return[e];for(n=0;n<t.length;++n)if(xO(e,t[n])&&z6(r1(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(xO(r1(t[n],t[r]),e)&&xO(r1(t[n],e),t[r])&&xO(r1(t[r],e),t[n])&&z6(_9(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function xO(t,e){var n=t.r-e.r,r=e.x-t.x,o=e.y-t.y;return n<0||n*n<r*r+o*o}function y9(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,o=e.y-t.y;return n>0&&n*n>r*r+o*o}function z6(t,e){for(var n=0;n<e.length;++n)if(!y9(t,e[n]))return!1;return!0}function HV(t){switch(t.length){case 1:return WV(t[0]);case 2:return r1(t[0],t[1]);case 3:return _9(t[0],t[1],t[2])}}function WV(t){return{x:t.x,y:t.y,r:t.r}}function r1(t,e){var n=t.x,r=t.y,o=t.r,c=e.x,l=e.y,u=e.r,d=c-n,h=l-r,g=u-o,v=Math.sqrt(d*d+h*h);return{x:(n+c+d/v*g)/2,y:(r+l+h/v*g)/2,r:(v+o+u)/2}}function _9(t,e,n){var r=t.x,o=t.y,c=t.r,l=e.x,u=e.y,d=e.r,h=n.x,g=n.y,v=n.r,m=r-l,_=r-h,b=o-u,S=o-g,w=d-c,E=v-c,T=r*r+o*o-c*c,M=T-l*l-u*u+d*d,P=T-h*h-g*g+v*v,R=_*b-m*S,k=(b*P-S*M)/(R*2)-r,F=(S*w-b*E)/R,W=(_*M-m*P)/(R*2)-o,$=(m*E-_*w)/R,rt=F*F+$*$-1,et=2*(c+k*F+W*$),ut=k*k+W*W-c*c,J=-(Math.abs(rt)>1e-6?(et+Math.sqrt(et*et-4*rt*ut))/(2*rt):ut/et);return{x:r+k+F*J,y:o+W+$*J,r:J}}function b9(t,e,n){var r=t.x-e.x,o,c,l=t.y-e.y,u,d,h=r*r+l*l;h?(c=e.r+n.r,c*=c,d=t.r+n.r,d*=d,c>d?(o=(h+d-c)/(2*h),u=Math.sqrt(Math.max(0,d/h-o*o)),n.x=t.x-o*r-u*l,n.y=t.y-o*l+u*r):(o=(h+c-d)/(2*h),u=Math.sqrt(Math.max(0,c/h-o*o)),n.x=e.x+o*r-u*l,n.y=e.y+o*l+u*r)):(n.x=e.x+n.r,n.y=e.y)}function x9(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,o=e.y-t.y;return n>0&&n*n>r*r+o*o}function S9(t){var e=t._,n=t.next._,r=e.r+n.r,o=(e.x*n.r+n.x*e.r)/r,c=(e.y*n.r+n.y*e.r)/r;return o*o+c*c}function SO(t){this._=t,this.next=null,this.previous=null}function w9(t,e){if(!(c=(t=zV(t)).length))return 0;var n,r,o,c,l,u,d,h,g,v,m;if(n=t[0],n.x=0,n.y=0,!(c>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(c>2))return n.r+r.r;b9(r,n,o=t[2]),n=new SO(n),r=new SO(r),o=new SO(o),n.next=o.previous=r,r.next=n.previous=o,o.next=r.previous=n;t:for(d=3;d<c;++d){b9(n._,r._,o=t[d]),o=new SO(o),h=r.next,g=n.previous,v=r._.r,m=n._.r;do if(v<=m){if(x9(h._,o._)){r=h,n.next=r,r.previous=n,--d;continue t}v+=h._.r,h=h.next}else{if(x9(g._,o._)){n=g,n.next=r,r.previous=n,--d;continue t}m+=g._.r,g=g.previous}while(h!==g.next);for(o.previous=n,o.next=r,n.next=r.previous=r=o,l=S9(n);(o=o.next)!==r;)(u=S9(o))<l&&(n=o,l=u);r=n.next}for(n=[r._],o=r;(o=o.next)!==r;)n.push(o._);for(o=m9(n,e),d=0;d<c;++d)n=t[d],n.x-=o.x,n.y-=o.y;return o.r}function yq(t){return w9(t,lcg()),t}function VV(t){return Math.sqrt(t.value)}function GV(){var t=null,e=1,n=1,r=xd;function o(c){var l=BV();return c.x=e/2,c.y=n/2,t?c.eachBefore(O9(t)).eachAfter(U6(r,.5,l)).eachBefore(E9(1)):c.eachBefore(O9(VV)).eachAfter(U6(xd,1,l)).eachAfter(U6(r,c.r/Math.min(e,n),l)).eachBefore(E9(Math.min(e,n)/(2*c.r))),c}return o.radius=function(c){return arguments.length?(t=Zw(c),o):t},o.size=function(c){return arguments.length?(e=+c[0],n=+c[1],o):[e,n]},o.padding=function(c){return arguments.length?(r=typeof c=="function"?c:y0(+c),o):r},o}function O9(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function U6(t,e,n){return function(r){if(o=r.children){var o,c,l=o.length,u=t(r)*e||0,d;if(u)for(c=0;c<l;++c)o[c].r+=u;if(d=w9(o,n),u)for(c=0;c<l;++c)o[c].r-=u;r.r=d+u}}}function E9(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var $V=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const YV=(t,e)=>({size:[t,e],padding:0,sort:(n,r)=>r.value-n.value}),XV=(t,e,n)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,t]},y:{domain:[0,e]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:n.color?void 0:r=>r.height===0?"#ddd":"#fff",stroke:n.color?void 0:r=>r.height===0?"":"#000"}}),qV={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.r*2},KV={title:t=>t.data.name,items:[{field:"value"}]},QV=(t,e,n)=>{const{value:r}=n,o=(0,Br.Z)(t)?NL().path(e.path)(t):pu(t);return r?o.sum(c=>ba(r)(c)).sort(e.sort):o.count(),GV().size(e.size).padding(e.padding)(o),o.descendants()},A9=(t,e)=>{const{width:n,height:r}=e,{data:o,encode:c={},scale:l={},style:u={},layout:d={},labels:h=[],tooltip:g={}}=t,v=$V(t,["data","encode","scale","style","layout","labels","tooltip"]),m=XV(n,r,c),_=QV(o,nn({},YV(n,r),d),nn({},m.encode,c)),b=wn(u,"label");return nn({},m,Object.assign(Object.assign({data:_,encode:c,scale:l,style:u,labels:[Object.assign(Object.assign({},qV),b),...h]},v),{tooltip:nl(g,KV),axis:!1}))};A9.props={};function JV(t){return t.target.depth}function tG(t){return t.depth}function eG(t,e){return e-1-t.height}function wO(t,e){return t.sourceLinks.length?t.depth:e-1}function nG(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Ho(t.sourceLinks,JV)-1:0}function OO(t){return function(){return t}}function T9(t,e){return EO(t.source,e.source)||t.index-e.index}function M9(t,e){return EO(t.target,e.target)||t.index-e.index}function EO(t,e){return t.y0-e.y0}function Z6(t){return t.value}function rG(t){return t.index}function iG(t){return t.nodes}function oG(t){return t.links}function C9(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function P9({nodes:t}){for(const e of t){let n=e.y0,r=n;for(const o of e.sourceLinks)o.y0=n+o.width/2,n+=o.width;for(const o of e.targetLinks)o.y1=r+o.width/2,r+=o.width}}function aG(){let t=0,e=0,n=1,r=1,o=24,c=8,l,u=rG,d=wO,h,g,v,m=iG,_=oG,b=6;function S(xt){const Ht={nodes:m(xt),links:_(xt)};return w(Ht),E(Ht),T(Ht),M(Ht),k(Ht),P9(Ht),Ht}S.update=function(xt){return P9(xt),xt},S.nodeId=function(xt){return arguments.length?(u=typeof xt=="function"?xt:OO(xt),S):u},S.nodeAlign=function(xt){return arguments.length?(d=typeof xt=="function"?xt:OO(xt),S):d},S.nodeDepth=function(xt){return arguments.length?(h=xt,S):h},S.nodeSort=function(xt){return arguments.length?(g=xt,S):g},S.nodeWidth=function(xt){return arguments.length?(o=+xt,S):o},S.nodePadding=function(xt){return arguments.length?(c=l=+xt,S):c},S.nodes=function(xt){return arguments.length?(m=typeof xt=="function"?xt:OO(xt),S):m},S.links=function(xt){return arguments.length?(_=typeof xt=="function"?xt:OO(xt),S):_},S.linkSort=function(xt){return arguments.length?(v=xt,S):v},S.size=function(xt){return arguments.length?(t=e=0,n=+xt[0],r=+xt[1],S):[n-t,r-e]},S.extent=function(xt){return arguments.length?(t=+xt[0][0],n=+xt[1][0],e=+xt[0][1],r=+xt[1][1],S):[[t,e],[n,r]]},S.iterations=function(xt){return arguments.length?(b=+xt,S):b};function w({nodes:xt,links:Ht}){xt.forEach((wt,Wt)=>{wt.index=Wt,wt.sourceLinks=[],wt.targetLinks=[]});const gt=new Map(xt.map(wt=>[u(wt),wt]));if(Ht.forEach((wt,Wt)=>{wt.index=Wt;let{source:fe,target:le}=wt;typeof fe!="object"&&(fe=wt.source=C9(gt,fe)),typeof le!="object"&&(le=wt.target=C9(gt,le)),fe.sourceLinks.push(wt),le.targetLinks.push(wt)}),v!=null)for(const{sourceLinks:wt,targetLinks:Wt}of xt)wt.sort(v),Wt.sort(v)}function E({nodes:xt}){for(const Ht of xt)Ht.value=Ht.fixedValue===void 0?Math.max(Qo(Ht.sourceLinks,Z6),Qo(Ht.targetLinks,Z6)):Ht.fixedValue}function T({nodes:xt}){const Ht=xt.length;let gt=new Set(xt),wt=new Set,Wt=0;for(;gt.size;){if(gt.forEach(fe=>{fe.depth=Wt;for(const{target:le}of fe.sourceLinks)wt.add(le)}),++Wt>Ht)throw new Error("circular link");gt=wt,wt=new Set}if(h){const fe=Math.max(Rr(xt,Te=>Te.depth)+1,0);let le;for(let Te=0;Te<xt.length;Te++)le=xt[Te],le.depth=h.call(null,le,fe)}}function M({nodes:xt}){const Ht=xt.length;let gt=new Set(xt),wt=new Set,Wt=0;for(;gt.size;){if(gt.forEach(fe=>{fe.height=Wt;for(const{source:le}of fe.targetLinks)wt.add(le)}),++Wt>Ht)throw new Error("circular link");gt=wt,wt=new Set}}function P({nodes:xt}){const Ht=Math.max(Rr(xt,Wt=>Wt.depth)+1,0),gt=(n-t-o)/(Ht-1),wt=new Array(Ht).fill(0).map(()=>[]);for(const Wt of xt){const fe=Math.max(0,Math.min(Ht-1,Math.floor(d.call(null,Wt,Ht))));Wt.layer=fe,Wt.x0=t+fe*gt,Wt.x1=Wt.x0+o,wt[fe]?wt[fe].push(Wt):wt[fe]=[Wt]}if(g)for(const Wt of wt)Wt.sort(g);return wt}function R(xt){const Ht=Ho(xt,gt=>(r-e-(gt.length-1)*l)/Qo(gt,Z6));for(const gt of xt){let wt=e;for(const Wt of gt){Wt.y0=wt,Wt.y1=wt+Wt.value*Ht,wt=Wt.y1+l;for(const fe of Wt.sourceLinks)fe.width=fe.value*Ht}wt=(r-wt+l)/(gt.length+1);for(let Wt=0;Wt<gt.length;++Wt){const fe=gt[Wt];fe.y0+=wt*(Wt+1),fe.y1+=wt*(Wt+1)}J(gt)}}function k(xt){const Ht=P(xt);l=Math.min(c,(r-e)/(Rr(Ht,gt=>gt.length)-1)),R(Ht);for(let gt=0;gt<b;++gt){const wt=Math.pow(.99,gt),Wt=Math.max(1-wt,(gt+1)/b);W(Ht,wt,Wt),F(Ht,wt,Wt)}}function F(xt,Ht,gt){for(let wt=1,Wt=xt.length;wt<Wt;++wt){const fe=xt[wt];for(const le of fe){let Te=0,Fe=0;for(const{source:Je,value:qe}of le.targetLinks){const We=qe*(le.layer-Je.layer);Te+=lt(Je,le)*We,Fe+=We}if(!(Fe>0))continue;const De=(Te/Fe-le.y0)*Ht;le.y0+=De,le.y1+=De,ut(le)}g===void 0&&fe.sort(EO),fe.length&&$(fe,gt)}}function W(xt,Ht,gt){for(let wt=xt.length,Wt=wt-2;Wt>=0;--Wt){const fe=xt[Wt];for(const le of fe){let Te=0,Fe=0;for(const{target:Je,value:qe}of le.sourceLinks){const We=qe*(Je.layer-le.layer);Te+=vt(le,Je)*We,Fe+=We}if(!(Fe>0))continue;const De=(Te/Fe-le.y0)*Ht;le.y0+=De,le.y1+=De,ut(le)}g===void 0&&fe.sort(EO),fe.length&&$(fe,gt)}}function $(xt,Ht){const gt=xt.length>>1,wt=xt[gt];et(xt,wt.y0-l,gt-1,Ht),rt(xt,wt.y1+l,gt+1,Ht),et(xt,r,xt.length-1,Ht),rt(xt,e,0,Ht)}function rt(xt,Ht,gt,wt){for(;gt<xt.length;++gt){const Wt=xt[gt],fe=(Ht-Wt.y0)*wt;fe>1e-6&&(Wt.y0+=fe,Wt.y1+=fe),Ht=Wt.y1+l}}function et(xt,Ht,gt,wt){for(;gt>=0;--gt){const Wt=xt[gt],fe=(Wt.y1-Ht)*wt;fe>1e-6&&(Wt.y0-=fe,Wt.y1-=fe),Ht=Wt.y0-l}}function ut({sourceLinks:xt,targetLinks:Ht}){if(v===void 0){for(const{source:{sourceLinks:gt}}of Ht)gt.sort(M9);for(const{target:{targetLinks:gt}}of xt)gt.sort(T9)}}function J(xt){if(v===void 0)for(const{sourceLinks:Ht,targetLinks:gt}of xt)Ht.sort(M9),gt.sort(T9)}function lt(xt,Ht){let gt=xt.y0-(xt.sourceLinks.length-1)*l/2;for(const{target:wt,width:Wt}of xt.sourceLinks){if(wt===Ht)break;gt+=Wt+l}for(const{source:wt,width:Wt}of Ht.targetLinks){if(wt===xt)break;gt-=Wt}return gt}function vt(xt,Ht){let gt=Ht.y0-(Ht.targetLinks.length-1)*l/2;for(const{source:wt,width:Wt}of Ht.targetLinks){if(wt===xt)break;gt+=Wt+l}for(const{target:wt,width:Wt}of xt.sourceLinks){if(wt===Ht)break;gt-=Wt}return gt}return S}const sG={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:t=>t.nodes,links:t=>t.links,nodeSort:void 0,linkSort:void 0,iterations:6},cG={left:tG,right:eG,center:nG,justify:wO};function lG(t){const e=typeof t;return e==="string"?cG[t]||wO:e==="function"?t:wO}const L9=t=>e=>{const{nodeId:n,nodeSort:r,nodeAlign:o,nodeWidth:c,nodePadding:l,nodeDepth:u,nodes:d,links:h,linkSort:g,iterations:v}=Object.assign({},sG,t),m=aG().nodeSort(r).linkSort(g).links(h).nodes(d).nodeWidth(c).nodePadding(l).nodeDepth(u).nodeAlign(lG(o)).iterations(v).extent([[0,0],[1,1]]);typeof n=="function"&&m.nodeId(n);const _=m(e),{nodes:b,links:S}=_,w=b.map(T=>{const{x0:M,x1:P,y0:R,y1:k}=T;return Object.assign(Object.assign({},T),{x:[M,P,P,M],y:[R,R,k,k]})}),E=S.map(T=>{const{source:M,target:P}=T,R=M.x1,k=P.x0,F=T.width/2;return Object.assign(Object.assign({},T),{x:[R,R,k,k],y:[T.y0+F,T.y0-F,T.y1+F,T.y1-F]})});return{nodes:w,links:E}};L9.props={};var uG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const fG={nodeId:t=>t.key,nodeWidth:.02,nodePadding:.02},I9={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},R9={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},dG={textAlign:t=>t.x[0]<.5?"start":"end",position:t=>t.x[0]<.5?"right":"left",fontSize:10},k9=t=>{const{data:e,encode:n={},scale:r,style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={},interaction:g,state:v={},viewStyle:m={}}=t,{links:_,nodes:b}=Vm(e,n);if(!_||_.length===0)return[nn({},I9,{data:[],encode:{},scale:r,style:wn(o,"node"),viewStyle:m,labels:[],tooltip:!1,animate:!1,axis:!1,interaction:g,state:{}}),nn({},R9,{data:[],encode:{},labels:[],style:wn(o,"link"),tooltip:!1,animate:!1,interaction:g,state:{}})];const S=wn(n,"node"),w=wn(n,"link"),{key:E=lt=>lt.key,color:T=E}=S,{links:M,nodes:P}=L9(Object.assign(Object.assign(Object.assign({},fG),{nodeId:ba(E)}),c))({links:_,nodes:b}),R=wn(o,"label"),{text:k=E,spacing:F=5}=R,W=uG(R,["text","spacing"]),$=ba(E),rt=Wa(h,"node",{title:$,items:[{field:"value"}]},!0),et=Wa(h,"link",{title:"",items:[lt=>({name:"source",value:$(lt.source)}),lt=>({name:"target",value:$(lt.target)})]}),[ut,J]=Object.entries(v).reduce((lt,[vt,xt])=>{const Ht=Xd(xt,"node","link"),gt=wn(xt,"node");lt[0][vt]=Object.assign(Object.assign({},Ht),gt);const wt=wn(xt,"link");return lt[1][vt]=Object.assign(Object.assign({},Ht),wt),lt},[{},{}]);return[nn({},I9,{data:P,encode:Object.assign(Object.assign({},S),{color:T}),scale:r,style:wn(o,"node"),viewStyle:m,labels:[Object.assign(Object.assign(Object.assign({},dG),{text:k,dx:lt=>lt.x[0]<.5?F:-F}),W),...l],tooltip:rt,animate:bs(d,"node"),axis:!1,interaction:g,state:ut}),nn({},R9,{data:M,encode:w,labels:u,style:Object.assign({fill:w.color?void 0:"#aaa",lineWidth:0},wn(o,"link")),tooltip:et,animate:bs(d,"link"),interaction:g,state:J})]};k9.props={};function hG(t,e){return e.value-t.value}function pG(t,e){return e.frequency-t.frequency}function gG(t,e){return`${t.id}`.localeCompare(`${e.id}`)}function vG(t,e){return`${t.name}`.localeCompare(`${e.name}`)}const mG={y:0,thickness:.05,weight:!1,marginRatio:.1,id:t=>t.id,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null};function yG(t){const{y:e,thickness:n,weight:r,marginRatio:o,id:c,source:l,target:u,sourceWeight:d,targetWeight:h,sortBy:g}=Object.assign(Object.assign({},mG),t);function v(w){const E=w.nodes.map(M=>Object.assign({},M)),T=w.edges.map(M=>Object.assign({},M));return m(E,T),_(E,T),b(E,T),S(E,T),{nodes:E,edges:T}}function m(w,E){E.forEach(P=>{P.source=l(P),P.target=u(P),P.sourceWeight=d(P),P.targetWeight=h(P)});const T=$r(E,P=>P.source),M=$r(E,P=>P.target);return w.forEach(P=>{P.id=c(P);const R=T.has(P.id)?T.get(P.id):[],k=M.has(P.id)?M.get(P.id):[];P.frequency=R.length+k.length,P.value=Qo(R,F=>F.sourceWeight)+Qo(k,F=>F.targetWeight)}),{nodes:w,edges:E}}function _(w,E){const T=typeof g=="function"?g:yt[g];T&&w.sort(T)}function b(w,E){const T=w.length;if(!T)throw vl("Invalid nodes: it's empty!");if(!r){const R=1/T;return w.forEach((k,F)=>{k.x=(F+.5)*R,k.y=e}),{nodes:w,edges:E}}const M=o/(2*T),P=w.reduce((R,k)=>R+=k.value,0);return w.reduce((R,k)=>{k.weight=k.value/P,k.width=k.weight*(1-o),k.height=n;const F=M+R,W=F+k.width,$=e-n/2,rt=$+n;return k.x=[F,W,W,F],k.y=[$,$,rt,rt],R+k.width+2*M},0),{nodes:w,edges:E}}function S(w,E){const T=new Map(w.map(R=>[R.id,R]));if(!r)return E.forEach(R=>{const k=l(R),F=u(R),W=T.get(k),$=T.get(F);W&&$&&(R.x=[W.x,$.x],R.y=[W.y,$.y])}),{nodes:w,edges:E};E.forEach(R=>{R.x=[0,0,0,0],R.y=[e,e,e,e]});const M=$r(E,R=>R.source),P=$r(E,R=>R.target);w.forEach(R=>{const{edges:k,width:F,x:W,y:$,value:rt,id:et}=R,ut=M.get(et)||[],J=P.get(et)||[];let lt=0;ut.map(vt=>{const xt=vt.sourceWeight/rt*F;vt.x[0]=W[0]+lt,vt.x[1]=W[0]+lt+xt,lt+=xt}),J.forEach(vt=>{const xt=vt.targetWeight/rt*F;vt.x[3]=W[0]+lt,vt.x[2]=W[0]+lt+xt,lt+=xt})})}return v}const H6=t=>e=>yG(t)(e);H6.props={};var D9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const W6={y:0,thickness:.05,marginRatio:.1,id:t=>t.key,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null},_G={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},bG={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},xG={position:"outside",fontSize:10},N9=(t,e)=>{const{data:n,encode:r={},scale:o,style:c={},layout:l={},nodeLabels:u=[],linkLabels:d=[],animate:h={},tooltip:g={}}=t,{nodes:v,links:m}=Vm(n,r),_=wn(r,"node"),b=wn(r,"link"),{key:S=vt=>vt.key,color:w=S}=_,{linkEncodeColor:E=vt=>vt.source}=b,{nodeWidthRatio:T=W6.thickness,nodePaddingRatio:M=W6.marginRatio}=l,P=D9(l,["nodeWidthRatio","nodePaddingRatio"]),{nodes:R,edges:k}=H6(Object.assign(Object.assign(Object.assign(Object.assign({},W6),{id:ba(S),thickness:T,marginRatio:M}),P),{weight:!0}))({nodes:v,edges:m}),F=wn(c,"label"),{text:W=S}=F,$=D9(F,["text"]),rt=Wa(g,"node",{title:"",items:[vt=>({name:vt.key,value:vt.value})]},!0),et=Wa(g,"link",{title:"",items:[vt=>({name:`${vt.source} -> ${vt.target}`,value:vt.value})]}),{height:ut,width:J}=e,lt=Math.min(ut,J);return[nn({},bG,{data:k,encode:Object.assign(Object.assign({},b),{color:E}),labels:d,style:Object.assign({fill:E?void 0:"#aaa"},wn(c,"link")),tooltip:et,animate:bs(h,"link")}),nn({},_G,{data:R,encode:Object.assign(Object.assign({},_),{color:w}),scale:o,style:wn(c,"node"),coordinate:{type:"polar",outerRadius:(lt-20)/lt,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},xG),{text:W}),$),...u],tooltip:rt,animate:bs(h,"node"),axis:!1})]};N9.props={};var SG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const wG=(t,e)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[t,e],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(n,r)=>r.value-n.value,layer:0}),OG=(t,e)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:n=>n.path[1]},scale:{x:{domain:[0,t],range:[0,1]},y:{domain:[0,e],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),EG={fontSize:10,text:t=>Jo(t.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.x1-t.x0,isTreemapLabel:!0},AG={title:t=>{var e,n;return(n=(e=t.path)===null||e===void 0?void 0:e.join)===null||n===void 0?void 0:n.call(e,".")},items:[{field:"value"}]},TG={title:t=>Jo(t.path),items:[{field:"value"}]},F9=(t,e)=>{const{width:n,height:r,options:o}=e,{data:c,encode:l={},scale:u,style:d={},layout:h={},labels:g=[],tooltip:v={}}=t,m=SG(t,["data","encode","scale","style","layout","labels","tooltip"]),_=er(o,["interaction","treemapDrillDown"])||er(o,["marks",0,"interaction","treemapDrillDown"]),b=nn({},wG(n,r),h,{layer:_?T=>T.depth===1:h.layer}),[S,w]=jk(c,b,l),E=wn(d,"label");return nn({},OG(n,r),Object.assign(Object.assign({data:S,scale:u,style:d,labels:[Object.assign(Object.assign(Object.assign({},EG),E),_&&{cursor:"pointer"}),...g]},m),{encode:l,tooltip:nl(v,AG),axis:!1}),_?{interaction:Object.assign(Object.assign({},m.interaction),{treemapDrillDown:_?Object.assign(Object.assign({},_),{originData:w,layout:b}):void 0}),encode:Object.assign({color:T=>Jo(T.path)},l),tooltip:nl(v,TG)}:{})};F9.props={};function MG(){return{"data.arc":H6,"data.cluster":h9,"mark.forceGraph":f9,"mark.tree":g9,"mark.pack":A9,"mark.sankey":k9,"mark.chord":N9,"mark.treemap":F9,"mark.partition":Zk}}var B9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function CG(t,e){return Ho(t,n=>e[n])}function PG(t,e){return Rr(t,n=>e[n])}function j9(t,e){const n=V6(t,e)*2.5-G6(t,e)*1.5;return Ho(t,r=>e[r]>=n?e[r]:NaN)}function V6(t,e){return $w(t,.25,n=>e[n])}function LG(t,e){return $w(t,.5,n=>e[n])}function G6(t,e){return $w(t,.75,n=>e[n])}function z9(t,e){const n=G6(t,e)*2.5-V6(t,e)*1.5;return Rr(t,r=>e[r]<=n?e[r]:NaN)}function IG(){return(t,e)=>{const{encode:n}=e,{y:r,x:o}=n,{value:c}=r,{value:l}=o;return[Array.from($r(t,h=>l[+h]).values()).flatMap(h=>{const g=j9(h,c),v=z9(h,c);return h.filter(m=>c[m]<g||c[m]>v)}),e]}}const U9=t=>{const{data:e,encode:n,style:r={},tooltip:o={},transform:c,animate:l}=t,u=B9(t,["data","encode","style","tooltip","transform","animate"]),{point:d=!0}=r,h=B9(r,["point"]),{y:g}=n,v={y:g,y1:g,y2:g,y3:g,y4:g},m={y1:V6,y2:LG,y3:G6},_=Wa(o,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),b=Wa(o,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!d)return Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:CG},m),{y4:PG})],encode:Object.assign(Object.assign({},n),v),style:h,tooltip:_},u);const S=wn(h,"box"),w=wn(h,"point");return[Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:j9},m),{y4:z9})],encode:Object.assign(Object.assign({},n),v),style:S,tooltip:_,animate:bs(l,"box")},u),{type:"point",data:e,transform:[{type:IG}],encode:n,style:Object.assign({},w),tooltip:b,animate:bs(l,"point")}]};U9.props={};const Z9=(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))/2,RG=(t,e,n)=>{const r=Math.atan2(t[1]-n[1],t[0]-n[0]);let c=Math.atan2(e[1]-n[1],e[0]-n[0])-r;return c<0&&(c+=Math.PI*2),c},kG=(t,e)=>{if(!e)return;const{coordinate:n}=e;if(!(n!=null&&n.getCenter))return;const r=n.getCenter();return(o,c,l)=>{const{document:u}=e.canvas,{color:d,index:h}=c,g=u.createElement("g",{}),v=Z9(o[0],o[1]),m=Z9(o[0],r)*2,_=RG(o[3],o[0],r)>Math.PI,b=u.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...o[0]],["A",v,v,0,1,0,...o[1]],["A",m+v*2,m+v*2,0,_?1:0,0,...o[2]],["A",v,v,0,1,h===0?0:1,...o[3]],["A",m,m,0,_?1:0,1,...o[0]],["Z"]]},l),Xg(t,["shape","last","first"])),{fill:d||l.color})});return g.appendChild(b),g}};var i1=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const DG=(t,e)=>{const{shape:n,radius:r}=t,o=i1(t,["shape","radius"]),c=wn(o,"pointer"),l=wn(o,"pin"),{shape:u}=c,d=i1(c,["shape"]),{shape:h}=l,g=i1(l,["shape"]),{coordinate:v,theme:m}=e;return(_,b)=>{const S=_.map(lt=>v.invert(lt)),[w,E,T]=L_(v,"polar"),M=v.clone(),{color:P}=b,R=pg({startAngle:w,endAngle:E,innerRadius:T,outerRadius:r});R.push(["cartesian"]),M.update({transformations:R});const k=S.map(lt=>M.map(lt)),[F,W]=_x(k),[$,rt]=v.getCenter(),et=Object.assign(Object.assign({x1:F,y1:W,x2:$,y2:rt,stroke:P},d),o),ut=Object.assign(Object.assign({cx:$,cy:rt,stroke:P},g),o),J=Kn(new N.ZA);return Ca(u)||(typeof u=="function"?J.append(()=>u(k,b,M,m)):J.append("line").call(Zn,et).node()),Ca(h)||(typeof h=="function"?J.append(()=>h(k,b,M,m)):J.append("circle").call(Zn,ut).node()),J.node()}},H9={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},NG={style:{shape:DG,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},FG={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},tooltip:!1};function BG(t){if((0,Se.Z)(t)){const e=Math.max(0,Math.min(t,1));return{percent:e,target:e,total:1}}return t}function jG(t,e){const{name:n="score",target:r,total:o,percent:c,thresholds:l=[]}=BG(t),u=c||r,d=c?1:o,h=Object.assign({y:{domain:[0,d]}},e);return l.length?{targetData:[{x:n,y:u,color:"target"}],totalData:l.map((g,v)=>({x:n,y:v>=1?g-l[v-1]:g,color:v})),target:u,total:d,scale:h}:{targetData:[{x:n,y:u,color:"target"}],totalData:[{x:n,y:u,color:"target"},{x:n,y:d-u,color:"total"}],target:u,total:d,scale:h}}function zG(t,{target:e,total:n}){const{content:r}=t;return r?r(e,n):e.toString()}const W9=t=>{const{data:e={},scale:n={},style:r={},animate:o={},transform:c=[]}=t,l=i1(t,["data","scale","style","animate","transform"]),{targetData:u,totalData:d,target:h,total:g,scale:v}=jG(e,n),m=wn(r,"text"),{tooltip:_}=m,b=i1(m,["tooltip"]),S=RE(r,["pointer","pin"]),w=wn(r,"arc"),E=w.shape;return[nn({},H9,Object.assign({type:"interval",transform:[{type:"stackY"}],data:d,scale:v,style:E==="round"?Object.assign(Object.assign({},w),{shape:kG}):w,animate:typeof o=="object"?wn(o,"arc"):o},l)),nn({},H9,NG,Object.assign({type:"point",data:u,scale:v,style:S,animate:typeof o=="object"?wn(o,"indicator"):o},l)),nn({},FG,{style:Object.assign({text:zG(b,{target:h,total:g})},b),tooltip:_,animate:typeof o=="object"?wn(o,"text"):o})]};W9.props={};const V9=5e3;function G9(t,e,n){return t+(e-t)*n}function UG(t,e,n,r){return e===0?[[t+1/2*n/Math.PI/2,r/2],[t+1/2*n/Math.PI,r],[t+n/4,r]]:e===1?[[t+1/2*n/Math.PI/2*(Math.PI-2),r],[t+1/2*n/Math.PI/2*(Math.PI-1),r/2],[t+n/4,0]]:e===2?[[t+1/2*n/Math.PI/2,-r/2],[t+1/2*n/Math.PI,-r],[t+n/4,-r]]:[[t+1/2*n/Math.PI/2*(Math.PI-2),-r],[t+1/2*n/Math.PI/2*(Math.PI-1),-r/2],[t+n/4,0]]}function ZG(t,e,n,r,o,c,l){const u=Math.ceil(2*t/n*4)*4,d=[];let h=r;for(;h<-Math.PI*2;)h+=Math.PI*2;for(;h>0;)h-=Math.PI*2;h=h/Math.PI/2*n;const g=c-t+h-t*2;d.push(["M",g,e]);let v=0;for(let m=0;m<u;++m){const _=m%4,b=UG(m*n/4,_,n,o);d.push(["C",b[0][0]+g,-b[0][1]+e,b[1][0]+g,-b[1][1]+e,b[2][0]+g,-b[2][1]+e]),m===u-1&&(v=b[2][0])}return d.push(["L",v+g,l+t]),d.push(["L",g,l+t]),d.push(["Z"]),d}function HG(t,e,n,r,o,c,l,u,d,h,g){const{fill:v,fillOpacity:m,opacity:_}=o;for(let b=0;b<r;b++){const S=r<=1?1:b/(r-1),w=ZG(u,l+u*n,d,0,u/40,t,e),E=g.createElement("path",{style:{d:w,fill:v,opacity:G9(.2,.9,S)*Number(_||m)}});c.appendChild(E);try{if(h===!1)return;const T=[{transform:"translate(0, 0)"},{transform:`translate(${d*2}, 0)`}];E.animate(T,{duration:G9(.5*V9,V9,S)*2,iterations:1/0})}catch(T){console.warn("off-screen group animate error!")}}}function WG(t,e,n){return`
      M ${t} ${e-n} 
      a ${n} ${n} 0 1 0 0 ${n*2}
      a ${n} ${n} 0 1 0 0 ${-n*2}
      Z
    `}function VG(t,e,n){const o=n*.618;return`
      M ${t-o} ${e-n}
      L ${t+o} ${e-n}
      L ${t+o} ${e+n}
      L ${t-o} ${e+n}
      Z
    `}function GG(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e}
      L ${t} ${e+n}
      L ${t-n} ${e}
      Z
    `}function $G(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e+n}
      L ${t-n} ${e+n}
      Z
    `}function YG(t,e,n){const r=n*4/3,o=Math.max(r,n*2),c=r/2,l=t,u=c+e-o/2,d=Math.asin(c/((o-c)*.85)),h=Math.sin(d)*c,g=Math.cos(d)*c,v=l-g,m=u+h,_=t,b=u+c/Math.sin(d);return`
      M ${v} ${m}
      A ${c} ${c} 0 1 1 ${v+g*2} ${m}
      Q ${_} ${b} ${t} ${e+o/2}
      Q ${_} ${b} ${v} ${m}
      Z 
    `}const $9={pin:YG,rect:VG,circle:WG,diamond:GG,triangle:$G};var Y9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const XG=(t="circle")=>$9[t]||$9.circle,X9=(t,e)=>{if(!e)return;const{coordinate:n}=e,{liquidOptions:r,styleOptions:o}=t,{liquidShape:c,percent:l}=r,{background:u,outline:d={},wave:h={}}=o,g=Y9(o,["background","outline","wave"]),{border:v=2,distance:m=0}=d,_=Y9(d,["border","distance"]),{length:b=192,count:S=3}=h;return(w,E,T)=>{const{document:M}=e.canvas,{color:P,fillOpacity:R}=T,k=Object.assign(Object.assign({fill:P},T),g),F=M.createElement("g",{}),[W,$]=n.getCenter(),rt=n.getSize(),et=Math.min(...rt)/2,ut=(0,Eo.Z)(c)?c:XG(c),J=ut(W,$,et,...rt),lt=ut(W,$,et+v/2,...rt);if(Object.keys(u).length){const Ht=M.createElement("path",{style:Object.assign({d:J,fill:"#fff"},u)});F.appendChild(Ht)}if(l>0){const Ht=M.createElement("path",{style:{d:lt}});F.appendChild(Ht),F.style.clipPath=Ht,HG(W,$,1-l,S,k,F,Ht.getBBox().y,et*2,b,!0,M)}const vt=M.createElement("path",{style:{d:J,fill:"transparent",lineWidth:v+2*m,stroke:"#fff"}}),xt=M.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:J,stroke:P,strokeOpacity:R,lineWidth:v},k),_),{fill:"transparent"})});return F.appendChild(vt),F.appendChild(xt),F}};X9.props={};var qG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const KG={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:X9},animate:{enter:{type:"fadeIn"}}},QG={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},q9=t=>{const{data:e={},style:n={},animate:r}=t,o=qG(t,["data","style","animate"]),c=Math.max(0,(0,Se.Z)(e)?e:e==null?void 0:e.percent),l=[{percent:c,type:"liquid"}],u=Object.assign(Object.assign({},wn(n,"text")),wn(n,"content")),d=wn(n,"outline"),h=wn(n,"wave"),g=wn(n,"background");return[nn({},KG,Object.assign({type:"interval",data:l,style:{liquidOptions:{percent:c,liquidShape:n==null?void 0:n.shape},styleOptions:Object.assign(Object.assign({},n),{outline:d,wave:h,background:g})},animate:r},o)),nn({},QG,{style:Object.assign({text:`${ah(c*100)} %`},u),animate:r})]};q9.props={};function $6(t){const e=new Array(t);for(let n=0;n<t;++n)e[n]=0;return e}function K9(t,e){return $6(t).map(()=>$6(e))}function wd(t,e){let n=0;for(let r=0;r<t.length;++r)n+=t[r]*e[r];return n}function Y6(t){return Math.sqrt(wd(t,t))}function X6(t,e,n){for(let r=0;r<e.length;++r)t[r]=e[r]*n}function ll(t,e,n,r,o){for(let c=0;c<t.length;++c)t[c]=e*n[c]+r*o[c]}function _q(t,e,n){for(let r=0;r<t.length;++r)t[r]=wd(e[r],n)}function JG(t,e,n){n=n||{};const r=n.maxIterations||e.length*200,o=n.nonZeroDelta||1.05,c=n.zeroDelta||.001,l=n.minErrorDelta||1e-6,u=n.minErrorDelta||1e-5,d=n.rho!==void 0?n.rho:1,h=n.chi!==void 0?n.chi:2,g=n.psi!==void 0?n.psi:-.5,v=n.sigma!==void 0?n.sigma:.5;let m;const _=e.length,b=new Array(_+1);b[0]=e,b[0].fx=t(e),b[0].id=0;for(let R=0;R<_;++R){const k=e.slice();k[R]=k[R]?k[R]*o:c,b[R+1]=k,b[R+1].fx=t(k),b[R+1].id=R+1}function S(R){for(let k=0;k<R.length;k++)b[_][k]=R[k];b[_].fx=R.fx}const w=(R,k)=>R.fx-k.fx,E=e.slice(),T=e.slice(),M=e.slice(),P=e.slice();for(let R=0;R<r;++R){if(b.sort(w),n.history){const F=b.map(W=>{const $=W.slice();return $.fx=W.fx,$.id=W.id,$});F.sort((W,$)=>W.id-$.id),n.history.push({x:b[0].slice(),fx:b[0].fx,simplex:F})}m=0;for(let F=0;F<_;++F)m=Math.max(m,Math.abs(b[0][F]-b[1][F]));if(Math.abs(b[0].fx-b[_].fx)<l&&m<u)break;for(let F=0;F<_;++F){E[F]=0;for(let W=0;W<_;++W)E[F]+=b[W][F];E[F]/=_}const k=b[_];if(ll(T,1+d,E,-d,k),T.fx=t(T),T.fx<b[0].fx)ll(P,1+h,E,-h,k),P.fx=t(P),P.fx<T.fx?S(P):S(T);else if(T.fx>=b[_-1].fx){let F=!1;if(T.fx>k.fx?(ll(M,1+g,E,-g,k),M.fx=t(M),M.fx<k.fx?S(M):F=!0):(ll(M,1-g*d,E,g*d,k),M.fx=t(M),M.fx<T.fx?S(M):F=!0),F){if(v>=1)break;for(let W=1;W<b.length;++W)ll(b[W],1-v,b[0],v,b[W]),b[W].fx=t(b[W])}}else S(T)}return b.sort(w),{fx:b[0].fx,x:b[0]}}function t$(t,e,n,r){r=r||{};const o=r.maxIterations||100,c=r.tolerance||1e-10,l=t(e),u=t(n);let d=n-e;if(l*u>0)throw"Initial bisect points must have opposite signs";if(l===0)return e;if(u===0)return n;for(let h=0;h<o;++h){d/=2;const g=e+d,v=t(g);if(v*l>=0&&(e=g),Math.abs(d)<c||v===0)return g}return e+d}function e$(t,e,n,r,o,c,l){const u=n.fx,d=wd(n.fxprime,e);let h=u,g=u,v=d,m=0;o=o||1,c=c||1e-6,l=l||.1;function _(b,S,w){for(let E=0;E<16;++E)if(o=(b+S)/2,ll(r.x,1,n.x,o,e),h=r.fx=t(r.x,r.fxprime),v=wd(r.fxprime,e),h>u+c*o*d||h>=w)S=o;else{if(Math.abs(v)<=-l*d)return o;v*(S-b)>=0&&(S=b),b=o,w=h}return 0}for(let b=0;b<10;++b){if(ll(r.x,1,n.x,o,e),h=r.fx=t(r.x,r.fxprime),v=wd(r.fxprime,e),h>u+c*o*d||b&&h>=g)return _(m,o,g);if(Math.abs(v)<=-l*d)return o;if(v>=0)return _(o,m,h);g=h,m=o,o*=2}return o}function n$(t,e,n){let r={x:e.slice(),fx:0,fxprime:e.slice()},o={x:e.slice(),fx:0,fxprime:e.slice()};const c=e.slice();let l,u=1;n=n||{};const d=n.maxIterations||e.length*20;r.fx=t(r.x,r.fxprime);const h=r.fxprime.slice();X6(h,r.fxprime,-1);for(let g=0;g<d;++g){if(u=e$(t,h,r,o,u),n.history&&n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:u}),!u)X6(h,r.fxprime,-1);else{ll(c,1,o.fxprime,-1,r.fxprime);const v=wd(r.fxprime,r.fxprime),m=Math.max(0,wd(c,o.fxprime)/v);ll(h,m,h,-1,o.fxprime),l=r,r=o,o=l}if(Y6(r.fxprime)<=1e-5)break}return n.history&&n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:u}),r}function bq(t,e,n,r){const o=n.slice(),c=n.slice();let l,u,d;gemv(c,t,n),weightedSum(o,1,e,-1,c);const h=o.slice();l=dot(o,o);for(let g=0;g<e.length&&(gemv(c,t,h),d=l/dot(h,c),r&&r.push({x:n.slice(),p:h.slice(),alpha:d}),weightedSum(n,1,n,d,h),weightedSum(o,1,o,-d,c),u=dot(o,o),!(Math.sqrt(u)<=1e-10));++g)weightedSum(h,1,o,u/l,h),l=u;return r&&r.push({x:n.slice(),p:h.slice(),alpha:d}),n}const Q9=1e-10;function J9(t,e){const n=i$(t),r=n.filter(function(d){return r$(d,t)});let o=0,c=0,l;const u=[];if(r.length>1){const d=o$(r);for(l=0;l<r.length;++l){const g=r[l];g.angle=Math.atan2(g.x-d.x,g.y-d.y)}r.sort(function(g,v){return v.angle-g.angle});let h=r[r.length-1];for(l=0;l<r.length;++l){const g=r[l];c+=(h.x+g.x)*(g.y-h.y);const v={x:(g.x+h.x)/2,y:(g.y+h.y)/2};let m=null;for(let _=0;_<g.parentIndex.length;++_)if(h.parentIndex.indexOf(g.parentIndex[_])>-1){const b=t[g.parentIndex[_]],S=Math.atan2(g.x-b.x,g.y-b.y),w=Math.atan2(h.x-b.x,h.y-b.y);let E=w-S;E<0&&(E+=2*Math.PI);const T=w-E/2;let M=o1(v,{x:b.x+b.radius*Math.sin(T),y:b.y+b.radius*Math.cos(T)});M>b.radius*2&&(M=b.radius*2),(m===null||m.width>M)&&(m={circle:b,width:M,p1:g,p2:h})}m!==null&&(u.push(m),o+=q6(m.circle.radius,m.width),h=g)}}else{let d=t[0];for(l=1;l<t.length;++l)t[l].radius<d.radius&&(d=t[l]);let h=!1;for(l=0;l<t.length;++l)if(o1(t[l],d)>Math.abs(d.radius-t[l].radius)){h=!0;break}h?o=c=0:(o=d.radius*d.radius*Math.PI,u.push({circle:d,p1:{x:d.x,y:d.y+d.radius},p2:{x:d.x-Q9,y:d.y+d.radius},width:d.radius*2}))}return c/=2,e&&(e.area=o+c,e.arcArea=o,e.polygonArea=c,e.arcs=u,e.innerPoints=r,e.intersectionPoints=n),o+c}function r$(t,e){for(let n=0;n<e.length;++n)if(o1(t,e[n])>e[n].radius+Q9)return!1;return!0}function i$(t){const e=[];for(let n=0;n<t.length;++n)for(let r=n+1;r<t.length;++r){const o=eF(t[n],t[r]);for(let c=0;c<o.length;++c){const l=o[c];l.parentIndex=[n,r],e.push(l)}}return e}function q6(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function o1(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function tF(t,e,n){if(n>=t+e)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);const r=t-(n*n-e*e+t*t)/(2*n),o=e-(n*n-t*t+e*e)/(2*n);return q6(t,r)+q6(e,o)}function eF(t,e){const n=o1(t,e),r=t.radius,o=e.radius;if(n>=r+o||n<=Math.abs(r-o))return[];const c=(r*r-o*o+n*n)/(2*n),l=Math.sqrt(r*r-c*c),u=t.x+c*(e.x-t.x)/n,d=t.y+c*(e.y-t.y)/n,h=-(e.y-t.y)*(l/n),g=-(e.x-t.x)*(l/n);return[{x:u+h,y:d-g},{x:u-h,y:d+g}]}function o$(t){const e={x:0,y:0};for(let n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}function a$(t,e){e=e||{},e.maxIterations=e.maxIterations||500;const n=e.initialLayout||u$,r=e.lossFunction||Q6;t=s$(t);const o=n(t,e),c=[],l=[];let u;for(u in o)o.hasOwnProperty(u)&&(c.push(o[u].x),c.push(o[u].y),l.push(u));const h=JG(function(g){const v={};for(let m=0;m<l.length;++m){const _=l[m];v[_]={x:g[2*m],y:g[2*m+1],radius:o[_].radius}}return r(v,t)},c,e).x;for(let g=0;g<l.length;++g)u=l[g],o[u].x=h[2*g],o[u].y=h[2*g+1];return o}const nF=1e-10;function K6(t,e,n){return Math.min(t,e)*Math.min(t,e)*Math.PI<=n+nF?Math.abs(t-e):t$(function(r){return tF(t,e,r)-n},0,t+e)}function s$(t){t=t.slice();const e=[],n={};let r,o,c,l;for(r=0;r<t.length;++r){const u=t[r];u.sets.length==1?e.push(u.sets[0]):u.sets.length==2&&(c=u.sets[0],l=u.sets[1],n[[c,l]]=!0,n[[l,c]]=!0)}for(e.sort((u,d)=>u>d?1:-1),r=0;r<e.length;++r)for(c=e[r],o=r+1;o<e.length;++o)l=e[o],[c,l]in n||t.push({sets:[c,l],size:0});return t}function c$(t,e,n){const r=K9(e.length,e.length),o=K9(e.length,e.length);return t.filter(function(c){return c.sets.length==2}).map(function(c){const l=n[c.sets[0]],u=n[c.sets[1]],d=Math.sqrt(e[l].size/Math.PI),h=Math.sqrt(e[u].size/Math.PI),g=K6(d,h,c.size);r[l][u]=r[u][l]=g;let v=0;c.size+1e-10>=Math.min(e[l].size,e[u].size)?v=1:c.size<=1e-10&&(v=-1),o[l][u]=o[u][l]=v}),{distances:r,constraints:o}}function l$(t,e,n,r){let o=0,c;for(c=0;c<e.length;++c)e[c]=0;for(c=0;c<n.length;++c){const l=t[2*c],u=t[2*c+1];for(let d=c+1;d<n.length;++d){const h=t[2*d],g=t[2*d+1],v=n[c][d],m=r[c][d],_=(h-l)*(h-l)+(g-u)*(g-u),b=Math.sqrt(_),S=_-v*v;m>0&&b<=v||m<0&&b>=v||(o+=2*S*S,e[2*c]+=4*S*(l-h),e[2*c+1]+=4*S*(u-g),e[2*d]+=4*S*(h-l),e[2*d+1]+=4*S*(g-u))}}return o}function u$(t,e){let n=d$(t,e);const r=e.lossFunction||Q6;if(t.length>=8){const o=f$(t,e),c=r(o,t),l=r(n,t);c+1e-8<l&&(n=o)}return n}function f$(t,e){e=e||{};const n=e.restarts||10,r=[],o={};let c;for(c=0;c<t.length;++c){const S=t[c];S.sets.length==1&&(o[S.sets[0]]=r.length,r.push(S))}const l=c$(t,r,o);let u=l.distances;const d=l.constraints,h=Y6(u.map(Y6))/u.length;u=u.map(function(S){return S.map(function(w){return w/h})});const g=function(S,w){return l$(S,w,u,d)};let v,m;for(c=0;c<n;++c){const S=$6(u.length*2).map(Math.random);m=n$(g,S,e),(!v||m.fx<v.fx)&&(v=m)}const _=v.x,b={};for(c=0;c<r.length;++c){const S=r[c];b[S.sets[0]]={x:_[2*c]*h,y:_[2*c+1]*h,radius:Math.sqrt(S.size/Math.PI)}}if(e.history)for(c=0;c<e.history.length;++c)X6(e.history[c].x,h);return b}function d$(t,e){const n=e&&e.lossFunction?e.lossFunction:Q6,r={},o={};let c;for(let v=0;v<t.length;++v){const m=t[v];m.sets.length==1&&(c=m.sets[0],r[c]={x:1e10,y:1e10,rowid:Object.keys(r).length,size:m.size,radius:Math.sqrt(m.size/Math.PI)},o[c]=[])}t=t.filter(function(v){return v.sets.length==2});for(let v=0;v<t.length;++v){const m=t[v];let _=m.hasOwnProperty("weight")?m.weight:1;const b=m.sets[0],S=m.sets[1];m.size+nF>=Math.min(r[b].size,r[S].size)&&(_=0),o[b].push({set:S,size:m.size,weight:_}),o[S].push({set:b,size:m.size,weight:_})}const l=[];for(c in o)if(o.hasOwnProperty(c)){let v=0;for(let m=0;m<o[c].length;++m)v+=o[c][m].size*o[c][m].weight;l.push({set:c,size:v})}function u(v,m){return m.size-v.size}l.sort(u);const d={};function h(v){return v.set in d}function g(v,m){r[m].x=v.x,r[m].y=v.y,d[m]=!0}g({x:0,y:0},l[0].set);for(let v=1;v<l.length;++v){const m=l[v].set,_=o[m].filter(h);if(c=r[m],_.sort(u),_.length===0)throw"ERROR: missing pairwise overlap information";const b=[];for(let E=0;E<_.length;++E){const T=r[_[E].set],M=K6(c.radius,T.radius,_[E].size);b.push({x:T.x+M,y:T.y}),b.push({x:T.x-M,y:T.y}),b.push({y:T.y+M,x:T.x}),b.push({y:T.y-M,x:T.x});for(let P=E+1;P<_.length;++P){const R=r[_[P].set],k=K6(c.radius,R.radius,_[P].size),F=eF({x:T.x,y:T.y,radius:M},{x:R.x,y:R.y,radius:k});for(let W=0;W<F.length;++W)b.push(F[W])}}let S=1e50,w=b[0];for(let E=0;E<b.length;++E){r[m].x=b[E].x,r[m].y=b[E].y;const T=n(r,t);T<S&&(S=T,w=b[E])}g(w,m)}return r}function Q6(t,e){let n=0;function r(o){return o.map(function(c){return t[c]})}for(let o=0;o<e.length;++o){const c=e[o];let l;if(c.sets.length==1)continue;if(c.sets.length==2){const d=t[c.sets[0]],h=t[c.sets[1]];l=tF(d.radius,h.radius,o1(d,h))}else l=J9(r(c.sets));const u=c.hasOwnProperty("weight")?c.weight:1;n+=u*(l-c.size)*(l-c.size)}return n}function h$(t,e,n){n===null?t.sort(function(o,c){return c.radius-o.radius}):t.sort(n);let r;if(t.length>0){const o=t[0].x,c=t[0].y;for(r=0;r<t.length;++r)t[r].x-=o,t[r].y-=c}if(t.length==2&&distance(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){const o=Math.atan2(t[1].x,t[1].y)-e;let c,l;const u=Math.cos(o),d=Math.sin(o);for(r=0;r<t.length;++r)c=t[r].x,l=t[r].y,t[r].x=u*c-d*l,t[r].y=d*c+u*l}if(t.length>2){let o=Math.atan2(t[2].x,t[2].y)-e;for(;o<0;)o+=2*Math.PI;for(;o>2*Math.PI;)o-=2*Math.PI;if(o>Math.PI){const c=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){const l=(t[r].x+c*t[r].y)/(1+c*c);t[r].x=2*l-t[r].x,t[r].y=2*l*c-t[r].y}}}}function p$(t){t.map(function(l){l.parent=l});function e(l){return l.parent!==l&&(l.parent=e(l.parent)),l.parent}function n(l,u){const d=e(l),h=e(u);d.parent=h}for(let l=0;l<t.length;++l)for(let u=l+1;u<t.length;++u){const d=t[l].radius+t[u].radius;distance(t[l],t[u])+1e-10<d&&n(t[u],t[l])}const r={};let o;for(let l=0;l<t.length;++l)o=e(t[l]).parent.setid,o in r||(r[o]=[]),r[o].push(t[l]);t.map(function(l){delete l.parent});const c=[];for(o in r)r.hasOwnProperty(o)&&c.push(r[o]);return c}function J6(t){const e=function(n){const r=Math.max.apply(null,t.map(function(c){return c[n]+c.radius})),o=Math.min.apply(null,t.map(function(c){return c[n]-c.radius}));return{max:r,min:o}};return{xRange:e("x"),yRange:e("y")}}function xq(t,e,n){e===null&&(e=Math.PI/2);let r=[],o,c;for(c in t)if(t.hasOwnProperty(c)){const m=t[c];r.push({x:m.x,y:m.y,radius:m.radius,setid:c})}const l=p$(r);for(o=0;o<l.length;++o){h$(l[o],e,n);const m=J6(l[o]);l[o].size=(m.xRange.max-m.xRange.min)*(m.yRange.max-m.yRange.min),l[o].bounds=m}l.sort(function(m,_){return _.size-m.size}),r=l[0];let u=r.bounds;const d=(u.xRange.max-u.xRange.min)/50;function h(m,_,b){if(!m)return;const S=m.bounds;let w,E,T;_?w=u.xRange.max-S.xRange.min+d:(w=u.xRange.max-S.xRange.max,T=(S.xRange.max-S.xRange.min)/2-(u.xRange.max-u.xRange.min)/2,T<0&&(w+=T)),b?E=u.yRange.max-S.yRange.min+d:(E=u.yRange.max-S.yRange.max,T=(S.yRange.max-S.yRange.min)/2-(u.yRange.max-u.yRange.min)/2,T<0&&(E+=T));for(let M=0;M<m.length;++M)m[M].x+=w,m[M].y+=E,r.push(m[M])}let g=1;for(;g<l.length;)h(l[g],!0,!1),h(l[g+1],!1,!0),h(l[g+2],!0,!0),g+=3,u=J6(r);const v={};for(o=0;o<r.length;++o)v[r[o].setid]=r[o];return v}function g$(t,e,n,r){const o=[],c=[];for(const S in t)t.hasOwnProperty(S)&&(c.push(S),o.push(t[S]));e-=2*r,n-=2*r;const l=J6(o),u=l.xRange,d=l.yRange;if(u.max==u.min||d.max==d.min)return console.log("not scaling solution: zero size detected"),t;const h=e/(u.max-u.min),g=n/(d.max-d.min),v=Math.min(g,h),m=(e-(u.max-u.min)*v)/2,_=(n-(d.max-d.min)*v)/2,b={};for(let S=0;S<o.length;++S){const w=o[S];b[c[S]]={radius:v*w.radius,x:r+m+(w.x-u.min)*v,y:r+_+(w.y-d.min)*v}}return b}function v$(t,e,n){const r=[],o=t-n,c=e;return r.push("M",o,c),r.push("A",n,n,0,1,0,o+2*n,c),r.push("A",n,n,0,1,0,o,c),r.join(" ")}function m$(t){const e={};J9(t,e);const n=e.arcs;if(n.length===0)return"M 0 0";if(n.length==1){const r=n[0].circle;return v$(r.x,r.y,r.radius)}else{const r=[`
M`,n[0].p2.x,n[0].p2.y];for(let o=0;o<n.length;++o){const c=n[o],l=c.circle.radius,u=c.width>l;r.push(`
A`,l,l,0,u?1:0,1,c.p1.x,c.p1.y)}return r.join(" ")}}const rF=t=>{const{sets:e="sets",size:n="size",as:r=["key","path"],padding:o=0}=t,[c,l]=r;return u=>{const d=u.map(v=>Object.assign(Object.assign({},v),{sets:v[e],size:v[n],[c]:v.sets.join("&")}));d.sort((v,m)=>v.sets.length-m.sets.length);const h=a$(d);let g;return d.map(v=>{const m=v[e],_=({width:b,height:S})=>{g=g||g$(h,b,S,o);const w=m.map(T=>g[T]);let E=m$(w);return/[zZ]$/.test(E)||(E+=" Z"),E};return Object.assign(Object.assign({},v),{[l]:_})})}};rF.props={};function y$(){return{"data.venn":rF,"mark.boxplot":U9,"mark.gauge":W9,"mark.wordCloud":wy,"mark.liquid":q9}}function _$(){return Object.assign(Object.assign(Object.assign(Object.assign({},sV()),MG()),y$()),rW())}var AO=function(){return AO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},AO.apply(this,arguments)},b$=k4(R4,AO(AO({},_$()),iP())),A0=function(){return A0=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},A0.apply(this,arguments)},x$=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},S$=["renderer","plugins"],iF=["width","height","autoFit","theme","inset","insetLeft","insetRight","insetTop","insetBottom","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","depth","title","clip","children","type","data","direction","plugins"],TO="__transform__",w$="__skipDelCustomKeys__",ku=function(t,e){return(0,At.isBoolean)(e)?{type:t,available:e}:A0({type:t},e)},t7={xField:"encode.x",yField:"encode.y",colorField:"encode.color",angleField:"encode.y",keyField:"encode.key",y1Field:"encode.y1",sizeField:"encode.size",setsField:"encode.sets",shapeField:"encode.shape",seriesField:"encode.series",positionField:"encode.position",textField:"encode.text",valueField:"encode.value",binField:"encode.x",srcField:"encode.src",linkColorField:"encode.linkColor",fontSizeField:"encode.fontSize",coordinateType:"coordinate.type",radius:"coordinate.outerRadius",innerRadius:"coordinate.innerRadius",startAngle:"coordinate.startAngle",endAngle:"coordinate.endAngle",focusX:"coordinate.focusX",focusY:"coordinate.focusY",distortionX:"coordinate.distortionX",distortionY:"coordinate.distortionY",visual:"coordinate.visual",stack:{target:"transform",value:function(t){return ku("stackY",t)}},normalize:{target:"transform",value:function(t){return ku("normalizeY",t)}},percent:{target:"transform",value:function(t){return ku("normalizeY",t)}},group:{target:"transform",value:function(t){return ku("dodgeX",t)}},sort:{target:"transform",value:function(t){return ku("sortX",t)}},symmetry:{target:"transform",value:function(t){return ku("symmetryY",t)}},diff:{target:"transform",value:function(t){return ku("diffY",t)}},meta:{target:"scale",value:function(t){return t}},label:{target:"labels",value:function(t){return t}},shape:"style.shape",connectNulls:{target:"style",value:function(t){return(0,At.isBoolean)(t)?{connect:t}:t}},transpose:{target:"transpose",value:function(t){return ku("transpose",t)}}},e7=["xField","yField","seriesField","colorField","shapeField","keyField","positionField","meta","tooltip","animate","stack","normalize","percent","group","sort","symmetry","diff"],MO=[{key:"annotations",extendedProperties:[]},{key:"line",type:"line",extendedProperties:e7},{key:"connector",type:"connector",extendedProperties:[]},{key:"point",type:"point",extendedProperties:e7,defaultShapeConfig:{shapeField:"circle"}},{key:"area",type:"area",extendedProperties:e7}],O$=[{key:"transform",callback:function(t,e,n){var r;t[e]=t[e]||[];var o=n.available,c=o===void 0?!0:o,l=x$(n,["available"]);if(c)t[e].push(A0((r={},r[TO]=!0,r),l));else{var u=t[e].indexOf(function(d){return d.type===n.type});u!==-1&&t[e].splice(u,1)}}},{key:"labels",callback:function(t,e,n){var r;if(!n||(0,At.isArray)(n)){t[e]=n||[];return}n.text||(n.text=t.yField),t[e]=t[e]||[],t[e].push(A0((r={},r[TO]=!0,r),n))}},{key:"transpose",callback:function(t,e,n){var r;n.available?t.coordinate={transform:[A0((r={},r[TO]=!0,r),n)]}:t.coordinate={}}}],n7=[{key:"conversionTag",shape:"ConversionTag"},{key:"axisText",shape:"BidirectionalBarAxisText"}],E$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),CO=function(){return CO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},CO.apply(this,arguments)},A$=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},T$=function(t){E$(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=A$(n,["style"]);return t.call(this,CO({style:CO({fill:"#eee"},r)},o))||this}return e}(N.mg),M$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),PO=function(){return PO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},PO.apply(this,arguments)},C$=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},oF=function(t){M$(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=C$(n,["style"]);return t.call(this,PO({style:PO({text:"",fontSize:12,textBaseline:"middle",textAlign:"center",fill:"#000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1},r)},o))||this}return e}(N.xv),aF=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))},P$=function(t,e){if((0,At.isArray)(e))return e},Du=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return At.mergeWith.apply(void 0,aF(aF([],t,!1),[P$],!1))},L$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sF=function(t){L$(e,t);function e(n,r,o){var c=t.call(this,{style:Du(o,r)})||this;return c.chart=n,c}return e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},e.prototype.disconnectedCallback=function(){},e.prototype.attributeChangedCallback=function(n){},e.prototype.update=function(n,r){var o;return this.attr(Du({},this.attributes,n||{})),(o=this.render)===null||o===void 0?void 0:o.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.getElementsLayout=function(){var n=this.chart.getContext().canvas,r=n.document.getElementsByClassName("element"),o=[];return r.forEach(function(c){var l=c.getBBox(),u=l.x,d=l.y,h=l.width,g=l.height,v=c.__data__;o.push({bbox:l,x:u,y:d,width:h,height:g,key:v.key,data:v})}),o},e.prototype.bindEvents=function(n,r){},e}(N.b_),I$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),LO=function(){return LO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},LO.apply(this,arguments)},R$=function(t){I$(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.getConversionTagLayout=function(){var n=this.direction==="vertical",r=Array.from(this.getElementsLayout()).sort(function(R,k){return n?R.y-k.y:R.x-k.x}),o=r[0],c=o.x,l=o.y,u=o.height,d=o.width,h=o.data,g=["items",0,"value"],v=(0,At.get)(h,g),m=n?r[1].y-l-u:r[1].x-c-d,_=[],b=this.attributes,S=b.size,w=S===void 0?40:S,E=b.arrowSize,T=E===void 0?20:E,M=b.spacing,P=M===void 0?4:M;return r.forEach(function(R,k){if(k>0){var F=R.x,W=R.y,$=R.height,rt=R.width,et=R.data,ut=R.key,J=(0,At.get)(et,g),lt=w/2;if(n){var vt=F+rt/2,xt=W;_.push({points:[[vt+lt,xt-m+P],[vt+lt,xt-T-P],[vt,xt-P],[vt-lt,xt-T-P],[vt-lt,xt-m+P]],center:[vt,xt-m/2],width:m,value:[v,J],key:ut})}else{var vt=F,xt=W+$/2;_.push({points:[[F-m+P,xt-lt],[F-T-P,xt-lt],[vt-P,xt],[F-T-P,xt+lt],[F-m+P,xt+lt]],center:[vt-m/2,xt],width:m,value:[v,J],key:ut})}v=J}}),_},e.prototype.render=function(){this.setDirection(),this.drawConversionTag()},e.prototype.setDirection=function(){var n=this.chart.getCoordinate(),r=(0,At.get)(n,"options.transformations"),o="horizontal";r.forEach(function(c){c.includes("transpose")&&(o="vertical")}),this.direction=o},e.prototype.drawConversionTag=function(){var n=this,r=this.getConversionTagLayout(),o=this.attributes,c=o.style,l=o.text,u=l.style,d=l.formatter;r.forEach(function(h){var g=h.points,v=h.center,m=h.value,_=h.key,b=m[0],S=m[1],w=v[0],E=v[1],T=new T$({style:LO({points:g,fill:"#eee"},c),id:"polygon-".concat(_)}),M=new oF({style:LO({x:w,y:E,text:(0,At.isFunction)(d)?d(b,S):(S/b*100).toFixed(2)+"%"},u),id:"text-".concat(_)});n.appendChild(T),n.appendChild(M)})},e.prototype.update=function(){this.clear(),this.drawConversionTag()},e.prototype.destroy=function(){this.clear()},e.tag="ConversionTag",e}(sF),r7=32,cF=16,lF=48,k$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),a1=function(){return a1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},a1.apply(this,arguments)},D$=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},N$=function(t){k$(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.render=function(){this.drawText()},e.prototype.getBidirectionalBarAxisTextLayout=function(){var n=this.attributes.layout,r=n==="vertical",o=this.getElementsLayout(),c=r?(0,At.uniqBy)(o,"x"):(0,At.uniqBy)(o,"y"),l=["title"],u=[],d=this.chart.getContext().views,h=(0,At.get)(d,[0,"layout"]),g=h.width,v=h.height;return c.forEach(function(m){var _=m.x,b=m.y,S=m.height,w=m.width,E=m.data,T=m.key,M=(0,At.get)(E,l);r?u.push({x:_+w/2,y:v,text:M,key:T}):u.push({x:g,y:b+S/2,text:M,key:T})}),(0,At.uniqBy)(u,"text").length!==u.length&&(u=Object.values((0,At.groupBy)(u,"text")).map(function(m){var _,b=m.reduce(function(S,w){return S+(r?w.x:w.y)},0);return a1(a1({},m[0]),(_={},_[r?"x":"y"]=b/m.length,_))})),u},e.prototype.transformLabelStyle=function(n){var r={},o=/^label[A-Z]/;return Object.keys(n).forEach(function(c){o.test(c)&&(r[c.replace("label","").replace(/^[A-Z]/,function(l){return l.toLowerCase()})]=n[c])}),r},e.prototype.drawText=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout(),o=this.attributes,c=o.layout,l=o.labelFormatter,u=D$(o,["layout","labelFormatter"]);r.forEach(function(d){var h=d.x,g=d.y,v=d.text,m=d.key,_=new oF({style:a1({x:h,y:g,text:(0,At.isFunction)(l)?l(v):v,wordWrap:!0,wordWrapWidth:c==="horizontal"?r7*2:120,maxLines:2,textOverflow:"ellipsis"},n.transformLabelStyle(u)),id:"text-".concat(m)});n.appendChild(_)})},e.prototype.destroy=function(){this.clear()},e.prototype.update=function(){this.destroy(),this.drawText()},e.tag="BidirectionalBarAxisText",e}(sF),F$={ConversionTag:R$,BidirectionalBarAxisText:N$},B$=function(){function t(e,n){this.container=new Map,this.chart=e,this.config=n,this.init()}return t.prototype.init=function(){var e=this;n7.forEach(function(n){var r,o=n.key,c=n.shape,l=e.config[o];if(l){var u=new F$[c](e.chart,l),d=e.chart.getContext().canvas;d.appendChild(u),e.container.set(o,u)}else(r=e.container.get(o))===null||r===void 0||r.clear()})},t.prototype.update=function(){var e=this;this.container.size&&n7.forEach(function(n){var r=n.key,o=e.container.get(r);o==null||o.update()})},t.prototype.destroy=function(){this.container.forEach(function(e){e.destroy()}),this.container.clear()},t}(),j$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),T0=function(){return T0=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},T0.apply(this,arguments)},uF="data-chart-source-type",zr=function(t){j$(e,t);function e(n,r){var o=t.call(this)||this;return o.eventListeners=[],o.bindedEvents=!1,o.container=typeof n=="string"?document.getElementById(n):n,o.options=o.mergeOption(r),o.createG2(),o.bindEvents(),o}return e.prototype.getChartOptions=function(){return T0(T0({},(0,At.pick)(this.options,S$)),{container:this.container})},e.prototype.getSpecOptions=function(){return this.type==="base"||this[w$]?T0(T0({},this.options),this.getChartOptions()):this.options},e.prototype.createG2=function(){if(!this.container)throw Error("The container is not initialized!");this.chart=new b$(this.getChartOptions()),this.container.setAttribute(uF,"Ant Design Charts")},e.prototype.bindEvents=function(){var n=this;if(this.chart){var r=function(o){o!=null&&o.type&&n.emit(o.type,o)};this.chart.on("*",r),this.eventListeners.push(function(){var o;(o=n.chart)===null||o===void 0||o.off("*",r)})}},e.prototype.getBaseOptions=function(){return{type:"view",autoFit:!0}},e.prototype.getDefaultOptions=function(){},e.prototype.render=function(){var n=this;this.type!=="base"&&this.execAdaptor(),this.chart.options(this.getSpecOptions()),this.chart.render().then(function(){n.annotation?n.annotation.update():n.annotation=new B$(n.chart,n.options),n.bindSizeSensor()})},e.prototype.update=function(n){this.options=this.mergeOption(n)},e.prototype.mergeOption=function(n){return Du({},this.getBaseOptions(),this.getDefaultOptions(),n)},e.prototype.changeData=function(n){this.chart.changeData(n)},e.prototype.changeSize=function(n,r){this.chart.changeSize(n,r)},e.prototype.destroy=function(){this.eventListeners.forEach(function(n){return n()}),this.eventListeners=[],this.annotation&&typeof this.annotation.destroy=="function"&&this.annotation.destroy(),this.annotation=null,this.chart.destroy(),this.off(),this.bindedEvents=!1,this.container.removeAttribute(uF)},e.prototype.execAdaptor=function(){var n=this.getSchemaAdaptor();n({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var n=this;if(!this.bindedEvents){var r=this.options.autoFit,o=r===void 0?!0:r;if(o){var c=function(){n.annotation&&n.annotation.update()};this.chart.on(Ir.AFTER_CHANGE_SIZE,c),this.eventListeners.push(function(){var l;(l=n.chart)===null||l===void 0||l.off(Ir.AFTER_CHANGE_SIZE,c)}),this.bindedEvents=!0}}},e}(Xe),z$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),U$=function(t){z$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="base",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return function(n){return n}},e}(zr),Z$=function(t){var e=t.options,n=e.children,r=n===void 0?[]:n;return r.forEach(function(o){Object.keys(o).forEach(function(c){(0,At.isArray)(o[c])&&c!=="data"&&(o[c]=o[c].filter(function(l){return!l[TO]}))})}),e},fF=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))},H$=function(t){var e=t.children,n=e===void 0?[]:e,r=Object.keys(t7).concat(MO.map(function(o){return o.key}));return r.forEach(function(o){delete t[o]}),n.forEach(function(o){Object.keys(o).forEach(function(c){r.includes(c)&&delete o[c]})}),Object.keys(t).forEach(function(o){fF(fF([],iF,!0),n7.map(function(c){return c.key}),!0).includes(o)||delete t[o]}),t},s1=function(){return s1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},s1.apply(this,arguments)},Kr=function(t){var e=Z$(t),n=e.children,r=n===void 0?[]:n,o=(0,At.omit)(e,[].concat(iF,MO.map(function(h){return h.key}))),c=function(h){var g;return(g=O$.find(function(v){return v.key===h}))===null||g===void 0?void 0:g.callback},l=function(h,g,v){var m=c(g);m?m(h,g,v):h[g]=Du({},h[g],v)},u=function(h){Object.keys(h).forEach(function(g){if(h[g]){var v=MO.find(function(T){return T.key===g});if(v){var m=v.type,_=v.extendedProperties,b=v.defaultShapeConfig,S=b===void 0?{}:b;if(m){var w=h[g].tooltip;r.push(d(Du({},(0,At.pick)(h,_),S,{type:m},h[g],{tooltip:w||!1})))}else if((0,At.isArray)(h[g])){var E=h[g].some(function(T){return T.type==="text"});h[g].forEach(function(T){r.push(d(s1(s1(s1({},E?{data:[]}:{}),{tooltip:!1}),T)))})}}}})},d=function(h){return u(h),Object.keys(t7).forEach(function(g){var v=t7[g];if(!(0,At.isUndefined)(h[g]))if((0,At.isObject)(v)){var m=v.value,_=v.target,b=m(h[g]);l(h,_,b)}else(0,At.set)(h,v,h[g])}),h};return r.forEach(function(h){var g=Du({},o,h);d(Du(h,g))}),u(e),H$(e),t},i7=function(){return i7=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},i7.apply(this,arguments)};function W$(t){var e=t.options,n=e.stack,r=e.tooltip,o=e.xField;if(!n)return t;var c=MO.map(function(u){return u.type}).filter(function(u){return!!u}),l=!1;return c.forEach(function(u){e[u]&&(l=!0,(0,At.set)(e,[u,"stack"],i7({y1:"y"},typeof n=="object"?n:{})))}),l&&!(0,At.isBoolean)(r)&&!r&&(0,At.set)(e,"tooltip",{title:o,items:[{channel:"y"}]}),t}function Fi(t){return(0,At.flow)(W$)(t)}function V$(t){return(0,At.flow)(Fi,Kr)(t)}var G$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),$$=function(t){G$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="area",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"area"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return V$},e}(zr),M0=function(){return M0=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},M0.apply(this,arguments)};function dF(t){var e=function(n){var r=n.options;(0,At.get)(r,"children.length")>1&&(0,At.set)(r,"children",[{type:"interval"}]);var o=r.scale,c=r.markBackground,l=r.data,u=r.children,d=r.yField,h=(0,At.get)(o,"y.domain",[]);if(c&&h.length&&(0,At.isArray)(l)){var g="domainMax",v=l.map(function(m){var _;return M0(M0({originData:M0({},m)},(0,At.omit)(m,d)),(_={},_[g]=h[h.length-1],_))});u.unshift(M0({type:"interval",data:v,yField:g,tooltip:!1,style:{fill:"#eee"},label:!1},c))}return n};return(0,At.flow)(e,Fi,Kr)(t)}var Y$=function(){var t=function(e,n){return function(r){var o=e.fill,c=o===void 0?"#2888FF":o,l=e.stroke,u=e.fillOpacity,d=u===void 0?1:u,h=e.strokeOpacity,g=h===void 0?.2:h,v=e.pitch,m=v===void 0?8:v,_=r[0],b=r[1],S=r[2],w=r[3],E=(b[1]-_[1])/2,T=n.document,M=T.createElement("g",{}),P=T.createElement("polygon",{style:{points:[_,[_[0]-m,_[1]+E],[S[0]-m,_[1]+E],w],fill:c,fillOpacity:d,stroke:l,strokeOpacity:g,inset:30}}),R=T.createElement("polygon",{style:{points:[[_[0]-m,_[1]+E],b,S,[S[0]-m,_[1]+E]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:g}}),k=T.createElement("polygon",{style:{points:[_,[_[0]-m,_[1]+E],b,[_[0]+m,_[1]+E]],fill:c,fillOpacity:d-.2}});return M.appendChild(P),M.appendChild(R),M.appendChild(k),M}};M1("shape.interval.bar25D",t)},X$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Y$();var q$=function(t){X$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Bar",n}return e.getDefaultOptions=function(){return{type:"view",coordinate:{transform:[{type:"transpose"}]},children:[{type:"interval"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return dF},e}(zr),K$=function(){var t=function(e,n){return function(r){var o=e.fill,c=o===void 0?"#2888FF":o,l=e.stroke,u=e.fillOpacity,d=u===void 0?1:u,h=e.strokeOpacity,g=h===void 0?.2:h,v=e.pitch,m=v===void 0?8:v,_=r[1][0]-r[0][0],b=_/2+r[0][0],S=n.document,w=S.createElement("g",{}),E=S.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[b,r[1][1]+m],[b,r[3][1]+m],[r[3][0],r[3][1]]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:g,inset:30}}),T=S.createElement("polygon",{style:{points:[[b,r[1][1]+m],[r[1][0],r[1][1]],[r[2][0],r[2][1]],[b,r[2][1]+m]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:g}}),M=S.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[b,r[1][1]-m],[r[1][0],r[1][1]],[b,r[1][1]+m]],fill:c,fillOpacity:d-.2}});return w.appendChild(T),w.appendChild(E),w.appendChild(M),w}};M1("shape.interval.column25D",t)},Q$=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();K$();var J$=function(t){Q$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return dF},e}(zr);function tY(t){var e=function(r){var o=r.options,c=o.children,l=c===void 0?[]:c,u=o.legend;return u&&l.forEach(function(d){if(!(0,At.get)(d,"colorField")){var h=(0,At.get)(d,"yField");(0,At.set)(d,"colorField",function(){return h})}}),r},n=function(r){var o=r.options,c=o.annotations,l=c===void 0?[]:c,u=o.children,d=u===void 0?[]:u,h=o.scale,g=!1;return(0,At.get)(h,"y.key")||d.forEach(function(v,m){if(!(0,At.get)(v,"scale.y.key")){var _="child".concat(m,"Scale");(0,At.set)(v,"scale.y.key",_);var b=v.annotations,S=b===void 0?[]:b;S.length>0&&((0,At.set)(v,"scale.y.independent",!1),S.forEach(function(w){(0,At.set)(w,"scale.y.key",_)})),!g&&l.length>0&&(0,At.get)(v,"scale.y.independent")===void 0&&(g=!0,(0,At.set)(v,"scale.y.independent",!1),l.forEach(function(w){(0,At.set)(w,"scale.y.key",_)}))}}),r};return(0,At.flow)(e,n,Fi,Kr)(t)}var eY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hF=function(t){eY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="DualAxes",n}return e.getDefaultOptions=function(){return{type:"view",axis:{y:{title:!1,tick:!1},x:{title:!1}},scale:{y:{independent:!0,nice:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return tY},e}(zr);function nY(t){var e=function(c){var l=c.options,u=l.xField,d=l.colorField;return d||(0,At.set)(l,"colorField",u),c},n=function(c){var l=c.options,u=l.compareField,d=l.transform,h=l.isTransposed,g=h===void 0?!0:h,v=l.coordinate;return d||(u?(0,At.set)(l,"transform",[]):(0,At.set)(l,"transform",[{type:"symmetryY"}])),!v&&g&&(0,At.set)(l,"coordinate",{transform:[{type:"transpose"}]}),c},r=function(c){var l=c.options,u=l.compareField,d=l.seriesField,h=l.data,g=l.children,v=l.yField,m=l.isTransposed,_=m===void 0?!0:m;if(u||d){var b=Object.values((0,At.groupBy)(h,function(S){return S[u||d]}));g[0].data=b[0],g.push({type:"interval",data:b[1],yField:function(S){return-S[v]}}),delete l.compareField,delete l.data}return d&&((0,At.set)(l,"type","spaceFlex"),(0,At.set)(l,"ratio",[1,1]),(0,At.set)(l,"direction",_?"row":"col"),delete l.seriesField),c},o=function(c){var l=c.options,u=l.tooltip,d=l.xField,h=l.yField;return u||(0,At.set)(l,"tooltip",{title:!1,items:[function(g){return{name:g[d],value:g[h]}}]}),c};return(0,At.flow)(e,n,r,o,Fi,Kr)(t)}var rY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),iY=function(t){rY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{x:{padding:0}},animate:{enter:{type:"fadeIn"}},axis:!1,shapeField:"funnel",label:{position:"inside",transform:[{type:"contrastReverse"}]},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return nY},e}(zr);function oY(t){return(0,At.flow)(Fi,Kr)(t)}var aY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sY=function(t){aY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="line",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return oY},e}(zr);function IO(t){switch(typeof t){case"function":return t;case"string":return function(e){return(0,At.get)(e,[t])};default:return function(){return t}}}var es=function(){return es=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},es.apply(this,arguments)};function cY(t){var e=function(n){var r=n.options,o=r.angleField,c=r.data,l=r.label,u=r.tooltip,d=r.colorField,h=IO(d);if((0,At.isArray)(c)&&c.length>0){var g=c.reduce(function(_,b){return _+b[o]},0);if(g===0){var v=c.map(function(_){var b;return es(es({},_),(b={},b[o]=1,b))});if((0,At.set)(r,"data",v),l){var m=d===(0,At.get)(l,"text");(0,At.set)(r,"label",es(es({},l),m?{}:{formatter:function(){return 0}}))}u!==!1&&((0,At.isFunction)(u)?(0,At.set)(r,"tooltip",function(_,b,S){var w;return u(es(es({},_),(w={},w[o]=0,w)),b,S.map(function(E){var T;return es(es({},E),(T={},T[o]=0,T))}))}):(0,At.set)(r,"tooltip",es(es({},u),{items:[function(_,b,S){return{name:h(_,b,S),value:0}}]})))}else(0,At.set)(r,"tooltip",u),(0,At.set)(r,"label",l)}return n};return(0,At.flow)(e,Kr)(t)}var lY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),uY=function(t){lY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="pie",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"theta"},transform:[{type:"stackY",reverse:!0}],animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cY},e}(zr);function fY(t){return(0,At.flow)(Fi,Kr)(t)}var dY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hY=function(t){dY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="scatter",n}return e.getDefaultOptions=function(){return{axis:{y:{title:!1},x:{title:!1}},legend:{size:!1},children:[{type:"point"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return fY},e}(zr);function pY(t){var e=function(n){return(0,At.set)(n,"options.coordinate",{type:(0,At.get)(n,"options.coordinateType","polar")}),n};return(0,At.flow)(e,Kr)(t)}var gY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vY=function(t){gY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radar",n}return e.getDefaultOptions=function(){return{axis:{x:{grid:!0,line:!0},y:{zIndex:1,title:!1,line:!0,nice:!0}},meta:{x:{padding:.5,align:0}},interaction:{tooltip:{style:{crosshairsLineDash:[4,4]}}},children:[{type:"line"}],coordinateType:"polar"}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return pY},e}(zr);function mY(t){var e=function(n){var r=n.options,o=r.yField,c=r.children,l=r.style,u=l===void 0?{}:l,d=r.lineStyle,h=d===void 0?{}:d,g=o[0],v=o[1],m=o[2],_=o[3];return(0,At.set)(c,[0,"yField"],[m,_]),(0,At.set)(c,[0,"style"],h),(0,At.set)(c,[1,"yField"],[g,v]),(0,At.set)(c,[1,"style"],u),delete r.yField,delete r.lineStyle,delete r.style,n};return(0,At.flow)(e,Kr)(t)}var yY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_Y=["#26a69a","#999999","#ef5350"],bY=function(t){yY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="stock",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{domain:[-1,0,1],range:_Y},y:{nice:!0}},children:[{type:"link"},{type:"interval"}],axis:{x:{title:!1,grid:!1},y:{title:!1,grid:!0,gridLineDash:null}},animate:{enter:{type:"scaleInY"}},interaction:{tooltip:{shared:!0,marker:!1,groupName:!1,crosshairs:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return mY},e}(zr);function xY(t){return(0,At.flow)(Fi,Kr)(t)}var SY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wY=function(t){SY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyLine",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return xY},e}(zr);function OY(t){return(0,At.flow)(Fi,Kr)(t)}var EY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),AY=function(t){EY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyArea",n}return e.getDefaultOptions=function(){return{type:"view",animate:{enter:{type:"growInX",duration:500}},children:[{type:"area",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return OY},e}(zr);function TY(t){return(0,At.flow)(Fi,Kr)(t)}var MY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),CY=function(t){MY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyColumn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return TY},e}(zr),o7=function(){return o7=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},o7.apply(this,arguments)};function PY(t){var e=function(n){var r=n.options,o=r.percent,c=r.color,l=c===void 0?[]:c;if(!o)return n;var u={scale:{color:{range:l.length?l:[]}},data:[1,o]};return Object.assign(r,o7({},u)),n};return(0,At.flow)(e,Fi,Kr)(t)}var LY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),IY=function(t){LY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyProgress",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,tooltip:!1,children:[{interaction:{tooltip:!1},coordinate:{transform:[{type:"transpose"}]},type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return PY},e}(zr),a7=function(){return a7=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},a7.apply(this,arguments)};function RY(t){var e=function(r){var o=r.options,c=o.radius,l=c===void 0?.8:c;return(0,At.set)(r,"options.coordinate.innerRadius",l),r},n=function(r){var o=r.options,c=o.percent,l=o.color,u=l===void 0?[]:l;if(!c)return r;var d={scale:{color:{range:u.length?u:[]}},data:[1,c]};return Object.assign(o,a7({},d)),r};return(0,At.flow)(e,n,Fi,Kr)(t)}var kY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DY=function(t){kY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyRing",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,coordinate:{type:"theta"},animate:{enter:{type:"waveIn"}},interaction:{tooltip:!1},tooltip:!1,children:[{type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return RY},e}(zr);function NY(t){return(0,At.flow)(Kr)(t)}var FY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BY=function(t){FY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="rose",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"polar"},animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return NY},e}(zr),s7="__start__",Nu="__end__",c7="__waterfall_value__",RO=function(){return RO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},RO.apply(this,arguments)},jY=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))};function zY(t){var e=function(o){var c=o.options,l=c.data,u=l===void 0?[]:l,d=c.yField;return u.length&&(u.reduce(function(h,g,v){var m,_=IO(d),b=_(g,v,u);if(v===0||g.isTotal)g[s7]=0,g[Nu]=b,g[c7]=b;else{var S=(m=h[Nu])!==null&&m!==void 0?m:_(h,v,u);g[s7]=S,g[Nu]=S+b,g[c7]=h[Nu]}return g},[]),Object.assign(c,{yField:[s7,Nu]})),o},n=function(o){var c=o.options,l=c.data,u=l===void 0?[]:l,d=c.xField,h=c.children,g=c.linkStyle,v=jY([],u,!0);return v.reduce(function(m,_,b){return b>0&&(_.x1=m[d],_.x2=_[d],_.y1=m[Nu]),_},[]),v.shift(),h.push({type:"link",xField:["x1","x2"],yField:"y1",zIndex:-1,data:v,style:RO({stroke:"#697474"},g),label:!1,tooltip:!1}),o},r=function(o){var c=o.options,l=c.data,u=l===void 0?[]:l,d=c.connector;return d&&(0,At.set)(c,"connector",RO({xField:d.reverse?["x2","x1"]:["x1","x2"],yField:d.reverse?["y2","y1"]:["y1","y2"],data:[{x1:u[0].x,y1:u[0][Nu],x2:u[u.length-1].x,y2:u[u.length-1][Nu]}]},(0,At.isObject)(d)?d:{})),o};return(0,At.flow)(e,n,Fi,r,Kr)(t)}var UY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ZY=function(t){UY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="waterfall",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{field:c7,valueFormatter:"~s",name:"value"},axis:{y:{title:null,labelFormatter:"~s"},x:{title:null}},children:[{type:"interval",interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return zY},e}(zr);function HY(t){var e=function(n){var r=n.options,o=r.data,c=r.binNumber,l=r.binWidth,u=r.children,d=r.channel,h=d===void 0?"count":d,g=(0,At.get)(u,"[0].transform[0]",{});return(0,At.isNumber)(l)?((0,At.assign)(g,{thresholds:(0,At.ceil)((0,At.divide)(o.length,l)),y:h}),n):((0,At.isNumber)(c)&&(0,At.assign)(g,{thresholds:c,y:h}),n)};return(0,At.flow)(e,Fi,Kr)(t)}var WY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),VY=function(t){WY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Histogram",n}return e.getDefaultOptions=function(){return{type:"view",autoFit:!0,axis:{y:{title:!1},x:{title:!1}},children:[{type:"rect",transform:[{type:"binX",y:"count"}],interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return HY},e}(zr);function GY(t){var e=function(r){var o=r.options,c=o.tooltip,l=c===void 0?{}:c,u=o.colorField,d=o.sizeField;return l&&!l.field&&(l.field=u||d),r},n=function(r){var o=r.options,c=o.mark,l=o.children;return c&&(l[0].type=c),r};return(0,At.flow)(e,n,Fi,Kr)(t)}var $Y=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),YY=function(t){$Y(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="heatmap",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{valueFormatter:"~s"},axis:{y:{title:null,grid:!0},x:{title:null,grid:!0}},children:[{type:"point"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return GY},e}(zr);function XY(t){var e=function(n){var r=n.options.boxType,o=r===void 0?"box":r;return n.options.children[0].type=o,n};return(0,At.flow)(e,Fi,Kr)(t)}var qY=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),KY=function(t){qY(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="box",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"box"}],axis:{y:{title:!1},x:{title:!1}},tooltip:{items:[{name:"min",channel:"y"},{name:"q1",channel:"y1"},{name:"q2",channel:"y2"},{name:"q3",channel:"y3"},{name:"max",channel:"y4"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return XY},e}(zr),kO=function(t){var e=t.options,n=e.data;return(0,At.get)(n,"value")||(0,At.get)(n,"type")!=="fetch"&&(0,At.isPlainObject)(n)&&(0,At.set)(e,"data.value",n),t},QY=function(t){var e=t.options,n=e.data,r=[{type:"custom",callback:function(c){return{links:c}}}];if((0,At.isArray)(n))n.length>0?(0,At.set)(e,"data",{value:n,transform:r}):delete e.children;else if((0,At.get)(n,"type")==="fetch"&&(0,At.get)(n,"value")){var o=(0,At.get)(n,"transform");(0,At.isArray)(o)||(0,At.set)(n,"transform",r)}return t};function JY(t){return(0,At.flow)(kO,QY,Fi,Kr)(t)}var tX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),eX=function(t){tX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="sankey",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sankey"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return JY},e}(zr);function nX(t){var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}],t}function rX(t){nX(t);var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.children.forEach(function(r){var o;!((o=r==null?void 0:r.coordinate)===null||o===void 0)&&o.transform&&(r.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}])}),t}var Od=function(){return Od=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Od.apply(this,arguments)},DO=["#f0efff","#5B8FF9","#3D76DD"];function l7(t,e,n,r){r===void 0&&(r=!0);var o=0,c=!1,l=(0,At.map)(t,function(u){var d,h,g=(0,At.get)(u,[e]);if((0,At.isNil)(g))return[];if((0,At.isString)(g)){var v=Number(g);return isNaN(v)?[]:(d={},d[n]=u[n],d[e]=v,d)}return(0,At.isArray)(g)?(c=!0,o=Math.max(o,g.length),(0,At.map)(r?g.sort(function(m,_){return _-m}):g,function(m,_){var b;return b={},b[n]=u[n],b[e]=m,b.index=_,b})):(o=Math.max(1,o),h={},h[n]=u[n],h[e]=g,h)}).flat();return c?[l.map(function(u){return Od({index:0},u)}),o]:[l,o]}function u7(t,e){return new Array(t).fill("").map(function(n,r){return(0,At.isArray)(e)?e[r%e.length]:e})}function iX(t){var e=function(o){var c=o.options,l=c.color,u=c.rangeField,d=u===void 0?"ranges":u,h=c.measureField,g=h===void 0?"measures":h,v=c.targetField,m=v===void 0?"targets":v,_=c.xField,b=_===void 0?"title":_,S=c.mapField,w=c.data,E=l7(w,d,b),T=E[0],M=E[1],P=l7(w,g,b,!1),R=P[0],k=P[1],F=l7(w,m,b,!1),W=F[0],$=F[1],rt=(0,At.get)(l,[d],DO[0]),et=(0,At.get)(l,[g],DO[1]),ut=(0,At.get)(l,[m],DO[2]),J=[u7(M,rt),u7(k,et),u7($,ut)].flat();return c.children=(0,At.map)(c.children,function(lt,vt){var xt=[T,R,W][vt],Ht=[d,g,m][vt];return Od(Od({},lt),{data:xt,encode:Od(Od({},lt.encode||{}),{x:b,y:Ht,color:function(gt){var wt=gt.index,Wt=(0,At.isNumber)(wt)?"".concat(Ht,"_").concat(wt):Ht;return S?(0,At.get)(S,[Ht,wt],Wt):Wt}})})}),(0,At.set)(c,"scale.color.range",J),(0,At.get)(c,"legend.color")&&(0,At.isNil)((0,At.get)(c,"legend.color.itemMarker"))&&(c.legend.color.itemMarker=function(lt){return S&&(0,At.includes)(S==null?void 0:S[m],lt)||(lt==null?void 0:lt.replace(/\_\d$/,""))===m?"line":"square"}),o},n=function(o){var c=o.options.transpose,l=c===void 0?!0:c;return l||(0,At.set)(o,"options.children[2].shapeField","hyphen"),o},r=function(o){var c=o.options,l=c.range,u=l===void 0?{}:l,d=c.measure,h=d===void 0?{}:d,g=c.target,v=g===void 0?{}:g,m=c.children;return c.children=[u,h,v].map(function(_,b){return Du(m[b],_)}),o};return(0,At.flow)(e,n,r,rX,Kr)(t)}var oX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),aX=function(t){oX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="bullet",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{range:DO}},legend:{color:{itemMarker:function(n){return n==="targets"?"line":"square"}}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval",style:{maxWidth:30,zIndex:-2},axis:{y:{grid:!0,gridLineWidth:2}}},{type:"interval",style:{maxWidth:20,zIndex:-1},transform:[{type:"stackY"}]},{type:"point",encode:{size:8,shape:"line"}}],interaction:{tooltip:{shared:!0}},coordinate:{transform:[{type:"transpose"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return iX},e}(zr);function sX(t){var e=function(n){var r=n.options.data;return n.options.data={value:r},n};return(0,At.flow)(e,Fi,Kr)(t)}var cX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lX=function(t){cX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Gauge",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"gauge"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return sX},e}(zr);function uX(t){var e=function(n){var r=n.options.percent;return(0,At.isNumber)(r)&&((0,At.set)(n,"options.data",r),delete n.options.percent),n};return(0,At.flow)(e,Fi,Kr)(t)}var fX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dX=function(t){fX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Liquid",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"liquid"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return uX},e}(zr);function hX(t){return(0,At.flow)(Fi,Kr)(t)}var pX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),gX=function(t){pX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="WordCloud",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"wordCloud"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return hX},e}(zr);function vX(t){return(0,At.flow)(kO,Fi,Kr)(t)}var mX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),yX=function(t){mX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="treemap",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"treemap"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return vX},e}(zr),Fu=function(){return Fu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Fu.apply(this,arguments)},_X=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function bX(t){var e=function(o){var c=o.options,l=c.startAngle,u=c.maxAngle,d=c.coordinate,h=(0,At.isNumber)(l)?l/(2*Math.PI)*360:-90,g=(0,At.isNumber)(u)?(Number(u)+h)/180*Math.PI:Math.PI;return(0,At.set)(o,["options","coordinate"],Fu(Fu({},d),{endAngle:g,startAngle:l!=null?l:-Math.PI/2})),o},n=function(o){var c=o.options,l=c.tooltip,u=c.xField,d=c.yField,h=IO(u),g=IO(d);return l||(0,At.set)(c,"tooltip",{title:!1,items:[function(v,m,_){return{name:h(v,m,_),value:g(v,m,_)}}]}),o},r=function(o){var c=o.options,l=c.markBackground,u=c.children,d=c.scale,h=c.coordinate,g=c.xField,v=(0,At.get)(d,"y.domain",[]);if(l){var m=l.style,_=_X(l,["style"]);u.unshift(Fu({type:"interval",xField:g,yField:v[v.length-1],style:Fu({fillOpacity:.4,fill:"#e0e4ee"},m),coordinate:Fu(Fu({},h),{startAngle:-Math.PI/2,endAngle:1.5*Math.PI}),animate:!1},_))}return o};return(0,At.flow)(e,n,r,Fi,Kr)(t)}var xX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),SX=function(t){xX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radial",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"radial",innerRadius:.1,outerRadius:1,endAngle:Math.PI},animate:{enter:{type:"waveIn",duration:800}},axis:{y:{nice:!0,labelAutoHide:!0,labelAutoRotate:!1},x:{title:!1,nice:!0,labelAutoRotate:!1,labelAutoHide:{type:"equidistance",cfg:{minGap:6}}}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return bX},e}(zr);function wX(t){return(0,At.flow)(kO,Kr)(t)}var OX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),EX=function(t){OX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="CirclePacking",n}return e.getDefaultOptions=function(){return{legend:!1,type:"view",children:[{type:"pack",encode:{color:"depth"}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return wX},e}(zr),NO=function(){return NO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},NO.apply(this,arguments)};function f7(t,e){return t||e}function AX(t){var e=function(n){var r=n.options,o=r.xField,c=r.yField,l=r.colorField,u=r.seriesField,d=r.children,h=d==null?void 0:d.map(function(g){return NO(NO({},g),{xField:o,yField:c,seriesField:f7(u,l),colorField:f7(l,u),data:g.type==="density"?{transform:[{type:"kde",field:c,groupBy:[o,f7(u,l)]}]}:g.data})}).filter(function(g){return r.box||g.type==="density"});return(0,At.set)(r,"children",h),delete r.box,n};return(0,At.flow)(e,Fi,Kr)(t)}var TX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),MX=function(t){TX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="violin",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"density",sizeField:"size",tooltip:!1},{type:"boxplot",shapeField:"violin",style:{opacity:.5,point:!1}}],animate:{enter:{type:"fadeIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return AX},e}(zr),c1=function(){return c1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},c1.apply(this,arguments)},CX=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))};function PX(t){var e=function(c){var l=c.options,u=l.yField,d=l.children;return d.forEach(function(h,g){(0,At.set)(h,"yField",u[g])}),c},n=function(c){var l=c.options,u=l.yField,d=l.children,h=l.data;if((0,At.isPlainObject)(h))return c;var g=(0,At.isArray)((0,At.get)(h,[0]))?h:[h,h];return d.forEach(function(v,m){(0,At.set)(v,"data",CX([],g[m].map(function(_){return c1({groupKey:u[m]},_)}),!0))}),c},r=function(c){var l=c.options,u=l.yField,d=u[0],h=u[1],g=l.tooltip;return g||(0,At.set)(l,"tooltip",{items:[{field:d,value:d},{field:h,value:h}]}),c},o=function(c){var l=c.options,u=l.children,d=l.layout,h=l.coordinate.transform,g=l.paddingBottom,v=g===void 0?lF:g,m=l.paddingLeft,_=m===void 0?lF:m,b=l.axis;(0,At.set)(l,"axisText",c1(c1({},(b==null?void 0:b.x)||{}),{layout:d}));var S=u[0],w=u[1];if(d==="vertical")(0,At.set)(l,"direction","col"),(0,At.set)(l,"paddingLeft",_),(0,At.set)(l,"coordinate.transform",h.filter(function(R){return R.type!=="transpose"})),(0,At.set)(S,"paddingBottom",cF),(0,At.set)(w,"paddingTop",cF),(0,At.set)(w,"axis.x.position","top"),(0,At.set)(w,"scale.y.range",[0,1]);else{(0,At.set)(l,"paddingBottom",v),(0,At.set)(S,"scale.y.range",[0,1]);var E=S.paddingRight,T=E===void 0?r7:E,M=w.paddingLeft,P=M===void 0?r7:M;(0,At.set)(S,"paddingRight",T),(0,At.set)(S,"axis.x.position","right"),(0,At.set)(w,"paddingLeft",P)}return c};return(0,At.flow)(e,n,r,o,Fi,Kr)(t)}var LX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),IX=function(t){LX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="BidirectionalBar",n}return e.getDefaultOptions=function(){return{type:"spaceFlex",coordinate:{transform:[{type:"transpose"}]},scale:{y:{nice:!0}},direction:"row",layout:"horizontal",legend:!1,axis:{y:{title:!1},x:{title:!1,label:!1}},children:[{type:"interval"},{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return PX},e}(zr),Bu;(function(t){t.color="key",t.d="path"})(Bu||(Bu={}));function RX(t){var e=function(n){var r=n.options,o=r.data,c=r.setsField,l=r.sizeField;return(0,At.isArray)(o)&&((0,At.set)(r,"data",{type:"inline",value:o,transform:[{type:"venn",sets:c,size:l,as:[Bu.color,Bu.d]}]}),(0,At.set)(r,"colorField",Bu.color),(0,At.set)(r,["children","0","encode","d"],Bu.d)),n};return(0,At.flow)(e,Kr)(t)}var kX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DX=function(t){kX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="venn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"path"}],legend:{color:{itemMarker:"circle"}},encode:{color:Bu.color,d:Bu.d}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return RX},e}(zr);function NX(t){return(0,At.flow)(kO,Kr)(t)}var FX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BX=function(t){FX(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Sunburst",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sunburst"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return NX},e}(zr),jX={Base:U$,Line:sY,Column:J$,Pie:uY,Area:$$,Bar:q$,DualAxes:hF,Funnel:iY,Scatter:hY,Radar:vY,Rose:BY,Stock:bY,TinyLine:wY,TinyArea:AY,TinyColumn:CY,TinyProgress:IY,TinyRing:DY,Waterfall:ZY,Histogram:VY,Heatmap:YY,Box:KY,Sankey:eX,Bullet:aX,Gauge:lX,Liquid:dX,WordCloud:gX,Treemap:yX,RadialBar:SX,CirclePacking:EX,Violin:MX,BidirectionalBar:IX,Venn:DX,Mix:hF,Sunburst:BX},l1=function(){return l1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},l1.apply(this,arguments)},pF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},zX=(0,G.forwardRef)(function(t,e){var n=t.chartType,r=n===void 0?"Base":n,o=pF(t,["chartType"]),c=o.containerStyle,l=c===void 0?{height:"inherit",flex:1}:c,u=o.containerAttributes,d=u===void 0?{}:u,h=o.className,g=o.loading,v=o.loadingTemplate,m=o.errorTemplate,_=o.onReady,b=pF(o,["containerStyle","containerAttributes","className","loading","loadingTemplate","errorTemplate","onReady"]),S=ne(jX[r],l1(l1({},b),{onReady:function(T){e&&(typeof e=="function"?e(T):e.current=T),_==null||_(T)}})),w=S.chart,E=S.container;return G.createElement(qt,{errorTemplate:m},g&&G.createElement(nt,{loadingTemplate:v,theme:o.theme,loading:g}),G.createElement("div",l1({className:h,style:l,ref:E},d)))}),UX=(0,G.createContext)({});function ZX(){return(0,G.useContext)(UX)}var d7=function(){return d7=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},d7.apply(this,arguments)};function HX(t){var e=t.yField,n=t.data,r=(0,At.isArray)(n)&&n.length>0&&(0,At.isString)(e)&&!(0,At.get)(t,"scale.y.domainMax"),o=Object.isFrozen(t)?d7({},t):t;return r&&n.reduce(function(c,l){return c+l[e]},0)===0?(0,At.set)(o,"scale.y.domainMax",1):r&&n.reduce(function(c,l){return c+l[e]},0)!==0&&(0,At.set)(o,"scale.y.domainMax",void 0),o}var u1=function(){return u1=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},u1.apply(this,arguments)};function WX(t){var e=t.charAt(0).toLowerCase()+t.slice(1);return(0,G.forwardRef)(function(n,r){var o,c,l=ZX(),u=(0,G.useMemo)(function(){return t.charAt(0).toLowerCase()+t.slice(1)},[t]),d=(0,At.flow)([HX])(n),h=u1(u1({},(o=l==null?void 0:l.common)!==null&&o!==void 0?o:{}),(c=l==null?void 0:l[u])!==null&&c!==void 0?c:{});return G.createElement(zX,u1({},h,d,{chartType:t,ref:r}))})}},17816:function($t,Qt){(function(L,Y){Y(Qt)})(this,function(L){"use strict";function Y(ft){var _t=typeof Symbol=="function"&&Symbol.iterator,ee=_t&&ft[_t],pe=0;if(ee)return ee.call(ft);if(ft&&typeof ft.length=="number")return{next:function(){return{value:(ft=ft&&pe>=ft.length?void 0:ft)&&ft[pe++],done:!ft}}};throw new TypeError(_t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Z(ft,_t){var ee=typeof Symbol=="function"&&ft[Symbol.iterator];if(!ee)return ft;var pe,Ie,je=ee.call(ft),Oe=[];try{for(;(_t===void 0||0<_t--)&&!(pe=je.next()).done;)Oe.push(pe.value)}catch(Ee){Ie={error:Ee}}finally{try{pe&&!pe.done&&(ee=je.return)&&ee.call(je)}finally{if(Ie)throw Ie.error}}return Oe}function tt(ft,_t,ee){if(ee||arguments.length===2)for(var pe,Ie=0,je=_t.length;Ie<je;Ie++)!pe&&Ie in _t||((pe=pe||Array.prototype.slice.call(_t,0,Ie))[Ie]=_t[Ie]);return ft.concat(pe||Array.prototype.slice.call(_t))}function yt(ft){return Ot(ft,"Function")}var G={}.toString,Ot=function(ft,_t){return G.call(ft)==="[object "+_t+"]"},bt=function(ft){return Array.isArray?Array.isArray(ft):Ot(ft,"Array")},Et=function(ft){if(typeof(_t=ft)!="object"||_t===null||!Ot(ft,"Object"))return!1;var _t;if(Object.getPrototypeOf(ft)===null)return!0;for(var ee=ft;Object.getPrototypeOf(ee)!==null;)ee=Object.getPrototypeOf(ee);return Object.getPrototypeOf(ft)===ee},pt=function(ft){return Ot(ft,"Number")},Vt=Object.values?function(ft){return Object.values(ft)}:function(ft){var _t,ee=[],pe=ft,Ie=function(Ve,$e){yt(ft)&&$e==="prototype"||ee.push(Ve)};if(pe){if(bt(pe))for(var je=0,Oe=pe.length;je<Oe&&Ie(pe[je],je)!==!1;je++);else if(_t=typeof pe,pe!==null&&_t=="object"||_t=="function"){for(var Ee in pe)if(pe.hasOwnProperty(Ee)&&Ie(pe[Ee],Ee)===!1)break}}return ee},K=5;function X(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];for(var pe=0;pe<_t.length;pe+=1)(function Ie(je,Oe,Ee,Ve){for(var $e in Ee=Ee||0,Ve=Ve||K,Oe){var pn;Oe.hasOwnProperty($e)&&((pn=Oe[$e])!==null&&Et(pn)?(Et(je[$e])||(je[$e]={}),Ee<Ve?Ie(je[$e],pn,Ee+1,Ve):je[$e]=Oe[$e]):bt(pn)?(je[$e]=[],je[$e]=je[$e].concat(pn)):pn!==void 0&&(je[$e]=pn))}})(ft,_t[pe]);return ft}function Zt(ft){return ft}(function(ft,_t){var ee;if(yt(ft))return(ee=function(){for(var pe=[],Ie=0;Ie<arguments.length;Ie++)pe[Ie]=arguments[Ie];var je,Oe=_t?_t.apply(this,pe):pe[0],Ee=ee.cache;return Ee.has(Oe)?Ee.get(Oe):(je=ft.apply(this,pe),Ee.set(Oe,je),je)}).cache=new Map;throw new TypeError("Expected a function")})(function(ft,Oe){var ee=(Oe=Oe===void 0?{}:Oe).fontSize,pe=Oe.fontFamily,Ie=Oe.fontWeight,je=Oe.fontStyle,Oe=Oe.fontVariant;return(Mt=Mt||document.createElement("canvas").getContext("2d")).font=[je,Oe,Ie,ee+"px",pe].join(" "),Mt.measureText(Ot(ft,"String")?ft:"").width},function(ft,_t){return function(){for(var ee=0,pe=0,Ie=arguments.length;pe<Ie;pe++)ee+=arguments[pe].length;for(var je=Array(ee),Oe=0,pe=0;pe<Ie;pe++)for(var Ee=arguments[pe],Ve=0,$e=Ee.length;Ve<$e;Ve++,Oe++)je[Oe]=Ee[Ve];return je}([ft],Vt(_t=_t===void 0?{}:_t)).join("")});var Mt,zt=typeof Float32Array!="undefined"?Float32Array:Array;function Rt(){var ft=new zt(9);return zt!=Float32Array&&(ft[1]=0,ft[2]=0,ft[3]=0,ft[5]=0,ft[6]=0,ft[7]=0),ft[0]=1,ft[4]=1,ft[8]=1,ft}Math.hypot||(Math.hypot=function(){for(var ft=0,_t=arguments.length;_t--;)ft+=arguments[_t]*arguments[_t];return Math.sqrt(ft)});var Gt=function(ft,Sn,Ln){var pe=Sn[0],Ie=Sn[1],je=Sn[2],Oe=Sn[3],Ee=Sn[4],Ve=Sn[5],$e=Sn[6],pn=Sn[7],Sn=Sn[8],Dn=Ln[0],vn=Ln[1],Mn=Ln[2],Pn=Ln[3],yn=Ln[4],$n=Ln[5],kn=Ln[6],Vn=Ln[7],Ln=Ln[8];return ft[0]=Dn*pe+vn*Oe+Mn*$e,ft[1]=Dn*Ie+vn*Ee+Mn*pn,ft[2]=Dn*je+vn*Ve+Mn*Sn,ft[3]=Pn*pe+yn*Oe+$n*$e,ft[4]=Pn*Ie+yn*Ee+$n*pn,ft[5]=Pn*je+yn*Ve+$n*Sn,ft[6]=kn*pe+Vn*Oe+Ln*$e,ft[7]=kn*Ie+Vn*Ee+Ln*pn,ft[8]=kn*je+Vn*Ve+Ln*Sn,ft};function ve(){var ft=new zt(16);return zt!=Float32Array&&(ft[1]=0,ft[2]=0,ft[3]=0,ft[4]=0,ft[6]=0,ft[7]=0,ft[8]=0,ft[9]=0,ft[11]=0,ft[12]=0,ft[13]=0,ft[14]=0),ft[0]=1,ft[5]=1,ft[10]=1,ft[15]=1,ft}var Me=function(ft,kn,ee){var pe=kn[0],Ie=kn[1],je=kn[2],Oe=kn[3],Ee=kn[4],Ve=kn[5],$e=kn[6],pn=kn[7],Sn=kn[8],Dn=kn[9],vn=kn[10],Mn=kn[11],Pn=kn[12],yn=kn[13],$n=kn[14],kn=kn[15],Vn=ee[0],Ln=ee[1],zn=ee[2],ir=ee[3];return ft[0]=Vn*pe+Ln*Ee+zn*Sn+ir*Pn,ft[1]=Vn*Ie+Ln*Ve+zn*Dn+ir*yn,ft[2]=Vn*je+Ln*$e+zn*vn+ir*$n,ft[3]=Vn*Oe+Ln*pn+zn*Mn+ir*kn,Vn=ee[4],Ln=ee[5],zn=ee[6],ir=ee[7],ft[4]=Vn*pe+Ln*Ee+zn*Sn+ir*Pn,ft[5]=Vn*Ie+Ln*Ve+zn*Dn+ir*yn,ft[6]=Vn*je+Ln*$e+zn*vn+ir*$n,ft[7]=Vn*Oe+Ln*pn+zn*Mn+ir*kn,Vn=ee[8],Ln=ee[9],zn=ee[10],ir=ee[11],ft[8]=Vn*pe+Ln*Ee+zn*Sn+ir*Pn,ft[9]=Vn*Ie+Ln*Ve+zn*Dn+ir*yn,ft[10]=Vn*je+Ln*$e+zn*vn+ir*$n,ft[11]=Vn*Oe+Ln*pn+zn*Mn+ir*kn,Vn=ee[12],Ln=ee[13],zn=ee[14],ir=ee[15],ft[12]=Vn*pe+Ln*Ee+zn*Sn+ir*Pn,ft[13]=Vn*Ie+Ln*Ve+zn*Dn+ir*yn,ft[14]=Vn*je+Ln*$e+zn*vn+ir*$n,ft[15]=Vn*Oe+Ln*pn+zn*Mn+ir*kn,ft};function Ue(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];return ft?_t.reduce(function(pe,Ie){return function(je){return Ie(pe(je))}},ft):Zt}function Ke(ft){return ft instanceof Float32Array||ft instanceof Array}function we(ft,_t,ee){for(;ft<_t;)ft+=2*Math.PI;for(;ee<ft;)ft-=2*Math.PI;return ft}at=new zt(3),zt!=Float32Array&&(at[0]=0,at[1]=0,at[2]=0),at=new zt(4),zt!=Float32Array&&(at[0]=0,at[1]=0,at[2]=0,at[3]=0);function Ut(Oe,_t,ee,pe,Ie){var je=(Oe=Z(Oe,2))[0],Oe=Oe[1],Ee=Rt();return je=[je,Oe],(Oe=Ee)[0]=1,Oe[1]=0,Oe[2]=0,Oe[3]=0,Oe[4]=1,Oe[5]=0,Oe[6]=je[0],Oe[7]=je[1],Oe[8]=1,Oe}function nt(ft,..._t){return _t.reduce((ee,pe)=>Ie=>ee(pe(Ie)),ft)}function ie(ft,_t){return _t-ft?ee=>(ee-ft)/(_t-ft):ee=>.5}const qt=Math.sqrt(50),At=Math.sqrt(10),Pe=Math.sqrt(2);function it(ft,_t,ee){return _t=(_t-ft)/Math.max(0,ee),ft=Math.floor(Math.log(_t)/Math.LN10),ee=_t/Ai(10,ft),0<=ft?(ee>=qt?10:ee>=At?5:ee>=Pe?2:1)*Ai(10,ft):-Ai(10,-ft)/(ee>=qt?10:ee>=At?5:ee>=Pe?2:1)}const Pt=(ft,_t,ee=5)=>{ft=[ft,_t];let pe=0,Ie=ft.length-1,je=ft[pe],Oe=ft[Ie],Ee;return Oe<je&&([je,Oe]=[Oe,je],[pe,Ie]=[Ie,pe]),0<(Ee=it(je,Oe,ee))?(je=Math.floor(je/Ee)*Ee,Oe=Math.ceil(Oe/Ee)*Ee,Ee=it(je,Oe,ee)):Ee<0&&(je=Math.ceil(je*Ee)/Ee,Oe=Math.floor(Oe*Ee)/Ee,Ee=it(je,Oe,ee)),0<Ee?(ft[pe]=Math.floor(je/Ee)*Ee,ft[Ie]=Math.ceil(Oe/Ee)*Ee):Ee<0&&(ft[pe]=Math.ceil(je*Ee)/Ee,ft[Ie]=Math.floor(Oe*Ee)/Ee),ft};function q(ft){return ft!=null&&!Number.isNaN(ft)}function Nt(ft,_t){return ee=>{ee.prototype.rescale=function(){this.initRange(),this.nice();var[pe]=this.chooseTransforms();this.composeOutput(pe,this.chooseClamp(pe))},ee.prototype.initRange=function(){var pe=this.options.interpolator;this.options.range=ft(pe)},ee.prototype.composeOutput=function(pe,Ie){var je,{domain:Ee,interpolator:Oe,round:Ve}=this.getOptions(),Ee=_t(Ee.map(pe)),Ve=Ve?(je=Oe,$e=>($e=je($e),pt($e)?Math.round($e):$e)):Oe;this.output=nt(Ve,Ee,Ie,pe)},ee.prototype.invert=void 0}}var It,at={exports:{}},H={exports:{}},U=function(ft){return!(!ft||typeof ft=="string")&&(ft instanceof Array||Array.isArray(ft)||0<=ft.length&&(ft.splice instanceof Function||Object.getOwnPropertyDescriptor(ft,ft.length-1)&&ft.constructor.name!=="String"))},ht=Array.prototype.concat,ne=Array.prototype.slice,xe=H.exports=function(ft){for(var _t=[],ee=0,pe=ft.length;ee<pe;ee++){var Ie=ft[ee];U(Ie)?_t=ht.call(_t,ne.call(Ie)):_t.push(Ie)}return _t},_e=(xe.wrap=function(ft){return function(){return ft(xe(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Xe=H.exports,Re=Object.hasOwnProperty,un=Object.create(null);for(It in _e)Re.call(_e,It)&&(un[_e[It]]=It);var cn=at.exports={to:{},get:{}};function Jt(ft,_t,ee){return Math.min(Math.max(_t,ft),ee)}function ct(ft){return ft=Math.round(ft).toString(16).toUpperCase(),ft.length<2?"0"+ft:ft}cn.get=function(ft){var _t,ee;switch(ft.substring(0,3).toLowerCase()){case"hsl":_t=cn.get.hsl(ft),ee="hsl";break;case"hwb":_t=cn.get.hwb(ft),ee="hwb";break;default:_t=cn.get.rgb(ft),ee="rgb"}return _t?{model:ee,value:_t}:null},cn.get.rgb=function(ft){if(!ft)return null;var _t,ee,pe,Ie=[0,0,0,1];if(_t=ft.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(pe=_t[2],_t=_t[1],ee=0;ee<3;ee++){var je=2*ee;Ie[ee]=parseInt(_t.slice(je,2+je),16)}pe&&(Ie[3]=parseInt(pe,16)/255)}else if(_t=ft.match(/^#([a-f0-9]{3,4})$/i)){for(pe=(_t=_t[1])[3],ee=0;ee<3;ee++)Ie[ee]=parseInt(_t[ee]+_t[ee],16);pe&&(Ie[3]=parseInt(pe+pe,16)/255)}else{if(_t=ft.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(ee=0;ee<3;ee++)Ie[ee]=parseInt(_t[ee+1],0);else{if(!(_t=ft.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(_t=ft.match(/^(\w+)$/))?_t[1]==="transparent"?[0,0,0,0]:Re.call(_e,_t[1])?((Ie=_e[_t[1]])[3]=1,Ie):null:null;for(ee=0;ee<3;ee++)Ie[ee]=Math.round(2.55*parseFloat(_t[ee+1]))}_t[4]&&(_t[5]?Ie[3]=.01*parseFloat(_t[4]):Ie[3]=parseFloat(_t[4]))}for(ee=0;ee<3;ee++)Ie[ee]=Jt(Ie[ee],0,255);return Ie[3]=Jt(Ie[3],0,1),Ie},cn.get.hsl=function(ft){var _t;return(ft=ft&&ft.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(_t=parseFloat(ft[4]),[(parseFloat(ft[1])%360+360)%360,Jt(parseFloat(ft[2]),0,100),Jt(parseFloat(ft[3]),0,100),Jt(isNaN(_t)?1:_t,0,1)]):null},cn.get.hwb=function(ft){var _t;return(ft=ft&&ft.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(_t=parseFloat(ft[4]),[(parseFloat(ft[1])%360+360)%360,Jt(parseFloat(ft[2]),0,100),Jt(parseFloat(ft[3]),0,100),Jt(isNaN(_t)?1:_t,0,1)]):null},cn.to.hex=function(){var ft=Xe(arguments);return"#"+ct(ft[0])+ct(ft[1])+ct(ft[2])+(ft[3]<1?ct(Math.round(255*ft[3])):"")},cn.to.rgb=function(){var ft=Xe(arguments);return ft.length<4||ft[3]===1?"rgb("+Math.round(ft[0])+", "+Math.round(ft[1])+", "+Math.round(ft[2])+")":"rgba("+Math.round(ft[0])+", "+Math.round(ft[1])+", "+Math.round(ft[2])+", "+ft[3]+")"},cn.to.rgb.percent=function(){var ft=Xe(arguments),_t=Math.round(ft[0]/255*100),ee=Math.round(ft[1]/255*100),pe=Math.round(ft[2]/255*100);return ft.length<4||ft[3]===1?"rgb("+_t+"%, "+ee+"%, "+pe+"%)":"rgba("+_t+"%, "+ee+"%, "+pe+"%, "+ft[3]+")"},cn.to.hsl=function(){var ft=Xe(arguments);return ft.length<4||ft[3]===1?"hsl("+ft[0]+", "+ft[1]+"%, "+ft[2]+"%)":"hsla("+ft[0]+", "+ft[1]+"%, "+ft[2]+"%, "+ft[3]+")"},cn.to.hwb=function(){var ft=Xe(arguments),_t="";return 4<=ft.length&&ft[3]!==1&&(_t=", "+ft[3]),"hwb("+ft[0]+", "+ft[1]+"%, "+ft[2]+"%"+_t+")"},cn.to.keyword=function(ft){return un[ft.slice(0,3)]};var Ct=at.exports;function me(ft,_t,ee){let pe=ee;return pe<0&&(pe+=1),1<pe&&--pe,pe<1/6?ft+6*(_t-ft)*pe:pe<.5?_t:pe<2/3?ft+(_t-ft)*(2/3-pe)*6:ft}function he(Ie){var _t,ee,pe,Ie=Ct.get(Ie);return Ie?({model:Ie,value:_t}=Ie,Ie==="rgb"?_t:Ie==="hsl"?(_t=(Ie=_t)[0]/360,ee=Ie[1]/100,pe=Ie[2]/100,Ie=Ie[3],ee==0?[255*pe,255*pe,255*pe,Ie]:[255*me(ee=2*pe-(pe=pe<.5?pe*(1+ee):pe+ee-pe*ee),pe,_t+1/3),255*me(ee,pe,_t),255*me(ee,pe,_t-1/3),Ie]):null):null}const Tt=(ft,_t)=>ee=>ft*(1-ee)+_t*ee,re=(ft,_t)=>{if(typeof ft=="number"&&typeof _t=="number")return Tt(ft,_t);if(typeof ft!="string"||typeof _t!="string")return()=>ft;{var ee=ft,pe=_t;const Ie=he(ee),je=he(pe);return Ie===null||je===null?Ie?()=>ee:()=>pe:Oe=>{var Ee=new Array(4);for(let Mn=0;Mn<4;Mn+=1){var Ve=Ie[Mn],$e=je[Mn];Ee[Mn]=Ve*(1-Oe)+$e*Oe}var[pn,Sn,Dn,vn]=Ee;return`rgba(${Math.round(pn)}, ${Math.round(Sn)}, ${Math.round(Dn)}, ${vn})`}}},Yt=(ft,_t)=>{const ee=Tt(ft,_t);return pe=>Math.round(ee(pe))};function N({map:ft,initKey:_t},ee){return _t=_t(ee),ft.has(_t)?ft.get(_t):ee}function kt(ft){return typeof ft=="object"?ft.valueOf():ft}class oe extends Map{constructor(_t){if(super(),this.map=new Map,this.initKey=kt,_t!==null)for(var[ee,pe]of _t)this.set(ee,pe)}get(_t){return super.get(N({map:this.map,initKey:this.initKey},_t))}has(_t){return super.has(N({map:this.map,initKey:this.initKey},_t))}set(_t,ee){return super.set(([{map:_t,initKey:pe},Ie]=[{map:this.map,initKey:this.initKey},_t],pe=pe(Ie),_t.has(pe)?_t.get(pe):(_t.set(pe,Ie),Ie)),ee);var pe,Ie}delete(_t){return super.delete(([{map:_t,initKey:ee},pe]=[{map:this.map,initKey:this.initKey},_t],ee=ee(pe),_t.has(ee)&&(pe=_t.get(ee),_t.delete(ee)),pe));var ee,pe}}class C{constructor(_t){this.options=X({},this.getDefaultOptions()),this.update(_t)}getOptions(){return this.options}update(_t={}){this.options=X({},this.options,_t),this.rescale(_t)}rescale(_t){}}const z=Symbol("defaultUnknown");function Ft(ft,_t,ee){for(let pe=0;pe<_t.length;pe+=1)ft.has(_t[pe])||ft.set(ee(_t[pe]),pe)}function te(_t){var{value:_t,from:ee,to:pe,mapper:Ie,notFoundReturn:je}=_t;let Oe=Ie.get(_t);if(Oe===void 0){if(je!==z)return je;Oe=ee.push(_t)-1,Ie.set(_t,Oe)}return pe[Oe%pe.length]}function se(ft){return ft instanceof Date?_t=>""+_t:typeof ft=="object"?_t=>JSON.stringify(_t):_t=>_t}class Se extends C{getDefaultOptions(){return{domain:[],range:[],unknown:z}}constructor(_t){super(_t)}map(_t){return this.domainIndexMap.size===0&&Ft(this.domainIndexMap,this.getDomain(),this.domainKey),te({value:this.domainKey(_t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(_t){return this.rangeIndexMap.size===0&&Ft(this.rangeIndexMap,this.getRange(),this.rangeKey),te({value:this.rangeKey(_t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(_t){var[ee]=this.options.domain,[pe]=this.options.range;this.domainKey=se(ee),this.rangeKey=se(pe),this.rangeIndexMap?(_t&&!_t.range||this.rangeIndexMap.clear(),_t&&!_t.domain&&!_t.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new Se(this.options)}getRange(){return this.options.range}getDomain(){var _t,ee;return this.sortedDomain||({domain:_t,compare:ee}=this.options,this.sortedDomain=ee?[..._t].sort(ee):_t),this.sortedDomain}}function be(yn){const{domain:_t,range:ee,paddingOuter:pe,paddingInner:Ie,flex:je,round:Oe,align:Ee}=yn;var Ve=_t.length,vn=0<(vn=(yn=Ve)-($e=je).length)?[...$e,...new Array(vn).fill(1)]:vn<0?$e.slice(0,yn):$e,[yn,$e]=ee,$e=$e-yn,Pn=$e/(2/Ve*pe+1-1/Ve*Ie);const pn=Pn*Ie/Ve;Pn-=Ve*pn;const Sn=function(Ln){const zn=Math.min(...Ln);return Ln.map(ir=>ir/zn)}(vn),Dn=Pn/Sn.reduce((Ln,zn)=>Ln+zn);var vn=new oe(_t.map((Ln,zn)=>(zn=Sn[zn]*Dn,[Ln,Oe?Math.floor(zn):zn]))),Mn=new oe(_t.map((Ln,zn)=>(zn=Sn[zn]*Dn+pn,[Ln,Oe?Math.floor(zn):zn]))),Pn=Array.from(Mn.values()).reduce((Ln,zn)=>Ln+zn),yn=yn+($e-(Pn-Pn/Ve*Ie))*Ee;let $n=Oe?Math.round(yn):yn;var kn=new Array(Ve);for(let Ln=0;Ln<Ve;Ln+=1){kn[Ln]=(Vn=$n,Math.round(1e12*Vn)/1e12);var Vn=_t[Ln];$n+=Mn.get(Vn)}return{valueBandWidth:vn,valueStep:Mn,adjustedRange:kn}}class Ze extends Se{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:z,flex:[]}}constructor(_t){super(_t)}clone(){return new Ze(this.options)}getStep(_t){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:_t===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(_t)}getBandWidth(_t){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:_t===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(_t)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:_t,paddingInner:ee}=this.options;return 0<_t?_t:ee}getPaddingOuter(){var{padding:_t,paddingOuter:ee}=this.options;return 0<_t?_t:ee}rescale(){super.rescale();var{align:pe,domain:_t,range:Ie,round:je,flex:ee}=this.options,{adjustedRange:pe,valueBandWidth:Ie,valueStep:je}=function($e){var Ee=$e.domain;if((Ee=Ee.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((Ve=$e.flex)==null||!Ve.length))return be($e);var{range:Ve,paddingOuter:$e,paddingInner:pn,round:Sn,align:Dn}=$e;let vn,Mn,Pn=Ve[0];return Ve=Ve[1]-Pn,vn=Ve/Math.max(1,2*$e+(Ee-pn)),Sn&&(vn=Math.floor(vn)),Pn+=(Ve-vn*(Ee-pn))*Dn,Mn=vn*(1-pn),Sn&&(Pn=Math.round(Pn),Mn=Math.round(Mn)),$e=new Array(Ee).fill(0).map((yn,$n)=>Pn+$n*vn),{valueStep:vn,valueBandWidth:Mn,adjustedRange:$e}}({align:pe,range:Ie,round:je,flex:ee,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:_t});this.valueStep=je,this.valueBandWidth=Ie,this.adjustedRange=pe}}const tn=(ft,_t,ee)=>{let pe,Ie,je=ft,Oe=_t;if(je===Oe&&0<ee)return[je];let Ee=it(je,Oe,ee);if(Ee===0||!Number.isFinite(Ee))return[];if(0<Ee){je=Math.ceil(je/Ee),Oe=Math.floor(Oe/Ee),Ie=new Array(pe=Math.ceil(Oe-je+1));for(let Ve=0;Ve<pe;Ve+=1)Ie[Ve]=(je+Ve)*Ee}else{Ee=-Ee,je=Math.ceil(je*Ee),Oe=Math.floor(Oe*Ee),Ie=new Array(pe=Math.ceil(Oe-je+1));for(let Ve=0;Ve<pe;Ve+=1)Ie[Ve]=(je+Ve)/Ee}return Ie},Ge=(pe,je,ee)=>{var[pe,Ie]=pe,[je,Oe]=je;let Ee,Ve;return nt(Ve=pe<Ie?(Ee=ie(pe,Ie),ee(je,Oe)):(Ee=ie(Ie,pe),ee(Oe,je)),Ee)},Be=(ft,_t,ee)=>{const pe=Math.min(ft.length,_t.length)-1,Ie=new Array(pe),je=new Array(pe);var Oe=ft[0]>ft[pe],Ee=Oe?[...ft].reverse():ft,Ve=Oe?[..._t].reverse():_t;for(let $e=0;$e<pe;$e+=1)Ie[$e]=ie(Ee[$e],Ee[$e+1]),je[$e]=ee(Ve[$e],Ve[$e+1]);return $e=>{var pn=function(Dn,vn,Mn,Pn,yn){let $n=Mn||0,kn=Pn||Dn.length;for(var Vn=yn||(zn=>zn);$n<kn;){var Ln=Math.floor(($n+kn)/2);Vn(Dn[Ln])>vn?kn=Ln:$n=Ln+1}return $n}(ft,$e,1,pe)-1,Sn=Ie[pn];return nt(je[pn],Sn)($e)}},jt=(ft,_t,ee,pe)=>(2<Math.min(ft.length,_t.length)?Be:Ge)(ft,_t,pe?Yt:ee);class ce extends C{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Tt,tickCount:5}}map(_t){return q(_t)?this.output(_t):this.options.unknown}invert(_t){return q(_t)?this.input(_t):this.options.unknown}nice(){var _t,ee,pe,Ie;this.options.nice&&([_t,ee,pe,...Ie]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(_t,ee,pe,...Ie))}getTicks(){var _t=this.options.tickMethod,[ee,pe,Ie,...je]=this.getTickMethodOptions();return _t(ee,pe,Ie,...je)}getTickMethodOptions(){var{domain:_t,tickCount:ee}=this.options;return[_t[0],_t[_t.length-1],ee]}chooseNice(){return Pt}rescale(){this.nice();var[_t,ee]=this.chooseTransforms();this.composeOutput(_t,this.chooseClamp(_t)),this.composeInput(_t,ee,this.chooseClamp(ee))}chooseClamp(pe){var{clamp:ee,range:Ie}=this.options,pe=this.options.domain.map(pe),Ie=Math.min(pe.length,Ie.length);if(ee){ee=pe[0],pe=pe[Ie-1];const je=pe<ee?pe:ee,Oe=pe<ee?ee:pe;return Ee=>Math.min(Math.max(je,Ee),Oe)}return Zt}composeOutput(_t,ee){var{domain:Oe,range:pe,round:Ie,interpolate:je}=this.options,Oe=jt(Oe.map(_t),pe,je,Ie);this.output=nt(Oe,ee,_t)}composeInput(_t,ee,pe){var{domain:Ie,range:je}=this.options,je=jt(je,Ie.map(_t),Tt);this.input=nt(ee,pe,je)}}class ae extends ce{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:re,tickMethod:tn,tickCount:5}}chooseTransforms(){return[Zt,Zt]}clone(){return new ae(this.options)}}class ye extends Ze{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:z,paddingInner:1,paddingOuter:0}}constructor(_t){super(_t)}getPaddingInner(){return 1}clone(){return new ye(this.options)}update(_t){super.update(_t)}getPaddingOuter(){return this.options.padding}}function st(ft,_t){for(var ee=[],pe=0,Ie=ft.length;pe<Ie;pe++)ee.push(ft[pe].substr(0,_t));return ee}var D,H=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],at=["January","February","March","April","May","June","July","August","September","October","November","December"],St=st(at,3);(function(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];for(var pe=0,Ie=_t;pe<Ie.length;pe++){var je,Oe=Ie[pe];for(je in Oe)ft[je]=Oe[je]}})({},{dayNamesShort:st(H,3),dayNames:H,monthNamesShort:St,monthNames:at,amPm:["am","pm"],DoFn:function(ft){return ft+["th","st","nd","rd"][3<ft%10?0:(ft-ft%10!=10?1:0)*ft%10]}});var Lt;let ge=D=class extends ae{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Zt,tickMethod:tn,tickCount:5}}constructor(ft){super(ft)}clone(){return new D(this.options)}};ge=D=function(ft,_t,ee,pe){var Ie,je=arguments.length,Oe=je<3?_t:pe===null?pe=Object.getOwnPropertyDescriptor(_t,ee):pe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Oe=Reflect.decorate(ft,_t,ee,pe);else for(var Ee=ft.length-1;0<=Ee;Ee--)(Ie=ft[Ee])&&(Oe=(je<3?Ie(Oe):3<je?Ie(_t,ee,Oe):Ie(_t,ee))||Oe);return 3<je&&Oe&&Object.defineProperty(_t,ee,Oe),Oe}([Nt(function(ft){return[ft(0),ft(1)]},_t=>{var[_t,ee]=_t;return nt(Tt(0,1),ie(_t,ee))})],ge);let de=Lt=class extends ae{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Zt,tickMethod:tn,tickCount:5}}constructor(ft){super(ft)}clone(){return new Lt(this.options)}};de=Lt=function(ft,_t,ee,pe){var Ie,je=arguments.length,Oe=je<3?_t:pe===null?pe=Object.getOwnPropertyDescriptor(_t,ee):pe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Oe=Reflect.decorate(ft,_t,ee,pe);else for(var Ee=ft.length-1;0<=Ee;Ee--)(Ie=ft[Ee])&&(Oe=(je<3?Ie(Oe):3<je?Ie(_t,ee,Oe):Ie(_t,ee))||Oe);return 3<je&&Oe&&Object.defineProperty(_t,ee,Oe),Oe}([Nt(function(ft){return[ft(0),ft(.5),ft(1)]},ft=>{const[_t,ee,pe]=ft,Ie=nt(Tt(0,.5),ie(_t,ee)),je=nt(Tt(.5,1),ie(ee,pe));return Oe=>(_t>pe?Oe<ee?je:Ie:Oe<ee?Ie:je)(Oe)})],de);function ze(ft,_t,ee,pe,Ie){var je=new ae({range:[_t,_t+pe]}),Oe=new ae({range:[ee,ee+Ie]});return{transform:function($e){var $e=Z($e,2),Ve=$e[0],$e=$e[1];return[je.map(Ve),Oe.map($e)]},untransform:function($e){var $e=Z($e,2),Ve=$e[0],$e=$e[1];return[je.invert(Ve),Oe.invert($e)]}}}function Ne(ft,_t,ee,pe,Ie){return(0,Z(ft,1)[0])(_t,ee,pe,Ie)}function sn(ft,_t,ee,pe,Ie){return Z(ft,1)[0]}function Ce(Ve,_t,ee,pe,Ie){var je=(Ve=Z(Ve,4))[0],Oe=Ve[1],Ee=Ve[2],Ve=Ve[3],$e=new ae({range:[Ee,Ve]}),pn=new ae({range:[je,Oe]}),Sn=1<(Ee=Ie/pe)?1:Ee,Dn=1<Ee?1/Ee:1;return{transform:function(Pn){var Pn=Z(Pn,2),Mn=Pn[0],Pn=Pn[1],Mn=pn.map(Mn),Pn=$e.map(Pn);return[.5*(Pn*Math.cos(Mn)*Sn)+.5,.5*(Pn*Math.sin(Mn)*Dn)+.5]},untransform:function(yn){var yn=Z(yn,2),Mn=yn[0],yn=yn[1],Mn=2*(Mn-.5)/Sn,yn=2*(yn-.5)/Dn,Pn=Math.sqrt(Math.pow(Mn,2)+Math.pow(yn,2)),yn=we(Math.atan2(yn,Mn),je,Oe);return[pn.invert(yn),$e.invert(Pn)]}}}function en(ft,_t,ee,pe,Ie){return{transform:function(Oe){var Oe=Z(Oe,2),Ee=Oe[0];return[Oe[1],Ee]},untransform:function(Oe){var Oe=Z(Oe,2),Ee=Oe[0];return[Oe[1],Ee]}}}function dn(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];return pr.apply(void 0,tt([[-1,-1]],Z(_t),!1))}function En(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];return pr.apply(void 0,tt([[-1,1]],Z(_t),!1))}function mn(ft){for(var _t=[],ee=1;ee<arguments.length;ee++)_t[ee-1]=arguments[ee];return pr.apply(void 0,tt([[1,-1]],Z(_t),!1))}function jn(Oe,_t,ee,pe,Ie){var je,Oe=Z(Oe,1)[0],Ee=Rt();return Ee=Ee,Oe=Oe,je=Math.sin(Oe),Oe=Math.cos(Oe),Ee[0]=Oe,Ee[1]=je,Ee[2]=0,Ee[3]=-je,Ee[4]=Oe,Ee[5]=0,Ee[6]=0,Ee[7]=0,Ee[8]=1,Ee}function Wn(ft,_t,ee,pe,Ie){var je=(ft=Z(ft,4))[0],Oe=ft[1],Ee=ft[2],Ve=(ft[3]-Ee)/(+Oe/(2*Math.PI)+1),$e=Ve/(2*Math.PI),pn=new ae({range:[Ee,Ee+.99*Ve]}),Sn=new ae({range:[je,Oe]}),Dn=1<(ft=Ie/pe)?1:ft,vn=1<ft?1/ft:1;return{transform:function(yn){var yn=Z(yn,2),Pn=yn[0],yn=yn[1],Pn=Sn.map(Pn),yn=pn.map(yn);return[.5*(Math.cos(Pn)*($e*Pn+yn)*Dn)+.5,.5*(Math.sin(Pn)*($e*Pn+yn)*vn)+.5]},untransform:function(yn){var yn=Z(yn,2),$n=yn[0],yn=yn[1],$n=2*($n-.5)/Dn,yn=2*(yn-.5)/vn,Pn=Math.sqrt(Math.pow($n,2)+Math.pow(yn,2)),yn=we(Math.atan2(yn,$n)+Math.floor(Pn/Ve)*Math.PI*2,je,Oe),$n=Pn-$e*yn;return[Sn.invert(yn),pn.invert($n)]}}}function tr(Ve,_t,ee,pe,Ie){var je=(Ve=Z(Ve,4))[0],Oe=Ve[1],Ee=Ve[2],Ve=Ve[3],$e=new ae({range:[Ee,Ve]});return{transform:function(pn){for(var Sn=[],Dn=pn.length,vn=new ye({domain:new Array(Dn).fill(0).map(function($n,kn){return kn}),range:[je,Oe]}),Mn=0;Mn<Dn;Mn++){var yn=pn[Mn],Pn=vn.map(Mn),yn=$e.map(yn);Sn.push(Pn,yn)}return Sn},untransform:function(pn){for(var Sn=[],Dn=0;Dn<pn.length;Dn+=2){var vn=pn[Dn+1];Sn.push($e.invert(vn))}return Sn}}}var pr=function(Oe,_t,ee,pe,Ie){var Oe=Z(Oe,2),je=Oe[0],Oe=Oe[1],Ee=Rt();return je=[je,Oe],(Oe=Ee)[0]=je[0],Oe[1]=0,Oe[2]=0,Oe[3]=0,Oe[4]=je[1],Oe[5]=0,Oe[6]=0,Oe[7]=0,Oe[8]=1,Oe};function Mr(ft){return 1/Math.tan(ft)}function Qr(ft,_t,ee,pe,Ie){var je=Mr(Z(ft,1)[0]);return{transform:function(Ve){var Ve=Z(Ve,2),Ee=Ve[0],Ve=Ve[1];return[Ee+Ve*je,Ve]},untransform:function(Ve){var Ve=Z(Ve,2),Ee=Ve[0],Ve=Ve[1];return[Ee-Ve*je,Ve]}}}function Nr(ft,_t,ee,pe,Ie){var je=Mr(Z(ft,1)[0]);return{transform:function(Ee){var Ee=Z(Ee,2),Ve=Ee[0];return[Ve,Ee[1]+Ve*je]},untransform:function(Ee){var Ee=Z(Ee,2),Ve=Ee[0];return[Ve,Ee[1]-Ve*je]}}}function Lr(ft,_t,ee,Ee,Oe){var je=ft<_t,Oe=(je?_t-Ee:Oe-_t)||Oe-Ee,Ee=je?-1:1;return Ee*Oe*(ee+1)/(ee+Oe/((ft-_t)*Ee))+_t}function Fr(ft,_t,ee,pe,Oe){var je=ft<_t,Oe=(je?_t-pe:Oe-_t)||Oe-pe;return Oe/(Oe*(ee+1)/(ft-_t)-ee*(je?-1:1))+_t}function vi(ft,_t,ee){return ee?new ae({range:[0,1],domain:[0,_t]}).map(ft):ft}function Li(Ee,_t,ee,pe,Ie){var je=(Ee=Z(Ee,3))[0],Oe=Ee[1],Ee=Ee[2],Ve=vi(je,pe,Ee!==void 0&&Ee);return{transform:function(Sn){var Sn=Z(Sn,2),pn=Sn[0],Sn=Sn[1];return[Lr(pn,Ve,Oe,0,1),Sn]},untransform:function(Sn){var Sn=Z(Sn,2),pn=Sn[0],Sn=Sn[1];return[Fr(pn,Ve,Oe,0,1),Sn]}}}function Ii(Ee,_t,ee,pe,Ie){var je=(Ee=Z(Ee,3))[0],Oe=Ee[1],Ee=Ee[2],Ve=vi(je,Ie,Ee!==void 0&&Ee);return{transform:function($e){return $e=Z($e,2),[$e[0],Lr($e[1],Ve,Oe,0,1)]},untransform:function($e){return $e=Z($e,2),[$e[0],Fr($e[1],Ve,Oe,0,1)]}}}function mi($e,_t,ee,pe,Ie){var je=($e=Z($e,5))[0],Oe=$e[1],Ee=$e[2],Ve=$e[3],$e=$e[4],pn=vi(je,pe,$e=$e!==void 0&&$e),Sn=vi(Oe,Ie,$e);return{transform:function(Mn){var Mn=Z(Mn,2),vn=Mn[0],Mn=Mn[1];return[Lr(vn,pn,Ee,0,1),Lr(Mn,Sn,Ve,0,1)]},untransform:function(Mn){var Mn=Z(Mn,2),vn=Mn[0],Mn=Mn[1];return[Fr(vn,pn,Ee,0,1),Fr(Mn,Sn,Ve,0,1)]}}}function Hi($e,_t,ee,pe,Ie){var je=($e=Z($e,5))[0],Oe=$e[1],Ee=$e[2],Ve=$e[3],$e=($e=$e[4])!==void 0&&$e,pn=new ae({range:[0,pe]}),Sn=new ae({range:[0,Ie]}),Dn=$e?je:pn.map(je),vn=$e?Oe:Sn.map(Oe);return{transform:function(yn){var yn=Z(yn,2),Pn=yn[0],yn=yn[1],$n=pn.map(Pn)-Dn,kn=Sn.map(yn)-vn,Vn=Math.sqrt($n*$n+kn*kn);return Ee<Vn?[Pn,yn]:(Pn=Lr(Vn,0,Ve,0,Ee),yn=Math.atan2(kn,$n),Vn=Dn+Pn*Math.cos(yn),kn=vn+Pn*Math.sin(yn),[pn.invert(Vn),Sn.invert(kn)])},untransform:function(yn){var yn=Z(yn,2),Pn=yn[0],yn=yn[1],$n=pn.map(Pn)-Dn,kn=Sn.map(yn)-vn,Vn=Math.sqrt($n*$n+kn*kn);return Ee<Vn?[Pn,yn]:(Pn=Fr(Vn,0,Ve,0,Ee),yn=Math.atan2(kn,$n),Vn=Dn+Pn*Math.cos(yn),kn=vn+Pn*Math.sin(yn),[pn.invert(Vn),Sn.invert(kn)])}}}function io(ft,_t,ee,pe,Ie,je,Oe){var Ee=new ae({range:[_t,_t+Ie]}),Ve=new ae({range:[ee,ee+je]}),$e=new ae({range:[pe,pe+Oe]});return{transform:function(vn){var vn=Z(vn,3),Sn=vn[0],Dn=vn[1],vn=vn[2];return[Ee.map(Sn),Ve.map(Dn),$e.map(vn)]},untransform:function(vn){var vn=Z(vn,3),Sn=vn[0],Dn=vn[1],vn=vn[2];return[Ee.invert(Sn),Ve.invert(Dn),$e.invert(vn)]}}}function Ko(pn,_t,ee,pe,Ie,je,Oe){var Ee,Ve=(pn=Z(pn,3))[0],$e=pn[1],pn=pn[2];return Ee=ve(),Ve=[Ve,$e,pn],Ee[0]=1,Ee[1]=0,Ee[2]=0,Ee[3]=0,Ee[4]=0,Ee[5]=1,Ee[6]=0,Ee[7]=0,Ee[8]=0,Ee[9]=0,Ee[10]=1,Ee[11]=0,Ee[12]=Ve[0],Ee[13]=Ve[1],Ee[14]=Ve[2],Ee[15]=1,Ee}function So(ft,_t,ee,pe,Ie,je,Oe){return{transform:function(Ve){var Ve=Z(Ve,3),$e=Ve[0];return[Ve[1],$e,Ve[2]]},untransform:function(Ve){var Ve=Z(Ve,3),$e=Ve[0];return[Ve[1],$e,Ve[2]]}}}function fa(pn,_t,ee,pe,Ie,je,Oe){var Ee,Ve=(pn=Z(pn,3))[0],$e=pn[1],pn=pn[2];return Ee=ve(),Ve=[Ve,$e,pn],Ee[0]=Ve[0],Ee[1]=0,Ee[2]=0,Ee[3]=0,Ee[4]=0,Ee[5]=Ve[1],Ee[6]=0,Ee[7]=0,Ee[8]=0,Ee[9]=0,Ee[10]=Ve[2],Ee[11]=0,Ee[12]=0,Ee[13]=0,Ee[14]=0,Ee[15]=1,Ee}li.prototype.update=function(ft){this.options=X({},this.options,ft),this.recoordinate()},li.prototype.clone=function(){return new li(this.options)},li.prototype.getOptions=function(){return this.options},li.prototype.clear=function(){this.update({transformations:[]})},li.prototype.getSize=function(){var ft=this.options;return[ft.width,ft.height]},li.prototype.getCenter=function(){var ft=this.options,_t=ft.x,ee=ft.y;return[(2*_t+ft.width)/2,(2*ee+ft.height)/2]},li.prototype.transform=function(){for(var ft=[],_t=0;_t<arguments.length;_t++)ft[_t]=arguments[_t];var ee=this.options.transformations;return this.update({transformations:tt(tt([],Z(ee),!1),[tt([],Z(ft),!1)],!1)}),this},li.prototype.map=function(ft){return this.output(ft)},li.prototype.invert=function(ft){return this.input(ft)},li.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},li.prototype.compose=function(ft){function _t(Ln,zn){var ir;Ee.push((zn=zn===void 0?!0:zn)?(ir=Ln,function(Qi){for(var Wi=[],fi=0;fi<Qi.length-1;fi+=2){var Ji=[Qi[fi],Qi[fi+1]],Ji=ir(Ji);Wi.push.apply(Wi,tt([],Z(Ji),!1))}return Wi}):Ln)}var ee,pe,Ie=(ft=ft===void 0?!1:ft)?tt([],Z(this.options.transformations),!1).reverse():this.options.transformations,je=ft?function(Ln){return Ln.untransform}:function(Ln){return Ln.transform},Oe=[],Ee=[];try{for(var Ve=Y(Ie),$e=Ve.next();!$e.done;$e=Ve.next()){var pn,Sn,Dn,vn,Mn,Pn,yn=Z($e.value),$n=yn[0],kn=yn.slice(1),Vn=this.transformers[$n];Vn&&(Sn=(pn=this.options).x,Dn=pn.y,vn=pn.width,Mn=pn.height,Ke(Pn=Vn(tt([],Z(kn),!1),Sn,Dn,vn,Mn))?Oe.push(Pn):(Oe.length&&(_t(this.createMatrixTransform(Oe,ft)),Oe.splice(0,Oe.length)),_t(je(Pn)||Zt,$n!=="parallel")))}}catch(Ln){ee={error:Ln}}finally{try{$e&&!$e.done&&(pe=Ve.return)&&pe.call(Ve)}finally{if(ee)throw ee.error}}return Oe.length&&_t(this.createMatrixTransform(Oe,ft)),Ue.apply(void 0,tt([],Z(Ee),!1))},li.prototype.createMatrixTransform=function(ft,_t){var ee,pe,Ie,je,Oe,Ee,Ve,$e,pn,Sn,Dn,vn,Mn=Rt();return _t&&ft.reverse(),ft.forEach(function(Pn){return Gt(Mn,Mn,Pn)}),_t&&(_t=ft=Mn,(vn=new zt(9))[0]=_t[0],vn[1]=_t[1],vn[2]=_t[2],vn[3]=_t[3],vn[4]=_t[4],vn[5]=_t[5],vn[6]=_t[6],vn[7]=_t[7],vn[8]=_t[8],vn=(_t=vn)[0],ee=_t[1],pe=_t[2],Ie=_t[3],je=_t[4],Oe=_t[5],Ee=_t[6],Ve=_t[7],$e=(_t=_t[8])*je-Oe*Ve,Dn=vn*$e+ee*(pn=-_t*Ie+Oe*Ee)+pe*(Sn=Ve*Ie-je*Ee))&&(ft[0]=$e*(Dn=1/Dn),ft[1]=(-_t*ee+pe*Ve)*Dn,ft[2]=(Oe*ee-pe*je)*Dn,ft[3]=pn*Dn,ft[4]=(_t*vn-pe*Ee)*Dn,ft[5]=(-Oe*vn+pe*Ie)*Dn,ft[6]=Sn*Dn,ft[7]=(-Ve*vn+ee*Ee)*Dn,ft[8]=(je*vn-ee*Ie)*Dn),function(zn){var yn,$n,kn,Vn,Ln,zn=[zn[0],zn[1],1];return kn=Mn,Vn=($n=yn=zn)[0],Ln=$n[1],$n=$n[2],yn[0]=Vn*kn[0]+Ln*kn[3]+$n*kn[6],yn[1]=Vn*kn[1]+Ln*kn[4]+$n*kn[7],yn[2]=Vn*kn[2]+Ln*kn[5]+$n*kn[8],[zn[0],zn[1]]}},H=li;function li(ft){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:ze,translate:Ut,custom:Ne,matrix:sn,polar:Ce,transpose:en,scale:pr,"shear.x":Qr,"shear.y":Nr,reflect:dn,"reflect.x":En,"reflect.y":mn,rotate:jn,helix:Wn,parallel:tr,fisheye:mi,"fisheye.x":Li,"fisheye.y":Ii,"fisheye.circular":Hi},this.update(ft)}Cr.prototype.update=function(ft){this.options=X({},this.options,ft),this.recoordinate()},Cr.prototype.clone=function(){return new Cr(this.options)},Cr.prototype.getOptions=function(){return this.options},Cr.prototype.clear=function(){this.update({transformations:[]})},Cr.prototype.getSize=function(){var ft=this.options;return[ft.width,ft.height,ft.depth]},Cr.prototype.getCenter=function(){var ft=this.options,_t=ft.x,ee=ft.y,pe=ft.z;return[(2*_t+ft.width)/2,(2*ee+ft.height)/2,(2*pe+ft.depth)/2]},Cr.prototype.transform=function(){for(var ft=[],_t=0;_t<arguments.length;_t++)ft[_t]=arguments[_t];var ee=this.options.transformations;return this.update({transformations:tt(tt([],Z(ee),!1),[tt([],Z(ft),!1)],!1)}),this},Cr.prototype.map=function(ft){return this.output(ft)},Cr.prototype.invert=function(ft){return this.input(ft)},Cr.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Cr.prototype.compose=function(ft){function _t(ir,Qi){var Wi;Ee.push((Qi=Qi===void 0?!0:Qi)?(Wi=ir,function(fi){for(var Ji=[],to=0;to<fi.length-1;to+=3){var Dt=[fi[to],fi[to+1],fi[to+2]],Dt=Wi(Dt);Ji.push.apply(Ji,tt([],Z(Dt),!1))}return Ji}):ir)}var ee,pe,Ie=(ft=ft===void 0?!1:ft)?tt([],Z(this.options.transformations),!1).reverse():this.options.transformations,je=ft?function(ir){return ir.untransform}:function(ir){return ir.transform},Oe=[],Ee=[];try{for(var Ve=Y(Ie),$e=Ve.next();!$e.done;$e=Ve.next()){var pn,Sn,Dn,vn,Mn,Pn,yn,$n,kn=Z($e.value),Vn=kn[0],Ln=kn.slice(1),zn=this.transformers[Vn];zn&&(Sn=(pn=this.options).x,Dn=pn.y,vn=pn.z,Mn=pn.width,Pn=pn.height,yn=pn.depth,Ke($n=zn(tt([],Z(Ln),!1),Sn,Dn,vn,Mn,Pn,yn))?Oe.push($n):(Oe.length&&(_t(this.createMatrixTransform(Oe,ft)),Oe.splice(0,Oe.length)),_t(je($n)||Zt,!0)))}}catch(ir){ee={error:ir}}finally{try{$e&&!$e.done&&(pe=Ve.return)&&pe.call(Ve)}finally{if(ee)throw ee.error}}return Oe.length&&_t(this.createMatrixTransform(Oe,ft)),Ue.apply(void 0,tt([],Z(Ee),!1))},Cr.prototype.createMatrixTransform=function(ft,_t){var ee,pe,Ie,je,Oe,Ee,Ve,$e,pn,Sn,Dn,vn,Mn,Pn,yn,$n,kn,Vn,Ln,zn,ir,Qi,Wi,fi,Ji,to,Dt,Xt,Ae=ve();return _t&&ft.reverse(),ft.forEach(function(Qe){return Me(Ae,Ae,Qe)}),_t&&(_t=ft=Ae,(Xt=new zt(16))[0]=_t[0],Xt[1]=_t[1],Xt[2]=_t[2],Xt[3]=_t[3],Xt[4]=_t[4],Xt[5]=_t[5],Xt[6]=_t[6],Xt[7]=_t[7],Xt[8]=_t[8],Xt[9]=_t[9],Xt[10]=_t[10],Xt[11]=_t[11],Xt[12]=_t[12],Xt[13]=_t[13],Xt[14]=_t[14],Xt[15]=_t[15],Xt=(_t=Xt)[0],ee=_t[1],pe=_t[2],Ie=_t[3],je=_t[4],Oe=_t[5],Ee=_t[6],Ve=_t[7],$e=_t[8],pn=_t[9],Sn=_t[10],Dn=_t[11],vn=_t[12],Mn=_t[13],Pn=_t[14],_t=_t[15],Dt=(yn=Xt*Oe-ee*je)*(to=Sn*_t-Dn*Pn)-($n=Xt*Ee-pe*je)*(Ji=pn*_t-Dn*Mn)+(kn=Xt*Ve-Ie*je)*(fi=pn*Pn-Sn*Mn)+(Vn=ee*Ee-pe*Oe)*(Wi=$e*_t-Dn*vn)-(Ln=ee*Ve-Ie*Oe)*(Qi=$e*Pn-Sn*vn)+(zn=pe*Ve-Ie*Ee)*(ir=$e*Mn-pn*vn))&&(ft[0]=(Oe*to-Ee*Ji+Ve*fi)*(Dt=1/Dt),ft[1]=(pe*Ji-ee*to-Ie*fi)*Dt,ft[2]=(Mn*zn-Pn*Ln+_t*Vn)*Dt,ft[3]=(Sn*Ln-pn*zn-Dn*Vn)*Dt,ft[4]=(Ee*Wi-je*to-Ve*Qi)*Dt,ft[5]=(Xt*to-pe*Wi+Ie*Qi)*Dt,ft[6]=(Pn*kn-vn*zn-_t*$n)*Dt,ft[7]=($e*zn-Sn*kn+Dn*$n)*Dt,ft[8]=(je*Ji-Oe*Wi+Ve*ir)*Dt,ft[9]=(ee*Wi-Xt*Ji-Ie*ir)*Dt,ft[10]=(vn*Ln-Mn*kn+_t*yn)*Dt,ft[11]=(pn*kn-$e*Ln-Dn*yn)*Dt,ft[12]=(Oe*Qi-je*fi-Ee*ir)*Dt,ft[13]=(Xt*fi-ee*Qi+pe*ir)*Dt,ft[14]=(Mn*$n-vn*Vn-Pn*yn)*Dt,ft[15]=($e*Vn-pn*$n+Sn*yn)*Dt),function(wi){var gn,In,Xn,ri,di,Pr,wi=[wi[0],wi[1],wi[2],1];return Xn=Ae,ri=(In=gn=wi)[0],di=In[1],Pr=In[2],In=In[3],gn[0]=Xn[0]*ri+Xn[4]*di+Xn[8]*Pr+Xn[12]*In,gn[1]=Xn[1]*ri+Xn[5]*di+Xn[9]*Pr+Xn[13]*In,gn[2]=Xn[2]*ri+Xn[6]*di+Xn[10]*Pr+Xn[14]*In,gn[3]=Xn[3]*ri+Xn[7]*di+Xn[11]*Pr+Xn[15]*In,[wi[0],wi[1],wi[2]]}},St=Cr;function Cr(ft){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:io,translate3D:Ko,scale3D:fa,transpose3D:So},this.update(ft)}L.Coordinate=H,L.Coordinate3D=St,Object.defineProperty(L,"__esModule",{value:!0})})},90857:function($t){"use strict";var Qt=Object.prototype.hasOwnProperty,L="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(L=!1));function Z(Ot,bt,Et){this.fn=Ot,this.context=bt,this.once=Et||!1}function tt(Ot,bt,Et,pt,Vt){if(typeof Et!="function")throw new TypeError("The listener must be a function");var K=new Z(Et,pt||Ot,Vt),X=L?L+bt:bt;return Ot._events[X]?Ot._events[X].fn?Ot._events[X]=[Ot._events[X],K]:Ot._events[X].push(K):(Ot._events[X]=K,Ot._eventsCount++),Ot}function yt(Ot,bt){--Ot._eventsCount===0?Ot._events=new Y:delete Ot._events[bt]}function G(){this._events=new Y,this._eventsCount=0}G.prototype.eventNames=function(){var bt=[],Et,pt;if(this._eventsCount===0)return bt;for(pt in Et=this._events)Qt.call(Et,pt)&&bt.push(L?pt.slice(1):pt);return Object.getOwnPropertySymbols?bt.concat(Object.getOwnPropertySymbols(Et)):bt},G.prototype.listeners=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Vt=0,K=pt.length,X=new Array(K);Vt<K;Vt++)X[Vt]=pt[Vt].fn;return X},G.prototype.listenerCount=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];return pt?pt.fn?1:pt.length:0},G.prototype.emit=function(bt,Et,pt,Vt,K,X){var Zt=L?L+bt:bt;if(!this._events[Zt])return!1;var Mt=this._events[Zt],zt=arguments.length,Rt,Gt;if(Mt.fn){switch(Mt.once&&this.removeListener(bt,Mt.fn,void 0,!0),zt){case 1:return Mt.fn.call(Mt.context),!0;case 2:return Mt.fn.call(Mt.context,Et),!0;case 3:return Mt.fn.call(Mt.context,Et,pt),!0;case 4:return Mt.fn.call(Mt.context,Et,pt,Vt),!0;case 5:return Mt.fn.call(Mt.context,Et,pt,Vt,K),!0;case 6:return Mt.fn.call(Mt.context,Et,pt,Vt,K,X),!0}for(Gt=1,Rt=new Array(zt-1);Gt<zt;Gt++)Rt[Gt-1]=arguments[Gt];Mt.fn.apply(Mt.context,Rt)}else{var ve=Mt.length,Me;for(Gt=0;Gt<ve;Gt++)switch(Mt[Gt].once&&this.removeListener(bt,Mt[Gt].fn,void 0,!0),zt){case 1:Mt[Gt].fn.call(Mt[Gt].context);break;case 2:Mt[Gt].fn.call(Mt[Gt].context,Et);break;case 3:Mt[Gt].fn.call(Mt[Gt].context,Et,pt);break;case 4:Mt[Gt].fn.call(Mt[Gt].context,Et,pt,Vt);break;default:if(!Rt)for(Me=1,Rt=new Array(zt-1);Me<zt;Me++)Rt[Me-1]=arguments[Me];Mt[Gt].fn.apply(Mt[Gt].context,Rt)}}return!0},G.prototype.on=function(bt,Et,pt){return tt(this,bt,Et,pt,!1)},G.prototype.once=function(bt,Et,pt){return tt(this,bt,Et,pt,!0)},G.prototype.removeListener=function(bt,Et,pt,Vt){var K=L?L+bt:bt;if(!this._events[K])return this;if(!Et)return yt(this,K),this;var X=this._events[K];if(X.fn)X.fn===Et&&(!Vt||X.once)&&(!pt||X.context===pt)&&yt(this,K);else{for(var Zt=0,Mt=[],zt=X.length;Zt<zt;Zt++)(X[Zt].fn!==Et||Vt&&!X[Zt].once||pt&&X[Zt].context!==pt)&&Mt.push(X[Zt]);Mt.length?this._events[K]=Mt.length===1?Mt[0]:Mt:yt(this,K)}return this},G.prototype.removeAllListeners=function(bt){var Et;return bt?(Et=L?L+bt:bt,this._events[Et]&&yt(this,Et)):(this._events=new Y,this._eventsCount=0),this},G.prototype.off=G.prototype.removeListener,G.prototype.addListener=G.prototype.on,G.prefixed=L,G.EventEmitter=G,$t.exports=G},38554:function($t){"use strict";var Qt=Object.prototype.hasOwnProperty,L="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(L=!1));function Z(Ot,bt,Et){this.fn=Ot,this.context=bt,this.once=Et||!1}function tt(Ot,bt,Et,pt,Vt){if(typeof Et!="function")throw new TypeError("The listener must be a function");var K=new Z(Et,pt||Ot,Vt),X=L?L+bt:bt;return Ot._events[X]?Ot._events[X].fn?Ot._events[X]=[Ot._events[X],K]:Ot._events[X].push(K):(Ot._events[X]=K,Ot._eventsCount++),Ot}function yt(Ot,bt){--Ot._eventsCount===0?Ot._events=new Y:delete Ot._events[bt]}function G(){this._events=new Y,this._eventsCount=0}G.prototype.eventNames=function(){var bt=[],Et,pt;if(this._eventsCount===0)return bt;for(pt in Et=this._events)Qt.call(Et,pt)&&bt.push(L?pt.slice(1):pt);return Object.getOwnPropertySymbols?bt.concat(Object.getOwnPropertySymbols(Et)):bt},G.prototype.listeners=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Vt=0,K=pt.length,X=new Array(K);Vt<K;Vt++)X[Vt]=pt[Vt].fn;return X},G.prototype.listenerCount=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];return pt?pt.fn?1:pt.length:0},G.prototype.emit=function(bt,Et,pt,Vt,K,X){var Zt=L?L+bt:bt;if(!this._events[Zt])return!1;var Mt=this._events[Zt],zt=arguments.length,Rt,Gt;if(Mt.fn){switch(Mt.once&&this.removeListener(bt,Mt.fn,void 0,!0),zt){case 1:return Mt.fn.call(Mt.context),!0;case 2:return Mt.fn.call(Mt.context,Et),!0;case 3:return Mt.fn.call(Mt.context,Et,pt),!0;case 4:return Mt.fn.call(Mt.context,Et,pt,Vt),!0;case 5:return Mt.fn.call(Mt.context,Et,pt,Vt,K),!0;case 6:return Mt.fn.call(Mt.context,Et,pt,Vt,K,X),!0}for(Gt=1,Rt=new Array(zt-1);Gt<zt;Gt++)Rt[Gt-1]=arguments[Gt];Mt.fn.apply(Mt.context,Rt)}else{var ve=Mt.length,Me;for(Gt=0;Gt<ve;Gt++)switch(Mt[Gt].once&&this.removeListener(bt,Mt[Gt].fn,void 0,!0),zt){case 1:Mt[Gt].fn.call(Mt[Gt].context);break;case 2:Mt[Gt].fn.call(Mt[Gt].context,Et);break;case 3:Mt[Gt].fn.call(Mt[Gt].context,Et,pt);break;case 4:Mt[Gt].fn.call(Mt[Gt].context,Et,pt,Vt);break;default:if(!Rt)for(Me=1,Rt=new Array(zt-1);Me<zt;Me++)Rt[Me-1]=arguments[Me];Mt[Gt].fn.apply(Mt[Gt].context,Rt)}}return!0},G.prototype.on=function(bt,Et,pt){return tt(this,bt,Et,pt,!1)},G.prototype.once=function(bt,Et,pt){return tt(this,bt,Et,pt,!0)},G.prototype.removeListener=function(bt,Et,pt,Vt){var K=L?L+bt:bt;if(!this._events[K])return this;if(!Et)return yt(this,K),this;var X=this._events[K];if(X.fn)X.fn===Et&&(!Vt||X.once)&&(!pt||X.context===pt)&&yt(this,K);else{for(var Zt=0,Mt=[],zt=X.length;Zt<zt;Zt++)(X[Zt].fn!==Et||Vt&&!X[Zt].once||pt&&X[Zt].context!==pt)&&Mt.push(X[Zt]);Mt.length?this._events[K]=Mt.length===1?Mt[0]:Mt:yt(this,K)}return this},G.prototype.removeAllListeners=function(bt){var Et;return bt?(Et=L?L+bt:bt,this._events[Et]&&yt(this,Et)):(this._events=new Y,this._eventsCount=0),this},G.prototype.off=G.prototype.removeListener,G.prototype.addListener=G.prototype.on,G.prefixed=L,G.EventEmitter=G,$t.exports=G},11702:function($t,Qt,L){"use strict";L.d(Qt,{TE:function(){return yt},U4:function(){return qt},Xk:function(){return ie},Y1:function(){return Be},_x:function(){return Pe},hE:function(){return he},l5:function(){return ht},ph:function(){return _e},vp:function(){return ve},x4:function(){return Ze}});var Y=L(74902),Z=L(80450),tt=L(31437);function yt(jt,ce,ae,ye){var st=jt-ae,D=ce-ye;return Math.sqrt(st*st+D*D)}function G(jt,ce){var ae=Math.min.apply(Math,(0,Y.Z)(jt)),ye=Math.min.apply(Math,(0,Y.Z)(ce)),st=Math.max.apply(Math,(0,Y.Z)(jt)),D=Math.max.apply(Math,(0,Y.Z)(ce));return{x:ae,y:ye,width:st-ae,height:D-ye}}function Ot(jt){return(jt+Math.PI*2)%(Math.PI*2)}function bt(jt,ce){var ae=Math.abs(jt);return ce>0?ae:ae*-1}function Et(jt,ce,ae,ye,st,D){var H=ae,at=ye;if(H===0||at===0)return{x:jt,y:ce};for(var St=st-jt,Lt=D-ce,ge=Math.abs(St),de=Math.abs(Lt),ze=H*H,Ne=at*at,sn=Math.PI/4,Ce=0,en=0,dn=0;dn<4;dn++){Ce=H*Math.cos(sn),en=at*Math.sin(sn);var En=(ze-Ne)*Math.pow(Math.cos(sn),3)/H,mn=(Ne-ze)*Math.pow(Math.sin(sn),3)/at,jn=Ce-En,Wn=en-mn,tr=ge-En,pr=de-mn,Mr=Math.hypot(Wn,jn),Qr=Math.hypot(pr,tr),Nr=Mr*Math.asin((jn*pr-Wn*tr)/(Mr*Qr)),Lr=Nr/Math.sqrt(ze+Ne-Ce*Ce-en*en);sn+=Lr,sn=Math.min(Math.PI/2,Math.max(0,sn))}return{x:jt+bt(Ce,St),y:ce+bt(en,Lt)}}function pt(jt,ce,ae,ye,st,D,H,at){return-1*ae*Math.cos(st)*Math.sin(at)-ye*Math.sin(st)*Math.cos(at)}function Vt(jt,ce,ae,ye,st,D,H,at){return-1*ae*Math.sin(st)*Math.sin(at)+ye*Math.cos(st)*Math.cos(at)}function K(jt,ce,ae){return Math.atan(-ce/jt*Math.tan(ae))}function X(jt,ce,ae){return Math.atan(ce/(jt*Math.tan(ae)))}function Zt(jt,ce,ae,ye,st,D){return ae*Math.cos(st)*Math.cos(D)-ye*Math.sin(st)*Math.sin(D)+jt}function Mt(jt,ce,ae,ye,st,D){return ae*Math.sin(st)*Math.cos(D)+ye*Math.cos(st)*Math.sin(D)+ce}function zt(jt,ce,ae,ye){var st=Math.atan2(ye*jt,ae*ce);return(st+Math.PI*2)%(Math.PI*2)}function Rt(jt,ce,ae){return{x:jt*Math.cos(ae),y:ce*Math.sin(ae)}}function Gt(jt,ce,ae){var ye=Math.cos(ae),st=Math.sin(ae);return[jt*ye-ce*st,jt*st+ce*ye]}function ve(jt,ce,ae,ye,st,D,H){for(var at=K(ae,ye,st),St=1/0,Lt=-1/0,ge=[D,H],de=-Math.PI*2;de<=Math.PI*2;de+=Math.PI){var ze=at+de;D<H?D<ze&&ze<H&&ge.push(ze):H<ze&&ze<D&&ge.push(ze)}for(var Ne=0;Ne<ge.length;Ne++){var sn=Zt(jt,ce,ae,ye,st,ge[Ne]);sn<St&&(St=sn),sn>Lt&&(Lt=sn)}for(var Ce=X(ae,ye,st),en=1/0,dn=-1/0,En=[D,H],mn=-Math.PI*2;mn<=Math.PI*2;mn+=Math.PI){var jn=Ce+mn;D<H?D<jn&&jn<H&&En.push(jn):H<jn&&jn<D&&En.push(jn)}for(var Wn=0;Wn<En.length;Wn++){var tr=Mt(jt,ce,ae,ye,st,En[Wn]);tr<en&&(en=tr),tr>dn&&(dn=tr)}return{x:St,y:en,width:Lt-St,height:dn-en}}function Me(jt,ce,ae,ye,st,D,H,at,St){var Lt=Gt(at-jt,St-ce,-st),ge=_slicedToArray(Lt,2),de=ge[0],ze=ge[1],Ne=Et(0,0,ae,ye,de,ze),sn=zt(ae,ye,Ne.x,Ne.y);sn<D?Ne=Rt(ae,ye,D):sn>H&&(Ne=Rt(ae,ye,H));var Ce=Gt(Ne.x,Ne.y,st);return{x:Ce[0]+jt,y:Ce[1]+ce}}function Ue(jt,ce,ae,ye,st,D,H,at){var St=(H-D)*at+D,Lt=pt(jt,ce,ae,ye,st,D,H,St),ge=Vt(jt,ce,ae,ye,st,D,H,St);return Ot(Math.atan2(ge,Lt))}var Ke=1e-4;function we(jt,ce,ae,ye,st,D){var H=-1,at=1/0,St=[ae,ye],Lt=20;D&&D>200&&(Lt=D/10);for(var ge=1/Lt,de=ge/10,ze=0;ze<=Lt;ze++){var Ne=ze*ge,sn=[st.apply(void 0,(0,Y.Z)(jt.concat([Ne]))),st.apply(void 0,(0,Y.Z)(ce.concat([Ne])))],Ce=yt(St[0],St[1],sn[0],sn[1]);Ce<at&&(H=Ne,at=Ce)}if(H===0)return{x:jt[0],y:ce[0]};if(H===1){var en=jt.length;return{x:jt[en-1],y:ce[en-1]}}at=1/0;for(var dn=0;dn<32&&!(de<Ke);dn++){var En=H-de,mn=H+de,jn=[st.apply(void 0,(0,Y.Z)(jt.concat([En]))),st.apply(void 0,(0,Y.Z)(ce.concat([En])))],Wn=yt(St[0],St[1],jn[0],jn[1]);if(En>=0&&Wn<at)H=En,at=Wn;else{var tr=[st.apply(void 0,(0,Y.Z)(jt.concat([mn]))),st.apply(void 0,(0,Y.Z)(ce.concat([mn])))],pr=yt(St[0],St[1],tr[0],tr[1]);mn<=1&&pr<at?(H=mn,at=pr):de*=.5}}return{x:st.apply(void 0,(0,Y.Z)(jt.concat([H]))),y:st.apply(void 0,(0,Y.Z)(ce.concat([H])))}}function Ut(jt,ce){for(var ae=0,ye=jt.length,st=0;st<ye;st++){var D=jt[st],H=ce[st],at=jt[(st+1)%ye],St=ce[(st+1)%ye];ae+=yt(D,H,at,St)}return ae/2}function nt(jt,ce,ae,ye){return G([jt,ae],[ce,ye])}function ie(jt,ce,ae,ye){return yt(jt,ce,ae,ye)}function qt(jt,ce,ae,ye,st){return{x:(1-st)*jt+st*ae,y:(1-st)*ce+st*ye}}function At(jt,ce,ae,ye,st,D){var H=(ae-jt)*(st-jt)+(ye-ce)*(D-ce);if(H<0)return yt(jt,ce,st,D);var at=(ae-jt)*(ae-jt)+(ye-ce)*(ye-ce);return H>at?yt(ae,ye,st,D):Pe(jt,ce,ae,ye,st,D)}function Pe(jt,ce,ae,ye,st,D){var H=[ae-jt,ye-ce];if(tt.I6(H,[0,0]))return Math.sqrt((st-jt)*(st-jt)+(D-ce)*(D-ce));var at=[-H[1],H[0]];tt.Fv(at,at);var St=[st-jt,D-ce];return Math.abs(tt.AK(St,at))}function it(jt,ce,ae,ye){return Math.atan2(ye-ce,ae-jt)}function Pt(jt,ce,ae,ye,st){var D=1-st;return D*D*D*jt+3*ce*st*D*D+3*ae*st*st*D+ye*st*st*st}function q(jt,ce,ae,ye,st){var D=1-st;return 3*(D*D*(ce-jt)+2*D*st*(ae-ce)+st*st*(ye-ae))}function Nt(jt,ce,ae,ye){var st=-3*jt+9*ce-9*ae+3*ye,D=6*jt-12*ce+6*ae,H=3*ce-3*jt,at=[],St,Lt,ge;if((0,Z.Z)(st,0))(0,Z.Z)(D,0)||(St=-H/D,St>=0&&St<=1&&at.push(St));else{var de=D*D-4*st*H;(0,Z.Z)(de,0)?at.push(-D/(2*st)):de>0&&(ge=Math.sqrt(de),St=(-D+ge)/(2*st),Lt=(-D-ge)/(2*st),St>=0&&St<=1&&at.push(St),Lt>=0&&Lt<=1&&at.push(Lt))}return at}function It(jt,ce,ae,ye,st,D,H,at,St){var Lt=Pt(jt,ae,st,H,St),ge=Pt(ce,ye,D,at,St),de=qt(jt,ce,ae,ye,St),ze=qt(ae,ye,st,D,St),Ne=qt(st,D,H,at,St),sn=qt(de.x,de.y,ze.x,ze.y,St),Ce=qt(ze.x,ze.y,Ne.x,Ne.y,St);return[[jt,ce,de.x,de.y,sn.x,sn.y,Lt,ge],[Lt,ge,Ce.x,Ce.y,Ne.x,Ne.y,H,at]]}function U(jt,ce,ae,ye,st,D,H,at,St){if(St===0)return Ut([jt,ae,st,H],[ce,ye,D,at]);var Lt=It(jt,ce,ae,ye,st,D,H,at,.5),ge=[].concat(_toConsumableArray(Lt[0]),[St-1]),de=[].concat(_toConsumableArray(Lt[1]),[St-1]);return U.apply(void 0,_toConsumableArray(ge))+U.apply(void 0,_toConsumableArray(de))}function ht(jt,ce,ae,ye,st,D,H,at){for(var St=[jt,H],Lt=[ce,at],ge=Nt(jt,ae,st,H),de=Nt(ce,ye,D,at),ze=0;ze<ge.length;ze++)St.push(Pt(jt,ae,st,H,ge[ze]));for(var Ne=0;Ne<de.length;Ne++)Lt.push(Pt(ce,ye,D,at,de[Ne]));return G(St,Lt)}function ne(jt,ce,ae,ye,st,D,H,at){return U(jt,ce,ae,ye,st,D,H,at,3)}function xe(jt,ce,ae,ye,st,D,H,at,St,Lt,ge){return we([jt,ae,st,H],[ce,ye,D,at],St,Lt,Pt,ge)}function _e(jt,ce,ae,ye,st,D,H,at,St,Lt,ge){var de=xe(jt,ce,ae,ye,st,D,H,at,St,Lt,ge);return yt(de.x,de.y,St,Lt)}function Xe(jt,ce,ae,ye,st,D,H,at,St){return{x:Pt(jt,ae,st,H,St),y:Pt(ce,ye,D,at,St)}}function Re(jt,ce,ae,ye,st,D,H,at,St){var Lt=q(jt,ae,st,H,St),ge=q(ce,ye,D,at,St);return Ot(Math.atan2(ge,Lt))}function un(jt){for(var ce=0,ae=[],ye=0;ye<jt.length-1;ye++){var st=jt[ye],D=jt[ye+1],H=yt(st[0],st[1],D[0],D[1]),at={from:st,to:D,length:H};ae.push(at),ce+=H}return{segments:ae,totalLength:ce}}function cn(jt){if(jt.length<2)return 0;for(var ce=0,ae=0;ae<jt.length-1;ae++){var ye=jt[ae],st=jt[ae+1];ce+=yt(ye[0],ye[1],st[0],st[1])}return ce}function Jt(jt,ce){if(ce>1||ce<0||jt.length<2)return null;var ae=un(jt),ye=ae.segments,st=ae.totalLength;if(st===0)return{x:jt[0][0],y:jt[0][1]};for(var D=0,H=null,at=0;at<ye.length;at++){var St=ye[at],Lt=St.from,ge=St.to,de=St.length/st;if(ce>=D&&ce<=D+de){var ze=(ce-D)/de;H=qt(Lt[0],Lt[1],ge[0],ge[1],ze);break}D+=de}return H}function ct(jt,ce){if(ce>1||ce<0||jt.length<2)return 0;for(var ae=un(jt),ye=ae.segments,st=ae.totalLength,D=0,H=0,at=0;at<ye.length;at++){var St=ye[at],Lt=St.from,ge=St.to,de=St.length/st;if(ce>=D&&ce<=D+de){H=Math.atan2(ge[1]-Lt[1],ge[0]-Lt[0]);break}D+=de}return H}function Ct(jt,ce,ae){for(var ye=1/0,st=0;st<jt.length-1;st++){var D=jt[st],H=jt[st+1],at=At(D[0],D[1],H[0],H[1],ce,ae);at<ye&&(ye=at)}return ye}function me(jt){for(var ce=[],ae=[],ye=0;ye<jt.length;ye++){var st=jt[ye];ce.push(st[0]),ae.push(st[1])}return G(ce,ae)}function he(jt){return cn(jt)}function Tt(jt,ce){return Jt(jt,ce)}function re(jt,ce,ae){return Ct(jt,ce,ae)}function Yt(jt,ce){return ct(jt,ce)}function N(jt){var ce=jt.slice(0);return jt.length&&ce.push(jt[0]),ce}function kt(jt){return me(jt)}function oe(jt){return cn(N(jt))}function C(jt,ce){return Jt(N(jt),ce)}function z(jt,ce,ae){return Ct(N(jt),ce,ae)}function Ft(jt,ce){return ct(N(jt),ce)}function te(jt,ce,ae,ye){var st=1-ye;return st*st*jt+2*ye*st*ce+ye*ye*ae}function se(jt,ce,ae){var ye=jt+ae-2*ce;if((0,Z.Z)(ye,0))return[.5];var st=(jt-ce)/ye;return st<=1&&st>=0?[st]:[]}function Se(jt,ce,ae,ye,st,D,H){var at=te(jt,ae,st,H),St=te(ce,ye,D,H),Lt=qt(jt,ce,ae,ye,H),ge=qt(ae,ye,st,D,H);return[[jt,ce,Lt.x,Lt.y,at,St],[at,St,ge.x,ge.y,st,D]]}function be(jt,ce,ae,ye,st,D,H){if(H===0)return(yt(jt,ce,ae,ye)+yt(ae,ye,st,D)+yt(jt,ce,st,D))/2;var at=Se(jt,ce,ae,ye,st,D,.5),St=at[0],Lt=at[1];return St.push(H-1),Lt.push(H-1),be.apply(void 0,_toConsumableArray(St))+be.apply(void 0,_toConsumableArray(Lt))}function Ze(jt,ce,ae,ye,st,D){var H=se(jt,ae,st)[0],at=se(ce,ye,D)[0],St=[jt,st],Lt=[ce,D];return H!==void 0&&St.push(te(jt,ae,st,H)),at!==void 0&&Lt.push(te(ce,ye,D,at)),G(St,Lt)}function tn(jt,ce,ae,ye,st,D){return be(jt,ce,ae,ye,st,D,3)}function Ge(jt,ce,ae,ye,st,D,H,at){return we([jt,ae,st],[ce,ye,D],H,at,te)}function Be(jt,ce,ae,ye,st,D,H,at){var St=Ge(jt,ce,ae,ye,st,D,H,at);return yt(St.x,St.y,H,at)}},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function($t){try{let pt=function(){G||(G=!0,tt())},Vt=function(){try{yt.documentElement.doScroll("left")}catch(K){return void setTimeout(Vt,50)}pt()};var bt=pt,Et=Vt,L=(L=document.getElementsByTagName("script"))[L.length-1],Qt=L.getAttribute("data-injectcss"),L=L.getAttribute("data-disable-injectsvg");if(!L){var Y,Z,tt,yt,G,Ot=function(K,X){X.parentNode.insertBefore(K,X)};if(Qt&&!$t.__iconfont__svg__cssinject__){$t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(K){console&&console.log(K)}}Y=function(){var K,X=document.createElement("div");X.innerHTML=$t._iconfont_svg_string_3580659,(X=X.getElementsByTagName("svg")[0])&&(X.setAttribute("aria-hidden","true"),X.style.position="absolute",X.style.width=0,X.style.height=0,X.style.overflow="hidden",X=X,(K=document.body).firstChild?Ot(X,K.firstChild):K.appendChild(X))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(Y,0):(Z=function(){document.removeEventListener("DOMContentLoaded",Z,!1),Y()},document.addEventListener("DOMContentLoaded",Z,!1)):document.attachEvent&&(tt=Y,yt=$t.document,G=!1,Vt(),yt.onreadystatechange=function(){yt.readyState=="complete"&&(yt.onreadystatechange=null,pt())})}}catch(pt){}}(window)},4771:function(){},81957:function($t,Qt){"use strict";var L=function(Y,Z,tt){return Y<Z?Z:Y>tt?tt:Y};Qt.Z=L},5199:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){return Array.isArray(Z)}},90134:function($t,Qt,L){"use strict";var Y=L(95456),Z=function(tt){return(0,Y.Z)(tt,"Boolean")};Qt.Z=Z},45607:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){return typeof Z=="function"}},95147:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){return Z==null}},80450:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Z}});var Y=1e-5;function Z(tt,yt,G){return G===void 0&&(G=Y),tt===yt||Math.abs(tt-yt)<G}},25897:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){return typeof Z=="number"}},4637:function($t,Qt){"use strict";Qt.Z=function(L){var Y=typeof L;return L!==null&&Y==="object"||Y==="function"}},76714:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){return typeof Z=="string"}},95456:function($t,Qt){"use strict";var L={}.toString,Y=function(Z,tt){return L.call(Z)==="[object "+tt+"]"};Qt.Z=Y},71154:function($t,Qt){"use strict";var L=function(Y){return Y===void 0};Qt.Z=L},13882:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Y}});function Y(Z){if(!Array.isArray(Z))return-1/0;var tt=Z.length;if(!tt)return-1/0;for(var yt=Z[0],G=1;G<tt;G++)yt=Math.max(yt,Z[G]);return yt}},71523:function($t,Qt,L){"use strict";var Y=L(5199);Qt.Z=function(Z){if((0,Y.Z)(Z))return Z.reduce(function(tt,yt){return Math.min(tt,yt)},Z[0])}},8614:function($t,Qt){"use strict";var L=function(Y,Z){return(Y%Z+Z)%Z};Qt.Z=L},75839:function($t,Qt,L){"use strict";L.d(Qt,{Y:function(){return X}});var Y=L(97582),Z=L(64985);function tt(Zt,Mt,zt){if(Zt[zt].length>7){Zt[zt].shift();for(var Rt=Zt[zt],Gt=zt;Rt.length;)Mt[zt]="A",Zt.splice(Gt+=1,0,["C"].concat(Rt.splice(0,6)));Zt.splice(zt,1)}}var yt=L(4848),G=L(11013);function Ot(Zt){return(0,G.y)(Zt)&&Zt.every(function(Mt){var zt=Mt[0];return"MC".includes(zt)})}var bt=L(74873);function Et(Zt,Mt,zt,Rt,Gt,ve){var Me=.3333333333333333,Ue=2/3;return[Me*Zt+Ue*zt,Me*Mt+Ue*Rt,Me*Gt+Ue*zt,Me*ve+Ue*Rt,Gt,ve]}var pt=L(17570),Vt=function(Zt,Mt,zt,Rt){var Gt=.5,ve=(0,pt.k)([Zt,Mt],[zt,Rt],Gt);return(0,Y.ev)((0,Y.ev)([],ve,!0),[zt,Rt,zt,Rt],!1)};function K(Zt,Mt){var zt=Zt[0],Rt=Zt.slice(1).map(Number),Gt=Rt[0],ve=Rt[1],Me,Ue=Mt.x1,Ke=Mt.y1,we=Mt.x,Ut=Mt.y;switch("TQ".includes(zt)||(Mt.qx=null,Mt.qy=null),zt){case"M":return Mt.x=Gt,Mt.y=ve,Zt;case"A":return Me=[Ue,Ke].concat(Rt),["C"].concat((0,bt.W)(Me[0],Me[1],Me[2],Me[3],Me[4],Me[5],Me[6],Me[7],Me[8],Me[9]));case"Q":return Mt.qx=Gt,Mt.qy=ve,Me=[Ue,Ke].concat(Rt),["C"].concat(Et(Me[0],Me[1],Me[2],Me[3],Me[4],Me[5]));case"L":return["C"].concat(Vt(Ue,Ke,Gt,ve));case"Z":return Ue===we&&Ke===Ut?["C",Ue,Ke,we,Ut,we,Ut]:["C"].concat(Vt(Ue,Ke,we,Ut));default:}return Zt}function X(Zt,Mt){if(Mt===void 0&&(Mt=!1),Ot(Zt)){var zt=[].concat(Zt);return Mt?[zt,[]]:zt}for(var Rt=(0,yt.A)(Zt),Gt=(0,Y.pi)({},Z.z),ve=[],Me="",Ue=Rt.length,Ke,we,Ut=[],nt=0;nt<Ue;nt+=1){Rt[nt]&&(Me=Rt[nt][0]),ve[nt]=Me;var ie=K(Rt[nt],Gt);Rt[nt]=ie,tt(Rt,ve,nt),Ue=Rt.length,Me==="Z"&&Ut.push(nt),Ke=Rt[nt],we=Ke.length,Gt.x1=+Ke[we-2],Gt.y1=+Ke[we-1],Gt.x2=+Ke[we-4]||Gt.x1,Gt.y2=+Ke[we-3]||Gt.y1}return Mt?[Rt,Ut]:Rt}},18323:function($t,Qt,L){"use strict";L.d(Qt,{R:function(){return Y}});var Y={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0}},64985:function($t,Qt,L){"use strict";L.d(Qt,{z:function(){return Y}});var Y={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null}},74873:function($t,Qt,L){"use strict";L.d(Qt,{W:function(){return Z}});function Y(tt,yt,G){var Ot=tt*Math.cos(G)-yt*Math.sin(G),bt=tt*Math.sin(G)+yt*Math.cos(G);return{x:Ot,y:bt}}function Z(tt,yt,G,Ot,bt,Et,pt,Vt,K,X){var Zt=tt,Mt=yt,zt=G,Rt=Ot,Gt=Vt,ve=K,Me=Math.PI*120/180,Ue=Math.PI/180*(+bt||0),Ke=[],we,Ut,nt,ie,qt;if(X)Ut=X[0],nt=X[1],ie=X[2],qt=X[3];else{we=Y(Zt,Mt,-Ue),Zt=we.x,Mt=we.y,we=Y(Gt,ve,-Ue),Gt=we.x,ve=we.y;var At=(Zt-Gt)/2,Pe=(Mt-ve)/2,it=At*At/(zt*zt)+Pe*Pe/(Rt*Rt);it>1&&(it=Math.sqrt(it),zt*=it,Rt*=it);var Pt=zt*zt,q=Rt*Rt,Nt=(Et===pt?-1:1)*Math.sqrt(Math.abs((Pt*q-Pt*Pe*Pe-q*At*At)/(Pt*Pe*Pe+q*At*At)));ie=Nt*zt*Pe/Rt+(Zt+Gt)/2,qt=Nt*-Rt*At/zt+(Mt+ve)/2,Ut=Math.asin(((Mt-qt)/Rt*Math.pow(10,9)>>0)/Math.pow(10,9)),nt=Math.asin(((ve-qt)/Rt*Math.pow(10,9)>>0)/Math.pow(10,9)),Ut=Zt<ie?Math.PI-Ut:Ut,nt=Gt<ie?Math.PI-nt:nt,Ut<0&&(Ut=Math.PI*2+Ut),nt<0&&(nt=Math.PI*2+nt),pt&&Ut>nt&&(Ut-=Math.PI*2),!pt&&nt>Ut&&(nt-=Math.PI*2)}var It=nt-Ut;if(Math.abs(It)>Me){var U=nt,ht=Gt,ne=ve;nt=Ut+Me*(pt&&nt>Ut?1:-1),Gt=ie+zt*Math.cos(nt),ve=qt+Rt*Math.sin(nt),Ke=Z(Gt,ve,zt,Rt,bt,0,pt,ht,ne,[nt,U,ie,qt])}It=nt-Ut;var xe=Math.cos(Ut),_e=Math.sin(Ut),Xe=Math.cos(nt),Re=Math.sin(nt),un=Math.tan(It/4),cn=4/3*zt*un,Jt=4/3*Rt*un,ct=[Zt,Mt],Ct=[Zt+cn*_e,Mt-Jt*xe],me=[Gt+cn*Re,ve-Jt*Xe],he=[Gt,ve];if(Ct[0]=2*ct[0]-Ct[0],Ct[1]=2*ct[1]-Ct[1],X)return Ct.concat(me,he,Ke);Ke=Ct.concat(me,he,Ke);for(var Tt=[],re=0,Yt=Ke.length;re<Yt;re+=1)Tt[re]=re%2?Y(Ke[re-1],Ke[re],Ue).y:Y(Ke[re],Ke[re+1],Ue).x;return Tt}},28659:function($t,Qt,L){"use strict";L.d(Qt,{U:function(){return Y}});function Y(Z){return Z.map(function(tt){return Array.isArray(tt)?[].concat(tt):tt})}},4848:function($t,Qt,L){"use strict";L.d(Qt,{A:function(){return Ke}});var Y=L(97582),Z=L(11013),tt=L(64985),yt=L(41010),G=L(56346),Ot=L(18323);function bt(we){for(var Ut=we.pathValue[we.segmentStart],nt=Ut.toLowerCase(),ie=we.data;ie.length>=Ot.R[nt]&&(nt==="m"&&ie.length>2?(we.segments.push([Ut].concat(ie.splice(0,2))),nt="l",Ut=Ut==="m"?"l":"L"):we.segments.push([Ut].concat(ie.splice(0,Ot.R[nt]))),!!Ot.R[nt]););}function Et(we){var Ut=we.index,nt=we.pathValue,ie=nt.charCodeAt(Ut);if(ie===48){we.param=0,we.index+=1;return}if(ie===49){we.param=1,we.index+=1;return}we.err='[path-util]: invalid Arc flag "'.concat(nt[Ut],'", expecting 0 or 1 at index ').concat(Ut)}function pt(we){return we>=48&&we<=57||we===43||we===45||we===46}function Vt(we){return we>=48&&we<=57}function K(we){var Ut=we.max,nt=we.pathValue,ie=we.index,qt=ie,At=!1,Pe=!1,it=!1,Pt=!1,q;if(qt>=Ut){we.err="[path-util]: Invalid path value at index ".concat(qt,', "pathValue" is missing param');return}if(q=nt.charCodeAt(qt),(q===43||q===45)&&(qt+=1,q=nt.charCodeAt(qt)),!Vt(q)&&q!==46){we.err="[path-util]: Invalid path value at index ".concat(qt,', "').concat(nt[qt],'" is not a number');return}if(q!==46){if(At=q===48,qt+=1,q=nt.charCodeAt(qt),At&&qt<Ut&&q&&Vt(q)){we.err="[path-util]: Invalid path value at index ".concat(ie,', "').concat(nt[ie],'" illegal number');return}for(;qt<Ut&&Vt(nt.charCodeAt(qt));)qt+=1,Pe=!0;q=nt.charCodeAt(qt)}if(q===46){for(Pt=!0,qt+=1;Vt(nt.charCodeAt(qt));)qt+=1,it=!0;q=nt.charCodeAt(qt)}if(q===101||q===69){if(Pt&&!Pe&&!it){we.err="[path-util]: Invalid path value at index ".concat(qt,', "').concat(nt[qt],'" invalid float exponent');return}if(qt+=1,q=nt.charCodeAt(qt),(q===43||q===45)&&(qt+=1),qt<Ut&&Vt(nt.charCodeAt(qt)))for(;qt<Ut&&Vt(nt.charCodeAt(qt));)qt+=1;else{we.err="[path-util]: Invalid path value at index ".concat(qt,', "').concat(nt[qt],'" invalid integer exponent');return}}we.index=qt,we.param=+we.pathValue.slice(ie,qt)}function X(we){var Ut=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return we===10||we===13||we===8232||we===8233||we===32||we===9||we===11||we===12||we===160||we>=5760&&Ut.includes(we)}function Zt(we){for(var Ut=we.pathValue,nt=we.max;we.index<nt&&X(Ut.charCodeAt(we.index));)we.index+=1}function Mt(we){switch(we|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function zt(we){return(we|32)===97}function Rt(we){var Ut=we.max,nt=we.pathValue,ie=we.index,qt=nt.charCodeAt(ie),At=Ot.R[nt[ie].toLowerCase()];if(we.segmentStart=ie,!Mt(qt)){we.err='[path-util]: Invalid path value "'.concat(nt[ie],'" is not a path command');return}if(we.index+=1,Zt(we),we.data=[],!At){bt(we);return}for(;;){for(var Pe=At;Pe>0;Pe-=1){if(zt(qt)&&(Pe===3||Pe===4)?Et(we):K(we),we.err.length)return;we.data.push(we.param),Zt(we),we.index<Ut&&nt.charCodeAt(we.index)===44&&(we.index+=1,Zt(we))}if(we.index>=we.max||!pt(nt.charCodeAt(we.index)))break}bt(we)}var Gt=function(){function we(Ut){this.pathValue=Ut,this.segments=[],this.max=Ut.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return we}();function ve(we){if((0,G.n)(we))return[].concat(we);var Ut=new Gt(we);for(Zt(Ut);Ut.index<Ut.max&&!Ut.err.length;)Rt(Ut);return Ut.err?Ut.err:Ut.segments}function Me(we){if((0,yt.b)(we))return[].concat(we);var Ut=ve(we),nt=0,ie=0,qt=0,At=0;return Ut.map(function(Pe){var it=Pe.slice(1).map(Number),Pt=Pe[0],q=Pt.toUpperCase();if(Pt==="M")return nt=it[0],ie=it[1],qt=nt,At=ie,["M",nt,ie];var Nt;if(Pt!==q)switch(q){case"A":Nt=[q,it[0],it[1],it[2],it[3],it[4],it[5]+nt,it[6]+ie];break;case"V":Nt=[q,it[0]+ie];break;case"H":Nt=[q,it[0]+nt];break;default:{var It=it.map(function(ht,ne){return ht+(ne%2?ie:nt)});Nt=[q].concat(It)}}else Nt=[q].concat(it);var U=Nt.length;switch(q){case"Z":nt=qt,ie=At;break;case"H":nt=Nt[1];break;case"V":ie=Nt[1];break;default:nt=Nt[U-2],ie=Nt[U-1],q==="M"&&(qt=nt,At=ie)}return Nt})}function Ue(we,Ut){var nt=we[0],ie=Ut.x1,qt=Ut.y1,At=Ut.x2,Pe=Ut.y2,it=we.slice(1).map(Number),Pt=we;if("TQ".includes(nt)||(Ut.qx=null,Ut.qy=null),nt==="H")Pt=["L",we[1],qt];else if(nt==="V")Pt=["L",ie,we[1]];else if(nt==="S"){var q=ie*2-At,Nt=qt*2-Pe;Ut.x1=q,Ut.y1=Nt,Pt=["C",q,Nt].concat(it)}else if(nt==="T"){var It=ie*2-Ut.qx,U=qt*2-Ut.qy;Ut.qx=It,Ut.qy=U,Pt=["Q",It,U].concat(it)}else if(nt==="Q"){var ht=it[0],ne=it[1];Ut.qx=ht,Ut.qy=ne}return Pt}function Ke(we){if((0,Z.y)(we))return[].concat(we);for(var Ut=Me(we),nt=(0,Y.pi)({},tt.z),ie=0;ie<Ut.length;ie+=1){Ut[ie]=Ue(Ut[ie],nt);var qt=Ut[ie],At=qt.length;nt.x1=+qt[At-2],nt.y1=+qt[At-1],nt.x2=+qt[At-4]||nt.x1,nt.y2=+qt[At-3]||nt.y1}return Ut}},65850:function($t,Qt,L){"use strict";L.d(Qt,{G:function(){return Y}});function Y(Z){var tt=Z.slice(1).map(function(yt,G,Ot){return G?Ot[G-1].slice(-2).concat(yt.slice(1)):Z[0].slice(1).concat(yt.slice(1))}).map(function(yt){return yt.map(function(G,Ot){return yt[yt.length-Ot-2*(1-Ot%2)]})}).reverse();return[["M"].concat(tt[0].slice(0,2))].concat(tt.map(function(yt){return["C"].concat(yt.slice(2))}))}},44078:function($t,Qt,L){"use strict";L.d(Qt,{y:function(){return Y}});function Y(Z,tt){return Math.sqrt((Z[0]-tt[0])*(Z[0]-tt[0])+(Z[1]-tt[1])*(Z[1]-tt[1]))}},99872:function($t,Qt,L){"use strict";L.d(Qt,{x:function(){return Ot}});var Y=L(17570),Z=L(6489),tt=50;function yt(bt,Et){Et===void 0&&(Et=.5);var pt=bt.slice(0,2),Vt=bt.slice(2,4),K=bt.slice(4,6),X=bt.slice(6,8),Zt=(0,Y.k)(pt,Vt,Et),Mt=(0,Y.k)(Vt,K,Et),zt=(0,Y.k)(K,X,Et),Rt=(0,Y.k)(Zt,Mt,Et),Gt=(0,Y.k)(Mt,zt,Et),ve=(0,Y.k)(Rt,Gt,Et);return[["C"].concat(Zt,Rt,ve),["C"].concat(Gt,zt,X)]}function G(bt){return bt.map(function(Et,pt,Vt){var K=pt&&Vt[pt-1].slice(-2).concat(Et.slice(1)),X=pt?(0,Z.S)(K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],K[8],{bbox:!1}).length:0,Zt;return pt?Zt=X?yt(K):[Et,Et]:Zt=[Et],{s:Et,ss:Zt,l:X}})}function Ot(bt,Et,pt,Vt){if(Vt===void 0&&(Vt=0),Vt>tt)return console.warn("Maximum recursion depth reached in equalizeSegments"),[bt,Et];var K=G(bt),X=G(Et),Zt=K.length,Mt=X.length,zt=K.filter(function(nt){return nt.l}).length,Rt=X.filter(function(nt){return nt.l}).length,Gt=K.filter(function(nt){return nt.l}).reduce(function(nt,ie){var qt=ie.l;return nt+qt},0)/zt||0,ve=X.filter(function(nt){return nt.l}).reduce(function(nt,ie){var qt=ie.l;return nt+qt},0)/Rt||0,Me=pt||Math.max(Zt,Mt),Ue=[Gt,ve],Ke=[Me-Zt,Me-Mt],we=0,Ut=[K,X].map(function(nt,ie){return nt.l===Me?nt.map(function(qt){return qt.s}):nt.map(function(qt,At){return we=At&&Ke[ie]&&qt.l>=Ue[ie],Ke[ie]-=we?1:0,we?qt.ss:[qt.s]}).flat()});return Ut[0].length===Ut[1].length?Ut:Ot(Ut[0],Ut[1],Me,Vt+1)}},92455:function($t,Qt,L){"use strict";L.d(Qt,{b:function(){return yt}});var Y=L(75839);function Z(G,Ot,bt,Et,pt,Vt,K,X){return 3*((X-Ot)*(bt+pt)-(K-G)*(Et+Vt)+Et*(G-pt)-bt*(Ot-Vt)+X*(pt+G/3)-K*(Vt+Ot/3))/20}function tt(G){var Ot=0,bt=0,Et=0;return(0,Y.Y)(G).map(function(pt){var Vt;switch(pt[0]){case"M":return Ot=pt[1],bt=pt[2],0;default:var K=pt.slice(1),X=K[0],Zt=K[1],Mt=K[2],zt=K[3],Rt=K[4],Gt=K[5];return Et=Z(Ot,bt,X,Zt,Mt,zt,Rt,Gt),Vt=pt.slice(-2),Ot=Vt[0],bt=Vt[1],Et}}).reduce(function(pt,Vt){return pt+Vt},0)}function yt(G){return tt(G)>=0}},84329:function($t,Qt,L){"use strict";L.d(Qt,{r:function(){return tt}});var Y=L(97582),Z=L(32262);function tt(yt,G,Ot){return(0,Z.s)(yt,G,(0,Y.pi)((0,Y.pi)({},Ot),{bbox:!1,length:!0})).point}},83555:function($t,Qt,L){"use strict";L.d(Qt,{g:function(){return tt}});var Y=L(44078);function Z(yt){var G=yt.length,Ot=G-1;return yt.map(function(bt,Et){return yt.map(function(pt,Vt){var K=Et+Vt,X;return Vt===0||yt[K]&&yt[K][0]==="M"?(X=yt[K],["M"].concat(X.slice(-2))):(K>=G&&(K-=Ot),yt[K])})})}function tt(yt,G){var Ot=yt.length-1,bt=[],Et=0,pt=0,Vt=Z(yt);return Vt.forEach(function(K,X){yt.slice(1).forEach(function(Zt,Mt){pt+=(0,Y.y)(yt[(X+Mt)%Ot].slice(-2),G[Mt%Ot].slice(-2))}),bt[X]=pt,pt=0}),Et=bt.indexOf(Math.min.apply(null,bt)),Vt[Et]}},69877:function($t,Qt,L){"use strict";L.d(Qt,{D:function(){return tt}});var Y=L(97582),Z=L(32262);function tt(yt,G){return(0,Z.s)(yt,void 0,(0,Y.pi)((0,Y.pi)({},G),{bbox:!1,length:!0})).length}},41010:function($t,Qt,L){"use strict";L.d(Qt,{b:function(){return Z}});var Y=L(56346);function Z(tt){return(0,Y.n)(tt)&&tt.every(function(yt){var G=yt[0];return G===G.toUpperCase()})}},11013:function($t,Qt,L){"use strict";L.d(Qt,{y:function(){return Z}});var Y=L(41010);function Z(tt){return(0,Y.b)(tt)&&tt.every(function(yt){var G=yt[0];return"ACLMQZ".includes(G)})}},56346:function($t,Qt,L){"use strict";L.d(Qt,{n:function(){return Z}});var Y=L(18323);function Z(tt){return Array.isArray(tt)&&tt.every(function(yt){var G=yt[0].toLowerCase();return Y.R[G]===yt.length-1&&"achlmqstvz".includes(G)})}},17570:function($t,Qt,L){"use strict";L.d(Qt,{k:function(){return Y}});function Y(Z,tt,yt){var G=Z[0],Ot=Z[1],bt=tt[0],Et=tt[1];return[G+(bt-G)*yt,Ot+(Et-Ot)*yt]}},32262:function($t,Qt,L){"use strict";L.d(Qt,{s:function(){return K}});var Y=L(4848),Z=L(17570),tt=L(44078);function yt(X,Zt,Mt,zt,Rt){var Gt=(0,tt.y)([X,Zt],[Mt,zt]),ve={x:0,y:0};if(typeof Rt=="number")if(Rt<=0)ve={x:X,y:Zt};else if(Rt>=Gt)ve={x:Mt,y:zt};else{var Me=(0,Z.k)([X,Zt],[Mt,zt],Rt/Gt),Ue=Me[0],Ke=Me[1];ve={x:Ue,y:Ke}}return{length:Gt,point:ve,min:{x:Math.min(X,Mt),y:Math.min(Zt,zt)},max:{x:Math.max(X,Mt),y:Math.max(Zt,zt)}}}function G(X,Zt){var Mt=X.x,zt=X.y,Rt=Zt.x,Gt=Zt.y,ve=Mt*Rt+zt*Gt,Me=Math.sqrt((Math.pow(Mt,2)+Math.pow(zt,2))*(Math.pow(Rt,2)+Math.pow(Gt,2))),Ue=Mt*Gt-zt*Rt<0?-1:1,Ke=Ue*Math.acos(ve/Me);return Ke}function Ot(X,Zt,Mt,zt,Rt,Gt,ve,Me,Ue,Ke){var we=Math.abs,Ut=Math.sin,nt=Math.cos,ie=Math.sqrt,qt=Math.PI,At=we(Mt),Pe=we(zt),it=(Rt%360+360)%360,Pt=it*(qt/180);if(X===Me&&Zt===Ue)return{x:X,y:Zt};if(At===0||Pe===0)return yt(X,Zt,Me,Ue,Ke).point;var q=(X-Me)/2,Nt=(Zt-Ue)/2,It={x:nt(Pt)*q+Ut(Pt)*Nt,y:-Ut(Pt)*q+nt(Pt)*Nt},U=Math.pow(It.x,2)/Math.pow(At,2)+Math.pow(It.y,2)/Math.pow(Pe,2);U>1&&(At*=ie(U),Pe*=ie(U));var ht=Math.pow(At,2)*Math.pow(Pe,2)-Math.pow(At,2)*Math.pow(It.y,2)-Math.pow(Pe,2)*Math.pow(It.x,2),ne=Math.pow(At,2)*Math.pow(It.y,2)+Math.pow(Pe,2)*Math.pow(It.x,2),xe=ht/ne;xe=xe<0?0:xe;var _e=(Gt!==ve?1:-1)*ie(xe),Xe={x:_e*(At*It.y/Pe),y:_e*(-(Pe*It.x)/At)},Re={x:nt(Pt)*Xe.x-Ut(Pt)*Xe.y+(X+Me)/2,y:Ut(Pt)*Xe.x+nt(Pt)*Xe.y+(Zt+Ue)/2},un={x:(It.x-Xe.x)/At,y:(It.y-Xe.y)/Pe},cn=G({x:1,y:0},un),Jt={x:(-It.x-Xe.x)/At,y:(-It.y-Xe.y)/Pe},ct=G(un,Jt);!ve&&ct>0?ct-=2*qt:ve&&ct<0&&(ct+=2*qt),ct%=2*qt;var Ct=cn+ct*Ke,me=At*nt(Ct),he=Pe*Ut(Ct),Tt={x:nt(Pt)*me-Ut(Pt)*he+Re.x,y:Ut(Pt)*me+nt(Pt)*he+Re.y};return Tt}function bt(X,Zt,Mt,zt,Rt,Gt,ve,Me,Ue,Ke,we){var Ut,nt=we.bbox,ie=nt===void 0?!0:nt,qt=we.length,At=qt===void 0?!0:qt,Pe=we.sampleSize,it=Pe===void 0?30:Pe,Pt=typeof Ke=="number",q=X,Nt=Zt,It=0,U=[q,Nt,It],ht=[q,Nt],ne=0,xe={x:0,y:0},_e=[{x:q,y:Nt}];Pt&&Ke<=0&&(xe={x:q,y:Nt});for(var Xe=0;Xe<=it;Xe+=1){if(ne=Xe/it,Ut=Ot(X,Zt,Mt,zt,Rt,Gt,ve,Me,Ue,ne),q=Ut.x,Nt=Ut.y,ie&&_e.push({x:q,y:Nt}),At&&(It+=(0,tt.y)(ht,[q,Nt])),ht=[q,Nt],Pt&&It>=Ke&&Ke>U[2]){var Re=(It-Ke)/(It-U[2]);xe={x:ht[0]*(1-Re)+U[0]*Re,y:ht[1]*(1-Re)+U[1]*Re}}U=[q,Nt,It]}return Pt&&Ke>=It&&(xe={x:Me,y:Ue}),{length:It,point:xe,min:{x:Math.min.apply(null,_e.map(function(un){return un.x})),y:Math.min.apply(null,_e.map(function(un){return un.y}))},max:{x:Math.max.apply(null,_e.map(function(un){return un.x})),y:Math.max.apply(null,_e.map(function(un){return un.y}))}}}var Et=L(6489);function pt(X,Zt,Mt,zt,Rt,Gt,ve){var Me=1-ve;return{x:Math.pow(Me,2)*X+2*Me*ve*Mt+Math.pow(ve,2)*Rt,y:Math.pow(Me,2)*Zt+2*Me*ve*zt+Math.pow(ve,2)*Gt}}function Vt(X,Zt,Mt,zt,Rt,Gt,ve,Me){var Ue,Ke=Me.bbox,we=Ke===void 0?!0:Ke,Ut=Me.length,nt=Ut===void 0?!0:Ut,ie=Me.sampleSize,qt=ie===void 0?10:ie,At=typeof ve=="number",Pe=X,it=Zt,Pt=0,q=[Pe,it,Pt],Nt=[Pe,it],It=0,U={x:0,y:0},ht=[{x:Pe,y:it}];At&&ve<=0&&(U={x:Pe,y:it});for(var ne=0;ne<=qt;ne+=1){if(It=ne/qt,Ue=pt(X,Zt,Mt,zt,Rt,Gt,It),Pe=Ue.x,it=Ue.y,we&&ht.push({x:Pe,y:it}),nt&&(Pt+=(0,tt.y)(Nt,[Pe,it])),Nt=[Pe,it],At&&Pt>=ve&&ve>q[2]){var xe=(Pt-ve)/(Pt-q[2]);U={x:Nt[0]*(1-xe)+q[0]*xe,y:Nt[1]*(1-xe)+q[1]*xe}}q=[Pe,it,Pt]}return At&&ve>=Pt&&(U={x:Rt,y:Gt}),{length:Pt,point:U,min:{x:Math.min.apply(null,ht.map(function(_e){return _e.x})),y:Math.min.apply(null,ht.map(function(_e){return _e.y}))},max:{x:Math.max.apply(null,ht.map(function(_e){return _e.x})),y:Math.max.apply(null,ht.map(function(_e){return _e.y}))}}}function K(X,Zt,Mt){for(var zt,Rt,Gt,ve,Me,Ue,Ke=(0,Y.A)(X),we=typeof Zt=="number",Ut,nt=[],ie,qt=0,At=0,Pe=0,it=0,Pt,q=[],Nt=[],It=0,U={x:0,y:0},ht=U,ne=U,xe=U,_e=0,Xe=0,Re=Ke.length;Xe<Re;Xe+=1)Pt=Ke[Xe],ie=Pt[0],Ut=ie==="M",nt=Ut?nt:[qt,At].concat(Pt.slice(1)),Ut?(Pe=Pt[1],it=Pt[2],U={x:Pe,y:it},ht=U,It=0,we&&Zt<.001&&(xe=U)):ie==="L"?(zt=yt(nt[0],nt[1],nt[2],nt[3],(Zt||0)-_e),It=zt.length,U=zt.min,ht=zt.max,ne=zt.point):ie==="A"?(Rt=bt(nt[0],nt[1],nt[2],nt[3],nt[4],nt[5],nt[6],nt[7],nt[8],(Zt||0)-_e,Mt||{}),It=Rt.length,U=Rt.min,ht=Rt.max,ne=Rt.point):ie==="C"?(Gt=(0,Et.S)(nt[0],nt[1],nt[2],nt[3],nt[4],nt[5],nt[6],nt[7],(Zt||0)-_e,Mt||{}),It=Gt.length,U=Gt.min,ht=Gt.max,ne=Gt.point):ie==="Q"?(ve=Vt(nt[0],nt[1],nt[2],nt[3],nt[4],nt[5],(Zt||0)-_e,Mt||{}),It=ve.length,U=ve.min,ht=ve.max,ne=ve.point):ie==="Z"&&(nt=[qt,At,Pe,it],Me=yt(nt[0],nt[1],nt[2],nt[3],(Zt||0)-_e),It=Me.length,U=Me.min,ht=Me.max,ne=Me.point),we&&_e<Zt&&_e+It>=Zt&&(xe=ne),Nt.push(ht),q.push(U),_e+=It,Ue=ie!=="Z"?Pt.slice(-2):[Pe,it],qt=Ue[0],At=Ue[1];return we&&Zt>=_e&&(xe={x:qt,y:At}),{length:_e,point:xe,min:{x:Math.min.apply(null,q.map(function(un){return un.x})),y:Math.min.apply(null,q.map(function(un){return un.y}))},max:{x:Math.max.apply(null,Nt.map(function(un){return un.x})),y:Math.max.apply(null,Nt.map(function(un){return un.y}))}}}},6489:function($t,Qt,L){"use strict";L.d(Qt,{S:function(){return tt}});var Y=L(44078);function Z(yt,G,Ot,bt,Et,pt,Vt,K,X){var Zt=1-X;return{x:Math.pow(Zt,3)*yt+3*Math.pow(Zt,2)*X*Ot+3*Zt*Math.pow(X,2)*Et+Math.pow(X,3)*Vt,y:Math.pow(Zt,3)*G+3*Math.pow(Zt,2)*X*bt+3*Zt*Math.pow(X,2)*pt+Math.pow(X,3)*K}}function tt(yt,G,Ot,bt,Et,pt,Vt,K,X,Zt){var Mt,zt=Zt.bbox,Rt=zt===void 0?!0:zt,Gt=Zt.length,ve=Gt===void 0?!0:Gt,Me=Zt.sampleSize,Ue=Me===void 0?10:Me,Ke=typeof X=="number",we=yt,Ut=G,nt=0,ie=[we,Ut,nt],qt=[we,Ut],At=0,Pe={x:0,y:0},it=[{x:we,y:Ut}];Ke&&X<=0&&(Pe={x:we,y:Ut});for(var Pt=0;Pt<=Ue;Pt+=1){if(At=Pt/Ue,Mt=Z(yt,G,Ot,bt,Et,pt,Vt,K,At),we=Mt.x,Ut=Mt.y,Rt&&it.push({x:we,y:Ut}),ve&&(nt+=(0,Y.y)(qt,[we,Ut])),qt=[we,Ut],Ke&&nt>=X&&X>ie[2]){var q=(nt-X)/(nt-ie[2]);Pe={x:qt[0]*(1-q)+ie[0]*q,y:qt[1]*(1-q)+ie[1]*q}}ie=[we,Ut,nt]}return Ke&&X>=nt&&(Pe={x:Vt,y:K}),{length:nt,point:Pe,min:{x:Math.min.apply(null,it.map(function(Nt){return Nt.x})),y:Math.min.apply(null,it.map(function(Nt){return Nt.y}))},max:{x:Math.max.apply(null,it.map(function(Nt){return Nt.x})),y:Math.max.apply(null,it.map(function(Nt){return Nt.y}))}}}},38163:function($t){$t.exports=Qt;function Qt(Z,tt){var yt=Z&&Z.type,G;if(yt==="FeatureCollection")for(G=0;G<Z.features.length;G++)Qt(Z.features[G],tt);else if(yt==="GeometryCollection")for(G=0;G<Z.geometries.length;G++)Qt(Z.geometries[G],tt);else if(yt==="Feature")Qt(Z.geometry,tt);else if(yt==="Polygon")L(Z.coordinates,tt);else if(yt==="MultiPolygon")for(G=0;G<Z.coordinates.length;G++)L(Z.coordinates[G],tt);return Z}function L(Z,tt){if(Z.length!==0){Y(Z[0],tt);for(var yt=1;yt<Z.length;yt++)Y(Z[yt],!tt)}}function Y(Z,tt){for(var yt=0,G=0,Ot=0,bt=Z.length,Et=bt-1;Ot<bt;Et=Ot++){var pt=(Z[Ot][0]-Z[Et][0])*(Z[Et][1]+Z[Ot][1]),Vt=yt+pt;G+=Math.abs(yt)>=Math.abs(pt)?yt-Vt+pt:pt-Vt+yt,yt=Vt}yt+G>=0!=!!tt&&Z.reverse()}},75550:function($t){"use strict";$t.exports=Qt;function Qt(L,Y){this.x=L,this.y=Y}Qt.prototype={clone:function(){return new Qt(this.x,this.y)},add:function(L){return this.clone()._add(L)},sub:function(L){return this.clone()._sub(L)},multByPoint:function(L){return this.clone()._multByPoint(L)},divByPoint:function(L){return this.clone()._divByPoint(L)},mult:function(L){return this.clone()._mult(L)},div:function(L){return this.clone()._div(L)},rotate:function(L){return this.clone()._rotate(L)},rotateAround:function(L,Y){return this.clone()._rotateAround(L,Y)},matMult:function(L){return this.clone()._matMult(L)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(L){return this.x===L.x&&this.y===L.y},dist:function(L){return Math.sqrt(this.distSqr(L))},distSqr:function(L){var Y=L.x-this.x,Z=L.y-this.y;return Y*Y+Z*Z},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(L){return Math.atan2(this.y-L.y,this.x-L.x)},angleWith:function(L){return this.angleWithSep(L.x,L.y)},angleWithSep:function(L,Y){return Math.atan2(this.x*Y-this.y*L,this.x*L+this.y*Y)},_matMult:function(L){var Y=L[0]*this.x+L[1]*this.y,Z=L[2]*this.x+L[3]*this.y;return this.x=Y,this.y=Z,this},_add:function(L){return this.x+=L.x,this.y+=L.y,this},_sub:function(L){return this.x-=L.x,this.y-=L.y,this},_mult:function(L){return this.x*=L,this.y*=L,this},_div:function(L){return this.x/=L,this.y/=L,this},_multByPoint:function(L){return this.x*=L.x,this.y*=L.y,this},_divByPoint:function(L){return this.x/=L.x,this.y/=L.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var L=this.y;return this.y=this.x,this.x=-L,this},_rotate:function(L){var Y=Math.cos(L),Z=Math.sin(L),tt=Y*this.x-Z*this.y,yt=Z*this.x+Y*this.y;return this.x=tt,this.y=yt,this},_rotateAround:function(L,Y){var Z=Math.cos(L),tt=Math.sin(L),yt=Y.x+Z*(this.x-Y.x)-tt*(this.y-Y.y),G=Y.y+tt*(this.x-Y.x)+Z*(this.y-Y.y);return this.x=yt,this.y=G,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qt.convert=function(L){return L instanceof Qt?L:Array.isArray(L)?new Qt(L[0],L[1]):L}},49296:function($t){"use strict";$t.exports=L,$t.exports.default=L;var Qt=1e20;function L(G,Ot,bt,Et,pt,Vt){this.fontSize=G||24,this.buffer=Ot===void 0?3:Ot,this.cutoff=Et||.25,this.fontFamily=pt||"sans-serif",this.fontWeight=Vt||"normal",this.radius=bt||8;var K=this.size=this.fontSize+this.buffer*2,X=K+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=K,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(X*X),this.gridInner=new Float64Array(X*X),this.f=new Float64Array(X),this.z=new Float64Array(X+1),this.v=new Uint16Array(X),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(K/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Y(G,Ot,bt,Et,pt,Vt,K){Vt.fill(Qt,0,Ot*bt),K.fill(0,0,Ot*bt);for(var X=(Ot-Et)/2,Zt=0;Zt<pt;Zt++)for(var Mt=0;Mt<Et;Mt++){var zt=(Zt+X)*Ot+Mt+X,Rt=G.data[4*(Zt*Et+Mt)+3]/255;if(Rt===1)Vt[zt]=0,K[zt]=Qt;else if(Rt===0)Vt[zt]=Qt,K[zt]=0;else{var Gt=Math.max(0,.5-Rt),ve=Math.max(0,Rt-.5);Vt[zt]=Gt*Gt,K[zt]=ve*ve}}}function Z(G,Ot,bt,Et,pt,Vt,K){for(var X=0;X<Ot*bt;X++){var Zt=Math.sqrt(Et[X])-Math.sqrt(pt[X]);G[X]=Math.round(255-255*(Zt/Vt+K))}}L.prototype._draw=function(G,Ot){var bt=this.ctx.measureText(G),Et=bt.width,pt=2*this.buffer,Vt,K,X,Zt,Mt,zt,Rt,Gt;Ot&&this.useMetrics?(Mt=Math.floor(bt.actualBoundingBoxAscent),Gt=this.buffer+Math.ceil(bt.actualBoundingBoxAscent),zt=this.buffer,Rt=this.buffer,K=Math.min(this.size,Math.ceil(bt.actualBoundingBoxRight-bt.actualBoundingBoxLeft)),Zt=Math.min(this.size-zt,Math.ceil(bt.actualBoundingBoxAscent+bt.actualBoundingBoxDescent)),Vt=K+pt,X=Zt+pt,this.ctx.textBaseline="alphabetic"):(Vt=K=this.size,X=Zt=this.size,Mt=19*this.fontSize/24,zt=Rt=0,Gt=this.middle,this.ctx.textBaseline="middle");var ve;K&&Zt&&(this.ctx.clearRect(Rt,zt,K,Zt),this.ctx.fillText(G,this.buffer,Gt),ve=this.ctx.getImageData(Rt,zt,K,Zt));var Me=new Uint8ClampedArray(Vt*X);return Y(ve,Vt,X,K,Zt,this.gridOuter,this.gridInner),tt(this.gridOuter,Vt,X,this.f,this.v,this.z),tt(this.gridInner,Vt,X,this.f,this.v,this.z),Z(Me,Vt,X,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Me,metrics:{width:K,height:Zt,sdfWidth:Vt,sdfHeight:X,top:Mt,left:0,advance:Et}}},L.prototype.draw=function(G){return this._draw(G,!1).data},L.prototype.drawWithMetrics=function(G){return this._draw(G,!0)};function tt(G,Ot,bt,Et,pt,Vt){for(var K=0;K<Ot;K++)yt(G,K,Ot,bt,Et,pt,Vt);for(var X=0;X<bt;X++)yt(G,X*Ot,1,Ot,Et,pt,Vt)}function yt(G,Ot,bt,Et,pt,Vt,K){var X,Zt,Mt,zt;for(Vt[0]=0,K[0]=-Qt,K[1]=Qt,X=0;X<Et;X++)pt[X]=G[Ot+X*bt];for(X=1,Zt=0,Mt=0;X<Et;X++){do zt=Vt[Zt],Mt=(pt[X]-pt[zt]+X*X-zt*zt)/(X-zt)/2;while(Mt<=K[Zt]&&--Zt>-1);Zt++,Vt[Zt]=X,K[Zt]=Mt,K[Zt+1]=Qt}for(X=0,Zt=0;X<Et;X++){for(;K[Zt+1]<X;)Zt++;zt=Vt[Zt],G[Ot+X*bt]=pt[zt]+(X-zt)*(X-zt)}}},99874:function($t){"use strict";$t.exports=Qt;function Qt(L,Y,Z,tt){this.cx=3*L,this.bx=3*(Z-L)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*Y,this.by=3*(tt-Y)-this.cy,this.ay=1-this.cy-this.by,this.p1x=L,this.p1y=Y,this.p2x=Z,this.p2y=tt}Qt.prototype={sampleCurveX:function(L){return((this.ax*L+this.bx)*L+this.cx)*L},sampleCurveY:function(L){return((this.ay*L+this.by)*L+this.cy)*L},sampleCurveDerivativeX:function(L){return(3*this.ax*L+2*this.bx)*L+this.cx},solveCurveX:function(L,Y){if(Y===void 0&&(Y=1e-6),L<0)return 0;if(L>1)return 1;for(var Z=L,tt=0;tt<8;tt++){var yt=this.sampleCurveX(Z)-L;if(Math.abs(yt)<Y)return Z;var G=this.sampleCurveDerivativeX(Z);if(Math.abs(G)<1e-6)break;Z=Z-yt/G}var Ot=0,bt=1;for(Z=L,tt=0;tt<20&&(yt=this.sampleCurveX(Z),!(Math.abs(yt-L)<Y));tt++)L>yt?Ot=Z:bt=Z,Z=(bt-Ot)*.5+Ot;return Z},solve:function(L,Y){return this.sampleCurveY(this.solveCurveX(L,Y))}}},38929:function($t,Qt,L){$t.exports.VectorTile=L(22779),L(66024),L(59701)},22779:function($t,Qt,L){"use strict";var Y=L(59701);$t.exports=Z;function Z(yt,G){this.layers=yt.readFields(tt,{},G)}function tt(yt,G,Ot){if(yt===3){var bt=new Y(Ot,Ot.readVarint()+Ot.pos);bt.length&&(G[bt.name]=bt)}}},66024:function($t,Qt,L){"use strict";var Y=L(75550);$t.exports=Z;function Z(bt,Et,pt,Vt,K){this.properties={},this.extent=pt,this.type=0,this._pbf=bt,this._geometry=-1,this._keys=Vt,this._values=K,bt.readFields(tt,this,Et)}function tt(bt,Et,pt){bt==1?Et.id=pt.readVarint():bt==2?yt(pt,Et):bt==3?Et.type=pt.readVarint():bt==4&&(Et._geometry=pt.pos)}function yt(bt,Et){for(var pt=bt.readVarint()+bt.pos;bt.pos<pt;){var Vt=Et._keys[bt.readVarint()],K=Et._values[bt.readVarint()];Et.properties[Vt]=K}}Z.types=["Unknown","Point","LineString","Polygon"],Z.prototype.loadGeometry=function(){var bt=this._pbf;bt.pos=this._geometry;for(var Et=bt.readVarint()+bt.pos,pt=1,Vt=0,K=0,X=0,Zt=[],Mt;bt.pos<Et;){if(Vt<=0){var zt=bt.readVarint();pt=zt&7,Vt=zt>>3}if(Vt--,pt===1||pt===2)K+=bt.readSVarint(),X+=bt.readSVarint(),pt===1&&(Mt&&Zt.push(Mt),Mt=[]),Mt.push(new Y(K,X));else if(pt===7)Mt&&Mt.push(Mt[0].clone());else throw new Error("unknown command "+pt)}return Mt&&Zt.push(Mt),Zt},Z.prototype.bbox=function(){var bt=this._pbf;bt.pos=this._geometry;for(var Et=bt.readVarint()+bt.pos,pt=1,Vt=0,K=0,X=0,Zt=1/0,Mt=-1/0,zt=1/0,Rt=-1/0;bt.pos<Et;){if(Vt<=0){var Gt=bt.readVarint();pt=Gt&7,Vt=Gt>>3}if(Vt--,pt===1||pt===2)K+=bt.readSVarint(),X+=bt.readSVarint(),K<Zt&&(Zt=K),K>Mt&&(Mt=K),X<zt&&(zt=X),X>Rt&&(Rt=X);else if(pt!==7)throw new Error("unknown command "+pt)}return[Zt,zt,Mt,Rt]},Z.prototype.toGeoJSON=function(bt,Et,pt){var Vt=this.extent*Math.pow(2,pt),K=this.extent*bt,X=this.extent*Et,Zt=this.loadGeometry(),Mt=Z.types[this.type],zt,Rt;function Gt(Ue){for(var Ke=0;Ke<Ue.length;Ke++){var we=Ue[Ke],Ut=180-(we.y+X)*360/Vt;Ue[Ke]=[(we.x+K)*360/Vt-180,360/Math.PI*Math.atan(Math.exp(Ut*Math.PI/180))-90]}}switch(this.type){case 1:var ve=[];for(zt=0;zt<Zt.length;zt++)ve[zt]=Zt[zt][0];Zt=ve,Gt(Zt);break;case 2:for(zt=0;zt<Zt.length;zt++)Gt(Zt[zt]);break;case 3:for(Zt=G(Zt),zt=0;zt<Zt.length;zt++)for(Rt=0;Rt<Zt[zt].length;Rt++)Gt(Zt[zt][Rt]);break}Zt.length===1?Zt=Zt[0]:Mt="Multi"+Mt;var Me={type:"Feature",geometry:{type:Mt,coordinates:Zt},properties:this.properties};return"id"in this&&(Me.id=this.id),Me};function G(bt){var Et=bt.length;if(Et<=1)return[bt];for(var pt=[],Vt,K,X=0;X<Et;X++){var Zt=Ot(bt[X]);Zt!==0&&(K===void 0&&(K=Zt<0),K===Zt<0?(Vt&&pt.push(Vt),Vt=[bt[X]]):Vt.push(bt[X]))}return Vt&&pt.push(Vt),pt}function Ot(bt){for(var Et=0,pt=0,Vt=bt.length,K=Vt-1,X,Zt;pt<Vt;K=pt++)X=bt[pt],Zt=bt[K],Et+=(Zt.x-X.x)*(X.y+Zt.y);return Et}},59701:function($t,Qt,L){"use strict";var Y=L(66024);$t.exports=Z;function Z(G,Ot){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=G,this._keys=[],this._values=[],this._features=[],G.readFields(tt,this,Ot),this.length=this._features.length}function tt(G,Ot,bt){G===15?Ot.version=bt.readVarint():G===1?Ot.name=bt.readString():G===5?Ot.extent=bt.readVarint():G===2?Ot._features.push(bt.pos):G===3?Ot._keys.push(bt.readString()):G===4&&Ot._values.push(yt(bt))}function yt(G){for(var Ot=null,bt=G.readVarint()+G.pos;G.pos<bt;){var Et=G.readVarint()>>3;Ot=Et===1?G.readString():Et===2?G.readFloat():Et===3?G.readDouble():Et===4?G.readVarint64():Et===5?G.readVarint():Et===6?G.readSVarint():Et===7?G.readBoolean():null}return Ot}Z.prototype.feature=function(G){if(G<0||G>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[G];var Ot=this._pbf.readVarint()+this._pbf.pos;return new Y(this._pbf,Ot,this.extent,this._keys,this._values)}},74685:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Pw}});var Y=L(18829),Z={},tt={},yt=a=>tt[a],G=(a,i)=>{tt[a]=i},Ot=a=>Z[a],bt=(a,i)=>{Z[a]=i},Et={},pt={},Vt=34,K=10,X=13;function Zt(a){return new Function("d","return {"+a.map(function(i,s){return JSON.stringify(i)+": d["+s+'] || ""'}).join(",")+"}")}function Mt(a,i){var s=Zt(a);return function(f,p){return i(s(f),p,a)}}function zt(a){var i=Object.create(null),s=[];return a.forEach(function(f){for(var p in f)p in i||s.push(i[p]=p)}),s}function Rt(a,i){var s=a+"",f=s.length;return f<i?new Array(i-f+1).join(0)+s:s}function Gt(a){return a<0?"-"+Rt(-a,6):a>9999?"+"+Rt(a,6):Rt(a,4)}function ve(a){var i=a.getUTCHours(),s=a.getUTCMinutes(),f=a.getUTCSeconds(),p=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":Gt(a.getUTCFullYear(),4)+"-"+Rt(a.getUTCMonth()+1,2)+"-"+Rt(a.getUTCDate(),2)+(p?"T"+Rt(i,2)+":"+Rt(s,2)+":"+Rt(f,2)+"."+Rt(p,3)+"Z":f?"T"+Rt(i,2)+":"+Rt(s,2)+":"+Rt(f,2)+"Z":s||i?"T"+Rt(i,2)+":"+Rt(s,2)+"Z":"")}function Me(a){var i=new RegExp('["'+a+`
\r]`),s=a.charCodeAt(0);function f(j,V){var mt,Bt,Kt=p(j,function(ue,Le){if(mt)return mt(ue,Le-1);Bt=ue,mt=V?Mt(ue,V):Zt(ue)});return Kt.columns=Bt||[],Kt}function p(j,V){var mt=[],Bt=j.length,Kt=0,ue=0,Le,ke=Bt<=0,He=!1;j.charCodeAt(Bt-1)===K&&--Bt,j.charCodeAt(Bt-1)===X&&--Bt;function Ye(){if(ke)return pt;if(He)return He=!1,Et;var bn,hn=Kt,Cn;if(j.charCodeAt(hn)===Vt){for(;Kt++<Bt&&j.charCodeAt(Kt)!==Vt||j.charCodeAt(++Kt)===Vt;);return(bn=Kt)>=Bt?ke=!0:(Cn=j.charCodeAt(Kt++))===K?He=!0:Cn===X&&(He=!0,j.charCodeAt(Kt)===K&&++Kt),j.slice(hn+1,bn-1).replace(/""/g,'"')}for(;Kt<Bt;){if((Cn=j.charCodeAt(bn=Kt++))===K)He=!0;else if(Cn===X)He=!0,j.charCodeAt(Kt)===K&&++Kt;else if(Cn!==s)continue;return j.slice(hn,bn)}return ke=!0,j.slice(hn,Bt)}for(;(Le=Ye())!==pt;){for(var rn=[];Le!==Et&&Le!==pt;)rn.push(Le),Le=Ye();V&&(rn=V(rn,ue++))==null||mt.push(rn)}return mt}function y(j,V){return j.map(function(mt){return V.map(function(Bt){return B(mt[Bt])}).join(a)})}function x(j,V){return V==null&&(V=zt(j)),[V.map(B).join(a)].concat(y(j,V)).join(`
`)}function O(j,V){return V==null&&(V=zt(j)),y(j,V).join(`
`)}function A(j){return j.map(I).join(`
`)}function I(j){return j.map(B).join(a)}function B(j){return j==null?"":j instanceof Date?ve(j):i.test(j+="")?'"'+j.replace(/"/g,'""')+'"':j}return{parse:f,parseRows:p,format:x,formatBody:O,formatRows:A,formatRow:I,formatValue:B}}var Ue=Me(","),Ke=Ue.parse,we=Ue.parseRows,Ut=Ue.format,nt=Ue.formatBody,ie=Ue.formatRows,qt=Ue.formatRow,At=Ue.formatValue,Pe=63710088e-1,it={centimeters:Pe*100,centimetres:Pe*100,degrees:Pe/111325,feet:Pe*3.28084,inches:Pe*39.37,kilometers:Pe/1e3,kilometres:Pe/1e3,meters:Pe,metres:Pe,miles:Pe/1609.344,millimeters:Pe*1e3,millimetres:Pe*1e3,nauticalmiles:Pe/1852,radians:1,yards:Pe*1.0936},Pt={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Pe,yards:1.0936133},q={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Nt(a,i,s){s===void 0&&(s={});var f={type:"Feature"};return(s.id===0||s.id)&&(f.id=s.id),s.bbox&&(f.bbox=s.bbox),f.properties=i||{},f.geometry=a,f}function It(a,i,s){switch(s===void 0&&(s={}),a){case"Point":return U(i).geometry;case"LineString":return _e(i).geometry;case"Polygon":return ne(i).geometry;case"MultiPoint":return cn(i).geometry;case"MultiLineString":return un(i).geometry;case"MultiPolygon":return Jt(i).geometry;default:throw new Error(a+" is invalid")}}function U(a,i,s){if(s===void 0&&(s={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!C(a[0])||!C(a[1]))throw new Error("coordinates must contain numbers");var f={type:"Point",coordinates:a};return Nt(f,i,s)}function ht(a,i,s){return s===void 0&&(s={}),Re(a.map(function(f){return U(f,i)}),s)}function ne(a,i,s){s===void 0&&(s={});for(var f=0,p=a;f<p.length;f++){var y=p[f];if(y.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<y[y.length-1].length;x++)if(y[y.length-1][x]!==y[0][x])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:a};return Nt(O,i,s)}function xe(a,i,s){return s===void 0&&(s={}),Re(a.map(function(f){return ne(f,i)}),s)}function _e(a,i,s){if(s===void 0&&(s={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");var f={type:"LineString",coordinates:a};return Nt(f,i,s)}function Xe(a,i,s){return s===void 0&&(s={}),Re(a.map(function(f){return _e(f,i)}),s)}function Re(a,i){i===void 0&&(i={});var s={type:"FeatureCollection"};return i.id&&(s.id=i.id),i.bbox&&(s.bbox=i.bbox),s.features=a,s}function un(a,i,s){s===void 0&&(s={});var f={type:"MultiLineString",coordinates:a};return Nt(f,i,s)}function cn(a,i,s){s===void 0&&(s={});var f={type:"MultiPoint",coordinates:a};return Nt(f,i,s)}function Jt(a,i,s){s===void 0&&(s={});var f={type:"MultiPolygon",coordinates:a};return Nt(f,i,s)}function ct(a,i,s){s===void 0&&(s={});var f={type:"GeometryCollection",geometries:a};return Nt(f,i,s)}function Ct(a,i){if(i===void 0&&(i=0),i&&!(i>=0))throw new Error("precision must be a positive number");var s=Math.pow(10,i||0);return Math.round(a*s)/s}function me(a,i){i===void 0&&(i="kilometers");var s=it[i];if(!s)throw new Error(i+" units is invalid");return a*s}function he(a,i){i===void 0&&(i="kilometers");var s=it[i];if(!s)throw new Error(i+" units is invalid");return a/s}function Tt(a,i){return Yt(he(a,i))}function re(a){var i=a%360;return i<0&&(i+=360),i}function Yt(a){var i=a%(2*Math.PI);return i*180/Math.PI}function N(a){var i=a%360;return i*Math.PI/180}function kt(a,i,s){if(i===void 0&&(i="kilometers"),s===void 0&&(s="kilometers"),!(a>=0))throw new Error("length must be a positive number");return me(he(a,i),s)}function oe(a,i,s){if(i===void 0&&(i="meters"),s===void 0&&(s="kilometers"),!(a>=0))throw new Error("area must be a positive number");var f=q[i];if(!f)throw new Error("invalid original units");var p=q[s];if(!p)throw new Error("invalid final units");return a/f*p}function C(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)}function z(a){return!!a&&a.constructor===Object}function Ft(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(a.length!==4&&a.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(i){if(!C(i))throw new Error("bbox must only contain numbers")})}function te(a){if(!a)throw new Error("id is required");if(["string","number"].indexOf(typeof a)===-1)throw new Error("id must be a number or a string")}function se(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Se(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function be(a){if(a.length>1&&isNumber(a[0])&&isNumber(a[1]))return!0;if(Array.isArray(a[0])&&a[0].length)return be(a[0]);throw new Error("coordinates must only contain numbers")}function Ze(a,i,s){if(!i||!s)throw new Error("type and name required");if(!a||a.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+a.type)}function tn(a,i,s){if(!a)throw new Error("No feature passed");if(!s)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+s+", Feature with geometry required");if(!a.geometry||a.geometry.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+a.geometry.type)}function Ge(a,i,s){if(!a)throw new Error("No featureCollection passed");if(!s)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+s+", FeatureCollection required");for(var f=0,p=a.features;f<p.length;f++){var y=p[f];if(!y||y.type!=="Feature"||!y.geometry)throw new Error("Invalid input to "+s+", Feature with geometry required");if(!y.geometry||y.geometry.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+y.geometry.type)}}function Be(a){return a.type==="Feature"?a.geometry:a}function jt(a,i){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}function ce(a,i,s){if(a!==null)for(var f,p,y,x,O,A,I,B=0,j=0,V,mt=a.type,Bt=mt==="FeatureCollection",Kt=mt==="Feature",ue=Bt?a.features.length:1,Le=0;Le<ue;Le++){I=Bt?a.features[Le].geometry:Kt?a.geometry:a,V=I?I.type==="GeometryCollection":!1,O=V?I.geometries.length:1;for(var ke=0;ke<O;ke++){var He=0,Ye=0;if(x=V?I.geometries[ke]:I,x!==null){A=x.coordinates;var rn=x.type;switch(B=s&&(rn==="Polygon"||rn==="MultiPolygon")?1:0,rn){case null:break;case"Point":if(i(A,j,Le,He,Ye)===!1)return!1;j++,He++;break;case"LineString":case"MultiPoint":for(f=0;f<A.length;f++){if(i(A[f],j,Le,He,Ye)===!1)return!1;j++,rn==="MultiPoint"&&He++}rn==="LineString"&&He++;break;case"Polygon":case"MultiLineString":for(f=0;f<A.length;f++){for(p=0;p<A[f].length-B;p++){if(i(A[f][p],j,Le,He,Ye)===!1)return!1;j++}rn==="MultiLineString"&&He++,rn==="Polygon"&&Ye++}rn==="Polygon"&&He++;break;case"MultiPolygon":for(f=0;f<A.length;f++){for(Ye=0,p=0;p<A[f].length;p++){for(y=0;y<A[f][p].length-B;y++){if(i(A[f][p][y],j,Le,He,Ye)===!1)return!1;j++}Ye++}He++}break;case"GeometryCollection":for(f=0;f<x.geometries.length;f++)if(ce(x.geometries[f],i,s)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ae(a,i,s,f){var p=s;return ce(a,function(y,x,O,A,I){x===0&&s===void 0?p=y:p=i(p,y,x,O,A,I)},f),p}function ye(a,i){var s;switch(a.type){case"FeatureCollection":for(s=0;s<a.features.length&&i(a.features[s].properties,s)!==!1;s++);break;case"Feature":i(a.properties,0);break}}function st(a,i,s){var f=s;return ye(a,function(p,y){y===0&&s===void 0?f=p:f=i(f,p,y)}),f}function D(a,i){if(a.type==="Feature")i(a,0);else if(a.type==="FeatureCollection")for(var s=0;s<a.features.length&&i(a.features[s],s)!==!1;s++);}function H(a,i,s){var f=s;return D(a,function(p,y){y===0&&s===void 0?f=p:f=i(f,p,y)}),f}function at(a){var i=[];return ce(a,function(s){i.push(s)}),i}function St(a,i){var s,f,p,y,x,O,A,I,B,j,V=0,mt=a.type==="FeatureCollection",Bt=a.type==="Feature",Kt=mt?a.features.length:1;for(s=0;s<Kt;s++){for(O=mt?a.features[s].geometry:Bt?a.geometry:a,I=mt?a.features[s].properties:Bt?a.properties:{},B=mt?a.features[s].bbox:Bt?a.bbox:void 0,j=mt?a.features[s].id:Bt?a.id:void 0,A=O?O.type==="GeometryCollection":!1,x=A?O.geometries.length:1,p=0;p<x;p++){if(y=A?O.geometries[p]:O,y===null){if(i(null,V,I,B,j)===!1)return!1;continue}switch(y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(i(y,V,I,B,j)===!1)return!1;break}case"GeometryCollection":{for(f=0;f<y.geometries.length;f++)if(i(y.geometries[f],V,I,B,j)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}V++}}function Lt(a,i,s){var f=s;return St(a,function(p,y,x,O,A){y===0&&s===void 0?f=p:f=i(f,p,y,x,O,A)}),f}function ge(a,i){St(a,function(s,f,p,y,x){var O=s===null?null:s.type;switch(O){case null:case"Point":case"LineString":case"Polygon":return i(Nt(s,p,{bbox:y,id:x}),f,0)===!1?!1:void 0}var A;switch(O){case"MultiPoint":A="Point";break;case"MultiLineString":A="LineString";break;case"MultiPolygon":A="Polygon";break}for(var I=0;I<s.coordinates.length;I++){var B=s.coordinates[I],j={type:A,coordinates:B};if(i(Nt(j,p),f,I)===!1)return!1}})}function de(a,i,s){var f=s;return ge(a,function(p,y,x){y===0&&x===0&&s===void 0?f=p:f=i(f,p,y,x)}),f}function ze(a,i){ge(a,function(s,f,p){var y=0;if(s.geometry){var x=s.geometry.type;if(!(x==="Point"||x==="MultiPoint")){var O,A=0,I=0,B=0;if(ce(s,function(j,V,mt,Bt,Kt){if(O===void 0||f>A||Bt>I||Kt>B){O=j,A=f,I=Bt,B=Kt,y=0;return}var ue=lineString([O,j],s.properties);if(i(ue,f,p,Kt,y)===!1)return!1;y++,O=j})===!1)return!1}}})}function Ne(a,i,s){var f=s,p=!1;return ze(a,function(y,x,O,A,I){p===!1&&s===void 0?f=y:f=i(f,y,x,O,A,I),p=!0}),f}function sn(a,i){if(!a)throw new Error("geojson is required");ge(a,function(s,f,p){if(s.geometry!==null){var y=s.geometry.type,x=s.geometry.coordinates;switch(y){case"LineString":if(i(s,f,p,0,0)===!1)return!1;break;case"Polygon":for(var O=0;O<x.length;O++)if(i(lineString(x[O],s.properties),f,p,O)===!1)return!1;break}}})}function Ce(a,i,s){var f=s;return sn(a,function(p,y,x,O){y===0&&s===void 0?f=p:f=i(f,p,y,x,O)}),f}function en(a,i){if(i=i||{},!isObject(i))throw new Error("options is invalid");var s=i.featureIndex||0,f=i.multiFeatureIndex||0,p=i.geometryIndex||0,y=i.segmentIndex||0,x=i.properties,O;switch(a.type){case"FeatureCollection":s<0&&(s=a.features.length+s),x=x||a.features[s].properties,O=a.features[s].geometry;break;case"Feature":x=x||a.properties,O=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=a;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var A=O.coordinates;switch(O.type){case"Point":case"MultiPoint":return null;case"LineString":return y<0&&(y=A.length+y-1),lineString([A[y],A[y+1]],x,i);case"Polygon":return p<0&&(p=A.length+p),y<0&&(y=A[p].length+y-1),lineString([A[p][y],A[p][y+1]],x,i);case"MultiLineString":return f<0&&(f=A.length+f),y<0&&(y=A[f].length+y-1),lineString([A[f][y],A[f][y+1]],x,i);case"MultiPolygon":return f<0&&(f=A.length+f),p<0&&(p=A[f].length+p),y<0&&(y=A[f][p].length-y-1),lineString([A[f][p][y],A[f][p][y+1]],x,i)}throw new Error("geojson is invalid")}function dn(a,i){if(i=i||{},!isObject(i))throw new Error("options is invalid");var s=i.featureIndex||0,f=i.multiFeatureIndex||0,p=i.geometryIndex||0,y=i.coordIndex||0,x=i.properties,O;switch(a.type){case"FeatureCollection":s<0&&(s=a.features.length+s),x=x||a.features[s].properties,O=a.features[s].geometry;break;case"Feature":x=x||a.properties,O=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=a;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var A=O.coordinates;switch(O.type){case"Point":return point(A,x,i);case"MultiPoint":return f<0&&(f=A.length+f),point(A[f],x,i);case"LineString":return y<0&&(y=A.length+y),point(A[y],x,i);case"Polygon":return p<0&&(p=A.length+p),y<0&&(y=A[p].length+y),point(A[p][y],x,i);case"MultiLineString":return f<0&&(f=A.length+f),y<0&&(y=A[f].length+y),point(A[f][y],x,i);case"MultiPolygon":return f<0&&(f=A.length+f),p<0&&(p=A[f].length+p),y<0&&(y=A[f][p].length-y),point(A[f][p][y],x,i)}throw new Error("geojson is invalid")}var En={REGISTERED_PROTOCOLS:{}},mn=Object.defineProperty,jn=Object.defineProperties,Wn=Object.getOwnPropertyDescriptors,tr=Object.getOwnPropertySymbols,pr=Object.prototype.hasOwnProperty,Mr=Object.prototype.propertyIsEnumerable,Qr=(a,i,s)=>i in a?mn(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Nr=(a,i)=>{for(var s in i||(i={}))pr.call(i,s)&&Qr(a,s,i[s]);if(tr)for(var s of tr(i))Mr.call(i,s)&&Qr(a,s,i[s]);return a},Lr=(a,i)=>jn(a,Wn(i)),Fr=a=>En.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))],vi=class extends Error{constructor(a,i,s,f){super(`AJAXError: ${i} (${a}): ${s}`),this.status=a,this.statusText=i,this.url=s,this.body=f}};function Li(a,i){const s=new XMLHttpRequest,f=Array.isArray(a.url)?a.url[0]:a.url;s.open(a.method||"GET",f,!0),a.type==="arrayBuffer"&&(s.responseType="arraybuffer");for(const p in a.headers)a.headers.hasOwnProperty(p)&&s.setRequestHeader(p,a.headers[p]);return a.type==="json"&&(s.responseType="text",s.setRequestHeader("Accept","application/json")),s.withCredentials=a.credentials==="include",s.onerror=()=>{i(new Error(s.statusText))},s.onload=()=>{if((s.status>=200&&s.status<300||s.status===0)&&s.response!==null){let p=s.response;if(a.type==="json")try{p=JSON.parse(s.response)}catch(y){return i(y)}i(null,p,s.getResponseHeader("Cache-Control"),s.getResponseHeader("Expires"),s)}else{const p=new Blob([s.response],{type:s.getResponseHeader("Content-Type")});i(new vi(s.status,s.statusText,f.toString(),p))}},s.cancel=s.abort,s.send(a.body),s}function Ii(a){return new Promise((i,s)=>{Li(a,(f,p,y,x,O)=>{f?s({err:f,data:null,xhr:O}):i({err:null,data:p,cacheControl:y,expires:x,xhr:O})})})}function mi(a,i){return Li(a,i)}var Hi=(a,i)=>(Fr(a.url)||mi)(Lr(Nr({},a),{type:"json"}),i),io=(a,i)=>(Fr(a.url)||mi)(Lr(Nr({},a),{type:"arrayBuffer"}),i),Ko=(a,i)=>mi(Lr(Nr({},a),{method:"POST"}),i),So=(a,i)=>mi(Lr(Nr({},a),{method:"GET"}),i);function fa(a){const i=window.document.createElement("a");return i.href=a,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}var li="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Cr(a,i){const s=new window.Image,f=window.URL||window.webkitURL;s.crossOrigin="anonymous",s.onload=()=>{i(null,s),f.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=li})},s.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(a)],{type:"image/png"});s.src=a.byteLength?f.createObjectURL(p):li}function ft(a,i){const s=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(s).then(f=>{i(null,f)}).catch(f=>{i(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var _t=(a,i,s)=>{const f=(p,y)=>{if(p)i(p);else if(y){const x=typeof createImageBitmap=="function",O=s?s(y):y;x?ft(O,i):Cr(O,i)}};return a.type==="json"?Hi(a,f):io(a,f)},ee=(a,i)=>{typeof createImageBitmap=="function"?ft(a,i):Cr(a,i)},pe=(a=>(a.CENTER="center",a.TOP="top",a["TOP-LEFT"]="top-left",a["TOP-RIGHT"]="top-right",a.BOTTOM="bottom",a["BOTTOM-LEFT"]="bottom-left",a["BOTTOM-RIGHT"]="bottom-right",a.LEFT="left",a.RIGHT="right",a))(pe||{}),Ie={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function je(a,i,s){const f=a.classList;for(const p in Ie)Ie.hasOwnProperty(p)&&f.remove(`l7-${s}-anchor-${p}`);f.add(`l7-${s}-anchor-${i}`)}function Oe(a,i,s){a.prototype=i.prototype=s,s.constructor=a}function Ee(a,i){var s=Object.create(a.prototype);for(var f in i)s[f]=i[f];return s}function Ve(){}var $e=.7,pn=1/$e,Sn="\\s*([+-]?\\d+)\\s*",Dn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",vn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mn=/^#([0-9a-f]{3,8})$/,Pn=new RegExp("^rgb\\("+[Sn,Sn,Sn]+"\\)$"),yn=new RegExp("^rgb\\("+[vn,vn,vn]+"\\)$"),$n=new RegExp("^rgba\\("+[Sn,Sn,Sn,Dn]+"\\)$"),kn=new RegExp("^rgba\\("+[vn,vn,vn,Dn]+"\\)$"),Vn=new RegExp("^hsl\\("+[Dn,vn,vn]+"\\)$"),Ln=new RegExp("^hsla\\("+[Dn,vn,vn,Dn]+"\\)$"),zn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Oe(Ve,fi,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:ir,formatHex:ir,formatHsl:Qi,formatRgb:Wi,toString:Wi});function ir(){return this.rgb().formatHex()}function Qi(){return ri(this).formatHsl()}function Wi(){return this.rgb().formatRgb()}function fi(a){var i,s;return a=(a+"").trim().toLowerCase(),(i=Mn.exec(a))?(s=i[1].length,i=parseInt(i[1],16),s===6?Ji(i):s===3?new Ae(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):s===8?to(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):s===4?to(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Pn.exec(a))?new Ae(i[1],i[2],i[3],1):(i=yn.exec(a))?new Ae(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=$n.exec(a))?to(i[1],i[2],i[3],i[4]):(i=kn.exec(a))?to(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Vn.exec(a))?Xn(i[1],i[2]/100,i[3]/100,1):(i=Ln.exec(a))?Xn(i[1],i[2]/100,i[3]/100,i[4]):zn.hasOwnProperty(a)?Ji(zn[a]):a==="transparent"?new Ae(NaN,NaN,NaN,0):null}function Ji(a){return new Ae(a>>16&255,a>>8&255,a&255,1)}function to(a,i,s,f){return f<=0&&(a=i=s=NaN),new Ae(a,i,s,f)}function Dt(a){return a instanceof Ve||(a=fi(a)),a?(a=a.rgb(),new Ae(a.r,a.g,a.b,a.opacity)):new Ae}function Xt(a,i,s,f){return arguments.length===1?Dt(a):new Ae(a,i,s,f==null?1:f)}function Ae(a,i,s,f){this.r=+a,this.g=+i,this.b=+s,this.opacity=+f}Oe(Ae,Xt,Ee(Ve,{brighter:function(a){return a=a==null?pn:Math.pow(pn,a),new Ae(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=a==null?$e:Math.pow($e,a),new Ae(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qe,formatHex:Qe,formatRgb:gn,toString:gn}));function Qe(){return"#"+In(this.r)+In(this.g)+In(this.b)}function gn(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(a===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(a===1?")":", "+a+")")}function In(a){return a=Math.max(0,Math.min(255,Math.round(a)||0)),(a<16?"0":"")+a.toString(16)}function Xn(a,i,s,f){return f<=0?a=i=s=NaN:s<=0||s>=1?a=i=NaN:i<=0&&(a=NaN),new Pr(a,i,s,f)}function ri(a){if(a instanceof Pr)return new Pr(a.h,a.s,a.l,a.opacity);if(a instanceof Ve||(a=fi(a)),!a)return new Pr;if(a instanceof Pr)return a;a=a.rgb();var i=a.r/255,s=a.g/255,f=a.b/255,p=Math.min(i,s,f),y=Math.max(i,s,f),x=NaN,O=y-p,A=(y+p)/2;return O?(i===y?x=(s-f)/O+(s<f)*6:s===y?x=(f-i)/O+2:x=(i-s)/O+4,O/=A<.5?y+p:2-y-p,x*=60):O=A>0&&A<1?0:x,new Pr(x,O,A,a.opacity)}function di(a,i,s,f){return arguments.length===1?ri(a):new Pr(a,i,s,f==null?1:f)}function Pr(a,i,s,f){this.h=+a,this.s=+i,this.l=+s,this.opacity=+f}Oe(Pr,di,Ee(Ve,{brighter:function(a){return a=a==null?pn:Math.pow(pn,a),new Pr(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=a==null?$e:Math.pow($e,a),new Pr(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+(this.h<0)*360,i=isNaN(a)||isNaN(this.s)?0:this.s,s=this.l,f=s+(s<.5?s:1-s)*i,p=2*s-f;return new Ae(wi(a>=240?a-240:a+120,p,f),wi(a,p,f),wi(a<120?a+240:a-120,p,f),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(a===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(a===1?")":", "+a+")")}}));function wi(a,i,s){return(a<60?i+(s-i)*a/60:a<180?s:a<240?i+(s-i)*(240-a)/60:i)*255}function v7(a){return typeof a=="string"?!!d3.color(a):!1}function Gr(a){const i=fi(a),s=[0,0,0,0];return i!=null&&(s[0]=i.r/255,s[1]=i.g/255,s[2]=i.b/255,s[3]=i.opacity),s}function dc(a){const i=a&&a[0],s=a&&a[1],f=a&&a[2];return i+s*256+f*65536-1}function ul(a){return[a+1&255,a+1>>8&255,a+1>>8>>8&255]}function zO(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");i.width=256,i.height=1;let f=null;const p=s.createLinearGradient(0,0,256,1),y=a.positions[0],x=a.positions[a.positions.length-1];for(let O=0;O<a.colors.length;++O){const A=(a.positions[O]-y)/(x-y);p.addColorStop(A,a.colors[O])}return s.fillStyle=p,s.fillRect(0,0,256,1),f=new Uint8ClampedArray(s.getImageData(0,0,256,1).data),i=null,s=null,{data:f,width:256,height:1}}function f1(a,i){let s=window.document.createElement("canvas"),f=s.getContext("2d");s.width=256,s.height=1;const p=f.createLinearGradient(0,0,256,1),y=i[1]-i[0];for(let A=0;A<a.colors.length;++A){const I=Math.max((a.positions[A]-i[0])/y,0);p.addColorStop(I,a.colors[A])}f.fillStyle=p,f.fillRect(0,0,256,1);const x=f.getImageData(0,0,256,1).data,O=d1(f,x);return s=null,f=null,O}function UO(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");i.width=256,i.height=1;const f=s.createImageData(256,1);return f.data.fill(0),a.positions.forEach((p,y)=>{const x=Gr(a.colors[y]);f.data[p*4+0]=x[0]*255,f.data[p*4+1]=x[1]*255,f.data[p*4+2]=x[2]*255,f.data[p*4+3]=x[3]*255}),i=null,s=null,f}function ZO(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");s.globalAlpha=1,i.width=256,i.height=1;const f=256/a.colors.length;for(let x=0;x<a.colors.length;x++)s.beginPath(),s.lineWidth=2,s.strokeStyle=a.colors[x],s.moveTo(x*f,0),s.lineTo((x+1)*f,0),s.stroke();const p=s.getImageData(0,0,256,1).data,y=d1(s,p);return i=null,s=null,y}function m7(a,i){let s=window.document.createElement("canvas"),f=s.getContext("2d");f.globalAlpha=1,s.width=256,s.height=1;const p=i[1]-i[0];a.positions.length-a.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let O=0;O<a.colors.length;O++)f.beginPath(),f.lineWidth=2,f.strokeStyle=a.colors[O],f.moveTo((a.positions[O]-i[0])/p*255,0),f.lineTo((a.positions[O+1]-i[0])/p*255,0),f.stroke();const y=f.getImageData(0,0,256,1).data,x=d1(f,y);return s=null,f=null,x}function d1(a,i){const s=a.createImageData(256,1);for(let f=0;f<s.data.length;f+=4)s.data[f+0]=i[f+0],s.data[f+1]=i[f+1],s.data[f+2]=i[f+2],s.data[f+3]=i[f+3];return s}function Ad(a){switch(a==null?void 0:a.type){case"cat":return[0,255];default:return[0,1]}}var h1=L(74691),HO=L.n(h1),y7=L(50361),WO=L.n(y7),_7=L(23279),VO=L.n(_7),b7=L(27361),GO=L.n(b7),$O=L(51584),YO=L.n($O),p1=L(18446),C0=L.n(p1),XO=L(14293),zu=L.n(XO),Td=L(81763),qO=L.n(Td),yo=L(68630),Uu=L.n(yo),P0=L(47037),wa=L.n(P0),fl=L(36719),KO=L.n(fl),da=L(82492),QO=L.n(da),Md=L(30236),ns=L.n(Md),JO=L(97019),tE=L.n(JO),L0=L(23493),g1=L.n(L0),Cd=L(44908),v1=L.n(Cd),m1=L(11700),I0=L.n(m1),y1=L(23560),R0=L.n(y1),_1=L(13218),k0=L.n(_1),b1=L(52353),D0=L.n(b1),x1=L(68929),N0=L.n(x1),S1=L(73955),w1=L.n(S1),hi={isNil:zu(),merge:QO(),throttle:g1(),isString:wa(),debounce:VO(),pull:tE(),isTypedArray:KO(),isPlainObject:Uu(),isNumber:qO(),isBoolean:YO(),isEqual:C0(),cloneDeep:WO(),uniq:v1(),clamp:HO(),upperFirst:I0(),get:GO(),mergeWith:ns(),isFunction:R0(),isObject:k0(),isUndefined:D0(),camelCase:N0(),uniqueId:w1()},{pull:O1}=hi;function E1(a){let i=a;return typeof a=="string"&&(i=window.document.getElementById(a)),i}function F0(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Pd(a){return F0(a).split(/\s+/)}function A1(a){var i;const s=(i=document==null?void 0:document.documentElement)==null?void 0:i.style;if(!s)return a[0];for(const f in a)if(a[f]&&a[f]in s)return a[f];return a[0]}function Vi(a,i,s){const f=window.document.createElement(a);return i&&(f.className=i||""),s&&s.appendChild(f),f}function Oa(a){const i=a.parentNode;i&&i.removeChild(a)}function Ea(a,i){if(a.classList!==void 0){const s=Pd(i);for(let f=0,p=s.length;f<p;f++)a.classList.add(s[f])}else if(!B0(a,i)){const s=j0(a);pc(a,(s?s+" ":"")+i)}}function hc(a,i){a.classList!==void 0?Pd(i).forEach(f=>{a.classList.remove(f)}):pc(a,F0((" "+j0(a)+" ").replace(" "+i+" "," ")))}function B0(a,i){if(a.classList!==void 0)return a.classList.contains(i);const s=j0(a);return s.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(s)}function pc(a,i){a instanceof HTMLElement?a.className=i:a.className.baseVal=i}function x7(a,i,s){s===void 0?B0(a,i)?hc(a,i):Ea(a,i):s?Ea(a,i):hc(a,i)}function j0(a){return a instanceof SVGElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function bF(a){for(;a&&a.firstChild;)a.removeChild(a.firstChild)}var T1=A1(["transform","WebkitTransform"]);function M1(a,i){a.style[T1]=i}function rs(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const a=window.document.createEvent("UIEvents");a.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(a)}}function S7(a){const i=["padding: "+(a.height/2-8)+"px "+a.width/2+"px;","line-height: "+a.height+"px;","background-image: url("+a.toDataURL()+");"];console.log(`%c
`,i.join(""))}function eE(){var a;const i=window.document.querySelector('meta[name="viewport"]');if(!i)return 1;const f=((a=i.content)==null?void 0:a.split(",")).find(p=>{const[y]=p.split("=");return y==="initial-scale"});return f?f.split("=")[1]*1:1}var Mo=eE()<1?1:window.devicePixelRatio;function z0(a,i){a.setAttribute("style",`${a.style.cssText}${i}`)}function gc(a){return a.split(";").map(i=>i.trim()).filter(i=>i)}function C1(a,i){var s;const f=gc((s=a.getAttribute("style"))!=null?s:""),p=gc(i),y=O1(f,...p);a.setAttribute("style",y.join(";"))}function dl(a){return Object.entries(a).map(([i,s])=>`${i}: ${s}`).join(";")}function Ri(a,i){return{left:a.left-i.left,top:a.top-i.top,right:i.left+i.width-a.left-a.width,bottom:i.top+i.height-a.top-a.height}}function nE(a,i){a.checked=i,i?a.setAttribute("checked","true"):a.removeAttribute("checked")}function hl(a){a.innerHTML=""}function Ld(a){a.setAttribute("draggable","false")}function Zu(a,i){if(typeof i=="string"){const s=document.createElement("div");for(s.innerHTML=i;s.firstChild;)a.append(s.firstChild)}else Array.isArray(i)?a.append(...i):a.append(i)}function P1(a,i){var s;const f=Array.isArray(i)?i:[i];let p=a;for(;p instanceof Element&&p!==window.document.body;){if(f.find(y=>p==null?void 0:p.matches(y)))return p;p=(s=p==null?void 0:p.parentElement)!=null?s:null}}function ji(a){return typeof ImageBitmap!="undefined"&&a instanceof ImageBitmap}function L1(){return typeof importScripts=="function"}var Ti=L1()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Id=navigator==null?void 0:navigator.userAgent,Aa=!!Id.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),U0=Id.indexOf("Android")>-1||Id.indexOf("Adr")>-1;function rE(){const a=Id,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let s=!0;for(const f of i)if(a.indexOf(f)>0){s=!1;break}return s}function I1(a,i){a.forEach(s=>{i[s]&&(i[s]=i[s].bind(i))})}var w7=class{constructor(a=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=a}run(a){const i=new Date().getTime(),s=i-this.timestamp;this.timestamp=i,s>=this.duration&&a()}};function Z0(a){var i=[1/0,1/0,-1/0,-1/0];return ce(a,function(s){i[0]>s[0]&&(i[0]=s[0]),i[1]>s[1]&&(i[1]=s[1]),i[2]<s[0]&&(i[2]=s[0]),i[3]<s[1]&&(i[3]=s[1])}),i}Z0.default=Z0;var R1=Z0;function Rd(a){return typeof a=="number"}function ki(a){return a-Math.fround(a)}var H0=2*Math.PI*6378137/2;function iE(a,i){const[s,f,p,y]=i;return a.lng>s&&a.lng<=p&&a.lat>f&&a.lat<=y}function oE(a){const i=[1/0,1/0,-1/0,-1/0];return a.forEach(s=>{const{coordinates:f}=s;k1(i,f)}),i}function k1(a,i){return Array.isArray(i[0])?i.forEach(s=>{k1(a,s)}):(a[0]>i[0]&&(a[0]=i[0]),a[1]>i[1]&&(a[1]=i[1]),a[2]<i[0]&&(a[2]=i[0]),a[3]<i[1]&&(a[3]=i[1])),a}function O7(a,i){return W0(a,i)}function W0(a,i){return Array.isArray(a[0])?a.map(s=>W0(s,i)):i(a)}function kd(a,i=!0,s={enable:!0,decimal:1}){a=sE(a,i);const f=a[0],p=a[1];let y=f*H0/180,x=Math.log(Math.tan((90+p)*Math.PI/360))/(Math.PI/180);return x=x*H0/180,s.enable&&(y=Number(y.toFixed(s.decimal)),x=Number(x.toFixed(s.decimal))),a.length===3?[y,x,a[2]]:[y,x]}function V0(a,i=6){const s=a[0],f=a[1];let p=s/H0*180,y=f/H0*180;return y=180/Math.PI*(2*Math.atan(Math.exp(y*Math.PI/180))-Math.PI/2),i!=null&&(p=Number(p.toFixed(i)),y=Number(y.toFixed(i))),a.length===3?[p,y,a[2]]:[p,y]}function aE(a){if(a==null)throw new Error("lng is required");return(a>180||a<-180)&&(a=a%360,a>180&&(a=-360+a),a<-180&&(a=360+a),a===0&&(a=0)),a}function vc(a){if(a==null)throw new Error("lat is required");return(a>90||a<-90)&&(a=a%180,a>90&&(a=-180+a),a<-90&&(a=180+a),a===0&&(a=0)),a}function sE(a,i){if(i===!1)return a;const s=aE(a[0]);let f=vc(a[1]);return f>85&&(f=85),f<-85&&(f=-85),a.length===3?[s,f,a[2]]:[s,f]}function wo(a){const i=85.0511287798,s=Math.max(Math.min(i,a[1]),-i),f=256<<20;let p=Math.PI/180,y=a[0]*p,x=s*p;x=Math.log(Math.tan(Math.PI/4+x/2));const O=.5/Math.PI,A=.5,I=-.5/Math.PI;return p=.5,y=f*(O*y+A),x=f*(I*x+p),[Math.floor(y),Math.floor(x)]}function mc(a){const i=.5/Math.PI,s=.5,f=-.5/Math.PI;let p=.5;const y=256<<20;let[x,O]=a;x=(x/y-s)/i,O=(O/y-p)/f,O=(Math.atan(Math.pow(Math.E,O))-Math.PI/4)*2,p=Math.PI/180;const A=O/p;return[x/p,A]}function cE(a,i){const s=85.0511287798,f=Math.PI/180,p=6378137;return i=Math.max(Math.min(s,i),-s),a*=f,i*=f,i=Math.log(Math.tan(Math.PI/4+i/2)),[a*p,i*p]}function E7(a,i){const s=Math.PI/180,f=6378137,p=a/f/s,y=2*(Math.atan(Math.exp(i/f))-Math.PI/4)/s;return[p,y]}function D1(a,i,s){const f=degreesToRadians(i[1]-a[1]),p=degreesToRadians(i[0]-a[0]),y=degreesToRadians(a[1]),x=degreesToRadians(i[1]),O=Math.pow(Math.sin(f/2),2)+Math.pow(Math.sin(p/2),2)*Math.cos(y)*Math.cos(x);return radiansToLength(2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O)),s="meters")}function A7(a){const i=Math.PI/180,s=85.0511287798,f=6378137,p=Math.max(Math.min(s,a[1]),-s),y=Math.sin(p*i),x=f*a[0]*i,O=f*Math.log((1+y)/(1-y))/2;return[x,O]}function Dd(a,i){const s=Math.abs(a[1][1]-a[0][1])*i,f=Math.abs(a[1][0]-a[0][0])*i;return[[a[0][0]-f,a[0][1]-s],[a[1][0]+f,a[1][1]+s]]}function G0(a,i){return a[0][0]<=i[0][0]&&a[0][1]<=i[0][1]&&a[1][0]>=i[1][0]&&a[1][1]>=i[1][1]}function Nd(a){return[[a[0],a[1]],[a[2],a[3]]]}function lE(a){const i=N1(a,[0,0]);return[a[0]/i,a[1]/i]}function N1(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}function uE(a,i){return a[0]*i[0]+a[1]*i[1]}function F1(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function T7(a,i){return Math.acos(uE(a,i)/(F1(a)*F1(i)))*180/Math.PI}function fE(a,i){return i[0]>0?i[1]>0?90-Math.atan(i[1]/i[0])*180/Math.PI:90+Math.atan(-i[1]/i[0])*180/Math.PI:i[1]<0?180+(90-Math.atan(i[1]/i[0])*180/Math.PI):270+Math.atan(i[1]/-i[0])*180/Math.PI}function M7(a,i=100){if(!a||a.length<2)return;const s=[0,1];let f=0;const p=[];for(let y=0;y<a.length-1;y++){const x=a[y],O=a[y+1],A=N1(x,O);f+=A;const I=[x[0]-O[0],x[1]-O[1]];let B=fE(s,I);if(y>0){const j=p[y-1].rotation;j-B>360-j+B&&(B=B+360)}p.push({start:x,end:O,dis:A,rotation:B,duration:0})}return p.map(y=>{y.duration=i*(y.dis/f)}),p}function yc(a){if(Rd(a[0]))return a;if(Rd(a[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Rd(a[0][0][0])){const i=a;let s=0,f=0,p=0;return i.forEach(y=>{y.forEach(x=>{s+=x[0],f+=x[1],p++})}),[s/p,f/p,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function B1(a){let i=a[0],s=a[1],f=a[0],p=a[1],y=0,x=0,O=0;for(let A=0;A<a.length;A+=2){const I=a[A],B=a[A+1];I&&B&&(i=Math.max(I,i),s=Math.max(B,s),f=Math.min(I,f),p=Math.min(B,p),y+=I,x+=B,O++)}return{center:[y/O,x/O],radius:Math.sqrt(Math.pow(i-f,2)+Math.pow(s-p,2))/2}}function C7(a){return R1(Re([_e(a)]))}function P7(a){let f=0;a+="x";const p=Math.floor(9007199254740991/137);for(let y=0;y<a.length;y++)f>p&&(f=Math.floor(f/137)),f=f*131+a.charCodeAt(y);return f}function L7(a){a=a.toString();let i=5381,s=a.length;for(;s;)i=i*33^a.charCodeAt(--s);return i>>>0}function dE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const i=Math.random()*16|0;return(a==="x"?i:i&3|8).toString(16)})}function I7(a,i,s,f,p=30,y){let x=s;return y&&(x=Math.round(s*(p-1))/(p-1)),f?$0(a,i,x,f):$0(a,i,x,.314)}function j1(a,i){const s=1-i;return(a[0]*s+a[1]*i)*s+(a[1]*s+a[2]*i)*i}function hE(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}function pE(a,i,s){const f=[i[0]-a[0],i[1]-a[1]],p=hE(f,[0,0]),y=Math.atan2(f[1],f[0]),x=p/2/Math.cos(s),O=y+s;return[x*Math.cos(O)+a[0],x*Math.sin(O)+a[1]]}function $0(a,i,s,f){const p=pE(a,i,f),y=[a[0],p[0],i[0]],x=[a[1],p[1],i[1]];return[j1(y,s),j1(x,s),0]}function xF(a,i,s,f,p=30,y){let x=s;return y&&(x=Math.round(s*29)/29),vE(a,i,x)}function gE(a,i){const s=[a[0]-i[0],a[1]-i[1]],f=[Math.sin(s[0]/2),Math.sin(s[1]/2)],p=f[1]*f[1]+Math.cos(a[1])*Math.cos(i[1])*f[0]*f[0];return 2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p))}function vE(a,i,s){const f=[degreesToRadians(a[0]),degreesToRadians(a[1])],p=[degreesToRadians(i[0]),degreesToRadians(i[1])],y=gE(f,p);if(Math.abs(y-Math.PI)<.001)return[(1-s)*f[0]+s*p[0],(1-s)*f[1]+s*p[1]];const x=Math.sin((1-s)*y)/Math.sin(y),O=Math.sin(s*y)/Math.sin(y),A=[Math.sin(f[0]),Math.sin(f[1])],I=[Math.cos(f[0]),Math.cos(f[1])],B=[Math.sin(p[0]),Math.sin(p[1])],j=[Math.cos(p[0]),Math.cos(p[1])],V=x*I[1]*I[0]+O*j[1]*j[0],mt=x*I[1]*A[0]+O*j[1]*B[0],Bt=x*A[1]+O*B[1];return[radiansToDegrees(Math.atan2(mt,V)),radiansToDegrees(Math.atan2(Bt,Math.sqrt(V*V+mt*mt)))]}function mE(a,i){let s=0;const f=[];for(let O=0;O<a.length-1;O++){const A=a[O],I=a[O+1],B=z1(A,I),j=s;s+=B,f.push({p1:A,p2:I,totalDistance:s,distance:B,lastTotalDistance:j})}const p=s*i;let y,x;for(const O of f)if(O.totalDistance>p){const I=O.p1,B=O.p2,j=(p-O.lastTotalDistance)/O.distance,V=yE(B,I,j);y=V[0],x=V[1];break}return{lng:y,lat:x,height:0}}function yE(a,i,s){return[a[0]*s+i[0]*(1-s),a[1]*s+i[1]*(1-s)]}function z1(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}var U1=Object.defineProperty,Z1=Object.getOwnPropertySymbols,H1=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable,W1=(a,i,s)=>i in a?U1(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,_E=(a,i)=>{for(var s in i||(i={}))H1.call(i,s)&&W1(a,s,i[s]);if(Z1)for(var s of Z1(i))er.call(i,s)&&W1(a,s,i[s]);return a};function Fd(a,i){const{featureId:s}=i;let f=a.data.dataArray;return typeof s=="number"&&(f=f.filter(({id:p})=>p===s)),f.map(p=>{const y=V1(p,i);return _E(_E({},p),y)})}function bE(a,i){return new Promise(s=>{a.inited?s(Fd(a,i)):a.once("update",()=>{s(Fd(a,i))})})}function V1(a,i){const{offset:s,shape:f,thetaOffset:p,segmentNumber:y=30,autoFit:x=!0}=i,{coordinates:O}=a;if(f==="line")return pathLineAtOffset(O,s);const A=O[0],I=O[1],B=typeof p=="string"?a[p]||0:p;let j;switch(f){case"arc":j=arcLineAtOffset;break;case"greatcircle":j=greatCircleLineAtOffset;break;default:j=arcLineAtOffset}const[V,mt,Bt]=j(A,I,s,B,y,x);return{lng:V,lat:mt,height:Bt}}var G1=class{constructor(a=50,i){this.limit=a,this.destroy=i||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(a=>{this.delete(a)}),this.cache={},this.order=[]}get(a){const i=this.cache[a];return i&&(this.deleteOrder(a),this.appendOrder(a)),i}set(a,i){this.cache[a]?(this.delete(a),this.cache[a]=i,this.appendOrder(a)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[a]=i,this.appendOrder(a))}delete(a){const i=this.cache[a];i&&(this.deleteCache(a),this.deleteOrder(a),this.destroy(i,a))}deleteCache(a){delete this.cache[a]}deleteOrder(a){const i=this.order.findIndex(s=>s===a);i>=0&&this.order.splice(i,1)}appendOrder(a){this.order.push(a)}defaultDestroy(a,i){return null}};function Hu(a){if(a.length===0)throw new Error("max requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]>i&&(i=a[s]);return i*1}function $r(a){if(a.length===0)throw new Error("min requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]<i&&(i=a[s]);return i*1}function Wu(a){if(a.length===0)return 0;let i=a[0]*1;for(let s=1;s<a.length;s++)i+=a[s]*1;return i}function $1(a){if(a.length===0)throw new Error("mean requires at least one data point");return Wu(a)/a.length}function R7(a){if(a.length===0)throw new Error("mean requires at least one data point");if(a.length<3)return a[0];a.sort();let i=a[0],s=NaN,f=0,p=1;for(let y=1;y<a.length+1;y++)a[y]!==i?(p>f&&(f=p,s=i),p=1,i=a[y]):p++;return s*1}var Y1={min:$r,max:Hu,mean:$1,sum:Wu,mode:R7};function Bd(a,i){return a.map(s=>s[i])}function Y0(a,i){return Y1[a](i)}function k7(a,i){i===void 0&&(i={});var s=Number(a[0]),f=Number(a[1]),p=Number(a[2]),y=Number(a[3]);if(a.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var x=[s,f],O=[s,y],A=[p,y],I=[p,f];return ne([[x,I,A,O,x]],i.properties,{bbox:a,id:i.id})}var No=L(26729),jd=L.n(No),Ta=(a=>(a.Realtime="realtime",a.Overlap="overlap",a.Replace="replace",a))(Ta||{}),Br=(a=>(a.Loading="Loading",a.Loaded="Loaded",a.Failure="Failure",a.Cancelled="Cancelled",a))(Br||{}),X1=0,zd=1,Ud=2;function xE(a){a.forEach(i=>{i.isCurrent&&(i.isVisible=i.isLoaded)})}function is(a){a.forEach(i=>{i.properties.state=X1}),a.forEach(i=>{i.isCurrent&&!q1(i)&&Zd(i)}),a.forEach(i=>{i.isVisible=!!(i.properties.state&Ud)})}function SE(a){a.forEach(s=>{s.properties.state=X1}),a.forEach(s=>{s.isCurrent&&q1(s)}),a.slice().sort((s,f)=>s.z-f.z).forEach(s=>{s.isVisible=!!(s.properties.state&Ud),s.children.length&&(s.isVisible||s.properties.state&zd)?s.children.forEach(f=>{f.properties.state=zd}):s.isCurrent&&Zd(s)})}function q1(a){for(;a;){if(a.isLoaded)return a.properties.state|=Ud,!0;a=a.parent}return!1}function Zd(a){a.children.forEach(i=>{i.isLoaded?i.properties.state|=Ud:Zd(i)})}var D7=256,nn=[-1/0,-1/0,1/0,1/0],K1=.2,wE=5,Q1={[Ta.Realtime]:xE,[Ta.Overlap]:is,[Ta.Replace]:SE},J1=()=>{};function X0(a,i,s){const f=Math.floor((a+180)/360*Math.pow(2,s)),p=Math.floor((1-Math.log(Math.tan(i*Math.PI/180)+1/Math.cos(i*Math.PI/180))/Math.PI)/2*Math.pow(2,s));return[f,p]}function t_(a,i,s){const f=a/Math.pow(2,s)*360-180,p=Math.PI-2*Math.PI*i/Math.pow(2,s),y=180/Math.PI*Math.atan(.5*(Math.exp(p)-Math.exp(-p)));return[f,y]}var e_=(a,i,s)=>{const[f,p]=t_(a,i,s),[y,x]=t_(a+1,i+1,s);return[f,x,y,p]};function n_({zoom:a,latLonBounds:i,maxZoom:s=1/0,minZoom:f=0,zoomOffset:p=0,extent:y=nn}){let x=Math.ceil(a)+p;if(Number.isFinite(f)&&x<f)return[];Number.isFinite(s)&&x>s&&(x=s);const[O,A,I,B]=i,j=[Math.max(O,y[0]),Math.max(A,y[1]),Math.min(I,y[2]),Math.min(B,y[3])],V=[],[mt,Bt]=X0(j[0],j[1],x),[Kt,ue]=X0(j[2],j[3],x);for(let Ye=mt;Ye<=Kt;Ye++)for(let rn=ue;rn<=Bt;rn++)V.push({x:Ye,y:rn,z:x});const Le=(Kt+mt)/2,ke=(Bt+ue)/2,He=(Ye,rn)=>Math.abs(Ye-Le)+Math.abs(rn-ke);return V.sort((Ye,rn)=>He(Ye.x,Ye.y)-He(rn.x,rn.y)),V}var Vu=(a,i,s,f=!0)=>{const p=Math.pow(2,s),y=p-1,x=p;let O=a;const A=i;return f&&(O<0?O=O+x:O>y&&(O=O%x)),{warpX:O,warpY:A}},Hd=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),r_=class extends No.EventEmitter{constructor(a){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:i,y:s,z:f,tileSize:p,warp:y=!0}=a;this.x=i,this.y=s,this.z=f,this.warp=y||!0,this.tileSize=p}get isLoading(){return this.loadStatus===Br.Loading}get isLoaded(){return this.loadStatus===Br.Loaded}get isFailure(){return this.loadStatus===Br.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===Br.Cancelled}get isDone(){return[Br.Loaded,Br.Cancelled,Br.Failure].includes(this.loadStatus)}get bounds(){return e_(this.x,this.y,this.z)}get bboxPolygon(){const[a,i,s,f]=this.bounds,p=[(s-a)/2,(f-i)/2];return k7(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:p,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(a){return Hd(this,arguments,function*({getData:i,onLoad:s,onError:f}){this.loadDataId++;const p=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Br.Loading;let y=null,x;try{const{x:O,y:A,z:I,bounds:B,tileSize:j,warp:V}=this,{warpX:mt,warpY:Bt}=Vu(O,A,I,V),{signal:Kt}=this.abortController;y=yield i({x:mt,y:Bt,z:I,bounds:B,tileSize:j,signal:Kt,warp:V},this)}catch(O){x=O}if(p===this.loadDataId&&!(this.isCancelled&&!y)){if(x||!y){this.loadStatus=Br.Failure,f(x,this);return}this.loadStatus=Br.Loaded,this.data=y,s(this)}})}reloadData(a){this.isLoading&&this.abortLoad(),this.loadData(a)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=Br.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},i_=(a,i)=>{const s=Nd(a),f=Dd(s,i),p=360*3-180,y=85.0511287798065;return[Math.max(f[0][0],-p),Math.max(f[0][1],-y),Math.min(f[1][0],p),Math.min(f[1][1],y)]},o_=(a,i)=>{const s=Nd(a),f=Nd(i);return G0(s,f)},Wd=Object.defineProperty,OE=Object.defineProperties,EE=Object.getOwnPropertyDescriptors,a_=Object.getOwnPropertySymbols,AE=Object.prototype.hasOwnProperty,TE=Object.prototype.propertyIsEnumerable,Ms=(a,i,s)=>i in a?Wd(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Vd=(a,i)=>{for(var s in i||(i={}))AE.call(i,s)&&Ms(a,s,i[s]);if(a_)for(var s of a_(i))TE.call(i,s)&&Ms(a,s,i[s]);return a},q0=(a,i)=>OE(a,EE(i)),{throttle:K0}=hi,Gd=(a=>(a.TilesLoadStart="tiles-load-start",a.TileLoaded="tile-loaded",a.TileError="tile-error",a.TileUnload="tile-unload",a.TileUpdate="tile-update",a.TilesLoadFinished="tiles-load-finished",a))(Gd||{}),s_=class extends jd(){constructor(a){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=K0((i,s)=>{this.update(i,s)},16),this.onTileLoad=i=>{this.emit("tile-loaded",i),this.updateTileVisible(),this.loadFinished()},this.onTileError=(i,s)=>{this.emit("tile-error",{error:i,tile:s}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=i=>{this.emit("tile-unload",i),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:nn,getTileData:J1,warp:!0,updateStrategy:Ta.Replace},this.updateOptions(a)}get isLoaded(){return this.currentTiles.every(a=>a.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((i,s)=>i.z-s.z)}updateOptions(a){const i=a.minZoom===void 0?this.options.minZoom:Math.ceil(a.minZoom),s=a.maxZoom===void 0?this.options.maxZoom:Math.floor(a.maxZoom);this.options=q0(Vd(Vd({},this.options),a),{minZoom:i,maxZoom:s})}update(a,i){const s=Math.max(0,Math.ceil(a));if(this.lastViewStates&&this.lastViewStates.zoom===s&&o_(this.lastViewStates.latLonBoundsBuffer,i))return;const f=i_(i,K1);this.lastViewStates={zoom:s,latLonBounds:i,latLonBoundsBuffer:f},this.currentZoom=s;let p=!1;const y=this.getTileIndices(s,f).filter(x=>this.options.warp||x.x>=0&&x.x<Math.pow(2,s));this.emit("tiles-load-start"),this.currentTiles=y.map(({x,y:O,z:A})=>{let I=this.getTile(x,O,A);return I?(((I==null?void 0:I.isFailure)||(I==null?void 0:I.isCancelled))&&I.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),I):(I=this.createTile(x,O,A),p=!0,I)}),p&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[a,i]of this.cacheTiles){if(!this.currentTiles.includes(i)){this.cacheTiles.delete(a),this.onTileUnload(i);return}this.onTileUnload(i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(a,i,s){const f=this.cacheTiles.get(`${i},${s},${a}`);f&&(this.onTileUnload(f),f.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(a,i,s){const f=this.getTileByLngLat(a,i,s);f&&this.reloadTileById(f.z,f.x,f.y)}reloadTileByExtent(a,i){this.getTileIndices(i,a).forEach(f=>{this.reloadTileById(f.z,f.x,f.y)})}pruneRequests(){const a=[];for(const i of this.cacheTiles.values())i.isLoading&&!i.isCurrent&&!i.isVisible&&a.push(i);for(;a.length>0;)a.shift().abortLoad()}getTileByLngLat(a,i,s){const{zoomOffset:f}=this.options,p=Math.ceil(s)+f,y=X0(a,i,p);return this.tiles.filter(O=>O.key===`${y[0]}_${y[1]}_${p}`)[0]}getTileExtent(a,i){return this.getTileIndices(i,a)}getTileByZXY(a,i,s){return this.tiles.filter(p=>p.key===`${i}_${s}_${a}`)[0]}clear(){for(const a of this.cacheTiles.values())a.isLoading?a.abortLoad():this.onTileUnload(a);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const a=this.options.updateStrategy,i=new Map;for(const p of this.cacheTiles.values())i.set(p.key,p.isVisible),p.isCurrent=!1,p.isVisible=!1;for(const p of this.currentTiles)p.isCurrent=!0,p.isVisible=!0;const s=Array.from(this.cacheTiles.values());typeof a=="function"?a(s):Q1[a](s);let f=!1;Array.from(this.cacheTiles.values()).forEach(p=>{p.isVisible!==i.get(p.key)?(p.isVisibleChange=!0,f=!0):p.isVisibleChange=!1}),f&&this.emit("tile-update")}getTileIndices(a,i){const{tileSize:s,extent:f,zoomOffset:p}=this.options,y=Math.floor(this.options.maxZoom),x=Math.ceil(this.options.minZoom);return n_({maxZoom:y,minZoom:x,zoomOffset:p,tileSize:s,zoom:a,latLonBounds:i,extent:f})}getTileId(a,i,s){return`${a},${i},${s}`}loadFinished(){const a=!this.currentTiles.some(i=>!i.isDone);return a&&this.emit("tiles-load-finished"),a}getTile(a,i,s){const f=this.getTileId(a,i,s);return this.cacheTiles.get(f)}createTile(a,i,s){const f=this.getTileId(a,i,s),p=new r_({x:a,y:i,z:s,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(f,p),p.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),p}resizeCacheTiles(){const a=wE*this.currentTiles.length;if(this.cacheTiles.size>a){for(const[s,f]of this.cacheTiles)if(!f.isVisible&&!this.currentTiles.includes(f)&&(this.cacheTiles.delete(s),this.onTileUnload(f)),this.cacheTiles.size<=a)break}this.rebuildTileTree()}rebuildTileTree(){for(const a of this.cacheTiles.values())a.parent=null,a.children.length=0;for(const a of this.cacheTiles.values()){const i=this.getNearestAncestor(a.x,a.y,a.z);a.parent=i,i!=null&&i.children&&i.children.push(a)}}getNearestAncestor(a,i,s){for(;s>this.options.minZoom;){a=Math.floor(a/2),i=Math.floor(i/2),s=s-1;const f=this.getTile(a,i,s);if(f)return f}return null}};function N7(a){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(a)}function os(a){const i=[];let s=/\{([a-z])-([a-z])\}/.exec(a);if(s){const f=s[1].charCodeAt(0),p=s[2].charCodeAt(0);let y;for(y=f;y<=p;++y)i.push(a.replace(s[0],String.fromCharCode(y)));return i}if(s=/\{(\d+)-(\d+)\}/.exec(a),s){const f=parseInt(s[2],10);for(let p=parseInt(s[1],10);p<=f;p++)i.push(a.replace(s[0],p.toString()));return i}return i.push(a),i}function Ma(a,i){if(!a||!a.length)throw new Error("url is not allowed to be empty");const{x:s,y:f,z:p}=i,y=os(a),x=Math.abs(s+f)%y.length;return(Fr(y[x])?`${y[x]}/{z}/{x}/{y}`:y[x]).replace(/\{x\}/g,s.toString()).replace(/\{y\}/g,f.toString()).replace(/\{z\}/g,p.toString()).replace(/\{bbox\}/g,e_(s,f,p).join(",")).replace(/\{-y\}/g,(Math.pow(2,p)-f-1).toString())}function ME(a,i){const{x:s,y:f,z:p,layer:y,version:x="1.0.0",style:O="default",format:A,service:I="WMTS",tileMatrixset:B}=i,j=os(a),V=Math.abs(s+f)%j.length;return`${j[V]}&SERVICE=${I}&REQUEST=GetTile&VERSION=${x}&LAYER=${y}&STYLE=${O}&TILEMATRIXSET=${B}&FORMAT=${A}&TILECOL=${s}&TILEROW=${f}&TILEMATRIX=${p}`}function pl(a,i){return a==null?i:a}var $d=L(38163),Q0=L.n($d);function F7(a,i){return a.map(s=>s[i]*1)}function CE(a){return a===void 0?!1:!Array.isArray(a)&&a.data!==void 0}function PE(a){return Array.isArray(a)?a.length===0?!1:!!CE(a[0]):!1}function Cs(a){return Array.isArray(a)?a.length===0||typeof a[0]=="number":!1}function Gu(a){const i=Object.isFrozen(a)?hi.cloneDeep(a):a;return Q0()(i,!0),i}function gl(a,i){return a||[[i[0],i[3]],[i[2],i[3]],[i[2],i[1]],[i[0],i[1]]]}var J0=Object.defineProperty,vl=Object.defineProperties,Yd=Object.getOwnPropertyDescriptors,Ur=Object.getOwnPropertySymbols,B7=Object.prototype.hasOwnProperty,LE=Object.prototype.propertyIsEnumerable,c_=(a,i,s)=>i in a?J0(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,wn=(a,i)=>{for(var s in i||(i={}))B7.call(i,s)&&c_(a,s,i[s]);if(Ur)for(var s of Ur(i))LE.call(i,s)&&c_(a,s,i[s]);return a},tg=(a,i)=>vl(a,Yd(i));function IE(a,i){const{x:s,y:f,x1:p,y1:y,coordinates:x,geometry:O}=i,A=[];if(!Array.isArray(a))return{dataArray:[]};if(O)return a.filter(I=>I[O]&&I[O].type&&I[O].coordinates&&I[O].coordinates.length>0).forEach((I,B)=>{const j=Gu(I[O]);ge(j,V=>{const mt=Se(V),Bt=tg(wn({},I),{_id:B,coordinates:mt});A.push(Bt)})}),{dataArray:A};for(let I=0;I<a.length;I++){const B=a[I];let j=[];if(x){let mt="Polygon";Array.isArray(x[0])||(mt="Point"),Array.isArray(x[0])&&!Array.isArray(x[0][0])&&(mt="LineString"),j=Gu({type:mt,coordinates:B[x]}).coordinates}else if(s&&f&&p&&y){const mt=[parseFloat(B[s]),parseFloat(B[f])],Bt=[parseFloat(B[p]),parseFloat(B[y])];j=[mt,Bt]}else s&&f&&(j=[parseFloat(B[s]),parseFloat(B[f])]);const V=tg(wn({},B),{_id:I,coordinates:j});A.push(V)}return{dataArray:A}}function RE(a,i){const s=Ke(a);return IE(s,i)}var Xd=Object.defineProperty,l_=Object.defineProperties,ml=Object.getOwnPropertyDescriptors,Ca=Object.getOwnPropertySymbols,u_=Object.prototype.hasOwnProperty,Kn=Object.prototype.propertyIsEnumerable,Mi=(a,i,s)=>i in a?Xd(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Ir=(a,i)=>{for(var s in i||(i={}))u_.call(i,s)&&Mi(a,s,i[s]);if(Ca)for(var s of Ca(i))Kn.call(i,s)&&Mi(a,s,i[s]);return a},f_=(a,i)=>l_(a,ml(i));function j7(a){const i=a.toString();let s=5381,f=i.length;for(;f;)s=s*33^i.charCodeAt(--f);return s>>>0}function zi(a,i){return i===void 0?null:isNaN(a.properties[i]*1)?a.properties&&a.properties[i]?j7(a.properties[i]+"")%1000019:null:a.properties[i]*1}function rr(a,i){const s=[],f={};return a.features?(a.features=a.features.filter(p=>{const y=p.geometry;return p!=null&&y&&y.type&&y.coordinates&&y.coordinates.length>0}),a=Gu(a),a.features.length===0?{dataArray:[],featureKeys:f}:(ge(a,(p,y)=>{let x=zi(p,i==null?void 0:i.featureId);x===null&&(x=y);const O=x,A=Se(p),I=f_(Ir({},p.properties),{coordinates:A,_id:O});s.push(I)}),{dataArray:s,featureKeys:f})):(a.features=[],{dataArray:[]})}function eg(a,i,s,f){for(var p=f,y=s-i>>1,x=s-i,O,A=a[i],I=a[i+1],B=a[s],j=a[s+1],V=i+3;V<s;V+=3){var mt=kE(a[V],a[V+1],A,I,B,j);if(mt>p)O=V,p=mt;else if(mt===p){var Bt=Math.abs(V-y);Bt<x&&(O=V,x=Bt)}}p>f&&(O-i>3&&eg(a,i,O,f),a[O+2]=p,s-O>3&&eg(a,O,s,f))}function kE(a,i,s,f,p,y){var x=p-s,O=y-f;if(x!==0||O!==0){var A=((a-s)*x+(i-f)*O)/(x*x+O*O);A>1?(s=p,f=y):A>0&&(s+=x*A,f+=O*A)}return x=a-s,O=i-f,x*x+O*O}function $u(a,i,s,f){var p={id:typeof a=="undefined"?null:a,type:i,geometry:s,tags:f,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return ng(p),p}function ng(a){var i=a.geometry,s=a.type;if(s==="Point"||s==="MultiPoint"||s==="LineString")rg(a,i);else if(s==="Polygon"||s==="MultiLineString")for(var f=0;f<i.length;f++)rg(a,i[f]);else if(s==="MultiPolygon")for(f=0;f<i.length;f++)for(var p=0;p<i[f].length;p++)rg(a,i[f][p])}function rg(a,i){for(var s=0;s<i.length;s+=3)a.minX=Math.min(a.minX,i[s]),a.minY=Math.min(a.minY,i[s+1]),a.maxX=Math.max(a.maxX,i[s]),a.maxY=Math.max(a.maxY,i[s+1])}function d_(a,i){var s=[];if(a.type==="FeatureCollection")for(var f=0;f<a.features.length;f++)Ps(s,a.features[f],i,f);else a.type==="Feature"?Ps(s,a,i):Ps(s,{geometry:a},i);return s}function Ps(a,i,s,f){if(i.geometry){var p=i.geometry.coordinates,y=i.geometry.type,x=Math.pow(s.tolerance/((1<<s.maxZoom)*s.extent),2),O=[],A=i.id;if(s.promoteId?A=i.properties[s.promoteId]:s.generateId&&(A=f||0),y==="Point")qd(p,O);else if(y==="MultiPoint")for(var I=0;I<p.length;I++)qd(p[I],O);else if(y==="LineString")Kd(p,O,x,!1);else if(y==="MultiLineString")if(s.lineMetrics){for(I=0;I<p.length;I++)O=[],Kd(p[I],O,x,!1),a.push($u(A,"LineString",O,i.properties));return}else ig(p,O,x,!1);else if(y==="Polygon")ig(p,O,x,!0);else if(y==="MultiPolygon")for(I=0;I<p.length;I++){var B=[];ig(p[I],B,x,!0),O.push(B)}else if(y==="GeometryCollection"){for(I=0;I<i.geometry.geometries.length;I++)Ps(a,{id:A,geometry:i.geometry.geometries[I],properties:i.properties},s,f);return}else throw new Error("Input data is not a valid GeoJSON object.");a.push($u(A,y,O,i.properties))}}function qd(a,i){i.push(yi(a[0])),i.push(h_(a[1])),i.push(0)}function Kd(a,i,s,f){for(var p,y,x=0,O=0;O<a.length;O++){var A=yi(a[O][0]),I=h_(a[O][1]);i.push(A),i.push(I),i.push(0),O>0&&(f?x+=(p*I-A*y)/2:x+=Math.sqrt(Math.pow(A-p,2)+Math.pow(I-y,2))),p=A,y=I}var B=i.length-3;i[2]=1,eg(i,0,B,s),i[B+2]=1,i.size=Math.abs(x),i.start=0,i.end=i.size}function ig(a,i,s,f){for(var p=0;p<a.length;p++){var y=[];Kd(a[p],y,s,f),i.push(y)}}function yi(a){return a/360+.5}function h_(a){var i=Math.sin(a*Math.PI/180),s=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return s<0?0:s>1?1:s}function as(a,i,s,f,p,y,x,O){if(s/=i,f/=i,y>=s&&x<f)return a;if(x<s||y>=f)return null;for(var A=[],I=0;I<a.length;I++){var B=a[I],j=B.geometry,V=B.type,mt=p===0?B.minX:B.minY,Bt=p===0?B.maxX:B.maxY;if(mt>=s&&Bt<f){A.push(B);continue}else if(Bt<s||mt>=f)continue;var Kt=[];if(V==="Point"||V==="MultiPoint")DE(j,Kt,s,f,p);else if(V==="LineString")p_(j,Kt,s,f,p,!1,O.lineMetrics);else if(V==="MultiLineString")og(j,Kt,s,f,p,!1);else if(V==="Polygon")og(j,Kt,s,f,p,!0);else if(V==="MultiPolygon")for(var ue=0;ue<j.length;ue++){var Le=[];og(j[ue],Le,s,f,p,!0),Le.length&&Kt.push(Le)}if(Kt.length){if(O.lineMetrics&&V==="LineString"){for(ue=0;ue<Kt.length;ue++)A.push($u(B.id,V,Kt[ue],B.tags));continue}(V==="LineString"||V==="MultiLineString")&&(Kt.length===1?(V="LineString",Kt=Kt[0]):V="MultiLineString"),(V==="Point"||V==="MultiPoint")&&(V=Kt.length===3?"Point":"MultiPoint"),A.push($u(B.id,V,Kt,B.tags))}}return A.length?A:null}function DE(a,i,s,f,p){for(var y=0;y<a.length;y+=3){var x=a[y+p];x>=s&&x<=f&&(i.push(a[y]),i.push(a[y+1]),i.push(a[y+2]))}}function p_(a,i,s,f,p,y,x){for(var O=g_(a),A=p===0?z7:Jd,I=a.start,B,j,V=0;V<a.length-3;V+=3){var mt=a[V],Bt=a[V+1],Kt=a[V+2],ue=a[V+3],Le=a[V+4],ke=p===0?mt:Bt,He=p===0?ue:Le,Ye=!1;x&&(B=Math.sqrt(Math.pow(mt-ue,2)+Math.pow(Bt-Le,2))),ke<s?He>s&&(j=A(O,mt,Bt,ue,Le,s),x&&(O.start=I+B*j)):ke>f?He<f&&(j=A(O,mt,Bt,ue,Le,f),x&&(O.start=I+B*j)):Qd(O,mt,Bt,Kt),He<s&&ke>=s&&(j=A(O,mt,Bt,ue,Le,s),Ye=!0),He>f&&ke<=f&&(j=A(O,mt,Bt,ue,Le,f),Ye=!0),!y&&Ye&&(x&&(O.end=I+B*j),i.push(O),O=g_(a)),x&&(I+=B)}var rn=a.length-3;mt=a[rn],Bt=a[rn+1],Kt=a[rn+2],ke=p===0?mt:Bt,ke>=s&&ke<=f&&Qd(O,mt,Bt,Kt),rn=O.length-3,y&&rn>=3&&(O[rn]!==O[0]||O[rn+1]!==O[1])&&Qd(O,O[0],O[1],O[2]),O.length&&i.push(O)}function g_(a){var i=[];return i.size=a.size,i.start=a.start,i.end=a.end,i}function og(a,i,s,f,p,y){for(var x=0;x<a.length;x++)p_(a[x],i,s,f,p,y,!1)}function Qd(a,i,s,f){a.push(i),a.push(s),a.push(f)}function z7(a,i,s,f,p,y){var x=(y-i)/(f-i);return a.push(y),a.push(s+(p-s)*x),a.push(1),x}function Jd(a,i,s,f,p,y){var x=(y-s)/(p-s);return a.push(i+(f-i)*x),a.push(y),a.push(1),x}function NE(a,i){var s=i.buffer/i.extent,f=a,p=as(a,1,-1-s,s,0,-1,2,i),y=as(a,1,1-s,2+s,0,-1,2,i);return(p||y)&&(f=as(a,1,-s,1+s,0,-1,2,i)||[],p&&(f=v_(p,1).concat(f)),y&&(f=f.concat(v_(y,-1)))),f}function v_(a,i){for(var s=[],f=0;f<a.length;f++){var p=a[f],y=p.type,x;if(y==="Point"||y==="MultiPoint"||y==="LineString")x=th(p.geometry,i);else if(y==="MultiLineString"||y==="Polygon"){x=[];for(var O=0;O<p.geometry.length;O++)x.push(th(p.geometry[O],i))}else if(y==="MultiPolygon")for(x=[],O=0;O<p.geometry.length;O++){for(var A=[],I=0;I<p.geometry[O].length;I++)A.push(th(p.geometry[O][I],i));x.push(A)}s.push($u(p.id,y,x,p.tags))}return s}function th(a,i){var s=[];s.size=a.size,a.start!==void 0&&(s.start=a.start,s.end=a.end);for(var f=0;f<a.length;f+=3)s.push(a[f]+i,a[f+1],a[f+2]);return s}function FE(a,i){if(a.transformed)return a;var s=1<<a.z,f=a.x,p=a.y,y,x,O;for(y=0;y<a.features.length;y++){var A=a.features[y],I=A.geometry,B=A.type;if(A.geometry=[],B===1)for(x=0;x<I.length;x+=2)A.geometry.push(ag(I[x],I[x+1],i,s,f,p));else for(x=0;x<I.length;x++){var j=[];for(O=0;O<I[x].length;O+=2)j.push(ag(I[x][O],I[x][O+1],i,s,f,p));A.geometry.push(j)}}return a.transformed=!0,a}function ag(a,i,s,f,p,y){return[Math.round(s*(a*f-p)),Math.round(s*(i*f-y))]}function BE(a,i,s,f,p){for(var y=i===p.maxZoom?0:p.tolerance/((1<<i)*p.extent),x={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:s,y:f,z:i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},O=0;O<a.length;O++){x.numFeatures++,jE(x,a[O],y,p);var A=a[O].minX,I=a[O].minY,B=a[O].maxX,j=a[O].maxY;A<x.minX&&(x.minX=A),I<x.minY&&(x.minY=I),B>x.maxX&&(x.maxX=B),j>x.maxY&&(x.maxY=j)}return x}function jE(a,i,s,f){var p=i.geometry,y=i.type,x=[];if(y==="Point"||y==="MultiPoint")for(var O=0;O<p.length;O+=3)x.push(p[O]),x.push(p[O+1]),a.numPoints++,a.numSimplified++;else if(y==="LineString")yl(x,p,a,s,!1,!1);else if(y==="MultiLineString"||y==="Polygon")for(O=0;O<p.length;O++)yl(x,p[O],a,s,y==="Polygon",O===0);else if(y==="MultiPolygon")for(var A=0;A<p.length;A++){var I=p[A];for(O=0;O<I.length;O++)yl(x,I[O],a,s,!0,O===0)}if(x.length){var B=i.tags||null;if(y==="LineString"&&f.lineMetrics){B={};for(var j in i.tags)B[j]=i.tags[j];B.mapbox_clip_start=p.start/p.size,B.mapbox_clip_end=p.end/p.size}var V={geometry:x,type:y==="Polygon"||y==="MultiPolygon"?3:y==="LineString"||y==="MultiLineString"?2:1,tags:B};i.id!==null&&(V.id=i.id),a.features.push(V)}}function yl(a,i,s,f,p,y){var x=f*f;if(f>0&&i.size<(p?x:f)){s.numPoints+=i.length/3;return}for(var O=[],A=0;A<i.length;A+=3)(f===0||i[A+2]>x)&&(s.numSimplified++,O.push(i[A]),O.push(i[A+1])),s.numPoints++;p&&zE(O,y),a.push(O)}function zE(a,i){for(var s=0,f=0,p=a.length,y=p-2;f<p;y=f,f+=2)s+=(a[f]-a[y])*(a[f+1]+a[y+1]);if(s>0===i)for(f=0,p=a.length;f<p/2;f+=2){var x=a[f],O=a[f+1];a[f]=a[p-2-f],a[f+1]=a[p-1-f],a[p-2-f]=x,a[p-1-f]=O}}function Ls(a,i){return new eh(a,i)}function eh(a,i){i=this.options=UE(Object.create(this.options),i);var s=i.debug;if(s&&console.time("preprocess data"),i.maxZoom<0||i.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(i.promoteId&&i.generateId)throw new Error("promoteId and generateId cannot be used together.");var f=d_(a,i);this.tiles={},this.tileCoords=[],s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",i.indexMaxZoom,i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),f=NE(f,i),f.length&&this.splitTile(f,0,0,0),s&&(f.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}eh.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},eh.prototype.splitTile=function(a,i,s,f,p,y,x){for(var O=[a,i,s,f],A=this.options,I=A.debug;O.length;){f=O.pop(),s=O.pop(),i=O.pop(),a=O.pop();var B=1<<i,j=_l(i,s,f),V=this.tiles[j];if(!V&&(I>1&&console.time("creation"),V=this.tiles[j]=BE(a,i,s,f,A),this.tileCoords.push({z:i,x:s,y:f}),I)){I>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",i,s,f,V.numFeatures,V.numPoints,V.numSimplified),console.timeEnd("creation"));var mt="z"+i;this.stats[mt]=(this.stats[mt]||0)+1,this.total++}if(V.source=a,p){if(i===A.maxZoom||i===p)continue;var Bt=1<<p-i;if(s!==Math.floor(y/Bt)||f!==Math.floor(x/Bt))continue}else if(i===A.indexMaxZoom||V.numPoints<=A.indexMaxPoints)continue;if(V.source=null,a.length!==0){I>1&&console.time("clipping");var Kt=.5*A.buffer/A.extent,ue=.5-Kt,Le=.5+Kt,ke=1+Kt,He,Ye,rn,bn,hn,Cn;He=Ye=rn=bn=null,hn=as(a,B,s-Kt,s+Le,0,V.minX,V.maxX,A),Cn=as(a,B,s+ue,s+ke,0,V.minX,V.maxX,A),a=null,hn&&(He=as(hn,B,f-Kt,f+Le,1,V.minY,V.maxY,A),Ye=as(hn,B,f+ue,f+ke,1,V.minY,V.maxY,A),hn=null),Cn&&(rn=as(Cn,B,f-Kt,f+Le,1,V.minY,V.maxY,A),bn=as(Cn,B,f+ue,f+ke,1,V.minY,V.maxY,A),Cn=null),I>1&&console.timeEnd("clipping"),O.push(He||[],i+1,s*2,f*2),O.push(Ye||[],i+1,s*2,f*2+1),O.push(rn||[],i+1,s*2+1,f*2),O.push(bn||[],i+1,s*2+1,f*2+1)}}},eh.prototype.getTile=function(a,i,s){var f=this.options,p=f.extent,y=f.debug;if(a<0||a>24)return null;var x=1<<a;i=(i%x+x)%x;var O=_l(a,i,s);if(this.tiles[O])return FE(this.tiles[O],p);y>1&&console.log("drilling down to z%d-%d-%d",a,i,s);for(var A=a,I=i,B=s,j;!j&&A>0;)A--,I=Math.floor(I/2),B=Math.floor(B/2),j=this.tiles[_l(A,I,B)];return!j||!j.source?null:(y>1&&console.log("found parent tile z%d-%d-%d",A,I,B),y>1&&console.time("drilling down"),this.splitTile(j.source,A,I,B,a,i,s),y>1&&console.timeEnd("drilling down"),this.tiles[O]?FE(this.tiles[O],p):null)};function _l(a,i,s){return((1<<a)*s+i)*32+a}function UE(a,i){for(var s in i)a[s]=i[s];return a}var Yu=class{constructor(a,i,s,f){this.vectorLayerCache={},this.x=i,this.y=s,this.z=f,this.vectorTile=a}getTileData(a){return!a||!this.vectorTile.layers[a]?[]:this.vectorLayerCache[a]?this.vectorLayerCache[a]:this.vectorTile.layers[a].features}getFeatureById(){throw new Error("Method not implemented.")}},ZE=Object.defineProperty,HE=Object.defineProperties,sg=Object.getOwnPropertyDescriptors,nh=Object.getOwnPropertySymbols,WE=Object.prototype.hasOwnProperty,rh=Object.prototype.propertyIsEnumerable,m_=(a,i,s)=>i in a?ZE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Xu=(a,i)=>{for(var s in i||(i={}))WE.call(i,s)&&m_(a,s,i[s]);if(nh)for(var s of nh(i))rh.call(i,s)&&m_(a,s,i[s]);return a},y_=(a,i)=>HE(a,sg(i)),__=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),b_={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function x_(a){let i=0;for(let s=0,f=a.length,p=f-1,y,x;s<f;p=s++)y=a[s],x=a[p],i+=(x.x-y.x)*(y.y+x.y);return i}function VE(a){const i=a.length;if(i<=1)return[a];const s=[];let f,p;for(let y=0;y<i;y++){const x=x_(a[y]);x!==0&&(p===void 0&&(p=x<0),p===x<0?(f&&s.push(f),f=[a[y]]):f.push(a[y]))}return f&&s.push(f),s}var ih=["Unknown","Point","LineString","Polygon"];function ss(a,i,s,f,p){let y=p.geometry;const x=p.type,O=p.tags,A=p.id,I=a*Math.pow(2,f),B=a*i,j=a*s;let V=ih[x],mt,Bt;function Kt(Le){for(let ke=0;ke<Le.length;ke++){const He=Le[ke];if(He[3])break;const Ye=180-(He[1]+j)*360/I,rn=(He[0]+B)*360/I-180,bn=360/Math.PI*Math.atan(Math.exp(Ye*Math.PI/180))-90;Le[ke]=[rn,bn,0,1]}}switch(x){case 1:const Le=[];for(mt=0;mt<y.length;mt++)Le[mt]=y[mt][0];y=Le,Kt(y);break;case 2:for(mt=0;mt<y.length;mt++)Kt(y[mt]);break;case 3:for(y=VE(y),mt=0;mt<y.length;mt++)for(Bt=0;Bt<y[mt].length;Bt++)Kt(y[mt][Bt]);break}return y.length===1?y=y[0]:V="Multi"+V,{type:"Feature",geometry:{type:V,coordinates:y},properties:O,id:A,relativeOrigin:[0,0],coord:""}}var GE=(a,i,s,f)=>__(void 0,null,function*(){return new Promise(p=>{const y=i.getTile(a.z,a.x,a.y),O={layers:{defaultLayer:{features:y?y.features.map(I=>ss(f,s.x,s.y,s.z,I)):[]}}},A=new Yu(O,a.x,a.y,a.z);p(A)})});function $E(a){const i={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return a===void 0||typeof a.geojsonvtOptions=="undefined"?i:Xu(Xu({},i),a.geojsonvtOptions)}function Pa(a,i){const s=$E(i),f=s.extent||4096,p=Ls(a,s),y=(O,A)=>GE(A,p,O,f),x=y_(Xu(Xu({},b_),i),{getTileData:y});return{data:a,dataArray:[],tilesetOptions:x,isTile:!0}}var _c=Object.defineProperty,U7=Object.defineProperties,YE=Object.getOwnPropertyDescriptors,cg=Object.getOwnPropertySymbols,Z7=Object.prototype.hasOwnProperty,XE=Object.prototype.propertyIsEnumerable,lg=(a,i,s)=>i in a?_c(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,ug=(a,i)=>{for(var s in i||(i={}))Z7.call(i,s)&&lg(a,s,i[s]);if(cg)for(var s of cg(i))XE.call(i,s)&&lg(a,s,i[s]);return a},S_=(a,i)=>U7(a,YE(i));function w_(a,i){const{extent:s=[121.168,30.2828,121.384,30.4219],coordinates:f,requestParameters:p={}}=i,y=new Promise(A=>{a instanceof HTMLImageElement||ji(a)?A([a]):bc(a,p,I=>{A(I)})}),x=gl(f,s);return{originData:a,images:y,_id:1,dataArray:[{_id:0,coordinates:x}]}}function bc(a,i,s){const f=[];if(typeof a=="string")_t(S_(ug({},i),{url:a}),(p,y)=>{y&&(f.push(y),s(f))});else{const p=a.length;let y=0;a.forEach(x=>{_t(S_(ug({},i),{url:x}),(O,A)=>{y++,A&&f.push(A),y===p&&s(f)})})}return w_}var fg=Object.defineProperty,dg=Object.defineProperties,Qo=Object.getOwnPropertyDescriptors,Rr=Object.getOwnPropertySymbols,H7=Object.prototype.hasOwnProperty,W7=Object.prototype.propertyIsEnumerable,O_=(a,i,s)=>i in a?fg(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,hg=(a,i)=>{for(var s in i||(i={}))H7.call(i,s)&&O_(a,s,i[s]);if(Rr)for(var s of Rr(i))W7.call(i,s)&&O_(a,s,i[s]);return a},bl=(a,i)=>dg(a,Qo(i)),E_=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),pg=(a,i,s,f)=>E_(void 0,null,function*(){const p={x:i.x,y:i.y,z:i.z},y=Ma(a,p);return new Promise(x=>{f?f(p,(O,A)=>{if(O||!A){const I={layers:{defaultLayer:{features:[]}}},B=new Yu(I,i.x,i.y,i.z);x(B)}else{const I={layers:{defaultLayer:{features:A.features}}},B=new Yu(I,i.x,i.y,i.z);x(B)}}):So(bl(hg({},s),{url:y}),(O,A)=>{if(O||!A){const I={layers:{defaultLayer:{features:[]}}},B=new Yu(I,i.x,i.y,i.z);x(B)}else{const B={layers:{defaultLayer:{features:JSON.parse(A)}}},j=new Yu(B,i.x,i.y,i.z);x(j)}})})});function oh(a,i){const s=(p,y)=>pg(a,y,i==null?void 0:i.requestParameters,i.getCustomData),f=bl(hg({},i),{getTileData:s});return{dataArray:[],tilesetOptions:f,isTile:!0}}var ah=L(38929),cs=L(3614),xc=L.n(cs),qE=Object.defineProperty,gg=Object.defineProperties,A_=Object.getOwnPropertyDescriptors,Yr=Object.getOwnPropertySymbols,kr=Object.prototype.hasOwnProperty,qu=Object.prototype.propertyIsEnumerable,vg=(a,i,s)=>i in a?qE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,xl=(a,i)=>{for(var s in i||(i={}))kr.call(i,s)&&vg(a,s,i[s]);if(Yr)for(var s of Yr(i))qu.call(i,s)&&vg(a,s,i[s]);return a},T_=(a,i)=>gg(a,A_(i)),M_=class{constructor(a,i,s,f){this.vectorLayerCache={},this.x=i,this.y=s,this.z=f,this.vectorTile=new ah.VectorTile(new(xc())(a))}getTileData(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];const i=this.vectorTile.layers[a];if(Array.isArray(i.features))return this.vectorLayerCache[a]=i.features,i.features;const s=[];for(let f=0;f<i.length;f++){const y=i.feature(f).toGeoJSON(this.x,this.y,this.z);s.push(T_(xl({},y),{properties:xl({id:y.id},y.properties)}))}return this.vectorLayerCache[a]=s,s}getFeatureById(){throw new Error("Method not implemented.")}},Sl=Object.defineProperty,C_=Object.defineProperties,V7=Object.getOwnPropertyDescriptors,P_=Object.getOwnPropertySymbols,sh=Object.prototype.hasOwnProperty,mg=Object.prototype.propertyIsEnumerable,L_=(a,i,s)=>i in a?Sl(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Q=(a,i)=>{for(var s in i||(i={}))sh.call(i,s)&&L_(a,s,i[s]);if(P_)for(var s of P_(i))mg.call(i,s)&&L_(a,s,i[s]);return a},yg=(a,i)=>C_(a,V7(i)),Ku=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),Is={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},ch=(a,i,s,f,p)=>Ku(void 0,null,function*(){const y=Ma(a,i);return new Promise(x=>{if(p)p({x:s.x,y:s.y,z:s.z},(O,A)=>{if(O||!A)x(void 0);else{const I=new M_(A,s.x,s.y,s.z);x(I)}});else{const O=io(yg(Q({},f),{url:y}),(A,I)=>{if(A||!I)x(void 0);else{const B=new M_(I,s.x,s.y,s.z);x(B)}});s.xhrCancel=()=>O.cancel()}})});function KE(a,i){const s=Array.isArray(a)?a[0]:a,f=(y,x)=>ch(s,y,x,i==null?void 0:i.requestParameters,i==null?void 0:i.getCustomData),p=yg(Q(Q({},Is),i),{getTileData:f});return{data:s,dataArray:[],tilesetOptions:p,isTile:!0}}function I_(a,i,s){switch(a){case"+":return i+s;case"-":return i-s;case"*":return i*s;case"/":return i/s;case"%":return i%s;case"^":return Math.pow(i,s);case"abs":return Math.abs(i);case"floor":return Math.floor(i);case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"sin":return Math.sin(i);case"cos":return Math.cos(i);case"atan":return s===-1?Math.atan(i):Math.atan2(i,s);case"min":return Math.min(i,s);case"max":return Math.max(i,s);case"log10":return Math.log(i);case"log2":return Math.log2(i);default:return console.warn("Calculate symbol err! Return default 0"),0}}function La(a,i){const{width:s,height:f}=i[0],p=i.map(A=>A.rasterData),y=s*f,x=[],O=JSON.stringify(a);for(let A=0;A<y;A++){const I=JSON.parse(O),B=R_(I,p,A);if(typeof B=="number")x.push(B);else{const j=lh(I);x.push(j)}}return x}function R_(a,i,s){if(a.length===2&&a[0]==="band"&&typeof a[1]=="number")try{return i[a[1]][s]}catch(f){return console.warn("Raster Data err!"),0}a.map((f,p)=>{if(Array.isArray(f)&&f.length>0)switch(f[0]){case"band":try{a[p]=i[f[1]][s]}catch(y){console.warn("Raster Data err!"),a[p]=0}break;default:R_(f,i,s)}})}function k_(a){const[i,s=-1,f=-1]=a;return i===void 0?(console.warn("Express err!"),["+",0,0]):[i.replace(/\s+/g,""),s,f]}function lh(a){const i=k_(a),s=i[0];let f=i[1],p=i[2];return Array.isArray(f)&&(f=lh(a[1])),Array.isArray(p)&&(p=lh(a[2])),I_(s,f,p)}var QE={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:JE}};function JE(a,i){const s=a[0].rasterData,f=a[1].rasterData,p=a[2].rasterData,y=[],[x,O]=(i==null?void 0:i.countCut)||[2,98],A=(i==null?void 0:i.RMinMax)||_o(s,x,O),I=(i==null?void 0:i.GMinMax)||_o(f,x,O),B=(i==null?void 0:i.BMinMax)||_o(p,x,O);for(let j=0;j<s.length;j++)y.push(Math.max(0,s[j]-A[0])),y.push(Math.max(0,f[j]-I[0])),y.push(Math.max(0,p[j]-B[0]));return{rasterData:y,rMinMax:A,gMinMax:I,bMinMax:B}}function _o(a,i,s){const f=a.slice().sort((O,A)=>O-A),p=f.length,y=f[Math.ceil(p*i/100)],x=f[Math.ceil(p*s/100)];return[y,x]}var tA=Object.defineProperty,D_=Object.defineProperties,ha=Object.getOwnPropertyDescriptors,N_=Object.getOwnPropertySymbols,F_=Object.prototype.hasOwnProperty,eA=Object.prototype.propertyIsEnumerable,B_=(a,i,s)=>i in a?tA(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Gi=(a,i)=>{for(var s in i||(i={}))F_.call(i,s)&&B_(a,s,i[s]);if(N_)for(var s of N_(i))eA.call(i,s)&&B_(a,s,i[s]);return a},Oo=(a,i)=>D_(a,ha(i)),j_=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())});function _g(a,i,s){return j_(this,null,function*(){if(a.length===0)return{rasterData:[0],width:1,heigh:1};const f=yield Promise.all(a.map(({data:A,bands:I=[0]})=>i(A,I))),p=[];f.forEach(A=>{Array.isArray(A)?p.push(...A):p.push(A)});const{width:y,height:x}=p[0];let O;switch(typeof s){case"function":O=s(p);break;case"object":Array.isArray(s)?O={rasterData:La(s,p)}:O=nA(s,p);break;default:O={rasterData:p[0].rasterData}}return Oo(Gi({},O),{width:y,height:x})})}function nA(a,i){const s=QE[a.type];if(s.type==="function")return s.method(i,a==null?void 0:a.options);if(s.type==="operation")return a.type==="rgb"?bg(s.expression,i):{rasterData:La(s.expression,i)}}function bg(a,i){a.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),a.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),a.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const s=La(a.r||["band",0],i),f=La(a.g||["band",0],i),p=La(a.b||["band",0],i);return[s,f,p]}function xg(a,i,s,f){return j_(this,null,function*(){const p=yield _g(a,i,s);f(null,{data:p})})}function rA(a,i){const{extent:s=[121.168,30.2828,121.384,30.4219],coordinates:f,width:p,height:y,min:x,max:O,format:A,operation:I}=i;let B,j,V;if(A===void 0||Cs(a))B=Array.from(a),j=p,V=y;else{const Kt=Array.isArray(a)?a:[a];B=_g(Kt,A,I)}const mt=gl(f,s);return{_id:1,dataArray:[{_id:1,data:B,width:j,height:V,min:x,max:O,coordinates:mt}]}}var on=L(1413),ot=L(4942);let Qu=function(a){return a.Normal="normal",a.PostProcessing="post-processing",a}({}),dt=function(a){return a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.CULL_FACE=2884]="CULL_FACE",a[a.BLEND=3042]="BLEND",a[a.DITHER=3024]="DITHER",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.RED=6403]="RED",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.TEXTURE1=33985]="TEXTURE1",a[a.TEXTURE2=33986]="TEXTURE2",a[a.TEXTURE3=33987]="TEXTURE3",a[a.TEXTURE4=33988]="TEXTURE4",a[a.TEXTURE5=33989]="TEXTURE5",a[a.TEXTURE6=33990]="TEXTURE6",a[a.TEXTURE7=33991]="TEXTURE7",a[a.TEXTURE8=33992]="TEXTURE8",a[a.TEXTURE9=33993]="TEXTURE9",a[a.TEXTURE10=33994]="TEXTURE10",a[a.TEXTURE11=33995]="TEXTURE11",a[a.TEXTURE12=33996]="TEXTURE12",a[a.TEXTURE13=33997]="TEXTURE13",a[a.TEXTURE14=33998]="TEXTURE14",a[a.TEXTURE15=33999]="TEXTURE15",a[a.TEXTURE16=34e3]="TEXTURE16",a[a.TEXTURE17=34001]="TEXTURE17",a[a.TEXTURE18=34002]="TEXTURE18",a[a.TEXTURE19=34003]="TEXTURE19",a[a.TEXTURE20=34004]="TEXTURE20",a[a.TEXTURE21=34005]="TEXTURE21",a[a.TEXTURE22=34006]="TEXTURE22",a[a.TEXTURE23=34007]="TEXTURE23",a[a.TEXTURE24=34008]="TEXTURE24",a[a.TEXTURE25=34009]="TEXTURE25",a[a.TEXTURE26=34010]="TEXTURE26",a[a.TEXTURE27=34011]="TEXTURE27",a[a.TEXTURE28=34012]="TEXTURE28",a[a.TEXTURE29=34013]="TEXTURE29",a[a.TEXTURE30=34014]="TEXTURE30",a[a.TEXTURE31=34015]="TEXTURE31",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a}({});const jr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`,{camelCase:Sg,isNil:G7,upperFirst:$7}=hi;class Qn{constructor(){(0,ot.Z)(this,"shaderModuleService",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"config",void 0),(0,ot.Z)(this,"quad",jr),(0,ot.Z)(this,"enabled",!0),(0,ot.Z)(this,"renderToScreen",!1),(0,ot.Z)(this,"model",void 0),(0,ot.Z)(this,"name",void 0),(0,ot.Z)(this,"optionsToUpdate",{})}getName(){return this.name}setName(i){this.name=i}getType(){return Qu.PostProcessing}init(i,s){this.config=s,this.rendererService=i.getContainer().rendererService,this.shaderModuleService=i.getContainer().shaderModuleService;const{createAttribute:f,createBuffer:p,createModel:y}=this.rendererService,{vs:x,fs:O,uniforms:A}=this.setupShaders();this.model=y({vs:x,fs:O,attributes:{a_Position:f({buffer:p({data:[-4,-4,4,-4,0,4],type:dt.FLOAT}),size:2})},uniforms:(0,on.Z)((0,on.Z)({u_Texture:null},A),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(i,s){const f=i.multiPassRenderer.getPostProcessor(),{useFramebuffer:p,getViewportSize:y,clear:x}=this.rendererService,{width:O,height:A}=y();p(this.renderToScreen?null:f.getWriteFBO(),()=>{x({framebuffer:f.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const I=(0,on.Z)({u_BloomFinal:0,u_Texture:f.getReadFBO(),u_ViewportSize:[O,A]},this.convertOptionsToUniforms(this.optionsToUpdate));s&&(I.u_BloomFinal=1,I.u_Texture2=s),this.model.draw({uniforms:I})})}isEnabled(){return this.enabled}setEnabled(i){this.enabled=i}setRenderToScreen(i){this.renderToScreen=i}updateOptions(i){this.optionsToUpdate=(0,on.Z)((0,on.Z)({},this.optionsToUpdate),i)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(i){const s={};return Object.keys(i).forEach(f=>{G7(i[f])||(s[`u_${$7(Sg(f))}`]=i[f])}),s}}function Eo(a){let i=0;switch(a){case"vec2":case"ivec2":i=2;break;case"vec3":case"ivec3":i=3;break;case"vec4":case"ivec4":case"mat2":i=4;break;case"mat3":i=9;break;case"mat4":i=16;break;default:}return i}const Ia=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function wl(a,i=!1){const s={};return a=a.replace(Ia,(f,p,y)=>{const x=y.split(":"),O=x[0].trim();let A="";switch(x.length>1&&(A=x[1].trim()),p){case"bool":A=A==="true";break;case"float":case"int":A=Number(A);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":A?A=A.replace("[","").replace("]","").split(",").reduce((I,B)=>(I.push(Number(B.trim())),I),[]):A=new Array(Eo(p)).fill(0);break;default:}return s[O]=A,`${i?"uniform ":""}${p} ${O};
`}),{content:a,uniforms:s}}function Ju(a){let{content:i,uniforms:s}=wl(a,!0);return i=i.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(f,p,y)=>{y=y.trim().replace(/^.*$/gm,A=>`uniform ${A}`);const{content:x,uniforms:O}=wl(y);return Object.assign(s,O),`${p}{
${x}
};`}),{content:i,uniforms:s}}function Rs(a){const i={};return a.replace(Ia,(s,f,p)=>{const y=p.trim();return i[y]?"":(i[y]=!0,`uniform ${f} ${y};
`)})}const Sc=null;function uh(a){return Sc.indexOf(a)}const{clamp:wg}=hi,Y7=2,X7=4,Ol=64,iA=128,Og=256,oA=512,q7=8192,aA=16384,K7=32768,fh=null,or=131072,ls=262144,us=524288,Fo=1048576,dh=2097152,Q7=4194304,sA=8388608,z_=16777216,El=null;function tf(a,i){return a=wg(Math.floor(a),0,255),i=wg(Math.floor(i),0,255),256*a+i}function J7(a){const{color:i,radius:s,tileX:f,tileY:p,shape:y,opacity:x,stroke:O,strokeWidth:A,strokeOpacity:I}=a,B=[],j=[],V=[],mt=[tf(i[0],i[1]),tf(i[2],i[3])],Bt=[tf(O[0],O[1]),tf(O[2],O[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([Kt,ue])=>{B.push([...mt,(Kt+1)*sA+(ue+1)*dh+getShapeIndex(y)*or+s,(f+512)*us+(p+512)*Ol]),j.push([...Bt,A,I]),V.push([x,0,0,0])}),{packedBuffer:B,packedBuffer2:j,packedBuffer3:V}}function U_(a,i){if(a===0&&!i)return 0;if(a===1&&i)return 4294967295;const s=i?1:0,f=Math.floor(a*127);return f*El+s*z_+f*or+s*fh+f*oA+s*Og+f*Y7+s}const wc={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let hh=function(a){return a.TOPRIGHT="topright",a.TOPLEFT="topleft",a.BOTTOMRIGHT="bottomright",a.BOTTOMLEFT="bottomleft",a.TOPCENTER="topcenter",a.BOTTOMCENTER="bottomcenter",a.LEFTCENTER="leftcenter",a.RIGHTCENTER="rightcenter",a.LEFTTOP="lefttop",a.RIGHTTOP="righttop",a.LEFTBOTTOM="leftbottom",a.RIGHTBOTTOM="rightbottom",a}({}),ph=function(a){return a[a.LNGLAT=1]="LNGLAT",a[a.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",a[a.VECTOR_TILE=3]="VECTOR_TILE",a[a.IDENTITY=4]="IDENTITY",a[a.METER_OFFSET=5]="METER_OFFSET",a}({});const Al={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",RelativeOrigin:"u_RelativeOrigin"};var $i={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let Co=function(a){return a.Hover="hover",a.Click="click",a.Select="select",a.Active="active",a.Drag="drag",a}({}),ks=function(a){return a.normal="normal",a.additive="additive",a.subtractive="subtractive",a.min="min",a.max="max",a.none="none",a}({}),Oc=function(a){return a.MULTIPLE="MULTIPLE",a.SINGLE="SINGLE",a}({}),Tl=function(a){return a.AND="and",a.OR="or",a}({}),oo=function(a){return a.INIT="init",a.UPDATE="update",a}({}),_r=function(a){return a.LINEAR="linear",a.SEQUENTIAL="sequential",a.POWER="power",a.LOG="log",a.IDENTITY="identity",a.TIME="time",a.QUANTILE="quantile",a.QUANTIZE="quantize",a.THRESHOLD="threshold",a.CAT="cat",a.DIVERGING="diverging",a.CUSTOM="threshold",a}({}),Ml=function(a){return a.CONSTANT="constant",a.VARIABLE="variable",a}({}),Nn=function(a){return a[a.Attribute=0]="Attribute",a[a.InstancedAttribute=1]="InstancedAttribute",a[a.Uniform=2]="Uniform",a}({});const Eg=["mapload","mapchange","mapAfterFrameChange"];var Z_=L(49296),tI=L.n(Z_);const Ec=30;function H_({characterSet:a,getFontWidth:i,fontHeight:s,buffer:f,maxCanvasWidth:p,mapping:y={},xOffset:x=0,yOffset:O=0}){let A=0,I=x;Array.from(a).forEach((j,V)=>{if(!y[j]){const mt=i(j,V);I+Ec>p&&(I=0,A++),y[j]={x:I,y:O+A*Ec,width:Ec,height:Ec,advance:mt},I+=Ec}});const B=s+f*2;return{mapping:y,xOffset:I,yOffset:O+A*B,canvasHeight:Ac(O+(A+1)*B)}}function gh(a,i,s){let f=0,p=0,y=0,x=[];const O={};for(const I of a)if(!O[I.id]){const{size:B}=I;f+B+i>s&&(vh(O,x,p),f=0,p=y+p+i,y=0,x=[]),x.push({icon:I,xOffset:f}),f=f+B+i,y=Math.max(y,B)}x.length>0&&vh(O,x,p);const A=Ac(y+p+i);return{mapping:O,canvasHeight:A}}function vh(a,i,s){for(const f of i){const{icon:p,xOffset:y}=f;a[p.id]=(0,on.Z)((0,on.Z)({},p),{},{x:y,y:s,image:p.image,width:p.width,height:p.height})}}function Ac(a){return Math.pow(2,Math.ceil(Math.log2(a)))}const ef=fA(),eI="sans-serif",Bo="normal",cA=24,lA=3,mh=.25,Ag=8,Tg=1024,W_=1,Mg=1,uA=3,nI=null;function fA(){const a=[];for(let i=32;i<128;i++)a.push(String.fromCharCode(i));return a}function V_(a,i,s,f){a.font=`${f} ${s}px ${i}`,a.fillStyle="black",a.textBaseline="middle"}function Cg(a,i){for(let s=0;s<a.length;s++)i.data[4*s+3]=a[s]}class dA extends No.EventEmitter{constructor(...i){super(...i),(0,ot.Z)(this,"fontAtlas",void 0),(0,ot.Z)(this,"iconFontMap",void 0),(0,ot.Z)(this,"iconFontGlyphs",{}),(0,ot.Z)(this,"fontOptions",void 0),(0,ot.Z)(this,"key",void 0),(0,ot.Z)(this,"cache",new G1(uA))}get scale(){return Mg}get canvas(){const i=this.cache.get(this.key);return i&&i.data}get mapping(){const i=this.cache.get(this.key);return i&&i.mapping||{}}getCanvasByKey(i){const s=this.cache.get(i);return s&&s.data}getMappingByKey(i){const s=this.cache.get(i);return s&&s.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:eI,fontWeight:Bo,characterSet:ef,fontSize:cA,buffer:lA,sdf:!0,cutoff:mh,radius:Ag,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(i){i.forEach(s=>{this.iconFontGlyphs[s.name]=s.unicode})}addIconFont(i,s){this.iconFontMap.set(i,s)}getIconFontKey(i){return this.iconFontMap.get(i)||i}getGlyph(i){return this.iconFontGlyphs[i]?String.fromCharCode(parseInt(this.iconFontGlyphs[i],16)):""}setFontOptions(i){this.fontOptions=(0,on.Z)((0,on.Z)({},this.fontOptions),i),this.key=this.getKey();const s=this.getNewChars(this.key,this.fontOptions.characterSet),f=this.cache.get(this.key);if(f&&s.length===0)return;const p=this.generateFontAtlas(this.key,s,f);this.fontAtlas=p,this.cache.set(this.key,p)}addFontFace(i,s){const f=document.createElement("style");f.type="text/css",f.innerText=`
        @font-face{
            font-family: '${i}';
            src: url('${s}') format('woff2'),
            url('${s}') format('woff'),
            url('${s}') format('truetype');
        }`,f.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${i}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:i})})}catch(p){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(p)}},document.getElementsByTagName("head")[0].appendChild(f)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(i,s,f){const{fontFamily:p,fontWeight:y,fontSize:x,buffer:O,sdf:A,radius:I,cutoff:B,iconfont:j}=this.fontOptions;let V=f&&f.data;V||(V=window.document.createElement("canvas"),V.width=Tg);const mt=V.getContext("2d",{willReadFrequently:!0});V_(mt,p,x,y);const{mapping:Bt,canvasHeight:Kt,xOffset:ue,yOffset:Le}=H_((0,on.Z)({getFontWidth:He=>mt.measureText(He).width,fontHeight:x*Mg,buffer:O,characterSet:s,maxCanvasWidth:Tg},f&&{mapping:f.mapping,xOffset:f.xOffset,yOffset:f.yOffset})),ke=mt.getImageData(0,0,V.width,V.height);if(V.height=Kt,mt.putImageData(ke,0,0),V_(mt,p,x,y),A){const He=new(tI())(x,O,I,B,p,y),Ye=mt.getImageData(0,0,He.size,He.size);for(const rn of s){if(j){const bn=String.fromCharCode(parseInt(rn.replace("&#x","").replace(";",""),16)),hn=He.draw(bn);Cg(hn,Ye)}else Cg(He.draw(rn),Ye);mt.putImageData(Ye,Bt[rn].x,Bt[rn].y)}}else for(const He of s)mt.fillText(He,Bt[He].x,Bt[He].y+x*W_);return{xOffset:ue,yOffset:Le,mapping:Bt,data:V,width:V.width,height:V.height}}getKey(){const{fontFamily:i,fontWeight:s}=this.fontOptions;return`${i}_${s}`}getNewChars(i,s){const f=this.cache.get(i);if(!f)return s;const p=[],y=f.mapping,x=new Set(Object.keys(y));return new Set(s).forEach(A=>{x.has(A)||p.push(A)}),p}}var ln=L(15861);const hA=3,G_=1024,Cl=64;class pA extends No.EventEmitter{constructor(...i){super(...i),(0,ot.Z)(this,"canvasHeight",128),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"canvas",void 0),(0,ot.Z)(this,"iconData",void 0),(0,ot.Z)(this,"iconMap",void 0),(0,ot.Z)(this,"ctx",void 0),(0,ot.Z)(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(i,s){var f=this;return(0,ln.Z)(function*(){let p=new Image;f.loadingImageCount++,f.hasImage(i)?console.warn("Image Id already exists"):f.iconData.push({id:i,size:Cl}),f.updateIconMap(),p=yield f.loadImage(s);const y=f.iconData.find(x=>x.id===i);y&&(y.image=p,y.width=p.width,y.height=p.height),f.update()})()}addImageMini(i,s,f){const p=f.getSceneConfig().canvas;let y=p.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Cl}),this.updateIconMap(),this.loadImageMini(s,p).then(x=>{y=x;const O=this.iconData.find(A=>A.id===i);O&&(O.image=y,O.width=y.width,O.height=y.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(i){return this.iconMap.hasOwnProperty(i)}removeImage(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(s=>s.id!==i),delete this.iconMap[i],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(i){return new Promise((s,f)=>{if(i instanceof HTMLImageElement){s(i);return}const p=new Image;p.crossOrigin="anonymous",p.onload=()=>{s(p)},p.onerror=()=>{f(new Error("Could not load image at "+i))},p.src=i instanceof File?URL.createObjectURL(i):i})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=G_,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(i=>{const{x:s,y:f,image:p,width:y=64,height:x=64}=this.iconMap[i],A=Math.max(y,x)/Cl,I=x/A,B=y/A;p&&this.ctx.drawImage(p,s+(Cl-B)/2,f+(Cl-I)/2,B,I)})}updateIconMap(){const{mapping:i,canvasHeight:s}=gh(this.iconData,hA,G_);this.iconMap=i,this.canvasHeight=s}loadImageMini(i,s){return new Promise((f,p)=>{const y=s.createImage();y.crossOrigin="anonymous",y.onload=()=>{f(y)},y.onerror=()=>{p(new Error("Could not load image at "+i))},y.src=i})}}var Zr=L(85975);class gA{constructor(){(0,ot.Z)(this,"viewport",void 0),(0,ot.Z)(this,"overridedViewProjectionMatrix",void 0),(0,ot.Z)(this,"viewMatrixInverse",void 0),(0,ot.Z)(this,"cameraPosition",void 0)}init(){}update(i){this.viewport=i,this.viewMatrixInverse=Zr.create(),Zr.invert(this.viewMatrixInverse,i.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[i,s]=this.viewport.getCenter();return[i,s]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(i,s){return this.viewport.projectFlat(i,s)}setViewProjectionMatrix(i){this.overridedViewProjectionMatrix=i}}const ao={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class vA{constructor(){(0,ot.Z)(this,"container",void 0),(0,ot.Z)(this,"controlCorners",void 0),(0,ot.Z)(this,"controlContainer",void 0),(0,ot.Z)(this,"scene",void 0),(0,ot.Z)(this,"mapsService",void 0),(0,ot.Z)(this,"controls",[]),(0,ot.Z)(this,"unAddControls",[])}init(i,s){this.container=i.container,this.scene=s,this.mapsService=s.mapService,this.initControlPos()}addControl(i,s){s.mapService.map?(i.addTo(this.scene),this.controls.push(i)):this.unAddControls.push(i)}getControlByName(i){return this.controls.find(s=>s.controlOption.name===i)}removeControl(i){const s=this.controls.indexOf(i);return s>-1&&this.controls.splice(s,1),i.remove(),this}addControls(){this.unAddControls.forEach(i=>{i.addTo(this.scene),this.controls.push(i)}),this.unAddControls=[]}destroy(){for(const i of this.controls)i.remove();this.controls=[],this.clearControlPos()}initControlPos(){const i=this.controlCorners={},s="l7-",f=this.controlContainer=Vi("div",s+"control-container",this.container);function p(x=[]){const O=x.map(A=>s+A).join(" ");i[x.filter(A=>!["row","column"].includes(A)).join("")]=Vi("div",O,f)}function y(x){return[...x.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),ao[x]]}Object.values(hh).forEach(x=>{p(y(x))}),this.checkCornerOverlap()}clearControlPos(){for(const i in this.controlCorners)this.controlCorners[i]&&Oa(this.controlCorners[i]);this.controlContainer&&Oa(this.controlContainer)}checkCornerOverlap(){const i=window.MutationObserver;if(i)for(const s of Object.keys(this.controlCorners)){const f=s.match(/^(top|bottom)(left|right)$/);if(f){const[,p,y]=f,x=this.controlCorners[`${p}${y}`];new i(([{target:A}])=>{x&&(x.style[p]=A.clientHeight+"px")}).observe(this.controlCorners[`${y}${p}`],{childList:!0,attributes:!0})}}}}class mA{constructor(){(0,ot.Z)(this,"container",void 0),(0,ot.Z)(this,"scene",void 0),(0,ot.Z)(this,"mapsService",void 0),(0,ot.Z)(this,"markers",[]),(0,ot.Z)(this,"markerLayers",[]),(0,ot.Z)(this,"unAddMarkers",[]),(0,ot.Z)(this,"unAddMarkerLayers",[])}addMarkerLayer(i){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(i),i.addTo(this.scene)):this.unAddMarkerLayers.push(i)}removeMarkerLayer(i){i.destroy(),this.markerLayers.indexOf(i);const s=this.markerLayers.indexOf(i);s>-1&&this.markerLayers.splice(s,1)}addMarker(i){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(i),i.addTo(this.scene)):this.unAddMarkers.push(i)}addMarkers(){this.unAddMarkers.forEach(i=>{i.addTo(this.scene),this.markers.push(i)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(i=>{this.markerLayers.push(i),i.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(i){i.remove(),this.markers.indexOf(i);const s=this.markers.indexOf(i);s>-1&&this.markers.splice(s,1)}removeAllMarkers(){this.destroy()}init(i){this.scene=i,this.mapsService=i.mapService}destroy(){this.markers.forEach(i=>{i.remove()}),this.markers=[],this.markerLayers.forEach(i=>{i.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(i){i.destroy()}}class Pg{constructor(){(0,ot.Z)(this,"scene",void 0),(0,ot.Z)(this,"mapsService",void 0),(0,ot.Z)(this,"popups",[]),(0,ot.Z)(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(i){i!=null&&i.isOpen()&&i.remove();const s=this.popups.indexOf(i);s>-1&&this.popups.splice(s,1);const f=this.unAddPopups.indexOf(i);f>-1&&this.unAddPopups.splice(f,1)}destroy(){this.popups.forEach(i=>i.remove())}addPopup(i){i&&i.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(s=>{s.getOptions().autoClose&&this.removePopup(s)}),this.isMarkerReady?(i.addTo(this.scene),this.popups.push(i)):this.unAddPopups.push(i),i.on("close",()=>{this.removePopup(i)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(i=>{this.addPopup(i),this.unAddPopups=[]})}init(i){this.scene=i,this.mapsService=i.mapService}}var yh={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:Lg}=hi,iI={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},$_={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Tl.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class Y_{constructor(){(0,ot.Z)(this,"sceneConfigCache",{}),(0,ot.Z)(this,"layerConfigCache",{}),(0,ot.Z)(this,"layerAttributeConfigCache",{})}getSceneConfig(i){return this.sceneConfigCache[i]}getSceneWarninfo(i){return yh[i]}setSceneConfig(i,s){this.sceneConfigCache[i]=(0,on.Z)((0,on.Z)({},iI),s)}getLayerConfig(i){return this.layerConfigCache[i]}setLayerConfig(i,s,f){this.layerConfigCache[s]=(0,on.Z)({},Lg({},this.sceneConfigCache[i],$_,f))}getAttributeConfig(i){return this.layerAttributeConfigCache[i]}setAttributeConfig(i,s){this.layerAttributeConfigCache[i]=(0,on.Z)((0,on.Z)({},this.layerAttributeConfigCache[i]),s)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var Tc=L(98333);const _h=Math.PI/180,Ig=512,X_=4003e4;function q_({latitude:a=0,zoom:i=0,scale:s,highPrecision:f=!1,flipY:p=!1}){s=s!==void 0?s:Math.pow(2,i);const y={},x=Ig*s,O=Math.cos(a*_h),A=x/360,I=A/O,B=x/X_/O;if(y.pixelsPerMeter=[B,-B,B],y.metersPerPixel=[1/B,-1/B,1/B],y.pixelsPerDegree=[A,-I,B],y.degreesPerPixel=[1/A,-1/I,1/B],f){const j=_h*Math.tan(a*_h)/O,V=A*j/2,mt=x/X_*j,Bt=mt/I*B;y.pixelsPerDegree2=[0,-V,mt],y.pixelsPerMeter2=[Bt,0,Bt],p&&(y.pixelsPerDegree2[1]=-y.pixelsPerDegree2[1],y.pixelsPerMeter2[1]=-y.pixelsPerMeter2[1])}return p&&(y.pixelsPerMeter[1]=-y.pixelsPerMeter[1],y.metersPerPixel[1]=-y.metersPerPixel[1],y.pixelsPerDegree[1]=-y.pixelsPerDegree[1],y.degreesPerPixel[1]=-y.degreesPerPixel[1]),y}const K_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class so{constructor(i){(0,ot.Z)(this,"needRefresh",!0),(0,ot.Z)(this,"coordinateSystem",void 0),(0,ot.Z)(this,"viewportCenter",void 0),(0,ot.Z)(this,"viewportCenterProjection",void 0),(0,ot.Z)(this,"pixelsPerDegree",void 0),(0,ot.Z)(this,"pixelsPerDegree2",void 0),(0,ot.Z)(this,"pixelsPerMeter",void 0),this.cameraService=i}refresh(i){const s=this.cameraService.getZoom(),f=i||this.cameraService.getCenter(),{pixelsPerMeter:p,pixelsPerDegree:y}=q_({latitude:f[1],zoom:s});this.viewportCenter=f,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=p,this.pixelsPerDegree=y,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===ph.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===ph.LNGLAT_OFFSET&&this.calculateLnglatOffset(f,s),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(i){this.coordinateSystem=i}getViewportCenter(){return this.viewportCenter}setViewportCenter(i){this.refresh(i)}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(i,s,f,p){const{pixelsPerMeter:y,pixelsPerDegree:x,pixelsPerDegree2:O}=q_({latitude:i[1],zoom:s,scale:f,flipY:p,highPrecision:!0});let A=this.cameraService.getViewMatrix();const I=this.cameraService.getProjectionMatrix();let B=Zr.multiply([],I,A);const j=this.cameraService.projectFlat([Math.fround(i[0]),Math.fround(i[1])],Math.pow(2,s));this.viewportCenterProjection=Tc.fF([],[j[0],j[1],0,1],B),A=this.cameraService.getViewMatrixUncentered()||A,B=Zr.multiply([],I,A),B=Zr.multiply([],B,K_),this.cameraService.setViewProjectionMatrix(B),this.pixelsPerMeter=y,this.pixelsPerDegree=x,this.pixelsPerDegree2=O}}class Rg extends No.EventEmitter{constructor(...i){super(...i),(0,ot.Z)(this,"renderMap",new Map),(0,ot.Z)(this,"enable",!1),(0,ot.Z)(this,"renderEnable",!1),(0,ot.Z)(this,"cacheLogs",{})}setEnable(i){this.enable=!!i}log(i,s){if(!this.enable)return;const f=i.split(".");let p=null;f.forEach((y,x)=>{p!==null?(p[y]||(p[y]={}),x!==f.length-1&&(p=p[y])):(this.cacheLogs[y]||(this.cacheLogs[y]={}),x!==f.length-1&&(p=this.cacheLogs[y])),x===f.length-1&&(p[y]=(0,on.Z)((0,on.Z)({time:Date.now()},p[y]),s))})}getLog(i){switch(typeof i){case"string":return this.cacheLogs[i];case"object":return i.map(s=>this.cacheLogs[s]).filter(s=>s!==void 0);case"undefined":return this.cacheLogs}}removeLog(i){delete this.cacheLogs[i]}generateRenderUid(){return this.renderEnable?dE():""}renderDebug(i){this.renderEnable=i}renderStart(i){if(!this.renderEnable||!this.enable)return;const s=this.renderMap.get(i)||{};this.renderMap.set(i,(0,on.Z)((0,on.Z)({},s),{},{renderUid:i,renderStart:Date.now()}))}renderEnd(i){if(!this.renderEnable||!this.enable)return;const s=this.renderMap.get(i);if(s){const f=s.renderStart,p=Date.now();this.emit("renderEnd",(0,on.Z)((0,on.Z)({},s),{},{renderEnd:p,renderDuration:p-f})),this.renderMap.delete(i)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var bh=L(50840),fs=L.n(bh);const nf={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class yA extends jd(){get mapService(){return this.container.mapService}constructor(i){super(),(0,ot.Z)(this,"indragging",!1),(0,ot.Z)(this,"hammertime",void 0),(0,ot.Z)(this,"lastClickTime",0),(0,ot.Z)(this,"lastClickXY",[-1,-1]),(0,ot.Z)(this,"clickTimer",void 0),(0,ot.Z)(this,"$containter",void 0),(0,ot.Z)(this,"onDrag",s=>{const f=this.interactionEvent(s);f.type=nf[f.type],f.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(Co.Drag,f)}),(0,ot.Z)(this,"onHammer",s=>{s.srcEvent.stopPropagation();const f=this.interactionEvent(s);this.emit(Co.Hover,f)}),(0,ot.Z)(this,"onTouch",s=>{const f=s.touches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchstart"})}),(0,ot.Z)(this,"onTouchEnd",s=>{if(s.changedTouches.length>0){const f=s.changedTouches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchend"})}}),(0,ot.Z)(this,"onTouchMove",s=>{const f=s.changedTouches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchmove"})}),(0,ot.Z)(this,"onHover",s=>{const{clientX:f,clientY:p}=s;let y=f,x=p;const O=s.type,A=this.mapService.getMapContainer();if(A){const{top:B,left:j}=A.getBoundingClientRect();y=y-j-A.clientLeft,x=x-B-A.clientTop}const I=this.mapService.containerToLngLat([y,x]);if(O==="click"){this.isDoubleTap(y,x,I);return}if(O==="touch"){this.isDoubleTap(y,x,I);return}O!=="click"&&O!=="dblclick"&&this.emit(Co.Hover,{x:y,y:x,lngLat:I,type:O,target:s})}),this.container=i}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Co.Hover)}triggerHover({x:i,y:s}){this.emit(Co.Hover,{x:i,y:s})}triggerSelect(i){this.emit(Co.Select,{featureId:i})}triggerActive(i){this.emit(Co.Active,{featureId:i})}addEventListenerOnMap(){const i=this.mapService.getMapContainer();if(i){const s=new(fs()).Manager(i);s.add(new(fs()).Tap({event:"dblclick",taps:2})),s.add(new(fs()).Tap({event:"click"})),s.add(new(fs()).Pan({threshold:0,pointers:0})),s.add(new(fs()).Press({})),s.on("dblclick click",this.onHammer),s.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("touchstart",this.onTouch),i.addEventListener("touchend",this.onTouchEnd),i.addEventListener("mousemove",this.onHover),i.addEventListener("touchmove",this.onTouchMove),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=s}}removeEventListenerOnMap(){const i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("touchstart",this.onTouch),i.removeEventListener("touchend",this.onTouchEnd),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}interactionEvent(i){const{type:s,pointerType:f}=i;let p,y;f==="touch"?(y=Math.floor(i.pointers[0].clientY),p=Math.floor(i.pointers[0].clientX)):(y=Math.floor(i.srcEvent.y),p=Math.floor(i.srcEvent.x));const x=this.mapService.getMapContainer();if(x){const{top:A,left:I}=x.getBoundingClientRect();p-=I,y-=A}const O=this.mapService.containerToLngLat([p,y]);return{x:p,y,lngLat:O,type:s,target:i.srcEvent}}isDoubleTap(i,s,f){const p=new Date().getTime();let y="click";p-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-s)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),y="dblclick",this.emit(Co.Hover,{x:i,y:s,lngLat:f,type:y})):(this.lastClickTime=p,this.lastClickXY=[i,s],this.clickTimer=setTimeout(()=>{y="click",this.emit(Co.Hover,{x:i,y:s,lngLat:f,type:y})},400))}}let _A=0;function bA(a){let i=a;if(typeof a=="string"&&(i=document.getElementById(a)),i){const s=document.createElement("div");return s.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,s.id=`l7-scene-${_A++}`,s.classList.add("l7-scene"),i.appendChild(s),s}return null}function xA(a){var i;let s=!0;if((a==null||(i=a.target)===null||i===void 0?void 0:i.target)instanceof HTMLElement){var f;let y=a==null||(f=a.target)===null||f===void 0?void 0:f.target;for(;y;){var p;const x=Array.from(y.classList);if(x.includes("l7-marker")||x.includes("l7-popup")){s=!1;break}y=(p=y)===null||p===void 0?void 0:p.parentElement}}return s}let Pl=function(a){return a[a.SAMPLED=0]="SAMPLED",a[a.RENDER_TARGET=1]="RENDER_TARGET",a}({});class Q_{constructor(i){var s=this;(0,ot.Z)(this,"pickedColors",void 0),(0,ot.Z)(this,"pickedTileLayers",[]),(0,ot.Z)(this,"pickingFBO",void 0),(0,ot.Z)(this,"width",0),(0,ot.Z)(this,"height",0),(0,ot.Z)(this,"alreadyInPicking",!1),(0,ot.Z)(this,"pickBufferScale",1),(0,ot.Z)(this,"pickFromPickingFBO",function(){var f=(0,ln.Z)(function*(p,{x:y,y:x,lngLat:O,type:A,target:I}){var B;let j=!1;const{readPixels:V,readPixelsAsync:mt,getViewportSize:Bt,queryVerdorInfo:Kt}=s.rendererService,{width:ue,height:Le}=Bt(),{enableHighlight:ke,enableSelect:He}=p.getLayerConfig(),Ye=y*Mo,rn=x*Mo;if(Ye>ue-1*Mo||Ye<0||rn>Le-1*Mo||rn<0)return!1;let bn;if(Kt()==="WebGPU"?bn=yield mt({x:Math.floor(Ye/s.pickBufferScale),y:Math.floor((Le-(x+1)*Mo)/s.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:s.pickingFBO}):bn=V({x:Math.floor(Ye/s.pickBufferScale),y:Math.floor((Le-(x+1)*Mo)/s.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:s.pickingFBO}),s.pickedColors=bn,bn[0]!==0||bn[1]!==0||bn[2]!==0){const Cn=dc(bn),Jn=p.layerPickService.getFeatureById(Cn);Cn!==p.getCurrentPickId()&&A==="mousemove"&&(A="mouseenter");const cr={x:y,y:x,type:A,lngLat:O,featureId:Cn,feature:Jn,target:I};Jn&&(j=!0,p.setCurrentPickId(Cn),s.triggerHoverOnLayer(p,cr))}else{const Cn={x:y,y:x,lngLat:O,type:p.getCurrentPickId()!==null&&A==="mousemove"?"mouseout":"un"+A,featureId:null,target:I,feature:null};s.triggerHoverOnLayer(p,(0,on.Z)((0,on.Z)({},Cn),{},{type:"unpick"})),s.triggerHoverOnLayer(p,Cn),p.setCurrentPickId(null)}if(ke&&p.layerPickService.highlightPickedFeature(bn),He&&A==="click"&&((B=bn)===null||B===void 0?void 0:B.toString())!==[0,0,0,0].toString()){const Cn=dc(bn);p.getCurrentSelectedId()===null||Cn!==p.getCurrentSelectedId()?(p.layerPickService.selectFeature(bn),p.setCurrentSelectedId(Cn)):(p.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),p.setCurrentSelectedId(null))}return j});return function(p,y){return f.apply(this,arguments)}}()),this.container=i}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(i){const{createTexture2D:s,createFramebuffer:f,getViewportSize:p}=this.rendererService;let{width:y,height:x}=p();this.pickBufferScale=this.configService.getSceneConfig(i).pickBufferScale||1,y=Math.round(y/this.pickBufferScale),x=Math.round(x/this.pickBufferScale);const O=s({width:y,height:x,usage:Pl.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=f({color:O,depth:!0,width:y,height:x}),this.interactionService.on(Co.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(i,s,f){var p=this;return(0,ln.Z)(function*(){const{useFramebufferAsync:y,clear:x}=p.rendererService;p.resizePickingFBO(),i.hooks.beforePickingEncode.call(),yield y(p.pickingFBO,(0,ln.Z)(function*(){x({framebuffer:p.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.renderModels({ispick:!0})})),i.hooks.afterPickingEncode.call();const O=yield p.pickBox(i,s);f(O)})()}pickBox(i,s){var f=this;return(0,ln.Z)(function*(){const[p,y,x,O]=s.map(Le=>{const ke=Le<0?0:Le;return Math.floor(ke*Mo/f.pickBufferScale)}),{readPixelsAsync:A,getViewportSize:I}=f.rendererService,{width:B,height:j}=I();if(p>(B-1)*Mo/f.pickBufferScale||x<0||y>(j-1)*Mo/f.pickBufferScale||O<0)return[];const V=Math.min(B/f.pickBufferScale,x)-p,mt=Math.min(j/f.pickBufferScale,O)-y,Bt=yield A({x:p,y:Math.floor(j/f.pickBufferScale-(O+1)),width:V,height:mt,data:new Uint8Array(V*mt*4),framebuffer:f.pickingFBO}),Kt=[],ue={};for(let Le=0;Le<Bt.length/4;Le=Le+1){const ke=Bt.slice(Le*4,Le*4+4),He=dc(ke);if(He!==-1&&!ue[He]){const Ye=i.layerPickService.getFeatureById(He);Kt.push((0,on.Z)((0,on.Z)({},Ye),{},{pickedFeatureIdx:He})),ue[He]=!0}}return Kt})()}handleCursor(i,s){const{cursor:f="",cursorEnabled:p}=i.getLayerConfig();if(p){const x=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),O=x==null?void 0:x.style.getPropertyValue("cursor");s==="unmousemove"&&O!==""?x==null||x.style.setProperty("cursor",""):s==="mousemove"&&(x==null||x.style.setProperty("cursor",f))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(i){var s=this;return(0,ln.Z)(function*(){!s.layerService.needPick(i.type)||!s.isPickingAllLayer()||(s.alreadyInPicking=!0,yield s.pickingLayers(i),s.layerService.renderLayers(),s.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:i}=this.rendererService,{width:s,height:f}=i();(this.width!==s||this.height!==f)&&(this.pickingFBO.resize({width:Math.round(s/this.pickBufferScale),height:Math.round(f/this.pickBufferScale)}),this.width=s,this.height=f)}pickingLayers(i){var s=this;return(0,ln.Z)(function*(){const{clear:f,useFramebufferAsync:p}=s.rendererService;s.resizePickingFBO();const y=s.layerService.getRenderList();for(const x of y.filter(O=>O.needPick(i.type)).reverse()){yield p(s.pickingFBO,(0,ln.Z)(function*(){f({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),x.layerPickService.pickRender(i)}));const O=yield s.pickFromPickingFBO(x,i);if(s.layerService.pickedLayerId=O?+x.id:-1,O&&!x.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(i,s){xA(s)&&(this.handleCursor(i,s.type),i.emit(s.type,s))}}class oI{constructor(i=!0){(0,ot.Z)(this,"autoStart",void 0),(0,ot.Z)(this,"startTime",0),(0,ot.Z)(this,"oldTime",0),(0,ot.Z)(this,"running",!1),(0,ot.Z)(this,"elapsedTime",0),this.autoStart=i}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let i=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const s=(typeof performance=="undefined"?Date:performance).now();i=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=i}return i}}const{throttle:J_}=hi;class SA extends No.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(i){super(),(0,ot.Z)(this,"pickedLayerId",-1),(0,ot.Z)(this,"clock",new oI),(0,ot.Z)(this,"alreadyInRendering",!1),(0,ot.Z)(this,"layers",[]),(0,ot.Z)(this,"layerList",[]),(0,ot.Z)(this,"layerRenderID",void 0),(0,ot.Z)(this,"sceneInited",!1),(0,ot.Z)(this,"animateInstanceCount",0),(0,ot.Z)(this,"shaderPicking",!0),(0,ot.Z)(this,"enableRender",!0),(0,ot.Z)(this,"reRender",J_(()=>{this.renderLayers()},32)),(0,ot.Z)(this,"throttleRenderLayers",J_(()=>{this.renderLayers()},16)),this.container=i}needPick(i){return this.updateLayerRenderList(),this.layerList.some(s=>s.needPick(i))}add(i){this.layers.push(i),this.sceneInited&&i.init().then(()=>{this.renderLayers()})}addMask(i){this.sceneInited&&i.init().then(()=>{this.renderLayers()})}initLayers(){var i=this;return(0,ln.Z)(function*(){i.sceneInited=!0,i.layers.forEach(function(){var s=(0,ln.Z)(function*(f){f.startInit||(yield f.init(),i.updateLayerRenderList())});return function(f){return s.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(i){return this.layers.find(s=>s.id===i)}getLayerByName(i){return this.layers.find(s=>s.name===i)}remove(i,s){var f=this;return(0,ln.Z)(function*(){if(s){s.layerChildren||(s.layerChildren=[]);const p=s.layerChildren.findIndex(y=>y.id===i.id);p>-1&&s.layerChildren.splice(p,1)}else{const p=f.layers.findIndex(y=>y.id===i.id);p>-1&&f.layers.splice(p,1)}i.destroy(),f.reRender(),f.emit("layerChange",f.layers)})()}removeAllLayers(){var i=this;return(0,ln.Z)(function*(){i.destroy(),i.reRender()})()}setEnableRender(i){this.enableRender=i}renderLayers(){var i=this;return(0,ln.Z)(function*(){if(i.alreadyInRendering||!i.enableRender)return;i.updateLayerRenderList();const s=i.debugService.generateRenderUid();i.debugService.renderStart(s),i.alreadyInRendering=!0,i.clear();for(const f of i.layerList)f.prerender();i.renderService.beginFrame();for(const f of i.layerList){const{enableMask:p}=f.getLayerConfig();f.masks.filter(y=>y.inited).length>0&&p&&i.renderMask(f.masks),f.getLayerConfig().enableMultiPassRenderer?yield f.renderMultiPass():f.render()}i.renderService.endFrame(),i.debugService.renderEnd(s),i.alreadyInRendering=!1})()}renderMask(i){let s=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const f=i.length>1?Oc.MULTIPLE:Oc.SINGLE;for(const p of i)p.render({isStencil:!0,stencilType:f,stencilIndex:s++})}beforeRenderData(i){var s=this;return(0,ln.Z)(function*(){(yield i.hooks.beforeRenderData.promise())&&s.renderLayers()})()}renderTileLayerMask(i){let s=0;const{enableMask:f=!0}=i.getLayerConfig();let p=i.tileMask?1:0;const y=i.masks.filter(O=>O.inited);p=p+(f?y.length:1);const x=p>1?Oc.MULTIPLE:Oc.SINGLE;if((i.tileMask||y.length&&f)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),y.length&&f)for(const O of y)O.render({isStencil:!0,stencilType:x,stencilIndex:s++});i.tileMask&&i.tileMask.render({isStencil:!0,stencilType:x,stencilIndex:s++,stencilOperation:Tl.OR})}renderTileLayer(i){var s=this;return(0,ln.Z)(function*(){s.renderTileLayerMask(i),i.getLayerConfig().enableMultiPassRenderer?yield i.renderMultiPass():yield i.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(i=>i.inited).filter(i=>i.isVisible()).sort((i,s)=>i.zIndex-s.zIndex).forEach(i=>{this.layerList.push(i)})}destroy(){this.layers.forEach(i=>{i.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const i=Gr(this.mapService.bgColor);this.renderService.clear({color:i,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var jo=L(91);const{isNil:kg}=hi;class wA{constructor(i){(0,ot.Z)(this,"name",void 0),(0,ot.Z)(this,"type",void 0),(0,ot.Z)(this,"scale",void 0),(0,ot.Z)(this,"descriptor",void 0),(0,ot.Z)(this,"featureBufferLayout",[]),(0,ot.Z)(this,"needRescale",!1),(0,ot.Z)(this,"needRemapping",!1),(0,ot.Z)(this,"needRegenerateVertices",!1),(0,ot.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,ot.Z)(this,"vertexAttribute",void 0),(0,ot.Z)(this,"defaultCallback",s=>{if(s.length===0){var f;return((f=this.scale)===null||f===void 0?void 0:f.defaultValues)||[]}return s.map((p,y)=>{var x;return((x=this.scale)===null||x===void 0?void 0:x.scalers[y].func)(p)})}),this.setProps(i)}setProps(i){Object.assign(this,i)}mapping(i){var s;if((s=this.scale)!==null&&s!==void 0&&s.callback){var f;const p=(f=this.scale)===null||f===void 0?void 0:f.callback(...i);if(!kg(p))return[p]}return this.defaultCallback(i)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const OA=["buffer","update","name"],aI=["buffer","update","name"],tb={[dt.FLOAT]:4,[dt.UNSIGNED_BYTE]:1,[dt.UNSIGNED_SHORT]:2};class sI{constructor(i){(0,ot.Z)(this,"attributesAndIndices",void 0),(0,ot.Z)(this,"attributes",[]),(0,ot.Z)(this,"triangulation",void 0),(0,ot.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=i}registerStyleAttribute(i){let s=this.getLayerStyleAttribute(i.name||"");return s?s.setProps(i):(s=new wA(i),this.attributes.push(s)),s}unRegisterStyleAttribute(i){const s=this.attributes.findIndex(f=>f.name===i);s>-1&&this.attributes.splice(s,1)}updateScaleAttribute(i){this.attributes.forEach(s=>{var f;const p=s.name,y=(f=s.scale)===null||f===void 0?void 0:f.field;(i[p]||y&&i[y])&&(s.needRescale=!0,s.needRemapping=!0,s.needRegenerateVertices=!0)})}updateStyleAttribute(i,s,f){let p=this.getLayerStyleAttribute(i);p||(p=this.registerStyleAttribute((0,on.Z)((0,on.Z)({},s),{},{name:i})));const{scale:y}=s;y&&p&&(p.scale=y,p.needRescale=!0,p.needRemapping=!0,p.needRegenerateVertices=!0,f&&f.featureRange&&(p.featureRange=f.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(i){return this.attributes.find(s=>s.name===i)}getLayerAttributeScale(i){var s;const f=this.getLayerStyleAttribute(i),p=f==null||(s=f.scale)===null||s===void 0?void 0:s.scalers;return p&&p[0]?p[0].func:null}updateAttributeByFeatureRange(i,s,f=0,p,y){const x=this.attributes.find(O=>O.name===i);if(x&&x.descriptor){const{descriptor:O}=x,{update:A,buffer:I,size:B=0}=O,j=tb[I.type||dt.FLOAT];if(A){const{elements:V,sizePerElement:mt}=this.featureLayout,Bt=V.slice(f,p);if(!Bt.length)return;const{offset:Kt}=Bt[0],ue=Kt*B*j,Le=Bt.map(({featureIdx:ke,vertices:He,normals:Ye},rn)=>{const bn=He.length/mt,hn=[];for(let Cn=0;Cn<bn;Cn++){const Jn=Ye?Ye.slice(Cn*3,Cn*3+3):[];hn.push(...A(s[ke],ke,He.slice(Cn*mt,Cn*mt+mt),rn,Jn))}return hn}).flat();x.vertexAttribute.updateBuffer({data:Le,offset:ue}),y==null||y.emit(`legend:${i}`,y.getLegend(i))}}}createAttributesAndIndices(i,s,f,p){this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);const y=this.attributes.map(Kt=>(Kt.resetDescriptor(),Kt.descriptor));let x=0,O=0;const A=[];let I=3;i.forEach((Kt,ue)=>{const{indices:Le,vertices:ke,normals:He,size:Ye,indexes:rn,count:bn}=this.triangulation(Kt,f);typeof bn=="number"&&(O+=bn),Le.forEach(Cn=>{A.push(Cn+x)}),I=Ye;const hn=ke.length/Ye;this.featureLayout.sizePerElement=I,this.featureLayout.elements.push({featureIdx:ue,vertices:ke,normals:He,offset:x}),x+=hn;for(let Cn=0;Cn<hn;Cn++){const Jn=(He==null?void 0:He.slice(Cn*3,Cn*3+3))||[],cr=ke.slice(Cn*Ye,Cn*Ye+Ye);let Gn=0;rn&&rn[Cn]!==void 0&&(Gn=rn[Cn]),y.forEach((ar,mr)=>{ar&&ar.update&&ar.buffer.data.push(...ar.update(Kt,ue,cr,Cn,Jn,Gn))})}});const{createAttribute:B,createBuffer:j,createElements:V}=this.rendererService,mt={};y.forEach((Kt,ue)=>{if(Kt){const{buffer:Le,update:ke,name:He}=Kt,Ye=(0,jo.Z)(Kt,OA),rn=B((0,on.Z)({buffer:j(Le)},Ye));mt[Kt.name||""]=rn,this.attributes[ue].vertexAttribute=rn}});const Bt=V({data:A,type:dt.UNSIGNED_INT,count:A.length});return this.attributesAndIndices={attributes:mt,elements:Bt,count:O},Object.values(this.attributes).filter(Kt=>Kt.scale).forEach(Kt=>{const ue=Kt.name;p==null||p.emit(`legend:${ue}`,p.getLegend(ue))}),this.attributesAndIndices}createAttributes(i,s){this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);const f=this.attributes.map(B=>(B.resetDescriptor(),B.descriptor));let p=0;const y=[];let x=3;i.forEach((B,j)=>{const{indices:V,vertices:mt,normals:Bt,size:Kt,indexes:ue}=this.triangulation(B);V.forEach(ke=>{y.push(ke+p)}),x=Kt;const Le=mt.length/Kt;this.featureLayout.sizePerElement=x,this.featureLayout.elements.push({featureIdx:j,vertices:mt,normals:Bt,offset:p}),p+=Le;for(let ke=0;ke<Le;ke++){const He=(Bt==null?void 0:Bt.slice(ke*3,ke*3+3))||[],Ye=mt.slice(ke*Kt,ke*Kt+Kt);let rn=0;ue&&ue[ke]!==void 0&&(rn=ue[ke]),f.forEach((bn,hn)=>{bn&&bn.update&&bn.buffer.data.push(...bn.update(B,j,Ye,ke,He,rn))})}});const{createAttribute:O,createBuffer:A}=this.rendererService,I={};return f.forEach((B,j)=>{if(B){const{buffer:V,update:mt,name:Bt}=B,Kt=(0,jo.Z)(B,aI),ue=O((0,on.Z)({buffer:A(V)},Kt));I[B.name||""]=ue,this.attributes[j].vertexAttribute=ue}}),{attributes:I}}clearAllAttributes(){var i;this.attributes.forEach(s=>{s.vertexAttribute&&s.vertexAttribute.destroy()}),(i=this.attributesAndIndices)===null||i===void 0||i.elements.destroy(),this.attributes=[]}}var Dg=L(34155);function eb(a,i,s,f){function p(y){return y instanceof s?y:new s(function(x){x(y)})}return new(s||(s=Promise))(function(y,x){function O(B){try{I(f.next(B))}catch(j){x(j)}}function A(B){try{I(f.throw(B))}catch(j){x(j)}}function I(B){B.done?y(B.value):p(B.value).then(O,A)}I((f=f.apply(a,i||[])).next())})}function Ng(a,i){var s={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},f,p,y,x;return x={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function O(I){return function(B){return A([I,B])}}function A(I){if(f)throw new TypeError("Generator is already executing.");for(;s;)try{if(f=1,p&&(y=I[0]&2?p.return:I[0]?p.throw||((y=p.return)&&y.call(p),0):p.next)&&!(y=y.call(p,I[1])).done)return y;switch(p=0,y&&(I=[I[0]&2,y.value]),I[0]){case 0:case 1:y=I;break;case 4:return s.label++,{value:I[1],done:!1};case 5:s.label++,p=I[1],I=[0];continue;case 7:I=s.ops.pop(),s.trys.pop();continue;default:if(y=s.trys,!(y=y.length>0&&y[y.length-1])&&(I[0]===6||I[0]===2)){s=0;continue}if(I[0]===3&&(!y||I[1]>y[0]&&I[1]<y[3])){s.label=I[1];break}if(I[0]===6&&s.label<y[1]){s.label=y[1],y=I;break}if(y&&s.label<y[2]){s.label=y[2],s.ops.push(I);break}y[2]&&s.ops.pop(),s.trys.pop();continue}I=i.call(a,s)}catch(B){I=[6,B],p=0}finally{f=y=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}}function xh(a,i){var s=typeof Symbol=="function"&&a[Symbol.iterator];if(!s)return a;var f=s.call(a),p,y=[],x;try{for(;(i===void 0||i-- >0)&&!(p=f.next()).done;)y.push(p.value)}catch(O){x={error:O}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(x)throw x.error}}return y}function Sh(a,i,s){if(s||arguments.length===2)for(var f=0,p=i.length,y;f<p;f++)(y||!(f in i))&&(y||(y=Array.prototype.slice.call(i,0,f)),y[f]=i[f]);return a.concat(y||Array.prototype.slice.call(i))}function Fg(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Bg={exports:{}},wh={exports:{}},rf={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){return f&&typeof f.length=="number"&&f.length>=0&&f.length%1===0}a.exports=i.default})(rf,rf.exports);var Po={},jg={exports:{}},zg={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(s){return function(){for(var f=[],p=arguments.length;p--;)f[p]=arguments[p];var y=f.pop();return s.call(this,f,y)}},a.exports=i.default})(zg,zg.exports);var Ds={};Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.fallback=rb,Ds.wrap=Zg;var nb=Ds.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Ug=Ds.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,EA=Ds.hasNextTick=typeof Dg=="object"&&typeof Dg.nextTick=="function";function rb(a){setTimeout(a,0)}function Zg(a){return function(i){for(var s=[],f=arguments.length-1;f-- >0;)s[f]=arguments[f+1];return a(function(){return i.apply(void 0,s)})}}var of;nb?of=queueMicrotask:Ug?of=setImmediate:EA?of=Dg.nextTick:of=rb,Ds.default=Zg(of),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=A;var s=zg.exports,f=O(s),p=Ds,y=O(p),x=Po;function O(j){return j&&j.__esModule?j:{default:j}}function A(j){return(0,x.isAsync)(j)?function(){for(var V=[],mt=arguments.length;mt--;)V[mt]=arguments[mt];var Bt=V.pop(),Kt=j.apply(this,V);return I(Kt,Bt)}:(0,f.default)(function(V,mt){var Bt;try{Bt=j.apply(this,V)}catch(Kt){return mt(Kt)}if(Bt&&typeof Bt.then=="function")return I(Bt,mt);mt(null,Bt)})}function I(j,V){return j.then(function(mt){B(V,null,mt)},function(mt){B(V,mt&&mt.message?mt:new Error(mt))})}function B(j,V,mt){try{j(V,mt)}catch(Bt){(0,y.default)(function(Kt){throw Kt},Bt)}}a.exports=i.default}(jg,jg.exports),Object.defineProperty(Po,"__esModule",{value:!0}),Po.isAsyncIterable=Po.isAsyncGenerator=Po.isAsync=void 0;var ib=jg.exports,AA=TA(ib);function TA(a){return a&&a.__esModule?a:{default:a}}function ob(a){return a[Symbol.toStringTag]==="AsyncFunction"}function ab(a){return a[Symbol.toStringTag]==="AsyncGenerator"}function MA(a){return typeof a[Symbol.asyncIterator]=="function"}function sb(a){if(typeof a!="function")throw new Error("expected a function");return ob(a)?(0,AA.default)(a):a}Po.default=sb,Po.isAsync=ob,Po.isAsyncGenerator=ab,Po.isAsyncIterable=MA;var Mc={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f,p){if(p===void 0&&(p=f.length),!p)throw new Error("arity is undefined");function y(){for(var x=this,O=[],A=arguments.length;A--;)O[A]=arguments[A];return typeof O[p-1]=="function"?f.apply(this,O):new Promise(function(I,B){O[p-1]=function(j){for(var V=[],mt=arguments.length-1;mt-- >0;)V[mt]=arguments[mt+1];if(j)return B(j);I(V.length>1?V:V[0])},f.apply(x,O)})}return y}a.exports=i.default})(Mc,Mc.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=rf.exports,f=A(s),p=Po,y=A(p),x=Mc.exports,O=A(x);function A(I){return I&&I.__esModule?I:{default:I}}i.default=(0,O.default)(function(I,B,j){var V=(0,f.default)(B)?[]:{};I(B,function(mt,Bt,Kt){(0,y.default)(mt)(function(ue){for(var Le,ke=[],He=arguments.length-1;He-- >0;)ke[He]=arguments[He+1];ke.length<2&&(Le=ke,ke=Le[0]),V[Bt]=ke,Kt(ue)})},function(mt){return j(mt,V)})},3),a.exports=i.default}(wh,wh.exports);var Oh={exports:{}},Eh={exports:{}},Hg={exports:{}},af={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){function p(){for(var y=[],x=arguments.length;x--;)y[x]=arguments[x];if(f!==null){var O=f;f=null,O.apply(this,y)}}return Object.assign(p,f),p}a.exports=i.default})(af,af.exports);var Wg={exports:{}},Ah={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(s){return s[Symbol.iterator]&&s[Symbol.iterator]()},a.exports=i.default})(Ah,Ah.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=B;var s=rf.exports,f=x(s),p=Ah.exports,y=x(p);function x(j){return j&&j.__esModule?j:{default:j}}function O(j){var V=-1,mt=j.length;return function(){return++V<mt?{value:j[V],key:V}:null}}function A(j){var V=-1;return function(){var Bt=j.next();return Bt.done?null:(V++,{value:Bt.value,key:V})}}function I(j){var V=j?Object.keys(j):[],mt=-1,Bt=V.length;return function Kt(){var ue=V[++mt];return ue==="__proto__"?Kt():mt<Bt?{value:j[ue],key:ue}:null}}function B(j){if((0,f.default)(j))return O(j);var V=(0,y.default)(j);return V?A(V):I(j)}a.exports=i.default}(Wg,Wg.exports);var sf={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){return function(){for(var p=[],y=arguments.length;y--;)p[y]=arguments[y];if(f===null)throw new Error("Callback was already called.");var x=f;f=null,x.apply(this,p)}}a.exports=i.default})(sf,sf.exports);var Ll={exports:{}},cf={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s={};i.default=s,a.exports=i.default})(cf,cf.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=y;var s=cf.exports,f=p(s);function p(x){return x&&x.__esModule?x:{default:x}}function y(x,O,A,I){var B=!1,j=!1,V=!1,mt=0,Bt=0;function Kt(){mt>=O||V||B||(V=!0,x.next().then(function(ke){var He=ke.value,Ye=ke.done;if(!(j||B)){if(V=!1,Ye){B=!0,mt<=0&&I(null);return}mt++,A(He,Bt,ue),Bt++,Kt()}}).catch(Le))}function ue(ke,He){if(mt-=1,!j){if(ke)return Le(ke);if(ke===!1){B=!0,j=!0;return}if(He===f.default||B&&mt<=0)return B=!0,I(null);Kt()}}function Le(ke){j||(V=!1,B=!0,I(ke))}Kt()}a.exports=i.default}(Ll,Ll.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=af.exports,f=mt(s),p=Wg.exports,y=mt(p),x=sf.exports,O=mt(x),A=Po,I=Ll.exports,B=mt(I),j=cf.exports,V=mt(j);function mt(Bt){return Bt&&Bt.__esModule?Bt:{default:Bt}}i.default=function(Bt){return function(Kt,ue,Le){if(Le=(0,f.default)(Le),Bt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Kt)return Le(null);if((0,A.isAsyncGenerator)(Kt))return(0,B.default)(Kt,Bt,ue,Le);if((0,A.isAsyncIterable)(Kt))return(0,B.default)(Kt[Symbol.asyncIterator](),Bt,ue,Le);var ke=(0,y.default)(Kt),He=!1,Ye=!1,rn=0,bn=!1;function hn(Jn,cr){if(!Ye)if(rn-=1,Jn)He=!0,Le(Jn);else if(Jn===!1)He=!0,Ye=!0;else{if(cr===V.default||He&&rn<=0)return He=!0,Le(null);bn||Cn()}}function Cn(){for(bn=!0;rn<Bt&&!He;){var Jn=ke();if(Jn===null){He=!0,rn<=0&&Le(null);return}rn+=1,ue(Jn.value,Jn.key,(0,O.default)(hn))}bn=!1}Cn()}},a.exports=i.default}(Hg,Hg.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=Hg.exports,f=A(s),p=Po,y=A(p),x=Mc.exports,O=A(x);function A(B){return B&&B.__esModule?B:{default:B}}function I(B,j,V,mt){return(0,f.default)(j)(B,(0,y.default)(V),mt)}i.default=(0,O.default)(I,4),a.exports=i.default}(Eh,Eh.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=Eh.exports,f=x(s),p=Mc.exports,y=x(p);function x(A){return A&&A.__esModule?A:{default:A}}function O(A,I,B){return(0,f.default)(A,1,I,B)}i.default=(0,y.default)(O,3),a.exports=i.default}(Oh,Oh.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=O;var s=wh.exports,f=x(s),p=Oh.exports,y=x(p);function x(A){return A&&A.__esModule?A:{default:A}}function O(A,I){return(0,f.default)(y.default,A,I)}a.exports=i.default}(Bg,Bg.exports);var Th=Fg(Bg.exports),pa=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.call=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,Th(this.tasks)},a.prototype.tap=function(i,s){var f=this;this.tasks.push(function(p){s.apply(void 0,Sh([],xh(f.args),!1)),p(null,i)})},a}(),Vg={exports:{}},Mh={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=rf.exports,f=ue(s),p=cf.exports,y=ue(p),x=Eh.exports,O=ue(x),A=af.exports,I=ue(A),B=sf.exports,j=ue(B),V=Po,mt=ue(V),Bt=Mc.exports,Kt=ue(Bt);function ue(Ye){return Ye&&Ye.__esModule?Ye:{default:Ye}}function Le(Ye,rn,bn){bn=(0,I.default)(bn);var hn=0,Cn=0,Jn=Ye.length,cr=!1;Jn===0&&bn(null);function Gn(ar,mr){ar===!1&&(cr=!0),cr!==!0&&(ar?bn(ar):(++Cn===Jn||mr===y.default)&&bn(null))}for(;hn<Jn;hn++)rn(Ye[hn],hn,(0,j.default)(Gn))}function ke(Ye,rn,bn){return(0,O.default)(Ye,1/0,rn,bn)}function He(Ye,rn,bn){var hn=(0,f.default)(Ye)?Le:ke;return hn(Ye,(0,mt.default)(rn),bn)}i.default=(0,Kt.default)(He,3),a.exports=i.default})(Mh,Mh.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=O;var s=Mh.exports,f=x(s),p=wh.exports,y=x(p);function x(A){return A&&A.__esModule?A:{default:A}}function O(A,I){return(0,y.default)(f.default,A,I)}a.exports=i.default}(Vg,Vg.exports);var Gg=Fg(Vg.exports),Jo=function(){function a(){this.tasks=[]}return a.prototype.promise=function(){return Gg(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(p){return eb(f,void 0,void 0,function(){return Ng(this,function(y){switch(y.label){case 0:return[4,s()];case 1:return y.sent(),p(null,i),[2]}})})})},a}(),ta={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=af.exports,f=B(s),p=sf.exports,y=B(p),x=Po,O=B(x),A=Mc.exports,I=B(A);function B(V){return V&&V.__esModule?V:{default:V}}function j(V,mt){if(mt=(0,f.default)(mt),!Array.isArray(V))return mt(new Error("First argument to waterfall must be an array of functions"));if(!V.length)return mt();var Bt=0;function Kt(Le){var ke=(0,O.default)(V[Bt++]);ke.apply(void 0,Le.concat([(0,y.default)(ue)]))}function ue(Le){for(var ke=[],He=arguments.length-1;He-- >0;)ke[He]=arguments[He+1];if(Le!==!1){if(Le||Bt===V.length)return mt.apply(void 0,[Le].concat(ke));Kt(ke)}}Kt([])}i.default=(0,I.default)(j),a.exports=i.default})(ta,ta.exports);var lf=Fg(ta.exports),uf=function(){function a(){this.tasks=[]}return a.prototype.call=function(){return lf(this.tasks)},a.prototype.tap=function(i,s){this.tasks.length===0?this.tasks.push(function(f){var p=s();f(p?null:!1,p)}):this.tasks.push(function(f,p){var y=s.apply(void 0,Sh([],xh(f),!1));p(y?null:!1,i)})},a}(),Ch=function(){function a(){this.tasks=[]}return a.prototype.call=function(){return Th(this.tasks)},a.prototype.tap=function(i,s){this.tasks.push(function(f){var p=s();f(p,i)})},a}(),CA=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.promise=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,Th(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(p){return eb(f,void 0,void 0,function(){return Ng(this,function(y){switch(y.label){case 0:return[4,s.apply(void 0,Sh([],xh(this.args),!1))];case 1:return y.sent(),p(null,i),[2]}})})})},a}(),cb=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.promise=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,Th(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(p){return eb(f,void 0,void 0,function(){var y;return Ng(this,function(x){switch(x.label){case 0:return[4,s.apply(void 0,Sh([],xh(this.args),!1))];case 1:return y=x.sent(),p(y,i),[2]}})})})},a}(),$g=function(){function a(){this.tasks=[]}return a.prototype.promise=function(){return lf(this.tasks)},a.prototype.tapPromise=function(i,s){this.tasks.length===0?this.tasks.push(function(f){s().then(function(p){f(null,p)})}):this.tasks.push(function(f,p){s(f).then(function(y){p(null,y)})})},a}(),PA=L(63844),lb=L.n(PA);class Il extends No.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(i){super(),(0,ot.Z)(this,"destroyed",!1),(0,ot.Z)(this,"loaded",!1),(0,ot.Z)(this,"id",void 0),(0,ot.Z)(this,"inited",!1),(0,ot.Z)(this,"rendering",!1),(0,ot.Z)(this,"$container",void 0),(0,ot.Z)(this,"canvas",void 0),(0,ot.Z)(this,"markerContainer",void 0),(0,ot.Z)(this,"resizeDetector",void 0),(0,ot.Z)(this,"hooks",void 0),(0,ot.Z)(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),(0,ot.Z)(this,"handleMapCameraChanged",s=>{this.cameraService.update(s),this.render()}),this.container=i,this.hooks={init:new CA},this.id=i.id}init(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ln.Z)(function*(){s.debugService.log("map.mapInitStart",{type:s.map.version}),yield new Promise(f=>{s.map.onCameraChanged(p=>{s.cameraService.init(),s.cameraService.update(p),f()}),s.map.init()}),s.map.onCameraChanged(s.handleMapCameraChanged),s.map.addMarkerContainer(),s.markerService.addMarkers(),s.markerService.addMarkerLayers(),s.popupService.initPopup(),s.interactionService.init(),s.interactionService.on(Co.Drag,s.addSceneEvent.bind(s))})),this.hooks.init.tapPromise("initRenderer",(0,ln.Z)(function*(){var f;const p=((f=s.map)===null||f===void 0?void 0:f.getOverlayContainer())||void 0;if(p?s.$container=p:s.$container=bA(s.configService.getSceneConfig(s.id).id||""),s.$container){const{canvas:x}=i;if(s.canvas=x||Vi("canvas","",s.$container),s.setCanvas(),yield s.rendererService.init(s.canvas,s.configService.getSceneConfig(s.id),i.gl),s.registerContextLost(),s.initContainer(),s.resizeDetector=lb()({strategy:"scroll"}),s.resizeDetector.listenTo(s.$container,s.handleWindowResized),window.matchMedia){var y;(y=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||y===void 0||y.addListener(s.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");s.pickingService.init(s.id)})),this.render()}registerContextLost(){const i=this.rendererService.getCanvas();i&&i.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(i){this.layerService.sceneService=this,this.layerService.add(i)}addMask(i){this.layerService.sceneService=this,this.layerService.addMask(i)}render(){var i=this;return(0,ln.Z)(function*(){i.rendering||i.destroyed||(i.rendering=!0,i.inited?(yield i.layerService.initLayers(),yield i.layerService.renderLayers()):(yield i.hooks.init.promise(),i.destroyed&&i.destroy(),yield i.layerService.initLayers(),i.layerService.renderLayers(),i.controlService.addControls(),i.loaded=!0,i.emit("loaded"),i.inited=!0),i.rendering=!1)})()}addFontFace(i,s){this.fontService.addFontFace(i,s)}getSceneContainer(){return this.$container}exportPng(i){var s=this;return(0,ln.Z)(function*(){var f;const p=(f=s.$container)===null||f===void 0?void 0:f.getElementsByTagName("canvas")[0];return yield s.render(),i==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const i=this.$container.parentElement;i!==null&&(this.markerContainer=Vi("div","l7-marker-container",i))}getMarkerContainer(){return this.markerContainer}destroy(){var i;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var s;(s=this.$container)===null||s===void 0||s.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(i=this.$container)===null||i===void 0||(i=i.parentNode)===null||i===void 0||i.removeChild(this.$container),this.emit("destroy")}initContainer(){var i,s;const f=Mo,p=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,x=this.canvas;x&&(x.width=p*f,x.height=y*f),this.rendererService.viewport({x:0,y:0,width:f*p,height:f*y})}setCanvas(){var i,s;const f=Mo,p=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,x=this.canvas;x.width=p*f,x.height=y*f,x.style.width="100%",x.style.height="100%"}addSceneEvent(i){this.emit(i.type,i)}}const{uniq:LA}=hi,Rl=`#define PI (3.14159265359)
`,IA=`#define ambientRatio (0.5)
#define diffuseRatio (0.3)
#define specularRatio (0.2)

float calc_lighting(vec4 pos) {
  vec3 worldPos = vec3(pos * u_ModelMatrix);

  vec3 worldNormal = a_Normal;
  // //cal light weight
  vec3 viewDir = normalize(u_CameraPosition - worldPos);

  vec3 lightDir = normalize(vec3(1, -10.5, 12));

  vec3 halfDir = normalize(viewDir + lightDir);
  // //lambert
  float lambert = dot(worldNormal, lightDir);
  //specular
  float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
  //sum to light weight
  float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

  return lightWeight;
}
`,kl=`#define SHIFT_RIGHT17 (1.0 / 131072.0)
#define SHIFT_RIGHT18 (1.0 / 262144.0)
#define SHIFT_RIGHT19 (1.0 / 524288.0)
#define SHIFT_RIGHT20 (1.0 / 1048576.0)
#define SHIFT_RIGHT21 (1.0 / 2097152.0)
#define SHIFT_RIGHT22 (1.0 / 4194304.0)
#define SHIFT_RIGHT23 (1.0 / 8388608.0)
#define SHIFT_RIGHT24 (1.0 / 16777216.0)

#define SHIFT_LEFT17 (131072.0)
#define SHIFT_LEFT18 (262144.0)
#define SHIFT_LEFT19 (524288.0)
#define SHIFT_LEFT20 (1048576.0)
#define SHIFT_LEFT21 (2097152.0)
#define SHIFT_LEFT22 (4194304.0)
#define SHIFT_LEFT23 (8388608.0)
#define SHIFT_LEFT24 (16777216.0)

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(unpack_float(encodedColor[0]) / 255.0, unpack_float(encodedColor[1]) / 255.0);
}
`,ub=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Ph=`in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE (0.0)
#define PICKING_ENCODE (1.0)
#define PICKING_HIGHLIGHT (2.0)
#define COLOR_SCALE (1.0 / 255.0)

#define HIGHLIGHT (1.0)
#define SELECT (2.0)

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if (activeType > 0.0) {
    vec4 highLightColor = activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }

}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE
    ? vec4(pickingColor, step(0.001, color.a))
    : color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if (u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }

}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if (u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Yg=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,fb=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};
`,RA=`#define E (2.718281828459045)
vec2 ProjectFlat(vec2 lnglat) {
  float maxs = 85.0511287798;
  float lat = max(min(maxs, lnglat.y), -maxs);
  float scale = 268435456.0;
  float d = PI / 180.0;
  float x = lnglat.x * d;
  float y = lat * d;
  y = log(tan(PI / 4.0 + y / 2.0));

  float a = 0.5 / PI,
    b = 0.5,
    c = -0.5 / PI;
  d = 0.5;
  x = scale * (a * x + b);
  y = scale * (c * y + d);
  return vec2(x, y);
}

vec2 unProjectFlat(vec2 px) {
  float a = 0.5 / PI;
  float b = 0.5;
  float c = -0.5 / PI;
  float d = 0.5;
  float scale = 268435456.0;
  float x = (px.x / scale - b) / a;
  float y = (px.y / scale - d) / c;
  y = (atan(pow(E, y)) - PI / 4.0) * 2.0;
  d = PI / 180.0;
  float lat = y / d;
  float lng = x / d;
  return vec2(lng, lat);
}

float pixelDistance(vec2 from, vec2 to) {
  vec2 a1 = ProjectFlat(from);
  vec2 b1 = ProjectFlat(to);
  return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) {
  // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) {
  // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}

float customPixelDistance(vec2 from, vec2 to) {
  vec2 a1 = ProjectFlat(from);
  vec2 b1 = ProjectFlat(to);
  return distance(a1, b1);
}
`,db=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  // \u68C0\u67E5\u662F\u5426\u4F7F\u7528\u4E86\u56FE\u5C42\u76F8\u5BF9\u5750\u6807\u8F6C\u6362
  bool usingRelativeCoords = abs(u_RelativeOrigin.x) > 0.0001 || abs(u_RelativeOrigin.y) > 0.0001;

  if (usingRelativeCoords) {
    // \u76F8\u5BF9\u5750\u6807\u7CFB\u7684\u7279\u6B8A\u5904\u7406\uFF1ACPU\u4FA7\u5DF2\u786E\u4FDDViewportCenter=RelativeOrigin
    // \u5728\u9AD8\u7F29\u653E\u7EA7\u522B\u65F6\u76F4\u63A5\u4F7F\u7528\u76F8\u5BF9\u5750\u6807\uFF0C\u907F\u514D\u7CBE\u5EA6\u95EE\u9898

    if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u9AD8\u7F29\u653E\u7EA7\u522B\uFF1A\u76F4\u63A5\u4F7F\u7528\u76F8\u5BF9\u5750\u6807\u4F5C\u4E3A\u504F\u79FB
      // \u7531\u4E8EViewportCenter\u5DF2\u88AB\u8BBE\u7F6E\u4E3ARelativeOrigin\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528position
      float X = position.x;
      float Y = position.y;
      return project_offset(
        vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
      );
    } else {
      // \u4F4E\u7F29\u653E\u7EA7\u522B\uFF1A\u8F6C\u6362\u4E3A\u7EDD\u5BF9\u5750\u6807\u540E\u4F7F\u7528\u58A8\u5361\u6258\u6295\u5F71
      vec2 absolutePos = position.xy + u_RelativeOrigin.xy;
      return vec4(
        project_mercator(absolutePos) * WORLD_SCALE * u_ZoomScale,
        project_scale(position.z),
        position.w
      );
    }
  }

  // \u5904\u7406\u666E\u901A\u5750\u6807\u7CFB\uFF08\u975E\u76F8\u5BF9\u5750\u6807\uFF09
  vec4 absolutePosition = position;
  vec2 absolutePosition64xyLow = position64xyLow;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // \u5728\u504F\u79FB\u5750\u6807\u7CFB\u4E0B
    vec2 center = u_ViewportCenter;
    float X = absolutePosition.x - center.x;
    float Y = absolutePosition.y - center.y;
    return project_offset(
      vec4(
        X + absolutePosition64xyLow.x,
        Y + absolutePosition64xyLow.y,
        absolutePosition.z,
        absolutePosition.w
      )
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    // \u5728\u7ECF\u7EAC\u5EA6\u5750\u6807\u7CFB\u4E0B\u4F7F\u7528\u58A8\u5361\u6258\u6295\u5F71
    return vec4(
      project_mercator(absolutePosition.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(absolutePosition.z),
      absolutePosition.w
    );
  }

  return absolutePosition;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,hb=`vec2 rotate_matrix(vec2 v, float a) {
  float b = a / 180.0 * 3.1415926535897932384626433832795;
  float s = sin(b);
  float c = cos(b);
  mat2 m = mat2(c, s, -s, c);
  return m * v;
}
`,ff=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
  vec2 u_RelativeOrigin;
  float u_Reserved3;
};
`,ga=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b) {
  return a.x * b.x - a.y * b.y;
}

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0 / k;
  if (p.x + k * p.y > 0.0) p = vec2(p.x - k * p.y, -k * p.x - p.y) / 2.0;
  p.x -= clamp(p.x, -2.0, 0.0);
  return -length(p) * sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p) - b;
  return length(max(d, vec2(0))) + min(max(d.x, d.y), 0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994, 0.587785252, 0.726542528);
  p.x = abs(p.x);
  p -= 2.0 * min(dot(vec2(-k.x, k.y), p), 0.0) * vec2(-k.x, k.y);
  p -= 2.0 * min(dot(vec2(k.x, k.y), p), 0.0) * vec2(k.x, k.y);
  p -= vec2(clamp(p.x, -r * k.z, r * k.z), r);
  return length(p) * sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404, 0.5, 0.577350269);
  p = abs(p);
  p -= 2.0 * min(dot(k.xy, p), 0.0) * k.xy;
  p -= vec2(clamp(p.x, -k.z * r, k.z * r), r);
  return length(p) * sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623);
  p = abs(p);
  p -= 2.0 * min(dot(vec2(k.x, k.y), p), 0.0) * vec2(k.x, k.y);
  p -= 2.0 * min(dot(vec2(-k.x, k.y), p), 0.0) * vec2(-k.x, k.y);
  p -= vec2(clamp(p.x, -k.z * r, k.z * r), r);
  return length(p) * sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k = vec4(-0.5, 0.8660254038, 0.5773502692, 1.7320508076);
  p = abs(p);
  p -= 2.0 * min(dot(k.xy, p), 0.0) * k.xy;
  p -= 2.0 * min(dot(k.yx, p), 0.0) * k.yx;
  p -= vec2(clamp(p.x, r * k.z, r * k.w), r);
  return length(p) * sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0 * ndot(q, b) + ndot(b, b)) / dot(b, b), -1.0, 1.0);
  float d = length(q - 0.5 * b * vec2(1.0 - h, 1.0 + h));
  return d * sign(q.x * b.y + q.y * b.x - b.x * b.y);
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r * r - d * d); // can delay this sqrt
  return (p.y - b) * d > p.x * b
    ? length(p - vec2(0.0, b))
    : length(p - vec2(-d, 0.0)) - r;
}
`,pb=/precision\s+(high|low|medium)p\s+float/,Lh=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,kA=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,gb=/void\s+main\s*\([^)]*\)\s*\{\n?/;class Xg{constructor(){(0,ot.Z)(this,"moduleCache",{}),(0,ot.Z)(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:Rl,fs:Rl}),this.registerModule("decode",{vs:kl,fs:""}),this.registerModule("scene_uniforms",{vs:ff,fs:ff}),this.registerModule("picking_uniforms",{vs:fb,fs:fb}),this.registerModule("projection",{vs:db,fs:db}),this.registerModule("project",{vs:RA,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:ga}),this.registerModule("lighting",{vs:ub,fs:""}),this.registerModule("light",{vs:IA,fs:""}),this.registerModule("picking",{vs:Yg,fs:Ph}),this.registerModule("rotation_2d",{vs:hb,fs:""})}registerModule(i,s){s.vs=s.vs.replace(/\r\n/g,`
`),s.fs=s.fs.replace(/\r\n/g,`
`);const{vs:f,fs:p,uniforms:y,defines:x,inject:O}=s,{content:A,uniforms:I}=Ju(f),{content:B,uniforms:j}=Ju(p);this.rawContentCache[i]={fs:B,defines:x,inject:O,uniforms:(0,on.Z)((0,on.Z)((0,on.Z)({},I),j),y),vs:A}}getModule(i){let s=this.rawContentCache[i].vs,f=this.rawContentCache[i].fs;const{defines:p={},inject:y={}}=this.rawContentCache[i];let x={};y["vs:#decl"]&&(s=y["vs:#decl"]+s,x=Ju(y["vs:#decl"]).uniforms),y["vs:#main-start"]&&(s=s.replace(gb,Kt=>Kt+y["vs:#main-start"])),y["fs:#decl"]&&(f=y["fs:#decl"]+f),s=ds(p)+s;const{content:A,includeList:I}=this.processModule(s,[],"vs"),{content:B,includeList:j}=this.processModule(f,[],"fs"),V=LA(I.concat(j).concat(i)).reduce((Kt,ue)=>(0,on.Z)((0,on.Z)({},Kt),this.rawContentCache[ue].uniforms),(0,on.Z)({},x)),mt=(pb.test(B)?"":Lh)+A,Bt=(pb.test(B)?"":Lh)+B;return this.moduleCache[i]={vs:mt.trim(),fs:Bt.trim(),uniforms:V},this.moduleCache[i]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(i,s,f){return{content:i.replace(kA,(y,x)=>{const A=x.split(" ")[0].replace(/"/g,"");if(s.indexOf(A)>-1)return"";const I=this.rawContentCache[A][f];s.push(A);const{content:B}=this.processModule(I,s,f);return B}),includeList:s}}}function ds(a){return Object.keys(a).reduce((s,f)=>s+`#define ${f.toUpperCase()} ${a[f]}
`,`
`)}class Jr{constructor(){(0,ot.Z)(this,"shaderModuleService",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"cameraService",void 0),(0,ot.Z)(this,"mapService",void 0),(0,ot.Z)(this,"interactionService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"config",void 0)}getName(){return""}getType(){return Qu.Normal}init(i,s){this.config=s,this.rendererService=i.getContainer().rendererService,this.cameraService=i.getContainer().cameraService,this.mapService=i.getContainer().mapService,this.interactionService=i.getContainer().interactionService,this.layerService=i.getContainer().layerService,this.shaderModuleService=i.getContainer().shaderModuleService}render(i){}}class cI extends Jr{getName(){return"clear"}init(i,s){super.init(i,s)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class vb{constructor(i){(0,ot.Z)(this,"passes",[]),(0,ot.Z)(this,"layer",void 0),(0,ot.Z)(this,"renderFlag",void 0),(0,ot.Z)(this,"width",0),(0,ot.Z)(this,"height",0),this.postProcessor=i}setLayer(i){this.layer=i}setRenderFlag(i){this.renderFlag=i}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var i=this;return(0,ln.Z)(function*(){for(const s of i.passes)yield s.render(i.layer);yield i.postProcessor.render(i.layer)})()}resize(i,s){(this.width!==i||this.height!==s)&&(this.postProcessor.resize(i,s),this.width=i,this.height=s)}add(i,s){i.getType()===Qu.PostProcessing?this.postProcessor.add(i,this.layer,s):(i.init(this.layer,s),this.passes.push(i))}insert(i,s,f){i.init(this.layer,s),this.passes.splice(f,0,i)}destroy(){this.passes.length=0}}class DA extends Jr{constructor(...i){var s;super(...i),s=this,(0,ot.Z)(this,"pickingFBO",void 0),(0,ot.Z)(this,"layer",void 0),(0,ot.Z)(this,"width",0),(0,ot.Z)(this,"height",0),(0,ot.Z)(this,"alreadyInRendering",!1),(0,ot.Z)(this,"pickFromPickingFBO",({x:f,y:p,lngLat:y,type:x})=>{if(!this.layer.isVisible()||!this.layer.needPick(x))return;const{getViewportSize:O,readPixelsAsync:A,useFramebuffer:I}=this.rendererService,{width:B,height:j}=O(),{enableHighlight:V,enableSelect:mt}=this.layer.getLayerConfig(),Bt=f*Mo,Kt=p*Mo;if(Bt>B||Bt<0||Kt>j||Kt<0)return;let ue;I(this.pickingFBO,(0,ln.Z)(function*(){var Le;if(ue=yield A({x:Math.round(Bt),y:Math.round(j-(p+1)*Mo),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:s.pickingFBO}),ue[0]!==0||ue[1]!==0||ue[2]!==0){const ke=dc(ue),He=s.layer.getSource().getFeatureById(ke),Ye={x:f,y:p,type:x,lngLat:y,featureId:ke,feature:He};He&&(s.layer.setCurrentPickId(ke),s.triggerHoverOnLayer(Ye))}else{const ke={x:f,y:p,lngLat:y,type:s.layer.getCurrentPickId()===null?"un"+x:"mouseout",featureId:null,feature:null};s.triggerHoverOnLayer((0,on.Z)((0,on.Z)({},ke),{},{type:"unpick"})),s.triggerHoverOnLayer(ke),s.layer.setCurrentPickId(null)}V&&s.highlightPickedFeature(ue),mt&&x==="click"&&((Le=ue)===null||Le===void 0?void 0:Le.toString())!==[0,0,0,0].toString()&&s.selectFeature(ue)}))})}getType(){return Qu.Normal}getName(){return"pixelPicking"}init(i,s){super.init(i,s),this.layer=i;const{createTexture2D:f,createFramebuffer:p,getViewportSize:y}=this.rendererService,{width:x,height:O}=y(),A=f({width:x,height:O,wrapS:dt.CLAMP_TO_EDGE,wrapT:dt.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=p({color:A}),this.interactionService.on(Co.Hover,this.pickFromPickingFBO),this.interactionService.on(Co.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Co.Active,this.highlightFeatureHandle.bind(this))}render(i){if(this.alreadyInRendering)return;const{getViewportSize:s,useFramebuffer:f,clear:p}=this.rendererService,{width:y,height:x}=s();this.alreadyInRendering=!0,(this.width!==y||this.height!==x)&&(this.pickingFBO.resize({width:y,height:x}),this.width=y,this.height=x),f(this.pickingFBO,()=>{p({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const O=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(O),this.alreadyInRendering=!1})}triggerHoverOnLayer(i){this.layer.emit(i.type,i)}highlightPickedFeature(i){const[s,f,p]=i;this.layer.hooks.beforeHighlight.call([s,f,p]),this.layerService.renderLayers()}selectFeature(i){const[s,f,p]=i;this.layer.hooks.beforeSelect.call([s,f,p]),this.layerService.renderLayers()}selectFeatureHandle({featureId:i}){const s=ul(i);this.selectFeature(new Uint8Array(s))}highlightFeatureHandle({featureId:i}){const s=ul(i);this.highlightPickedFeature(new Uint8Array(s))}}class NA{constructor(i){(0,ot.Z)(this,"passes",[]),(0,ot.Z)(this,"readFBO",void 0),(0,ot.Z)(this,"writeFBO",void 0),this.rendererService=i,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:i,createTexture2D:s}=this.rendererService,{width:f,height:p}=i();return s({x:0,y:0,width:f,height:p,copy:!0})}getReadFBOTex(){var i=this;const{useFramebuffer:s}=this.rendererService;return new Promise(f=>{s(this.readFBO,(0,ln.Z)(function*(){f(i.getCurrentFBOTex())}))})}renderBloomPass(i,s){var f=this;return(0,ln.Z)(function*(){const p=yield f.getReadFBOTex();let y=0;for(;y<4;)yield s.render(i,p),f.swap(),y++})()}render(i){var s=this;return(0,ln.Z)(function*(){for(let f=0;f<s.passes.length;f++){const p=s.passes[f];p.setRenderToScreen(s.isLastEnabledPass(f)),p.getName()==="bloom"?yield s.renderBloomPass(i,p):(yield p.render(i),f!==s.passes.length-1&&s.swap())}})()}resize(i,s){this.readFBO.resize({width:i,height:s}),this.writeFBO.resize({width:i,height:s})}add(i,s,f){i.init(s,f),this.passes.push(i)}insert(i,s,f,p){i.init(f,p),this.passes.splice(s,0,i)}getPostProcessingPassByName(i){return this.passes.find(s=>s.getName()===i)}init(){const{createFramebuffer:i,createTexture2D:s}=this.rendererService;this.readFBO=i({color:s({width:1,height:1,wrapS:dt.CLAMP_TO_EDGE,wrapT:dt.CLAMP_TO_EDGE,usage:Pl.RENDER_TARGET})}),this.writeFBO=i({color:s({width:1,height:1,wrapS:dt.CLAMP_TO_EDGE,wrapT:dt.CLAMP_TO_EDGE,usage:Pl.RENDER_TARGET})})}isLastEnabledPass(i){for(let s=i+1;s<this.passes.length;s++)if(this.passes[s].isEnabled())return!1;return!0}swap(){const i=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=i}}class FA extends Jr{getType(){return Qu.Normal}getName(){return"render"}init(i,s){super.init(i,s)}render(i){const{useFramebuffer:s,clear:f}=this.rendererService,p=i.multiPassRenderer.getPostProcessor().getReadFBO();s(p,()=>{f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:p}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(y=>{y.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}const BA=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,jA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`,{isNil:qg}=hi;class mb extends Qn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:jA,fs:BA});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}convertOptionsToUniforms(i){const s={};return qg(i.bloomRadius)||(s.u_radius=i.bloomRadius),qg(i.bloomIntensity)||(s.u_intensity=i.bloomIntensity),qg(i.bloomBaseRadio)||(s.u_baseRadio=i.bloomBaseRadio),s}}const Ih=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,yb=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`,{isNil:_b}=hi;class zA extends Qn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:yb,fs:Ih});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}convertOptionsToUniforms(i){const s={};return _b(i.blurRadius)||(s.u_BlurDir=[i.blurRadius,0]),s}}const Ra=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,UA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`,{isNil:ZA}=hi;class bb extends Qn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:UA,fs:Ra});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}convertOptionsToUniforms(i){const s={};return ZA(i.blurRadius)||(s.u_BlurDir=[0,i.blurRadius]),s}}const HA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Rh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`;class xb extends Qn{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Rh,fs:HA});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}}const Sb=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}
`,wb=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`;class WA extends Qn{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:wb,fs:Sb}),this.shaderModuleService.getModule("copy-pass")}}const VA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,GA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`;class Ob extends Qn{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:GA,fs:VA});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}}const $A=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,YA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`;class XA extends Qn{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:YA,fs:$A});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("ink-pass"),{width:p,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,on.Z)((0,on.Z)({},f),{},{u_ViewportSize:[p,y]})}}}const qA=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,KA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`;class QA extends Qn{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:KA,fs:qA}),this.shaderModuleService.getModule("noise-pass")}}const JA=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0.0, 1.0);
}
`,tT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class eT extends Qn{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:JA,fs:tT}),this.shaderModuleService.getModule("sepia-pass")}}const Eb=new Y_;let Ab=0;function Ns(){const a=new Xg,i=new Rg,s=new gA,f=new so(s),p=new dA,y=new pA,x=new mA,O=new Pg,A=new vA,I={id:`${Ab++}`,globalConfigService:Eb,shaderModuleService:a,debugService:i,cameraService:s,coordinateSystemService:f,fontService:p,iconService:y,markerService:x,popupService:O,controlService:A,customRenderService:{}},B=new SA(I);I.layerService=B;const j=new Il(I);I.sceneService=j;const V=new yA(I);I.interactionService=V;const mt=new Q_(I);I.pickingService=mt;const Bt={clear:new cI,pixelPicking:new DA,render:new FA};I.normalPassFactory=ue=>Bt[ue];const Kt={copy:new WA,bloom:new mb,blurH:new zA,blurV:new bb,noise:new QA,sepia:new eT,colorHalftone:new xb,hexagonalPixelate:new Ob,ink:new XA};return I.postProcessingPass=Kt,I.postProcessingPassFactory=ue=>Kt[ue],I}function Dl(a){const i=(0,on.Z)({},a);return i.postProcessor=new NA(i.rendererService),i.multiPassRenderer=new vb(i.postProcessor),i.styleAttributeService=new sI(i.rendererService),i}const kh=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let co=function(a){return a.IMAGE="image",a.CUSTOMIMAGE="customImage",a.ARRAYBUFFER="arraybuffer",a.RGB="rgb",a.TERRAINRGB="terrainRGB",a.CUSTOMRGB="customRGB",a.CUSTOMARRAYBUFFER="customArrayBuffer",a.CUSTOMTERRAINRGB="customTerrainRGB",a}({});var Tb=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),Mb=(a,i,s,f)=>Tb(void 0,null,function*(){return new Promise((p,y)=>{i({x:a.x,y:a.y,z:a.z},(x,O)=>{if(x||O.length===0){y(x);return}O&&xg([{data:O,bands:[0]}],s,f,(A,I)=>{A?y(A):I&&p(I)})})})}),Cb=(a,i)=>Tb(void 0,null,function*(){return new Promise((s,f)=>{i({x:a.x,y:a.y,z:a.z},(p,y)=>{if(p||!y){f(p);return}y instanceof ArrayBuffer?ee(y,(x,O)=>{x&&f(x),s(O)}):y instanceof HTMLImageElement?s(y):f(p)})})});function Kg(a,i){return Array.isArray(a)?typeof a[0]=="string"?a.map(s=>Ma(s,i)):a.map(s=>({url:Ma(s.url,i),bands:s.bands||[0]})):Ma(a,i)}function Dh(a){return typeof a=="string"?[{url:a,bands:[0]}]:typeof a[0]=="string"?a.map(i=>({url:i,bands:[0]})):a}function Pb(a,i){a.xhrCancel=()=>{i.map(s=>{s.abort()})}}var Qg=Object.defineProperty,nT=Object.defineProperties,Lb=Object.getOwnPropertyDescriptors,df=Object.getOwnPropertySymbols,rT=Object.prototype.hasOwnProperty,iT=Object.prototype.propertyIsEnumerable,Ib=(a,i,s)=>i in a?Qg(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Jg=(a,i)=>{for(var s in i||(i={}))rT.call(i,s)&&Ib(a,s,i[s]);if(df)for(var s of df(i))iT.call(i,s)&&Ib(a,s,i[s]);return a},Nh=(a,i)=>nT(a,Lb(i)),Fh=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),tv=(a,i,s,f,p)=>Fh(void 0,null,function*(){const y=Dh(i.url);if(y.length>1){const{rasterFiles:x,xhrList:O,errList:A}=yield Bh(y,i);if(Pb(a,O),A.length>0){s(A,null);return}xg(x,f,p,s)}else{const x=io(i,(O,A)=>{if(O)s(O);else if(A){const I=[{data:A,bands:y[0].bands}];xg(I,f,p,s)}});Pb(a,[x])}});function Bh(a,i){return Fh(this,null,function*(){const s=[],f=[],p=[];for(let y=0;y<a.length;y++){const x=a[y],O=Nh(Jg({},i),{url:x.url}),A=x.bands,{err:I,data:B,xhr:j}=yield Ii(Nh(Jg({},O),{type:"arrayBuffer"}));I&&p.push(I),f.push(j),s.push({data:B,bands:A})}return{rasterFiles:s,xhrList:f,errList:p}})}var lI=Object.defineProperty,oT=Object.defineProperties,aT=Object.getOwnPropertyDescriptors,Rb=Object.getOwnPropertySymbols,sT=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,Db=(a,i,s)=>i in a?lI(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,jh=(a,i)=>{for(var s in i||(i={}))sT.call(i,s)&&Db(a,s,i[s]);if(Rb)for(var s of Rb(i))kb.call(i,s)&&Db(a,s,i[s]);return a},Fs=(a,i)=>oT(a,aT(i)),hf=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),uI=(a,i,s,f)=>hf(void 0,null,function*(){const{format:p=lT,operation:y,requestParameters:x={}}=f,O=Fs(jh({},x),{url:Kg(a,i)});return new Promise((A,I)=>{tv(s,O,(B,j)=>{B?I(B):j&&A(j)},p,y)})}),cT=(a,i,s,f)=>hf(void 0,null,function*(){let p;const y=Array.isArray(a)?a[0]:a;return f.wmtsOptions?p=((f==null?void 0:f.getURLFromTemplate)||ME)(y,jh(jh({},i),f.wmtsOptions)):p=((f==null?void 0:f.getURLFromTemplate)||Ma)(y,i),new Promise((x,O)=>{var A;const I=_t(Fs(jh({},f==null?void 0:f.requestParameters),{url:p,type:((A=f==null?void 0:f.requestParameters)==null?void 0:A.type)||"arrayBuffer"}),(B,j)=>{B?O(B):j&&x(j)},f.transformResponse);s.xhrCancel=()=>I.cancel()})}),lT=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),fI=Object.defineProperty,dI=Object.defineProperties,hI=Object.getOwnPropertyDescriptors,uT=Object.getOwnPropertySymbols,Nb=Object.prototype.hasOwnProperty,Fb=Object.prototype.propertyIsEnumerable,Bb=(a,i,s)=>i in a?fI(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,zh=(a,i)=>{for(var s in i||(i={}))Nb.call(i,s)&&Bb(a,s,i[s]);if(uT)for(var s of uT(i))Fb.call(i,s)&&Bb(a,s,i[s]);return a},fT=(a,i)=>dI(a,hI(i)),jb={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},dT=[co.ARRAYBUFFER,co.RGB];function zb(a){return!!(Array.isArray(a)&&a.length===0||!Array.isArray(a)&&typeof a!="string")}function ka(a,i={}){if(zb(a))throw new Error("tile server url is error");const{extent:s=[1/0,1/0,-1/0,-1/0],coordinates:f}=i;let p=(i==null?void 0:i.dataType)||co.IMAGE;p===co.RGB&&(p=co.ARRAYBUFFER);const y=(A,I)=>{switch(p){case co.IMAGE:return cT(a,A,I,i);case co.CUSTOMIMAGE:case co.CUSTOMTERRAINRGB:return Cb(I,i==null?void 0:i.getCustomData);case co.ARRAYBUFFER:return uI(a,A,I,i);case co.CUSTOMARRAYBUFFER:case co.CUSTOMRGB:return Mb(I,i==null?void 0:i.getCustomData,(i==null?void 0:i.format)||lT,i==null?void 0:i.operation);default:return cT(a,A,I,i)}},x=fT(zh(zh({},jb),i),{getTileData:y}),O=gl(f,s);return{data:a,dataArray:[{_id:1,coordinates:O}],tilesetOptions:x,isTile:!0}}var ea=Object.defineProperty,hT=Object.defineProperties,Ub=Object.getOwnPropertyDescriptors,ii=Object.getOwnPropertySymbols,pT=Object.prototype.hasOwnProperty,_i=Object.prototype.propertyIsEnumerable,Uh=(a,i,s)=>i in a?ea(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,gT=(a,i)=>{for(var s in i||(i={}))pT.call(i,s)&&Uh(a,s,i[s]);if(ii)for(var s of ii(i))_i.call(i,s)&&Uh(a,s,i[s]);return a},vT=(a,i)=>hT(a,Ub(i)),mT=(a,i)=>{var s={};for(var f in a)pT.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&ii)for(var f of ii(a))i.indexOf(f)<0&&_i.call(a,f)&&(s[f]=a[f]);return s};function Zb(a,i){const s=i,{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:p,width:y,height:x}=s,O=mT(s,["extent","coordinates","width","height"]);a.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[A,I]=O.bands||[0,1],B=[a[A],a[I]],j=[];for(let Bt=0;Bt<B[0].length;Bt++)j.push((B[1][Bt]-B[0][Bt])/(B[1][Bt]+B[0][Bt]));const V=gl(p,f);return{_id:1,dataArray:[vT(gT({_id:1,data:j,width:y,height:x},O),{coordinates:V})]}}var Hb=Object.defineProperty,yT=Object.defineProperties,_T=Object.getOwnPropertyDescriptors,Zh=Object.getOwnPropertySymbols,Wb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,Gb=(a,i,s)=>i in a?Hb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,bT=(a,i)=>{for(var s in i||(i={}))Wb.call(i,s)&&Gb(a,s,i[s]);if(Zh)for(var s of Zh(i))Vb.call(i,s)&&Gb(a,s,i[s]);return a},$b=(a,i)=>yT(a,_T(i)),xT=(a,i)=>{var s={};for(var f in a)Wb.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&Zh)for(var f of Zh(a))i.indexOf(f)<0&&Vb.call(a,f)&&(s[f]=a[f]);return s};function ST(a,i){const s=i,{extent:f,coordinates:p,width:y,height:x}=s,O=xT(s,["extent","coordinates","width","height"]);a.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[A,I,B]=O.bands||[0,1,2],j=[a[A],a[I],a[B]],V=[],[mt,Bt]=(O==null?void 0:O.countCut)||[2,98],Kt=(O==null?void 0:O.RMinMax)||_o(j[0],mt,Bt),ue=(O==null?void 0:O.GMinMax)||_o(j[1],mt,Bt),Le=(O==null?void 0:O.BMinMax)||_o(j[2],mt,Bt);for(let Ye=0;Ye<j[0].length;Ye++)V.push(Math.max(0,j[0][Ye]-Kt[0])),V.push(Math.max(0,j[1][Ye]-ue[0])),V.push(Math.max(0,j[2][Ye]-Le[0]));const ke=gl(p,f);return{_id:1,dataArray:[$b(bT({_id:1,data:V,width:y,height:x,rMinMax:Kt,gMinMax:ue,bMinMax:Le},O),{coordinates:ke})]}}var wT=Object.defineProperty,OT=Object.defineProperties,Yb=Object.getOwnPropertyDescriptors,Hh=Object.getOwnPropertySymbols,Xb=Object.prototype.hasOwnProperty,qb=Object.prototype.propertyIsEnumerable,Kb=(a,i,s)=>i in a?wT(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,ET=(a,i)=>{for(var s in i||(i={}))Xb.call(i,s)&&Kb(a,s,i[s]);if(Hh)for(var s of Hh(i))qb.call(i,s)&&Kb(a,s,i[s]);return a},AT=(a,i)=>OT(a,Yb(i)),TT=(a,i)=>{var s={};for(var f in a)Xb.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&Hh)for(var f of Hh(a))i.indexOf(f)<0&&qb.call(a,f)&&(s[f]=a[f]);return s};function MT(a,i){const s=i,{extent:f,coordinates:p,min:y,max:x,width:O,height:A,format:I,operation:B}=s,j=TT(s,["extent","coordinates","min","max","width","height","format","operation"]);let V;if(I===void 0||Cs(a))V=Array.from(a);else{const Kt=Array.isArray(a)?a:[a];V=_g(Kt,I,B)}const mt=gl(p,f);return{_id:1,dataArray:[AT(ET({_id:1,data:V,width:O,height:A},j),{min:y,max:x,coordinates:mt})]}}var CT=Object.defineProperty,PT=Object.defineProperties,Er=Object.getOwnPropertyDescriptors,Qb=Object.getOwnPropertySymbols,LT=Object.prototype.hasOwnProperty,Jb=Object.prototype.propertyIsEnumerable,ev=(a,i,s)=>i in a?CT(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,tx=(a,i)=>{for(var s in i||(i={}))LT.call(i,s)&&ev(a,s,i[s]);if(Qb)for(var s of Qb(i))Jb.call(i,s)&&ev(a,s,i[s]);return a},IT=(a,i)=>PT(a,Er(i)),pI=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),RT={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Da=a=>pI(void 0,null,function*(){return new Promise(i=>{const[s,f,p,y]=a.bounds,x={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,x:(s+p)/2,y:(f+y)/2},geometry:{type:"LineString",coordinates:[[p,y],[p,f],[s,f],[s,f]]}}]}}};i(x)})});function Cc(a,i){const s=p=>Da(p),f=IT(tx(tx({},RT),i),{getTileData:s});return{data:a,dataArray:[],tilesetOptions:f,isTile:!0}}var ex=L(69848),kT=L.n(ex),nx=Object.defineProperty,rx=Object.getOwnPropertySymbols,DT=Object.prototype.hasOwnProperty,NT=Object.prototype.propertyIsEnumerable,FT=(a,i,s)=>i in a?nx(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Ci=(a,i)=>{for(var s in i||(i={}))DT.call(i,s)&&FT(a,s,i[s]);if(rx)for(var s of rx(i))NT.call(i,s)&&FT(a,s,i[s]);return a};function ix(a,i){const{radius:s=40,maxZoom:f=18,minZoom:p=0,zoom:y=2}=i;if(a.pointIndex){const A=a.pointIndex.getClusters(a.extent,Math.floor(y));return a.dataArray=BT(A),a}const x=new(kT())({radius:s,minZoom:p,maxZoom:f}),O={type:"FeatureCollection",features:[]};return O.features=a.dataArray.map(A=>({type:"Feature",geometry:{type:"Point",coordinates:A.coordinates},properties:Ci({},A)})),x.load(O.features),x}function BT(a){return a.map((i,s)=>Ci({coordinates:i.geometry.coordinates,_id:s+1},i.properties))}function ox(a){if(a.length===0)throw new Error("max requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]>i&&(i=a[s]);return i}function Pc(a){if(a.length===0)throw new Error("min requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]<i&&(i=a[s]);return i}function nv(a){if(a.length===0)return 0;let i=a[0],s=0,f;for(let p=1;p<a.length;p++)f=i+a[p]*1,Math.abs(i)>=Math.abs(a[p])?s+=i-f+a[p]:s+=a[p]-f+i,i=f;return i+s*1}function ax(a){if(a.length===0)throw new Error("mean requires at least one data point");return nv(a)/a.length}var jT={min:Pc,max:ox,mean:ax,sum:nv},zT=Object.defineProperty,sx=Object.getOwnPropertySymbols,UT=Object.prototype.hasOwnProperty,ZT=Object.prototype.propertyIsEnumerable,cx=(a,i,s)=>i in a?zT(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,pf=(a,i)=>{for(var s in i||(i={}))UT.call(i,s)&&cx(a,s,i[s]);if(sx)for(var s of sx(i))ZT.call(i,s)&&cx(a,s,i[s]);return a},lx=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),{cloneDeep:Nl,isFunction:Fl,isString:HT,mergeWith:ux}=hi;function gf(a,i){if(Array.isArray(i))return i}var WT=class extends No.EventEmitter{constructor(a,i){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new pa},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=a,this.initCfg(i),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}getClustersLeaves(a){return this.clusterIndex.getLeaves(a,1/0)}getParserType(){return this.parser.type}updateClusterData(a){const{method:i="sum",field:s}=this.clusterOptions;let f=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,f.forEach(p=>{p.id||(p.properties.point_count=1)}),(s||Fl(i))&&(f=f.map(p=>{const y=p.id;if(y){const O=this.clusterIndex.getLeaves(y,1/0).map(I=>I.properties);let A;if(HT(i)&&s){const I=F7(O,s);A=jT[i](I)}Fl(i)&&(A=i(O)),p.properties.stat=A}else p.properties.point_count=1;return p})),this.data=yt("geojson")({type:"FeatureCollection",features:f}),this.executeTrans()}getFeatureById(a){const{type:i="geojson",geometry:s}=this.parser;if(i==="geojson"&&!this.cluster){const f=a<this.originData.features.length?this.originData.features[a]:"null",p=Nl(f);if(p!=null&&p.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const y=this.data.dataArray.find(x=>x._id===a);p.properties=y}return p}else return i==="json"&&s?this.data.dataArray.find(f=>f._id===a):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}updateFeaturePropertiesById(a,i){this.data.dataArray=this.data.dataArray.map(s=>s._id===a?pf(pf({},s),i):s),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(a,i){const s=this.data.dataArray.find(f=>f[a]===i);return s==null?void 0:s._id}setData(a,i){this.originData=a,this.dataArrayChanged=!1,this.initCfg(i),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var a;(a=this.tileset)==null||a.reloadAll()}reloadTilebyId(a,i,s){var f;(f=this.tileset)==null||f.reloadTileById(a,i,s)}reloadTileByLnglat(a,i,s){var f;(f=this.tileset)==null||f.reloadTileByLnglat(a,i,s)}getTileExtent(a,i){var s;return(s=this.tileset)==null?void 0:s.getTileExtent(a,i)}getTileByZXY(a,i,s){var f;return(f=this.tileset)==null?void 0:f.getTileByZXY(a,i,s)}reloadTileByExtent(a,i){var s;(s=this.tileset)==null||s.reloadTileByExtent(a,i)}destroy(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)==null||a.destroy()}processData(){return lx(this,null,function*(){return new Promise((a,i)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),a({})}catch(s){i(s)}})})}initCfg(a){this.cfg=ux(this.cfg,a,gf);const i=this.cfg;i&&(i.parser&&(this.parser=i.parser),i.transforms&&(this.transforms=i.transforms),this.cluster=i.cluster||!1,i.clusterOptions&&(this.cluster=!0,this.clusterOptions=pf(pf({},this.clusterOptions),i.clusterOptions)))}init(){return lx(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const a=this.parser,i=a.type||"geojson",s=yt(i);this.data=s(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=oE(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:a}=this.data;return a?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(a),this.tileset):new s_(pf({},a))):void 0}executeTrans(){this.transforms.forEach(i=>{const{type:s}=i,f=Ot(s)(this.data,i);Object.assign(this.data,f)})}initCluster(){if(!this.cluster)return;const a=this.clusterOptions||{};this.clusterIndex=ix(this.data,a)}caculClusterExtent(a){let i=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(i=Dd(Nd(this.extent),a)),i[0].concat(i[1])}};function gI(a,i){const{callback:s}=i;return s&&(a.dataArray=a.dataArray.filter(s)),a}var Wh=6378e3;function VT(a,i){const s=a.dataArray,{size:f=10}=i,p=f/(2*Math.PI*Wh)*(256<<20)/2,{gridHash:y,gridOffset:x}=GT(s,f),O=qT(y,x,i);return{yOffset:p,xOffset:p,radius:p,type:"grid",dataArray:O}}function GT(a,i){let s=1/0,f=-1/0,p;for(const A of a)p=A.coordinates[1],Number.isFinite(p)&&(s=p<s?p:s,f=p>f?p:f);const y=(s+f)/2,x=$T(i,y);if(x.xOffset<=0||x.yOffset<=0)return{gridHash:{},gridOffset:x};const O={};for(const A of a){const I=A.coordinates[1],B=A.coordinates[0];if(Number.isFinite(I)&&Number.isFinite(B)){const j=Math.floor((I+90)/x.yOffset),V=Math.floor((B+180)/x.xOffset),mt=`${j}-${V}`;O[mt]=O[mt]||{count:0,points:[]},O[mt].count+=1,O[mt].points.push(A)}}return{gridHash:O,gridOffset:x}}function $T(a,i){const s=YT(a),f=XT(i,a);return{yOffset:s,xOffset:f}}function YT(a){return a/Wh*(180/Math.PI)}function XT(a,i){return i/Wh*(180/Math.PI)/Math.cos(a*Math.PI/180)}function qT(a,i,s){return Object.keys(a).reduce((f,p,y)=>{const x=p.split("-"),O=parseInt(x[0],10),A=parseInt(x[1],10),I={};if(s.field&&s.method){const B=Bd(a[p].points,s.field);I[s.method]=Y1[s.method](B)}return Object.assign(I,{_id:y,coordinates:wo([-180+i.xOffset*(A+.5),-90+i.yOffset*(O+.5)]),rawData:a[p].points,count:a[p].count}),f.push(I),f},[])}var Bl=Math.PI/3,KT=[0,Bl,2*Bl,3*Bl,4*Bl,5*Bl];function QT(a){return a[0]}function rv(a){return a[1]}function Vh(){var a=0,i=0,s=1,f=1,p=QT,y=rv,x,O,A;function I(j){var V={},mt=[],Bt,Kt=j.length;for(Bt=0;Bt<Kt;++Bt)if(!(isNaN(Le=+p.call(null,ue=j[Bt],Bt,j))||isNaN(ke=+y.call(null,ue,Bt,j)))){var ue,Le,ke,He=Math.round(ke=ke/A),Ye=Math.round(Le=Le/O-(He&1)/2),rn=ke-He;if(Math.abs(rn)*3>1){var bn=Le-Ye,hn=Ye+(Le<Ye?-1:1)/2,Cn=He+(ke<He?-1:1),Jn=Le-hn,cr=ke-Cn;bn*bn+rn*rn>Jn*Jn+cr*cr&&(Ye=hn+(He&1?1:-1)/2,He=Cn)}var Gn=Ye+"-"+He,ar=V[Gn];ar?ar.push(ue):(mt.push(ar=V[Gn]=[ue]),ar.x=(Ye+(He&1)/2)*O,ar.y=He*A)}return mt}function B(j){var V=0,mt=0;return KT.map(function(Bt){var Kt=Math.sin(Bt)*j,ue=-Math.cos(Bt)*j,Le=Kt-V,ke=ue-mt;return V=Kt,mt=ue,[Le,ke]})}return I.hexagon=function(j){return"m"+B(j==null?x:+j).join("l")+"z"},I.centers=function(){for(var j=[],V=Math.round(i/A),mt=Math.round(a/O),Bt=V*A;Bt<f+x;Bt+=A,++V)for(var Kt=mt*O+(V&1)*O/2;Kt<s+O/2;Kt+=O)j.push([Kt,Bt]);return j},I.mesh=function(){var j=B(x).slice(0,4).join("l");return I.centers().map(function(V){return"M"+V+"m"+j}).join("")},I.x=function(j){return arguments.length?(p=j,I):p},I.y=function(j){return arguments.length?(y=j,I):y},I.radius=function(j){return arguments.length?(x=+j,O=x*2*Math.sin(Bl),A=x*1.5,I):x},I.size=function(j){return arguments.length?(a=i=0,s=+j[0],f=+j[1],I):[s-a,f-i]},I.extent=function(j){return arguments.length?(a=+j[0][0],i=+j[0][1],s=+j[1][0],f=+j[1][1],I):[[a,i],[s,f]]},I.radius(1)}var JT=Object.defineProperty,tM=Object.defineProperties,Gh=Object.getOwnPropertyDescriptors,fx=Object.getOwnPropertySymbols,eM=Object.prototype.hasOwnProperty,nM=Object.prototype.propertyIsEnumerable,dx=(a,i,s)=>i in a?JT(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,rM=(a,i)=>{for(var s in i||(i={}))eM.call(i,s)&&dx(a,s,i[s]);if(fx)for(var s of fx(i))nM.call(i,s)&&dx(a,s,i[s]);return a},iM=(a,i)=>tM(a,Gh(i)),iv=6378e3;function oM(a,i){const s=a.dataArray,{size:f=10,method:p="sum"}=i,y=f/(2*Math.PI*iv)*(256<<20)/2,x=s.map(B=>{const[j,V]=wo(B.coordinates);return iM(rM({},B),{coordinates:[j,V]})});return{dataArray:Vh().radius(y).x(B=>B.coordinates[0]).y(B=>B.coordinates[1])(x).map((B,j)=>{if(i.field&&p){const V=Bd(B,i.field);B[p]=Y1[p](V)}return{[i.method]:B[p],count:B.length,rawData:B,coordinates:[B.x,B.y],_id:j}}),radius:y,xOffset:y,yOffset:y,type:"hexagon"}}var aM=Object.defineProperty,hx=Object.getOwnPropertySymbols,Bs=Object.prototype.hasOwnProperty,px=Object.prototype.propertyIsEnumerable,$h=(a,i,s)=>i in a?aM(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,ov=(a,i)=>{for(var s in i||(i={}))Bs.call(i,s)&&$h(a,s,i[s]);if(hx)for(var s of hx(i))px.call(i,s)&&$h(a,s,i[s]);return a};function sM(a,i){const{sourceField:s,targetField:f,data:p}=i,y={};return p.forEach(x=>{y[x[s]]=x}),a.dataArray=a.dataArray.map(x=>{const O=x[f];return ov(ov({},x),y[O])}),a}function gx(a,i){const{callback:s}=i;return s&&(a.dataArray=a.dataArray.map(s)),a}var vI=L(4771),vf=Object.defineProperty,Lc=Object.defineProperties,cM=Object.getOwnPropertyDescriptors,mf=Object.getOwnPropertySymbols,av=Object.prototype.hasOwnProperty,vx=Object.prototype.propertyIsEnumerable,bi=(a,i,s)=>i in a?vf(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,yf=(a,i)=>{for(var s in i||(i={}))av.call(i,s)&&bi(a,s,i[s]);if(mf)for(var s of mf(i))vx.call(i,s)&&bi(a,s,i[s]);return a},pi=(a,i)=>Lc(a,cM(i));function na(a){let i=1/0,s=-1/0,f=1/0,p=-1/0;a.forEach(O=>{const A=O.coordinates;if(!A)return;const I=B=>{if(typeof B[0]=="number"&&typeof B[1]=="number"){const[j,V]=B;i=Math.min(i,j),s=Math.max(s,j),f=Math.min(f,V),p=Math.max(p,V)}else Array.isArray(B[0])&&B.forEach(I)};I(A)});const y=(i+s)/2,x=(f+p)/2;return[y,x]}function jl(a,i){const[s,f]=i;return a.map(p=>{if(!p.coordinates)return p;const y=x=>{if(typeof x[0]=="number"&&typeof x[1]=="number"){const O=Number((x[0]-s).toPrecision(15)),A=Number((x[1]-f).toPrecision(15));return[O,A,...x.slice(2)||[]]}else if(Array.isArray(x[0]))return x.map(y);return x};return pi(yf({},p),{coordinates:y(p.coordinates)})})}function lM(a,i){const[s,f]=i;return a.map(p=>{if(!p.coordinates)return p;const y=x=>{if(typeof x[0]=="number"&&typeof x[1]=="number"){const O=x[0]+s,A=x[1]+f;return[O,A,...x.slice(2)||[]]}else if(Array.isArray(x[0]))return x.map(y);return x};return pi(yf({},p),{coordinates:y(p.coordinates)})})}function sv(a,i={}){const{enableRelativeCoordinates:s=!1,relativeOrigin:f}=i;if(!s)return{dataArray:a,relativeOrigin:[0,0],originalExtent:[0,0,0,0]};let p=1/0,y=-1/0,x=1/0,O=-1/0;a.forEach(j=>{const V=j.coordinates;if(!V)return;const mt=Bt=>{if(typeof Bt[0]=="number"&&typeof Bt[1]=="number"){const[Kt,ue]=Bt;p=Math.min(p,Kt),y=Math.max(y,Kt),x=Math.min(x,ue),O=Math.max(O,ue)}else Array.isArray(Bt[0])&&Bt.forEach(mt)};mt(V)});const A=[p,x,y,O],I=f||na(a);return{dataArray:jl(a,I),relativeOrigin:I,originalExtent:A}}G("rasterTile",ka),G("mvt",KE),G("geojsonvt",Pa),G("testTile",Cc),G("geojson",rr),G("jsonTile",oh),G("image",w_),G("csv",RE),G("json",IE),G("raster",rA),G("rasterRgb",MT),G("rgb",ST),G("ndi",Zb),bt("cluster",ix),bt("filter",gI),bt("join",sM),bt("map",gx),bt("grid",VT),bt("hexagon",oM);var mx=WT;class Zn extends null{getMarkerLayerContainerSize(){}constructor(i){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",s=>{const f=this.mapsService.getContainer();if(!f)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:p,top:y}=f.getClientRects()[0],{x,y:O}=s;this.preLngLat=this.mapsService.containerToLngLat([x-p,O-y]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",s=>{const f=s.lngLat||s.lnglat,{lng:p,lat:y}=this.preLngLat,{lng:x,lat:O}=f,A={lng:this.lngLat.lng+x-p,lat:this.lngLat.lat+O-y};this.setLnglat(A),this.preLngLat=f,this.emit("dragging",A)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",s=>{this.polyfillEvent(s),this.emit(s.type,{target:s,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),i),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(i){this.scene=i,this.mapsService=i.mapService;const{element:s}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(s),this.registerMarkerEvent(s),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:i}=this.markerOption;return i&&DOM.remove(i),this.popup&&this.popup.remove(),this}setLnglat(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(i){if(!this.added)return this.once("added",()=>{this.setElement(i)}),this;const{element:s}=this.markerOption;return s&&DOM.remove(s),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const i=this.popup;return i?(i.isOpen()||i.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const i=this.popup;return i&&i.remove(),this}setPopup(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(i){this.markerOption.draggable=i,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(i){this.markerOption.extData=i}update(){if(!this.mapsService)return;const{element:i,anchor:s}=this.markerOption;this.updatePosition(),DOM.setTransform(i,`${anchorTranslate[s]}`)}updatePositionWhenZoom(i){if(!this.mapsService)return;const{element:s,offsets:f}=this.markerOption,{lng:p,lat:y}=this.lngLat;if(s){s.style.display="block",s.style.whiteSpace="nowrap";const{containerHeight:x,containerWidth:O,bounds:A}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!A)return;const I=i.map,B=i.center,j=i.zoom,V=I.DE(this.lngLat,j,B);if(V.x=Math.round(V.x+f[0]),V.y=Math.round(V.y-f[1]),Math.abs(A[0][0])>180||Math.abs(A[1][0])>180){if(V.x>O){const mt=this.mapsService.lngLatToContainer([p-360,y]);V.x=mt.x}if(V.x<0){const mt=this.mapsService.lngLatToContainer([p+360,y]);V.x=mt.x}}(V.x>O||V.x<0||V.y>x||V.y<0)&&(s.style.display="none"),s.style.left=V.x+"px",s.style.top=V.y+"px",s.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(i){const{element:s}=this.markerOption;this.popup&&s&&this.togglePopup()}getCurrentContainerSize(){const i=this.mapsService.getContainer();return{containerHeight:(i==null?void 0:i.scrollHeight)||0,containerWidth:(i==null?void 0:i.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:i}=this.markerOption;i==null||i.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(i==null||i.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:i,offsets:s}=this.markerOption,{lng:f,lat:p}=this.lngLat,y=this.mapsService.lngLatToContainer([f,p]);if(i){i.style.display="block",i.style.whiteSpace="nowrap";const{containerHeight:x,containerWidth:O,bounds:A}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!A)return;if(Math.abs(A[0][0])>180||Math.abs(A[1][0])>180){if(y.x>O){const I=this.mapsService.lngLatToContainer([f-360,p]);y.x=I.x}if(y.x<0){const I=this.mapsService.lngLatToContainer([f+360,p]);y.x=I.x}}this.markerOption.overflowHide&&(y.x>O||y.x<0||y.y>x||y.y<0)&&(i.style.display="none"),i.style.left=y.x+s[0]+"px",i.style.top=y.y-s[1]+"px"}}init(){let{element:i}=this.markerOption;const{color:s,anchor:f}=this.markerOption;if(!i){i=DOM.create("div"),this.markerOption.element=i;const p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height","48px"),p.setAttributeNS(null,"width","48px"),p.setAttributeNS(null,"viewBox","0 0 1024 1024");const y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),y.setAttributeNS(null,"fill",s),p.appendChild(y),i.appendChild(p)}DOM.addClass(i,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(p=>{var y,x;const O=((y=this.markerOption)===null||y===void 0?void 0:y.style)&&((x=this.markerOption)===null||x===void 0?void 0:x.style[p]);i&&(i.style[p]=O)}),applyAnchorClass(i,f,"marker")}registerMarkerEvent(i){i.addEventListener("click",this.onMapClick),i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle),i.addEventListener("touchstart",this.eventHandle),i.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const i=this.getElement();i.removeEventListener("click",this.onMapClick),i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle),i.removeEventListener("touchstart",this.eventHandle),i.removeEventListener("touchend",this.eventHandle)}polyfillEvent(i){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(i.type==="touchstart"&&(this.touchStartTime=Date.now()),i.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:i,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(i){return null}onUp(i){throw new Error("Method not implemented.")}}const{merge:uM}=hi;class mI extends null{constructor(i){var s;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=uM(this.getDefault(),i),bindAll(["update"],this),this.zoom=((s=this.markerLayerOption.clusterOption)===null||s===void 0?void 0:s.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(i){return this.scene=i,this.mapsService=i.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const i=this.mapsService.getContainer();this.containerSize={containerWidth:(i==null?void 0:i.scrollWidth)||0,containerHeight:(i==null?void 0:i.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(i){const s=this.markerLayerOption.cluster;if(i.getMarkerLayerContainerSize=this.getContainerSize.bind(this),s&&(this.addPoint(i,this.markers.length),this.mapsService)){const f=this.mapsService.getZoom(),p=this.mapsService.getBounds();this.bbox=padBounds(p,.5),this.zoom=Math.floor(f),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(i)}removeMarker(i){this.markers.indexOf(i);const s=this.markers.indexOf(i);s>-1&&(this.markers.splice(s,1),this.markerLayerOption.cluster&&(this.removePoint(s),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(i=>{i.getElement().style.opacity="0"}),this.clusterMarkers.map(i=>{i.getElement().style.opacity="0"})}show(){this.markers.map(i=>{i.getElement().style.opacity="1"}),this.clusterMarkers.map(i=>{i.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(i=>{i.addTo(this.scene)})}clear(){this.markers.forEach(i=>{i.remove()}),this.clusterMarkers.forEach(i=>{i.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(i,s){const{lng:f,lat:p}=i.getLnglat(),y={geometry:{type:"Point",coordinates:[f,p]},properties:_objectSpread(_objectSpread({},i.getExtData()),{},{marker_id:s})};this.points.push(y),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(i){const s=this.points.findIndex(f=>f.properties.marker_id===i);s>-1&&this.points.splice(s,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:i,minZoom:s=0,maxZoom:f}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:i,minZoom:s,maxZoom:f}),this.clusterIndex.load(this.points)}getClusterMarker(i,s){const f=i[0].concat(i[1]),p=this.clusterIndex.getClusters(f,s);this.clusterMarkers.forEach(y=>{y.remove()}),this.clusterMarkers=[],p.forEach(y=>{var x;const{field:O,method:A}=this.markerLayerOption.clusterOption;if((x=y.properties)!==null&&x!==void 0&&x.cluster_id){var I;const j=this.getLeaves((I=y.properties)===null||I===void 0?void 0:I.cluster_id);if(y.properties.clusterData=j,O&&A){const V=j==null?void 0:j.map(ue=>({[O]:ue.properties[O]})),mt=Satistics.getColumn(V,O),Bt=Satistics.getSatByColumn(A,mt),Kt="point_"+A;y.properties[Kt]=Bt.toFixed(2)}}const B=this.clusterMarker(y);this.clusterMarkers.push(B),B.addTo(this.scene)})}getLeaves(i,s=1/0,f=0){return i?this.clusterIndex.getLeaves(i,s,f):null}clusterMarker(i){const s=this.markerLayerOption.clusterOption,{element:f=this.generateElement.bind(this)}=s;return new Marker({element:f(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]})}normalMarker(i){const s=i.properties.marker_id;return this.markers[s]}update(){if(!this.mapsService||this.markers.length===0)return;const i=this.mapsService.getZoom(),s=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!boundsContains(this.bbox,s))&&(this.bbox=padBounds(s,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}generateElement(i){const s=DOM.create("div","l7-marker-cluster"),f=DOM.create("div","",s),p=DOM.create("span","",f),{field:y,method:x}=this.markerLayerOption.clusterOption;i.properties.point_count=i.properties.point_count||1;const O=y&&x?i.properties["point_"+x]||i.properties[y]:i.properties.point_count;return p.textContent=O,s}}var Yh=L(4157);class Ic extends jd(){constructor(i){super(),(0,ot.Z)(this,"controlOption",void 0),(0,ot.Z)(this,"container",void 0),(0,ot.Z)(this,"isShow",void 0),(0,ot.Z)(this,"sceneContainer",void 0),(0,ot.Z)(this,"scene",void 0),(0,ot.Z)(this,"mapsService",void 0),(0,ot.Z)(this,"renderService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"controlService",void 0),(0,ot.Z)(this,"configService",void 0),Ic.controlCount++,this.controlOption=(0,on.Z)((0,on.Z)({},this.getDefault(i)),i||{})}getOptions(){return this.controlOption}setOptions(i){const s=this.getDefault(i);Object.entries(i).forEach(([f,p])=>{p===void 0&&(i[f]=s[f])}),"position"in i&&this.setPosition(i.position),"className"in i&&this.setClassName(i.className),"style"in i&&this.setStyle(i.style),this.controlOption=(0,on.Z)((0,on.Z)({},this.controlOption),i)}addTo(i){this.mapsService=i.mapService,this.renderService=i.rendererService,this.layerService=i.layerService,this.controlService=i.controlService,this.configService=i.globalConfigService,this.scene=i.sceneService,this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd(),Ea(this.container,"l7-control");const{className:s,style:f}=this.controlOption;return s&&this.setClassName(s),f&&this.setStyle(f),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;Oa(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return Vi("div")}onRemove(){}show(){const i=this.container;hc(i,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const i=this.container;Ea(i,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(i){return{position:hh.TOPRIGHT,name:`${Ic.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){const s=this.mapsService.getContainer();s!==null&&s.focus()}}setPosition(i=hh.TOPLEFT){const s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=i,s&&s.addControl(this,this.sceneContainer),this}setClassName(i){const s=this.container,{className:f}=this.controlOption;f&&hc(s,f),i&&Ea(s,i)}setStyle(i){const s=this.container;i?s.setAttribute("style",i):s.removeAttribute("style")}insertContainer(){const i=this.controlOption.position,s=this.container;if(i instanceof Element)i.appendChild(s);else{const f=this.controlService.controlCorners[i];["bottomleft","bottomright","righttop","rightbottom"].includes(i)?f.insertBefore(s,f.firstChild):f.appendChild(s)}}checkUpdateOption(i,s){return s.some(f=>f in i)}}(0,ot.Z)(Ic,"controlCount",0);class cv extends null{constructor(...i){super(...i),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(i){if(this.isDisable=i,i){var s;(s=this.button)===null||s===void 0||s.setAttribute("disabled","true")}else{var f;(f=this.button)===null||f===void 0||f.removeAttribute("disabled")}}createButton(i=""){return DOM.create("button",`l7-button-control ${i}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:i,btnText:s,btnIcon:f}=this.controlOption;return this.setBtnTitle(i),this.setBtnText(s),this.setBtnIcon(f),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(i){const{title:s,btnText:f,btnIcon:p}=i;this.checkUpdateOption(i,["title"])&&this.setBtnTitle(s),this.checkUpdateOption(i,["btnIcon"])&&this.setBtnIcon(p),this.checkUpdateOption(i,["btnText"])&&this.setBtnText(f),super.setOptions(i)}setBtnTitle(i){var s;(s=this.button)===null||s===void 0||s.setAttribute("title",i!=null?i:"")}setBtnIcon(i){if(this.buttonIcon&&DOM.remove(this.buttonIcon),i){var s;const y=(s=this.button)===null||s===void 0?void 0:s.firstChild;if(y){var f;(f=this.button)===null||f===void 0||f.insertBefore(i,y)}else{var p;(p=this.button)===null||p===void 0||p.appendChild(i)}this.buttonIcon=i}}setBtnText(i){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),i){let f=this.buttonText;if(!f){var s;f=DOM.create("div","l7-button-control__text"),(s=this.button)===null||s===void 0||s.appendChild(f),this.buttonText=f}f.innerText=i,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!i&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class Na extends No.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(i,s){super(),(0,ot.Z)(this,"popperDOM",void 0),(0,ot.Z)(this,"contentDOM",void 0),(0,ot.Z)(this,"button",void 0),(0,ot.Z)(this,"option",void 0),(0,ot.Z)(this,"isShow",!1),(0,ot.Z)(this,"content",void 0),(0,ot.Z)(this,"timeout",null),(0,ot.Z)(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),hc(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&Na.conflictPopperList.forEach(f=>{f!==this&&f.isShow&&f.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),(0,ot.Z)(this,"hide",()=>this.isShow?(Ea(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),(0,ot.Z)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),(0,ot.Z)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),(0,ot.Z)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),(0,ot.Z)(this,"onPopperUnClick",f=>{P1(f.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),(0,ot.Z)(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),(0,ot.Z)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=i,this.option=s,this.init(),s.unique&&Na.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(i){typeof i=="string"?this.contentDOM.innerHTML=i:i instanceof HTMLElement&&(hl(this.contentDOM),this.contentDOM.appendChild(i)),this.content=i}init(){const{trigger:i}=this.option;this.popperDOM=this.createPopper(),i==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Oa(this.popperDOM)}resetPopperPosition(){const i={},{container:s,offset:f=[0,0],placement:p}=this.option,[y,x]=f,O=this.button.getBoundingClientRect(),A=s.getBoundingClientRect(),{left:I,right:B,top:j,bottom:V}=Ri(O,A);let mt=!1,Bt=!1;/^(left|right)/.test(p)?(p.includes("left")?i.right=`${O.width+B}px`:p.includes("right")&&(i.left=`${O.width+I}px`),p.includes("start")?i.top=`${j}px`:p.includes("end")?i.bottom=`${V}px`:(i.top=`${j+O.height/2}px`,Bt=!0,i.transform=`translate(${y}px, calc(${x}px - 50%))`)):/^(top|bottom)/.test(p)&&(p.includes("top")?i.bottom=`${O.height+V}px`:p.includes("bottom")&&(i.top=`${O.height+j}px`),p.includes("start")?i.left=`${I}px`:p.includes("end")?i.right=`${B}px`:(i.left=`${I+O.width/2}px`,mt=!0,i.transform=`translate(calc(${y}px - 50%), ${x}px)`)),i.transform=`translate(calc(${y}px - ${mt?"50%":"0%"}), calc(${x}px - ${Bt?"50%":"0%"})`;const Kt=p.split("-");Kt.length&&Ea(this.popperDOM,Kt.map(ue=>`l7-popper-${ue}`).join(" ")),z0(this.popperDOM,dl(i))}createPopper(){const{container:i,className:s="",content:f}=this.option,p=Vi("div",`l7-popper l7-popper-hide ${s}`),y=Vi("div","l7-popper-content"),x=Vi("div","l7-popper-arrow");return p.appendChild(y),p.appendChild(x),i.appendChild(p),this.popperDOM=p,this.contentDOM=y,f&&this.setContent(f),p}}(0,ot.Z)(Na,"conflictPopperList",[]);const yI={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class yx extends null{constructor(...i){super(...i),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(i){var s;const f=super.getDefault(i),p=(s=i==null?void 0:i.position)!==null&&s!==void 0?s:f.position;return _objectSpread(_objectSpread({},super.getDefault(i)),{},{popperPlacement:p instanceof Element?"bottom":yI[p],popperTrigger:"click"})}onAdd(){const i=super.onAdd();return this.initPopper(),i}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:i,popperPlacement:s,popperTrigger:f}=this.controlOption,p=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:i,placement:s,trigger:f,container:p,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(i){if(super.setOptions(i),this.checkUpdateOption(i,["popperPlacement","popperTrigger","popperClassName"])){const s=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(s)}}}var js=function(a){return a.ActiveOptionClassName="l7-select-control-item-active",a.OptionValueAttrKey="data-option-value",a.OptionIndexAttrKey="data-option-index",a}(js||{});class _x extends null{constructor(...i){super(...i),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",s=>{const f=this.selectValue.includes(s.value),p=DOM.create("div",`l7-select-control-item ${f?js.ActiveOptionClassName:""}`);this.getIsMultiple()?p.appendChild(this.createCheckbox(f)):p.appendChild(this.createRadio(f)),s.icon&&p.appendChild(s.icon);const y=DOM.create("span");return y.innerText=s.text,p.appendChild(y),p}),_defineProperty(this,"onItemClick",s=>{if(this.getIsMultiple()){const f=this.selectValue.findIndex(p=>p===s.value);f>-1?this.selectValue.splice(f,1):this.selectValue=[...this.selectValue,s.value]}else this.selectValue=[s.value];this.setSelectValue(this.selectValue)})}setOptions(i){super.setOptions(i);const{options:s}=i;s&&this.popper.setContent(this.getPopperContent(s))}onAdd(){const i=super.onAdd(),{defaultValue:s}=this.controlOption;return s&&(this.selectValue=this.transSelectValue(s)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),i}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(i,s=!0){const f=this.transSelectValue(i);this.optionDOMList.forEach(p=>{const y=p.getAttribute(js.OptionValueAttrKey),x=p.querySelector("input[type=checkbox]"),O=p.querySelector("input[type=radio]"),A=f.includes(y),I=(B,j)=>{DOM.toggleClass(p,js.ActiveOptionClassName,j),B&&DOM.setChecked(B,j)};I(x,A),I(O,A)}),this.selectValue=f,s&&this.emit("selectChange",this.getIsMultiple()?f:f[0])}getIsMultiple(){return!1}getPopperContent(i){const s=this.isImageOptions(),f=DOM.create("div",s?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(f,"l7-select-control--multiple");const p=i.map((y,x)=>{const O=s?this.createImageOption(y):this.createNormalOption(y);return O.setAttribute(js.OptionValueAttrKey,y.value),O.setAttribute(js.OptionIndexAttrKey,window.String(x)),O.addEventListener("click",this.onItemClick.bind(this,y)),O});return f.append(...p),this.optionDOMList=p,f}createImageOption(i){const s=this.selectValue.includes(i.value),f=DOM.create("div",`l7-select-control-item ${s?js.ActiveOptionClassName:""}`),p=DOM.create("img");p.setAttribute("src",i.img),DOM.setUnDraggable(p),f.appendChild(p);const y=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&f.appendChild(this.createCheckbox(s));const x=DOM.create("span");return x.innerText=i.text,y.appendChild(x),f.appendChild(y),f}createCheckbox(i){const s=DOM.create("input");return s.setAttribute("type","checkbox"),i&&DOM.setChecked(s,!0),s}createRadio(i){const s=DOM.create("input");return s.setAttribute("type","radio"),i&&DOM.setChecked(s,!0),s}isImageOptions(){return!!this.controlOption.options.find(i=>i.img)}transSelectValue(i){return Array.isArray(i)?i:[i]}}const lv=a=>{const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.classList.add("l7-iconfont"),i.setAttribute("aria-hidden","true");const s=document.createElementNS("http://www.w3.org/2000/svg","use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${a}`),i.appendChild(s),i};class _I extends null{constructor(...i){var s;super(...i),s=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:f}=s.controlOption;f==null||f(yield s.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...f){var p,y;const{imageType:x}=s.controlOption,{width:O=0,height:A=0}=(p=(y=s.mapsService.getContainer())===null||y===void 0?void 0:y.getBoundingClientRect())!==null&&p!==void 0?p:{},I=document.createElement("canvas");I.width=O,I.height=A;const B=I.getContext("2d");return(yield Promise.all(f.map(V=>new Promise(mt=>{const Bt=new Image;Bt.onload=()=>{mt(Bt)},Bt.src=V})))).forEach(V=>{B==null||B.drawImage(V,0,0,O,A)}),I.toDataURL(`image/${x}`)}))}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),i}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var i=this;return _asyncToGenerator(function*(){const s=yield i.mapsService.exportMap("png"),f=yield i.scene.exportPng("png");return i.mergeImage(...[s,f].filter(p=>p))})()}}const fM=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Fa=(()=>{if(typeof document=="undefined")return!1;const a=fM[0],i={};for(const s of fM)if((s==null?void 0:s[1])in document){for(const[p,y]of s.entries())i[a[p]]=y;return i}return!1})(),oi={change:Fa.fullscreenchange,error:Fa.fullscreenerror};let zo={request(a=document.documentElement,i){return new Promise((s,f)=>{const p=()=>{zo.off("change",p),s()};zo.on("change",p);const y=a[Fa.requestFullscreen](i);y instanceof Promise&&y.then(p).catch(f)})},exit(){return new Promise((a,i)=>{if(!zo.isFullscreen){a();return}const s=()=>{zo.off("change",s),a()};zo.on("change",s);const f=document[Fa.exitFullscreen]();f instanceof Promise&&f.then(s).catch(i)})},toggle(a,i){return zo.isFullscreen?zo.exit():zo.request(a,i)},onchange(a){zo.on("change",a)},onerror(a){zo.on("error",a)},on(a,i){const s=oi[a];s&&document.addEventListener(s,i,!1)},off(a,i){const s=oi[a];s&&document.removeEventListener(s,i,!1)},raw:Fa};Object.defineProperties(zo,{isFullscreen:{get:()=>!!document[Fa.fullscreenElement]},element:{enumerable:!0,get:()=>{var a;return(a=document[Fa.fullscreenElement])!==null&&a!==void 0?a:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[Fa.fullscreenEnabled]}}),Fa||(zo={isEnabled:!1});var Xh=null;class bx extends null{constructor(i){var s;super(i),s=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(s.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:f,btnIcon:p,title:y,exitBtnText:x,exitBtnIcon:O,exitTitle:A}=this.controlOption;this.isFullscreen?(this.setBtnTitle(A),this.setBtnText(x),this.setBtnIcon(O)):(this.setBtnTitle(y),this.setBtnText(f),this.setBtnIcon(p)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(i){const{exitBtnText:s,exitBtnIcon:f,exitTitle:p}=i;this.isFullscreen&&(this.checkUpdateOption(i,["exitBtnIcon"])&&this.setBtnIcon(f),this.checkUpdateOption(i,["exitBtnText"])&&this.setBtnText(s),this.checkUpdateOption(i,["exitTitle"])&&this.setBtnTitle(p)),super.setOptions(i)}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),i}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class xx extends null{constructor(i){var s;super(i),s=this,_defineProperty(this,"getGeoLocation",()=>new Promise((f,p)=>{window.navigator.geolocation.getCurrentPosition(({coords:y})=>{const{longitude:x,latitude:O}=y!=null?y:{};!isNaN(x)&&!isNaN(O)?f([x,O]):p()},y=>{p(y)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:f}=s.controlOption,p=yield s.getGeoLocation(),y=s.mapsService.getZoom();s.mapsService.setZoomAndCenter(y>15?y:15,f?yield f(p):p)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),i}}function zs(a){return Object.keys(a!=null?a:{}).every(i=>["layer","name","img"].includes(i))}class bI extends null{constructor(...i){super(...i),_defineProperty(this,"onLayerChange",()=>{var s;(s=this.controlOption.layers)!==null&&s!==void 0&&s.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(s=>{const f=this.selectValue.includes(s.name),p=s.isVisible();f&&!p&&s.show(),!f&&p&&s.hide()})})}get layers(){const i=this.layerService,{layers:s}=this.controlOption;if(Array.isArray(s)&&s.length){const f=[];return s.forEach(p=>{if(p instanceof Object&&(zs(p)?f.push(p.layer):f.push(p)),typeof p=="string"){const y=i.getLayer(p)||i.getLayerByName(p);y&&f.push(y)}}),f}return i.getLayers()||[]}getDefault(i){var s;return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(s=i==null?void 0:i.multiple)!==null&&s!==void 0?s:!0})}getLayerVisible(){return this.layers.filter(i=>i.isVisible()).map(i=>i.name)}getLayerOptions(){const{layers:i}=this.controlOption,s=i==null?void 0:i.every(f=>f.img);return i?i==null?void 0:i.map(f=>{if(zs(f))return{text:f.name||f.layer.name,value:f.layer.name,img:s?f.img:void 0};if(typeof f=="string"){const p=this.layerService.getLayer(f)||this.layerService.getLayerByName(f);return{text:p==null?void 0:p.name,value:p==null?void 0:p.name}}return{text:f.name,value:f.name}}):this.layers.map(f=>({text:f.name,value:f.name}))}setOptions(i){const s=this.checkUpdateOption(i,["layers","multiple"]);super.setOptions(i),s&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((i,s)=>{s===0?i.show():i.hide()})}onAdd(){var i;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(i=this.controlOption.options)!==null&&i!==void 0&&i.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class Sx extends Ic{getDefault(){return{position:hh.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const i=Vi("div","l7-control-logo");return this.setLogoContent(i),i}onRemove(){return null}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["img","href"])&&(hl(this.container),this.setLogoContent(this.container))}setLogoContent(i){const{href:s,img:f}=this.controlOption,p=Vi("img");if(p.setAttribute("src",f),p.setAttribute("aria-label","AntV logo"),Ld(p),s){const y=Vi("a","l7-control-logo-link");y.target="_blank",y.href=s,y.rel="noopener nofollow",y.setAttribute("rel","noopener nofollow"),y.appendChild(p),i.appendChild(y)}else i.appendChild(p)}}const xI={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},uv={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class va extends null{constructor(...i){super(...i),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const i=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([s,f])=>typeof f=="string"&&s!=="blank").map(([s,f])=>{var p;const{text:y,img:x}=(p=i[s])!==null&&p!==void 0?p:{};return{text:y!=null?y:s,value:f,img:x,key:s}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var i;if((i=this.controlOption.options)!==null&&i!==void 0&&i.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var s,f;const p=this.controlOption.defaultValue;this.controlOption.defaultValue=(s=(f=this.controlOption.options.find(y=>y.key===p))===null||f===void 0?void 0:f.value)!==null&&s!==void 0?s:p}else{const p=this.getMapStyle();p?this.controlOption.defaultValue=p:this.mapsService.map.once("styledata",()=>{const y=this.mapsService.getMapStyle();this.controlOption.defaultValue=y,this.setSelectValue(y,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class SF extends null{constructor(...i){super(...i),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",s=>{let f=this.location;const p=s.lngLat||s.lnglat,{transform:y}=this.controlOption;p&&(f=[p.lng,p.lat]),this.location=f,y&&(f=y(f)),this.insertLocation2HTML(f),this.emit("locationChange",f)})}getLocation(){return this.location}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{position:PositionType.BOTTOMLEFT,transform:([s,f])=>[+(+s).toFixed(6),+(+f).toFixed(6)]})}onAdd(){const i=DOM.create("div","l7-control-mouse-location");return i.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),i}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(i){this.container.innerText=i.join(", ")}}class Ox extends null{constructor(...i){super(...i),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const s=this.mapsService,{maxWidth:f}=this.controlOption,p=s.getSize()[1]/2,y=s.containerToLngLat([0,p]),x=s.containerToLngLat([f,p]),O=lnglatDistance([y.lng,y.lat],[x.lng,x.lat]);this.updateScales(O)})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const s=DOM.create("div","l7-control-scale");this.resetScaleLines(s);const{updateWhenIdle:f}=this.controlOption;return this.mapsService.on(f?"moveend":"mapmove",this.update),this.mapsService.on(f?"zoomend":"zoomchange",this.update),s}onRemove(){const{updateWhenIdle:i}=this.controlOption;this.mapsService.off(i?"zoomend":"zoomchange",this.update),this.mapsService.off(i?"moveend":"mapmove",this.update)}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(i){const{metric:s,imperial:f}=this.controlOption;s&&i&&this.updateMetric(i),f&&i&&this.updateImperial(i)}resetScaleLines(i){DOM.clearChildren(i);const{metric:s,imperial:f,maxWidth:p,lockWidth:y}=this.controlOption;y&&DOM.addStyle(i,`width: ${p}px`),s&&(this.mScale=DOM.create("div","l7-control-scale-line",i)),f&&(this.iScale=DOM.create("div","l7-control-scale-line",i)),this.update()}updateScale(i,s,f){const{maxWidth:p}=this.controlOption;i.style.width=Math.round(p*f)+"px",i.innerHTML=s}getRoundNum(i){const s=Math.pow(10,(Math.floor(i)+"").length-1);let f=i/s;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,s*f}updateMetric(i){const s=this.getRoundNum(i),f=s<1e3?s+" m":s/1e3+" km";this.updateScale(this.mScale,f,s/i)}updateImperial(i){const s=i*3.2808399;let f,p,y;s>5280?(f=s/5280,p=this.getRoundNum(f),this.updateScale(this.iScale,p+" mi",p/f)):(y=this.getRoundNum(s),this.updateScale(this.iScale,y+" ft",y/s))}}class Ex{constructor(){(0,ot.Z)(this,"mapService",void 0),(0,ot.Z)(this,"fontService",void 0)}apply(i,{styleAttributeService:s,mapService:f,fontService:p}){var y=this;this.mapService=f,this.fontService=p,i.hooks.init.tapPromise("DataMappingPlugin",(0,ln.Z)(function*(){i.log($i.MappingStart,oo.INIT),y.generateMaping(i,{styleAttributeService:s}),i.log($i.MappingEnd,oo.INIT)})),i.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var x=(0,ln.Z)(function*(O){if(!O)return O;i.dataState.dataMappingNeedUpdate=!1,i.log($i.MappingStart,oo.UPDATE);const A=y.generateMaping(i,{styleAttributeService:s});return i.log($i.MappingEnd,oo.UPDATE),A});return function(O){return x.apply(this,arguments)}}()),i.hooks.beforeRender.tap("DataMappingPlugin",()=>{const x=i.getSource();if(i.layerModelNeedUpdate||!x||!x.inited)return;const O=s.getLayerStyleAttributes()||[],A=s.getLayerStyleAttribute("filter"),{dataArray:I}=x.data;if(Array.isArray(I)&&I.length===0)return;const B=O.filter(V=>V.needRemapping);let j=I;if(A!=null&&A.needRemapping&&A!==null&&A!==void 0&&A.scale&&(j=I.filter(V=>this.applyAttributeMapping(A,V)[0])),B.length){const V=this.mapping(i,B,j,i.getEncodedData());i.setEncodedData(V)}})}generateMaping(i,{styleAttributeService:s}){const f=s.getLayerStyleAttributes()||[],p=s.getLayerStyleAttribute("filter"),{dataArray:y}=i.getSource().data;let x=y;p!=null&&p.scale&&(x=y.filter(A=>this.applyAttributeMapping(p,A)[0])),x=i.processData(x);const O=this.mapping(i,f,x,void 0);return i.setEncodedData(O),i.emit("dataUpdate",null),!0}mapping(i,s,f,p){const y=s.filter(O=>O.scale!==void 0).filter(O=>O.name!=="filter"),x=f.map((O,A)=>{const I=p?p[A]:{},B=(0,on.Z)({id:O._id,coordinates:O.coordinates},I);return y.forEach(j=>{let V=this.applyAttributeMapping(j,O);(j.name==="color"||j.name==="stroke")&&(V=V.map(mt=>Gr(mt))),B[j.name]=Array.isArray(V)&&V.length===1?V[0]:V,j.name==="shape"&&(B.shape=this.fontService.getIconFontKey(B[j.name]))}),B});return s.forEach(O=>{O.needRemapping=!1}),this.adjustData2SimpleCoordinates(x),x}adjustData2SimpleCoordinates(i){i.length>0&&this.mapService.version==="SIMPLE"&&i.map(s=>{s.simpleCoordinate||(s.coordinates=this.unProjectCoordinates(s.coordinates),s.simpleCoordinate=!0)})}unProjectCoordinates(i){if(typeof i[0]=="number")return this.mapService.simpleMapCoord.unproject(i);if(i[0]&&i[0][0]instanceof Array){const s=[];return i.map(f=>{const p=[];f.map(y=>{p.push(this.mapService.simpleMapCoord.unproject(y))}),s.push(p)}),s}else{const s=[];return i.map(f=>{s.push(this.mapService.simpleMapCoord.unproject(f))}),s}}applyAttributeMapping(i,s){var f;if(!i.scale)return[];const p=(i==null||(f=i.scale)===null||f===void 0?void 0:f.scalers)||[],y=[];return p.forEach(({field:O})=>{var A;(s.hasOwnProperty(O)||((A=i.scale)===null||A===void 0?void 0:A.type)==="variable")&&y.push(s[O])}),i.mapping?i.mapping(y):[]}getArrowPoints(i,s){const f=[s[0]-i[0],s[1]-i[1]],p=lE(f);return[i[0]+p[0]*1e-4,i[1]+p[1]*1e-4]}}class Ax{constructor(){(0,ot.Z)(this,"mapService",void 0)}apply(i){var s=this;this.mapService=i.getContainer().mapService,i.hooks.init.tapPromise("DataSourcePlugin",(0,ln.Z)(function*(){i.log($i.SourceInitStart,oo.INIT);let f=i.getSource();if(!f){const{data:p,options:y}=i.sourceOption||i.defaultSourceConfig;f=new mx(p,y),i.setSource(f)}f.inited?(s.updateClusterData(i),i.log($i.SourceInitEnd,oo.INIT)):yield new Promise(p=>{f.on("update",y=>{y.type==="inited"&&(s.updateClusterData(i),i.log($i.SourceInitEnd,oo.INIT)),p(null)})})})),i.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,ln.Z)(function*(){const f=s.updateClusterData(i),p=i.dataState.dataSourceNeedUpdate;return i.dataState.dataSourceNeedUpdate=!1,f||p}))}updateClusterData(i){if(i.isTileLayer||i.tileLayer||!i.getSource())return!1;const s=i.getSource(),f=s.cluster,{zoom:p=0}=s.clusterOptions,y=this.mapService.getZoom()-1,x=i.dataState.dataSourceNeedUpdate;return f&&x&&s.updateClusterData(Math.floor(y)),f&&Math.abs(i.clusterZoom-y)>=1?(p!==Math.floor(y)&&s.updateClusterData(Math.floor(y)),i.clusterZoom=y,!0):!1}}var Rc=L(64599),kc=L.n(Rc);function qh(a,i){var s,f;if(i===void 0){var p=kc()(a),y;try{for(p.s();!(y=p.n()).done;){var x=y.value;x!=null&&(s===void 0?x>=x&&(s=f=x):(s>x&&(s=x),f<x&&(f=x)))}}catch(j){p.e(j)}finally{p.f()}}else{var O=-1,A=kc()(a),I;try{for(A.s();!(I=A.n()).done;){var B=I.value;(B=i(B,++O,a))!=null&&(s===void 0?B>=B&&(s=f=B):(s>B&&(s=B),f<B&&(f=B)))}}catch(j){A.e(j)}finally{A.f()}}return[s,f]}function Tx(a,i,s,f,p){var y=a*a,x=y*a;return((1-3*a+3*y-x)*i+(4-6*y+3*x)*s+(1+3*a+3*y-3*x)*f+x*p)/6}function dM(a){var i=a.length-1;return function(s){var f=s<=0?s=0:s>=1?(s=1,i-1):Math.floor(s*i),p=a[f],y=a[f+1],x=f>0?a[f-1]:2*p-y,O=f<i-1?a[f+2]:2*y-p;return Tx((s-f/i)*i,x,p,y,O)}}function SI(a){var i=a.length;return function(s){var f=Math.floor(((s%=1)<0?++s:s)*i),p=a[(f+i-1)%i],y=a[f%i],x=a[(f+1)%i],O=a[(f+2)%i];return Tx((s-f/i)*i,p,y,x,O)}}function Mx(a){return function(){return a}}function fv(a,i){return function(s){return a+s*i}}function zl(a,i,s){return a=Math.pow(a,s),i=Math.pow(i,s)-a,s=1/s,function(f){return Math.pow(a+f*i,s)}}function wI(a,i){var s=i-a;return s?fv(a,s>180||s<-180?s-360*Math.round(s/360):s):constant(isNaN(a)?i:a)}function Cx(a){return(a=+a)==1?dv:function(i,s){return s-i?zl(i,s,a):Mx(isNaN(i)?s:i)}}function dv(a,i){var s=i-a;return s?fv(a,s):Mx(isNaN(a)?i:a)}var Kh=function a(i){var s=Cx(i);function f(p,y){var x=s((p=Xt(p)).r,(y=Xt(y)).r),O=s(p.g,y.g),A=s(p.b,y.b),I=dv(p.opacity,y.opacity);return function(B){return p.r=x(B),p.g=O(B),p.b=A(B),p.opacity=I(B),p+""}}return f.gamma=a,f}(1);function Qh(a){return function(i){var s=i.length,f=new Array(s),p=new Array(s),y=new Array(s),x,O;for(x=0;x<s;++x)O=Xt(i[x]),f[x]=O.r||0,p[x]=O.g||0,y[x]=O.b||0;return f=a(f),p=a(p),y=a(y),O.opacity=1,function(A){return O.r=f(A),O.g=p(A),O.b=y(A),O+""}}}var hM=Qh(dM),pM=Qh(SI);function Jh(a,i){return a<i?-1:a>i?1:a>=i?0:NaN}function Ba(a){return a.length===1&&(a=gM(a)),{left:function(i,s,f,p){for(f==null&&(f=0),p==null&&(p=i.length);f<p;){var y=f+p>>>1;a(i[y],s)<0?f=y+1:p=y}return f},right:function(i,s,f,p){for(f==null&&(f=0),p==null&&(p=i.length);f<p;){var y=f+p>>>1;a(i[y],s)>0?p=y:f=y+1}return f}}}function gM(a){return function(i,s){return Jh(a(i),s)}}var hv=Ba(Jh),Px=hv.right,Lx=hv.left,tp=Px,xi=Array.prototype,OI=xi.slice,ja=xi.map,ep=Math.sqrt(50),Dc=Math.sqrt(10),np=Math.sqrt(2);function pv(a,i,s){var f,p=-1,y,x,O;if(i=+i,a=+a,s=+s,a===i&&s>0)return[a];if((f=i<a)&&(y=a,a=i,i=y),(O=rp(a,i,s))===0||!isFinite(O))return[];if(O>0)for(a=Math.ceil(a/O),i=Math.floor(i/O),x=new Array(y=Math.ceil(i-a+1));++p<y;)x[p]=(a+p)*O;else for(a=Math.floor(a*O),i=Math.ceil(i*O),x=new Array(y=Math.ceil(a-i+1));++p<y;)x[p]=(a-p)/O;return f&&x.reverse(),x}function rp(a,i,s){var f=(i-a)/Math.max(0,s),p=Math.floor(Math.log(f)/Math.LN10),y=f/Math.pow(10,p);return p>=0?(y>=ep?10:y>=Dc?5:y>=np?2:1)*Math.pow(10,p):-Math.pow(10,-p)/(y>=ep?10:y>=Dc?5:y>=np?2:1)}function Ul(a,i,s){var f=Math.abs(i-a)/Math.max(0,s),p=Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),y=f/p;return y>=ep?p*=10:y>=Dc?p*=5:y>=np&&(p*=2),i<a?-p:p}function EI(){var a=identity,i=extent,s=sturges;function f(p){var y,x=p.length,O,A=new Array(x);for(y=0;y<x;++y)A[y]=a(p[y],y,p);var I=i(A),B=I[0],j=I[1],V=s(A,B,j);Array.isArray(V)||(V=tickStep(B,j,V),V=range(Math.ceil(B/V)*V,j,V));for(var mt=V.length;V[0]<=B;)V.shift(),--mt;for(;V[mt-1]>j;)V.pop(),--mt;var Bt=new Array(mt+1),Kt;for(y=0;y<=mt;++y)Kt=Bt[y]=[],Kt.x0=y>0?V[y-1]:B,Kt.x1=y<mt?V[y]:j;for(y=0;y<x;++y)O=A[y],B<=O&&O<=j&&Bt[bisect(V,O,0,mt)].push(p[y]);return Bt}return f.value=function(p){return arguments.length?(a=typeof p=="function"?p:constant(p),f):a},f.domain=function(p){return arguments.length?(i=typeof p=="function"?p:constant([p[0],p[1]]),f):i},f.thresholds=function(p){return arguments.length?(s=typeof p=="function"?p:Array.isArray(p)?constant(slice.call(p)):constant(p),f):s},f}function AI(a,i,s){return a=map.call(a,number).sort(ascending),Math.ceil((s-i)/(2*(quantile(a,.75)-quantile(a,.25))*Math.pow(a.length,-1/3)))}function vM(a){return a===null?NaN:+a}function mM(a,i,s){if(s==null&&(s=vM),!!(f=a.length)){if((i=+i)<=0||f<2)return+s(a[0],0,a);if(i>=1)return+s(a[f-1],f-1,a);var f,p=(f-1)*i,y=Math.floor(p),x=+s(a[y],y,a),O=+s(a[y+1],y+1,a);return x+(O-x)*(p-y)}}var Uo="$";function ip(){}ip.prototype=Ix.prototype={constructor:ip,has:function(a){return Uo+a in this},get:function(a){return this[Uo+a]},set:function(a,i){return this[Uo+a]=i,this},remove:function(a){var i=Uo+a;return i in this&&delete this[i]},clear:function(){for(var a in this)a[0]===Uo&&delete this[a]},keys:function(){var a=[];for(var i in this)i[0]===Uo&&a.push(i.slice(1));return a},values:function(){var a=[];for(var i in this)i[0]===Uo&&a.push(this[i]);return a},entries:function(){var a=[];for(var i in this)i[0]===Uo&&a.push({key:i.slice(1),value:this[i]});return a},size:function(){var a=0;for(var i in this)i[0]===Uo&&++a;return a},empty:function(){for(var a in this)if(a[0]===Uo)return!1;return!0},each:function(a){for(var i in this)i[0]===Uo&&a(this[i],i.slice(1),this)}};function Ix(a,i){var s=new ip;if(a instanceof ip)a.each(function(O,A){s.set(A,O)});else if(Array.isArray(a)){var f=-1,p=a.length,y;if(i==null)for(;++f<p;)s.set(f,a[f]);else for(;++f<p;)s.set(i(y=a[f],f,a),y)}else if(a)for(var x in a)s.set(x,a[x]);return s}var op=Ix;function gv(){var a=[],i=[],s,f,p;function y(O,A,I,B){if(A>=a.length)return s!=null&&O.sort(s),f!=null?f(O):O;for(var j=-1,V=O.length,mt=a[A++],Bt,Kt,ue=map(),Le,ke=I();++j<V;)(Le=ue.get(Bt=mt(Kt=O[j])+""))?Le.push(Kt):ue.set(Bt,[Kt]);return ue.each(function(He,Ye){B(ke,Ye,y(He,A,I,B))}),ke}function x(O,A){if(++A>a.length)return O;var I,B=i[A-1];return f!=null&&A>=a.length?I=O.entries():(I=[],O.each(function(j,V){I.push({key:V,values:x(j,A)})})),B!=null?I.sort(function(j,V){return B(j.key,V.key)}):I}return p={object:function(O){return y(O,0,ap,yM)},map:function(O){return y(O,0,Rx,kx)},entries:function(O){return x(y(O,0,Rx,kx),0)},key:function(O){return a.push(O),p},sortKeys:function(O){return i[a.length-1]=O,p},sortValues:function(O){return s=O,p},rollup:function(O){return f=O,p}}}function ap(){return{}}function yM(a,i,s){a[i]=s}function Rx(){return map()}function kx(a,i,s){a.set(i,s)}function za(){}var Nc=op.prototype;za.prototype=Dx.prototype={constructor:za,has:Nc.has,add:function(a){return a+="",this[Uo+a]=a,this},remove:Nc.remove,clear:Nc.clear,values:Nc.keys,size:Nc.size,empty:Nc.empty,each:Nc.each};function Dx(a,i){var s=new za;if(a instanceof za)a.each(function(y){s.add(y)});else if(a){var f=-1,p=a.length;if(i==null)for(;++f<p;)s.add(a[f]);else for(;++f<p;)s.add(i(a[f],f,a))}return s}var TI=null,Ua=Array.prototype,Nx=Ua.map,Fc=Ua.slice;function hs(a,i){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(i).domain(a);break}return this}function sp(a,i){switch(arguments.length){case 0:break;case 1:this.interpolator(a);break;default:this.interpolator(i).domain(a);break}return this}var Fx={name:"implicit"};function _f(){var a=op(),i=[],s=[],f=Fx;function p(y){var x=y+"",O=a.get(x);if(!O){if(f!==Fx)return f;a.set(x,O=i.push(y))}return s[(O-1)%s.length]}return p.domain=function(y){if(!arguments.length)return i.slice();i=[],a=op();for(var x=-1,O=y.length,A,I;++x<O;)a.has(I=(A=y[x])+"")||a.set(I,i.push(A));return p},p.range=function(y){return arguments.length?(s=Fc.call(y),p):s.slice()},p.unknown=function(y){return arguments.length?(f=y,p):f},p.copy=function(){return _f(i,s).unknown(f)},hs.apply(p,arguments),p}function Bx(){var a=ordinal().unknown(void 0),i=a.domain,s=a.range,f=[0,1],p,y,x=!1,O=0,A=0,I=.5;delete a.unknown;function B(){var j=i().length,V=f[1]<f[0],mt=f[V-0],Bt=f[1-V];p=(Bt-mt)/Math.max(1,j-O+A*2),x&&(p=Math.floor(p)),mt+=(Bt-mt-p*(j-O))*I,y=p*(1-O),x&&(mt=Math.round(mt),y=Math.round(y));var Kt=sequence(j).map(function(ue){return mt+p*ue});return s(V?Kt.reverse():Kt)}return a.domain=function(j){return arguments.length?(i(j),B()):i()},a.range=function(j){return arguments.length?(f=[+j[0],+j[1]],B()):f.slice()},a.rangeRound=function(j){return f=[+j[0],+j[1]],x=!0,B()},a.bandwidth=function(){return y},a.step=function(){return p},a.round=function(j){return arguments.length?(x=!!j,B()):x},a.padding=function(j){return arguments.length?(O=Math.min(1,A=+j),B()):O},a.paddingInner=function(j){return arguments.length?(O=Math.min(1,j),B()):O},a.paddingOuter=function(j){return arguments.length?(A=+j,B()):A},a.align=function(j){return arguments.length?(I=Math.max(0,Math.min(1,j)),B()):I},a.copy=function(){return Bx(i(),f).round(x).paddingInner(O).paddingOuter(A).align(I)},initRange.apply(B(),arguments)}function jx(a){var i=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return jx(i())},a}function MI(){return jx(Bx.apply(null,arguments).paddingInner(1))}function zx(a,i,s,f,p){var y=a*a,x=y*a;return((1-3*a+3*y-x)*i+(4-6*y+3*x)*s+(1+3*a+3*y-3*x)*f+x*p)/6}function _M(a){var i=a.length-1;return function(s){var f=s<=0?s=0:s>=1?(s=1,i-1):Math.floor(s*i),p=a[f],y=a[f+1],x=f>0?a[f-1]:2*p-y,O=f<i-1?a[f+2]:2*y-p;return zx((s-f/i)*i,x,p,y,O)}}function ps(a){var i=a.length;return function(s){var f=Math.floor(((s%=1)<0?++s:s)*i),p=a[(f+i-1)%i],y=a[f%i],x=a[(f+1)%i],O=a[(f+2)%i];return zx((s-f/i)*i,p,y,x,O)}}function Us(a){return function(){return a}}function gs(a,i){return function(s){return a+s*i}}function cp(a,i,s){return a=Math.pow(a,s),i=Math.pow(i,s)-a,s=1/s,function(f){return Math.pow(a+f*i,s)}}function bM(a,i){var s=i-a;return s?gs(a,s>180||s<-180?s-360*Math.round(s/360):s):constant(isNaN(a)?i:a)}function Ux(a){return(a=+a)==1?Zx:function(i,s){return s-i?cp(i,s,a):Us(isNaN(i)?s:i)}}function Zx(a,i){var s=i-a;return s?gs(a,s):Us(isNaN(a)?i:a)}var vv=function a(i){var s=Ux(i);function f(p,y){var x=s((p=Xt(p)).r,(y=Xt(y)).r),O=s(p.g,y.g),A=s(p.b,y.b),I=Zx(p.opacity,y.opacity);return function(B){return p.r=x(B),p.g=O(B),p.b=A(B),p.opacity=I(B),p+""}}return f.gamma=a,f}(1);function lo(a){return function(i){var s=i.length,f=new Array(s),p=new Array(s),y=new Array(s),x,O;for(x=0;x<s;++x)O=Xt(i[x]),f[x]=O.r||0,p[x]=O.g||0,y[x]=O.b||0;return f=a(f),p=a(p),y=a(y),O.opacity=1,function(A){return O.r=f(A),O.g=p(A),O.b=y(A),O+""}}}var Zl=lo(_M),CI=lo(ps);function Hx(a,i){return(isNumberArray(i)?numberArray:ma)(a,i)}function ma(a,i){var s=i?i.length:0,f=a?Math.min(s,a.length):0,p=new Array(f),y=new Array(s),x;for(x=0;x<f;++x)p[x]=yv(a[x],i[x]);for(;x<s;++x)y[x]=i[x];return function(O){for(x=0;x<f;++x)y[x]=p[x](O);return y}}function Hl(a,i){var s=new Date;return a=+a,i=+i,function(f){return s.setTime(a*(1-f)+i*f),s}}function Yi(a,i){return a=+a,i=+i,function(s){return a*(1-s)+i*s}}function bf(a,i){var s={},f={},p;(a===null||typeof a!="object")&&(a={}),(i===null||typeof i!="object")&&(i={});for(p in i)p in a?s[p]=yv(a[p],i[p]):f[p]=i[p];return function(y){for(p in s)f[p]=s[p](y);return f}}var Wl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mv=new RegExp(Wl.source,"g");function xM(a){return function(){return a}}function Wx(a){return function(i){return a(i)+""}}function SM(a,i){var s=Wl.lastIndex=mv.lastIndex=0,f,p,y,x=-1,O=[],A=[];for(a=a+"",i=i+"";(f=Wl.exec(a))&&(p=mv.exec(i));)(y=p.index)>s&&(y=i.slice(s,y),O[x]?O[x]+=y:O[++x]=y),(f=f[0])===(p=p[0])?O[x]?O[x]+=p:O[++x]=p:(O[++x]=null,A.push({i:x,x:Yi(f,p)})),s=mv.lastIndex;return s<i.length&&(y=i.slice(s),O[x]?O[x]+=y:O[++x]=y),O.length<2?A[0]?Wx(A[0].x):xM(i):(i=A.length,function(I){for(var B=0,j;B<i;++B)O[(j=A[B]).i]=j.x(I);return O.join("")})}function wM(a,i){i||(i=[]);var s=a?Math.min(i.length,a.length):0,f=i.slice(),p;return function(y){for(p=0;p<s;++p)f[p]=a[p]*(1-y)+i[p]*y;return f}}function OM(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function yv(a,i){var s=typeof i,f;return i==null||s==="boolean"?Us(i):(s==="number"?Yi:s==="string"?(f=fi(i))?(i=f,vv):SM:i instanceof fi?vv:i instanceof Date?Hl:OM(i)?wM:Array.isArray(i)?ma:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?bf:Yi)(a,i)}function EM(a,i){return a=+a,i=+i,function(s){return Math.round(a*(1-s)+i*s)}}function AM(a){return function(){return a}}function lp(a){return+a}var up=[0,1];function Xi(a){return a}function fp(a,i){return(i-=a=+a)?function(s){return(s-a)/i}:AM(isNaN(i)?NaN:.5)}function Vl(a){var i=a[0],s=a[a.length-1],f;return i>s&&(f=i,i=s,s=f),function(p){return Math.max(i,Math.min(s,p))}}function xf(a,i,s){var f=a[0],p=a[1],y=i[0],x=i[1];return p<f?(f=fp(p,f),y=s(x,y)):(f=fp(f,p),y=s(y,x)),function(O){return y(f(O))}}function TM(a,i,s){var f=Math.min(a.length,i.length)-1,p=new Array(f),y=new Array(f),x=-1;for(a[f]<a[0]&&(a=a.slice().reverse(),i=i.slice().reverse());++x<f;)p[x]=fp(a[x],a[x+1]),y[x]=s(i[x],i[x+1]);return function(O){var A=tp(a,O,1,f)-1;return y[A](p[A](O))}}function dp(a,i){return i.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function Sf(){var a=up,i=up,s=yv,f,p,y,x=Xi,O,A,I;function B(){return O=Math.min(a.length,i.length)>2?TM:xf,A=I=null,j}function j(V){return isNaN(V=+V)?y:(A||(A=O(a.map(f),i,s)))(f(x(V)))}return j.invert=function(V){return x(p((I||(I=O(i,a.map(f),Yi)))(V)))},j.domain=function(V){return arguments.length?(a=Nx.call(V,lp),x===Xi||(x=Vl(a)),B()):a.slice()},j.range=function(V){return arguments.length?(i=Fc.call(V),B()):i.slice()},j.rangeRound=function(V){return i=Fc.call(V),s=EM,B()},j.clamp=function(V){return arguments.length?(x=V?Vl(a):Xi,j):x!==Xi},j.interpolate=function(V){return arguments.length?(s=V,B()):s},j.unknown=function(V){return arguments.length?(y=V,j):y},function(V,mt){return f=V,p=mt,B()}}function hp(a,i){return Sf()(a,i)}var pp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Zs(a){if(!(i=pp.exec(a)))throw new Error("invalid format: "+a);var i;return new ya({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}Zs.prototype=ya.prototype;function ya(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}ya.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Vx(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function Gl(a,i){if((s=(a=i?a.toExponential(i-1):a.toExponential()).indexOf("e"))<0)return null;var s,f=a.slice(0,s);return[f.length>1?f[0]+f.slice(2):f,+a.slice(s+1)]}function uo(a){return a=Gl(Math.abs(a)),a?a[1]:NaN}function wf(a,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(uo(i)/3)))*3-uo(Math.abs(a)))}function Bc(a,i){return function(s,f){for(var p=s.length,y=[],x=0,O=a[0],A=0;p>0&&O>0&&(A+O+1>f&&(O=Math.max(1,f-A)),y.push(s.substring(p-=O,p+O)),!((A+=O+1)>f));)O=a[x=(x+1)%a.length];return y.reverse().join(i)}}function _v(a){return function(i){return i.replace(/[0-9]/g,function(s){return a[+s]})}}function MM(a){t:for(var i=a.length,s=1,f=-1,p;s<i;++s)switch(a[s]){case".":f=p=s;break;case"0":f===0&&(f=s),p=s;break;default:if(!+a[s])break t;f>0&&(f=0);break}return f>0?a.slice(0,f)+a.slice(p+1):a}var bv;function Of(a,i){var s=Gl(a,i);if(!s)return a+"";var f=s[0],p=s[1],y=p-(bv=Math.max(-8,Math.min(8,Math.floor(p/3)))*3)+1,x=f.length;return y===x?f:y>x?f+new Array(y-x+1).join("0"):y>0?f.slice(0,y)+"."+f.slice(y):"0."+new Array(1-y).join("0")+Gl(a,Math.max(0,i+y-1))[0]}function vs(a,i){var s=Gl(a,i);if(!s)return a+"";var f=s[0],p=s[1];return p<0?"0."+new Array(-p).join("0")+f:f.length>p+1?f.slice(0,p+1)+"."+f.slice(p+1):f+new Array(p-f.length+2).join("0")}var xv={"%":function(a,i){return(a*100).toFixed(i)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:Vx,e:function(a,i){return a.toExponential(i)},f:function(a,i){return a.toFixed(i)},g:function(a,i){return a.toPrecision(i)},o:function(a){return Math.round(a).toString(8)},p:function(a,i){return vs(a*100,i)},r:vs,s:Of,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function Gx(a){return a}var Sv=Array.prototype.map,gp=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Hs(a){var i=a.grouping===void 0||a.thousands===void 0?Gx:Bc(Sv.call(a.grouping,Number),a.thousands+""),s=a.currency===void 0?"":a.currency[0]+"",f=a.currency===void 0?"":a.currency[1]+"",p=a.decimal===void 0?".":a.decimal+"",y=a.numerals===void 0?Gx:_v(Sv.call(a.numerals,String)),x=a.percent===void 0?"%":a.percent+"",O=a.minus===void 0?"-":a.minus+"",A=a.nan===void 0?"NaN":a.nan+"";function I(j){j=Zs(j);var V=j.fill,mt=j.align,Bt=j.sign,Kt=j.symbol,ue=j.zero,Le=j.width,ke=j.comma,He=j.precision,Ye=j.trim,rn=j.type;rn==="n"?(ke=!0,rn="g"):xv[rn]||(He===void 0&&(He=12),Ye=!0,rn="g"),(ue||V==="0"&&mt==="=")&&(ue=!0,V="0",mt="=");var bn=Kt==="$"?s:Kt==="#"&&/[boxX]/.test(rn)?"0"+rn.toLowerCase():"",hn=Kt==="$"?f:/[%p]/.test(rn)?x:"",Cn=xv[rn],Jn=/[defgprs%]/.test(rn);He=He===void 0?6:/[gprs]/.test(rn)?Math.max(1,Math.min(21,He)):Math.max(0,Math.min(20,He));function cr(Gn){var ar=bn,mr=hn,po,xa,go;if(rn==="c")mr=Cn(Gn)+mr,Gn="";else{Gn=+Gn;var xr=Gn<0||1/Gn<0;if(Gn=isNaN(Gn)?A:Cn(Math.abs(Gn),He),Ye&&(Gn=MM(Gn)),xr&&+Gn==0&&Bt!=="+"&&(xr=!1),ar=(xr?Bt==="("?Bt:O:Bt==="-"||Bt==="("?"":Bt)+ar,mr=(rn==="s"?gp[8+bv/3]:"")+mr+(xr&&Bt==="("?")":""),Jn){for(po=-1,xa=Gn.length;++po<xa;)if(go=Gn.charCodeAt(po),48>go||go>57){mr=(go===46?p+Gn.slice(po+1):Gn.slice(po))+mr,Gn=Gn.slice(0,po);break}}}ke&&!ue&&(Gn=i(Gn,1/0));var vo=ar.length+Gn.length+mr.length,Io=vo<Le?new Array(Le-vo+1).join(V):"";switch(ke&&ue&&(Gn=i(Io+Gn,Io.length?Le-mr.length:1/0),Io=""),mt){case"<":Gn=ar+Gn+mr+Io;break;case"=":Gn=ar+Io+Gn+mr;break;case"^":Gn=Io.slice(0,vo=Io.length>>1)+ar+Gn+mr+Io.slice(vo);break;default:Gn=Io+ar+Gn+mr;break}return y(Gn)}return cr.toString=function(){return j+""},cr}function B(j,V){var mt=I((j=Zs(j),j.type="f",j)),Bt=Math.max(-8,Math.min(8,Math.floor(uo(V)/3)))*3,Kt=Math.pow(10,-Bt),ue=gp[8+Bt/3];return function(Le){return mt(Kt*Le)+ue}}return{format:I,formatPrefix:B}}var vp,$l,Ws;Yl({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Yl(a){return vp=Hs(a),$l=vp.format,Ws=vp.formatPrefix,vp}function $x(a,i){return a=Math.abs(a),i=Math.abs(i)-a,Math.max(0,uo(i)-uo(a))+1}function Yx(a){return Math.max(0,-uo(Math.abs(a)))}function Xx(a,i,s,f){var p=Ul(a,i,s),y;switch(f=Zs(f==null?",f":f),f.type){case"s":{var x=Math.max(Math.abs(a),Math.abs(i));return f.precision==null&&!isNaN(y=wf(p,x))&&(f.precision=y),Ws(f,x)}case"":case"e":case"g":case"p":case"r":{f.precision==null&&!isNaN(y=$x(p,Math.max(Math.abs(a),Math.abs(i))))&&(f.precision=y-(f.type==="e"));break}case"f":case"%":{f.precision==null&&!isNaN(y=Yx(p))&&(f.precision=y-(f.type==="%")*2);break}}return $l(f)}function ra(a){var i=a.domain;return a.ticks=function(s){var f=i();return pv(f[0],f[f.length-1],s==null?10:s)},a.tickFormat=function(s,f){var p=i();return Xx(p[0],p[p.length-1],s==null?10:s,f)},a.nice=function(s){s==null&&(s=10);var f=i(),p=0,y=f.length-1,x=f[p],O=f[y],A;return O<x&&(A=x,x=O,O=A,A=p,p=y,y=A),A=rp(x,O,s),A>0?(x=Math.floor(x/A)*A,O=Math.ceil(O/A)*A,A=rp(x,O,s)):A<0&&(x=Math.ceil(x*A)/A,O=Math.floor(O*A)/A,A=rp(x,O,s)),A>0?(f[p]=Math.floor(x/A)*A,f[y]=Math.ceil(O/A)*A,i(f)):A<0&&(f[p]=Math.ceil(x*A)/A,f[y]=Math.floor(O*A)/A,i(f)),a},a}function qx(){var a=hp(Xi,Xi);return a.copy=function(){return dp(a,qx())},hs.apply(a,arguments),ra(a)}function mp(a){var i;function s(f){return isNaN(f=+f)?i:f}return s.invert=s,s.domain=s.range=function(f){return arguments.length?(a=map.call(f,number),s):a.slice()},s.unknown=function(f){return arguments.length?(i=f,s):i},s.copy=function(){return mp(a).unknown(i)},a=arguments.length?map.call(a,number):[0,1],linearish(s)}function Ef(a,i){a=a.slice();var s=0,f=a.length-1,p=a[s],y=a[f],x;return y<p&&(x=s,s=f,f=x,x=p,p=y,y=x),a[s]=i.floor(p),a[f]=i.ceil(y),a}function Xl(a){return Math.log(a)}function wv(a){return Math.exp(a)}function CM(a){return-Math.log(-a)}function Af(a){return-Math.exp(-a)}function Ov(a){return isFinite(a)?+("1e"+a):a<0?0:a}function Kx(a){return a===10?Ov:a===Math.E?Math.exp:function(i){return Math.pow(a,i)}}function PM(a){return a===Math.E?Math.log:a===10&&Math.log10||a===2&&Math.log2||(a=Math.log(a),function(i){return Math.log(i)/a})}function Ev(a){return function(i){return-a(-i)}}function LM(a){var i=a(Xl,wv),s=i.domain,f=10,p,y;function x(){return p=PM(f),y=Kx(f),s()[0]<0?(p=Ev(p),y=Ev(y),a(CM,Af)):a(Xl,wv),i}return i.base=function(O){return arguments.length?(f=+O,x()):f},i.domain=function(O){return arguments.length?(s(O),x()):s()},i.ticks=function(O){var A=s(),I=A[0],B=A[A.length-1],j;(j=B<I)&&(V=I,I=B,B=V);var V=p(I),mt=p(B),Bt,Kt,ue,Le=O==null?10:+O,ke=[];if(!(f%1)&&mt-V<Le){if(V=Math.round(V)-1,mt=Math.round(mt)+1,I>0){for(;V<mt;++V)for(Kt=1,Bt=y(V);Kt<f;++Kt)if(ue=Bt*Kt,!(ue<I)){if(ue>B)break;ke.push(ue)}}else for(;V<mt;++V)for(Kt=f-1,Bt=y(V);Kt>=1;--Kt)if(ue=Bt*Kt,!(ue<I)){if(ue>B)break;ke.push(ue)}}else ke=pv(V,mt,Math.min(mt-V,Le)).map(y);return j?ke.reverse():ke},i.tickFormat=function(O,A){if(A==null&&(A=f===10?".0e":","),typeof A!="function"&&(A=$l(A)),O===1/0)return A;O==null&&(O=10);var I=Math.max(1,f*O/i.ticks().length);return function(B){var j=B/y(Math.round(p(B)));return j*f<f-.5&&(j*=f),j<=I?A(B):""}},i.nice=function(){return s(Ef(s(),{floor:function(O){return y(Math.floor(p(O)))},ceil:function(O){return y(Math.ceil(p(O)))}}))},i}function Av(){var a=LM(Sf()).domain([1,10]);return a.copy=function(){return dp(a,Av()).base(a.base())},hs.apply(a,arguments),a}function Qx(a){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/a))}}function Tv(a){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*a}}function IM(a){var i=1,s=a(Qx(i),Tv(i));return s.constant=function(f){return arguments.length?a(Qx(i=+f),Tv(i)):i},linearish(s)}function RM(){var a=IM(transformer());return a.copy=function(){return copy(a,RM()).constant(a.constant())},initRange.apply(a,arguments)}function Jx(a){return function(i){return i<0?-Math.pow(-i,a):Math.pow(i,a)}}function eo(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function t2(a){return a<0?-a*a:a*a}function kM(a){var i=a(Xi,Xi),s=1;function f(){return s===1?a(Xi,Xi):s===.5?a(eo,t2):a(Jx(s),Jx(1/s))}return i.exponent=function(p){return arguments.length?(s=+p,f()):s},ra(i)}function Mv(){var a=kM(Sf());return a.copy=function(){return dp(a,Mv()).exponent(a.exponent())},hs.apply(a,arguments),a}function ui(){return Mv.apply(null,arguments).exponent(.5)}function Cv(){var a=[],i=[],s=[],f;function p(){var x=0,O=Math.max(1,i.length);for(s=new Array(O-1);++x<O;)s[x-1]=mM(a,x/O);return y}function y(x){return isNaN(x=+x)?f:i[tp(s,x)]}return y.invertExtent=function(x){var O=i.indexOf(x);return O<0?[NaN,NaN]:[O>0?s[O-1]:a[0],O<s.length?s[O]:a[a.length-1]]},y.domain=function(x){if(!arguments.length)return a.slice();a=[];for(var O=0,A=x.length,I;O<A;++O)I=x[O],I!=null&&!isNaN(I=+I)&&a.push(I);return a.sort(Jh),p()},y.range=function(x){return arguments.length?(i=Fc.call(x),p()):i.slice()},y.unknown=function(x){return arguments.length?(f=x,y):f},y.quantiles=function(){return s.slice()},y.copy=function(){return Cv().domain(a).range(i).unknown(f)},hs.apply(y,arguments)}function Pv(){var a=0,i=1,s=1,f=[.5],p=[0,1],y;function x(A){return A<=A?p[tp(f,A,0,s)]:y}function O(){var A=-1;for(f=new Array(s);++A<s;)f[A]=((A+1)*i-(A-s)*a)/(s+1);return x}return x.domain=function(A){return arguments.length?(a=+A[0],i=+A[1],O()):[a,i]},x.range=function(A){return arguments.length?(s=(p=Fc.call(A)).length-1,O()):p.slice()},x.invertExtent=function(A){var I=p.indexOf(A);return I<0?[NaN,NaN]:I<1?[a,f[0]]:I>=s?[f[s-1],i]:[f[I-1],f[I]]},x.unknown=function(A){return arguments.length&&(y=A),x},x.thresholds=function(){return f.slice()},x.copy=function(){return Pv().domain([a,i]).range(p).unknown(y)},hs.apply(ra(x),arguments)}function e2(){var a=[.5],i=[0,1],s,f=1;function p(y){return y<=y?i[tp(a,y,0,f)]:s}return p.domain=function(y){return arguments.length?(a=Fc.call(y),f=Math.min(a.length,i.length-1),p):a.slice()},p.range=function(y){return arguments.length?(i=Fc.call(y),f=Math.min(a.length,i.length-1),p):i.slice()},p.invertExtent=function(y){var x=i.indexOf(y);return[a[x-1],a[x]]},p.unknown=function(y){return arguments.length?(s=y,p):s},p.copy=function(){return e2().domain(a).range(i).unknown(s)},hs.apply(p,arguments)}var yp=new Date,Zo=new Date;function fo(a,i,s,f){function p(y){return a(y=arguments.length===0?new Date:new Date(+y)),y}return p.floor=function(y){return a(y=new Date(+y)),y},p.ceil=function(y){return a(y=new Date(y-1)),i(y,1),a(y),y},p.round=function(y){var x=p(y),O=p.ceil(y);return y-x<O-y?x:O},p.offset=function(y,x){return i(y=new Date(+y),x==null?1:Math.floor(x)),y},p.range=function(y,x,O){var A=[],I;if(y=p.ceil(y),O=O==null?1:Math.floor(O),!(y<x)||!(O>0))return A;do A.push(I=new Date(+y)),i(y,O),a(y);while(I<y&&y<x);return A},p.filter=function(y){return fo(function(x){if(x>=x)for(;a(x),!y(x);)x.setTime(x-1)},function(x,O){if(x>=x)if(O<0)for(;++O<=0;)for(;i(x,-1),!y(x););else for(;--O>=0;)for(;i(x,1),!y(x););})},s&&(p.count=function(y,x){return yp.setTime(+y),Zo.setTime(+x),a(yp),a(Zo),Math.floor(s(yp,Zo))},p.every=function(y){return y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?p.filter(f?function(x){return f(x)%y===0}:function(x){return p.count(0,x)%y===0}):p}),p}var Lv=fo(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,i){a.setFullYear(a.getFullYear()+i)},function(a,i){return i.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});Lv.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:fo(function(i){i.setFullYear(Math.floor(i.getFullYear()/a)*a),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,s){i.setFullYear(i.getFullYear()+s*a)})};var ql=Lv,PI=Lv.range,Iv=fo(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,i){a.setMonth(a.getMonth()+i)},function(a,i){return i.getMonth()-a.getMonth()+(i.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),DM=Iv,_p=Iv.range,Tf=1e3,Mf=6e4,n2=36e5,sr=864e5,NM=6048e5;function jc(a){return fo(function(i){i.setDate(i.getDate()-(i.getDay()+7-a)%7),i.setHours(0,0,0,0)},function(i,s){i.setDate(i.getDate()+s*7)},function(i,s){return(s-i-(s.getTimezoneOffset()-i.getTimezoneOffset())*Mf)/NM})}var r2=jc(0),FM=jc(1),BM=jc(2),jM=jc(3),zM=jc(4),UM=jc(5),ZM=jc(6),LI=r2.range,II=FM.range,Rv=BM.range,i2=jM.range,Cf=zM.range,Kl=UM.range,Pf=ZM.range,zc=fo(function(a){a.setHours(0,0,0,0)},function(a,i){a.setDate(a.getDate()+i)},function(a,i){return(i-a-(i.getTimezoneOffset()-a.getTimezoneOffset())*Mf)/sr},function(a){return a.getDate()-1}),Lf=zc,ms=zc.range,o2=fo(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Tf-a.getMinutes()*Mf)},function(a,i){a.setTime(+a+i*n2)},function(a,i){return(i-a)/n2},function(a){return a.getHours()}),HM=o2,RI=o2.range,a2=fo(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Tf)},function(a,i){a.setTime(+a+i*Mf)},function(a,i){return(i-a)/Mf},function(a){return a.getMinutes()}),WM=a2,kI=a2.range,s2=fo(function(a){a.setTime(a-a.getMilliseconds())},function(a,i){a.setTime(+a+i*Tf)},function(a,i){return(i-a)/Tf},function(a){return a.getUTCSeconds()}),c2=s2,VM=s2.range,bp=fo(function(){},function(a,i){a.setTime(+a+i)},function(a,i){return i-a});bp.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?fo(function(i){i.setTime(Math.floor(i/a)*a)},function(i,s){i.setTime(+i+s*a)},function(i,s){return(s-i)/a}):bp};var GM=bp,$M=bp.range,If=new Date,xp=new Date;function ia(a,i,s,f){function p(y){return a(y=arguments.length===0?new Date:new Date(+y)),y}return p.floor=function(y){return a(y=new Date(+y)),y},p.ceil=function(y){return a(y=new Date(y-1)),i(y,1),a(y),y},p.round=function(y){var x=p(y),O=p.ceil(y);return y-x<O-y?x:O},p.offset=function(y,x){return i(y=new Date(+y),x==null?1:Math.floor(x)),y},p.range=function(y,x,O){var A=[],I;if(y=p.ceil(y),O=O==null?1:Math.floor(O),!(y<x)||!(O>0))return A;do A.push(I=new Date(+y)),i(y,O),a(y);while(I<y&&y<x);return A},p.filter=function(y){return ia(function(x){if(x>=x)for(;a(x),!y(x);)x.setTime(x-1)},function(x,O){if(x>=x)if(O<0)for(;++O<=0;)for(;i(x,-1),!y(x););else for(;--O>=0;)for(;i(x,1),!y(x););})},s&&(p.count=function(y,x){return If.setTime(+y),xp.setTime(+x),a(If),a(xp),Math.floor(s(If,xp))},p.every=function(y){return y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?p.filter(f?function(x){return f(x)%y===0}:function(x){return p.count(0,x)%y===0}):p}),p}var YM=1e3,Rf=6e4,Ao=36e5,kv=864e5,l2=6048e5;function Vs(a){return ia(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-a)%7),i.setUTCHours(0,0,0,0)},function(i,s){i.setUTCDate(i.getUTCDate()+s*7)},function(i,s){return(s-i)/l2})}var kf=Vs(0),Za=Vs(1),Uc=Vs(2),u2=Vs(3),Zc=Vs(4),XM=Vs(5),_a=Vs(6),qM=kf.range,Dv=Za.range,f2=Uc.range,KM=u2.range,DI=Zc.range,NI=XM.range,d2=_a.range,Nv=ia(function(a){a.setUTCHours(0,0,0,0)},function(a,i){a.setUTCDate(a.getUTCDate()+i)},function(a,i){return(i-a)/kv},function(a){return a.getUTCDate()-1}),h2=Nv,FI=Nv.range;function Hc(a){return ia(function(i){i.setDate(i.getDate()-(i.getDay()+7-a)%7),i.setHours(0,0,0,0)},function(i,s){i.setDate(i.getDate()+s*7)},function(i,s){return(s-i-(s.getTimezoneOffset()-i.getTimezoneOffset())*Rf)/l2})}var Wc=Hc(0),Fv=Hc(1),p2=Hc(2),QM=Hc(3),Df=Hc(4),ai=Hc(5),g2=Hc(6),BI=Wc.range,JM=Fv.range,jI=p2.range,t5=QM.range,zI=Df.range,e5=ai.range,UI=g2.range,Bv=ia(function(a){a.setHours(0,0,0,0)},function(a,i){a.setDate(a.getDate()+i)},function(a,i){return(i-a-(i.getTimezoneOffset()-a.getTimezoneOffset())*Rf)/kv},function(a){return a.getDate()-1}),v2=Bv,n5=Bv.range,jv=ia(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,i){a.setFullYear(a.getFullYear()+i)},function(a,i){return i.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});jv.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:ia(function(i){i.setFullYear(Math.floor(i.getFullYear()/a)*a),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,s){i.setFullYear(i.getFullYear()+s*a)})};var Ql=jv,ZI=jv.range,Sp=ia(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,i){a.setUTCFullYear(a.getUTCFullYear()+i)},function(a,i){return i.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});Sp.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:ia(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/a)*a),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,s){i.setUTCFullYear(i.getUTCFullYear()+s*a)})};var Nf=Sp,r5=Sp.range;function zv(a){if(0<=a.y&&a.y<100){var i=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return i.setFullYear(a.y),i}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function wp(a){if(0<=a.y&&a.y<100){var i=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return i.setUTCFullYear(a.y),i}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function Ff(a,i,s){return{y:a,m:i,d:s,H:0,M:0,S:0,L:0}}function m2(a){var i=a.dateTime,s=a.date,f=a.time,p=a.periods,y=a.days,x=a.shortDays,O=a.months,A=a.shortMonths,I=Bf(p),B=Jl(p),j=Bf(y),V=Jl(y),mt=Bf(x),Bt=Jl(x),Kt=Bf(O),ue=Jl(O),Le=Bf(A),ke=Jl(A),He={a:xr,A:vo,b:Io,B:p0,c:null,d:R2,e:R2,f:h5,g:v5,G:y5,H:k2,I:d5,j:D2,L:N2,m:Op,M:Zv,p:wy,q:qP,Q:oa,s:Wv,S:tu,u:Vc,U:eu,V:jf,w:Ha,W:p5,x:null,X:null,y:g5,Y:m5,Z:_5,"%":X2},Ye={a:Lw,A:g0,b:KP,B:QP,c:null,d:F2,e:F2,f:U2,g:$c,G:$2,H:B2,I:j2,j:b5,L:z2,m:Hv,M:Z2,p:Iw,q:JP,Q:oa,s:Wv,S:Ep,u:H2,U:W2,V:V2,w:x5,W:G2,x:null,X:null,y:Ap,Y:Yc,Z:Y2,"%":X2},rn={a:cr,A:Gn,b:ar,B:mr,c:po,d:A2,e:A2,f:u5,g:w2,G:Uv,H:M2,I:M2,j:T2,L:P2,m:E2,M:C2,p:Jn,q:c5,Q:f5,s:I2,S:l5,u:x2,U:a5,V:S2,w:o5,W:s5,x:xa,X:go,y:w2,Y:Uv,Z:O2,"%":L2};He.x=bn(s,He),He.X=bn(f,He),He.c=bn(i,He),Ye.x=bn(s,Ye),Ye.X=bn(f,Ye),Ye.c=bn(i,Ye);function bn(Un,hr){return function(wr){var Tn=[],mo=-1,Hr=0,xo=Un.length,Ki,qa,Tu;for(wr instanceof Date||(wr=new Date(+wr));++mo<xo;)Un.charCodeAt(mo)===37&&(Tn.push(Un.slice(Hr,mo)),(qa=y2[Ki=Un.charAt(++mo)])!=null?Ki=Un.charAt(++mo):qa=Ki==="e"?" ":"0",(Tu=hr[Ki])&&(Ki=Tu(wr,qa)),Tn.push(Ki),Hr=mo+1);return Tn.push(Un.slice(Hr,mo)),Tn.join("")}}function hn(Un,hr){return function(wr){var Tn=Ff(1900,void 0,1),mo=Cn(Tn,Un,wr+="",0),Hr,xo;if(mo!=wr.length)return null;if("Q"in Tn)return new Date(Tn.Q);if("s"in Tn)return new Date(Tn.s*1e3+("L"in Tn?Tn.L:0));if(hr&&!("Z"in Tn)&&(Tn.Z=0),"p"in Tn&&(Tn.H=Tn.H%12+Tn.p*12),Tn.m===void 0&&(Tn.m="q"in Tn?Tn.q:0),"V"in Tn){if(Tn.V<1||Tn.V>53)return null;"w"in Tn||(Tn.w=1),"Z"in Tn?(Hr=wp(Ff(Tn.y,0,1)),xo=Hr.getUTCDay(),Hr=xo>4||xo===0?Za.ceil(Hr):Za(Hr),Hr=h2.offset(Hr,(Tn.V-1)*7),Tn.y=Hr.getUTCFullYear(),Tn.m=Hr.getUTCMonth(),Tn.d=Hr.getUTCDate()+(Tn.w+6)%7):(Hr=zv(Ff(Tn.y,0,1)),xo=Hr.getDay(),Hr=xo>4||xo===0?Fv.ceil(Hr):Fv(Hr),Hr=v2.offset(Hr,(Tn.V-1)*7),Tn.y=Hr.getFullYear(),Tn.m=Hr.getMonth(),Tn.d=Hr.getDate()+(Tn.w+6)%7)}else("W"in Tn||"U"in Tn)&&("w"in Tn||(Tn.w="u"in Tn?Tn.u%7:"W"in Tn?1:0),xo="Z"in Tn?wp(Ff(Tn.y,0,1)).getUTCDay():zv(Ff(Tn.y,0,1)).getDay(),Tn.m=0,Tn.d="W"in Tn?(Tn.w+6)%7+Tn.W*7-(xo+5)%7:Tn.w+Tn.U*7-(xo+6)%7);return"Z"in Tn?(Tn.H+=Tn.Z/100|0,Tn.M+=Tn.Z%100,wp(Tn)):zv(Tn)}}function Cn(Un,hr,wr,Tn){for(var mo=0,Hr=hr.length,xo=wr.length,Ki,qa;mo<Hr;){if(Tn>=xo)return-1;if(Ki=hr.charCodeAt(mo++),Ki===37){if(Ki=hr.charAt(mo++),qa=rn[Ki in y2?hr.charAt(mo++):Ki],!qa||(Tn=qa(Un,wr,Tn))<0)return-1}else if(Ki!=wr.charCodeAt(Tn++))return-1}return Tn}function Jn(Un,hr,wr){var Tn=I.exec(hr.slice(wr));return Tn?(Un.p=B[Tn[0].toLowerCase()],wr+Tn[0].length):-1}function cr(Un,hr,wr){var Tn=mt.exec(hr.slice(wr));return Tn?(Un.w=Bt[Tn[0].toLowerCase()],wr+Tn[0].length):-1}function Gn(Un,hr,wr){var Tn=j.exec(hr.slice(wr));return Tn?(Un.w=V[Tn[0].toLowerCase()],wr+Tn[0].length):-1}function ar(Un,hr,wr){var Tn=Le.exec(hr.slice(wr));return Tn?(Un.m=ke[Tn[0].toLowerCase()],wr+Tn[0].length):-1}function mr(Un,hr,wr){var Tn=Kt.exec(hr.slice(wr));return Tn?(Un.m=ue[Tn[0].toLowerCase()],wr+Tn[0].length):-1}function po(Un,hr,wr){return Cn(Un,i,hr,wr)}function xa(Un,hr,wr){return Cn(Un,s,hr,wr)}function go(Un,hr,wr){return Cn(Un,f,hr,wr)}function xr(Un){return x[Un.getDay()]}function vo(Un){return y[Un.getDay()]}function Io(Un){return A[Un.getMonth()]}function p0(Un){return O[Un.getMonth()]}function wy(Un){return p[+(Un.getHours()>=12)]}function qP(Un){return 1+~~(Un.getMonth()/3)}function Lw(Un){return x[Un.getUTCDay()]}function g0(Un){return y[Un.getUTCDay()]}function KP(Un){return A[Un.getUTCMonth()]}function QP(Un){return O[Un.getUTCMonth()]}function Iw(Un){return p[+(Un.getUTCHours()>=12)]}function JP(Un){return 1+~~(Un.getUTCMonth()/3)}return{format:function(Un){var hr=bn(Un+="",He);return hr.toString=function(){return Un},hr},parse:function(Un){var hr=hn(Un+="",!1);return hr.toString=function(){return Un},hr},utcFormat:function(Un){var hr=bn(Un+="",Ye);return hr.toString=function(){return Un},hr},utcParse:function(Un){var hr=hn(Un+="",!0);return hr.toString=function(){return Un},hr}}}var y2={"-":"",_:" ",0:"0"},qi=/^\s*\d+/,i5=/^%/,_2=/[\\^$*+?|[\]().{}]/g;function Dr(a,i,s){var f=a<0?"-":"",p=(f?-a:a)+"",y=p.length;return f+(y<s?new Array(s-y+1).join(i)+p:p)}function b2(a){return a.replace(_2,"\\$&")}function Bf(a){return new RegExp("^(?:"+a.map(b2).join("|")+")","i")}function Jl(a){for(var i={},s=-1,f=a.length;++s<f;)i[a[s].toLowerCase()]=s;return i}function o5(a,i,s){var f=qi.exec(i.slice(s,s+1));return f?(a.w=+f[0],s+f[0].length):-1}function x2(a,i,s){var f=qi.exec(i.slice(s,s+1));return f?(a.u=+f[0],s+f[0].length):-1}function a5(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.U=+f[0],s+f[0].length):-1}function S2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.V=+f[0],s+f[0].length):-1}function s5(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.W=+f[0],s+f[0].length):-1}function Uv(a,i,s){var f=qi.exec(i.slice(s,s+4));return f?(a.y=+f[0],s+f[0].length):-1}function w2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.y=+f[0]+(+f[0]>68?1900:2e3),s+f[0].length):-1}function O2(a,i,s){var f=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(s,s+6));return f?(a.Z=f[1]?0:-(f[2]+(f[3]||"00")),s+f[0].length):-1}function c5(a,i,s){var f=qi.exec(i.slice(s,s+1));return f?(a.q=f[0]*3-3,s+f[0].length):-1}function E2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.m=f[0]-1,s+f[0].length):-1}function A2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.d=+f[0],s+f[0].length):-1}function T2(a,i,s){var f=qi.exec(i.slice(s,s+3));return f?(a.m=0,a.d=+f[0],s+f[0].length):-1}function M2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.H=+f[0],s+f[0].length):-1}function C2(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.M=+f[0],s+f[0].length):-1}function l5(a,i,s){var f=qi.exec(i.slice(s,s+2));return f?(a.S=+f[0],s+f[0].length):-1}function P2(a,i,s){var f=qi.exec(i.slice(s,s+3));return f?(a.L=+f[0],s+f[0].length):-1}function u5(a,i,s){var f=qi.exec(i.slice(s,s+6));return f?(a.L=Math.floor(f[0]/1e3),s+f[0].length):-1}function L2(a,i,s){var f=i5.exec(i.slice(s,s+1));return f?s+f[0].length:-1}function f5(a,i,s){var f=qi.exec(i.slice(s));return f?(a.Q=+f[0],s+f[0].length):-1}function I2(a,i,s){var f=qi.exec(i.slice(s));return f?(a.s=+f[0],s+f[0].length):-1}function R2(a,i){return Dr(a.getDate(),i,2)}function k2(a,i){return Dr(a.getHours(),i,2)}function d5(a,i){return Dr(a.getHours()%12||12,i,2)}function D2(a,i){return Dr(1+v2.count(Ql(a),a),i,3)}function N2(a,i){return Dr(a.getMilliseconds(),i,3)}function h5(a,i){return N2(a,i)+"000"}function Op(a,i){return Dr(a.getMonth()+1,i,2)}function Zv(a,i){return Dr(a.getMinutes(),i,2)}function tu(a,i){return Dr(a.getSeconds(),i,2)}function Vc(a){var i=a.getDay();return i===0?7:i}function eu(a,i){return Dr(Wc.count(Ql(a)-1,a),i,2)}function Gc(a){var i=a.getDay();return i>=4||i===0?Df(a):Df.ceil(a)}function jf(a,i){return a=Gc(a),Dr(Df.count(Ql(a),a)+(Ql(a).getDay()===4),i,2)}function Ha(a){return a.getDay()}function p5(a,i){return Dr(Fv.count(Ql(a)-1,a),i,2)}function g5(a,i){return Dr(a.getFullYear()%100,i,2)}function v5(a,i){return a=Gc(a),Dr(a.getFullYear()%100,i,2)}function m5(a,i){return Dr(a.getFullYear()%1e4,i,4)}function y5(a,i){var s=a.getDay();return a=s>=4||s===0?Df(a):Df.ceil(a),Dr(a.getFullYear()%1e4,i,4)}function _5(a){var i=a.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+Dr(i/60|0,"0",2)+Dr(i%60,"0",2)}function F2(a,i){return Dr(a.getUTCDate(),i,2)}function B2(a,i){return Dr(a.getUTCHours(),i,2)}function j2(a,i){return Dr(a.getUTCHours()%12||12,i,2)}function b5(a,i){return Dr(1+h2.count(Nf(a),a),i,3)}function z2(a,i){return Dr(a.getUTCMilliseconds(),i,3)}function U2(a,i){return z2(a,i)+"000"}function Hv(a,i){return Dr(a.getUTCMonth()+1,i,2)}function Z2(a,i){return Dr(a.getUTCMinutes(),i,2)}function Ep(a,i){return Dr(a.getUTCSeconds(),i,2)}function H2(a){var i=a.getUTCDay();return i===0?7:i}function W2(a,i){return Dr(kf.count(Nf(a)-1,a),i,2)}function ho(a){var i=a.getUTCDay();return i>=4||i===0?Zc(a):Zc.ceil(a)}function V2(a,i){return a=ho(a),Dr(Zc.count(Nf(a),a)+(Nf(a).getUTCDay()===4),i,2)}function x5(a){return a.getUTCDay()}function G2(a,i){return Dr(Za.count(Nf(a)-1,a),i,2)}function Ap(a,i){return Dr(a.getUTCFullYear()%100,i,2)}function $c(a,i){return a=ho(a),Dr(a.getUTCFullYear()%100,i,2)}function Yc(a,i){return Dr(a.getUTCFullYear()%1e4,i,4)}function $2(a,i){var s=a.getUTCDay();return a=s>=4||s===0?Zc(a):Zc.ceil(a),Dr(a.getUTCFullYear()%1e4,i,4)}function Y2(){return"+0000"}function X2(){return"%"}function oa(a){return+a}function Wv(a){return Math.floor(+a/1e3)}var ys,Tp,S5,w5,q2;Vv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Vv(a){return ys=m2(a),Tp=ys.format,S5=ys.parse,w5=ys.utcFormat,q2=ys.utcParse,ys}var Xc=1e3,Gs=Xc*60,_s=Gs*60,nu=_s*24,K2=nu*7,Gv=nu*30,$v=nu*365;function $s(a){return new Date(a)}function qc(a){return a instanceof Date?+a:+new Date(+a)}function Q2(a,i,s,f,p,y,x,O,A){var I=hp(Xi,Xi),B=I.invert,j=I.domain,V=A(".%L"),mt=A(":%S"),Bt=A("%I:%M"),Kt=A("%I %p"),ue=A("%a %d"),Le=A("%b %d"),ke=A("%B"),He=A("%Y"),Ye=[[x,1,Xc],[x,5,5*Xc],[x,15,15*Xc],[x,30,30*Xc],[y,1,Gs],[y,5,5*Gs],[y,15,15*Gs],[y,30,30*Gs],[p,1,_s],[p,3,3*_s],[p,6,6*_s],[p,12,12*_s],[f,1,nu],[f,2,2*nu],[s,1,K2],[i,1,Gv],[i,3,3*Gv],[a,1,$v]];function rn(hn){return(x(hn)<hn?V:y(hn)<hn?mt:p(hn)<hn?Bt:f(hn)<hn?Kt:i(hn)<hn?s(hn)<hn?ue:Le:a(hn)<hn?ke:He)(hn)}function bn(hn,Cn,Jn,cr){if(hn==null&&(hn=10),typeof hn=="number"){var Gn=Math.abs(Jn-Cn)/hn,ar=Ba(function(mr){return mr[2]}).right(Ye,Gn);ar===Ye.length?(cr=Ul(Cn/$v,Jn/$v,hn),hn=a):ar?(ar=Ye[Gn/Ye[ar-1][2]<Ye[ar][2]/Gn?ar-1:ar],cr=ar[1],hn=ar[0]):(cr=Math.max(Ul(Cn,Jn,hn),1),hn=O)}return cr==null?hn:hn.every(cr)}return I.invert=function(hn){return new Date(B(hn))},I.domain=function(hn){return arguments.length?j(Nx.call(hn,qc)):j().map($s)},I.ticks=function(hn,Cn){var Jn=j(),cr=Jn[0],Gn=Jn[Jn.length-1],ar=Gn<cr,mr;return ar&&(mr=cr,cr=Gn,Gn=mr),mr=bn(hn,cr,Gn,Cn),mr=mr?mr.range(cr,Gn+1):[],ar?mr.reverse():mr},I.tickFormat=function(hn,Cn){return Cn==null?rn:A(Cn)},I.nice=function(hn,Cn){var Jn=j();return(hn=bn(hn,Jn[0],Jn[Jn.length-1],Cn))?j(Ef(Jn,hn)):I},I.copy=function(){return dp(I,Q2(a,i,s,f,p,y,x,O,A))},I}function O5(){return hs.apply(Q2(ql,DM,r2,Lf,HM,WM,c2,GM,Tp).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function E5(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ru(){var a=0,i=1,s,f,p,y,x=Xi,O=!1,A;function I(B){return isNaN(B=+B)?A:x(p===0?.5:(B=(y(B)-s)*p,O?Math.max(0,Math.min(1,B)):B))}return I.domain=function(B){return arguments.length?(s=y(a=+B[0]),f=y(i=+B[1]),p=s===f?0:1/(f-s),I):[a,i]},I.clamp=function(B){return arguments.length?(O=!!B,I):O},I.interpolator=function(B){return arguments.length?(x=B,I):x},I.unknown=function(B){return arguments.length?(A=B,I):A},function(B){return y=B,s=B(a),f=B(i),p=s===f?0:1/(f-s),I}}function Kc(a,i){return i.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function zf(){var a=ra(ru()(Xi));return a.copy=function(){return Kc(a,zf())},sp.apply(a,arguments)}function Uf(){var a=loggish(ru()).domain([1,10]);return a.copy=function(){return Kc(a,Uf()).base(a.base())},initInterpolator.apply(a,arguments)}function J2(){var a=symlogish(ru());return a.copy=function(){return Kc(a,J2()).constant(a.constant())},initInterpolator.apply(a,arguments)}function Yv(){var a=powish(ru());return a.copy=function(){return Kc(a,Yv()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function A5(){return Yv.apply(null,arguments).exponent(.5)}function T5(){var a=[],i=identity;function s(f){if(!isNaN(f=+f))return i((bisect(a,f)-1)/(a.length-1))}return s.domain=function(f){if(!arguments.length)return a.slice();a=[];for(var p=0,y=f.length,x;p<y;++p)x=f[p],x!=null&&!isNaN(x=+x)&&a.push(x);return a.sort(ascending),s},s.interpolator=function(f){return arguments.length?(i=f,s):i},s.copy=function(){return T5(i).domain(a)},initInterpolator.apply(s,arguments)}function iu(){var a=0,i=.5,s=1,f,p,y,x,O,A=Xi,I,B=!1,j;function V(mt){return isNaN(mt=+mt)?j:(mt=.5+((mt=+I(mt))-p)*(mt<p?x:O),A(B?Math.max(0,Math.min(1,mt)):mt))}return V.domain=function(mt){return arguments.length?(f=I(a=+mt[0]),p=I(i=+mt[1]),y=I(s=+mt[2]),x=f===p?0:.5/(p-f),O=p===y?0:.5/(y-p),V):[a,i,s]},V.clamp=function(mt){return arguments.length?(B=!!mt,V):B},V.interpolator=function(mt){return arguments.length?(A=mt,V):A},V.unknown=function(mt){return arguments.length?(j=mt,V):j},function(mt){return I=mt,f=mt(a),p=mt(i),y=mt(s),x=f===p?0:.5/(p-f),O=p===y?0:.5/(y-p),V}}function Ys(){var a=ra(iu()(Xi));return a.copy=function(){return Kc(a,Ys())},sp.apply(a,arguments)}function t3(){var a=loggish(iu()).domain([.1,1,10]);return a.copy=function(){return copy(a,t3()).base(a.base())},initInterpolator.apply(a,arguments)}function HI(){var a=symlogish(iu());return a.copy=function(){return copy(a,HI()).constant(a.constant())},initInterpolator.apply(a,arguments)}function Mp(){var a=powish(iu());return a.copy=function(){return copy(a,Mp()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function WI(){return Mp.apply(null,arguments).exponent(.5)}function e3(a){let i,s=[];function f(p){return p==null?i:p}return f.invert=f,f.domain=f.range=p=>p?(s=p,p):s,f.unknown=p=>p?(i=p,p):i,f.copy=()=>e3(a).unknown(i),f}const{isNil:Xv,isString:Cp,uniq:M5}=hi,Pp=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,C5={[_r.LINEAR]:qx,[_r.POWER]:Mv,[_r.LOG]:Av,[_r.IDENTITY]:e3,[_r.SEQUENTIAL]:zf,[_r.TIME]:O5,[_r.QUANTILE]:Cv,[_r.QUANTIZE]:Pv,[_r.THRESHOLD]:e2,[_r.CAT]:_f,[_r.DIVERGING]:Ys};class P5{constructor(){(0,ot.Z)(this,"scaleOptions",{})}apply(i,{styleAttributeService:s}){var f=this;i.hooks.init.tapPromise("FeatureScalePlugin",(0,ln.Z)(function*(){var p;i.log($i.ScaleInitStart,oo.INIT),f.scaleOptions=i.getScaleOptions();const y=s.getLayerStyleAttributes(),x=(p=i.getSource())===null||p===void 0?void 0:p.data.dataArray;Array.isArray(x)&&x.length===0||(f.caculateScalesForAttributes(y||[],x),i.log($i.ScaleInitEnd,oo.INIT))})),i.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var p=(0,ln.Z)(function*(y){if(!y)return y;i.log($i.ScaleInitStart,oo.UPDATE),f.scaleOptions=i.getScaleOptions();const x=s.getLayerStyleAttributes(),O=i.getSource().data.dataArray;return Array.isArray(O)&&O.length===0||(f.caculateScalesForAttributes(x||[],O),i.log($i.ScaleInitEnd,oo.UPDATE),i.layerModelNeedUpdate=!0),!0});return function(y){return p.apply(this,arguments)}}()),i.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(i.layerModelNeedUpdate)return;this.scaleOptions=i.getScaleOptions();const p=s.getLayerStyleAttributes(),y=i.getSource().data.dataArray;if(!(Array.isArray(y)&&y.length===0)&&p){const x=p.filter(O=>O.needRescale);x.length&&this.caculateScalesForAttributes(x,y)}})}isNumber(i){return!isNaN(parseFloat(i))&&isFinite(i)}caculateScalesForAttributes(i,s){i.forEach(f=>{if(f.scale){const p=f.scale,y=f.scale.field;p.names=this.parseFields(Xv(y)?[]:y);const x=[];p.names.forEach(O=>{var A;x.push(this.createScale(O,f.name,(A=f.scale)===null||A===void 0?void 0:A.values,s))}),x.some(O=>O.type===Ml.VARIABLE)?(p.type=Ml.VARIABLE,x.forEach(O=>{if(!p.callback&&p.values!=="text"){var A;switch((A=O.option)===null||A===void 0?void 0:A.type){case _r.LOG:case _r.LINEAR:case _r.POWER:if(p.values&&p.values.length>2){const B=O.scale.ticks(p.values.length);O.scale.domain(B)}p.values?O.scale.range(p.values):O.scale.range(O.option.domain);break;case _r.QUANTILE:case _r.QUANTIZE:case _r.THRESHOLD:O.scale.range(p.values);break;case _r.IDENTITY:break;case _r.CAT:p.values?O.scale.range(p.values):O.scale.range(O.option.domain);break;case _r.DIVERGING:case _r.SEQUENTIAL:O.scale.interpolator(hM(p.values));break}}if(p.values==="text"){var I;O.scale.range((I=O.option)===null||I===void 0?void 0:I.domain)}})):(p.type=Ml.CONSTANT,p.defaultValues=x.map((O,A)=>O.scale(p.names[A]))),p.scalers=x.map(O=>({field:O.field,func:O.scale,option:O.option})),f.needRescale=!1}})}parseFields(i){return Array.isArray(i)?i:Cp(i)?i.split("*"):[i]}createScale(i,s,f,p){var y,x;const O=this.scaleOptions[s]&&((y=this.scaleOptions[s])===null||y===void 0?void 0:y.field)===i?this.scaleOptions[s]:this.scaleOptions[i],A={field:i,scale:void 0,type:Ml.VARIABLE,option:O};if(!p||!p.length)return O&&O.type?A.scale=this.createDefaultScale(O):(A.scale=_f([i]),A.type=Ml.CONSTANT),A;const I=(x=p.find(B=>!Xv(B[i])))===null||x===void 0?void 0:x[i];if(this.isNumber(i)||Xv(I)&&!O)A.scale=_f([i]),A.type=Ml.CONSTANT;else{let B=O&&O.type||this.getDefaultType(I);f==="text"&&(B=_r.CAT),f===void 0&&(B=_r.IDENTITY);const j=this.createScaleConfig(B,i,O,p);A.scale=this.createDefaultScale(j),A.option=j}return A}getDefaultType(i){let s=_r.LINEAR;return typeof i=="string"&&(s=Pp.test(i)?_r.TIME:_r.CAT),s}createScaleConfig(i,s,f,p){const y=(0,on.Z)((0,on.Z)({},f),{},{type:i});if(y!=null&&y.domain)return y;let x=[];if(i===_r.QUANTILE){const O=new Map;p==null||p.forEach(A=>{O.set(A._id,A[s])}),x=Array.from(O.values())}else x=(p==null?void 0:p.map(O=>O[s]))||[];if(i===_r.CAT||i===_r.IDENTITY)y.domain=M5(x);else if(i===_r.QUANTILE)y.domain=x;else if(i===_r.DIVERGING){const O=qh(x),A=(f==null?void 0:f.neutral)!==void 0?f==null?void 0:f.neutral:(O[0]+O[1])/2;y.domain=[O[0],A,O[1]]}else y.domain=qh(x);return y}createDefaultScale({type:i,domain:s,unknown:f,clamp:p,nice:y}){const x=C5[i]();return s&&x.domain&&x.domain(s),f&&x.unknown(f),p!==void 0&&x.clamp&&x.clamp(p),y!==void 0&&x.nice&&x.nice(y),x}}class L5{apply(i){i.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{i.animateStatus&&i.models.forEach(f=>{f.addUniforms((0,on.Z)({},i.layerModel.getAnimateUniforms()))})})}}class I5{apply(i){i.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:s,enableMask:f}=i.getLayerConfig();!i.tileLayer&&s&&s.length>0&&i.updateLayerConfig({mask:f})})}}class Lp{build(i){return(0,ln.Z)(function*(){i.prepareBuildModel(),yield i.buildModels()})()}initLayerModel(i){var s=this;return(0,ln.Z)(function*(){yield s.build(i),i.styleNeedUpdate=!1})()}prepareLayerModel(i){var s=this;return(0,ln.Z)(function*(){yield s.build(i),i.styleNeedUpdate=!1})()}apply(i){var s=this;i.hooks.init.tapPromise("LayerModelPlugin",(0,ln.Z)(function*(){if(i.getSource().isTile){i.prepareBuildModel();return}i.log($i.BuildModelStart,oo.INIT),yield s.initLayerModel(i),i.log($i.BuildModelEnd,oo.INIT)})),i.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var f=(0,ln.Z)(function*(p){return!p||i.getSource().isTile?!1:(i.log($i.BuildModelStart,oo.UPDATE),yield s.prepareLayerModel(i),i.log($i.BuildModelEnd,oo.UPDATE),!0)});return function(p){return f.apply(this,arguments)}}())}}class R5{apply(i){i.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:s,fitBoundsOptions:f}=i.getLayerConfig();s&&i.fitBounds(f),i.styleNeedUpdate=!1})}}const k5=["type"],n3={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},D5={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},N5={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},F5={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function B5(a){const i={u_DirectionalLights:new Array(3).fill((0,on.Z)({},N5)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,on.Z)({},F5)),u_NumOfSpotLights:0};return(!a||!a.length)&&(a=[D5]),a.forEach(s=>{let{type:f="directional"}=s,p=(0,jo.Z)(s,k5);const y=n3[f].lights,x=n3[f].num,O=i[x];i[y][O]=(0,on.Z)((0,on.Z)({},i[y][O]),p),i[x]++}),i}class j5{apply(i){i.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:s}=i.getLayerConfig();s&&i.models.forEach(f=>f.addUniforms((0,on.Z)({},B5())))})}}function r3(a){return a.map(i=>(typeof i=="string"&&(i=[i,{}]),i))}function qv(a,i,s,f){const p=a.multiPassRenderer;return p.add(f("render")),r3(i).forEach(y=>{const[x,O]=y;p.add(s(x),O)}),p.add(s("copy")),p}class i3{constructor(){(0,ot.Z)(this,"enabled",void 0)}apply(i,{rendererService:s,postProcessingPassFactory:f,normalPassFactory:p}){i.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:y,passes:x=[]}=i.getLayerConfig();this.enabled=!!y&&i.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(i.multiPassRenderer=qv(i,x,f,p),i.multiPassRenderer.setRenderFlag(!0))}),i.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:y,height:x}=s.getViewportSize();i.multiPassRenderer.resize(y,x)}})}}const Xs={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function z5(a){switch(a){case"rotation":return{name:"Rotation",type:Nn.Attribute,descriptor:{name:"a_Rotation",shaderLocation:Xs.ROTATION,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{rotation:s=0}=i;return Array.isArray(s)?[s[0]]:[s]}}};case"stroke":return{name:"stroke",type:Nn.Attribute,descriptor:{name:"a_Stroke",shaderLocation:Xs.STROKE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:4,update:i=>{const{stroke:s=[1,1,1,1]}=i;return s}}};case"opacity":return{name:"opacity",type:Nn.Attribute,descriptor:{name:"a_Opacity",shaderLocation:Xs.OPACITY,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{opacity:s=1}=i;return[s]}}};case"offsets":return{name:"offsets",type:Nn.Attribute,descriptor:{name:"a_Offsets",shaderLocation:Xs.OFFSETS,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const{offsets:s}=i;return s}}};default:return}}const{isNumber:o3}=hi,ou={NONE:0,ENCODE:1,HIGHLIGHT:2};class U5{constructor(){(0,ot.Z)(this,"pickingUniformMap",void 0)}pickOption2Array(){const i=[];return this.pickingUniformMap.forEach(s=>{o3(s)?i.push(s):i.push(...s)}),i}updatePickOption(i,s){Object.keys(i).forEach(x=>{this.pickingUniformMap.set(x,i[x])});const f=s.getLayerConfig().pickingBuffer||0,p=Number(s.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",f),this.pickingUniformMap.set("u_shaderPick",p),s.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(i,{styleAttributeService:s}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),i.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();s.registerStyleAttribute({name:"pickingColor",type:Nn.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:Xs.PICKING_COLOR,buffer:{data:[],type:dt.FLOAT},size:3,update:p=>{const{id:y}=p;return f?ul(y):[0,0,0]}}})}),i.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();f&&i.isVisible()&&(this.updatePickOption({u_PickingStage:ou.ENCODE},i),i.models.forEach(p=>p.addUniforms({u_PickingStage:ou.ENCODE})))}),i.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();f&&i.isVisible()&&(this.updatePickOption({u_PickingStage:ou.HIGHLIGHT},i),i.models.forEach(p=>p.addUniforms({u_PickingStage:ou.HIGHLIGHT})))}),i.hooks.beforeHighlight.tap("PixelPickingPlugin",f=>{const{highlightColor:p,activeMix:y=0}=i.getLayerConfig(),x=typeof p=="string"?Gr(p):p||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:dc(new Uint8Array(f))});const O={u_PickingStage:ou.HIGHLIGHT,u_PickingColor:f,u_HighlightColor:x.map(A=>A*255),u_activeMix:y};this.updatePickOption(O,i),i.models.forEach(A=>A.addUniforms(O))}),i.hooks.beforeSelect.tap("PixelPickingPlugin",f=>{const{selectColor:p,selectMix:y=0}=i.getLayerConfig(),x=typeof p=="string"?Gr(p):p||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:dc(new Uint8Array(f))});const O={u_PickingStage:ou.HIGHLIGHT,u_PickingColor:f,u_HighlightColor:x.map(A=>A*255),u_activeMix:y,u_CurrentSelectedId:f,u_SelectColor:x.map(A=>A*255)};this.updatePickOption(O,i),i.models.forEach(A=>A.addUniforms(O))})}}const Z5=["mvt","geojsonvt","testTile"];function a3(a){const i=a.getSource();return Z5.includes(i.parser.type)}class s3{apply(i,{styleAttributeService:s}){i.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{a3(i)||this.registerBuiltinAttributes(s,i)})}registerBuiltinAttributes(i,s){if(s.type==="MaskLayer"){this.registerPositionAttribute(i);return}this.registerPositionAttribute(i),this.registerColorAttribute(i)}registerPositionAttribute(i){i.registerStyleAttribute({name:"position",type:Nn.Attribute,descriptor:{name:"a_Position",shaderLocation:Xs.POSITION,buffer:{data:[],type:dt.FLOAT},size:3,update:(s,f,p)=>p.length===2?[p[0],p[1],0]:[p[0],p[1],p[2]]}})}registerColorAttribute(i){i.registerStyleAttribute({name:"color",type:Nn.Attribute,descriptor:{name:"a_Color",shaderLocation:Xs.COLOR,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:4,update:s=>{const{color:f}=s;return!f||!f.length?[1,1,1,1]:f}}})}}class H5{constructor(){(0,ot.Z)(this,"cameraService",void 0),(0,ot.Z)(this,"coordinateSystemService",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"mapService",void 0),(0,ot.Z)(this,"layerService",void 0)}apply(i,{rendererService:s,mapService:f,layerService:p,coordinateSystemService:y,cameraService:x}){this.rendererService=s,this.mapService=f,this.layerService=p,this.coordinateSystemService=y,this.cameraService=x;let O;this.rendererService.uniformBuffers[0]||(O=this.rendererService.createBuffer({data:new Float32Array(96),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=O),i.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const I=i.getRelativeOrigin&&i.getRelativeOrigin()||[0,0];this.coordinateSystemService.refresh(),I&&(Math.abs(I[0])>1e-4||Math.abs(I[1])>1e-4)&&this.coordinateSystemService.getCoordinateSystem()===2&&this.coordinateSystemService.setViewportCenter(I);const{width:j,height:V}=this.rendererService.getViewportSize(),{data:mt,uniforms:Bt}=this.generateUBO(j,V,I);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:mt}),this.rendererService.queryVerdorInfo()==="WebGL1"&&i.models.forEach(ue=>{ue.addUniforms((0,on.Z)((0,on.Z)({},Bt),{},{u_PickingBuffer:i.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(i.getShaderPickStat())}))})})}generateUBO(i,s,f){const p=this.cameraService.getProjectionMatrix(),y=this.cameraService.getViewMatrix(),x=this.cameraService.getViewProjectionMatrix(),O=this.cameraService.getModelMatrix(),A=this.coordinateSystemService.getViewportCenterProjection(),I=this.coordinateSystemService.getPixelsPerDegree(),B=this.cameraService.getZoom(),j=this.coordinateSystemService.getPixelsPerDegree2(),V=this.cameraService.getZoomScale(),mt=this.coordinateSystemService.getPixelsPerMeter(),Bt=this.coordinateSystemService.getCoordinateSystem(),Kt=this.cameraService.getCameraPosition(),ue=window.devicePixelRatio,Le=this.coordinateSystemService.getViewportCenter(),ke=[i,s],He=this.cameraService.getFocalDistance(),Ye=f&&f.length>=2?[f[0],f[1]]:[0,0];return{data:[...y,...p,...x,...O,...A,...I,B,...j,V,...mt,Bt,...Kt,ue,...Le,...ke,He,...Ye,0],uniforms:{[wc.ProjectionMatrix]:p,[wc.ViewMatrix]:y,[wc.ViewProjectionMatrix]:x,[wc.Zoom]:B,[wc.ZoomScale]:V,[wc.FocalDistance]:He,[wc.CameraPosition]:Kt,[Al.CoordinateSystem]:Bt,[Al.ViewportCenter]:Le,[Al.ViewportCenterProjection]:A,[Al.PixelsPerDegree]:I,[Al.PixelsPerDegree2]:j,[Al.PixelsPerMeter]:mt,u_ViewportSize:ke,u_ModelMatrix:O,u_DevicePixelRatio:ue,u_RelativeOrigin:Ye}}}}class W5{apply(i){i.hooks.beforeRender.tap("UpdateModelPlugin",()=>{i.layerModel&&i.layerModel.needUpdate().then(s=>{s&&i.renderLayers()})}),i.hooks.afterRender.tap("UpdateModelPlugin",()=>{i.layerModelNeedUpdate=!1})}}class V5{apply(i,{styleAttributeService:s}){i.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(i,{styleAttributeService:s})}),i.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{i.layerModelNeedUpdate||i.inited&&this.updateStyleAttribute(i,{styleAttributeService:s})})}updateStyleAttribute(i,{styleAttributeService:s}){const f=s.getLayerStyleAttributes()||[],p=s.getLayerStyleAttribute("filter");if(p&&p.needRegenerateVertices){i.layerModelNeedUpdate=!0,f.forEach(y=>y.needRegenerateVertices=!1);return}f.filter(y=>y.needRegenerateVertices).forEach(y=>{s.updateAttributeByFeatureRange(y.name,i.getEncodedData(),y.featureRange.startIndex,y.featureRange.endIndex,i),y.needRegenerateVertices=!1})}initStyleAttribute(i,{styleAttributeService:s}){(s.getLayerStyleAttributes()||[]).filter(p=>p.needRegenerateVertices).forEach(p=>{s.updateAttributeByFeatureRange(p.name,i.getEncodedData(),p.featureRange.startIndex,p.featureRange.endIndex),p.needRegenerateVertices=!1})}}function G5(){return[new Ax,new s3,new P5,new Ex,new R5,new I5,new V5,new W5,new i3,new H5,new L5,new j5,new U5,new Lp]}const Kv={[ks.additive]:{enable:!0,func:{srcRGB:dt.ONE,dstRGB:dt.ONE,srcAlpha:1,dstAlpha:1}},[ks.none]:{enable:!1},[ks.normal]:{enable:!0,func:{srcRGB:dt.SRC_ALPHA,dstRGB:dt.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[ks.subtractive]:{enable:!0,func:{srcRGB:dt.ONE,dstRGB:dt.ONE,srcAlpha:dt.ZERO,dstAlpha:dt.ONE_MINUS_SRC_COLOR},equation:{rgb:dt.FUNC_SUBTRACT,alpha:dt.FUNC_SUBTRACT}},[ks.max]:{enable:!0,func:{srcRGB:dt.ONE,dstRGB:dt.ONE},equation:{rgb:dt.MAX_EXT}},[ks.min]:{enable:!0,func:{srcRGB:dt.ONE,dstRGB:dt.ONE},equation:{rgb:dt.MIN_EXT}}};class $5{constructor(i){(0,ot.Z)(this,"layer",void 0),this.layer=i}pickRender(i){const f=this.layer.getContainer().layerService,p=this.layer;if(p.tileLayer)return p.tileLayer.pickRender(i);p.hooks.beforePickingEncode.call(),f.renderTileLayerMask(p),p.renderModels({ispick:!0}),p.hooks.afterPickingEncode.call()}pick(i,s){var f=this;return(0,ln.Z)(function*(){const y=f.layer.getContainer().pickingService;return i.type==="RasterLayer"?f.pickRasterLayer(i,s):(f.pickRender(s),y.pickFromPickingFBO(i,s))})()}pickRasterLayer(i,s,f){const p=this.layer.getContainer(),y=p.pickingService,x=p.mapService,O=this.layer.getSource().extent,A=iE(s.lngLat,O),I={x:s.x,y:s.y,type:s.type,lngLat:s.lngLat,target:s,rasterValue:null},B=f||i;if(A){const j=this.readRasterValue(i,O,x,s.x,s.y);return I.rasterValue=j,y.triggerHoverOnLayer(B,I),!0}else return I.type=s.type==="mousemove"?"mouseout":"un"+s.type,y.triggerHoverOnLayer(B,(0,on.Z)((0,on.Z)({},I),{},{type:"unpick"})),y.triggerHoverOnLayer(B,I),!1}readRasterValue(i,s,f,p,y){const x=i.getSource().data.dataArray[0],[O=0,A=0,I=10,B=-10]=s,j=f.lngLatToContainer([O,A]),V=f.lngLatToContainer([I,B]),mt=V.x-j.x,Bt=j.y-V.y,Kt=[(p-j.x)/mt,(y-V.y)/Bt],ue=x.width||1,Le=x.height||1,ke=Math.floor(Kt[0]*ue),He=Math.floor(Kt[1]*Le),Ye=Math.max(0,He-1)*ue+ke;return x.data[Ye]}selectFeature(i){const s=this.layer,[f,p,y]=i;s.hooks.beforeSelect.call([f,p,y])}highlightPickedFeature(i){const[s,f,p]=i;this.layer.hooks.beforeHighlight.call([s,f,p])}getFeatureById(i){return this.layer.getSource().getFeatureById(i)}}class Y5{constructor(i){(0,ot.Z)(this,"layer",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"colorTexture",void 0),(0,ot.Z)(this,"key",void 0),this.layer=i;const s=this.layer.getContainer();this.rendererService=s.rendererService}getColorTexture(i,s){const f=this.getTextureKey(i,s);return this.key===f?this.colorTexture:(this.createColorTexture(i,s),this.key=f,this.colorTexture)}createColorTexture(i,s){const{createTexture2D:f}=this.rendererService,p=this.getColorRampBar(i,s),y=f({data:new Uint8Array(p.data),width:p.width,height:p.height,flipY:!1,unorm:!0});return this.colorTexture=y,y}setColorTexture(i,s,f){this.key=this.getTextureKey(s,f),this.colorTexture=i}destroy(){var i;(i=this.colorTexture)===null||i===void 0||i.destroy()}getColorRampBar(i,s){switch(i.type){case"cat":return UO(i);case"quantize":return ZO(i);case"custom":return m7(i,s);case"linear":return f1(i,s);default:return zO(i)}}getTextureKey(i,s){var f;return`${i.colors.join("_")}_${i==null||(f=i.positions)===null||f===void 0?void 0:f.join("_")}_${i.type}_${s==null?void 0:s.join("_")}`}}const X5=["passes"],q5=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:Qv,isFunction:c3,isNumber:Ip,isObject:no,isPlainObject:l3,isUndefined:K5}=hi;let u3=0;class au extends No.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var i;return(i=this.container)===null||i===void 0?void 0:i.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(i={}){super(),(0,ot.Z)(this,"id",`${u3++}`),(0,ot.Z)(this,"name",`${u3}`),(0,ot.Z)(this,"parent",void 0),(0,ot.Z)(this,"coordCenter",void 0),(0,ot.Z)(this,"type",void 0),(0,ot.Z)(this,"visible",!0),(0,ot.Z)(this,"zIndex",0),(0,ot.Z)(this,"minZoom",void 0),(0,ot.Z)(this,"maxZoom",void 0),(0,ot.Z)(this,"inited",!1),(0,ot.Z)(this,"layerModelNeedUpdate",!1),(0,ot.Z)(this,"pickedFeatureID",null),(0,ot.Z)(this,"selectedFeatureID",null),(0,ot.Z)(this,"styleNeedUpdate",!1),(0,ot.Z)(this,"rendering",void 0),(0,ot.Z)(this,"forceRender",!1),(0,ot.Z)(this,"clusterZoom",0),(0,ot.Z)(this,"layerType",void 0),(0,ot.Z)(this,"triangulation",void 0),(0,ot.Z)(this,"layerPickService",void 0),(0,ot.Z)(this,"textureService",void 0),(0,ot.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,ot.Z)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,ot.Z)(this,"hooks",{init:new cb,afterInit:new Ch,beforeRender:new Ch,beforeRenderData:new $g,afterRender:new pa,beforePickingEncode:new pa,afterPickingEncode:new pa,beforeHighlight:new pa(["pickedColor"]),afterHighlight:new pa,beforeSelect:new pa(["pickedColor"]),afterSelect:new pa,beforeDestroy:new pa,afterDestroy:new pa}),(0,ot.Z)(this,"models",[]),(0,ot.Z)(this,"multiPassRenderer",void 0),(0,ot.Z)(this,"plugins",void 0),(0,ot.Z)(this,"startInit",!1),(0,ot.Z)(this,"sourceOption",void 0),(0,ot.Z)(this,"layerModel",void 0),(0,ot.Z)(this,"shapeOption",void 0),(0,ot.Z)(this,"tileLayer",void 0),(0,ot.Z)(this,"layerChildren",[]),(0,ot.Z)(this,"masks",[]),(0,ot.Z)(this,"configService",Eb),(0,ot.Z)(this,"styleAttributeService",void 0),(0,ot.Z)(this,"layerSource",void 0),(0,ot.Z)(this,"postProcessingPassFactory",void 0),(0,ot.Z)(this,"animateOptions",{enable:!1}),(0,ot.Z)(this,"relativeOrigin",[0,0]),(0,ot.Z)(this,"originalExtent",[0,0,0,0]),(0,ot.Z)(this,"absoluteDataArray",[]),(0,ot.Z)(this,"container",void 0),(0,ot.Z)(this,"encodedData",void 0),(0,ot.Z)(this,"currentPickId",null),(0,ot.Z)(this,"rawConfig",void 0),(0,ot.Z)(this,"needUpdateConfig",void 0),(0,ot.Z)(this,"encodeStyleAttribute",{}),(0,ot.Z)(this,"enableShaderEncodeStyles",[]),(0,ot.Z)(this,"enableDataEncodeStyles",[]),(0,ot.Z)(this,"pendingStyleAttributes",[]),(0,ot.Z)(this,"scaleOptions",{}),(0,ot.Z)(this,"animateStartTime",void 0),(0,ot.Z)(this,"animateStatus",!1),(0,ot.Z)(this,"isDestroyed",!1),(0,ot.Z)(this,"uniformBuffers",[]),(0,ot.Z)(this,"encodeDataLength",0),(0,ot.Z)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0,this.processRelativeCoordinates();const s=this.getLayerConfig();s&&s.autoFit&&this.fitBounds(s.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=i.name||this.id,this.zIndex=i.zIndex||0,this.rawConfig=i,this.masks=i.maskLayers||[]}addMask(i){this.masks.push(i),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(i){const s=this.masks.indexOf(i);s>-1&&this.masks.splice(s,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(i){this.masks.push(i)}removeMaskLayer(i){const s=this.masks.indexOf(i);s>-1&&this.masks.splice(s,1),i.destroy()}getAttribute(i){return this.styleAttributeService.getLayerStyleAttribute(i)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(i){if(Object.keys(i).map(s=>{s in this.rawConfig&&(this.rawConfig[s]=i[s])}),!this.startInit)this.needUpdateConfig=(0,on.Z)((0,on.Z)({},this.needUpdateConfig),i);else{const s=this.container.id;this.configService.setLayerConfig(s,this.id,(0,on.Z)((0,on.Z)((0,on.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}setContainer(i){this.container=i}getContainer(){return this.container}addPlugin(i){return this.plugins.push(i),this}init(){var i=this;return(0,ln.Z)(function*(){const s=i.container.id;i.startInit=!0,i.configService.setLayerConfig(s,i.id,i.rawConfig),i.layerType=i.rawConfig.layerType;const{enableMultiPassRenderer:f,passes:p}=i.getLayerConfig();f&&p!==null&&p!==void 0&&p.length&&p.length>0&&i.mapService.on("mapAfterFrameChange",()=>{i.renderLayers()}),i.postProcessingPassFactory=i.container.postProcessingPassFactory,i.styleAttributeService=i.container.styleAttributeService,f&&(i.multiPassRenderer=i.container.multiPassRenderer,i.multiPassRenderer.setLayer(i)),i.pendingStyleAttributes.forEach(({attributeName:y,attributeField:x,attributeValues:O,updateOptions:A})=>{i.styleAttributeService.updateStyleAttribute(y,{scale:(0,on.Z)({field:x},i.splitValuesAndCallbackInAttribute(O,x?void 0:i.getLayerConfig()[y]))},A)}),i.pendingStyleAttributes=[],i.plugins=G5();for(const y of i.plugins)y.apply(i,i.container);i.layerPickService=new $5(i),i.textureService=new Y5(i),i.log($i.LayerInitStart),yield i.hooks.init.promise(),i.log($i.LayerInitEnd),i.inited=!0,i.emit("inited",{target:i,type:"inited"}),i.emit("add",{target:i,type:"add"}),i.hooks.afterInit.call()})()}log(i,s="init"){var f;if(this.tileLayer||this.isTileLayer)return;const p=`${this.id}.${s}.${i}`,y={id:this.id,type:this.type};(f=this.debugService)===null||f===void 0||f.log(p,y)}updateModelData(i){i.attributes&&i.elements?this.models.map(s=>{s.updateAttributesAndElements(i.attributes,i.elements)}):console.warn("data error")}setLayerPickService(i){this.layerPickService=i}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:i}=this.getLayerConfig();i!=null&&i.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(i,s,f){return this.updateStyleAttribute("color",i,s,f),this}texture(i,s,f){return this.updateStyleAttribute("texture",i,s,f),this}rotate(i,s,f){return this.updateStyleAttribute("rotate",i,s,f),this}size(i,s,f){return this.updateStyleAttribute("size",i,s,f),this}filter(i,s,f){const p=this.updateStyleAttribute("filter",i,s,f);return this.dataState.dataSourceNeedUpdate=p&&this.inited,this}shape(i,s,f){this.shapeOption={field:i,values:s};const p=this.updateStyleAttribute("shape",i,s,f);return this.dataState.dataSourceNeedUpdate=p&&this.inited,this}label(i,s,f){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:s,updateOptions:f}),this}animate(i){let s={};return no(i)?(s.enable=!0,s=(0,on.Z)((0,on.Z)({},s),i)):s.enable=i,this.updateLayerConfig({animateOption:s}),this}source(i,s){return(i==null?void 0:i.type)==="source"?(this.setSource(i),this):(this.sourceOption={data:i,options:s},this.clusterZoom=0,this)}setData(i,s){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(i,s)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(i,s)}),this}dataUpdatelog(){this.log($i.SourceInitStart,oo.UPDATE),this.layerSource.once("update",()=>{this.log($i.SourceInitEnd,oo.UPDATE)})}style(i){const{passes:s}=i,f=(0,jo.Z)(i,X5);s&&r3(s).forEach(y=>{const x=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(y[0]);x&&x.updateOptions(y[1])}),f.borderColor&&(f.stroke=f.borderColor),f.borderWidth&&(f.strokeWidth=f.borderWidth);const p=f;return Object.keys(f).forEach(y=>{const x=f[y];Array.isArray(x)&&x.length===2&&!Ip(x[0])&&!Ip(x[1])&&(p[y]={field:x[0],value:x[1]})}),this.encodeStyle(p),this.updateLayerConfig(p),this}encodeStyle(i){Object.keys(i).forEach(s=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(s)&&l3(i[s])&&(i[s].field||i[s].value)&&!Qv(this.encodeStyleAttribute[s],i[s])?(this.encodeStyleAttribute[s]=i[s],this.updateStyleAttribute(s,i[s].field,i[s].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[s]&&(delete this.encodeStyleAttribute[s],this.dataState.dataSourceNeedUpdate=!0)})}scale(i,s){const f=(0,on.Z)({},this.scaleOptions);if(no(i)?this.scaleOptions=(0,on.Z)((0,on.Z)({},this.scaleOptions),i):this.scaleOptions[i]=s,this.styleAttributeService&&!Qv(f,this.scaleOptions)){const p=no(i)?i:{[i]:s};this.styleAttributeService.updateScaleAttribute(p)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(i={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(i),this))}renderMultiPass(){var i=this;return(0,ln.Z)(function*(){i.encodeDataLength<=0&&!i.forceRender||(i.multiPassRenderer&&i.multiPassRenderer.getRenderFlag()?yield i.multiPassRenderer.render():i.renderModels())})()}active(i){const s={};return s.enableHighlight=no(i)?!0:i,no(i)?(s.enableHighlight=!0,i.color&&(s.highlightColor=i.color),i.mix&&(s.activeMix=i.mix)):s.enableHighlight=!!i,this.updateLayerConfig(s),this}setActive(i,s){if(no(i)){const{x:f=0,y:p=0}=i;this.updateLayerConfig({highlightColor:no(s)?s.color:this.getLayerConfig().highlightColor,activeMix:no(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:f,y:p})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:no(s)?s.color:this.getLayerConfig().highlightColor,activeMix:no(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(ul(i)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(i){const s={};return s.enableSelect=no(i)?!0:i,no(i)?(s.enableSelect=!0,i.color&&(s.selectColor=i.color),i.mix&&(s.selectMix=i.mix)):s.enableSelect=!!i,this.updateLayerConfig(s),this}setSelect(i,s){if(no(i)){const{x:f=0,y:p=0}=i;this.updateLayerConfig({selectColor:no(s)?s.color:this.getLayerConfig().selectColor,selectMix:no(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:f,y:p})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:no(s)?s.color:this.getLayerConfig().selectColor,selectMix:no(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(ul(i)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(i){return this.updateLayerConfig({blend:i}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(i){this.currentPickId=i}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(i){this.selectedFeatureID=i}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const i=this.mapService.getZoom(),{visible:s,minZoom:f=-1/0,maxZoom:p=1/0}=this.getLayerConfig();return!!s&&i>=f&&i<p}setMultiPass(i,s){if(this.updateLayerConfig({enableMultiPassRenderer:i}),s&&this.updateLayerConfig({passes:s}),i){const{passes:f=[]}=this.getLayerConfig();this.multiPassRenderer=qv(this,f,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:p,height:y}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(p,y)}return this}setMinZoom(i){return this.updateLayerConfig({minZoom:i}),this}getMinZoom(){const{minZoom:i}=this.getLayerConfig();return i}getMaxZoom(){const{maxZoom:i}=this.getLayerConfig();return i}get(i){return this.getLayerConfig()[i]}setMaxZoom(i){return this.updateLayerConfig({maxZoom:i}),this}setAutoFit(i){return this.updateLayerConfig({autoFit:i}),this}fitBounds(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const f=this.getSource().extent;return f.some(y=>Math.abs(y)===1/0)?this:(this.mapService.fitBounds([[f[0],f[1]],[f[2],f[3]]],i),this)}destroy(i=!0){var s,f,p,y,x;if(this.isDestroyed)return;(s=this.layerModel)===null||s===void 0||s.uniformBuffers.forEach(A=>{A.destroy()}),this.layerChildren.map(A=>A.destroy(!1)),this.layerChildren=[];const{maskfence:O}=this.getLayerConfig();O&&(this.masks.map(A=>A.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(f=this.multiPassRenderer)===null||f===void 0||f.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(p=this.layerModel)===null||p===void 0||p.clearModels(i),(y=this.tileLayer)===null||y===void 0||y.destroy(),this.models=[],(x=this.debugService)===null||x===void 0||x.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var i;this.models.forEach(s=>s.destroy()),(i=this.layerModel)===null||i===void 0||i.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(i=>i.needRescale||i.needRemapping||i.needRegenerateVertices).length}setSource(i){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:s})=>{if(this.coordCenter===void 0){const f=this.layerSource.center;this.coordCenter=f}if(s==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}s==="inited"&&this.processRelativeCoordinates()})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(i){this.encodedData=i,this.encodeDataLength=i.length}getEncodedData(){return this.encodedData}getScale(i){return this.styleAttributeService.getLayerAttributeScale(i)}getLegend(i){var s,f,p;const y=this.styleAttributeService.getLayerStyleAttribute(i);return{type:(f=((y==null||(s=y.scale)===null||s===void 0?void 0:s.scalers)||[])[0])===null||f===void 0||(f=f.option)===null||f===void 0?void 0:f.type,field:y==null||(p=y.scale)===null||p===void 0?void 0:p.field,items:this.getLegendItems(i)}}getLegendItems(i){const s=this.styleAttributeService.getLayerAttributeScale(i);return s?s.invertExtent?s.range().map(p=>({value:s.invertExtent(p),[i]:p})):s.ticks?s.ticks().map(p=>({value:p,[i]:s(p)})):s!=null&&s.domain?s.domain().filter(p=>!K5(p)).map(p=>({value:p,[i]:s(p)})):[]:[]}pick({x:i,y:s}){this.interactionService.triggerHover({x:i,y:s})}boxSelect(i,s){this.pickingService.boxPickLayer(this,i,s)}buildLayerModel(i){var s=this;return(0,ln.Z)(function*(){const{moduleName:f,vertexShader:p,fragmentShader:y,defines:x,inject:O,triangulation:A,styleOption:I,pickingEnabled:B=!0}=i,j=(0,jo.Z)(i,q5);s.shaderModuleService.registerModule(f,{vs:p,fs:y,defines:x,inject:O});const{vs:V,fs:mt,uniforms:Bt}=s.shaderModuleService.getModule(f),{createModel:Kt}=s.rendererService;return new Promise(ue=>{const{attributes:Le,elements:ke,count:He}=s.styleAttributeService.createAttributesAndIndices(s.encodedData,A,I,s),Ye=[...s.layerModel.uniformBuffers,...s.rendererService.uniformBuffers];B&&Ye.push(s.getPickingUniformBuffer());const rn=(0,on.Z)({attributes:Le,uniforms:Bt,fs:mt,vs:V,elements:ke,blend:Kv[ks.normal],uniformBuffers:Ye,textures:s.layerModel.textures},j);He&&(rn.count=He);const bn=Kt(rn);ue(bn)})})()}createAttributes(i){const{triangulation:s}=i,{attributes:f}=this.styleAttributeService.createAttributes(this.encodedData,s);return f}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(i){const{enableHighlight:s=!0,enableSelect:f=!0}=this.getLayerConfig();let p=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&f&&(p=!0),i==="mousemove"&&(s||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(p=!0),this.isVisible()&&p}buildModels(){return(0,ln.Z)(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var i=this;return(0,ln.Z)(function*(){yield i.buildModels()})()}renderMulPass(i){return(0,ln.Z)(function*(){yield i.render()})()}renderModels(i={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(s=>{s.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(i),textures:this.layerModel.textures},(i==null?void 0:i.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(i,s,f,p){const y=this.configService.getAttributeConfig(this.id)||{};return Qv(y[i],{field:s,values:f})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(i)!==-1&&this.configService.setAttributeConfig(this.id,{[i]:{field:s,values:f}}),this.startInit?this.styleAttributeService.updateStyleAttribute(i,{scale:(0,on.Z)({field:s},this.splitValuesAndCallbackInAttribute(f,this.getLayerConfig()[s]))},p):this.pendingStyleAttributes.push({attributeName:i,attributeField:s,attributeValues:f,updateOptions:p}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(i){console.warn("empty fn")}processData(i){return i}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}processRelativeCoordinates(){if(!this.getLayerConfig().enableRelativeCoordinates||!this.layerSource||!this.layerSource.data)return;this.absoluteDataArray=[...this.layerSource.data.dataArray];const f=sv(this.layerSource.data.dataArray,{enableRelativeCoordinates:!0});this.layerSource.data.dataArray=f.dataArray,this.relativeOrigin=f.relativeOrigin,this.originalExtent=f.originalExtent}getAbsoluteData(){return this.absoluteDataArray}getRelativeOrigin(){return this.relativeOrigin}getOriginalExtent(){return this.originalExtent}initLayerModels(){var i=this;return(0,ln.Z)(function*(){i.models.forEach(f=>f.destroy()),i.models=[],i.uniformBuffers.forEach(f=>{f.destroy()}),i.uniformBuffers=[];const s=i.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});i.uniformBuffers.push(s),i.models=yield i.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(i){return{values:c3(i)?void 0:i,callback:c3(i)?i:void 0}}}function Q5(a,i){return{enable:a,mask:255,func:{cmp:dt.EQUAL,ref:i?1:0,mask:1}}}function f3(a){return a.maskOperation===Tl.OR?{enable:!0,mask:255,func:{cmp:dt.ALWAYS,ref:1,mask:255},opFront:{fail:dt.KEEP,zfail:dt.REPLACE,zpass:dt.REPLACE}}:{enable:!0,mask:255,func:{cmp:a.stencilType===Oc.SINGLE||a.stencilIndex===0?dt.ALWAYS:dt.LESS,ref:a.stencilType===Oc.SINGLE?1:a.stencilIndex===0?2:1,mask:255},opFront:{fail:dt.KEEP,zfail:dt.REPLACE,zpass:dt.REPLACE}}}const h3={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Zf={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var J5=L(9187),Qc=L.n(J5);function p3(a){return Math.max(Math.ceil(a/4)*4,4)}function g3(a,i,s,f=!0){const p=s===3;if(f){a=a.slice();const x=[];for(let O=0;O<a.length;O+=s){x[0]=a[O],x[1]=a[O+1],p&&(x[2]=a[O+2]);const A=kd(x,!0,{enable:!1,decimal:1});a[O]=A[0],a[O+1]=A[1],p&&(a[O+2]=A[2])}}return Qc()(a,i,s)}const v3="ATTRIBUTE_LOCATION_";class si{get attributeLocation(){return(0,on.Z)({},Xs)}constructor(i){(0,ot.Z)(this,"triangulation",void 0),(0,ot.Z)(this,"uniformBuffers",[]),(0,ot.Z)(this,"textures",[]),(0,ot.Z)(this,"createTexture2D",void 0),(0,ot.Z)(this,"preStyleAttribute",{}),(0,ot.Z)(this,"encodeStyleAttribute",{}),(0,ot.Z)(this,"layer",void 0),(0,ot.Z)(this,"dataTexture",void 0),(0,ot.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,ot.Z)(this,"dataTextureTest",void 0),(0,ot.Z)(this,"configService",void 0),(0,ot.Z)(this,"shaderModuleService",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"iconService",void 0),(0,ot.Z)(this,"fontService",void 0),(0,ot.Z)(this,"styleAttributeService",void 0),(0,ot.Z)(this,"mapService",void 0),(0,ot.Z)(this,"cameraService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"pickingService",void 0),(0,ot.Z)(this,"attributeUnifoms",void 0),(0,ot.Z)(this,"commonUnifoms",void 0),this.layer=i,this.configService=i.getContainer().globalConfigService,this.rendererService=i.getContainer().rendererService,this.pickingService=i.getContainer().pickingService,this.shaderModuleService=i.getContainer().shaderModuleService,this.styleAttributeService=i.getContainer().styleAttributeService,this.mapService=i.getContainer().mapService,this.iconService=i.getContainer().iconService,this.fontService=i.getContainer().fontService,this.cameraService=i.getContainer().cameraService,this.layerService=i.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:s}=this.rendererService;this.createTexture2D=s}getBlend(){const{blend:i="normal"}=this.layer.getLayerConfig();return Kv[ks[i]]}getStencil(i){const{mask:s=!1,maskInside:f=!0,enableMask:p,maskOperation:y=Tl.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return f3({isStencil:!0,stencilType:Oc.SINGLE});if(i.isStencil)return f3((0,on.Z)((0,on.Z)({},i),{},{maskOperation:y}));const x=s||p&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return Q5(x,f)}getDefaultStyle(){return{}}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const f=(0,on.Z)((0,on.Z)({},s.uniformsOption),i.uniformsOption);return Object.keys(f).forEach(p=>{typeof f[p]=="boolean"&&(f[p]=f[p]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(f.u_texture=this.textures[0]),f}getAnimateUniforms(){return{}}needUpdate(){return(0,ln.Z)(function*(){return!1})()}buildModels(){return(0,ln.Z)(function*(){throw new Error("Method not implemented.")})()}initModels(){return(0,ln.Z)(function*(){throw new Error("Method not implemented.")})()}clearModels(i=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(i){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(i){return[i.enable?0:1,i.duration||4,i.interval||.2,i.trailLength||.1]}startModelAnimate(){const{animateOption:i}=this.layer.getLayerConfig();i.enable&&this.layer.setAnimateStartTime()}getInject(){return tC(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const i=Object.keys(this.attributeLocation).reduce((s,f)=>{const p=v3+f;return s[p]=this.attributeLocation[f],s},{});return(0,on.Z)({},i)}getStyleAttribute(){const i={};return this.layer.enableShaderEncodeStyles.forEach(s=>{if(!this.layer.encodeStyleAttribute[s]){const f=this.layer.getLayerConfig()[s];let p=typeof f=="undefined"?h3[s]:f;s==="stroke"&&(p=Gr(p)),i["u_"+s]=p}}),i}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(i=>{const s=z5(i);s&&this.styleAttributeService.registerStyleAttribute(s)})}registerPosition64LowAttribute(i=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:Nn.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:dt.FLOAT},size:2,update:(s,f,p)=>i?[ki(p[0]),ki(p[1])]:[0,0]}})}updateEncodeAttribute(i,s){this.encodeStyleAttribute[i]=s}initUniformsBuffer(){const i=this.getUniformsBufferInfo(this.getStyleAttribute()),s=this.getCommonUniformsInfo();i.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(p3(i.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),s.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(p3(s.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(i){let s=0;const f=[];return Object.values(i).forEach(p=>{Array.isArray(p)?(f.push(...p),s+=p.length):typeof p=="number"?(f.push(p),s+=1):typeof p=="boolean"&&(f.push(Number(p)),s+=1)}),{uniformsOption:i,uniformsLength:s,uniformsArray:f}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var i,s;const{uniformsArray:f}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:p}=this.getCommonUniformsInfo();(i=this.attributeUnifoms)===null||i===void 0||i.subData({offset:0,data:new Uint8Array(new Float32Array(f).buffer)}),(s=this.commonUnifoms)===null||s===void 0||s.subData({offset:0,data:new Uint8Array(new Float32Array(p).buffer)})}}function tC(a,i){const s=[];let f="";a.forEach(x=>{const O=x.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),A=v3+O;i[x]?f+=`#define USE_ATTRIBUTE_${O} 0.0 
`:s.push(`  ${Zf[x]} u_${x};`),f+=`
#ifdef USE_ATTRIBUTE_${O}
layout(location = ${A}) in ${Zf[x]} a_${x.charAt(0).toUpperCase()+x.slice(1)};
#endif 
`});const p=s.length?`
layout(std140) uniform AttributeUniforms {
  ${s.join(`
`)}
};
`:"";f+=p;let y="";return a.forEach(x=>{const O=x.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();y+=`
  #ifdef USE_ATTRIBUTE_${O}
    ${Zf[x]} ${x} = a_${x.charAt(0).toUpperCase()+x.slice(1)};
  #else
    ${Zf[x]} ${x} = u_${x};
  #endif
  `}),{"vs:#decl":f,"fs:#decl":p,"vs:#main-start":y}}const m3=100,VI=36,Jc=40;function y3(a){return a/180*Math.acos(-1)}function Jv(a){const i=y3(a[0])+Math.PI/2,s=y3(a[1]),f=m3+Math.random()*.4,p=f*Math.cos(s)*Math.cos(i),y=f*Math.cos(s)*Math.sin(i),x=f*Math.sin(s);return[y,x,p]}function GI(a,i){const s=mat4.create(),f=mat4.create(),p=vec3.fromValues(0,1,0),y=vec3.fromValues(0,0,0);i=i||{},a=typeof a!="undefined"?a:1;const O=2+(typeof i.segments!="undefined"?i.segments:32),A=2*O,I=[],B=[],j=[],V=[],mt=[],Bt=[];for(let Kt=0;Kt<=O;Kt++){const ue=Kt/O,Le=ue*Math.PI;for(let ke=0;ke<=A;ke++){const He=ke/A,Ye=He*Math.PI*2;mat4.identity(f),mat4.rotateZ(f,f,-Le),mat4.identity(s),mat4.rotateY(s,s,Ye),vec3.transformMat4(y,p,f),vec3.transformMat4(y,y,s),vec3.scale(y,y,-a),j.push(y.slice()),V.push(...y.slice()),vec3.normalize(y,y),mt.push(...y.slice()),Bt.push([He,1-ue]),V.push(He,1-ue)}if(Kt>0){const ke=j.length;let He=ke-2*(A+1);for(;He+A+2<ke;He++)I.push([He,He+1,He+A+1]),B.push(He,He+1,He+A+1),I.push([He+A+1,He+1,He+A+2]),B.push(He+A+1,He+1,He+A+2)}}return{cells:I,positions:j,uvs:Bt,positionsArr:V,indicesArr:B,normalArr:mt}}var dr=L(31437);const tm=dr.Ue(),$I=dr.Ue(),aa=dr.Ue(),Hf=dr.Ue(),Rp=dr.Ue();function kp(a,i,s,f,p){dr.IH(a,s,f),dr.Fv(a,a),i=dr.al(-a[1],a[0]);const y=dr.al(-s[1],s[0]);return[p/dr.AK(i,y),i]}function Wf(a,i){return dr.t8(a,-i[1],i[0])}function Dp(a,i,s){return dr.lu(a,i,s),dr.Fv(a,a),a}function _3(a,i){return a[0]===i[0]&&a[1]===i[1]}function YI(a){const i=new Map;for(let s=0;s<a.length;s++){const f=a[0].toString()+"-"+a[1].toString();i.get(f)?(a.splice(s,1),s++):i.set(f,f)}return a}class eC{constructor(i={}){(0,ot.Z)(this,"complex",void 0),(0,ot.Z)(this,"join",void 0),(0,ot.Z)(this,"cap",void 0),(0,ot.Z)(this,"miterLimit",void 0),(0,ot.Z)(this,"thickness",void 0),(0,ot.Z)(this,"normal",void 0),(0,ot.Z)(this,"lastFlip",-1),(0,ot.Z)(this,"miter",dr.al(0,0)),(0,ot.Z)(this,"started",!1),(0,ot.Z)(this,"dash",!1),(0,ot.Z)(this,"totalDistance",0),(0,ot.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(i){const s=this.complex;if(i.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const f=i.length;let p=s.startIndex;for(let y=1;y<f;y++){const x=i[y-1],O=i[y],A=y<i.length-1?i[y+1]:null,I=this.simpleSegment(s,p,x,O,A);p+=I}if(this.dash)for(let y=0;y<s.positions.length/6;y++)s.positions[y*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}extrude(i){const s=this.complex;if(i.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const f=i.length;let p=s.startIndex;for(let y=1;y<f;y++){const x=i[y-1],O=i[y],A=y<i.length-1?i[y+1]:null,I=this.segment(s,p,x,O,A);p+=I}if(this.dash)for(let y=0;y<s.positions.length/6;y++)s.positions[y*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}simpleSegment(i,s,f,p,y){let x=0;const O=i.indices,A=i.positions,I=i.normals,B=wo([p[0],p[1]]),j=wo([f[0],f[1]]);Dp(aa,B,j);let V=0;if(this.dash&&(V=this.lineSegmentDistance(B,j),this.totalDistance+=V),this.normal||(this.normal=dr.Ue(),Wf(this.normal,aa)),this.started||(this.started=!0,this.extrusions(A,I,f,this.normal,this.thickness,this.totalDistance-V)),O.push(s+0,s+1,s+2),!y)Wf(this.normal,aa),this.extrusions(A,I,p,this.normal,this.thickness,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),x+=2;else{const mt=wo([y[0],y[1]]);_3(B,mt)&&dr.IH(mt,B,dr.Fv(mt,dr.$X(mt,B,j))),Dp(Hf,mt,B);const[Bt,Kt]=kp(Rp,dr.Ue(),aa,Hf,this.thickness);let ue=dr.AK(Rp,this.normal)<0?-1:1;this.extrusions(A,I,p,Kt,Bt,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),ue=-1,dr.JG(this.normal,Kt),x+=2,this.lastFlip=ue}return x}segment(i,s,f,p,y){let x=0;const O=i.indices,A=i.positions,I=i.normals,B=this.cap==="square",j=this.join==="bevel",V=wo([p[0],p[1]]),mt=wo([f[0],f[1]]);Dp(aa,V,mt);let Bt=0;if(this.dash&&(Bt=this.lineSegmentDistance(V,mt),this.totalDistance+=Bt),this.normal||(this.normal=dr.Ue(),Wf(this.normal,aa)),!this.started)if(this.started=!0,B){const Kt=dr.Ue(),ue=dr.Ue();dr.IH(Kt,this.normal,aa),dr.IH(ue,this.normal,aa),I.push(ue[0],ue[1],0),I.push(Kt[0],Kt[1],0),A.push(f[0],f[1],f[2]|0,this.totalDistance-Bt,-this.thickness,f[2]|0),this.complex.indexes.push(this.currentIndex),A.push(f[0],f[1],f[2]|0,this.totalDistance-Bt,this.thickness,f[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,I,f,this.normal,this.thickness,this.totalDistance-Bt);if(O.push(s+0,s+1,s+2),y){const Kt=wo([y[0],y[1]]);_3(V,Kt)&&dr.IH(Kt,V,dr.Fv(Kt,dr.$X(Kt,V,mt))),Dp(Hf,Kt,V);const[ue,Le]=kp(Rp,dr.Ue(),aa,Hf,this.thickness);let ke=dr.AK(Rp,this.normal)<0?-1:1,He=j;!He&&this.join==="miter"&&ue>this.miterLimit&&(He=!0),He?(I.push(this.normal[0],this.normal[1],0),I.push(Le[0],Le[1],0),A.push(p[0],p[1],p[2]|0,this.totalDistance,-this.thickness*ke,p[2]|0),this.complex.indexes.push(this.currentIndex),A.push(p[0],p[1],p[2]|0,this.totalDistance,this.thickness*ke,p[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push(...this.lastFlip!==-ke?[s,s+2,s+3]:[s+2,s+1,s+3]),O.push(s+2,s+3,s+4),Wf(tm,Hf),dr.JG(this.normal,tm),I.push(this.normal[0],this.normal[1],0),A.push(p[0],p[1],p[2]|0,this.totalDistance,-this.thickness*ke,p[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,x+=3):(this.extrusions(A,I,p,Le,ue,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),ke=-1,dr.JG(this.normal,Le),x+=2),this.lastFlip=ke}else{if(Wf(this.normal,aa),B){const Kt=dr.Ue(),ue=dr.Ue();dr.lu(ue,aa,this.normal),dr.IH(Kt,aa,this.normal),I.push(ue[0],ue[1],0),I.push(Kt[0],Kt[1],0),A.push(p[0],p[1],p[2]|0,this.totalDistance,this.thickness,p[2]|0),this.complex.indexes.push(this.currentIndex),A.push(p[0],p[1],p[2]|0,this.totalDistance,this.thickness,p[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,I,p,this.normal,this.thickness,this.totalDistance);O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),x+=2}return x}extrusions(i,s,f,p,y,x){s.push(p[0],p[1],0),s.push(p[0],p[1],0),i.push(f[0],f[1],f[2]|0,x,-y,f[2]|0),this.complex.indexes.push(this.currentIndex),i.push(f[0],f[1],f[2]|0,x,y,f[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(i,s){const f=s[0]-i[0],p=s[1]-i[1];return Math.sqrt(f*f+p*p)}}let su=function(a){return a.CYLINDER="cylinder",a.SQUARECOLUMN="squareColumn",a.TRIANGLECOLUMN="triangleColumn",a.HEXAGONCOLUMN="hexagonColumn",a.PENTAGONCOLUMN="pentagonColumn",a}({}),Vf=function(a){return a.CIRCLE="circle",a.SQUARE="square",a.TRIANGLE="triangle",a.HEXAGON="hexagon",a.PENTAGON="pentagon",a}({});function Gf(a,i=0){const s=Math.PI*2/a,f=[];for(let y=0;y<a;y++)f.push(s*y+i*Math.PI/12);return f.map(y=>{const x=Math.sin(y+Math.PI/4),O=Math.cos(y+Math.PI/4);return[x,O,0]})}function em(){return Gf(30)}function b3(){return Gf(4)}function x3(){return Gf(3)}function S3(){return Gf(6,1)}function w3(){return Gf(5)}const cu={[Vf.CIRCLE]:em,[Vf.HEXAGON]:S3,[Vf.TRIANGLE]:x3,[Vf.SQUARE]:b3,[Vf.PENTAGON]:w3,[su.CYLINDER]:em,[su.HEXAGONCOLUMN]:S3,[su.TRIANGLECOLUMN]:x3,[su.SQUARECOLUMN]:b3,[su.PENTAGONCOLUMN]:w3};var Tr=L(77160);function nm(a){const i=a[0][0],s=a[0][a[0].length-1];i[0]===s[0]&&i[1]===s[1]&&(a[0]=a[0].slice(0,a[0].length-1));const f=a[0].length,p=earcut.flatten(a),{vertices:y,dimensions:x}=p,O=[],A=[];for(let B=0;B<y.length/x;B++)x===2?O.push(y[B*2],y[B*2+1],1):O.push(y[B*3],y[B*3+1],1);const I=earcut(p.vertices,p.holes,p.dimensions);A.push(...I);for(let B=0;B<f;B++){const j=p.vertices.slice(B*x,(B+1)*x);let V=p.vertices.slice((B+1)*x,(B+2)*x);V.length===0&&(V=p.vertices.slice(0,x));const mt=O.length/3;O.push(j[0],j[1],1,V[0],V[1],1,j[0],j[1],0,V[0],V[1],0),A.push(...[0,2,1,2,3,1].map(Bt=>Bt+mt))}return{positions:O,index:A}}function nC(a){const i=earcut.flatten(a),s=earcut(i.vertices,i.holes,i.dimensions);return{positions:i.vertices,index:s}}function rm(a,i=!1){const s=a[0][0],f=a[0][a[0].length-1];s[0]===f[0]&&s[1]===f[1]&&(a[0]=a[0].slice(0,a[0].length-1));const p=a[0].length,y=Qc().flatten(a),{vertices:x,dimensions:O,holes:A}=y,I=[],B=[],j=[];for(let mt=0;mt<x.length/O;mt++)I.push(x[mt*O],x[mt*O+1],1,-1,-1),j.push(0,0,1);const V=g3(x,A,O,i);B.push(...V);for(let mt=0;mt<p;mt++){const Bt=y.vertices.slice(mt*O,(mt+1)*O);let Kt=y.vertices.slice((mt+1)*O,(mt+2)*O);Kt.length===0&&(Kt=y.vertices.slice(0,O));const ue=I.length/5;I.push(Bt[0],Bt[1],1,0,0,Kt[0],Kt[1],1,.1,0,Bt[0],Bt[1],0,0,.8,Kt[0],Kt[1],0,.1,.8);const Le=rC([Kt[0],Kt[1],1],[Bt[0],Bt[1],0],[Bt[0],Bt[1],1],i);j.push(...Le,...Le,...Le,...Le),B.push(...[1,2,0,3,2,1].map(ke=>ke+ue))}return{positions:I,index:B,normals:j}}function rC(a,i,s,f=!1){const p=Tr.Ue(),y=Tr.Ue(),x=Tr.Ue();f&&(a=kd(a),i=kd(i),s=kd(s));const O=Tr.al(...a),A=Tr.al(...i),I=Tr.al(...s);Tr.lu(p,I,A),Tr.lu(y,O,A),Tr.kC(x,p,y);const B=Tr.Ue();return Tr.Fv(B,x),B}const Np={};function tl(a){const i=yc(a.coordinates);return{vertices:[...i,...i,...i,...i],indices:[0,1,2,2,3,0],size:i.length}}function $f(a){const i=yc(a.coordinates),s=Jv(i);return{vertices:[...s,...s,...s,...s],indices:[0,1,2,2,3,0],size:s.length}}function O3(a){const{shape:i}=a,{positions:s,index:f,normals:p}=lC(i,!1);return{vertices:s,indices:f,normals:p,size:5}}function Ho(a){const i=yc(a.coordinates);return{vertices:[...i],indices:[0],size:i.length}}function im(a){const{coordinates:i}=a,s=new eC({dash:!0,join:"bevel"});let f=i;f[0]&&!Array.isArray(f[0][0])&&(f=[i]),f.forEach(y=>{s.extrude(y)});const p=s.complex;return{vertices:p.positions,indices:p.indices,normals:p.normals,indexes:p.indexes,size:6}}function iC(a){const i=a.coordinates.flat(),s=1,f=1;return{vertices:[1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i,1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i],normals:[-s,2*f,1,2*f,-f,1,f,-f,1,f,-f,1,-s,-f,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function oC(a){const{coordinates:i}=a,s=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:f,totalDistance:p}=A3(i);return f.map(y=>{s.push(y[0],y[1],y[2],y[3],0,p)}),{vertices:s,indices:[],normals:[],size:6,count:f.length}}function XI(a){const{coordinates:i}=a,s=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],size:4,count:0};const{results:f}=aC(i);return f.map(p=>{s.push(p[0],p[1],p[2],p[3])}),{vertices:s,indices:[],size:4,count:f.length}}function E3(a,i){const s=i[0]-a[0],f=i[1]-a[1];return Math.sqrt(s*s+f*f)}function lu(a,i){return a.length<3&&a.push(0),i!==void 0&&a.push(i),a}function A3(a){let i=a;Array.isArray(i)&&Array.isArray(i[0])&&Array.isArray(i[0][0])&&(i=a.flat());let s=0;if(i.length<2)return{results:i,totalDistance:0};{const f=[],p=lu(i[0],s);f.push(p);for(let x=1;x<i.length-1;x++){const O=E3(wo(i[x-1]),wo(i[x]));s+=O;const A=lu(i[x],s);f.push(A),f.push(A)}const y=E3(wo(i[i.length-2]),wo(i[i.length-1]));return s+=y,f.push(lu(i[i.length-1],s)),{results:f,totalDistance:s}}}function aC(a){if(a.length<2)return{results:a};{const i=[],s=lu(a[0]);i.push(s);for(let f=1;f<a.length-1;f++){const p=lu(a[f]);i.push(p),i.push(p)}return i.push(lu(a[a.length-1])),{results:i}}}function el(a){const{coordinates:i}=a,s=Qc().flatten(i),{vertices:f,dimensions:p,holes:y}=s;return{indices:g3(f,y,p),vertices:f,size:p}}function sC(a){const{indices:i,vertices:s,size:f}=el(a);return{indices:i,vertices:cC(s),size:f+4}}function cC(a){const i=[],{center:s,radius:f}=B1(a);for(let p=0;p<a.length;p+=2){const y=a[p],x=a[p+1];i.push(y,x,0,...s,f)}return i}function T3(a){const i=a.coordinates,{positions:s,index:f,normals:p}=rm(i,!0);return{vertices:s,indices:f,normals:p,size:5}}function qI(a){const{shape:i}=a,{positions:s,index:f}=Wa(i);return{vertices:s,indices:f,size:3}}function Fp(a){const i=a.coordinates;return{vertices:[...i[0],0,0,0,...i[1],0,1,0,...i[2],0,1,1,...i[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function om(a,i){const{segmentNumber:s=30}=i,f=a.coordinates,p=[],y=[];for(let x=0;x<s;x++)p.push(x,1,x,f[0][0],f[0][1],f[1][0],f[1][1],x,-1,x,f[0][0],f[0][1],f[1][0],f[1][1]),x!==s-1&&y.push(...[0,1,2,1,3,2].map(O=>x*2+O));return{vertices:p,indices:y,size:7}}function KI(a){const i=a.coordinates;i.length===2&&i.push(0);const s=nl(-1,1),f=nl(1,1),p=nl(-1,-1),y=nl(1,-1);return{vertices:[...i,...s,...i,...p,...i,...y,...i,...f],indices:[0,1,2,3,0,2],size:5}}function lC(a,i=!1){if(Np&&Np[a])return Np[a];const s=cu[a]?cu[a]():cu.cylinder(),f=rm([s],i);return Np[a]=f,f}function QI(a,i,s=3,f=!1){const p=new Float32Array(a.length/s*3);let y,x,O;const A=vec3.create(),I=vec3.create(),B=vec3.create();for(let j=0,V=i.length;j<V;j+=3){y=i[j+0]*3,x=i[j+1]*3,O=i[j+2]*3;let mt=[a[y],a[y+1]],Bt=[a[x],a[x+1]],Kt=[a[O],a[O+1]];f&&(mt=lngLatToMeters(mt),Bt=lngLatToMeters(Bt),Kt=lngLatToMeters(Kt));const[ue,Le]=mt,ke=vec3.fromValues(ue,Le,a[y+2]),[He,Ye]=Bt,rn=vec3.fromValues(He,Ye,a[x+2]),[bn,hn]=Kt,Cn=vec3.fromValues(bn,hn,a[O+2]);vec3.sub(A,Cn,rn),vec3.sub(I,ke,rn),vec3.cross(B,A,I),p[y]+=A[0],p[y+1]+=A[1],p[y+2]+=A[2],p[x]+=A[0],p[x+1]+=A[1],p[x+2]+=A[2],p[O]+=A[0],p[O+1]+=A[1],p[O+2]+=A[2]}return uC(p),p}function uC(a){for(let i=0,s=a.length;i<s;i+=3){const f=vec3.fromValues(a[i],a[i+1],a[i+2]),p=vec3.create();vec3.normalize(p,f),a.set(p,i)}}function JI(a){const i=a[0][0],s=a[0][a[0].length-1];return i[0]===s[0]&&i[1]===s[1]}function Wa(a){const i=["cylinder","triangleColumn","hexagonColumn","squareColumn"],s=geometryShape[a]?geometryShape[a]():geometryShape.circle();return i.indexOf(a)===-1?fillPolygon([s]):extrudePolygon([s])}function nl(a,i){const s=(a+1)/2,f=(i+1)/2;return[s,f]}function fC(){const a=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:i,indicesArr:s,normalArr:f}=a;return{vertices:i,indices:s,size:5,normals:f}}function bs(){const a=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:i,indicesArr:s,normalArr:f}=a;return{vertices:i,indices:s,size:5,normals:f}}const dC=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,uu=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,am={solid:0,dash:1};class hC extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.NEAREST,min:dt.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:p="solid",dashArray:y=[10,5],forward:x=!0,lineTexture:O=!1,iconStep:A=100,segmentNumber:I=30}=this.layer.getLayerConfig(),{animateOption:B}=this.layer.getLayerConfig();let j=y;p!=="dash"&&(j=[0,0]),j.length===2&&j.push(0,0);let V=0,mt=[0,0,0,0],Bt=[0,0,0,0];if(i&&s&&(mt=Gr(i),Bt=Gr(s),V=1),this.rendererService.getDirty()){var Kt;(Kt=this.texture)===null||Kt===void 0||Kt.bind()}const ue={u_animate:this.animateOption2Array(B),u_dash_array:j,u_sourceColor:mt,u_targetColor:Bt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:I,u_lineDir:x?1:-1,u_icon_step:A,u_line_texture:O?1:0,u_textureBlend:f==="normal"?0:1,u_blur:.9,u_line_type:am[p||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:V};return this.getUniformsBufferInfo(ue)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:dC,vert:uu,type:""}}buildModels(){var i=this;return(0,ln.Z)(function*(){i.initUniformsBuffer();const{segmentNumber:s=30}=i.layer.getLayerConfig(),{frag:f,vert:p,type:y}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:"lineArc2d"+y,vertexShader:p,fragmentShader:f,defines:i.getDefines(),inject:i.getInject(),triangulation:om,depth:{enable:!1},styleOption:{segmentNumber:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Nn.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Nn.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[ki(f[3]),ki(f[4]),ki(f[5]),ki(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:p,y}=s[f]||{x:0,y:0};return[p,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Nn.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{thetaOffset:s=1}=i;return[s]}}})}}const M3=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,pC=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,gC={solid:0,dash:1};class C3 extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.NEAREST,min:dt.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:p="solid",dashArray:y=[10,5],lineTexture:x=!1,iconStep:O=100,segmentNumber:A=30,globalArcHeight:I=10}=this.layer.getLayerConfig(),{animateOption:B}=this.layer.getLayerConfig();y.length===2&&y.push(0,0);let j=0,V=[0,0,0,0],mt=[0,0,0,0];if(i&&s&&(V=Gr(i),mt=Gr(s),j=1),this.rendererService.getDirty()){var Bt;(Bt=this.texture)===null||Bt===void 0||Bt.bind()}const Kt={u_animate:this.animateOption2Array(B),u_dash_array:y,u_sourceColor:V,u_targetColor:mt,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:m3,u_global_height:I,segmentNumber:A,u_line_type:gC[p]||0,u_icon_step:O,u_line_texture:x?1:0,u_textureBlend:f==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:j};return this.getUniformsBufferInfo(Kt)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:M3,vert:pC,type:""}}buildModels(){var i=this;return(0,ln.Z)(function*(){const{segmentNumber:s=30}=i.layer.getLayerConfig(),{frag:f,vert:p,type:y}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:"lineArc3d"+y,vertexShader:p,fragmentShader:f,defines:i.getDefines(),inject:i.getInject(),triangulation:om,styleOption:{segmentNumber:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Nn.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Nn.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[ki(f[3]),ki(f[4]),ki(f[5]),ki(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:p,y}=s[f]||{x:0,y:0};return[p,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Nn.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{thetaOffset:s=1}=i;return[s]}}})}}const P3={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},Lo=1/2;function vC(a,i){const{width:s=2,height:f=1}=i;return{vertices:[0,Lo*a,1*a*s,-(f+Lo)*a,1*a*s,(f-Lo)*a,0,Lo*a,1*a*s,-(f+Lo)*a,1*a*s,(f-Lo)*a],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*a,-2*a,1,-2*a,1.5*a,1,1*a,1.5*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function mC(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,1*a*s,1*f,1*a*s,-1*f,0,0,1*a*s,1*f,1*a*s,-1*f],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*a,1,2,1*a,1,-2,1*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function yC(a,i){const{width:s=2,height:f=2}=i;return{vertices:[0,f/2,a*s*1,f/2,a*s*1,-f/2,0,-f/2,0,f/2,a*s*1,f/2,a*s*1,-f/2,0,-f/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function _C(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,1*s*a,.5*f,2*s*a,0,1*s*a,-.5*f,0,0,1*s*a,.5*f,2*s*a,0,1*s*a,-.5*f],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function bC(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,2*a*s,1*f,1.5*a*s,0,2*a*s,-1*f,0,0,2*a*s,1*f,1.5*a*s,0,2*a*s,-1*f],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function xC(a,i){const{width:s=2,height:f=2}=i,p=em(),y=Qc().flatten([p]),x=Qc()(y.vertices,y.holes,y.dimensions),O=p.map(A=>[A[0]*s*a,A[1]*f]).flat();return{vertices:[...O,...O],dimensions:2,indices:x.map(A=>A+p.length),outLineIndices:x,normals:[...p.map(A=>[A[1]*f,A[0]*s*a,1]).flat(),...new Array(p.length*3).fill(0)]}}function SC(a,i=0,s){const f=typeof s.source=="object"?s.source.type:s.source,p=typeof s.target=="object"?s.target.type:s.target,{width:y=f?P3[f]:0}=typeof s.source=="object"?s.source:{},{width:x=p?P3[p]:0}=typeof s.target=="object"?s.target:{};return{vertices:[0,Lo,1*y,...a,1,Lo,-1*x,...a,1,-Lo,-1*x,...a,0,-Lo,1*y,...a,0,Lo,1*y,...a,1,Lo,-1*x,...a,1,-Lo,-1*x,...a,0,-Lo,1*y,...a],outLineIndices:[0,1,2,0,2,3].map(O=>O+i),indices:[4,5,6,4,6,7].map(O=>O+i),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function L3(a,i){const s=typeof a=="object"?a.type:a,f=i==="source"?1:-1,p=typeof a=="object"?a:{};switch(s){case"circle":return xC(f,p);case"triangle":return mC(f,p);case"diamond":return _C(f,p);case"rect":return yC(f,p);case"classic":return bC(f,p);case"halfTriangle":return vC(f,p);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function wC(a){const i=a.coordinates.flat(),s=1,f=1;return{vertices:[1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i,1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i],normals:[-s,2*f,1,2*f,-f,1,f,-f,1,f,-f,1,-s,-f,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function I3(a,i){return i?OC(a,i):wC(a)}function OC(a,i){const s=a.coordinates.flat(),{target:f="classic",source:p="circle"}=i,y=R3(L3(p,"source"),s,0,0),x=SC(s,y.vertices.length/7,i),O=R3(L3(f,"target"),s,1,y.vertices.length/7+x.vertices.length/7);return{vertices:[...y.vertices,...x.vertices,...O.vertices],indices:[...y.outLineIndices,...x.outLineIndices,...O.outLineIndices,...y.indices,...x.indices,...O.indices],normals:[...y.normals,...x.normals,...O.normals],size:7}}function R3(a,i,s=1,f=0){const p=[],{vertices:y,indices:x,dimensions:O,outLineIndices:A}=a;for(let I=0;I<y.length;I+=O)p.push(s,y[I+1],y[I],...i);return(0,on.Z)((0,on.Z)({},a),{},{vertices:p,indices:x.map(I=>I+f),outLineIndices:A.map(I=>I+f)})}const EC=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;

// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,AC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class TC extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:i=2,strokeWidth:s=1,strokeOpacity:f=1}=this.layer.getLayerConfig(),p={u_gap_width:i,u_stroke_width:s,u_stroke_opacity:f};return this.getUniformsBufferInfo(p)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return[yield i.layer.buildLayerModel({moduleName:"flow_line",vertexShader:AC,fragmentShader:EC,defines:i.getDefines(),inject:i.getInject(),triangulation:I3,styleOption:i.layer.getLayerConfig().symbol,primitive:dt.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Nn.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Nn.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[ki(f[3]),ki(f[4]),ki(f[5]),ki(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y)=>y}})}}const xs=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,qs=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,sm={solid:0,dash:1};class k3 extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.NEAREST,min:dt.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:p="solid",dashArray:y=[10,5],lineTexture:x=!1,iconStep:O=100,segmentNumber:A=30}=this.layer.getLayerConfig(),{animateOption:I}=this.layer.getLayerConfig();if(y.length===2&&y.push(0,0),this.rendererService.getDirty()){var B;(B=this.texture)===null||B===void 0||B.bind()}let j=0,V=[0,0,0,0],mt=[0,0,0,0];i&&s&&(V=Gr(i),mt=Gr(s),j=1);let Bt=this.layer.getLayerAnimateTime();isNaN(Bt)&&(Bt=0);const Kt={u_animate:this.animateOption2Array(I),u_dash_array:y,u_sourceColor:V,u_targetColor:mt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:A,u_line_type:sm[p]||0,u_icon_step:O,u_line_texture:x?1:0,u_textureBlend:f==="normal"?0:1,u_time:Bt,u_linearColor:j};return this.getUniformsBufferInfo(Kt)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,ln.Z)(function*(){const{segmentNumber:s=30}=i.layer.getLayerConfig();return[yield i.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:qs,fragmentShader:xs,triangulation:om,styleOption:{segmentNumber:s},defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Nn.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Nn.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>[ki(f[3]),ki(f[4]),ki(f[5]),ki(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:p,y}=s[f]||{x:0,y:0};return[p,y]}}})}}let t8=function(a){return a[a.solid=0]="solid",a[a.dash=1]="dash",a}({}),D3=function(a){return a.VERTICAL="vertical",a.HORIZONTAL="horizontal",a}({}),MC=function(a){return a.NORMAL="normal",a.REPLACE="replace",a}({}),Bp=function(a){return a[a.pixel=0]="pixel",a[a.meter=1]="meter",a}({}),e8=function(a){return a.ALWAYS="always",a.DRAGEND="dragend",a}({});const CC=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,N3=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class jp extends si{constructor(...i){super(...i),(0,ot.Z)(this,"textureEventFlag",!1),(0,ot.Z)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.NEAREST,min:dt.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:p="solid",dashArray:y=[10,5,0,0],lineTexture:x=!1,iconStep:O=100,vertexHeightScale:A=20,strokeWidth:I=0,raisingHeight:B=0,heightfixed:j=!1,linearDir:V=D3.VERTICAL,blur:mt=[1,1,1,0]}=this.layer.getLayerConfig();let Bt=y;if(p!=="dash"&&(Bt=[0,0,0,0]),Bt.length===2&&Bt.push(0,0),this.rendererService.getDirty()&&this.texture){var Kt;(Kt=this.texture)===null||Kt===void 0||Kt.bind()}const{animateOption:ue}=this.layer.getLayerConfig();let Le=0,ke=[0,0,0,0],He=[0,0,0,0];i&&s&&(ke=Gr(i),He=Gr(s),Le=1);const Ye={u_animate:this.animateOption2Array(ue),u_dash_array:Bt,u_blur:mt,u_sourceColor:ke,u_targetColor:He,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:O,u_heightfixed:Number(j),u_vertexScale:A,u_raisingHeight:Number(B),u_strokeWidth:I,u_textureBlend:f===MC.NORMAL?0:1,u_line_texture:x?1:0,u_linearDir:V===D3.VERTICAL?1:0,u_linearColor:Le,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Ye)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.textureEventFlag||(i.textureEventFlag=!0,i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture)),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,ln.Z)(function*(){const{depth:s=!1}=i.layer.getLayerConfig(),{frag:f,vert:p,type:y}=i.getShaders();return i.layer.triangulation=im,[yield i.layer.buildLayerModel({moduleName:"line"+y,vertexShader:p,fragmentShader:f,triangulation:im,defines:i.getDefines(),inject:i.getInject(),depth:{enable:s}})]})()}getShaders(){return{frag:CC,vert:N3,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Nn.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y,x)=>x===void 0?[f[3],10,f[4]]:[f[3],x,f[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:Nn.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f,p,y)=>[...y,f[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:p,y}=s[f]||{x:0,y:0};return[p,y]}}})}}const F3=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,cm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class PC extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,lineType:f="solid",dashArray:p=[10,5,0,0],vertexHeightScale:y=20}=this.layer.getLayerConfig();let x=p;f!=="dash"&&(x=[0,0,0,0]),x.length===2&&x.push(0,0);let O=0,A=[0,0,0,0],I=[0,0,0,0];i&&s&&(A=Gr(i),I=Gr(s),O=1);const B={u_sourceColor:A,u_targetColor:I,u_dash_array:x,u_vertexScale:y,u_linearColor:O};return this.getUniformsBufferInfo(B)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}getShaders(){return{frag:F3,vert:cm,type:"lineSimpleNormal"}}buildModels(){var i=this;return(0,ln.Z)(function*(){i.initUniformsBuffer();const{frag:s,vert:f,type:p}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:p,vertexShader:f,fragmentShader:s,triangulation:oC,defines:i.getDefines(),inject:i.getInject(),primitive:dt.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:Nn.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:4,update:(i,s,f)=>{const{size:p=1}=i,y=Array.isArray(p)?[p[0],p[1]]:[p,0];return[y[0],y[1],f[3],f[5]]}}})}}const LC=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,IC=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class RC extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.NEAREST,min:dt.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",heightfixed:p=!1,lineTexture:y=!1,iconStep:x=100,iconStepCount:O=1}=this.layer.getLayerConfig(),{animateOption:A}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var I;(I=this.texture)===null||I===void 0||I.bind()}let B=0,j=[0,0,0,0],V=[0,0,0,0];i&&s&&(j=Gr(i),V=Gr(s),B=1);const mt={u_animate:this.animateOption2Array(A),u_sourceColor:j,u_targetColor:V,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:x,u_heightfixed:Number(p),u_linearColor:B,u_line_texture:y?1:0,u_textureBlend:f==="normal"?0:1,u_iconStepCount:O,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(mt)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,ln.Z)(function*(){return[yield i.layer.buildLayerModel({moduleName:"lineWall",vertexShader:IC,fragmentShader:LC,triangulation:im,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},blend:i.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:Nn.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f)=>[f[3],f[4],f[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:p,y}=s[f]||{x:0,y:0};return[p,y]}}})}}var kC={arc:hC,arc3d:C3,greatcircle:k3,wall:RC,line:jp,simple:PC,flowline:TC,earthArc3d:C3};class lm extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","LineLayer"),(0,ot.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,ot.Z)(this,"arrowInsertCount",0),(0,ot.Z)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel=new kC[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[i]}getModelType(){var i;if(this.layerType)return this.layerType;const s=this.styleAttributeService.getLayerStyleAttribute("shape");return(s==null||(i=s.scale)===null||i===void 0?void 0:i.field)||"line"}processData(i){if(this.getModelType()!=="simple")return i;const s=[];return i.map(f=>{if(Array.isArray(f.coordinates)&&Array.isArray(f.coordinates[0])&&Array.isArray(f.coordinates[0][0])){const p=(0,on.Z)({},f);f.coordinates.map(y=>{s.push((0,on.Z)((0,on.Z)({},p),{},{coordinates:y}))})}else s.push(f)}),s}}const B3=`in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if (u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,DC=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class j3 extends si{constructor(...i){super(...i),(0,ot.Z)(this,"raiseCount",0),(0,ot.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:i={enable:!1,speed:.01,repeat:!1},sourceColor:s,targetColor:f,pickLight:p=!1,heightfixed:y=!1,opacityLinear:x={enable:!1,dir:"up"},lightEnable:O=!0}=this.layer.getLayerConfig();let A=0,I=[0,0,0,0],B=[0,0,0,0];if(s&&f&&(I=Gr(s),B=Gr(f),A=1),this.raiseCount<1&&this.raiseRepeat>0&&i.enable){const{speed:mt=.01}=i;this.raiseCount+=mt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const j={u_pickLight:Number(p),u_heightfixed:Number(y),u_r:i.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:A,u_sourceColor:I,u_targetColor:B,u_opacitylinear:Number(x.enable),u_opacitylinear_dir:x.dir==="up"?1:0,u_lightEnable:Number(O)};return this.getUniformsBufferInfo(j)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{depth:s=!0,animateOption:{repeat:f=1}}=i.layer.getLayerConfig();return i.raiseRepeat=f,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:DC,fragmentShader:B3,triangulation:O3,defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:dt.FRONT},depth:{enable:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:i=>{const{size:s}=i;if(s){let f=[];return Array.isArray(s)&&(f=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(f=[s,s,s]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Nn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:4,update:i=>{const s=yc(i.coordinates);return[s[0],s[1],ki(s[0]),ki(s[1])]}}})}}const NC=`layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.0));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(antialiasblur, 0.0, inner_df);

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if (u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if (u_time != -1.0) {
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if (d > 0.5) {
      discard;
    }
    intensity =
      clamp(cos(d * PI), 0.0, 1.0) *
      clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if (u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity; //wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity; //wave
    outputColor = filterColor(outputColor);
  }
  // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
}
`,FC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class um extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:i=1,strokeWidth:s=0,blend:f,blur:p=0,raisingHeight:y=0,heightfixed:x=!1,unit:O="pixel"}=this.layer.getLayerConfig();let A=this.getAnimateUniforms().u_time;isNaN(A)&&(A=-1);const I={u_blur_height_fixed:[p,Number(y),Number(x)],u_stroke_width:s,u_additive:f==="additive"?1:0,u_stroke_opacity:i,u_size_unit:Bp[O],u_time:A,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(I)}getAnimateUniforms(){const{animateOption:i={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(i),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),tl)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{frag:s,vert:f,type:p}=i.getShaders();return i.layer.triangulation=tl,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:p,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:tl,depth:{enable:!1}})]})()}getShaders(){return{frag:NC,vert:FC,type:"pointFill"}}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){const i=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Nn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(s,f,p,y)=>{const x=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=y%4*3;return[x[O],x[O+1],x[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:s=>{const{size:f=5}=s;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Nn.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:s=>{const{shape:f=2}=s;return[i.indexOf(f)]}}})}}const fm=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main() {
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.0;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6

  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if (fragmengTocenter >= 0.5) {
    float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
    textureColor.a *= luma;
  }

  if (
    all(lessThan(v_color, vec4(1.0 + 0.00001))) && all(greaterThan(v_color, vec4(1.0 - 0.00001))) ||
    v_color == vec4(1.0)
  ) {
    outputColor = textureColor;
  } else {
    outputColor = step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,BC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class z3 extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.LINEAR,min:dt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var i;(i=this.texture)===null||i===void 0||i.bind()}const s=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},s.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:i=0,heightfixed:s=!1}=this.layer.getLayerConfig(),f={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(i),u_heightfixed:Number(s),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.iconService.on("imageUpdate",i.updateTexture),i.updateTexture(),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointImage",vertexShader:BC,fragmentShader:fm,triangulation:Ho,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},primitive:dt.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{shape:f}=i,{x:p,y}=s[f]||{x:-64,y:-64};return[p,y]}}})}}const jC=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}
`,zC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function dm(a){const i=a.coordinates;return{vertices:[...i],indices:[0],size:i.length}}class Yf extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const i={u_size_scale:.5};return this.getUniformsBufferInfo(i)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.layer.triangulation=dm,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:zC,fragmentShader:jC,triangulation:dm,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},primitive:dt.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}class U3{constructor(i,s,f){(0,ot.Z)(this,"boxCells",[]),(0,ot.Z)(this,"xCellCount",void 0),(0,ot.Z)(this,"yCellCount",void 0),(0,ot.Z)(this,"boxKeys",void 0),(0,ot.Z)(this,"bboxes",void 0),(0,ot.Z)(this,"width",void 0),(0,ot.Z)(this,"height",void 0),(0,ot.Z)(this,"xScale",void 0),(0,ot.Z)(this,"yScale",void 0),(0,ot.Z)(this,"boxUid",void 0);const p=this.boxCells;this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(s/f);for(let y=0;y<this.xCellCount*this.yCellCount;y++)p.push([]);this.boxKeys=[],this.bboxes=[],this.width=i,this.height=s,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/s,this.boxUid=0}insert(i,s,f,p,y){this.forEachCell(s,f,p,y,this.insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(s),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(y)}query(i,s,f,p,y){return this.queryHitTest(i,s,f,p,!1,y)}hitTest(i,s,f,p,y){return this.queryHitTest(i,s,f,p,!0,y)}insertBoxCell(i,s,f,p,y,x){this.boxCells[y].push(x)}queryHitTest(i,s,f,p,y,x){if(f<0||i>this.width||p<0||s>this.height)return y?!1:[];const O=[];if(i<=0&&s<=0&&this.width<=f&&this.height<=p){if(y)return!0;for(let I=0;I<this.boxKeys.length;I++)O.push({key:this.boxKeys[I],x1:this.bboxes[I*4],y1:this.bboxes[I*4+1],x2:this.bboxes[I*4+2],y2:this.bboxes[I*4+3]});return x?O.filter(x):O}const A={hitTest:y,seenUids:{box:{},circle:{}}};return this.forEachCell(i,s,f,p,this.queryCell,O,A,x),y?O.length>0:O}queryCell(i,s,f,p,y,x,O,A){const I=O.seenUids,B=this.boxCells[y];if(B!==null){const j=this.bboxes;for(const V of B)if(!I.box[V]){I.box[V]=!0;const mt=V*4;if(i<=j[mt+2]&&s<=j[mt+3]&&f>=j[mt+0]&&p>=j[mt+1]&&(!A||A(this.boxKeys[V]))){if(O.hitTest)return x.push(!0),!0;x.push({key:this.boxKeys[V],x1:j[mt],y1:j[mt+1],x2:j[mt+2],y2:j[mt+3]})}}}return!1}forEachCell(i,s,f,p,y,x,O,A){const I=this.convertToXCellCoord(i),B=this.convertToYCellCoord(s),j=this.convertToXCellCoord(f),V=this.convertToYCellCoord(p);for(let mt=I;mt<=j;mt++)for(let Bt=B;Bt<=V;Bt++){const Kt=this.xCellCount*Bt+mt;if(y.call(this,i,s,f,p,Kt,x,O,A))return}}convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}}var Z3=U3;class r8{constructor(i,s){(0,ot.Z)(this,"width",void 0),(0,ot.Z)(this,"height",void 0),(0,ot.Z)(this,"grid",void 0),(0,ot.Z)(this,"viewportPadding",100),(0,ot.Z)(this,"screenRightBoundary",void 0),(0,ot.Z)(this,"screenBottomBoundary",void 0),(0,ot.Z)(this,"gridRightBoundary",void 0),(0,ot.Z)(this,"gridBottomBoundary",void 0),this.width=i,this.height=s,this.viewportPadding=Math.max(i,s),this.grid=new Z3(i+this.viewportPadding,s+this.viewportPadding,25),this.screenRightBoundary=i+this.viewportPadding,this.screenBottomBoundary=s+this.viewportPadding,this.gridRightBoundary=i+2*this.viewportPadding,this.gridBottomBoundary=s+2*this.viewportPadding}placeCollisionBox(i){const s=i.x1+i.anchorPointX+this.viewportPadding,f=i.y1+i.anchorPointY+this.viewportPadding,p=i.x2+i.anchorPointX+this.viewportPadding,y=i.y2+i.anchorPointY+this.viewportPadding;return!this.isInsideGrid(s,f,p,y)||this.grid.hitTest(s,f,p,y)?{box:[]}:{box:[s,f,p,y]}}insertCollisionBox(i,s){const f={featureIndex:s};this.grid.insert(f,i[0],i[1],i[2],i[3])}project(i,s,f){const p=Tc.al(s,f,0,1),y=Tc.Ue(),x=Zr.fromValues(...i);return Tc.fF(y,p,x),{x:(y[0]/y[3]+1)/2*this.width+this.viewportPadding,y:(-y[1]/y[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(i,s,f,p){return f>=0&&i<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}}function hm(a){let i=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0;break;default:i=.5}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0;break;default:s=.5}return{horizontalAlign:i,verticalAlign:s}}function pm(a,i,s,f,p){if(!p)return;const y=a[f],x=y.glyph;if(x){const O=i[x].advance*y.scale,A=(a[f].x+O)*p;for(let I=s;I<=f;I++)a[I].x-=A}}function Wo(a,i,s,f,p,y,x){const O=(i-s)*p,A=(-f*x+.5)*y;for(const I of a)I.x+=O,I.y+=A}function H3(a,i,s,f,p,y,x){let A=0,I=-8,B=0;const j=a.positionedGlyphs,V=y==="right"?1:y==="left"?0:.5,mt=j.length;s.forEach(Le=>{if(Le.split("").forEach(ke=>{const He=i[ke];He&&(j.push({glyph:ke,x:A,y:I+0,vertical:!1,scale:1,metrics:He}),A+=He.advance+x)}),j.length!==mt){const ke=A-x;B=Math.max(ke,B),pm(j,i,mt,j.length-1,V)}A=0,I-=f+5});const{horizontalAlign:Bt,verticalAlign:Kt}=hm(p);Wo(j,V,Bt,Kt,B,f,s.length);const ue=I- -8;a.top+=-Kt*ue,a.bottom=a.top-ue,a.left+=-Bt*B,a.right=a.left+B}function UC(a,i,s,f,p,y,x){let A=0,I=-8,B=0;const j=a.positionedGlyphs,V=y==="right"?1:y==="left"?0:.5,mt=j.length;s.forEach(Le=>{const ke=i[Le];if(ke&&(j.push({glyph:Le,x:ke.advance/2,y:I+0,vertical:!1,scale:1,metrics:ke}),A+=ke.advance+x),j.length!==mt){const Ye=A-x;B=Math.max(Ye,B),pm(j,i,mt,j.length-1,V)}A=0,I-=f+5});const{horizontalAlign:Bt,verticalAlign:Kt}=hm(p);Wo(j,V,Bt,Kt,B,f,s.length);const ue=I- -8;a.top+=-Kt*ue,a.bottom=a.top-ue,a.left+=-Bt*B,a.right=a.left+B}function ZC(a,i,s,f,p,y,x=[0,0],O){const A=a.split(`
`),I=[],B={positionedGlyphs:I,top:x[1],bottom:x[1],left:x[0],right:x[0],lineCount:A.length,text:a};return O?UC(B,i,A,s,f,p,y):H3(B,i,A,s,f,p,y),I.length?B:!1}function HC(a,i=[0,0],s){const{positionedGlyphs:f=[]}=a,p=[];for(const y of f){const x=y.metrics,O=4,A=x.advance*y.scale/2,I=s?[y.x+A,y.y]:[0,0],B=s?[0,0]:[y.x+A+i[0],y.y+i[1]],j=(0-O)*y.scale-A+B[0],V=(0-O)*y.scale+B[1],mt=j+x.width*y.scale,Bt=V+x.height*y.scale,Kt={x:j,y:V},ue={x:mt,y:V},Le={x:j,y:Bt},ke={x:mt,y:Bt};p.push({tl:Kt,tr:ue,bl:Le,br:ke,tex:x,glyphOffset:I})}return p}const W3=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,V3=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:Xf}=hi;function gm(a){const i=this,s=a.id,f=[],p=[];if(!i.glyphInfoMap||!i.glyphInfoMap[s])return{vertices:[],indices:[],size:7};const y=i.glyphInfoMap[s].centroid,x=y.length===2?[y[0],y[1],0]:y;return i.glyphInfoMap[s].glyphQuads.forEach((O,A)=>{f.push(...x,O.tex.x,O.tex.y+O.tex.height,O.tl.x,O.tl.y,...x,O.tex.x+O.tex.width,O.tex.y+O.tex.height,O.tr.x,O.tr.y,...x,O.tex.x+O.tex.width,O.tex.y,O.br.x,O.br.y,...x,O.tex.x,O.tex.y,O.bl.x,O.bl.y),p.push(0+A*4,1+A*4,2+A*4,2+A*4,3+A*4,0+A*4)}),{vertices:f,indices:p,size:7}}class G3 extends si{constructor(...i){var s;super(...i),s=this,(0,ot.Z)(this,"glyphInfo",void 0),(0,ot.Z)(this,"glyphInfoMap",{}),(0,ot.Z)(this,"rawEncodeData",void 0),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"currentZoom",-1),(0,ot.Z)(this,"extent",void 0),(0,ot.Z)(this,"textureHeight",0),(0,ot.Z)(this,"textCount",0),(0,ot.Z)(this,"preTextStyle",{}),(0,ot.Z)(this,"mapping",(0,ln.Z)(function*(){s.initGlyph(),s.updateTexture(),yield s.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:i="#fff",strokeWidth:s=0,halo:f=.5,gamma:p=2,raisingHeight:y=0}=this.layer.getLayerConfig(),x=this.getFontServiceMapping(),O=this.getFontServiceCanvas();x&&Object.keys(x).length!==this.textCount&&O&&(this.updateTexture(),this.textCount=Object.keys(x).length),this.preTextStyle=this.getTextStyle();const A={u_stroke_color:Gr(i),u_sdf_map_size:[(O==null?void 0:O.width)||1,(O==null?void 0:O.height)||1],u_raisingHeight:Number(y),u_stroke_width:s,u_gamma_scale:p,u_halo_blur:f};return this.getUniformsBufferInfo(A)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.bindEvent(),i.extent=i.textExtent(),i.rawEncodeData=i.layer.getEncodedData(),i.preTextStyle=i.getTextStyle(),i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{textAllowOverlap:s=!1}=i.layer.getLayerConfig();return i.initGlyph(),i.updateTexture(),s||i.filterGlyphs(),[yield i.layer.buildLayerModel({moduleName:"pointText",vertexShader:V3,fragmentShader:W3,defines:i.getDefines(),inject:i.getInject(),triangulation:gm.bind(i),depth:{enable:!1}})]})()}needUpdate(){var i=this;return(0,ln.Z)(function*(){const{textAllowOverlap:s=!1,textAnchor:f="center",textOffset:p,padding:y,fontFamily:x,fontWeight:O}=i.getTextStyle();if(!Xf(y,i.preTextStyle.padding)||!Xf(p,i.preTextStyle.textOffset)||!Xf(f,i.preTextStyle.textAnchor)||!Xf(x,i.preTextStyle.fontFamily)||!Xf(O,i.preTextStyle.fontWeight))return yield i.mapping(),!0;if(s)return!1;const A=i.mapService.getZoom(),I=i.mapService.getBounds(),B=G0(i.extent,I);return Math.abs(i.currentZoom-A)>.5||!B||s!==i.preTextStyle.textAllowOverlap?(yield i.reBuildModel(),!0):!1})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Nn.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Nn.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=12}=i;return Array.isArray(s)?[s[0]]:[s]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const i=this.mapService.getBounds();return Dd(i,.5)}initTextFont(){const{fontWeight:i,fontFamily:s}=this.getTextStyle(),f=this.rawEncodeData,p=[];f.forEach(y=>{let{shape:x=""}=y;x=x.toString();for(const O of x)p.indexOf(O)===-1&&p.push(O)}),this.fontService.setFontOptions({characterSet:p,fontWeight:i,fontFamily:s,iconfont:!1})}initIconFontTex(){const{fontWeight:i,fontFamily:s}=this.getTextStyle(),f=this.rawEncodeData,p=[];f.forEach(y=>{let{shape:x=""}=y;x=`${x}`,p.indexOf(x)===-1&&p.push(x)}),this.fontService.setFontOptions({characterSet:p,fontWeight:i,fontFamily:s,iconfont:!0})}getTextStyle(){const{fontWeight:i="400",fontFamily:s="sans-serif",textAllowOverlap:f=!1,padding:p=[0,0],textAnchor:y="center",textOffset:x=[0,0],opacity:O=1,strokeOpacity:A=1,strokeWidth:I=0,stroke:B="#000"}=this.layer.getLayerConfig();return{fontWeight:i,fontFamily:s,textAllowOverlap:f,padding:p,textAnchor:y,textOffset:x,opacity:O,strokeOpacity:A,strokeWidth:I,stroke:B}}generateGlyphLayout(i){const s=this.getFontServiceMapping(),{spacing:f=2,textAnchor:p="center",textOffset:y}=this.layer.getLayerConfig(),x=this.rawEncodeData;this.glyphInfo=x.map(O=>{const{shape:A="",id:I,size:B=1}=O,j=O.textOffset?O.textOffset:y||[0,0],V=O.textAnchor?O.textAnchor:p||"center",mt=ZC(A.toString(),s,B,V,"left",f,j,i),Bt=HC(mt,j,!1);return O.shaping=mt,O.glyphQuads=Bt,O.centroid=yc(O.coordinates),this.glyphInfoMap[I]={shaping:mt,glyphQuads:Bt,centroid:yc(O.coordinates)},O})}getFontServiceMapping(){const{fontWeight:i="400",fontFamily:s="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${s}_${i}`)}getFontServiceCanvas(){const{fontWeight:i="400",fontFamily:s="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${s}_${i}`)}filterGlyphs(){const{padding:i=[0,0],textAllowOverlap:s=!1}=this.layer.getLayerConfig();if(s)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:f,height:p}=this.rendererService.getViewportSize(),y=new r8(f,p);this.glyphInfo.filter(O=>{const{shaping:A,id:I=0}=O,B=O.centroid,V=O.size/16,mt=this.mapService.lngLatToContainer(B),{box:Bt}=y.placeCollisionBox({x1:A.left*V-i[0],x2:A.right*V+i[0],y1:A.top*V-i[1],y2:A.bottom*V+i[1],anchorPointX:mt.x,anchorPointY:mt.y});return Bt&&Bt.length?(y.insertCollisionBox(Bt,I),!0):!1}).forEach(O=>{this.glyphInfoMap[O.id]=O})}initGlyph(){const{iconfont:i=!1}=this.layer.getLayerConfig();i?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(i)}updateTexture(){const{createTexture2D:i}=this.rendererService,s=this.getFontServiceCanvas();this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=i({data:s,mag:dt.LINEAR,min:dt.LINEAR,width:s.width,height:s.height}),this.textures=[this.texture]}reBuildModel(){var i=this;return(0,ln.Z)(function*(){i.filterGlyphs();const s=yield i.layer.buildLayerModel({moduleName:"pointText",vertexShader:V3,fragmentShader:W3,triangulation:gm.bind(i),defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}});i.layer.models=[s]})()}}function $3(a){return vm.apply(this,arguments)}function vm(){return vm=(0,ln.Z)(function*(a){if(window.createImageBitmap){const i=yield fetch(a);return yield createImageBitmap(yield i.blob())}else{const i=new window.Image;return new Promise(s=>{i.onload=()=>s(i),i.src=a,i.crossOrigin="Anonymous"})}}),vm.apply(this,arguments)}const WC=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  // top face
  if (u_topsurface < 1.0) {
    discard;
  }

  outputColor = v_Color;

  outputColor = filterColor(outputColor);
}
`,i8=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide = v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
      outputColor = v_Color;
    }
  } else {
    // top face
    if (u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,Y3=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,VC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,GC=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
    // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }

  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,qf=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Kf extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:i,heightfixed:s=!1,raisingHeight:f=0,topsurface:p=!0,sidesurface:y=!0,sourceColor:x,targetColor:O}=this.layer.getLayerConfig();let A=0,I=[1,1,1,1],B=[1,1,1,1];x&&O&&(I=Gr(x),B=Gr(O),A=1);const j={u_sourceColor:I,u_targetColor:B,u_linearColor:A,u_topsurface:Number(p),u_sidesurface:Number(y),u_heightfixed:Number(s),u_raisingHeight:Number(f)};return i&&this.texture&&(j.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(j)}initModels(){var i=this;return(0,ln.Z)(function*(){return yield i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{frag:s,vert:f,type:p}=i.getShaders();return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:p,vertexShader:f,fragmentShader:s,depth:{enable:!0},defines:i.getDefines(),inject:i.getInject(),triangulation:T3})]})()}getShaders(){const{pickLight:i,mapTexture:s}=this.layer.getLayerConfig();return s?{frag:GC,vert:qf,type:"polygonExtrudeTexture"}:i?{frag:i8,vert:Y3,type:"polygonExtrudePickLight"}:{frag:WC,vert:VC,type:"polygonExtrude"}}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.textures=[]}registerBuiltinAttributes(){const i=this.layer.getSource().extent,s=i[2]-i[0],f=i[3]-i[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Nn.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(p,y,x)=>{const O=x[0],A=x[1];return[(O-i[0])/s,(A-i[1])/f,x[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(p,y,x,O,A)=>A}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:p=>{const{size:y=10}=p;return Array.isArray(y)?[y[0]]:[y]}}})}loadTexture(){var i=this;return(0,ln.Z)(function*(){const{mapTexture:s}=i.layer.getLayerConfig(),{createTexture2D:f}=i.rendererService;if(i.texture=f({height:1,width:1}),s){const p=yield $3(s);i.texture=f({data:p,width:p.width,height:p.height,wrapS:dt.CLAMP_TO_EDGE,wrapT:dt.CLAMP_TO_EDGE,min:dt.LINEAR,mag:dt.LINEAR})}})()}}const rl=`in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,X3=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class $C extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const i={};return this.getUniformsBufferInfo(i)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{frag:s,vert:f,type:p}=i.getShaders();return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:p,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:T3,depth:{enable:!0}})]})()}getShaders(){return{frag:rl,vert:X3,type:"polygonExtrude"}}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=10}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:Nn.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{extrusionBase:s=0}=i;return[s]}}})}}const YC=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,q3=`layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *=
      u_dir == 1.0
        ? 1.0 - length(v_pos - v_linear.xy) / v_linear.z
        : length(v_pos - v_linear.xy) / v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,mm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,K3=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class XC extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:i=0,opacityLinear:s={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),f={u_raisingHeight:Number(i),u_opacitylinear:Number(s.enable),u_dir:s.dir==="in"?1:0};return this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{frag:s,vert:f,triangulation:p,type:y}=i.getModelParams();return i.initUniformsBuffer(),i.layer.triangulation=p,[yield i.layer.buildLayerModel({moduleName:y,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:p,primitive:dt.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:i={enable:!1,dir:"in"}}=this.layer.getLayerConfig();i.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Nn.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(s,f,p)=>[p[3],p[4],p[5]]}})}getModelParams(){const{opacityLinear:i={enable:!1}}=this.layer.getLayerConfig();return i.enable?{frag:q3,vert:mm,type:"polygonLinear",triangulation:sC}:{frag:YC,vert:K3,type:"polygonFill",triangulation:el}}}const qC=`layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.1;
float large_waveheight = 0.75; // change to adjust the "heavy" waves
float large_wavesize = 3.4; // factor to adjust the large wave size
float small_waveheight = 0.6; // change to adjust the small random waves
float small_wavesize = 0.5; // factor to ajust the small wave size
float water_softlight_fact = 15.0; // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact = 120.0; // range [1..200]
float particle_amount = 70.0;

vec3 water_specularcolor = vec3(1.3, 1.3, 0.9); // specular Color (RGB) of the water-highlights
#define light (vec3(-0.0, sin(u_time * 0.5) * 0.5 + 0.35, 2.8)) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

float hash(float n) {
  return fract(sin(n) * 43758.5453123);
}

// 2d noise function
float noise1(vec2 x) {
  vec2 p = floor(x);
  vec2 f = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y * 57.0;
  return mix(mix(hash(n + 0.0), hash(n + 1.0), f.x), mix(hash(n + 57.0), hash(n + 58.0), f.x), f.y);
}

float noise(vec2 p) {
  return texture(SAMPLER_2D(u_texture2), p * vec2(1.0 / 256.0)).x;
}

vec4 highness(vec2 p) {
  vec4 t = texture(SAMPLER_2D(u_texture1), fract(p));
  float clipped =
    -2.0 -
    smoothstep(3.0, 10.0, t.a) * 6.9 -
    smoothstep(10.0, 100.0, t.a) * 89.9 -
    smoothstep(0.0, 10000.0, t.a) * 10000.0;
  return clamp(t, 0.0, 3.0) + clamp(t / 3.0 - 1.0, 0.0, 1.0) + clamp(t / 16.0 - 1.0, 0.0, 1.0);
}

float height_map(vec2 p) {
  vec4 height = highness(p);
  /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

  mat2 m = mat2(0.9563 * 1.4, -0.2924 * 1.4, 0.2924 * 1.4, 0.9563 * 1.4);
  //p = p*6.;
  float f = 0.6 * noise1(p);
  p = m * p * 1.1 * 6.0;
  f += 0.25 * noise(p);
  p = m * p * 1.32;
  f += 0.1666 * noise(p);
  p = m * p * 1.11;
  f += 0.0834 * noise(p);
  p = m * p * 1.12;
  f += 0.0634 * noise(p);
  p = m * p * 1.13;
  f += 0.0444 * noise(p);
  p = m * p * 1.14;
  f += 0.0274 * noise(p);
  p = m * p * 1.15;
  f += 0.0134 * noise(p);
  p = m * p * 1.16;
  f += 0.0104 * noise(p);
  p = m * p * 1.17;
  f += 0.0084 * noise(p);
  f = 0.25 * f + dot(height, vec4(-0.03125, -0.125, 0.25, 0.25)) * 0.5;
  const float FLAT_LEVEL = 0.92525;
  //f = f*0.25+height*0.75;
  if (f < FLAT_LEVEL) f = f;
  else f = pow((f - FLAT_LEVEL) / (1.0 - FLAT_LEVEL), 2.0) * (1.0 - FLAT_LEVEL) * 2.0 + FLAT_LEVEL; // makes a smooth coast-increase
  return clamp(f, 0.0, 10.0);
}

vec3 plasma_quintic(float x) {
  x = clamp(x, 0.0, 1.0);
  vec4 x1 = vec4(1.0, x, x * x, x * x * x); // 1 x x2 x3
  vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
  return vec3(
    dot(x1.xyzw, vec4(+0.063861086, +1.992659096, -1.023901152, -0.490832805)) +
      dot(x2.xy, vec2(+1.308442123, -0.914547012)),
    dot(x1.xyzw, vec4(+0.04971859, -0.791144343, +2.892305078, +0.811726816)) +
      dot(x2.xy, vec2(-4.686502417, +2.717794514)),
    dot(x1.xyzw, vec4(+0.513275779, +1.58025506, -5.164414457, +4.559573646)) +
      dot(x2.xy, vec2(-1.916810682, +0.570638854))
  );
}

vec4 color(vec2 p) {
  vec4 c1 = vec4(1.7, 1.6, 0.9, 1);
  vec4 c2 = vec4(0.2, 0.94, 0.1, 1);
  vec4 c3 = vec4(0.3, 0.2, 0.0, 1);
  vec4 c4 = vec4(0.99, 0.99, 1.6, 1);
  vec4 v = highness(p);
  float los = smoothstep(0.1, 1.1, v.b);
  float his = smoothstep(3.5, 6.5, v.b);
  float ces = smoothstep(1.0, 5.0, v.a);
  vec4 lo = mix(c1, c2, los);
  vec4 hi = mix(c3, c4, his);
  vec4 ce = mix(lo, hi, ces);

  return vec4(plasma_quintic(ces), 1).ragb;
}

vec3 terrain_map(vec2 p) {
  return color(p).rgb * 0.75 +
  0.25 * vec3(0.7, 0.55, 0.4) +
  texture(SAMPLER_2D(u_texture3), fract(p * 5.0)).rgb * 0.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2(
   0.72, -1.6 ,
   1.6 ,  0.72
);

float water_map(vec2 p, float height) {
  vec2 p2 = p * large_wavesize;
  vec2 shift1 = 0.001 * vec2(u_time * 160.0 * 2.0, u_time * 120.0 * 2.0);
  vec2 shift2 = 0.001 * vec2(u_time * 190.0 * 2.0, -u_time * 130.0 * 2.0);

  // coarse crossing 'ocean' waves...
  float f = 0.6 * noise(p);
  f += 0.25 * noise(p * m);
  f += 0.1666 * noise(p * m * m);
  float wave =
    sin(p2.x * 0.622 + p2.y * 0.622 + shift2.x * 4.269) * large_waveheight * f * height * height;

  p *= small_wavesize;
  f = 0.0;
  float amp = 1.0,
    s = 0.5;
  for (int i = 0; i < 9; i++) {
    p = m * p * 0.947;
    f -= amp * abs(sin((noise(p + shift1 * s) - 0.5) * 2.0));
    amp = amp * 0.59;
    s *= -1.329;
  }

  return wave + f * small_waveheight;
}

float nautic(vec2 p) {
  p *= 18.0;
  float f = 0.0;
  float amp = 1.0,
    s = 0.5;
  for (int i = 0; i < 3; i++) {
    p = m * p * 1.2;
    f += amp * abs(smoothstep(0.0, 1.0, noise(p + u_time * s)) - 0.5);
    amp = amp * 0.5;
    s *= -1.227;
  }
  return pow(1.0 - f, 5.0);
}

float particles(vec2 p) {
  p *= 200.0;
  float f = 0.0;
  float amp = 1.0,
    s = 1.5;
  for (int i = 0; i < 3; i++) {
    p = m * p * 1.2;
    f += amp * noise(p + u_time * s);
    amp = amp * 0.5;
    s *= -1.227;
  }
  return pow(f * 0.35, 7.0) * particle_amount;
}

float test_shadow(vec2 xy, float height) {
  vec3 r0 = vec3(xy, height);
  vec3 rd = normalize(light - r0);

  float hit = 1.0;
  float t = 0.001;
  for (int j = 1; j < 25; j++) {
    vec3 p = r0 + t * rd;
    float h = height_map(p.xy);
    float height_diff = p.z - h;
    if (height_diff < 0.0) {
      return 0.0;
    }
    t += 0.01 + height_diff * 0.02;
    hit = min(hit, 2.0 * height_diff / t); // soft shaddow
  }
  return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
  vec3 col = terrain_map(uv);
  vec2 iResolution = vec2(512.0);
  float h1 = height_map(uv - vec2(0.0, 0.5) / iResolution.xy);
  float h2 = height_map(uv + vec2(0.0, 0.5) / iResolution.xy);
  float h3 = height_map(uv - vec2(0.5, 0.0) / iResolution.xy);
  float h4 = height_map(uv + vec2(0.5, 0.0) / iResolution.xy);
  vec3 norm = normalize(vec3(h3 - h4, h1 - h2, 1.0));
  vec3 r0 = vec3(uv, height);
  vec3 rd = normalize(light - r0);
  float grad = dot(norm, rd);
  col *= grad + pow(grad, 8.0);
  float terrainshade = test_shadow(uv, height);
  col = mix(col * 0.25, col, terrainshade);
  return col;
}

void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth = 0.4 + coast2water_fadedepth;
  float height = height_map(uv);
  vec3 col;

  float waveheight = clamp(WATER_LEVEL * 3.0 - 1.5, 0.0, 1.0);
  float level = WATER_LEVEL + 0.2 * water_map(uv * 15.0 + vec2(u_time * 0.1), waveheight);
  if (height > level) {
    col = CalcTerrain(uv, height);
  }
  if (height <= level) {
    vec2 dif = vec2(0.0, 0.01);
    vec2 pos = uv * 15.0 + vec2(u_time * 0.01);
    float h1 = water_map(pos - dif, waveheight);
    float h2 = water_map(pos + dif, waveheight);
    float h3 = water_map(pos - dif.yx, waveheight);
    float h4 = water_map(pos + dif.yx, waveheight);
    vec3 normwater = normalize(vec3(h3 - h4, h1 - h2, 0.125)); // norm-vector of the 'bumpy' water-plane
    uv += normwater.xy * 0.002 * (level - height);

    col = CalcTerrain(uv, height);

    float coastfade = clamp((level - height) / coast2water_fadedepth, 0.0, 1.0);
    float coastfade2 = clamp((level - height) / deepwater_fadedepth, 0.0, 1.0);
    float intensity = col.r * 0.2126 + col.g * 0.7152 + col.b * 0.0722;
    watercolor = mix(watercolor * intensity, watercolor2, smoothstep(0.0, 1.0, coastfade2));

    vec3 r0 = vec3(uv, WATER_LEVEL);
    vec3 rd = normalize(light - r0); // ray-direction to the light from water-position
    float grad = dot(normwater, rd); // dot-product of norm-vector and light-direction
    float specular = pow(grad, water_softlight_fact); // used for soft highlights
    float specular2 = pow(grad, water_glossylight_fact); // used for glossy highlights
    float gradpos = dot(vec3(0.0, 0.0, 1.0), rd);
    float specular1 = smoothstep(0.0, 1.0, pow(gradpos, 5.0)); // used for diffusity (some darker corona around light's specular reflections...)
    float watershade = test_shadow(uv, level);
    watercolor *= 2.2 + watershade;
    watercolor += (0.2 + 0.8 * watershade) * ((grad - 1.0) * 0.5 + specular) * 0.25;
    watercolor /= 1.0 + specular1 * 1.25;
    watercolor += watershade * specular2 * water_specularcolor;
    watercolor +=
      watershade *
      coastfade *
      (1.0 - coastfade2) *
      (vec3(0.5, 0.6, 0.7) * nautic(uv) + vec3(1.0, 1.0, 1.0) * particles(uv));

    col = mix(col, watercolor, coastfade);
  }

  outputColor = vec4(col, v_opacity);
}
`,Ks=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Ss extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture1",void 0),(0,ot.Z)(this,"texture2",void 0),(0,ot.Z)(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{watercolor:i="#6D99A8",watercolor2:s="#0F121C"}=this.layer.getLayerConfig(),f={u_watercolor:Gr(i),u_watercolor2:Gr(s),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(f)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var i=this;return(0,ln.Z)(function*(){return i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:Ks,fragmentShader:qC,defines:i.getDefines(),inject:i.getInject(),triangulation:el,primitive:dt.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var i,s,f;(i=this.texture1)===null||i===void 0||i.destroy(),(s=this.texture2)===null||s===void 0||s.destroy(),(f=this.texture3)===null||f===void 0||f.destroy()}registerBuiltinAttributes(){const i=this.layer.getSource().extent,[s,f,p,y]=i,x=p-s,O=y-f;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Nn.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(A,I,B)=>{const[j,V]=B;return[(j-s)/x,(V-f)/O]}}})}loadTexture(){const{createTexture2D:i}=this.rendererService,s={height:0,width:0};this.texture1=i(s),this.texture2=i(s),this.texture3=i(s),f(y=>{this.texture1=p(y[0]),this.texture2=p(y[1]),this.texture3=p(y[2]),this.layerService.reRender()});function f(y){let x=0;const O=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(I=>{const B=new Image;B.crossOrigin="",B.src=I,O.push(B),B.onload=()=>{x++,x===3&&y(O)}})}function p(y){return i({data:y,width:y.width,height:y.height,wrapS:dt.MIRRORED_REPEAT,wrapT:dt.MIRRORED_REPEAT,min:dt.LINEAR,mag:dt.LINEAR})}}}const zp=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;

in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) {
  return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.0;
  p.x += t * 2.0;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.0).xyz;
  p.z += t * 3.0;
  p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.0).xyz;
  p.z += t * 4.0;
  p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.0).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.0;
  return p.y + z / 4.0;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = 0.1;
  return normalize(
    vec3(
      map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
      map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
      map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
    )
  );
}

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0, 1, 0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,KC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class QC extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{speed:i=.5}=this.layer.getLayerConfig(),s={u_speed:i,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(s)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var i=this;return(0,ln.Z)(function*(){return i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:KC,fragmentShader:zp,triangulation:el,defines:i.getDefines(),inject:i.getInject(),primitive:dt.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){const i=this.layer.getSource().extent,[s,f,p,y]=i,x=p-s,O=y-f;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Nn.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(A,I,B)=>{const[j,V]=B;return[(j-s)/x,(V-f)/O]}}})}loadTexture(){const{waterTexture:i}=this.layer.getLayerConfig(),{createTexture2D:s}=this.rendererService;this.texture=s({height:1,width:1});const f=new Image;f.crossOrigin="",i?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),f.src=i):f.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",f.onload=()=>{this.texture=s({data:f,width:f.width,height:f.height,wrapS:dt.MIRRORED_REPEAT,wrapT:dt.MIRRORED_REPEAT,min:dt.LINEAR,mag:dt.LINEAR}),this.layerService.reRender()}}}var Q3={fill:XC,line:jp,extrude:Kf,text:G3,point_fill:um,point_image:z3,point_normal:Yf,point_extrude:j3,water:QC,ocean:Ss,extrusion:$C};class Va extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","PolygonLayer"),(0,ot.Z)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel=new Q3[s](i),yield i.initLayerModels()})()}getModelType(){var i;const s=this.styleAttributeService.getLayerStyleAttribute("shape"),f=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return f==="fill"||!f?"fill":f==="extrude"?"extrude":f==="extrusion"?"extrusion":f==="water"?"water":f==="ocean"?"ocean":f==="line"?"line":this.getPointModelType()}getPointModelType(){const i=this.getEncodedData(),{shape2d:s,shape3d:f}=this.getLayerConfig(),p=this.iconService.getIconMap(),y=i.find(x=>x.hasOwnProperty("shape"));if(y){const x=y.shape;return x==="dot"?"point_normal":(s==null?void 0:s.indexOf(x))!==-1?"point_fill":(f==null?void 0:f.indexOf(x))!==-1?"point_extrude":p.hasOwnProperty(x)?"point_image":"text"}else return"fill"}}class ym{constructor({rendererService:i,layerService:s,parent:f}){(0,ot.Z)(this,"tileResource",new Map),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"parent",void 0),(0,ot.Z)(this,"layerTiles",[]),this.rendererService=i,this.layerService=s,this.parent=f}get tiles(){return this.layerTiles}hasTile(i){return this.layerTiles.some(s=>s.key===i)}addTile(i){this.layerTiles.push(i)}getTile(i){return this.layerTiles.find(s=>s.key===i)}getVisibleTileBylngLat(i){return this.layerTiles.find(s=>s.isLoaded&&s.visible&&s.lnglatInBounds(i))}removeTile(i){const s=this.layerTiles.findIndex(p=>p.key===i),f=this.layerTiles.splice(s,1);f[0]&&f[0].destroy()}updateTileVisible(i){const s=this.getTile(i.key);if(i.isVisible)if(i.parent){const f=this.isChildrenLoaded(i.parent);s==null||s.updateVisible(f)}else s==null||s.updateVisible(!0);else if(i.parent){const f=this.isChildrenLoaded(i.parent);s==null||s.updateVisible(!f)}else s==null||s.updateVisible(!1)}isParentLoaded(i){const s=i.parent;if(!s)return!0;const f=this.getTile(s==null?void 0:s.key);return!!(f!=null&&f.isLoaded)}isChildrenLoaded(i){const s=i==null?void 0:i.children;return s.length===0?!0:s.every(f=>{const p=this.getTile(f==null?void 0:f.key);return p?(p==null?void 0:p.isLoaded)===!0:!0})}render(){var i=this;return(0,ln.Z)(function*(){const f=i.getRenderLayers().map(function(){var p=(0,ln.Z)(function*(y){yield i.layerService.renderTileLayer(y)});return function(y){return p.apply(this,arguments)}}());yield Promise.all(f)})()}getRenderLayers(){const i=this.layerTiles.filter(f=>f.visible&&f.isLoaded),s=[];return i.map(f=>s.push(...f.getLayers())),s}getLayers(){const i=this.layerTiles.filter(f=>f.isLoaded),s=[];return i.map(f=>s.push(...f.getLayers())),s}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(i=>i.destroy()),this.tileResource.clear()}}var _m=L(32676);function JC(a,i,s){s===void 0&&(s={});var f=Be(a),p=Be(i),y=_m.union(f.coordinates,p.coordinates);return y.length===0?null:y.length===1?ne(y[0],s.properties):Jt(y,s.properties)}var t4=JC;class bm{getCombineFeature(i){let s=null;const f=i[0];return i.map(p=>{const y=ne(p.coordinates);s===null?s=y:s=t4(s,y)}),f&&(s.properties=(0,on.Z)({},f)),s}}const fu="select",du="active";class e4{constructor({layerService:i,tileLayerService:s,parent:f}){(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"tileLayerService",void 0),(0,ot.Z)(this,"tileSourceService",void 0),(0,ot.Z)(this,"parent",void 0),(0,ot.Z)(this,"tilePickID",new Map),this.layerService=i,this.tileLayerService=s,this.parent=f,this.tileSourceService=new bm}pickRender(i){const s=this.tileLayerService.getVisibleTileBylngLat(i.lngLat);if(s){const f=s.getMainLayer();f==null||f.layerPickService.pickRender(i)}}pick(i,s){var f=this;return(0,ln.Z)(function*(){const y=f.parent.getContainer().pickingService;if(i.type==="RasterLayer"){const x=f.tileLayerService.getVisibleTileBylngLat(s.lngLat);if(x&&x.getMainLayer()!==void 0){const O=x.getMainLayer();return O.layerPickService.pickRasterLayer(O,s,f.parent)}return!1}return f.pickRender(s),y.pickFromPickingFBO(i,s)})()}selectFeature(i){const[s,f,p]=i,y=this.color2PickId(s,f,p);this.tilePickID.set(fu,y),this.updateHighLight(s,f,p,fu)}highlightPickedFeature(i){const[s,f,p]=i,y=this.color2PickId(s,f,p);this.tilePickID.set(du,y),this.updateHighLight(s,f,p,du)}updateHighLight(i,s,f,p){this.tileLayerService.tiles.map(y=>{const x=y.getMainLayer();switch(p){case fu:x==null||x.hooks.beforeSelect.call([i,s,f]);break;case du:x==null||x.hooks.beforeHighlight.call([i,s,f]);break}})}setPickState(){const i=this.tilePickID.get(fu),s=this.tilePickID.get(du);if(i){const[f,p,y]=this.pickId2Color(i);this.updateHighLight(f,p,y,fu);return}if(s){const[f,p,y]=this.pickId2Color(s);this.updateHighLight(f,p,y,du);return}}color2PickId(i,s,f){return dc(new Uint8Array([i,s,f]))}pickId2Color(i){return ul(i)}getFeatureById(i){const s=this.tileLayerService.getTiles().filter(p=>p.visible),f=[];return s.forEach(p=>{f.push(...p.getFeatureById(i))}),f}pickRasterLayer(){return!1}}const n4=`layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);

  if (v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur) / 2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if (fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if (fragmengTocenter > v_innerRadius - blurWidth) {
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);

  if (u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,J3=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function xm(a){const i=a.coordinates;return{vertices:[...i],indices:[0],size:i.length}}class r4 extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:i,strokeOpacity:s=1,strokeWidth:f=0,stroke:p="#fff"}=this.layer.getLayerConfig(),y={u_stroke_color:Gr(p),u_additive:i==="additive"?1:0,u_stroke_opacity:s,u_stroke_width:f};return this.getUniformsBufferInfo(y)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.layer.triangulation=xm,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:J3,fragmentShader:n4,defines:i.getDefines(),inject:i.getInject(),triangulation:xm,depth:{enable:!1},primitive:dt.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}const tS=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,eS=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:Ga}=hi;class nS extends si{constructor(...i){super(...i),(0,ot.Z)(this,"raiseCount",0),(0,ot.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:i={enable:!1,speed:.01,repeat:!1},opacity:s=1,sourceColor:f,targetColor:p,pickLight:y=!1,heightfixed:x=!0,opacityLinear:O={enable:!1,dir:"up"},lightEnable:A=!0}=this.layer.getLayerConfig();let I=0,B=[0,0,0,0],j=[0,0,0,0];if(f&&p&&(B=Gr(f),j=Gr(p),I=1),this.raiseCount<1&&this.raiseRepeat>0&&i.enable){const{speed:Bt=.01}=i;this.raiseCount+=Bt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const V={u_sourceColor:B,u_targetColor:j,u_linearColor:I,u_pickLight:Number(y),u_heightfixed:Number(x),u_r:i.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:Ga(s)?s:1,u_opacitylinear:Number(O.enable),u_opacitylinear_dir:O.dir==="up"?1:0,u_lightEnable:Number(A)};return this.getUniformsBufferInfo(V)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){const{animateOption:{repeat:s=1}}=i.layer.getLayerConfig();return i.raiseRepeat=s,[yield i.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:eS,fragmentShader:tS,triangulation:O3,depth:{enable:!0},defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:dt.FRONT},blend:i.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:i=>{const{size:s}=i;if(s){let f=[];return Array.isArray(s)&&(f=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(f=[s,s,s]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Nn.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:dt.STATIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Nn.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:i=>{const s=yc(i.coordinates);return Jv([s[0],s[1]])}}})}}const i4=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,o4=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class a4 extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:i=1,strokeWidth:s=0,blend:f,blur:p=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const y={u_additive:f==="additive"?1:0,u_stroke_opacity:i,u_stroke_width:s,u_blur:p};return this.getUniformsBufferInfo(y)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.layer.triangulation=$f,[yield i.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:o4,fragmentShader:i4,triangulation:$f,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!0},blend:i.getBlend()})]})()}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Nn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p)=>{const[y,x,O]=f,A=Tr.al(0,0,1),I=Tr.al(y,0,O),B=y>=0?Tr.EU(A,I):Math.PI*2-Tr.EU(A,I),j=Math.PI*2-Math.asin(x/100),V=Zr.create();Zr.rotateY(V,V,B),Zr.rotateX(V,V,j);const mt=Tr.al(1,1,0);Tr.fF(mt,mt,V),Tr.Fv(mt,mt);const Bt=Tr.al(-1,1,0);Tr.fF(Bt,Bt,V),Tr.Fv(Bt,Bt);const Kt=Tr.al(-1,-1,0);Tr.fF(Kt,Kt,V),Tr.Fv(Kt,Kt);const ue=Tr.al(1,-1,0);Tr.fF(ue,ue,V),Tr.Fv(ue,ue);const Le=[...mt,...Bt,...Kt,...ue],ke=p%4*3;return[Le[ke],Le[ke+1],Le[ke+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Nn.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{shape:s=2}=i;return[this.layer.getLayerConfig().shape2d.indexOf(s)]}}})}}const s4=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,rS=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.x = 1.0 - v_uv.x;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class iS extends si{constructor(...i){super(...i),(0,ot.Z)(this,"meter2coord",1),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"isMeter",!1),(0,ot.Z)(this,"radian",0),(0,ot.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=s({data:this.iconService.getCanvas(),mag:dt.LINEAR,min:dt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:i=0,heightfixed:s=!1,unit:f="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var p;(p=this.texture)===null||p===void 0||p.bind()}const y={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(s),u_raisingHeight:Number(i),u_size_unit:Bp[f]};return this.getUniformsBufferInfo(y)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),tl)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.iconService.on("imageUpdate",i.updateTexture),i.updateTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:rS,fragmentShader:s4,triangulation:tl,depth:{enable:!1},defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:dt.FRONT}})]})()}clearModels(){var i;this.iconService.off("imageUpdate",this.updateTexture),(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{shape:f}=i,{x:p,y}=s[f]||{x:-64,y:-64};return[p,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Nn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p)=>{const y=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],x=p%4*3;return[y[x],y[x+1],y[x+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}const oS=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,c4=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class aS extends si{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:i,speed:s=1,unit:f="pixel"}=this.layer.getLayerConfig(),p={u_additive:i==="additive"?1:0,u_size_unit:Bp[f],u_speed:s,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(p)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),tl)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:c4,fragmentShader:oS,triangulation:tl,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}})]})()}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Nn.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:3,update:(i,s,f,p)=>{const y=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],x=p%4*3;return[y[x],y[x+1],y[x+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Nn.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}var l4={fillImage:iS,fill:um,radar:aS,image:z3,normal:Yf,simplePoint:r4,extrude:j3,text:G3,earthFill:a4,earthExtrude:nS};class sS extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","PointLayer"),(0,ot.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,ot.Z)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,ot.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel&&i.layerModel.clearModels(),i.layerModel=new l4[s](i),yield i.initLayerModels()})()}rebuildModels(){var i=this;return(0,ln.Z)(function*(){yield i.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:i,values:s}=this.shapeOption,{shape2d:f}=this.getLayerConfig(),p=this.iconService.getIconMap();if(i&&(f==null?void 0:f.indexOf(i))!==-1)return"fill";if(s==="text")return"text";if(s&&s instanceof Array){for(const y of s)if(typeof y=="string"&&p.hasOwnProperty(y))return"image"}}return"normal"}getDefaultConfig(){const i=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[i]}getModelType(){const i=this.getEncodedData(),{shape2d:s,shape3d:f,billboard:p=!0}=this.getLayerConfig(),y=this.iconService.getIconMap(),x=i.find(O=>O.hasOwnProperty("shape"));if(x){const O=x.shape;return O==="dot"?"normal":O==="simple"?"simplePoint":O==="radar"?"radar":this.layerType==="fillImage"||p===!1?"fillImage":(s==null?void 0:s.indexOf(O))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(f==null?void 0:f.indexOf(O))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":y.hasOwnProperty(O)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function Sm(a){return a==="PolygonLayer"?Va:a==="LineLayer"?lm:sS}function wm(a){return["PolygonLayer","LineLayer"].indexOf(a)!==-1}class Qs extends No.EventEmitter{constructor(i,s){super(),(0,ot.Z)(this,"x",void 0),(0,ot.Z)(this,"y",void 0),(0,ot.Z)(this,"z",void 0),(0,ot.Z)(this,"key",void 0),(0,ot.Z)(this,"parent",void 0),(0,ot.Z)(this,"sourceTile",void 0),(0,ot.Z)(this,"visible",!0),(0,ot.Z)(this,"layers",[]),(0,ot.Z)(this,"isLoaded",!1),(0,ot.Z)(this,"tileMaskLayers",[]),(0,ot.Z)(this,"tileMask",void 0),this.parent=s,this.sourceTile=i,this.x=i.x,this.y=i.y,this.z=i.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...i){}lnglatInBounds(i){const[s,f,p,y]=this.sourceTile.bounds,{lng:x,lat:O}=i;return x>=s&&x<=p&&O>=f&&O<=y}getLayerOptions(){var i;const s=this.parent.getLayerConfig();return(0,on.Z)((0,on.Z)({},s),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:wm(this.parent.type),mask:s.mask||((i=s.maskLayers)===null||i===void 0?void 0:i.length)!==0&&s.enableMask})}getMaskLayer(){const{maskLayers:i}=this.parent.getLayerConfig(),s=[];return i==null||i.forEach(f=>{if(!f.tileLayer)return s.push(f),f;const y=f.tileLayer.getTile(this.sourceTile.key),x=y==null?void 0:y.getLayers()[0];x&&s.push(x)}),s}addTileMask(){var i=this;return(0,ln.Z)(function*(){const s=new Va({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[i.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),f=Dl(i.parent.container);s.setContainer(f),yield s.init(),i.tileMask=s;const p=i.getMainLayer();return p!==void 0&&(p.tileMask=s),s})()}addMask(i,s){var f=this;return(0,ln.Z)(function*(){const p=Dl(f.parent.container);s.setContainer(p),yield s.init(),i.addMask(s),f.tileMaskLayers.push(s)})()}addLayer(i){var s=this;return(0,ln.Z)(function*(){i.isTileLayer=!0;const f=Dl(s.parent.container);i.setContainer(f),s.layers.push(i),yield i.init()})()}updateVisible(i){this.visible=i,this.updateOptions("visible",i)}updateOptions(i,s){this.layers.forEach(f=>{f.updateLayerConfig({[i]:s})})}getMainLayer(){return this.layers[0]}getFeatures(i){return[]}getFeatureById(i){return[]}destroy(){var i;(i=this.tileMask)===null||i===void 0||i.destroy(),this.layers.forEach(s=>s.destroy())}}class Om extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.getSourceOption(),f=s.data.features[0].properties,p=new lm().source(s.data,s.options).size(1).shape("line").color("red"),y=new sS({minZoom:i.z-1,maxZoom:i.z+1,textAllowOverlap:!0}).source([f],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(i.key).style({stroke:"#fff",strokeWidth:2});yield i.addLayer(p),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:i.transforms}}}}const cS=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,lS=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class uS extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:i,brightness:s,contrast:f,saturation:p,gamma:y}=this.layer.getLayerConfig(),x={u_opacity:pl(i,1),u_brightness:pl(s,1),u_contrast:pl(f,1),u_saturation:pl(p,1),u_gamma:pl(y,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(x)}initModels(){var i=this;return(0,ln.Z)(function*(){return yield i.loadTexture(),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}loadTexture(){var i=this;return(0,ln.Z)(function*(){const{createTexture2D:s}=i.rendererService,p=yield i.layer.getSource().data.images;i.texture=s({data:p[0],width:p[0].width,height:p[0].height,mag:dt.LINEAR,min:dt.LINEAR})})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:lS,fragmentShader:cS,defines:i.getDefines(),triangulation:Fp,primitive:dt.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}var f4={image:uS};class d4 extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","ImageLayer")}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel=new f4[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{image:{}}[i]}getModelType(){return"image"}}class h4 extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=i.getSourceOption(),y=new d4((0,on.Z)({},f)).source(p.data,p.options);s&&Object.keys(s).forEach(x=>{var O,A;const I=x;y[I]((O=s[I])===null||O===void 0?void 0:O.field,(A=s[I])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}const fS=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,Em=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class p4 extends si{getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,color:s="#000"}=this.layer.getLayerConfig(),f={u_color:Gr(s),u_opacity:i||1};return this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"mask",vertexShader:Em,fragmentShader:fS,defines:i.getDefines(),triangulation:el,depth:{enable:!1},pick:!1})]})()}clearModels(i=!0){i&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var g4={fill:p4};class dS extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","MaskLayer")}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel=new g4[s](i),yield i.initLayerModels()})()}getModelType(){return"fill"}}class v4 extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=i.getSourceOption(),y=new dS((0,on.Z)({},f)).source(p.data,p.options);s&&Object.keys(s).forEach(x=>{var O,A;const I=x;y[I]((O=s[I])===null||O===void 0?void 0:O.field,(A=s[I])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getFeatures(i){return i?this.sourceTile.data.getTileData(i):[]}getSourceOption(){const i=this.parent.getSource(),{sourceLayer:s,featureId:f}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(s)},options:{parser:{type:"geojson",featureId:f},transforms:i.transforms}}}}function m4(a,i){return{type:a.type,field:"value",items:a.positions.map((s,f)=>({[i]:f>=a.colors.length?null:a.colors[f],value:s}))}}const y4=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) {
  return x > 0.0 || x < 0.0
    ? x != x
    : x != 0.0;
}

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if (u_clampLow < 0.5 && value < u_domain[0] || u_clampHigh < 0.5 && value > u_domain[1]) {
    discard;
  } else {
    float normalisedValue = (value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));

    outputColor = color;
    outputColor.a = outputColor.a * u_opacity;
    if (outputColor.a < 0.01) discard;
  }
}
`,_4=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class hS extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,clampLow:s=!0,clampHigh:f=!0,noDataValue:p=-9999999,domain:y,rampColors:x}=this.layer.getLayerConfig(),O=y||Ad(x);this.colorTexture=this.layer.textureService.getColorTexture(x,O);const A={u_domain:O,u_opacity:i||1,u_noDataValue:p,u_clampLow:s?1:0,u_clampHigh:(typeof f!="undefined"?f:s)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(A)}getRasterData(i){return(0,ln.Z)(function*(){if(Array.isArray(i.data))return{data:i.data,width:i.width,height:i.height};{const{rasterData:s,width:f,height:p}=yield i.data;return{data:Array.from(s),width:f,height:p}}})()}initModels(){var i=this;return(0,ln.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,ln.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f,queryVerdorInfo:p}=i.rendererService,y=s.data.dataArray[0],{data:x,width:O,height:A}=yield i.getRasterData(y);return i.texture=f({data:new Float32Array(x),width:O,height:A,format:p()==="WebGL1"?dt.LUMINANCE:dt.RED,type:dt.FLOAT,alignment:1}),[yield i.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:_4,fragmentShader:y4,defines:i.getDefines(),triangulation:Fp,primitive:dt.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.colorTexture)===null||s===void 0||s.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}const b4=["data"],x4=["rasterData"],S4=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {
  vec3 rgb = texture(SAMPLER_2D(u_texture), vec2(v_texCoord.x, v_texCoord.y)).rgb;

  if (rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(
      rgb.r / (u_rminmax.y - u_rminmax.x),
      rgb.g / (u_gminmax.y - u_gminmax.x),
      rgb.b / (u_bminmax.y - u_bminmax.x),
      u_opacity
    );
  }

  if (outputColor.a < 0.01) discard;

}
`,w4=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class O4 extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0),(0,ot.Z)(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,on.Z)((0,on.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,noDataValue:s=0}=this.layer.getLayerConfig(),{rMinMax:f=[0,255],gMinMax:p=[0,255],bMinMax:y=[0,255]}=this.dataOption,x={u_rminmax:f,u_gminmax:p,u_bminmax:y,u_opacity:i||1,u_noDataValue:s,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(x)}getRasterData(i){var s=this;return(0,ln.Z)(function*(){if(Array.isArray(i.data)){const{data:x}=i,O=(0,jo.Z)(i,b4);return s.dataOption=O,(0,on.Z)({data:x},O)}const f=yield i.data,{rasterData:p}=f,y=(0,jo.Z)(f,x4);return s.dataOption=y,Array.isArray(p)?(0,on.Z)({data:p},y):(0,on.Z)({data:Array.from(p)},y)})()}initModels(){var i=this;return(0,ln.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f}=i.rendererService,p=s.data.dataArray[0],{data:y,width:x,height:O}=yield i.getRasterData(p);return i.texture=f({data:new Float32Array(y),width:x,height:O,format:dt.RGB,type:dt.FLOAT}),[yield i.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:w4,fragmentShader:S4,defines:i.getDefines(),triangulation:Fp,primitive:dt.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}const E4=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;

float getElevation(vec2 coord, float bias) {
  // Convert encoded elevation value to meters
  vec4 data = texture(SAMPLER_2D(u_texture), coord, bias) * 255.0;
  data.a = -1.0;
  return dot(data, u_unpack);
}

vec4 getColor(float value) {
  float normalisedValue = (value - u_domain[0]) / (u_domain[1] - u_domain[0]);
  vec2 coord = vec2(normalisedValue, 0);
  return texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord, 0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if (u_clampLow < 0.5 && value < u_domain[0] || u_clampHigh < 0.5 && value > u_domain[1]) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = getColor(value);
    outputColor.a = outputColor.a * u_opacity;
    if (outputColor.a < 0.01) discard;
  }
}
`,A4=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Up extends si{constructor(...i){super(...i),(0,ot.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:i,clampLow:s=!0,clampHigh:f=!0,noDataValue:p=-9999999,domain:y,rampColors:x,colorTexture:O,rScaler:A=6553.6,gScaler:I=25.6,bScaler:B=.1,offset:j=1e4}=this.layer.getLayerConfig(),V=y||Ad(x);let mt=O;O?this.layer.textureService.setColorTexture(O,x,V):mt=this.layer.textureService.getColorTexture(x,V);const Bt={u_unpack:[A,I,B,j],u_domain:V,u_opacity:i||1,u_noDataValue:p,u_clampLow:s,u_clampHigh:typeof f!="undefined"?f:s,u_texture:this.texture,u_colorTexture:mt};return this.textures=[this.texture,mt],this.getUniformsBufferInfo(Bt)}initModels(){var i=this;return(0,ln.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f}=i.rendererService,p=yield s.data.images;return i.texture=f({data:p[0],width:p[0].width,height:p[0].height,min:dt.LINEAR,mag:dt.LINEAR}),[yield i.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:A4,fragmentShader:E4,defines:i.getDefines(),triangulation:Fp,primitive:dt.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}buildModels(){var i=this;return(0,ln.Z)(function*(){return i.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Nn.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:dt.DYNAMIC_DRAW,data:[],type:dt.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}var pS={raster:hS,rasterRgb:O4,raster3d:hS,rasterTerrainRgb:Up};class Am extends au{constructor(...i){super(...i),(0,ot.Z)(this,"type","RasterLayer")}buildModels(){var i=this;return(0,ln.Z)(function*(){const s=i.getModelType();i.layerModel=new pS[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[i]}getModelType(){switch(this.layerSource.getParserType()){case"raster":case"ndi":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(i){if(i!=="color")return{type:void 0,field:void 0,items:[]};const s=this.getLayerConfig().rampColors;return m4(s,i)}}const M4=["rasterData"];class C4 extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=i.getSourceOption(),y=new Am((0,on.Z)({},f)).source(p.data,p.options);s&&Object.keys(s).forEach(x=>{var O,A;const I=x;y[I]((O=s[I])===null||O===void 0?void 0:O.field,(A=s[I])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource(),s=this.sourceTile.data.data,{rasterData:f}=s,p=(0,jo.Z)(s,M4);return{data:f,options:{parser:(0,on.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},p),transforms:i.transforms}}}}class Zp extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=i.getSourceOption(),y=new Am((0,on.Z)({},f)).source(p.data,p.options);s&&Object.keys(s).forEach(x=>{var O,A;const I=x;y[I]((O=s[I])===null||O===void 0?void 0:O.field,(A=s[I])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}const P4=["rasterData"],Tm={positions:[0,1],colors:["#000","#fff"]};class L4 extends Qs{constructor(...i){super(...i),(0,ot.Z)(this,"colorTexture",void 0)}initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=i.getSourceOption(),{rampColors:y,domain:x}=i.getLayerOptions();i.colorTexture=i.parent.textureService.getColorTexture(y,x);const O=new Am((0,on.Z)((0,on.Z)({},f),{},{colorTexture:i.colorTexture})).source(p.data,p.options);s&&Object.keys(s).forEach(A=>{var I,B;const j=A;O[j]((I=s[j])===null||I===void 0?void 0:I.field,(B=s[j])===null||B===void 0?void 0:B.values)}),yield i.addLayer(O),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource(),s=this.sourceTile.data.data,{rasterData:f}=s,p=(0,jo.Z)(s,P4);return{data:f,options:{parser:(0,on.Z)({type:"raster",extent:this.sourceTile.bounds},p),transforms:i.transforms}}}styleUpdate(...i){const{rampColors:s=Tm,domain:f}=i;this.colorTexture=this.parent.textureService.getColorTexture(s,f||Ad(s)),this.layers.forEach(p=>p.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(i=>i.destroy())}}class Hp extends Qs{initTileLayer(){var i=this;return(0,ln.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),p=Sm(i.parent.type),y=i.getSourceOption();if(!y){i.isLoaded=!0,i.emit("loaded");return}const x=new p((0,on.Z)({},f)).source(y.data,y.options);Object.keys(s).forEach(O=>{var A,I;const B=O;x[B]((A=s[B])===null||A===void 0?void 0:A.field,(I=s[B])===null||I===void 0?void 0:I.values)}),yield i.addLayer(x),f.tileMask&&(yield i.addTileMask()),i.setLayerMinMaxZoom(x),i.isLoaded=!0,i.emit("loaded")})()}getSourceOption(){const i=this.parent.getSource(),{sourceLayer:s="defaultLayer",featureId:f="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(s)},options:{parser:{type:"geojson",featureId:f},transforms:i.transforms}}}setLayerMinMaxZoom(i){i.getModelType()==="text"&&i.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(i){return this.sourceTile.data.getTileData(i)}getFeatureById(i){const s=this.getMainLayer();return s?s.getSource().data.dataArray.filter(p=>p._id===i):[]}}function I4(a){switch(a.type){case"PolygonLayer":return Hp;case"LineLayer":return Hp;case"PointLayer":return Hp;case"TileDebugLayer":return Om;case"MaskLayer":return v4;case"RasterLayer":const{dataType:s}=a.getSource().parser;switch(s){case co.RGB:case co.CUSTOMRGB:return C4;case co.ARRAYBUFFER:case co.CUSTOMARRAYBUFFER:return L4;case co.TERRAINRGB:case co.CUSTOMTERRAINRGB:return Zp;default:return h4}default:return Hp}}const R4=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:k4}=hi;class D4{constructor(i){(0,ot.Z)(this,"parent",void 0),(0,ot.Z)(this,"tileLayerService",void 0),(0,ot.Z)(this,"mapService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"rendererService",void 0),(0,ot.Z)(this,"pickingService",void 0),(0,ot.Z)(this,"tilePickService",void 0),(0,ot.Z)(this,"tilesetManager",void 0),(0,ot.Z)(this,"initedTileset",!1),(0,ot.Z)(this,"lastViewStates",void 0),(0,ot.Z)(this,"mapchange",()=>{var f;if(this.parent.isVisible()===!1)return;const{latLonBounds:p,zoom:y}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===y&&this.lastViewStates.latLonBounds.toString()===p.toString()||(this.lastViewStates={zoom:y,latLonBounds:p},(f=this.tilesetManager)===null||f===void 0||f.throttleUpdate(y,p))}),(0,ot.Z)(this,"viewchange",k4(this.mapchange,24)),this.parent=i;const s=this.parent.getContainer();this.rendererService=s.rendererService,this.layerService=s.layerService,this.mapService=s.mapService,this.pickingService=s.pickingService,this.tileLayerService=new ym({rendererService:this.rendererService,layerService:this.layerService,parent:i}),this.tilePickService=new e4({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:i}),this.parent.setLayerPickService(this.tilePickService),this.proxy(i),this.initTileSetManager()}initTileSetManager(){var i;const s=this.parent.getSource();if(this.tilesetManager=s.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:f,zoom:p}=this.getCurrentView();(i=this.tilesetManager)===null||i===void 0||i.update(p,f)}getCurrentView(){const i=this.mapService.getBounds(),s=[i[0][0],i[0][1],i[1][0],i[1][1]],f=this.mapService.getZoom();return{latLonBounds:s,zoom:f}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",i=>{}),this.tilesetManager.on("tile-unload",i=>{this.tileUnLoad(i)}),this.tilesetManager.on("tile-error",(i,s)=>{this.tileError(i)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(i){return this.tileLayerService.getTile(i)}tileLoaded(i){}tileError(i){console.warn("error:",i)}destroy(){var i;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(i=this.tilesetManager)===null||i===void 0||i.destroy(),this.tileLayerService.destroy()}reload(){var i;this.tilesetManager.clear();const{latLonBounds:s,zoom:f}=this.getCurrentView();(i=this.tilesetManager)===null||i===void 0||i.update(f,s)}tileUnLoad(i){this.tileLayerService.removeTile(i.key)}tileUpdate(){var i=this;return(0,ln.Z)(function*(){if(!i.tilesetManager)return;const s=i.parent.getMinZoom(),f=i.parent.getMaxZoom(),p=i.tilesetManager.tiles.filter(y=>y.isLoaded).filter(y=>y.isVisibleChange).filter(y=>y.data).filter(y=>y.z>=s&&y.z<f);yield Promise.all(p.map(function(){var y=(0,ln.Z)(function*(x){if(i.tileLayerService.hasTile(x.key))i.tileLayerService.updateTileVisible(x),i.tilePickService.setPickState(),i.layerService.reRender();else{const O=I4(i.parent),A=new O(x,i.parent);yield A.initTileLayer(),i.tilePickService.setPickState(),A.getLayers().length!==0&&(i.tileLayerService.addTile(A),i.tileLayerService.updateTileVisible(x),i.layerService.reRender())}});return function(x){return y.apply(this,arguments)}}())),i.tilesetManager.isLoaded&&i.parent.emit("tiles-loaded",i.tilesetManager.currentTiles)})()}setPickState(i){}pickRender(i){this.tilePickService.pickRender(i)}selectFeature(i){this.tilePickService.selectFeature(i)}highlightPickedFeature(i){this.tilePickService.highlightPickedFeature(i)}proxy(i){R4.forEach(s=>{const f=i[s].bind(i);i[s]=(...p)=>(f(...p),this.getLayers().map(y=>{y[s](...p)}),s==="style"&&this.getTiles().forEach(y=>y.styleUpdate(...p)),i)})}}class Wp extends null{constructor(...i){super(...i),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",s=>{switch(s.stopPropagation(),s.type){case"touchcancel":case"touchend":case"mouseup":{var f;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(p=>{document.removeEventListener(p,this.move)}),(f=this.scene)===null||f===void 0||f.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(p=>{document.addEventListener(p,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let p;if("pageX"in s?p=s.pageX:s.touches&&s.touches.length&&s.touches[0].pageX?p=s.touches[0].pageX:s.changedTouches&&s.changedTouches.length&&(p=s.changedTouches[0].pageX),!p)break;const y=this.getContainerDOMRect(),x=this.getContainerSize(),O=x[0],A=(y==null?void 0:y.left)||0,I=p-A+window.scrollX-document.documentElement.clientLeft,B=O-Math.min(Math.max(0,O-I),O),j=B/O;this.setOptions({ratio:j}),this.emit("moving",{size:[B,x[1]],ratio:[j,0]})}else{let p;if("pageY"in s?p=s.pageY:s.touches&&s.touches.length&&s.touches[0].pageY?p=s.touches[0].pageY:s.changedTouches&&s.changedTouches.length&&(p=s.changedTouches[0].pageY),!p)break;const y=this.getContainerDOMRect(),x=this.getContainerSize(),O=x[1],A=(y==null?void 0:y.top)||0,I=p-A+window.scrollY-document.documentElement.clientTop,B=O-Math.min(Math.max(0,O-I),O),j=B/O;this.setOptions({ratio:j}),this.emit("moving",{size:[x[0],B],ratio:[0,j]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var s;if(!this.mapsService)return;const f=this.getMaskGeoData();(s=this.maskLayer)===null||s===void 0||s.setData(f)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const i=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",i);const{orientation:s="vertical",ratio:f=.5}=this.controlOption;return s==="horizontal"?(i.style.top=f*100+"%",i.style.left=""):(i.style.left=f*100+"%",i.style.top=""),i.classList.add(s),i}addTo(i){this.mapsService=i.mapService,this.renderService=i.rendererService,this.layerService=i.layerService,this.controlService=i.controlService,this.configService=i.globalConfigService,this.scene=i.sceneService,this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd();const{className:s,style:f,layers:p,rightLayers:y}=this.controlOption;s&&this.setClassName(s),f&&this.setStyle(f),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const x=createLayerContainer(i);return this.maskLayer.setContainer(x),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(p,!1),this.addMaskToLayers(y,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var i;const{layers:s,rightLayers:f}=this.controlOption;this.removeMaskFromLayers(s),this.removeMaskFromLayers(f),(i=this.layerService)===null||i===void 0||i.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var i;const s=this.container;DOM.removeClass(s,"l7-control-swipe_hide");const{layers:f,rightLayers:p}=this.controlOption;f.forEach(y=>y.enableMask()),p.forEach(y=>y.enableMask()),(i=this.scene)===null||i===void 0||i.render(),this.isShow=!0,this.emit("show",this)}hide(){var i;const s=this.container;DOM.addClass(s,"l7-control-swipe_hide");const{layers:f,rightLayers:p}=this.controlOption;f.forEach(y=>y.disableMask()),p.forEach(y=>y.disableMask()),(i=this.scene)===null||i===void 0||i.render(),this.isShow=!1,this.emit("hide",this)}setOptions(i){const s=_objectSpread(_objectSpread({},this.controlOption),i);if(i.className&&this.setClassName(i.className),i.style&&this.setStyle(i.style),(i.orientation||i.ratio!==void 0)&&this.setOrientationAndRatio(s.orientation,s.ratio),i.layers){const f=i.layers,p=this.controlOption.layers;this.setLayers(f,p,!1)}if(i.rightLayers){const f=i.rightLayers,p=this.controlOption.rightLayers;this.setLayers(f,p,!0)}this.controlOption=s,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var i;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(i=this.mapsService)===null||i===void 0||i.off("camerachange",this.updateMask)}setOrientationAndRatio(i="vertical",s=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(i),i==="horizontal"?(this.container.style.top=s*100+"%",this.container.style.left=""):(this.container.style.left=s*100+"%",this.container.style.top="")}setLayers(i,s,f=!1){const p=i.filter(x=>s.includes(x)===!1),y=s.filter(x=>i.includes(x)===!1);this.addMaskToLayers(p,f),this.removeMaskFromLayers(y)}addMaskToLayers(i,s){i.forEach(f=>{f.updateLayerConfig({maskInside:!s}),f.addMask(this.maskLayer)})}removeMaskFromLayers(i){i.forEach(s=>{s.updateLayerConfig({maskInside:!0}),s.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:i=.5,orientation:s="vertical"}=this.controlOption,f=s==="vertical",[p,y]=this.getBounds(),[x,O]=p,[A,I]=y;let B;if(f){const V=x+(A-x)*i;B=[[x,I],[V,I],[V,O],p,[x,I]]}else{const V=this.getContainerSize(),Bt=this.mapsService.containerToLngLat([V[0],V[1]*i]).lat;B=[[x,I],y,[A,Bt],[x,Bt],[x,I]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[B]}}]}}getContainerDOMRect(){var i;return(i=this.mapsService.getContainer())===null||i===void 0?void 0:i.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(i,s=!1){const f=Array.isArray(i)?i:[i];if(s){const p=this.controlOption.rightLayers.concat(...f);this.setOptions({rightLayers:p})}else{const p=this.controlOption.layers.concat(...f);this.setOptions({layers:p})}}removeLayer(i){const s=Array.isArray(i)?i:[i],f=this.controlOption.layers.filter(y=>s.includes(y)),p=this.controlOption.rightLayers.filter(y=>s.includes(y));this.setOptions({layers:f,rightLayers:p})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class N4 extends null{constructor(...i){super(...i),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const s=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||s.getZoom()<=s.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(s.getZoom()))),(this.disabled||s.getZoom()>=s.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const i=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(i),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),i}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(i){DOM.clearChildren(i),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",i,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",i)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",i,this.zoomOut),this.updateDisabled()}createButton(i,s,f,p,y){const x=DOM.create("button",f,p);return typeof i=="string"?x.innerHTML=i:x.append(i),x.title=s,y&&x.addEventListener("click",y),x}}class Jf extends No.EventEmitter{get lngLat(){var i;return(i=this.popupOption.lngLat)!==null&&i!==void 0?i:{lng:0,lat:0}}set lngLat(i){this.popupOption.lngLat=i}constructor(i){super(),(0,ot.Z)(this,"popupOption",void 0),(0,ot.Z)(this,"mapsService",void 0),(0,ot.Z)(this,"sceneService",void 0),(0,ot.Z)(this,"layerService",void 0),(0,ot.Z)(this,"scene",void 0),(0,ot.Z)(this,"closeButton",void 0),(0,ot.Z)(this,"container",void 0),(0,ot.Z)(this,"content",void 0),(0,ot.Z)(this,"contentTitle",void 0),(0,ot.Z)(this,"contentPanel",void 0),(0,ot.Z)(this,"tip",void 0),(0,ot.Z)(this,"isShow",!0),(0,ot.Z)(this,"onMouseMove",f=>{var p;const y=this.mapsService.getMapContainer(),{left:x=0,top:O=0}=(p=y==null?void 0:y.getBoundingClientRect())!==null&&p!==void 0?p:{};this.setPopupPosition(f.clientX-x,f.clientY-O)}),(0,ot.Z)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:f,lat:p}=this.lngLat,{x:y,y:x}=this.mapsService.lngLatToContainer([f,p]);this.setPopupPosition(y,x)}),(0,ot.Z)(this,"updateLngLatPositionWhenZoom",f=>{if(!this.mapsService||this.popupOption.followCursor)return;const p=f.map,y=p.getSize();y.x=y.x/2,y.y=y.y/2;const x=f.center,O=f.zoom,A=p.DE(this.lngLat,O,x);A.x=Math.round(A.x),A.y=Math.round(A.y),this.setPopupPosition(A.x,A.y,!0)}),(0,ot.Z)(this,"onKeyDown",f=>{f.keyCode===27&&this.remove()}),(0,ot.Z)(this,"onCloseButtonClick",f=>{f.stopPropagation&&f.stopPropagation(),this.hide()}),(0,ot.Z)(this,"updatePosition",(f,p=!0)=>{const y=!!this.lngLat,{className:x,style:O,maxWidth:A,anchor:I,stopPropagation:B}=this.popupOption;if(!this.mapsService||!y||!this.content)return;const j=this.mapsService.getMarkerContainer();if(!this.container&&j&&(this.container=Vi("div",`l7-popup ${x!=null?x:""} ${this.isShow?"":"l7-popup-hide"}`,j),O&&this.container.setAttribute("style",O),this.tip=Vi("div","l7-popup-tip",this.container),this.container.appendChild(this.content),B&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(V=>{this.container.addEventListener(V,mt=>{mt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),p?this.updateLngLatPositionWhenZoom(f):this.updateLngLatPosition(),M1(this.container,`${Ie[I]}`),je(this.container,I,"popup"),A){const{width:V}=this.container.getBoundingClientRect();V>parseFloat(A)&&(this.container.style.width=A)}else this.container.style.removeProperty("width")}),(0,ot.Z)(this,"updateWhenZoom",f=>{this.updatePosition(f,!0)}),(0,ot.Z)(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=(0,on.Z)((0,on.Z)({},this.getDefault(i!=null?i:{})),i);const{lngLat:s}=this.popupOption;s&&(this.lngLat=s)}getIsShow(){return this.isShow}addTo(i){this.mapsService=i.mapService,this.sceneService=i.sceneService,this.layerService=i.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=i,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:s,text:f,title:p}=this.popupOption;return s?this.setHTML(s):f&&this.setText(f),p&&this.setTitle(p),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Oa(this.content),this.container&&(Oa(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(i){this.show();const{className:s}=this.popupOption;if(this.popupOption=(0,on.Z)((0,on.Z)({},this.popupOption),i),this.checkUpdateOption(i,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(Oa(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(i,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(i,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(i,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(i,["html"])&&i.html?this.setHTML(i.html):this.checkUpdateOption(i,["text"])&&i.text&&this.setText(i.text),this.checkUpdateOption(i,["className"])){var f;s&&this.container.classList.remove(s!=null?s:""),this.container.classList.add((f=i.className)!==null&&f!==void 0?f:"")}if(this.checkUpdateOption(i,["style"])){var p;z0(this.container,(p=i.style)!==null&&p!==void 0?p:"")}return this.checkUpdateOption(i,["lngLat"])&&i.lngLat&&this.setLnglat(i.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&hc(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&Ea(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(i){return this.popupOption.html=i,this.setDOMContent(i)}setText(i){return this.popupOption.text=i,this.setDOMContent(window.document.createTextNode(i))}setTitle(i){this.show(),this.popupOption.title=i,i?(this.contentTitle||(this.contentTitle=Vi("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),hl(this.contentTitle),Zu(this.contentTitle,i)):this.contentTitle&&(Oa(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:i,lat:s}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([i,s]),this}setLngLat(i){return this.setLnglat(i)}setLnglat(i){return this.show(),this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(i){return this.popupOption.maxWidth=i,this.update(),this}isOpen(){return!!this.mapsService}getDefault(i){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:pe.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(i){return this.show(),this.createContent(),Zu(this.contentPanel,i),this.update(),this}updateCloseOnClick(i){const s=this.mapsService;s&&(s==null||s.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!i&&requestAnimationFrame(()=>{s==null||s.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(i){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!i&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(i){var s;const f=(s=this.mapsService)===null||s===void 0?void 0:s.getContainer();f&&(f==null||f.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!i&&(f==null||f.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&Oa(this.content),this.contentTitle=void 0,this.content=Vi("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const i=lv("l7-icon-guanbi");Ea(i,"l7-popup-close-button"),this.content.appendChild(i),this.popupOption.closeButtonOffsets&&(i.style.right=this.popupOption.closeButtonOffsets[0]+"px",i.style.top=this.popupOption.closeButtonOffsets[1]+"px"),i.setAttribute("aria-label","Close popup"),i.addEventListener("click",()=>{this.hide()}),i.addEventListener("pointerup",s=>{s.stopPropagation()}),i.addEventListener("pointerdown",s=>{s.stopPropagation()}),this.closeButton=i}else this.closeButton=void 0;this.contentPanel=Vi("div","l7-popup-content__panel",this.content)}setPopupPosition(i,s,f=!1){if(this.container){const{offsets:p}=this.popupOption;this.container.style.left=i+p[0]+"px",this.container.style.top=s-p[1]+"px",f?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(i,s){return s.some(f=>f in i)}}const{get:F4}=hi;class s8 extends null{constructor(...i){super(...i),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(s,f)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(s,f.featureId))this.hide();else{const{title:p,content:y}=this.getLayerInfoFrag(s,f);this.setDOMContent(y),this.setLnglat(f.lngLat),this.setTitle(p),this.setDisplayFeatureInfo({layer:s,featureId:f.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var i;const{config:s,items:f}=this.popupOption;return(i=s!=null?s:f)!==null&&i!==void 0?i:[]}getActualTriggerEvent(){const{trigger:i}=this.popupOption;return i==="click"?isPC()?"click":"touchend":i}addTo(i){return super.addTo(i),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(i){this.unbindLayerEvent();const s=_objectSpread({},i),f=s.trigger||this.popupOption.trigger,p=s.items||this.popupOption.items,y=(p==null?void 0:p.length)===0;s.followCursor=f==="hover"&&!y;const x=this.isShow;return super.setOptions(s),this.bindLayerEvent(),(y||!x)&&this.hide(),this}getDefault(i){const s=i.trigger==="hover";return _objectSpread(_objectSpread({},super.getDefault(i)),{},{trigger:"hover",followCursor:s,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:i,closeOnClick:s}=this.popupOption,f=this.getActualTriggerEvent();this.layerConfigItems.forEach(p=>{var y;const x=this.getLayerByConfig(p);if(!x)return;const O=_objectSpread({},p);if(i==="hover"){const j=this.onLayerMouseMove.bind(this,x),V=this.onLayerMouseOut.bind(this,x);O.onMouseMove=j,O.onMouseOut=V,x==null||x.on("mousemove",j),x==null||x.on("mouseout",V)}else{var A;const j=this.onLayerClick.bind(this,x);O.onClick=j,x==null||x.on(f,j);const V=(A=this.mapsService)===null||A===void 0?void 0:A.getMapContainer();V&&s&&V.addEventListener(f,this.onSceneClick)}const I=x==null||(y=x.getSource)===null||y===void 0?void 0:y.call(x),B=this.onSourceUpdate.bind(this);I==null||I.on("update",B),O.onSourceUpdate=B,this.layerConfigMap.set(x,O)})}unbindLayerEvent(){const i=this.getActualTriggerEvent();this.layerConfigItems.forEach(s=>{var f;const p=this.getLayerByConfig(s),y=p&&this.layerConfigMap.get(p);if(!y)return;const{onMouseMove:x,onMouseOut:O,onClick:A,onSourceUpdate:I}=y;if(x&&p.off("mousemove",x),O&&p.off("mouseout",O),A&&p.off(i,A),I){var B;p==null||(B=p.getSource())===null||B===void 0||B.off("update",I)}const j=(f=this.mapsService)===null||f===void 0?void 0:f.getMapContainer();j&&j.removeEventListener(i,this.onSceneClick)})}onLayerMouseMove(i,s){if(!this.isSameFeature(i,s.featureId)){const{title:f,content:p}=this.getLayerInfoFrag(i,s);this.setDOMContent(p),this.setTitle(f),this.setDisplayFeatureInfo({layer:i,featureId:s.featureId}),this.show()}}onLayerMouseOut(i){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(i,s){const f=this.layerConfigMap.get(i);let p;const y=document.createDocumentFragment();if(f){let x=s.feature;x.type==="Feature"&&"properties"in x&&"geometry"in x&&(x=x.properties);const{title:O,fields:A,customContent:I}=f;if(O){p=document.createDocumentFragment();const B=O instanceof Function?O(x):O;DOM.appendElementType(p,B)}if(I){const B=I instanceof Function?I(x):I;DOM.appendElementType(y,B)}else A!=null&&A.length&&(A==null||A.forEach(B=>{var j,V;const{field:mt,formatField:Bt,formatValue:Kt,getValue:ue}=typeof B=="string"?{field:B}:B,Le=DOM.create("div","l7-layer-popup__row"),ke=ue?ue(s.feature):F4(x,mt),He=(j=Bt instanceof Function?Bt(mt,x):Bt)!==null&&j!==void 0?j:mt;let Ye=(V=Kt instanceof Function?Kt(ke,x):Kt)!==null&&V!==void 0?V:ke;const rn=DOM.create("span","l7-layer-popup__key",Le);DOM.appendElementType(rn,He),DOM.appendElementType(rn,document.createTextNode("\uFF1A"));const bn=DOM.create("span","l7-layer-popup__value",Le);Array.isArray(Ye)&&Ye.every(hn=>!(hn instanceof Object))&&(Ye=Ye.map(hn=>String(hn)).join(",")),DOM.appendElementType(bn,Ye),y.appendChild(Le)}))}return{title:p,content:y}}getLayerByConfig(i){const s=i.layer;if(s instanceof Object)return s;if(typeof s=="string")return this.layerService.getLayer(s)||this.layerService.getLayerByName(s)}isSameFeature(i,s){const f=this.displayFeatureInfo;return f&&i===f.layer&&s===f.featureId}setDisplayFeatureInfo(i){const s=this.displayFeatureInfo;s&&s.layer.off("hide",this.onLayerHide),i&&i.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=i}}function B4(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var p=i.head||i.getElementsByTagName("head")[0];if(!p){p=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(p,y):i.documentElement.appendChild(p)}var x=i.createElement("style");return x.type="text/css",x.styleSheet?x.styleSheet.cssText=a:x.appendChild(i.createTextNode(a)),p.appendChild(x),x}}B4(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgb(181 226 140 / 60%);
  background-clip: padding-box;
  border-radius: 20px;
}

.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgb(110 204 57 / 60%);
  border-radius: 15px;
}

.l7-marker-cluster span {
  line-height: 30px;
}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}

.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgb(0 0 0 / 20%);
}

.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}

.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}

.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}

.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblepainted;

  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}

.l7-control-container .l7-control.l7-control--hide {
  display: none;
}

.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}

.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}

.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}

.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}

.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}

.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}

.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}

.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}

.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}

.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}

.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}

.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}

.l7-control-container .l7-row {
  flex-direction: row;
}

.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}

.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}

.l7-control-container .l7-column {
  flex-direction: column;
}

.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}

.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}

.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgb(0 0 0 / 15%);
  line-height: 16px;
}

.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}

.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}

.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}

.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}

.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}

.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}

.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}

.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}

.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}

.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}

.l7-button-control:disabled:hover {
  background-color: #fafafa;
}

.l7-button-control:disabled:active {
  background-color: #fafafa;
}

.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}

.l7-popper.l7-popper-hide {
  display: none;
}

.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgb(0 0 0 / 15%);
}

.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-color: transparent;
  box-shadow: 0 0 20px 0 rgb(0 0 0 / 15%);
}

.l7-popper.l7-popper-left {
  flex-direction: row;
}

.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}

.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}

.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}

.l7-popper.l7-popper-top {
  flex-direction: column;
}

.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}

.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}

.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}

.l7-popper.l7-popper-start {
  align-items: flex-start;
}

.l7-popper.l7-popper-end {
  align-items: flex-end;
}

.l7-select-control--normal {
  padding: 4px 0;
}

.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}

.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}

.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}

.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}

.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow: hidden auto;
}

.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}

.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}

.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}

.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}

.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}

.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}

.l7-select-control-item {
  cursor: pointer;
}

.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}

.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}

.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-control-logo img {
  height: 100%;
  width: 100%;
}

.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}

.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}

.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgb(0 0 0 / 15%);
  padding: 2px 4px;
  min-width: 130px;
}

.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgb(0 0 0 / 15%);
}

.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}

.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}

.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}

.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}

.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}

.l7-control-scale {
  display: flex;
  flex-direction: column;
}

.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}

.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}

.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}

.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}

.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}

.l7-popup.l7-popup-hide {
  display: none;
}

.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
}

.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}

.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}

.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}

.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}

.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}

.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}

.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}

.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}

.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}

.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}

.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}

.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}

.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}

.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
  display: none;
}

.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}

.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}

.l7-map:active .l7-popup-track-pointer {
  display: none;
}

.l7-layer-popup__row {
  font-size: 12px;
}

.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}

.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}

.l7-control-swipe_hide {
  display: none;
}

.l7-control-swipe::before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}

.l7-control-swipe.horizontal::before {
  inset: 50% -5000px auto;
  width: auto;
  height: 4px;
}

.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}

.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}

.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}

.l7-control-swipe::after,
.l7-control-swipe__button::before,
.l7-control-swipe__button::after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentcolor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}

.l7-control-swipe__button::after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}

.l7-control-swipe__button::before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var j4=L(81550),Mm=L.n(j4),z4=class{constructor(a,i){const{buffer:s,offset:f,stride:p,normalized:y,size:x,divisor:O}=i;this.buffer=s,this.attribute={buffer:s.get(),offset:f||0,stride:p||0,normalized:y||!1,divisor:O||0},x&&(this.attribute.size=x)}get(){return this.attribute}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},U4={[dt.POINTS]:"points",[dt.LINES]:"lines",[dt.LINE_LOOP]:"line loop",[dt.LINE_STRIP]:"line strip",[dt.TRIANGLES]:"triangles",[dt.TRIANGLE_FAN]:"triangle fan",[dt.TRIANGLE_STRIP]:"triangle strip"},gS={[dt.STATIC_DRAW]:"static",[dt.DYNAMIC_DRAW]:"dynamic",[dt.STREAM_DRAW]:"stream"},Cm={[dt.BYTE]:"int8",[dt.INT]:"int32",[dt.UNSIGNED_BYTE]:"uint8",[dt.UNSIGNED_SHORT]:"uint16",[dt.UNSIGNED_INT]:"uint32",[dt.FLOAT]:"float"},Z4={[dt.ALPHA]:"alpha",[dt.LUMINANCE]:"luminance",[dt.LUMINANCE_ALPHA]:"luminance alpha",[dt.RGB]:"rgb",[dt.RGBA]:"rgba",[dt.RGBA4]:"rgba4",[dt.RGB5_A1]:"rgb5 a1",[dt.RGB565]:"rgb565",[dt.DEPTH_COMPONENT]:"depth",[dt.DEPTH_STENCIL]:"depth stencil"},H4={[dt.DONT_CARE]:"dont care",[dt.NICEST]:"nice",[dt.FASTEST]:"fast"},vS={[dt.NEAREST]:"nearest",[dt.LINEAR]:"linear",[dt.LINEAR_MIPMAP_LINEAR]:"mipmap",[dt.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[dt.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[dt.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},mS={[dt.REPEAT]:"repeat",[dt.CLAMP_TO_EDGE]:"clamp",[dt.MIRRORED_REPEAT]:"mirror"},W4={[dt.NONE]:"none",[dt.BROWSER_DEFAULT_WEBGL]:"browser"},V4={[dt.NEVER]:"never",[dt.ALWAYS]:"always",[dt.LESS]:"less",[dt.LEQUAL]:"lequal",[dt.GREATER]:"greater",[dt.GEQUAL]:"gequal",[dt.EQUAL]:"equal",[dt.NOTEQUAL]:"notequal"},yS={[dt.FUNC_ADD]:"add",[dt.MIN_EXT]:"min",[dt.MAX_EXT]:"max",[dt.FUNC_SUBTRACT]:"subtract",[dt.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},Vp={[dt.ZERO]:"zero",[dt.ONE]:"one",[dt.SRC_COLOR]:"src color",[dt.ONE_MINUS_SRC_COLOR]:"one minus src color",[dt.SRC_ALPHA]:"src alpha",[dt.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[dt.DST_COLOR]:"dst color",[dt.ONE_MINUS_DST_COLOR]:"one minus dst color",[dt.DST_ALPHA]:"dst alpha",[dt.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[dt.CONSTANT_COLOR]:"constant color",[dt.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[dt.CONSTANT_ALPHA]:"constant alpha",[dt.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[dt.SRC_ALPHA_SATURATE]:"src alpha saturate"},_S={[dt.NEVER]:"never",[dt.ALWAYS]:"always",[dt.LESS]:"less",[dt.LEQUAL]:"lequal",[dt.GREATER]:"greater",[dt.GEQUAL]:"gequal",[dt.EQUAL]:"equal",[dt.NOTEQUAL]:"notequal"},hu={[dt.ZERO]:"zero",[dt.KEEP]:"keep",[dt.REPLACE]:"replace",[dt.INVERT]:"invert",[dt.INCR]:"increment",[dt.DECR]:"decrement",[dt.INCR_WRAP]:"increment wrap",[dt.DECR_WRAP]:"decrement wrap"},bS={[dt.FRONT]:"front",[dt.BACK]:"back"},pu=class{constructor(a,i){this.isDestroyed=!1;const{data:s,usage:f,type:p}=i;this.buffer=a.buffer({data:s,usage:gS[f||dt.STATIC_DRAW],type:Cm[p||dt.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:i}){this.buffer.subdata(a,i)}},G4=class{constructor(a,i){const{data:s,usage:f,type:p,count:y}=i;this.elements=a.elements({data:s,usage:gS[f||dt.STATIC_DRAW],type:Cm[p||dt.UNSIGNED_BYTE],count:y})}get(){return this.elements}subData({data:a}){this.elements.subdata(a)}destroy(){}},$4=class{constructor(a,i){const{width:s,height:f,color:p,colors:y}=i,x={width:s,height:f};Array.isArray(y)&&(x.colors=y.map(O=>O.get())),p&&typeof p!="boolean"&&(x.color=p.get()),this.framebuffer=a.framebuffer(x)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:a,height:i}){this.framebuffer.resize(a,i)}},an=L(75334),Y4=Object.defineProperty,xS=Object.defineProperties,gu=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,SS=Object.prototype.hasOwnProperty,X4=Object.prototype.propertyIsEnumerable,wS=(a,i,s)=>i in a?Y4(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,ws=(a,i)=>{for(var s in i||(i={}))SS.call(i,s)&&wS(a,s,i[s]);if(Gp)for(var s of Gp(i))X4.call(i,s)&&wS(a,s,i[s]);return a},q4=(a,i)=>xS(a,gu(i)),{isPlainObject:Pm,isTypedArray:K4}=hi,Q4=class{constructor(a,i){this.destroyed=!1,this.uniforms={},this.reGl=a;const{vs:s,fs:f,attributes:p,uniforms:y,primitive:x,count:O,elements:A,depth:I,cull:B,instances:j}=i,V={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:an.Fp.LOWER_LEFT,clipSpaceNearZ:an.R$.NEGATIVE_ONE,supportMRT:!1},mt={};this.options=i,y&&(this.uniforms=this.extractUniforms(y),Object.keys(y).forEach(ke=>{mt[ke]=a.prop(ke)}));const Bt={};Object.keys(p).forEach(ke=>{Bt[ke]=p[ke].get()});const Kt=Rs((0,an.oX)(V,"frag",f,null,!1)),ue=Rs((0,an.oX)(V,"vert",s,null,!1)),Le={attributes:Bt,frag:Kt,uniforms:mt,vert:ue,colorMask:a.prop("colorMask"),lineWidth:1,blend:{enable:a.prop("blend.enable"),func:a.prop("blend.func"),equation:a.prop("blend.equation"),color:a.prop("blend.color")},stencil:{enable:a.prop("stencil.enable"),mask:a.prop("stencil.mask"),func:a.prop("stencil.func"),opFront:a.prop("stencil.opFront"),opBack:a.prop("stencil.opBack")},primitive:U4[x===void 0?dt.TRIANGLES:x]};j&&(Le.instances=j),O?Le.count=O:A&&(Le.elements=A.get()),this.initDepthDrawParams({depth:I},Le),this.initCullDrawParams({cull:B},Le),this.drawCommand=a(Le),this.drawParams=Le}updateAttributesAndElements(a,i){const s={};Object.keys(a).forEach(f=>{s[f]=a[f].get()}),this.drawParams.attributes=s,this.drawParams.elements=i.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(a){const i={};Object.keys(a).forEach(s=>{i[s]=a[s].get()}),this.drawParams.attributes=i,this.drawCommand=this.reGl(this.drawParams)}addUniforms(a){this.uniforms=ws(ws({},this.uniforms),this.extractUniforms(a))}draw(a,i){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const s=ws(ws({},this.uniforms),this.extractUniforms(a.uniforms||{})),f={};Object.keys(s).forEach(p=>{const y=typeof s[p];y==="boolean"||y==="number"||Array.isArray(s[p])||s[p].BYTES_PER_ELEMENT?f[p]=s[p]:f[p]=s[p].get()}),f.blend=i?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(a),f.stencil=this.getStencilDrawParams(a),f.colorMask=this.getColorMaskDrawParams(a,i),this.drawCommand(f)}destroy(){var a,i;(i=(a=this.drawParams)==null?void 0:a.elements)==null||i.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(s=>{s==null||s.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:a},i){a&&(i.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:V4[a.func||dt.LESS],range:a.range||[0,1]})}getBlendDrawParams({blend:a}){const{enable:i,func:s,equation:f,color:p=[0,0,0,0]}=a||{};return{enable:!!i,func:{srcRGB:Vp[s&&s.srcRGB||dt.SRC_ALPHA],srcAlpha:Vp[s&&s.srcAlpha||dt.SRC_ALPHA],dstRGB:Vp[s&&s.dstRGB||dt.ONE_MINUS_SRC_ALPHA],dstAlpha:Vp[s&&s.dstAlpha||dt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:yS[f&&f.rgb||dt.FUNC_ADD],alpha:yS[f&&f.alpha||dt.FUNC_ADD]},color:p}}getStencilDrawParams({stencil:a}){const{enable:i,mask:s=-1,func:f={cmp:dt.ALWAYS,ref:0,mask:-1},opFront:p={fail:dt.KEEP,zfail:dt.KEEP,zpass:dt.KEEP},opBack:y={fail:dt.KEEP,zfail:dt.KEEP,zpass:dt.KEEP}}=a||{};return{enable:!!i,mask:s,func:q4(ws({},f),{cmp:_S[f.cmp]}),opFront:{fail:hu[p.fail],zfail:hu[p.zfail],zpass:hu[p.zpass]},opBack:{fail:hu[y.fail],zfail:hu[y.zfail],zpass:hu[y.zpass]}}}getColorMaskDrawParams({stencil:a},i){return a!=null&&a.enable&&a.opFront&&!i?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:a},i){if(a){const{enable:s,face:f=dt.BACK}=a;i.cull={enable:!!s,face:bS[f]}}}extractUniforms(a){const i={};return Object.keys(a).forEach(s=>{this.extractUniformsRecursively(s,a[s],i,"")}),i}extractUniformsRecursively(a,i,s,f){if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||K4(i)||i===""||"resize"in i){s[`${f&&f+"."}${a}`]=i;return}Pm(i)&&Object.keys(i).forEach(p=>{this.extractUniformsRecursively(p,i[p],s,`${f&&f+"."}${a}`)}),Array.isArray(i)&&i.forEach((p,y)=>{Object.keys(p).forEach(x=>{this.extractUniformsRecursively(x,p[x],s,`${f&&f+"."}${a}[${y}]`)})})}},J4=class{constructor(a,i){this.isDestroy=!1;const{data:s,type:f=dt.UNSIGNED_BYTE,width:p,height:y,flipY:x=!1,format:O=dt.RGBA,mipmap:A=!1,wrapS:I=dt.CLAMP_TO_EDGE,wrapT:B=dt.CLAMP_TO_EDGE,aniso:j=0,alignment:V=1,premultiplyAlpha:mt=!1,mag:Bt=dt.NEAREST,min:Kt=dt.NEAREST,colorSpace:ue=dt.BROWSER_DEFAULT_WEBGL,x:Le=0,y:ke=0,copy:He=!1}=i;this.width=p,this.height=y;const Ye={width:p,height:y,type:Cm[f],format:Z4[O],wrapS:mS[I],wrapT:mS[B],mag:vS[Bt],min:vS[Kt],alignment:V,flipY:x,colorSpace:W4[ue],premultiplyAlpha:mt,aniso:j,x:Le,y:ke,copy:He};s&&(Ye.data=s),typeof A=="number"?Ye.mipmap=H4[A]:typeof A=="boolean"&&(Ye.mipmap=A),this.texture=a.texture(Ye)}get(){return this.texture}update(a={}){this.texture(a)}bind(){this.texture._texture.bind()}resize({width:a,height:i}){this.texture.resize(a,i),this.width=a,this.height=i}getSize(){return[this.width,this.height]}destroy(){var a;this.isDestroy||(a=this.texture)==null||a.destroy(),this.isDestroy=!0}},Lm=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),vu=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=a=>new Q4(this.gl,a),this.createAttribute=a=>new z4(this.gl,a),this.createBuffer=a=>new pu(this.gl,a),this.createElements=a=>new G4(this.gl,a),this.createTexture2D=a=>new J4(this.gl,a),this.createFramebuffer=a=>new $4(this.gl,a),this.useFramebuffer=(a,i)=>{this.gl({framebuffer:a?a.get():null})(i)},this.useFramebufferAsync=(a,i)=>Lm(this,null,function*(){this.gl({framebuffer:a?a.get():null})(i)}),this.clear=a=>{var i;const{color:s,depth:f,stencil:p,framebuffer:y=null}=a,x={color:s,depth:f,stencil:p};x.framebuffer=y===null?y:y.get(),(i=this.gl)==null||i.clear(x)},this.viewport=({x:a,y:i,width:s,height:f})=>{this.gl._gl.viewport(a,i,s,f),this.width=s,this.height=f,this.gl._refresh()},this.readPixels=a=>{const{framebuffer:i,x:s,y:f,width:p,height:y}=a,x={x:s,y:f,width:p,height:y};return i&&(x.framebuffer=i.get()),this.gl.read(x)},this.readPixelsAsync=a=>Lm(this,null,function*(){return this.readPixels(a)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var a,i,s;this.canvas=null,(s=(i=(a=this.gl)==null?void 0:a._gl)==null?void 0:i.getExtension("WEBGL_lose_context"))==null||s.loseContext(),this.gl.destroy(),this.gl=null}}init(a,i,s){return Lm(this,null,function*(){this.canvas=a,s?this.gl=s:this.gl=yield new Promise((f,p)=>{Mm()({canvas:this.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,stencil:i.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(y,x)=>{(y||!x)&&p(y),f(x)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const a=this.getGLContext();a.disable(a.CULL_FACE)}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},Im=class{constructor(a,i){const{buffer:s,offset:f,stride:p,normalized:y,size:x,divisor:O,shaderLocation:A}=i;this.buffer=s,this.attribute={shaderLocation:A,buffer:s.get(),offset:f||0,stride:p||0,normalized:y||!1,divisor:O||0},x&&(this.attribute.size=x)}get(){return this.buffer}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},Rm={[dt.FLOAT]:Float32Array,[dt.UNSIGNED_BYTE]:Uint8Array,[dt.SHORT]:Int16Array,[dt.UNSIGNED_SHORT]:Uint16Array,[dt.INT]:Int32Array,[dt.UNSIGNED_INT]:Uint32Array},OS={[dt.POINTS]:an.YV.POINTS,[dt.LINES]:an.YV.LINES,[dt.LINE_LOOP]:an.YV.LINES,[dt.LINE_STRIP]:an.YV.LINE_STRIP,[dt.TRIANGLES]:an.YV.TRIANGLES,[dt.TRIANGLE_FAN]:an.YV.TRIANGLES,[dt.TRIANGLE_STRIP]:an.YV.TRIANGLE_STRIP},$p={1:an.ED.F32_R,2:an.ED.F32_RG,3:an.ED.F32_RGB,4:an.ED.F32_RGBA},tP={[dt.STATIC_DRAW]:an.MP.STATIC,[dt.DYNAMIC_DRAW]:an.MP.DYNAMIC,[dt.STREAM_DRAW]:an.MP.DYNAMIC},km={[dt.REPEAT]:an.OB.REPEAT,[dt.CLAMP_TO_EDGE]:an.OB.CLAMP_TO_EDGE,[dt.MIRRORED_REPEAT]:an.OB.MIRRORED_REPEAT},ES={[dt.NEVER]:an.wb.NEVER,[dt.ALWAYS]:an.wb.ALWAYS,[dt.LESS]:an.wb.LESS,[dt.LEQUAL]:an.wb.LEQUAL,[dt.GREATER]:an.wb.GREATER,[dt.GEQUAL]:an.wb.GEQUAL,[dt.EQUAL]:an.wb.EQUAL,[dt.NOTEQUAL]:an.wb.NOTEQUAL},eP={[dt.FRONT]:an.Wf.FRONT,[dt.BACK]:an.Wf.BACK},td={[dt.FUNC_ADD]:an.bt.ADD,[dt.MIN_EXT]:an.bt.MIN,[dt.MAX_EXT]:an.bt.MAX,[dt.FUNC_SUBTRACT]:an.bt.SUBSTRACT,[dt.FUNC_REVERSE_SUBTRACT]:an.bt.REVERSE_SUBSTRACT},Yp={[dt.ZERO]:an.zi.ZERO,[dt.ONE]:an.zi.ONE,[dt.SRC_COLOR]:an.zi.SRC,[dt.ONE_MINUS_SRC_COLOR]:an.zi.ONE_MINUS_SRC,[dt.SRC_ALPHA]:an.zi.SRC_ALPHA,[dt.ONE_MINUS_SRC_ALPHA]:an.zi.ONE_MINUS_SRC_ALPHA,[dt.DST_COLOR]:an.zi.DST,[dt.ONE_MINUS_DST_COLOR]:an.zi.ONE_MINUS_DST,[dt.DST_ALPHA]:an.zi.DST_ALPHA,[dt.ONE_MINUS_DST_ALPHA]:an.zi.ONE_MINUS_DST_ALPHA,[dt.CONSTANT_COLOR]:an.zi.CONST,[dt.ONE_MINUS_CONSTANT_COLOR]:an.zi.ONE_MINUS_CONSTANT,[dt.CONSTANT_ALPHA]:an.zi.CONST,[dt.ONE_MINUS_CONSTANT_ALPHA]:an.zi.ONE_MINUS_CONSTANT,[dt.SRC_ALPHA_SATURATE]:an.zi.SRC_ALPHA_SATURATE},mu={[dt.REPLACE]:an.Kd.REPLACE,[dt.KEEP]:an.Kd.KEEP,[dt.ZERO]:an.Kd.ZERO,[dt.INVERT]:an.Kd.INVERT,[dt.INCR]:an.Kd.INCREMENT_CLAMP,[dt.DECR]:an.Kd.DECREMENT_CLAMP,[dt.INCR_WRAP]:an.Kd.INCREMENT_WRAP,[dt.DECR_WRAP]:an.Kd.DECREMENT_WRAP},nP={[dt.ALWAYS]:an.wb.ALWAYS,[dt.EQUAL]:an.wb.EQUAL,[dt.GEQUAL]:an.wb.GEQUAL,[dt.GREATER]:an.wb.GREATER,[dt.LEQUAL]:an.wb.LEQUAL,[dt.LESS]:an.wb.LESS,[dt.NEVER]:an.wb.NEVER,[dt.NOTEQUAL]:an.wb.NOTEQUAL},rP={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Xp(a){return Object.prototype.toString.call(a)in rP}function iP(a,i){const s=a.length,f=Math.ceil(s/3),p=s+f,y=new Float32Array(p);for(let x=0;x<p;x+=4)y[x]=a[x/4*3],y[x+1]=a[x/4*3+1],y[x+2]=a[x/4*3+2],y[x+3]=i;return y}var AS=class{constructor(a,i){this.isDestroyed=!1;const{data:s,usage:f,type:p,isUBO:y,label:x}=i;let O;Xp(s)?O=s:O=new Rm[this.type||dt.FLOAT](s),this.type=p,this.size=O.byteLength,this.buffer=a.createBuffer({viewOrSize:O,usage:y?an.FB.UNIFORM:an.FB.VERTEX,hint:tP[f||dt.STATIC_DRAW]}),x&&a.setResourceName(this.buffer,x)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:i}){let s;Xp(a)?s=a:s=new Rm[this.type||dt.FLOAT](a),this.buffer.setSubData(i,new Uint8Array(s.buffer))}};function Sr(a,i=0){return a+=i,a+=a<<10,a+=a>>>6,a>>>0}function TS(a){return a+=a<<3,a^=a>>>11,a+=a<<15,a>>>0}function Dm(){return 0}var Nm=class{constructor(){this.keys=[],this.values=[]}},ed=class{constructor(a,i){this.keyEqualFunc=a,this.keyHashFunc=i,this.buckets=new Map}findBucketIndex(a,i){for(let s=0;s<a.keys.length;s++)if(this.keyEqualFunc(i,a.keys[s]))return s;return-1}findBucket(a){const i=this.keyHashFunc(a);return this.buckets.get(i)}get(a){const i=this.findBucket(a);if(i===void 0)return null;const s=this.findBucketIndex(i,a);return s<0?null:i.values[s]}add(a,i){const s=this.keyHashFunc(a);this.buckets.get(s)===void 0&&this.buckets.set(s,new Nm);const f=this.buckets.get(s);f.keys.push(a),f.values.push(i)}delete(a){const i=this.findBucket(a);if(i===void 0)return;const s=this.findBucketIndex(i,a);s!==-1&&(i.keys.splice(s,1),i.values.splice(s,1))}clear(){this.buckets.clear()}size(){let a=0;for(const i of this.buckets.values())a+=i.values.length;return a}*values(){for(const a of this.buckets.values())for(let i=a.values.length-1;i>=0;i--)yield a.values[i]}};function Fm(a,i){return a=Sr(a,i.blendMode),a=Sr(a,i.blendSrcFactor),a=Sr(a,i.blendDstFactor),a}function MS(a,i){return a=Fm(a,i.rgbBlendState),a=Fm(a,i.alphaBlendState),a=Sr(a,i.channelWriteMask),a}function CS(a,i){return a=Sr(a,i.r<<24|i.g<<16|i.b<<8|i.a),a}function PS(a,i){var s,f,p,y,x,O,A,I;for(let B=0;B<i.attachmentsState.length;B++)a=MS(a,i.attachmentsState[B]);return a=CS(a,i.blendConstant||an.Ab),a=Sr(a,i.depthCompare),a=Sr(a,i.depthWrite?1:0),a=Sr(a,(s=i.stencilFront)==null?void 0:s.compare),a=Sr(a,(f=i.stencilFront)==null?void 0:f.passOp),a=Sr(a,(p=i.stencilFront)==null?void 0:p.failOp),a=Sr(a,(y=i.stencilFront)==null?void 0:y.depthFailOp),a=Sr(a,(x=i.stencilBack)==null?void 0:x.compare),a=Sr(a,(O=i.stencilBack)==null?void 0:O.passOp),a=Sr(a,(A=i.stencilBack)==null?void 0:A.failOp),a=Sr(a,(I=i.stencilBack)==null?void 0:I.depthFailOp),a=Sr(a,i.stencilWrite?1:0),a=Sr(a,i.cullMode),a=Sr(a,i.frontFace?1:0),a=Sr(a,i.polygonOffset?1:0),a}function LS(a){let i=0;i=Sr(i,a.program.id),a.inputLayout!==null&&(i=Sr(i,a.inputLayout.id)),i=PS(i,a.megaStateDescriptor);for(let s=0;s<a.colorAttachmentFormats.length;s++)i=Sr(i,a.colorAttachmentFormats[s]||0);return i=Sr(i,a.depthStencilAttachmentFormat||0),TS(i)}function IS(a){let i=0;if(a.samplerBindings)for(let s=0;s<a.samplerBindings.length;s++){const f=a.samplerBindings[s];f!==null&&f.texture!==null&&(i=Sr(i,f.texture.id))}if(a.uniformBufferBindings)for(let s=0;s<a.uniformBufferBindings.length;s++){const f=a.uniformBufferBindings[s];f!==null&&f.buffer!==null&&(i=Sr(i,f.buffer.id),i=Sr(i,f.binding),i=Sr(i,f.offset),i=Sr(i,f.size))}if(a.storageBufferBindings)for(let s=0;s<a.storageBufferBindings.length;s++){const f=a.storageBufferBindings[s];f!==null&&f.buffer!==null&&(i=Sr(i,f.buffer.id),i=Sr(i,f.binding),i=Sr(i,f.offset),i=Sr(i,f.size))}if(a.storageTextureBindings)for(let s=0;s<a.storageTextureBindings.length;s++){const f=a.storageTextureBindings[s];f!==null&&f.texture!==null&&(i=Sr(i,f.texture.id),i=Sr(i,f.binding))}return TS(i)}function Xr(a,i){var s,f,p,y;return((s=a.vertex)==null?void 0:s.glsl)===((f=i.vertex)==null?void 0:f.glsl)&&((p=a.fragment)==null?void 0:p.glsl)===((y=i.fragment)==null?void 0:y.glsl)}function nd(a){var i,s;return{vertex:{glsl:(i=a.vertex)==null?void 0:i.glsl},fragment:{glsl:(s=a.fragment)==null?void 0:s.glsl}}}var qp=class{constructor(a){this.device=a,this.bindingsCache=new ed(an.PU,IS),this.renderPipelinesCache=new ed(an.zC,LS),this.inputLayoutsCache=new ed(an.F3,Dm),this.programCache=new ed(Xr,Dm)}createBindings(a){var i;let s=this.bindingsCache.get(a);if(s===null){const f=(0,an.LJ)(a);f.uniformBufferBindings=(i=f.uniformBufferBindings)==null?void 0:i.filter(({size:p})=>p&&p>0),s=this.device.createBindings(f),this.bindingsCache.add(f,s)}return s}createRenderPipeline(a){let i=this.renderPipelinesCache.get(a);if(i===null){const s=(0,an.yA)(a);s.colorAttachmentFormats=s.colorAttachmentFormats.filter(f=>f),i=this.device.createRenderPipeline(s),this.renderPipelinesCache.add(s,i)}return i}createInputLayout(a){a.vertexBufferDescriptors=a.vertexBufferDescriptors.filter(s=>!!s);let i=this.inputLayoutsCache.get(a);if(i===null){const s=(0,an.Id)(a);i=this.device.createInputLayout(s),this.inputLayoutsCache.add(s,i)}return i}createProgram(a){let i=this.programCache.get(a);if(i===null){const s=nd(a);i=this.device.createProgram(a),this.programCache.add(s,i)}return i}destroy(){for(const a of this.bindingsCache.values())a.destroy();for(const a of this.renderPipelinesCache.values())a.destroy();for(const a of this.inputLayoutsCache.values())a.destroy();for(const a of this.programCache.values())a.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},oP=class{constructor(a,i){const{data:s,type:f,count:p=0}=i;let y;Xp(s)?y=s:y=new Rm[this.type||dt.UNSIGNED_INT](s),this.type=f,this.count=p,this.indexBuffer=a.createBuffer({viewOrSize:y,usage:an.FB.INDEX})}get(){return this.indexBuffer}subData({data:a}){let i;Xp(a)?i=a:i=new Rm[this.type||dt.UNSIGNED_INT](a),this.indexBuffer.setSubData(0,new Uint8Array(i.buffer))}destroy(){this.indexBuffer.destroy()}};function Os(a){return!!(a&&a.texture)}var br=class{constructor(a,i){this.device=a,this.options=i,this.isDestroy=!1;const{wrapS:s=dt.CLAMP_TO_EDGE,wrapT:f=dt.CLAMP_TO_EDGE,aniso:p,mag:y=dt.NEAREST,min:x=dt.NEAREST}=i;this.createTexture(i),this.sampler=a.createSampler({addressModeU:km[s],addressModeV:km[f],minFilter:x===dt.NEAREST?an.X9.POINT:an.X9.BILINEAR,magFilter:y===dt.NEAREST?an.X9.POINT:an.X9.BILINEAR,mipmapFilter:an.f$.NO_MIP,maxAnisotropy:p})}createTexture(a){const{type:i=dt.UNSIGNED_BYTE,width:s,height:f,flipY:p=!1,format:y=dt.RGBA,alignment:x=1,usage:O=Pl.SAMPLED,unorm:A=!1,label:I}=a;let{data:B}=a;this.width=s,this.height=f;let j=an.ED.U8_RGBA_RT;if(i===dt.UNSIGNED_BYTE&&y===dt.RGBA)j=A?an.ED.U8_RGBA_NORM:an.ED.U8_RGBA_RT;else if(i===dt.UNSIGNED_BYTE&&y===dt.LUMINANCE)j=an.ED.U8_LUMINANCE;else if(i===dt.FLOAT&&y===dt.LUMINANCE)j=an.ED.F32_LUMINANCE;else if(i===dt.FLOAT&&y===dt.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(B&&(B=iP(B,0)),j=an.ED.F32_RGBA):j=an.ED.F32_RGB;else if(i===dt.FLOAT&&y===dt.RGBA)j=an.ED.F32_RGBA;else if(i===dt.FLOAT&&y===dt.RED)j=an.ED.F32_R;else throw new Error(`create texture error, type: ${i}, format: ${y}`);this.texture=this.device.createTexture({format:j,width:s,height:f,usage:O===Pl.SAMPLED?an.v2.SAMPLED:an.v2.RENDER_TARGET,pixelStore:{unpackFlipY:p,packAlignment:x},mipLevelCount:1}),I&&this.device.setResourceName(this.texture,I),B&&this.texture.setImageData([B])}get(){return this.texture}update(a){const{data:i}=a;this.texture.setImageData([i])}bind(){}resize({width:a,height:i}){(this.width!==a||this.height!==i)&&this.destroy(),this.options.width=a,this.options.height=i,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var a;!this.isDestroy&&!this.texture.destroyed&&((a=this.texture)==null||a.destroy()),this.isDestroy=!0}},rd=class{constructor(a,i){this.device=a,this.options=i,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(a=!1){const{width:i,height:s,color:f}=this.options;f&&(Os(f)?(a&&f.resize({width:i,height:s}),this.colorTexture=f.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=f.width,this.height=f.height):i&&s&&(this.colorTexture=this.device.createTexture({format:an.ED.U8_RGBA_RT,usage:an.v2.RENDER_TARGET,width:i,height:s}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=i,this.height=s))}createDepthRenderTarget(a=!1){const{width:i,height:s,depth:f}=this.options;f&&(Os(f)?(a&&f.resize({width:i,height:s}),this.depthTexture=f.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=f.width,this.height=f.height):i&&s&&(this.depthTexture=this.device.createTexture({format:an.ED.D24_S8,usage:an.v2.RENDER_TARGET,width:i,height:s}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=i,this.height=s))}get(){return this.colorRenderTarget}destroy(){var a,i;(a=this.colorRenderTarget)==null||a.destroy(),(i=this.depthRenderTarget)==null||i.destroy()}resize({width:a,height:i}){(this.width!==a||this.height!==i)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=a,this.options.height=i,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},id=Object.defineProperty,od=Object.defineProperties,Js=Object.getOwnPropertyDescriptors,tc=Object.getOwnPropertySymbols,Kp=Object.prototype.hasOwnProperty,yu=Object.prototype.propertyIsEnumerable,Bm=(a,i,s)=>i in a?id(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Es=(a,i)=>{for(var s in i||(i={}))Kp.call(i,s)&&Bm(a,s,i[s]);if(tc)for(var s of tc(i))yu.call(i,s)&&Bm(a,s,i[s]);return a},RS=(a,i)=>od(a,Js(i)),{isPlainObject:aP,isTypedArray:sP,isNil:ad}=hi,cP=class{constructor(a,i,s){this.device=a,this.options=i,this.service=s,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:f,fs:p,attributes:y,uniforms:x,count:O,elements:A,diagnosticDerivativeUniformityEnabled:I}=i;this.options=i;const B=I?"":this.service.viewportOrigin===an.Fp.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=s.renderCache.createProgram({vertex:{glsl:f},fragment:{glsl:p,postprocess:Bt=>B+Bt}}),x&&(this.uniforms=this.extractUniforms(x));const j=[];let V=0;Object.keys(y).forEach(Bt=>{const Kt=y[Bt],ue=Kt.get();this.vertexBuffers.push(ue.get());const{offset:Le=0,stride:ke=0,size:He=1,divisor:Ye=0,shaderLocation:rn=0}=Kt.attribute;j.push({arrayStride:ke||He*4,stepMode:an.Kz.VERTEX,attributes:[{format:$p[He],shaderLocation:rn,offset:Le,divisor:Ye}]}),V=ue.size/He}),O||(this.options.count=V),A&&(this.indexBuffer=A.get());const mt=s.renderCache.createInputLayout({vertexBufferDescriptors:j,indexBufferFormat:A?an.ED.U32_R:null,program:this.program});this.inputLayout=mt,this.pipeline=this.createPipeline(i)}createPipeline(a,i){var s;const{primitive:f=dt.TRIANGLES,depth:p,cull:y,blend:x,stencil:O}=a,A=this.initDepthDrawParams({depth:p}),I=!!(A&&A.enable),B=this.initCullDrawParams({cull:y}),j=!!(B&&B.enable),V=this.getBlendDrawParams({blend:x}),mt=!!(V&&V.enable),Bt=this.getStencilDrawParams({stencil:O}),Kt=!!(Bt&&Bt.enable),ue=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:OS[f],colorAttachmentFormats:[an.ED.U8_RGBA_RT],depthStencilAttachmentFormat:an.ED.D24_S8,megaStateDescriptor:{attachmentsState:[i?{channelWriteMask:an.GI.ALL,rgbBlendState:{blendMode:an.bt.ADD,blendSrcFactor:an.zi.ONE,blendDstFactor:an.zi.ZERO},alphaBlendState:{blendMode:an.bt.ADD,blendSrcFactor:an.zi.ONE,blendDstFactor:an.zi.ZERO}}:{channelWriteMask:Kt&&Bt.opFront.zpass===an.Kd.REPLACE?an.GI.NONE:an.GI.ALL,rgbBlendState:{blendMode:mt&&V.equation.rgb||an.bt.ADD,blendSrcFactor:mt&&V.func.srcRGB||an.zi.SRC_ALPHA,blendDstFactor:mt&&V.func.dstRGB||an.zi.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:mt&&V.equation.alpha||an.bt.ADD,blendSrcFactor:mt&&V.func.srcAlpha||an.zi.ONE,blendDstFactor:mt&&V.func.dstAlpha||an.zi.ONE}}],blendConstant:mt?an.Ab:void 0,depthWrite:I,depthCompare:I&&A.func||an.wb.LESS,cullMode:j&&B.face||an.Wf.NONE,stencilWrite:Kt,stencilFront:{compare:Kt?Bt.func.cmp:an.wb.ALWAYS,passOp:Bt.opFront.zpass,failOp:Bt.opFront.fail,depthFailOp:Bt.opFront.zfail,mask:Bt.opFront.mask},stencilBack:{compare:Kt?Bt.func.cmp:an.wb.ALWAYS,passOp:Bt.opBack.zpass,failOp:Bt.opBack.fail,depthFailOp:Bt.opBack.zfail,mask:Bt.opBack.mask}}});return Kt&&!ad((s=O==null?void 0:O.func)==null?void 0:s.ref)&&(ue.stencilFuncReference=O.func.ref),ue}updateAttributesAndElements(){}updateAttributes(){}addUniforms(a){this.uniforms=Es(Es({},this.uniforms),this.extractUniforms(a))}draw(a,i){const s=Es(Es({},this.options),a),{count:f=0,instances:p,elements:y,uniforms:x={},uniformBuffers:O,textures:A}=s;this.uniforms=Es(Es({},this.uniforms),this.extractUniforms(x));const{renderPass:I,currentFramebuffer:B,width:j,height:V}=this.service;this.pipeline=this.createPipeline(s,i);const mt=this.service.device,Bt=mt.swapChainHeight;if(mt.swapChainHeight=(B==null?void 0:B.height)||V,I.setViewport(0,0,(B==null?void 0:B.width)||j,(B==null?void 0:B.height)||V),mt.swapChainHeight=Bt,I.setPipeline(this.pipeline),ad(this.pipeline.stencilFuncReference)||I.setStencilReference(this.pipeline.stencilFuncReference),I.setVertexInput(this.inputLayout,this.vertexBuffers.map(Kt=>({buffer:Kt})),y?{buffer:this.indexBuffer,offset:0}:null),O&&(this.bindings=mt.createBindings({pipeline:this.pipeline,uniformBufferBindings:O.map((Kt,ue)=>{const Le=Kt;return{binding:ue,buffer:Le.get(),size:Le.size}}),samplerBindings:A==null?void 0:A.map(Kt=>({texture:Kt.texture,sampler:Kt.sampler}))})),this.bindings&&(I.setBindings(this.bindings),Object.keys(this.uniforms).forEach(Kt=>{const ue=this.uniforms[Kt];ue instanceof br?this.uniforms[Kt]=ue.get():ue instanceof rd&&(this.uniforms[Kt]=ue.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),y){const Kt=y.count;Kt===0?I.draw(f,p):I.drawIndexed(Kt,p)}else I.draw(f,p)}destroy(){var a,i,s;(a=this.vertexBuffers)==null||a.forEach(f=>f.destroy()),(i=this.indexBuffer)==null||i.destroy(),(s=this.bindings)==null||s.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:a}){if(a)return{enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:ES[a.func||dt.LESS],range:a.range||[0,1]}}getBlendDrawParams({blend:a}){const{enable:i,func:s,equation:f,color:p=[0,0,0,0]}=a||{};return{enable:!!i,func:{srcRGB:Yp[s&&s.srcRGB||dt.SRC_ALPHA],srcAlpha:Yp[s&&s.srcAlpha||dt.SRC_ALPHA],dstRGB:Yp[s&&s.dstRGB||dt.ONE_MINUS_SRC_ALPHA],dstAlpha:Yp[s&&s.dstAlpha||dt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:td[f&&f.rgb||dt.FUNC_ADD],alpha:td[f&&f.alpha||dt.FUNC_ADD]},color:p}}getStencilDrawParams({stencil:a}){const{enable:i,mask:s=4294967295,func:f={cmp:dt.ALWAYS,ref:0,mask:4294967295},opFront:p={fail:dt.KEEP,zfail:dt.KEEP,zpass:dt.KEEP},opBack:y={fail:dt.KEEP,zfail:dt.KEEP,zpass:dt.KEEP}}=a||{};return{enable:!!i,mask:s,func:RS(Es({},f),{cmp:nP[f.cmp]}),opFront:{fail:mu[p.fail],zfail:mu[p.zfail],zpass:mu[p.zpass],mask:f.mask},opBack:{fail:mu[y.fail],zfail:mu[y.zfail],zpass:mu[y.zpass],mask:f.mask}}}initCullDrawParams({cull:a}){if(a){const{enable:i,face:s=dt.BACK}=a;return{enable:!!i,face:eP[s]}}}extractUniforms(a){const i={};return Object.keys(a).forEach(s=>{this.extractUniformsRecursively(s,a[s],i,"")}),i}extractUniformsRecursively(a,i,s,f){if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||sP(i)||i===""||"resize"in i){s[`${f&&f+"."}${a}`]=i;return}aP(i)&&Object.keys(i).forEach(p=>{this.extractUniformsRecursively(p,i[p],s,`${f&&f+"."}${a}`)}),Array.isArray(i)&&i.forEach((p,y)=>{Object.keys(p).forEach(x=>{this.extractUniformsRecursively(x,p[x],s,`${f&&f+"."}${a}[${y}]`)})})}};function jm(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}var zm=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),{isUndefined:sd}=hi,cd=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=a=>new cP(this.device,a,this),this.createAttribute=a=>new Im(this.device,a),this.createBuffer=a=>new AS(this.device,a),this.createElements=a=>new oP(this.device,a),this.createTexture2D=a=>new br(this.device,a),this.createFramebuffer=a=>new rd(this.device,a),this.useFramebuffer=(a,i)=>{this.currentFramebuffer=a,this.beginFrame(),i(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(a,i)=>zm(this,null,function*(){this.currentFramebuffer=a,this.preRenderPass=this.renderPass,this.beginFrame(),yield i(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=a=>{const{color:i,depth:s,stencil:f,framebuffer:p=null}=a;if(p)p.clearOptions={color:i,depth:s,stencil:f};else{const y=this.queryVerdorInfo();if(y==="WebGL1"){const x=this.getGLContext();sd(f)?sd(s)||(x.clearDepth(s),x.clear(x.DEPTH_BUFFER_BIT)):(x.clearStencil(f),x.clear(x.STENCIL_BUFFER_BIT))}else if(y==="WebGL2"){const x=this.getGLContext();sd(f)?sd(s)||x.clearBufferfv(x.DEPTH,0,[s]):x.clearBufferiv(x.STENCIL,0,[f])}}},this.viewport=({width:a,height:i})=>{this.swapChain.configureSwapChain(a,i),this.createMainColorDepthRT(a,i),this.width=a,this.height=i},this.readPixels=a=>{const{framebuffer:i,x:s,y:f,width:p,height:y}=a,x=this.device.createReadback(),O=i.colorTexture,A=x.readTextureSync(O,s,this.viewportOrigin===an.Fp.LOWER_LEFT?f:this.height-f,p,y,new Uint8Array(p*y*4));if(this.viewportOrigin!==an.Fp.LOWER_LEFT)for(let I=0;I<A.length;I+=4){const B=A[I];A[I]=A[I+2],A[I+2]=B}return x.destroy(),A},this.readPixelsAsync=a=>zm(this,null,function*(){const{framebuffer:i,x:s,y:f,width:p,height:y}=a,x=this.device.createReadback(),O=i.colorTexture,A=yield x.readTexture(O,s,this.viewportOrigin===an.Fp.LOWER_LEFT?f:this.height-f,p,y,new Uint8Array(p*y*4));if(this.viewportOrigin!==an.Fp.LOWER_LEFT)for(let I=0;I<A.length;I+=4){const B=A[I];A[I]=A[I+2],A[I+2]=B}return x.destroy(),A}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var a;this.canvas=null,(a=this.uniformBuffers)==null||a.forEach(i=>{i.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(a,i){return zm(this,null,function*(){const{enableWebGPU:s,shaderCompilerPath:f,antialias:p}=i;this.canvas=a;const x=yield(s?new an.zo({shaderCompilerPath:f}):new an.j8({targets:["webgl2","webgl1"],antialias:p,onContextLost(A){console.warn("context lost",A)},onContextCreationError(A){console.warn("context creation error",A)},onContextRestored(A){console.warn("context restored",A)}})).createSwapChain(a);x.configureSwapChain(a.width,a.height),this.device=x.getDevice(),this.swapChain=x,this.renderCache=new qp(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const O=this.device.gl;this.extensionObject={OES_texture_float:!jm(O)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height)})}createMainColorDepthRT(a,i){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:an.ED.U8_RGBA_RT,width:a,height:i,usage:an.v2.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:an.ED.D24_S8,width:a,height:i,usage:an.v2.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:a,swapChain:i,mainColorRT:s,mainDepthRT:f}=this,p=a?a.colorRenderTarget:s,y=a?null:i.getOnscreenTexture(),x=a?a.depthRenderTarget:f,{color:O=[0,0,0,0],depth:A=1,stencil:I=0}=(a==null?void 0:a.clearOptions)||{},B=p?(0,an.RH)(O[0]*255,O[1]*255,O[2]*255,O[3]):an.Ab,j=x?A:void 0,V=x?I:void 0,mt=this.device.createRenderPass({colorAttachment:[p],colorResolveTo:[y],colorClearColor:[B],colorStore:[!0],depthStencilAttachment:x,depthClearValue:j,stencilClearValue:V});this.renderPass=mt}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const a=this.device.gl;return a.getParameter(a.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}},Um=["selectstart","selecting","selectend"],Qp=class extends No.EventEmitter{constructor(a,i={}){super(),this.isEnable=!1,this.onDragStart=s=>{this.box.style.display="block",this.startEvent=this.endEvent=s,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=s=>{this.endEvent=s,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=s=>{this.endEvent=s,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=a,this.options=i}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:a}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const i=Vi("div",void 0,this.container);i.classList.add("l7-select-box"),a&&i.classList.add(a),i.style.display="none",this.box=i}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:a,y:i}=this.startEvent,{x:s,y:f}=this.endEvent,p=Math.min(a,s),y=Math.min(i,f),x=Math.abs(a-s),O=Math.abs(i-f);this.box.style.top=`${y}px`,this.box.style.left=`${p}px`,this.box.style.width=`${x}px`,this.box.style.height=`${O}px`}getLngLatBox(){const{lngLat:{lng:a,lat:i}}=this.startEvent,{lngLat:{lng:s,lat:f}}=this.endEvent;return C7([[a,i],[s,f]])}},Jp=Object.defineProperty,lP=Object.defineProperties,kS=Object.getOwnPropertyDescriptors,Zm=Object.getOwnPropertySymbols,bo=Object.prototype.hasOwnProperty,c8=Object.prototype.propertyIsEnumerable,$a=(a,i,s)=>i in a?Jp(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,_u=(a,i)=>{for(var s in i||(i={}))bo.call(i,s)&&$a(a,s,i[s]);if(Zm)for(var s of Zm(i))c8.call(i,s)&&$a(a,s,i[s]);return a},uP=(a,i)=>lP(a,kS(i)),Ya=(a,i,s)=>new Promise((f,p)=>{var y=A=>{try{O(s.next(A))}catch(I){p(I)}},x=A=>{try{O(s.throw(A))}catch(I){p(I)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,x);O((s=s.apply(a,i)).next())}),Oi=class{constructor(a){const{id:i,map:s,renderer:f="device"}=a,p=Ns();this.container=p,s.setContainer(p,i),f==="regl"?p.rendererService=new vu:p.rendererService=new cd,this.sceneService=p.sceneService,this.mapService=p.mapService,this.iconService=p.iconService,this.fontService=p.fontService,this.controlService=p.controlService,this.layerService=p.layerService,this.debugService=p.debugService,this.debugService.setEnable(a.debug),this.markerService=p.markerService,this.interactionService=p.interactionService,this.popupService=p.popupService,this.boxSelect=new Qp(this,{}),this.initComponent(i),this.sceneService.init(a),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(a){return Ya(this,null,function*(){return this.sceneService.exportPng(a)})}exportMap(a){return Ya(this,null,function*(){return this.sceneService.exportPng(a)})}registerRenderService(a){this.sceneService.loaded?new a(this).init():this.on("loaded",()=>{new a(this).init()})}setBgColor(a){this.mapService.setBgColor(a)}addLayer(a){this.loaded?this.preAddLayer(a):this.once("loaded",()=>{this.preAddLayer(a)})}preAddLayer(a){const i=Dl(this.container);if(a.setContainer(i),this.sceneService.addLayer(a),a.inited){this.initTileLayer(a);const s=this.initMask(a);this.addMask(s,a.id)}else a.on("inited",()=>{this.initTileLayer(a);const s=this.initMask(a);this.addMask(s,a.id)})}initMask(a){const{mask:i,maskfence:s,maskColor:f="#000",maskOpacity:p=0}=a.getLayerConfig();return!i||!s?void 0:new dS().source(s).shape("fill").style({color:f,opacity:p})}addMask(a,i){if(!a)return;const s=this.getLayer(i);if(s){const f=Dl(this.container);a.setContainer(f),s.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(a){return this.layerService.getLayer(a)}getLayerByName(a){return this.layerService.getLayerByName(a)}removeLayer(a,i){return Ya(this,null,function*(){yield this.layerService.remove(a,i)})}removeAllLayer(){return Ya(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(a){this.layerService.setEnableRender(a)}addIconFont(a,i){this.fontService.addIconFont(a,i)}addIconFonts(a){a.forEach(([i,s])=>{this.fontService.addIconFont(i,s)})}addFontFace(a,i){this.fontService.once("fontloaded",s=>{this.emit("fontloaded",s)}),this.fontService.addFontFace(a,i)}addImage(a,i){return Ya(this,null,function*(){yield this.iconService.addImage(a,i)})}hasImage(a){return this.iconService.hasImage(a)}removeImage(a){this.iconService.removeImage(a)}addIconFontGlyphs(a,i){this.fontService.addIconGlyphs(i)}addControl(a){this.controlService.addControl(a,this.container)}removeControl(a){this.controlService.removeControl(a)}getControlByName(a){return this.controlService.getControlByName(a)}addMarker(a){this.markerService.addMarker(a)}addMarkerLayer(a){this.markerService.addMarkerLayer(a)}removeMarkerLayer(a){this.markerService.removeMarkerLayer(a)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(a){this.popupService.addPopup(a)}removePopup(a){this.popupService.removePopup(a)}on(a,i){var s;Um.includes(a)?(s=this.boxSelect)==null||s.on(a,i):kh.includes(a)?this.sceneService.on(a,i):this.mapService.on(a,i)}once(a,i){var s;Um.includes(a)?(s=this.boxSelect)==null||s.once(a,i):kh.includes(a)?this.sceneService.once(a,i):this.mapService.once(a,i)}emit(a,i){kh.includes(a)?this.sceneService.emit(a,i):this.mapService.on(a,i)}off(a,i){var s;Um.includes(a)?(s=this.boxSelect)==null||s.off(a,i):kh.includes(a)?this.sceneService.off(a,i):this.mapService.off(a,i)}getZoom(){return this.mapService.getZoom()}getCenter(a){return this.mapService.getCenter(a)}setCenter(a,i){return this.mapService.setCenter(a,i)}getPitch(){return this.mapService.getPitch()}setPitch(a){return this.mapService.setPitch(a)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(a){this.mapService.setRotation(a)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(a){this.mapService.panTo(a)}panBy(a,i){this.mapService.panBy(a,i)}getContainer(){return this.mapService.getContainer()}setZoom(a){this.mapService.setZoom(a)}fitBounds(a,i){const{fitBoundsOptions:s,animate:f}=this.sceneService.getSceneConfig();this.mapService.fitBounds(a,i||uP(_u({},s),{animate:f}))}setZoomAndCenter(a,i){this.mapService.setZoomAndCenter(a,i)}setMapStyle(a){this.mapService.setMapStyle(a)}setMapStatus(a){this.mapService.setMapStatus(a)}pixelToLngLat(a){return this.mapService.pixelToLngLat(a)}lngLatToPixel(a){return this.mapService.lngLatToPixel(a)}containerToLngLat(a){return this.mapService.containerToLngLat(a)}lngLatToContainer(a){return this.mapService.lngLatToContainer(a)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(a){this.container.postProcessingPass.name=new a}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(a=!0){this.boxSelect.enable(),a&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(a,i){En.REGISTERED_PROTOCOLS[a]=i}static removeProtocol(a){delete En.REGISTERED_PROTOCOLS[a]}getProtocol(a){return En.REGISTERED_PROTOCOLS[a]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(a){this.controlService.init({container:E1(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:a,logoPosition:i}=this.sceneService.getSceneConfig();a&&this.addControl(new Sx({position:i}))}initTileLayer(a){a.getSource().isTile&&(a.tileLayer=new D4(a))}},Di="2.23.1";class Hm{constructor(i){(0,ot.Z)(this,"configService",void 0),(0,ot.Z)(this,"config",void 0),this.config=i}setContainer(i,s){this.configService=i.globalConfigService,i.mapConfig=(0,on.Z)((0,on.Z)({},this.config),{},{id:s}),i.mapService=new(this.getServiceConstructor())(i)}getServiceConstructor(){throw new Error("Method not implemented.")}}var ec=L(6158),nc=L.n(ec),t0=L(15671),ba=L(43144),Wm=L(82963),fP=L(61120),Vm=L(60136),ld=L(97326),Vo=L(97685);function bu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ud(a,i){var s=Tc.fF([],i,a);return Tc.bA(s,s,1/s[3]),s}function dP(a,i){var s=a%i;return s<0?i+s:s}function hP(a,i,s){return s*i+(1-s)*a}function rc(a,i){if(!a)throw new Error(i||"viewport-mercator-project: assertion failed.")}var Go=Math.PI,xu=Go/4,As=Go/180,Gm=180/Go,$m=512,Ym=4003e4,sa=1.5;function Xm(a){return Math.pow(2,a)}function qm(a){return Math.log2(a)}function Su(a,i){var s=(0,Vo.Z)(a,2),f=s[0],p=s[1];rc(Number.isFinite(f)&&Number.isFinite(i)),rc(Number.isFinite(p)&&p>=-90&&p<=90,"invalid latitude"),i*=$m;var y=f*As,x=p*As,O=i*(y+Go)/(2*Go),A=i*(Go-Math.log(Math.tan(xu+x*.5)))/(2*Go);return[O,A]}function DS(a,i){var s=(0,Vo.Z)(a,2),f=s[0],p=s[1];i*=$m;var y=f/i*(2*Go)-Go,x=2*(Math.atan(Math.exp(Go-p/i*(2*Go)))-xu);return[y*Gm,x*Gm]}function NS(a){var i=a.latitude;assert(Number.isFinite(i));var s=Math.cos(i*As);return qm(Ym*s)-9}function pP(a){var i=a.latitude,s=a.longitude,f=a.zoom,p=a.scale,y=a.highPrecision,x=y===void 0?!1:y;p=p!==void 0?p:Xm(f),rc(Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(p));var O={},A=$m*p,I=Math.cos(i*As),B=A/360,j=B/I,V=A/Ym/I;if(O.pixelsPerMeter=[V,-V,V],O.metersPerPixel=[1/V,-1/V,1/V],O.pixelsPerDegree=[B,-j,V],O.degreesPerPixel=[1/B,-1/j,1/V],x){var mt=As*Math.tan(i*As)/I,Bt=B*mt/2,Kt=A/Ym*mt,ue=Kt/j*V;O.pixelsPerDegree2=[0,-Bt,Kt],O.pixelsPerMeter2=[ue,0,ue]}return O}function gP(a,i){var s=_slicedToArray(a,3),f=s[0],p=s[1],y=s[2],x=_slicedToArray(i,3),O=x[0],A=x[1],I=x[2],B=1,j=pP({longitude:f,latitude:p,scale:B,highPrecision:!0}),V=j.pixelsPerMeter,mt=j.pixelsPerMeter2,Bt=Su(a,B);Bt[0]+=O*(V[0]+mt[0]*A),Bt[1]+=A*(V[1]+mt[1]*A);var Kt=DS(Bt,B),ue=(y||0)+(I||0);return Number.isFinite(y)||Number.isFinite(I)?[Kt[0],Kt[1],ue]:Kt}function FS(a){var i=a.height,s=a.pitch,f=a.bearing,p=a.altitude,y=a.center,x=y===void 0?null:y,O=a.flipY,A=O===void 0?!1:O,I=bu();return Zr.translate(I,I,[0,0,-p]),Zr.scale(I,I,[1,1,1/i]),Zr.rotateX(I,I,-s*As),Zr.rotateZ(I,I,f*As),A&&Zr.scale(I,I,[1,-1,1]),x&&Zr.translate(I,I,Tr.tk([],x)),I}function l8(a){var i=a.width,s=a.height,f=a.altitude,p=f===void 0?sa:f,y=a.pitch,x=y===void 0?0:y,O=a.nearZMultiplier,A=O===void 0?1:O,I=a.farZMultiplier,B=I===void 0?1:I,j=x*As,V=Math.atan(.5/p),mt=Math.sin(V)*p/Math.sin(Math.PI/2-j-V),Bt=Math.cos(Math.PI/2-j)*mt+p;return{fov:2*Math.atan(s/2/p),aspect:i/s,focalDistance:p,near:A,far:Bt*B}}function BS(a){var i=a.width,s=a.height,f=a.pitch,p=a.altitude,y=a.nearZMultiplier,x=a.farZMultiplier,O=l8({width:i,height:s,altitude:p,pitch:f,nearZMultiplier:y,farZMultiplier:x}),A=O.fov,I=O.aspect,B=O.near,j=O.far,V=Zr.perspective([],A,I,B,j);return V}function jS(a,i){var s=(0,Vo.Z)(a,3),f=s[0],p=s[1],y=s[2],x=y===void 0?0:y;return rc(Number.isFinite(f)&&Number.isFinite(p)&&Number.isFinite(x)),ud(i,[f,p,x,1])}function Km(a,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,f=(0,Vo.Z)(a,3),p=f[0],y=f[1],x=f[2];if(rc(Number.isFinite(p)&&Number.isFinite(y),"invalid pixel coordinate"),Number.isFinite(x)){var O=ud(i,[p,y,x,1]);return O}var A=ud(i,[p,y,0,1]),I=ud(i,[p,y,1,1]),B=A[2],j=I[2],V=B===j?0:((s||0)-B)/(j-B);return dr.t7([],A,I,V)}var Qm=bu(),zS=function(){function a(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.width,f=i.height,p=i.viewMatrix,y=p===void 0?Qm:p,x=i.projectionMatrix,O=x===void 0?Qm:x;(0,t0.Z)(this,a),this.width=s||1,this.height=f||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=y,this.projectionMatrix=O;var A=bu();Zr.multiply(A,A,this.projectionMatrix),Zr.multiply(A,A,this.viewMatrix),this.viewProjectionMatrix=A;var I=bu();Zr.scale(I,I,[this.width/2,-this.height/2,1]),Zr.translate(I,I,[1,-1,0]),Zr.multiply(I,I,this.viewProjectionMatrix);var B=Zr.invert(bu(),I);if(!B)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=I,this.pixelUnprojectionMatrix=B,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,ba.Z)(a,[{key:"equals",value:function(s){return s instanceof a?s.width===this.width&&s.height===this.height&&Zr.equals(s.projectionMatrix,this.projectionMatrix)&&Zr.equals(s.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=f.topLeft,y=p===void 0?!0:p,x=this.projectPosition(s),O=jS(x,this.pixelProjectionMatrix),A=(0,Vo.Z)(O,2),I=A[0],B=A[1],j=y?B:this.height-B;return s.length===2?[I,j]:[I,j,O[2]]}},{key:"unproject",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=f.topLeft,y=p===void 0?!0:p,x=f.targetZ,O=(0,Vo.Z)(s,3),A=O[0],I=O[1],B=O[2],j=y?I:this.height-I,V=x&&x*this.pixelsPerMeter,mt=Km([A,j,B],this.pixelUnprojectionMatrix,V),Bt=this.unprojectPosition(mt),Kt=(0,Vo.Z)(Bt,3),ue=Kt[0],Le=Kt[1],ke=Kt[2];return Number.isFinite(B)?[ue,Le,ke]:Number.isFinite(x)?[ue,Le,x]:[ue,Le]}},{key:"projectPosition",value:function(s){var f=this.projectFlat(s),p=(0,Vo.Z)(f,2),y=p[0],x=p[1],O=(s[2]||0)*this.pixelsPerMeter;return[y,x,O]}},{key:"unprojectPosition",value:function(s){var f=this.unprojectFlat(s),p=(0,Vo.Z)(f,2),y=p[0],x=p[1],O=(s[2]||0)/this.pixelsPerMeter;return[y,x,O]}},{key:"projectFlat",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}},{key:"unprojectFlat",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}}]),a}();function Jm(a){var i=a.width,s=a.height,f=a.bounds,p=a.minExtent,y=p===void 0?0:p,x=a.maxZoom,O=x===void 0?24:x,A=a.padding,I=A===void 0?0:A,B=a.offset,j=B===void 0?[0,0]:B,V=(0,Vo.Z)(f,2),mt=(0,Vo.Z)(V[0],2),Bt=mt[0],Kt=mt[1],ue=(0,Vo.Z)(V[1],2),Le=ue[0],ke=ue[1];if(Number.isFinite(I)){var He=I;I={top:He,bottom:He,left:He,right:He}}else rc(Number.isFinite(I.top)&&Number.isFinite(I.bottom)&&Number.isFinite(I.left)&&Number.isFinite(I.right));var Ye=new wu({width:i,height:s,longitude:0,latitude:0,zoom:0}),rn=Ye.project([Bt,ke]),bn=Ye.project([Le,Kt]),hn=[Math.max(Math.abs(bn[0]-rn[0]),y),Math.max(Math.abs(bn[1]-rn[1]),y)],Cn=[i-I.left-I.right-Math.abs(j[0])*2,s-I.top-I.bottom-Math.abs(j[1])*2];rc(Cn[0]>0&&Cn[1]>0);var Jn=Cn[0]/hn[0],cr=Cn[1]/hn[1],Gn=(I.right-I.left)/2/Jn,ar=(I.bottom-I.top)/2/cr,mr=[(bn[0]+rn[0])/2+Gn,(bn[1]+rn[1])/2+ar],po=Ye.unproject(mr),xa=Ye.zoom+Math.log2(Math.abs(Math.min(Jn,cr)));return{longitude:po[0],latitude:po[1],zoom:Math.min(xa,O)}}var wu=function(a){(0,Vm.Z)(i,a);function i(){var s,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=f.width,y=f.height,x=f.latitude,O=x===void 0?0:x,A=f.longitude,I=A===void 0?0:A,B=f.zoom,j=B===void 0?0:B,V=f.pitch,mt=V===void 0?0:V,Bt=f.bearing,Kt=Bt===void 0?0:Bt,ue=f.altitude,Le=ue===void 0?1.5:ue,ke=f.nearZMultiplier,He=f.farZMultiplier;(0,t0.Z)(this,i),p=p||1,y=y||1;var Ye=Xm(j);Le=Math.max(.75,Le);var rn=Su([I,O],Ye);rn[2]=0;var bn=BS({width:p,height:y,pitch:mt,bearing:Kt,altitude:Le,nearZMultiplier:ke||1/y,farZMultiplier:He||1.01}),hn=FS({height:y,center:rn,pitch:mt,bearing:Kt,altitude:Le,flipY:!0});return s=(0,Wm.Z)(this,(0,fP.Z)(i).call(this,{width:p,height:y,viewMatrix:hn,projectionMatrix:bn})),s.latitude=O,s.longitude=I,s.zoom=j,s.pitch=mt,s.bearing=Kt,s.altitude=Le,s.scale=Ye,s.center=rn,s.pixelsPerMeter=pP((0,ld.Z)((0,ld.Z)(s))).pixelsPerMeter[2],Object.freeze((0,ld.Z)((0,ld.Z)(s))),s}return(0,ba.Z)(i,[{key:"projectFlat",value:function(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Su(f,p)}},{key:"unprojectFlat",value:function(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return DS(f,p)}},{key:"getMapCenterByLngLatPosition",value:function(f){var p=f.lngLat,y=f.pos,x=Km(y,this.pixelUnprojectionMatrix),O=Su(p,this.scale),A=dr.IH([],O,dr.tk([],x)),I=dr.IH([],this.center,A);return DS(I,this.scale)}},{key:"getLocationAtPoint",value:function(f){var p=f.lngLat,y=f.pos;return this.getMapCenterByLngLatPosition({lngLat:p,pos:y})}},{key:"fitBounds",value:function(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=this.width,x=this.height,O=Jm(Object.assign({width:y,height:x,bounds:f},p)),A=O.longitude,I=O.latitude,B=O.zoom;return new i({width:y,height:x,longitude:A,latitude:I,zoom:B})}}]),i}(zS);class US{constructor(){(0,ot.Z)(this,"viewport",new wu)}syncWithMapCamera(i){const{center:s,zoom:f,pitch:p,bearing:y,viewportHeight:x,viewportWidth:O}=i,A={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new wu((0,on.Z)((0,on.Z)({},A),{},{width:O,height:x,longitude:s&&s[0],latitude:s&&s[1],zoom:f,pitch:p,bearing:y}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(i,s){return this.viewport.projectFlat(i,s)}}var ZS=L(99874),HS=L.n(ZS);const vP={number:function(i,s,f){return i+f*(s-i)}};function u8(a,i,s){return Math.min(s,Math.max(i,a))}function mP(a,i,s){const f=s-i,p=((a-i)%f+f)%f+i;return p===i?s:p}let e0=1;function yP(){return e0++}function fd(a,...i){for(const s of i)for(const f in s)a[f]=s[f];return a}function _P(a,i){const s={};for(let f=0;f<i.length;f++){const p=i[f];p in a&&(s[p]=a[p])}return s}function ty(a,i,s,f){const p=new(HS())(a,i,s,f);return y=>p.solve(y)}const bP=ty(.25,.1,.25,1),ey={};function f8(a){ey[a]||(typeof console!="undefined"&&console.warn(a),ey[a]=!0)}function d8(a){return a*Math.PI/180}function ny(a,i,s){s[a]&&s[a].indexOf(i)!==-1||(s[a]=s[a]||[],s[a].push(i))}function n0(a,i,s){if(s&&s[a]){const f=s[a].indexOf(i);f!==-1&&s[a].splice(f,1)}}class ry{constructor(i,s={}){_defineProperty(this,"type",void 0),extend(this,s),this.type=i}}class WS extends null{constructor(i,s={}){super("error",s),_defineProperty(this,"error",void 0),this.error=i}}class h8{constructor(){_defineProperty(this,"_listeners",void 0),_defineProperty(this,"_oneTimeListeners",void 0),_defineProperty(this,"_eventedParent",void 0),_defineProperty(this,"_eventedParentData",void 0)}on(i,s){return this._listeners=this._listeners||{},ny(i,s,this._listeners),this}off(i,s){return n0(i,s,this._listeners),n0(i,s,this._oneTimeListeners),this}once(i,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},ny(i,s,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,s){typeof i=="string"&&(i=new ry(i,s||{}));const f=i.type;if(this.listens(f)){i.target=this;const p=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const O of p)O.call(this,i);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const O of y)n0(f,O,this._oneTimeListeners),O.call(this,i);const x=this._eventedParent;x&&(extend(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof WS&&console.error(i.error);return this}emit(i,s){return this.fire(i,s)}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,s){return i&&(this._eventedParent=i),this._eventedParentData=s,this}}var xP=L(75550),VS=L.n(xP),iy;class qr{static testProp(i){if(!qr.docStyle)return i[0];for(let s=0;s<i.length;s++)if(i[s]in qr.docStyle)return i[s];return i[0]}static create(i,s,f){const p=window.document.createElement(i);return s!==void 0&&(p.className=s),f&&f.appendChild(p),p}static createNS(i,s){return window.document.createElementNS(i,s)}static disableDrag(){qr.docStyle&&qr.selectProp&&(qr.userSelect=qr.docStyle[qr.selectProp],qr.docStyle[qr.selectProp]="none")}static enableDrag(){qr.docStyle&&qr.selectProp&&(qr.docStyle[qr.selectProp]=qr.userSelect)}static setTransform(i,s){i.style[qr.transformProp]=s}static addEventListener(i,s,f,p={}){"passive"in p?i.addEventListener(s,f,p):i.addEventListener(s,f,p.capture)}static removeEventListener(i,s,f,p={}){"passive"in p?i.removeEventListener(s,f,p):i.removeEventListener(s,f,p.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",qr.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",qr.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",qr.suppressClickInternal,!0)},0)}static getScale(i){const s=i.getBoundingClientRect();return{x:s.width/i.offsetWidth||1,y:s.height/i.offsetHeight||1,boundingClientRect:s}}static getPoint(i,s,f){const p=s.boundingClientRect;return new(VS())((f.clientX-p.left)/s.x-i.clientLeft,(f.clientY-p.top)/s.y-i.clientTop)}static mousePos(i,s){const f=qr.getScale(i);return qr.getPoint(i,f,s)}static touchPos(i,s){const f=[],p=qr.getScale(i);for(let y=0;y<s.length;y++)f.push(qr.getPoint(i,p,s[y]));return f}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}iy=qr,(0,ot.Z)(qr,"docStyle",typeof window!="undefined"&&window.document&&window.document.documentElement.style),(0,ot.Z)(qr,"userSelect",void 0),(0,ot.Z)(qr,"selectProp",iy.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"])),(0,ot.Z)(qr,"transformProp",iy.testProp(["transform","WebkitTransform"]));class gr{constructor(i){(0,ot.Z)(this,"size",1e4),this.size=i||1e4}setSize(i){this.size=i}getSize(){return[this.size,this.size]}mercatorXfromLng(i){return(180+i)/360*this.size}mercatorYfromLat(i){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360)*this.size}lngFromMercatorX(i){return i/this.size*360-180}latFromMercatorY(i){const s=180-(1-i/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}project(i){const s=this.mercatorXfromLng(i[0]),f=this.mercatorYfromLat(i[1]);return[s,f]}unproject(i){const s=this.lngFromMercatorX(i[0]),f=this.latFromMercatorY(i[1]);return[s,f]}}class GS extends null{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,f,p={}){super(i,p),_defineProperty(this,"target",void 0),_defineProperty(this,"originalEvent",void 0),_defineProperty(this,"point",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"_defaultPrevented",void 0);const y=DOM.mousePos(s.getCanvasContainer(),f),x=s.unproject(y);if(this.point=y,this.lngLat=x,this.originalEvent=f,this._defaultPrevented=!1,this.target=s,s.version==="SIMPLE"){const O=new SimpleMapCoord(s.mapSize),[A,I]=O.project([x.lng,x.lat]);this.lngLat={lng:A,lat:I}}}}class $S extends null{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,f){super(i),_defineProperty(this,"target",void 0),_defineProperty(this,"originalEvent",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"point",void 0),_defineProperty(this,"points",void 0),_defineProperty(this,"lngLats",void 0),_defineProperty(this,"_defaultPrevented",void 0);const p=i==="touchend"?f.changedTouches:f.touches,y=DOM.touchPos(s.getCanvasContainer(),p),x=y.map(I=>s.unproject(I)),O=y.reduce((I,B,j,V)=>I.add(B.div(V.length)),new Point(0,0)),A=s.unproject(O);this.target=s,this.points=y,this.point=O,this.lngLats=x,this.lngLat=A,this.originalEvent=f,this._defaultPrevented=!1}}class YS extends null{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,f){super(i),_defineProperty(this,"target",void 0),_defineProperty(this,"originalEvent",void 0),_defineProperty(this,"_defaultPrevented",void 0),this.target=s,this._defaultPrevented=!1,this.originalEvent=f}}const r0=63710088e-1;class il{constructor(i,s){if(_defineProperty(this,"lng",void 0),_defineProperty(this,"lat",void 0),isNaN(i)||isNaN(s))throw new Error(`Invalid LngLat object: (${i}, ${s})`);if(this.lng=+i,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new il(wrap(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const s=Math.PI/180,f=this.lat*s,p=i.lat*s,y=Math.sin(f)*Math.sin(p)+Math.cos(f)*Math.cos(p)*Math.cos((i.lng-this.lng)*s);return r0*Math.acos(Math.min(y,1))}static convert(i){if(i instanceof il)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new il(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new il(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const i0=2*Math.PI*r0;function o0(a){return i0*Math.cos(a*Math.PI/180)}function SP(a){return(180+a)/360}function XS(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function a0(a,i){return a/o0(i)}function oy(a){return a*360-180}function dd(a){const i=180-a*360;return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90}function ay(a,i){return a*o0(dd(i))}function sy(a){return 1/Math.cos(a*Math.PI/180)}class s0{constructor(i,s,f=0){_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),_defineProperty(this,"z",void 0),this.x=+i,this.y=+s,this.z=+f}static fromLngLat(i,s=0){const f=LngLat.convert(i);return new s0(SP(f.lng),XS(f.lat),a0(s,f.lat))}toLngLat(){return new LngLat(oy(this.x),dd(this.y))}toAltitude(){return ay(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/i0*sy(dd(this.y))}}class ic{constructor(i,s){_defineProperty(this,"_ne",void 0),_defineProperty(this,"_sw",void 0),i&&(s?this.setSouthWest(i).setNorthEast(s):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof LngLat?new LngLat(i.lng,i.lat):LngLat.convert(i),this}setSouthWest(i){return this._sw=i instanceof LngLat?new LngLat(i.lng,i.lat):LngLat.convert(i),this}extend(i){const s=this._sw,f=this._ne;let p,y;if(i instanceof LngLat)p=i,y=i;else if(i instanceof ic){if(p=i._sw,y=i._ne,!p||!y)return this}else{if(Array.isArray(i))if(i.length===4||i.every(Array.isArray)){const x=i;return this.extend(ic.convert(x))}else{const x=i;return this.extend(LngLat.convert(x))}else if(i&&("lng"in i||"lon"in i)&&"lat"in i)return this.extend(LngLat.convert(i));return this}return!s&&!f?(this._sw=new LngLat(p.lng,p.lat),this._ne=new LngLat(y.lng,y.lat)):(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),f.lng=Math.max(y.lng,f.lng),f.lat=Math.max(y.lat,f.lat)),this}getCenter(){return new LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:s,lat:f}=LngLat.convert(i),p=this._sw.lat<=f&&f<=this._ne.lat;let y=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=s&&s>=this._ne.lng),p&&y}static convert(i){return i instanceof ic?i:new ic(i)}static fromLngLat(i,s=0){const p=360*s/40075017,y=p/Math.cos(Math.PI/180*i.lat);return new ic(new LngLat(i.lng-y,i.lat-p),new LngLat(i.lng+y,i.lat+p))}}const c0="AbortError";function qS(a){return a.message===c0}function cy(){return new Error(c0)}const ly=typeof performance!="undefined"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date);let hd;const KS={now:ly,frameAsync(a){return new Promise((i,s)=>{const f=requestAnimationFrame(i);a.signal.addEventListener("abort",()=>{cancelAnimationFrame(f),s(cy())})})},get prefersReducedMotion(){return window.matchMedia?(hd==null&&(hd=window.matchMedia("(prefers-reduced-motion: reduce)")),hd.matches):!1}};class QS extends null{constructor(i,s){super(),_defineProperty(this,"transform",void 0),_defineProperty(this,"handlers",void 0),_defineProperty(this,"_moving",void 0),_defineProperty(this,"_zooming",void 0),_defineProperty(this,"_rotating",void 0),_defineProperty(this,"_pitching",void 0),_defineProperty(this,"_padding",void 0),_defineProperty(this,"_bearingSnap",void 0),_defineProperty(this,"_easeStart",void 0),_defineProperty(this,"_easeOptions",void 0),_defineProperty(this,"_easeId",void 0),_defineProperty(this,"_onEaseFrame",void 0),_defineProperty(this,"_onEaseEnd",void 0),_defineProperty(this,"_easeFrameId",void 0),_defineProperty(this,"_requestedCameraState",void 0),_defineProperty(this,"transformCameraUpdate",void 0),_defineProperty(this,"_renderFrameCallback",()=>{const f=Math.min((browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,s){return this.jumpTo({center:i},s)}panBy(i,s,f){return i=Point.convert(i).mult(-1),this.panTo(this.transform.center,extend({offset:i},s),f)}panTo(i,s,f){return this.easeTo(extend({center:i},s),f)}getZoom(){return this.transform.zoom}setZoom(i,s){return this.jumpTo({zoom:i},s),this}zoomTo(i,s,f){return this.easeTo(extend({zoom:i},s),f)}zoomIn(i,s){return this.zoomTo(this.getZoom()+1,i,s),this}zoomOut(i,s){return this.zoomTo(this.getZoom()-1,i,s),this}getBearing(){return this.transform.bearing}setBearing(i,s){return this.jumpTo({bearing:i},s),this}getPadding(){return this.transform.padding}setPadding(i,s){return this.jumpTo({padding:i},s),this}rotateTo(i,s,f){return this.easeTo(extend({bearing:i},s),f)}resetNorth(i,s){return this.rotateTo(0,extend({duration:1e3},i),s),this}resetNorthPitch(i,s){return this.easeTo(extend({bearing:0,pitch:0,duration:1e3},i),s),this}snapToNorth(i,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,s):this}getPitch(){return this.transform.pitch}setPitch(i,s){return this.jumpTo({pitch:i},s),this}cameraForBounds(i,s){i=LngLatBounds.convert(i);const f=s&&s.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,s)}_cameraForBoxAndBearing(i,s,f,p){const y={top:0,bottom:0,right:0,left:0};if(p=extend({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},p),typeof p.padding=="number"){const go=p.padding;p.padding={top:go,bottom:go,right:go,left:go}}p.padding=extend(y,p.padding);const x=this.transform,O=x.padding,A=new LngLatBounds(i,s),I=x.project(A.getNorthWest()),B=x.project(A.getNorthEast()),j=x.project(A.getSouthEast()),V=x.project(A.getSouthWest()),mt=degreesToRadians(-f),Bt=I.rotate(mt),Kt=B.rotate(mt),ue=j.rotate(mt),Le=V.rotate(mt),ke=new Point(Math.max(Bt.x,Kt.x,Le.x,ue.x),Math.max(Bt.y,Kt.y,Le.y,ue.y)),He=new Point(Math.min(Bt.x,Kt.x,Le.x,ue.x),Math.min(Bt.y,Kt.y,Le.y,ue.y)),Ye=ke.sub(He),rn=(x.width-(O.left+O.right+p.padding.left+p.padding.right))/Ye.x,bn=(x.height-(O.top+O.bottom+p.padding.top+p.padding.bottom))/Ye.y;if(bn<0||rn<0){warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}const hn=Math.min(x.scaleZoom(x.scale*Math.min(rn,bn)),p.maxZoom),Cn=Point.convert(p.offset),Jn=(p.padding.left-p.padding.right)/2,cr=(p.padding.top-p.padding.bottom)/2,ar=new Point(Jn,cr).rotate(degreesToRadians(f)),po=Cn.add(ar).mult(x.scale/x.zoomScale(hn));return{center:x.unproject(I.add(j).div(2).sub(po)),zoom:hn,bearing:f}}fitBounds(i,s,f){return this._fitInternal(this.cameraForBounds(i,s),s,f)}fitScreenCoordinates(i,s,f,p,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Point.convert(i)),this.transform.pointLocation(Point.convert(s)),f,p),p,y)}_fitInternal(i,s,f){return i?(s=extend(i,s),delete s.padding,s.linear?this.easeTo(s,f):this.flyTo(s,f)):this}jumpTo(i,s){this.stop();const f=this._getTransformForUpdate();let p=!1,y=!1,x=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(p=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(y=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(x=!0,f.pitch=+i.pitch),i.padding!=null&&!f.isPaddingEqual(i.padding)&&(f.padding=i.padding),this._applyUpdatedTransform(f),this.fire(new Event("movestart",s)).fire(new Event("move",s)),p&&this.fire(new Event("zoomstart",s)).fire(new Event("zoom",s)).fire(new Event("zoomend",s)),y&&this.fire(new Event("rotatestart",s)).fire(new Event("rotate",s)).fire(new Event("rotateend",s)),x&&this.fire(new Event("pitchstart",s)).fire(new Event("pitch",s)).fire(new Event("pitchend",s)),this.fire(new Event("moveend",s))}calculateCameraOptionsFromTo(i,s,f,p=0){const y=MercatorCoordinate.fromLngLat(i,s),x=MercatorCoordinate.fromLngLat(f,p),O=x.x-y.x,A=x.y-y.y,I=x.z-y.z,B=Math.hypot(O,A,I);if(B===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(O,A),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),mt=Math.atan2(O,-A)*180/Math.PI;let Bt=Math.acos(j/B)*180/Math.PI;return Bt=I<0?90-Bt:90+Bt,{center:x.toLngLat(),zoom:V,pitch:Bt,bearing:mt}}easeTo(i,s){var f;this._stop(!1,i.easeId),i=extend({offset:[0,0],duration:500,easing:defaultEasing},i),(i.animate===!1||!i.essential&&browser.prefersReducedMotion)&&(i.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),x=this.getBearing(),O=this.getPitch(),A=this.getPadding(),I="bearing"in i?this._normalizeBearing(i.bearing,x):x,B="pitch"in i?+i.pitch:O,j="padding"in i?i.padding:p.padding,V=Point.convert(i.offset);let mt=p.centerPoint.add(V);const Bt=p.pointLocation(mt),{center:Kt,zoom:ue}=p.getConstrained(LngLat.convert(i.center||Bt),(f=i.zoom)!==null&&f!==void 0?f:y);this._normalizeCenter(Kt);const Le=p.project(Bt),ke=p.project(Kt).sub(Le),He=p.zoomScale(ue-y);let Ye,rn;i.around&&(Ye=LngLat.convert(i.around),rn=p.locationPoint(Ye));const bn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ue!==y,this._rotating=this._rotating||x!==I,this._pitching=this._pitching||B!==O,this._padding=!p.isPaddingEqual(j),this._easeId=i.easeId,this._prepareEase(s,i.noMoveStart,bn),this._ease(hn=>{if(this._zooming&&(p.zoom=interpolates.number(y,ue,hn)),this._rotating&&(p.bearing=interpolates.number(x,I,hn)),this._pitching&&(p.pitch=interpolates.number(O,B,hn)),this._padding&&(p.interpolatePadding(A,j,hn),mt=p.centerPoint.add(V)),Ye)p.setLocationAtPoint(Ye,rn);else{const Cn=p.zoomScale(p.zoom-y),Jn=ue>y?Math.min(2,He):Math.max(.5,He),cr=Math.pow(Jn,1-hn),Gn=p.unproject(Le.add(ke.mult(hn*cr)).mult(Cn));p.setLocationAtPoint(p.renderWorldCopies?Gn.wrap():Gn,mt)}this._applyUpdatedTransform(p),this._fireMoveEvents(s)},hn=>{this._afterEase(s,hn)},i),this}_prepareEase(i,s,f={}){this._moving=!0,!s&&!f.moving&&this.fire(new Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new Event("pitchstart",i))}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(i){if(!this.transformCameraUpdate)return;const s=i.clone(),{center:f,zoom:p,pitch:y,bearing:x,elevation:O}=this.transformCameraUpdate(s);f&&(s.center=f),p!==void 0&&(s.zoom=p),y!==void 0&&(s.pitch=y),x!==void 0&&(s.bearing=x),O!==void 0&&(s.elevation=O),this.transform.apply(s)}_fireMoveEvents(i){this.fire(new Event("move",i)),this._zooming&&this.fire(new Event("zoom",i)),this._rotating&&this.fire(new Event("rotate",i)),this._pitching&&this.fire(new Event("pitch",i))}_afterEase(i,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const f=this._zooming,p=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new Event("zoomend",i)),p&&this.fire(new Event("rotateend",i)),y&&this.fire(new Event("pitchend",i)),this.fire(new Event("moveend",i))}flyTo(i,s){var f;if(!i.essential&&browser.prefersReducedMotion){const xr=pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(xr,s)}this.stop(),i=extend({offset:[0,0],speed:1.2,curve:1.42,easing:defaultEasing},i);const p=this._getTransformForUpdate(),y=this.getZoom(),x=this.getBearing(),O=this.getPitch(),A=this.getPadding(),I="bearing"in i?this._normalizeBearing(i.bearing,x):x,B="pitch"in i?+i.pitch:O,j="padding"in i?i.padding:p.padding,V=Point.convert(i.offset);let mt=p.centerPoint.add(V);const Bt=p.pointLocation(mt),{center:Kt,zoom:ue}=p.getConstrained(LngLat.convert(i.center||Bt),(f=i.zoom)!==null&&f!==void 0?f:y);this._normalizeCenter(Kt);const Le=p.zoomScale(ue-y),ke=p.project(Bt),He=p.project(Kt).sub(ke);let Ye=i.curve;const rn=Math.max(p.width,p.height),bn=rn/Le,hn=He.mag();if("minZoom"in i){const xr=clamp(Math.min(i.minZoom,y,ue),p.minZoom,p.maxZoom),vo=rn/p.zoomScale(xr-y);Ye=Math.sqrt(vo/hn*2)}const Cn=Ye*Ye;function Jn(xr){const vo=(bn*bn-rn*rn+(xr?-1:1)*Cn*Cn*hn*hn)/(2*(xr?bn:rn)*Cn*hn);return Math.log(Math.sqrt(vo*vo+1)-vo)}function cr(xr){return(Math.exp(xr)-Math.exp(-xr))/2}function Gn(xr){return(Math.exp(xr)+Math.exp(-xr))/2}function ar(xr){return cr(xr)/Gn(xr)}const mr=Jn(!1);let po=function(xr){return Gn(mr)/Gn(mr+Ye*xr)},xa=function(xr){return rn*((Gn(mr)*ar(mr+Ye*xr)-cr(mr))/Cn)/hn},go=(Jn(!0)-mr)/Ye;if(Math.abs(hn)<1e-6||!isFinite(go)){if(Math.abs(rn-bn)<1e-6)return this.easeTo(i,s);const xr=bn<rn?-1:1;go=Math.abs(Math.log(bn/rn))/Ye,xa=()=>0,po=vo=>Math.exp(xr*Ye*vo)}if("duration"in i)i.duration=+i.duration;else{const xr="screenSpeed"in i?+i.screenSpeed/Ye:+i.speed;i.duration=1e3*go/xr}return i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=x!==I,this._pitching=B!==O,this._padding=!p.isPaddingEqual(j),this._prepareEase(s,!1),this._ease(xr=>{const vo=xr*go,Io=1/po(vo);p.zoom=xr===1?ue:y+p.scaleZoom(Io),this._rotating&&(p.bearing=interpolates.number(x,I,xr)),this._pitching&&(p.pitch=interpolates.number(O,B,xr)),this._padding&&(p.interpolatePadding(A,j,xr),mt=p.centerPoint.add(V));const p0=xr===1?Kt:p.unproject(ke.add(He.mult(xa(vo))).mult(Io));p.setLocationAtPoint(p.renderWorldCopies?p0.wrap():p0,mt),this._applyUpdatedTransform(p),this._fireMoveEvents(s)},()=>{this._afterEase(s)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,s)}if(!i){var f;(f=this.handlers)===null||f===void 0||f.stop(!1)}return this}_ease(i,s,f){f.animate===!1||f.duration===0?(i(1),s()):(this._easeStart=browser.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,s){i=wrap(i,-180,180);const f=Math.abs(i-s);return Math.abs(i-360-s)<f&&(i-=360),Math.abs(i+360-s)<f&&(i+=360),i}_normalizeCenter(i){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const f=i.lng-s.center.lng;i.lng+=f>180?-360:f<-180?360:0}}class Ou{constructor(i=0,s=0,f=0,p=0){if(_defineProperty(this,"top",void 0),_defineProperty(this,"bottom",void 0),_defineProperty(this,"left",void 0),_defineProperty(this,"right",void 0),isNaN(i)||i<0||isNaN(s)||s<0||isNaN(f)||f<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=s,this.left=f,this.right=p}interpolate(i,s,f){return s.top!=null&&i.top!=null&&(this.top=interpolates.number(i.top,s.top,f)),s.bottom!=null&&i.bottom!=null&&(this.bottom=interpolates.number(i.bottom,s.bottom,f)),s.left!=null&&i.left!=null&&(this.left=interpolates.number(i.left,s.left,f)),s.right!=null&&i.right!=null&&(this.right=interpolates.number(i.right,s.right,f)),this}getCenter(i,s){const f=clamp((this.left+i-this.right)/2,0,i),p=clamp((this.top+s-this.bottom)/2,0,s);return new Point(f,p)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ou(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Eu=85.051129;class uy{constructor(i,s,f,p,y){_defineProperty(this,"tileSize",void 0),_defineProperty(this,"tileZoom",void 0),_defineProperty(this,"lngRange",void 0),_defineProperty(this,"latRange",void 0),_defineProperty(this,"scale",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),_defineProperty(this,"angle",void 0),_defineProperty(this,"rotationMatrix",void 0),_defineProperty(this,"pixelsToGLUnits",void 0),_defineProperty(this,"cameraToCenterDistance",void 0),_defineProperty(this,"mercatorMatrix",void 0),_defineProperty(this,"projMatrix",void 0),_defineProperty(this,"invProjMatrix",void 0),_defineProperty(this,"alignedProjMatrix",void 0),_defineProperty(this,"pixelMatrix",void 0),_defineProperty(this,"pixelMatrix3D",void 0),_defineProperty(this,"pixelMatrixInverse",void 0),_defineProperty(this,"glCoordMatrix",void 0),_defineProperty(this,"labelPlaneMatrix",void 0),_defineProperty(this,"minElevationForCurrentTile",void 0),_defineProperty(this,"_fov",void 0),_defineProperty(this,"_pitch",void 0),_defineProperty(this,"_zoom",void 0),_defineProperty(this,"_unmodified",void 0),_defineProperty(this,"_renderWorldCopies",void 0),_defineProperty(this,"_minZoom",void 0),_defineProperty(this,"_maxZoom",void 0),_defineProperty(this,"_minPitch",void 0),_defineProperty(this,"_maxPitch",void 0),_defineProperty(this,"_center",void 0),_defineProperty(this,"_elevation",void 0),_defineProperty(this,"_pixelPerMeter",void 0),_defineProperty(this,"_edgeInsets",void 0),_defineProperty(this,"_constraining",void 0),_defineProperty(this,"_posMatrixCache",void 0),_defineProperty(this,"_alignedPosMatrixCache",void 0),this.tileSize=512,this._renderWorldCopies=y===void 0?!0:!!y,this._minZoom=i||0,this._maxZoom=s||22,this._minPitch=f==null?0:f,this._maxPitch=p==null?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new EdgeInsets,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new uy(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const s=-wrap(i,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=mat2.create(),mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const s=clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const s=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,s,f){this._unmodified=!1,this._edgeInsets.interpolate(i,s,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const s=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,s)}resize(i,s){this.width=i,this.height=s,this.pixelsToGLUnits=[2/i,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const s=clamp(i.lat,-Eu,Eu);return new Point(mercatorXfromLng(i.lng)*this.worldSize,mercatorYfromLat(s)*this.worldSize)}unproject(i){return new MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){const i=this.pointLocation(this.getCameraPoint()),s=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:i,altitude:s+this.elevation}}setLocationAtPoint(i,s){const f=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(i),x=new MercatorCoordinate(y.x-(f.x-p.x),y.y-(f.y-p.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i){return this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}locationCoordinate(i){return MercatorCoordinate.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i){const f=[i.x,i.y,0,1],p=[i.x,i.y,1,1];vec4.transformMat4(f,f,this.pixelMatrixInverse),vec4.transformMat4(p,p,this.pixelMatrixInverse);const y=f[3],x=p[3],O=f[0]/y,A=p[0]/x,I=f[1]/y,B=p[1]/x,j=f[2]/y,V=p[2]/x,mt=j===V?0:(0-j)/(V-j);return new MercatorCoordinate(interpolates.number(O,A,mt)/this.worldSize,interpolates.number(I,B,mt)/this.worldSize)}coordinatePoint(i,s=0,f=this.pixelMatrix){const p=[i.x*this.worldSize,i.y*this.worldSize,s,1];return vec4.transformMat4(p,p,f),new Point(p[0]/p[3],p[1]/p[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new LngLatBounds().extend(this.pointLocation(new Point(0,i))).extend(this.pointLocation(new Point(this.width,i))).extend(this.pointLocation(new Point(this.width,this.height))).extend(this.pointLocation(new Point(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-Eu,Eu])}customLayerMatrix(){return mat4.clone(this.mercatorMatrix)}getConstrained(i,s){s=clamp(+s,this.minZoom,this.maxZoom);const f={center:new LngLat(i.lng,i.lat),zoom:s};let p=this.lngRange;if(!this._renderWorldCopies&&p===null){const rn=179.9999999999;p=[-rn,rn]}const y=this.tileSize*this.zoomScale(f.zoom);let x=0,O=y,A=0,I=y,B=0,j=0;const{x:V,y:mt}=this.size;if(this.latRange){const rn=this.latRange;x=mercatorYfromLat(rn[1])*y,O=mercatorYfromLat(rn[0])*y,O-x<mt&&(B=mt/(O-x))}p&&(A=wrap(mercatorXfromLng(p[0])*y,0,y),I=wrap(mercatorXfromLng(p[1])*y,0,y),I<A&&(I+=y),I-A<V&&(j=V/(I-A)));const{x:Bt,y:Kt}=this.project.call({worldSize:y},i);let ue,Le;const ke=Math.max(j||0,B||0);if(ke){const rn=new Point(j?(I+A)/2:Bt,B?(O+x)/2:Kt);return f.center=this.unproject.call({worldSize:y},rn).wrap(),f.zoom+=this.scaleZoom(ke),f}if(this.latRange){const rn=mt/2;Kt-rn<x&&(Le=x+rn),Kt+rn>O&&(Le=O-rn)}if(p){const rn=(A+I)/2;let bn=Bt;this._renderWorldCopies&&(bn=wrap(Bt,rn-y/2,rn+y/2));const hn=V/2;bn-hn<A&&(ue=A+hn),bn+hn>I&&(ue=I-hn)}if(ue!==void 0||Le!==void 0){var He,Ye;const rn=new Point((He=ue)!==null&&He!==void 0?He:Bt,(Ye=Le)!==null&&Ye!==void 0?Ye:Kt);f.center=this.unproject.call({worldSize:y},rn).wrap()}return f}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:s,zoom:f}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=f,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this._fov/2,s=this.centerOffset,f=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(i)*this.height,this._pixelPerMeter=mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let y=mat4.identity(new Float64Array(16));mat4.scale(y,y,[this.width/2,-this.height/2,1]),mat4.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=mat4.identity(new Float64Array(16)),mat4.scale(y,y,[1,-1,1]),mat4.translate(y,y,[-1,-1,0]),mat4.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const x=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),O=Math.min(this.elevation,this.minElevationForCurrentTile),A=x-O*this._pixelPerMeter/Math.cos(this._pitch),I=O<0?A:x,B=Math.PI/2+this._pitch,j=this._fov*(.5+s.y/this.height),V=Math.sin(j)*I/Math.sin(clamp(Math.PI-B-j,.01,Math.PI-.01)),mt=this.getHorizon(),Kt=2*Math.atan(mt/this.cameraToCenterDistance)*(.5+s.y/(mt*2)),ue=Math.sin(Kt)*I/Math.sin(clamp(Math.PI-B-Kt,.01,Math.PI-.01)),Le=Math.min(V,ue),ke=(Math.cos(Math.PI/2-this._pitch)*Le+I)*1.01,He=this.height/50;y=new Float64Array(16),mat4.perspective(y,this._fov,this.width/this.height,He,ke),y[8]=-s.x*2/this.width,y[9]=s.y*2/this.height,mat4.scale(y,y,[1,-1,1]),mat4.translate(y,y,[0,0,-this.cameraToCenterDistance]),mat4.rotateX(y,y,this._pitch),mat4.rotateZ(y,y,this.angle),mat4.translate(y,y,[-f,-p,0]),this.mercatorMatrix=mat4.scale([],y,[this.worldSize,this.worldSize,this.worldSize]),mat4.scale(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,y),mat4.translate(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=mat4.invert([],y),this.pixelMatrix3D=mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,y);const Ye=this.width%2/2,rn=this.height%2/2,bn=Math.cos(this.angle),hn=Math.sin(this.angle),Cn=f-Math.round(f)+bn*Ye+hn*rn,Jn=p-Math.round(p)+bn*rn+hn*Ye,cr=new Float64Array(y);if(mat4.translate(cr,cr,[Cn>.5?Cn-1:Cn,Jn>.5?Jn-1:Jn,0]),this.alignedProjMatrix=cr,y=mat4.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new Point(0,0)),s=[i.x*this.worldSize,i.y*this.worldSize,0,1];return vec4.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=this._pitch,s=Math.tan(i)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Point(0,s))}getCameraQueryGeometry(i){const s=this.getCameraPoint();if(i.length===1)return[i[0],s];{let f=s.x,p=s.y,y=s.x,x=s.y;for(const O of i)f=Math.min(f,O.x),p=Math.min(p,O.y),y=Math.max(y,O.x),x=Math.max(x,O.y);return[new Point(f,p),new Point(y,p),new Point(y,x),new Point(f,x),new Point(f,p)]}}lngLatToCameraDepth(i,s){const f=this.locationCoordinate(i),p=[f.x*this.worldSize,f.y*this.worldSize,s,1];return vec4.transformMat4(p,p,this.projMatrix),p[2]/p[3]}}class wP{constructor(i){_defineProperty(this,"_map",void 0),this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(Point.convert(i))}}class OP{constructor(i,s){_defineProperty(this,"_map",void 0),_defineProperty(this,"_tr",void 0),_defineProperty(this,"_el",void 0),_defineProperty(this,"_container",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_startPos",void 0),_defineProperty(this,"_lastPos",void 0),_defineProperty(this,"_box",void 0),_defineProperty(this,"_clickTolerance",void 0),this._map=i,this._tr=new TransformProvider(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,s){this.isEnabled()&&i.shiftKey&&i.button===0&&(DOM.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(i,s){if(!this._active)return;const f=s;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=f,this._box||(this._box=DOM.create("div","l7-boxzoom",this._container),this._container.classList.add("l7-crosshair"),this._fireEvent("boxzoomstart",i));const y=Math.min(p.x,f.x),x=Math.max(p.x,f.x),O=Math.min(p.y,f.y),A=Math.max(p.y,f.y);DOM.setTransform(this._box,`translate(${y}px,${O}px)`),this._box.style.width=`${x-y}px`,this._box.style.height=`${A-O}px`}mouseupWindow(i,s){if(!this._active||i.button!==0)return;const f=this._startPos,p=s;if(this.reset(),DOM.suppressClick(),f.x===p.x&&f.y===p.y)this._fireEvent("boxzoomcancel",i);else return this._map.fire(new Event("boxzoomend",{originalEvent:i})),{cameraAnimation:y=>y.fitScreenCoordinates(f,p,this._tr.bearing,{linear:!0})}}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("l7-crosshair"),this._box&&(DOM.remove(this._box),this._box=null),DOM.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,s){return this._map.fire(new Event(i,{originalEvent:s}))}}class JS{constructor(i){_defineProperty(this,"_tr",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),this._tr=new TransformProvider(i),this.reset()}reset(){this._active=!1}dblclick(i,s){return i.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class p8{constructor(i,s){_defineProperty(this,"_options",void 0),_defineProperty(this,"_map",void 0),_defineProperty(this,"_container",void 0),_defineProperty(this,"_bypassKey",navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey"),_defineProperty(this,"_enabled",void 0),this._map=i,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("l7-cooperative-gestures"),this._container=DOM.create("div","l7-cooperative-gesture-screen",i);const s=document.createElement("div");s.className="l7-desktop-message",s.textContent="Missing UI string",this._container.appendChild(s);const f=document.createElement("div");f.className="l7-mobile-message",f.textContent="Missing UI string",this._container.appendChild(f),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(DOM.remove(this._container),this._map.getCanvasContainer().classList.remove("l7-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(i){this._onCooperativeGesture(i.touches.length===1)}wheel(i){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!i[this._bypassKey])}_onCooperativeGesture(i){!this._enabled||!i||(this._container.classList.add("l7-show"),setTimeout(()=>{this._container.classList.remove("l7-show")},100))}}const EP={panStep:100,bearingStep:15,pitchStep:10};class g8{constructor(i){_defineProperty(this,"_tr",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_panStep",void 0),_defineProperty(this,"_bearingStep",void 0),_defineProperty(this,"_pitchStep",void 0),_defineProperty(this,"_rotationDisabled",void 0),this._tr=new TransformProvider(i);const s=EP;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let s=0,f=0,p=0,y=0,x=0;switch(i.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:i.shiftKey?f=-1:(i.preventDefault(),y=-1);break;case 39:i.shiftKey?f=1:(i.preventDefault(),y=1);break;case 38:i.shiftKey?p=1:(i.preventDefault(),x=-1);break;case 40:i.shiftKey?p=-1:(i.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(f=0,p=0),{cameraAnimation:O=>{const A=this._tr;O.easeTo({duration:300,easeId:"keyboardHandler",easing:tw,zoom:s?Math.round(A.zoom)+s*(i.shiftKey?2:1):A.zoom,bearing:A.bearing+f*this._bearingStep,pitch:A.pitch+p*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:A.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tw(a){return a*(2-a)}class AP{constructor(i,s){_defineProperty(this,"_mousedownPos",void 0),_defineProperty(this,"_clickTolerance",void 0),_defineProperty(this,"_map",void 0),this._map=i,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new MapWheelEvent(i.type,this._map,i))}mousedown(i,s){return this._mousedownPos=s,this._firePreventable(new MapMouseEvent(i.type,this._map,i))}mouseup(i){this._map.fire(new MapMouseEvent(i.type,this._map,i))}click(i,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new MapMouseEvent(i.type,this._map,i))}dblclick(i){return this._firePreventable(new MapMouseEvent(i.type,this._map,i))}mouseover(i){this._map.fire(new MapMouseEvent(i.type,this._map,i))}mouseout(i){this._map.fire(new MapMouseEvent(i.type,this._map,i))}touchstart(i){return this._firePreventable(new MapTouchEvent(i.type,this._map,i))}touchmove(i){this._map.fire(new MapTouchEvent(i.type,this._map,i))}touchend(i){this._map.fire(new MapTouchEvent(i.type,this._map,i))}touchcancel(i){this._map.fire(new MapTouchEvent(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fy{constructor(i){_defineProperty(this,"_map",void 0),_defineProperty(this,"_delayContextMenu",void 0),_defineProperty(this,"_ignoreContextMenu",void 0),_defineProperty(this,"_contextMenuEvent",void 0),this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new MapMouseEvent(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new MapMouseEvent("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new MapMouseEvent(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class TP{constructor(i){_defineProperty(this,"contextmenu",void 0),_defineProperty(this,"mousedown",void 0),_defineProperty(this,"mousemoveWindow",void 0),_defineProperty(this,"mouseup",void 0),_defineProperty(this,"touchstart",void 0),_defineProperty(this,"touchmoveWindow",void 0),_defineProperty(this,"touchend",void 0),_defineProperty(this,"_clickTolerance",void 0),_defineProperty(this,"_moveFunction",void 0),_defineProperty(this,"_activateOnStart",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_moved",void 0),_defineProperty(this,"_lastPoint",void 0),_defineProperty(this,"_moveStateManager",void 0),this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const s=this._moveFunction(...i);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(i,s){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,s){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i)){this.reset(i);return}const p=s.length?s[0]:s;if(!(!this._moved&&p.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(f,p)}dragEnd(i){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(i)&&(this._moved&&DOM.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const l0=0,ew=2,nw={[l0]:1,[ew]:2};function dy(a,i){const s=nw[i];return a.buttons===void 0||(a.buttons&s)!==s}class MP{constructor(i){_defineProperty(this,"_eventButton",void 0),_defineProperty(this,"_correctEvent",void 0),this._correctEvent=i.checkCorrectEvent}startMove(i){const s=DOM.mouseButton(i);this._eventButton=s}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!dy(i,this._eventButton)}isValidEndEvent(i){return DOM.mouseButton(i)===this._eventButton}}class CP{constructor(){_defineProperty(this,"_firstTouch",void 0),this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){const s=i.targetTouches[0].identifier;this._firstTouch=s}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const pd=0,rw=2,hy=a=>{a.mousedown=a.dragStart,a.mousemoveWindow=a.dragMove,a.mouseup=a.dragEnd,a.contextmenu=i=>{i.preventDefault()}},v8=({enable:a,clickTolerance:i})=>{const s=new MouseMoveStateManager({checkCorrectEvent:f=>DOM.mouseButton(f)===pd&&!f.ctrlKey});return new DragHandler({clickTolerance:i,move:(f,p)=>({around:p,panDelta:p.sub(f)}),activateOnStart:!0,moveStateManager:s,enable:a,assignEvents:hy})},PP=({enable:a,clickTolerance:i,bearingDegreesPerPixelMoved:s=.8})=>{const f=new MouseMoveStateManager({checkCorrectEvent:p=>DOM.mouseButton(p)===pd&&p.ctrlKey||DOM.mouseButton(p)===rw});return new DragHandler({clickTolerance:i,move:(p,y)=>({bearingDelta:(y.x-p.x)*s}),moveStateManager:f,enable:a,assignEvents:hy})},Xa=({enable:a,clickTolerance:i,pitchDegreesPerPixelMoved:s=-.5})=>{const f=new MouseMoveStateManager({checkCorrectEvent:p=>DOM.mouseButton(p)===pd&&p.ctrlKey||DOM.mouseButton(p)===rw});return new DragHandler({clickTolerance:i,move:(p,y)=>({pitchDelta:(y.y-p.y)*s}),moveStateManager:f,enable:a,assignEvents:hy})},py=4.000244140625,LP=null,iw=null,ow=2;class IP{constructor(i,s){_defineProperty(this,"_map",void 0),_defineProperty(this,"_tr",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_zooming",void 0),_defineProperty(this,"_aroundCenter",void 0),_defineProperty(this,"_around",void 0),_defineProperty(this,"_aroundPoint",void 0),_defineProperty(this,"_type",void 0),_defineProperty(this,"_lastValue",void 0),_defineProperty(this,"_timeout",void 0),_defineProperty(this,"_finishTimeout",void 0),_defineProperty(this,"_lastWheelEvent",void 0),_defineProperty(this,"_lastWheelEventTime",void 0),_defineProperty(this,"_startZoom",void 0),_defineProperty(this,"_targetZoom",void 0),_defineProperty(this,"_delta",void 0),_defineProperty(this,"_easing",void 0),_defineProperty(this,"_prevEase",void 0),_defineProperty(this,"_frameId",void 0),_defineProperty(this,"_triggerRenderFrame",void 0),_defineProperty(this,"_defaultZoomRate",void 0),_defineProperty(this,"_wheelZoomRate",void 0),_defineProperty(this,"_onTimeout",f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)}),this._map=i,this._tr=new TransformProvider(i),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=LP,this._wheelZoomRate=iw}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!i[this._map.cooperativeGestures._bypassKey])return;let s=i.deltaMode===WheelEvent.DOM_DELTA_LINE?i.deltaY*40:i.deltaY;const f=browser.now(),p=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,s!==0&&s%py===0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),i.shiftKey&&s&&(s=s/4),this._type&&(this._lastWheelEvent=i,this._delta-=s,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=DOM.mousePos(this._map.getCanvasContainer(),i),f=this._tr;s.y>f.transform.height/2-f.transform.getHorizon()?this._around=LngLat.convert(this._aroundCenter?f.center:f.unproject(s)):this._around=LngLat.convert(f.center),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>py?this._wheelZoomRate:this._defaultZoomRate;let A=ow/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&A!==0&&(A=1/A);const I=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(I*A))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,f=this._startZoom,p=this._easing;let y=!1,x;if(this._type==="wheel"&&f&&p){const O=Math.min((browser.now()-this._lastWheelEventTime)/200,1),A=p(O);x=interpolates.number(f,s,A),O<1?this._frameId||(this._frameId=!0):y=!0}else x=s,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!y,zoomDelta:x-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let s=defaultEasing;if(this._prevEase){const f=this._prevEase,p=(browser.now()-f.start)/f.duration,y=f.easing(p+.01)-f.easing(p),x=.27/Math.sqrt(y*y+1e-4)*.01,O=Math.sqrt(.27*.27-x*x);s=bezier(x,O,.25,1)}return this._prevEase={start:browser.now(),duration:i,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class RP{constructor(i,s){_defineProperty(this,"_clickZoom",void 0),_defineProperty(this,"_tapZoom",void 0),this._clickZoom=i,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class kP{constructor(i,s,f){_defineProperty(this,"_el",void 0),_defineProperty(this,"_mousePan",void 0),_defineProperty(this,"_touchPan",void 0),_defineProperty(this,"_inertiaOptions",void 0),this._el=i,this._mousePan=s,this._touchPan=f}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("l7-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("l7-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class DP{constructor(i,s,f){_defineProperty(this,"_mouseRotate",void 0),_defineProperty(this,"_mousePitch",void 0),_defineProperty(this,"_pitchWithRotate",void 0),this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=s,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class NP{constructor(i,s,f,p){_defineProperty(this,"_el",void 0),_defineProperty(this,"_touchZoom",void 0),_defineProperty(this,"_touchRotate",void 0),_defineProperty(this,"_tapDragZoom",void 0),_defineProperty(this,"_rotationDisabled",void 0),_defineProperty(this,"_enabled",void 0),this._el=i,this._touchZoom=s,this._touchRotate=f,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("l7-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("l7-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}function FP(a,i){if(a.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${a.length}, points ${i.length}`);const s={};for(let f=0;f<a.length;f++)s[a[f].identifier]=i[f];return s}function aw(a){const i=new Point(0,0);for(const s of a)i._add(s);return i.div(a.length)}const gy=500,sw=500,vy=30;class cw{constructor(i){_defineProperty(this,"numTouches",void 0),_defineProperty(this,"centroid",void 0),_defineProperty(this,"startTime",void 0),_defineProperty(this,"aborted",void 0),_defineProperty(this,"touches",void 0),this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,s,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=i.timeStamp),f.length===this.numTouches&&(this.centroid=aw(s),this.touches=indexTouches(f,s)))}touchmove(i,s,f){if(this.aborted||!this.centroid)return;const p=indexTouches(f,s);for(const y in this.touches){const x=this.touches[y],O=p[y];(!O||O.dist(x)>vy)&&(this.aborted=!0)}}touchend(i,s,f){if((!this.centroid||i.timeStamp-this.startTime>sw)&&(this.aborted=!0),f.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class BP{constructor(i){_defineProperty(this,"singleTap",void 0),_defineProperty(this,"numTaps",void 0),_defineProperty(this,"lastTime",void 0),_defineProperty(this,"lastTap",void 0),_defineProperty(this,"count",void 0),this.singleTap=new cw(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,s,f){this.singleTap.touchstart(i,s,f)}touchmove(i,s,f){this.singleTap.touchmove(i,s,f)}touchend(i,s,f){const p=this.singleTap.touchend(i,s,f);if(p){const y=i.timeStamp-this.lastTime<gy,x=!this.lastTap||this.lastTap.dist(p)<vy;if((!y||!x)&&this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class jP{constructor(){_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_swipePoint",void 0),_defineProperty(this,"_swipeTouch",void 0),_defineProperty(this,"_tapTime",void 0),_defineProperty(this,"_tapPoint",void 0),_defineProperty(this,"_tap",void 0),this._tap=new TapRecognizer({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,s,f){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(i,s,f);else{const p=s[0],y=i.timeStamp-this._tapTime<MAX_TAP_INTERVAL,x=this._tapPoint.dist(p)<MAX_DIST;!y||!x?this.reset():f.length>0&&(this._swipePoint=p,this._swipeTouch=f[0].identifier)}}touchmove(i,s,f){if(!this._tapTime)this._tap.touchmove(i,s,f);else if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const p=s[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,i.preventDefault(),this._active=!0,{zoomDelta:y/128}}}touchend(i,s,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const p=this._tap.touchend(i,s,f);p&&(this._tapTime=i.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zP{constructor(i){_defineProperty(this,"_tr",void 0),_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_zoomIn",void 0),_defineProperty(this,"_zoomOut",void 0),this._tr=new TransformProvider(i),this._zoomIn=new TapRecognizer({numTouches:1,numTaps:2}),this._zoomOut=new TapRecognizer({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,s,f){this._zoomIn.touchstart(i,s,f),this._zoomOut.touchstart(i,s,f)}touchmove(i,s,f){this._zoomIn.touchmove(i,s,f),this._zoomOut.touchmove(i,s,f)}touchend(i,s,f){const p=this._zoomIn.touchend(i,s,f),y=this._zoomOut.touchend(i,s,f),x=this._tr;if(p)return this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(p)},{originalEvent:i})};if(y)return this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(y)},{originalEvent:i})}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class m8{constructor(i,s){_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_touches",void 0),_defineProperty(this,"_clickTolerance",void 0),_defineProperty(this,"_sum",void 0),_defineProperty(this,"_map",void 0),this._clickTolerance=i.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new Point(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(i,s,f){return this._calculateTransform(i,s,f)}touchmove(i,s,f){if(!(!this._active||f.length<this.minTouchs()))return i.preventDefault(),this._calculateTransform(i,s,f)}touchend(i,s,f){this._calculateTransform(i,s,f),this._active&&f.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,s,f){f.length>0&&(this._active=!0);const p=indexTouches(f,s),y=new Point(0,0),x=new Point(0,0);let O=0;for(const B in p){const j=p[B],V=this._touches[B];V&&(y._add(j),x._add(j.sub(V)),O++,p[B]=j)}if(this._touches=p,O<this.minTouchs()||!x.mag())return;const A=x.div(O);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(O),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class UP{constructor(){_defineProperty(this,"_enabled",void 0),_defineProperty(this,"_active",void 0),_defineProperty(this,"_firstTwoTouches",void 0),_defineProperty(this,"_vector",void 0),_defineProperty(this,"_startVector",void 0),_defineProperty(this,"_aroundCenter",void 0),this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,s,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([s[0],s[1]]))}touchmove(i,s,f){if(!this._firstTwoTouches)return;i.preventDefault();const[p,y]=this._firstTwoTouches,x=gd(f,s,p),O=gd(f,s,y);if(!x||!O)return;const A=this._aroundCenter?null:x.add(O).div(2);return this._move([x,O],A,i)}touchend(i,s,f){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,x=gd(f,s,p),O=gd(f,s,y);x&&O||(this._active&&DOM.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function gd(a,i,s){for(let f=0;f<a.length;f++)if(a[f].identifier===s)return i[f]}const yy=.1;function lw(a,i){return Math.log(a/i)/Math.LN2}class ZP extends null{constructor(...i){super(...i),_defineProperty(this,"_distance",void 0),_defineProperty(this,"_startDistance",void 0)}reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,s){const f=this._distance;if(this._distance=i[0].dist(i[1]),!(!this._active&&Math.abs(lw(this._distance,this._startDistance))<yy))return this._active=!0,{zoomDelta:lw(this._distance,f),pinchAround:s}}}const uw=25;function _y(a,i){return a.angleWith(i)*180/Math.PI}class y8 extends null{constructor(...i){super(...i),_defineProperty(this,"_minDiameter",void 0)}reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,s,f){const p=this._vector;if(this._vector=i[0].sub(i[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:_y(this._vector,p),pinchAround:s}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const s=Math.PI*this._minDiameter,f=uw/s*360,p=_y(i,this._startVector);return Math.abs(p)<f}}function by(a){return Math.abs(a.y)>Math.abs(a.x)}const fw=100;class HP extends null{constructor(i){super(),_defineProperty(this,"_valid",void 0),_defineProperty(this,"_firstMove",void 0),_defineProperty(this,"_lastPoints",void 0),_defineProperty(this,"_map",void 0),_defineProperty(this,"_currentTouchCount",0),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,s,f){super.touchstart(i,s,f),this._currentTouchCount=f.length}_start(i){this._lastPoints=i,by(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,s,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const p=i[0].sub(this._lastPoints[0]),y=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,y,f.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(p.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(i,s,f){if(this._valid!==void 0)return this._valid;const p=2,y=i.mag()>=p,x=s.mag()>=p;if(!y&&!x)return;if(!y||!x)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<fw?void 0:!1;const O=i.y>0==s.y>0;return by(i)&&by(s)&&O}}const u0={linearity:.3,easing:ty(0,0,.3,1)},dw=fd({deceleration:2500,maxSpeed:1400},u0),hw=fd({deceleration:20,maxSpeed:1400},u0),pw=fd({deceleration:1e3,maxSpeed:360},u0),WP=fd({deceleration:1e3,maxSpeed:90},u0);class _8{constructor(i){_defineProperty(this,"_map",void 0),_defineProperty(this,"_inertiaBuffer",void 0),this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:browser.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,s=browser.now(),f=160;for(;i.length>0&&s-i[0].time>f;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)s.zoom+=x.zoomDelta||0,s.bearing+=x.bearingDelta||0,s.pitch+=x.pitchDelta||0,x.panDelta&&s.pan._add(x.panDelta),x.around&&(s.around=x.around),x.pinchAround&&(s.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(s.pan.mag()){const x=f0(s.pan.mag(),p,extend({},dw,i||{}));y.offset=s.pan.mult(x.amount/s.pan.mag()),y.center=this._map.transform.center,vd(y,x)}if(s.zoom){const x=f0(s.zoom,p,hw);y.zoom=this._map.transform.zoom+x.amount,vd(y,x)}if(s.bearing){const x=f0(s.bearing,p,pw);y.bearing=this._map.transform.bearing+clamp(x.amount,-179,179),vd(y,x)}if(s.pitch){const x=f0(s.pitch,p,WP);y.pitch=this._map.transform.pitch+x.amount,vd(y,x)}if(y.zoom||y.bearing){const x=s.pinchAround===void 0?s.around:s.pinchAround;y.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),extend(y,{noMoveStart:!0})}}function vd(a,i){(!a.duration||a.duration<i.duration)&&(a.duration=i.duration,a.easing=i.easing)}function f0(a,i,s){const{maxSpeed:f,linearity:p,deceleration:y}=s,x=clamp(a*p/(i/1e3),-f,f),O=Math.abs(x)/(y*p);return{easing:s.easing,duration:O*1e3,amount:x*(O/2)}}const d0=a=>a.zoom||a.drag||a.pitch||a.rotate;class gw extends null{constructor(i,s){super(i),_defineProperty(this,"type","renderFrame"),_defineProperty(this,"timeStamp",void 0),this.timeStamp=s}}function h0(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}class VP{constructor(i,s){_defineProperty(this,"_map",void 0),_defineProperty(this,"_el",void 0),_defineProperty(this,"_handlers",void 0),_defineProperty(this,"_eventsInProgress",void 0),_defineProperty(this,"_frameId",void 0),_defineProperty(this,"_inertia",void 0),_defineProperty(this,"_bearingSnap",void 0),_defineProperty(this,"_handlersById",void 0),_defineProperty(this,"_updatingCamera",void 0),_defineProperty(this,"_changes",void 0),_defineProperty(this,"_zoom",void 0),_defineProperty(this,"_previousActiveHandlers",void 0),_defineProperty(this,"_listeners",void 0),_defineProperty(this,"handleWindowEvent",p=>{this.handleEvent(p,`${p.type}Window`)}),_defineProperty(this,"handleEvent",(p,y)=>{if(p.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;const x=p.type==="renderFrame"?void 0:p,O={needsRenderFrame:!1},A={},I={},B=p.touches,j=B?this._getMapTouches(B):void 0,V=j?DOM.touchPos(this._map.getCanvasContainer(),j):DOM.mousePos(this._map.getCanvasContainer(),p);for(const{handlerName:Kt,handler:ue,allowed:Le}of this._handlers){if(!ue.isEnabled())continue;let ke;this._blockedByActive(I,Le,Kt)?ue.reset():ue[y||p.type]&&(ke=ue[y||p.type](p,V,j),this.mergeHandlerResult(O,A,ke,Kt,x),ke&&ke.needsRenderFrame&&this._triggerRenderFrame()),(ke||ue.isActive())&&(I[Kt]=ue)}const mt={};for(const Kt in this._previousActiveHandlers)I[Kt]||(mt[Kt]=x);this._previousActiveHandlers=I,(Object.keys(mt).length||h0(O))&&(this._changes.push([O,A,mt]),this._triggerRenderFrame()),(Object.keys(I).length||h0(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Bt}=O;Bt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Bt(this._map))}),this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new HandlerInertia(i),this._bearingSnap=s.bearingSnap||7,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,x]of this._listeners)DOM.addEventListener(p,y,p===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[i,s,f]of this._listeners)DOM.removeEventListener(i,s,i===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(i){const s=this._map,f=s.getCanvasContainer();this._add("mapEvent",new MapEventHandler(s,i));const p=s.boxZoom=new BoxZoomHandler(s,i);this._add("boxZoom",p),i.interactive&&i.boxZoom&&p.enable();const y=s.cooperativeGestures=new CooperativeGesturesHandler(s,i.cooperativeGestures);this._add("cooperativeGestures",y),i.cooperativeGestures&&y.enable();const x=new TapZoomHandler(s),O=new ClickZoomHandler(s);s.doubleClickZoom=new DoubleClickZoomHandler(O,x),this._add("tapZoom",x),this._add("clickZoom",O),i.interactive&&i.doubleClickZoom&&s.doubleClickZoom.enable();const A=new TapDragZoomHandler;this._add("tapDragZoom",A);const I=s.touchPitch=new TwoFingersTouchPitchHandler(s);this._add("touchPitch",I),i.interactive&&i.touchPitch&&s.touchPitch.enable(i.touchPitch);const B=generateMouseRotationHandler(i),j=generateMousePitchHandler(i);s.dragRotate=new DragRotateHandler(i,B,j),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]),i.interactive&&i.dragRotate&&s.dragRotate.enable();const V=generateMousePanHandler(i),mt=new TouchPanHandler(i,s);s.dragPan=new DragPanHandler(f,V,mt),this._add("mousePan",V),this._add("touchPan",mt,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&s.dragPan.enable(i.dragPan);const Bt=new TwoFingersTouchRotateHandler,Kt=new TwoFingersTouchZoomHandler;s.touchZoomRotate=new TwoFingersTouchZoomRotateHandler(f,Kt,Bt,A),this._add("touchRotate",Bt,["touchPan","touchZoom"]),this._add("touchZoom",Kt,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&s.touchZoomRotate.enable(i.touchZoomRotate);const ue=s.scrollZoom=new ScrollZoomHandler(s,()=>this._triggerRenderFrame());this._add("scrollZoom",ue,["mousePan"]),i.interactive&&i.scrollZoom&&s.scrollZoom.enable(i.scrollZoom);const Le=s.keyboard=new KeyboardHandler(s);this._add("keyboard",Le),i.interactive&&i.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new BlockableMapEventHandler(s))}_add(i,s,f){this._handlers.push({handlerName:i,handler:s,allowed:f}),this._handlersById[i]=s}stop(i){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!d0(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,s,f){for(const p in i)if(p!==f&&(!s||s.indexOf(p)<0))return!0;return!1}_getMapTouches(i){const s=[];for(const f of i){const p=f.target;this._el.contains(p)&&s.push(f)}return s}mergeHandlerResult(i,s,f,p,y){if(!f)return;extend(i,f);const x={handlerName:p,originalEvent:f.originalEvent||y};f.zoomDelta!==void 0&&(s.zoom=x),f.panDelta!==void 0&&(s.drag=x),f.pitchDelta!==void 0&&(s.pitch=x),f.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const i={},s={},f={};for(const[p,y,x]of this._changes)p.panDelta&&(i.panDelta=(i.panDelta||new Point(0,0))._add(p.panDelta)),p.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(i.around=p.around),p.pinchAround!==void 0&&(i.pinchAround=p.pinchAround),p.noInertia&&(i.noInertia=p.noInertia),extend(s,y),extend(f,x);this._updateMapTransform(i,s,f),this._changes=[]}_updateMapTransform(i,s,f){const p=this._map,y=p._getTransformForUpdate();if(!h0(i))return this._fireEvents(s,f,!0);const{panDelta:x,zoomDelta:O,bearingDelta:A,pitchDelta:I,pinchAround:B}=i;let{around:j}=i;B!==void 0&&(j=B),p._stop(!0),j=j||p.transform.centerPoint;const V=y.pointLocation(x?j.sub(x):j);A&&(y.bearing+=A),I&&(y.pitch+=I),O&&(y.zoom+=O),y.setLocationAtPoint(V,j),p._applyUpdatedTransform(y),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(s,f,!0)}_fireEvents(i,s,f){const p=d0(this._eventsInProgress),y=d0(i),x={};for(const j in i){const{originalEvent:V}=i[j];this._eventsInProgress[j]||(x[`${j}start`]=V),this._eventsInProgress[j]=i[j]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const j in x)this._fireEvent(j,x[j]);y&&this._fireEvent("move",y.originalEvent);for(const j in i){const{originalEvent:V}=i[j];this._fireEvent(j,V)}const O={};let A;for(const j in this._eventsInProgress){const{handlerName:V,originalEvent:mt}=this._eventsInProgress[j];this._handlersById[V].isActive()||(delete this._eventsInProgress[j],A=s[V]||mt,O[`${j}end`]=A)}for(const j in O)this._fireEvent(j,O[j]);const I=d0(this._eventsInProgress);if(f&&((p||y)&&!I)){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=mt=>mt!==0&&-this._bearingSnap<mt&&mt<this._bearingSnap;j&&(j.essential||!browser.prefersReducedMotion)?(V(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:A})):(this._map.fire(new Event("moveend",{originalEvent:A})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,s){this._map.fire(new Event(i,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new gw("renderFrame",i)),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class GP{constructor(){_defineProperty(this,"_queue",void 0),_defineProperty(this,"_id",void 0),_defineProperty(this,"_cleared",void 0),_defineProperty(this,"_currentlyRunning",void 0),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const s=++this._id;return this._queue.push({callback:i,id:s,cancelled:!1}),s}remove(i){const s=this._currentlyRunning,f=s?this._queue.concat(s):this._queue;for(const p of f)if(p.id===i){p.cancelled=!0;return}}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const f of s)if(!f.cancelled&&(f.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function vw(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var p=i.head||i.getElementsByTagName("head")[0];if(!p){p=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(p,y):i.documentElement.appendChild(p)}var x=i.createElement("style");return x.type="text/css",x.styleSheet?x.styleSheet.cssText=a:x.appendChild(i.createTextNode(a)),p.appendChild(x),x}}vw(`.l7-map {
  font:
    12px/20px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgb(0 0 0 / 0%);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: grab;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  touch-action: none;
}

.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures,
.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-cooperative-gesture-screen {
  background: rgba(0 0 0 / 40%);
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 1rem;
  font-size: 1.4em;
  line-height: 1.2;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease 1s;
  z-index: 99999;
}

.l7-cooperative-gesture-screen.l7-show {
  opacity: 1;
  transition: opacity 0.05s;
}

.l7-cooperative-gesture-screen .l7-mobile-message {
  display: none;
}

@media (hover: none), (width <= 480px) {
  .l7-cooperative-gesture-screen .l7-desktop-message {
    display: none;
  }

  .l7-cooperative-gesture-screen .l7-mobile-message {
    display: block;
  }
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right {
  position: absolute;
  pointer-events: none;
  z-index: 2;
}

.l7-ctrl-top-left {
  top: 0;
  left: 0;
}

.l7-ctrl-top-right {
  top: 0;
  right: 0;
}

.l7-ctrl-bottom-left {
  bottom: 0;
  left: 0;
}

.l7-ctrl-bottom-right {
  right: 0;
  bottom: 0;
}

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}

.l7-ctrl-top-left .l7-ctrl {
  margin: 10px 0 0 10px;
  float: left;
}

.l7-ctrl-top-right .l7-ctrl {
  margin: 10px 10px 0 0;
  float: right;
}

.l7-ctrl-bottom-left .l7-ctrl {
  margin: 0 0 10px 10px;
  float: left;
}

.l7-ctrl-bottom-right .l7-ctrl {
  margin: 0 10px 10px 0;
  float: right;
}

.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
  cursor: crosshair;
}

.l7-boxzoom {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  background: #fff;
  border: 2px dotted #202020;
  opacity: 0.5;
  z-index: 10;
}
`);const md=-2,mw=22,oc=0,yw=60,Au=85,_w={interactive:!0,bearingSnap:7,scrollZoom:!0,minZoom:md,maxZoom:mw,minPitch:oc,maxPitch:yw,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,fadeDuration:300,clickTolerance:3,pitchWithRotate:!0};class $P extends null{constructor(i){const s=_objectSpread(_objectSpread({},_w),i);if(s.minZoom!=null&&s.maxZoom!=null&&s.minZoom>s.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(s.minPitch!=null&&s.maxPitch!=null&&s.minPitch>s.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(s.minPitch!=null&&s.minPitch<oc)throw new Error(`minPitch must be greater than or equal to ${oc}`);if(s.maxPitch!=null&&s.maxPitch>Au)throw new Error(`maxPitch must be less than or equal to ${Au}`);const f=new Transform(s.minZoom,s.maxZoom,s.minPitch,s.maxPitch,s.renderWorldCopies);if(super(f,{bearingSnap:s.bearingSnap}),_defineProperty(this,"_container",void 0),_defineProperty(this,"_canvasContainer",void 0),_defineProperty(this,"_interactive",void 0),_defineProperty(this,"_frameRequest",void 0),_defineProperty(this,"_loaded",void 0),_defineProperty(this,"_idleTriggered",!1),_defineProperty(this,"_fullyLoaded",void 0),_defineProperty(this,"_trackResize",void 0),_defineProperty(this,"_resizeObserver",void 0),_defineProperty(this,"_preserveDrawingBuffer",void 0),_defineProperty(this,"_failIfMajorPerformanceCaveat",void 0),_defineProperty(this,"_fadeDuration",void 0),_defineProperty(this,"_crossSourceCollisions",void 0),_defineProperty(this,"_crossFadingFactor",1),_defineProperty(this,"_collectResourceTiming",void 0),_defineProperty(this,"_renderTaskQueue",new TaskQueue),_defineProperty(this,"_mapId",uniqueId()),_defineProperty(this,"_removed",void 0),_defineProperty(this,"_clickTolerance",void 0),_defineProperty(this,"version",void 0),_defineProperty(this,"mapSize",void 0),_defineProperty(this,"scrollZoom",void 0),_defineProperty(this,"boxZoom",void 0),_defineProperty(this,"dragRotate",void 0),_defineProperty(this,"dragPan",void 0),_defineProperty(this,"keyboard",void 0),_defineProperty(this,"doubleClickZoom",void 0),_defineProperty(this,"touchZoomRotate",void 0),_defineProperty(this,"touchPitch",void 0),_defineProperty(this,"cooperativeGestures",void 0),_defineProperty(this,"_onMapScroll",p=>{if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}),this._interactive=s.interactive,this._trackResize=s.trackResize===!0,this._bearingSnap=s.bearingSnap,this._fadeDuration=s.fadeDuration,this._clickTolerance=s.clickTolerance,this.version=i.version,this.mapSize=i.mapSize,typeof s.container=="string"){if(this._container=document.getElementById(s.container),!this._container)throw new Error(`Container '${s.container}' not found.`)}else if(s.container instanceof HTMLElement)this._container=s.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(s.maxBounds&&this.setMaxBounds(s.maxBounds),this._setupContainer(),this.on("move",()=>this._update()).on("moveend",()=>this._update()).on("zoom",()=>this._update()).once("idle",()=>{this._idleTriggered=!0}),typeof window!="undefined"){let p=!1;const y=lodashUtil.throttle(x=>{this._trackResize&&!this._removed&&this.resize(x)._update()},50);this._resizeObserver=new ResizeObserver(x=>{if(!p){p=!0;return}y(x)}),this._resizeObserver.observe(this._container)}this.handlers=new HandlerManager(this,s),this.jumpTo({center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}),s.bounds&&(this.resize(),this.fitBounds(s.bounds,extend({},s.fitBoundsOptions,{duration:0}))),this.resize()}_getMapId(){return this._mapId}calculateCameraOptionsFromTo(i,s,f,p){return super.calculateCameraOptionsFromTo(i,s,f,p)}resize(i){var s;const f=this._containerDimensions(),p=f[0],y=f[1];this.transform.resize(p,y),(s=this._requestedCameraState)===null||s===void 0||s.resize(p,y);const x=!this._moving;return x&&(this.stop(),this.fire(new Event("movestart",i)).fire(new Event("move",i))),this.fire(new Event("resize",i)),x&&this.fire(new Event("moveend",i)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(i){return this.transform.setMaxBounds(i&&LngLatBounds.convert(i)),this._update()}setMinZoom(i){if(i=i==null?md:i,i>=md&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this._update(),this.getZoom()<i&&this.setZoom(i),this;throw new Error(`minZoom must be between ${md} and the current maxZoom, inclusive`)}getMinZoom(){return this.transform.minZoom}setMaxZoom(i){if(i=i==null?mw:i,i>=this.transform.minZoom)return this.transform.maxZoom=i,this.getZoom()>i&&this.setZoom(i),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(i){if(i=i==null?oc:i,i<oc)throw new Error(`minPitch must be greater than or equal to ${oc}`);if(i>=oc&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this.getPitch()<i&&this.setPitch(i),this;throw new Error(`minPitch must be between ${oc} and the current maxPitch, inclusive`)}getMinPitch(){return this.transform.minPitch}setMaxPitch(i){if(i=i==null?yw:i,i>Au)throw new Error(`maxPitch must be less than or equal to ${Au}`);if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this.getPitch()>i&&this.setPitch(i),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(i){this.transform.renderWorldCopies=i}project(i){return this.transform.locationPoint(LngLat.convert(i))}unproject(i){return this.transform.pointLocation(Point.convert(i))}isMoving(){var i;return this._moving||((i=this.handlers)===null||i===void 0?void 0:i.isMoving())}isZooming(){var i;return this._zooming||((i=this.handlers)===null||i===void 0?void 0:i.isZooming())}isRotating(){var i;return this._rotating||((i=this.handlers)===null||i===void 0?void 0:i.isRotating())}on(i,s){return super.on(i,s)}once(i,s){return super.once(i,s)}off(i,s){return super.off(i,s)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}_containerDimensions(){let i=0,s=0;return this._container&&(i=this._container.clientWidth||400,s=this._container.clientHeight||300),[i,s]}_setupContainer(){const i=this._container;i.classList.add("l7-map");const s=this._canvasContainer=DOM.create("div","l7-canvas-container",i);this._interactive&&s.classList.add("l7-interactive"),this._container.addEventListener("scroll",this._onMapScroll,!1)}_update(){return this.triggerRepaint(),this}_requestRenderFrame(i){return this._update(),this._renderTaskQueue.add(i)}_cancelRenderFrame(i){this._renderTaskQueue.remove(i)}_render(i){if(this._renderTaskQueue.run(i),!this._removed)return this.fire(new Event("render")),this.isMoving()||this.fire(new Event("idle")),this}remove(){var i;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.handlers.destroy(),delete this.handlers,(i=this._resizeObserver)===null||i===void 0||i.disconnect(),DOM.remove(this._canvasContainer),this._container.classList.remove("l7-map"),this._removed=!0,this.fire(new Event("remove"))}triggerRepaint(){this._frameRequest||(this._frameRequest=new AbortController,browser.frameAsync(this._frameRequest).then(i=>{this._frameRequest=null,this._render(i)}).catch(()=>{}))}getCameraTargetElevation(){return this.transform.elevation}}const bw={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},xy={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},xw=12;class Sw{constructor(i){(0,ot.Z)(this,"version","DEFAUlTMAP"),(0,ot.Z)(this,"map",void 0),(0,ot.Z)(this,"simpleMapCoord",new gr),(0,ot.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,ot.Z)(this,"config",void 0),(0,ot.Z)(this,"configService",void 0),(0,ot.Z)(this,"coordinateSystemService",void 0),(0,ot.Z)(this,"eventEmitter",void 0),(0,ot.Z)(this,"markerContainer",void 0),(0,ot.Z)(this,"cameraChangedCallback",void 0),(0,ot.Z)(this,"$mapContainer",void 0),(0,ot.Z)(this,"handleCameraChanged",s=>{const{lat:f,lng:p}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[p,f],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=i.mapConfig,this.configService=i.globalConfigService,this.coordinateSystemService=i.coordinateSystemService,this.eventEmitter=new No.EventEmitter}setBgColor(i){this.bgColor=i}addMarkerContainer(){const i=this.map.getCanvasContainer();this.markerContainer=Vi("div","l7-marker-container",i),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(i,s){Eg.indexOf(i)!==-1?this.eventEmitter.on(i,s):this.map.on(xy[i]||i,s)}off(i,s){this.map.off(xy[i]||i,s),this.eventEmitter.off(i,s)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const i=this.map.transform;return[i.width,i.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(i){return this.map.setZoom(i)}getCenter(){return this.map.getCenter()}setCenter(i){this.map.setCenter(i)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(i){this.map.setBearing(i)}zoomIn(i,s){this.map.zoomIn(i,s)}zoomOut(i,s){this.map.zoomOut(i,s)}setPitch(i){return this.map.setPitch(i)}panTo(i){this.map.panTo(i)}panBy(i=0,s=0){this.map.panBy([i,s])}fitBounds(i,s){this.map.fitBounds(i,s)}setMaxZoom(i){this.map.setMaxZoom(i)}setMinZoom(i){this.map.setMinZoom(i)}setMapStatus(i){i.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),i.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),i.dragEnable===!1&&this.map.dragPan.disable(),i.dragEnable===!0&&this.map.dragPan.enable(),i.rotateEnable===!1&&this.map.dragRotate.disable(),i.dragEnable===!0&&this.map.dragRotate.enable(),i.keyboardEnable===!1&&this.map.keyboard.disable(),i.keyboardEnable===!0&&this.map.keyboard.enable(),i.zoomEnable===!1&&this.map.scrollZoom.disable(),i.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(i,s){this.map.flyTo({zoom:i,center:s})}setMapStyle(i){var s;(s=this.map)===null||s===void 0||s.setStyle(this.getMapStyleValue(i))}meterToCoord(i,s){return 1}pixelToLngLat(i){return this.map.unproject(i)}lngLatToPixel(i){return this.map.project(i)}containerToLngLat(i){return this.map.unproject(i)}lngLatToContainer(i){return this.map.project(i)}getMapStyle(){try{var i;const s=(i=this.map.getStyle().sprite)!==null&&i!==void 0?i:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(s)?s==null?void 0:s.replace(/\/\w+$/,"").replace(/sprites/,"styles"):s}catch(s){return""}}getMapStyleConfig(){return bw}getMapStyleValue(i){var s;return(s=this.getMapStyleConfig()[i])!==null&&s!==void 0?s:i}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(i,...s){this.eventEmitter.emit(i,...s)}once(i,...s){this.eventEmitter.once(i,...s)}getMapContainer(){return this.$mapContainer}exportMap(i){var s;const f=(s=this.map)===null||s===void 0?void 0:s.getCanvas();return i==="jpg"?f==null?void 0:f.toDataURL("image/jpeg"):f==null?void 0:f.toDataURL("image/png")}onCameraChanged(i){this.cameraChangedCallback=i}creatMapContainer(i){let s=i;return typeof i=="string"&&(s=document.getElementById(i)),s}updateView(i){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:i.bearing,center:i.center,viewportHeight:i.viewportHeight,pitch:i.pitch,viewportWidth:i.viewportWidth,zoom:i.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:i=!0}=this.config;this.viewport.getZoom()>xw&&i?this.coordinateSystemService.setCoordinateSystem(ph.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(ph.LNGLAT)}}const ww=["id","attributionControl","style","token","rotation","mapInstance"];function YP(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var p=i.head||i.getElementsByTagName("head")[0];if(!p){p=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(p,y):i.documentElement.appendChild(p)}var x=i.createElement("style");return x.type="text/css",x.styleSheet?x.styleSheet.cssText=a:x.appendChild(i.createTextNode(a)),p.appendChild(x),x}}YP(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=nc();let XP=0;const Ow="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class Ew extends Sw{constructor(...i){super(...i),(0,ot.Z)(this,"version","MAPBOX"),(0,ot.Z)(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(i,s={x:0,y:0,z:0}){const{x:f,y:p}=this.lngLatToMercator(i,0);return[f-s.x,p-s.y]}lngLatToMercator(i,s){const{x:f=0,y:p=0,z:y=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(i,s);return{x:f,y:p,z:y}}getModelMatrix(i,s,f,p=[1,1,1],y={x:0,y:0,z:0}){const x=window.mapboxgl.MercatorCoordinate.fromLngLat(i,s),O=x.meterInMercatorCoordinateUnits(),A=Zr.create();return Zr.translate(A,A,Tr.al(x.x-y.x,x.y-y.y,x.z||0-y.z)),Zr.scale(A,A,Tr.al(O*p[0],-O*p[1],O*p[2])),Zr.rotateX(A,A,f[0]),Zr.rotateY(A,A,f[1]),Zr.rotateZ(A,A,f[2]),A}init(){var i=this;return(0,ln.Z)(function*(){const s=i.config,{id:f="map",attributionControl:p=!1,style:y="light",token:x=Ow,rotation:O=0,mapInstance:A}=s,I=(0,jo.Z)(s,ww);i.viewport=new US,!A&&!window.mapboxgl&&console.error(i.configService.getSceneWarninfo("SDK")),x===Ow&&y!=="blank"&&!window.mapboxgl.accessToken&&!A&&console.warn(i.configService.getSceneWarninfo("MapToken")),!A&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=x),A?(i.map=A,i.$mapContainer=i.map.getContainer()):(i.$mapContainer=i.creatMapContainer(f),i.map=new window.mapboxgl.Map((0,on.Z)({container:i.$mapContainer,style:i.getMapStyleValue(y),attributionControl:p,bearing:O},I))),i.map.on("load",()=>{i.handleCameraChanged()}),i.map.on("move",i.handleCameraChanged),i.handleCameraChanged()})()}destroy(){var i;(i=this.$mapContainer)===null||i===void 0||(i=i.parentNode)===null||i===void 0||i.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(i,...s){this.eventEmitter.emit(i,...s)}once(i,...s){this.eventEmitter.once(i,...s)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var i;return(i=this.getMapContainer())===null||i===void 0?void 0:i.querySelector(".mapboxgl-canvas-container")}meterToCoord(i,s){const f=new(nc()).LngLat(i[0],i[1]),p=new(nc()).LngLat(s[0],s[1]),y=f.distanceTo(p),x=nc().MercatorCoordinate.fromLngLat({lng:i[0],lat:i[1]}),O=nc().MercatorCoordinate.fromLngLat({lng:s[0],lat:s[1]}),{x:A,y:I}=x,{x:B,y:j}=O;return Math.sqrt(Math.pow(A-B,2)+Math.pow(I-j,2))*4194304*2/y}exportMap(i){const s=this.map.getCanvas();return i==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png")}creatMapContainer(i){let s=i;typeof i=="string"&&(s=document.getElementById(i));const f=document.createElement("div");return f.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,f.id="l7_mapbox_div"+XP++,s.appendChild(f),f}}function Aw(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var p=i.head||i.getElementsByTagName("head")[0];if(!p){p=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(p,y):i.documentElement.appendChild(p)}var x=i.createElement("style");return x.type="text/css",x.styleSheet?x.styleSheet.cssText=a:x.appendChild(i.createTextNode(a)),p.appendChild(x),x}}Aw(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class Tw extends Hm{getServiceConstructor(){return Ew}}var Mw=L(67294),Sy=L(85893),Cw=function(i){var s=i.data,f=i.config,p=f===void 0?{}:f,y=(0,Y.hQ)();return(0,Mw.useEffect)(function(){var x=new Oi({id:y,map:new Tw({pitch:0,style:"blank",center:[116.368652,39.93866],zoom:10.07})}),O=p.field,A=p.colors,I=A===void 0?["#D7F9F0","#B8EFE2","#A6E1E0","#83CED6","#72BED6","#64A5D3","#4D89E5","#3771D9","#0A3663"]:A,B=0,j=0;s.features.forEach(function(ue){ue.properties[O]>j&&(j=ue.properties[O]),ue.properties[O]<B&&(B=ue.properties[O])});var V=new Va({autoFit:!0}).source(s);V.color(O,I).scale(O,{type:"quantize",domain:[B,j]}).shape("fill").style({opacity:1}).active(!0);var mt=new lm({zIndex:2}).source(s).color("#eee").size(.8).active(!0).style({lineType:"solid",dashArray:[2,2],opacity:1});x.addLayer(V),x.addLayer(mt);var Bt=new Jf({offsets:[0,0],closeButton:!1});V.on("mousemove",function(ue){Bt.setLnglat(ue.lngLat).setHTML("<span>".concat(ue.feature.properties.name,":").concat(ue&&ue.feature.properties[O]?ue.feature.properties[O]:"-","</span>")),x.addPopup(Bt)}),V.on("mouseout",function(ue){x.removePopup(Bt)});var Kt=new Ic({position:"bottomright"});Kt.onAdd=function(){var ue=document.createElement("div");ue.className="infolegend legend";for(var Le=Math.floor(j/I.length),ke=0;ke<I.length;ke++)ue.innerHTML+='<i style="width: 18px;height: 18px;float: left;margin-right: 8px;opacity: 0.7;background:'+I[ke]+'"></i> '+(B+ke*Le)+(I[ke+1]?"\u2013"+Le*(ke+1)+"<br>":"+");return ue},x.addControl(Kt)},[]),(0,Sy.jsx)("div",{id:y,style:{width:"100%",minHeight:300,position:"relative",overflow:"hidden",height:p.height}})},Pw=Cw},53463:function($t,Qt,L){"use strict";L.r(Qt),L.d(Qt,{PagePanelHeader:function(){return un},default:function(){return ct}});var Y=L(15009),Z=L.n(Y),tt=L(97857),yt=L.n(tt),G=L(99289),Ot=L.n(G),bt=L(5574),Et=L.n(bt),pt=L(97584),Vt=L(24614),K=L(72541),X=L(13147),Zt=L(45830),Mt=L(98165),zt=L(63430),Rt=L(79611),Gt=L(78677),ve=L(80652),Me=L(48054),Ue=L(68997),Ke=L(71230),we=L(15746),Ut=L(71577),nt=L(36447),ie=L(86250),qt=L(58175),At=L(99148),Pe=L(27484),it=L.n(Pe),Pt=L(67294),q=L(33237),Nt=L(25971),It={pageHeaderContent:"pageHeaderContent___exWxI",avatar:"avatar___rptEO",content:"content___jBAzR",contentTitle:"contentTitle___TsVhT",extraContent:"extraContent___tNqx0",statItem:"statItem___jPU6u"},U=L(74685),ht=L(92077),ne=L.n(ht),xe=L(36942),_e=L(29393),Xe=L(54235),Re=L(85893),un=function(me){var he,Tt=(0,Zt.useModel)("@@initialState"),re=Tt.initialState,Yt=re.currentUser,N=Yt&&Object.keys(Yt).length;return N?(0,Re.jsxs)("div",{className:It.pageHeaderContent,children:[(0,Re.jsx)("div",{className:It.avatar,children:(0,Re.jsx)(Ue.Z,{size:"large",src:Yt.avatar?Yt.avatar:re==null||(he=re.settings)===null||he===void 0||(he=he.adminSetting)===null||he===void 0?void 0:he.logo})}),(0,Re.jsx)("div",{className:It.content,children:(0,Re.jsx)("div",{className:It.contentTitle,children:(0,Re.jsxs)(Ke.Z,{children:[(0,Re.jsxs)(we.Z,{span:12,children:[(0,Re.jsx)(Ke.Z,{children:(0,Re.jsxs)(we.Z,{children:["\u4F60\u597D\uFF0C",Yt.realname?Yt.realname:Yt.name]})}),(0,Re.jsx)(Ke.Z,{children:(0,Re.jsxs)(we.Z,{children:[Yt.rolename," ",(0,Re.jsx)(Ut.ZP,{shape:"circle",type:"text",onClick:function(){var oe;(oe=me.flash)===null||oe===void 0||oe.call(me)},icon:(0,Re.jsx)(Mt.Z,{})})]})})]}),(0,Re.jsx)(we.Z,{span:12,style:{textAlign:"right"},children:(0,Re.jsx)(cn,{})})]})})})]}):(0,Re.jsx)(Me.Z,{avatar:!0,paragraph:{rows:1},active:!0})},cn=function(){var me=(0,Pt.useState)(it()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),he=Et()(me,2),Tt=he[0],re=he[1],Yt=function N(){re(it()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),setTimeout(function(){return N()},1e3)};return setTimeout(function(){return Yt()},1e3),(0,Re.jsx)(Re.Fragment,{children:Tt})},Jt=function(me){var he=me.url,Tt=he===void 0?"":he,re=(0,Pt.useState)(),Yt=Et()(re,2),N=Yt[0],kt=Yt[1],oe=nt.Z.useApp(),C=oe.message,z=(0,Pt.useState)(),Ft=Et()(z,2),te=Ft[0],se=Ft[1],Se=(0,Zt.useModel)("@@initialState"),be=Se.initialState,Ze=function(){var Be=Ot()(Z()().mark(function jt(){var ce,ae,ye,st=arguments;return Z()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return ce=st.length>0&&st[0]!==void 0?st[0]:{},C.loading("\u52A0\u8F7D\u4E2D..."),H.next=4,pt.ZP.get(Tt,{params:yt()(yt()({},te),ce),then:function(){}});case 4:ae=H.sent,ye=ae.data,C.destroy(),kt(ye);case 8:case"end":return H.stop()}},jt)}));return function(){return Be.apply(this,arguments)}}();(0,Pt.useEffect)(function(){Ze()},[]);var tn=function(jt){var ce,ae,ye=jt.type,st=(ce=jt.config)===null||ce===void 0?void 0:ce.xField,D=(ae=jt.config)===null||ae===void 0?void 0:ae.yField;if(ye=="pie"){var H,at;st=jt.config.colorField,D=jt.config.angleField;var St=(0,Xe.S)(jt.data.map(function(de){return de[D]}));return(0,Re.jsx)(zt.Z,yt()({height:280,appendPadding:10,data:jt.data,radius:.9,label:{position:"spider",text:function(ze){return"".concat(ze[st],": ").concat(ne()(ze[D]).format("0,0"))}},annotations:[{type:"text",style:{text:`\u603B\u8BA1
`.concat(St),x:"50%",y:"50%",textAlign:"center",fontSize:18}}],interactions:[{type:"element-active"}],legend:(H=jt.config)!==null&&H!==void 0&&H.legend?(at=jt.config)===null||at===void 0?void 0:at.legend:!1},jt.config))}else if(ye=="bar"){var Lt;return(0,Re.jsx)(Rt.Z,yt()({xField:st,yField:D,scale:{x:{paddingInner:.4}},data:jt.data,tooltip:{name:(Lt=jt.config)===null||Lt===void 0?void 0:Lt.name,field:D}},jt.config))}else{if(ye=="column")return(0,Re.jsx)(Gt.Z,yt()({xField:st,yField:D,scale:{x:{paddingInner:.4}},data:jt.data},jt.config));if(ye=="areaMap"){var ge=yt()({map:{type:"mapbox",style:"blank",center:[120.19382669582967,30.258134],zoom:13,pitch:0},source:{data:jt.data,parser:{type:"geojson"}},autoFit:!0,color:{field:jt.field,value:["#1A4397","#3165D1","#6296FE","#98B7F7","#DDE6F7","#F2F5FC"].reverse(),scale:{type:"quantile"}},style:{opacity:1,stroke:"#eee",lineWidth:.8,lineOpacity:1},state:{active:!0,select:{stroke:"blue",lineWidth:1.5,lineOpacity:.8}},label:{visible:!0,field:"name",style:{fill:"black",opacity:.5,fontSize:12,spacing:1,padding:[15,15]}},zoom:{position:"bottomright"},legend:{position:"bottomleft"}},jt.config);return(0,Re.jsx)("div",{style:{width:"100%",height:500},children:(0,Re.jsx)(U.Z,{data:jt.data,config:jt})})}else return(0,Re.jsx)(ve.Z,yt()({smooth:!0,shapeField:"smooth",height:280,data:jt.data,xField:"x",yField:"y",title:{visible:!0,text:jt.title,style:{fontSize:14}},meta:{y:{alias:jt.y}},label:{content:function(ze){return ze.y},position:"top",style:{fill:"#000000",opacity:.6}}},jt.config))}},Ge=function Be(jt,ce){var ae;return(0,Re.jsx)(ie.Z,{vertical:!0,gap:"middle",children:jt==null||(ae=jt.row)===null||ae===void 0?void 0:ae.map(function(ye,st){var D;return(0,Re.jsxs)(Ke.Z,{gutter:[16,16],children:[ye.form?(0,Re.jsx)(we.Z,{span:24,children:(0,Re.jsx)(Vt.Z,{bodyStyle:{padding:0},children:(0,Re.jsx)(K.Z,{layoutType:"QueryFilter",columns:(0,q.ab)({initRequest:!0,columns:ye.form.columns,devEnable:!1}),initialValues:te||ye.form.value,onFinish:function(at){Ze(at),console.log("onFinish",at)}})})},st+"form"):null,ye==null||(D=ye.col)===null||D===void 0?void 0:D.map(function(H,at){if(H.row){var St;return(0,Re.jsx)(we.Z,{span:H.span?H.span:24/((St=ye.col)===null||St===void 0?void 0:St.length),children:Be(H,ce)},at)}else if(H.tab){var Lt;return(0,Re.jsx)(we.Z,{span:H.span?H.span:24/((Lt=ye.col)===null||Lt===void 0?void 0:Lt.length),children:(0,Re.jsx)(Vt.Z,{style:{borderTopRightRadius:0,borderTopLeftRadius:0},children:(0,Re.jsx)(qt.Z,{style:{background:"none"},tabBarStyle:{paddingLeft:0,marginBottom:0},items:H.tab.map(function(de,ze){return{key:ze,label:de.title,children:de.row?Be(de,ce):ce(de,ze,{notitle:!0})}})})},at)},at)}else{var ge;return(0,Re.jsx)(we.Z,{span:H.span?H.span:24/((ge=ye.col)===null||ge===void 0?void 0:ge.length),children:ce(H,at)},at)}})]},st)})})};return(0,Re.jsx)(xe.PageContainer404,{title:!1,path:me==null?void 0:me.path,children:(0,Re.jsxs)(ie.Z,{vertical:!0,gap:"middle",children:[(0,Re.jsx)(Vt.Z,{children:(0,Re.jsx)(un,{flash:Ze})},"headcard"),Ge(N,function(Be,jt,ce){return Be.type=="card"?(0,Re.jsx)(X.Z,{style:{height:"100%"},statistic:{title:Be.title,value:Be.value,prefix:Be.prefix,suffix:Be.suffix,description:Be.href?(0,Re.jsx)(Zt.Link,{to:Be.href,style:{fontSize:12},children:"\u67E5\u770B\u66F4\u591A"}):""}},jt+"card"):Be.type=="table"?(0,Re.jsx)(Vt.Z,{style:{height:"100%"},children:(0,Re.jsx)(At.Z,yt()({columns:(0,Nt.SS)({initRequest:!0,columns:Be.columns,initialState:be,devEnable:!1}),dataSource:Be.data,title:function(){return Be.title},rowKey:"id"},Be.props))},jt+"table"):Be.type=="mapDots"?(0,Re.jsx)(Vt.Z,{title:Be.title,style:{height:"100%"},children:(0,Re.jsx)(_e.rq,yt()(yt()({},Be.props),{},{dots:Be.data}))},jt+"mapDots"):(0,Re.jsx)(X.Z,{style:{height:"100%"},title:ce!=null&&ce.notitle?(0,Re.jsx)("div",{style:{height:20}}):Be.title,chart:tn(Be)},jt+"chart")})]})})},ct=Jt},98129:function($t,Qt,L){"use strict";var Y=L(60690);$t.exports=function(yt){yt=yt||{};var G=yt.reporter,Ot=Y.getOption(yt,"async",!0),bt=Y.getOption(yt,"auto",!0);bt&&!Ot&&(G&&G.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),Ot=!0);var Et=Z(),pt,Vt=!1;function K(ve,Me){!Vt&&bt&&Ot&&Et.size()===0&&Mt(),Et.add(ve,Me)}function X(){for(Vt=!0;Et.size();){var ve=Et;Et=Z(),ve.process()}Vt=!1}function Zt(ve){Vt||(ve===void 0&&(ve=Ot),pt&&(Rt(pt),pt=null),ve?Mt():X())}function Mt(){pt=Gt(X)}function zt(){Et={},batchSize=0,topLevel=0,bottomLevel=0}function Rt(ve){var Me=clearTimeout;return Me(ve)}function Gt(ve){var Me=function(Ue){return setTimeout(Ue,0)};return Me(ve)}return{add:K,force:Zt}};function Z(){var tt={},yt=0,G=0,Ot=0;function bt(Vt,K){K||(K=Vt,Vt=0),Vt>G?G=Vt:Vt<Ot&&(Ot=Vt),tt[Vt]||(tt[Vt]=[]),tt[Vt].push(K),yt++}function Et(){for(var Vt=Ot;Vt<=G;Vt++)for(var K=tt[Vt],X=0;X<K.length;X++){var Zt=K[X];Zt()}}function pt(){return yt}return{add:bt,process:Et,size:pt}}},60690:function($t){"use strict";var Qt=$t.exports={};Qt.getOption=L;function L(Y,Z,tt){var yt=Y[Z];return yt==null&&tt!==void 0?tt:yt}},8874:function($t){"use strict";$t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function($t,Qt,L){var Y=L(8874),Z=L(86851),tt=Object.hasOwnProperty,yt=Object.create(null);for(var G in Y)tt.call(Y,G)&&(yt[Y[G]]=G);var Ot=$t.exports={to:{},get:{}};Ot.get=function(pt){var Vt=pt.substring(0,3).toLowerCase(),K,X;switch(Vt){case"hsl":K=Ot.get.hsl(pt),X="hsl";break;case"hwb":K=Ot.get.hwb(pt),X="hwb";break;default:K=Ot.get.rgb(pt),X="rgb";break}return K?{model:X,value:K}:null},Ot.get.rgb=function(pt){if(!pt)return null;var Vt=/^#([a-f0-9]{3,4})$/i,K=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,X=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Zt=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Mt=/^(\w+)$/,zt=[0,0,0,1],Rt,Gt,ve;if(Rt=pt.match(K)){for(ve=Rt[2],Rt=Rt[1],Gt=0;Gt<3;Gt++){var Me=Gt*2;zt[Gt]=parseInt(Rt.slice(Me,Me+2),16)}ve&&(zt[3]=parseInt(ve,16)/255)}else if(Rt=pt.match(Vt)){for(Rt=Rt[1],ve=Rt[3],Gt=0;Gt<3;Gt++)zt[Gt]=parseInt(Rt[Gt]+Rt[Gt],16);ve&&(zt[3]=parseInt(ve+ve,16)/255)}else if(Rt=pt.match(X)){for(Gt=0;Gt<3;Gt++)zt[Gt]=parseInt(Rt[Gt+1],0);Rt[4]&&(Rt[5]?zt[3]=parseFloat(Rt[4])*.01:zt[3]=parseFloat(Rt[4]))}else if(Rt=pt.match(Zt)){for(Gt=0;Gt<3;Gt++)zt[Gt]=Math.round(parseFloat(Rt[Gt+1])*2.55);Rt[4]&&(Rt[5]?zt[3]=parseFloat(Rt[4])*.01:zt[3]=parseFloat(Rt[4]))}else return(Rt=pt.match(Mt))?Rt[1]==="transparent"?[0,0,0,0]:tt.call(Y,Rt[1])?(zt=Y[Rt[1]],zt[3]=1,zt):null:null;for(Gt=0;Gt<3;Gt++)zt[Gt]=bt(zt[Gt],0,255);return zt[3]=bt(zt[3],0,1),zt},Ot.get.hsl=function(pt){if(!pt)return null;var Vt=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,K=pt.match(Vt);if(K){var X=parseFloat(K[4]),Zt=(parseFloat(K[1])%360+360)%360,Mt=bt(parseFloat(K[2]),0,100),zt=bt(parseFloat(K[3]),0,100),Rt=bt(isNaN(X)?1:X,0,1);return[Zt,Mt,zt,Rt]}return null},Ot.get.hwb=function(pt){if(!pt)return null;var Vt=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,K=pt.match(Vt);if(K){var X=parseFloat(K[4]),Zt=(parseFloat(K[1])%360+360)%360,Mt=bt(parseFloat(K[2]),0,100),zt=bt(parseFloat(K[3]),0,100),Rt=bt(isNaN(X)?1:X,0,1);return[Zt,Mt,zt,Rt]}return null},Ot.to.hex=function(){var pt=Z(arguments);return"#"+Et(pt[0])+Et(pt[1])+Et(pt[2])+(pt[3]<1?Et(Math.round(pt[3]*255)):"")},Ot.to.rgb=function(){var pt=Z(arguments);return pt.length<4||pt[3]===1?"rgb("+Math.round(pt[0])+", "+Math.round(pt[1])+", "+Math.round(pt[2])+")":"rgba("+Math.round(pt[0])+", "+Math.round(pt[1])+", "+Math.round(pt[2])+", "+pt[3]+")"},Ot.to.rgb.percent=function(){var pt=Z(arguments),Vt=Math.round(pt[0]/255*100),K=Math.round(pt[1]/255*100),X=Math.round(pt[2]/255*100);return pt.length<4||pt[3]===1?"rgb("+Vt+"%, "+K+"%, "+X+"%)":"rgba("+Vt+"%, "+K+"%, "+X+"%, "+pt[3]+")"},Ot.to.hsl=function(){var pt=Z(arguments);return pt.length<4||pt[3]===1?"hsl("+pt[0]+", "+pt[1]+"%, "+pt[2]+"%)":"hsla("+pt[0]+", "+pt[1]+"%, "+pt[2]+"%, "+pt[3]+")"},Ot.to.hwb=function(){var pt=Z(arguments),Vt="";return pt.length>=4&&pt[3]!==1&&(Vt=", "+pt[3]),"hwb("+pt[0]+", "+pt[1]+"%, "+pt[2]+"%"+Vt+")"},Ot.to.keyword=function(pt){return yt[pt.slice(0,3)]};function bt(pt,Vt,K){return Math.min(Math.max(Vt,pt),K)}function Et(pt){var Vt=Math.round(pt).toString(16).toUpperCase();return Vt.length<2?"0"+Vt:Vt}},9187:function($t){"use strict";$t.exports=Qt,$t.exports.default=Qt;function Qt(q,Nt,It){It=It||2;var U=Nt&&Nt.length,ht=U?Nt[0]*It:q.length,ne=L(q,0,ht,It,!0),xe=[];if(!ne||ne.next===ne.prev)return xe;var _e,Xe,Re,un,cn,Jt,ct;if(U&&(ne=bt(q,Nt,ne,It)),q.length>80*It){_e=Re=q[0],Xe=un=q[1];for(var Ct=It;Ct<ht;Ct+=It)cn=q[Ct],Jt=q[Ct+1],cn<_e&&(_e=cn),Jt<Xe&&(Xe=Jt),cn>Re&&(Re=cn),Jt>un&&(un=Jt);ct=Math.max(Re-_e,un-Xe),ct=ct!==0?32767/ct:0}return Z(ne,xe,It,_e,Xe,ct,0),xe}function L(q,Nt,It,U,ht){var ne,xe;if(ht===Pt(q,Nt,It,U)>0)for(ne=Nt;ne<It;ne+=U)xe=At(ne,q[ne],q[ne+1],xe);else for(ne=It-U;ne>=Nt;ne-=U)xe=At(ne,q[ne],q[ne+1],xe);return xe&&Me(xe,xe.next)&&(Pe(xe),xe=xe.next),xe}function Y(q,Nt){if(!q)return q;Nt||(Nt=q);var It=q,U;do if(U=!1,!It.steiner&&(Me(It,It.next)||ve(It.prev,It,It.next)===0)){if(Pe(It),It=Nt=It.prev,It===It.next)break;U=!0}else It=It.next;while(U||It!==Nt);return Nt}function Z(q,Nt,It,U,ht,ne,xe){if(q){!xe&&ne&&X(q,U,ht,ne);for(var _e=q,Xe,Re;q.prev!==q.next;){if(Xe=q.prev,Re=q.next,ne?yt(q,U,ht,ne):tt(q)){Nt.push(Xe.i/It|0),Nt.push(q.i/It|0),Nt.push(Re.i/It|0),Pe(q),q=Re.next,_e=Re.next;continue}if(q=Re,q===_e){xe?xe===1?(q=G(Y(q),Nt,It),Z(q,Nt,It,U,ht,ne,2)):xe===2&&Ot(q,Nt,It,U,ht,ne):Z(Y(q),Nt,It,U,ht,ne,1);break}}}}function tt(q){var Nt=q.prev,It=q,U=q.next;if(ve(Nt,It,U)>=0)return!1;for(var ht=Nt.x,ne=It.x,xe=U.x,_e=Nt.y,Xe=It.y,Re=U.y,un=ht<ne?ht<xe?ht:xe:ne<xe?ne:xe,cn=_e<Xe?_e<Re?_e:Re:Xe<Re?Xe:Re,Jt=ht>ne?ht>xe?ht:xe:ne>xe?ne:xe,ct=_e>Xe?_e>Re?_e:Re:Xe>Re?Xe:Re,Ct=U.next;Ct!==Nt;){if(Ct.x>=un&&Ct.x<=Jt&&Ct.y>=cn&&Ct.y<=ct&&Rt(ht,_e,ne,Xe,xe,Re,Ct.x,Ct.y)&&ve(Ct.prev,Ct,Ct.next)>=0)return!1;Ct=Ct.next}return!0}function yt(q,Nt,It,U){var ht=q.prev,ne=q,xe=q.next;if(ve(ht,ne,xe)>=0)return!1;for(var _e=ht.x,Xe=ne.x,Re=xe.x,un=ht.y,cn=ne.y,Jt=xe.y,ct=_e<Xe?_e<Re?_e:Re:Xe<Re?Xe:Re,Ct=un<cn?un<Jt?un:Jt:cn<Jt?cn:Jt,me=_e>Xe?_e>Re?_e:Re:Xe>Re?Xe:Re,he=un>cn?un>Jt?un:Jt:cn>Jt?cn:Jt,Tt=Mt(ct,Ct,Nt,It,U),re=Mt(me,he,Nt,It,U),Yt=q.prevZ,N=q.nextZ;Yt&&Yt.z>=Tt&&N&&N.z<=re;){if(Yt.x>=ct&&Yt.x<=me&&Yt.y>=Ct&&Yt.y<=he&&Yt!==ht&&Yt!==xe&&Rt(_e,un,Xe,cn,Re,Jt,Yt.x,Yt.y)&&ve(Yt.prev,Yt,Yt.next)>=0||(Yt=Yt.prevZ,N.x>=ct&&N.x<=me&&N.y>=Ct&&N.y<=he&&N!==ht&&N!==xe&&Rt(_e,un,Xe,cn,Re,Jt,N.x,N.y)&&ve(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;Yt&&Yt.z>=Tt;){if(Yt.x>=ct&&Yt.x<=me&&Yt.y>=Ct&&Yt.y<=he&&Yt!==ht&&Yt!==xe&&Rt(_e,un,Xe,cn,Re,Jt,Yt.x,Yt.y)&&ve(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.prevZ}for(;N&&N.z<=re;){if(N.x>=ct&&N.x<=me&&N.y>=Ct&&N.y<=he&&N!==ht&&N!==xe&&Rt(_e,un,Xe,cn,Re,Jt,N.x,N.y)&&ve(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function G(q,Nt,It){var U=q;do{var ht=U.prev,ne=U.next.next;!Me(ht,ne)&&Ue(ht,U,U.next,ne)&&nt(ht,ne)&&nt(ne,ht)&&(Nt.push(ht.i/It|0),Nt.push(U.i/It|0),Nt.push(ne.i/It|0),Pe(U),Pe(U.next),U=q=ne),U=U.next}while(U!==q);return Y(U)}function Ot(q,Nt,It,U,ht,ne){var xe=q;do{for(var _e=xe.next.next;_e!==xe.prev;){if(xe.i!==_e.i&&Gt(xe,_e)){var Xe=qt(xe,_e);xe=Y(xe,xe.next),Xe=Y(Xe,Xe.next),Z(xe,Nt,It,U,ht,ne,0),Z(Xe,Nt,It,U,ht,ne,0);return}_e=_e.next}xe=xe.next}while(xe!==q)}function bt(q,Nt,It,U){var ht=[],ne,xe,_e,Xe,Re;for(ne=0,xe=Nt.length;ne<xe;ne++)_e=Nt[ne]*U,Xe=ne<xe-1?Nt[ne+1]*U:q.length,Re=L(q,_e,Xe,U,!1),Re===Re.next&&(Re.steiner=!0),ht.push(zt(Re));for(ht.sort(Et),ne=0;ne<ht.length;ne++)It=pt(ht[ne],It);return It}function Et(q,Nt){return q.x-Nt.x}function pt(q,Nt){var It=Vt(q,Nt);if(!It)return Nt;var U=qt(It,q);return Y(U,U.next),Y(It,It.next)}function Vt(q,Nt){var It=Nt,U=q.x,ht=q.y,ne=-1/0,xe;do{if(ht<=It.y&&ht>=It.next.y&&It.next.y!==It.y){var _e=It.x+(ht-It.y)*(It.next.x-It.x)/(It.next.y-It.y);if(_e<=U&&_e>ne&&(ne=_e,xe=It.x<It.next.x?It:It.next,_e===U))return xe}It=It.next}while(It!==Nt);if(!xe)return null;var Xe=xe,Re=xe.x,un=xe.y,cn=1/0,Jt;It=xe;do U>=It.x&&It.x>=Re&&U!==It.x&&Rt(ht<un?U:ne,ht,Re,un,ht<un?ne:U,ht,It.x,It.y)&&(Jt=Math.abs(ht-It.y)/(U-It.x),nt(It,q)&&(Jt<cn||Jt===cn&&(It.x>xe.x||It.x===xe.x&&K(xe,It)))&&(xe=It,cn=Jt)),It=It.next;while(It!==Xe);return xe}function K(q,Nt){return ve(q.prev,q,Nt.prev)<0&&ve(Nt.next,q,q.next)<0}function X(q,Nt,It,U){var ht=q;do ht.z===0&&(ht.z=Mt(ht.x,ht.y,Nt,It,U)),ht.prevZ=ht.prev,ht.nextZ=ht.next,ht=ht.next;while(ht!==q);ht.prevZ.nextZ=null,ht.prevZ=null,Zt(ht)}function Zt(q){var Nt,It,U,ht,ne,xe,_e,Xe,Re=1;do{for(It=q,q=null,ne=null,xe=0;It;){for(xe++,U=It,_e=0,Nt=0;Nt<Re&&(_e++,U=U.nextZ,!!U);Nt++);for(Xe=Re;_e>0||Xe>0&&U;)_e!==0&&(Xe===0||!U||It.z<=U.z)?(ht=It,It=It.nextZ,_e--):(ht=U,U=U.nextZ,Xe--),ne?ne.nextZ=ht:q=ht,ht.prevZ=ne,ne=ht;It=U}ne.nextZ=null,Re*=2}while(xe>1);return q}function Mt(q,Nt,It,U,ht){return q=(q-It)*ht|0,Nt=(Nt-U)*ht|0,q=(q|q<<8)&16711935,q=(q|q<<4)&252645135,q=(q|q<<2)&858993459,q=(q|q<<1)&1431655765,Nt=(Nt|Nt<<8)&16711935,Nt=(Nt|Nt<<4)&252645135,Nt=(Nt|Nt<<2)&858993459,Nt=(Nt|Nt<<1)&1431655765,q|Nt<<1}function zt(q){var Nt=q,It=q;do(Nt.x<It.x||Nt.x===It.x&&Nt.y<It.y)&&(It=Nt),Nt=Nt.next;while(Nt!==q);return It}function Rt(q,Nt,It,U,ht,ne,xe,_e){return(ht-xe)*(Nt-_e)>=(q-xe)*(ne-_e)&&(q-xe)*(U-_e)>=(It-xe)*(Nt-_e)&&(It-xe)*(ne-_e)>=(ht-xe)*(U-_e)}function Gt(q,Nt){return q.next.i!==Nt.i&&q.prev.i!==Nt.i&&!Ut(q,Nt)&&(nt(q,Nt)&&nt(Nt,q)&&ie(q,Nt)&&(ve(q.prev,q,Nt.prev)||ve(q,Nt.prev,Nt))||Me(q,Nt)&&ve(q.prev,q,q.next)>0&&ve(Nt.prev,Nt,Nt.next)>0)}function ve(q,Nt,It){return(Nt.y-q.y)*(It.x-Nt.x)-(Nt.x-q.x)*(It.y-Nt.y)}function Me(q,Nt){return q.x===Nt.x&&q.y===Nt.y}function Ue(q,Nt,It,U){var ht=we(ve(q,Nt,It)),ne=we(ve(q,Nt,U)),xe=we(ve(It,U,q)),_e=we(ve(It,U,Nt));return!!(ht!==ne&&xe!==_e||ht===0&&Ke(q,It,Nt)||ne===0&&Ke(q,U,Nt)||xe===0&&Ke(It,q,U)||_e===0&&Ke(It,Nt,U))}function Ke(q,Nt,It){return Nt.x<=Math.max(q.x,It.x)&&Nt.x>=Math.min(q.x,It.x)&&Nt.y<=Math.max(q.y,It.y)&&Nt.y>=Math.min(q.y,It.y)}function we(q){return q>0?1:q<0?-1:0}function Ut(q,Nt){var It=q;do{if(It.i!==q.i&&It.next.i!==q.i&&It.i!==Nt.i&&It.next.i!==Nt.i&&Ue(It,It.next,q,Nt))return!0;It=It.next}while(It!==q);return!1}function nt(q,Nt){return ve(q.prev,q,q.next)<0?ve(q,Nt,q.next)>=0&&ve(q,q.prev,Nt)>=0:ve(q,Nt,q.prev)<0||ve(q,q.next,Nt)<0}function ie(q,Nt){var It=q,U=!1,ht=(q.x+Nt.x)/2,ne=(q.y+Nt.y)/2;do It.y>ne!=It.next.y>ne&&It.next.y!==It.y&&ht<(It.next.x-It.x)*(ne-It.y)/(It.next.y-It.y)+It.x&&(U=!U),It=It.next;while(It!==q);return U}function qt(q,Nt){var It=new it(q.i,q.x,q.y),U=new it(Nt.i,Nt.x,Nt.y),ht=q.next,ne=Nt.prev;return q.next=Nt,Nt.prev=q,It.next=ht,ht.prev=It,U.next=It,It.prev=U,ne.next=U,U.prev=ne,U}function At(q,Nt,It,U){var ht=new it(q,Nt,It);return U?(ht.next=U.next,ht.prev=U,U.next.prev=ht,U.next=ht):(ht.prev=ht,ht.next=ht),ht}function Pe(q){q.next.prev=q.prev,q.prev.next=q.next,q.prevZ&&(q.prevZ.nextZ=q.nextZ),q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function it(q,Nt,It){this.i=q,this.x=Nt,this.y=It,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Qt.deviation=function(q,Nt,It,U){var ht=Nt&&Nt.length,ne=ht?Nt[0]*It:q.length,xe=Math.abs(Pt(q,0,ne,It));if(ht)for(var _e=0,Xe=Nt.length;_e<Xe;_e++){var Re=Nt[_e]*It,un=_e<Xe-1?Nt[_e+1]*It:q.length;xe-=Math.abs(Pt(q,Re,un,It))}var cn=0;for(_e=0;_e<U.length;_e+=3){var Jt=U[_e]*It,ct=U[_e+1]*It,Ct=U[_e+2]*It;cn+=Math.abs((q[Jt]-q[Ct])*(q[ct+1]-q[Jt+1])-(q[Jt]-q[ct])*(q[Ct+1]-q[Jt+1]))}return xe===0&&cn===0?0:Math.abs((cn-xe)/xe)};function Pt(q,Nt,It,U){for(var ht=0,ne=Nt,xe=It-U;ne<It;ne+=U)ht+=(q[xe]-q[ne])*(q[ne+1]+q[xe+1]),xe=ne;return ht}Qt.flatten=function(q){for(var Nt=q[0][0].length,It={vertices:[],holes:[],dimensions:Nt},U=0,ht=0;ht<q.length;ht++){for(var ne=0;ne<q[ht].length;ne++)for(var xe=0;xe<Nt;xe++)It.vertices.push(q[ht][ne][xe]);ht>0&&(U+=q[ht-1].length,It.holes.push(U))}return It}},2268:function($t){"use strict";var Qt=$t.exports={};Qt.isIE=function(L){function Y(){var tt=navigator.userAgent.toLowerCase();return tt.indexOf("msie")!==-1||tt.indexOf("trident")!==-1||tt.indexOf(" edge/")!==-1}if(!Y())return!1;if(!L)return!0;var Z=function(){var tt,yt=3,G=document.createElement("div"),Ot=G.getElementsByTagName("i");do G.innerHTML="<!--[if gt IE "+ ++yt+"]><i></i><![endif]-->";while(Ot[0]);return yt>4?yt:tt}();return L===Z},Qt.isLegacyOpera=function(){return!!window.opera}},17900:function($t){"use strict";var Qt=$t.exports={};Qt.forEach=function(L,Y){for(var Z=0;Z<L.length;Z++){var tt=Y(L[Z]);if(tt)return tt}}},58229:function($t,Qt,L){"use strict";var Y=L(2268);$t.exports=function(Z){Z=Z||{};var tt=Z.reporter,yt=Z.batchProcessor,G=Z.stateHandler.getState;if(!tt)throw new Error("Missing required dependency: reporter.");function Ot(K,X){function Zt(){X(K)}if(Y.isIE(8))G(K).object={proxy:Zt},K.attachEvent("onresize",Zt);else{var Mt=pt(K);if(!Mt)throw new Error("Element is not detectable by this strategy.");Mt.contentDocument.defaultView.addEventListener("resize",Zt)}}function bt(K){var X=Z.important?" !important; ":"; ";return(K.join(X)+X).trim()}function Et(K,X,Zt){Zt||(Zt=X,X=K,K=null),K=K||{};var Mt=K.debug;function zt(Rt,Gt){var ve=bt(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),Me=!1,Ue=window.getComputedStyle(Rt),Ke=Rt.offsetWidth,we=Rt.offsetHeight;G(Rt).startSize={width:Ke,height:we};function Ut(){function nt(){if(Ue.position==="static"){Rt.style.setProperty("position","relative",K.important?"important":"");var At=function(Pe,it,Pt,q){function Nt(U){return U.replace(/[^-\d\.]/g,"")}var It=Pt[q];It!=="auto"&&Nt(It)!=="0"&&(Pe.warn("An element that is positioned static has style."+q+"="+It+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+q+" will be set to 0. Element: ",it),it.style.setProperty(q,"0",K.important?"important":""))};At(tt,Rt,Ue,"top"),At(tt,Rt,Ue,"right"),At(tt,Rt,Ue,"bottom"),At(tt,Rt,Ue,"left")}}function ie(){Me||nt();function At(it,Pt){if(!it.contentDocument){var q=G(it);q.checkForObjectDocumentTimeoutId&&window.clearTimeout(q.checkForObjectDocumentTimeoutId),q.checkForObjectDocumentTimeoutId=setTimeout(function(){q.checkForObjectDocumentTimeoutId=0,At(it,Pt)},100);return}Pt(it.contentDocument)}var Pe=this;At(Pe,function(Pt){Gt(Rt)})}Ue.position!==""&&(nt(Ue),Me=!0);var qt=document.createElement("object");qt.style.cssText=ve,qt.tabIndex=-1,qt.type="text/html",qt.setAttribute("aria-hidden","true"),qt.onload=ie,Y.isIE()||(qt.data="about:blank"),G(Rt)&&(Rt.appendChild(qt),G(Rt).object=qt,Y.isIE()&&(qt.data="about:blank"))}yt?yt.add(Ut):Ut()}Y.isIE(8)?Zt(X):zt(X,Zt)}function pt(K){return G(K).object}function Vt(K){if(G(K)){var X=pt(K);X&&(Y.isIE(8)?K.detachEvent("onresize",X.proxy):K.removeChild(X),G(K).checkForObjectDocumentTimeoutId&&window.clearTimeout(G(K).checkForObjectDocumentTimeoutId),delete G(K).object)}}return{makeDetectable:Et,addListener:Ot,uninstall:Vt}}},60787:function($t,Qt,L){"use strict";var Y=L(17900).forEach;$t.exports=function(Z){Z=Z||{};var tt=Z.reporter,yt=Z.batchProcessor,G=Z.stateHandler.getState,Ot=Z.stateHandler.hasState,bt=Z.idHandler;if(!yt)throw new Error("Missing required dependency: batchProcessor");if(!tt)throw new Error("Missing required dependency: reporter.");var Et=Zt(),pt="erd_scroll_detection_scrollbar_style",Vt="erd_scroll_detection_container";function K(Ut){Mt(Ut,pt,Vt)}K(window.document);function X(Ut){var nt=Z.important?" !important; ":"; ";return(Ut.join(nt)+nt).trim()}function Zt(){var Ut=500,nt=500,ie=document.createElement("div");ie.style.cssText=X(["position: absolute","width: "+Ut*2+"px","height: "+nt*2+"px","visibility: hidden","margin: 0","padding: 0"]);var qt=document.createElement("div");qt.style.cssText=X(["position: absolute","width: "+Ut+"px","height: "+nt+"px","overflow: scroll","visibility: none","top: "+-Ut*3+"px","left: "+-nt*3+"px","visibility: hidden","margin: 0","padding: 0"]),qt.appendChild(ie),document.body.insertBefore(qt,document.body.firstChild);var At=Ut-qt.clientWidth,Pe=nt-qt.clientHeight;return document.body.removeChild(qt),{width:At,height:Pe}}function Mt(Ut,nt,ie){function qt(Pt,q){q=q||function(It){Ut.head.appendChild(It)};var Nt=Ut.createElement("style");return Nt.innerHTML=Pt,Nt.id=nt,q(Nt),Nt}if(!Ut.getElementById(nt)){var At=ie+"_animation",Pe=ie+"_animation_active",it=`/* Created by the element-resize-detector library. */
`;it+="."+ie+" > div::-webkit-scrollbar { "+X(["display: none"])+` }

`,it+="."+Pe+" { "+X(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+At,"animation-name: "+At])+` }
`,it+="@-webkit-keyframes "+At+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,it+="@keyframes "+At+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",qt(it)}}function zt(Ut){Ut.className+=" "+Vt+"_animation_active"}function Rt(Ut,nt,ie){if(Ut.addEventListener)Ut.addEventListener(nt,ie);else if(Ut.attachEvent)Ut.attachEvent("on"+nt,ie);else return tt.error("[scroll] Don't know how to add event listeners.")}function Gt(Ut,nt,ie){if(Ut.removeEventListener)Ut.removeEventListener(nt,ie);else if(Ut.detachEvent)Ut.detachEvent("on"+nt,ie);else return tt.error("[scroll] Don't know how to remove event listeners.")}function ve(Ut){return G(Ut).container.childNodes[0].childNodes[0].childNodes[0]}function Me(Ut){return G(Ut).container.childNodes[0].childNodes[0].childNodes[1]}function Ue(Ut,nt){var ie=G(Ut).listeners;if(!ie.push)throw new Error("Cannot add listener to an element that is not detectable.");G(Ut).listeners.push(nt)}function Ke(Ut,nt,ie){ie||(ie=nt,nt=Ut,Ut=null),Ut=Ut||{};function qt(){if(Ut.debug){var Tt=Array.prototype.slice.call(arguments);if(Tt.unshift(bt.get(nt),"Scroll: "),tt.log.apply)tt.log.apply(null,Tt);else for(var re=0;re<Tt.length;re++)tt.log(Tt[re])}}function At(Tt){function re(Yt){var N=Yt.getRootNode&&Yt.getRootNode().contains(Yt);return Yt===Yt.ownerDocument.body||Yt.ownerDocument.body.contains(Yt)||N}return!re(Tt)||window.getComputedStyle(Tt)===null}function Pe(Tt){var re=G(Tt).container.childNodes[0],Yt=window.getComputedStyle(re);return!Yt.width||Yt.width.indexOf("px")===-1}function it(){var Tt=window.getComputedStyle(nt),re={};return re.position=Tt.position,re.width=nt.offsetWidth,re.height=nt.offsetHeight,re.top=Tt.top,re.right=Tt.right,re.bottom=Tt.bottom,re.left=Tt.left,re.widthCSS=Tt.width,re.heightCSS=Tt.height,re}function Pt(){var Tt=it();G(nt).startSize={width:Tt.width,height:Tt.height},qt("Element start size",G(nt).startSize)}function q(){G(nt).listeners=[]}function Nt(){if(qt("storeStyle invoked."),!G(nt)){qt("Aborting because element has been uninstalled");return}var Tt=it();G(nt).style=Tt}function It(Tt,re,Yt){G(Tt).lastWidth=re,G(Tt).lastHeight=Yt}function U(Tt){return ve(Tt).childNodes[0]}function ht(){return 2*Et.width+1}function ne(){return 2*Et.height+1}function xe(Tt){return Tt+10+ht()}function _e(Tt){return Tt+10+ne()}function Xe(Tt){return Tt*2+ht()}function Re(Tt){return Tt*2+ne()}function un(Tt,re,Yt){var N=ve(Tt),kt=Me(Tt),oe=xe(re),C=_e(Yt),z=Xe(re),Ft=Re(Yt);N.scrollLeft=oe,N.scrollTop=C,kt.scrollLeft=z,kt.scrollTop=Ft}function cn(){var Tt=G(nt).container;if(!Tt){Tt=document.createElement("div"),Tt.className=Vt,Tt.style.cssText=X(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),G(nt).container=Tt,zt(Tt),nt.appendChild(Tt);var re=function(){G(nt).onRendered&&G(nt).onRendered()};Rt(Tt,"animationstart",re),G(nt).onAnimationStart=re}return Tt}function Jt(){function Tt(){var ae=G(nt).style;if(ae.position==="static"){nt.style.setProperty("position","relative",Ut.important?"important":"");var ye=function(st,D,H,at){function St(ge){return ge.replace(/[^-\d\.]/g,"")}var Lt=H[at];Lt!=="auto"&&St(Lt)!=="0"&&(st.warn("An element that is positioned static has style."+at+"="+Lt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+at+" will be set to 0. Element: ",D),D.style[at]=0)};ye(tt,nt,ae,"top"),ye(tt,nt,ae,"right"),ye(tt,nt,ae,"bottom"),ye(tt,nt,ae,"left")}}function re(ae,ye,st,D){return ae=ae?ae+"px":"0",ye=ye?ye+"px":"0",st=st?st+"px":"0",D=D?D+"px":"0",["left: "+ae,"top: "+ye,"right: "+D,"bottom: "+st]}if(qt("Injecting elements"),!G(nt)){qt("Aborting because element has been uninstalled");return}Tt();var Yt=G(nt).container;Yt||(Yt=cn());var N=Et.width,kt=Et.height,oe=X(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),C=X(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(re(-(1+N),-(1+kt),-kt,-N))),z=X(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Ft=X(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),te=X(["position: absolute","left: 0","top: 0"]),se=X(["position: absolute","width: 200%","height: 200%"]),Se=document.createElement("div"),be=document.createElement("div"),Ze=document.createElement("div"),tn=document.createElement("div"),Ge=document.createElement("div"),Be=document.createElement("div");Se.dir="ltr",Se.style.cssText=oe,Se.className=Vt,be.className=Vt,be.style.cssText=C,Ze.style.cssText=z,tn.style.cssText=te,Ge.style.cssText=Ft,Be.style.cssText=se,Ze.appendChild(tn),Ge.appendChild(Be),be.appendChild(Ze),be.appendChild(Ge),Se.appendChild(be),Yt.appendChild(Se);function jt(){var ae=G(nt);ae&&ae.onExpand?ae.onExpand():qt("Aborting expand scroll handler: element has been uninstalled")}function ce(){var ae=G(nt);ae&&ae.onShrink?ae.onShrink():qt("Aborting shrink scroll handler: element has been uninstalled")}Rt(Ze,"scroll",jt),Rt(Ge,"scroll",ce),G(nt).onExpandScroll=jt,G(nt).onShrinkScroll=ce}function ct(){function Tt(z,Ft,te){var se=U(z),Se=xe(Ft),be=_e(te);se.style.setProperty("width",Se+"px",Ut.important?"important":""),se.style.setProperty("height",be+"px",Ut.important?"important":"")}function re(z){var Ft=nt.offsetWidth,te=nt.offsetHeight,se=Ft!==G(nt).lastWidth||te!==G(nt).lastHeight;qt("Storing current size",Ft,te),It(nt,Ft,te),yt.add(0,function(){if(se){if(!G(nt)){qt("Aborting because element has been uninstalled");return}if(!Yt()){qt("Aborting because element container has not been initialized");return}if(Ut.debug){var be=nt.offsetWidth,Ze=nt.offsetHeight;(be!==Ft||Ze!==te)&&tt.warn(bt.get(nt),"Scroll: Size changed before updating detector elements.")}Tt(nt,Ft,te)}}),yt.add(1,function(){if(!G(nt)){qt("Aborting because element has been uninstalled");return}if(!Yt()){qt("Aborting because element container has not been initialized");return}un(nt,Ft,te)}),se&&z&&yt.add(2,function(){if(!G(nt)){qt("Aborting because element has been uninstalled");return}if(!Yt()){qt("Aborting because element container has not been initialized");return}z()})}function Yt(){return!!G(nt).container}function N(){function z(){return G(nt).lastNotifiedWidth===void 0}qt("notifyListenersIfNeeded invoked");var Ft=G(nt);if(z()&&Ft.lastWidth===Ft.startSize.width&&Ft.lastHeight===Ft.startSize.height)return qt("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Ft.lastWidth===Ft.lastNotifiedWidth&&Ft.lastHeight===Ft.lastNotifiedHeight)return qt("Not notifying: Size already notified");qt("Current size not notified, notifying..."),Ft.lastNotifiedWidth=Ft.lastWidth,Ft.lastNotifiedHeight=Ft.lastHeight,Y(G(nt).listeners,function(te){te(nt)})}function kt(){if(qt("startanimation triggered."),Pe(nt)){qt("Ignoring since element is still unrendered...");return}qt("Element rendered.");var z=ve(nt),Ft=Me(nt);(z.scrollLeft===0||z.scrollTop===0||Ft.scrollLeft===0||Ft.scrollTop===0)&&(qt("Scrollbars out of sync. Updating detector elements..."),re(N))}function oe(){if(qt("Scroll detected."),Pe(nt)){qt("Scroll event fired while unrendered. Ignoring...");return}re(N)}if(qt("registerListenersAndPositionElements invoked."),!G(nt)){qt("Aborting because element has been uninstalled");return}G(nt).onRendered=kt,G(nt).onExpand=oe,G(nt).onShrink=oe;var C=G(nt).style;Tt(nt,C.width,C.height)}function Ct(){if(qt("finalizeDomMutation invoked."),!G(nt)){qt("Aborting because element has been uninstalled");return}var Tt=G(nt).style;It(nt,Tt.width,Tt.height),un(nt,Tt.width,Tt.height)}function me(){ie(nt)}function he(){qt("Installing..."),q(),Pt(),yt.add(0,Nt),yt.add(1,Jt),yt.add(2,ct),yt.add(3,Ct),yt.add(4,me)}qt("Making detectable..."),At(nt)?(qt("Element is detached"),cn(),qt("Waiting until element is attached..."),G(nt).onRendered=function(){qt("Element is now attached"),he()}):he()}function we(Ut){var nt=G(Ut);nt&&(nt.onExpandScroll&&Gt(ve(Ut),"scroll",nt.onExpandScroll),nt.onShrinkScroll&&Gt(Me(Ut),"scroll",nt.onShrinkScroll),nt.onAnimationStart&&Gt(nt.container,"animationstart",nt.onAnimationStart),nt.container&&Ut.removeChild(nt.container))}return{makeDetectable:Ke,addListener:Ue,uninstall:we,initDocument:K}}},63844:function($t,Qt,L){"use strict";var Y=L(17900).forEach,Z=L(68452),tt=L(96199),yt=L(75805),G=L(79799),Ot=L(71724),bt=L(2268),Et=L(98129),pt=L(21931),Vt=L(58229),K=L(60787);function X(Rt){return Array.isArray(Rt)||Rt.length!==void 0}function Zt(Rt){if(Array.isArray(Rt))return Rt;var Gt=[];return Y(Rt,function(ve){Gt.push(ve)}),Gt}function Mt(Rt){return Rt&&Rt.nodeType===1}$t.exports=function(Rt){Rt=Rt||{};var Gt;if(Rt.idHandler)Gt={get:function(U){return Rt.idHandler.get(U,!0)},set:Rt.idHandler.set};else{var ve=yt(),Me=G({idGenerator:ve,stateHandler:pt});Gt=Me}var Ue=Rt.reporter;if(!Ue){var Ke=Ue===!1;Ue=Ot(Ke)}var we=zt(Rt,"batchProcessor",Et({reporter:Ue})),Ut={};Ut.callOnAdd=!!zt(Rt,"callOnAdd",!0),Ut.debug=!!zt(Rt,"debug",!1);var nt=tt(Gt),ie=Z({stateHandler:pt}),qt,At=zt(Rt,"strategy","object"),Pe=zt(Rt,"important",!1),it={reporter:Ue,batchProcessor:we,stateHandler:pt,idHandler:Gt,important:Pe};if(At==="scroll"&&(bt.isLegacyOpera()?(Ue.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),At="object"):bt.isIE(9)&&(Ue.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),At="object")),At==="scroll")qt=K(it);else if(At==="object")qt=Vt(it);else throw new Error("Invalid strategy name: "+At);var Pt={};function q(U,ht,ne){function xe(Jt){var ct=nt.get(Jt);Y(ct,function(me){me(Jt)})}function _e(Jt,ct,Ct){nt.add(ct,Ct),Jt&&Ct(ct)}if(ne||(ne=ht,ht=U,U={}),!ht)throw new Error("At least one element required.");if(!ne)throw new Error("Listener required.");if(Mt(ht))ht=[ht];else if(X(ht))ht=Zt(ht);else return Ue.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var Xe=0,Re=zt(U,"callOnAdd",Ut.callOnAdd),un=zt(U,"onReady",function(){}),cn=zt(U,"debug",Ut.debug);Y(ht,function(ct){pt.getState(ct)||(pt.initState(ct),Gt.set(ct));var Ct=Gt.get(ct);if(cn&&Ue.log("Attaching listener to element",Ct,ct),!ie.isDetectable(ct)){if(cn&&Ue.log(Ct,"Not detectable."),ie.isBusy(ct)){cn&&Ue.log(Ct,"System busy making it detectable"),_e(Re,ct,ne),Pt[Ct]=Pt[Ct]||[],Pt[Ct].push(function(){Xe++,Xe===ht.length&&un()});return}return cn&&Ue.log(Ct,"Making detectable..."),ie.markBusy(ct,!0),qt.makeDetectable({debug:cn,important:Pe},ct,function(he){if(cn&&Ue.log(Ct,"onElementDetectable"),pt.getState(he)){ie.markAsDetectable(he),ie.markBusy(he,!1),qt.addListener(he,xe),_e(Re,he,ne);var Tt=pt.getState(he);if(Tt&&Tt.startSize){var re=he.offsetWidth,Yt=he.offsetHeight;(Tt.startSize.width!==re||Tt.startSize.height!==Yt)&&xe(he)}Pt[Ct]&&Y(Pt[Ct],function(N){N()})}else cn&&Ue.log(Ct,"Element uninstalled before being detectable.");delete Pt[Ct],Xe++,Xe===ht.length&&un()})}cn&&Ue.log(Ct,"Already detecable, adding listener."),_e(Re,ct,ne),Xe++}),Xe===ht.length&&un()}function Nt(U){if(!U)return Ue.error("At least one element is required.");if(Mt(U))U=[U];else if(X(U))U=Zt(U);else return Ue.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");Y(U,function(ht){nt.removeAllListeners(ht),qt.uninstall(ht),pt.cleanState(ht)})}function It(U){qt.initDocument&&qt.initDocument(U)}return{listenTo:q,removeListener:nt.removeListener,removeAllListeners:nt.removeAllListeners,uninstall:Nt,initDocument:It}};function zt(Rt,Gt,ve){var Me=Rt[Gt];return Me==null&&ve!==void 0?ve:Me}},68452:function($t){"use strict";$t.exports=function(Qt){var L=Qt.stateHandler.getState;function Y(G){var Ot=L(G);return Ot&&!!Ot.isDetectable}function Z(G){L(G).isDetectable=!0}function tt(G){return!!L(G).busy}function yt(G,Ot){L(G).busy=!!Ot}return{isDetectable:Y,markAsDetectable:Z,isBusy:tt,markBusy:yt}}},75805:function($t){"use strict";$t.exports=function(){var Qt=1;function L(){return Qt++}return{generate:L}}},79799:function($t){"use strict";$t.exports=function(Qt){var L=Qt.idGenerator,Y=Qt.stateHandler.getState;function Z(yt){var G=Y(yt);return G&&G.id!==void 0?G.id:null}function tt(yt){var G=Y(yt);if(!G)throw new Error("setId required the element to have a resize detection state.");var Ot=L.generate();return G.id=Ot,Ot}return{get:Z,set:tt}}},96199:function($t){"use strict";$t.exports=function(Qt){var L={};function Y(G){var Ot=Qt.get(G);return Ot===void 0?[]:L[Ot]||[]}function Z(G,Ot){var bt=Qt.get(G);L[bt]||(L[bt]=[]),L[bt].push(Ot)}function tt(G,Ot){for(var bt=Y(G),Et=0,pt=bt.length;Et<pt;++Et)if(bt[Et]===Ot){bt.splice(Et,1);break}}function yt(G){var Ot=Y(G);Ot&&(Ot.length=0)}return{get:Y,add:Z,removeListener:tt,removeAllListeners:yt}}},71724:function($t){"use strict";$t.exports=function(Qt){function L(){}var Y={log:L,warn:L,error:L};if(!Qt&&window.console){var Z=function(tt,yt){tt[yt]=function(){var Ot=console[yt];if(Ot.apply)Ot.apply(console,arguments);else for(var bt=0;bt<arguments.length;bt++)Ot(arguments[bt])}};Z(Y,"log"),Z(Y,"warn"),Z(Y,"error")}return Y}},21931:function($t){"use strict";var Qt="_erd";function L(tt){return tt[Qt]={},Y(tt)}function Y(tt){return tt[Qt]}function Z(tt){delete tt[Qt]}$t.exports={initState:L,getState:Y,cleanState:Z}},26729:function($t){"use strict";var Qt=Object.prototype.hasOwnProperty,L="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(L=!1));function Z(Ot,bt,Et){this.fn=Ot,this.context=bt,this.once=Et||!1}function tt(Ot,bt,Et,pt,Vt){if(typeof Et!="function")throw new TypeError("The listener must be a function");var K=new Z(Et,pt||Ot,Vt),X=L?L+bt:bt;return Ot._events[X]?Ot._events[X].fn?Ot._events[X]=[Ot._events[X],K]:Ot._events[X].push(K):(Ot._events[X]=K,Ot._eventsCount++),Ot}function yt(Ot,bt){--Ot._eventsCount===0?Ot._events=new Y:delete Ot._events[bt]}function G(){this._events=new Y,this._eventsCount=0}G.prototype.eventNames=function(){var bt=[],Et,pt;if(this._eventsCount===0)return bt;for(pt in Et=this._events)Qt.call(Et,pt)&&bt.push(L?pt.slice(1):pt);return Object.getOwnPropertySymbols?bt.concat(Object.getOwnPropertySymbols(Et)):bt},G.prototype.listeners=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Vt=0,K=pt.length,X=new Array(K);Vt<K;Vt++)X[Vt]=pt[Vt].fn;return X},G.prototype.listenerCount=function(bt){var Et=L?L+bt:bt,pt=this._events[Et];return pt?pt.fn?1:pt.length:0},G.prototype.emit=function(bt,Et,pt,Vt,K,X){var Zt=L?L+bt:bt;if(!this._events[Zt])return!1;var Mt=this._events[Zt],zt=arguments.length,Rt,Gt;if(Mt.fn){switch(Mt.once&&this.removeListener(bt,Mt.fn,void 0,!0),zt){case 1:return Mt.fn.call(Mt.context),!0;case 2:return Mt.fn.call(Mt.context,Et),!0;case 3:return Mt.fn.call(Mt.context,Et,pt),!0;case 4:return Mt.fn.call(Mt.context,Et,pt,Vt),!0;case 5:return Mt.fn.call(Mt.context,Et,pt,Vt,K),!0;case 6:return Mt.fn.call(Mt.context,Et,pt,Vt,K,X),!0}for(Gt=1,Rt=new Array(zt-1);Gt<zt;Gt++)Rt[Gt-1]=arguments[Gt];Mt.fn.apply(Mt.context,Rt)}else{var ve=Mt.length,Me;for(Gt=0;Gt<ve;Gt++)switch(Mt[Gt].once&&this.removeListener(bt,Mt[Gt].fn,void 0,!0),zt){case 1:Mt[Gt].fn.call(Mt[Gt].context);break;case 2:Mt[Gt].fn.call(Mt[Gt].context,Et);break;case 3:Mt[Gt].fn.call(Mt[Gt].context,Et,pt);break;case 4:Mt[Gt].fn.call(Mt[Gt].context,Et,pt,Vt);break;default:if(!Rt)for(Me=1,Rt=new Array(zt-1);Me<zt;Me++)Rt[Me-1]=arguments[Me];Mt[Gt].fn.apply(Mt[Gt].context,Rt)}}return!0},G.prototype.on=function(bt,Et,pt){return tt(this,bt,Et,pt,!1)},G.prototype.once=function(bt,Et,pt){return tt(this,bt,Et,pt,!0)},G.prototype.removeListener=function(bt,Et,pt,Vt){var K=L?L+bt:bt;if(!this._events[K])return this;if(!Et)return yt(this,K),this;var X=this._events[K];if(X.fn)X.fn===Et&&(!Vt||X.once)&&(!pt||X.context===pt)&&yt(this,K);else{for(var Zt=0,Mt=[],zt=X.length;Zt<zt;Zt++)(X[Zt].fn!==Et||Vt&&!X[Zt].once||pt&&X[Zt].context!==pt)&&Mt.push(X[Zt]);Mt.length?this._events[K]=Mt.length===1?Mt[0]:Mt:yt(this,K)}return this},G.prototype.removeAllListeners=function(bt){var Et;return bt?(Et=L?L+bt:bt,this._events[Et]&&yt(this,Et)):(this._events=new Y,this._eventsCount=0),this},G.prototype.off=G.prototype.removeListener,G.prototype.addListener=G.prototype.on,G.prefixed=L,G.EventEmitter=G,$t.exports=G},49685:function($t,Qt,L){"use strict";L.d(Qt,{Ib:function(){return Y},WT:function(){return Z},yy:function(){return yt}});var Y=1e-6,Z=typeof Float32Array!="undefined"?Float32Array:Array,tt=Math.random,yt="zyx";function G(X){return X>=0?Math.round(X):X%.5===0?Math.floor(X):Math.round(X)}function Ot(X){Z=X}var bt=Math.PI/180,Et=180/Math.PI;function pt(X){return X*bt}function Vt(X){return X*Et}function K(X,Zt){var Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Y;return Math.abs(X-Zt)<=Mt*Math.max(1,Math.abs(X),Math.abs(Zt))}},35600:function($t,Qt,L){"use strict";L.d(Qt,{Ue:function(){return Z},al:function(){return Ot},xO:function(){return tt}});var Y=L(49685);function Z(){var U=new Y.WT(9);return Y.WT!=Float32Array&&(U[1]=0,U[2]=0,U[3]=0,U[5]=0,U[6]=0,U[7]=0),U[0]=1,U[4]=1,U[8]=1,U}function tt(U,ht){return U[0]=ht[0],U[1]=ht[1],U[2]=ht[2],U[3]=ht[4],U[4]=ht[5],U[5]=ht[6],U[6]=ht[8],U[7]=ht[9],U[8]=ht[10],U}function yt(U){var ht=new glMatrix.ARRAY_TYPE(9);return ht[0]=U[0],ht[1]=U[1],ht[2]=U[2],ht[3]=U[3],ht[4]=U[4],ht[5]=U[5],ht[6]=U[6],ht[7]=U[7],ht[8]=U[8],ht}function G(U,ht){return U[0]=ht[0],U[1]=ht[1],U[2]=ht[2],U[3]=ht[3],U[4]=ht[4],U[5]=ht[5],U[6]=ht[6],U[7]=ht[7],U[8]=ht[8],U}function Ot(U,ht,ne,xe,_e,Xe,Re,un,cn){var Jt=new Y.WT(9);return Jt[0]=U,Jt[1]=ht,Jt[2]=ne,Jt[3]=xe,Jt[4]=_e,Jt[5]=Xe,Jt[6]=Re,Jt[7]=un,Jt[8]=cn,Jt}function bt(U,ht,ne,xe,_e,Xe,Re,un,cn,Jt){return U[0]=ht,U[1]=ne,U[2]=xe,U[3]=_e,U[4]=Xe,U[5]=Re,U[6]=un,U[7]=cn,U[8]=Jt,U}function Et(U){return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=1,U[5]=0,U[6]=0,U[7]=0,U[8]=1,U}function pt(U,ht){if(U===ht){var ne=ht[1],xe=ht[2],_e=ht[5];U[1]=ht[3],U[2]=ht[6],U[3]=ne,U[5]=ht[7],U[6]=xe,U[7]=_e}else U[0]=ht[0],U[1]=ht[3],U[2]=ht[6],U[3]=ht[1],U[4]=ht[4],U[5]=ht[7],U[6]=ht[2],U[7]=ht[5],U[8]=ht[8];return U}function Vt(U,ht){var ne=ht[0],xe=ht[1],_e=ht[2],Xe=ht[3],Re=ht[4],un=ht[5],cn=ht[6],Jt=ht[7],ct=ht[8],Ct=ct*Re-un*Jt,me=-ct*Xe+un*cn,he=Jt*Xe-Re*cn,Tt=ne*Ct+xe*me+_e*he;return Tt?(Tt=1/Tt,U[0]=Ct*Tt,U[1]=(-ct*xe+_e*Jt)*Tt,U[2]=(un*xe-_e*Re)*Tt,U[3]=me*Tt,U[4]=(ct*ne-_e*cn)*Tt,U[5]=(-un*ne+_e*Xe)*Tt,U[6]=he*Tt,U[7]=(-Jt*ne+xe*cn)*Tt,U[8]=(Re*ne-xe*Xe)*Tt,U):null}function K(U,ht){var ne=ht[0],xe=ht[1],_e=ht[2],Xe=ht[3],Re=ht[4],un=ht[5],cn=ht[6],Jt=ht[7],ct=ht[8];return U[0]=Re*ct-un*Jt,U[1]=_e*Jt-xe*ct,U[2]=xe*un-_e*Re,U[3]=un*cn-Xe*ct,U[4]=ne*ct-_e*cn,U[5]=_e*Xe-ne*un,U[6]=Xe*Jt-Re*cn,U[7]=xe*cn-ne*Jt,U[8]=ne*Re-xe*Xe,U}function X(U){var ht=U[0],ne=U[1],xe=U[2],_e=U[3],Xe=U[4],Re=U[5],un=U[6],cn=U[7],Jt=U[8];return ht*(Jt*Xe-Re*cn)+ne*(-Jt*_e+Re*un)+xe*(cn*_e-Xe*un)}function Zt(U,ht,ne){var xe=ht[0],_e=ht[1],Xe=ht[2],Re=ht[3],un=ht[4],cn=ht[5],Jt=ht[6],ct=ht[7],Ct=ht[8],me=ne[0],he=ne[1],Tt=ne[2],re=ne[3],Yt=ne[4],N=ne[5],kt=ne[6],oe=ne[7],C=ne[8];return U[0]=me*xe+he*Re+Tt*Jt,U[1]=me*_e+he*un+Tt*ct,U[2]=me*Xe+he*cn+Tt*Ct,U[3]=re*xe+Yt*Re+N*Jt,U[4]=re*_e+Yt*un+N*ct,U[5]=re*Xe+Yt*cn+N*Ct,U[6]=kt*xe+oe*Re+C*Jt,U[7]=kt*_e+oe*un+C*ct,U[8]=kt*Xe+oe*cn+C*Ct,U}function Mt(U,ht,ne){var xe=ht[0],_e=ht[1],Xe=ht[2],Re=ht[3],un=ht[4],cn=ht[5],Jt=ht[6],ct=ht[7],Ct=ht[8],me=ne[0],he=ne[1];return U[0]=xe,U[1]=_e,U[2]=Xe,U[3]=Re,U[4]=un,U[5]=cn,U[6]=me*xe+he*Re+Jt,U[7]=me*_e+he*un+ct,U[8]=me*Xe+he*cn+Ct,U}function zt(U,ht,ne){var xe=ht[0],_e=ht[1],Xe=ht[2],Re=ht[3],un=ht[4],cn=ht[5],Jt=ht[6],ct=ht[7],Ct=ht[8],me=Math.sin(ne),he=Math.cos(ne);return U[0]=he*xe+me*Re,U[1]=he*_e+me*un,U[2]=he*Xe+me*cn,U[3]=he*Re-me*xe,U[4]=he*un-me*_e,U[5]=he*cn-me*Xe,U[6]=Jt,U[7]=ct,U[8]=Ct,U}function Rt(U,ht,ne){var xe=ne[0],_e=ne[1];return U[0]=xe*ht[0],U[1]=xe*ht[1],U[2]=xe*ht[2],U[3]=_e*ht[3],U[4]=_e*ht[4],U[5]=_e*ht[5],U[6]=ht[6],U[7]=ht[7],U[8]=ht[8],U}function Gt(U,ht){return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=1,U[5]=0,U[6]=ht[0],U[7]=ht[1],U[8]=1,U}function ve(U,ht){var ne=Math.sin(ht),xe=Math.cos(ht);return U[0]=xe,U[1]=ne,U[2]=0,U[3]=-ne,U[4]=xe,U[5]=0,U[6]=0,U[7]=0,U[8]=1,U}function Me(U,ht){return U[0]=ht[0],U[1]=0,U[2]=0,U[3]=0,U[4]=ht[1],U[5]=0,U[6]=0,U[7]=0,U[8]=1,U}function Ue(U,ht){return U[0]=ht[0],U[1]=ht[1],U[2]=0,U[3]=ht[2],U[4]=ht[3],U[5]=0,U[6]=ht[4],U[7]=ht[5],U[8]=1,U}function Ke(U,ht){var ne=ht[0],xe=ht[1],_e=ht[2],Xe=ht[3],Re=ne+ne,un=xe+xe,cn=_e+_e,Jt=ne*Re,ct=xe*Re,Ct=xe*un,me=_e*Re,he=_e*un,Tt=_e*cn,re=Xe*Re,Yt=Xe*un,N=Xe*cn;return U[0]=1-Ct-Tt,U[3]=ct-N,U[6]=me+Yt,U[1]=ct+N,U[4]=1-Jt-Tt,U[7]=he-re,U[2]=me-Yt,U[5]=he+re,U[8]=1-Jt-Ct,U}function we(U,ht){var ne=ht[0],xe=ht[1],_e=ht[2],Xe=ht[3],Re=ht[4],un=ht[5],cn=ht[6],Jt=ht[7],ct=ht[8],Ct=ht[9],me=ht[10],he=ht[11],Tt=ht[12],re=ht[13],Yt=ht[14],N=ht[15],kt=ne*un-xe*Re,oe=ne*cn-_e*Re,C=ne*Jt-Xe*Re,z=xe*cn-_e*un,Ft=xe*Jt-Xe*un,te=_e*Jt-Xe*cn,se=ct*re-Ct*Tt,Se=ct*Yt-me*Tt,be=ct*N-he*Tt,Ze=Ct*Yt-me*re,tn=Ct*N-he*re,Ge=me*N-he*Yt,Be=kt*Ge-oe*tn+C*Ze+z*be-Ft*Se+te*se;return Be?(Be=1/Be,U[0]=(un*Ge-cn*tn+Jt*Ze)*Be,U[1]=(cn*be-Re*Ge-Jt*Se)*Be,U[2]=(Re*tn-un*be+Jt*se)*Be,U[3]=(_e*tn-xe*Ge-Xe*Ze)*Be,U[4]=(ne*Ge-_e*be+Xe*Se)*Be,U[5]=(xe*be-ne*tn-Xe*se)*Be,U[6]=(re*te-Yt*Ft+N*z)*Be,U[7]=(Yt*C-Tt*te-N*oe)*Be,U[8]=(Tt*Ft-re*C+N*kt)*Be,U):null}function Ut(U,ht,ne){return U[0]=2/ht,U[1]=0,U[2]=0,U[3]=0,U[4]=-2/ne,U[5]=0,U[6]=-1,U[7]=1,U[8]=1,U}function nt(U){return"mat3("+U[0]+", "+U[1]+", "+U[2]+", "+U[3]+", "+U[4]+", "+U[5]+", "+U[6]+", "+U[7]+", "+U[8]+")"}function ie(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1]+U[2]*U[2]+U[3]*U[3]+U[4]*U[4]+U[5]*U[5]+U[6]*U[6]+U[7]*U[7]+U[8]*U[8])}function qt(U,ht,ne){return U[0]=ht[0]+ne[0],U[1]=ht[1]+ne[1],U[2]=ht[2]+ne[2],U[3]=ht[3]+ne[3],U[4]=ht[4]+ne[4],U[5]=ht[5]+ne[5],U[6]=ht[6]+ne[6],U[7]=ht[7]+ne[7],U[8]=ht[8]+ne[8],U}function At(U,ht,ne){return U[0]=ht[0]-ne[0],U[1]=ht[1]-ne[1],U[2]=ht[2]-ne[2],U[3]=ht[3]-ne[3],U[4]=ht[4]-ne[4],U[5]=ht[5]-ne[5],U[6]=ht[6]-ne[6],U[7]=ht[7]-ne[7],U[8]=ht[8]-ne[8],U}function Pe(U,ht,ne){return U[0]=ht[0]*ne,U[1]=ht[1]*ne,U[2]=ht[2]*ne,U[3]=ht[3]*ne,U[4]=ht[4]*ne,U[5]=ht[5]*ne,U[6]=ht[6]*ne,U[7]=ht[7]*ne,U[8]=ht[8]*ne,U}function it(U,ht,ne,xe){return U[0]=ht[0]+ne[0]*xe,U[1]=ht[1]+ne[1]*xe,U[2]=ht[2]+ne[2]*xe,U[3]=ht[3]+ne[3]*xe,U[4]=ht[4]+ne[4]*xe,U[5]=ht[5]+ne[5]*xe,U[6]=ht[6]+ne[6]*xe,U[7]=ht[7]+ne[7]*xe,U[8]=ht[8]+ne[8]*xe,U}function Pt(U,ht){return U[0]===ht[0]&&U[1]===ht[1]&&U[2]===ht[2]&&U[3]===ht[3]&&U[4]===ht[4]&&U[5]===ht[5]&&U[6]===ht[6]&&U[7]===ht[7]&&U[8]===ht[8]}function q(U,ht){var ne=U[0],xe=U[1],_e=U[2],Xe=U[3],Re=U[4],un=U[5],cn=U[6],Jt=U[7],ct=U[8],Ct=ht[0],me=ht[1],he=ht[2],Tt=ht[3],re=ht[4],Yt=ht[5],N=ht[6],kt=ht[7],oe=ht[8];return Math.abs(ne-Ct)<=glMatrix.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ct))&&Math.abs(xe-me)<=glMatrix.EPSILON*Math.max(1,Math.abs(xe),Math.abs(me))&&Math.abs(_e-he)<=glMatrix.EPSILON*Math.max(1,Math.abs(_e),Math.abs(he))&&Math.abs(Xe-Tt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Xe),Math.abs(Tt))&&Math.abs(Re-re)<=glMatrix.EPSILON*Math.max(1,Math.abs(Re),Math.abs(re))&&Math.abs(un-Yt)<=glMatrix.EPSILON*Math.max(1,Math.abs(un),Math.abs(Yt))&&Math.abs(cn-N)<=glMatrix.EPSILON*Math.max(1,Math.abs(cn),Math.abs(N))&&Math.abs(Jt-kt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Jt),Math.abs(kt))&&Math.abs(ct-oe)<=glMatrix.EPSILON*Math.max(1,Math.abs(ct),Math.abs(oe))}var Nt=null,It=null},85975:function($t,Qt,L){"use strict";L.r(Qt),L.d(Qt,{add:function(){return me},adjoint:function(){return Vt},clone:function(){return tt},copy:function(){return yt},create:function(){return Z},decompose:function(){return Pt},determinant:function(){return K},equals:function(){return N},exactEquals:function(){return Yt},frob:function(){return Ct},fromQuat:function(){return It},fromQuat2:function(){return qt},fromRotation:function(){return Ke},fromRotationTranslation:function(){return ie},fromRotationTranslationScale:function(){return q},fromRotationTranslationScaleOrigin:function(){return Nt},fromScaling:function(){return Ue},fromTranslation:function(){return Me},fromValues:function(){return G},fromXRotation:function(){return we},fromYRotation:function(){return Ut},fromZRotation:function(){return nt},frustum:function(){return U},getRotation:function(){return it},getScaling:function(){return Pe},getTranslation:function(){return At},identity:function(){return bt},invert:function(){return pt},lookAt:function(){return cn},mul:function(){return kt},multiply:function(){return X},multiplyScalar:function(){return Tt},multiplyScalarAndAdd:function(){return re},ortho:function(){return Re},orthoNO:function(){return Xe},orthoZO:function(){return un},perspective:function(){return ne},perspectiveFromFieldOfView:function(){return _e},perspectiveNO:function(){return ht},perspectiveZO:function(){return xe},rotate:function(){return zt},rotateX:function(){return Rt},rotateY:function(){return Gt},rotateZ:function(){return ve},scale:function(){return Mt},set:function(){return Ot},str:function(){return ct},sub:function(){return oe},subtract:function(){return he},targetTo:function(){return Jt},translate:function(){return Zt},transpose:function(){return Et}});var Y=L(49685);function Z(){var C=new Y.WT(16);return Y.WT!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function tt(C){var z=new Y.WT(16);return z[0]=C[0],z[1]=C[1],z[2]=C[2],z[3]=C[3],z[4]=C[4],z[5]=C[5],z[6]=C[6],z[7]=C[7],z[8]=C[8],z[9]=C[9],z[10]=C[10],z[11]=C[11],z[12]=C[12],z[13]=C[13],z[14]=C[14],z[15]=C[15],z}function yt(C,z){return C[0]=z[0],C[1]=z[1],C[2]=z[2],C[3]=z[3],C[4]=z[4],C[5]=z[5],C[6]=z[6],C[7]=z[7],C[8]=z[8],C[9]=z[9],C[10]=z[10],C[11]=z[11],C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15],C}function G(C,z,Ft,te,se,Se,be,Ze,tn,Ge,Be,jt,ce,ae,ye,st){var D=new Y.WT(16);return D[0]=C,D[1]=z,D[2]=Ft,D[3]=te,D[4]=se,D[5]=Se,D[6]=be,D[7]=Ze,D[8]=tn,D[9]=Ge,D[10]=Be,D[11]=jt,D[12]=ce,D[13]=ae,D[14]=ye,D[15]=st,D}function Ot(C,z,Ft,te,se,Se,be,Ze,tn,Ge,Be,jt,ce,ae,ye,st,D){return C[0]=z,C[1]=Ft,C[2]=te,C[3]=se,C[4]=Se,C[5]=be,C[6]=Ze,C[7]=tn,C[8]=Ge,C[9]=Be,C[10]=jt,C[11]=ce,C[12]=ae,C[13]=ye,C[14]=st,C[15]=D,C}function bt(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Et(C,z){if(C===z){var Ft=z[1],te=z[2],se=z[3],Se=z[6],be=z[7],Ze=z[11];C[1]=z[4],C[2]=z[8],C[3]=z[12],C[4]=Ft,C[6]=z[9],C[7]=z[13],C[8]=te,C[9]=Se,C[11]=z[14],C[12]=se,C[13]=be,C[14]=Ze}else C[0]=z[0],C[1]=z[4],C[2]=z[8],C[3]=z[12],C[4]=z[1],C[5]=z[5],C[6]=z[9],C[7]=z[13],C[8]=z[2],C[9]=z[6],C[10]=z[10],C[11]=z[14],C[12]=z[3],C[13]=z[7],C[14]=z[11],C[15]=z[15];return C}function pt(C,z){var Ft=z[0],te=z[1],se=z[2],Se=z[3],be=z[4],Ze=z[5],tn=z[6],Ge=z[7],Be=z[8],jt=z[9],ce=z[10],ae=z[11],ye=z[12],st=z[13],D=z[14],H=z[15],at=Ft*Ze-te*be,St=Ft*tn-se*be,Lt=Ft*Ge-Se*be,ge=te*tn-se*Ze,de=te*Ge-Se*Ze,ze=se*Ge-Se*tn,Ne=Be*st-jt*ye,sn=Be*D-ce*ye,Ce=Be*H-ae*ye,en=jt*D-ce*st,dn=jt*H-ae*st,En=ce*H-ae*D,mn=at*En-St*dn+Lt*en+ge*Ce-de*sn+ze*Ne;return mn?(mn=1/mn,C[0]=(Ze*En-tn*dn+Ge*en)*mn,C[1]=(se*dn-te*En-Se*en)*mn,C[2]=(st*ze-D*de+H*ge)*mn,C[3]=(ce*de-jt*ze-ae*ge)*mn,C[4]=(tn*Ce-be*En-Ge*sn)*mn,C[5]=(Ft*En-se*Ce+Se*sn)*mn,C[6]=(D*Lt-ye*ze-H*St)*mn,C[7]=(Be*ze-ce*Lt+ae*St)*mn,C[8]=(be*dn-Ze*Ce+Ge*Ne)*mn,C[9]=(te*Ce-Ft*dn-Se*Ne)*mn,C[10]=(ye*de-st*Lt+H*at)*mn,C[11]=(jt*Lt-Be*de-ae*at)*mn,C[12]=(Ze*sn-be*en-tn*Ne)*mn,C[13]=(Ft*en-te*sn+se*Ne)*mn,C[14]=(st*St-ye*ge-D*at)*mn,C[15]=(Be*ge-jt*St+ce*at)*mn,C):null}function Vt(C,z){var Ft=z[0],te=z[1],se=z[2],Se=z[3],be=z[4],Ze=z[5],tn=z[6],Ge=z[7],Be=z[8],jt=z[9],ce=z[10],ae=z[11],ye=z[12],st=z[13],D=z[14],H=z[15],at=Ft*Ze-te*be,St=Ft*tn-se*be,Lt=Ft*Ge-Se*be,ge=te*tn-se*Ze,de=te*Ge-Se*Ze,ze=se*Ge-Se*tn,Ne=Be*st-jt*ye,sn=Be*D-ce*ye,Ce=Be*H-ae*ye,en=jt*D-ce*st,dn=jt*H-ae*st,En=ce*H-ae*D;return C[0]=Ze*En-tn*dn+Ge*en,C[1]=se*dn-te*En-Se*en,C[2]=st*ze-D*de+H*ge,C[3]=ce*de-jt*ze-ae*ge,C[4]=tn*Ce-be*En-Ge*sn,C[5]=Ft*En-se*Ce+Se*sn,C[6]=D*Lt-ye*ze-H*St,C[7]=Be*ze-ce*Lt+ae*St,C[8]=be*dn-Ze*Ce+Ge*Ne,C[9]=te*Ce-Ft*dn-Se*Ne,C[10]=ye*de-st*Lt+H*at,C[11]=jt*Lt-Be*de-ae*at,C[12]=Ze*sn-be*en-tn*Ne,C[13]=Ft*en-te*sn+se*Ne,C[14]=st*St-ye*ge-D*at,C[15]=Be*ge-jt*St+ce*at,C}function K(C){var z=C[0],Ft=C[1],te=C[2],se=C[3],Se=C[4],be=C[5],Ze=C[6],tn=C[7],Ge=C[8],Be=C[9],jt=C[10],ce=C[11],ae=C[12],ye=C[13],st=C[14],D=C[15],H=z*be-Ft*Se,at=z*Ze-te*Se,St=Ft*Ze-te*be,Lt=Ge*ye-Be*ae,ge=Ge*st-jt*ae,de=Be*st-jt*ye,ze=z*de-Ft*ge+te*Lt,Ne=Se*de-be*ge+Ze*Lt,sn=Ge*St-Be*at+jt*H,Ce=ae*St-ye*at+st*H;return tn*ze-se*Ne+D*sn-ce*Ce}function X(C,z,Ft){var te=z[0],se=z[1],Se=z[2],be=z[3],Ze=z[4],tn=z[5],Ge=z[6],Be=z[7],jt=z[8],ce=z[9],ae=z[10],ye=z[11],st=z[12],D=z[13],H=z[14],at=z[15],St=Ft[0],Lt=Ft[1],ge=Ft[2],de=Ft[3];return C[0]=St*te+Lt*Ze+ge*jt+de*st,C[1]=St*se+Lt*tn+ge*ce+de*D,C[2]=St*Se+Lt*Ge+ge*ae+de*H,C[3]=St*be+Lt*Be+ge*ye+de*at,St=Ft[4],Lt=Ft[5],ge=Ft[6],de=Ft[7],C[4]=St*te+Lt*Ze+ge*jt+de*st,C[5]=St*se+Lt*tn+ge*ce+de*D,C[6]=St*Se+Lt*Ge+ge*ae+de*H,C[7]=St*be+Lt*Be+ge*ye+de*at,St=Ft[8],Lt=Ft[9],ge=Ft[10],de=Ft[11],C[8]=St*te+Lt*Ze+ge*jt+de*st,C[9]=St*se+Lt*tn+ge*ce+de*D,C[10]=St*Se+Lt*Ge+ge*ae+de*H,C[11]=St*be+Lt*Be+ge*ye+de*at,St=Ft[12],Lt=Ft[13],ge=Ft[14],de=Ft[15],C[12]=St*te+Lt*Ze+ge*jt+de*st,C[13]=St*se+Lt*tn+ge*ce+de*D,C[14]=St*Se+Lt*Ge+ge*ae+de*H,C[15]=St*be+Lt*Be+ge*ye+de*at,C}function Zt(C,z,Ft){var te=Ft[0],se=Ft[1],Se=Ft[2],be,Ze,tn,Ge,Be,jt,ce,ae,ye,st,D,H;return z===C?(C[12]=z[0]*te+z[4]*se+z[8]*Se+z[12],C[13]=z[1]*te+z[5]*se+z[9]*Se+z[13],C[14]=z[2]*te+z[6]*se+z[10]*Se+z[14],C[15]=z[3]*te+z[7]*se+z[11]*Se+z[15]):(be=z[0],Ze=z[1],tn=z[2],Ge=z[3],Be=z[4],jt=z[5],ce=z[6],ae=z[7],ye=z[8],st=z[9],D=z[10],H=z[11],C[0]=be,C[1]=Ze,C[2]=tn,C[3]=Ge,C[4]=Be,C[5]=jt,C[6]=ce,C[7]=ae,C[8]=ye,C[9]=st,C[10]=D,C[11]=H,C[12]=be*te+Be*se+ye*Se+z[12],C[13]=Ze*te+jt*se+st*Se+z[13],C[14]=tn*te+ce*se+D*Se+z[14],C[15]=Ge*te+ae*se+H*Se+z[15]),C}function Mt(C,z,Ft){var te=Ft[0],se=Ft[1],Se=Ft[2];return C[0]=z[0]*te,C[1]=z[1]*te,C[2]=z[2]*te,C[3]=z[3]*te,C[4]=z[4]*se,C[5]=z[5]*se,C[6]=z[6]*se,C[7]=z[7]*se,C[8]=z[8]*Se,C[9]=z[9]*Se,C[10]=z[10]*Se,C[11]=z[11]*Se,C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15],C}function zt(C,z,Ft,te){var se=te[0],Se=te[1],be=te[2],Ze=Math.sqrt(se*se+Se*Se+be*be),tn,Ge,Be,jt,ce,ae,ye,st,D,H,at,St,Lt,ge,de,ze,Ne,sn,Ce,en,dn,En,mn,jn;return Ze<Y.Ib?null:(Ze=1/Ze,se*=Ze,Se*=Ze,be*=Ze,tn=Math.sin(Ft),Ge=Math.cos(Ft),Be=1-Ge,jt=z[0],ce=z[1],ae=z[2],ye=z[3],st=z[4],D=z[5],H=z[6],at=z[7],St=z[8],Lt=z[9],ge=z[10],de=z[11],ze=se*se*Be+Ge,Ne=Se*se*Be+be*tn,sn=be*se*Be-Se*tn,Ce=se*Se*Be-be*tn,en=Se*Se*Be+Ge,dn=be*Se*Be+se*tn,En=se*be*Be+Se*tn,mn=Se*be*Be-se*tn,jn=be*be*Be+Ge,C[0]=jt*ze+st*Ne+St*sn,C[1]=ce*ze+D*Ne+Lt*sn,C[2]=ae*ze+H*Ne+ge*sn,C[3]=ye*ze+at*Ne+de*sn,C[4]=jt*Ce+st*en+St*dn,C[5]=ce*Ce+D*en+Lt*dn,C[6]=ae*Ce+H*en+ge*dn,C[7]=ye*Ce+at*en+de*dn,C[8]=jt*En+st*mn+St*jn,C[9]=ce*En+D*mn+Lt*jn,C[10]=ae*En+H*mn+ge*jn,C[11]=ye*En+at*mn+de*jn,z!==C&&(C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15]),C)}function Rt(C,z,Ft){var te=Math.sin(Ft),se=Math.cos(Ft),Se=z[4],be=z[5],Ze=z[6],tn=z[7],Ge=z[8],Be=z[9],jt=z[10],ce=z[11];return z!==C&&(C[0]=z[0],C[1]=z[1],C[2]=z[2],C[3]=z[3],C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15]),C[4]=Se*se+Ge*te,C[5]=be*se+Be*te,C[6]=Ze*se+jt*te,C[7]=tn*se+ce*te,C[8]=Ge*se-Se*te,C[9]=Be*se-be*te,C[10]=jt*se-Ze*te,C[11]=ce*se-tn*te,C}function Gt(C,z,Ft){var te=Math.sin(Ft),se=Math.cos(Ft),Se=z[0],be=z[1],Ze=z[2],tn=z[3],Ge=z[8],Be=z[9],jt=z[10],ce=z[11];return z!==C&&(C[4]=z[4],C[5]=z[5],C[6]=z[6],C[7]=z[7],C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15]),C[0]=Se*se-Ge*te,C[1]=be*se-Be*te,C[2]=Ze*se-jt*te,C[3]=tn*se-ce*te,C[8]=Se*te+Ge*se,C[9]=be*te+Be*se,C[10]=Ze*te+jt*se,C[11]=tn*te+ce*se,C}function ve(C,z,Ft){var te=Math.sin(Ft),se=Math.cos(Ft),Se=z[0],be=z[1],Ze=z[2],tn=z[3],Ge=z[4],Be=z[5],jt=z[6],ce=z[7];return z!==C&&(C[8]=z[8],C[9]=z[9],C[10]=z[10],C[11]=z[11],C[12]=z[12],C[13]=z[13],C[14]=z[14],C[15]=z[15]),C[0]=Se*se+Ge*te,C[1]=be*se+Be*te,C[2]=Ze*se+jt*te,C[3]=tn*se+ce*te,C[4]=Ge*se-Se*te,C[5]=Be*se-be*te,C[6]=jt*se-Ze*te,C[7]=ce*se-tn*te,C}function Me(C,z){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=z[0],C[13]=z[1],C[14]=z[2],C[15]=1,C}function Ue(C,z){return C[0]=z[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=z[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=z[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ke(C,z,Ft){var te=Ft[0],se=Ft[1],Se=Ft[2],be=Math.sqrt(te*te+se*se+Se*Se),Ze,tn,Ge;return be<Y.Ib?null:(be=1/be,te*=be,se*=be,Se*=be,Ze=Math.sin(z),tn=Math.cos(z),Ge=1-tn,C[0]=te*te*Ge+tn,C[1]=se*te*Ge+Se*Ze,C[2]=Se*te*Ge-se*Ze,C[3]=0,C[4]=te*se*Ge-Se*Ze,C[5]=se*se*Ge+tn,C[6]=Se*se*Ge+te*Ze,C[7]=0,C[8]=te*Se*Ge+se*Ze,C[9]=se*Se*Ge-te*Ze,C[10]=Se*Se*Ge+tn,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function we(C,z){var Ft=Math.sin(z),te=Math.cos(z);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=te,C[6]=Ft,C[7]=0,C[8]=0,C[9]=-Ft,C[10]=te,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ut(C,z){var Ft=Math.sin(z),te=Math.cos(z);return C[0]=te,C[1]=0,C[2]=-Ft,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=Ft,C[9]=0,C[10]=te,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function nt(C,z){var Ft=Math.sin(z),te=Math.cos(z);return C[0]=te,C[1]=Ft,C[2]=0,C[3]=0,C[4]=-Ft,C[5]=te,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ie(C,z,Ft){var te=z[0],se=z[1],Se=z[2],be=z[3],Ze=te+te,tn=se+se,Ge=Se+Se,Be=te*Ze,jt=te*tn,ce=te*Ge,ae=se*tn,ye=se*Ge,st=Se*Ge,D=be*Ze,H=be*tn,at=be*Ge;return C[0]=1-(ae+st),C[1]=jt+at,C[2]=ce-H,C[3]=0,C[4]=jt-at,C[5]=1-(Be+st),C[6]=ye+D,C[7]=0,C[8]=ce+H,C[9]=ye-D,C[10]=1-(Be+ae),C[11]=0,C[12]=Ft[0],C[13]=Ft[1],C[14]=Ft[2],C[15]=1,C}function qt(C,z){var Ft=new Y.WT(3),te=-z[0],se=-z[1],Se=-z[2],be=z[3],Ze=z[4],tn=z[5],Ge=z[6],Be=z[7],jt=te*te+se*se+Se*Se+be*be;return jt>0?(Ft[0]=(Ze*be+Be*te+tn*Se-Ge*se)*2/jt,Ft[1]=(tn*be+Be*se+Ge*te-Ze*Se)*2/jt,Ft[2]=(Ge*be+Be*Se+Ze*se-tn*te)*2/jt):(Ft[0]=(Ze*be+Be*te+tn*Se-Ge*se)*2,Ft[1]=(tn*be+Be*se+Ge*te-Ze*Se)*2,Ft[2]=(Ge*be+Be*Se+Ze*se-tn*te)*2),ie(C,z,Ft),C}function At(C,z){return C[0]=z[12],C[1]=z[13],C[2]=z[14],C}function Pe(C,z){var Ft=z[0],te=z[1],se=z[2],Se=z[4],be=z[5],Ze=z[6],tn=z[8],Ge=z[9],Be=z[10];return C[0]=Math.sqrt(Ft*Ft+te*te+se*se),C[1]=Math.sqrt(Se*Se+be*be+Ze*Ze),C[2]=Math.sqrt(tn*tn+Ge*Ge+Be*Be),C}function it(C,z){var Ft=new Y.WT(3);Pe(Ft,z);var te=1/Ft[0],se=1/Ft[1],Se=1/Ft[2],be=z[0]*te,Ze=z[1]*se,tn=z[2]*Se,Ge=z[4]*te,Be=z[5]*se,jt=z[6]*Se,ce=z[8]*te,ae=z[9]*se,ye=z[10]*Se,st=be+Be+ye,D=0;return st>0?(D=Math.sqrt(st+1)*2,C[3]=.25*D,C[0]=(jt-ae)/D,C[1]=(ce-tn)/D,C[2]=(Ze-Ge)/D):be>Be&&be>ye?(D=Math.sqrt(1+be-Be-ye)*2,C[3]=(jt-ae)/D,C[0]=.25*D,C[1]=(Ze+Ge)/D,C[2]=(ce+tn)/D):Be>ye?(D=Math.sqrt(1+Be-be-ye)*2,C[3]=(ce-tn)/D,C[0]=(Ze+Ge)/D,C[1]=.25*D,C[2]=(jt+ae)/D):(D=Math.sqrt(1+ye-be-Be)*2,C[3]=(Ze-Ge)/D,C[0]=(ce+tn)/D,C[1]=(jt+ae)/D,C[2]=.25*D),C}function Pt(C,z,Ft,te){z[0]=te[12],z[1]=te[13],z[2]=te[14];var se=te[0],Se=te[1],be=te[2],Ze=te[4],tn=te[5],Ge=te[6],Be=te[8],jt=te[9],ce=te[10];Ft[0]=Math.sqrt(se*se+Se*Se+be*be),Ft[1]=Math.sqrt(Ze*Ze+tn*tn+Ge*Ge),Ft[2]=Math.sqrt(Be*Be+jt*jt+ce*ce);var ae=1/Ft[0],ye=1/Ft[1],st=1/Ft[2],D=se*ae,H=Se*ye,at=be*st,St=Ze*ae,Lt=tn*ye,ge=Ge*st,de=Be*ae,ze=jt*ye,Ne=ce*st,sn=D+Lt+Ne,Ce=0;return sn>0?(Ce=Math.sqrt(sn+1)*2,C[3]=.25*Ce,C[0]=(ge-ze)/Ce,C[1]=(de-at)/Ce,C[2]=(H-St)/Ce):D>Lt&&D>Ne?(Ce=Math.sqrt(1+D-Lt-Ne)*2,C[3]=(ge-ze)/Ce,C[0]=.25*Ce,C[1]=(H+St)/Ce,C[2]=(de+at)/Ce):Lt>Ne?(Ce=Math.sqrt(1+Lt-D-Ne)*2,C[3]=(de-at)/Ce,C[0]=(H+St)/Ce,C[1]=.25*Ce,C[2]=(ge+ze)/Ce):(Ce=Math.sqrt(1+Ne-D-Lt)*2,C[3]=(H-St)/Ce,C[0]=(de+at)/Ce,C[1]=(ge+ze)/Ce,C[2]=.25*Ce),C}function q(C,z,Ft,te){var se=z[0],Se=z[1],be=z[2],Ze=z[3],tn=se+se,Ge=Se+Se,Be=be+be,jt=se*tn,ce=se*Ge,ae=se*Be,ye=Se*Ge,st=Se*Be,D=be*Be,H=Ze*tn,at=Ze*Ge,St=Ze*Be,Lt=te[0],ge=te[1],de=te[2];return C[0]=(1-(ye+D))*Lt,C[1]=(ce+St)*Lt,C[2]=(ae-at)*Lt,C[3]=0,C[4]=(ce-St)*ge,C[5]=(1-(jt+D))*ge,C[6]=(st+H)*ge,C[7]=0,C[8]=(ae+at)*de,C[9]=(st-H)*de,C[10]=(1-(jt+ye))*de,C[11]=0,C[12]=Ft[0],C[13]=Ft[1],C[14]=Ft[2],C[15]=1,C}function Nt(C,z,Ft,te,se){var Se=z[0],be=z[1],Ze=z[2],tn=z[3],Ge=Se+Se,Be=be+be,jt=Ze+Ze,ce=Se*Ge,ae=Se*Be,ye=Se*jt,st=be*Be,D=be*jt,H=Ze*jt,at=tn*Ge,St=tn*Be,Lt=tn*jt,ge=te[0],de=te[1],ze=te[2],Ne=se[0],sn=se[1],Ce=se[2],en=(1-(st+H))*ge,dn=(ae+Lt)*ge,En=(ye-St)*ge,mn=(ae-Lt)*de,jn=(1-(ce+H))*de,Wn=(D+at)*de,tr=(ye+St)*ze,pr=(D-at)*ze,Mr=(1-(ce+st))*ze;return C[0]=en,C[1]=dn,C[2]=En,C[3]=0,C[4]=mn,C[5]=jn,C[6]=Wn,C[7]=0,C[8]=tr,C[9]=pr,C[10]=Mr,C[11]=0,C[12]=Ft[0]+Ne-(en*Ne+mn*sn+tr*Ce),C[13]=Ft[1]+sn-(dn*Ne+jn*sn+pr*Ce),C[14]=Ft[2]+Ce-(En*Ne+Wn*sn+Mr*Ce),C[15]=1,C}function It(C,z){var Ft=z[0],te=z[1],se=z[2],Se=z[3],be=Ft+Ft,Ze=te+te,tn=se+se,Ge=Ft*be,Be=te*be,jt=te*Ze,ce=se*be,ae=se*Ze,ye=se*tn,st=Se*be,D=Se*Ze,H=Se*tn;return C[0]=1-jt-ye,C[1]=Be+H,C[2]=ce-D,C[3]=0,C[4]=Be-H,C[5]=1-Ge-ye,C[6]=ae+st,C[7]=0,C[8]=ce+D,C[9]=ae-st,C[10]=1-Ge-jt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function U(C,z,Ft,te,se,Se,be){var Ze=1/(Ft-z),tn=1/(se-te),Ge=1/(Se-be);return C[0]=Se*2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Se*2*tn,C[6]=0,C[7]=0,C[8]=(Ft+z)*Ze,C[9]=(se+te)*tn,C[10]=(be+Se)*Ge,C[11]=-1,C[12]=0,C[13]=0,C[14]=be*Se*2*Ge,C[15]=0,C}function ht(C,z,Ft,te,se){var Se=1/Math.tan(z/2);if(C[0]=Se/Ft,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Se,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,se!=null&&se!==1/0){var be=1/(te-se);C[10]=(se+te)*be,C[14]=2*se*te*be}else C[10]=-1,C[14]=-2*te;return C}var ne=ht;function xe(C,z,Ft,te,se){var Se=1/Math.tan(z/2);if(C[0]=Se/Ft,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Se,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,se!=null&&se!==1/0){var be=1/(te-se);C[10]=se*be,C[14]=se*te*be}else C[10]=-1,C[14]=-te;return C}function _e(C,z,Ft,te){var se=Math.tan(z.upDegrees*Math.PI/180),Se=Math.tan(z.downDegrees*Math.PI/180),be=Math.tan(z.leftDegrees*Math.PI/180),Ze=Math.tan(z.rightDegrees*Math.PI/180),tn=2/(be+Ze),Ge=2/(se+Se);return C[0]=tn,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Ge,C[6]=0,C[7]=0,C[8]=-((be-Ze)*tn*.5),C[9]=(se-Se)*Ge*.5,C[10]=te/(Ft-te),C[11]=-1,C[12]=0,C[13]=0,C[14]=te*Ft/(Ft-te),C[15]=0,C}function Xe(C,z,Ft,te,se,Se,be){var Ze=1/(z-Ft),tn=1/(te-se),Ge=1/(Se-be);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*tn,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*Ge,C[11]=0,C[12]=(z+Ft)*Ze,C[13]=(se+te)*tn,C[14]=(be+Se)*Ge,C[15]=1,C}var Re=Xe;function un(C,z,Ft,te,se,Se,be){var Ze=1/(z-Ft),tn=1/(te-se),Ge=1/(Se-be);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*tn,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=Ge,C[11]=0,C[12]=(z+Ft)*Ze,C[13]=(se+te)*tn,C[14]=Se*Ge,C[15]=1,C}function cn(C,z,Ft,te){var se,Se,be,Ze,tn,Ge,Be,jt,ce,ae,ye=z[0],st=z[1],D=z[2],H=te[0],at=te[1],St=te[2],Lt=Ft[0],ge=Ft[1],de=Ft[2];return Math.abs(ye-Lt)<Y.Ib&&Math.abs(st-ge)<Y.Ib&&Math.abs(D-de)<Y.Ib?bt(C):(Be=ye-Lt,jt=st-ge,ce=D-de,ae=1/Math.sqrt(Be*Be+jt*jt+ce*ce),Be*=ae,jt*=ae,ce*=ae,se=at*ce-St*jt,Se=St*Be-H*ce,be=H*jt-at*Be,ae=Math.sqrt(se*se+Se*Se+be*be),ae?(ae=1/ae,se*=ae,Se*=ae,be*=ae):(se=0,Se=0,be=0),Ze=jt*be-ce*Se,tn=ce*se-Be*be,Ge=Be*Se-jt*se,ae=Math.sqrt(Ze*Ze+tn*tn+Ge*Ge),ae?(ae=1/ae,Ze*=ae,tn*=ae,Ge*=ae):(Ze=0,tn=0,Ge=0),C[0]=se,C[1]=Ze,C[2]=Be,C[3]=0,C[4]=Se,C[5]=tn,C[6]=jt,C[7]=0,C[8]=be,C[9]=Ge,C[10]=ce,C[11]=0,C[12]=-(se*ye+Se*st+be*D),C[13]=-(Ze*ye+tn*st+Ge*D),C[14]=-(Be*ye+jt*st+ce*D),C[15]=1,C)}function Jt(C,z,Ft,te){var se=z[0],Se=z[1],be=z[2],Ze=te[0],tn=te[1],Ge=te[2],Be=se-Ft[0],jt=Se-Ft[1],ce=be-Ft[2],ae=Be*Be+jt*jt+ce*ce;ae>0&&(ae=1/Math.sqrt(ae),Be*=ae,jt*=ae,ce*=ae);var ye=tn*ce-Ge*jt,st=Ge*Be-Ze*ce,D=Ze*jt-tn*Be;return ae=ye*ye+st*st+D*D,ae>0&&(ae=1/Math.sqrt(ae),ye*=ae,st*=ae,D*=ae),C[0]=ye,C[1]=st,C[2]=D,C[3]=0,C[4]=jt*D-ce*st,C[5]=ce*ye-Be*D,C[6]=Be*st-jt*ye,C[7]=0,C[8]=Be,C[9]=jt,C[10]=ce,C[11]=0,C[12]=se,C[13]=Se,C[14]=be,C[15]=1,C}function ct(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function Ct(C){return Math.sqrt(C[0]*C[0]+C[1]*C[1]+C[2]*C[2]+C[3]*C[3]+C[4]*C[4]+C[5]*C[5]+C[6]*C[6]+C[7]*C[7]+C[8]*C[8]+C[9]*C[9]+C[10]*C[10]+C[11]*C[11]+C[12]*C[12]+C[13]*C[13]+C[14]*C[14]+C[15]*C[15])}function me(C,z,Ft){return C[0]=z[0]+Ft[0],C[1]=z[1]+Ft[1],C[2]=z[2]+Ft[2],C[3]=z[3]+Ft[3],C[4]=z[4]+Ft[4],C[5]=z[5]+Ft[5],C[6]=z[6]+Ft[6],C[7]=z[7]+Ft[7],C[8]=z[8]+Ft[8],C[9]=z[9]+Ft[9],C[10]=z[10]+Ft[10],C[11]=z[11]+Ft[11],C[12]=z[12]+Ft[12],C[13]=z[13]+Ft[13],C[14]=z[14]+Ft[14],C[15]=z[15]+Ft[15],C}function he(C,z,Ft){return C[0]=z[0]-Ft[0],C[1]=z[1]-Ft[1],C[2]=z[2]-Ft[2],C[3]=z[3]-Ft[3],C[4]=z[4]-Ft[4],C[5]=z[5]-Ft[5],C[6]=z[6]-Ft[6],C[7]=z[7]-Ft[7],C[8]=z[8]-Ft[8],C[9]=z[9]-Ft[9],C[10]=z[10]-Ft[10],C[11]=z[11]-Ft[11],C[12]=z[12]-Ft[12],C[13]=z[13]-Ft[13],C[14]=z[14]-Ft[14],C[15]=z[15]-Ft[15],C}function Tt(C,z,Ft){return C[0]=z[0]*Ft,C[1]=z[1]*Ft,C[2]=z[2]*Ft,C[3]=z[3]*Ft,C[4]=z[4]*Ft,C[5]=z[5]*Ft,C[6]=z[6]*Ft,C[7]=z[7]*Ft,C[8]=z[8]*Ft,C[9]=z[9]*Ft,C[10]=z[10]*Ft,C[11]=z[11]*Ft,C[12]=z[12]*Ft,C[13]=z[13]*Ft,C[14]=z[14]*Ft,C[15]=z[15]*Ft,C}function re(C,z,Ft,te){return C[0]=z[0]+Ft[0]*te,C[1]=z[1]+Ft[1]*te,C[2]=z[2]+Ft[2]*te,C[3]=z[3]+Ft[3]*te,C[4]=z[4]+Ft[4]*te,C[5]=z[5]+Ft[5]*te,C[6]=z[6]+Ft[6]*te,C[7]=z[7]+Ft[7]*te,C[8]=z[8]+Ft[8]*te,C[9]=z[9]+Ft[9]*te,C[10]=z[10]+Ft[10]*te,C[11]=z[11]+Ft[11]*te,C[12]=z[12]+Ft[12]*te,C[13]=z[13]+Ft[13]*te,C[14]=z[14]+Ft[14]*te,C[15]=z[15]+Ft[15]*te,C}function Yt(C,z){return C[0]===z[0]&&C[1]===z[1]&&C[2]===z[2]&&C[3]===z[3]&&C[4]===z[4]&&C[5]===z[5]&&C[6]===z[6]&&C[7]===z[7]&&C[8]===z[8]&&C[9]===z[9]&&C[10]===z[10]&&C[11]===z[11]&&C[12]===z[12]&&C[13]===z[13]&&C[14]===z[14]&&C[15]===z[15]}function N(C,z){var Ft=C[0],te=C[1],se=C[2],Se=C[3],be=C[4],Ze=C[5],tn=C[6],Ge=C[7],Be=C[8],jt=C[9],ce=C[10],ae=C[11],ye=C[12],st=C[13],D=C[14],H=C[15],at=z[0],St=z[1],Lt=z[2],ge=z[3],de=z[4],ze=z[5],Ne=z[6],sn=z[7],Ce=z[8],en=z[9],dn=z[10],En=z[11],mn=z[12],jn=z[13],Wn=z[14],tr=z[15];return Math.abs(Ft-at)<=Y.Ib*Math.max(1,Math.abs(Ft),Math.abs(at))&&Math.abs(te-St)<=Y.Ib*Math.max(1,Math.abs(te),Math.abs(St))&&Math.abs(se-Lt)<=Y.Ib*Math.max(1,Math.abs(se),Math.abs(Lt))&&Math.abs(Se-ge)<=Y.Ib*Math.max(1,Math.abs(Se),Math.abs(ge))&&Math.abs(be-de)<=Y.Ib*Math.max(1,Math.abs(be),Math.abs(de))&&Math.abs(Ze-ze)<=Y.Ib*Math.max(1,Math.abs(Ze),Math.abs(ze))&&Math.abs(tn-Ne)<=Y.Ib*Math.max(1,Math.abs(tn),Math.abs(Ne))&&Math.abs(Ge-sn)<=Y.Ib*Math.max(1,Math.abs(Ge),Math.abs(sn))&&Math.abs(Be-Ce)<=Y.Ib*Math.max(1,Math.abs(Be),Math.abs(Ce))&&Math.abs(jt-en)<=Y.Ib*Math.max(1,Math.abs(jt),Math.abs(en))&&Math.abs(ce-dn)<=Y.Ib*Math.max(1,Math.abs(ce),Math.abs(dn))&&Math.abs(ae-En)<=Y.Ib*Math.max(1,Math.abs(ae),Math.abs(En))&&Math.abs(ye-mn)<=Y.Ib*Math.max(1,Math.abs(ye),Math.abs(mn))&&Math.abs(st-jn)<=Y.Ib*Math.max(1,Math.abs(st),Math.abs(jn))&&Math.abs(D-Wn)<=Y.Ib*Math.max(1,Math.abs(D),Math.abs(Wn))&&Math.abs(H-tr)<=Y.Ib*Math.max(1,Math.abs(H),Math.abs(tr))}var kt=X,oe=he},32945:function($t,Qt,L){"use strict";L.d(Qt,{Fv:function(){return _e},JG:function(){return At},Jp:function(){return Vt},Su:function(){return Ut},U_:function(){return Ue},Ue:function(){return G},al:function(){return qt},dC:function(){return Pt},t8:function(){return Pe},yY:function(){return bt}});var Y=L(49685),Z=L(35600),tt=L(77160),yt=L(98333);function G(){var ct=new Y.WT(4);return Y.WT!=Float32Array&&(ct[0]=0,ct[1]=0,ct[2]=0),ct[3]=1,ct}function Ot(ct){return ct[0]=0,ct[1]=0,ct[2]=0,ct[3]=1,ct}function bt(ct,Ct,me){me=me*.5;var he=Math.sin(me);return ct[0]=he*Ct[0],ct[1]=he*Ct[1],ct[2]=he*Ct[2],ct[3]=Math.cos(me),ct}function Et(ct,Ct){var me=Math.acos(Ct[3])*2,he=Math.sin(me/2);return he>glMatrix.EPSILON?(ct[0]=Ct[0]/he,ct[1]=Ct[1]/he,ct[2]=Ct[2]/he):(ct[0]=1,ct[1]=0,ct[2]=0),me}function pt(ct,Ct){var me=Nt(ct,Ct);return Math.acos(2*me*me-1)}function Vt(ct,Ct,me){var he=Ct[0],Tt=Ct[1],re=Ct[2],Yt=Ct[3],N=me[0],kt=me[1],oe=me[2],C=me[3];return ct[0]=he*C+Yt*N+Tt*oe-re*kt,ct[1]=Tt*C+Yt*kt+re*N-he*oe,ct[2]=re*C+Yt*oe+he*kt-Tt*N,ct[3]=Yt*C-he*N-Tt*kt-re*oe,ct}function K(ct,Ct,me){me*=.5;var he=Ct[0],Tt=Ct[1],re=Ct[2],Yt=Ct[3],N=Math.sin(me),kt=Math.cos(me);return ct[0]=he*kt+Yt*N,ct[1]=Tt*kt+re*N,ct[2]=re*kt-Tt*N,ct[3]=Yt*kt-he*N,ct}function X(ct,Ct,me){me*=.5;var he=Ct[0],Tt=Ct[1],re=Ct[2],Yt=Ct[3],N=Math.sin(me),kt=Math.cos(me);return ct[0]=he*kt-re*N,ct[1]=Tt*kt+Yt*N,ct[2]=re*kt+he*N,ct[3]=Yt*kt-Tt*N,ct}function Zt(ct,Ct,me){me*=.5;var he=Ct[0],Tt=Ct[1],re=Ct[2],Yt=Ct[3],N=Math.sin(me),kt=Math.cos(me);return ct[0]=he*kt+Tt*N,ct[1]=Tt*kt-he*N,ct[2]=re*kt+Yt*N,ct[3]=Yt*kt-re*N,ct}function Mt(ct,Ct){var me=Ct[0],he=Ct[1],Tt=Ct[2];return ct[0]=me,ct[1]=he,ct[2]=Tt,ct[3]=Math.sqrt(Math.abs(1-me*me-he*he-Tt*Tt)),ct}function zt(ct,Ct){var me=Ct[0],he=Ct[1],Tt=Ct[2],re=Ct[3],Yt=Math.sqrt(me*me+he*he+Tt*Tt),N=Math.exp(re),kt=Yt>0?N*Math.sin(Yt)/Yt:0;return ct[0]=me*kt,ct[1]=he*kt,ct[2]=Tt*kt,ct[3]=N*Math.cos(Yt),ct}function Rt(ct,Ct){var me=Ct[0],he=Ct[1],Tt=Ct[2],re=Ct[3],Yt=Math.sqrt(me*me+he*he+Tt*Tt),N=Yt>0?Math.atan2(Yt,re)/Yt:0;return ct[0]=me*N,ct[1]=he*N,ct[2]=Tt*N,ct[3]=.5*Math.log(me*me+he*he+Tt*Tt+re*re),ct}function Gt(ct,Ct,me){return Rt(ct,Ct),q(ct,ct,me),zt(ct,ct),ct}function ve(ct,Ct,me,he){var Tt=Ct[0],re=Ct[1],Yt=Ct[2],N=Ct[3],kt=me[0],oe=me[1],C=me[2],z=me[3],Ft,te,se,Se,be;return te=Tt*kt+re*oe+Yt*C+N*z,te<0&&(te=-te,kt=-kt,oe=-oe,C=-C,z=-z),1-te>Y.Ib?(Ft=Math.acos(te),se=Math.sin(Ft),Se=Math.sin((1-he)*Ft)/se,be=Math.sin(he*Ft)/se):(Se=1-he,be=he),ct[0]=Se*Tt+be*kt,ct[1]=Se*re+be*oe,ct[2]=Se*Yt+be*C,ct[3]=Se*N+be*z,ct}function Me(ct){var Ct=glMatrix.RANDOM(),me=glMatrix.RANDOM(),he=glMatrix.RANDOM(),Tt=Math.sqrt(1-Ct),re=Math.sqrt(Ct);return ct[0]=Tt*Math.sin(2*Math.PI*me),ct[1]=Tt*Math.cos(2*Math.PI*me),ct[2]=re*Math.sin(2*Math.PI*he),ct[3]=re*Math.cos(2*Math.PI*he),ct}function Ue(ct,Ct){var me=Ct[0],he=Ct[1],Tt=Ct[2],re=Ct[3],Yt=me*me+he*he+Tt*Tt+re*re,N=Yt?1/Yt:0;return ct[0]=-me*N,ct[1]=-he*N,ct[2]=-Tt*N,ct[3]=re*N,ct}function Ke(ct,Ct){return ct[0]=-Ct[0],ct[1]=-Ct[1],ct[2]=-Ct[2],ct[3]=Ct[3],ct}function we(ct,Ct){var me=Ct[0]+Ct[4]+Ct[8],he;if(me>0)he=Math.sqrt(me+1),ct[3]=.5*he,he=.5/he,ct[0]=(Ct[5]-Ct[7])*he,ct[1]=(Ct[6]-Ct[2])*he,ct[2]=(Ct[1]-Ct[3])*he;else{var Tt=0;Ct[4]>Ct[0]&&(Tt=1),Ct[8]>Ct[Tt*3+Tt]&&(Tt=2);var re=(Tt+1)%3,Yt=(Tt+2)%3;he=Math.sqrt(Ct[Tt*3+Tt]-Ct[re*3+re]-Ct[Yt*3+Yt]+1),ct[Tt]=.5*he,he=.5/he,ct[3]=(Ct[re*3+Yt]-Ct[Yt*3+re])*he,ct[re]=(Ct[re*3+Tt]+Ct[Tt*3+re])*he,ct[Yt]=(Ct[Yt*3+Tt]+Ct[Tt*3+Yt])*he}return ct}function Ut(ct,Ct,me,he){var Tt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Y.yy,re=Math.PI/360;Ct*=re,he*=re,me*=re;var Yt=Math.sin(Ct),N=Math.cos(Ct),kt=Math.sin(me),oe=Math.cos(me),C=Math.sin(he),z=Math.cos(he);switch(Tt){case"xyz":ct[0]=Yt*oe*z+N*kt*C,ct[1]=N*kt*z-Yt*oe*C,ct[2]=N*oe*C+Yt*kt*z,ct[3]=N*oe*z-Yt*kt*C;break;case"xzy":ct[0]=Yt*oe*z-N*kt*C,ct[1]=N*kt*z-Yt*oe*C,ct[2]=N*oe*C+Yt*kt*z,ct[3]=N*oe*z+Yt*kt*C;break;case"yxz":ct[0]=Yt*oe*z+N*kt*C,ct[1]=N*kt*z-Yt*oe*C,ct[2]=N*oe*C-Yt*kt*z,ct[3]=N*oe*z+Yt*kt*C;break;case"yzx":ct[0]=Yt*oe*z+N*kt*C,ct[1]=N*kt*z+Yt*oe*C,ct[2]=N*oe*C-Yt*kt*z,ct[3]=N*oe*z-Yt*kt*C;break;case"zxy":ct[0]=Yt*oe*z-N*kt*C,ct[1]=N*kt*z+Yt*oe*C,ct[2]=N*oe*C+Yt*kt*z,ct[3]=N*oe*z-Yt*kt*C;break;case"zyx":ct[0]=Yt*oe*z-N*kt*C,ct[1]=N*kt*z+Yt*oe*C,ct[2]=N*oe*C-Yt*kt*z,ct[3]=N*oe*z+Yt*kt*C;break;default:throw new Error("Unknown angle order "+Tt)}return ct}function nt(ct){return"quat("+ct[0]+", "+ct[1]+", "+ct[2]+", "+ct[3]+")"}var ie=yt.d9,qt=yt.al,At=yt.JG,Pe=yt.t8,it=yt.IH,Pt=Vt,q=yt.bA,Nt=yt.AK,It=yt.t7,U=yt.kE,ht=null,ne=yt.we,xe=null,_e=yt.Fv,Xe=yt.I6;function Re(ct,Ct){return Math.abs(vec4.dot(ct,Ct))>=1-glMatrix.EPSILON}var un=function(){var ct=tt.Ue(),Ct=tt.al(1,0,0),me=tt.al(0,1,0);return function(he,Tt,re){var Yt=tt.AK(Tt,re);return Yt<-.999999?(tt.kC(ct,Ct,Tt),tt.Zh(ct)<1e-6&&tt.kC(ct,me,Tt),tt.Fv(ct,ct),bt(he,ct,Math.PI),he):Yt>.999999?(he[0]=0,he[1]=0,he[2]=0,he[3]=1,he):(tt.kC(ct,Tt,re),he[0]=ct[0],he[1]=ct[1],he[2]=ct[2],he[3]=1+Yt,_e(he,he))}}(),cn=function(){var ct=G(),Ct=G();return function(me,he,Tt,re,Yt,N){return ve(ct,he,Yt,N),ve(Ct,Tt,re,N),ve(me,ct,Ct,2*N*(1-N)),me}}(),Jt=function(){var ct=Z.Ue();return function(Ct,me,he,Tt){return ct[0]=he[0],ct[3]=he[1],ct[6]=he[2],ct[1]=Tt[0],ct[4]=Tt[1],ct[7]=Tt[2],ct[2]=-me[0],ct[5]=-me[1],ct[8]=-me[2],_e(Ct,we(Ct,ct))}}()},31437:function($t,Qt,L){"use strict";L.d(Qt,{$X:function(){return Et},AK:function(){return ie},Fv:function(){return nt},I6:function(){return _e},IH:function(){return bt},JG:function(){return G},Ue:function(){return Z},al:function(){return yt},lu:function(){return un},t7:function(){return At},t8:function(){return Ot},tk:function(){return we}});var Y=L(49685);function Z(){var Tt=new Y.WT(2);return Y.WT!=Float32Array&&(Tt[0]=0,Tt[1]=0),Tt}function tt(Tt){var re=new glMatrix.ARRAY_TYPE(2);return re[0]=Tt[0],re[1]=Tt[1],re}function yt(Tt,re){var Yt=new Y.WT(2);return Yt[0]=Tt,Yt[1]=re,Yt}function G(Tt,re){return Tt[0]=re[0],Tt[1]=re[1],Tt}function Ot(Tt,re,Yt){return Tt[0]=re,Tt[1]=Yt,Tt}function bt(Tt,re,Yt){return Tt[0]=re[0]+Yt[0],Tt[1]=re[1]+Yt[1],Tt}function Et(Tt,re,Yt){return Tt[0]=re[0]-Yt[0],Tt[1]=re[1]-Yt[1],Tt}function pt(Tt,re,Yt){return Tt[0]=re[0]*Yt[0],Tt[1]=re[1]*Yt[1],Tt}function Vt(Tt,re,Yt){return Tt[0]=re[0]/Yt[0],Tt[1]=re[1]/Yt[1],Tt}function K(Tt,re){return Tt[0]=Math.ceil(re[0]),Tt[1]=Math.ceil(re[1]),Tt}function X(Tt,re){return Tt[0]=Math.floor(re[0]),Tt[1]=Math.floor(re[1]),Tt}function Zt(Tt,re,Yt){return Tt[0]=Math.min(re[0],Yt[0]),Tt[1]=Math.min(re[1],Yt[1]),Tt}function Mt(Tt,re,Yt){return Tt[0]=Math.max(re[0],Yt[0]),Tt[1]=Math.max(re[1],Yt[1]),Tt}function zt(Tt,re){return Tt[0]=glMatrix.round(re[0]),Tt[1]=glMatrix.round(re[1]),Tt}function Rt(Tt,re,Yt){return Tt[0]=re[0]*Yt,Tt[1]=re[1]*Yt,Tt}function Gt(Tt,re,Yt,N){return Tt[0]=re[0]+Yt[0]*N,Tt[1]=re[1]+Yt[1]*N,Tt}function ve(Tt,re){var Yt=re[0]-Tt[0],N=re[1]-Tt[1];return Math.sqrt(Yt*Yt+N*N)}function Me(Tt,re){var Yt=re[0]-Tt[0],N=re[1]-Tt[1];return Yt*Yt+N*N}function Ue(Tt){var re=Tt[0],Yt=Tt[1];return Math.sqrt(re*re+Yt*Yt)}function Ke(Tt){var re=Tt[0],Yt=Tt[1];return re*re+Yt*Yt}function we(Tt,re){return Tt[0]=-re[0],Tt[1]=-re[1],Tt}function Ut(Tt,re){return Tt[0]=1/re[0],Tt[1]=1/re[1],Tt}function nt(Tt,re){var Yt=re[0],N=re[1],kt=Yt*Yt+N*N;return kt>0&&(kt=1/Math.sqrt(kt)),Tt[0]=re[0]*kt,Tt[1]=re[1]*kt,Tt}function ie(Tt,re){return Tt[0]*re[0]+Tt[1]*re[1]}function qt(Tt,re,Yt){var N=re[0]*Yt[1]-re[1]*Yt[0];return Tt[0]=Tt[1]=0,Tt[2]=N,Tt}function At(Tt,re,Yt,N){var kt=re[0],oe=re[1];return Tt[0]=kt+N*(Yt[0]-kt),Tt[1]=oe+N*(Yt[1]-oe),Tt}function Pe(Tt,re){re=re===void 0?1:re;var Yt=glMatrix.RANDOM()*2*Math.PI;return Tt[0]=Math.cos(Yt)*re,Tt[1]=Math.sin(Yt)*re,Tt}function it(Tt,re,Yt){var N=re[0],kt=re[1];return Tt[0]=Yt[0]*N+Yt[2]*kt,Tt[1]=Yt[1]*N+Yt[3]*kt,Tt}function Pt(Tt,re,Yt){var N=re[0],kt=re[1];return Tt[0]=Yt[0]*N+Yt[2]*kt+Yt[4],Tt[1]=Yt[1]*N+Yt[3]*kt+Yt[5],Tt}function q(Tt,re,Yt){var N=re[0],kt=re[1];return Tt[0]=Yt[0]*N+Yt[3]*kt+Yt[6],Tt[1]=Yt[1]*N+Yt[4]*kt+Yt[7],Tt}function Nt(Tt,re,Yt){var N=re[0],kt=re[1];return Tt[0]=Yt[0]*N+Yt[4]*kt+Yt[12],Tt[1]=Yt[1]*N+Yt[5]*kt+Yt[13],Tt}function It(Tt,re,Yt,N){var kt=re[0]-Yt[0],oe=re[1]-Yt[1],C=Math.sin(N),z=Math.cos(N);return Tt[0]=kt*z-oe*C+Yt[0],Tt[1]=kt*C+oe*z+Yt[1],Tt}function U(Tt,re){var Yt=Tt[0],N=Tt[1],kt=re[0],oe=re[1];return Math.abs(Math.atan2(N*kt-Yt*oe,Yt*kt+N*oe))}function ht(Tt,re){var Yt=Tt[0],N=Tt[1],kt=re[0],oe=re[1];return Math.atan2(Yt*oe-N*kt,Yt*kt+N*oe)}function ne(Tt){return Tt[0]=0,Tt[1]=0,Tt}function xe(Tt){return"vec2("+Tt[0]+", "+Tt[1]+")"}function _e(Tt,re){return Tt[0]===re[0]&&Tt[1]===re[1]}function Xe(Tt,re){var Yt=Tt[0],N=Tt[1],kt=re[0],oe=re[1];return Math.abs(Yt-kt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Yt),Math.abs(kt))&&Math.abs(N-oe)<=glMatrix.EPSILON*Math.max(1,Math.abs(N),Math.abs(oe))}var Re=null,un=Et,cn=null,Jt=null,ct=null,Ct=null,me=null,he=function(){var Tt=Z();return function(re,Yt,N,kt,oe,C){var z,Ft;for(Yt||(Yt=2),N||(N=0),kt?Ft=Math.min(kt*Yt+N,re.length):Ft=re.length,z=N;z<Ft;z+=Yt)Tt[0]=re[z],Tt[1]=re[z+1],oe(Tt,Tt,C),re[z]=Tt[0],re[z+1]=Tt[1];return re}}()},77160:function($t,Qt,L){"use strict";L.d(Qt,{$X:function(){return pt},AK:function(){return ie},EU:function(){return _e},Fp:function(){return zt},Fv:function(){return nt},IH:function(){return Et},JG:function(){return Ot},Jp:function(){return Vt},TK:function(){return me},Ue:function(){return Z},VC:function(){return U},VV:function(){return Mt},Zh:function(){return Tt},al:function(){return G},bA:function(){return Gt},d9:function(){return tt},fF:function(){return Nt},fS:function(){return cn},kC:function(){return qt},kE:function(){return yt},kK:function(){return It},lu:function(){return Jt},t7:function(){return At},t8:function(){return bt},tk:function(){return we}});var Y=L(49685);function Z(){var N=new Y.WT(3);return Y.WT!=Float32Array&&(N[0]=0,N[1]=0,N[2]=0),N}function tt(N){var kt=new Y.WT(3);return kt[0]=N[0],kt[1]=N[1],kt[2]=N[2],kt}function yt(N){var kt=N[0],oe=N[1],C=N[2];return Math.sqrt(kt*kt+oe*oe+C*C)}function G(N,kt,oe){var C=new Y.WT(3);return C[0]=N,C[1]=kt,C[2]=oe,C}function Ot(N,kt){return N[0]=kt[0],N[1]=kt[1],N[2]=kt[2],N}function bt(N,kt,oe,C){return N[0]=kt,N[1]=oe,N[2]=C,N}function Et(N,kt,oe){return N[0]=kt[0]+oe[0],N[1]=kt[1]+oe[1],N[2]=kt[2]+oe[2],N}function pt(N,kt,oe){return N[0]=kt[0]-oe[0],N[1]=kt[1]-oe[1],N[2]=kt[2]-oe[2],N}function Vt(N,kt,oe){return N[0]=kt[0]*oe[0],N[1]=kt[1]*oe[1],N[2]=kt[2]*oe[2],N}function K(N,kt,oe){return N[0]=kt[0]/oe[0],N[1]=kt[1]/oe[1],N[2]=kt[2]/oe[2],N}function X(N,kt){return N[0]=Math.ceil(kt[0]),N[1]=Math.ceil(kt[1]),N[2]=Math.ceil(kt[2]),N}function Zt(N,kt){return N[0]=Math.floor(kt[0]),N[1]=Math.floor(kt[1]),N[2]=Math.floor(kt[2]),N}function Mt(N,kt,oe){return N[0]=Math.min(kt[0],oe[0]),N[1]=Math.min(kt[1],oe[1]),N[2]=Math.min(kt[2],oe[2]),N}function zt(N,kt,oe){return N[0]=Math.max(kt[0],oe[0]),N[1]=Math.max(kt[1],oe[1]),N[2]=Math.max(kt[2],oe[2]),N}function Rt(N,kt){return N[0]=glMatrix.round(kt[0]),N[1]=glMatrix.round(kt[1]),N[2]=glMatrix.round(kt[2]),N}function Gt(N,kt,oe){return N[0]=kt[0]*oe,N[1]=kt[1]*oe,N[2]=kt[2]*oe,N}function ve(N,kt,oe,C){return N[0]=kt[0]+oe[0]*C,N[1]=kt[1]+oe[1]*C,N[2]=kt[2]+oe[2]*C,N}function Me(N,kt){var oe=kt[0]-N[0],C=kt[1]-N[1],z=kt[2]-N[2];return Math.sqrt(oe*oe+C*C+z*z)}function Ue(N,kt){var oe=kt[0]-N[0],C=kt[1]-N[1],z=kt[2]-N[2];return oe*oe+C*C+z*z}function Ke(N){var kt=N[0],oe=N[1],C=N[2];return kt*kt+oe*oe+C*C}function we(N,kt){return N[0]=-kt[0],N[1]=-kt[1],N[2]=-kt[2],N}function Ut(N,kt){return N[0]=1/kt[0],N[1]=1/kt[1],N[2]=1/kt[2],N}function nt(N,kt){var oe=kt[0],C=kt[1],z=kt[2],Ft=oe*oe+C*C+z*z;return Ft>0&&(Ft=1/Math.sqrt(Ft)),N[0]=kt[0]*Ft,N[1]=kt[1]*Ft,N[2]=kt[2]*Ft,N}function ie(N,kt){return N[0]*kt[0]+N[1]*kt[1]+N[2]*kt[2]}function qt(N,kt,oe){var C=kt[0],z=kt[1],Ft=kt[2],te=oe[0],se=oe[1],Se=oe[2];return N[0]=z*Se-Ft*se,N[1]=Ft*te-C*Se,N[2]=C*se-z*te,N}function At(N,kt,oe,C){var z=kt[0],Ft=kt[1],te=kt[2];return N[0]=z+C*(oe[0]-z),N[1]=Ft+C*(oe[1]-Ft),N[2]=te+C*(oe[2]-te),N}function Pe(N,kt,oe,C){var z=Math.acos(Math.min(Math.max(ie(kt,oe),-1),1)),Ft=Math.sin(z),te=Math.sin((1-C)*z)/Ft,se=Math.sin(C*z)/Ft;return N[0]=te*kt[0]+se*oe[0],N[1]=te*kt[1]+se*oe[1],N[2]=te*kt[2]+se*oe[2],N}function it(N,kt,oe,C,z,Ft){var te=Ft*Ft,se=te*(2*Ft-3)+1,Se=te*(Ft-2)+Ft,be=te*(Ft-1),Ze=te*(3-2*Ft);return N[0]=kt[0]*se+oe[0]*Se+C[0]*be+z[0]*Ze,N[1]=kt[1]*se+oe[1]*Se+C[1]*be+z[1]*Ze,N[2]=kt[2]*se+oe[2]*Se+C[2]*be+z[2]*Ze,N}function Pt(N,kt,oe,C,z,Ft){var te=1-Ft,se=te*te,Se=Ft*Ft,be=se*te,Ze=3*Ft*se,tn=3*Se*te,Ge=Se*Ft;return N[0]=kt[0]*be+oe[0]*Ze+C[0]*tn+z[0]*Ge,N[1]=kt[1]*be+oe[1]*Ze+C[1]*tn+z[1]*Ge,N[2]=kt[2]*be+oe[2]*Ze+C[2]*tn+z[2]*Ge,N}function q(N,kt){kt=kt===void 0?1:kt;var oe=glMatrix.RANDOM()*2*Math.PI,C=glMatrix.RANDOM()*2-1,z=Math.sqrt(1-C*C)*kt;return N[0]=Math.cos(oe)*z,N[1]=Math.sin(oe)*z,N[2]=C*kt,N}function Nt(N,kt,oe){var C=kt[0],z=kt[1],Ft=kt[2],te=oe[3]*C+oe[7]*z+oe[11]*Ft+oe[15];return te=te||1,N[0]=(oe[0]*C+oe[4]*z+oe[8]*Ft+oe[12])/te,N[1]=(oe[1]*C+oe[5]*z+oe[9]*Ft+oe[13])/te,N[2]=(oe[2]*C+oe[6]*z+oe[10]*Ft+oe[14])/te,N}function It(N,kt,oe){var C=kt[0],z=kt[1],Ft=kt[2];return N[0]=C*oe[0]+z*oe[3]+Ft*oe[6],N[1]=C*oe[1]+z*oe[4]+Ft*oe[7],N[2]=C*oe[2]+z*oe[5]+Ft*oe[8],N}function U(N,kt,oe){var C=oe[0],z=oe[1],Ft=oe[2],te=oe[3],se=kt[0],Se=kt[1],be=kt[2],Ze=z*be-Ft*Se,tn=Ft*se-C*be,Ge=C*Se-z*se;return Ze=Ze+Ze,tn=tn+tn,Ge=Ge+Ge,N[0]=se+te*Ze+z*Ge-Ft*tn,N[1]=Se+te*tn+Ft*Ze-C*Ge,N[2]=be+te*Ge+C*tn-z*Ze,N}function ht(N,kt,oe,C){var z=[],Ft=[];return z[0]=kt[0]-oe[0],z[1]=kt[1]-oe[1],z[2]=kt[2]-oe[2],Ft[0]=z[0],Ft[1]=z[1]*Math.cos(C)-z[2]*Math.sin(C),Ft[2]=z[1]*Math.sin(C)+z[2]*Math.cos(C),N[0]=Ft[0]+oe[0],N[1]=Ft[1]+oe[1],N[2]=Ft[2]+oe[2],N}function ne(N,kt,oe,C){var z=[],Ft=[];return z[0]=kt[0]-oe[0],z[1]=kt[1]-oe[1],z[2]=kt[2]-oe[2],Ft[0]=z[2]*Math.sin(C)+z[0]*Math.cos(C),Ft[1]=z[1],Ft[2]=z[2]*Math.cos(C)-z[0]*Math.sin(C),N[0]=Ft[0]+oe[0],N[1]=Ft[1]+oe[1],N[2]=Ft[2]+oe[2],N}function xe(N,kt,oe,C){var z=[],Ft=[];return z[0]=kt[0]-oe[0],z[1]=kt[1]-oe[1],z[2]=kt[2]-oe[2],Ft[0]=z[0]*Math.cos(C)-z[1]*Math.sin(C),Ft[1]=z[0]*Math.sin(C)+z[1]*Math.cos(C),Ft[2]=z[2],N[0]=Ft[0]+oe[0],N[1]=Ft[1]+oe[1],N[2]=Ft[2]+oe[2],N}function _e(N,kt){var oe=N[0],C=N[1],z=N[2],Ft=kt[0],te=kt[1],se=kt[2],Se=Math.sqrt((oe*oe+C*C+z*z)*(Ft*Ft+te*te+se*se)),be=Se&&ie(N,kt)/Se;return Math.acos(Math.min(Math.max(be,-1),1))}function Xe(N){return N[0]=0,N[1]=0,N[2]=0,N}function Re(N){return"vec3("+N[0]+", "+N[1]+", "+N[2]+")"}function un(N,kt){return N[0]===kt[0]&&N[1]===kt[1]&&N[2]===kt[2]}function cn(N,kt){var oe=N[0],C=N[1],z=N[2],Ft=kt[0],te=kt[1],se=kt[2];return Math.abs(oe-Ft)<=Y.Ib*Math.max(1,Math.abs(oe),Math.abs(Ft))&&Math.abs(C-te)<=Y.Ib*Math.max(1,Math.abs(C),Math.abs(te))&&Math.abs(z-se)<=Y.Ib*Math.max(1,Math.abs(z),Math.abs(se))}var Jt=pt,ct=null,Ct=null,me=Me,he=null,Tt=yt,re=null,Yt=function(){var N=Z();return function(kt,oe,C,z,Ft,te){var se,Se;for(oe||(oe=3),C||(C=0),z?Se=Math.min(z*oe+C,kt.length):Se=kt.length,se=C;se<Se;se+=oe)N[0]=kt[se],N[1]=kt[se+1],N[2]=kt[se+2],Ft(N,N,te),kt[se]=N[0],kt[se+1]=N[1],kt[se+2]=N[2];return kt}}()},98333:function($t,Qt,L){"use strict";L.d(Qt,{AK:function(){return ie},Fv:function(){return nt},I6:function(){return It},IH:function(){return bt},JG:function(){return G},Ue:function(){return Z},al:function(){return yt},bA:function(){return Rt},d9:function(){return tt},fF:function(){return it},kE:function(){return Ue},t7:function(){return At},t8:function(){return Ot},we:function(){return Ke}});var Y=L(49685);function Z(){var Jt=new Y.WT(4);return Y.WT!=Float32Array&&(Jt[0]=0,Jt[1]=0,Jt[2]=0,Jt[3]=0),Jt}function tt(Jt){var ct=new Y.WT(4);return ct[0]=Jt[0],ct[1]=Jt[1],ct[2]=Jt[2],ct[3]=Jt[3],ct}function yt(Jt,ct,Ct,me){var he=new Y.WT(4);return he[0]=Jt,he[1]=ct,he[2]=Ct,he[3]=me,he}function G(Jt,ct){return Jt[0]=ct[0],Jt[1]=ct[1],Jt[2]=ct[2],Jt[3]=ct[3],Jt}function Ot(Jt,ct,Ct,me,he){return Jt[0]=ct,Jt[1]=Ct,Jt[2]=me,Jt[3]=he,Jt}function bt(Jt,ct,Ct){return Jt[0]=ct[0]+Ct[0],Jt[1]=ct[1]+Ct[1],Jt[2]=ct[2]+Ct[2],Jt[3]=ct[3]+Ct[3],Jt}function Et(Jt,ct,Ct){return Jt[0]=ct[0]-Ct[0],Jt[1]=ct[1]-Ct[1],Jt[2]=ct[2]-Ct[2],Jt[3]=ct[3]-Ct[3],Jt}function pt(Jt,ct,Ct){return Jt[0]=ct[0]*Ct[0],Jt[1]=ct[1]*Ct[1],Jt[2]=ct[2]*Ct[2],Jt[3]=ct[3]*Ct[3],Jt}function Vt(Jt,ct,Ct){return Jt[0]=ct[0]/Ct[0],Jt[1]=ct[1]/Ct[1],Jt[2]=ct[2]/Ct[2],Jt[3]=ct[3]/Ct[3],Jt}function K(Jt,ct){return Jt[0]=Math.ceil(ct[0]),Jt[1]=Math.ceil(ct[1]),Jt[2]=Math.ceil(ct[2]),Jt[3]=Math.ceil(ct[3]),Jt}function X(Jt,ct){return Jt[0]=Math.floor(ct[0]),Jt[1]=Math.floor(ct[1]),Jt[2]=Math.floor(ct[2]),Jt[3]=Math.floor(ct[3]),Jt}function Zt(Jt,ct,Ct){return Jt[0]=Math.min(ct[0],Ct[0]),Jt[1]=Math.min(ct[1],Ct[1]),Jt[2]=Math.min(ct[2],Ct[2]),Jt[3]=Math.min(ct[3],Ct[3]),Jt}function Mt(Jt,ct,Ct){return Jt[0]=Math.max(ct[0],Ct[0]),Jt[1]=Math.max(ct[1],Ct[1]),Jt[2]=Math.max(ct[2],Ct[2]),Jt[3]=Math.max(ct[3],Ct[3]),Jt}function zt(Jt,ct){return Jt[0]=glMatrix.round(ct[0]),Jt[1]=glMatrix.round(ct[1]),Jt[2]=glMatrix.round(ct[2]),Jt[3]=glMatrix.round(ct[3]),Jt}function Rt(Jt,ct,Ct){return Jt[0]=ct[0]*Ct,Jt[1]=ct[1]*Ct,Jt[2]=ct[2]*Ct,Jt[3]=ct[3]*Ct,Jt}function Gt(Jt,ct,Ct,me){return Jt[0]=ct[0]+Ct[0]*me,Jt[1]=ct[1]+Ct[1]*me,Jt[2]=ct[2]+Ct[2]*me,Jt[3]=ct[3]+Ct[3]*me,Jt}function ve(Jt,ct){var Ct=ct[0]-Jt[0],me=ct[1]-Jt[1],he=ct[2]-Jt[2],Tt=ct[3]-Jt[3];return Math.sqrt(Ct*Ct+me*me+he*he+Tt*Tt)}function Me(Jt,ct){var Ct=ct[0]-Jt[0],me=ct[1]-Jt[1],he=ct[2]-Jt[2],Tt=ct[3]-Jt[3];return Ct*Ct+me*me+he*he+Tt*Tt}function Ue(Jt){var ct=Jt[0],Ct=Jt[1],me=Jt[2],he=Jt[3];return Math.sqrt(ct*ct+Ct*Ct+me*me+he*he)}function Ke(Jt){var ct=Jt[0],Ct=Jt[1],me=Jt[2],he=Jt[3];return ct*ct+Ct*Ct+me*me+he*he}function we(Jt,ct){return Jt[0]=-ct[0],Jt[1]=-ct[1],Jt[2]=-ct[2],Jt[3]=-ct[3],Jt}function Ut(Jt,ct){return Jt[0]=1/ct[0],Jt[1]=1/ct[1],Jt[2]=1/ct[2],Jt[3]=1/ct[3],Jt}function nt(Jt,ct){var Ct=ct[0],me=ct[1],he=ct[2],Tt=ct[3],re=Ct*Ct+me*me+he*he+Tt*Tt;return re>0&&(re=1/Math.sqrt(re)),Jt[0]=Ct*re,Jt[1]=me*re,Jt[2]=he*re,Jt[3]=Tt*re,Jt}function ie(Jt,ct){return Jt[0]*ct[0]+Jt[1]*ct[1]+Jt[2]*ct[2]+Jt[3]*ct[3]}function qt(Jt,ct,Ct,me){var he=Ct[0]*me[1]-Ct[1]*me[0],Tt=Ct[0]*me[2]-Ct[2]*me[0],re=Ct[0]*me[3]-Ct[3]*me[0],Yt=Ct[1]*me[2]-Ct[2]*me[1],N=Ct[1]*me[3]-Ct[3]*me[1],kt=Ct[2]*me[3]-Ct[3]*me[2],oe=ct[0],C=ct[1],z=ct[2],Ft=ct[3];return Jt[0]=C*kt-z*N+Ft*Yt,Jt[1]=-(oe*kt)+z*re-Ft*Tt,Jt[2]=oe*N-C*re+Ft*he,Jt[3]=-(oe*Yt)+C*Tt-z*he,Jt}function At(Jt,ct,Ct,me){var he=ct[0],Tt=ct[1],re=ct[2],Yt=ct[3];return Jt[0]=he+me*(Ct[0]-he),Jt[1]=Tt+me*(Ct[1]-Tt),Jt[2]=re+me*(Ct[2]-re),Jt[3]=Yt+me*(Ct[3]-Yt),Jt}function Pe(Jt,ct){ct=ct===void 0?1:ct;var Ct,me,he,Tt,re,Yt,N;N=glMatrix.RANDOM(),Ct=N*2-1,me=(4*glMatrix.RANDOM()-2)*Math.sqrt(N*-N+N),re=Ct*Ct+me*me,N=glMatrix.RANDOM(),he=N*2-1,Tt=(4*glMatrix.RANDOM()-2)*Math.sqrt(N*-N+N),Yt=he*he+Tt*Tt;var kt=Math.sqrt((1-re)/Yt);return Jt[0]=ct*Ct,Jt[1]=ct*me,Jt[2]=ct*he*kt,Jt[3]=ct*Tt*kt,Jt}function it(Jt,ct,Ct){var me=ct[0],he=ct[1],Tt=ct[2],re=ct[3];return Jt[0]=Ct[0]*me+Ct[4]*he+Ct[8]*Tt+Ct[12]*re,Jt[1]=Ct[1]*me+Ct[5]*he+Ct[9]*Tt+Ct[13]*re,Jt[2]=Ct[2]*me+Ct[6]*he+Ct[10]*Tt+Ct[14]*re,Jt[3]=Ct[3]*me+Ct[7]*he+Ct[11]*Tt+Ct[15]*re,Jt}function Pt(Jt,ct,Ct){var me=Ct[0],he=Ct[1],Tt=Ct[2],re=Ct[3],Yt=ct[0],N=ct[1],kt=ct[2],oe=he*kt-Tt*N,C=Tt*Yt-me*kt,z=me*N-he*Yt;return oe=oe+oe,C=C+C,z=z+z,Jt[0]=Yt+re*oe+he*z-Tt*C,Jt[1]=N+re*C+Tt*oe-me*z,Jt[2]=kt+re*z+me*C-he*oe,Jt[3]=ct[3],Jt}function q(Jt){return Jt[0]=0,Jt[1]=0,Jt[2]=0,Jt[3]=0,Jt}function Nt(Jt){return"vec4("+Jt[0]+", "+Jt[1]+", "+Jt[2]+", "+Jt[3]+")"}function It(Jt,ct){return Jt[0]===ct[0]&&Jt[1]===ct[1]&&Jt[2]===ct[2]&&Jt[3]===ct[3]}function U(Jt,ct){var Ct=Jt[0],me=Jt[1],he=Jt[2],Tt=Jt[3],re=ct[0],Yt=ct[1],N=ct[2],kt=ct[3];return Math.abs(Ct-re)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(re))&&Math.abs(me-Yt)<=glMatrix.EPSILON*Math.max(1,Math.abs(me),Math.abs(Yt))&&Math.abs(he-N)<=glMatrix.EPSILON*Math.max(1,Math.abs(he),Math.abs(N))&&Math.abs(Tt-kt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Tt),Math.abs(kt))}var ht=null,ne=null,xe=null,_e=null,Xe=null,Re=null,un=null,cn=function(){var Jt=Z();return function(ct,Ct,me,he,Tt,re){var Yt,N;for(Ct||(Ct=4),me||(me=0),he?N=Math.min(he*Ct+me,ct.length):N=ct.length,Yt=me;Yt<N;Yt+=Ct)Jt[0]=ct[Yt],Jt[1]=ct[Yt+1],Jt[2]=ct[Yt+2],Jt[3]=ct[Yt+3],Tt(Jt,Jt,re),ct[Yt]=Jt[0],ct[Yt+1]=Jt[1],ct[Yt+2]=Jt[2],ct[Yt+3]=Jt[3];return ct}}()},50840:function($t,Qt,L){var Y;(function(Z,tt,yt,G){"use strict";var Ot=["","webkit","Moz","MS","ms","o"],bt=tt.createElement("div"),Et="function",pt=Math.round,Vt=Math.abs,K=Date.now;function X(Dt,Xt,Ae){return setTimeout(Ue(Dt,Ae),Xt)}function Zt(Dt,Xt,Ae){return Array.isArray(Dt)?(Mt(Dt,Ae[Xt],Ae),!0):!1}function Mt(Dt,Xt,Ae){var Qe;if(Dt)if(Dt.forEach)Dt.forEach(Xt,Ae);else if(Dt.length!==G)for(Qe=0;Qe<Dt.length;)Xt.call(Ae,Dt[Qe],Qe,Dt),Qe++;else for(Qe in Dt)Dt.hasOwnProperty(Qe)&&Xt.call(Ae,Dt[Qe],Qe,Dt)}function zt(Dt,Xt,Ae){var Qe="DEPRECATED METHOD: "+Xt+`
`+Ae+` AT 
`;return function(){var gn=new Error("get-stack-trace"),In=gn&&gn.stack?gn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Xn=Z.console&&(Z.console.warn||Z.console.log);return Xn&&Xn.call(Z.console,Qe,In),Dt.apply(this,arguments)}}var Rt;typeof Object.assign!="function"?Rt=function(Xt){if(Xt===G||Xt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ae=Object(Xt),Qe=1;Qe<arguments.length;Qe++){var gn=arguments[Qe];if(gn!==G&&gn!==null)for(var In in gn)gn.hasOwnProperty(In)&&(Ae[In]=gn[In])}return Ae}:Rt=Object.assign;var Gt=zt(function(Xt,Ae,Qe){for(var gn=Object.keys(Ae),In=0;In<gn.length;)(!Qe||Qe&&Xt[gn[In]]===G)&&(Xt[gn[In]]=Ae[gn[In]]),In++;return Xt},"extend","Use `assign`."),ve=zt(function(Xt,Ae){return Gt(Xt,Ae,!0)},"merge","Use `assign`.");function Me(Dt,Xt,Ae){var Qe=Xt.prototype,gn;gn=Dt.prototype=Object.create(Qe),gn.constructor=Dt,gn._super=Qe,Ae&&Rt(gn,Ae)}function Ue(Dt,Xt){return function(){return Dt.apply(Xt,arguments)}}function Ke(Dt,Xt){return typeof Dt==Et?Dt.apply(Xt&&Xt[0]||G,Xt):Dt}function we(Dt,Xt){return Dt===G?Xt:Dt}function Ut(Dt,Xt,Ae){Mt(At(Xt),function(Qe){Dt.addEventListener(Qe,Ae,!1)})}function nt(Dt,Xt,Ae){Mt(At(Xt),function(Qe){Dt.removeEventListener(Qe,Ae,!1)})}function ie(Dt,Xt){for(;Dt;){if(Dt==Xt)return!0;Dt=Dt.parentNode}return!1}function qt(Dt,Xt){return Dt.indexOf(Xt)>-1}function At(Dt){return Dt.trim().split(/\s+/g)}function Pe(Dt,Xt,Ae){if(Dt.indexOf&&!Ae)return Dt.indexOf(Xt);for(var Qe=0;Qe<Dt.length;){if(Ae&&Dt[Qe][Ae]==Xt||!Ae&&Dt[Qe]===Xt)return Qe;Qe++}return-1}function it(Dt){return Array.prototype.slice.call(Dt,0)}function Pt(Dt,Xt,Ae){for(var Qe=[],gn=[],In=0;In<Dt.length;){var Xn=Xt?Dt[In][Xt]:Dt[In];Pe(gn,Xn)<0&&Qe.push(Dt[In]),gn[In]=Xn,In++}return Ae&&(Xt?Qe=Qe.sort(function(di,Pr){return di[Xt]>Pr[Xt]}):Qe=Qe.sort()),Qe}function q(Dt,Xt){for(var Ae,Qe,gn=Xt[0].toUpperCase()+Xt.slice(1),In=0;In<Ot.length;){if(Ae=Ot[In],Qe=Ae?Ae+gn:Xt,Qe in Dt)return Qe;In++}return G}var Nt=1;function It(){return Nt++}function U(Dt){var Xt=Dt.ownerDocument||Dt;return Xt.defaultView||Xt.parentWindow||Z}var ht=/mobile|tablet|ip(ad|hone|od)|android/i,ne="ontouchstart"in Z,xe=q(Z,"PointerEvent")!==G,_e=ne&&ht.test(navigator.userAgent),Xe="touch",Re="pen",un="mouse",cn="kinect",Jt=25,ct=1,Ct=2,me=4,he=8,Tt=1,re=2,Yt=4,N=8,kt=16,oe=re|Yt,C=N|kt,z=oe|C,Ft=["x","y"],te=["clientX","clientY"];function se(Dt,Xt){var Ae=this;this.manager=Dt,this.callback=Xt,this.element=Dt.element,this.target=Dt.options.inputTarget,this.domHandler=function(Qe){Ke(Dt.options.enable,[Dt])&&Ae.handler(Qe)},this.init()}se.prototype={handler:function(){},init:function(){this.evEl&&Ut(this.element,this.evEl,this.domHandler),this.evTarget&&Ut(this.target,this.evTarget,this.domHandler),this.evWin&&Ut(U(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&nt(this.element,this.evEl,this.domHandler),this.evTarget&&nt(this.target,this.evTarget,this.domHandler),this.evWin&&nt(U(this.element),this.evWin,this.domHandler)}};function Se(Dt){var Xt,Ae=Dt.options.inputClass;return Ae?Xt=Ae:xe?Xt=Ce:_e?Xt=pr:ne?Xt=Lr:Xt=ge,new Xt(Dt,be)}function be(Dt,Xt,Ae){var Qe=Ae.pointers.length,gn=Ae.changedPointers.length,In=Xt&ct&&Qe-gn===0,Xn=Xt&(me|he)&&Qe-gn===0;Ae.isFirst=!!In,Ae.isFinal=!!Xn,In&&(Dt.session={}),Ae.eventType=Xt,Ze(Dt,Ae),Dt.emit("hammer.input",Ae),Dt.recognize(Ae),Dt.session.prevInput=Ae}function Ze(Dt,Xt){var Ae=Dt.session,Qe=Xt.pointers,gn=Qe.length;Ae.firstInput||(Ae.firstInput=Be(Xt)),gn>1&&!Ae.firstMultiple?Ae.firstMultiple=Be(Xt):gn===1&&(Ae.firstMultiple=!1);var In=Ae.firstInput,Xn=Ae.firstMultiple,ri=Xn?Xn.center:In.center,di=Xt.center=jt(Qe);Xt.timeStamp=K(),Xt.deltaTime=Xt.timeStamp-In.timeStamp,Xt.angle=st(ri,di),Xt.distance=ye(ri,di),tn(Ae,Xt),Xt.offsetDirection=ae(Xt.deltaX,Xt.deltaY);var Pr=ce(Xt.deltaTime,Xt.deltaX,Xt.deltaY);Xt.overallVelocityX=Pr.x,Xt.overallVelocityY=Pr.y,Xt.overallVelocity=Vt(Pr.x)>Vt(Pr.y)?Pr.x:Pr.y,Xt.scale=Xn?H(Xn.pointers,Qe):1,Xt.rotation=Xn?D(Xn.pointers,Qe):0,Xt.maxPointers=Ae.prevInput?Xt.pointers.length>Ae.prevInput.maxPointers?Xt.pointers.length:Ae.prevInput.maxPointers:Xt.pointers.length,Ge(Ae,Xt);var wi=Dt.element;ie(Xt.srcEvent.target,wi)&&(wi=Xt.srcEvent.target),Xt.target=wi}function tn(Dt,Xt){var Ae=Xt.center,Qe=Dt.offsetDelta||{},gn=Dt.prevDelta||{},In=Dt.prevInput||{};(Xt.eventType===ct||In.eventType===me)&&(gn=Dt.prevDelta={x:In.deltaX||0,y:In.deltaY||0},Qe=Dt.offsetDelta={x:Ae.x,y:Ae.y}),Xt.deltaX=gn.x+(Ae.x-Qe.x),Xt.deltaY=gn.y+(Ae.y-Qe.y)}function Ge(Dt,Xt){var Ae=Dt.lastInterval||Xt,Qe=Xt.timeStamp-Ae.timeStamp,gn,In,Xn,ri;if(Xt.eventType!=he&&(Qe>Jt||Ae.velocity===G)){var di=Xt.deltaX-Ae.deltaX,Pr=Xt.deltaY-Ae.deltaY,wi=ce(Qe,di,Pr);In=wi.x,Xn=wi.y,gn=Vt(wi.x)>Vt(wi.y)?wi.x:wi.y,ri=ae(di,Pr),Dt.lastInterval=Xt}else gn=Ae.velocity,In=Ae.velocityX,Xn=Ae.velocityY,ri=Ae.direction;Xt.velocity=gn,Xt.velocityX=In,Xt.velocityY=Xn,Xt.direction=ri}function Be(Dt){for(var Xt=[],Ae=0;Ae<Dt.pointers.length;)Xt[Ae]={clientX:pt(Dt.pointers[Ae].clientX),clientY:pt(Dt.pointers[Ae].clientY)},Ae++;return{timeStamp:K(),pointers:Xt,center:jt(Xt),deltaX:Dt.deltaX,deltaY:Dt.deltaY}}function jt(Dt){var Xt=Dt.length;if(Xt===1)return{x:pt(Dt[0].clientX),y:pt(Dt[0].clientY)};for(var Ae=0,Qe=0,gn=0;gn<Xt;)Ae+=Dt[gn].clientX,Qe+=Dt[gn].clientY,gn++;return{x:pt(Ae/Xt),y:pt(Qe/Xt)}}function ce(Dt,Xt,Ae){return{x:Xt/Dt||0,y:Ae/Dt||0}}function ae(Dt,Xt){return Dt===Xt?Tt:Vt(Dt)>=Vt(Xt)?Dt<0?re:Yt:Xt<0?N:kt}function ye(Dt,Xt,Ae){Ae||(Ae=Ft);var Qe=Xt[Ae[0]]-Dt[Ae[0]],gn=Xt[Ae[1]]-Dt[Ae[1]];return Math.sqrt(Qe*Qe+gn*gn)}function st(Dt,Xt,Ae){Ae||(Ae=Ft);var Qe=Xt[Ae[0]]-Dt[Ae[0]],gn=Xt[Ae[1]]-Dt[Ae[1]];return Math.atan2(gn,Qe)*180/Math.PI}function D(Dt,Xt){return st(Xt[1],Xt[0],te)+st(Dt[1],Dt[0],te)}function H(Dt,Xt){return ye(Xt[0],Xt[1],te)/ye(Dt[0],Dt[1],te)}var at={mousedown:ct,mousemove:Ct,mouseup:me},St="mousedown",Lt="mousemove mouseup";function ge(){this.evEl=St,this.evWin=Lt,this.pressed=!1,se.apply(this,arguments)}Me(ge,se,{handler:function(Xt){var Ae=at[Xt.type];Ae&ct&&Xt.button===0&&(this.pressed=!0),Ae&Ct&&Xt.which!==1&&(Ae=me),this.pressed&&(Ae&me&&(this.pressed=!1),this.callback(this.manager,Ae,{pointers:[Xt],changedPointers:[Xt],pointerType:un,srcEvent:Xt}))}});var de={pointerdown:ct,pointermove:Ct,pointerup:me,pointercancel:he,pointerout:he},ze={2:Xe,3:Re,4:un,5:cn},Ne="pointerdown",sn="pointermove pointerup pointercancel";Z.MSPointerEvent&&!Z.PointerEvent&&(Ne="MSPointerDown",sn="MSPointerMove MSPointerUp MSPointerCancel");function Ce(){this.evEl=Ne,this.evWin=sn,se.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Me(Ce,se,{handler:function(Xt){var Ae=this.store,Qe=!1,gn=Xt.type.toLowerCase().replace("ms",""),In=de[gn],Xn=ze[Xt.pointerType]||Xt.pointerType,ri=Xn==Xe,di=Pe(Ae,Xt.pointerId,"pointerId");In&ct&&(Xt.button===0||ri)?di<0&&(Ae.push(Xt),di=Ae.length-1):In&(me|he)&&(Qe=!0),!(di<0)&&(Ae[di]=Xt,this.callback(this.manager,In,{pointers:Ae,changedPointers:[Xt],pointerType:Xn,srcEvent:Xt}),Qe&&Ae.splice(di,1))}});var en={touchstart:ct,touchmove:Ct,touchend:me,touchcancel:he},dn="touchstart",En="touchstart touchmove touchend touchcancel";function mn(){this.evTarget=dn,this.evWin=En,this.started=!1,se.apply(this,arguments)}Me(mn,se,{handler:function(Xt){var Ae=en[Xt.type];if(Ae===ct&&(this.started=!0),!!this.started){var Qe=jn.call(this,Xt,Ae);Ae&(me|he)&&Qe[0].length-Qe[1].length===0&&(this.started=!1),this.callback(this.manager,Ae,{pointers:Qe[0],changedPointers:Qe[1],pointerType:Xe,srcEvent:Xt})}}});function jn(Dt,Xt){var Ae=it(Dt.touches),Qe=it(Dt.changedTouches);return Xt&(me|he)&&(Ae=Pt(Ae.concat(Qe),"identifier",!0)),[Ae,Qe]}var Wn={touchstart:ct,touchmove:Ct,touchend:me,touchcancel:he},tr="touchstart touchmove touchend touchcancel";function pr(){this.evTarget=tr,this.targetIds={},se.apply(this,arguments)}Me(pr,se,{handler:function(Xt){var Ae=Wn[Xt.type],Qe=Mr.call(this,Xt,Ae);Qe&&this.callback(this.manager,Ae,{pointers:Qe[0],changedPointers:Qe[1],pointerType:Xe,srcEvent:Xt})}});function Mr(Dt,Xt){var Ae=it(Dt.touches),Qe=this.targetIds;if(Xt&(ct|Ct)&&Ae.length===1)return Qe[Ae[0].identifier]=!0,[Ae,Ae];var gn,In,Xn=it(Dt.changedTouches),ri=[],di=this.target;if(In=Ae.filter(function(Pr){return ie(Pr.target,di)}),Xt===ct)for(gn=0;gn<In.length;)Qe[In[gn].identifier]=!0,gn++;for(gn=0;gn<Xn.length;)Qe[Xn[gn].identifier]&&ri.push(Xn[gn]),Xt&(me|he)&&delete Qe[Xn[gn].identifier],gn++;if(ri.length)return[Pt(In.concat(ri),"identifier",!0),ri]}var Qr=2500,Nr=25;function Lr(){se.apply(this,arguments);var Dt=Ue(this.handler,this);this.touch=new pr(this.manager,Dt),this.mouse=new ge(this.manager,Dt),this.primaryTouch=null,this.lastTouches=[]}Me(Lr,se,{handler:function(Xt,Ae,Qe){var gn=Qe.pointerType==Xe,In=Qe.pointerType==un;if(!(In&&Qe.sourceCapabilities&&Qe.sourceCapabilities.firesTouchEvents)){if(gn)Fr.call(this,Ae,Qe);else if(In&&Li.call(this,Qe))return;this.callback(Xt,Ae,Qe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Fr(Dt,Xt){Dt&ct?(this.primaryTouch=Xt.changedPointers[0].identifier,vi.call(this,Xt)):Dt&(me|he)&&vi.call(this,Xt)}function vi(Dt){var Xt=Dt.changedPointers[0];if(Xt.identifier===this.primaryTouch){var Ae={x:Xt.clientX,y:Xt.clientY};this.lastTouches.push(Ae);var Qe=this.lastTouches,gn=function(){var In=Qe.indexOf(Ae);In>-1&&Qe.splice(In,1)};setTimeout(gn,Qr)}}function Li(Dt){for(var Xt=Dt.srcEvent.clientX,Ae=Dt.srcEvent.clientY,Qe=0;Qe<this.lastTouches.length;Qe++){var gn=this.lastTouches[Qe],In=Math.abs(Xt-gn.x),Xn=Math.abs(Ae-gn.y);if(In<=Nr&&Xn<=Nr)return!0}return!1}var Ii=q(bt.style,"touchAction"),mi=Ii!==G,Hi="compute",io="auto",Ko="manipulation",So="none",fa="pan-x",li="pan-y",Cr=ee();function ft(Dt,Xt){this.manager=Dt,this.set(Xt)}ft.prototype={set:function(Dt){Dt==Hi&&(Dt=this.compute()),mi&&this.manager.element.style&&Cr[Dt]&&(this.manager.element.style[Ii]=Dt),this.actions=Dt.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Dt=[];return Mt(this.manager.recognizers,function(Xt){Ke(Xt.options.enable,[Xt])&&(Dt=Dt.concat(Xt.getTouchAction()))}),_t(Dt.join(" "))},preventDefaults:function(Dt){var Xt=Dt.srcEvent,Ae=Dt.offsetDirection;if(this.manager.session.prevented){Xt.preventDefault();return}var Qe=this.actions,gn=qt(Qe,So)&&!Cr[So],In=qt(Qe,li)&&!Cr[li],Xn=qt(Qe,fa)&&!Cr[fa];if(gn){var ri=Dt.pointers.length===1,di=Dt.distance<2,Pr=Dt.deltaTime<250;if(ri&&di&&Pr)return}if(!(Xn&&In)&&(gn||In&&Ae&oe||Xn&&Ae&C))return this.preventSrc(Xt)},preventSrc:function(Dt){this.manager.session.prevented=!0,Dt.preventDefault()}};function _t(Dt){if(qt(Dt,So))return So;var Xt=qt(Dt,fa),Ae=qt(Dt,li);return Xt&&Ae?So:Xt||Ae?Xt?fa:li:qt(Dt,Ko)?Ko:io}function ee(){if(!mi)return!1;var Dt={},Xt=Z.CSS&&Z.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ae){Dt[Ae]=Xt?Z.CSS.supports("touch-action",Ae):!0}),Dt}var pe=1,Ie=2,je=4,Oe=8,Ee=Oe,Ve=16,$e=32;function pn(Dt){this.options=Rt({},this.defaults,Dt||{}),this.id=It(),this.manager=null,this.options.enable=we(this.options.enable,!0),this.state=pe,this.simultaneous={},this.requireFail=[]}pn.prototype={defaults:{},set:function(Dt){return Rt(this.options,Dt),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Dt){if(Zt(Dt,"recognizeWith",this))return this;var Xt=this.simultaneous;return Dt=vn(Dt,this),Xt[Dt.id]||(Xt[Dt.id]=Dt,Dt.recognizeWith(this)),this},dropRecognizeWith:function(Dt){return Zt(Dt,"dropRecognizeWith",this)?this:(Dt=vn(Dt,this),delete this.simultaneous[Dt.id],this)},requireFailure:function(Dt){if(Zt(Dt,"requireFailure",this))return this;var Xt=this.requireFail;return Dt=vn(Dt,this),Pe(Xt,Dt)===-1&&(Xt.push(Dt),Dt.requireFailure(this)),this},dropRequireFailure:function(Dt){if(Zt(Dt,"dropRequireFailure",this))return this;Dt=vn(Dt,this);var Xt=Pe(this.requireFail,Dt);return Xt>-1&&this.requireFail.splice(Xt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Dt){return!!this.simultaneous[Dt.id]},emit:function(Dt){var Xt=this,Ae=this.state;function Qe(gn){Xt.manager.emit(gn,Dt)}Ae<Oe&&Qe(Xt.options.event+Sn(Ae)),Qe(Xt.options.event),Dt.additionalEvent&&Qe(Dt.additionalEvent),Ae>=Oe&&Qe(Xt.options.event+Sn(Ae))},tryEmit:function(Dt){if(this.canEmit())return this.emit(Dt);this.state=$e},canEmit:function(){for(var Dt=0;Dt<this.requireFail.length;){if(!(this.requireFail[Dt].state&($e|pe)))return!1;Dt++}return!0},recognize:function(Dt){var Xt=Rt({},Dt);if(!Ke(this.options.enable,[this,Xt])){this.reset(),this.state=$e;return}this.state&(Ee|Ve|$e)&&(this.state=pe),this.state=this.process(Xt),this.state&(Ie|je|Oe|Ve)&&this.tryEmit(Xt)},process:function(Dt){},getTouchAction:function(){},reset:function(){}};function Sn(Dt){return Dt&Ve?"cancel":Dt&Oe?"end":Dt&je?"move":Dt&Ie?"start":""}function Dn(Dt){return Dt==kt?"down":Dt==N?"up":Dt==re?"left":Dt==Yt?"right":""}function vn(Dt,Xt){var Ae=Xt.manager;return Ae?Ae.get(Dt):Dt}function Mn(){pn.apply(this,arguments)}Me(Mn,pn,{defaults:{pointers:1},attrTest:function(Dt){var Xt=this.options.pointers;return Xt===0||Dt.pointers.length===Xt},process:function(Dt){var Xt=this.state,Ae=Dt.eventType,Qe=Xt&(Ie|je),gn=this.attrTest(Dt);return Qe&&(Ae&he||!gn)?Xt|Ve:Qe||gn?Ae&me?Xt|Oe:Xt&Ie?Xt|je:Ie:$e}});function Pn(){Mn.apply(this,arguments),this.pX=null,this.pY=null}Me(Pn,Mn,{defaults:{event:"pan",threshold:10,pointers:1,direction:z},getTouchAction:function(){var Dt=this.options.direction,Xt=[];return Dt&oe&&Xt.push(li),Dt&C&&Xt.push(fa),Xt},directionTest:function(Dt){var Xt=this.options,Ae=!0,Qe=Dt.distance,gn=Dt.direction,In=Dt.deltaX,Xn=Dt.deltaY;return gn&Xt.direction||(Xt.direction&oe?(gn=In===0?Tt:In<0?re:Yt,Ae=In!=this.pX,Qe=Math.abs(Dt.deltaX)):(gn=Xn===0?Tt:Xn<0?N:kt,Ae=Xn!=this.pY,Qe=Math.abs(Dt.deltaY))),Dt.direction=gn,Ae&&Qe>Xt.threshold&&gn&Xt.direction},attrTest:function(Dt){return Mn.prototype.attrTest.call(this,Dt)&&(this.state&Ie||!(this.state&Ie)&&this.directionTest(Dt))},emit:function(Dt){this.pX=Dt.deltaX,this.pY=Dt.deltaY;var Xt=Dn(Dt.direction);Xt&&(Dt.additionalEvent=this.options.event+Xt),this._super.emit.call(this,Dt)}});function yn(){Mn.apply(this,arguments)}Me(yn,Mn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[So]},attrTest:function(Dt){return this._super.attrTest.call(this,Dt)&&(Math.abs(Dt.scale-1)>this.options.threshold||this.state&Ie)},emit:function(Dt){if(Dt.scale!==1){var Xt=Dt.scale<1?"in":"out";Dt.additionalEvent=this.options.event+Xt}this._super.emit.call(this,Dt)}});function $n(){pn.apply(this,arguments),this._timer=null,this._input=null}Me($n,pn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[io]},process:function(Dt){var Xt=this.options,Ae=Dt.pointers.length===Xt.pointers,Qe=Dt.distance<Xt.threshold,gn=Dt.deltaTime>Xt.time;if(this._input=Dt,!Qe||!Ae||Dt.eventType&(me|he)&&!gn)this.reset();else if(Dt.eventType&ct)this.reset(),this._timer=X(function(){this.state=Ee,this.tryEmit()},Xt.time,this);else if(Dt.eventType&me)return Ee;return $e},reset:function(){clearTimeout(this._timer)},emit:function(Dt){this.state===Ee&&(Dt&&Dt.eventType&me?this.manager.emit(this.options.event+"up",Dt):(this._input.timeStamp=K(),this.manager.emit(this.options.event,this._input)))}});function kn(){Mn.apply(this,arguments)}Me(kn,Mn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[So]},attrTest:function(Dt){return this._super.attrTest.call(this,Dt)&&(Math.abs(Dt.rotation)>this.options.threshold||this.state&Ie)}});function Vn(){Mn.apply(this,arguments)}Me(Vn,Mn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:oe|C,pointers:1},getTouchAction:function(){return Pn.prototype.getTouchAction.call(this)},attrTest:function(Dt){var Xt=this.options.direction,Ae;return Xt&(oe|C)?Ae=Dt.overallVelocity:Xt&oe?Ae=Dt.overallVelocityX:Xt&C&&(Ae=Dt.overallVelocityY),this._super.attrTest.call(this,Dt)&&Xt&Dt.offsetDirection&&Dt.distance>this.options.threshold&&Dt.maxPointers==this.options.pointers&&Vt(Ae)>this.options.velocity&&Dt.eventType&me},emit:function(Dt){var Xt=Dn(Dt.offsetDirection);Xt&&this.manager.emit(this.options.event+Xt,Dt),this.manager.emit(this.options.event,Dt)}});function Ln(){pn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Me(Ln,pn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ko]},process:function(Dt){var Xt=this.options,Ae=Dt.pointers.length===Xt.pointers,Qe=Dt.distance<Xt.threshold,gn=Dt.deltaTime<Xt.time;if(this.reset(),Dt.eventType&ct&&this.count===0)return this.failTimeout();if(Qe&&gn&&Ae){if(Dt.eventType!=me)return this.failTimeout();var In=this.pTime?Dt.timeStamp-this.pTime<Xt.interval:!0,Xn=!this.pCenter||ye(this.pCenter,Dt.center)<Xt.posThreshold;this.pTime=Dt.timeStamp,this.pCenter=Dt.center,!Xn||!In?this.count=1:this.count+=1,this._input=Dt;var ri=this.count%Xt.taps;if(ri===0)return this.hasRequireFailures()?(this._timer=X(function(){this.state=Ee,this.tryEmit()},Xt.interval,this),Ie):Ee}return $e},failTimeout:function(){return this._timer=X(function(){this.state=$e},this.options.interval,this),$e},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ee&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function zn(Dt,Xt){return Xt=Xt||{},Xt.recognizers=we(Xt.recognizers,zn.defaults.preset),new Wi(Dt,Xt)}zn.VERSION="2.0.7",zn.defaults={domEvents:!1,touchAction:Hi,enable:!0,inputTarget:null,inputClass:null,preset:[[kn,{enable:!1}],[yn,{enable:!1},["rotate"]],[Vn,{direction:oe}],[Pn,{direction:oe},["swipe"]],[Ln],[Ln,{event:"doubletap",taps:2},["tap"]],[$n]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ir=1,Qi=2;function Wi(Dt,Xt){this.options=Rt({},zn.defaults,Xt||{}),this.options.inputTarget=this.options.inputTarget||Dt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Dt,this.input=Se(this),this.touchAction=new ft(this,this.options.touchAction),fi(this,!0),Mt(this.options.recognizers,function(Ae){var Qe=this.add(new Ae[0](Ae[1]));Ae[2]&&Qe.recognizeWith(Ae[2]),Ae[3]&&Qe.requireFailure(Ae[3])},this)}Wi.prototype={set:function(Dt){return Rt(this.options,Dt),Dt.touchAction&&this.touchAction.update(),Dt.inputTarget&&(this.input.destroy(),this.input.target=Dt.inputTarget,this.input.init()),this},stop:function(Dt){this.session.stopped=Dt?Qi:ir},recognize:function(Dt){var Xt=this.session;if(!Xt.stopped){this.touchAction.preventDefaults(Dt);var Ae,Qe=this.recognizers,gn=Xt.curRecognizer;(!gn||gn&&gn.state&Ee)&&(gn=Xt.curRecognizer=null);for(var In=0;In<Qe.length;)Ae=Qe[In],Xt.stopped!==Qi&&(!gn||Ae==gn||Ae.canRecognizeWith(gn))?Ae.recognize(Dt):Ae.reset(),!gn&&Ae.state&(Ie|je|Oe)&&(gn=Xt.curRecognizer=Ae),In++}},get:function(Dt){if(Dt instanceof pn)return Dt;for(var Xt=this.recognizers,Ae=0;Ae<Xt.length;Ae++)if(Xt[Ae].options.event==Dt)return Xt[Ae];return null},add:function(Dt){if(Zt(Dt,"add",this))return this;var Xt=this.get(Dt.options.event);return Xt&&this.remove(Xt),this.recognizers.push(Dt),Dt.manager=this,this.touchAction.update(),Dt},remove:function(Dt){if(Zt(Dt,"remove",this))return this;if(Dt=this.get(Dt),Dt){var Xt=this.recognizers,Ae=Pe(Xt,Dt);Ae!==-1&&(Xt.splice(Ae,1),this.touchAction.update())}return this},on:function(Dt,Xt){if(Dt!==G&&Xt!==G){var Ae=this.handlers;return Mt(At(Dt),function(Qe){Ae[Qe]=Ae[Qe]||[],Ae[Qe].push(Xt)}),this}},off:function(Dt,Xt){if(Dt!==G){var Ae=this.handlers;return Mt(At(Dt),function(Qe){Xt?Ae[Qe]&&Ae[Qe].splice(Pe(Ae[Qe],Xt),1):delete Ae[Qe]}),this}},emit:function(Dt,Xt){this.options.domEvents&&Ji(Dt,Xt);var Ae=this.handlers[Dt]&&this.handlers[Dt].slice();if(!(!Ae||!Ae.length)){Xt.type=Dt,Xt.preventDefault=function(){Xt.srcEvent.preventDefault()};for(var Qe=0;Qe<Ae.length;)Ae[Qe](Xt),Qe++}},destroy:function(){this.element&&fi(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function fi(Dt,Xt){var Ae=Dt.element;if(Ae.style){var Qe;Mt(Dt.options.cssProps,function(gn,In){Qe=q(Ae.style,In),Xt?(Dt.oldCssProps[Qe]=Ae.style[Qe],Ae.style[Qe]=gn):Ae.style[Qe]=Dt.oldCssProps[Qe]||""}),Xt||(Dt.oldCssProps={})}}function Ji(Dt,Xt){var Ae=tt.createEvent("Event");Ae.initEvent(Dt,!0,!0),Ae.gesture=Xt,Xt.target.dispatchEvent(Ae)}Rt(zn,{INPUT_START:ct,INPUT_MOVE:Ct,INPUT_END:me,INPUT_CANCEL:he,STATE_POSSIBLE:pe,STATE_BEGAN:Ie,STATE_CHANGED:je,STATE_ENDED:Oe,STATE_RECOGNIZED:Ee,STATE_CANCELLED:Ve,STATE_FAILED:$e,DIRECTION_NONE:Tt,DIRECTION_LEFT:re,DIRECTION_RIGHT:Yt,DIRECTION_UP:N,DIRECTION_DOWN:kt,DIRECTION_HORIZONTAL:oe,DIRECTION_VERTICAL:C,DIRECTION_ALL:z,Manager:Wi,Input:se,TouchAction:ft,TouchInput:pr,MouseInput:ge,PointerEventInput:Ce,TouchMouseInput:Lr,SingleTouchInput:mn,Recognizer:pn,AttrRecognizer:Mn,Tap:Ln,Pan:Pn,Swipe:Vn,Pinch:yn,Rotate:kn,Press:$n,on:Ut,off:nt,each:Mt,merge:ve,extend:Gt,assign:Rt,inherit:Me,bindFn:Ue,prefixed:q});var to=typeof Z!="undefined"?Z:typeof self!="undefined"?self:{};to.Hammer=zn,Y=function(){return zn}.call(Qt,L,Qt,$t),Y!==G&&($t.exports=Y)})(window,document,"Hammer")},18552:function($t,Qt,L){var Y=L(10852),Z=L(55639),tt=Y(Z,"DataView");$t.exports=tt},53818:function($t,Qt,L){var Y=L(10852),Z=L(55639),tt=Y(Z,"Promise");$t.exports=tt},58525:function($t,Qt,L){var Y=L(10852),Z=L(55639),tt=Y(Z,"Set");$t.exports=tt},88668:function($t,Qt,L){var Y=L(83369),Z=L(90619),tt=L(72385);function yt(G){var Ot=-1,bt=G==null?0:G.length;for(this.__data__=new Y;++Ot<bt;)this.add(G[Ot])}yt.prototype.add=yt.prototype.push=Z,yt.prototype.has=tt,$t.exports=yt},70577:function($t,Qt,L){var Y=L(10852),Z=L(55639),tt=Y(Z,"WeakMap");$t.exports=tt},77412:function($t){function Qt(L,Y){for(var Z=-1,tt=L==null?0:L.length;++Z<tt&&Y(L[Z],Z,L)!==!1;);return L}$t.exports=Qt},34963:function($t){function Qt(L,Y){for(var Z=-1,tt=L==null?0:L.length,yt=0,G=[];++Z<tt;){var Ot=L[Z];Y(Ot,Z,L)&&(G[yt++]=Ot)}return G}$t.exports=Qt},47443:function($t,Qt,L){var Y=L(42118);function Z(tt,yt){var G=tt==null?0:tt.length;return!!G&&Y(tt,yt,0)>-1}$t.exports=Z},1196:function($t){function Qt(L,Y,Z){for(var tt=-1,yt=L==null?0:L.length;++tt<yt;)if(Z(Y,L[tt]))return!0;return!1}$t.exports=Qt},62488:function($t){function Qt(L,Y){for(var Z=-1,tt=Y.length,yt=L.length;++Z<tt;)L[yt+Z]=Y[Z];return L}$t.exports=Qt},82908:function($t){function Qt(L,Y){for(var Z=-1,tt=L==null?0:L.length;++Z<tt;)if(Y(L[Z],Z,L))return!0;return!1}$t.exports=Qt},44037:function($t,Qt,L){var Y=L(98363),Z=L(3674);function tt(yt,G){return yt&&Y(G,Z(G),yt)}$t.exports=tt},63886:function($t,Qt,L){var Y=L(98363),Z=L(81704);function tt(yt,G){return yt&&Y(G,Z(G),yt)}$t.exports=tt},29750:function($t){function Qt(L,Y,Z){return L===L&&(Z!==void 0&&(L=L<=Z?L:Z),Y!==void 0&&(L=L>=Y?L:Y)),L}$t.exports=Qt},85990:function($t,Qt,L){var Y=L(46384),Z=L(77412),tt=L(34865),yt=L(44037),G=L(63886),Ot=L(64626),bt=L(6450),Et=L(18805),pt=L(1911),Vt=L(58234),K=L(46904),X=L(64160),Zt=L(43824),Mt=L(29148),zt=L(38517),Rt=L(1469),Gt=L(44144),ve=L(56688),Me=L(13218),Ue=L(72928),Ke=L(3674),we=L(81704),Ut=1,nt=2,ie=4,qt="[object Arguments]",At="[object Array]",Pe="[object Boolean]",it="[object Date]",Pt="[object Error]",q="[object Function]",Nt="[object GeneratorFunction]",It="[object Map]",U="[object Number]",ht="[object Object]",ne="[object RegExp]",xe="[object Set]",_e="[object String]",Xe="[object Symbol]",Re="[object WeakMap]",un="[object ArrayBuffer]",cn="[object DataView]",Jt="[object Float32Array]",ct="[object Float64Array]",Ct="[object Int8Array]",me="[object Int16Array]",he="[object Int32Array]",Tt="[object Uint8Array]",re="[object Uint8ClampedArray]",Yt="[object Uint16Array]",N="[object Uint32Array]",kt={};kt[qt]=kt[At]=kt[un]=kt[cn]=kt[Pe]=kt[it]=kt[Jt]=kt[ct]=kt[Ct]=kt[me]=kt[he]=kt[It]=kt[U]=kt[ht]=kt[ne]=kt[xe]=kt[_e]=kt[Xe]=kt[Tt]=kt[re]=kt[Yt]=kt[N]=!0,kt[Pt]=kt[q]=kt[Re]=!1;function oe(C,z,Ft,te,se,Se){var be,Ze=z&Ut,tn=z&nt,Ge=z&ie;if(Ft&&(be=se?Ft(C,te,se,Se):Ft(C)),be!==void 0)return be;if(!Me(C))return C;var Be=Rt(C);if(Be){if(be=Zt(C),!Ze)return bt(C,be)}else{var jt=X(C),ce=jt==q||jt==Nt;if(Gt(C))return Ot(C,Ze);if(jt==ht||jt==qt||ce&&!se){if(be=tn||ce?{}:zt(C),!Ze)return tn?pt(C,G(be,C)):Et(C,yt(be,C))}else{if(!kt[jt])return se?C:{};be=Mt(C,jt,Ze)}}Se||(Se=new Y);var ae=Se.get(C);if(ae)return ae;Se.set(C,be),Ue(C)?C.forEach(function(D){be.add(oe(D,z,Ft,D,C,Se))}):ve(C)&&C.forEach(function(D,H){be.set(H,oe(D,z,Ft,H,C,Se))});var ye=Ge?tn?K:Vt:tn?we:Ke,st=Be?void 0:ye(C);return Z(st||C,function(D,H){st&&(H=D,D=C[H]),tt(be,H,oe(D,z,Ft,H,C,Se))}),be}$t.exports=oe},41848:function($t){function Qt(L,Y,Z,tt){for(var yt=L.length,G=Z+(tt?1:-1);tt?G--:++G<yt;)if(Y(L[G],G,L))return G;return-1}$t.exports=Qt},97786:function($t,Qt,L){var Y=L(71811),Z=L(40327);function tt(yt,G){G=Y(G,yt);for(var Ot=0,bt=G.length;yt!=null&&Ot<bt;)yt=yt[Z(G[Ot++])];return Ot&&Ot==bt?yt:void 0}$t.exports=tt},68866:function($t,Qt,L){var Y=L(62488),Z=L(1469);function tt(yt,G,Ot){var bt=G(yt);return Z(yt)?bt:Y(bt,Ot(yt))}$t.exports=tt},42118:function($t,Qt,L){var Y=L(41848),Z=L(62722),tt=L(39375);function yt(G,Ot,bt){return Ot===Ot?tt(G,Ot,bt):Y(G,Z,bt)}$t.exports=yt},74221:function($t){function Qt(L,Y,Z,tt){for(var yt=Z-1,G=L.length;++yt<G;)if(tt(L[yt],Y))return yt;return-1}$t.exports=Qt},90939:function($t,Qt,L){var Y=L(2492),Z=L(37005);function tt(yt,G,Ot,bt,Et){return yt===G?!0:yt==null||G==null||!Z(yt)&&!Z(G)?yt!==yt&&G!==G:Y(yt,G,Ot,bt,tt,Et)}$t.exports=tt},2492:function($t,Qt,L){var Y=L(46384),Z=L(67114),tt=L(18351),yt=L(16096),G=L(64160),Ot=L(1469),bt=L(44144),Et=L(36719),pt=1,Vt="[object Arguments]",K="[object Array]",X="[object Object]",Zt=Object.prototype,Mt=Zt.hasOwnProperty;function zt(Rt,Gt,ve,Me,Ue,Ke){var we=Ot(Rt),Ut=Ot(Gt),nt=we?K:G(Rt),ie=Ut?K:G(Gt);nt=nt==Vt?X:nt,ie=ie==Vt?X:ie;var qt=nt==X,At=ie==X,Pe=nt==ie;if(Pe&&bt(Rt)){if(!bt(Gt))return!1;we=!0,qt=!1}if(Pe&&!qt)return Ke||(Ke=new Y),we||Et(Rt)?Z(Rt,Gt,ve,Me,Ue,Ke):tt(Rt,Gt,nt,ve,Me,Ue,Ke);if(!(ve&pt)){var it=qt&&Mt.call(Rt,"__wrapped__"),Pt=At&&Mt.call(Gt,"__wrapped__");if(it||Pt){var q=it?Rt.value():Rt,Nt=Pt?Gt.value():Gt;return Ke||(Ke=new Y),Ue(q,Nt,ve,Me,Ke)}}return Pe?(Ke||(Ke=new Y),yt(Rt,Gt,ve,Me,Ue,Ke)):!1}$t.exports=zt},25588:function($t,Qt,L){var Y=L(64160),Z=L(37005),tt="[object Map]";function yt(G){return Z(G)&&Y(G)==tt}$t.exports=yt},62722:function($t){function Qt(L){return L!==L}$t.exports=Qt},29221:function($t,Qt,L){var Y=L(64160),Z=L(37005),tt="[object Set]";function yt(G){return Z(G)&&Y(G)==tt}$t.exports=yt},280:function($t,Qt,L){var Y=L(25726),Z=L(86916),tt=Object.prototype,yt=tt.hasOwnProperty;function G(Ot){if(!Y(Ot))return Z(Ot);var bt=[];for(var Et in Object(Ot))yt.call(Ot,Et)&&Et!="constructor"&&bt.push(Et);return bt}$t.exports=G},65464:function($t,Qt,L){var Y=L(29932),Z=L(42118),tt=L(74221),yt=L(51717),G=L(6450),Ot=Array.prototype,bt=Ot.splice;function Et(pt,Vt,K,X){var Zt=X?tt:Z,Mt=-1,zt=Vt.length,Rt=pt;for(pt===Vt&&(Vt=G(Vt)),K&&(Rt=Y(pt,yt(K)));++Mt<zt;)for(var Gt=0,ve=Vt[Mt],Me=K?K(ve):ve;(Gt=Zt(Rt,Me,Gt,X))>-1;)Rt!==pt&&bt.call(Rt,Gt,1),bt.call(pt,Gt,1);return pt}$t.exports=Et},27561:function($t,Qt,L){var Y=L(67990),Z=/^\s+/;function tt(yt){return yt&&yt.slice(0,Y(yt)+1).replace(Z,"")}$t.exports=tt},45652:function($t,Qt,L){var Y=L(88668),Z=L(47443),tt=L(1196),yt=L(74757),G=L(4896),Ot=L(21814),bt=200;function Et(pt,Vt,K){var X=-1,Zt=Z,Mt=pt.length,zt=!0,Rt=[],Gt=Rt;if(K)zt=!1,Zt=tt;else if(Mt>=bt){var ve=Vt?null:G(pt);if(ve)return Ot(ve);zt=!1,Zt=yt,Gt=new Y}else Gt=Vt?[]:Rt;t:for(;++X<Mt;){var Me=pt[X],Ue=Vt?Vt(Me):Me;if(Me=K||Me!==0?Me:0,zt&&Ue===Ue){for(var Ke=Gt.length;Ke--;)if(Gt[Ke]===Ue)continue t;Vt&&Gt.push(Ue),Rt.push(Me)}else Zt(Gt,Ue,K)||(Gt!==Rt&&Gt.push(Ue),Rt.push(Me))}return Rt}$t.exports=Et},74757:function($t){function Qt(L,Y){return L.has(Y)}$t.exports=Qt},71811:function($t,Qt,L){var Y=L(1469),Z=L(15403),tt=L(55514),yt=L(79833);function G(Ot,bt){return Y(Ot)?Ot:Z(Ot,bt)?[Ot]:tt(yt(Ot))}$t.exports=G},57157:function($t,Qt,L){var Y=L(74318);function Z(tt,yt){var G=yt?Y(tt.buffer):tt.buffer;return new tt.constructor(G,tt.byteOffset,tt.byteLength)}$t.exports=Z},93147:function($t){var Qt=/\w*$/;function L(Y){var Z=new Y.constructor(Y.source,Qt.exec(Y));return Z.lastIndex=Y.lastIndex,Z}$t.exports=L},40419:function($t,Qt,L){var Y=L(62705),Z=Y?Y.prototype:void 0,tt=Z?Z.valueOf:void 0;function yt(G){return tt?Object(tt.call(G)):{}}$t.exports=yt},18805:function($t,Qt,L){var Y=L(98363),Z=L(99551);function tt(yt,G){return Y(yt,Z(yt),G)}$t.exports=tt},1911:function($t,Qt,L){var Y=L(98363),Z=L(51442);function tt(yt,G){return Y(yt,Z(yt),G)}$t.exports=tt},4896:function($t,Qt,L){var Y=L(58525),Z=L(28117),tt=L(21814),yt=1/0,G=Y&&1/tt(new Y([,-0]))[1]==yt?function(Ot){return new Y(Ot)}:Z;$t.exports=G},67114:function($t,Qt,L){var Y=L(88668),Z=L(82908),tt=L(74757),yt=1,G=2;function Ot(bt,Et,pt,Vt,K,X){var Zt=pt&yt,Mt=bt.length,zt=Et.length;if(Mt!=zt&&!(Zt&&zt>Mt))return!1;var Rt=X.get(bt),Gt=X.get(Et);if(Rt&&Gt)return Rt==Et&&Gt==bt;var ve=-1,Me=!0,Ue=pt&G?new Y:void 0;for(X.set(bt,Et),X.set(Et,bt);++ve<Mt;){var Ke=bt[ve],we=Et[ve];if(Vt)var Ut=Zt?Vt(we,Ke,ve,Et,bt,X):Vt(Ke,we,ve,bt,Et,X);if(Ut!==void 0){if(Ut)continue;Me=!1;break}if(Ue){if(!Z(Et,function(nt,ie){if(!tt(Ue,ie)&&(Ke===nt||K(Ke,nt,pt,Vt,X)))return Ue.push(ie)})){Me=!1;break}}else if(!(Ke===we||K(Ke,we,pt,Vt,X))){Me=!1;break}}return X.delete(bt),X.delete(Et),Me}$t.exports=Ot},18351:function($t,Qt,L){var Y=L(62705),Z=L(11149),tt=L(77813),yt=L(67114),G=L(68776),Ot=L(21814),bt=1,Et=2,pt="[object Boolean]",Vt="[object Date]",K="[object Error]",X="[object Map]",Zt="[object Number]",Mt="[object RegExp]",zt="[object Set]",Rt="[object String]",Gt="[object Symbol]",ve="[object ArrayBuffer]",Me="[object DataView]",Ue=Y?Y.prototype:void 0,Ke=Ue?Ue.valueOf:void 0;function we(Ut,nt,ie,qt,At,Pe,it){switch(ie){case Me:if(Ut.byteLength!=nt.byteLength||Ut.byteOffset!=nt.byteOffset)return!1;Ut=Ut.buffer,nt=nt.buffer;case ve:return!(Ut.byteLength!=nt.byteLength||!Pe(new Z(Ut),new Z(nt)));case pt:case Vt:case Zt:return tt(+Ut,+nt);case K:return Ut.name==nt.name&&Ut.message==nt.message;case Mt:case Rt:return Ut==nt+"";case X:var Pt=G;case zt:var q=qt&bt;if(Pt||(Pt=Ot),Ut.size!=nt.size&&!q)return!1;var Nt=it.get(Ut);if(Nt)return Nt==nt;qt|=Et,it.set(Ut,nt);var It=yt(Pt(Ut),Pt(nt),qt,At,Pe,it);return it.delete(Ut),It;case Gt:if(Ke)return Ke.call(Ut)==Ke.call(nt)}return!1}$t.exports=we},16096:function($t,Qt,L){var Y=L(58234),Z=1,tt=Object.prototype,yt=tt.hasOwnProperty;function G(Ot,bt,Et,pt,Vt,K){var X=Et&Z,Zt=Y(Ot),Mt=Zt.length,zt=Y(bt),Rt=zt.length;if(Mt!=Rt&&!X)return!1;for(var Gt=Mt;Gt--;){var ve=Zt[Gt];if(!(X?ve in bt:yt.call(bt,ve)))return!1}var Me=K.get(Ot),Ue=K.get(bt);if(Me&&Ue)return Me==bt&&Ue==Ot;var Ke=!0;K.set(Ot,bt),K.set(bt,Ot);for(var we=X;++Gt<Mt;){ve=Zt[Gt];var Ut=Ot[ve],nt=bt[ve];if(pt)var ie=X?pt(nt,Ut,ve,bt,Ot,K):pt(Ut,nt,ve,Ot,bt,K);if(!(ie===void 0?Ut===nt||Vt(Ut,nt,Et,pt,K):ie)){Ke=!1;break}we||(we=ve=="constructor")}if(Ke&&!we){var qt=Ot.constructor,At=bt.constructor;qt!=At&&"constructor"in Ot&&"constructor"in bt&&!(typeof qt=="function"&&qt instanceof qt&&typeof At=="function"&&At instanceof At)&&(Ke=!1)}return K.delete(Ot),K.delete(bt),Ke}$t.exports=G},58234:function($t,Qt,L){var Y=L(68866),Z=L(99551),tt=L(3674);function yt(G){return Y(G,tt,Z)}$t.exports=yt},46904:function($t,Qt,L){var Y=L(68866),Z=L(51442),tt=L(81704);function yt(G){return Y(G,tt,Z)}$t.exports=yt},99551:function($t,Qt,L){var Y=L(34963),Z=L(70479),tt=Object.prototype,yt=tt.propertyIsEnumerable,G=Object.getOwnPropertySymbols,Ot=G?function(bt){return bt==null?[]:(bt=Object(bt),Y(G(bt),function(Et){return yt.call(bt,Et)}))}:Z;$t.exports=Ot},51442:function($t,Qt,L){var Y=L(62488),Z=L(85924),tt=L(99551),yt=L(70479),G=Object.getOwnPropertySymbols,Ot=G?function(bt){for(var Et=[];bt;)Y(Et,tt(bt)),bt=Z(bt);return Et}:yt;$t.exports=Ot},64160:function($t,Qt,L){var Y=L(18552),Z=L(57071),tt=L(53818),yt=L(58525),G=L(70577),Ot=L(44239),bt=L(80346),Et="[object Map]",pt="[object Object]",Vt="[object Promise]",K="[object Set]",X="[object WeakMap]",Zt="[object DataView]",Mt=bt(Y),zt=bt(Z),Rt=bt(tt),Gt=bt(yt),ve=bt(G),Me=Ot;(Y&&Me(new Y(new ArrayBuffer(1)))!=Zt||Z&&Me(new Z)!=Et||tt&&Me(tt.resolve())!=Vt||yt&&Me(new yt)!=K||G&&Me(new G)!=X)&&(Me=function(Ue){var Ke=Ot(Ue),we=Ke==pt?Ue.constructor:void 0,Ut=we?bt(we):"";if(Ut)switch(Ut){case Mt:return Zt;case zt:return Et;case Rt:return Vt;case Gt:return K;case ve:return X}return Ke}),$t.exports=Me},43824:function($t){var Qt=Object.prototype,L=Qt.hasOwnProperty;function Y(Z){var tt=Z.length,yt=new Z.constructor(tt);return tt&&typeof Z[0]=="string"&&L.call(Z,"index")&&(yt.index=Z.index,yt.input=Z.input),yt}$t.exports=Y},29148:function($t,Qt,L){var Y=L(74318),Z=L(57157),tt=L(93147),yt=L(40419),G=L(77133),Ot="[object Boolean]",bt="[object Date]",Et="[object Map]",pt="[object Number]",Vt="[object RegExp]",K="[object Set]",X="[object String]",Zt="[object Symbol]",Mt="[object ArrayBuffer]",zt="[object DataView]",Rt="[object Float32Array]",Gt="[object Float64Array]",ve="[object Int8Array]",Me="[object Int16Array]",Ue="[object Int32Array]",Ke="[object Uint8Array]",we="[object Uint8ClampedArray]",Ut="[object Uint16Array]",nt="[object Uint32Array]";function ie(qt,At,Pe){var it=qt.constructor;switch(At){case Mt:return Y(qt);case Ot:case bt:return new it(+qt);case zt:return Z(qt,Pe);case Rt:case Gt:case ve:case Me:case Ue:case Ke:case we:case Ut:case nt:return G(qt,Pe);case Et:return new it;case pt:case X:return new it(qt);case Vt:return tt(qt);case K:return new it;case Zt:return yt(qt)}}$t.exports=ie},15403:function($t,Qt,L){var Y=L(1469),Z=L(33448),tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yt=/^\w*$/;function G(Ot,bt){if(Y(Ot))return!1;var Et=typeof Ot;return Et=="number"||Et=="symbol"||Et=="boolean"||Ot==null||Z(Ot)?!0:yt.test(Ot)||!tt.test(Ot)||bt!=null&&Ot in Object(bt)}$t.exports=G},68776:function($t){function Qt(L){var Y=-1,Z=Array(L.size);return L.forEach(function(tt,yt){Z[++Y]=[yt,tt]}),Z}$t.exports=Qt},24523:function($t,Qt,L){var Y=L(15644),Z=500;function tt(yt){var G=Y(yt,function(bt){return Ot.size===Z&&Ot.clear(),bt}),Ot=G.cache;return G}$t.exports=tt},86916:function($t,Qt,L){var Y=L(5569),Z=Y(Object.keys,Object);$t.exports=Z},90619:function($t){var Qt="__lodash_hash_undefined__";function L(Y){return this.__data__.set(Y,Qt),this}$t.exports=L},72385:function($t){function Qt(L){return this.__data__.has(L)}$t.exports=Qt},21814:function($t){function Qt(L){var Y=-1,Z=Array(L.size);return L.forEach(function(tt){Z[++Y]=tt}),Z}$t.exports=Qt},39375:function($t){function Qt(L,Y,Z){for(var tt=Z-1,yt=L.length;++tt<yt;)if(L[tt]===Y)return tt;return-1}$t.exports=Qt},55514:function($t,Qt,L){var Y=L(24523),Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/\\(\\)?/g,yt=Y(function(G){var Ot=[];return G.charCodeAt(0)===46&&Ot.push(""),G.replace(Z,function(bt,Et,pt,Vt){Ot.push(pt?Vt.replace(tt,"$1"):Et||bt)}),Ot});$t.exports=yt},40327:function($t,Qt,L){var Y=L(33448),Z=1/0;function tt(yt){if(typeof yt=="string"||Y(yt))return yt;var G=yt+"";return G=="0"&&1/yt==-Z?"-0":G}$t.exports=tt},67990:function($t){var Qt=/\s/;function L(Y){for(var Z=Y.length;Z--&&Qt.test(Y.charAt(Z)););return Z}$t.exports=L},74691:function($t,Qt,L){var Y=L(29750),Z=L(14841);function tt(yt,G,Ot){return Ot===void 0&&(Ot=G,G=void 0),Ot!==void 0&&(Ot=Z(Ot),Ot=Ot===Ot?Ot:0),G!==void 0&&(G=Z(G),G=G===G?G:0),Y(Z(yt),G,Ot)}$t.exports=tt},50361:function($t,Qt,L){var Y=L(85990),Z=1,tt=4;function yt(G){return Y(G,Z|tt)}$t.exports=yt},23279:function($t,Qt,L){var Y=L(13218),Z=L(7771),tt=L(14841),yt="Expected a function",G=Math.max,Ot=Math.min;function bt(Et,pt,Vt){var K,X,Zt,Mt,zt,Rt,Gt=0,ve=!1,Me=!1,Ue=!0;if(typeof Et!="function")throw new TypeError(yt);pt=tt(pt)||0,Y(Vt)&&(ve=!!Vt.leading,Me="maxWait"in Vt,Zt=Me?G(tt(Vt.maxWait)||0,pt):Zt,Ue="trailing"in Vt?!!Vt.trailing:Ue);function Ke(Pt){var q=K,Nt=X;return K=X=void 0,Gt=Pt,Mt=Et.apply(Nt,q),Mt}function we(Pt){return Gt=Pt,zt=setTimeout(ie,pt),ve?Ke(Pt):Mt}function Ut(Pt){var q=Pt-Rt,Nt=Pt-Gt,It=pt-q;return Me?Ot(It,Zt-Nt):It}function nt(Pt){var q=Pt-Rt,Nt=Pt-Gt;return Rt===void 0||q>=pt||q<0||Me&&Nt>=Zt}function ie(){var Pt=Z();if(nt(Pt))return qt(Pt);zt=setTimeout(ie,Ut(Pt))}function qt(Pt){return zt=void 0,Ue&&K?Ke(Pt):(K=X=void 0,Mt)}function At(){zt!==void 0&&clearTimeout(zt),Gt=0,K=Rt=X=zt=void 0}function Pe(){return zt===void 0?Mt:qt(Z())}function it(){var Pt=Z(),q=nt(Pt);if(K=arguments,X=this,Rt=Pt,q){if(zt===void 0)return we(Rt);if(Me)return clearTimeout(zt),zt=setTimeout(ie,pt),Ke(Rt)}return zt===void 0&&(zt=setTimeout(ie,pt)),Mt}return it.cancel=At,it.flush=Pe,it}$t.exports=bt},27361:function($t,Qt,L){var Y=L(97786);function Z(tt,yt,G){var Ot=tt==null?void 0:Y(tt,yt);return Ot===void 0?G:Ot}$t.exports=Z},51584:function($t,Qt,L){var Y=L(44239),Z=L(37005),tt="[object Boolean]";function yt(G){return G===!0||G===!1||Z(G)&&Y(G)==tt}$t.exports=yt},18446:function($t,Qt,L){var Y=L(90939);function Z(tt,yt){return Y(tt,yt)}$t.exports=Z},56688:function($t,Qt,L){var Y=L(25588),Z=L(51717),tt=L(31167),yt=tt&&tt.isMap,G=yt?Z(yt):Y;$t.exports=G},14293:function($t){function Qt(L){return L==null}$t.exports=Qt},81763:function($t,Qt,L){var Y=L(44239),Z=L(37005),tt="[object Number]";function yt(G){return typeof G=="number"||Z(G)&&Y(G)==tt}$t.exports=yt},72928:function($t,Qt,L){var Y=L(29221),Z=L(51717),tt=L(31167),yt=tt&&tt.isSet,G=yt?Z(yt):Y;$t.exports=G},47037:function($t,Qt,L){var Y=L(44239),Z=L(1469),tt=L(37005),yt="[object String]";function G(Ot){return typeof Ot=="string"||!Z(Ot)&&tt(Ot)&&Y(Ot)==yt}$t.exports=G},52353:function($t){function Qt(L){return L===void 0}$t.exports=Qt},3674:function($t,Qt,L){var Y=L(14636),Z=L(280),tt=L(98612);function yt(G){return tt(G)?Y(G):Z(G)}$t.exports=yt},15644:function($t,Qt,L){var Y=L(83369),Z="Expected a function";function tt(yt,G){if(typeof yt!="function"||G!=null&&typeof G!="function")throw new TypeError(Z);var Ot=function(){var bt=arguments,Et=G?G.apply(this,bt):bt[0],pt=Ot.cache;if(pt.has(Et))return pt.get(Et);var Vt=yt.apply(this,bt);return Ot.cache=pt.set(Et,Vt)||pt,Vt};return Ot.cache=new(tt.Cache||Y),Ot}tt.Cache=Y,$t.exports=tt},30236:function($t,Qt,L){var Y=L(42980),Z=L(21463),tt=Z(function(yt,G,Ot,bt){Y(yt,G,Ot,bt)});$t.exports=tt},28117:function($t){function Qt(){}$t.exports=Qt},7771:function($t,Qt,L){var Y=L(55639),Z=function(){return Y.Date.now()};$t.exports=Z},97019:function($t,Qt,L){var Y=L(5976),Z=L(45604),tt=Y(Z);$t.exports=tt},45604:function($t,Qt,L){var Y=L(65464);function Z(tt,yt){return tt&&tt.length&&yt&&yt.length?Y(tt,yt):tt}$t.exports=Z},70479:function($t){function Qt(){return[]}$t.exports=Qt},23493:function($t,Qt,L){var Y=L(23279),Z=L(13218),tt="Expected a function";function yt(G,Ot,bt){var Et=!0,pt=!0;if(typeof G!="function")throw new TypeError(tt);return Z(bt)&&(Et="leading"in bt?!!bt.leading:Et,pt="trailing"in bt?!!bt.trailing:pt),Y(G,Ot,{leading:Et,maxWait:Ot,trailing:pt})}$t.exports=yt},14841:function($t,Qt,L){var Y=L(27561),Z=L(13218),tt=L(33448),yt=NaN,G=/^[-+]0x[0-9a-f]+$/i,Ot=/^0b[01]+$/i,bt=/^0o[0-7]+$/i,Et=parseInt;function pt(Vt){if(typeof Vt=="number")return Vt;if(tt(Vt))return yt;if(Z(Vt)){var K=typeof Vt.valueOf=="function"?Vt.valueOf():Vt;Vt=Z(K)?K+"":K}if(typeof Vt!="string")return Vt===0?Vt:+Vt;Vt=Y(Vt);var X=Ot.test(Vt);return X||bt.test(Vt)?Et(Vt.slice(2),X?2:8):G.test(Vt)?yt:+Vt}$t.exports=pt},44908:function($t,Qt,L){var Y=L(45652);function Z(tt){return tt&&tt.length?Y(tt):[]}$t.exports=Z},73955:function($t,Qt,L){var Y=L(79833),Z=0;function tt(yt){var G=++Z;return Y(yt)+G}$t.exports=tt},92077:function($t,Qt,L){var Y,Z;(function(tt,yt){Y=yt,Z=typeof Y=="function"?Y.call(Qt,L,Qt,$t):Y,Z!==void 0&&($t.exports=Z)})(this,function(){var tt,yt,G="2.0.6",Ot={},bt={},Et={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},pt={currentLocale:Et.currentLocale,zeroFormat:Et.zeroFormat,nullFormat:Et.nullFormat,defaultFormat:Et.defaultFormat,scalePercentBy100:Et.scalePercentBy100};function Vt(K,X){this._input=K,this._value=X}return tt=function(K){var X,Zt,Mt,zt;if(tt.isNumeral(K))X=K.value();else if(K===0||typeof K=="undefined")X=0;else if(K===null||yt.isNaN(K))X=null;else if(typeof K=="string")if(pt.zeroFormat&&K===pt.zeroFormat)X=0;else if(pt.nullFormat&&K===pt.nullFormat||!K.replace(/[^0-9]+/g,"").length)X=null;else{for(Zt in Ot)if(zt=typeof Ot[Zt].regexps.unformat=="function"?Ot[Zt].regexps.unformat():Ot[Zt].regexps.unformat,zt&&K.match(zt)){Mt=Ot[Zt].unformat;break}Mt=Mt||tt._.stringToNumber,X=Mt(K)}else X=Number(K)||null;return new Vt(K,X)},tt.version=G,tt.isNumeral=function(K){return K instanceof Vt},tt._=yt={numberToFormat:function(K,X,Zt){var Mt=bt[tt.options.currentLocale],zt=!1,Rt=!1,Gt=0,ve="",Me=1e12,Ue=1e9,Ke=1e6,we=1e3,Ut="",nt=!1,ie,qt,At,Pe,it,Pt,q,Nt,It,U;if(K=K||0,qt=Math.abs(K),tt._.includes(X,"(")?(zt=!0,X=X.replace(/[\(|\)]/g,"")):(tt._.includes(X,"+")||tt._.includes(X,"-"))&&(Nt=tt._.includes(X,"+")?X.indexOf("+"):K<0?X.indexOf("-"):-1,X=X.replace(/[\+|\-]/g,"")),tt._.includes(X,"a")&&(ie=X.match(/a(k|m|b|t)?/),ie=ie?ie[1]:!1,tt._.includes(X," a")&&(ve=" "),X=X.replace(new RegExp(ve+"a[kmbt]?"),""),qt>=Me&&!ie||ie==="t"?(ve+=Mt.abbreviations.trillion,K=K/Me):qt<Me&&qt>=Ue&&!ie||ie==="b"?(ve+=Mt.abbreviations.billion,K=K/Ue):qt<Ue&&qt>=Ke&&!ie||ie==="m"?(ve+=Mt.abbreviations.million,K=K/Ke):(qt<Ke&&qt>=we&&!ie||ie==="k")&&(ve+=Mt.abbreviations.thousand,K=K/we)),tt._.includes(X,"[.]")&&(Rt=!0,X=X.replace("[.]",".")),Pt=K.toString().split(".")[0],q=X.split(".")[1],It=X.indexOf(","),Gt=(X.split(".")[0].split(",")[0].match(/0/g)||[]).length,q?(tt._.includes(q,"[")?(q=q.replace("]",""),q=q.split("["),Ut=tt._.toFixed(K,q[0].length+q[1].length,Zt,q[1].length)):Ut=tt._.toFixed(K,q.length,Zt),Pt=Ut.split(".")[0],tt._.includes(Ut,".")?Ut=Mt.delimiters.decimal+Ut.split(".")[1]:Ut="",Rt&&Number(Ut.slice(1))===0&&(Ut="")):Pt=tt._.toFixed(K,0,Zt),ve&&!ie&&Number(Pt)>=1e3&&ve!==Mt.abbreviations.trillion)switch(Pt=String(Number(Pt)/1e3),ve){case Mt.abbreviations.thousand:ve=Mt.abbreviations.million;break;case Mt.abbreviations.million:ve=Mt.abbreviations.billion;break;case Mt.abbreviations.billion:ve=Mt.abbreviations.trillion;break}if(tt._.includes(Pt,"-")&&(Pt=Pt.slice(1),nt=!0),Pt.length<Gt)for(var ht=Gt-Pt.length;ht>0;ht--)Pt="0"+Pt;return It>-1&&(Pt=Pt.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+Mt.delimiters.thousands)),X.indexOf(".")===0&&(Pt=""),U=Pt+Ut+(ve||""),zt?U=(zt&&nt?"(":"")+U+(zt&&nt?")":""):Nt>=0?U=Nt===0?(nt?"-":"+")+U:U+(nt?"-":"+"):nt&&(U="-"+U),U},stringToNumber:function(K){var X=bt[pt.currentLocale],Zt=K,Mt={thousand:3,million:6,billion:9,trillion:12},zt,Rt,Gt,ve;if(pt.zeroFormat&&K===pt.zeroFormat)Rt=0;else if(pt.nullFormat&&K===pt.nullFormat||!K.replace(/[^0-9]+/g,"").length)Rt=null;else{Rt=1,X.delimiters.decimal!=="."&&(K=K.replace(/\./g,"").replace(X.delimiters.decimal,"."));for(zt in Mt)if(ve=new RegExp("[^a-zA-Z]"+X.abbreviations[zt]+"(?:\\)|(\\"+X.currency.symbol+")?(?:\\))?)?$"),Zt.match(ve)){Rt*=Math.pow(10,Mt[zt]);break}Rt*=(K.split("-").length+Math.min(K.split("(").length-1,K.split(")").length-1))%2?1:-1,K=K.replace(/[^0-9\.]+/g,""),Rt*=Number(K)}return Rt},isNaN:function(K){return typeof K=="number"&&isNaN(K)},includes:function(K,X){return K.indexOf(X)!==-1},insert:function(K,X,Zt){return K.slice(0,Zt)+X+K.slice(Zt)},reduce:function(K,X){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof X!="function")throw new TypeError(X+" is not a function");var Zt=Object(K),Mt=Zt.length>>>0,zt=0,Rt;if(arguments.length===3)Rt=arguments[2];else{for(;zt<Mt&&!(zt in Zt);)zt++;if(zt>=Mt)throw new TypeError("Reduce of empty array with no initial value");Rt=Zt[zt++]}for(;zt<Mt;zt++)zt in Zt&&(Rt=X(Rt,Zt[zt],zt,Zt));return Rt},multiplier:function(K){var X=K.toString().split(".");return X.length<2?1:Math.pow(10,X[1].length)},correctionFactor:function(){var K=Array.prototype.slice.call(arguments);return K.reduce(function(X,Zt){var Mt=yt.multiplier(Zt);return X>Mt?X:Mt},1)},toFixed:function(K,X,Zt,Mt){var zt=K.toString().split("."),Rt=X-(Mt||0),Gt,ve,Me,Ue;return zt.length===2?Gt=Math.min(Math.max(zt[1].length,Rt),X):Gt=Rt,Me=Math.pow(10,Gt),Ue=(Zt(K+"e+"+Gt)/Me).toFixed(Gt),Mt>X-Gt&&(ve=new RegExp("\\.?0{1,"+(Mt-(X-Gt))+"}$"),Ue=Ue.replace(ve,"")),Ue}},tt.options=pt,tt.formats=Ot,tt.locales=bt,tt.locale=function(K){return K&&(pt.currentLocale=K.toLowerCase()),pt.currentLocale},tt.localeData=function(K){if(!K)return bt[pt.currentLocale];if(K=K.toLowerCase(),!bt[K])throw new Error("Unknown locale : "+K);return bt[K]},tt.reset=function(){for(var K in Et)pt[K]=Et[K]},tt.zeroFormat=function(K){pt.zeroFormat=typeof K=="string"?K:null},tt.nullFormat=function(K){pt.nullFormat=typeof K=="string"?K:null},tt.defaultFormat=function(K){pt.defaultFormat=typeof K=="string"?K:"0.0"},tt.register=function(K,X,Zt){if(X=X.toLowerCase(),this[K+"s"][X])throw new TypeError(X+" "+K+" already registered.");return this[K+"s"][X]=Zt,Zt},tt.validate=function(K,X){var Zt,Mt,zt,Rt,Gt,ve,Me,Ue;if(typeof K!="string"&&(K+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",K)),K=K.trim(),K.match(/^\d+$/))return!0;if(K==="")return!1;try{Me=tt.localeData(X)}catch(Ke){Me=tt.localeData(tt.locale())}return zt=Me.currency.symbol,Gt=Me.abbreviations,Zt=Me.delimiters.decimal,Me.delimiters.thousands==="."?Mt="\\.":Mt=Me.delimiters.thousands,Ue=K.match(/^[^\d]+/),Ue!==null&&(K=K.substr(1),Ue[0]!==zt)||(Ue=K.match(/[^\d]+$/),Ue!==null&&(K=K.slice(0,-1),Ue[0]!==Gt.thousand&&Ue[0]!==Gt.million&&Ue[0]!==Gt.billion&&Ue[0]!==Gt.trillion))?!1:(ve=new RegExp(Mt+"{2}"),K.match(/[^\d.,]/g)?!1:(Rt=K.split(Zt),Rt.length>2?!1:Rt.length<2?!!Rt[0].match(/^\d+.*\d$/)&&!Rt[0].match(ve):Rt[0].length===1?!!Rt[0].match(/^\d+$/)&&!Rt[0].match(ve)&&!!Rt[1].match(/^\d+$/):!!Rt[0].match(/^\d+.*\d$/)&&!Rt[0].match(ve)&&!!Rt[1].match(/^\d+$/)))},tt.fn=Vt.prototype={clone:function(){return tt(this)},format:function(K,X){var Zt=this._value,Mt=K||pt.defaultFormat,zt,Rt,Gt;if(X=X||Math.round,Zt===0&&pt.zeroFormat!==null)Rt=pt.zeroFormat;else if(Zt===null&&pt.nullFormat!==null)Rt=pt.nullFormat;else{for(zt in Ot)if(Mt.match(Ot[zt].regexps.format)){Gt=Ot[zt].format;break}Gt=Gt||tt._.numberToFormat,Rt=Gt(Zt,Mt,X)}return Rt},value:function(){return this._value},input:function(){return this._input},set:function(K){return this._value=Number(K),this},add:function(K){var X=yt.correctionFactor.call(null,this._value,K);function Zt(Mt,zt,Rt,Gt){return Mt+Math.round(X*zt)}return this._value=yt.reduce([this._value,K],Zt,0)/X,this},subtract:function(K){var X=yt.correctionFactor.call(null,this._value,K);function Zt(Mt,zt,Rt,Gt){return Mt-Math.round(X*zt)}return this._value=yt.reduce([K],Zt,Math.round(this._value*X))/X,this},multiply:function(K){function X(Zt,Mt,zt,Rt){var Gt=yt.correctionFactor(Zt,Mt);return Math.round(Zt*Gt)*Math.round(Mt*Gt)/Math.round(Gt*Gt)}return this._value=yt.reduce([this._value,K],X,1),this},divide:function(K){function X(Zt,Mt,zt,Rt){var Gt=yt.correctionFactor(Zt,Mt);return Math.round(Zt*Gt)/Math.round(Mt*Gt)}return this._value=yt.reduce([this._value,K],X),this},difference:function(K){return Math.abs(tt(this._value).subtract(K).value())}},tt.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(K){var X=K%10;return~~(K%100/10)===1?"th":X===1?"st":X===2?"nd":X===3?"rd":"th"},currency:{symbol:"$"}}),function(){tt.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(K,X,Zt){var Mt=tt._.includes(X," BPS")?" ":"",zt;return K=K*1e4,X=X.replace(/\s?BPS/,""),zt=tt._.numberToFormat(K,X,Zt),tt._.includes(zt,")")?(zt=zt.split(""),zt.splice(-1,0,Mt+"BPS"),zt=zt.join("")):zt=zt+Mt+"BPS",zt},unformat:function(K){return+(tt._.stringToNumber(K)*1e-4).toFixed(15)}})}(),function(){var K={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},X={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},Zt=K.suffixes.concat(X.suffixes.filter(function(zt){return K.suffixes.indexOf(zt)<0})),Mt=Zt.join("|");Mt="("+Mt.replace("B","B(?!PS)")+")",tt.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(Mt)},format:function(zt,Rt,Gt){var ve,Me=tt._.includes(Rt,"ib")?X:K,Ue=tt._.includes(Rt," b")||tt._.includes(Rt," ib")?" ":"",Ke,we,Ut;for(Rt=Rt.replace(/\s?i?b/,""),Ke=0;Ke<=Me.suffixes.length;Ke++)if(we=Math.pow(Me.base,Ke),Ut=Math.pow(Me.base,Ke+1),zt===null||zt===0||zt>=we&&zt<Ut){Ue+=Me.suffixes[Ke],we>0&&(zt=zt/we);break}return ve=tt._.numberToFormat(zt,Rt,Gt),ve+Ue},unformat:function(zt){var Rt=tt._.stringToNumber(zt),Gt,ve;if(Rt){for(Gt=K.suffixes.length-1;Gt>=0;Gt--){if(tt._.includes(zt,K.suffixes[Gt])){ve=Math.pow(K.base,Gt);break}if(tt._.includes(zt,X.suffixes[Gt])){ve=Math.pow(X.base,Gt);break}}Rt*=ve||1}return Rt}})}(),function(){tt.register("format","currency",{regexps:{format:/(\$)/},format:function(K,X,Zt){var Mt=tt.locales[tt.options.currentLocale],zt={before:X.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:X.match(/([\+|\-|\)|\s|\$]*)$/)[0]},Rt,Gt,ve;for(X=X.replace(/\s?\$\s?/,""),Rt=tt._.numberToFormat(K,X,Zt),K>=0?(zt.before=zt.before.replace(/[\-\(]/,""),zt.after=zt.after.replace(/[\-\)]/,"")):K<0&&!tt._.includes(zt.before,"-")&&!tt._.includes(zt.before,"(")&&(zt.before="-"+zt.before),ve=0;ve<zt.before.length;ve++)switch(Gt=zt.before[ve],Gt){case"$":Rt=tt._.insert(Rt,Mt.currency.symbol,ve);break;case" ":Rt=tt._.insert(Rt," ",ve+Mt.currency.symbol.length-1);break}for(ve=zt.after.length-1;ve>=0;ve--)switch(Gt=zt.after[ve],Gt){case"$":Rt=ve===zt.after.length-1?Rt+Mt.currency.symbol:tt._.insert(Rt,Mt.currency.symbol,-(zt.after.length-(1+ve)));break;case" ":Rt=ve===zt.after.length-1?Rt+" ":tt._.insert(Rt," ",-(zt.after.length-(1+ve)+Mt.currency.symbol.length-1));break}return Rt}})}(),function(){tt.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(K,X,Zt){var Mt,zt=typeof K=="number"&&!tt._.isNaN(K)?K.toExponential():"0e+0",Rt=zt.split("e");return X=X.replace(/e[\+|\-]{1}0/,""),Mt=tt._.numberToFormat(Number(Rt[0]),X,Zt),Mt+"e"+Rt[1]},unformat:function(K){var X=tt._.includes(K,"e+")?K.split("e+"):K.split("e-"),Zt=Number(X[0]),Mt=Number(X[1]);Mt=tt._.includes(K,"e-")?Mt*=-1:Mt;function zt(Rt,Gt,ve,Me){var Ue=tt._.correctionFactor(Rt,Gt),Ke=Rt*Ue*(Gt*Ue)/(Ue*Ue);return Ke}return tt._.reduce([Zt,Math.pow(10,Mt)],zt,1)}})}(),function(){tt.register("format","ordinal",{regexps:{format:/(o)/},format:function(K,X,Zt){var Mt=tt.locales[tt.options.currentLocale],zt,Rt=tt._.includes(X," o")?" ":"";return X=X.replace(/\s?o/,""),Rt+=Mt.ordinal(K),zt=tt._.numberToFormat(K,X,Zt),zt+Rt}})}(),function(){tt.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(K,X,Zt){var Mt=tt._.includes(X," %")?" ":"",zt;return tt.options.scalePercentBy100&&(K=K*100),X=X.replace(/\s?\%/,""),zt=tt._.numberToFormat(K,X,Zt),tt._.includes(zt,")")?(zt=zt.split(""),zt.splice(-1,0,Mt+"%"),zt=zt.join("")):zt=zt+Mt+"%",zt},unformat:function(K){var X=tt._.stringToNumber(K);return tt.options.scalePercentBy100?X*.01:X}})}(),function(){tt.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(K,X,Zt){var Mt=Math.floor(K/60/60),zt=Math.floor((K-Mt*60*60)/60),Rt=Math.round(K-Mt*60*60-zt*60);return Mt+":"+(zt<10?"0"+zt:zt)+":"+(Rt<10?"0"+Rt:Rt)},unformat:function(K){var X=K.split(":"),Zt=0;return X.length===3?(Zt=Zt+Number(X[0])*60*60,Zt=Zt+Number(X[1])*60,Zt=Zt+Number(X[2])):X.length===2&&(Zt=Zt+Number(X[0])*60,Zt=Zt+Number(X[1])),Number(Zt)}})}(),tt})},3614:function($t,Qt,L){"use strict";$t.exports=Z;var Y=L(80645);function Z(it){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(it)?it:new Uint8Array(it||0),this.pos=0,this.type=0,this.length=this.buf.length}Z.Varint=0,Z.Fixed64=1,Z.Bytes=2,Z.Fixed32=5;var tt=65536*65536,yt=1/tt,G=12,Ot=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");Z.prototype={destroy:function(){this.buf=null},readFields:function(it,Pt,q){for(q=q||this.length;this.pos<q;){var Nt=this.readVarint(),It=Nt>>3,U=this.pos;this.type=Nt&7,it(It,Pt,this),this.pos===U&&this.skip(Nt)}return Pt},readMessage:function(it,Pt){return this.readFields(it,Pt,this.readVarint()+this.pos)},readFixed32:function(){var it=Ut(this.buf,this.pos);return this.pos+=4,it},readSFixed32:function(){var it=ie(this.buf,this.pos);return this.pos+=4,it},readFixed64:function(){var it=Ut(this.buf,this.pos)+Ut(this.buf,this.pos+4)*tt;return this.pos+=8,it},readSFixed64:function(){var it=Ut(this.buf,this.pos)+ie(this.buf,this.pos+4)*tt;return this.pos+=8,it},readFloat:function(){var it=Y.read(this.buf,this.pos,!0,23,4);return this.pos+=4,it},readDouble:function(){var it=Y.read(this.buf,this.pos,!0,52,8);return this.pos+=8,it},readVarint:function(it){var Pt=this.buf,q,Nt;return Nt=Pt[this.pos++],q=Nt&127,Nt<128||(Nt=Pt[this.pos++],q|=(Nt&127)<<7,Nt<128)||(Nt=Pt[this.pos++],q|=(Nt&127)<<14,Nt<128)||(Nt=Pt[this.pos++],q|=(Nt&127)<<21,Nt<128)?q:(Nt=Pt[this.pos],q|=(Nt&15)<<28,bt(q,it,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var it=this.readVarint();return it%2===1?(it+1)/-2:it/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var it=this.readVarint()+this.pos,Pt=this.pos;return this.pos=it,it-Pt>=G&&Ot?At(this.buf,Pt,it):qt(this.buf,Pt,it)},readBytes:function(){var it=this.readVarint()+this.pos,Pt=this.buf.subarray(this.pos,it);return this.pos=it,Pt},readPackedVarint:function(it,Pt){if(this.type!==Z.Bytes)return it.push(this.readVarint(Pt));var q=Et(this);for(it=it||[];this.pos<q;)it.push(this.readVarint(Pt));return it},readPackedSVarint:function(it){if(this.type!==Z.Bytes)return it.push(this.readSVarint());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readSVarint());return it},readPackedBoolean:function(it){if(this.type!==Z.Bytes)return it.push(this.readBoolean());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readBoolean());return it},readPackedFloat:function(it){if(this.type!==Z.Bytes)return it.push(this.readFloat());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readFloat());return it},readPackedDouble:function(it){if(this.type!==Z.Bytes)return it.push(this.readDouble());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readDouble());return it},readPackedFixed32:function(it){if(this.type!==Z.Bytes)return it.push(this.readFixed32());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readFixed32());return it},readPackedSFixed32:function(it){if(this.type!==Z.Bytes)return it.push(this.readSFixed32());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readSFixed32());return it},readPackedFixed64:function(it){if(this.type!==Z.Bytes)return it.push(this.readFixed64());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readFixed64());return it},readPackedSFixed64:function(it){if(this.type!==Z.Bytes)return it.push(this.readSFixed64());var Pt=Et(this);for(it=it||[];this.pos<Pt;)it.push(this.readSFixed64());return it},skip:function(it){var Pt=it&7;if(Pt===Z.Varint)for(;this.buf[this.pos++]>127;);else if(Pt===Z.Bytes)this.pos=this.readVarint()+this.pos;else if(Pt===Z.Fixed32)this.pos+=4;else if(Pt===Z.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Pt)},writeTag:function(it,Pt){this.writeVarint(it<<3|Pt)},realloc:function(it){for(var Pt=this.length||16;Pt<this.pos+it;)Pt*=2;if(Pt!==this.length){var q=new Uint8Array(Pt);q.set(this.buf),this.buf=q,this.length=Pt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(it){this.realloc(4),nt(this.buf,it,this.pos),this.pos+=4},writeSFixed32:function(it){this.realloc(4),nt(this.buf,it,this.pos),this.pos+=4},writeFixed64:function(it){this.realloc(8),nt(this.buf,it&-1,this.pos),nt(this.buf,Math.floor(it*yt),this.pos+4),this.pos+=8},writeSFixed64:function(it){this.realloc(8),nt(this.buf,it&-1,this.pos),nt(this.buf,Math.floor(it*yt),this.pos+4),this.pos+=8},writeVarint:function(it){if(it=+it||0,it>268435455||it<0){Vt(it,this);return}this.realloc(4),this.buf[this.pos++]=it&127|(it>127?128:0),!(it<=127)&&(this.buf[this.pos++]=(it>>>=7)&127|(it>127?128:0),!(it<=127)&&(this.buf[this.pos++]=(it>>>=7)&127|(it>127?128:0),!(it<=127)&&(this.buf[this.pos++]=it>>>7&127)))},writeSVarint:function(it){this.writeVarint(it<0?-it*2-1:it*2)},writeBoolean:function(it){this.writeVarint(!!it)},writeString:function(it){it=String(it),this.realloc(it.length*4),this.pos++;var Pt=this.pos;this.pos=Pe(this.buf,it,this.pos);var q=this.pos-Pt;q>=128&&Zt(Pt,q,this),this.pos=Pt-1,this.writeVarint(q),this.pos+=q},writeFloat:function(it){this.realloc(4),Y.write(this.buf,it,this.pos,!0,23,4),this.pos+=4},writeDouble:function(it){this.realloc(8),Y.write(this.buf,it,this.pos,!0,52,8),this.pos+=8},writeBytes:function(it){var Pt=it.length;this.writeVarint(Pt),this.realloc(Pt);for(var q=0;q<Pt;q++)this.buf[this.pos++]=it[q]},writeRawMessage:function(it,Pt){this.pos++;var q=this.pos;it(Pt,this);var Nt=this.pos-q;Nt>=128&&Zt(q,Nt,this),this.pos=q-1,this.writeVarint(Nt),this.pos+=Nt},writeMessage:function(it,Pt,q){this.writeTag(it,Z.Bytes),this.writeRawMessage(Pt,q)},writePackedVarint:function(it,Pt){Pt.length&&this.writeMessage(it,Mt,Pt)},writePackedSVarint:function(it,Pt){Pt.length&&this.writeMessage(it,zt,Pt)},writePackedBoolean:function(it,Pt){Pt.length&&this.writeMessage(it,ve,Pt)},writePackedFloat:function(it,Pt){Pt.length&&this.writeMessage(it,Rt,Pt)},writePackedDouble:function(it,Pt){Pt.length&&this.writeMessage(it,Gt,Pt)},writePackedFixed32:function(it,Pt){Pt.length&&this.writeMessage(it,Me,Pt)},writePackedSFixed32:function(it,Pt){Pt.length&&this.writeMessage(it,Ue,Pt)},writePackedFixed64:function(it,Pt){Pt.length&&this.writeMessage(it,Ke,Pt)},writePackedSFixed64:function(it,Pt){Pt.length&&this.writeMessage(it,we,Pt)},writeBytesField:function(it,Pt){this.writeTag(it,Z.Bytes),this.writeBytes(Pt)},writeFixed32Field:function(it,Pt){this.writeTag(it,Z.Fixed32),this.writeFixed32(Pt)},writeSFixed32Field:function(it,Pt){this.writeTag(it,Z.Fixed32),this.writeSFixed32(Pt)},writeFixed64Field:function(it,Pt){this.writeTag(it,Z.Fixed64),this.writeFixed64(Pt)},writeSFixed64Field:function(it,Pt){this.writeTag(it,Z.Fixed64),this.writeSFixed64(Pt)},writeVarintField:function(it,Pt){this.writeTag(it,Z.Varint),this.writeVarint(Pt)},writeSVarintField:function(it,Pt){this.writeTag(it,Z.Varint),this.writeSVarint(Pt)},writeStringField:function(it,Pt){this.writeTag(it,Z.Bytes),this.writeString(Pt)},writeFloatField:function(it,Pt){this.writeTag(it,Z.Fixed32),this.writeFloat(Pt)},writeDoubleField:function(it,Pt){this.writeTag(it,Z.Fixed64),this.writeDouble(Pt)},writeBooleanField:function(it,Pt){this.writeVarintField(it,!!Pt)}};function bt(it,Pt,q){var Nt=q.buf,It,U;if(U=Nt[q.pos++],It=(U&112)>>4,U<128||(U=Nt[q.pos++],It|=(U&127)<<3,U<128)||(U=Nt[q.pos++],It|=(U&127)<<10,U<128)||(U=Nt[q.pos++],It|=(U&127)<<17,U<128)||(U=Nt[q.pos++],It|=(U&127)<<24,U<128)||(U=Nt[q.pos++],It|=(U&1)<<31,U<128))return pt(it,It,Pt);throw new Error("Expected varint not more than 10 bytes")}function Et(it){return it.type===Z.Bytes?it.readVarint()+it.pos:it.pos+1}function pt(it,Pt,q){return q?Pt*4294967296+(it>>>0):(Pt>>>0)*4294967296+(it>>>0)}function Vt(it,Pt){var q,Nt;if(it>=0?(q=it%4294967296|0,Nt=it/4294967296|0):(q=~(-it%4294967296),Nt=~(-it/4294967296),q^4294967295?q=q+1|0:(q=0,Nt=Nt+1|0)),it>=18446744073709552e3||it<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Pt.realloc(10),K(q,Nt,Pt),X(Nt,Pt)}function K(it,Pt,q){q.buf[q.pos++]=it&127|128,it>>>=7,q.buf[q.pos++]=it&127|128,it>>>=7,q.buf[q.pos++]=it&127|128,it>>>=7,q.buf[q.pos++]=it&127|128,it>>>=7,q.buf[q.pos]=it&127}function X(it,Pt){var q=(it&7)<<4;Pt.buf[Pt.pos++]|=q|((it>>>=3)?128:0),it&&(Pt.buf[Pt.pos++]=it&127|((it>>>=7)?128:0),it&&(Pt.buf[Pt.pos++]=it&127|((it>>>=7)?128:0),it&&(Pt.buf[Pt.pos++]=it&127|((it>>>=7)?128:0),it&&(Pt.buf[Pt.pos++]=it&127|((it>>>=7)?128:0),it&&(Pt.buf[Pt.pos++]=it&127)))))}function Zt(it,Pt,q){var Nt=Pt<=16383?1:Pt<=2097151?2:Pt<=268435455?3:Math.floor(Math.log(Pt)/(Math.LN2*7));q.realloc(Nt);for(var It=q.pos-1;It>=it;It--)q.buf[It+Nt]=q.buf[It]}function Mt(it,Pt){for(var q=0;q<it.length;q++)Pt.writeVarint(it[q])}function zt(it,Pt){for(var q=0;q<it.length;q++)Pt.writeSVarint(it[q])}function Rt(it,Pt){for(var q=0;q<it.length;q++)Pt.writeFloat(it[q])}function Gt(it,Pt){for(var q=0;q<it.length;q++)Pt.writeDouble(it[q])}function ve(it,Pt){for(var q=0;q<it.length;q++)Pt.writeBoolean(it[q])}function Me(it,Pt){for(var q=0;q<it.length;q++)Pt.writeFixed32(it[q])}function Ue(it,Pt){for(var q=0;q<it.length;q++)Pt.writeSFixed32(it[q])}function Ke(it,Pt){for(var q=0;q<it.length;q++)Pt.writeFixed64(it[q])}function we(it,Pt){for(var q=0;q<it.length;q++)Pt.writeSFixed64(it[q])}function Ut(it,Pt){return(it[Pt]|it[Pt+1]<<8|it[Pt+2]<<16)+it[Pt+3]*16777216}function nt(it,Pt,q){it[q]=Pt,it[q+1]=Pt>>>8,it[q+2]=Pt>>>16,it[q+3]=Pt>>>24}function ie(it,Pt){return(it[Pt]|it[Pt+1]<<8|it[Pt+2]<<16)+(it[Pt+3]<<24)}function qt(it,Pt,q){for(var Nt="",It=Pt;It<q;){var U=it[It],ht=null,ne=U>239?4:U>223?3:U>191?2:1;if(It+ne>q)break;var xe,_e,Xe;ne===1?U<128&&(ht=U):ne===2?(xe=it[It+1],(xe&192)===128&&(ht=(U&31)<<6|xe&63,ht<=127&&(ht=null))):ne===3?(xe=it[It+1],_e=it[It+2],(xe&192)===128&&(_e&192)===128&&(ht=(U&15)<<12|(xe&63)<<6|_e&63,(ht<=2047||ht>=55296&&ht<=57343)&&(ht=null))):ne===4&&(xe=it[It+1],_e=it[It+2],Xe=it[It+3],(xe&192)===128&&(_e&192)===128&&(Xe&192)===128&&(ht=(U&15)<<18|(xe&63)<<12|(_e&63)<<6|Xe&63,(ht<=65535||ht>=1114112)&&(ht=null))),ht===null?(ht=65533,ne=1):ht>65535&&(ht-=65536,Nt+=String.fromCharCode(ht>>>10&1023|55296),ht=56320|ht&1023),Nt+=String.fromCharCode(ht),It+=ne}return Nt}function At(it,Pt,q){return Ot.decode(it.subarray(Pt,q))}function Pe(it,Pt,q){for(var Nt=0,It,U;Nt<Pt.length;Nt++){if(It=Pt.charCodeAt(Nt),It>55295&&It<57344)if(U)if(It<56320){it[q++]=239,it[q++]=191,it[q++]=189,U=It;continue}else It=U-55296<<10|It-56320|65536,U=null;else{It>56319||Nt+1===Pt.length?(it[q++]=239,it[q++]=191,it[q++]=189):U=It;continue}else U&&(it[q++]=239,it[q++]=191,it[q++]=189,U=null);It<128?it[q++]=It:(It<2048?it[q++]=It>>6|192:(It<65536?it[q++]=It>>12|224:(it[q++]=It>>18|240,it[q++]=It>>12&63|128),it[q++]=It>>6&63|128),it[q++]=It&63|128)}return q}},73807:function($t){"use strict";var Qt=$t.exports;$t.exports.isNumber=function(L){return typeof L=="number"},$t.exports.findMin=function(L){if(L.length===0)return 1/0;for(var Y=L[0],Z=1;Z<L.length;Z++)Y=Math.min(Y,L[Z]);return Y},$t.exports.findMax=function(L){if(L.length===0)return-1/0;for(var Y=L[0],Z=1;Z<L.length;Z++)Y=Math.max(Y,L[Z]);return Y},$t.exports.findMinMulti=function(L){for(var Y=Qt.findMin(L[0]),Z=1;Z<L.length;Z++)Y=Math.min(Y,Qt.findMin(L[Z]));return Y},$t.exports.findMaxMulti=function(L){for(var Y=Qt.findMax(L[0]),Z=1;Z<L.length;Z++)Y=Math.max(Y,Qt.findMax(L[Z]));return Y},$t.exports.inside=function(L,Y,Z){return L<=Z&&Z<=Y}},53843:function($t,Qt,L){"use strict";var Y=50,Z=2,tt=Math.log(2),yt=$t.exports,G=L(73807);function Ot(Et){return 1-Math.abs(Et)}$t.exports.getUnifiedMinMax=function(Et,pt){return yt.getUnifiedMinMaxMulti([Et],pt)},$t.exports.getUnifiedMinMaxMulti=function(Et,pt){pt=pt||{};var Vt=!1,K=!1,X=G.isNumber(pt.width)?pt.width:Z,Zt=G.isNumber(pt.size)?pt.size:Y,Mt=G.isNumber(pt.min)?pt.min:(Vt=!0,G.findMinMulti(Et)),zt=G.isNumber(pt.max)?pt.max:(K=!0,G.findMaxMulti(Et)),Rt=zt-Mt,Gt=Rt/(Zt-1);return Vt&&(Mt=Mt-2*X*Gt),K&&(zt=zt+2*X*Gt),{min:Mt,max:zt}},$t.exports.create=function(Et,pt){if(pt=pt||{},!Et||Et.length===0)return[];var Vt=G.isNumber(pt.size)?pt.size:Y,K=G.isNumber(pt.width)?pt.width:Z,X=yt.getUnifiedMinMax(Et,{size:Vt,width:K,min:pt.min,max:pt.max}),Zt=X.min,Mt=X.max,zt=Mt-Zt,Rt=zt/(Vt-1);if(zt===0)return[{x:Zt,y:1}];for(var Gt=[],ve=0;ve<Vt;ve++)Gt.push({x:Zt+ve*Rt,y:0});var Me=function(At){return Math.floor((At-Zt)/Rt)},Ue=bt(Ot,K),Ke=Ue[K],we=Ue[K-1]-Ue[K-2],Ut=0;Et.forEach(function(At){var Pe=Me(At);if(!(Pe+K<0||Pe-K>=Gt.length)){var it=Math.max(Pe-K,0),Pt=Pe,q=Math.min(Pe+K,Gt.length-1),Nt=it-(Pe-K),It=Pe+K-q,U=Ue[-K-1+Nt]||0,ht=Ue[-K-1+It]||0,ne=Ke/(Ke-U-ht);Nt>0&&(Ut+=ne*(Nt-1)*we);var xe=Math.max(0,Pe-K+1);G.inside(0,Gt.length-1,xe)&&(Gt[xe].y+=ne*1*we),G.inside(0,Gt.length-1,Pt+1)&&(Gt[Pt+1].y-=ne*2*we),G.inside(0,Gt.length-1,q+1)&&(Gt[q+1].y+=ne*1*we)}});var nt=Ut,ie=0,qt=0;return Gt.forEach(function(At){ie+=At.y,nt+=ie,At.y=nt,qt+=nt}),qt>0&&Gt.forEach(function(At){At.y/=qt}),Gt};function bt(Et,pt){for(var Vt={},K=0,X=-pt;X<=pt;X++)K+=Et(X/pt),Vt[X]=K;return Vt}$t.exports.getExpectedValueFromPdf=function(Et){if(!(!Et||Et.length===0)){var pt=0;return Et.forEach(function(Vt){pt+=Vt.x*Vt.y}),pt}},$t.exports.getXWithLeftTailArea=function(Et,pt){if(!(!Et||Et.length===0)){for(var Vt=0,K=0,X=0;X<Et.length&&(K=X,Vt+=Et[X].y,!(Vt>=pt));X++);return Et[K].x}},$t.exports.getPerplexity=function(Et){if(!(!Et||Et.length===0)){var pt=0;return Et.forEach(function(Vt){var K=Math.log(Vt.y);isFinite(K)&&(pt+=Vt.y*K)}),pt=-pt/tt,Math.pow(2,pt)}}},32676:function($t,Qt,L){var Y=L(34155);(function(Z,tt){$t.exports=tt()})(this,function(){"use strict";function Z(st,D){var H={label:0,sent:function(){if(Lt[0]&1)throw Lt[1];return Lt[1]},trys:[],ops:[]},at,St,Lt,ge;return ge={next:de(0),throw:de(1),return:de(2)},typeof Symbol=="function"&&(ge[Symbol.iterator]=function(){return this}),ge;function de(Ne){return function(sn){return ze([Ne,sn])}}function ze(Ne){if(at)throw new TypeError("Generator is already executing.");for(;H;)try{if(at=1,St&&(Lt=Ne[0]&2?St.return:Ne[0]?St.throw||((Lt=St.return)&&Lt.call(St),0):St.next)&&!(Lt=Lt.call(St,Ne[1])).done)return Lt;switch(St=0,Lt&&(Ne=[Ne[0]&2,Lt.value]),Ne[0]){case 0:case 1:Lt=Ne;break;case 4:return H.label++,{value:Ne[1],done:!1};case 5:H.label++,St=Ne[1],Ne=[0];continue;case 7:Ne=H.ops.pop(),H.trys.pop();continue;default:if(Lt=H.trys,!(Lt=Lt.length>0&&Lt[Lt.length-1])&&(Ne[0]===6||Ne[0]===2)){H=0;continue}if(Ne[0]===3&&(!Lt||Ne[1]>Lt[0]&&Ne[1]<Lt[3])){H.label=Ne[1];break}if(Ne[0]===6&&H.label<Lt[1]){H.label=Lt[1],Lt=Ne;break}if(Lt&&H.label<Lt[2]){H.label=Lt[2],H.ops.push(Ne);break}Lt[2]&&H.ops.pop(),H.trys.pop();continue}Ne=D.call(st,H)}catch(sn){Ne=[6,sn],St=0}finally{at=Lt=0}if(Ne[0]&5)throw Ne[1];return{value:Ne[0]?Ne[1]:void 0,done:!0}}}var tt=function(){function st(D,H){this.next=null,this.key=D,this.data=H,this.left=null,this.right=null}return st}();function yt(st,D){return st>D?1:st<D?-1:0}function G(st,D,H){for(var at=new tt(null,null),St=at,Lt=at;;){var ge=H(st,D.key);if(ge<0){if(D.left===null)break;if(H(st,D.left.key)<0){var de=D.left;if(D.left=de.right,de.right=D,D=de,D.left===null)break}Lt.left=D,Lt=D,D=D.left}else if(ge>0){if(D.right===null)break;if(H(st,D.right.key)>0){var de=D.right;if(D.right=de.left,de.left=D,D=de,D.right===null)break}St.right=D,St=D,D=D.right}else break}return St.right=D.left,Lt.left=D.right,D.left=at.right,D.right=at.left,D}function Ot(st,D,H,at){var St=new tt(st,D);if(H===null)return St.left=St.right=null,St;H=G(st,H,at);var Lt=at(st,H.key);return Lt<0?(St.left=H.left,St.right=H,H.left=null):Lt>=0&&(St.right=H.right,St.left=H,H.right=null),St}function bt(st,D,H){var at=null,St=null;if(D){D=G(st,D,H);var Lt=H(D.key,st);Lt===0?(at=D.left,St=D.right):Lt<0?(St=D.right,D.right=null,at=D):(at=D.left,D.left=null,St=D)}return{left:at,right:St}}function Et(st,D,H){return D===null?st:(st===null||(D=G(st.key,D,H),D.left=st),D)}function pt(st,D,H,at,St){if(st){at(""+D+(H?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+St(st)+`
`);var Lt=D+(H?"    ":"\u2502   ");st.left&&pt(st.left,Lt,!1,at,St),st.right&&pt(st.right,Lt,!0,at,St)}}var Vt=function(){function st(D){D===void 0&&(D=yt),this._root=null,this._size=0,this._comparator=D}return st.prototype.insert=function(D,H){return this._size++,this._root=Ot(D,H,this._root,this._comparator)},st.prototype.add=function(D,H){var at=new tt(D,H);this._root===null&&(at.left=at.right=null,this._size++,this._root=at);var St=this._comparator,Lt=G(D,this._root,St),ge=St(D,Lt.key);return ge===0?this._root=Lt:(ge<0?(at.left=Lt.left,at.right=Lt,Lt.left=null):ge>0&&(at.right=Lt.right,at.left=Lt,Lt.right=null),this._size++,this._root=at),this._root},st.prototype.remove=function(D){this._root=this._remove(D,this._root,this._comparator)},st.prototype._remove=function(D,H,at){var St;if(H===null)return null;H=G(D,H,at);var Lt=at(D,H.key);return Lt===0?(H.left===null?St=H.right:(St=G(D,H.left,at),St.right=H.right),this._size--,St):H},st.prototype.pop=function(){var D=this._root;if(D){for(;D.left;)D=D.left;return this._root=G(D.key,this._root,this._comparator),this._root=this._remove(D.key,this._root,this._comparator),{key:D.key,data:D.data}}return null},st.prototype.findStatic=function(D){for(var H=this._root,at=this._comparator;H;){var St=at(D,H.key);if(St===0)return H;St<0?H=H.left:H=H.right}return null},st.prototype.find=function(D){return this._root&&(this._root=G(D,this._root,this._comparator),this._comparator(D,this._root.key)!==0)?null:this._root},st.prototype.contains=function(D){for(var H=this._root,at=this._comparator;H;){var St=at(D,H.key);if(St===0)return!0;St<0?H=H.left:H=H.right}return!1},st.prototype.forEach=function(D,H){for(var at=this._root,St=[],Lt=!1;!Lt;)at!==null?(St.push(at),at=at.left):St.length!==0?(at=St.pop(),D.call(H,at),at=at.right):Lt=!0;return this},st.prototype.range=function(D,H,at,St){for(var Lt=[],ge=this._comparator,de=this._root,ze;Lt.length!==0||de;)if(de)Lt.push(de),de=de.left;else{if(de=Lt.pop(),ze=ge(de.key,H),ze>0)break;if(ge(de.key,D)>=0&&at.call(St,de))return this;de=de.right}return this},st.prototype.keys=function(){var D=[];return this.forEach(function(H){var at=H.key;return D.push(at)}),D},st.prototype.values=function(){var D=[];return this.forEach(function(H){var at=H.data;return D.push(at)}),D},st.prototype.min=function(){return this._root?this.minNode(this._root).key:null},st.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},st.prototype.minNode=function(D){if(D===void 0&&(D=this._root),D)for(;D.left;)D=D.left;return D},st.prototype.maxNode=function(D){if(D===void 0&&(D=this._root),D)for(;D.right;)D=D.right;return D},st.prototype.at=function(D){for(var H=this._root,at=!1,St=0,Lt=[];!at;)if(H)Lt.push(H),H=H.left;else if(Lt.length>0){if(H=Lt.pop(),St===D)return H;St++,H=H.right}else at=!0;return null},st.prototype.next=function(D){var H=this._root,at=null;if(D.right){for(at=D.right;at.left;)at=at.left;return at}for(var St=this._comparator;H;){var Lt=St(D.key,H.key);if(Lt===0)break;Lt<0?(at=H,H=H.left):H=H.right}return at},st.prototype.prev=function(D){var H=this._root,at=null;if(D.left!==null){for(at=D.left;at.right;)at=at.right;return at}for(var St=this._comparator;H;){var Lt=St(D.key,H.key);if(Lt===0)break;Lt<0?H=H.left:(at=H,H=H.right)}return at},st.prototype.clear=function(){return this._root=null,this._size=0,this},st.prototype.toList=function(){return Zt(this._root)},st.prototype.load=function(D,H,at){H===void 0&&(H=[]),at===void 0&&(at=!1);var St=D.length,Lt=this._comparator;if(at&&Rt(D,H,0,St-1,Lt),this._root===null)this._root=K(D,H,0,St),this._size=St;else{var ge=zt(this.toList(),X(D,H),Lt);St=this._size+St,this._root=Mt({head:ge},0,St)}return this},st.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(st.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(st.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),st.prototype.toString=function(D){D===void 0&&(D=function(at){return String(at.key)});var H=[];return pt(this._root,"",!0,function(at){return H.push(at)},D),H.join("")},st.prototype.update=function(D,H,at){var St=this._comparator,Lt=bt(D,this._root,St),ge=Lt.left,de=Lt.right;St(D,H)<0?de=Ot(H,at,de,St):ge=Ot(H,at,ge,St),this._root=Et(ge,de,St)},st.prototype.split=function(D){return bt(D,this._root,this._comparator)},st.prototype[Symbol.iterator]=function(){var D,H,at;return Z(this,function(St){switch(St.label){case 0:D=this._root,H=[],at=!1,St.label=1;case 1:return at?[3,6]:D===null?[3,2]:(H.push(D),D=D.left,[3,5]);case 2:return H.length===0?[3,4]:(D=H.pop(),[4,D]);case 3:return St.sent(),D=D.right,[3,5];case 4:at=!0,St.label=5;case 5:return[3,1];case 6:return[2]}})},st}();function K(st,D,H,at){var St=at-H;if(St>0){var Lt=H+Math.floor(St/2),ge=st[Lt],de=D[Lt],ze=new tt(ge,de);return ze.left=K(st,D,H,Lt),ze.right=K(st,D,Lt+1,at),ze}return null}function X(st,D){for(var H=new tt(null,null),at=H,St=0;St<st.length;St++)at=at.next=new tt(st[St],D[St]);return at.next=null,H.next}function Zt(st){for(var D=st,H=[],at=!1,St=new tt(null,null),Lt=St;!at;)D?(H.push(D),D=D.left):H.length>0?(D=Lt=Lt.next=H.pop(),D=D.right):at=!0;return Lt.next=null,St.next}function Mt(st,D,H){var at=H-D;if(at>0){var St=D+Math.floor(at/2),Lt=Mt(st,D,St),ge=st.head;return ge.left=Lt,st.head=st.head.next,ge.right=Mt(st,St+1,H),ge}return null}function zt(st,D,H){for(var at=new tt(null,null),St=at,Lt=st,ge=D;Lt!==null&&ge!==null;)H(Lt.key,ge.key)<0?(St.next=Lt,Lt=Lt.next):(St.next=ge,ge=ge.next),St=St.next;return Lt!==null?St.next=Lt:ge!==null&&(St.next=ge),at.next}function Rt(st,D,H,at,St){if(!(H>=at)){for(var Lt=st[H+at>>1],ge=H-1,de=at+1;;){do ge++;while(St(st[ge],Lt)<0);do de--;while(St(st[de],Lt)>0);if(ge>=de)break;var ze=st[ge];st[ge]=st[de],st[de]=ze,ze=D[ge],D[ge]=D[de],D[de]=ze}Rt(st,D,H,de,St),Rt(st,D,de+1,at,St)}}const Gt=(st,D)=>st.ll.x<=D.x&&D.x<=st.ur.x&&st.ll.y<=D.y&&D.y<=st.ur.y,ve=(st,D)=>{if(D.ur.x<st.ll.x||st.ur.x<D.ll.x||D.ur.y<st.ll.y||st.ur.y<D.ll.y)return null;const H=st.ll.x<D.ll.x?D.ll.x:st.ll.x,at=st.ur.x<D.ur.x?st.ur.x:D.ur.x,St=st.ll.y<D.ll.y?D.ll.y:st.ll.y,Lt=st.ur.y<D.ur.y?st.ur.y:D.ur.y;return{ll:{x:H,y:St},ur:{x:at,y:Lt}}};let Me=Number.EPSILON;Me===void 0&&(Me=Math.pow(2,-52));const Ue=Me*Me,Ke=(st,D)=>{if(-Me<st&&st<Me&&-Me<D&&D<Me)return 0;const H=st-D;return H*H<Ue*st*D?0:st<D?-1:1};class we{constructor(){this.reset()}reset(){this.xRounder=new Ut,this.yRounder=new Ut}round(D,H){return{x:this.xRounder.round(D),y:this.yRounder.round(H)}}}class Ut{constructor(){this.tree=new Vt,this.round(0)}round(D){const H=this.tree.add(D),at=this.tree.prev(H);if(at!==null&&Ke(H.key,at.key)===0)return this.tree.remove(D),at.key;const St=this.tree.next(H);return St!==null&&Ke(H.key,St.key)===0?(this.tree.remove(D),St.key):D}}const nt=new we,ie=11102230246251565e-32,qt=134217729,At=(3+8*ie)*ie;function Pe(st,D,H,at,St){let Lt,ge,de,ze,Ne=D[0],sn=at[0],Ce=0,en=0;sn>Ne==sn>-Ne?(Lt=Ne,Ne=D[++Ce]):(Lt=sn,sn=at[++en]);let dn=0;if(Ce<st&&en<H)for(sn>Ne==sn>-Ne?(ge=Ne+Lt,de=Lt-(ge-Ne),Ne=D[++Ce]):(ge=sn+Lt,de=Lt-(ge-sn),sn=at[++en]),Lt=ge,de!==0&&(St[dn++]=de);Ce<st&&en<H;)sn>Ne==sn>-Ne?(ge=Lt+Ne,ze=ge-Lt,de=Lt-(ge-ze)+(Ne-ze),Ne=D[++Ce]):(ge=Lt+sn,ze=ge-Lt,de=Lt-(ge-ze)+(sn-ze),sn=at[++en]),Lt=ge,de!==0&&(St[dn++]=de);for(;Ce<st;)ge=Lt+Ne,ze=ge-Lt,de=Lt-(ge-ze)+(Ne-ze),Ne=D[++Ce],Lt=ge,de!==0&&(St[dn++]=de);for(;en<H;)ge=Lt+sn,ze=ge-Lt,de=Lt-(ge-ze)+(sn-ze),sn=at[++en],Lt=ge,de!==0&&(St[dn++]=de);return(Lt!==0||dn===0)&&(St[dn++]=Lt),dn}function it(st,D){let H=D[0];for(let at=1;at<st;at++)H+=D[at];return H}function Pt(st){return new Float64Array(st)}const q=(3+16*ie)*ie,Nt=(2+12*ie)*ie,It=(9+64*ie)*ie*ie,U=Pt(4),ht=Pt(8),ne=Pt(12),xe=Pt(16),_e=Pt(4);function Xe(st,D,H,at,St,Lt,ge){let de,ze,Ne,sn,Ce,en,dn,En,mn,jn,Wn,tr,pr,Mr,Qr,Nr,Lr,Fr;const vi=st-St,Li=H-St,Ii=D-Lt,mi=at-Lt;Mr=vi*mi,en=qt*vi,dn=en-(en-vi),En=vi-dn,en=qt*mi,mn=en-(en-mi),jn=mi-mn,Qr=En*jn-(Mr-dn*mn-En*mn-dn*jn),Nr=Ii*Li,en=qt*Ii,dn=en-(en-Ii),En=Ii-dn,en=qt*Li,mn=en-(en-Li),jn=Li-mn,Lr=En*jn-(Nr-dn*mn-En*mn-dn*jn),Wn=Qr-Lr,Ce=Qr-Wn,U[0]=Qr-(Wn+Ce)+(Ce-Lr),tr=Mr+Wn,Ce=tr-Mr,pr=Mr-(tr-Ce)+(Wn-Ce),Wn=pr-Nr,Ce=pr-Wn,U[1]=pr-(Wn+Ce)+(Ce-Nr),Fr=tr+Wn,Ce=Fr-tr,U[2]=tr-(Fr-Ce)+(Wn-Ce),U[3]=Fr;let Hi=it(4,U),io=Nt*ge;if(Hi>=io||-Hi>=io||(Ce=st-vi,de=st-(vi+Ce)+(Ce-St),Ce=H-Li,Ne=H-(Li+Ce)+(Ce-St),Ce=D-Ii,ze=D-(Ii+Ce)+(Ce-Lt),Ce=at-mi,sn=at-(mi+Ce)+(Ce-Lt),de===0&&ze===0&&Ne===0&&sn===0)||(io=It*ge+At*Math.abs(Hi),Hi+=vi*sn+mi*de-(Ii*Ne+Li*ze),Hi>=io||-Hi>=io))return Hi;Mr=de*mi,en=qt*de,dn=en-(en-de),En=de-dn,en=qt*mi,mn=en-(en-mi),jn=mi-mn,Qr=En*jn-(Mr-dn*mn-En*mn-dn*jn),Nr=ze*Li,en=qt*ze,dn=en-(en-ze),En=ze-dn,en=qt*Li,mn=en-(en-Li),jn=Li-mn,Lr=En*jn-(Nr-dn*mn-En*mn-dn*jn),Wn=Qr-Lr,Ce=Qr-Wn,_e[0]=Qr-(Wn+Ce)+(Ce-Lr),tr=Mr+Wn,Ce=tr-Mr,pr=Mr-(tr-Ce)+(Wn-Ce),Wn=pr-Nr,Ce=pr-Wn,_e[1]=pr-(Wn+Ce)+(Ce-Nr),Fr=tr+Wn,Ce=Fr-tr,_e[2]=tr-(Fr-Ce)+(Wn-Ce),_e[3]=Fr;const Ko=Pe(4,U,4,_e,ht);Mr=vi*sn,en=qt*vi,dn=en-(en-vi),En=vi-dn,en=qt*sn,mn=en-(en-sn),jn=sn-mn,Qr=En*jn-(Mr-dn*mn-En*mn-dn*jn),Nr=Ii*Ne,en=qt*Ii,dn=en-(en-Ii),En=Ii-dn,en=qt*Ne,mn=en-(en-Ne),jn=Ne-mn,Lr=En*jn-(Nr-dn*mn-En*mn-dn*jn),Wn=Qr-Lr,Ce=Qr-Wn,_e[0]=Qr-(Wn+Ce)+(Ce-Lr),tr=Mr+Wn,Ce=tr-Mr,pr=Mr-(tr-Ce)+(Wn-Ce),Wn=pr-Nr,Ce=pr-Wn,_e[1]=pr-(Wn+Ce)+(Ce-Nr),Fr=tr+Wn,Ce=Fr-tr,_e[2]=tr-(Fr-Ce)+(Wn-Ce),_e[3]=Fr;const So=Pe(Ko,ht,4,_e,ne);Mr=de*sn,en=qt*de,dn=en-(en-de),En=de-dn,en=qt*sn,mn=en-(en-sn),jn=sn-mn,Qr=En*jn-(Mr-dn*mn-En*mn-dn*jn),Nr=ze*Ne,en=qt*ze,dn=en-(en-ze),En=ze-dn,en=qt*Ne,mn=en-(en-Ne),jn=Ne-mn,Lr=En*jn-(Nr-dn*mn-En*mn-dn*jn),Wn=Qr-Lr,Ce=Qr-Wn,_e[0]=Qr-(Wn+Ce)+(Ce-Lr),tr=Mr+Wn,Ce=tr-Mr,pr=Mr-(tr-Ce)+(Wn-Ce),Wn=pr-Nr,Ce=pr-Wn,_e[1]=pr-(Wn+Ce)+(Ce-Nr),Fr=tr+Wn,Ce=Fr-tr,_e[2]=tr-(Fr-Ce)+(Wn-Ce),_e[3]=Fr;const fa=Pe(So,ne,4,_e,xe);return xe[fa-1]}function Re(st,D,H,at,St,Lt){const ge=(D-Lt)*(H-St),de=(st-St)*(at-Lt),ze=ge-de,Ne=Math.abs(ge+de);return Math.abs(ze)>=q*Ne?ze:-Xe(st,D,H,at,St,Lt,Ne)}const un=(st,D)=>st.x*D.y-st.y*D.x,cn=(st,D)=>st.x*D.x+st.y*D.y,Jt=(st,D,H)=>{const at=Re(st.x,st.y,D.x,D.y,H.x,H.y);return at>0?-1:at<0?1:0},ct=st=>Math.sqrt(cn(st,st)),Ct=(st,D,H)=>{const at={x:D.x-st.x,y:D.y-st.y},St={x:H.x-st.x,y:H.y-st.y};return un(St,at)/ct(St)/ct(at)},me=(st,D,H)=>{const at={x:D.x-st.x,y:D.y-st.y},St={x:H.x-st.x,y:H.y-st.y};return cn(St,at)/ct(St)/ct(at)},he=(st,D,H)=>D.y===0?null:{x:st.x+D.x/D.y*(H-st.y),y:H},Tt=(st,D,H)=>D.x===0?null:{x:H,y:st.y+D.y/D.x*(H-st.x)},re=(st,D,H,at)=>{if(D.x===0)return Tt(H,at,st.x);if(at.x===0)return Tt(st,D,H.x);if(D.y===0)return he(H,at,st.y);if(at.y===0)return he(st,D,H.y);const St=un(D,at);if(St==0)return null;const Lt={x:H.x-st.x,y:H.y-st.y},ge=un(Lt,D)/St,de=un(Lt,at)/St,ze=st.x+de*D.x,Ne=H.x+ge*at.x,sn=st.y+de*D.y,Ce=H.y+ge*at.y,en=(ze+Ne)/2,dn=(sn+Ce)/2;return{x:en,y:dn}};class Yt{static compare(D,H){const at=Yt.comparePoints(D.point,H.point);return at!==0?at:(D.point!==H.point&&D.link(H),D.isLeft!==H.isLeft?D.isLeft?1:-1:kt.compare(D.segment,H.segment))}static comparePoints(D,H){return D.x<H.x?-1:D.x>H.x?1:D.y<H.y?-1:D.y>H.y?1:0}constructor(D,H){D.events===void 0?D.events=[this]:D.events.push(this),this.point=D,this.isLeft=H}link(D){if(D.point===this.point)throw new Error("Tried to link already linked events");const H=D.point.events;for(let at=0,St=H.length;at<St;at++){const Lt=H[at];this.point.events.push(Lt),Lt.point=this.point}this.checkForConsuming()}checkForConsuming(){const D=this.point.events.length;for(let H=0;H<D;H++){const at=this.point.events[H];if(at.segment.consumedBy===void 0)for(let St=H+1;St<D;St++){const Lt=this.point.events[St];Lt.consumedBy===void 0&&at.otherSE.point.events===Lt.otherSE.point.events&&at.segment.consume(Lt.segment)}}}getAvailableLinkedEvents(){const D=[];for(let H=0,at=this.point.events.length;H<at;H++){const St=this.point.events[H];St!==this&&!St.segment.ringOut&&St.segment.isInResult()&&D.push(St)}return D}getLeftmostComparator(D){const H=new Map,at=St=>{const Lt=St.otherSE;H.set(St,{sine:Ct(this.point,D.point,Lt.point),cosine:me(this.point,D.point,Lt.point)})};return(St,Lt)=>{H.has(St)||at(St),H.has(Lt)||at(Lt);const{sine:ge,cosine:de}=H.get(St),{sine:ze,cosine:Ne}=H.get(Lt);return ge>=0&&ze>=0?de<Ne?1:de>Ne?-1:0:ge<0&&ze<0?de<Ne?-1:de>Ne?1:0:ze<ge?-1:ze>ge?1:0}}}let N=0;class kt{static compare(D,H){const at=D.leftSE.point.x,St=H.leftSE.point.x,Lt=D.rightSE.point.x,ge=H.rightSE.point.x;if(ge<at)return 1;if(Lt<St)return-1;const de=D.leftSE.point.y,ze=H.leftSE.point.y,Ne=D.rightSE.point.y,sn=H.rightSE.point.y;if(at<St){if(ze<de&&ze<Ne)return 1;if(ze>de&&ze>Ne)return-1;const Ce=D.comparePoint(H.leftSE.point);if(Ce<0)return 1;if(Ce>0)return-1;const en=H.comparePoint(D.rightSE.point);return en!==0?en:-1}if(at>St){if(de<ze&&de<sn)return-1;if(de>ze&&de>sn)return 1;const Ce=H.comparePoint(D.leftSE.point);if(Ce!==0)return Ce;const en=D.comparePoint(H.rightSE.point);return en<0?1:en>0?-1:1}if(de<ze)return-1;if(de>ze)return 1;if(Lt<ge){const Ce=H.comparePoint(D.rightSE.point);if(Ce!==0)return Ce}if(Lt>ge){const Ce=D.comparePoint(H.rightSE.point);if(Ce<0)return 1;if(Ce>0)return-1}if(Lt!==ge){const Ce=Ne-de,en=Lt-at,dn=sn-ze,En=ge-St;if(Ce>en&&dn<En)return 1;if(Ce<en&&dn>En)return-1}return Lt>ge?1:Lt<ge||Ne<sn?-1:Ne>sn?1:D.id<H.id?-1:D.id>H.id?1:0}constructor(D,H,at,St){this.id=++N,this.leftSE=D,D.segment=this,D.otherSE=H,this.rightSE=H,H.segment=this,H.otherSE=D,this.rings=at,this.windings=St}static fromRing(D,H,at){let St,Lt,ge;const de=Yt.comparePoints(D,H);if(de<0)St=D,Lt=H,ge=1;else if(de>0)St=H,Lt=D,ge=-1;else throw new Error(`Tried to create degenerate segment at [${D.x}, ${D.y}]`);const ze=new Yt(St,!0),Ne=new Yt(Lt,!1);return new kt(ze,Ne,[at],[ge])}replaceRightSE(D){this.rightSE=D,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const D=this.leftSE.point.y,H=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:D<H?D:H},ur:{x:this.rightSE.point.x,y:D>H?D:H}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(D){return D.x===this.leftSE.point.x&&D.y===this.leftSE.point.y||D.x===this.rightSE.point.x&&D.y===this.rightSE.point.y}comparePoint(D){if(this.isAnEndpoint(D))return 0;const H=this.leftSE.point,at=this.rightSE.point,St=this.vector();if(H.x===at.x)return D.x===H.x?0:D.x<H.x?1:-1;const Lt=(D.y-H.y)/St.y,ge=H.x+Lt*St.x;if(D.x===ge)return 0;const de=(D.x-H.x)/St.x,ze=H.y+de*St.y;return D.y===ze?0:D.y<ze?-1:1}getIntersection(D){const H=this.bbox(),at=D.bbox(),St=ve(H,at);if(St===null)return null;const Lt=this.leftSE.point,ge=this.rightSE.point,de=D.leftSE.point,ze=D.rightSE.point,Ne=Gt(H,de)&&this.comparePoint(de)===0,sn=Gt(at,Lt)&&D.comparePoint(Lt)===0,Ce=Gt(H,ze)&&this.comparePoint(ze)===0,en=Gt(at,ge)&&D.comparePoint(ge)===0;if(sn&&Ne)return en&&!Ce?ge:!en&&Ce?ze:null;if(sn)return Ce&&Lt.x===ze.x&&Lt.y===ze.y?null:Lt;if(Ne)return en&&ge.x===de.x&&ge.y===de.y?null:de;if(en&&Ce)return null;if(en)return ge;if(Ce)return ze;const dn=re(Lt,this.vector(),de,D.vector());return dn===null||!Gt(St,dn)?null:nt.round(dn.x,dn.y)}split(D){const H=[],at=D.events!==void 0,St=new Yt(D,!0),Lt=new Yt(D,!1),ge=this.rightSE;this.replaceRightSE(Lt),H.push(Lt),H.push(St);const de=new kt(St,ge,this.rings.slice(),this.windings.slice());return Yt.comparePoints(de.leftSE.point,de.rightSE.point)>0&&de.swapEvents(),Yt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),at&&(St.checkForConsuming(),Lt.checkForConsuming()),H}swapEvents(){const D=this.rightSE;this.rightSE=this.leftSE,this.leftSE=D,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let H=0,at=this.windings.length;H<at;H++)this.windings[H]*=-1}consume(D){let H=this,at=D;for(;H.consumedBy;)H=H.consumedBy;for(;at.consumedBy;)at=at.consumedBy;const St=kt.compare(H,at);if(St!==0){if(St>0){const Lt=H;H=at,at=Lt}if(H.prev===at){const Lt=H;H=at,at=Lt}for(let Lt=0,ge=at.rings.length;Lt<ge;Lt++){const de=at.rings[Lt],ze=at.windings[Lt],Ne=H.rings.indexOf(de);Ne===-1?(H.rings.push(de),H.windings.push(ze)):H.windings[Ne]+=ze}at.rings=null,at.windings=null,at.consumedBy=H,at.leftSE.consumedBy=H.leftSE,at.rightSE.consumedBy=H.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const D=this.prev.consumedBy||this.prev;this._beforeState=D.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const D=this.beforeState();this._afterState={rings:D.rings.slice(0),windings:D.windings.slice(0),multiPolys:[]};const H=this._afterState.rings,at=this._afterState.windings,St=this._afterState.multiPolys;for(let de=0,ze=this.rings.length;de<ze;de++){const Ne=this.rings[de],sn=this.windings[de],Ce=H.indexOf(Ne);Ce===-1?(H.push(Ne),at.push(sn)):at[Ce]+=sn}const Lt=[],ge=[];for(let de=0,ze=H.length;de<ze;de++){if(at[de]===0)continue;const Ne=H[de],sn=Ne.poly;if(ge.indexOf(sn)===-1)if(Ne.isExterior)Lt.push(sn);else{ge.indexOf(sn)===-1&&ge.push(sn);const Ce=Lt.indexOf(Ne.poly);Ce!==-1&&Lt.splice(Ce,1)}}for(let de=0,ze=Lt.length;de<ze;de++){const Ne=Lt[de].multiPoly;St.indexOf(Ne)===-1&&St.push(Ne)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const D=this.beforeState().multiPolys,H=this.afterState().multiPolys;switch(Ge.type){case"union":{const at=D.length===0,St=H.length===0;this._isInResult=at!==St;break}case"intersection":{let at,St;D.length<H.length?(at=D.length,St=H.length):(at=H.length,St=D.length),this._isInResult=St===Ge.numMultiPolys&&at<St;break}case"xor":{const at=Math.abs(D.length-H.length);this._isInResult=at%2===1;break}case"difference":{const at=St=>St.length===1&&St[0].isSubject;this._isInResult=at(D)!==at(H);break}default:throw new Error(`Unrecognized operation type found ${Ge.type}`)}return this._isInResult}}class oe{constructor(D,H,at){if(!Array.isArray(D)||D.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=H,this.isExterior=at,this.segments=[],typeof D[0][0]!="number"||typeof D[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const St=nt.round(D[0][0],D[0][1]);this.bbox={ll:{x:St.x,y:St.y},ur:{x:St.x,y:St.y}};let Lt=St;for(let ge=1,de=D.length;ge<de;ge++){if(typeof D[ge][0]!="number"||typeof D[ge][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let ze=nt.round(D[ge][0],D[ge][1]);ze.x===Lt.x&&ze.y===Lt.y||(this.segments.push(kt.fromRing(Lt,ze,this)),ze.x<this.bbox.ll.x&&(this.bbox.ll.x=ze.x),ze.y<this.bbox.ll.y&&(this.bbox.ll.y=ze.y),ze.x>this.bbox.ur.x&&(this.bbox.ur.x=ze.x),ze.y>this.bbox.ur.y&&(this.bbox.ur.y=ze.y),Lt=ze)}(St.x!==Lt.x||St.y!==Lt.y)&&this.segments.push(kt.fromRing(Lt,St,this))}getSweepEvents(){const D=[];for(let H=0,at=this.segments.length;H<at;H++){const St=this.segments[H];D.push(St.leftSE),D.push(St.rightSE)}return D}}class C{constructor(D,H){if(!Array.isArray(D))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new oe(D[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let at=1,St=D.length;at<St;at++){const Lt=new oe(D[at],this,!1);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.interiorRings.push(Lt)}this.multiPoly=H}getSweepEvents(){const D=this.exteriorRing.getSweepEvents();for(let H=0,at=this.interiorRings.length;H<at;H++){const St=this.interiorRings[H].getSweepEvents();for(let Lt=0,ge=St.length;Lt<ge;Lt++)D.push(St[Lt])}return D}}class z{constructor(D,H){if(!Array.isArray(D))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof D[0][0][0]=="number"&&(D=[D])}catch(at){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let at=0,St=D.length;at<St;at++){const Lt=new C(D[at],this);Lt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Lt.bbox.ll.x),Lt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Lt.bbox.ll.y),Lt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Lt.bbox.ur.x),Lt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Lt.bbox.ur.y),this.polys.push(Lt)}this.isSubject=H}getSweepEvents(){const D=[];for(let H=0,at=this.polys.length;H<at;H++){const St=this.polys[H].getSweepEvents();for(let Lt=0,ge=St.length;Lt<ge;Lt++)D.push(St[Lt])}return D}}class Ft{static factory(D){const H=[];for(let at=0,St=D.length;at<St;at++){const Lt=D[at];if(!Lt.isInResult()||Lt.ringOut)continue;let ge=null,de=Lt.leftSE,ze=Lt.rightSE;const Ne=[de],sn=de.point,Ce=[];for(;ge=de,de=ze,Ne.push(de),de.point!==sn;)for(;;){const en=de.getAvailableLinkedEvents();if(en.length===0){const mn=Ne[0].point,jn=Ne[Ne.length-1].point;throw new Error(`Unable to complete output ring starting at [${mn.x}, ${mn.y}]. Last matching segment found ends at [${jn.x}, ${jn.y}].`)}if(en.length===1){ze=en[0].otherSE;break}let dn=null;for(let mn=0,jn=Ce.length;mn<jn;mn++)if(Ce[mn].point===de.point){dn=mn;break}if(dn!==null){const mn=Ce.splice(dn)[0],jn=Ne.splice(mn.index);jn.unshift(jn[0].otherSE),H.push(new Ft(jn.reverse()));continue}Ce.push({index:Ne.length,point:de.point});const En=de.getLeftmostComparator(ge);ze=en.sort(En)[0].otherSE;break}H.push(new Ft(Ne))}return H}constructor(D){this.events=D;for(let H=0,at=D.length;H<at;H++)D[H].segment.ringOut=this;this.poly=null}getGeom(){let D=this.events[0].point;const H=[D];for(let Ne=1,sn=this.events.length-1;Ne<sn;Ne++){const Ce=this.events[Ne].point,en=this.events[Ne+1].point;Jt(Ce,D,en)!==0&&(H.push(Ce),D=Ce)}if(H.length===1)return null;const at=H[0],St=H[1];Jt(at,D,St)===0&&H.shift(),H.push(H[0]);const Lt=this.isExteriorRing()?1:-1,ge=this.isExteriorRing()?0:H.length-1,de=this.isExteriorRing()?H.length:-1,ze=[];for(let Ne=ge;Ne!=de;Ne+=Lt)ze.push([H[Ne].x,H[Ne].y]);return ze}isExteriorRing(){if(this._isExteriorRing===void 0){const D=this.enclosingRing();this._isExteriorRing=D?!D.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let D=this.events[0];for(let St=1,Lt=this.events.length;St<Lt;St++){const ge=this.events[St];Yt.compare(D,ge)>0&&(D=ge)}let H=D.segment.prevInResult(),at=H?H.prevInResult():null;for(;;){if(!H)return null;if(!at)return H.ringOut;if(at.ringOut!==H.ringOut)return at.ringOut.enclosingRing()!==H.ringOut?H.ringOut:H.ringOut.enclosingRing();H=at.prevInResult(),at=H?H.prevInResult():null}}}class te{constructor(D){this.exteriorRing=D,D.poly=this,this.interiorRings=[]}addInterior(D){this.interiorRings.push(D),D.poly=this}getGeom(){const D=[this.exteriorRing.getGeom()];if(D[0]===null)return null;for(let H=0,at=this.interiorRings.length;H<at;H++){const St=this.interiorRings[H].getGeom();St!==null&&D.push(St)}return D}}class se{constructor(D){this.rings=D,this.polys=this._composePolys(D)}getGeom(){const D=[];for(let H=0,at=this.polys.length;H<at;H++){const St=this.polys[H].getGeom();St!==null&&D.push(St)}return D}_composePolys(D){const H=[];for(let at=0,St=D.length;at<St;at++){const Lt=D[at];if(!Lt.poly)if(Lt.isExteriorRing())H.push(new te(Lt));else{const ge=Lt.enclosingRing();ge.poly||H.push(new te(ge)),ge.poly.addInterior(Lt)}}return H}}class Se{constructor(D){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kt.compare;this.queue=D,this.tree=new Vt(H),this.segments=[]}process(D){const H=D.segment,at=[];if(D.consumedBy)return D.isLeft?this.queue.remove(D.otherSE):this.tree.remove(H),at;const St=D.isLeft?this.tree.add(H):this.tree.find(H);if(!St)throw new Error(`Unable to find segment #${H.id} [${H.leftSE.point.x}, ${H.leftSE.point.y}] -> [${H.rightSE.point.x}, ${H.rightSE.point.y}] in SweepLine tree.`);let Lt=St,ge=St,de,ze;for(;de===void 0;)Lt=this.tree.prev(Lt),Lt===null?de=null:Lt.key.consumedBy===void 0&&(de=Lt.key);for(;ze===void 0;)ge=this.tree.next(ge),ge===null?ze=null:ge.key.consumedBy===void 0&&(ze=ge.key);if(D.isLeft){let Ne=null;if(de){const Ce=de.getIntersection(H);if(Ce!==null&&(H.isAnEndpoint(Ce)||(Ne=Ce),!de.isAnEndpoint(Ce))){const en=this._splitSafely(de,Ce);for(let dn=0,En=en.length;dn<En;dn++)at.push(en[dn])}}let sn=null;if(ze){const Ce=ze.getIntersection(H);if(Ce!==null&&(H.isAnEndpoint(Ce)||(sn=Ce),!ze.isAnEndpoint(Ce))){const en=this._splitSafely(ze,Ce);for(let dn=0,En=en.length;dn<En;dn++)at.push(en[dn])}}if(Ne!==null||sn!==null){let Ce=null;Ne===null?Ce=sn:sn===null?Ce=Ne:Ce=Yt.comparePoints(Ne,sn)<=0?Ne:sn,this.queue.remove(H.rightSE),at.push(H.rightSE);const en=H.split(Ce);for(let dn=0,En=en.length;dn<En;dn++)at.push(en[dn])}at.length>0?(this.tree.remove(H),at.push(D)):(this.segments.push(H),H.prev=de)}else{if(de&&ze){const Ne=de.getIntersection(ze);if(Ne!==null){if(!de.isAnEndpoint(Ne)){const sn=this._splitSafely(de,Ne);for(let Ce=0,en=sn.length;Ce<en;Ce++)at.push(sn[Ce])}if(!ze.isAnEndpoint(Ne)){const sn=this._splitSafely(ze,Ne);for(let Ce=0,en=sn.length;Ce<en;Ce++)at.push(sn[Ce])}}}this.tree.remove(H)}return at}_splitSafely(D,H){this.tree.remove(D);const at=D.rightSE;this.queue.remove(at);const St=D.split(H);return St.push(at),D.consumedBy===void 0&&this.tree.add(D),St}}const be=typeof Y!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ze=typeof Y!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class tn{run(D,H,at){Ge.type=D,nt.reset();const St=[new z(H,!0)];for(let Ce=0,en=at.length;Ce<en;Ce++)St.push(new z(at[Ce],!1));if(Ge.numMultiPolys=St.length,Ge.type==="difference"){const Ce=St[0];let en=1;for(;en<St.length;)ve(St[en].bbox,Ce.bbox)!==null?en++:St.splice(en,1)}if(Ge.type==="intersection")for(let Ce=0,en=St.length;Ce<en;Ce++){const dn=St[Ce];for(let En=Ce+1,mn=St.length;En<mn;En++)if(ve(dn.bbox,St[En].bbox)===null)return[]}const Lt=new Vt(Yt.compare);for(let Ce=0,en=St.length;Ce<en;Ce++){const dn=St[Ce].getSweepEvents();for(let En=0,mn=dn.length;En<mn;En++)if(Lt.insert(dn[En]),Lt.size>be)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const ge=new Se(Lt);let de=Lt.size,ze=Lt.pop();for(;ze;){const Ce=ze.key;if(Lt.size===de){const dn=Ce.segment;throw new Error(`Unable to pop() ${Ce.isLeft?"left":"right"} SweepEvent [${Ce.point.x}, ${Ce.point.y}] from segment #${dn.id} [${dn.leftSE.point.x}, ${dn.leftSE.point.y}] -> [${dn.rightSE.point.x}, ${dn.rightSE.point.y}] from queue.`)}if(Lt.size>be)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(ge.segments.length>Ze)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const en=ge.process(Ce);for(let dn=0,En=en.length;dn<En;dn++){const mn=en[dn];mn.consumedBy===void 0&&Lt.insert(mn)}de=Lt.size,ze=Lt.pop()}nt.reset();const Ne=Ft.factory(ge.segments);return new se(Ne).getGeom()}}const Ge=new tn;var ye={union:function(st){for(var D=arguments.length,H=new Array(D>1?D-1:0),at=1;at<D;at++)H[at-1]=arguments[at];return Ge.run("union",st,H)},intersection:function(st){for(var D=arguments.length,H=new Array(D>1?D-1:0),at=1;at<D;at++)H[at-1]=arguments[at];return Ge.run("intersection",st,H)},xor:function(st){for(var D=arguments.length,H=new Array(D>1?D-1:0),at=1;at<D;at++)H[at-1]=arguments[at];return Ge.run("xor",st,H)},difference:function(st){for(var D=arguments.length,H=new Array(D>1?D-1:0),at=1;at<D;at++)H[at-1]=arguments[at];return Ge.run("difference",st,H)}};return ye})},86851:function($t,Qt,L){"use strict";var Y=L(89594),Z=Array.prototype.concat,tt=Array.prototype.slice,yt=$t.exports=function(Ot){for(var bt=[],Et=0,pt=Ot.length;Et<pt;Et++){var Vt=Ot[Et];Y(Vt)?bt=Z.call(bt,tt.call(Vt)):bt.push(Vt)}return bt};yt.wrap=function(G){return function(){return G(yt(arguments))}}},89594:function($t){$t.exports=function(L){return!L||typeof L=="string"?!1:L instanceof Array||Array.isArray(L)||L.length>=0&&(L.splice instanceof Function||Object.getOwnPropertyDescriptor(L,L.length-1)&&L.constructor.name!=="String")}},69848:function($t){(function(Qt,L){$t.exports=L()})(this,function(){"use strict";function Qt(Ut,nt,ie,qt,At,Pe){if(!(At-qt<=ie)){var it=qt+At>>1;L(Ut,nt,it,qt,At,Pe%2),Qt(Ut,nt,ie,qt,it-1,Pe+1),Qt(Ut,nt,ie,it+1,At,Pe+1)}}function L(Ut,nt,ie,qt,At,Pe){for(;At>qt;){if(At-qt>600){var it=At-qt+1,Pt=ie-qt+1,q=Math.log(it),Nt=.5*Math.exp(2*q/3),It=.5*Math.sqrt(q*Nt*(it-Nt)/it)*(Pt-it/2<0?-1:1),U=Math.max(qt,Math.floor(ie-Pt*Nt/it+It)),ht=Math.min(At,Math.floor(ie+(it-Pt)*Nt/it+It));L(Ut,nt,ie,U,ht,Pe)}var ne=nt[2*ie+Pe],xe=qt,_e=At;for(Y(Ut,nt,qt,ie),nt[2*At+Pe]>ne&&Y(Ut,nt,qt,At);xe<_e;){for(Y(Ut,nt,xe,_e),xe++,_e--;nt[2*xe+Pe]<ne;)xe++;for(;nt[2*_e+Pe]>ne;)_e--}nt[2*qt+Pe]===ne?Y(Ut,nt,qt,_e):(_e++,Y(Ut,nt,_e,At)),_e<=ie&&(qt=_e+1),ie<=_e&&(At=_e-1)}}function Y(Ut,nt,ie,qt){Z(Ut,ie,qt),Z(nt,2*ie,2*qt),Z(nt,2*ie+1,2*qt+1)}function Z(Ut,nt,ie){var qt=Ut[nt];Ut[nt]=Ut[ie],Ut[ie]=qt}function tt(Ut,nt,ie,qt,At,Pe,it){for(var Pt=[0,Ut.length-1,0],q=[],Nt,It;Pt.length;){var U=Pt.pop(),ht=Pt.pop(),ne=Pt.pop();if(ht-ne<=it){for(var xe=ne;xe<=ht;xe++)Nt=nt[2*xe],It=nt[2*xe+1],Nt>=ie&&Nt<=At&&It>=qt&&It<=Pe&&q.push(Ut[xe]);continue}var _e=Math.floor((ne+ht)/2);Nt=nt[2*_e],It=nt[2*_e+1],Nt>=ie&&Nt<=At&&It>=qt&&It<=Pe&&q.push(Ut[_e]);var Xe=(U+1)%2;(U===0?ie<=Nt:qt<=It)&&(Pt.push(ne),Pt.push(_e-1),Pt.push(Xe)),(U===0?At>=Nt:Pe>=It)&&(Pt.push(_e+1),Pt.push(ht),Pt.push(Xe))}return q}function yt(Ut,nt,ie,qt,At,Pe){for(var it=[0,Ut.length-1,0],Pt=[],q=At*At;it.length;){var Nt=it.pop(),It=it.pop(),U=it.pop();if(It-U<=Pe){for(var ht=U;ht<=It;ht++)G(nt[2*ht],nt[2*ht+1],ie,qt)<=q&&Pt.push(Ut[ht]);continue}var ne=Math.floor((U+It)/2),xe=nt[2*ne],_e=nt[2*ne+1];G(xe,_e,ie,qt)<=q&&Pt.push(Ut[ne]);var Xe=(Nt+1)%2;(Nt===0?ie-At<=xe:qt-At<=_e)&&(it.push(U),it.push(ne-1),it.push(Xe)),(Nt===0?ie+At>=xe:qt+At>=_e)&&(it.push(ne+1),it.push(It),it.push(Xe))}return Pt}function G(Ut,nt,ie,qt){var At=Ut-ie,Pe=nt-qt;return At*At+Pe*Pe}var Ot=function(Ut){return Ut[0]},bt=function(Ut){return Ut[1]},Et=function(nt,ie,qt,At,Pe){ie===void 0&&(ie=Ot),qt===void 0&&(qt=bt),At===void 0&&(At=64),Pe===void 0&&(Pe=Float64Array),this.nodeSize=At,this.points=nt;for(var it=nt.length<65536?Uint16Array:Uint32Array,Pt=this.ids=new it(nt.length),q=this.coords=new Pe(nt.length*2),Nt=0;Nt<nt.length;Nt++)Pt[Nt]=Nt,q[2*Nt]=ie(nt[Nt]),q[2*Nt+1]=qt(nt[Nt]);Qt(Pt,q,At,0,Pt.length-1,0)};Et.prototype.range=function(nt,ie,qt,At){return tt(this.ids,this.coords,nt,ie,qt,At,this.nodeSize)},Et.prototype.within=function(nt,ie,qt){return yt(this.ids,this.coords,nt,ie,qt,this.nodeSize)};var pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ut){return Ut}},Vt=Math.fround||function(Ut){return function(nt){return Ut[0]=+nt,Ut[0]}}(new Float32Array(1)),K=function(nt){this.options=Ue(Object.create(pt),nt),this.trees=new Array(this.options.maxZoom+1)};K.prototype.load=function(nt){var ie=this.options,qt=ie.log,At=ie.minZoom,Pe=ie.maxZoom,it=ie.nodeSize;qt&&console.time("total time");var Pt="prepare "+nt.length+" points";qt&&console.time(Pt),this.points=nt;for(var q=[],Nt=0;Nt<nt.length;Nt++)nt[Nt].geometry&&q.push(Zt(nt[Nt],Nt));this.trees[Pe+1]=new Et(q,Ke,we,it,Float32Array),qt&&console.timeEnd(Pt);for(var It=Pe;It>=At;It--){var U=+Date.now();q=this._cluster(q,It),this.trees[It]=new Et(q,Ke,we,it,Float32Array),qt&&console.log("z%d: %d clusters in %dms",It,q.length,+Date.now()-U)}return qt&&console.timeEnd("total time"),this},K.prototype.getClusters=function(nt,ie){var qt=((nt[0]+180)%360+360)%360-180,At=Math.max(-90,Math.min(90,nt[1])),Pe=nt[2]===180?180:((nt[2]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,nt[3]));if(nt[2]-nt[0]>=360)qt=-180,Pe=180;else if(qt>Pe){var Pt=this.getClusters([qt,At,180,it],ie),q=this.getClusters([-180,At,Pe,it],ie);return Pt.concat(q)}for(var Nt=this.trees[this._limitZoom(ie)],It=Nt.range(Rt(qt),Gt(it),Rt(Pe),Gt(At)),U=[],ht=0,ne=It;ht<ne.length;ht+=1){var xe=ne[ht],_e=Nt.points[xe];U.push(_e.numPoints?Mt(_e):this.points[_e.index])}return U},K.prototype.getChildren=function(nt){var ie=this._getOriginId(nt),qt=this._getOriginZoom(nt),At="No cluster with the specified id.",Pe=this.trees[qt];if(!Pe)throw new Error(At);var it=Pe.points[ie];if(!it)throw new Error(At);for(var Pt=this.options.radius/(this.options.extent*Math.pow(2,qt-1)),q=Pe.within(it.x,it.y,Pt),Nt=[],It=0,U=q;It<U.length;It+=1){var ht=U[It],ne=Pe.points[ht];ne.parentId===nt&&Nt.push(ne.numPoints?Mt(ne):this.points[ne.index])}if(Nt.length===0)throw new Error(At);return Nt},K.prototype.getLeaves=function(nt,ie,qt){ie=ie||10,qt=qt||0;var At=[];return this._appendLeaves(At,nt,ie,qt,0),At},K.prototype.getTile=function(nt,ie,qt){var At=this.trees[this._limitZoom(nt)],Pe=Math.pow(2,nt),it=this.options,Pt=it.extent,q=it.radius,Nt=q/Pt,It=(qt-Nt)/Pe,U=(qt+1+Nt)/Pe,ht={features:[]};return this._addTileFeatures(At.range((ie-Nt)/Pe,It,(ie+1+Nt)/Pe,U),At.points,ie,qt,Pe,ht),ie===0&&this._addTileFeatures(At.range(1-Nt/Pe,It,1,U),At.points,Pe,qt,Pe,ht),ie===Pe-1&&this._addTileFeatures(At.range(0,It,Nt/Pe,U),At.points,-1,qt,Pe,ht),ht.features.length?ht:null},K.prototype.getClusterExpansionZoom=function(nt){for(var ie=this._getOriginZoom(nt)-1;ie<=this.options.maxZoom;){var qt=this.getChildren(nt);if(ie++,qt.length!==1)break;nt=qt[0].properties.cluster_id}return ie},K.prototype._appendLeaves=function(nt,ie,qt,At,Pe){for(var it=this.getChildren(ie),Pt=0,q=it;Pt<q.length;Pt+=1){var Nt=q[Pt],It=Nt.properties;if(It&&It.cluster?Pe+It.point_count<=At?Pe+=It.point_count:Pe=this._appendLeaves(nt,It.cluster_id,qt,At,Pe):Pe<At?Pe++:nt.push(Nt),nt.length===qt)break}return Pe},K.prototype._addTileFeatures=function(nt,ie,qt,At,Pe,it){for(var Pt=0,q=nt;Pt<q.length;Pt+=1){var Nt=q[Pt],It=ie[Nt],U=It.numPoints,ht=void 0,ne=void 0,xe=void 0;if(U)ht=zt(It),ne=It.x,xe=It.y;else{var _e=this.points[It.index];ht=_e.properties,ne=Rt(_e.geometry.coordinates[0]),xe=Gt(_e.geometry.coordinates[1])}var Xe={type:1,geometry:[[Math.round(this.options.extent*(ne*Pe-qt)),Math.round(this.options.extent*(xe*Pe-At))]],tags:ht},Re=void 0;U?Re=It.id:this.options.generateId?Re=It.index:this.points[It.index].id&&(Re=this.points[It.index].id),Re!==void 0&&(Xe.id=Re),it.features.push(Xe)}},K.prototype._limitZoom=function(nt){return Math.max(this.options.minZoom,Math.min(Math.floor(+nt),this.options.maxZoom+1))},K.prototype._cluster=function(nt,ie){for(var qt=[],At=this.options,Pe=At.radius,it=At.extent,Pt=At.reduce,q=At.minPoints,Nt=Pe/(it*Math.pow(2,ie)),It=0;It<nt.length;It++){var U=nt[It];if(!(U.zoom<=ie)){U.zoom=ie;for(var ht=this.trees[ie+1],ne=ht.within(U.x,U.y,Nt),xe=U.numPoints||1,_e=xe,Xe=0,Re=ne;Xe<Re.length;Xe+=1){var un=Re[Xe],cn=ht.points[un];cn.zoom>ie&&(_e+=cn.numPoints||1)}if(_e>xe&&_e>=q){for(var Jt=U.x*xe,ct=U.y*xe,Ct=Pt&&xe>1?this._map(U,!0):null,me=(It<<5)+(ie+1)+this.points.length,he=0,Tt=ne;he<Tt.length;he+=1){var re=Tt[he],Yt=ht.points[re];if(!(Yt.zoom<=ie)){Yt.zoom=ie;var N=Yt.numPoints||1;Jt+=Yt.x*N,ct+=Yt.y*N,Yt.parentId=me,Pt&&(Ct||(Ct=this._map(U,!0)),Pt(Ct,this._map(Yt)))}}U.parentId=me,qt.push(X(Jt/_e,ct/_e,me,_e,Ct))}else if(qt.push(U),_e>1)for(var kt=0,oe=ne;kt<oe.length;kt+=1){var C=oe[kt],z=ht.points[C];z.zoom<=ie||(z.zoom=ie,qt.push(z))}}}return qt},K.prototype._getOriginId=function(nt){return nt-this.points.length>>5},K.prototype._getOriginZoom=function(nt){return(nt-this.points.length)%32},K.prototype._map=function(nt,ie){if(nt.numPoints)return ie?Ue({},nt.properties):nt.properties;var qt=this.points[nt.index].properties,At=this.options.map(qt);return ie&&At===qt?Ue({},At):At};function X(Ut,nt,ie,qt,At){return{x:Vt(Ut),y:Vt(nt),zoom:1/0,id:ie,parentId:-1,numPoints:qt,properties:At}}function Zt(Ut,nt){var ie=Ut.geometry.coordinates,qt=ie[0],At=ie[1];return{x:Vt(Rt(qt)),y:Vt(Gt(At)),zoom:1/0,index:nt,parentId:-1}}function Mt(Ut){return{type:"Feature",id:Ut.id,properties:zt(Ut),geometry:{type:"Point",coordinates:[ve(Ut.x),Me(Ut.y)]}}}function zt(Ut){var nt=Ut.numPoints,ie=nt>=1e4?Math.round(nt/1e3)+"k":nt>=1e3?Math.round(nt/100)/10+"k":nt;return Ue(Ue({},Ut.properties),{cluster:!0,cluster_id:Ut.id,point_count:nt,point_count_abbreviated:ie})}function Rt(Ut){return Ut/360+.5}function Gt(Ut){var nt=Math.sin(Ut*Math.PI/180),ie=.5-.25*Math.log((1+nt)/(1-nt))/Math.PI;return ie<0?0:ie>1?1:ie}function ve(Ut){return(Ut-.5)*360}function Me(Ut){var nt=(180-Ut*360)*Math.PI/180;return 360*Math.atan(Math.exp(nt))/Math.PI-90}function Ue(Ut,nt){for(var ie in nt)Ut[ie]=nt[ie];return Ut}function Ke(Ut){return Ut.x}function we(Ut){return Ut.y}return K})},13147:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Ke}});var Y=L(4942),Z=L(1413),tt=L(91),yt=L(87200),G=L(93967),Ot=L(67294),bt=L(70674),Et=L(96772),pt=L(63139),Vt=function(Ut){return(0,Y.Z)({},Ut.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:Ut.marginLG,marginInline:0,color:Ut.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function K(we){return(0,pt.Xj)("ProCardOperation",function(Ut){var nt=(0,Z.Z)((0,Z.Z)({},Ut),{},{componentCls:".".concat(we)});return[Vt(nt)]})}var X=L(85893),Zt=function(Ut){var nt=Ut.className,ie=Ut.style,qt=ie===void 0?{}:ie,At=Ut.children,Pe=(0,Ot.useContext)(yt.ZP.ConfigContext),it=Pe.getPrefixCls,Pt=it("pro-card-operation"),q=K(Pt),Nt=q.wrapSSR,It=q.hashId,U=G(Pt,nt,It);return Nt((0,X.jsx)("div",{className:U,style:qt,children:At}))},Mt=Zt,zt=L(3859),Rt=function(Ut){return(0,Y.Z)({},Ut.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,Y.Z)({flexDirection:"row"},"".concat(Ut.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(Ut.colorBorder)}})};function Gt(we){return(0,pt.Xj)("StatisticCard",function(Ut){var nt=(0,Z.Z)((0,Z.Z)({},Ut),{},{componentCls:".".concat(we)});return[Rt(nt)]})}var ve=["children","statistic","className","chart","chartPlacement","footer"],Me=function(Ut){var nt=Ut.children,ie=Ut.statistic,qt=Ut.className,At=Ut.chart,Pe=Ut.chartPlacement,it=Ut.footer,Pt=(0,tt.Z)(Ut,ve),q=(0,Ot.useContext)(yt.ZP.ConfigContext),Nt=q.getPrefixCls,It=Nt("pro-statistic-card"),U=Gt(It),ht=U.wrapSSR,ne=U.hashId,xe=G(It,qt,ne),_e=ie&&(0,X.jsx)(zt.Z,(0,Z.Z)({layout:"vertical"},ie)),Xe=G("".concat(It,"-chart"),ne,(0,Y.Z)((0,Y.Z)({},"".concat(It,"-chart-left"),Pe==="left"&&At&&ie),"".concat(It,"-chart-right"),Pe==="right"&&At&&ie)),Re=At&&(0,X.jsx)("div",{className:Xe,children:At}),un=G("".concat(It,"-content "),ne,(0,Y.Z)({},"".concat(It,"-content-horizontal"),Pe==="left"||Pe==="right")),cn=(Re||_e)&&(Pe==="left"?(0,X.jsxs)("div",{className:un,children:[Re,_e]}):(0,X.jsxs)("div",{className:un,children:[_e,Re]})),Jt=it&&(0,X.jsx)("div",{className:"".concat(It,"-footer ").concat(ne).trim(),children:it});return ht((0,X.jsxs)(bt.Z,(0,Z.Z)((0,Z.Z)({className:xe},Pt),{},{children:[cn,nt,Jt]})))},Ue=function(Ut){return(0,X.jsx)(Me,(0,Z.Z)({styles:{body:{padding:0}}},Ut))};Me.Statistic=zt.Z,Me.Divider=Et.Z,Me.Operation=Mt,Me.isProCard=!0,Me.Group=Ue;var Ke=Me},3859:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return Jt}});var Y=L(1413),Z=L(4942),tt=L(91),yt=L(25035),G=L(87200),Ot=L(83062),bt=L(79041),Et=L(67294),pt=L(43401),Vt=L(96159),K=L(59177),X=L(90512),Zt=L(91561),Mt=L(53124),zt=L(48054),Gt=ct=>{const{value:Ct,formatter:me,precision:he,decimalSeparator:Tt,groupSeparator:re="",prefixCls:Yt}=ct;let N;if(typeof me=="function")N=me(Ct);else{const kt=String(Ct),oe=kt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!oe||kt==="-")N=kt;else{const C=oe[1];let z=oe[2]||"0",Ft=oe[4]||"";z=z.replace(/\B(?=(\d{3})+(?!\d))/g,re),typeof he=="number"&&(Ft=Ft.padEnd(he,"0").slice(0,he>0?he:0)),Ft&&(Ft=`${Tt}${Ft}`),N=[Et.createElement("span",{key:"int",className:`${Yt}-content-value-int`},C,z),Ft&&Et.createElement("span",{key:"decimal",className:`${Yt}-content-value-decimal`},Ft)]}}return Et.createElement("span",{className:`${Yt}-content-value`},N)},ve=L(14747),Me=L(83559),Ue=L(83262);const Ke=ct=>{const{componentCls:Ct,marginXXS:me,padding:he,colorTextDescription:Tt,titleFontSize:re,colorTextHeading:Yt,contentFontSize:N,fontFamily:kt}=ct;return{[Ct]:fc(To({},(0,ve.Wf)(ct)),{[`${Ct}-header`]:{paddingBottom:me,[`${Ct}-title`]:{color:Tt,fontSize:re}},[`${Ct}-skeleton`]:{paddingTop:he},[`${Ct}-content`]:{color:Yt,fontSize:N,fontFamily:kt,[`${Ct}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Ct}-content-prefix, ${Ct}-content-suffix`]:{display:"inline-block"},[`${Ct}-content-prefix`]:{marginInlineEnd:me},[`${Ct}-content-suffix`]:{marginInlineStart:me}}})}},we=ct=>{const{fontSizeHeading3:Ct,fontSize:me}=ct;return{titleFontSize:me,contentFontSize:Ct}};var Ut=(0,Me.I$)("Statistic",ct=>{const Ct=(0,Ue.IX)(ct,{});return Ke(Ct)},we),ie=Et.forwardRef((ct,Ct)=>{const tr=ct,{prefixCls:me,className:he,rootClassName:Tt,style:re,valueStyle:Yt,value:N=0,title:kt,valueRender:oe,prefix:C,suffix:z,loading:Ft=!1,formatter:te,precision:se,decimalSeparator:Se=".",groupSeparator:be=",",onMouseEnter:Ze,onMouseLeave:tn,styles:Ge,classNames:Be}=tr,jt=g7(tr,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave","styles","classNames"]),{getPrefixCls:ce,direction:ae,className:ye,style:st,classNames:D,styles:H}=(0,Mt.dj)("statistic"),at=ce("statistic",me),[St,Lt]=Ut(at),ge=fc(To({},ct),{decimalSeparator:Se,groupSeparator:be,loading:Ft,value:N}),[de,ze]=(0,Zt.MW)([D,Be],[H,Ge],{props:ge}),Ne=Et.createElement(Gt,{decimalSeparator:Se,groupSeparator:be,prefixCls:at,formatter:te,precision:se,value:N}),sn=(0,X.W)(at,{[`${at}-rtl`]:ae==="rtl"},ye,he,Tt,de.root,St,Lt),Ce=(0,X.W)(`${at}-header`,de.header),en=(0,X.W)(`${at}-title`,de.title),dn=(0,X.W)(`${at}-content`,de.content),En=(0,X.W)(`${at}-content-prefix`,de.prefix),mn=(0,X.W)(`${at}-content-suffix`,de.suffix),jn=Et.useRef(null);Et.useImperativeHandle(Ct,()=>({nativeElement:jn.current}));const Wn=(0,K.Z)(jt,{aria:!0,data:!0});return Et.createElement("div",fc(To({},Wn),{className:sn,style:To(To(To({},ze.root),st),re),ref:jn,onMouseEnter:Ze,onMouseLeave:tn}),kt&&Et.createElement("div",{className:Ce,style:ze.header},Et.createElement("div",{className:en,style:ze.title},kt)),Et.createElement(zt.Z,{paragraph:!1,loading:Ft,className:`${at}-skeleton`,active:!0},Et.createElement("div",{className:dn,style:To(To({},Yt),ze.content)},C&&Et.createElement("span",{className:En,style:ze.prefix},C),oe?oe(Ne):Ne,z&&Et.createElement("span",{className:mn,style:ze.suffix},z))))});const qt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function At(ct,Ct){let me=ct;const he=/\[[^\]]*]/g,Tt=(Ct.match(he)||[]).map(kt=>kt.slice(1,-1)),re=Ct.replace(he,"[]"),Yt=qt.reduce((kt,[oe,C])=>{if(kt.includes(oe)){const z=Math.floor(me/C);return me-=z*C,kt.replace(new RegExp(`${oe}+`,"g"),Ft=>{const te=Ft.length;return z.toString().padStart(te,"0")})}return kt},re);let N=0;return Yt.replace(he,()=>{const kt=Tt[N];return N+=1,kt})}function Pe(ct,Ct,me){const{format:he=""}=Ct,Tt=new Date(ct).getTime(),re=Date.now(),Yt=Math.max(me?Tt-re:re-Tt,0);return At(Yt,he)}const it=1e3/60;function Pt(ct){return new Date(ct).getTime()}var Nt=ct=>{const te=ct,{value:Ct,format:me="HH:mm:ss",onChange:he,onFinish:Tt,type:re}=te,Yt=g7(te,["value","format","onChange","onFinish","type"]),N=re==="countdown",[kt,oe]=Et.useState(null),C=(0,pt.zX)(()=>{const se=Date.now(),Se=Pt(Ct);oe({});const be=N?Se-se:se-Se;return he==null||he(be),N&&Se<se?(Tt==null||Tt(),!1):!0});Et.useEffect(()=>{let se;const Se=()=>{C()||window.clearInterval(se)},be=()=>{se=window.setInterval(Se,it)},Ze=()=>{window.clearInterval(se)};return be(),()=>{Ze()}},[Ct,N]),Et.useEffect(()=>{oe({})},[]);const z=(se,Se)=>kt?Pe(se,fc(To({},Se),{format:me}),N):"-",Ft=se=>(0,Vt.Tm)(se,{title:void 0});return Et.createElement(ie,fc(To({},Yt),{value:Ct,valueRender:Ft,formatter:z}))};const It=ct=>Et.createElement(Nt,fc(To({},ct),{type:"countdown"}));var U=Et.memo(It);ie.Timer=Nt,ie.Countdown=U;var ht=ie,ne=L(93967),xe=L(63139),_e=function(Ct){return(0,Z.Z)({},Ct.componentCls,(0,Z.Z)((0,Z.Z)((0,Z.Z)((0,Z.Z)((0,Z.Z)({display:"flex",fontSize:Ct.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,Z.Z)({display:"flex",width:"100%"},"".concat(Ct.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":{width:"100%"},"&-description":{width:"100%"}},"".concat(Ct.antCls,"-statistic-title"),{color:Ct.colorText}),"&-trend-up",(0,Z.Z)({},"".concat(Ct.antCls,"-statistic-content"),(0,Z.Z)({color:"#f5222d"},"".concat(Ct.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,Z.Z)({},"".concat(Ct.antCls,"-statistic-content"),(0,Z.Z)({color:"#389e0d"},"".concat(Ct.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,Z.Z)((0,Z.Z)((0,Z.Z)({display:"flex",justifyContent:"space-between"},"".concat(Ct.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(Ct.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(Ct.antCls,"-statistic-title,").concat(Ct.antCls,"-statistic-content,").concat(Ct.antCls,"-statistic-content-suffix,").concat(Ct.antCls,"-statistic-content-prefix,").concat(Ct.antCls,"-statistic-content-value-decimal"),{fontSize:Ct.fontSize})),"& &-layout-inline",(0,Z.Z)((0,Z.Z)((0,Z.Z)({display:"inline-flex",color:Ct.colorTextSecondary},"".concat(Ct.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(Ct.antCls,"-statistic-content"),{color:Ct.colorTextSecondary}),"".concat(Ct.antCls,"-statistic-title,").concat(Ct.antCls,"-statistic-content,").concat(Ct.antCls,"-statistic-content-suffix,").concat(Ct.antCls,"-statistic-content-prefix,").concat(Ct.antCls,"-statistic-content-value-decimal"),{fontSize:Ct.fontSizeSM})))};function Xe(ct){return(0,xe.Xj)("Statistic",function(Ct){var me=(0,Y.Z)((0,Y.Z)({},Ct),{},{componentCls:".".concat(ct)});return[_e(me)]})}var Re=L(85893),un=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],cn=function(Ct){var me=Ct.className,he=Ct.layout,Tt=he===void 0?"inline":he,re=Ct.style,Yt=Ct.description,N=Ct.children,kt=Ct.title,oe=Ct.tip,C=Ct.status,z=Ct.trend,Ft=Ct.prefix,te=Ct.icon,se=(0,tt.Z)(Ct,un),Se=(0,Et.useContext)(G.ZP.ConfigContext),be=Se.getPrefixCls,Ze=be("pro-card-statistic"),tn=Xe(Ze),Ge=tn.wrapSSR,Be=tn.hashId,jt=ne(Ze,me,Be),ce=ne("".concat(Ze,"-status"),Be),ae=ne("".concat(Ze,"-icon"),Be),ye=ne("".concat(Ze,"-wrapper"),Be),st=ne("".concat(Ze,"-content"),Be),D=ne(Be,(0,Z.Z)((0,Z.Z)({},"".concat(Ze,"-layout-").concat(Tt),Tt),"".concat(Ze,"-trend-").concat(z),z)),H=oe&&(0,Re.jsx)(Ot.Z,{title:oe,children:(0,Re.jsx)(yt.Z,{className:"".concat(Ze,"-tip ").concat(Be).trim()})}),at=ne("".concat(Ze,"-trend-icon"),Be,(0,Z.Z)({},"".concat(Ze,"-trend-icon-").concat(z),z)),St=z&&(0,Re.jsx)("div",{className:at}),Lt=C&&(0,Re.jsx)("div",{className:ce,children:(0,Re.jsx)(bt.Z,{status:C,text:null})}),ge=te&&(0,Re.jsx)("div",{className:ae,children:te});return Ge((0,Re.jsxs)("div",{className:jt,style:re,children:[ge,(0,Re.jsxs)("div",{className:ye,children:[Lt,(0,Re.jsxs)("div",{className:st,children:[(0,Re.jsx)(ht,(0,Y.Z)({title:(kt||H)&&(0,Re.jsxs)(Re.Fragment,{children:[kt,H]}),prefix:(St||Ft)&&(0,Re.jsxs)(Re.Fragment,{children:[St,Ft]}),className:D},se)),Yt&&(0,Re.jsx)("div",{className:"".concat(Ze,"-description ").concat(Be).trim(),children:Yt})]})]})]}))},Jt=cn},5501:function($t,Qt,L){"use strict";var Y=L(90857);Qt.Z=Y},89093:function($t,Qt,L){"use strict";var Y=L(38554);Qt.Z=Y},71937:function($t,Qt,L){"use strict";L.d(Qt,{Z:function(){return yt}});var Y=L(61120);function Z(G,Ot){for(;!{}.hasOwnProperty.call(G,Ot)&&(G=(0,Y.Z)(G))!==null;);return G}function tt(){return tt=typeof Reflect!="undefined"&&Reflect.get?Reflect.get.bind():function(G,Ot,bt){var Et=Z(G,Ot);if(Et){var pt=Object.getOwnPropertyDescriptor(Et,Ot);return pt.get?pt.get.call(arguments.length<3?G:bt):pt.value}},tt.apply(null,arguments)}function yt(G,Ot,bt,Et){var pt=tt((0,Y.Z)(1&Et?G.prototype:G),Ot,bt);return 2&Et&&typeof pt=="function"?function(Vt){return pt.apply(bt,Vt)}:pt}},54235:function($t,Qt,L){"use strict";L.d(Qt,{S:function(){return Y}});function Y(Z){let tt=0;for(let yt=0;yt<Z.length;yt++)tt+=Z[yt];return tt}}}]);
}());