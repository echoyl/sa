"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[318],{55318:function(Ve,G,t){t.r(G),t.d(G,{default:function(){return Se}});var ie=t(19632),f=t.n(ie),re=t(15009),M=t.n(re),se=t(99289),le=t.n(se),de=t(5574),x=t.n(de),ue=t(68400),oe=t.n(ue),ve=t(97857),u=t.n(ve),H=t(97584),b=t(51042),ce=t(79090),fe=t(14726),me=t(45360),ge=t(9361),J=t(36457),he=t(40411),xe=t(96917),y=t(67294),A=t(60887),F=t(45587),ye=t(97133),n=t(85893),K,je=function(i){var N=i.originNode,C=i.file,o=(0,F.nB)({id:C.uid}),U=o.attributes,D=o.listeners,m=o.setNodeRef,j=o.transform,v=o.transition,g=o.isDragging,p={cursor:"move",transition:"unset",height:"100%",width:"100%"},I=j?u()(u()({},p),{},{transform:"translate3d(".concat(j.x,"px, ").concat(j.y,"px, 0)"),transition:g?"unset":v},g?{zIndex:9999}:{}):p,B=g?(0,ye.iv)(K||(K=oe()([`
        a {
          pointer-events: none;
        }
      `]))):"";return(0,n.jsx)("div",u()(u()(u()({ref:m,style:I,className:B},U),D),{},{children:C.status==="error"&&g?N.props.children:N}))},pe=function(i){var N=(0,y.useState)(),C=x()(N,2),o=C[0],U=C[1];(0,y.useEffect)(function(){(0,H.hu)().then(function(r){U(r)})},[]);var D=i.max,m=D===void 0?1:D,j=i.type,v=j===void 0?"image":j,g=i.value,p=g===void 0?[]:g,I=i.size,B=I===void 0?0:I,Q=i.accept,Le=Q===void 0?v=="image"?"image/*":"application/*,text/*":Q,W=i.fieldProps,S=W===void 0?{name:"file",listType:"picture-card",data:{toSize:B,isFile:v=="image"?0:1}}:W,X=i.buttonType,c=X===void 0?"card":X,Y=i.readonly,z=Y===void 0?!1:Y,Ce=(0,y.useState)(p&&typeof p!="string"?p:[]),$=x()(Ce,2),a=$[0],P=$[1],Pe=(0,y.useState)(!1),w=x()(Pe,2),Ze=w[0],k=w[1],Re=(0,y.useState)(0),q=x()(Re,2),Ne=q[0],_=q[1],De=(0,y.useState)(!1),ee=x()(De,2),E=ee[0],O=ee[1];S.maxCount=m,S.multiple=m>1,S.accept=Le;var Ie=function(){var r=le()(M()().mark(function e(l){return M()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(v!="file"){d.next=2;break}return d.abrupt("return");case 2:a.forEach(function(T,L){l.uid==T.uid&&_(L)}),k(!0);case 4:case"end":return d.stop()}},e)}));return function(l){return r.apply(this,arguments)}}();v=="image"&&(S.onPreview=Ie);var ze=(0,n.jsxs)("div",{children:[(0,n.jsx)(b.Z,{}),(0,n.jsx)("div",{style:{marginTop:4},children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"}),(0,n.jsxs)("div",{children:[a.length,"/",m]})]}),Ee=c=="card"||c=="table"?(0,n.jsxs)("div",{children:[E?(0,n.jsx)(ce.Z,{}):(0,n.jsx)(b.Z,{}),(0,n.jsx)("div",{style:{marginTop:8},children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"})]}):(0,n.jsx)(fe.ZP,{icon:(0,n.jsx)(b.Z,{}),children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"}),be=(0,A.VT)(A.we,{activationConstraint:{distance:10}}),Ae=function(e){var l=e.active,s=e.over;if(l.id!==(s==null?void 0:s.id)){var d,T=a.findIndex(function(h){return h.uid===l.id}),L=a.findIndex(function(h){return h.uid===(s==null?void 0:s.id)}),Z=(0,F.Rp)(a,T,L);P(f()(Z)),(d=i.onChange)===null||d===void 0||d.call(i,f()(Z))}},te=function(e){if(e.file.status==="uploading"&&(O(!0),P(f()(e.fileList))),e.file.status==="done"){var l=e.file.response,s=l.code,d=l.msg,T=l.data,L=a.findIndex(function(R){return R.uid==e.file.uid}),Z={uid:e.file.uid,name:e.file.name,url:s?"":T.src,value:s?"":T.url,status:s?"error":"done"};if(L>=0?a.splice(L,1,Z):a.push(Z),s)e.file.status="error",e.file.errorMsg=d;else{var h;(h=i.onChange)===null||h===void 0||h.call(i,f()(a))}P(f()(a)),O(!1)}if(e.file.status==="removed"){var V,ne=a.filter(function(R){return R.uid!=e.file.uid});(V=i.onChange)===null||V===void 0||V.call(i,f()(ne)),P(ne)}if(e.file.status==="error"){me.ZP.error("".concat(e.file.name," \u4E0A\u4F20\u5931\u8D25. ").concat(e.file.errorMsg));var Oe=a.findIndex(function(R){return R.uid==e.file.uid});a.splice(Oe,1),P(f()(a)),O(!1)}},ae=H.m7+"uploader/index",Fe=ge.Z.useToken,Ue=Fe(),Be=Ue.token;return(0,n.jsxs)(n.Fragment,{children:[m==1||z?(0,n.jsx)(J.Z,u()(u()({},S),{},{headers:o,listType:c=="card"||c=="table"?"picture-card":"text",className:c=="table"?"sa-upload-list sa-upload-list-table":"sa-upload-list",showUploadList:a.length&&!E?{showRemoveIcon:!z}:!1,action:ae,fileList:a.length?[a[0]]:[],onChange:te,itemRender:function(e){return(0,n.jsx)(he.Z,{color:Be.colorPrimary,count:a.length>1&&z?a.length:0,size:"small",offset:[-10,10],styles:{root:{height:"100%",width:"100%"}},children:e})},children:a.length&&!E||z?null:Ee})):(0,n.jsx)(A.LB,{sensors:[be],onDragEnd:Ae,children:(0,n.jsx)(F.Fo,{items:a.map(function(r){return r.uid}),children:(0,n.jsx)(J.Z,u()(u()({},S),{},{headers:o,action:ae,listType:c=="card"||c=="table"?"picture-card":"text",className:c=="table"?"sa-upload-list sa-upload-list-table":"sa-upload-list",itemRender:function(e,l){return(0,n.jsx)(je,{originNode:e,file:l})},fileList:a,onChange:te,children:a.length&&a.length==m&&!E?null:ze}))})}),a.length>0&&(0,n.jsx)("div",{style:{display:"none"},children:(0,n.jsx)(xe.Z.PreviewGroup,{preview:{visible:Ze,current:Ne,onVisibleChange:function(e){k(e)},onChange:function(e){_(e)}},items:a.map(function(r){if(r.url){var e=r.url.split("?"),l=x()(e,1),s=l[0];return s}else return""})})})]})},Se=pe}}]);
