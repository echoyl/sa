!(function(){var kM=(br,rr)=>(rr=Symbol[br])?rr:Symbol.for("Symbol."+br),bet=br=>{throw TypeError(br)},vf=Math.pow;var BM=(br,rr,it)=>new Promise((ne,pt)=>{var R=xe=>{try{yt(it.next(xe))}catch(le){pt(le)}},$e=xe=>{try{yt(it.throw(xe))}catch(le){pt(le)}},yt=xe=>xe.done?ne(xe.value):Promise.resolve(xe.value).then(R,$e);yt((it=it.apply(br,rr)).next())}),Eet=function(br,rr){this[0]=br,this[1]=rr};var S8=br=>{var rr=br[kM("asyncIterator")],it=!1,ne,pt={};return rr==null?(rr=br[kM("iterator")](),ne=R=>pt[R]=$e=>rr[R]($e)):(rr=rr.call(br),ne=R=>pt[R]=$e=>{if(it){if(it=!1,R==="throw")throw $e;return $e}return it=!0,{done:!1,value:new Eet(new Promise(yt=>{var xe=rr[R]($e);xe instanceof Object||bet("Object expected"),yt(xe)}),1)}}),pt[kM("iterator")]=()=>pt,ne("next"),"throw"in rr?ne("throw"):pt.throw=R=>{throw R},"return"in rr&&ne("return"),pt};(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[459],{79611:function(br,rr,it){"use strict";var ne=it(67294),pt=it(7366),R=function(){return R=Object.assign||function(yt){for(var xe,le=1,Le=arguments.length;le<Le;le++){xe=arguments[le];for(var Lt in xe)Object.prototype.hasOwnProperty.call(xe,Lt)&&(yt[Lt]=xe[Lt])}return yt},R.apply(this,arguments)},$e=(0,ne.forwardRef)(function(yt,xe){return ne.createElement(pt.P,R({},yt,{chartType:"Bar",ref:xe}))});rr.Z=$e},7366:function(br,rr,it){"use strict";it.d(rr,{P:function(){return vet}});var ne={};it.r(ne),it.d(ne,{area:function(){return A8},bottom:function(){return Nv},bottomLeft:function(){return Nv},bottomRight:function(){return Nv},inside:function(){return Nv},left:function(){return Nv},outside:function(){return R8},right:function(){return Nv},spider:function(){return L8},surround:function(){return N8},top:function(){return Nv},topLeft:function(){return Nv},topRight:function(){return Nv}});var pt={};it.r(pt),it.d(pt,{interpolateBlues:function(){return vU},interpolateBrBG:function(){return q7},interpolateBuGn:function(){return iU},interpolateBuPu:function(){return oU},interpolateCividis:function(){return EU},interpolateCool:function(){return CU},interpolateCubehelixDefault:function(){return AU},interpolateGnBu:function(){return aU},interpolateGreens:function(){return gU},interpolateGreys:function(){return yU},interpolateInferno:function(){return kU},interpolateMagma:function(){return NU},interpolateOrRd:function(){return sU},interpolateOranges:function(){return bU},interpolatePRGn:function(){return $7},interpolatePiYG:function(){return K7},interpolatePlasma:function(){return BU},interpolatePuBu:function(){return cU},interpolatePuBuGn:function(){return lU},interpolatePuOr:function(){return Q7},interpolatePuRd:function(){return uU},interpolatePurples:function(){return _U},interpolateRainbow:function(){return RU},interpolateRdBu:function(){return J7},interpolateRdGy:function(){return tU},interpolateRdPu:function(){return fU},interpolateRdYlBu:function(){return eU},interpolateRdYlGn:function(){return nU},interpolateReds:function(){return xU},interpolateSinebow:function(){return IU},interpolateSpectral:function(){return rU},interpolateTurbo:function(){return LU},interpolateViridis:function(){return DU},interpolateWarm:function(){return OU},interpolateYlGn:function(){return dU},interpolateYlGnBu:function(){return hU},interpolateYlOrBr:function(){return pU},interpolateYlOrRd:function(){return mU},schemeAccent:function(){return E7},schemeBlues:function(){return qI},schemeBrBG:function(){return CI},schemeBuGn:function(){return BI},schemeBuPu:function(){return FI},schemeCategory10:function(){return b7},schemeDark2:function(){return S7},schemeGnBu:function(){return UI},schemeGreens:function(){return $I},schemeGreys:function(){return KI},schemeObservable10:function(){return T7},schemeOrRd:function(){return zI},schemeOranges:function(){return t5},schemePRGn:function(){return RI},schemePaired:function(){return w7},schemePastel1:function(){return A7},schemePastel2:function(){return O7},schemePiYG:function(){return MI},schemePuBu:function(){return VI},schemePuBuGn:function(){return jI},schemePuOr:function(){return PI},schemePuRd:function(){return ZI},schemePurples:function(){return QI},schemeRdBu:function(){return II},schemeRdGy:function(){return LI},schemeRdPu:function(){return HI},schemeRdYlBu:function(){return DI},schemeRdYlGn:function(){return NI},schemeReds:function(){return JI},schemeSet1:function(){return C7},schemeSet2:function(){return R7},schemeSet3:function(){return M7},schemeSpectral:function(){return kI},schemeTableau10:function(){return P7},schemeYlGn:function(){return WI},schemeYlGnBu:function(){return GI},schemeYlOrBr:function(){return XI},schemeYlOrRd:function(){return YI}});var R={};it.r(R),it.d(R,{geoAlbers:function(){return JB},geoAlbersUsa:function(){return Tq},geoAzimuthalEqualArea:function(){return wq},geoAzimuthalEqualAreaRaw:function(){return WR},geoAzimuthalEquidistant:function(){return Aq},geoAzimuthalEquidistantRaw:function(){return XR},geoConicConformal:function(){return Cq},geoConicConformalRaw:function(){return nF},geoConicEqualArea:function(){return rw},geoConicEqualAreaRaw:function(){return QB},geoConicEquidistant:function(){return Mq},geoConicEquidistantRaw:function(){return rF},geoEqualEarth:function(){return Iq},geoEqualEarthRaw:function(){return YR},geoEquirectangular:function(){return Rq},geoEquirectangularRaw:function(){return g2},geoGnomonic:function(){return Lq},geoGnomonicRaw:function(){return qR},geoIdentity:function(){return Dq},geoMercator:function(){return Oq},geoMercatorRaw:function(){return v2},geoNaturalEarth1:function(){return Nq},geoNaturalEarth1Raw:function(){return $R},geoOrthographic:function(){return kq},geoOrthographicRaw:function(){return KR},geoProjection:function(){return Qm},geoProjectionMutator:function(){return HR},geoStereographic:function(){return Bq},geoStereographicRaw:function(){return QR},geoTransverseMercator:function(){return Fq},geoTransverseMercatorRaw:function(){return JR}});var $e={};it.r($e),it.d($e,{frequency:function(){return FK},id:function(){return UK},name:function(){return zK},weight:function(){return BK}});var yt=it(67294),xe=it(73935),le=it.t(xe,2),Le=function(){return Le=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Le.apply(this,arguments)},Lt=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},fn=function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(p){return function(m){return h([p,m])}}function h(p){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(n=0)),n;)try{if(r=1,i&&(s=p[0]&2?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,i=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){n.label=p[1];break}if(p[0]===6&&n.label<s[1]){n.label=s[1],s=p;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(p);break}s[2]&&n.ops.pop(),n.trys.pop();continue}p=e.call(t,n)}catch(m){p=[6,m],i=0}finally{r=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Nt=Le({},le),Jt=Nt.version,Ie=Nt.render,fe=Nt.unmountComponentAtNode,ce;try{var ve=Number((Jt||"").split(".")[0]);ve>=18&&(ce=Nt.createRoot)}catch(t){}function Ze(t){var e=Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&typeof e=="object"&&(e.usingClientEntryPoint=t)}var Un="__rc_react_root__";function En(t,e){Ze(!0);var n=e[Un]||ce(e);Ze(!1),n.render(t),e[Un]=n}function Vn(t,e){Ie(t,e)}function mr(t,e){}function or(t,e){if(ce){En(t,e);return}Vn(t,e)}function He(t){return Lt(this,void 0,void 0,function(){return fn(this,function(e){return[2,Promise.resolve().then(function(){var n;(n=t[Un])===null||n===void 0||n.unmount(),delete t[Un]})]})})}function $t(t){fe(t)}function nn(t){}function ke(t){return Lt(this,void 0,void 0,function(){return fn(this,function(e){return ce!==void 0?[2,He(t)]:($t(t),[2])})})}var Je=new Map;typeof document!="undefined"&&Je.set("tooltip",document.createElement("div"));var er=function(t,e){e===void 0&&(e=!1);var n=null;if(e)n=Je.get("tooltip");else if(n=document.createElement("div"),t!=null&&t.key){var r=Je.get(t.key);r?n=r:Je.set(t.key,n)}return or(t,n),n},kt=function(t){if(typeof document=="undefined")return"loading";var e=t.attachShadow({mode:"open"}),n=document.createElement("div"),r=document.createElement("style");r.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `,n.classList.add("loading"),n.innerHTML="<div></div><div></div><div></div><div></div>",e.appendChild(r),e.appendChild(n)},Te=function(t){var e=t.loadingTemplate,n=t.theme,r=n===void 0?"light":n,i=yt.useRef(null);yt.useEffect(function(){!e&&i.current&&kt(i.current)},[]);var s=function(){return e||yt.createElement("div",{ref:i})};return yt.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:r==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},s())},gt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),te=function(t){gt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state={hasError:!1},n.renderError=function(r){var i=n.props.errorTemplate;switch(r){default:return typeof i=="function"?i(r):i||yt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",r.message)}},n}return e.getDerivedStateFromError=function(n){return{hasError:!0,error:n}},e.getDerivedStateFromProps=function(n,r){return r.children!==n.children?{children:n.children,hasError:!1,error:void 0}:null},e.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):yt.createElement(yt.Fragment,null,this.props.children)},e}(yt.Component),Zt=it(73234),Ut=function(t){var e=/react|\.jsx|children:\[\(|return\s+[A-Za-z0-9].createElement\((?!['"][g|circle|ellipse|image|rect|line|polyline|polygon|text|path|html|mesh]['"])([^\)])*,/i;return e.test(t)},we=it(27771),ie=it(77226),_t=it(50576),Ne=it(68652),un=it(16423),Qn=function(){return Qn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Qn.apply(this,arguments)},hr=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Er(t,e){var n=(0,yt.useRef)(),r=(0,yt.useRef)(),i=(0,yt.useRef)(null),s=e.onReady,l=e.onEvent,u=function(m,y){var x;m===void 0&&(m="image/png");var T=(x=i.current)===null||x===void 0?void 0:x.getElementsByTagName("canvas")[0];return T==null?void 0:T.toDataURL(m,y)},h=function(m,y,x){m===void 0&&(m="download"),y===void 0&&(y="image/png");var T=m;m.indexOf(".")===-1&&(T="".concat(m,".").concat(y.split("/")[1]));var C=u(y,x),M=document.createElement("a");return M.href=C,M.download=T,document.body.appendChild(M),M.click(),document.body.removeChild(M),M=null,T},p=function(m,y){y===void 0&&(y=!1);var x=Object.keys(m),T=y;x.forEach(function(C){var M=m[C];C==="tooltip"&&(T=!0),(0,Zt.Z)(M)&&Ut("".concat(M))?m[C]=function(){for(var I=[],D=0;D<arguments.length;D++)I[D]=arguments[D];return er(M.apply(void 0,I),T)}:(0,we.Z)(M)?M.forEach(function(I){p(I,T)}):(0,ie.Z)(M)?p(M,T):T=y})};return(0,yt.useEffect)(function(){if(n.current&&!(0,_t.Z)(r.current,e)){var m=!1;if(r.current){var y=r.current,x=y.data,T=hr(y,["data"]),C=e.data,M=hr(e,["data"]);m=(0,_t.Z)(T,M)}r.current=(0,Ne.Z)(e),m?n.current.changeData((0,un.Z)(e,"data")):(p(e),n.current.update(e),n.current.render())}},[e]),(0,yt.useEffect)(function(){if(!i.current)return function(){return null};r.current||(r.current=(0,Ne.Z)(e)),p(e);var m=new t(i.current,Qn({},e));m.toDataURL=u,m.downloadImage=h,m.render(),n.current=m,s&&s(m);var y=function(x){l&&l(m,x)};return m.on("*",y),function(){n.current&&(n.current.destroy(),n.current.off("*",y),n.current=void 0)}},[]),{chart:n,container:i}}var Ue="*",cn=function(){function t(){this._events={}}return t.prototype.on=function(e,n,r){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:n,once:!!r}),this},t.prototype.once=function(e,n){return this.on(e,n,!0)},t.prototype.emit=function(e){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=this._events[e]||[],l=this._events[Ue]||[],u=function(h){for(var p=h.length,m=0;m<p;m++)if(h[m]){var y=h[m],x=y.callback,T=y.once;T&&(h.splice(m,1),h.length===0&&delete n._events[e],p--,m--),x.apply(n,r)}};u(s),u(l)},t.prototype.off=function(e,n){if(!e)this._events={};else if(!n)delete this._events[e];else{for(var r=this._events[e]||[],i=r.length,s=0;s<i;s++)r[s].callback===n&&(r.splice(s,1),i--,s--);r.length===0&&delete this._events[e]}return this},t.prototype.getEvents=function(){return this._events},t}(),wn=cn;const ir="main-layer",rn="label-layer",De="element",Be="view",At="plot",Bt="component",Ae="label",z="area",rt="mask";var F=it(97582),ot=it(38554),ze=ot,Vt=it(77160),ae=it(85975),Mn=it(49685);function zn(){var t=new Mn.WT(9);return Mn.WT!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Wn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function sn(t){var e=new glMatrix.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Kt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ce(t,e,n,r,i,s,l,u,h){var p=new Mn.WT(9);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=l,p[7]=u,p[8]=h,p}function xn(t,e,n,r,i,s,l,u,h,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=l,t[6]=u,t[7]=h,t[8]=p,t}function Cn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Zn(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Qt(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],u=e[5],h=e[6],p=e[7],m=e[8],y=m*l-u*p,x=-m*s+u*h,T=p*s-l*h,C=n*y+r*x+i*T;return C?(C=1/C,t[0]=y*C,t[1]=(-m*r+i*p)*C,t[2]=(u*r-i*l)*C,t[3]=x*C,t[4]=(m*n-i*h)*C,t[5]=(-u*n+i*s)*C,t[6]=T*C,t[7]=(-p*n+r*h)*C,t[8]=(l*n-r*s)*C,t):null}function ct(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],u=e[5],h=e[6],p=e[7],m=e[8];return t[0]=l*m-u*p,t[1]=i*p-r*m,t[2]=r*u-i*l,t[3]=u*h-s*m,t[4]=n*m-i*h,t[5]=i*s-n*u,t[6]=s*p-l*h,t[7]=r*h-n*p,t[8]=n*l-r*s,t}function bt(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],u=t[6],h=t[7],p=t[8];return e*(p*s-l*h)+n*(-p*i+l*u)+r*(h*i-s*u)}function zt(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8],x=n[0],T=n[1],C=n[2],M=n[3],I=n[4],D=n[5],U=n[6],Z=n[7],G=n[8];return t[0]=x*r+T*l+C*p,t[1]=x*i+T*u+C*m,t[2]=x*s+T*h+C*y,t[3]=M*r+I*l+D*p,t[4]=M*i+I*u+D*m,t[5]=M*s+I*h+D*y,t[6]=U*r+Z*l+G*p,t[7]=U*i+Z*u+G*m,t[8]=U*s+Z*h+G*y,t}function me(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8],x=n[0],T=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=l,t[4]=u,t[5]=h,t[6]=x*r+T*l+p,t[7]=x*i+T*u+m,t[8]=x*s+T*h+y,t}function de(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],y=e[8],x=Math.sin(n),T=Math.cos(n);return t[0]=T*r+x*l,t[1]=T*i+x*u,t[2]=T*s+x*h,t[3]=T*l-x*r,t[4]=T*u-x*i,t[5]=T*h-x*s,t[6]=p,t[7]=m,t[8]=y,t}function bn(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function qn(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Sr(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Gn(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ht(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function ut(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,u=r+r,h=i+i,p=n*l,m=r*l,y=r*u,x=i*l,T=i*u,C=i*h,M=s*l,I=s*u,D=s*h;return t[0]=1-y-C,t[3]=m-D,t[6]=x+I,t[1]=m+D,t[4]=1-p-C,t[7]=T-M,t[2]=x-I,t[5]=T+M,t[8]=1-p-y,t}function wt(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],u=e[5],h=e[6],p=e[7],m=e[8],y=e[9],x=e[10],T=e[11],C=e[12],M=e[13],I=e[14],D=e[15],U=n*u-r*l,Z=n*h-i*l,G=n*p-s*l,W=r*h-i*u,$=r*p-s*u,J=i*p-s*h,nt=m*M-y*C,dt=m*I-x*C,Et=m*D-T*C,Pt=y*I-x*M,Ht=y*D-T*M,Ct=x*D-T*I,Ft=U*Ct-Z*Ht+G*Pt+W*Et-$*dt+J*nt;return Ft?(Ft=1/Ft,t[0]=(u*Ct-h*Ht+p*Pt)*Ft,t[1]=(h*Et-l*Ct-p*dt)*Ft,t[2]=(l*Ht-u*Et+p*nt)*Ft,t[3]=(i*Ht-r*Ct-s*Pt)*Ft,t[4]=(n*Ct-i*Et+s*dt)*Ft,t[5]=(r*Et-n*Ht-s*nt)*Ft,t[6]=(M*J-I*$+D*W)*Ft,t[7]=(I*G-C*J-D*Z)*Ft,t[8]=(C*$-M*G+D*U)*Ft,t):null}function Gt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function ue(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ge(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function ln(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function ee(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Fe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Hn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Tr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Zr(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8],y=e[0],x=e[1],T=e[2],C=e[3],M=e[4],I=e[5],D=e[6],U=e[7],Z=e[8];return Math.abs(n-y)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-x)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-T)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-C)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(l-M)<=glMatrix.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-I)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(h-D)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(p-U)<=glMatrix.EPSILON*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(m-Z)<=glMatrix.EPSILON*Math.max(1,Math.abs(m),Math.abs(Z))}var vr=null,Ur=null,jr=it(98333);function ni(){var t=new Mn.WT(4);return Mn.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function pi(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function mi(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>glMatrix.EPSILON?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function xi(t,e){var n=Xr(t,e);return Math.acos(2*n*n-1)}function wo(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],u=n[0],h=n[1],p=n[2],m=n[3];return t[0]=r*m+l*u+i*p-s*h,t[1]=i*m+l*h+s*u-r*p,t[2]=s*m+l*p+r*h-i*u,t[3]=l*m-r*u-i*h-s*p,t}function Li(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],u=Math.sin(n),h=Math.cos(n);return t[0]=r*h+l*u,t[1]=i*h+s*u,t[2]=s*h-i*u,t[3]=l*h-r*u,t}function aa(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],u=Math.sin(n),h=Math.cos(n);return t[0]=r*h-s*u,t[1]=i*h+l*u,t[2]=s*h+r*u,t[3]=l*h-i*u,t}function Pa(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],u=Math.sin(n),h=Math.cos(n);return t[0]=r*h+i*u,t[1]=i*h-r*u,t[2]=s*h+l*u,t[3]=l*h-s*u,t}function Lo(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function $o(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=Math.sqrt(n*n+r*r+i*i),u=Math.exp(s),h=l>0?u*Math.sin(l)/l:0;return t[0]=n*h,t[1]=r*h,t[2]=i*h,t[3]=u*Math.cos(l),t}function Mt(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=Math.sqrt(n*n+r*r+i*i),u=l>0?Math.atan2(l,s)/l:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=.5*Math.log(n*n+r*r+i*i+s*s),t}function Wt(t,e,n){return Mt(t,e),Ui(t,t,n),$o(t,t),t}function Se(t,e,n,r){var i=e[0],s=e[1],l=e[2],u=e[3],h=n[0],p=n[1],m=n[2],y=n[3],x,T,C,M,I;return T=i*h+s*p+l*m+u*y,T<0&&(T=-T,h=-h,p=-p,m=-m,y=-y),1-T>Mn.Ib?(x=Math.acos(T),C=Math.sin(x),M=Math.sin((1-r)*x)/C,I=Math.sin(r*x)/C):(M=1-r,I=r),t[0]=M*i+I*h,t[1]=M*s+I*p,t[2]=M*l+I*m,t[3]=M*u+I*y,t}function qe(t){var e=glMatrix.RANDOM(),n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*r),t[3]=s*Math.cos(2*Math.PI*r),t}function Rn(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s,u=l?1/l:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=s*u,t}function Pn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function tn(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[l*3+l]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+l]-e[l*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[l]=(e[l*3+i]+e[i*3+l])*r}return t}function mn(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var s=Math.sin(e),l=Math.cos(e),u=Math.sin(n),h=Math.cos(n),p=Math.sin(r),m=Math.cos(r);return t[0]=s*h*m-l*u*p,t[1]=l*u*m+s*h*p,t[2]=l*h*p-s*u*m,t[3]=l*h*m+s*u*p,t}function dr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var fr=jr.d9,ai=jr.al,Vi=jr.JG,mo=jr.t8,si=jr.IH,Wi=wo,Ui=jr.bA,Xr=jr.AK,bo=jr.t7,Ni=jr.kE,Eo=null,Xi=jr.we,Mo=null,Xo=jr.Fv,wl=jr.I6,Ya=jr.fS,ca=function(){var t=Vt.Ue(),e=Vt.al(1,0,0),n=Vt.al(0,1,0);return function(r,i,s){var l=Vt.AK(i,s);return l<-.999999?(Vt.kC(t,e,i),Vt.Zh(t)<1e-6&&Vt.kC(t,n,i),Vt.Fv(t,t),pi(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Vt.kC(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,Xo(r,r))}}(),ws=function(){var t=ni(),e=ni();return function(n,r,i,s,l,u){return Se(t,r,l,u),Se(e,i,s,u),Se(n,t,e,2*u*(1-u)),n}}(),Ms=function(){var t=zn();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],Xo(e,tn(e,t))}}(),re=it(31437),ge=it(25897);function An(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var tr=it(95147),Ei=it(95456),Si=function(t){return(0,Ei.Z)(t,"String")},uo=it(81957),Es={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Ns(t){return Array.isArray(t)&&t.every(function(e){var n=e[0].toLowerCase();return Es[n]===e.length-1&&"achlmqstvz".includes(n)})}function As(t){return Ns(t)&&t.every(function(e){var n=e[0];return n===n.toUpperCase()})}function rl(t){return As(t)&&t.every(function(e){var n=e[0];return"ACLMQZ".includes(n)})}var Xf={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Ud(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=Es[n]&&(n==="m"&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e=e==="m"?"l":"L"):t.segments.push([e].concat(r.splice(0,Es[n]))),!!Es[n]););}function md(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);if(r===48){t.param=0,t.index+=1;return}if(r===49){t.param=1,t.index+=1;return}t.err='[path-util]: invalid Arc flag "'+n[e]+'", expecting 0 or 1 at index '+e}function Dl(t){return t>=48&&t<=57||t===43||t===45||t===46}function Qc(t){return t>=48&&t<=57}function Mf(t){var e=t.max,n=t.pathValue,r=t.index,i=r,s=!1,l=!1,u=!1,h=!1,p;if(i>=e){t.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(p=n.charCodeAt(i),(p===43||p===45)&&(i+=1,p=n.charCodeAt(i)),!Qc(p)&&p!==46){t.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" is not a number';return}if(p!==46){if(s=p===48,i+=1,p=n.charCodeAt(i),s&&i<e&&p&&Qc(p)){t.err="[path-util]: Invalid path value at index "+r+', "'+n[r]+'" illegal number';return}for(;i<e&&Qc(n.charCodeAt(i));)i+=1,l=!0;p=n.charCodeAt(i)}if(p===46){for(h=!0,i+=1;Qc(n.charCodeAt(i));)i+=1,u=!0;p=n.charCodeAt(i)}if(p===101||p===69){if(h&&!l&&!u){t.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid float exponent';return}if(i+=1,p=n.charCodeAt(i),(p===43||p===45)&&(i+=1),i<e&&Qc(n.charCodeAt(i)))for(;i<e&&Qc(n.charCodeAt(i));)i+=1;else{t.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid integer exponent';return}}t.index=i,t.param=+t.pathValue.slice(r,i)}function Jc(t){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return t===10||t===13||t===8232||t===8233||t===32||t===9||t===11||t===12||t===160||t>=5760&&e.includes(t)}function Ic(t){for(var e=t.pathValue,n=t.max;t.index<n&&Jc(e.charCodeAt(t.index));)t.index+=1}function tu(t){switch(t|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function Yf(t){return(t|32)===97}function ac(t){var e=t.max,n=t.pathValue,r=t.index,i=n.charCodeAt(r),s=Es[n[r].toLowerCase()];if(t.segmentStart=r,!tu(i)){t.err='[path-util]: Invalid path value "'+n[r]+'" is not a path command';return}if(t.index+=1,Ic(t),t.data=[],!s){Ud(t);return}for(;;){for(var l=s;l>0;l-=1){if(Yf(i)&&(l===3||l===4)?md(t):Mf(t),t.err.length)return;t.data.push(t.param),Ic(t),t.index<e&&n.charCodeAt(t.index)===44&&(t.index+=1,Ic(t))}if(t.index>=t.max||!Dl(n.charCodeAt(t.index)))break}Ud(t)}var Ws=function(){function t(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return t}();function Ru(t){if(Ns(t))return[].concat(t);var e=new Ws(t);for(Ic(e);e.index<e.max&&!e.err.length;)ac(e);return e.err?e.err:e.segments}function gf(t){if(As(t))return[].concat(t);var e=Ru(t),n=0,r=0,i=0,s=0;return e.map(function(l){var u=l.slice(1).map(Number),h=l[0],p=h.toUpperCase();if(h==="M")return n=u[0],r=u[1],i=n,s=r,["M",n,r];var m;if(h!==p)switch(p){case"A":m=[p,u[0],u[1],u[2],u[3],u[4],u[5]+n,u[6]+r];break;case"V":m=[p,u[0]+r];break;case"H":m=[p,u[0]+n];break;default:{var y=u.map(function(T,C){return T+(C%2?r:n)});m=[p].concat(y)}}else m=[p].concat(u);var x=m.length;switch(p){case"Z":n=i,r=s;break;case"H":n=m[1];break;case"V":r=m[1];break;default:n=m[x-2],r=m[x-1],p==="M"&&(i=n,s=r)}return m})}function Fh(t,e){var n=t[0],r=e.x1,i=e.y1,s=e.x2,l=e.y2,u=t.slice(1).map(Number),h=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),n==="H")h=["L",t[1],i];else if(n==="V")h=["L",r,t[1]];else if(n==="S"){var p=r*2-s,m=i*2-l;e.x1=p,e.y1=m,h=["C",p,m].concat(u)}else if(n==="T"){var y=r*2-e.qx,x=i*2-e.qy;e.qx=y,e.qy=x,h=["Q",y,x].concat(u)}else if(n==="Q"){var T=u[0],C=u[1];e.qx=T,e.qy=C}return h}function Uh(t){if(rl(t))return[].concat(t);for(var e=gf(t),n=(0,F.pi)({},Xf),r=0;r<e.length;r+=1){e[r]=Fh(e[r],n);var i=e[r],s=i.length;n.x1=+i[s-2],n.y1=+i[s-1],n.x2=+i[s-4]||n.x1,n.y2=+i[s-3]||n.y1}return e}function eu(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return[r+(s-r)*n,i+(l-i)*n]}function mh(t,e,n,r,i){var s=An([t,e],[n,r]),l={x:0,y:0};if(typeof i=="number")if(i<=0)l={x:t,y:e};else if(i>=s)l={x:n,y:r};else{var u=eu([t,e],[n,r],i/s),h=u[0],p=u[1];l={x:h,y:p}}return{length:s,point:l,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function zh(t,e){var n=t.x,r=t.y,i=e.x,s=e.y,l=n*i+r*s,u=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(s,2))),h=n*s-r*i<0?-1:1,p=h*Math.acos(l/u);return p}function vd(t,e,n,r,i,s,l,u,h,p){var m=Math.abs,y=Math.sin,x=Math.cos,T=Math.sqrt,C=Math.PI,M=m(n),I=m(r),D=(i%360+360)%360,U=D*(C/180);if(t===u&&e===h)return{x:t,y:e};if(M===0||I===0)return mh(t,e,u,h,p).point;var Z=(t-u)/2,G=(e-h)/2,W={x:x(U)*Z+y(U)*G,y:-y(U)*Z+x(U)*G},$=Math.pow(W.x,2)/Math.pow(M,2)+Math.pow(W.y,2)/Math.pow(I,2);$>1&&(M*=T($),I*=T($));var J=Math.pow(M,2)*Math.pow(I,2)-Math.pow(M,2)*Math.pow(W.y,2)-Math.pow(I,2)*Math.pow(W.x,2),nt=Math.pow(M,2)*Math.pow(W.y,2)+Math.pow(I,2)*Math.pow(W.x,2),dt=J/nt;dt=dt<0?0:dt;var Et=(s!==l?1:-1)*T(dt),Pt={x:Et*(M*W.y/I),y:Et*(-(I*W.x)/M)},Ht={x:x(U)*Pt.x-y(U)*Pt.y+(t+u)/2,y:y(U)*Pt.x+x(U)*Pt.y+(e+h)/2},Ct={x:(W.x-Pt.x)/M,y:(W.y-Pt.y)/I},Ft=zh({x:1,y:0},Ct),jt={x:(-W.x-Pt.x)/M,y:(-W.y-Pt.y)/I},qt=zh(Ct,jt);!l&&qt>0?qt-=2*C:l&&qt<0&&(qt+=2*C),qt%=2*C;var Ee=Ft+qt*p,oe=M*x(Ee),_e=I*y(Ee),hn={x:x(U)*oe-y(U)*_e+Ht.x,y:y(U)*oe+x(U)*_e+Ht.y};return hn}function gd(t,e,n,r,i,s,l,u,h,p,m){var y,x=m.bbox,T=x===void 0?!0:x,C=m.length,M=C===void 0?!0:C,I=m.sampleSize,D=I===void 0?30:I,U=typeof p=="number",Z=t,G=e,W=0,$=[Z,G,W],J=[Z,G],nt=0,dt={x:0,y:0},Et=[{x:Z,y:G}];U&&p<=0&&(dt={x:Z,y:G});for(var Pt=0;Pt<=D;Pt+=1){if(nt=Pt/D,y=vd(t,e,n,r,i,s,l,u,h,nt),Z=y.x,G=y.y,T&&Et.push({x:Z,y:G}),M&&(W+=An(J,[Z,G])),J=[Z,G],U&&W>=p&&p>$[2]){var Ht=(W-p)/(W-$[2]);dt={x:J[0]*(1-Ht)+$[0]*Ht,y:J[1]*(1-Ht)+$[1]*Ht}}$=[Z,G,W]}return U&&p>=W&&(dt={x:u,y:h}),{length:W,point:dt,min:{x:Math.min.apply(null,Et.map(function(Ct){return Ct.x})),y:Math.min.apply(null,Et.map(function(Ct){return Ct.y}))},max:{x:Math.max.apply(null,Et.map(function(Ct){return Ct.x})),y:Math.max.apply(null,Et.map(function(Ct){return Ct.y}))}}}function yd(t,e,n,r,i,s,l,u,h){var p=1-h;return{x:Math.pow(p,3)*t+3*Math.pow(p,2)*h*n+3*p*Math.pow(h,2)*i+Math.pow(h,3)*l,y:Math.pow(p,3)*e+3*Math.pow(p,2)*h*r+3*p*Math.pow(h,2)*s+Math.pow(h,3)*u}}function vp(t,e,n,r,i,s,l,u,h,p){var m,y=p.bbox,x=y===void 0?!0:y,T=p.length,C=T===void 0?!0:T,M=p.sampleSize,I=M===void 0?10:M,D=typeof h=="number",U=t,Z=e,G=0,W=[U,Z,G],$=[U,Z],J=0,nt={x:0,y:0},dt=[{x:U,y:Z}];D&&h<=0&&(nt={x:U,y:Z});for(var Et=0;Et<=I;Et+=1){if(J=Et/I,m=yd(t,e,n,r,i,s,l,u,J),U=m.x,Z=m.y,x&&dt.push({x:U,y:Z}),C&&(G+=An($,[U,Z])),$=[U,Z],D&&G>=h&&h>W[2]){var Pt=(G-h)/(G-W[2]);nt={x:$[0]*(1-Pt)+W[0]*Pt,y:$[1]*(1-Pt)+W[1]*Pt}}W=[U,Z,G]}return D&&h>=G&&(nt={x:l,y:u}),{length:G,point:nt,min:{x:Math.min.apply(null,dt.map(function(Ht){return Ht.x})),y:Math.min.apply(null,dt.map(function(Ht){return Ht.y}))},max:{x:Math.max.apply(null,dt.map(function(Ht){return Ht.x})),y:Math.max.apply(null,dt.map(function(Ht){return Ht.y}))}}}function qf(t,e,n,r,i,s,l){var u=1-l;return{x:Math.pow(u,2)*t+2*u*l*n+Math.pow(l,2)*i,y:Math.pow(u,2)*e+2*u*l*r+Math.pow(l,2)*s}}function Mu(t,e,n,r,i,s,l,u){var h,p=u.bbox,m=p===void 0?!0:p,y=u.length,x=y===void 0?!0:y,T=u.sampleSize,C=T===void 0?10:T,M=typeof l=="number",I=t,D=e,U=0,Z=[I,D,U],G=[I,D],W=0,$={x:0,y:0},J=[{x:I,y:D}];M&&l<=0&&($={x:I,y:D});for(var nt=0;nt<=C;nt+=1){if(W=nt/C,h=qf(t,e,n,r,i,s,W),I=h.x,D=h.y,m&&J.push({x:I,y:D}),x&&(U+=An(G,[I,D])),G=[I,D],M&&U>=l&&l>Z[2]){var dt=(U-l)/(U-Z[2]);$={x:G[0]*(1-dt)+Z[0]*dt,y:G[1]*(1-dt)+Z[1]*dt}}Z=[I,D,U]}return M&&l>=U&&($={x:i,y:s}),{length:U,point:$,min:{x:Math.min.apply(null,J.map(function(Et){return Et.x})),y:Math.min.apply(null,J.map(function(Et){return Et.y}))},max:{x:Math.max.apply(null,J.map(function(Et){return Et.x})),y:Math.max.apply(null,J.map(function(Et){return Et.y}))}}}function _d(t,e,n){for(var r,i,s,l,u,h,p=Uh(t),m=typeof e=="number",y,x=[],T,C=0,M=0,I=0,D=0,U,Z=[],G=[],W=0,$={x:0,y:0},J=$,nt=$,dt=$,Et=0,Pt=0,Ht=p.length;Pt<Ht;Pt+=1)U=p[Pt],T=U[0],y=T==="M",x=y?x:[C,M].concat(U.slice(1)),y?(I=U[1],D=U[2],$={x:I,y:D},J=$,W=0,m&&e<.001&&(dt=$)):T==="L"?(r=mh(x[0],x[1],x[2],x[3],(e||0)-Et),W=r.length,$=r.min,J=r.max,nt=r.point):T==="A"?(i=gd(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],(e||0)-Et,n||{}),W=i.length,$=i.min,J=i.max,nt=i.point):T==="C"?(s=vp(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],(e||0)-Et,n||{}),W=s.length,$=s.min,J=s.max,nt=s.point):T==="Q"?(l=Mu(x[0],x[1],x[2],x[3],x[4],x[5],(e||0)-Et,n||{}),W=l.length,$=l.min,J=l.max,nt=l.point):T==="Z"&&(x=[C,M,I,D],u=mh(x[0],x[1],x[2],x[3],(e||0)-Et),W=u.length,$=u.min,J=u.max,nt=u.point),m&&Et<e&&Et+W>=e&&(dt=nt),G.push(J),Z.push($),Et+=W,h=T!=="Z"?U.slice(-2):[I,D],C=h[0],M=h[1];return m&&e>=Et&&(dt={x:C,y:M}),{length:Et,point:dt,min:{x:Math.min.apply(null,Z.map(function(Ct){return Ct.x})),y:Math.min.apply(null,Z.map(function(Ct){return Ct.y}))},max:{x:Math.max.apply(null,G.map(function(Ct){return Ct.x})),y:Math.max.apply(null,G.map(function(Ct){return Ct.y}))}}}function Nl(t,e){return _d(t,void 0,(0,F.pi)((0,F.pi)({},e),{bbox:!1,length:!0})).length}var Ps=function(t){return Array.isArray?Array.isArray(t):(0,Ei.Z)(t,"Array")},nu=function(t){if(Ps(t))return t.reduce(function(e,n){return Math.min(e,n)},t[0])},sc=function(t){if(Ps(t))return t.reduce(function(e,n){return Math.max(e,n)},t[0])},of=1e-5;function lc(t,e,n){return n===void 0&&(n=of),Math.abs(t-e)<n}var af=function(t,e){return(t%e+e)%e},kl=af;function Pu(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}function yf(t){return rl(t)&&t.every(function(e){var n=e[0];return"MC".includes(n)})}function vh(t,e,n){var r=t*Math.cos(n)-e*Math.sin(n),i=t*Math.sin(n)+e*Math.cos(n);return{x:r,y:i}}function $f(t,e,n,r,i,s,l,u,h,p){var m=t,y=e,x=n,T=r,C=u,M=h,I=Math.PI*120/180,D=Math.PI/180*(+i||0),U=[],Z,G,W,$,J;if(p)G=p[0],W=p[1],$=p[2],J=p[3];else{Z=vh(m,y,-D),m=Z.x,y=Z.y,Z=vh(C,M,-D),C=Z.x,M=Z.y;var nt=(m-C)/2,dt=(y-M)/2,Et=nt*nt/(x*x)+dt*dt/(T*T);Et>1&&(Et=Math.sqrt(Et),x*=Et,T*=Et);var Pt=x*x,Ht=T*T,Ct=(s===l?-1:1)*Math.sqrt(Math.abs((Pt*Ht-Pt*dt*dt-Ht*nt*nt)/(Pt*dt*dt+Ht*nt*nt)));$=Ct*x*dt/T+(m+C)/2,J=Ct*-T*nt/x+(y+M)/2,G=Math.asin(((y-J)/T*Math.pow(10,9)>>0)/Math.pow(10,9)),W=Math.asin(((M-J)/T*Math.pow(10,9)>>0)/Math.pow(10,9)),G=m<$?Math.PI-G:G,W=C<$?Math.PI-W:W,G<0&&(G=Math.PI*2+G),W<0&&(W=Math.PI*2+W),l&&G>W&&(G-=Math.PI*2),!l&&W>G&&(W-=Math.PI*2)}var Ft=W-G;if(Math.abs(Ft)>I){var jt=W,qt=C,Ee=M;W=G+I*(l&&W>G?1:-1),C=$+x*Math.cos(W),M=J+T*Math.sin(W),U=$f(C,M,x,T,i,0,l,qt,Ee,[W,jt,$,J])}Ft=W-G;var oe=Math.cos(G),_e=Math.sin(G),hn=Math.cos(W),Dn=Math.sin(W),Kn=Math.tan(Ft/4),Jn=4/3*x*Kn,zr=4/3*T*Kn,ui=[m,y],Ki=[m+Jn*_e,y-zr*oe],Qr=[C+Jn*Dn,M-zr*hn],Kr=[C,M];if(Ki[0]=2*ui[0]-Ki[0],Ki[1]=2*ui[1]-Ki[1],p)return Ki.concat(Qr,Kr,U);U=Ki.concat(Qr,Kr,U);for(var Co=[],Qi=0,ji=U.length;Qi<ji;Qi+=1)Co[Qi]=Qi%2?vh(U[Qi-1],U[Qi],D).y:vh(U[Qi],U[Qi+1],D).x;return Co}function us(t,e,n,r,i,s){var l=.3333333333333333,u=2/3;return[l*t+u*n,l*e+u*r,l*i+u*n,l*s+u*r,i,s]}var jh=function(t,e,n,r){var i=.5,s=eu([t,e],[n,r],i);return(0,F.ev)((0,F.ev)([],s,!0),[n,r,n,r],!1)};function Vh(t,e){var n=t[0],r=t.slice(1).map(Number),i=r[0],s=r[1],l,u=e.x1,h=e.y1,p=e.x,m=e.y;switch("TQ".includes(n)||(e.qx=null,e.qy=null),n){case"M":return e.x=i,e.y=s,t;case"A":return l=[u,h].concat(r),["C"].concat($f(l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9]));case"Q":return e.qx=i,e.qy=s,l=[u,h].concat(r),["C"].concat(us(l[0],l[1],l[2],l[3],l[4],l[5]));case"L":return["C"].concat(jh(u,h,i,s));case"Z":return u===p&&h===m?["C",u,h,p,m,p,m]:["C"].concat(jh(u,h,p,m));default:}return t}function gh(t,e){if(e===void 0&&(e=!1),yf(t)){var n=[].concat(t);return e?[n,[]]:n}for(var r=Uh(t),i=(0,F.pi)({},Xf),s=[],l="",u=r.length,h,p,m=[],y=0;y<u;y+=1){r[y]&&(l=r[y][0]),s[y]=l;var x=Vh(r[y],i);r[y]=x,Pu(r,s,y),u=r.length,l==="Z"&&m.push(y),h=r[y],p=h.length,i.x1=+h[p-2],i.y1=+h[p-1],i.x2=+h[p-4]||i.x1,i.y2=+h[p-3]||i.y1}return e?[r,m]:r}function il(t,e){e===void 0&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),s=t.slice(6,8),l=eu(n,r,e),u=eu(r,i,e),h=eu(i,s,e),p=eu(l,u,e),m=eu(u,h,e),y=eu(p,m,e);return[["C"].concat(l,p,y),["C"].concat(m,h,s)]}function Kf(t){return t.map(function(e,n,r){var i=n&&r[n-1].slice(-2).concat(e.slice(1)),s=n?vp(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,l;return n?l=s?il(i):[e,e]:l=[e],{s:e,ss:l,l:s}})}function Qf(t,e,n){var r=Kf(t),i=Kf(e),s=r.length,l=i.length,u=r.filter(function(I){return I.l}).length,h=i.filter(function(I){return I.l}).length,p=r.filter(function(I){return I.l}).reduce(function(I,D){var U=D.l;return I+U},0)/u||0,m=i.filter(function(I){return I.l}).reduce(function(I,D){var U=D.l;return I+U},0)/h||0,y=n||Math.max(s,l),x=[p,m],T=[y-s,y-l],C=0,M=[r,i].map(function(I,D){return I.l===y?I.map(function(U){return U.s}):I.map(function(U,Z){return C=Z&&T[D]&&U.l>=x[D],T[D]-=C?1:0,C?U.ss:[U.s]}).flat()});return M[0].length===M[1].length?M:Qf(M[0],M[1],y)}function K(t,e,n,r,i,s,l,u){return 3*((u-e)*(n+i)-(l-t)*(r+s)+r*(t-i)-n*(e-s)+u*(i+t/3)-l*(s+e/3))/20}function lt(t){var e=0,n=0,r=0;return gh(t).map(function(i){var s;switch(i[0]){case"M":return e=i[1],n=i[2],0;default:var l=i.slice(1),u=l[0],h=l[1],p=l[2],m=l[3],y=l[4],x=l[5];return r=K(e,n,u,h,p,m,y,x),s=i.slice(-2),e=s[0],n=s[1],r}}).reduce(function(i,s){return i+s},0)}function It(t){return lt(t)>=0}function Ke(t){var e=t.slice(1).map(function(n,r,i){return r?i[r-1].slice(-2).concat(n.slice(1)):t[0].slice(1).concat(n.slice(1))}).map(function(n){return n.map(function(r,i){return n[n.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(n){return["C"].concat(n.slice(2))}))}function X(t){return t.map(function(e){return Array.isArray(e)?[].concat(e):e})}function Xn(t){var e=t.length,n=e-1;return t.map(function(r,i){return t.map(function(s,l){var u=i+l,h;return l===0||t[u]&&t[u][0]==="M"?(h=t[u],["M"].concat(h.slice(-2))):(u>=e&&(u-=n),t[u])})})}function Mr(t,e){var n=t.length-1,r=[],i=0,s=0,l=Xn(t);return l.forEach(function(u,h){t.slice(1).forEach(function(p,m){s+=An(t[(h+m)%n].slice(-2),e[m%n].slice(-2))}),r[h]=s,s=0}),i=r.indexOf(Math.min.apply(null,r)),l[i]}var ki=function(t){return t===void 0},Jr=ki,co=function(t){return(0,Ei.Z)(t,"Boolean")},so=co,sa=function(t){var e=typeof t;return t!==null&&e==="object"||e==="function"};function Po(t,e,n){return _d(t,e,(0,F.pi)((0,F.pi)({},n),{bbox:!1,length:!0})).point}function _a(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function qa(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ra(){}var ma=.7,ls=1/ma,Aa="\\s*([+-]?\\d+)\\s*",Ia="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ka="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qs=/^#([0-9a-f]{3,8})$/,ks=new RegExp("^rgb\\(".concat(Aa,",").concat(Aa,",").concat(Aa,"\\)$")),Ec=new RegExp("^rgb\\(".concat(ka,",").concat(ka,",").concat(ka,"\\)$")),es=new RegExp("^rgba\\(".concat(Aa,",").concat(Aa,",").concat(Aa,",").concat(Ia,"\\)$")),Iu=new RegExp("^rgba\\(".concat(ka,",").concat(ka,",").concat(ka,",").concat(Ia,"\\)$")),du=new RegExp("^hsl\\(".concat(Ia,",").concat(ka,",").concat(ka,"\\)$")),Lc=new RegExp("^hsla\\(".concat(Ia,",").concat(ka,",").concat(ka,",").concat(Ia,"\\)$")),Pf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_a(ra,Lf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Zh,formatHex:Zh,formatHex8:Hh,formatHsl:If,formatRgb:Lu,toString:Lu});function Zh(){return this.rgb().formatHex()}function Hh(){return this.rgb().formatHex8()}function If(){return Yp(this).formatHsl()}function Lu(){return this.rgb().formatRgb()}function Lf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qs.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?yh(e):n===3?new Dc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Du(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Du(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ks.exec(t))?new Dc(e[1],e[2],e[3],1):(e=Ec.exec(t))?new Dc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=es.exec(t))?Du(e[1],e[2],e[3],e[4]):(e=Iu.exec(t))?Du(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=du.exec(t))?Jf(e[1],e[2]/100,e[3]/100,1):(e=Lc.exec(t))?Jf(e[1],e[2]/100,e[3]/100,e[4]):Pf.hasOwnProperty(t)?yh(Pf[t]):t==="transparent"?new Dc(NaN,NaN,NaN,0):null}function yh(t){return new Dc(t>>16&255,t>>8&255,t&255,1)}function Du(t,e,n,r){return r<=0&&(t=e=n=NaN),new Dc(t,e,n,r)}function P0(t){return t instanceof ra||(t=Lf(t)),t?(t=t.rgb(),new Dc(t.r,t.g,t.b,t.opacity)):new Dc}function xd(t,e,n,r){return arguments.length===1?P0(t):new Dc(t,e,n,r==null?1:r)}function Dc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}_a(Dc,xd,qa(ra,{brighter:function(e){return e=e==null?ls:Math.pow(ls,e),new Dc(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ma:Math.pow(ma,e),new Dc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new Dc(Nu(this.r),Nu(this.g),Nu(this.b),_h(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gh,formatHex:Gh,formatHex8:gp,formatRgb:Wh,toString:Wh}));function Gh(){return"#".concat(Df(this.r)).concat(Df(this.g)).concat(Df(this.b))}function gp(){return"#".concat(Df(this.r)).concat(Df(this.g)).concat(Df(this.b)).concat(Df((isNaN(this.opacity)?1:this.opacity)*255))}function Wh(){var t=_h(this.opacity);return"".concat(t===1?"rgb(":"rgba(").concat(Nu(this.r),", ").concat(Nu(this.g),", ").concat(Nu(this.b)).concat(t===1?")":", ".concat(t,")"))}function _h(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Nu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Df(t){return t=Nu(t),(t<16?"0":"")+t.toString(16)}function Jf(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $a(t,e,n,r)}function Yp(t){if(t instanceof $a)return new $a(t.h,t.s,t.l,t.opacity);if(t instanceof ra||(t=Lf(t)),!t)return new $a;if(t instanceof $a)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(e===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-e)/u+2:l=(e-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new $a(l,u,h,t.opacity)}function Nf(t,e,n,r){return arguments.length===1?Yp(t):new $a(t,e,n,r==null?1:r)}function $a(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}_a($a,Nf,qa(ra,{brighter:function(e){return e=e==null?ls:Math.pow(ls,e),new $a(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ma:Math.pow(ma,e),new $a(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new Dc(tt(e>=240?e-240:e+120,s,i),tt(e,s,i),tt(e<120?e+240:e-120,s,i),this.opacity)},clamp:function(){return new $a(bd(this.h),pu(this.s),pu(this.l),_h(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=_h(this.opacity);return"".concat(e===1?"hsl(":"hsla(").concat(bd(this.h),", ").concat(pu(this.s)*100,"%, ").concat(pu(this.l)*100,"%").concat(e===1?")":", ".concat(e,")"))}}));function bd(t){return t=(t||0)%360,t<0?t+360:t}function pu(t){return Math.max(0,Math.min(1,t||0))}function tt(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function mt(t,e,n,r){var i=t-n,s=e-r;return Math.sqrt(i*i+s*s)}function Xt(t,e){var n=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(t),!1)),r=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(e),!1)),i=Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(t),!1)),s=Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(e),!1));return{x:n,y:r,width:i-n,height:s-r}}function dn(t){return(t+Math.PI*2)%(Math.PI*2)}function nr(t,e){var n=Math.abs(t);return e>0?n:n*-1}function Br(t,e,n,r,i,s){var l=n,u=r;if(l===0||u===0)return{x:t,y:e};for(var h=i-t,p=s-e,m=Math.abs(h),y=Math.abs(p),x=l*l,T=u*u,C=Math.PI/4,M=0,I=0,D=0;D<4;D++){M=l*Math.cos(C),I=u*Math.sin(C);var U=(x-T)*Math.pow(Math.cos(C),3)/l,Z=(T-x)*Math.pow(Math.sin(C),3)/u,G=M-U,W=I-Z,$=m-U,J=y-Z,nt=Math.hypot(W,G),dt=Math.hypot(J,$),Et=nt*Math.asin((G*J-W*$)/(nt*dt)),Pt=Et/Math.sqrt(x+T-M*M-I*I);C+=Pt,C=Math.min(Math.PI/2,Math.max(0,C))}return{x:t+nr(M,h),y:e+nr(I,p)}}function vi(t,e,n,r,i,s,l,u){return-1*n*Math.cos(i)*Math.sin(u)-r*Math.sin(i)*Math.cos(u)}function qi(t,e,n,r,i,s,l,u){return-1*n*Math.sin(i)*Math.sin(u)+r*Math.cos(i)*Math.cos(u)}function da(t,e,n){return Math.atan(-e/t*Math.tan(n))}function xa(t,e,n){return Math.atan(e/(t*Math.tan(n)))}function ms(t,e,n,r,i,s){return n*Math.cos(i)*Math.cos(s)-r*Math.sin(i)*Math.sin(s)+t}function Fa(t,e,n,r,i,s){return n*Math.sin(i)*Math.cos(s)+r*Math.cos(i)*Math.sin(s)+e}function Ba(t,e,n,r){var i=Math.atan2(r*t,n*e);return(i+Math.PI*2)%(Math.PI*2)}function cc(t,e,n){return{x:t*Math.cos(n),y:e*Math.sin(n)}}function ku(t,e,n){var r=Math.cos(n),i=Math.sin(n);return[t*r-e*i,t*i+e*r]}function $s(t,e,n,r,i,s,l){for(var u=da(n,r,i),h=1/0,p=-1/0,m=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var x=u+y;s<l?s<x&&x<l&&m.push(x):l<x&&x<s&&m.push(x)}for(var y=0;y<m.length;y++){var T=ms(t,e,n,r,i,m[y]);T<h&&(h=T),T>p&&(p=T)}for(var C=xa(n,r,i),M=1/0,I=-1/0,D=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var U=C+y;s<l?s<U&&U<l&&D.push(U):l<U&&U<s&&D.push(U)}for(var y=0;y<D.length;y++){var Z=Fa(t,e,n,r,i,D[y]);Z<M&&(M=Z),Z>I&&(I=Z)}return{x:h,y:M,width:p-h,height:I-M}}function fo(t,e,n,r,i,s,l,u,h){var p=ku(u-t,h-e,-i),m=__read(p,2),y=m[0],x=m[1],T=Br(0,0,n,r,y,x),C=Ba(n,r,T.x,T.y);C<s?T=cc(n,r,s):C>l&&(T=cc(n,r,l));var M=ku(T.x,T.y,i);return{x:M[0]+t,y:M[1]+e}}function ru(t,e,n,r,i,s,l,u){var h=(l-s)*u+s,p=vi(t,e,n,r,i,s,l,h),m=qi(t,e,n,r,i,s,l,h);return dn(Math.atan2(m,p))}var Ed=1e-4;function th(t,e,n,r,i,s){var l=-1,u=1/0,h=[n,r],p=20;s&&s>200&&(p=s/10);for(var m=1/p,y=m/10,x=0;x<=p;x++){var T=x*m,C=[i.apply(void 0,(0,F.ev)([],(0,F.CR)(t.concat([T])),!1)),i.apply(void 0,(0,F.ev)([],(0,F.CR)(e.concat([T])),!1))],M=mt(h[0],h[1],C[0],C[1]);M<u&&(l=T,u=M)}if(l===0)return{x:t[0],y:e[0]};if(l===1){var I=t.length;return{x:t[I-1],y:e[I-1]}}u=1/0;for(var x=0;x<32&&!(y<Ed);x++){var D=l-y,U=l+y,C=[i.apply(void 0,(0,F.ev)([],(0,F.CR)(t.concat([D])),!1)),i.apply(void 0,(0,F.ev)([],(0,F.CR)(e.concat([D])),!1))],M=mt(h[0],h[1],C[0],C[1]);if(D>=0&&M<u)l=D,u=M;else{var Z=[i.apply(void 0,(0,F.ev)([],(0,F.CR)(t.concat([U])),!1)),i.apply(void 0,(0,F.ev)([],(0,F.CR)(e.concat([U])),!1))],G=mt(h[0],h[1],Z[0],Z[1]);U<=1&&G<u?(l=U,u=G):y*=.5}}return{x:i.apply(void 0,(0,F.ev)([],(0,F.CR)(t.concat([l])),!1)),y:i.apply(void 0,(0,F.ev)([],(0,F.CR)(e.concat([l])),!1))}}function pl(t,e){for(var n=0,r=t.length,i=0;i<r;i++){var s=t[i],l=e[i],u=t[(i+1)%r],h=e[(i+1)%r];n+=mt(s,l,u,h)}return n/2}function ns(t,e,n,r){return Xt([t,n],[e,r])}function yp(t,e,n,r){return mt(t,e,n,r)}function Ri(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}}function eh(t,e,n,r,i,s){var l=(n-t)*(i-t)+(r-e)*(s-e);if(l<0)return mt(t,e,i,s);var u=(n-t)*(n-t)+(r-e)*(r-e);return l>u?mt(n,r,i,s):Sd(t,e,n,r,i,s)}function Sd(t,e,n,r,i,s){var l=[n-t,r-e];if(re.I6(l,[0,0]))return Math.sqrt((i-t)*(i-t)+(s-e)*(s-e));var u=[-l[1],l[0]];re.Fv(u,u);var h=[i-t,s-e];return Math.abs(re.AK(h,u))}function qp(t,e,n,r){return Math.atan2(r-e,n-t)}function Nc(t,e,n,r,i){var s=1-i;return s*s*s*t+3*e*i*s*s+3*n*i*i*s+r*i*i*i}function mu(t,e,n,r,i){var s=1-i;return 3*(s*s*(e-t)+2*s*i*(n-e)+i*i*(r-n))}function _p(t,e,n,r){var i=-3*t+9*e-9*n+3*r,s=6*t-12*e+6*n,l=3*e-3*t,u=[],h,p,m;if(lc(i,0))lc(s,0)||(h=-l/s,h>=0&&h<=1&&u.push(h));else{var y=s*s-4*i*l;lc(y,0)?u.push(-s/(2*i)):y>0&&(m=Math.sqrt(y),h=(-s+m)/(2*i),p=(-s-m)/(2*i),h>=0&&h<=1&&u.push(h),p>=0&&p<=1&&u.push(p))}return u}function $p(t,e,n,r,i,s,l,u,h){var p=Nc(t,n,i,l,h),m=Nc(e,r,s,u,h),y=Ri(t,e,n,r,h),x=Ri(n,r,i,s,h),T=Ri(i,s,l,u,h),C=Ri(y.x,y.y,x.x,x.y,h),M=Ri(x.x,x.y,T.x,T.y,h);return[[t,e,y.x,y.y,C.x,C.y,p,m],[p,m,M.x,M.y,T.x,T.y,l,u]]}function kc(t,e,n,r,i,s,l,u,h){if(h===0)return pl([t,n,i,l],[e,r,s,u]);var p=$p(t,e,n,r,i,s,l,u,.5),m=__spreadArray(__spreadArray([],__read(p[0]),!1),[h-1],!1),y=__spreadArray(__spreadArray([],__read(p[1]),!1),[h-1],!1);return kc.apply(void 0,__spreadArray([],__read(m),!1))+kc.apply(void 0,__spreadArray([],__read(y),!1))}function nh(t,e,n,r,i,s,l,u){for(var h=[t,l],p=[e,u],m=_p(t,n,i,l),y=_p(e,r,s,u),x=0;x<m.length;x++)h.push(Nc(t,n,i,l,m[x]));for(var x=0;x<y.length;x++)p.push(Nc(e,r,s,u,y[x]));return Xt(h,p)}function Jm(t,e,n,r,i,s,l,u){return kc(t,e,n,r,i,s,l,u,3)}function Td(t,e,n,r,i,s,l,u,h,p,m){return th([t,n,i,l],[e,r,s,u],h,p,Nc,m)}function xp(t,e,n,r,i,s,l,u,h,p,m){var y=Td(t,e,n,r,i,s,l,u,h,p,m);return mt(y.x,y.y,h,p)}function sm(t,e,n,r,i,s,l,u,h){return{x:Nc(t,n,i,l,h),y:Nc(e,r,s,u,h)}}function Bu(t,e,n,r,i,s,l,u,h){var p=mu(t,n,i,l,h),m=mu(e,r,s,u,h);return dn(Math.atan2(m,p))}function vu(t){for(var e=0,n=[],r=0;r<t.length-1;r++){var i=t[r],s=t[r+1],l=mt(i[0],i[1],s[0],s[1]),u={from:i,to:s,length:l};n.push(u),e+=l}return{segments:n,totalLength:e}}function va(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=mt(r[0],r[1],i[0],i[1])}return e}function Fu(t,e){if(e>1||e<0||t.length<2)return null;var n=vu(t),r=n.segments,i=n.totalLength;if(i===0)return{x:t[0][0],y:t[0][1]};for(var s=0,l=null,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(e>=s&&e<=s+y){var x=(e-s)/y;l=Ri(p[0],p[1],m[0],m[1],x);break}s+=y}return l}function Uu(t,e){if(e>1||e<0||t.length<2)return 0;for(var n=vu(t),r=n.segments,i=n.totalLength,s=0,l=0,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(e>=s&&e<=s+y){l=Math.atan2(m[1]-p[1],m[0]-p[0]);break}s+=y}return l}function uc(t,e,n){for(var r=1/0,i=0;i<t.length-1;i++){var s=t[i],l=t[i+1],u=eh(s[0],s[1],l[0],l[1],e,n);u<r&&(r=u)}return r}function Xh(t){for(var e=[],n=[],r=0;r<t.length;r++){var i=t[r];e.push(i[0]),n.push(i[1])}return Xt(e,n)}function Gl(t){return va(t)}function Gc(t,e){return Fu(t,e)}function iu(t,e,n){return uc(t,e,n)}function bp(t,e){return Uu(t,e)}function Ao(t){var e=t.slice(0);return t.length&&e.push(t[0]),e}function xo(t){return Xh(t)}function zu(t){return va(Ao(t))}function ou(t,e){return Fu(Ao(t),e)}function rh(t,e,n){return uc(Ao(t),e,n)}function ul(t,e){return Uu(Ao(t),e)}function Wc(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function kf(t,e,n){var r=t+n-2*e;if(lc(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function wd(t,e,n,r,i,s,l){var u=Wc(t,n,i,l),h=Wc(e,r,s,l),p=Ri(t,e,n,r,l),m=Ri(n,r,i,s,l);return[[t,e,p.x,p.y,u,h],[u,h,m.x,m.y,i,s]]}function fs(t,e,n,r,i,s,l){if(l===0)return(mt(t,e,n,r)+mt(n,r,i,s)+mt(t,e,i,s))/2;var u=wd(t,e,n,r,i,s,.5),h=u[0],p=u[1];return h.push(l-1),p.push(l-1),fs.apply(void 0,__spreadArray([],__read(h),!1))+fs.apply(void 0,__spreadArray([],__read(p),!1))}function fc(t,e,n,r,i,s){var l=kf(t,n,i)[0],u=kf(e,r,s)[0],h=[t,i],p=[e,s];return l!==void 0&&h.push(Wc(t,n,i,l)),u!==void 0&&p.push(Wc(e,r,s,u)),Xt(h,p)}function I0(t,e,n,r,i,s){return fs(t,e,n,r,i,s,3)}function Yh(t,e,n,r,i,s,l,u){return th([t,n,i],[e,r,s],l,u,Wc)}function Kp(t,e,n,r,i,s,l,u){var h=Yh(t,e,n,r,i,s,l,u);return mt(h.x,h.y,l,u)}var xh=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof it.g!="undefined"?it.g:typeof self!="undefined"?self:{},au={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(xh,function(){function n(W,$,J,nt,dt){r(W,$,J||0,nt||W.length-1,dt||s)}function r(W,$,J,nt,dt){for(;nt>J;){if(nt-J>600){var Et=nt-J+1,Pt=$-J+1,Ht=Math.log(Et),Ct=.5*Math.exp(2*Ht/3),Ft=.5*Math.sqrt(Ht*Ct*(Et-Ct)/Et)*(Pt-Et/2<0?-1:1),jt=Math.max(J,Math.floor($-Pt*Ct/Et+Ft)),qt=Math.min(nt,Math.floor($+(Et-Pt)*Ct/Et+Ft));r(W,$,jt,qt,dt)}var Ee=W[$],oe=J,_e=nt;for(i(W,J,$),dt(W[nt],Ee)>0&&i(W,J,nt);oe<_e;){for(i(W,oe,_e),oe++,_e--;dt(W[oe],Ee)<0;)oe++;for(;dt(W[_e],Ee)>0;)_e--}dt(W[J],Ee)===0?i(W,J,_e):(_e++,i(W,_e,nt)),_e<=$&&(J=_e+1),$<=_e&&(nt=_e-1)}}function i(W,$,J){var nt=W[$];W[$]=W[J],W[J]=nt}function s(W,$){return W<$?-1:W>$?1:0}var l=function($){$===void 0&&($=9),this._maxEntries=Math.max(4,$),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function($){var J=this.data,nt=[];if(!U($,J))return nt;for(var dt=this.toBBox,Et=[];J;){for(var Pt=0;Pt<J.children.length;Pt++){var Ht=J.children[Pt],Ct=J.leaf?dt(Ht):Ht;U($,Ct)&&(J.leaf?nt.push(Ht):D($,Ct)?this._all(Ht,nt):Et.push(Ht))}J=Et.pop()}return nt},l.prototype.collides=function($){var J=this.data;if(!U($,J))return!1;for(var nt=[];J;){for(var dt=0;dt<J.children.length;dt++){var Et=J.children[dt],Pt=J.leaf?this.toBBox(Et):Et;if(U($,Pt)){if(J.leaf||D($,Pt))return!0;nt.push(Et)}}J=nt.pop()}return!1},l.prototype.load=function($){if(!($&&$.length))return this;if($.length<this._minEntries){for(var J=0;J<$.length;J++)this.insert($[J]);return this}var nt=this._build($.slice(),0,$.length-1,0);if(!this.data.children.length)this.data=nt;else if(this.data.height===nt.height)this._splitRoot(this.data,nt);else{if(this.data.height<nt.height){var dt=this.data;this.data=nt,nt=dt}this._insert(nt,this.data.height-nt.height-1,!0)}return this},l.prototype.insert=function($){return $&&this._insert($,this.data.height-1),this},l.prototype.clear=function(){return this.data=Z([]),this},l.prototype.remove=function($,J){if(!$)return this;for(var nt=this.data,dt=this.toBBox($),Et=[],Pt=[],Ht,Ct,Ft;nt||Et.length;){if(nt||(nt=Et.pop(),Ct=Et[Et.length-1],Ht=Pt.pop(),Ft=!0),nt.leaf){var jt=u($,nt.children,J);if(jt!==-1)return nt.children.splice(jt,1),Et.push(nt),this._condense(Et),this}!Ft&&!nt.leaf&&D(nt,dt)?(Et.push(nt),Pt.push(Ht),Ht=0,Ct=nt,nt=nt.children[0]):Ct?(Ht++,nt=Ct.children[Ht],Ft=!1):nt=null}return this},l.prototype.toBBox=function($){return $},l.prototype.compareMinX=function($,J){return $.minX-J.minX},l.prototype.compareMinY=function($,J){return $.minY-J.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function($){return this.data=$,this},l.prototype._all=function($,J){for(var nt=[];$;)$.leaf?J.push.apply(J,$.children):nt.push.apply(nt,$.children),$=nt.pop();return J},l.prototype._build=function($,J,nt,dt){var Et=nt-J+1,Pt=this._maxEntries,Ht;if(Et<=Pt)return Ht=Z($.slice(J,nt+1)),h(Ht,this.toBBox),Ht;dt||(dt=Math.ceil(Math.log(Et)/Math.log(Pt)),Pt=Math.ceil(Et/Math.pow(Pt,dt-1))),Ht=Z([]),Ht.leaf=!1,Ht.height=dt;var Ct=Math.ceil(Et/Pt),Ft=Ct*Math.ceil(Math.sqrt(Pt));G($,J,nt,Ft,this.compareMinX);for(var jt=J;jt<=nt;jt+=Ft){var qt=Math.min(jt+Ft-1,nt);G($,jt,qt,Ct,this.compareMinY);for(var Ee=jt;Ee<=qt;Ee+=Ct){var oe=Math.min(Ee+Ct-1,qt);Ht.children.push(this._build($,Ee,oe,dt-1))}}return h(Ht,this.toBBox),Ht},l.prototype._chooseSubtree=function($,J,nt,dt){for(;dt.push(J),!(J.leaf||dt.length-1===nt);){for(var Et=1/0,Pt=1/0,Ht=void 0,Ct=0;Ct<J.children.length;Ct++){var Ft=J.children[Ct],jt=T(Ft),qt=M($,Ft)-jt;qt<Pt?(Pt=qt,Et=jt<Et?jt:Et,Ht=Ft):qt===Pt&&jt<Et&&(Et=jt,Ht=Ft)}J=Ht||J.children[0]}return J},l.prototype._insert=function($,J,nt){var dt=nt?$:this.toBBox($),Et=[],Pt=this._chooseSubtree(dt,this.data,J,Et);for(Pt.children.push($),m(Pt,dt);J>=0&&Et[J].children.length>this._maxEntries;)this._split(Et,J),J--;this._adjustParentBBoxes(dt,Et,J)},l.prototype._split=function($,J){var nt=$[J],dt=nt.children.length,Et=this._minEntries;this._chooseSplitAxis(nt,Et,dt);var Pt=this._chooseSplitIndex(nt,Et,dt),Ht=Z(nt.children.splice(Pt,nt.children.length-Pt));Ht.height=nt.height,Ht.leaf=nt.leaf,h(nt,this.toBBox),h(Ht,this.toBBox),J?$[J-1].children.push(Ht):this._splitRoot(nt,Ht)},l.prototype._splitRoot=function($,J){this.data=Z([$,J]),this.data.height=$.height+1,this.data.leaf=!1,h(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function($,J,nt){for(var dt,Et=1/0,Pt=1/0,Ht=J;Ht<=nt-J;Ht++){var Ct=p($,0,Ht,this.toBBox),Ft=p($,Ht,nt,this.toBBox),jt=I(Ct,Ft),qt=T(Ct)+T(Ft);jt<Et?(Et=jt,dt=Ht,Pt=qt<Pt?qt:Pt):jt===Et&&qt<Pt&&(Pt=qt,dt=Ht)}return dt||nt-J},l.prototype._chooseSplitAxis=function($,J,nt){var dt=$.leaf?this.compareMinX:y,Et=$.leaf?this.compareMinY:x,Pt=this._allDistMargin($,J,nt,dt),Ht=this._allDistMargin($,J,nt,Et);Pt<Ht&&$.children.sort(dt)},l.prototype._allDistMargin=function($,J,nt,dt){$.children.sort(dt);for(var Et=this.toBBox,Pt=p($,0,J,Et),Ht=p($,nt-J,nt,Et),Ct=C(Pt)+C(Ht),Ft=J;Ft<nt-J;Ft++){var jt=$.children[Ft];m(Pt,$.leaf?Et(jt):jt),Ct+=C(Pt)}for(var qt=nt-J-1;qt>=J;qt--){var Ee=$.children[qt];m(Ht,$.leaf?Et(Ee):Ee),Ct+=C(Ht)}return Ct},l.prototype._adjustParentBBoxes=function($,J,nt){for(var dt=nt;dt>=0;dt--)m(J[dt],$)},l.prototype._condense=function($){for(var J=$.length-1,nt=void 0;J>=0;J--)$[J].children.length===0?J>0?(nt=$[J-1].children,nt.splice(nt.indexOf($[J]),1)):this.clear():h($[J],this.toBBox)};function u(W,$,J){if(!J)return $.indexOf(W);for(var nt=0;nt<$.length;nt++)if(J(W,$[nt]))return nt;return-1}function h(W,$){p(W,0,W.children.length,$,W)}function p(W,$,J,nt,dt){dt||(dt=Z(null)),dt.minX=1/0,dt.minY=1/0,dt.maxX=-1/0,dt.maxY=-1/0;for(var Et=$;Et<J;Et++){var Pt=W.children[Et];m(dt,W.leaf?nt(Pt):Pt)}return dt}function m(W,$){return W.minX=Math.min(W.minX,$.minX),W.minY=Math.min(W.minY,$.minY),W.maxX=Math.max(W.maxX,$.maxX),W.maxY=Math.max(W.maxY,$.maxY),W}function y(W,$){return W.minX-$.minX}function x(W,$){return W.minY-$.minY}function T(W){return(W.maxX-W.minX)*(W.maxY-W.minY)}function C(W){return W.maxX-W.minX+(W.maxY-W.minY)}function M(W,$){return(Math.max($.maxX,W.maxX)-Math.min($.minX,W.minX))*(Math.max($.maxY,W.maxY)-Math.min($.minY,W.minY))}function I(W,$){var J=Math.max(W.minX,$.minX),nt=Math.max(W.minY,$.minY),dt=Math.min(W.maxX,$.maxX),Et=Math.min(W.maxY,$.maxY);return Math.max(0,dt-J)*Math.max(0,Et-nt)}function D(W,$){return W.minX<=$.minX&&W.minY<=$.minY&&$.maxX<=W.maxX&&$.maxY<=W.maxY}function U(W,$){return $.minX<=W.maxX&&$.minY<=W.maxY&&$.maxX>=W.minX&&$.maxY>=W.minY}function Z(W){return{children:W,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function G(W,$,J,nt,dt){for(var Et=[$,J];Et.length;)if(J=Et.pop(),$=Et.pop(),!(J-$<=nt)){var Pt=$+Math.ceil((J-$)/nt/2)*nt;n(W,Pt,$,J,dt),Et.push($,Pt,Pt,J)}}return l})})(au);var zd=au.exports,Gr;(function(t){t.GROUP="g",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh"})(Gr||(Gr={}));var ih;(function(t){t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(ih||(ih={}));var Xc=function(){function t(){this.plugins=[]}return t.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},t.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(n){var r=e.context.renderingPlugins.indexOf(n);r>=0&&e.context.renderingPlugins.splice(r,1)})},t}(),jd=function(){function t(e){this.clipSpaceNearZ=ih.NEGATIVE_ONE,this.plugins=[],this.config=(0,F.pi)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return t.prototype.registerPlugin=function(e){var n=this.plugins.findIndex(function(r){return r===e});n===-1&&this.plugins.push(e)},t.prototype.unregisterPlugin=function(e){var n=this.plugins.findIndex(function(r){return r===e});n>-1&&this.plugins.splice(n,1)},t.prototype.getPlugins=function(){return this.plugins},t.prototype.getPlugin=function(e){return this.plugins.find(function(n){return n.name===e})},t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(e){Object.assign(this.config,e)},t}();function bh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function oh(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ah(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Qp(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function sh(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Bf(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Eh(t){return t===void 0?0:t>360||t<-360?t%360:t}function Al(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=0),Array.isArray(t)&&t.length===3?Vt.d9(t):(0,ge.Z)(t)?Vt.al(t,e,n):Vt.al(t[0],t[1]||e,t[2]||n)}function Qa(t){return t*(Math.PI/180)}function ju(t){return t*(180/Math.PI)}function Jp(t){return t=t%400,t<0&&(t+=400),t/400*360}function L0(t){return t/360}function t0(t){return 360*t}function _(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n,u=r*r,h=i*i,p=s*s,m=l+u+h+p,y=n*s-r*i;return y>.499995*m?(t[0]=Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):y<-.499995*m?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-s*r)),t[1]=Math.atan2(2*(n*s+r*i),1-2*(h+p)),t[2]=Math.atan2(2*(n*r+i*s),1-2*(u+h))),t}function E(t,e){var n,r,i=Math.PI*.5,s=(0,F.CR)(ae.getScaling(Vt.Ue(),e),3),l=s[0],u=s[1],h=s[2],p=Math.asin(-e[2]/l);return p<i?p>-i?(n=Math.atan2(e[6]/u,e[10]/h),r=Math.atan2(e[1]/l,e[0]/l)):(r=0,n=-Math.atan2(e[4]/u,e[5]/u)):(r=0,n=Math.atan2(e[4]/u,e[5]/u)),t[0]=n,t[1]=p,t[2]=r,t}function b(t,e){return e.length===16?E(t,e):_(t,e)}function A(t,e,n,r,i){var s=Math.cos(t),l=Math.sin(t);return Ce(r*s,i*l,0,-r*l,i*s,0,e,n,1)}function B(t,e,n,r,i,s,l,u){u===void 0&&(u=!1);var h=2*s/(n-e),p=2*s/(r-i),m=(n+e)/(n-e),y=(r+i)/(r-i),x,T;return u?(x=-l/(l-s),T=-l*s/(l-s)):(x=-(l+s)/(l-s),T=-2*l*s/(l-s)),t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=m,t[9]=y,t[10]=x,t[11]=-1,t[12]=0,t[13]=0,t[14]=T,t[15]=0,t}function H(t){var e=t[0],n=t[1],r=t[3],i=t[4],s=Math.sqrt(e*e+n*n),l=Math.sqrt(r*r+i*i),u=e*i-n*r;u<0&&(e<i?s=-s:l=-l),s&&(e*=1/s,n*=1/s),l&&(r*=1/l,i*=1/l);var h=Math.atan2(n,e),p=ju(h);return[t[6],t[7],s,l,p]}var Y=ae.create(),et=ae.create(),St=jr.Ue(),Rt=[Vt.Ue(),Vt.Ue(),Vt.Ue()],ye=Vt.Ue();function be(t,e,n,r,i,s){if(!Oe(Y,t)||(ae.copy(et,Y),et[3]=0,et[7]=0,et[11]=0,et[15]=1,Math.abs(ae.determinant(et))<1e-8))return!1;var l=Y[3],u=Y[7],h=Y[11],p=Y[12],m=Y[13],y=Y[14],x=Y[15];if(l!==0||u!==0||h!==0){St[0]=l,St[1]=u,St[2]=h,St[3]=x;var T=ae.invert(et,et);if(!T)return!1;ae.transpose(et,et),jr.fF(i,St,et)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=p,e[1]=m,e[2]=y,on(Rt,Y),n[0]=Vt.kE(Rt[0]),Vt.Fv(Rt[0],Rt[0]),r[0]=Vt.AK(Rt[0],Rt[1]),Qe(Rt[1],Rt[1],Rt[0],1,-r[0]),n[1]=Vt.kE(Rt[1]),Vt.Fv(Rt[1],Rt[1]),r[0]/=n[1],r[1]=Vt.AK(Rt[0],Rt[2]),Qe(Rt[2],Rt[2],Rt[0],1,-r[1]),r[2]=Vt.AK(Rt[1],Rt[2]),Qe(Rt[2],Rt[2],Rt[1],1,-r[2]),n[2]=Vt.kE(Rt[2]),Vt.Fv(Rt[2],Rt[2]),r[1]/=n[2],r[2]/=n[2],Vt.kC(ye,Rt[1],Rt[2]),Vt.AK(Rt[0],ye)<0)for(var C=0;C<3;C++)n[C]*=-1,Rt[C][0]*=-1,Rt[C][1]*=-1,Rt[C][2]*=-1;return s[0]=.5*Math.sqrt(Math.max(1+Rt[0][0]-Rt[1][1]-Rt[2][2],0)),s[1]=.5*Math.sqrt(Math.max(1-Rt[0][0]+Rt[1][1]-Rt[2][2],0)),s[2]=.5*Math.sqrt(Math.max(1-Rt[0][0]-Rt[1][1]+Rt[2][2],0)),s[3]=.5*Math.sqrt(Math.max(1+Rt[0][0]+Rt[1][1]+Rt[2][2],0)),Rt[2][1]>Rt[1][2]&&(s[0]=-s[0]),Rt[0][2]>Rt[2][0]&&(s[1]=-s[1]),Rt[1][0]>Rt[0][1]&&(s[2]=-s[2]),!0}function Oe(t,e){var n=e[15];if(n===0)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}function on(t,e){t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[4],t[1][1]=e[5],t[1][2]=e[6],t[2][0]=e[8],t[2][1]=e[9],t[2][2]=e[10]}function Qe(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}var vn=function(){function t(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return t.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},t.prototype.update=function(e,n){bh(this.center,e),bh(this.halfExtents,n),oh(this.min,this.center,this.halfExtents),ah(this.max,this.center,this.halfExtents)},t.prototype.setMinMax=function(e,n){ah(this.center,n,e),Qp(this.center,this.center,.5),oh(this.halfExtents,n,e),Qp(this.halfExtents,this.halfExtents,.5),bh(this.min,e),bh(this.max,n)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.add=function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var n=this.center,r=n[0],i=n[1],s=n[2],l=this.halfExtents,u=l[0],h=l[1],p=l[2],m=r-u,y=r+u,x=i-h,T=i+h,C=s-p,M=s+p,I=e.center,D=I[0],U=I[1],Z=I[2],G=e.halfExtents,W=G[0],$=G[1],J=G[2],nt=D-W,dt=D+W,Et=U-$,Pt=U+$,Ht=Z-J,Ct=Z+J;nt<m&&(m=nt),dt>y&&(y=dt),Et<x&&(x=Et),Pt>T&&(T=Pt),Ht<C&&(C=Ht),Ct>M&&(M=Ct),n[0]=(m+y)*.5,n[1]=(x+T)*.5,n[2]=(C+M)*.5,l[0]=(y-m)*.5,l[1]=(T-x)*.5,l[2]=(M-C)*.5,this.min[0]=m,this.min[1]=x,this.min[2]=C,this.max[0]=y,this.max[1]=T,this.max[2]=M}},t.prototype.setFromTransformedAABB=function(e,n){var r=this.center,i=this.halfExtents,s=e.center,l=e.halfExtents,u=n[0],h=n[4],p=n[8],m=n[1],y=n[5],x=n[9],T=n[2],C=n[6],M=n[10],I=Math.abs(u),D=Math.abs(h),U=Math.abs(p),Z=Math.abs(m),G=Math.abs(y),W=Math.abs(x),$=Math.abs(T),J=Math.abs(C),nt=Math.abs(M);r[0]=n[12]+u*s[0]+h*s[1]+p*s[2],r[1]=n[13]+m*s[0]+y*s[1]+x*s[2],r[2]=n[14]+T*s[0]+C*s[1]+M*s[2],i[0]=I*l[0]+D*l[1]+U*l[2],i[1]=Z*l[0]+G*l[1]+W*l[2],i[2]=$*l[0]+J*l[1]+nt*l[2],oh(this.min,r,i),ah(this.max,r,i)},t.prototype.intersects=function(e){var n=this.getMax(),r=this.getMin(),i=e.getMax(),s=e.getMin();return r[0]<=i[0]&&n[0]>=s[0]&&r[1]<=i[1]&&n[1]>=s[1]&&r[2]<=i[2]&&n[2]>=s[2]},t.prototype.intersection=function(e){if(!this.intersects(e))return null;var n=new t,r=sh([0,0,0],this.getMin(),e.getMin()),i=Bf([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n},t.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?bh([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},t.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?bh([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},t}(),Ye=function(){function t(e,n){this.distance=e||0,this.normal=n||Vt.al(0,1,0),this.updatePNVertexFlag()}return t.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},t.prototype.distanceToPoint=function(e){return Vt.AK(e,this.normal)-this.distance},t.prototype.normalize=function(){var e=1/Vt.Zh(this.normal);Vt.bA(this.normal,this.normal,e),this.distance*=e},t.prototype.intersectsLine=function(e,n,r){var i=this.distanceToPoint(e),s=this.distanceToPoint(n),l=i/(i-s),u=l>=0&&l<=1;return u&&r&&Vt.t7(r,e,n,l),u},t}(),On;(function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"})(On||(On={}));var jn=function(){function t(e){if(this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new Ye)}return t.prototype.extractFromVPMatrix=function(e){var n=(0,F.CR)(e,16),r=n[0],i=n[1],s=n[2],l=n[3],u=n[4],h=n[5],p=n[6],m=n[7],y=n[8],x=n[9],T=n[10],C=n[11],M=n[12],I=n[13],D=n[14],U=n[15];Vt.t8(this.planes[0].normal,l-r,m-u,C-y),this.planes[0].distance=U-M,Vt.t8(this.planes[1].normal,l+r,m+u,C+y),this.planes[1].distance=U+M,Vt.t8(this.planes[2].normal,l+i,m+h,C+x),this.planes[2].distance=U+I,Vt.t8(this.planes[3].normal,l-i,m-h,C-x),this.planes[3].distance=U-I,Vt.t8(this.planes[4].normal,l-s,m-p,C-T),this.planes[4].distance=U-D,Vt.t8(this.planes[5].normal,l+s,m+p,C+T),this.planes[5].distance=U+D,this.planes.forEach(function(Z){Z.normalize(),Z.updatePNVertexFlag()})},t}(),ar=function(){function t(e,n){e===void 0&&(e=0),n===void 0&&(n=0),this.x=0,this.y=0,this.x=e,this.y=n}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},t}(),Or=function(){function t(e,n,r,i){this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i}return t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.applyTransform=function(e,n){var r=jr.al(e.x,e.y,0,1),i=jr.al(e.x+e.width,e.y,0,1),s=jr.al(e.x,e.y+e.height,0,1),l=jr.al(e.x+e.width,e.y+e.height,0,1),u=jr.Ue(),h=jr.Ue(),p=jr.Ue(),m=jr.Ue();jr.fF(u,r,n),jr.fF(h,i,n),jr.fF(p,s,n),jr.fF(m,l,n);var y=Math.min(u[0],h[0],p[0],m[0]),x=Math.min(u[1],h[1],p[1],m[1]),T=Math.max(u[0],h[0],p[0],m[0]),C=Math.max(u[1],h[1],p[1],m[1]);return t.fromRect({x:y,y:x,width:T-y,height:C-x})},t.prototype.toJSON=function(){},t}(),cr="Method not implemented.",kr="Use document.documentElement instead.",ei="Cannot append a destroyed element.",Yr;(function(t){t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING"})(Yr||(Yr={}));var Ti;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC"})(Ti||(Ti={}));var zi;(function(t){t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE"})(zi||(zi={}));var Io={UPDATED:"updated"},Bo=2e-4,Fo=function(){function t(){this.clipSpaceNearZ=ih.NEGATIVE_ONE,this.eventEmitter=new ze,this.matrix=ae.create(),this.right=Vt.al(1,0,0),this.up=Vt.al(0,1,0),this.forward=Vt.al(0,0,1),this.position=Vt.al(0,0,1),this.focalPoint=Vt.al(0,0,0),this.distanceVector=Vt.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=ae.create(),this.projectionMatrixInverse=ae.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Yr.EXPLORING,this.trackingMode=Ti.DEFAULT,this.projectionMode=zi.PERSPECTIVE,this.frustum=new jn,this.orthoMatrix=ae.create()}return t.prototype.isOrtho=function(){return this.projectionMode===zi.ORTHOGRAPHIC},t.prototype.getProjectionMode=function(){return this.projectionMode},t.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},t.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},t.prototype.getFrustum=function(){return this.frustum},t.prototype.getPosition=function(){return this.position},t.prototype.getFocalPoint=function(){return this.focalPoint},t.prototype.getDollyingStep=function(){return this.dollyingStep},t.prototype.getNear=function(){return this.near},t.prototype.getFar=function(){return this.far},t.prototype.getZoom=function(){return this.zoom},t.prototype.getOrthoMatrix=function(){return this.orthoMatrix},t.prototype.getView=function(){return this.view},t.prototype.setEnableUpdate=function(e){this.enableUpdate=e},t.prototype.setType=function(e,n){return this.type=e,this.type===Yr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Yr.TRACKING&&n!==void 0&&this.setTrackingMode(n),this},t.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},t.prototype.setTrackingMode=function(e){if(this.type!==Yr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},t.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},t.prototype.getViewTransform=function(){return ae.invert(ae.create(),this.matrix)},t.prototype.getWorldTransform=function(){return this.matrix},t.prototype.jitterProjectionMatrix=function(e,n){var r=ae.fromTranslation(ae.create(),[e,n,0]);this.jitteredProjectionMatrix=ae.multiply(ae.create(),r,this.projectionMatrix)},t.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},t.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},t.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},t.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},t.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},t.prototype.setNear=function(e){return this.projectionMode===zi.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},t.prototype.setFar=function(e){return this.projectionMode===zi.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},t.prototype.setViewOffset=function(e,n,r,i,s,l){return this.aspect=e/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=l,this.projectionMode===zi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===zi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===zi.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===zi.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},t.prototype.setZoomByViewportPoint=function(e,n){var r=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),i=r.x,s=r.y,l=this.roll;this.rotate(0,0,-l),this.setPosition(i,s),this.setFocalPoint(i,s),this.setZoom(e),this.rotate(0,0,l);var u=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),h=u.x,p=u.y,m=Vt.al(h-i,p-s,0),y=Vt.AK(m,this.right)/Vt.kE(this.right),x=Vt.AK(m,this.up)/Vt.kE(this.up),T=(0,F.CR)(this.getPosition(),2),C=T[0],M=T[1],I=(0,F.CR)(this.getFocalPoint(),2),D=I[0],U=I[1];return this.setPosition(C-y,M-x),this.setFocalPoint(D-y,U-x),this},t.prototype.setPerspective=function(e,n,r,i){var s;this.projectionMode=zi.PERSPECTIVE,this.fov=r,this.near=e,this.far=n,this.aspect=i;var l=this.near*Math.tan(Qa(.5*this.fov))/this.zoom,u=2*l,h=this.aspect*u,p=-.5*h;if(!((s=this.view)===null||s===void 0)&&s.enabled){var m=this.view.fullWidth,y=this.view.fullHeight;p+=this.view.offsetX*h/m,l-=this.view.offsetY*u/y,h*=this.view.width/m,u*=this.view.height/y}return B(this.projectionMatrix,p,p+h,l-u,l,e,this.far,this.clipSpaceNearZ===ih.ZERO),ae.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},t.prototype.setOrthographic=function(e,n,r,i,s,l){var u;this.projectionMode=zi.ORTHOGRAPHIC,this.rright=n,this.left=e,this.top=r,this.bottom=i,this.near=s,this.far=l;var h=(this.rright-this.left)/(2*this.zoom),p=(this.top-this.bottom)/(2*this.zoom),m=(this.rright+this.left)/2,y=(this.top+this.bottom)/2,x=m-h,T=m+h,C=y+p,M=y-p;if(!((u=this.view)===null||u===void 0)&&u.enabled){var I=(this.rright-this.left)/this.view.fullWidth/this.zoom,D=(this.top-this.bottom)/this.view.fullHeight/this.zoom;x+=I*this.view.offsetX,T=x+I*this.view.width,C-=D*this.view.offsetY,M=C-D*this.view.height}return this.clipSpaceNearZ===ih.NEGATIVE_ONE?ae.ortho(this.projectionMatrix,x,T,C,M,s,l):ae.orthoZO(this.projectionMatrix,x,T,C,M,s,l),ae.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},t.prototype.setPosition=function(e,n,r){n===void 0&&(n=this.position[1]),r===void 0&&(r=this.position[2]);var i=Al(e,n,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},t.prototype.setFocalPoint=function(e,n,r){n===void 0&&(n=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=Vt.al(0,1,0);if(this.focalPoint=Al(e,n,r),this.trackingMode===Ti.CINEMATIC){var s=Vt.$X(Vt.Ue(),this.focalPoint,this.position);e=s[0],n=s[1],r=s[2];var l=Vt.kE(s),u=ju(Math.asin(n/l)),h=90+ju(Math.atan2(r,e)),p=ae.create();ae.rotateY(p,p,Qa(h)),ae.rotateX(p,p,Qa(u)),i=Vt.fF(Vt.Ue(),[0,1,0],p)}return ae.invert(this.matrix,ae.lookAt(ae.create(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},t.prototype.getDistance=function(){return this.distance},t.prototype.getDistanceVector=function(){return this.distanceVector},t.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Bo&&(this.distance=Bo),this.dollyingStep=this.distance/100;var n=Vt.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return n[0]=e*r[0]+i[0],n[1]=e*r[1]+i[1],n[2]=e*r[2]+i[2],this._setPosition(n),this.triggerUpdate(),this},t.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},t.prototype.setMinDistance=function(e){return this.minDistance=e,this},t.prototype.setAzimuth=function(e){return this.azimuth=Eh(e),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getAzimuth=function(){return this.azimuth},t.prototype.setElevation=function(e){return this.elevation=Eh(e),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getElevation=function(){return this.elevation},t.prototype.setRoll=function(e){return this.roll=Eh(e),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getRoll=function(){return this.roll},t.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},t.prototype.computeMatrix=function(){var e=pi(ni(),[0,0,1],Qa(this.roll));ae.identity(this.matrix);var n=pi(ni(),[1,0,0],Qa((this.rotateWorld&&this.type!==Yr.TRACKING||this.type===Yr.TRACKING?1:-1)*this.elevation)),r=pi(ni(),[0,1,0],Qa((this.rotateWorld&&this.type!==Yr.TRACKING||this.type===Yr.TRACKING?1:-1)*this.azimuth)),i=wo(ni(),r,n);i=wo(ni(),i,e);var s=ae.fromQuat(ae.create(),i);this.type===Yr.ORBITING||this.type===Yr.EXPLORING?(ae.translate(this.matrix,this.matrix,this.focalPoint),ae.multiply(this.matrix,this.matrix,s),ae.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===Yr.TRACKING&&(ae.translate(this.matrix,this.matrix,this.position),ae.multiply(this.matrix,this.matrix,s))},t.prototype._setPosition=function(e,n,r){this.position=Al(e,n,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},t.prototype._getAxes=function(){Vt.JG(this.right,Al(jr.fF(jr.Ue(),[1,0,0,0],this.matrix))),Vt.JG(this.up,Al(jr.fF(jr.Ue(),[0,1,0,0],this.matrix))),Vt.JG(this.forward,Al(jr.fF(jr.Ue(),[0,0,1,0],this.matrix))),Vt.Fv(this.right,this.right),Vt.Fv(this.up,this.up),Vt.Fv(this.forward,this.forward)},t.prototype._getAngles=function(){var e=this.distanceVector[0],n=this.distanceVector[1],r=this.distanceVector[2],i=Vt.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===Yr.TRACKING?(this.elevation=ju(Math.asin(n/i)),this.azimuth=ju(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=ju(Math.asin(n/i)),this.azimuth=ju(Math.atan2(-e,-r))):(this.elevation=-ju(Math.asin(n/i)),this.azimuth=-ju(Math.atan2(-e,-r)))},t.prototype._getPosition=function(){Vt.JG(this.position,Al(jr.fF(jr.Ue(),[0,0,0,1],this.matrix))),this._getDistance()},t.prototype._getFocalPoint=function(){Vt.kK(this.distanceVector,[0,0,-this.distance],Wn(zn(),this.matrix)),Vt.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},t.prototype._getDistance=function(){this.distanceVector=Vt.$X(Vt.Ue(),this.focalPoint,this.position),this.distance=Vt.kE(this.distanceVector),this.dollyingStep=this.distance/100},t.prototype._getOrthoMatrix=function(){if(this.projectionMode===zi.ORTHOGRAPHIC){var e=this.position,n=pi(ni(),[0,0,1],-this.roll*Math.PI/180);ae.fromRotationTranslationScaleOrigin(this.orthoMatrix,n,Vt.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),Vt.al(this.zoom,this.zoom,1),e)}},t.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),n=ae.multiply(ae.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(Io.UPDATED)}},t.prototype.rotate=function(e,n,r){throw new Error(cr)},t.prototype.pan=function(e,n){throw new Error(cr)},t.prototype.dolly=function(e){throw new Error(cr)},t.prototype.createLandmark=function(e,n){throw new Error(cr)},t.prototype.gotoLandmark=function(e,n){throw new Error(cr)},t.prototype.cancelLandmarkAnimation=function(){throw new Error(cr)},t}();function ua(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=e?e.apply(this,r):r[0],l=n.cache;if(l.has(s))return l.get(s);var u=t.apply(this,r);return n.cache=l.set(s,u)||l,u};return n.cache=new(ua.Cache||Map),n}ua.Cache=Map;var Tn;(function(t){t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger"})(Tn||(Tn={}));var Me;(function(t){t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther"})(Me||(Me={}));var la;(function(t){t[t.kAll=0]="kAll",t[t.kNonNegative=1]="kNonNegative",t[t.kInteger=2]="kInteger",t[t.kNonNegativeInteger=3]="kNonNegativeInteger",t[t.kPositiveInteger=4]="kPositiveInteger"})(la||(la={}));var ta;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})(ta||(ta={}));var Vo;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})(Vo||(Vo={}));var ga=[{name:"em",unit_type:Tn.kEms},{name:"px",unit_type:Tn.kPixels},{name:"deg",unit_type:Tn.kDegrees},{name:"rad",unit_type:Tn.kRadians},{name:"grad",unit_type:Tn.kGradians},{name:"ms",unit_type:Tn.kMilliseconds},{name:"s",unit_type:Tn.kSeconds},{name:"rem",unit_type:Tn.kRems},{name:"turn",unit_type:Tn.kTurns}],jo;(function(t){t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType"})(jo||(jo={}));var Do=function(t){return ga.find(function(e){return e.name===t}).unit_type},hc=function(t){return t?t==="number"?Tn.kNumber:t==="percent"||t==="%"?Tn.kPercentage:Do(t):Tn.kUnknown},ml=function(t){switch(t){case Tn.kNumber:case Tn.kInteger:return Me.kUNumber;case Tn.kPercentage:return Me.kUPercent;case Tn.kPixels:return Me.kULength;case Tn.kMilliseconds:case Tn.kSeconds:return Me.kUTime;case Tn.kDegrees:case Tn.kRadians:case Tn.kGradians:case Tn.kTurns:return Me.kUAngle;default:return Me.kUOther}},Bc=function(t){switch(t){case Me.kUNumber:return Tn.kNumber;case Me.kULength:return Tn.kPixels;case Me.kUPercent:return Tn.kPercentage;case Me.kUTime:return Tn.kSeconds;case Me.kUAngle:return Tn.kDegrees;default:return Tn.kUnknown}},Wl=function(t){var e=1;switch(t){case Tn.kPixels:case Tn.kDegrees:case Tn.kSeconds:break;case Tn.kMilliseconds:e=.001;break;case Tn.kRadians:e=180/Math.PI;break;case Tn.kGradians:e=.9;break;case Tn.kTurns:e=360;break}return e},vs=function(t){switch(t){case Tn.kNumber:case Tn.kInteger:return"";case Tn.kPercentage:return"%";case Tn.kEms:return"em";case Tn.kRems:return"rem";case Tn.kPixels:return"px";case Tn.kDegrees:return"deg";case Tn.kRadians:return"rad";case Tn.kGradians:return"grad";case Tn.kMilliseconds:return"ms";case Tn.kSeconds:return"s";case Tn.kTurns:return"turn"}return""},Ks=function(){function t(){}return t.isAngle=function(e){return e===Tn.kDegrees||e===Tn.kRadians||e===Tn.kGradians||e===Tn.kTurns},t.isLength=function(e){return e>=Tn.kEms&&e<Tn.kDegrees},t.isRelativeUnit=function(e){return e===Tn.kPercentage||e===Tn.kEms||e===Tn.kRems},t.isTime=function(e){return e===Tn.kSeconds||e===Tn.kMilliseconds},t.prototype.toString=function(){return this.buildCSSText(ta.kNo,Vo.kNo,"")},t.prototype.isNumericValue=function(){return this.getType()>=jo.kUnitType&&this.getType()<=jo.kClampType},t}(),sl=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this)||this;return r.colorSpace=n,r}return e.prototype.getType=function(){return jo.kColorType},e.prototype.to=function(n){return this},e}(Ks),vl;(function(t){t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"})(vl||(vl={}));var _f=function(t){(0,F.ZT)(e,t);function e(n,r){var i=t.call(this)||this;return i.type=n,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(n,r,i){return i},e.prototype.getType=function(){return jo.kColorType},e}(Ks),ol=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this)||this;return r.value=n,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return jo.kKeywordType},e.prototype.buildCSSText=function(n,r,i){return i+this.value},e}(Ks),sf=ua(function(t){return t===void 0&&(t=""),t.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),Vu=function(t){return t.split("").map(function(e,n){return e.toUpperCase()===e?"".concat(n!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function Vd(t){if(!t)throw new Error}function Ff(t){return typeof t=="function"}function Sh(t){return typeof t=="symbol"}var Zd=function(t){return Object.fromEntries(Object.entries(t).filter(function(e){var n=__read(e,2),r=n[1];return r!==void 0}))},qh={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},xf=ua(function(t){var e=sf(t),n=qh[e];return e=(n==null?void 0:n.alias)||e,e}),wi=function(t,e){e===void 0&&(e="");var n="";return Number.isFinite(t)?(Vd(Number.isNaN(t)),n="NaN"):t>0?n="infinity":n="-infinity",n+=e},fl=function(t){return Bc(ml(t))},ya=function(t){(0,F.ZT)(e,t);function e(n,r){r===void 0&&(r=Tn.kNumber);var i=t.call(this)||this,s;return typeof r=="string"?s=hc(r):s=r,i.unit=s,i.value=n,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(n){var r=n;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return jo.kUnitType},e.prototype.convertTo=function(n){if(this.unit===n)return new e(this.value,this.unit);var r=fl(this.unit);if(r!==fl(n)||r===Tn.kUnknown)return null;var i=Wl(this.unit)/Wl(n);return new e(this.value*i,n)},e.prototype.buildCSSText=function(n,r,i){var s;switch(this.unit){case Tn.kUnknown:break;case Tn.kInteger:s=Number(this.value).toFixed(0);break;case Tn.kNumber:case Tn.kPercentage:case Tn.kEms:case Tn.kRems:case Tn.kPixels:case Tn.kDegrees:case Tn.kRadians:case Tn.kGradians:case Tn.kMilliseconds:case Tn.kSeconds:case Tn.kTurns:{var l=-999999,u=999999,h=this.value,p=vs(this.unit);if(h<l||h>u){var m=vs(this.unit);!Number.isFinite(h)||Number.isNaN(h)?s=wi(h,m):s=h+(m||"")}else s="".concat(h).concat(p)}}return i+=s,i},e}(Ks),gs=new ya(0,"px");new ya(1,"px");var Bl=new ya(0,"deg"),Zu=function(t){(0,F.ZT)(e,t);function e(n,r,i,s,l){s===void 0&&(s=1),l===void 0&&(l=!1);var u=t.call(this,"rgb")||this;return u.r=n,u.g=r,u.b=i,u.alpha=s,u.isNone=l,u}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(n,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(sl),No=new ol("unset"),Fl=new ol("initial"),Xl=new ol("inherit"),bf={"":No,unset:No,initial:Fl,inherit:Xl},Hd=function(t){return bf[t]||(bf[t]=new ol(t)),bf[t]},lf=new Zu(0,0,0,0,!0),Ep=new Zu(0,0,0,0),Ad=ua(function(t,e,n,r){return new Zu(t,e,n,r)},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")")}),Is=function(t,e){return e===void 0&&(e=Tn.kNumber),new ya(t,e)};new ya(50,"%");var cf;(function(t){t[t.Standard=0]="Standard"})(cf||(cf={}));var lh;(function(t){t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(lh||(lh={}));var D0={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Or(0,0,0,0)},io;(function(t){t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>"})(io||(io={}));function gu(t){var e=t.type,n=t.value;return e==="hex"?"#".concat(n):e==="literal"?n:e==="rgb"?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}var ty=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(Ee){throw new Error(e+": "+Ee)}function r(){var Ee=i();return e.length>0&&n("Invalid input not EOF"),Ee}function i(){return Z(s)}function s(){return l("linear-gradient",t.linearGradient,h)||l("repeating-linear-gradient",t.repeatingLinearGradient,h)||l("radial-gradient",t.radialGradient,y)||l("repeating-radial-gradient",t.repeatingRadialGradient,y)||l("conic-gradient",t.conicGradient,y)}function l(Ee,oe,_e){return u(oe,function(hn){var Dn=_e();return Dn&&(jt(t.comma)||n("Missing comma before color stops")),{type:Ee,orientation:Dn,colorStops:Z(G)}})}function u(Ee,oe){var _e=jt(Ee);if(_e){jt(t.startCall)||n("Missing (");var hn=oe(_e);return jt(t.endCall)||n("Missing )"),hn}}function h(){return p()||m()}function p(){return Ft("directional",t.sideOrCorner,1)}function m(){return Ft("angular",t.angleValue,1)}function y(){var Ee,oe=x(),_e;return oe&&(Ee=[],Ee.push(oe),_e=e,jt(t.comma)&&(oe=x(),oe?Ee.push(oe):e=_e)),Ee}function x(){var Ee=T()||C();if(Ee)Ee.at=I();else{var oe=M();if(oe){Ee=oe;var _e=I();_e&&(Ee.at=_e)}else{var hn=D();hn&&(Ee={type:"default-radial",at:hn})}}return Ee}function T(){var Ee=Ft("shape",/^(circle)/i,0);return Ee&&(Ee.style=Ct()||M()),Ee}function C(){var Ee=Ft("shape",/^(ellipse)/i,0);return Ee&&(Ee.style=Pt()||M()),Ee}function M(){return Ft("extent-keyword",t.extentKeywords,1)}function I(){if(Ft("position",/^at/,0)){var Ee=D();return Ee||n("Missing positioning value"),Ee}}function D(){var Ee=U();if(Ee.x||Ee.y)return{type:"position",value:Ee}}function U(){return{x:Pt(),y:Pt()}}function Z(Ee){var oe=Ee(),_e=[];if(oe)for(_e.push(oe);jt(t.comma);)oe=Ee(),oe?_e.push(oe):n("One extra comma");return _e}function G(){var Ee=W();return Ee||n("Expected color definition"),Ee.length=Pt(),Ee}function W(){return J()||dt()||nt()||$()}function $(){return Ft("literal",t.literalColor,0)}function J(){return Ft("hex",t.hexColor,1)}function nt(){return u(t.rgbColor,function(){return{type:"rgb",value:Z(Et)}})}function dt(){return u(t.rgbaColor,function(){return{type:"rgba",value:Z(Et)}})}function Et(){return jt(t.number)[1]}function Pt(){return Ft("%",t.percentageValue,1)||Ht()||Ct()}function Ht(){return Ft("position-keyword",t.positionKeywords,1)}function Ct(){return Ft("px",t.pixelValue,1)||Ft("em",t.emValue,1)}function Ft(Ee,oe,_e){var hn=jt(oe);if(hn)return{type:Ee,value:hn[_e]}}function jt(Ee){var oe=/^[\n\r\t\s]+/.exec(e);oe&&qt(oe[0].length);var _e=Ee.exec(e);return _e&&qt(_e[0].length),_e}function qt(Ee){e=e.substring(Ee)}return function(Ee){return e=Ee,r()}}();function lm(t,e,n,r){var i=Qa(r.value),s=0,l=0,u=s+e/2,h=l+n/2,p=Math.abs(e*Math.cos(i))+Math.abs(n*Math.sin(i)),m=t[0]+u-Math.cos(i)*p/2,y=t[1]+h-Math.sin(i)*p/2,x=t[0]+u+Math.cos(i)*p/2,T=t[1]+h+Math.sin(i)*p/2;return{x1:m,y1:y,x2:x,y2:T}}function Sp(t,e,n,r,i,s){var l=r.value,u=i.value;r.unit===Tn.kPercentage&&(l=r.value/100*e),i.unit===Tn.kPercentage&&(u=i.value/100*n);var h=Math.max(An([0,0],[l,u]),An([0,n],[l,u]),An([e,n],[l,u]),An([e,0],[l,u]));return s&&(s instanceof ya?h=s.value:s instanceof ol&&(s.value==="closest-side"?h=Math.min(l,e-l,u,n-u):s.value==="farthest-side"?h=Math.max(l,e-l,u,n-u):s.value==="closest-corner"&&(h=Math.min(An([0,0],[l,u]),An([0,n],[l,u]),An([e,n],[l,u]),An([e,0],[l,u]))))),{x:l+t[0],y:u+t[1],r:h}}var ey=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Wv=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ny=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,cm=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function um(t){var e,n,r,i=t.length;t[i-1].length=(e=t[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(t[0].length=(n=t[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"});for(var s=0,l=Number(t[0].length.value),u=1;u<i;u++){var h=(r=t[u].length)===null||r===void 0?void 0:r.value;if(!(0,tr.Z)(h)&&!(0,tr.Z)(l)){for(var p=1;p<u-s;p++)t[s+p].length={type:"%",value:"".concat(l+(Number(h)-l)*p/(u-s))};s=u,l=Number(h)}}}var N0={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},ry=ua(function(t){var e;return t.type==="angular"?e=Number(t.value):e=N0[t.value]||0,Is(e,"deg")}),Tp=ua(function(t){var e=50,n=50,r="%",i="%";if((t==null?void 0:t.type)==="position"){var s=t.value,l=s.x,u=s.y;(l==null?void 0:l.type)==="position-keyword"&&(l.value==="left"?e=0:l.value==="center"?e=50:l.value==="right"?e=100:l.value==="top"?n=0:l.value==="bottom"&&(n=100)),(u==null?void 0:u.type)==="position-keyword"&&(u.value==="left"?e=0:u.value==="center"?n=50:u.value==="right"?e=100:u.value==="top"?n=0:u.value==="bottom"&&(n=100)),((l==null?void 0:l.type)==="px"||(l==null?void 0:l.type)==="%"||(l==null?void 0:l.type)==="em")&&(r=l==null?void 0:l.type,e=Number(l.value)),((u==null?void 0:u.type)==="px"||(u==null?void 0:u.type)==="%"||(u==null?void 0:u.type)==="em")&&(i=u==null?void 0:u.type,n=Number(u.value))}return{cx:Is(e,r),cy:Is(n,i)}}),wp=ua(function(t){var e;if(t.indexOf("linear")>-1||t.indexOf("radial")>-1){var n=ty(t);return n.map(function(u){var h=u.type,p=u.orientation,m=u.colorStops;um(m);var y=m.map(function(Z){return{offset:Is(Number(Z.length.value),"%"),color:gu(Z)}});if(h==="linear-gradient")return new _f(vl.LinearGradient,{angle:p?ry(p):Bl,steps:y});if(h==="radial-gradient"&&(p||(p=[{type:"shape",value:"circle"}]),p[0].type==="shape"&&p[0].value==="circle")){var x=Tp(p[0].at),T=x.cx,C=x.cy,M=void 0;if(p[0].style){var I=p[0].style,D=I.type,U=I.value;D==="extent-keyword"?M=Hd(U):M=Is(U,D)}return new _f(vl.RadialGradient,{cx:T,cy:C,size:M,steps:y})}})}var r=t[0];if(t[1]==="("||t[2]==="("){if(r==="l"){var i=ey.exec(t);if(i){var s=((e=i[2].match(cm))===null||e===void 0?void 0:e.map(function(u){return u.split(":")}))||[];return[new _f(vl.LinearGradient,{angle:Is(parseFloat(i[1]),"deg"),steps:s.map(function(u){var h=(0,F.CR)(u,2),p=h[0],m=h[1];return{offset:Is(Number(p)*100,"%"),color:m}})})]}}else if(r==="r"){var l=tv(t);if(l)if(Si(l))t=l;else return[new _f(vl.RadialGradient,l)]}else if(r==="p")return ev(t)}});function tv(t){var e,n=Wv.exec(t);if(n){var r=((e=n[4].match(cm))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Is(50,"%"),cy:Is(50,"%"),steps:r.map(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1];return{offset:Is(Number(l)*100,"%"),color:u}})}}return null}function ev(t){var e=ny.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;case"n":n="no-repeat";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}function iy(t){return!!t.type&&!!t.value}function Gd(t){return t&&!!t.image}function e0(t){return t&&!(0,tr.Z)(t.r)&&!(0,tr.Z)(t.g)&&!(0,tr.Z)(t.b)}var $h=ua(function(t){if(Gd(t))return(0,F.pi)({repetition:"repeat"},t);if((0,tr.Z)(t)&&(t=""),t==="transparent")return Ep;if(t==="currentColor")t="black";else if(t==="none")return lf;var e=wp(t);if(e)return e;var n=Lf(t),r=[0,0,0,0];return n!==null&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),Ad.apply(void 0,(0,F.ev)([],(0,F.CR)(r),!1))});function nv(t,e){if(!(!e0(t)||!e0(e)))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(n){var r=n.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round((0,uo.Z)(r[i],0,255));return r[3]=(0,uo.Z)(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function Kh(t,e){if((0,tr.Z)(e))return Is(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return Is(Number(e),"px");if("deg".search(t)>=0)return Is(Number(e),"deg")}var n=[];e=e.replace(t,function(i){return n.push(i),"U"+i});var r="U("+t.source+")";return n.map(function(i){return Is(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var k0=function(t){return Kh(new RegExp("px","g"),t)},Yc=ua(k0),Ap=function(t){return Kh(new RegExp("%","g"),t)};ua(Ap);var Qs=function(t){return(0,ge.Z)(t)||isFinite(Number(t))?Is(Number(t)||0,"px"):Kh(new RegExp("px|%|em|rem","g"),t)},Ef=ua(Qs),B0=function(t){return Kh(new RegExp("deg|rad|grad|turn","g"),t)},Wd=ua(B0);function Op(t,e,n,r,i){i===void 0&&(i=0);var s="",l=t.value||0,u=e.value||0,h=fl(t.unit),p=t.convertTo(h),m=e.convertTo(h);return p&&m?(l=p.value,u=m.value,s=vs(t.unit)):(ya.isLength(t.unit)||ya.isLength(e.unit))&&(l=gl(t,i,n),u=gl(e,i,n),s="px"),[l,u,function(y){return r&&(y=Math.max(y,0)),y+s}]}function dc(t){var e=0;return t.unit===Tn.kDegrees?e=t.value:t.unit===Tn.kRadians?e=ju(Number(t.value)):t.unit===Tn.kTurns&&(e=t0(Number(t.value))),e}function Xd(t,e){var n;return Array.isArray(t)?n=t.map(function(r){return Number(r)}):Si(t)?n=t.split(" ").map(function(r){return Number(r)}):(0,ge.Z)(t)&&(n=[t]),e===2?n.length===1?[n[0],n[0]]:[n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===3?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]}function Qh(t){return Si(t)?t.split(" ").map(function(e){return Ef(e)}):t.map(function(e){return Ef(e.toString())})}function gl(t,e,n,r){if(r===void 0&&(r=!1),t.unit===Tn.kPixels)return Number(t.value);if(t.unit===Tn.kPercentage&&n){var i=n.nodeName===Gr.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2}return 0}var Cp=function(t){return Kh(/deg|rad|grad|turn|px|%/g,t)},n0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function fm(t){if(t===void 0&&(t=""),t=t.toLowerCase().trim(),t==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,n=[],r,i=0;r=e.exec(t);){if(r.index!==i)return[];if(i=r.index+r[0].length,n0.indexOf(r[1])>-1&&n.push({name:r[1],params:r[2].split(" ").map(function(s){return Cp(s)||$h(s)})}),e.lastIndex===t.length)return n}return[]}function Th(t){return t.toString()}var su=function(t){return typeof t=="number"?Is(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Is(Number(t)):Is(0)},yu=ua(su);ua(function(t){return Si(t)?t.split(" ").map(yu):t.map(yu)});function r0(t,e){return[t,e,Th]}function i0(t,e){return function(n,r){return[n,r,function(i){return Th((0,uo.Z)(i,t,e))}]}}function Rp(t,e){if(t.length===e.length)return[t,e,function(n){return n}]}function Sf(t){return t.parsedStyle.d.totalLength===0&&(t.parsedStyle.d.totalLength=Nl(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function Od(t){return t.parsedStyle.points.totalLength===0&&(t.parsedStyle.points.totalLength=Gl(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength}function oy(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e],i=r[0];if(i==="M"&&n){var s=n[0],l=[r[1],r[2]],u=void 0;s==="L"||s==="M"?u=[n[1],n[2]]:(s==="C"||s==="A"||s==="Q")&&(u=[n[n.length-2],n[n.length-1]]),u&&F0(l,u)&&(t.splice(e,1),e--)}}}function ay(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r],s=i[0];if(s==="C"||s==="A"||s==="Q"){e=!0;break}}return e}function rv(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var s=t[i],l=s[0];l==="M"?(r.length&&(n.push(r),r=[]),r.push([s[1],s[2]])):l==="Z"?r.length&&(e.push(r),r=[]):r.push([s[1],s[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}function F0(t,e){return t[0]===e[0]&&t[1]===e[1]}function Jh(t,e){for(var n=[],r=[],i=[],s=0;s<t.length;s++){var l=t[s],u=l.currentPoint,h=l.params,p=l.prePoint,m=void 0;switch(l.command){case"Q":m=fc(p[0],p[1],h[1],h[2],h[3],h[4]);break;case"C":m=nh(p[0],p[1],h[1],h[2],h[3],h[4],h[5],h[6]);break;case"A":var y=l.arcParams;m=$s(y.cx,y.cy,y.rx,y.ry,y.xRotation,y.startAngle,y.endAngle);break;default:n.push(u[0]),r.push(u[1]);break}m&&(l.box=m,n.push(m.x,m.x+m.width),r.push(m.y,m.y+m.height)),e&&(l.command==="L"||l.command==="M")&&l.prePoint&&l.nextPoint&&i.push(l)}n=n.filter(function(D){return!Number.isNaN(D)&&D!==1/0&&D!==-1/0}),r=r.filter(function(D){return!Number.isNaN(D)&&D!==1/0&&D!==-1/0});var x=nu(n),T=nu(r),C=sc(n),M=sc(r);if(i.length===0)return{x,y:T,width:C-x,height:M-T};for(var s=0;s<i.length;s++){var l=i[s],u=l.currentPoint,I=void 0;u[0]===x?(I=hm(l,e),x=x-I.xExtra):u[0]===C&&(I=hm(l,e),C=C+I.xExtra),u[1]===T?(I=hm(l,e),T=T-I.yExtra):u[1]===M&&(I=hm(l,e),M=M+I.yExtra)}return{x,y:T,width:C-x,height:M-T}}function hm(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,s=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),l=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),u=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),h=Math.acos((s+l-u)/(2*Math.sqrt(s)*Math.sqrt(l)));if(!h||Math.sin(h)===0||lc(h,0))return{xExtra:0,yExtra:0};var p=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),m=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));p=p>Math.PI/2?Math.PI-p:p,m=m>Math.PI/2?Math.PI-m:m;var y={xExtra:Math.cos(h/2-p)*(e/2*(1/Math.sin(h/2)))-e/2||0,yExtra:Math.cos(m-h/2)*(e/2*(1/Math.sin(h/2)))-e/2||0};return y}function Uf(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}var o0=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=t.x*e.y-t.y*e.x<0?-1:1,s=i*Math.acos(n/r);return s},Yd=function(t,e,n,r,i,s,l,u){e=Math.abs(e),n=Math.abs(n),r=kl(r,360);var h=Qa(r);if(t.x===l.x&&t.y===l.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(e===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var p=(t.x-l.x)/2,m=(t.y-l.y)/2,y={x:Math.cos(h)*p+Math.sin(h)*m,y:-Math.sin(h)*p+Math.cos(h)*m},x=Math.pow(y.x,2)/Math.pow(e,2)+Math.pow(y.y,2)/Math.pow(n,2);x>1&&(e=Math.sqrt(x)*e,n=Math.sqrt(x)*n);var T=Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(y.y,2)-Math.pow(n,2)*Math.pow(y.x,2),C=Math.pow(e,2)*Math.pow(y.y,2)+Math.pow(n,2)*Math.pow(y.x,2),M=T/C;M=M<0?0:M;var I=(i!==s?1:-1)*Math.sqrt(M),D={x:I*(e*y.y/n),y:I*(-(n*y.x)/e)},U={x:Math.cos(h)*D.x-Math.sin(h)*D.y+(t.x+l.x)/2,y:Math.sin(h)*D.x+Math.cos(h)*D.y+(t.y+l.y)/2},Z={x:(y.x-D.x)/e,y:(y.y-D.y)/n},G=o0({x:1,y:0},Z),W={x:(-y.x-D.x)/e,y:(-y.y-D.y)/n},$=o0(Z,W);!s&&$>0?$-=2*Math.PI:s&&$<0&&($+=2*Math.PI),$%=2*Math.PI;var J=G+$*u,nt=e*Math.cos(J),dt=n*Math.sin(J),Et={x:Math.cos(h)*nt-Math.sin(h)*dt+U.x,y:Math.sin(h)*nt+Math.cos(h)*dt+U.y,ellipticalArcStartAngle:G,ellipticalArcEndAngle:G+$,ellipticalArcAngle:J,ellipticalArcCenter:U,resultantRx:e,resultantRy:n};return Et};function qd(t){for(var e=[],n=null,r=null,i=null,s=0,l=t.length,u=0;u<l;u++){var h=t[u];r=t[u+1];var p=h[0],m={command:p,prePoint:n,params:h,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(p){case"M":i=[h[1],h[2]],s=u;break;case"A":var y=_u(n,h);m.arcParams=y;break}if(p==="Z")n=i,r=t[s+1];else{var x=h.length;n=[h[x-2],h[x-1]]}r&&r[0]==="Z"&&(r=t[s],e[s]&&(e[s].prePoint=n)),m.currentPoint=n,e[s]&&F0(n,e[s].currentPoint)&&(e[s].prePoint=m.prePoint);var T=r?[r[r.length-2],r[r.length-1]]:null;m.nextPoint=T;var C=m.prePoint;if(["L","H","V"].includes(p))m.startTangent=[C[0]-n[0],C[1]-n[1]],m.endTangent=[n[0]-C[0],n[1]-C[1]];else if(p==="Q"){var M=[h[1],h[2]];m.startTangent=[C[0]-M[0],C[1]-M[1]],m.endTangent=[n[0]-M[0],n[1]-M[1]]}else if(p==="T"){var I=e[u-1],M=Uf(I.currentPoint,C);I.command==="Q"?(m.command="Q",m.startTangent=[C[0]-M[0],C[1]-M[1]],m.endTangent=[n[0]-M[0],n[1]-M[1]]):(m.command="TL",m.startTangent=[C[0]-n[0],C[1]-n[1]],m.endTangent=[n[0]-C[0],n[1]-C[1]])}else if(p==="C"){var D=[h[1],h[2]],U=[h[3],h[4]];m.startTangent=[C[0]-D[0],C[1]-D[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]],m.startTangent[0]===0&&m.startTangent[1]===0&&(m.startTangent=[D[0]-U[0],D[1]-U[1]]),m.endTangent[0]===0&&m.endTangent[1]===0&&(m.endTangent=[U[0]-D[0],U[1]-D[1]])}else if(p==="S"){var I=e[u-1],D=Uf(I.currentPoint,C),U=[h[1],h[2]];I.command==="C"?(m.command="C",m.startTangent=[C[0]-D[0],C[1]-D[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]]):(m.command="SQ",m.startTangent=[C[0]-U[0],C[1]-U[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]])}else if(p==="A"){var Z=iv(m,0),G=Z.x,W=Z.y,$=iv(m,1,!1),J=$.x,nt=$.y;m.startTangent=[G,W],m.endTangent=[J,nt]}e.push(m)}return e}function iv(t,e,n){n===void 0&&(n=!0);var r=t.arcParams,i=r.rx,s=i===void 0?0:i,l=r.ry,u=l===void 0?0:l,h=r.xRotation,p=r.arcFlag,m=r.sweepFlag,y=Yd({x:t.prePoint[0],y:t.prePoint[1]},s,u,h,!!p,!!m,{x:t.currentPoint[0],y:t.currentPoint[1]},e),x=Yd({x:t.prePoint[0],y:t.prePoint[1]},s,u,h,!!p,!!m,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),T=x.x-y.x,C=x.y-y.y,M=Math.sqrt(T*T+C*C);return{x:-T/M,y:-C/M}}function wh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function a0(t,e){return wh(t)*wh(e)?(t[0]*e[0]+t[1]*e[1])/(wh(t)*wh(e)):1}function Mp(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(a0(t,e))}function _u(t,e){var n=e[1],r=e[2],i=kl(Qa(e[3]),Math.PI*2),s=e[4],l=e[5],u=t[0],h=t[1],p=e[6],m=e[7],y=Math.cos(i)*(u-p)/2+Math.sin(i)*(h-m)/2,x=-1*Math.sin(i)*(u-p)/2+Math.cos(i)*(h-m)/2,T=y*y/(n*n)+x*x/(r*r);T>1&&(n*=Math.sqrt(T),r*=Math.sqrt(T));var C=n*n*(x*x)+r*r*(y*y),M=C?Math.sqrt((n*n*(r*r)-C)/C):1;s===l&&(M*=-1),isNaN(M)&&(M=0);var I=r?M*n*x/r:0,D=n?M*-r*y/n:0,U=(u+p)/2+Math.cos(i)*I-Math.sin(i)*D,Z=(h+m)/2+Math.sin(i)*I+Math.cos(i)*D,G=[(y-I)/n,(x-D)/r],W=[(-1*y-I)/n,(-1*x-D)/r],$=Mp([1,0],G),J=Mp(G,W);return a0(G,W)<=-1&&(J=Math.PI),a0(G,W)>=1&&(J=0),l===0&&J>0&&(J=J-2*Math.PI),l===1&&J<0&&(J=J+2*Math.PI),{cx:U,cy:Z,rx:F0(t,[p,m])?0:n,ry:F0(t,[p,m])?0:r,startAngle:$,endAngle:$+J,xRotation:i,arcFlag:s,sweepFlag:l}}function lu(t,e,n){return t.reduce(function(r,i){var s="";if(i[0]==="M"||i[0]==="L"){var l=Vt.al(i[1],i[2],0);n&&Vt.fF(l,l,n),s="".concat(i[0]).concat(l[0],",").concat(l[1])}else if(i[0]==="Z")s=i[0];else if(i[0]==="C"){var u=Vt.al(i[1],i[2],0),h=Vt.al(i[3],i[4],0),p=Vt.al(i[5],i[6],0);n&&(Vt.fF(u,u,n),Vt.fF(h,h,n),Vt.fF(p,p,n)),s="".concat(i[0]).concat(u[0],",").concat(u[1],",").concat(h[0],",").concat(h[1],",").concat(p[0],",").concat(p[1])}else if(i[0]==="A"){var m=Vt.al(i[6],i[7],0);n&&Vt.fF(m,m,n),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(m[0],",").concat(m[1])}else if(i[0]==="Q"){var u=Vt.al(i[1],i[2],0),h=Vt.al(i[3],i[4],0);n&&(Vt.fF(u,u,n),Vt.fF(h,h,n)),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=s},"")}function pc(t,e,n,r){return[["M",t,e],["L",n,r]]}function Hu(t,e,n,r){var i=(-1+Math.sqrt(2))/3*4,s=t*i,l=e*i,u=n-t,h=n+t,p=r-e,m=r+e;return[["M",u,r],["C",u,r-l,n-s,p,n,p],["C",n+s,p,h,r-l,h,r],["C",h,r+l,n+s,m,n,m],["C",n-s,m,u,r+l,u,r],["Z"]]}function xu(t,e){var n=t.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&n.push(["Z"]),n}function Pp(t,e,n,r,i){if(i){var s=(0,F.CR)(i,4),l=s[0],u=s[1],h=s[2],p=s[3],m=t>0?1:-1,y=e>0?1:-1,x=m+y!==0?1:0;return[["M",m*l+n,r],["L",t-m*u+n,r],u?["A",u,u,0,0,x,t+n,y*u+r]:null,["L",t+n,e-y*h+r],h?["A",h,h,0,0,x,t+n-m*h,e+r]:null,["L",n+m*p,e+r],p?["A",p,p,0,0,x,n,e+r-y*p]:null,["L",n,y*l+r],l?["A",l,l,0,0,x,m*l+n,r]:null,["Z"]].filter(function(T){return T})}return[["M",n,r],["L",n+t,r],["L",n+t,r+e],["L",n,r+e],["Z"]]}function dm(t,e){e===void 0&&(e=t.getLocalTransform());var n=[];switch(t.nodeName){case Gr.LINE:var r=t.parsedStyle,i=r.x1,s=i===void 0?0:i,l=r.y1,u=l===void 0?0:l,h=r.x2,p=h===void 0?0:h,m=r.y2,y=m===void 0?0:m;n=pc(s,u,p,y);break;case Gr.CIRCLE:{var x=t.parsedStyle,T=x.r,C=T===void 0?0:T,M=x.cx,I=M===void 0?0:M,D=x.cy,U=D===void 0?0:D;n=Hu(C,C,I,U);break}case Gr.ELLIPSE:{var Z=t.parsedStyle,G=Z.rx,W=G===void 0?0:G,$=Z.ry,J=$===void 0?0:$,nt=Z.cx,I=nt===void 0?0:nt,dt=Z.cy,U=dt===void 0?0:dt;n=Hu(W,J,I,U);break}case Gr.POLYLINE:case Gr.POLYGON:var Et=t.parsedStyle.points;n=xu(Et.points,t.nodeName===Gr.POLYGON);break;case Gr.RECT:var Pt=t.parsedStyle,Ht=Pt.width,Ct=Ht===void 0?0:Ht,Ft=Pt.height,jt=Ft===void 0?0:Ft,qt=Pt.x,Ee=qt===void 0?0:qt,oe=Pt.y,_e=oe===void 0?0:oe,hn=Pt.radius,Dn=hn&&hn.some(function(Jn){return Jn!==0});n=Pp(Ct,jt,Ee,_e,Dn&&hn.map(function(Jn){return(0,uo.Z)(Jn,0,Math.min(Math.abs(Ct)/2,Math.abs(jt)/2))}));break;case Gr.PATH:var Kn=t.parsedStyle.d.absolutePath;n=(0,F.ev)([],(0,F.CR)(Kn),!1);break}if(n.length)return lu(n,t,e)}function A_(t,e,n,r,i){e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0);var s=t.map(function(l,u){var h=l[0],p=t[u+1],m=u===0&&(e!==0||n!==0),y=(u===t.length-1||p&&(p[0]==="M"||p[0]==="Z"))&&r!==0&&i!==0;switch(h){case"M":return m?"M ".concat(l[1]+e,",").concat(l[2]+n," L ").concat(l[1],",").concat(l[2]):"M ".concat(l[1],",").concat(l[2]);case"L":return"L ".concat(l[1]+(y?r:0),",").concat(l[2]+(y?i:0));case"Q":return"Q ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4])+(y?" L ".concat(l[3]+r,",").concat(l[4]+i):"");case"C":return"C ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4],",").concat(l[5]," ").concat(l[6])+(y?" L ".concat(l[5]+r,",").concat(l[6]+i):"");case"A":return"A ".concat(l[1]," ").concat(l[2]," ").concat(l[3]," ").concat(l[4]," ").concat(l[5]," ").concat(l[6]," ").concat(l[7])+(y?" L ".concat(l[6]+r,",").concat(l[7]+i):"");case"Z":return"Z"}}).join(" ");return~s.indexOf("NaN")?"":s}var Xv=function(t){if(t===""||Array.isArray(t)&&t.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Uh(t)}catch(x){e=Uh(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}oy(e);var n=ay(e),r=rv(e),i=r.polygons,s=r.polylines,l=qd(e),u=Jh(l,0),h=u.x,p=u.y,m=u.width,y=u.height;return{absolutePath:e,hasArc:n,segments:l,polygons:i,polylines:s,totalLength:0,rect:{x:Number.isFinite(h)?h:0,y:Number.isFinite(p)?p:0,width:Number.isFinite(m)?m:0,height:Number.isFinite(y)?y:0}}},U0=ua(Xv);function z0(t){return Si(t)?U0(t):Xv(t)}function ov(t,e,n){var r=t.curve,i=e.curve;(!r||r.length===0)&&(r=gh(t.absolutePath,!1),t.curve=r),(!i||i.length===0)&&(i=gh(e.absolutePath,!1),e.curve=i);var s=[r,i];r.length!==i.length&&(s=Qf(r,i));var l=It(s[0])!==It(s[1])?Ke(s[0]):X(s[0]);return[l,Mr(s[1],l),function(u){return u}]}function cu(t,e){var n;return Si(t)?n=t.split(" ").map(function(r){var i=(0,F.CR)(r.split(","),2),s=i[0],l=i[1];return[Number(s),Number(l)]}):n=t,{points:n,totalLength:0,segments:[]}}function pm(t,e){return[t.points,e.points,function(n){return n}]}var Ol=null;function Gu(t){return function(e){var n=0;return t.map(function(r){return r===Ol?e[n++]:r})}}function Ah(t){return t}var Oh={matrix:["NNNNNN",[Ol,Ol,0,0,Ol,Ol,0,0,0,0,1,0,Ol,Ol,0,1],Ah],matrix3d:["NNNNNNNNNNNNNNNN",Ah],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Gu([Ol,Ol,new ya(1)]),Ah],scalex:["N",Gu([Ol,new ya(1),new ya(1)]),Gu([Ol,new ya(1)])],scaley:["N",Gu([new ya(1),Ol,new ya(1)]),Gu([new ya(1),Ol])],scalez:["N",Gu([new ya(1),new ya(1),Ol])],scale3d:["NNN",Ah],skew:["Aa",null,Ah],skewx:["A",null,Gu([Ol,Bl])],skewy:["A",null,Gu([Bl,Ol])],translate:["Tt",Gu([Ol,Ol,gs]),Ah],translatex:["T",Gu([Ol,gs,gs]),Gu([Ol,gs])],translatey:["T",Gu([gs,Ol,gs]),Gu([gs,Ol])],translatez:["L",Gu([gs,gs,Ol])],translate3d:["TTL",Ah]};function av(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=e.exec(t);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=Oh[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],x=h[m],T=void 0;if(y?T={A:function(C){return C.trim()==="0"?Bl:Wd(C)},N:yu,T:Ef,L:Yc}[x.toUpperCase()](y):T={a:Bl,n:p[0],t:gs}[x],T===void 0)return[];p.push(T)}if(n.push({t:s,d:p}),e.lastIndex===t.length)return n}return[]}function Yv(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=e.exec(t);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=Oh[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],x=h[m],T=void 0;if(y?T={A:function(C){return C.trim()==="0"?Bl:B0(C)},N:su,T:Qs,L:k0}[x.toUpperCase()](y):T={a:Bl,n:p[0],t:gs}[x],T===void 0)return[];p.push(T)}if(n.push({t:s,d:p}),e.lastIndex===t.length)return n}return[]}function qv(t){var e,n,r,i;switch(t.t){case"rotatex":return i=Qa(dc(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Qa(dc(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Qa(dc(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=Qa(dc(t.d[3]));var s=e*e+n*n+r*r;if(s===0)e=1,n=0,r=0;else if(s!==1){var l=Math.sqrt(s);e/=l,n/=l,r/=l}var u=Math.sin(i/2),h=u*Math.cos(i/2),p=u*u;return[1-2*(n*n+r*r)*p,2*(e*n*p+r*h),2*(e*r*p-n*h),0,2*(e*n*p-r*h),1-2*(e*e+r*r)*p,2*(n*r*p+e*h),0,2*(e*r*p+n*h),2*(n*r*p-e*h),1-2*(e*e+n*n)*p,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var m=Qa(dc(t.d[0])),y=Qa(dc(t.d[1]));return[1,Math.tan(y),0,0,Math.tan(m),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Qa(dc(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Qa(dc(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=gl(t.d[0],0,null)||0,n=gl(t.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,n,0,1];case"translatex":return e=gl(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return n=gl(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,n,0,1];case"translatez":return r=gl(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=gl(t.d[0],0,null)||0,n=gl(t.d[1],0,null)||0,r=gl(t.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,n,r,1];case"perspective":var x=gl(t.d[0],0,null)||0,T=x?-1/x:0;return[1,0,0,0,0,1,0,0,0,0,1,T,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(C){return C.value})}}function $v(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function xt(t){return t.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(qv).reduce($v)}function Pe(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],s=[0,0,0,1];return be(xt(t),e,n,r,i,s),[[e,n,r,s,i]]}var gn=function(){function t(r,i){for(var s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],l=0;l<4;l++)for(var u=0;u<4;u++)for(var h=0;h<4;h++)s[l][u]+=i[l][h]*r[h][u];return s}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function n(r,i,s,l,u){for(var h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],p=0;p<4;p++)h[p][3]=u[p];for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[3][p]+=r[m]*h[m][p];var y=l[0],x=l[1],T=l[2],C=l[3],M=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];M[0][0]=1-2*(x*x+T*T),M[0][1]=2*(y*x-T*C),M[0][2]=2*(y*T+x*C),M[1][0]=2*(y*x+T*C),M[1][1]=1-2*(y*y+T*T),M[1][2]=2*(x*T-y*C),M[2][0]=2*(y*T-x*C),M[2][1]=2*(x*T+y*C),M[2][2]=1-2*(y*y+x*x),h=t(h,M);var I=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];s[2]&&(I[2][1]=s[2],h=t(h,I)),s[1]&&(I[2][1]=0,I[2][0]=s[0],h=t(h,I)),s[0]&&(I[2][0]=0,I[1][0]=s[0],h=t(h,I));for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[p][m]*=i[p];return e(h)?[h[0][0],h[0][1],h[1][0],h[1][1],h[3][0],h[3][1]]:h[0].concat(h[1],h[2],h[3])}return n}();function Cr(t){return t.toFixed(6).replace(".000000","")}function Hr(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=Pe(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=Pe(e)),n[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(i){var s=gr(n[0][3],r[0][3],i[5]),l=gn(i[0],i[1],i[2],s,i[4]),u=l.map(Cr).join(",");return u}])}function Rr(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}function gr(t,e,n){var r=Rr(t,e);r=(0,uo.Z)(r,-1,1);var i=[];if(r===1)i=t;else for(var s=Math.acos(r),l=Math.sin(n*s)*1/Math.sqrt(1-r*r),u=0;u<4;u++)i.push(t[u]*(Math.cos(n*s)-r*l)+e[u]*l);return i}function bi(t){return t.replace(/[xy]/,"")}function li(t){return t.replace(/(x|y|z|3d)?$/,"3d")}var Di=function(t,e){return t==="perspective"&&e==="perspective"||(t==="matrix"||t==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function Oi(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function($){var J=t[$],nt=J.t,dt=J.d,Et=nt.substring(0,5)==="scale"?1:0;e.push({t:nt,d:dt.map(function(Pt){return typeof Pt=="number"?Is(Et):Is(Et,Pt.unit)})})},s=0;s<t.length;s++)i(s)}var l=[],u=[],h=[];if(t.length!==e.length){var p=Hr(t,e);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]]}else for(var s=0;s<t.length;s++){var m=t[s].t,y=e[s].t,x=t[s].d,T=e[s].d,C=Oh[m],M=Oh[y],I=void 0;if(Di(m,y)){var p=Hr([t[s]],[e[s]]);l.push(p[0]),u.push(p[1]),h.push(["matrix",[p[2]]]);continue}else if(m===y)I=m;else if(C[2]&&M[2]&&bi(m)===bi(y))I=bi(m),x=C[2](x),T=M[2](T);else if(C[1]&&M[1]&&li(m)===li(y))I=li(m),x=C[1](x),T=M[1](T);else{var p=Hr(t,e);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]];break}for(var D=[],U=[],Z=[],G=0;G<x.length;G++){var p=Op(x[G],T[G],n,!1,G);D[G]=p[0],U[G]=p[1],Z.push(p[2])}l.push(D),u.push(U),h.push([I,Z])}if(r){var W=l;l=u,u=W}return[l,u,function($){return $.map(function(J,nt){var dt=J.map(function(Et,Pt){return h[nt][1][Pt](Et)}).join(",");return h[nt][0]==="matrix"&&dt.split(",").length===16&&(h[nt][0]="matrix3d"),h[nt][0]==="matrix3d"&&dt.split(",").length===6&&(h[nt][0]="matrix"),h[nt][0]+"("+dt+")"}).join(" ")}]}var Mi=ua(function(t){if(Si(t)){if(t==="text-anchor")return[Is(0,"px"),Is(0,"px")];var e=t.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Ef(hi(e[0])),Ef(hi(e[1]))]}else return[Is(t[0]||0,"px"),Is(t[1]||0,"px")]}),Gi=function(t){if(Si(t)){if(t==="text-anchor")return[Is(0,"px"),Is(0,"px")];var e=t.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Qs(hi(e[0])),Qs(hi(e[1]))]}else return[Is(t[0]||0,"px"),Is(t[1]||0,"px")]};function hi(t){return t==="center"?"50%":t==="left"||t==="top"?"0%":t==="right"||t==="bottom"?"100%":t}var Pi=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:io.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:io.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:io.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:io.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:io.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:io.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:io.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:io.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:io.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:io.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:io.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:io.FILTER},{n:"clipPath",syntax:io.DEFINED_PATH},{n:"textPath",syntax:io.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:io.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:io.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:io.COORDINATE},{n:"y1",int:!0,l:!0,syntax:io.COORDINATE},{n:"z1",int:!0,l:!0,syntax:io.COORDINATE},{n:"x2",int:!0,l:!0,syntax:io.COORDINATE},{n:"y2",int:!0,l:!0,syntax:io.COORDINATE},{n:"z2",int:!0,l:!0,syntax:io.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:io.PATH,p:50},{n:"points",int:!0,l:!0,syntax:io.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:io.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:io.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:io.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:io.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:io.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:io.NUMBER,d:function(t){return t===Gr.PATH||t===Gr.POLYGON||t===Gr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:io.MARKER},{n:"markerEnd",syntax:io.MARKER},{n:"markerMid",syntax:io.MARKER},{n:"markerStartOffset",syntax:io.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:io.LENGTH,l:!0,int:!0,d:"0"}],ur=Pi.filter(function(t){return!!t.l}).map(function(t){return t.n}),Lr={},gi=new WeakMap,to=function(t,e){var n=gi.get(t);return!n||n.length===0?!0:n.includes(e)},ri=function(){function t(e){var n=this;this.runtime=e,Pi.forEach(function(r){n.registerMetadata(r)})}return t.prototype.registerMetadata=function(e){(0,F.ev)([e.n],(0,F.CR)(e.a||[]),!1).forEach(function(n){Lr[n]=e})},t.prototype.unregisterMetadata=function(e){delete Lr[e]},t.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},t.prototype.processProperties=function(e,n,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var m=r.skipUpdateAttribute,y=r.skipParse,x=r.forceUpdateGeometry,T=r.usedAttributes,C=r.memoize,M=x,I=Object.keys(n);I.forEach(function(D){var U;m||(e.attributes[D]=n[D]),!M&&(!((U=Lr[D])===null||U===void 0)&&U.l)&&(M=!0)}),y||I.forEach(function(D){e.computedStyle[D]=i.parseProperty(D,e.attributes[D],e,C)}),T!=null&&T.length&&(I=Array.from(new Set(I.concat(T)))),I.forEach(function(D){D in e.computedStyle&&(e.parsedStyle[D]=i.computeProperty(D,e.computedStyle[D],e,C))}),M&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),I.forEach(function(D){D in e.parsedStyle&&i.postProcessProperty(D,e,I)}),this.runtime.enableCSSParsing&&e.children.length&&I.forEach(function(D){D in e.parsedStyle&&i.isPropertyInheritable(D)&&e.children.forEach(function(U){U.internalSetAttribute(D,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,n);var s=Object.keys(n),l=e.parsedStyle.clipPath,u=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,n);var h=!!r.forceUpdateGeometry;if(!h){for(var p=0;p<ur.length;p++)if(ur[p]in n){h=!0;break}}n.fill&&(e.parsedStyle.fill=$h(n.fill)),n.stroke&&(e.parsedStyle.stroke=$h(n.stroke)),n.shadowColor&&(e.parsedStyle.shadowColor=$h(n.shadowColor)),n.filter&&(e.parsedStyle.filter=fm(n.filter)),(0,tr.Z)(n.radius)||(e.parsedStyle.radius=Xd(n.radius,4)),(0,tr.Z)(n.lineDash)||(e.parsedStyle.lineDash=Xd(n.lineDash,2)),n.points&&(e.parsedStyle.points=cu(n.points)),n.d===""&&(e.parsedStyle.d=(0,F.pi)({},D0)),n.d&&(e.parsedStyle.d=z0(n.d)),n.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:n.textTransform},e,null),Jr(n.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",l,n.clipPath,e,this.runtime),n.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",u,n.offsetPath,e,this.runtime),n.transform&&(e.parsedStyle.transform=av(n.transform)),n.transformOrigin&&(e.parsedStyle.transformOrigin=Mi(n.transformOrigin)),n.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerStart,n.markerStart,null,null)),n.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerEnd,n.markerEnd,null,null)),n.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",n.markerMid,n.markerMid,null,null)),(0,tr.Z)(n.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,s),(0,tr.Z)(n.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,s),n.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,s),n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,s),h&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},t.prototype.parseProperty=function(e,n,r,i){var s=Lr[e],l=n;if((n===""||(0,tr.Z)(n))&&(n="unset"),n==="unset"||n==="initial"||n==="inherit")l=Hd(n);else if(s){var u=s.k,h=s.syntax,p=h&&this.getPropertySyntax(h);u&&u.indexOf(n)>-1?l=Hd(n):p&&(!i&&p.parserUnmemoize?l=p.parserUnmemoize(n,r):p.parser&&(l=p.parser(n,r)))}return l},t.prototype.computeProperty=function(e,n,r,i){var s=Lr[e],l=r.id==="g-root",u=n;if(s){var h=s.syntax,p=s.inh,m=s.d;if(n instanceof ol){var y=n.value;if(y==="unset"&&(p&&!l?y="inherit":y="initial"),y==="initial")(0,tr.Z)(m)||(n=this.parseProperty(e,Ff(m)?m(r.nodeName):m,r,i));else if(y==="inherit"){var x=this.tryToResolveProperty(r,e,{inherited:!0});if((0,tr.Z)(x)){this.addUnresolveProperty(r,e);return}else return x}}var T=h&&this.getPropertySyntax(h);if(T&&T.calculator){var C=r.parsedStyle[e];u=T.calculator(e,C,n,r,this.runtime)}else n instanceof ol?u=n.value:u=n}return u},t.prototype.postProcessProperty=function(e,n,r){var i=Lr[e];if(i&&i.syntax){var s=i.syntax&&this.getPropertySyntax(i.syntax),l=s;l&&l.postProcessor&&l.postProcessor(n,r)}},t.prototype.addUnresolveProperty=function(e,n){var r=gi.get(e);r||(gi.set(e,[]),r=gi.get(e)),r.indexOf(n)===-1&&r.push(n)},t.prototype.tryToResolveProperty=function(e,n,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&to(e.parentElement,n)){var s=e.parentElement.parsedStyle[n];return s==="unset"||s==="initial"||s==="inherit"?void 0:s}},t.prototype.recalc=function(e){var n=gi.get(e);if(n&&n.length){var r={};n.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),gi.delete(e)}},t.prototype.updateGeometry=function(e){var n=e.nodeName,r=this.runtime.geometryUpdaterFactory[n];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new vn),i.renderBounds||(i.renderBounds=new vn);var s=e.parsedStyle,l=r.update(s,e),u=l.cx,h=u===void 0?0:u,p=l.cy,m=p===void 0?0:p,y=l.cz,x=y===void 0?0:y,T=l.hwidth,C=T===void 0?0:T,M=l.hheight,I=M===void 0?0:M,D=l.hdepth,U=D===void 0?0:D,Z=[Math.abs(C),Math.abs(I),U],G=s,W=G.stroke,$=G.lineWidth,J=$===void 0?1:$,nt=G.increasedLineWidthForHitTesting,dt=nt===void 0?0:nt,Et=G.shadowType,Pt=Et===void 0?"outer":Et,Ht=G.shadowColor,Ct=G.filter,Ft=Ct===void 0?[]:Ct,jt=G.transformOrigin,qt=[h,m,x];i.contentBounds.update(qt,Z);var Ee=n===Gr.POLYLINE||n===Gr.POLYGON||n===Gr.PATH?Math.SQRT2:.5,oe=W&&!W.isNone;if(oe){var _e=((J||0)+(dt||0))*Ee;Z[0]+=_e,Z[1]+=_e}if(i.renderBounds.update(qt,Z),Ht&&Pt&&Pt!=="inner"){var hn=i.renderBounds,Dn=hn.min,Kn=hn.max,Jn=s,zr=Jn.shadowBlur,ui=Jn.shadowOffsetX,Ki=Jn.shadowOffsetY,Qr=zr||0,Kr=ui||0,Co=Ki||0,Qi=Dn[0]-Qr+Kr,ji=Kn[0]+Qr+Kr,_o=Dn[1]-Qr+Co,Go=Kn[1]+Qr+Co;Dn[0]=Math.min(Dn[0],Qi),Kn[0]=Math.max(Kn[0],ji),Dn[1]=Math.min(Dn[1],_o),Kn[1]=Math.max(Kn[1],Go),i.renderBounds.setMinMax(Dn,Kn)}Ft.forEach(function(ss){var Tl=ss.name,Ou=ss.params;if(Tl==="blur"){var Wf=Ou[0].value;i.renderBounds.update(i.renderBounds.center,ah(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[Wf,Wf,0]))}else if(Tl==="drop-shadow"){var Hc=Ou[0].value,ph=Ou[1].value,Cu=Ou[2].value,Fd=i.renderBounds,xc=Fd.min,Pc=Fd.max,kh=xc[0]-Cu+Hc,Rf=Pc[0]+Cu+Hc,Jo=xc[1]-Cu+ph,Xa=Pc[1]+Cu+ph;xc[0]=Math.min(xc[0],kh),Pc[0]=Math.max(Pc[0],Rf),xc[1]=Math.min(xc[1],Jo),Pc[1]=Math.max(Pc[1],Xa),i.renderBounds.setMinMax(xc,Pc)}}),e.geometry.dirty=!1;var na=C<0,wa=I<0,js=(na?-1:1)*(jt?gl(jt[0],0,e,!0):0),ba=(wa?-1:1)*(jt?gl(jt[1],1,e,!0):0);(js||ba)&&e.setOrigin(js,ba)}},t.prototype.updateSizeAttenuation=function(e,n){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/n,e.nodeName===Gr.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/n)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===Gr.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},t.prototype.isPropertyInheritable=function(e){var n=Lr[e];return n?n.inh:!1},t}(),oo=function(){function t(){this.parser=Wd,this.parserUnmemoize=B0,this.parserWithCSSDisabled=null,this.mixer=r0}return t.prototype.calculator=function(e,n,r,i){return dc(r)},t}(),yi=function(){function t(){}return t.prototype.calculator=function(e,n,r,i,s){return r instanceof ol&&(r=null),s.sceneGraphService.updateDisplayObjectDependency(e,n,r,i),e==="clipPath"&&i.forEach(function(l){l.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(l)}),r},t}(),eo=function(){function t(){this.parser=$h,this.parserWithCSSDisabled=$h,this.mixer=nv}return t.prototype.calculator=function(e,n,r,i){return r instanceof ol?r.value==="none"?lf:Ep:r},t}(),oi=function(){function t(){this.parser=fm}return t.prototype.calculator=function(e,n,r){return r instanceof ol?[]:r},t}();function Yi(t){var e=t.parsedStyle.fontSize;return(0,tr.Z)(e)?null:e}var ko=function(){function t(){this.parser=Ef,this.parserUnmemoize=Qs,this.parserWithCSSDisabled=null,this.mixer=r0}return t.prototype.calculator=function(e,n,r,i,s){var l;if((0,ge.Z)(r))return r;if(ya.isRelativeUnit(r.unit)){var u=s.styleValueRegistry;if(r.unit===Tn.kPercentage)return 0;if(r.unit===Tn.kEms){if(i.parentNode){var h=Yi(i.parentNode);if(h)return h*=r.value,h;u.addUnresolveProperty(i,e)}else u.addUnresolveProperty(i,e);return 0}else if(r.unit===Tn.kRems){if(!((l=i==null?void 0:i.ownerDocument)===null||l===void 0)&&l.documentElement){var h=Yi(i.ownerDocument.documentElement);if(h)return h*=r.value,h;u.addUnresolveProperty(i,e)}else u.addUnresolveProperty(i,e);return 0}}else return r.value},t}(),fa=function(){function t(){this.mixer=Rp}return t.prototype.parser=function(e){var n=Qh((0,ge.Z)(e)?[e]:e),r;return n.length===1?r=[n[0],n[0]]:r=[n[0],n[1]],r},t.prototype.calculator=function(e,n,r){return r.map(function(i){return i.value})},t}(),$i=function(){function t(){this.mixer=Rp}return t.prototype.parser=function(e){var n=Qh((0,ge.Z)(e)?[e]:e),r;return n.length===1?r=[n[0],n[0],n[0],n[0]]:n.length===2?r=[n[0],n[1],n[0],n[1]]:n.length===3?r=[n[0],n[1],n[2],n[1]]:r=[n[0],n[1],n[2],n[3]],r},t.prototype.calculator=function(e,n,r){return r.map(function(i){return i.value})},t}(),_i=function(){function t(){}return t.prototype.calculator=function(e,n,r,i){r instanceof ol&&(r=null);var s=r==null?void 0:r.cloneNode(!0);return s&&(s.style.isMarker=!0),s},t}(),qr=function(){function t(){this.mixer=r0,this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null}return t.prototype.calculator=function(e,n,r){return r.value},t}(),Uo=function(){function t(){this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null,this.mixer=i0(0,1)}return t.prototype.calculator=function(e,n,r){return r.value},t.prototype.postProcessor=function(e){var n=e.parsedStyle,r=n.offsetPath,i=n.offsetDistance;if(r){var s=r.nodeName;if(s===Gr.LINE||s===Gr.PATH||s===Gr.POLYLINE){var l=r.getPoint(i);l&&e.setLocalPosition(l.x,l.y)}}},t}(),Ua=function(){function t(){this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null,this.mixer=i0(0,1)}return t.prototype.calculator=function(e,n,r){return r.value},t}(),lo=function(){function t(){this.parser=z0,this.parserWithCSSDisabled=z0,this.mixer=ov}return t.prototype.calculator=function(e,n,r){return r instanceof ol&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Or(0,0,0,0)}:r},t}(),La=function(){function t(){this.parser=cu,this.mixer=pm}return t}(),ha=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.mixer=i0(0,1/0),n}return e}(ko),Ko=function(){function t(){}return t.prototype.calculator=function(e,n,r,i){return r instanceof ol?r.value==="unset"?"":r.value:"".concat(r)},t.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},t}(),hs=function(){function t(){}return t.prototype.calculator=function(e,n,r,i){var s=i.getAttribute("text");if(s){var l=s;r.value==="capitalize"?l=s.charAt(0).toUpperCase()+s.slice(1):r.value==="lowercase"?l=s.toLowerCase():r.value==="uppercase"&&(l=s.toUpperCase()),i.parsedStyle.text=l}return r.value},t}(),yl={},qc=0;function Va(t,e){if(t){var n=typeof t=="string"?t:t.id||qc++;yl[n]&&yl[n].destroy(),yl[n]=e}}var hl=typeof window!="undefined"&&typeof window.document!="undefined";function Js(t){return!!t.getAttribute}function Yl(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;Ul(t[i],e)<0?n=i+1:r=i}return n}function Ul(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var s=i.childNodes||[];return s.indexOf(t)-s.indexOf(e)}}return n-r}function rs(t){var e,n=t;do{var r=(e=n.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return n;n=n.parentElement}while(n!==null);return null}var ql="px";function tc(t,e,n){hl&&t.style&&(t.style.width=e+ql,t.style.height=n+ql)}function mc(t,e){if(hl)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}function Oa(t){var e=mc(t,"width");return e==="auto"?t.offsetWidth:parseFloat(e)}function $c(t){var e=mc(t,"height");return e==="auto"?t.offsetHeight:parseFloat(e)}var Os=1,Zo={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Ea=typeof performance=="object"&&performance.now?performance:Date;function ja(t,e,n){t===void 0&&(t="auto");var r=!1,i=!1,s=!!e&&!e.isNone,l=!!n&&!n.isNone;return t==="visiblepainted"||t==="painted"||t==="auto"?(r=s,i=l):t==="visiblefill"||t==="fill"?r=!0:t==="visiblestroke"||t==="stroke"?i=!0:(t==="visible"||t==="all")&&(r=!0,i=!0),[r,i]}var $l=1,ch=function(){return $l++},We=typeof self=="object"&&self.self==self?self:typeof it.g=="object"&&it.g.global==it.g?it.g:{},Pr=Date.now(),_r=function(){return We.performance&&typeof We.performance.now=="function"?We.performance.now():Date.now()-Pr},no={},Da=Date.now(),ys=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");var e=Date.now(),n=e-Da,r=n>16?0:16-n,i=ch();return no[i]=t,Object.keys(no).length>1||setTimeout(function(){Da=e;var s=no;no={},Object.keys(s).forEach(function(l){return s[l](_r())})},r),i},he=function(t){delete no[t]},je=["","webkit","moz","ms","o"],_n=function(t){return typeof t!="string"?ys:t===""?We.requestAnimationFrame:We[t+"RequestAnimationFrame"]},wr=function(t){return typeof t!="string"?he:t===""?We.cancelAnimationFrame:We[t+"CancelAnimationFrame"]||We[t+"CancelRequestAnimationFrame"]},yr=function(t,e){for(var n=0;t[n]!==void 0;){if(e(t[n]))return t[n];n=n+1}},In=yr(je,function(t){return!!_n(t)}),Fn=_n(In),Yn=wr(In);We.requestAnimationFrame=Fn,We.cancelAnimationFrame=Yn;var an=function(){function t(){this.callbacks=[]}return t.prototype.getCallbacksNum=function(){return this.callbacks.length},t.prototype.tapPromise=function(e,n){this.callbacks.push(n)},t.prototype.promise=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,(0,F.ev)([],(0,F.CR)(e),!1))}))},t}(),Nn=function(){function t(){this.callbacks=[]}return t.prototype.tapPromise=function(e,n){this.callbacks.push(n)},t.prototype.promise=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,F.mG)(this,void 0,void 0,function(){var r,i,s,l;return(0,F.Jh)(this,function(u){switch(u.label){case 0:return this.callbacks.length?[4,(l=this.callbacks)[0].apply(l,(0,F.ev)([],(0,F.CR)(e),!1))]:[3,6];case 1:r=u.sent(),i=0,u.label=2;case 2:return i<this.callbacks.length-1?(s=this.callbacks[i],[4,s(r)]):[3,5];case 3:r=u.sent(),u.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},t}(),Re=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(e,n){this.callbacks.push(n)},t.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(n){n.apply(void 0,e)})},t}(),Bn=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(e,n){this.callbacks.push(n)},t.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,n=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];n=i(n)}return n}return null},t}(),Dr=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Fr=/([\"\'])[^\'\"]+\1/;function di(t){for(var e=t.fontSize,n=e===void 0?16:e,r=t.fontFamily,i=r===void 0?"sans-serif":r,s=t.fontStyle,l=s===void 0?"normal":s,u=t.fontVariant,h=u===void 0?"normal":u,p=t.fontWeight,m=p===void 0?"normal":p,y=(0,ge.Z)(n)&&"".concat(n,"px")||"16px",x=i.split(","),T=x.length-1;T>=0;T--){var C=x[T].trim();!Fr.test(C)&&Dr.indexOf(C)<0&&(C='"'.concat(C,'"')),x[T]=C}return"".concat(l," ").concat(h," ").concat(m," ").concat(y," ").concat(x.join(","))}function $r(t,e,n){return ae.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var fi=1e-5,Oo=ae.create(),Bi=ae.create();function yo(t,e){if(t.length){var n=ae.identity(Oo);t.forEach(function(r){var i=r.t,s=r.d;if(i==="scale"){var l=(s==null?void 0:s.map(function(D){return Math.max(D.value,fi)}))||[1,1];ae.fromScaling(Bi,[l[0],l[1],1])}else if(i==="scalex"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,fi)}))||[1];ae.fromScaling(Bi,[l[0],1,1])}else if(i==="scaley"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,fi)}))||[1];ae.fromScaling(Bi,[1,l[0],1])}else if(i==="scalez"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,fi)}))||[1];ae.fromScaling(Bi,[1,1,l[0]])}else if(i==="scale3d"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,fi)}))||[1,1,1];ae.fromScaling(Bi,[l[0],l[1],l[2]])}else if(i==="translate"){var u=s||[gs,gs];ae.fromTranslation(Bi,[u[0].value,u[1].value,0])}else if(i==="translatex"){var u=s||[gs];ae.fromTranslation(Bi,[u[0].value,0,0])}else if(i==="translatey"){var u=s||[gs];ae.fromTranslation(Bi,[0,u[0].value,0])}else if(i==="translatez"){var u=s||[gs];ae.fromTranslation(Bi,[0,0,u[0].value])}else if(i==="translate3d"){var u=s||[gs,gs,gs];ae.fromTranslation(Bi,[u[0].value,u[1].value,u[2].value])}else if(i==="rotate"){var h=s||[Bl];ae.fromZRotation(Bi,Qa(dc(h[0])))}else if(i==="rotatex"){var h=s||[Bl];ae.fromXRotation(Bi,Qa(dc(h[0])))}else if(i==="rotatey"){var h=s||[Bl];ae.fromYRotation(Bi,Qa(dc(h[0])))}else if(i==="rotatez"){var h=s||[Bl];ae.fromZRotation(Bi,Qa(dc(h[0])))}else if(i==="rotate3d"){var h=s||[gs,gs,gs,Bl];ae.fromRotation(Bi,Qa(dc(h[3])),[h[0].value,h[1].value,h[2].value])}else if(i==="skew"){var p=(s==null?void 0:s.map(function(D){return D.value}))||[0,0];$r(Bi,Qa(p[0]),Qa(p[1]))}else if(i==="skewx"){var p=(s==null?void 0:s.map(function(U){return U.value}))||[0];$r(Bi,Qa(p[0]),0)}else if(i==="skewy"){var p=(s==null?void 0:s.map(function(U){return U.value}))||[0];$r(Bi,0,Qa(p[0]))}else if(i==="matrix"){var m=(0,F.CR)(s.map(function(D){return D.value}),6),y=m[0],x=m[1],T=m[2],C=m[3],M=m[4],I=m[5];ae.set(Bi,y,x,0,0,T,C,0,0,0,0,1,0,M,I,0,1)}else i==="matrix3d"&&ae.set.apply(ae,(0,F.ev)([Bi],(0,F.CR)(s.map(function(D){return D.value})),!1));ae.mul(n,n,Bi)}),e.setLocalTransform(n)}else e.resetLocalTransform();return e.getLocalTransform()}var Yo=function(){function t(){this.parser=av,this.parserUnmemoize=Yv,this.parserWithCSSDisabled=Yv,this.mixer=Oi}return t.prototype.calculator=function(e,n,r,i){return r instanceof ol?[]:r},t.prototype.postProcessor=function(e){var n=e.parsedStyle.transform;yo(n,e)},t}(),ea=function(){function t(){this.parser=Mi,this.parserUnmemoize=Gi}return t.prototype.postProcessor=function(e){var n=e.parsedStyle.transformOrigin;n[0].unit===Tn.kPixels&&n[1].unit===Tn.kPixels?e.setOrigin(n[0].value,n[1].value):e.getGeometryBounds()},t}(),Ss=function(){function t(){this.parser=yu,this.parserUnmemoize=su}return t.prototype.calculator=function(e,n,r,i){return r.value},t.prototype.postProcessor=function(e){if(e.parentNode){var n=e.parentNode,r=n.renderable,i=n.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=lh.Z_INDEX_CHANGED)}},t}(),Sc=function(){function t(){}return t.prototype.update=function(e,n){var r=e.cx,i=r===void 0?0:r,s=e.cy,l=s===void 0?0:s,u=e.r,h=u===void 0?0:u;return{cx:i,cy:l,hwidth:h,hheight:h}},t}(),bu=function(){function t(){}return t.prototype.update=function(e,n){var r=e.cx,i=r===void 0?0:r,s=e.cy,l=s===void 0?0:s,u=e.rx,h=u===void 0?0:u,p=e.ry,m=p===void 0?0:p;return{cx:i,cy:l,hwidth:h,hheight:m}},t}(),mm=function(){function t(){}return t.prototype.update=function(e){var n=e.x1,r=e.y1,i=e.x2,s=e.y2,l=Math.min(n,i),u=Math.max(n,i),h=Math.min(r,s),p=Math.max(r,s),m=u-l,y=p-h,x=m/2,T=y/2;return{cx:l+x,cy:h+T,hwidth:x,hheight:T}},t}(),uf=function(){function t(){}return t.prototype.update=function(e){var n=e.d,r=n.rect,i=r.x,s=r.y,l=r.width,u=r.height,h=l/2,p=u/2;return{cx:i+h,cy:s+p,hwidth:h,hheight:p}},t}(),Kv=function(){function t(){}return t.prototype.update=function(e){if(e.points&&Ps(e.points.points)){var n=e.points.points,r=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(n.map(function(y){return y[0]})),!1)),i=Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(n.map(function(y){return y[0]})),!1)),s=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(n.map(function(y){return y[1]})),!1)),l=Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(n.map(function(y){return y[1]})),!1)),u=i-r,h=l-s,p=u/2,m=h/2;return{cx:r+p,cy:s+m,hwidth:p,hheight:m}}return{cx:0,cy:0,hwidth:0,hheight:0}},t}(),Cd=function(){function t(){}return t.prototype.update=function(e,n){var r=e.x,i=r===void 0?0:r,s=e.y,l=s===void 0?0:s,u=e.src,h=e.width,p=h===void 0?0:h,m=e.height,y=m===void 0?0:m,x=p,T=y;return u&&!Si(u)&&(x||(x=u.width,e.width=x),T||(T=u.height,e.height=T)),{cx:i+x/2,cy:l+T/2,hwidth:x/2,hheight:T/2}},t}(),$d=function(){function t(e){this.globalRuntime=e}return t.prototype.isReadyToMeasure=function(e,n){var r=e.text,i=e.textAlign,s=e.textBaseline,l=e.fontSize,u=e.fontStyle,h=e.fontWeight,p=e.fontVariant,m=e.lineWidth;return g.enableCSSParsing?r&&l&&u&&h&&p&&i&&s&&!(0,tr.Z)(m):r},t.prototype.update=function(e,n){var r,i,s=e.text,l=e.textAlign,u=l===void 0?"start":l,h=e.lineWidth,p=h===void 0?1:h,m=e.textBaseline,y=m===void 0?"alphabetic":m,x=e.dx,T=x===void 0?0:x,C=e.dy,M=C===void 0?0:C,I=e.x,D=I===void 0?0:I,U=e.y,Z=U===void 0?0:U;if(!this.isReadyToMeasure(e,n))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var G=(((i=(r=n==null?void 0:n.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,W=this.globalRuntime.textService.measureText(s,e,G);e.metrics=W;var $=W.width,J=W.height,nt=W.lineHeight,dt=W.fontProperties,Et=$/2,Pt=J/2,Ht=D+Et;u==="center"||u==="middle"?Ht+=p/2-Et:(u==="right"||u==="end")&&(Ht+=p-Et*2);var Ct=Z-Pt;return y==="middle"?Ct+=Pt:y==="top"||y==="hanging"?Ct+=Pt*2:y==="alphabetic"?Ct+=this.globalRuntime.enableCSSParsing?nt-dt.ascent:0:(y==="bottom"||y==="ideographic")&&(Ct+=0),T&&(Ht+=T),M&&(Ct+=M),{cx:Ht,cy:Ct,hwidth:Et,hheight:Pt}},t}(),O_=function(){function t(){}return t.prototype.update=function(e,n){return{cx:0,cy:0,hwidth:0,hheight:0}},t}();function C_(t){return!!t.type}var Qv=function(){function t(e){this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ar,this.page=new ar,this.canvas=new ar,this.viewport=new ar,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),t.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(t.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),t.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},t.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.prototype.initEvent=function(){},t.prototype.initUIEvent=function(){},t.prototype.clone=function(){throw new Error(cr)},t}(),Jv=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.client=new ar,n.movement=new ar,n.offset=new ar,n.global=new ar,n.screen=new ar,n}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)},e.prototype.initMouseEvent=function(){throw new Error(cr)},e}(Qv),s0=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.width=0,n.height=0,n.isPrimary=!1,n}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(Jv),tg=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(Jv),tl=function(t){(0,F.ZT)(e,t);function e(n,r){var i=t.call(this,null)||this;return i.type=n,i.detail=r,Object.assign(i,r),i}return e}(Qv),R_=":",Tc=function(){function t(){this.emitter=new ze}return t.prototype.on=function(e,n,r){return this.addEventListener(e,n,r),this},t.prototype.addEventListener=function(e,n,r){var i=so(r)&&r||sa(r)&&r.capture,s=sa(r)&&r.once,l=Ff(n)?void 0:n,u=!1,h="";if(e.indexOf(R_)>-1){var p=(0,F.CR)(e.split(R_),2),m=p[0],y=p[1];e=y,h=m,u=!0}if(e=i?"".concat(e,"capture"):e,n=Ff(n)?n:n.handleEvent,u){var x=n;n=function(){for(var T,C=[],M=0;M<arguments.length;M++)C[M]=arguments[M];((T=C[0].target)===null||T===void 0?void 0:T.name)===h&&x.apply(void 0,(0,F.ev)([],(0,F.CR)(C),!1))}}return s?this.emitter.once(e,n,l):this.emitter.on(e,n,l),this},t.prototype.off=function(e,n,r){return e?this.removeEventListener(e,n,r):this.removeAllEventListeners(),this},t.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},t.prototype.removeEventListener=function(e,n,r){var i=so(r)&&r||sa(r)&&r.capture,s=Ff(n)?void 0:n;return e=i?"".concat(e,"capture"):e,n=Ff(n)?n:n==null?void 0:n.handleEvent,this.emitter.off(e,n,s),this},t.prototype.emit=function(e,n){this.dispatchEvent(new tl(e,n))},t.prototype.dispatchEvent=function(e,n){var r,i;if(n===void 0&&(n=!1),!C_(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var s;if(this.document?s=this:this.defaultView?s=this.defaultView:s=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,s){if(e.manager=s.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],n||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,n)}return!e.defaultPrevented},t}(),Za=function(t){(0,F.ZT)(e,t);function e(){var n=t.call(this)||this;return n.shadow=!1,n.ownerDocument=null,n.isConnected=!1,n.baseURI="",n.childNodes=[],n.nodeType=0,n.nodeName="",n.nodeValue=null,n.parentNode=null,n}return e.isNode=function(n){return!!n.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var n,r,i="";this.nodeName===Gr.TEXT&&(i+=this.style.text);try{for(var s=(0,F.XA)(this.childNodes),l=s.next();!l.done;l=s.next()){var u=l.value;u.nodeName===Gr.TEXT?i+=u.nodeValue:i+=u.textContent}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},set:function(n){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===Gr.TEXT&&(this.style.text="".concat(n))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(n){return n===void 0&&(n={}),this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(n){throw new Error(cr)},e.prototype.lookupNamespaceURI=function(n){throw new Error(cr)},e.prototype.lookupPrefix=function(n){throw new Error(cr)},e.prototype.normalize=function(){throw new Error(cr)},e.prototype.isEqualNode=function(n){return this===n},e.prototype.isSameNode=function(n){return this.isEqualNode(n)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(n){var r;if(n===this)return 0;for(var i=n,s=this,l=[i],u=[s];(r=i.parentNode)!==null&&r!==void 0?r:s.parentNode;)i=i.parentNode?(l.push(i.parentNode),i.parentNode):i,s=s.parentNode?(u.push(s.parentNode),s.parentNode):s;if(i!==s)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var h=l.length>u.length?l:u,p=h===l?u:l;if(h[h.length-p.length]===p[0])return h===l?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var m=h.length-p.length,y=p.length-1;y>=0;y--){var x=p[y],T=h[m+y];if(T!==x){var C=x.parentNode.childNodes;return C.indexOf(x)<C.indexOf(T)?p===l?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:h===l?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(n){return this.contains(n)},e.prototype.contains=function(n){for(var r=n;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(n){for(var r=this;n>0&&r;)r=r.parentNode,n--;return r},e.prototype.forEach=function(n,r){r===void 0&&(r=!1),n(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(n)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(Tc),sy=2048,ax=function(){function t(e,n){var r=this;this.globalRuntime=e,this.context=n,this.emitter=new ze,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=ae.create(),this.tmpVec3=Vt.Ue(),this.onPointerDown=function(i){var s=r.createPointerEvent(i);if(r.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")r.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightdown":"mousedown")}var u=r.trackingData(i.pointerId);u.pressTargetsByButton[i.button]=s.composedPath(),r.freeEvent(s)},this.onPointerUp=function(i){var s,l=Ea.now(),u=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(u,"pointerup"),u.pointerType==="touch")r.dispatchEvent(u,"touchend");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.dispatchEvent(u,h?"rightup":"mouseup")}var p=r.trackingData(i.pointerId),m=r.findMountedTarget(p.pressTargetsByButton[i.button]),y=m;if(m&&!u.composedPath().includes(m)){for(var x=m;x&&!u.composedPath().includes(x);){if(u.currentTarget=x,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch")r.notifyTarget(u,"touchendoutside");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.notifyTarget(u,h?"rightupoutside":"mouseupoutside")}Za.isNode(x)&&(x=x.parentNode)}delete p.pressTargetsByButton[i.button],y=x}if(y){var T=r.clonePointerEvent(u,"click");T.target=y,T.path=[],p.clicksByButton[i.button]||(p.clicksByButton[i.button]={clickCount:0,target:T.target,timeStamp:l});var C=r.context.renderingContext.root.ownerDocument.defaultView,M=p.clicksByButton[i.button];M.target===T.target&&l-M.timeStamp<C.dblClickSpeed?++M.clickCount:M.clickCount=1,M.target=T.target,M.timeStamp=l,T.detail=M.clickCount,!((s=u.detail)===null||s===void 0)&&s.preventClick||(!r.context.config.useNativeClickEvent&&(T.pointerType==="mouse"||T.pointerType==="touch")&&r.dispatchEvent(T,"click"),r.dispatchEvent(T,"pointertap")),r.freeEvent(T)}r.freeEvent(u)},this.onPointerMove=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),l=s.pointerType==="mouse"||s.pointerType==="pen",u=r.trackingData(i.pointerId),h=r.findMountedTarget(u.overTargets);if(u.overTargets&&h!==s.target){var p=i.type==="mousemove"?"mouseout":"pointerout",m=r.createPointerEvent(i,p,h||void 0);if(r.dispatchEvent(m,"pointerout"),l&&r.dispatchEvent(m,"mouseout"),!s.composedPath().includes(h)){var y=r.createPointerEvent(i,"pointerleave",h||void 0);for(y.eventPhase=y.AT_TARGET;y.target&&!s.composedPath().includes(y.target);)y.currentTarget=y.target,r.notifyTarget(y),l&&r.notifyTarget(y,"mouseleave"),Za.isNode(y.target)&&(y.target=y.target.parentNode);r.freeEvent(y)}r.freeEvent(m)}if(h!==s.target){var x=i.type==="mousemove"?"mouseover":"pointerover",T=r.clonePointerEvent(s,x);r.dispatchEvent(T,"pointerover"),l&&r.dispatchEvent(T,"mouseover");for(var C=h&&Za.isNode(h)&&h.parentNode;C&&C!==(Za.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&C!==s.target;)C=C.parentNode;var M=!C||C===(Za.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(M){var I=r.clonePointerEvent(s,"pointerenter");for(I.eventPhase=I.AT_TARGET;I.target&&I.target!==h&&I.target!==(Za.isNode(r.rootTarget)&&r.rootTarget.parentNode);)I.currentTarget=I.target,r.notifyTarget(I),l&&r.notifyTarget(I,"mouseenter"),Za.isNode(I.target)&&(I.target=I.target.parentNode);r.freeEvent(I)}r.freeEvent(T)}r.dispatchEvent(s,"pointermove"),s.pointerType==="touch"&&r.dispatchEvent(s,"touchmove"),l&&(r.dispatchEvent(s,"mousemove"),r.cursor=r.getCursor(s.target)),u.overTargets=s.composedPath(),r.freeEvent(s)},this.onPointerOut=function(i){var s=r.trackingData(i.pointerId);if(s.overTargets){var l=i.pointerType==="mouse"||i.pointerType==="pen",u=r.findMountedTarget(s.overTargets),h=r.createPointerEvent(i,"pointerout",u||void 0);r.dispatchEvent(h),l&&r.dispatchEvent(h,"mouseout");var p=r.createPointerEvent(i,"pointerleave",u||void 0);for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==(Za.isNode(r.rootTarget)&&r.rootTarget.parentNode);)p.currentTarget=p.target,r.notifyTarget(p),l&&r.notifyTarget(p,"mouseleave"),Za.isNode(p.target)&&(p.target=p.target.parentNode);s.overTargets=null,r.freeEvent(h),r.freeEvent(p)}r.cursor=null},this.onPointerOver=function(i){var s=r.trackingData(i.pointerId),l=r.createPointerEvent(i),u=l.pointerType==="mouse"||l.pointerType==="pen";r.dispatchEvent(l,"pointerover"),u&&r.dispatchEvent(l,"mouseover"),l.pointerType==="mouse"&&(r.cursor=r.getCursor(l.target));var h=r.clonePointerEvent(l,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==(Za.isNode(r.rootTarget)&&r.rootTarget.parentNode);)h.currentTarget=h.target,r.notifyTarget(h),u&&r.notifyTarget(h,"mouseenter"),Za.isNode(h.target)&&(h.target=h.target.parentNode);s.overTargets=l.composedPath(),r.freeEvent(l),r.freeEvent(h)},this.onPointerUpOutside=function(i){var s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.pressTargetsByButton[i.button]),u=r.createPointerEvent(i);if(l){for(var h=l;h;)u.currentTarget=h,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch"||(u.pointerType==="mouse"||u.pointerType==="pen")&&r.notifyTarget(u,u.button===2?"rightupoutside":"mouseupoutside"),Za.isNode(h)&&(h=h.parentNode);delete s.pressTargetsByButton[i.button]}r.freeEvent(u)},this.onWheel=function(i){var s=r.createWheelEvent(i);r.dispatchEvent(s),r.freeEvent(s)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var s=r.createPointerEvent(i);r.dispatchEvent(s),r.freeEvent(s)}},this.onPointerCancel=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(s),r.freeEvent(s)}}return t.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},t.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},t.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),n=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var s=i.offsetWidth,l=i.offsetHeight;s&&l&&(n=e.width/s,r=e.height/l)}return{scaleX:n,scaleY:r,bbox:e}},t.prototype.client2Viewport=function(e){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new ar((e.x-((s==null?void 0:s.left)||0))/r,(e.y-((s==null?void 0:s.top)||0))/i)},t.prototype.viewport2Client=function(e){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new ar((e.x+((s==null?void 0:s.left)||0))*r,(e.y+((s==null?void 0:s.top)||0))*i)},t.prototype.viewport2Canvas=function(e){var n=e.x,r=e.y,i=this.rootTarget.defaultView,s=i.getCamera(),l=this.context.config,u=l.width,h=l.height,p=s.getPerspectiveInverse(),m=s.getWorldTransform(),y=ae.multiply(this.tmpMatrix,m,p),x=Vt.t8(this.tmpVec3,n/u*2-1,(1-r/h)*2-1,0);return Vt.fF(x,x,y),new ar(x[0],x[1])},t.prototype.canvas2Viewport=function(e){var n=this.rootTarget.defaultView,r=n.getCamera(),i=r.getPerspective(),s=r.getViewTransform(),l=ae.multiply(this.tmpMatrix,i,s),u=Vt.t8(this.tmpVec3,e.x,e.y,0);Vt.fF(this.tmpVec3,this.tmpVec3,l);var h=this.context.config,p=h.width,m=h.height;return new ar((u[0]+1)/2*p,(1-(u[1]+1)/2)*m)},t.prototype.setPickHandler=function(e){this.pickHandler=e},t.prototype.addEventMapping=function(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},t.prototype.mapEvent=function(e){if(this.rootTarget){var n=this.mappingTable[e.type];if(n)for(var r=0,i=n.length;r<i;r++)n[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},t.prototype.dispatchEvent=function(e,n,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,n)}this.emitter.emit(n||e.type,e)},t.prototype.propagate=function(e,n){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!(e.propagationStopped||e.propagationImmediatelyStopped)){var s=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=s+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}},t.prototype.propagationPath=function(e){var n=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return n.unshift(r.document),n;for(var i=0;i<sy&&e!==this.rootTarget;i++)Za.isNode(e)&&e.parentNode&&(n.push(e.parentNode),e=e.parentNode);return r&&n.push(r),n},t.prototype.hitTest=function(e){var n=e.viewportX,r=e.viewportY,i=this.context.config,s=i.width,l=i.height,u=i.disableHitTesting;return n<0||r<0||n>s||r>l?null:!u&&this.pickHandler(e)||this.rootTarget||null},t.prototype.isNativeEventFromCanvas=function(e,n){var r=n==null?void 0:n.target;if(r!=null&&r.shadowRoot&&(r=n.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return n!=null&&n.composedPath?n.composedPath().indexOf(e)>-1:!1},t.prototype.getExistedHTML=function(e){var n,r;if(e.nativeEvent.composedPath)try{for(var i=(0,F.XA)(e.nativeEvent.composedPath()),s=i.next();!s.done;s=i.next()){var l=s.value,u=this.nativeHTMLMap.get(l);if(u)return u}}catch(h){n={error:h}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null},t.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},t.prototype.createPointerEvent=function(e,n,r,i){var s=this.allocateEvent(s0);this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.nativeEvent=e.nativeEvent,s.originalEvent=e;var l=this.getExistedHTML(s),u=this.context.contextService.getDomElement();return s.target=r!=null?r:l||this.isNativeEventFromCanvas(u,s.nativeEvent)&&this.pickTarget(s)||i,typeof n=="string"&&(s.type=n),s},t.prototype.createWheelEvent=function(e){var n=this.allocateEvent(tg);this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e;var r=this.getExistedHTML(n),i=this.context.contextService.getDomElement();return n.target=r||this.isNativeEventFromCanvas(i,n.nativeEvent)&&this.pickTarget(n),n},t.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},t.prototype.cloneWheelEvent=function(e){var n=this.allocateEvent(tg);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=e.type,n},t.prototype.clonePointerEvent=function(e,n){var r=this.allocateEvent(s0);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=n!=null?n:r.type,r},t.prototype.copyPointerData=function(e,n){n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist},t.prototype.copyMouseData=function(e,n){n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.shiftKey=e.shiftKey,n.client.copyFrom(e.client),n.movement.copyFrom(e.movement),n.canvas.copyFrom(e.canvas),n.screen.copyFrom(e.screen),n.global.copyFrom(e.global),n.offset.copyFrom(e.offset)},t.prototype.copyWheelData=function(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ},t.prototype.copyData=function(e,n){n.isTrusted=e.isTrusted,n.timeStamp=Ea.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.page.copyFrom(e.page),n.viewport.copyFrom(e.viewport)},t.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n},t.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)},t.prototype.notifyTarget=function(e,n){n=n!=null?n:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,n)},t.prototype.notifyListeners=function(e,n){var r=e.currentTarget.emitter,i=r._events[n];if(i)if("fn"in i)i.once&&r.removeListener(n,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var s=0;s<i.length&&!e.propagationImmediatelyStopped;s++)i[s].once&&r.removeListener(n,i[s].fn,void 0,!0),i[s].fn.call(e.currentTarget||i[s].context,e)},t.prototype.findMountedTarget=function(e){if(!e)return null;for(var n=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Za.isNode(i)&&i.parentNode===n)n=e[r];else break}return n},t.prototype.getCursor=function(e){for(var n=e;n;){var r=Js(n)&&n.getAttribute("cursor");if(r)return r;n=Za.isNode(n)&&n.parentNode}},t}(),eg=function(){function t(){}return t.prototype.getOrCreateCanvas=function(e,n){if(this.canvas)return this.canvas;if(e||g.offscreenCanvas)this.canvas=e||g.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,F.pi)({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,F.pi)({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,F.pi)({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas},t.prototype.getOrCreateContext=function(e,n){return this.context?this.context:(this.getOrCreateCanvas(e,n),this.context)},t}(),Ch;(function(t){t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE"})(Ch||(Ch={}));var sx=function(){function t(e,n){this.globalRuntime=e,this.context=n,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Re,initAsync:new an,dirtycheck:new Bn,cull:new Bn,beginFrame:new Re,beforeRender:new Re,render:new Re,afterRender:new Re,endFrame:new Re,destroy:new Re,pick:new Nn,pickSync:new Bn,pointerDown:new Re,pointerUp:new Re,pointerMove:new Re,pointerOut:new Re,pointerOver:new Re,pointerWheel:new Re,pointerCancel:new Re,click:new Re}}return t.prototype.init=function(e){var n=this,r=(0,F.pi)((0,F.pi)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){n.inited=!0,e()})},t.prototype.getStats=function(){return this.stats},t.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,n=e.getConfig().enableDirtyRectangleRendering;return!n||this.context.renderingContext.renderReasons.has(Ch.CAMERA_CHANGED)},t.prototype.render=function(e,n,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var l=s.renderReasons.size===1&&s.renderReasons.has(Ch.CAMERA_CHANGED),u=!e.disableRenderHooks||!(e.disableRenderHooks&&l);u&&this.renderDisplayObject(s.root,e,s),this.hooks.beginFrame.call(n),u&&s.renderListCurrentFrame.forEach(function(h){i.hooks.beforeRender.call(h),i.hooks.render.call(h),i.hooks.afterRender.call(h)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),r()}},t.prototype.renderDisplayObject=function(e,n,r){var i=this,s=n.renderer.getConfig(),l=s.enableDirtyCheck,u=s.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var h=e.renderable,p=l?h.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(p){var m=u?this.hooks.cull.call(p,this.context.camera):p;m&&(this.stats.rendered++,r.renderListCurrentFrame.push(m))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var y=e.sortable;y.dirty&&(this.sort(e,y),y.dirty=!1,y.dirtyChildren=[],y.dirtyReason=void 0),(y.sorted||e.childNodes).forEach(function(x){i.renderDisplayObject(x,n,r)})},t.prototype.sort=function(e,n){n.sorted&&n.dirtyReason!==lh.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var s=n.sorted.indexOf(r);s>=0&&n.sorted.splice(s,1)}else if(n.sorted.length===0)n.sorted.push(r);else{var l=Yl(n.sorted,r);n.sorted.splice(l,0,r)}}):n.sorted=e.childNodes.slice().sort(Ul)},t.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},t.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(Ch.DISPLAY_OBJECT_CHANGED)},t}(),sv=/\[\s*(.*)=(.*)\s*\]/,Ip=function(){function t(){}return t.prototype.selectOne=function(e,n){var r=this;if(e.startsWith("."))return n.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return n.find(function(u){return u.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),s=i.name,l=i.value;return s?n.find(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):null}else return n.find(function(u){return n!==u&&u.nodeName===e})},t.prototype.selectAll=function(e,n){var r=this;if(e.startsWith("."))return n.findAll(function(u){return n!==u&&((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return n.findAll(function(u){return n!==u&&u.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),s=i.name,l=i.value;return s?n.findAll(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):[]}else return n.findAll(function(u){return n!==u&&u.nodeName===e})},t.prototype.is=function(e,n){if(e.startsWith("."))return n.className===this.getIdOrClassname(e);if(e.startsWith("#"))return n.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,s=r.value;return i==="name"?n.name===s:this.attributeToString(n,i)===s}else return n.nodeName===e},t.prototype.getIdOrClassname=function(e){return e.substring(1)},t.prototype.getAttribute=function(e){var n=e.match(sv),r="",i="";return n&&n.length>2&&(r=n[1].replace(/"/g,""),i=n[2].replace(/"/g,"")),{name:r,value:i}},t.prototype.attributeToString=function(e,n){if(!e.getAttribute)return"";var r=e.getAttribute(n);return(0,tr.Z)(r)?"":r.toString?r.toString():""},t}(),Wu=function(t){(0,F.ZT)(e,t);function e(n,r,i,s,l,u,h,p){var m=t.call(this,null)||this;return m.relatedNode=r,m.prevValue=i,m.newValue=s,m.attrName=l,m.attrChange=u,m.prevParsedValue=h,m.newParsedValue=p,m.type=n,m}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(Qv),Sa;(function(t){t.REPARENT="reparent",t.DESTROY="destroy",t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.REMOVED="removed",t.MOUNTED="DOMNodeInsertedIntoDocument",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled"})(Sa||(Sa={}));function ec(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var Fc=new Wu(Sa.REPARENT,null,"","","",0,"",""),Lp=function(){function t(e){var n=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new tl(Sa.BOUNDS_CHANGED),this.rotate=function(){var r=ni();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=Vt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.rotateLocal(i,s);else{var m=ni();mn(m,s[0],s[1],s[2]);var y=n.getRotation(i),x=n.getRotation(i.parentNode);Vi(r,x),Rn(r,r),wo(m,r,m),wo(p.localRotation,m,y),Xo(p.localRotation,p.localRotation),h&&n.dirtifyLocal(i,p)}}}(),this.rotateLocal=function(){var r=ni();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=Vt.al(s,l,u));var p=i.transformable;mn(r,s[0],s[1],s[2]),Wi(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}(),this.setEulerAngles=function(){var r=ni();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=Vt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.setLocalEulerAngles(i,s);else{mn(p.localRotation,s[0],s[1],s[2]);var m=n.getRotation(i.parentNode);Vi(r,Rn(ni(),m)),Wi(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}}(),this.translateLocal=function(){return function(r,i,s,l,u){s===void 0&&(s=0),l===void 0&&(l=0),u===void 0&&(u=!0),typeof i=="number"&&(i=Vt.al(i,s,l));var h=r.transformable;Vt.fS(i,Vt.Ue())||(Vt.VC(i,i,h.localRotation),Vt.IH(h.localPosition,h.localPosition,i),u&&n.dirtifyLocal(r,h))}}(),this.setPosition=function(){var r=ae.create(),i=Vt.Ue();return function(s,l,u){u===void 0&&(u=!0);var h=s.transformable;if(i[0]=l[0],i[1]=l[1],i[2]=l[2]||0,!Vt.fS(n.getPosition(s),i)){if(Vt.JG(h.position,i),s.parentNode===null||!s.parentNode.transformable)Vt.JG(h.localPosition,i);else{var p=s.parentNode.transformable;ae.copy(r,p.worldTransform),ae.invert(r,r),Vt.fF(h.localPosition,i,r)}u&&n.dirtifyLocal(s,h)}}}(),this.setLocalPosition=function(){var r=Vt.Ue();return function(i,s,l){l===void 0&&(l=!0);var u=i.transformable;r[0]=s[0],r[1]=s[1],r[2]=s[2]||0,!Vt.fS(u.localPosition,r)&&(Vt.JG(u.localPosition,r),l&&n.dirtifyLocal(i,u))}}(),this.translate=function(){var r=Vt.Ue(),i=Vt.Ue(),s=Vt.Ue();return function(l,u,h,p,m){h===void 0&&(h=0),p===void 0&&(p=0),m===void 0&&(m=!0),typeof u=="number"&&(u=Vt.t8(i,u,h,p)),!Vt.fS(u,r)&&(Vt.IH(s,n.getPosition(l),u),n.setPosition(l,s,m))}}(),this.setRotation=function(){var r=ni();return function(i,s,l,u,h,p){p===void 0&&(p=!0);var m=i.transformable;if(typeof s=="number"&&(s=ai(s,l,u,h)),i.parentNode===null||!i.parentNode.transformable)n.setLocalRotation(i,s);else{var y=n.getRotation(i.parentNode);Vi(r,y),Rn(r,r),wo(m.localRotation,r,s),Xo(m.localRotation,m.localRotation),p&&n.dirtifyLocal(i,m)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=ae.create(),i=Vt.Ue(),s=ai(0,0,0,1);return function(l){var u=l.localSkew[0]!==0||l.localSkew[1]!==0;if(u){if(ae.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,Vt.al(1,1,1),l.origin),l.localSkew[0]!==0||l.localSkew[1]!==0){var h=ae.identity(r);h[4]=Math.tan(l.localSkew[0]),h[1]=Math.tan(l.localSkew[1]),ae.multiply(l.localTransform,l.localTransform,h)}var p=ae.fromRotationTranslationScaleOrigin(r,s,i,l.localScale,l.origin);ae.multiply(l.localTransform,l.localTransform,p)}else ae.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,l.localScale,l.origin)}}()}return t.prototype.matches=function(e,n){return this.runtime.sceneGraphSelector.is(e,n)},t.prototype.querySelector=function(e,n){return this.runtime.sceneGraphSelector.selectOne(e,n)},t.prototype.querySelectorAll=function(e,n){return this.runtime.sceneGraphSelector.selectAll(e,n)},t.prototype.attach=function(e,n,r){var i,s=!1;e.parentNode&&(s=e.parentNode!==n,this.detach(e)),e.parentNode=n,(0,tr.Z)(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var l=n.sortable;(!((i=l==null?void 0:l.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(l.dirtyChildren.indexOf(e)===-1&&l.dirtyChildren.push(e),l.dirty=!0,l.dirtyReason=lh.ADDED);var u=e.transformable;u&&this.dirtifyWorld(e,u),u.frozen&&this.unfreezeParentToRoot(e),s&&e.dispatchEvent(Fc)},t.prototype.detach=function(e){var n,r;if(e.parentNode){var i=e.transformable,s=e.parentNode.sortable;(!((n=s==null?void 0:s.sorted)===null||n===void 0)&&n.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(s.dirtyChildren.indexOf(e)===-1&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=lh.REMOVED);var l=e.parentNode.childNodes.indexOf(e);l>-1&&e.parentNode.childNodes.splice(l,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},t.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},t.prototype.setOrigin=function(e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof n=="number"&&(n=[n,r,i]);var s=e.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var l=s.origin;l[0]=n[0],l[1]=n[1],l[2]=n[2]||0,this.dirtifyLocal(e,s)}},t.prototype.setLocalEulerAngles=function(e,n,r,i,s){r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=!0),typeof n=="number"&&(n=Vt.al(n,r,i));var l=e.transformable;mn(l.localRotation,n[0],n[1],n[2]),s&&this.dirtifyLocal(e,l)},t.prototype.scaleLocal=function(e,n,r){r===void 0&&(r=!0);var i=e.transformable;Vt.Jp(i.localScale,i.localScale,Vt.al(n[0],n[1],n[2]||1)),r&&this.dirtifyLocal(e,i)},t.prototype.setLocalScale=function(e,n,r){r===void 0&&(r=!0);var i=e.transformable,s=Vt.al(n[0],n[1],n[2]||i.localScale[2]);Vt.fS(s,i.localScale)||(Vt.JG(i.localScale,s),r&&this.dirtifyLocal(e,i))},t.prototype.setLocalRotation=function(e,n,r,i,s,l){l===void 0&&(l=!0),typeof n=="number"&&(n=ai(n,r,i,s));var u=e.transformable;Vi(u.localRotation,n),l&&this.dirtifyLocal(e,u)},t.prototype.setLocalSkew=function(e,n,r){typeof n=="number"&&(n=re.al(n,r));var i=e.transformable;re.JG(i.localSkew,n),this.dirtifyLocal(e,i)},t.prototype.dirtifyLocal=function(e,n){n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(e,n))},t.prototype.dirtifyWorld=function(e,n){n.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,n),this.dirtifyToRoot(e,!0)},t.prototype.triggerPendingEvents=function(){var e=this,n=new Set,r=function(i,s){i.isConnected&&!n.has(i.entity)&&(e.boundsChangedEvent.detail=s,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),n.add(i.entity))};this.pendingEvents.forEach(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1];u.affectChildren?l.forEach(function(h){r(h,u)}):r(l,u)}),this.clearPendingEvents(),n.clear()},t.prototype.clearPendingEvents=function(){this.pendingEvents=[]},t.prototype.dirtifyToRoot=function(e,n){n===void 0&&(n=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)ec(r),r=r.parentNode;n&&e.forEach(function(i){ec(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:n}])},t.prototype.updateDisplayObjectDependency=function(e,n,r,i){if(n&&n!==r){var s=this.displayObjectDependencyMap.get(n);if(s&&s[e]){var l=s[e].indexOf(i);s[e].splice(l,1)}}if(r){var u=this.displayObjectDependencyMap.get(r);u||(this.displayObjectDependencyMap.set(r,{}),u=this.displayObjectDependencyMap.get(r)),u[e]||(u[e]=[]),u[e].push(i)}},t.prototype.informDependentDisplayObjects=function(e){var n=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(s){n.dirtifyToRoot(s,!0),s.dispatchEvent(new Wu(Sa.ATTR_MODIFIED,s,n,n,i,Wu.MODIFICATION,n,n)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(i,n,n)})})},t.prototype.getPosition=function(e){var n=e.transformable;return ae.getTranslation(n.position,this.getWorldTransform(e,n))},t.prototype.getRotation=function(e){var n=e.transformable;return ae.getRotation(n.rotation,this.getWorldTransform(e,n))},t.prototype.getScale=function(e){var n=e.transformable;return ae.getScaling(n.scaling,this.getWorldTransform(e,n))},t.prototype.getWorldTransform=function(e,n){return n===void 0&&(n=e.transformable),!n.localDirtyFlag&&!n.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,n)),n.worldTransform},t.prototype.getLocalPosition=function(e){return e.transformable.localPosition},t.prototype.getLocalRotation=function(e){return e.transformable.localRotation},t.prototype.getLocalScale=function(e){return e.transformable.localScale},t.prototype.getLocalSkew=function(e){return e.transformable.localSkew},t.prototype.getLocalTransform=function(e){var n=e.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform},t.prototype.setLocalTransform=function(e,n){var r=ae.getTranslation(Vt.Ue(),n),i=ae.getRotation(ni(),n),s=ae.getScaling(Vt.Ue(),n);this.setLocalScale(e,s,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},t.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},t.prototype.getTransformedGeometryBounds=function(e,n,r){n===void 0&&(n=!1);var i=this.getGeometryBounds(e,n);if(vn.isEmpty(i))return null;var s=r||new vn;return s.setFromTransformedAABB(i,this.getWorldTransform(e)),s},t.prototype.getGeometryBounds=function(e,n){n===void 0&&(n=!1);var r=e.geometry;r.dirty&&g.styleValueRegistry.updateGeometry(e);var i=n?r.renderBounds:r.contentBounds||null;return i||new vn},t.prototype.getBounds=function(e,n){var r=this;n===void 0&&(n=!1);var i=e.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var s=n?i.renderBounds:i.bounds,l=this.getTransformedGeometryBounds(e,n,s),u=e.childNodes;if(u.forEach(function(m){var y=r.getBounds(m,n);y&&(l?l.add(y):(l=s||new vn,l.update(y.center,y.halfExtents)))}),l||(l=new vn),n){var h=rs(e);if(h){var p=h.parsedStyle.clipPath.getBounds(n);l?p&&(l=p.intersection(l)):l.update(p.center,p.halfExtents)}}return n?(i.renderBounds=l,i.renderBoundsDirty=!1):(i.bounds=l,i.boundsDirty=!1),l},t.prototype.getLocalBounds=function(e){if(e.parentNode){var n=ae.create();e.parentNode.transformable&&(n=ae.invert(ae.create(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!vn.isEmpty(r)){var i=new vn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds(e)},t.prototype.getBoundingClientRect=function(e){var n,r,i,s=this.getGeometryBounds(e);vn.isEmpty(s)||(i=new vn,i.setFromTransformedAABB(s,this.getWorldTransform(e)));var l=(r=(n=e.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var u=(0,F.CR)(i.getMin(),2),h=u[0],p=u[1],m=(0,F.CR)(i.getMax(),2),y=m[0],x=m[1];return new Or(h+((l==null?void 0:l.left)||0),p+((l==null?void 0:l.top)||0),y-h,x-p)}return new Or((l==null?void 0:l.left)||0,(l==null?void 0:l.top)||0,0,0)},t.prototype.dirtifyWorldInternal=function(e,n){var r=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,e.childNodes.forEach(function(s){var l=s.transformable;l.dirtyFlag||r.dirtifyWorldInternal(s,l)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},t.prototype.syncHierarchy=function(e){var n=e.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(e,n);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},t.prototype.sync=function(e,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?ae.copy(n.worldTransform,n.localTransform):ae.multiply(n.worldTransform,i.worldTransform,n.localTransform),n.dirtyFlag=!1}},t.prototype.unfreezeParentToRoot=function(e){for(var n=e.parentNode;n;){var r=n.transformable;r&&(r.frozen=!1),n=n.parentNode}},t}(),Kd={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Bs=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ly=/[!%),.:;?\]}'""]/,Qd=/[$('"]/,Rh=/[!),.:;?\]}'""]/,M_=/[([{'"]/,P_=/[)\]'"?!:;,.]/,lx=/[(['"...]/,Kc=/[!%),.:;?\]}'"]/,l0=/[$([{'"#]/,cy=new RegExp("".concat(ly.source,"|").concat(Rh.source,"|").concat(P_.source,"|").concat(Kc.source)),c=new RegExp("".concat(Qd.source,"|").concat(M_.source,"|").concat(lx.source,"|").concat(l0.source)),d=function(){function t(e){var n=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return n.isBreakingSpace(i)?!1:!!(r&&(c.exec(i)||cy.exec(r)))},this.trimByKinsokuShorui=function(r){var i=(0,F.ev)([],(0,F.CR)(r),!1),s=i[i.length-2];if(!s)return r;var l=s[s.length-1];return i[i.length-2]=s.slice(0,-1),i[i.length-1]=l+i[i.length-1],i}}return t.prototype.measureFont=function(e,n){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=e;var l=Kd.MetricsString+Kd.BaselineSymbol,u=Math.ceil(s.measureText(l).width),h=Math.ceil(s.measureText(Kd.BaselineSymbol).width),p=Kd.HeightMultiplier*h;h=h*Kd.BaselineMultiplier|0,i.width=u,i.height=p,s.fillStyle="#f00",s.fillRect(0,0,u,p),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(l,0,h);var m=s.getImageData(0,0,u||1,p||1).data,y=m.length,x=u*4,T=0,C=0,M=!1;for(T=0;T<h;++T){for(var I=0;I<x;I+=4)if(m[C+I]!==255){M=!0;break}if(!M)C+=x;else break}for(r.ascent=h-T,C=y-x,M=!1,T=p;T>h;--T){for(var I=0;I<x;I+=4)if(m[C+I]!==255){M=!0;break}if(!M)C-=x;else break}return r.descent=T-h,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},t.prototype.measureText=function(e,n,r){var i=n.fontSize,s=i===void 0?16:i,l=n.wordWrap,u=l===void 0?!1:l,h=n.lineHeight,p=n.lineWidth,m=p===void 0?1:p,y=n.textBaseline,x=y===void 0?"alphabetic":y,T=n.textAlign,C=T===void 0?"start":T,M=n.letterSpacing,I=M===void 0?0:M,D=n.textPath;n.textPathSide,n.textPathStartOffset;var U=n.leading,Z=U===void 0?0:U,G=di(n),W=this.measureFont(G,r);W.fontSize===0&&(W.fontSize=s,W.ascent=s);var $=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);$.font=G,n.isOverflowing=!1;var J=u?this.wordWrap(e,n,r):e,nt=J.split(/(?:\r\n|\r|\n)/),dt=new Array(nt.length),Et=0;if(D){D.getTotalLength();for(var Pt=0;Pt<nt.length;Pt++)var Ht=$.measureText(nt[Pt]).width+(nt[Pt].length-1)*I}else{for(var Pt=0;Pt<nt.length;Pt++){var Ct=$.measureText(nt[Pt]).width+(nt[Pt].length-1)*I;dt[Pt]=Ct,Et=Math.max(Et,Ct)}var Ht=Et+m,Ft=h||W.fontSize+m,jt=Math.max(Ft,W.fontSize+m)+(nt.length-1)*(Ft+Z);Ft+=Z;var qt=0;return x==="middle"?qt=-jt/2:x==="bottom"||x==="alphabetic"||x==="ideographic"?qt=-jt:(x==="top"||x==="hanging")&&(qt=0),{font:G,width:Ht,height:jt,lines:nt,lineWidths:dt,lineHeight:Ft,maxLineWidth:Et,fontProperties:W,lineMetrics:dt.map(function(oe,_e){var hn=0;return C==="center"||C==="middle"?hn-=oe/2:(C==="right"||C==="end")&&(hn-=oe),new Or(hn-m/2,qt+_e*Ft,oe+m,Ft)})}}},t.prototype.setGraphemeOnPath=function(){},t.prototype.wordWrap=function(e,n,r){var i=this,s=n.wordWrapWidth,l=s===void 0?0:s,u=n.letterSpacing,h=u===void 0?0:u,p=n.maxLines,m=p===void 0?1/0:p,y=n.textOverflow,x=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),T=l+h,C="";y==="ellipsis"?C="...":y&&y!=="clip"&&(C=y);for(var M=[],I=0,D=0,U={},Z=function(qt){return i.getFromCache(qt,h,U,x)},G=Array.from(C).reduce(function(qt,Ee){return qt+Z(Ee)},0),W=Array.from(e),$=0;$<W.length;$++){var J=W[$],nt=e[$-1],dt=e[$+1],Et=Z(J);if(this.isNewline(J)){if(I++,I>=m){n.isOverflowing=!0;break}D=0,M[I]="";continue}if(D>0&&D+Et>T){if(I+1>=m){if(n.isOverflowing=!0,G>0&&G<=T){for(var Pt=M[I].length,Ht=0,Ct=Pt,Ft=0;Ft<Pt;Ft++){var jt=Z(M[I][Ft]);if(Ht+jt+G>T){Ct=Ft;break}Ht+=jt}M[I]=(M[I]||"").slice(0,Ct)+C}break}if(I++,D=0,M[I]="",this.isBreakingSpace(J))continue;this.canBreakInLastChar(J)||(M=this.trimToBreakable(M),D=this.sumTextWidthByCache(M[I]||"",U)),this.shouldBreakByKinsokuShorui(J,dt)&&(M=this.trimByKinsokuShorui(M),D+=Z(nt||""))}D+=Et,M[I]=(M[I]||"")+J}return M.join(`
`)},t.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:Kd.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},t.prototype.isNewline=function(e){return typeof e!="string"?!1:Kd.Newlines.indexOf(e.charCodeAt(0))>=0},t.prototype.trimToBreakable=function(e){var n=(0,F.ev)([],(0,F.CR)(e),!1),r=n[n.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return n;var s=r.slice(i,i+1),l=this.isBreakingSpace(s),u=i+1,h=i+(l?0:1);return n[n.length-1]+=r.slice(u,r.length),n[n.length-2]=r.slice(0,h),n},t.prototype.canBreakInLastChar=function(e){return!(e&&Bs.test(e))},t.prototype.sumTextWidthByCache=function(e,n){return e.split("").reduce(function(r,i){if(!n[i])throw Error("cannot count the word without cache");return r+n[i]},0)},t.prototype.findBreakableIndex=function(e){for(var n=e.length-1;n>=0;n--)if(!Bs.test(e[n]))return n;return-1},t.prototype.getFromCache=function(e,n,r,i){var s=r[e];if(typeof s!="number"){var l=e.length*n;s=i.measureText(e).width+l,r[e]=s}return s},t}(),g={},w=function(){var t,e=new Cd,n=new Kv;return t={},t[Gr.CIRCLE]=new Sc,t[Gr.ELLIPSE]=new bu,t[Gr.RECT]=e,t[Gr.IMAGE]=e,t[Gr.GROUP]=new O_,t[Gr.LINE]=new mm,t[Gr.TEXT]=new $d(g),t[Gr.POLYLINE]=n,t[Gr.POLYGON]=n,t[Gr.PATH]=new uf,t[Gr.HTML]=null,t[Gr.MESH]=null,t}(),P=function(){var t,e=new eo,n=new ko;return t={},t[io.PERCENTAGE]=null,t[io.NUMBER]=new qr,t[io.ANGLE]=new oo,t[io.DEFINED_PATH]=new yi,t[io.PAINT]=e,t[io.COLOR]=e,t[io.FILTER]=new oi,t[io.LENGTH]=n,t[io.LENGTH_PERCENTAGE]=n,t[io.LENGTH_PERCENTAGE_12]=new fa,t[io.LENGTH_PERCENTAGE_14]=new $i,t[io.COORDINATE]=new ko,t[io.OFFSET_DISTANCE]=new Uo,t[io.OPACITY_VALUE]=new Ua,t[io.PATH]=new lo,t[io.LIST_OF_POINTS]=new La,t[io.SHADOW_BLUR]=new ha,t[io.TEXT]=new Ko,t[io.TEXT_TRANSFORM]=new hs,t[io.TRANSFORM]=new Yo,t[io.TRANSFORM_ORIGIN]=new ea,t[io.Z_INDEX]=new Ss,t[io.MARKER]=new _i,t}(),N=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof it.g!="undefined"?it.g:{}};g.CameraContribution=Fo,g.AnimationTimeline=null,g.EasingFunction=null,g.offscreenCanvasCreator=new eg,g.sceneGraphSelector=new Ip,g.sceneGraphService=new Lp(g),g.textService=new d(g),g.geometryUpdaterFactory=w,g.CSSPropertySyntaxFactory=P,g.styleValueRegistry=new ri(g),g.layoutRegistry=null,g.globalThis=N(),g.enableCSSParsing=!1,g.enableDataset=!1,g.enableStyleSyntax=!0,g.enableAttributeDashCased=!1,g.enableSizeAttenuation=!1;var j=0;function q(){j=0}var at=new Wu(Sa.INSERTED,null,"","","",0,"",""),vt=new Wu(Sa.REMOVED,null,"","","",0,"",""),Ot=new tl(Sa.DESTROY),Dt=function(t){(0,F.ZT)(e,t);function e(){var n=t.call(this)||this;return n.entity=j++,n.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},n.cullable={strategy:cf.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},n.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},n.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},n.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},n.rBushNode={aabb:void 0},n.namespaceURI="g",n.scrollLeft=0,n.scrollTop=0,n.clientTop=0,n.clientLeft=0,n.destroyed=!1,n.style={},n.computedStyle=g.enableCSSParsing?{opacity:No,fillOpacity:No,strokeOpacity:No,fill:No,stroke:No,transform:No,transformOrigin:No,visibility:No,pointerEvents:No,lineWidth:No,lineCap:No,lineJoin:No,increasedLineWidthForHitTesting:No,fontSize:No,fontFamily:No,fontStyle:No,fontWeight:No,fontVariant:No,textAlign:No,textBaseline:No,textTransform:No,zIndex:No,filter:No,shadowType:No}:null,n.parsedStyle={},n.attributes={},n}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(n){return n!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(n){throw new Error(cr)},e.prototype.appendChild=function(n,r){var i;if(n.destroyed)throw new Error(ei);return g.sceneGraphService.attach(n,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(n),this.isMutationObserved&&(at.relatedNode=this,n.dispatchEvent(at)),n},e.prototype.insertBefore=function(n,r){if(!r)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(n):this.appendChild(n,i)}return n},e.prototype.replaceChild=function(n,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(n,i),r},e.prototype.removeChild=function(n){var r;return vt.relatedNode=this,n.dispatchEvent(vt),!((r=n.ownerDocument)===null||r===void 0)&&r.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),g.sceneGraphService.detach(n),n},e.prototype.removeChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(n){return g.sceneGraphService.matches(n,this)},e.prototype.getElementById=function(n){return g.sceneGraphService.querySelector("#".concat(n),this)},e.prototype.getElementsByName=function(n){return g.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)},e.prototype.getElementsByClassName=function(n){return g.sceneGraphService.querySelectorAll(".".concat(n),this)},e.prototype.getElementsByTagName=function(n){return g.sceneGraphService.querySelectorAll(n,this)},e.prototype.querySelector=function(n){return g.sceneGraphService.querySelector(n,this)},e.prototype.querySelectorAll=function(n){return g.sceneGraphService.querySelectorAll(n,this)},e.prototype.closest=function(n){var r=this;do{if(g.sceneGraphService.matches(n,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(n){var r=this,i=null;return this.forEach(function(s){return s!==r&&n(s)?(i=s,!0):!1}),i},e.prototype.findAll=function(n){var r=this,i=[];return this.forEach(function(s){s!==r&&n(s)&&i.push(s)}),i},e.prototype.after=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this);r.forEach(function(l,u){var h;return(h=n.parentNode)===null||h===void 0?void 0:h.appendChild(l,s+u+1)})}},e.prototype.before=function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this),l=(0,F.CR)(r),u=l[0],h=l.slice(1);this.parentNode.appendChild(u,s),(n=u).after.apply(n,(0,F.ev)([],(0,F.CR)(h),!1))}},e.prototype.replaceWith=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this.after.apply(this,(0,F.ev)([],(0,F.CR)(n),!1)),this.remove()},e.prototype.append=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s){return n.appendChild(s)})},e.prototype.prepend=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s,l){return n.appendChild(s,l)})},e.prototype.replaceChildren=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,(0,F.ev)([],(0,F.CR)(n),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(Ot),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return g.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return g.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return g.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return g.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return g.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(n){if(Sh(n))return g.enableCSSParsing?null:void 0;var r=this.attributes[n];if(r===void 0){if(g.enableAttributeDashCased){var i=xf(n);r=this.attributes[i]}return g.enableCSSParsing&&(0,tr.Z)(r)?null:r}else return r},e.prototype.hasAttribute=function(n){return this.getAttributeNames().includes(n)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(n){this.setAttribute(n,null),delete this.attributes[n]},e.prototype.setAttribute=function(n,r,i,s){this.attributes[n]=r},e.prototype.getAttributeNS=function(n,r){throw new Error(cr)},e.prototype.getAttributeNode=function(n){throw new Error(cr)},e.prototype.getAttributeNodeNS=function(n,r){throw new Error(cr)},e.prototype.hasAttributeNS=function(n,r){throw new Error(cr)},e.prototype.removeAttributeNS=function(n,r){throw new Error(cr)},e.prototype.removeAttributeNode=function(n){throw new Error(cr)},e.prototype.setAttributeNS=function(n,r,i){throw new Error(cr)},e.prototype.setAttributeNode=function(n){throw new Error(cr)},e.prototype.setAttributeNodeNS=function(n){throw new Error(cr)},e.prototype.toggleAttribute=function(n,r){throw new Error(cr)},e}(Za);function Yt(t){return!!(t!=null&&t.nodeName)}var pe=g.globalThis.Proxy?g.globalThis.Proxy:function(){},Xe=new Wu(Sa.ATTR_MODIFIED,null,null,null,null,Wu.MODIFICATION,null,null),en={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},kn={fill:lf,stroke:lf,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},Sn=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],sr=(0,F.ev)((0,F.ev)([],(0,F.CR)(Sn),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),pr="data-",xr=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=n,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||Gr.GROUP,g.enableCSSParsing?(Object.assign(r.attributes,en),Object.assign(r.parsedStyle,kn,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),g.enableDataset&&(r.dataset=new pe({},{get:function(i,s){var l="".concat(pr).concat(Vu(s));return i[l]!==void 0?i[l]:r.getAttribute(l)},set:function(i,s,l){return r.setAttribute("".concat(pr).concat(Vu(s)),l),!0}})),g.enableStyleSyntax&&(r.style=new pe({setProperty:function(i,s){r.setAttribute(i,s)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,s){return i[s]!==void 0?i[s]:r.getAttribute(s)},set:function(i,s,l){return r.setAttribute(s,l),!0}})),r}return e.prototype.destroy=function(){t.prototype.destroy.call(this),this.getAnimations().forEach(function(n){n.cancel()})},e.prototype.cloneNode=function(n,r){var i=(0,F.pi)({},this.attributes);for(var s in i){var l=i[s];Yt(l)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(i[s]=l.cloneNode(n)),r&&(i[s]=r(s,l))}var u=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return u.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(h){if(!h.style.isMarker){var p=h.cloneNode(n);u.appendChild(p)}}),u},e.prototype.initAttributes=function(n){n===void 0&&(n={});var r=this.renderable,i={forceUpdateGeometry:!0};g.enableCSSParsing&&(i.usedAttributes=sr);var s=n;if(g.enableAttributeDashCased){s={};for(var l in n){var u=xf(l);s[u]=n[l]}}g.styleValueRegistry.processProperties(this,s,i),r.dirty=!0},e.prototype.setAttribute=function(n,r,i,s){i===void 0&&(i=!1),s===void 0&&(s=!0),g.enableAttributeDashCased&&(n=xf(n)),!Jr(r)&&(i||r!==this.attributes[n])&&(this.internalSetAttribute(n,r,{memoize:s}),t.prototype.setAttribute.call(this,n,r))},e.prototype.internalSetAttribute=function(n,r,i){var s;i===void 0&&(i={});var l=this.renderable,u=this.attributes[n],h=this.parsedStyle[n];g.styleValueRegistry.processProperties(this,(s={},s[n]=r,s),i),l.dirty=!0;var p=this.parsedStyle[n];this.isConnected&&(Xe.relatedNode=this,Xe.prevValue=u,Xe.newValue=r,Xe.attrName=n,Xe.prevParsedValue=h,Xe.newParsedValue=p,this.isMutationObserved?this.dispatchEvent(Xe):(Xe.target=this,this.ownerDocument.defaultView.dispatchEvent(Xe,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(n,u,r,h,p)},e.prototype.getBBox=function(){var n=this.getBounds(),r=(0,F.CR)(n.getMin(),2),i=r[0],s=r[1],l=(0,F.CR)(n.getMax(),2),u=l[0],h=l[1];return new Or(i,s,u-i,h-s)},e.prototype.setOrigin=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setOrigin(this,Al(n,r,i)),this},e.prototype.getOrigin=function(){return g.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setPosition(this,Al(n,r,i)),this},e.prototype.setLocalPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setLocalPosition(this,Al(n,r,i)),this},e.prototype.translate=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.translate(this,Al(n,r,i)),this},e.prototype.translateLocal=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.translateLocal(this,Al(n,r,i)),this},e.prototype.getPosition=function(){return g.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return g.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(n,r,i){return this.scaleLocal(n,r,i)},e.prototype.scaleLocal=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=Al(n,r,i)),g.sceneGraphService.scaleLocal(this,n),this},e.prototype.setLocalScale=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=Al(n,r,i)),g.sceneGraphService.setLocalScale(this,n),this},e.prototype.getLocalScale=function(){return g.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return g.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var n=(0,F.CR)(b(Vt.Ue(),g.sceneGraphService.getWorldTransform(this)),3),r=n[2];return ju(r)},e.prototype.getLocalEulerAngles=function(){var n=(0,F.CR)(b(Vt.Ue(),g.sceneGraphService.getLocalRotation(this)),3),r=n[2];return ju(r)},e.prototype.setEulerAngles=function(n){return g.sceneGraphService.setEulerAngles(this,0,0,n),this},e.prototype.setLocalEulerAngles=function(n){return g.sceneGraphService.setLocalEulerAngles(this,0,0,n),this},e.prototype.rotateLocal=function(n,r,i){return(0,tr.Z)(r)&&(0,tr.Z)(i)?g.sceneGraphService.rotateLocal(this,0,0,n):g.sceneGraphService.rotateLocal(this,n,r,i),this},e.prototype.rotate=function(n,r,i){return(0,tr.Z)(r)&&(0,tr.Z)(i)?g.sceneGraphService.rotate(this,0,0,n):g.sceneGraphService.rotate(this,n,r,i),this},e.prototype.setRotation=function(n,r,i,s){return g.sceneGraphService.setRotation(this,n,r,i,s),this},e.prototype.setLocalRotation=function(n,r,i,s){return g.sceneGraphService.setLocalRotation(this,n,r,i,s),this},e.prototype.setLocalSkew=function(n,r){return g.sceneGraphService.setLocalSkew(this,n,r),this},e.prototype.getRotation=function(){return g.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return g.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return g.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return g.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return g.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(n){return g.sceneGraphService.setLocalTransform(this,n),this},e.prototype.resetLocalTransform=function(){g.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(n,r){var i,s=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return s?s.play(this,n,r):null},e.prototype.isVisible=function(){var n,r;return g.enableCSSParsing?((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=(0,F.CR)(r,2),l=s[0],u=s[1];return l?sa(l)?(Object.keys(l).forEach(function(h){n.setAttribute(h,l[h])}),this):r.length===2?(this.setAttribute(l,u),this):this.attributes[l]:this.attributes},e.prototype.getMatrix=function(n){var r=n||this.getWorldTransform(),i=(0,F.CR)(ae.getTranslation(Vt.Ue(),r),2),s=i[0],l=i[1],u=(0,F.CR)(ae.getScaling(Vt.Ue(),r),2),h=u[0],p=u[1],m=ae.getRotation(ni(),r),y=(0,F.CR)(b(Vt.Ue(),m),3),x=y[0],T=y[2];return A(x||T,s,l,h,p)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(n){var r=(0,F.CR)(H(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setEulerAngles(h).setPosition(i,s).setLocalScale(l,u)},e.prototype.setLocalMatrix=function(n){var r=(0,F.CR)(H(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setLocalEulerAngles(h).setLocalPosition(i,s).setLocalScale(l,u)},e.prototype.show=function(){g.enableCSSParsing?this.style.visibility="visible":this.forEach(function(n){n.style.visibility="visible"})},e.prototype.hide=function(){g.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(n){n.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(n){return this.children[n]||null},e.prototype.add=function(n,r){return this.appendChild(n,r)},e.prototype.set=function(n,r){this.config[n]=r},e.prototype.get=function(n){return this.config[n]},e.prototype.moveTo=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},e.prototype.move=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},e.prototype.setZIndex=function(n){return this.style.zIndex=n,this},e}(Dt),Ir=function(t){(0,F.ZT)(e,t);function e(n){return n===void 0&&(n={}),t.call(this,(0,F.pi)({type:Gr.CIRCLE},n))||this}return e}(xr),Wr=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,F._T)(n,["style"]);return r=t.call(this,(0,F.pi)({style:g.enableCSSParsing?(0,F.pi)({},i):(0,F.pi)({},i)},s))||this,r.isCustomElement=!0,r}return e}(xr),Ci=function(t){(0,F.ZT)(e,t);function e(n){return n===void 0&&(n={}),t.call(this,(0,F.pi)({type:Gr.ELLIPSE},n))||this}return e}(xr),Ai=function(t){(0,F.ZT)(e,t);function e(n){return n===void 0&&(n={}),t.call(this,(0,F.pi)({type:Gr.GROUP},n))||this}return e}(xr),To=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,F._T)(n,["style"]);return r=t.call(this,(0,F.pi)({type:Gr.HTML,style:g.enableCSSParsing?(0,F.pi)({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):(0,F.pi)({},i)},s))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var n=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return Or.applyTransform(r,ae.invert(ae.create(),n))}else{var i=this.parsedStyle,s=i.x,l=i.y,u=i.width,h=i.height;return new Or(s,l,u,h)}},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var n,r,i=this.getBoundingClientRect(),s=(r=(n=this.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),l=new vn,u=i.left-((s==null?void 0:s.left)||0),h=i.top-((s==null?void 0:s.top)||0);return l.setMinMax([u,h,0],[u+i.width,h+i.height,0]),l},e.prototype.getLocalBounds=function(){if(this.parentNode){var n=ae.invert(ae.create(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!vn.isEmpty(r)){var i=new vn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds()},e}(xr),ao=function(t){(0,F.ZT)(e,t);function e(n){return n===void 0&&(n={}),t.call(this,(0,F.pi)({type:Gr.IMAGE},n))||this}return e}(xr),Ro=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,F._T)(n,["style"]);r=t.call(this,(0,F.pi)({type:Gr.LINE,style:(0,F.pi)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},s))||this,r.markerStartAngle=0,r.markerEndAngle=0;var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd;return u&&Yt(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),h&&Yt(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&Yt(s)&&(this.markerStartAngle=0,s.remove()),l&&Yt(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"&&(s&&Yt(s)&&(this.markerEndAngle=0,s.remove()),l&&Yt(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1)))},e.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.x1,p=r.x2,m=r.y1,y=r.y2,x=n?i:s;if(!(!x||!Yt(x))){var T=0,C,M,I,D,U,Z;n?(I=h,D=m,C=p-h,M=y-m,U=l||0,Z=this.markerStartAngle):(I=p,D=y,C=h-p,M=m-y,U=u||0,Z=this.markerEndAngle),T=Math.atan2(M,C),x.setLocalEulerAngles(T*180/Math.PI+Z),x.setLocalPosition(I+Math.cos(T)*U,D+Math.sin(T)*U)}},e.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Ri(s,l,u,h,n),m=p.x,y=p.y,x=Vt.fF(Vt.Ue(),Vt.al(m,y,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(x[0],x[1])},e.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var n=this.parsedStyle,r=n.x1,i=n.y1,s=n.x2,l=n.y2;return yp(r,i,s,l)},e}(xr),Zi=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,F._T)(n,["style"]);r=t.call(this,(0,F.pi)({type:Gr.PATH,style:g.enableCSSParsing?(0,F.pi)({d:"",miterLimit:""},i):(0,F.pi)({},i),initialParsedStyle:g.enableCSSParsing?null:{miterLimit:4,d:(0,F.pi)({},D0)}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&Yt(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&Yt(p)&&r.placeMarkerMid(p),h&&Yt(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&Yt(s)&&(this.markerStartAngle=0,s.remove()),l&&Yt(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&Yt(s)&&(this.markerEndAngle=0,s.remove()),l&&Yt(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},e.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=n?i:s;if(!(!h||!Yt(h))){var p=0,m,y,x,T,C,M;if(n){var I=(0,F.CR)(this.getStartTangent(),2),D=I[0],U=I[1];x=U[0],T=U[1],m=D[0]-U[0],y=D[1]-U[1],C=l||0,M=this.markerStartAngle}else{var Z=(0,F.CR)(this.getEndTangent(),2),D=Z[0],U=Z[1];x=U[0],T=U[1],m=D[0]-U[0],y=D[1]-U[1],C=u||0,M=this.markerEndAngle}p=Math.atan2(y,m),h.setLocalEulerAngles(p*180/Math.PI+M),h.setLocalPosition(x+Math.cos(p)*C,T+Math.sin(p)*C)}},e.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(p){p.remove()}),n&&Yt(n))for(var i=1;i<r.length-1;i++){var s=(0,F.CR)(r[i].currentPoint,2),l=s[0],u=s[1],h=i===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},e.prototype.getTotalLength=function(){return Sf(this)},e.prototype.getPointAtLength=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,s=Po(i,n),l=s.x,u=s.y,h=Vt.fF(Vt.Ue(),Vt.al(l,u,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(h[0],h[1])},e.prototype.getPoint=function(n,r){return r===void 0&&(r=!1),this.getPointAtLength(n*Sf(this),r)},e.prototype.getStartTangent=function(){var n=this.parsedStyle.d.segments,r=[];if(n.length>1){var i=n[0].currentPoint,s=n[1].currentPoint,l=n[1].startTangent;r=[],l?(r.push([i[0]-l[0],i[1]-l[1]]),r.push([i[0],i[1]])):(r.push([s[0],s[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var n=this.parsedStyle.d.segments,r=n.length,i=[];if(r>1){var s=n[r-2].currentPoint,l=n[r-1].currentPoint,u=n[r-1].endTangent;i=[],u?(i.push([l[0]-u[0],l[1]-u[1]]),i.push([l[0],l[1]])):(i.push([s[0],s[1]]),i.push([l[0],l[1]]))}return i},e}(xr),Ta=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,F._T)(n,["style"]);r=t.call(this,(0,F.pi)({type:Gr.POLYGON,style:g.enableCSSParsing?(0,F.pi)({points:"",miterLimit:"",isClosed:!0},i):(0,F.pi)({},i),initialParsedStyle:g.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&Yt(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&Yt(p)&&r.placeMarkerMid(p),h&&Yt(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&Yt(s)&&(this.markerStartAngle=0,s.remove()),l&&Yt(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&Yt(s)&&(this.markerEndAngle=0,s.remove()),l&&Yt(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},e.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.points,p=(h||{}).points,m=n?i:s;if(!(!m||!Yt(m)||!p)){var y=0,x,T,C,M,I,D;if(C=p[0][0],M=p[0][1],n)x=p[1][0]-p[0][0],T=p[1][1]-p[0][1],I=l||0,D=this.markerStartAngle;else{var U=p.length;this.parsedStyle.isClosed?(x=p[U-1][0]-p[0][0],T=p[U-1][1]-p[0][1]):(C=p[U-1][0],M=p[U-1][1],x=p[U-2][0]-p[U-1][0],T=p[U-2][1]-p[U-1][1]),I=u||0,D=this.markerEndAngle}y=Math.atan2(T,x),m.setLocalEulerAngles(y*180/Math.PI+D),m.setLocalPosition(C+Math.cos(y)*I,M+Math.sin(y)*I)}},e.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(p){p.remove()}),this.markerMidList=[],n&&Yt(n)&&i)for(var s=1;s<(this.parsedStyle.isClosed?i.length:i.length-1);s++){var l=i[s][0],u=i[s][1],h=s===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},e}(xr),Qo=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=n.style,i=(0,F._T)(n,["style"]);return t.call(this,(0,F.pi)({type:Gr.POLYLINE,style:g.enableCSSParsing?(0,F.pi)({points:"",miterLimit:"",isClosed:!1},r):(0,F.pi)({},r),initialParsedStyle:g.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return Od(this)},e.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},e.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],l=0,u,h,p=this.getTotalLength();i.forEach(function(I,D){i[D+1]&&(u=[0,0],u[0]=l/p,h=yp(I[0],I[1],i[D+1][0],i[D+1][1]),l+=h,u[1]=l/p,s.push(u))}),this.parsedStyle.points.segments=s}var m=0,y=0;this.parsedStyle.points.segments.forEach(function(I,D){n>=I[0]&&n<=I[1]&&(m=(n-I[0])/(I[1]-I[0]),y=D)});var x=Ri(i[y][0],i[y][1],i[y+1][0],i[y+1][1],m),T=x.x,C=x.y,M=Vt.fF(Vt.Ue(),Vt.al(T,C,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(M[0],M[1])},e.prototype.getStartTangent=function(){var n=this.parsedStyle.points.points,r=[];return r.push([n[1][0],n[1][1]]),r.push([n[0][0],n[0][1]]),r},e.prototype.getEndTangent=function(){var n=this.parsedStyle.points.points,r=n.length-1,i=[];return i.push([n[r-1][0],n[r-1][1]]),i.push([n[r][0],n[r][1]]),i},e}(Ta),vo=function(t){(0,F.ZT)(e,t);function e(n){return n===void 0&&(n={}),t.call(this,(0,F.pi)({type:Gr.RECT},n))||this}return e}(xr),pa=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=n.style,i=(0,F._T)(n,["style"]);return t.call(this,(0,F.pi)({type:Gr.TEXT,style:g.enableCSSParsing?(0,F.pi)({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):(0,F.pi)({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(xr),Ca=function(){function t(){this.registry={},this.define(Gr.CIRCLE,Ir),this.define(Gr.ELLIPSE,Ci),this.define(Gr.RECT,vo),this.define(Gr.IMAGE,ao),this.define(Gr.LINE,Ro),this.define(Gr.GROUP,Ai),this.define(Gr.PATH,Zi),this.define(Gr.POLYGON,Ta),this.define(Gr.POLYLINE,Qo),this.define(Gr.TEXT,pa),this.define(Gr.HTML,To)}return t.prototype.define=function(e,n){this.registry[e]=n},t.prototype.get=function(e){return this.registry[e]},t}(),Ja={number:function(t){return new ya(t)},percent:function(t){return new ya(t,"%")},px:function(t){return new ya(t,"px")},em:function(t){return new ya(t,"em")},rem:function(t){return new ya(t,"rem")},deg:function(t){return new ya(t,"deg")},grad:function(t){return new ya(t,"grad")},rad:function(t){return new ya(t,"rad")},turn:function(t){return new ya(t,"turn")},s:function(t){return new ya(t,"s")},ms:function(t){return new ya(t,"ms")},registerProperty:function(t){var e=t.name,n=t.inherits,r=t.interpolable,i=t.initialValue,s=t.syntax;g.styleValueRegistry.registerMetadata({n:e,inh:n,int:r,d:i,syntax:s})},registerLayout:function(t,e){g.layoutRegistry.registerLayout(t,e)}},Ho=function(t){(0,F.ZT)(e,t);function e(){var n=t.call(this)||this;n.defaultView=null,n.ownerDocument=null,n.nodeName="document";try{n.timeline=new g.AnimationTimeline(n)}catch(i){}var r={};return Pi.forEach(function(i){var s=i.n,l=i.inh,u=i.d;l&&u&&(r[s]=Ff(u)?u(Gr.GROUP):u)}),n.documentElement=new Ai({id:"g-root",style:r}),n.documentElement.ownerDocument=n,n.documentElement.parentNode=n,n.childNodes=[n.documentElement],n}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(n,r){if(n==="svg")return this.documentElement;var i=this.defaultView.customElements.get(n);i||(console.warn("Unsupported tagName: ",n),i=n==="tspan"?pa:Ai);var s=new i(r);return s.ownerDocument=this,s},e.prototype.createElementNS=function(n,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(n){throw new Error(cr)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(n){}},e.prototype.elementsFromBBox=function(n,r,i,s){var l=this.defaultView.context.rBushRoot,u=l.search({minX:n,minY:r,maxX:i,maxY:s}),h=[];return u.forEach(function(p){var m=p.displayObject,y=m.parsedStyle.pointerEvents,x=y===void 0?"auto":y,T=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(x);(!T||T&&m.isVisible())&&!m.isCulled()&&m.isInteractive()&&h.push(m)}),h.sort(function(p,m){return m.sortable.renderOrder-p.sortable.renderOrder}),h},e.prototype.elementFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return null;var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,x=m.y,T=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:x},picked:[]}).picked;return T&&T[0]||this.documentElement},e.prototype.elementFromPoint=function(n,r){return(0,F.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,x,T;return(0,F.Jh)(this,function(C){switch(C.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,null]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,x=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:x},picked:[]})]);case 1:return T=C.sent().picked,[2,T&&T[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return[];var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,x=m.y,T=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:x},picked:[]}).picked;return T[T.length-1]!==this.documentElement&&T.push(this.documentElement),T},e.prototype.elementsFromPoint=function(n,r){return(0,F.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,x,T;return(0,F.Jh)(this,function(C){switch(C.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,[]]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,x=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:x},picked:[]})]);case 1:return T=C.sent().picked,T[T.length-1]!==this.documentElement&&T.push(this.documentElement),[2,T]}})})},e.prototype.appendChild=function(n,r){throw new Error(kr)},e.prototype.insertBefore=function(n,r){throw new Error(kr)},e.prototype.removeChild=function(n,r){throw new Error(kr)},e.prototype.replaceChild=function(n,r,i){throw new Error(kr)},e.prototype.append=function(){throw new Error(kr)},e.prototype.prepend=function(){throw new Error(kr)},e.prototype.getElementById=function(n){return this.documentElement.getElementById(n)},e.prototype.getElementsByName=function(n){return this.documentElement.getElementsByName(n)},e.prototype.getElementsByTagName=function(n){return this.documentElement.getElementsByTagName(n)},e.prototype.getElementsByClassName=function(n){return this.documentElement.getElementsByClassName(n)},e.prototype.querySelector=function(n){return this.documentElement.querySelector(n)},e.prototype.querySelectorAll=function(n){return this.documentElement.querySelectorAll(n)},e.prototype.find=function(n){return this.documentElement.find(n)},e.prototype.findAll=function(n){return this.documentElement.findAll(n)},e}(Za),Ts=function(){function t(e){this.strategies=e}return t.prototype.apply=function(e){var n=e.camera,r=e.renderingService,i=e.renderingContext,s=this.strategies;r.hooks.cull.tap(t.tag,function(l){if(l){var u=l.cullable;return s.length===0?u.visible=i.unculledEntities.indexOf(l.entity)>-1:u.visible=s.every(function(h){return h.isVisible(n,l)}),!l.isCulled()&&l.isVisible()?l:(l.dispatchEvent(new tl(Sa.CULLED)),null)}return l}),r.hooks.afterRender.tap(t.tag,function(l){l.cullable.visibilityPlaneMask=-1})},t.tag="Culling",t}(),_l=function(){function t(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new s0(null),this.rootWheelEvent=new tg(null),this.onPointerMove=function(n){var r,i,s,l,u=(l=(s=e.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView;if(!(u.supportsTouchEvents&&n.pointerType==="touch")){var h=e.normalizeToPointerEvent(n,u);try{for(var p=(0,F.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,x=e.bootstrapEvent(e.rootPointerEvent,y,u,n);e.context.eventService.mapEvent(x)}}catch(T){r={error:T}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(n){var r,i,s,l,u=(l=(s=e.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView,h=e.normalizeToPointerEvent(n,u);try{for(var p=(0,F.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,x=e.bootstrapEvent(e.rootPointerEvent,y,u,n);e.context.eventService.mapEvent(x)}}catch(T){r={error:T}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return t.prototype.apply=function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var l=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}).picked;return l[0]||null}),r.hooks.pointerWheel.tap(t.tag,function(s){var l=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(l)}),r.hooks.pointerDown.tap(t.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.normalizeToPointerEvent(s,i);if(n.autoPreventDefault&&h[0].isNormalized){var p=s.cancelable||!("cancelable"in s);p&&s.preventDefault()}try{for(var m=(0,F.XA)(h),y=m.next();!y.done;y=m.next()){var x=y.value,T=n.bootstrapEvent(n.rootPointerEvent,x,i,s);n.context.eventService.mapEvent(T)}}catch(C){l={error:C}}finally{try{y&&!y.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerUp.tap(t.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.context.contextService.getDomElement(),p=n.context.eventService.isNativeEventFromCanvas(h,s),m=p?"":"outside",y=n.normalizeToPointerEvent(s,i);try{for(var x=(0,F.XA)(y),T=x.next();!T.done;T=x.next()){var C=T.value,M=n.bootstrapEvent(n.rootPointerEvent,C,i,s);M.type+=m,n.context.eventService.mapEvent(M)}}catch(I){l={error:I}}finally{try{T&&!T.done&&(u=x.return)&&u.call(x)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(s){var l,u,h=n.normalizeToPointerEvent(s,i);try{for(var p=(0,F.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,x=n.bootstrapEvent(n.rootPointerEvent,y,i,s);n.context.eventService.mapEvent(x)}}catch(T){l={error:T}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)})},t.prototype.bootstrapEvent=function(e,n,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=n.pointerId,e.width=n.width,e.height=n.height,e.isPrimary=n.isPrimary,e.pointerType=n.pointerType,e.pressure=n.pressure,e.tangentialPressure=n.tangentialPressure,e.tiltX=n.tiltX,e.tiltY=n.tiltY,e.twist=n.twist,this.transferMouseData(e,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),l=s.x,u=s.y;e.viewport.x=l,e.viewport.y=u;var h=this.context.eventService.viewport2Canvas(e.viewport),p=h.x,m=h.y;return e.canvas.x=p,e.canvas.y=m,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Zo[e.type]||e.type),e},t.prototype.normalizeWheelEvent=function(e){var n=this.rootWheelEvent;this.transferMouseData(n,e),n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,s=r.y;n.viewport.x=i,n.viewport.y=s;var l=this.context.eventService.viewport2Canvas(n.viewport),u=l.x,h=l.y;return n.canvas.x=u,n.canvas.y=h,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=e,n.type=e.type,n},t.prototype.transferMouseData=function(e,n){e.isTrusted=n.isTrusted,e.srcElement=n.srcElement,e.timeStamp=Ea.now(),e.type=n.type,e.altKey=n.altKey,e.metaKey=n.metaKey,e.shiftKey=n.shiftKey,e.ctrlKey=n.ctrlKey,e.button=n.button,e.buttons=n.buttons,e.client.x=n.clientX,e.client.y=n.clientY,e.movement.x=n.movementX,e.movement.y=n.movementY,e.page.x=n.pageX,e.page.y=n.pageY,e.screen.x=n.screenX,e.screen.y=n.screenY,e.relatedTarget=null},t.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},t.prototype.normalizeToPointerEvent=function(e,n){var r=[];if(n.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var s=e.changedTouches[i];Jr(s.button)&&(s.button=0),Jr(s.buttons)&&(s.buttons=1),Jr(s.isPrimary)&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),Jr(s.width)&&(s.width=s.radiusX||1),Jr(s.height)&&(s.height=s.radiusY||1),Jr(s.tiltX)&&(s.tiltX=0),Jr(s.tiltY)&&(s.tiltY=0),Jr(s.pointerType)&&(s.pointerType="touch"),Jr(s.pointerId)&&(s.pointerId=s.identifier||0),Jr(s.pressure)&&(s.pressure=s.force||.5),Jr(s.twist)&&(s.twist=0),Jr(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=e.type,r.push(s)}else if(n.isMouseEvent(e)){var l=e;Jr(l.isPrimary)&&(l.isPrimary=!0),Jr(l.width)&&(l.width=1),Jr(l.height)&&(l.height=1),Jr(l.tiltX)&&(l.tiltX=0),Jr(l.tiltY)&&(l.tiltY=0),Jr(l.pointerType)&&(l.pointerType="mouse"),Jr(l.pointerId)&&(l.pointerId=Os),Jr(l.pressure)&&(l.pressure=.5),Jr(l.twist)&&(l.twist=0),Jr(l.tangentialPressure)&&(l.tangentialPressure=0),l.isNormalized=!0,r.push(l)}else r.push(e);return r},t.tag="Event",t}(),zl=[Gr.CIRCLE,Gr.ELLIPSE,Gr.IMAGE,Gr.RECT,Gr.LINE,Gr.POLYLINE,Gr.POLYGON,Gr.TEXT,Gr.PATH,Gr.HTML],jl=function(){function t(){}return t.prototype.isVisible=function(e,n){var r,i,s=n.cullable;if(!s.enable)return!0;var l=n.getRenderBounds();if(vn.isEmpty(l))return!1;var u=e.getFrustum(),h=(i=(r=n.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return s.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,l,h||On.INDETERMINATE,u.planes),s.visible=s.visibilityPlaneMask!==On.OUTSIDE,s.visible},t.prototype.computeVisibilityWithPlaneMask=function(e,n,r,i){if(r===On.OUTSIDE||r===On.INSIDE)return r;for(var s=On.INSIDE,l=zl.indexOf(e.nodeName)>-1,u=0,h=i.length;u<h;++u){var p=1<<u;if(r&p&&!(l&&(u===4||u===5))){var m=i[u],y=m.normal,x=m.distance;if(Vt.AK(y,n.getPositiveFarPoint(i[u]))+x<0)return On.OUTSIDE;Vt.AK(y,n.getNegativeFarPoint(i[u]))+x<0&&(s|=p)}}return s},t}(),xl=function(){function t(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return t.prototype.apply=function(e){var n=this,r,i=e.renderingService,s=e.renderingContext,l=e.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var h=function(T){var C=T.target;C.renderable.dirty=!0,i.dirtify()},p=function(T){var C=T.detail.affectChildren,M=T.target;C&&M.forEach(function(D){n.toSync.add(D)});for(var I=M;I;)I.renderable&&n.toSync.add(I),I=I.parentElement;i.dirtify()},m=function(T){var C=T.target;g.enableSizeAttenuation&&g.styleValueRegistry.updateSizeAttenuation(C,u.getCamera().getZoom()),g.enableCSSParsing&&g.styleValueRegistry.recalc(C),g.sceneGraphService.dirtifyToRoot(C),i.dirtify()},y=function(T){var C=T.target,M=C.rBushNode;M.aabb&&n.rBush.remove(M.aabb),n.toSync.delete(C),g.sceneGraphService.dirtifyToRoot(C),i.dirtify()};i.hooks.init.tap(t.tag,function(){u.addEventListener(Sa.MOUNTED,m),u.addEventListener(Sa.UNMOUNTED,y),u.addEventListener(Sa.ATTR_MODIFIED,h),u.addEventListener(Sa.BOUNDS_CHANGED,p)}),i.hooks.destroy.tap(t.tag,function(){u.removeEventListener(Sa.MOUNTED,m),u.removeEventListener(Sa.UNMOUNTED,y),u.removeEventListener(Sa.ATTR_MODIFIED,h),u.removeEventListener(Sa.BOUNDS_CHANGED,p),n.toSync.clear()});var x=(r=g.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Fn.bind(g.globalThis);i.hooks.endFrame.tap(t.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,x(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})},t.prototype.syncRTree=function(e){var n=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var s=i.rBushNode;s&&s.aabb&&n.rBush.remove(s.aabb);var l=i.getRenderBounds();if(l){var u=i.renderable;e&&(u.dirtyRenderBounds||(u.dirtyRenderBounds=new vn),u.dirtyRenderBounds.update(l.center,l.halfExtents));var h=(0,F.CR)(l.getMin(),2),p=h[0],m=h[1],y=(0,F.CR)(l.getMax(),2),x=y[0],T=y[1];s.aabb||(s.aabb={}),s.aabb.displayObject=i,s.aabb.minX=p,s.aabb.minY=m,s.aabb.maxX=x,s.aabb.maxY=T}s.aabb&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.minX)&&!isNaN(s.aabb.minY)&&r.push(s.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},t.tag="Prepare",t}();function nc(t){return!!t.document}var Vs;(function(t){t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged"})(Vs||(Vs={}));var wc=500,Xu=.1,Uc=1e3,uu=new tl(Sa.MOUNTED),Vl=new tl(Sa.UNMOUNTED),zc=new tl(Vs.BEFORE_RENDER),Ka=new tl(Vs.RERENDER),Xs=new tl(Vs.AFTER_RENDER),Fs=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this)||this;r.Element=xr,r.inited=!1,r.context={},r.document=new Ho,r.document.defaultView=r,r.customElements=new Ca;var i=n.container,s=n.canvas,l=n.offscreenCanvas,u=n.width,h=n.height,p=n.devicePixelRatio,m=n.renderer,y=n.background,x=n.cursor,T=n.document,C=n.requestAnimationFrame,M=n.cancelAnimationFrame,I=n.createImage,D=n.supportsPointerEvents,U=n.supportsTouchEvents,Z=n.supportsCSSTransform,G=n.supportsMutipleCanvasesInOneContainer,W=n.useNativeClickEvent,$=n.alwaysTriggerPointerEventOnCanvas,J=n.isTouchEvent,nt=n.isMouseEvent,dt=n.dblClickSpeed;G||Va(i,r);var Et=u,Pt=h,Ht=p;return s&&(Ht=p||hl&&window.devicePixelRatio||1,Ht=Ht>=1?Math.ceil(Ht):1,Et=u||Oa(s)||s.width/Ht,Pt=h||$c(s)||s.height/Ht),l&&(g.offscreenCanvas=l),r.devicePixelRatio=Ht,r.requestAnimationFrame=C!=null?C:Fn.bind(g.globalThis),r.cancelAnimationFrame=M!=null?M:Yn.bind(g.globalThis),r.supportsTouchEvents=U!=null?U:"ontouchstart"in g.globalThis,r.supportsPointerEvents=D!=null?D:!!g.globalThis.PointerEvent,r.isTouchEvent=J!=null?J:function(Ct){return r.supportsTouchEvents&&Ct instanceof g.globalThis.TouchEvent},r.isMouseEvent=nt!=null?nt:function(Ct){return!g.globalThis.MouseEvent||Ct instanceof g.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(Ct instanceof g.globalThis.PointerEvent))},r.dblClickSpeed=dt!=null?dt:200,r.initRenderingContext({container:i,canvas:s,width:Et,height:Pt,renderer:m,offscreenCanvas:l,devicePixelRatio:Ht,cursor:x||"default",background:y||"transparent",createImage:I,document:T,supportsCSSTransform:Z,useNativeClickEvent:W,alwaysTriggerPointerEventOnCanvas:$}),r.initDefaultCamera(Et,Pt,m.clipSpaceNearZ),r.initRenderer(m,!0),r}return e.prototype.initRenderingContext=function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(n,r,i){var s=this,l=new g.CameraContribution;l.clipSpaceNearZ=i,l.setType(Yr.EXPLORING,Ti.DEFAULT).setPosition(n/2,r/2,wc).setFocalPoint(n/2,r/2,0).setOrthographic(n/-2,n/2,r/2,r/-2,Xu,Uc),l.canvas=this,l.eventEmitter.on(Io.UPDATED,function(){s.context.renderingContext.renderReasons.add(Ch.CAMERA_CHANGED),g.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=l},e.prototype.updateSizeAttenuation=function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){g.styleValueRegistry.updateSizeAttenuation(r,n)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){n.resolveReadyPromise=function(){r(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(n,r){if(n===void 0&&(n=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new tl(Vs.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var s=this.getRoot();this.unmountChildren(s),n&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),n&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new tl(Vs.AFTER_DESTROY))},e.prototype.changeSize=function(n,r){this.resize(n,r)},e.prototype.resize=function(n,r){var i=this.context.config;i.width=n,i.height=r,this.getContextService().resize(n,r);var s=this.context.camera,l=s.getProjectionMode();s.setPosition(n/2,r/2,wc).setFocalPoint(n/2,r/2,0),l===zi.ORTHOGRAPHIC?s.setOrthographic(n/-2,n/2,r/2,r/-2,s.getNear(),s.getFar()):s.setAspect(n/r),this.dispatchEvent(new tl(Vs.RESIZE,{width:n,height:r}))},e.prototype.appendChild=function(n,r){return this.document.documentElement.appendChild(n,r)},e.prototype.insertBefore=function(n,r){return this.document.documentElement.insertBefore(n,r)},e.prototype.removeChild=function(n){return this.document.documentElement.removeChild(n)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(n){var r=this;n&&(zc.detail=n,Xs.detail=n),this.dispatchEvent(zc);var i=this.getRenderingService();i.render(this.getConfig(),n,function(){r.dispatchEvent(Ka)}),this.dispatchEvent(Xs)},e.prototype.run=function(){var n=this,r=function(i,s){n.render(s),n.frameId=n.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(n,r){var i=this;if(r===void 0&&(r=!1),!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new zd,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new _l,new xl,new Ts([new jl])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService((0,F.pi)((0,F.pi)({},g),this.context)),this.context.renderingService=new sx(g,this.context),this.context.eventService=new ax(g,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,r)})},e.prototype.initRenderingService=function(n,r,i){var s=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){s.inited=!0,r?i?s.requestAnimationFrame(function(){s.dispatchEvent(new tl(Vs.READY))}):s.dispatchEvent(new tl(Vs.READY)):s.dispatchEvent(new tl(Vs.RENDERER_CHANGED)),s.readyPromise&&s.resolveReadyPromise(),r||s.getRoot().forEach(function(l){var u=l.renderable;u&&(u.renderBoundsDirty=!0,u.boundsDirty=!0,u.dirty=!0)}),s.mountChildren(s.getRoot()),n.getConfig().enableAutoRendering&&s.run()})},e.prototype.loadRendererContainerModule=function(n){var r=this,i=n.getPlugins();i.forEach(function(s){s.context=r.context,s.init(g)})},e.prototype.setRenderer=function(n){var r=this.getConfig();if(r.renderer!==n){var i=r.renderer;r.renderer=n,this.destroy(!1,!0),(0,F.ev)([],(0,F.CR)(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(s){s.destroy(g)}),this.initRenderer(n)}},e.prototype.setCursor=function(n){var r=this.getConfig();r.cursor=n,this.getContextService().applyCursorStyle(n)},e.prototype.unmountChildren=function(n){var r=this;n.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Vl):(Vl.target=n,this.dispatchEvent(Vl,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()},e.prototype.mountChildren=function(n){var r=this;this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,n.isMutationObserved?n.dispatchEvent(uu):(uu.target=n,this.dispatchEvent(uu,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(i){r.mountChildren(i)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()},e.prototype.client2Viewport=function(n){return this.getEventService().client2Viewport(n)},e.prototype.viewport2Client=function(n){return this.getEventService().viewport2Client(n)},e.prototype.viewport2Canvas=function(n){return this.getEventService().viewport2Canvas(n)},e.prototype.canvas2Viewport=function(n){return this.getEventService().canvas2Viewport(n)},e.prototype.getPointByClient=function(n,r){return this.client2Viewport({x:n,y:r})},e.prototype.getClientByPoint=function(n,r){return this.viewport2Client({x:n,y:r})},e}(Tc),ds=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.landmarks=[],n}return e.prototype.rotate=function(n,r,i){if(this.relElevation=Eh(r),this.relAzimuth=Eh(n),this.relRoll=Eh(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Yr.EXPLORING){var s=pi(ni(),[1,0,0],Qa((this.rotateWorld?1:-1)*this.relElevation)),l=pi(ni(),[0,1,0],Qa((this.rotateWorld?1:-1)*this.relAzimuth)),u=pi(ni(),[0,0,1],Qa(this.relRoll)),h=wo(ni(),l,s);h=wo(ni(),h,u);var p=ae.fromQuat(ae.create(),h);ae.translate(this.matrix,this.matrix,[0,0,-this.distance]),ae.multiply(this.matrix,this.matrix,p),ae.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(n,r){var i=Al(n,r,0),s=Vt.d9(this.position);return Vt.IH(s,s,Vt.bA(Vt.Ue(),this.right,i[0])),Vt.IH(s,s,Vt.bA(Vt.Ue(),this.up,i[1])),this._setPosition(s),this.triggerUpdate(),this},e.prototype.dolly=function(n){var r=this.forward,i=Vt.d9(this.position),s=n*this.dollyingStep,l=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(l,this.maxDistance),this.minDistance)-this.distance,i[0]+=s*r[0],i[1]+=s*r[1],i[2]+=s*r[2],this._setPosition(i),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getDistance():this.type===Yr.TRACKING&&Vt.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(n,r){var i,s,l,u;r===void 0&&(r={});var h=r.position,p=h===void 0?this.position:h,m=r.focalPoint,y=m===void 0?this.focalPoint:m,x=r.roll,T=r.zoom,C=new g.CameraContribution;C.setType(this.type,void 0),C.setPosition(p[0],(i=p[1])!==null&&i!==void 0?i:this.position[1],(s=p[2])!==null&&s!==void 0?s:this.position[2]),C.setFocalPoint(y[0],(l=y[1])!==null&&l!==void 0?l:this.focalPoint[1],(u=y[2])!==null&&u!==void 0?u:this.focalPoint[2]),C.setRoll(x!=null?x:this.roll),C.setZoom(T!=null?T:this.zoom);var M={name:n,matrix:ae.clone(C.getWorldTransform()),right:Vt.d9(C.right),up:Vt.d9(C.up),forward:Vt.d9(C.forward),position:Vt.d9(C.getPosition()),focalPoint:Vt.d9(C.getFocalPoint()),distanceVector:Vt.d9(C.getDistanceVector()),distance:C.getDistance(),dollyingStep:C.getDollyingStep(),azimuth:C.getAzimuth(),elevation:C.getElevation(),roll:C.getRoll(),relAzimuth:C.relAzimuth,relElevation:C.relElevation,relRoll:C.relRoll,zoom:C.getZoom()};return this.landmarks.push(M),M},e.prototype.gotoLandmark=function(n,r){var i=this;r===void 0&&(r={});var s=Si(n)?this.landmarks.find(function(Et){return Et.name===n}):n;if(s){var l=(0,ge.Z)(r)?{duration:r}:r,u=l.easing,h=u===void 0?"linear":u,p=l.duration,m=p===void 0?100:p,y=l.easingFunction,x=y===void 0?void 0:y,T=l.onfinish,C=T===void 0?void 0:T,M=l.onframe,I=M===void 0?void 0:M,D=.01;this.cancelLandmarkAnimation();var U=s.position,Z=s.focalPoint,G=s.zoom,W=s.roll,$=x||g.EasingFunction(h),J,nt=function(){i.setFocalPoint(Z),i.setPosition(U),i.setRoll(W),i.setZoom(G),i.computeMatrix(),i.triggerUpdate(),C==null||C()};if(m===0)return nt();var dt=function(Et){J===void 0&&(J=Et);var Pt=Et-J;if(Pt>=m){nt();return}var Ht=$(Pt/m),Ct=Vt.Ue(),Ft=Vt.Ue(),jt=1,qt=0;Vt.t7(Ct,i.focalPoint,Z,Ht),Vt.t7(Ft,i.position,U,Ht),qt=i.roll*(1-Ht)+W*Ht,jt=i.zoom*(1-Ht)+G*Ht,i.setFocalPoint(Ct),i.setPosition(Ft),i.setRoll(qt),i.setZoom(jt);var Ee=Vt.TK(Ct,Z)+Vt.TK(Ft,U);if(Ee<=D&&G==null&&W==null)return nt();i.computeMatrix(),i.triggerUpdate(),Pt<m&&(I==null||I(Ht),i.landmarkAnimationID=i.canvas.requestAnimationFrame(dt))};this.canvas.requestAnimationFrame(dt)}},e}(Fo);g.CameraContribution=ds;var Yu=function(){function t(e,n){this.type=e,this.target=n,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return t.copy=function(e){var n=new t(e.type,e.target);return n.addedNodes=e.addedNodes.slice(),n.removedNodes=e.removedNodes.slice(),n.previousSibling=e.previousSibling,n.nextSibling=e.nextSibling,n.attributeName=e.attributeName,n.attributeNamespace=e.attributeNamespace,n.oldValue=e.oldValue,n},t}(),fu=0,Us=new WeakMap,rc=function(){function t(e,n,r){this.observer=e,this.target=n,this.options=r,this.transientObservedNodes=[]}return t.prototype.enqueue=function(e){var n=this.observer.records,r=n.length;if(n.length>0){var i=n[r-1],s=Tf(i,e);if(s){n[r-1]=s;return}}else u0(this.observer);n[r]=e},t.prototype.addListeners=function(){this.addListeners_(this.target)},t.prototype.addListeners_=function(e){var n=this.options;n.attributes&&e.addEventListener(Sa.ATTR_MODIFIED,this,!0),n.childList&&e.addEventListener(Sa.INSERTED,this,!0),(n.childList||n.subtree)&&e.addEventListener(Sa.REMOVED,this,!0)},t.prototype.removeListeners=function(){this.removeListeners_(this.target)},t.prototype.removeListeners_=function(e){var n=this.options;n.attributes&&e.removeEventListener(Sa.ATTR_MODIFIED,this,!0),n.childList&&e.removeEventListener(Sa.INSERTED,this,!0),(n.childList||n.subtree)&&e.removeEventListener(Sa.REMOVED,this,!0)},t.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(n){this.removeListeners_(n);for(var r=Us.get(n),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},t.prototype.handleEvent=function(e){e.stopImmediatePropagation();var n,r;switch(e.type){case Sa.ATTR_MODIFIED:var i=e.attrName,s=e.relatedNode.namespaceURI;r=e.target,n=zf("attributes",r),n.attributeName=i,n.attributeNamespace=s;var l=e.attrChange===Wu.ADDITION?null:e.prevValue;td(r,function(x){if(x.attributes&&!(x.attributeFilter&&x.attributeFilter.length&&x.attributeFilter.indexOf(i)===-1&&x.attributeFilter.indexOf(s)===-1))return x.attributeOldValue?Jd(l):n});break;case Sa.REMOVED:case Sa.INSERTED:r=e.relatedNode;var u=e.target,h=void 0,p=void 0;e.type===Sa.INSERTED?(h=[u],p=[]):(h=[],p=[u]);var m=u.previousSibling,y=u.nextSibling;n=zf("childList",r),n.addedNodes=h,n.removedNodes=p,n.previousSibling=m,n.nextSibling=y,td(r,function(x){if(x.childList)return n})}ic()},t}(),Ac=function(){function t(e){this.callback=e,this.nodes=[],this.records=[],this.uid=fu++}return t.prototype.observe=function(e,n){if(!n.childList&&!n.attributes&&!n.characterData||n.attributeOldValue&&!n.attributes||n.attributeFilter&&n.attributeFilter.length&&!n.attributes||n.characterDataOldValue&&!n.characterData)throw new SyntaxError;var r=Us.get(e);r||Us.set(e,r=[]);for(var i,s=0;s<r.length;s++)if(r[s].observer===this){i=r[s],i.removeListeners(),i.options=n;break}i||(i=new rc(this,e,n),r.push(i),this.nodes.push(e)),i.addListeners()},t.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(n){for(var r=Us.get(n),i=0;i<r.length;i++){var s=r[i];if(s.observer===e){s.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},t.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},t}(),is,qu;function zf(t,e){return is=new Yu(t,e)}function Jd(t){return qu||(qu=Yu.copy(is),qu.oldValue=t,qu)}function ic(){is=qu=void 0}function uh(t){return t===qu||t===is}function Tf(t,e){return t===e?t:qu&&uh(t)?qu:null}function tp(t){t.nodes.forEach(function(e){var n=Us.get(e);n&&n.forEach(function(r){r.observer===t&&r.removeTransientObservers()})})}function td(t,e){for(var n=t;n;n=n.parentNode){var r=Us.get(n);if(r)for(var i=0;i<r.length;i++){var s=r[i],l=s.options;if(!(n!==t&&!l.subtree)){var u=e(l);u&&s.enqueue(u)}}}}var c0=!1,ed=[];function u0(t){ed.push(t),c0||(c0=!0,typeof g.globalThis!="undefined"?g.globalThis.setTimeout(vm):vm())}function vm(){c0=!1;var t=ed;ed=[],t.sort(function(n,r){return n.uid-r.uid});var e=!1;t.forEach(function(n){var r=n.takeRecords();tp(n),r.length&&(n.callback(r,n),e=!0)}),e&&vm()}var f0=function(t){(0,F.ZT)(e,t);function e(n,r,i,s){var l=t.call(this,n)||this;return l.currentTime=i,l.timelineTime=s,l.target=r,l.type="finish",l.bubbles=!1,l.currentTarget=r,l.defaultPrevented=!1,l.eventPhase=l.AT_TARGET,l.timeStamp=Date.now(),l.currentTime=i,l.timelineTime=s,l}return e}(Qv),gm=0,ng=function(){function t(e,n){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(gm++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,r){e.resolveReadyPromise=function(){n(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,r){e.resolveFinishedPromise=function(){n(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var n;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var e=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==e&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==e&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new f0(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(n)})}},t.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},t.prototype.updatePlaybackRate=function(e){this.playbackRate=e},t.prototype.targetAnimations=function(){var e,n=(e=this.effect)===null||e===void 0?void 0:e.target;return n.getAnimations()},t.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},t.prototype.unmarkTarget=function(){var e=this.targetAnimations(),n=e.indexOf(this);n!==-1&&e.splice(n,1)},t.prototype.tick=function(e,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(e))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},t.prototype.persist=function(){throw new Error(cr)},t.prototype.addEventListener=function(e,n,r){throw new Error(cr)},t.prototype.removeEventListener=function(e,n,r){throw new Error(cr)},t.prototype.dispatchEvent=function(e){throw new Error(cr)},t.prototype.commitStyles=function(){throw new Error(cr)},t.prototype.ensureAlive=function(){var e,n;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((n=this.effect)===null||n===void 0)&&n.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(e,n){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(e){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new f0(null,this,this.currentTime,e);setTimeout(function(){n.onfinish&&n.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new f0(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},t}(),uy=4,nd=.001,Dp=1e-7,j0=10,rd=11,Np=1/(rd-1),lv=typeof Float32Array=="function",rg=function(t,e){return 1-3*e+3*t},ym=function(t,e){return 3*e-6*t},kp=function(t){return 3*t},h0=function(t,e,n){return((rg(e,n)*t+ym(e,n))*t+kp(e))*t},_m=function(t,e,n){return 3*rg(e,n)*t*t+2*ym(e,n)*t+kp(e)},cv=function(t,e,n,r,i){var s,l,u=0;do l=e+(n-e)/2,s=h0(l,r,i)-t,s>0?n=l:e=l;while(Math.abs(s)>Dp&&++u<j0);return l},xm=function(t,e,n,r){for(var i=0;i<uy;++i){var s=_m(e,n,r);if(s===0)return e;var l=h0(e,n,r)-t;e-=l/s}return e},uv=function(t,e,n,r){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(u){return u};for(var i=lv?new Float32Array(rd):new Array(rd),s=0;s<rd;++s)i[s]=h0(s*Np,t,n);var l=function(u){for(var h=0,p=1,m=rd-1;p!==m&&i[p]<=u;++p)h+=Np;--p;var y=(u-i[p])/(i[p+1]-i[p]),x=h+y*Np,T=_m(x,t,n);return T>=nd?xm(u,x,t,n):T===0?x:cv(u,h,h+Np,t,n)};return function(u){return u===0||u===1?u:h0(l(u),e,r)}},V0=function(t){return t=t.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},Bp=function(t){return Math.pow(t,2)},Fp=function(t){return Math.pow(t,3)},d0=function(t){return Math.pow(t,4)},ep=function(t){return Math.pow(t,5)},p0=function(t){return Math.pow(t,6)},Up=function(t){return 1-Math.cos(t*Math.PI/2)},bm=function(t){return 1-Math.sqrt(1-t*t)},fv=function(t){return t*t*(3*t-2)},Em=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((e*3-2)/22-t,2)},hv=function(t,e){e===void 0&&(e=[]);var n=(0,F.CR)(e,2),r=n[0],i=r===void 0?1:r,s=n[1],l=s===void 0?.5:s,u=(0,uo.Z)(Number(i),1,10),h=(0,uo.Z)(Number(l),.1,2);return t===0||t===1?t:-u*Math.pow(2,10*(t-1))*Math.sin((t-1-h/(Math.PI*2)*Math.asin(1/u))*(Math.PI*2)/h)},Z0=function(t,e,n){e===void 0&&(e=[]);var r=(0,F.CR)(e,4),i=r[0],s=i===void 0?1:i,l=r[1],u=l===void 0?100:l,h=r[2],p=h===void 0?10:h,m=r[3],y=m===void 0?0:m;s=(0,uo.Z)(s,.1,1e3),u=(0,uo.Z)(u,.1,1e3),p=(0,uo.Z)(p,.1,1e3),y=(0,uo.Z)(y,.1,1e3);var x=Math.sqrt(u/s),T=p/(2*Math.sqrt(u*s)),C=T<1?x*Math.sqrt(1-T*T):0,M=1,I=T<1?(T*x+-y)/C:-y+x,D=n?n*t/1e3:t;return T<1?D=Math.exp(-D*T*x)*(M*Math.cos(C*D)+I*Math.sin(C*D)):D=(M+I*D)*Math.exp(-D*x),t===0||t===1?t:1-D},ig=function(t,e){e===void 0&&(e=[]);var n=(0,F.CR)(e,2),r=n[0],i=r===void 0?10:r,s=n[1],l=s=="start"?Math.ceil:Math.floor;return l((0,uo.Z)(t,0,1)*i)/i},Sm=function(t,e){e===void 0&&(e=[]);var n=(0,F.CR)(e,4),r=n[0],i=n[1],s=n[2],l=n[3];return uv(r,i,s,l)(t)},Cl=uv(.42,0,1,1),jc=function(t){return function(e,n,r){return n===void 0&&(n=[]),1-t(1-e,n,r)}},id=function(t){return function(e,n,r){return n===void 0&&(n=[]),e<.5?t(e*2,n,r)/2:1-t(e*-2+2,n,r)/2}},Eu=function(t){return function(e,n,r){return n===void 0&&(n=[]),e<.5?(1-t(1-e*2,n,r))/2:(t(e*2-1,n,r)+1)/2}},dv={steps:ig,"step-start":function(t){return ig(t,[1,"start"])},"step-end":function(t){return ig(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":Sm,ease:function(t){return Sm(t,[.25,.1,.25,1])},in:Cl,out:jc(Cl),"in-out":id(Cl),"out-in":Eu(Cl),"in-quad":Bp,"out-quad":jc(Bp),"in-out-quad":id(Bp),"out-in-quad":Eu(Bp),"in-cubic":Fp,"out-cubic":jc(Fp),"in-out-cubic":id(Fp),"out-in-cubic":Eu(Fp),"in-quart":d0,"out-quart":jc(d0),"in-out-quart":id(d0),"out-in-quart":Eu(d0),"in-quint":ep,"out-quint":jc(ep),"in-out-quint":id(ep),"out-in-quint":Eu(ep),"in-expo":p0,"out-expo":jc(p0),"in-out-expo":id(p0),"out-in-expo":Eu(p0),"in-sine":Up,"out-sine":jc(Up),"in-out-sine":id(Up),"out-in-sine":Eu(Up),"in-circ":bm,"out-circ":jc(bm),"in-out-circ":id(bm),"out-in-circ":Eu(bm),"in-back":fv,"out-back":jc(fv),"in-out-back":id(fv),"out-in-back":Eu(fv),"in-bounce":Em,"out-bounce":jc(Em),"in-out-bounce":id(Em),"out-in-bounce":Eu(Em),"in-elastic":hv,"out-elastic":jc(hv),"in-out-elastic":id(hv),"out-in-elastic":Eu(hv),spring:Z0,"spring-in":Z0,"spring-out":jc(Z0),"spring-in-out":id(Z0),"spring-out-in":Eu(Z0)},fy=function(t){return V0(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},og=function(t){return dv[fy(t)]||dv.linear},ff=function(t){return t},ag=1,pv=.5,np=0;function mv(t,e){return function(n){if(n>=1)return 1;var r=1/t;return n+=e*r,n-n%r}}var Tm="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",I_=new RegExp("cubic-bezier\\("+Tm+","+Tm+","+Tm+","+Tm+"\\)"),vv=/steps\(\s*(\d+)\s*\)/,L_=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function sg(t){var e=I_.exec(t);if(e)return uv.apply(void 0,(0,F.ev)([],(0,F.CR)(e.slice(1).map(Number)),!1));var n=vv.exec(t);if(n)return mv(Number(n[1]),np);var r=L_.exec(t);return r?mv(Number(r[1]),{start:ag,middle:pv,end:np}[r[2]]):og(t)}function D_(t){return Math.abs(N_(t)/(t.playbackRate||1))}function N_(t){var e;return t.duration===0||t.iterations===0?0:(t.duration==="auto"?0:Number(t.duration))*((e=t.iterations)!==null&&e!==void 0?e:1)}var lg=0,wf=1,H0=2,hy=3;function rp(t,e,n){if(e===null)return lg;var r=n.endTime;return e<Math.min(n.delay,r)?wf:e>=Math.min(n.delay+t+n.endDelay,r)?H0:hy}function dy(t,e,n,r,i){switch(r){case wf:return e==="backwards"||e==="both"?0:null;case hy:return n-i;case H0:return e==="forwards"||e==="both"?t:null;case lg:return null}}function py(t,e,n,r,i){var s=i;return t===0?e!==wf&&(s+=n):s+=r/t,s}function m0(t,e,n,r,i,s){var l=t===1/0?e%1:t%1;return l===0&&n===H0&&r!==0&&(i!==0||s===0)&&(l=1),l}function Vc(t,e,n,r){return t===H0&&e===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function wm(t,e,n){var r=t;if(t!=="normal"&&t!=="reverse"){var i=e;t==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?n:1-n}function Am(t,e,n){var r=rp(t,e,n),i=dy(t,n.fill,e,r,n.delay);if(i===null)return null;var s=n.duration==="auto"?0:n.duration,l=py(s,r,n.iterations,i,n.iterationStart),u=m0(l,n.iterationStart,r,n.iterations,i,s),h=Vc(r,n.iterations,u,l),p=wm(n.direction,h,u);return n.currentIteration=h,n.progress=p,n.easingFunction(p)}function G0(t,e,n){var r=k_(t,e),i=vy(r,n);return function(s,l){if(l!==null)i.filter(function(h){return l>=h.applyFrom&&l<h.applyTo}).forEach(function(h){var p=l-h.startOffset,m=h.endOffset-h.startOffset,y=m===0?0:p/m;s.setAttribute(h.property,h.interpolation(y),!1,!1)});else for(var u in r)v0(u)&&s.setAttribute(u,null)}}function v0(t){return t!=="offset"&&t!=="easing"&&t!=="composite"&&t!=="computedOffset"}function k_(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(v0(i)){var s={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:sg(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(s)}return n}function vy(t,e){var n=[];for(var r in t)for(var i=t[r],s=0;s<i.length-1;s++){var l=s,u=s+1,h=i[l].computedOffset,p=i[u].computedOffset,m=h,y=p;s===0&&(m=-1/0,p===0&&(u=l)),s===i.length-2&&(y=1/0,h===1&&(l=u)),n.push({applyFrom:m,applyTo:y,startOffset:i[l].computedOffset,endOffset:i[u].computedOffset,easingFunction:i[l].easingFunction,property:r,interpolation:Om(r,i[l].value,i[u].value,e)})}return n.sort(function(x,T){return x.startOffset-T.startOffset}),n}var gy=function(t,e,n){return function(r){var i=cg(t,e,r);return!g.enableCSSParsing&&(0,ge.Z)(i)?i:n(i)}};function Om(t,e,n,r){var i=Lr[t];if(i&&i.syntax&&i.int){var s=g.styleValueRegistry.getPropertySyntax(i.syntax);if(s){var l=void 0,u=void 0;if(g.enableCSSParsing){var h=g.styleValueRegistry.parseProperty(t,e,r,!1),p=g.styleValueRegistry.parseProperty(t,n,r,!1);l=g.styleValueRegistry.computeProperty(t,h,r,!1),u=g.styleValueRegistry.computeProperty(t,p,r,!1)}else{var m=s.parserWithCSSDisabled;l=m?m(e,r):e,u=m?m(n,r):n}var y=s.mixer(l,u,r);if(y){var x=gy.apply(void 0,(0,F.ev)([],(0,F.CR)(y),!1));return function(T){return T===0?e:T===1?n:x(T)}}}}return gy(!1,!0,function(T){return T?n:e})}function cg(t,e,n){if(typeof t=="number"&&typeof e=="number")return t*(1-n)+e*n;if(typeof t=="boolean"&&typeof e=="boolean"||typeof t=="string"&&typeof e=="string")return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,i=e.length,s=Math.max(r,i),l=[],u=0;u<s;u++)l.push(cg(t[u<r?u:r-1],e[u<i?u:i-1],n));return l}throw new Error("Mismatched interpolation arguments "+t+":"+e)}var Mh=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=ff,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=sg(e),this._easing=e},enumerable:!1,configurable:!0}),t}();function yy(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,s=0;s<i;s++){if(!e[s]){var l={};"offset"in t&&(l.offset=Number(t.offset)),"easing"in t&&(l.easing=t.easing),"composite"in t&&(l.composite=t.composite),e[s]=l}r[s]!==void 0&&r[s]!==null&&(e[s][n]=r[s])}}return e.sort(function(u,h){return(u.computedOffset||0)-(h.computedOffset||0)}),e}function gv(t,e){if(t===null)return[];Array.isArray(t)||(t=yy(t));for(var n=t.map(function(h){var p={};e!=null&&e.composite&&(p.composite="auto");for(var m in h){var y=h[m];if(m==="offset"){if(y!==null){if(y=Number(y),!isFinite(y))throw new Error("Keyframe offsets must be numbers.");if(y<0||y>1)throw new Error("Keyframe offsets must be between 0 and 1.");p.computedOffset=y}}else if(m==="composite"&&["replace","add","accumulate","auto"].indexOf(y)===-1)throw new Error("".concat(y," compositing is not supported"));p[m]=y}return p.offset===void 0&&(p.offset=null),p.easing===void 0&&(p.easing=(e==null?void 0:e.easing)||"linear"),p.composite===void 0&&(p.composite="auto"),p}),r=!0,i=-1/0,s=0;s<n.length;s++){var l=n[s].offset;if((0,tr.Z)(l))r=!1;else{if(l<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=l}}n=n.filter(function(h){return Number(h.offset)>=0&&Number(h.offset)<=1});function u(){var h,p,m=n.length;n[m-1].computedOffset=Number((h=n[m-1].offset)!==null&&h!==void 0?h:1),m>1&&(n[0].computedOffset=Number((p=n[0].offset)!==null&&p!==void 0?p:0));for(var y=0,x=Number(n[0].computedOffset),T=1;T<m;T++){var C=n[T].computedOffset;if(!(0,tr.Z)(C)&&!(0,tr.Z)(x)){for(var M=1;M<T-y;M++)n[y+M].computedOffset=x+(Number(C)-x)*M/(T-y);y=T,x=Number(C)}}}return r||u(),n}var ug="backwards|forwards|both|none".split("|"),Rl="reverse|alternate|alternate-reverse".split("|");function _y(t,e){var n=new Mh;return e&&(n.fill="both",n.duration="auto"),typeof t=="number"&&!isNaN(t)?n.duration=t:t!==void 0&&Object.keys(t).forEach(function(r){if(t[r]!==void 0&&t[r]!==null&&t[r]!=="auto"){if((typeof n[r]=="number"||r==="duration")&&(typeof t[r]!="number"||isNaN(t[r]))||r==="fill"&&ug.indexOf(t[r])===-1||r==="direction"&&Rl.indexOf(t[r])===-1)return;n[r]=t[r]}}),n}function xy(t,e){return t=cx(t!=null?t:{duration:"auto"}),_y(t,e)}function cx(t){return typeof t=="number"&&(isNaN(t)?t={duration:"auto"}:t={duration:t}),t}var B_=function(){function t(e,n,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=xy(r,!1),this.timing.effect=this,this.timing.activeDuration=D_(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=gv(n,this.timing),this.interpolations=G0(this.normalizedKeyframes,this.timing,this.target);var s=g.globalThis.Proxy;this.computedTiming=s?new s(this.timing,{get:function(l,u){return u==="duration"?l.duration==="auto"?0:l.duration:u==="fill"?l.fill==="auto"?"none":l.fill:u==="localTime"?i.animation&&i.animation.currentTime||null:u==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:l.currentIteration||0:u==="progress"?!i.animation||i.animation.playState!=="running"?null:l.progress||0:l[u]},set:function(){return!0}}):this.timing}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(e){return e===null?!1:(this.timeFraction=Am(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(e){this.normalizedKeyframes=gv(e)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(e){var n=this;Object.keys(e||{}).forEach(function(r){n.timing[r]=e[r]})},t}();function fg(t,e){return Number(t.id)-Number(e.id)}var Cm=function(){function t(e){var n=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){n.currentTime=r,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=n.rafCallbacks;n.rafCallbacks=[],r<Number(n.currentTime)&&(r=Number(n.currentTime)),n.animations.sort(fg),n.animations=n.tick(r,!0,n.animations)[0],i.forEach(function(s){s[1](r)}),n.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(e,n,r){var i=new B_(e,n,r),s=new ng(i,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s},t.prototype.applyDirtiedAnimation=function(e){var n=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(fg);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(s){var l=n.animations.indexOf(s);l!==-1&&n.animations.splice(l,1)}),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(e){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,e]),n},t.prototype.requestAnimationFrame=function(e){var n=this;return this.rAF(function(r){n.updateAnimationsPromises(),e(r),n.updateAnimationsPromises()})},t.prototype.tick=function(e,n,r){var i,s,l=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var u=[],h=[],p=[],m=[];return r.forEach(function(y){y.tick(e,n),y._inEffect?(h.push(y.effect),y.markTarget()):(u.push(y.effect),y.unmarkTarget()),y._needsTick&&(l.ticking=!0);var x=y._inEffect||y._needsTick;y._inTimeline=x,x?p.push(y):m.push(y)}),(i=this.pendingEffects).push.apply(i,(0,F.ev)([],(0,F.CR)(u),!1)),(s=this.pendingEffects).push.apply(s,(0,F.ev)([],(0,F.CR)(h),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[p,m]},t}();g.EasingFunction=sg,g.AnimationTimeline=Cm;var ux=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const cs=(t,e,n)=>[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]];cs.style=["fill"];const by=cs.bind(void 0);by.style=["stroke","lineWidth"];const hg=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]];hg.style=["fill"];const Ph=hg.bind(void 0);Ph.style=["fill"];const Rm=hg.bind(void 0);Rm.style=["stroke","lineWidth"];const Mm=(t,e,n)=>{const r=n*.618;return[["M",t-r,e],["L",t,e-n],["L",t+r,e],["L",t,e+n],["Z"]]};Mm.style=["fill"];const Ey=Mm.bind(void 0);Ey.style=["stroke","lineWidth"];const W0=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]};W0.style=["fill"];const yv=W0.bind(void 0);yv.style=["stroke","lineWidth"];const dg=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]};dg.style=["fill"];const fx=dg.bind(void 0);fx.style=["stroke","lineWidth"];const od=(t,e,n)=>{const r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]};od.style=["fill"];const zp=od.bind(void 0);zp.style=["stroke","lineWidth"];const g0=(t,e,n)=>{const r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]};g0.style=["fill"];const ip=g0.bind(void 0);ip.style=["stroke","lineWidth"];const _v=(t,e,n)=>[["M",t,e+n],["L",t,e-n]];_v.style=["stroke","lineWidth"];const hx=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]];hx.style=["stroke","lineWidth"];const dx=(t,e,n)=>[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]];dx.style=["stroke","lineWidth"];const px=(t,e,n)=>[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]];px.style=["stroke","lineWidth"];const mx=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];mx.style=["stroke","lineWidth"];const Sy=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];Sy.style=["stroke","lineWidth"];const Kl=Sy.bind(void 0);Kl.style=["stroke","lineWidth"];const Aw=(t,e,n)=>[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]];Aw.style=["stroke","lineWidth"];const Ow=(t,e,n)=>[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]];Ow.style=["stroke","lineWidth"];const vx=(t,e,n)=>[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]];vx.style=["stroke","lineWidth"];const k2=(t,e,n)=>[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]];k2.style=["stroke","lineWidth"];const Ty=(t,e,n)=>[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]];Ty.style=["stroke","lineWidth"];const op=new Map([["bowtie",g0],["cross",hx],["dash",Kl],["diamond",Mm],["dot",Sy],["hexagon",od],["hollowBowtie",ip],["hollowDiamond",Ey],["hollowHexagon",zp],["hollowPoint",by],["hollowSquare",Rm],["hollowTriangle",yv],["hollowTriangleDown",fx],["hv",Ow],["hvh",k2],["hyphen",mx],["line",_v],["plus",px],["point",cs],["rect",Ph],["smooth",Aw],["square",hg],["tick",dx],["triangleDown",dg],["triangle",W0],["vh",vx],["vhv",Ty]]);function B2(t,e){var{d:n,fill:r,lineWidth:i,path:s,stroke:l,color:u}=e,h=ux(e,["d","fill","lineWidth","path","stroke","color"]);const p=op.get(t)||op.get("point");return(...m)=>new Zi({style:Object.assign(Object.assign({},h),{d:p(...m),stroke:p.style.includes("stroke")?u||l:"",fill:p.style.includes("fill")?u||r:"",lineWidth:p.style.includes("lineWidth")?i||i||2:0})})}function F2(t,e){op.set(t,e)}function FM(t){op.delete(t)}const F_={};function Cw(t,e){t.startsWith("symbol.")?F2(t.split(".").pop(),e):Object.assign(F_,{[t]:e})}function Rw(t,e){var n=e.cx,r=n===void 0?0:n,i=e.cy,s=i===void 0?0:i,l=e.r;t.arc(r,s,l,0,Math.PI*2,!1)}function UM(t,e){var n=e.cx,r=n===void 0?0:n,i=e.cy,s=i===void 0?0:i,l=e.rx,u=e.ry;if(t.ellipse)t.ellipse(r,s,l,u,0,0,Math.PI*2,!1);else{var h=l>u?l:u,p=l>u?1:l/u,m=l>u?u/l:1;t.save(),t.scale(p,m),t.arc(r,s,h,0,Math.PI*2)}}function U2(t,e){var n=e.x1,r=e.y1,i=e.x2,s=e.y2,l=e.markerStart,u=e.markerEnd,h=e.markerStartOffset,p=e.markerEndOffset,m=0,y=0,x=0,T=0,C=0,M,I;l&&Yt(l)&&h&&(M=i-n,I=s-r,C=Math.atan2(I,M),m=Math.cos(C)*(h||0),y=Math.sin(C)*(h||0)),u&&Yt(u)&&p&&(M=n-i,I=r-s,C=Math.atan2(I,M),x=Math.cos(C)*(p||0),T=Math.sin(C)*(p||0)),t.moveTo(n+m,r+y),t.lineTo(i+x,s+T)}function pg(t,e){var n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,l=e.d,u=l.absolutePath,h=l.segments,p=0,m=0,y=0,x=0,T=0,C,M;if(n&&Yt(n)&&i){var I=(0,F.CR)(n.parentNode.getStartTangent(),2),D=I[0],U=I[1];C=D[0]-U[0],M=D[1]-U[1],T=Math.atan2(M,C),p=Math.cos(T)*(i||0),m=Math.sin(T)*(i||0)}if(r&&Yt(r)&&s){var Z=(0,F.CR)(r.parentNode.getEndTangent(),2),D=Z[0],U=Z[1];C=D[0]-U[0],M=D[1]-U[1],T=Math.atan2(M,C),y=Math.cos(T)*(s||0),x=Math.sin(T)*(s||0)}for(var G=0;G<u.length;G++){var W=u[G],$=W[0],J=u[G+1],nt=G===0&&(p!==0||m!==0),dt=(G===u.length-1||J&&(J[0]==="M"||J[0]==="Z"))&&y!==0&&x!==0;switch($){case"M":nt?(t.moveTo(W[1]+p,W[2]+m),t.lineTo(W[1],W[2])):t.moveTo(W[1],W[2]);break;case"L":dt?t.lineTo(W[1]+y,W[2]+x):t.lineTo(W[1],W[2]);break;case"Q":t.quadraticCurveTo(W[1],W[2],W[3],W[4]),dt&&t.lineTo(W[3]+y,W[4]+x);break;case"C":t.bezierCurveTo(W[1],W[2],W[3],W[4],W[5],W[6]),dt&&t.lineTo(W[5]+y,W[6]+x);break;case"A":{var Et=h[G].arcParams,Pt=Et.cx,Ht=Et.cy,Ct=Et.rx,Ft=Et.ry,jt=Et.startAngle,qt=Et.endAngle,Ee=Et.xRotation,oe=Et.sweepFlag;if(t.ellipse)t.ellipse(Pt,Ht,Ct,Ft,Ee,jt,qt,!!(1-oe));else{var _e=Ct>Ft?Ct:Ft,hn=Ct>Ft?1:Ct/Ft,Dn=Ct>Ft?Ft/Ct:1;t.translate(Pt,Ht),t.rotate(Ee),t.scale(hn,Dn),t.arc(0,0,_e,jt,qt,!!(1-oe)),t.scale(1/hn,1/Dn),t.rotate(-Ee),t.translate(-Pt,-Ht)}dt&&t.lineTo(W[6]+y,W[7]+x);break}case"Z":t.closePath();break}}}function Mw(t,e){var n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],x=0,T=0,C=0,M=0,I=0,D,U;n&&Yt(n)&&i&&(D=l[1][0]-l[0][0],U=l[1][1]-l[0][1],I=Math.atan2(U,D),x=Math.cos(I)*(i||0),T=Math.sin(I)*(i||0)),r&&Yt(r)&&s&&(D=l[u-1][0]-l[0][0],U=l[u-1][1]-l[0][1],I=Math.atan2(U,D),C=Math.cos(I)*(s||0),M=Math.sin(I)*(s||0)),t.moveTo(h+(x||C),p+(T||M));for(var Z=1;Z<u-1;Z++){var G=l[Z];t.lineTo(G[0],G[1])}t.lineTo(m,y)}function Pw(t,e){var n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],x=0,T=0,C=0,M=0,I=0,D,U;n&&Yt(n)&&i&&(D=l[1][0]-l[0][0],U=l[1][1]-l[0][1],I=Math.atan2(U,D),x=Math.cos(I)*(i||0),T=Math.sin(I)*(i||0)),r&&Yt(r)&&s&&(D=l[u-2][0]-l[u-1][0],U=l[u-2][1]-l[u-1][1],I=Math.atan2(U,D),C=Math.cos(I)*(s||0),M=Math.sin(I)*(s||0)),t.moveTo(h+x,p+T);for(var Z=1;Z<u-1;Z++){var G=l[Z];t.lineTo(G[0],G[1])}t.lineTo(m+C,y+M)}function wy(t,e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i,l=e.radius,u=e.width,h=e.height,p=u,m=h,y=l&&l.some(function(G){return G!==0});if(!y)t.rect(r,s,p,m);else{var x=u>0?1:-1,T=h>0?1:-1,C=x+T===0,M=(0,F.CR)(l.map(function(G){return(0,uo.Z)(G,0,Math.min(Math.abs(p)/2,Math.abs(m)/2))}),4),I=M[0],D=M[1],U=M[2],Z=M[3];t.moveTo(x*I+r,s),t.lineTo(p-x*D+r,s),D!==0&&t.arc(p-x*D+r,T*D+s,D,-T*Math.PI/2,x>0?0:Math.PI,C),t.lineTo(p+r,m-T*U+s),U!==0&&t.arc(p-x*U+r,m-T*U+s,U,x>0?0:Math.PI,T>0?Math.PI/2:1.5*Math.PI,C),t.lineTo(x*Z+r,m+s),Z!==0&&t.arc(x*Z+r,m-T*Z+s,Z,T>0?Math.PI/2:-Math.PI/2,x>0?Math.PI:0,C),t.lineTo(r,T*I+s),I!==0&&t.arc(x*I+r,T*I+s,I,x>0?Math.PI:0,T>0?Math.PI*1.5:Math.PI/2,C)}}var Iw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="canvas-path-generator",n}return e.prototype.init=function(){var n,r=(n={},n[Gr.CIRCLE]=Rw,n[Gr.ELLIPSE]=UM,n[Gr.RECT]=wy,n[Gr.LINE]=U2,n[Gr.POLYLINE]=Pw,n[Gr.POLYGON]=Mw,n[Gr.PATH]=pg,n[Gr.TEXT]=void 0,n[Gr.GROUP]=void 0,n[Gr.IMAGE]=void 0,n[Gr.HTML]=void 0,n[Gr.MESH]=void 0,n);this.context.pathGeneratorFactory=r},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(Xc),Lw=Vt.Ue(),z2=Vt.Ue(),zM=Vt.Ue(),U_=ae.create(),gx=function(){function t(){var e=this;this.isHit=function(n,r,i,s){var l=e.context.pointInPathPickerFactory[n.nodeName];if(l){var u=ae.invert(U_,i),h=Vt.fF(z2,Vt.t8(zM,r[0],r[1],0),u);if(l(n,new ar(h[0],h[1]),s,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(n,r){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),s=e.context.pathGeneratorFactory[n.nodeName];return s&&(i.beginPath(),s(i,n.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return t.prototype.apply=function(e,n){var r=this,i,s=e.renderingService,l=e.renderingContext;this.context=e,this.runtime=n;var u=(i=l.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(t.tag,function(h){return(0,F.mG)(r,void 0,void 0,function(){return(0,F.Jh)(this,function(p){return[2,this.pick(u,h)]})})}),s.hooks.pickSync.tap(t.tag,function(h){return r.pick(u,h)})},t.prototype.pick=function(e,n){var r,i,s=n.topmost,l=n.position,u=l.x,h=l.y,p=Vt.t8(Lw,u,h,0),m=e.elementsFromBBox(p[0],p[1],p[0],p[1]),y=[];try{for(var x=(0,F.XA)(m),T=x.next();!T.done;T=x.next()){var C=T.value,M=C.getWorldTransform(),I=this.isHit(C,p,M,!1);if(I){var D=rs(C);if(D){var U=D.parsedStyle.clipPath,Z=this.isHit(U,p,U.getWorldTransform(),!0);if(Z){if(s)return n.picked=[C],n;y.push(C)}}else{if(s)return n.picked=[C],n;y.push(C)}}}}catch(G){r={error:G}}finally{try{T&&!T.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}return n.picked=y,n},t.tag="CanvasPicker",t}();function jM(t,e,n){var r=t.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.r,p=r.fill,m=r.stroke,y=r.lineWidth,x=y===void 0?1:y,T=r.increasedLineWidthForHitTesting,C=T===void 0?0:T,M=r.pointerEvents,I=M===void 0?"auto":M,D=(x+C)/2,U=mt(s,u,e.x,e.y),Z=(0,F.CR)(ja(I,p,m),2),G=Z[0],W=Z[1];return G&&W||n?U<=h+D:G?U<=h:W?U>=h-D&&U<=h+D:!1}function z_(t,e,n,r){return t/(n*n)+e/(r*r)}function VM(t,e,n){var r=t.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.rx,p=r.ry,m=r.fill,y=r.stroke,x=r.lineWidth,T=x===void 0?1:x,C=r.increasedLineWidthForHitTesting,M=C===void 0?0:C,I=r.pointerEvents,D=I===void 0?"auto":I,U=e.x,Z=e.y,G=(0,F.CR)(ja(D,m,y),2),W=G[0],$=G[1],J=(T+M)/2,nt=(U-s)*(U-s),dt=(Z-u)*(Z-u);return W&&$||n?z_(nt,dt,h+J,p+J)<=1:W?z_(nt,dt,h,p)<=1:$?z_(nt,dt,h-J,p-J)>=1&&z_(nt,dt,h+J,p+J)<=1:!1}function xv(t,e,n,r,i,s){return i>=t&&i<=t+n&&s>=e&&s<=e+r}function ZM(t,e,n,r,i,s,l){var u=i/2;return xv(t-u,e-u,n,i,s,l)||xv(t+n-u,e-u,i,r,s,l)||xv(t+u,e+r-u,n,i,s,l)||xv(t-u,e+u,i,r,s,l)}function j_(t,e,n,r,i,s,l,u){var h=(Math.atan2(u-e,l-t)+Math.PI*2)%(Math.PI*2),p={x:t+n*Math.cos(h),y:e+n*Math.sin(h)};return mt(p.x,p.y,l,u)<=s/2}function jp(t,e,n,r,i,s,l){var u=Math.min(t,n),h=Math.max(t,n),p=Math.min(e,r),m=Math.max(e,r),y=i/2;return s>=u-y&&s<=h+y&&l>=p-y&&l<=m+y?Sd(t,e,n,r,s,l)<=i/2:!1}function Dw(t,e,n,r,i){var s=t.length;if(s<2)return!1;for(var l=0;l<s-1;l++){var u=t[l][0],h=t[l][1],p=t[l+1][0],m=t[l+1][1];if(jp(u,h,p,m,e,n,r))return!0}if(i){var y=t[0],x=t[s-1];if(jp(y[0],y[1],x[0],x[1],e,n,r))return!0}return!1}var HM=1e-6;function yx(t){return Math.abs(t)<HM?0:t<0?-1:1}function Nw(t,e,n){return(n[0]-t[0])*(e[1]-t[1])===(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function j2(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var s=0;s<i;s++){var l=t[s],u=t[(s+1)%i];if(Nw(l,u,[e,n]))return!0;yx(l[1]-n)>0!=yx(u[1]-n)>0&&yx(e-(n-l[1])*(l[0]-u[0])/(l[1]-u[1])-l[0])<0&&(r=!r)}return r}function V2(t,e,n){for(var r=!1,i=0;i<t.length;i++){var s=t[i];if(r=j2(s,e,n),r)break}return r}function kw(t,e,n){var r=t.parsedStyle,i=r.x1,s=r.y1,l=r.x2,u=r.y2,h=r.lineWidth,p=h===void 0?1:h,m=r.increasedLineWidthForHitTesting,y=m===void 0?0:m,x=r.pointerEvents,T=x===void 0?"auto":x,C=r.fill,M=r.stroke,I=(0,F.CR)(ja(T,C,M),2),D=I[1];return!D&&!n||!p?!1:jp(i,s,l,u,p+y,e.x,e.y)}function Bw(t,e,n,r,i){for(var s=!1,l=e/2,u=0;u<t.length;u++){var h=t[u],p=h.currentPoint,m=h.params,y=h.prePoint,x=h.box;if(!(x&&!xv(x.x-l,x.y-l,x.width+e,x.height+e,n,r)))switch(h.command){case"L":case"Z":if(s=jp(y[0],y[1],p[0],p[1],e,n,r),s)return!0;break;case"Q":var T=Kp(y[0],y[1],m[1],m[2],m[3],m[4],n,r);if(s=T<=e/2,s)return!0;break;case"C":var C=xp(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],n,r,i);if(s=C<=e/2,s)return!0;break;case"A":h.cubicParams||(h.cubicParams=$f(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],m[7],void 0));for(var M=h.cubicParams,I=y,D=0;D<M.length;D+=6){var U=xp(I[0],I[1],M[D],M[D+1],M[D+2],M[D+3],M[D+4],M[D+5],n,r,i);if(I=[M[D+4],M[D+5]],s=U<=e/2,s)return!0}break}}return s}function Fw(t,e,n,r,i,s){var l=t.parsedStyle,u=l.lineWidth,h=u===void 0?1:u,p=l.increasedLineWidthForHitTesting,m=p===void 0?0:p,y=l.stroke,x=l.fill,T=l.d,C=l.pointerEvents,M=C===void 0?"auto":C,I=T.segments,D=T.hasArc,U=T.polylines,Z=T.polygons,G=(0,F.CR)(ja(M,(Z==null?void 0:Z.length)&&x,y),2),W=G[0],$=G[1],J=Sf(t),nt=!1;return W||n?(D?nt=r(t,e):nt=V2(Z,e.x,e.y)||V2(U,e.x,e.y),nt):(($||n)&&(nt=Bw(I,h+m,e.x,e.y,J)),nt)}function Z2(t,e,n){var r=t.parsedStyle,i=r.stroke,s=r.fill,l=r.lineWidth,u=l===void 0?1:l,h=r.increasedLineWidthForHitTesting,p=h===void 0?0:h,m=r.points,y=r.pointerEvents,x=y===void 0?"auto":y,T=(0,F.CR)(ja(x,s,i),2),C=T[0],M=T[1],I=!1;return(M||n)&&(I=Dw(m.points,u+p,e.x,e.y,!0)),!I&&(C||n)&&(I=j2(m.points,e.x,e.y)),I}function H2(t,e,n){var r=t.parsedStyle,i=r.lineWidth,s=i===void 0?1:i,l=r.increasedLineWidthForHitTesting,u=l===void 0?0:l,h=r.points,p=r.pointerEvents,m=p===void 0?"auto":p,y=r.fill,x=r.stroke,T=(0,F.CR)(ja(m,y,x),2),C=T[1];return!C&&!n||!s?!1:Dw(h.points,s+u,e.x,e.y,!1)}function ad(t,e,n,r,i){var s=t.parsedStyle,l=s.radius,u=s.fill,h=s.stroke,p=s.lineWidth,m=p===void 0?1:p,y=s.increasedLineWidthForHitTesting,x=y===void 0?0:y,T=s.x,C=T===void 0?0:T,M=s.y,I=M===void 0?0:M,D=s.width,U=s.height,Z=s.pointerEvents,G=Z===void 0?"auto":Z,W=(0,F.CR)(ja(G,u,h),2),$=W[0],J=W[1],nt=l&&l.some(function(Ht){return Ht!==0}),dt=m+x;if(nt){var Pt=!1;return(J||n)&&(Pt=Uw(C,I,D,U,l.map(function(Ht){return(0,uo.Z)(Ht,0,Math.min(Math.abs(D)/2,Math.abs(U)/2))}),dt,e.x,e.y)),!Pt&&($||n)&&(Pt=r(t,e)),Pt}else{var Et=dt/2;if($&&J||n)return xv(C-Et,I-Et,D+Et,U+Et,e.x,e.y);if($)return xv(C,I,D,U,e.x,e.y);if(J)return ZM(C,I,D,U,dt,e.x,e.y)}return!1}function Uw(t,e,n,r,i,s,l,u){var h=(0,F.CR)(i,4),p=h[0],m=h[1],y=h[2],x=h[3];return jp(t+p,e,t+n-m,e,s,l,u)||jp(t+n,e+m,t+n,e+r-y,s,l,u)||jp(t+n-y,e+r,t+x,e+r,s,l,u)||jp(t,e+r-x,t,e+p,s,l,u)||j_(t+n-m,e+m,m,1.5*Math.PI,2*Math.PI,s,l,u)||j_(t+n-y,e+r-y,y,0,.5*Math.PI,s,l,u)||j_(t+x,e+r-x,x,.5*Math.PI,Math.PI,s,l,u)||j_(t+p,e+p,p,Math.PI,1.5*Math.PI,s,l,u)}function zw(t,e,n,r,i,s){var l=t.parsedStyle,u=l.pointerEvents,h=u===void 0?"auto":u,p=l.x,m=p===void 0?0:p,y=l.y,x=y===void 0?0:y,T=l.width,C=l.height;if(h==="non-transparent-pixel"){var M=i.config.offscreenCanvas,I=s.offscreenCanvasCreator.getOrCreateCanvas(M),D=s.offscreenCanvasCreator.getOrCreateContext(M,{willReadFrequently:!0});I.width=T,I.height=C,i.defaultStyleRendererFactory[Gr.IMAGE].render(D,(0,F.pi)((0,F.pi)({},t.parsedStyle),{x:0,y:0}),t,void 0,void 0,void 0);var U=D.getImageData(e.x-m,e.y-x,1,1).data;return U.every(function(Z){return Z!==0})}return!0}var jw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="canvas-picker",n}return e.prototype.init=function(){var n,r=function(){return!0},i=(n={},n[Gr.CIRCLE]=jM,n[Gr.ELLIPSE]=VM,n[Gr.RECT]=ad,n[Gr.LINE]=kw,n[Gr.POLYLINE]=H2,n[Gr.POLYGON]=Z2,n[Gr.PATH]=Fw,n[Gr.TEXT]=r,n[Gr.GROUP]=null,n[Gr.IMAGE]=zw,n[Gr.HTML]=null,n[Gr.MESH]=null,n);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new gx)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(Xc),Vw=function(){function t(e){this.canvasRendererPluginOptions=e,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=ae.create(),this.dprMatrix=ae.create(),this.tmpMat4=ae.create(),this.vec3a=Vt.Ue(),this.vec3b=Vt.Ue(),this.vec3c=Vt.Ue(),this.vec3d=Vt.Ue()}return t.prototype.apply=function(e,n){var r=this;this.context=e;var i=e.config,s=e.camera,l=e.renderingService,u=e.renderingContext,h=e.rBushRoot,p=e.pathGeneratorFactory;this.rBush=h,this.pathGeneratorFactory=p;var m=e.contextService,y=u.root.ownerDocument.defaultView,x=function(M){var I=M.target,D=I.rBushNode;D.aabb&&r.removedRBushNodeAABBs.push(D.aabb)},T=function(M){var I=M.target,D=I.rBushNode;D.aabb&&r.removedRBushNodeAABBs.push(D.aabb)};l.hooks.init.tap(t.tag,function(){y.addEventListener(Sa.UNMOUNTED,x),y.addEventListener(Sa.CULLED,T);var M=m.getDPR(),I=i.width,D=i.height,U=m.getContext();r.clearRect(U,0,0,I*M,D*M,i.background)}),l.hooks.destroy.tap(t.tag,function(){y.removeEventListener(Sa.UNMOUNTED,x),y.removeEventListener(Sa.CULLED,T),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),l.hooks.beginFrame.tap(t.tag,function(){var M,I=m.getContext(),D=m.getDPR(),U=i.width,Z=i.height,G=r.canvasRendererPluginOptions,W=G.dirtyObjectNumThreshold,$=G.dirtyObjectRatioThreshold,J=l.getStats(),nt=J.total,dt=J.rendered,Et=dt/nt;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((M=y.context.renderingPlugins[1])===null||M===void 0)&&M.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||dt>W&&Et>$,I&&(I.resetTransform?I.resetTransform():I.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(I,0,0,U*D,Z*D,i.background))});var C=function(M,I){M.isVisible()&&!M.isCulled()&&r.renderDisplayObject(M,I,r.context,r.restoreStack,n);var D=M.sortable.sorted||M.childNodes;D.forEach(function(U){C(U,I)})};l.hooks.endFrame.tap(t.tag,function(){if(u.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var M=m.getContext(),I=m.getDPR();if(ae.fromScaling(r.dprMatrix,[I,I,1]),ae.multiply(r.vpMatrix,r.dprMatrix,s.getOrthoMatrix()),r.clearFullScreen)C(u.root,M);else{var D=r.safeMergeAABB.apply(r,(0,F.ev)([r.mergeDirtyAABBs(r.renderQueue)],(0,F.CR)(r.removedRBushNodeAABBs.map(function(Dn){var Kn=Dn.minX,Jn=Dn.minY,zr=Dn.maxX,ui=Dn.maxY,Ki=new vn;return Ki.setMinMax([Kn,Jn,0],[zr,ui,0]),Ki})),!1));if(r.removedRBushNodeAABBs=[],vn.isEmpty(D)){r.renderQueue=[];return}var U=r.convertAABB2Rect(D),Z=U.x,G=U.y,W=U.width,$=U.height,J=Vt.fF(r.vec3a,[Z,G,0],r.vpMatrix),nt=Vt.fF(r.vec3b,[Z+W,G,0],r.vpMatrix),dt=Vt.fF(r.vec3c,[Z,G+$,0],r.vpMatrix),Et=Vt.fF(r.vec3d,[Z+W,G+$,0],r.vpMatrix),Pt=Math.min(J[0],nt[0],Et[0],dt[0]),Ht=Math.min(J[1],nt[1],Et[1],dt[1]),Ct=Math.max(J[0],nt[0],Et[0],dt[0]),Ft=Math.max(J[1],nt[1],Et[1],dt[1]),jt=Math.floor(Pt),qt=Math.floor(Ht),Ee=Math.ceil(Ct-Pt),oe=Math.ceil(Ft-Ht);M.save(),r.clearRect(M,jt,qt,Ee,oe,i.background),M.beginPath(),M.rect(jt,qt,Ee,oe),M.clip(),M.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var _e=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;_e&&y.dispatchEvent(new tl(Vs.DIRTY_RECTANGLE,{dirtyRect:{x:jt,y:qt,width:Ee,height:oe}}));var hn=r.searchDirtyObjects(D);hn.sort(function(Dn,Kn){return Dn.sortable.renderOrder-Kn.sortable.renderOrder}).forEach(function(Dn){Dn&&Dn.isVisible()&&!Dn.isCulled()&&r.renderDisplayObject(Dn,M,r.context,r.restoreStack,n)}),M.restore(),r.renderQueue.forEach(function(Dn){r.saveDirtyAABB(Dn)}),r.renderQueue=[]}r.restoreStack.forEach(function(){M.restore()}),r.restoreStack=[]}),l.hooks.render.tap(t.tag,function(M){r.clearFullScreen||r.renderQueue.push(M)})},t.prototype.clearRect=function(e,n,r,i,s,l){e.clearRect(n,r,i,s),l&&(e.fillStyle=l,e.fillRect(n,r,i,s))},t.prototype.renderDisplayObject=function(e,n,r,i,s){var l=e.nodeName,u=i[i.length-1];u&&!(e.compareDocumentPosition(u)&Za.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),i.pop());var h=this.context.styleRendererFactory[l],p=this.pathGeneratorFactory[l],m=e.parsedStyle.clipPath;if(m){this.applyWorldTransform(n,m);var y=this.pathGeneratorFactory[m.nodeName];y&&(n.save(),i.push(e),n.beginPath(),y(n,m.parsedStyle),n.closePath(),n.clip())}h&&(this.applyWorldTransform(n,e),n.save(),this.applyAttributesToContext(n,e)),p&&(n.beginPath(),p(n,e.parsedStyle),e.nodeName!==Gr.LINE&&e.nodeName!==Gr.PATH&&e.nodeName!==Gr.POLYLINE&&n.closePath()),h&&(h.render(n,e.parsedStyle,e,r,this,s),n.restore()),e.renderable.dirty=!1},t.prototype.convertAABB2Rect=function(e){var n=e.getMin(),r=e.getMax(),i=Math.floor(n[0]),s=Math.floor(n[1]),l=Math.ceil(r[0]),u=Math.ceil(r[1]),h=l-i,p=u-s;return{x:i,y:s,width:h,height:p}},t.prototype.mergeDirtyAABBs=function(e){var n=new vn;return e.forEach(function(r){var i=r.getRenderBounds();n.add(i);var s=r.renderable.dirtyRenderBounds;s&&n.add(s)}),n},t.prototype.searchDirtyObjects=function(e){var n=(0,F.CR)(e.getMin(),2),r=n[0],i=n[1],s=(0,F.CR)(e.getMax(),2),l=s[0],u=s[1],h=this.rBush.search({minX:r,minY:i,maxX:l,maxY:u});return h.map(function(p){var m=p.displayObject;return m})},t.prototype.saveDirtyAABB=function(e){var n=e.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new vn);var r=e.getRenderBounds();r&&n.dirtyRenderBounds.update(r.center,r.halfExtents)},t.prototype.applyAttributesToContext=function(e,n){var r=n.parsedStyle,i=r.stroke,s=r.fill,l=r.opacity,u=r.lineDash,h=r.lineDashOffset;u&&e.setLineDash(u),(0,tr.Z)(h)||(e.lineDashOffset=h),(0,tr.Z)(l)||(e.globalAlpha*=l),!(0,tr.Z)(i)&&!Array.isArray(i)&&!i.isNone&&(e.strokeStyle=n.attributes.stroke),!(0,tr.Z)(s)&&!Array.isArray(s)&&!s.isNone&&(e.fillStyle=n.attributes.fill)},t.prototype.applyWorldTransform=function(e,n,r){r?(ae.copy(this.tmpMat4,n.getLocalTransform()),ae.multiply(this.tmpMat4,r,this.tmpMat4),ae.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(ae.copy(this.tmpMat4,n.getWorldTransform()),ae.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},t.prototype.safeMergeAABB=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=new vn;return e.forEach(function(i){r.add(i)}),r},t.tag="CanvasRenderer",t}(),Pm=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r,i,s,l){var u=n.fill,h=n.fillRule,p=n.opacity,m=p===void 0?1:p,y=n.fillOpacity,x=y===void 0?1:y,T=n.stroke,C=n.strokeOpacity,M=C===void 0?1:C,I=n.lineWidth,D=I===void 0?1:I,U=n.lineCap,Z=n.lineJoin,G=n.shadowType,W=n.shadowColor,$=n.shadowBlur,J=n.filter,nt=n.miterLimit,dt=u&&!u.isNone,Et=T&&!T.isNone&&D>0,Pt=(u==null?void 0:u.alpha)===0,Ht=!!(J&&J.length),Ct=!(0,tr.Z)(W)&&$>0,Ft=r.nodeName,jt=G==="inner",qt=Et&&Ct&&(Ft===Gr.PATH||Ft===Gr.LINE||Ft===Gr.POLYLINE||Pt||jt);dt&&(e.globalAlpha=m*x,qt||V_(r,e,Ct),W2(e,r,u,h,i,s,l,this.imagePool),qt||this.clearShadowAndFilter(e,Ht,Ct)),Et&&(e.globalAlpha=m*M,e.lineWidth=D,(0,tr.Z)(nt)||(e.miterLimit=nt),(0,tr.Z)(U)||(e.lineCap=U),(0,tr.Z)(Z)||(e.lineJoin=Z),qt&&(jt&&(e.globalCompositeOperation="source-atop"),V_(r,e,!0),jt&&(xx(e,r,T,i,s,l,this.imagePool),e.globalCompositeOperation="source-over",this.clearShadowAndFilter(e,Ht,!0))),xx(e,r,T,i,s,l,this.imagePool))},t.prototype.clearShadowAndFilter=function(e,n,r){if(r&&(e.shadowColor="transparent",e.shadowBlur=0),n){var i=e.filter;!(0,tr.Z)(i)&&i.indexOf("drop-shadow")>-1&&(e.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},t}();function V_(t,e,n){var r=t.parsedStyle,i=r.filter,s=r.shadowColor,l=r.shadowBlur,u=r.shadowOffsetX,h=r.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),n&&(e.shadowColor=s.toString(),e.shadowBlur=l||0,e.shadowOffsetX=u||0,e.shadowOffsetY=h||0)}function G2(t,e,n,r,i,s,l){var u,h;if(t.image.nodeName==="rect"){var p=t.image.parsedStyle,m=p.width,y=p.height;h=r.contextService.getDPR();var x=r.config.offscreenCanvas;u=s.offscreenCanvasCreator.getOrCreateCanvas(x),u.width=m*h,u.height=y*h;var T=s.offscreenCanvasCreator.getOrCreateContext(x),C=[];t.image.forEach(function(I){i.renderDisplayObject(I,T,r,C,s)}),C.forEach(function(){T.restore()})}var M=l.getOrCreatePatternSync(t,n,u,h,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,r.renderingService.dirtify()});return M}function _x(t,e,n,r){var i;if(t.type===vl.LinearGradient||t.type===vl.RadialGradient){var s=e.getGeometryBounds(),l=s&&s.halfExtents[0]*2||1,u=s&&s.halfExtents[1]*2||1,h=s&&s.min||[0,0];i=r.getOrCreateGradient((0,F.pi)((0,F.pi)({type:t.type},t.value),{min:h,width:l,height:u}),n)}return i}function W2(t,e,n,r,i,s,l,u,h){h===void 0&&(h=!1),Array.isArray(n)?n.forEach(function(p){t.fillStyle=_x(p,e,t,u),h||(r?t.fill(r):t.fill())}):(Gd(n)&&(t.fillStyle=G2(n,e,t,i,s,l,u)),h||(r?t.fill(r):t.fill()))}function xx(t,e,n,r,i,s,l,u){u===void 0&&(u=!1),Array.isArray(n)?n.forEach(function(h){t.strokeStyle=_x(h,e,t,l),u||t.stroke()}):(Gd(n)&&(t.strokeStyle=G2(n,e,t,r,i,s,l)),u||t.stroke())}var Zw=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=n.width,p=n.height,m=n.src,y=n.shadowColor,x=n.shadowBlur,T,C=h,M=p;if(Si(m)?T=this.imagePool.getImageSync(m):(C||(C=m.width),M||(M=m.height),T=m),T){var I=!(0,tr.Z)(y)&&x>0;V_(r,e,I);try{e.drawImage(T,s,u,C,M)}catch(D){}}},t}(),X2=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r,i,s,l){r.getBounds();var u=n,h=u.lineWidth,p=h===void 0?1:h,m=u.textAlign,y=m===void 0?"start":m,x=u.textBaseline,T=x===void 0?"alphabetic":x,C=u.lineJoin,M=C===void 0?"miter":C,I=u.miterLimit,D=I===void 0?10:I,U=u.letterSpacing,Z=U===void 0?0:U,G=u.stroke,W=u.fill,$=u.fillRule,J=u.fillOpacity,nt=J===void 0?1:J,dt=u.strokeOpacity,Et=dt===void 0?1:dt,Pt=u.opacity,Ht=Pt===void 0?1:Pt,Ct=u.metrics,Ft=u.x,jt=Ft===void 0?0:Ft,qt=u.y,Ee=qt===void 0?0:qt,oe=u.dx,_e=u.dy,hn=u.shadowColor,Dn=u.shadowBlur,Kn=Ct.font,Jn=Ct.lines,zr=Ct.height,ui=Ct.lineHeight,Ki=Ct.lineMetrics;e.font=Kn,e.lineWidth=p,e.textAlign=y==="middle"?"center":y;var Qr=T;!l.enableCSSParsing&&Qr==="alphabetic"&&(Qr="bottom"),e.lineJoin=M,(0,tr.Z)(D)||(e.miterLimit=D);var Kr=Ee;T==="middle"?Kr+=-zr/2-ui/2:T==="bottom"||T==="alphabetic"||T==="ideographic"?Kr+=-zr:(T==="top"||T==="hanging")&&(Kr+=-ui);var Co=jt+(oe||0);Kr+=_e||0,Jn.length===1&&(Qr==="bottom"?(Qr="middle",Kr-=.5*zr):Qr==="top"&&(Qr="middle",Kr+=.5*zr)),e.textBaseline=Qr;var Qi=!(0,tr.Z)(hn)&&Dn>0;V_(r,e,Qi);for(var ji=0;ji<Jn.length;ji++){var _o=p/2+Co;Kr+=ui,!(0,tr.Z)(G)&&!G.isNone&&p&&this.drawLetterSpacing(e,r,Jn[ji],Ki[ji],y,_o,Kr,Z,W,$,nt,G,Et,Ht,!0,i,s,l),(0,tr.Z)(W)||this.drawLetterSpacing(e,r,Jn[ji],Ki[ji],y,_o,Kr,Z,W,$,nt,G,Et,Ht,!1,i,s,l)}},t.prototype.drawLetterSpacing=function(e,n,r,i,s,l,u,h,p,m,y,x,T,C,M,I,D,U){if(h===0){M?this.strokeText(e,n,r,l,u,x,T,I,D,U):this.fillText(e,n,r,l,u,p,m,y,C,I,D,U);return}var Z=e.textAlign;e.textAlign="left";var G=l;s==="center"||s==="middle"?G=l-i.width/2:(s==="right"||s==="end")&&(G=l-i.width);for(var W=Array.from(r),$=e.measureText(r).width,J=0,nt=0;nt<W.length;++nt){var dt=W[nt];M?this.strokeText(e,n,dt,G,u,x,T,I,D,U):this.fillText(e,n,dt,G,u,p,m,y,C,I,D,U),J=e.measureText(r.substring(nt+1)).width,G+=$-J+h,$=J}e.textAlign=Z},t.prototype.fillText=function(e,n,r,i,s,l,u,h,p,m,y,x){W2(e,n,l,u,m,y,x,this.imagePool,!0);var T,C=!(0,tr.Z)(h)&&h!==1;C&&(T=e.globalAlpha,e.globalAlpha=h*p),e.fillText(r,i,s),C&&(e.globalAlpha=T)},t.prototype.strokeText=function(e,n,r,i,s,l,u,h,p,m){xx(e,n,l,h,p,m,this.imagePool,!0);var y,x=!(0,tr.Z)(u)&&u!==1;x&&(y=e.globalAlpha,e.globalAlpha=u),e.strokeText(r,i,s),x&&(e.globalAlpha=y)},t}(),GM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),WM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),XM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),YM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),qM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),$M=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),KM=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pm),QM=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=t.call(this)||this;return r.options=n,r.name="canvas-renderer",r}return e.prototype.init=function(){var n,r=(0,F.pi)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,s=new Pm(i),l=(n={},n[Gr.CIRCLE]=s,n[Gr.ELLIPSE]=s,n[Gr.RECT]=s,n[Gr.IMAGE]=new Zw(i),n[Gr.TEXT]=new X2(i),n[Gr.LINE]=s,n[Gr.POLYLINE]=s,n[Gr.POLYGON]=s,n[Gr.PATH]=s,n[Gr.GROUP]=void 0,n[Gr.HTML]=void 0,n[Gr.MESH]=void 0,n);this.context.defaultStyleRendererFactory=l,this.context.styleRendererFactory=l,this.addRenderingPlugin(new Vw(r))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(Xc),Y2=function(){function t(){}return t.prototype.apply=function(e,n){var r=this,i=e.renderingService,s=e.renderingContext,l=e.config;this.context=e;var u=s.root.ownerDocument.defaultView,h=function($){i.hooks.pointerMove.call($)},p=function($){i.hooks.pointerUp.call($)},m=function($){i.hooks.pointerDown.call($)},y=function($){i.hooks.pointerOver.call($)},x=function($){i.hooks.pointerOut.call($)},T=function($){i.hooks.pointerCancel.call($)},C=function($){i.hooks.pointerWheel.call($)},M=function($){i.hooks.click.call($)},I=function($){n.globalThis.document.addEventListener("pointermove",h,!0),$.addEventListener("pointerdown",m,!0),$.addEventListener("pointerleave",x,!0),$.addEventListener("pointerover",y,!0),n.globalThis.addEventListener("pointerup",p,!0),n.globalThis.addEventListener("pointercancel",T,!0)},D=function($){$.addEventListener("touchstart",m,!0),$.addEventListener("touchend",p,!0),$.addEventListener("touchmove",h,!0),$.addEventListener("touchcancel",T,!0)},U=function($){n.globalThis.document.addEventListener("mousemove",h,!0),$.addEventListener("mousedown",m,!0),$.addEventListener("mouseout",x,!0),$.addEventListener("mouseover",y,!0),n.globalThis.addEventListener("mouseup",p,!0)},Z=function($){n.globalThis.document.removeEventListener("pointermove",h,!0),$.removeEventListener("pointerdown",m,!0),$.removeEventListener("pointerleave",x,!0),$.removeEventListener("pointerover",y,!0),n.globalThis.removeEventListener("pointerup",p,!0)},G=function($){$.removeEventListener("touchstart",m,!0),$.removeEventListener("touchend",p,!0),$.removeEventListener("touchmove",h,!0),$.removeEventListener("touchcancel",T,!0)},W=function($){n.globalThis.document.removeEventListener("mousemove",h,!0),$.removeEventListener("mousedown",m,!0),$.removeEventListener("mouseout",x,!0),$.removeEventListener("mouseover",y,!0),n.globalThis.removeEventListener("mouseup",p,!0)};i.hooks.init.tap(t.tag,function(){var $=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?($.style.msContentZooming="none",$.style.msTouchAction="none"):u.supportsPointerEvents&&($.style.touchAction="none"),u.supportsPointerEvents?I($):U($),u.supportsTouchEvents&&D($),l.useNativeClickEvent&&$.addEventListener("click",M,!0),$.addEventListener("wheel",C,{passive:!0,capture:!0})}),i.hooks.destroy.tap(t.tag,function(){var $=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?($.style.msContentZooming="",$.style.msTouchAction=""):u.supportsPointerEvents&&($.style.touchAction=""),u.supportsPointerEvents?Z($):W($),u.supportsTouchEvents&&G($),l.useNativeClickEvent&&$.removeEventListener("click",M,!0),$.removeEventListener("wheel",C,!0)})},t.tag="DOMInteraction",t}(),Hw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="dom-interaction",n}return e.prototype.init=function(){this.addRenderingPlugin(new Y2)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xc),bx="g-canvas-camera",JM=function(){function t(){this.displayObjectHTMLElementMap=new WeakMap}return t.prototype.joinTransformMatrix=function(e){return"matrix(".concat([e[0],e[1],e[4],e[5],e[12],e[13]].join(","),")")},t.prototype.apply=function(e,n){var r=this,i=e.camera,s=e.renderingContext,l=e.renderingService;this.context=e;var u=s.root.ownerDocument.defaultView,h=u.context.eventService.nativeHTMLMap,p=function(M,I){I.style.transform=r.joinTransformMatrix(M.getWorldTransform())},m=function(M){var I=M.target;if(I.nodeName===Gr.HTML){r.$camera||(r.$camera=r.createCamera(i));var D=r.getOrCreateEl(I);if(r.$camera.appendChild(D),n.enableCSSParsing){var U=I.ownerDocument.documentElement.attributes;Object.keys(U).forEach(function(Z){D.style[Z]=U[Z]})}Object.keys(I.attributes).forEach(function(Z){r.updateAttribute(Z,I)}),p(I,D),h.set(D,I)}},y=function(M){var I=M.target;if(I.nodeName===Gr.HTML&&r.$camera){var D=r.getOrCreateEl(I);D&&(D.remove(),h.delete(D))}},x=function(M){var I=M.target;if(I.nodeName===Gr.HTML){var D=M.attrName;r.updateAttribute(D,I)}},T=function(M){var I=M.target;if(I.nodeName===Gr.HTML){var D=r.getOrCreateEl(I);p(I,D)}},C=function(){if(r.$camera){var M=r.context.config,I=M.width,D=M.height;r.$camera.style.width="".concat(I||0,"px"),r.$camera.style.height="".concat(D||0,"px")}};l.hooks.init.tap(t.tag,function(){u.addEventListener(Vs.RESIZE,C),u.addEventListener(Sa.MOUNTED,m),u.addEventListener(Sa.UNMOUNTED,y),u.addEventListener(Sa.ATTR_MODIFIED,x),u.addEventListener(Sa.BOUNDS_CHANGED,T)}),l.hooks.endFrame.tap(t.tag,function(){r.$camera&&s.renderReasons.has(Ch.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),l.hooks.destroy.tap(t.tag,function(){r.$camera&&r.$camera.remove(),u.removeEventListener(Vs.RESIZE,C),u.removeEventListener(Sa.MOUNTED,m),u.removeEventListener(Sa.UNMOUNTED,y),u.removeEventListener(Sa.ATTR_MODIFIED,x),u.removeEventListener(Sa.BOUNDS_CHANGED,T)})},t.prototype.createCamera=function(e){var n=this.context.config,r=n.document,i=n.width,s=n.height,l=this.context.contextService.getDomElement(),u=l.parentNode;if(u){var h=bx,p=u.querySelector("#"+h);if(!p){var m=(r||document).createElement("div");m.style.overflow="hidden",m.style.pointerEvents="none",m.style.position="absolute",m.style.left="0px",m.style.top="0px",m.style.width="".concat(i||0,"px"),m.style.height="".concat(s||0,"px");var y=(r||document).createElement("div");p=y,y.id=h,y.style.position="absolute",y.style.left="".concat(l.offsetLeft||0,"px"),y.style.top="".concat(l.offsetTop||0,"px"),y.style.transformOrigin="left top",y.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),y.style.pointerEvents="none",y.style.width="100%",y.style.height="100%",m.appendChild(y),u.appendChild(m)}return p}return null},t.prototype.getOrCreateEl=function(e){var n=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(n||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform())),r},t.prototype.updateAttribute=function(e,n){var r=this.getOrCreateEl(n);switch(e){case"innerHTML":var i=n.parsedStyle.innerHTML;Si(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(n.parsedStyle.x,"px");break;case"y":r.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(s[0].value," ").concat(s[1].value);break;case"width":if(this.context.enableCSSParsing){var l=n.computedStyleMap().get("width");r.style.width=l.toString()}else{var l=n.parsedStyle.width;r.style.width=(0,ge.Z)(l)?"".concat(l,"px"):l.toString()}break;case"height":if(this.context.enableCSSParsing){var u=n.computedStyleMap().get("height");r.style.height=u.toString()}else{var u=n.parsedStyle.height;r.style.height=(0,ge.Z)(u)?"".concat(u,"px"):u.toString()}break;case"zIndex":var h=n.parsedStyle.zIndex;r.style["z-index"]="".concat(h);break;case"visibility":var p=n.parsedStyle.visibility;r.style.visibility=p;break;case"pointerEvents":var m=n.parsedStyle.pointerEvents,y=m===void 0?"auto":m;r.style.pointerEvents=y;break;case"opacity":var x=n.parsedStyle.opacity;r.style.opacity="".concat(x);break;case"fill":var T=n.parsedStyle.fill,C="";e0(T)?T.isNone?C="transparent":C=n.getAttribute("fill"):Array.isArray(T)?C=n.getAttribute("fill"):Gd(T),r.style.background=C;break;case"stroke":var M=n.parsedStyle.stroke,I="";e0(M)?M.isNone?I="transparent":I=n.getAttribute("stroke"):Array.isArray(M)?I=n.getAttribute("stroke"):Gd(M),r.style["border-color"]=I,r.style["border-style"]="solid";break;case"lineWidth":var D=n.parsedStyle.lineWidth;r.style["border-width"]="".concat(D||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var U=n.style.filter;r.style.filter=U;break;default:!(0,tr.Z)(n.style[e])&&n.style[e]!==""&&(r.style[e]=n.style[e])}},t.tag="HTMLRendering",t}(),Gw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="html-renderer",n}return e.prototype.init=function(){this.addRenderingPlugin(new JM)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xc),Ww=function(){function t(e){this.canvasConfig=e,this.imageCache={},this.gradientCache={},this.patternCache={}}return t.prototype.getImageSync=function(e,n){return this.imageCache[e]?n&&n(this.imageCache[e]):this.getOrCreateImage(e).then(function(r){n&&n(r)}),this.imageCache[e]},t.prototype.getOrCreateImage=function(e){var n=this;if(this.imageCache[e])return Promise.resolve(this.imageCache[e]);var r=this.canvasConfig.createImage;return new Promise(function(i,s){var l;r?l=r(e):hl&&(l=new window.Image),l&&(l.onload=function(){n.imageCache[e]=l,i(l)},l.onerror=function(u){s(u)},l.crossOrigin="Anonymous",l.src=e)})},t.prototype.getOrCreatePatternSync=function(e,n,r,i,s,l){var u=this.generatePatternKey(e);if(u&&this.patternCache[u])return this.patternCache[u];var h=e.image,p=e.repetition,m=e.transform,y,x=!1;Si(h)?y=this.getImageSync(h,l):r?(y=r,x=!0):y=h;var T=y&&n.createPattern(y,p);if(T){var C=void 0;m?C=yo(av(m),new xr({})):C=ae.identity(ae.create()),x&&ae.scale(C,C,[1/i,1/i,1]),T.setTransform({a:C[0],b:C[1],c:C[4],d:C[5],e:C[12]+s[0],f:C[13]+s[1]})}return u&&T&&(this.patternCache[u]=T),T},t.prototype.getOrCreateGradient=function(e,n){var r=this.generateGradientKey(e),i=e.type,s=e.steps,l=e.min,u=e.width,h=e.height,p=e.angle,m=e.cx,y=e.cy,x=e.size;if(this.gradientCache[r])return this.gradientCache[r];var T=null;if(i===vl.LinearGradient){var C=lm(l,u,h,p),M=C.x1,I=C.y1,D=C.x2,U=C.y2;T=n.createLinearGradient(M,I,D,U)}else if(i===vl.RadialGradient){var Z=Sp(l,u,h,m,y,x),G=Z.x,W=Z.y,$=Z.r;T=n.createRadialGradient(G,W,0,G,W,$)}return T&&(s.forEach(function(J){var nt=J.offset,dt=J.color;nt.unit===Tn.kPercentage&&(T==null||T.addColorStop(nt.value/100,dt.toString()))}),this.gradientCache[r]=T),this.gradientCache[r]},t.prototype.generateGradientKey=function(e){var n=e.type,r=e.min,i=e.width,s=e.height,l=e.steps,u=e.angle,h=e.cx,p=e.cy,m=e.size;return"gradient-".concat(n,"-").concat((u==null?void 0:u.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat((p==null?void 0:p.toString())||0,"-").concat((m==null?void 0:m.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(s,"-").concat(l.map(function(y){var x=y.offset,T=y.color;return"".concat(x).concat(T)}).join("-"))},t.prototype.generatePatternKey=function(e){var n=e.image,r=e.repetition;if(Si(n))return"pattern-".concat(n,"-").concat(r);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(r)},t}(),q2=function(){function t(){}return t.prototype.apply=function(e){var n=e.renderingService,r=e.renderingContext,i=e.imagePool,s=r.root.ownerDocument.defaultView,l=function(p,m,y){var x=p.parsedStyle,T=x.width,C=x.height;T&&!C?p.setAttribute("height",y/m*T):!T&&C&&p.setAttribute("width",m/y*C)},u=function(p){var m=p.target,y=m.nodeName,x=m.attributes;if(y===Gr.IMAGE){var T=x.src,C=x.keepAspectRatio;Si(T)&&i.getImageSync(T,function(M){var I=M.width,D=M.height;C&&l(m,I,D),m.renderable.dirty=!0,n.dirtify()})}},h=function(p){var m=p.target,y=p.attrName,x=p.newValue;m.nodeName===Gr.IMAGE&&y==="src"&&Si(x)&&i.getOrCreateImage(x).then(function(T){var C=T.width,M=T.height;m.attributes.keepAspectRatio&&l(m,C,M),m.renderable.dirty=!0,n.dirtify()})};n.hooks.init.tap(t.tag,function(){s.addEventListener(Sa.MOUNTED,u),s.addEventListener(Sa.ATTR_MODIFIED,h)}),n.hooks.destroy.tap(t.tag,function(){s.removeEventListener(Sa.MOUNTED,u),s.removeEventListener(Sa.ATTR_MODIFIED,h)})},t.tag="LoadImage",t}(),Xw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="image-loader",n}return e.prototype.init=function(){this.context.imagePool=new Ww(this.context.config),this.addRenderingPlugin(new q2)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Xc),Yw=function(){function t(e){this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return t.prototype.init=function(){var e=this.canvasConfig,n=e.container,r=e.canvas;if(r)this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=Si(n)?document.getElementById(n):n,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(e,n){var r=this.canvasConfig.devicePixelRatio,i=r||hl&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*n,tc(this.$canvas,e,n)),this.renderingContext.renderReasons.add(Ch.CAMERA_CHANGED)},t.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},t.prototype.toDataURL=function(e){return e===void 0&&(e={}),(0,F.mG)(this,void 0,void 0,function(){var n,r;return(0,F.Jh)(this,function(i){return n=e.type,r=e.encoderOptions,[2,this.context.canvas.toDataURL(n,r)]})})},t}(),qw=function(t){(0,F.ZT)(e,t);function e(){var n=t.apply(this,(0,F.ev)([],(0,F.CR)(arguments),!1))||this;return n.name="canvas-context-register",n}return e.prototype.init=function(){this.context.ContextService=Yw},e.prototype.destroy=function(){delete this.context.ContextService},e}(Xc),$2=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n)||this;return r.registerPlugin(new qw),r.registerPlugin(new Xw),r.registerPlugin(new Iw),r.registerPlugin(new QM),r.registerPlugin(new Hw),r.registerPlugin(new jw),r.registerPlugin(new Gw),r}return e}(jd),$w=function(){function t(e){this.dragndropPluginOptions=e}return t.prototype.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext,s=i.root.ownerDocument,l=s.defaultView,u=function(h){var p=h.target,m=p===s,y=m&&n.dragndropPluginOptions.isDocumentDraggable?s:p.closest&&p.closest("[draggable=true]");if(y){var x=!1,T=h.timeStamp,C=[h.clientX,h.clientY],M=null,I=[h.clientX,h.clientY],D=function(Z){return(0,F.mG)(n,void 0,void 0,function(){var G,W,$,J,nt,dt;return(0,F.Jh)(this,function(Et){switch(Et.label){case 0:if(!x){if(G=Z.timeStamp-T,W=An([Z.clientX,Z.clientY],C),G<=this.dragndropPluginOptions.dragstartTimeThreshold||W<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];Z.type="dragstart",y.dispatchEvent(Z),x=!0}return Z.type="drag",Z.dx=Z.clientX-I[0],Z.dy=Z.clientY-I[1],y.dispatchEvent(Z),I=[Z.clientX,Z.clientY],m?[3,2]:($=this.dragndropPluginOptions.overlap==="pointer"?[Z.canvasX,Z.canvasY]:p.getBounds().center,[4,s.elementsFromPoint($[0],$[1])]);case 1:J=Et.sent(),nt=J[J.indexOf(p)+1],dt=(nt==null?void 0:nt.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?s:null),M!==dt&&(M&&(Z.type="dragleave",Z.target=M,M.dispatchEvent(Z)),dt&&(Z.type="dragenter",Z.target=dt,dt.dispatchEvent(Z)),M=dt,M&&(Z.type="dragover",Z.target=M,M.dispatchEvent(Z))),Et.label=2;case 2:return[2]}})})};l.addEventListener("pointermove",D);var U=function(Z){if(x){Z.detail={preventClick:!0};var G=Z.clone();M&&(G.type="drop",G.target=M,M.dispatchEvent(G)),G.type="dragend",y.dispatchEvent(G),x=!1}l.removeEventListener("pointermove",D)};p.addEventListener("pointerup",U,{once:!0}),p.addEventListener("pointerupoutside",U,{once:!0})}};r.hooks.init.tap(t.tag,function(){l.addEventListener("pointerdown",u)}),r.hooks.destroy.tap(t.tag,function(){l.removeEventListener("pointerdown",u)})},t.tag="Dragndrop",t}(),K2=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=t.call(this)||this;return r.options=n,r.name="dragndrop",r}return e.prototype.init=function(){this.addRenderingPlugin(new $w((0,F.pi)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)},e}(Xc);function tP(t,e,n){var r;return function(){var i=this,s=arguments,l=function(){r=null,n||t.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(l,e),u&&t.apply(i,s)}}var Q2=tP,Ex=function(t){return typeof t=="object"&&t!==null},Sx=Ex,Kw=function(t){if(!Sx(t)||!(0,Ei.Z)(t,"Object"))return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},y0=Kw,Qw=5;function Jw(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(t==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function Tx(t,e,n,r){n=n||0,r=r||Qw;for(var i in e)if(Jw(e,i)){var s=e[i];s!==null&&y0(s)?(y0(t[i])||(t[i]={}),n<r?Tx(t[i],s,n+1,r):t[i]=e[i]):Ps(s)?(t[i]=[],t[i]=t[i].concat(s)):s!==void 0&&(t[i]=s)}}var tA=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Tx(t,e[r]);return t},ti=tA;class J2 extends Map{constructor(e,n=Z_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Ax(this,e))}has(e){return super.has(Ax(this,e))}set(e,n){return super.set(Ox(this,e),n)}delete(e){return super.delete(Cx(this,e))}}class eP extends null{constructor(e,n=Z_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const r of e)this.add(r)}has(e){return super.has(Ax(this,e))}add(e){return super.add(Ox(this,e))}delete(e){return super.delete(Cx(this,e))}}function Ax({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ox({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Cx({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Z_(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Im(t){return t}function vc(t,...e){return bv(t,Im,Im,e)}function H_(t,...e){return bv(t,Array.from,Im,e)}function tE(t,e){for(let n=1,r=e.length;n<r;++n)t=t.flatMap(i=>i.pop().map(([s,l])=>[...i,s,l]));return t}function eA(t,...e){return tE(H_(t,...e),e)}function nA(t,e,...n){return tE(W_(t,e,...n),n)}function G_(t,e,...n){return bv(t,Im,e,n)}function W_(t,e,...n){return bv(t,Array.from,e,n)}function nP(t,...e){return bv(t,identity,eE,e)}function rP(t,...e){return bv(t,Array.from,eE,e)}function eE(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function bv(t,e,n,r){return function i(s,l){if(l>=r.length)return n(s);const u=new J2,h=r[l++];let p=-1;for(const m of s){const y=h(m,++p,s),x=u.get(y);x?x.push(m):u.set(y,[m])}for(const[m,y]of u)u.set(m,i(y,l));return e(u)}(t,0)}var Rx=function(t){return(0,tr.Z)(t)?"":t.toString()},Ay=function(t){var e=Rx(t);return e.charAt(0).toLowerCase()+e.substring(1)},Mx=Ay,nE=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};function Ev(t){return t}function Oy(t){return t.reduce((e,n)=>(r,...i)=>n(e(r,...i),...i),Ev)}function rA(t){return t.reduce((e,n)=>r=>nE(this,void 0,void 0,function*(){const i=yield e(r);return n(i)}),Ev)}function Px(t){return t.replace(/( |^)[a-z]/g,e=>e.toUpperCase())}function mg(t=""){throw new Error(t)}function Ix(t,e){const{attributes:n}=e,r=new Set(["id","className"]);for(const[i,s]of Object.entries(n))r.has(i)||t.attr(i,s)}function Ql(t){return t!=null&&!Number.isNaN(t)}function iP(t,e){return t+(e-t)*Math.random()}function iA(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const r=t(n);return e.set(n,r),r}}function oA(t,e){const{transform:n}=t.style,i=(s=>s==="none"||s===void 0)(n)?"":n;t.style.transform=`${i} ${e}`.trimStart()}function ho(t,e){return rE(t,e)||{}}function rE(t,e){const n=Object.entries(t||{}).filter(([r])=>r.startsWith(e)).map(([r,i])=>[Mx(r.replace(e,"").trim()),i]).filter(([r])=>!!r);return n.length===0?null:Object.fromEntries(n)}function oP(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[`${e}${upperFirst(n)}`,r]))}function aA(t,e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.find(r=>n.startsWith(r))))}function Lx(t,...e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.every(r=>!n.startsWith(r))))}function iE(t,e){if(t===void 0)return null;if(typeof t=="number")return t;const n=+t.replace("%","");return Number.isNaN(n)?null:n/100*e}function vg(t){return typeof t=="object"&&!(t instanceof Date)&&t!==null&&!Array.isArray(t)}function X0(t){return t===null||t===!1}function oE(t,e,n=5,r=0){if(!(r>=n)){for(const i of Object.keys(e)){const s=e[i];!y0(s)||!y0(t[i])?t[i]=s:oE(t[i],s,n,r+1)}return t}}function Ra(t){return new Su([t],null,t,t.ownerDocument)}class Su{constructor(e=null,n=null,r=null,i=null,s=[null,null,null,null,null],l=[],u=[]){this._elements=Array.from(e),this._data=n,this._parent=r,this._document=i,this._enter=s[0],this._update=s[1],this._exit=s[2],this._merge=s[3],this._split=s[4],this._transitions=l,this._facetElements=u}selectAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new Su(n,null,this._elements[0],this._document)}selectFacetAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new Su(this._elements,null,this._parent,this._document,void 0,void 0,n)}select(e){const n=typeof e=="string"?this._parent.querySelectorAll(e)[0]||null:e;return new Su([n],null,n,this._document)}append(e){const n=typeof e=="function"?e:()=>this.createElement(e),r=[];if(this._data!==null){for(let i=0;i<this._data.length;i++){const s=this._data[i],[l,u]=Array.isArray(s)?s:[s,null],h=n(l,i);h.__data__=l,u!==null&&(h.__fromElements__=u),this._parent.appendChild(h),r.push(h)}return new Su(r,null,this._parent,this._document)}else{for(let i=0;i<this._elements.length;i++){const s=this._elements[i],l=s.__data__,u=n(l,i);s.appendChild(u),r.push(u)}return new Su(r,null,r[0],this._document)}}maybeAppend(e,n,r){const i=this._elements[0],s=i.getElementById(e);if(s)return new Su([s],null,this._parent,this._document);const l=typeof n=="string"?this.createElement(n):n();return l.id=e,r&&(l.className=r),i.appendChild(l),new Su([l],null,this._parent,this._document)}data(e,n=i=>i,r=()=>null){const i=[],s=[],l=new Set(this._elements),u=[],h=new Set,p=new Map(this._elements.map((T,C)=>[n(T.__data__,C),T])),m=new Map(this._facetElements.map((T,C)=>[n(T.__data__,C),T])),y=vc(this._elements,T=>r(T.__data__));for(let T=0;T<e.length;T++){const C=e[T],M=n(C,T),I=r(C,T);if(p.has(M)){const D=p.get(M);D.__data__=C,D.__facet__=!1,s.push(D),l.delete(D),p.delete(M)}else if(m.has(M)){const D=m.get(M);D.__data__=C,D.__facet__=!0,s.push(D),m.delete(M)}else if(y.has(M)){const D=y.get(M);u.push([C,D]);for(const U of D)l.delete(U);y.delete(M)}else if(p.has(I)){const D=p.get(I);D.__toData__?D.__toData__.push(C):D.__toData__=[C],h.add(D),l.delete(D)}else i.push(C)}const x=[new Su([],i,this._parent,this._document),new Su(s,null,this._parent,this._document),new Su(l,null,this._parent,this._document),new Su([],u,this._parent,this._document),new Su(h,null,this._parent,this._document)];return new Su(this._elements,null,this._parent,this._document,x)}merge(e){const n=[...this._elements,...e._elements],r=[...this._transitions,...e._transitions];return new Su(n,null,this._parent,this._document,void 0,r)}createElement(e){if(this._document)return this._document.createElement(e,{});const n=Su.registry[e];return n?new n:mg(`Unknown node type: ${e}`)}join(e=l=>l,n=l=>l,r=l=>l.remove(),i=l=>l,s=l=>l.remove()){const l=e(this._enter),u=n(this._update),h=r(this._exit),p=i(this._merge),m=s(this._split);return u.merge(l).merge(h).merge(p).merge(m)}remove(){for(let e=0;e<this._elements.length;e++){const n=this._transitions[e];if(n){const r=Array.isArray(n)?n:[n];Promise.all(r.map(i=>i.finished)).then(()=>{this._elements[e].remove()})}else this._elements[e].remove()}return new Su([],null,this._parent,this._document,void 0,this._transitions)}each(e){for(let n=0;n<this._elements.length;n++){const r=this._elements[n],i=r.__data__;e(i,n,r)}return this}attr(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l[e]=r(i,s,l))})}style(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l.style[e]=r(i,s,l))})}transition(e){const n=typeof e!="function"?()=>e:e,{_transitions:r}=this;return this.each(function(i,s,l){r[s]=n(i,s,l)})}on(e,n){return this.each(function(r,i,s){s.addEventListener(e,n)}),this}call(e,...n){return e(this,...n),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}Su.registry={g:Ai,rect:vo,circle:Ir,path:Zi,text:pa,ellipse:Ci,image:ao,line:Ro,polygon:Ta,polyline:Qo,html:To};const bl={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"};var sA=function(t){var e=Rx(t);return e.charAt(0).toUpperCase()+e.substring(1)},Sv=sA;function lA(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function gg(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function cA(t){return t=gg(Math.abs(t)),t?t[1]:NaN}function uA(t,e){return function(n,r){for(var i=n.length,s=[],l=0,u=t[0],h=0;i>0&&u>0&&(h+u+1>r&&(u=Math.max(1,r-h)),s.push(n.substring(i-=u,i+u)),!((h+=u+1)>r));)u=t[l=(l+1)%t.length];return s.reverse().join(e)}}function fA(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var hA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Dx(t){if(!(e=hA.exec(t)))throw new Error("invalid format: "+t);var e;return new Tv({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Dx.prototype=Tv.prototype;function Tv(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Tv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Cy(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var aE;function dA(t,e){var n=gg(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(aE=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+gg(t,Math.max(0,e+s-1))[0]}function sE(t,e){var n=gg(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Nx={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:lA,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>sE(t*100,e),r:sE,s:dA,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function lE(t){return t}var cE=Array.prototype.map,uE=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function pA(t){var e=t.grouping===void 0||t.thousands===void 0?lE:uA(cE.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?lE:fA(cE.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"\u2212":t.minus+"",h=t.nan===void 0?"NaN":t.nan+"";function p(y){y=Dx(y);var x=y.fill,T=y.align,C=y.sign,M=y.symbol,I=y.zero,D=y.width,U=y.comma,Z=y.precision,G=y.trim,W=y.type;W==="n"?(U=!0,W="g"):Nx[W]||(Z===void 0&&(Z=12),G=!0,W="g"),(I||x==="0"&&T==="=")&&(I=!0,x="0",T="=");var $=M==="$"?n:M==="#"&&/[boxX]/.test(W)?"0"+W.toLowerCase():"",J=M==="$"?r:/[%p]/.test(W)?l:"",nt=Nx[W],dt=/[defgprs%]/.test(W);Z=Z===void 0?6:/[gprs]/.test(W)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z));function Et(Pt){var Ht=$,Ct=J,Ft,jt,qt;if(W==="c")Ct=nt(Pt)+Ct,Pt="";else{Pt=+Pt;var Ee=Pt<0||1/Pt<0;if(Pt=isNaN(Pt)?h:nt(Math.abs(Pt),Z),G&&(Pt=Cy(Pt)),Ee&&+Pt==0&&C!=="+"&&(Ee=!1),Ht=(Ee?C==="("?C:u:C==="-"||C==="("?"":C)+Ht,Ct=(W==="s"?uE[8+aE/3]:"")+Ct+(Ee&&C==="("?")":""),dt){for(Ft=-1,jt=Pt.length;++Ft<jt;)if(qt=Pt.charCodeAt(Ft),48>qt||qt>57){Ct=(qt===46?i+Pt.slice(Ft+1):Pt.slice(Ft))+Ct,Pt=Pt.slice(0,Ft);break}}}U&&!I&&(Pt=e(Pt,1/0));var oe=Ht.length+Pt.length+Ct.length,_e=oe<D?new Array(D-oe+1).join(x):"";switch(U&&I&&(Pt=e(_e+Pt,_e.length?D-Ct.length:1/0),_e=""),T){case"<":Pt=Ht+Pt+Ct+_e;break;case"=":Pt=Ht+_e+Pt+Ct;break;case"^":Pt=_e.slice(0,oe=_e.length>>1)+Ht+Pt+Ct+_e.slice(oe);break;default:Pt=_e+Ht+Pt+Ct;break}return s(Pt)}return Et.toString=function(){return y+""},Et}function m(y,x){var T=p((y=Dx(y),y.type="f",y)),C=Math.max(-8,Math.min(8,Math.floor(cA(x)/3)))*3,M=Math.pow(10,-C),I=uE[8+C/3];return function(D){return T(M*D)+I}}return{format:p,formatPrefix:m}}var X_,Lm,mA;vA({thousands:",",grouping:[3],currency:["$",""]});function vA(t){return X_=pA(t),Lm=X_.format,mA=X_.formatPrefix,X_}function _0(t,e){return Object.entries(t).reduce((n,[r,i])=>(n[r]=e(i,r,t),n),{})}function wv(t){return t.map((e,n)=>n)}function aP(t){const e=t.length,n=t[0].length,r=new Array(n).fill(0).map(()=>new Array(e));for(let i=0;i<n;i++)for(let s=0;s<e;s++)r[i][s]=t[s][i];return r}function gA(t){return t[0]}function fE(t){return t[t.length-1]}function sP(t){return!t.some(Array.isArray)}function lP(t){return Array.from(new Set(t))}function hE(t,e){const n=[[],[]];return t.forEach(r=>{n[e(r)?0:1].push(r)}),n}function Y_(t,e=t.length){if(e===1)return t.map(r=>[r]);const n=[];for(let r=0;r<t.length;r++){const i=t.slice(r+1);Y_(i,e-1).forEach(l=>{n.push([t[r],...l])})}return n}function yA(t){if(t.length===1)return[t];const e=[];for(let n=1;n<=t.length;n++)e.push(...Y_(t,n));return e}var _A=function(t){return t!==null&&typeof t!="function"&&isFinite(t.length)},ap=_A,kx=function(t,e){if(t===e)return!0;if(!t||!e||Si(t)||Si(e))return!1;if(ap(t)||ap(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=kx(t[r],e[r]),!!n);r++);return n}if(Sx(t)||Sx(e)){var i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(var n=!0,r=0;r<i.length&&(n=kx(t[i[r]],e[i[r]]),!!n);r++);return n}return!1},dE=kx;function sp(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function El(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function T8(t){return t*Math.PI/180}function cP(t){return t*180/Math.PI}function xA(t,e){return t=t%(2*Math.PI),e=e%(2*Math.PI),t<0&&(t=2*Math.PI+t),e<0&&(e=2*Math.PI+e),t>=e&&(e=e+2*Math.PI),{startAngle:t,endAngle:e}}const pE=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},n=Object.assign(Object.assign({},e),t);return Object.assign(Object.assign({},n),xA(n.startAngle,n.endAngle))},Ry=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:i}=pE(t);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",e,n,r,i]]};Ry.props={};const mE=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},Bx=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:i}=mE(t);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...Ry({startAngle:e,endAngle:n,innerRadius:r,outerRadius:i})]};Bx.props={};function Fx(t,e,n){return Math.max(e,Math.min(t,n))}function q_(t,e=10){return typeof t!="number"||Math.abs(t)<1e-15?t:parseFloat(t.toFixed(e))}const vE=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]];var gE=it(17816);function gc(t){const{transformations:e}=t.getOptions();return e.map(([r])=>r).filter(r=>r==="transpose").length%2!==0}function Ml(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="polar")}function My(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="reflect")&&e.some(([n])=>n.startsWith("transpose"))}function Ux(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="helix")}function Py(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="parallel")}function yE(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="fisheye")}function bA(t){return Py(t)&&Ml(t)}function yg(t){return Ux(t)||Ml(t)}function _E(t){return Ml(t)&&gc(t)}function uP(t){return Ml(t)||Py(t)||My(t)||_E(t)}function EA(t){if(yg(t)){const[e,n]=t.getSize(),r=t.getOptions().transformations.find(i=>i[0]==="polar");if(r)return Math.max(e,n)/2*r[4]}return 0}function $_(t){const{transformations:e}=t.getOptions(),[,,,n,r]=e.find(i=>i[0]==="polar");return[+n,+r]}function xE(t,e=!0){const{transformations:n}=t.getOptions(),[,r,i]=n.find(s=>s[0]==="polar");return e?[+r*180/Math.PI,+i*180/Math.PI]:[r,i]}function SA(t,e){const{transformations:n}=t.getOptions(),[,...r]=n.find(i=>i[0]===e);return r}function K_(t,e){e(t),t.children&&t.children.forEach(function(n){n&&K_(n,e)})}function Iy(t){Q_(t,!0)}function Dm(t){Q_(t,!1)}function Q_(t,e){var n=e?"visible":"hidden";K_(t,function(r){r.attr("visibility",n)})}function TA(t){return typeof t=="boolean"?!1:"enter"in t&&"update"in t&&"exit"in t}function bE(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter(function(r){var i=(0,F.CR)(r,1),s=i[0];return!e.includes(s)}));return Object.fromEntries(e.map(function(r){return TA(t)?t[r]===!1?[r,!1]:[r,(0,F.pi)((0,F.pi)({},t[r]),n)]:[r,n]}))}function _g(t,e){t?t.finished.then(e):e()}function J_(t,e){t.length===0?e():Promise.all(t.map(function(n){return n==null?void 0:n.finished})).then(e)}function EE(t,e){"update"in t?t.update(e):t.attr(e)}function SE(t,e,n){if(e.length===0)return null;if(!n){var r=e.slice(-1)[0];return EE(t,{style:r}),null}return t.animate(e,n)}function wA(t,e){return!(t.nodeName!=="text"||e.nodeName!=="text"||t.attributes.text!==e.attributes.text)}function AA(t,e,n,r){if(r===void 0&&(r="destroy"),wA(t,e))return t.remove(),[null];var i=function(){r==="destroy"?t.destroy():r==="hide"&&Dm(t),e.isVisible()&&Iy(e)};if(!n)return i(),[null];var s=n.duration,l=s===void 0?0:s,u=n.delay,h=u===void 0?0:u,p=Math.ceil(+l/2),m=+l/4,y=(0,F.CR)(t.getGeometryBounds().center,2),x=y[0],T=y[1],C=(0,F.CR)(e.getGeometryBounds().center,2),M=C[0],I=C[1],D=(0,F.CR)([(x+M)/2-x,(T+I)/2-T],2),U=D[0],Z=D[1],G=t.style.opacity,W=G===void 0?1:G,$=e.style.opacity,J=$===void 0?1:$,nt=t.style.transform||"",dt=e.style.transform||"",Et=t.animate([{opacity:W,transform:"translate(0, 0) ".concat(nt)},{opacity:0,transform:"translate(".concat(U,", ").concat(Z,") ").concat(nt)}],(0,F.pi)((0,F.pi)({fill:"both"},n),{duration:h+p+m})),Pt=e.animate([{opacity:0,transform:"translate(".concat(-U,", ").concat(-Z,") ").concat(dt),offset:.01},{opacity:J,transform:"translate(0, 0) ".concat(dt)}],(0,F.pi)((0,F.pi)({fill:"both"},n),{duration:p+m,delay:h+p-m}));return _g(Pt,i),[Et,Pt]}function x0(t,e,n){var r={},i={};return Object.entries(e).forEach(function(s){var l=(0,F.CR)(s,2),u=l[0],h=l[1];if(!(0,tr.Z)(h)){var p=t.style[u]||t.parsedStyle[u]||0;p!==h&&(r[u]=p,i[u]=h)}}),n?SE(t,[r,i],(0,F.pi)({fill:"both"},n)):(EE(t,i),null)}var fP=5,TE=function(t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=fP),Object.entries(e).forEach(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1],h=t;Object.prototype.hasOwnProperty.call(e,l)&&(u?y0(u)?(y0(t[l])||(h[l]={}),n<r?TE(t[l],u,n+1,r):h[l]=e[l]):Ps(u)?(h[l]=[],h[l]=h[l].concat(u)):h[l]=u:h[l]=u)})},Y0=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)TE(t,e[r]);return t},hP=function(t){(0,F.ZT)(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.apply(this,(0,F.ev)([],(0,F.CR)(n),!1))||this;return i.isMutationObserved=!0,i.addEventListener(Sa.INSERTED,function(){Dm(i)}),i}return e}(Ai);function wE(t){var e=t.appendChild(new hP({class:"offscreen"}));return Dm(e),e}function OA(t){for(var e=t;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}function CA(){Q_(this,this.attributes.visibility!=="hidden")}var Af=function(t){(0,F.ZT)(e,t);function e(n,r){r===void 0&&(r={});var i=t.call(this,Y0({},{style:r},n))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wE(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e.prototype.attributeChangedCallback=function(n){n==="visibility"&&CA.call(this)},e.prototype.update=function(n,r){var i;return this.attr(Y0({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(n,r){},e.prototype.getSubShapeStyle=function(n){var r=n.x,i=n.y,s=n.transform,l=n.transformOrigin,u=n.class,h=n.className,p=n.zIndex,m=(0,F._T)(n,["x","y","transform","transformOrigin","class","className","zIndex"]);return m},e}(Wr);function sd(t,e,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(s){s.node().removeChildren()}),t?n(e):(r&&i(e),null)}function AE(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],i=0;i<t.length;i+=n)r.push(t[i]);return r}var Ly=function(t){(0,F.ZT)(e,t);function e(n){n===void 0&&(n={});var r=n.style,i=(0,F._T)(n,["style"]);return t.call(this,(0,F.pi)({style:(0,F.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wE(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e}(pa);function RA(t,e){var n=new Map;return t.forEach(function(r){var i=e(r);n.has(i)||n.set(i,[]),n.get(i).push(r)}),n}function MA(t){throw new Error(t)}var OE=function(){function t(i,s,l,u,h,p,m){i===void 0&&(i=null),s===void 0&&(s=null),l===void 0&&(l=null),u===void 0&&(u=null),h===void 0&&(h=[null,null,null,null,null]),p===void 0&&(p=[]),m===void 0&&(m=[]),e.add(this),this._elements=Array.from(i),this._data=s,this._parent=l,this._document=u,this._enter=h[0],this._update=h[1],this._exit=h[2],this._merge=h[3],this._split=h[4],this._transitions=p,this._facetElements=m}t.prototype.selectAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(s,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(this._elements,null,this._parent,this._document,void 0,void 0,s)},t.prototype.select=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new n([s],null,s,this._document)},t.prototype.append=function(i){var s=this,l=typeof i=="function"?i:function(){return s.createElement(i)},u=[];if(this._data!==null){for(var h=0;h<this._data.length;h++){var p=this._data[h],m=(0,F.CR)(Array.isArray(p)?p:[p,null],2),y=m[0],x=m[1],T=l(y,h);T.__data__=y,x!==null&&(T.__fromElements__=x),this._parent.appendChild(T),u.push(T)}return new n(u,null,this._parent,this._document)}for(var h=0;h<this._elements.length;h++){var C=this._elements[h],y=C.__data__,T=l(y,h);C.appendChild(T),u.push(T)}return new n(u,null,u[0],this._document)},t.prototype.maybeAppend=function(i,s){var l=(0,F.Q_)(this,e,"m",r).call(this,i[0]==="#"?i:"#".concat(i),s);return l.attr("id",i),l},t.prototype.maybeAppendByClassName=function(i,s){var l=i.toString(),u=(0,F.Q_)(this,e,"m",r).call(this,l[0]==="."?l:".".concat(l),s);return u.attr("className",l),u},t.prototype.maybeAppendByName=function(i,s){var l=(0,F.Q_)(this,e,"m",r).call(this,'[name="'.concat(i,'"]'),s);return l.attr("name",i),l},t.prototype.data=function(i,s,l){var u,h;s===void 0&&(s=function(Et){return Et}),l===void 0&&(l=function(){return null});for(var p=[],m=[],y=new Set(this._elements),x=[],T=new Set,C=new Map(this._elements.map(function(Et,Pt){return[s(Et.__data__,Pt),Et]})),M=new Map(this._facetElements.map(function(Et,Pt){return[s(Et.__data__,Pt),Et]})),I=RA(this._elements,function(Et){return l(Et.__data__)}),D=0;D<i.length;D++){var U=i[D],Z=s(U,D),G=l(U,D);if(C.has(Z)){var W=C.get(Z);W.__data__=U,W.__facet__=!1,m.push(W),y.delete(W),C.delete(Z)}else if(M.has(Z)){var W=M.get(Z);W.__data__=U,W.__facet__=!0,m.push(W),M.delete(Z)}else if(I.has(Z)){var $=I.get(Z);x.push([U,$]);try{for(var J=(u=void 0,(0,F.XA)($)),nt=J.next();!nt.done;nt=J.next()){var W=nt.value;y.delete(W)}}catch(Et){u={error:Et}}finally{try{nt&&!nt.done&&(h=J.return)&&h.call(J)}finally{if(u)throw u.error}}I.delete(Z)}else if(C.has(G)){var W=C.get(G);W.__toData__?W.__toData__.push(U):W.__toData__=[U],T.add(W),y.delete(W)}else p.push(U)}var dt=[new n([],p,this._parent,this._document),new n(m,null,this._parent,this._document),new n(y,null,this._parent,this._document),new n([],x,this._parent,this._document),new n(T,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,dt)},t.prototype.merge=function(i){var s=(0,F.ev)((0,F.ev)([],(0,F.CR)(this._elements),!1),(0,F.CR)(i._elements),!1),l=(0,F.ev)((0,F.ev)([],(0,F.CR)(this._transitions),!1),(0,F.CR)(i._transitions),!1);return new n(s,null,this._parent,this._document,void 0,l)},t.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var s=n.registry[i];return s?new s:MA("Unknown node type: ".concat(i))},t.prototype.join=function(i,s,l,u,h){i===void 0&&(i=function(C){return C}),s===void 0&&(s=function(C){return C}),l===void 0&&(l=function(C){return C.remove()}),u===void 0&&(u=function(C){return C}),h===void 0&&(h=function(C){return C.remove()});var p=i(this._enter),m=s(this._update),y=l(this._exit),x=u(this._merge),T=h(this._split);return m.merge(p).merge(y).merge(x).merge(T)},t.prototype.remove=function(){for(var i=function(u){var h=s._elements[u],p=s._transitions[u];p?p.then(function(){return h.remove()}):h.remove()},s=this,l=0;l<this._elements.length;l++)i(l);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(i){for(var s=0;s<this._elements.length;s++){var l=this._elements[s],u=l.__data__;i.call(l,u,s)}return this},t.prototype.attr=function(i,s){var l=typeof s!="function"?function(){return s}:s;return this.each(function(u,h){s!==void 0&&(this[i]=l.call(this,u,h))})},t.prototype.style=function(i,s,l){l===void 0&&(l=!0);var u=typeof s!="function"||!l?function(){return s}:s;return this.each(function(h,p){s!==void 0&&(this.style[i]=u.call(this,h,p))})},t.prototype.styles=function(i,s){return i===void 0&&(i={}),s===void 0&&(s=!0),this.each(function(l,u){var h=this;Object.entries(i).forEach(function(p){var m=(0,F.CR)(p,2),y=m[0],x=m[1],T=typeof x!="function"||!s?function(){return x}:x;x!==void 0&&h.attr(y,T.call(h,l,u))})})},t.prototype.update=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},t.prototype.maybeUpdate=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},t.prototype.transition=function(i){var s=this._transitions;return this.each(function(l,u){s[u]=i.call(this,l,u)})},t.prototype.on=function(i,s){return this.each(function(){this.addEventListener(i,s)}),this},t.prototype.call=function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return i.call.apply(i,(0,F.ev)([this._parent,this],(0,F.CR)(s),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},t.prototype.parent=function(){return this._parent};var e,n,r;return n=t,e=new WeakSet,r=function(s,l){var u=this._elements[0],h=u.querySelector(s);if(h)return new n([h],null,this._parent,this._document);var p=typeof l=="string"?this.createElement(l):l();return u.appendChild(p),new n([p],null,this._parent,this._document)},t.registry={g:Ai,rect:vo,circle:Ir,path:Zi,text:Ly,ellipse:Ci,image:ao,line:Ro,polygon:Ta,polyline:Qo,html:To},t}();function Ga(t){return new OE([t],null,t,t.ownerDocument)}function PA(t,e,n){return t.querySelector(e)?Ga(t).select(e):Ga(t).append(n)}var lp=function(t,e){var n=function(i){return"".concat(e,"-").concat(i)},r=Object.fromEntries(Object.entries(t).map(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1],h=n(u);return[l,{name:h,class:".".concat(h),id:"#".concat(h),toString:function(){return h}}]}));return Object.assign(r,{prefix:n}),r},t1={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Zi({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},zx=ti({},t1,{style:{type:"arc"}}),dP=ti({},t1,{style:{}}),el=lp({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),Ih=function(t){return typeof t=="function"};function q0(t,e){return[t[0]*e,t[1]*e]}function Dy(t,e){return[t[0]+e[0],t[1]+e[1]]}function jx(t,e){return[t[0]-e[0],t[1]-e[1]]}function Of(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function cp(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function Ny(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function go(t){if(t[0]===0&&t[1]===0)return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function pP(t,e,n){var r=__read(t,2),i=r[0],s=r[1],l=__read(e,2),u=l[0],h=l[1],p=i-u,m=s-h,y=Math.sin(n),x=Math.cos(n);return[p*x-m*y+u,p*y+m*x+h]}function CE(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}function pn(t){return t*Math.PI/180}function Ls(t){return Number((t*180/Math.PI).toPrecision(5))}function Ha(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function ky(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}function ld(t,e){return"".concat(e).concat(Ha(t))}function os(t,e,n){var r;n===void 0&&(n=!0);var i=e||((r=t.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",s=t.replace(new RegExp("^(".concat(i,")")),"");return n?ky(s):s}function hf(t,e){Object.entries(e).forEach(function(n){var r=(0,F.CR)(n,2),i=r[0],s=r[1];(0,F.ev)([t],(0,F.CR)(t.querySelectorAll(i)),!1).filter(function(l){return l.matches(i)}).forEach(function(l){if(l){var u=l;u.style.cssText+=Object.entries(s).reduce(function(h,p){return"".concat(h).concat(p.join(":"),";")},"")}})})}var Cf=function(t,e){if(!(t!=null&&t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function ia(t,e,n){n===void 0&&(n=!1);var r={};return Object.entries(t).forEach(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1];if(!(l==="className"||l==="class")){if(Cf(l,"show")&&Cf(os(l,"show"),e)!==n)l===ld(e,"show")?r[l]=u:r[l.replace(new RegExp(Ha(e)),"")]=u;else if(!Cf(l,"show")&&Cf(l,e)!==n){var h=os(l,e);h==="filter"&&typeof u=="function"||(r[h]=u)}}}),r}function Zl(t,e){return Object.entries(t).reduce(function(n,r){var i=(0,F.CR)(r,2),s=i[0],l=i[1];return s.startsWith("show")?n["show".concat(e).concat(s.slice(4))]=l:n["".concat(e).concat(Ha(s))]=l,n},{})}function Pl(t,e){e===void 0&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(t).forEach(function(s){var l=(0,F.CR)(s,2),u=l[0],h=l[1];e.includes(u)||(n.indexOf(u)!==-1?i[u]=h:r[u]=h)}),[r,i]}function _s(t,e){return Ih(t)?t.apply(void 0,(0,F.ev)([],(0,F.CR)(e),!1)):t}function cd(t,e){return t.style.opacity||(t.style.opacity=1),x0(t,{opacity:0},e)}var Av=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function RE(t){return Av.includes(t)}function ts(t){var e={};for(var n in t)RE(n)&&(e[n]=t[n]);return e}var hu=lp({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function $u(t){return t.reduce(function(e,n,r){return e.push((0,F.ev)([r===0?"M":"L"],(0,F.CR)(n),!1)),e},[])}function Oc(t,e,n){var r=e.connect,i=r===void 0?"line":r,s=e.center;if(i==="line")return $u(t);if(!s)return[];var l=Ny(t[0],s),u=n?0:1;return t.reduce(function(h,p,m){return m===0?h.push((0,F.ev)(["M"],(0,F.CR)(p),!1)):h.push((0,F.ev)(["A",l,l,0,0,u],(0,F.CR)(p),!1)),h},[])}function ME(t,e,n){return e.type==="surround"?Oc(t,e,n):$u(t)}function Cc(t,e,n){var r=n.type,i=n.connect,s=n.center,l=n.closed,u=l?[["Z"]]:[],h=(0,F.CR)([ME(t,n),ME(e.slice().reverse(),n,!0)],2),p=h[0],m=h[1],y=(0,F.CR)([t[0],e.slice(-1)[0]],2),x=y[0],T=y[1],C=function(U,Z){return[p,U,m,Z,u].flat()};if(i==="line"||r==="surround")return C([(0,F.ev)(["L"],(0,F.CR)(T),!1)],[(0,F.ev)(["L"],(0,F.CR)(x),!1)]);if(!s)throw new Error("Arc grid need to specified center");var M=(0,F.CR)([Ny(T,s),Ny(x,s)],2),I=M[0],D=M[1];return C([(0,F.ev)(["A",I,I,0,0,1],(0,F.CR)(T),!1),(0,F.ev)(["L"],(0,F.CR)(T),!1)],[(0,F.ev)(["A",D,D,0,0,0],(0,F.CR)(x),!1),(0,F.ev)(["L"],(0,F.CR)(x),!1)])}function Vp(t,e,n,r){var i=n.animate,s=n.isBillboard,l=e.map(function(u,h){return{id:u.id||"grid-line-".concat(h),d:ME(u.points,n)}});return t.selectAll(hu.line.class).data(l,function(u){return u.id}).join(function(u){return u.append("path").each(function(h,p){var m=_s(ts((0,F.pi)({d:h.d},r)),[h,p,l]);this.attr((0,F.pi)({class:hu.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:s},m))})},function(u){return u.transition(function(h,p){var m=_s(ts((0,F.pi)({d:h.d},r)),[h,p,l]);return x0(this,m,i.update)})},function(u){return u.transition(function(){var h=this,p=cd(this,i.exit);return _g(p,function(){return h.remove()}),p})}).transitions()}function xg(t,e,n){var r=n.animate,i=n.connect,s=n.areaFill;if(e.length<2||!s||!i)return[];for(var l=Array.isArray(s)?s:[s,"transparent"],u=function(C){return l[C%l.length]},h=[],p=0;p<e.length-1;p++){var m=(0,F.CR)([e[p].points,e[p+1].points],2),y=m[0],x=m[1],T=Cc(y,x,n);h.push({d:T,fill:u(p)})}return t.selectAll(hu.region.class).data(h,function(C,M){return M}).join(function(C){return C.append("path").each(function(M,I){var D=_s(M,[M,I,h]);this.attr(D)}).attr("className",hu.region.name)},function(C){return C.transition(function(M,I){var D=_s(M,[M,I,h]);return x0(this,D,r.update)})},function(C){return C.transition(function(){var M=this,I=cd(this,r.exit);return _g(I,function(){return M.remove()}),I})}).transitions()}function e1(t){var e=t.data,n=e===void 0?[]:e,r=t.closed;return r?n.map(function(i){var s=i.points,l=(0,F.CR)(s,1),u=l[0];return(0,F.pi)((0,F.pi)({},i),{points:(0,F.ev)((0,F.ev)([],(0,F.CR)(s),!1),[u],!1)})}):n}var ii=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var i=n.type,s=n.center,l=n.areaFill,u=n.closed,h=(0,F._T)(n,["type","center","areaFill","closed"]),p=e1(n),m=Ga(r).maybeAppendByClassName(hu.lineGroup,"g"),y=Ga(r).maybeAppendByClassName(hu.regionGroup,"g"),x=Vp(m,p,n,h),T=xg(y,p,n);return(0,F.ev)((0,F.ev)([],(0,F.CR)(x),!1),(0,F.CR)(T),!1)},e}(Af),Ii=function(t,e,n){for(var r=0,i=Si(e)?e.split("."):e;t&&r<i.length;)t=t[i[r++]];return t===void 0||r<i.length?n:t},mP=function(t,e){return function(n){return t*(1-n)+e*n}};function po(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(i){var s=new Array(r),l=new Array(n),u=0;for(u=0;u<r;++u)s[u]=$n(t[u],e[u]);for(;u<n;++u)l[u]=e[u];for(u=0;u<r;++u)l[u]=s[u](i);return l}}function qo(t,e){t===void 0&&(t={}),e===void 0&&(e={});var n={},r={};return Object.entries(e).forEach(function(i){var s=(0,F.CR)(i,2),l=s[0],u=s[1];l in t?n[l]=$n(t[l],u):r[l]=u}),function(i){return Object.entries(n).forEach(function(s){var l=(0,F.CR)(s,2),u=l[0],h=l[1];return r[u]=h(i)}),r}}function $n(t,e){return typeof t=="number"&&typeof e=="number"?mP(t,e):Array.isArray(t)&&Array.isArray(e)?po(t,e):typeof t=="object"&&typeof e=="object"?qo(t,e):function(n){return t}}function n1(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var i=r.duration,s=i===void 0?0:i,l=$n(e,n),u=Math.ceil(+s/16),h=new Array(u).fill(0).map(function(p,m,y){return{__keyframe_data__:l(m/(y.length-1))}});return t.animate(h,(0,F.pi)({fill:"both"},r))}function fh(t){return typeof t=="function"?t():Si(t)||(0,ge.Z)(t)?new Ly({style:{text:String(t)}}):t}function Nm(t,e,n){n===void 0&&(n=!1);var r=t.getBBox(),i=r.width,s=r.height,l=e/Math.max(i,s);return n&&(t.style.transform="scale(".concat(l,")")),l}function Vx(t,e){var n={},r=Array.isArray(e)?e:[e];for(var i in t)r.includes(i)||(n[i]=t[i]);return n}function Zx(t,e){return Object.fromEntries(Object.entries(t).map(function(n){var r=(0,F.CR)(n,2),i=r[0],s=r[1];return[i,_s(s,e)]}))}function w8(t){if(t.type==="linear"){var e=t.startPos,n=t.endPos;return __spreadArray(__spreadArray([],__read(e),!1),__read(n),!1)}var r=t.startAngle,i=t.endAngle,s=t.center,l=t.radius;return __spreadArray(__spreadArray([r,i],__read(s),!1),[l],!1)}function Hx(t,e){return e&&Ih(e)?t.filter(e):t}function IA(t,e){var n=e.startAngle,r=e.endAngle;return(r-n)*t+n}function Gx(t,e){if(e.type==="linear"){var n=(0,F.CR)(e.startPos,2),r=n[0],i=n[1],s=(0,F.CR)(e.endPos,2),l=s[0],u=s[1],h=(0,F.CR)([l-r,u-i],2),p=h[0],m=h[1];return go([p,m])}var y=pn(IA(t,e));return[-Math.sin(y),Math.cos(y)]}function r1(t,e,n){var r=Gx(t,n);return CE(r,e!=="positive")}function Ma(t,e){return r1(t,e.labelDirection,e)}function Ov(t,e){var n=(0,F.CR)(e.startPos,2),r=n[0],i=n[1],s=(0,F.CR)(e.endPos,2),l=s[0],u=s[1],h=(0,F.CR)([l-r,u-i],2),p=h[0],m=h[1];return[r+p*t,i+m*t]}function PE(t,e){var n=e.radius,r=(0,F.CR)(e.center,2),i=r[0],s=r[1],l=pn(IA(t,e));return[i+n*Math.cos(l),s+n*Math.sin(l)]}function By(t,e){return e.type==="linear"?Ov(t,e):PE(t,e)}function Wx(t){return Gx(0,t)[1]===0}function bg(t){return Gx(0,t)[0]===0}function Fy(t,e){return e-t===360}function LA(t,e,n,r,i){var s=e-t,l=(0,F.CR)([i,i],2),u=l[0],h=l[1],p=(0,F.CR)([pn(t),pn(e)],2),m=p[0],y=p[1],x=function(Et){return[n+i*Math.cos(Et),r+i*Math.sin(Et)]},T=(0,F.CR)(x(m),2),C=T[0],M=T[1],I=(0,F.CR)(x(y),2),D=I[0],U=I[1];if(Fy(t,e)){var Z=(y+m)/2,G=(0,F.CR)(x(Z),2),W=G[0],$=G[1];return[["M",C,M],["A",u,h,0,1,0,W,$],["A",u,h,0,1,0,D,U]]}var J=s>180?1:0,nt=t>e?0:1,dt=!1;return dt?"M".concat(n,",").concat(r,",L").concat(C,",").concat(M,",A").concat(u,",").concat(h,",0,").concat(J,",").concat(nt,",").concat(D,",").concat(U,",L").concat(n,",").concat(r):"M".concat(C,",").concat(M,",A").concat(u,",").concat(h,",0,").concat(J,",").concat(nt,",").concat(D,",").concat(U)}function DA(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,i=e.center,s=e.radius;return(0,F.ev)((0,F.ev)([n,r],(0,F.CR)(i),!1),[s],!1)}function vP(t,e,n,r){var i=e.startAngle,s=e.endAngle,l=e.center,u=e.radius;return t.selectAll(el.line.class).data([{d:LA.apply(void 0,(0,F.ev)((0,F.ev)([i,s],(0,F.CR)(l),!1),[u],!1))}],function(h,p){return p}).join(function(h){return h.append("path").attr("className",el.line.name).styles(e).styles({d:function(p){return p.d}})},function(h){return h.transition(function(){var p=this,m=n1(this,DA(this),(0,F.ev)((0,F.ev)([i,s],(0,F.CR)(l),!1),[u],!1),r.update);if(m){var y=function(){var x=Ii(p.attributes,"__keyframe_data__");p.style.d=LA.apply(void 0,(0,F.ev)([],(0,F.CR)(x),!1))};m.onframe=y,m.onfinish=y}return m}).styles(e)},function(h){return h.remove()}).styles(n).transitions()}function Eg(t,e){var n=e.truncRange,r=e.truncShape,i=e.lineExtension}function gP(t,e,n){n===void 0&&(n=[0,0]);var r=(0,F.CR)([t,e,n],3),i=(0,F.CR)(r[0],2),s=i[0],l=i[1],u=(0,F.CR)(r[1],2),h=u[0],p=u[1],m=(0,F.CR)(r[2],2),y=m[0],x=m[1],T=(0,F.CR)([h-s,p-l],2),C=T[0],M=T[1],I=Math.sqrt(Math.pow(C,2)+Math.pow(M,2)),D=(0,F.CR)([-y/I,x/I],2),U=D[0],Z=D[1];return[U*C,U*M,Z*C,Z*M]}function NA(t){var e=(0,F.CR)(t,2),n=(0,F.CR)(e[0],2),r=n[0],i=n[1],s=(0,F.CR)(e[1],2),l=s[0],u=s[1];return{x1:r,y1:i,x2:l,y2:u}}function kA(t,e,n,r){var i=e.showTrunc,s=e.startPos,l=e.endPos,u=e.truncRange,h=e.lineExtension,p=(0,F.CR)([s,l],2),m=(0,F.CR)(p[0],2),y=m[0],x=m[1],T=(0,F.CR)(p[1],2),C=T[0],M=T[1],I=(0,F.CR)(h?gP(s,l,h):new Array(4).fill(0),4),D=I[0],U=I[1],Z=I[2],G=I[3],W=function(oe){return t.selectAll(el.line.class).data(oe,function(_e,hn){return hn}).join(function(_e){return _e.append("line").attr("className",function(hn){return"".concat(el.line.name," ").concat(hn.className)}).styles(n).transition(function(hn){return x0(this,NA(hn.line),!1)})},function(_e){return _e.styles(n).transition(function(hn){var Dn=hn.line;return x0(this,NA(Dn),r.update)})},function(_e){return _e.remove()}).transitions()};if(!i||!u)return W([{line:[[y+D,x+U],[C+Z,M+G]],className:el.line.name}]);var $=(0,F.CR)(u,2),J=$[0],nt=$[1],dt=C-y,Et=M-x,Pt=(0,F.CR)([y+dt*J,x+Et*J],2),Ht=Pt[0],Ct=Pt[1],Ft=(0,F.CR)([y+dt*nt,x+Et*nt],2),jt=Ft[0],qt=Ft[1],Ee=W([{line:[[y+D,x+U],[Ht,Ct]],className:el.lineFirst.name},{line:[[jt,qt],[C+Z,M+G]],className:el.lineSecond.name}]);return Eg(t,e),Ee}function yP(t,e,n,r){var i=n.showArrow,s=n.showTrunc,l=n.lineArrow,u=n.lineArrowOffset,h=n.lineArrowSize,p;if(e==="arc"?p=t.select(el.line.class):s?p=t.select(el.lineSecond.class):p=t.select(el.line.class),!i||!l||n.type==="arc"&&Fy(n.startAngle,n.endAngle)){var m=p.node();m&&(m.style.markerEnd=void 0);return}var y=fh(l);y.attr(r),Nm(y,h,!0),p.style("markerEnd",y).style("markerEndOffset",-u)}function _P(t,e,n){var r=e.type,i,s=ia(e,"line");return r==="linear"?i=kA(t,e,Vx(s,"arrow"),n):i=vP(t,e,Vx(s,"arrow"),n),yP(t,r,e,s),i}function xP(t,e){return r1(t,e.gridDirection,e)}function Uy(t){var e=t.type,n=t.gridCenter;return e==="linear"?n:n||t.center}function km(t,e){var n=e.gridLength;return t.map(function(r,i){var s=r.value,l=(0,F.CR)(By(s,e),2),u=l[0],h=l[1],p=(0,F.CR)(q0(xP(s,e),n),2),m=p[0],y=p[1];return{id:i,points:[[u,h],[u+m,h+y]]}})}function BA(t,e){var n=e.gridControlAngles,r=Uy(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||n.length===0)throw new Error("Invalid gridControlAngles");var i=(0,F.CR)(r,2),s=i[0],l=i[1];return t.map(function(u,h){var p=u.value,m=(0,F.CR)(By(p,e),2),y=m[0],x=m[1],T=(0,F.CR)([y-s,x-l],2),C=T[0],M=T[1],I=[];return n.forEach(function(D){var U=pn(D),Z=(0,F.CR)([Math.cos(U),Math.sin(U)],2),G=Z[0],W=Z[1],$=C*G-M*W+s,J=C*W+M*G+l;I.push([$,J])}),{points:I,id:h}})}function bP(t,e,n,r){var i=ia(n,"grid"),s=i.type,l=i.areaFill,u=Uy(n),h=Hx(e,n.gridFilter),p=s==="segment"?km(h,n):BA(h,n),m=(0,F.pi)((0,F.pi)({},i),{center:u,areaFill:Ih(l)?h.map(function(y,x){return _s(l,[y,x,h])}):l,animate:r,data:p});return t.selectAll(el.grid.class).data([1]).join(function(y){return y.append(function(){return new ii({style:m})}).attr("className",el.grid.name)},function(y){return y.transition(function(){return this.update(m)})},function(y){return y.remove()}).transitions()}function Ku(t,e,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&t===e||i&&t===n?!0:t>e&&t<n}function EP(t){var e,n,r,i=t||1;function s(u,h){++e>i&&(r=n,l(1),++e),n[u]=h}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}var FA=function(t,e,n){if(n===void 0&&(n=128),!Ih(t))throw new TypeError("Expected a function");var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var l=e?e.apply(this,i):i[0],u=r.cache;if(u.has(l))return u.get(l);var h=t.apply(this,i);return u.set(l,h),h};return r.cache=EP(n),r},Xx,IE;function SP(t){IE=t}var UA=FA(function(t,e){var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,s=e.fontStyle,l=e.fontVariant;return IE?IE(t,n):(Xx||(Xx=g.offscreenCanvasCreator.getOrCreateContext(void 0)),Xx.font=[s,l,i,"".concat(n,"px"),r].join(" "),Xx.measureText(t).width)},function(t,e){return[t,Object.values(e||LE(t)).join()].join("")},4096),LE=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",i=t.style.fontVariant,s=t.style.fontSize;return s=typeof s=="object"?s.value:s,{fontSize:s,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:i}};function zA(t){return t.nodeName==="text"?t:t.nodeName==="g"&&t.children.length===1&&t.children[0].nodeName==="text"?t.children[0]:null}function Yx(t,e){var n=zA(t);n&&n.attr(e)}function Sg(t,e,n){n===void 0&&(n="..."),Yx(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function DE(t,e,n,r){n===void 0&&(n=2),r===void 0&&(r="top"),Yx(t,{wordWrap:!0,wordWrapWidth:e,maxLines:n,textBaseline:r})}function qx(t,e,n){var r=t.getBBox(),i=r.width,s=r.height,l=(0,F.CR)([e,n].map(function(p,m){var y;return p.includes("%")?parseFloat(((y=p.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||y===void 0?void 0:y[0])||"0")/100*(m===0?i:s):p}),2),u=l[0],h=l[1];return[u,h]}function NE(t,e){if(e)try{var n=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(n,function(i,s,l){return"translate(".concat(qx(t,s,l),")")});t.attr("transform",r)}catch(i){}}var Cv=function(t){return t!==void 0&&t!=null&&!Number.isNaN(t)};function jf(t){if((0,ge.Z)(t))return[t,t,t,t];if(Ps(t)){var e=t.length;if(e===1)return[t[0],t[0],t[0],t[0]];if(e===2)return[t[0],t[1],t[0],t[1]];if(e===3)return[t[0],t[1],t[2],t[1]];if(e===4)return t}return[0,0,0,0]}var i1=function(){function t(e,n,r,i){this.set(e,n,r,i)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(e,n,r){var i=this,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Math.cos(e),m=Math.sin(e),y=n-n*p+r*m,x=r-n*m-r*p,T=[[p*s-m*h+y,m*s+p*h+x],[p*u-m*h+y,m*u+p*h+x],[p*s-m*l+y,m*s+p*l+x],[p*u-m*l+y,m*u+p*l+x]];return T},t.prototype.set=function(e,n,r,i){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),i<n?(this.y2=n,this.y1=i):(this.y1=n,this.y2=i),this},t.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},t}();function b0(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),i=(0,F.CR)(r.min,2),s=i[0],l=i[1],u=(0,F.CR)(r.max,2),h=u[0],p=u[1],m=t.getBBox(),y=m.width,x=m.height,T=x,C=0,M=0,I=s,D=l,U=zA(t);if(U){T-=1.5;var Z=U.style.textAlign,G=U.style.textBaseline;Z==="center"?I=(s+h)/2:(Z==="right"||Z==="end")&&(I=h),G==="middle"?D=(l+p)/2:G==="bottom"&&(D=p)}var W=(0,F.CR)(jf(e),4),$=W[0],J=$===void 0?0:$,nt=W[1],dt=nt===void 0?0:nt,Et=W[2],Pt=Et===void 0?J:Et,Ht=W[3],Ct=Ht===void 0?dt:Ht,Ft=new i1((C+=s)-Ct,(M+=l)-J,C+y+dt,M+T+Pt);return t.setEulerAngles(n),Ft.rotatedPoints(pn(n),I,D)}function zy(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function o1(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r<0?2:1}function TP(t,e){var n=o1(t[0],t[1],e[0]),r=o1(t[0],t[1],e[1]),i=o1(e[0],e[1],t[0]),s=o1(e[0],e[1],t[1]);return!!(n!==r&&i!==s||n===0&&zy(t,e[0])||r===0&&zy(t,e[1])||i===0&&zy(e,t[0])||s===0&&zy(e,t[1]))}function kE(t,e){var n=t.length;if(n<3)return!1;var r=[e,[9999,e[1]]],i=0,s=0;do{var l=[t[s],t[(s+1)%n]];if(TP(l,r)){if(o1(l[0],e,l[1])===0)return zy(l,e);i++}s=(s+1)%n}while(s!==0);return!!(i&1)}function Bm(t,e){return e.every(function(n){return kE(t,n)})}function Tg(t,e,n){var r=t.x1,i=t.x2,s=t.y1,l=t.y2,u=[[r,s],[i,s],[i,l],[r,l]],h=b0(e,n);return Bm(u,h)}function BE(t,e){var n=(0,F.CR)(t,4),r=n[0],i=n[1],s=n[2],l=n[3],u=(0,F.CR)(e,4),h=u[0],p=u[1],m=u[2],y=u[3],x=s-r,T=l-i,C=m-h,M=y-p,I=x*M-C*T;if(I===0)return!1;var D=I>0,U=r-h,Z=i-p,G=x*Z-T*U;if(G<0===D)return!1;var W=C*Z-M*U;return!(W<0===D||G>I===D||W>I===D)}function $x(t,e){var n=[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]];return n.some(function(r){return BE(e,r)})}var wP={lineToLine:BE,intersectBoxLine:$x,getBounds:b0};function jA(t,e,n){var r,i,s=b0(t,n).flat(1),l=b0(e,n).flat(1),u=[[s[0],s[1],s[2],s[3]],[s[0],s[1],s[4],s[5]],[s[4],s[5],s[6],s[7]],[s[2],s[3],s[6],s[7]]];try{for(var h=(0,F.XA)(u),p=h.next();!p.done;p=h.next()){var m=p.value;if($x(l,m))return!0}}catch(y){r={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return!1}function FE(t,e){var n=t.type,r=t.labelDirection,i=t.crossSize;if(!i)return!1;if(n==="arc"){var s=t.center,l=t.radius,u=(0,F.CR)(s,2),h=u[0],p=u[1],m=r==="negative"?0:i,y=-l-m,x=l+m,T=(0,F.CR)(jf(e),4),C=T[0],M=T[1],I=T[2],D=T[3];return new i1(h+y-D,p+y-C,h+x+M,p+x+I)}var U=(0,F.CR)(t.startPos,2),Z=U[0],G=U[1],W=(0,F.CR)(t.endPos,2),$=W[0],J=W[1],nt=(0,F.CR)(bg(t)?[-e,0,e,0]:[0,e,0,-e],4),dt=nt[0],Et=nt[1],Pt=nt[2],Ht=nt[3],Ct=Ma(0,t),Ft=q0(Ct,i),jt=new i1(Z,G,$,J);return jt.x1+=Ht,jt.y1+=dt,jt.x2+=Et+Ft[0],jt.y2+=Pt+Ft[1],jt}function a1(t,e,n){var r,i,s=e.crossPadding,l=new Set,u=null,h=FE(e,s),p=function(C){return h?Tg(h,C):!0},m=function(C,M){return!C||!C.firstChild?!0:!jA(C.firstChild,M.firstChild,jf(n))};try{for(var y=(0,F.XA)(t),x=y.next();!x.done;x=y.next()){var T=x.value;p(T)?!u||m(u,T)?u=T:(l.add(u),l.add(T)):l.add(T)}}catch(C){r={error:C}}finally{try{x&&!x.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}return Array.from(l)}function wg(t,e){return e===void 0&&(e={}),(0,tr.Z)(t)?0:typeof t=="number"?t:Math.floor(UA(t,e))}function VA(t,e,n,r){if(!(t.length<=1)){var i=e.suffix,s=i===void 0?"...":i,l=e.minLength,u=e.maxLength,h=u===void 0?1/0:u,p=e.step,m=p===void 0?" ":p,y=e.margin,x=y===void 0?[0,0,0,0]:y,T=LE(r.getTextShape(t[0])),C=wg(m,T),M=l?wg(l,T):C,I=wg(h,T);((0,tr.Z)(I)||I===1/0)&&(I=Math.max.apply(null,t.map(function(Ft){return Ft.getBBox().width})));for(var D=t.slice(),U=(0,F.CR)(x,4),Z=U[0],G=Z===void 0?0:Z,W=U[1],$=W===void 0?0:W,J=U[2],nt=J===void 0?G:J,dt=U[3],Et=dt===void 0?$:dt,Pt=function(Ft){if(D.forEach(function(jt){r.ellipsis(r.getTextShape(jt),Ft,s)}),D=a1(t,n,x),D.length<1)return{value:void 0}},Ht=I;Ht>M+C;Ht-=C){var Ct=Pt(Ht);if(typeof Ct=="object")return Ct.value}}}function ZA(t){var e=t&&t.getRenderBounds();if(!e)return{width:0,height:0};var n=e.getMax(),r=e.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function UE(t){var e=t.getLocalBounds(),n=e.min,r=e.max,i=(0,F.CR)([n,r],2),s=(0,F.CR)(i[0],2),l=s[0],u=s[1],h=(0,F.CR)(i[1],2),p=h[0],m=h[1];return{x:l,y:u,width:p-l,height:m-u,left:l,bottom:m,top:u,right:p}}function AP(t,e){var n=select(t).append("text").node();return n.attr(__assign(__assign({},e),{visibility:"hidden"})),n}function HA(t,e){var n=(0,F.CR)(t,2),r=n[0],i=n[1],s=(0,F.CR)(e,2),l=s[0],u=s[1];return r!==l&&i===u}function OP(t,e){var n=__read(t,2),r=n[0],i=n[1],s=__read(e,2),l=s[0],u=s[1];return r===l&&i!==u}function GA(t,e){var n,r,i=e.attributes;try{for(var s=(0,F.XA)(Object.entries(i)),l=s.next();!l.done;l=s.next()){var u=(0,F.CR)(l.value,2),h=u[0],p=u[1];h!=="id"&&h!=="className"&&t.attr(h,p)}}catch(m){n={error:m}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}var CP={parity:function(t,e){var n=e.seq,r=n===void 0?2:n;return t.filter(function(i,s){return s%r?(Dm(i),!1):!0})}},WA=function(t){return t.filter(Cv)};function zE(t,e,n,r){var i=t.length,s=e.keepHeader,l=e.keepTail;if(!(i<=1||i===2&&s&&l)){var u=CP.parity,h=function(Z){return Z.forEach(r.show),Z},p=2,m=t.slice(),y=t.slice(),x=Math.min.apply(Math,(0,F.ev)([1],(0,F.CR)(t.map(function(Z){return Z.getBBox().width})),!1));if(n.type==="linear"&&(Wx(n)||bg(n))){var T=UE(t[0]).left,C=UE(t[i-1]).right,M=Math.abs(C-T)||1;p=Math.max(Math.floor(i*x/M),p)}var I,D;for(s&&(I=m.splice(0,1)[0]),l&&(D=m.splice(-1,1)[0],m.reverse()),h(m);p<t.length&&a1(WA(D?(0,F.ev)((0,F.ev)([D],(0,F.CR)(y),!1),[I],!1):(0,F.ev)([I],(0,F.CR)(y),!1)),n,e==null?void 0:e.margin).length;){if(D&&!I&&p%2===0){var U=m.splice(0,1);U.forEach(r.hide)}else if(D&&I){var U=m.splice(0,1);U.forEach(r.hide)}y=u(h(m),{seq:p}),p++}}}function XA(t,e,n,r){var i,s,l=e.optionalAngles,u=l===void 0?[0,45,90]:l,h=e.margin,p=e.recoverWhenFailed,m=p===void 0?!0:p,y=t.map(function(D){return D.getLocalEulerAngles()}),x=function(){return a1(t,n,h).length<1},T=function(D){return t.forEach(function(U,Z){var G=Array.isArray(D)?D[Z]:D;r.rotate(U,+G)})};try{for(var C=(0,F.XA)(u),M=C.next();!M.done;M=C.next()){var I=M.value;if(T(I),x())return}}catch(D){i={error:D}}finally{try{M&&!M.done&&(s=C.return)&&s.call(C)}finally{if(i)throw i.error}}m&&T(y)}function YA(t){var e=t.type,n=t.labelDirection;return e==="linear"&&Wx(t)?n==="negative"?"bottom":"top":"middle"}function qA(t,e,n,r){var i=e.wordWrapWidth,s=i===void 0?50:i,l=e.maxLines,u=l===void 0?3:l,h=e.recoverWhenFailed,p=h===void 0?!0:h,m=e.margin,y=m===void 0?[0,0,0,0]:m,x=t.map(function(U){return U.attr("maxLines")||1}),T=Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(x),!1)),C=function(){return a1(t,n,y).length<1},M=YA(n),I=function(U){return t.forEach(function(Z,G){var W=Array.isArray(U)?U[G]:U;r.wrap(Z,s,W,M)})};if(!(T>u)){for(var D=T;D<=u;D++)if(I(D),C())return;p&&I(x)}}var $A=new Map([["hide",zE],["rotate",XA],["ellipsis",VA],["wrap",qA]]);function KA(t,e,n){return e.labelOverlap.length<1?!1:n==="hide"?!OA(t[0]):n==="rotate"?!t.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):n==="ellipsis"||n==="wrap"?t.filter(function(r){return r.querySelector("text")}).length>1:!0}function QA(t,e,n){var r=e.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(s){var l=s.type,u=$A.get(l);KA(t,e,l)&&(u==null||u(t,s,e,n))})}function xs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(r){return r==="positive"?-1:1};return t.reduce(function(r,i){return r*n(i)},1)}function jE(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function Kx(t,e){var n=(0,F.CR)(t,2),r=n[0],i=n[1],s=(0,F.CR)(e,2),l=s[0],u=s[1],h=(0,F.CR)([r*l+i*u,r*u-i*l],2),p=h[0],m=h[1];return Math.atan2(m,p)}function Lh(t){var e=(t+360)%180;return Ku(e,-90,90)||(e+=180),e}function Rc(t,e,n){var r,i=n.labelAlign,s=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(s)return e.getLocalEulerAngles();var l=0,u=Ma(t.value,n),h=Gx(t.value,n);return i==="horizontal"?0:(i==="perpendicular"?l=Kx([1,0],u):l=Kx([h[0]<0?-1:1,0],h),Lh(Ls(l)))}function Vf(t,e,n){var r=n.type,i=n.labelAlign,s=Ma(t,n),l=jE(e),u=jE(Ls(Kx([1,0],s))),h="center",p="middle";return r==="linear"?[90,270].includes(u)&&l===0?(h="center",p=s[1]===1?"top":"bottom"):!(u%180)&&[90,270].includes(l)?h="center":u===0?(Ku(l,0,90,!1,!0)||Ku(l,0,90)||Ku(l,270,360))&&(h="start"):u===90?Ku(l,0,90,!1,!0)?h="start":(Ku(l,90,180)||Ku(l,270,360))&&(h="end"):u===270?Ku(l,0,90,!1,!0)?h="end":(Ku(l,90,180)||Ku(l,270,360))&&(h="start"):u===180&&(l===90?h="start":(Ku(l,0,90)||Ku(l,270,360))&&(h="end")):i==="parallel"?Ku(u,0,180,!0)?p="top":p="bottom":i==="horizontal"?Ku(u,90,270,!1)?h="end":(Ku(u,270,360,!1)||Ku(u,0,90))&&(h="start"):i==="perpendicular"&&(Ku(u,90,270)?h="end":h="start"),{textAlign:h,textBaseline:p}}function $0(t,e,n){e.setLocalEulerAngles(t);var r=e.__data__.value,i=Vf(r,t,n),s=e.querySelector(el.labelItem.class);s&&ZE(s,i)}function VE(t,e,n){var r=n.showTick,i=n.tickLength,s=n.tickDirection,l=n.labelDirection,u=n.labelSpacing,h=e.indexOf(t),p=_s(u,[t,h,e]),m=(0,F.CR)([Ma(t.value,n),xs(l,s)],2),y=m[0],x=m[1],T=x===1?_s(r?i:0,[t,h,e]):0,C=(0,F.CR)(Dy(q0(y,p+T),By(t.value,n)),2),M=C[0],I=C[1];return{x:M,y:I}}function JA(t,e,n,r){var i=r.labelFormatter,s=Ih(i)?function(){return fh(_s(i,[t,e,n,Ma(t.value,r)]))}:function(){return fh(t.label||"")};return s}function ZE(t,e){t.nodeName==="text"&&t.attr(e)}function Qx(t){QA(this.node().childNodes,t,{hide:Dm,show:Iy,rotate:function(e,n){$0(+n,e,t)},ellipsis:function(e,n,r){e&&Sg(e,n||1/0,r)},wrap:function(e,n,r){e&&DE(e,n,r)},getTextShape:function(e){return e.querySelector("text")}})}function s1(t,e,n,r,i){var s=n.indexOf(e),l=Ga(t).append(JA(e,s,n,i)).attr("className",el.labelItem.name).node(),u=(0,F.CR)(Pl(Zx(r,[e,s,n])),2),h=u[0],p=u[1],m=p.transform,y=(0,F._T)(p,["transform"]);NE(l,m);var x=Rc(e,l,i);return l.getLocalEulerAngles()||l.setLocalEulerAngles(x),ZE(l,(0,F.pi)((0,F.pi)({},Vf(e.value,x,i)),h)),t.attr(y),l}function Rd(t,e,n,r){var i=Hx(e,n.labelFilter),s=ia(n,"label");return t.selectAll(el.label.class).data(i,function(l,u){return u}).join(function(l){return l.append("g").attr("className",el.label.name).transition(function(u){s1(this,u,e,s,n);var h=VE(u,e,n),p=h.x,m=h.y;return this.style.transform="translate(".concat(p,", ").concat(m,")"),null}).call(function(){Qx.call(t,n)})},function(l){return l.transition(function(u){var h=this.querySelector(el.labelItem.class),p=s1(this,u,e,s,n),m=AA(h,p,r.update),y=VE(u,e,n),x=y.x,T=y.y,C=x0(this,{transform:"translate(".concat(x,", ").concat(T,")")},r.update);return(0,F.ev)((0,F.ev)([],(0,F.CR)(m),!1),[C],!1)}).call(function(u){var h=Ii(u,"_transitions").flat().filter(Cv);J_(h,function(){Qx.call(t,n)})})},function(l){return l.transition(function(){var u=this,h=cd(this.childNodes[0],r.exit);return _g(h,function(){return Ga(u).remove()}),h})}).transitions()}function K0(t,e){return r1(t,e.tickDirection,e)}function l1(t,e){var n=(0,F.CR)(t,2),r=n[0],i=n[1];return[[0,0],[r*e,i*e]]}function t3(t,e,n,r,i){var s=i.tickLength,l=(0,F.CR)(l1(r,_s(s,[t,e,n])),2),u=(0,F.CR)(l[0],2),h=u[0],p=u[1],m=(0,F.CR)(l[1],2),y=m[0],x=m[1];return{x1:h,x2:y,y1:p,y2:x}}function HE(t,e,n,r,i){var s=i.tickFormatter,l=K0(e.value,i),u="line";return Ih(s)&&(u=function(){return _s(s,[e,n,r,l])}),t.append(u).attr("className",el.tickItem.name)}function e3(t,e,n,r,i,s,l){var u=K0(t.value,s),h=t3(t,e,n,u,s),p=h.x1,m=h.x2,y=h.y1,x=h.y2,T=(0,F.CR)(Pl(Zx(l,[t,e,n,u])),2),C=T[0],M=T[1];r.node().nodeName==="line"&&r.styles((0,F.pi)({x1:p,x2:m,y1:y,y2:x},C)),i.attr(M),r.styles(C)}function GE(t,e,n,r,i,s){var l=HE(Ga(this),t,e,n,r);e3(t,e,n,l,this,r,i);var u=(0,F.CR)(By(t.value,r),2),h=u[0],p=u[1];return x0(this,{transform:"translate(".concat(h,", ").concat(p,")")},s)}function jy(t,e,n,r){var i=Hx(e,n.tickFilter),s=ia(n,"tick");return t.selectAll(el.tick.class).data(i,function(l){return l.id||l.label}).join(function(l){return l.append("g").attr("className",el.tick.name).transition(function(u,h){return GE.call(this,u,h,i,n,s,!1)})},function(l){return l.transition(function(u,h){return this.removeChildren(),GE.call(this,u,h,i,n,s,r.update)})},function(l){return l.transition(function(){var u=this,h=cd(this.childNodes[0],r.exit);return _g(h,function(){return u.remove()}),h})}).transitions()}var yc=function(){function t(e,n,r,i){e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=n,this.width=r,this.height=i}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(e,n){return e>=this.left&&e<=this.right&&n>=this.top&&n<=this.bottom},t}();function RP(t){var e=t.getRenderBounds(),n=__read(e.min,2),r=n[0],i=n[1],s=__read(e.max,2),l=s[0],u=s[1],h=l-r,p=u-i;return new yc(r,i,h,p)}var n3=lp({text:"text"},"title");function Vy(t){return/\S+-\S+/g.test(t)?t.split("-").map(function(e){return e[0]}):t.length>2?[t[0]]:t.split("")}function WE(t,e){var n=t.attributes,r=n.position,i=n.spacing,s=n.inset,l=n.text,u=t.getBBox(),h=e.getBBox(),p=Vy(r),m=(0,F.CR)(jf(l?i:0),4),y=m[0],x=m[1],T=m[2],C=m[3],M=(0,F.CR)(jf(s),4),I=M[0],D=M[1],U=M[2],Z=M[3],G=(0,F.CR)([C+x,y+T],2),W=G[0],$=G[1],J=(0,F.CR)([Z+D,I+U],2),nt=J[0],dt=J[1];if(p[0]==="l")return new yc(u.x,u.y,h.width+u.width+W+nt,Math.max(h.height+dt,u.height));if(p[0]==="t")return new yc(u.x,u.y,Math.max(h.width+nt,u.width),h.height+u.height+$+dt);var Et=(0,F.CR)([e.attributes.width||h.width,e.attributes.height||h.height],2),Pt=Et[0],Ht=Et[1];return new yc(h.x,h.y,Pt+u.width+W+nt,Ht+u.height+$+dt)}function Fm(t,e){var n=Object.entries(e).reduce(function(r,i){var s=(0,F.CR)(i,2),l=s[0],u=s[1],h=t.node().attr(l);return h||(r[l]=u),r},{});t.styles(n)}function MP(t){var e,n,r,i,s=t,l=s.width,u=s.height,h=s.position,p=(0,F.CR)([+l/2,+u/2],2),m=p[0],y=p[1],x=(0,F.CR)([+m,+y,"center","middle"],4),T=x[0],C=x[1],M=x[2],I=x[3],D=Vy(h);return D.includes("l")&&(e=(0,F.CR)([0,"start"],2),T=e[0],M=e[1]),D.includes("r")&&(n=(0,F.CR)([+l,"end"],2),T=n[0],M=n[1]),D.includes("t")&&(r=(0,F.CR)([0,"top"],2),C=r[0],I=r[1]),D.includes("b")&&(i=(0,F.CR)([+u,"bottom"],2),C=i[0],I=i[1]),{x:T,y:C,textAlign:M,textBaseline:I}}var Md=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var n=this,r=this.attributes,i=r.width,s=r.height,l=r.position,u=r.spacing,h=r.inset,p=n.querySelector(n3.text.class);if(!p)return new yc(0,0,+i,+s);var m=p.getBBox(),y=m.width,x=m.height,T=(0,F.CR)(jf(u),4),C=T[0],M=T[1],I=T[2],D=T[3],U=(0,F.CR)([0,0,+i,+s],4),Z=U[0],G=U[1],W=U[2],$=U[3],J=Vy(l);if(J.includes("i"))return new yc(Z,G,W,$);J.forEach(function(qt,Ee){var oe,_e,hn,Dn;qt==="t"&&(oe=(0,F.CR)(Ee===0?[x+I,+s-x-I]:[0,+s],2),G=oe[0],$=oe[1]),qt==="r"&&(_e=(0,F.CR)([+i-y-D],1),W=_e[0]),qt==="b"&&(hn=(0,F.CR)([+s-x-C],1),$=hn[0]),qt==="l"&&(Dn=(0,F.CR)(Ee===0?[y+M,+i-y-M]:[0,+i],2),Z=Dn[0],W=Dn[1])});var nt=(0,F.CR)(jf(h),4),dt=nt[0],Et=nt[1],Pt=nt[2],Ht=nt[3],Ct=(0,F.CR)([Ht+Et,dt+Pt],2),Ft=Ct[0],jt=Ct[1];return new yc(Z+Ht,G+dt,W-Ft,$-jt)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new yc(0,0,0,0)},e.prototype.render=function(n,r){var i=this,s=n.width,l=n.height,u=n.position,h=n.spacing,p=(0,F._T)(n,["width","height","position","spacing"]),m=(0,F.CR)(Pl(p),1),y=m[0],x=MP(n),T=x.x,C=x.y,M=x.textAlign,I=x.textBaseline;sd(!!p.text,Ga(r),function(D){i.title=D.maybeAppendByClassName(n3.text,"text").styles(y).call(Fm,{x:T,y:C,textAlign:M,textBaseline:I}).node()})},e}(Af);function r3(t,e,n){var r=n.titlePosition,i=r===void 0?"lb":r,s=n.titleSpacing,l=Vy(i),u=t.node().getLocalBounds(),h=(0,F.CR)(u.min,2),p=h[0],m=h[1],y=(0,F.CR)(u.halfExtents,2),x=y[0],T=y[1],C=(0,F.CR)(e.node().getLocalBounds().halfExtents,2),M=C[0],I=C[1],D=(0,F.CR)([p+x,m+T],2),U=D[0],Z=D[1],G=(0,F.CR)(jf(s),4),W=G[0],$=G[1],J=G[2],nt=G[3];if(["start","end"].includes(i)&&n.type==="linear"){var dt=n.startPos,Et=n.endPos,Pt=(0,F.CR)(i==="start"?[dt,Et]:[Et,dt],2),Ht=Pt[0],Ct=Pt[1],Ft=go([-Ct[0]+Ht[0],-Ct[1]+Ht[1]]),jt=(0,F.CR)(q0(Ft,W),2),qt=jt[0],Ee=jt[1];return{x:Ht[0]+qt,y:Ht[1]+Ee}}return l.includes("t")&&(Z-=T+I+W),l.includes("r")&&(U+=x+M+$),l.includes("l")&&(U-=x+M+nt),l.includes("b")&&(Z+=T+I+J),{x:U,y:Z}}function zo(t,e,n){var r=t.getGeometryBounds().halfExtents,i=r[1]*2;if(e==="vertical"){if(n==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(n==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function Jx(t,e,n,r,i){var s=ia(r,"title"),l=(0,F.CR)(Pl(s),2),u=l[0],h=l[1],p=h.transform,m=h.transformOrigin,y=(0,F._T)(h,["transform","transformOrigin"]);e.styles(y);var x=p||zo(t.node(),u.direction,u.position);t.styles((0,F.pi)((0,F.pi)({},u),{transformOrigin:m})),NE(t.node(),x);var T=r3(Ga(n._offscreen||n.querySelector(el.mainGroup.class)),e,r),C=T.x,M=T.y,I=x0(e.node(),{transform:"translate(".concat(C,", ").concat(M,")")},i);return I}function XE(t,e,n,r){var i=n.titleText;return t.selectAll(el.title.class).data([{title:i}].filter(function(s){return!!s.title}),function(s,l){return s.title}).join(function(s){return s.append(function(){return fh(i)}).attr("className",el.title.name).transition(function(){return Jx(Ga(this),t,e,n,r.enter)})},function(s){return s.transition(function(){return Jx(Ga(this),t,e,n,r.update)})},function(s){return s.remove()}).transitions()}function YE(t,e,n,r){var i=t.showLine,s=t.showTick,l=t.showLabel,u=e.maybeAppendByClassName(el.lineGroup,"g"),h=sd(i,u,function(T){return _P(T,t,r)})||[],p=e.maybeAppendByClassName(el.tickGroup,"g"),m=sd(s,p,function(T){return jy(T,n,t,r)})||[],y=e.maybeAppendByClassName(el.labelGroup,"g"),x=sd(l,y,function(T){return Rd(T,n,t,r)})||[];return(0,F.ev)((0,F.ev)((0,F.ev)([],(0,F.CR)(h),!1),(0,F.CR)(m),!1),(0,F.CR)(x),!1).filter(function(T){return!!T})}var c1=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,t1)||this}return e.prototype.render=function(n,r,i){var s=this,l=n.titleText,u=n.data,h=n.animate,p=n.showTitle,m=n.showGrid,y=n.dataThreshold,x=n.truncRange,T=AE(u,y).filter(function(W){var $=W.value;return!(x&&$>x[0]&&$<x[1])}),C=bE(i===void 0?h:i),M=Ga(r).maybeAppendByClassName(el.gridGroup,"g"),I=sd(m,M,function(W){return bP(W,T,n,C)})||[],D=Ga(r).maybeAppendByClassName(el.mainGroup,"g");l&&(!this.initialized&&C.enter||this.initialized&&C.update)&&YE(n,Ga(this.offscreenGroup),T,bE(!1));var U=YE(n,Ga(D.node()),T,C),Z=Ga(r).maybeAppendByClassName(el.titleGroup,"g"),G=sd(p,Z,function(W){return XE(W,s,n,C)})||[];return(0,F.ev)((0,F.ev)((0,F.ev)([],(0,F.CR)(I),!1),(0,F.CR)(U),!1),(0,F.CR)(G),!1).flat().filter(function(W){return!!W})},e}(Af),Rv=function(t){return t};class Zy{constructor(e){this.options=ti({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=ti({},this.options,e),this.rescale(e)}rescale(e){}}function u1(t,e){return e-t?n=>(n-t)/(e-t):n=>.5}function Ag(t,...e){return e.reduce((n,r)=>i=>n(r(i)),t)}function tb(t,e,n,r,i){let s=n||0,l=r||t.length;const u=i||(h=>h);for(;s<l;){const h=Math.floor((s+l)/2);u(t[h])>e?l=h:s=h+1}return s}var Hy=it(19818),f1=it.n(Hy);function Um(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Og(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,i=t[3];if(n===0)return[r*255,r*255,r*255,i];const s=r<.5?r*(1+n):r+n-r*n,l=2*r-s,u=Um(l,s,e+1/3),h=Um(l,s,e),p=Um(l,s,e-1/3);return[u*255,h*255,p*255,i]}function h1(t){const e=f1().get(t);if(!e)return null;const{model:n,value:r}=e;return n==="rgb"?r:n==="hsl"?Og(r):null}const E0=(t,e)=>n=>t*(1-n)+e*n,qE=(t,e)=>{const n=h1(t),r=h1(e);return n===null||r===null?n?()=>t:()=>e:i=>{const s=new Array(4);for(let m=0;m<4;m+=1){const y=n[m],x=r[m];s[m]=y*(1-i)+x*i}const[l,u,h,p]=s;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(h)}, ${p})`}},up=(t,e)=>typeof t=="number"&&typeof e=="number"?E0(t,e):typeof t=="string"&&typeof e=="string"?qE(t,e):()=>t,i3=(t,e)=>{const n=E0(t,e);return r=>Math.round(n(r))};var o3=function(t){return t===null},eb=o3;function d1(t){return!Jr(t)&&!eb(t)&&!Number.isNaN(t)}const nb=Math.sqrt(50),Gy=Math.sqrt(10),rb=Math.sqrt(2);function Zf(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/vf(10,i);return i>=0?(s>=nb?10:s>=Gy?5:s>=rb?2:1)*vf(10,i):-vf(10,-i)/(s>=nb?10:s>=Gy?5:s>=rb?2:1)}function $E(t,e,n){const r=Math.abs(e-t)/Math.max(0,n);let i=vf(10,Math.floor(Math.log(r)/Math.LN10));const s=r/i;return s>=nb?i*=10:s>=Gy?i*=5:s>=rb&&(i*=2),e<t?-i:i}const KE=(t,e,n=5)=>{const r=[t,e];let i=0,s=r.length-1,l=r[i],u=r[s],h;return u<l&&([l,u]=[u,l],[i,s]=[s,i]),h=Zf(l,u,n),h>0?(l=Math.floor(l/h)*h,u=Math.ceil(u/h)*h,h=Zf(l,u,n)):h<0&&(l=Math.ceil(l*h)/h,u=Math.floor(u*h)/h,h=Zf(l,u,n)),h>0?(r[i]=Math.floor(l/h)*h,r[s]=Math.ceil(u/h)*h):h<0&&(r[i]=Math.ceil(l*h)/h,r[s]=Math.floor(u*h)/h),r};function a3(t,e){const n=e<t?e:t,r=t>e?t:e;return i=>Math.min(Math.max(n,i),r)}const s3=(t,e,n)=>{const[r,i]=t,[s,l]=e;let u,h;return r<i?(u=u1(r,i),h=n(s,l)):(u=u1(i,r),h=n(l,s)),Ag(h,u)},l3=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=t[0]>t[r],u=l?[...t].reverse():t,h=l?[...e].reverse():e;for(let p=0;p<r;p+=1)i[p]=u1(u[p],u[p+1]),s[p]=n(h[p],h[p+1]);return p=>{const m=tb(t,p,1,r)-1,y=i[m],x=s[m];return Ag(x,y)(p)}},QE=(t,e,n,r)=>(Math.min(t.length,e.length)>2?l3:s3)(t,e,r?i3:n);class p1 extends Zy{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:E0,tickCount:5}}map(e){return d1(e)?this.output(e):this.options.unknown}invert(e){return d1(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,n,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,n,r,...i)}getTicks(){const{tickMethod:e}=this.options,[n,r,i,...s]=this.getTickMethodOptions();return e(n,r,i,...s)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],i=e[e.length-1];return[r,i,n]}chooseNice(){return KE}rescale(){this.nice();const[e,n]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,n,this.chooseClamp(n))}chooseClamp(e){const{clamp:n,range:r}=this.options,i=this.options.domain.map(e),s=Math.min(i.length,r.length);return n?a3(i[0],i[s-1]):Rv}composeOutput(e,n){const{domain:r,range:i,round:s,interpolate:l}=this.options,u=QE(r.map(e),i,l,s);this.output=Ag(u,n,e)}composeInput(e,n,r){const{domain:i,range:s}=this.options,l=QE(s,i.map(e),E0);this.input=Ag(n,r,l)}}const Mv=(t,e,n)=>{let r,i,s=t,l=e;if(s===l&&n>0)return[s];let u=Zf(s,l,n);if(u===0||!Number.isFinite(u))return[];if(u>0){s=Math.ceil(s/u),l=Math.floor(l/u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)*u}else{u=-u,s=Math.ceil(s*u),l=Math.floor(l*u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)/u}return i};class hh extends p1{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:up,tickMethod:Mv,tickCount:5}}chooseTransforms(){return[Rv,Rv]}clone(){return new hh(this.options)}}function JE(t,e){if(t){var n;if(Ps(t))for(var r=0,i=t.length;r<i&&(n=e(t[r],r),n!==!1);r++);else if(sa(t)){for(var s in t)if(t.hasOwnProperty(s)&&(n=e(t[s],s),n===!1))break}}}var ib=JE,c3=function(t,e,n){if(!Ps(t)&&!y0(t))return t;var r=n;return ib(t,function(i,s){r=e(r,i,s)}),r},tS=c3,oc=function(t,e){return tS(t,function(n,r,i){return e.includes(i)||(n[i]=r),n},{})};function S0(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}function Cg(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,s=0;s<t.length;s++){var l=t[s],u=l.x,h=l.y,p=l.width,m=l.height,y=(0,F.CR)([u+p,h+m],2),x=y[0],T=y[1];u<e&&(e=u),h<n&&(n=h),x>r&&(r=x),T>i&&(i=T)}return new yc(e,n,r-e,i-n)}var m1=function(t,e,n){var r=t.width,i=t.height,s=n.flexDirection,l=s===void 0?"row":s,u=n.flexWrap,h=u===void 0?"nowrap":u,p=n.justifyContent,m=p===void 0?"flex-start":p,y=n.alignContent,x=y===void 0?"flex-start":y,T=n.alignItems,C=T===void 0?"flex-start":T,M=l==="row",I=l==="row"||l==="column",D=M?I?[1,0]:[-1,0]:I?[0,1]:[0,-1],U=(0,F.CR)([0,0],2),Z=U[0],G=U[1],W=e.map(function(Ct){var Ft,jt=Ct.width,qt=Ct.height,Ee=(0,F.CR)([Z,G],2),oe=Ee[0],_e=Ee[1];return Ft=(0,F.CR)([Z+jt*D[0],G+qt*D[1]],2),Z=Ft[0],G=Ft[1],new yc(oe,_e,jt,qt)}),$=Cg(W),J={"flex-start":0,"flex-end":M?r-$.width:i-$.height,center:M?(r-$.width)/2:(i-$.height)/2},nt=W.map(function(Ct){var Ft=Ct.x,jt=Ct.y,qt=yc.fromRect(Ct);return qt.x=M?Ft+J[m]:Ft,qt.y=M?jt:jt+J[m],qt}),dt=Cg(nt),Et=function(Ct){var Ft=(0,F.CR)(M?["height",i]:["width",r],2),jt=Ft[0],qt=Ft[1];switch(C){case"flex-start":return 0;case"flex-end":return qt-Ct[jt];case"center":return qt/2-Ct[jt]/2;default:return 0}},Pt=nt.map(function(Ct){var Ft=Ct.x,jt=Ct.y,qt=yc.fromRect(Ct);return qt.x=M?Ft:Ft+Et(qt),qt.y=M?jt+Et(qt):jt,qt}),Ht=Pt.map(function(Ct){var Ft,jt,qt=yc.fromRect(Ct);return qt.x+=(Ft=t.x)!==null&&Ft!==void 0?Ft:0,qt.y+=(jt=t.y)!==null&&jt!==void 0?jt:0,qt});return Ht},v1=function(t,e,n){return[]},Q0=function(t,e,n){if(e.length===0)return[];var r={flex:m1,grid:v1},i=n.display in r?r[n.display]:null;return(i==null?void 0:i.call(null,t,e,n))||[]},Wy=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n)||this;r.layoutEvents=[Sa.BOUNDS_CHANGED,Sa.INSERTED,Sa.REMOVED],r.$margin=jf(0),r.$padding=jf(0);var i=n.style||{},s=i.margin,l=s===void 0?0:s,u=i.padding,h=u===void 0?0:u;return r.margin=l,r.padding=h,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(n){this.$margin=jf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(n){this.$padding=jf(n)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.x,i=r===void 0?0:r,s=n.y,l=s===void 0?0:s,u=n.width,h=n.height,p=(0,F.CR)(this.$margin,4),m=p[0],y=p[1],x=p[2],T=p[3];return new yc(i-T,l-m,u+T+y,h+m+x)},e.prototype.appendChild=function(n,r){return n.isMutationObserved=!0,t.prototype.appendChild.call(this,n,r),n},e.prototype.getAvailableSpace=function(){var n=this.attributes,r=n.width,i=n.height,s=(0,F.CR)(this.$padding,4),l=s[0],u=s[1],h=s[2],p=s[3],m=(0,F.CR)(this.$margin,4),y=m[0],x=m[3];return new yc(p+x,l+y,r-p-u,i-l-h)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(l){return!l.isConnected}))try{var n=this.attributes,r=n.x,i=n.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var s=Q0(this.getAvailableSpace(),this.children.map(function(l){return l.getBBox()}),this.attributes);this.children.forEach(function(l,u){var h=s[u],p=h.x,m=h.y;l.style.transform="translate(".concat(p,", ").concat(m,")")})}catch(l){}},e.prototype.bindEvents=function(){var n=this;this.layoutEvents.forEach(function(r){n.addEventListener(r,function(i){i.target.isMutationObserved=!0,n.layout()})})},e.prototype.attributeChangedCallback=function(n,r,i){n==="margin"?this.margin=i:n==="padding"&&(this.padding=i),this.layout()},e}(Ai),u3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function g1(t){return class extends Wr{constructor(e){super(e),this.descriptor=t}connectedCallback(){var e,n;(n=(e=this.descriptor).render)===null||n===void 0||n.call(e,this.attributes,this)}update(e={}){var n,r;this.attr(ti({},this.attributes,e)),(r=(n=this.descriptor).render)===null||r===void 0||r.call(n,this.attributes,this)}}}function eS(t,e,n){return t.querySelector(e)?Ra(t).select(e):Ra(t).append(n)}function y1(t){return Array.isArray(t)?t.join(", "):`${t||""}`}function Pv(t,e){const n={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:r,justifyContent:i,alignItems:s}=n;const l={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return t in l&&([r,i,s]=l[t]),Object.assign({display:"flex",flexDirection:r,justifyContent:i,alignItems:s},e)}class Xy extends Wy{get child(){var e;return(e=this.children)===null||e===void 0?void 0:e[0]}update(e){var n;this.attr(e);const{subOptions:r}=e;(n=this.child)===null||n===void 0||n.update(r)}}class f3 extends Xy{update(e){var n;const{subOptions:r}=e;this.attr(e),(n=this.child)===null||n===void 0||n.update(r)}}function Pd(t,e){var n;return(n=t.filter(r=>r.getOptions().name===e))===null||n===void 0?void 0:n[0]}function Yy(t){return t==="horizontal"||t===0}function _1(t){return t==="vertical"||t===-Math.PI/2}function nS(t,e,n){const{bbox:r}=t,{position:i="top",size:s,length:l}=e,u=["top","bottom","center"].includes(i),[h,p]=u?[r.height,r.width]:[r.width,r.height],{defaultSize:m,defaultLength:y}=n.props,x=s||m||h,T=l||y||p,C=u?"horizontal":"vertical",[M,I]=u?[T,x]:[x,T];return{orientation:C,width:M,height:I,size:x,length:T}}function qy(t){return t.find(e=>e.getOptions().domain.length>0).getOptions().domain}function x1(t){const e=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:n}=t,r=u3(t,["style"]),i={};return Object.entries(r).forEach(([s,l])=>{e.includes(s)?i[`show${Sv(s)}`]=l:i[s]=l}),Object.assign(Object.assign({},i),n)}var rS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function iS(t,e){const{eulerAngles:n,origin:r}=e;r&&t.setOrigin(r),n&&t.rotate(n[0],n[1],n[2])}function ob(t){const{innerWidth:e,innerHeight:n,depth:r}=t.getOptions();return[e,n,r]}function Qu(t,e){const{width:n,height:r}=e.getOptions();return i=>{if(!yE(e))return i;const s=t==="bottom"?[i,1]:[0,i],l=e.map(s);if(t==="bottom"){const u=l[0];return new hh({domain:[0,n],range:[0,1]}).map(u)}else if(t==="left"){const u=l[1];return new hh({domain:[0,r],range:[0,1]}).map(u)}return i}}function ab(t,e,n){if(t.getTicks)return t.getTicks();if(!n)return e;const[r,i]=S0(e,l=>+l),{tickCount:s}=t.getOptions();return n(r,i,s)}function h3(t,e){if(Ml(e))return T=>T;const n=e.getOptions(),{innerWidth:r,innerHeight:i,insetTop:s,insetBottom:l,insetLeft:u,insetRight:h}=n,[p,m,y]=t==="left"||t==="right"?[s,l,i]:[u,h,r],x=new hh({domain:[0,1],range:[p/y,1-m/y]});return T=>x.map(T)}function b1(t,e,n,r,i,s,l,u){var h;(n!==void 0||s!==void 0)&&t.update(Object.assign(Object.assign({},n&&{tickCount:n}),s&&{tickMethod:s}));const p=ab(t,e,s),m=i?p.filter(i):p,y=D=>D instanceof Date?String(D):typeof D=="object"&&D?D:String(D),x=r||((h=t.getFormatter)===null||h===void 0?void 0:h.call(t))||y,T=h3(l,u),C=Qu(l,u),M=D=>["top","bottom","center","outer"].includes(D),I=D=>["left","right"].includes(D);return Ml(u)||gc(u)?m.map((D,U,Z)=>{var G,W;const $=((G=t.getBandWidth)===null||G===void 0?void 0:G.call(t,D))/2||0,J=T(t.map(D)+$);return{value:My(u)&&l==="center"||gc(u)&&((W=t.getTicks)===null||W===void 0?void 0:W.call(t))&&M(l)||gc(u)&&I(l)?1-J:J,label:y(x(q_(D),U,Z)),id:String(U)}}):m.map((D,U,Z)=>{var G;const W=((G=t.getBandWidth)===null||G===void 0?void 0:G.call(t,D))/2||0,$=C(T(t.map(D)+W));return{value:I(l)?1-$:$,label:y(x(q_(D),U,Z)),id:String(U)}})}function p3(t,e,n="xy"){const[r,i,s]=ob(e);return n==="xy"?t.includes("bottom")||t.includes("top")?i:r:n==="xz"?t.includes("bottom")||t.includes("top")?s:r:t.includes("bottom")||t.includes("top")?i:s}function m3(t=[],e){if(t.length>0)return t;const{labelAutoRotate:n,labelAutoHide:r,labelAutoEllipsis:i,labelAutoWrap:s}=e,l=[],u=(h,p)=>{p&&l.push(Object.assign(Object.assign({},h),p))};return u({type:"rotate",optionalAngles:[0,15,30,45,60,90]},n),u({type:"ellipsis",minLength:20},i),u({type:"hide"},r),u({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},s),l}function v3(t,e,n,r,i){const{x:s,y:l,width:u,height:h}=e,p=[s+u/2,l+h/2],m=Math.min(u,h)/2,[y,x]=xE(i),[T,C]=ob(i),M=Math.min(T,C)/2,I={center:p,radius:m,startAngle:y,endAngle:x,gridLength:(r-n)*M};if(t==="inner"){const{insetLeft:D,insetTop:U}=i.getOptions();return Object.assign(Object.assign({},I),{center:[p[0]-D,p[1]-U],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},I),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function sb(t,e,n){return _E(e)||Py(e)?!1:t===void 0?!!n.getTicks:t}function oS(t){const{depth:e}=t.getOptions();return e?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function g3(t,e,n,r,i){const{x:s,y:l,width:u,height:h}=n;if(t==="bottom")return{startPos:[s,l],endPos:[s+u,l]};if(t==="left")return{startPos:[s+u,l+h],endPos:[s+u,l]};if(t==="right")return{startPos:[s,l+h],endPos:[s,l]};if(t==="top")return{startPos:[s,l+h],endPos:[s+u,l+h]};if(t==="center"){if(e==="vertical")return{startPos:[s,l],endPos:[s,l+h]};if(e==="horizontal")return{startPos:[s,l],endPos:[s+u,l]};if(typeof e=="number"){const[p,m]=r.getCenter(),[y,x]=$_(r),[T,C]=xE(r),M=Math.min(u,h)/2,{insetLeft:I,insetTop:D}=r.getOptions(),U=y*M,Z=x*M,[G,W]=[p+s-I,m+l-D],[$,J]=[Math.cos(e),Math.sin(e)],nt=[G+Z*$,W+Z*J],dt=[G+U*$,W+U*J],Et=()=>{const{domain:Ht}=i.getOptions();return Ht.length},Pt=Ml(r)&&i?Et():3;return{startPos:nt,endPos:dt,gridClosed:Math.abs(C-T-360)<1e-6,gridCenter:[G,W],gridControlAngles:new Array(Pt).fill(0).map((Ht,Ct,Ft)=>(C-T)/Pt*Ct)}}}return{}}const Rg=t=>{const{order:e,size:n,position:r,orientation:i,labelFormatter:s,tickFilter:l,tickCount:u,tickMethod:h,important:p={},style:m={},indexBBox:y,title:x,grid:T=!1}=t,C=rS(t,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","important","style","indexBBox","title","grid"]);return({scales:[M],value:I,coordinate:D,theme:U})=>{const{bbox:Z}=I,{domain:G}=M.getOptions(),W=b1(M,G,u,s,l,h,r,D),$=y?W.map((Ct,Ft)=>{const jt=y.get(Ft);return!jt||jt[0]!==Ct.label?Ct:Object.assign(Object.assign({},Ct),{bbox:jt[1]})}):W,[J,nt]=$_(D),dt=v3(r,Z,J,nt,D),{axis:Et,axisArc:Pt={}}=U,Ht=x1(ti({},Et,Pt,dt,Object.assign(Object.assign({type:"arc",data:$,titleText:y1(x),grid:T},C),p)));return new c1({style:oc(Ht,["transform"])})}};function y3(t,e,n,r,i,s){const l=n.axis,u=["top","right","bottom","left"].includes(i)?n[`axis${Px(i)}`]:n.axisLinear,h=t.getOptions().name,p=n[`axis${Sv(h)}`]||{};return Object.assign({},l,u,p)}function _3(t,e,n,r,i,s){const l=y3(t,e,n,r,i,s);return i==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},l),{labelDirection:r==="right"?"negative":"positive"}),r==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:r==="right"?"negative":"positive",labelSpacing:r==="center"?0:4,titleSpacing:_1(s)?10:0,tick:r==="center"?!1:void 0}):l}const x3=t=>{const{direction:e="left",important:n={},labelFormatter:r,order:i,orientation:s,actualPosition:l,position:u,size:h,style:p={},title:m,tickCount:y,tickFilter:x,tickMethod:T,transform:C,indexBBox:M}=t,I=rS(t,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","transform","indexBBox"]);return({scales:D,value:U,coordinate:Z,theme:G})=>{const{bbox:W}=U,[$]=D,{domain:J,xScale:nt}=$.getOptions(),dt=_3($,Z,G,e,u,s),Et=Object.assign(Object.assign(Object.assign({},dt),p),I),Pt=p3(l||u,Z,t.plane),Ht=g3(u,s,W,Z,nt),Ct=oS(Z),Ft=b1($,J,y,r,x,T,u,Z),jt=M?Ft.map((oe,_e)=>{const hn=M.get(_e);return!hn||hn[0]!==oe.label?oe:Object.assign(Object.assign({},oe),{bbox:hn[1]})}):Ft,qt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Et),{type:"linear",data:jt,crossSize:h,titleText:y1(m),labelOverlap:m3(C,Et),grid:sb(Et.grid,Z,$),gridLength:Pt,line:!0,indexBBox:M}),Et.line?null:{lineOpacity:0}),Ht),Ct),n);return qt.labelOverlap.find(oe=>oe.type==="hide")&&(qt.crossSize=!1),new c1({className:"axis",style:x1(qt)})}},aS=t=>e=>{const{labelFormatter:n,labelFilter:r=()=>!0}=e;return i=>{var s;const{scales:[l]}=i,u=((s=l.getTicks)===null||s===void 0?void 0:s.call(l))||l.getOptions().domain,h=typeof n=="string"?Lm(n):n,p=(y,x,T)=>r(u[x],x,u),m=Object.assign(Object.assign({},e),{labelFormatter:h,labelFilter:p,scale:l});return t(m)(i)}},zm=aS(x3),sS=aS(Rg);zm.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},sS.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var b3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function lS(t){const e=t%(Math.PI*2);return e===Math.PI/2?{titleTransform:"translate(0, 50%)"}:e>-Math.PI/2&&e<Math.PI/2?{titleTransform:"translate(50%, 0)"}:e>Math.PI/2&&e<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function E3(t,e,n,r){const{radar:i}=t,[s]=r,l=s.getOptions().name,[u,h]=xE(n),{axisRadar:p={}}=e;return Object.assign(Object.assign({},p),{grid:l==="position",gridConnect:"line",gridControlAngles:new Array(i.count).fill(0).map((m,y)=>(h-u)/i.count*y)})}const lb=t=>{const{important:e={}}=t,n=b3(t,["important"]);return r=>{const{theme:i,coordinate:s,scales:l}=r;return zm(Object.assign(Object.assign(Object.assign({},n),lS(t.orientation)),{important:Object.assign(Object.assign({},E3(t,i,s,l)),e)}))(r)}};lb.props=Object.assign(Object.assign({},zm.props),{defaultPosition:"center"});function $y(t,e){return+t.toPrecision(e)}function PP(t){return t.toLocaleString()}function IP(t){return t.toExponential()}function LP(t,e){return e===void 0&&(e=0),Math.abs(t)<1e3?String(t):"".concat($y(t/1e3,e).toLocaleString(),"K")}var cb=function(t,e,n){return t<0&&Number.isFinite(t)?e:n},Ky=function(t,e,n){return t>0&&Number.isFinite(t)?e:n},DP=function(t,e){return t*e},NP=function(t,e){return t/2+(e||0)/2};function E1(t){var e=t.canvas,n=t.touches,r=t.offsetX,i=t.offsetY;if(e){var s=e.x,l=e.y;return[s,l]}if(n){var u=n[0],h=u.clientX,p=u.clientY;return[h,p]}return r&&i?[r,i]:[0,0]}var S3={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},ub=lp({background:"background",labelGroup:"label-group",label:"label"},"indicator"),T3=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,S3)||this;return r.point=[0,0],r.group=r.appendChild(new Ai({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var n=this.attributes,r=n.position,i=n.padding,s=(0,F.CR)(jf(i),4),l=s[0],u=s[1],h=s[2],p=s[3],m=this.label.node().getLocalBounds(),y=m.min,x=m.max,T=new yc(y[0]-p,y[1]-l,x[0]+u-y[0]+p,x[1]+h-y[1]+l),C=this.getPath(r,T),M=ia(this.attributes,"background");this.background=Ga(this.group).maybeAppendByClassName(ub.background,"path").styles((0,F.pi)((0,F.pi)({},M),{d:C})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var n=this.attributes,r=n.formatter,i=n.labelText,s=ia(this.attributes,"label"),l=(0,F.CR)(Pl(s),2),u=l[0],h=l[1],p=u.text,m=(0,F._T)(u,["text"]);if(this.label=Ga(this.group).maybeAppendByClassName(ub.labelGroup,"g").styles(h),!!i){var y=this.label.maybeAppendByClassName(ub.label,function(){return fh(r(i))}).style("text",r(i).toString());y.selectAll("text").styles(m)}},e.prototype.adjustLayout=function(){var n=(0,F.CR)(this.point,2),r=n[0],i=n[1],s=this.attributes,l=s.x,u=s.y;this.group.attr("transform","translate(".concat(l-r,", ").concat(u-i,")"))},e.prototype.getPath=function(n,r){var i=this.attributes.radius,s=r.x,l=r.y,u=r.width,h=r.height,p=[["M",s+i,l],["L",s+u-i,l],["A",i,i,0,0,1,s+u,l+i],["L",s+u,l+h-i],["A",i,i,0,0,1,s+u-i,l+h],["L",s+i,l+h],["A",i,i,0,0,1,s,l+h-i],["L",s,l+i],["A",i,i,0,0,1,s+i,l],["Z"]],m={top:4,right:6,bottom:0,left:2},y=m[n],x=this.createCorner([p[y].slice(-2),p[y+1].slice(-2)]);return p.splice.apply(p,(0,F.ev)([y+1,1],(0,F.CR)(x),!1)),p[0][0]="M",p},e.prototype.createCorner=function(n,r){r===void 0&&(r=10);var i=.8,s=HA.apply(void 0,(0,F.ev)([],(0,F.CR)(n),!1)),l=(0,F.CR)(n,2),u=(0,F.CR)(l[0],2),h=u[0],p=u[1],m=(0,F.CR)(l[1],2),y=m[0],x=m[1],T=(0,F.CR)(s?[y-h,[h,y]]:[x-p,[p,x]],2),C=T[0],M=(0,F.CR)(T[1],2),I=M[0],D=M[1],U=C/2,Z=C/Math.abs(C),G=r*Z,W=G/2,$=G*Math.sqrt(3)/2*i,J=(0,F.CR)([I,I+U-W,I+U,I+U+W,D],5),nt=J[0],dt=J[1],Et=J[2],Pt=J[3],Ht=J[4];return s?(this.point=[Et,p-$],[["L",nt,p],["L",dt,p],["L",Et,p-$],["L",Pt,p],["L",Ht,p]]):(this.point=[h+$,Et],[["L",h,nt],["L",h,dt],["L",h+$,Et],["L",h,Pt],["L",h,Ht]])},e.prototype.applyVisibility=function(){var n=this.attributes.visibility;n==="hidden"?Dm(this):Iy(this)},e.prototype.bindEvents=function(){this.label.on(Sa.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Af),fb={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},cS={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},hb={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Ju=lp({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),jm=lp({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),w3=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var i=n.x,s=n.y,l=n.size,u=l===void 0?10:l,h=n.radius,p=h===void 0?u/4:h,m=n.orientation,y=(0,F._T)(n,["x","y","size","radius","orientation"]),x=u,T=x*2.4,C=Ga(r).maybeAppendByClassName(jm.iconRect,"rect").styles((0,F.pi)((0,F.pi)({},y),{width:x,height:T,radius:p,x:i-x/2,y:s-T/2,transformOrigin:"center"})),M=i+1/3*x-x/2,I=i+2/3*x-x/2,D=s+1/4*T-T/2,U=s+3/4*T-T/2;C.maybeAppendByClassName("".concat(jm.iconLine,"-1"),"line").styles((0,F.pi)({x1:M,x2:M,y1:D,y2:U},y)),C.maybeAppendByClassName("".concat(jm.iconLine,"-2"),"line").styles((0,F.pi)({x1:I,x2:I,y1:D,y2:U},y)),m==="vertical"&&(C.node().style.transform="rotate(90)")},e}(Af),db=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,hb)||this}return e.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.showLabel,h=ia(this.attributes,"label"),p=h.x,m=p===void 0?0:p,y=h.y,x=y===void 0?0:y,T=h.transform,C=h.transformOrigin,M=(0,F._T)(h,["x","y","transform","transformOrigin"]),I=(0,F.CR)(Pl(M,[]),2),D=I[0],U=I[1],Z=Ga(n).maybeAppendByClassName(jm.labelGroup,"g").styles(U),G=(0,F.pi)((0,F.pi)({},cS),D),W=G.text,$=(0,F._T)(G,["text"]);sd(!!u,Z,function(J){r.label=J.maybeAppendByClassName(jm.label,"text").styles((0,F.pi)((0,F.pi)({},$),{x:s+m,y:l+x,transform:T,transformOrigin:C,text:"".concat(W)})),r.label.on("mousedown",function(nt){nt.stopPropagation()}),r.label.on("touchstart",function(nt){nt.stopPropagation()})})},e.prototype.renderIcon=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.type,h=(0,F.pi)((0,F.pi)({x:i,y:s,orientation:l},fb),ia(this.attributes,"icon")),p=this.attributes.iconShape,m=p===void 0?function(){return new w3({style:h})}:p,y=Ga(n).maybeAppendByClassName(jm.iconGroup,"g");y.selectAll(jm.icon.class).data([m]).join(function(x){return x.append(typeof m=="string"?m:function(){return m(u)}).attr("className",jm.icon.name)},function(x){return x.update(h)},function(x){return x.remove()})},e.prototype.render=function(n,r){this.renderIcon(r),this.renderLabel(r)},e}(Af),uS=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},A3=uS,fS=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]},O3=function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]},C3=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]},hS=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]},R3=function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]},M3=function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]},Qy=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},P3=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]},I3=function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]},L3=function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]},D3=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},dS=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},N3=dS,pS=function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]},k3=function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]},B3=function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]},mS=function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]};function Jy(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}var F3=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]};function U3(t){var e="default";if(sa(t)&&t instanceof Image)e="image";else if(Ih(t))e="symbol";else if(Si(t)){var n=new RegExp("data:(image|text)");t.match(n)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?e="url":e="symbol"}return e}function z3(t){var e=U3(t);return["base64","url","image"].includes(e)?"image":t&&e==="symbol"?"path":null}var dl=function(t){(0,F.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=this.getSubShapeStyle(n),p=h.symbol,m=h.size,y=m===void 0?16:m,x=(0,F._T)(h,["symbol","size"]),T=z3(p);sd(!!T,Ga(r),function(C){C.maybeAppendByClassName("marker",T).attr("className","marker ".concat(T,"-marker")).call(function(M){if(T==="image"){var I=y*2;M.styles({img:p,width:I,height:I,x:s-y,y:u-y})}else{var I=y/2,D=Ih(p)?p:e.getSymbol(p);M.styles((0,F.pi)({d:D==null?void 0:D(s,u,I)},x))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(n,r){e.MARKER_SYMBOL_MAP.set(n,r)},e.getSymbol=function(n){return e.MARKER_SYMBOL_MAP.get(n)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Af);dl.registerSymbol("cross",P3),dl.registerSymbol("hyphen",D3),dl.registerSymbol("line",Qy),dl.registerSymbol("plus",L3),dl.registerSymbol("tick",I3),dl.registerSymbol("circle",uS),dl.registerSymbol("point",A3),dl.registerSymbol("bowtie",M3),dl.registerSymbol("hexagon",R3),dl.registerSymbol("square",fS),dl.registerSymbol("diamond",O3),dl.registerSymbol("triangle",C3),dl.registerSymbol("triangle-down",hS),dl.registerSymbol("line",Qy),dl.registerSymbol("dot",dS),dl.registerSymbol("dash",N3),dl.registerSymbol("smooth",pS),dl.registerSymbol("hv",k3),dl.registerSymbol("vh",B3),dl.registerSymbol("hvh",mS),dl.registerSymbol("vhv",Jy);function j3(t,e,n){var r=Math.round((t-n)/e);return n+r*e}function pb(t,e,n){var r=1.4,i=r*n;return[["M",t-n,e-i],["L",t+n,e-i],["L",t+n,e+i],["L",t-n,e+i],["Z"]]}var vS=1.4,gS=.4;function S1(t,e,n){var r=n,i=r*vS,s=r/2,l=r/6,u=t+i*gS;return[["M",t,e],["L",u,e+s],["L",t+i,e+s],["L",t+i,e-s],["L",u,e-s],["Z"],["M",u,e+l],["L",t+i-2,e+l],["M",u,e-l],["L",t+i-2,e-l]]}function V3(t,e,n){var r=n,i=r*vS,s=r/2,l=r/6,u=e+i*gS;return[["M",t,e],["L",t-s,u],["L",t-s,e+i],["L",t+s,e+i],["L",t+s,u],["Z"],["M",t-l,u],["L",t-l,e+i-2],["M",t+l,u],["L",t+l,e+i-2]]}dl.registerSymbol("hiddenHandle",pb),dl.registerSymbol("verticalHandle",S1),dl.registerSymbol("horizontalHandle",V3);var kP=function(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n};function Z3(t,e,n,r){var i;r===void 0&&(r=4);var s=(0,F.CR)(t,2),l=s[0],u=s[1],h=(0,F.CR)(e,2),p=h[0],m=h[1],y=(0,F.CR)(n,2),x=y[0],T=y[1],C=(0,F.CR)([p,m],2),M=C[0],I=C[1],D=I-M;return M>I&&(i=(0,F.CR)([I,M],2),M=i[0],I=i[1]),D>u-l?[l,u]:M<l?x===l&&T===I?[l,I]:[l,D+l]:I>u?T===u&&x===M?[M,u]:[u-D,u]:[M,I]}function Zp(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n}var t_=lp({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),yS={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},_S=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,yS)||this}return e.prototype.render=function(n,r){var i=Ga(r).maybeAppendByClassName(t_.markerGroup,"g");this.renderMarker(i);var s=Ga(r).maybeAppendByClassName(t_.labelGroup,"g");this.renderLabel(s)},e.prototype.renderMarker=function(n){var r=this,i=this.attributes,s=i.orientation,l=i.markerSymbol,u=l===void 0?Zp(s,"horizontalHandle","verticalHandle"):l;sd(!!u,n,function(h){var p=ia(r.attributes,"marker"),m=(0,F.pi)({symbol:u},p);r.marker=h.maybeAppendByClassName(t_.marker,function(){return new dl({style:m})}).update(m)})},e.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.showLabel,l=i.orientation,u=i.spacing,h=u===void 0?0:u,p=i.formatter;sd(s,n,function(m){var y,x=ia(r.attributes,"label"),T=x.text,C=(0,F._T)(x,["text"]),M=((y=m.select(t_.marker.class))===null||y===void 0?void 0:y.node().getBBox())||{},I=M.width,D=I===void 0?0:I,U=M.height,Z=U===void 0?0:U,G=(0,F.CR)(Zp(l,[0,Z+h,"center","top"],[D+h,0,"start","middle"]),4),W=G[0],$=G[1],J=G[2],nt=G[3];m.maybeAppendByClassName(t_.label,"text").styles((0,F.pi)((0,F.pi)({},C),{x:W,y:$,text:p(T).toString(),textAlign:J,textBaseline:nt}))})},e}(Af),e_={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},Mg=Y0({},e_,{}),H3=Y0({},e_,Zl(yS,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),G3=.01,mb=.5,Hf=lp({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend");function W3(t,e){for(var n=1;n<t.length;n+=1){var r=t[n-1],i=t[n];if(e>=r&&e<=i)return[r,i]}return[e,e]}function al(t,e,n){var r=Array.from(e),i=t.length;return new Array(i).fill(0).reduce(function(s,l,u){var h=r[u%r.length];return s+=" ".concat(t[u],":").concat(h).concat(u<i-1?" ".concat(t[u+1],":").concat(h):"")},"l(".concat(n==="horizontal"?"0":"270",")"))}function vb(t,e){var n=(0,F.CR)(W3(t,e),2),r=n[0],i=n[1];return{tick:e>(r+i)/2?i:r,range:[r,i]}}var Pg=lp({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function xS(t){var e=t.orientation,n=t.size,r=t.length;return Zp(e,[r,n],[n,r])}function n_(t){var e=t.type,n=(0,F.CR)(xS(t),2),r=n[0],i=n[1];return e==="size"?[["M",0,i],["L",0+r,0],["L",0+r,i],["Z"]]:[["M",0,i],["L",0,0],["L",0+r,0],["L",0+r,i],["Z"]]}function bS(t){return n_(t)}function X3(t){var e=t.orientation,n=t.color,r=t.block,i=t.partition,s;if(Ih(n)){var l=20;s=new Array(l).fill(0).map(function(p,m,y){return n(m/(y.length-1))})}else s=n;var u=s.length,h=s.map(function(p){return $h(p).toString()});return u?u===1?h[0]:r?al(i,h,e):h.reduce(function(p,m,y){return p+=" ".concat(y/(u-1),":").concat(m)},"l(".concat(Zp(e,"0","270"),")")):""}function Y3(t){var e=t.orientation,n=t.range;if(!n)return[];var r=(0,F.CR)(xS(t),2),i=r[0],s=r[1],l=(0,F.CR)(n,2),u=l[0],h=l[1],p=Zp(e,u*i,0),m=Zp(e,0,u*s),y=Zp(e,h*i,i),x=Zp(e,s,h*s);return[["M",p,m],["L",p,x],["L",y,x],["L",y,m],["Z"]]}function q3(t,e){var n=ia(e,"track");t.maybeAppendByClassName(Pg.track,"path").styles((0,F.pi)({d:n_(e)},n))}function $3(t,e){var n=ia(e,"selection"),r=X3(e),i=t.maybeAppendByClassName(Pg.selection,"path").styles((0,F.pi)({d:bS(e),fill:r},n)),s=i.maybeAppendByClassName(Pg.clipPath,"path").styles({d:Y3(e)}).node();i.style("clipPath",s)}var K3=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return e.prototype.render=function(n,r){var i=Ga(r).maybeAppendByClassName(Pg.trackGroup,"g");q3(i,n);var s=Ga(r).maybeAppendByClassName(Pg.selectionGroup,"g");$3(s,n)},e}(Af);function Q3(t){return{min:Math.min.apply(Math,(0,F.ev)([],(0,F.CR)(t.map(function(e){return e.value})),!1)),max:Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(t.map(function(e){return e.value})),!1))}}var J3=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,H3)||this;return r.eventToOffsetScale=new hh({}),r.innerRibbonScale=new hh({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(i){var s=r.attributes,l=s.data,u=s.block;i.stopPropagation();var h=r.getValueByCanvasPoint(i);if(u){var p=vb(l.map(function(x){var T=x.value;return T}),h).range,m=r.getRealSelection(p);r.showIndicator((p[0]+p[1])/2,"".concat(m[0],"-").concat(m[1])),r.dispatchIndicated(h,p)}else{var y=r.getTickValue(h);r.showIndicator(y,"".concat(r.getRealValue(y))),r.dispatchIndicated(y)}},r.onDragStart=function(i){return function(s){s.stopPropagation(),r.attributes.slidable&&(r.target=i,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(s)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(i){var s=r.target;r.updateMouse();var l=(0,F.CR)(r.selection,2),u=l[0],h=l[1],p=r.getTickValue(r.getValueByCanvasPoint(i)),m=p-r.prevValue;s==="start"?u!==p&&r.updateSelection(p,h):s==="end"?h!==p&&r.updateSelection(u,p):s==="ribbon"&&m!==0&&(r.prevValue=p,r.updateSelection(m,m,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(e.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.width,i=n.height;return new yc(0,0,r,i)},e.prototype.render=function(n,r){var i=this,s=n.showLabel;this.renderTitle(Ga(r));var l=this.availableSpace,u=l.x,h=l.y,p=Ga(r).maybeAppendByClassName(Hf.contentGroup,"g").styles({transform:"translate(".concat(u,", ").concat(h,")")}),m=p.maybeAppendByClassName(Hf.labelGroup,"g").styles({zIndex:1});sd(!!s,m,function(x){i.renderLabel(x)});var y=p.maybeAppendByClassName(Hf.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=p.maybeAppendByClassName(Hf.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(y),this.renderIndicator(p),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(e.prototype,"range",{get:function(){var n=this.attributes,r=n.data,i=n.domain;return i?{min:i[0],max:i[1]}:Q3(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonScale",{get:function(){var n=this.range,r=n.min,i=n.max;return this.innerRibbonScale.update({domain:[r,i],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonRange",{get:function(){var n=(0,F.CR)(this.selection,2),r=n[0],i=n[1],s=this.ribbonScale;return[s.map(r),s.map(i)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var n=this.range,r=n.min,i=n.max,s=this.attributes.defaultValue,l=s===void 0?[r,i]:s,u=(0,F.CR)(l,2),h=u[0],p=u[1];return[h,p]},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){return Zp(this.attributes.orientation,typeof n=="function"?n():n,typeof r=="function"?r():r)},e.prototype.renderTitle=function(n){var r=this.attributes,i=r.showTitle,s=r.titleText,l=r.width,u=r.height,h=ia(this.attributes,"title"),p=(0,F.pi)((0,F.pi)({},h),{width:l,height:u,text:s}),m=this;n.selectAll(Hf.title.class).data(i?[s]:[]).join(function(y){return y.append(function(){return new Md({style:p})}).attr("className",Hf.title.name).each(function(){m.title=this})},function(y){return y.update(p)},function(y){return y.each(function(){m.title=void 0}).remove()})},Object.defineProperty(e.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var n=this.attributes,r=n.width,i=n.height;return new yc(0,0,r,i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelFixedSpacing",{get:function(){var n=this.attributes.showTick;return n?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){var n=this.attributes,r=n.orientation,i=n.labelDirection,s={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return s[r][i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelBBox",{get:function(){var n,r=this.attributes.showLabel;if(!r)return new yc(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var i=((n=this.label.querySelector(el.labelGroup.class))===null||n===void 0?void 0:n.children.slice(-1)[0]).getBBox(),s=i.width,l=i.height;return this.cacheLabelBBox=new yc(0,0,s,l),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelShape",{get:function(){var n=this.attributes,r=n.showLabel,i=n.labelSpacing,s=i===void 0?0:i;if(!r)return{width:0,height:0,size:0,length:0};var l=this.labelBBox,u=l.width,h=l.height,p=this.ifHorizontal(h,u)+s+this.labelFixedSpacing,m=this.ifHorizontal(u,h);return{width:u,height:h,size:p,length:m}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonBBox",{get:function(){var n=this.attributes,r=n.showHandle,i=n.ribbonSize,s=this.availableSpace,l=s.width,u=s.height,h=this.labelShape,p=h.size,m=h.length,y=(0,F.CR)(this.ifHorizontal([u,l],[l,u]),2),x=y[0],T=y[1],C=r?this.handleShape:{size:0,length:0},M=C.size,I=C.length,D=this.handleOffsetRatio,U=0,Z=this.labelPosition;i?U=i:["bottom","right"].includes(Z)?U=Math.min(x-p,(x-M)/D):x*(1-D)>M?U=Math.max(x-p,0):U=Math.max((x-p-M)/D,0);var G=Math.max(I,m),W=T-G,$=(0,F.CR)(this.ifHorizontal([W,U],[U,W]),2),J=$[0],nt=$[1],dt=["top","left"].includes(Z)?p:0,Et=(0,F.CR)(this.ifHorizontal([G/2,dt],[dt,G/2]),2),Pt=Et[0],Ht=Et[1];return new yc(Pt,Ht,J,nt)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonShape",{get:function(){var n=this.ribbonBBox,r=n.width,i=n.height;return this.ifHorizontal({size:i,length:r},{size:r,length:i})},enumerable:!1,configurable:!0}),e.prototype.renderRibbon=function(n){var r=this.attributes,i=r.data,s=r.type,l=r.orientation,u=r.color,h=r.block,p=ia(this.attributes,"ribbon"),m=this.range,y=m.min,x=m.max,T=this.ribbonBBox,C=T.x,M=T.y,I=this.ribbonShape,D=I.length,U=I.size,Z=Y0({transform:"translate(".concat(C,", ").concat(M,")"),length:D,size:U,type:s,orientation:l,color:u,block:h,partition:i.map(function(G){return(G.value-y)/(x-y)}),range:this.ribbonRange},p);this.ribbon=n.maybeAppendByClassName(Hf.ribbon,function(){return new K3({style:Z})}).update(Z)},e.prototype.getHandleClassName=function(n){return"".concat(Hf.prefix("".concat(n,"-handle")))},e.prototype.renderHandles=function(){var n=this.attributes,r=n.showHandle,i=n.orientation,s=ia(this.attributes,"handle"),l=(0,F.CR)(this.selection,2),u=l[0],h=l[1],p=(0,F.pi)((0,F.pi)({},s),{orientation:i}),m=s.shape,y=m===void 0?"slider":m,x=y==="basic"?_S:db,T=this;this.handlesGroup.selectAll(Hf.handle.class).data(r?[{value:u,type:"start"},{value:h,type:"end"}]:[],function(C){return C.type}).join(function(C){return C.append(function(){return new x({style:p})}).attr("className",function(M){var I=M.type;return"".concat(Hf.handle," ").concat(T.getHandleClassName(I))}).each(function(M){var I=M.type,D=M.value;this.update({labelText:D});var U="".concat(I,"Handle");T[U]=this,this.addEventListener("pointerdown",T.onDragStart(I))})},function(C){return C.update(p).each(function(M){var I=M.value;this.update({labelText:I})})},function(C){return C.each(function(M){var I=M.type,D="".concat(I,"Handle");T[D]=void 0}).remove()})},e.prototype.adjustHandles=function(){var n=(0,F.CR)(this.selection,2),r=n[0],i=n[1];this.setHandlePosition("start",r),this.setHandlePosition("end",i)},Object.defineProperty(e.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new yc(0,0,0,0);var n=this.startHandle.getBBox(),r=n.width,i=n.height,s=this.endHandle.getBBox(),l=s.width,u=s.height,h=(0,F.CR)([Math.max(r,l),Math.max(i,u)],2),p=h[0],m=h[1];return this.cacheHandleBBox=new yc(0,0,p,m),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"handleShape",{get:function(){var n=this.handleBBox,r=n.width,i=n.height,s=(0,F.CR)(this.ifHorizontal([i,r],[r,i]),2),l=s[0],u=s[1];return{width:r,height:i,size:l,length:u}},enumerable:!1,configurable:!0}),e.prototype.setHandlePosition=function(n,r){var i=this.attributes.handleFormatter,s=this.ribbonBBox,l=s.x,u=s.y,h=this.ribbonShape.size,p=this.getOffset(r),m=(0,F.CR)(this.ifHorizontal([l+p,u+h*this.handleOffsetRatio],[l+h*this.handleOffsetRatio,u+p]),2),y=m[0],x=m[1],T=this.handlesGroup.select(".".concat(this.getHandleClassName(n))).node();T==null||T.update({transform:"translate(".concat(y,", ").concat(x,")"),formatter:i})},e.prototype.renderIndicator=function(n){var r=ia(this.attributes,"indicator");this.indicator=n.maybeAppendByClassName(Hf.indicator,function(){return new T3({})}).update(r)},Object.defineProperty(e.prototype,"labelData",{get:function(){var n=this,r=this.attributes.data;return r.reduce(function(i,s,l,u){var h,p,m=(h=s==null?void 0:s.id)!==null&&h!==void 0?h:l.toString();if(i.push((0,F.pi)((0,F.pi)({},s),{id:m,index:l,type:"value",label:(p=s==null?void 0:s.label)!==null&&p!==void 0?p:s.value.toString(),value:n.ribbonScale.map(s.value)})),l<u.length-1){var y=u[l+1],x=(0,F.CR)([s.value,y.value],2),T=x[0],C=x[1],M=(T+C)/2;i.push((0,F.pi)((0,F.pi)({},s),{id:m,index:l,type:"range",range:[T,C],label:[T,C].join("~"),value:n.ribbonScale.map(M)}))}return i},[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){var n=(0,F.CR)(["center","middle"],2),r=n[0],i=n[1],s=this.labelPosition;return s==="top"?i="bottom":s==="bottom"?i="top":s==="left"?r="end":s==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:i}},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(n){var r=this.attributes,i=r.showTick,s=i===void 0?!1:i,l=r.labelFilter,u=r.labelFormatter,h=ia(this.attributes,"tick"),p=ia(this.attributes,"label"),m=p.align,y=Y0((0,F.pi)({showLine:!1,showGrid:!1,showTick:s,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),Zl(h,"tick"),Zl(p,"label"),{data:this.labelData}),x={tickFilter:function(C,M,I){return(C==null?void 0:C.type)!=="value"?!1:l?l(C,C.index,I.filter(function(D){return D.type!=="value"})):!0},labelFilter:function(C,M,I){return(C==null?void 0:C.type)!==m?!1:l?l(C,C.index,I.filter(function(D){return D.type===m})):!0},labelFormatter:u},T=(0,F.pi)((0,F.pi)((0,F.pi)({},y),x),{labelOverlap:[{type:"hide"}]});this.label=n.maybeAppendByClassName(Hf.label,function(){return new c1({style:T})}).node(),this.label.update(T,!1)},Object.defineProperty(e.prototype,"labelAxisStyle",{get:function(){var n=this.attributes,r=n.showTick,i=n.labelDirection,s=n.labelSpacing,l=n.tickLength,u=this.ribbonShape.size,h=this.labelPosition,p=this.labelFixedSpacing,m=(0,F.CR)([0,0,0],3),y=m[0],x=m[1],T=m[2],C=l!=null?l:u;return r?(T=C,x=p,i==="positive"?h==="right"?(y=C,T=C):h==="bottom"&&(y=T):i==="negative"&&(h==="top"||h==="left")&&(y=u)):i==="positive"?h==="right"?x=C:h==="bottom"&&(y=u+p,x=s):i==="negative"&&(h==="left"||h==="top")&&(x=s),{offset:y,spacing:x,tickLength:T}},enumerable:!1,configurable:!0}),e.prototype.adjustLabel=function(){var n=this.attributes.showLabel;if(n){var r=this.ribbonBBox,i=r.x,s=r.y,l=r.width,u=r.height,h=this.labelAxisStyle,p=h.offset,m=h.spacing,y=h.tickLength,x=(0,F.CR)(this.ifHorizontal([[i,s+p],[i+l,s+p]],[[i+p,s+u],[i+p,s]]),2),T=x[0],C=x[1];this.label.update({startPos:T,endPos:C,tickLength:y,labelSpacing:m},!1)}},e.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},e.prototype.showIndicator=function(n,r){r===void 0&&(r="".concat(n));var i=this.attributes.showIndicator;if(!i||typeof n!="number"){this.hideIndicator();return}var s=this.range,l=s.min,u=s.max,h=this.ribbonBBox,p=h.x,m=h.y,y=(0,uo.Z)(n,l,u),x=this.getOffset(y),T=this.ifHorizontal([x+p,m],[p,x+m]);this.indicator.update({x:T[0],y:T[1],position:this.ifHorizontal("top","left"),labelText:r}),Iy(this.indicator.node())},e.prototype.hideIndicator=function(){Dm(this.indicator.node())},e.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},e.prototype.setSelection=function(n,r){this.updateSelection(n,r)},e.prototype.updateSelection=function(n,r,i){var s;i===void 0&&(i=!1);var l=(0,F.CR)(this.selection,2),u=l[0],h=l[1],p=(0,F.CR)([n,r],2),m=p[0],y=p[1];i&&(m+=u,y+=h);var x=this.range,T=x.min,C=x.max;s=(0,F.CR)(Z3([T,C],[m,y],this.selection),2),m=s[0],y=s[1],this.update({defaultValue:[m,y]}),this.dispatchSelection()},Object.defineProperty(e.prototype,"step",{get:function(){var n=this.attributes.step,r=n===void 0?1:n,i=this.range,s=i.min,l=i.max;return Jr(r)?$y((l-s)*G3,0):r},enumerable:!1,configurable:!0}),e.prototype.getTickValue=function(n){var r=this.attributes,i=r.data,s=r.block,l=this.range.min;return s?vb(i.map(function(u){var h=u.value;return h}),n).tick:j3(n,this.step,l)},e.prototype.getValueByCanvasPoint=function(n){var r=this.range,i=r.min,s=r.max,l=(0,F.CR)(this.ribbon.node().getPosition(),2),u=l[0],h=l[1],p=this.ifHorizontal(u,h),m=this.ifHorizontal.apply(this,(0,F.ev)([],(0,F.CR)(E1(n)),!1)),y=m-p,x=(0,uo.Z)(this.getOffset(y,!0),i,s);return x},e.prototype.getOffset=function(n,r){r===void 0&&(r=!1);var i=this.range,s=i.min,l=i.max,u=this.ribbonShape.length,h=this.eventToOffsetScale;return h.update({domain:[s,l],range:[0,u]}),r?h.invert(n):h.map(n)},e.prototype.getRealSelection=function(n){var r=this.range.max,i=(0,F.CR)(n,2),s=i[0],l=i[1];return this.ifHorizontal([s,l],[r-l,r-s])},e.prototype.getRealValue=function(n){var r=this.range.max;return this.ifHorizontal(n,r-n)},e.prototype.dispatchSelection=function(){var n=this.getRealSelection(this.selection),r=new tl("valuechange",{detail:{value:n}});this.dispatchEvent(r)},e.prototype.dispatchIndicated=function(n,r){var i=this,s=this.range.max,l=this.ifHorizontal(function(){return{value:n,range:r}},function(){return{value:s-n,range:r?i.getRealSelection(r):void 0}}),u=new tl("indicate",{detail:l});this.dispatchEvent(u)},e}(Af);class r_ extends Zy{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:Mv}}map(e){const[n]=this.options.range;return n!==void 0?n:this.options.unknown}invert(e){const[n]=this.options.range;return e===n&&n!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:e,domain:n,tickCount:r}=this.options,[i,s]=n;return!(0,ge.Z)(i)||!(0,ge.Z)(s)?[]:e(i,s,r)}clone(){return new r_(this.options)}}class Ig extends Zy{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(e){super(e)}map(e){if(!d1(e))return this.options.unknown;const n=tb(this.thresholds,e,0,this.n);return this.options.range[n]}invert(e){const{range:n}=this.options,r=n.indexOf(e),i=this.thresholds;return[i[r-1],i[r]]}clone(){return new Ig(this.options)}rescale(){const{domain:e,range:n}=this.options;this.n=Math.min(e.length,n.length-1),this.thresholds=e}}function Lg(t){return(0,tr.Z)(t)?0:ap(t)?t.length:Object.keys(t).length}var ES=function(t,e){if(!ap(t))return-1;var n=Array.prototype.indexOf;if(n)return n.call(t,e);for(var r=-1,i=0;i<t.length;i++)if(t[i]===e){r=i;break}return r},gb=ES;function i_(t){return Math.abs(t)<1e-14?t:parseFloat(t.toFixed(14))}const tO=[1,5,2,2.5,4,3],BP=null,yb=Number.EPSILON*100;function eO(t,e){return(t%e+e)%e}function nO(t){return Math.round(t*1e12)/1e12}function SS(t,e,n,r,i,s){const l=Lg(e),u=gb(e,t);let h=0;const p=eO(r,s);return(p<yb||s-p<yb)&&r<=0&&i>=0&&(h=1),1-u/(l-1)-n+h}function Iv(t,e,n){const r=Lg(e);return 1-gb(e,t)/(r-1)-n+1}function rO(t,e,n,r,i,s){const l=(t-1)/(s-i),u=(e-1)/(Math.max(s,r)-Math.min(n,i));return 2-Math.max(l/u,u/l)}function iO(t,e){return t>=e?2-(t-1)/(e-1):1}function oO(t,e,n,r){const i=e-t;return 1-.5*(vf(e-r,2)+vf(t-n,2))/vf(.1*i,2)}function TS(t,e,n){const r=e-t;if(n>r){const i=(n-r)/2;return 1-vf(i,2)/vf(.1*r,2)}return 1}function aO(){return 1}const _b=(t,e,n=5,r=!0,i=tO,s=[.25,.2,.5,.05])=>{const l=n<0?0:Math.round(n);if(Number.isNaN(t)||Number.isNaN(e)||typeof t!="number"||typeof e!="number"||!l)return[];if(e-t<1e-15||l===1)return[t];const u={score:-2,lmin:0,lmax:0,lstep:0};let h=1;for(;h<1/0;){for(let C=0;C<i.length;C+=1){const M=i[C],I=Iv(M,i,h);if(s[0]*I+s[1]+s[2]+s[3]<u.score){h=1/0;break}let D=2;for(;D<1/0;){const U=iO(D,l);if(s[0]*I+s[1]+s[2]*U+s[3]<u.score)break;const Z=(e-t)/(D+1)/h/M;let G=Math.ceil(Math.log10(Z));for(;G<1/0;){const W=h*M*vf(10,G),$=TS(t,e,W*(D-1));if(s[0]*I+s[1]*$+s[2]*U+s[3]<u.score)break;const J=Math.floor(e/W)*h-(D-1)*h,nt=Math.ceil(t/W)*h;if(J<=nt){const dt=nt-J;for(let Et=0;Et<=dt;Et+=1){const Ht=(J+Et)*(W/h),Ct=Ht+W*(D-1),Ft=W,jt=SS(M,i,h,Ht,Ct,Ft),qt=oO(t,e,Ht,Ct),Ee=rO(D,l,t,e,Ht,Ct),oe=aO(),_e=s[0]*jt+s[1]*qt+s[2]*Ee+s[3]*oe;_e>u.score&&(!r||Ht<=t&&Ct>=e)&&(u.lmin=Ht,u.lmax=Ct,u.lstep=Ft,u.score=_e)}}G+=1}D+=1}}h+=1}const p=i_(u.lmax),m=i_(u.lmin),y=i_(u.lstep),x=Math.floor(nO((p-m)/y))+1,T=new Array(x);T[0]=i_(m);for(let C=1;C<x;C+=1)T[C]=i_(T[C-1]+y);return T};class Dg extends Ig{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:_b}}constructor(e){super(e)}nice(){const{nice:e}=this.options;if(e){const[n,r,i]=this.getTickMethodOptions();this.options.domain=KE(n,r,i)}}getTicks(){const{tickMethod:e}=this.options,[n,r,i]=this.getTickMethodOptions();return e(n,r,i)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],i=e[e.length-1];return[r,i,n]}rescale(){this.nice();const{range:e,domain:n}=this.options,[r,i]=n;this.n=e.length-1,this.thresholds=new Array(this.n);for(let s=0;s<this.n;s+=1)this.thresholds[s]=((s+1)*i-(s-this.n)*r)/(this.n+1)}invert(e){const[n,r]=super.invert(e),[i,s]=this.options.domain;return n===void 0&&r===void 0?[n,r]:[n||i,r||s]}getThresholds(){return this.thresholds}clone(){return new Dg(this.options)}}function T1(t,e){const n=t.length;if(!n)return;if(n<2)return t[n-1];const r=(n-1)*e,i=Math.floor(r),s=t[i],l=t[i+1];return s+(l-s)*(r-i)}function sO(t,e,n=!1){const r=t;n||r.sort((s,l)=>s-l);const i=[];for(let s=1;s<e;s+=1)i.push(T1(r,s/e));return i}class Ng extends Ig{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:_b}}constructor(e){super(e)}rescale(){const{domain:e,range:n}=this.options;this.n=n.length-1,this.thresholds=sO(e,this.n+1,!1)}invert(e){const[n,r]=super.invert(e),{domain:i}=this.options,s=i[0],l=i[i.length-1];return n===void 0&&r===void 0?[n,r]:[n||s,r||l]}getThresholds(){return this.thresholds}clone(){return new Ng(this.options)}getTicks(){const{tickCount:e,domain:n,tickMethod:r}=this.options,i=n.length-1,s=n[0],l=n[i];return r(s,l,e)}}var lO=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function cO(t,e,n){return t.size=e,Yy(n)?t.height=e:t.width=e,t}function uO(t,e,n){const{size:r}=e,i=nS(t,e,n);return cO(i,r,i.orientation)}function fO(t){return e=>({value:e/t,label:String(e)})}function wS(t,e,n,r,i){const s=e.thresholds,l=fO(r);return Object.assign(Object.assign({},t),{color:i,data:[n,...s,r].map(l)})}function hO(t,e,n){const i=[-1/0,...e.thresholds,1/0].map((s,l)=>({value:l,label:s}));return Object.assign(Object.assign({},t),{data:i,color:n,labelFilter:(s,l)=>l>0&&l<i.length-1})}function xb(t){const{domain:e}=t.getOptions(),[n,r]=[e[0],fE(e)];return[n,r]}function AS(t,e){const n=t.getOptions(),r=t.clone();return r.update(Object.assign(Object.assign({},n),{range:[$h(e).toString()]})),r}function dO(t,e,n,r,i,s){const{length:l}=t,u=n||r,h=i.color?s.legendContinuous.ribbonFill||"black":s.color,p=e||AS(u,h),[m,y]=xb(p),[x,T]=xb([e,n,r].filter(C=>C!==void 0).find(C=>!(C instanceof r_)));return Object.assign(Object.assign({},t),{domain:[x,T],data:p.getTicks().map(C=>({value:C})),color:new Array(Math.floor(l)).fill(0).map((C,M)=>{const I=(y-m)/(l-1)*M+m,D=p.map(I)||h,U=r?r.map(I):1;return D.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(Z,G,W,$)=>`rgba(${G}, ${W}, ${$}, ${U})`)})})}function pO(t,e,n,r,i,s){const l=Pd(t,"color"),u=uO(n,r,i);if(l instanceof Ig){const{range:m}=l.getOptions(),[y,x]=xb(l);return l instanceof Dg||l instanceof Ng?wS(u,l,y,x,m):hO(u,l,m)}const h=Pd(t,"size"),p=Pd(t,"opacity");return dO(u,l,h,p,e,s)}const fp=t=>{const{labelFormatter:e,layout:n,order:r,orientation:i,position:s,size:l,title:u,style:h,crossPadding:p,padding:m}=t,y=lO(t,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:x,value:T,theme:C,scale:M})=>{const{bbox:I}=T,{x:D,y:U,width:Z,height:G}=I,W=Pv(s,n),{legendContinuous:$={}}=C,J=x1(Object.assign({},$,Object.assign(Object.assign({titleText:y1(u),labelAlign:"value",labelFormatter:typeof e=="string"?dt=>Lm(e)(dt.label):e},pO(x,M,T,t,fp,C)),h),y)),nt=new Xy({style:Object.assign(Object.assign({x:D,y:U,width:Z,height:G},W),{subOptions:J})});return nt.appendChild(new J3({className:"legend-continuous",style:J})),nt}};fp.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]};const OS=t=>(...e)=>fp(Object.assign({},{block:!0},t))(...e);OS.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const CS=t=>e=>{const{scales:n}=e,r=Pd(n,"size");return fp(Object.assign({},{type:"size",data:r.getTicks().map((i,s)=>({value:i,label:String(i)}))},t))(e)};CS.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const a=t=>CS(Object.assign({},{block:!0},t));a.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const f=({static:t=!1}={})=>e=>{const{width:n,height:r,depth:i,paddingLeft:s,paddingRight:l,paddingTop:u,paddingBottom:h,padding:p,inset:m,insetLeft:y,insetTop:x,insetRight:T,insetBottom:C,margin:M,marginLeft:I,marginBottom:D,marginTop:U,marginRight:Z,data:G,coordinate:W,theme:$,component:J,interaction:nt,x:dt,y:Et,z:Pt,key:Ht,frame:Ct,labelTransform:Ft,parentKey:jt,clip:qt,viewStyle:Ee,title:oe}=e,_e=o(e,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:dt,y:Et,z:Pt,key:Ht,width:n,height:r,depth:i,padding:p,paddingLeft:s,paddingRight:l,paddingTop:u,inset:m,insetLeft:y,insetTop:x,insetRight:T,insetBottom:C,paddingBottom:h,theme:$,coordinate:W,component:J,interaction:nt,frame:Ct,labelTransform:Ft,margin:M,marginLeft:I,marginBottom:D,marginTop:U,marginRight:Z,parentKey:jt,clip:qt,style:Ee},!t&&{title:oe}),{marks:[Object.assign(Object.assign(Object.assign({},_e),{key:`${Ht}-0`,data:G}),t&&{title:oe})]})]};f.props={};var v=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function S(t){return(e,...n)=>ti({},t(e,...n),e)}function O(t){return(e,...n)=>ti({},e,t(e,...n))}function L(t){return t instanceof Date?!1:typeof t=="object"}function k(t,e){if(!t)return e;if(Array.isArray(t))return t;if(L(t)){const{value:n=e}=t,r=v(t,["value"]);return Object.assign(Object.assign({},r),{value:n})}return t}var V=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Q=()=>t=>{const{children:e}=t,n=V(t,["children"]);if(!Array.isArray(e))return[];const{data:r,scale:i={},axis:s={},legend:l={},encode:u={},transform:h=[]}=n,p=V(n,["data","scale","axis","legend","encode","transform"]),m=e.map(y=>{var{data:x,scale:T={},axis:C={},legend:M={},encode:I={},transform:D=[]}=y,U=V(y,["data","scale","axis","legend","encode","transform"]);return Object.assign({data:k(x,r),scale:ti({},i,T),encode:ti({},u,I),transform:[...h,...D],axis:C&&s?ti({},s,C):!1,legend:M&&l?ti({},l,M):!1},U)});return[Object.assign(Object.assign({},p),{marks:m,type:"standardView"})]};Q.props={};function st([t,e],[n,r]){return[t-n,e-r]}function ft([t,e],[n,r]){return[t+n,e+r]}function Tt([t,e],[n,r]){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))}function se([t,e]){return Math.atan2(e,t)}function Ve([t,e]){return se([t,e])+Math.PI/2}function yn(t,e){const n=se(t),r=se(e);return n<r?r-n:Math.PI*2-(n-r)}function lr(t){let e=1/0,n=-1/0,r=1/0,i=-1/0;for(const[u,h]of t)e=Math.min(u,e),n=Math.max(u,n),r=Math.min(h,r),i=Math.max(h,i);const s=n-e,l=i-r;return[e,r,s,l]}function Nr([t,e],[n,r]){return[(t+n)/2,(e+r)/2]}function Ln(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function ci(t,e){return e.forEach((n,r)=>r===0?t.moveTo(n[0],n[1]):t.lineTo(n[0],n[1])),t.closePath(),t}function Fi(t,e,n){const{arrowSize:r}=n,i=typeof r=="string"?+parseFloat(r)/100*Tt(t,e):r,s=Math.PI/6,l=Math.atan2(e[1]-t[1],e[0]-t[0]),u=Math.PI/2-l-s,h=[e[0]-i*Math.sin(u),e[1]-i*Math.cos(u)],p=l-s,m=[e[0]-i*Math.cos(p),e[1]-i*Math.sin(p)];return[h,m]}function So(t,e,n,r,i){const s=se(st(r,e))+Math.PI,l=se(st(r,n))+Math.PI;return t.arc(r[0],r[1],i,s,l,l-s<0),t}function Ji(t,e,n,r="y",i="between",s=!1){const l=(I,D)=>I==="y"||I===!0?D?180:90:D?90:0,u=r==="y"||r===!0?n:e,h=l(r,s),p=wv(u),[m,y]=S0(p,I=>u[I]),x=new hh({domain:[m,y],range:[0,100]}),T=I=>(0,ge.Z)(u[I])&&!Number.isNaN(u[I])?x.map(u[I]):0,C={between:I=>`${t[I]} ${T(I)}%`,start:I=>I===0?`${t[I]} ${T(I)}%`:`${t[I-1]} ${T(I)}%, ${t[I]} ${T(I)}%`,end:I=>I===t.length-1?`${t[I]} ${T(I)}%`:`${t[I]} ${T(I)}%, ${t[I+1]} ${T(I)}%`},M=p.sort((I,D)=>T(I)-T(D)).map(C[i]||C.between).join(",");return`linear-gradient(${h}deg, ${M})`}function Vr(t){const[e,n,r,i]=t;return[i,e,n,r]}function Hi(t,e,n){const[r,i,,s]=gc(t)?Vr(e):e,[l,u]=n,h=t.getCenter(),p=Ve(st(r,h)),m=Ve(st(i,h)),y=m===p&&l!==u?m+Math.PI*2:m;return{startAngle:p,endAngle:y-p>=0?y:Math.PI*2+y,innerRadius:Tt(s,h),outerRadius:Tt(r,h)}}function za(t){const e="connect";return Object.fromEntries(Object.entries(t).filter(([n])=>n.startsWith(e)).map(([n,r])=>[lowerFirst(n.replace(e,"").trim()),r]).filter(([n])=>n!==void 0))}function ps(t){const{colorAttribute:e,opacityAttribute:n=e}=t;return`${n}Opacity`}function Wo(t,e){if(!Ml(t))return"";const n=t.getCenter(),{transform:r}=e;return`translate(${n[0]}, ${n[1]}) ${r||""}`}function as(t){if(t.length===1)return t[0];const[[e,n,r=0],[i,s,l=0]]=t;return[(e+i)/2,(n+s)/2,(r+l)/2]}function Zs(t){return t.replace(/-(\w)/g,function(e,n){return n.toUpperCase()})}function Dh(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}var Id=Array.prototype.slice;function Nh(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ll(t){return function(){return t}}function J0(t){this._context=t}J0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Gf(t){return new J0(t)}const Lv=Math.PI,bb=2*Lv,Dv=1e-6,mO=bb-Dv;function RS(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function vO(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return RS;const n=vf(10,e);return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class w1{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?RS:vO(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,u=this._y1,h=r-e,p=i-n,m=l-e,y=u-n,x=m*m+y*y;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(x>Dv)if(!(Math.abs(y*h-p*m)>Dv)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let T=r-l,C=i-u,M=h*h+p*p,I=T*T+C*C,D=Math.sqrt(M),U=Math.sqrt(x),Z=s*Math.tan((Lv-Math.acos((M+x-I)/(2*D*U)))/2),G=Z/U,W=Z/D;Math.abs(G-1)>Dv&&this._append`L${e+G*m},${n+G*y}`,this._append`A${s},${s},0,0,${+(y*T>m*C)},${this._x1=e+W*h},${this._y1=n+W*p}`}}arc(e,n,r,i,s,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),h=r*Math.sin(i),p=e+u,m=n+h,y=1^l,x=l?i-s:s-i;this._x1===null?this._append`M${p},${m}`:(Math.abs(this._x1-p)>Dv||Math.abs(this._y1-m)>Dv)&&this._append`L${p},${m}`,r&&(x<0&&(x=x%bb+bb),x>mO?this._append`A${r},${r},0,1,${y},${e-u},${n-h}A${r},${r},0,1,${y},${this._x1=p},${this._y1=m}`:x>Dv&&this._append`A${r},${r},0,${+(x>=Lv)},${y},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function hp(){return new w1}hp.prototype=w1.prototype;function FP(t=3){return new w1(+t)}function oa(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new w1(e)}function Hs(t){return t[0]}function cl(t){return t[1]}function ro(t,e){var n=ll(!0),r=null,i=Gf,s=null,l=oa(u);t=typeof t=="function"?t:t===void 0?Hs:ll(t),e=typeof e=="function"?e:e===void 0?cl:ll(e);function u(h){var p,m=(h=Nh(h)).length,y,x=!1,T;for(r==null&&(s=i(T=l())),p=0;p<=m;++p)!(p<m&&n(y=h[p],p,h))===x&&((x=!x)?s.lineStart():s.lineEnd()),x&&s.point(+t(y,p,h),+e(y,p,h));if(T)return s=null,T+""||null}return u.x=function(h){return arguments.length?(t=typeof h=="function"?h:ll(+h),u):t},u.y=function(h){return arguments.length?(e=typeof h=="function"?h:ll(+h),u):e},u.defined=function(h){return arguments.length?(n=typeof h=="function"?h:ll(!!h),u):n},u.curve=function(h){return arguments.length?(i=h,r!=null&&(s=i(r)),u):i},u.context=function(h){return arguments.length?(h==null?r=s=null:s=i(r=h),u):r},u}function df(t){const e=typeof t=="function"?t:t.render;return class extends Wr{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){e(this)}}}var Jl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Ld(t){const{min:[e,n],max:[r,i]}=t.getLocalBounds();let s=0,l=0;return e>0&&(s=e),r<0&&(s=r),n>0&&(l=n),i<0&&(l=i),[s,l]}function Dd(t,e=[]){const[n=0,r=0,i=n,s=r]=e,l=t.parentNode,u=l.getEulerAngles();l.setEulerAngles(0);const{min:h,halfExtents:p}=t.getLocalBounds(),[m,y]=h,[x,T]=p;return l.setEulerAngles(u),{x:m-s,y:y-n,width:x*2+s+r,height:T*2+n+i}}const kg=(t,e,n)=>{const r=dist(t,e),i=dist(e,n),s=dist(n,t);return(Math.pow(r,2)+Math.pow(i,2)-Math.pow(s,2))/(2*r*i)};function MS(t,e,n,r,i=!0,s=!0){const l=y=>ro()(y);if(!e[0]&&!e[1])return l([Ld(t),e]);if(!n.length)return l([[0,0],e]);const[u,h]=n,p=[...h],m=[...u];if(h[0]!==u[0]){const y=i?-4:4;p[1]=h[1],s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y))),s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y)))}return l([h,p,m,u,e])}const UP=df(t=>{const e=t.attributes,{className:n,class:r,transform:i,rotate:s,labelTransform:l,labelTransformOrigin:u,x:h,y:p,x0:m=h,y0:y=p,text:x,background:T,connector:C,startMarker:M,endMarker:I,coordCenter:D,innerHTML:U}=e,Z=Jl(e,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(t.style.transform=`translate(${h}, ${p})`,[h,p,m,y].some(oe=>!(0,ge.Z)(oe))){t.children.forEach(oe=>oe.remove());return}const G=ho(Z,"background"),{padding:W}=G,$=Jl(G,["padding"]),J=ho(Z,"connector"),{points:nt=[]}=J,dt=Jl(J,["points"]);let Et;U?Et=Ra(t).maybeAppend("html","html",n).style("zIndex",0).style("innerHTML",U).call(Ln,Object.assign({transform:l,transformOrigin:u},Z)).node():Et=Ra(t).maybeAppend("text","text").style("zIndex",0).style("text",x).call(Ln,Object.assign({textBaseline:"middle",transform:l,transformOrigin:u},Z)).node();const Pt=Ra(t).maybeAppend("background","rect").style("zIndex",-1).call(Ln,Dd(Et,W)).call(Ln,T?$:{}).node(),Ht=+m<D[0],Ct=+y<D[1],Ft=[+m-+h,+y-+p],jt=MS(Pt,Ft,nt,D,Ht,Ct),qt=M&&new dl({id:"startMarker",style:Object.assign({x:0,y:0},ho(Z,"startMarker"))}),Ee=I&&new dl({id:"endMarker",style:Object.assign({x:0,y:0},ho(Z,"endMarker"))});Ra(t).maybeAppend("connector","path").style("zIndex",0).style("d",jt).style("markerStart",qt).style("markerEnd",Ee).call(Ln,C?dt:{})});function A1(t,e){let n,r=-1,i=-1;if(e===void 0)for(const s of t)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of t)(s=e(s,++i,t))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function A8(t,e,n,r){const i=e.length/2,s=e.slice(0,i),l=e.slice(i);let u=A1(s,(T,C)=>Math.abs(T[1]-l[C][1]));u=Math.max(Math.min(u,i-2),1);const h=T=>[s[T][0],(s[T][1]+l[T][1])/2],p=h(u),m=h(u-1),y=h(u+1),x=se(st(y,m))/Math.PI*180;return{x:p[0],y:p[1],transform:`rotate(${x})`,textAlign:"center",textBaseline:"middle"}}function zP(t,e,n,r){const{bounds:i}=n,[[s,l],[u,h]]=i,p=u-s,m=h-l,y=x=>{const{x:T,y:C}=x,M=iE(n.x,p),I=iE(n.y,m);return Object.assign(Object.assign({},x),{x:(M||T)+s,y:(I||C)+l})};return y(t==="left"?{x:0,y:m/2,textAlign:"start",textBaseline:"middle"}:t==="right"?{x:p,y:m/2,textAlign:"end",textBaseline:"middle"}:t==="top"?{x:p/2,y:0,textAlign:"center",textBaseline:"top"}:t==="bottom"?{x:p/2,y:m,textAlign:"center",textBaseline:"bottom"}:t==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:t==="top-right"?{x:p,y:0,textAlign:"end",textBaseline:"top"}:t==="bottom-left"?{x:0,y:m,textAlign:"start",textBaseline:"bottom"}:t==="bottom-right"?{x:p,y:m,textAlign:"end",textBaseline:"bottom"}:{x:p/2,y:m/2,textAlign:"center",textBaseline:"middle"})}function jP(t,e,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u}=n,h=r.getCenter(),p=Hi(r,e,[i,s]),{innerRadius:m,outerRadius:y,startAngle:x,endAngle:T}=p,C=t==="inside"?(x+T)/2:T,M=gO(C,l,u),I=(()=>{const[D,U]=e,Z=m+(y-m)*.5,[G,W]=t==="inside"?Eb(h,C,Z):Nr(D,U);return{x:G,y:W}})();return Object.assign(Object.assign({},I),{textAlign:t==="inside"?"center":"start",textBaseline:"middle",rotate:M})}function Eb(t,e,n){return[t[0]+Math.sin(e)*n,t[1]-Math.cos(e)*n]}function gO(t,e,n){if(!e)return 0;const r=n?0:Math.sin(t)<0?90:-90;return t/Math.PI*180+r}function O8(t,e,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u,radius:h=.5,offset:p=0}=n,m=Hi(r,e,[i,s]),{startAngle:y,endAngle:x}=m,T=r.getCenter(),C=(y+x)/2,I={textAlign:"center",textBaseline:"middle",rotate:gO(C,l,u)},{innerRadius:D,outerRadius:U}=m,G=D+(U-D)*h+p,[W,$]=Eb(T,C,G);return Object.assign({x:W,y:$},I)}function VP(t){return t===void 0?null:t}function ZP(t,e,n,r){const{bounds:i}=n,[s]=i;return{x:VP(s[0]),y:VP(s[1])}}function Nv(t,e,n,r){const{bounds:i}=n;return i.length===1?ZP(t,e,n,r):(My(r)?jP:yg(r)?O8:zP)(t,e,n,r)}function C8(t,e,n,r,i){const[s,l]=Eb(t,e,n),[u,h]=Eb(t,e,r),p=Math.sin(e)>0?1:-1;return[[s,l],[u,h],[u+p*i,h]]}function HP(t,e,n){const r=Hi(n,t,[e.y,e.y1]),{innerRadius:i,outerRadius:s}=r;return i+(s-i)}function GP(t,e,n){const r=Hi(n,t,[e.y,e.y1]),{startAngle:i,endAngle:s}=r;return(i+s)/2}function yO(t,e,n,r){const{autoRotate:i,rotateToAlignArc:s,offset:l=0,connector:u=!0,connectorLength:h=l,connectorLength2:p=0,connectorDistance:m=0}=n,y=r.getCenter(),x=GP(e,n,r),T=Math.sin(x)>0?1:-1,C=gO(x,i,s),M={textAlign:T>0||My(r)?"start":"end",textBaseline:"middle",rotate:C},I=HP(e,n,r),D=I+(u?h:l),[[U,Z],[G,W],[$,J]]=C8(y,x,I,D,u?p:0),nt=u?+m*T:0,dt=$+nt,Et=J,Pt={connector:u,connectorPoints:[[G-dt,W-Et],[$-dt,J-Et]]};return Object.assign(Object.assign({x0:U,y0:Z,x:$+nt,y:J},M),Pt)}function R8(t,e,n,r){const{bounds:i}=n;return i.length===1?ZP(t,e,n,r):(My(r)?jP:yg(r)?yO:zP)(t,e,n,r)}function Tu(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function M8(t,e){return Array.from(e,n=>t[n])}function tm(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const r=Uint32Array.from(t,(i,s)=>s);return e.length>1?(e=e.map(i=>t.map(i)),r.sort((i,s)=>{for(const l of e){const u=Sb(l[i],l[s]);if(u)return u}})):(n=t.map(n),r.sort((i,s)=>Sb(n[i],n[s]))),M8(t,r)}return t.sort(WP(n))}function WP(t=Tu){if(t===Tu)return Sb;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Sb(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function XP(t,e={}){const{labelHeight:n=14,height:r}=e,i=tm(t,p=>p.y),s=i.length,l=new Array(s);for(let p=0;p<s;p++){const m=i[p],{y}=m;l[p]={y,y1:y+n,labels:[y]}}let u=!0;for(;u;){u=!1;for(let p=l.length-1;p>0;p--){const m=l[p],y=l[p-1];if(y.y1>m.y){u=!0,y.labels.push(...m.labels),l.splice(p,1),y.y1+=m.y1-m.y;const x=y.y1-y.y;y.y1=Math.max(Math.min(y.y1,r),x),y.y=y.y1-x}}}let h=0;for(const p of l){const{y:m,labels:y}=p;let x=m-n;for(const T of y){const C=i[h++],I=x+n-T;C.connectorPoints[0][1]-=I,C.y=x+n,x+=n}}}function YP(t,e){const n=tm(t,u=>u.y),{height:r,labelHeight:i=14}=e,s=Math.ceil(r/i);if(n.length<=s)return XP(n,e);const l=[];for(let u=0;u<n.length;u++)u<n.length-s?(n[u].opacity=0,n[u].connector=!1):l.push(n[u]);XP(l,e)}var P8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const PS=new WeakMap;function I8(t,e,n){const{connectorLength:r,connectorLength2:i,connectorDistance:s}=e,l=P8(yO("outside",t,e,n),[]),u=n.getCenter(),h=HP(t,e,n),p=GP(t,e,n),m=h+r+i,y=Math.sin(p)>0?1:-1,x=u[0]+(m+ +s)*y,{x:T}=l,C=x-T;return l.x+=C,l.connectorPoints[0][0]-=C,l}function L8(t,e,n,r,i,s){if(!yg(r))return{};if(PS.has(e))return PS.get(e);const l=s.map(x=>I8(x,n,r)),{width:u,height:h}=r.getOptions(),p=l.filter(x=>x.x<u/2),m=l.filter(x=>x.x>=u/2),y=Object.assign(Object.assign({},i),{height:h});return YP(p,y),YP(m,y),l.forEach((x,T)=>PS.set(s[T],x)),PS.get(e)}var D8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function N8(t,e,n,r){if(!yg(r))return{};const{connectorLength:i,connectorLength2:s,connectorDistance:l}=n,u=D8(yO("outside",e,n,r),[]),{x0:h,y0:p}=u,m=r.getCenter(),x=EA(r)+i,T=Ve([h-m[0],p-m[1]]),C=Math.sin(T)>0?1:-1,[M,I]=Eb(m,T,x);return u.x=M+(s+l)*C,u.y=I,u}var qP=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function k8(t,e){return t!==void 0?t:yg(e)?"inside":gc(e)?"right":"top"}function B8(t,e,n,r,i,s){const{position:l}=e,{render:u}=i,h=k8(l,n),m=r[u?"htmlLabel":h==="inside"?"innerLabel":"label"],y=Object.assign({},m,e),x=ne[Zs(h)];if(!x)throw new Error(`Unknown position: ${h}`);return Object.assign(Object.assign({},m),x(h,t,y,n,i,s))}const $P=(t,e)=>{const{coordinate:n,theme:r}=e,{render:i}=t;return(s,l,u,h)=>{const{text:p,x:m,y,transform:x="",transformOrigin:T,className:C=""}=l,M=qP(l,["text","x","y","transform","transformOrigin","className"]),I=B8(s,l,n,r,t,h),{rotate:D=0,transform:U=""}=I,Z=qP(I,["rotate","transform"]);return Ra(new UP).call(Ln,Z).style("text",`${p}`).style("className",`${C} g2-label`).style("innerHTML",i?i(p,l.datum,l.index):void 0).style("labelTransform",`${U} rotate(${+D}) ${x}`.trim()).style("labelTransformOrigin",T).style("coordCenter",n.getCenter()).call(Ln,M).node()}};$P.props={defaultMarker:"point"};var F8=function(t,e){if(!ap(t))return t;for(var n=[],r=0;r<t.length;r++){var i=t[r];e(i,r)&&n.push(i)}return n},KP=F8;function U8(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Bg(t){let e,n,r;t.length!==2?(e=Tu,n=(u,h)=>Tu(t(u),h),r=(u,h)=>t(u)-h):(e=t===Tu||t===U8?t:z8,n=t,r=t);function i(u,h,p=0,m=u.length){if(p<m){if(e(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<0?p=y+1:m=y}while(p<m)}return p}function s(u,h,p=0,m=u.length){if(p<m){if(e(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<=0?p=y+1:m=y}while(p<m)}return p}function l(u,h,p=0,m=u.length){const y=i(u,h,p,m-1);return y>p&&r(u[y-1],h)>-r(u[y],h)?y-1:y}return{left:i,center:l,right:s}}function z8(){return 0}function _O(t){return t===null?NaN:+t}function*j8(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const QP=Bg(Tu),V8=QP.right,Z8=QP.left,H8=Bg(_O).center;var G8=V8;function W8(t,e,n){return Math.min(n,Math.max(e,t))}function Tb(t){return!!t.getBandWidth}function O1(t,e,n){if(!Tb(t))return t.invert(e);const{adjustedRange:r}=t,{domain:i}=t.getOptions(),s=n?-1:0,l=t.getStep(),u=n?r:r.map(m=>m+l),h=Z8(u,e),p=W8(h+s,0,i.length-1);return i[p]}function Fg(t,e,n){if(!e)return t.getOptions().domain;if(!Tb(t)){const h=tm(e);if(!n)return h;const[p]=h,{range:m}=t.getOptions(),[y,x]=m,T=y>x?-1:1,C=t.invert(t.map(p)+T*n);return[p,C]}const{domain:r}=t.getOptions(),i=e[0],s=r.indexOf(i);if(n){const h=s+Math.round(r.length*n);return r.slice(s,h)}const l=e[e.length-1],u=r.indexOf(l);return r.slice(s,u+1)}function IS(t,e,n,r,i,s){const{x:l,y:u}=i,h=(T,C)=>{const[M,I]=s.invert(T);return[O1(l,M,C),O1(u,I,C)]},p=h([t,e],!0),m=h([n,r],!1),y=Fg(l,[p[0],m[0]]),x=Fg(u,[p[1],m[1]]);return[y,x]}function LS(t,e){const[n,r]=t,i=s=>s.getStep?s.getStep():0;return[e.map(n),e.map(r)+i(e)]}function X8(t,e,n){const{x:r,y:i}=e,[s,l]=t,u=LS(s,r),h=LS(l,i),p=[u[0],h[0]],m=[u[1],h[1]],[y,x]=n.map(p),[T,C]=n.map(m);return[y,x,T,C]}const JP=Math.abs,ud=Math.atan2,o_=Math.cos,Y8=Math.max,xO=Math.min,Vm=Math.sin,C1=Math.sqrt,fd=1e-12,wb=Math.PI,DS=wb/2,q8=2*wb;function $8(t){return t>1?0:t<-1?wb:Math.acos(t)}function tI(t){return t>=1?DS:t<=-1?-DS:Math.asin(t)}function K8(t){return t.innerRadius}function Q8(t){return t.outerRadius}function J8(t){return t.startAngle}function t7(t){return t.endAngle}function e7(t){return t&&t.padAngle}function n7(t,e,n,r,i,s,l,u){var h=n-t,p=r-e,m=l-i,y=u-s,x=y*h-m*p;if(!(x*x<fd))return x=(m*(e-s)-y*(t-i))/x,[t+x*h,e+x*p]}function NS(t,e,n,r,i,s,l){var u=t-n,h=e-r,p=(l?s:-s)/C1(u*u+h*h),m=p*h,y=-p*u,x=t+m,T=e+y,C=n+m,M=r+y,I=(x+C)/2,D=(T+M)/2,U=C-x,Z=M-T,G=U*U+Z*Z,W=i-s,$=x*M-C*T,J=(Z<0?-1:1)*C1(Y8(0,W*W*G-$*$)),nt=($*Z-U*J)/G,dt=(-$*U-Z*J)/G,Et=($*Z+U*J)/G,Pt=(-$*U+Z*J)/G,Ht=nt-I,Ct=dt-D,Ft=Et-I,jt=Pt-D;return Ht*Ht+Ct*Ct>Ft*Ft+jt*jt&&(nt=Et,dt=Pt),{cx:nt,cy:dt,x01:-m,y01:-y,x11:nt*(i/W-1),y11:dt*(i/W-1)}}function kS(){var t=K8,e=Q8,n=ll(0),r=null,i=J8,s=t7,l=e7,u=null,h=oa(p);function p(){var m,y,x=+t.apply(this,arguments),T=+e.apply(this,arguments),C=i.apply(this,arguments)-DS,M=s.apply(this,arguments)-DS,I=JP(M-C),D=M>C;if(u||(u=m=h()),T<x&&(y=T,T=x,x=y),!(T>fd))u.moveTo(0,0);else if(I>q8-fd)u.moveTo(T*o_(C),T*Vm(C)),u.arc(0,0,T,C,M,!D),x>fd&&(u.moveTo(x*o_(M),x*Vm(M)),u.arc(0,0,x,M,C,D));else{var U=C,Z=M,G=C,W=M,$=I,J=I,nt=l.apply(this,arguments)/2,dt=nt>fd&&(r?+r.apply(this,arguments):C1(x*x+T*T)),Et=xO(JP(T-x)/2,+n.apply(this,arguments)),Pt=Et,Ht=Et,Ct,Ft;if(dt>fd){var jt=tI(dt/x*Vm(nt)),qt=tI(dt/T*Vm(nt));($-=jt*2)>fd?(jt*=D?1:-1,G+=jt,W-=jt):($=0,G=W=(C+M)/2),(J-=qt*2)>fd?(qt*=D?1:-1,U+=qt,Z-=qt):(J=0,U=Z=(C+M)/2)}var Ee=T*o_(U),oe=T*Vm(U),_e=x*o_(W),hn=x*Vm(W);if(Et>fd){var Dn=T*o_(Z),Kn=T*Vm(Z),Jn=x*o_(G),zr=x*Vm(G),ui;if(I<wb)if(ui=n7(Ee,oe,Jn,zr,Dn,Kn,_e,hn)){var Ki=Ee-ui[0],Qr=oe-ui[1],Kr=Dn-ui[0],Co=Kn-ui[1],Qi=1/Vm($8((Ki*Kr+Qr*Co)/(C1(Ki*Ki+Qr*Qr)*C1(Kr*Kr+Co*Co)))/2),ji=C1(ui[0]*ui[0]+ui[1]*ui[1]);Pt=xO(Et,(x-ji)/(Qi-1)),Ht=xO(Et,(T-ji)/(Qi+1))}else Pt=Ht=0}J>fd?Ht>fd?(Ct=NS(Jn,zr,Ee,oe,T,Ht,D),Ft=NS(Dn,Kn,_e,hn,T,Ht,D),u.moveTo(Ct.cx+Ct.x01,Ct.cy+Ct.y01),Ht<Et?u.arc(Ct.cx,Ct.cy,Ht,ud(Ct.y01,Ct.x01),ud(Ft.y01,Ft.x01),!D):(u.arc(Ct.cx,Ct.cy,Ht,ud(Ct.y01,Ct.x01),ud(Ct.y11,Ct.x11),!D),u.arc(0,0,T,ud(Ct.cy+Ct.y11,Ct.cx+Ct.x11),ud(Ft.cy+Ft.y11,Ft.cx+Ft.x11),!D),u.arc(Ft.cx,Ft.cy,Ht,ud(Ft.y11,Ft.x11),ud(Ft.y01,Ft.x01),!D))):(u.moveTo(Ee,oe),u.arc(0,0,T,U,Z,!D)):u.moveTo(Ee,oe),!(x>fd)||!($>fd)?u.lineTo(_e,hn):Pt>fd?(Ct=NS(_e,hn,Dn,Kn,x,-Pt,D),Ft=NS(Ee,oe,Jn,zr,x,-Pt,D),u.lineTo(Ct.cx+Ct.x01,Ct.cy+Ct.y01),Pt<Et?u.arc(Ct.cx,Ct.cy,Pt,ud(Ct.y01,Ct.x01),ud(Ft.y01,Ft.x01),!D):(u.arc(Ct.cx,Ct.cy,Pt,ud(Ct.y01,Ct.x01),ud(Ct.y11,Ct.x11),!D),u.arc(0,0,x,ud(Ct.cy+Ct.y11,Ct.cx+Ct.x11),ud(Ft.cy+Ft.y11,Ft.cx+Ft.x11),D),u.arc(Ft.cx,Ft.cy,Pt,ud(Ft.y11,Ft.x11),ud(Ft.y01,Ft.x01),!D))):u.arc(0,0,x,W,G,D)}if(u.closePath(),m)return u=null,m+""||null}return p.centroid=function(){var m=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,y=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-wb/2;return[o_(y)*m,Vm(y)*m]},p.innerRadius=function(m){return arguments.length?(t=typeof m=="function"?m:ll(+m),p):t},p.outerRadius=function(m){return arguments.length?(e=typeof m=="function"?m:ll(+m),p):e},p.cornerRadius=function(m){return arguments.length?(n=typeof m=="function"?m:ll(+m),p):n},p.padRadius=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:ll(+m),p):r},p.startAngle=function(m){return arguments.length?(i=typeof m=="function"?m:ll(+m),p):i},p.endAngle=function(m){return arguments.length?(s=typeof m=="function"?m:ll(+m),p):s},p.padAngle=function(m){return arguments.length?(l=typeof m=="function"?m:ll(+m),p):l},p.context=function(m){return arguments.length?(u=m==null?null:m,p):u},p}var BS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function eI(t,e,n,r,i={}){const{inset:s=0,radius:l=0,insetLeft:u=s,insetTop:h=s,insetRight:p=s,insetBottom:m=s,radiusBottomLeft:y=l,radiusBottomRight:x=l,radiusTopLeft:T=l,radiusTopRight:C=l,minWidth:M=-1/0,maxWidth:I=1/0,minHeight:D=-1/0}=i,U=BS(i,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!Ml(r)&&!Ux(r)){const nt=!!gc(r),[dt,,Et]=nt?Vr(e):e,[Pt,Ht]=dt,[Ct,Ft]=st(Et,dt),jt=Ct>0?Pt:Pt+Ct,qt=Ft>0?Ht:Ht+Ft,Ee=Math.abs(Ct),oe=Math.abs(Ft),_e=jt+u,hn=qt+h,Dn=Ee-(u+p),Kn=oe-(h+m),Jn=nt?Fx(Dn,D,1/0):Fx(Dn,M,I),zr=nt?Fx(Kn,M,I):Fx(Kn,D,1/0),ui=nt?_e:_e-(Jn-Dn)/2,Ki=nt?hn-(zr-Kn)/2:hn-(zr-Kn);return Ra(t.createElement("rect",{})).style("x",ui).style("y",Ki).style("width",Jn).style("height",zr).style("radius",[T,C,x,y]).call(Ln,U).node()}const{y:Z,y1:G}=n,W=r.getCenter(),$=Hi(r,e,[Z,G]),J=kS().cornerRadius(l).padAngle(s*Math.PI/180);return Ra(t.createElement("path",{})).style("d",J($)).style("transform",`translate(${W[0]}, ${W[1]})`).style("radius",l).style("inset",s).call(Ln,U).node()}const Ab=(t,e)=>{const{colorAttribute:n,opacityAttribute:r="fill",first:i=!0,last:s=!0}=t,l=BS(t,["colorAttribute","opacityAttribute","first","last"]),{coordinate:u,document:h}=e;return(p,m,y)=>{const{color:x,radius:T=0}=y,C=BS(y,["color","radius"]),M=C.lineWidth||1,{stroke:I,radius:D=T,radiusTopLeft:U=D,radiusTopRight:Z=D,radiusBottomRight:G=D,radiusBottomLeft:W=D,innerRadius:$=0,innerRadiusTopLeft:J=$,innerRadiusTopRight:nt=$,innerRadiusBottomRight:dt=$,innerRadiusBottomLeft:Et=$,lineWidth:Pt=n==="stroke"||I?M:0,inset:Ht=0,insetLeft:Ct=Ht,insetRight:Ft=Ht,insetBottom:jt=Ht,insetTop:qt=Ht,minWidth:Ee,maxWidth:oe,minHeight:_e}=l,hn=BS(l,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:Dn=x,opacity:Kn}=m,Jn=[i?U:J,i?Z:nt,s?G:dt,s?W:Et],zr=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];gc(u)&&zr.push(zr.shift());const ui=Object.assign(Object.assign({radius:D},Object.fromEntries(zr.map((Ki,Qr)=>[Ki,Jn[Qr]]))),{inset:Ht,insetLeft:Ct,insetRight:Ft,insetBottom:jt,insetTop:qt,minWidth:Ee,maxWidth:oe,minHeight:_e});return Ra(eI(h,p,m,u,ui)).call(Ln,C).style("fill","transparent").style(n,Dn).style(ps(t),Kn).style("lineWidth",Pt).style("stroke",I===void 0?Dn:I).call(Ln,hn).node()}};Ab.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const r7={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function i7(t,e){var n;return(n=t.style[e])!==null&&n!==void 0?n:r7[e]}function bO(t,e,n,r){t.style[e]=n,r&&t.children.forEach(i=>bO(i,e,n,r))}function EO(t){bO(t,"visibility","hidden",!0)}function FS(t){bO(t,"visibility","visible",!0)}var Ob=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Ug(t){return Ra(t).selectAll(`.${De}`).nodes().filter(e=>!e.__removed__)}function nI(t,e){return SO(t,e).flatMap(({container:n})=>Ug(n))}function SO(t,e){return e.filter(n=>n!==t&&n.options.parentKey===t.options.key)}function Zm(t){return Ra(t).select(`.${At}`).node()}function rI(t){if(t.tagName==="g")return t.getRenderBounds();const e=t.getGeometryBounds(),n=new vn;return n.setFromTransformedAABB(e,t.getWorldTransform()),n}function Cb(t,e){const{offsetX:n,offsetY:r}=e,i=rI(t),{min:[s,l],max:[u,h]}=i,p=n<s||n>u,m=r<l||r>h;return p||m?null:[n-s,r-l]}function TO(t,e){const{offsetX:n,offsetY:r}=e,[i,s,l,u]=o7(t);return[Math.min(l,Math.max(i,n))-i,Math.min(u,Math.max(s,r))-s]}function o7(t){const e=t.getRenderBounds(),{min:[n,r],max:[i,s]}=e;return[n,r,i,s]}function iI(t){return e=>e.__data__.color}function wO(t){return e=>e.__data__.x}function a_(t){const e=Array.isArray(t)?t:[t],n=new Map(e.flatMap(r=>Array.from(r.markState.keys()).map(s=>[US(r.key,s.key),s.data])));return r=>{const{index:i,markKey:s,viewKey:l}=r.__data__;return n.get(US(l,s))[i]}}function kv(t,e=(r,i)=>r,n=(r,i,s)=>r.setAttribute(i,s)){const r="__states__",i="__ordinal__",s=m=>{const{[r]:y=[],[i]:x={}}=m,T=y.reduce((C,M)=>Object.assign(Object.assign({},C),t[M]),x);if(Object.keys(T).length!==0){for(const[C,M]of Object.entries(T)){const I=i7(m,C),D=e(M,m);n(m,C,D),C in x||(x[C]=I)}m[i]=x}},l=m=>{m[r]||(m[r]=[])};return{setState:(m,...y)=>{l(m),m[r]=[...y],s(m)},removeState:(m,...y)=>{l(m);for(const x of y){const T=m[r].indexOf(x);T!==-1&&m[r].splice(T,1)}s(m)},hasState:(m,y)=>(l(m),m[r].indexOf(y)!==-1)}}function a7(t){return t===void 0?!0:typeof t!="object"?!1:Object.keys(t).length===0}function US(t,e){return`${t},${e}`}function R1(t,e){const r=(Array.isArray(t)?t:[t]).flatMap(s=>s.marks.map(l=>[US(s.key,l.key),l.state])),i={};for(const s of e){const[l,u]=Array.isArray(s)?s:[s,{}];i[l]=r.reduce((h,p)=>{const[m,y={}]=p,x=a7(y[l])?u:y[l];for(const[T,C]of Object.entries(x)){const M=h[T],I=(D,U,Z,G)=>{const W=US(G.__data__.viewKey,G.__data__.markKey);return m!==W?M==null?void 0:M(D,U,Z,G):typeof C!="function"?C:C(D,U,Z,G)};h[T]=I}return h},{})}return i}function Rb(t,e){const n=new Map(t.map((i,s)=>[i,s])),r=e?t.map(e):t;return(i,s)=>{if(typeof i!="function")return i;const l=n.get(s),u=e?e(s):s;return i(u,l,r,s)}}function oI(t){var{link:e=!1,valueof:n=(m,y)=>m,coordinate:r}=t,i=Ob(t,["link","valueof","coordinate"]);const s="element-link";if(!e)return[()=>{},()=>{}];const l=m=>m.__data__.points,u=(m,y)=>{const[,x,T]=m,[C,,,M]=y;return[x,C,M,T]};return[m=>{var y;if(m.length<=1)return;const x=tm(m,(T,C)=>{const{x:M}=T.__data__,{x:I}=C.__data__;return M-I});for(let T=1;T<x.length;T++){const C=hp(),M=x[T-1],I=x[T],[D,U,Z,G]=u(l(M),l(I));C.moveTo(...D),C.lineTo(...U),C.lineTo(...Z),C.lineTo(...G),C.closePath();const W=_0(i,dt=>n(dt,M)),{fill:$=M.getAttribute("fill")}=W,J=Ob(W,["fill"]),nt=new Zi({className:s,style:Object.assign({d:C.toString(),fill:$,zIndex:-2},J)});(y=M.link)===null||y===void 0||y.remove(),M.parentNode.appendChild(nt),M.link=nt}},m=>{var y;(y=m.link)===null||y===void 0||y.remove(),m.link=null}]}function aI(t,e,n){const r=i=>{const{transform:s}=t.style;return s?`${s} ${i}`:i};if(Ml(n)){const{points:i}=t.__data__,[s,l]=gc(n)?Vr(i):i,u=n.getCenter(),h=st(s,u),p=st(l,u),m=se(h),y=yn(h,p),x=m+y/2,T=e*Math.cos(x),C=e*Math.sin(x);return r(`translate(${T}, ${C})`)}return gc(n)?r(`translate(${e}, 0)`):r(`translate(0, ${-e})`)}function sI(t){var{document:e,background:n,scale:r,coordinate:i,valueof:s}=t,l=Ob(t,["document","background","scale","coordinate","valueof"]);const u="element-background";if(!n)return[()=>{},()=>{}];const h=(D,U,Z)=>{const G=D.invert(U),W=U+D.getBandWidth(G)/2,$=D.getStep(G)/2,J=$*Z;return[W-$+J,W+$-J]},p=(D,U)=>{const{x:Z}=r;if(!Tb(Z))return[0,1];const{__data__:G}=D,{x:W}=G,[$,J]=h(Z,W,U);return[$,J]},m=(D,U)=>{const{y:Z}=r;if(!Tb(Z))return[0,1];const{__data__:G}=D,{y:W}=G,[$,J]=h(Z,W,U);return[$,J]},y=(D,U)=>{const{padding:Z}=U,[G,W]=p(D,Z),[$,J]=m(D,Z),nt=[[G,$],[W,$],[W,J],[G,J]].map(Ht=>i.map(Ht)),{__data__:dt}=D,{y:Et,y1:Pt}=dt;return eI(e,nt,{y:Et,y1:Pt},i,U)},x=(D,U)=>{const{transform:Z="scale(1.2, 1.2)",transformOrigin:G="center center",stroke:W=""}=U,$=Ob(U,["transform","transformOrigin","stroke"]),J=Object.assign({transform:Z,transformOrigin:G,stroke:W},$),nt=D.cloneNode(!0);for(const[dt,Et]of Object.entries(J))nt.style[dt]=Et;return nt},T=()=>{const{x:D,y:U}=r;return[D,U].some(Tb)};return[D=>{D.background&&D.background.remove();const U=_0(l,Ht=>s(Ht,D)),{fill:Z="#CCD6EC",fillOpacity:G=.3,zIndex:W=-2,padding:$=.001,lineWidth:J=0}=U,nt=Ob(U,["fill","fillOpacity","zIndex","padding","lineWidth"]),dt=Object.assign(Object.assign({},nt),{fill:Z,fillOpacity:G,zIndex:W,padding:$,lineWidth:J}),Pt=(T()?y:x)(D,dt);Pt.className=u,D.parentNode.parentNode.appendChild(Pt),D.background=Pt},D=>{var U;(U=D.background)===null||U===void 0||U.remove(),D.background=null},D=>D.className===u]}function zg(t,e){const r=t.getRootNode().defaultView.getContextService().getDomElement();r!=null&&r.style&&(t.cursor=r.style.cursor,r.style.cursor=e)}function s7(t){zg(t,t.cursor)}function AO(t,e,n){return t.find(r=>Object.entries(e).every(([i,s])=>n(r)[i]===s))}function zS(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Mb(t,e=!1){const n=KP(t,r=>!!r).map((r,i)=>[i===0?"M":"L",...r]);return e&&n.push(["Z"]),n}function lI(t){return t.querySelectorAll(".element")}function l7(t,e,n=0){const r=[["M",...e[1]]],i=zS(t,e[1]),s=zS(t,e[0]);return i===0?r.push(["L",...e[3]],["A",s,s,0,n,1,...e[0]],["Z"]):r.push(["A",i,i,0,n,0,...e[2]],["L",...e[3]],["A",s,s,0,n,1,...e[0]],["Z"]),r}function jS(t,e){if(e(t))return t;let n=t.parent;for(;n&&!e(n);)n=n.parent;return n}function cI(t,e){const{__data__:n}=t,{markKey:r,index:i,seriesIndex:s}=n,{markState:l}=e,u=Array.from(l.keys()).find(h=>h.key===r);if(u)return s?s.map(h=>u.data[h]):u.data[i]}function c7(t){return jS(t,e=>e.className==="component")}function u7(t){return jS(t,e=>e.className==="element")}function f7(t){return jS(t,e=>e.className==="label")}function dh(t,e,n,r=i=>!0){return i=>{if(!r(i))return;n.emit(`plot:${t}`,i);const{target:s}=i;if(!s)return;const{className:l}=s;if(l==="plot")return;const u=u7(s),h=c7(s),p=f7(s),m=u||h||p;if(!m)return;const{className:y,markType:x}=m,T=Object.assign(Object.assign({},i),{nativeEvent:!0});y==="element"?(T.data={data:cI(m,e)},n.emit(`element:${t}`,T),n.emit(`${x}:${t}`,T)):y==="label"?(T.data={data:m.attributes.datum},n.emit(`label:${t}`,T),n.emit(`${l}:${t}`,T)):(n.emit(`component:${t}`,T),n.emit(`${l}:${t}`,T))}}function uI(){return(t,e,n)=>{const{container:r,view:i}=t,s=dh(bl.CLICK,i,n,J=>J.detail===1),l=dh(bl.DBLCLICK,i,n,J=>J.detail===2),u=dh(bl.POINTER_TAP,i,n),h=dh(bl.POINTER_DOWN,i,n),p=dh(bl.POINTER_UP,i,n),m=dh(bl.POINTER_OVER,i,n),y=dh(bl.POINTER_OUT,i,n),x=dh(bl.POINTER_MOVE,i,n),T=dh(bl.POINTER_ENTER,i,n),C=dh(bl.POINTER_LEAVE,i,n),M=dh(bl.POINTER_UPOUTSIDE,i,n),I=dh(bl.DRAG_START,i,n),D=dh(bl.DRAG,i,n),U=dh(bl.DRAG_END,i,n),Z=dh(bl.DRAG_ENTER,i,n),G=dh(bl.DRAG_LEAVE,i,n),W=dh(bl.DRAG_OVER,i,n),$=dh(bl.DROP,i,n);return r.addEventListener("click",s),r.addEventListener("click",l),r.addEventListener("pointertap",u),r.addEventListener("pointerdown",h),r.addEventListener("pointerup",p),r.addEventListener("pointerover",m),r.addEventListener("pointerout",y),r.addEventListener("pointermove",x),r.addEventListener("pointerenter",T),r.addEventListener("pointerleave",C),r.addEventListener("pointerupoutside",M),r.addEventListener("dragstart",I),r.addEventListener("drag",D),r.addEventListener("dragend",U),r.addEventListener("dragenter",Z),r.addEventListener("dragleave",G),r.addEventListener("dragover",W),r.addEventListener("drop",$),()=>{r.removeEventListener("click",s),r.removeEventListener("click",l),r.removeEventListener("pointertap",u),r.removeEventListener("pointerdown",h),r.removeEventListener("pointerup",p),r.removeEventListener("pointerover",m),r.removeEventListener("pointerout",y),r.removeEventListener("pointermove",x),r.removeEventListener("pointerenter",T),r.removeEventListener("pointerleave",C),r.removeEventListener("pointerupoutside",M),r.removeEventListener("dragstart",I),r.removeEventListener("drag",D),r.removeEventListener("dragend",U),r.removeEventListener("dragenter",Z),r.removeEventListener("dragleave",G),r.removeEventListener("dragover",W),r.removeEventListener("drop",$)}}}uI.props={reapplyWhenUpdate:!0};function h7(){return{"component.axisRadar":lb,"component.axisLinear":zm,"component.axisArc":sS,"component.legendContinuousBlock":OS,"component.legendContinuousBlockSize":a,"component.legendContinuousSize":CS,"interaction.event":uI,"composition.mark":f,"composition.view":Q,"shape.label.label":$P}}var d7=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Zc(t,e){const n=Object.assign(Object.assign({},h7()),e),r=s=>{if(typeof s!="string")return s;const l=`${t}.${s}`;return n[l]||mg(`Unknown Component: ${l}`)};return[(s,l)=>{const{type:u}=s,h=d7(s,["type"]);u||mg("Plot type is required!");const p=r(u);return p==null?void 0:p(h,l)},r]}function fI(t){const{canvas:e,group:n}=t;return(e==null?void 0:e.document)||(n==null?void 0:n.ownerDocument)||mg("Cannot find library document")}var hI=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function p7(t,e,n){const[r]=Zc("coordinate",n),{innerHeight:i,innerWidth:s,insetLeft:l,insetTop:u,insetRight:h,insetBottom:p}=t,{coordinates:m=[]}=e,y=x7(m),x=y[0].type==="cartesian3D",T=Object.assign(Object.assign({},t),{x:l,y:u,width:s-l-h,height:i-p-u,transformations:y.flatMap(r)});return x?new gE.Coordinate3D(T):new gE.Coordinate(T)}function dI(t,e){const{coordinate:n={},coordinates:r}=t,i=hI(t,["coordinate","coordinates"]);if(r)return t;const{type:s,transform:l=[]}=n,u=hI(n,["type","transform"]);if(!s)return Object.assign(Object.assign({},i),{coordinates:l});const[,h]=Zc("coordinate",e),{transform:p=!1}=h(s).props||{};if(p)throw new Error(`Unknown coordinate: ${s}.`);return Object.assign(Object.assign({},i),{coordinates:[Object.assign({type:s},u),...l]})}function em(t,e){return t.filter(n=>n.type===e)}function s_(t){return em(t,"polar").length>0}function m7(t){return em(t,"helix").length>0}function M1(t){return em(t,"transpose").length%2===1}function v7(t){return em(t,"parallel").length>0}function pI(t){return em(t,"theta").length>0}function g7(t){return em(t,"reflect").length>0}function Pb(t){return em(t,"radial").length>0}function y7(t){return em(t,"radar").length>0}function _7(t){return em(t,"reflectY").length>0}function x7(t){return t.find(e=>e.type==="cartesian"||e.type==="cartesian3D")?t:[...t,{type:"cartesian"}]}function Cs(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}var b7=Cs("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),E7=Cs("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),S7=Cs("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),T7=Cs("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),w7=Cs("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),A7=Cs("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),O7=Cs("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),C7=Cs("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),R7=Cs("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),M7=Cs("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),P7=Cs("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function VS(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function OO(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function P1(){}var l_=.7,I1=1/l_,L1="\\s*([+-]?\\d+)\\s*",Ib="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I7=/^#([0-9a-f]{3,8})$/,L7=new RegExp("^rgb\\(".concat(L1,",").concat(L1,",").concat(L1,"\\)$")),D7=new RegExp("^rgb\\(".concat(Hm,",").concat(Hm,",").concat(Hm,"\\)$")),N7=new RegExp("^rgba\\(".concat(L1,",").concat(L1,",").concat(L1,",").concat(Ib,"\\)$")),k7=new RegExp("^rgba\\(".concat(Hm,",").concat(Hm,",").concat(Hm,",").concat(Ib,"\\)$")),B7=new RegExp("^hsl\\(".concat(Ib,",").concat(Hm,",").concat(Hm,"\\)$")),F7=new RegExp("^hsla\\(".concat(Ib,",").concat(Hm,",").concat(Hm,",").concat(Ib,"\\)$")),mI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VS(P1,CO,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:vI,formatHex:vI,formatHex8:U7,formatHsl:z7,formatRgb:gI,toString:gI});function vI(){return this.rgb().formatHex()}function U7(){return this.rgb().formatHex8()}function z7(){return SI(this).formatHsl()}function gI(){return this.rgb().formatRgb()}function CO(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=I7.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?yI(e):n===3?new hd(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ZS(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ZS(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=L7.exec(t))?new hd(e[1],e[2],e[3],1):(e=D7.exec(t))?new hd(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=N7.exec(t))?ZS(e[1],e[2],e[3],e[4]):(e=k7.exec(t))?ZS(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=B7.exec(t))?EI(e[1],e[2]/100,e[3]/100,1):(e=F7.exec(t))?EI(e[1],e[2]/100,e[3]/100,e[4]):mI.hasOwnProperty(t)?yI(mI[t]):t==="transparent"?new hd(NaN,NaN,NaN,0):null}function yI(t){return new hd(t>>16&255,t>>8&255,t&255,1)}function ZS(t,e,n,r){return r<=0&&(t=e=n=NaN),new hd(t,e,n,r)}function _I(t){return t instanceof P1||(t=CO(t)),t?(t=t.rgb(),new hd(t.r,t.g,t.b,t.opacity)):new hd}function Lb(t,e,n,r){return arguments.length===1?_I(t):new hd(t,e,n,r==null?1:r)}function hd(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}VS(hd,Lb,OO(P1,{brighter:function(e){return e=e==null?I1:Math.pow(I1,e),new hd(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?l_:Math.pow(l_,e),new hd(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new hd(c_(this.r),c_(this.g),c_(this.b),HS(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xI,formatHex:xI,formatHex8:j7,formatRgb:bI,toString:bI}));function xI(){return"#".concat(u_(this.r)).concat(u_(this.g)).concat(u_(this.b))}function j7(){return"#".concat(u_(this.r)).concat(u_(this.g)).concat(u_(this.b)).concat(u_((isNaN(this.opacity)?1:this.opacity)*255))}function bI(){var t=HS(this.opacity);return"".concat(t===1?"rgb(":"rgba(").concat(c_(this.r),", ").concat(c_(this.g),", ").concat(c_(this.b)).concat(t===1?")":", ".concat(t,")"))}function HS(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function c_(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function u_(t){return t=c_(t),(t<16?"0":"")+t.toString(16)}function EI(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nm(t,e,n,r)}function SI(t){if(t instanceof nm)return new nm(t.h,t.s,t.l,t.opacity);if(t instanceof P1||(t=CO(t)),!t)return new nm;if(t instanceof nm)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(e===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-e)/u+2:l=(e-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new nm(l,u,h,t.opacity)}function V7(t,e,n,r){return arguments.length===1?SI(t):new nm(t,e,n,r==null?1:r)}function nm(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}VS(nm,V7,OO(P1,{brighter:function(e){return e=e==null?I1:Math.pow(I1,e),new nm(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?l_:Math.pow(l_,e),new nm(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new hd(RO(e>=240?e-240:e+120,s,i),RO(e,s,i),RO(e<120?e+240:e-120,s,i),this.opacity)},clamp:function(){return new nm(TI(this.h),GS(this.s),GS(this.l),HS(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=HS(this.opacity);return"".concat(e===1?"hsl(":"hsla(").concat(TI(this.h),", ").concat(GS(this.s)*100,"%, ").concat(GS(this.l)*100,"%").concat(e===1?")":", ".concat(e,")"))}}));function TI(t){return t=(t||0)%360,t<0?t+360:t}function GS(t){return Math.max(0,Math.min(1,t||0))}function RO(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function wI(t,e,n,r,i){var s=t*t,l=s*t;return((1-3*t+3*s-l)*e+(4-6*s+3*l)*n+(1+3*t+3*s-3*l)*r+l*i)/6}function Z7(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],l=r>0?t[r-1]:2*i-s,u=r<e-1?t[r+2]:2*s-i;return wI((n-r/e)*e,l,i,s,u)}}function H7(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],s=t[r%e],l=t[(r+1)%e],u=t[(r+2)%e];return wI((n-r/e)*e,i,s,l,u)}}var MO=function(t){return function(){return t}};function AI(t,e){return function(n){return t+n*e}}function G7(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function W7(t,e){var n=e-t;return n?AI(t,n>180||n<-180?n-360*Math.round(n/360):n):MO(isNaN(t)?e:t)}function X7(t){return(t=+t)==1?D1:function(e,n){return n-e?G7(e,n,t):MO(isNaN(e)?n:e)}}function D1(t,e){var n=e-t;return n?AI(t,n):MO(isNaN(t)?e:t)}var Tet=function t(e){var n=X7(e);function r(i,s){var l=n((i=Lb(i)).r,(s=Lb(s)).r),u=n(i.g,s.g),h=n(i.b,s.b),p=D1(i.opacity,s.opacity);return function(m){return i.r=l(m),i.g=u(m),i.b=h(m),i.opacity=p(m),i+""}}return r.gamma=t,r}(1);function OI(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),l,u;for(l=0;l<n;++l)u=Lb(e[l]),r[l]=u.r||0,i[l]=u.g||0,s[l]=u.b||0;return r=t(r),i=t(i),s=t(s),u.opacity=1,function(h){return u.r=r(h),u.g=i(h),u.b=s(h),u+""}}}var Y7=OI(Z7),wet=OI(H7),Mc=t=>Y7(t[t.length-1]),CI=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Cs),q7=Mc(CI),RI=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Cs),$7=Mc(RI),MI=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Cs),K7=Mc(MI),PI=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Cs),Q7=Mc(PI),II=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Cs),J7=Mc(II),LI=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Cs),tU=Mc(LI),DI=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Cs),eU=Mc(DI),NI=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Cs),nU=Mc(NI),kI=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Cs),rU=Mc(kI),BI=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Cs),iU=Mc(BI),FI=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Cs),oU=Mc(FI),UI=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Cs),aU=Mc(UI),zI=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Cs),sU=Mc(zI),jI=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Cs),lU=Mc(jI),VI=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Cs),cU=Mc(VI),ZI=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Cs),uU=Mc(ZI),HI=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Cs),fU=Mc(HI),GI=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Cs),hU=Mc(GI),WI=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Cs),dU=Mc(WI),XI=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Cs),pU=Mc(XI),YI=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Cs),mU=Mc(YI),qI=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Cs),vU=Mc(qI),$I=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Cs),gU=Mc($I),KI=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Cs),yU=Mc(KI),QI=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Cs),_U=Mc(QI),JI=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Cs),xU=Mc(JI),t5=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Cs),bU=Mc(t5);function EU(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}var SU=Math.PI/180,TU=180/Math.PI,e5=-.14861,PO=1.78277,IO=-.29227,WS=-.90649,Db=1.97294,n5=Db*WS,r5=Db*PO,i5=PO*IO-WS*e5;function wU(t){if(t instanceof f_)return new f_(t.h,t.s,t.l,t.opacity);t instanceof hd||(t=_I(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(i5*r+n5*e-r5*n)/(i5+n5-r5),s=r-i,l=(Db*(n-i)-IO*s)/WS,u=Math.sqrt(l*l+s*s)/(Db*i*(1-i)),h=u?Math.atan2(l,s)*TU-120:NaN;return new f_(h<0?h+360:h,u,i,t.opacity)}function Gm(t,e,n,r){return arguments.length===1?wU(t):new f_(t,e,n,r==null?1:r)}function f_(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}VS(f_,Gm,OO(P1,{brighter:function(e){return e=e==null?I1:Math.pow(I1,e),new f_(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?l_:Math.pow(l_,e),new f_(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*SU,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),i=Math.cos(e),s=Math.sin(e);return new hd(255*(n+r*(e5*i+PO*s)),255*(n+r*(IO*i+WS*s)),255*(n+r*(Db*i)),this.opacity)}}));function o5(t){return function e(n){n=+n;function r(i,s){var l=t((i=Gm(i)).h,(s=Gm(s)).h),u=D1(i.s,s.s),h=D1(i.l,s.l),p=D1(i.opacity,s.opacity);return function(m){return i.h=l(m),i.s=u(m),i.l=h(Math.pow(m,n)),i.opacity=p(m),i+""}}return r.gamma=e,r}(1)}var Aet=o5(W7),LO=o5(D1),AU=LO(Gm(300,.5,0),Gm(-240,.5,1)),OU=LO(Gm(-100,.75,.35),Gm(80,1.5,.8)),CU=LO(Gm(260,.75,.35),Gm(80,1.5,.8)),XS=Gm();function RU(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return XS.h=360*t-100,XS.s=1.5-1.5*e,XS.l=.8-.9*e,XS+""}var YS=Lb(),MU=Math.PI/3,PU=Math.PI*2/3;function IU(t){var e;return t=(.5-t)*Math.PI,YS.r=255*(e=Math.sin(t))*e,YS.g=255*(e=Math.sin(t+MU))*e,YS.b=255*(e=Math.sin(t+PU))*e,YS+""}function LU(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function qS(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var DU=qS(Cs("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),NU=qS(Cs("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),kU=qS(Cs("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),BU=qS(Cs("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function FU(t,e,n,r,i,s){const{guide:l={}}=n,u=YU(t,e,n);if(typeof u!="string")return n;const h=qU(u,t,e,n),p=GU(u,h,n);return Object.assign(Object.assign(Object.assign({},n),KU(u,t,e,n,r)),{domain:p,range:$U(u,t,e,n,p,i,s),expectedDomain:h,guide:l,name:t,type:u})}function UU(t,e){const n={};for(const r of t){const{values:i,name:s}=r,l=e[s];for(const u of i){const{name:h,value:p}=u;n[h]=p.map(m=>l.map(m))}}return n}function zU(t,e){const n=Array.from(t.values()).flatMap(i=>i.channels);W_(n,i=>i.map(s=>e.get(s.scale.uid)),i=>i.name).filter(([,i])=>i.some(s=>typeof s.getOptions().groupTransform=="function")&&i.every(s=>s.getTicks)).map(i=>i[1]).forEach(i=>{const s=i.map(l=>l.getOptions().groupTransform)[0];s(i)})}function jU(t,e){var n;const{components:r=[]}=e,i=["scale","encode","axis","legend","data","transform"],s=Array.from(new Set(t.flatMap(u=>u.channels.map(h=>h.scale)))),l=new Map(s.map(u=>[u.name,u]));for(const u of r){const h=HU(u);for(const p of h){const m=l.get(p),y=((n=u.scale)===null||n===void 0?void 0:n[p])||{},{independent:x=!1}=y;if(m&&!x){const{guide:T}=m,C=typeof T=="boolean"?{}:T;m.guide=ti({},C,u),Object.assign(m,y)}else{const T=Object.assign(Object.assign({},y),{expectedDomain:y.domain,name:p,guide:oc(u,i)});s.push(T)}}}return s}function VU(t){if(!t||!Array.isArray(t))return[Ev,Ev];let e,n;return[s=>{var l;e=s.map.bind(s),n=(l=s.invert)===null||l===void 0?void 0:l.bind(s);const u=t.filter(([x])=>typeof x=="function"),h=t.filter(([x])=>typeof x!="function"),p=new Map(h);if(s.map=x=>{for(const[T,C]of u)if(T(x))return C;return p.has(x)?p.get(x):e(x)},!n)return s;const m=new Map(h.map(([x,T])=>[T,x])),y=new Map(u.map(([x,T])=>[T,x]));return s.invert=x=>y.has(x)?x:m.has(x)?m.get(x):n(x),s},s=>(e!==null&&(s.map=e),n!==null&&(s.invert=n),s)]}function a5(t,e){const n=Object.keys(t);for(const r of Object.values(e)){const{name:i}=r.getOptions();if(!(i in t))t[i]=r;else{const s=n.filter(h=>h.startsWith(i)).map(h=>+(h.replace(i,"")||0)),l=El(s)+1,u=`${i}${l}`;t[u]=r,r.getOptions().key=u}}return t}function s5(t,e){const[n]=Zc("scale",e),{relations:r}=t,[i]=VU(r),s=n(t);return i(s)}function ZU(t){const e=t.flatMap(n=>Array.from(n.values())).flatMap(n=>n.channels.map(r=>r.scale));l5(e,"x"),l5(e,"y")}function HU(t){const{channels:e=[],type:n,scale:r={}}=t,i=["shape","color","opacity","size"];return e.length!==0?e:n==="axisX"?["x"]:n==="axisY"?["y"]:n==="legends"?Object.keys(r).filter(s=>i.includes(s)):[]}function l5(t,e){const n=t.filter(({name:s,facet:l=!0})=>l&&s===e),r=n.flatMap(s=>s.domain),i=n.every(c5)?S0(r):n.every(u5)?Array.from(new Set(r)):null;if(i!==null)for(const s of n)s.domain=i}function GU(t,e,n){const{ratio:r}=n;return r==null?e:c5({type:t})?WU(e,r,t):u5({type:t})?XU(e,r):e}function WU(t,e,n){const r=t.map(Number),i=new hh({domain:r,range:[r[0],r[0]+(r[r.length-1]-r[0])*e]});return n==="time"?t.map(s=>new Date(i.map(s))):t.map(s=>i.map(s))}function XU(t,e){const n=Math.round(t.length*e);return t.slice(0,n)}function c5(t){const{type:e}=t;return typeof e!="string"?!1:["linear","log","pow","time"].includes(e)}function u5(t){const{type:e}=t;return typeof e!="string"?!1:["band","point","ordinal"].includes(e)}function YU(t,e,n){const{type:r,domain:i,range:s,quantitative:l,ordinal:u}=n;return r!==void 0?r:c9(e)?"identity":typeof s=="string"?"linear":(i||s||[]).length>2?DO(t,u):i!==void 0?p5([i])?DO(t,u):m5(e)?"time":h5(t,s,l):p5(e)?DO(t,u):m5(e)?"time":h5(t,s,l)}function qU(t,e,n,r){const{domain:i}=r;if(i!==void 0)return i;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return d5(i9(n,r),r);case"band":case"ordinal":case"point":return o9(n);case"quantile":return a9(n);case"sequential":return d5(s9(n),r);default:return[]}}function $U(t,e,n,r,i,s,l){const{range:u}=r;if(typeof u=="string")return QU(u);if(u!==void 0)return u;const{rangeMin:h,rangeMax:p}=r;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":{const m=f5(n,r,i,s,l),[y,x]=l9(e,m);return[h!=null?h:y,p!=null?p:x]}case"band":case"point":{const m=e==="size"?5:0,y=e==="size"?10:1;return[h!=null?h:m,p!=null?p:y]}case"ordinal":return f5(n,r,i,s,l);case"sequential":return;case"constant":return[n[0][0]];default:return[]}}function KU(t,e,n,r,i){switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":return e9(i,r);case"band":case"point":return n9(t,e,i,r);case"sequential":return t9(r);default:return r}}function f5(t,e,n,r,i){const[s]=Zc("palette",i),{category10:l,category20:u}=r,h=lP(n).length<=l.length?l:u,{palette:p=h,offset:m}=e;if(Array.isArray(p))return p;try{return s({type:p})}catch(y){const x=JU(p,n,m);if(x)return x;throw new Error(`Unknown Component: ${p} `)}}function QU(t){return t.split("-")}function JU(t,e,n=r=>r){if(!t)return null;const r=Sv(t),i=pt[`scheme${r}`],s=pt[`interpolate${r}`];if(!i&&!s)return null;if(i){if(!i.some(Array.isArray))return i;const l=i[e.length];if(l)return l}return e.map((l,u)=>s(n(u/e.length)))}function t9(t){const{palette:e="ylGnBu",offset:n}=t,r=Sv(e),i=pt[`interpolate${r}`];if(!i)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?s=>i(n(s)):i}}function e9(t,e){const{interpolate:n=up,nice:r=!1,tickCount:i=5}=e;return Object.assign(Object.assign({},e),{interpolate:n,nice:r,tickCount:i})}function n9(t,e,n,r){if(r.padding!==void 0||r.paddingInner!==void 0||r.paddingOuter!==void 0)return Object.assign(Object.assign({},r),{unknown:NaN});const i=r9(t,e,n),{paddingInner:s=i,paddingOuter:l=i}=r;return Object.assign(Object.assign({},r),{paddingInner:s,paddingOuter:l,padding:i,unknown:NaN})}function r9(t,e,n){return e==="enterDelay"||e==="enterDuration"||e==="size"?0:t==="band"?pI(n)?0:.1:t==="point"?.5:0}function DO(t,e){return e||(u9(t)?"point":"ordinal")}function h5(t,e,n){return n||(t!=="color"||e?"linear":"sequential")}function d5(t,e){if(t.length===0)return t;const{domainMin:n,domainMax:r}=e,[i,s]=t;return[n!=null?n:i,r!=null?r:s]}function i9(t,e){const{zero:n=!1}=e;let r=1/0,i=-1/0;for(const s of t)for(const l of s)Ql(l)&&(r=Math.min(r,+l),i=Math.max(i,+l));return r===1/0?[]:n?[Math.min(0,r),i]:[r,i]}function o9(t){return Array.from(new Set(t.flat()))}function a9(t){return t.flat().sort()}function s9(t){let e=1/0,n=-1/0;for(const r of t)for(const i of r)Ql(i)&&(e=Math.min(e,+i),n=Math.max(n,+i));return e===1/0?[]:[e<0?-n:e,n]}function l9(t,e){return t==="enterDelay"?[0,1e3]:t=="enterDuration"?[300,1e3]:t.startsWith("y")||t.startsWith("position")?[1,0]:t==="color"?[gA(e),fE(e)]:t==="opacity"?[0,1]:t==="size"?[1,10]:[0,1]}function p5(t){return NO(t,e=>{const n=typeof e;return n==="string"||n==="boolean"})}function m5(t){return NO(t,e=>e instanceof Date)}function c9(t){return NO(t,vg)}function NO(t,e){for(const n of t)if(n.some(e))return!0;return!1}function u9(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t.startsWith("size")}function f9(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t==="enterDelay"||t==="enterDuration"||t==="updateDelay"||t==="updateDuration"||t==="exitDelay"||t==="exitDuration"}function h9(t){if(!t||!t.type)return!1;if(typeof t.type=="function")return!0;const{type:e,domain:n,range:r,interpolator:i}=t,s=n&&n.length>0,l=r&&r.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(e)&&s&&l||["sequential"].includes(e)&&s&&(l||i)||["constant","identity"].includes(e)&&l)}const d9={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},p9={threshold:"threshold",quantize:"quantize",quantile:"quantile"},m9={ordinal:"ordinal",band:"band",point:"point"},v9={constant:"constant"};var jg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function g9(t,e,n){const{coordinates:r=[],title:i}=e,[,s]=Zc("component",n),l=t.filter(({guide:m})=>m!==null),u=[],h=O9(e,t,n);if(u.push(...h),i){const{props:m}=s("title"),{defaultPosition:y,defaultOrientation:x,defaultOrder:T,defaultSize:C,defaultCrossPadding:M}=m,I=typeof i=="string"?{title:i}:i;u.push(Object.assign({type:"title",position:y,orientation:x,order:T,crossPadding:M[0],defaultSize:C},I))}return E9(l,r).forEach(([m,y])=>{const{props:x}=s(m),{defaultPosition:T,defaultPlane:C="xy",defaultOrientation:M,defaultSize:I,defaultOrder:D,defaultLength:U,defaultPadding:Z=[0,0],defaultCrossPadding:G=[0,0]}=x,W=ti({},...y),{guide:$,field:J}=W,nt=Array.isArray($)?$:[$];for(const dt of nt){const[Et,Pt]=w9(m,T,M,dt,y,l,r);if(!Et&&!Pt)continue;const Ht=Et==="left"||Et==="right",Ct=Ht?Z[1]:Z[0],Ft=Ht?G[1]:G[0],{size:jt,order:qt=D,length:Ee=U,padding:oe=Ct,crossPadding:_e=Ft}=dt;u.push(Object.assign(Object.assign({title:J},dt),{defaultSize:I,length:Ee,position:Et,plane:C,orientation:Pt,padding:oe,order:qt,crossPadding:_e,size:jt,type:m,scales:y}))}}),u}function v5(t,e,n,r,i){const[s]=Zc("component",r),{scaleInstances:l,scale:u,bbox:h}=t,p=jg(t,["scaleInstances","scale","bbox"]),m={bbox:h,library:r};return s(p)({coordinate:e,library:r,markState:i,scales:l,theme:n,value:m,scale:u})}function y9(t){return t.map(e=>{const n=ti(e,e.style);return delete n.style,n})}function Oet(t){return t.flatMap(e=>e.type=="group"?e.children:e)}function g5(t,e){const n=["left","right","bottom","top"];return H_(t,({type:s,position:l,group:u})=>n.includes(l)?u===void 0?s.startsWith("legend")?`legend-${l}`:Symbol("independent"):u==="independent"?Symbol("independent"):u:Symbol("independent")).flatMap(([,s])=>{if(s.length===1)return s[0];if(e!==void 0){const m=s.filter(M=>M.length!==void 0).map(M=>M.length),y=sp(m);if(y>e)return s.forEach(M=>M.group=Symbol("independent")),s;const x=e-y,T=s.length-m.length,C=x/T;s.forEach(M=>{M.length===void 0&&(M.length=C)})}const l=El(s,m=>m.size),u=El(s,m=>m.order),h=El(s,m=>m.crossPadding),p=s[0].position;return{type:"group",size:l,order:u,position:p,children:s,crossPadding:h}})}function _9(t,e){const n=["shape","size","color","opacity"],r=(x,T)=>x==="constant"&&T==="size",i=t.filter(({type:x,name:T})=>typeof x=="string"&&n.includes(T)&&!r(x,T)),s=i.filter(({type:x})=>x==="constant"),l=i.filter(({type:x})=>x!=="constant"),h=H_(l,x=>x.field?x.field:Symbol("independent")).map(([x,T])=>[x,[...T,...s]]).filter(([,x])=>x.some(T=>T.type!=="constant")),p=new Map(h);if(p.size===0)return[];const m=x=>x.sort(([T],[C])=>T.localeCompare(C));return Array.from(p).map(([,x])=>{const C=yA(x).sort((M,I)=>I.length-M.length).map(M=>({combination:M,option:M.map(I=>[I.name,x9(I)])}));for(const{option:M,combination:I}of C)if(!M.every(D=>D[1]==="constant")&&M.every(D=>D[1]==="discrete"||D[1]==="constant"))return["legendCategory",I];for(const[M,I]of vE)for(const{option:D,combination:U}of C)if(I.some(Z=>dE(m(Z),m(D))))return[M,U];return null}).filter(Ql)}function x9(t){const{type:e}=t;return typeof e!="string"?null:e in d9?"continuous":e in m9?"discrete":e in p9?"distribution":e in v9?"constant":null}function b9(t,e){return t.map(n=>{const{name:r}=n;if(m7(e)||pI(e)||M1(e)&&(s_(e)||Pb(e)))return null;if(r.startsWith("x"))return s_(e)?["axisArc",[n]]:Pb(e)?["axisLinear",[n]]:[M1(e)?"axisY":"axisX",[n]];if(r.startsWith("y"))return s_(e)?["axisLinear",[n]]:Pb(e)?["axisArc",[n]]:[M1(e)?"axisX":"axisY",[n]];if(r.startsWith("z"))return["axisZ",[n]];if(r.startsWith("position")){if(y7(e))return["axisRadar",[n]];if(!s_(e))return["axisY",[n]]}return null}).filter(Ql)}function E9(t,e){const n=t.filter(r=>h9(r));return[..._9(n,e),...b9(n,e)]}function kO(t){const e=em(t,"polar");if(e.length){const r=e[e.length-1],{startAngle:i,endAngle:s}=pE(r);return[i,s]}const n=em(t,"radial");if(n.length){const r=n[n.length-1],{startAngle:i,endAngle:s}=mE(r);return[i,s]}return[-Math.PI/2,Math.PI/2*3]}function S9(t){const e=/position(\d*)/g.exec(t);return e?+e[1]:null}function T9(t,e,n,r,i){const{name:s}=n[0];if(t==="axisRadar"){const l=r.filter(y=>y.name.startsWith("position")),u=S9(s);if(s===l.slice(-1)[0].name||u===null)return[null,null];const[h,p]=kO(i);return["center",(p-h)/(l.length-1)*u+h]}if(t==="axisY"&&v7(i))return M1(i)?["center","horizontal"]:["center","vertical"];if(t==="axisLinear"){const[l]=kO(i);return["center",l]}return t==="axisArc"?e[0]==="inner"?["inner",null]:["outer",null]:s_(i)?["center",null]:Pb(i)?["center",null]:t==="axisX"&&g7(i)||t==="axisX"&&_7(i)?["top",null]:e}function w9(t,e,n,r,i,s,l){const[u]=kO(l),h=[r.position||e,u!=null?u:n];return typeof t=="string"&&t.startsWith("axis")?T9(t,h,i,s,l):typeof t=="string"&&t.startsWith("legend")&&s_(l)&&r.position==="center"?["center","vertical"]:h}function A9(t,e,n=[]){return t==="x"?M1(n)?`${e}Y`:`${e}X`:t==="y"?M1(n)?`${e}X`:`${e}Y`:null}function O9(t,e,n){const[,r]=Zc("component",n),{coordinates:i}=t;function s(l,u,h,p){const m=A9(u,l,i);if(!p||!m)return;const{props:y}=r(m),{defaultPosition:x,defaultSize:T,defaultOrder:C,defaultCrossPadding:[M]}=y;return Object.assign(Object.assign({position:x,defaultSize:T,order:C,type:m,crossPadding:M},p),{scales:[h]})}return e.filter(l=>l.slider||l.scrollbar).flatMap(l=>{const{slider:u,scrollbar:h,name:p}=l;return[s("slider",p,l,u),s("scrollbar",p,l,h)]}).filter(l=>!!l)}function y5(t,e,n,r,i,s){const{type:l}=t;if(!["left","right","bottom","top"].includes(r)||typeof l!="string")return;const h=l;return(h.startsWith("axis")?I9:h.startsWith("group")?C9:h.startsWith("legendContinuous")?L9:h==="legendCategory"?D9:h.startsWith("slider")?P9:h==="title"?M9:h.startsWith("scrollbar")?R9:()=>{})(t,e,n,r,i,s)}function C9(t,e,n,r,i,s){const{children:l}=t,u=El(l,p=>p.crossPadding);l.forEach(p=>p.crossPadding=u),l.forEach(p=>y5(p,e,n,r,i,s));const h=El(l,p=>p.size);t.size=h,l.forEach(p=>p.size=h)}function R9(t,e,n,r,i,s){const{trackSize:l=6}=ti({},i.scrollbar,t);t.size=l}function M9(t,e,n,r,i,s){const l=ti({},i.title,t),{title:u,subtitle:h,spacing:p=0}=l,m=jg(l,["title","subtitle","spacing"]);if(u){const y=ho(m,"title"),x=JS(u,y);t.size=x.height}if(h){const y=ho(m,"subtitle"),x=JS(h,y);t.size+=p+x.height}}function P9(t,e,n,r,i,s){const l=()=>{const{slider:m}=i;return ti({},m,t)},{trackSize:u,handleIconSize:h}=l(),p=Math.max(u,h*2.4);t.size=p}function I9(t,e,n,r,i,s){var l;t.transform=t.transform||[{type:"hide"}];const u=r==="left"||r==="right",h=_5(t,r,i),{tickLength:p=0,labelSpacing:m=0,titleSpacing:y=0,labelAutoRotate:x}=h,T=jg(h,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),C=$S(t,s),M=KS(T,C),I=p+m;if(M&&M.length){const U=El(M,G=>G.width),Z=El(M,G=>G.height);if(u)t.size=U+I;else{const{tickFilter:G,labelTransform:W}=t;B9(C,M,e,n,G)&&!W&&x!==!1&&x!==null?(t.labelTransform="rotate(90)",t.size=U+I):(t.labelTransform=(l=t.labelTransform)!==null&&l!==void 0?l:"rotate(0)",t.size=Z+I)}}else t.size=p;const D=QS(T);D&&(u?t.size+=y+D.width:t.size+=y+D.height)}function L9(t,e,n,r,i,s){const u=(()=>{const{legendContinuous:G}=i;return ti({},G,t)})(),{labelSpacing:h=0,titleSpacing:p=0}=u,m=jg(u,["labelSpacing","titleSpacing"]),y=r==="left"||r==="right",x=ho(m,"ribbon"),{size:T}=x,C=ho(m,"handleIcon"),{size:M}=C,I=Math.max(T,M*2.4);t.size=I;const D=$S(t,s),U=KS(m,D);if(U){const G=y?"width":"height",W=El(U,$=>$[G]);t.size+=W+h}const Z=QS(m);Z&&(y?t.size=Math.max(t.size,Z.width):t.size+=p+Z.height)}function D9(t,e,n,r,i,s){const u=(()=>{const{legendCategory:Ft}=i,{title:jt}=t,[qt,Ee]=Array.isArray(jt)?[jt,void 0]:[void 0,jt];return ti({title:qt},Ft,Object.assign(Object.assign({},t),{title:Ee}))})(),{itemSpacing:h,itemMarkerSize:p,titleSpacing:m,rowPadding:y,colPadding:x,maxCols:T=1/0,maxRows:C=1/0}=u,M=jg(u,["itemSpacing","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:I,length:D}=t,U=Ft=>Math.min(Ft,C),Z=Ft=>Math.min(Ft,T),G=r==="left"||r==="right",W=D===void 0?e+(G?0:n[0]+n[1]):D,$=QS(M),J=$S(t,s),nt=KS(M,J,"itemLabel"),dt=Math.max(nt[0].height,p)+y,Et=(Ft,jt=0)=>p+Ft+h[0]+jt;G?(()=>{let Ft=-1/0,jt=0,qt=1,Ee=0,oe=-1/0,_e=-1/0;const hn=$?$.height:0,Dn=W-hn;for(const{width:Kn}of nt){const Jn=Et(Kn,x);Ft=Math.max(Ft,Jn),jt+dt>Dn?(qt++,oe=Math.max(oe,Ee),_e=Math.max(_e,jt),Ee=1,jt=dt):(jt+=dt,Ee++)}qt<=1&&(oe=Ee,_e=jt),t.size=Ft*Z(qt),t.length=_e+hn,ti(t,{cols:Z(qt),gridRow:oe})})():typeof I=="number"?(()=>{const Ft=Math.ceil(nt.length/I),jt=El(nt,qt=>Et(qt.width))*I;t.size=dt*U(Ft)-y,t.length=Math.min(jt,W)})():(()=>{let Ft=1,jt=0,qt=-1/0;for(const{width:Ee}of nt){const oe=Et(Ee,x);jt+oe>W?(qt=Math.max(qt,jt),jt=oe,Ft++):jt+=oe}Ft===1&&(qt=jt),t.size=dt*U(Ft)-y,t.length=qt})(),$&&(G?t.size=Math.max(t.size,$.width):t.size+=m+$.height)}function $S(t,e){const[n]=Zc("scale",e),{scales:r,tickCount:i,tickMethod:s}=t,l=r.find(u=>u.type!=="constant"&&u.type!=="identity");return i!==void 0&&(l.tickCount=i),s!==void 0&&(l.tickMethod=s),n(l)}function KS(t,e,n="label"){const{labelFormatter:r,tickFilter:i,label:s=!0}=t,l=jg(t,["labelFormatter","tickFilter","label"]);if(!s)return null;const u=N9(e,r,i),h=ho(l,n),p=u.map((x,T)=>Object.fromEntries(Object.entries(h).map(([C,M])=>[C,typeof M=="function"?M(x,T):M]))),m=u.map((x,T)=>{const C=p[T];return JS(x,C)});if(!p.some(x=>x.transform)){const x=u.map((T,C)=>C);t.indexBBox=new Map(x.map(T=>[T,[u[T],m[T]]]))}return m}function QS(t){const e=p=>p===!1||p===null,{title:n}=t,r=jg(t,["title"]);if(e(n)||n===void 0)return null;const i=ho(r,"title"),{direction:s,transform:l}=i,u=Array.isArray(n)?n.join(","):n;return typeof u!="string"?null:JS(u,Object.assign(Object.assign({},i),{transform:l||(s==="vertical"?"rotate(-90)":"")}))}function _5(t,e,n){const{title:r}=t,[i,s]=Array.isArray(r)?[r,void 0]:[void 0,r],{axis:l,[`axis${Px(e)}`]:u}=n;return ti({title:i},l,u,Object.assign(Object.assign({},t),{title:s}))}function x5(t,e){const n=t.getTicks?t.getTicks():t.getOptions().domain;return e?n.filter(e):n}function N9(t,e,n){const i=x5(t,n).map(l=>typeof l=="number"?q_(l):l),s=e?typeof e=="string"?Lm(e):e:t.getFormatter?t.getFormatter():l=>`${l}`;return i.map(s)}function k9(t,e){return t.getBandWidth?t.getBandWidth(e)/2:0}function B9(t,e,n,r,i){if(sp(e,T=>T.width)>n)return!0;const l=t.clone();l.update({range:[0,n]});const u=x5(t,i),h=u.map(T=>l.map(T)+k9(l,T)),p=u.map((T,C)=>C),m=-r[0],y=n+r[1],x=(T,C)=>{const{width:M}=C;return[T-M/2,T+M/2]};for(let T=0;T<p.length;T++){const C=h[T],[M,I]=x(C,e[T]);if(M<m||I>y)return!0;const D=h[T+1];if(D){const[U]=x(D,e[T+1]);if(I>U)return!0}}return!1}function JS(t,e){const n=F9(t),{filter:r}=e,i=jg(e,["filter"]);return n.attr(Object.assign(Object.assign({},i),{visibility:"none"})),n.getBBox()}function F9(t){return t instanceof xr?t:new pa({style:{text:`${t}`}})}function Hp(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function U9(t){const e=t.find(({type:i})=>i==="axisX"),n=t.find(({type:i})=>i==="axisY"),r=t.find(({type:i})=>i==="axisZ");e&&n&&r&&(e.plane="xy",n.plane="xy",r.plane="yz",r.origin=[e.bbox.x,e.bbox.y,0],r.eulerAngles=[0,-90,0],r.bbox.x=e.bbox.x,r.bbox.y=e.bbox.y,t.push(Object.assign(Object.assign({},e),{plane:"xz",showLabel:!1,showTitle:!1,origin:[e.bbox.x,e.bbox.y,0],eulerAngles:[-90,0,0]})),t.push(Object.assign(Object.assign({},n),{plane:"yz",showLabel:!1,showTitle:!1,origin:[n.bbox.x+n.bbox.width,n.bbox.y,0],eulerAngles:[0,-90,0]})),t.push(Object.assign(Object.assign({},r),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function z9(t,e,n,r){var i,s;const{width:l,height:u,depth:h,x:p=0,y:m=0,z:y=0,inset:x=(i=n.inset)!==null&&i!==void 0?i:0,insetLeft:T=x,insetTop:C=x,insetBottom:M=x,insetRight:I=x,margin:D=(s=n.margin)!==null&&s!==void 0?s:0,marginLeft:U=D,marginBottom:Z=D,marginTop:G=D,marginRight:W=D,padding:$=n.padding,paddingBottom:J=$,paddingLeft:nt=$,paddingRight:dt=$,paddingTop:Et=$}=V9(t,e,n,r),Pt=1/4,Ht=(Qi,ji,_o,Go,na)=>{const{marks:wa}=e;if(wa.length===0)return[Go,na];if(Qi-Go-na-Qi*Pt>0)return[Go,na];const ss=Qi*(1-Pt);return[ji==="auto"?ss*Go/(Go+na):Go,_o==="auto"?ss*na/(Go+na):na]},Ct=Qi=>Qi==="auto"?20:Qi!=null?Qi:20,Ft=Ct(Et),jt=Ct(J),qt=b5(t,u-Ft-jt,[Ft+G,jt+Z],["left","right"],e,n,r),{paddingLeft:Ee,paddingRight:oe}=qt,_e=l-U-W,[hn,Dn]=Ht(_e,nt,dt,Ee,oe),Kn=_e-hn-Dn,Jn=b5(t,Kn,[hn+U,Dn+W],["bottom","top"],e,n,r),{paddingTop:zr,paddingBottom:ui}=Jn,Ki=u-Z-G,[Qr,Kr]=Ht(Ki,J,Et,ui,zr),Co=Ki-Qr-Kr;return{width:l,height:u,depth:h,insetLeft:T,insetTop:C,insetBottom:M,insetRight:I,innerWidth:Kn,innerHeight:Co,paddingLeft:hn,paddingRight:Dn,paddingTop:Kr,paddingBottom:Qr,marginLeft:U,marginBottom:Z,marginTop:G,marginRight:W,x:p,y:m,z:y}}function j9(t){const{height:e,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=16,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:x=h,inset:T=0,insetLeft:C=T,insetRight:M=T,insetTop:I=T,insetBottom:D=T}=t,U=W=>W==="auto"?20:W,Z=n-U(i)-U(s)-p-m-C-M,G=e-U(l)-U(u)-y-x-I-D;return{width:Z,height:G}}function V9(t,e,n,r){const{coordinates:i}=e;if(!s_(i)&&!Pb(i))return e;const s=t.filter(D=>typeof D.type=="string"&&D.type.startsWith("axis"));if(s.length===0)return e;const l=s.map(D=>{const U=D.type==="axisArc"?"arc":"linear";return _5(D,U,n)}),u=El(l,D=>{var U;return(U=D.labelSpacing)!==null&&U!==void 0?U:0}),h=s.flatMap((D,U)=>{const Z=l[U],G=$S(D,r);return KS(Z,G)}).filter(Ql),p=El(h,D=>D.height)+u,m=s.flatMap((D,U)=>{const Z=l[U];return QS(Z)}).filter(D=>D!==null),y=m.length===0?0:El(m,D=>D.height),{inset:x=p,insetLeft:T=x,insetBottom:C=x,insetTop:M=x+y,insetRight:I=x}=e;return Object.assign(Object.assign({},e),{insetLeft:T,insetBottom:C,insetTop:M,insetRight:I})}function b5(t,e,n,r,i,s,l){const u=vc(t,C=>C.position),{padding:h=s.padding,paddingLeft:p=h,paddingRight:m=h,paddingBottom:y=h,paddingTop:x=h}=i,T={paddingBottom:y,paddingLeft:p,paddingTop:x,paddingRight:m};for(const C of r){const M=`padding${Px(Zs(C))}`,I=u.get(C)||[],D=T[M],U=dt=>{dt.size===void 0&&(dt.size=dt.defaultSize)},Z=dt=>{dt.type==="group"?(dt.children.forEach(U),dt.size=El(dt.children,Et=>Et.size)):dt.size=dt.defaultSize},G=dt=>{dt.size||(D!=="auto"?Z(dt):(y5(dt,e,n,C,s,l),U(dt)))},W=dt=>{dt.type.startsWith("axis")&&dt.labelAutoHide===void 0&&(dt.labelAutoHide=!0)},$=C==="bottom"||C==="top",J=Hp(I,dt=>dt.order),nt=I.filter(dt=>dt.type.startsWith("axis")&&dt.order==J);if(nt.length&&(nt[0].crossPadding=0),typeof D=="number")I.forEach(U),I.forEach(W);else if(I.length===0)T[M]=0;else{const dt=$?e+n[0]+n[1]:e,Et=g5(I,dt);Et.forEach(G);const Pt=Et.reduce((Ht,{size:Ct,crossPadding:Ft=12})=>Ht+Ct+Ft,0);T[M]=Pt}}return T}function Z9(t,e,n){const r=vc(t,$=>`${$.plane||"xy"}-${$.position}`),{paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:x,innerWidth:T,insetBottom:C,insetLeft:M,insetRight:I,insetTop:D,height:U,width:Z,depth:G}=n,W={xy:BO({width:Z,height:U,paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:x,innerWidth:T,insetBottom:C,insetLeft:M,insetRight:I,insetTop:D}),yz:BO({width:G,height:U,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:G,innerHeight:U,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:BO({width:Z,height:G,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:Z,innerHeight:G,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[$,J]of r.entries()){const[nt,dt]=$.split("-"),Et=W[nt][dt],[Pt,Ht]=hE(J,Ct=>typeof Ct.type!="string"?!1:!!(dt==="center"||Ct.type.startsWith("axis")&&["inner","outer"].includes(dt)));Pt.length&&H9(Pt,e,Et,dt),Ht.length&&J9(J,e,Et)}}function BO({width:t,height:e,paddingLeft:n,paddingRight:r,paddingTop:i,paddingBottom:s,marginLeft:l,marginTop:u,marginBottom:h,marginRight:p,innerHeight:m,innerWidth:y,insetBottom:x,insetLeft:T,insetRight:C,insetTop:M}){const I=n+l,D=i+u,U=r+p,Z=s+h,G=t-l-p,W=[I+T,D+M,y-T-C,m-M-x,"center",null,null];return{top:[I,0,y,D,"vertical",!0,Tu,l,G],right:[t-U,D,U,m,"horizontal",!1,Tu],bottom:[I,e-Z,y,Z,"vertical",!1,Tu,l,G],left:[0,D,I,m,"horizontal",!0,Tu],"top-left":[I,0,y,D,"vertical",!0,Tu],"top-right":[I,0,y,D,"vertical",!0,Tu],"bottom-left":[I,e-Z,y,Z,"vertical",!1,Tu],"bottom-right":[I,e-Z,y,Z,"vertical",!1,Tu],center:W,inner:W,outer:W}}function H9(t,e,n,r){const[i,s]=hE(t,l=>!!(typeof l.type=="string"&&l.type.startsWith("axis")));G9(i,e,n,r),tz(s,e,n)}function G9(t,e,n,r){r==="center"?bA(e)?Q9(t,e,n,r):Ml(e)?Y9(t,e,n):Py(e)&&q9(t,e,n,t[0].orientation):r==="inner"?W9(t,e,n):r==="outer"&&X9(t,e,n)}function W9(t,e,n){const[r,i,,s]=n,[l,u]=e.getCenter(),[h]=$_(e),p=s/2,m=h*p,y=l-m,x=u-m;for(let T=0;T<t.length;T++){const C=t[T];C.bbox={x:r+y,y:i+x,width:m*2,height:m*2}}}function X9(t,e,n){const[r,i,s,l]=n;for(const u of t)u.bbox={x:r,y:i,width:s,height:l}}function Y9(t,e,n){const[r,i,s,l]=n;for(const u of t)u.bbox={x:r,y:i,width:s,height:l}}function q9(t,e,n,r){r==="horizontal"?K9(t,e,n):r==="vertical"&&$9(t,e,n)}function $9(t,e,n){const[r,i,,s]=n,l=new Array(t.length).fill(0),h=e.map(l).filter((p,m)=>m%2===0).map(p=>p+r);for(let p=0;p<t.length;p++){const m=t[p],y=h[p],x=h[p+1]-y;m.bbox={x:y,y:i,width:x,height:s}}}function K9(t,e,n){const[r,i,s]=n,l=new Array(t.length).fill(0),h=e.map(l).filter((p,m)=>m%2===1).map(p=>p+i);for(let p=0;p<t.length;p++){const m=t[p],y=h[p],x=h[p+1]-y;m.bbox={x:r,y,width:s,height:x}}}function Q9(t,e,n,r){const[i,s,l,u]=n;for(const h of t)h.bbox={x:i,y:s,width:l,height:u},h.radar={index:t.indexOf(h),count:t.length}}function J9(t,e,n){const[r,i,s,l,u,h,p,m,y]=n,[x,T,C,M,I,D,U,Z]=u==="vertical"?["y",i,"x",r,"height",l,"width",s]:["x",r,"y",i,"width",s,"height",l];t.sort((dt,Et)=>p==null?void 0:p(dt.order,Et.order));const G=dt=>dt==="title"||dt==="group"||dt.startsWith("legend"),W=(dt,Et,Pt)=>Pt===void 0?Et:G(dt)?Pt:Et,$=(dt,Et,Pt)=>Pt===void 0?Et:G(dt)?Pt:Et,J=h?T+D:T;for(let dt=0,Et=J;dt<t.length;dt++){const Pt=t[dt],{crossPadding:Ht=0,type:Ct}=Pt,{size:Ft}=Pt;Pt.bbox={[x]:h?Et-Ft-Ht:Et+Ht,[C]:$(Ct,M,m),[I]:Ft,[U]:W(Ct,Z,y)},Et+=(Ft+Ht)*(h?-1:1)}const nt=t.filter(dt=>dt.type==="group");for(const dt of nt){const{bbox:Et,children:Pt}=dt,Ht=Et[U],Ct=Ht/Pt.length,Ft=Pt.reduce((_e,hn)=>{var Dn;const Kn=(Dn=hn.layout)===null||Dn===void 0?void 0:Dn.justifyContent;return Kn||_e},"flex-start"),jt=Pt.map((_e,hn)=>{const{length:Dn=Ct,padding:Kn=0}=_e;return Dn+(hn===Pt.length-1?0:Kn)}),qt=sp(jt),Ee=Ht-qt,oe=Ft==="flex-start"?0:Ft==="center"?Ee/2:Ee;for(let _e=0,hn=Et[C]+oe;_e<Pt.length;_e++){const Dn=Pt[_e],{padding:Kn=0}=Dn,Jn=_e===Pt.length-1?0:Kn;Dn.bbox={[I]:Et[I],[x]:Et[x],[C]:hn,[U]:jt[_e]-Jn},ti(Dn,{layout:{justifyContent:Ft}}),hn+=jt[_e]}}}function tz(t,e,n){if(t.length===0)return;const[r,i,s,l]=n,[u]=$_(e),h=l/2*u/Math.sqrt(2),p=r+s/2,m=i+l/2;for(let y=0;y<t.length;y++){const x=t[y];x.bbox={x:p-h,y:m-h,width:h*2,height:h*2}}}function Wm(t,e,n={},r=!1){if(X0(t)||Array.isArray(t)&&r)return t;const i=ho(t,e);return ti(n,i)}function tT(t,e={}){return X0(t)||Array.isArray(t)||!E5(t)?t:ti(e,t)}function E5(t){if(Object.keys(t).length===0)return!0;const{title:e,items:n}=t;return e!==void 0||n!==void 0}function Xm(t,e){return typeof t=="object"?ho(t,e):t}var ez=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},N1=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function nz(t,e,n){const{encode:r={},scale:i={},transform:s=[]}=e,l=N1(e,["encode","scale","transform"]);return[t,Object.assign(Object.assign({},l),{encode:r,scale:i,transform:s})]}function S5(t,e,n){return ez(this,void 0,void 0,function*(){const{library:r}=n,{data:i}=e,[s]=Zc("data",r),l=mz(i),{transform:u=[]}=l,m=[N1(l,["transform"]),...u].map(T=>s(T,n)),y=yield rA(m)(i),x=i&&!Array.isArray(i)&&!Array.isArray(y)?{value:y}:y;return[Array.isArray(y)?wv(y):[],Object.assign(Object.assign({},e),{data:x})]})}function rz(t,e,n){const{encode:r}=e;if(!r)return[t,e];const i={};for(const[s,l]of Object.entries(r))if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=`${s}${u===0?"":u}`;i[h]=l[u]}else i[s]=l;return[t,Object.assign(Object.assign({},e),{encode:i})]}function iz(t,e,n){const{encode:r,data:i}=e;if(!r)return[t,e];const s=_0(r,l=>hz(l)?l:{type:dz(i,l),value:l});return[t,Object.assign(Object.assign({},e),{encode:s})]}function oz(t,e,n){const{encode:r}=e;if(!r)return[t,e];const i=_0(r,(s,l)=>{const{type:u}=s;return u!=="constant"||f9(l)?s:Object.assign(Object.assign({},s),{constant:!0})});return[t,Object.assign(Object.assign({},e),{encode:i})]}function az(t,e,n){const{encode:r,data:i}=e;if(!r)return[t,e];const{library:s}=n,l=yz(s),u=_0(r,h=>l(i,h));return[t,Object.assign(Object.assign({},e),{encode:u})]}function sz(t,e,n){const{tooltip:r={}}=e;return X0(r)?[t,e]:Array.isArray(r)?[t,Object.assign(Object.assign({},e),{tooltip:{items:r}})]:vg(r)&&E5(r)?[t,Object.assign(Object.assign({},e),{tooltip:r})]:[t,Object.assign(Object.assign({},e),{tooltip:{items:[r]}})]}function lz(t,e,n){const{data:r,encode:i,tooltip:s={}}=e;if(X0(s))return[t,e];const l=y=>{if(!y)return y;if(typeof y=="string")return t.map(x=>({name:y,value:r[x][y]}));if(vg(y)){const{field:x,channel:T,color:C,name:M=x,valueFormatter:I=$=>$}=y,D=typeof I=="string"?Lm(I):I,U=T&&i[T],Z=U&&i[T].field,G=M||Z||T,W=[];for(const $ of t){const J=x?r[$][x]:U?i[T].value[$]:null;W[$]={name:G,color:C,value:D(J)}}return W}if(typeof y=="function"){const x=[];for(const T of t){const C=y(r[T],T,r,i);vg(C)?x[T]=C:x[T]={value:C}}return x}return y},{title:u,items:h=[]}=s,p=N1(s,["title","items"]),m=Object.assign({title:l(u),items:Array.isArray(h)?h.map(l):[]},p);return[t,Object.assign(Object.assign({},e),{tooltip:m})]}function cz(t,e,n){const{encode:r}=e,i=N1(e,["encode"]);if(!r)return[t,e];const s=Object.entries(r),l=s.filter(([,h])=>{const{value:p}=h;return Array.isArray(p[0])}).flatMap(([h,p])=>{const m=[[h,new Array(t.length).fill(void 0)]],{value:y}=p,x=N1(p,["value"]);for(let T=0;T<y.length;T++){const C=y[T];if(Array.isArray(C))for(let M=0;M<C.length;M++){const I=m[M]||[`${h}${M}`,new Array(t).fill(void 0)];I[1][T]=C[M],m[M]=I}}return m.map(([T,C])=>[T,Object.assign({type:"column",value:C},x)])}),u=Object.fromEntries([...s,...l]);return[t,Object.assign(Object.assign({},i),{encode:u})]}function uz(t,e,n){const{axis:r={},legend:i={},slider:s={},scrollbar:l={}}=e,u=(p,m)=>{if(typeof p=="boolean")return p?{}:null;const y=p[m];return y===void 0||y?y:null},h=typeof r=="object"?Array.from(new Set(["x","y","z",...Object.keys(r)])):["x","y","z"];return ti(e,{scale:Object.assign(Object.assign({},Object.fromEntries(h.map(p=>{const m=u(l,p);return[p,Object.assign({guide:u(r,p),slider:u(s,p),scrollbar:m},m&&{ratio:m.ratio===void 0?.5:m.ratio})]}))),{color:{guide:u(i,"color")},size:{guide:u(i,"size")},shape:{guide:u(i,"shape")},opacity:{guide:u(i,"opacity")}})}),[t,e]}function fz(t,e,n){const{animate:r}=e;return r||r===void 0?[t,e]:(ti(e,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[t,e])}function hz(t){if(typeof t!="object"||t instanceof Date||t===null)return!1;const{type:e}=t;return Ql(e)}function dz(t,e){return typeof e=="function"?"transform":typeof e=="string"&&pz(t,e)?"field":"constant"}function pz(t,e){return Array.isArray(t)?t.some(n=>n[e]!==void 0):!1}function mz(t){if((0,ge.Z)(t))return{type:"inline",value:t};if(!t)return{type:"inline",value:null};if(Array.isArray(t))return{type:"inline",value:t};const{type:e="inline"}=t,n=N1(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}var T5=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},vz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function gz(t,e,n){return T5(this,void 0,void 0,function*(){const[r,i]=yield _z(t,e,n),{encode:s,scale:l,data:u,tooltip:h}=i;if(Array.isArray(u)===!1)return null;const{channels:p}=e,m=W_(Object.entries(s).filter(([,x])=>Ql(x)),x=>x.map(([T,C])=>Object.assign({name:T},C)),([x])=>{var T;const C=(T=/([^\d]+)\d*$/.exec(x))===null||T===void 0?void 0:T[1],M=p.find(I=>I.name===C);return M!=null&&M.independent?x:C}),y=p.filter(x=>{const{name:T,required:C}=x;if(m.find(([M])=>M===T))return!0;if(C)throw new Error(`Missing encoding for channel: ${T}.`);return!1}).flatMap(x=>{const{name:T,scale:C,scaleKey:M,range:I,quantitative:D,ordinal:U}=x;return m.filter(([G])=>G.startsWith(T)).map(([G,W],$)=>{const J=W.some(qt=>qt.visual),nt=W.some(qt=>qt.constant),dt=l[G]||{},{independent:Et=!1,key:Pt=M||G,type:Ht=nt?"constant":J?"identity":C}=dt,Ct=vz(dt,["independent","key","type"]),Ft=Ht==="constant",jt=Ft?void 0:I;return{name:G,values:W,scaleKey:Et||Ft?Symbol("independent"):Pt,scale:Object.assign(Object.assign({type:Ht,range:jt},Ct),{quantitative:D,ordinal:U})}})});return[i,Object.assign(Object.assign({},e),{index:r,channels:y,tooltip:h})]})}function yz(t){const[e]=Zc("encode",t);return(n,r)=>r===void 0||n===void 0?null:Object.assign(Object.assign({},r),{type:"column",value:e(r)(n),field:xz(r)})}function _z(t,e,n){return T5(this,void 0,void 0,function*(){const{library:r}=n,[i]=Zc("transform",r),{preInference:s=[],postInference:l=[]}=e,{transform:u=[]}=t,h=[nz,S5,rz,iz,oz,az,cz,fz,uz,sz,...s.map(i),...u.map(i),...l.map(i),lz];let p=[],m=t;for(const y of h)[p,m]=yield y(p,m,n);return[p,m]})}function xz(t){const{type:e,value:n}=t;return e==="field"&&typeof n=="string"?n:null}var Bv=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},Vg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function FO(t,e,n){var r;return Bv(this,void 0,void 0,function*(){const{library:i}=n,[s]=Zc("composition",i),[l]=Zc("interaction",i),u=new Set(Object.keys(i).map(Ct=>{var Ft;return(Ft=/mark\.(.*)/.exec(Ct))===null||Ft===void 0?void 0:Ft[1]}).filter(Ql)),h=new Set(Object.keys(i).map(Ct=>{var Ft;return(Ft=/component\.(.*)/.exec(Ct))===null||Ft===void 0?void 0:Ft[1]}).filter(Ql)),p=Ct=>{const{type:Ft}=Ct;if(typeof Ft=="function"){const{props:jt={}}=Ft,{composite:qt=!0}=jt;if(qt)return"mark"}return typeof Ft!="string"?Ft:u.has(Ft)||h.has(Ft)?"mark":Ft},m=Ct=>p(Ct)==="mark",y=Ct=>p(Ct)==="standardView",x=Ct=>{const{type:Ft}=Ct;return typeof Ft!="string"?!1:!!h.has(Ft)},T=Ct=>{if(y(Ct))return[Ct];const Ft=p(Ct);return s({type:Ft,static:x(Ct)})(Ct)},C=[],M=new Map,I=new Map,D=[t],U=[];for(;D.length;){const Ct=D.shift();if(y(Ct)){const Ft=I.get(Ct),[jt,qt]=Ft?C5(Ft,Ct,i):yield A5(Ct,n);M.set(jt,Ct),C.push(jt);const Ee=qt.flatMap(T).map(oe=>dI(oe,i));if(D.push(...Ee),Ee.every(y)){const oe=yield Promise.all(Ee.map(_e=>O5(_e,n)));ZU(oe);for(let _e=0;_e<Ee.length;_e++){const hn=Ee[_e],Dn=oe[_e];I.set(hn,Dn)}}}else{const Ft=m(Ct)?Ct:yield I5(Ct,n),jt=T(Ft);Array.isArray(jt)?D.push(...jt):typeof jt=="function"&&U.push(jt())}}n.emitter.emit(bl.BEFORE_PAINT);const Z=new Map,G=new Map,W=[];e.selectAll(Ym(Be)).data(C,Ct=>Ct.key).join(Ct=>Ct.append("g").attr("className",Be).attr("id",Ft=>Ft.key).call(w5).each(function(Ft,jt,qt){zO(Ft,Ra(qt),W,n),Z.set(Ft,qt)}),Ct=>Ct.call(w5).each(function(Ft,jt,qt){zO(Ft,Ra(qt),W,n),G.set(Ft,qt)}),Ct=>Ct.each(function(Ft,jt,qt){const Ee=qt.nameInteraction.values();for(const oe of Ee)oe.destroy()}).remove());const $=(Ct,Ft,jt)=>Array.from(Ct.entries()).map(([qt,Ee])=>{const oe=jt||new Map,_e=(Kn,Jn=zr=>zr)=>oe.set(Kn,Jn),hn=M.get(qt),Dn=Ez(Ra(Ee),hn,n);return{view:qt,container:Ee,options:hn,setState:_e,update:(Kn,Jn)=>Bv(this,void 0,void 0,function*(){const ui=Oy(Array.from(oe.values()))(hn);return yield Dn(ui,Kn,()=>{Ps(Jn)&&Ft(Ct,Jn,oe)})})}}),J=(Ct=G,Ft,jt)=>{var qt;const Ee=$(Ct,J,jt);for(const oe of Ee){const{options:_e,container:hn}=oe,Dn=hn.nameInteraction;let Kn=eT(_e);Ft&&(Kn=Kn.filter(Jn=>Ft.includes(Jn[0])));for(const Jn of Kn){const[zr,ui]=Jn,Ki=Dn.get(zr);if(Ki&&((qt=Ki.destroy)===null||qt===void 0||qt.call(Ki)),ui){const Kr=UO(oe.view,zr,ui,l)(oe,Ee,n.emitter);Dn.set(zr,{destroy:Kr})}}}},nt=$(Z,J);for(const Ct of nt){const{options:Ft}=Ct,jt=new Map;Ct.container.nameInteraction=jt;for(const qt of eT(Ft)){const[Ee,oe]=qt;if(oe){const hn=UO(Ct.view,Ee,oe,l)(Ct,nt,n.emitter);jt.set(Ee,{destroy:hn})}}}J();const{width:dt,height:Et}=t,Pt=[];for(const Ct of U){const Ft=new Promise(jt=>Bv(this,void 0,void 0,function*(){for(const qt of Ct){const Ee=Object.assign({width:dt,height:Et},qt);yield FO(Ee,e,n)}jt()}));Pt.push(Ft)}n.views=C,(r=n.animations)===null||r===void 0||r.forEach(Ct=>Ct==null?void 0:Ct.cancel()),n.animations=W,n.emitter.emit(bl.AFTER_PAINT);const Ht=W.filter(Ql).map(Bz).map(Ct=>Ct.finished);return Promise.all([...Ht,...Pt])})}function w5(t){t.style("transform",e=>`translate(${e.layout.x}, ${e.layout.y})`)}function bz(t){const[,e]=Zc("interaction",t);return n=>{const[r,i]=n;try{return[r,e(r)]}catch(s){return[r,i.type]}}}function Ez(t,e,n){const{library:r}=n,i=bz(r),s=h=>h[1]&&h[1].props&&h[1].props.reapplyWhenUpdate,u=eT(e).map(i).filter(s).map(h=>h[0]);return(h,p,m)=>Bv(this,void 0,void 0,function*(){const y=[],[x,T]=yield A5(h,n);zO(x,t,y,n);for(const C of u.filter(M=>M!==p))Sz(C,t,h,x,n);for(const C of T)FO(C,t,n);return m(),{options:h,view:x}})}function Sz(t,e,n,r,i){var s;const{library:l}=i,[u]=Zc("interaction",l),p=e.node().nameInteraction,m=eT(n).find(([M])=>M===t),y=p.get(t);if(!y||((s=y.destroy)===null||s===void 0||s.call(y),!m[1]))return;const x=UO(r,t,m[1],u),T={options:n,view:r,container:e.node(),update:M=>Promise.resolve(M)},C=x(T,[],i.emitter);p.set(t,{destroy:C})}function A5(t,e){return Bv(this,void 0,void 0,function*(){const{library:n}=e,r=yield wz(t,e),i=Tz(r);t.interaction=i.interaction,t.coordinate=i.coordinate,t.marks=[...i.marks,...i.components];const s=dI(i,n),l=yield O5(s,e);return C5(l,s,n)})}function Tz(t){const{coordinate:e={},interaction:n={},style:r={},marks:i}=t,s=Vg(t,["coordinate","interaction","style","marks"]),l=i.map(x=>x.coordinate||{}),u=i.map(x=>x.interaction||{}),h=i.map(x=>x.viewStyle||{}),p=[...l,e].reduceRight((x,T)=>ti(x,T),{}),m=[n,...u].reduce((x,T)=>ti(x,T),{}),y=[...h,r].reduce((x,T)=>ti(x,T),{});return Object.assign(Object.assign({},s),{marks:i,coordinate:p,interaction:m,style:y})}function wz(t,e){return Bv(this,void 0,void 0,function*(){const{library:n}=e,[r,i]=Zc("mark",n),s=new Set(Object.keys(n).map(T=>{var C;return(C=/component\.(.*)/.exec(T))===null||C===void 0?void 0:C[1]}).filter(Ql)),{marks:l}=t,u=[],h=[],p=[...l],{width:m,height:y}=j9(t),x={options:t,width:m,height:y};for(;p.length;){const[T]=p.splice(0,1),C=yield I5(T,e),{type:M=mg("G2Mark type is required."),key:I}=C;if(s.has(M))h.push(C);else{const{props:D={}}=i(M),{composite:U=!0}=D;if(!U)u.push(C);else{const{data:Z}=C,G=Object.assign(Object.assign({},C),{data:Z&&(Array.isArray(Z)?Z:Z.value)}),W=yield r(G,x),$=Array.isArray(W)?W:[W];p.unshift(...$.map((J,nt)=>Object.assign(Object.assign({},J),{key:`${I}-${nt}`})))}}}return Object.assign(Object.assign({},t),{marks:u,components:h})})}function O5(t,e){return Bv(this,void 0,void 0,function*(){const{library:n}=e,[r]=Zc("theme",n),[,i]=Zc("mark",n),{theme:s,marks:l,coordinates:u=[]}=t,h=r(P5(s)),p=new Map;for(const y of l){const{type:x}=y,{props:T={}}=i(x),C=yield gz(y,T,e);if(C){const[M,I]=C;p.set(M,I)}}const m=vc(Array.from(p.values()).flatMap(y=>y.channels),({scaleKey:y})=>y);for(const y of m.values()){const x=y.reduce((G,{scale:W})=>ti(G,W),{}),{scaleKey:T}=y[0],{values:C}=y[0],M=Array.from(new Set(C.map(G=>G.field).filter(Ql))),I=ti({guide:{title:M.length===0?void 0:M},field:M[0]},x),{name:D}=y[0],U=y.flatMap(({values:G})=>G.map(W=>W.value)),Z=Object.assign(Object.assign({},FU(D,U,I,u,h,n)),{uid:Symbol("scale"),key:T});y.forEach(G=>G.scale=Z)}return p})}function UO(t,e,n,r){const i=t.theme,s=typeof e=="string"?i[e]||{}:{};return r(ti(s,Object.assign({type:e},n)))}function C5(t,e,n){var r;const[i]=Zc("mark",n),[s]=Zc("theme",n),[l]=Zc("labelTransform",n),{key:u,frame:h=!1,theme:p,clip:m,style:y={},labelTransform:x=[]}=e,T=s(P5(p)),C=Array.from(t.values()),M=jU(C,e),I=y9(g9(jz(Array.from(M),C,t),e,n)),D=z9(I,e,T,n),U=p7(D,e,n),Z=h?ti({mainLineWidth:1,mainStroke:"#000"},y):y;Z9(g5(I),U,D),U9(I);const G=new Map(Array.from(t.values()).flatMap(nt=>{const{channels:dt}=nt;return dt.map(({scale:Et})=>[Et.uid,s5(Et,n)])}));zU(t,G);const W={};for(const nt of I){const{scales:dt=[]}=nt,Et=[];for(const Pt of dt){const{name:Ht,uid:Ct}=Pt,Ft=(r=G.get(Ct))!==null&&r!==void 0?r:s5(Pt,n);Et.push(Ft),Ht==="y"&&Ft.update(Object.assign(Object.assign({},Ft.getOptions()),{xScale:W.x})),a5(W,{[Ht]:Ft})}nt.scaleInstances=Et}const $=[];for(const[nt,dt]of t.entries()){const{children:Et,dataDomain:Pt,modifier:Ht,key:Ct}=nt,{index:Ft,channels:jt,tooltip:qt}=dt,Ee=Object.fromEntries(jt.map(({name:Qi,scale:ji})=>[Qi,ji])),oe=_0(Ee,({uid:Qi})=>G.get(Qi));a5(W,oe);const _e=UU(jt,oe),hn=i(nt),[Dn,Kn,Jn]=Cz(hn(Ft,oe,_e,U)),zr=Pt||Dn.length,ui=Ht?Ht(Kn,zr,D):[],Ki=Qi=>{var ji,_o;return(_o=(ji=qt.title)===null||ji===void 0?void 0:ji[Qi])===null||_o===void 0?void 0:_o.value},Qr=Qi=>qt.items.map(ji=>ji[Qi]),Kr=Dn.map((Qi,ji)=>{const _o=Object.assign({points:Kn[ji],transform:ui[ji],index:Qi,markKey:Ct,viewKey:u},qt&&{title:Ki(Qi),items:Qr(Qi)});for(const[Go,na]of Object.entries(_e))_o[Go]=na[Qi],Jn&&(_o[`series${Sv(Go)}`]=Jn[ji].map(wa=>na[wa]));return Jn&&(_o.seriesIndex=Jn[ji]),Jn&&qt&&(_o.seriesItems=Jn[ji].map(Go=>Qr(Go)),_o.seriesTitle=Jn[ji].map(Go=>Ki(Go))),_o});dt.data=Kr,dt.index=Dn;const Co=Et==null?void 0:Et(Kr,oe,D);$.push(...Co||[])}return[{layout:D,theme:T,coordinate:U,markState:t,key:u,clip:m,scale:W,style:Z,components:I,labelTransform:Oy(x.map(l))},$]}function zO(t,e,n,r){return Bv(this,void 0,void 0,function*(){const{library:i}=r,{components:s,theme:l,layout:u,markState:h,coordinate:p,key:m,style:y,clip:x,scale:T}=t,{x:C,y:M,width:I,height:D}=u,U=Vg(u,["x","y","width","height"]),Z=["view","plot","main","content"],G=Z.map((oe,_e)=>_e),W=["a","margin","padding","inset"],$=Z.map(oe=>rE(Object.assign({},l.view,y),oe)),J=W.map(oe=>ho(U,oe)),nt=oe=>oe.style("x",_e=>Ct[_e].x).style("y",_e=>Ct[_e].y).style("width",_e=>Ct[_e].width).style("height",_e=>Ct[_e].height).each(function(_e,hn,Dn){Vz(Ra(Dn),$[_e])});let dt=0,Et=0,Pt=I,Ht=D;const Ct=G.map(oe=>{const _e=J[oe],{left:hn=0,top:Dn=0,bottom:Kn=0,right:Jn=0}=_e;return dt+=hn,Et+=Dn,Pt-=hn+Jn,Ht-=Dn+Kn,{x:dt,y:Et,width:Pt,height:Ht}});e.selectAll(Ym(z)).data(G.filter(oe=>Ql($[oe])),oe=>Z[oe]).join(oe=>oe.append("rect").attr("className",z).style("zIndex",-2).call(nt),oe=>oe.call(nt),oe=>oe.remove());const Ft=Iz(h),jt=Ft?{duration:Ft[1]}:!1;for(const[,oe]of H_(s,_e=>`${_e.type}-${_e.position}`))oe.forEach((_e,hn)=>_e.index=hn);const qt=e.selectAll(Ym(Bt)).data(s,oe=>`${oe.type}-${oe.position}-${oe.index}`).join(oe=>oe.append("g").style("zIndex",({zIndex:_e})=>_e||-1).attr("className",Bt).append(_e=>v5(ti({animate:jt,scale:T},_e),p,l,i,h)),oe=>oe.transition(function(_e,hn,Dn){const{preserve:Kn=!1}=_e;if(Kn)return;const Jn=v5(ti({animate:jt,scale:T},_e),p,l,i,h),{attributes:zr}=Jn,[ui]=Dn.childNodes;return ui.update(zr,!1)})).transitions();n.push(...qt.flat().filter(Ql));const Ee=e.selectAll(Ym(At)).data([u],()=>m).join(oe=>oe.append("rect").style("zIndex",0).style("fill","transparent").attr("className",At).call(L5).call(N5,Array.from(h.keys())).call(k5,x),oe=>oe.call(N5,Array.from(h.keys())).call(_e=>Ft?zz(_e,Ft):L5(_e)).call(k5,x)).transitions();n.push(...Ee.flat());for(const[oe,_e]of h.entries()){const{data:hn}=_e,{key:Dn,class:Kn,type:Jn}=oe,zr=e.select(`#${Dn}`),ui=Nz(oe,_e,t,r),Ki=kz(oe,_e,t,i),Qr=Fz(oe,_e,t,i),Kr=Uz(oe,_e,t,i),Co=Lz(e,zr,Kn,"element"),Qi=zr.selectAll(Ym(De)).selectFacetAll(Co).data(hn,ji=>ji.key,ji=>ji.groupKey).join(ji=>ji.append(ui).attr("className",De).attr("markType",Jn).transition(function(_o,Go,na){return Ki(_o,[na])}),ji=>ji.call(_o=>{const Go=_o.parent(),na=iA(wa=>{const[js,ba]=wa.getBounds().min;return[js,ba]});_o.transition(function(wa,js,ba){Dz(ba,Go,na);const ss=ui(wa,js),Tl=Qr(wa,[ba],[ss]);return Tl!==null||(ba.nodeName===ss.nodeName&&ss.nodeName!=="g"?Ix(ba,ss):(ba.parentNode.replaceChild(ss,ba),ss.className=De,ss.markType=Jn,ss.__data__=ba.__data__)),Tl}).attr("markType",Jn).attr("className",De)}),ji=>ji.each(function(_o,Go,na){na.__removed__=!0}).transition(function(_o,Go,na){return Kr(_o,[na])}).remove(),ji=>ji.append(ui).attr("className",De).attr("markType",Jn).transition(function(_o,Go,na){const{__fromElements__:wa}=na,js=Qr(_o,wa,[na]);return new Su(wa,null,na.parentNode).transition(js).remove(),js}),ji=>ji.transition(function(_o,Go,na){const js=new Su([],na.__toData__,na.parentNode).append(ui).attr("className",De).attr("markType",Jn).nodes();return Qr(_o,[na],js)}).remove()).transitions();n.push(...Qi.flat())}Az(t,e,n,i,r)})}function Az(t,e,n,r,i){const[s]=Zc("labelTransform",r),{markState:l,labelTransform:u}=t,h=e.select(Ym(rn)).node(),p=new Map,m=new Map,y=Array.from(l.entries()).flatMap(([I,D])=>{const{labels:U=[],key:Z}=I,G=Pz(I,D,t,r,i),W=e.select(`#${Z}`).selectAll(Ym(De)).nodes().filter($=>!$.__removed__);return U.flatMap(($,J)=>{const{transform:nt=[]}=$,dt=Vg($,["transform"]);return W.flatMap(Et=>{const Pt=Oz(dt,J,Et);return Pt.forEach(Ht=>{p.set(Ht,G),m.set(Ht,$)}),Pt})})}),x=Ra(h).selectAll(Ym(Ae)).data(y,I=>I.key).join(I=>I.append(D=>p.get(D)(D)).attr("className",Ae),I=>I.each(function(D,U,Z){const W=p.get(D)(D);Ix(Z,W)}),I=>I.remove()).nodes(),T=vc(x,I=>m.get(I.__data__)),{coordinate:C}=t,M={canvas:i.canvas,coordinate:C};for(const[I,D]of T){const{transform:U=[]}=I;Oy(U.map(s))(D,M)}u&&u(x,M)}function Oz(t,e,n){const{seriesIndex:r,seriesKey:i,points:s,key:l,index:u}=n.__data__,h=Mz(n);if(!r)return[Object.assign(Object.assign({},t),{key:`${l}-${e}`,bounds:h,index:u,points:s,dependentElement:n})];const p=Rz(t),m=r.map((y,x)=>Object.assign(Object.assign({},t),{key:`${i[x]}-${e}`,bounds:[s[x]],index:y,points:s,dependentElement:n}));return p?p(m):m}function Cz([t,e,n]){if(n)return[t,e,n];const r=[],i=[];for(let s=0;s<t.length;s++){const l=t[s],u=e[s];u.every(([h,p])=>Ql(h)&&Ql(p))&&(r.push(l),i.push(u))}return[r,i]}function Rz(t){const{selector:e}=t;if(!e)return null;if(typeof e=="function")return e;if(e==="first")return n=>[n[0]];if(e==="last")return n=>[n[n.length-1]];throw new Error(`Unknown selector: ${e}`)}function Mz(t){const e=t.cloneNode(),n=t.getAnimations();e.style.visibility="hidden",n.forEach(l=>{const u=l.effect.getKeyframes();e.attr(u[u.length-1])}),t.parentNode.appendChild(e);const r=e.getLocalBounds();e.destroy();const{min:i,max:s}=r;return[i,s]}function Pz(t,e,n,r,i){const[s]=Zc("shape",r),{data:l,encode:u}=t,{data:h,defaultLabelShape:p}=e,m=h.map(M=>M.points),y=_0(u,M=>M.value),{theme:x,coordinate:T}=n,C=Object.assign(Object.assign({},i),{document:fI(i),theme:x,coordinate:T});return M=>{const{index:I,points:D}=M,U=l[I],{formatter:Z=Ee=>`${Ee}`,transform:G,style:W,render:$}=M,J=Vg(M,["formatter","transform","style","render"]),nt=_0(Object.assign(Object.assign({},J),W),Ee=>R5(Ee,U,I,l,{channel:y})),{shape:dt=p,text:Et}=nt,Pt=Vg(nt,["shape","text"]),Ht=typeof Z=="string"?Lm(Z):Z,Ct=Object.assign(Object.assign({},Pt),{text:Ht(Et,U,I,l),datum:U}),Ft=Object.assign({type:`label.${dt}`,render:$},Pt),jt=s(Ft,C),qt=M5(x,"label",dt,"label");return jt(D,Ct,qt,m)}}function R5(t,e,n,r,i){return typeof t=="function"?t(e,n,r,i):typeof t!="string"?t:vg(e)&&e[t]!==void 0?e[t]:t}function Iz(t){let e=-1/0,n=1/0;for(const[r,i]of t){const{animate:s={}}=r,{data:l}=i,{enter:u={},update:h={},exit:p={}}=s,{type:m,duration:y=300,delay:x=0}=h,{type:T,duration:C=300,delay:M=0}=u,{type:I,duration:D=300,delay:U=0}=p;for(const Z of l){const{updateType:G=m,updateDuration:W=y,updateDelay:$=x,enterType:J=T,enterDuration:nt=C,enterDelay:dt=M,exitDuration:Et=D,exitDelay:Pt=U,exitType:Ht=I}=Z;(G===void 0||G)&&(e=Math.max(e,W+$),n=Math.min(n,$)),(Ht===void 0||Ht)&&(e=Math.max(e,Et+Pt),n=Math.min(n,Pt)),(J===void 0||J)&&(e=Math.max(e,nt+dt),n=Math.min(n,dt))}}return e===-1/0?null:[n,e-n]}function Lz(t,e,n,r){return t.node().parentElement.findAll(s=>s.style.facet!==void 0&&s.style.facet===n&&s!==e.node()).flatMap(s=>s.getElementsByClassName(r))}function Dz(t,e,n){if(!t.__facet__)return;const r=t.parentNode.parentNode,i=e.parentNode,[s,l]=n(r),[u,h]=n(i),p=`translate(${s-u}, ${l-h})`;oA(t,p),e.append(t)}function Nz(t,e,n,r){const{library:i}=r,[s]=Zc("shape",i),{data:l,encode:u}=t,{defaultShape:h,data:p,shape:m}=e,y=_0(u,U=>U.value),x=p.map(U=>U.points),{theme:T,coordinate:C}=n,{type:M,style:I={}}=t,D=Object.assign(Object.assign({},r),{document:fI(r),coordinate:C,theme:T});return U=>{const{shape:Z=h}=I,{shape:G=Z,points:W,seriesIndex:$,index:J}=U,nt=Vg(U,["shape","points","seriesIndex","index"]),dt=Object.assign(Object.assign({},nt),{index:J}),Et=$?$.map(jt=>l[jt]):l[J],Pt=$||J,Ht=_0(I,jt=>R5(jt,Et,Pt,l,{channel:y})),Ct=m[G]?m[G](Ht,D):s(Object.assign(Object.assign({},Ht),{type:D5(t,G)}),D),Ft=M5(T,M,G,h);return Ct(W,dt,Ft,x)}}function M5(t,e,n,r){if(typeof e!="string")return;const{color:i}=t,s=t[e]||{},l=s[n]||s[r];return Object.assign({color:i},l)}function jO(t,e,n,r,i){var s,l;const[,u]=Zc("shape",i),[h]=Zc("animation",i),{defaultShape:p,shape:m}=n,{theme:y,coordinate:x}=r,C=`default${Sv(t)}Animation`,{[C]:M}=((s=m[p])===null||s===void 0?void 0:s.props)||u(D5(e,p)).props,{[t]:I={}}=y,D=((l=e.animate)===null||l===void 0?void 0:l[t])||{},U={coordinate:x};return(Z,G,W)=>{const{[`${t}Type`]:$,[`${t}Delay`]:J,[`${t}Duration`]:nt,[`${t}Easing`]:dt}=Z,Et=Object.assign({type:$||M},D);if(!Et.type)return null;const Ct=h(Et,U)(G,W,ti(I,{delay:J,duration:nt,easing:dt}));return Array.isArray(Ct)?Ct:[Ct]}}function kz(t,e,n,r){return jO("enter",t,e,n,r)}function Bz(t){return t.finished.then(()=>{t.cancel()}),t}function Fz(t,e,n,r){return jO("update",t,e,n,r)}function Uz(t,e,n,r){return jO("exit",t,e,n,r)}function P5(t={}){if(typeof t=="string")return{type:t};const{type:e="light"}=t,n=Vg(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}function eT(t){const e={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:n={}}=t;return Object.entries(ti(e,n)).reverse()}function I5(t,e){return Bv(this,void 0,void 0,function*(){const{data:n}=t,r=Vg(t,["data"]);if(n==null)return t;const[,{data:i}]=yield S5([],{data:n},e);return Object.assign({data:i},r)})}function L5(t){t.style("transform",e=>`translate(${e.paddingLeft+e.marginLeft}, ${e.paddingTop+e.marginTop})`).style("width",e=>e.innerWidth).style("height",e=>e.innerHeight)}function zz(t,e){const[n,r]=e;t.transition(function(i,s,l){const{transform:u,width:h,height:p}=l.style,{paddingLeft:m,paddingTop:y,innerWidth:x,innerHeight:T,marginLeft:C,marginTop:M}=i,I=[{transform:u,width:h,height:p},{transform:`translate(${m+C}, ${y+M})`,width:x,height:T}];return l.animate(I,{delay:n,duration:r,fill:"both"})})}function D5(t,e){const{type:n}=t;return typeof e=="string"?`${n}.${e}`:e}function N5(t,e){const n=s=>s.class!==void 0?`${s.class}`:"";t.nodes().length===0||(t.selectAll(Ym(ir)).data(e,s=>s.key).join(s=>s.append("g").attr("className",ir).attr("id",l=>l.key).style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.remove()),t.select(Ym(rn)).node())||t.append("g").attr("className",rn).style("zIndex",0)}function Ym(...t){return t.map(e=>`.${e}`).join("")}function k5(t,e){t.node()&&t.style("clipPath",n=>{if(!e)return null;const{paddingTop:r,paddingLeft:i,marginLeft:s,marginTop:l,innerWidth:u,innerHeight:h}=n;return new vo({style:{x:i+s,y:r+l,width:u,height:h}})})}function jz(t,e,n){var r;for(const[p]of n.entries())if(p.type==="cell")return t.filter(m=>m.name!=="shape");if(e.length!==1||t.some(p=>p.name==="shape"))return t;const{defaultShape:i}=e[0];if(!["point","line","rect","hollow"].includes(i))return t;const l={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},h={field:((r=t.find(p=>p.name==="color"))===null||r===void 0?void 0:r.field)||null,name:"shape",type:"constant",domain:[],range:[l[i]]};return[...t,h]}function Vz(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function B5(t){const e=ti({},t),n=new Map([[e,null]]),r=new Map([[null,-1]]),i=[e];for(;i.length;){const s=i.shift();if(s.key===void 0){const u=n.get(s),h=r.get(s),p=u===null?"0":`${u.key}-${h}`;s.key=p}const{children:l=[]}=s;if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=ti({},l[u]);l[u]=h,n.set(h,s),r.set(h,u),i.push(h)}}return e}function Zz(t,e){const n=new $2;return n.registerPlugin(new K2),new Fs({width:t,height:e,container:document.createElement("div"),renderer:n})}function Hz(t,e={},n=()=>{},r=i=>{throw i}){const{width:i=640,height:s=480,depth:l=0}=t,u=B5(t),{canvas:h=Zz(i,s),emitter:p=new wn,library:m}=e;e.canvas=h,e.emitter=p;const{width:y,height:x}=h.getConfig();(y!==i||x!==s)&&h.resize(i,s),p.emit(bl.BEFORE_RENDER);const T=Ra(h.document.documentElement);return h.ready.then(()=>FO(Object.assign(Object.assign({},u),{width:i,height:s,depth:l}),T,e)).then(()=>{if(l){const[C,M]=h.document.documentElement.getPosition();h.document.documentElement.setPosition(C,M,-l/2)}h.requestAnimationFrame(()=>{p.emit(bl.AFTER_RENDER),n==null||n()})}).catch(C=>{r==null||r(C)}),Wz(h.getConfig().container)}function Cet(t,e={},n=()=>{},r=i=>{throw i}){var i;const{width:s=640,height:l=480}=t,u=B5(t),{group:h=new Group,emitter:p=new EventEmitter,library:m}=e;h!=null&&h.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const y=select(h);return e.group=h,e.emitter=p,e.canvas=e.canvas||((i=h==null?void 0:h.ownerDocument)===null||i===void 0?void 0:i.defaultView),p.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},u),{width:s,height:l}),y,e).then(()=>{var x;(x=e.canvas)===null||x===void 0||x.requestAnimationFrame(()=>{p.emit(ChartEvent.AFTER_RENDER),n==null||n()})}).catch(x=>{r==null||r(x)}),h}function F5(t,e={},n=!1){const{canvas:r,emitter:i}=e;r&&(Gz(r),n?r.destroy():r.destroyChildren()),i.off()}function Gz(t){const e=t.getRoot().querySelectorAll(`.${Be}`);e==null||e.forEach(n=>{const{nameInteraction:r=new Map}=n;(r==null?void 0:r.size)>0&&Array.from(r==null?void 0:r.values()).forEach(i=>{i==null||i.destroy()})})}function Wz(t){return typeof t=="string"?document.getElementById(t):t}const k1=t=>t?parseInt(t):0;function Xz(t){const e=getComputedStyle(t),n=t.clientWidth||k1(e.width),r=t.clientHeight||k1(e.height),i=k1(e.paddingLeft)+k1(e.paddingRight),s=k1(e.paddingTop)+k1(e.paddingBottom);return{width:n-i,height:r-s}}function Ret(t){const{height:e,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=0,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:x=h,inset:T=0,insetLeft:C=T,insetRight:M=T,insetTop:I=T,insetBottom:D=T}=t,U=W=>W==="auto"?20:W,Z=n-U(i)-U(s)-p-m-C-M,G=e-U(l)-U(u)-y-x-I-D;return{width:Z,height:G}}function VO(t,e){const n=[t];for(;n.length;){const r=n.shift();e&&e(r);const i=r.children||[];for(const s of i)n.push(s)}}class ZO{constructor(e={},n){this.parentNode=null,this.children=[],this.index=0,this.type=n,this.value=e}map(e=n=>n){const n=e(this.value);return this.value=n,this}attr(e,n){return arguments.length===1?this.value[e]:this.map(r=>(r[e]=n,r))}append(e){const n=new e({});return n.children=[],this.push(n),n}push(e){return e.parentNode=this,e.index=this.children.length,this.children.push(e),this}remove(){const e=this.parentNode;if(e){const{children:n}=e,r=n.findIndex(i=>i===this);n.splice(r,1)}return this}getNodeByKey(e){let n=null;return VO(this,i=>{e===i.attr("key")&&(n=i)}),n}getNodesByType(e){const n=[];return VO(this,i=>{e===i.type&&n.push(i)}),n}getNodeByType(e){let n=null;return VO(this,r=>{n||e===r.type&&(n=r)}),n}call(e,...n){return e(this.map(),...n),this}getRoot(){let e=this;for(;e&&e.parentNode;)e=e.parentNode;return e}}var U5=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const HO=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title"],z5="__remove__",j5="__callback__",V5=1,Z5=1;function Yz(t){if(t===void 0){const e=document.createElement("div");return e[z5]=!0,e}return typeof t=="string"?document.getElementById(t):t}function qz(t){const e=t.parentNode;e&&e.removeChild(t)}function $z(t){if(t.type!==null)return t;const e=t.children[t.children.length-1];for(const n of HO)e.attr(n,t.attr(n));return e}function H5(t){return Object.assign(Object.assign({},t.value),{type:t.type})}function GO(t,e){const{width:n,height:r,autoFit:i,depth:s=0}=t;let l=640,u=480;if(i){const{width:h,height:p}=Xz(e);l=h||l,u=p||u}return l=n||l,u=r||u,{width:Math.max((0,ge.Z)(l)?l:V5,V5),height:Math.max((0,ge.Z)(u)?u:Z5,Z5),depth:s}}function Kz(t){const e=$z(t),n=[e],r=new Map;for(r.set(e,H5(e));n.length;){const i=n.pop(),s=r.get(i),{children:l=[]}=i;for(const u of l)if(u.type===j5)s.children=u.value;else{const h=H5(u),{children:p=[]}=s;p.push(h),n.push(u),r.set(u,h),s.children=p}}return r.get(e)}function Qz(t,e){return typeof t=="function"?!0:new Set(Object.keys(e)).has(t)}function Jz(t,e){return typeof t!="function"&&new Set(Object.keys(e)).has(t)}function tj(t,e,n,r,i){const{type:s}=t,{type:l=n||s}=e;if(Jz(l,i)){for(const u of HO)t.attr(u)!==void 0&&e[u]===void 0&&(e[u]=t.attr(u));return e}if(Qz(l,r)){const u={type:"view"},h=Object.assign({},e);for(const p of HO)h[p]!==void 0&&(u[p]=h[p],delete h[p]);return Object.assign(Object.assign({},u),{children:[h]})}return e}function ej(t,e,n){if(typeof t=="function")return e.mark;const i=Object.assign(Object.assign({},e),n)[t];if(!i)throw new Error(`Unknown mark: ${t}.`);return i}function nj(t,e,n){if(typeof t=="function"){const h=new ZO;return h.value=t,h.type=j5,h}const{type:r,children:i}=t,s=U5(t,["type","children"]),l=ej(r,e,n),u=new l;return u.value=s,u.type=r,u}function rj(t,e){const{type:n,children:r}=e,i=U5(e,["type","children"]);t.type===n||n===void 0?oE(t.value,i):typeof n=="string"&&(t.type=n,t.value=i)}function ij(t,e,n,r){if(!t)return;const i=[[t,e]];for(;i.length;){const[s,l]=i.shift(),u=nj(l,n,r);Array.isArray(s.children)&&s.push(u);const{children:h}=l;if(Array.isArray(h))for(const p of h)i.push([u,p]);else typeof h=="function"&&i.push([u,h])}}function oj(t,e,n,r,i){const s=tj(t,e,n,r,i),l=[[null,t,s]];for(;l.length;){const[u,h,p]=l.shift();if(!h)ij(u,p,r,i);else if(!p)h.remove();else{rj(h,p);const{children:m}=p,{children:y}=h;if(Array.isArray(m)&&Array.isArray(y)){const x=Math.max(m.length,y.length);for(let T=0;T<x;T++){const C=m[T],M=y[T];l.push([h,M,C])}}else typeof m=="function"&&l.push([h,null,m])}}}function aj(){let t,e;return[new Promise((r,i)=>{e=r,t=i}),e,t]}function sj(t,e,{key:n=e}){t.prototype[e]=function(r){return arguments.length===0?this.attr(n):this.attr(n,r)}}function lj(t,e,{key:n=e}){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(n);if(Array.isArray(r))return this.attr(n,r);const i=[...this.attr(n)||[],r];return this.attr(n,i)}}function cj(t,e,{key:n=e}){t.prototype[e]=function(r,i){if(arguments.length===0)return this.attr(n);if(arguments.length===1&&typeof r!="string")return this.attr(n,r);const s=this.attr(n)||{};return s[r]=arguments.length===1?!0:i,this.attr(n,s)}}function uj(t,e,n){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(e);if(Array.isArray(r))return this.attr(e,{items:r});if(vg(r)&&(r.title!==void 0||r.items!==void 0))return this.attr(e,r);if(r===null||r===!1)return this.attr(e,r);const i=this.attr(e)||{},{items:s=[]}=i;return s.push(r),i.items=s,this.attr(e,i)}}function fj(t,e,{ctor:n}){t.prototype[e]=function(r){const i=this.append(n);return e==="mark"&&(i.type=r),i}}function hj(t,e,{ctor:n}){t.prototype[e]=function(){return this.type=null,this.append(n)}}function nT(t){return e=>{for(const[n,r]of Object.entries(t)){const{type:i}=r;i==="value"?sj(e,n,r):i==="array"?lj(e,n,r):i==="object"?cj(e,n,r):i==="node"?fj(e,n,r):i==="container"?hj(e,n,r):i==="mix"&&uj(e,n,r)}return e}}function G5(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{type:"node",ctor:n}]))}const W5={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},dj=Object.assign(Object.assign({},W5),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),pj=Object.assign(Object.assign({},W5),{labelTransform:{type:"array"}});var mj=function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(s=(i<3?l(s):i>3?l(e,n,s):l(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};let rT=class extends ZO{changeData(e){var n;const r=this.getRoot();if(r)return this.attr("data",e),!((n=this.children)===null||n===void 0)&&n.length&&this.children.forEach(i=>{i.attr("data",e)}),r==null?void 0:r.render()}getView(){const e=this.getRoot(),{views:n}=e.getContext();if(n!=null&&n.length)return n.find(r=>r.key===this._key)}getScale(){var e;return(e=this.getView())===null||e===void 0?void 0:e.scale}getScaleByChannel(e){const n=this.getScale();if(n)return n[e]}getCoordinate(){var e;return(e=this.getView())===null||e===void 0?void 0:e.coordinate}getTheme(){var e;return(e=this.getView())===null||e===void 0?void 0:e.theme}getGroup(){const e=this._key;return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}show(){const e=this.getGroup();e&&!e.isVisible()&&FS(e)}hide(){const e=this.getGroup();e&&e.isVisible()&&EO(e)}};rT=mj([nT(pj)],rT);var vj=function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(s=(i<3?l(s):i>3?l(e,n,s):l(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};let WO=class extends ZO{changeData(e){const n=this.getRoot();if(n)return this.attr("data",e),n==null?void 0:n.render()}getMark(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(!n)return;const{markState:r}=n,i=Array.from(r.keys()).find(s=>s.key===this.attr("key"));return r.get(i)}getScale(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(n)return n==null?void 0:n.scale}getScaleByChannel(e){var n,r;const i=(n=this.getRoot())===null||n===void 0?void 0:n.getView();if(i)return(r=i==null?void 0:i.scale)===null||r===void 0?void 0:r[e]}getGroup(){const e=this.attr("key");return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}};WO=vj([nT(dj)],WO);var gj=function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(s=(i<3?l(s):i>3?l(e,n,s):l(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},yj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const _j="G2_CHART_KEY";class xj extends rT{constructor(e){const{container:n,canvas:r,renderer:i,plugins:s,lib:l,createCanvas:u}=e,h=yj(e,["container","canvas","renderer","plugins","lib","createCanvas"]);super(h,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=Q2(()=>{this.forceFit()},300),this._renderer=i||new $2,this._plugins=s||[],this._container=Yz(n),this._emitter=new wn,this._context={library:Object.assign(Object.assign({},l),F_),emitter:this._emitter,canvas:r,createCanvas:u},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._context.canvas.getConfig().supportsCSSTransform=!0,this._bindAutoFit(),this._rendering=!0;const e=new Promise((s,l)=>Hz(this._computedOptions(),this._context,this._createResolve(s),this._createReject(l))),[n,r,i]=aj();return e.then(r).catch(i).then(()=>this._renderTrailing()),n}options(e){if(arguments.length===0)return Kz(this);const{type:n}=e;return n&&(this._previousDefinedType=n),oj(this,e,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(e,n,r){return this._emitter.on(e,n,r),this}once(e,n){return this._emitter.once(e,n),this}emit(e,...n){return this._emitter.emit(e,...n),this}off(e,n){return this._emitter.off(e,n),this}clear(){const e=this.options();this.emit(bl.BEFORE_CLEAR),this._reset(),F5(e,this._context,!1),this.emit(bl.AFTER_CLEAR)}destroy(){const e=this.options();this.emit(bl.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),F5(e,this._context,!0),this._container[z5]&&qz(this._container),this.emit(bl.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:e,height:n}=GO(this.options(),this._container);if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(bl.BEFORE_CHANGE_SIZE);const r=this.render();return r.then(()=>{this.emit(bl.AFTER_CHANGE_SIZE)}),r}changeSize(e,n){if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(bl.BEFORE_CHANGE_SIZE),this.attr("width",e),this.attr("height",n);const r=this.render();return r.then(()=>{this.emit(bl.AFTER_CHANGE_SIZE)}),r}_create(){const{library:e}=this._context,n=s=>s.startsWith("mark.")||s==="component.axisX"||s==="component.axisY"||s==="component.legends",r=["mark.mark",...Object.keys(e).filter(n)];this._marks={};for(const s of r){const l=s.split(".").pop();class u extends WO{constructor(){super({},l)}}this._marks[l]=u,this[l]=function(h){const p=this.append(u);return l==="mark"&&(p.type=h),p}}const i=["composition.view",...Object.keys(e).filter(s=>s.startsWith("composition.")&&s!=="composition.mark")];this._compositions=Object.fromEntries(i.map(s=>{const l=s.split(".").pop();let u=class extends rT{constructor(){super({},l)}};return u=gj([nT(G5(this._marks))],u),[l,u]}));for(const s of Object.values(this._compositions))nT(G5(this._compositions))(s);for(const s of i){const l=s.split(".").pop();this[l]=function(){const u=this._compositions[l];return this.type=null,this.append(u)}}}_reset(){const e=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([n])=>n.startsWith("margin")||n.startsWith("padding")||n.startsWith("inset")||e.includes(n))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const e=this._trailingResolve.bind(this);this._trailingResolve=null,e(this)}).catch(e=>{const n=this._trailingReject.bind(this);this._trailingReject=null,n(e)}))}_createResolve(e){return()=>{this._rendering=!1,e(this)}}_createReject(e){return n=>{this._rendering=!1,e(n)}}_computedOptions(){const e=this.options(),{key:n=_j}=e,{width:r,height:i,depth:s}=GO(e,this._container);return this._width=r,this._height=i,this._key=n,Object.assign(Object.assign({key:this._key},e),{width:r,height:i,depth:s})}_createCanvas(){const{width:e,height:n}=GO(this.options(),this._container);this._plugins.push(new K2),this._plugins.forEach(r=>this._renderer.registerPlugin(r)),this._context.canvas=new Fs({container:this._container,width:e,height:n,renderer:this._renderer})}_addToTrailing(){var e;return(e=this._trailingResolve)===null||e===void 0||e.call(this,this),this._trailing=!0,new Promise((r,i)=>{this._trailingResolve=r,this._trailingReject=i})}_bindAutoFit(){const e=this.options(),{autoFit:n}=e;if(this._hasBindAutoFit){n||this._unbindAutoFit();return}n&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function bj(t,e){class n extends t{constructor(i){super(Object.assign(Object.assign({},i),{lib:e}))}}return n}var Ej=Object.prototype.hasOwnProperty,XO=function(t,e){if(t===null||!y0(t))return{};var n={};return ib(e,function(r){Ej.call(t,r)&&(n[r]=t[r])}),n};function X5(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Nb(t,e,n,r,i){for(var s=t.children,l,u=-1,h=s.length,p=t.value&&(r-e)/t.value;++u<h;)l=s[u],l.y0=n,l.y1=i,l.x0=e,l.x1=e+=l.value*p}function Sj(){var t=1,e=1,n=0,r=!1;function i(l){var u=l.height+1;return l.x0=l.y0=n,l.x1=t,l.y1=e/u,l.eachBefore(s(e,u)),r&&l.eachBefore(X5),l}function s(l,u){return function(h){h.children&&Nb(h,h.x0,l*(h.depth+1)/u,h.x1,l*(h.depth+2)/u);var p=h.x0,m=h.y0,y=h.x1-n,x=h.y1-n;y<p&&(p=y=(p+y)/2),x<m&&(m=x=(m+x)/2),h.x0=p,h.y0=m,h.x1=y,h.y1=x}}return i.round=function(l){return arguments.length?(r=!!l,i):r},i.size=function(l){return arguments.length?(t=+l[0],e=+l[1],i):[t,e]},i.padding=function(l){return arguments.length?(n=+l,i):n},i}var Tj=it(9783);function wj(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Aj(){return this.eachAfter(wj)}var YO=it(64599);function Oj(t,e){var n=-1,r=YO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;t.call(e,s,++n,this)}}catch(l){r.e(l)}finally{r.f()}return this}function Cj(t,e){for(var n=this,r=[n],i,s,l=-1;n=r.pop();)if(t.call(e,n,++l,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function Rj(t,e){for(var n=this,r=[n],i=[],s,l,u,h=-1;n=r.pop();)if(i.push(n),s=n.children)for(l=0,u=s.length;l<u;++l)r.push(s[l]);for(;n=i.pop();)t.call(e,n,++h,this);return this}function Mj(t,e){var n=-1,r=YO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;if(t.call(e,s,++n,this))return s}}catch(l){r.e(l)}finally{r.f()}}function Pj(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Ij(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Lj(t){for(var e=this,n=Dj(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Dj(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Nj(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function kj(){return Array.from(this)}function Bj(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Fj(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}var Y5=it(15009),Uj=Y5().mark(q5);function q5(){var t,e,n,r,i,s;return Y5().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=this,n=[t];case 1:e=n.reverse(),n=[];case 2:if(!(t=e.pop())){u.next=8;break}return u.next=5,t;case 5:if(r=t.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);u.next=2;break;case 8:if(n.length){u.next=1;break}case 9:case"end":return u.stop()}},Uj,this)}function B1(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Vj)):e===void 0&&(e=jj);for(var n=new F1(t),r,i=[n],s,l,u,h;r=i.pop();)if((l=e(r.data))&&(h=(l=Array.from(l)).length))for(r.children=l,u=h-1;u>=0;--u)i.push(s=l[u]=new F1(l[u])),s.parent=r,s.depth=r.depth+1;return n.eachBefore($5)}function zj(){return B1(this).eachBefore(Zj)}function jj(t){return t.children}function Vj(t){return Array.isArray(t)?t[1]:null}function Zj(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function $5(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function F1(t){this.data=t,this.depth=this.height=0,this.parent=null}F1.prototype=B1.prototype=Tj({constructor:F1,count:Aj,each:Oj,eachAfter:Rj,eachBefore:Cj,find:Mj,sum:Pj,sort:Ij,path:Lj,ancestors:Nj,descendants:kj,leaves:Bj,links:Fj,copy:zj},Symbol.iterator,q5);function qO(t,e){for(var n in e)e.hasOwnProperty(n)&&n!=="constructor"&&e[n]!==void 0&&(t[n]=e[n])}function Hj(t,e,n,r){return e&&qO(t,e),n&&qO(t,n),r&&qO(t,r),t}const Gj={field:"value",size:[1,1],round:!1,padding:0,sort:(t,e)=>e.value-t.value,as:["x","y"],ignoreParentValue:!0},Wj="nodeIndex",kb="childNodeCount",Xj="nodeAncestor",$O="Invalid field: it must be a string!";function Yj(t,e){const{field:n,fields:r}=t;if(Si(n))return n;if(Ps(n))return console.warn($O),n[0];if(console.warn(`${$O} will try to get fields instead.`),Si(r))return r;if(Ps(r)&&r.length)return r[0];if(e)return e;throw new TypeError($O)}function qj(t){const e=[];if(t&&t.each){let n,r;t.each(i=>{var s,l;i.parent!==n?(n=i.parent,r=0):r+=1;const u=KP((((s=i.ancestors)===null||s===void 0?void 0:s.call(i))||[]).map(h=>e.find(p=>p.name===h.name)||h),({depth:h})=>h>0&&h<i.depth);i[Xj]=u,i[kb]=((l=i.children)===null||l===void 0?void 0:l.length)||0,i[Wj]=r,e.push(i)})}else t&&t.eachNode&&t.eachNode(n=>{e.push(n)});return e}function $j(t,e){e=Hj({},Gj,e);const n=e.as;if(!Ps(n)||n.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let r;try{r=Yj(e)}catch(h){console.warn(h)}const s=(h=>Sj().size(e.size).round(e.round).padding(e.padding)(B1(h).sum(p=>Lg(p.children)?e.ignoreParentValue?0:p[r]-tS(p.children,(m,y)=>m+y[r],0):p[r]).sort(e.sort)))(t),l=n[0],u=n[1];return s.each(h=>{var p,m;h[l]=[h.x0,h.x1,h.x1,h.x0],h[u]=[h.y1,h.y1,h.y0,h.y0],h.name=h.name||((p=h.data)===null||p===void 0?void 0:p.name)||((m=h.data)===null||m===void 0?void 0:m.label),h.data.name=h.name,["x0","x1","y0","y1"].forEach(y=>{n.indexOf(y)===-1&&delete h[y]})}),qj(s)}var Kj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const U1="sunburst",KO="markType",Met="value",K5="path",iT="ancestor-node";function Qj(t){const{data:e,encode:n}=t,{color:r,value:i}=n,l=$j(e,{field:i,type:"hierarchy.partition",as:["x","y"]}),u=[];return l.forEach(h=>{var p,m,y,x;if(h.depth===0)return null;let T=h.data.name;const C=[T];let M=Object.assign({},h);for(;M.depth>1;)T=`${(p=M.parent.data)===null||p===void 0?void 0:p.name} / ${T}`,C.unshift((m=M.parent.data)===null||m===void 0?void 0:m.name),M=M.parent;const I=Object.assign(Object.assign(Object.assign({},XO(h.data,[i])),{[K5]:T,[iT]:M.data.name}),h);r&&r!==iT&&(I[r]=h.data[r]||((x=(y=h.parent)===null||y===void 0?void 0:y.data)===null||x===void 0?void 0:x[r])),u.push(I)}),u.map(h=>{const p=h.x.slice(0,2),m=[h.y[2],h.y[0]];return p[0]===p[1]&&(m[0]=m[1]=(h.y[2]+h.y[0])/2),Object.assign(Object.assign({},h),{x:p,y:m,fillOpacity:Math.pow(.85,h.depth)})})}const Q5={id:U1,encode:{x:"x",y:"y",key:K5,color:iT,value:"value"},axis:{x:!1,y:!1},style:{[KO]:U1,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[kb]:kb,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},J5=t=>{const{encode:e,data:n=[],legend:r}=t,i=Kj(t,["encode","data","legend"]),s=Object.assign(Object.assign({},i.coordinate),{innerRadius:Math.max(Ii(i,["coordinate","innerRadius"],.2),1e-5)}),l=Object.assign(Object.assign({},Q5.encode),e),{value:u}=l,h=Qj({encode:l,data:n});return console.log(h,"rectData"),[ti({},Q5,Object.assign(Object.assign({type:"rect",data:h,encode:l,tooltip:{title:"path",items:[p=>({name:u,value:p[u]})]}},i),{coordinate:s}))]};J5.props={};var Jj=Object.keys?function(t){return Object.keys(t)}:function(t){var e=[];return ib(t,function(n,r){Ih(t)&&r==="prototype"||e.push(r)}),e},QO=Jj,tV=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};const eV=t=>t.querySelectorAll(".element").filter(e=>Ii(e,["style",KO])===U1);function nV(t){return Ra(t).select(`.${At}`).node()}const rV={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function iV(t={}){const{breadCrumb:e={},isFixedColor:n=!1}=t,r=ti({},rV,e);return i=>{const{update:s,setState:l,container:u,view:h,options:p}=i,m=u.ownerDocument,y=nV(u),x=p.marks.find(({id:Z})=>Z===U1),{state:T}=x,C=m.createElement("g");y.appendChild(C);const M=(Z,G)=>tV(this,void 0,void 0,function*(){if(C.removeChildren(),Z){const W=m.createElement("text",{style:Object.assign({x:0,text:r.rootText,depth:0},r.style)});C.appendChild(W);let $="";const J=Z==null?void 0:Z.split(" / ");let nt=r.style.y,dt=C.getBBox().width;const Et=y.getBBox().width,Pt=J.map((Ht,Ct)=>{const Ft=m.createElement("text",{style:Object.assign(Object.assign({x:dt,text:" / "},r.style),{y:nt})});C.appendChild(Ft),dt+=Ft.getBBox().width,$=`${$}${Ht} / `;const jt=m.createElement("text",{name:$.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:Ht,x:dt,depth:Ct+1},r.style),{y:nt})});return C.appendChild(jt),dt+=jt.getBBox().width,dt>Et&&(nt=C.getBBox().height,dt=0,Ft.attr({x:dt,y:nt}),dt+=Ft.getBBox().width,jt.attr({x:dt,y:nt}),dt+=jt.getBBox().width),jt});[W,...Pt].forEach((Ht,Ct)=>{if(Ct===Pt.length)return;const Ft=Object.assign({},Ht.attributes);Ht.attr("cursor","pointer"),Ht.addEventListener("mouseenter",()=>{Ht.attr(r.active)}),Ht.addEventListener("mouseleave",()=>{Ht.attr(Ft)}),Ht.addEventListener("click",()=>{M(Ht.name,Ii(Ht,["style","depth"]))})})}l("drillDown",W=>{const{marks:$}=W,J=$.map(nt=>{if(nt.id!==U1&&nt.type!=="rect")return nt;const{data:dt}=nt,Et=Object.fromEntries(["color"].map(Ht=>[Ht,{domain:h.scale[Ht].getOptions().domain}])),Pt=dt.filter(Ht=>{const Ct=Ht.path;return n||(Ht[iT]=Ct.split(" / ")[G]),Z?new RegExp(`^${Z}.+`).test(Ct):!0});return ti({},nt,n?{data:Pt,scale:Et}:{data:Pt})});return Object.assign(Object.assign({},W),{marks:J})}),yield s()}),I=Z=>{const G=Z.target;if(Ii(G,["style",KO])!==U1||Ii(G,["markType"])!=="rect"||!Ii(G,["style",kb]))return;const W=Ii(G,["__data__","key"]),$=Ii(G,["style","depth"]);G.style.cursor="pointer",M(W,$)};y.addEventListener("click",I);const D=QO(Object.assign(Object.assign({},T.active),T.inactive)),U=()=>{eV(y).forEach(G=>{const W=Ii(G,["style",kb]);if(Ii(G,["style","cursor"])!=="pointer"&&W){G.style.cursor="pointer";const J=XO(G.attributes,D);G.addEventListener("mouseenter",()=>{G.attr(T.active)}),G.addEventListener("mouseleave",()=>{G.attr(ti(J,T.inactive))})}})};return y.addEventListener("mousemove",U),()=>{C.remove(),y.removeEventListener("click",I),y.removeEventListener("mousemove",U)}}}function oV(){return{"interaction.drillDown":iV,"mark.sunburst":J5}}const t4=()=>[["cartesian"]];t4.props={};const JO=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];JO.props={transform:!0};const aV=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},e4=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:i}=aV(t);return[...JO(),...Ry({startAngle:e,endAngle:n,innerRadius:r,outerRadius:i})]};e4.props={};const tC=()=>[["parallel",0,1,0,1]];tC.props={};const n4=({focusX:t=0,focusY:e=0,distortionX:n=2,distortionY:r=2,visual:i=!1})=>[["fisheye",t,e,n,r,i]];n4.props={transform:!0};const r4=t=>{const{startAngle:e=-Math.PI/2,endAngle:n=Math.PI*3/2,innerRadius:r=0,outerRadius:i=1}=t;return[...tC(),...Ry({startAngle:e,endAngle:n,innerRadius:r,outerRadius:i})]};r4.props={};const i4=({value:t})=>e=>e.map(()=>t);i4.props={};const o4=({value:t})=>e=>e.map(n=>n[t]);o4.props={};const a4=({value:t})=>e=>e.map(t);a4.props={};const s4=({value:t})=>()=>t;s4.props={};function _c(t,e){if(t!==null)return{type:"column",value:t,field:e}}function oT(t,e){const n=_c(t,e);return Object.assign(Object.assign({},n),{inferred:!0})}function aT(t,e){if(t!==null)return{type:"column",value:t,field:e,visual:!0}}function sV(t,e){const n=_c(t,e);return Object.assign(Object.assign({},n),{constant:!1})}function Zg(t,e){const n=[];for(const r of t)n[r]=e;return n}function nl(t,e){const n=t[e];if(!n)return[null,null];const{value:r,field:i=null}=n;return[r,i]}function Bb(t,...e){for(const n of e)if(typeof n=="string"){const[r,i]=nl(t,n);if(r!==null)return[r,i]}else return[n,null];return[null,null]}function Fb(t){return t instanceof Date?!1:typeof t=="object"}const Ub=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;return r!==void 0?[t,e]:[t,ti({},e,{encode:{y1:oT(Zg(t,0))}})]};Ub.props={};const h_=()=>(t,e)=>{const{encode:n}=e,{x:r}=n;return r!==void 0?[t,e]:[t,ti({},e,{encode:{x:oT(Zg(t,0))},scale:{x:{guide:null}}})]};h_.props={};const d_=(t,e)=>Ab(Object.assign({colorAttribute:"fill"},t),e);d_.props=Object.assign(Object.assign({},Ab.props),{defaultMarker:"square"});const sT=(t,e)=>Ab(Object.assign({colorAttribute:"stroke"},t),e);sT.props=Object.assign(Object.assign({},Ab.props),{defaultMarker:"hollowSquare"});function z1(){}function l4(t){this._context=t}l4.prototype={areaStart:z1,areaEnd:z1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function eC(t){return new l4(t)}var c4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function lV(t,e,n){const[r,i,s,l]=t;if(gc(n)){const p=[e?e[0][0]:i[0],i[1]],m=[e?e[3][0]:s[0],s[1]];return[r,p,m,l]}const u=[i[0],e?e[0][1]:i[1]],h=[s[0],e?e[3][1]:s[1]];return[r,u,h,l]}const nC=(t,e)=>{const{adjustPoints:n=lV}=t,r=c4(t,["adjustPoints"]),{coordinate:i,document:s}=e;return(l,u,h,p)=>{const{index:m}=u,{color:y}=h,x=c4(h,["color"]),T=p[m+1],C=n(l,T,i),M=!!gc(i),[I,D,U,Z]=M?Vr(C):C,{color:G=y,opacity:W}=u,$=ro().curve(eC)([I,D,U,Z]);return Ra(s.createElement("path",{})).call(Ln,x).style("d",$).style("fill",G).style("fillOpacity",W).call(Ln,r).node()}};nC.props={defaultMarker:"square"};function cV(t,e,n){const[r,i,s,l]=t;if(gc(n)){const p=[e?e[0][0]:(i[0]+s[0])/2,i[1]],m=[e?e[3][0]:(i[0]+s[0])/2,s[1]];return[r,p,m,l]}const u=[i[0],e?e[0][1]:(i[1]+s[1])/2],h=[s[0],e?e[3][1]:(i[1]+s[1])/2];return[r,u,h,l]}const u4=(t,e)=>nC(Object.assign({adjustPoints:cV},t),e);u4.props={defaultMarker:"square"};function zb(t){return Math.abs(t)>10?String(t):t.toString().padStart(2,"0")}function uV(t){const e=t.getFullYear(),n=zb(t.getMonth()+1),r=zb(t.getDate()),i=`${e}-${n}-${r}`,s=t.getHours(),l=t.getMinutes(),u=t.getSeconds();return s||l||u?`${i} ${zb(s)}:${zb(l)}:${zb(u)}`:i}const lT=(t={})=>{const{channel:e="x"}=t;return(n,r)=>{const{encode:i}=r,{tooltip:s}=r;if(X0(s))return[n,r];const{title:l}=s;if(l!==void 0)return[n,r];const u=Object.keys(i).filter(p=>p.startsWith(e)).filter(p=>!i[p].inferred).map(p=>nl(i,p)).filter(([p])=>p).map(p=>p[0]);if(u.length===0)return[n,r];const h=[];for(const p of n)h[p]={value:u.map(m=>m[p]instanceof Date?uV(m[p]):m[p]).join(", ")};return[n,ti({},r,{tooltip:{title:h}})]}};lT.props={};const cT=t=>{const{channel:e}=t;return(n,r)=>{const{encode:i,tooltip:s}=r;if(X0(s))return[n,r];const{items:l=[]}=s;if(!l||l.length>0)return[n,r];const h=(Array.isArray(e)?e:[e]).flatMap(p=>Object.keys(i).filter(m=>m.startsWith(p)).map(m=>{const{field:y,value:x,inferred:T=!1,aggregate:C}=i[m];return T?null:C&&x?{channel:m}:y?{field:y}:x?{channel:m}:null}).filter(m=>m!==null));return[n,ti({},r,{tooltip:{items:h}})]}};cT.props={};var fV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const f4=()=>(t,e)=>{const{encode:n}=e,{key:r}=n,i=fV(n,["key"]);if(r!==void 0)return[t,e];const s=Object.values(i).map(({value:u})=>u),l=t.map(u=>s.filter(Array.isArray).map(h=>h[u]).join("-"));return[t,ti({},e,{encode:{key:_c(l)}})]};f4.props={};function h4(t={}){const{shapes:e}=t;return[{name:"color"},{name:"opacity"},{name:"shape",range:e},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function Nd(t={}){return[...h4(t),{name:"title",scale:"identity"}]}function Pet(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function Hg(){return[{type:lT,channel:"color"},{type:cT,channel:["x","y"]}]}function j1(){return[{type:lT,channel:"x"},{type:cT,channel:["y"]}]}function hV(){return[{type:lT,channel:"color"},{type:cT,channel:["position"]}]}function V1(t={}){return h4(t)}function tf(){return[{type:f4}]}function pf(){return[]}function rC(t,e){return t.getBandWidth(t.invert(e))}function p_(t,e,n={}){const{x:r,y:i,series:s}=e,{x:l,y:u,series:h}=t,{style:{bandOffset:p=h?0:.5,bandOffsetX:m=p,bandOffsetY:y=p}={}}=n,x=!!(l!=null&&l.getBandWidth),T=!!(u!=null&&u.getBandWidth),C=!!(h!=null&&h.getBandWidth);return!x&&!T?M=>M:(M,I)=>{const D=x?rC(l,r[I]):0,U=T?rC(u,i[I]):0,G=C&&s?(rC(h,s[I])/2+ +s[I])*D:0,[W,$]=M;return[W+m*D+G,$+y*U]}}function uT(t){return parseFloat(t)/100}function iC(t,e,n,r){const{x:i,y:s}=n,{innerWidth:l,innerHeight:u}=r.getOptions(),h=Array.from(t,p=>{const m=i[p],y=s[p],x=typeof m=="string"?uT(m)*l:+m,T=typeof y=="string"?uT(y)*u:+y;return[[x,T]]});return[t,h]}function qm(t){return typeof t=="function"?t:e=>e[t]}function oC(t,e){return Array.from(t,qm(e))}function aC(t,e){const{source:n=m=>m.source,target:r=m=>m.target,value:i=m=>m.value}=e,{links:s,nodes:l}=t,u=oC(s,n),h=oC(s,r),p=oC(s,i);return{links:s.map((m,y)=>({target:h[y],source:u[y],value:p[y]})),nodes:l||Array.from(new Set([...u,...h]),m=>({key:m}))}}function d4(t,e){return t.getBandWidth(t.invert(e))}const p4={rect:d_,hollow:sT,funnel:nC,pyramid:u4},m4=()=>(t,e,n,r)=>{const{x:i,y:s,y1:l,series:u,size:h}=n,p=e.x,m=e.series,[y]=r.getSize(),x=h?h.map(M=>+M/y):null,T=h?(M,I,D)=>{const U=M+I/2,Z=x[D];return[U-Z/2,U+Z/2]}:(M,I,D)=>[M,M+I],C=Array.from(t,M=>{const I=d4(p,i[M]),D=m?d4(m,u==null?void 0:u[M]):1,U=I*D,Z=(+(u==null?void 0:u[M])||0)*I,G=+i[M]+Z,[W,$]=T(G,U,M),J=+s[M],nt=+l[M];return[[W,J],[$,J],[$,nt],[W,nt]].map(Ct=>r.map(Ct))});return[t,C]};m4.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:p4,channels:[...Nd({shapes:Object.keys(p4)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...tf(),{type:Ub},{type:h_}],postInference:[...pf(),...j1()],interaction:{shareTooltip:!0}};const v4={rect:d_,hollow:sT},g4=()=>(t,e,n,r)=>{const{x:i,x1:s,y:l,y1:u}=n,h=Array.from(t,p=>{const m=[+i[p],+l[p]],y=[+s[p],+l[p]],x=[+s[p],+u[p]],T=[+i[p],+u[p]];return[m,y,x,T].map(C=>r.map(C))});return[t,h]};g4.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:v4,channels:[...Nd({shapes:Object.keys(v4)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf(),{type:Ub}],postInference:[...pf(),...j1()],interaction:{shareTooltip:!0}};var y4=sC(Gf);function _4(t){this._curve=t}_4.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function sC(t){function e(n){return new _4(t(n))}return e._curve=t,e}function jb(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(sC(n)):e()._curve},t}function dV(){return jb(ro().curve(y4))}var x4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const pV=df(t=>{const{d1:e,d2:n,style1:r,style2:i}=t.attributes,s=t.ownerDocument;Ra(t).maybeAppend("line",()=>s.createElement("path",{})).style("d",e).call(Ln,r),Ra(t).maybeAppend("line1",()=>s.createElement("path",{})).style("d",n).call(Ln,i)});function mV(t,e){const n=[],r=[];let i=!1,s=null;for(const l of t)!e(l[0])||!e(l[1])?i=!0:(n.push(l),i&&(i=!1,r.push([s,l])),s=l);return[n,r]}const T0=(t,e)=>{const{curve:n,gradient:r=!1,gradientColor:i="between",defined:s=m=>!Number.isNaN(m)&&m!==void 0&&m!==null,connect:l=!1}=t,u=x4(t,["curve","gradient","gradientColor","defined","connect"]),{coordinate:h,document:p}=e;return(m,y,x)=>{const{color:T,lineWidth:C}=x,M=x4(x,["color","lineWidth"]),{color:I=T,size:D=C,seriesColor:U,seriesX:Z,seriesY:G}=y,W=Wo(h,y),$=gc(h),J=r&&U?Ji(U,Z,G,r,i,$):I,nt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},M),J&&{stroke:J}),D&&{lineWidth:D}),W&&{transform:W}),u);let dt;if(Ml(h)){const jt=h.getCenter();dt=qt=>dV().angle((Ee,oe)=>Ve(st(qt[oe],jt))).radius((Ee,oe)=>Tt(qt[oe],jt)).defined(([Ee,oe])=>s(Ee)&&s(oe)).curve(n)(qt)}else dt=ro().x(jt=>jt[0]).y(jt=>jt[1]).defined(([jt,qt])=>s(jt)&&s(qt)).curve(n);const[Et,Pt]=mV(m,s),Ht=ho(nt,"connect"),Ct=!!Pt.length;if(!Ct||l&&!Object.keys(Ht).length)return Ra(p.createElement("path",{})).style("d",dt(Et)||[]).call(Ln,nt).node();if(Ct&&!l)return Ra(p.createElement("path",{})).style("d",dt(m)).call(Ln,nt).node();const Ft=jt=>jt.map(dt).join(",");return Ra(new pV).style("style1",Object.assign(Object.assign({},nt),Ht)).style("style2",nt).style("d1",Ft(Pt)).style("d2",dt(m)).node()}};T0.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const b4=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const i=Ml(n)?eC:Gf;return T0(Object.assign({curve:i},t),e)(...r)}};b4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"line"});function lC(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function cC(t,e){this._context=t,this._k=(1-e)/6}cC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:lC(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:lC(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Iet=function t(e){function n(r){return new cC(r,e)}return n.tension=function(r){return t(+r)},n}(0);function uC(t,e){this._context=t,this._k=(1-e)/6}uC.prototype={areaStart:z1,areaEnd:z1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:lC(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Let=function t(e){function n(r){return new uC(r,e)}return n.tension=function(r){return t(+r)},n}(0);function E4(t,e,n){var r=t._x1,i=t._y1,s=t._x2,l=t._y2;if(t._l01_a>fd){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,h=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/h,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/h}if(t._l23_a>fd){var p=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,m=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*p+t._x1*t._l23_2a-e*t._l12_2a)/m,l=(l*p+t._y1*t._l23_2a-n*t._l12_2a)/m}t._context.bezierCurveTo(r,i,s,l,t._x2,t._y2)}function S4(t,e){this._context=t,this._alpha=e}S4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:E4(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Det=function t(e){function n(r){return e?new S4(r,e):new cC(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function T4(t,e){this._context=t,this._alpha=e}T4.prototype={areaStart:z1,areaEnd:z1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:E4(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var w4=function t(e){function n(r){return e?new T4(r,e):new uC(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function A4(t){return t<0?-1:1}function O4(t,e,n){var r=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(r||i<0&&-0),l=(n-t._y1)/(i||r<0&&-0),u=(s*i+l*r)/(r+i);return(A4(s)+A4(l))*Math.min(Math.abs(s),Math.abs(l),.5*Math.abs(u))||0}function C4(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function fC(t,e,n){var r=t._x0,i=t._y0,s=t._x1,l=t._y1,u=(s-r)/3;t._context.bezierCurveTo(r+u,i+u*e,s-u,l-u*n,s,l)}function fT(t){this._context=t}fT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:fC(this,this._t0,C4(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,fC(this,C4(this,n=O4(this,t,e)),n);break;default:fC(this,this._t0,n=O4(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function R4(t){this._context=new M4(t)}(R4.prototype=Object.create(fT.prototype)).point=function(t,e){fT.prototype.point.call(this,e,t)};function M4(t){this._context=t}M4.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,s){this._context.bezierCurveTo(e,t,r,n,s,i)}};function P4(t){return new fT(t)}function I4(t){return new R4(t)}var vV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const L4=(t,e)=>{const n=vV(t,[]),{coordinate:r}=e;return(...i)=>{const s=Ml(r)?w4:gc(r)?I4:P4;return T0(Object.assign({curve:s},n),e)(...i)}};L4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"smooth"});function hT(t,e){this._context=t,this._t=e}hT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function D4(t){return new hT(t,.5)}function N4(t){return new hT(t,0)}function k4(t){return new hT(t,1)}const B4=(t,e)=>T0(Object.assign({curve:k4},t),e);B4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"hv"});const F4=(t,e)=>T0(Object.assign({curve:N4},t),e);F4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"vh"});const U4=(t,e)=>T0(Object.assign({curve:D4},t),e);U4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"hvh"});var gV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function yV(t,e,n,r,i){const s=st(n,e),l=se(s),u=l+Math.PI/2,h=[r/2*Math.cos(u),r/2*Math.sin(u)],p=[i/2*Math.cos(u),i/2*Math.sin(u)],m=[i/2*Math.cos(l),i/2*Math.sin(l)],y=[r/2*Math.cos(l),r/2*Math.sin(l)],x=ft(e,h),T=ft(n,p),C=ft(T,m),M=ft(n,m),I=st(M,p),D=st(n,p),U=st(e,h),Z=st(U,y),G=st(e,y),W=st(x,y);t.moveTo(...x),t.lineTo(...T),t.arcTo(...C,...M,i/2),t.arcTo(...I,...D,i/2),t.lineTo(...U),t.arcTo(...Z,...G,r/2),t.arcTo(...W,...x,r/2),t.closePath()}const z4=(t,e)=>{const{document:n}=e;return(r,i,s)=>{const{seriesSize:l,color:u}=i,{color:h}=s,p=gV(s,["color"]),m=hp();for(let y=0;y<r.length-1;y++){const x=r[y],T=r[y+1],C=l[y],M=l[y+1];[...x,...T].every(Ql)&&yV(m,x,T,C,M)}return Ra(n.createElement("path",{})).call(Ln,p).style("fill",u||h).style("d",m.toString()).call(Ln,t).node()}};z4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"line"});const j4=()=>(t,e)=>{const{style:n={},encode:r}=e,{series:i}=r,{gradient:s}=n;return!s||i?[t,e]:[t,ti({},e,{encode:{series:aT(Zg(t,void 0))}})]};j4.props={};const hC=()=>(t,e)=>{const{encode:n}=e,{series:r,color:i}=n;if(r!==void 0||i===void 0)return[t,e];const[s,l]=nl(n,"color");return[t,ti({},e,{encode:{series:_c(s,l)}})]};hC.props={};const V4={line:b4,smooth:L4,hv:B4,vh:F4,hvh:U4,trail:z4},_V=(t,e,n,r)=>{var i,s;const{series:l,x:u,y:h}=n,{x:p,y:m}=e;if(u===void 0||h===void 0)throw new Error("Missing encode for x or y channel.");const y=l?Array.from(vc(t,I=>l[I]).values()):[t],x=y.map(I=>I[0]).filter(I=>I!==void 0),T=(((i=p==null?void 0:p.getBandWidth)===null||i===void 0?void 0:i.call(p))||0)/2,C=(((s=m==null?void 0:m.getBandWidth)===null||s===void 0?void 0:s.call(m))||0)/2,M=Array.from(y,I=>I.map(D=>r.map([+u[D]+T,+h[D]+C])));return[x,M,y]},xV=(t,e,n,r)=>{const i=Object.entries(n).filter(([l])=>l.startsWith("position")).map(([,l])=>l);if(i.length===0)throw new Error("Missing encode for position channel.");const s=Array.from(t,l=>{const u=i.map(m=>+m[l]),h=r.map(u),p=[];for(let m=0;m<h.length;m+=2)p.push([h[m],h[m+1]]);return p});return[t,s]},Z4=()=>(t,e,n,r)=>(Py(r)?xV:_V)(t,e,n,r);Z4.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:V4,channels:[...Nd({shapes:Object.keys(V4)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...tf(),{type:j4},{type:hC}],postInference:[...pf(),...j1(),...hV()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var bV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function H4(t,e,n,r){if(e.length===1)return;const{size:i}=n;if(t==="fixed")return i;if(t==="normal"||yE(r)){const[[s,l],[u,h]]=e,p=Math.abs((u-s)/2),m=Math.abs((h-l)/2);return Math.max(0,(p+m)/2)}return i}const Gs=(t,e)=>{const{colorAttribute:n,symbol:r,mode:i="auto"}=t,s=bV(t,["colorAttribute","symbol","mode"]),l=op.get(r)||op.get("point"),{coordinate:u,document:h}=e;return(p,m,y)=>{const{lineWidth:x,color:T}=y,C=s.stroke?x||1:x,{color:M=T,transform:I,opacity:D}=m,[U,Z]=as(p),W=H4(i,p,m,u)||s.r||y.r;return Ra(h.createElement("path",{})).call(Ln,y).style("fill","transparent").style("d",l(U,Z,W)).style("lineWidth",C).style("transform",I).style("transformOrigin",`${U-W} ${Z-W}`).style("stroke",M).style(ps(t),D).style(n,M).call(Ln,s).node()}};Gs.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const G4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"point"},t),e);G4.props=Object.assign({defaultMarker:"hollowPoint"},Gs.props);const W4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"diamond"},t),e);W4.props=Object.assign({defaultMarker:"hollowDiamond"},Gs.props);const X4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},t),e);X4.props=Object.assign({defaultMarker:"hollowHexagon"},Gs.props);const Y4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"square"},t),e);Y4.props=Object.assign({defaultMarker:"hollowSquare"},Gs.props);const q4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},t),e);q4.props=Object.assign({defaultMarker:"hollowTriangleDown"},Gs.props);const $4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle"},t),e);$4.props=Object.assign({defaultMarker:"hollowTriangle"},Gs.props);const K4=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},t),e);K4.props=Object.assign({defaultMarker:"hollowBowtie"},Gs.props);var EV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Q4=(t,e)=>{const{colorAttribute:n,mode:r="auto"}=t,i=EV(t,["colorAttribute","mode"]),{coordinate:s,document:l}=e;return(u,h,p)=>{const{lineWidth:m,color:y}=p,x=i.stroke?m||1:m,{color:T=y,transform:C,opacity:M}=h,[I,D]=as(u),Z=H4(r,u,h,s)||i.r||p.r;return Ra(l.createElement("circle",{})).call(Ln,p).style("fill","transparent").style("cx",I).style("cy",D).style("r",Z).style("lineWidth",x).style("transform",C).style("transformOrigin",`${I} ${D}`).style("stroke",T).style(ps(t),M).style(n,T).call(Ln,i).node()}},dC=(t,e)=>Q4(Object.assign({colorAttribute:"fill"},t),e);dC.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const J4=(t,e)=>Q4(Object.assign({colorAttribute:"stroke"},t),e);J4.props=Object.assign({defaultMarker:"hollowPoint"},dC.props);const tL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"point"},t),e);tL.props=Object.assign({defaultMarker:"point"},Gs.props);const eL=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"plus"},t),e);eL.props=Object.assign({defaultMarker:"plus"},Gs.props);const nL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"diamond"},t),e);nL.props=Object.assign({defaultMarker:"diamond"},Gs.props);const rL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"square"},t),e);rL.props=Object.assign({defaultMarker:"square"},Gs.props);const iL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle"},t),e);iL.props=Object.assign({defaultMarker:"triangle"},Gs.props);const oL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"hexagon"},t),e);oL.props=Object.assign({defaultMarker:"hexagon"},Gs.props);const aL=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"cross"},t),e);aL.props=Object.assign({defaultMarker:"cross"},Gs.props);const sL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"bowtie"},t),e);sL.props=Object.assign({defaultMarker:"bowtie"},Gs.props);const lL=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},t),e);lL.props=Object.assign({defaultMarker:"hyphen"},Gs.props);const cL=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"line"},t),e);cL.props=Object.assign({defaultMarker:"line"},Gs.props);const uL=(t,e)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"tick"},t),e);uL.props=Object.assign({defaultMarker:"tick"},Gs.props);const fL=(t,e)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},t),e);fL.props=Object.assign({defaultMarker:"triangleDown"},Gs.props);const dT=()=>(t,e)=>{const{encode:n}=e,{y:r}=n;return r!==void 0?[t,e]:[t,ti({},e,{encode:{y:oT(Zg(t,0))},scale:{y:{guide:null}}})]};dT.props={};const hL=()=>(t,e)=>{const{encode:n}=e,{size:r}=n;return r!==void 0?[t,e]:[t,ti({},e,{encode:{size:aT(Zg(t,3))}})]};hL.props={};const dL={hollow:G4,hollowDiamond:W4,hollowHexagon:X4,hollowSquare:Y4,hollowTriangleDown:q4,hollowTriangle:$4,hollowBowtie:K4,hollowCircle:J4,point:tL,plus:eL,diamond:nL,square:rL,triangle:iL,hexagon:oL,cross:aL,bowtie:sL,hyphen:lL,line:cL,tick:uL,triangleDown:fL,circle:dC},pL=t=>(e,n,r,i)=>{const{x:s,y:l,x1:u,y1:h,size:p,dx:m,dy:y}=r,[x,T]=i.getSize(),C=p_(n,r,t),M=D=>{const U=+((m==null?void 0:m[D])||0),Z=+((y==null?void 0:y[D])||0),G=u?(+s[D]+ +u[D])/2:+s[D],W=h?(+l[D]+ +h[D])/2:+l[D],$=G+U,J=W+Z;return[$,J]},I=p?Array.from(e,D=>{const[U,Z]=M(D),G=+p[D],W=G/x,$=G/T,J=[U-W,Z-$],nt=[U+W,Z+$];return[i.map(C(J,D)),i.map(C(nt,D))]}):Array.from(e,D=>[i.map(C(M(D),D))]);return[e,I]};pL.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:dL,channels:[...Nd({shapes:Object.keys(dL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...tf(),{type:h_},{type:dT}],postInference:[...pf(),{type:hL},...Hg()]};const mL=(t,e)=>{const{coordinate:n}=e;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h},[[x,T]]=r;return Ra(new UP).style("x",x).style("y",T).call(Ln,s).style("transform",`${m}rotate(${+p})`).style("coordCenter",n.getCenter()).call(Ln,y).call(Ln,t).node()}};mL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var pC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function SV(t){const e=t/Math.sqrt(2),n=t*Math.sqrt(2),[r,i]=[-e,e-n],[s,l]=[0,0],[u,h]=[e,e-n];return[["M",r,i],["A",t,t,0,1,1,u,h],["L",s,l],["Z"]]}function TV(t){const{min:e,max:n}=t.getLocalBounds();return[(e[0]+n[0])*.5,(e[1]+n[1])*.5]}const wV=df(t=>{const e=t.attributes,{class:n,x:r,y:i,transform:s}=e,l=pC(e,["class","x","y","transform"]),u=ho(l,"marker"),{size:h=24}=u,p=()=>SV(h/2),m=Ra(t).maybeAppend("marker",()=>new dl({})).call(T=>T.node().update(Object.assign({symbol:p},u))).node(),[y,x]=TV(m);Ra(t).maybeAppend("text","text").style("x",y).style("y",x).call(Ln,l)}),vL=(t,e)=>{const n=pC(t,[]);return(r,i,s)=>{const{color:l}=s,u=pC(s,["color"]),{color:h=l,text:p=""}=i,m={text:String(p),stroke:h,fill:h},[[y,x]]=r;return Ra(new wV).call(Ln,u).style("transform",`translate(${y},${x})`).call(Ln,m).call(Ln,n).node()}};vL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const gL=(t,e)=>{const{coordinate:n}=e;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h,textAlign:"center",textBaseline:"middle"},[[x,T]]=r;return Ra(new pa).style("x",x).style("y",T).call(Ln,s).style("transformOrigin","center center").style("transform",`${m}rotate(${p}deg)`).style("coordCenter",n.getCenter()).call(Ln,y).call(Ln,t).node()}};gL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const pT=()=>(t,e)=>{const{data:n}=e;if(!Array.isArray(n)||n.some(Fb))return[t,e];const r=Array.isArray(n[0])?n:[n],i=r.map(l=>l[0]),s=r.map(l=>l[1]);return[t,ti({},e,{encode:{x:_c(i),y:_c(s)}})]};pT.props={};var yL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const mT=()=>(t,e)=>{const{data:n,style:r={}}=e,i=yL(e,["data","style"]),{x:s,y:l}=r,u=yL(r,["x","y"]);if(s==null||l==null)return[t,e];const h=s||0,p=l||0;return[[0],ti({},i,{data:[0],cartesian:!0,encode:{x:_c([h]),y:_c([p])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:u})]};mT.props={};const _L={text:mL,badge:vL,tag:gL},xL=t=>{const{cartesian:e=!1}=t;return e?iC:(n,r,i,s)=>{const{x:l,y:u}=i,h=p_(r,i,t),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};xL.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:_L,channels:[...Nd({shapes:Object.keys(_L)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...tf(),{type:pT},{type:mT}],postInference:[...pf(),...Hg()]};const mC=()=>(t,e)=>[t,ti({scale:{x:{padding:0},y:{padding:0}}},e)];mC.props={};const bL={cell:d_,hollow:sT},EL=()=>(t,e,n,r)=>{const{x:i,y:s}=n,l=e.x,u=e.y,h=Array.from(t,p=>{const m=l.getBandWidth(l.invert(+i[p])),y=u.getBandWidth(u.invert(+s[p])),x=+i[p],T=+s[p],C=[x,T],M=[x+m,T],I=[x+m,T+y],D=[x,T+y];return[C,M,I,D].map(U=>r.map(U))});return[t,h]};EL.props={defaultShape:"cell",defaultLabelShape:"label",shape:bL,composite:!1,channels:[...Nd({shapes:Object.keys(bL)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...tf(),{type:h_},{type:dT},{type:mC}],postInference:[...pf(),...Hg()]};function vC(t,e,n){var r=null,i=ll(!0),s=null,l=Gf,u=null,h=oa(p);t=typeof t=="function"?t:t===void 0?Hs:ll(+t),e=typeof e=="function"?e:ll(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?cl:ll(+n);function p(y){var x,T,C,M=(y=Nh(y)).length,I,D=!1,U,Z=new Array(M),G=new Array(M);for(s==null&&(u=l(U=h())),x=0;x<=M;++x){if(!(x<M&&i(I=y[x],x,y))===D)if(D=!D)T=x,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),C=x-1;C>=T;--C)u.point(Z[C],G[C]);u.lineEnd(),u.areaEnd()}D&&(Z[x]=+t(I,x,y),G[x]=+e(I,x,y),u.point(r?+r(I,x,y):Z[x],n?+n(I,x,y):G[x]))}if(U)return u=null,U+""||null}function m(){return ro().defined(i).curve(l).context(s)}return p.x=function(y){return arguments.length?(t=typeof y=="function"?y:ll(+y),r=null,p):t},p.x0=function(y){return arguments.length?(t=typeof y=="function"?y:ll(+y),p):t},p.x1=function(y){return arguments.length?(r=y==null?null:typeof y=="function"?y:ll(+y),p):r},p.y=function(y){return arguments.length?(e=typeof y=="function"?y:ll(+y),n=null,p):e},p.y0=function(y){return arguments.length?(e=typeof y=="function"?y:ll(+y),p):e},p.y1=function(y){return arguments.length?(n=y==null?null:typeof y=="function"?y:ll(+y),p):n},p.lineX0=p.lineY0=function(){return m().x(t).y(e)},p.lineY1=function(){return m().x(t).y(n)},p.lineX1=function(){return m().x(r).y(e)},p.defined=function(y){return arguments.length?(i=typeof y=="function"?y:ll(!!y),p):i},p.curve=function(y){return arguments.length?(l=y,s!=null&&(u=l(s)),p):l},p.context=function(y){return arguments.length?(y==null?s=u=null:u=l(s=y),p):s},p}function AV(){var t=vC().curve(y4),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,s=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return jb(n())},delete t.lineX0,t.lineEndAngle=function(){return jb(r())},delete t.lineX1,t.lineInnerRadius=function(){return jb(i())},delete t.lineY0,t.lineOuterRadius=function(){return jb(s())},delete t.lineY1,t.curve=function(l){return arguments.length?e(sC(l)):e()._curve},t}var OV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function CV(t,e){const n=[],r=[],i=[];let s=!1,l=null;const u=t.length/2;for(let h=0;h<u;h++){const p=t[h],m=t[h+u];if([...p,...m].some(y=>!e(y)))s=!0;else{if(n.push(p),r.push(m),s&&l){s=!1;const[y,x]=l;i.push([y,p,x,m])}l=[p,m]}}return[n.concat(r),i]}const SL=df(t=>{const{areaPath:e,connectPath:n,areaStyle:r,connectStyle:i}=t.attributes,s=t.ownerDocument;Ra(t).maybeAppend("connect-path",()=>s.createElement("path",{})).style("d",n).call(Ln,i),Ra(t).maybeAppend("area-path",()=>s.createElement("path",{})).style("d",e).call(Ln,r)}),rm=(t,e)=>{const{curve:n,gradient:r=!1,defined:i=p=>!Number.isNaN(p)&&p!==void 0&&p!==null,connect:s=!1}=t,l=OV(t,["curve","gradient","defined","connect"]),{coordinate:u,document:h}=e;return(p,m,y)=>{const{color:x}=y,{color:T=x,seriesColor:C,seriesX:M,seriesY:I}=m,D=gc(u),U=Wo(u,m),Z=r&&C?Ji(C,M,I,r,void 0,D):T,G=Object.assign(Object.assign(Object.assign(Object.assign({},y),{stroke:Z,fill:Z}),U&&{transform:U}),l),[W,$]=CV(p,i),J=ho(G,"connect"),nt=!!$.length,dt=Et=>Ra(h.createElement("path",{})).style("d",Et||"").call(Ln,G).node();if(Ml(u)){const Et=Pt=>{const Ht=u.getCenter(),Ct=Pt.slice(0,Pt.length/2),Ft=Pt.slice(Pt.length/2);return AV().angle((jt,qt)=>Ve(st(Ct[qt],Ht))).outerRadius((jt,qt)=>Tt(Ct[qt],Ht)).innerRadius((jt,qt)=>Tt(Ft[qt],Ht)).defined((jt,qt)=>[...Ct[qt],...Ft[qt]].every(i)).curve(n)(Ft)};return!nt||s&&!Object.keys(J).length?dt(Et(W)):nt&&!s?dt(Et(p)):Ra(new SL).style("areaStyle",G).style("connectStyle",Object.assign(Object.assign({},J),l)).style("areaPath",Et(p)).style("connectPath",$.map(Et).join("")).node()}else{const Et=Pt=>{const Ht=Pt.slice(0,Pt.length/2),Ct=Pt.slice(Pt.length/2);return D?vC().y((Ft,jt)=>Ht[jt][1]).x1((Ft,jt)=>Ht[jt][0]).x0((Ft,jt)=>Ct[jt][0]).defined((Ft,jt)=>[...Ht[jt],...Ct[jt]].every(i)).curve(n)(Ht):vC().x((Ft,jt)=>Ht[jt][0]).y1((Ft,jt)=>Ht[jt][1]).y0((Ft,jt)=>Ct[jt][1]).defined((Ft,jt)=>[...Ht[jt],...Ct[jt]].every(i)).curve(n)(Ht)};return!nt||s&&!Object.keys(J).length?dt(Et(W)):nt&&!s?dt(Et(p)):Ra(new SL).style("areaStyle",G).style("connectStyle",Object.assign(Object.assign({},J),l)).style("areaPath",Et(p)).style("connectPath",$.map(Et).join("")).node()}}};rm.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const TL=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const i=Ml(n)?eC:Gf;return rm(Object.assign({curve:i},t),e)(...r)}};TL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"square"});var RV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const wL=(t,e)=>{const n=RV(t,[]),{coordinate:r}=e;return(...i)=>{const s=Ml(r)?w4:gc(r)?I4:P4;return rm(Object.assign({curve:s},n),e)(...i)}};wL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"smooth"});const AL=(t,e)=>(...n)=>rm(Object.assign({curve:D4},t),e)(...n);AL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"hvh"});const OL=(t,e)=>(...n)=>rm(Object.assign({curve:N4},t),e)(...n);OL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"vh"});const CL=(t,e)=>(...n)=>rm(Object.assign({curve:k4},t),e)(...n);CL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"hv"});const RL={area:TL,smooth:wL,hvh:AL,vh:OL,hv:CL},ML=()=>(t,e,n,r)=>{var i,s;const{x:l,y:u,y1:h,series:p}=n,{x:m,y}=e,x=p?Array.from(vc(t,D=>p[D]).values()):[t],T=x.map(D=>D[0]).filter(D=>D!==void 0),C=(((i=m==null?void 0:m.getBandWidth)===null||i===void 0?void 0:i.call(m))||0)/2,M=(((s=y==null?void 0:y.getBandWidth)===null||s===void 0?void 0:s.call(y))||0)/2,I=Array.from(x,D=>{const U=D.length,Z=new Array(U*2);for(let G=0;G<D.length;G++){const W=D[G];Z[G]=r.map([+l[W]+C,+u[W]+M]),Z[U+G]=r.map([+l[W]+C,+h[W]+M])}return Z});return[T,I,x]};ML.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:RL,channels:[...Nd({shapes:Object.keys(RL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...tf(),{type:hC},{type:Ub},{type:mC}],postInference:[...pf(),...j1()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const PL=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;if(r)return[t,e];const[i]=nl(n,"y");return[t,ti({},e,{encode:{y1:_c([...i])}})]};PL.props={};const IL=()=>(t,e)=>{const{encode:n}=e,{x1:r}=n;if(r)return[t,e];const[i]=nl(n,"x");return[t,ti({},e,{encode:{x1:_c([...i])}})]};IL.props={};var LL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const gC=(t,e)=>{const{arrow:n=!0,arrowSize:r="40%"}=t,i=LL(t,["arrow","arrowSize"]),{document:s}=e;return(l,u,h)=>{const{defaultColor:p}=h,m=LL(h,["defaultColor"]),{color:y=p,transform:x}=u,[T,C]=l,M=hp();if(M.moveTo(...T),M.lineTo(...C),n){const[I,D]=Fi(T,C,{arrowSize:r});M.moveTo(...I),M.lineTo(...C),M.lineTo(...D)}return Ra(s.createElement("path",{})).call(Ln,m).style("d",M.toString()).style("stroke",y).style("transform",x).call(Ln,i).node()}};gC.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const DL=(t,e)=>{const{arrow:n=!1}=t;return(...r)=>gC(Object.assign(Object.assign({},t),{arrow:n}),e)(...r)};DL.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var NL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const kL=(t,e)=>{const n=NL(t,[]),{coordinate:r,document:i}=e;return(s,l,u)=>{const{color:h}=u,p=NL(u,["color"]),{color:m=h,transform:y}=l,[x,T]=s,C=hp();if(C.moveTo(x[0],x[1]),Ml(r)){const M=r.getCenter();C.quadraticCurveTo(M[0],M[1],T[0],T[1])}else{const M=Nr(x,T),I=Tt(x,T)/2;So(C,x,T,M,I)}return Ra(i.createElement("path",{})).call(Ln,p).style("d",C.toString()).style("stroke",m).style("transform",y).call(Ln,n).node()}};kL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var BL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const FL=(t,e)=>{const n=BL(t,[]),{document:r}=e;return(i,s,l)=>{const{color:u}=l,h=BL(l,["color"]),{color:p=u,transform:m}=s,[y,x]=i,T=hp();return T.moveTo(y[0],y[1]),T.bezierCurveTo(y[0]/2+x[0]/2,y[1],y[0]/2+x[0]/2,x[1],x[0],x[1]),Ra(r.createElement("path",{})).call(Ln,h).style("d",T.toString()).style("stroke",p).style("transform",m).call(Ln,n).node()}};FL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var UL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function MV(t,e,n,r){const i=hp();if(Ml(n)){const s=n.getCenter(),l=Tt(t,s),h=(Tt(e,s)-l)*r+l;return i.moveTo(t[0],t[1]),So(i,t,e,s,h),i.lineTo(e[0],e[1]),i}return gc(n)?(i.moveTo(t[0],t[1]),i.lineTo(t[0]+(e[0]-t[0])*r,t[1]),i.lineTo(t[0]+(e[0]-t[0])*r,e[1]),i.lineTo(e[0],e[1]),i):(i.moveTo(t[0],t[1]),i.lineTo(t[0],t[1]+(e[1]-t[1])*r),i.lineTo(e[0],t[1]+(e[1]-t[1])*r),i.lineTo(e[0],e[1]),i)}const zL=(t,e)=>{const{cornerRatio:n=1/3}=t,r=UL(t,["cornerRatio"]),{coordinate:i,document:s}=e;return(l,u,h)=>{const{defaultColor:p}=h,m=UL(h,["defaultColor"]),{color:y=p,transform:x}=u,[T,C]=l,M=MV(T,C,i,n);return Ra(s.createElement("path",{})).call(Ln,m).style("d",M.toString()).style("stroke",y).style("transform",x).call(Ln,r).node()}};zL.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const jL={link:DL,arc:kL,smooth:FL,vhv:zL},yC=t=>(e,n,r,i)=>{const{x:s,y:l,x1:u=s,y1:h=l}=r,p=p_(n,r,t),m=e.map(y=>[i.map(p([+s[y],+l[y]],y)),i.map(p([+u[y],+h[y]],y))]);return[e,m]};yC.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:jL,channels:[...Nd({shapes:Object.keys(jL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf(),{type:PL},{type:IL}],postInference:[...pf(),...Hg()]};var PV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const VL=(t,e)=>{const{coordinate:n,document:r}=e;return(i,s,l)=>{const{color:u}=l,h=PV(l,["color"]),{color:p=u,src:m="",size:y=32,transform:x=""}=s;let{width:T=y,height:C=y}=t;const[[M,I]]=i,[D,U]=n.getSize();T=typeof T=="string"?uT(T)*D:T,C=typeof C=="string"?uT(C)*U:C;const Z=M-Number(T)/2,G=I-Number(C)/2;return Ra(r.createElement("image",{})).call(Ln,h).style("x",Z).style("y",G).style("src",m).style("stroke",p).style("transform",x).call(Ln,t).style("width",T).style("height",C).node()}};VL.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ZL={image:VL},HL=t=>{const{cartesian:e}=t;return e?iC:(n,r,i,s)=>{const{x:l,y:u}=i,h=p_(r,i,t),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};HL.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:ZL,channels:[...Nd({shapes:Object.keys(ZL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...tf(),{type:pT},{type:mT}],postInference:[...pf(),...Hg()]};var IV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function LV(t,e){const n=hp();if(Ml(e)){const r=e.getCenter(),i=[...t,t[0]],s=i.map(l=>Tt(l,r));return i.forEach((l,u)=>{if(u===0){n.moveTo(l[0],l[1]);return}const h=s[u],p=t[u-1],m=s[u-1];m!==void 0&&Math.abs(h-m)<1e-10?So(n,p,l,r,h):n.lineTo(l[0],l[1])}),n.closePath(),n}return ci(n,t)}const GL=(t,e)=>{const{coordinate:n,document:r}=e;return(i,s,l)=>{const{color:u}=l,h=IV(l,["color"]),{color:p=u,transform:m}=s,y=LV(i,n);return Ra(r.createElement("path",{})).call(Ln,h).style("d",y.toString()).style("stroke",p).style("fill",p).style("transform",m).call(Ln,t).node()}};GL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var WL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function DV(t,e){const[n,r,i,s]=t,l=hp();if(Ml(e)){const u=e.getCenter(),h=Tt(u,n);return l.moveTo(n[0],n[1]),l.quadraticCurveTo(u[0],u[1],i[0],i[1]),So(l,i,s,u,h),l.quadraticCurveTo(u[0],u[1],r[0],r[1]),So(l,r,n,u,h),l.closePath(),l}return l.moveTo(n[0],n[1]),l.bezierCurveTo(n[0]/2+i[0]/2,n[1],n[0]/2+i[0]/2,i[1],i[0],i[1]),l.lineTo(s[0],s[1]),l.bezierCurveTo(s[0]/2+r[0]/2,s[1],s[0]/2+r[0]/2,r[1],r[0],r[1]),l.lineTo(n[0],n[1]),l.closePath(),l}const XL=(t,e)=>{const n=WL(t,[]),{coordinate:r,document:i}=e;return(s,l,u)=>{const{color:h}=u,p=WL(u,["color"]),{color:m=h,transform:y}=l,x=DV(s,r);return Ra(i.createElement("path",{})).call(Ln,p).style("d",x.toString()).style("fill",m||h).style("stroke",m||h).style("transform",y).call(Ln,n).node()}};XL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const YL={polygon:GL,ribbon:XL},qL=()=>(t,e,n,r)=>{const i=Object.entries(n).filter(([u])=>u.startsWith("x")).map(([,u])=>u),s=Object.entries(n).filter(([u])=>u.startsWith("y")).map(([,u])=>u),l=t.map(u=>{const h=[];for(let p=0;p<i.length;p++){const m=i[p][u];if(m===void 0)break;const y=s[p][u];h.push(r.map([+m,+y]))}return h});return[t,l]};qL.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:YL,channels:[...Nd({shapes:Object.keys(YL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf()],postInference:[...pf(),...Hg()]};var NV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function kV(t,e){const n=hp();if(!Ml(e))n.moveTo(...t[0]),n.lineTo(...t[1]),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.lineTo(...t[5]),n.lineTo(...t[6]),n.lineTo(...t[7]),n.closePath(),n.moveTo(...t[8]),n.lineTo(...t[9]),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.lineTo(...t[13]);else{const r=e.getCenter(),[i,s]=r,l=se(st(t[0],r)),u=se(st(t[1],r)),h=Tt(r,t[2]),p=Tt(r,t[3]),m=Tt(r,t[8]),y=Tt(r,t[10]),x=Tt(r,t[11]);n.moveTo(...t[0]),n.arc(i,s,h,l,u),n.arc(i,s,h,u,l,!0),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.arc(i,s,p,l,u),n.lineTo(...t[6]),n.arc(i,s,y,u,l,!0),n.closePath(),n.moveTo(...t[8]),n.arc(i,s,m,l,u),n.arc(i,s,m,u,l,!0),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.arc(i,s,x,l,u),n.arc(i,s,x,u,l,!0)}return n}const $L=(t,e)=>{const{coordinate:n,document:r}=e;return(i,s,l)=>{const{color:u,transform:h}=s,{color:p,fill:m=p,stroke:y=p}=l,x=NV(l,["color","fill","stroke"]),T=kV(i,n);return Ra(r.createElement("path",{})).call(Ln,x).style("d",T.toString()).style("stroke",y).style("fill",u||m).style("transform",h).call(Ln,t).node()}};$L.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var BV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function FV(t,e,n=4){const r=hp();if(!Ml(e))return r.moveTo(...t[2]),r.lineTo(...t[3]),r.lineTo(t[3][0]-n,t[3][1]),r.lineTo(t[10][0]-n,t[10][1]),r.lineTo(t[10][0]+n,t[10][1]),r.lineTo(t[3][0]+n,t[3][1]),r.lineTo(...t[3]),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]),r.moveTo(t[3][0]+n/2,t[8][1]),r.arc(t[3][0],t[8][1],n/2,0,Math.PI*2),r.closePath(),r;const i=e.getCenter(),[s,l]=i,u=Tt(i,t[3]),h=Tt(i,t[8]),p=Tt(i,t[10]),m=se(st(t[2],i)),y=Math.asin(n/h),x=m-y,T=m+y;r.moveTo(...t[2]),r.lineTo(...t[3]),r.moveTo(Math.cos(x)*u+s,Math.sin(x)*u+l),r.arc(s,l,u,x,T),r.lineTo(Math.cos(T)*p+s,Math.sin(T)*p+l),r.arc(s,l,p,T,x,!0),r.lineTo(Math.cos(x)*u+s,Math.sin(x)*u+l),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]);const C=(x+T)/2;return r.moveTo(Math.cos(C)*(h+n/2)+s,Math.sin(C)*(h+n/2)+l),r.arc(Math.cos(C)*h+s,Math.sin(C)*h+l,n/2,C,Math.PI*2+C),r.closePath(),r}const KL=(t,e)=>{const{coordinate:n,document:r}=e;return(i,s,l)=>{const{color:u,transform:h}=s,p=4,{color:m,fill:y=m,stroke:x=m}=l,T=BV(l,["color","fill","stroke"]),C=FV(i,n,p);return Ra(r.createElement("path",{})).call(Ln,T).style("d",C.toString()).style("stroke",x).style("fill",u||y).style("transform",h).call(Ln,t).node()}};KL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const QL={box:$L,violin:KL},JL=()=>(t,e,n,r)=>{const{x:i,y:s,y1:l,y2:u,y3:h,y4:p,series:m}=n,y=e.x,x=e.series,T=Array.from(t,C=>{const M=y.getBandWidth(y.invert(+i[C])),I=x?x.getBandWidth(x.invert(+(m==null?void 0:m[C]))):1,D=M*I,U=(+(m==null?void 0:m[C])||0)*M,Z=+i[C]+U+D/2,[G,W,$,J,nt]=[+s[C],+l[C],+u[C],+h[C],+p[C]];return[[Z-D/2,nt],[Z+D/2,nt],[Z,nt],[Z,J],[Z-D/2,J],[Z+D/2,J],[Z+D/2,W],[Z-D/2,W],[Z-D/2,$],[Z+D/2,$],[Z,W],[Z,G],[Z-D/2,G],[Z+D/2,G]].map(Et=>r.map(Et))});return[t,T]};JL.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:QL,channels:[...Nd({shapes:Object.keys(QL)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...tf(),{type:h_}],postInference:[...pf(),...j1()],interaction:{shareTooltip:!0}};const tD={vector:gC},eD=()=>(t,e,n,r)=>{const{x:i,y:s,size:l,rotate:u}=n,[h,p]=r.getSize(),m=t.map(y=>{const x=+u[y]/180*Math.PI,T=+l[y],C=T/h,M=T/p,I=C*Math.cos(x),D=-M*Math.sin(x);return[r.map([+i[y]-I/2,+s[y]-D/2]),r.map([+i[y]+I/2,+s[y]+D/2])]});return[t,m]};eD.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:tD,channels:[...Nd({shapes:Object.keys(tD)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...tf()],postInference:[...pf(),...Hg()]};var nD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function UV(t,e,n){return t.createElement("path",{style:Object.assign({d:`M ${e},${e} L -${e},0 L ${e},-${e} L 0,0 Z`,transformOrigin:"center"},n)})}function zV(t,e){if(!Ml(e))return ro().x(r=>r[0]).y(r=>r[1])(t);const n=e.getCenter();return kS()({startAngle:0,endAngle:Math.PI*2,outerRadius:Tt(t[0],n),innerRadius:Tt(t[1],n)})}function jV(t,e){if(!Ml(t))return e;const[n,r]=t.getCenter();return`translate(${n}, ${r}) ${e||""}`}const _C=(t,e)=>{const{arrow:n,arrowSize:r=4}=t,i=nD(t,["arrow","arrowSize"]),{coordinate:s,document:l}=e;return(u,h,p)=>{const{color:m,lineWidth:y}=p,x=nD(p,["color","lineWidth"]),{color:T=m,size:C=y}=h,M=n?UV(l,r,Object.assign({fill:i.stroke||T,stroke:i.stroke||T},ho(i,"arrow"))):null,I=zV(u,s),D=jV(s,h.transform);return Ra(l.createElement("path",{})).call(Ln,x).style("d",I).style("stroke",T).style("lineWidth",C).style("transform",D).style("markerEnd",M).call(Ln,i).node()}};_C.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const rD=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(Fb)?[t,e]:[t,ti({},e,{encode:{x:_c(n)}})]};rD.props={};const iD={line:_C},oD=t=>(e,n,r,i)=>{const{x:s}=r,l=p_(n,r,ti({style:{bandOffset:0}},t)),u=Array.from(e,h=>{const p=[s[h],1],m=[s[h],0];return[p,m].map(y=>i.map(l(y,h)))});return[e,u]};oD.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:iD,channels:[...V1({shapes:Object.keys(iD)}),{name:"x",required:!0}],preInference:[...tf(),{type:rD}],postInference:[...pf()]};const aD=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(Fb)?[t,e]:[t,ti({},e,{encode:{y:_c(n)}})]};aD.props={};const sD={line:_C},lD=t=>(e,n,r,i)=>{const{y:s}=r,l=p_(n,r,ti({style:{bandOffset:0}},t)),u=Array.from(e,h=>{const p=[0,s[h]],m=[1,s[h]];return[p,m].map(y=>i.map(l(y,h)))});return[e,u]};lD.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:sD,channels:[...V1({shapes:Object.keys(sD)}),{name:"y",required:!0}],preInference:[...tf(),{type:aD}],postInference:[...pf()]};var cD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function VV(t,e,n){return[["M",t,e],["L",t+2*n,e-n],["L",t+2*n,e+n],["Z"]]}function ZV(t){return ro().x(e=>e[0]).y(e=>e[1])(t)}function HV(t,e,n,r,i=0){const[[s,l],[u,h]]=e;if(gc(t)){const x=s+n,T=u+r,C=x+i;return[[x,l],[C,l],[C,h],[T,h]]}const p=l-n,m=h-r,y=p-i;return[[s,p],[s,y],[u,y],[u,m]]}const uD=(t,e)=>{const{offset:n=0,offset1:r=n,offset2:i=n,connectLength1:s,endMarker:l=!0}=t,u=cD(t,["offset","offset1","offset2","connectLength1","endMarker"]),{coordinate:h}=e;return(p,m,y)=>{const{color:x,connectLength1:T}=y,C=cD(y,["color","connectLength1"]),{color:M,transform:I}=m,D=HV(h,p,r,i,s!=null?s:T),U=ho(Object.assign(Object.assign({},u),y),"endMarker");return Ra(new Zi).call(Ln,C).style("d",ZV(D)).style("stroke",M||x).style("transform",I).style("markerEnd",l?new dl({className:"marker",style:Object.assign(Object.assign({},U),{symbol:VV})}):null).call(Ln,u).node()}};uD.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const fD={connector:uD},hD=(...t)=>yC(...t);hD.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:fD,channels:[...V1({shapes:Object.keys(fD)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf()],postInference:[...pf()]};function dD(t,e,n,r){if(e)return()=>[0,1];const{[t]:i,[`${t}1`]:s}=n;return l=>{var u;const h=((u=r.getBandWidth)===null||u===void 0?void 0:u.call(r,r.invert(+s[l])))||0;return[i[l],s[l]+h]}}function xC(t={}){const{extendX:e=!1,extendY:n=!1}=t;return(r,i,s,l)=>{const u=dD("x",e,s,i.x),h=dD("y",n,s,i.y),p=Array.from(r,m=>{const[y,x]=u(m),[T,C]=h(m);return[[y,T],[x,T],[x,C],[y,C]].map(Z=>l.map(Z))});return[r,p]}}const pD={range:d_},mD=()=>xC();mD.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:pD,channels:[...V1({shapes:Object.keys(pD)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf()],postInference:[...pf()]};const vD=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(Fb))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[t,ti({},e,{encode:{x:_c(r(n,0)),x1:_c(r(n,1))}})]}return[t,e]};vD.props={};const gD={range:d_},yD=()=>xC({extendY:!0});yD.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:gD,channels:[...V1({shapes:Object.keys(gD)}),{name:"x",required:!0}],preInference:[...tf(),{type:vD}],postInference:[...pf()]};const _D=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(Fb))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[t,ti({},e,{encode:{y:_c(r(n,0)),y1:_c(r(n,1))}})]}return[t,e]};_D.props={};const xD={range:d_},bD=()=>xC({extendX:!0});bD.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:xD,channels:[...V1({shapes:Object.keys(xD)}),{name:"y",required:!0}],preInference:[...tf(),{type:_D}],postInference:[...pf()]};var ED=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const bC=(t,e)=>{const{arrow:n,colorAttribute:r}=t,i=ED(t,["arrow","colorAttribute"]),{coordinate:s,document:l}=e;return(u,h,p)=>{const{color:m,stroke:y}=p,x=ED(p,["color","stroke"]),{d:T,color:C=m}=h,[M,I]=s.getSize();return Ra(l.createElement("path",{})).call(Ln,x).style("d",typeof T=="function"?T({width:M,height:I}):T).style(r,C).call(Ln,i).node()}};bC.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const SD=(t,e)=>bC(Object.assign({colorAttribute:"fill"},t),e);SD.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const TD=(t,e)=>bC(Object.assign({fill:"none",colorAttribute:"stroke"},t),e);TD.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const wD={path:SD,hollow:TD},AD=t=>(e,n,r,i)=>[e,e.map(()=>[[0,0]])];AD.props={defaultShape:"path",defaultLabelShape:"label",shape:wD,composite:!1,channels:[...Nd({shapes:Object.keys(wD)}),{name:"d",scale:"identity"}],preInference:[...tf()],postInference:[...pf()]};var GV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const OD=(t,e)=>{const{render:n}=t,r=GV(t,["render"]);return i=>{const[[s,l]]=i;return n(Object.assign(Object.assign({},r),{x:s,y:l}),e)}};OD.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const CD=()=>(t,e)=>{const{style:n={}}=e;return[t,ti({},e,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter(([,r])=>typeof r=="function").map(([r,i])=>[r,()=>i])))})]};CD.props={};const WV={shape:OD},RD=t=>{const{cartesian:e}=t;return e?iC:(n,r,i,s)=>{const{x:l,y:u}=i,h=p_(r,i,t),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};RD.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:WV,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...tf(),{type:pT},{type:mT},{type:CD}]};var XV=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const MD=(t,e)=>{const{document:n}=e;return(r,i,s)=>{const{transform:l}=i,{color:u}=s,h=XV(s,["color"]),{color:p=u}=i,[m,...y]=r,x=hp();return x.moveTo(...m),y.forEach(([T,C])=>{x.lineTo(T,C)}),x.closePath(),Ra(n.createElement("path",{})).call(Ln,h).style("d",x.toString()).style("stroke",p||u).style("fill",p||u).style("fillOpacity",.4).style("transform",l).call(Ln,t).node()}};MD.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const PD={density:MD},ID=()=>(t,e,n,r)=>{const{x:i,series:s}=n,l=Object.entries(n).filter(([y])=>y.startsWith("y")).map(([,y])=>y),u=Object.entries(n).filter(([y])=>y.startsWith("size")).map(([,y])=>y);if(i===void 0||l===void 0||u===void 0)throw new Error("Missing encode for x or y or size channel.");const h=e.x,p=e.series,m=Array.from(t,y=>{const x=h.getBandWidth(h.invert(+i[y])),T=p?p.getBandWidth(p.invert(+(s==null?void 0:s[y]))):1,C=x*T,M=(+(s==null?void 0:s[y])||0)*x,I=+i[y]+M+C/2;return[...l.map((U,Z)=>[I+ +u[Z][y]/t.length,+l[Z][y]]),...l.map((U,Z)=>[I-+u[Z][y]/t.length,+l[Z][y]]).reverse()].map(U=>r.map(U))});return[t,m]};ID.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:PD,channels:[...Nd({shapes:Object.keys(PD)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...tf(),{type:Ub},{type:h_}],postInference:[...pf(),...j1()],interaction:{shareTooltip:!0}};function LD(t){var e,n,r,i=t||1;function s(u,h){++e>i&&(r=n,l(1),++e),n[u]=h}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}const Net=LD(3);function YV(t,e=(...r)=>`${r[0]}`,n=16){const r=LD(n);return(...i)=>{const s=e(...i);let l=r.get(s);return r.has(s)?r.get(s):(l=t(...i),r.set(s,l),l)}}function qV(t){return typeof t=="string"?t.split(" ").map(e=>{const[n,r]=e.split(":");return[+n,r]}):t}function vT(t,e,n){const r=t?t():document.createElement("canvas");return r.width=e,r.height=n,r}const $V=YV((t,e,n)=>{const r=vT(n,t*2,t*2),i=r.getContext("2d"),s=t,l=t;if(e===1)i.beginPath(),i.arc(s,l,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{const u=i.createRadialGradient(s,l,t*e,s,l,t);u.addColorStop(0,"rgba(0,0,0,1)"),u.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=u,i.fillRect(0,0,2*t,2*t)}return r},t=>`${t}`);function KV(t,e){const r=vT(e,256,1).getContext("2d"),i=r.createLinearGradient(0,0,256,1);return qV(t).forEach(([s,l])=>{i.addColorStop(s,l)}),r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}function QV(t,e,n,r,i,s){const{blur:l}=i;let u=r.length;for(;u--;){const{x:h,y:p,value:m,radius:y}=r[u],x=Math.min(m,n),T=h-y,C=p-y,M=$V(y,1-l,s),I=(x-e)/(n-e);t.globalAlpha=Math.max(I,.001),t.drawImage(M,T,C)}return t}function JV(t,e,n,r,i){const{minOpacity:s,opacity:l,maxOpacity:u,useGradientOpacity:h}=i,p=0,m=0,y=e,x=n,T=t.getImageData(p,m,y,x),C=T.data,M=C.length;for(let I=3;I<M;I+=4){const D=C[I],U=D*4;if(!U)continue;const Z=l||Math.max(0,Math.min(u,Math.max(s,D)));C[I-3]=r[U],C[I-2]=r[U+1],C[I-1]=r[U+2],C[I]=h?r[U+3]:Z}return T}function tZ(t,e,n,r,i,s,l){const u=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},s);u.minOpacity*=255,u.opacity*=255,u.maxOpacity*=255;const p=vT(l,t,e).getContext("2d"),m=KV(u.gradient,l);p.clearRect(0,0,t,e),QV(p,n,r,i,u,l);const y=JV(p,t,e,m,u),T=vT(l,t,e).getContext("2d");return T.putImageData(y,0,0),T}var eZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function nZ(t,e){return Object.keys(t).reduce((n,r)=>{const i=t[r];return e(i,r)||(n[r]=i),n},{})}const DD=(t,e)=>{const{gradient:n,opacity:r,maxOpacity:i,minOpacity:s,blur:l,useGradientOpacity:u}=t,h=eZ(t,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:p,createCanvas:m,document:y}=e;return(x,T,C)=>{const{transform:M}=T,[I,D]=p.getSize(),U=x.map(J=>({x:J[0],y:J[1],value:J[2],radius:J[3]})),Z=Hp(x,J=>J[2]),G=El(x,J=>J[2]),$=I&&D?tZ(I,D,Z,G,U,nZ({gradient:n,opacity:r,minOpacity:s,maxOpacity:i,blur:l,useGradientOpacity:u},J=>J===void 0),m):{canvas:null};return Ra(y.createElement("image",{})).call(Ln,C).style("x",0).style("y",0).style("width",I).style("height",D).style("src",$.canvas).style("transform",M).call(Ln,h).node()}};DD.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ND={heatmap:DD},kD=t=>(e,n,r,i)=>{const{x:s,y:l,size:u,color:h}=r,p=Array.from(e,m=>{const y=u?+u[m]:40;return[...i.map([+s[m],+l[m]]),h[m],y]});return[[0],[p]]};kD.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:ND,channels:[...Nd({shapes:Object.keys(ND)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...tf(),{type:h_},{type:dT}],postInference:[...pf(),...Hg()]};var rZ=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},iZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function oZ(t,e){const{text:n="text",value:r="value"}=e;return t.map(i=>Object.assign(Object.assign({},i),{text:i[n],value:i[r]}))}const aZ=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:t=>t.fontFamily}}),EC=(t,e)=>rZ(void 0,void 0,void 0,function*(){const{width:n,height:r}=e,{data:i,encode:s={},scale:l,style:u={},layout:h={}}=t,p=iZ(t,["data","encode","scale","style","layout"]),m=oZ(i,s);return ti({},aZ(),Object.assign(Object.assign({data:{value:m,transform:[Object.assign({type:"wordCloud",size:[n,r]},h)]},encode:s,scale:l,style:u},p),{axis:!1}))});EC.props={};const BD=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];BD.props={};const FD=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];FD.props={};const UD=t=>new hh(t);UD.props={};const gT=Symbol("defaultUnknown");function zD(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function jD(t){const{value:e,from:n,to:r,mapper:i,notFoundReturn:s}=t;let l=i.get(e);if(l===void 0){if(s!==gT)return s;l=n.push(e)-1,i.set(e,l)}return r[l%r.length]}function VD(t){return t instanceof Date?e=>`${e}`:typeof t=="object"?e=>JSON.stringify(e):e=>e}class yT extends Zy{getDefaultOptions(){return{domain:[],range:[],unknown:gT}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&zD(this.domainIndexMap,this.getDomain(),this.domainKey),jD({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&zD(this.rangeIndexMap,this.getRange(),this.rangeKey),jD({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=VD(n),this.rangeKey=VD(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new yT(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:n}=this.options;return this.sortedDomain=n?[...e].sort(n):e,this.sortedDomain}}const ZD=t=>new yT(t);ZD.props={};function HD({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function sZ({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function lZ({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function cZ(t){return typeof t=="object"?t.valueOf():t}class GD extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=cZ,e!==null)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(HD({map:this.map,initKey:this.initKey},e))}has(e){return super.has(HD({map:this.map,initKey:this.initKey},e))}set(e,n){return super.set(sZ({map:this.map,initKey:this.initKey},e),n)}delete(e){return super.delete(lZ({map:this.map,initKey:this.initKey},e))}}function uZ(t){const e=Math.min(...t);return t.map(n=>n/e)}function fZ(t,e){const n=t.length,r=e-n;return r>0?[...t,...new Array(r).fill(1)]:r<0?t.slice(0,e):t}function hZ(t){return Math.round(t*1e12)/1e12}function dZ(t){const{domain:e,range:n,paddingOuter:r,paddingInner:i,flex:s,round:l,align:u}=t,h=e.length,p=fZ(s,h),[m,y]=n,x=y-m,T=2/h*r+1-1/h*i,C=x/T,M=C*i/h,I=C-h*M,D=uZ(p),U=D.reduce((Ht,Ct)=>Ht+Ct),Z=I/U,G=new GD(e.map((Ht,Ct)=>{const Ft=D[Ct]*Z;return[Ht,l?Math.floor(Ft):Ft]})),W=new GD(e.map((Ht,Ct)=>{const jt=D[Ct]*Z+M;return[Ht,l?Math.floor(jt):jt]})),$=Array.from(W.values()).reduce((Ht,Ct)=>Ht+Ct),nt=(x-($-$/h*i))*u,dt=m+nt;let Et=l?Math.round(dt):dt;const Pt=new Array(h);for(let Ht=0;Ht<h;Ht+=1){Pt[Ht]=hZ(Et);const Ct=e[Ht];Et+=W.get(Ct)}return{valueBandWidth:G,valueStep:W,adjustedRange:Pt}}function pZ(t){var e;const{domain:n}=t,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=t.flex)===null||e===void 0)&&e.length))return dZ(t);const{range:s,paddingOuter:l,paddingInner:u,round:h,align:p}=t;let m,y,x=s[0];const C=s[1]-x,M=l*2,I=r-u;m=C/Math.max(1,M+I),h&&(m=Math.floor(m)),x+=(C-m*(r-u))*p,y=m*(1-u),h&&(x=Math.round(x),y=Math.round(y));const D=new Array(r).fill(0).map((U,Z)=>x+Z*m);return{valueStep:m,valueBandWidth:y,adjustedRange:D}}class Gg extends yT{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:gT,flex:[]}}constructor(e){super(e)}clone(){return new Gg(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:n}=this.options;return e>0?e:n}getPaddingOuter(){const{padding:e,paddingOuter:n}=this.options;return e>0?e:n}rescale(){super.rescale();const{align:e,domain:n,range:r,round:i,flex:s}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:h}=pZ({align:e,range:r,round:i,flex:s,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=h,this.valueBandWidth=u,this.adjustedRange=l}}const WD=t=>new Gg(t);WD.props={};class _T extends Zy{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:_b}}map(e){return d1(e)?e:this.options.unknown}invert(e){return this.map(e)}clone(){return new _T(this.options)}getTicks(){const{domain:e,tickCount:n,tickMethod:r}=this.options,[i,s]=e;return!(0,ge.Z)(i)||!(0,ge.Z)(s)?[]:r(i,s,n)}}const XD=t=>new _T(t);XD.props={};class SC extends Gg{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:gT,paddingInner:1,paddingOuter:0}}constructor(e){super(e)}getPaddingInner(){return 1}clone(){return new SC(this.options)}update(e){super.update(e)}getPaddingOuter(){return this.options.padding}}const YD=t=>new SC(t);YD.props={};var qD=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Wg="\\d\\d?",Xg="\\d\\d",mZ="\\d{3}",vZ="\\d{4}",Vb="[^\\s]+",$D=/\[([^]*?)\]/gm;function KD(t,e){for(var n=[],r=0,i=t.length;r<i;r++)n.push(t[r].substr(0,e));return n}var QD=function(t){return function(e,n){var r=n[t].map(function(s){return s.toLowerCase()}),i=r.indexOf(e.toLowerCase());return i>-1?i:null}};function m_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var s=i[r];for(var l in s)t[l]=s[l]}return t}var JD=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],tN=["January","February","March","April","May","June","July","August","September","October","November","December"],gZ=KD(tN,3),yZ=KD(JD,3),eN={dayNamesShort:yZ,dayNames:JD,monthNamesShort:gZ,monthNames:tN,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!==10?1:0)*t%10]}},xT=m_({},eN),_Z=function(t){return xT=m_(xT,t)},nN=function(t){return t.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},dp=function(t,e){for(e===void 0&&(e=2),t=String(t);t.length<e;)t="0"+t;return t},xZ={D:function(t){return String(t.getDate())},DD:function(t){return dp(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return dp(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return dp(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return dp(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return dp(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return dp(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return dp(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return dp(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return dp(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return dp(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return dp(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+dp(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+dp(Math.floor(Math.abs(e)/60),2)+":"+dp(Math.abs(e)%60,2)}},rN=function(t){return+t-1},iN=[null,Wg],oN=[null,Vb],aN=["isPm",Vb,function(t,e){var n=t.toLowerCase();return n===e.amPm[0]?0:n===e.amPm[1]?1:null}],sN=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(t){var e=(t+"").match(/([+-]|\d\d)/gi);if(e){var n=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?n:-n}return 0}],bZ={D:["day",Wg],DD:["day",Xg],Do:["day",Wg+Vb,function(t){return parseInt(t,10)}],M:["month",Wg,rN],MM:["month",Xg,rN],YY:["year",Xg,function(t){var e=new Date,n=+(""+e.getFullYear()).substr(0,2);return+(""+(+t>68?n-1:n)+t)}],h:["hour",Wg,void 0,"isPm"],hh:["hour",Xg,void 0,"isPm"],H:["hour",Wg],HH:["hour",Xg],m:["minute",Wg],mm:["minute",Xg],s:["second",Wg],ss:["second",Xg],YYYY:["year",vZ],S:["millisecond","\\d",function(t){return+t*100}],SS:["millisecond",Xg,function(t){return+t*10}],SSS:["millisecond",mZ],d:iN,dd:iN,ddd:oN,dddd:oN,MMM:["month",Vb,QD("monthNamesShort")],MMMM:["month",Vb,QD("monthNames")],a:aN,A:aN,ZZ:sN,Z:sN},bT={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},EZ=function(t){return m_(bT,t)},lN=function(t,e,n){if(e===void 0&&(e=bT.default),n===void 0&&(n={}),typeof t=="number"&&(t=new Date(t)),Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");e=bT[e]||e;var r=[];e=e.replace($D,function(s,l){return r.push(l),"@@@"});var i=m_(m_({},xT),n);return e=e.replace(qD,function(s){return xZ[s](t,i)}),e.replace(/@@@/g,function(){return r.shift()})};function SZ(t,e,n){if(n===void 0&&(n={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=bT[e]||e,t.length>1e3)return null;var r=new Date,i={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},s=[],l=[],u=e.replace($D,function(G,W){return l.push(nN(W)),"@@@"}),h={},p={};u=nN(u).replace(qD,function(G){var W=bZ[G],$=W[0],J=W[1],nt=W[3];if(h[$])throw new Error("Invalid format. "+$+" specified twice in format");return h[$]=!0,nt&&(p[nt]=!0),s.push(W),"("+J+")"}),Object.keys(p).forEach(function(G){if(!h[G])throw new Error("Invalid format. "+G+" is required in specified format")}),u=u.replace(/@@@/g,function(){return l.shift()});var m=t.match(new RegExp(u,"i"));if(!m)return null;for(var y=m_(m_({},xT),n),x=1;x<m.length;x++){var T=s[x-1],C=T[0],M=T[2],I=M?M(m[x],y):+m[x];if(I==null)return null;i[C]=I}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var D;if(i.timezoneOffset==null){D=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var U=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],x=0,Z=U.length;x<Z;x++)if(h[U[x][0]]&&i[U[x][0]]!==D[U[x][1]]())return null}else if(D=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return D}var ket={format:lN,parse:SZ,defaultI18n:eN,setGlobalDateI18n:_Z,setGlobalDateMasks:EZ},Bet=null;const Zb=1e3,Hb=Zb*60,Gb=Hb*60,v_=Gb*24,Wb=v_*7,cN=v_*30,uN=v_*365;function dd(t,e,n,r){const i=(p,m)=>{const y=T=>r(T)%m===0;let x=m;for(;x&&!y(p);)n(p,-1),x-=1;return p},s=(p,m)=>{m&&i(p,m),e(p)},l=(p,m)=>{const y=new Date(+p);return s(y,m),y},u=(p,m)=>{const y=new Date(+p-1);return s(y,m),n(y,m),s(y),y};return{ceil:u,floor:l,range:(p,m,y,x)=>{const T=[],C=Math.floor(y),M=x?u(p,y):u(p);for(let I=M;I<m;n(I,C),s(I))T.push(new Date(+I));return T},duration:t}}const TZ=dd(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),wZ=dd(Zb,t=>{t.setMilliseconds(0)},(t,e=1)=>{t.setTime(+t+Zb*e)},t=>t.getSeconds()),AZ=dd(Hb,t=>{t.setSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Hb*e)},t=>t.getMinutes()),OZ=dd(Gb,t=>{t.setMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+Gb*e)},t=>t.getHours()),CZ=dd(v_,t=>{t.setHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+v_*e)},t=>t.getDate()-1),fN=dd(cN,t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getMonth();t.setMonth(n+e)},t=>t.getMonth()),RZ=dd(Wb,t=>{t.setDate(t.getDate()-t.getDay()%7),t.setHours(0,0,0,0)},(t,e=1)=>{t.setDate(t.getDate()+7*e)},t=>{const e=fN.floor(t),n=new Date(+t);return Math.floor((+n-+e)/Wb)}),MZ=dd(uN,t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getFullYear();t.setFullYear(n+e)},t=>t.getFullYear()),hN={millisecond:TZ,second:wZ,minute:AZ,hour:OZ,day:CZ,week:RZ,month:fN,year:MZ},PZ=dd(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),IZ=dd(Zb,t=>{t.setUTCMilliseconds(0)},(t,e=1)=>{t.setTime(+t+Zb*e)},t=>t.getUTCSeconds()),LZ=dd(Hb,t=>{t.setUTCSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Hb*e)},t=>t.getUTCMinutes()),DZ=dd(Gb,t=>{t.setUTCMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+Gb*e)},t=>t.getUTCHours()),NZ=dd(v_,t=>{t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+v_*e)},t=>t.getUTCDate()-1),dN=dd(cN,t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCMonth();t.setUTCMonth(n+e)},t=>t.getUTCMonth()),kZ=dd(Wb,t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7)%7),t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+Wb*e)},t=>{const e=dN.floor(t),n=new Date(+t);return Math.floor((+n-+e)/Wb)}),BZ=dd(uN,t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCFullYear();t.setUTCFullYear(n+e)},t=>t.getUTCFullYear()),pN={millisecond:PZ,second:IZ,minute:LZ,hour:DZ,day:NZ,week:kZ,month:dN,year:BZ};function FZ(t){const e=t?pN:hN,{year:n,month:r,week:i,day:s,hour:l,minute:u,second:h,millisecond:p}=e;return{tickIntervals:[[h,1],[h,5],[h,15],[h,30],[u,1],[u,5],[u,15],[u,30],[l,1],[l,3],[l,6],[l,12],[s,1],[s,2],[i,1],[r,1],[r,3],[n,1]],year:n,millisecond:p}}function mN(t,e,n,r,i){const s=+t,l=+e,{tickIntervals:u,year:h,millisecond:p}=FZ(i),m=([I,D])=>I.duration*D,y=r?(l-s)/r:n||5,x=r||(l-s)/y,T=u.length,C=tb(u,x,0,T,m);let M;if(C===T){const I=$E(s/h.duration,l/h.duration,y);M=[h,I]}else if(C){const I=x/m(u[C-1])<m(u[C])/x,[D,U]=I?u[C-1]:u[C],Z=r?Math.ceil(r/D.duration):U;M=[D,Z]}else{const I=Math.max($E(s,l,y),1);M=[p,I]}return M}const UZ=(t,e,n,r,i)=>{const s=t>e,l=s?e:t,u=s?t:e,[h,p]=mN(l,u,n,r,i),m=h.range(l,new Date(+u+1),p,!0);return s?m.reverse():m},zZ=(t,e,n,r,i)=>{const s=t>e,l=s?e:t,u=s?t:e,[h,p]=mN(l,u,n,r,i),m=[h.floor(l,p),h.ceil(u,p)];return s?m.reverse():m};function jZ(t,e){const{second:n,minute:r,hour:i,day:s,week:l,month:u,year:h}=e;return n.floor(t)<t?".SSS":r.floor(t)<t?":ss":i.floor(t)<t?"hh:mm":s.floor(t)<t?"hh A":u.floor(t)<t?l.floor(t)<t?"MMM DD":"ddd DD":h.floor(t)<t?"MMMM":"YYYY"}function VZ(t){const e=t.getTimezoneOffset(),n=new Date(t);return n.setMinutes(n.getMinutes()+e,n.getSeconds(),n.getMilliseconds()),n}class TC extends p1{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:UZ,interpolate:E0,mask:void 0,utc:!1}}chooseTransforms(){return[r=>+r,r=>new Date(r)]}chooseNice(){return zZ}getTickMethodOptions(){const{domain:e,tickCount:n,tickInterval:r,utc:i}=this.options,s=e[0],l=e[e.length-1];return[s,l,n,r,i]}getFormatter(){const{mask:e,utc:n}=this.options,r=n?pN:hN,i=n?VZ:Rv;return s=>lN(i(s),e||jZ(s,r))}clone(){return new TC(this.options)}}const vN=t=>new TC(t);vN.props={};const gN=t=>e=>-t(-e),wC=(t,e)=>{const n=Math.log(t),r=t===Math.E?Math.log:t===10?Math.log10:t===2?Math.log2:i=>Math.log(i)/n;return e?gN(r):r},AC=(t,e)=>{const n=t===Math.E?Math.exp:r=>vf(t,r);return e?gN(n):n},ZZ=(t,e,n,r=10)=>{const i=t<0,s=AC(r,i),l=wC(r,i),u=e<t,h=u?e:t,p=u?t:e;let m=l(h),y=l(p),x=[];if(!(r%1)&&y-m<n){if(m=Math.floor(m),y=Math.ceil(y),i)for(;m<=y;m+=1){const T=s(m);for(let C=r-1;C>=1;C-=1){const M=T*C;if(M>p)break;M>=h&&x.push(M)}}else for(;m<=y;m+=1){const T=s(m);for(let C=1;C<r;C+=1){const M=T*C;if(M>p)break;M>=h&&x.push(M)}}x.length*2<n&&(x=Mv(h,p,n))}else{const T=n===-1?y-m:Math.min(y-m,n);x=Mv(m,y,T).map(s)}return u?x.reverse():x},HZ=(t,e,n,r)=>{const i=t<0,s=wC(r,i),l=AC(r,i),u=t>e,h=u?e:t,p=u?t:e,m=[l(Math.floor(s(h))),l(Math.ceil(s(p)))];return u?m.reverse():m};class OC extends p1{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:up,tickMethod:ZZ,tickCount:5}}chooseNice(){return HZ}getTickMethodOptions(){const{domain:e,tickCount:n,base:r}=this.options,i=e[0],s=e[e.length-1];return[i,s,n,r]}chooseTransforms(){const{base:e,domain:n}=this.options,r=n[0]<0;return[wC(e,r),AC(e,r)]}clone(){return new OC(this.options)}}const yN=t=>new OC(t);yN.props={};const GZ=t=>e=>e<0?-vf(-e,t):vf(e,t),WZ=t=>e=>e<0?-vf(-e,1/t):vf(e,1/t),XZ=t=>t<0?-Math.sqrt(-t):Math.sqrt(t);class ET extends p1{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:up,tickMethod:Mv,tickCount:5}}constructor(e){super(e)}chooseTransforms(){const{exponent:e}=this.options;if(e===1)return[Rv,Rv];const n=e===.5?XZ:GZ(e),r=WZ(e);return[n,r]}clone(){return new ET(this.options)}}const _N=t=>new ET(t);_N.props={};class CC extends ET{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:up,tickMethod:Mv,tickCount:5,exponent:.5}}constructor(e){super(e)}update(e){super.update(e)}clone(){return new CC(this.options)}}const xN=t=>new CC(t);xN.props={};const bN=t=>new Ig(t);bN.props={};const EN=t=>new Ng(t);EN.props={};const SN=t=>new Dg(t);SN.props={};const YZ=t=>e=>{const n=t(e);return(0,ge.Z)(n)?Math.round(n):n};function qZ(t,e){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[r]=this.chooseTransforms();this.composeOutput(r,this.chooseClamp(r))},n.prototype.initRange=function(){const{interpolator:r}=this.options;this.options.range=t(r)},n.prototype.composeOutput=function(r,i){const{domain:s,interpolator:l,round:u}=this.getOptions(),h=e(s.map(r)),p=u?YZ(l):l;this.output=Ag(p,h,i,r)},n.prototype.invert=void 0}}var $Z=function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(s=(i<3?l(s):i>3?l(e,n,s):l(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},RC;function KZ(t){return[t(0),t(1)]}const QZ=t=>{const[e,n]=t;return Ag(E0(0,1),u1(e,n))};let MC=RC=class extends hh{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Rv,tickMethod:Mv,tickCount:5}}constructor(e){super(e)}clone(){return new RC(this.options)}};MC=RC=$Z([qZ(KZ,QZ)],MC);const TN=t=>new MC(t);TN.props={};const wN=t=>new r_(t);wN.props={};function PC({colorDefault:t,colorBlack:e,colorWhite:n,colorStroke:r,colorBackground:i,padding1:s,padding2:l,padding3:u,alpha90:h,alpha65:p,alpha45:m,alpha25:y,alpha10:x,category10:T,category20:C,sizeDefault:M=1,padding:I="auto",margin:D=16}){return{padding:I,margin:D,size:M,color:t,category10:T,category20:C,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:i,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:e,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:r,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:r,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:r,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:r,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:r,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:r,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:r,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:e,gridStrokeOpacity:x,labelAlign:"horizontal",labelFill:e,labelOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:s,line:!1,lineLineWidth:.5,lineStroke:e,lineStrokeOpacity:m,tickLength:4,tickLineWidth:1,tickStroke:e,tickOpacity:m,titleFill:e,titleOpacity:h,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",label:!1,tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:e,itemLabelFillOpacity:h,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[s,s],itemValueFill:e,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:e,navButtonFillOpacity:.65,navPageNumFill:e,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:e,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:e,tickStrokeOpacity:.25,rowPadding:s,colPadding:l,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:e,handleLabelFillOpacity:m,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:e,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:e,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:e,labelFillOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:h,tickStroke:e,tickStrokeOpacity:m},label:{fill:e,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:e,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:n,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:e,fontWeight:"normal"},slider:{trackSize:16,trackFill:r,trackFillOpacity:1,selectionFill:t,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:e,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:e,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:e,titleFillOpacity:h,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:e,subtitleFillOpacity:p,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{".g2-tooltip":{"font-family":"sans-serif"}}}}}const JZ=PC({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),IC=t=>ti({},JZ,t);IC.props={};const AN=t=>ti({},IC(),{category10:"category10",category20:"category20"},t);AN.props={};const tH=PC({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),ON=t=>ti({},tH,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{".g2-tooltip":{background:"#1f1f1f",opacity:.95},".g2-tooltip-title":{color:"#A6A6A6"},".g2-tooltip-list-item-name-label":{color:"#A6A6A6"},".g2-tooltip-list-item-value":{color:"#A6A6A6"}}}},t),CN=t=>Object.assign({},ON(),{category10:"category10",category20:"category20"},t);CN.props={};const eH=PC({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),RN=t=>ti({},eH,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(e,n)=>n!==0},axisRight:{gridFilter:(e,n)=>n!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},t);RN.props={};const MN=t=>(...e)=>{const n=zm(Object.assign({},{crossPadding:50},t))(...e);return iS(n,t),n};MN.props=Object.assign(Object.assign({},zm.props),{defaultPosition:"bottom"});function jet(){}const PN=t=>(...e)=>{const n=zm(Object.assign({},{crossPadding:10},t))(...e);return iS(n,t),n};PN.props=Object.assign(Object.assign({},zm.props),{defaultPosition:"left"});var LC=function(){},nH=function(t,e,n){var r=t,i=Si(e)?e.split("."):e;return i.forEach(function(s,l){l<i.length-1?(sa(r[s])||(r[s]=(0,ge.Z)(i[l+1])?[]:{}),r=r[s]):r[s]=n}),t};function rH(t,e){return t.reduce(function(n,r){return(n[r[e]]=n[r[e]]||[]).push(r),n},{})}function iH(t){var e;return((e=t[0])===null||e===void 0?void 0:e.map(function(n,r){return t.map(function(i){return i[r]})}))||[]}var w0=lp({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),oH=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:F3(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,s){return"".concat(i,"/").concat(s)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new Ai({class:w0.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new Ai({class:w0.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var n=this.attributes.defaultPage;return(0,uo.Z)(n,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var n=this.pageViews,r=(0,F.CR)(iH(n.map(function(y){var x=y.getBBox(),T=x.width,C=x.height;return[T,C]})).map(function(y){return Math.max.apply(Math,(0,F.ev)([],(0,F.CR)(y),!1))}),2),i=r[0],s=r[1],l=this.attributes,u=l.pageWidth,h=u===void 0?i:u,p=l.pageHeight,m=p===void 0?s:p;return{pageWidth:h,pageHeight:m}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=t.prototype.getBBox.call(this),r=n.x,i=n.y,s=this.controllerShape,l=this.pageShape,u=l.pageWidth,h=l.pageHeight;return new yc(r,i,u+s.width,h)},e.prototype.goTo=function(n){var r=this,i=this.attributes.animate,s=this,l=s.currPage,u=s.playState,h=s.playWindow,p=s.pageViews;if(u!=="idle"||n<0||p.length<=0||n>=p.length)return null;p[l].setLocalPosition(0,0),this.prepareFollowingPage(n);var m=(0,F.CR)(this.getFollowingPageDiff(n),2),y=m[0],x=m[1];this.playState="running";var T=SE(h,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-y,", ").concat(-x,")")}],i);return _g(T,function(){r.innerCurrPage=n,r.playState="idle",r.setVisiblePages([n]),r.updatePageInfo()}),T},e.prototype.prev=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i<=0)return null;var s=n?(i-1+r)%r:(0,uo.Z)(i-1,0,r);return this.goTo(s)},e.prototype.next=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i>=r-1)return null;var s=n?(i+1)%r:(0,uo.Z)(i+1,0,r);return this.goTo(s)},e.prototype.renderClipPath=function(n){var r=this.pageShape,i=r.pageWidth,s=r.pageHeight;if(!i||!s){this.contentGroup.style.clipPath=void 0;return}this.clipPath=n.maybeAppendByClassName(w0.clipPath,"rect").styles({width:i,height:s}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(n){this.playWindow.children.forEach(function(r,i){n.includes(i)?Iy(r):Dm(r)})},e.prototype.adjustControllerLayout=function(){var n=this,r=n.prevBtnGroup,i=n.nextBtnGroup,s=n.pageInfoGroup,l=this.attributes,u=l.orientation,h=l.controllerPadding,p=s.getBBox(),m=p.width,y=p.height,x=(0,F.CR)(u==="horizontal"?[-180,0]:[-90,90],2),T=x[0],C=x[1];r.setLocalEulerAngles(T),i.setLocalEulerAngles(C);var M=r.getBBox(),I=M.width,D=M.height,U=i.getBBox(),Z=U.width,G=U.height,W=Math.max(I,m,Z),$=u==="horizontal"?{offset:[[0,0],[I/2+h,0],[I+m+h*2,0]],textAlign:"start"}:{offset:[[W/2,-D-h],[W/2,0],[W/2,G+h]],textAlign:"center"},J=(0,F.CR)($.offset,3),nt=(0,F.CR)(J[0],2),dt=nt[0],Et=nt[1],Pt=(0,F.CR)(J[1],2),Ht=Pt[0],Ct=Pt[1],Ft=(0,F.CR)(J[2],2),jt=Ft[0],qt=Ft[1],Ee=$.textAlign,oe=s.querySelector("text");oe&&(oe.style.textAlign=Ee),r.setLocalPosition(dt,Et),s.setLocalPosition(Ht,Ct),i.setLocalPosition(jt,qt)},e.prototype.updatePageInfo=function(){var n,r=this,i=r.currPage,s=r.pageViews,l=r.attributes.formatter;s.length<2||((n=this.pageInfoGroup.querySelector(w0.pageInfo.class))===null||n===void 0||n.attr("text",l(i+1,s.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(n){var r=this.currPage;if(r===n)return[0,0];var i=this.attributes.orientation,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=n<r?-1:1;return i==="horizontal"?[h*l,0]:[0,h*u]},e.prototype.prepareFollowingPage=function(n){var r=this,i=r.currPage,s=r.pageViews;if(this.setVisiblePages([n,i]),n!==i){var l=(0,F.CR)(this.getFollowingPageDiff(n),2),u=l[0],h=l[1];s[n].setLocalPosition(u,h)}},e.prototype.renderController=function(n){var r=this,i=this.attributes.controllerSpacing,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=this.pageViews.length>=2,p=n.maybeAppendByClassName(w0.controller,"g");if(Q_(p.node(),h),!!h){var m=ia(this.attributes,"button"),y=ia(this.attributes,"pageNum"),x=(0,F.CR)(Pl(m),2),T=x[0],C=x[1],M=T.size,I=(0,F._T)(T,["size"]),D=!p.select(w0.prevBtnGroup.class).node(),U=p.maybeAppendByClassName(w0.prevBtnGroup,"g").styles(C);this.prevBtnGroup=U.node();var Z=U.maybeAppendByClassName(w0.prevBtn,"path"),G=p.maybeAppendByClassName(w0.nextBtnGroup,"g").styles(C);this.nextBtnGroup=G.node();var W=G.maybeAppendByClassName(w0.nextBtn,"path");[Z,W].forEach(function(J){J.styles((0,F.pi)((0,F.pi)({},I),{transformOrigin:"center"})),Nm(J.node(),M,!0)});var $=p.maybeAppendByClassName(w0.pageInfoGroup,"g");this.pageInfoGroup=$.node(),$.maybeAppendByClassName(w0.pageInfo,"text").styles(y),this.updatePageInfo(),p.node().setLocalPosition(l+i,u/2),D&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l;this.attr("transform","translate(".concat(s,", ").concat(u,")"));var h=Ga(r);this.renderClipPath(h),this.renderController(h),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var n=this,r=Q2(function(){return n.render(n.attributes,n)},50);this.playWindow.addEventListener(Sa.INSERTED,r),this.playWindow.addEventListener(Sa.REMOVED,r)},e}(Af),Gp=lp({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function aH(t){var e=t.querySelector(Gp.marker.class);return e?e.style:{}}var sH=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,{span:[1,1],marker:function(){return new Ir({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var n=this.attributes.valueText;return n?typeof n=="string"||typeof n=="number"?n!=="":typeof n=="function"?!0:n.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var n=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,s=n.node().getBBox(),l=s.width,u=s.height,h=r.node().getBBox(),p=h.width,m=h.height;return{markerWidth:i,labelWidth:l,valueWidth:p,height:Math.max(i,u,m)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var n=this.attributes.span;if(!n)return[1,1];var r=(0,F.CR)(jf(n),2),i=r[0],s=r[1],l=this.showValue?s:0,u=i+l;return[i/u,l/u]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var n,r=this.attributes,i=r.markerSize,s=r.width,l=this.actualSpace,u=l.markerWidth,h=l.height,p=this.actualSpace,m=p.labelWidth,y=p.valueWidth,x=(0,F.CR)(this.spacing,2),T=x[0],C=x[1];if(s){var M=s-i-T-C,I=(0,F.CR)(this.span,2),D=I[0],U=I[1];n=(0,F.CR)([D*M,U*M],2),m=n[0],y=n[1]}var Z=u+m+y+T+C;return{width:Z,height:h,markerWidth:u,labelWidth:m,valueWidth:y}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var n=this.attributes.spacing;if(!n)return[0,0];var r=(0,F.CR)(jf(n),2),i=r[0],s=r[1];return this.showValue?[i,s]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var n=this.shape,r=n.markerWidth,i=n.labelWidth,s=n.valueWidth,l=n.width,u=n.height,h=(0,F.CR)(this.spacing,2),p=h[0],m=h[1];return{height:u,width:l,markerWidth:r,labelWidth:i,valueWidth:s,position:[r/2,r+p,r+i+p+m]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var n=aH(this.markerGroup.node()),r=this.attributes,i=r.markerSize,s=r.markerStrokeWidth,l=s===void 0?n.strokeWidth:s,u=r.markerLineWidth,h=u===void 0?n.lineWidth:u,p=r.markerStroke,m=p===void 0?n.stroke:p,y=+(l||h||(m?1:0))*Math.sqrt(2),x=this.markerGroup.node().getBBox(),T=x.width,C=x.height;return(1-y/Math.max(T,C))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(n){var r=this,i=this.attributes.marker,s=ia(this.attributes,"marker");this.markerGroup=n.maybeAppendByClassName(Gp.markerGroup,"g").style("zIndex",0),sd(!!i,this.markerGroup,function(){var l,u=r.markerGroup.node(),h=(l=u.childNodes)===null||l===void 0?void 0:l[0],p=typeof i=="string"?new dl({style:{symbol:i},className:Gp.marker.name}):i();h?p.nodeName===h.nodeName?h instanceof dl?h.update((0,F.pi)((0,F.pi)({},s),{symbol:i})):(GA(h,p),Ga(h).styles(s)):(h.remove(),Ga(p).attr("className",Gp.marker.name).styles(s),u.appendChild(p)):(p instanceof dl||Ga(p).attr("className",Gp.marker.name).styles(s),u.appendChild(p)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var m=Nm(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(m,")")})},e.prototype.renderLabel=function(n){var r=ia(this.attributes,"label"),i=r.text,s=(0,F._T)(r,["text"]);this.labelGroup=n.maybeAppendByClassName(Gp.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Gp.label,function(){return fh(i)}).styles(s)},e.prototype.renderValue=function(n){var r=this,i=ia(this.attributes,"value"),s=i.text,l=(0,F._T)(i,["text"]);this.valueGroup=n.maybeAppendByClassName(Gp.valueGroup,"g").style("zIndex",0),sd(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Gp.value,function(){return fh(s)}).styles(l)})},e.prototype.renderBackground=function(n){var r=this.shape,i=r.width,s=r.height,l=ia(this.attributes,"background");this.background=n.maybeAppendByClassName(Gp.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Gp.background,"rect").styles((0,F.pi)({width:i,height:s},l))},e.prototype.adjustLayout=function(){var n=this.layout,r=n.labelWidth,i=n.valueWidth,s=n.height,l=(0,F.CR)(n.position,3),u=l[0],h=l[1],p=l[2],m=s/2;this.markerGroup.styles({transform:"translate(".concat(u,", ").concat(m,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(h,", ").concat(m,")")}),Sg(this.labelGroup.select(Gp.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(p,", ").concat(m,")")}),Sg(this.valueGroup.select(Gp.value.class).node(),Math.ceil(i)))},e.prototype.render=function(n,r){var i=Ga(r),s=n.x,l=s===void 0?0:s,u=n.y,h=u===void 0?0:u;i.styles({transform:"translate(".concat(l,", ").concat(h,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(Af),g_=lp({page:"item-page",navigator:"navigator",item:"item"},"items"),IN=function(t,e,n){return n===void 0&&(n=!0),t?e(t):n},lH=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:LC,mouseenter:LC,mouseleave:LC})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var n=this.attributes,r=n.gridRow,i=n.gridCol,s=n.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,s.length]:[s.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var n=this.attributes,r=n.data,i=n.layout,s=ia(this.attributes,"item"),l=r.map(function(u,h){var p=u.id,m=p===void 0?h:p,y=u.label,x=u.value;return{id:"".concat(m),index:h,style:(0,F.pi)({layout:i,labelText:y,valueText:x},Object.fromEntries(Object.entries(s).map(function(T){var C=(0,F.CR)(T,2),M=C[0],I=C[1];return[M,_s(I,[u,h,r])]})))}});return l},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var n=this,r=this.attributes,i=r.orientation,s=r.width,l=r.rowPadding,u=r.colPadding,h=(0,F.CR)(this.navigatorShape,1),p=h[0],m=(0,F.CR)(this.grid,2),y=m[0],x=m[1],T=x*y,C=0;return this.pageViews.children.map(function(M,I){var D,U,Z=Math.floor(I/T),G=I%T,W=n.ifHorizontal(x,y),$=[Math.floor(G/W),G%W];i==="vertical"&&$.reverse();var J=(0,F.CR)($,2),nt=J[0],dt=J[1],Et=(s-p-(x-1)*u)/x,Pt=M.getBBox().height,Ht=(0,F.CR)([0,0],2),Ct=Ht[0],Ft=Ht[1];return i==="horizontal"?(D=(0,F.CR)([C,nt*(Pt+l)],2),Ct=D[0],Ft=D[1],C=dt===x-1?0:C+Et+u):(U=(0,F.CR)([dt*(Et+u),C],2),Ct=U[0],Ft=U[1],C=nt===y-1?0:C+Pt+l),{page:Z,index:I,row:nt,col:dt,pageIndex:G,width:Et,height:Pt,x:Ct,y:Ft}})},e.prototype.getFlexLayout=function(){var n=this.attributes,r=n.width,i=n.height,s=n.rowPadding,l=n.colPadding,u=(0,F.CR)(this.navigatorShape,1),h=u[0],p=(0,F.CR)(this.grid,2),m=p[0],y=p[1],x=(0,F.CR)([r-h,i],2),T=x[0],C=x[1],M=(0,F.CR)([0,0,0,0,0,0,0,0],8),I=M[0],D=M[1],U=M[2],Z=M[3],G=M[4],W=M[5],$=M[6],J=M[7];return this.pageViews.children.map(function(nt,dt){var Et,Pt,Ht,Ct,Ft=nt.getBBox(),jt=Ft.width,qt=Ft.height,Ee=$===0?0:l,oe=$+Ee+jt;if(oe<=T&&IN(G,function(hn){return hn<y}))return Et=(0,F.CR)([$+Ee,J,oe],3),I=Et[0],D=Et[1],$=Et[2],{width:jt,height:qt,x:I,y:D,page:U,index:dt,pageIndex:Z++,row:W,col:G++};Pt=(0,F.CR)([W+1,0,0,J+qt+s],4),W=Pt[0],G=Pt[1],$=Pt[2],J=Pt[3];var _e=J+qt;return _e<=C&&IN(W,function(hn){return hn<m})?(Ht=(0,F.CR)([$,J,jt],3),I=Ht[0],D=Ht[1],$=Ht[2],{width:jt,height:qt,x:I,y:D,page:U,index:dt,pageIndex:Z++,row:W,col:G++}):(Ct=(0,F.CR)([0,0,jt,0,U+1,0,0,0],8),I=Ct[0],D=Ct[1],$=Ct[2],J=Ct[3],U=Ct[4],Z=Ct[5],W=Ct[6],G=Ct[7],{width:jt,height:qt,x:I,y:D,page:U,index:dt,pageIndex:Z++,row:W,col:G++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var n=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=n.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],n.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){var i=this.attributes.orientation;return Zp(i,n,r)},e.prototype.flattenPage=function(n){n.querySelectorAll(g_.item.class).forEach(function(r){n.appendChild(r)}),n.querySelectorAll(g_.page.class).forEach(function(r){var i=n.removeChild(r);i.destroy()})},e.prototype.renderItems=function(n){var r=this.attributes,i=r.click,s=r.mouseenter,l=r.mouseleave;this.flattenPage(n);var u=this.dispatchCustomEvent.bind(this);Ga(n).selectAll(g_.item.class).data(this.renderData,function(h){return h.id}).join(function(h){return h.append(function(p){var m=p.style;return new sH({style:m})}).attr("className",g_.item.name).on("click",function(){i==null||i(this),u("itemClick",{item:this})}).on("pointerenter",function(){s==null||s(this),u("itemMouseenter",{item:this})}).on("pointerleave",function(){l==null||l(this),u("itemMouseleave",{item:this})})},function(h){return h.each(function(p){var m=p.style;this.update(m)})},function(h){return h.remove()})},e.prototype.relayoutNavigator=function(){var n,r=this.attributes,i=r.layout,s=r.width,l=((n=this.pageViews.children[0])===null||n===void 0?void 0:n.getBBox().height)||0,u=(0,F.CR)(this.navigatorShape,2),h=u[0],p=u[1];this.navigator.update(i==="grid"?{pageWidth:s-h,pageHeight:l-p}:{})},e.prototype.adjustLayout=function(){var n=this,r=Object.entries(rH(this.itemsLayout,"page")).map(function(s){var l=(0,F.CR)(s,2),u=l[0],h=l[1];return{page:u,layouts:h}}),i=(0,F.ev)([],(0,F.CR)(this.navigator.getContainer().children),!1);r.forEach(function(s){var l=s.layouts,u=n.pageViews.appendChild(new Ai({className:g_.page.name}));l.forEach(function(h){var p=h.x,m=h.y,y=h.index,x=h.width,T=h.height,C=i[y];u.appendChild(C),nH(C,"__layout__",h),C.update({x:p,y:m,width:x,height:T})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(n){var r=this.attributes.orientation,i=ia(this.attributes,"nav"),s=Y0({orientation:r},i),l=this;return n.selectAll(g_.navigator.class).data(["nav"]).join(function(u){return u.append(function(){return new oH({style:s})}).attr("className",g_.navigator.name).each(function(){l.navigator=this})},function(u){return u.each(function(){this.update(s)})},function(u){return u.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(n,r){var i=this.attributes.data;if(!(!i||i.length===0)){var s=this.renderNavigator(Ga(r));this.renderItems(s.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(n,r){var i=new tl(n,{detail:r});this.dispatchEvent(i)},e}(Af),cH=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,Mg)||this}return e.prototype.renderTitle=function(n,r,i){var s=this.attributes,l=s.showTitle,u=s.titleText,h=ia(this.attributes,"title"),p=(0,F.CR)(Pl(h),2),m=p[0],y=p[1];this.titleGroup=n.maybeAppendByClassName(Hf.titleGroup,"g").styles(y);var x=(0,F.pi)((0,F.pi)({width:r,height:i},m),{text:l?u:""});this.title=this.titleGroup.maybeAppendByClassName(Hf.title,function(){return new Md({style:x})}).update(x)},e.prototype.renderItems=function(n,r){var i=r.x,s=r.y,l=r.width,u=r.height,h=ia(this.attributes,"title",!0),p=(0,F.CR)(Pl(h),2),m=p[0],y=p[1],x=(0,F.pi)((0,F.pi)({},m),{width:l,height:u,x:0,y:0});this.itemsGroup=n.maybeAppendByClassName(Hf.itemsGroup,"g").styles((0,F.pi)((0,F.pi)({},y),{transform:"translate(".concat(i,", ").concat(s,")")}));var T=this;this.itemsGroup.selectAll(Hf.items.class).data(["items"]).join(function(C){return C.append(function(){return new lH({style:x})}).attr("className",Hf.items.name).each(function(){T.items=Ga(this)})},function(C){return C.update(x)},function(C){return C.remove()})},e.prototype.adjustLayout=function(){var n=this.attributes.showTitle;if(n){var r=this.title.node().getAvailableSpace(),i=r.x,s=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(s,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.showTitle,i=n.width,s=n.height;return r?this.title.node().getAvailableSpace():new yc(0,0,i,s)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n,r,i=(n=this.title)===null||n===void 0?void 0:n.node(),s=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!s?t.prototype.getBBox.call(this):WE(i,s)},e.prototype.render=function(n,r){var i=this.attributes,s=i.width,l=i.height,u=i.x,h=u===void 0?0:u,p=i.y,m=p===void 0?0:p,y=Ga(r);r.style.transform="translate(".concat(h,", ").concat(m,")"),this.renderTitle(y,s,l),this.renderItems(y,this.availableSpace),this.adjustLayout()},e}(Af);function Xb(t){if(ap(t)){var e=t;return e[e.length-1]}}var uH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function fH(t,e){const n=Pd(t,"shape"),r=Pd(t,"color"),i=n?n.clone():null,s=[];for(const[u,h]of e){const p=u.type,y=((r==null?void 0:r.getOptions().domain.length)>0?r==null?void 0:r.getOptions().domain:h.data).map((x,T)=>{var C;return i?i.map(x||"point"):((C=u==null?void 0:u.style)===null||C===void 0?void 0:C.shape)||h.defaultShape||"point"});typeof p=="string"&&s.push([p,y])}if(s.length===0)return["point",["point"]];if(s.length===1||!n)return s[0];const{range:l}=n.getOptions();return s.map(([u,h])=>{let p=0;for(let m=0;m<s.length;m++){const y=l[m%l.length];h[m]===y&&p++}return[p/h.length,[u,h]]}).sort((u,h)=>h[0]-u[0])[0][1]}function hH(t,e){const{scales:n,library:r,markState:i}=e,[s,l]=fH(n,i),{itemMarker:u,itemMarkerSize:h}=t,p=(x,T)=>{var C,M,I;const D=((I=(M=(C=r[`mark.${s}`])===null||C===void 0?void 0:C.props)===null||M===void 0?void 0:M.shape[x])===null||I===void 0?void 0:I.props.defaultMarker)||Xb(x.split(".")),U=typeof h=="function"?h(T):h;return()=>B2(D,{color:T.color})(0,0,U)},m=x=>`${l[x]}`;return Pd(n,"shape")&&!u?(x,T)=>p(m(T),x):typeof u=="function"?(x,T)=>{const C=u(x.id,T);return typeof C=="string"?p(C,x):C}:(x,T)=>p(u||m(T),x)}function dH(t){const e=Pd(t,"opacity");if(e){const{range:n}=e.getOptions();return(r,i)=>n[i]}}function pH(t,e){const n=Pd(t,"size");return n instanceof _T?n.map(NaN)*2:e}function mH(t,e){const{labelFormatter:n=x=>`${x}`}=t,{scales:r,theme:i}=e,s=i.legendCategory.itemMarkerSize,l=pH(r,s),u={itemMarker:hH(Object.assign(Object.assign({},t),{itemMarkerSize:l}),e),itemMarkerSize:l,itemMarkerOpacity:dH(r)},h=typeof n=="string"?Lm(n):n,p=Pd(r,"color"),m=qy(r),y=p?x=>p.map(x):()=>e.theme.color;return Object.assign(Object.assign({},u),{data:m.map(x=>({id:x,label:h(x),color:y(x)}))})}function vH(t,e,n){const{position:r}=e;if(r==="center"){const{bbox:l}=t,{width:u,height:h}=l;return{width:u,height:h}}const{width:i,height:s}=nS(t,e,n);return{width:i,height:s}}const DC=t=>{const{labelFormatter:e,layout:n,order:r,orientation:i,position:s,size:l,title:u,cols:h,itemMarker:p}=t,m=uH(t,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker"]),{gridRow:y}=m;return x=>{const{value:T,theme:C}=x,{bbox:M}=T,{width:I,height:D}=vH(T,t,DC),U=Pv(s,n),Z=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(s)?"vertical":"horizontal",width:I,height:D,layout:h!==void 0?"grid":"flex"},h!==void 0&&{gridCol:h}),y!==void 0&&{gridRow:y}),{titleText:y1(u)}),mH(t,x)),{legendCategory:G={}}=C,W=x1(Object.assign({},G,Z,m)),$=new f3({style:Object.assign(Object.assign({x:M.x,y:M.y,width:M.width,height:M.height},U),{subOptions:W})});return $.appendChild(new cH({className:"legend-category",style:W})),$}};DC.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const LN=t=>()=>new Ai;LN.props={};var gH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function DN(t,e,n,r){switch(r){case"center":return{x:t+n/2,y:e,textAlign:"middle"};case"right":return{x:t+n,y:e,textAlign:"right"};default:return{x:t,y:e,textAlign:"left"}}}const yH=g1({render(t,e){const{width:n,title:r,subtitle:i,spacing:s=2,align:l="left",x:u,y:h}=t,p=gH(t,["width","title","subtitle","spacing","align","x","y"]);e.style.transform=`translate(${u}, ${h})`;const m=ho(p,"title"),y=ho(p,"subtitle"),T=eS(e,".title","text").attr("className","title").call(Ln,Object.assign(Object.assign(Object.assign({},DN(0,0,n,l)),{fontSize:14,textBaseline:"top",text:r}),m)).node().getLocalBounds();eS(e,".sub-title","text").attr("className","sub-title").call(C=>{if(!i)return C.node().remove();C.node().attr(Object.assign(Object.assign(Object.assign({},DN(0,T.max[1]+s,n,l)),{fontSize:12,textBaseline:"top",text:i}),y))})}}),NN=t=>({value:e,theme:n})=>{const{x:r,y:i,width:s,height:l}=e.bbox;return new yH({style:ti({},n.title,Object.assign({x:r,y:i,width:s,height:l},t))})};NN.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};var NC=function(t){if(typeof t!="object"||t===null)return t;var e;if(Ps(t)){e=[];for(var n=0,r=t.length;n<r;n++)typeof t[n]=="object"&&t[n]!=null?e[n]=NC(t[n]):e[n]=t[n]}else{e={};for(var i in t)typeof t[i]=="object"&&t[i]!=null?e[i]=NC(t[i]):e[i]=t[i]}return e},kC=NC,_H=function(t){(0,F.ZT)(e,t);function e(n){var r=this,i=n.style,s=(0,F._T)(n,["style"]);return r=t.call(this,ti({},{type:"column"},(0,F.pi)({style:i},s)))||this,r.columnsGroup=new Ai({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.columns,i=n.x,s=n.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(s,")"),Ga(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(l){return l.append("rect").attr("className","column").each(function(u){this.attr(u)})},function(l){return l.each(function(u){this.attr(u)})},function(l){return l.remove()})},e.prototype.update=function(n){this.attr(Y0({},this.attributes,n)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(xr),xH=function(t){(0,F.ZT)(e,t);function e(n){var r=this,i=n.style,s=(0,F._T)(n,["style"]);return r=t.call(this,ti({},{type:"lines"},(0,F.pi)({style:i},s)))||this,r.linesGroup=r.appendChild(new Ai),r.areasGroup=r.appendChild(new Ai),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.lines,i=n.areas,s=n.x,l=n.y;this.style.transform="translate(".concat(s,", ").concat(l,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(n){this.attr(Y0({},this.attributes,n)),this.render()},e.prototype.renderLines=function(n){Ga(this.linesGroup).selectAll(".line").data(n).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},e.prototype.renderAreas=function(n){Ga(this.linesGroup).selectAll(".area").data(n).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},e}(xr);function bH(t,e,n,r){var i,s=[],l=!!r,u,h,p=[1/0,1/0],m=[-1/0,-1/0],y,x,T;if(l){i=(0,F.CR)(r,2),p=i[0],m=i[1];for(var C=0,M=t.length;C<M;C+=1){var I=t[C];p=Of(p,I),m=cp(m,I)}}for(var C=0,D=t.length;C<D;C+=1){var I=t[C];if(C===0&&!n)T=I;else if(C===D-1&&!n)x=I,s.push(T),s.push(x);else{var U=[C?C-1:D-1,C-1][n?0:1];u=t[U],h=t[n?(C+1)%D:C+1];var Z=[0,0];Z=jx(h,u),Z=q0(Z,e);var G=Ny(I,u),W=Ny(I,h),$=G+W;$!==0&&(G/=$,W/=$);var J=q0(Z,-G),nt=q0(Z,W);x=Dy(I,J),y=Dy(I,nt),y=Of(y,cp(h,I)),y=cp(y,Of(h,I)),J=jx(y,I),J=q0(J,-G/W),x=Dy(I,J),x=Of(x,cp(u,I)),x=cp(x,Of(u,I)),nt=jx(I,x),nt=q0(nt,W/G),y=Dy(I,nt),l&&(x=cp(x,p),x=Of(x,m),y=cp(y,p),y=Of(y,m)),s.push(T),s.push(x),T=y}}return n&&s.push(s.shift()),s}function EH(t,e,n){var r;e===void 0&&(e=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var i=!!e,s=[],l=0,u=t.length;l<u;l+=2)s.push([t[l],t[l+1]]);for(var h=bH(s,.4,i,n),p=s.length,m=[],y,x,T,l=0;l<p-1;l+=1)y=h[l*2],x=h[l*2+1],T=s[l+1],m.push(["C",y[0],y[1],x[0],x[1],T[0],T[1]]);return i&&(y=h[p],x=h[p+1],r=(0,F.CR)(s,1),T=r[0],m.push(["C",y[0],y[1],x[0],x[1],T[0],T[1]])),m}function SH(t,e){var n,r=e.x,i=e.y,s=(0,F.CR)(i.getOptions().range||[0,0],2),l=s[0],u=s[1];return u>l&&(n=(0,F.CR)([l,u],2),u=n[0],l=n[1]),t.map(function(h){var p=h.map(function(m,y){return[r.map(y),(0,uo.Z)(i.map(m),u,l)]});return p})}function Yb(t,e){e===void 0&&(e=!1);var n=e?t.length-1:0,r=t.map(function(i,s){return(0,F.ev)([s===n?"M":"L"],(0,F.CR)(i),!1)});return e?r.reverse():r}function ST(t,e){if(e===void 0&&(e=!1),t.length<=2)return Yb(t);for(var n=[],r=t.length,i=0;i<r;i+=1){var s=e?t[r-i-1]:t[i];dE(s,n.slice(-2))||n.push.apply(n,(0,F.ev)([],(0,F.CR)(s),!1))}var l=EH(n,!1);return e?l.unshift((0,F.ev)(["M"],(0,F.CR)(t[r-1]),!1)):l.unshift((0,F.ev)(["M"],(0,F.CR)(t[0]),!1)),l}function BC(t,e,n){var r=kC(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}function TH(t,e,n,r){return t.map(function(i){return BC(e?ST(i):Yb(i),n,r)})}function wH(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var s=t[i],l=Yb(s),u=void 0;if(i===0)u=BC(l,e,n);else{var h=t[i-1],p=Yb(h,!0);p[0][0]="L",u=(0,F.ev)((0,F.ev)((0,F.ev)([],(0,F.CR)(l),!1),(0,F.CR)(p),!1),[["Z"]],!1)}r.push(u)}return r}function AH(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var s=t[i],l=ST(s),u=void 0;if(i===0)u=BC(l,e,n);else{var h=t[i-1],p=ST(h,!0),m=s[0];p[0][0]="L",u=(0,F.ev)((0,F.ev)((0,F.ev)([],(0,F.CR)(l),!1),(0,F.CR)(p),!1),[(0,F.ev)(["M"],(0,F.CR)(m),!1),["Z"]],!1)}r.push(u)}return r}var OH=function(t,e){if(Ps(t)){for(var n,r=1/0,i=0;i<t.length;i++){var s=t[i],l=Ih(e)?e(s):s[e];l<r&&(n=s,r=l)}return n}},CH=function(t,e){if(Ps(t)){for(var n,r=-1/0,i=0;i<t.length;i++){var s=t[i],l=Ih(e)?e(s):s[e];l>r&&(n=s,r=l)}return n}};function kN(t){return t.length===0?[0,0]:[nu(OH(t,function(e){return nu(e)||0})),sc(CH(t,function(e){return sc(e)||0}))]}function BN(t){for(var e=kC(t),n=e[0].length,r=(0,F.CR)([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],s=r[1],l=0;l<e.length;l+=1)for(var u=e[l],h=0;h<n;h+=1)u[h]>=0?(u[h]+=i[h],i[h]=u[h]):(u[h]+=s[h],s[h]=u[h]);return e}var RH=function(t){(0,F.ZT)(e,t);function e(n){return t.call(this,n,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var n=this.attributes.data;if(!n||(n==null?void 0:n.length)===0)return[[]];var r=kC(n);return(0,ge.Z)(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?BN(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var n=this.scales.y,r=(0,F.CR)(n.getOptions().domain||[0,0],2),i=r[0],s=r[1];return s<0?n.map(s):n.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var n=this.attributes,r=n.width,i=n.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var n=this,r=this.attributes,i=r.type,s=r.isStack,l=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var u=ia(this.attributes,"area"),h=ia(this.attributes,"line"),p=this.containerShape.width,m=this.data;if(m[0].length===0)return{lines:[],areas:[]};var y=this.scales,x=y.x,T=y.y,C=SH(m,{type:"line",x,y:T}),M=[];if(u){var I=this.baseline;s?M=l?AH(C,p,I):wH(C,p,I):M=TH(C,l,p,I)}return{lines:C.map(function(D,U){return(0,F.pi)({stroke:n.getColor(U),d:l?ST(D):Yb(D)},h)}),areas:M.map(function(D,U){return(0,F.pi)({d:D,fill:n.getColor(U)},u)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var n=this,r=ia(this.attributes,"column"),i=this.attributes,s=i.isStack,l=i.type,u=i.scale;if(l!=="column")throw new Error("columnsStyle can only be used in column type");var h=this.containerShape.height,p=this.rawData;if(!p)return{columns:[]};s&&(p=BN(p));var m=this.createScales(p),y=m.x,x=m.y,T=(0,F.CR)(kN(p),2),C=T[0],M=T[1],I=new hh({domain:[0,M-(C>0?0:C)],range:[0,h*u]}),D=y.getBandWidth(),U=this.rawData;return{columns:p.map(function(Z,G){return Z.map(function(W,$){var J=D/p.length,nt=function(){return{x:y.map($)+J*G,y:W>=0?x.map(W):x.map(0),width:J,height:I.map(Math.abs(W))}},dt=function(){return{x:y.map($),y:x.map(W),width:D,height:I.map(U[G][$])}};return(0,F.pi)((0,F.pi)({fill:n.getColor(G)},r),s?dt():nt())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){PA(r,".container","rect").attr("className","container").node();var i=n.type,s=n.x,l=n.y,u="spark".concat(i),h=(0,F.pi)({x:s,y:l},i==="line"?this.linesStyle:this.columnsStyle);Ga(r).selectAll(".spark").data([i]).join(function(p){return p.append(function(m){return m==="line"?new xH({className:u,style:h}):new _H({className:u,style:h})}).attr("className","spark ".concat(u))},function(p){return p.update(h)},function(p){return p.remove()})},e.prototype.getColor=function(n){var r=this.attributes.color;return Ps(r)?r[n%r.length]:Ih(r)?r.call(null,n):r},e.prototype.createScales=function(n){var r,i,s=this.attributes,l=s.type,u=s.scale,h=s.range,p=h===void 0?[]:h,m=s.spacing,y=this.containerShape,x=y.width,T=y.height,C=(0,F.CR)(kN(n),2),M=C[0],I=C[1],D=new hh({domain:[(r=p[0])!==null&&r!==void 0?r:M,(i=p[1])!==null&&i!==void 0?i:I],range:[T,T*(1-u)]});return l==="line"?{type:l,x:new hh({domain:[0,n[0].length-1],range:[0,x]}),y:D}:{type:l,x:new Gg({domain:n[0].map(function(U,Z){return Z}),range:[0,x],paddingInner:m,paddingOuter:m/2,align:.5}),y:D}},e.tag="sparkline",e}(Af),FN=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,(0,F.pi)((0,F.pi)((0,F.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Zl(hb,"handle")),Zl(fb,"handleIcon")),Zl(cS,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(s){s.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(E1(s));var l=r.availableSpace,u=l.x,h=l.y,p=r.getBBox(),m=p.x,y=p.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([u,h])-r.getOrientVal([+m,+y])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var s=r.attributes,l=s.slidable,u=s.brushable,h=s.type;i.stopPropagation();var p=r.getOrientVal(E1(i)),m=p-r.prevPos;if(m){var y=r.getRatio(m);switch(r.target){case"start":l&&r.setValuesOffset(y);break;case"end":l&&r.setValuesOffset(0,y);break;case"selection":l&&r.setValuesOffset(y,y);break;case"track":if(!u)return;r.selectionWidth+=y,h==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=p}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var s=r.attributes,l=s.onChange,u=s.type,h=u==="range"?i:i[1],p=u==="range"?r.getValues():r.getValues()[1],m=new tl("valuechange",{detail:{oldValue:h,value:p}});r.dispatchEvent(m),l==null||l(p)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(n){this.attributes.values=this.clampValues(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var n=this.attributes.orientation;if(n!=="horizontal")return null;var r=ia(this.attributes,"sparkline");return(0,F.pi)((0,F.pi)({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var n=this.attributes,r=n.trackLength,i=n.trackSize,s=(0,F.CR)(this.getOrientVal([[r,i],[i,r]]),2),l=s[0],u=s[1];return{width:l,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.x,i=n.y,s=n.padding,l=(0,F.CR)(jf(s),4),u=l[0],h=l[1],p=l[2],m=l[3],y=this.shape,x=y.width,T=y.height;return{x:m,y:u,width:x-(m+h),height:T-(u+p)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1),this.attributes.values=n;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(n){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(Ju.selection.class).each(function(i,s){x0(this,r[s],n)})},e.prototype.updateHandlesPosition=function(n){this.attributes.showHandle&&(this.startHandle&&x0(this.startHandle,this.getHandleStyle("start"),n),this.endHandle&&x0(this.endHandle,this.getHandleStyle("end"),n))},e.prototype.innerSetValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1);var i=this.values,s=this.clampValues(n);this.attributes.values=s,this.setValues(s),r&&this.onValueChange(i)},e.prototype.renderTrack=function(n){var r=this.attributes,i=r.x,s=r.y,l=ia(this.attributes,"track");this.trackShape=Ga(n).maybeAppendByClassName(Ju.track,"rect").styles((0,F.pi)((0,F.pi)({x:i,y:s},this.shape),l))},e.prototype.renderBrushArea=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.brushable;this.brushArea=Ga(n).maybeAppendByClassName(Ju.brushArea,"rect").styles((0,F.pi)({x:i,y:s,fill:"transparent",cursor:l?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.orientation,h=Ga(n).maybeAppendByClassName(Ju.sparklineGroup,"g");sd(u==="horizontal",h,function(p){var m=(0,F.pi)((0,F.pi)({},r.sparklineStyle),{x:s,y:l});p.maybeAppendByClassName(Ju.sparkline,function(){return new RH({style:m})}).update(m)})},e.prototype.renderHandles=function(){var n=this,r,i=this.attributes,s=i.showHandle,l=i.type,u=l==="range"?["start","end"]:["end"],h=s?u:[],p=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(Ju.handle.class).data(h.map(function(m){return{type:m}}),function(m){return m.type}).join(function(m){return m.append(function(y){var x=y.type;return new db({style:n.getHandleStyle(x)})}).each(function(y){var x=y.type;this.attr("class","".concat(Ju.handle.name," ").concat(x,"-handle"));var T="".concat(x,"Handle");p[T]=this,this.addEventListener("pointerdown",p.onDragStart(x))})},function(m){return m.each(function(y){var x=y.type;this.update(p.getHandleStyle(x))})},function(m){return m.each(function(y){var x=y.type,T="".concat(x,"Handle");p[T]=void 0}).remove()})},e.prototype.renderSelection=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.type,u=r.selectionType;this.foregroundGroup=Ga(n).maybeAppendByClassName(Ju.foreground,"g");var h=ia(this.attributes,"selection"),p=function(y){return y.style("visibility",function(x){return x.show?"visible":"hidden"}).style("cursor",function(x){return u==="select"?"grab":u==="invert"?"crosshair":"default"}).styles((0,F.pi)((0,F.pi)({},h),{transform:"translate(".concat(i,", ").concat(s,")")}))},m=this;this.foregroundGroup.selectAll(Ju.selection.class).data(l==="value"?[]:this.calcSelectionArea().map(function(y,x){return{style:(0,F.pi)({},y),index:x,show:u==="select"?x===1:x!==1}}),function(y){return y.index}).join(function(y){return y.append("rect").attr("className",Ju.selection.name).call(p).each(function(x,T){var C=this;T===1?(m.selectionShape=Ga(this),this.on("pointerdown",function(M){C.attr("cursor","grabbing"),m.onDragStart("selection")(M)}),m.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),m.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),m.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){C.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){C.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){C.attr("cursor","pointer")})):this.on("pointerdown",m.onDragStart("track"))})},function(y){return y.call(p)},function(y){return y.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(n,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(n,r){var i;r===void 0&&(r=4);var s=(0,F.CR)(this.range,2),l=s[0],u=s[1],h=(0,F.CR)(this.getValues().map(function(I){return $y(I,r)}),2),p=h[0],m=h[1],y=Array.isArray(n)?n:[p,n!=null?n:m],x=(0,F.CR)((y||[p,m]).map(function(I){return $y(I,r)}),2),T=x[0],C=x[1];if(this.attributes.type==="value")return[0,(0,uo.Z)(C,l,u)];T>C&&(i=(0,F.CR)([C,T],2),T=i[0],C=i[1]);var M=C-T;return M>u-l?[l,u]:T<l?p===l&&m===C?[l,C]:[l,M+l]:C>u?m===u&&p===T?[T,u]:[u-M,u]:[T,C]},e.prototype.calcSelectionArea=function(n){var r=(0,F.CR)(this.clampValues(n),2),i=r[0],s=r[1],l=this.availableSpace,u=l.x,h=l.y,p=l.width,m=l.height;return this.getOrientVal([[{y:h,height:m,x:u,width:i*p},{y:h,height:m,x:i*p+u,width:(s-i)*p},{y:h,height:m,x:s*p,width:(1-s)*p}],[{x:u,width:p,y:h,height:i*m},{x:u,width:p,y:i*m+h,height:(s-i)*m},{x:u,width:p,y:s*m,height:(1-s)*m}]])},e.prototype.calcHandlePosition=function(n){var r=this.attributes.handleIconOffset,i=this.availableSpace,s=i.x,l=i.y,u=i.width,h=i.height,p=(0,F.CR)(this.clampValues(),2),m=p[0],y=p[1],x=n==="start"?-r:r,T=(n==="start"?m:y)*this.getOrientVal([u,h])+x;return{x:s+this.getOrientVal([T,u/2]),y:l+this.getOrientVal([h/2,T])}},e.prototype.inferTextStyle=function(n){var r=this.attributes.orientation;return r==="horizontal"?{}:n==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:n==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(n){var r,i=this.attributes,s=i.type,l=i.orientation,u=i.formatter,h=i.autoFitLabel,p=ia(this.attributes,"handle"),m=ia(p,"label"),y=p.spacing,x=this.getHandleSize(),T=this.clampValues(),C=n==="start"?T[0]:T[1],M=u(C),I=new Ly({style:(0,F.pi)((0,F.pi)((0,F.pi)({},m),this.inferTextStyle(n)),{text:M})}),D=I.getBBox(),U=D.width,Z=D.height;if(I.destroy(),!h){if(s==="value")return{text:M,x:0,y:-Z-y};var G=y+x+(l==="horizontal"?U/2:0);return r={text:M},r[l==="horizontal"?"x":"y"]=n==="start"?-G:G,r}var W=0,$=0,J=this.availableSpace,nt=J.width,dt=J.height,Et=this.calcSelectionArea()[1],Pt=Et.x,Ht=Et.y,Ct=Et.width,Ft=Et.height,jt=y+x;if(l==="horizontal"){var qt=jt+U/2;if(n==="start"){var Ee=Pt-jt-U;W=Ee>0?-qt:qt}else{var oe=nt-Pt-Ct-jt>U;W=oe?qt:-qt}}else{var _e=jt,hn=Z+jt;n==="start"?$=Ht-x>Z?-hn:_e:$=dt-(Ht+Ft)-x>Z?hn:-_e}return{x:W,y:$,text:M}},e.prototype.getHandleLabelStyle=function(n){var r=ia(this.attributes,"handleLabel");return(0,F.pi)((0,F.pi)((0,F.pi)({},r),this.calcHandleText(n)),this.inferTextStyle(n))},e.prototype.getHandleIconStyle=function(){var n=this.attributes.handleIconShape,r=ia(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),s=this.getHandleSize();return(0,F.pi)({cursor:i,shape:n,size:s},r)},e.prototype.getHandleStyle=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.showLabel,u=r.showLabelOnInteraction,h=r.orientation,p=this.calcHandlePosition(n),m=p.x,y=p.y,x=this.calcHandleText(n),T=l;return!l&&u&&(this.target?T=!0:T=!1),(0,F.pi)((0,F.pi)((0,F.pi)({},Zl(this.getHandleIconStyle(),"icon")),Zl((0,F.pi)((0,F.pi)({},this.getHandleLabelStyle(n)),x),"label")),{transform:"translate(".concat(m+i,", ").concat(y+s,")"),orientation:h,showLabel:T,type:n,zIndex:3})},e.prototype.getHandleSize=function(){var n=this.attributes,r=n.handleIconSize,i=n.width,s=n.height;return r||Math.floor((this.getOrientVal([+s,+i])+4)/2.4)},e.prototype.getOrientVal=function(n){var r=(0,F.CR)(n,2),i=r[0],s=r[1],l=this.attributes.orientation;return l==="horizontal"?i:s},e.prototype.setValuesOffset=function(n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=this.attributes.type,l=(0,F.CR)(this.getValues(),2),u=l[0],h=l[1],p=s==="range"?n:0,m=[u+p,h+r].sort();i?this.setValues(m):this.innerSetValues(m,!0)},e.prototype.getRatio=function(n){var r=this.availableSpace,i=r.width,s=r.height;return n/this.getOrientVal([i,s])},e.prototype.dispatchCustomEvent=function(n,r,i){var s=this;n.on(r,function(l){l.stopPropagation(),s.dispatchEvent(new tl(i,{detail:l}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var n=this.brushArea;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(n,"pointerleave","trackMouseleave"),n.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(n){var r=this.attributes.scrollable;if(r){var i=n.deltaX,s=n.deltaY,l=s||i,u=this.getRatio(l);this.setValuesOffset(u,u,!0)}},e.tag="slider",e}(Af),MH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function PH(t,e,n){const{x:r,y:i,width:s,height:l}=t;if(e==="left")return[r+s-n,i];if(e==="right")return[r,i];if(e==="bottom")return[r,i];if(e==="top")return[r,i+l-n]}const qb=t=>{const{orientation:e,labelFormatter:n,size:r,style:i={},position:s}=t,l=MH(t,["orientation","labelFormatter","size","style","position"]);return u=>{var h;const{scales:[p],value:m,theme:y,coordinate:x}=u,{bbox:T}=m,{width:C,height:M}=T,{slider:I={}}=y,D=((h=p.getFormatter)===null||h===void 0?void 0:h.call(p))||(nt=>nt+""),U=typeof n=="string"?Lm(n):n,Z=e==="horizontal",G=gc(x)&&Z,{trackSize:W=I.trackSize}=i,[$,J]=PH(T,s,W);return new FN({className:"slider",style:Object.assign({},I,Object.assign(Object.assign({x:$,y:J,trackLength:Z?C:M,orientation:e,formatter:nt=>{const dt=U||D,Et=G?1-nt:nt,Pt=O1(p,Et,!0);return dt(Pt)},sparklineData:LH(t,u)},i),l))})}};function IH(t,e){const[n]=Array.from(t.entries()).filter(([i])=>i.type==="line"||i.type==="area").filter(([i])=>i.slider).map(([i])=>{const{encode:s,slider:l}=i;if(l!=null&&l.x){const u=h=>{const p=s[h];return[h,p?p.value:void 0]};return Object.fromEntries(e.map(u))}});if(!(n!=null&&n.series))return n==null?void 0:n.y;const r=n.series.reduce((i,s,l)=>(i[s]=i[s]||[],i[s].push(n.y[l]),i),{});return Object.values(r)}function LH(t,e){const{markState:n}=e;return Ps(t.sparklineData)?t.sparklineData:IH(n,["y","series"])}qb.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const UN=t=>qb(Object.assign(Object.assign({},t),{orientation:"horizontal"}));UN.props=Object.assign(Object.assign({},qb.props),{defaultPosition:"bottom"});const zN=t=>qb(Object.assign(Object.assign({},t),{orientation:"vertical"}));zN.props=Object.assign(Object.assign({},qb.props),{defaultPosition:"left"});var DH=function(t){(0,F.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(i){var s=r.attributes.value;if(i!==s){var l={detail:{oldValue:i,value:s}};r.dispatchEvent(new tl("scroll",l)),r.dispatchEvent(new tl("valuechange",l))}},r.onTrackClick=function(i){var s=r.attributes.slidable;if(s){var l=(0,F.CR)(r.getLocalPosition(),2),u=l[0],h=l[1],p=(0,F.CR)(r.padding,4),m=p[0],y=p[3],x=r.getOrientVal([u+y,h+m]),T=r.getOrientVal(E1(i)),C=(T-x)/r.trackLength;r.setValue(C,!0)}},r.onThumbMouseenter=function(i){r.dispatchEvent(new tl("thumbMouseenter",{detail:i.detail}))},r.onTrackMouseenter=function(i){r.dispatchEvent(new tl("trackMouseenter",{detail:i.detail}))},r.onThumbMouseleave=function(i){r.dispatchEvent(new tl("thumbMouseleave",{detail:i.detail}))},r.onTrackMouseleave=function(i){r.dispatchEvent(new tl("trackMouseleave",{detail:i.detail}))},r}return Object.defineProperty(e.prototype,"padding",{get:function(){var n=this.attributes.padding;return jf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var n=this.attributes.value,r=(0,F.CR)(this.range,2),i=r[0],s=r[1];return(0,uo.Z)(n,i,s)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLength",{get:function(){var n=this.attributes,r=n.viewportLength,i=n.trackLength,s=i===void 0?r:i;return s},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes.trackSize,r=this.trackLength,i=(0,F.CR)(this.padding,4),s=i[0],l=i[1],u=i[2],h=i[3],p=(0,F.CR)(this.getOrientVal([[r,n],[n,r]]),2),m=p[0],y=p[1];return{x:h,y:s,width:+m-(h+l),height:+y-(s+u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.trackSize;return r?i/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.thumbRadius;if(!r)return 0;var s=this.availableSpace,l=s.width,u=s.height;return i||this.getOrientVal([u,l])/2},enumerable:!1,configurable:!0}),e.prototype.getValues=function(n){n===void 0&&(n=this.value);var r=this.attributes,i=r.viewportLength,s=r.contentLength,l=i/s,u=(0,F.CR)(this.range,2),h=u[0],p=u[1],m=n*(p-h-l);return[m,m+l]},e.prototype.getValue=function(){return this.value},e.prototype.renderSlider=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.trackSize,h=r.padding,p=r.slidable,m=ia(this.attributes,"track"),y=ia(this.attributes,"thumb"),x=(0,F.pi)((0,F.pi)({x:i,y:s,brushable:!1,orientation:l,padding:h,selectionRadius:this.thumbRadius,showHandle:!1,slidable:p,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:u,values:this.getValues()},Zl(m,"track")),Zl(y,"selection"));this.slider=Ga(n).maybeAppendByClassName("scrollbar",function(){return new FN({style:x})}).update(x).node()},e.prototype.render=function(n,r){this.renderSlider(r)},e.prototype.setValue=function(n,r){r===void 0&&(r=!1);var i=this.attributes.value,s=(0,F.CR)(this.range,2),l=s[0],u=s[1];this.slider.setValues(this.getValues((0,uo.Z)(n,l,u)),r),this.onValueChange(i)},e.prototype.bindEvents=function(){var n=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),n.onTrackClick(r.detail)}),this.onHover()},e.prototype.getOrientVal=function(n){var r=this.attributes.orientation;return r==="horizontal"?n[0]:n[1]},e.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},e.tag="scrollbar",e}(Af),NH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const $b=t=>{const{orientation:e,labelFormatter:n,style:r}=t,i=NH(t,["orientation","labelFormatter","style"]);return({scales:[s],value:l,theme:u})=>{const{bbox:h}=l,{x:p,y:m,width:y,height:x}=h,{scrollbar:T={}}=u,{ratio:C,range:M}=s.getOptions(),I=e==="horizontal"?y:x,D=I/C,[U,Z]=M,G=Z>U?0:1;return new DH({className:"g2-scrollbar",style:Object.assign({},T,Object.assign(Object.assign(Object.assign(Object.assign({},r),{x:p,y:m,trackLength:I,value:G}),i),{orientation:e,contentLength:D,viewportLength:I}))})}};$b.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const jN=t=>$b(Object.assign(Object.assign({},t),{orientation:"horizontal"}));jN.props=Object.assign(Object.assign({},$b.props),{defaultPosition:"bottom"});const VN=t=>$b(Object.assign(Object.assign({},t),{orientation:"vertical"}));VN.props=Object.assign(Object.assign({},$b.props),{defaultPosition:"left"});const FC=(t,e)=>{const{coordinate:r}=e;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[x,T]=gc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],C=[{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.01},{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:x,fillOpacity:p,strokeOpacity:m,opacity:y}];return u.animate(C,Object.assign(Object.assign({},l),t))}},kH=(t,e)=>{const{coordinate:r}=e;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[x,T]=gc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],C=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:x},{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(C,Object.assign(Object.assign({},l),t))}},ZN=(t,e)=>{const{coordinate:r}=e;return Ja.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:io.NUMBER}),(i,s,l)=>{const[u]=i,h=m=>{const{__data__:y,style:x}=m,{radius:T=0,inset:C=0,fillOpacity:M=1,strokeOpacity:I=1,opacity:D=1}=x,{points:U,y:Z,y1:G}=y,W=Hi(r,U,[Z,G]),{innerRadius:$,outerRadius:J}=W,nt=kS().cornerRadius(T).padAngle(C*Math.PI/180),dt=new Zi({}),Et=Ct=>(dt.attr({d:nt(Ct)}),dm(dt)),Pt=[{scaleInYRadius:$+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:$+1e-4,fillOpacity:M,strokeOpacity:I,opacity:D,offset:.01},{scaleInYRadius:J,fillOpacity:M,strokeOpacity:I,opacity:D}],Ht=m.animate(Pt,Object.assign(Object.assign({},l),t));return Ht.onframe=function(){m.style.d=Et(Object.assign(Object.assign({},W),{outerRadius:Number(m.style.scaleInYRadius)}))},Ht.onfinish=function(){m.style.d=Et(Object.assign(Object.assign({},W),{outerRadius:J}))},Ht},p=m=>{const{style:y}=m,{transform:x="",fillOpacity:T=1,strokeOpacity:C=1,opacity:M=1}=y,[I,D]=gc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],U=[{transform:`${x} ${D}`.trimStart(),transformOrigin:I,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${x} ${D}`.trimStart(),transformOrigin:I,fillOpacity:T,strokeOpacity:C,opacity:M,offset:.01},{transform:`${x} scale(1, 1)`.trimStart(),transformOrigin:I,fillOpacity:T,strokeOpacity:C,opacity:M}];return m.animate(U,Object.assign(Object.assign({},l),t))};return Ml(r)?h(u):p(u)}},BH=(t,e)=>{const{coordinate:r}=e;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[x,T]=gc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],C=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:x},{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${T}`.trimStart(),transformOrigin:x,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(C,Object.assign(Object.assign({},l),t))}},HN=(t,e)=>{Ja.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:io.NUMBER});const{coordinate:r}=e;return(i,s,l)=>{const[u]=i;if(!Ml(r))return FC(t,e)(i,s,l);const{__data__:h,style:p}=u,{radius:m=0,inset:y=0,fillOpacity:x=1,strokeOpacity:T=1,opacity:C=1}=p,{points:M,y:I,y1:D}=h,U=kS().cornerRadius(m).padAngle(y*Math.PI/180),Z=Hi(r,M,[I,D]),{startAngle:G,endAngle:W}=Z,$=[{waveInArcAngle:G+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:G+1e-4,fillOpacity:x,strokeOpacity:T,opacity:C,offset:.01},{waveInArcAngle:W,fillOpacity:x,strokeOpacity:T,opacity:C}],J=u.animate($,Object.assign(Object.assign({},l),t));return J.onframe=function(){u.style.d=U(Object.assign(Object.assign({},Z),{endAngle:Number(u.style.waveInArcAngle)}))},J.onfinish=function(){u.style.d=U(Object.assign(Object.assign({},Z),{endAngle:W}))},J}};HN.props={};const GN=t=>(e,n,r)=>{const[i]=e,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:s,strokeOpacity:l,opacity:u}];return i.animate(h,Object.assign(Object.assign({},r),t))};GN.props={};const WN=t=>(e,n,r)=>{const[i]=e,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:s,strokeOpacity:l,opacity:u},{fillOpacity:0,strokeOpacity:0,opacity:0}];return i.animate(h,Object.assign(Object.assign({},r),t))};WN.props={};const FH=t=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.01},{transform:`${l} scale(1)`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p}];return s.animate(y,Object.assign(Object.assign({},i),t))},UH=t=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(1)`.trimStart(),transformOrigin:m},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.99},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return s.animate(y,Object.assign(Object.assign({},i),t))},XN=t=>(e,n,r)=>{var i,s;const[l]=e,u=((s=(i=l).getTotalLength)===null||s===void 0?void 0:s.call(i))||0,h=[{lineDash:[0,u]},{lineDash:[u,0]}];return l.animate(h,Object.assign(Object.assign({},r),t))};XN.props={};const zH={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},jH={[Gr.CIRCLE]:["cx","cy","r"],[Gr.ELLIPSE]:["cx","cy","rx","ry"],[Gr.RECT]:["x","y","width","height"],[Gr.IMAGE]:["x","y","width","height"],[Gr.LINE]:["x1","y1","x2","y2"],[Gr.POLYLINE]:["points"],[Gr.POLYGON]:["points"]};function Z1(t,e,n=!1){const r={};for(const i of e){const s=t.style[i];s?r[i]=s:n&&(r[i]=zH[i])}return r}const Kb=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function UC(t){const{min:e,max:n}=t.getLocalBounds(),[r,i]=e,[s,l]=n,u=l-i,h=s-r;return[r,i,h,u]}function VH(t){const[e,n,r,i]=t;return`
    M ${e} ${n}
    L ${e+r} ${n}
    L ${e+r} ${n+i}
    L ${e} ${n+i}
    Z
  `}function ZH(t,e){const[n,r,i,s]=UC(t),l=s/i,u=Math.ceil(Math.sqrt(e/l)),h=Math.ceil(e/u),p=[],m=s/h;let y=0,x=e;for(;x>0;){const T=Math.min(x,u),C=i/T;for(let M=0;M<T;M++){const I=n+M*C,D=r+y*m;p.push(VH([I,D,C,m]))}x-=T,y+=1}return p}function HH(t="pack"){return typeof t=="function"?t:ZH}function GH(t,e,n){let{transform:r}=t.style;const{transform:i}=e.style;YN(e,t);let s=Kb;if(t.nodeName===Gr.GROUP){const[h,p,m,y]=UC(t),[x,T,C,M]=UC(e),I=h-x,D=p-T,U=m/C,Z=y/M;r=`translate(${I}, ${D}) scale(${U}, ${Z})`}else s=s.concat(jH[t.nodeName]||[]);const l=[Object.assign({transform:r!=null?r:"none"},Z1(t,s,!0)),Object.assign({transform:i!=null?i:"none"},Z1(e,s,!0))];return e.animate(l,n)}function YN(t,e){t.__data__=e.__data__,t.className=e.className,t.markType=e.markType,e.parentNode.replaceChild(t,e)}function WH(t,e){const{nodeName:n}=t;if(n==="path")return t;const r=new Zi({style:Object.assign(Object.assign({},Z1(t,Kb)),{d:e})});return YN(r,t),r}function qN(t,e){const n=t.indexOf(e),r=t.lastIndexOf(e);return n===r}function XH(t){return!qN(t,"m")||!qN(t,"M")}function $N(t){const e=dm(t);if(e&&!XH(e))return e}function zC(t,e,n,r){const{nodeName:i}=e,{nodeName:s}=n,l=$N(e),u=$N(n);if(i===s&&i!=="path"||(l===void 0||u===void 0))return GH(e,n,r);const m=WH(t,l),y=[Object.assign({},Z1(e,Kb)),Object.assign({},Z1(n,Kb))];if(l!==u){y[0].d=l,y[1].d=u;const x=m.animate(y,r);return x.onfinish=()=>{const T=m.style.d;Ix(m,n),m.style.d=T,m.style.transform="none"},m.style.transform="none",x}return null}function YH(t,e,n,r){t.style.visibility="hidden";const i=r(t,e.length);return e.map((s,l)=>{const u=new Zi({style:Object.assign({d:i[l]},Z1(t,Kb))});return zC(s,u,s,n)})}function qH(t,e,n,r){const i=r(e,t.length),{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=e.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:s,strokeOpacity:l,opacity:u}],p=e.animate(h,n);return[...t.map((y,x)=>{const T=new Zi({style:{d:i[x],fill:e.style.fill}});return zC(y,y,T,n)}),p]}const KN=t=>(e,n,r)=>{const i=HH(t.split),s=Object.assign(Object.assign({},r),t),{length:l}=e,{length:u}=n;if(l===1&&u===1||l>1&&u>1){const[h]=e,[p]=n;return zC(h,h,p,s)}if(l===1&&u>1){const[h]=e;return YH(h,n,s,i)}if(l>1&&u===1){const[h]=n;return qH(e,h,s,i)}return null};KN.props={};const QN=(t,e)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Zi({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,FC(t,e)([y],r,i)};QN.props={};const JN=(t,e)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Zi({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,ZN(t,e)([y],r,i)};JN.props={};var $H=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function KH(t,{elements:e,datum:n,groupKey:r=y=>y,link:i=!1,background:s=!1,delay:l=60,scale:u,coordinate:h,emitter:p,state:m={}}){var y;const x=e(t),T=new Set(x),C=vc(x,r),M=Rb(x,n),[I,D]=oI(Object.assign({elements:x,valueof:M,link:i,coordinate:h},ho(m.active,"link"))),[U,Z,G]=sI(Object.assign({document:t.ownerDocument,scale:u,coordinate:h,background:s,valueof:M},ho(m.active,"background"))),W=ti(m,{active:Object.assign({},((y=m.active)===null||y===void 0?void 0:y.offset)&&{transform:(...Ee)=>{const oe=m.active.offset(...Ee),[,_e]=Ee;return aI(x[_e],oe,h)}})}),{setState:$,removeState:J,hasState:nt}=kv(W,M);let dt;const Et=Ee=>{const{target:oe,nativeEvent:_e=!0}=Ee;if(!T.has(oe))return;dt&&clearTimeout(dt);const hn=r(oe),Dn=C.get(hn),Kn=new Set(Dn);for(const Jn of x)Kn.has(Jn)?nt(Jn,"active")||$(Jn,"active"):($(Jn,"inactive"),D(Jn)),Jn!==oe&&Z(Jn);U(oe),I(Dn),_e&&p.emit("element:highlight",{nativeEvent:_e,data:{data:n(oe),group:Dn.map(n)}})},Pt=()=>{dt&&clearTimeout(dt),dt=setTimeout(()=>{Ht(),dt=null},l)},Ht=(Ee=!0)=>{for(const oe of x)J(oe,"active","inactive"),Z(oe),D(oe);Ee&&p.emit("element:unhighlight",{nativeEvent:Ee})},Ct=Ee=>{const{target:oe}=Ee;s&&!G(oe)||!s&&!T.has(oe)||(l>0?Pt():Ht())},Ft=()=>{Ht()};t.addEventListener("pointerover",Et),t.addEventListener("pointerout",Ct),t.addEventListener("pointerleave",Ft);const jt=Ee=>{const{nativeEvent:oe}=Ee;oe||Ht(!1)},qt=Ee=>{const{nativeEvent:oe}=Ee;if(oe)return;const{data:_e}=Ee.data,hn=AO(x,_e,n);hn&&Et({target:hn,nativeEvent:!1})};return p.on("element:highlight",qt),p.on("element:unhighlight",jt),()=>{t.removeEventListener("pointerover",Et),t.removeEventListener("pointerout",Ct),t.removeEventListener("pointerleave",Ft),p.off("element:highlight",qt),p.off("element:unhighlight",jt);for(const Ee of x)Z(Ee),D(Ee)}}function TT(t){var{delay:e,createGroup:n,background:r=!1,link:i=!1}=t,s=$H(t,["delay","createGroup","background","link"]);return(l,u,h)=>{const{container:p,view:m,options:y}=l,{scale:x,coordinate:T}=m,C=Zm(p);return KH(C,Object.assign({elements:Ug,datum:a_(m),groupKey:n?n(m):void 0,coordinate:T,scale:x,state:R1(y,[["active",r?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:r,link:i,delay:e,emitter:h},s))}}TT.props={reapplyWhenUpdate:!0};function t6(t){return TT(Object.assign(Object.assign({},t),{createGroup:wO}))}t6.props={reapplyWhenUpdate:!0};function e6(t){return TT(Object.assign(Object.assign({},t),{createGroup:iI}))}e6.props={reapplyWhenUpdate:!0};var QH=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function JH(t,{elements:e,datum:n,groupKey:r=y=>y,link:i=!1,single:s=!1,coordinate:l,background:u=!1,scale:h,emitter:p,state:m={}}){var y;const x=e(t),T=new Set(x),C=vc(x,r),M=Rb(x,n),[I,D]=oI(Object.assign({link:i,elements:x,valueof:M,coordinate:l},ho(m.selected,"link"))),[U,Z]=sI(Object.assign({document:t.ownerDocument,background:u,coordinate:l,scale:h,valueof:M},ho(m.selected,"background"))),G=ti(m,{selected:Object.assign({},((y=m.selected)===null||y===void 0?void 0:y.offset)&&{transform:(...Ft)=>{const jt=m.selected.offset(...Ft),[,qt]=Ft;return aI(x[qt],jt,l)}})}),{setState:W,removeState:$,hasState:J}=kv(G,M),nt=(Ft=!0)=>{for(const jt of x)$(jt,"selected","unselected"),D(jt),Z(jt);Ft&&p.emit("element:unselect",{nativeEvent:!0})},dt=(Ft,jt,qt=!0)=>{if(J(jt,"selected"))nt();else{const Ee=r(jt),oe=C.get(Ee),_e=new Set(oe);for(const hn of x)_e.has(hn)?W(hn,"selected"):(W(hn,"unselected"),D(hn)),hn!==jt&&Z(hn);if(I(oe),U(jt),!qt)return;p.emit("element:select",Object.assign(Object.assign({},Ft),{nativeEvent:qt,data:{data:[n(jt),...oe.map(n)]}}))}},Et=(Ft,jt,qt=!0)=>{const Ee=r(jt),oe=C.get(Ee),_e=new Set(oe);if(J(jt,"selected")){if(!x.some(Dn=>!_e.has(Dn)&&J(Dn,"selected")))return nt();for(const Dn of oe)W(Dn,"unselected"),D(Dn),Z(Dn)}else{const hn=oe.some(Dn=>J(Dn,"selected"));for(const Dn of x)_e.has(Dn)?W(Dn,"selected"):J(Dn,"selected")||W(Dn,"unselected");!hn&&i&&I(oe),U(jt)}qt&&p.emit("element:select",Object.assign(Object.assign({},Ft),{nativeEvent:qt,data:{data:x.filter(hn=>J(hn,"selected")).map(n)}}))},Pt=Ft=>{const{target:jt,nativeEvent:qt=!0}=Ft;return T.has(jt)?s?dt(Ft,jt,qt):Et(Ft,jt,qt):nt()};t.addEventListener("click",Pt);const Ht=Ft=>{const{nativeEvent:jt,data:qt}=Ft;if(jt)return;const Ee=s?qt.data.slice(0,1):qt.data;for(const oe of Ee){const _e=AO(x,oe,n);Pt({target:_e,nativeEvent:!1})}},Ct=()=>{nt(!1)};return p.on("element:select",Ht),p.on("element:unselect",Ct),()=>{for(const Ft of x)D(Ft);t.removeEventListener("click",Pt),p.off("element:select",Ht),p.off("element:unselect",Ct)}}function wT(t){var{createGroup:e,background:n=!1,link:r=!1}=t,i=QH(t,["createGroup","background","link"]);return(s,l,u)=>{const{container:h,view:p,options:m}=s,{coordinate:y,scale:x}=p,T=Zm(h);return JH(T,Object.assign({elements:Ug,datum:a_(p),groupKey:e?e(p):void 0,coordinate:y,scale:x,state:R1(m,[["selected",n?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:n,link:r,emitter:u},i))}}wT.props={reapplyWhenUpdate:!0};function n6(t){return wT(Object.assign(Object.assign({},t),{createGroup:wO}))}n6.props={reapplyWhenUpdate:!0};function r6(t){return wT(Object.assign(Object.assign({},t),{createGroup:iI}))}r6.props={reapplyWhenUpdate:!0};var y_=function(t,e,n){var r,i,s,l,u=0;n||(n={});var h=function(){u=n.leading===!1?0:Date.now(),r=null,l=t.apply(i,s),r||(i=s=null)},p=function(){var m=Date.now();!u&&n.leading===!1&&(u=m);var y=e-(m-u);return i=this,s=arguments,y<=0||y>e?(r&&(clearTimeout(r),r=null),u=m,l=t.apply(i,s),r||(i=s=null)):!r&&n.trailing!==!1&&(r=setTimeout(h,y)),l};return p.cancel=function(){clearTimeout(r),u=0,r=i=s=null},p};function tG(t){const{coordinate:e={}}=t,{transform:n=[]}=e,r=n.find(s=>s.type==="fisheye");if(r)return r;const i={type:"fisheye"};return n.push(i),e.transform=n,t.coordinate=e,i}function eG({wait:t=30,leading:e,trailing:n=!1}){return r=>{const{options:i,update:s,setState:l,container:u}=r,h=Zm(u),p=y_(m=>{const y=Cb(h,m);if(!y){l("fisheye"),s();return}l("fisheye",x=>{const T=ti({},x,{interaction:{tooltip:{preserve:!0}}});for(const D of T.marks)D.animate=!1;const[C,M]=y,I=tG(T);return I.focusX=C,I.focusY=M,I.visual=!0,T}),s()},t,{leading:e,trailing:n});return h.addEventListener("pointerenter",p),h.addEventListener("pointermove",p),h.addEventListener("pointerleave",p),()=>{h.removeEventListener("pointerenter",p),h.removeEventListener("pointermove",p),h.removeEventListener("pointerleave",p)}}}var nG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},rG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function iG(t){const{transform:e=[]}=t,n=e.find(i=>i.type==="normalizeY");if(n)return n;const r={type:"normalizeY"};return e.push(r),t.transform=e,r}function oG(t,e,n){const[r]=Array.from(t.entries()).filter(([i])=>i.type===e).map(([i])=>{const{encode:s}=i,l=u=>{const h=s[u];return[u,h?h.value:void 0]};return Object.fromEntries(n.map(l))});return r}function i6(t){var{wait:e=20,leading:n,trailing:r=!1,labelFormatter:i=l=>`${l}`}=t,s=rG(t,["wait","leading","trailing","labelFormatter"]);return l=>{const{view:u,container:h,update:p,setState:m}=l,{markState:y,scale:x,coordinate:T}=u,C=oG(y,"line",["x","y","series"]);if(!C)return;const{y:M,x:I,series:D=[]}=C,U=M.map((Ee,oe)=>oe),Z=tm(U.map(Ee=>I[Ee])),G=Zm(h),W=h.getElementsByClassName(De),$=h.getElementsByClassName(Ae),nt=vc($,Ee=>Ee.__data__.key.split("-")[0]),dt=new Ro({style:Object.assign({x1:0,y1:0,x2:0,y2:G.getAttribute("height"),stroke:"black",lineWidth:1},ho(s,"rule"))}),Et=new pa({style:Object.assign({x:0,y:G.getAttribute("height"),text:"",fontSize:10},ho(s,"label"))});dt.append(Et),G.appendChild(dt);const Pt=(Ee,oe,_e)=>{const[hn]=Ee.invert(_e),Dn=oe.invert(hn);return Z[H8(Z,Dn)]},Ht=(Ee,oe)=>{dt.setAttribute("x1",Ee[0]),dt.setAttribute("x2",Ee[0]),Et.setAttribute("text",i(oe))};let Ct;const Ft=Ee=>nG(this,void 0,void 0,function*(){const{x:oe}=x,_e=Pt(T,oe,Ee);Ht(Ee,_e),m("chartIndex",Dn=>{const Kn=ti({},Dn),Jn=Kn.marks.find(Kr=>Kr.type==="line"),ui=El(G_(U,Kr=>El(Kr,Co=>+M[Co])/Hp(Kr,Co=>+M[Co]),Kr=>D[Kr]).values()),Ki=[1/ui,ui];ti(Jn,{scale:{y:{domain:Ki}}});const Qr=iG(Jn);Qr.groupBy="color",Qr.basis=(Kr,Co)=>{const Qi=Kr[Bg(ji=>I[+ji]).center(Kr,_e)];return Co[Qi]};for(const Kr of Kn.marks)Kr.animate=!1;return Kn}),Ct=(yield p("chartIndex")).view}),jt=Ee=>{const{scale:oe,coordinate:_e}=Ct,{x:hn,y:Dn}=oe,Kn=Pt(_e,hn,Ee);Ht(Ee,Kn);for(const Jn of W){const{seriesIndex:zr,key:ui}=Jn.__data__,Ki=zr[Bg(Go=>I[+Go]).center(zr,Kn)],Qr=[0,Dn.map(1)],Kr=[0,Dn.map(M[Ki]/M[zr[0]])],[,Co]=_e.map(Qr),[,Qi]=_e.map(Kr),ji=Co-Qi;Jn.setAttribute("transform",`translate(0, ${ji})`);const _o=nt.get(ui)||[];for(const Go of _o)Go.setAttribute("dy",ji)}},qt=y_(Ee=>{const oe=Cb(G,Ee);oe&&jt(oe)},e,{leading:n,trailing:r});return Ft([0,0]),G.addEventListener("pointerenter",qt),G.addEventListener("pointermove",qt),G.addEventListener("pointerleave",qt),()=>{dt.remove(),G.removeEventListener("pointerenter",qt),G.removeEventListener("pointermove",qt),G.removeEventListener("pointerleave",qt)}}}i6.props={reapplyWhenUpdate:!0};function Qb(t,e){let n,r=-1,i=-1;if(e===void 0)for(const s of t)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of t)(s=e(s,++i,t))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function Jb(t,e){let n=0,r=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function o6(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}function aG(t,e){return!t||!e?t:t.replace(/\\?\{([^{}]+)\}/g,function(n,r){return n.charAt(0)==="\\"?n.slice(1):e[r]===void 0?"":e[r]})}var sG=aG,a6=function(t,e){if(e==null){t.innerHTML="";return}t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,(0,F.ev)([],(0,F.CR)(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach(function(n){return t.appendChild(n)}):t.appendChild(e))};function jC(t){return t===void 0&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var s6={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function lG(t){var e;t===void 0&&(t="");var n=jC(t);return e={},e[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=(0,F.pi)({flex:1},s6),e[".".concat(n.VALUE)]=(0,F.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},s6),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var cG=function(t){(0,F.ZT)(e,t);function e(n){var r=this,i,s,l=(s=(i=n.style)===null||i===void 0?void 0:i.template)===null||s===void 0?void 0:s.prefixCls,u=jC(l);return r=t.call(this,n,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(u.NAME,`">
          <span class="`).concat(u.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(u.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(u.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:lG(l)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var n=this.element.offsetWidth,r=this.element.offsetHeight;return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var n=this.attributes,r=n.data,i=n.template;return r.map(function(s,l){var u=s.name,h=u===void 0?"":u,p=s.color,m=p===void 0?"black":p,y=s.index,x=(0,F._T)(s,["name","color","index"]),T=(0,F.pi)({name:h,color:m,index:y!=null?y:l},x);return o6(sG(i.item,T))})},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var n;(n=this.element)===null||n===void 0||n.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(n,r){var i=this;if(n!==void 0&&r!==void 0){var s=this.element.style.visibility==="hidden",l=function(){i.attributes.x=n!=null?n:i.attributes.x,i.attributes.y=r!=null?r:i.attributes.y,i.updatePosition()};s?this.closeTransition(l):l()}this.element.style.visibility="visible"},e.prototype.hide=function(n,r){n===void 0&&(n=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(n,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var n=this.attributes.template;this.element=o6(n.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var n=this.attributes.content;n&&(typeof n=="string"?this.element.innerHTML=n:a6(this.element,n))}},e.prototype.renderHTMLTooltipElement=function(){var n,r,i=this.attributes,s=i.template,l=i.title,u=i.enterable,h=i.style,p=i.content,m=jC(s.prefixCls),y=this.element;if(this.element.style.pointerEvents=u?"auto":"none",p)this.renderCustomContent();else{l?(y.innerHTML=s.title,y.getElementsByClassName(m.TITLE)[0].innerHTML=l):(r=(n=y.getElementsByClassName(m.TITLE))===null||n===void 0?void 0:n[0])===null||r===void 0||r.remove();var x=this.HTMLTooltipItemsElements,T=document.createElement("ul");T.className=m.LIST,a6(T,x);var C=this.element.querySelector(".".concat(m.LIST));C?C.replaceWith(T):y.appendChild(T)}hf(y,h)},e.prototype.getRelativeOffsetFromCursor=function(n){var r=this.attributes,i=r.position,s=r.offset,l=n||i,u=l.split("-"),h={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},p=this.elementSize,m=p.width,y=p.height,x=[-m/2,-y/2];return u.forEach(function(T){var C=(0,F.CR)(x,2),M=C[0],I=C[1],D=(0,F.CR)(h[T],2),U=D[0],Z=D[1];x=[M+(m/2+s[0])*U,I+(y/2+s[1])*Z]}),x},e.prototype.setOffsetPosition=function(n){var r=(0,F.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=u===void 0?0:u,p=l.y,m=p===void 0?0:p,y=l.container,x=y.x,T=y.y;this.element.style.left="".concat(+h+x+i,"px"),this.element.style.top="".concat(+m+T+s,"px")},e.prototype.updatePosition=function(){var n=this.attributes.showDelay,r=n===void 0?60:n,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(n){var r=(0,F.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=l.y,p=l.bounding,m=l.position;if(!p)return[i,s];var y=this.element,x=y.offsetWidth,T=y.offsetHeight,C=(0,F.CR)([+u+i,+h+s],2),M=C[0],I=C[1],D={left:"right",right:"left",top:"bottom",bottom:"top"},U=p.x,Z=p.y,G=p.width,W=p.height,$={left:M<U,right:M+x>U+G,top:I<Z,bottom:I+T>Z+W},J=[];m.split("-").forEach(function(dt){$[dt]?J.push(D[dt]):J.push(dt)});var nt=J.join("-");return this.getRelativeOffsetFromCursor(nt)},e.prototype.isCursorEntered=function(n,r){if(this.element){var i=this.element.getBoundingClientRect(),s=i.x,l=i.y,u=i.width,h=i.height;return new yc(s,l,u,h).isPointIn(n,r)}return!1},e.prototype.closeTransition=function(n){var r=this,i=this.element.style.transition;this.element.style.transition="none",n(),setTimeout(function(){r.element.style.transition=i},10)},e.tag="tooltip",e}(Af),__=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function AT(t,e){return e?typeof e=="string"?document.querySelector(e):e:t.ownerDocument.defaultView.getContextService().getDomElement().parentElement}function uG(t){const e=t.getRenderBounds(),{min:[n,r],max:[i,s]}=e;return{x:n,y:r,width:i-n,height:s-r}}function fG(t,e){const n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:n.x-r.x,y:n.y-r.y}}function hG(t,e,n,r,i,s,l,u={},h=[10,10]){const p={".g2-tooltip":{},".g2-tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},m=new cG({className:"tooltip",style:{x:e,y:n,container:l,data:[],bounding:s,position:r,enterable:i,title:"",offset:h,template:{prefixCls:"g2-"},style:ti(p,u)}});return t.appendChild(m.HTMLTooltipElement),m}function l6({root:t,data:e,x:n,y:r,render:i,event:s,single:l,position:u="right-bottom",enterable:h=!1,css:p,mount:m,bounding:y,offset:x}){const T=AT(t,m),C=AT(t),M=l?C:t,I=y||uG(t),D=fG(C,T),{tooltipElement:U=hG(T,n,r,u,h,I,D,p,x)}=M,{items:Z,title:G=""}=e;U.update(Object.assign({x:n,y:r,data:Z,title:G,position:u,enterable:h},i!==void 0&&{content:i(s,{items:Z,title:G})})),M.tooltipElement=U}function Yg({root:t,single:e,emitter:n,nativeEvent:r=!0,event:i=null}){r&&n.emit("tooltip:hide",{nativeEvent:r});const s=AT(t),l=e?s:t,{tooltipElement:u}=l;u&&u.hide(i==null?void 0:i.clientX,i==null?void 0:i.clientY),d6(t),p6(t),m6(t)}function VC({root:t,single:e}){const n=AT(t),r=e?n:t;if(!r)return;const{tooltipElement:i}=r;i&&(i.destroy(),r.tooltipElement=void 0),d6(t),p6(t),m6(t)}function c6(t){const{value:e}=t;return Object.assign(Object.assign({},t),{value:e===void 0?"undefined":e})}function dG(t){const{__data__:e}=t,{title:n,items:r=[]}=e,i=r.filter(Ql).map(s=>{var{color:l=u6(t)}=s,u=__(s,["color"]);return Object.assign(Object.assign({},u),{color:l})}).map(c6);return Object.assign(Object.assign({},n&&{title:n}),{items:i})}function pG(t,e){const{color:n,series:r,facet:i=!1}=t,{color:s,series:l}=e,u=h=>h&&h.invert&&!(h instanceof Gg)&&!(h instanceof r_);if(u(r))return r.clone().invert(l);if(l&&r instanceof Gg&&r.invert(l)!==s&&!i)return r.invert(l);if(u(n)){const h=n.invert(s);return Array.isArray(h)?null:h}return null}function u6(t){const e=t.getAttribute("fill"),n=t.getAttribute("stroke"),{__data__:r}=t,{color:i=e&&e!=="transparent"?e:n}=r;return i}function f6(t,e=n=>n){const n=new Map(t.map(r=>[e(r),r]));return Array.from(n.values())}function h6(t,e,n,r=t.map(s=>s.__data__),i={}){const s=h=>h instanceof Date?+h:h,l=f6(r.map(h=>h.title),s).filter(Ql),u=r.flatMap((h,p)=>{const m=t[p],{items:y=[],title:x}=h,T=y.filter(Ql),C=n!==void 0?n:y.length<=1;return T.map(M=>{var{color:I=u6(m)||i.color,name:D}=M,U=__(M,["color","name"]);const Z=pG(e,h),G=C?Z||D:D||Z;return Object.assign(Object.assign({},U),{color:I,name:G||x})})}).map(c6);return Object.assign(Object.assign({},l.length>0&&{title:l.join(",")}),{items:f6(u,h=>`(${s(h.name)}, ${s(h.value)}, ${s(h.color)})`)})}function mG(t,e,n,r){var{plotWidth:i,plotHeight:s,mainWidth:l,mainHeight:u,startX:h,startY:p,transposed:m,polar:y,insetLeft:x,insetTop:T}=r,C=__(r,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const M=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},C),I=($,J,nt)=>{const dt=new Ir({style:Object.assign({cx:$,cy:J,r:nt},M)});return t.appendChild(dt),dt},D=($,J,nt,dt)=>{const Et=new Ro({style:Object.assign({x1:$,x2:J,y1:nt,y2:dt},M)});return t.appendChild(Et),Et},Z=(($,J)=>{if(J.length===1)return J[0];const nt=J.map(Et=>Tt(Et,$)),dt=Qb(nt,Et=>Et);return J[dt]})(n,e),G=()=>m?[h+Z[0],h+Z[0],p,p+s]:[h,h+i,Z[1]+p,Z[1]+p],W=()=>{const $=h+x+l/2,J=p+T+u/2,nt=Tt([$,J],Z);return[$,J,nt]};if(y){const[$,J,nt]=W(),dt=t.ruleX||I($,J,nt);dt.style.cx=$,dt.style.cy=J,dt.style.r=nt,t.ruleX=dt}else{const[$,J,nt,dt]=G(),Et=t.ruleX||D($,J,nt,dt);Et.style.x1=$,Et.style.x2=J,Et.style.y1=nt,Et.style.y2=dt,t.ruleX=Et}}function vG(t,e,n){var{plotWidth:r,plotHeight:i,mainWidth:s,mainHeight:l,startX:u,startY:h,transposed:p,polar:m,insetLeft:y,insetTop:x}=n,T=__(n,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const C=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},T),M=e.map(dt=>dt[1]),I=e.map(dt=>dt[0]),D=Jb(M),U=Jb(I),Z=()=>{if(m){const dt=Math.min(s,l)/2,Et=u+y+s/2,Pt=h+x+l/2,Ht=se(st([U,D],[Et,Pt])),Ct=Et+dt*Math.cos(Ht),Ft=Pt+dt*Math.sin(Ht);return[Et,Ct,Pt,Ft]}return p?[u,u+r,D+h,D+h]:[U+u,U+u,h,h+i]},[G,W,$,J]=Z(),nt=()=>{const dt=new Ro({style:Object.assign({x1:G,x2:W,y1:$,y2:J},C)});return t.appendChild(dt),dt};if(I.length>0){const dt=t.ruleY||nt();dt.style.x1=G,dt.style.x2=W,dt.style.y1=$,dt.style.y2=J,t.ruleY=dt}}function d6(t){t.ruleY&&(t.ruleY.remove(),t.ruleY=void 0)}function p6(t){t.ruleX&&(t.ruleX.remove(),t.ruleX=void 0)}function gG(t,{data:e,style:n,theme:r}){t.markers&&t.markers.forEach(l=>l.remove());const{type:i=""}=n,s=e.filter(l=>{const[{x:u,y:h}]=l;return Ql(u)&&Ql(h)}).map(l=>{const[{color:u,element:h},p]=l,m=u||h.style.fill||h.style.stroke||r.color,y=i==="hollow"?"transparent":m,x=i==="hollow"?m:"#fff";return new Ir({className:"g2-tooltip-marker",style:Object.assign({cx:p[0],cy:p[1],fill:y,r:4,stroke:x,lineWidth:2},n)})});for(const l of s)t.appendChild(l);t.markers=s}function m6(t){t.markers&&(t.markers.forEach(e=>e.remove()),t.markers=[])}function v6(t,e){return Array.from(t.values()).some(n=>{var r;return(r=n.interaction)===null||r===void 0?void 0:r[e]})}function Fv(t,e){return t===void 0?e:t}function g6(t){const{title:e,items:n}=t;return n.length===0&&e===void 0}function yG(t){return Array.from(t.values()).some(e=>{var n;return((n=e.interaction)===null||n===void 0?void 0:n.seriesTooltip)&&e.tooltip})}function y6(t,e){var{elements:n,sort:r,filter:i,scale:s,coordinate:l,crosshairs:u,crosshairsX:h,crosshairsY:p,render:m,groupName:y,emitter:x,wait:T=50,leading:C=!0,trailing:M=!1,startX:I=0,startY:D=0,body:U=!0,single:Z=!0,position:G,enterable:W,mount:$,bounding:J,theme:nt,offset:dt,disableNative:Et=!1,marker:Pt=!0,preserve:Ht=!1,style:Ct={},css:Ft={}}=e,jt=__(e,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css"]);const qt=n(t),Ee=gc(l),oe=Ml(l),_e=ti(Ct,jt),{innerWidth:hn,innerHeight:Dn,width:Kn,height:Jn,insetLeft:zr,insetTop:ui}=l.getOptions(),Ki=[],Qr=[];for(const Jo of qt){const{__data__:Xa}=Jo,{seriesX:Rs,title:Ds,items:bc}=Xa;Rs?Ki.push(Jo):(Ds||bc)&&Qr.push(Jo)}const Kr=Jo=>Jo.markType==="interval",Co=Qr.length&&Qr.every(Kr)&&!Ml(l),Qi=Jo=>Jo.__data__.x,_o=!!s.x.getBandWidth&&Qr.length>0;Ki.sort((Jo,Xa)=>{const Rs=Ee?0:1,Ds=bc=>bc.getBounds().min[Rs];return Ee?Ds(Xa)-Ds(Jo):Ds(Jo)-Ds(Xa)});const Go=Jo=>{const Xa=Ee?1:0,{min:Rs,max:Ds}=Jo.getLocalBounds();return tm([Rs[Xa],Ds[Xa]])};Co?qt.sort((Jo,Xa)=>Qi(Jo)-Qi(Xa)):Qr.sort((Jo,Xa)=>{const[Rs,Ds]=Go(Jo),[bc,nf]=Go(Xa),rf=(Rs+Ds)/2,Bh=(bc+nf)/2;return Ee?Bh-rf:rf-Bh});const na=new Map(Ki.map(Jo=>{const{__data__:Xa}=Jo,{seriesX:Rs}=Xa,Ds=Rs.map((nf,rf)=>rf),bc=tm(Ds,nf=>Rs[+nf]);return[Jo,[bc,Rs]]})),{x:wa}=s,js=wa!=null&&wa.getBandWidth?wa.getBandWidth()/2:0,ba=Jo=>{const[Xa]=l.invert(Jo);return Xa-js},ss=(Jo,Xa,Rs,Ds)=>{const{_x:bc}=Jo,nf=bc!==void 0?wa.map(bc):ba(Xa),rf=Ds.filter(Ql),[Bh,M0]=tm([rf[0],rf[rf.length-1]]),am=Bh===M0;if(!_o&&(nf<Bh||nf>M0)&&!am)return null;const ox=Bg(Gv=>Ds[+Gv]).center,I2=ox(Rs,nf);return Rs[I2]},Tl=Co?(Jo,Xa)=>{const Rs=Bg(Qi).center,Ds=Rs(Xa,ba(Jo)),bc=Xa[Ds];return vc(Xa,Qi).get(Qi(bc))}:(Jo,Xa)=>{const Ds=Jo[Ee?1:0],bc=Xa.filter(Bh=>{const[M0,am]=Go(Bh);return Ds>=M0&&Ds<=am});if(!_o||bc.length>0)return bc;const nf=Bg(Bh=>{const[M0,am]=Go(Bh);return(M0+am)/2}).center,rf=nf(Xa,Ds);return[Xa[rf]].filter(Ql)},Ou=(Jo,Xa)=>{const{__data__:Rs}=Jo;return Object.fromEntries(Object.entries(Rs).filter(([Ds])=>Ds.startsWith("series")&&Ds!=="series").map(([Ds,bc])=>{const nf=bc[Xa];return[Mx(Ds.replace("series","")),nf]}))},Wf=y_(Jo=>{var Xa;const Rs=Cb(t,Jo);if(!Rs)return;const Ds=rI(t),bc=Ds.min[0],nf=Ds.min[1],rf=[Rs[0]-I,Rs[1]-D];if(!rf)return;const Bh=Tl(rf,Qr),M0=[],am=[];for(const mf of Ki){const[D2,NM]=na.get(mf),N2=ss(Jo,rf,D2,NM);if(N2!==null){M0.push(mf);const ww=Ou(mf,N2),{x:yet,y:_et}=ww,xet=l.map([(yet||0)+js,_et||0]);am.push([Object.assign(Object.assign({},ww),{element:mf}),xet])}}const ox=Array.from(new Set(am.map(mf=>mf[0].x))),I2=ox[Qb(ox,mf=>Math.abs(mf-ba(rf)))],Gv=am.filter(mf=>mf[0].x===I2),LM=[...Gv.map(mf=>mf[0]),...Bh.map(mf=>mf.__data__)],Tw=[...M0,...Bh],L2=h6(Tw,s,y,LM,nt);if(r&&L2.items.sort((mf,D2)=>r(mf)-r(D2)),i&&(L2.items=L2.items.filter(i)),Tw.length===0||g6(L2)){Hc(Jo);return}if(U&&l6({root:t,data:L2,x:Rs[0]+bc,y:Rs[1]+nf,render:m,event:Jo,single:Z,position:G,enterable:W,mount:$,bounding:J,css:Ft,offset:dt}),u||h||p){const mf=ho(_e,"crosshairs"),D2=Object.assign(Object.assign({},mf),ho(_e,"crosshairsX")),NM=Object.assign(Object.assign({},mf),ho(_e,"crosshairsY")),N2=Gv.map(ww=>ww[1]);h&&mG(t,N2,Rs,Object.assign(Object.assign({},D2),{plotWidth:hn,plotHeight:Dn,mainWidth:Kn,mainHeight:Jn,insetLeft:zr,insetTop:ui,startX:I,startY:D,transposed:Ee,polar:oe})),p&&vG(t,N2,Object.assign(Object.assign({},NM),{plotWidth:hn,plotHeight:Dn,mainWidth:Kn,mainHeight:Jn,insetLeft:zr,insetTop:ui,startX:I,startY:D,transposed:Ee,polar:oe}))}if(Pt){const mf=ho(_e,"marker");gG(t,{data:Gv,style:mf,theme:nt})}const DM=(Xa=Gv[0])===null||Xa===void 0?void 0:Xa[0].x,get=DM!=null?DM:ba(rf);x.emit("tooltip:show",Object.assign(Object.assign({},Jo),{nativeEvent:!0,data:{data:{x:O1(s.x,get,!0)}}}))},T,{leading:C,trailing:M}),Hc=Jo=>{Yg({root:t,single:Z,emitter:x,event:Jo})},ph=()=>{VC({root:t,single:Z})},Cu=Jo=>{var Xa,{nativeEvent:Rs,data:Ds,offsetX:bc,offsetY:nf}=Jo,rf=__(Jo,["nativeEvent","data","offsetX","offsetY"]);if(Rs)return;const Bh=(Xa=Ds==null?void 0:Ds.data)===null||Xa===void 0?void 0:Xa.x,am=s.x.map(Bh),[ox,I2]=l.map([am,.5]),Gv=t.getRenderBounds(),LM=Gv.min[0],Tw=Gv.min[1];Wf(Object.assign(Object.assign({},rf),{offsetX:bc!==void 0?bc:LM+ox,offsetY:nf!==void 0?nf:Tw+I2,_x:Bh}))},Fd=()=>{Yg({root:t,single:Z,emitter:x,nativeEvent:!1})},xc=()=>{Rf(),ph()},Pc=()=>{kh()},kh=()=>{Et||(t.addEventListener("pointerenter",Wf),t.addEventListener("pointermove",Wf),t.addEventListener("pointerleave",Jo=>{Cb(t,Jo)||Hc(Jo)}))},Rf=()=>{Et||(t.removeEventListener("pointerenter",Wf),t.removeEventListener("pointermove",Wf),t.removeEventListener("pointerleave",Hc))};return kh(),x.on("tooltip:show",Cu),x.on("tooltip:hide",Fd),x.on("tooltip:disable",xc),x.on("tooltip:enable",Pc),()=>{Rf(),x.off("tooltip:show",Cu),x.off("tooltip:hide",Fd),x.off("tooltip:disable",xc),x.off("tooltip:enable",Pc),Ht?Yg({root:t,single:Z,emitter:x,nativeEvent:!1}):ph()}}function _G(t,{elements:e,coordinate:n,scale:r,render:i,groupName:s,sort:l,filter:u,emitter:h,wait:p=50,leading:m=!0,trailing:y=!1,groupKey:x=Pt=>Pt,single:T=!0,position:C,enterable:M,datum:I,view:D,mount:U,bounding:Z,theme:G,offset:W,shared:$=!1,body:J=!0,disableNative:nt=!1,preserve:dt=!1,css:Et={}}){var Pt,Ht;const Ct=e(t),Ft=vc(Ct,x),jt=ji=>ji.markType==="interval",qt=Ct.every(jt)&&!Ml(n),Ee=r.x,oe=r.series,_e=(Ht=(Pt=Ee==null?void 0:Ee.getBandWidth)===null||Pt===void 0?void 0:Pt.call(Ee))!==null&&Ht!==void 0?Ht:0,hn=oe?ji=>ji.__data__.x+ji.__data__.series*_e:ji=>ji.__data__.x+_e/2;qt&&Ct.sort((ji,_o)=>hn(ji)-hn(_o));const Dn=ji=>{const{target:_o}=ji;return jS(_o,Go=>Go.classList?Go.classList.includes("element"):!1)},Kn=qt?ji=>{const _o=Cb(t,ji);if(!_o)return;const[Go]=n.invert(_o),na=Go,wa=Bg(hn).center,js=wa(Ct,na),ba=Ct[js];return!$&&Ct.find(Tl=>Tl!==ba&&hn(Tl)===hn(ba))?Dn(ji):ba}:Dn,Jn=y_(ji=>{const _o=Kn(ji);if(!_o){Yg({root:t,single:T,emitter:h,event:ji});return}const Go=x(_o),na=Ft.get(Go);if(!na)return;const wa=na.length===1&&!$?dG(na[0]):h6(na,r,s,void 0,G);if(l&&wa.items.sort((ss,Tl)=>l(ss)-l(Tl)),u&&(wa.items=wa.items.filter(u)),g6(wa)){Yg({root:t,single:T,emitter:h,event:ji});return}const{offsetX:js,offsetY:ba}=ji;J&&l6({root:t,data:wa,x:js,y:ba,render:i,event:ji,single:T,position:C,enterable:M,mount:U,bounding:Z,css:Et,offset:W}),h.emit("tooltip:show",Object.assign(Object.assign({},ji),{nativeEvent:!0,data:{data:cI(_o,D)}}))},p,{leading:m,trailing:y}),zr=ji=>{Yg({root:t,single:T,emitter:h,event:ji})},ui=()=>{nt||(t.addEventListener("pointermove",Jn),t.addEventListener("pointerleave",zr))},Ki=()=>{nt||(t.removeEventListener("pointermove",Jn),t.removeEventListener("pointerleave",zr))},Qr=({nativeEvent:ji,offsetX:_o,offsetY:Go,data:na})=>{if(ji)return;const{data:wa}=na,js=AO(Ct,wa,I);if(!js)return;const ba=js.getBBox(),{x:ss,y:Tl,width:Ou,height:Wf}=ba,Hc=t.getBBox();Jn({target:js,offsetX:_o!==void 0?_o+Hc.x:ss+Ou/2,offsetY:Go!==void 0?Go+Hc.y:Tl+Wf/2})},Kr=({nativeEvent:ji}={})=>{ji||Yg({root:t,single:T,emitter:h,nativeEvent:!1})},Co=()=>{Ki(),VC({root:t,single:T})},Qi=()=>{ui()};return h.on("tooltip:show",Qr),h.on("tooltip:hide",Kr),h.on("tooltip:enable",Qi),h.on("tooltip:disable",Co),ui(),()=>{Ki(),h.off("tooltip:show",Qr),h.off("tooltip:hide",Kr),dt?Yg({root:t,single:T,emitter:h,nativeEvent:!1}):VC({root:t,single:T})}}function _6(t){const{shared:e,crosshairs:n,crosshairsX:r,crosshairsY:i,series:s,name:l,item:u=()=>({}),facet:h=!1}=t,p=__(t,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(m,y,x)=>{const{container:T,view:C}=m,{scale:M,markState:I,coordinate:D,theme:U}=C,Z=v6(I,"seriesTooltip"),G=v6(I,"crosshairs"),W=Zm(T),$=Fv(s,Z),J=Fv(n,G);if($&&yG(I)&&!h)return y6(W,Object.assign(Object.assign({},p),{theme:U,elements:Ug,scale:M,coordinate:D,crosshairs:J,crosshairsX:Fv(Fv(r,n),!1),crosshairsY:Fv(i,J),item:u,emitter:x}));if($&&h){const nt=y.filter(Ft=>Ft!==m&&Ft.options.parentKey===m.options.key),dt=nI(m,y),Et=nt[0].view.scale,Pt=W.getBounds(),Ht=Pt.min[0],Ct=Pt.min[1];return Object.assign(Et,{facet:!0}),y6(W.parentNode.parentNode,Object.assign(Object.assign({},p),{theme:U,elements:()=>dt,scale:Et,coordinate:D,crosshairs:Fv(n,G),crosshairsX:Fv(Fv(r,n),!1),crosshairsY:Fv(i,J),item:u,startX:Ht,startY:Ct,emitter:x}))}return _G(W,Object.assign(Object.assign({},p),{datum:a_(C),elements:Ug,scale:M,coordinate:D,groupKey:e?wO(C):void 0,item:u,emitter:x,view:C,theme:U,shared:e}))}}_6.props={reapplyWhenUpdate:!0};var OT=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};const x6="legend-category",xG="legend-continuous",bG="items-item",EG="legend-category-item-marker",SG="legend-category-item-label";function b6(t){return t.getElementsByClassName(EG)[0]}function E6(t){return t.getElementsByClassName(SG)[0]}function S6(t){return t.getElementsByClassName(bG)}function ZC(t){return t.getElementsByClassName(x6)}function T6(t){return t.getElementsByClassName(xG)}function TG(t,e){[...ZC(t),...T6(t)].forEach(r=>{e(r,i=>i)})}function HC(t){let e=t.parentNode;for(;e&&!e.__data__;)e=e.parentNode;return e.__data__}function Vet(t){let e=t;for(;e&&!e.attr("class").startsWith("legend");)e=e.children[0];return e.attributes}function wG(t,{legends:e,marker:n,label:r,datum:i,filter:s,emitter:l,channel:u,state:h={}}){const p=new Map,m=new Map,y=new Map,{unselected:x={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=h,T={unselected:ho(x,"marker")},C={unselected:ho(x,"label")},{setState:M,removeState:I}=kv(T,void 0),{setState:D,removeState:U}=kv(C,void 0),Z=Array.from(e(t));let G=Z.map(i);const W=()=>{for(const nt of Z){const dt=i(nt),Et=n(nt),Pt=r(nt);G.includes(dt)?(I(Et,"unselected"),U(Pt,"unselected")):(M(Et,"unselected"),D(Pt,"unselected"))}};for(const nt of Z){const dt=()=>{zg(t,"pointer")},Et=()=>{s7(t)},Pt=Ht=>OT(this,void 0,void 0,function*(){const Ct=i(nt),Ft=G.indexOf(Ct);Ft===-1?G.push(Ct):G.splice(Ft,1),yield s(G),W();const{nativeEvent:jt=!0}=Ht;jt&&(G.length===Z.length?l.emit("legend:reset",{nativeEvent:jt}):l.emit("legend:filter",Object.assign(Object.assign({},Ht),{nativeEvent:jt,data:{channel:u,values:G}})))});nt.addEventListener("click",Pt),nt.addEventListener("pointerenter",dt),nt.addEventListener("pointerout",Et),p.set(nt,Pt),m.set(nt,dt),y.set(nt,Et)}const $=nt=>OT(this,void 0,void 0,function*(){const{nativeEvent:dt}=nt;if(dt)return;const{data:Et}=nt,{channel:Pt,values:Ht}=Et;Pt===u&&(G=Ht,yield s(G),W())}),J=nt=>OT(this,void 0,void 0,function*(){const{nativeEvent:dt}=nt;dt||(G=Z.map(i),yield s(G),W())});return l.on("legend:filter",$),l.on("legend:reset",J),()=>{for(const nt of Z)nt.removeEventListener("click",p.get(nt)),nt.removeEventListener("pointerenter",m.get(nt)),nt.removeEventListener("pointerout",y.get(nt)),l.off("legend:filter",$),l.off("legend:reset",J)}}function AG(t,{legend:e,filter:n,emitter:r,channel:i}){const s=({detail:{value:l}})=>{n(l),r.emit({nativeEvent:!0,data:{channel:i,values:l}})};return e.addEventListener("valuechange",s),()=>{e.removeEventListener("valuechange",s)}}function w6(t,{legend:e,channel:n,value:r,ordinal:i,channels:s,allChannels:l,facet:u=!1}){return OT(this,void 0,void 0,function*(){const{view:h,update:p,setState:m}=t;m(e,y=>{const{marks:x}=y,T=x.map(C=>{if(C.type==="legends")return C;const{transform:M=[]}=C,I=M.findIndex(({type:Z})=>Z.startsWith("group")||Z.startsWith("bin")),D=[...M];D.splice(I+1,0,{type:"filter",[n]:{value:r,ordinal:i}});const U=Object.fromEntries(s.map(Z=>[Z,{domain:h.scale[Z].getOptions().domain}]));return ti({},C,Object.assign(Object.assign({transform:D,scale:U},!i&&{animate:!1}),{legend:u?!1:Object.fromEntries(l.map(Z=>[Z,{preserve:!0}]))}))});return Object.assign(Object.assign({},y),{marks:T})}),yield p()})}function OG(t,e){for(const n of t)w6(n,Object.assign(Object.assign({},e),{facet:!0}))}function CG(){return(t,e,n)=>{const{container:r}=t,i=e.filter(y=>y!==t),s=i.length>0,l=y=>HC(y).scales.map(x=>x.name),u=[...ZC(r),...T6(r)],h=u.flatMap(l),p=s?y_(OG,50,{trailing:!0}):y_(w6,50,{trailing:!0}),m=u.map(y=>{const{name:x,domain:T}=HC(y).scales[0],C=l(y),M={legend:y,channel:x,channels:C,allChannels:h};return y.className===x6?wG(r,{legends:S6,marker:b6,label:E6,datum:I=>{const{__data__:D}=I,{index:U}=D;return T[U]},filter:I=>{const D=Object.assign(Object.assign({},M),{value:I,ordinal:!0});p(s?i:t,D)},state:y.attributes.state,channel:x,emitter:n}):AG(r,{legend:y,filter:I=>{const D=Object.assign(Object.assign({},M),{value:I,ordinal:!1});p(s?i:t,D)},emitter:n,channel:x})});return()=>{m.forEach(y=>y())}}}function RG(){return(t,e,n)=>{const{container:r,view:i,options:s}=t,l=ZC(r),u=Ug(r),h=T=>HC(T).scales[0].name,p=T=>{const{scale:{[T]:C}}=i;return C},m=R1(s,["active","inactive"]),y=Rb(u,a_(i)),x=[];for(const T of l){const C=hn=>{const{data:Dn}=T.attributes,{__data__:Kn}=hn,{index:Jn}=Kn;return Dn[Jn].label},M=h(T),I=S6(T),D=p(M),U=vc(u,hn=>D.invert(hn.__data__[M])),{state:Z={}}=T.attributes,{inactive:G={}}=Z,{setState:W,removeState:$}=kv(m,y),J={inactive:ho(G,"marker")},nt={inactive:ho(G,"label")},{setState:dt,removeState:Et}=kv(J),{setState:Pt,removeState:Ht}=kv(nt),Ct=hn=>{for(const Dn of I){const Kn=b6(Dn),Jn=E6(Dn);Dn===hn||hn===null?(Et(Kn,"inactive"),Ht(Jn,"inactive")):(dt(Kn,"inactive"),Pt(Jn,"inactive"))}},Ft=(hn,Dn)=>{const Kn=C(Dn),Jn=new Set(U.get(Kn));for(const ui of u)Jn.has(ui)?W(ui,"active"):W(ui,"inactive");Ct(Dn);const{nativeEvent:zr=!0}=hn;zr&&n.emit("legend:highlight",Object.assign(Object.assign({},hn),{nativeEvent:zr,data:{channel:M,value:Kn}}))},jt=new Map;for(const hn of I){const Dn=Kn=>{Ft(Kn,hn)};hn.addEventListener("pointerover",Dn),jt.set(hn,Dn)}const qt=hn=>{for(const Kn of u)$(Kn,"inactive","active");Ct(null);const{nativeEvent:Dn=!0}=hn;Dn&&n.emit("legend:unhighlight",{nativeEvent:Dn})},Ee=hn=>{const{nativeEvent:Dn,data:Kn}=hn;if(Dn)return;const{channel:Jn,value:zr}=Kn;if(Jn!==M)return;const ui=I.find(Ki=>C(Ki)===zr);ui&&Ft({nativeEvent:!1},ui)},oe=hn=>{const{nativeEvent:Dn}=hn;Dn||qt({nativeEvent:!1})};T.addEventListener("pointerleave",qt),n.on("legend:highlight",Ee),n.on("legend:unhighlight",oe);const _e=()=>{T.removeEventListener(qt),n.off("legend:highlight",Ee),n.off("legend:unhighlight",oe);for(const[hn,Dn]of jt)hn.removeEventListener(Dn)};x.push(_e)}return()=>x.forEach(T=>T())}}var A0=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function MG(t,e){const[n,r,i,s]=t,[l,u,h,p]=e;return!(l>i||h<n||u>s||p<r)}function PG(t,e,n,r,i){const[s,l,u,h]=i;return[Math.max(s,Math.min(t,n)),Math.max(l,Math.min(e,r)),Math.min(u,Math.max(t,n)),Math.min(h,Math.max(e,r))]}function IG(t){const{width:e,height:n}=t.getBBox();return[0,0,e,n]}function Uv(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}const A6=df(t=>{const e=t.attributes,{x:n,y:r,width:i,height:s,class:l,renders:u={},handleSize:h=10,document:p}=e,m=A0(e,["x","y","width","height","class","renders","handleSize","document"]);if(!p||i===void 0||s===void 0||n===void 0||r===void 0)return;const y=h/2,x=(zr,ui,Ki)=>{zr.handle||(zr.handle=Ki.createElement("rect"),zr.append(zr.handle));const{handle:Qr}=zr;return Qr.attr(ui),Qr},T=ho(Lx(m,"handleNW","handleNE"),"handleN"),{render:C=x}=T,M=A0(T,["render"]),I=ho(m,"handleE"),{render:D=x}=I,U=A0(I,["render"]),Z=ho(Lx(m,"handleSE","handleSW"),"handleS"),{render:G=x}=Z,W=A0(Z,["render"]),$=ho(m,"handleW"),{render:J=x}=$,nt=A0($,["render"]),dt=ho(m,"handleNW"),{render:Et=x}=dt,Pt=A0(dt,["render"]),Ht=ho(m,"handleNE"),{render:Ct=x}=Ht,Ft=A0(Ht,["render"]),jt=ho(m,"handleSE"),{render:qt=x}=jt,Ee=A0(jt,["render"]),oe=ho(m,"handleSW"),{render:_e=x}=oe,hn=A0(oe,["render"]),Dn=(zr,ui)=>{const{id:Ki}=zr,Qr=ui(zr,zr.attributes,p);Qr.id=Ki,Qr.style.draggable=!0},Kn=zr=>()=>{const ui=df(Ki=>Dn(Ki,zr));return new ui({})},Jn=Ra(t).attr("className",l).style("transform",`translate(${n}, ${r})`).style("draggable",!0);Jn.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(Uv,Object.assign(Object.assign({width:i,height:s},Lx(m,"handle")),{transform:void 0})),Jn.maybeAppend("handle-n",Kn(C)).style("x",y).style("y",-y).style("width",i-h).style("height",h).style("fill","transparent").call(Uv,M),Jn.maybeAppend("handle-e",Kn(D)).style("x",i-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(Uv,U),Jn.maybeAppend("handle-s",Kn(G)).style("x",y).style("y",s-y).style("width",i-h).style("height",h).style("fill","transparent").call(Uv,W),Jn.maybeAppend("handle-w",Kn(J)).style("x",-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(Uv,nt),Jn.maybeAppend("handle-nw",Kn(Et)).style("x",-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(Uv,Pt),Jn.maybeAppend("handle-ne",Kn(Ct)).style("x",i-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(Uv,Ft),Jn.maybeAppend("handle-se",Kn(qt)).style("x",i-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(Uv,Ee),Jn.maybeAppend("handle-sw",Kn(_e)).style("x",-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(Uv,hn)});function GC(t,e){var{brushed:n=()=>{},brushended:r=()=>{},brushcreated:i=()=>{},brushstarted:s=()=>{},brushupdated:l=()=>{},extent:u=IG(t),brushRegion:h=(Qr,Kr,Co,Qi,ji)=>[Qr,Kr,Co,Qi],reverse:p=!1,fill:m="#777",fillOpacity:y="0.3",stroke:x="#fff",selectedHandles:T=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=e,C=A0(e,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let M=null,I=null,D=null,U=null,Z=null,G=!1;const[W,$,J,nt]=u;zg(t,"crosshair"),t.style.draggable=!0;const dt=(Qr,Kr,Co)=>{if(s(Co),U&&U.remove(),Z&&Z.remove(),M=[Qr,Kr],p)return Et();Pt()},Et=()=>{Z=new Zi({style:Object.assign(Object.assign({},C),{fill:m,fillOpacity:y,stroke:x,pointerEvents:"none"})}),U=new A6({style:{x:0,y:0,width:0,height:0,draggable:!0,document:t.ownerDocument},className:"mask"}),t.appendChild(Z),t.appendChild(U)},Pt=()=>{U=new A6({style:Object.assign(Object.assign({document:t.ownerDocument,x:0,y:0},C),{fill:m,fillOpacity:y,stroke:x,draggable:!0}),className:"mask"}),t.appendChild(U)},Ht=(Qr=!0)=>{U&&U.remove(),Z&&Z.remove(),M=null,I=null,D=null,G=!1,U=null,Z=null,r(Qr)},Ct=(Qr,Kr,Co=!0)=>{const[Qi,ji,_o,Go]=PG(Qr[0],Qr[1],Kr[0],Kr[1],u),[na,wa,js,ba]=h(Qi,ji,_o,Go,u);return p?jt(na,wa,js,ba):Ft(na,wa,js,ba),n(na,wa,js,ba,Co),[na,wa,js,ba]},Ft=(Qr,Kr,Co,Qi)=>{U.style.x=Qr,U.style.y=Kr,U.style.width=Co-Qr,U.style.height=Qi-Kr},jt=(Qr,Kr,Co,Qi)=>{Z.style.d=`
      M${W},${$}L${J},${$}L${J},${nt}L${W},${nt}Z
      M${Qr},${Kr}L${Qr},${Qi}L${Co},${Qi}L${Co},${Kr}Z
    `,U.style.x=Qr,U.style.y=Kr,U.style.width=Co-Qr,U.style.height=Qi-Kr},qt=Qr=>{const Kr=(wa,js,ba,ss,Tl)=>wa+js<ss?ss-js:wa+ba>Tl?Tl-ba:wa,Co=Qr[0]-D[0],Qi=Qr[1]-D[1],ji=Kr(Co,M[0],I[0],W,J),_o=Kr(Qi,M[1],I[1],$,nt),Go=[M[0]+ji,M[1]+_o],na=[I[0]+ji,I[1]+_o];Ct(Go,na)},Ee={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},oe=Qr=>hn(Qr)||_e(Qr),_e=Qr=>{const{id:Kr}=Qr;return T.indexOf(Kr)===-1?!1:new Set(Object.keys(Ee)).has(Kr)},hn=Qr=>Qr===U.getElementById("selection"),Dn=Qr=>{const{target:Kr}=Qr,[Co,Qi]=TO(t,Qr);if(!U||!oe(Kr)){dt(Co,Qi,Qr),G=!0;return}oe(Kr)&&(D=[Co,Qi])},Kn=Qr=>{const{target:Kr}=Qr,Co=TO(t,Qr);if(!M)return;if(!D)return Ct(M,Co);if(hn(Kr))return qt(Co);const[Qi,ji]=[Co[0]-D[0],Co[1]-D[1]],{id:_o}=Kr;if(Ee[_o]){const[Go,na,wa,js]=Ee[_o].vector;return Ct([M[0]+Qi*Go,M[1]+ji*na],[I[0]+Qi*wa,I[1]+ji*js])}},Jn=Qr=>{if(D){D=null;const{x:_o,y:Go,width:na,height:wa}=U.style;M=[_o,Go],I=[_o+na,Go+wa],l(_o,Go,_o+na,Go+wa,Qr);return}I=TO(t,Qr);const[Kr,Co,Qi,ji]=Ct(M,I);G=!1,i(Kr,Co,Qi,ji,Qr)},zr=Qr=>{const{target:Kr}=Qr;U&&!oe(Kr)&&Ht()},ui=Qr=>{const{target:Kr}=Qr;!U||!oe(Kr)||G?zg(t,"crosshair"):hn(Kr)?zg(t,"move"):_e(Kr)&&zg(t,Ee[Kr.id].cursor)},Ki=()=>{zg(t,"default")};return t.addEventListener("dragstart",Dn),t.addEventListener("drag",Kn),t.addEventListener("dragend",Jn),t.addEventListener("click",zr),t.addEventListener("pointermove",ui),t.addEventListener("pointerleave",Ki),{mask:U,move(Qr,Kr,Co,Qi,ji=!0){U||dt(Qr,Kr,{}),M=[Qr,Kr],I=[Co,Qi],Ct([Qr,Kr],[Co,Qi],ji)},remove(Qr=!0){U&&Ht(Qr)},destroy(){U&&Ht(!1),zg(t,"default"),t.removeEventListener("dragstart",Dn),t.removeEventListener("drag",Kn),t.removeEventListener("dragend",Jn),t.removeEventListener("click",zr),t.removeEventListener("pointermove",ui),t.removeEventListener("pointerleave",Ki)}}}function WC(t,e,n){return e.filter(r=>{if(r===t)return!1;const{interaction:i={}}=r.options;return Object.values(i).find(s=>s.brushKey===n)})}function LG(t,e,n){return WC(t,e,n).map(r=>Zm(r.container))}function DG(t,e,n){return WC(t,e,n).map(r=>r.options)}function O6(t,e){var{elements:n,selectedHandles:r,siblings:i=Kn=>[],datum:s,brushRegion:l,extent:u,reverse:h,scale:p,coordinate:m,series:y=!1,key:x=Kn=>Kn,bboxOf:T=Kn=>{const{x:Jn,y:zr,width:ui,height:Ki}=Kn.style;return{x:Jn,y:zr,width:ui,height:Ki}},state:C={},emitter:M}=e,I=A0(e,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const D=n(t),U=i(t),Z=U.flatMap(n),G=Rb(D,s),W=ho(I,"mask"),{setState:$,removeState:J}=kv(C,G),nt=new Map,{width:dt,height:Et,x:Pt=0,y:Ht=0}=T(t),Ct=u||[0,0,dt,Et],Ft=()=>{for(const Kn of[...D,...Z])J(Kn,"active","inactive")},jt=(Kn,Jn,zr,ui)=>{var Ki;for(const Kr of U)(Ki=Kr.brush)===null||Ki===void 0||Ki.remove();const Qr=new Set;for(const Kr of D){const{min:Co,max:Qi}=Kr.getLocalBounds(),[ji,_o]=Co,[Go,na]=Qi;MG([ji,_o,Go,na],[Kn,Jn,zr,ui])?($(Kr,"active"),Qr.add(x(Kr))):$(Kr,"inactive")}for(const Kr of Z)Qr.has(x(Kr))?$(Kr,"active"):$(Kr,"inactive")},qt=()=>{for(const Kn of D)J(Kn,"inactive");for(const Kn of nt.values())Kn.remove();nt.clear()},Ee=(Kn,Jn,zr,ui)=>{const Ki=Kr=>{const Co=Kr.cloneNode();return Co.__data__=Kr.__data__,Kr.parentNode.appendChild(Co),nt.set(Kr,Co),Co},Qr=new vo({style:{x:Kn+Pt,y:Jn+Ht,width:zr-Kn,height:ui-Jn}});t.appendChild(Qr);for(const Kr of D){const Co=nt.get(Kr)||Ki(Kr);Co.style.clipPath=Qr,$(Kr,"inactive"),$(Co,"active")}},oe=GC(t,Object.assign(Object.assign({},W),{extent:Ct,brushRegion:l,reverse:h,selectedHandles:r,brushended:Kn=>{const Jn=y?qt:Ft;Kn&&M.emit("brush:remove",{nativeEvent:!0}),Jn()},brushed:(Kn,Jn,zr,ui,Ki)=>{const Qr=IS(Kn,Jn,zr,ui,p,m);Ki&&M.emit("brush:highlight",{nativeEvent:!0,data:{selection:Qr}}),(y?Ee:jt)(Kn,Jn,zr,ui)},brushcreated:(Kn,Jn,zr,ui,Ki)=>{const Qr=IS(Kn,Jn,zr,ui,p,m);M.emit("brush:end",Object.assign(Object.assign({},Ki),{nativeEvent:!0,data:{selection:Qr}}))},brushupdated:(Kn,Jn,zr,ui,Ki)=>{const Qr=IS(Kn,Jn,zr,ui,p,m);M.emit("brush:end",Object.assign(Object.assign({},Ki),{nativeEvent:!0,data:{selection:Qr}}))},brushstarted:Kn=>{M.emit("brush:start",Kn)}})),_e=({nativeEvent:Kn,data:Jn})=>{if(Kn)return;const{selection:zr}=Jn,[ui,Ki,Qr,Kr]=X8(zr,p,m);oe.move(ui,Ki,Qr,Kr,!1)};M.on("brush:highlight",_e);const hn=({nativeEvent:Kn}={})=>{Kn||oe.remove(!1)};M.on("brush:remove",hn);const Dn=oe.destroy.bind(oe);return oe.destroy=()=>{M.off("brush:highlight",_e),M.off("brush:remove",hn),Dn()},oe}function XC(t){var{facet:e,brushKey:n}=t,r=A0(t,["facet","brushKey"]);return(i,s,l)=>{const{container:u,view:h,options:p}=i,m=Zm(u),y={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},x=["active",["inactive",{opacity:.5}]],{scale:T,coordinate:C}=h;if(e){const I=m.getBounds(),D=I.min[0],U=I.min[1],Z=I.max[0],G=I.max[1];return O6(m.parentNode.parentNode,Object.assign(Object.assign({elements:()=>nI(i,s),datum:a_(SO(i,s).map(W=>W.view)),brushRegion:(W,$,J,nt)=>[W,$,J,nt],extent:[D,U,Z,G],state:R1(SO(i,s).map(W=>W.options),x),emitter:l,scale:T,coordinate:C,selectedHandles:void 0},y),r))}const M=O6(m,Object.assign(Object.assign({elements:Ug,key:I=>I.__data__.key,siblings:()=>LG(i,s,n),datum:a_([h,...WC(i,s,n).map(I=>I.view)]),brushRegion:(I,D,U,Z)=>[I,D,U,Z],extent:void 0,state:R1([p,...DG(i,s,n)],x),emitter:l,scale:T,coordinate:C,selectedHandles:void 0},y),r));return m.brush=M,()=>M.destroy()}}function YC(t,e,n,r,i){const[,s,,l]=i;return[t,s,n,l]}function NG(t){return XC(Object.assign(Object.assign({},t),{brushRegion:YC,selectedHandles:["handle-e","handle-w"]}))}function qC(t,e,n,r,i){const[s,,l]=i;return[s,e,l,r]}function kG(t){return XC(Object.assign(Object.assign({},t),{brushRegion:qC,selectedHandles:["handle-n","handle-s"]}))}var $C=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const BG="axis",FG="axis-line",UG="axis-main-group",C6="axis-hot-area";function zG(t){return t.getElementsByClassName(BG)}function R6(t){return t.getElementsByClassName(FG)[0]}function jG(t){return t.getElementsByClassName(UG)[0]}function M6(t){return jG(t).getLocalBounds()}function VG(t,e){var{cross:n,offsetX:r,offsetY:i}=e,s=$C(e,["cross","offsetX","offsetY"]);const l=M6(t),u=R6(t),[h]=u.getLocalBounds().min,[p,m]=l.min,[y,x]=l.max,T=(y-p)*2;return{brushRegion:qC,hotZone:new vo({className:C6,style:Object.assign({width:n?T/2:T,transform:`translate(${(n?p:h-T/2).toFixed(2)}, ${m})`,height:x-m},s)}),extent:n?(C,M,I,D)=>[-1/0,M,1/0,D]:(C,M,I,D)=>[Math.floor(p-r),M,Math.ceil(y-r),D]}}function ZG(t,e){var{offsetY:n,offsetX:r,cross:i=!1}=e,s=$C(e,["offsetY","offsetX","cross"]);const l=M6(t),u=R6(t),[,h]=u.getLocalBounds().min,[p,m]=l.min,[y,x]=l.max,T=x-m;return{brushRegion:YC,hotZone:new vo({className:C6,style:Object.assign({width:y-p,height:i?T:T*2,transform:`translate(${p}, ${i?m:h-T})`},s)}),extent:i?(C,M,I,D)=>[C,-1/0,I,1/0]:(C,M,I,D)=>[C,Math.floor(m-n),I,Math.ceil(x-n)]}}function HG(t,e){var{axes:n,elements:r,points:i,horizontal:s,datum:l,offsetY:u,offsetX:h,reverse:p=!1,state:m={},emitter:y,coordinate:x}=e,T=$C(e,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const C=r(t),M=n(t),I=Rb(C,l),{setState:D,removeState:U}=kv(m,I),Z=new Map,G=ho(T,"mask"),W=_e=>Array.from(Z.values()).every(([hn,Dn,Kn,Jn])=>_e.some(([zr,ui])=>zr>=hn&&zr<=Kn&&ui>=Dn&&ui<=Jn)),$=M.map(_e=>_e.attributes.scale),J=_e=>_e.length>2?[_e[0],_e[_e.length-1]]:_e,nt=new Map,dt=()=>{nt.clear();for(let _e=0;_e<M.length;_e++){const hn=$[_e],{domain:Dn}=hn.getOptions();nt.set(_e,J(Dn))}};dt();const Et=(_e,hn)=>{const Dn=[];for(const Jn of C){const zr=i(Jn);W(zr)?(D(Jn,"active"),Dn.push(Jn)):D(Jn,"inactive")}if(nt.set(_e,Ht(Dn,_e)),!hn)return;const Kn=()=>{if(!Ct)return Array.from(nt.values());const Jn=[];for(const[zr,ui]of nt){const Ki=$[zr],{name:Qr}=Ki.getOptions();Qr==="x"?Jn[0]=ui:Jn[1]=ui}return Jn};y.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:Kn()}})},Pt=_e=>{for(const hn of C)U(hn,"active","inactive");dt(),_e&&y.emit("brushAxis:remove",{nativeEvent:!0})},Ht=(_e,hn)=>{const Dn=$[hn],{name:Kn}=Dn.getOptions(),Jn=_e.map(zr=>{const ui=zr.__data__;return Dn.invert(ui[Kn])});return J(Fg(Dn,Jn))},Ct=M.some(s)&&M.some(_e=>!s(_e)),Ft=[];for(let _e=0;_e<M.length;_e++){const hn=M[_e],Dn=s(hn)?ZG:VG,{hotZone:Kn,brushRegion:Jn,extent:zr}=Dn(hn,{offsetY:u,offsetX:h,cross:Ct,zIndex:999,fill:"transparent"});hn.parentNode.appendChild(Kn);const ui=GC(Kn,Object.assign(Object.assign({},G),{reverse:p,brushRegion:Jn,brushended(Ki){Z.delete(hn),Array.from(Z.entries()).length===0?Pt(Ki):Et(_e,Ki)},brushed(Ki,Qr,Kr,Co,Qi){Z.set(hn,zr(Ki,Qr,Kr,Co)),Et(_e,Qi)}}));Ft.push(ui)}const jt=(_e={})=>{const{nativeEvent:hn}=_e;hn||Ft.forEach(Dn=>Dn.remove(!1))},qt=(_e,hn,Dn)=>{const[Kn,Jn]=_e,zr=Qr=>Qr.getStep?Qr.getStep():0,ui=Ee(Kn,hn,Dn),Ki=Ee(Jn,hn,Dn)+zr(hn);return s(Dn)?[ui,-1/0,Ki,1/0]:[-1/0,ui,1/0,Ki]},Ee=(_e,hn,Dn)=>{const{height:Kn,width:Jn}=x.getOptions(),zr=hn.clone();return s(Dn)?zr.update({range:[0,Jn]}):zr.update({range:[Kn,0]}),zr.map(_e)},oe=_e=>{const{nativeEvent:hn}=_e;if(hn)return;const{selection:Dn}=_e.data;for(let Kn=0;Kn<Ft.length;Kn++){const Jn=Dn[Kn],zr=Ft[Kn],ui=M[Kn];if(Jn){const Ki=$[Kn];zr.move(...qt(Jn,Ki,ui),!1)}else zr.remove(!1)}};return y.on("brushAxis:remove",jt),y.on("brushAxis:highlight",oe),()=>{Ft.forEach(_e=>_e.destroy()),y.off("brushAxis:remove",jt),y.off("brushAxis:highlight",oe)}}function GG(t){return(e,n,r)=>{const{container:i,view:s,options:l}=e,u=Zm(i),{x:h,y:p}=u.getBBox(),{coordinate:m}=s;return HG(i,Object.assign({elements:Ug,axes:zG,offsetY:p,offsetX:h,points:y=>y.__data__.points,horizontal:y=>{const{startPos:[x,T],endPos:[C,M]}=y.attributes;return x!==C&&T===M},datum:a_(s),state:R1(l,["active",["inactive",{opacity:.5}]]),coordinate:m,emitter:r},t))}}var WG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},P6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function XG(t=300){let e=null;return n=>{const{timeStamp:r}=n;return e!==null&&r-e<t?(e=r,!0):(e=r,!1)}}function YG(t,e){var{filter:n,reset:r,brushRegion:i,extent:s,reverse:l,emitter:u,scale:h,coordinate:p,selection:m,series:y=!1}=e,x=P6(e,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const T=ho(x,"mask"),{width:C,height:M}=t.getBBox(),I=s||[0,0,C,M],D=XG(),U=GC(t,Object.assign(Object.assign({},T),{extent:I,brushRegion:i,reverse:l,brushcreated:Z}));t.addEventListener("click",G);function Z($,J,nt,dt,Et){Et.nativeEvent=!0,n(m($,J,nt,dt),Et),U.remove()}function G($){D($)&&($.nativeEvent=!0,r($))}const W=({nativeEvent:$,data:J})=>{if($)return;const{selection:nt}=J;n(nt,{nativeEvent:!1})};return u.on("brush:filter",W),()=>{U.destroy(),u.off("brush:filter",W),t.removeEventListener("click",G)}}function KC(t){var{hideX:e=!0,hideY:n=!0}=t,r=P6(t,["hideX","hideY"]);return(i,s,l)=>{const{container:u,view:h,options:p,update:m,setState:y}=i,x=Zm(u),T={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let C=!1,M=!1,I=h;const{scale:D,coordinate:U}=h;return YG(x,Object.assign(Object.assign({brushRegion:(Z,G,W,$)=>[Z,G,W,$],selection:(Z,G,W,$)=>{const{scale:J,coordinate:nt}=I;return IS(Z,G,W,$,J,nt)},filter:(Z,G)=>WG(this,void 0,void 0,function*(){if(M)return;M=!0;const[W,$]=Z;y("brushFilter",nt=>{const{marks:dt}=nt,Et=dt.map(Pt=>ti({axis:Object.assign(Object.assign({},e&&{x:{transform:[{type:"hide"}]}}),n&&{y:{transform:[{type:"hide"}]}})},Pt,{scale:{x:{domain:W,nice:!1},y:{domain:$,nice:!1}}}));return Object.assign(Object.assign({},p),{marks:Et,clip:!0})}),l.emit("brush:filter",Object.assign(Object.assign({},G),{data:{selection:[W,$]}})),I=(yield m()).view,M=!1,C=!0}),reset:Z=>{if(M||!C)return;const{scale:G}=h,{x:W,y:$}=G,J=W.getOptions().domain,nt=$.getOptions().domain;l.emit("brush:filter",Object.assign(Object.assign({},Z),{data:{selection:[J,nt]}})),C=!1,I=h,y("brushFilter"),m()},extent:void 0,emitter:l,scale:D,coordinate:U},T),r))}}function qG(t){return KC(Object.assign(Object.assign({hideX:!0},t),{brushRegion:YC}))}function $G(t){return KC(Object.assign(Object.assign({hideY:!0},t),{brushRegion:qC}))}var KG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};const QG="slider";function JG(t,e,n,r=!1,i="x",s="y"){const{marks:l}=t,u=l.map(h=>{var p,m;return ti({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},h,{scale:e,[n]:Object.assign(Object.assign({},((p=h[n])===null||p===void 0?void 0:p[i])&&{[i]:Object.assign({preserve:!0},r&&{ratio:null})}),((m=h[n])===null||m===void 0?void 0:m[s])&&{[s]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},t),{marks:u,clip:!0,animate:!1})}function tW(t,e,n){const[r,i]=t,s=n?h=>1-h:h=>h,l=O1(e,s(r),!0),u=O1(e,s(i),!1);return Fg(e,[l,u])}function CT(t){return[t[0],t[t.length-1]]}function I6({initDomain:t={},className:e=QG,prefix:n="slider",setValue:r=(p,m)=>p.setValues(m),hasState:i=!1,wait:s=50,leading:l=!0,trailing:u=!1,getInitValues:h=p=>{var m;const y=(m=p==null?void 0:p.attributes)===null||m===void 0?void 0:m.values;if(y[0]!==0||y[1]!==1)return y}}){return(p,m,y)=>{const{container:x,view:T,update:C,setState:M}=p,I=x.getElementsByClassName(e);if(!I.length)return()=>{};let D=!1;const{scale:U,coordinate:Z,layout:G}=T,{paddingLeft:W,paddingTop:$,paddingBottom:J,paddingRight:nt}=G,{x:dt,y:Et}=U,Pt=gc(Z),Ht=qt=>{const Ee=qt==="vertical"?"y":"x",oe=qt==="vertical"?"x":"y";return Pt?[oe,Ee]:[Ee,oe]},Ct=new Map,Ft=new Set,jt={x:t.x||dt.getOptions().domain,y:t.y||Et.getOptions().domain};for(const qt of I){const{orientation:Ee}=qt.attributes,[oe,_e]=Ht(Ee),hn=`${n}${Sv(oe)}:filter`,Dn=oe==="x",{ratio:Kn}=dt.getOptions(),{ratio:Jn}=Et.getOptions(),zr=Kr=>{if(Kr.data){const{selection:Go}=Kr.data,[na=CT(jt.x),wa=CT(jt.y)]=Go;return Dn?[Fg(dt,na,Kn),Fg(Et,wa,Jn)]:[Fg(Et,wa,Jn),Fg(dt,na,Kn)]}const{value:Co}=Kr.detail,Qi=U[oe],ji=tW(Co,Qi,Pt&&Ee==="horizontal"),_o=jt[_e];return[ji,_o]},ui=y_(Kr=>KG(this,void 0,void 0,function*(){const{initValue:Co=!1}=Kr;if(D&&!Co)return;D=!0;const{nativeEvent:Qi=!0}=Kr,[ji,_o]=zr(Kr);if(jt[oe]=ji,jt[_e]=_o,Qi){const Go=Dn?ji:_o,na=Dn?_o:ji;y.emit(hn,Object.assign(Object.assign({},Kr),{nativeEvent:Qi,data:{selection:[CT(Go),CT(na)]}}))}M(qt,Go=>Object.assign(Object.assign({},JG(Go,{[oe]:{domain:ji,nice:!1}},n,i,oe,_e)),{paddingLeft:W,paddingTop:$,paddingBottom:J,paddingRight:nt})),yield C(),D=!1}),s,{leading:l,trailing:u}),Ki=Kr=>{const{nativeEvent:Co}=Kr;if(Co)return;const{data:Qi}=Kr,{selection:ji}=Qi,[_o,Go]=ji;qt.dispatchEvent(new tl("valuechange",{data:Qi,nativeEvent:!1}));const na=Dn?LS(_o,dt):LS(Go,Et);r(qt,na)};y.on(hn,Ki),qt.addEventListener("valuechange",ui),Ct.set(qt,ui),Ft.add([hn,Ki]);const Qr=h(qt);Qr&&qt.dispatchEvent(new tl("valuechange",{detail:{value:Qr},nativeEvent:!1,initValue:!0}))}return()=>{for(const[qt,Ee]of Ct)qt.removeEventListener("valuechange",Ee);for(const[qt,Ee]of Ft)y.off(qt,Ee)}}}const L6="g2-scrollbar";function eW(t={}){return(e,n,r)=>{const{view:i,container:s}=e;if(!s.getElementsByClassName(L6).length)return()=>{};const{scale:u}=i,{x:h,y:p}=u,m={x:[...h.getOptions().domain],y:[...p.getOptions().domain]};return h.update({domain:h.getOptions().expectedDomain}),p.update({domain:p.getOptions().expectedDomain}),I6(Object.assign(Object.assign({},t),{initDomain:m,className:L6,prefix:"scrollbar",hasState:!0,setValue:(x,T)=>x.setValue(T[0]),getInitValues:x=>{const T=x.slider.attributes.values;if(T[0]!==0)return T}}))(e,n,r)}}var nW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function rW(t,e,n){return`<${t} style="${Object.entries(n).map(([r,i])=>`${Dh(r)}:${i}`).join(";")}">${e}</${t}>`}const iW={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function D6(t){return t.nodeName!=="text"?!1:!!t.isOverflowing()}function N6(t){var{offsetX:e=8,offsetY:n=8}=t,r=nW(t,["offsetX","offsetY"]);return i=>{const{container:s}=i,[l,u]=s.getBounds().min,h=ho(r,"tip"),p=new Set,m=x=>{const{target:T}=x;if(!D6(T)){x.stopPropagation();return}const{offsetX:C,offsetY:M}=x,I=C+e-l,D=M+n-u;if(T.tip){T.tip.style.x=I,T.tip.style.y=D;return}const{text:U}=T.style,Z=new To({className:"poptip",style:{innerHTML:rW("div",U,Object.assign(Object.assign({},iW),h)),x:I,y:D}});s.appendChild(Z),T.tip=Z,p.add(Z)},y=x=>{const{target:T}=x;if(!D6(T)){x.stopPropagation();return}T.tip&&(T.tip.remove(),T.tip=null,p.delete(T.tip))};return s.addEventListener("pointerover",m),s.addEventListener("pointerout",y),()=>{s.removeEventListener("pointerover",m),s.removeEventListener("pointerout",y),p.forEach(x=>x.remove())}}}N6.props={reapplyWhenUpdate:!0};function oW(t,e){var n=QO(e),r=n.length;if((0,tr.Z)(t))return!r;for(var i=0;i<r;i+=1){var s=n[i];if(e[s]!==t[s]||!(s in t))return!1}return!0}var aW=oW;function sW(t,e){if(!Ps(t))return null;var n;if(Ih(e)&&(n=e),y0(e)&&(n=function(i){return aW(i,e)}),n){for(var r=0;r<t.length;r+=1)if(n(t[r]))return t[r]}return null}var H1=sW;function RT(t){return t==null?null:k6(t)}function k6(t){if(typeof t!="function")throw new Error;return t}var lW={depth:-1},B6={},QC={};function cW(t){return t.id}function uW(t){return t.parentId}function JC(){var t=cW,e=uW,n;function r(i){var s=Array.from(i),l=t,u=e,h,p,m,y,x,T,C,M,I=new Map;if(n!=null){var D=s.map(function(nt,dt){return fW(n(nt,dt,i))}),U=D.map(F6),Z=new Set(D).add(""),G=YO(U),W;try{for(G.s();!(W=G.n()).done;){var $=W.value;Z.has($)||(Z.add($),D.push($),U.push(F6($)),s.push(QC))}}catch(nt){G.e(nt)}finally{G.f()}l=function(dt,Et){return D[Et]},u=function(dt,Et){return U[Et]}}for(m=0,h=s.length;m<h;++m)p=s[m],T=s[m]=new F1(p),(C=l(p,m,i))!=null&&(C+="")&&(M=T.id=C,I.set(M,I.has(M)?B6:T)),(C=u(p,m,i))!=null&&(C+="")&&(T.parent=C);for(m=0;m<h;++m)if(T=s[m],C=T.parent){if(x=I.get(C),!x)throw new Error("missing: "+C);if(x===B6)throw new Error("ambiguous: "+C);x.children?x.children.push(T):x.children=[T],T.parent=x}else{if(y)throw new Error("multiple roots");y=T}if(!y)throw new Error("no root");if(n!=null){for(;y.data===QC&&y.children.length===1;)y=y.children[0],--h;for(var J=s.length-1;J>=0&&(T=s[J],T.data===QC);--J)T.data=null}if(y.parent=lW,y.eachBefore(function(nt){nt.depth=nt.parent.depth+1,--h}).eachBefore($5),y.parent=null,h>0)throw new Error("cycle");return y}return r.id=function(i){return arguments.length?(t=RT(i),r):t},r.parentId=function(i){return arguments.length?(e=RT(i),r):e},r.path=function(i){return arguments.length?(n=RT(i),r):n},r}function fW(t){t="".concat(t);var e=t.length;return tR(t,e-1)&&!tR(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:"/".concat(t)}function F6(t){var e=t.length;if(e<2)return"";for(;--e>1&&!tR(t,e););return t.slice(0,e)}function tR(t,e){if(t[e]==="/"){for(var n=0;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}function hW(t,e,n,r,i){var s=t.children,l,u=s.length,h,p=new Array(u+1);for(p[0]=h=l=0;l<u;++l)p[l+1]=h+=s[l].value;m(0,u,t.value,e,n,r,i);function m(y,x,T,C,M,I,D){if(y>=x-1){var U=s[y];U.x0=C,U.y0=M,U.x1=I,U.y1=D;return}for(var Z=p[y],G=T/2+Z,W=y+1,$=x-1;W<$;){var J=W+$>>>1;p[J]<G?W=J+1:$=J}G-p[W-1]<p[W]-G&&y+1<W&&--W;var nt=p[W]-Z,dt=T-nt;if(I-C>D-M){var Et=T?(C*dt+I*nt)/T:I;m(y,W,nt,C,M,Et,D),m(W,x,dt,Et,M,I,D)}else{var Pt=T?(M*dt+D*nt)/T:D;m(y,W,nt,C,M,I,Pt),m(W,x,dt,C,Pt,I,D)}}}function MT(t,e,n,r,i){for(var s=t.children,l,u=-1,h=s.length,p=t.value&&(i-n)/t.value;++u<h;)l=s[u],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*p}function dW(t,e,n,r,i){(t.depth&1?MT:Nb)(t,e,n,r,i)}var U6=(1+Math.sqrt(5))/2;function z6(t,e,n,r,i,s){for(var l=[],u=e.children,h,p,m=0,y=0,x=u.length,T,C,M=e.value,I,D,U,Z,G,W,$;m<x;){T=i-n,C=s-r;do I=u[y++].value;while(!I&&y<x);for(D=U=I,W=Math.max(C/T,T/C)/(M*t),$=I*I*W,G=Math.max(U/$,$/D);y<x;++y){if(I+=p=u[y].value,p<D&&(D=p),p>U&&(U=p),$=I*I*W,Z=Math.max(U/$,$/D),Z>G){I-=p;break}G=Z}l.push(h={value:I,dice:T<C,children:u.slice(m,y)}),h.dice?Nb(h,n,r,i,M?r+=C*I/M:s):MT(h,n,r,M?n+=T*I/M:i,s),M-=I,m=y}return l}var j6=function t(e){function n(r,i,s,l,u){z6(e,r,i,s,l,u)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(U6),pW=function t(e){function n(r,i,s,l,u){if((h=r._squarify)&&h.ratio===e)for(var h,p,m,y,x=-1,T,C=h.length,M=r.value;++x<C;){for(p=h[x],m=p.children,y=p.value=0,T=m.length;y<T;++y)p.value+=m[y].value;p.dice?Nb(p,i,s,l,M?s+=(u-s)*p.value/M:u):MT(p,i,s,M?i+=(l-i)*p.value/M:l,u),M-=p.value}else r._squarify=h=z6(e,r,i,s,l,u),h.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(U6);function x_(){return 0}function G1(t){return function(){return t}}function mW(){var t=j6,e=!1,n=1,r=1,i=[0],s=x_,l=x_,u=x_,h=x_,p=x_;function m(x){return x.x0=x.y0=0,x.x1=n,x.y1=r,x.eachBefore(y),i=[0],e&&x.eachBefore(X5),x}function y(x){var T=i[x.depth],C=x.x0+T,M=x.y0+T,I=x.x1-T,D=x.y1-T;I<C&&(C=I=(C+I)/2),D<M&&(M=D=(M+D)/2),x.x0=C,x.y0=M,x.x1=I,x.y1=D,x.children&&(T=i[x.depth+1]=s(x)/2,C+=p(x)-T,M+=l(x)-T,I-=u(x)-T,D-=h(x)-T,I<C&&(C=I=(C+I)/2),D<M&&(M=D=(M+D)/2),t(x,C,M,I,D))}return m.round=function(x){return arguments.length?(e=!!x,m):e},m.size=function(x){return arguments.length?(n=+x[0],r=+x[1],m):[n,r]},m.tile=function(x){return arguments.length?(t=k6(x),m):t},m.padding=function(x){return arguments.length?m.paddingInner(x).paddingOuter(x):m.paddingInner()},m.paddingInner=function(x){return arguments.length?(s=typeof x=="function"?x:G1(+x),m):s},m.paddingOuter=function(x){return arguments.length?m.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x):m.paddingTop()},m.paddingTop=function(x){return arguments.length?(l=typeof x=="function"?x:G1(+x),m):l},m.paddingRight=function(x){return arguments.length?(u=typeof x=="function"?x:G1(+x),m):u},m.paddingBottom=function(x){return arguments.length?(h=typeof x=="function"?x:G1(+x),m):h},m.paddingLeft=function(x){return arguments.length?(p=typeof x=="function"?x:G1(+x),m):p},m}function vW(t,e){return Array.isArray(t)?typeof e=="function"?JC().path(e)(t):JC()(t):B1(t)}function V6(t,e=[t.data.name]){t.id=t.id||t.data.name,t.path=e,t.children&&t.children.forEach(n=>{n.id=`${t.id}/${n.data.name}`,n.path=[...e,n.data.name],V6(n,n.path)})}function Z6(t){const e=Ii(t,["data","name"]);e.replaceAll&&(t.path=e.replaceAll(".","/").split("/")),t.children&&t.children.forEach(n=>{Z6(n)})}function gW(t,e){const n={treemapBinary:hW,treemapDice:Nb,treemapSlice:MT,treemapSliceDice:dW,treemapSquarify:j6,treemapResquarify:pW},r=t==="treemapSquarify"?n[t].ratio(e):n[t];if(!r)throw new TypeError("Invalid tile method!");return r}function H6(t,e,n){const{value:r}=n,i=gW(e.tile,e.ratio),s=vW(t,e.path);Ps(t)?Z6(s):V6(s),r?s.sum(h=>e.ignoreParentValue&&h.children?0:qm(r)(h)).sort(e.sort):s.count(),mW().tile(i).size(e.size).round(e.round).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(s);const l=s.descendants().map(h=>Object.assign(h,{id:h.id.replace(/^\//,""),x:[h.x0,h.x1],y:[h.y0,h.y1]}));return[l.filter(typeof e.layer=="function"?e.layer:h=>h.height===e.layer),l]}var yW=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},_W=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function xW(t){return Ra(t).select(`.${At}`).node()}const bW={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function EW(t={}){const{originData:e=[],layout:n}=t,r=_W(t,["originData","layout"]),i=ti({},bW,r),s=ho(i,"breadCrumb"),l=ho(i,"active");return u=>{const{update:h,setState:p,container:m,options:y}=u,x=xW(m),T=y.marks[0],{state:C}=T,M=new Ai;x.appendChild(M);const I=(G,W)=>yW(this,void 0,void 0,function*(){if(M.removeChildren(),W){let $="",J=s.y,nt=0;const dt=[],Et=x.getBBox().width,Pt=G.map((Ht,Ct)=>{$=`${$}${Ht}/`,dt.push(Ht);const Ft=new pa({name:$.replace(/\/$/,""),style:Object.assign(Object.assign({text:Ht,x:nt,path:[...dt],depth:Ct},s),{y:J})});M.appendChild(Ft),nt+=Ft.getBBox().width;const jt=new pa({style:Object.assign(Object.assign({x:nt,text:" / "},s),{y:J})});return M.appendChild(jt),nt+=jt.getBBox().width,nt>Et&&(J=M.getBBox().height+s.y,nt=0,Ft.attr({x:nt,y:J}),nt+=Ft.getBBox().width,jt.attr({x:nt,y:J}),nt+=jt.getBBox().width),Ct===Lg(G)-1&&jt.remove(),Ft});Pt.forEach((Ht,Ct)=>{if(Ct===Lg(Pt)-1)return;const Ft=Object.assign({},Ht.attributes);Ht.attr("cursor","pointer"),Ht.addEventListener("mouseenter",()=>{Ht.attr(l)}),Ht.addEventListener("mouseleave",()=>{Ht.attr(Ft)}),Ht.addEventListener("click",()=>{I(Ii(Ht,["style","path"]),Ii(Ht,["style","depth"]))})})}TG(m,p),p("treemapDrillDown",$=>{const{marks:J}=$,nt=G.join("/"),dt=J.map(Et=>{if(Et.type!=="rect")return Et;let Pt=e;if(W){const Ct=e.filter(oe=>{const _e=Ii(oe,["id"]);return _e&&(_e.match(`${nt}/`)||nt.match(_e))}).map(oe=>({value:oe.height===0?Ii(oe,["value"]):void 0,name:Ii(oe,["id"])})),{paddingLeft:Ft,paddingBottom:jt,paddingRight:qt}=n,Ee=Object.assign(Object.assign({},n),{paddingTop:(n.paddingTop||M.getBBox().height+10)/(W+1),paddingLeft:Ft/(W+1),paddingBottom:jt/(W+1),paddingRight:qt/(W+1),path:oe=>oe.name,layer:oe=>oe.depth===W+1});Pt=H6(Ct,Ee,{value:"value"})[0]}else Pt=e.filter(Ct=>Ct.depth===1);const Ht=[];return Pt.forEach(({path:Ct})=>{Ht.push(Xb(Ct))}),ti({},Et,{data:Pt,scale:{color:{domain:Ht}}})});return Object.assign(Object.assign({},$),{marks:dt})}),yield h(void 0,["legendFilter"])}),D=G=>{const W=G.target;if(Ii(W,["markType"])!=="rect")return;const $=Ii(W,["__data__","key"]),J=H1(e,nt=>nt.id===$);Ii(J,"height")&&I(Ii(J,"path"),Ii(J,"depth"))};x.addEventListener("click",D);const U=QO(Object.assign(Object.assign({},C.active),C.inactive)),Z=()=>{lI(x).forEach(W=>{const $=Ii(W,["style","cursor"]),J=H1(e,nt=>nt.id===Ii(W,["__data__","key"]));if($!=="pointer"&&(J!=null&&J.height)){W.style.cursor="pointer";const nt=XO(W.attributes,U);W.addEventListener("mouseenter",()=>{W.attr(C.active)}),W.addEventListener("mouseleave",()=>{W.attr(ti(nt,C.inactive))})}})};return Z(),x.addEventListener("mousemove",Z),()=>{M.remove(),x.removeEventListener("click",D),x.removeEventListener("mousemove",Z)}}}var eR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},SW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const TW={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},nR="movePoint",G6=t=>{const e=t.target,{markType:n}=e;n==="line"&&(e.attr("_lineWidth",e.attr("lineWidth")||1),e.attr("lineWidth",e.attr("_lineWidth")+3)),n==="interval"&&(e.attr("_opacity",e.attr("opacity")||1),e.attr("opacity",.7*e.attr("_opacity")))},W6=t=>{const e=t.target,{markType:n}=e;n==="line"&&e.attr("lineWidth",e.attr("_lineWidth")),n==="interval"&&e.attr("opacity",e.attr("_opacity"))},wW=(t,e,n)=>e.map(r=>["x","color"].reduce((s,l)=>{const u=n[l];return u&&r[u]!==t[u]?!1:s},!0)?Object.assign(Object.assign({},r),t):r),AW=t=>{const e=Ii(t,["__data__","y"]),r=Ii(t,["__data__","y1"])-e,{__data__:{data:i,encode:s,transform:l},childNodes:u}=t.parentNode,h=H1(l,({type:y})=>y==="normalizeY"),p=Ii(s,["y","field"]),m=i[u.indexOf(t)][p];return(y,x=!1)=>h||x?y/(1-y)/(r/(1-r))*m:y},OW=(t,e)=>{const n=Ii(t,["__data__","seriesItems",e,"0","value"]),r=Ii(t,["__data__","seriesIndex",e]),{__data__:{data:i,encode:s,transform:l}}=t.parentNode,u=H1(l,({type:m})=>m==="normalizeY"),h=Ii(s,["y","field"]),p=i[r][h];return m=>u?n===1?m:m/(1-m)/(n/(1-n))*p:m},X6=(t,e,n)=>{t.forEach((r,i)=>{r.attr("stroke",e[1]===i?n.activeStroke:n.stroke)})},Y6=(t,e,n,r)=>{const i=new Zi({style:n}),s=new pa({style:r});return e.appendChild(s),t.appendChild(i),[i,s]},q6=(t,e)=>{if(!Ii(t,["options","range","indexOf"]))return;const r=t.options.range.indexOf(e);return t.sortedDomain[r]},rR=(t,e,n)=>{const r=zS(t,e),s=zS(t,n)/r,l=t[0]+(e[0]-t[0])*s,u=t[1]+(e[1]-t[1])*s;return[l,u]};function CW(t={}){const{selection:e=[],precision:n=2}=t,r=SW(t,["selection","precision"]),i=Object.assign(Object.assign({},TW),r||{}),s=ho(i,"path"),l=ho(i,"label"),u=ho(i,"point");return(h,p,m)=>{const{update:y,setState:x,container:T,view:C,options:{marks:M,coordinate:I}}=h,D=Zm(T);let U=lI(D),Z,G=e;const{transform:W=[],type:$}=I,J=!!H1(W,({type:oe})=>oe==="transpose"),nt=$==="polar",dt=$==="theta",Et=!!H1(U,({markType:oe})=>oe==="area");Et&&(U=U.filter(({markType:oe})=>oe==="area"));const Pt=new Ai({style:{zIndex:2}});D.appendChild(Pt);const Ht=()=>{m.emit("element-point:select",{nativeEvent:!0,data:{selection:G}})},Ct=(oe,_e)=>{m.emit("element-point:moved",{nativeEvent:!0,data:{changeData:oe,data:_e}})},Ft=oe=>{const _e=oe.target;G=[_e.parentNode.childNodes.indexOf(_e)],Ht(),qt(_e)},jt=oe=>{const{data:{selection:_e},nativeEvent:hn}=oe;if(hn)return;G=_e;const Dn=Ii(U,[G==null?void 0:G[0]]);Dn&&qt(Dn)},qt=oe=>{const{attributes:_e,markType:hn,__data__:Dn}=oe,{stroke:Kn}=_e,{points:Jn,seriesTitle:zr,color:ui,title:Ki,seriesX:Qr,y1:Kr}=Dn;if(J&&hn!=="interval")return;const{scale:Co,coordinate:Qi}=(Z==null?void 0:Z.view)||C,{color:ji,y:_o,x:Go}=Co,na=Qi.getCenter();Pt.removeChildren();let wa;const js=(ba,ss,Tl,Ou)=>eR(this,void 0,void 0,function*(){return x("elementPointMove",Wf=>{var Hc;const ph=(((Hc=Z==null?void 0:Z.options)===null||Hc===void 0?void 0:Hc.marks)||M).map(Cu=>{if(!Ou.includes(Cu.type))return Cu;const{data:Fd,encode:xc}=Cu,kh=Object.keys(xc).reduce((Jo,Xa)=>{const Rs=xc[Xa];return Xa==="x"&&(Jo[Rs]=ba),Xa==="y"&&(Jo[Rs]=ss),Xa==="color"&&(Jo[Rs]=Tl),Jo},{}),Rf=wW(kh,Fd,xc);return Ct(kh,Rf),ti({},Cu,{data:Rf,animate:!1})});return Object.assign(Object.assign({},Wf),{marks:ph})}),yield y("elementPointMove")});if(["line","area"].includes(hn))Jn.forEach((ba,ss)=>{const Tl=Go.invert(Qr[ss]);if(!Tl)return;const Ou=new Ir({name:nR,style:Object.assign({cx:ba[0],cy:ba[1],fill:Kn},u)}),Wf=OW(oe,ss);Ou.addEventListener("mousedown",Hc=>{const ph=Qi.output([Qr[ss],0]),Cu=zr==null?void 0:zr.length;T.attr("cursor","move"),G[1]!==ss&&(G[1]=ss,Ht()),X6(Pt.childNodes,G,u);const[Fd,xc]=Y6(Pt,Ou,s,l),Pc=Rf=>{const Jo=ba[1]+Rf.clientY-wa[1];if(Et)if(nt){const Xa=ba[0]+Rf.clientX-wa[0],[Rs,Ds]=rR(na,ph,[Xa,Jo]),[,bc]=Qi.output([1,_o.output(0)]),[,nf]=Qi.invert([Rs,bc-(Jn[ss+Cu][1]-Ds)]),rf=(ss+1)%Cu,Bh=(ss-1+Cu)%Cu,M0=Mb([Jn[Bh],[Rs,Ds],zr[rf]&&Jn[rf]]);xc.attr("text",Wf(_o.invert(nf)).toFixed(n)),Fd.attr("d",M0),Ou.attr("cx",Rs),Ou.attr("cy",Ds)}else{const[,Xa]=Qi.output([1,_o.output(0)]),[,Rs]=Qi.invert([ba[0],Xa-(Jn[ss+Cu][1]-Jo)]),Ds=Mb([Jn[ss-1],[ba[0],Jo],zr[ss+1]&&Jn[ss+1]]);xc.attr("text",Wf(_o.invert(Rs)).toFixed(n)),Fd.attr("d",Ds),Ou.attr("cy",Jo)}else{const[,Xa]=Qi.invert([ba[0],Jo]),Rs=Mb([Jn[ss-1],[ba[0],Jo],Jn[ss+1]]);xc.attr("text",_o.invert(Xa).toFixed(n)),Fd.attr("d",Rs),Ou.attr("cy",Jo)}};wa=[Hc.clientX,Hc.clientY],window.addEventListener("mousemove",Pc);const kh=()=>eR(this,void 0,void 0,function*(){if(T.attr("cursor","default"),window.removeEventListener("mousemove",Pc),T.removeEventListener("mouseup",kh),Jr(xc.attr("text")))return;const Rf=Number(xc.attr("text")),Jo=q6(ji,ui);Z=yield js(Tl,Rf,Jo,["line","area"]),xc.remove(),Fd.remove(),qt(oe)});T.addEventListener("mouseup",kh)}),Pt.appendChild(Ou)}),X6(Pt.childNodes,G,u);else if(hn==="interval"){let ba=[(Jn[0][0]+Jn[1][0])/2,Jn[0][1]];J?ba=[Jn[0][0],(Jn[0][1]+Jn[1][1])/2]:dt&&(ba=Jn[0]);const ss=AW(oe),Tl=new Ir({name:nR,style:Object.assign(Object.assign({cx:ba[0],cy:ba[1],fill:Kn},u),{stroke:u.activeStroke})});Tl.addEventListener("mousedown",Ou=>{T.attr("cursor","move");const Wf=q6(ji,ui),[Hc,ph]=Y6(Pt,Tl,s,l),Cu=xc=>{if(J){const Pc=ba[0]+xc.clientX-wa[0],[kh]=Qi.output([_o.output(0),_o.output(0)]),[,Rf]=Qi.invert([kh+(Pc-Jn[2][0]),ba[1]]),Jo=Mb([[Pc,Jn[0][1]],[Pc,Jn[1][1]],Jn[2],Jn[3]],!0);ph.attr("text",ss(_o.invert(Rf)).toFixed(n)),Hc.attr("d",Jo),Tl.attr("cx",Pc)}else if(dt){const Pc=ba[1]+xc.clientY-wa[1],kh=ba[0]+xc.clientX-wa[0],[Rf,Jo]=rR(na,[kh,Pc],ba),[Xa,Rs]=rR(na,[kh,Pc],Jn[1]),Ds=Qi.invert([Rf,Jo])[1],bc=Kr-Ds;if(bc<0)return;const nf=l7(na,[[Rf,Jo],[Xa,Rs],Jn[2],Jn[3]],bc>.5?1:0);ph.attr("text",ss(bc,!0).toFixed(n)),Hc.attr("d",nf),Tl.attr("cx",Rf),Tl.attr("cy",Jo)}else{const Pc=ba[1]+xc.clientY-wa[1],[,kh]=Qi.output([1,_o.output(0)]),[,Rf]=Qi.invert([ba[0],kh-(Jn[2][1]-Pc)]),Jo=Mb([[Jn[0][0],Pc],[Jn[1][0],Pc],Jn[2],Jn[3]],!0);ph.attr("text",ss(_o.invert(Rf)).toFixed(n)),Hc.attr("d",Jo),Tl.attr("cy",Pc)}};wa=[Ou.clientX,Ou.clientY],window.addEventListener("mousemove",Cu);const Fd=()=>eR(this,void 0,void 0,function*(){if(T.attr("cursor","default"),T.removeEventListener("mouseup",Fd),window.removeEventListener("mousemove",Cu),Jr(ph.attr("text")))return;const xc=Number(ph.attr("text"));Z=yield js(Ki,xc,Wf,[hn]),ph.remove(),Hc.remove(),qt(oe)});T.addEventListener("mouseup",Fd)}),Pt.appendChild(Tl)}};U.forEach((oe,_e)=>{G[0]===_e&&qt(oe),oe.addEventListener("click",Ft),oe.addEventListener("mouseenter",G6),oe.addEventListener("mouseleave",W6)});const Ee=oe=>{const _e=oe==null?void 0:oe.target;(!_e||_e.name!==nR&&!U.includes(_e))&&(G=[],Ht(),Pt.removeChildren())};return m.on("element-point:select",jt),m.on("element-point:unselect",Ee),T.addEventListener("mousedown",Ee),()=>{Pt.remove(),m.off("element-point:select",jt),m.off("element-point:unselect",Ee),T.removeEventListener("mousedown",Ee),U.forEach(oe=>{oe.removeEventListener("click",Ft),oe.removeEventListener("mouseenter",G6),oe.removeEventListener("mouseleave",W6)})}}}var RW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const $6=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{x:n=0,y:r=0,width:i,height:s,data:l}=t;return e.map(u=>{var{data:h,x:p,y:m,width:y,height:x}=u,T=RW(u,["data","x","y","width","height"]);return Object.assign(Object.assign({},T),{data:k(h,l),x:p!=null?p:n,y:m!=null?m:r,width:y!=null?y:i,height:x!=null?x:s})})};$6.props={};var MW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const K6=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{direction:n="row",ratio:r=e.map(()=>1),padding:i=0,data:s}=t,[l,u,h,p]=n==="col"?["y","height","width","x"]:["x","width","height","y"],m=r.reduce((M,I)=>M+I),y=t[u]-i*(e.length-1),x=r.map(M=>y*(M/m)),T=[];let C=t[l]||0;for(let M=0;M<x.length;M+=1){const I=e[M],{data:D}=I,U=MW(I,["data"]),Z=k(D,s);T.push(Object.assign({[l]:C,[u]:x[M],[p]:t[p]||0,[h]:t[h],data:Z},U)),C+=x[M]+i}return T};K6.props={};class t2{constructor(e){this.$value=e}static of(e){return new t2(e)}call(e,...n){return this.$value=e(this.$value,...n),this}value(){return this.$value}}var PW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const IW=S(t=>{const{encode:e,data:n,scale:r,shareSize:i=!1}=t,{x:s,y:l}=e,u=(h,p)=>{var m;if(h===void 0||!i)return{};const y=vc(n,C=>C[h]),x=((m=r==null?void 0:r[p])===null||m===void 0?void 0:m.domain)||Array.from(y.keys()),T=x.map(C=>y.has(C)?y.get(C).length:1);return{domain:x,flex:T}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:s===void 0?null:{position:"top"}},s===void 0&&{paddingInner:0}),u(s,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:l===void 0?null:{position:"right"}},l===void 0&&{paddingInner:0}),u(l,"y"))}}}),iR=O(t=>{const{data:e,scale:n,legend:r}=t,i=[t];let s,l,u;for(;i.length;){const x=i.shift(),{children:T,encode:C={},scale:M={},legend:I={}}=x,{color:D}=C,{color:U}=M,{color:Z}=I;D!==void 0&&(s=D),U!==void 0&&(l=U),Z!==void 0&&(u=Z),Array.isArray(T)&&i.push(...T)}const h=()=>{var x;const T=(x=n==null?void 0:n.color)===null||x===void 0?void 0:x.domain;if(T!==void 0)return[T];if(s===void 0)return[void 0];const C=typeof s=="function"?s:I=>I[s],M=e.map(C);return M.some(I=>typeof I=="number")?[S0(M)]:[Array.from(new Set(M)),"ordinal"]},p=typeof s=="string"?s:"",[m,y]=h();return Object.assign({encode:{color:{type:"column",value:m!=null?m:[]}},scale:{color:ti({},l,{domain:m,type:y})}},r===void 0&&{legend:{color:ti({title:p},u)}})}),oR=S(()=>({animate:{enterType:"fadeIn"}})),aR=O(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),sR=O(()=>({type:"cell"})),Q6=O(t=>{const{data:e}=t;return{data:{type:"inline",value:e,transform:[{type:"custom",callback:()=>{const{data:r,encode:i}=t,{x:s,y:l}=i,u=s?Array.from(new Set(r.map(m=>m[s]))):[],h=l?Array.from(new Set(r.map(m=>m[l]))):[];return(()=>{if(u.length&&h.length){const m=[];for(const y of u)for(const x of h)m.push({[s]:y,[l]:x});return m}if(u.length)return u.map(m=>({[s]:m}));if(h.length)return h.map(m=>({[l]:m}))})()}}]}}}),J6=O((t,e=LW,n=DW,r=NW,i={})=>{const{data:s,encode:l,children:u,scale:h,x:p=0,y:m=0,shareData:y=!1,key:x}=t,{value:T}=s,{x:C,y:M}=l,{color:I}=h,{domain:D}=I;return{children:(Z,G,W)=>{const{x:$,y:J}=G,{paddingLeft:nt,paddingTop:dt,marginLeft:Et,marginTop:Pt}=W,{domain:Ht}=$.getOptions(),{domain:Ct}=J.getOptions(),Ft=wv(Z),jt=Z.map(e),qt=Z.map(({x:Kn,y:Jn})=>[$.invert(Kn),J.invert(Jn)]),oe=qt.map(([Kn,Jn])=>zr=>{const{[C]:ui,[M]:Ki}=zr;return(C!==void 0?ui===Kn:!0)&&(M!==void 0?Ki===Jn:!0)}).map(Kn=>T.filter(Kn)),_e=y?El(oe,Kn=>Kn.length):void 0,hn=qt.map(([Kn,Jn])=>({columnField:C,columnIndex:Ht.indexOf(Kn),columnValue:Kn,columnValuesLength:Ht.length,rowField:M,rowIndex:Ct.indexOf(Jn),rowValue:Jn,rowValuesLength:Ct.length})),Dn=hn.map(Kn=>Array.isArray(u)?u:[u(Kn)].flat(1));return Ft.flatMap(Kn=>{const[Jn,zr,ui,Ki]=jt[Kn],Qr=hn[Kn],Kr=oe[Kn];return Dn[Kn].map(Qi=>{var ji,_o,{scale:Go,key:na,facet:wa=!0,axis:js={},legend:ba={}}=Qi,ss=PW(Qi,["scale","key","facet","axis","legend"]);const Tl=((ji=Go==null?void 0:Go.y)===null||ji===void 0?void 0:ji.guide)||js.y,Ou=((_o=Go==null?void 0:Go.x)===null||_o===void 0?void 0:_o.guide)||js.x,Wf={x:{tickCount:C?5:void 0},y:{tickCount:M?5:void 0}},Hc=wa?Kr:Kr.length===0?[]:T,ph={color:{domain:D}},Cu={x:tk(Ou,n)(Qr,Hc),y:tk(Tl,r)(Qr,Hc)};return Object.assign(Object.assign({key:`${na}-${Kn}`,data:Hc,margin:0,x:Jn+nt+p+Et,y:zr+dt+m+Pt,parentKey:x,width:ui,height:Ki,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!Hc.length,dataDomain:_e,scale:ti(Wf,Go,ph),axis:ti({},js,Cu),legend:!1},ss),i)})})}}});function LW(t){const{points:e}=t;return lr(e)}function PT(t,e){return e.length?ti({title:!1,tick:null,label:null},t):ti({title:!1,tick:null,label:null,grid:null},t)}function DW(t){return(e,n)=>{const{rowIndex:r,rowValuesLength:i,columnIndex:s,columnValuesLength:l}=e;if(r!==i-1)return PT(t,n);const u=s!==l-1?!1:void 0,h=n.length?void 0:null;return ti({title:u,grid:h},t)}}function NW(t){return(e,n)=>{const{rowIndex:r,columnIndex:i}=e;if(i!==0)return PT(t,n);const s=r!==0?!1:void 0,l=n.length?void 0:null;return ti({title:s,grid:l},t)}}function tk(t,e){return typeof t=="function"?t:t===null||t===!1?()=>null:e(t)}const ek=()=>t=>[t2.of(t).call(sR).call(iR).call(oR).call(IW).call(aR).call(Q6).call(J6).value()];ek.props={};var lR=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const kW=S(t=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),BW=O(t=>{const{data:e,children:n,x:r=0,y:i=0,key:s}=t;return{children:(u,h,p)=>{const{x:m,y}=h,{paddingLeft:x,paddingTop:T,marginLeft:C,marginTop:M}=p,{domain:I}=m.getOptions(),{domain:D}=y.getOptions(),U=wv(u),Z=u.map(({points:J})=>lr(J)),G=u.map(({x:J,y:nt})=>[m.invert(J),y.invert(nt)]),W=G.map(([J,nt])=>({columnField:J,columnIndex:I.indexOf(J),columnValue:J,columnValuesLength:I.length,rowField:nt,rowIndex:D.indexOf(nt),rowValue:nt,rowValuesLength:D.length})),$=W.map(J=>Array.isArray(n)?n:[n(J)].flat(1));return U.flatMap(J=>{const[nt,dt,Et,Pt]=Z[J],[Ht,Ct]=G[J],Ft=W[J];return $[J].map(qt=>{var Ee,oe;const{scale:_e,key:hn,encode:Dn,axis:Kn,interaction:Jn}=qt,zr=lR(qt,["scale","key","encode","axis","interaction"]),ui=(Ee=_e==null?void 0:_e.y)===null||Ee===void 0?void 0:Ee.guide,Ki=(oe=_e==null?void 0:_e.x)===null||oe===void 0?void 0:oe.guide,Qr={x:{facet:!1},y:{facet:!1}},Kr={x:UW(Ki)(Ft,e),y:zW(ui)(Ft,e)},Co={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:e,parentKey:s,key:`${hn}-${J}`,x:nt+x+r+C,y:dt+T+i+M,width:Et,height:Pt,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:ti(Qr,_e),axis:ti(Co,Kn,Kr),legend:!1,encode:ti({},Dn,{x:Ht,y:Ct}),interaction:ti({},Jn,{legendFilter:!1})},zr)})})}}}),FW=O(t=>{const{encode:e}=t,n=lR(t,["encode"]),{position:r=[],x:i=r,y:s=[...r].reverse()}=e,l=lR(e,["position","x","y"]),u=[];for(const h of[i].flat(1))for(const p of[s].flat(1))u.push({$x:h,$y:p});return Object.assign(Object.assign({},n),{data:u,encode:Object.assign(Object.assign({},l),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[i].flat(1).length===1&&{x:{paddingInner:0}}),[s].flat(1).length===1&&{y:{paddingInner:0}})})});function UW(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{rowIndex:r,rowValuesLength:i}=e;if(r!==i-1)return PT(t,n)}}function zW(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{columnIndex:r}=e;if(r!==0)return PT(t,n)}}const jW=()=>t=>[t2.of(t).call(sR).call(iR).call(BW).call(FW).call(oR).call(aR).call(kW).value()];var VW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const ZW=S(t=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),HW=S(t=>({coordinate:{type:"polar"}})),GW=t=>{const{encode:e}=t,n=VW(t,["encode"]),{position:r}=e;return Object.assign(Object.assign({},n),{encode:{x:r}})};function nk(t){return e=>null}function WW(t){const{points:e}=t,[n,r,i,s]=e,l=Tt(n,s),u=st(n,s),h=st(r,i),p=yn(u,h),m=1/Math.sin(p/2),y=l/(1+m),x=y*Math.sqrt(2),[T,C]=i,I=Ve(u)+p/2,D=y*m,U=T+D*Math.sin(I),Z=C-D*Math.cos(I);return[U-x/2,Z-x/2,x,x]}const XW=()=>t=>[t2.of(t).call(sR).call(GW).call(iR).call(HW).call(Q6).call(J6,WW,nk,nk,{frame:!1}).call(oR).call(aR).call(ZW).value()];function YW(t,e,n){const i=n,s=[0,i],l=[-i+1,1];if(t==="normal")return s;if(t==="reverse")return l;if(t==="alternate")return e%2===0?s:l;if(t==="reverse-alternate")return e%2===0?l:s}function qW(t,e,n){const r=[t];for(;r.length;){const i=r.pop();i.animate=ti({enter:{duration:e},update:{duration:e,easing:n,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:e}},i.animate||{});const{children:s}=i;Array.isArray(s)&&r.push(...s)}return t}const rk=()=>t=>{const{children:e=[],duration:n=1e3,iterationCount:r=1,direction:i="normal",easing:s="ease-in-out-sine"}=t,l=e.length;if(!Array.isArray(e)||l===0)return[];const{key:u}=e[0],h=e.map(p=>Object.assign(Object.assign({},p),{key:u})).map(p=>qW(p,n,s));return function*(){let p=0,m;for(;r==="infinite"||p<r;){const[y,x]=YW(i,p,l);for(let T=y;T<x;T+=1){const C=Math.abs(T);m!==C&&(yield h[C]),m=C}p++}}};rk.props={};function qg(t,e,n){const{encode:r}=n;if(t===null)return[e];const i=$W(t).map(l=>{var u;return[l,(u=nl(r,l))===null||u===void 0?void 0:u[0]]}).filter(([,l])=>Ql(l)),s=l=>i.map(([,u])=>u[l]).join("-");return Array.from(vc(e,s).values())}function ik(t){return Array.isArray(t)?JW(t):typeof t=="function"?QW(t):t==="series"?KW:t==="value"?tX:t==="sum"?eX:t==="maxIndex"?nX:null}function ok(t,e){for(const n of t)n.sort(e)}function ak(t,e){return(e==null?void 0:e.domain)||Array.from(new Set(t))}function $W(t){return Array.isArray(t)?t:[t]}function KW(t,e,n){return e2(r=>n[r])}function QW(t){return(e,n,r)=>e2(i=>t(e[i]))}function JW(t){return(e,n,r)=>(i,s)=>t.reduce((l,u)=>l!==0?l:Tu(e[i][u],e[s][u]),0)}function tX(t,e,n){return e2(r=>e[r])}function eX(t,e,n){const r=wv(t),i=Array.from(vc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,u.reduce((h,p)=>h+ +e[p])]));return e2(l=>s.get(n[l]))}function nX(t,e,n){const r=wv(t),i=Array.from(vc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,A1(u,h=>e[h])]));return e2(l=>s.get(n[l]))}function e2(t){return(e,n)=>Tu(t(e),t(n))}const sk=(t={})=>{const{groupBy:e="x",orderBy:n=null,reverse:r=!1,y:i="y",y1:s="y1",series:l=!0}=t;return(u,h)=>{var p;const{data:m,encode:y,style:x={}}=h,[T,C]=nl(y,"y"),[M,I]=nl(y,"y1"),[D]=l?Bb(y,"series","color"):nl(y,"color"),U=qg(e,u,h),G=((p=ik(n))!==null&&p!==void 0?p:()=>null)(m,T,D);G&&ok(U,G);const W=new Array(u.length),$=new Array(u.length),J=new Array(u.length),nt=[],dt=[];for(const Ft of U){r&&Ft.reverse();const jt=M?+M[Ft[0]]:0,qt=[],Ee=[];for(const zr of Ft){const ui=J[zr]=+T[zr]-jt;ui<0?Ee.push(zr):ui>=0&&qt.push(zr)}const oe=qt.length>0?qt:Ee,_e=Ee.length>0?Ee:qt;let hn=qt.length-1,Dn=0;for(;hn>0&&T[oe[hn]]===0;)hn--;for(;Dn<_e.length-1&&T[_e[Dn]]===0;)Dn++;nt.push(oe[hn]),dt.push(_e[Dn]);let Kn=jt;for(const zr of Ee.reverse()){const ui=J[zr];Kn=W[zr]=($[zr]=Kn)+ui}let Jn=jt;for(const zr of qt){const ui=J[zr];ui>0?Jn=W[zr]=($[zr]=Jn)+ui:W[zr]=$[zr]=Jn}}const Et=new Set(nt),Pt=new Set(dt),Ht=i==="y"?W:$,Ct=s==="y"?W:$;return[u,ti({},h,{encode:{y0:oT(T,C),y:_c(Ht,C),y1:_c(Ct,I)},style:Object.assign({first:(Ft,jt)=>Et.has(jt),last:(Ft,jt)=>Pt.has(jt)},x)})]}};sk.props={};function lk(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&++n}return n}function rX(t,e){let n=0,r,i=0,s=0;if(e===void 0)for(let l of t)l!=null&&(l=+l)>=l&&(r=l-i,i+=r/++n,s+=r*(l-i));else{let l=-1;for(let u of t)(u=e(u,++l,t))!=null&&(u=+u)>=u&&(r=u-i,i+=r/++n,s+=r*(u-i))}if(n>1)return s/(n-1)}function ck(t,e){const n=rX(t,e);return n&&Math.sqrt(n)}function iX(t,e,n){const r=lk(t),i=ck(t);return r&&i?Math.ceil((n-e)*Math.cbrt(r)/(3.49*i)):1}var uk=Array.prototype,oX=uk.slice,Zet=uk.map;function cR(t){return()=>t}const aX=Math.sqrt(50),sX=Math.sqrt(10),lX=Math.sqrt(2);function IT(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=aX?10:s>=sX?5:s>=lX?2:1;let u,h,p;return i<0?(p=Math.pow(10,-i)/l,u=Math.round(t*p),h=Math.round(e*p),u/p<t&&++u,h/p>e&&--h,p=-p):(p=Math.pow(10,i)*l,u=Math.round(t/p),h=Math.round(e/p),u*p<t&&++u,h*p>e&&--h),h<u&&.5<=n&&n<2?IT(t,e,n*2):[u,h,p]}function cX(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,l]=r?IT(e,t,n):IT(t,e,n);if(!(s>=i))return[];const u=s-i+1,h=new Array(u);if(r)if(l<0)for(let p=0;p<u;++p)h[p]=(s-p)/-l;else for(let p=0;p<u;++p)h[p]=(s-p)*l;else if(l<0)for(let p=0;p<u;++p)h[p]=(i+p)/-l;else for(let p=0;p<u;++p)h[p]=(i+p)*l;return h}function n2(t,e,n){return e=+e,t=+t,n=+n,IT(t,e,n)[2]}function Het(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?n2(e,t,n):n2(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function uX(t,e,n){let r;for(;;){const i=n2(t,e,n);if(i===r||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}function fX(t){return Math.max(1,Math.ceil(Math.log(lk(t))/Math.LN2)+1)}function hX(){var t=Im,e=S0,n=fX;function r(i){Array.isArray(i)||(i=Array.from(i));var s,l=i.length,u,h,p=new Array(l);for(s=0;s<l;++s)p[s]=t(i[s],s,i);var m=e(p),y=m[0],x=m[1],T=n(p,y,x);if(!Array.isArray(T)){const Z=x,G=+T;if(e===S0&&([y,x]=uX(y,x,G)),T=cX(y,x,G),T[0]<=y&&(h=n2(y,x,G)),T[T.length-1]>=x)if(Z>=x&&e===S0){const W=n2(y,x,G);isFinite(W)&&(W>0?x=(Math.floor(x/W)+1)*W:W<0&&(x=(Math.ceil(x*-W)+1)/-W))}else T.pop()}for(var C=T.length,M=0,I=C;T[M]<=y;)++M;for(;T[I-1]>x;)--I;(M||I<C)&&(T=T.slice(M,I),C=I-M);var D=new Array(C+1),U;for(s=0;s<=C;++s)U=D[s]=[],U.x0=s>0?T[s-1]:y,U.x1=s<C?T[s]:x;if(isFinite(h)){if(h>0)for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=x&&D[Math.min(C,Math.floor((u-y)/h))].push(i[s]);else if(h<0){for(s=0;s<l;++s)if((u=p[s])!=null&&y<=u&&u<=x){const Z=Math.floor((y-u)*h);D[Math.min(C,Z+(T[Z]<=u))].push(i[s])}}}else for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=x&&D[G8(T,u,0,C)].push(i[s]);return D}return r.value=function(i){return arguments.length?(t=typeof i=="function"?i:cR(i),r):t},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:cR([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:cR(Array.isArray(i)?oX.call(i):i),r):n},r}function uR(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?Sb:WP(i);r>n;){if(r-n>600){const h=r-n+1,p=e-n+1,m=Math.log(h),y=.5*Math.exp(2*m/3),x=.5*Math.sqrt(m*y*(h-y)/h)*(p-h/2<0?-1:1),T=Math.max(n,Math.floor(e-p*y/h+x)),C=Math.min(r,Math.floor(e+(h-p)*y/h+x));uR(t,e,T,C,i)}const s=t[e];let l=n,u=r;for(r2(t,n,e),i(t[r],s)>0&&r2(t,n,r);l<u;){for(r2(t,l,u),++l,--u;i(t[l],s)<0;)++l;for(;i(t[u],s)>0;)--u}i(t[n],s)===0?r2(t,n,u):(++u,r2(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function r2(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function dX(t,e=Tu){let n,r=!1;if(e.length===1){let i;for(const s of t){const l=e(s);(r?Tu(l,i)>0:Tu(l,l)===0)&&(n=s,i=l,r=!0)}}else for(const i of t)(r?e(i,n)>0:e(i,i)===0)&&(n=i,r=!0);return n}function LT(t,e,n){if(t=Float64Array.from(j8(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return Hp(t);if(e>=1)return El(t);var r,i=(r-1)*e,s=Math.floor(i),l=El(uR(t,s).subarray(0,s+1)),u=Hp(t.subarray(s+1));return l+(u-l)*(i-s)}}function Get(t,e,n=number){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,s=Math.floor(i),l=+n(t[s],s,t),u=+n(t[s+1],s+1,t);return l+(u-l)*(i-s)}}function pX(t,e,n=_O){if(!isNaN(e=+e)){if(r=Float64Array.from(t,(u,h)=>_O(n(t[h],h,t))),e<=0)return Qb(r);if(e>=1)return A1(r);var r,i=Uint32Array.from(t,(u,h)=>h),s=r.length-1,l=Math.floor(s*e);return uR(i,l,0,s,(u,h)=>Sb(r[u],r[h])),l=dX(i.subarray(0,l+1),u=>r[u]),l>=0?l:-1}}function fR(t,e){return LT(t,.5,e)}function mX(t,e){return pX(t,.5,e)}var vX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function $g(t){return e=>e===null?t:`${t} of ${e}`}function gX(t){if(typeof t=="function")return[t,null];const n={mean:yX,max:xX,count:EX,first:TX,last:wX,sum:SX,min:bX,median:_X}[t];if(!n)throw new Error(`Unknown reducer: ${t}.`);return n()}function yX(){const t=(n,r)=>Jb(n,i=>+r[i]),e=$g("mean");return[t,e]}function _X(){const t=(n,r)=>fR(n,i=>+r[i]),e=$g("median");return[t,e]}function xX(){const t=(n,r)=>El(n,i=>+r[i]),e=$g("max");return[t,e]}function bX(){const t=(n,r)=>Hp(n,i=>+r[i]),e=$g("min");return[t,e]}function EX(){const t=(n,r)=>n.length,e=$g("count");return[t,e]}function SX(){const t=(n,r)=>sp(n,i=>+r[i]),e=$g("sum");return[t,e]}function TX(){const t=(n,r)=>r[n[0]],e=$g("first");return[t,e]}function wX(){const t=(n,r)=>r[n[n.length-1]],e=$g("last");return[t,e]}const hR=(t={})=>{const{groupBy:e}=t,n=vX(t,["groupBy"]);return(r,i)=>{const{data:s,encode:l}=i,u=e(r,i);if(!u)return[r,i];const h=(T,C)=>{if(T)return T;const{from:M}=C;if(!M)return T;const[,I]=nl(l,M);return I},p=Object.entries(n).map(([T,C])=>{const[M,I]=gX(C),[D,U]=nl(l,T),Z=h(U,C),G=u.map(W=>M(W,D!=null?D:s));return[T,Object.assign(Object.assign({},sV(G,(I==null?void 0:I(Z))||Z)),{aggregate:!0})]}),m=Object.keys(l).map(T=>{const[C,M]=nl(l,T),I=u.map(D=>C[D[0]]);return[T,_c(I,M)]}),y=u.map(T=>s[T[0]]);return[wv(u),ti({},i,{data:y,encode:Object.fromEntries([...m,...p])})]}};hR.props={};var AX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const fk="thresholds";function OX(t){const[e,n]=S0(t);return Math.min(200,iX(t,e,n))}const dR=(t={})=>{const{groupChannels:e=["color"],binChannels:n=["x","y"]}=t,r=AX(t,["groupChannels","binChannels"]),i={},s=(l,u)=>{const{encode:h}=u,p=n.map(C=>{const[M]=nl(h,C);return M}),m=ho(r,fk),y=l.filter(C=>p.every(M=>Ql(M[C]))),x=[...e.map(C=>{const[M]=nl(h,C);return M}).filter(Ql).map(C=>M=>C[M]),...n.map((C,M)=>{const I=p[M],D=m[C]||OX(I),U=hX().thresholds(D).value(G=>+I[G])(y),Z=new Map(U.flatMap(G=>{const{x0:W,x1:$}=G,J=`${W},${$}`;return G.map(nt=>[nt,J])}));return i[C]=Z,G=>Z.get(G)})],T=C=>x.map(M=>M(C)).join("-");return Array.from(vc(y,T).values())};return hR(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter(([l])=>!l.startsWith(fk)))),Object.fromEntries(n.flatMap(l=>{const u=([p])=>+i[l].get(p).split(",")[0],h=([p])=>+i[l].get(p).split(",")[1];return h.from=l,[[l,u],[`${l}1`,h]]}))),{groupBy:s}))};dR.props={};const hk=(t={})=>{const{thresholds:e}=t;return dR(Object.assign(Object.assign({},t),{thresholdsX:e,groupChannels:["color"],binChannels:["x"]}))};hk.props={};var CX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const dk=(t={})=>{const{groupBy:e="x",reverse:n=!1,orderBy:r,padding:i}=t,s=CX(t,["groupBy","reverse","orderBy","padding"]);return(l,u)=>{const{data:h,encode:p,scale:m}=u,{series:y}=m,[x]=nl(p,"y"),[T]=Bb(p,"series","color"),C=ak(T,y),M=ti({},u,{scale:{series:{domain:C,paddingInner:i}}}),I=qg(e,l,u),D=ik(r);if(!D)return[l,ti(M,{encode:{series:_c(T)}})];const U=D(h,x,T);U&&ok(I,U);const Z=new Array(l.length);for(const G of I){n&&G.reverse();for(let W=0;W<G.length;W++)Z[G[W]]=C[W]}return[l,ti(M,{encode:{series:_c(r?Z:T)}})]}};dk.props={};function DT(t,e,n){if(t===null)return[-.5,.5];const r=ak(t,e),s=new Gg({domain:r,range:[0,1],padding:n}).getBandWidth();return[-s/2,s/2]}function NT(t,e,n){return e*(1-t)+n*t}const pk=(t={})=>{const{padding:e=0,paddingX:n=e,paddingY:r=e,random:i=Math.random}=t;return(s,l)=>{const{encode:u,scale:h}=l,{x:p,y:m}=h,[y]=nl(u,"x"),[x]=nl(u,"y"),T=DT(y,p,n),C=DT(x,m,r),M=s.map(()=>NT(i(),...C)),I=s.map(()=>NT(i(),...T));return[s,ti({scale:{x:{padding:.5},y:{padding:.5}}},l,{encode:{dy:_c(M),dx:_c(I)}})]}};pk.props={};const mk=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,i)=>{const{encode:s,scale:l}=i,{x:u}=l,[h]=nl(s,"x"),p=DT(h,u,e),m=r.map(()=>NT(n(),...p));return[r,ti({scale:{x:{padding:.5}}},i,{encode:{dx:_c(m)}})]}};mk.props={};const vk=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,i)=>{const{encode:s,scale:l}=i,{y:u}=l,[h]=nl(s,"y"),p=DT(h,u,e),m=r.map(()=>NT(n(),...p));return[r,ti({scale:{y:{padding:.5}}},i,{encode:{dy:_c(m)}})]}};vk.props={};var RX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const gk=(t={})=>{const{groupBy:e="x"}=t;return(n,r)=>{const{encode:i}=r,{x:s}=i,l=RX(i,["x"]),u=Object.entries(l).filter(([x])=>x.startsWith("y")).map(([x])=>[x,nl(i,x)[0]]),h=u.map(([x])=>[x,new Array(n.length)]),p=qg(e,n,r),m=new Array(p.length);for(let x=0;x<p.length;x++){const C=p[x].flatMap(D=>u.map(([,U])=>+U[D])),[M,I]=S0(C);m[x]=(M+I)/2}const y=Math.max(...m);for(let x=0;x<p.length;x++){const T=y-m[x],C=p[x];for(const M of C)for(let I=0;I<u.length;I++){const[,D]=u[I],[,U]=h[I];U[M]=+D[M]+T}}return[n,ti({},r,{encode:Object.fromEntries(h.map(([x,T])=>[x,_c(T,nl(i,x)[1])]))})]}};gk.props={};const yk=(t={})=>{const{groupBy:e="x",series:n=!0}=t;return(r,i)=>{const{encode:s}=i,[l]=nl(s,"y"),[u,h]=nl(s,"y1"),[p]=n?Bb(s,"series","color"):nl(s,"color"),m=qg(e,r,i),y=new Array(r.length);for(const x of m){const T=x.map(C=>+l[C]);for(let C=0;C<x.length;C++){const M=x[C],I=Math.max(...T.filter((D,U)=>U!==C));y[M]=+l[M]>I?I:l[M]}}return[r,ti({},i,{encode:{y1:_c(y,h)}})]}};yk.props={};const _k=t=>{const{groupBy:e=["x"],reducer:n=(l,u)=>u[l[0]],orderBy:r=null,reverse:i=!1,duration:s}=t;return(l,u)=>{const{encode:h}=u,m=(Array.isArray(e)?e:[e]).map(I=>[I,nl(h,I)[0]]);if(m.length===0)return[l,u];let y=[l];for(const[,I]of m){const D=[];for(const U of y){const Z=Array.from(vc(U,G=>I[G]).values());D.push(...Z)}y=D}if(r){const[I]=nl(h,r);I&&y.sort((D,U)=>n(D,I)-n(U,I)),i&&y.reverse()}const x=(s||3e3)/y.length,[T]=s?[Zg(l,x)]:Bb(h,"enterDuration",Zg(l,x)),[C]=Bb(h,"enterDelay",Zg(l,0)),M=new Array(l.length);for(let I=0,D=0;I<y.length;I++){const U=y[I],Z=El(U,G=>+T[G]);for(const G of U)M[G]=+C[G]+D;D+=Z}return[l,ti({},u,{encode:{enterDuration:aT(T),enterDelay:aT(M)}})]}};_k.props={};var MX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function PX(t){return typeof t=="function"?t:{min:(n,r)=>Hp(n,i=>r[+i]),max:(n,r)=>El(n,i=>r[+i]),first:(n,r)=>r[n[0]],last:(n,r)=>r[n[n.length-1]],mean:(n,r)=>Jb(n,i=>r[+i]),median:(n,r)=>fR(n,i=>r[+i]),sum:(n,r)=>sp(n,i=>r[+i]),deviation:(n,r)=>ck(n,i=>r[+i])}[t]||El}const xk=(t={})=>{const{groupBy:e="x",basis:n="max"}=t;return(r,i)=>{const{encode:s,tooltip:l}=i,{x:u}=s,h=MX(s,["x"]),p=Object.entries(h).filter(([M])=>M.startsWith("y")).map(([M])=>[M,nl(s,M)[0]]),[,m]=p.find(([M])=>M==="y"),y=p.map(([M])=>[M,new Array(r.length)]),x=qg(e,r,i),T=PX(n);for(const M of x){const I=T(M,m);for(const D of M)for(let U=0;U<p.length;U++){const[,Z]=p[U],[,G]=y[U];G[D]=+Z[D]/I}}const C=X0(l)||(l==null?void 0:l.items)&&(l==null?void 0:l.items.length)!==0;return[r,ti({},i,Object.assign({encode:Object.fromEntries(y.map(([M,I])=>[M,_c(I,nl(s,M)[1])]))},!C&&s.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};xk.props={};function bk(t,e){return[t[0]]}function IX(t,e){const n=t.length-1;return[t[n]]}function LX(t,e){const n=A1(t,r=>e[r]);return[t[n]]}function DX(t,e){const n=Qb(t,r=>e[r]);return[t[n]]}function NX(t){return typeof t=="function"?t:{first:bk,last:IX,max:LX,min:DX}[t]||bk}const kT=(t={})=>{const{groupBy:e="series",channel:n,selector:r}=t;return(i,s)=>{const{encode:l}=s,u=qg(e,i,s),[h]=nl(l,n),p=NX(r);return[u.flatMap(m=>p(m,h)),s]}};kT.props={};var kX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Ek=(t={})=>{const{selector:e}=t,n=kX(t,["selector"]);return kT(Object.assign({channel:"x",selector:e},n))};Ek.props={};var BX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Sk=(t={})=>{const{selector:e}=t,n=BX(t,["selector"]);return kT(Object.assign({channel:"y",selector:e},n))};Sk.props={};var FX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const i2=(t={})=>{const{channels:e=["x","y"]}=t,n=FX(t,["channels"]),r=(i,s)=>qg(e,i,s);return hR(Object.assign(Object.assign({},n),{groupBy:r}))};i2.props={};const Tk=(t={})=>i2(Object.assign(Object.assign({},t),{channels:["x","color","series"]}));Tk.props={};const wk=(t={})=>i2(Object.assign(Object.assign({},t),{channels:["y","color","series"]}));wk.props={};const Ak=(t={})=>i2(Object.assign(Object.assign({},t),{channels:["color"]}));Ak.props={};function UX(t,e,n){return(e.length!==2?tm(G_(t,e,n),([r,i],[s,l])=>Tu(i,l)||Tu(r,s)):tm(vc(t,n),([r,i],[s,l])=>e(i,l)||Tu(r,s))).map(([r])=>r)}var Ok=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function zX(t,e,n){const{by:r=t,reducer:i="max"}=e,[s]=nl(n,r);if(typeof i=="function")return l=>i(l,s);if(i==="max")return l=>El(l,u=>+s[u]);if(i==="min")return l=>Hp(l,u=>+s[u]);if(i==="sum")return l=>sp(l,u=>+s[u]);if(i==="median")return l=>fR(l,u=>+s[u]);if(i==="mean")return l=>Jb(l,u=>+s[u]);if(i==="first")return l=>s[l[0]];if(i==="last")return l=>s[l[l.length-1]];throw new Error(`Unknown reducer: ${i}`)}function jX(t,e,n){const{reverse:r,channel:i}=n,{encode:s}=e,[l]=nl(s,i),u=tm(t,h=>l[h]);return r&&u.reverse(),[u,e]}function VX(t,e,n){if(!Array.isArray(n))return t;const r=new Set(n);return t.filter(i=>r.has(e[i]))}function ZX(t,e,n){var r;const{reverse:i,slice:s,channel:l}=n,u=Ok(n,["reverse","slice","channel"]),{encode:h,scale:p={}}=e,m=(r=p[l])===null||r===void 0?void 0:r.domain,[y]=nl(h,l),x=zX(l,u,h),T=VX(t,y,m),C=UX(T,x,D=>y[D]);i&&C.reverse();const M=typeof s=="number"?[0,s]:s,I=s?C.slice(...M):C;return[t,ti(e,{scale:{[l]:{domain:I}}})]}const BT=(t={})=>{const{reverse:e=!1,slice:n,channel:r,ordinal:i=!0}=t,s=Ok(t,["reverse","slice","channel","ordinal"]);return(l,u)=>i?ZX(l,u,Object.assign({reverse:e,slice:n,channel:r},s)):jX(l,u,Object.assign({reverse:e,slice:n,channel:r},s))};BT.props={};const Ck=(t={})=>BT(Object.assign(Object.assign({},t),{channel:"x"}));Ck.props={};const Rk=(t={})=>BT(Object.assign(Object.assign({},t),{channel:"y"}));Rk.props={};const Mk=(t={})=>BT(Object.assign(Object.assign({},t),{channel:"color"}));Mk.props={};function HX(t,e){return typeof e=="string"?t.map(n=>n[e]):t.map(e)}function GX(t,e){if(typeof t=="function")return n=>t(n,e);if(t==="sum")return n=>sp(n,r=>+e[r]);throw new Error(`Unknown reducer: ${t}`)}const Pk=(t={})=>{const{field:e,channel:n="y",reducer:r="sum"}=t;return(i,s)=>{const{data:l,encode:u}=s,[h]=nl(u,"x"),p=e?HX(l,e):nl(u,n)[0],m=GX(r,p),y=W_(i,m,x=>h[x]).map(x=>x[1]);return[i,ti({},s,{scale:{x:{flex:y}}})]}};Pk.props={};function WX(t){const{padding:e=0,direction:n="col"}=t;return(r,i,s)=>{const l=r.length;if(l===0)return[];const{innerWidth:u,innerHeight:h}=s,p=h/u;let m=Math.ceil(Math.sqrt(i/p)),y=u/m,x=Math.ceil(i/m),T=x*y;for(;T>h;)m=m+1,y=u/m,x=Math.ceil(i/m),T=x*y;const C=h-x*y,M=x<=1?0:C/(x-1),[I,D]=x<=1?[(u-l*y)/(l-1),(h-y)/2]:[0,0];return r.map((U,Z)=>{const[G,W,$,J]=lr(U),nt=n==="col"?Z%m:Math.floor(Z/x),dt=n==="col"?Math.floor(Z/m):Z%x,Et=nt*y,Pt=(x-dt-1)*y+C,Ht=(y-e)/$,Ct=(y-e)/J,Ft=Et-G+I*nt+1/2*e,jt=Pt-W-M*dt-D+1/2*e;return`translate(${Ft}, ${jt}) scale(${Ht}, ${Ct})`})}}const Ik=t=>(e,n)=>[e,ti({},n,{modifier:WX(t),axis:!1})];Ik.props={};function XX(t,e,n,r){const i=t.length;if(r>=i||r===0)return t;const s=T=>e[t[T]]*1,l=T=>n[t[T]]*1,u=[],h=(i-2)/(r-2);let p=0,m,y,x;u.push(p);for(let T=0;T<r-2;T++){let C=0,M=0,I=Math.floor((T+1)*h)+1,D=Math.floor((T+2)*h)+1;D=Math.min(D,i);const U=D-I;for(;I<D;I++)C+=s(I),M+=l(I);C/=U,M/=U;let Z=Math.floor((T+0)*h)+1;const G=Math.floor((T+1)*h)+1,W=[s(p),l(p)];for(m=y=-1;Z<G;Z++)y=Math.abs((W[0]-C)*(s(Z)-W[1])-(W[0]-l(Z))*(M-W[0]))*.5,y>m&&(m=y,x=Z);u.push(x),p=x}return u.push(i-1),u.map(T=>t[T])}function YX(t){if(typeof t=="function")return t;if(t==="lttb")return XX;const e={first:r=>[r[0]],last:r=>[r[r.length-1]],min:(r,i,s)=>[r[Qb(r,l=>s[l])]],max:(r,i,s)=>[r[A1(r,l=>s[l])]],median:(r,i,s)=>[r[mX(r,l=>s[l])]]},n=e[t]||e.median;return(r,i,s,l)=>{const u=Math.max(1,Math.floor(r.length/l));return qX(r,u).flatMap(p=>n(p,i,s))}}function qX(t,e){const n=t.length,r=[];let i=0;for(;i<n;)r.push(t.slice(i,i+=e));return r}const Lk=(t={})=>{const{strategy:e="median",thresholds:n=2e3,groupBy:r=["series","color"]}=t,i=YX(e);return(s,l)=>{const{encode:u}=l,h=qg(r,s,l),[p]=nl(u,"x"),[m]=nl(u,"y");return[h.flatMap(y=>i(y,p,m,n)),l]}};Lk.props={};function $X(t){return typeof t=="object"?[t.value,t.ordinal]:[t,!0]}function KX(t){var e;const{encode:n}=t,r=Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),{y:Object.assign(Object.assign({},t.encode.y),{value:[]})})}),i=(e=n==null?void 0:n.color)===null||e===void 0?void 0:e.field;if(!n||!i)return r;let s;for(const[l,u]of Object.entries(n))(l==="x"||l==="y")&&u.field===i&&(s=Object.assign(Object.assign({},s),{[l]:Object.assign(Object.assign({},u),{value:[]})}));return s?Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),s)}):r}const Dk=(t={})=>(e,n)=>{const{encode:r,data:i}=n,s=Object.entries(t).map(([m,y])=>{const[x]=nl(r,m);if(!x)return null;const[T,C=!0]=$X(y);if(typeof T=="function")return M=>T(x[M]);if(C){const M=Array.isArray(T)?T:[T];return M.length===0?null:I=>M.includes(x[I])}else{const[M,I]=T;return D=>x[D]>=M&&x[D]<=I}}).filter(Ql),l=m=>s.every(y=>y(m)),u=e.filter(l),h=u.map((m,y)=>y);if(s.length===0){const m=KX(n);return[e,m]}const p=Object.entries(r).map(([m,y])=>[m,Object.assign(Object.assign({},y),{value:h.map(x=>y.value[u[x]]).filter(x=>x!==void 0)})]);return[h,ti({},n,{encode:Object.fromEntries(p),data:u.map(m=>i[m])})]};Dk.props={};var Nk={},pR={},mR=34,o2=10,vR=13;function kk(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function QX(t,e){var n=kk(t);return function(r,i){return e(n(r),i,t)}}function Bk(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function pp(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function JX(t){return t<0?"-"+pp(-t,6):t>9999?"+"+pp(t,6):pp(t,4)}function tY(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":JX(t.getUTCFullYear(),4)+"-"+pp(t.getUTCMonth()+1,2)+"-"+pp(t.getUTCDate(),2)+(i?"T"+pp(e,2)+":"+pp(n,2)+":"+pp(r,2)+"."+pp(i,3)+"Z":r?"T"+pp(e,2)+":"+pp(n,2)+":"+pp(r,2)+"Z":n||e?"T"+pp(e,2)+":"+pp(n,2)+"Z":"")}function eY(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(y,x){var T,C,M=i(y,function(I,D){if(T)return T(I,D-1);C=I,T=x?QX(I,x):kk(I)});return M.columns=C||[],M}function i(y,x){var T=[],C=y.length,M=0,I=0,D,U=C<=0,Z=!1;y.charCodeAt(C-1)===o2&&--C,y.charCodeAt(C-1)===vR&&--C;function G(){if(U)return pR;if(Z)return Z=!1,Nk;var $,J=M,nt;if(y.charCodeAt(J)===mR){for(;M++<C&&y.charCodeAt(M)!==mR||y.charCodeAt(++M)===mR;);return($=M)>=C?U=!0:(nt=y.charCodeAt(M++))===o2?Z=!0:nt===vR&&(Z=!0,y.charCodeAt(M)===o2&&++M),y.slice(J+1,$-1).replace(/""/g,'"')}for(;M<C;){if((nt=y.charCodeAt($=M++))===o2)Z=!0;else if(nt===vR)Z=!0,y.charCodeAt(M)===o2&&++M;else if(nt!==n)continue;return y.slice(J,$)}return U=!0,y.slice(J,C)}for(;(D=G())!==pR;){for(var W=[];D!==Nk&&D!==pR;)W.push(D),D=G();x&&(W=x(W,I++))==null||T.push(W)}return T}function s(y,x){return y.map(function(T){return x.map(function(C){return m(T[C])}).join(t)})}function l(y,x){return x==null&&(x=Bk(y)),[x.map(m).join(t)].concat(s(y,x)).join(`
`)}function u(y,x){return x==null&&(x=Bk(y)),s(y,x).join(`
`)}function h(y){return y.map(p).join(`
`)}function p(y){return y.map(m).join(t)}function m(y){return y==null?"":y instanceof Date?tY(y):e.test(y+="")?'"'+y.replace(/"/g,'""')+'"':y}return{parse:r,parseRows:i,format:l,formatBody:u,formatRows:h,formatRow:p,formatValue:m}}function nY(t){for(var e in t){var n=t[e].trim(),r,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))rY&&i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;t[e]=n}return t}const rY=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var iY=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};const Fk=t=>{const{value:e,format:n=e.split(".").pop(),delimiter:r=",",autoType:i=!0}=t;return()=>iY(void 0,void 0,void 0,function*(){const s=yield fetch(e);if(n==="csv"){const l=yield s.text();return eY(r).parse(l,i?nY:Ev)}else if(n==="json")return yield s.json();throw new Error(`Unknown format: ${n}.`)})};Fk.props={};const Uk=t=>{const{value:e}=t;return()=>e};Uk.props={};function oY(t,e){return t.map(n=>{if(Array.isArray(n)){const[r,i=e]=n;return[r,i]}return[n,e]})}const zk=t=>{const{fields:e=[]}=t,n=oY(e,!0);return r=>{const i=(s,l)=>n.reduce((u,[h,p=!0])=>u!==0?u:p?s[h]<l[h]?-1:+(s[h]!==l[h]):s[h]>l[h]?-1:+(s[h]!==l[h]),0);return[...r].sort(i)}};zk.props={};function Wet(t){return t!=null&&!Number.isNaN(t)}const jk=t=>{const{callback:e}=t;return n=>Array.isArray(n)?[...n].sort(e):n};jk.props={};function aY(t){return t!=null&&!Number.isNaN(t)}const Vk=t=>{const{callback:e=aY}=t;return n=>n.filter(e)};Vk.props={};function sY(t,e=[]){return e.reduce((n,r)=>(r in t&&(n[r]=t[r]),n),{})}const Zk=t=>{const{fields:e}=t;return n=>n.map(r=>sY(r,e))};Zk.props={};function lY(t){return Object.keys(t).length===0}const Hk=t=>e=>{if(!t||lY(t))return e;const n=r=>Object.entries(r).reduce((i,[s,l])=>(i[t[s]||s]=l,i),{});return e.map(n)};Hk.props={};function cY(t){return!t||Object.keys(t).length===0}const Gk=t=>{const{fields:e,key:n="key",value:r="value"}=t;return i=>cY(e)?i:i.flatMap(s=>e.map(l=>Object.assign(Object.assign({},s),{[n]:l,[r]:s[l]})))};Gk.props={};const Wk=t=>{const{start:e,end:n}=t;return r=>r.slice(e,n)};Wk.props={};const Xk=t=>{const{callback:e=Ev}=t;return n=>e(n)};Xk.props={};const Yk=t=>{const{callback:e=Ev}=t;return n=>Array.isArray(n)?n.map(e):n};Yk.props={};function qk(t){return typeof t=="string"?e=>e[t]:t}const $k=t=>{const{join:e,on:n,select:r=[],as:i=r,unknown:s=NaN}=t,[l,u]=n,h=qk(u),p=qk(l),m=G_(e,([y])=>y,y=>h(y));return y=>y.map(x=>{const T=m.get(p(x));return Object.assign(Object.assign({},x),r.reduce((C,M,I)=>(C[i[I]]=T?T[M]:s,C),{}))})};$k.props={};var uY=it(53843),fY=it.n(uY);function Xet(t){return t!=null&&!Number.isNaN(t)}const Kk=t=>{const{field:e,groupBy:n,as:r=["y","size"],min:i,max:s,size:l=10,width:u}=t,[h,p]=r;return m=>Array.from(vc(m,x=>n.map(T=>x[T]).join("-")).values()).map(x=>{const T=fY().create(x.map(I=>I[e]),{min:i,max:s,size:l,width:u}),C=T.map(I=>I.x),M=T.map(I=>I.y);return Object.assign(Object.assign({},x[0]),{[h]:C,[p]:M})})};Kk.props={};const Qk=()=>t=>(console.log("G2 data section:",t),t);Qk.props={};var hY=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})};function dY(t,e){return{set(n,r,i){if(e[n]===void 0)return this;const s=r?r.call(null,e[n]):e[n];return i?i.call(null,s):typeof t[n]=="function"?t[n](s):t[n]=s,this},setAsync(n,r,i){return hY(this,void 0,void 0,function*(){if(e[n]===void 0)return this;const s=r?yield r.call(null,e[n]):e[n];return i?i.call(null,s):typeof t[n]=="function"?t[n](s):t[n]=s,this})}}}const gR=Math.PI/180,a2=64,FT=2048;function pY(t){return t.text}function mY(){return"serif"}function Jk(){return"normal"}function vY(t){return t.value}function gY(){return~~(Math.random()*2)*90}function yY(){return 1}function _Y(){}function xY(t,e,n,r){if(e.sprite)return;const i=t.context,s=t.ratio;i.clearRect(0,0,(a2<<5)/s,FT/s);let l=0,u=0,h=0;const p=n.length;for(--r;++r<p;){e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/s)+"px "+e.font;let x=i.measureText(e.text+"m").width*s,T=e.size<<1;if(e.rotate){const C=Math.sin(e.rotate*gR),M=Math.cos(e.rotate*gR),I=x*M,D=x*C,U=T*M,Z=T*C;x=Math.max(Math.abs(I+Z),Math.abs(I-Z))+31>>5<<5,T=~~Math.max(Math.abs(D+U),Math.abs(D-U))}else x=x+31>>5<<5;if(T>h&&(h=T),l+x>=a2<<5&&(l=0,u+=h,h=0),u+T>=FT)break;i.translate((l+(x>>1))/s,(u+(T>>1))/s),e.rotate&&i.rotate(e.rotate*gR),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=x,e.height=T,e.xoff=l,e.yoff=u,e.x1=x>>1,e.y1=T>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,l+=x}const m=i.getImageData(0,0,(a2<<5)/s,FT/s).data,y=[];for(;--r>=0;){if(e=n[r],!e.hasText)continue;const x=e.width,T=x>>5;let C=e.y1-e.y0;for(let D=0;D<C*T;D++)y[D]=0;if(l=e.xoff,l==null)return;u=e.yoff;let M=0,I=-1;for(let D=0;D<C;D++){for(let U=0;U<x;U++){const Z=T*D+(U>>5),G=m[(u+D)*(a2<<5)+(l+U)<<2]?1<<31-U%32:0;y[Z]|=G,M|=G}M?I=D:(e.y0++,C--,D--,u++)}e.y1=e.y0+I,e.sprite=y.slice(0,(e.y1-e.y0)*T)}}function bY(t,e,n){n>>=5;const r=t.sprite,i=t.width>>5,s=t.x-(i<<4),l=s&127,u=32-l,h=t.y1-t.y0;let p=(t.y+t.y0)*n+(s>>5),m;for(let y=0;y<h;y++){m=0;for(let x=0;x<=i;x++)if((m<<u|(x<i?(m=r[y*i+x])>>>l:0))&e[p+x])return!0;p+=n}return!1}function EY(t,e){const n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function SY(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function tB(t){const e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function TY(t){const n=4*t[0]/t[1];let r=0,i=0;return function(s){const l=s<0?-1:1;switch(Math.sqrt(1+4*l*s)-l&3){case 0:r+=n;break;case 1:i+=4;break;case 2:r-=n;break;default:i-=4;break}return[r,i]}}function eB(t){const e=[];let n=-1;for(;++n<t;)e[n]=0;return e}function wY(){return document.createElement("canvas")}function zv(t){return typeof t=="function"?t:function(){return t}}const AY={archimedean:tB,rectangular:TY};function OY(){let t=[256,256],e=pY,n=mY,r=vY,i=Jk,s=gY,l=yY,u=tB,h=Math.random,p=_Y,m=[],y=null,x=1/0,T=wY;const C=Jk,M={};M.start=function(){const[U,Z]=t,G=I(T()),W=M.board?M.board:eB((t[0]>>5)*t[1]),$=m.length,J=[],nt=m.map(function(Ht,Ct,Ft){return Ht.text=e.call(this,Ht,Ct,Ft),Ht.font=n.call(this,Ht,Ct,Ft),Ht.style=C.call(this,Ht,Ct,Ft),Ht.weight=i.call(this,Ht,Ct,Ft),Ht.rotate=s.call(this,Ht,Ct,Ft),Ht.size=~~r.call(this,Ht,Ct,Ft),Ht.padding=l.call(this,Ht,Ct,Ft),Ht}).sort(function(Ht,Ct){return Ct.size-Ht.size});let dt=-1,Et=M.board?[{x:0,y:0},{x:U,y:Z}]:void 0;y&&clearInterval(y),y=setInterval(Pt,0),Pt();function Pt(){const Ht=Date.now();for(;Date.now()-Ht<x&&++dt<$;){const Ct=nt[dt];Ct.x=U*(h()+.5)>>1,Ct.y=Z*(h()+.5)>>1,xY(G,Ct,nt,dt),Ct.hasText&&D(W,Ct,Et)&&(p.call(null,"word",{cloud:M,word:Ct}),J.push(Ct),Et?M.hasImage||EY(Et,Ct):Et=[{x:Ct.x+Ct.x0,y:Ct.y+Ct.y0},{x:Ct.x+Ct.x1,y:Ct.y+Ct.y1}],Ct.x-=t[0]>>1,Ct.y-=t[1]>>1)}M._tags=J,M._bounds=Et,dt>=$&&(M.stop(),p.call(null,"end",{cloud:M,words:J,bounds:Et}))}return M},M.stop=function(){return y&&(clearInterval(y),y=null),M};function I(U){U.width=U.height=1;const Z=Math.sqrt(U.getContext("2d").getImageData(0,0,1,1).data.length>>2);U.width=(a2<<5)/Z,U.height=FT/Z;const G=U.getContext("2d");return G.fillStyle=G.strokeStyle="red",G.textAlign="center",G.textBaseline="middle",{context:G,ratio:Z}}function D(U,Z,G){const W=Z.x,$=Z.y,J=Math.sqrt(t[0]*t[0]+t[1]*t[1]),nt=u(t),dt=h()<.5?1:-1;let Et,Pt=-dt,Ht,Ct;for(;(Et=nt(Pt+=dt))&&(Ht=~~Et[0],Ct=~~Et[1],!(Math.min(Math.abs(Ht),Math.abs(Ct))>=J));)if(Z.x=W+Ht,Z.y=$+Ct,!(Z.x+Z.x0<0||Z.y+Z.y0<0||Z.x+Z.x1>t[0]||Z.y+Z.y1>t[1])&&(!G||!bY(Z,U,t[0]))&&(!G||SY(Z,G))){const Ft=Z.sprite,jt=Z.width>>5,qt=t[0]>>5,Ee=Z.x-(jt<<4),oe=Ee&127,_e=32-oe,hn=Z.y1-Z.y0;let Dn,Kn=(Z.y+Z.y0)*qt+(Ee>>5);for(let Jn=0;Jn<hn;Jn++){Dn=0;for(let zr=0;zr<=jt;zr++)U[Kn+zr]|=Dn<<_e|(zr<jt?(Dn=Ft[Jn*jt+zr])>>>oe:0);Kn+=qt}return delete Z.sprite,!0}return!1}return M.createMask=U=>{const Z=document.createElement("canvas"),[G,W]=t;if(!G||!W)return;const $=G>>5,J=eB((G>>5)*W);Z.width=G,Z.height=W;const nt=Z.getContext("2d");nt.drawImage(U,0,0,U.width,U.height,0,0,G,W);const dt=nt.getImageData(0,0,G,W).data;for(let Et=0;Et<W;Et++)for(let Pt=0;Pt<G;Pt++){const Ht=$*Et+(Pt>>5),Ct=Et*G+Pt<<2,jt=dt[Ct]>=250&&dt[Ct+1]>=250&&dt[Ct+2]>=250?1<<31-Pt%32:0;J[Ht]|=jt}M.board=J,M.hasImage=!0},M.timeInterval=function(U){x=U==null?1/0:U},M.words=function(U){m=U},M.size=function(U=[]){t=[+U[0],+U[1]]},M.text=function(U){e=zv(U)},M.font=function(U){n=zv(U)},M.fontWeight=function(U){i=zv(U)},M.rotate=function(U){s=zv(U)},M.canvas=function(U){T=zv(U)},M.spiral=function(U){u=AY[U]||U},M.fontSize=function(U){r=zv(U)},M.padding=function(U){l=zv(U)},M.random=function(U){h=zv(U)},M.on=function(U){p=zv(U)},M}var CY=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(t,e||[])).next())})},RY=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const MY={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function PY(t){return new Promise((e,n)=>{if(t instanceof HTMLImageElement){e(t);return}if(typeof t=="string"){const r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=()=>e(r),r.onerror=()=>{console.error(`'image ${t} load failed !!!'`),n()};return}n()})}function IY(t,e){if(typeof t=="function")return t;if(Array.isArray(t)){const[n,r]=t;if(!e)return()=>(r+n)/2;const[i,s]=e;return s===i?()=>(r+n)/2:({value:l})=>(r-n)/(s-i)*(l-i)+n}return()=>t}const nB=(t,e)=>n=>CY(void 0,void 0,void 0,function*(){const r=Object.assign({},MY,t,{canvas:e.createCanvas}),i=OY();yield dY(i,r).set("fontSize",U=>{const Z=n.map(G=>G.value);return IY(U,[Hp(Z),El(Z)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",PY,i.createMask),i.words([...n]);const s=i.start(),[l,u]=r.size,h=[{x:0,y:0},{x:l,y:u}],{_bounds:p=h,_tags:m,hasImage:y}=s,x=m.map(U=>{var{x:Z,y:G,font:W}=U,$=RY(U,["x","y","font"]);return Object.assign(Object.assign({},$),{x:Z+l/2,y:G+u/2,fontFamily:W})}),[{x:T,y:C},{x:M,y:I}]=p,D={text:"",value:0,opacity:0,fontSize:0};return x.push(Object.assign(Object.assign({},D),{x:y?0:T,y:y?0:C}),Object.assign(Object.assign({},D),{x:y?l:M,y:y?u:I})),x});nB.props={};function yR(t){const{min:e,max:n}=t;return[[e[0],e[1]],[n[0],n[1]]]}function rB(t,e){const[n,r]=t,[i,s]=e;return n>=i[0]&&n<=s[0]&&r>=i[1]&&r<=s[1]}function LY(t,e){const[n,r]=t;return!(rB(n,e)&&rB(r,e))}function DY(t,e){const[n,r]=t,[i,s]=e;return n[0]<s[0]&&r[0]>i[0]&&n[1]<s[1]&&r[1]>i[1]}const NY=t=>{const{priority:e}=t;return n=>{const r=[];return e&&n.sort(e),n.forEach(i=>{FS(i);const s=i.getLocalBounds();r.some(u=>DY(yR(s),yR(u.getLocalBounds())))?EO(i):r.push(i)}),n}};function kY([t,e],[n,r]){return r>t&&e>n}function UT(){const t=new Map;return[r=>t.get(r),(r,i)=>t.set(r,i)]}function BY(t){const e=t.cloneNode(!0),n=e.getElementById("connector");n&&e.removeChild(n);const{min:r,max:i}=e.getRenderBounds();return e.destroy(),{min:r,max:i}}const FY=t=>{const{maxIterations:e=10,maxError:n=.1,padding:r=1}=t;return i=>{const s=i.length;if(s<=1)return i;const[l,u]=UT(),[h,p]=UT(),[m,y]=UT(),[x,T]=UT();for(const C of i){const{min:M,max:I}=BY(C),[D,U]=M,[Z,G]=I;u(C,U),p(C,U),y(C,G-U),T(C,[D,Z])}for(let C=0;C<e;C++){i.sort((I,D)=>Tu(h(I),h(D)));let M=0;for(let I=0;I<s-1;I++){const D=i[I];let U=I+1,Z;for(;(Z=i[U])&&!kY(x(D),x(Z));)U+=1;if(Z){const G=h(D),W=m(D),$=h(Z),J=$-(G+W);if(J<r){const nt=(r-J)/2;M=Math.max(M,nt),p(D,G-nt),p(Z,$+nt)}}}if(M<n)break}for(const C of i)C.style.y+=h(C)-l(C);return i}},UY=()=>t=>(t.forEach(e=>{FS(e);const n=e.attr("bounds"),r=e.getLocalBounds();LY(yR(r),n)&&EO(e)}),t);function zY(t){return typeof t=="object"?t:$h(t)}function _R(t){let e=t/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),e}function iB(t,e,n){return .2126*_R(t)+.7152*_R(e)+.0722*_R(n)}function oB(t,e){const{r:n,g:r,b:i}=t,{r:s,g:l,b:u}=e,h=iB(n,r,i),p=iB(s,l,u);return(Math.max(h,p)+.05)/(Math.min(h,p)+.05)}function jY(t,e){const n=A1(e,r=>oB(t,zY(r)));return e[n]}const VY=t=>{const{threshold:e=4.5,palette:n=["#000","#fff"]}=t;return r=>(r.forEach(i=>{const s=i.attr("dependentElement").parsedStyle.fill,l=i.parsedStyle.fill;oB(l,s)<e&&i.attr("fill",jY(s,n))}),r)},ZY=(t,e)=>{const[[n,r],[i,s]]=e,[[l,u],[h,p]]=t;let m=0,y=0;return l<n?m=n-l:h>i&&(m=i-h),u<r?y=r-u:p>s&&(y=s-p),[m,y]},HY=()=>(t,{canvas:e})=>{const{width:n,height:r}=e.getConfig();return t.forEach(i=>{FS(i);const{max:s,min:l}=i.getRenderBounds(),[u,h]=s,[p,m]=l,y=ZY([[p,m],[u,h]],[[0,0],[n,r]]);i.style.connector&&i.style.connectorPoints&&(i.style.connectorPoints[0][0]-=y[0],i.style.connectorPoints[0][1]-=y[1]),i.style.x+=y[0],i.style.y+=y[1]}),t};function GY(){return{"data.fetch":Fk,"data.inline":Uk,"data.sortBy":zk,"data.sort":jk,"data.filter":Vk,"data.pick":Zk,"data.rename":Hk,"data.fold":Gk,"data.slice":Wk,"data.custom":Xk,"data.map":Yk,"data.join":$k,"data.kde":Kk,"data.log":Qk,"data.wordCloud":nB,"transform.stackY":sk,"transform.binX":hk,"transform.bin":dR,"transform.dodgeX":dk,"transform.jitter":pk,"transform.jitterX":mk,"transform.jitterY":vk,"transform.symmetryY":gk,"transform.diffY":yk,"transform.stackEnter":_k,"transform.normalizeY":xk,"transform.select":kT,"transform.selectX":Ek,"transform.selectY":Sk,"transform.groupX":Tk,"transform.groupY":wk,"transform.groupColor":Ak,"transform.group":i2,"transform.sortX":Ck,"transform.sortY":Rk,"transform.sortColor":Mk,"transform.flexX":Pk,"transform.pack":Ik,"transform.sample":Lk,"transform.filter":Dk,"coordinate.cartesian":t4,"coordinate.polar":Ry,"coordinate.transpose":JO,"coordinate.theta":e4,"coordinate.parallel":tC,"coordinate.fisheye":n4,"coordinate.radial":Bx,"coordinate.radar":r4,"encode.constant":i4,"encode.field":o4,"encode.transform":a4,"encode.column":s4,"mark.interval":m4,"mark.rect":g4,"mark.line":Z4,"mark.point":pL,"mark.text":xL,"mark.cell":EL,"mark.area":ML,"mark.link":yC,"mark.image":HL,"mark.polygon":qL,"mark.box":JL,"mark.vector":eD,"mark.lineX":oD,"mark.lineY":lD,"mark.connector":hD,"mark.range":mD,"mark.rangeX":yD,"mark.rangeY":bD,"mark.path":AD,"mark.shape":RD,"mark.density":ID,"mark.heatmap":kD,"mark.wordCloud":EC,"palette.category10":BD,"palette.category20":FD,"scale.linear":UD,"scale.ordinal":ZD,"scale.band":WD,"scale.identity":XD,"scale.point":YD,"scale.time":vN,"scale.log":yN,"scale.pow":_N,"scale.sqrt":xN,"scale.threshold":bN,"scale.quantile":EN,"scale.quantize":SN,"scale.sequential":TN,"scale.constant":wN,"theme.classic":AN,"theme.classicDark":CN,"theme.academy":RN,"theme.light":IC,"theme.dark":ON,"component.axisX":MN,"component.axisY":PN,"component.legendCategory":DC,"component.legendContinuous":fp,"component.legends":LN,"component.title":NN,"component.sliderX":UN,"component.sliderY":zN,"component.scrollbarX":jN,"component.scrollbarY":VN,"animation.scaleInX":FC,"animation.scaleOutX":kH,"animation.scaleInY":ZN,"animation.scaleOutY":BH,"animation.waveIn":HN,"animation.fadeIn":GN,"animation.fadeOut":WN,"animation.zoomIn":FH,"animation.zoomOut":UH,"animation.pathIn":XN,"animation.morphing":KN,"animation.growInX":QN,"animation.growInY":JN,"interaction.elementHighlight":TT,"interaction.elementHighlightByX":t6,"interaction.elementHighlightByColor":e6,"interaction.elementSelect":wT,"interaction.elementSelectByX":n6,"interaction.elementSelectByColor":r6,"interaction.fisheye":eG,"interaction.chartIndex":i6,"interaction.tooltip":_6,"interaction.legendFilter":CG,"interaction.legendHighlight":RG,"interaction.brushHighlight":XC,"interaction.brushXHighlight":NG,"interaction.brushYHighlight":kG,"interaction.brushAxisHighlight":GG,"interaction.brushFilter":KC,"interaction.brushXFilter":qG,"interaction.brushYFilter":$G,"interaction.sliderFilter":I6,"interaction.scrollbarFilter":eW,"interaction.poptip":N6,"interaction.treemapDrillDown":EW,"interaction.elementPointMove":CW,"composition.spaceLayer":$6,"composition.spaceFlex":K6,"composition.facetRect":ek,"composition.repeatMatrix":jW,"composition.facetCircle":XW,"composition.timingKeyframe":rk,"labelTransform.overlapHide":NY,"labelTransform.overlapDodgeY":FY,"labelTransform.overflowHide":UY,"labelTransform.contrastReverse":VY,"labelTransform.exceedAdjust":HY}}var s2=t=>t;function zT(t,e){t&&sB.hasOwnProperty(t.type)&&sB[t.type](t,e)}var aB={Feature:function(t,e){zT(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)zT(n[r].geometry,e)}},sB={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){xR(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)xR(n[r],e,0)},Polygon:function(t,e){lB(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)lB(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)zT(n[r],e)}};function xR(t,e,n){var r=-1,i=t.length-n,s;for(e.lineStart();++r<i;)s=t[r],e.point(s[0],s[1],s[2]);e.lineEnd()}function lB(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)xR(t[n],e,1);e.polygonEnd()}function W1(t,e){t&&aB.hasOwnProperty(t.type)?aB[t.type](t,e):zT(t,e)}class jv{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],l=e+s,u=Math.abs(e)<Math.abs(s)?e-(l-s):s-(l-e);u&&(n[r++]=u),e=l}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,s,l=0;if(n>0){for(l=e[--n];n>0&&(r=l,i=e[--n],l=r+i,s=i-(l-r),!s););n>0&&(s<0&&e[n-1]<0||s>0&&e[n-1]>0)&&(i=s*2,r=l+i,i==r-l&&(l=r))}return l}}function Yet(t,e){const n=new jv;if(e===void 0)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&n.add(i)}return+n}function qet(t,e){const n=new jv;let r=-1;return Float64Array.from(t,e===void 0?i=>n.add(+i||0):i=>n.add(+e(i,++r,t)||0))}var Wa=1e-6,cB=1e-12,Ys=Math.PI,ef=Ys/2,uB=Ys/4,Wp=Ys*2,pd=180/Ys,wu=Ys/180,Il=Math.abs,X1=Math.atan,Vv=Math.atan2,zs=Math.cos,jT=Math.ceil,fB=Math.exp,$et=Math.floor,Ket=Math.hypot,VT=Math.log,bR=Math.pow,bs=Math.sin,O0=Math.sign||function(t){return t>0?1:t<0?-1:0},mp=Math.sqrt,ER=Math.tan;function hB(t){return t>1?0:t<-1?Ys:Math.acos(t)}function C0(t){return t>1?ef:t<-1?-ef:Math.asin(t)}function Qet(t){return(t=bs(t/2))*t}function R0(){}var SR=new jv,TR=new jv,dB,pB,wR,AR,Kg={point:R0,lineStart:R0,lineEnd:R0,polygonStart:function(){Kg.lineStart=WY,Kg.lineEnd=YY},polygonEnd:function(){Kg.lineStart=Kg.lineEnd=Kg.point=R0,SR.add(Il(TR)),TR=new jv},result:function(){var t=SR/2;return SR=new jv,t}};function WY(){Kg.point=XY}function XY(t,e){Kg.point=mB,dB=wR=t,pB=AR=e}function mB(t,e){TR.add(AR*t-wR*e),wR=t,AR=e}function YY(){mB(dB,pB)}var vB=Kg,Y1=1/0,ZT=Y1,l2=-Y1,HT=l2,qY={point:$Y,lineStart:R0,lineEnd:R0,polygonStart:R0,polygonEnd:R0,result:function(){var t=[[Y1,ZT],[l2,HT]];return l2=HT=-(ZT=Y1=1/0),t}};function $Y(t,e){t<Y1&&(Y1=t),t>l2&&(l2=t),e<ZT&&(ZT=e),e>HT&&(HT=e)}var GT=qY,OR=0,CR=0,c2=0,WT=0,XT=0,q1=0,RR=0,MR=0,u2=0,gB,yB,$m,Km,im={point:b_,lineStart:_B,lineEnd:xB,polygonStart:function(){im.lineStart=JY,im.lineEnd=tq},polygonEnd:function(){im.point=b_,im.lineStart=_B,im.lineEnd=xB},result:function(){var t=u2?[RR/u2,MR/u2]:q1?[WT/q1,XT/q1]:c2?[OR/c2,CR/c2]:[NaN,NaN];return OR=CR=c2=WT=XT=q1=RR=MR=u2=0,t}};function b_(t,e){OR+=t,CR+=e,++c2}function _B(){im.point=KY}function KY(t,e){im.point=QY,b_($m=t,Km=e)}function QY(t,e){var n=t-$m,r=e-Km,i=mp(n*n+r*r);WT+=i*($m+t)/2,XT+=i*(Km+e)/2,q1+=i,b_($m=t,Km=e)}function xB(){im.point=b_}function JY(){im.point=eq}function tq(){bB(gB,yB)}function eq(t,e){im.point=bB,b_(gB=$m=t,yB=Km=e)}function bB(t,e){var n=t-$m,r=e-Km,i=mp(n*n+r*r);WT+=i*($m+t)/2,XT+=i*(Km+e)/2,q1+=i,i=Km*t-$m*e,RR+=i*($m+t),MR+=i*(Km+e),u2+=i*3,b_($m=t,Km=e)}var EB=im;function SB(t){this._context=t}SB.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Wp);break}}},result:R0};var PR=new jv,IR,TB,wB,f2,h2,YT={point:R0,lineStart:function(){YT.point=nq},lineEnd:function(){IR&&AB(TB,wB),YT.point=R0},polygonStart:function(){IR=!0},polygonEnd:function(){IR=null},result:function(){var t=+PR;return PR=new jv,t}};function nq(t,e){YT.point=AB,TB=f2=t,wB=h2=e}function AB(t,e){f2-=t,h2-=e,PR.add(mp(f2*f2+h2*h2)),f2=t,h2=e}var OB=YT;let CB,qT,RB,MB;class PB{constructor(e){this._append=e==null?IB:rq(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==RB||this._append!==qT){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,RB=r,qT=this._append,MB=this._,this._=i}this._+=MB;break}}}result(){const e=this._;return this._="",e.length?e:null}}function IB(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function rq(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return IB;if(e!==CB){const n=vf(10,e);CB=e,qT=function(i){let s=1;this._+=i[0];for(const l=i.length;s<l;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return qT}function LB(t,e){let n=3,r=4.5,i,s;function l(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),W1(u,i(s))),s.result()}return l.area=function(u){return W1(u,i(vB)),vB.result()},l.measure=function(u){return W1(u,i(OB)),OB.result()},l.bounds=function(u){return W1(u,i(GT)),GT.result()},l.centroid=function(u){return W1(u,i(EB)),EB.result()},l.projection=function(u){return arguments.length?(i=u==null?(t=null,s2):(t=u).stream,l):t},l.context=function(u){return arguments.length?(s=u==null?(e=null,new PB(n)):new SB(e=u),typeof r!="function"&&s.pointRadius(r),l):e},l.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),l):r},l.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const h=Math.floor(u);if(!(h>=0))throw new RangeError(`invalid digits: ${u}`);n=h}return e===null&&(s=new PB(n)),l},l.projection(t).digits(n).context(e)}function $1(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function DB(t,e,n){var r=$1(t,e-Wa,n).concat(e);return function(i){return r.map(function(s){return[i,s]})}}function NB(t,e,n){var r=$1(t,e-Wa,n).concat(e);return function(i){return r.map(function(s){return[s,i]})}}function iq(){var t,e,n,r,i,s,l,u,h=10,p=h,m=90,y=360,x,T,C,M,I=2.5;function D(){return{type:"MultiLineString",coordinates:U()}}function U(){return $1(jT(r/m)*m,n,m).map(C).concat($1(jT(u/y)*y,l,y).map(M)).concat($1(jT(e/h)*h,t,h).filter(function(Z){return Il(Z%m)>Wa}).map(x)).concat($1(jT(s/p)*p,i,p).filter(function(Z){return Il(Z%y)>Wa}).map(T))}return D.lines=function(){return U().map(function(Z){return{type:"LineString",coordinates:Z}})},D.outline=function(){return{type:"Polygon",coordinates:[C(r).concat(M(l).slice(1),C(n).reverse().slice(1),M(u).reverse().slice(1))]}},D.extent=function(Z){return arguments.length?D.extentMajor(Z).extentMinor(Z):D.extentMinor()},D.extentMajor=function(Z){return arguments.length?(r=+Z[0][0],n=+Z[1][0],u=+Z[0][1],l=+Z[1][1],r>n&&(Z=r,r=n,n=Z),u>l&&(Z=u,u=l,l=Z),D.precision(I)):[[r,u],[n,l]]},D.extentMinor=function(Z){return arguments.length?(e=+Z[0][0],t=+Z[1][0],s=+Z[0][1],i=+Z[1][1],e>t&&(Z=e,e=t,t=Z),s>i&&(Z=s,s=i,i=Z),D.precision(I)):[[e,s],[t,i]]},D.step=function(Z){return arguments.length?D.stepMajor(Z).stepMinor(Z):D.stepMinor()},D.stepMajor=function(Z){return arguments.length?(m=+Z[0],y=+Z[1],D):[m,y]},D.stepMinor=function(Z){return arguments.length?(h=+Z[0],p=+Z[1],D):[h,p]},D.precision=function(Z){return arguments.length?(I=+Z,x=DB(s,i,90),T=NB(e,t,I),C=DB(u,l,90),M=NB(r,n,I),D):I},D.extentMajor([[-180,-90+Wa],[180,90-Wa]]).extentMinor([[-180,-80-Wa],[180,80+Wa]])}function oq(){return iq()()}function kB(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:R0,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function $T(t,e){return Il(t[0]-e[0])<Wa&&Il(t[1]-e[1])<Wa}function KT(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function BB(t,e,n,r,i){var s=[],l=[],u,h;if(t.forEach(function(C){if(!((M=C.length-1)<=0)){var M,I=C[0],D=C[M],U;if($T(I,D)){if(!I[2]&&!D[2]){for(i.lineStart(),u=0;u<M;++u)i.point((I=C[u])[0],I[1]);i.lineEnd();return}D[0]+=2*Wa}s.push(U=new KT(I,C,null,!0)),l.push(U.o=new KT(I,null,U,!1)),s.push(U=new KT(D,C,null,!1)),l.push(U.o=new KT(D,null,U,!0))}}),!!s.length){for(l.sort(e),FB(s),FB(l),u=0,h=l.length;u<h;++u)l[u].e=n=!n;for(var p=s[0],m,y;;){for(var x=p,T=!0;x.v;)if((x=x.n)===p)return;m=x.z,i.lineStart();do{if(x.v=x.o.v=!0,x.e){if(T)for(u=0,h=m.length;u<h;++u)i.point((y=m[u])[0],y[1]);else r(x.x,x.n.x,1,i);x=x.n}else{if(T)for(m=x.p.z,u=m.length-1;u>=0;--u)i.point((y=m[u])[0],y[1]);else r(x.x,x.p.x,-1,i);x=x.p}x=x.o,m=x.z,T=!T}while(!x.v);i.lineEnd()}}}function FB(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function LR(t){return[Vv(t[1],t[0]),C0(t[2])]}function K1(t){var e=t[0],n=t[1],r=zs(n);return[r*zs(e),r*bs(e),bs(n)]}function QT(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function JT(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function DR(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function tw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function NR(t){var e=mp(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function kR(t){return Il(t[0])<=Ys?t[0]:O0(t[0])*((Il(t[0])+Ys)%Wp-Ys)}function aq(t,e){var n=kR(e),r=e[1],i=bs(r),s=[bs(n),-zs(n),0],l=0,u=0,h=new jv;i===1?r=ef+Wa:i===-1&&(r=-ef-Wa);for(var p=0,m=t.length;p<m;++p)if(x=(y=t[p]).length)for(var y,x,T=y[x-1],C=kR(T),M=T[1]/2+uB,I=bs(M),D=zs(M),U=0;U<x;++U,C=G,I=$,D=J,T=Z){var Z=y[U],G=kR(Z),W=Z[1]/2+uB,$=bs(W),J=zs(W),nt=G-C,dt=nt>=0?1:-1,Et=dt*nt,Pt=Et>Ys,Ht=I*$;if(h.add(Vv(Ht*dt*bs(Et),D*J+Ht*zs(Et))),l+=Pt?nt+dt*Wp:nt,Pt^C>=n^G>=n){var Ct=JT(K1(T),K1(Z));NR(Ct);var Ft=JT(s,Ct);NR(Ft);var jt=(Pt^nt>=0?-1:1)*C0(Ft[2]);(r>jt||r===jt&&(Ct[0]||Ct[1]))&&(u+=Pt^nt>=0?1:-1)}}return(l<-Wa||l<Wa&&h<-cB)^u&1}function*sq(t){for(const e of t)yield*S8(e)}function UB(t){return Array.from(sq(t))}function zB(t,e,n,r){return function(i){var s=e(i),l=kB(),u=e(l),h=!1,p,m,y,x={point:T,lineStart:M,lineEnd:I,polygonStart:function(){x.point=D,x.lineStart=U,x.lineEnd=Z,m=[],p=[]},polygonEnd:function(){x.point=T,x.lineStart=M,x.lineEnd=I,m=UB(m);var G=aq(p,r);m.length?(h||(i.polygonStart(),h=!0),BB(m,cq,G,n,i)):G&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),m=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function T(G,W){t(G,W)&&i.point(G,W)}function C(G,W){s.point(G,W)}function M(){x.point=C,s.lineStart()}function I(){x.point=T,s.lineEnd()}function D(G,W){y.push([G,W]),u.point(G,W)}function U(){u.lineStart(),y=[]}function Z(){D(y[0][0],y[0][1]),u.lineEnd();var G=u.clean(),W=l.result(),$,J=W.length,nt,dt,Et;if(y.pop(),p.push(y),y=null,!!J){if(G&1){if(dt=W[0],(nt=dt.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),$=0;$<nt;++$)i.point((Et=dt[$])[0],Et[1]);i.lineEnd()}return}J>1&&G&2&&W.push(W.pop().concat(W.shift())),m.push(W.filter(lq))}}return x}}function lq(t){return t.length>1}function cq(t,e){return((t=t.x)[0]<0?t[1]-ef-Wa:ef-t[1])-((e=e.x)[0]<0?e[1]-ef-Wa:ef-e[1])}var jB=zB(function(){return!0},uq,hq,[-Ys,-ef]);function uq(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(s,l){var u=s>0?Ys:-Ys,h=Il(s-e);Il(h-Ys)<Wa?(t.point(e,n=(n+l)/2>0?ef:-ef),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(s,n),i=0):r!==u&&h>=Ys&&(Il(e-r)<Wa&&(e-=r*Wa),Il(s-u)<Wa&&(s-=u*Wa),n=fq(e,n,s,l),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),i=0),t.point(e=s,n=l),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function fq(t,e,n,r){var i,s,l=bs(t-n);return Il(l)>Wa?X1((bs(e)*(s=zs(r))*bs(n)-bs(r)*(i=zs(e))*bs(t))/(i*s*l)):(e+r)/2}function hq(t,e,n,r){var i;if(t==null)i=n*ef,r.point(-Ys,i),r.point(0,i),r.point(Ys,i),r.point(Ys,0),r.point(Ys,-i),r.point(0,-i),r.point(-Ys,-i),r.point(-Ys,0),r.point(-Ys,i);else if(Il(t[0]-e[0])>Wa){var s=t[0]<e[0]?Ys:-Ys;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(e[0],e[1])}function VB(t,e,n,r,i,s){if(n){var l=zs(e),u=bs(e),h=r*n;i==null?(i=e+r*Wp,s=e-h/2):(i=ZB(l,i),s=ZB(l,s),(r>0?i<s:i>s)&&(i+=r*Wp));for(var p,m=i;r>0?m>s:m<s;m-=h)p=LR([l,-u*zs(m),-u*bs(m)]),t.point(p[0],p[1])}}function ZB(t,e){e=K1(e),e[0]-=t,NR(e);var n=hB(-e[1]);return((-e[2]<0?-n:n)+Wp-Wa)%Wp}function Jet(){var t=constant([0,0]),e=constant(90),n=constant(2),r,i,s={point:l};function l(h,p){r.push(h=i(h,p)),h[0]*=degrees,h[1]*=degrees}function u(){var h=t.apply(this,arguments),p=e.apply(this,arguments)*radians,m=n.apply(this,arguments)*radians;return r=[],i=rotateRadians(-h[0]*radians,-h[1]*radians,0).invert,VB(s,p,m,1),h={type:"Polygon",coordinates:[r]},r=i=null,h}return u.center=function(h){return arguments.length?(t=typeof h=="function"?h:constant([+h[0],+h[1]]),u):t},u.radius=function(h){return arguments.length?(e=typeof h=="function"?h:constant(+h),u):e},u.precision=function(h){return arguments.length?(n=typeof h=="function"?h:constant(+h),u):n},u}function dq(t){var e=zs(t),n=2*wu,r=e>0,i=Il(e)>Wa;function s(m,y,x,T){VB(T,t,n,x,m,y)}function l(m,y){return zs(m)*zs(y)>e}function u(m){var y,x,T,C,M;return{lineStart:function(){C=T=!1,M=1},point:function(I,D){var U=[I,D],Z,G=l(I,D),W=r?G?0:p(I,D):G?p(I+(I<0?Ys:-Ys),D):0;if(!y&&(C=T=G)&&m.lineStart(),G!==T&&(Z=h(y,U),(!Z||$T(y,Z)||$T(U,Z))&&(U[2]=1)),G!==T)M=0,G?(m.lineStart(),Z=h(U,y),m.point(Z[0],Z[1])):(Z=h(y,U),m.point(Z[0],Z[1],2),m.lineEnd()),y=Z;else if(i&&y&&r^G){var $;!(W&x)&&($=h(U,y,!0))&&(M=0,r?(m.lineStart(),m.point($[0][0],$[0][1]),m.point($[1][0],$[1][1]),m.lineEnd()):(m.point($[1][0],$[1][1]),m.lineEnd(),m.lineStart(),m.point($[0][0],$[0][1],3)))}G&&(!y||!$T(y,U))&&m.point(U[0],U[1]),y=U,T=G,x=W},lineEnd:function(){T&&m.lineEnd(),y=null},clean:function(){return M|(C&&T)<<1}}}function h(m,y,x){var T=K1(m),C=K1(y),M=[1,0,0],I=JT(T,C),D=QT(I,I),U=I[0],Z=D-U*U;if(!Z)return!x&&m;var G=e*D/Z,W=-e*U/Z,$=JT(M,I),J=tw(M,G),nt=tw(I,W);DR(J,nt);var dt=$,Et=QT(J,dt),Pt=QT(dt,dt),Ht=Et*Et-Pt*(QT(J,J)-1);if(!(Ht<0)){var Ct=mp(Ht),Ft=tw(dt,(-Et-Ct)/Pt);if(DR(Ft,J),Ft=LR(Ft),!x)return Ft;var jt=m[0],qt=y[0],Ee=m[1],oe=y[1],_e;qt<jt&&(_e=jt,jt=qt,qt=_e);var hn=qt-jt,Dn=Il(hn-Ys)<Wa,Kn=Dn||hn<Wa;if(!Dn&&oe<Ee&&(_e=Ee,Ee=oe,oe=_e),Kn?Dn?Ee+oe>0^Ft[1]<(Il(Ft[0]-jt)<Wa?Ee:oe):Ee<=Ft[1]&&Ft[1]<=oe:hn>Ys^(jt<=Ft[0]&&Ft[0]<=qt)){var Jn=tw(dt,(-Et+Ct)/Pt);return DR(Jn,J),[Ft,LR(Jn)]}}}function p(m,y){var x=r?t:Ys-t,T=0;return m<-x?T|=1:m>x&&(T|=2),y<-x?T|=4:y>x&&(T|=8),T}return zB(l,u,s,r?[0,-t]:[-Ys,t-Ys])}function pq(t,e,n,r,i,s){var l=t[0],u=t[1],h=e[0],p=e[1],m=0,y=1,x=h-l,T=p-u,C;if(C=n-l,!(!x&&C>0)){if(C/=x,x<0){if(C<m)return;C<y&&(y=C)}else if(x>0){if(C>y)return;C>m&&(m=C)}if(C=i-l,!(!x&&C<0)){if(C/=x,x<0){if(C>y)return;C>m&&(m=C)}else if(x>0){if(C<m)return;C<y&&(y=C)}if(C=r-u,!(!T&&C>0)){if(C/=T,T<0){if(C<m)return;C<y&&(y=C)}else if(T>0){if(C>y)return;C>m&&(m=C)}if(C=s-u,!(!T&&C<0)){if(C/=T,T<0){if(C>y)return;C>m&&(m=C)}else if(T>0){if(C<m)return;C<y&&(y=C)}return m>0&&(t[0]=l+m*x,t[1]=u+m*T),y<1&&(e[0]=l+y*x,e[1]=u+y*T),!0}}}}}var d2=1e9,ew=-d2;function HB(t,e,n,r){function i(p,m){return t<=p&&p<=n&&e<=m&&m<=r}function s(p,m,y,x){var T=0,C=0;if(p==null||(T=l(p,y))!==(C=l(m,y))||h(p,m)<0^y>0)do x.point(T===0||T===3?t:n,T>1?r:e);while((T=(T+y+4)%4)!==C);else x.point(m[0],m[1])}function l(p,m){return Il(p[0]-t)<Wa?m>0?0:3:Il(p[0]-n)<Wa?m>0?2:1:Il(p[1]-e)<Wa?m>0?1:0:m>0?3:2}function u(p,m){return h(p.x,m.x)}function h(p,m){var y=l(p,1),x=l(m,1);return y!==x?y-x:y===0?m[1]-p[1]:y===1?p[0]-m[0]:y===2?p[1]-m[1]:m[0]-p[0]}return function(p){var m=p,y=kB(),x,T,C,M,I,D,U,Z,G,W,$,J={point:nt,lineStart:Ht,lineEnd:Ct,polygonStart:Et,polygonEnd:Pt};function nt(jt,qt){i(jt,qt)&&m.point(jt,qt)}function dt(){for(var jt=0,qt=0,Ee=T.length;qt<Ee;++qt)for(var oe=T[qt],_e=1,hn=oe.length,Dn=oe[0],Kn,Jn,zr=Dn[0],ui=Dn[1];_e<hn;++_e)Kn=zr,Jn=ui,Dn=oe[_e],zr=Dn[0],ui=Dn[1],Jn<=r?ui>r&&(zr-Kn)*(r-Jn)>(ui-Jn)*(t-Kn)&&++jt:ui<=r&&(zr-Kn)*(r-Jn)<(ui-Jn)*(t-Kn)&&--jt;return jt}function Et(){m=y,x=[],T=[],$=!0}function Pt(){var jt=dt(),qt=$&&jt,Ee=(x=UB(x)).length;(qt||Ee)&&(p.polygonStart(),qt&&(p.lineStart(),s(null,null,1,p),p.lineEnd()),Ee&&BB(x,u,jt,s,p),p.polygonEnd()),m=p,x=T=C=null}function Ht(){J.point=Ft,T&&T.push(C=[]),W=!0,G=!1,U=Z=NaN}function Ct(){x&&(Ft(M,I),D&&G&&y.rejoin(),x.push(y.result())),J.point=nt,G&&m.lineEnd()}function Ft(jt,qt){var Ee=i(jt,qt);if(T&&C.push([jt,qt]),W)M=jt,I=qt,D=Ee,W=!1,Ee&&(m.lineStart(),m.point(jt,qt));else if(Ee&&G)m.point(jt,qt);else{var oe=[U=Math.max(ew,Math.min(d2,U)),Z=Math.max(ew,Math.min(d2,Z))],_e=[jt=Math.max(ew,Math.min(d2,jt)),qt=Math.max(ew,Math.min(d2,qt))];pq(oe,_e,t,e,n,r)?(G||(m.lineStart(),m.point(oe[0],oe[1])),m.point(_e[0],_e[1]),Ee||m.lineEnd(),$=!1):Ee&&(m.lineStart(),m.point(jt,qt),$=!1)}U=jt,Z=qt,G=Ee}return J}}function BR(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function FR(t,e){return Il(t)>Ys&&(t-=Math.round(t/Wp)*Wp),[t,e]}FR.invert=FR;function GB(t,e,n){return(t%=Wp)?e||n?BR(XB(t),YB(e,n)):XB(t):e||n?YB(e,n):FR}function WB(t){return function(e,n){return e+=t,Il(e)>Ys&&(e-=Math.round(e/Wp)*Wp),[e,n]}}function XB(t){var e=WB(t);return e.invert=WB(-t),e}function YB(t,e){var n=zs(t),r=bs(t),i=zs(e),s=bs(e);function l(u,h){var p=zs(h),m=zs(u)*p,y=bs(u)*p,x=bs(h),T=x*n+m*r;return[Vv(y*i-T*s,m*n-x*r),C0(T*i+y*s)]}return l.invert=function(u,h){var p=zs(h),m=zs(u)*p,y=bs(u)*p,x=bs(h),T=x*i-y*s;return[Vv(y*i+x*s,m*n+T*r),C0(T*n-m*r)]},l}function mq(t){t=GB(t[0]*wu,t[1]*wu,t.length>2?t[2]*wu:0);function e(n){return n=t(n[0]*wu,n[1]*wu),n[0]*=pd,n[1]*=pd,n}return e.invert=function(n){return n=t.invert(n[0]*wu,n[1]*wu),n[0]*=pd,n[1]*=pd,n},e}function tnt(t){return{stream:p2(t)}}function p2(t){return function(e){var n=new UR;for(var r in t)n[r]=t[r];return n.stream=e,n}}function UR(){}UR.prototype={constructor:UR,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function zR(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),W1(n,t.stream(GT)),e(GT.result()),r!=null&&t.clipExtent(r),t}function nw(t,e,n){return zR(t,function(r){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],l=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+e[0][0]+(i-l*(r[1][0]+r[0][0]))/2,h=+e[0][1]+(s-l*(r[1][1]+r[0][1]))/2;t.scale(150*l).translate([u,h])},n)}function jR(t,e,n){return nw(t,[[0,0],e],n)}function VR(t,e,n){return zR(t,function(r){var i=+e,s=i/(r[1][0]-r[0][0]),l=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];t.scale(150*s).translate([l,u])},n)}function ZR(t,e,n){return zR(t,function(r){var i=+e,s=i/(r[1][1]-r[0][1]),l=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;t.scale(150*s).translate([l,u])},n)}var qB=16,vq=zs(30*wu);function $B(t,e){return+e?yq(t,e):gq(t)}function gq(t){return p2({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function yq(t,e){function n(r,i,s,l,u,h,p,m,y,x,T,C,M,I){var D=p-r,U=m-i,Z=D*D+U*U;if(Z>4*e&&M--){var G=l+x,W=u+T,$=h+C,J=mp(G*G+W*W+$*$),nt=C0($/=J),dt=Il(Il($)-1)<Wa||Il(s-y)<Wa?(s+y)/2:Vv(W,G),Et=t(dt,nt),Pt=Et[0],Ht=Et[1],Ct=Pt-r,Ft=Ht-i,jt=U*Ct-D*Ft;(jt*jt/Z>e||Il((D*Ct+U*Ft)/Z-.5)>.3||l*x+u*T+h*C<vq)&&(n(r,i,s,l,u,h,Pt,Ht,dt,G/=J,W/=J,$,M,I),I.point(Pt,Ht),n(Pt,Ht,dt,G,W,$,p,m,y,x,T,C,M,I))}}return function(r){var i,s,l,u,h,p,m,y,x,T,C,M,I={point:D,lineStart:U,lineEnd:G,polygonStart:function(){r.polygonStart(),I.lineStart=W},polygonEnd:function(){r.polygonEnd(),I.lineStart=U}};function D(nt,dt){nt=t(nt,dt),r.point(nt[0],nt[1])}function U(){y=NaN,I.point=Z,r.lineStart()}function Z(nt,dt){var Et=K1([nt,dt]),Pt=t(nt,dt);n(y,x,m,T,C,M,y=Pt[0],x=Pt[1],m=nt,T=Et[0],C=Et[1],M=Et[2],qB,r),r.point(y,x)}function G(){I.point=D,r.lineEnd()}function W(){U(),I.point=$,I.lineEnd=J}function $(nt,dt){Z(i=nt,dt),s=y,l=x,u=T,h=C,p=M,I.point=Z}function J(){n(y,x,m,T,C,M,s,l,i,u,h,p,qB,r),I.lineEnd=G,G()}return I}}var _q=p2({point:function(t,e){this.stream.point(t*wu,e*wu)}});function xq(t){return p2({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function bq(t,e,n,r,i){function s(l,u){return l*=r,u*=i,[e+t*l,n-t*u]}return s.invert=function(l,u){return[(l-e)/t*r,(n-u)/t*i]},s}function KB(t,e,n,r,i,s){if(!s)return bq(t,e,n,r,i);var l=zs(s),u=bs(s),h=l*t,p=u*t,m=l/t,y=u/t,x=(u*n-l*e)/t,T=(u*e+l*n)/t;function C(M,I){return M*=r,I*=i,[h*M-p*I+e,n-p*M-h*I]}return C.invert=function(M,I){return[r*(m*M-y*I+x),i*(T-y*M-m*I)]},C}function Qm(t){return HR(function(){return t})()}function HR(t){var e,n=150,r=480,i=250,s=0,l=0,u=0,h=0,p=0,m,y=0,x=1,T=1,C=null,M=jB,I=null,D,U,Z,G=s2,W=.5,$,J,nt,dt,Et;function Pt(jt){return nt(jt[0]*wu,jt[1]*wu)}function Ht(jt){return jt=nt.invert(jt[0],jt[1]),jt&&[jt[0]*pd,jt[1]*pd]}Pt.stream=function(jt){return dt&&Et===jt?dt:dt=_q(xq(m)(M($(G(Et=jt)))))},Pt.preclip=function(jt){return arguments.length?(M=jt,C=void 0,Ft()):M},Pt.postclip=function(jt){return arguments.length?(G=jt,I=D=U=Z=null,Ft()):G},Pt.clipAngle=function(jt){return arguments.length?(M=+jt?dq(C=jt*wu):(C=null,jB),Ft()):C*pd},Pt.clipExtent=function(jt){return arguments.length?(G=jt==null?(I=D=U=Z=null,s2):HB(I=+jt[0][0],D=+jt[0][1],U=+jt[1][0],Z=+jt[1][1]),Ft()):I==null?null:[[I,D],[U,Z]]},Pt.scale=function(jt){return arguments.length?(n=+jt,Ct()):n},Pt.translate=function(jt){return arguments.length?(r=+jt[0],i=+jt[1],Ct()):[r,i]},Pt.center=function(jt){return arguments.length?(s=jt[0]%360*wu,l=jt[1]%360*wu,Ct()):[s*pd,l*pd]},Pt.rotate=function(jt){return arguments.length?(u=jt[0]%360*wu,h=jt[1]%360*wu,p=jt.length>2?jt[2]%360*wu:0,Ct()):[u*pd,h*pd,p*pd]},Pt.angle=function(jt){return arguments.length?(y=jt%360*wu,Ct()):y*pd},Pt.reflectX=function(jt){return arguments.length?(x=jt?-1:1,Ct()):x<0},Pt.reflectY=function(jt){return arguments.length?(T=jt?-1:1,Ct()):T<0},Pt.precision=function(jt){return arguments.length?($=$B(J,W=jt*jt),Ft()):mp(W)},Pt.fitExtent=function(jt,qt){return nw(Pt,jt,qt)},Pt.fitSize=function(jt,qt){return jR(Pt,jt,qt)},Pt.fitWidth=function(jt,qt){return VR(Pt,jt,qt)},Pt.fitHeight=function(jt,qt){return ZR(Pt,jt,qt)};function Ct(){var jt=KB(n,0,0,x,T,y).apply(null,e(s,l)),qt=KB(n,r-jt[0],i-jt[1],x,T,y);return m=GB(u,h,p),J=BR(e,qt),nt=BR(m,J),$=$B(J,W),Ft()}function Ft(){return dt=Et=null,Pt}return function(){return e=t.apply(this,arguments),Pt.invert=e.invert&&Ht,Ct()}}function GR(t){var e=0,n=Ys/3,r=HR(t),i=r(e,n);return i.parallels=function(s){return arguments.length?r(e=s[0]*wu,n=s[1]*wu):[e*pd,n*pd]},i}function Eq(t){var e=zs(t);function n(r,i){return[r*e,bs(i)/e]}return n.invert=function(r,i){return[r/e,C0(i*e)]},n}function QB(t,e){var n=bs(t),r=(n+bs(e))/2;if(Il(r)<Wa)return Eq(t);var i=1+n*(2*r-n),s=mp(i)/r;function l(u,h){var p=mp(i-2*r*bs(h))/r;return[p*bs(u*=r),s-p*zs(u)]}return l.invert=function(u,h){var p=s-h,m=Vv(u,Il(p))*O0(p);return p*r<0&&(m-=Ys*O0(u)*O0(p)),[m/r,C0((i-(u*u+p*p)*r*r)/(2*r))]},l}function rw(){return GR(QB).scale(155.424).center([0,33.6442])}function JB(){return rw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Sq(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function Tq(){var t,e,n=JB(),r,i=rw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,l=rw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,h,p={point:function(x,T){h=[x,T]}};function m(x){var T=x[0],C=x[1];return h=null,r.point(T,C),h||(s.point(T,C),h)||(u.point(T,C),h)}m.invert=function(x){var T=n.scale(),C=n.translate(),M=(x[0]-C[0])/T,I=(x[1]-C[1])/T;return(I>=.12&&I<.234&&M>=-.425&&M<-.214?i:I>=.166&&I<.234&&M>=-.214&&M<-.115?l:n).invert(x)},m.stream=function(x){return t&&e===x?t:t=Sq([n.stream(e=x),i.stream(x),l.stream(x)])},m.precision=function(x){return arguments.length?(n.precision(x),i.precision(x),l.precision(x),y()):n.precision()},m.scale=function(x){return arguments.length?(n.scale(x),i.scale(x*.35),l.scale(x),m.translate(n.translate())):n.scale()},m.translate=function(x){if(!arguments.length)return n.translate();var T=n.scale(),C=+x[0],M=+x[1];return r=n.translate(x).clipExtent([[C-.455*T,M-.238*T],[C+.455*T,M+.238*T]]).stream(p),s=i.translate([C-.307*T,M+.201*T]).clipExtent([[C-.425*T+Wa,M+.12*T+Wa],[C-.214*T-Wa,M+.234*T-Wa]]).stream(p),u=l.translate([C-.205*T,M+.212*T]).clipExtent([[C-.214*T+Wa,M+.166*T+Wa],[C-.115*T-Wa,M+.234*T-Wa]]).stream(p),y()},m.fitExtent=function(x,T){return nw(m,x,T)},m.fitSize=function(x,T){return jR(m,x,T)},m.fitWidth=function(x,T){return VR(m,x,T)},m.fitHeight=function(x,T){return ZR(m,x,T)};function y(){return t=e=null,m}return m.scale(1070)}function tF(t){return function(e,n){var r=zs(e),i=zs(n),s=t(r*i);return s===1/0?[2,0]:[s*i*bs(e),s*bs(n)]}}function m2(t){return function(e,n){var r=mp(e*e+n*n),i=t(r),s=bs(i),l=zs(i);return[Vv(e*s,r*l),C0(r&&n*s/r)]}}var WR=tF(function(t){return mp(2/(1+t))});WR.invert=m2(function(t){return 2*C0(t/2)});function wq(){return Qm(WR).scale(124.75).clipAngle(180-.001)}var XR=tF(function(t){return(t=hB(t))&&t/bs(t)});XR.invert=m2(function(t){return t});function Aq(){return Qm(XR).scale(79.4188).clipAngle(180-.001)}function v2(t,e){return[t,VT(ER((ef+e)/2))]}v2.invert=function(t,e){return[t,2*X1(fB(e))-ef]};function Oq(){return eF(v2).scale(961/Wp)}function eF(t){var e=Qm(t),n=e.center,r=e.scale,i=e.translate,s=e.clipExtent,l=null,u,h,p;e.scale=function(y){return arguments.length?(r(y),m()):r()},e.translate=function(y){return arguments.length?(i(y),m()):i()},e.center=function(y){return arguments.length?(n(y),m()):n()},e.clipExtent=function(y){return arguments.length?(y==null?l=u=h=p=null:(l=+y[0][0],u=+y[0][1],h=+y[1][0],p=+y[1][1]),m()):l==null?null:[[l,u],[h,p]]};function m(){var y=Ys*r(),x=e(mq(e.rotate()).invert([0,0]));return s(l==null?[[x[0]-y,x[1]-y],[x[0]+y,x[1]+y]]:t===v2?[[Math.max(x[0]-y,l),u],[Math.min(x[0]+y,h),p]]:[[l,Math.max(x[1]-y,u)],[h,Math.min(x[1]+y,p)]])}return m()}function iw(t){return ER((ef+t)/2)}function nF(t,e){var n=zs(t),r=t===e?bs(t):VT(n/zs(e))/VT(iw(e)/iw(t)),i=n*bR(iw(t),r)/r;if(!r)return v2;function s(l,u){i>0?u<-ef+Wa&&(u=-ef+Wa):u>ef-Wa&&(u=ef-Wa);var h=i/bR(iw(u),r);return[h*bs(r*l),i-h*zs(r*l)]}return s.invert=function(l,u){var h=i-u,p=O0(r)*mp(l*l+h*h),m=Vv(l,Il(h))*O0(h);return h*r<0&&(m-=Ys*O0(l)*O0(h)),[m/r,2*X1(bR(i/p,1/r))-ef]},s}function Cq(){return GR(nF).scale(109.5).parallels([30,30])}function g2(t,e){return[t,e]}g2.invert=g2;function Rq(){return Qm(g2).scale(152.63)}function rF(t,e){var n=zs(t),r=t===e?bs(t):(n-zs(e))/(e-t),i=n/r+t;if(Il(r)<Wa)return g2;function s(l,u){var h=i-u,p=r*l;return[h*bs(p),i-h*zs(p)]}return s.invert=function(l,u){var h=i-u,p=Vv(l,Il(h))*O0(h);return h*r<0&&(p-=Ys*O0(l)*O0(h)),[p/r,i-O0(r)*mp(l*l+h*h)]},s}function Mq(){return GR(rF).scale(131.154).center([0,13.9389])}var y2=1.340264,_2=-.081106,x2=893e-6,b2=.003796,ow=mp(3)/2,Pq=12;function YR(t,e){var n=C0(ow*bs(e)),r=n*n,i=r*r*r;return[t*zs(n)/(ow*(y2+3*_2*r+i*(7*x2+9*b2*r))),n*(y2+_2*r+i*(x2+b2*r))]}YR.invert=function(t,e){for(var n=e,r=n*n,i=r*r*r,s=0,l,u,h;s<Pq&&(u=n*(y2+_2*r+i*(x2+b2*r))-e,h=y2+3*_2*r+i*(7*x2+9*b2*r),n-=l=u/h,r=n*n,i=r*r*r,!(Il(l)<cB));++s);return[ow*t*(y2+3*_2*r+i*(7*x2+9*b2*r))/zs(n),C0(bs(n)/ow)]};function Iq(){return Qm(YR).scale(177.158)}function qR(t,e){var n=zs(e),r=zs(t)*n;return[n*bs(t)/r,bs(e)/r]}qR.invert=m2(X1);function Lq(){return Qm(qR).scale(144.049).clipAngle(60)}function Dq(){var t=1,e=0,n=0,r=1,i=1,s=0,l,u,h=null,p,m,y,x=1,T=1,C=p2({point:function(G,W){var $=Z([G,W]);this.stream.point($[0],$[1])}}),M=s2,I,D;function U(){return x=t*r,T=t*i,I=D=null,Z}function Z(G){var W=G[0]*x,$=G[1]*T;if(s){var J=$*l-W*u;W=W*l+$*u,$=J}return[W+e,$+n]}return Z.invert=function(G){var W=G[0]-e,$=G[1]-n;if(s){var J=$*l+W*u;W=W*l-$*u,$=J}return[W/x,$/T]},Z.stream=function(G){return I&&D===G?I:I=C(M(D=G))},Z.postclip=function(G){return arguments.length?(M=G,h=p=m=y=null,U()):M},Z.clipExtent=function(G){return arguments.length?(M=G==null?(h=p=m=y=null,s2):HB(h=+G[0][0],p=+G[0][1],m=+G[1][0],y=+G[1][1]),U()):h==null?null:[[h,p],[m,y]]},Z.scale=function(G){return arguments.length?(t=+G,U()):t},Z.translate=function(G){return arguments.length?(e=+G[0],n=+G[1],U()):[e,n]},Z.angle=function(G){return arguments.length?(s=G%360*wu,u=bs(s),l=zs(s),U()):s*pd},Z.reflectX=function(G){return arguments.length?(r=G?-1:1,U()):r<0},Z.reflectY=function(G){return arguments.length?(i=G?-1:1,U()):i<0},Z.fitExtent=function(G,W){return nw(Z,G,W)},Z.fitSize=function(G,W){return jR(Z,G,W)},Z.fitWidth=function(G,W){return VR(Z,G,W)},Z.fitHeight=function(G,W){return ZR(Z,G,W)},Z}function $R(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),e*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}$R.invert=function(t,e){var n=e,r=25,i;do{var s=n*n,l=s*s;n-=i=(n*(1.007226+s*(.015085+l*(-.044475+.028874*s-.005916*l)))-e)/(1.007226+s*(.015085*3+l*(-.044475*7+.028874*9*s-.005916*11*l)))}while(Il(i)>Wa&&--r>0);return[t/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function Nq(){return Qm($R).scale(175.295)}function KR(t,e){return[zs(e)*bs(t),bs(e)]}KR.invert=m2(C0);function kq(){return Qm(KR).scale(249.5).clipAngle(90+Wa)}function QR(t,e){var n=zs(e),r=1+zs(t)*n;return[n*bs(t)/r,bs(e)/r]}QR.invert=m2(function(t){return 2*X1(t)});function Bq(){return Qm(QR).scale(250).clipAngle(142)}function JR(t,e){return[VT(ER((ef+e)/2)),-t]}JR.invert=function(t,e){return[-e,2*X1(fB(t))-ef]};function Fq(){var t=eF(JR),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):(r=e(),[r[1],-r[0]])},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Uq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function zq(t){if(typeof t=="function")return t;const e=`geo${Sv(t)}`,n=R[e];if(!n)throw new Error(`Unknown coordinate: ${t}`);return n}function jq(t){return{type:"FeatureCollection",features:t.flatMap(e=>Vq(e).features)}}function Vq(t){const e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!t||!t.type)return null;const n=e[t.type];if(!n)return null;if(n==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if(n==="feature")return{type:"FeatureCollection",features:[t]};if(n==="featureCollection")return t}function Zq(t,e){var n;for(const[r,i]of Object.entries(e))(n=t[r])===null||n===void 0||n.call(t,i)}function Hq(t,e,n,r){const i=()=>{const u=e.filter(iF);return u.find(p=>p.sphere)?{type:"Sphere"}:jq(u.filter(p=>!p.sphere).flatMap(p=>p.data.value))},{outline:s=i()}=r,{size:l="fitExtent"}=r;if(l==="fitExtent")return Gq(t,s,n);if(l==="fitWidth")return Wq(t,s,n)}function Gq(t,e,n){const{x:r,y:i,width:s,height:l}=n;t.fitExtent([[r,i],[s,l]],e)}function Wq(t,e,n){const{width:r,height:i}=n,[[s,l],[u,h]]=LB(t.fitWidth(r,e)).bounds(e),p=Math.ceil(h-l),m=Math.min(Math.ceil(u-s),p),y=t.scale()*(m-1)/m,[x,T]=t.translate(),C=T+(i-p)/2;t.scale(y).translate([x,C]).precision(.2)}function Xq(t){const{data:e}=t;if(Array.isArray(e))return Object.assign(Object.assign({},t),{data:{value:e}});const{type:n}=e;return n==="graticule10"?Object.assign(Object.assign({},t),{data:{value:[oq()]}}):n==="sphere"?Object.assign(Object.assign({},t),{sphere:!0,data:{value:[{type:"Sphere"}]}}):t}function iF(t){return t.type==="geoPath"}const oF=()=>t=>{const{children:e,coordinate:n={}}=t;if(!Array.isArray(e))return[];const{type:r="equalEarth"}=n,i=Uq(n,["type"]),s=zq(r),l=e.map(Xq);let u;function h(){return[["custom",(y,x,T,C)=>{const M=s();Hq(M,l,{x:y,y:x,width:T,height:C},i),Zq(M,i),u=LB(M);const D=new hh({domain:[y,y+T]}),U=new hh({domain:[x,x+C]}),Z=W=>{const $=M(W);if(!$)return[null,null];const[J,nt]=$;return[D.map(J),U.map(nt)]},G=W=>{if(!W)return null;const[$,J]=W,nt=[D.invert($),U.invert(J)];return M.invert(nt)};return{transform:W=>Z(W),untransform:W=>G(W)}}]]}function p(y){const{style:x,tooltip:T={}}=y;return Object.assign(Object.assign({},y),{type:"path",tooltip:tT(T,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},x),{d:C=>u(C)||[]})})}const m=y=>iF(y)?p(y):y;return[Object.assign(Object.assign({},t),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:h},children:l.flatMap(m)})]};oF.props={};var Yq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const aF=()=>t=>{const{type:e,data:n,scale:r,encode:i,style:s,animate:l,key:u,state:h}=t,p=Yq(t,["type","data","scale","encode","style","animate","key","state"]);return[Object.assign(Object.assign({type:"geoView"},p),{children:[{type:"geoPath",key:`${u}-0`,data:{value:n},scale:r,encode:i,style:s,animate:l,state:h}]})]};aF.props={};function qq(){return{"composition.geoView":oF,"composition.geoPath":aF}}function $q(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return sF(this.cover(e,n),e,n,t)}function sF(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,s=t._root,l={data:r},u=t._x0,h=t._y0,p=t._x1,m=t._y1,y,x,T,C,M,I,D,U;if(!s)return t._root=l,t;for(;s.length;)if((M=e>=(y=(u+p)/2))?u=y:p=y,(I=n>=(x=(h+m)/2))?h=x:m=x,i=s,!(s=s[D=I<<1|M]))return i[D]=l,t;if(T=+t._x.call(null,s.data),C=+t._y.call(null,s.data),e===T&&n===C)return l.next=s,i?i[D]=l:t._root=l,t;do i=i?i[D]=new Array(4):t._root=new Array(4),(M=e>=(y=(u+p)/2))?u=y:p=y,(I=n>=(x=(h+m)/2))?h=x:m=x;while((D=I<<1|M)===(U=(C>=x)<<1|T>=y));return i[U]=s,i[D]=l,t}function Kq(t){var e,n,r=t.length,i,s,l=new Array(r),u=new Array(r),h=1/0,p=1/0,m=-1/0,y=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(l[n]=i,u[n]=s,i<h&&(h=i),i>m&&(m=i),s<p&&(p=s),s>y&&(y=s));if(h>m||p>y)return this;for(this.cover(h,p).cover(m,y),n=0;n<r;++n)sF(this,l[n],u[n],t[n]);return this}function Qq(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,s=(r=Math.floor(e))+1;else{for(var l=i-n||1,u=this._root,h,p;n>t||t>=i||r>e||e>=s;)switch(p=(e<r)<<1|t<n,h=new Array(4),h[p]=u,u=h,l*=2,p){case 0:i=n+l,s=r+l;break;case 1:n=i-l,s=r+l;break;case 2:i=n+l,r=s-l;break;case 3:n=i-l,r=s-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function Jq(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function t$(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function kd(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function e$(t,e,n){var r,i=this._x0,s=this._y0,l,u,h,p,m=this._x1,y=this._y1,x=[],T=this._root,C,M;for(T&&x.push(new kd(T,i,s,m,y)),n==null?n=1/0:(i=t-n,s=e-n,m=t+n,y=e+n,n*=n);C=x.pop();)if(!(!(T=C.node)||(l=C.x0)>m||(u=C.y0)>y||(h=C.x1)<i||(p=C.y1)<s))if(T.length){var I=(l+h)/2,D=(u+p)/2;x.push(new kd(T[3],I,D,h,p),new kd(T[2],l,D,I,p),new kd(T[1],I,u,h,D),new kd(T[0],l,u,I,D)),(M=(e>=D)<<1|t>=I)&&(C=x[x.length-1],x[x.length-1]=x[x.length-1-M],x[x.length-1-M]=C)}else{var U=t-+this._x.call(null,T.data),Z=e-+this._y.call(null,T.data),G=U*U+Z*Z;if(G<n){var W=Math.sqrt(n=G);i=t-W,s=e-W,m=t+W,y=e+W,r=T.data}}return r}function n$(t){if(isNaN(m=+this._x.call(null,t))||isNaN(y=+this._y.call(null,t)))return this;var e,n=this._root,r,i,s,l=this._x0,u=this._y0,h=this._x1,p=this._y1,m,y,x,T,C,M,I,D;if(!n)return this;if(n.length)for(;;){if((C=m>=(x=(l+h)/2))?l=x:h=x,(M=y>=(T=(u+p)/2))?u=T:p=T,e=n,!(n=n[I=M<<1|C]))return this;if(!n.length)break;(e[I+1&3]||e[I+2&3]||e[I+3&3])&&(r=e,D=I)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):e?(s?e[I]=s:delete e[I],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[D]=n:this._root=n),this):(this._root=s,this)}function r$(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function i$(){return this._root}function o$(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function a$(t){var e=[],n,r=this._root,i,s,l,u,h;for(r&&e.push(new kd(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,s=n.x0,l=n.y0,u=n.x1,h=n.y1)&&r.length){var p=(s+u)/2,m=(l+h)/2;(i=r[3])&&e.push(new kd(i,p,m,u,h)),(i=r[2])&&e.push(new kd(i,s,m,p,h)),(i=r[1])&&e.push(new kd(i,p,l,u,m)),(i=r[0])&&e.push(new kd(i,s,l,p,m))}return this}function s$(t){var e=[],n=[],r;for(this._root&&e.push(new kd(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,l=r.x0,u=r.y0,h=r.x1,p=r.y1,m=(l+h)/2,y=(u+p)/2;(s=i[0])&&e.push(new kd(s,l,u,m,y)),(s=i[1])&&e.push(new kd(s,m,u,h,y)),(s=i[2])&&e.push(new kd(s,l,y,m,p)),(s=i[3])&&e.push(new kd(s,m,y,h,p))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function l$(t){return t[0]}function c$(t){return arguments.length?(this._x=t,this):this._x}function u$(t){return t[1]}function f$(t){return arguments.length?(this._y=t,this):this._y}function lF(t,e,n){var r=new tM(e==null?l$:e,n==null?u$:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function tM(t,e,n,r,i,s){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function cF(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Bd=lF.prototype=tM.prototype;Bd.copy=function(){var t=new tM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=cF(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=cF(r));return t},Bd.add=$q,Bd.addAll=Kq,Bd.cover=Qq,Bd.data=Jq,Bd.extent=t$,Bd.find=e$,Bd.remove=n$,Bd.removeAll=r$,Bd.root=i$,Bd.size=o$,Bd.visit=a$,Bd.visitAfter=s$,Bd.x=c$,Bd.y=f$;function Xp(t){return function(){return t}}function Q1(t){return(t()-.5)*1e-6}var h$={value:function(){}};function uF(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new aw(n)}function aw(t){this._=t}function d$(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}aw.prototype=uF.prototype={constructor:aw,on:function(e,n){var r=this._,i=d$(e+"",r),s,l=-1,u=i.length;if(arguments.length<2){for(;++l<u;)if((s=(e=i[l]).type)&&(s=p$(r[s],e.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++l<u;)if(s=(e=i[l]).type)r[s]=fF(r[s],e.name,n);else if(n==null)for(s in r)r[s]=fF(r[s],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new aw(e)},call:function(e,n){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,l;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],i=0,s=l.length;i<s;++i)l[i].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],s=0,l=i.length;s<l;++s)i[s].value.apply(n,r)}};function p$(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function fF(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=h$,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var m$=uF,J1=0,E2=0,S2=0,hF=1e3,sw,T2,lw=0,E_=0,cw=0,w2=typeof performance=="object"&&performance.now?performance:Date,dF=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function pF(){return E_||(dF(v$),E_=w2.now()+cw)}function v$(){E_=0}function eM(){this._call=this._time=this._next=null}eM.prototype=mF.prototype={constructor:eM,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?pF():+n)+(e==null?0:+e),!this._next&&T2!==this&&(T2?T2._next=this:sw=this,T2=this),this._call=t,this._time=n,nM()},stop:function(){this._call&&(this._call=null,this._time=1/0,nM())}};function mF(t,e,n){var r=new eM;return r.restart(t,e,n),r}function g$(){pF(),++J1;for(var t=sw,e;t;)(e=E_-t._time)>=0&&t._call.call(void 0,e),t=t._next;--J1}function vF(){E_=(lw=w2.now())+cw,J1=E2=0;try{g$()}finally{J1=0,_$(),E_=0}}function y$(){var t=w2.now(),e=t-lw;e>hF&&(cw-=e,lw=t)}function _$(){for(var t,e=sw,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:sw=n);T2=t,nM(r)}function nM(t){if(!J1){E2&&(E2=clearTimeout(E2));var e=t-E_;e>24?(t<1/0&&(E2=setTimeout(vF,t-w2.now()-cw)),S2&&(S2=clearInterval(S2))):(S2||(lw=w2.now(),S2=setInterval(y$,hF)),J1=1,dF(vF))}}const x$=1664525,b$=1013904223,gF=4294967296;function E$(){let t=1;return()=>(t=(x$*t+b$)%gF)/gF}function S$(t){return t.x}function T$(t){return t.y}var w$=10,A$=Math.PI*(3-Math.sqrt(5));function O$(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,l=.6,u=new Map,h=mF(y),p=m$("tick","end"),m=E$();t==null&&(t=[]);function y(){x(),p.call("tick",e),n<r&&(h.stop(),p.call("end",e))}function x(M){var I,D=t.length,U;M===void 0&&(M=1);for(var Z=0;Z<M;++Z)for(n+=(s-n)*i,u.forEach(function(G){G(n)}),I=0;I<D;++I)U=t[I],U.fx==null?U.x+=U.vx*=l:(U.x=U.fx,U.vx=0),U.fy==null?U.y+=U.vy*=l:(U.y=U.fy,U.vy=0);return e}function T(){for(var M=0,I=t.length,D;M<I;++M){if(D=t[M],D.index=M,D.fx!=null&&(D.x=D.fx),D.fy!=null&&(D.y=D.fy),isNaN(D.x)||isNaN(D.y)){var U=w$*Math.sqrt(.5+M),Z=M*A$;D.x=U*Math.cos(Z),D.y=U*Math.sin(Z)}(isNaN(D.vx)||isNaN(D.vy))&&(D.vx=D.vy=0)}}function C(M){return M.initialize&&M.initialize(t,m),M}return T(),e={tick:x,restart:function(){return h.restart(y),e},stop:function(){return h.stop(),e},nodes:function(M){return arguments.length?(t=M,T(),u.forEach(C),e):t},alpha:function(M){return arguments.length?(n=+M,e):n},alphaMin:function(M){return arguments.length?(r=+M,e):r},alphaDecay:function(M){return arguments.length?(i=+M,e):+i},alphaTarget:function(M){return arguments.length?(s=+M,e):s},velocityDecay:function(M){return arguments.length?(l=1-M,e):1-l},randomSource:function(M){return arguments.length?(m=M,u.forEach(C),e):m},force:function(M,I){return arguments.length>1?(I==null?u.delete(M):u.set(M,C(I)),e):u.get(M)},find:function(M,I,D){var U=0,Z=t.length,G,W,$,J,nt;for(D==null?D=1/0:D*=D,U=0;U<Z;++U)J=t[U],G=M-J.x,W=I-J.y,$=G*G+W*W,$<D&&(nt=J,D=$);return nt},on:function(M,I){return arguments.length>1?(p.on(M,I),e):p.on(M)}}}function C$(){var t,e,n,r,i=Xp(-30),s,l=1,u=1/0,h=.81;function p(T){var C,M=t.length,I=lF(t,S$,T$).visitAfter(y);for(r=T,C=0;C<M;++C)e=t[C],I.visit(x)}function m(){if(t){var T,C=t.length,M;for(s=new Array(C),T=0;T<C;++T)M=t[T],s[M.index]=+i(M,T,t)}}function y(T){var C=0,M,I,D=0,U,Z,G;if(T.length){for(U=Z=G=0;G<4;++G)(M=T[G])&&(I=Math.abs(M.value))&&(C+=M.value,D+=I,U+=I*M.x,Z+=I*M.y);T.x=U/D,T.y=Z/D}else{M=T,M.x=M.data.x,M.y=M.data.y;do C+=s[M.data.index];while(M=M.next)}T.value=C}function x(T,C,M,I){if(!T.value)return!0;var D=T.x-e.x,U=T.y-e.y,Z=I-C,G=D*D+U*U;if(Z*Z/h<G)return G<u&&(D===0&&(D=Q1(n),G+=D*D),U===0&&(U=Q1(n),G+=U*U),G<l&&(G=Math.sqrt(l*G)),e.vx+=D*T.value*r/G,e.vy+=U*T.value*r/G),!0;if(T.length||G>=u)return;(T.data!==e||T.next)&&(D===0&&(D=Q1(n),G+=D*D),U===0&&(U=Q1(n),G+=U*U),G<l&&(G=Math.sqrt(l*G)));do T.data!==e&&(Z=s[T.data.index]*r/G,e.vx+=D*Z,e.vy+=U*Z);while(T=T.next)}return p.initialize=function(T,C){t=T,n=C,m()},p.strength=function(T){return arguments.length?(i=typeof T=="function"?T:Xp(+T),m(),p):i},p.distanceMin=function(T){return arguments.length?(l=T*T,p):Math.sqrt(l)},p.distanceMax=function(T){return arguments.length?(u=T*T,p):Math.sqrt(u)},p.theta=function(T){return arguments.length?(h=T*T,p):Math.sqrt(h)},p}function R$(t){return t.index}function yF(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function M$(t){var e=R$,n=y,r,i=Xp(30),s,l,u,h,p,m=1;t==null&&(t=[]);function y(I){return 1/Math.min(u[I.source.index],u[I.target.index])}function x(I){for(var D=0,U=t.length;D<m;++D)for(var Z=0,G,W,$,J,nt,dt,Et;Z<U;++Z)G=t[Z],W=G.source,$=G.target,J=$.x+$.vx-W.x-W.vx||Q1(p),nt=$.y+$.vy-W.y-W.vy||Q1(p),dt=Math.sqrt(J*J+nt*nt),dt=(dt-s[Z])/dt*I*r[Z],J*=dt,nt*=dt,$.vx-=J*(Et=h[Z]),$.vy-=nt*Et,W.vx+=J*(Et=1-Et),W.vy+=nt*Et}function T(){if(l){var I,D=l.length,U=t.length,Z=new Map(l.map((W,$)=>[e(W,$,l),W])),G;for(I=0,u=new Array(D);I<U;++I)G=t[I],G.index=I,typeof G.source!="object"&&(G.source=yF(Z,G.source)),typeof G.target!="object"&&(G.target=yF(Z,G.target)),u[G.source.index]=(u[G.source.index]||0)+1,u[G.target.index]=(u[G.target.index]||0)+1;for(I=0,h=new Array(U);I<U;++I)G=t[I],h[I]=u[G.source.index]/(u[G.source.index]+u[G.target.index]);r=new Array(U),C(),s=new Array(U),M()}}function C(){if(l)for(var I=0,D=t.length;I<D;++I)r[I]=+n(t[I],I,t)}function M(){if(l)for(var I=0,D=t.length;I<D;++I)s[I]=+i(t[I],I,t)}return x.initialize=function(I,D){l=I,p=D,T()},x.links=function(I){return arguments.length?(t=I,T(),x):t},x.id=function(I){return arguments.length?(e=I,x):e},x.iterations=function(I){return arguments.length?(m=+I,x):m},x.strength=function(I){return arguments.length?(n=typeof I=="function"?I:Xp(+I),C(),x):n},x.distance=function(I){return arguments.length?(i=typeof I=="function"?I:Xp(+I),M(),x):i},x}function P$(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var s,l=n.length,u,h=0,p=0;for(s=0;s<l;++s)u=n[s],h+=u.x,p+=u.y;for(h=(h/l-t)*r,p=(p/l-e)*r,s=0;s<l;++s)u=n[s],u.x-=h,u.y-=p}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(t=+s,i):t},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function I$(t){var e=Xp(.1),n,r,i;typeof t!="function"&&(t=Xp(t==null?0:+t));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vx+=(i[h]-m.x)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Xp(+u),l(),s):e},s.x=function(u){return arguments.length?(t=typeof u=="function"?u:Xp(+u),l(),s):t},s}function L$(t){var e=Xp(.1),n,r,i;typeof t!="function"&&(t=Xp(t==null?0:+t));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vy+=(i[h]-m.y)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Xp(+u),l(),s):e},s.y=function(u){return arguments.length?(t=typeof u=="function"?u:Xp(+u),l(),s):t},s}var D$=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const N$={joint:!0},k$={type:"link",axis:!1,legend:!1,encode:{x:[t=>t.source.x,t=>t.target.x],y:[t=>t.source.y,t=>t.target.y]},style:{stroke:"#999",strokeOpacity:.6}},B$={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},F$={text:""};function U$(t,e,n){const{nodes:r,links:i}=t,{joint:s,nodeStrength:l,linkStrength:u}=e,{nodeKey:h=C=>C.id,linkKey:p=C=>C.id}=n,m=C$(),y=M$(i).id(qm(p));typeof l=="function"&&m.strength(l),typeof u=="function"&&y.strength(u);const x=O$(r).force("link",y).force("charge",m);s?x.force("center",P$()):x.force("x",I$()).force("y",L$()),x.stop();const T=Math.ceil(Math.log(x.alphaMin())/Math.log(1-x.alphaDecay()));for(let C=0;C<T;C++)x.tick();return{nodesData:r,linksData:i}}const _F=t=>{const{data:e,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=t,{nodeKey:m=$=>$.id,linkKey:y=$=>$.id}=n,x=D$(n,["nodeKey","linkKey"]),T=Object.assign({nodeKey:m,linkKey:y},x),C=ho(T,"node"),M=ho(T,"link"),{links:I,nodes:D}=aC(e,T),{nodesData:U,linksData:Z}=U$({links:I,nodes:D},ti({},N$,s),T),G=Wm(p,"link",{items:[$=>({name:"source",value:qm(y)($.source)}),$=>({name:"target",value:qm(y)($.target)})]}),W=Wm(p,"node",{items:[$=>({name:"key",value:qm(m)($)})]},!0);return[ti({},k$,{data:Z,encode:M,labels:u,style:ho(i,"link"),tooltip:G,animate:Xm(h,"link")}),ti({},B$,{data:U,encode:Object.assign({},C),scale:r,style:ho(i,"node"),tooltip:W,labels:[Object.assign(Object.assign({},F$),ho(i,"label")),...l],animate:Xm(h,"link")})]};_F.props={};function z$(t,e){return t.parent===e.parent?1:2}function rM(t){var e=t.children;return e?e[0]:t.t}function iM(t){var e=t.children;return e?e[e.length-1]:t.t}function j$(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function V$(t){for(var e=0,n=0,r=t.children,i=r.length,s;--i>=0;)s=r[i],s.z+=e,s.m+=e,e+=s.s+(n+=s.c)}function Z$(t,e,n){return t.a.parent===e.parent?t.a:n}function uw(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}uw.prototype=Object.create(F1.prototype);function H$(t){for(var e=new uw(t,0),n,r=[e],i,s,l,u;n=r.pop();)if(s=n._.children)for(n.children=new Array(u=s.length),l=u-1;l>=0;--l)r.push(i=n.children[l]=new uw(s[l],l)),i.parent=n;return(e.parent=new uw(null,0)).children=[e],e}function G$(){var t=z$,e=1,n=1,r=null;function i(p){var m=H$(p);if(m.eachAfter(s),m.parent.m=-m.z,m.eachBefore(l),r)p.eachBefore(h);else{var y=p,x=p,T=p;p.eachBefore(function(U){U.x<y.x&&(y=U),U.x>x.x&&(x=U),U.depth>T.depth&&(T=U)});var C=y===x?1:t(y,x)/2,M=C-y.x,I=e/(x.x+C+M),D=n/(T.depth||1);p.eachBefore(function(U){U.x=(U.x+M)*I,U.y=U.depth*D})}return p}function s(p){var m=p.children,y=p.parent.children,x=p.i?y[p.i-1]:null;if(m){V$(p);var T=(m[0].z+m[m.length-1].z)/2;x?(p.z=x.z+t(p._,x._),p.m=p.z-T):p.z=T}else x&&(p.z=x.z+t(p._,x._));p.parent.A=u(p,x,p.parent.A||y[0])}function l(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function u(p,m,y){if(m){for(var x=p,T=p,C=m,M=x.parent.children[0],I=x.m,D=T.m,U=C.m,Z=M.m,G;C=iM(C),x=rM(x),C&&x;)M=rM(M),T=iM(T),T.a=p,G=C.z+U-x.z-I+t(C._,x._),G>0&&(j$(Z$(C,p,y),p,G),I+=G,D+=G),U+=C.m,I+=x.m,Z+=M.m,D+=T.m;C&&!iM(T)&&(T.t=C,T.m+=U-D),x&&!rM(M)&&(M.t=x,M.m+=I-Z,y=p)}return y}function h(p){p.x*=e,p.y=p.depth*n}return i.separation=function(p){return arguments.length?(t=p,i):t},i.size=function(p){return arguments.length?(r=!1,e=+p[0],n=+p[1],i):r?null:[e,n]},i.nodeSize=function(p){return arguments.length?(r=!0,e=+p[0],n=+p[1],i):r?[e,n]:null},i}function W$(t,e){return t.parent===e.parent?1:2}function X$(t){return t.reduce(Y$,0)/t.length}function Y$(t,e){return t+e.x}function q$(t){return 1+t.reduce($$,0)}function $$(t,e){return Math.max(t,e.y)}function K$(t){for(var e;e=t.children;)t=e[0];return t}function Q$(t){for(var e;e=t.children;)t=e[e.length-1];return t}function J$(){var t=W$,e=1,n=1,r=!1;function i(s){var l,u=0;s.eachAfter(function(x){var T=x.children;T?(x.x=X$(T),x.y=q$(T)):(x.x=l?u+=t(x,l):0,x.y=0,l=x)});var h=K$(s),p=Q$(s),m=h.x-t(h,p)/2,y=p.x+t(p,h)/2;return s.eachAfter(r?function(x){x.x=(x.x-s.x)*e,x.y=(s.y-x.y)*n}:function(x){x.x=(x.x-m)/(y-m)*e,x.y=(1-(s.y?x.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(t=s,i):t},i.size=function(s){return arguments.length?(r=!1,e=+s[0],n=+s[1],i):r?null:[e,n]},i.nodeSize=function(s){return arguments.length?(r=!0,e=+s[0],n=+s[1],i):r?[e,n]:null},i}const xF=t=>e=>n=>{const{field:r="value",nodeSize:i,separation:s,sortBy:l,as:u=["x","y"]}=e,[h,p]=u,m=B1(n,C=>C.children).sum(C=>C[r]).sort(l),y=t();y.size([1,1]),i&&y.nodeSize(i),s&&y.separation(s),y(m);const x=[];m.each(C=>{C[h]=C.x,C[p]=C.y,C.name=C.data.name,x.push(C)});const T=m.links();return T.forEach(C=>{C[h]=[C.source[h],C.target[h]],C[p]=[C.source[p],C.target[p]]}),{nodes:x,edges:T}},bF=t=>xF(J$)(t);bF.props={};const EF=t=>xF(G$)(t);EF.props={};const tK={sortBy:(t,e)=>e.value-t.value},eK={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},nK={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},rK={text:"",fontSize:10},SF=t=>{const{data:e,encode:n={},scale:r={},style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=t,m=n==null?void 0:n.value,{nodes:y,edges:x}=EF(Object.assign(Object.assign(Object.assign({},tK),s),{field:m}))(e),T=Wm(p,"node",{title:"name",items:["value"]},!0),C=Wm(p,"link",{title:"",items:[M=>({name:"source",value:M.source.name}),M=>({name:"target",value:M.target.name})]});return[ti({},nK,{data:x,encode:ho(n,"link"),scale:ho(r,"link"),labels:u,style:Object.assign({stroke:"#999"},ho(i,"link")),tooltip:C,animate:Xm(h,"link")}),ti({},eK,{data:y,scale:ho(r,"node"),encode:ho(n,"node"),labels:[Object.assign(Object.assign({},rK),ho(i,"label")),...l],style:Object.assign({},ho(i,"node")),tooltip:T,animate:Xm(h,"node")})]};SF.props={};var iK=1664525,oK=1013904223,TF=4294967296;function aK(){var t=1;return function(){return(t=(iK*t+oK)%TF)/TF}}var sK=it(52677);function lK(t){return sK(t)==="object"&&"length"in t?t:Array.from(t)}function cK(t,e){for(var n=t.length,r,i;n;)i=e()*n--|0,r=t[n],t[n]=t[i],t[i]=r;return t}function ent(t){return wF(t,lcg())}function wF(t,e){for(var n=0,r=(t=cK(Array.from(t),e)).length,i=[],s,l;n<r;)s=t[n],l&&AF(l,s)?++n:(l=fK(i=uK(i,s)),n=0);return l}function uK(t,e){var n,r;if(oM(e,t))return[e];for(n=0;n<t.length;++n)if(fw(e,t[n])&&oM(A2(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(fw(A2(t[n],t[r]),e)&&fw(A2(t[n],e),t[r])&&fw(A2(t[r],e),t[n])&&oM(OF(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function fw(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function AF(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function oM(t,e){for(var n=0;n<e.length;++n)if(!AF(t,e[n]))return!1;return!0}function fK(t){switch(t.length){case 1:return hK(t[0]);case 2:return A2(t[0],t[1]);case 3:return OF(t[0],t[1],t[2])}}function hK(t){return{x:t.x,y:t.y,r:t.r}}function A2(t,e){var n=t.x,r=t.y,i=t.r,s=e.x,l=e.y,u=e.r,h=s-n,p=l-r,m=u-i,y=Math.sqrt(h*h+p*p);return{x:(n+s+h/y*m)/2,y:(r+l+p/y*m)/2,r:(y+i+u)/2}}function OF(t,e,n){var r=t.x,i=t.y,s=t.r,l=e.x,u=e.y,h=e.r,p=n.x,m=n.y,y=n.r,x=r-l,T=r-p,C=i-u,M=i-m,I=h-s,D=y-s,U=r*r+i*i-s*s,Z=U-l*l-u*u+h*h,G=U-p*p-m*m+y*y,W=T*C-x*M,$=(C*G-M*Z)/(W*2)-r,J=(M*I-C*D)/W,nt=(T*Z-x*G)/(W*2)-i,dt=(x*D-T*I)/W,Et=J*J+dt*dt-1,Pt=2*(s+$*J+nt*dt),Ht=$*$+nt*nt-s*s,Ct=-(Math.abs(Et)>1e-6?(Pt+Math.sqrt(Pt*Pt-4*Et*Ht))/(2*Et):Ht/Pt);return{x:r+$+J*Ct,y:i+nt+dt*Ct,r:Ct}}function CF(t,e,n){var r=t.x-e.x,i,s,l=t.y-e.y,u,h,p=r*r+l*l;p?(s=e.r+n.r,s*=s,h=t.r+n.r,h*=h,s>h?(i=(p+h-s)/(2*p),u=Math.sqrt(Math.max(0,h/p-i*i)),n.x=t.x-i*r-u*l,n.y=t.y-i*l+u*r):(i=(p+s-h)/(2*p),u=Math.sqrt(Math.max(0,s/p-i*i)),n.x=e.x+i*r-u*l,n.y=e.y+i*l+u*r)):(n.x=e.x+n.r,n.y=e.y)}function RF(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function MF(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,s=(e.y*n.r+n.y*e.r)/r;return i*i+s*s}function hw(t){this._=t,this.next=null,this.previous=null}function PF(t,e){if(!(s=(t=lK(t)).length))return 0;var n,r,i,s,l,u,h,p,m,y,x;if(n=t[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;CF(r,n,i=t[2]),n=new hw(n),r=new hw(r),i=new hw(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(h=3;h<s;++h){CF(n._,r._,i=t[h]),i=new hw(i),p=r.next,m=n.previous,y=r._.r,x=n._.r;do if(y<=x){if(RF(p._,i._)){r=p,n.next=r,r.previous=n,--h;continue t}y+=p._.r,p=p.next}else{if(RF(m._,i._)){n=m,n.next=r,r.previous=n,--h;continue t}x+=m._.r,m=m.previous}while(p!==m.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,l=MF(n);(i=i.next)!==r;)(u=MF(i))<l&&(n=i,l=u);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=wF(n,e),h=0;h<s;++h)n=t[h],n.x-=i.x,n.y-=i.y;return i.r}function nnt(t){return PF(t,lcg()),t}function dK(t){return Math.sqrt(t.value)}function pK(){var t=null,e=1,n=1,r=x_;function i(s){var l=aK();return s.x=e/2,s.y=n/2,t?s.eachBefore(IF(t)).eachAfter(aM(r,.5,l)).eachBefore(LF(1)):s.eachBefore(IF(dK)).eachAfter(aM(x_,1,l)).eachAfter(aM(r,s.r/Math.min(e,n),l)).eachBefore(LF(Math.min(e,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(t=RT(s),i):t},i.size=function(s){return arguments.length?(e=+s[0],n=+s[1],i):[e,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:G1(+s),i):r},i}function IF(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function aM(t,e,n){return function(r){if(i=r.children){var i,s,l=i.length,u=t(r)*e||0,h;if(u)for(s=0;s<l;++s)i[s].r+=u;if(h=PF(i,n),u)for(s=0;s<l;++s)i[s].r-=u;r.r=h+u}}}function LF(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var mK=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const vK=(t,e)=>({size:[t,e],padding:0,sort:(n,r)=>r.value-n.value}),gK=(t,e,n)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,t]},y:{domain:[0,e]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:n.color?void 0:r=>r.height===0?"#ddd":"#fff",stroke:n.color?void 0:r=>r.height===0?"":"#000"}}),yK={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.r*2},_K={title:t=>t.data.name,items:[{field:"value"}]},xK=(t,e,n)=>{const{value:r}=n,i=Ps(t)?JC().path(e.path)(t):B1(t);return r?i.sum(s=>qm(r)(s)).sort(e.sort):i.count(),pK().size(e.size).padding(e.padding)(i),i.descendants()},DF=(t,e)=>{const{width:n,height:r}=e,{data:i,encode:s={},scale:l={},style:u={},layout:h={},labels:p=[],tooltip:m={}}=t,y=mK(t,["data","encode","scale","style","layout","labels","tooltip"]),x=gK(n,r,s),T=xK(i,ti({},vK(n,r),h),ti({},x.encode,s)),C=ho(u,"label");return ti({},x,Object.assign(Object.assign({data:T,encode:s,scale:l,style:u,labels:[Object.assign(Object.assign({},yK),C),...p]},y),{tooltip:tT(m,_K),axis:!1}))};DF.props={};function bK(t){return t.target.depth}function EK(t){return t.depth}function SK(t,e){return e-1-t.height}function dw(t,e){return t.sourceLinks.length?t.depth:e-1}function TK(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Hp(t.sourceLinks,bK)-1:0}function pw(t){return function(){return t}}function NF(t,e){return mw(t.source,e.source)||t.index-e.index}function kF(t,e){return mw(t.target,e.target)||t.index-e.index}function mw(t,e){return t.y0-e.y0}function sM(t){return t.value}function wK(t){return t.index}function AK(t){return t.nodes}function OK(t){return t.links}function BF(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function FF({nodes:t}){for(const e of t){let n=e.y0,r=n;for(const i of e.sourceLinks)i.y0=n+i.width/2,n+=i.width;for(const i of e.targetLinks)i.y1=r+i.width/2,r+=i.width}}function CK(){let t=0,e=0,n=1,r=1,i=24,s=8,l,u=wK,h=dw,p,m,y,x=AK,T=OK,C=6;function M(qt){const Ee={nodes:x(qt),links:T(qt)};return I(Ee),D(Ee),U(Ee),Z(Ee),$(Ee),FF(Ee),Ee}M.update=function(qt){return FF(qt),qt},M.nodeId=function(qt){return arguments.length?(u=typeof qt=="function"?qt:pw(qt),M):u},M.nodeAlign=function(qt){return arguments.length?(h=typeof qt=="function"?qt:pw(qt),M):h},M.nodeDepth=function(qt){return arguments.length?(p=qt,M):p},M.nodeSort=function(qt){return arguments.length?(m=qt,M):m},M.nodeWidth=function(qt){return arguments.length?(i=+qt,M):i},M.nodePadding=function(qt){return arguments.length?(s=l=+qt,M):s},M.nodes=function(qt){return arguments.length?(x=typeof qt=="function"?qt:pw(qt),M):x},M.links=function(qt){return arguments.length?(T=typeof qt=="function"?qt:pw(qt),M):T},M.linkSort=function(qt){return arguments.length?(y=qt,M):y},M.size=function(qt){return arguments.length?(t=e=0,n=+qt[0],r=+qt[1],M):[n-t,r-e]},M.extent=function(qt){return arguments.length?(t=+qt[0][0],n=+qt[1][0],e=+qt[0][1],r=+qt[1][1],M):[[t,e],[n,r]]},M.iterations=function(qt){return arguments.length?(C=+qt,M):C};function I({nodes:qt,links:Ee}){qt.forEach((_e,hn)=>{_e.index=hn,_e.sourceLinks=[],_e.targetLinks=[]});const oe=new Map(qt.map(_e=>[u(_e),_e]));if(Ee.forEach((_e,hn)=>{_e.index=hn;let{source:Dn,target:Kn}=_e;typeof Dn!="object"&&(Dn=_e.source=BF(oe,Dn)),typeof Kn!="object"&&(Kn=_e.target=BF(oe,Kn)),Dn.sourceLinks.push(_e),Kn.targetLinks.push(_e)}),y!=null)for(const{sourceLinks:_e,targetLinks:hn}of qt)_e.sort(y),hn.sort(y)}function D({nodes:qt}){for(const Ee of qt)Ee.value=Ee.fixedValue===void 0?Math.max(sp(Ee.sourceLinks,sM),sp(Ee.targetLinks,sM)):Ee.fixedValue}function U({nodes:qt}){const Ee=qt.length;let oe=new Set(qt),_e=new Set,hn=0;for(;oe.size;){if(oe.forEach(Dn=>{Dn.depth=hn;for(const{target:Kn}of Dn.sourceLinks)_e.add(Kn)}),++hn>Ee)throw new Error("circular link");oe=_e,_e=new Set}if(p){const Dn=Math.max(El(qt,Jn=>Jn.depth)+1,0);let Kn;for(let Jn=0;Jn<qt.length;Jn++)Kn=qt[Jn],Kn.depth=p.call(null,Kn,Dn)}}function Z({nodes:qt}){const Ee=qt.length;let oe=new Set(qt),_e=new Set,hn=0;for(;oe.size;){if(oe.forEach(Dn=>{Dn.height=hn;for(const{source:Kn}of Dn.targetLinks)_e.add(Kn)}),++hn>Ee)throw new Error("circular link");oe=_e,_e=new Set}}function G({nodes:qt}){const Ee=Math.max(El(qt,hn=>hn.depth)+1,0),oe=(n-t-i)/(Ee-1),_e=new Array(Ee).fill(0).map(()=>[]);for(const hn of qt){const Dn=Math.max(0,Math.min(Ee-1,Math.floor(h.call(null,hn,Ee))));hn.layer=Dn,hn.x0=t+Dn*oe,hn.x1=hn.x0+i,_e[Dn]?_e[Dn].push(hn):_e[Dn]=[hn]}if(m)for(const hn of _e)hn.sort(m);return _e}function W(qt){const Ee=Hp(qt,oe=>(r-e-(oe.length-1)*l)/sp(oe,sM));for(const oe of qt){let _e=e;for(const hn of oe){hn.y0=_e,hn.y1=_e+hn.value*Ee,_e=hn.y1+l;for(const Dn of hn.sourceLinks)Dn.width=Dn.value*Ee}_e=(r-_e+l)/(oe.length+1);for(let hn=0;hn<oe.length;++hn){const Dn=oe[hn];Dn.y0+=_e*(hn+1),Dn.y1+=_e*(hn+1)}Ct(oe)}}function $(qt){const Ee=G(qt);l=Math.min(s,(r-e)/(El(Ee,oe=>oe.length)-1)),W(Ee);for(let oe=0;oe<C;++oe){const _e=Math.pow(.99,oe),hn=Math.max(1-_e,(oe+1)/C);nt(Ee,_e,hn),J(Ee,_e,hn)}}function J(qt,Ee,oe){for(let _e=1,hn=qt.length;_e<hn;++_e){const Dn=qt[_e];for(const Kn of Dn){let Jn=0,zr=0;for(const{source:Ki,value:Qr}of Kn.targetLinks){const Kr=Qr*(Kn.layer-Ki.layer);Jn+=Ft(Ki,Kn)*Kr,zr+=Kr}if(!(zr>0))continue;const ui=(Jn/zr-Kn.y0)*Ee;Kn.y0+=ui,Kn.y1+=ui,Ht(Kn)}m===void 0&&Dn.sort(mw),Dn.length&&dt(Dn,oe)}}function nt(qt,Ee,oe){for(let _e=qt.length,hn=_e-2;hn>=0;--hn){const Dn=qt[hn];for(const Kn of Dn){let Jn=0,zr=0;for(const{target:Ki,value:Qr}of Kn.sourceLinks){const Kr=Qr*(Ki.layer-Kn.layer);Jn+=jt(Kn,Ki)*Kr,zr+=Kr}if(!(zr>0))continue;const ui=(Jn/zr-Kn.y0)*Ee;Kn.y0+=ui,Kn.y1+=ui,Ht(Kn)}m===void 0&&Dn.sort(mw),Dn.length&&dt(Dn,oe)}}function dt(qt,Ee){const oe=qt.length>>1,_e=qt[oe];Pt(qt,_e.y0-l,oe-1,Ee),Et(qt,_e.y1+l,oe+1,Ee),Pt(qt,r,qt.length-1,Ee),Et(qt,e,0,Ee)}function Et(qt,Ee,oe,_e){for(;oe<qt.length;++oe){const hn=qt[oe],Dn=(Ee-hn.y0)*_e;Dn>1e-6&&(hn.y0+=Dn,hn.y1+=Dn),Ee=hn.y1+l}}function Pt(qt,Ee,oe,_e){for(;oe>=0;--oe){const hn=qt[oe],Dn=(hn.y1-Ee)*_e;Dn>1e-6&&(hn.y0-=Dn,hn.y1-=Dn),Ee=hn.y0-l}}function Ht({sourceLinks:qt,targetLinks:Ee}){if(y===void 0){for(const{source:{sourceLinks:oe}}of Ee)oe.sort(kF);for(const{target:{targetLinks:oe}}of qt)oe.sort(NF)}}function Ct(qt){if(y===void 0)for(const{sourceLinks:Ee,targetLinks:oe}of qt)Ee.sort(kF),oe.sort(NF)}function Ft(qt,Ee){let oe=qt.y0-(qt.sourceLinks.length-1)*l/2;for(const{target:_e,width:hn}of qt.sourceLinks){if(_e===Ee)break;oe+=hn+l}for(const{source:_e,width:hn}of Ee.targetLinks){if(_e===qt)break;oe-=hn}return oe}function jt(qt,Ee){let oe=Ee.y0-(Ee.targetLinks.length-1)*l/2;for(const{source:_e,width:hn}of Ee.targetLinks){if(_e===qt)break;oe+=hn+l}for(const{target:_e,width:hn}of qt.sourceLinks){if(_e===Ee)break;oe-=hn}return oe}return M}const RK={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:t=>t.nodes,links:t=>t.links,nodeSort:void 0,linkSort:void 0,iterations:6},MK={left:EK,right:SK,center:TK,justify:dw};function PK(t){const e=typeof t;return e==="string"?MK[t]||dw:e==="function"?t:dw}const UF=t=>e=>{const{nodeId:n,nodeSort:r,nodeAlign:i,nodeWidth:s,nodePadding:l,nodeDepth:u,nodes:h,links:p,linkSort:m,iterations:y}=Object.assign({},RK,t),x=CK().nodeSort(r).linkSort(m).links(p).nodes(h).nodeWidth(s).nodePadding(l).nodeDepth(u).nodeAlign(PK(i)).iterations(y).extent([[0,0],[1,1]]);typeof n=="function"&&x.nodeId(n);const T=x(e),{nodes:C,links:M}=T,I=C.map(U=>{const{x0:Z,x1:G,y0:W,y1:$}=U;return Object.assign(Object.assign({},U),{x:[Z,G,G,Z],y:[W,W,$,$]})}),D=M.map(U=>{const{source:Z,target:G}=U,W=Z.x1,$=G.x0,J=U.width/2;return Object.assign(Object.assign({},U),{x:[W,W,$,$],y:[U.y0+J,U.y0-J,U.y1+J,U.y1-J]})});return{nodes:I,links:D}};UF.props={};var IK=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const LK={nodeId:t=>t.key,nodeWidth:.02,nodePadding:.02},DK={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},NK={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},kK={textAlign:t=>t.x[0]<.5?"start":"end",position:t=>t.x[0]<.5?"right":"left",fontSize:10},zF=t=>{const{data:e,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=t,{links:m,nodes:y}=aC(e,n),x=ho(n,"node"),T=ho(n,"link"),{key:C=dt=>dt.key,color:M=C}=x,{links:I,nodes:D}=UF(Object.assign(Object.assign(Object.assign({},LK),{nodeId:qm(C)}),s))({links:m,nodes:y}),U=ho(i,"label"),{text:Z=C,spacing:G=5}=U,W=IK(U,["text","spacing"]),$=qm(C),J=Wm(p,"node",{title:$,items:[{field:"value"}]},!0),nt=Wm(p,"link",{title:"",items:[dt=>({name:"source",value:$(dt.source)}),dt=>({name:"target",value:$(dt.target)})]});return[ti({},DK,{data:D,encode:Object.assign(Object.assign({},x),{color:M}),scale:r,style:ho(i,"node"),labels:[Object.assign(Object.assign(Object.assign({},kK),{text:Z,dx:dt=>dt.x[0]<.5?G:-G}),W),...l],tooltip:J,animate:Xm(h,"node"),axis:!1}),ti({},NK,{data:I,encode:T,labels:u,style:Object.assign({fill:T.color?void 0:"#aaa",lineWidth:0},ho(i,"link")),tooltip:nt,animate:Xm(h,"link")})]};zF.props={};function BK(t,e){return e.value-t.value}function FK(t,e){return e.frequency-t.frequency}function UK(t,e){return`${t.id}`.localeCompare(`${e.id}`)}function zK(t,e){return`${t.name}`.localeCompare(`${e.name}`)}const jK={y:0,thickness:.05,weight:!1,marginRatio:.1,id:t=>t.id,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null};function VK(t){const{y:e,thickness:n,weight:r,marginRatio:i,id:s,source:l,target:u,sourceWeight:h,targetWeight:p,sortBy:m}=Object.assign(Object.assign({},jK),t);function y(I){const D=I.nodes.map(Z=>Object.assign({},Z)),U=I.edges.map(Z=>Object.assign({},Z));return x(D,U),T(D,U),C(D,U),M(D,U),{nodes:D,edges:U}}function x(I,D){D.forEach(G=>{G.source=l(G),G.target=u(G),G.sourceWeight=h(G),G.targetWeight=p(G)});const U=vc(D,G=>G.source),Z=vc(D,G=>G.target);return I.forEach(G=>{G.id=s(G);const W=U.has(G.id)?U.get(G.id):[],$=Z.has(G.id)?Z.get(G.id):[];G.frequency=W.length+$.length,G.value=sp(W,J=>J.sourceWeight)+sp($,J=>J.targetWeight)}),{nodes:I,edges:D}}function T(I,D){const U=typeof m=="function"?m:$e[m];U&&I.sort(U)}function C(I,D){const U=I.length;if(!U)throw mg("Invalid nodes: it's empty!");if(!r){const W=1/U;return I.forEach(($,J)=>{$.x=(J+.5)*W,$.y=e}),{nodes:I,edges:D}}const Z=i/(2*U),G=I.reduce((W,$)=>W+=$.value,0);return I.reduce((W,$)=>{$.weight=$.value/G,$.width=$.weight*(1-i),$.height=n;const J=Z+W,nt=J+$.width,dt=e-n/2,Et=dt+n;return $.x=[J,nt,nt,J],$.y=[dt,dt,Et,Et],W+$.width+2*Z},0),{nodes:I,edges:D}}function M(I,D){const U=new Map(I.map(W=>[W.id,W]));if(!r)return D.forEach(W=>{const $=l(W),J=u(W),nt=U.get($),dt=U.get(J);nt&&dt&&(W.x=[nt.x,dt.x],W.y=[nt.y,dt.y])}),{nodes:I,edges:D};D.forEach(W=>{W.x=[0,0,0,0],W.y=[e,e,e,e]});const Z=vc(D,W=>W.source),G=vc(D,W=>W.target);I.forEach(W=>{const{edges:$,width:J,x:nt,y:dt,value:Et,id:Pt}=W,Ht=Z.get(Pt)||[],Ct=G.get(Pt)||[];let Ft=0;Ht.map(jt=>{const qt=jt.sourceWeight/Et*J;jt.x[0]=nt[0]+Ft,jt.x[1]=nt[0]+Ft+qt,Ft+=qt}),Ct.forEach(jt=>{const qt=jt.targetWeight/Et*J;jt.x[3]=nt[0]+Ft,jt.x[2]=nt[0]+Ft+qt,Ft+=qt})})}return y}const lM=t=>e=>VK(t)(e);lM.props={};var jF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const cM={y:0,thickness:.05,marginRatio:.1,id:t=>t.key,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null},ZK={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},HK={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},GK={position:"outside",fontSize:10},VF=(t,e)=>{const{data:n,encode:r={},scale:i,style:s={},layout:l={},nodeLabels:u=[],linkLabels:h=[],animate:p={},tooltip:m={}}=t,{nodes:y,links:x}=aC(n,r),T=ho(r,"node"),C=ho(r,"link"),{key:M=jt=>jt.key,color:I=M}=T,{linkEncodeColor:D=jt=>jt.source}=C,{nodeWidthRatio:U=cM.thickness,nodePaddingRatio:Z=cM.marginRatio}=l,G=jF(l,["nodeWidthRatio","nodePaddingRatio"]),{nodes:W,edges:$}=lM(Object.assign(Object.assign(Object.assign(Object.assign({},cM),{id:qm(M),thickness:U,marginRatio:Z}),G),{weight:!0}))({nodes:y,edges:x}),J=ho(s,"label"),{text:nt=M}=J,dt=jF(J,["text"]),Et=Wm(m,"node",{title:"",items:[jt=>({name:jt.key,value:jt.value})]},!0),Pt=Wm(m,"link",{title:"",items:[jt=>({name:`${jt.source} -> ${jt.target}`,value:jt.value})]}),{height:Ht,width:Ct}=e,Ft=Math.min(Ht,Ct);return[ti({},HK,{data:$,encode:Object.assign(Object.assign({},C),{color:D}),labels:h,style:Object.assign({fill:D?void 0:"#aaa"},ho(s,"link")),tooltip:Pt,animate:Xm(p,"link")}),ti({},ZK,{data:W,encode:Object.assign(Object.assign({},T),{color:I}),scale:i,style:ho(s,"node"),coordinate:{type:"polar",outerRadius:(Ft-20)/Ft,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},GK),{text:nt}),dt),...u],tooltip:Et,animate:Xm(p,"node"),axis:!1})]};VF.props={};var WK=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const XK=(t,e)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[t,e],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(n,r)=>r.value-n.value,layer:0}),YK=(t,e)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:n=>n.path[1]},scale:{x:{domain:[0,t],range:[0,1]},y:{domain:[0,e],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),qK={fontSize:10,text:t=>Xb(t.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.x1-t.x0},$K={title:t=>{var e,n;return(n=(e=t.path)===null||e===void 0?void 0:e.join)===null||n===void 0?void 0:n.call(e,".")},items:[{field:"value"}]},KK={title:t=>Xb(t.path),items:[{field:"value"}]},ZF=(t,e)=>{const{width:n,height:r,options:i}=e,{data:s,encode:l={},scale:u,style:h={},layout:p={},labels:m=[],tooltip:y={}}=t,x=WK(t,["data","encode","scale","style","layout","labels","tooltip"]),T=Ii(i,["interaction","treemapDrillDown"]),C=ti({},XK(n,r),p,{layer:T?U=>U.depth===1:p.layer}),[M,I]=H6(s,C,l),D=ho(h,"label");return ti({},YK(n,r),Object.assign(Object.assign({data:M,scale:u,style:h,labels:[Object.assign(Object.assign({},qK),D),...m]},x),{encode:l,tooltip:tT(y,$K),axis:!1}),T?{interaction:Object.assign(Object.assign({},x.interaction),{treemapDrillDown:T?Object.assign(Object.assign({},T),{originData:I,layout:C}):void 0}),encode:Object.assign({color:U=>Xb(U.path)},l),tooltip:tT(y,KK)}:{})};ZF.props={};function QK(){return{"data.arc":lM,"data.cluster":bF,"mark.forceGraph":_F,"mark.tree":SF,"mark.pack":DF,"mark.sankey":zF,"mark.chord":VF,"mark.treemap":ZF}}var HF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function JK(t,e){return Hp(t,n=>e[n])}function tQ(t,e){return El(t,n=>e[n])}function GF(t,e){const n=uM(t,e)*2.5-fM(t,e)*1.5;return Hp(t,r=>e[r]>=n?e[r]:NaN)}function uM(t,e){return LT(t,.25,n=>e[n])}function eQ(t,e){return LT(t,.5,n=>e[n])}function fM(t,e){return LT(t,.75,n=>e[n])}function WF(t,e){const n=fM(t,e)*2.5-uM(t,e)*1.5;return El(t,r=>e[r]<=n?e[r]:NaN)}function nQ(){return(t,e)=>{const{encode:n}=e,{y:r,x:i}=n,{value:s}=r,{value:l}=i;return[Array.from(vc(t,p=>l[+p]).values()).flatMap(p=>{const m=GF(p,s),y=WF(p,s);return p.filter(x=>s[x]<m||s[x]>y)}),e]}}const XF=t=>{const{data:e,encode:n,style:r={},tooltip:i={},transform:s,animate:l}=t,u=HF(t,["data","encode","style","tooltip","transform","animate"]),{point:h=!0}=r,p=HF(r,["point"]),{y:m}=n,y={y:m,y1:m,y2:m,y3:m,y4:m},x={y1:uM,y2:eQ,y3:fM},T=Wm(i,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),C=Wm(i,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!h)return Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:JK},x),{y4:tQ})],encode:Object.assign(Object.assign({},n),y),style:p,tooltip:T},u);const M=ho(p,"box"),I=ho(p,"point");return[Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:GF},x),{y4:WF})],encode:Object.assign(Object.assign({},n),y),style:M,tooltip:T,animate:Xm(l,"box")},u),{type:"point",data:e,transform:[{type:nQ}],encode:n,style:Object.assign({},I),tooltip:C,animate:Xm(l,"point")}]};XF.props={};const YF=(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))/2,rQ=(t,e)=>{if(!e)return;const{coordinate:n}=e;if(!(n!=null&&n.getCenter))return;const r=n.getCenter();return(i,s,l)=>{const{document:u}=e.canvas,{color:h,index:p}=s,m=u.createElement("g",{}),y=YF(i[0],i[1]),x=YF(i[0],r)*2,T=u.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...i[0]],["A",y,y,0,1,0,...i[1]],["A",x+y*2,x+y*2,0,0,0,...i[2]],["A",y,y,0,1,p===0?0:1,...i[3]],["A",x,x,0,0,1,...i[0]],["Z"]]},l),oc(t,["shape","last","first"])),{fill:h||l.color})});return m.appendChild(T),m}};var vw=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const iQ=(t,e)=>{const{shape:n,radius:r}=t,i=vw(t,["shape","radius"]),s=ho(i,"pointer"),l=ho(i,"pin"),{shape:u}=s,h=vw(s,["shape"]),{shape:p}=l,m=vw(l,["shape"]),{coordinate:y,theme:x}=e;return(T,C)=>{const M=T.map(Ft=>y.invert(Ft)),[I,D,U]=SA(y,"polar"),Z=y.clone(),{color:G}=C,W=Bx({startAngle:I,endAngle:D,innerRadius:U,outerRadius:r});W.push(["cartesian"]),Z.update({transformations:W});const $=M.map(Ft=>Z.map(Ft)),[J,nt]=as($),[dt,Et]=y.getCenter(),Pt=Object.assign(Object.assign({x1:J,y1:nt,x2:dt,y2:Et,stroke:G},h),i),Ht=Object.assign(Object.assign({cx:dt,cy:Et,stroke:G},m),i),Ct=Ra(new Ai);return X0(u)||(typeof u=="function"?Ct.append(()=>u($,C,Z,x)):Ct.append("line").call(Ln,Pt).node()),X0(p)||(typeof p=="function"?Ct.append(()=>p($,C,Z,x)):Ct.append("circle").call(Ln,Ht).node()),Ct.node()}},qF={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},oQ={style:{shape:iQ,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},aQ={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"}};function sQ(t){if((0,ge.Z)(t)){const e=Math.max(0,Math.min(t,1));return{percent:e,target:e,total:1}}return t}function lQ(t,e){const{name:n="score",target:r,total:i,percent:s,thresholds:l=[]}=sQ(t),u=s||r,h=s?1:i,p=Object.assign({y:{domain:[0,h]}},e);return l.length?{targetData:[{x:n,y:u,color:"target"}],totalData:l.map((m,y)=>({x:n,y:y>=1?m-l[y-1]:m,color:y})),target:u,total:h,scale:p}:{targetData:[{x:n,y:u,color:"target"}],totalData:[{x:n,y:u,color:"target"},{x:n,y:h-u,color:"total"}],target:u,total:h,scale:p}}function cQ(t,{target:e,total:n}){const{content:r}=t;return r?r(e,n):e.toString()}const $F=t=>{const{data:e={},scale:n={},style:r={},animate:i={},transform:s=[]}=t,l=vw(t,["data","scale","style","animate","transform"]),{targetData:u,totalData:h,target:p,total:m,scale:y}=lQ(e,n),x=ho(r,"text"),T=aA(r,["pointer","pin"]),C=ho(r,"arc"),M=C.shape;return[ti({},qF,Object.assign({type:"interval",transform:[{type:"stackY"}],data:h,scale:y,style:M==="round"?Object.assign(Object.assign({},C),{shape:rQ}):C,animate:typeof i=="object"?ho(i,"arc"):i},l)),ti({},qF,oQ,Object.assign({type:"point",data:u,scale:y,style:T,animate:typeof i=="object"?ho(i,"indicator"):i},l)),ti({},aQ,{style:Object.assign({text:cQ(x,{target:p,total:m})},x),animate:typeof i=="object"?ho(i,"text"):i})]};$F.props={};const KF=5e3;function QF(t,e,n){return t+(e-t)*n}function uQ(t,e,n,r){return e===0?[[t+1/2*n/Math.PI/2,r/2],[t+1/2*n/Math.PI,r],[t+n/4,r]]:e===1?[[t+1/2*n/Math.PI/2*(Math.PI-2),r],[t+1/2*n/Math.PI/2*(Math.PI-1),r/2],[t+n/4,0]]:e===2?[[t+1/2*n/Math.PI/2,-r/2],[t+1/2*n/Math.PI,-r],[t+n/4,-r]]:[[t+1/2*n/Math.PI/2*(Math.PI-2),-r],[t+1/2*n/Math.PI/2*(Math.PI-1),-r/2],[t+n/4,0]]}function fQ(t,e,n,r,i,s,l){const u=Math.ceil(2*t/n*4)*4,h=[];let p=r;for(;p<-Math.PI*2;)p+=Math.PI*2;for(;p>0;)p-=Math.PI*2;p=p/Math.PI/2*n;const m=s-t+p-t*2;h.push(["M",m,e]);let y=0;for(let x=0;x<u;++x){const T=x%4,C=uQ(x*n/4,T,n,i);h.push(["C",C[0][0]+m,-C[0][1]+e,C[1][0]+m,-C[1][1]+e,C[2][0]+m,-C[2][1]+e]),x===u-1&&(y=C[2][0])}return h.push(["L",y+m,l+t]),h.push(["L",m,l+t]),h.push(["Z"]),h}function hQ(t,e,n,r,i,s,l,u,h,p,m){const{fill:y,fillOpacity:x,opacity:T}=i;for(let C=0;C<r;C++){const M=r<=1?1:C/(r-1),I=fQ(u,l+u*n,h,0,u/40,t,e),D=m.createElement("path",{style:{d:I,fill:y,opacity:QF(.2,.9,M)*Number(T||x)}});s.appendChild(D);try{if(p===!1)return;const U=[{transform:"translate(0, 0)"},{transform:`translate(${h*2}, 0)`}];D.animate(U,{duration:QF(.5*KF,KF,M)*2,iterations:1/0})}catch(U){console.warn("off-screen group animate error!")}}}function dQ(t,e,n){return`
      M ${t} ${e-n} 
      a ${n} ${n} 0 1 0 0 ${n*2}
      a ${n} ${n} 0 1 0 0 ${-n*2}
      Z
    `}function pQ(t,e,n){const i=n*.618;return`
      M ${t-i} ${e-n}
      L ${t+i} ${e-n}
      L ${t+i} ${e+n}
      L ${t-i} ${e+n}
      Z
    `}function mQ(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e}
      L ${t} ${e+n}
      L ${t-n} ${e}
      Z
    `}function vQ(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e+n}
      L ${t-n} ${e+n}
      Z
    `}function gQ(t,e,n){const r=n*4/3,i=Math.max(r,n*2),s=r/2,l=t,u=s+e-i/2,h=Math.asin(s/((i-s)*.85)),p=Math.sin(h)*s,m=Math.cos(h)*s,y=l-m,x=u+p,T=t,C=u+s/Math.sin(h);return`
      M ${y} ${x}
      A ${s} ${s} 0 1 1 ${y+m*2} ${x}
      Q ${T} ${C} ${t} ${e+i/2}
      Q ${T} ${C} ${y} ${x}
      Z 
    `}const JF={pin:gQ,rect:pQ,circle:dQ,diamond:mQ,triangle:vQ};var t8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const yQ=(t="circle")=>JF[t]||JF.circle,e8=(t,e)=>{if(!e)return;const{coordinate:n}=e,{liquidOptions:r,styleOptions:i}=t,{liquidShape:s,percent:l}=r,{background:u,outline:h={},wave:p={}}=i,m=t8(i,["background","outline","wave"]),{border:y=2,distance:x=0}=h,T=t8(h,["border","distance"]),{length:C=192,count:M=3}=p;return(I,D,U)=>{const{document:Z}=e.canvas,{color:G,fillOpacity:W}=U,$=Object.assign(Object.assign({fill:G},U),m),J=Z.createElement("g",{}),[nt,dt]=n.getCenter(),Et=n.getSize(),Pt=Math.min(...Et)/2,Ct=(Ih(s)?s:yQ(s))(nt,dt,Pt,...Et);if(Object.keys(u).length){const qt=Z.createElement("path",{style:Object.assign({d:Ct,fill:"#fff"},u)});J.appendChild(qt)}if(l>0){const qt=Z.createElement("path",{style:{d:Ct}});J.appendChild(qt),J.style.clipPath=qt,hQ(nt,dt,1-l,M,$,J,qt.getBBox().y,Pt*2,C,!0,Z)}const Ft=Z.createElement("path",{style:{d:Ct,fill:"transparent",lineWidth:y+2*x,stroke:"#fff"}}),jt=Z.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:Ct,stroke:G,strokeOpacity:W,lineWidth:y},$),T),{fill:"transparent"})});return J.appendChild(Ft),J.appendChild(jt),J}};e8.props={};var _Q=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const xQ={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:e8},animate:{enter:{type:"fadeIn"}}},bQ={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},n8=t=>{const{data:e={},style:n={},animate:r}=t,i=_Q(t,["data","style","animate"]),s=Math.max(0,(0,ge.Z)(e)?e:e==null?void 0:e.percent),l=[{percent:s,type:"liquid"}],u=Object.assign(Object.assign({},ho(n,"text")),ho(n,"content")),h=ho(n,"outline"),p=ho(n,"wave"),m=ho(n,"background");return[ti({},xQ,Object.assign({type:"interval",data:l,style:{liquidOptions:{percent:s,liquidShape:n==null?void 0:n.shape},styleOptions:Object.assign(Object.assign({},n),{outline:h,wave:p,background:m})},animate:r},i)),ti({},bQ,{style:Object.assign({text:`${q_(s*100)} %`},u),animate:r})]};n8.props={};var Zv=it(69916);const r8=1e-10;function i8(t,e){const n=SQ(t),r=n.filter(function(h){return EQ(h,t)});let i=0,s=0,l;const u=[];if(r.length>1){const h=TQ(r);for(l=0;l<r.length;++l){const m=r[l];m.angle=Math.atan2(m.x-h.x,m.y-h.y)}r.sort(function(m,y){return y.angle-m.angle});let p=r[r.length-1];for(l=0;l<r.length;++l){const m=r[l];s+=(p.x+m.x)*(m.y-p.y);const y={x:(m.x+p.x)/2,y:(m.y+p.y)/2};let x=null;for(let T=0;T<m.parentIndex.length;++T)if(p.parentIndex.indexOf(m.parentIndex[T])>-1){const C=t[m.parentIndex[T]],M=Math.atan2(m.x-C.x,m.y-C.y),I=Math.atan2(p.x-C.x,p.y-C.y);let D=I-M;D<0&&(D+=2*Math.PI);const U=I-D/2;let Z=O2(y,{x:C.x+C.radius*Math.sin(U),y:C.y+C.radius*Math.cos(U)});Z>C.radius*2&&(Z=C.radius*2),(x===null||x.width>Z)&&(x={circle:C,width:Z,p1:m,p2:p})}x!==null&&(u.push(x),i+=hM(x.circle.radius,x.width),p=m)}}else{let h=t[0];for(l=1;l<t.length;++l)t[l].radius<h.radius&&(h=t[l]);let p=!1;for(l=0;l<t.length;++l)if(O2(t[l],h)>Math.abs(h.radius-t[l].radius)){p=!0;break}p?i=s=0:(i=h.radius*h.radius*Math.PI,u.push({circle:h,p1:{x:h.x,y:h.y+h.radius},p2:{x:h.x-r8,y:h.y+h.radius},width:h.radius*2}))}return s/=2,e&&(e.area=i+s,e.arcArea=i,e.polygonArea=s,e.arcs=u,e.innerPoints=r,e.intersectionPoints=n),i+s}function EQ(t,e){for(let n=0;n<e.length;++n)if(O2(t,e[n])>e[n].radius+r8)return!1;return!0}function SQ(t){const e=[];for(let n=0;n<t.length;++n)for(let r=n+1;r<t.length;++r){const i=a8(t[n],t[r]);for(let s=0;s<i.length;++s){const l=i[s];l.parentIndex=[n,r],e.push(l)}}return e}function hM(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function O2(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function o8(t,e,n){if(n>=t+e)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);const r=t-(n*n-e*e+t*t)/(2*n),i=e-(n*n-t*t+e*e)/(2*n);return hM(t,r)+hM(e,i)}function a8(t,e){const n=O2(t,e),r=t.radius,i=e.radius;if(n>=r+i||n<=Math.abs(r-i))return[];const s=(r*r-i*i+n*n)/(2*n),l=Math.sqrt(r*r-s*s),u=t.x+s*(e.x-t.x)/n,h=t.y+s*(e.y-t.y)/n,p=-(e.y-t.y)*(l/n),m=-(e.x-t.x)*(l/n);return[{x:u+p,y:h-m},{x:u-p,y:h+m}]}function TQ(t){const e={x:0,y:0};for(let n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}function wQ(t,e){e=e||{},e.maxIterations=e.maxIterations||500;const n=e.initialLayout||RQ,r=e.lossFunction||pM;t=AQ(t);const i=n(t,e),s=[],l=[];let u;for(u in i)i.hasOwnProperty(u)&&(s.push(i[u].x),s.push(i[u].y),l.push(u));const p=(0,Zv.nelderMead)(function(m){const y={};for(let x=0;x<l.length;++x){const T=l[x];y[T]={x:m[2*x],y:m[2*x+1],radius:i[T].radius}}return r(y,t)},s,e).x;for(let m=0;m<l.length;++m)u=l[m],i[u].x=p[2*m],i[u].y=p[2*m+1];return i}const s8=1e-10;function dM(t,e,n){return Math.min(t,e)*Math.min(t,e)*Math.PI<=n+s8?Math.abs(t-e):(0,Zv.bisect)(function(r){return o8(t,e,r)-n},0,t+e)}function AQ(t){t=t.slice();const e=[],n={};let r,i,s,l;for(r=0;r<t.length;++r){const u=t[r];u.sets.length==1?e.push(u.sets[0]):u.sets.length==2&&(s=u.sets[0],l=u.sets[1],n[[s,l]]=!0,n[[l,s]]=!0)}for(e.sort((u,h)=>u>h?1:-1),r=0;r<e.length;++r)for(s=e[r],i=r+1;i<e.length;++i)l=e[i],[s,l]in n||t.push({sets:[s,l],size:0});return t}function OQ(t,e,n){const r=(0,Zv.zerosM)(e.length,e.length),i=(0,Zv.zerosM)(e.length,e.length);return t.filter(function(s){return s.sets.length==2}).map(function(s){const l=n[s.sets[0]],u=n[s.sets[1]],h=Math.sqrt(e[l].size/Math.PI),p=Math.sqrt(e[u].size/Math.PI),m=dM(h,p,s.size);r[l][u]=r[u][l]=m;let y=0;s.size+1e-10>=Math.min(e[l].size,e[u].size)?y=1:s.size<=1e-10&&(y=-1),i[l][u]=i[u][l]=y}),{distances:r,constraints:i}}function CQ(t,e,n,r){let i=0,s;for(s=0;s<e.length;++s)e[s]=0;for(s=0;s<n.length;++s){const l=t[2*s],u=t[2*s+1];for(let h=s+1;h<n.length;++h){const p=t[2*h],m=t[2*h+1],y=n[s][h],x=r[s][h],T=(p-l)*(p-l)+(m-u)*(m-u),C=Math.sqrt(T),M=T-y*y;x>0&&C<=y||x<0&&C>=y||(i+=2*M*M,e[2*s]+=4*M*(l-p),e[2*s+1]+=4*M*(u-m),e[2*h]+=4*M*(p-l),e[2*h+1]+=4*M*(m-u))}}return i}function RQ(t,e){let n=PQ(t,e);const r=e.lossFunction||pM;if(t.length>=8){const i=MQ(t,e),s=r(i,t),l=r(n,t);s+1e-8<l&&(n=i)}return n}function MQ(t,e){e=e||{};const n=e.restarts||10,r=[],i={};let s;for(s=0;s<t.length;++s){const M=t[s];M.sets.length==1&&(i[M.sets[0]]=r.length,r.push(M))}const l=OQ(t,r,i);let u=l.distances;const h=l.constraints,p=(0,Zv.norm2)(u.map(Zv.norm2))/u.length;u=u.map(function(M){return M.map(function(I){return I/p})});const m=function(M,I){return CQ(M,I,u,h)};let y,x;for(s=0;s<n;++s){const M=(0,Zv.zeros)(u.length*2).map(Math.random);x=(0,Zv.conjugateGradient)(m,M,e),(!y||x.fx<y.fx)&&(y=x)}const T=y.x,C={};for(s=0;s<r.length;++s){const M=r[s];C[M.sets[0]]={x:T[2*s]*p,y:T[2*s+1]*p,radius:Math.sqrt(M.size/Math.PI)}}if(e.history)for(s=0;s<e.history.length;++s)(0,Zv.scale)(e.history[s].x,p);return C}function PQ(t,e){const n=e&&e.lossFunction?e.lossFunction:pM,r={},i={};let s;for(let y=0;y<t.length;++y){const x=t[y];x.sets.length==1&&(s=x.sets[0],r[s]={x:1e10,y:1e10,rowid:Object.keys(r).length,size:x.size,radius:Math.sqrt(x.size/Math.PI)},i[s]=[])}t=t.filter(function(y){return y.sets.length==2});for(let y=0;y<t.length;++y){const x=t[y];let T=x.hasOwnProperty("weight")?x.weight:1;const C=x.sets[0],M=x.sets[1];x.size+s8>=Math.min(r[C].size,r[M].size)&&(T=0),i[C].push({set:M,size:x.size,weight:T}),i[M].push({set:C,size:x.size,weight:T})}const l=[];for(s in i)if(i.hasOwnProperty(s)){let y=0;for(let x=0;x<i[s].length;++x)y+=i[s][x].size*i[s][x].weight;l.push({set:s,size:y})}function u(y,x){return x.size-y.size}l.sort(u);const h={};function p(y){return y.set in h}function m(y,x){r[x].x=y.x,r[x].y=y.y,h[x]=!0}m({x:0,y:0},l[0].set);for(let y=1;y<l.length;++y){const x=l[y].set,T=i[x].filter(p);if(s=r[x],T.sort(u),T.length===0)throw"ERROR: missing pairwise overlap information";const C=[];for(let D=0;D<T.length;++D){const U=r[T[D].set],Z=dM(s.radius,U.radius,T[D].size);C.push({x:U.x+Z,y:U.y}),C.push({x:U.x-Z,y:U.y}),C.push({y:U.y+Z,x:U.x}),C.push({y:U.y-Z,x:U.x});for(let G=D+1;G<T.length;++G){const W=r[T[G].set],$=dM(s.radius,W.radius,T[G].size),J=a8({x:U.x,y:U.y,radius:Z},{x:W.x,y:W.y,radius:$});for(let nt=0;nt<J.length;++nt)C.push(J[nt])}}let M=1e50,I=C[0];for(let D=0;D<C.length;++D){r[x].x=C[D].x,r[x].y=C[D].y;const U=n(r,t);U<M&&(M=U,I=C[D])}m(I,x)}return r}function pM(t,e){let n=0;function r(i){return i.map(function(s){return t[s]})}for(let i=0;i<e.length;++i){const s=e[i];let l;if(s.sets.length==1)continue;if(s.sets.length==2){const h=t[s.sets[0]],p=t[s.sets[1]];l=o8(h.radius,p.radius,O2(h,p))}else l=i8(r(s.sets));const u=s.hasOwnProperty("weight")?s.weight:1;n+=u*(l-s.size)*(l-s.size)}return n}function IQ(t,e,n){n===null?t.sort(function(i,s){return s.radius-i.radius}):t.sort(n);let r;if(t.length>0){const i=t[0].x,s=t[0].y;for(r=0;r<t.length;++r)t[r].x-=i,t[r].y-=s}if(t.length==2&&distance(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){const i=Math.atan2(t[1].x,t[1].y)-e;let s,l;const u=Math.cos(i),h=Math.sin(i);for(r=0;r<t.length;++r)s=t[r].x,l=t[r].y,t[r].x=u*s-h*l,t[r].y=h*s+u*l}if(t.length>2){let i=Math.atan2(t[2].x,t[2].y)-e;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){const s=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){const l=(t[r].x+s*t[r].y)/(1+s*s);t[r].x=2*l-t[r].x,t[r].y=2*l*s-t[r].y}}}}function LQ(t){t.map(function(l){l.parent=l});function e(l){return l.parent!==l&&(l.parent=e(l.parent)),l.parent}function n(l,u){const h=e(l),p=e(u);h.parent=p}for(let l=0;l<t.length;++l)for(let u=l+1;u<t.length;++u){const h=t[l].radius+t[u].radius;distance(t[l],t[u])+1e-10<h&&n(t[u],t[l])}const r={};let i;for(let l=0;l<t.length;++l)i=e(t[l]).parent.setid,i in r||(r[i]=[]),r[i].push(t[l]);t.map(function(l){delete l.parent});const s=[];for(i in r)r.hasOwnProperty(i)&&s.push(r[i]);return s}function mM(t){const e=function(n){const r=Math.max.apply(null,t.map(function(s){return s[n]+s.radius})),i=Math.min.apply(null,t.map(function(s){return s[n]-s.radius}));return{max:r,min:i}};return{xRange:e("x"),yRange:e("y")}}function rnt(t,e,n){e===null&&(e=Math.PI/2);let r=[],i,s;for(s in t)if(t.hasOwnProperty(s)){const x=t[s];r.push({x:x.x,y:x.y,radius:x.radius,setid:s})}const l=LQ(r);for(i=0;i<l.length;++i){IQ(l[i],e,n);const x=mM(l[i]);l[i].size=(x.xRange.max-x.xRange.min)*(x.yRange.max-x.yRange.min),l[i].bounds=x}l.sort(function(x,T){return T.size-x.size}),r=l[0];let u=r.bounds;const h=(u.xRange.max-u.xRange.min)/50;function p(x,T,C){if(!x)return;const M=x.bounds;let I,D,U;T?I=u.xRange.max-M.xRange.min+h:(I=u.xRange.max-M.xRange.max,U=(M.xRange.max-M.xRange.min)/2-(u.xRange.max-u.xRange.min)/2,U<0&&(I+=U)),C?D=u.yRange.max-M.yRange.min+h:(D=u.yRange.max-M.yRange.max,U=(M.yRange.max-M.yRange.min)/2-(u.yRange.max-u.yRange.min)/2,U<0&&(D+=U));for(let Z=0;Z<x.length;++Z)x[Z].x+=I,x[Z].y+=D,r.push(x[Z])}let m=1;for(;m<l.length;)p(l[m],!0,!1),p(l[m+1],!1,!0),p(l[m+2],!0,!0),m+=3,u=mM(r);const y={};for(i=0;i<r.length;++i)y[r[i].setid]=r[i];return y}function DQ(t,e,n,r){const i=[],s=[];for(const M in t)t.hasOwnProperty(M)&&(s.push(M),i.push(t[M]));e-=2*r,n-=2*r;const l=mM(i),u=l.xRange,h=l.yRange;if(u.max==u.min||h.max==h.min)return console.log("not scaling solution: zero size detected"),t;const p=e/(u.max-u.min),m=n/(h.max-h.min),y=Math.min(m,p),x=(e-(u.max-u.min)*y)/2,T=(n-(h.max-h.min)*y)/2,C={};for(let M=0;M<i.length;++M){const I=i[M];C[s[M]]={radius:y*I.radius,x:r+x+(I.x-u.min)*y,y:r+T+(I.y-h.min)*y}}return C}function NQ(t,e,n){const r=[],i=t-n,s=e;return r.push("M",i,s),r.push("A",n,n,0,1,0,i+2*n,s),r.push("A",n,n,0,1,0,i,s),r.join(" ")}function kQ(t){const e={};i8(t,e);const n=e.arcs;if(n.length===0)return"M 0 0";if(n.length==1){const r=n[0].circle;return NQ(r.x,r.y,r.radius)}else{const r=[`
M`,n[0].p2.x,n[0].p2.y];for(let i=0;i<n.length;++i){const s=n[i],l=s.circle.radius,u=s.width>l;r.push(`
A`,l,l,0,u?1:0,1,s.p1.x,s.p1.y)}return r.join(" ")}}const l8=t=>{const{sets:e="sets",size:n="size",as:r=["key","path"],padding:i=0}=t,[s,l]=r;return u=>{const h=u.map(y=>Object.assign(Object.assign({},y),{sets:y[e],size:y[n],[s]:y.sets.join("&")}));h.sort((y,x)=>y.sets.length-x.sets.length);const p=wQ(h);let m;return h.map(y=>{const x=y[e],T=({width:C,height:M})=>{m=m||DQ(p,C,M,i);const I=x.map(U=>m[U]);let D=kQ(I);return/[zZ]$/.test(D)||(D+=" Z"),D};return Object.assign(Object.assign({},y),{[l]:T})})}};l8.props={};function BQ(){return{"data.venn":l8,"mark.boxplot":XF,"mark.gauge":$F,"mark.wordCloud":EC,"mark.liquid":n8}}function FQ(){return Object.assign(Object.assign(Object.assign(Object.assign({},qq()),QK()),BQ()),GY())}var gw=function(){return gw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},gw.apply(this,arguments)},UQ=bj(xj,gw(gw({},FQ()),oV())),vM=it(73505),C2=function(){return C2=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},C2.apply(this,arguments)},zQ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},jQ=["renderer"],c8=["width","height","autoFit","theme","inset","insetLeft","insetRight","insetTop","insetBottom","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","depth","title","clip","children","type","data","direction"],gM="__transform__",VQ="__skipDelCustomKeys__",S_=function(t,e){return(0,vM.Z)(e)?{type:t,available:e}:C2({type:t},e)},yM={xField:"encode.x",yField:"encode.y",colorField:"encode.color",angleField:"encode.y",keyField:"encode.key",sizeField:"encode.size",shapeField:"encode.shape",seriesField:"encode.series",positionField:"encode.position",textField:"encode.text",valueField:"encode.value",binField:"encode.x",srcField:"encode.src",linkColorField:"encode.linkColor",fontSizeField:"encode.fontSize",radius:"coordinate.outerRadius",innerRadius:"coordinate.innerRadius",startAngle:"coordinate.startAngle",endAngle:"coordinate.endAngle",focusX:"coordinate.focusX",focusY:"coordinate.focusY",distortionX:"coordinate.distortionX",distortionY:"coordinate.distortionY",visual:"coordinate.visual",stack:{target:"transform",value:function(t){return S_("stackY",t)}},normalize:{target:"transform",value:function(t){return S_("normalizeY",t)}},percent:{target:"transform",value:function(t){return S_("normalizeY",t)}},group:{target:"transform",value:function(t){return S_("dodgeX",t)}},sort:{target:"transform",value:function(t){return S_("sortX",t)}},symmetry:{target:"transform",value:function(t){return S_("symmetryY",t)}},diff:{target:"transform",value:function(t){return S_("diffY",t)}},meta:{target:"scale",value:function(t){return t}},label:{target:"labels",value:function(t){return t}},shape:"style.shape",connectNulls:{target:"style",value:function(t){return(0,vM.Z)(t)?{connect:t}:t}}},_M=["xField","yField","seriesField","colorField","keyField","positionField","meta","tooltip","animate","stack","normalize","percent","group","sort","symmetry","diff"],yw=[{key:"annotations",extend_keys:[]},{key:"line",type:"line",extend_keys:_M},{key:"point",type:"point",extend_keys:_M},{key:"area",type:"area",extend_keys:_M}],ZQ=[{key:"transform",callback:function(t,e,n){var r;t[e]=t[e]||[];var i=n.available,s=i===void 0?!0:i,l=zQ(n,["available"]);if(s)t[e].push(C2((r={},r[gM]=!0,r),l));else{var u=t[e].indexOf(function(h){return h.type===n.type});u!==-1&&t[e].splice(u,1)}}},{key:"labels",callback:function(t,e,n){var r;if(!n||(0,we.Z)(n)){t[e]=n||[];return}n.text||(n.text=t.yField),t[e]=t[e]||[],t[e].push(C2((r={},r[gM]=!0,r),n))}}],xM=[{key:"conversionTag",shape:"ConversionTag"},{key:"axisText",shape:"BidirectionalBarAxisText"}],HQ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_w=function(){return _w=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},_w.apply(this,arguments)},GQ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},WQ=function(t){HQ(e,t);function e(n){n===void 0&&(n={});var r=n.style,i=GQ(n,["style"]);return t.call(this,_w({style:_w({fill:"#eee"},r)},i))||this}return e}(Ta),XQ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),xw=function(){return xw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},xw.apply(this,arguments)},YQ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},u8=function(t){XQ(e,t);function e(n){n===void 0&&(n={});var r=n.style,i=YQ(n,["style"]);return t.call(this,xw({style:xw({text:"",fontSize:12,textBaseline:"middle",textAlign:"center",fill:"#000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1},r)},i))||this}return e}(pa),qQ=it(19177),f8=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))},$Q=function(t,e){if((0,we.Z)(e))return e},Qg=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qQ.Z.apply(void 0,f8(f8([],t,!1),[$Q],!1))},KQ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),h8=function(t){KQ(e,t);function e(n,r,i){var s=t.call(this,{style:Qg(i,r)})||this;return s.chart=n,s}return e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},e.prototype.disconnectedCallback=function(){},e.prototype.attributeChangedCallback=function(n){},e.prototype.update=function(n,r){var i;return this.attr(Qg({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.getElementsLayout=function(){var n=this.chart.getContext().canvas,r=n.document.getElementsByClassName("element"),i=[];return r.forEach(function(s){var l=s.getBBox(),u=l.x,h=l.y,p=l.width,m=l.height,y=s.__data__;i.push({bbox:l,x:u,y:h,width:p,height:m,key:y.key,data:y})}),i},e.prototype.bindEvents=function(n,r){},e}(Wr),QQ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),bw=function(){return bw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},bw.apply(this,arguments)},JQ=function(t){QQ(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.getConversionTagLayout=function(){var n=this.direction==="vertical",r=this.getElementsLayout(),i=r[0],s=i.x,l=i.y,u=i.height,h=i.width,p=i.data,m=["items",0,"value"],y=(0,un.Z)(p,m),x=n?r[1].y-l-u:r[1].x-s-h,T=[],C=this.attributes,M=C.size,I=M===void 0?40:M,D=C.arrowSize,U=D===void 0?20:D,Z=C.spacing,G=Z===void 0?4:Z;return r.forEach(function(W,$){if($>0){var J=W.x,nt=W.y,dt=W.height,Et=W.width,Pt=W.data,Ht=W.key,Ct=(0,un.Z)(Pt,m),Ft=I/2;if(n){var jt=J+Et/2,qt=nt;T.push({points:[[jt+Ft,qt-x+G],[jt+Ft,qt-U-G],[jt,qt-G],[jt-Ft,qt-U-G],[jt-Ft,qt-x+G]],center:[jt,qt-x/2-G],width:x,value:[y,Ct],key:Ht})}else{var jt=J,qt=nt+dt/2;T.push({points:[[J-x+G,qt-Ft],[J-U-G,qt-Ft],[jt-G,qt],[J-U-G,qt+Ft],[J-x+G,qt+Ft]],center:[jt-x/2-G,qt],width:x,value:[y,Ct],key:Ht})}y=Ct}}),T},e.prototype.render=function(){this.setDirection(),this.drawConversionTag()},e.prototype.setDirection=function(){var n=this.chart.getCoordinate(),r=(0,un.Z)(n,"options.transformations"),i="horizontal";r.forEach(function(s){s.includes("transpose")&&(i="vertical")}),this.direction=i},e.prototype.drawConversionTag=function(){var n=this,r=this.getConversionTagLayout(),i=this.attributes,s=i.style,l=i.text,u=l.style,h=l.formatter;r.forEach(function(p){var m=p.points,y=p.center,x=p.value,T=p.key,C=x[0],M=x[1],I=y[0],D=y[1],U=new WQ({style:bw({points:m,fill:"#eee"},s),id:"polygon-".concat(T)}),Z=new u8({style:bw({x:I,y:D,text:(0,Zt.Z)(h)?h(C,M):(M/C*100).toFixed(2)+"%"},u),id:"text-".concat(T)});n.appendChild(U),n.appendChild(Z)})},e.prototype.update=function(){var n=this,r=this.getConversionTagLayout();r.forEach(function(i){var s=i.points,l=i.center,u=i.key,h=l[0],p=l[1],m=n.getElementById("polygon-".concat(u)),y=n.getElementById("text-".concat(u));m.setAttribute("points",s),y.setAttribute("x",h),y.setAttribute("y",p)})},e.tag="ConversionTag",e}(h8),bM=it(87783),d8=it(15643),EM=32,p8=16,m8=48,tJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),R2=function(){return R2=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},R2.apply(this,arguments)},eJ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},nJ=function(t){tJ(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.render=function(){this.drawText()},e.prototype.getBidirectionalBarAxisTextLayout=function(){var n=this.attributes.layout,r=n==="vertical",i=this.getElementsLayout(),s=r?(0,bM.Z)(i,"x"):(0,bM.Z)(i,"y"),l=["title"],u=[],h=this.chart.getContext().views,p=(0,un.Z)(h,[0,"layout"]),m=p.width,y=p.height;return s.forEach(function(x){var T=x.x,C=x.y,M=x.height,I=x.width,D=x.data,U=x.key,Z=(0,un.Z)(D,l);r?u.push({x:T+I/2,y,text:Z,key:U}):u.push({x:m,y:C+M/2,text:Z,key:U})}),(0,bM.Z)(u,"text").length!==u.length&&(u=Object.values((0,d8.Z)(u,"text")).map(function(x){var T,C=x.reduce(function(M,I){return M+(r?I.x:I.y)},0);return R2(R2({},x[0]),(T={},T[r?"x":"y"]=C/x.length,T))})),u},e.prototype.transformLabelStyle=function(n){var r={},i=/^label[A-Z]/;return Object.keys(n).forEach(function(s){i.test(s)&&(r[s.replace("label","").replace(/^[A-Z]/,function(l){return l.toLowerCase()})]=n[s])}),r},e.prototype.drawText=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout(),i=this.attributes,s=i.layout,l=i.labelFormatter,u=eJ(i,["layout","labelFormatter"]);r.forEach(function(h){var p=h.x,m=h.y,y=h.text,x=h.key,T=new u8({style:R2({x:p,y:m,text:(0,Zt.Z)(l)?l(y):y,wordWrap:!0,wordWrapWidth:s==="horizontal"?EM*2:120,maxLines:2,textOverflow:"ellipsis"},n.transformLabelStyle(u)),id:"text-".concat(x)});n.appendChild(T)})},e.prototype.update=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout();r.forEach(function(i){var s=i.x,l=i.y,u=i.key,h=n.getElementById("text-".concat(u));h.setAttribute("x",s),h.setAttribute("y",l)})},e.tag="BidirectionalBarAxisText",e}(h8),rJ={ConversionTag:JQ,BidirectionalBarAxisText:nJ},iJ=function(){function t(e,n){this.container=new Map,this.chart=e,this.config=n,this.init()}return t.prototype.init=function(){var e=this;xM.forEach(function(n){var r,i=n.key,s=n.shape,l=e.config[i];if(l){var u=new rJ[s](e.chart,l),h=e.chart.getContext().canvas;h.appendChild(u),e.container.set(i,u)}else(r=e.container.get(i))===null||r===void 0||r.clear()})},t.prototype.update=function(){var e=this;this.container.size&&xM.forEach(function(n){var r=n.key,i=e.container.get(r);i==null||i.update()})},t}(),v8=it(69441),oJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),tx=function(){return tx=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},tx.apply(this,arguments)},g8="data-chart-source-type",Sl=function(t){oJ(e,t);function e(n,r){var i=t.call(this)||this;return i.container=typeof n=="string"?document.getElementById(n):n,i.options=i.mergeOption(r),i.createG2(),i.bindEvents(),i}return e.prototype.getChartOptions=function(){return tx(tx({},(0,v8.Z)(this.options,jQ)),{container:this.container})},e.prototype.getSpecOptions=function(){return this.type==="base"||this[VQ]?tx(tx({},this.options),this.getChartOptions()):this.options},e.prototype.createG2=function(){if(!this.container)throw Error("The container is not initialized!");this.chart=new UQ(this.getChartOptions()),this.container.setAttribute(g8,"Ant Design Charts")},e.prototype.bindEvents=function(){var n=this;this.chart&&this.chart.on("*",function(r){r!=null&&r.type&&n.emit(r.type,r)})},e.prototype.getBaseOptions=function(){return{type:"view",autoFit:!0}},e.prototype.getDefaultOptions=function(){},e.prototype.render=function(){var n=this;this.type!=="base"&&this.execAdaptor(),this.chart.options(this.getSpecOptions()),this.chart.render().then(function(){n.annotation=new iJ(n.chart,n.options)}),this.bindSizeSensor()},e.prototype.update=function(n){this.options=this.mergeOption(n)},e.prototype.mergeOption=function(n){return Qg({},this.getBaseOptions(),this.getDefaultOptions(),n)},e.prototype.changeData=function(n){this.chart.changeData(n)},e.prototype.changeSize=function(n,r){this.chart.changeSize(n,r)},e.prototype.destroy=function(){this.chart.destroy(),this.off(),this.container.removeAttribute(g8)},e.prototype.execAdaptor=function(){var n=this.getSchemaAdaptor();n({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var n=this,r=this.options.autoFit,i=r===void 0?!0:r;i&&this.chart.on(bl.AFTER_CHANGE_SIZE,function(){n.annotation.update()})},e}(wn),aJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sJ=function(t){aJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="base",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return function(n){return n}},e}(Sl),Ll=it(99503),lJ=function(t){var e=t.options,n=e.children,r=n===void 0?[]:n;return r.forEach(function(i){Object.keys(i).forEach(function(s){(0,we.Z)(i[s])&&s!=="data"&&(i[s]=i[s].filter(function(l){return!l[gM]}))})}),e},SM=it(32180),cJ=it(49360),Na=it(48707),y8=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))},uJ=function(t){var e=t.children,n=e===void 0?[]:e,r=Object.keys(yM).concat(yw.map(function(i){return i.key}));return r.forEach(function(i){delete t[i]}),n.forEach(function(i){Object.keys(i).forEach(function(s){r.includes(s)&&delete i[s]})}),Object.keys(t).forEach(function(i){y8(y8([],c8,!0),xM.map(function(s){return s.key}),!0).includes(i)||delete t[i]}),t},Hl=function(t){var e=lJ(t),n=e.children,r=n===void 0?[]:n,i=(0,SM.Z)(e,[].concat(c8,yw.map(function(p){return p.key}))),s=function(p){var m;return(m=ZQ.find(function(y){return y.key===p}))===null||m===void 0?void 0:m.callback},l=function(p,m,y){var x=s(m);x?x(p,m,y):p[m]=Qg({},p[m],y)},u=function(p){Object.keys(p).forEach(function(m){if(p[m]){var y=yw.find(function(C){return C.key===m});if(y){var x=y.type,T=y.extend_keys;x?r.push(h(Qg({},(0,v8.Z)(p,T),{type:x},p[m]))):(0,we.Z)(p[m])&&p[m].forEach(function(C){r.push(h(C))})}}})},h=function(p){return u(p),Object.keys(yM).forEach(function(m){var y=yM[m];if(!(0,cJ.Z)(p[m]))if((0,ie.Z)(y)){var x=y.value,T=y.target,C=x(p[m]);l(p,T,C)}else(0,Na.Z)(p,y,p[m])}),p};return r.forEach(function(p){var m=Qg({},i,p);h(Qg(p,m))}),u(e),uJ(e),t},TM=function(){return TM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},TM.apply(this,arguments)};function fJ(t){var e=t.options,n=e.stack,r=e.tooltip,i=e.xField;if(!n)return t;var s=yw.map(function(u){return u.type}).filter(function(u){return!!u}),l=!1;return s.forEach(function(u){e[u]&&(l=!0,(0,Na.Z)(e,[u,"stack"],TM({y1:"y"},typeof n=="object"?n:{})))}),l&&!(0,vM.Z)(r)&&!r&&(0,Na.Z)(e,"tooltip",{title:i,items:[{channel:"y"}]}),t}function Au(t){return(0,Ll.Z)(fJ)(t)}function hJ(t){return(0,Ll.Z)(Au,Hl)(t)}var dJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pJ=function(t){dJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="area",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"area"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return hJ},e}(Sl),ex=function(){return ex=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ex.apply(this,arguments)};function _8(t){var e=function(n){var r=n.options;(0,un.Z)(r,"children.length")>1&&(0,Na.Z)(r,"children",[{type:"interval"}]);var i=r.scale,s=r.markBackground,l=r.data,u=r.children,h=r.yField,p=(0,un.Z)(i,"y.domain",[]);if(s&&p.length&&(0,we.Z)(l)){var m="domainMax",y=l.map(function(x){var T;return ex(ex({originData:ex({},x)},(0,SM.Z)(x,h)),(T={},T[m]=p[p.length-1],T))});u.unshift(ex({type:"interval",data:y,yField:m,tooltip:!1,style:{fill:"#eee"},label:!1},s))}return n};return(0,Ll.Z)(e,Au,Hl)(t)}var mJ=function(){var t=function(e,n){return function(r){var i=e.fill,s=i===void 0?"#2888FF":i,l=e.stroke,u=e.fillOpacity,h=u===void 0?1:u,p=e.strokeOpacity,m=p===void 0?.2:p,y=e.pitch,x=y===void 0?8:y,T=r[0],C=r[1],M=r[2],I=r[3],D=(C[1]-T[1])/2,U=n.document,Z=U.createElement("g",{}),G=U.createElement("polygon",{style:{points:[T,[T[0]-x,T[1]+D],[M[0]-x,T[1]+D],I],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),W=U.createElement("polygon",{style:{points:[[T[0]-x,T[1]+D],C,M,[M[0]-x,T[1]+D]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),$=U.createElement("polygon",{style:{points:[T,[T[0]-x,T[1]+D],C,[T[0]+x,T[1]+D]],fill:s,fillOpacity:h-.2}});return Z.appendChild(G),Z.appendChild(W),Z.appendChild($),Z}};Cw("shape.interval.bar25D",t)},vJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();mJ();var gJ=function(t){vJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Bar",n}return e.getDefaultOptions=function(){return{type:"view",coordinate:{transform:[{type:"transpose"}]},children:[{type:"interval"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _8},e}(Sl),yJ=function(){var t=function(e,n){return function(r){var i=e.fill,s=i===void 0?"#2888FF":i,l=e.stroke,u=e.fillOpacity,h=u===void 0?1:u,p=e.strokeOpacity,m=p===void 0?.2:p,y=e.pitch,x=y===void 0?8:y,T=r[1][0]-r[0][0],C=T/2+r[0][0],M=n.document,I=M.createElement("g",{}),D=M.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[C,r[1][1]+x],[C,r[3][1]+x],[r[3][0],r[3][1]]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),U=M.createElement("polygon",{style:{points:[[C,r[1][1]+x],[r[1][0],r[1][1]],[r[2][0],r[2][1]],[C,r[2][1]+x]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),Z=M.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[C,r[1][1]-x],[r[1][0],r[1][1]],[C,r[1][1]+x]],fill:s,fillOpacity:h-.2}});return I.appendChild(U),I.appendChild(D),I.appendChild(Z),I}};Cw("shape.interval.column25D",t)},_J=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();yJ();var xJ=function(t){_J(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _8},e}(Sl);function bJ(t){var e=function(r){var i=r.options,s=i.children,l=s===void 0?[]:s,u=i.legend;return u&&l.forEach(function(h){if(!(0,un.Z)(h,"colorField")){var p=(0,un.Z)(h,"yField");(0,Na.Z)(h,"colorField",function(){return p})}}),r},n=function(r){var i=r.options,s=i.annotations,l=s===void 0?[]:s,u=i.children,h=u===void 0?[]:u,p=i.scale,m=!1;return(0,un.Z)(p,"y.key")||h.forEach(function(y,x){if(!(0,un.Z)(y,"scale.y.key")){var T="child".concat(x,"Scale");(0,Na.Z)(y,"scale.y.key",T);var C=y.annotations,M=C===void 0?[]:C;M.length>0&&((0,Na.Z)(y,"scale.y.independent",!1),M.forEach(function(I){(0,Na.Z)(I,"scale.y.key",T)})),!m&&l.length>0&&(0,un.Z)(y,"scale.y.independent")===void 0&&(m=!0,(0,Na.Z)(y,"scale.y.independent",!1),l.forEach(function(I){(0,Na.Z)(I,"scale.y.key",T)}))}}),r};return(0,Ll.Z)(e,n,Au,Hl)(t)}var EJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),x8=function(t){EJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="DualAxes",n}return e.getDefaultOptions=function(){return{type:"view",axis:{y:{title:!1,tick:!1},x:{title:!1}},scale:{y:{independent:!0,nice:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return bJ},e}(Sl);function SJ(t){var e=function(s){var l=s.options,u=l.xField,h=l.colorField;return h||(0,Na.Z)(l,"colorField",u),s},n=function(s){var l=s.options,u=l.compareField,h=l.transform,p=l.isTransposed,m=p===void 0?!0:p,y=l.coordinate;return h||(u?(0,Na.Z)(l,"transform",[]):(0,Na.Z)(l,"transform",[{type:"symmetryY"}])),!y&&m&&(0,Na.Z)(l,"coordinate",{transform:[{type:"transpose"}]}),s},r=function(s){var l=s.options,u=l.compareField,h=l.seriesField,p=l.data,m=l.children,y=l.yField,x=l.isTransposed,T=x===void 0?!0:x;if(u||h){var C=Object.values((0,d8.Z)(p,function(M){return M[u||h]}));m[0].data=C[0],m.push({type:"interval",data:C[1],yField:function(M){return-M[y]}}),delete l.compareField,delete l.data}return h&&((0,Na.Z)(l,"type","spaceFlex"),(0,Na.Z)(l,"ratio",[1,1]),(0,Na.Z)(l,"direction",T?"row":"col"),delete l.seriesField),s},i=function(s){var l=s.options,u=l.tooltip,h=l.xField,p=l.yField;return u||(0,Na.Z)(l,"tooltip",{title:!1,items:[function(m){return{name:m[h],value:m[p]}}]}),s};return(0,Ll.Z)(e,n,r,i,Au,Hl)(t)}var TJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wJ=function(t){TJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{x:{padding:0}},animate:{enter:{type:"fadeIn"}},axis:!1,shapeField:"funnel",label:{position:"inside",transform:[{type:"contrastReverse"}]},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return SJ},e}(Sl);function AJ(t){return(0,Ll.Z)(Au,Hl)(t)}var OJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),CJ=function(t){OJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="line",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return AJ},e}(Sl);function M2(t){switch(typeof t){case"function":return t;case"string":return function(e){return(0,un.Z)(e,[t])};default:return function(){return t}}}var Jg=function(){return Jg=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Jg.apply(this,arguments)};function RJ(t){var e=function(n){var r=n.options,i=r.angleField,s=r.data,l=r.label,u=r.tooltip,h=r.colorField,p=M2(h);if((0,we.Z)(s)){var m=s.reduce(function(x,T){return x+T[i]},0);if(m===0){var y=s.map(function(x){var T;return Jg(Jg({},x),(T={},T[i]=1,T))});(0,Na.Z)(r,"data",y),l&&(0,Na.Z)(r,"label",Jg(Jg({},l),{formatter:function(){return 0}})),u!==!1&&(0,Na.Z)(r,"tooltip",Jg(Jg({},u),{items:[function(x,T,C){return{name:p(x,T,C),value:0}}]}))}}return n};return(0,Ll.Z)(e,Hl)(t)}var MJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),PJ=function(t){MJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="pie",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"theta"},transform:[{type:"stackY",reverse:!0}],animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return RJ},e}(Sl);function IJ(t){return(0,Ll.Z)(Au,Hl)(t)}var LJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DJ=function(t){LJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="scatter",n}return e.getDefaultOptions=function(){return{axis:{y:{title:!1},x:{title:!1}},legend:{size:!1},children:[{type:"point"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return IJ},e}(Sl);function NJ(t){var e=function(n){return(0,Na.Z)(n,"options.coordinate",{type:(0,un.Z)(n,"options.coordinateType","polar")}),n};return(0,Ll.Z)(e,Hl)(t)}var kJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BJ=function(t){kJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radar",n}return e.getDefaultOptions=function(){return{axis:{x:{grid:!0,line:!0},y:{zIndex:1,title:!1,line:!0,nice:!0}},meta:{x:{padding:.5,align:0}},interaction:{tooltip:{style:{crosshairsLineDash:[4,4]}}},children:[{type:"line"}],coordinateType:"polar"}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return NJ},e}(Sl),nx=it(43836),Hv=function(){return Hv=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Hv.apply(this,arguments)},FJ="__stock-range__",UJ="trend",zJ="up",jJ="down";function VJ(t){var e=function(r){var i=r.options,s=i.data,l=i.yField;return r.options.data=(0,nx.Z)(s,function(u){var h=u&&Hv({},u);if(Array.isArray(l)&&h){var p=l[0],m=l[1],y=l[2],x=l[3];h[UJ]=h[p]<=h[m]?zJ:jJ,h[FJ]=[h[p],h[m],h[y],h[x]]}return h}),r},n=function(r){var i=r.options,s=i.xField,l=i.yField,u=i.fallingFill,h=i.risingFill,p=l[0],m=l[1],y=l[2],x=l[3],T=M2(s);return r.options.children=(0,nx.Z)(r.options.children,function(C,M){var I=M===0;return Hv(Hv({},C),{tooltip:{title:function(D,U,Z){var G=T(D,U,Z);return G instanceof Date?G.toLocaleString():G},items:[{field:y},{field:x},{field:p},{field:m}]},encode:Hv(Hv({},C.encode||{}),{y:I?[y,x]:[p,m],color:function(D){return Math.sign(D[m]-D[p])}}),style:Hv(Hv({},C.style||{}),{lineWidth:I?1:10})})}),delete i.yField,r.options.legend={color:!1},u&&(0,Na.Z)(r,"options.scale.color.range[0]",u),h&&(0,Na.Z)(r,"options.scale.color.range[2]",h),r};return(0,Ll.Z)(e,n,Hl)(t)}var ZJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),HJ=["#26a69a","#999999","#ef5350"],GJ=function(t){ZJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="stock",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{domain:[-1,0,1],range:HJ},y:{nice:!0}},children:[{type:"link"},{type:"link"}],axis:{x:{title:!1,grid:!1},y:{title:!1,grid:!0,gridLineDash:null}},animate:{enter:{type:"scaleInY"}},interaction:{tooltip:{shared:!0,marker:!1,groupName:!1,crosshairs:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return VJ},e}(Sl);function WJ(t){return(0,Ll.Z)(Au,Hl)(t)}var XJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),YJ=function(t){XJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyLine",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line",axis:!1}],animate:{enter:{type:"growInX",duration:500}},padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return WJ},e}(Sl);function qJ(t){return(0,Ll.Z)(Au,Hl)(t)}var $J=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),KJ=function(t){$J(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyArea",n}return e.getDefaultOptions=function(){return{type:"view",animate:{enter:{type:"growInX",duration:500}},children:[{type:"area",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return qJ},e}(Sl);function QJ(t){return(0,Ll.Z)(Au,Hl)(t)}var JJ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ttt=function(t){JJ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyColumn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return QJ},e}(Sl),wM=function(){return wM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},wM.apply(this,arguments)};function ett(t){var e=function(n){var r=n.options,i=r.percent,s=r.color,l=s===void 0?[]:s;if(!i)return n;var u={scale:{color:{range:l.length?l:[]}},data:[1,i]};return Object.assign(r,wM({},u)),n};return(0,Ll.Z)(e,Au,Hl)(t)}var ntt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),rtt=function(t){ntt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyProgress",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,tooltip:!1,children:[{interaction:{tooltip:!1},coordinate:{transform:[{type:"transpose"}]},type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ett},e}(Sl),AM=function(){return AM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},AM.apply(this,arguments)};function itt(t){var e=function(r){var i=r.options,s=i.radius,l=s===void 0?.8:s;return(0,Na.Z)(r,"options.coordinate.innerRadius",l),r},n=function(r){var i=r.options,s=i.percent,l=i.color,u=l===void 0?[]:l;if(!s)return r;var h={scale:{color:{range:u.length?u:[]}},data:[1,s]};return Object.assign(i,AM({},h)),r};return(0,Ll.Z)(e,n,Au,Hl)(t)}var ott=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),att=function(t){ott(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyRing",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,coordinate:{type:"theta"},animate:{enter:{type:"waveIn"}},interaction:{tooltip:!1},tooltip:!1,children:[{type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return itt},e}(Sl);function stt(t){return(0,Ll.Z)(Hl)(t)}var ltt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ctt=function(t){ltt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="rose",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"polar"},animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return stt},e}(Sl),OM="__start__",rx="__end__",CM="__waterfall_value__",RM=function(){return RM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},RM.apply(this,arguments)},utt=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))};function ftt(t){var e=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.yField;return l.length&&(l.reduce(function(h,p,m){var y,x=M2(u),T=x(p,m,l);if(m===0||p.isTotal)p[OM]=0,p[rx]=T,p[CM]=T;else{var C=(y=h[rx])!==null&&y!==void 0?y:x(h,m,l);p[OM]=C,p[rx]=C+T,p[CM]=h[rx]}return p},[]),Object.assign(i,{yField:[OM,rx]})),r},n=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.xField,h=i.children,p=i.linkStyle,m=utt([],l,!0);return m.reduce(function(y,x,T){return T>0&&(x.x1=y[u],x.x2=x[u],x.y1=y[rx]),x},[]),m.shift(),h.push({type:"link",xField:["x1","x2"],yField:"y1",zIndex:-1,data:m,style:RM({stroke:"#697474"},p),label:!1,tooltip:!1}),r};return(0,Ll.Z)(e,n,Au,Hl)(t)}var htt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dtt=function(t){htt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="waterfall",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{field:CM,valueFormatter:"~s",name:"value"},axis:{y:{title:null,labelFormatter:"~s"},x:{title:null}},children:[{type:"interval",interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ftt},e}(Sl),ix=it(290),b8=it(79432),ptt=it(20956),mtt=it(20544);function vtt(t){var e=function(n){var r=n.options,i=r.data,s=r.binNumber,l=r.binWidth,u=r.children,h=r.channel,p=h===void 0?"count":h,m=(0,un.Z)(u,"[0].transform[0]",{});return(0,ix.Z)(l)?((0,b8.Z)(m,{thresholds:(0,ptt.Z)((0,mtt.Z)(i.length,l)),y:p}),n):((0,ix.Z)(s)&&(0,b8.Z)(m,{thresholds:s,y:p}),n)};return(0,Ll.Z)(e,Au,Hl)(t)}var gtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ytt=function(t){gtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Histogram",n}return e.getDefaultOptions=function(){return{type:"view",autoFit:!0,axis:{y:{title:!1},x:{title:!1}},children:[{type:"rect",transform:[{type:"binX",y:"count"}],interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return vtt},e}(Sl);function _tt(t){var e=function(r){var i=r.options,s=i.tooltip,l=s===void 0?{}:s,u=i.colorField,h=i.sizeField;return l&&!l.field&&(l.field=u||h),r},n=function(r){var i=r.options,s=i.mark,l=i.children;return s&&(l[0].type=s),r};return(0,Ll.Z)(e,n,Au,Hl)(t)}var xtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),btt=function(t){xtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="heatmap",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{valueFormatter:"~s"},axis:{y:{title:null,grid:!0},x:{title:null,grid:!0}},children:[{type:"point",interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _tt},e}(Sl);function Ett(t){var e=function(n){var r=n.options.boxType,i=r===void 0?"box":r;return n.options.children[0].type=i,n};return(0,Ll.Z)(e,Au,Hl)(t)}var Stt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ttt=function(t){Stt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="box",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"box"}],axis:{y:{title:!1},x:{title:!1}},tooltip:{items:[{name:"min",channel:"y"},{name:"q1",channel:"y1"},{name:"q2",channel:"y2"},{name:"q3",channel:"y3"},{name:"max",channel:"y4"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ett},e}(Sl);function wtt(t){var e=function(n){var r=n.options,i=r.data,s=[{type:"custom",callback:function(u){return{links:u}}}];if((0,we.Z)(i))i.length>0?(0,Na.Z)(r,"data",{value:i,transform:s}):delete r.children;else if((0,un.Z)(i,"type")==="fetch"&&(0,un.Z)(i,"value")){var l=(0,un.Z)(i,"transform");(0,we.Z)(l)?(0,Na.Z)(i,"transform",l.concat(s)):(0,Na.Z)(i,"transform",s)}return n};return(0,Ll.Z)(e,Au,Hl)(t)}var Att=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ott=function(t){Att(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="sankey",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sankey"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return wtt},e}(Sl);function Ctt(t){var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}],t}function Rtt(t){Ctt(t);var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.children.forEach(function(r){var i;!((i=r==null?void 0:r.coordinate)===null||i===void 0)&&i.transform&&(r.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}])}),t}var Mtt=it(27601),Ptt=it(36378),Itt=it(90096),om=function(){return om=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},om.apply(this,arguments)},Ew=["#f0efff","#5B8FF9","#3D76DD"];function MM(t,e,n,r){r===void 0&&(r=!0);var i=0,s=!1,l=(0,nx.Z)(t,function(u){var h,p,m=(0,un.Z)(u,[e]);if((0,Mtt.Z)(m))return[];if((0,Ptt.Z)(m)){var y=Number(m);return isNaN(y)?[]:(h={},h[n]=u[n],h[e]=y,h)}return(0,we.Z)(m)?(s=!0,i=Math.max(i,m.length),(0,nx.Z)(r?m.sort(function(x,T){return T-x}):m,function(x,T){var C;return C={},C[n]=u[n],C[e]=x,C.index=T,C})):(i=Math.max(1,i),p={},p[n]=u[n],p[e]=m,p)}).flat();return s?[l.map(function(u){return om({index:0},u)}),i]:[l,i]}function PM(t,e){return new Array(t).fill("").map(function(n,r){return(0,we.Z)(e)?e[r%e.length]:e})}function Ltt(t){var e=function(i){var s=i.options,l=s.color,u=s.rangeField,h=u===void 0?"ranges":u,p=s.measureField,m=p===void 0?"measures":p,y=s.targetField,x=y===void 0?"targets":y,T=s.xField,C=T===void 0?"title":T,M=s.mapField,I=s.data,D=MM(I,h,C),U=D[0],Z=D[1],G=MM(I,m,C,!1),W=G[0],$=G[1],J=MM(I,x,C,!1),nt=J[0],dt=J[1],Et=(0,un.Z)(l,[h],Ew[0]),Pt=(0,un.Z)(l,[m],Ew[1]),Ht=(0,un.Z)(l,[x],Ew[2]),Ct=[PM(Z,Et),PM($,Pt),PM(dt,Ht)].flat();return i.options.children=(0,nx.Z)(i.options.children,function(Ft,jt){var qt=[U,W,nt][jt],Ee=[h,m,x][jt];return om(om({},Ft),{data:qt,encode:om(om({},Ft.encode||{}),{x:C,y:Ee,color:function(oe){var _e=oe.index,hn=(0,ix.Z)(_e)?"".concat(Ee,"_").concat(_e):Ee;return M?(0,un.Z)(M,[Ee,_e],hn):hn}}),style:om(om({},Ft.style||{}),{zIndex:function(oe){return-oe[Ee]}}),labels:jt!==0?(0,nx.Z)(Ft.labels,function(oe){return om(om({},oe),{text:Ee})}):void 0})}),i.options.scale.color.range=Ct,i.options.legend.color.itemMarker=function(Ft){return M&&(0,Itt.Z)(M==null?void 0:M[x],Ft)||(Ft==null?void 0:Ft.replace(/\_\d$/,""))===x?"line":"square"},i},n=function(i){var s=i.options.layout,l=s===void 0?"horizontal":s;return l!=="horizontal"&&(0,Na.Z)(i,"options.children[2].shapeField","hyphen"),i},r=function(i){var s=i.options,l=s.range,u=l===void 0?{}:l,h=s.measure,p=h===void 0?{}:h,m=s.target,y=m===void 0?{}:m,x=s.children;return i.options.children=[u,p,y].map(function(T,C){return Qg(x[C],T)}),i};return(0,Ll.Z)(e,n,r,Rtt,Hl)(t)}var Dtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ntt=function(t){Dtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="bullet",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{range:Ew}},legend:{color:{itemMarker:function(n){return n==="target"?"line":"square"}}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval",style:{maxWidth:30},axis:{y:{grid:!0,gridLineWidth:2}}},{type:"interval",style:{maxWidth:20},transform:[{type:"stackY"}]},{type:"point",encode:{size:8,shape:"line"}}],interaction:{tooltip:{shared:!0}},coordinate:{transform:[{type:"transpose"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ltt},e}(Sl);function ktt(t){var e=function(n){var r=n.options.data;return n.options.data={value:r},n};return(0,Ll.Z)(e,Au,Hl)(t)}var Btt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ftt=function(t){Btt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Gauge",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"gauge"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ktt},e}(Sl);function Utt(t){var e=function(n){var r=n.options.percent;return(0,ix.Z)(r)&&((0,Na.Z)(n,"options.data",r),delete n.options.percent),n};return(0,Ll.Z)(e,Au,Hl)(t)}var ztt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),jtt=function(t){ztt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Liquid",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"liquid"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Utt},e}(Sl);function Vtt(t){return(0,Ll.Z)(Au,Hl)(t)}var Ztt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Htt=function(t){Ztt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="WordCloud",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"wordCloud"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Vtt},e}(Sl);function Gtt(t){var e=function(n){var r=n.options,i=r.data;return i&&(0,Na.Z)(r,"data",{value:i}),n};return(0,Ll.Z)(e,Au,Hl)(t)}var Wtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xtt=function(t){Wtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="treemap",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"treemap"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Gtt},e}(Sl),T_=function(){return T_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},T_.apply(this,arguments)};function Ytt(t){var e=function(i){var s=i.options,l=s.startAngle,u=s.maxAngle,h=s.coordinate,p=(0,ix.Z)(l)?l/(2*Math.PI)*360:-90,m=(0,ix.Z)(u)?(Number(u)+p)/180*Math.PI:Math.PI;return(0,Na.Z)(i,["options","coordinate"],T_(T_({},h),{endAngle:m,startAngle:l!=null?l:-Math.PI/2})),i},n=function(i){var s=i.options,l=s.tooltip,u=s.xField,h=s.yField,p=M2(u),m=M2(h);return l||(0,Na.Z)(s,"tooltip",{title:!1,items:[function(y,x,T){return{name:p(y,x,T),value:m(y,x,T)}}]}),i},r=function(i){var s=i.options,l=s.markBackground,u=s.children,h=s.scale,p=s.coordinate,m=s.xField,y=(0,un.Z)(h,"y.domain",[]);return l&&u.unshift(T_({type:"interval",xField:m,yField:y[y.length-1],colorField:l.color,scale:{color:{type:"identity"}},style:{fillOpacity:l.opacity,fill:l.color?void 0:"#e0e4ee"},coordinate:T_(T_({},p),{startAngle:-Math.PI/2,endAngle:1.5*Math.PI}),animate:!1},l)),i};return(0,Ll.Z)(e,n,r,Au,Hl)(t)}var qtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),$tt=function(t){qtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radial",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"radial",innerRadius:.1,outerRadius:1,endAngle:Math.PI},animate:{enter:{type:"waveIn",duration:800}},axis:{y:{nice:!0,labelAutoHide:!0,labelAutoRotate:!1},x:{title:!1,nice:!0,labelAutoRotate:!1,labelAutoHide:{type:"equidistance",cfg:{minGap:6}}}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ytt},e}(Sl);function Ktt(t){return(0,Ll.Z)(Hl)(t)}var Qtt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jtt=function(t){Qtt(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="CirclePacking",n}return e.getDefaultOptions=function(){return{legend:!1,type:"view",children:[{type:"pack"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ktt},e}(Sl),Sw=function(){return Sw=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Sw.apply(this,arguments)};function tet(t){var e=function(n){var r=n.options,i=r.xField,s=r.yField,l=r.seriesField,u=r.children,h=u==null?void 0:u.map(function(p){return Sw(Sw({},p),{xField:i,yField:s,seriesField:l,colorField:l,data:p.type==="density"?{transform:[{type:"kde",field:s,groupBy:[i,l]}]}:p.data})}).filter(function(p){return r.violinType!=="density"||p.type==="density"});return(0,Na.Z)(r,"children",h),r.violinType==="polar"&&(0,Na.Z)(r,"coordinate",{type:"polar"}),(0,Na.Z)(r,"violinType",void 0),n};return(0,Ll.Z)(e,Au,Hl)(t)}var eet=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),net=function(t){eet(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="violin",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"density",sizeField:"size",tooltip:!1},{type:"boxplot",shapeField:"violin",style:{opacity:.5,point:!1}}],animate:{enter:{type:"fadeIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return tet},e}(Sl),ret=it(37514),P2=function(){return P2=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},P2.apply(this,arguments)},iet=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))};function oet(t){var e=function(s){var l=s.options,u=l.yField,h=l.children;return h.forEach(function(p,m){(0,Na.Z)(p,"yField",u[m])}),s},n=function(s){var l=s.options,u=l.yField,h=l.children,p=l.data;if((0,ret.Z)(p))return s;var m=(0,we.Z)((0,un.Z)(p,[0]))?p:[p,p];return h.forEach(function(y,x){(0,Na.Z)(y,"data",iet([],m[x].map(function(T){return P2({groupKey:u[x]},T)}),!0))}),s},r=function(s){var l=s.options,u=l.yField,h=u[0],p=u[1],m=l.tooltip;return m||(0,Na.Z)(l,"tooltip",{items:[{field:h,value:h},{field:p,value:p}]}),s},i=function(s){var l=s.options,u=l.children,h=l.layout,p=l.coordinate.transform,m=l.paddingBottom,y=m===void 0?m8:m,x=l.paddingLeft,T=x===void 0?m8:x,C=l.axis;(0,Na.Z)(l,"axisText",P2(P2({},(C==null?void 0:C.x)||{}),{layout:h}));var M=u[0],I=u[1];if(h==="vertical")(0,Na.Z)(l,"direction","col"),(0,Na.Z)(l,"paddingLeft",T),(0,Na.Z)(l,"coordinate.transform",p.filter(function(W){return W.type!=="transpose"})),(0,Na.Z)(M,"paddingBottom",p8),(0,Na.Z)(I,"paddingTop",p8),(0,Na.Z)(I,"axis",{x:{position:"top"}}),(0,Na.Z)(I,"scale",{y:{range:[0,1]}});else{(0,Na.Z)(l,"paddingBottom",y),(0,Na.Z)(M,"scale",{y:{range:[0,1]}});var D=M.paddingRight,U=D===void 0?EM:D,Z=I.paddingLeft,G=Z===void 0?EM:Z;(0,Na.Z)(M,"paddingRight",U),(0,Na.Z)(M,"axis",{x:{position:"right"}}),(0,Na.Z)(I,"paddingLeft",G)}return s};return(0,Ll.Z)(e,n,r,i,Au,Hl)(t)}var aet=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),set=function(t){aet(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="BidirectionalBar",n}return e.getDefaultOptions=function(){return{type:"spaceFlex",coordinate:{transform:[{type:"transpose"}]},scale:{y:{nice:!0}},direction:"row",layout:"horizontal",legend:!1,axis:{y:{title:!1},x:{title:!1,label:!1}},children:[{type:"interval"},{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return oet},e}(Sl),w_;(function(t){t.color="key",t.d="path"})(w_||(w_={}));function cet(t){var e=function(n){var r=n.options,i=r.data,s=r.setsField,l=r.sizeField;return(0,we.Z)(i)&&((0,Na.Z)(r,"data",{type:"inline",value:i,transform:[{type:"venn",sets:s,size:l,as:[w_.color,w_.d]}]}),(0,Na.Z)(r,"colorField",s),(0,Na.Z)(r,["children","0","encode","d"],w_.d)),(0,Na.Z)(n,"options",(0,SM.Z)(r,["sizeField","setsField"])),n};return(0,Ll.Z)(e,Hl)(t)}var uet=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),fet=function(t){uet(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="venn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"path"}],legend:{color:{itemMarker:"circle"}},encode:{color:w_.color,d:w_.d}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cet},e}(Sl);function het(t){var e=function(n){return n};return(0,Ll.Z)(e,Hl)(t)}var det=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pet=function(t){det(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Sunburst",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sunburst"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return het},e}(Sl),met={Base:sJ,Line:CJ,Column:xJ,Pie:PJ,Area:pJ,Bar:gJ,DualAxes:x8,Funnel:wJ,Scatter:DJ,Radar:BJ,Rose:ctt,Stock:GJ,TinyLine:YJ,TinyArea:KJ,TinyColumn:ttt,TinyProgress:rtt,TinyRing:att,Waterfall:dtt,Histogram:ytt,Heatmap:btt,Box:Ttt,Sankey:Ott,Bullet:Ntt,Gauge:Ftt,Liquid:jtt,WordCloud:Htt,Treemap:Xtt,RadialBar:$tt,CirclePacking:Jtt,Violin:net,BidirectionalBar:set,Venn:fet,Mix:x8,Sunburst:pet},IM=function(){return IM=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},IM.apply(this,arguments)},E8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},vet=(0,yt.forwardRef)(function(t,e){var n=t.chartType,r=n===void 0?"Base":n,i=E8(t,["chartType"]),s=i.containerStyle,l=s===void 0?{height:"inherit",flex:1}:s,u=i.containerAttributes,h=u===void 0?{}:u,p=i.className,m=i.loading,y=i.loadingTemplate,x=i.errorTemplate,T=E8(i,["containerStyle","containerAttributes","className","loading","loadingTemplate","errorTemplate"]),C=Er(met[r],T),M=C.chart,I=C.container;return(0,yt.useImperativeHandle)(e,function(){return M.current}),yt.createElement(te,{errorTemplate:x},m&&yt.createElement(Te,{loadingTemplate:y}),yt.createElement("div",IM({className:p,style:l,ref:I},h)))})},78677:function(br,rr,it){"use strict";var ne=it(67294),pt=it(7366),R=function(){return R=Object.assign||function(yt){for(var xe,le=1,Le=arguments.length;le<Le;le++){xe=arguments[le];for(var Lt in xe)Object.prototype.hasOwnProperty.call(xe,Lt)&&(yt[Lt]=xe[Lt])}return yt},R.apply(this,arguments)},$e=(0,ne.forwardRef)(function(yt,xe){return ne.createElement(pt.P,R({},yt,{chartType:"Column",ref:xe}))});rr.Z=$e},80652:function(br,rr,it){"use strict";var ne=it(67294),pt=it(7366),R=function(){return R=Object.assign||function(yt){for(var xe,le=1,Le=arguments.length;le<Le;le++){xe=arguments[le];for(var Lt in xe)Object.prototype.hasOwnProperty.call(xe,Lt)&&(yt[Lt]=xe[Lt])}return yt},R.apply(this,arguments)},$e=(0,ne.forwardRef)(function(yt,xe){return ne.createElement(pt.P,R({},yt,{chartType:"Line",ref:xe}))});rr.Z=$e},63430:function(br,rr,it){"use strict";var ne=it(67294),pt=it(7366),R=function(){return R=Object.assign||function(yt){for(var xe,le=1,Le=arguments.length;le<Le;le++){xe=arguments[le];for(var Lt in xe)Object.prototype.hasOwnProperty.call(xe,Lt)&&(yt[Lt]=xe[Lt])}return yt},R.apply(this,arguments)},$e=(0,ne.forwardRef)(function(yt,xe){return ne.createElement(pt.P,R({},yt,{chartType:"Pie",ref:xe}))});rr.Z=$e},6466:function(br,rr,it){"use strict";it.d(rr,{Z:function(){return or}});var ne=it(4942),pt=it(1413),R=it(45987),$e=it(28459),yt=it(93967),xe=it.n(yt),le=it(67294),Le=it(53911),Lt=it(44962),fn=it(98082),Nt=function($t){return(0,ne.Z)({},$t.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:$t.marginLG,marginInline:0,color:$t.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function Jt(He){return(0,fn.Xj)("ProCardOperation",function($t){var nn=(0,pt.Z)((0,pt.Z)({},$t),{},{componentCls:".".concat(He)});return[Nt(nn)]})}var Ie=it(85893),fe=function($t){var nn=$t.className,ke=$t.style,Je=ke===void 0?{}:ke,er=$t.children,kt=(0,le.useContext)($e.ZP.ConfigContext),Te=kt.getPrefixCls,gt=Te("pro-card-operation"),te=Jt(gt),Zt=te.wrapSSR,Ut=te.hashId,we=xe()(gt,nn,Ut);return Zt((0,Ie.jsx)("div",{className:we,style:Je,children:er}))},ce=fe,ve=it(96604),Ze=function($t){return(0,ne.Z)({},$t.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,ne.Z)({flexDirection:"row"},"".concat($t.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat($t.colorBorder)}})};function Un(He){return(0,fn.Xj)("StatisticCard",function($t){var nn=(0,pt.Z)((0,pt.Z)({},$t),{},{componentCls:".".concat(He)});return[Ze(nn)]})}var En=["children","statistic","className","chart","chartPlacement","footer"],Vn=function($t){var nn=$t.children,ke=$t.statistic,Je=$t.className,er=$t.chart,kt=$t.chartPlacement,Te=$t.footer,gt=(0,R.Z)($t,En),te=(0,le.useContext)($e.ZP.ConfigContext),Zt=te.getPrefixCls,Ut=Zt("pro-statistic-card"),we=Un(Ut),ie=we.wrapSSR,_t=we.hashId,Ne=xe()(Ut,Je,_t),un=ke&&(0,Ie.jsx)(ve.Z,(0,pt.Z)({layout:"vertical"},ke)),Qn=xe()("".concat(Ut,"-chart"),_t,(0,ne.Z)((0,ne.Z)({},"".concat(Ut,"-chart-left"),kt==="left"&&er&&ke),"".concat(Ut,"-chart-right"),kt==="right"&&er&&ke)),hr=er&&(0,Ie.jsx)("div",{className:Qn,children:er}),Er=xe()("".concat(Ut,"-content "),_t,(0,ne.Z)({},"".concat(Ut,"-content-horizontal"),kt==="left"||kt==="right")),Ue=(hr||un)&&(kt==="left"?(0,Ie.jsxs)("div",{className:Er,children:[hr,un]}):(0,Ie.jsxs)("div",{className:Er,children:[un,hr]})),cn=Te&&(0,Ie.jsx)("div",{className:"".concat(Ut,"-footer ").concat(_t).trim(),children:Te});return ie((0,Ie.jsxs)(Le.Z,(0,pt.Z)((0,pt.Z)({className:Ne},gt),{},{children:[Ue,nn,cn]})))},mr=function($t){return(0,Ie.jsx)(Vn,(0,pt.Z)({bodyStyle:{padding:0}},$t))};Vn.Statistic=ve.Z,Vn.Divider=Lt.Z,Vn.Operation=ce,Vn.isProCard=!0,Vn.Group=mr;var or=Vn},96604:function(br,rr,it){"use strict";it.d(rr,{Z:function(){return rn}});var ne=it(1413),pt=it(4942),R=it(45987),$e=it(87462),yt=it(67294),xe=it(36688),le=it(55304),Le=function(Be,At){return yt.createElement(le.Z,(0,$e.Z)({},Be,{ref:At,icon:xe.Z}))},Lt=yt.forwardRef(Le),fn=Lt,Nt=it(28459),Jt=it(83062),Ie=it(40411),fe=it(57838),ce=it(96159),ve=it(93967),Ze=it.n(ve),Un=it(64217),En=it(53124),Vn=it(87564),or=De=>{const{value:Be,formatter:At,precision:Bt,decimalSeparator:Ae,groupSeparator:z="",prefixCls:rt}=De;let F;if(typeof At=="function")F=At(Be);else{const ot=String(Be),ze=ot.match(/^(-?)(\d*)(\.(\d+))?$/);if(!ze||ot==="-")F=ot;else{const Vt=ze[1];let ae=ze[2]||"0",Mn=ze[4]||"";ae=ae.replace(/\B(?=(\d{3})+(?!\d))/g,z),typeof Bt=="number"&&(Mn=Mn.padEnd(Bt,"0").slice(0,Bt>0?Bt:0)),Mn&&(Mn=`${Ae}${Mn}`),F=[yt.createElement("span",{key:"int",className:`${rt}-content-value-int`},Vt,ae),Mn&&yt.createElement("span",{key:"decimal",className:`${rt}-content-value-decimal`},Mn)]}}return yt.createElement("span",{className:`${rt}-content-value`},F)},He=it(14747),$t=it(83559),nn=it(83262);const ke=De=>{const{componentCls:Be,marginXXS:At,padding:Bt,colorTextDescription:Ae,titleFontSize:z,colorTextHeading:rt,contentFontSize:F,fontFamily:ot}=De;return{[Be]:Object.assign(Object.assign({},(0,He.Wf)(De)),{[`${Be}-title`]:{marginBottom:At,color:Ae,fontSize:z},[`${Be}-skeleton`]:{paddingTop:Bt},[`${Be}-content`]:{color:rt,fontSize:F,fontFamily:ot,[`${Be}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Be}-content-prefix, ${Be}-content-suffix`]:{display:"inline-block"},[`${Be}-content-prefix`]:{marginInlineEnd:At},[`${Be}-content-suffix`]:{marginInlineStart:At}}})}},Je=De=>{const{fontSizeHeading3:Be,fontSize:At}=De;return{titleFontSize:At,contentFontSize:Be}};var er=(0,$t.I$)("Statistic",De=>{const Be=(0,nn.mergeToken)(De,{});return[ke(Be)]},Je),kt=function(De,Be){var At={};for(var Bt in De)Object.prototype.hasOwnProperty.call(De,Bt)&&Be.indexOf(Bt)<0&&(At[Bt]=De[Bt]);if(De!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ae=0,Bt=Object.getOwnPropertySymbols(De);Ae<Bt.length;Ae++)Be.indexOf(Bt[Ae])<0&&Object.prototype.propertyIsEnumerable.call(De,Bt[Ae])&&(At[Bt[Ae]]=De[Bt[Ae]]);return At},gt=De=>{const{prefixCls:Be,className:At,rootClassName:Bt,style:Ae,valueStyle:z,value:rt=0,title:F,valueRender:ot,prefix:ze,suffix:Vt,loading:ae=!1,formatter:Mn,precision:zn,decimalSeparator:Wn=".",groupSeparator:sn=",",onMouseEnter:Kt,onMouseLeave:Ce}=De,xn=kt(De,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:Cn,direction:Zn,statistic:Qt}=yt.useContext(En.E_),ct=Cn("statistic",Be),[bt,zt,me]=er(ct),de=yt.createElement(or,{decimalSeparator:Wn,groupSeparator:sn,prefixCls:ct,formatter:Mn,precision:zn,value:rt}),bn=Ze()(ct,{[`${ct}-rtl`]:Zn==="rtl"},Qt==null?void 0:Qt.className,At,Bt,zt,me),qn=(0,Un.Z)(xn,{aria:!0,data:!0});return bt(yt.createElement("div",Object.assign({},qn,{className:bn,style:Object.assign(Object.assign({},Qt==null?void 0:Qt.style),Ae),onMouseEnter:Kt,onMouseLeave:Ce}),F&&yt.createElement("div",{className:`${ct}-title`},F),yt.createElement(Vn.Z,{paragraph:!1,loading:ae,className:`${ct}-skeleton`},yt.createElement("div",{style:z,className:`${ct}-content`},ze&&yt.createElement("span",{className:`${ct}-content-prefix`},ze),ot?ot(de):de,Vt&&yt.createElement("span",{className:`${ct}-content-suffix`},Vt)))))};const te=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Zt(De,Be){let At=De;const Bt=/\[[^\]]*]/g,Ae=(Be.match(Bt)||[]).map(ot=>ot.slice(1,-1)),z=Be.replace(Bt,"[]"),rt=te.reduce((ot,ze)=>{let[Vt,ae]=ze;if(ot.includes(Vt)){const Mn=Math.floor(At/ae);return At-=Mn*ae,ot.replace(new RegExp(`${Vt}+`,"g"),zn=>{const Wn=zn.length;return Mn.toString().padStart(Wn,"0")})}return ot},z);let F=0;return rt.replace(Bt,()=>{const ot=Ae[F];return F+=1,ot})}function Ut(De,Be){const{format:At=""}=Be,Bt=new Date(De).getTime(),Ae=Date.now(),z=Math.max(Bt-Ae,0);return Zt(z,At)}var we=function(De,Be){var At={};for(var Bt in De)Object.prototype.hasOwnProperty.call(De,Bt)&&Be.indexOf(Bt)<0&&(At[Bt]=De[Bt]);if(De!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ae=0,Bt=Object.getOwnPropertySymbols(De);Ae<Bt.length;Ae++)Be.indexOf(Bt[Ae])<0&&Object.prototype.propertyIsEnumerable.call(De,Bt[Ae])&&(At[Bt[Ae]]=De[Bt[Ae]]);return At};const ie=1e3/30;function _t(De){return new Date(De).getTime()}const Ne=De=>{const{value:Be,format:At="HH:mm:ss",onChange:Bt,onFinish:Ae}=De,z=we(De,["value","format","onChange","onFinish"]),rt=(0,fe.Z)(),F=yt.useRef(null),ot=()=>{Ae==null||Ae(),F.current&&(clearInterval(F.current),F.current=null)},ze=()=>{const Mn=_t(Be);Mn>=Date.now()&&(F.current=setInterval(()=>{rt(),Bt==null||Bt(Mn-Date.now()),Mn<Date.now()&&ot()},ie))};yt.useEffect(()=>(ze(),()=>{F.current&&(clearInterval(F.current),F.current=null)}),[Be]);const Vt=(Mn,zn)=>Ut(Mn,Object.assign(Object.assign({},zn),{format:At})),ae=Mn=>(0,ce.Tm)(Mn,{title:void 0});return yt.createElement(gt,Object.assign({},z,{value:Be,valueRender:ae,formatter:Vt}))};var un=yt.memo(Ne);gt.Countdown=un;var Qn=gt,hr=it(98082),Er=function(Be){return(0,pt.Z)({},Be.componentCls,(0,pt.Z)((0,pt.Z)((0,pt.Z)((0,pt.Z)((0,pt.Z)({display:"flex",fontSize:Be.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,pt.Z)({display:"flex",width:"100%"},"".concat(Be.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,pt.Z)({width:"100%"},"".concat(Be.antCls,"-statistic-content"),{"&-value-int":{fontSize:Be.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(Be.antCls,"-statistic-title"),{color:Be.colorText}),"&-trend-up",(0,pt.Z)({},"".concat(Be.antCls,"-statistic-content"),(0,pt.Z)({color:"#f5222d"},"".concat(Be.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,pt.Z)({},"".concat(Be.antCls,"-statistic-content"),(0,pt.Z)({color:"#389e0d"},"".concat(Be.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,pt.Z)((0,pt.Z)((0,pt.Z)({display:"flex",justifyContent:"space-between"},"".concat(Be.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(Be.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(Be.antCls,"-statistic-title,").concat(Be.antCls,"-statistic-content,").concat(Be.antCls,"-statistic-content-suffix,").concat(Be.antCls,"-statistic-content-prefix,").concat(Be.antCls,"-statistic-content-value-decimal"),{fontSize:Be.fontSize})),"& &-layout-inline",(0,pt.Z)((0,pt.Z)((0,pt.Z)({display:"inline-flex",color:Be.colorTextSecondary},"".concat(Be.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(Be.antCls,"-statistic-content"),{color:Be.colorTextSecondary}),"".concat(Be.antCls,"-statistic-title,").concat(Be.antCls,"-statistic-content,").concat(Be.antCls,"-statistic-content-suffix,").concat(Be.antCls,"-statistic-content-prefix,").concat(Be.antCls,"-statistic-content-value-decimal"),{fontSize:Be.fontSizeSM})))};function Ue(De){return(0,hr.Xj)("Statistic",function(Be){var At=(0,ne.Z)((0,ne.Z)({},Be),{},{componentCls:".".concat(De)});return[Er(At)]})}var cn=it(85893),wn=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],ir=function(Be){var At=Be.className,Bt=Be.layout,Ae=Bt===void 0?"inline":Bt,z=Be.style,rt=Be.description,F=Be.children,ot=Be.title,ze=Be.tip,Vt=Be.status,ae=Be.trend,Mn=Be.prefix,zn=Be.icon,Wn=(0,R.Z)(Be,wn),sn=(0,yt.useContext)(Nt.ZP.ConfigContext),Kt=sn.getPrefixCls,Ce=Kt("pro-card-statistic"),xn=Ue(Ce),Cn=xn.wrapSSR,Zn=xn.hashId,Qt=Ze()(Ce,At,Zn),ct=Ze()("".concat(Ce,"-status"),Zn),bt=Ze()("".concat(Ce,"-icon"),Zn),zt=Ze()("".concat(Ce,"-wrapper"),Zn),me=Ze()("".concat(Ce,"-content"),Zn),de=Ze()(Zn,(0,pt.Z)((0,pt.Z)({},"".concat(Ce,"-layout-").concat(Ae),Ae),"".concat(Ce,"-trend-").concat(ae),ae)),bn=ze&&(0,cn.jsx)(Jt.Z,{title:ze,children:(0,cn.jsx)(fn,{className:"".concat(Ce,"-tip ").concat(Zn).trim()})}),qn=Ze()("".concat(Ce,"-trend-icon"),Zn,(0,pt.Z)({},"".concat(Ce,"-trend-icon-").concat(ae),ae)),Sr=ae&&(0,cn.jsx)("div",{className:qn}),Gn=Vt&&(0,cn.jsx)("div",{className:ct,children:(0,cn.jsx)(Ie.Z,{status:Vt,text:null})}),ht=zn&&(0,cn.jsx)("div",{className:bt,children:zn});return Cn((0,cn.jsxs)("div",{className:Qt,style:z,children:[ht,(0,cn.jsxs)("div",{className:zt,children:[Gn,(0,cn.jsxs)("div",{className:me,children:[(0,cn.jsx)(Qn,(0,ne.Z)({title:(ot||bn)&&(0,cn.jsxs)(cn.Fragment,{children:[ot,bn]}),prefix:(Sr||Mn)&&(0,cn.jsxs)(cn.Fragment,{children:[Sr,Mn]}),className:de},Wn)),rt&&(0,cn.jsx)("div",{className:"".concat(Ce,"-description ").concat(Zn).trim(),children:rt})]})]})]}))},rn=ir},46343:function(br,rr,it){"use strict";it.d(rr,{S$:function(){return De},bf:function(){return Be},ni:function(){return Ne},oI:function(){return ir},sX:function(){return rn}});var ne=it(34155);function pt(At,Bt,Ae,z){function rt(F){return F instanceof Ae?F:new Ae(function(ot){ot(F)})}return new(Ae||(Ae=Promise))(function(F,ot){function ze(Mn){try{ae(z.next(Mn))}catch(zn){ot(zn)}}function Vt(Mn){try{ae(z.throw(Mn))}catch(zn){ot(zn)}}function ae(Mn){Mn.done?F(Mn.value):rt(Mn.value).then(ze,Vt)}ae((z=z.apply(At,Bt||[])).next())})}function R(At,Bt){var Ae={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},z,rt,F,ot;return ot={next:ze(0),throw:ze(1),return:ze(2)},typeof Symbol=="function"&&(ot[Symbol.iterator]=function(){return this}),ot;function ze(ae){return function(Mn){return Vt([ae,Mn])}}function Vt(ae){if(z)throw new TypeError("Generator is already executing.");for(;Ae;)try{if(z=1,rt&&(F=ae[0]&2?rt.return:ae[0]?rt.throw||((F=rt.return)&&F.call(rt),0):rt.next)&&!(F=F.call(rt,ae[1])).done)return F;switch(rt=0,F&&(ae=[ae[0]&2,F.value]),ae[0]){case 0:case 1:F=ae;break;case 4:return Ae.label++,{value:ae[1],done:!1};case 5:Ae.label++,rt=ae[1],ae=[0];continue;case 7:ae=Ae.ops.pop(),Ae.trys.pop();continue;default:if(F=Ae.trys,!(F=F.length>0&&F[F.length-1])&&(ae[0]===6||ae[0]===2)){Ae=0;continue}if(ae[0]===3&&(!F||ae[1]>F[0]&&ae[1]<F[3])){Ae.label=ae[1];break}if(ae[0]===6&&Ae.label<F[1]){Ae.label=F[1],F=ae;break}if(F&&Ae.label<F[2]){Ae.label=F[2],Ae.ops.push(ae);break}F[2]&&Ae.ops.pop(),Ae.trys.pop();continue}ae=Bt.call(At,Ae)}catch(Mn){ae=[6,Mn],rt=0}finally{z=F=0}if(ae[0]&5)throw ae[1];return{value:ae[0]?ae[1]:void 0,done:!0}}}function $e(At,Bt){var Ae=typeof Symbol=="function"&&At[Symbol.iterator];if(!Ae)return At;var z=Ae.call(At),rt,F=[],ot;try{for(;(Bt===void 0||Bt-- >0)&&!(rt=z.next()).done;)F.push(rt.value)}catch(ze){ot={error:ze}}finally{try{rt&&!rt.done&&(Ae=z.return)&&Ae.call(z)}finally{if(ot)throw ot.error}}return F}function yt(At,Bt,Ae){if(Ae||arguments.length===2)for(var z=0,rt=Bt.length,F;z<rt;z++)(F||!(z in Bt))&&(F||(F=Array.prototype.slice.call(Bt,0,z)),F[z]=Bt[z]);return At.concat(F||Array.prototype.slice.call(Bt))}function xe(At){return At&&At.__esModule&&Object.prototype.hasOwnProperty.call(At,"default")?At.default:At}var le={exports:{}},Le={exports:{}},Lt={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Ae;function Ae(z){return z&&typeof z.length=="number"&&z.length>=0&&z.length%1===0}At.exports=Bt.default})(Lt,Lt.exports);var fn={},Nt={exports:{}},Jt={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=function(Ae){return function(){for(var z=[],rt=arguments.length;rt--;)z[rt]=arguments[rt];var F=z.pop();return Ae.call(this,z,F)}},At.exports=Bt.default})(Jt,Jt.exports);var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.fallback=Ze,Ie.wrap=Un;var fe=Ie.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,ce=Ie.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,ve=Ie.hasNextTick=typeof ne=="object"&&typeof ne.nextTick=="function";function Ze(At){setTimeout(At,0)}function Un(At){return function(Bt){for(var Ae=[],z=arguments.length-1;z-- >0;)Ae[z]=arguments[z+1];return At(function(){return Bt.apply(void 0,Ae)})}}var En;fe?En=queueMicrotask:ce?En=setImmediate:ve?En=ne.nextTick:En=Ze,Ie.default=Un(En),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Vt;var Ae=Jt.exports,z=ze(Ae),rt=Ie,F=ze(rt),ot=fn;function ze(zn){return zn&&zn.__esModule?zn:{default:zn}}function Vt(zn){return(0,ot.isAsync)(zn)?function(){for(var Wn=[],sn=arguments.length;sn--;)Wn[sn]=arguments[sn];var Kt=Wn.pop(),Ce=zn.apply(this,Wn);return ae(Ce,Kt)}:(0,z.default)(function(Wn,sn){var Kt;try{Kt=zn.apply(this,Wn)}catch(Ce){return sn(Ce)}if(Kt&&typeof Kt.then=="function")return ae(Kt,sn);sn(null,Kt)})}function ae(zn,Wn){return zn.then(function(sn){Mn(Wn,null,sn)},function(sn){Mn(Wn,sn&&sn.message?sn:new Error(sn))})}function Mn(zn,Wn,sn){try{zn(Wn,sn)}catch(Kt){(0,F.default)(function(Ce){throw Ce},Kt)}}At.exports=Bt.default}(Nt,Nt.exports),Object.defineProperty(fn,"__esModule",{value:!0}),fn.isAsyncIterable=fn.isAsyncGenerator=fn.isAsync=void 0;var Vn=Nt.exports,mr=or(Vn);function or(At){return At&&At.__esModule?At:{default:At}}function He(At){return At[Symbol.toStringTag]==="AsyncFunction"}function $t(At){return At[Symbol.toStringTag]==="AsyncGenerator"}function nn(At){return typeof At[Symbol.asyncIterator]=="function"}function ke(At){if(typeof At!="function")throw new Error("expected a function");return He(At)?(0,mr.default)(At):At}fn.default=ke,fn.isAsync=He,fn.isAsyncGenerator=$t,fn.isAsyncIterable=nn;var Je={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Ae;function Ae(z,rt){if(rt===void 0&&(rt=z.length),!rt)throw new Error("arity is undefined");function F(){for(var ot=this,ze=[],Vt=arguments.length;Vt--;)ze[Vt]=arguments[Vt];return typeof ze[rt-1]=="function"?z.apply(this,ze):new Promise(function(ae,Mn){ze[rt-1]=function(zn){for(var Wn=[],sn=arguments.length-1;sn-- >0;)Wn[sn]=arguments[sn+1];if(zn)return Mn(zn);ae(Wn.length>1?Wn:Wn[0])},z.apply(ot,ze)})}return F}At.exports=Bt.default})(Je,Je.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=Lt.exports,z=Vt(Ae),rt=fn,F=Vt(rt),ot=Je.exports,ze=Vt(ot);function Vt(ae){return ae&&ae.__esModule?ae:{default:ae}}Bt.default=(0,ze.default)(function(ae,Mn,zn){var Wn=(0,z.default)(Mn)?[]:{};ae(Mn,function(sn,Kt,Ce){(0,F.default)(sn)(function(xn){for(var Cn,Zn=[],Qt=arguments.length-1;Qt-- >0;)Zn[Qt]=arguments[Qt+1];Zn.length<2&&(Cn=Zn,Zn=Cn[0]),Wn[Kt]=Zn,Ce(xn)})},function(sn){return zn(sn,Wn)})},3),At.exports=Bt.default}(Le,Le.exports);var er={exports:{}},kt={exports:{}},Te={exports:{}},gt={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Ae;function Ae(z){function rt(){for(var F=[],ot=arguments.length;ot--;)F[ot]=arguments[ot];if(z!==null){var ze=z;z=null,ze.apply(this,F)}}return Object.assign(rt,z),rt}At.exports=Bt.default})(gt,gt.exports);var te={exports:{}},Zt={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=function(Ae){return Ae[Symbol.iterator]&&Ae[Symbol.iterator]()},At.exports=Bt.default})(Zt,Zt.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Mn;var Ae=Lt.exports,z=ot(Ae),rt=Zt.exports,F=ot(rt);function ot(zn){return zn&&zn.__esModule?zn:{default:zn}}function ze(zn){var Wn=-1,sn=zn.length;return function(){return++Wn<sn?{value:zn[Wn],key:Wn}:null}}function Vt(zn){var Wn=-1;return function(){var Kt=zn.next();return Kt.done?null:(Wn++,{value:Kt.value,key:Wn})}}function ae(zn){var Wn=zn?Object.keys(zn):[],sn=-1,Kt=Wn.length;return function Ce(){var xn=Wn[++sn];return xn==="__proto__"?Ce():sn<Kt?{value:zn[xn],key:xn}:null}}function Mn(zn){if((0,z.default)(zn))return ze(zn);var Wn=(0,F.default)(zn);return Wn?Vt(Wn):ae(zn)}At.exports=Bt.default}(te,te.exports);var Ut={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=Ae;function Ae(z){return function(){for(var rt=[],F=arguments.length;F--;)rt[F]=arguments[F];if(z===null)throw new Error("Callback was already called.");var ot=z;z=null,ot.apply(this,rt)}}At.exports=Bt.default})(Ut,Ut.exports);var we={exports:{}},ie={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae={};Bt.default=Ae,At.exports=Bt.default})(ie,ie.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=F;var Ae=ie.exports,z=rt(Ae);function rt(ot){return ot&&ot.__esModule?ot:{default:ot}}function F(ot,ze,Vt,ae){var Mn=!1,zn=!1,Wn=!1,sn=0,Kt=0;function Ce(){sn>=ze||Wn||Mn||(Wn=!0,ot.next().then(function(Zn){var Qt=Zn.value,ct=Zn.done;if(!(zn||Mn)){if(Wn=!1,ct){Mn=!0,sn<=0&&ae(null);return}sn++,Vt(Qt,Kt,xn),Kt++,Ce()}}).catch(Cn))}function xn(Zn,Qt){if(sn-=1,!zn){if(Zn)return Cn(Zn);if(Zn===!1){Mn=!0,zn=!0;return}if(Qt===z.default||Mn&&sn<=0)return Mn=!0,ae(null);Ce()}}function Cn(Zn){zn||(Wn=!1,Mn=!0,ae(Zn))}Ce()}At.exports=Bt.default}(we,we.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=gt.exports,z=sn(Ae),rt=te.exports,F=sn(rt),ot=Ut.exports,ze=sn(ot),Vt=fn,ae=we.exports,Mn=sn(ae),zn=ie.exports,Wn=sn(zn);function sn(Kt){return Kt&&Kt.__esModule?Kt:{default:Kt}}Bt.default=function(Kt){return function(Ce,xn,Cn){if(Cn=(0,z.default)(Cn),Kt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Ce)return Cn(null);if((0,Vt.isAsyncGenerator)(Ce))return(0,Mn.default)(Ce,Kt,xn,Cn);if((0,Vt.isAsyncIterable)(Ce))return(0,Mn.default)(Ce[Symbol.asyncIterator](),Kt,xn,Cn);var Zn=(0,F.default)(Ce),Qt=!1,ct=!1,bt=0,zt=!1;function me(bn,qn){if(!ct)if(bt-=1,bn)Qt=!0,Cn(bn);else if(bn===!1)Qt=!0,ct=!0;else{if(qn===Wn.default||Qt&&bt<=0)return Qt=!0,Cn(null);zt||de()}}function de(){for(zt=!0;bt<Kt&&!Qt;){var bn=Zn();if(bn===null){Qt=!0,bt<=0&&Cn(null);return}bt+=1,xn(bn.value,bn.key,(0,ze.default)(me))}zt=!1}de()}},At.exports=Bt.default}(Te,Te.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=Te.exports,z=Vt(Ae),rt=fn,F=Vt(rt),ot=Je.exports,ze=Vt(ot);function Vt(Mn){return Mn&&Mn.__esModule?Mn:{default:Mn}}function ae(Mn,zn,Wn,sn){return(0,z.default)(zn)(Mn,(0,F.default)(Wn),sn)}Bt.default=(0,ze.default)(ae,4),At.exports=Bt.default}(kt,kt.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=kt.exports,z=ot(Ae),rt=Je.exports,F=ot(rt);function ot(Vt){return Vt&&Vt.__esModule?Vt:{default:Vt}}function ze(Vt,ae,Mn){return(0,z.default)(Vt,1,ae,Mn)}Bt.default=(0,F.default)(ze,3),At.exports=Bt.default}(er,er.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=ze;var Ae=Le.exports,z=ot(Ae),rt=er.exports,F=ot(rt);function ot(Vt){return Vt&&Vt.__esModule?Vt:{default:Vt}}function ze(Vt,ae){return(0,z.default)(F.default,Vt,ae)}At.exports=Bt.default}(le,le.exports);var _t=xe(le.exports),Ne=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.call=function(){for(var Bt=arguments,Ae=[],z=0;z<arguments.length;z++)Ae[z]=Bt[z];return this.args=Ae,_t(this.tasks)},At.prototype.tap=function(Bt,Ae){var z=this;this.tasks.push(function(rt){Ae.apply(void 0,yt([],$e(z.args),!1)),rt(null,Bt)})},At}(),un={exports:{}},Qn={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=Lt.exports,z=xn(Ae),rt=ie.exports,F=xn(rt),ot=kt.exports,ze=xn(ot),Vt=gt.exports,ae=xn(Vt),Mn=Ut.exports,zn=xn(Mn),Wn=fn,sn=xn(Wn),Kt=Je.exports,Ce=xn(Kt);function xn(ct){return ct&&ct.__esModule?ct:{default:ct}}function Cn(ct,bt,zt){zt=(0,ae.default)(zt);var me=0,de=0,bn=ct.length,qn=!1;bn===0&&zt(null);function Sr(Gn,ht){Gn===!1&&(qn=!0),qn!==!0&&(Gn?zt(Gn):(++de===bn||ht===F.default)&&zt(null))}for(;me<bn;me++)bt(ct[me],me,(0,zn.default)(Sr))}function Zn(ct,bt,zt){return(0,ze.default)(ct,1/0,bt,zt)}function Qt(ct,bt,zt){var me=(0,z.default)(ct)?Cn:Zn;return me(ct,(0,sn.default)(bt),zt)}Bt.default=(0,Ce.default)(Qt,3),At.exports=Bt.default})(Qn,Qn.exports),function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=ze;var Ae=Qn.exports,z=ot(Ae),rt=Le.exports,F=ot(rt);function ot(Vt){return Vt&&Vt.__esModule?Vt:{default:Vt}}function ze(Vt,ae){return(0,F.default)(z.default,Vt,ae)}At.exports=Bt.default}(un,un.exports);var hr=xe(un.exports),Er=function(){function At(){this.tasks=[]}return At.prototype.promise=function(){return hr(this.tasks)},At.prototype.tapPromise=function(Bt,Ae){var z=this;this.tasks.push(function(rt){return pt(z,void 0,void 0,function(){return R(this,function(F){switch(F.label){case 0:return[4,Ae()];case 1:return F.sent(),rt(null,Bt),[2]}})})})},At}(),Ue={exports:{}};(function(At,Bt){Object.defineProperty(Bt,"__esModule",{value:!0});var Ae=gt.exports,z=Mn(Ae),rt=Ut.exports,F=Mn(rt),ot=fn,ze=Mn(ot),Vt=Je.exports,ae=Mn(Vt);function Mn(Wn){return Wn&&Wn.__esModule?Wn:{default:Wn}}function zn(Wn,sn){if(sn=(0,z.default)(sn),!Array.isArray(Wn))return sn(new Error("First argument to waterfall must be an array of functions"));if(!Wn.length)return sn();var Kt=0;function Ce(Cn){var Zn=(0,ze.default)(Wn[Kt++]);Zn.apply(void 0,Cn.concat([(0,F.default)(xn)]))}function xn(Cn){for(var Zn=[],Qt=arguments.length-1;Qt-- >0;)Zn[Qt]=arguments[Qt+1];if(Cn!==!1){if(Cn||Kt===Wn.length)return sn.apply(void 0,[Cn].concat(Zn));Ce(Zn)}}Ce([])}Bt.default=(0,ae.default)(zn),At.exports=Bt.default})(Ue,Ue.exports);var cn=xe(Ue.exports),wn=function(){function At(){this.tasks=[]}return At.prototype.call=function(){return cn(this.tasks)},At.prototype.tap=function(Bt,Ae){this.tasks.length===0?this.tasks.push(function(z){var rt=Ae();z(rt?null:!1,rt)}):this.tasks.push(function(z,rt){var F=Ae.apply(void 0,yt([],$e(z),!1));rt(F?null:!1,Bt)})},At}(),ir=function(){function At(){this.tasks=[]}return At.prototype.call=function(){return _t(this.tasks)},At.prototype.tap=function(Bt,Ae){this.tasks.push(function(z){var rt=Ae();z(rt,Bt)})},At}(),rn=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.promise=function(){for(var Bt=arguments,Ae=[],z=0;z<arguments.length;z++)Ae[z]=Bt[z];return this.args=Ae,_t(this.tasks)},At.prototype.tapPromise=function(Bt,Ae){var z=this;this.tasks.push(function(rt){return pt(z,void 0,void 0,function(){return R(this,function(F){switch(F.label){case 0:return[4,Ae.apply(void 0,yt([],$e(this.args),!1))];case 1:return F.sent(),rt(null,Bt),[2]}})})})},At}(),De=function(){function At(){this.args=[],this.tasks=[]}return At.prototype.promise=function(){for(var Bt=arguments,Ae=[],z=0;z<arguments.length;z++)Ae[z]=Bt[z];return this.args=Ae,_t(this.tasks)},At.prototype.tapPromise=function(Bt,Ae){var z=this;this.tasks.push(function(rt){return pt(z,void 0,void 0,function(){var F;return R(this,function(ot){switch(ot.label){case 0:return[4,Ae.apply(void 0,yt([],$e(this.args),!1))];case 1:return F=ot.sent(),rt(F,Bt),[2]}})})})},At}(),Be=function(){function At(){this.tasks=[]}return At.prototype.promise=function(){return cn(this.tasks)},At.prototype.tapPromise=function(Bt,Ae){this.tasks.length===0?this.tasks.push(function(z){Ae().then(function(rt){z(null,rt)})}):this.tasks.push(function(z,rt){Ae(z).then(function(F){rt(null,F)})})},At}()},17816:function(br,rr){(function(it,ne){ne(rr)})(this,function(it){"use strict";function ne(Mt){var Wt=typeof Symbol=="function"&&Symbol.iterator,Se=Wt&&Mt[Wt],qe=0;if(Se)return Se.call(Mt);if(Mt&&typeof Mt.length=="number")return{next:function(){return{value:(Mt=Mt&&qe>=Mt.length?void 0:Mt)&&Mt[qe++],done:!Mt}}};throw new TypeError(Wt?"Object is not iterable.":"Symbol.iterator is not defined.")}function pt(Mt,Wt){var Se=typeof Symbol=="function"&&Mt[Symbol.iterator];if(!Se)return Mt;var qe,Rn,Pn=Se.call(Mt),tn=[];try{for(;(Wt===void 0||0<Wt--)&&!(qe=Pn.next()).done;)tn.push(qe.value)}catch(mn){Rn={error:mn}}finally{try{qe&&!qe.done&&(Se=Pn.return)&&Se.call(Pn)}finally{if(Rn)throw Rn.error}}return tn}function R(Mt,Wt,Se){if(Se||arguments.length===2)for(var qe,Rn=0,Pn=Wt.length;Rn<Pn;Rn++)!qe&&Rn in Wt||((qe=qe||Array.prototype.slice.call(Wt,0,Rn))[Rn]=Wt[Rn]);return Mt.concat(qe||Array.prototype.slice.call(Wt))}function $e(Mt){return xe(Mt,"Function")}var yt={}.toString,xe=function(Mt,Wt){return yt.call(Mt)==="[object "+Wt+"]"},le=function(Mt){return Array.isArray?Array.isArray(Mt):xe(Mt,"Array")},Le=function(Mt){if(typeof(Wt=Mt)!="object"||Wt===null||!xe(Mt,"Object"))return!1;var Wt;if(Object.getPrototypeOf(Mt)===null)return!0;for(var Se=Mt;Object.getPrototypeOf(Se)!==null;)Se=Object.getPrototypeOf(Se);return Object.getPrototypeOf(Mt)===Se},Lt=function(Mt){return xe(Mt,"Number")},fn=Object.values?function(Mt){return Object.values(Mt)}:function(Mt){var Wt,Se=[],qe=Mt,Rn=function(dr,fr){$e(Mt)&&fr==="prototype"||Se.push(dr)};if(qe){if(le(qe))for(var Pn=0,tn=qe.length;Pn<tn&&Rn(qe[Pn],Pn)!==!1;Pn++);else if(Wt=typeof qe,qe!==null&&Wt=="object"||Wt=="function"){for(var mn in qe)if(qe.hasOwnProperty(mn)&&Rn(qe[mn],mn)===!1)break}}return Se},Nt=5;function Jt(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];for(var qe=0;qe<Wt.length;qe+=1)(function Rn(Pn,tn,mn,dr){for(var fr in mn=mn||0,dr=dr||Nt,tn){var ai;tn.hasOwnProperty(fr)&&((ai=tn[fr])!==null&&Le(ai)?(Le(Pn[fr])||(Pn[fr]={}),mn<dr?Rn(Pn[fr],ai,mn+1,dr):Pn[fr]=tn[fr]):le(ai)?(Pn[fr]=[],Pn[fr]=Pn[fr].concat(ai)):ai!==void 0&&(Pn[fr]=ai))}})(Mt,Wt[qe]);return Mt}function Ie(Mt){return Mt}(function(Mt,Wt){var Se;if($e(Mt))return(Se=function(){for(var qe=[],Rn=0;Rn<arguments.length;Rn++)qe[Rn]=arguments[Rn];var Pn,tn=Wt?Wt.apply(this,qe):qe[0],mn=Se.cache;return mn.has(tn)?mn.get(tn):(Pn=Mt.apply(this,qe),mn.set(tn,Pn),Pn)}).cache=new Map;throw new TypeError("Expected a function")})(function(Mt,tn){var Se=(tn=tn===void 0?{}:tn).fontSize,qe=tn.fontFamily,Rn=tn.fontWeight,Pn=tn.fontStyle,tn=tn.fontVariant;return(fe=fe||document.createElement("canvas").getContext("2d")).font=[Pn,tn,Rn,Se+"px",qe].join(" "),fe.measureText(xe(Mt,"String")?Mt:"").width},function(Mt,Wt){return function(){for(var Se=0,qe=0,Rn=arguments.length;qe<Rn;qe++)Se+=arguments[qe].length;for(var Pn=Array(Se),tn=0,qe=0;qe<Rn;qe++)for(var mn=arguments[qe],dr=0,fr=mn.length;dr<fr;dr++,tn++)Pn[tn]=mn[dr];return Pn}([Mt],fn(Wt=Wt===void 0?{}:Wt)).join("")});var fe,ce=typeof Float32Array!="undefined"?Float32Array:Array;function ve(){var Mt=new ce(9);return ce!=Float32Array&&(Mt[1]=0,Mt[2]=0,Mt[3]=0,Mt[5]=0,Mt[6]=0,Mt[7]=0),Mt[0]=1,Mt[4]=1,Mt[8]=1,Mt}Math.hypot||(Math.hypot=function(){for(var Mt=0,Wt=arguments.length;Wt--;)Mt+=arguments[Wt]*arguments[Wt];return Math.sqrt(Mt)});var Ze=function(Mt,Vi,Xi){var qe=Vi[0],Rn=Vi[1],Pn=Vi[2],tn=Vi[3],mn=Vi[4],dr=Vi[5],fr=Vi[6],ai=Vi[7],Vi=Vi[8],mo=Xi[0],si=Xi[1],Wi=Xi[2],Ui=Xi[3],Xr=Xi[4],bo=Xi[5],Ni=Xi[6],Eo=Xi[7],Xi=Xi[8];return Mt[0]=mo*qe+si*tn+Wi*fr,Mt[1]=mo*Rn+si*mn+Wi*ai,Mt[2]=mo*Pn+si*dr+Wi*Vi,Mt[3]=Ui*qe+Xr*tn+bo*fr,Mt[4]=Ui*Rn+Xr*mn+bo*ai,Mt[5]=Ui*Pn+Xr*dr+bo*Vi,Mt[6]=Ni*qe+Eo*tn+Xi*fr,Mt[7]=Ni*Rn+Eo*mn+Xi*ai,Mt[8]=Ni*Pn+Eo*dr+Xi*Vi,Mt};function Un(){var Mt=new ce(16);return ce!=Float32Array&&(Mt[1]=0,Mt[2]=0,Mt[3]=0,Mt[4]=0,Mt[6]=0,Mt[7]=0,Mt[8]=0,Mt[9]=0,Mt[11]=0,Mt[12]=0,Mt[13]=0,Mt[14]=0),Mt[0]=1,Mt[5]=1,Mt[10]=1,Mt[15]=1,Mt}var En=function(Mt,Ni,Se){var qe=Ni[0],Rn=Ni[1],Pn=Ni[2],tn=Ni[3],mn=Ni[4],dr=Ni[5],fr=Ni[6],ai=Ni[7],Vi=Ni[8],mo=Ni[9],si=Ni[10],Wi=Ni[11],Ui=Ni[12],Xr=Ni[13],bo=Ni[14],Ni=Ni[15],Eo=Se[0],Xi=Se[1],Mo=Se[2],Xo=Se[3];return Mt[0]=Eo*qe+Xi*mn+Mo*Vi+Xo*Ui,Mt[1]=Eo*Rn+Xi*dr+Mo*mo+Xo*Xr,Mt[2]=Eo*Pn+Xi*fr+Mo*si+Xo*bo,Mt[3]=Eo*tn+Xi*ai+Mo*Wi+Xo*Ni,Eo=Se[4],Xi=Se[5],Mo=Se[6],Xo=Se[7],Mt[4]=Eo*qe+Xi*mn+Mo*Vi+Xo*Ui,Mt[5]=Eo*Rn+Xi*dr+Mo*mo+Xo*Xr,Mt[6]=Eo*Pn+Xi*fr+Mo*si+Xo*bo,Mt[7]=Eo*tn+Xi*ai+Mo*Wi+Xo*Ni,Eo=Se[8],Xi=Se[9],Mo=Se[10],Xo=Se[11],Mt[8]=Eo*qe+Xi*mn+Mo*Vi+Xo*Ui,Mt[9]=Eo*Rn+Xi*dr+Mo*mo+Xo*Xr,Mt[10]=Eo*Pn+Xi*fr+Mo*si+Xo*bo,Mt[11]=Eo*tn+Xi*ai+Mo*Wi+Xo*Ni,Eo=Se[12],Xi=Se[13],Mo=Se[14],Xo=Se[15],Mt[12]=Eo*qe+Xi*mn+Mo*Vi+Xo*Ui,Mt[13]=Eo*Rn+Xi*dr+Mo*mo+Xo*Xr,Mt[14]=Eo*Pn+Xi*fr+Mo*si+Xo*bo,Mt[15]=Eo*tn+Xi*ai+Mo*Wi+Xo*Ni,Mt};function Vn(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];return Mt?Wt.reduce(function(qe,Rn){return function(Pn){return Rn(qe(Pn))}},Mt):Ie}function mr(Mt){return Mt instanceof Float32Array||Mt instanceof Array}function or(Mt,Wt,Se){for(;Mt<Wt;)Mt+=2*Math.PI;for(;Se<Mt;)Mt-=2*Math.PI;return Mt}zt=new ce(3),ce!=Float32Array&&(zt[0]=0,zt[1]=0,zt[2]=0),zt=new ce(4),ce!=Float32Array&&(zt[0]=0,zt[1]=0,zt[2]=0,zt[3]=0);function He(tn,Wt,Se,qe,Rn){var Pn=(tn=pt(tn,2))[0],tn=tn[1],mn=ve();return Pn=[Pn,tn],(tn=mn)[0]=1,tn[1]=0,tn[2]=0,tn[3]=0,tn[4]=1,tn[5]=0,tn[6]=Pn[0],tn[7]=Pn[1],tn[8]=1,tn}function $t(Mt,...Wt){return Wt.reduce((Se,qe)=>Rn=>Se(qe(Rn)),Mt)}function nn(Mt,Wt){return Wt-Mt?Se=>(Se-Mt)/(Wt-Mt):Se=>.5}const ke=Math.sqrt(50),Je=Math.sqrt(10),er=Math.sqrt(2);function kt(Mt,Wt,Se){return Wt=(Wt-Mt)/Math.max(0,Se),Mt=Math.floor(Math.log(Wt)/Math.LN10),Se=Wt/vf(10,Mt),0<=Mt?(Se>=ke?10:Se>=Je?5:Se>=er?2:1)*vf(10,Mt):-vf(10,-Mt)/(Se>=ke?10:Se>=Je?5:Se>=er?2:1)}const Te=(Mt,Wt,Se=5)=>{Mt=[Mt,Wt];let qe=0,Rn=Mt.length-1,Pn=Mt[qe],tn=Mt[Rn],mn;return tn<Pn&&([Pn,tn]=[tn,Pn],[qe,Rn]=[Rn,qe]),0<(mn=kt(Pn,tn,Se))?(Pn=Math.floor(Pn/mn)*mn,tn=Math.ceil(tn/mn)*mn,mn=kt(Pn,tn,Se)):mn<0&&(Pn=Math.ceil(Pn*mn)/mn,tn=Math.floor(tn*mn)/mn,mn=kt(Pn,tn,Se)),0<mn?(Mt[qe]=Math.floor(Pn/mn)*mn,Mt[Rn]=Math.ceil(tn/mn)*mn):mn<0&&(Mt[qe]=Math.ceil(Pn*mn)/mn,Mt[Rn]=Math.floor(tn*mn)/mn),Mt};function gt(Mt){return Mt!=null&&!Number.isNaN(Mt)}function te(Mt,Wt){return Se=>{Se.prototype.rescale=function(){this.initRange(),this.nice();var[qe]=this.chooseTransforms();this.composeOutput(qe,this.chooseClamp(qe))},Se.prototype.initRange=function(){var qe=this.options.interpolator;this.options.range=Mt(qe)},Se.prototype.composeOutput=function(qe,Rn){var Pn,{domain:mn,interpolator:tn,round:dr}=this.getOptions(),mn=Wt(mn.map(qe)),dr=dr?(Pn=tn,fr=>(fr=Pn(fr),Lt(fr)?Math.round(fr):fr)):tn;this.output=$t(dr,mn,Rn,qe)},Se.prototype.invert=void 0}}var Zt,zt={exports:{}},bt={exports:{}},Ut=function(Mt){return!(!Mt||typeof Mt=="string")&&(Mt instanceof Array||Array.isArray(Mt)||0<=Mt.length&&(Mt.splice instanceof Function||Object.getOwnPropertyDescriptor(Mt,Mt.length-1)&&Mt.constructor.name!=="String"))},we=Array.prototype.concat,ie=Array.prototype.slice,_t=bt.exports=function(Mt){for(var Wt=[],Se=0,qe=Mt.length;Se<qe;Se++){var Rn=Mt[Se];Ut(Rn)?Wt=we.call(Wt,ie.call(Rn)):Wt.push(Rn)}return Wt},Ne=(_t.wrap=function(Mt){return function(){return Mt(_t(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),un=bt.exports,Qn=Object.hasOwnProperty,hr=Object.create(null);for(Zt in Ne)Qn.call(Ne,Zt)&&(hr[Ne[Zt]]=Zt);var Er=zt.exports={to:{},get:{}};function Ue(Mt,Wt,Se){return Math.min(Math.max(Wt,Mt),Se)}function cn(Mt){return Mt=Math.round(Mt).toString(16).toUpperCase(),Mt.length<2?"0"+Mt:Mt}Er.get=function(Mt){var Wt,Se;switch(Mt.substring(0,3).toLowerCase()){case"hsl":Wt=Er.get.hsl(Mt),Se="hsl";break;case"hwb":Wt=Er.get.hwb(Mt),Se="hwb";break;default:Wt=Er.get.rgb(Mt),Se="rgb"}return Wt?{model:Se,value:Wt}:null},Er.get.rgb=function(Mt){if(!Mt)return null;var Wt,Se,qe,Rn=[0,0,0,1];if(Wt=Mt.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(qe=Wt[2],Wt=Wt[1],Se=0;Se<3;Se++){var Pn=2*Se;Rn[Se]=parseInt(Wt.slice(Pn,2+Pn),16)}qe&&(Rn[3]=parseInt(qe,16)/255)}else if(Wt=Mt.match(/^#([a-f0-9]{3,4})$/i)){for(qe=(Wt=Wt[1])[3],Se=0;Se<3;Se++)Rn[Se]=parseInt(Wt[Se]+Wt[Se],16);qe&&(Rn[3]=parseInt(qe+qe,16)/255)}else{if(Wt=Mt.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(Se=0;Se<3;Se++)Rn[Se]=parseInt(Wt[Se+1],0);else{if(!(Wt=Mt.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(Wt=Mt.match(/^(\w+)$/))?Wt[1]==="transparent"?[0,0,0,0]:Qn.call(Ne,Wt[1])?((Rn=Ne[Wt[1]])[3]=1,Rn):null:null;for(Se=0;Se<3;Se++)Rn[Se]=Math.round(2.55*parseFloat(Wt[Se+1]))}Wt[4]&&(Wt[5]?Rn[3]=.01*parseFloat(Wt[4]):Rn[3]=parseFloat(Wt[4]))}for(Se=0;Se<3;Se++)Rn[Se]=Ue(Rn[Se],0,255);return Rn[3]=Ue(Rn[3],0,1),Rn},Er.get.hsl=function(Mt){var Wt;return(Mt=Mt&&Mt.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Wt=parseFloat(Mt[4]),[(parseFloat(Mt[1])%360+360)%360,Ue(parseFloat(Mt[2]),0,100),Ue(parseFloat(Mt[3]),0,100),Ue(isNaN(Wt)?1:Wt,0,1)]):null},Er.get.hwb=function(Mt){var Wt;return(Mt=Mt&&Mt.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Wt=parseFloat(Mt[4]),[(parseFloat(Mt[1])%360+360)%360,Ue(parseFloat(Mt[2]),0,100),Ue(parseFloat(Mt[3]),0,100),Ue(isNaN(Wt)?1:Wt,0,1)]):null},Er.to.hex=function(){var Mt=un(arguments);return"#"+cn(Mt[0])+cn(Mt[1])+cn(Mt[2])+(Mt[3]<1?cn(Math.round(255*Mt[3])):"")},Er.to.rgb=function(){var Mt=un(arguments);return Mt.length<4||Mt[3]===1?"rgb("+Math.round(Mt[0])+", "+Math.round(Mt[1])+", "+Math.round(Mt[2])+")":"rgba("+Math.round(Mt[0])+", "+Math.round(Mt[1])+", "+Math.round(Mt[2])+", "+Mt[3]+")"},Er.to.rgb.percent=function(){var Mt=un(arguments),Wt=Math.round(Mt[0]/255*100),Se=Math.round(Mt[1]/255*100),qe=Math.round(Mt[2]/255*100);return Mt.length<4||Mt[3]===1?"rgb("+Wt+"%, "+Se+"%, "+qe+"%)":"rgba("+Wt+"%, "+Se+"%, "+qe+"%, "+Mt[3]+")"},Er.to.hsl=function(){var Mt=un(arguments);return Mt.length<4||Mt[3]===1?"hsl("+Mt[0]+", "+Mt[1]+"%, "+Mt[2]+"%)":"hsla("+Mt[0]+", "+Mt[1]+"%, "+Mt[2]+"%, "+Mt[3]+")"},Er.to.hwb=function(){var Mt=un(arguments),Wt="";return 4<=Mt.length&&Mt[3]!==1&&(Wt=", "+Mt[3]),"hwb("+Mt[0]+", "+Mt[1]+"%, "+Mt[2]+"%"+Wt+")"},Er.to.keyword=function(Mt){return hr[Mt.slice(0,3)]};var wn=zt.exports;function ir(Mt,Wt,Se){let qe=Se;return qe<0&&(qe+=1),1<qe&&--qe,qe<1/6?Mt+6*(Wt-Mt)*qe:qe<.5?Wt:qe<2/3?Mt+(Wt-Mt)*(2/3-qe)*6:Mt}function rn(Rn){var Wt,Se,qe,Rn=wn.get(Rn);return Rn?({model:Rn,value:Wt}=Rn,Rn==="rgb"?Wt:Rn==="hsl"?(Wt=(Rn=Wt)[0]/360,Se=Rn[1]/100,qe=Rn[2]/100,Rn=Rn[3],Se==0?[255*qe,255*qe,255*qe,Rn]:[255*ir(Se=2*qe-(qe=qe<.5?qe*(1+Se):qe+Se-qe*Se),qe,Wt+1/3),255*ir(Se,qe,Wt),255*ir(Se,qe,Wt-1/3),Rn]):null):null}const De=(Mt,Wt)=>Se=>Mt*(1-Se)+Wt*Se,Be=(Mt,Wt)=>{if(typeof Mt=="number"&&typeof Wt=="number")return De(Mt,Wt);if(typeof Mt!="string"||typeof Wt!="string")return()=>Mt;{var Se=Mt,qe=Wt;const Rn=rn(Se),Pn=rn(qe);return Rn===null||Pn===null?Rn?()=>Se:()=>qe:tn=>{var mn=new Array(4);for(let Wi=0;Wi<4;Wi+=1){var dr=Rn[Wi],fr=Pn[Wi];mn[Wi]=dr*(1-tn)+fr*tn}var[ai,Vi,mo,si]=mn;return`rgba(${Math.round(ai)}, ${Math.round(Vi)}, ${Math.round(mo)}, ${si})`}}},At=(Mt,Wt)=>{const Se=De(Mt,Wt);return qe=>Math.round(Se(qe))};function Bt({map:Mt,initKey:Wt},Se){return Wt=Wt(Se),Mt.has(Wt)?Mt.get(Wt):Se}function Ae(Mt){return typeof Mt=="object"?Mt.valueOf():Mt}class z extends Map{constructor(Wt){if(super(),this.map=new Map,this.initKey=Ae,Wt!==null)for(var[Se,qe]of Wt)this.set(Se,qe)}get(Wt){return super.get(Bt({map:this.map,initKey:this.initKey},Wt))}has(Wt){return super.has(Bt({map:this.map,initKey:this.initKey},Wt))}set(Wt,Se){return super.set(([{map:Wt,initKey:qe},Rn]=[{map:this.map,initKey:this.initKey},Wt],qe=qe(Rn),Wt.has(qe)?Wt.get(qe):(Wt.set(qe,Rn),Rn)),Se);var qe,Rn}delete(Wt){return super.delete(([{map:Wt,initKey:Se},qe]=[{map:this.map,initKey:this.initKey},Wt],Se=Se(qe),Wt.has(Se)&&(qe=Wt.get(Se),Wt.delete(Se)),qe));var Se,qe}}class rt{constructor(Wt){this.options=Jt({},this.getDefaultOptions()),this.update(Wt)}getOptions(){return this.options}update(Wt={}){this.options=Jt({},this.options,Wt),this.rescale(Wt)}rescale(Wt){}}const F=Symbol("defaultUnknown");function ot(Mt,Wt,Se){for(let qe=0;qe<Wt.length;qe+=1)Mt.has(Wt[qe])||Mt.set(Se(Wt[qe]),qe)}function ze(Wt){var{value:Wt,from:Se,to:qe,mapper:Rn,notFoundReturn:Pn}=Wt;let tn=Rn.get(Wt);if(tn===void 0){if(Pn!==F)return Pn;tn=Se.push(Wt)-1,Rn.set(Wt,tn)}return qe[tn%qe.length]}function Vt(Mt){return Mt instanceof Date?Wt=>""+Wt:typeof Mt=="object"?Wt=>JSON.stringify(Wt):Wt=>Wt}class ae extends rt{getDefaultOptions(){return{domain:[],range:[],unknown:F}}constructor(Wt){super(Wt)}map(Wt){return this.domainIndexMap.size===0&&ot(this.domainIndexMap,this.getDomain(),this.domainKey),ze({value:this.domainKey(Wt),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(Wt){return this.rangeIndexMap.size===0&&ot(this.rangeIndexMap,this.getRange(),this.rangeKey),ze({value:this.rangeKey(Wt),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(Wt){var[Se]=this.options.domain,[qe]=this.options.range;this.domainKey=Vt(Se),this.rangeKey=Vt(qe),this.rangeIndexMap?(Wt&&!Wt.range||this.rangeIndexMap.clear(),Wt&&!Wt.domain&&!Wt.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new ae(this.options)}getRange(){return this.options.range}getDomain(){var Wt,Se;return this.sortedDomain||({domain:Wt,compare:Se}=this.options,this.sortedDomain=Se?[...Wt].sort(Se):Wt),this.sortedDomain}}function Mn(Xr){const{domain:Wt,range:Se,paddingOuter:qe,paddingInner:Rn,flex:Pn,round:tn,align:mn}=Xr;var dr=Wt.length,si=0<(si=(Xr=dr)-(fr=Pn).length)?[...fr,...new Array(si).fill(1)]:si<0?fr.slice(0,Xr):fr,[Xr,fr]=Se,fr=fr-Xr,Ui=fr/(2/dr*qe+1-1/dr*Rn);const ai=Ui*Rn/dr;Ui-=dr*ai;const Vi=function(Xi){const Mo=Math.min(...Xi);return Xi.map(Xo=>Xo/Mo)}(si),mo=Ui/Vi.reduce((Xi,Mo)=>Xi+Mo);var si=new z(Wt.map((Xi,Mo)=>(Mo=Vi[Mo]*mo,[Xi,tn?Math.floor(Mo):Mo]))),Wi=new z(Wt.map((Xi,Mo)=>(Mo=Vi[Mo]*mo+ai,[Xi,tn?Math.floor(Mo):Mo]))),Ui=Array.from(Wi.values()).reduce((Xi,Mo)=>Xi+Mo),Xr=Xr+(fr-(Ui-Ui/dr*Rn))*mn;let bo=tn?Math.round(Xr):Xr;var Ni=new Array(dr);for(let Xi=0;Xi<dr;Xi+=1){Ni[Xi]=(Eo=bo,Math.round(1e12*Eo)/1e12);var Eo=Wt[Xi];bo+=Wi.get(Eo)}return{valueBandWidth:si,valueStep:Wi,adjustedRange:Ni}}class zn extends ae{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:F,flex:[]}}constructor(Wt){super(Wt)}clone(){return new zn(this.options)}getStep(Wt){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:Wt===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(Wt)}getBandWidth(Wt){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:Wt===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(Wt)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:Wt,paddingInner:Se}=this.options;return 0<Wt?Wt:Se}getPaddingOuter(){var{padding:Wt,paddingOuter:Se}=this.options;return 0<Wt?Wt:Se}rescale(){super.rescale();var{align:qe,domain:Wt,range:Rn,round:Pn,flex:Se}=this.options,{adjustedRange:qe,valueBandWidth:Rn,valueStep:Pn}=function(fr){var mn=fr.domain;if((mn=mn.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((dr=fr.flex)==null||!dr.length))return Mn(fr);var{range:dr,paddingOuter:fr,paddingInner:ai,round:Vi,align:mo}=fr;let si,Wi,Ui=dr[0];return dr=dr[1]-Ui,si=dr/Math.max(1,2*fr+(mn-ai)),Vi&&(si=Math.floor(si)),Ui+=(dr-si*(mn-ai))*mo,Wi=si*(1-ai),Vi&&(Ui=Math.round(Ui),Wi=Math.round(Wi)),fr=new Array(mn).fill(0).map((Xr,bo)=>Ui+bo*si),{valueStep:si,valueBandWidth:Wi,adjustedRange:fr}}({align:qe,range:Rn,round:Pn,flex:Se,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:Wt});this.valueStep=Pn,this.valueBandWidth=Rn,this.adjustedRange=qe}}const Wn=(Mt,Wt,Se)=>{let qe,Rn,Pn=Mt,tn=Wt;if(Pn===tn&&0<Se)return[Pn];let mn=kt(Pn,tn,Se);if(mn===0||!Number.isFinite(mn))return[];if(0<mn){Pn=Math.ceil(Pn/mn),tn=Math.floor(tn/mn),Rn=new Array(qe=Math.ceil(tn-Pn+1));for(let dr=0;dr<qe;dr+=1)Rn[dr]=(Pn+dr)*mn}else{mn=-mn,Pn=Math.ceil(Pn*mn),tn=Math.floor(tn*mn),Rn=new Array(qe=Math.ceil(tn-Pn+1));for(let dr=0;dr<qe;dr+=1)Rn[dr]=(Pn+dr)/mn}return Rn},sn=(qe,Pn,Se)=>{var[qe,Rn]=qe,[Pn,tn]=Pn;let mn,dr;return $t(dr=qe<Rn?(mn=nn(qe,Rn),Se(Pn,tn)):(mn=nn(Rn,qe),Se(tn,Pn)),mn)},Kt=(Mt,Wt,Se)=>{const qe=Math.min(Mt.length,Wt.length)-1,Rn=new Array(qe),Pn=new Array(qe);var tn=Mt[0]>Mt[qe],mn=tn?[...Mt].reverse():Mt,dr=tn?[...Wt].reverse():Wt;for(let fr=0;fr<qe;fr+=1)Rn[fr]=nn(mn[fr],mn[fr+1]),Pn[fr]=Se(dr[fr],dr[fr+1]);return fr=>{var ai=function(mo,si,Wi,Ui,Xr){let bo=Wi||0,Ni=Ui||mo.length;for(var Eo=Xr||(Mo=>Mo);bo<Ni;){var Xi=Math.floor((bo+Ni)/2);Eo(mo[Xi])>si?Ni=Xi:bo=Xi+1}return bo}(Mt,fr,1,qe)-1,Vi=Rn[ai];return $t(Pn[ai],Vi)(fr)}},Ce=(Mt,Wt,Se,qe)=>(2<Math.min(Mt.length,Wt.length)?Kt:sn)(Mt,Wt,qe?At:Se);class xn extends rt{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:De,tickCount:5}}map(Wt){return gt(Wt)?this.output(Wt):this.options.unknown}invert(Wt){return gt(Wt)?this.input(Wt):this.options.unknown}nice(){var Wt,Se,qe,Rn;this.options.nice&&([Wt,Se,qe,...Rn]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(Wt,Se,qe,...Rn))}getTicks(){var Wt=this.options.tickMethod,[Se,qe,Rn,...Pn]=this.getTickMethodOptions();return Wt(Se,qe,Rn,...Pn)}getTickMethodOptions(){var{domain:Wt,tickCount:Se}=this.options;return[Wt[0],Wt[Wt.length-1],Se]}chooseNice(){return Te}rescale(){this.nice();var[Wt,Se]=this.chooseTransforms();this.composeOutput(Wt,this.chooseClamp(Wt)),this.composeInput(Wt,Se,this.chooseClamp(Se))}chooseClamp(qe){var{clamp:Se,range:Rn}=this.options,qe=this.options.domain.map(qe),Rn=Math.min(qe.length,Rn.length);if(Se){Se=qe[0],qe=qe[Rn-1];const Pn=qe<Se?qe:Se,tn=qe<Se?Se:qe;return mn=>Math.min(Math.max(Pn,mn),tn)}return Ie}composeOutput(Wt,Se){var{domain:tn,range:qe,round:Rn,interpolate:Pn}=this.options,tn=Ce(tn.map(Wt),qe,Pn,Rn);this.output=$t(tn,Se,Wt)}composeInput(Wt,Se,qe){var{domain:Rn,range:Pn}=this.options,Pn=Ce(Pn,Rn.map(Wt),De);this.input=$t(Se,qe,Pn)}}class Cn extends xn{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Be,tickMethod:Wn,tickCount:5}}chooseTransforms(){return[Ie,Ie]}clone(){return new Cn(this.options)}}class Zn extends zn{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:F,paddingInner:1,paddingOuter:0}}constructor(Wt){super(Wt)}getPaddingInner(){return 1}clone(){return new Zn(this.options)}update(Wt){super.update(Wt)}getPaddingOuter(){return this.options.padding}}function Qt(Mt,Wt){for(var Se=[],qe=0,Rn=Mt.length;qe<Rn;qe++)Se.push(Mt[qe].substr(0,Wt));return Se}var ct,bt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],zt=["January","February","March","April","May","June","July","August","September","October","November","December"],me=Qt(zt,3);(function(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];for(var qe=0,Rn=Wt;qe<Rn.length;qe++){var Pn,tn=Rn[qe];for(Pn in tn)Mt[Pn]=tn[Pn]}})({},{dayNamesShort:Qt(bt,3),dayNames:bt,monthNamesShort:me,monthNames:zt,amPm:["am","pm"],DoFn:function(Mt){return Mt+["th","st","nd","rd"][3<Mt%10?0:(Mt-Mt%10!=10?1:0)*Mt%10]}});var de;let bn=ct=class extends Cn{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Ie,tickMethod:Wn,tickCount:5}}constructor(Mt){super(Mt)}clone(){return new ct(this.options)}};bn=ct=function(Mt,Wt,Se,qe){var Rn,Pn=arguments.length,tn=Pn<3?Wt:qe===null?qe=Object.getOwnPropertyDescriptor(Wt,Se):qe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")tn=Reflect.decorate(Mt,Wt,Se,qe);else for(var mn=Mt.length-1;0<=mn;mn--)(Rn=Mt[mn])&&(tn=(Pn<3?Rn(tn):3<Pn?Rn(Wt,Se,tn):Rn(Wt,Se))||tn);return 3<Pn&&tn&&Object.defineProperty(Wt,Se,tn),tn}([te(function(Mt){return[Mt(0),Mt(1)]},Wt=>{var[Wt,Se]=Wt;return $t(De(0,1),nn(Wt,Se))})],bn);let qn=de=class extends Cn{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Ie,tickMethod:Wn,tickCount:5}}constructor(Mt){super(Mt)}clone(){return new de(this.options)}};qn=de=function(Mt,Wt,Se,qe){var Rn,Pn=arguments.length,tn=Pn<3?Wt:qe===null?qe=Object.getOwnPropertyDescriptor(Wt,Se):qe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")tn=Reflect.decorate(Mt,Wt,Se,qe);else for(var mn=Mt.length-1;0<=mn;mn--)(Rn=Mt[mn])&&(tn=(Pn<3?Rn(tn):3<Pn?Rn(Wt,Se,tn):Rn(Wt,Se))||tn);return 3<Pn&&tn&&Object.defineProperty(Wt,Se,tn),tn}([te(function(Mt){return[Mt(0),Mt(.5),Mt(1)]},Mt=>{const[Wt,Se,qe]=Mt,Rn=$t(De(0,.5),nn(Wt,Se)),Pn=$t(De(.5,1),nn(Se,qe));return tn=>(Wt>qe?tn<Se?Pn:Rn:tn<Se?Rn:Pn)(tn)})],qn);function Sr(Mt,Wt,Se,qe,Rn){var Pn=new Cn({range:[Wt,Wt+qe]}),tn=new Cn({range:[Se,Se+Rn]});return{transform:function(fr){var fr=pt(fr,2),dr=fr[0],fr=fr[1];return[Pn.map(dr),tn.map(fr)]},untransform:function(fr){var fr=pt(fr,2),dr=fr[0],fr=fr[1];return[Pn.invert(dr),tn.invert(fr)]}}}function Gn(Mt,Wt,Se,qe,Rn){return(0,pt(Mt,1)[0])(Wt,Se,qe,Rn)}function ht(Mt,Wt,Se,qe,Rn){return pt(Mt,1)[0]}function ut(dr,Wt,Se,qe,Rn){var Pn=(dr=pt(dr,4))[0],tn=dr[1],mn=dr[2],dr=dr[3],fr=new Cn({range:[mn,dr]}),ai=new Cn({range:[Pn,tn]}),Vi=1<(mn=Rn/qe)?1:mn,mo=1<mn?1/mn:1;return{transform:function(Ui){var Ui=pt(Ui,2),Wi=Ui[0],Ui=Ui[1],Wi=ai.map(Wi),Ui=fr.map(Ui);return[.5*(Ui*Math.cos(Wi)*Vi)+.5,.5*(Ui*Math.sin(Wi)*mo)+.5]},untransform:function(Xr){var Xr=pt(Xr,2),Wi=Xr[0],Xr=Xr[1],Wi=2*(Wi-.5)/Vi,Xr=2*(Xr-.5)/mo,Ui=Math.sqrt(Math.pow(Wi,2)+Math.pow(Xr,2)),Xr=or(Math.atan2(Xr,Wi),Pn,tn);return[ai.invert(Xr),fr.invert(Ui)]}}}function wt(Mt,Wt,Se,qe,Rn){return{transform:function(tn){var tn=pt(tn,2),mn=tn[0];return[tn[1],mn]},untransform:function(tn){var tn=pt(tn,2),mn=tn[0];return[tn[1],mn]}}}function Gt(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];return Hn.apply(void 0,R([[-1,-1]],pt(Wt),!1))}function ue(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];return Hn.apply(void 0,R([[-1,1]],pt(Wt),!1))}function Ge(Mt){for(var Wt=[],Se=1;Se<arguments.length;Se++)Wt[Se-1]=arguments[Se];return Hn.apply(void 0,R([[1,-1]],pt(Wt),!1))}function ln(tn,Wt,Se,qe,Rn){var Pn,tn=pt(tn,1)[0],mn=ve();return mn=mn,tn=tn,Pn=Math.sin(tn),tn=Math.cos(tn),mn[0]=tn,mn[1]=Pn,mn[2]=0,mn[3]=-Pn,mn[4]=tn,mn[5]=0,mn[6]=0,mn[7]=0,mn[8]=1,mn}function ee(Mt,Wt,Se,qe,Rn){var Pn=(Mt=pt(Mt,4))[0],tn=Mt[1],mn=Mt[2],dr=(Mt[3]-mn)/(+tn/(2*Math.PI)+1),fr=dr/(2*Math.PI),ai=new Cn({range:[mn,mn+.99*dr]}),Vi=new Cn({range:[Pn,tn]}),mo=1<(Mt=Rn/qe)?1:Mt,si=1<Mt?1/Mt:1;return{transform:function(Xr){var Xr=pt(Xr,2),Ui=Xr[0],Xr=Xr[1],Ui=Vi.map(Ui),Xr=ai.map(Xr);return[.5*(Math.cos(Ui)*(fr*Ui+Xr)*mo)+.5,.5*(Math.sin(Ui)*(fr*Ui+Xr)*si)+.5]},untransform:function(Xr){var Xr=pt(Xr,2),bo=Xr[0],Xr=Xr[1],bo=2*(bo-.5)/mo,Xr=2*(Xr-.5)/si,Ui=Math.sqrt(Math.pow(bo,2)+Math.pow(Xr,2)),Xr=or(Math.atan2(Xr,bo)+Math.floor(Ui/dr)*Math.PI*2,Pn,tn),bo=Ui-fr*Xr;return[Vi.invert(Xr),ai.invert(bo)]}}}function Fe(dr,Wt,Se,qe,Rn){var Pn=(dr=pt(dr,4))[0],tn=dr[1],mn=dr[2],dr=dr[3],fr=new Cn({range:[mn,dr]});return{transform:function(ai){for(var Vi=[],mo=ai.length,si=new Zn({domain:new Array(mo).fill(0).map(function(bo,Ni){return Ni}),range:[Pn,tn]}),Wi=0;Wi<mo;Wi++){var Xr=ai[Wi],Ui=si.map(Wi),Xr=fr.map(Xr);Vi.push(Ui,Xr)}return Vi},untransform:function(ai){for(var Vi=[],mo=0;mo<ai.length;mo+=2){var si=ai[mo+1];Vi.push(fr.invert(si))}return Vi}}}var Hn=function(tn,Wt,Se,qe,Rn){var tn=pt(tn,2),Pn=tn[0],tn=tn[1],mn=ve();return Pn=[Pn,tn],(tn=mn)[0]=Pn[0],tn[1]=0,tn[2]=0,tn[3]=0,tn[4]=Pn[1],tn[5]=0,tn[6]=0,tn[7]=0,tn[8]=1,tn};function Tr(Mt){return 1/Math.tan(Mt)}function Zr(Mt,Wt,Se,qe,Rn){var Pn=Tr(pt(Mt,1)[0]);return{transform:function(dr){var dr=pt(dr,2),mn=dr[0],dr=dr[1];return[mn+dr*Pn,dr]},untransform:function(dr){var dr=pt(dr,2),mn=dr[0],dr=dr[1];return[mn-dr*Pn,dr]}}}function vr(Mt,Wt,Se,qe,Rn){var Pn=Tr(pt(Mt,1)[0]);return{transform:function(mn){var mn=pt(mn,2),dr=mn[0];return[dr,mn[1]+dr*Pn]},untransform:function(mn){var mn=pt(mn,2),dr=mn[0];return[dr,mn[1]-dr*Pn]}}}function Ur(Mt,Wt,Se,mn,tn){var Pn=Mt<Wt,tn=(Pn?Wt-mn:tn-Wt)||tn-mn,mn=Pn?-1:1;return mn*tn*(Se+1)/(Se+tn/((Mt-Wt)*mn))+Wt}function jr(Mt,Wt,Se,qe,tn){var Pn=Mt<Wt,tn=(Pn?Wt-qe:tn-Wt)||tn-qe;return tn/(tn*(Se+1)/(Mt-Wt)-Se*(Pn?-1:1))+Wt}function ni(Mt,Wt,Se){return Se?new Cn({range:[0,1],domain:[0,Wt]}).map(Mt):Mt}function Ar(mn,Wt,Se,qe,Rn){var Pn=(mn=pt(mn,3))[0],tn=mn[1],mn=mn[2],dr=ni(Pn,qe,mn!==void 0&&mn);return{transform:function(Vi){var Vi=pt(Vi,2),ai=Vi[0],Vi=Vi[1];return[Ur(ai,dr,tn,0,1),Vi]},untransform:function(Vi){var Vi=pt(Vi,2),ai=Vi[0],Vi=Vi[1];return[jr(ai,dr,tn,0,1),Vi]}}}function pi(mn,Wt,Se,qe,Rn){var Pn=(mn=pt(mn,3))[0],tn=mn[1],mn=mn[2],dr=ni(Pn,Rn,mn!==void 0&&mn);return{transform:function(fr){return fr=pt(fr,2),[fr[0],Ur(fr[1],dr,tn,0,1)]},untransform:function(fr){return fr=pt(fr,2),[fr[0],jr(fr[1],dr,tn,0,1)]}}}function mi(fr,Wt,Se,qe,Rn){var Pn=(fr=pt(fr,5))[0],tn=fr[1],mn=fr[2],dr=fr[3],fr=fr[4],ai=ni(Pn,qe,fr=fr!==void 0&&fr),Vi=ni(tn,Rn,fr);return{transform:function(Wi){var Wi=pt(Wi,2),si=Wi[0],Wi=Wi[1];return[Ur(si,ai,mn,0,1),Ur(Wi,Vi,dr,0,1)]},untransform:function(Wi){var Wi=pt(Wi,2),si=Wi[0],Wi=Wi[1];return[jr(si,ai,mn,0,1),jr(Wi,Vi,dr,0,1)]}}}function xi(fr,Wt,Se,qe,Rn){var Pn=(fr=pt(fr,5))[0],tn=fr[1],mn=fr[2],dr=fr[3],fr=(fr=fr[4])!==void 0&&fr,ai=new Cn({range:[0,qe]}),Vi=new Cn({range:[0,Rn]}),mo=fr?Pn:ai.map(Pn),si=fr?tn:Vi.map(tn);return{transform:function(Xr){var Xr=pt(Xr,2),Ui=Xr[0],Xr=Xr[1],bo=ai.map(Ui)-mo,Ni=Vi.map(Xr)-si,Eo=Math.sqrt(bo*bo+Ni*Ni);return mn<Eo?[Ui,Xr]:(Ui=Ur(Eo,0,dr,0,mn),Xr=Math.atan2(Ni,bo),Eo=mo+Ui*Math.cos(Xr),Ni=si+Ui*Math.sin(Xr),[ai.invert(Eo),Vi.invert(Ni)])},untransform:function(Xr){var Xr=pt(Xr,2),Ui=Xr[0],Xr=Xr[1],bo=ai.map(Ui)-mo,Ni=Vi.map(Xr)-si,Eo=Math.sqrt(bo*bo+Ni*Ni);return mn<Eo?[Ui,Xr]:(Ui=jr(Eo,0,dr,0,mn),Xr=Math.atan2(Ni,bo),Eo=mo+Ui*Math.cos(Xr),Ni=si+Ui*Math.sin(Xr),[ai.invert(Eo),Vi.invert(Ni)])}}}function wo(Mt,Wt,Se,qe,Rn,Pn,tn){var mn=new Cn({range:[Wt,Wt+Rn]}),dr=new Cn({range:[Se,Se+Pn]}),fr=new Cn({range:[qe,qe+tn]});return{transform:function(si){var si=pt(si,3),Vi=si[0],mo=si[1],si=si[2];return[mn.map(Vi),dr.map(mo),fr.map(si)]},untransform:function(si){var si=pt(si,3),Vi=si[0],mo=si[1],si=si[2];return[mn.invert(Vi),dr.invert(mo),fr.invert(si)]}}}function Li(ai,Wt,Se,qe,Rn,Pn,tn){var mn,dr=(ai=pt(ai,3))[0],fr=ai[1],ai=ai[2];return mn=Un(),dr=[dr,fr,ai],mn[0]=1,mn[1]=0,mn[2]=0,mn[3]=0,mn[4]=0,mn[5]=1,mn[6]=0,mn[7]=0,mn[8]=0,mn[9]=0,mn[10]=1,mn[11]=0,mn[12]=dr[0],mn[13]=dr[1],mn[14]=dr[2],mn[15]=1,mn}function aa(Mt,Wt,Se,qe,Rn,Pn,tn){return{transform:function(dr){var dr=pt(dr,3),fr=dr[0];return[dr[1],fr,dr[2]]},untransform:function(dr){var dr=pt(dr,3),fr=dr[0];return[dr[1],fr,dr[2]]}}}function Pa(ai,Wt,Se,qe,Rn,Pn,tn){var mn,dr=(ai=pt(ai,3))[0],fr=ai[1],ai=ai[2];return mn=Un(),dr=[dr,fr,ai],mn[0]=dr[0],mn[1]=0,mn[2]=0,mn[3]=0,mn[4]=0,mn[5]=dr[1],mn[6]=0,mn[7]=0,mn[8]=0,mn[9]=0,mn[10]=dr[2],mn[11]=0,mn[12]=0,mn[13]=0,mn[14]=0,mn[15]=1,mn}Lo.prototype.update=function(Mt){this.options=Jt({},this.options,Mt),this.recoordinate()},Lo.prototype.clone=function(){return new Lo(this.options)},Lo.prototype.getOptions=function(){return this.options},Lo.prototype.clear=function(){this.update({transformations:[]})},Lo.prototype.getSize=function(){var Mt=this.options;return[Mt.width,Mt.height]},Lo.prototype.getCenter=function(){var Mt=this.options,Wt=Mt.x,Se=Mt.y;return[(2*Wt+Mt.width)/2,(2*Se+Mt.height)/2]},Lo.prototype.transform=function(){for(var Mt=[],Wt=0;Wt<arguments.length;Wt++)Mt[Wt]=arguments[Wt];var Se=this.options.transformations;return this.update({transformations:R(R([],pt(Se),!1),[R([],pt(Mt),!1)],!1)}),this},Lo.prototype.map=function(Mt){return this.output(Mt)},Lo.prototype.invert=function(Mt){return this.input(Mt)},Lo.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Lo.prototype.compose=function(Mt){function Wt(Xi,Mo){var Xo;mn.push((Mo=Mo===void 0?!0:Mo)?(Xo=Xi,function(wl){for(var Ya=[],ca=0;ca<wl.length-1;ca+=2){var ws=[wl[ca],wl[ca+1]],ws=Xo(ws);Ya.push.apply(Ya,R([],pt(ws),!1))}return Ya}):Xi)}var Se,qe,Rn=(Mt=Mt===void 0?!1:Mt)?R([],pt(this.options.transformations),!1).reverse():this.options.transformations,Pn=Mt?function(Xi){return Xi.untransform}:function(Xi){return Xi.transform},tn=[],mn=[];try{for(var dr=ne(Rn),fr=dr.next();!fr.done;fr=dr.next()){var ai,Vi,mo,si,Wi,Ui,Xr=pt(fr.value),bo=Xr[0],Ni=Xr.slice(1),Eo=this.transformers[bo];Eo&&(Vi=(ai=this.options).x,mo=ai.y,si=ai.width,Wi=ai.height,mr(Ui=Eo(R([],pt(Ni),!1),Vi,mo,si,Wi))?tn.push(Ui):(tn.length&&(Wt(this.createMatrixTransform(tn,Mt)),tn.splice(0,tn.length)),Wt(Pn(Ui)||Ie,bo!=="parallel")))}}catch(Xi){Se={error:Xi}}finally{try{fr&&!fr.done&&(qe=dr.return)&&qe.call(dr)}finally{if(Se)throw Se.error}}return tn.length&&Wt(this.createMatrixTransform(tn,Mt)),Vn.apply(void 0,R([],pt(mn),!1))},Lo.prototype.createMatrixTransform=function(Mt,Wt){var Se,qe,Rn,Pn,tn,mn,dr,fr,ai,Vi,mo,si,Wi=ve();return Wt&&Mt.reverse(),Mt.forEach(function(Ui){return Ze(Wi,Wi,Ui)}),Wt&&(Wt=Mt=Wi,(si=new ce(9))[0]=Wt[0],si[1]=Wt[1],si[2]=Wt[2],si[3]=Wt[3],si[4]=Wt[4],si[5]=Wt[5],si[6]=Wt[6],si[7]=Wt[7],si[8]=Wt[8],si=(Wt=si)[0],Se=Wt[1],qe=Wt[2],Rn=Wt[3],Pn=Wt[4],tn=Wt[5],mn=Wt[6],dr=Wt[7],fr=(Wt=Wt[8])*Pn-tn*dr,mo=si*fr+Se*(ai=-Wt*Rn+tn*mn)+qe*(Vi=dr*Rn-Pn*mn))&&(Mt[0]=fr*(mo=1/mo),Mt[1]=(-Wt*Se+qe*dr)*mo,Mt[2]=(tn*Se-qe*Pn)*mo,Mt[3]=ai*mo,Mt[4]=(Wt*si-qe*mn)*mo,Mt[5]=(-tn*si+qe*Rn)*mo,Mt[6]=Vi*mo,Mt[7]=(-dr*si+Se*mn)*mo,Mt[8]=(Pn*si-Se*Rn)*mo),function(Mo){var Xr,bo,Ni,Eo,Xi,Mo=[Mo[0],Mo[1],1];return Ni=Wi,Eo=(bo=Xr=Mo)[0],Xi=bo[1],bo=bo[2],Xr[0]=Eo*Ni[0]+Xi*Ni[3]+bo*Ni[6],Xr[1]=Eo*Ni[1]+Xi*Ni[4]+bo*Ni[7],Xr[2]=Eo*Ni[2]+Xi*Ni[5]+bo*Ni[8],[Mo[0],Mo[1]]}},bt=Lo;function Lo(Mt){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:Sr,translate:He,custom:Gn,matrix:ht,polar:ut,transpose:wt,scale:Hn,"shear.x":Zr,"shear.y":vr,reflect:Gt,"reflect.x":ue,"reflect.y":Ge,rotate:ln,helix:ee,parallel:Fe,fisheye:mi,"fisheye.x":Ar,"fisheye.y":pi,"fisheye.circular":xi},this.update(Mt)}$o.prototype.update=function(Mt){this.options=Jt({},this.options,Mt),this.recoordinate()},$o.prototype.clone=function(){return new $o(this.options)},$o.prototype.getOptions=function(){return this.options},$o.prototype.clear=function(){this.update({transformations:[]})},$o.prototype.getSize=function(){var Mt=this.options;return[Mt.width,Mt.height,Mt.depth]},$o.prototype.getCenter=function(){var Mt=this.options,Wt=Mt.x,Se=Mt.y,qe=Mt.z;return[(2*Wt+Mt.width)/2,(2*Se+Mt.height)/2,(2*qe+Mt.depth)/2]},$o.prototype.transform=function(){for(var Mt=[],Wt=0;Wt<arguments.length;Wt++)Mt[Wt]=arguments[Wt];var Se=this.options.transformations;return this.update({transformations:R(R([],pt(Se),!1),[R([],pt(Mt),!1)],!1)}),this},$o.prototype.map=function(Mt){return this.output(Mt)},$o.prototype.invert=function(Mt){return this.input(Mt)},$o.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},$o.prototype.compose=function(Mt){function Wt(Xo,wl){var Ya;mn.push((wl=wl===void 0?!0:wl)?(Ya=Xo,function(ca){for(var ws=[],Ms=0;Ms<ca.length-1;Ms+=3){var re=[ca[Ms],ca[Ms+1],ca[Ms+2]],re=Ya(re);ws.push.apply(ws,R([],pt(re),!1))}return ws}):Xo)}var Se,qe,Rn=(Mt=Mt===void 0?!1:Mt)?R([],pt(this.options.transformations),!1).reverse():this.options.transformations,Pn=Mt?function(Xo){return Xo.untransform}:function(Xo){return Xo.transform},tn=[],mn=[];try{for(var dr=ne(Rn),fr=dr.next();!fr.done;fr=dr.next()){var ai,Vi,mo,si,Wi,Ui,Xr,bo,Ni=pt(fr.value),Eo=Ni[0],Xi=Ni.slice(1),Mo=this.transformers[Eo];Mo&&(Vi=(ai=this.options).x,mo=ai.y,si=ai.z,Wi=ai.width,Ui=ai.height,Xr=ai.depth,mr(bo=Mo(R([],pt(Xi),!1),Vi,mo,si,Wi,Ui,Xr))?tn.push(bo):(tn.length&&(Wt(this.createMatrixTransform(tn,Mt)),tn.splice(0,tn.length)),Wt(Pn(bo)||Ie,!0)))}}catch(Xo){Se={error:Xo}}finally{try{fr&&!fr.done&&(qe=dr.return)&&qe.call(dr)}finally{if(Se)throw Se.error}}return tn.length&&Wt(this.createMatrixTransform(tn,Mt)),Vn.apply(void 0,R([],pt(mn),!1))},$o.prototype.createMatrixTransform=function(Mt,Wt){var Se,qe,Rn,Pn,tn,mn,dr,fr,ai,Vi,mo,si,Wi,Ui,Xr,bo,Ni,Eo,Xi,Mo,Xo,wl,Ya,ca,ws,Ms,re,ge,An=Un();return Wt&&Mt.reverse(),Mt.forEach(function(tr){return En(An,An,tr)}),Wt&&(Wt=Mt=An,(ge=new ce(16))[0]=Wt[0],ge[1]=Wt[1],ge[2]=Wt[2],ge[3]=Wt[3],ge[4]=Wt[4],ge[5]=Wt[5],ge[6]=Wt[6],ge[7]=Wt[7],ge[8]=Wt[8],ge[9]=Wt[9],ge[10]=Wt[10],ge[11]=Wt[11],ge[12]=Wt[12],ge[13]=Wt[13],ge[14]=Wt[14],ge[15]=Wt[15],ge=(Wt=ge)[0],Se=Wt[1],qe=Wt[2],Rn=Wt[3],Pn=Wt[4],tn=Wt[5],mn=Wt[6],dr=Wt[7],fr=Wt[8],ai=Wt[9],Vi=Wt[10],mo=Wt[11],si=Wt[12],Wi=Wt[13],Ui=Wt[14],Wt=Wt[15],re=(Xr=ge*tn-Se*Pn)*(Ms=Vi*Wt-mo*Ui)-(bo=ge*mn-qe*Pn)*(ws=ai*Wt-mo*Wi)+(Ni=ge*dr-Rn*Pn)*(ca=ai*Ui-Vi*Wi)+(Eo=Se*mn-qe*tn)*(Ya=fr*Wt-mo*si)-(Xi=Se*dr-Rn*tn)*(wl=fr*Ui-Vi*si)+(Mo=qe*dr-Rn*mn)*(Xo=fr*Wi-ai*si))&&(Mt[0]=(tn*Ms-mn*ws+dr*ca)*(re=1/re),Mt[1]=(qe*ws-Se*Ms-Rn*ca)*re,Mt[2]=(Wi*Mo-Ui*Xi+Wt*Eo)*re,Mt[3]=(Vi*Xi-ai*Mo-mo*Eo)*re,Mt[4]=(mn*Ya-Pn*Ms-dr*wl)*re,Mt[5]=(ge*Ms-qe*Ya+Rn*wl)*re,Mt[6]=(Ui*Ni-si*Mo-Wt*bo)*re,Mt[7]=(fr*Mo-Vi*Ni+mo*bo)*re,Mt[8]=(Pn*ws-tn*Ya+dr*Xo)*re,Mt[9]=(Se*Ya-ge*ws-Rn*Xo)*re,Mt[10]=(si*Xi-Wi*Ni+Wt*Xr)*re,Mt[11]=(ai*Ni-fr*Xi-mo*Xr)*re,Mt[12]=(tn*wl-Pn*ca-mn*Xo)*re,Mt[13]=(ge*ca-Se*wl+qe*Xo)*re,Mt[14]=(Wi*bo-si*Eo-Ui*Xr)*re,Mt[15]=(fr*Eo-ai*bo+Vi*Xr)*re),function(rl){var Ei,Si,uo,Es,Ns,As,rl=[rl[0],rl[1],rl[2],1];return uo=An,Es=(Si=Ei=rl)[0],Ns=Si[1],As=Si[2],Si=Si[3],Ei[0]=uo[0]*Es+uo[4]*Ns+uo[8]*As+uo[12]*Si,Ei[1]=uo[1]*Es+uo[5]*Ns+uo[9]*As+uo[13]*Si,Ei[2]=uo[2]*Es+uo[6]*Ns+uo[10]*As+uo[14]*Si,Ei[3]=uo[3]*Es+uo[7]*Ns+uo[11]*As+uo[15]*Si,[rl[0],rl[1],rl[2]]}},me=$o;function $o(Mt){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:wo,translate3D:Li,scale3D:Pa,transpose3D:aa},this.update(Mt)}it.Coordinate=bt,it.Coordinate3D=me,Object.defineProperty(it,"__esModule",{value:!0})})},90857:function(br){"use strict";var rr=Object.prototype.hasOwnProperty,it="~";function ne(){}Object.create&&(ne.prototype=Object.create(null),new ne().__proto__||(it=!1));function pt(xe,le,Le){this.fn=xe,this.context=le,this.once=Le||!1}function R(xe,le,Le,Lt,fn){if(typeof Le!="function")throw new TypeError("The listener must be a function");var Nt=new pt(Le,Lt||xe,fn),Jt=it?it+le:le;return xe._events[Jt]?xe._events[Jt].fn?xe._events[Jt]=[xe._events[Jt],Nt]:xe._events[Jt].push(Nt):(xe._events[Jt]=Nt,xe._eventsCount++),xe}function $e(xe,le){--xe._eventsCount===0?xe._events=new ne:delete xe._events[le]}function yt(){this._events=new ne,this._eventsCount=0}yt.prototype.eventNames=function(){var le=[],Le,Lt;if(this._eventsCount===0)return le;for(Lt in Le=this._events)rr.call(Le,Lt)&&le.push(it?Lt.slice(1):Lt);return Object.getOwnPropertySymbols?le.concat(Object.getOwnPropertySymbols(Le)):le},yt.prototype.listeners=function(le){var Le=it?it+le:le,Lt=this._events[Le];if(!Lt)return[];if(Lt.fn)return[Lt.fn];for(var fn=0,Nt=Lt.length,Jt=new Array(Nt);fn<Nt;fn++)Jt[fn]=Lt[fn].fn;return Jt},yt.prototype.listenerCount=function(le){var Le=it?it+le:le,Lt=this._events[Le];return Lt?Lt.fn?1:Lt.length:0},yt.prototype.emit=function(le,Le,Lt,fn,Nt,Jt){var Ie=it?it+le:le;if(!this._events[Ie])return!1;var fe=this._events[Ie],ce=arguments.length,ve,Ze;if(fe.fn){switch(fe.once&&this.removeListener(le,fe.fn,void 0,!0),ce){case 1:return fe.fn.call(fe.context),!0;case 2:return fe.fn.call(fe.context,Le),!0;case 3:return fe.fn.call(fe.context,Le,Lt),!0;case 4:return fe.fn.call(fe.context,Le,Lt,fn),!0;case 5:return fe.fn.call(fe.context,Le,Lt,fn,Nt),!0;case 6:return fe.fn.call(fe.context,Le,Lt,fn,Nt,Jt),!0}for(Ze=1,ve=new Array(ce-1);Ze<ce;Ze++)ve[Ze-1]=arguments[Ze];fe.fn.apply(fe.context,ve)}else{var Un=fe.length,En;for(Ze=0;Ze<Un;Ze++)switch(fe[Ze].once&&this.removeListener(le,fe[Ze].fn,void 0,!0),ce){case 1:fe[Ze].fn.call(fe[Ze].context);break;case 2:fe[Ze].fn.call(fe[Ze].context,Le);break;case 3:fe[Ze].fn.call(fe[Ze].context,Le,Lt);break;case 4:fe[Ze].fn.call(fe[Ze].context,Le,Lt,fn);break;default:if(!ve)for(En=1,ve=new Array(ce-1);En<ce;En++)ve[En-1]=arguments[En];fe[Ze].fn.apply(fe[Ze].context,ve)}}return!0},yt.prototype.on=function(le,Le,Lt){return R(this,le,Le,Lt,!1)},yt.prototype.once=function(le,Le,Lt){return R(this,le,Le,Lt,!0)},yt.prototype.removeListener=function(le,Le,Lt,fn){var Nt=it?it+le:le;if(!this._events[Nt])return this;if(!Le)return $e(this,Nt),this;var Jt=this._events[Nt];if(Jt.fn)Jt.fn===Le&&(!fn||Jt.once)&&(!Lt||Jt.context===Lt)&&$e(this,Nt);else{for(var Ie=0,fe=[],ce=Jt.length;Ie<ce;Ie++)(Jt[Ie].fn!==Le||fn&&!Jt[Ie].once||Lt&&Jt[Ie].context!==Lt)&&fe.push(Jt[Ie]);fe.length?this._events[Nt]=fe.length===1?fe[0]:fe:$e(this,Nt)}return this},yt.prototype.removeAllListeners=function(le){var Le;return le?(Le=it?it+le:le,this._events[Le]&&$e(this,Le)):(this._events=new ne,this._eventsCount=0),this},yt.prototype.off=yt.prototype.removeListener,yt.prototype.addListener=yt.prototype.on,yt.prefixed=it,yt.EventEmitter=yt,br.exports=yt},38554:function(br){"use strict";var rr=Object.prototype.hasOwnProperty,it="~";function ne(){}Object.create&&(ne.prototype=Object.create(null),new ne().__proto__||(it=!1));function pt(xe,le,Le){this.fn=xe,this.context=le,this.once=Le||!1}function R(xe,le,Le,Lt,fn){if(typeof Le!="function")throw new TypeError("The listener must be a function");var Nt=new pt(Le,Lt||xe,fn),Jt=it?it+le:le;return xe._events[Jt]?xe._events[Jt].fn?xe._events[Jt]=[xe._events[Jt],Nt]:xe._events[Jt].push(Nt):(xe._events[Jt]=Nt,xe._eventsCount++),xe}function $e(xe,le){--xe._eventsCount===0?xe._events=new ne:delete xe._events[le]}function yt(){this._events=new ne,this._eventsCount=0}yt.prototype.eventNames=function(){var le=[],Le,Lt;if(this._eventsCount===0)return le;for(Lt in Le=this._events)rr.call(Le,Lt)&&le.push(it?Lt.slice(1):Lt);return Object.getOwnPropertySymbols?le.concat(Object.getOwnPropertySymbols(Le)):le},yt.prototype.listeners=function(le){var Le=it?it+le:le,Lt=this._events[Le];if(!Lt)return[];if(Lt.fn)return[Lt.fn];for(var fn=0,Nt=Lt.length,Jt=new Array(Nt);fn<Nt;fn++)Jt[fn]=Lt[fn].fn;return Jt},yt.prototype.listenerCount=function(le){var Le=it?it+le:le,Lt=this._events[Le];return Lt?Lt.fn?1:Lt.length:0},yt.prototype.emit=function(le,Le,Lt,fn,Nt,Jt){var Ie=it?it+le:le;if(!this._events[Ie])return!1;var fe=this._events[Ie],ce=arguments.length,ve,Ze;if(fe.fn){switch(fe.once&&this.removeListener(le,fe.fn,void 0,!0),ce){case 1:return fe.fn.call(fe.context),!0;case 2:return fe.fn.call(fe.context,Le),!0;case 3:return fe.fn.call(fe.context,Le,Lt),!0;case 4:return fe.fn.call(fe.context,Le,Lt,fn),!0;case 5:return fe.fn.call(fe.context,Le,Lt,fn,Nt),!0;case 6:return fe.fn.call(fe.context,Le,Lt,fn,Nt,Jt),!0}for(Ze=1,ve=new Array(ce-1);Ze<ce;Ze++)ve[Ze-1]=arguments[Ze];fe.fn.apply(fe.context,ve)}else{var Un=fe.length,En;for(Ze=0;Ze<Un;Ze++)switch(fe[Ze].once&&this.removeListener(le,fe[Ze].fn,void 0,!0),ce){case 1:fe[Ze].fn.call(fe[Ze].context);break;case 2:fe[Ze].fn.call(fe[Ze].context,Le);break;case 3:fe[Ze].fn.call(fe[Ze].context,Le,Lt);break;case 4:fe[Ze].fn.call(fe[Ze].context,Le,Lt,fn);break;default:if(!ve)for(En=1,ve=new Array(ce-1);En<ce;En++)ve[En-1]=arguments[En];fe[Ze].fn.apply(fe[Ze].context,ve)}}return!0},yt.prototype.on=function(le,Le,Lt){return R(this,le,Le,Lt,!1)},yt.prototype.once=function(le,Le,Lt){return R(this,le,Le,Lt,!0)},yt.prototype.removeListener=function(le,Le,Lt,fn){var Nt=it?it+le:le;if(!this._events[Nt])return this;if(!Le)return $e(this,Nt),this;var Jt=this._events[Nt];if(Jt.fn)Jt.fn===Le&&(!fn||Jt.once)&&(!Lt||Jt.context===Lt)&&$e(this,Nt);else{for(var Ie=0,fe=[],ce=Jt.length;Ie<ce;Ie++)(Jt[Ie].fn!==Le||fn&&!Jt[Ie].once||Lt&&Jt[Ie].context!==Lt)&&fe.push(Jt[Ie]);fe.length?this._events[Nt]=fe.length===1?fe[0]:fe:$e(this,Nt)}return this},yt.prototype.removeAllListeners=function(le){var Le;return le?(Le=it?it+le:le,this._events[Le]&&$e(this,Le)):(this._events=new ne,this._eventsCount=0),this},yt.prototype.off=yt.prototype.removeListener,yt.prototype.addListener=yt.prototype.on,yt.prefixed=it,yt.EventEmitter=yt,br.exports=yt},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(br){try{let Lt=function(){yt||(yt=!0,R())},fn=function(){try{$e.documentElement.doScroll("left")}catch(Nt){return void setTimeout(fn,50)}Lt()};var le=Lt,Le=fn,it=(it=document.getElementsByTagName("script"))[it.length-1],rr=it.getAttribute("data-injectcss"),it=it.getAttribute("data-disable-injectsvg");if(!it){var ne,pt,R,$e,yt,xe=function(Nt,Jt){Jt.parentNode.insertBefore(Nt,Jt)};if(rr&&!br.__iconfont__svg__cssinject__){br.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(Nt){console&&console.log(Nt)}}ne=function(){var Nt,Jt=document.createElement("div");Jt.innerHTML=br._iconfont_svg_string_3580659,(Jt=Jt.getElementsByTagName("svg")[0])&&(Jt.setAttribute("aria-hidden","true"),Jt.style.position="absolute",Jt.style.width=0,Jt.style.height=0,Jt.style.overflow="hidden",Jt=Jt,(Nt=document.body).firstChild?xe(Jt,Nt.firstChild):Nt.appendChild(Jt))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(ne,0):(pt=function(){document.removeEventListener("DOMContentLoaded",pt,!1),ne()},document.addEventListener("DOMContentLoaded",pt,!1)):document.attachEvent&&(R=ne,$e=br.document,yt=!1,fn(),$e.onreadystatechange=function(){$e.readyState=="complete"&&($e.onreadystatechange=null,Lt())})}}catch(Lt){}}(window)},39827:function(br,rr,it){"use strict";it.d(rr,{GC:function(){return z},h0:function(){return rn},lv:function(){return hr},lo:function(){return Ue},kw:function(){return cn},Or:function(){return wn},KD:function(){return At},I9:function(){return rt},lE:function(){return Be},d:function(){return Er},n3:function(){return Qf},vY:function(){return Bt},P7:function(){return Kf},yn:function(){return De},ee:function(){return Ae},v2:function(){return mn},e7:function(){return il},Hp:function(){return gh},gl:function(){return yt},cO:function(){return jh},Vb:function(){return ce}});var ne=it(1413),pt=it(4942),R=it(8543);let $e=function(K){return K.Normal="normal",K.PostProcessing="post-processing",K}({}),yt=function(K){return K[K.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",K[K.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",K[K.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",K[K.POINTS=0]="POINTS",K[K.LINES=1]="LINES",K[K.LINE_LOOP=2]="LINE_LOOP",K[K.LINE_STRIP=3]="LINE_STRIP",K[K.TRIANGLES=4]="TRIANGLES",K[K.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",K[K.TRIANGLE_FAN=6]="TRIANGLE_FAN",K[K.ZERO=0]="ZERO",K[K.ONE=1]="ONE",K[K.SRC_COLOR=768]="SRC_COLOR",K[K.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",K[K.SRC_ALPHA=770]="SRC_ALPHA",K[K.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",K[K.DST_ALPHA=772]="DST_ALPHA",K[K.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",K[K.DST_COLOR=774]="DST_COLOR",K[K.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",K[K.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",K[K.FUNC_ADD=32774]="FUNC_ADD",K[K.BLEND_EQUATION=32777]="BLEND_EQUATION",K[K.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",K[K.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",K[K.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",K[K.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",K[K.MAX_EXT=32776]="MAX_EXT",K[K.MIN_EXT=32775]="MIN_EXT",K[K.BLEND_DST_RGB=32968]="BLEND_DST_RGB",K[K.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",K[K.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",K[K.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",K[K.CONSTANT_COLOR=32769]="CONSTANT_COLOR",K[K.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",K[K.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",K[K.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",K[K.BLEND_COLOR=32773]="BLEND_COLOR",K[K.ARRAY_BUFFER=34962]="ARRAY_BUFFER",K[K.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",K[K.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",K[K.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",K[K.STREAM_DRAW=35040]="STREAM_DRAW",K[K.STATIC_DRAW=35044]="STATIC_DRAW",K[K.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",K[K.BUFFER_SIZE=34660]="BUFFER_SIZE",K[K.BUFFER_USAGE=34661]="BUFFER_USAGE",K[K.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",K[K.FRONT=1028]="FRONT",K[K.BACK=1029]="BACK",K[K.FRONT_AND_BACK=1032]="FRONT_AND_BACK",K[K.CULL_FACE=2884]="CULL_FACE",K[K.BLEND=3042]="BLEND",K[K.DITHER=3024]="DITHER",K[K.STENCIL_TEST=2960]="STENCIL_TEST",K[K.DEPTH_TEST=2929]="DEPTH_TEST",K[K.SCISSOR_TEST=3089]="SCISSOR_TEST",K[K.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",K[K.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",K[K.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",K[K.NO_ERROR=0]="NO_ERROR",K[K.INVALID_ENUM=1280]="INVALID_ENUM",K[K.INVALID_VALUE=1281]="INVALID_VALUE",K[K.INVALID_OPERATION=1282]="INVALID_OPERATION",K[K.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",K[K.CW=2304]="CW",K[K.CCW=2305]="CCW",K[K.LINE_WIDTH=2849]="LINE_WIDTH",K[K.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",K[K.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",K[K.CULL_FACE_MODE=2885]="CULL_FACE_MODE",K[K.FRONT_FACE=2886]="FRONT_FACE",K[K.DEPTH_RANGE=2928]="DEPTH_RANGE",K[K.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",K[K.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",K[K.DEPTH_FUNC=2932]="DEPTH_FUNC",K[K.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",K[K.STENCIL_FUNC=2962]="STENCIL_FUNC",K[K.STENCIL_FAIL=2964]="STENCIL_FAIL",K[K.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",K[K.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",K[K.STENCIL_REF=2967]="STENCIL_REF",K[K.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",K[K.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",K[K.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",K[K.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",K[K.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",K[K.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",K[K.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",K[K.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",K[K.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",K[K.VIEWPORT=2978]="VIEWPORT",K[K.SCISSOR_BOX=3088]="SCISSOR_BOX",K[K.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",K[K.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",K[K.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",K[K.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",K[K.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",K[K.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",K[K.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",K[K.RED_BITS=3410]="RED_BITS",K[K.GREEN_BITS=3411]="GREEN_BITS",K[K.BLUE_BITS=3412]="BLUE_BITS",K[K.ALPHA_BITS=3413]="ALPHA_BITS",K[K.DEPTH_BITS=3414]="DEPTH_BITS",K[K.STENCIL_BITS=3415]="STENCIL_BITS",K[K.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",K[K.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",K[K.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",K[K.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",K[K.SAMPLES=32937]="SAMPLES",K[K.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",K[K.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",K[K.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",K[K.DONT_CARE=4352]="DONT_CARE",K[K.FASTEST=4353]="FASTEST",K[K.NICEST=4354]="NICEST",K[K.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",K[K.BYTE=5120]="BYTE",K[K.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",K[K.SHORT=5122]="SHORT",K[K.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",K[K.INT=5124]="INT",K[K.UNSIGNED_INT=5125]="UNSIGNED_INT",K[K.FLOAT=5126]="FLOAT",K[K.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",K[K.ALPHA=6406]="ALPHA",K[K.RGB=6407]="RGB",K[K.RGBA=6408]="RGBA",K[K.LUMINANCE=6409]="LUMINANCE",K[K.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",K[K.RED=6403]="RED",K[K.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",K[K.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",K[K.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",K[K.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",K[K.VERTEX_SHADER=35633]="VERTEX_SHADER",K[K.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",K[K.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",K[K.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",K[K.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",K[K.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",K[K.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",K[K.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",K[K.SHADER_TYPE=35663]="SHADER_TYPE",K[K.DELETE_STATUS=35712]="DELETE_STATUS",K[K.LINK_STATUS=35714]="LINK_STATUS",K[K.VALIDATE_STATUS=35715]="VALIDATE_STATUS",K[K.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",K[K.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",K[K.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",K[K.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",K[K.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",K[K.NEVER=512]="NEVER",K[K.LESS=513]="LESS",K[K.EQUAL=514]="EQUAL",K[K.LEQUAL=515]="LEQUAL",K[K.GREATER=516]="GREATER",K[K.NOTEQUAL=517]="NOTEQUAL",K[K.GEQUAL=518]="GEQUAL",K[K.ALWAYS=519]="ALWAYS",K[K.KEEP=7680]="KEEP",K[K.REPLACE=7681]="REPLACE",K[K.INCR=7682]="INCR",K[K.DECR=7683]="DECR",K[K.INVERT=5386]="INVERT",K[K.INCR_WRAP=34055]="INCR_WRAP",K[K.DECR_WRAP=34056]="DECR_WRAP",K[K.VENDOR=7936]="VENDOR",K[K.RENDERER=7937]="RENDERER",K[K.VERSION=7938]="VERSION",K[K.NEAREST=9728]="NEAREST",K[K.LINEAR=9729]="LINEAR",K[K.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",K[K.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",K[K.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",K[K.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",K[K.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",K[K.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",K[K.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",K[K.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",K[K.TEXTURE_2D=3553]="TEXTURE_2D",K[K.TEXTURE=5890]="TEXTURE",K[K.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",K[K.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",K[K.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",K[K.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",K[K.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",K[K.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",K[K.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",K[K.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",K[K.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",K[K.TEXTURE0=33984]="TEXTURE0",K[K.TEXTURE1=33985]="TEXTURE1",K[K.TEXTURE2=33986]="TEXTURE2",K[K.TEXTURE3=33987]="TEXTURE3",K[K.TEXTURE4=33988]="TEXTURE4",K[K.TEXTURE5=33989]="TEXTURE5",K[K.TEXTURE6=33990]="TEXTURE6",K[K.TEXTURE7=33991]="TEXTURE7",K[K.TEXTURE8=33992]="TEXTURE8",K[K.TEXTURE9=33993]="TEXTURE9",K[K.TEXTURE10=33994]="TEXTURE10",K[K.TEXTURE11=33995]="TEXTURE11",K[K.TEXTURE12=33996]="TEXTURE12",K[K.TEXTURE13=33997]="TEXTURE13",K[K.TEXTURE14=33998]="TEXTURE14",K[K.TEXTURE15=33999]="TEXTURE15",K[K.TEXTURE16=34e3]="TEXTURE16",K[K.TEXTURE17=34001]="TEXTURE17",K[K.TEXTURE18=34002]="TEXTURE18",K[K.TEXTURE19=34003]="TEXTURE19",K[K.TEXTURE20=34004]="TEXTURE20",K[K.TEXTURE21=34005]="TEXTURE21",K[K.TEXTURE22=34006]="TEXTURE22",K[K.TEXTURE23=34007]="TEXTURE23",K[K.TEXTURE24=34008]="TEXTURE24",K[K.TEXTURE25=34009]="TEXTURE25",K[K.TEXTURE26=34010]="TEXTURE26",K[K.TEXTURE27=34011]="TEXTURE27",K[K.TEXTURE28=34012]="TEXTURE28",K[K.TEXTURE29=34013]="TEXTURE29",K[K.TEXTURE30=34014]="TEXTURE30",K[K.TEXTURE31=34015]="TEXTURE31",K[K.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",K[K.REPEAT=10497]="REPEAT",K[K.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",K[K.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",K[K.FLOAT_VEC2=35664]="FLOAT_VEC2",K[K.FLOAT_VEC3=35665]="FLOAT_VEC3",K[K.FLOAT_VEC4=35666]="FLOAT_VEC4",K[K.INT_VEC2=35667]="INT_VEC2",K[K.INT_VEC3=35668]="INT_VEC3",K[K.INT_VEC4=35669]="INT_VEC4",K[K.BOOL=35670]="BOOL",K[K.BOOL_VEC2=35671]="BOOL_VEC2",K[K.BOOL_VEC3=35672]="BOOL_VEC3",K[K.BOOL_VEC4=35673]="BOOL_VEC4",K[K.FLOAT_MAT2=35674]="FLOAT_MAT2",K[K.FLOAT_MAT3=35675]="FLOAT_MAT3",K[K.FLOAT_MAT4=35676]="FLOAT_MAT4",K[K.SAMPLER_2D=35678]="SAMPLER_2D",K[K.SAMPLER_CUBE=35680]="SAMPLER_CUBE",K[K.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",K[K.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",K[K.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",K[K.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",K[K.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",K[K.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",K[K.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",K[K.COMPILE_STATUS=35713]="COMPILE_STATUS",K[K.LOW_FLOAT=36336]="LOW_FLOAT",K[K.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",K[K.HIGH_FLOAT=36338]="HIGH_FLOAT",K[K.LOW_INT=36339]="LOW_INT",K[K.MEDIUM_INT=36340]="MEDIUM_INT",K[K.HIGH_INT=36341]="HIGH_INT",K[K.FRAMEBUFFER=36160]="FRAMEBUFFER",K[K.RENDERBUFFER=36161]="RENDERBUFFER",K[K.RGBA4=32854]="RGBA4",K[K.RGB5_A1=32855]="RGB5_A1",K[K.RGB565=36194]="RGB565",K[K.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",K[K.STENCIL_INDEX=6401]="STENCIL_INDEX",K[K.STENCIL_INDEX8=36168]="STENCIL_INDEX8",K[K.DEPTH_STENCIL=34041]="DEPTH_STENCIL",K[K.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",K[K.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",K[K.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",K[K.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",K[K.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",K[K.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",K[K.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",K[K.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",K[K.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",K[K.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",K[K.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",K[K.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",K[K.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",K[K.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",K[K.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",K[K.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",K[K.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",K[K.NONE=0]="NONE",K[K.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",K[K.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",K[K.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",K[K.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",K[K.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",K[K.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",K[K.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",K[K.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",K[K.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",K[K.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",K[K.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",K[K.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",K[K.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",K[K.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",K}({});const xe=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:le,isNil:Le,upperFirst:Lt}=R.lodashUtil;class fn{constructor(){(0,pt.Z)(this,"shaderModuleService",void 0),(0,pt.Z)(this,"rendererService",void 0),(0,pt.Z)(this,"config",void 0),(0,pt.Z)(this,"quad",xe),(0,pt.Z)(this,"enabled",!0),(0,pt.Z)(this,"renderToScreen",!1),(0,pt.Z)(this,"model",void 0),(0,pt.Z)(this,"name",void 0),(0,pt.Z)(this,"optionsToUpdate",{})}getName(){return this.name}setName(lt){this.name=lt}getType(){return $e.PostProcessing}init(lt,It){this.config=It,this.rendererService=lt.getContainer().rendererService,this.shaderModuleService=lt.getContainer().shaderModuleService;const{createAttribute:Ke,createBuffer:X,createModel:Xn}=this.rendererService,{vs:Mr,fs:ki,uniforms:Jr}=this.setupShaders();this.model=Xn({vs:Mr,fs:ki,attributes:{a_Position:Ke({buffer:X({data:[-4,-4,4,-4,0,4],type:yt.FLOAT}),size:2})},uniforms:(0,ne.Z)((0,ne.Z)({u_Texture:null},Jr),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(lt,It){const Ke=lt.multiPassRenderer.getPostProcessor(),{useFramebuffer:X,getViewportSize:Xn,clear:Mr}=this.rendererService,{width:ki,height:Jr}=Xn();X(this.renderToScreen?null:Ke.getWriteFBO(),()=>{Mr({framebuffer:Ke.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const co=(0,ne.Z)({u_BloomFinal:0,u_Texture:Ke.getReadFBO(),u_ViewportSize:[ki,Jr]},this.convertOptionsToUniforms(this.optionsToUpdate));It&&(co.u_BloomFinal=1,co.u_Texture2=It),this.model.draw({uniforms:co})})}isEnabled(){return this.enabled}setEnabled(lt){this.enabled=lt}setRenderToScreen(lt){this.renderToScreen=lt}updateOptions(lt){this.optionsToUpdate=(0,ne.Z)((0,ne.Z)({},this.optionsToUpdate),lt)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(lt){const It={};return Object.keys(lt).forEach(Ke=>{Le(lt[Ke])||(It[`u_${Lt(le(Ke))}`]=lt[Ke])}),It}}function Nt(K){let lt=0;switch(K){case"vec2":case"ivec2":lt=2;break;case"vec3":case"ivec3":lt=3;break;case"vec4":case"ivec4":case"mat2":lt=4;break;case"mat3":lt=9;break;case"mat4":lt=16;break;default:}return lt}const Jt=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Ie(K,lt=!1){const It={};return K=K.replace(Jt,(Ke,X,Xn)=>{const Mr=Xn.split(":"),ki=Mr[0].trim();let Jr="";switch(Mr.length>1&&(Jr=Mr[1].trim()),X){case"bool":Jr=Jr==="true";break;case"float":case"int":Jr=Number(Jr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Jr?Jr=Jr.replace("[","").replace("]","").split(",").reduce((co,so)=>(co.push(Number(so.trim())),co),[]):Jr=new Array(Nt(X)).fill(0);break;default:}return It[ki]=Jr,`${lt?"uniform ":""}${X} ${ki};
`}),{content:K,uniforms:It}}function fe(K){let{content:lt,uniforms:It}=Ie(K,!0);return lt=lt.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(Ke,X,Xn)=>{Xn=Xn.trim().replace(/^.*$/gm,Jr=>`uniform ${Jr}`);const{content:Mr,uniforms:ki}=Ie(Xn);return Object.assign(It,ki),`${X}{
${Mr}
};`}),{content:lt,uniforms:It}}function ce(K){const lt={};return K.replace(Jt,(It,Ke,X)=>{const Xn=X.trim();return lt[Xn]?"":(lt[Xn]=!0,`uniform ${Ke} ${Xn};
`)})}const ve=null;function Ze(K){return ve.indexOf(K)}const{clamp:Un}=R.lodashUtil,En=2,Vn=4,mr=64,or=128,He=256,$t=512,nn=8192,ke=16384,Je=32768,er=null,kt=131072,Te=262144,gt=524288,te=1048576,Zt=2097152,Ut=4194304,we=8388608,ie=16777216,_t=null;function Ne(K,lt){return K=Un(Math.floor(K),0,255),lt=Un(Math.floor(lt),0,255),256*K+lt}function un(K){const{color:lt,radius:It,tileX:Ke,tileY:X,shape:Xn,opacity:Mr,stroke:ki,strokeWidth:Jr,strokeOpacity:co}=K,so=[],sa=[],Po=[],_a=[Ne(lt[0],lt[1]),Ne(lt[2],lt[3])],qa=[Ne(ki[0],ki[1]),Ne(ki[2],ki[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([ra,ma])=>{so.push([..._a,(ra+1)*we+(ma+1)*Zt+getShapeIndex(Xn)*kt+It,(Ke+512)*gt+(X+512)*mr]),sa.push([...qa,Jr,co]),Po.push([Mr,0,0,0])}),{packedBuffer:so,packedBuffer2:sa,packedBuffer3:Po}}function Qn(K,lt){if(K===0&&!lt)return 0;if(K===1&&lt)return 4294967295;const It=lt?1:0,Ke=Math.floor(K*127);return Ke*_t+It*ie+Ke*kt+It*er+Ke*$t+It*He+Ke*En+It}const hr={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let Er=function(K){return K.TOPRIGHT="topright",K.TOPLEFT="topleft",K.BOTTOMRIGHT="bottomright",K.BOTTOMLEFT="bottomleft",K.TOPCENTER="topcenter",K.BOTTOMCENTER="bottomcenter",K.LEFTCENTER="leftcenter",K.RIGHTCENTER="rightcenter",K.LEFTTOP="lefttop",K.RIGHTTOP="righttop",K.LEFTBOTTOM="leftbottom",K.RIGHTBOTTOM="rightbottom",K}({}),Ue=function(K){return K[K.LNGLAT=1]="LNGLAT",K[K.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",K[K.VECTOR_TILE=3]="VECTOR_TILE",K[K.IDENTITY=4]="IDENTITY",K[K.METER_OFFSET=5]="METER_OFFSET",K}({});const cn={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var wn={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let ir=function(K){return K.Hover="hover",K.Click="click",K.Select="select",K.Active="active",K.Drag="drag",K}({}),rn=function(K){return K.normal="normal",K.additive="additive",K.subtractive="subtractive",K.min="min",K.max="max",K.none="none",K}({}),De=function(K){return K.MULTIPLE="MULTIPLE",K.SINGLE="SINGLE",K}({}),Be=function(K){return K.AND="and",K.OR="or",K}({}),At=function(K){return K.INIT="init",K.UPDATE="update",K}({}),Bt=function(K){return K.LINEAR="linear",K.SEQUENTIAL="sequential",K.POWER="power",K.LOG="log",K.IDENTITY="identity",K.TIME="time",K.QUANTILE="quantile",K.QUANTIZE="quantize",K.THRESHOLD="threshold",K.CAT="cat",K.DIVERGING="diverging",K.CUSTOM="threshold",K}({}),Ae=function(K){return K.CONSTANT="constant",K.VARIABLE="variable",K}({}),z=function(K){return K[K.Attribute=0]="Attribute",K[K.InstancedAttribute=1]="InstancedAttribute",K[K.Uniform=2]="Uniform",K}({});const rt=["mapload","mapchange","mapAfterFrameChange"];var F=it(49296),ot=it.n(F),ze=it(26729),Vt=it.n(ze);const ae=30;function Mn({characterSet:K,getFontWidth:lt,fontHeight:It,buffer:Ke,maxCanvasWidth:X,mapping:Xn={},xOffset:Mr=0,yOffset:ki=0}){let Jr=0,co=Mr;Array.from(K).forEach((sa,Po)=>{if(!Xn[sa]){const _a=lt(sa,Po);co+ae>X&&(co=0,Jr++),Xn[sa]={x:co,y:ki+Jr*ae,width:ae,height:ae,advance:_a},co+=ae}});const so=It+Ke*2;return{mapping:Xn,xOffset:co,yOffset:ki+Jr*so,canvasHeight:sn(ki+(Jr+1)*so)}}function zn(K,lt,It){let Ke=0,X=0,Xn=0,Mr=[];const ki={};for(const co of K)if(!ki[co.id]){const{size:so}=co;Ke+so+lt>It&&(Wn(ki,Mr,X),Ke=0,X=Xn+X+lt,Xn=0,Mr=[]),Mr.push({icon:co,xOffset:Ke}),Ke=Ke+so+lt,Xn=Math.max(Xn,so)}Mr.length>0&&Wn(ki,Mr,X);const Jr=sn(Xn+X+lt);return{mapping:ki,canvasHeight:Jr}}function Wn(K,lt,It){for(const Ke of lt){const{icon:X,xOffset:Xn}=Ke;K[X.id]=(0,ne.Z)((0,ne.Z)({},X),{},{x:Xn,y:It,image:X.image,width:X.width,height:X.height})}}function sn(K){return Math.pow(2,Math.ceil(Math.log2(K)))}const Kt=qn(),Ce="sans-serif",xn="normal",Cn=24,Zn=3,Qt=.25,ct=8,bt=1024,zt=1,me=1,de=3,bn=null;function qn(){const K=[];for(let lt=32;lt<128;lt++)K.push(String.fromCharCode(lt));return K}function Sr(K,lt,It,Ke){K.font=`${Ke} ${It}px ${lt}`,K.fillStyle="black",K.textBaseline="middle"}function Gn(K,lt){for(let It=0;It<K.length;It++)lt.data[4*It+3]=K[It]}class ht extends ze.EventEmitter{constructor(...lt){super(...lt),(0,pt.Z)(this,"fontAtlas",void 0),(0,pt.Z)(this,"iconFontMap",void 0),(0,pt.Z)(this,"iconFontGlyphs",{}),(0,pt.Z)(this,"fontOptions",void 0),(0,pt.Z)(this,"key",void 0),(0,pt.Z)(this,"cache",new R.z6(de))}get scale(){return me}get canvas(){const lt=this.cache.get(this.key);return lt&&lt.data}get mapping(){const lt=this.cache.get(this.key);return lt&&lt.mapping||{}}getCanvasByKey(lt){const It=this.cache.get(lt);return It&&It.data}getMappingByKey(lt){const It=this.cache.get(lt);return It&&It.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:Ce,fontWeight:xn,characterSet:Kt,fontSize:Cn,buffer:Zn,sdf:!0,cutoff:Qt,radius:ct,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(lt){lt.forEach(It=>{this.iconFontGlyphs[It.name]=It.unicode})}addIconFont(lt,It){this.iconFontMap.set(lt,It)}getIconFontKey(lt){return this.iconFontMap.get(lt)||lt}getGlyph(lt){return this.iconFontGlyphs[lt]?String.fromCharCode(parseInt(this.iconFontGlyphs[lt],16)):""}setFontOptions(lt){this.fontOptions=(0,ne.Z)((0,ne.Z)({},this.fontOptions),lt),this.key=this.getKey();const It=this.getNewChars(this.key,this.fontOptions.characterSet),Ke=this.cache.get(this.key);if(Ke&&It.length===0)return;const X=this.generateFontAtlas(this.key,It,Ke);this.fontAtlas=X,this.cache.set(this.key,X)}addFontFace(lt,It){const Ke=document.createElement("style");Ke.type="text/css",Ke.innerText=`
        @font-face{
            font-family: '${lt}';
            src: url('${It}') format('woff2'),
            url('${It}') format('woff'),
            url('${It}') format('truetype');
        }`,Ke.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${lt}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:lt})})}catch(X){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(X)}},document.getElementsByTagName("head")[0].appendChild(Ke)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(lt,It,Ke){const{fontFamily:X,fontWeight:Xn,fontSize:Mr,buffer:ki,sdf:Jr,radius:co,cutoff:so,iconfont:sa}=this.fontOptions;let Po=Ke&&Ke.data;Po||(Po=window.document.createElement("canvas"),Po.width=bt);const _a=Po.getContext("2d",{willReadFrequently:!0});Sr(_a,X,Mr,Xn);const{mapping:qa,canvasHeight:ra,xOffset:ma,yOffset:ls}=Mn((0,ne.Z)({getFontWidth:Ia=>_a.measureText(Ia).width,fontHeight:Mr*me,buffer:ki,characterSet:It,maxCanvasWidth:bt},Ke&&{mapping:Ke.mapping,xOffset:Ke.xOffset,yOffset:Ke.yOffset})),Aa=_a.getImageData(0,0,Po.width,Po.height);if(Po.height=ra,_a.putImageData(Aa,0,0),Sr(_a,X,Mr,Xn),Jr){const Ia=new(ot())(Mr,ki,co,so,X,Xn),ka=_a.getImageData(0,0,Ia.size,Ia.size);for(const qs of It){if(sa){const ks=String.fromCharCode(parseInt(qs.replace("&#x","").replace(";",""),16)),Ec=Ia.draw(ks);Gn(Ec,ka)}else Gn(Ia.draw(qs),ka);_a.putImageData(ka,qa[qs].x,qa[qs].y)}}else for(const Ia of It)_a.fillText(Ia,qa[Ia].x,qa[Ia].y+Mr*zt);return{xOffset:ma,yOffset:ls,mapping:qa,data:Po,width:Po.width,height:Po.height}}getKey(){const{fontFamily:lt,fontWeight:It}=this.fontOptions;return`${lt}_${It}`}getNewChars(lt,It){const Ke=this.cache.get(lt);if(!Ke)return It;const X=[],Xn=Ke.mapping,Mr=new Set(Object.keys(Xn));return new Set(It).forEach(Jr=>{Mr.has(Jr)||X.push(Jr)}),X}}var ut=it(15861);const wt=3,Gt=1024,ue=64;class Ge extends ze.EventEmitter{constructor(...lt){super(...lt),(0,pt.Z)(this,"canvasHeight",128),(0,pt.Z)(this,"texture",void 0),(0,pt.Z)(this,"canvas",void 0),(0,pt.Z)(this,"iconData",void 0),(0,pt.Z)(this,"iconMap",void 0),(0,pt.Z)(this,"ctx",void 0),(0,pt.Z)(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(lt,It){var Ke=this;return(0,ut.Z)(function*(){let X=new Image;Ke.loadingImageCount++,Ke.hasImage(lt)?console.warn("Image Id already exists"):Ke.iconData.push({id:lt,size:ue}),Ke.updateIconMap(),X=yield Ke.loadImage(It);const Xn=Ke.iconData.find(Mr=>Mr.id===lt);Xn&&(Xn.image=X,Xn.width=X.width,Xn.height=X.height),Ke.update()})()}addImageMini(lt,It,Ke){const X=Ke.getSceneConfig().canvas;let Xn=X.createImage();if(this.loadingImageCount++,this.hasImage(lt))throw new Error("Image Id already exists");this.iconData.push({id:lt,size:ue}),this.updateIconMap(),this.loadImageMini(It,X).then(Mr=>{Xn=Mr;const ki=this.iconData.find(Jr=>Jr.id===lt);ki&&(ki.image=Xn,ki.width=Xn.width,ki.height=Xn.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(lt){return this.iconMap.hasOwnProperty(lt)}removeImage(lt){this.hasImage(lt)&&(this.iconData=this.iconData.filter(It=>It.id!==lt),delete this.iconMap[lt],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(lt){return new Promise((It,Ke)=>{if(lt instanceof HTMLImageElement){It(lt);return}const X=new Image;X.crossOrigin="anonymous",X.onload=()=>{It(X)},X.onerror=()=>{Ke(new Error("Could not load image at "+lt))},X.src=lt instanceof File?URL.createObjectURL(lt):lt})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=Gt,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(lt=>{const{x:It,y:Ke,image:X,width:Xn=64,height:Mr=64}=this.iconMap[lt],Jr=Math.max(Xn,Mr)/ue,co=Mr/Jr,so=Xn/Jr;X&&this.ctx.drawImage(X,It+(ue-so)/2,Ke+(ue-co)/2,so,co)})}updateIconMap(){const{mapping:lt,canvasHeight:It}=zn(this.iconData,wt,Gt);this.iconMap=lt,this.canvasHeight=It}loadImageMini(lt,It){return new Promise((Ke,X)=>{const Xn=It.createImage();Xn.crossOrigin="anonymous",Xn.onload=()=>{Ke(Xn)},Xn.onerror=()=>{X(new Error("Could not load image at "+lt))},Xn.src=lt})}}var ln=it(85975);class ee{constructor(){(0,pt.Z)(this,"viewport",void 0),(0,pt.Z)(this,"overridedViewProjectionMatrix",void 0),(0,pt.Z)(this,"viewMatrixInverse",void 0),(0,pt.Z)(this,"cameraPosition",void 0)}init(){}update(lt){this.viewport=lt,this.viewMatrixInverse=ln.create(),ln.invert(this.viewMatrixInverse,lt.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[lt,It]=this.viewport.getCenter();return[lt,It]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(lt,It){return this.viewport.projectFlat(lt,It)}setViewProjectionMatrix(lt){this.overridedViewProjectionMatrix=lt}}const Fe={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class Hn{constructor(){(0,pt.Z)(this,"container",void 0),(0,pt.Z)(this,"controlCorners",void 0),(0,pt.Z)(this,"controlContainer",void 0),(0,pt.Z)(this,"scene",void 0),(0,pt.Z)(this,"mapsService",void 0),(0,pt.Z)(this,"controls",[]),(0,pt.Z)(this,"unAddControls",[])}init(lt,It){this.container=lt.container,this.scene=It,this.mapsService=It.mapService,this.initControlPos()}addControl(lt,It){It.mapService.map?(lt.addTo(this.scene),this.controls.push(lt)):this.unAddControls.push(lt)}getControlByName(lt){return this.controls.find(It=>It.controlOption.name===lt)}removeControl(lt){const It=this.controls.indexOf(lt);return It>-1&&this.controls.splice(It,1),lt.remove(),this}addControls(){this.unAddControls.forEach(lt=>{lt.addTo(this.scene),this.controls.push(lt)}),this.unAddControls=[]}destroy(){for(const lt of this.controls)lt.remove();this.controls=[],this.clearControlPos()}initControlPos(){const lt=this.controlCorners={},It="l7-",Ke=this.controlContainer=R.SO.create("div",It+"control-container",this.container);function X(Mr=[]){const ki=Mr.map(Jr=>It+Jr).join(" ");lt[Mr.filter(Jr=>!["row","column"].includes(Jr)).join("")]=R.SO.create("div",ki,Ke)}function Xn(Mr){return[...Mr.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),Fe[Mr]]}Object.values(Er).forEach(Mr=>{X(Xn(Mr))}),this.checkCornerOverlap()}clearControlPos(){for(const lt in this.controlCorners)this.controlCorners[lt]&&R.SO.remove(this.controlCorners[lt]);this.controlContainer&&R.SO.remove(this.controlContainer)}checkCornerOverlap(){const lt=window.MutationObserver;if(lt)for(const It of Object.keys(this.controlCorners)){const Ke=It.match(/^(top|bottom)(left|right)$/);if(Ke){const[,X,Xn]=Ke,Mr=this.controlCorners[`${X}${Xn}`];new lt(([{target:Jr}])=>{Mr&&(Mr.style[X]=Jr.clientHeight+"px")}).observe(this.controlCorners[`${Xn}${X}`],{childList:!0,attributes:!0})}}}}class Tr{constructor(){(0,pt.Z)(this,"container",void 0),(0,pt.Z)(this,"scene",void 0),(0,pt.Z)(this,"mapsService",void 0),(0,pt.Z)(this,"markers",[]),(0,pt.Z)(this,"markerLayers",[]),(0,pt.Z)(this,"unAddMarkers",[]),(0,pt.Z)(this,"unAddMarkerLayers",[])}addMarkerLayer(lt){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(lt),lt.addTo(this.scene)):this.unAddMarkerLayers.push(lt)}removeMarkerLayer(lt){lt.destroy(),this.markerLayers.indexOf(lt);const It=this.markerLayers.indexOf(lt);It>-1&&this.markerLayers.splice(It,1)}addMarker(lt){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(lt),lt.addTo(this.scene)):this.unAddMarkers.push(lt)}addMarkers(){this.unAddMarkers.forEach(lt=>{lt.addTo(this.scene),this.markers.push(lt)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(lt=>{this.markerLayers.push(lt),lt.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(lt){lt.remove(),this.markers.indexOf(lt);const It=this.markers.indexOf(lt);It>-1&&this.markers.splice(It,1)}removeAllMarkers(){this.destroy()}init(lt){this.scene=lt,this.mapsService=lt.mapService}destroy(){this.markers.forEach(lt=>{lt.remove()}),this.markers=[],this.markerLayers.forEach(lt=>{lt.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(lt){lt.destroy()}}class Zr{constructor(){(0,pt.Z)(this,"scene",void 0),(0,pt.Z)(this,"mapsService",void 0),(0,pt.Z)(this,"popups",[]),(0,pt.Z)(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(lt){lt!=null&&lt.isOpen()&&lt.remove();const It=this.popups.indexOf(lt);It>-1&&this.popups.splice(It,1);const Ke=this.unAddPopups.indexOf(lt);Ke>-1&&this.unAddPopups.splice(Ke,1)}destroy(){this.popups.forEach(lt=>lt.remove())}addPopup(lt){lt&&lt.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(It=>{It.getOptions().autoClose&&this.removePopup(It)}),this.isMarkerReady?(lt.addTo(this.scene),this.popups.push(lt)):this.unAddPopups.push(lt),lt.on("close",()=>{this.removePopup(lt)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(lt=>{this.addPopup(lt),this.unAddPopups=[]})}init(lt){this.scene=lt,this.mapsService=lt.mapService}}var Ur={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:jr}=R.lodashUtil,ni={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Ar={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Be.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class pi{constructor(){(0,pt.Z)(this,"sceneConfigCache",{}),(0,pt.Z)(this,"layerConfigCache",{}),(0,pt.Z)(this,"layerAttributeConfigCache",{})}getSceneConfig(lt){return this.sceneConfigCache[lt]}getSceneWarninfo(lt){return Ur[lt]}setSceneConfig(lt,It){this.sceneConfigCache[lt]=(0,ne.Z)((0,ne.Z)({},ni),It)}getLayerConfig(lt){return this.layerConfigCache[lt]}setLayerConfig(lt,It,Ke){this.layerConfigCache[It]=(0,ne.Z)({},jr({},this.sceneConfigCache[lt],Ar,Ke))}getAttributeConfig(lt){return this.layerAttributeConfigCache[lt]}setAttributeConfig(lt,It){this.layerAttributeConfigCache[lt]=(0,ne.Z)((0,ne.Z)({},this.layerAttributeConfigCache[lt]),It)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var mi=it(98333);const xi=Math.PI/180,wo=512,Li=4003e4;function aa({latitude:K=0,zoom:lt=0,scale:It,highPrecision:Ke=!1,flipY:X=!1}){It=It!==void 0?It:Math.pow(2,lt);const Xn={},Mr=wo*It,ki=Math.cos(K*xi),Jr=Mr/360,co=Jr/ki,so=Mr/Li/ki;if(Xn.pixelsPerMeter=[so,-so,so],Xn.metersPerPixel=[1/so,-1/so,1/so],Xn.pixelsPerDegree=[Jr,-co,so],Xn.degreesPerPixel=[1/Jr,-1/co,1/so],Ke){const sa=xi*Math.tan(K*xi)/ki,Po=Jr*sa/2,_a=Mr/Li*sa,qa=_a/co*so;Xn.pixelsPerDegree2=[0,-Po,_a],Xn.pixelsPerMeter2=[qa,0,qa],X&&(Xn.pixelsPerDegree2[1]=-Xn.pixelsPerDegree2[1],Xn.pixelsPerMeter2[1]=-Xn.pixelsPerMeter2[1])}return X&&(Xn.pixelsPerMeter[1]=-Xn.pixelsPerMeter[1],Xn.metersPerPixel[1]=-Xn.metersPerPixel[1],Xn.pixelsPerDegree[1]=-Xn.pixelsPerDegree[1],Xn.degreesPerPixel[1]=-Xn.degreesPerPixel[1]),Xn}const Pa=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class Lo{constructor(lt){(0,pt.Z)(this,"needRefresh",!0),(0,pt.Z)(this,"coordinateSystem",void 0),(0,pt.Z)(this,"viewportCenter",void 0),(0,pt.Z)(this,"viewportCenterProjection",void 0),(0,pt.Z)(this,"pixelsPerDegree",void 0),(0,pt.Z)(this,"pixelsPerDegree2",void 0),(0,pt.Z)(this,"pixelsPerMeter",void 0),this.cameraService=lt}refresh(lt){const It=this.cameraService.getZoom(),Ke=lt||this.cameraService.getCenter(),{pixelsPerMeter:X,pixelsPerDegree:Xn}=aa({latitude:Ke[1],zoom:It});this.viewportCenter=Ke,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=X,this.pixelsPerDegree=Xn,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Ue.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Ue.LNGLAT_OFFSET&&this.calculateLnglatOffset(Ke,It),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(lt){this.coordinateSystem=lt}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(lt,It,Ke,X){const{pixelsPerMeter:Xn,pixelsPerDegree:Mr,pixelsPerDegree2:ki}=aa({latitude:lt[1],zoom:It,scale:Ke,flipY:X,highPrecision:!0});let Jr=this.cameraService.getViewMatrix();const co=this.cameraService.getProjectionMatrix();let so=ln.multiply([],co,Jr);const sa=this.cameraService.projectFlat([Math.fround(lt[0]),Math.fround(lt[1])],Math.pow(2,It));this.viewportCenterProjection=mi.fF([],[sa[0],sa[1],0,1],so),Jr=this.cameraService.getViewMatrixUncentered()||Jr,so=ln.multiply([],co,Jr),so=ln.multiply([],so,Pa),this.cameraService.setViewProjectionMatrix(so),this.pixelsPerMeter=Xn,this.pixelsPerDegree=Mr,this.pixelsPerDegree2=ki}}class $o extends ze.EventEmitter{constructor(...lt){super(...lt),(0,pt.Z)(this,"renderMap",new Map),(0,pt.Z)(this,"enable",!1),(0,pt.Z)(this,"renderEnable",!1),(0,pt.Z)(this,"cacheLogs",{})}setEnable(lt){this.enable=!!lt}log(lt,It){if(!this.enable)return;const Ke=lt.split(".");let X=null;Ke.forEach((Xn,Mr)=>{X!==null?(X[Xn]||(X[Xn]={}),Mr!==Ke.length-1&&(X=X[Xn])):(this.cacheLogs[Xn]||(this.cacheLogs[Xn]={}),Mr!==Ke.length-1&&(X=this.cacheLogs[Xn])),Mr===Ke.length-1&&(X[Xn]=(0,ne.Z)((0,ne.Z)({time:Date.now()},X[Xn]),It))})}getLog(lt){switch(typeof lt){case"string":return this.cacheLogs[lt];case"object":return lt.map(It=>this.cacheLogs[It]).filter(It=>It!==void 0);case"undefined":return this.cacheLogs}}removeLog(lt){delete this.cacheLogs[lt]}generateRenderUid(){return this.renderEnable?(0,R.M8)():""}renderDebug(lt){this.renderEnable=lt}renderStart(lt){if(!this.renderEnable||!this.enable)return;const It=this.renderMap.get(lt)||{};this.renderMap.set(lt,(0,ne.Z)((0,ne.Z)({},It),{},{renderUid:lt,renderStart:Date.now()}))}renderEnd(lt){if(!this.renderEnable||!this.enable)return;const It=this.renderMap.get(lt);if(It){const Ke=It.renderStart,X=Date.now();this.emit("renderEnd",(0,ne.Z)((0,ne.Z)({},It),{},{renderEnd:X,renderDuration:X-Ke})),this.renderMap.delete(lt)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var Mt=it(50840),Wt=it.n(Mt);const Se={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class qe extends Vt(){get mapService(){return this.container.mapService}constructor(lt){super(),(0,pt.Z)(this,"indragging",!1),(0,pt.Z)(this,"hammertime",void 0),(0,pt.Z)(this,"lastClickTime",0),(0,pt.Z)(this,"lastClickXY",[-1,-1]),(0,pt.Z)(this,"clickTimer",void 0),(0,pt.Z)(this,"$containter",void 0),(0,pt.Z)(this,"onDrag",It=>{const Ke=this.interactionEvent(It);Ke.type=Se[Ke.type],Ke.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(ir.Drag,Ke)}),(0,pt.Z)(this,"onHammer",It=>{It.srcEvent.stopPropagation();const Ke=this.interactionEvent(It);this.emit(ir.Hover,Ke)}),(0,pt.Z)(this,"onTouch",It=>{const Ke=It.touches[0];this.onHover({clientX:Ke.clientX,clientY:Ke.clientY,type:"touchstart"})}),(0,pt.Z)(this,"onTouchEnd",It=>{if(It.changedTouches.length>0){const Ke=It.changedTouches[0];this.onHover({clientX:Ke.clientX,clientY:Ke.clientY,type:"touchend"})}}),(0,pt.Z)(this,"onTouchMove",It=>{const Ke=It.changedTouches[0];this.onHover({clientX:Ke.clientX,clientY:Ke.clientY,type:"touchmove"})}),(0,pt.Z)(this,"onHover",It=>{const{clientX:Ke,clientY:X}=It;let Xn=Ke,Mr=X;const ki=It.type,Jr=this.mapService.getMapContainer();if(Jr){const{top:so,left:sa}=Jr.getBoundingClientRect();Xn=Xn-sa-Jr.clientLeft,Mr=Mr-so-Jr.clientTop}const co=this.mapService.containerToLngLat([Xn,Mr]);if(ki==="click"){this.isDoubleTap(Xn,Mr,co);return}if(ki==="touch"){this.isDoubleTap(Xn,Mr,co);return}ki!=="click"&&ki!=="dblclick"&&this.emit(ir.Hover,{x:Xn,y:Mr,lngLat:co,type:ki,target:It})}),this.container=lt}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ir.Hover)}triggerHover({x:lt,y:It}){this.emit(ir.Hover,{x:lt,y:It})}triggerSelect(lt){this.emit(ir.Select,{featureId:lt})}triggerActive(lt){this.emit(ir.Active,{featureId:lt})}addEventListenerOnMap(){const lt=this.mapService.getMapContainer();if(lt){const It=new(Wt()).Manager(lt);It.add(new(Wt()).Tap({event:"dblclick",taps:2})),It.add(new(Wt()).Tap({event:"click"})),It.add(new(Wt()).Pan({threshold:0,pointers:0})),It.add(new(Wt()).Press({})),It.on("dblclick click",this.onHammer),It.on("panstart panmove panend pancancel",this.onDrag),lt.addEventListener("touchstart",this.onTouch),lt.addEventListener("touchend",this.onTouchEnd),lt.addEventListener("mousemove",this.onHover),lt.addEventListener("touchmove",this.onTouchMove),lt.addEventListener("mousedown",this.onHover,!0),lt.addEventListener("mouseup",this.onHover),lt.addEventListener("contextmenu",this.onHover),this.hammertime=It}}removeEventListenerOnMap(){const lt=this.mapService.getMapContainer();lt&&(lt.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),lt.removeEventListener("touchstart",this.onTouch),lt.removeEventListener("touchend",this.onTouchEnd),lt.removeEventListener("mousedown",this.onHover),lt.removeEventListener("mouseup",this.onHover),lt.removeEventListener("contextmenu",this.onHover))}interactionEvent(lt){const{type:It,pointerType:Ke}=lt;let X,Xn;Ke==="touch"?(Xn=Math.floor(lt.pointers[0].clientY),X=Math.floor(lt.pointers[0].clientX)):(Xn=Math.floor(lt.srcEvent.y),X=Math.floor(lt.srcEvent.x));const Mr=this.mapService.getMapContainer();if(Mr){const{top:Jr,left:co}=Mr.getBoundingClientRect();X-=co,Xn-=Jr}const ki=this.mapService.containerToLngLat([X,Xn]);return{x:X,y:Xn,lngLat:ki,type:It,target:lt.srcEvent}}isDoubleTap(lt,It,Ke){const X=new Date().getTime();let Xn="click";X-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-lt)<10&&Math.abs(this.lastClickXY[1]-It)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Xn="dblclick",this.emit(ir.Hover,{x:lt,y:It,lngLat:Ke,type:Xn})):(this.lastClickTime=X,this.lastClickXY=[lt,It],this.clickTimer=setTimeout(()=>{Xn="click",this.emit(ir.Hover,{x:lt,y:It,lngLat:Ke,type:Xn})},400))}}let Rn=0;function Pn(K){let lt=K;if(typeof K=="string"&&(lt=document.getElementById(K)),lt){const It=document.createElement("div");return It.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,It.id=`l7-scene-${Rn++}`,It.classList.add("l7-scene"),lt.appendChild(It),It}return null}function tn(K){var lt;let It=!0;if((K==null||(lt=K.target)===null||lt===void 0?void 0:lt.target)instanceof HTMLElement){var Ke;let Xn=K==null||(Ke=K.target)===null||Ke===void 0?void 0:Ke.target;for(;Xn;){var X;const Mr=Array.from(Xn.classList);if(Mr.includes("l7-marker")||Mr.includes("l7-popup")){It=!1;break}Xn=(X=Xn)===null||X===void 0?void 0:X.parentElement}}return It}let mn=function(K){return K[K.SAMPLED=0]="SAMPLED",K[K.RENDER_TARGET=1]="RENDER_TARGET",K}({});class dr{constructor(lt){var It=this;(0,pt.Z)(this,"pickedColors",void 0),(0,pt.Z)(this,"pickedTileLayers",[]),(0,pt.Z)(this,"pickingFBO",void 0),(0,pt.Z)(this,"width",0),(0,pt.Z)(this,"height",0),(0,pt.Z)(this,"alreadyInPicking",!1),(0,pt.Z)(this,"pickBufferScale",1),(0,pt.Z)(this,"pickFromPickingFBO",function(){var Ke=(0,ut.Z)(function*(X,{x:Xn,y:Mr,lngLat:ki,type:Jr,target:co}){var so;let sa=!1;const{readPixels:Po,readPixelsAsync:_a,getViewportSize:qa,queryVerdorInfo:ra}=It.rendererService,{width:ma,height:ls}=qa(),{enableHighlight:Aa,enableSelect:Ia}=X.getLayerConfig(),ka=Xn*R.SO.DPR,qs=Mr*R.SO.DPR;if(ka>ma-1*R.SO.DPR||ka<0||qs>ls-1*R.SO.DPR||qs<0)return!1;let ks;if(ra()==="WebGPU"?ks=yield _a({x:Math.floor(ka/It.pickBufferScale),y:Math.floor((ls-(Mr+1)*R.SO.DPR)/It.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:It.pickingFBO}):ks=Po({x:Math.floor(ka/It.pickBufferScale),y:Math.floor((ls-(Mr+1)*R.SO.DPR)/It.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:It.pickingFBO}),It.pickedColors=ks,ks[0]!==0||ks[1]!==0||ks[2]!==0){const es=(0,R.W0)(ks),Iu=X.layerPickService.getFeatureById(es);es!==X.getCurrentPickId()&&Jr==="mousemove"&&(Jr="mouseenter");const du={x:Xn,y:Mr,type:Jr,lngLat:ki,featureId:es,feature:Iu,target:co};Iu&&(sa=!0,X.setCurrentPickId(es),It.triggerHoverOnLayer(X,du))}else{const es={x:Xn,y:Mr,lngLat:ki,type:X.getCurrentPickId()!==null&&Jr==="mousemove"?"mouseout":"un"+Jr,featureId:null,target:co,feature:null};It.triggerHoverOnLayer(X,(0,ne.Z)((0,ne.Z)({},es),{},{type:"unpick"})),It.triggerHoverOnLayer(X,es),X.setCurrentPickId(null)}if(Aa&&X.layerPickService.highlightPickedFeature(ks),Ia&&Jr==="click"&&((so=ks)===null||so===void 0?void 0:so.toString())!==[0,0,0,0].toString()){const es=(0,R.W0)(ks);X.getCurrentSelectedId()===null||es!==X.getCurrentSelectedId()?(X.layerPickService.selectFeature(ks),X.setCurrentSelectedId(es)):(X.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),X.setCurrentSelectedId(null))}return sa});return function(X,Xn){return Ke.apply(this,arguments)}}()),this.container=lt}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(lt){const{createTexture2D:It,createFramebuffer:Ke,getViewportSize:X}=this.rendererService;let{width:Xn,height:Mr}=X();this.pickBufferScale=this.configService.getSceneConfig(lt).pickBufferScale||1,Xn=Math.round(Xn/this.pickBufferScale),Mr=Math.round(Mr/this.pickBufferScale);const ki=It({width:Xn,height:Mr,usage:mn.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=Ke({color:ki,depth:!0,width:Xn,height:Mr}),this.interactionService.on(ir.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(lt,It,Ke){var X=this;return(0,ut.Z)(function*(){const{useFramebufferAsync:Xn,clear:Mr}=X.rendererService;X.resizePickingFBO(),lt.hooks.beforePickingEncode.call(),yield Xn(X.pickingFBO,(0,ut.Z)(function*(){Mr({framebuffer:X.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),lt.renderModels({ispick:!0})})),lt.hooks.afterPickingEncode.call();const ki=yield X.pickBox(lt,It);Ke(ki)})()}pickBox(lt,It){var Ke=this;return(0,ut.Z)(function*(){const[X,Xn,Mr,ki]=It.map(ls=>{const Aa=ls<0?0:ls;return Math.floor(Aa*R.SO.DPR/Ke.pickBufferScale)}),{readPixelsAsync:Jr,getViewportSize:co}=Ke.rendererService,{width:so,height:sa}=co();if(X>(so-1)*R.SO.DPR/Ke.pickBufferScale||Mr<0||Xn>(sa-1)*R.SO.DPR/Ke.pickBufferScale||ki<0)return[];const Po=Math.min(so/Ke.pickBufferScale,Mr)-X,_a=Math.min(sa/Ke.pickBufferScale,ki)-Xn,qa=yield Jr({x:X,y:Math.floor(sa/Ke.pickBufferScale-(ki+1)),width:Po,height:_a,data:new Uint8Array(Po*_a*4),framebuffer:Ke.pickingFBO}),ra=[],ma={};for(let ls=0;ls<qa.length/4;ls=ls+1){const Aa=qa.slice(ls*4,ls*4+4),Ia=(0,R.W0)(Aa);if(Ia!==-1&&!ma[Ia]){const ka=lt.layerPickService.getFeatureById(Ia);ra.push((0,ne.Z)((0,ne.Z)({},ka),{},{pickedFeatureIdx:Ia})),ma[Ia]=!0}}return ra})()}handleCursor(lt,It){const{cursor:Ke="",cursorEnabled:X}=lt.getLayerConfig();if(X){const Mr=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),ki=Mr==null?void 0:Mr.style.getPropertyValue("cursor");It==="unmousemove"&&ki!==""?Mr==null||Mr.style.setProperty("cursor",""):It==="mousemove"&&(Mr==null||Mr.style.setProperty("cursor",Ke))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(lt){var It=this;return(0,ut.Z)(function*(){!It.layerService.needPick(lt.type)||!It.isPickingAllLayer()||(It.alreadyInPicking=!0,yield It.pickingLayers(lt),It.layerService.renderLayers(),It.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:lt}=this.rendererService,{width:It,height:Ke}=lt();(this.width!==It||this.height!==Ke)&&(this.pickingFBO.resize({width:Math.round(It/this.pickBufferScale),height:Math.round(Ke/this.pickBufferScale)}),this.width=It,this.height=Ke)}pickingLayers(lt){var It=this;return(0,ut.Z)(function*(){const{clear:Ke,useFramebufferAsync:X}=It.rendererService;It.resizePickingFBO();const Xn=It.layerService.getRenderList();for(const Mr of Xn.filter(ki=>ki.needPick(lt.type)).reverse()){yield X(It.pickingFBO,(0,ut.Z)(function*(){Ke({framebuffer:It.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Mr.layerPickService.pickRender(lt)}));const ki=yield It.pickFromPickingFBO(Mr,lt);if(It.layerService.pickedLayerId=ki?+Mr.id:-1,ki&&!Mr.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(lt,It){tn(It)&&(this.handleCursor(lt,It.type),lt.emit(It.type,It))}}class fr{constructor(lt=!0){(0,pt.Z)(this,"autoStart",void 0),(0,pt.Z)(this,"startTime",0),(0,pt.Z)(this,"oldTime",0),(0,pt.Z)(this,"running",!1),(0,pt.Z)(this,"elapsedTime",0),this.autoStart=lt}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let lt=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const It=(typeof performance=="undefined"?Date:performance).now();lt=(It-this.oldTime)/1e3,this.oldTime=It,this.elapsedTime+=lt}return lt}}const{throttle:ai}=R.lodashUtil;class Vi extends ze.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(lt){super(),(0,pt.Z)(this,"pickedLayerId",-1),(0,pt.Z)(this,"clock",new fr),(0,pt.Z)(this,"alreadyInRendering",!1),(0,pt.Z)(this,"layers",[]),(0,pt.Z)(this,"layerList",[]),(0,pt.Z)(this,"layerRenderID",void 0),(0,pt.Z)(this,"sceneInited",!1),(0,pt.Z)(this,"animateInstanceCount",0),(0,pt.Z)(this,"shaderPicking",!0),(0,pt.Z)(this,"enableRender",!0),(0,pt.Z)(this,"reRender",ai(()=>{this.renderLayers()},32)),(0,pt.Z)(this,"throttleRenderLayers",ai(()=>{this.renderLayers()},16)),this.container=lt}needPick(lt){return this.updateLayerRenderList(),this.layerList.some(It=>It.needPick(lt))}add(lt){this.layers.push(lt),this.sceneInited&&lt.init().then(()=>{this.renderLayers()})}addMask(lt){this.sceneInited&&lt.init().then(()=>{this.renderLayers()})}initLayers(){var lt=this;return(0,ut.Z)(function*(){lt.sceneInited=!0,lt.layers.forEach(function(){var It=(0,ut.Z)(function*(Ke){Ke.startInit||(yield Ke.init(),lt.updateLayerRenderList())});return function(Ke){return It.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(lt){return this.layers.find(It=>It.id===lt)}getLayerByName(lt){return this.layers.find(It=>It.name===lt)}remove(lt,It){var Ke=this;return(0,ut.Z)(function*(){It?It.layerChildren=It.layerChildren.filter(X=>X!==lt):Ke.layers=Ke.layers.filter(X=>X!==lt),lt.destroy(),Ke.reRender(),Ke.emit("layerChange",Ke.layers)})()}removeAllLayers(){var lt=this;return(0,ut.Z)(function*(){lt.destroy(),lt.reRender()})()}setEnableRender(lt){this.enableRender=lt}renderLayers(){var lt=this;return(0,ut.Z)(function*(){if(lt.alreadyInRendering||!lt.enableRender)return;lt.updateLayerRenderList();const It=lt.debugService.generateRenderUid();lt.debugService.renderStart(It),lt.alreadyInRendering=!0,lt.clear();for(const Ke of lt.layerList)Ke.prerender();lt.renderService.beginFrame();for(const Ke of lt.layerList){const{enableMask:X}=Ke.getLayerConfig();Ke.masks.filter(Xn=>Xn.inited).length>0&&X&&lt.renderMask(Ke.masks),Ke.getLayerConfig().enableMultiPassRenderer?yield Ke.renderMultiPass():Ke.render()}lt.renderService.endFrame(),lt.debugService.renderEnd(It),lt.alreadyInRendering=!1})()}renderMask(lt){let It=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const Ke=lt.length>1?De.MULTIPLE:De.SINGLE;for(const X of lt)X.render({isStencil:!0,stencilType:Ke,stencilIndex:It++})}beforeRenderData(lt){var It=this;return(0,ut.Z)(function*(){(yield lt.hooks.beforeRenderData.promise())&&It.renderLayers()})()}renderTileLayerMask(lt){let It=0;const{enableMask:Ke=!0}=lt.getLayerConfig();let X=lt.tileMask?1:0;const Xn=lt.masks.filter(ki=>ki.inited);X=X+(Ke?Xn.length:1);const Mr=X>1?De.MULTIPLE:De.SINGLE;if((lt.tileMask||Xn.length&&Ke)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),Xn.length&&Ke)for(const ki of Xn)ki.render({isStencil:!0,stencilType:Mr,stencilIndex:It++});lt.tileMask&&lt.tileMask.render({isStencil:!0,stencilType:Mr,stencilIndex:It++,stencilOperation:Be.OR})}renderTileLayer(lt){var It=this;return(0,ut.Z)(function*(){It.renderTileLayerMask(lt),lt.getLayerConfig().enableMultiPassRenderer?yield lt.renderMultiPass():yield lt.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(lt=>lt.inited).filter(lt=>lt.isVisible()).sort((lt,It)=>lt.zIndex-It.zIndex).forEach(lt=>{this.layerList.push(lt)})}destroy(){this.layers.forEach(lt=>{lt.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const lt=(0,R.CI)(this.mapService.bgColor);this.renderService.clear({color:lt,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var mo=it(45987);const{isNil:si}=R.lodashUtil;class Wi{constructor(lt){(0,pt.Z)(this,"name",void 0),(0,pt.Z)(this,"type",void 0),(0,pt.Z)(this,"scale",void 0),(0,pt.Z)(this,"descriptor",void 0),(0,pt.Z)(this,"featureBufferLayout",[]),(0,pt.Z)(this,"needRescale",!1),(0,pt.Z)(this,"needRemapping",!1),(0,pt.Z)(this,"needRegenerateVertices",!1),(0,pt.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,pt.Z)(this,"vertexAttribute",void 0),(0,pt.Z)(this,"defaultCallback",It=>{if(It.length===0){var Ke;return((Ke=this.scale)===null||Ke===void 0?void 0:Ke.defaultValues)||[]}return It.map((X,Xn)=>{var Mr;return((Mr=this.scale)===null||Mr===void 0?void 0:Mr.scalers[Xn].func)(X)})}),this.setProps(lt)}setProps(lt){Object.assign(this,lt)}mapping(lt){var It;if((It=this.scale)!==null&&It!==void 0&&It.callback){var Ke;const X=(Ke=this.scale)===null||Ke===void 0?void 0:Ke.callback(...lt);if(!si(X))return[X]}return this.defaultCallback(lt)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const Ui=["buffer","update","name"],Xr=["buffer","update","name"],bo={[yt.FLOAT]:4,[yt.UNSIGNED_BYTE]:1,[yt.UNSIGNED_SHORT]:2};class Ni{constructor(lt){(0,pt.Z)(this,"attributesAndIndices",void 0),(0,pt.Z)(this,"attributes",[]),(0,pt.Z)(this,"triangulation",void 0),(0,pt.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=lt}registerStyleAttribute(lt){let It=this.getLayerStyleAttribute(lt.name||"");return It?It.setProps(lt):(It=new Wi(lt),this.attributes.push(It)),It}unRegisterStyleAttribute(lt){const It=this.attributes.findIndex(Ke=>Ke.name===lt);It>-1&&this.attributes.splice(It,1)}updateScaleAttribute(lt){this.attributes.forEach(It=>{var Ke;const X=It.name,Xn=(Ke=It.scale)===null||Ke===void 0?void 0:Ke.field;(lt[X]||Xn&&lt[Xn])&&(It.needRescale=!0,It.needRemapping=!0,It.needRegenerateVertices=!0)})}updateStyleAttribute(lt,It,Ke){let X=this.getLayerStyleAttribute(lt);X||(X=this.registerStyleAttribute((0,ne.Z)((0,ne.Z)({},It),{},{name:lt})));const{scale:Xn}=It;Xn&&X&&(X.scale=Xn,X.needRescale=!0,X.needRemapping=!0,X.needRegenerateVertices=!0,Ke&&Ke.featureRange&&(X.featureRange=Ke.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(lt){return this.attributes.find(It=>It.name===lt)}getLayerAttributeScale(lt){var It;const Ke=this.getLayerStyleAttribute(lt),X=Ke==null||(It=Ke.scale)===null||It===void 0?void 0:It.scalers;return X&&X[0]?X[0].func:null}updateAttributeByFeatureRange(lt,It,Ke=0,X,Xn){const Mr=this.attributes.find(ki=>ki.name===lt);if(Mr&&Mr.descriptor){const{descriptor:ki}=Mr,{update:Jr,buffer:co,size:so=0}=ki,sa=bo[co.type||yt.FLOAT];if(Jr){const{elements:Po,sizePerElement:_a}=this.featureLayout,qa=Po.slice(Ke,X);if(!qa.length)return;const{offset:ra}=qa[0],ma=ra*so*sa,ls=qa.map(({featureIdx:Aa,vertices:Ia,normals:ka},qs)=>{const ks=Ia.length/_a,Ec=[];for(let es=0;es<ks;es++){const Iu=ka?ka.slice(es*3,es*3+3):[];Ec.push(...Jr(It[Aa],Aa,Ia.slice(es*_a,es*_a+_a),qs,Iu))}return Ec}).flat();Mr.vertexAttribute.updateBuffer({data:ls,offset:ma}),Xn==null||Xn.emit(`legend:${lt}`,Xn.getLegend(lt))}}}createAttributesAndIndices(lt,It,Ke,X){this.featureLayout={sizePerElement:0,elements:[]},It&&(this.triangulation=It);const Xn=this.attributes.map(ra=>(ra.resetDescriptor(),ra.descriptor));let Mr=0,ki=0;const Jr=[];let co=3;lt.forEach((ra,ma)=>{const{indices:ls,vertices:Aa,normals:Ia,size:ka,indexes:qs,count:ks}=this.triangulation(ra,Ke);typeof ks=="number"&&(ki+=ks),ls.forEach(es=>{Jr.push(es+Mr)}),co=ka;const Ec=Aa.length/ka;this.featureLayout.sizePerElement=co,this.featureLayout.elements.push({featureIdx:ma,vertices:Aa,normals:Ia,offset:Mr}),Mr+=Ec;for(let es=0;es<Ec;es++){const Iu=(Ia==null?void 0:Ia.slice(es*3,es*3+3))||[],du=Aa.slice(es*ka,es*ka+ka);let Lc=0;qs&&qs[es]!==void 0&&(Lc=qs[es]),Xn.forEach((Pf,Zh)=>{Pf&&Pf.update&&Pf.buffer.data.push(...Pf.update(ra,ma,du,es,Iu,Lc))})}});const{createAttribute:so,createBuffer:sa,createElements:Po}=this.rendererService,_a={};Xn.forEach((ra,ma)=>{if(ra){const{buffer:ls,update:Aa,name:Ia}=ra,ka=(0,mo.Z)(ra,Ui),qs=so((0,ne.Z)({buffer:sa(ls)},ka));_a[ra.name||""]=qs,this.attributes[ma].vertexAttribute=qs}});const qa=Po({data:Jr,type:yt.UNSIGNED_INT,count:Jr.length});return this.attributesAndIndices={attributes:_a,elements:qa,count:ki},Object.values(this.attributes).filter(ra=>ra.scale).forEach(ra=>{const ma=ra.name;X==null||X.emit(`legend:${ma}`,X.getLegend(ma))}),this.attributesAndIndices}createAttributes(lt,It){this.featureLayout={sizePerElement:0,elements:[]},It&&(this.triangulation=It);const Ke=this.attributes.map(so=>(so.resetDescriptor(),so.descriptor));let X=0;const Xn=[];let Mr=3;lt.forEach((so,sa)=>{const{indices:Po,vertices:_a,normals:qa,size:ra,indexes:ma}=this.triangulation(so);Po.forEach(Aa=>{Xn.push(Aa+X)}),Mr=ra;const ls=_a.length/ra;this.featureLayout.sizePerElement=Mr,this.featureLayout.elements.push({featureIdx:sa,vertices:_a,normals:qa,offset:X}),X+=ls;for(let Aa=0;Aa<ls;Aa++){const Ia=(qa==null?void 0:qa.slice(Aa*3,Aa*3+3))||[],ka=_a.slice(Aa*ra,Aa*ra+ra);let qs=0;ma&&ma[Aa]!==void 0&&(qs=ma[Aa]),Ke.forEach((ks,Ec)=>{ks&&ks.update&&ks.buffer.data.push(...ks.update(so,sa,ka,Aa,Ia,qs))})}});const{createAttribute:ki,createBuffer:Jr}=this.rendererService,co={};return Ke.forEach((so,sa)=>{if(so){const{buffer:Po,update:_a,name:qa}=so,ra=(0,mo.Z)(so,Xr),ma=ki((0,ne.Z)({buffer:Jr(Po)},ra));co[so.name||""]=ma,this.attributes[sa].vertexAttribute=ma}}),{attributes:co}}clearAllAttributes(){var lt;this.attributes.forEach(It=>{It.vertexAttribute&&It.vertexAttribute.destroy()}),(lt=this.attributesAndIndices)===null||lt===void 0||lt.elements.destroy(),this.attributes=[]}}var Eo=it(46343),Xi=it(63844),Mo=it.n(Xi);class Xo extends ze.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(lt){super(),(0,pt.Z)(this,"destroyed",!1),(0,pt.Z)(this,"loaded",!1),(0,pt.Z)(this,"id",void 0),(0,pt.Z)(this,"inited",!1),(0,pt.Z)(this,"rendering",!1),(0,pt.Z)(this,"$container",void 0),(0,pt.Z)(this,"canvas",void 0),(0,pt.Z)(this,"markerContainer",void 0),(0,pt.Z)(this,"resizeDetector",void 0),(0,pt.Z)(this,"hooks",void 0),(0,pt.Z)(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),(0,pt.Z)(this,"handleMapCameraChanged",It=>{this.cameraService.update(It),this.render()}),this.container=lt,this.hooks={init:new Eo.sX},this.id=lt.id}init(lt){var It=this;this.configService.setSceneConfig(this.id,lt),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,ut.Z)(function*(){It.debugService.log("map.mapInitStart",{type:It.map.version}),yield new Promise(Ke=>{It.map.onCameraChanged(X=>{It.cameraService.init(),It.cameraService.update(X),Ke()}),It.map.init()}),It.map.onCameraChanged(It.handleMapCameraChanged),It.map.addMarkerContainer(),It.markerService.addMarkers(),It.markerService.addMarkerLayers(),It.popupService.initPopup(),It.interactionService.init(),It.interactionService.on(ir.Drag,It.addSceneEvent.bind(It))})),this.hooks.init.tapPromise("initRenderer",(0,ut.Z)(function*(){var Ke;const X=((Ke=It.map)===null||Ke===void 0?void 0:Ke.getOverlayContainer())||void 0;if(X?It.$container=X:It.$container=Pn(It.configService.getSceneConfig(It.id).id||""),It.$container){const{canvas:Mr}=lt;if(It.canvas=Mr||R.SO.create("canvas","",It.$container),It.setCanvas(),yield It.rendererService.init(It.canvas,It.configService.getSceneConfig(It.id),lt.gl),It.registerContextLost(),It.initContainer(),It.resizeDetector=Mo()({strategy:"scroll"}),It.resizeDetector.listenTo(It.$container,It.handleWindowResized),window.matchMedia){var Xn;(Xn=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||Xn===void 0||Xn.addListener(It.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");It.pickingService.init(It.id)})),this.render()}registerContextLost(){const lt=this.rendererService.getCanvas();lt&&lt.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(lt){this.layerService.sceneService=this,this.layerService.add(lt)}addMask(lt){this.layerService.sceneService=this,this.layerService.addMask(lt)}render(){var lt=this;return(0,ut.Z)(function*(){lt.rendering||lt.destroyed||(lt.rendering=!0,lt.inited?(yield lt.layerService.initLayers(),yield lt.layerService.renderLayers()):(yield lt.hooks.init.promise(),lt.destroyed&&lt.destroy(),yield lt.layerService.initLayers(),lt.layerService.renderLayers(),lt.controlService.addControls(),lt.loaded=!0,lt.emit("loaded"),lt.inited=!0),lt.rendering=!1)})()}addFontFace(lt,It){this.fontService.addFontFace(lt,It)}getSceneContainer(){return this.$container}exportPng(lt){var It=this;return(0,ut.Z)(function*(){var Ke;const X=(Ke=It.$container)===null||Ke===void 0?void 0:Ke.getElementsByTagName("canvas")[0];return yield It.render(),lt==="jpg"?X==null?void 0:X.toDataURL("image/jpeg"):X==null?void 0:X.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const lt=this.$container.parentElement;lt!==null&&(this.markerContainer=R.SO.create("div","l7-marker-container",lt))}getMarkerContainer(){return this.markerContainer}destroy(){var lt;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var It;(It=this.$container)===null||It===void 0||It.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(lt=this.$container)===null||lt===void 0||(lt=lt.parentNode)===null||lt===void 0||lt.removeChild(this.$container),this.emit("destroy")}initContainer(){var lt,It;const Ke=R.SO.DPR,X=((lt=this.$container)===null||lt===void 0?void 0:lt.clientWidth)||400,Xn=((It=this.$container)===null||It===void 0?void 0:It.clientHeight)||300,Mr=this.canvas;Mr&&(Mr.width=X*Ke,Mr.height=Xn*Ke),this.rendererService.viewport({x:0,y:0,width:Ke*X,height:Ke*Xn})}setCanvas(){var lt,It;const Ke=R.SO.DPR,X=((lt=this.$container)===null||lt===void 0?void 0:lt.clientWidth)||400,Xn=((It=this.$container)===null||It===void 0?void 0:It.clientHeight)||300,Mr=this.canvas;Mr.width=X*Ke,Mr.height=Xn*Ke,Mr.style.width="100%",Mr.style.height="100%"}addSceneEvent(lt){this.emit(lt.type,lt)}}const{uniq:wl}=R.lodashUtil,Ya="#define PI 3.14159265359",ca=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,ws=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Ms=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,re=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,ge=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,An=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,tr=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,Ei=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,Si=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,uo=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,Es=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Ns=/precision\s+(high|low|medium)p\s+float/,As=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,rl=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,Xf=/void\s+main\s*\([^)]*\)\s*\{\n?/;class Ud{constructor(){(0,pt.Z)(this,"moduleCache",{}),(0,pt.Z)(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:Ya,fs:Ya}),this.registerModule("decode",{vs:ws,fs:""}),this.registerModule("scene_uniforms",{vs:uo,fs:uo}),this.registerModule("picking_uniforms",{vs:An,fs:An}),this.registerModule("projection",{vs:Ei,fs:Ei}),this.registerModule("project",{vs:tr,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Es}),this.registerModule("lighting",{vs:Ms,fs:""}),this.registerModule("light",{vs:ca,fs:""}),this.registerModule("picking",{vs:ge,fs:re}),this.registerModule("rotation_2d",{vs:Si,fs:""})}registerModule(lt,It){It.vs=It.vs.replace(/\r\n/g,`
`),It.fs=It.fs.replace(/\r\n/g,`
`);const{vs:Ke,fs:X,uniforms:Xn,defines:Mr,inject:ki}=It,{content:Jr,uniforms:co}=fe(Ke),{content:so,uniforms:sa}=fe(X);this.rawContentCache[lt]={fs:so,defines:Mr,inject:ki,uniforms:(0,ne.Z)((0,ne.Z)((0,ne.Z)({},co),sa),Xn),vs:Jr}}getModule(lt){let It=this.rawContentCache[lt].vs,Ke=this.rawContentCache[lt].fs;const{defines:X={},inject:Xn={}}=this.rawContentCache[lt];let Mr={};Xn["vs:#decl"]&&(It=Xn["vs:#decl"]+It,Mr=fe(Xn["vs:#decl"]).uniforms),Xn["vs:#main-start"]&&(It=It.replace(Xf,ra=>ra+Xn["vs:#main-start"])),Xn["fs:#decl"]&&(Ke=Xn["fs:#decl"]+Ke),It=md(X)+It;const{content:Jr,includeList:co}=this.processModule(It,[],"vs"),{content:so,includeList:sa}=this.processModule(Ke,[],"fs"),Po=wl(co.concat(sa).concat(lt)).reduce((ra,ma)=>(0,ne.Z)((0,ne.Z)({},ra),this.rawContentCache[ma].uniforms),(0,ne.Z)({},Mr)),_a=(Ns.test(so)?"":As)+Jr,qa=(Ns.test(so)?"":As)+so;return this.moduleCache[lt]={vs:_a.trim(),fs:qa.trim(),uniforms:Po},this.moduleCache[lt]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(lt,It,Ke){return{content:lt.replace(rl,(Xn,Mr)=>{const Jr=Mr.split(" ")[0].replace(/"/g,"");if(It.indexOf(Jr)>-1)return"";const co=this.rawContentCache[Jr][Ke];It.push(Jr);const{content:so}=this.processModule(co,It,Ke);return so}),includeList:It}}}function md(K){return Object.keys(K).reduce((It,Ke)=>It+`#define ${Ke.toUpperCase()} ${K[Ke]}
`,`
`)}class Dl{constructor(){(0,pt.Z)(this,"shaderModuleService",void 0),(0,pt.Z)(this,"rendererService",void 0),(0,pt.Z)(this,"cameraService",void 0),(0,pt.Z)(this,"mapService",void 0),(0,pt.Z)(this,"interactionService",void 0),(0,pt.Z)(this,"layerService",void 0),(0,pt.Z)(this,"config",void 0)}getName(){return""}getType(){return $e.Normal}init(lt,It){this.config=It,this.rendererService=lt.getContainer().rendererService,this.cameraService=lt.getContainer().cameraService,this.mapService=lt.getContainer().mapService,this.interactionService=lt.getContainer().interactionService,this.layerService=lt.getContainer().layerService,this.shaderModuleService=lt.getContainer().shaderModuleService}render(lt){}}class Qc extends Dl{getName(){return"clear"}init(lt,It){super.init(lt,It)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class Mf{constructor(lt){(0,pt.Z)(this,"passes",[]),(0,pt.Z)(this,"layer",void 0),(0,pt.Z)(this,"renderFlag",void 0),(0,pt.Z)(this,"width",0),(0,pt.Z)(this,"height",0),this.postProcessor=lt}setLayer(lt){this.layer=lt}setRenderFlag(lt){this.renderFlag=lt}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var lt=this;return(0,ut.Z)(function*(){for(const It of lt.passes)yield It.render(lt.layer);yield lt.postProcessor.render(lt.layer)})()}resize(lt,It){(this.width!==lt||this.height!==It)&&(this.postProcessor.resize(lt,It),this.width=lt,this.height=It)}add(lt,It){lt.getType()===$e.PostProcessing?this.postProcessor.add(lt,this.layer,It):(lt.init(this.layer,It),this.passes.push(lt))}insert(lt,It,Ke){lt.init(this.layer,It),this.passes.splice(Ke,0,lt)}destroy(){this.passes.length=0}}class Jc extends Dl{constructor(...lt){var It;super(...lt),It=this,(0,pt.Z)(this,"pickingFBO",void 0),(0,pt.Z)(this,"layer",void 0),(0,pt.Z)(this,"width",0),(0,pt.Z)(this,"height",0),(0,pt.Z)(this,"alreadyInRendering",!1),(0,pt.Z)(this,"pickFromPickingFBO",({x:Ke,y:X,lngLat:Xn,type:Mr})=>{if(!this.layer.isVisible()||!this.layer.needPick(Mr))return;const{getViewportSize:ki,readPixelsAsync:Jr,useFramebuffer:co}=this.rendererService,{width:so,height:sa}=ki(),{enableHighlight:Po,enableSelect:_a}=this.layer.getLayerConfig(),qa=Ke*R.SO.DPR,ra=X*R.SO.DPR;if(qa>so||qa<0||ra>sa||ra<0)return;let ma;co(this.pickingFBO,(0,ut.Z)(function*(){var ls;if(ma=yield Jr({x:Math.round(qa),y:Math.round(sa-(X+1)*R.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:It.pickingFBO}),ma[0]!==0||ma[1]!==0||ma[2]!==0){const Aa=(0,R.W0)(ma),Ia=It.layer.getSource().getFeatureById(Aa),ka={x:Ke,y:X,type:Mr,lngLat:Xn,featureId:Aa,feature:Ia};Ia&&(It.layer.setCurrentPickId(Aa),It.triggerHoverOnLayer(ka))}else{const Aa={x:Ke,y:X,lngLat:Xn,type:It.layer.getCurrentPickId()===null?"un"+Mr:"mouseout",featureId:null,feature:null};It.triggerHoverOnLayer((0,ne.Z)((0,ne.Z)({},Aa),{},{type:"unpick"})),It.triggerHoverOnLayer(Aa),It.layer.setCurrentPickId(null)}Po&&It.highlightPickedFeature(ma),_a&&Mr==="click"&&((ls=ma)===null||ls===void 0?void 0:ls.toString())!==[0,0,0,0].toString()&&It.selectFeature(ma)}))})}getType(){return $e.Normal}getName(){return"pixelPicking"}init(lt,It){super.init(lt,It),this.layer=lt;const{createTexture2D:Ke,createFramebuffer:X,getViewportSize:Xn}=this.rendererService,{width:Mr,height:ki}=Xn(),Jr=Ke({width:Mr,height:ki,wrapS:yt.CLAMP_TO_EDGE,wrapT:yt.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=X({color:Jr}),this.interactionService.on(ir.Hover,this.pickFromPickingFBO),this.interactionService.on(ir.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ir.Active,this.highlightFeatureHandle.bind(this))}render(lt){if(this.alreadyInRendering)return;const{getViewportSize:It,useFramebuffer:Ke,clear:X}=this.rendererService,{width:Xn,height:Mr}=It();this.alreadyInRendering=!0,(this.width!==Xn||this.height!==Mr)&&(this.pickingFBO.resize({width:Xn,height:Mr}),this.width=Xn,this.height=Mr),Ke(this.pickingFBO,()=>{X({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const ki=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),lt.hooks.beforePickingEncode.call(),lt.render(),lt.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(ki),this.alreadyInRendering=!1})}triggerHoverOnLayer(lt){this.layer.emit(lt.type,lt)}highlightPickedFeature(lt){const[It,Ke,X]=lt;this.layer.hooks.beforeHighlight.call([It,Ke,X]),this.layerService.renderLayers()}selectFeature(lt){const[It,Ke,X]=lt;this.layer.hooks.beforeSelect.call([It,Ke,X]),this.layerService.renderLayers()}selectFeatureHandle({featureId:lt}){const It=(0,R.Z6)(lt);this.selectFeature(new Uint8Array(It))}highlightFeatureHandle({featureId:lt}){const It=(0,R.Z6)(lt);this.highlightPickedFeature(new Uint8Array(It))}}class Ic{constructor(lt){(0,pt.Z)(this,"passes",[]),(0,pt.Z)(this,"readFBO",void 0),(0,pt.Z)(this,"writeFBO",void 0),this.rendererService=lt,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:lt,createTexture2D:It}=this.rendererService,{width:Ke,height:X}=lt();return It({x:0,y:0,width:Ke,height:X,copy:!0})}getReadFBOTex(){var lt=this;const{useFramebuffer:It}=this.rendererService;return new Promise(Ke=>{It(this.readFBO,(0,ut.Z)(function*(){Ke(lt.getCurrentFBOTex())}))})}renderBloomPass(lt,It){var Ke=this;return(0,ut.Z)(function*(){const X=yield Ke.getReadFBOTex();let Xn=0;for(;Xn<4;)yield It.render(lt,X),Ke.swap(),Xn++})()}render(lt){var It=this;return(0,ut.Z)(function*(){for(let Ke=0;Ke<It.passes.length;Ke++){const X=It.passes[Ke];X.setRenderToScreen(It.isLastEnabledPass(Ke)),X.getName()==="bloom"?yield It.renderBloomPass(lt,X):(yield X.render(lt),Ke!==It.passes.length-1&&It.swap())}})()}resize(lt,It){this.readFBO.resize({width:lt,height:It}),this.writeFBO.resize({width:lt,height:It})}add(lt,It,Ke){lt.init(It,Ke),this.passes.push(lt)}insert(lt,It,Ke,X){lt.init(Ke,X),this.passes.splice(It,0,lt)}getPostProcessingPassByName(lt){return this.passes.find(It=>It.getName()===lt)}init(){const{createFramebuffer:lt,createTexture2D:It}=this.rendererService;this.readFBO=lt({color:It({width:1,height:1,wrapS:yt.CLAMP_TO_EDGE,wrapT:yt.CLAMP_TO_EDGE,usage:mn.RENDER_TARGET})}),this.writeFBO=lt({color:It({width:1,height:1,wrapS:yt.CLAMP_TO_EDGE,wrapT:yt.CLAMP_TO_EDGE,usage:mn.RENDER_TARGET})})}isLastEnabledPass(lt){for(let It=lt+1;It<this.passes.length;It++)if(this.passes[It].isEnabled())return!1;return!0}swap(){const lt=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=lt}}class tu extends Dl{getType(){return $e.Normal}getName(){return"render"}init(lt,It){super.init(lt,It)}render(lt){const{useFramebuffer:It,clear:Ke}=this.rendererService,X=lt.multiPassRenderer.getPostProcessor().getReadFBO();It(X,()=>{Ke({color:[0,0,0,0],depth:1,stencil:0,framebuffer:X}),lt.multiPassRenderer.setRenderFlag(!1),lt.models.forEach(Xn=>{Xn.draw({uniforms:lt.layerModel.getUninforms()})}),lt.multiPassRenderer.setRenderFlag(!0)})}}const Yf=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,ac=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Ws}=R.lodashUtil;class Ru extends fn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:ac,fs:Yf});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("blur-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}convertOptionsToUniforms(lt){const It={};return Ws(lt.bloomRadius)||(It.u_radius=lt.bloomRadius),Ws(lt.bloomIntensity)||(It.u_intensity=lt.bloomIntensity),Ws(lt.bloomBaseRadio)||(It.u_baseRadio=lt.bloomBaseRadio),It}}const gf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Fh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Uh}=R.lodashUtil;class eu extends fn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:Fh,fs:gf});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("blur-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}convertOptionsToUniforms(lt){const It={};return Uh(lt.blurRadius)||(It.u_BlurDir=[lt.blurRadius,0]),It}}const mh=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,zh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:vd}=R.lodashUtil;class gd extends fn{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:zh,fs:mh});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("blur-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}convertOptionsToUniforms(lt){const It={};return vd(lt.blurRadius)||(It.u_BlurDir=[0,lt.blurRadius]),It}}const yd=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,vp=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class qf extends fn{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:vp,fs:yd});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}}const Mu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,_d=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Nl extends fn{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:_d,fs:Mu}),this.shaderModuleService.getModule("copy-pass")}}const Ps=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,nu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class sc extends fn{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:nu,fs:Ps});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}}const of=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,lc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class af extends fn{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:lc,fs:of});const{vs:lt,fs:It,uniforms:Ke}=this.shaderModuleService.getModule("ink-pass"),{width:X,height:Xn}=this.rendererService.getViewportSize();return{vs:lt,fs:It,uniforms:(0,ne.Z)((0,ne.Z)({},Ke),{},{u_ViewportSize:[X,Xn]})}}}const kl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Pu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class yf extends fn{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:Pu,fs:kl}),this.shaderModuleService.getModule("noise-pass")}}const vh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$f=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class us extends fn{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:vh,fs:$f}),this.shaderModuleService.getModule("sepia-pass")}}const jh=new pi;let Vh=0;function gh(){const K=new Ud,lt=new $o,It=new ee,Ke=new Lo(It),X=new ht,Xn=new Ge,Mr=new Tr,ki=new Zr,Jr=new Hn,co={id:`${Vh++}`,globalConfigService:jh,shaderModuleService:K,debugService:lt,cameraService:It,coordinateSystemService:Ke,fontService:X,iconService:Xn,markerService:Mr,popupService:ki,controlService:Jr,customRenderService:{}},so=new Vi(co);co.layerService=so;const sa=new Xo(co);co.sceneService=sa;const Po=new qe(co);co.interactionService=Po;const _a=new dr(co);co.pickingService=_a;const qa={clear:new Qc,pixelPicking:new Jc,render:new tu};co.normalPassFactory=ma=>qa[ma];const ra={copy:new Nl,bloom:new Ru,blurH:new eu,blurV:new gd,noise:new yf,sepia:new us,colorHalftone:new qf,hexagonalPixelate:new sc,ink:new af};return co.postProcessingPass=ra,co.postProcessingPassFactory=ma=>ra[ma],co}function il(K){const lt=(0,ne.Z)({},K);return lt.postProcessor=new Ic(lt.rendererService),lt.multiPassRenderer=new Mf(lt.postProcessor),lt.styleAttributeService=new Ni(lt.rendererService),lt}const Kf=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let Qf=function(K){return K.IMAGE="image",K.CUSTOMIMAGE="customImage",K.ARRAYBUFFER="arraybuffer",K.RGB="rgb",K.TERRAINRGB="terrainRGB",K.CUSTOMRGB="customRGB",K.CUSTOMARRAYBUFFER="customArrayBuffer",K.CUSTOMTERRAINRGB="customTerrainRGB",K}({})},35914:function(br,rr,it){"use strict";it.d(rr,{Z:function(){return Wn}});var ne=it(1413),pt=it(4942);class R{constructor(Kt){(0,pt.Z)(this,"configService",void 0),(0,pt.Z)(this,"config",void 0),this.config=Kt}setContainer(Kt,Ce){this.configService=Kt.globalConfigService,Kt.mapConfig=(0,ne.Z)((0,ne.Z)({},this.config),{},{id:Ce}),Kt.mapService=new(this.getServiceConstructor())(Kt)}getServiceConstructor(){throw new Error("Method not implemented.")}}var $e=it(45987),yt=it(15861),xe=it(85975),le=it(77160),Le=it(6158),Lt=it.n(Le),fn=it(15671),Nt=it(43144),Jt=it(82963),Ie=it(61120),fe=it(60136),ce=it(97326),ve=it(97685),Ze=it(98333);function Un(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function En(sn,Kt){var Ce=Ze.fF([],Kt,sn);return Ze.bA(Ce,Ce,1/Ce[3]),Ce}function Vn(sn,Kt){var Ce=sn%Kt;return Ce<0?Kt+Ce:Ce}function mr(sn,Kt,Ce){return Ce*Kt+(1-Ce)*sn}var or=it(31437);function He(sn,Kt){if(!sn)throw new Error(Kt||"viewport-mercator-project: assertion failed.")}var $t=Math.PI,nn=$t/4,ke=$t/180,Je=180/$t,er=512,kt=4003e4,Te=1.5;function gt(sn){return Math.pow(2,sn)}function te(sn){return Math.log2(sn)}function Zt(sn,Kt){var Ce=(0,ve.Z)(sn,2),xn=Ce[0],Cn=Ce[1];He(Number.isFinite(xn)&&Number.isFinite(Kt)),He(Number.isFinite(Cn)&&Cn>=-90&&Cn<=90,"invalid latitude"),Kt*=er;var Zn=xn*ke,Qt=Cn*ke,ct=Kt*(Zn+$t)/(2*$t),bt=Kt*($t-Math.log(Math.tan(nn+Qt*.5)))/(2*$t);return[ct,bt]}function Ut(sn,Kt){var Ce=(0,ve.Z)(sn,2),xn=Ce[0],Cn=Ce[1];Kt*=er;var Zn=xn/Kt*(2*$t)-$t,Qt=2*(Math.atan(Math.exp($t-Cn/Kt*(2*$t)))-nn);return[Zn*Je,Qt*Je]}function we(sn){var Kt=sn.latitude;assert(Number.isFinite(Kt));var Ce=Math.cos(Kt*ke);return te(kt*Ce)-9}function ie(sn){var Kt=sn.latitude,Ce=sn.longitude,xn=sn.zoom,Cn=sn.scale,Zn=sn.highPrecision,Qt=Zn===void 0?!1:Zn;Cn=Cn!==void 0?Cn:gt(xn),He(Number.isFinite(Kt)&&Number.isFinite(Ce)&&Number.isFinite(Cn));var ct={},bt=er*Cn,zt=Math.cos(Kt*ke),me=bt/360,de=me/zt,bn=bt/kt/zt;if(ct.pixelsPerMeter=[bn,-bn,bn],ct.metersPerPixel=[1/bn,-1/bn,1/bn],ct.pixelsPerDegree=[me,-de,bn],ct.degreesPerPixel=[1/me,-1/de,1/bn],Qt){var qn=ke*Math.tan(Kt*ke)/zt,Sr=me*qn/2,Gn=bt/kt*qn,ht=Gn/de*bn;ct.pixelsPerDegree2=[0,-Sr,Gn],ct.pixelsPerMeter2=[ht,0,ht]}return ct}function _t(sn,Kt){var Ce=_slicedToArray(sn,3),xn=Ce[0],Cn=Ce[1],Zn=Ce[2],Qt=_slicedToArray(Kt,3),ct=Qt[0],bt=Qt[1],zt=Qt[2],me=1,de=ie({longitude:xn,latitude:Cn,scale:me,highPrecision:!0}),bn=de.pixelsPerMeter,qn=de.pixelsPerMeter2,Sr=Zt(sn,me);Sr[0]+=ct*(bn[0]+qn[0]*bt),Sr[1]+=bt*(bn[1]+qn[1]*bt);var Gn=Ut(Sr,me),ht=(Zn||0)+(zt||0);return Number.isFinite(Zn)||Number.isFinite(zt)?[Gn[0],Gn[1],ht]:Gn}function Ne(sn){var Kt=sn.height,Ce=sn.pitch,xn=sn.bearing,Cn=sn.altitude,Zn=sn.center,Qt=Zn===void 0?null:Zn,ct=sn.flipY,bt=ct===void 0?!1:ct,zt=Un();return xe.translate(zt,zt,[0,0,-Cn]),xe.scale(zt,zt,[1,1,1/Kt]),xe.rotateX(zt,zt,-Ce*ke),xe.rotateZ(zt,zt,xn*ke),bt&&xe.scale(zt,zt,[1,-1,1]),Qt&&xe.translate(zt,zt,le.tk([],Qt)),zt}function un(sn){var Kt=sn.width,Ce=sn.height,xn=sn.altitude,Cn=xn===void 0?Te:xn,Zn=sn.pitch,Qt=Zn===void 0?0:Zn,ct=sn.nearZMultiplier,bt=ct===void 0?1:ct,zt=sn.farZMultiplier,me=zt===void 0?1:zt,de=Qt*ke,bn=Math.atan(.5/Cn),qn=Math.sin(bn)*Cn/Math.sin(Math.PI/2-de-bn),Sr=Math.cos(Math.PI/2-de)*qn+Cn;return{fov:2*Math.atan(Ce/2/Cn),aspect:Kt/Ce,focalDistance:Cn,near:bt,far:Sr*me}}function Qn(sn){var Kt=sn.width,Ce=sn.height,xn=sn.pitch,Cn=sn.altitude,Zn=sn.nearZMultiplier,Qt=sn.farZMultiplier,ct=un({width:Kt,height:Ce,altitude:Cn,pitch:xn,nearZMultiplier:Zn,farZMultiplier:Qt}),bt=ct.fov,zt=ct.aspect,me=ct.near,de=ct.far,bn=xe.perspective([],bt,zt,me,de);return bn}function hr(sn,Kt){var Ce=(0,ve.Z)(sn,3),xn=Ce[0],Cn=Ce[1],Zn=Ce[2],Qt=Zn===void 0?0:Zn;return He(Number.isFinite(xn)&&Number.isFinite(Cn)&&Number.isFinite(Qt)),En(Kt,[xn,Cn,Qt,1])}function Er(sn,Kt){var Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,xn=(0,ve.Z)(sn,3),Cn=xn[0],Zn=xn[1],Qt=xn[2];if(He(Number.isFinite(Cn)&&Number.isFinite(Zn),"invalid pixel coordinate"),Number.isFinite(Qt)){var ct=En(Kt,[Cn,Zn,Qt,1]);return ct}var bt=En(Kt,[Cn,Zn,0,1]),zt=En(Kt,[Cn,Zn,1,1]),me=bt[2],de=zt[2],bn=me===de?0:((Ce||0)-me)/(de-me);return or.t7([],bt,zt,bn)}var Ue=Un(),cn=function(){function sn(){var Kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ce=Kt.width,xn=Kt.height,Cn=Kt.viewMatrix,Zn=Cn===void 0?Ue:Cn,Qt=Kt.projectionMatrix,ct=Qt===void 0?Ue:Qt;(0,fn.Z)(this,sn),this.width=Ce||1,this.height=xn||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=Zn,this.projectionMatrix=ct;var bt=Un();xe.multiply(bt,bt,this.projectionMatrix),xe.multiply(bt,bt,this.viewMatrix),this.viewProjectionMatrix=bt;var zt=Un();xe.scale(zt,zt,[this.width/2,-this.height/2,1]),xe.translate(zt,zt,[1,-1,0]),xe.multiply(zt,zt,this.viewProjectionMatrix);var me=xe.invert(Un(),zt);if(!me)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=zt,this.pixelUnprojectionMatrix=me,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,Nt.Z)(sn,[{key:"equals",value:function(Ce){return Ce instanceof sn?Ce.width===this.width&&Ce.height===this.height&&xe.equals(Ce.projectionMatrix,this.projectionMatrix)&&xe.equals(Ce.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(Ce){var xn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Cn=xn.topLeft,Zn=Cn===void 0?!0:Cn,Qt=this.projectPosition(Ce),ct=hr(Qt,this.pixelProjectionMatrix),bt=(0,ve.Z)(ct,2),zt=bt[0],me=bt[1],de=Zn?me:this.height-me;return Ce.length===2?[zt,de]:[zt,de,ct[2]]}},{key:"unproject",value:function(Ce){var xn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Cn=xn.topLeft,Zn=Cn===void 0?!0:Cn,Qt=xn.targetZ,ct=(0,ve.Z)(Ce,3),bt=ct[0],zt=ct[1],me=ct[2],de=Zn?zt:this.height-zt,bn=Qt&&Qt*this.pixelsPerMeter,qn=Er([bt,de,me],this.pixelUnprojectionMatrix,bn),Sr=this.unprojectPosition(qn),Gn=(0,ve.Z)(Sr,3),ht=Gn[0],ut=Gn[1],wt=Gn[2];return Number.isFinite(me)?[ht,ut,wt]:Number.isFinite(Qt)?[ht,ut,Qt]:[ht,ut]}},{key:"projectPosition",value:function(Ce){var xn=this.projectFlat(Ce),Cn=(0,ve.Z)(xn,2),Zn=Cn[0],Qt=Cn[1],ct=(Ce[2]||0)*this.pixelsPerMeter;return[Zn,Qt,ct]}},{key:"unprojectPosition",value:function(Ce){var xn=this.unprojectFlat(Ce),Cn=(0,ve.Z)(xn,2),Zn=Cn[0],Qt=Cn[1],ct=(Ce[2]||0)/this.pixelsPerMeter;return[Zn,Qt,ct]}},{key:"projectFlat",value:function(Ce){var xn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ce}},{key:"unprojectFlat",value:function(Ce){var xn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ce}}]),sn}();function wn(sn){var Kt=sn.width,Ce=sn.height,xn=sn.bounds,Cn=sn.minExtent,Zn=Cn===void 0?0:Cn,Qt=sn.maxZoom,ct=Qt===void 0?24:Qt,bt=sn.padding,zt=bt===void 0?0:bt,me=sn.offset,de=me===void 0?[0,0]:me,bn=(0,ve.Z)(xn,2),qn=(0,ve.Z)(bn[0],2),Sr=qn[0],Gn=qn[1],ht=(0,ve.Z)(bn[1],2),ut=ht[0],wt=ht[1];if(Number.isFinite(zt)){var Gt=zt;zt={top:Gt,bottom:Gt,left:Gt,right:Gt}}else He(Number.isFinite(zt.top)&&Number.isFinite(zt.bottom)&&Number.isFinite(zt.left)&&Number.isFinite(zt.right));var ue=new ir({width:Kt,height:Ce,longitude:0,latitude:0,zoom:0}),Ge=ue.project([Sr,wt]),ln=ue.project([ut,Gn]),ee=[Math.max(Math.abs(ln[0]-Ge[0]),Zn),Math.max(Math.abs(ln[1]-Ge[1]),Zn)],Fe=[Kt-zt.left-zt.right-Math.abs(de[0])*2,Ce-zt.top-zt.bottom-Math.abs(de[1])*2];He(Fe[0]>0&&Fe[1]>0);var Hn=Fe[0]/ee[0],Tr=Fe[1]/ee[1],Zr=(zt.right-zt.left)/2/Hn,vr=(zt.bottom-zt.top)/2/Tr,Ur=[(ln[0]+Ge[0])/2+Zr,(ln[1]+Ge[1])/2+vr],jr=ue.unproject(Ur),ni=ue.zoom+Math.log2(Math.abs(Math.min(Hn,Tr)));return{longitude:jr[0],latitude:jr[1],zoom:Math.min(ni,ct)}}var ir=function(sn){(0,fe.Z)(Kt,sn);function Kt(){var Ce,xn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Cn=xn.width,Zn=xn.height,Qt=xn.latitude,ct=Qt===void 0?0:Qt,bt=xn.longitude,zt=bt===void 0?0:bt,me=xn.zoom,de=me===void 0?0:me,bn=xn.pitch,qn=bn===void 0?0:bn,Sr=xn.bearing,Gn=Sr===void 0?0:Sr,ht=xn.altitude,ut=ht===void 0?1.5:ht,wt=xn.nearZMultiplier,Gt=xn.farZMultiplier;(0,fn.Z)(this,Kt),Cn=Cn||1,Zn=Zn||1;var ue=gt(de);ut=Math.max(.75,ut);var Ge=Zt([zt,ct],ue);Ge[2]=0;var ln=Qn({width:Cn,height:Zn,pitch:qn,bearing:Gn,altitude:ut,nearZMultiplier:wt||1/Zn,farZMultiplier:Gt||1.01}),ee=Ne({height:Zn,center:Ge,pitch:qn,bearing:Gn,altitude:ut,flipY:!0});return Ce=(0,Jt.Z)(this,(0,Ie.Z)(Kt).call(this,{width:Cn,height:Zn,viewMatrix:ee,projectionMatrix:ln})),Ce.latitude=ct,Ce.longitude=zt,Ce.zoom=de,Ce.pitch=qn,Ce.bearing=Gn,Ce.altitude=ut,Ce.scale=ue,Ce.center=Ge,Ce.pixelsPerMeter=ie((0,ce.Z)((0,ce.Z)(Ce))).pixelsPerMeter[2],Object.freeze((0,ce.Z)((0,ce.Z)(Ce))),Ce}return(0,Nt.Z)(Kt,[{key:"projectFlat",value:function(xn){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Zt(xn,Cn)}},{key:"unprojectFlat",value:function(xn){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ut(xn,Cn)}},{key:"getMapCenterByLngLatPosition",value:function(xn){var Cn=xn.lngLat,Zn=xn.pos,Qt=Er(Zn,this.pixelUnprojectionMatrix),ct=Zt(Cn,this.scale),bt=or.IH([],ct,or.tk([],Qt)),zt=or.IH([],this.center,bt);return Ut(zt,this.scale)}},{key:"getLocationAtPoint",value:function(xn){var Cn=xn.lngLat,Zn=xn.pos;return this.getMapCenterByLngLatPosition({lngLat:Cn,pos:Zn})}},{key:"fitBounds",value:function(xn){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Zn=this.width,Qt=this.height,ct=wn(Object.assign({width:Zn,height:Qt,bounds:xn},Cn)),bt=ct.longitude,zt=ct.latitude,me=ct.zoom;return new Kt({width:Zn,height:Qt,longitude:bt,latitude:zt,zoom:me})}}]),Kt}(cn);class rn{constructor(){(0,pt.Z)(this,"viewport",new ir)}syncWithMapCamera(Kt){const{center:Ce,zoom:xn,pitch:Cn,bearing:Zn,viewportHeight:Qt,viewportWidth:ct}=Kt,bt={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new ir((0,ne.Z)((0,ne.Z)({},bt),{},{width:ct,height:Qt,longitude:Ce&&Ce[0],latitude:Ce&&Ce[1],zoom:xn,pitch:Cn,bearing:Zn}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(Kt,Ce){return this.viewport.projectFlat(Kt,Ce)}}var De=it(39827),Be=it(8543),At=it(26729);class Bt{constructor(Kt){(0,pt.Z)(this,"size",1e4),this.size=Kt||1e4}setSize(Kt){this.size=Kt}getSize(){return[this.size,this.size]}mercatorXfromLng(Kt){return(180+Kt)/360*this.size}mercatorYfromLat(Kt){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Kt*Math.PI/360)))/360)*this.size}lngFromMercatorX(Kt){return Kt/this.size*360-180}latFromMercatorY(Kt){const Ce=180-(1-Kt/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(Ce*Math.PI/180))-90}project(Kt){const Ce=this.mercatorXfromLng(Kt[0]),xn=this.mercatorYfromLat(Kt[1]);return[Ce,xn]}unproject(Kt){const Ce=this.lngFromMercatorX(Kt[0]),xn=this.latFromMercatorY(Kt[1]);return[Ce,xn]}}const Ae={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},z={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},rt=12;class F{constructor(Kt){(0,pt.Z)(this,"version","DEFAUlTMAP"),(0,pt.Z)(this,"map",void 0),(0,pt.Z)(this,"simpleMapCoord",new Bt),(0,pt.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,pt.Z)(this,"config",void 0),(0,pt.Z)(this,"configService",void 0),(0,pt.Z)(this,"coordinateSystemService",void 0),(0,pt.Z)(this,"eventEmitter",void 0),(0,pt.Z)(this,"markerContainer",void 0),(0,pt.Z)(this,"cameraChangedCallback",void 0),(0,pt.Z)(this,"$mapContainer",void 0),(0,pt.Z)(this,"handleCameraChanged",Ce=>{const{lat:xn,lng:Cn}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[Cn,xn],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=Kt.mapConfig,this.configService=Kt.globalConfigService,this.coordinateSystemService=Kt.coordinateSystemService,this.eventEmitter=new At.EventEmitter}setBgColor(Kt){this.bgColor=Kt}addMarkerContainer(){const Kt=this.map.getCanvasContainer();this.markerContainer=Be.SO.create("div","l7-marker-container",Kt),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(Kt,Ce){De.I9.indexOf(Kt)!==-1?this.eventEmitter.on(Kt,Ce):this.map.on(z[Kt]||Kt,Ce)}off(Kt,Ce){this.map.off(z[Kt]||Kt,Ce),this.eventEmitter.off(Kt,Ce)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const Kt=this.map.transform;return[Kt.width,Kt.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(Kt){return this.map.setZoom(Kt)}getCenter(){return this.map.getCenter()}setCenter(Kt){this.map.setCenter(Kt)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(Kt){this.map.setBearing(Kt)}zoomIn(Kt,Ce){this.map.zoomIn(Kt,Ce)}zoomOut(Kt,Ce){this.map.zoomOut(Kt,Ce)}setPitch(Kt){return this.map.setPitch(Kt)}panTo(Kt){this.map.panTo(Kt)}panBy(Kt=0,Ce=0){this.map.panBy([Kt,Ce])}fitBounds(Kt,Ce){this.map.fitBounds(Kt,Ce)}setMaxZoom(Kt){this.map.setMaxZoom(Kt)}setMinZoom(Kt){this.map.setMinZoom(Kt)}setMapStatus(Kt){Kt.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),Kt.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),Kt.dragEnable===!1&&this.map.dragPan.disable(),Kt.dragEnable===!0&&this.map.dragPan.enable(),Kt.rotateEnable===!1&&this.map.dragRotate.disable(),Kt.dragEnable===!0&&this.map.dragRotate.enable(),Kt.keyboardEnable===!1&&this.map.keyboard.disable(),Kt.keyboardEnable===!0&&this.map.keyboard.enable(),Kt.zoomEnable===!1&&this.map.scrollZoom.disable(),Kt.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(Kt,Ce){this.map.flyTo({zoom:Kt,center:Ce})}setMapStyle(Kt){var Ce;(Ce=this.map)===null||Ce===void 0||Ce.setStyle(this.getMapStyleValue(Kt))}meterToCoord(Kt,Ce){return 1}pixelToLngLat(Kt){return this.map.unproject(Kt)}lngLatToPixel(Kt){return this.map.project(Kt)}containerToLngLat(Kt){return this.map.unproject(Kt)}lngLatToContainer(Kt){return this.map.project(Kt)}getMapStyle(){try{var Kt;const Ce=(Kt=this.map.getStyle().sprite)!==null&&Kt!==void 0?Kt:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(Ce)?Ce==null?void 0:Ce.replace(/\/\w+$/,"").replace(/sprites/,"styles"):Ce}catch(Ce){return""}}getMapStyleConfig(){return Ae}getMapStyleValue(Kt){var Ce;return(Ce=this.getMapStyleConfig()[Kt])!==null&&Ce!==void 0?Ce:Kt}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(Kt,...Ce){this.eventEmitter.emit(Kt,...Ce)}once(Kt,...Ce){this.eventEmitter.once(Kt,...Ce)}getMapContainer(){return this.$mapContainer}exportMap(Kt){var Ce;const xn=(Ce=this.map)===null||Ce===void 0?void 0:Ce.getCanvas();return Kt==="jpg"?xn==null?void 0:xn.toDataURL("image/jpeg"):xn==null?void 0:xn.toDataURL("image/png")}onCameraChanged(Kt){this.cameraChangedCallback=Kt}creatMapContainer(Kt){let Ce=Kt;return typeof Kt=="string"&&(Ce=document.getElementById(Kt)),Ce}updateView(Kt){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:Kt.bearing,center:Kt.center,viewportHeight:Kt.viewportHeight,pitch:Kt.pitch,viewportWidth:Kt.viewportWidth,zoom:Kt.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:Kt=!0}=this.config;this.viewport.getZoom()>rt&&Kt?this.coordinateSystemService.setCoordinateSystem(De.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(De.lo.LNGLAT)}}const ot=["id","attributionControl","style","token","rotation","mapInstance"];function ze(sn,Kt){var Ce=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,xn=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Ce||xn)&&(Kt||(Kt=document),!!Kt)){var Cn=Kt.head||Kt.getElementsByTagName("head")[0];if(!Cn){Cn=Kt.createElement("head");var Zn=Kt.body||Kt.getElementsByTagName("body")[0];Zn?Zn.parentNode.insertBefore(Cn,Zn):Kt.documentElement.appendChild(Cn)}var Qt=Kt.createElement("style");return Qt.type="text/css",Qt.styleSheet?Qt.styleSheet.cssText=sn:Qt.appendChild(Kt.createTextNode(sn)),Cn.appendChild(Qt),Qt}}ze(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Lt();let Vt=0;const ae="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class Mn extends F{constructor(...Kt){super(...Kt),(0,pt.Z)(this,"version","MAPBOX"),(0,pt.Z)(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(Kt,Ce={x:0,y:0,z:0}){const{x:xn,y:Cn}=this.lngLatToMercator(Kt,0);return[xn-Ce.x,Cn-Ce.y]}lngLatToMercator(Kt,Ce){const{x:xn=0,y:Cn=0,z:Zn=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(Kt,Ce);return{x:xn,y:Cn,z:Zn}}getModelMatrix(Kt,Ce,xn,Cn=[1,1,1],Zn={x:0,y:0,z:0}){const Qt=window.mapboxgl.MercatorCoordinate.fromLngLat(Kt,Ce),ct=Qt.meterInMercatorCoordinateUnits(),bt=xe.create();return xe.translate(bt,bt,le.al(Qt.x-Zn.x,Qt.y-Zn.y,Qt.z||0-Zn.z)),xe.scale(bt,bt,le.al(ct*Cn[0],-ct*Cn[1],ct*Cn[2])),xe.rotateX(bt,bt,xn[0]),xe.rotateY(bt,bt,xn[1]),xe.rotateZ(bt,bt,xn[2]),bt}init(){var Kt=this;return(0,yt.Z)(function*(){const Ce=Kt.config,{id:xn="map",attributionControl:Cn=!1,style:Zn="light",token:Qt=ae,rotation:ct=0,mapInstance:bt}=Ce,zt=(0,$e.Z)(Ce,ot);Kt.viewport=new rn,!bt&&!window.mapboxgl&&console.error(Kt.configService.getSceneWarninfo("SDK")),Qt===ae&&Zn!=="blank"&&!window.mapboxgl.accessToken&&!bt&&console.warn(Kt.configService.getSceneWarninfo("MapToken")),!bt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Qt),bt?(Kt.map=bt,Kt.$mapContainer=Kt.map.getContainer()):(Kt.$mapContainer=Kt.creatMapContainer(xn),Kt.map=new window.mapboxgl.Map((0,ne.Z)({container:Kt.$mapContainer,style:Kt.getMapStyleValue(Zn),attributionControl:Cn,bearing:ct},zt))),Kt.map.on("load",()=>{Kt.handleCameraChanged()}),Kt.map.on("move",Kt.handleCameraChanged),Kt.handleCameraChanged()})()}destroy(){var Kt;(Kt=this.$mapContainer)===null||Kt===void 0||(Kt=Kt.parentNode)===null||Kt===void 0||Kt.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(Kt,...Ce){this.eventEmitter.emit(Kt,...Ce)}once(Kt,...Ce){this.eventEmitter.once(Kt,...Ce)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var Kt;return(Kt=this.getMapContainer())===null||Kt===void 0?void 0:Kt.querySelector(".mapboxgl-canvas-container")}meterToCoord(Kt,Ce){const xn=new(Lt()).LngLat(Kt[0],Kt[1]),Cn=new(Lt()).LngLat(Ce[0],Ce[1]),Zn=xn.distanceTo(Cn),Qt=Lt().MercatorCoordinate.fromLngLat({lng:Kt[0],lat:Kt[1]}),ct=Lt().MercatorCoordinate.fromLngLat({lng:Ce[0],lat:Ce[1]}),{x:bt,y:zt}=Qt,{x:me,y:de}=ct;return Math.sqrt(Math.pow(bt-me,2)+Math.pow(zt-de,2))*4194304*2/Zn}exportMap(Kt){const Ce=this.map.getCanvas();return Kt==="jpg"?Ce==null?void 0:Ce.toDataURL("image/jpeg"):Ce==null?void 0:Ce.toDataURL("image/png")}creatMapContainer(Kt){let Ce=Kt;typeof Kt=="string"&&(Ce=document.getElementById(Kt));const xn=document.createElement("div");return xn.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,xn.id="l7_mapbox_div"+Vt++,Ce.appendChild(xn),xn}}function zn(sn,Kt){var Ce=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,xn=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Ce||xn)&&(Kt||(Kt=document),!!Kt)){var Cn=Kt.head||Kt.getElementsByTagName("head")[0];if(!Cn){Cn=Kt.createElement("head");var Zn=Kt.body||Kt.getElementsByTagName("body")[0];Zn?Zn.parentNode.insertBefore(Cn,Zn):Kt.documentElement.appendChild(Cn)}var Qt=Kt.createElement("style");return Qt.type="text/css",Qt.styleSheet?Qt.styleSheet.cssText=sn:Qt.appendChild(Kt.createTextNode(sn)),Cn.appendChild(Qt),Qt}}zn(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class Wn extends R{getServiceConstructor(){return Mn}}},4771:function(){},8543:function(br,rr,it){"use strict";it.d(rr,{SO:function(){return ne},z6:function(){return il},a5:function(){return pt},SA:function(){return R},nx:function(){return Jf},Z:function(){return Xf},rQ:function(){return kt},bV:function(){return er},zi:function(){return Te},ds:function(){return tu},oO:function(){return Ic},SI:function(){return eu},Rx:function(){return mh},W0:function(){return Ut},LS:function(){return pu},Z6:function(){return we},We:function(){return An},Co:function(){return Je},Ks:function(){return Ms},hj:function(){return Ne},Cl:function(){return ie},Oc:function(){return Qn},M4:function(){return _t},NJ:function(){return un},ks:function(){return En},Ol:function(){return zh},Yu:function(){return mr},ZB:function(){return Er},gJ:function(){return ke},z0:function(){return $a},jG:function(){return bd},M8:function(){return yd},fg:function(){return si},if:function(){return ge},vP:function(){return uo},lodashUtil:function(){return Fe},LF:function(){return ve},Fv:function(){return Yf},yA:function(){return Jc},CI:function(){return Zt}});var ne={};it.r(ne),it.d(ne,{DPR:function(){return Se},addClass:function(){return Ar},addStyle:function(){return qe},appendElementType:function(){return Vi},clearChildren:function(){return fr},create:function(){return jr},css2Style:function(){return tn},empty:function(){return aa},findParentElement:function(){return mo},getClass:function(){return Li},getContainer:function(){return Tr},getDiffRect:function(){return mn},getStyleList:function(){return Rn},getViewPortScale:function(){return Wt},hasClass:function(){return mi},printCanvas:function(){return Mt},remove:function(){return ni},removeClass:function(){return pi},removeStyle:function(){return Pn},setChecked:function(){return dr},setClass:function(){return xi},setTransform:function(){return Lo},setUnDraggable:function(){return ai},splitWords:function(){return vr},toggleClass:function(){return wo},triggerResize:function(){return $o},trim:function(){return Zr}});var pt={};it.r(pt),it.d(pt,{getColumn:function(){return X},getSatByColumn:function(){return Xn},max:function(){return Kf},mean:function(){return lt},min:function(){return Qf},mode:function(){return It},statMap:function(){return Ke},sum:function(){return K}});var R={REGISTERED_PROTOCOLS:{}},$e=Object.defineProperty,yt=Object.defineProperties,xe=Object.getOwnPropertyDescriptors,le=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable,fn=(tt,mt,Xt)=>mt in tt?$e(tt,mt,{enumerable:!0,configurable:!0,writable:!0,value:Xt}):tt[mt]=Xt,Nt=(tt,mt)=>{for(var Xt in mt||(mt={}))Le.call(mt,Xt)&&fn(tt,Xt,mt[Xt]);if(le)for(var Xt of le(mt))Lt.call(mt,Xt)&&fn(tt,Xt,mt[Xt]);return tt},Jt=(tt,mt)=>yt(tt,xe(mt)),Ie=tt=>R.REGISTERED_PROTOCOLS[tt.substring(0,tt.indexOf("://"))],fe=class extends Error{constructor(tt,mt,Xt,dn){super(`AJAXError: ${mt} (${tt}): ${Xt}`),this.status=tt,this.statusText=mt,this.url=Xt,this.body=dn}};function ce(tt,mt){const Xt=new XMLHttpRequest,dn=Array.isArray(tt.url)?tt.url[0]:tt.url;Xt.open(tt.method||"GET",dn,!0),tt.type==="arrayBuffer"&&(Xt.responseType="arraybuffer");for(const nr in tt.headers)tt.headers.hasOwnProperty(nr)&&Xt.setRequestHeader(nr,tt.headers[nr]);return tt.type==="json"&&(Xt.responseType="text",Xt.setRequestHeader("Accept","application/json")),Xt.withCredentials=tt.credentials==="include",Xt.onerror=()=>{mt(new Error(Xt.statusText))},Xt.onload=()=>{if((Xt.status>=200&&Xt.status<300||Xt.status===0)&&Xt.response!==null){let nr=Xt.response;if(tt.type==="json")try{nr=JSON.parse(Xt.response)}catch(Br){return mt(Br)}mt(null,nr,Xt.getResponseHeader("Cache-Control"),Xt.getResponseHeader("Expires"),Xt)}else{const nr=new Blob([Xt.response],{type:Xt.getResponseHeader("Content-Type")});mt(new fe(Xt.status,Xt.statusText,dn.toString(),nr))}},Xt.cancel=Xt.abort,Xt.send(tt.body),Xt}function ve(tt){return new Promise((mt,Xt)=>{ce(tt,(dn,nr,Br,vi,qi)=>{dn?Xt({err:dn,data:null,xhr:qi}):mt({err:null,data:nr,cacheControl:Br,expires:vi,xhr:qi})})})}function Ze(tt,mt){return ce(tt,mt)}var Un=(tt,mt)=>(Ie(tt.url)||Ze)(Jt(Nt({},tt),{type:"json"}),mt),En=(tt,mt)=>(Ie(tt.url)||Ze)(Jt(Nt({},tt),{type:"arrayBuffer"}),mt),Vn=(tt,mt)=>Ze(Jt(Nt({},tt),{method:"POST"}),mt),mr=(tt,mt)=>Ze(Jt(Nt({},tt),{method:"GET"}),mt);function or(tt){const mt=window.document.createElement("a");return mt.href=tt,mt.protocol===window.document.location.protocol&&mt.host===window.document.location.host}var He="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function $t(tt,mt){const Xt=new window.Image,dn=window.URL||window.webkitURL;Xt.crossOrigin="anonymous",Xt.onload=()=>{mt(null,Xt),dn.revokeObjectURL(Xt.src),Xt.onload=null,window.requestAnimationFrame(()=>{Xt.src=He})},Xt.onerror=()=>mt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const nr=new Blob([new Uint8Array(tt)],{type:"image/png"});Xt.src=tt.byteLength?dn.createObjectURL(nr):He}function nn(tt,mt){const Xt=new Blob([new Uint8Array(tt)],{type:"image/png"});createImageBitmap(Xt).then(dn=>{mt(null,dn)}).catch(dn=>{mt(new Error(`Could not load image because of ${dn.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var ke=(tt,mt,Xt)=>{const dn=(nr,Br)=>{if(nr)mt(nr);else if(Br){const vi=typeof createImageBitmap=="function",qi=Xt?Xt(Br):Br;vi?nn(qi,mt):$t(qi,mt)}};return tt.type==="json"?Un(tt,dn):En(tt,dn)},Je=(tt,mt)=>{typeof createImageBitmap=="function"?nn(tt,mt):$t(tt,mt)},er=(tt=>(tt.CENTER="center",tt.TOP="top",tt["TOP-LEFT"]="top-left",tt["TOP-RIGHT"]="top-right",tt.BOTTOM="bottom",tt["BOTTOM-LEFT"]="bottom-left",tt["BOTTOM-RIGHT"]="bottom-right",tt.LEFT="left",tt.RIGHT="right",tt))(er||{}),kt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Te(tt,mt,Xt){const dn=tt.classList;for(const nr in kt)kt.hasOwnProperty(nr)&&dn.remove(`l7-${Xt}-anchor-${nr}`);dn.add(`l7-${Xt}-anchor-${mt}`)}var gt=it(37620);function te(tt){return typeof tt=="string"?!!d3.color(tt):!1}function Zt(tt){const mt=gt.ZP(tt),Xt=[0,0,0,0];return mt!=null&&(Xt[0]=mt.r/255,Xt[1]=mt.g/255,Xt[2]=mt.b/255,Xt[3]=mt.opacity),Xt}function Ut(tt){const mt=tt&&tt[0],Xt=tt&&tt[1],dn=tt&&tt[2];return mt+Xt*256+dn*65536-1}function we(tt){return[tt+1&255,tt+1>>8&255,tt+1>>8>>8&255]}function ie(tt){let mt=window.document.createElement("canvas"),Xt=mt.getContext("2d");mt.width=256,mt.height=1;let dn=null;const nr=Xt.createLinearGradient(0,0,256,1),Br=tt.positions[0],vi=tt.positions[tt.positions.length-1];for(let qi=0;qi<tt.colors.length;++qi){const da=(tt.positions[qi]-Br)/(vi-Br);nr.addColorStop(da,tt.colors[qi])}return Xt.fillStyle=nr,Xt.fillRect(0,0,256,1),dn=new Uint8ClampedArray(Xt.getImageData(0,0,256,1).data),mt=null,Xt=null,{data:dn,width:256,height:1}}function _t(tt,mt){let Xt=window.document.createElement("canvas"),dn=Xt.getContext("2d");Xt.width=256,Xt.height=1;const nr=dn.createLinearGradient(0,0,256,1),Br=mt[1]-mt[0];for(let da=0;da<tt.colors.length;++da){const xa=Math.max((tt.positions[da]-mt[0])/Br,0);nr.addColorStop(xa,tt.colors[da])}dn.fillStyle=nr,dn.fillRect(0,0,256,1);const vi=dn.getImageData(0,0,256,1).data,qi=hr(dn,vi);return Xt=null,dn=null,qi}function Ne(tt){let mt=window.document.createElement("canvas"),Xt=mt.getContext("2d");mt.width=256,mt.height=1;const dn=Xt.createImageData(256,1);return dn.data.fill(0),tt.positions.forEach((nr,Br)=>{const vi=Zt(tt.colors[Br]);dn.data[nr*4+0]=vi[0]*255,dn.data[nr*4+1]=vi[1]*255,dn.data[nr*4+2]=vi[2]*255,dn.data[nr*4+3]=vi[3]*255}),mt=null,Xt=null,dn}function un(tt){let mt=window.document.createElement("canvas"),Xt=mt.getContext("2d");Xt.globalAlpha=1,mt.width=256,mt.height=1;const dn=256/tt.colors.length;for(let vi=0;vi<tt.colors.length;vi++)Xt.beginPath(),Xt.lineWidth=2,Xt.strokeStyle=tt.colors[vi],Xt.moveTo(vi*dn,0),Xt.lineTo((vi+1)*dn,0),Xt.stroke();const nr=Xt.getImageData(0,0,256,1).data,Br=hr(Xt,nr);return mt=null,Xt=null,Br}function Qn(tt,mt){let Xt=window.document.createElement("canvas"),dn=Xt.getContext("2d");dn.globalAlpha=1,Xt.width=256,Xt.height=1;const nr=mt[1]-mt[0];tt.positions.length-tt.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let qi=0;qi<tt.colors.length;qi++)dn.beginPath(),dn.lineWidth=2,dn.strokeStyle=tt.colors[qi],dn.moveTo((tt.positions[qi]-mt[0])/nr*255,0),dn.lineTo((tt.positions[qi+1]-mt[0])/nr*255,0),dn.stroke();const Br=dn.getImageData(0,0,256,1).data,vi=hr(dn,Br);return Xt=null,dn=null,vi}function hr(tt,mt){const Xt=tt.createImageData(256,1);for(let dn=0;dn<Xt.data.length;dn+=4)Xt.data[dn+0]=mt[dn+0],Xt.data[dn+1]=mt[dn+1],Xt.data[dn+2]=mt[dn+2],Xt.data[dn+3]=mt[dn+3];return Xt}function Er(tt){switch(tt==null?void 0:tt.type){case"cat":return[0,255];default:return[0,1]}}var Ue=it(74691),cn=it.n(Ue),wn=it(50361),ir=it.n(wn),rn=it(23279),De=it.n(rn),Be=it(27361),At=it.n(Be),Bt=it(51584),Ae=it.n(Bt),z=it(18446),rt=it.n(z),F=it(14293),ot=it.n(F),ze=it(81763),Vt=it.n(ze),ae=it(68630),Mn=it.n(ae),zn=it(47037),Wn=it.n(zn),sn=it(36719),Kt=it.n(sn),Ce=it(82492),xn=it.n(Ce),Cn=it(30236),Zn=it.n(Cn),Qt=it(97019),ct=it.n(Qt),bt=it(23493),zt=it.n(bt),me=it(44908),de=it.n(me),bn=it(11700),qn=it.n(bn),Sr=it(23560),Gn=it.n(Sr),ht=it(13218),ut=it.n(ht),wt=it(52353),Gt=it.n(wt),ue=it(68929),Ge=it.n(ue),ln=it(73955),ee=it.n(ln),Fe={isNil:ot(),merge:xn(),throttle:zt(),isString:Wn(),debounce:De(),pull:ct(),isTypedArray:Kt(),isPlainObject:Mn(),isNumber:Vt(),isBoolean:Ae(),isEqual:rt(),cloneDeep:ir(),uniq:de(),clamp:cn(),upperFirst:qn(),get:At(),mergeWith:Zn(),isFunction:Gn(),isObject:ut(),isUndefined:Gt(),camelCase:Ge(),uniqueId:ee()},{pull:Hn}=Fe;function Tr(tt){let mt=tt;return typeof tt=="string"&&(mt=window.document.getElementById(tt)),mt}function Zr(tt){return tt.trim?tt.trim():tt.replace(/^\s+|\s+$/g,"")}function vr(tt){return Zr(tt).split(/\s+/)}function Ur(tt){var mt;const Xt=(mt=document==null?void 0:document.documentElement)==null?void 0:mt.style;if(!Xt)return tt[0];for(const dn in tt)if(tt[dn]&&tt[dn]in Xt)return tt[dn];return tt[0]}function jr(tt,mt,Xt){const dn=window.document.createElement(tt);return mt&&(dn.className=mt||""),Xt&&Xt.appendChild(dn),dn}function ni(tt){const mt=tt.parentNode;mt&&mt.removeChild(tt)}function Ar(tt,mt){if(tt.classList!==void 0){const Xt=vr(mt);for(let dn=0,nr=Xt.length;dn<nr;dn++)tt.classList.add(Xt[dn])}else if(!mi(tt,mt)){const Xt=Li(tt);xi(tt,(Xt?Xt+" ":"")+mt)}}function pi(tt,mt){tt.classList!==void 0?vr(mt).forEach(dn=>{tt.classList.remove(dn)}):xi(tt,Zr((" "+Li(tt)+" ").replace(" "+mt+" "," ")))}function mi(tt,mt){if(tt.classList!==void 0)return tt.classList.contains(mt);const Xt=Li(tt);return Xt.length>0&&new RegExp("(^|\\s)"+mt+"(\\s|$)").test(Xt)}function xi(tt,mt){tt instanceof HTMLElement?tt.className=mt:tt.className.baseVal=mt}function wo(tt,mt,Xt){Xt===void 0?mi(tt,mt)?pi(tt,mt):Ar(tt,mt):Xt?Ar(tt,mt):pi(tt,mt)}function Li(tt){return tt instanceof SVGElement&&(tt=tt.correspondingElement),tt.className.baseVal===void 0?tt.className:tt.className.baseVal}function aa(tt){for(;tt&&tt.firstChild;)tt.removeChild(tt.firstChild)}var Pa=Ur(["transform","WebkitTransform"]);function Lo(tt,mt){tt.style[Pa]=mt}function $o(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const tt=window.document.createEvent("UIEvents");tt.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(tt)}}function Mt(tt){const mt=["padding: "+(tt.height/2-8)+"px "+tt.width/2+"px;","line-height: "+tt.height+"px;","background-image: url("+tt.toDataURL()+");"];console.log(`%c
`,mt.join(""))}function Wt(){var tt;const mt=window.document.querySelector('meta[name="viewport"]');if(!mt)return 1;const dn=((tt=mt.content)==null?void 0:tt.split(",")).find(nr=>{const[Br]=nr.split("=");return Br==="initial-scale"});return dn?dn.split("=")[1]*1:1}var Se=Wt()<1?1:window.devicePixelRatio;function qe(tt,mt){tt.setAttribute("style",`${tt.style.cssText}${mt}`)}function Rn(tt){return tt.split(";").map(mt=>mt.trim()).filter(mt=>mt)}function Pn(tt,mt){var Xt;const dn=Rn((Xt=tt.getAttribute("style"))!=null?Xt:""),nr=Rn(mt),Br=Hn(dn,...nr);tt.setAttribute("style",Br.join(";"))}function tn(tt){return Object.entries(tt).map(([mt,Xt])=>`${mt}: ${Xt}`).join(";")}function mn(tt,mt){return{left:tt.left-mt.left,top:tt.top-mt.top,right:mt.left+mt.width-tt.left-tt.width,bottom:mt.top+mt.height-tt.top-tt.height}}function dr(tt,mt){tt.checked=mt,mt?tt.setAttribute("checked","true"):tt.removeAttribute("checked")}function fr(tt){tt.innerHTML=""}function ai(tt){tt.setAttribute("draggable","false")}function Vi(tt,mt){if(typeof mt=="string"){const Xt=document.createElement("div");for(Xt.innerHTML=mt;Xt.firstChild;)tt.append(Xt.firstChild)}else Array.isArray(mt)?tt.append(...mt):tt.append(mt)}function mo(tt,mt){var Xt;const dn=Array.isArray(mt)?mt:[mt];let nr=tt;for(;nr instanceof Element&&nr!==window.document.body;){if(dn.find(Br=>nr==null?void 0:nr.matches(Br)))return nr;nr=(Xt=nr==null?void 0:nr.parentElement)!=null?Xt:null}}function si(tt){return typeof ImageBitmap!="undefined"&&tt instanceof ImageBitmap}function Wi(){return typeof importScripts=="function"}var Ui=Wi()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Xr=navigator==null?void 0:navigator.userAgent,bo=!!Xr.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Ni=Xr.indexOf("Android")>-1||Xr.indexOf("Adr")>-1;function Eo(){const tt=Xr,mt=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let Xt=!0;for(const dn of mt)if(tt.indexOf(dn)>0){Xt=!1;break}return Xt}function Xi(tt,mt){tt.forEach(Xt=>{mt[Xt]&&(mt[Xt]=mt[Xt].bind(mt))})}var Mo=class{constructor(tt=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=tt}run(tt){const mt=new Date().getTime(),Xt=mt-this.timestamp;this.timestamp=mt,Xt>=this.duration&&tt()}},Xo=it(39034);function wl(tt){var mt=[1/0,1/0,-1/0,-1/0];return(0,Xo.pZ)(tt,function(Xt){mt[0]>Xt[0]&&(mt[0]=Xt[0]),mt[1]>Xt[1]&&(mt[1]=Xt[1]),mt[2]<Xt[0]&&(mt[2]=Xt[0]),mt[3]<Xt[1]&&(mt[3]=Xt[1])}),mt}wl.default=wl;var Ya=wl,ca=it(1449);function ws(tt){return typeof tt=="number"}function Ms(tt){return tt-Math.fround(tt)}var re=2*Math.PI*6378137/2;function ge(tt,mt){const[Xt,dn,nr,Br]=mt;return tt.lng>Xt&&tt.lng<=nr&&tt.lat>dn&&tt.lat<=Br}function An(tt){const mt=[1/0,1/0,-1/0,-1/0];return tt.forEach(Xt=>{const{coordinates:dn}=Xt;tr(mt,dn)}),mt}function tr(tt,mt){return Array.isArray(mt[0])?mt.forEach(Xt=>{tr(tt,Xt)}):(tt[0]>mt[0]&&(tt[0]=mt[0]),tt[1]>mt[1]&&(tt[1]=mt[1]),tt[2]<mt[0]&&(tt[2]=mt[0]),tt[3]<mt[1]&&(tt[3]=mt[1])),tt}function Ei(tt,mt){return Si(tt,mt)}function Si(tt,mt){return Array.isArray(tt[0])?tt.map(Xt=>Si(Xt,mt)):mt(tt)}function uo(tt,mt=!0,Xt={enable:!0,decimal:1}){tt=rl(tt,mt);const dn=tt[0],nr=tt[1];let Br=dn*re/180,vi=Math.log(Math.tan((90+nr)*Math.PI/360))/(Math.PI/180);return vi=vi*re/180,Xt.enable&&(Br=Number(Br.toFixed(Xt.decimal)),vi=Number(vi.toFixed(Xt.decimal))),tt.length===3?[Br,vi,tt[2]]:[Br,vi]}function Es(tt,mt=6){const Xt=tt[0],dn=tt[1];let nr=Xt/re*180,Br=dn/re*180;return Br=180/Math.PI*(2*Math.atan(Math.exp(Br*Math.PI/180))-Math.PI/2),mt!=null&&(nr=Number(nr.toFixed(mt)),Br=Number(Br.toFixed(mt))),tt.length===3?[nr,Br,tt[2]]:[nr,Br]}function Ns(tt){if(tt==null)throw new Error("lng is required");return(tt>180||tt<-180)&&(tt=tt%360,tt>180&&(tt=-360+tt),tt<-180&&(tt=360+tt),tt===0&&(tt=0)),tt}function As(tt){if(tt==null)throw new Error("lat is required");return(tt>90||tt<-90)&&(tt=tt%180,tt>90&&(tt=-180+tt),tt<-90&&(tt=180+tt),tt===0&&(tt=0)),tt}function rl(tt,mt){if(mt===!1)return tt;const Xt=Ns(tt[0]);let dn=As(tt[1]);return dn>85&&(dn=85),dn<-85&&(dn=-85),tt.length===3?[Xt,dn,tt[2]]:[Xt,dn]}function Xf(tt){const mt=85.0511287798,Xt=Math.max(Math.min(mt,tt[1]),-mt),dn=256<<20;let nr=Math.PI/180,Br=tt[0]*nr,vi=Xt*nr;vi=Math.log(Math.tan(Math.PI/4+vi/2));const qi=.5/Math.PI,da=.5,xa=-.5/Math.PI;return nr=.5,Br=dn*(qi*Br+da),vi=dn*(xa*vi+nr),[Math.floor(Br),Math.floor(vi)]}function Ud(tt){const mt=.5/Math.PI,Xt=.5,dn=-.5/Math.PI;let nr=.5;const Br=256<<20;let[vi,qi]=tt;vi=(vi/Br-Xt)/mt,qi=(qi/Br-nr)/dn,qi=(Math.atan(Math.pow(Math.E,qi))-Math.PI/4)*2,nr=Math.PI/180;const da=qi/nr;return[vi/nr,da]}function md(tt,mt){const Xt=85.0511287798,dn=Math.PI/180,nr=6378137;return mt=Math.max(Math.min(Xt,mt),-Xt),tt*=dn,mt*=dn,mt=Math.log(Math.tan(Math.PI/4+mt/2)),[tt*nr,mt*nr]}function Dl(tt,mt){const Xt=Math.PI/180,dn=6378137,nr=tt/dn/Xt,Br=2*(Math.atan(Math.exp(mt/dn))-Math.PI/4)/Xt;return[nr,Br]}function Qc(tt,mt,Xt){const dn=degreesToRadians(mt[1]-tt[1]),nr=degreesToRadians(mt[0]-tt[0]),Br=degreesToRadians(tt[1]),vi=degreesToRadians(mt[1]),qi=Math.pow(Math.sin(dn/2),2)+Math.pow(Math.sin(nr/2),2)*Math.cos(Br)*Math.cos(vi);return radiansToLength(2*Math.atan2(Math.sqrt(qi),Math.sqrt(1-qi)),Xt="meters")}function Mf(tt){const mt=Math.PI/180,Xt=85.0511287798,dn=6378137,nr=Math.max(Math.min(Xt,tt[1]),-Xt),Br=Math.sin(nr*mt),vi=dn*tt[0]*mt,qi=dn*Math.log((1+Br)/(1-Br))/2;return[vi,qi]}function Jc(tt,mt){const Xt=Math.abs(tt[1][1]-tt[0][1])*mt,dn=Math.abs(tt[1][0]-tt[0][0])*mt;return[[tt[0][0]-dn,tt[0][1]-Xt],[tt[1][0]+dn,tt[1][1]+Xt]]}function Ic(tt,mt){return tt[0][0]<=mt[0][0]&&tt[0][1]<=mt[0][1]&&tt[1][0]>=mt[1][0]&&tt[1][1]>=mt[1][1]}function tu(tt){return[[tt[0],tt[1]],[tt[2],tt[3]]]}function Yf(tt){const mt=ac(tt,[0,0]);return[tt[0]/mt,tt[1]/mt]}function ac(tt,mt){return Math.sqrt(Math.pow(tt[0]-mt[0],2)+Math.pow(tt[1]-mt[1],2))}function Ws(tt,mt){return tt[0]*mt[0]+tt[1]*mt[1]}function Ru(tt){return Math.sqrt(tt[0]*tt[0]+tt[1]*tt[1])}function gf(tt,mt){return Math.acos(Ws(tt,mt)/(Ru(tt)*Ru(mt)))*180/Math.PI}function Fh(tt,mt){return mt[0]>0?mt[1]>0?90-Math.atan(mt[1]/mt[0])*180/Math.PI:90+Math.atan(-mt[1]/mt[0])*180/Math.PI:mt[1]<0?180+(90-Math.atan(mt[1]/mt[0])*180/Math.PI):270+Math.atan(mt[1]/-mt[0])*180/Math.PI}function Uh(tt,mt=100){if(!tt||tt.length<2)return;const Xt=[0,1];let dn=0;const nr=[];for(let Br=0;Br<tt.length-1;Br++){const vi=tt[Br],qi=tt[Br+1],da=ac(vi,qi);dn+=da;const xa=[vi[0]-qi[0],vi[1]-qi[1]];let ms=Fh(Xt,xa);if(Br>0){const Fa=nr[Br-1].rotation;Fa-ms>360-Fa+ms&&(ms=ms+360)}nr.push({start:vi,end:qi,dis:da,rotation:ms,duration:0})}return nr.map(Br=>{Br.duration=mt*(Br.dis/dn)}),nr}function eu(tt){if(ws(tt[0]))return tt;if(ws(tt[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(ws(tt[0][0][0])){const mt=tt;let Xt=0,dn=0,nr=0;return mt.forEach(Br=>{Br.forEach(vi=>{Xt+=vi[0],dn+=vi[1],nr++})}),[Xt/nr,dn/nr,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function mh(tt){let mt=tt[0],Xt=tt[1],dn=tt[0],nr=tt[1],Br=0,vi=0,qi=0;for(let da=0;da<tt.length;da+=2){const xa=tt[da],ms=tt[da+1];xa&&ms&&(mt=Math.max(xa,mt),Xt=Math.max(ms,Xt),dn=Math.min(xa,dn),nr=Math.min(ms,nr),Br+=xa,vi+=ms,qi++)}return{center:[Br/qi,vi/qi],radius:Math.sqrt(Math.pow(mt-dn,2)+Math.pow(Xt-nr,2))/2}}function zh(tt){return Ya((0,ca.uf)([(0,ca.Tu)(tt)]))}function vd(tt){let dn=0;tt+="x";const nr=Math.floor(9007199254740991/137);for(let Br=0;Br<tt.length;Br++)dn>nr&&(dn=Math.floor(dn/137)),dn=dn*131+tt.charCodeAt(Br);return dn}function gd(tt){tt=tt.toString();let mt=5381,Xt=tt.length;for(;Xt;)mt=mt*33^tt.charCodeAt(--Xt);return mt>>>0}function yd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,tt=>{const mt=Math.random()*16|0;return(tt==="x"?mt:mt&3|8).toString(16)})}function vp(tt,mt,Xt,dn,nr=30,Br){let vi=Xt;return Br&&(vi=Math.round(Xt*(nr-1))/(nr-1)),dn?Nl(tt,mt,vi,dn):Nl(tt,mt,vi,.314)}function qf(tt,mt){const Xt=1-mt;return(tt[0]*Xt+tt[1]*mt)*Xt+(tt[1]*Xt+tt[2]*mt)*mt}function Mu(tt,mt){return Math.sqrt(Math.pow(tt[0]-mt[0],2)+Math.pow(tt[1]-mt[1],2))}function _d(tt,mt,Xt){const dn=[mt[0]-tt[0],mt[1]-tt[1]],nr=Mu(dn,[0,0]),Br=Math.atan2(dn[1],dn[0]),vi=nr/2/Math.cos(Xt),qi=Br+Xt;return[vi*Math.cos(qi)+tt[0],vi*Math.sin(qi)+tt[1]]}function Nl(tt,mt,Xt,dn){const nr=_d(tt,mt,dn),Br=[tt[0],nr[0],mt[0]],vi=[tt[1],nr[1],mt[1]];return[qf(Br,Xt),qf(vi,Xt),0]}function Ps(tt,mt,Xt,dn,nr=30,Br){let vi=Xt;return Br&&(vi=Math.round(Xt*29)/29),sc(tt,mt,vi)}function nu(tt,mt){const Xt=[tt[0]-mt[0],tt[1]-mt[1]],dn=[Math.sin(Xt[0]/2),Math.sin(Xt[1]/2)],nr=dn[1]*dn[1]+Math.cos(tt[1])*Math.cos(mt[1])*dn[0]*dn[0];return 2*Math.atan2(Math.sqrt(nr),Math.sqrt(1-nr))}function sc(tt,mt,Xt){const dn=[degreesToRadians(tt[0]),degreesToRadians(tt[1])],nr=[degreesToRadians(mt[0]),degreesToRadians(mt[1])],Br=nu(dn,nr);if(Math.abs(Br-Math.PI)<.001)return[(1-Xt)*dn[0]+Xt*nr[0],(1-Xt)*dn[1]+Xt*nr[1]];const vi=Math.sin((1-Xt)*Br)/Math.sin(Br),qi=Math.sin(Xt*Br)/Math.sin(Br),da=[Math.sin(dn[0]),Math.sin(dn[1])],xa=[Math.cos(dn[0]),Math.cos(dn[1])],ms=[Math.sin(nr[0]),Math.sin(nr[1])],Fa=[Math.cos(nr[0]),Math.cos(nr[1])],Ba=vi*xa[1]*xa[0]+qi*Fa[1]*Fa[0],cc=vi*xa[1]*da[0]+qi*Fa[1]*ms[0],ku=vi*da[1]+qi*ms[1];return[radiansToDegrees(Math.atan2(cc,Ba)),radiansToDegrees(Math.atan2(ku,Math.sqrt(Ba*Ba+cc*cc)))]}function of(tt,mt){let Xt=0;const dn=[];for(let qi=0;qi<tt.length-1;qi++){const da=tt[qi],xa=tt[qi+1],ms=af(da,xa),Fa=Xt;Xt+=ms,dn.push({p1:da,p2:xa,totalDistance:Xt,distance:ms,lastTotalDistance:Fa})}const nr=Xt*mt;let Br,vi;for(const qi of dn)if(qi.totalDistance>nr){const xa=qi.p1,ms=qi.p2,Fa=(nr-qi.lastTotalDistance)/qi.distance,Ba=lc(ms,xa,Fa);Br=Ba[0],vi=Ba[1];break}return{lng:Br,lat:vi,height:0}}function lc(tt,mt,Xt){return[tt[0]*Xt+mt[0]*(1-Xt),tt[1]*Xt+mt[1]*(1-Xt)]}function af(tt,mt){return Math.sqrt(Math.pow(tt[0]-mt[0],2)+Math.pow(tt[1]-mt[1],2))}var kl=Object.defineProperty,Pu=Object.getOwnPropertySymbols,yf=Object.prototype.hasOwnProperty,vh=Object.prototype.propertyIsEnumerable,$f=(tt,mt,Xt)=>mt in tt?kl(tt,mt,{enumerable:!0,configurable:!0,writable:!0,value:Xt}):tt[mt]=Xt,us=(tt,mt)=>{for(var Xt in mt||(mt={}))yf.call(mt,Xt)&&$f(tt,Xt,mt[Xt]);if(Pu)for(var Xt of Pu(mt))vh.call(mt,Xt)&&$f(tt,Xt,mt[Xt]);return tt};function jh(tt,mt){const{featureId:Xt}=mt;let dn=tt.data.dataArray;return typeof Xt=="number"&&(dn=dn.filter(({id:nr})=>nr===Xt)),dn.map(nr=>{const Br=gh(nr,mt);return us(us({},nr),Br)})}function Vh(tt,mt){return new Promise(Xt=>{tt.inited?Xt(jh(tt,mt)):tt.once("update",()=>{Xt(jh(tt,mt))})})}function gh(tt,mt){const{offset:Xt,shape:dn,thetaOffset:nr,segmentNumber:Br=30,autoFit:vi=!0}=mt,{coordinates:qi}=tt;if(dn==="line")return pathLineAtOffset(qi,Xt);const da=qi[0],xa=qi[1],ms=typeof nr=="string"?tt[nr]||0:nr;let Fa;switch(dn){case"arc":Fa=arcLineAtOffset;break;case"greatcircle":Fa=greatCircleLineAtOffset;break;default:Fa=arcLineAtOffset}const[Ba,cc,ku]=Fa(da,xa,Xt,ms,Br,vi);return{lng:Ba,lat:cc,height:ku}}var il=class{constructor(tt=50,mt){this.limit=tt,this.destroy=mt||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(tt=>{this.delete(tt)}),this.cache={},this.order=[]}get(tt){const mt=this.cache[tt];return mt&&(this.deleteOrder(tt),this.appendOrder(tt)),mt}set(tt,mt){this.cache[tt]?(this.delete(tt),this.cache[tt]=mt,this.appendOrder(tt)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[tt]=mt,this.appendOrder(tt))}delete(tt){const mt=this.cache[tt];mt&&(this.deleteCache(tt),this.deleteOrder(tt),this.destroy(mt,tt))}deleteCache(tt){delete this.cache[tt]}deleteOrder(tt){const mt=this.order.findIndex(Xt=>Xt===tt);mt>=0&&this.order.splice(mt,1)}appendOrder(tt){this.order.push(tt)}defaultDestroy(tt,mt){return null}};function Kf(tt){if(tt.length===0)throw new Error("max requires at least one data point");let mt=tt[0];for(let Xt=1;Xt<tt.length;Xt++)tt[Xt]>mt&&(mt=tt[Xt]);return mt*1}function Qf(tt){if(tt.length===0)throw new Error("min requires at least one data point");let mt=tt[0];for(let Xt=1;Xt<tt.length;Xt++)tt[Xt]<mt&&(mt=tt[Xt]);return mt*1}function K(tt){if(tt.length===0)return 0;let mt=tt[0]*1;for(let Xt=1;Xt<tt.length;Xt++)mt+=tt[Xt]*1;return mt}function lt(tt){if(tt.length===0)throw new Error("mean requires at least one data point");return K(tt)/tt.length}function It(tt){if(tt.length===0)throw new Error("mean requires at least one data point");if(tt.length<3)return tt[0];tt.sort();let mt=tt[0],Xt=NaN,dn=0,nr=1;for(let Br=1;Br<tt.length+1;Br++)tt[Br]!==mt?(nr>dn&&(dn=nr,Xt=mt),nr=1,mt=tt[Br]):nr++;return Xt*1}var Ke={min:Qf,max:Kf,mean:lt,sum:K,mode:It};function X(tt,mt){return tt.map(Xt=>Xt[mt])}function Xn(tt,mt){return Ke[tt](mt)}function Mr(tt,mt){mt===void 0&&(mt={});var Xt=Number(tt[0]),dn=Number(tt[1]),nr=Number(tt[2]),Br=Number(tt[3]);if(tt.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var vi=[Xt,dn],qi=[Xt,Br],da=[nr,Br],xa=[nr,dn];return(0,ca.yu)([[vi,xa,da,qi,vi]],mt.properties,{bbox:tt,id:mt.id})}var ki=it(26729),Jr=it.n(ki),co=(tt=>(tt.Realtime="realtime",tt.Overlap="overlap",tt.Replace="replace",tt))(co||{}),so=(tt=>(tt.Loading="Loading",tt.Loaded="Loaded",tt.Failure="Failure",tt.Cancelled="Cancelled",tt))(so||{}),sa=0,Po=1,_a=2;function qa(tt){tt.forEach(mt=>{mt.isCurrent&&(mt.isVisible=mt.isLoaded)})}function ra(tt){tt.forEach(mt=>{mt.properties.state=sa}),tt.forEach(mt=>{mt.isCurrent&&!ls(mt)&&Aa(mt)}),tt.forEach(mt=>{mt.isVisible=!!(mt.properties.state&_a)})}function ma(tt){tt.forEach(Xt=>{Xt.properties.state=sa}),tt.forEach(Xt=>{Xt.isCurrent&&ls(Xt)}),tt.slice().sort((Xt,dn)=>Xt.z-dn.z).forEach(Xt=>{Xt.isVisible=!!(Xt.properties.state&_a),Xt.children.length&&(Xt.isVisible||Xt.properties.state&Po)?Xt.children.forEach(dn=>{dn.properties.state=Po}):Xt.isCurrent&&Aa(Xt)})}function ls(tt){for(;tt;){if(tt.isLoaded)return tt.properties.state|=_a,!0;tt=tt.parent}return!1}function Aa(tt){tt.children.forEach(mt=>{mt.isLoaded?mt.properties.state|=_a:Aa(mt)})}var Ia=256,ka=[-1/0,-1/0,1/0,1/0],qs=.2,ks=5,Ec={[co.Realtime]:qa,[co.Overlap]:ra,[co.Replace]:ma},es=()=>{};function Iu(tt,mt,Xt){const dn=Math.floor((tt+180)/360*Math.pow(2,Xt)),nr=Math.floor((1-Math.log(Math.tan(mt*Math.PI/180)+1/Math.cos(mt*Math.PI/180))/Math.PI)/2*Math.pow(2,Xt));return[dn,nr]}function du(tt,mt,Xt){const dn=tt/Math.pow(2,Xt)*360-180,nr=Math.PI-2*Math.PI*mt/Math.pow(2,Xt),Br=180/Math.PI*Math.atan(.5*(Math.exp(nr)-Math.exp(-nr)));return[dn,Br]}var Lc=(tt,mt,Xt)=>{const[dn,nr]=du(tt,mt,Xt),[Br,vi]=du(tt+1,mt+1,Xt);return[dn,vi,Br,nr]};function Pf({zoom:tt,latLonBounds:mt,maxZoom:Xt=1/0,minZoom:dn=0,zoomOffset:nr=0,extent:Br=ka}){let vi=Math.ceil(tt)+nr;if(Number.isFinite(dn)&&vi<dn)return[];Number.isFinite(Xt)&&vi>Xt&&(vi=Xt);const[qi,da,xa,ms]=mt,Fa=[Math.max(qi,Br[0]),Math.max(da,Br[1]),Math.min(xa,Br[2]),Math.min(ms,Br[3])],Ba=[],[cc,ku]=Iu(Fa[0],Fa[1],vi),[$s,fo]=Iu(Fa[2],Fa[3],vi);for(let pl=cc;pl<=$s;pl++)for(let ns=fo;ns<=ku;ns++)Ba.push({x:pl,y:ns,z:vi});const ru=($s+cc)/2,Ed=(ku+fo)/2,th=(pl,ns)=>Math.abs(pl-ru)+Math.abs(ns-Ed);return Ba.sort((pl,ns)=>th(pl.x,pl.y)-th(ns.x,ns.y)),Ba}var Zh=(tt,mt,Xt,dn=!0)=>{const nr=Math.pow(2,Xt),Br=nr-1,vi=nr;let qi=tt;const da=mt;return dn&&(qi<0?qi=qi+vi:qi>Br&&(qi=qi%vi)),{warpX:qi,warpY:da}},Hh=(tt,mt,Xt)=>new Promise((dn,nr)=>{var Br=da=>{try{qi(Xt.next(da))}catch(xa){nr(xa)}},vi=da=>{try{qi(Xt.throw(da))}catch(xa){nr(xa)}},qi=da=>da.done?dn(da.value):Promise.resolve(da.value).then(Br,vi);qi((Xt=Xt.apply(tt,mt)).next())}),If=class extends ki.EventEmitter{constructor(tt){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:mt,y:Xt,z:dn,tileSize:nr,warp:Br=!0}=tt;this.x=mt,this.y=Xt,this.z=dn,this.warp=Br||!0,this.tileSize=nr}get isLoading(){return this.loadStatus===so.Loading}get isLoaded(){return this.loadStatus===so.Loaded}get isFailure(){return this.loadStatus===so.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===so.Cancelled}get isDone(){return[so.Loaded,so.Cancelled,so.Failure].includes(this.loadStatus)}get bounds(){return Lc(this.x,this.y,this.z)}get bboxPolygon(){const[tt,mt,Xt,dn]=this.bounds,nr=[(Xt-tt)/2,(dn-mt)/2];return Mr(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:nr,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(tt){return Hh(this,arguments,function*({getData:mt,onLoad:Xt,onError:dn}){this.loadDataId++;const nr=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=so.Loading;let Br=null,vi;try{const{x:qi,y:da,z:xa,bounds:ms,tileSize:Fa,warp:Ba}=this,{warpX:cc,warpY:ku}=Zh(qi,da,xa,Ba),{signal:$s}=this.abortController;Br=yield mt({x:cc,y:ku,z:xa,bounds:ms,tileSize:Fa,signal:$s,warp:Ba},this)}catch(qi){vi=qi}if(nr===this.loadDataId&&!(this.isCancelled&&!Br)){if(vi||!Br){this.loadStatus=so.Failure,dn(vi,this);return}this.loadStatus=so.Loaded,this.data=Br,Xt(this)}})}reloadData(tt){this.isLoading&&this.abortLoad(),this.loadData(tt)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=so.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},Lu=(tt,mt)=>{const Xt=tu(tt),dn=Jc(Xt,mt),nr=360*3-180,Br=85.0511287798065;return[Math.max(dn[0][0],-nr),Math.max(dn[0][1],-Br),Math.min(dn[1][0],nr),Math.min(dn[1][1],Br)]},Lf=(tt,mt)=>{const Xt=tu(tt),dn=tu(mt);return Ic(Xt,dn)},yh=Object.defineProperty,Du=Object.defineProperties,P0=Object.getOwnPropertyDescriptors,xd=Object.getOwnPropertySymbols,Dc=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable,gp=(tt,mt,Xt)=>mt in tt?yh(tt,mt,{enumerable:!0,configurable:!0,writable:!0,value:Xt}):tt[mt]=Xt,Wh=(tt,mt)=>{for(var Xt in mt||(mt={}))Dc.call(mt,Xt)&&gp(tt,Xt,mt[Xt]);if(xd)for(var Xt of xd(mt))Gh.call(mt,Xt)&&gp(tt,Xt,mt[Xt]);return tt},_h=(tt,mt)=>Du(tt,P0(mt)),{throttle:Nu}=Fe,Df=(tt=>(tt.TilesLoadStart="tiles-load-start",tt.TileLoaded="tile-loaded",tt.TileError="tile-error",tt.TileUnload="tile-unload",tt.TileUpdate="tile-update",tt.TilesLoadFinished="tiles-load-finished",tt))(Df||{}),Jf=class extends Jr(){constructor(tt){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=Nu((mt,Xt)=>{this.update(mt,Xt)},16),this.onTileLoad=mt=>{this.emit("tile-loaded",mt),this.updateTileVisible(),this.loadFinished()},this.onTileError=(mt,Xt)=>{this.emit("tile-error",{error:mt,tile:Xt}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=mt=>{this.emit("tile-unload",mt),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:ka,getTileData:es,warp:!0,updateStrategy:co.Replace},this.updateOptions(tt)}get isLoaded(){return this.currentTiles.every(tt=>tt.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((mt,Xt)=>mt.z-Xt.z)}updateOptions(tt){const mt=tt.minZoom===void 0?this.options.minZoom:Math.ceil(tt.minZoom),Xt=tt.maxZoom===void 0?this.options.maxZoom:Math.floor(tt.maxZoom);this.options=_h(Wh(Wh({},this.options),tt),{minZoom:mt,maxZoom:Xt})}update(tt,mt){const Xt=Math.max(0,Math.ceil(tt));if(this.lastViewStates&&this.lastViewStates.zoom===Xt&&Lf(this.lastViewStates.latLonBoundsBuffer,mt))return;const dn=Lu(mt,qs);this.lastViewStates={zoom:Xt,latLonBounds:mt,latLonBoundsBuffer:dn},this.currentZoom=Xt;let nr=!1;const Br=this.getTileIndices(Xt,dn).filter(vi=>this.options.warp||vi.x>=0&&vi.x<Math.pow(2,Xt));this.emit("tiles-load-start"),this.currentTiles=Br.map(({x:vi,y:qi,z:da})=>{let xa=this.getTile(vi,qi,da);return xa?(((xa==null?void 0:xa.isFailure)||(xa==null?void 0:xa.isCancelled))&&xa.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),xa):(xa=this.createTile(vi,qi,da),nr=!0,xa)}),nr&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[tt,mt]of this.cacheTiles){if(!this.currentTiles.includes(mt)){this.cacheTiles.delete(tt),this.onTileUnload(mt);return}this.onTileUnload(mt),mt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(tt,mt,Xt){const dn=this.cacheTiles.get(`${mt},${Xt},${tt}`);dn&&(this.onTileUnload(dn),dn.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(tt,mt,Xt){const dn=this.getTileByLngLat(tt,mt,Xt);dn&&this.reloadTileById(dn.z,dn.x,dn.y)}reloadTileByExtent(tt,mt){this.getTileIndices(mt,tt).forEach(dn=>{this.reloadTileById(dn.z,dn.x,dn.y)})}pruneRequests(){const tt=[];for(const mt of this.cacheTiles.values())mt.isLoading&&!mt.isCurrent&&!mt.isVisible&&tt.push(mt);for(;tt.length>0;)tt.shift().abortLoad()}getTileByLngLat(tt,mt,Xt){const{zoomOffset:dn}=this.options,nr=Math.ceil(Xt)+dn,Br=Iu(tt,mt,nr);return this.tiles.filter(qi=>qi.key===`${Br[0]}_${Br[1]}_${nr}`)[0]}getTileExtent(tt,mt){return this.getTileIndices(mt,tt)}getTileByZXY(tt,mt,Xt){return this.tiles.filter(nr=>nr.key===`${mt}_${Xt}_${tt}`)[0]}clear(){for(const tt of this.cacheTiles.values())tt.isLoading?tt.abortLoad():this.onTileUnload(tt);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const tt=this.options.updateStrategy,mt=new Map;for(const nr of this.cacheTiles.values())mt.set(nr.key,nr.isVisible),nr.isCurrent=!1,nr.isVisible=!1;for(const nr of this.currentTiles)nr.isCurrent=!0,nr.isVisible=!0;const Xt=Array.from(this.cacheTiles.values());typeof tt=="function"?tt(Xt):Ec[tt](Xt);let dn=!1;Array.from(this.cacheTiles.values()).forEach(nr=>{nr.isVisible!==mt.get(nr.key)?(nr.isVisibleChange=!0,dn=!0):nr.isVisibleChange=!1}),dn&&this.emit("tile-update")}getTileIndices(tt,mt){const{tileSize:Xt,extent:dn,zoomOffset:nr}=this.options,Br=Math.floor(this.options.maxZoom),vi=Math.ceil(this.options.minZoom);return Pf({maxZoom:Br,minZoom:vi,zoomOffset:nr,tileSize:Xt,zoom:tt,latLonBounds:mt,extent:dn})}getTileId(tt,mt,Xt){return`${tt},${mt},${Xt}`}loadFinished(){const tt=!this.currentTiles.some(mt=>!mt.isDone);return tt&&this.emit("tiles-load-finished"),tt}getTile(tt,mt,Xt){const dn=this.getTileId(tt,mt,Xt);return this.cacheTiles.get(dn)}createTile(tt,mt,Xt){const dn=this.getTileId(tt,mt,Xt),nr=new If({x:tt,y:mt,z:Xt,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(dn,nr),nr.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),nr}resizeCacheTiles(){const tt=ks*this.currentTiles.length;if(this.cacheTiles.size>tt){for(const[Xt,dn]of this.cacheTiles)if(!dn.isVisible&&!this.currentTiles.includes(dn)&&(this.cacheTiles.delete(Xt),this.onTileUnload(dn)),this.cacheTiles.size<=tt)break}this.rebuildTileTree()}rebuildTileTree(){for(const tt of this.cacheTiles.values())tt.parent=null,tt.children.length=0;for(const tt of this.cacheTiles.values()){const mt=this.getNearestAncestor(tt.x,tt.y,tt.z);tt.parent=mt,mt!=null&&mt.children&&mt.children.push(tt)}}getNearestAncestor(tt,mt,Xt){for(;Xt>this.options.minZoom;){tt=Math.floor(tt/2),mt=Math.floor(mt/2),Xt=Xt-1;const dn=this.getTile(tt,mt,Xt);if(dn)return dn}return null}};function Yp(tt){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(tt)}function Nf(tt){const mt=[];let Xt=/\{([a-z])-([a-z])\}/.exec(tt);if(Xt){const dn=Xt[1].charCodeAt(0),nr=Xt[2].charCodeAt(0);let Br;for(Br=dn;Br<=nr;++Br)mt.push(tt.replace(Xt[0],String.fromCharCode(Br)));return mt}if(Xt=/\{(\d+)-(\d+)\}/.exec(tt),Xt){const dn=parseInt(Xt[2],10);for(let nr=parseInt(Xt[1],10);nr<=dn;nr++)mt.push(tt.replace(Xt[0],nr.toString()));return mt}return mt.push(tt),mt}function $a(tt,mt){if(!tt||!tt.length)throw new Error("url is not allowed to be empty");const{x:Xt,y:dn,z:nr}=mt,Br=Nf(tt),vi=Math.abs(Xt+dn)%Br.length;return(Ie(Br[vi])?`${Br[vi]}/{z}/{x}/{y}`:Br[vi]).replace(/\{x\}/g,Xt.toString()).replace(/\{y\}/g,dn.toString()).replace(/\{z\}/g,nr.toString()).replace(/\{bbox\}/g,Lc(Xt,dn,nr).join(",")).replace(/\{-y\}/g,(Math.pow(2,nr)-dn-1).toString())}function bd(tt,mt){const{x:Xt,y:dn,z:nr,layer:Br,version:vi="1.0.0",style:qi="default",format:da,service:xa="WMTS",tileMatrixset:ms}=mt,Fa=Nf(tt),Ba=Math.abs(Xt+dn)%Fa.length;return`${Fa[Ba]}&SERVICE=${xa}&REQUEST=GetTile&VERSION=${vi}&LAYER=${Br}&STYLE=${qi}&TILEMATRIXSET=${ms}&FORMAT=${da}&TILECOL=${Xt}&TILEROW=${dn}&TILEMATRIX=${nr}`}function pu(tt,mt){return tt==null?mt:tt}},48271:function(br,rr,it){"use strict";it.d(rr,{oT:function(){return la},Ie:function(){return Ex},dW:function(){return gg},GI:function(){return TE},xs:function(){return OS}});var ne={},pt={},R=a=>pt[a],$e=(a,o)=>{pt[a]=o},yt=a=>ne[a],xe=(a,o)=>{ne[a]=o},le={},Le={},Lt=34,fn=10,Nt=13;function Jt(a){return new Function("d","return {"+a.map(function(o,f){return JSON.stringify(o)+": d["+f+'] || ""'}).join(",")+"}")}function Ie(a,o){var f=Jt(a);return function(v,S){return o(f(v),S,a)}}function fe(a){var o=Object.create(null),f=[];return a.forEach(function(v){for(var S in v)S in o||f.push(o[S]=S)}),f}function ce(a,o){var f=a+"",v=f.length;return v<o?new Array(o-v+1).join(0)+f:f}function ve(a){return a<0?"-"+ce(-a,6):a>9999?"+"+ce(a,6):ce(a,4)}function Ze(a){var o=a.getUTCHours(),f=a.getUTCMinutes(),v=a.getUTCSeconds(),S=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":ve(a.getUTCFullYear(),4)+"-"+ce(a.getUTCMonth()+1,2)+"-"+ce(a.getUTCDate(),2)+(S?"T"+ce(o,2)+":"+ce(f,2)+":"+ce(v,2)+"."+ce(S,3)+"Z":v?"T"+ce(o,2)+":"+ce(f,2)+":"+ce(v,2)+"Z":f||o?"T"+ce(o,2)+":"+ce(f,2)+"Z":"")}function Un(a){var o=new RegExp('["'+a+`
\r]`),f=a.charCodeAt(0);function v(ft,Tt){var se,Ve,yn=S(ft,function(lr,Nr){if(se)return se(lr,Nr-1);Ve=lr,se=Tt?Ie(lr,Tt):Jt(lr)});return yn.columns=Ve||[],yn}function S(ft,Tt){var se=[],Ve=ft.length,yn=0,lr=0,Nr,Ln=Ve<=0,ci=!1;ft.charCodeAt(Ve-1)===fn&&--Ve,ft.charCodeAt(Ve-1)===Nt&&--Ve;function Fi(){if(Ln)return Le;if(ci)return ci=!1,le;var Ji,Vr=yn,Hi;if(ft.charCodeAt(Vr)===Lt){for(;yn++<Ve&&ft.charCodeAt(yn)!==Lt||ft.charCodeAt(++yn)===Lt;);return(Ji=yn)>=Ve?Ln=!0:(Hi=ft.charCodeAt(yn++))===fn?ci=!0:Hi===Nt&&(ci=!0,ft.charCodeAt(yn)===fn&&++yn),ft.slice(Vr+1,Ji-1).replace(/""/g,'"')}for(;yn<Ve;){if((Hi=ft.charCodeAt(Ji=yn++))===fn)ci=!0;else if(Hi===Nt)ci=!0,ft.charCodeAt(yn)===fn&&++yn;else if(Hi!==f)continue;return ft.slice(Vr,Ji)}return Ln=!0,ft.slice(Vr,Ve)}for(;(Nr=Fi())!==Le;){for(var So=[];Nr!==le&&Nr!==Le;)So.push(Nr),Nr=Fi();Tt&&(So=Tt(So,lr++))==null||se.push(So)}return se}function O(ft,Tt){return ft.map(function(se){return Tt.map(function(Ve){return st(se[Ve])}).join(a)})}function L(ft,Tt){return Tt==null&&(Tt=fe(ft)),[Tt.map(st).join(a)].concat(O(ft,Tt)).join(`
`)}function k(ft,Tt){return Tt==null&&(Tt=fe(ft)),O(ft,Tt).join(`
`)}function V(ft){return ft.map(Q).join(`
`)}function Q(ft){return ft.map(st).join(a)}function st(ft){return ft==null?"":ft instanceof Date?Ze(ft):o.test(ft+="")?'"'+ft.replace(/"/g,'""')+'"':ft}return{parse:v,parseRows:S,format:L,formatBody:k,formatRows:V,formatRow:Q,formatValue:st}}var En=Un(","),Vn=En.parse,mr=En.parseRows,or=En.format,He=En.formatBody,$t=En.formatRows,nn=En.formatRow,ke=En.formatValue,Je=it(1449);function er(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kt(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Te(a){if(a.length>1&&isNumber(a[0])&&isNumber(a[1]))return!0;if(Array.isArray(a[0])&&a[0].length)return Te(a[0]);throw new Error("coordinates must only contain numbers")}function gt(a,o,f){if(!o||!f)throw new Error("type and name required");if(!a||a.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.type)}function te(a,o,f){if(!a)throw new Error("No feature passed");if(!f)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!a.geometry||a.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.geometry.type)}function Zt(a,o,f){if(!a)throw new Error("No featureCollection passed");if(!f)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+f+", FeatureCollection required");for(var v=0,S=a.features;v<S.length;v++){var O=S[v];if(!O||O.type!=="Feature"||!O.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!O.geometry||O.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+O.geometry.type)}}function Ut(a){return a.type==="Feature"?a.geometry:a}function we(a,o){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}var ie=it(39034),_t=it(8543),Ne=it(38163),un=it.n(Ne);function Qn(a,o){return a.map(f=>f[o]*1)}function hr(a){return a===void 0?!1:!Array.isArray(a)&&a.data!==void 0}function Er(a){return Array.isArray(a)?a.length===0?!1:!!hr(a[0]):!1}function Ue(a){return Array.isArray(a)?a.length===0||typeof a[0]=="number":!1}function cn(a){const o=Object.isFrozen(a)?_t.lodashUtil.cloneDeep(a):a;return un()(o,!0),o}function wn(a,o){return a||[[o[0],o[3]],[o[2],o[3]],[o[2],o[1]],[o[0],o[1]]]}var ir=Object.defineProperty,rn=Object.defineProperties,De=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,At=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable,Ae=(a,o,f)=>o in a?ir(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,z=(a,o)=>{for(var f in o||(o={}))At.call(o,f)&&Ae(a,f,o[f]);if(Be)for(var f of Be(o))Bt.call(o,f)&&Ae(a,f,o[f]);return a},rt=(a,o)=>rn(a,De(o));function F(a,o){const{x:f,y:v,x1:S,y1:O,coordinates:L,geometry:k}=o,V=[];if(!Array.isArray(a))return{dataArray:[]};if(k)return a.filter(Q=>Q[k]&&Q[k].type&&Q[k].coordinates&&Q[k].coordinates.length>0).forEach((Q,st)=>{const ft=cn(Q[k]);(0,ie.nG)(ft,Tt=>{const se=kt(Tt),Ve=rt(z({},Q),{_id:st,coordinates:se});V.push(Ve)})}),{dataArray:V};for(let Q=0;Q<a.length;Q++){const st=a[Q];let ft=[];if(L){let se="Polygon";Array.isArray(L[0])||(se="Point"),Array.isArray(L[0])&&!Array.isArray(L[0][0])&&(se="LineString"),ft=cn({type:se,coordinates:st[L]}).coordinates}else if(f&&v&&S&&O){const se=[parseFloat(st[f]),parseFloat(st[v])],Ve=[parseFloat(st[S]),parseFloat(st[O])];ft=[se,Ve]}else f&&v&&(ft=[parseFloat(st[f]),parseFloat(st[v])]);const Tt=rt(z({},st),{_id:Q,coordinates:ft});V.push(Tt)}return{dataArray:V}}function ot(a,o){const f=Vn(a);return F(f,o)}var ze=Object.defineProperty,Vt=Object.defineProperties,ae=Object.getOwnPropertyDescriptors,Mn=Object.getOwnPropertySymbols,zn=Object.prototype.hasOwnProperty,Wn=Object.prototype.propertyIsEnumerable,sn=(a,o,f)=>o in a?ze(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Kt=(a,o)=>{for(var f in o||(o={}))zn.call(o,f)&&sn(a,f,o[f]);if(Mn)for(var f of Mn(o))Wn.call(o,f)&&sn(a,f,o[f]);return a},Ce=(a,o)=>Vt(a,ae(o));function xn(a){const o=a.toString();let f=5381,v=o.length;for(;v;)f=f*33^o.charCodeAt(--v);return f>>>0}function Cn(a,o){return o===void 0?null:typeof(a.properties[o]*1)=="number"?a.properties[o]*1:a.properties&&a.properties[o]?xn(a.properties[o]+"")%1000019:null}function Zn(a,o){const f=[],v={};return a.features?(a.features=a.features.filter(S=>{const O=S.geometry;return S!=null&&O&&O.type&&O.coordinates&&O.coordinates.length>0}),a=cn(a),a.features.length===0?{dataArray:[],featureKeys:v}:((0,ie.nG)(a,(S,O)=>{let L=Cn(S,o==null?void 0:o.featureId);L===null&&(L=O);const k=L,V=kt(S),Q=Ce(Kt({},S.properties),{coordinates:V,_id:k});f.push(Q)}),{dataArray:f,featureKeys:v})):(a.features=[],{dataArray:[]})}function Qt(a,o,f,v){for(var S=v,O=f-o>>1,L=f-o,k,V=a[o],Q=a[o+1],st=a[f],ft=a[f+1],Tt=o+3;Tt<f;Tt+=3){var se=ct(a[Tt],a[Tt+1],V,Q,st,ft);if(se>S)k=Tt,S=se;else if(se===S){var Ve=Math.abs(Tt-O);Ve<L&&(k=Tt,L=Ve)}}S>v&&(k-o>3&&Qt(a,o,k,v),a[k+2]=S,f-k>3&&Qt(a,k,f,v))}function ct(a,o,f,v,S,O){var L=S-f,k=O-v;if(L!==0||k!==0){var V=((a-f)*L+(o-v)*k)/(L*L+k*k);V>1?(f=S,v=O):V>0&&(f+=L*V,v+=k*V)}return L=a-f,k=o-v,L*L+k*k}function bt(a,o,f,v){var S={id:typeof a=="undefined"?null:a,type:o,geometry:f,tags:v,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return zt(S),S}function zt(a){var o=a.geometry,f=a.type;if(f==="Point"||f==="MultiPoint"||f==="LineString")me(a,o);else if(f==="Polygon"||f==="MultiLineString")for(var v=0;v<o.length;v++)me(a,o[v]);else if(f==="MultiPolygon")for(v=0;v<o.length;v++)for(var S=0;S<o[v].length;S++)me(a,o[v][S])}function me(a,o){for(var f=0;f<o.length;f+=3)a.minX=Math.min(a.minX,o[f]),a.minY=Math.min(a.minY,o[f+1]),a.maxX=Math.max(a.maxX,o[f]),a.maxY=Math.max(a.maxY,o[f+1])}function de(a,o){var f=[];if(a.type==="FeatureCollection")for(var v=0;v<a.features.length;v++)bn(f,a.features[v],o,v);else a.type==="Feature"?bn(f,a,o):bn(f,{geometry:a},o);return f}function bn(a,o,f,v){if(o.geometry){var S=o.geometry.coordinates,O=o.geometry.type,L=Math.pow(f.tolerance/((1<<f.maxZoom)*f.extent),2),k=[],V=o.id;if(f.promoteId?V=o.properties[f.promoteId]:f.generateId&&(V=v||0),O==="Point")qn(S,k);else if(O==="MultiPoint")for(var Q=0;Q<S.length;Q++)qn(S[Q],k);else if(O==="LineString")Sr(S,k,L,!1);else if(O==="MultiLineString")if(f.lineMetrics){for(Q=0;Q<S.length;Q++)k=[],Sr(S[Q],k,L,!1),a.push(bt(V,"LineString",k,o.properties));return}else Gn(S,k,L,!1);else if(O==="Polygon")Gn(S,k,L,!0);else if(O==="MultiPolygon")for(Q=0;Q<S.length;Q++){var st=[];Gn(S[Q],st,L,!0),k.push(st)}else if(O==="GeometryCollection"){for(Q=0;Q<o.geometry.geometries.length;Q++)bn(a,{id:V,geometry:o.geometry.geometries[Q],properties:o.properties},f,v);return}else throw new Error("Input data is not a valid GeoJSON object.");a.push(bt(V,O,k,o.properties))}}function qn(a,o){o.push(ht(a[0])),o.push(ut(a[1])),o.push(0)}function Sr(a,o,f,v){for(var S,O,L=0,k=0;k<a.length;k++){var V=ht(a[k][0]),Q=ut(a[k][1]);o.push(V),o.push(Q),o.push(0),k>0&&(v?L+=(S*Q-V*O)/2:L+=Math.sqrt(Math.pow(V-S,2)+Math.pow(Q-O,2))),S=V,O=Q}var st=o.length-3;o[2]=1,Qt(o,0,st,f),o[st+2]=1,o.size=Math.abs(L),o.start=0,o.end=o.size}function Gn(a,o,f,v){for(var S=0;S<a.length;S++){var O=[];Sr(a[S],O,f,v),o.push(O)}}function ht(a){return a/360+.5}function ut(a){var o=Math.sin(a*Math.PI/180),f=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return f<0?0:f>1?1:f}function wt(a,o,f,v,S,O,L,k){if(f/=o,v/=o,O>=f&&L<v)return a;if(L<f||O>=v)return null;for(var V=[],Q=0;Q<a.length;Q++){var st=a[Q],ft=st.geometry,Tt=st.type,se=S===0?st.minX:st.minY,Ve=S===0?st.maxX:st.maxY;if(se>=f&&Ve<v){V.push(st);continue}else if(Ve<f||se>=v)continue;var yn=[];if(Tt==="Point"||Tt==="MultiPoint")Gt(ft,yn,f,v,S);else if(Tt==="LineString")ue(ft,yn,f,v,S,!1,k.lineMetrics);else if(Tt==="MultiLineString")ln(ft,yn,f,v,S,!1);else if(Tt==="Polygon")ln(ft,yn,f,v,S,!0);else if(Tt==="MultiPolygon")for(var lr=0;lr<ft.length;lr++){var Nr=[];ln(ft[lr],Nr,f,v,S,!0),Nr.length&&yn.push(Nr)}if(yn.length){if(k.lineMetrics&&Tt==="LineString"){for(lr=0;lr<yn.length;lr++)V.push(bt(st.id,Tt,yn[lr],st.tags));continue}(Tt==="LineString"||Tt==="MultiLineString")&&(yn.length===1?(Tt="LineString",yn=yn[0]):Tt="MultiLineString"),(Tt==="Point"||Tt==="MultiPoint")&&(Tt=yn.length===3?"Point":"MultiPoint"),V.push(bt(st.id,Tt,yn,st.tags))}}return V.length?V:null}function Gt(a,o,f,v,S){for(var O=0;O<a.length;O+=3){var L=a[O+S];L>=f&&L<=v&&(o.push(a[O]),o.push(a[O+1]),o.push(a[O+2]))}}function ue(a,o,f,v,S,O,L){for(var k=Ge(a),V=S===0?Fe:Hn,Q=a.start,st,ft,Tt=0;Tt<a.length-3;Tt+=3){var se=a[Tt],Ve=a[Tt+1],yn=a[Tt+2],lr=a[Tt+3],Nr=a[Tt+4],Ln=S===0?se:Ve,ci=S===0?lr:Nr,Fi=!1;L&&(st=Math.sqrt(Math.pow(se-lr,2)+Math.pow(Ve-Nr,2))),Ln<f?ci>f&&(ft=V(k,se,Ve,lr,Nr,f),L&&(k.start=Q+st*ft)):Ln>v?ci<v&&(ft=V(k,se,Ve,lr,Nr,v),L&&(k.start=Q+st*ft)):ee(k,se,Ve,yn),ci<f&&Ln>=f&&(ft=V(k,se,Ve,lr,Nr,f),Fi=!0),ci>v&&Ln<=v&&(ft=V(k,se,Ve,lr,Nr,v),Fi=!0),!O&&Fi&&(L&&(k.end=Q+st*ft),o.push(k),k=Ge(a)),L&&(Q+=st)}var So=a.length-3;se=a[So],Ve=a[So+1],yn=a[So+2],Ln=S===0?se:Ve,Ln>=f&&Ln<=v&&ee(k,se,Ve,yn),So=k.length-3,O&&So>=3&&(k[So]!==k[0]||k[So+1]!==k[1])&&ee(k,k[0],k[1],k[2]),k.length&&o.push(k)}function Ge(a){var o=[];return o.size=a.size,o.start=a.start,o.end=a.end,o}function ln(a,o,f,v,S,O){for(var L=0;L<a.length;L++)ue(a[L],o,f,v,S,O,!1)}function ee(a,o,f,v){a.push(o),a.push(f),a.push(v)}function Fe(a,o,f,v,S,O){var L=(O-o)/(v-o);return a.push(O),a.push(f+(S-f)*L),a.push(1),L}function Hn(a,o,f,v,S,O){var L=(O-f)/(S-f);return a.push(o+(v-o)*L),a.push(O),a.push(1),L}function Tr(a,o){var f=o.buffer/o.extent,v=a,S=wt(a,1,-1-f,f,0,-1,2,o),O=wt(a,1,1-f,2+f,0,-1,2,o);return(S||O)&&(v=wt(a,1,-f,1+f,0,-1,2,o)||[],S&&(v=Zr(S,1).concat(v)),O&&(v=v.concat(Zr(O,-1)))),v}function Zr(a,o){for(var f=[],v=0;v<a.length;v++){var S=a[v],O=S.type,L;if(O==="Point"||O==="MultiPoint"||O==="LineString")L=vr(S.geometry,o);else if(O==="MultiLineString"||O==="Polygon"){L=[];for(var k=0;k<S.geometry.length;k++)L.push(vr(S.geometry[k],o))}else if(O==="MultiPolygon")for(L=[],k=0;k<S.geometry.length;k++){for(var V=[],Q=0;Q<S.geometry[k].length;Q++)V.push(vr(S.geometry[k][Q],o));L.push(V)}f.push(bt(S.id,O,L,S.tags))}return f}function vr(a,o){var f=[];f.size=a.size,a.start!==void 0&&(f.start=a.start,f.end=a.end);for(var v=0;v<a.length;v+=3)f.push(a[v]+o,a[v+1],a[v+2]);return f}function Ur(a,o){if(a.transformed)return a;var f=1<<a.z,v=a.x,S=a.y,O,L,k;for(O=0;O<a.features.length;O++){var V=a.features[O],Q=V.geometry,st=V.type;if(V.geometry=[],st===1)for(L=0;L<Q.length;L+=2)V.geometry.push(jr(Q[L],Q[L+1],o,f,v,S));else for(L=0;L<Q.length;L++){var ft=[];for(k=0;k<Q[L].length;k+=2)ft.push(jr(Q[L][k],Q[L][k+1],o,f,v,S));V.geometry.push(ft)}}return a.transformed=!0,a}function jr(a,o,f,v,S,O){return[Math.round(f*(a*v-S)),Math.round(f*(o*v-O))]}function ni(a,o,f,v,S){for(var O=o===S.maxZoom?0:S.tolerance/((1<<o)*S.extent),L={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:f,y:v,z:o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},k=0;k<a.length;k++){L.numFeatures++,Ar(L,a[k],O,S);var V=a[k].minX,Q=a[k].minY,st=a[k].maxX,ft=a[k].maxY;V<L.minX&&(L.minX=V),Q<L.minY&&(L.minY=Q),st>L.maxX&&(L.maxX=st),ft>L.maxY&&(L.maxY=ft)}return L}function Ar(a,o,f,v){var S=o.geometry,O=o.type,L=[];if(O==="Point"||O==="MultiPoint")for(var k=0;k<S.length;k+=3)L.push(S[k]),L.push(S[k+1]),a.numPoints++,a.numSimplified++;else if(O==="LineString")pi(L,S,a,f,!1,!1);else if(O==="MultiLineString"||O==="Polygon")for(k=0;k<S.length;k++)pi(L,S[k],a,f,O==="Polygon",k===0);else if(O==="MultiPolygon")for(var V=0;V<S.length;V++){var Q=S[V];for(k=0;k<Q.length;k++)pi(L,Q[k],a,f,!0,k===0)}if(L.length){var st=o.tags||null;if(O==="LineString"&&v.lineMetrics){st={};for(var ft in o.tags)st[ft]=o.tags[ft];st.mapbox_clip_start=S.start/S.size,st.mapbox_clip_end=S.end/S.size}var Tt={geometry:L,type:O==="Polygon"||O==="MultiPolygon"?3:O==="LineString"||O==="MultiLineString"?2:1,tags:st};o.id!==null&&(Tt.id=o.id),a.features.push(Tt)}}function pi(a,o,f,v,S,O){var L=v*v;if(v>0&&o.size<(S?L:v)){f.numPoints+=o.length/3;return}for(var k=[],V=0;V<o.length;V+=3)(v===0||o[V+2]>L)&&(f.numSimplified++,k.push(o[V]),k.push(o[V+1])),f.numPoints++;S&&mi(k,O),a.push(k)}function mi(a,o){for(var f=0,v=0,S=a.length,O=S-2;v<S;O=v,v+=2)f+=(a[v]-a[O])*(a[v+1]+a[O+1]);if(f>0===o)for(v=0,S=a.length;v<S/2;v+=2){var L=a[v],k=a[v+1];a[v]=a[S-2-v],a[v+1]=a[S-1-v],a[S-2-v]=L,a[S-1-v]=k}}function xi(a,o){return new wo(a,o)}function wo(a,o){o=this.options=aa(Object.create(this.options),o);var f=o.debug;if(f&&console.time("preprocess data"),o.maxZoom<0||o.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(o.promoteId&&o.generateId)throw new Error("promoteId and generateId cannot be used together.");var v=de(a,o);this.tiles={},this.tileCoords=[],f&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",o.indexMaxZoom,o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),v=Tr(v,o),v.length&&this.splitTile(v,0,0,0),f&&(v.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}wo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wo.prototype.splitTile=function(a,o,f,v,S,O,L){for(var k=[a,o,f,v],V=this.options,Q=V.debug;k.length;){v=k.pop(),f=k.pop(),o=k.pop(),a=k.pop();var st=1<<o,ft=Li(o,f,v),Tt=this.tiles[ft];if(!Tt&&(Q>1&&console.time("creation"),Tt=this.tiles[ft]=ni(a,o,f,v,V),this.tileCoords.push({z:o,x:f,y:v}),Q)){Q>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",o,f,v,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));var se="z"+o;this.stats[se]=(this.stats[se]||0)+1,this.total++}if(Tt.source=a,S){if(o===V.maxZoom||o===S)continue;var Ve=1<<S-o;if(f!==Math.floor(O/Ve)||v!==Math.floor(L/Ve))continue}else if(o===V.indexMaxZoom||Tt.numPoints<=V.indexMaxPoints)continue;if(Tt.source=null,a.length!==0){Q>1&&console.time("clipping");var yn=.5*V.buffer/V.extent,lr=.5-yn,Nr=.5+yn,Ln=1+yn,ci,Fi,So,Ji,Vr,Hi;ci=Fi=So=Ji=null,Vr=wt(a,st,f-yn,f+Nr,0,Tt.minX,Tt.maxX,V),Hi=wt(a,st,f+lr,f+Ln,0,Tt.minX,Tt.maxX,V),a=null,Vr&&(ci=wt(Vr,st,v-yn,v+Nr,1,Tt.minY,Tt.maxY,V),Fi=wt(Vr,st,v+lr,v+Ln,1,Tt.minY,Tt.maxY,V),Vr=null),Hi&&(So=wt(Hi,st,v-yn,v+Nr,1,Tt.minY,Tt.maxY,V),Ji=wt(Hi,st,v+lr,v+Ln,1,Tt.minY,Tt.maxY,V),Hi=null),Q>1&&console.timeEnd("clipping"),k.push(ci||[],o+1,f*2,v*2),k.push(Fi||[],o+1,f*2,v*2+1),k.push(So||[],o+1,f*2+1,v*2),k.push(Ji||[],o+1,f*2+1,v*2+1)}}},wo.prototype.getTile=function(a,o,f){var v=this.options,S=v.extent,O=v.debug;if(a<0||a>24)return null;var L=1<<a;o=(o%L+L)%L;var k=Li(a,o,f);if(this.tiles[k])return Ur(this.tiles[k],S);O>1&&console.log("drilling down to z%d-%d-%d",a,o,f);for(var V=a,Q=o,st=f,ft;!ft&&V>0;)V--,Q=Math.floor(Q/2),st=Math.floor(st/2),ft=this.tiles[Li(V,Q,st)];return!ft||!ft.source?null:(O>1&&console.log("found parent tile z%d-%d-%d",V,Q,st),O>1&&console.time("drilling down"),this.splitTile(ft.source,V,Q,st,a,o,f),O>1&&console.timeEnd("drilling down"),this.tiles[k]?Ur(this.tiles[k],S):null)};function Li(a,o,f){return((1<<a)*f+o)*32+a}function aa(a,o){for(var f in o)a[f]=o[f];return a}var Pa=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=a}getTileData(a){return!a||!this.vectorTile.layers[a]?[]:this.vectorLayerCache[a]?this.vectorLayerCache[a]:this.vectorTile.layers[a].features}getFeatureById(){throw new Error("Method not implemented.")}},Lo=Object.defineProperty,$o=Object.defineProperties,Mt=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable,Rn=(a,o,f)=>o in a?Lo(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Pn=(a,o)=>{for(var f in o||(o={}))Se.call(o,f)&&Rn(a,f,o[f]);if(Wt)for(var f of Wt(o))qe.call(o,f)&&Rn(a,f,o[f]);return a},tn=(a,o)=>$o(a,Mt(o)),mn=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),dr={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function fr(a){let o=0;for(let f=0,v=a.length,S=v-1,O,L;f<v;S=f++)O=a[f],L=a[S],o+=(L.x-O.x)*(O.y+L.y);return o}function ai(a){const o=a.length;if(o<=1)return[a];const f=[];let v,S;for(let O=0;O<o;O++){const L=fr(a[O]);L!==0&&(S===void 0&&(S=L<0),S===L<0?(v&&f.push(v),v=[a[O]]):v.push(a[O]))}return v&&f.push(v),f}var Vi=["Unknown","Point","LineString","Polygon"];function mo(a,o,f,v,S){let O=S.geometry;const L=S.type,k=S.tags,V=S.id,Q=a*Math.pow(2,v),st=a*o,ft=a*f;let Tt=Vi[L],se,Ve;function yn(Nr){for(let Ln=0;Ln<Nr.length;Ln++){const ci=Nr[Ln];if(ci[3])break;const Fi=180-(ci[1]+ft)*360/Q,So=(ci[0]+st)*360/Q-180,Ji=360/Math.PI*Math.atan(Math.exp(Fi*Math.PI/180))-90;Nr[Ln]=[So,Ji,0,1]}}switch(L){case 1:const Nr=[];for(se=0;se<O.length;se++)Nr[se]=O[se][0];O=Nr,yn(O);break;case 2:for(se=0;se<O.length;se++)yn(O[se]);break;case 3:for(O=ai(O),se=0;se<O.length;se++)for(Ve=0;Ve<O[se].length;Ve++)yn(O[se][Ve]);break}return O.length===1?O=O[0]:Tt="Multi"+Tt,{type:"Feature",geometry:{type:Tt,coordinates:O},properties:k,id:V,tileOrigin:[0,0],coord:""}}var si=(a,o,f,v)=>mn(void 0,null,function*(){return new Promise(S=>{const O=o.getTile(a.z,a.x,a.y),k={layers:{defaultLayer:{features:O?O.features.map(Q=>mo(v,f.x,f.y,f.z,Q)):[]}}},V=new Pa(k,a.x,a.y,a.z);S(V)})});function Wi(a){const o={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return a===void 0||typeof a.geojsonvtOptions=="undefined"?o:Pn(Pn({},o),a.geojsonvtOptions)}function Ui(a,o){const f=Wi(o),v=f.extent||4096,S=xi(a,f),O=(k,V)=>si(V,S,k,v),L=tn(Pn(Pn({},dr),o),{getTileData:O});return{data:a,dataArray:[],tilesetOptions:L,isTile:!0}}var Xr=Object.defineProperty,bo=Object.defineProperties,Ni=Object.getOwnPropertyDescriptors,Eo=Object.getOwnPropertySymbols,Xi=Object.prototype.hasOwnProperty,Mo=Object.prototype.propertyIsEnumerable,Xo=(a,o,f)=>o in a?Xr(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,wl=(a,o)=>{for(var f in o||(o={}))Xi.call(o,f)&&Xo(a,f,o[f]);if(Eo)for(var f of Eo(o))Mo.call(o,f)&&Xo(a,f,o[f]);return a},Ya=(a,o)=>bo(a,Ni(o));function ca(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,requestParameters:S={}}=o,O=new Promise(V=>{a instanceof HTMLImageElement||(0,_t.fg)(a)?V([a]):ws(a,S,Q=>{V(Q)})}),L=wn(v,f);return{originData:a,images:O,_id:1,dataArray:[{_id:0,coordinates:L}]}}function ws(a,o,f){const v=[];if(typeof a=="string")(0,_t.gJ)(Ya(wl({},o),{url:a}),(S,O)=>{O&&(v.push(O),f(v))});else{const S=a.length;let O=0;a.forEach(L=>{(0,_t.gJ)(Ya(wl({},o),{url:L}),(k,V)=>{O++,V&&v.push(V),O===S&&f(v)})})}return ca}var Ms=Object.defineProperty,re=Object.defineProperties,ge=Object.getOwnPropertyDescriptors,An=Object.getOwnPropertySymbols,tr=Object.prototype.hasOwnProperty,Ei=Object.prototype.propertyIsEnumerable,Si=(a,o,f)=>o in a?Ms(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,uo=(a,o)=>{for(var f in o||(o={}))tr.call(o,f)&&Si(a,f,o[f]);if(An)for(var f of An(o))Ei.call(o,f)&&Si(a,f,o[f]);return a},Es=(a,o)=>re(a,ge(o)),Ns=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),As=(a,o,f,v)=>Ns(void 0,null,function*(){const S={x:o.x,y:o.y,z:o.z},O=(0,_t.z0)(a,S);return new Promise(L=>{v?v(S,(k,V)=>{if(k||!V){const Q={layers:{defaultLayer:{features:[]}}},st=new Pa(Q,o.x,o.y,o.z);L(st)}else{const Q={layers:{defaultLayer:{features:V.features}}},st=new Pa(Q,o.x,o.y,o.z);L(st)}}):(0,_t.Yu)(Es(uo({},f),{url:O}),(k,V)=>{if(k||!V){const Q={layers:{defaultLayer:{features:[]}}},st=new Pa(Q,o.x,o.y,o.z);L(st)}else{const st={layers:{defaultLayer:{features:JSON.parse(V)}}},ft=new Pa(st,o.x,o.y,o.z);L(ft)}})})});function rl(a,o){const f=(S,O)=>As(a,O,o==null?void 0:o.requestParameters,o.getCustomData),v=Es(uo({},o),{getTileData:f});return{dataArray:[],tilesetOptions:v,isTile:!0}}var Xf=it(38929),Ud=it(3614),md=it.n(Ud),Dl=Object.defineProperty,Qc=Object.defineProperties,Mf=Object.getOwnPropertyDescriptors,Jc=Object.getOwnPropertySymbols,Ic=Object.prototype.hasOwnProperty,tu=Object.prototype.propertyIsEnumerable,Yf=(a,o,f)=>o in a?Dl(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,ac=(a,o)=>{for(var f in o||(o={}))Ic.call(o,f)&&Yf(a,f,o[f]);if(Jc)for(var f of Jc(o))tu.call(o,f)&&Yf(a,f,o[f]);return a},Ws=(a,o)=>Qc(a,Mf(o)),Ru=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=new Xf.VectorTile(new(md())(a))}getTileData(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];const o=this.vectorTile.layers[a];if(Array.isArray(o.features))return this.vectorLayerCache[a]=o.features,o.features;const f=[];for(let v=0;v<o.length;v++){const O=o.feature(v).toGeoJSON(this.x,this.y,this.z);f.push(Ws(ac({},O),{properties:ac({id:O.id},O.properties)}))}return this.vectorLayerCache[a]=f,f}getFeatureById(){throw new Error("Method not implemented.")}},gf=Object.defineProperty,Fh=Object.defineProperties,Uh=Object.getOwnPropertyDescriptors,eu=Object.getOwnPropertySymbols,mh=Object.prototype.hasOwnProperty,zh=Object.prototype.propertyIsEnumerable,vd=(a,o,f)=>o in a?gf(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,gd=(a,o)=>{for(var f in o||(o={}))mh.call(o,f)&&vd(a,f,o[f]);if(eu)for(var f of eu(o))zh.call(o,f)&&vd(a,f,o[f]);return a},yd=(a,o)=>Fh(a,Uh(o)),vp=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),qf={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Mu=(a,o,f,v,S)=>vp(void 0,null,function*(){const O=(0,_t.z0)(a,o);return new Promise(L=>{if(S)S({x:f.x,y:f.y,z:f.z},(k,V)=>{if(k||!V)L(void 0);else{const Q=new Ru(V,f.x,f.y,f.z);L(Q)}});else{const k=(0,_t.ks)(yd(gd({},v),{url:O}),(V,Q)=>{if(V||!Q)L(void 0);else{const st=new Ru(Q,f.x,f.y,f.z);L(st)}});f.xhrCancel=()=>k.cancel()}})});function _d(a,o){const f=Array.isArray(a)?a[0]:a,v=(O,L)=>Mu(f,O,L,o==null?void 0:o.requestParameters,o==null?void 0:o.getCustomData),S=yd(gd(gd({},qf),o),{getTileData:v});return{data:f,dataArray:[],tilesetOptions:S,isTile:!0}}function Nl(a,o,f){switch(a){case"+":return o+f;case"-":return o-f;case"*":return o*f;case"/":return o/f;case"%":return o%f;case"^":return Math.pow(o,f);case"abs":return Math.abs(o);case"floor":return Math.floor(o);case"round":return Math.round(o);case"ceil":return Math.ceil(o);case"sin":return Math.sin(o);case"cos":return Math.cos(o);case"atan":return f===-1?Math.atan(o):Math.atan2(o,f);case"min":return Math.min(o,f);case"max":return Math.max(o,f);case"log10":return Math.log(o);case"log2":return Math.log2(o);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Ps(a,o){const{width:f,height:v}=o[0],S=o.map(V=>V.rasterData),O=f*v,L=[],k=JSON.stringify(a);for(let V=0;V<O;V++){const Q=JSON.parse(k),st=nu(Q,S,V);if(typeof st=="number")L.push(st);else{const ft=of(Q);L.push(ft)}}return L}function nu(a,o,f){if(a.length===2&&a[0]==="band"&&typeof a[1]=="number")try{return o[a[1]][f]}catch(v){return console.warn("Raster Data err!"),0}a.map((v,S)=>{if(Array.isArray(v)&&v.length>0)switch(v[0]){case"band":try{a[S]=o[v[1]][f]}catch(O){console.warn("Raster Data err!"),a[S]=0}break;default:nu(v,o,f)}})}function sc(a){const[o,f=-1,v=-1]=a;return o===void 0?(console.warn("Express err!"),["+",0,0]):[o.replace(/\s+/g,""),f,v]}function of(a){const o=sc(a),f=o[0];let v=o[1],S=o[2];return Array.isArray(v)&&(v=of(a[1])),Array.isArray(S)&&(S=of(a[2])),Nl(f,v,S)}var lc={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:af}};function af(a,o){const f=a[0].rasterData,v=a[1].rasterData,S=a[2].rasterData,O=[],[L,k]=(o==null?void 0:o.countCut)||[2,98],V=(o==null?void 0:o.RMinMax)||kl(f,L,k),Q=(o==null?void 0:o.GMinMax)||kl(v,L,k),st=(o==null?void 0:o.BMinMax)||kl(S,L,k);for(let ft=0;ft<f.length;ft++)O.push(Math.max(0,f[ft]-V[0])),O.push(Math.max(0,v[ft]-Q[0])),O.push(Math.max(0,S[ft]-st[0]));return{rasterData:O,rMinMax:V,gMinMax:Q,bMinMax:st}}function kl(a,o,f){const v=a.slice().sort((k,V)=>k-V),S=v.length,O=v[Math.ceil(S*o/100)],L=v[Math.ceil(S*f/100)];return[O,L]}var Pu=Object.defineProperty,yf=Object.defineProperties,vh=Object.getOwnPropertyDescriptors,$f=Object.getOwnPropertySymbols,us=Object.prototype.hasOwnProperty,jh=Object.prototype.propertyIsEnumerable,Vh=(a,o,f)=>o in a?Pu(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,gh=(a,o)=>{for(var f in o||(o={}))us.call(o,f)&&Vh(a,f,o[f]);if($f)for(var f of $f(o))jh.call(o,f)&&Vh(a,f,o[f]);return a},il=(a,o)=>yf(a,vh(o)),Kf=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())});function Qf(a,o,f){return Kf(this,null,function*(){if(a.length===0)return{rasterData:[0],width:1,heigh:1};const v=yield Promise.all(a.map(({data:V,bands:Q=[0]})=>o(V,Q))),S=[];v.forEach(V=>{Array.isArray(V)?S.push(...V):S.push(V)});const{width:O,height:L}=S[0];let k;switch(typeof f){case"function":k=f(S);break;case"object":Array.isArray(f)?k={rasterData:Ps(f,S)}:k=K(f,S);break;default:k={rasterData:S[0].rasterData}}return il(gh({},k),{width:O,height:L})})}function K(a,o){const f=lc[a.type];if(f.type==="function")return f.method(o,a==null?void 0:a.options);if(f.type==="operation")return a.type==="rgb"?lt(f.expression,o):{rasterData:Ps(f.expression,o)}}function lt(a,o){a.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),a.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),a.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const f=Ps(a.r||["band",0],o),v=Ps(a.g||["band",0],o),S=Ps(a.b||["band",0],o);return[f,v,S]}function It(a,o,f,v){return Kf(this,null,function*(){const S=yield Qf(a,o,f);v(null,{data:S})})}function Ke(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,width:S,height:O,min:L,max:k,format:V,operation:Q}=o;let st,ft,Tt;if(V===void 0||Ue(a))st=Array.from(a),ft=S,Tt=O;else{const yn=Array.isArray(a)?a:[a];st=Qf(yn,V,Q)}const se=wn(v,f);return{_id:1,dataArray:[{_id:1,data:st,width:ft,height:Tt,min:L,max:k,coordinates:se}]}}var X=it(39827),Xn=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),Mr=(a,o,f,v)=>Xn(void 0,null,function*(){return new Promise((S,O)=>{o({x:a.x,y:a.y,z:a.z},(L,k)=>{if(L||k.length===0){O(L);return}k&&It([{data:k,bands:[0]}],f,v,(V,Q)=>{V?O(V):Q&&S(Q)})})})}),ki=(a,o)=>Xn(void 0,null,function*(){return new Promise((f,v)=>{o({x:a.x,y:a.y,z:a.z},(S,O)=>{if(S||!O){v(S);return}O instanceof ArrayBuffer?(0,_t.Co)(O,(L,k)=>{L&&v(L),f(k)}):O instanceof HTMLImageElement?f(O):v(S)})})});function Jr(a,o){return Array.isArray(a)?typeof a[0]=="string"?a.map(f=>(0,_t.z0)(f,o)):a.map(f=>({url:(0,_t.z0)(f.url,o),bands:f.bands||[0]})):(0,_t.z0)(a,o)}function co(a){return typeof a=="string"?[{url:a,bands:[0]}]:typeof a[0]=="string"?a.map(o=>({url:o,bands:[0]})):a}function so(a,o){a.xhrCancel=()=>{o.map(f=>{f.abort()})}}var sa=Object.defineProperty,Po=Object.defineProperties,_a=Object.getOwnPropertyDescriptors,qa=Object.getOwnPropertySymbols,ra=Object.prototype.hasOwnProperty,ma=Object.prototype.propertyIsEnumerable,ls=(a,o,f)=>o in a?sa(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Aa=(a,o)=>{for(var f in o||(o={}))ra.call(o,f)&&ls(a,f,o[f]);if(qa)for(var f of qa(o))ma.call(o,f)&&ls(a,f,o[f]);return a},Ia=(a,o)=>Po(a,_a(o)),ka=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),qs=(a,o,f,v,S)=>ka(void 0,null,function*(){const O=co(o.url);if(O.length>1){const{rasterFiles:L,xhrList:k,errList:V}=yield ks(O,o);if(so(a,k),V.length>0){f(V,null);return}It(L,v,S,f)}else{const L=(0,_t.ks)(o,(k,V)=>{if(k)f(k);else if(V){const Q=[{data:V,bands:O[0].bands}];It(Q,v,S,f)}});so(a,[L])}});function ks(a,o){return ka(this,null,function*(){const f=[],v=[],S=[];for(let O=0;O<a.length;O++){const L=a[O],k=Ia(Aa({},o),{url:L.url}),V=L.bands,{err:Q,data:st,xhr:ft}=yield(0,_t.LF)(Ia(Aa({},k),{type:"arrayBuffer"}));Q&&S.push(Q),v.push(ft),f.push({data:st,bands:V})}return{rasterFiles:f,xhrList:v,errList:S}})}var Ec=Object.defineProperty,es=Object.defineProperties,Iu=Object.getOwnPropertyDescriptors,du=Object.getOwnPropertySymbols,Lc=Object.prototype.hasOwnProperty,Pf=Object.prototype.propertyIsEnumerable,Zh=(a,o,f)=>o in a?Ec(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Hh=(a,o)=>{for(var f in o||(o={}))Lc.call(o,f)&&Zh(a,f,o[f]);if(du)for(var f of du(o))Pf.call(o,f)&&Zh(a,f,o[f]);return a},If=(a,o)=>es(a,Iu(o)),Lu=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),Lf=(a,o,f,v)=>Lu(void 0,null,function*(){const{format:S=Du,operation:O,requestParameters:L={}}=v,k=If(Hh({},L),{url:Jr(a,o)});return new Promise((V,Q)=>{qs(f,k,(st,ft)=>{st?Q(st):ft&&V(ft)},S,O)})}),yh=(a,o,f,v)=>Lu(void 0,null,function*(){let S;const O=Array.isArray(a)?a[0]:a;return v.wmtsOptions?S=((v==null?void 0:v.getURLFromTemplate)||_t.jG)(O,Hh(Hh({},o),v.wmtsOptions)):S=((v==null?void 0:v.getURLFromTemplate)||_t.z0)(O,o),new Promise((L,k)=>{var V;const Q=(0,_t.gJ)(If(Hh({},v==null?void 0:v.requestParameters),{url:S,type:((V=v==null?void 0:v.requestParameters)==null?void 0:V.type)||"arrayBuffer"}),(st,ft)=>{st?k(st):ft&&L(ft)},v.transformResponse);f.xhrCancel=()=>Q.cancel()})}),Du=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),P0=Object.defineProperty,xd=Object.defineProperties,Dc=Object.getOwnPropertyDescriptors,Gh=Object.getOwnPropertySymbols,gp=Object.prototype.hasOwnProperty,Wh=Object.prototype.propertyIsEnumerable,_h=(a,o,f)=>o in a?P0(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Nu=(a,o)=>{for(var f in o||(o={}))gp.call(o,f)&&_h(a,f,o[f]);if(Gh)for(var f of Gh(o))Wh.call(o,f)&&_h(a,f,o[f]);return a},Df=(a,o)=>xd(a,Dc(o)),Jf={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Yp=[X.n3.ARRAYBUFFER,X.n3.RGB];function Nf(a){return!!(Array.isArray(a)&&a.length===0||!Array.isArray(a)&&typeof a!="string")}function $a(a,o={}){if(Nf(a))throw new Error("tile server url is error");let f=(o==null?void 0:o.dataType)||X.n3.IMAGE;f===X.n3.RGB&&(f=X.n3.ARRAYBUFFER);const v=(O,L)=>{switch(f){case X.n3.IMAGE:return yh(a,O,L,o);case X.n3.CUSTOMIMAGE:case X.n3.CUSTOMTERRAINRGB:return ki(L,o==null?void 0:o.getCustomData);case X.n3.ARRAYBUFFER:return Lf(a,O,L,o);case X.n3.CUSTOMARRAYBUFFER:case X.n3.CUSTOMRGB:return Mr(L,o==null?void 0:o.getCustomData,(o==null?void 0:o.format)||Du,o==null?void 0:o.operation);default:return yh(a,O,L,o)}},S=Df(Nu(Nu({},Jf),o),{getTileData:v});return{data:a,dataArray:[],tilesetOptions:S,isTile:!0}}var bd=Object.defineProperty,pu=Object.defineProperties,tt=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,dn=Object.prototype.propertyIsEnumerable,nr=(a,o,f)=>o in a?bd(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Br=(a,o)=>{for(var f in o||(o={}))Xt.call(o,f)&&nr(a,f,o[f]);if(mt)for(var f of mt(o))dn.call(o,f)&&nr(a,f,o[f]);return a},vi=(a,o)=>pu(a,tt(o)),qi=(a,o)=>{var f={};for(var v in a)Xt.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&mt)for(var v of mt(a))o.indexOf(v)<0&&dn.call(a,v)&&(f[v]=a[v]);return f};function da(a,o){const f=o,{extent:v=[121.168,30.2828,121.384,30.4219],coordinates:S,width:O,height:L}=f,k=qi(f,["extent","coordinates","width","height"]);a.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[V,Q]=k.bands||[0,1],st=[a[V],a[Q]],ft=[];for(let Ve=0;Ve<st[0].length;Ve++)ft.push((st[1][Ve]-st[0][Ve])/(st[1][Ve]+st[0][Ve]));const Tt=wn(S,v);return{_id:1,dataArray:[vi(Br({_id:1,data:ft,width:O,height:L},k),{coordinates:Tt})]}}var xa=Object.defineProperty,ms=Object.defineProperties,Fa=Object.getOwnPropertyDescriptors,Ba=Object.getOwnPropertySymbols,cc=Object.prototype.hasOwnProperty,ku=Object.prototype.propertyIsEnumerable,$s=(a,o,f)=>o in a?xa(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,fo=(a,o)=>{for(var f in o||(o={}))cc.call(o,f)&&$s(a,f,o[f]);if(Ba)for(var f of Ba(o))ku.call(o,f)&&$s(a,f,o[f]);return a},ru=(a,o)=>ms(a,Fa(o)),Ed=(a,o)=>{var f={};for(var v in a)cc.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Ba)for(var v of Ba(a))o.indexOf(v)<0&&ku.call(a,v)&&(f[v]=a[v]);return f};function th(a,o){const f=o,{extent:v,coordinates:S,width:O,height:L}=f,k=Ed(f,["extent","coordinates","width","height"]);a.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[V,Q,st]=k.bands||[0,1,2],ft=[a[V],a[Q],a[st]],Tt=[],[se,Ve]=(k==null?void 0:k.countCut)||[2,98],yn=(k==null?void 0:k.RMinMax)||kl(ft[0],se,Ve),lr=(k==null?void 0:k.GMinMax)||kl(ft[1],se,Ve),Nr=(k==null?void 0:k.BMinMax)||kl(ft[2],se,Ve);for(let Fi=0;Fi<ft[0].length;Fi++)Tt.push(Math.max(0,ft[0][Fi]-yn[0])),Tt.push(Math.max(0,ft[1][Fi]-lr[0])),Tt.push(Math.max(0,ft[2][Fi]-Nr[0]));const Ln=wn(S,v);return{_id:1,dataArray:[ru(fo({_id:1,data:Tt,width:O,height:L,rMinMax:yn,gMinMax:lr,bMinMax:Nr},k),{coordinates:Ln})]}}var pl=Object.defineProperty,ns=Object.defineProperties,yp=Object.getOwnPropertyDescriptors,Ri=Object.getOwnPropertySymbols,eh=Object.prototype.hasOwnProperty,Sd=Object.prototype.propertyIsEnumerable,qp=(a,o,f)=>o in a?pl(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Nc=(a,o)=>{for(var f in o||(o={}))eh.call(o,f)&&qp(a,f,o[f]);if(Ri)for(var f of Ri(o))Sd.call(o,f)&&qp(a,f,o[f]);return a},mu=(a,o)=>ns(a,yp(o)),_p=(a,o)=>{var f={};for(var v in a)eh.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Ri)for(var v of Ri(a))o.indexOf(v)<0&&Sd.call(a,v)&&(f[v]=a[v]);return f};function $p(a,o){const f=o,{extent:v,coordinates:S,min:O,max:L,width:k,height:V,format:Q,operation:st}=f,ft=_p(f,["extent","coordinates","min","max","width","height","format","operation"]);let Tt;if(Q===void 0||Ue(a))Tt=Array.from(a);else{const yn=Array.isArray(a)?a:[a];Tt=Qf(yn,Q,st)}const se=wn(S,v);return{_id:1,dataArray:[mu(Nc({_id:1,data:Tt,width:k,height:V},ft),{min:O,max:L,coordinates:se})]}}var kc=Object.defineProperty,nh=Object.defineProperties,Jm=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty,sm=Object.prototype.propertyIsEnumerable,Bu=(a,o,f)=>o in a?kc(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,vu=(a,o)=>{for(var f in o||(o={}))xp.call(o,f)&&Bu(a,f,o[f]);if(Td)for(var f of Td(o))sm.call(o,f)&&Bu(a,f,o[f]);return a},va=(a,o)=>nh(a,Jm(o)),Fu=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),Uu={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},uc=a=>Fu(void 0,null,function*(){return new Promise(o=>{const[f,v,S,O]=a.bounds,L={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,x:(f+S)/2,y:(v+O)/2},geometry:{type:"LineString",coordinates:[[S,O],[S,v],[f,v],[f,v]]}}]}}};o(L)})});function Xh(a,o){const f=S=>uc(S),v=va(vu(vu({},Uu),o),{getTileData:f});return{data:a,dataArray:[],tilesetOptions:v,isTile:!0}}var Gl=it(46343),Gc=it(26729),iu=it.n(Gc),bp=it(69848),Ao=it.n(bp),xo=Object.defineProperty,zu=Object.getOwnPropertySymbols,ou=Object.prototype.hasOwnProperty,rh=Object.prototype.propertyIsEnumerable,ul=(a,o,f)=>o in a?xo(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Wc=(a,o)=>{for(var f in o||(o={}))ou.call(o,f)&&ul(a,f,o[f]);if(zu)for(var f of zu(o))rh.call(o,f)&&ul(a,f,o[f]);return a};function kf(a,o){const{radius:f=40,maxZoom:v=18,minZoom:S=0,zoom:O=2}=o;if(a.pointIndex){const V=a.pointIndex.getClusters(a.extent,Math.floor(O));return a.dataArray=wd(V),a}const L=new(Ao())({radius:f,minZoom:S,maxZoom:v}),k={type:"FeatureCollection",features:[]};return k.features=a.dataArray.map(V=>({type:"Feature",geometry:{type:"Point",coordinates:V.coordinates},properties:Wc({},V)})),L.load(k.features),L}function wd(a){return a.map((o,f)=>Wc({coordinates:o.geometry.coordinates,_id:f+1},o.properties))}function fs(a){if(a.length===0)throw new Error("max requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]>o&&(o=a[f]);return o}function fc(a){if(a.length===0)throw new Error("min requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]<o&&(o=a[f]);return o}function I0(a){if(a.length===0)return 0;let o=a[0],f=0,v;for(let S=1;S<a.length;S++)v=o+a[S]*1,Math.abs(o)>=Math.abs(a[S])?f+=o-v+a[S]:f+=a[S]-v+o,o=v;return o+f*1}function Yh(a){if(a.length===0)throw new Error("mean requires at least one data point");return I0(a)/a.length}var Kp={min:fc,max:fs,mean:Yh,sum:I0},xh=Object.defineProperty,au=Object.getOwnPropertySymbols,zd=Object.prototype.hasOwnProperty,Gr=Object.prototype.propertyIsEnumerable,ih=(a,o,f)=>o in a?xh(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Xc=(a,o)=>{for(var f in o||(o={}))zd.call(o,f)&&ih(a,f,o[f]);if(au)for(var f of au(o))Gr.call(o,f)&&ih(a,f,o[f]);return a},jd=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),{cloneDeep:bh,isFunction:oh,isString:ah,mergeWith:Qp}=_t.lodashUtil;function sh(a,o){if(Array.isArray(o))return o}var Bf=class extends Gc.EventEmitter{constructor(a,o){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new Gl.ni},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=a,this.initCfg(o),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}getClustersLeaves(a){return this.clusterIndex.getLeaves(a,1/0)}getParserType(){return this.parser.type}updateClusterData(a){const{method:o="sum",field:f}=this.clusterOptions;let v=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,v.forEach(S=>{S.id||(S.properties.point_count=1)}),(f||oh(o))&&(v=v.map(S=>{const O=S.id;if(O){const k=this.clusterIndex.getLeaves(O,1/0).map(Q=>Q.properties);let V;if(ah(o)&&f){const Q=Qn(k,f);V=Kp[o](Q)}oh(o)&&(V=o(k)),S.properties.stat=V}else S.properties.point_count=1;return S})),this.data=R("geojson")({type:"FeatureCollection",features:v}),this.executeTrans()}getFeatureById(a){const{type:o="geojson",geometry:f}=this.parser;if(o==="geojson"&&!this.cluster){const v=a<this.originData.features.length?this.originData.features[a]:"null",S=bh(v);if(S!=null&&S.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const O=this.data.dataArray.find(L=>L._id===a);S.properties=O}return S}else return o==="json"&&f?this.data.dataArray.find(v=>v._id===a):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}updateFeaturePropertiesById(a,o){this.data.dataArray=this.data.dataArray.map(f=>f._id===a?Xc(Xc({},f),o):f),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(a,o){const f=this.data.dataArray.find(v=>v[a]===o);return f==null?void 0:f._id}setData(a,o){this.originData=a,this.dataArrayChanged=!1,this.initCfg(o),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var a;(a=this.tileset)==null||a.reloadAll()}reloadTilebyId(a,o,f){var v;(v=this.tileset)==null||v.reloadTileById(a,o,f)}reloadTileByLnglat(a,o,f){var v;(v=this.tileset)==null||v.reloadTileByLnglat(a,o,f)}getTileExtent(a,o){var f;return(f=this.tileset)==null?void 0:f.getTileExtent(a,o)}getTileByZXY(a,o,f){var v;return(v=this.tileset)==null?void 0:v.getTileByZXY(a,o,f)}reloadTileByExtent(a,o){var f;(f=this.tileset)==null||f.reloadTileByExtent(a,o)}destroy(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)==null||a.destroy()}processData(){return jd(this,null,function*(){return new Promise((a,o)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),a({})}catch(f){o(f)}})})}initCfg(a){this.cfg=Qp(this.cfg,a,sh);const o=this.cfg;o&&(o.parser&&(this.parser=o.parser),o.transforms&&(this.transforms=o.transforms),this.cluster=o.cluster||!1,o.clusterOptions&&(this.cluster=!0,this.clusterOptions=Xc(Xc({},this.clusterOptions),o.clusterOptions)))}init(){return jd(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const a=this.parser,o=a.type||"geojson",f=R(o);this.data=f(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=(0,_t.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:a}=this.data;return a?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(a),this.tileset):new _t.nx(Xc({},a))):void 0}executeTrans(){this.transforms.forEach(o=>{const{type:f}=o,v=yt(f)(this.data,o);Object.assign(this.data,v)})}initCluster(){if(!this.cluster)return;const a=this.clusterOptions||{};this.clusterIndex=kf(this.data,a)}caculClusterExtent(a){let o=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(o=(0,_t.yA)((0,_t.ds)(this.extent),a)),o[0].concat(o[1])}};function Eh(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.filter(f)),a}var Al=6378e3;function Qa(a,o){const f=a.dataArray,{size:v=10}=o,S=v/(2*Math.PI*Al)*(256<<20)/2,{gridHash:O,gridOffset:L}=ju(f,v),k=_(O,L,o);return{yOffset:S,xOffset:S,radius:S,type:"grid",dataArray:k}}function ju(a,o){let f=1/0,v=-1/0,S;for(const V of a)S=V.coordinates[1],Number.isFinite(S)&&(f=S<f?S:f,v=S>v?S:v);const O=(f+v)/2,L=Jp(o,O);if(L.xOffset<=0||L.yOffset<=0)return{gridHash:{},gridOffset:L};const k={};for(const V of a){const Q=V.coordinates[1],st=V.coordinates[0];if(Number.isFinite(Q)&&Number.isFinite(st)){const ft=Math.floor((Q+90)/L.yOffset),Tt=Math.floor((st+180)/L.xOffset),se=`${ft}-${Tt}`;k[se]=k[se]||{count:0,points:[]},k[se].count+=1,k[se].points.push(V)}}return{gridHash:k,gridOffset:L}}function Jp(a,o){const f=L0(a),v=t0(o,a);return{yOffset:f,xOffset:v}}function L0(a){return a/Al*(180/Math.PI)}function t0(a,o){return o/Al*(180/Math.PI)/Math.cos(a*Math.PI/180)}function _(a,o,f){return Object.keys(a).reduce((v,S,O)=>{const L=S.split("-"),k=parseInt(L[0],10),V=parseInt(L[1],10),Q={};if(f.field&&f.method){const st=_t.a5.getColumn(a[S].points,f.field);Q[f.method]=_t.a5.statMap[f.method](st)}return Object.assign(Q,{_id:O,coordinates:(0,_t.Z)([-180+o.xOffset*(V+.5),-90+o.yOffset*(k+.5)]),rawData:a[S].points,count:a[S].count}),v.push(Q),v},[])}var E=Math.PI/3,b=[0,E,2*E,3*E,4*E,5*E];function A(a){return a[0]}function B(a){return a[1]}function H(){var a=0,o=0,f=1,v=1,S=A,O=B,L,k,V;function Q(ft){var Tt={},se=[],Ve,yn=ft.length;for(Ve=0;Ve<yn;++Ve)if(!(isNaN(Nr=+S.call(null,lr=ft[Ve],Ve,ft))||isNaN(Ln=+O.call(null,lr,Ve,ft)))){var lr,Nr,Ln,ci=Math.round(Ln=Ln/V),Fi=Math.round(Nr=Nr/k-(ci&1)/2),So=Ln-ci;if(Math.abs(So)*3>1){var Ji=Nr-Fi,Vr=Fi+(Nr<Fi?-1:1)/2,Hi=ci+(Ln<ci?-1:1),za=Nr-Vr,ps=Ln-Hi;Ji*Ji+So*So>za*za+ps*ps&&(Fi=Vr+(ci&1?1:-1)/2,ci=Hi)}var Wo=Fi+"-"+ci,as=Tt[Wo];as?as.push(lr):(se.push(as=Tt[Wo]=[lr]),as.x=(Fi+(ci&1)/2)*k,as.y=ci*V)}return se}function st(ft){var Tt=0,se=0;return b.map(function(Ve){var yn=Math.sin(Ve)*ft,lr=-Math.cos(Ve)*ft,Nr=yn-Tt,Ln=lr-se;return Tt=yn,se=lr,[Nr,Ln]})}return Q.hexagon=function(ft){return"m"+st(ft==null?L:+ft).join("l")+"z"},Q.centers=function(){for(var ft=[],Tt=Math.round(o/V),se=Math.round(a/k),Ve=Tt*V;Ve<v+L;Ve+=V,++Tt)for(var yn=se*k+(Tt&1)*k/2;yn<f+k/2;yn+=k)ft.push([yn,Ve]);return ft},Q.mesh=function(){var ft=st(L).slice(0,4).join("l");return Q.centers().map(function(Tt){return"M"+Tt+"m"+ft}).join("")},Q.x=function(ft){return arguments.length?(S=ft,Q):S},Q.y=function(ft){return arguments.length?(O=ft,Q):O},Q.radius=function(ft){return arguments.length?(L=+ft,k=L*2*Math.sin(E),V=L*1.5,Q):L},Q.size=function(ft){return arguments.length?(a=o=0,f=+ft[0],v=+ft[1],Q):[f-a,v-o]},Q.extent=function(ft){return arguments.length?(a=+ft[0][0],o=+ft[0][1],f=+ft[1][0],v=+ft[1][1],Q):[[a,o],[f,v]]},Q.radius(1)}var Y=Object.defineProperty,et=Object.defineProperties,St=Object.getOwnPropertyDescriptors,Rt=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,Oe=(a,o,f)=>o in a?Y(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,on=(a,o)=>{for(var f in o||(o={}))ye.call(o,f)&&Oe(a,f,o[f]);if(Rt)for(var f of Rt(o))be.call(o,f)&&Oe(a,f,o[f]);return a},Qe=(a,o)=>et(a,St(o)),vn=6378e3;function Ye(a,o){const f=a.dataArray,{size:v=10,method:S="sum"}=o,O=v/(2*Math.PI*vn)*(256<<20)/2,L=f.map(st=>{const[ft,Tt]=(0,_t.Z)(st.coordinates);return Qe(on({},st),{coordinates:[ft,Tt]})});return{dataArray:H().radius(O).x(st=>st.coordinates[0]).y(st=>st.coordinates[1])(L).map((st,ft)=>{if(o.field&&S){const Tt=_t.a5.getColumn(st,o.field);st[S]=_t.a5.statMap[S](Tt)}return{[o.method]:st[S],count:st.length,rawData:st,coordinates:[st.x,st.y],_id:ft}}),radius:O,xOffset:O,yOffset:O,type:"hexagon"}}var On=Object.defineProperty,jn=Object.getOwnPropertySymbols,ar=Object.prototype.hasOwnProperty,Or=Object.prototype.propertyIsEnumerable,cr=(a,o,f)=>o in a?On(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,kr=(a,o)=>{for(var f in o||(o={}))ar.call(o,f)&&cr(a,f,o[f]);if(jn)for(var f of jn(o))Or.call(o,f)&&cr(a,f,o[f]);return a};function ei(a,o){const{sourceField:f,targetField:v,data:S}=o,O={};return S.forEach(L=>{O[L[f]]=L}),a.dataArray=a.dataArray.map(L=>{const k=L[v];return kr(kr({},L),O[k])}),a}function Yr(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.map(f)),a}var Ti=it(4771);$e("rasterTile",$a),$e("mvt",_d),$e("geojsonvt",Ui),$e("testTile",Xh),$e("geojson",Zn),$e("jsonTile",rl),$e("image",ca),$e("csv",ot),$e("json",F),$e("raster",Ke),$e("rasterRgb",$p),$e("rgb",th),$e("ndi",da),xe("cluster",kf),xe("filter",Eh),xe("join",ei),xe("map",Yr),xe("grid",Qa),xe("hexagon",Ye);var zi=Bf;class Io extends null{getMarkerLayerContainerSize(){}constructor(o){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",f=>{const v=this.mapsService.getContainer();if(!v)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:S,top:O}=v.getClientRects()[0],{x:L,y:k}=f;this.preLngLat=this.mapsService.containerToLngLat([L-S,k-O]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",f=>{const v=f.lngLat||f.lnglat,{lng:S,lat:O}=this.preLngLat,{lng:L,lat:k}=v,V={lng:this.lngLat.lng+L-S,lat:this.lngLat.lat+k-O};this.setLnglat(V),this.preLngLat=v,this.emit("dragging",V)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",f=>{this.polyfillEvent(f),this.emit(f.type,{target:f,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),o),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(o){this.scene=o,this.mapsService=o.mapService;const{element:f}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(f),this.registerMarkerEvent(f),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:o}=this.markerOption;return o&&DOM.remove(o),this.popup&&this.popup.remove(),this}setLnglat(o){return this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(o){if(!this.added)return this.once("added",()=>{this.setElement(o)}),this;const{element:f}=this.markerOption;return f&&DOM.remove(f),this.markerOption.element=o,this.init(),this.mapsService.getMarkerContainer().appendChild(o),this.registerMarkerEvent(o),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const o=this.popup;return o?(o.isOpen()||o.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const o=this.popup;return o&&o.remove(),this}setPopup(o){return this.popup=o,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const o=this.popup;if(o)o.isOpen()?o.remove():o.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(o){this.markerOption.draggable=o,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(o){this.markerOption.extData=o}update(){if(!this.mapsService)return;const{element:o,anchor:f}=this.markerOption;this.updatePosition(),DOM.setTransform(o,`${anchorTranslate[f]}`)}updatePositionWhenZoom(o){if(!this.mapsService)return;const{element:f,offsets:v}=this.markerOption,{lng:S,lat:O}=this.lngLat;if(f){f.style.display="block",f.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:k,bounds:V}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!V)return;const Q=o.map,st=o.center,ft=o.zoom,Tt=Q.DE(this.lngLat,ft,st);if(Tt.x=Math.round(Tt.x+v[0]),Tt.y=Math.round(Tt.y-v[1]),Math.abs(V[0][0])>180||Math.abs(V[1][0])>180){if(Tt.x>k){const se=this.mapsService.lngLatToContainer([S-360,O]);Tt.x=se.x}if(Tt.x<0){const se=this.mapsService.lngLatToContainer([S+360,O]);Tt.x=se.x}}(Tt.x>k||Tt.x<0||Tt.y>L||Tt.y<0)&&(f.style.display="none"),f.style.left=Tt.x+"px",f.style.top=Tt.y+"px",f.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(o){const{element:f}=this.markerOption;this.popup&&f&&this.togglePopup()}getCurrentContainerSize(){const o=this.mapsService.getContainer();return{containerHeight:(o==null?void 0:o.scrollHeight)||0,containerWidth:(o==null?void 0:o.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:o}=this.markerOption;o==null||o.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(o==null||o.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:o,offsets:f}=this.markerOption,{lng:v,lat:S}=this.lngLat,O=this.mapsService.lngLatToContainer([v,S]);if(o){o.style.display="block",o.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:k,bounds:V}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!V)return;if(Math.abs(V[0][0])>180||Math.abs(V[1][0])>180){if(O.x>k){const Q=this.mapsService.lngLatToContainer([v-360,S]);O.x=Q.x}if(O.x<0){const Q=this.mapsService.lngLatToContainer([v+360,S]);O.x=Q.x}}this.markerOption.overflowHide&&(O.x>k||O.x<0||O.y>L||O.y<0)&&(o.style.display="none"),o.style.left=O.x+f[0]+"px",o.style.top=O.y-f[1]+"px"}}init(){let{element:o}=this.markerOption;const{color:f,anchor:v}=this.markerOption;if(!o){o=DOM.create("div"),this.markerOption.element=o;const S=document.createElementNS("http://www.w3.org/2000/svg","svg");S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height","48px"),S.setAttributeNS(null,"width","48px"),S.setAttributeNS(null,"viewBox","0 0 1024 1024");const O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),O.setAttributeNS(null,"fill",f),S.appendChild(O),o.appendChild(S)}DOM.addClass(o,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(S=>{var O,L;const k=((O=this.markerOption)===null||O===void 0?void 0:O.style)&&((L=this.markerOption)===null||L===void 0?void 0:L.style[S]);o&&(o.style[S]=k)}),applyAnchorClass(o,v,"marker")}registerMarkerEvent(o){o.addEventListener("click",this.onMapClick),o.addEventListener("mousemove",this.eventHandle),o.addEventListener("click",this.eventHandle),o.addEventListener("mousedown",this.eventHandle),o.addEventListener("mouseup",this.eventHandle),o.addEventListener("dblclick",this.eventHandle),o.addEventListener("contextmenu",this.eventHandle),o.addEventListener("mouseover",this.eventHandle),o.addEventListener("mouseout",this.eventHandle),o.addEventListener("touchstart",this.eventHandle),o.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const o=this.getElement();o.removeEventListener("click",this.onMapClick),o.removeEventListener("mousemove",this.eventHandle),o.removeEventListener("click",this.eventHandle),o.removeEventListener("mousedown",this.eventHandle),o.removeEventListener("mouseup",this.eventHandle),o.removeEventListener("dblclick",this.eventHandle),o.removeEventListener("contextmenu",this.eventHandle),o.removeEventListener("mouseover",this.eventHandle),o.removeEventListener("mouseout",this.eventHandle),o.removeEventListener("touchstart",this.eventHandle),o.removeEventListener("touchend",this.eventHandle)}polyfillEvent(o){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(o.type==="touchstart"&&(this.touchStartTime=Date.now()),o.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:o,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(o){return null}onUp(o){throw new Error("Method not implemented.")}}const{merge:Bo}=_t.lodashUtil;class Fo extends null{constructor(o){var f;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=Bo(this.getDefault(),o),bindAll(["update"],this),this.zoom=((f=this.markerLayerOption.clusterOption)===null||f===void 0?void 0:f.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(o){return this.scene=o,this.mapsService=o.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const o=this.mapsService.getContainer();this.containerSize={containerWidth:(o==null?void 0:o.scrollWidth)||0,containerHeight:(o==null?void 0:o.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(o){const f=this.markerLayerOption.cluster;if(o.getMarkerLayerContainerSize=this.getContainerSize.bind(this),f&&(this.addPoint(o,this.markers.length),this.mapsService)){const v=this.mapsService.getZoom(),S=this.mapsService.getBounds();this.bbox=padBounds(S,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(o)}removeMarker(o){this.markers.indexOf(o);const f=this.markers.indexOf(o);f>-1&&(this.markers.splice(f,1),this.markerLayerOption.cluster&&(this.removePoint(f),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(o=>{o.getElement().style.opacity="0"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="0"})}show(){this.markers.map(o=>{o.getElement().style.opacity="1"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(o=>{o.addTo(this.scene)})}clear(){this.markers.forEach(o=>{o.remove()}),this.clusterMarkers.forEach(o=>{o.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(o,f){const{lng:v,lat:S}=o.getLnglat(),O={geometry:{type:"Point",coordinates:[v,S]},properties:_objectSpread(_objectSpread({},o.getExtData()),{},{marker_id:f})};this.points.push(O),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(o){const f=this.points.findIndex(v=>v.properties.marker_id===o);f>-1&&this.points.splice(f,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:o,minZoom:f=0,maxZoom:v}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:o,minZoom:f,maxZoom:v}),this.clusterIndex.load(this.points)}getClusterMarker(o,f){const v=o[0].concat(o[1]),S=this.clusterIndex.getClusters(v,f);this.clusterMarkers.forEach(O=>{O.remove()}),this.clusterMarkers=[],S.forEach(O=>{var L;const{field:k,method:V}=this.markerLayerOption.clusterOption;if((L=O.properties)!==null&&L!==void 0&&L.cluster_id){var Q;const ft=this.getLeaves((Q=O.properties)===null||Q===void 0?void 0:Q.cluster_id);if(O.properties.clusterData=ft,k&&V){const Tt=ft==null?void 0:ft.map(lr=>({[k]:lr.properties[k]})),se=Satistics.getColumn(Tt,k),Ve=Satistics.getSatByColumn(V,se),yn="point_"+V;O.properties[yn]=Ve.toFixed(2)}}const st=this.clusterMarker(O);this.clusterMarkers.push(st),st.addTo(this.scene)})}getLeaves(o,f=1/0,v=0){return o?this.clusterIndex.getLeaves(o,f,v):null}clusterMarker(o){const f=this.markerLayerOption.clusterOption,{element:v=this.generateElement.bind(this)}=f;return new Marker({element:v(o)}).setLnglat({lng:o.geometry.coordinates[0],lat:o.geometry.coordinates[1]})}normalMarker(o){const f=o.properties.marker_id;return this.markers[f]}update(){if(!this.mapsService||this.markers.length===0)return;const o=this.mapsService.getZoom(),f=this.mapsService.getBounds();(!this.bbox||Math.abs(o-this.zoom)>=1||!boundsContains(this.bbox,f))&&(this.bbox=padBounds(f,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom))}generateElement(o){const f=DOM.create("div","l7-marker-cluster"),v=DOM.create("div","",f),S=DOM.create("span","",v),{field:O,method:L}=this.markerLayerOption.clusterOption;o.properties.point_count=o.properties.point_count||1;const k=O&&L?o.properties["point_"+L]||o.properties[O]:o.properties.point_count;return S.textContent=k,f}}var ua=it(4157),Tn=it(1413),Me=it(4942);class la extends iu(){constructor(o){super(),(0,Me.Z)(this,"controlOption",void 0),(0,Me.Z)(this,"container",void 0),(0,Me.Z)(this,"isShow",void 0),(0,Me.Z)(this,"sceneContainer",void 0),(0,Me.Z)(this,"scene",void 0),(0,Me.Z)(this,"mapsService",void 0),(0,Me.Z)(this,"renderService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"controlService",void 0),(0,Me.Z)(this,"configService",void 0),la.controlCount++,this.controlOption=(0,Tn.Z)((0,Tn.Z)({},this.getDefault(o)),o||{})}getOptions(){return this.controlOption}setOptions(o){const f=this.getDefault(o);Object.entries(o).forEach(([v,S])=>{S===void 0&&(o[v]=f[v])}),"position"in o&&this.setPosition(o.position),"className"in o&&this.setClassName(o.className),"style"in o&&this.setStyle(o.style),this.controlOption=(0,Tn.Z)((0,Tn.Z)({},this.controlOption),o)}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd(),_t.SO.addClass(this.container,"l7-control");const{className:f,style:v}=this.controlOption;return f&&this.setClassName(f),v&&this.setStyle(v),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;_t.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return _t.SO.create("div")}onRemove(){}show(){const o=this.container;_t.SO.removeClass(o,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const o=this.container;_t.SO.addClass(o,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(o){return{position:X.d.TOPRIGHT,name:`${la.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(o){if(this.mapsService&&o&&o.screenX>0&&o.screenY>0){const f=this.mapsService.getContainer();f!==null&&f.focus()}}setPosition(o=X.d.TOPLEFT){const f=this.controlService;return f&&f.removeControl(this),this.controlOption.position=o,f&&f.addControl(this,this.sceneContainer),this}setClassName(o){const f=this.container,{className:v}=this.controlOption;v&&_t.SO.removeClass(f,v),o&&_t.SO.addClass(f,o)}setStyle(o){const f=this.container;o?f.setAttribute("style",o):f.removeAttribute("style")}insertContainer(){const o=this.controlOption.position,f=this.container;if(o instanceof Element)o.appendChild(f);else{const v=this.controlService.controlCorners[o];["bottomleft","bottomright","righttop","rightbottom"].includes(o)?v.insertBefore(f,v.firstChild):v.appendChild(f)}}checkUpdateOption(o,f){return f.some(v=>v in o)}}(0,Me.Z)(la,"controlCount",0);class ta extends null{constructor(...o){super(...o),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(o){if(this.isDisable=o,o){var f;(f=this.button)===null||f===void 0||f.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}createButton(o=""){return DOM.create("button",`l7-button-control ${o}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:o,btnText:f,btnIcon:v}=this.controlOption;return this.setBtnTitle(o),this.setBtnText(f),this.setBtnIcon(v),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(o){const{title:f,btnText:v,btnIcon:S}=o;this.checkUpdateOption(o,["title"])&&this.setBtnTitle(f),this.checkUpdateOption(o,["btnIcon"])&&this.setBtnIcon(S),this.checkUpdateOption(o,["btnText"])&&this.setBtnText(v),super.setOptions(o)}setBtnTitle(o){var f;(f=this.button)===null||f===void 0||f.setAttribute("title",o!=null?o:"")}setBtnIcon(o){if(this.buttonIcon&&DOM.remove(this.buttonIcon),o){var f;const O=(f=this.button)===null||f===void 0?void 0:f.firstChild;if(O){var v;(v=this.button)===null||v===void 0||v.insertBefore(o,O)}else{var S;(S=this.button)===null||S===void 0||S.appendChild(o)}this.buttonIcon=o}}setBtnText(o){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),o){let v=this.buttonText;if(!v){var f;v=DOM.create("div","l7-button-control__text"),(f=this.button)===null||f===void 0||f.appendChild(v),this.buttonText=v}v.innerText=o,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!o&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class Vo extends Gc.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(o,f){super(),(0,Me.Z)(this,"popperDOM",void 0),(0,Me.Z)(this,"contentDOM",void 0),(0,Me.Z)(this,"button",void 0),(0,Me.Z)(this,"option",void 0),(0,Me.Z)(this,"isShow",!1),(0,Me.Z)(this,"content",void 0),(0,Me.Z)(this,"timeout",null),(0,Me.Z)(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),_t.SO.removeClass(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&Vo.conflictPopperList.forEach(v=>{v!==this&&v.isShow&&v.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),(0,Me.Z)(this,"hide",()=>this.isShow?(_t.SO.addClass(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),(0,Me.Z)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),(0,Me.Z)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),(0,Me.Z)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),(0,Me.Z)(this,"onPopperUnClick",v=>{_t.SO.findParentElement(v.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),(0,Me.Z)(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),(0,Me.Z)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=o,this.option=f,this.init(),f.unique&&Vo.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(o){typeof o=="string"?this.contentDOM.innerHTML=o:o instanceof HTMLElement&&(_t.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(o)),this.content=o}init(){const{trigger:o}=this.option;this.popperDOM=this.createPopper(),o==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),_t.SO.remove(this.popperDOM)}resetPopperPosition(){const o={},{container:f,offset:v=[0,0],placement:S}=this.option,[O,L]=v,k=this.button.getBoundingClientRect(),V=f.getBoundingClientRect(),{left:Q,right:st,top:ft,bottom:Tt}=_t.SO.getDiffRect(k,V);let se=!1,Ve=!1;/^(left|right)/.test(S)?(S.includes("left")?o.right=`${k.width+st}px`:S.includes("right")&&(o.left=`${k.width+Q}px`),S.includes("start")?o.top=`${ft}px`:S.includes("end")?o.bottom=`${Tt}px`:(o.top=`${ft+k.height/2}px`,Ve=!0,o.transform=`translate(${O}px, calc(${L}px - 50%))`)):/^(top|bottom)/.test(S)&&(S.includes("top")?o.bottom=`${k.height+Tt}px`:S.includes("bottom")&&(o.top=`${k.height+ft}px`),S.includes("start")?o.left=`${Q}px`:S.includes("end")?o.right=`${st}px`:(o.left=`${Q+k.width/2}px`,se=!0,o.transform=`translate(calc(${O}px - 50%), ${L}px)`)),o.transform=`translate(calc(${O}px - ${se?"50%":"0%"}), calc(${L}px - ${Ve?"50%":"0%"})`;const yn=S.split("-");yn.length&&_t.SO.addClass(this.popperDOM,yn.map(lr=>`l7-popper-${lr}`).join(" ")),_t.SO.addStyle(this.popperDOM,_t.SO.css2Style(o))}createPopper(){const{container:o,className:f="",content:v}=this.option,S=_t.SO.create("div",`l7-popper l7-popper-hide ${f}`),O=_t.SO.create("div","l7-popper-content"),L=_t.SO.create("div","l7-popper-arrow");return S.appendChild(O),S.appendChild(L),o.appendChild(S),this.popperDOM=S,this.contentDOM=O,v&&this.setContent(v),S}}(0,Me.Z)(Vo,"conflictPopperList",[]);const ga={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class jo extends null{constructor(...o){super(...o),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(o){var f;const v=super.getDefault(o),S=(f=o==null?void 0:o.position)!==null&&f!==void 0?f:v.position;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{popperPlacement:S instanceof Element?"bottom":ga[S],popperTrigger:"click"})}onAdd(){const o=super.onAdd();return this.initPopper(),o}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:o,popperPlacement:f,popperTrigger:v}=this.controlOption,S=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:o,placement:f,trigger:v,container:S,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(o){if(super.setOptions(o),this.checkUpdateOption(o,["popperPlacement","popperTrigger","popperClassName"])){const f=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(f)}}}var Do=function(a){return a.ActiveOptionClassName="l7-select-control-item-active",a.OptionValueAttrKey="data-option-value",a.OptionIndexAttrKey="data-option-index",a}(Do||{});class hc extends null{constructor(...o){super(...o),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",f=>{const v=this.selectValue.includes(f.value),S=DOM.create("div",`l7-select-control-item ${v?Do.ActiveOptionClassName:""}`);this.getIsMultiple()?S.appendChild(this.createCheckbox(v)):S.appendChild(this.createRadio(v)),f.icon&&S.appendChild(f.icon);const O=DOM.create("span");return O.innerText=f.text,S.appendChild(O),S}),_defineProperty(this,"onItemClick",f=>{if(this.getIsMultiple()){const v=this.selectValue.findIndex(S=>S===f.value);v>-1?this.selectValue.splice(v,1):this.selectValue=[...this.selectValue,f.value]}else this.selectValue=[f.value];this.setSelectValue(this.selectValue)})}setOptions(o){super.setOptions(o);const{options:f}=o;f&&this.popper.setContent(this.getPopperContent(f))}onAdd(){const o=super.onAdd(),{defaultValue:f}=this.controlOption;return f&&(this.selectValue=this.transSelectValue(f)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),o}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(o,f=!0){const v=this.transSelectValue(o);this.optionDOMList.forEach(S=>{const O=S.getAttribute(Do.OptionValueAttrKey),L=S.querySelector("input[type=checkbox]"),k=S.querySelector("input[type=radio]"),V=v.includes(O),Q=(st,ft)=>{DOM.toggleClass(S,Do.ActiveOptionClassName,ft),st&&DOM.setChecked(st,ft)};Q(L,V),Q(k,V)}),this.selectValue=v,f&&this.emit("selectChange",this.getIsMultiple()?v:v[0])}getIsMultiple(){return!1}getPopperContent(o){const f=this.isImageOptions(),v=DOM.create("div",f?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(v,"l7-select-control--multiple");const S=o.map((O,L)=>{const k=f?this.createImageOption(O):this.createNormalOption(O);return k.setAttribute(Do.OptionValueAttrKey,O.value),k.setAttribute(Do.OptionIndexAttrKey,window.String(L)),k.addEventListener("click",this.onItemClick.bind(this,O)),k});return v.append(...S),this.optionDOMList=S,v}createImageOption(o){const f=this.selectValue.includes(o.value),v=DOM.create("div",`l7-select-control-item ${f?Do.ActiveOptionClassName:""}`),S=DOM.create("img");S.setAttribute("src",o.img),DOM.setUnDraggable(S),v.appendChild(S);const O=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(f));const L=DOM.create("span");return L.innerText=o.text,O.appendChild(L),v.appendChild(O),v}createCheckbox(o){const f=DOM.create("input");return f.setAttribute("type","checkbox"),o&&DOM.setChecked(f,!0),f}createRadio(o){const f=DOM.create("input");return f.setAttribute("type","radio"),o&&DOM.setChecked(f,!0),f}isImageOptions(){return!!this.controlOption.options.find(o=>o.img)}transSelectValue(o){return Array.isArray(o)?o:[o]}}const ml=a=>{const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.classList.add("l7-iconfont"),o.setAttribute("aria-hidden","true");const f=document.createElementNS("http://www.w3.org/2000/svg","use");return f.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${a}`),o.appendChild(f),o};class Bc extends null{constructor(...o){var f;super(...o),f=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:v}=f.controlOption;v==null||v(yield f.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...v){var S,O;const{imageType:L}=f.controlOption,{width:k=0,height:V=0}=(S=(O=f.mapsService.getContainer())===null||O===void 0?void 0:O.getBoundingClientRect())!==null&&S!==void 0?S:{},Q=document.createElement("canvas");Q.width=k,Q.height=V;const st=Q.getContext("2d");return(yield Promise.all(v.map(Tt=>new Promise(se=>{const Ve=new Image;Ve.onload=()=>{se(Ve)},Ve.src=Tt})))).forEach(Tt=>{st==null||st.drawImage(Tt,0,0,k,V)}),Q.toDataURL(`image/${L}`)}))}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var o=this;return _asyncToGenerator(function*(){const f=yield o.mapsService.exportMap("png"),v=yield o.scene.exportPng("png");return o.mergeImage(...[f,v].filter(S=>S))})()}}const Wl=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],vs=(()=>{if(typeof document=="undefined")return!1;const a=Wl[0],o={};for(const f of Wl)if((f==null?void 0:f[1])in document){for(const[S,O]of f.entries())o[a[S]]=O;return o}return!1})(),Ks={change:vs.fullscreenchange,error:vs.fullscreenerror};let sl={request(a=document.documentElement,o){return new Promise((f,v)=>{const S=()=>{sl.off("change",S),f()};sl.on("change",S);const O=a[vs.requestFullscreen](o);O instanceof Promise&&O.then(S).catch(v)})},exit(){return new Promise((a,o)=>{if(!sl.isFullscreen){a();return}const f=()=>{sl.off("change",f),a()};sl.on("change",f);const v=document[vs.exitFullscreen]();v instanceof Promise&&v.then(f).catch(o)})},toggle(a,o){return sl.isFullscreen?sl.exit():sl.request(a,o)},onchange(a){sl.on("change",a)},onerror(a){sl.on("error",a)},on(a,o){const f=Ks[a];f&&document.addEventListener(f,o,!1)},off(a,o){const f=Ks[a];f&&document.removeEventListener(f,o,!1)},raw:vs};Object.defineProperties(sl,{isFullscreen:{get:()=>!!document[vs.fullscreenElement]},element:{enumerable:!0,get:()=>{var a;return(a=document[vs.fullscreenElement])!==null&&a!==void 0?a:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[vs.fullscreenEnabled]}}),vs||(sl={isEnabled:!1});var vl=null;class _f extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(f.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:v,btnIcon:S,title:O,exitBtnText:L,exitBtnIcon:k,exitTitle:V}=this.controlOption;this.isFullscreen?(this.setBtnTitle(V),this.setBtnText(L),this.setBtnIcon(k)):(this.setBtnTitle(O),this.setBtnText(v),this.setBtnIcon(S)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(o){const{exitBtnText:f,exitBtnIcon:v,exitTitle:S}=o;this.isFullscreen&&(this.checkUpdateOption(o,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(o,["exitBtnText"])&&this.setBtnText(f),this.checkUpdateOption(o,["exitTitle"])&&this.setBtnTitle(S)),super.setOptions(o)}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),o}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class ol extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"getGeoLocation",()=>new Promise((v,S)=>{window.navigator.geolocation.getCurrentPosition(({coords:O})=>{const{longitude:L,latitude:k}=O!=null?O:{};!isNaN(L)&&!isNaN(k)?v([L,k]):S()},O=>{S(O)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:v}=f.controlOption,S=yield f.getGeoLocation(),O=f.mapsService.getZoom();f.mapsService.setZoomAndCenter(O>15?O:15,v?yield v(S):S)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}}function sf(a){return Object.keys(a!=null?a:{}).every(o=>["layer","name","img"].includes(o))}class Vu extends null{constructor(...o){super(...o),_defineProperty(this,"onLayerChange",()=>{var f;(f=this.controlOption.layers)!==null&&f!==void 0&&f.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(f=>{const v=this.selectValue.includes(f.name),S=f.isVisible();v&&!S&&f.show(),!v&&S&&f.hide()})})}get layers(){const o=this.layerService,{layers:f}=this.controlOption;if(Array.isArray(f)&&f.length){const v=[];return f.forEach(S=>{if(S instanceof Object&&(sf(S)?v.push(S.layer):v.push(S)),typeof S=="string"){const O=o.getLayer(S)||o.getLayerByName(S);O&&v.push(O)}}),v}return o.getLayers()||[]}getDefault(o){var f;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(f=o==null?void 0:o.multiple)!==null&&f!==void 0?f:!0})}getLayerVisible(){return this.layers.filter(o=>o.isVisible()).map(o=>o.name)}getLayerOptions(){const{layers:o}=this.controlOption,f=o==null?void 0:o.every(v=>v.img);return o?o==null?void 0:o.map(v=>{if(sf(v))return{text:v.name||v.layer.name,value:v.layer.name,img:f?v.img:void 0};if(typeof v=="string"){const S=this.layerService.getLayer(v)||this.layerService.getLayerByName(v);return{text:S==null?void 0:S.name,value:S==null?void 0:S.name}}return{text:v.name,value:v.name}}):this.layers.map(v=>({text:v.name,value:v.name}))}setOptions(o){const f=this.checkUpdateOption(o,["layers","multiple"]);super.setOptions(o),f&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((o,f)=>{f===0?o.show():o.hide()})}onAdd(){var o;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class Vd extends la{getDefault(){return{position:X.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const o=_t.SO.create("div","l7-control-logo");return this.setLogoContent(o),o}onRemove(){return null}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["img","href"])&&(_t.SO.clearChildren(this.container),this.setLogoContent(this.container))}setLogoContent(o){const{href:f,img:v}=this.controlOption,S=_t.SO.create("img");if(S.setAttribute("src",v),S.setAttribute("aria-label","AntV logo"),_t.SO.setUnDraggable(S),f){const O=_t.SO.create("a","l7-control-logo-link");O.target="_blank",O.href=f,O.rel="noopener nofollow",O.setAttribute("rel","noopener nofollow"),O.appendChild(S),o.appendChild(O)}else o.appendChild(S)}}const Ff={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},Sh={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class Zd extends null{constructor(...o){super(...o),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const o=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([f,v])=>typeof v=="string"&&f!=="blank").map(([f,v])=>{var S;const{text:O,img:L}=(S=o[f])!==null&&S!==void 0?S:{};return{text:O!=null?O:f,value:v,img:L,key:f}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var o;if((o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var f,v;const S=this.controlOption.defaultValue;this.controlOption.defaultValue=(f=(v=this.controlOption.options.find(O=>O.key===S))===null||v===void 0?void 0:v.value)!==null&&f!==void 0?f:S}else{const S=this.getMapStyle();S?this.controlOption.defaultValue=S:this.mapsService.map.once("styledata",()=>{const O=this.mapsService.getMapStyle();this.controlOption.defaultValue=O,this.setSelectValue(O,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class qh extends null{constructor(...o){super(...o),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",f=>{let v=this.location;const S=f.lngLat||f.lnglat,{transform:O}=this.controlOption;S&&(v=[S.lng,S.lat]),this.location=v,O&&(v=O(v)),this.insertLocation2HTML(v),this.emit("locationChange",v)})}getLocation(){return this.location}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMLEFT,transform:([f,v])=>[+(+f).toFixed(6),+(+v).toFixed(6)]})}onAdd(){const o=DOM.create("div","l7-control-mouse-location");return o.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),o}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(o){this.container.innerText=o.join(", ")}}class xf extends null{constructor(...o){super(...o),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const f=this.mapsService,{maxWidth:v}=this.controlOption,S=f.getSize()[1]/2,O=f.containerToLngLat([0,S]),L=f.containerToLngLat([v,S]),k=lnglatDistance([O.lng,O.lat],[L.lng,L.lat]);this.updateScales(k)})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const f=DOM.create("div","l7-control-scale");this.resetScaleLines(f);const{updateWhenIdle:v}=this.controlOption;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),f}onRemove(){const{updateWhenIdle:o}=this.controlOption;this.mapsService.off(o?"zoomend":"zoomchange",this.update),this.mapsService.off(o?"moveend":"mapmove",this.update)}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(o){const{metric:f,imperial:v}=this.controlOption;f&&o&&this.updateMetric(o),v&&o&&this.updateImperial(o)}resetScaleLines(o){DOM.clearChildren(o);const{metric:f,imperial:v,maxWidth:S,lockWidth:O}=this.controlOption;O&&DOM.addStyle(o,`width: ${S}px`),f&&(this.mScale=DOM.create("div","l7-control-scale-line",o)),v&&(this.iScale=DOM.create("div","l7-control-scale-line",o)),this.update()}updateScale(o,f,v){const{maxWidth:S}=this.controlOption;o.style.width=Math.round(S*v)+"px",o.innerHTML=f}getRoundNum(o){const f=Math.pow(10,(Math.floor(o)+"").length-1);let v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}updateMetric(o){const f=this.getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this.updateScale(this.mScale,v,f/o)}updateImperial(o){const f=o*3.2808399;let v,S,O;f>5280?(v=f/5280,S=this.getRoundNum(v),this.updateScale(this.iScale,S+" mi",S/v)):(O=this.getRoundNum(f),this.updateScale(this.iScale,O+" ft",O/f))}}var wi=it(15861),fl=it(45987);class ya{constructor(){(0,Me.Z)(this,"mapService",void 0),(0,Me.Z)(this,"fontService",void 0)}apply(o,{styleAttributeService:f,mapService:v,fontService:S}){var O=this;this.mapService=v,this.fontService=S,o.hooks.init.tapPromise("DataMappingPlugin",(0,wi.Z)(function*(){o.log(X.Or.MappingStart,X.KD.INIT),O.generateMaping(o,{styleAttributeService:f}),o.log(X.Or.MappingEnd,X.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var L=(0,wi.Z)(function*(k){if(!k)return k;o.dataState.dataMappingNeedUpdate=!1,o.log(X.Or.MappingStart,X.KD.UPDATE);const V=O.generateMaping(o,{styleAttributeService:f});return o.log(X.Or.MappingEnd,X.KD.UPDATE),V});return function(k){return L.apply(this,arguments)}}()),o.hooks.beforeRender.tap("DataMappingPlugin",()=>{const L=o.getSource();if(o.layerModelNeedUpdate||!L||!L.inited)return;const k=f.getLayerStyleAttributes()||[],V=f.getLayerStyleAttribute("filter"),{dataArray:Q}=L.data;if(Array.isArray(Q)&&Q.length===0)return;const st=k.filter(Tt=>Tt.needRemapping);let ft=Q;if(V!=null&&V.needRemapping&&V!==null&&V!==void 0&&V.scale&&(ft=Q.filter(Tt=>this.applyAttributeMapping(V,Tt)[0])),st.length){const Tt=this.mapping(o,st,ft,o.getEncodedData());o.setEncodedData(Tt)}})}generateMaping(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],S=f.getLayerStyleAttribute("filter"),{dataArray:O}=o.getSource().data;let L=O;S!=null&&S.scale&&(L=O.filter(V=>this.applyAttributeMapping(S,V)[0])),L=o.processData(L);const k=this.mapping(o,v,L,void 0);return o.setEncodedData(k),o.emit("dataUpdate",null),!0}mapping(o,f,v,S){const O=f.filter(k=>k.scale!==void 0).filter(k=>k.name!=="filter"),L=v.map((k,V)=>{const Q=S?S[V]:{},st=(0,Tn.Z)({id:k._id,coordinates:k.coordinates},Q);return O.forEach(ft=>{let Tt=this.applyAttributeMapping(ft,k);(ft.name==="color"||ft.name==="stroke")&&(Tt=Tt.map(se=>(0,_t.CI)(se))),st[ft.name]=Array.isArray(Tt)&&Tt.length===1?Tt[0]:Tt,ft.name==="shape"&&(st.shape=this.fontService.getIconFontKey(st[ft.name]))}),st});return f.forEach(k=>{k.needRemapping=!1}),this.adjustData2SimpleCoordinates(L),L}adjustData2SimpleCoordinates(o){o.length>0&&this.mapService.version==="SIMPLE"&&o.map(f=>{f.simpleCoordinate||(f.coordinates=this.unProjectCoordinates(f.coordinates),f.simpleCoordinate=!0)})}unProjectCoordinates(o){if(typeof o[0]=="number")return this.mapService.simpleMapCoord.unproject(o);if(o[0]&&o[0][0]instanceof Array){const f=[];return o.map(v=>{const S=[];v.map(O=>{S.push(this.mapService.simpleMapCoord.unproject(O))}),f.push(S)}),f}else{const f=[];return o.map(v=>{f.push(this.mapService.simpleMapCoord.unproject(v))}),f}}applyAttributeMapping(o,f){var v;if(!o.scale)return[];const S=(o==null||(v=o.scale)===null||v===void 0?void 0:v.scalers)||[],O=[];return S.forEach(({field:k})=>{var V;(f.hasOwnProperty(k)||((V=o.scale)===null||V===void 0?void 0:V.type)==="variable")&&O.push(f[k])}),o.mapping?o.mapping(O):[]}getArrowPoints(o,f){const v=[f[0]-o[0],f[1]-o[1]],S=(0,_t.Fv)(v);return[o[0]+S[0]*1e-4,o[1]+S[1]*1e-4]}}class gs{constructor(){(0,Me.Z)(this,"mapService",void 0)}apply(o){var f=this;this.mapService=o.getContainer().mapService,o.hooks.init.tapPromise("DataSourcePlugin",(0,wi.Z)(function*(){o.log(X.Or.SourceInitStart,X.KD.INIT);let v=o.getSource();if(!v){const{data:S,options:O}=o.sourceOption||o.defaultSourceConfig;v=new zi(S,O),o.setSource(v)}v.inited?(f.updateClusterData(o),o.log(X.Or.SourceInitEnd,X.KD.INIT)):yield new Promise(S=>{v.on("update",O=>{O.type==="inited"&&(f.updateClusterData(o),o.log(X.Or.SourceInitEnd,X.KD.INIT)),S(null)})})})),o.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,wi.Z)(function*(){const v=f.updateClusterData(o),S=o.dataState.dataSourceNeedUpdate;return o.dataState.dataSourceNeedUpdate=!1,v||S}))}updateClusterData(o){if(o.isTileLayer||o.tileLayer||!o.getSource())return!1;const f=o.getSource(),v=f.cluster,{zoom:S=0}=f.clusterOptions,O=this.mapService.getZoom()-1,L=o.dataState.dataSourceNeedUpdate;return v&&L&&f.updateClusterData(Math.floor(O)),v&&Math.abs(o.clusterZoom-O)>=1?(S!==Math.floor(O)&&f.updateClusterData(Math.floor(O)),o.clusterZoom=O,!0):!1}}var Bl=it(64599),Zu=it.n(Bl);function No(a,o){var f,v;if(o===void 0){var S=Zu()(a),O;try{for(S.s();!(O=S.n()).done;){var L=O.value;L!=null&&(f===void 0?L>=L&&(f=v=L):(f>L&&(f=L),v<L&&(v=L)))}}catch(ft){S.e(ft)}finally{S.f()}}else{var k=-1,V=Zu()(a),Q;try{for(V.s();!(Q=V.n()).done;){var st=Q.value;(st=o(st,++k,a))!=null&&(f===void 0?st>=st&&(f=v=st):(f>st&&(f=st),v<st&&(v=st)))}}catch(ft){V.e(ft)}finally{V.f()}}return[f,v]}var Fl=it(37620);function Xl(a,o,f,v,S){var O=a*a,L=O*a;return((1-3*a+3*O-L)*o+(4-6*O+3*L)*f+(1+3*a+3*O-3*L)*v+L*S)/6}function bf(a){var o=a.length-1;return function(f){var v=f<=0?f=0:f>=1?(f=1,o-1):Math.floor(f*o),S=a[v],O=a[v+1],L=v>0?a[v-1]:2*S-O,k=v<o-1?a[v+2]:2*O-S;return Xl((f-v/o)*o,L,S,O,k)}}function Hd(a){var o=a.length;return function(f){var v=Math.floor(((f%=1)<0?++f:f)*o),S=a[(v+o-1)%o],O=a[v%o],L=a[(v+1)%o],k=a[(v+2)%o];return Xl((f-v/o)*o,S,O,L,k)}}function lf(a){return function(){return a}}function Ep(a,o){return function(f){return a+f*o}}function Ad(a,o,f){return a=Math.pow(a,f),o=Math.pow(o,f)-a,f=1/f,function(v){return Math.pow(a+v*o,f)}}function Is(a,o){var f=o-a;return f?Ep(a,f>180||f<-180?f-360*Math.round(f/360):f):constant(isNaN(a)?o:a)}function cf(a){return(a=+a)==1?lh:function(o,f){return f-o?Ad(o,f,a):lf(isNaN(o)?f:o)}}function lh(a,o){var f=o-a;return f?Ep(a,f):lf(isNaN(a)?o:a)}var D0=function a(o){var f=cf(o);function v(S,O){var L=f((S=(0,Fl.B8)(S)).r,(O=(0,Fl.B8)(O)).r),k=f(S.g,O.g),V=f(S.b,O.b),Q=lh(S.opacity,O.opacity);return function(st){return S.r=L(st),S.g=k(st),S.b=V(st),S.opacity=Q(st),S+""}}return v.gamma=a,v}(1);function io(a){return function(o){var f=o.length,v=new Array(f),S=new Array(f),O=new Array(f),L,k;for(L=0;L<f;++L)k=(0,Fl.B8)(o[L]),v[L]=k.r||0,S[L]=k.g||0,O[L]=k.b||0;return v=a(v),S=a(S),O=a(O),k.opacity=1,function(V){return k.r=v(V),k.g=S(V),k.b=O(V),k+""}}}var gu=io(bf),ty=io(Hd);function lm(a,o){return a<o?-1:a>o?1:a>=o?0:NaN}function Sp(a){return a.length===1&&(a=ey(a)),{left:function(o,f,v,S){for(v==null&&(v=0),S==null&&(S=o.length);v<S;){var O=v+S>>>1;a(o[O],f)<0?v=O+1:S=O}return v},right:function(o,f,v,S){for(v==null&&(v=0),S==null&&(S=o.length);v<S;){var O=v+S>>>1;a(o[O],f)>0?S=O:v=O+1}return v}}}function ey(a){return function(o,f){return lm(a(o),f)}}var Wv=Sp(lm),ny=Wv.right,cm=Wv.left,um=ny,N0=Array.prototype,ry=N0.slice,Tp=N0.map,wp=Math.sqrt(50),tv=Math.sqrt(10),ev=Math.sqrt(2);function iy(a,o,f){var v,S=-1,O,L,k;if(o=+o,a=+a,f=+f,a===o&&f>0)return[a];if((v=o<a)&&(O=a,a=o,o=O),(k=Gd(a,o,f))===0||!isFinite(k))return[];if(k>0)for(a=Math.ceil(a/k),o=Math.floor(o/k),L=new Array(O=Math.ceil(o-a+1));++S<O;)L[S]=(a+S)*k;else for(a=Math.floor(a*k),o=Math.ceil(o*k),L=new Array(O=Math.ceil(a-o+1));++S<O;)L[S]=(a-S)/k;return v&&L.reverse(),L}function Gd(a,o,f){var v=(o-a)/Math.max(0,f),S=Math.floor(Math.log(v)/Math.LN10),O=v/Math.pow(10,S);return S>=0?(O>=wp?10:O>=tv?5:O>=ev?2:1)*Math.pow(10,S):-Math.pow(10,-S)/(O>=wp?10:O>=tv?5:O>=ev?2:1)}function e0(a,o,f){var v=Math.abs(o-a)/Math.max(0,f),S=Math.pow(10,Math.floor(Math.log(v)/Math.LN10)),O=v/S;return O>=wp?S*=10:O>=tv?S*=5:O>=ev&&(S*=2),o<a?-S:S}function $h(){var a=identity,o=extent,f=sturges;function v(S){var O,L=S.length,k,V=new Array(L);for(O=0;O<L;++O)V[O]=a(S[O],O,S);var Q=o(V),st=Q[0],ft=Q[1],Tt=f(V,st,ft);Array.isArray(Tt)||(Tt=tickStep(st,ft,Tt),Tt=range(Math.ceil(st/Tt)*Tt,ft,Tt));for(var se=Tt.length;Tt[0]<=st;)Tt.shift(),--se;for(;Tt[se-1]>ft;)Tt.pop(),--se;var Ve=new Array(se+1),yn;for(O=0;O<=se;++O)yn=Ve[O]=[],yn.x0=O>0?Tt[O-1]:st,yn.x1=O<se?Tt[O]:ft;for(O=0;O<L;++O)k=V[O],st<=k&&k<=ft&&Ve[bisect(Tt,k,0,se)].push(S[O]);return Ve}return v.value=function(S){return arguments.length?(a=typeof S=="function"?S:constant(S),v):a},v.domain=function(S){return arguments.length?(o=typeof S=="function"?S:constant([S[0],S[1]]),v):o},v.thresholds=function(S){return arguments.length?(f=typeof S=="function"?S:Array.isArray(S)?constant(slice.call(S)):constant(S),v):f},v}function nv(a,o,f){return a=map.call(a,number).sort(ascending),Math.ceil((f-o)/(2*(quantile(a,.75)-quantile(a,.25))*Math.pow(a.length,-1/3)))}function Kh(a){return a===null?NaN:+a}function k0(a,o,f){if(f==null&&(f=Kh),!!(v=a.length)){if((o=+o)<=0||v<2)return+f(a[0],0,a);if(o>=1)return+f(a[v-1],v-1,a);var v,S=(v-1)*o,O=Math.floor(S),L=+f(a[O],O,a),k=+f(a[O+1],O+1,a);return L+(k-L)*(S-O)}}var Yc="$";function Ap(){}Ap.prototype=Qs.prototype={constructor:Ap,has:function(a){return Yc+a in this},get:function(a){return this[Yc+a]},set:function(a,o){return this[Yc+a]=o,this},remove:function(a){var o=Yc+a;return o in this&&delete this[o]},clear:function(){for(var a in this)a[0]===Yc&&delete this[a]},keys:function(){var a=[];for(var o in this)o[0]===Yc&&a.push(o.slice(1));return a},values:function(){var a=[];for(var o in this)o[0]===Yc&&a.push(this[o]);return a},entries:function(){var a=[];for(var o in this)o[0]===Yc&&a.push({key:o.slice(1),value:this[o]});return a},size:function(){var a=0;for(var o in this)o[0]===Yc&&++a;return a},empty:function(){for(var a in this)if(a[0]===Yc)return!1;return!0},each:function(a){for(var o in this)o[0]===Yc&&a(this[o],o.slice(1),this)}};function Qs(a,o){var f=new Ap;if(a instanceof Ap)a.each(function(k,V){f.set(V,k)});else if(Array.isArray(a)){var v=-1,S=a.length,O;if(o==null)for(;++v<S;)f.set(v,a[v]);else for(;++v<S;)f.set(o(O=a[v],v,a),O)}else if(a)for(var L in a)f.set(L,a[L]);return f}var Ef=Qs;function B0(){var a=[],o=[],f,v,S;function O(k,V,Q,st){if(V>=a.length)return f!=null&&k.sort(f),v!=null?v(k):k;for(var ft=-1,Tt=k.length,se=a[V++],Ve,yn,lr=map(),Nr,Ln=Q();++ft<Tt;)(Nr=lr.get(Ve=se(yn=k[ft])+""))?Nr.push(yn):lr.set(Ve,[yn]);return lr.each(function(ci,Fi){st(Ln,Fi,O(ci,V,Q,st))}),Ln}function L(k,V){if(++V>a.length)return k;var Q,st=o[V-1];return v!=null&&V>=a.length?Q=k.entries():(Q=[],k.each(function(ft,Tt){Q.push({key:Tt,values:L(ft,V)})})),st!=null?Q.sort(function(ft,Tt){return st(ft.key,Tt.key)}):Q}return S={object:function(k){return O(k,0,Wd,Op)},map:function(k){return O(k,0,dc,Xd)},entries:function(k){return L(O(k,0,dc,Xd),0)},key:function(k){return a.push(k),S},sortKeys:function(k){return o[a.length-1]=k,S},sortValues:function(k){return f=k,S},rollup:function(k){return v=k,S}}}function Wd(){return{}}function Op(a,o,f){a[o]=f}function dc(){return map()}function Xd(a,o,f){a.set(o,f)}function Qh(){}var gl=Ef.prototype;Qh.prototype=Cp.prototype={constructor:Qh,has:gl.has,add:function(a){return a+="",this[Yc+a]=a,this},remove:gl.remove,clear:gl.clear,values:gl.keys,size:gl.size,empty:gl.empty,each:gl.each};function Cp(a,o){var f=new Qh;if(a instanceof Qh)a.each(function(O){f.add(O)});else if(a){var v=-1,S=a.length;if(o==null)for(;++v<S;)f.add(a[v]);else for(;++v<S;)f.add(o(a[v],v,a))}return f}var n0=null,fm=Array.prototype,Th=fm.map,su=fm.slice;function yu(a,o){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(o).domain(a);break}return this}function r0(a,o){switch(arguments.length){case 0:break;case 1:this.interpolator(a);break;default:this.interpolator(o).domain(a);break}return this}var i0={name:"implicit"};function Rp(){var a=Ef(),o=[],f=[],v=i0;function S(O){var L=O+"",k=a.get(L);if(!k){if(v!==i0)return v;a.set(L,k=o.push(O))}return f[(k-1)%f.length]}return S.domain=function(O){if(!arguments.length)return o.slice();o=[],a=Ef();for(var L=-1,k=O.length,V,Q;++L<k;)a.has(Q=(V=O[L])+"")||a.set(Q,o.push(V));return S},S.range=function(O){return arguments.length?(f=su.call(O),S):f.slice()},S.unknown=function(O){return arguments.length?(v=O,S):v},S.copy=function(){return Rp(o,f).unknown(v)},yu.apply(S,arguments),S}function Sf(){var a=ordinal().unknown(void 0),o=a.domain,f=a.range,v=[0,1],S,O,L=!1,k=0,V=0,Q=.5;delete a.unknown;function st(){var ft=o().length,Tt=v[1]<v[0],se=v[Tt-0],Ve=v[1-Tt];S=(Ve-se)/Math.max(1,ft-k+V*2),L&&(S=Math.floor(S)),se+=(Ve-se-S*(ft-k))*Q,O=S*(1-k),L&&(se=Math.round(se),O=Math.round(O));var yn=sequence(ft).map(function(lr){return se+S*lr});return f(Tt?yn.reverse():yn)}return a.domain=function(ft){return arguments.length?(o(ft),st()):o()},a.range=function(ft){return arguments.length?(v=[+ft[0],+ft[1]],st()):v.slice()},a.rangeRound=function(ft){return v=[+ft[0],+ft[1]],L=!0,st()},a.bandwidth=function(){return O},a.step=function(){return S},a.round=function(ft){return arguments.length?(L=!!ft,st()):L},a.padding=function(ft){return arguments.length?(k=Math.min(1,V=+ft),st()):k},a.paddingInner=function(ft){return arguments.length?(k=Math.min(1,ft),st()):k},a.paddingOuter=function(ft){return arguments.length?(V=+ft,st()):V},a.align=function(ft){return arguments.length?(Q=Math.max(0,Math.min(1,ft)),st()):Q},a.copy=function(){return Sf(o(),v).round(L).paddingInner(k).paddingOuter(V).align(Q)},initRange.apply(st(),arguments)}function Od(a){var o=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return Od(o())},a}function oy(){return Od(Sf.apply(null,arguments).paddingInner(1))}function ay(a,o){return(isNumberArray(o)?numberArray:rv)(a,o)}function rv(a,o){var f=o?o.length:0,v=a?Math.min(f,a.length):0,S=new Array(v),O=new Array(f),L;for(L=0;L<v;++L)S[L]=Mp(a[L],o[L]);for(;L<f;++L)O[L]=o[L];return function(k){for(L=0;L<v;++L)O[L]=S[L](k);return O}}function F0(a,o){var f=new Date;return a=+a,o=+o,function(v){return f.setTime(a*(1-v)+o*v),f}}function Jh(a,o){return a=+a,o=+o,function(f){return a*(1-f)+o*f}}function hm(a,o){var f={},v={},S;(a===null||typeof a!="object")&&(a={}),(o===null||typeof o!="object")&&(o={});for(S in o)S in a?f[S]=Mp(a[S],o[S]):v[S]=o[S];return function(O){for(S in f)v[S]=f[S](O);return v}}var Uf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o0=new RegExp(Uf.source,"g");function Yd(a){return function(){return a}}function qd(a){return function(o){return a(o)+""}}function iv(a,o){var f=Uf.lastIndex=o0.lastIndex=0,v,S,O,L=-1,k=[],V=[];for(a=a+"",o=o+"";(v=Uf.exec(a))&&(S=o0.exec(o));)(O=S.index)>f&&(O=o.slice(f,O),k[L]?k[L]+=O:k[++L]=O),(v=v[0])===(S=S[0])?k[L]?k[L]+=S:k[++L]=S:(k[++L]=null,V.push({i:L,x:Jh(v,S)})),f=o0.lastIndex;return f<o.length&&(O=o.slice(f),k[L]?k[L]+=O:k[++L]=O),k.length<2?V[0]?qd(V[0].x):Yd(o):(o=V.length,function(Q){for(var st=0,ft;st<o;++st)k[(ft=V[st]).i]=ft.x(Q);return k.join("")})}function wh(a,o){o||(o=[]);var f=a?Math.min(o.length,a.length):0,v=o.slice(),S;return function(O){for(S=0;S<f;++S)v[S]=a[S]*(1-O)+o[S]*O;return v}}function a0(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function Mp(a,o){var f=typeof o,v;return o==null||f==="boolean"?lf(o):(f==="number"?Jh:f==="string"?(v=(0,Fl.ZP)(o))?(o=v,D0):iv:o instanceof Fl.ZP?D0:o instanceof Date?F0:a0(o)?wh:Array.isArray(o)?rv:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?hm:Jh)(a,o)}function _u(a,o){return a=+a,o=+o,function(f){return Math.round(a*(1-f)+o*f)}}function lu(a){return function(){return a}}function pc(a){return+a}var Hu=[0,1];function xu(a){return a}function Pp(a,o){return(o-=a=+a)?function(f){return(f-a)/o}:lu(isNaN(o)?NaN:.5)}function dm(a){var o=a[0],f=a[a.length-1],v;return o>f&&(v=o,o=f,f=v),function(S){return Math.max(o,Math.min(f,S))}}function A_(a,o,f){var v=a[0],S=a[1],O=o[0],L=o[1];return S<v?(v=Pp(S,v),O=f(L,O)):(v=Pp(v,S),O=f(O,L)),function(k){return O(v(k))}}function Xv(a,o,f){var v=Math.min(a.length,o.length)-1,S=new Array(v),O=new Array(v),L=-1;for(a[v]<a[0]&&(a=a.slice().reverse(),o=o.slice().reverse());++L<v;)S[L]=Pp(a[L],a[L+1]),O[L]=f(o[L],o[L+1]);return function(k){var V=um(a,k,1,v)-1;return O[V](S[V](k))}}function U0(a,o){return o.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function z0(){var a=Hu,o=Hu,f=Mp,v,S,O,L=xu,k,V,Q;function st(){return k=Math.min(a.length,o.length)>2?Xv:A_,V=Q=null,ft}function ft(Tt){return isNaN(Tt=+Tt)?O:(V||(V=k(a.map(v),o,f)))(v(L(Tt)))}return ft.invert=function(Tt){return L(S((Q||(Q=k(o,a.map(v),Jh)))(Tt)))},ft.domain=function(Tt){return arguments.length?(a=Th.call(Tt,pc),L===xu||(L=dm(a)),st()):a.slice()},ft.range=function(Tt){return arguments.length?(o=su.call(Tt),st()):o.slice()},ft.rangeRound=function(Tt){return o=su.call(Tt),f=_u,st()},ft.clamp=function(Tt){return arguments.length?(L=Tt?dm(a):xu,ft):L!==xu},ft.interpolate=function(Tt){return arguments.length?(f=Tt,st()):f},ft.unknown=function(Tt){return arguments.length?(O=Tt,ft):O},function(Tt,se){return v=Tt,S=se,st()}}function ov(a,o){return z0()(a,o)}var cu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pm(a){if(!(o=cu.exec(a)))throw new Error("invalid format: "+a);var o;return new Ol({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}pm.prototype=Ol.prototype;function Ol(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}Ol.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Gu(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function Ah(a,o){if((f=(a=o?a.toExponential(o-1):a.toExponential()).indexOf("e"))<0)return null;var f,v=a.slice(0,f);return[v.length>1?v[0]+v.slice(2):v,+a.slice(f+1)]}function Oh(a){return a=Ah(Math.abs(a)),a?a[1]:NaN}function av(a,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Oh(o)/3)))*3-Oh(Math.abs(a)))}function Yv(a,o){return function(f,v){for(var S=f.length,O=[],L=0,k=a[0],V=0;S>0&&k>0&&(V+k+1>v&&(k=Math.max(1,v-V)),O.push(f.substring(S-=k,S+k)),!((V+=k+1)>v));)k=a[L=(L+1)%a.length];return O.reverse().join(o)}}function qv(a){return function(o){return o.replace(/[0-9]/g,function(f){return a[+f]})}}function $v(a){t:for(var o=a.length,f=1,v=-1,S;f<o;++f)switch(a[f]){case".":v=S=f;break;case"0":v===0&&(v=f),S=f;break;default:if(!+a[f])break t;v>0&&(v=0);break}return v>0?a.slice(0,v)+a.slice(S+1):a}var xt;function Pe(a,o){var f=Ah(a,o);if(!f)return a+"";var v=f[0],S=f[1],O=S-(xt=Math.max(-8,Math.min(8,Math.floor(S/3)))*3)+1,L=v.length;return O===L?v:O>L?v+new Array(O-L+1).join("0"):O>0?v.slice(0,O)+"."+v.slice(O):"0."+new Array(1-O).join("0")+Ah(a,Math.max(0,o+O-1))[0]}function gn(a,o){var f=Ah(a,o);if(!f)return a+"";var v=f[0],S=f[1];return S<0?"0."+new Array(-S).join("0")+v:v.length>S+1?v.slice(0,S+1)+"."+v.slice(S+1):v+new Array(S-v.length+2).join("0")}var Cr={"%":function(a,o){return(a*100).toFixed(o)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:Gu,e:function(a,o){return a.toExponential(o)},f:function(a,o){return a.toFixed(o)},g:function(a,o){return a.toPrecision(o)},o:function(a){return Math.round(a).toString(8)},p:function(a,o){return gn(a*100,o)},r:gn,s:Pe,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function Hr(a){return a}var Rr=Array.prototype.map,gr=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function bi(a){var o=a.grouping===void 0||a.thousands===void 0?Hr:Yv(Rr.call(a.grouping,Number),a.thousands+""),f=a.currency===void 0?"":a.currency[0]+"",v=a.currency===void 0?"":a.currency[1]+"",S=a.decimal===void 0?".":a.decimal+"",O=a.numerals===void 0?Hr:qv(Rr.call(a.numerals,String)),L=a.percent===void 0?"%":a.percent+"",k=a.minus===void 0?"-":a.minus+"",V=a.nan===void 0?"NaN":a.nan+"";function Q(ft){ft=pm(ft);var Tt=ft.fill,se=ft.align,Ve=ft.sign,yn=ft.symbol,lr=ft.zero,Nr=ft.width,Ln=ft.comma,ci=ft.precision,Fi=ft.trim,So=ft.type;So==="n"?(Ln=!0,So="g"):Cr[So]||(ci===void 0&&(ci=12),Fi=!0,So="g"),(lr||Tt==="0"&&se==="=")&&(lr=!0,Tt="0",se="=");var Ji=yn==="$"?f:yn==="#"&&/[boxX]/.test(So)?"0"+So.toLowerCase():"",Vr=yn==="$"?v:/[%p]/.test(So)?L:"",Hi=Cr[So],za=/[defgprs%]/.test(So);ci=ci===void 0?6:/[gprs]/.test(So)?Math.max(1,Math.min(21,ci)):Math.max(0,Math.min(20,ci));function ps(Wo){var as=Ji,Zs=Vr,Dh,Id,Nh;if(So==="c")Zs=Hi(Wo)+Zs,Wo="";else{Wo=+Wo;var ll=Wo<0||1/Wo<0;if(Wo=isNaN(Wo)?V:Hi(Math.abs(Wo),ci),Fi&&(Wo=$v(Wo)),ll&&+Wo==0&&Ve!=="+"&&(ll=!1),as=(ll?Ve==="("?Ve:k:Ve==="-"||Ve==="("?"":Ve)+as,Zs=(So==="s"?gr[8+xt/3]:"")+Zs+(ll&&Ve==="("?")":""),za){for(Dh=-1,Id=Wo.length;++Dh<Id;)if(Nh=Wo.charCodeAt(Dh),48>Nh||Nh>57){Zs=(Nh===46?S+Wo.slice(Dh+1):Wo.slice(Dh))+Zs,Wo=Wo.slice(0,Dh);break}}}Ln&&!lr&&(Wo=o(Wo,1/0));var J0=as.length+Wo.length+Zs.length,Gf=J0<Nr?new Array(Nr-J0+1).join(Tt):"";switch(Ln&&lr&&(Wo=o(Gf+Wo,Gf.length?Nr-Zs.length:1/0),Gf=""),se){case"<":Wo=as+Wo+Zs+Gf;break;case"=":Wo=as+Gf+Wo+Zs;break;case"^":Wo=Gf.slice(0,J0=Gf.length>>1)+as+Wo+Zs+Gf.slice(J0);break;default:Wo=Gf+as+Wo+Zs;break}return O(Wo)}return ps.toString=function(){return ft+""},ps}function st(ft,Tt){var se=Q((ft=pm(ft),ft.type="f",ft)),Ve=Math.max(-8,Math.min(8,Math.floor(Oh(Tt)/3)))*3,yn=Math.pow(10,-Ve),lr=gr[8+Ve/3];return function(Nr){return se(yn*Nr)+lr}}return{format:Q,formatPrefix:st}}var li,Di,Oi;Mi({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Mi(a){return li=bi(a),Di=li.format,Oi=li.formatPrefix,li}function Gi(a,o){return a=Math.abs(a),o=Math.abs(o)-a,Math.max(0,Oh(o)-Oh(a))+1}function hi(a){return Math.max(0,-Oh(Math.abs(a)))}function Pi(a,o,f,v){var S=e0(a,o,f),O;switch(v=pm(v==null?",f":v),v.type){case"s":{var L=Math.max(Math.abs(a),Math.abs(o));return v.precision==null&&!isNaN(O=av(S,L))&&(v.precision=O),Oi(v,L)}case"":case"e":case"g":case"p":case"r":{v.precision==null&&!isNaN(O=Gi(S,Math.max(Math.abs(a),Math.abs(o))))&&(v.precision=O-(v.type==="e"));break}case"f":case"%":{v.precision==null&&!isNaN(O=hi(S))&&(v.precision=O-(v.type==="%")*2);break}}return Di(v)}function ur(a){var o=a.domain;return a.ticks=function(f){var v=o();return iy(v[0],v[v.length-1],f==null?10:f)},a.tickFormat=function(f,v){var S=o();return Pi(S[0],S[S.length-1],f==null?10:f,v)},a.nice=function(f){f==null&&(f=10);var v=o(),S=0,O=v.length-1,L=v[S],k=v[O],V;return k<L&&(V=L,L=k,k=V,V=S,S=O,O=V),V=Gd(L,k,f),V>0?(L=Math.floor(L/V)*V,k=Math.ceil(k/V)*V,V=Gd(L,k,f)):V<0&&(L=Math.ceil(L*V)/V,k=Math.floor(k*V)/V,V=Gd(L,k,f)),V>0?(v[S]=Math.floor(L/V)*V,v[O]=Math.ceil(k/V)*V,o(v)):V<0&&(v[S]=Math.ceil(L*V)/V,v[O]=Math.floor(k*V)/V,o(v)),a},a}function Lr(){var a=ov(xu,xu);return a.copy=function(){return U0(a,Lr())},yu.apply(a,arguments),ur(a)}function gi(a){var o;function f(v){return isNaN(v=+v)?o:v}return f.invert=f,f.domain=f.range=function(v){return arguments.length?(a=map.call(v,number),f):a.slice()},f.unknown=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return gi(a).unknown(o)},a=arguments.length?map.call(a,number):[0,1],linearish(f)}function to(a,o){a=a.slice();var f=0,v=a.length-1,S=a[f],O=a[v],L;return O<S&&(L=f,f=v,v=L,L=S,S=O,O=L),a[f]=o.floor(S),a[v]=o.ceil(O),a}function ri(a){return Math.log(a)}function oo(a){return Math.exp(a)}function yi(a){return-Math.log(-a)}function eo(a){return-Math.exp(-a)}function oi(a){return isFinite(a)?+("1e"+a):a<0?0:a}function Yi(a){return a===10?oi:a===Math.E?Math.exp:function(o){return Math.pow(a,o)}}function ko(a){return a===Math.E?Math.log:a===10&&Math.log10||a===2&&Math.log2||(a=Math.log(a),function(o){return Math.log(o)/a})}function fa(a){return function(o){return-a(-o)}}function $i(a){var o=a(ri,oo),f=o.domain,v=10,S,O;function L(){return S=ko(v),O=Yi(v),f()[0]<0?(S=fa(S),O=fa(O),a(yi,eo)):a(ri,oo),o}return o.base=function(k){return arguments.length?(v=+k,L()):v},o.domain=function(k){return arguments.length?(f(k),L()):f()},o.ticks=function(k){var V=f(),Q=V[0],st=V[V.length-1],ft;(ft=st<Q)&&(Tt=Q,Q=st,st=Tt);var Tt=S(Q),se=S(st),Ve,yn,lr,Nr=k==null?10:+k,Ln=[];if(!(v%1)&&se-Tt<Nr){if(Tt=Math.round(Tt)-1,se=Math.round(se)+1,Q>0){for(;Tt<se;++Tt)for(yn=1,Ve=O(Tt);yn<v;++yn)if(lr=Ve*yn,!(lr<Q)){if(lr>st)break;Ln.push(lr)}}else for(;Tt<se;++Tt)for(yn=v-1,Ve=O(Tt);yn>=1;--yn)if(lr=Ve*yn,!(lr<Q)){if(lr>st)break;Ln.push(lr)}}else Ln=iy(Tt,se,Math.min(se-Tt,Nr)).map(O);return ft?Ln.reverse():Ln},o.tickFormat=function(k,V){if(V==null&&(V=v===10?".0e":","),typeof V!="function"&&(V=Di(V)),k===1/0)return V;k==null&&(k=10);var Q=Math.max(1,v*k/o.ticks().length);return function(st){var ft=st/O(Math.round(S(st)));return ft*v<v-.5&&(ft*=v),ft<=Q?V(st):""}},o.nice=function(){return f(to(f(),{floor:function(k){return O(Math.floor(S(k)))},ceil:function(k){return O(Math.ceil(S(k)))}}))},o}function _i(){var a=$i(z0()).domain([1,10]);return a.copy=function(){return U0(a,_i()).base(a.base())},yu.apply(a,arguments),a}function qr(a){return function(o){return Math.sign(o)*Math.log1p(Math.abs(o/a))}}function Uo(a){return function(o){return Math.sign(o)*Math.expm1(Math.abs(o))*a}}function Ua(a){var o=1,f=a(qr(o),Uo(o));return f.constant=function(v){return arguments.length?a(qr(o=+v),Uo(o)):o},linearish(f)}function lo(){var a=Ua(transformer());return a.copy=function(){return copy(a,lo()).constant(a.constant())},initRange.apply(a,arguments)}function La(a){return function(o){return o<0?-Math.pow(-o,a):Math.pow(o,a)}}function ha(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function Ko(a){return a<0?-a*a:a*a}function hs(a){var o=a(xu,xu),f=1;function v(){return f===1?a(xu,xu):f===.5?a(ha,Ko):a(La(f),La(1/f))}return o.exponent=function(S){return arguments.length?(f=+S,v()):f},ur(o)}function yl(){var a=hs(z0());return a.copy=function(){return U0(a,yl()).exponent(a.exponent())},yu.apply(a,arguments),a}function qc(){return yl.apply(null,arguments).exponent(.5)}function Va(){var a=[],o=[],f=[],v;function S(){var L=0,k=Math.max(1,o.length);for(f=new Array(k-1);++L<k;)f[L-1]=k0(a,L/k);return O}function O(L){return isNaN(L=+L)?v:o[um(f,L)]}return O.invertExtent=function(L){var k=o.indexOf(L);return k<0?[NaN,NaN]:[k>0?f[k-1]:a[0],k<f.length?f[k]:a[a.length-1]]},O.domain=function(L){if(!arguments.length)return a.slice();a=[];for(var k=0,V=L.length,Q;k<V;++k)Q=L[k],Q!=null&&!isNaN(Q=+Q)&&a.push(Q);return a.sort(lm),S()},O.range=function(L){return arguments.length?(o=su.call(L),S()):o.slice()},O.unknown=function(L){return arguments.length?(v=L,O):v},O.quantiles=function(){return f.slice()},O.copy=function(){return Va().domain(a).range(o).unknown(v)},yu.apply(O,arguments)}function hl(){var a=0,o=1,f=1,v=[.5],S=[0,1],O;function L(V){return V<=V?S[um(v,V,0,f)]:O}function k(){var V=-1;for(v=new Array(f);++V<f;)v[V]=((V+1)*o-(V-f)*a)/(f+1);return L}return L.domain=function(V){return arguments.length?(a=+V[0],o=+V[1],k()):[a,o]},L.range=function(V){return arguments.length?(f=(S=su.call(V)).length-1,k()):S.slice()},L.invertExtent=function(V){var Q=S.indexOf(V);return Q<0?[NaN,NaN]:Q<1?[a,v[0]]:Q>=f?[v[f-1],o]:[v[Q-1],v[Q]]},L.unknown=function(V){return arguments.length&&(O=V),L},L.thresholds=function(){return v.slice()},L.copy=function(){return hl().domain([a,o]).range(S).unknown(O)},yu.apply(ur(L),arguments)}function Js(){var a=[.5],o=[0,1],f,v=1;function S(O){return O<=O?o[um(a,O,0,v)]:f}return S.domain=function(O){return arguments.length?(a=su.call(O),v=Math.min(a.length,o.length-1),S):a.slice()},S.range=function(O){return arguments.length?(o=su.call(O),v=Math.min(a.length,o.length-1),S):o.slice()},S.invertExtent=function(O){var L=o.indexOf(O);return[a[L-1],a[L]]},S.unknown=function(O){return arguments.length?(f=O,S):f},S.copy=function(){return Js().domain(a).range(o).unknown(f)},yu.apply(S,arguments)}var Yl=new Date,Ul=new Date;function rs(a,o,f,v){function S(O){return a(O=arguments.length===0?new Date:new Date(+O)),O}return S.floor=function(O){return a(O=new Date(+O)),O},S.ceil=function(O){return a(O=new Date(O-1)),o(O,1),a(O),O},S.round=function(O){var L=S(O),k=S.ceil(O);return O-L<k-O?L:k},S.offset=function(O,L){return o(O=new Date(+O),L==null?1:Math.floor(L)),O},S.range=function(O,L,k){var V=[],Q;if(O=S.ceil(O),k=k==null?1:Math.floor(k),!(O<L)||!(k>0))return V;do V.push(Q=new Date(+O)),o(O,k),a(O);while(Q<O&&O<L);return V},S.filter=function(O){return rs(function(L){if(L>=L)for(;a(L),!O(L);)L.setTime(L-1)},function(L,k){if(L>=L)if(k<0)for(;++k<=0;)for(;o(L,-1),!O(L););else for(;--k>=0;)for(;o(L,1),!O(L););})},f&&(S.count=function(O,L){return Yl.setTime(+O),Ul.setTime(+L),a(Yl),a(Ul),Math.floor(f(Yl,Ul))},S.every=function(O){return O=Math.floor(O),!isFinite(O)||!(O>0)?null:O>1?S.filter(v?function(L){return v(L)%O===0}:function(L){return S.count(0,L)%O===0}):S}),S}var ql=rs(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,o){a.setFullYear(a.getFullYear()+o)},function(a,o){return o.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});ql.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:rs(function(o){o.setFullYear(Math.floor(o.getFullYear()/a)*a),o.setMonth(0,1),o.setHours(0,0,0,0)},function(o,f){o.setFullYear(o.getFullYear()+f*a)})};var tc=ql,mc=ql.range,Oa=rs(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,o){a.setMonth(a.getMonth()+o)},function(a,o){return o.getMonth()-a.getMonth()+(o.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),$c=Oa,Os=Oa.range,Zo=1e3,Ea=6e4,ja=36e5,$l=864e5,ch=6048e5;function We(a){return rs(function(o){o.setDate(o.getDate()-(o.getDay()+7-a)%7),o.setHours(0,0,0,0)},function(o,f){o.setDate(o.getDate()+f*7)},function(o,f){return(f-o-(f.getTimezoneOffset()-o.getTimezoneOffset())*Ea)/ch})}var Pr=We(0),_r=We(1),no=We(2),Da=We(3),ys=We(4),he=We(5),je=We(6),_n=Pr.range,wr=_r.range,yr=no.range,In=Da.range,Fn=ys.range,Yn=he.range,an=je.range,Nn=rs(function(a){a.setHours(0,0,0,0)},function(a,o){a.setDate(a.getDate()+o)},function(a,o){return(o-a-(o.getTimezoneOffset()-a.getTimezoneOffset())*Ea)/$l},function(a){return a.getDate()-1}),Re=Nn,Bn=Nn.range,Dr=rs(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Zo-a.getMinutes()*Ea)},function(a,o){a.setTime(+a+o*ja)},function(a,o){return(o-a)/ja},function(a){return a.getHours()}),Fr=Dr,di=Dr.range,$r=rs(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Zo)},function(a,o){a.setTime(+a+o*Ea)},function(a,o){return(o-a)/Ea},function(a){return a.getMinutes()}),fi=$r,Oo=$r.range,Bi=rs(function(a){a.setTime(a-a.getMilliseconds())},function(a,o){a.setTime(+a+o*Zo)},function(a,o){return(o-a)/Zo},function(a){return a.getUTCSeconds()}),yo=Bi,Yo=Bi.range,ea=rs(function(){},function(a,o){a.setTime(+a+o)},function(a,o){return o-a});ea.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?rs(function(o){o.setTime(Math.floor(o/a)*a)},function(o,f){o.setTime(+o+f*a)},function(o,f){return(f-o)/a}):ea};var Ss=ea,Sc=ea.range;function bu(a){return rs(function(o){o.setUTCDate(o.getUTCDate()-(o.getUTCDay()+7-a)%7),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCDate(o.getUTCDate()+f*7)},function(o,f){return(f-o)/ch})}var mm=bu(0),uf=bu(1),Kv=bu(2),Cd=bu(3),$d=bu(4),O_=bu(5),C_=bu(6),Qv=mm.range,Jv=uf.range,s0=Kv.range,tg=Cd.range,tl=$d.range,R_=O_.range,Tc=C_.range,Za=rs(function(a){a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCDate(a.getUTCDate()+o)},function(a,o){return(o-a)/$l},function(a){return a.getUTCDate()-1}),sy=Za,ax=Za.range,eg=rs(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCFullYear(a.getUTCFullYear()+o)},function(a,o){return o.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});eg.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:rs(function(o){o.setUTCFullYear(Math.floor(o.getUTCFullYear()/a)*a),o.setUTCMonth(0,1),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCFullYear(o.getUTCFullYear()+f*a)})};var Ch=eg,sx=eg.range;function sv(a){if(0<=a.y&&a.y<100){var o=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return o.setFullYear(a.y),o}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function Ip(a){if(0<=a.y&&a.y<100){var o=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return o.setUTCFullYear(a.y),o}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function Wu(a,o,f){return{y:a,m:o,d:f,H:0,M:0,S:0,L:0}}function Sa(a){var o=a.dateTime,f=a.date,v=a.time,S=a.periods,O=a.days,L=a.shortDays,k=a.months,V=a.shortMonths,Q=Qd(S),st=Rh(S),ft=Qd(O),Tt=Rh(O),se=Qd(L),Ve=Rh(L),yn=Qd(k),lr=Rh(k),Nr=Qd(V),Ln=Rh(V),ci={a:ll,A:J0,b:Gf,B:Lv,c:null,d:Xe,e:Xe,f:pr,g:Qo,G:pa,H:en,I:kn,j:Sn,L:sr,m:xr,M:Ir,p:bb,q:Dv,Q:Us,s:rc,S:Wr,u:Ci,U:Ai,V:ao,w:Ro,W:Zi,x:null,X:null,y:Ta,Y:vo,Z:Ca,"%":fu},Fi={a:mO,A:RS,b:vO,B:w1,c:null,d:Ja,e:Ja,f:jl,g:Xs,G:ds,H:Ho,I:Ts,j:_l,L:zl,m:xl,M:nc,p:hp,q:FP,Q:Us,s:rc,S:Vs,u:wc,U:Xu,V:uu,w:Vl,W:zc,x:null,X:null,y:Ka,Y:Fs,Z:Yu,"%":fu},So={a:ps,A:Wo,b:as,B:Zs,c:Dh,d:P,e:P,f:Ot,g:c,G:cy,H:j,I:j,j:N,L:vt,m:w,M:q,p:za,q:g,Q:Yt,s:pe,S:at,u:P_,U:lx,V:Kc,w:M_,W:l0,x:Id,X:Nh,y:c,Y:cy,Z:d,"%":Dt};ci.x=Ji(f,ci),ci.X=Ji(v,ci),ci.c=Ji(o,ci),Fi.x=Ji(f,Fi),Fi.X=Ji(v,Fi),Fi.c=Ji(o,Fi);function Ji(oa,Hs){return function(cl){var ro=[],df=-1,Jl=0,Ld=oa.length,Dd,kg,MS;for(cl instanceof Date||(cl=new Date(+cl));++df<Ld;)oa.charCodeAt(df)===37&&(ro.push(oa.slice(Jl,df)),(kg=ec[Dd=oa.charAt(++df)])!=null?Dd=oa.charAt(++df):kg=Dd==="e"?" ":"0",(MS=Hs[Dd])&&(Dd=MS(cl,kg)),ro.push(Dd),Jl=df+1);return ro.push(oa.slice(Jl,df)),ro.join("")}}function Vr(oa,Hs){return function(cl){var ro=Wu(1900,void 0,1),df=Hi(ro,oa,cl+="",0),Jl,Ld;if(df!=cl.length)return null;if("Q"in ro)return new Date(ro.Q);if("s"in ro)return new Date(ro.s*1e3+("L"in ro?ro.L:0));if(Hs&&!("Z"in ro)&&(ro.Z=0),"p"in ro&&(ro.H=ro.H%12+ro.p*12),ro.m===void 0&&(ro.m="q"in ro?ro.q:0),"V"in ro){if(ro.V<1||ro.V>53)return null;"w"in ro||(ro.w=1),"Z"in ro?(Jl=Ip(Wu(ro.y,0,1)),Ld=Jl.getUTCDay(),Jl=Ld>4||Ld===0?uf.ceil(Jl):uf(Jl),Jl=sy.offset(Jl,(ro.V-1)*7),ro.y=Jl.getUTCFullYear(),ro.m=Jl.getUTCMonth(),ro.d=Jl.getUTCDate()+(ro.w+6)%7):(Jl=sv(Wu(ro.y,0,1)),Ld=Jl.getDay(),Jl=Ld>4||Ld===0?_r.ceil(Jl):_r(Jl),Jl=Re.offset(Jl,(ro.V-1)*7),ro.y=Jl.getFullYear(),ro.m=Jl.getMonth(),ro.d=Jl.getDate()+(ro.w+6)%7)}else("W"in ro||"U"in ro)&&("w"in ro||(ro.w="u"in ro?ro.u%7:"W"in ro?1:0),Ld="Z"in ro?Ip(Wu(ro.y,0,1)).getUTCDay():sv(Wu(ro.y,0,1)).getDay(),ro.m=0,ro.d="W"in ro?(ro.w+6)%7+ro.W*7-(Ld+5)%7:ro.w+ro.U*7-(Ld+6)%7);return"Z"in ro?(ro.H+=ro.Z/100|0,ro.M+=ro.Z%100,Ip(ro)):sv(ro)}}function Hi(oa,Hs,cl,ro){for(var df=0,Jl=Hs.length,Ld=cl.length,Dd,kg;df<Jl;){if(ro>=Ld)return-1;if(Dd=Hs.charCodeAt(df++),Dd===37){if(Dd=Hs.charAt(df++),kg=So[Dd in ec?Hs.charAt(df++):Dd],!kg||(ro=kg(oa,cl,ro))<0)return-1}else if(Dd!=cl.charCodeAt(ro++))return-1}return ro}function za(oa,Hs,cl){var ro=Q.exec(Hs.slice(cl));return ro?(oa.p=st[ro[0].toLowerCase()],cl+ro[0].length):-1}function ps(oa,Hs,cl){var ro=se.exec(Hs.slice(cl));return ro?(oa.w=Ve[ro[0].toLowerCase()],cl+ro[0].length):-1}function Wo(oa,Hs,cl){var ro=ft.exec(Hs.slice(cl));return ro?(oa.w=Tt[ro[0].toLowerCase()],cl+ro[0].length):-1}function as(oa,Hs,cl){var ro=Nr.exec(Hs.slice(cl));return ro?(oa.m=Ln[ro[0].toLowerCase()],cl+ro[0].length):-1}function Zs(oa,Hs,cl){var ro=yn.exec(Hs.slice(cl));return ro?(oa.m=lr[ro[0].toLowerCase()],cl+ro[0].length):-1}function Dh(oa,Hs,cl){return Hi(oa,o,Hs,cl)}function Id(oa,Hs,cl){return Hi(oa,f,Hs,cl)}function Nh(oa,Hs,cl){return Hi(oa,v,Hs,cl)}function ll(oa){return L[oa.getDay()]}function J0(oa){return O[oa.getDay()]}function Gf(oa){return V[oa.getMonth()]}function Lv(oa){return k[oa.getMonth()]}function bb(oa){return S[+(oa.getHours()>=12)]}function Dv(oa){return 1+~~(oa.getMonth()/3)}function mO(oa){return L[oa.getUTCDay()]}function RS(oa){return O[oa.getUTCDay()]}function vO(oa){return V[oa.getUTCMonth()]}function w1(oa){return k[oa.getUTCMonth()]}function hp(oa){return S[+(oa.getUTCHours()>=12)]}function FP(oa){return 1+~~(oa.getUTCMonth()/3)}return{format:function(oa){var Hs=Ji(oa+="",ci);return Hs.toString=function(){return oa},Hs},parse:function(oa){var Hs=Vr(oa+="",!1);return Hs.toString=function(){return oa},Hs},utcFormat:function(oa){var Hs=Ji(oa+="",Fi);return Hs.toString=function(){return oa},Hs},utcParse:function(oa){var Hs=Vr(oa+="",!0);return Hs.toString=function(){return oa},Hs}}}var ec={"-":"",_:" ",0:"0"},Fc=/^\s*\d+/,Lp=/^%/,Kd=/[\\^$*+?|[\]().{}]/g;function Bs(a,o,f){var v=a<0?"-":"",S=(v?-a:a)+"",O=S.length;return v+(O<f?new Array(f-O+1).join(o)+S:S)}function ly(a){return a.replace(Kd,"\\$&")}function Qd(a){return new RegExp("^(?:"+a.map(ly).join("|")+")","i")}function Rh(a){for(var o={},f=-1,v=a.length;++f<v;)o[a[f].toLowerCase()]=f;return o}function M_(a,o,f){var v=Fc.exec(o.slice(f,f+1));return v?(a.w=+v[0],f+v[0].length):-1}function P_(a,o,f){var v=Fc.exec(o.slice(f,f+1));return v?(a.u=+v[0],f+v[0].length):-1}function lx(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.U=+v[0],f+v[0].length):-1}function Kc(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.V=+v[0],f+v[0].length):-1}function l0(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.W=+v[0],f+v[0].length):-1}function cy(a,o,f){var v=Fc.exec(o.slice(f,f+4));return v?(a.y=+v[0],f+v[0].length):-1}function c(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.y=+v[0]+(+v[0]>68?1900:2e3),f+v[0].length):-1}function d(a,o,f){var v=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(o.slice(f,f+6));return v?(a.Z=v[1]?0:-(v[2]+(v[3]||"00")),f+v[0].length):-1}function g(a,o,f){var v=Fc.exec(o.slice(f,f+1));return v?(a.q=v[0]*3-3,f+v[0].length):-1}function w(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.m=v[0]-1,f+v[0].length):-1}function P(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.d=+v[0],f+v[0].length):-1}function N(a,o,f){var v=Fc.exec(o.slice(f,f+3));return v?(a.m=0,a.d=+v[0],f+v[0].length):-1}function j(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.H=+v[0],f+v[0].length):-1}function q(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.M=+v[0],f+v[0].length):-1}function at(a,o,f){var v=Fc.exec(o.slice(f,f+2));return v?(a.S=+v[0],f+v[0].length):-1}function vt(a,o,f){var v=Fc.exec(o.slice(f,f+3));return v?(a.L=+v[0],f+v[0].length):-1}function Ot(a,o,f){var v=Fc.exec(o.slice(f,f+6));return v?(a.L=Math.floor(v[0]/1e3),f+v[0].length):-1}function Dt(a,o,f){var v=Lp.exec(o.slice(f,f+1));return v?f+v[0].length:-1}function Yt(a,o,f){var v=Fc.exec(o.slice(f));return v?(a.Q=+v[0],f+v[0].length):-1}function pe(a,o,f){var v=Fc.exec(o.slice(f));return v?(a.s=+v[0],f+v[0].length):-1}function Xe(a,o){return Bs(a.getDate(),o,2)}function en(a,o){return Bs(a.getHours(),o,2)}function kn(a,o){return Bs(a.getHours()%12||12,o,2)}function Sn(a,o){return Bs(1+Re.count(tc(a),a),o,3)}function sr(a,o){return Bs(a.getMilliseconds(),o,3)}function pr(a,o){return sr(a,o)+"000"}function xr(a,o){return Bs(a.getMonth()+1,o,2)}function Ir(a,o){return Bs(a.getMinutes(),o,2)}function Wr(a,o){return Bs(a.getSeconds(),o,2)}function Ci(a){var o=a.getDay();return o===0?7:o}function Ai(a,o){return Bs(Pr.count(tc(a)-1,a),o,2)}function To(a){var o=a.getDay();return o>=4||o===0?ys(a):ys.ceil(a)}function ao(a,o){return a=To(a),Bs(ys.count(tc(a),a)+(tc(a).getDay()===4),o,2)}function Ro(a){return a.getDay()}function Zi(a,o){return Bs(_r.count(tc(a)-1,a),o,2)}function Ta(a,o){return Bs(a.getFullYear()%100,o,2)}function Qo(a,o){return a=To(a),Bs(a.getFullYear()%100,o,2)}function vo(a,o){return Bs(a.getFullYear()%1e4,o,4)}function pa(a,o){var f=a.getDay();return a=f>=4||f===0?ys(a):ys.ceil(a),Bs(a.getFullYear()%1e4,o,4)}function Ca(a){var o=a.getTimezoneOffset();return(o>0?"-":(o*=-1,"+"))+Bs(o/60|0,"0",2)+Bs(o%60,"0",2)}function Ja(a,o){return Bs(a.getUTCDate(),o,2)}function Ho(a,o){return Bs(a.getUTCHours(),o,2)}function Ts(a,o){return Bs(a.getUTCHours()%12||12,o,2)}function _l(a,o){return Bs(1+sy.count(Ch(a),a),o,3)}function zl(a,o){return Bs(a.getUTCMilliseconds(),o,3)}function jl(a,o){return zl(a,o)+"000"}function xl(a,o){return Bs(a.getUTCMonth()+1,o,2)}function nc(a,o){return Bs(a.getUTCMinutes(),o,2)}function Vs(a,o){return Bs(a.getUTCSeconds(),o,2)}function wc(a){var o=a.getUTCDay();return o===0?7:o}function Xu(a,o){return Bs(mm.count(Ch(a)-1,a),o,2)}function Uc(a){var o=a.getUTCDay();return o>=4||o===0?$d(a):$d.ceil(a)}function uu(a,o){return a=Uc(a),Bs($d.count(Ch(a),a)+(Ch(a).getUTCDay()===4),o,2)}function Vl(a){return a.getUTCDay()}function zc(a,o){return Bs(uf.count(Ch(a)-1,a),o,2)}function Ka(a,o){return Bs(a.getUTCFullYear()%100,o,2)}function Xs(a,o){return a=Uc(a),Bs(a.getUTCFullYear()%100,o,2)}function Fs(a,o){return Bs(a.getUTCFullYear()%1e4,o,4)}function ds(a,o){var f=a.getUTCDay();return a=f>=4||f===0?$d(a):$d.ceil(a),Bs(a.getUTCFullYear()%1e4,o,4)}function Yu(){return"+0000"}function fu(){return"%"}function Us(a){return+a}function rc(a){return Math.floor(+a/1e3)}var Ac,is,qu,zf,Jd;ic({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ic(a){return Ac=Sa(a),is=Ac.format,qu=Ac.parse,zf=Ac.utcFormat,Jd=Ac.utcParse,Ac}var uh=1e3,Tf=uh*60,tp=Tf*60,td=tp*24,c0=td*7,ed=td*30,u0=td*365;function vm(a){return new Date(a)}function f0(a){return a instanceof Date?+a:+new Date(+a)}function gm(a,o,f,v,S,O,L,k,V){var Q=ov(xu,xu),st=Q.invert,ft=Q.domain,Tt=V(".%L"),se=V(":%S"),Ve=V("%I:%M"),yn=V("%I %p"),lr=V("%a %d"),Nr=V("%b %d"),Ln=V("%B"),ci=V("%Y"),Fi=[[L,1,uh],[L,5,5*uh],[L,15,15*uh],[L,30,30*uh],[O,1,Tf],[O,5,5*Tf],[O,15,15*Tf],[O,30,30*Tf],[S,1,tp],[S,3,3*tp],[S,6,6*tp],[S,12,12*tp],[v,1,td],[v,2,2*td],[f,1,c0],[o,1,ed],[o,3,3*ed],[a,1,u0]];function So(Vr){return(L(Vr)<Vr?Tt:O(Vr)<Vr?se:S(Vr)<Vr?Ve:v(Vr)<Vr?yn:o(Vr)<Vr?f(Vr)<Vr?lr:Nr:a(Vr)<Vr?Ln:ci)(Vr)}function Ji(Vr,Hi,za,ps){if(Vr==null&&(Vr=10),typeof Vr=="number"){var Wo=Math.abs(za-Hi)/Vr,as=Sp(function(Zs){return Zs[2]}).right(Fi,Wo);as===Fi.length?(ps=e0(Hi/u0,za/u0,Vr),Vr=a):as?(as=Fi[Wo/Fi[as-1][2]<Fi[as][2]/Wo?as-1:as],ps=as[1],Vr=as[0]):(ps=Math.max(e0(Hi,za,Vr),1),Vr=k)}return ps==null?Vr:Vr.every(ps)}return Q.invert=function(Vr){return new Date(st(Vr))},Q.domain=function(Vr){return arguments.length?ft(Th.call(Vr,f0)):ft().map(vm)},Q.ticks=function(Vr,Hi){var za=ft(),ps=za[0],Wo=za[za.length-1],as=Wo<ps,Zs;return as&&(Zs=ps,ps=Wo,Wo=Zs),Zs=Ji(Vr,ps,Wo,Hi),Zs=Zs?Zs.range(ps,Wo+1):[],as?Zs.reverse():Zs},Q.tickFormat=function(Vr,Hi){return Hi==null?So:V(Hi)},Q.nice=function(Vr,Hi){var za=ft();return(Vr=Ji(Vr,za[0],za[za.length-1],Hi))?ft(to(za,Vr)):Q},Q.copy=function(){return U0(Q,gm(a,o,f,v,S,O,L,k,V))},Q}function ng(){return yu.apply(gm(tc,$c,Pr,Re,Fr,fi,yo,Ss,is).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uy(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function nd(){var a=0,o=1,f,v,S,O,L=xu,k=!1,V;function Q(st){return isNaN(st=+st)?V:L(S===0?.5:(st=(O(st)-f)*S,k?Math.max(0,Math.min(1,st)):st))}return Q.domain=function(st){return arguments.length?(f=O(a=+st[0]),v=O(o=+st[1]),S=f===v?0:1/(v-f),Q):[a,o]},Q.clamp=function(st){return arguments.length?(k=!!st,Q):k},Q.interpolator=function(st){return arguments.length?(L=st,Q):L},Q.unknown=function(st){return arguments.length?(V=st,Q):V},function(st){return O=st,f=st(a),v=st(o),S=f===v?0:1/(v-f),Q}}function Dp(a,o){return o.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function j0(){var a=ur(nd()(xu));return a.copy=function(){return Dp(a,j0())},r0.apply(a,arguments)}function rd(){var a=loggish(nd()).domain([1,10]);return a.copy=function(){return Dp(a,rd()).base(a.base())},initInterpolator.apply(a,arguments)}function Np(){var a=symlogish(nd());return a.copy=function(){return Dp(a,Np()).constant(a.constant())},initInterpolator.apply(a,arguments)}function lv(){var a=powish(nd());return a.copy=function(){return Dp(a,lv()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function rg(){return lv.apply(null,arguments).exponent(.5)}function ym(){var a=[],o=identity;function f(v){if(!isNaN(v=+v))return o((bisect(a,v)-1)/(a.length-1))}return f.domain=function(v){if(!arguments.length)return a.slice();a=[];for(var S=0,O=v.length,L;S<O;++S)L=v[S],L!=null&&!isNaN(L=+L)&&a.push(L);return a.sort(ascending),f},f.interpolator=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return ym(o).domain(a)},initInterpolator.apply(f,arguments)}function kp(){var a=0,o=.5,f=1,v,S,O,L,k,V=xu,Q,st=!1,ft;function Tt(se){return isNaN(se=+se)?ft:(se=.5+((se=+Q(se))-S)*(se<S?L:k),V(st?Math.max(0,Math.min(1,se)):se))}return Tt.domain=function(se){return arguments.length?(v=Q(a=+se[0]),S=Q(o=+se[1]),O=Q(f=+se[2]),L=v===S?0:.5/(S-v),k=S===O?0:.5/(O-S),Tt):[a,o,f]},Tt.clamp=function(se){return arguments.length?(st=!!se,Tt):st},Tt.interpolator=function(se){return arguments.length?(V=se,Tt):V},Tt.unknown=function(se){return arguments.length?(ft=se,Tt):ft},function(se){return Q=se,v=se(a),S=se(o),O=se(f),L=v===S?0:.5/(S-v),k=S===O?0:.5/(O-S),Tt}}function h0(){var a=ur(kp()(xu));return a.copy=function(){return Dp(a,h0())},r0.apply(a,arguments)}function _m(){var a=loggish(kp()).domain([.1,1,10]);return a.copy=function(){return copy(a,_m()).base(a.base())},initInterpolator.apply(a,arguments)}function cv(){var a=symlogish(kp());return a.copy=function(){return copy(a,cv()).constant(a.constant())},initInterpolator.apply(a,arguments)}function xm(){var a=powish(kp());return a.copy=function(){return copy(a,xm()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function uv(){return xm.apply(null,arguments).exponent(.5)}function V0(a){let o,f=[];function v(S){return S==null?o:S}return v.invert=v,v.domain=v.range=S=>S?(f=S,S):f,v.unknown=S=>S?(o=S,S):o,v.copy=()=>V0(a).unknown(o),v}const{isNil:Bp,isString:Fp,uniq:d0}=_t.lodashUtil,ep=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,p0={[X.vY.LINEAR]:Lr,[X.vY.POWER]:yl,[X.vY.LOG]:_i,[X.vY.IDENTITY]:V0,[X.vY.SEQUENTIAL]:j0,[X.vY.TIME]:ng,[X.vY.QUANTILE]:Va,[X.vY.QUANTIZE]:hl,[X.vY.THRESHOLD]:Js,[X.vY.CAT]:Rp,[X.vY.DIVERGING]:h0};class Up{constructor(){(0,Me.Z)(this,"scaleOptions",{})}apply(o,{styleAttributeService:f}){var v=this;o.hooks.init.tapPromise("FeatureScalePlugin",(0,wi.Z)(function*(){var S;o.log(X.Or.ScaleInitStart,X.KD.INIT),v.scaleOptions=o.getScaleOptions();const O=f.getLayerStyleAttributes(),L=(S=o.getSource())===null||S===void 0?void 0:S.data.dataArray;Array.isArray(L)&&L.length===0||(v.caculateScalesForAttributes(O||[],L),o.log(X.Or.ScaleInitEnd,X.KD.INIT))})),o.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var S=(0,wi.Z)(function*(O){if(!O)return O;o.log(X.Or.ScaleInitStart,X.KD.UPDATE),v.scaleOptions=o.getScaleOptions();const L=f.getLayerStyleAttributes(),k=o.getSource().data.dataArray;return Array.isArray(k)&&k.length===0||(v.caculateScalesForAttributes(L||[],k),o.log(X.Or.ScaleInitEnd,X.KD.UPDATE),o.layerModelNeedUpdate=!0),!0});return function(O){return S.apply(this,arguments)}}()),o.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(o.layerModelNeedUpdate)return;this.scaleOptions=o.getScaleOptions();const S=f.getLayerStyleAttributes(),O=o.getSource().data.dataArray;if(!(Array.isArray(O)&&O.length===0)&&S){const L=S.filter(k=>k.needRescale);L.length&&this.caculateScalesForAttributes(L,O)}})}isNumber(o){return!isNaN(parseFloat(o))&&isFinite(o)}caculateScalesForAttributes(o,f){o.forEach(v=>{if(v.scale){const S=v.scale,O=v.scale.field;S.names=this.parseFields(Bp(O)?[]:O);const L=[];S.names.forEach(k=>{var V;L.push(this.createScale(k,v.name,(V=v.scale)===null||V===void 0?void 0:V.values,f))}),L.some(k=>k.type===X.ee.VARIABLE)?(S.type=X.ee.VARIABLE,L.forEach(k=>{if(!S.callback&&S.values!=="text"){var V;switch((V=k.option)===null||V===void 0?void 0:V.type){case X.vY.LOG:case X.vY.LINEAR:case X.vY.POWER:if(S.values&&S.values.length>2){const st=k.scale.ticks(S.values.length);k.scale.domain(st)}S.values?k.scale.range(S.values):k.scale.range(k.option.domain);break;case X.vY.QUANTILE:case X.vY.QUANTIZE:case X.vY.THRESHOLD:k.scale.range(S.values);break;case X.vY.IDENTITY:break;case X.vY.CAT:S.values?k.scale.range(S.values):k.scale.range(k.option.domain);break;case X.vY.DIVERGING:case X.vY.SEQUENTIAL:k.scale.interpolator(gu(S.values));break}}if(S.values==="text"){var Q;k.scale.range((Q=k.option)===null||Q===void 0?void 0:Q.domain)}})):(S.type=X.ee.CONSTANT,S.defaultValues=L.map((k,V)=>k.scale(S.names[V]))),S.scalers=L.map(k=>({field:k.field,func:k.scale,option:k.option})),v.needRescale=!1}})}parseFields(o){return Array.isArray(o)?o:Fp(o)?o.split("*"):[o]}createScale(o,f,v,S){var O,L;const k=this.scaleOptions[f]&&((O=this.scaleOptions[f])===null||O===void 0?void 0:O.field)===o?this.scaleOptions[f]:this.scaleOptions[o],V={field:o,scale:void 0,type:X.ee.VARIABLE,option:k};if(!S||!S.length)return k&&k.type?V.scale=this.createDefaultScale(k):(V.scale=Rp([o]),V.type=X.ee.CONSTANT),V;const Q=(L=S.find(st=>!Bp(st[o])))===null||L===void 0?void 0:L[o];if(this.isNumber(o)||Bp(Q)&&!k)V.scale=Rp([o]),V.type=X.ee.CONSTANT;else{let st=k&&k.type||this.getDefaultType(Q);v==="text"&&(st=X.vY.CAT),v===void 0&&(st=X.vY.IDENTITY);const ft=this.createScaleConfig(st,o,k,S);V.scale=this.createDefaultScale(ft),V.option=ft}return V}getDefaultType(o){let f=X.vY.LINEAR;return typeof o=="string"&&(f=ep.test(o)?X.vY.TIME:X.vY.CAT),f}createScaleConfig(o,f,v,S){const O={type:o};let L=[];if(o===X.vY.QUANTILE){const k=new Map;S==null||S.forEach(V=>{k.set(V._id,V[f])}),L=Array.from(k.values())}else L=(S==null?void 0:S.map(k=>k[f]))||[];if(v!=null&&v.domain)O.domain=v==null?void 0:v.domain;else if(o===X.vY.CAT||o===X.vY.IDENTITY)O.domain=d0(L);else if(o===X.vY.QUANTILE)O.domain=L;else if(o===X.vY.DIVERGING){const k=No(L),V=(v==null?void 0:v.neutral)!==void 0?v==null?void 0:v.neutral:(k[0]+k[1])/2;O.domain=[k[0],V,k[1]]}else O.domain=No(L);return(0,Tn.Z)((0,Tn.Z)({},O),v)}createDefaultScale({type:o,domain:f,unknown:v,clamp:S,nice:O}){const L=p0[o]();return f&&L.domain&&L.domain(f),v&&L.unknown(v),S!==void 0&&L.clamp&&L.clamp(S),O!==void 0&&L.nice&&L.nice(O),L}}class bm{apply(o){o.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{o.animateStatus&&o.models.forEach(v=>{v.addUniforms((0,Tn.Z)({},o.layerModel.getAnimateUniforms()))})})}}class fv{apply(o){o.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:f,enableMask:v}=o.getLayerConfig();!o.tileLayer&&f&&f.length>0&&o.updateLayerConfig({mask:v})})}}class Em{build(o){return(0,wi.Z)(function*(){o.prepareBuildModel(),yield o.buildModels()})()}initLayerModel(o){var f=this;return(0,wi.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}prepareLayerModel(o){var f=this;return(0,wi.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}apply(o){var f=this;o.hooks.init.tapPromise("LayerModelPlugin",(0,wi.Z)(function*(){if(o.getSource().isTile){o.prepareBuildModel();return}o.log(X.Or.BuildModelStart,X.KD.INIT),yield f.initLayerModel(o),o.log(X.Or.BuildModelEnd,X.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var v=(0,wi.Z)(function*(S){return!S||o.getSource().isTile?!1:(o.log(X.Or.BuildModelStart,X.KD.UPDATE),yield f.prepareLayerModel(o),o.log(X.Or.BuildModelEnd,X.KD.UPDATE),!0)});return function(S){return v.apply(this,arguments)}}())}}class hv{apply(o){o.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:f,fitBoundsOptions:v}=o.getLayerConfig();f&&o.fitBounds(v),o.styleNeedUpdate=!1})}}const Z0=["type"],ig={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Sm={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Cl={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},jc={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function id(a){const o={u_DirectionalLights:new Array(3).fill((0,Tn.Z)({},Cl)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,Tn.Z)({},jc)),u_NumOfSpotLights:0};return(!a||!a.length)&&(a=[Sm]),a.forEach(f=>{let{type:v="directional"}=f,S=(0,fl.Z)(f,Z0);const O=ig[v].lights,L=ig[v].num,k=o[L];o[O][k]=(0,Tn.Z)((0,Tn.Z)({},o[O][k]),S),o[L]++}),o}class Eu{apply(o){o.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:f}=o.getLayerConfig();f&&o.models.forEach(v=>v.addUniforms((0,Tn.Z)({},id())))})}}function dv(a){return a.map(o=>(typeof o=="string"&&(o=[o,{}]),o))}function fy(a,o,f,v){const S=a.multiPassRenderer;return S.add(v("render")),dv(o).forEach(O=>{const[L,k]=O;S.add(f(L),k)}),S.add(f("copy")),S}class og{constructor(){(0,Me.Z)(this,"enabled",void 0)}apply(o,{rendererService:f,postProcessingPassFactory:v,normalPassFactory:S}){o.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:O,passes:L=[]}=o.getLayerConfig();this.enabled=!!O&&o.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(o.multiPassRenderer=fy(o,L,v,S),o.multiPassRenderer.setRenderFlag(!0))}),o.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:O,height:L}=f.getViewportSize();o.multiPassRenderer.resize(O,L)}})}}const ff={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function ag(a){switch(a){case"rotation":return{name:"Rotation",type:X.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:ff.ROTATION,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{rotation:f=0}=o;return Array.isArray(f)?[f[0]]:[f]}}};case"stroke":return{name:"stroke",type:X.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:ff.STROKE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:o=>{const{stroke:f=[1,1,1,1]}=o;return f}}};case"opacity":return{name:"opacity",type:X.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:ff.OPACITY,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{opacity:f=1}=o;return[f]}}};case"offsets":return{name:"offsets",type:X.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:ff.OFFSETS,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const{offsets:f}=o;return f}}};default:return}}const{isNumber:pv}=_t.lodashUtil,np={NONE:0,ENCODE:1,HIGHLIGHT:2};class mv{constructor(){(0,Me.Z)(this,"pickingUniformMap",void 0)}pickOption2Array(){const o=[];return this.pickingUniformMap.forEach(f=>{pv(f)?o.push(f):o.push(...f)}),o}updatePickOption(o,f){Object.keys(o).forEach(L=>{this.pickingUniformMap.set(L,o[L])});const v=f.getLayerConfig().pickingBuffer||0,S=Number(f.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",v),this.pickingUniformMap.set("u_shaderPick",S),f.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(o,{styleAttributeService:f}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),o.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();f.registerStyleAttribute({name:"pickingColor",type:X.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:ff.PICKING_COLOR,buffer:{data:[],type:X.gl.FLOAT},size:3,update:S=>{const{id:O}=S;return v?(0,_t.Z6)(O):[0,0,0]}}})}),o.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:np.ENCODE},o),o.models.forEach(S=>S.addUniforms({u_PickingStage:np.ENCODE})))}),o.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:np.HIGHLIGHT},o),o.models.forEach(S=>S.addUniforms({u_PickingStage:np.HIGHLIGHT})))}),o.hooks.beforeHighlight.tap("PixelPickingPlugin",v=>{const{highlightColor:S,activeMix:O=0}=o.getLayerConfig(),L=typeof S=="string"?(0,_t.CI)(S):S||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,_t.W0)(new Uint8Array(v))});const k={u_PickingStage:np.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(V=>V*255),u_activeMix:O};this.updatePickOption(k,o),o.models.forEach(V=>V.addUniforms(k))}),o.hooks.beforeSelect.tap("PixelPickingPlugin",v=>{const{selectColor:S,selectMix:O=0}=o.getLayerConfig(),L=typeof S=="string"?(0,_t.CI)(S):S||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,_t.W0)(new Uint8Array(v))});const k={u_PickingStage:np.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(V=>V*255),u_activeMix:O,u_CurrentSelectedId:v,u_SelectColor:L.map(V=>V*255)};this.updatePickOption(k,o),o.models.forEach(V=>V.addUniforms(k))})}}const Tm=["mvt","geojsonvt","testTile"];function I_(a){const o=a.getSource();return Tm.includes(o.parser.type)}class vv{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{I_(o)||this.registerBuiltinAttributes(f,o)})}registerBuiltinAttributes(o,f){if(f.type==="MaskLayer"){this.registerPositionAttribute(o);return}this.registerPositionAttribute(o),this.registerColorAttribute(o)}registerPositionAttribute(o){o.registerStyleAttribute({name:"position",type:X.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:ff.POSITION,buffer:{data:[],type:X.gl.FLOAT},size:3,update:(f,v,S)=>S.length===2?[S[0],S[1],0]:[S[0],S[1],S[2]]}})}registerColorAttribute(o){o.registerStyleAttribute({name:"color",type:X.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:ff.COLOR,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:f=>{const{color:v}=f;return!v||!v.length?[1,1,1,1]:v}}})}}class L_{constructor(){(0,Me.Z)(this,"cameraService",void 0),(0,Me.Z)(this,"coordinateSystemService",void 0),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"mapService",void 0),(0,Me.Z)(this,"layerService",void 0)}apply(o,{rendererService:f,mapService:v,layerService:S,coordinateSystemService:O,cameraService:L}){this.rendererService=f,this.mapService=v,this.layerService=S,this.coordinateSystemService=O,this.cameraService=L;let k;this.rendererService.uniformBuffers[0]||(k=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=k),o.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const V=o.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(V);const{width:Q,height:st}=this.rendererService.getViewportSize(),{data:ft,uniforms:Tt}=this.generateUBO(Q,st);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:ft}),this.rendererService.queryVerdorInfo()==="WebGL1"&&o.models.forEach(Ve=>{Ve.addUniforms((0,Tn.Z)((0,Tn.Z)({},Tt),{},{u_PickingBuffer:o.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(o.getShaderPickStat())}))})})}generateUBO(o,f){const v=this.cameraService.getProjectionMatrix(),S=this.cameraService.getViewMatrix(),O=this.cameraService.getViewProjectionMatrix(),L=this.cameraService.getModelMatrix(),k=this.coordinateSystemService.getViewportCenterProjection(),V=this.coordinateSystemService.getPixelsPerDegree(),Q=this.cameraService.getZoom(),st=this.coordinateSystemService.getPixelsPerDegree2(),ft=this.cameraService.getZoomScale(),Tt=this.coordinateSystemService.getPixelsPerMeter(),se=this.coordinateSystemService.getCoordinateSystem(),Ve=this.cameraService.getCameraPosition(),yn=window.devicePixelRatio,lr=this.coordinateSystemService.getViewportCenter(),Nr=[o,f],Ln=this.cameraService.getFocalDistance();return{data:[...S,...v,...O,...L,...k,...V,Q,...st,ft,...Tt,se,...Ve,yn,...lr,...Nr,Ln,0,0,0],uniforms:{[X.lv.ProjectionMatrix]:v,[X.lv.ViewMatrix]:S,[X.lv.ViewProjectionMatrix]:O,[X.lv.Zoom]:Q,[X.lv.ZoomScale]:ft,[X.lv.FocalDistance]:Ln,[X.lv.CameraPosition]:Ve,[X.kw.CoordinateSystem]:se,[X.kw.ViewportCenter]:lr,[X.kw.ViewportCenterProjection]:k,[X.kw.PixelsPerDegree]:V,[X.kw.PixelsPerDegree2]:st,[X.kw.PixelsPerMeter]:Tt,u_ViewportSize:Nr,u_ModelMatrix:L,u_DevicePixelRatio:yn}}}}class sg{apply(o){o.hooks.beforeRender.tap("UpdateModelPlugin",()=>{o.layerModel&&o.layerModel.needUpdate().then(f=>{f&&o.renderLayers()})}),o.hooks.afterRender.tap("UpdateModelPlugin",()=>{o.layerModelNeedUpdate=!1})}}class D_{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(o,{styleAttributeService:f})}),o.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{o.layerModelNeedUpdate||o.inited&&this.updateStyleAttribute(o,{styleAttributeService:f})})}updateStyleAttribute(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],S=f.getLayerStyleAttribute("filter");if(S&&S.needRegenerateVertices){o.layerModelNeedUpdate=!0,v.forEach(O=>O.needRegenerateVertices=!1);return}v.filter(O=>O.needRegenerateVertices).forEach(O=>{f.updateAttributeByFeatureRange(O.name,o.getEncodedData(),O.featureRange.startIndex,O.featureRange.endIndex,o),O.needRegenerateVertices=!1})}initStyleAttribute(o,{styleAttributeService:f}){(f.getLayerStyleAttributes()||[]).filter(S=>S.needRegenerateVertices).forEach(S=>{f.updateAttributeByFeatureRange(S.name,o.getEncodedData(),S.featureRange.startIndex,S.featureRange.endIndex),S.needRegenerateVertices=!1})}}function N_(){return[new gs,new vv,new Up,new ya,new hv,new fv,new D_,new sg,new og,new L_,new bm,new Eu,new mv,new Em]}const lg={[X.h0.additive]:{enable:!0,func:{srcRGB:X.gl.ONE,dstRGB:X.gl.ONE,srcAlpha:1,dstAlpha:1}},[X.h0.none]:{enable:!1},[X.h0.normal]:{enable:!0,func:{srcRGB:X.gl.SRC_ALPHA,dstRGB:X.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[X.h0.subtractive]:{enable:!0,func:{srcRGB:X.gl.ONE,dstRGB:X.gl.ONE,srcAlpha:X.gl.ZERO,dstAlpha:X.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:X.gl.FUNC_SUBTRACT,alpha:X.gl.FUNC_SUBTRACT}},[X.h0.max]:{enable:!0,func:{srcRGB:X.gl.ONE,dstRGB:X.gl.ONE},equation:{rgb:X.gl.MAX_EXT}},[X.h0.min]:{enable:!0,func:{srcRGB:X.gl.ONE,dstRGB:X.gl.ONE},equation:{rgb:X.gl.MIN_EXT}}};class wf{constructor(o){(0,Me.Z)(this,"layer",void 0),this.layer=o}pickRender(o){const v=this.layer.getContainer().layerService,S=this.layer;if(S.tileLayer)return S.tileLayer.pickRender(o);S.hooks.beforePickingEncode.call(),v.renderTileLayerMask(S),S.renderModels({ispick:!0}),S.hooks.afterPickingEncode.call()}pick(o,f){var v=this;return(0,wi.Z)(function*(){const O=v.layer.getContainer().pickingService;return o.type==="RasterLayer"?v.pickRasterLayer(o,f):(v.pickRender(f),O.pickFromPickingFBO(o,f))})()}pickRasterLayer(o,f,v){const S=this.layer.getContainer(),O=S.pickingService,L=S.mapService,k=this.layer.getSource().extent,V=(0,_t.if)(f.lngLat,k),Q={x:f.x,y:f.y,type:f.type,lngLat:f.lngLat,target:f,rasterValue:null},st=v||o;if(V){const ft=this.readRasterValue(o,k,L,f.x,f.y);return Q.rasterValue=ft,O.triggerHoverOnLayer(st,Q),!0}else return Q.type=f.type==="mousemove"?"mouseout":"un"+f.type,O.triggerHoverOnLayer(st,(0,Tn.Z)((0,Tn.Z)({},Q),{},{type:"unpick"})),O.triggerHoverOnLayer(st,Q),!1}readRasterValue(o,f,v,S,O){const L=o.getSource().data.dataArray[0],[k=0,V=0,Q=10,st=-10]=f,ft=v.lngLatToContainer([k,V]),Tt=v.lngLatToContainer([Q,st]),se=Tt.x-ft.x,Ve=ft.y-Tt.y,yn=[(S-ft.x)/se,(O-Tt.y)/Ve],lr=L.width||1,Nr=L.height||1,Ln=Math.floor(yn[0]*lr),ci=Math.floor(yn[1]*Nr),Fi=Math.max(0,ci-1)*lr+Ln;return L.data[Fi]}selectFeature(o){const f=this.layer,[v,S,O]=o;f.hooks.beforeSelect.call([v,S,O])}highlightPickedFeature(o){const[f,v,S]=o;this.layer.hooks.beforeHighlight.call([f,v,S])}getFeatureById(o){return this.layer.getSource().getFeatureById(o)}}class H0{constructor(o){(0,Me.Z)(this,"layer",void 0),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"colorTexture",void 0),(0,Me.Z)(this,"key",void 0),this.layer=o;const f=this.layer.getContainer();this.rendererService=f.rendererService}getColorTexture(o,f){const v=this.getTextureKey(o,f);return this.key===v?this.colorTexture:(this.createColorTexture(o,f),this.key=v,this.colorTexture)}createColorTexture(o,f){const{createTexture2D:v}=this.rendererService,S=this.getColorRampBar(o,f),O=v({data:new Uint8Array(S.data),width:S.width,height:S.height,flipY:!1,unorm:!0});return this.colorTexture=O,O}setColorTexture(o,f,v){this.key=this.getTextureKey(f,v),this.colorTexture=o}destroy(){var o;(o=this.colorTexture)===null||o===void 0||o.destroy()}getColorRampBar(o,f){switch(o.type){case"cat":return(0,_t.hj)(o);case"quantize":return(0,_t.NJ)(o);case"custom":return(0,_t.Oc)(o,f);case"linear":return(0,_t.M4)(o,f);default:return(0,_t.Cl)(o)}}getTextureKey(o,f){var v;return`${o.colors.join("_")}_${o==null||(v=o.positions)===null||v===void 0?void 0:v.join("_")}_${o.type}_${f==null?void 0:f.join("_")}`}}const hy=["passes"],rp=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:dy,isFunction:py,isNumber:m0,isObject:Vc,isPlainObject:wm,isUndefined:Am}=_t.lodashUtil;let G0=0;class v0 extends Gc.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var o;return(o=this.container)===null||o===void 0?void 0:o.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(o={}){super(),(0,Me.Z)(this,"id",`${G0++}`),(0,Me.Z)(this,"name",`${G0}`),(0,Me.Z)(this,"parent",void 0),(0,Me.Z)(this,"coordCenter",void 0),(0,Me.Z)(this,"type",void 0),(0,Me.Z)(this,"visible",!0),(0,Me.Z)(this,"zIndex",0),(0,Me.Z)(this,"minZoom",void 0),(0,Me.Z)(this,"maxZoom",void 0),(0,Me.Z)(this,"inited",!1),(0,Me.Z)(this,"layerModelNeedUpdate",!1),(0,Me.Z)(this,"pickedFeatureID",null),(0,Me.Z)(this,"selectedFeatureID",null),(0,Me.Z)(this,"styleNeedUpdate",!1),(0,Me.Z)(this,"rendering",void 0),(0,Me.Z)(this,"forceRender",!1),(0,Me.Z)(this,"clusterZoom",0),(0,Me.Z)(this,"layerType",void 0),(0,Me.Z)(this,"triangulation",void 0),(0,Me.Z)(this,"layerPickService",void 0),(0,Me.Z)(this,"textureService",void 0),(0,Me.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,Me.Z)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,Me.Z)(this,"hooks",{init:new Gl.S$,afterInit:new Gl.oI,beforeRender:new Gl.oI,beforeRenderData:new Gl.bf,afterRender:new Gl.ni,beforePickingEncode:new Gl.ni,afterPickingEncode:new Gl.ni,beforeHighlight:new Gl.ni(["pickedColor"]),afterHighlight:new Gl.ni,beforeSelect:new Gl.ni(["pickedColor"]),afterSelect:new Gl.ni,beforeDestroy:new Gl.ni,afterDestroy:new Gl.ni}),(0,Me.Z)(this,"models",[]),(0,Me.Z)(this,"multiPassRenderer",void 0),(0,Me.Z)(this,"plugins",void 0),(0,Me.Z)(this,"startInit",!1),(0,Me.Z)(this,"sourceOption",void 0),(0,Me.Z)(this,"layerModel",void 0),(0,Me.Z)(this,"shapeOption",void 0),(0,Me.Z)(this,"tileLayer",void 0),(0,Me.Z)(this,"layerChildren",[]),(0,Me.Z)(this,"masks",[]),(0,Me.Z)(this,"configService",X.cO),(0,Me.Z)(this,"styleAttributeService",void 0),(0,Me.Z)(this,"layerSource",void 0),(0,Me.Z)(this,"postProcessingPassFactory",void 0),(0,Me.Z)(this,"animateOptions",{enable:!1}),(0,Me.Z)(this,"container",void 0),(0,Me.Z)(this,"encodedData",void 0),(0,Me.Z)(this,"currentPickId",null),(0,Me.Z)(this,"rawConfig",void 0),(0,Me.Z)(this,"needUpdateConfig",void 0),(0,Me.Z)(this,"encodeStyleAttribute",{}),(0,Me.Z)(this,"enableShaderEncodeStyles",[]),(0,Me.Z)(this,"enableDataEncodeStyles",[]),(0,Me.Z)(this,"pendingStyleAttributes",[]),(0,Me.Z)(this,"scaleOptions",{}),(0,Me.Z)(this,"animateStartTime",void 0),(0,Me.Z)(this,"animateStatus",!1),(0,Me.Z)(this,"isDestroyed",!1),(0,Me.Z)(this,"uniformBuffers",[]),(0,Me.Z)(this,"encodeDataLength",0),(0,Me.Z)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const f=this.getLayerConfig();f&&f.autoFit&&this.fitBounds(f.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=o.name||this.id,this.zIndex=o.zIndex||0,this.rawConfig=o,this.masks=o.maskLayers||[]}addMask(o){this.masks.push(o),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(o){this.masks.push(o)}removeMaskLayer(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),o.destroy()}getAttribute(o){return this.styleAttributeService.getLayerStyleAttribute(o)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(o){if(Object.keys(o).map(f=>{f in this.rawConfig&&(this.rawConfig[f]=o[f])}),!this.startInit)this.needUpdateConfig=(0,Tn.Z)((0,Tn.Z)({},this.needUpdateConfig),o);else{const f=this.container.id;this.configService.setLayerConfig(f,this.id,(0,Tn.Z)((0,Tn.Z)((0,Tn.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),o)),this.needUpdateConfig={}}}setContainer(o){this.container=o}getContainer(){return this.container}addPlugin(o){return this.plugins.push(o),this}init(){var o=this;return(0,wi.Z)(function*(){const f=o.container.id;o.startInit=!0,o.configService.setLayerConfig(f,o.id,o.rawConfig),o.layerType=o.rawConfig.layerType;const{enableMultiPassRenderer:v,passes:S}=o.getLayerConfig();v&&S!==null&&S!==void 0&&S.length&&S.length>0&&o.mapService.on("mapAfterFrameChange",()=>{o.renderLayers()}),o.postProcessingPassFactory=o.container.postProcessingPassFactory,o.styleAttributeService=o.container.styleAttributeService,v&&(o.multiPassRenderer=o.container.multiPassRenderer,o.multiPassRenderer.setLayer(o)),o.pendingStyleAttributes.forEach(({attributeName:O,attributeField:L,attributeValues:k,updateOptions:V})=>{o.styleAttributeService.updateStyleAttribute(O,{scale:(0,Tn.Z)({field:L},o.splitValuesAndCallbackInAttribute(k,L?void 0:o.getLayerConfig()[O]))},V)}),o.pendingStyleAttributes=[],o.plugins=N_();for(const O of o.plugins)O.apply(o,o.container);o.layerPickService=new wf(o),o.textureService=new H0(o),o.log(X.Or.LayerInitStart),yield o.hooks.init.promise(),o.log(X.Or.LayerInitEnd),o.inited=!0,o.emit("inited",{target:o,type:"inited"}),o.emit("add",{target:o,type:"add"}),o.hooks.afterInit.call()})()}log(o,f="init"){var v;if(this.tileLayer||this.isTileLayer)return;const S=`${this.id}.${f}.${o}`,O={id:this.id,type:this.type};(v=this.debugService)===null||v===void 0||v.log(S,O)}updateModelData(o){o.attributes&&o.elements?this.models.map(f=>{f.updateAttributesAndElements(o.attributes,o.elements)}):console.warn("data error")}setLayerPickService(o){this.layerPickService=o}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:o}=this.getLayerConfig();o!=null&&o.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(o,f,v){return this.updateStyleAttribute("color",o,f,v),this}texture(o,f,v){return this.updateStyleAttribute("texture",o,f,v),this}rotate(o,f,v){return this.updateStyleAttribute("rotate",o,f,v),this}size(o,f,v){return this.updateStyleAttribute("size",o,f,v),this}filter(o,f,v){const S=this.updateStyleAttribute("filter",o,f,v);return this.dataState.dataSourceNeedUpdate=S&&this.inited,this}shape(o,f,v){this.shapeOption={field:o,values:f};const S=this.updateStyleAttribute("shape",o,f,v);return this.dataState.dataSourceNeedUpdate=S&&this.inited,this}label(o,f,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:o,attributeValues:f,updateOptions:v}),this}animate(o){let f={};return Vc(o)?(f.enable=!0,f=(0,Tn.Z)((0,Tn.Z)({},f),o)):f.enable=o,this.updateLayerConfig({animateOption:f}),this}source(o,f){return(o==null?void 0:o.type)==="source"?(this.setSource(o),this):(this.sourceOption={data:o,options:f},this.clusterZoom=0,this)}setData(o,f){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(o,f)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(o,f)}),this}dataUpdatelog(){this.log(X.Or.SourceInitStart,X.KD.UPDATE),this.layerSource.once("update",()=>{this.log(X.Or.SourceInitEnd,X.KD.UPDATE)})}style(o){const{passes:f}=o,v=(0,fl.Z)(o,hy);f&&dv(f).forEach(O=>{const L=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(O[0]);L&&L.updateOptions(O[1])}),v.borderColor&&(v.stroke=v.borderColor),v.borderWidth&&(v.strokeWidth=v.borderWidth);const S=v;return Object.keys(v).forEach(O=>{const L=v[O];Array.isArray(L)&&L.length===2&&!m0(L[0])&&!m0(L[1])&&(S[O]={field:L[0],value:L[1]})}),this.encodeStyle(S),this.updateLayerConfig(S),this}encodeStyle(o){Object.keys(o).forEach(f=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(f)&&wm(o[f])&&(o[f].field||o[f].value)&&!dy(this.encodeStyleAttribute[f],o[f])?(this.encodeStyleAttribute[f]=o[f],this.updateStyleAttribute(f,o[f].field,o[f].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[f]&&(delete this.encodeStyleAttribute[f],this.dataState.dataSourceNeedUpdate=!0)})}scale(o,f){const v=(0,Tn.Z)({},this.scaleOptions);if(Vc(o)?this.scaleOptions=(0,Tn.Z)((0,Tn.Z)({},this.scaleOptions),o):this.scaleOptions[o]=f,this.styleAttributeService&&!dy(v,this.scaleOptions)){const S=Vc(o)?o:{[o]:f};this.styleAttributeService.updateScaleAttribute(S)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(o={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(o),this))}renderMultiPass(){var o=this;return(0,wi.Z)(function*(){o.encodeDataLength<=0&&!o.forceRender||(o.multiPassRenderer&&o.multiPassRenderer.getRenderFlag()?yield o.multiPassRenderer.render():o.renderModels())})()}active(o){const f={};return f.enableHighlight=Vc(o)?!0:o,Vc(o)?(f.enableHighlight=!0,o.color&&(f.highlightColor=o.color),o.mix&&(f.activeMix=o.mix)):f.enableHighlight=!!o,this.updateLayerConfig(f),this}setActive(o,f){if(Vc(o)){const{x:v=0,y:S=0}=o;this.updateLayerConfig({highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.pick({x:v,y:S})}else this.updateLayerConfig({pickedFeatureID:o,highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,_t.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(o){const f={};return f.enableSelect=Vc(o)?!0:o,Vc(o)?(f.enableSelect=!0,o.color&&(f.selectColor=o.color),o.mix&&(f.selectMix=o.mix)):f.enableSelect=!!o,this.updateLayerConfig(f),this}setSelect(o,f){if(Vc(o)){const{x:v=0,y:S=0}=o;this.updateLayerConfig({selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.pick({x:v,y:S})}else this.updateLayerConfig({pickedFeatureID:o,selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,_t.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(o){return this.updateLayerConfig({blend:o}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(o){return this.zIndex=o,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(o){this.currentPickId=o}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(o){this.selectedFeatureID=o}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const o=this.mapService.getZoom(),{visible:f,minZoom:v=-1/0,maxZoom:S=1/0}=this.getLayerConfig();return!!f&&o>=v&&o<S}setMultiPass(o,f){if(this.updateLayerConfig({enableMultiPassRenderer:o}),f&&this.updateLayerConfig({passes:f}),o){const{passes:v=[]}=this.getLayerConfig();this.multiPassRenderer=fy(this,v,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:S,height:O}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(S,O)}return this}setMinZoom(o){return this.updateLayerConfig({minZoom:o}),this}getMinZoom(){const{minZoom:o}=this.getLayerConfig();return o}getMaxZoom(){const{maxZoom:o}=this.getLayerConfig();return o}get(o){return this.getLayerConfig()[o]}setMaxZoom(o){return this.updateLayerConfig({maxZoom:o}),this}setAutoFit(o){return this.updateLayerConfig({autoFit:o}),this}fitBounds(o){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const v=this.getSource().extent;return v.some(O=>Math.abs(O)===1/0)?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],o),this)}destroy(o=!0){var f,v,S,O,L;if(this.isDestroyed)return;(f=this.layerModel)===null||f===void 0||f.uniformBuffers.forEach(V=>{V.destroy()}),this.layerChildren.map(V=>V.destroy(!1)),this.layerChildren=[];const{maskfence:k}=this.getLayerConfig();k&&(this.masks.map(V=>V.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(v=this.multiPassRenderer)===null||v===void 0||v.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(S=this.layerModel)===null||S===void 0||S.clearModels(o),(O=this.tileLayer)===null||O===void 0||O.destroy(),this.models=[],(L=this.debugService)===null||L===void 0||L.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var o;this.models.forEach(f=>f.destroy()),(o=this.layerModel)===null||o===void 0||o.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(o=>o.needRescale||o.needRemapping||o.needRegenerateVertices).length}setSource(o){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=o,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const f=this.mapService.getZoom();this.layerSource.updateClusterData(f)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:f})=>{if(this.coordCenter===void 0){const v=this.layerSource.center;this.coordCenter=v}if(f==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(o){this.encodedData=o,this.encodeDataLength=o.length}getEncodedData(){return this.encodedData}getScale(o){return this.styleAttributeService.getLayerAttributeScale(o)}getLegend(o){var f,v,S;const O=this.styleAttributeService.getLayerStyleAttribute(o);return{type:(v=((O==null||(f=O.scale)===null||f===void 0?void 0:f.scalers)||[])[0])===null||v===void 0||(v=v.option)===null||v===void 0?void 0:v.type,field:O==null||(S=O.scale)===null||S===void 0?void 0:S.field,items:this.getLegendItems(o)}}getLegendItems(o){const f=this.styleAttributeService.getLayerAttributeScale(o);return f?f.invertExtent?f.range().map(S=>({value:f.invertExtent(S),[o]:S})):f.ticks?f.ticks().map(S=>({value:S,[o]:f(S)})):f!=null&&f.domain?f.domain().filter(S=>!Am(S)).map(S=>({value:S,[o]:f(S)})):[]:[]}pick({x:o,y:f}){this.interactionService.triggerHover({x:o,y:f})}boxSelect(o,f){this.pickingService.boxPickLayer(this,o,f)}buildLayerModel(o){var f=this;return(0,wi.Z)(function*(){const{moduleName:v,vertexShader:S,fragmentShader:O,defines:L,inject:k,triangulation:V,styleOption:Q,pickingEnabled:st=!0}=o,ft=(0,fl.Z)(o,rp);f.shaderModuleService.registerModule(v,{vs:S,fs:O,defines:L,inject:k});const{vs:Tt,fs:se,uniforms:Ve}=f.shaderModuleService.getModule(v),{createModel:yn}=f.rendererService;return new Promise(lr=>{const{attributes:Nr,elements:Ln,count:ci}=f.styleAttributeService.createAttributesAndIndices(f.encodedData,V,Q,f),Fi=[...f.layerModel.uniformBuffers,...f.rendererService.uniformBuffers];st&&Fi.push(f.getPickingUniformBuffer());const So=(0,Tn.Z)({attributes:Nr,uniforms:Ve,fs:se,vs:Tt,elements:Ln,blend:lg[X.h0.normal],uniformBuffers:Fi,textures:f.layerModel.textures},ft);ci&&(So.count=ci);const Ji=yn(So);lr(Ji)})})()}createAttributes(o){const{triangulation:f}=o,{attributes:v}=this.styleAttributeService.createAttributes(this.encodedData,f);return v}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(o){const{enableHighlight:f=!0,enableSelect:v=!0}=this.getLayerConfig();let S=this.eventNames().indexOf(o)!==-1||this.eventNames().indexOf("un"+o)!==-1;return(o==="click"||o==="dblclick")&&v&&(S=!0),o==="mousemove"&&(f||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(S=!0),this.isVisible()&&S}buildModels(){return(0,wi.Z)(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var o=this;return(0,wi.Z)(function*(){yield o.buildModels()})()}renderMulPass(o){return(0,wi.Z)(function*(){yield o.render()})()}renderModels(o={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(f=>{f.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(o),textures:this.layerModel.textures},(o==null?void 0:o.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(o,f,v,S){const O=this.configService.getAttributeConfig(this.id)||{};return dy(O[o],{field:f,values:v})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(o)!==-1&&this.configService.setAttributeConfig(this.id,{[o]:{field:f,values:v}}),this.startInit?this.styleAttributeService.updateStyleAttribute(o,{scale:(0,Tn.Z)({field:f},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[f]))},S):this.pendingStyleAttributes.push({attributeName:o,attributeField:f,attributeValues:v,updateOptions:S}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(o){console.warn("empty fn")}processData(o){return o}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var o=this;return(0,wi.Z)(function*(){o.models.forEach(v=>v.destroy()),o.models=[],o.uniformBuffers.forEach(v=>{v.destroy()}),o.uniformBuffers=[];const f=o.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});o.uniformBuffers.push(f),o.models=yield o.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(o){return{values:py(o)?void 0:o,callback:py(o)?o:void 0}}}function k_(a,o){return{enable:a,mask:255,func:{cmp:X.gl.EQUAL,ref:o?1:0,mask:1}}}function vy(a){return a.maskOperation===X.lE.OR?{enable:!0,mask:255,func:{cmp:X.gl.ALWAYS,ref:1,mask:255},opFront:{fail:X.gl.KEEP,zfail:X.gl.REPLACE,zpass:X.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:a.stencilType===X.yn.SINGLE||a.stencilIndex===0?X.gl.ALWAYS:X.gl.LESS,ref:a.stencilType===X.yn.SINGLE?1:a.stencilIndex===0?2:1,mask:255},opFront:{fail:X.gl.KEEP,zfail:X.gl.REPLACE,zpass:X.gl.REPLACE}}}const gy={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Om={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var cg=it(9187),Mh=it.n(cg);function yy(a){return Math.max(Math.ceil(a/4)*4,4)}function gv(a,o,f,v=!0){const S=f===3;if(v){a=a.slice();const L=[];for(let k=0;k<a.length;k+=f){L[0]=a[k],L[1]=a[k+1],S&&(L[2]=a[k+2]);const V=(0,_t.vP)(L,!0,{enable:!1,decimal:1});a[k]=V[0],a[k+1]=V[1],S&&(a[k+2]=V[2])}}return Mh()(a,o,f)}const ug="ATTRIBUTE_LOCATION_";class Rl{get attributeLocation(){return(0,Tn.Z)({},ff)}constructor(o){(0,Me.Z)(this,"triangulation",void 0),(0,Me.Z)(this,"uniformBuffers",[]),(0,Me.Z)(this,"textures",[]),(0,Me.Z)(this,"createTexture2D",void 0),(0,Me.Z)(this,"preStyleAttribute",{}),(0,Me.Z)(this,"encodeStyleAttribute",{}),(0,Me.Z)(this,"layer",void 0),(0,Me.Z)(this,"dataTexture",void 0),(0,Me.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,Me.Z)(this,"dataTextureTest",void 0),(0,Me.Z)(this,"configService",void 0),(0,Me.Z)(this,"shaderModuleService",void 0),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"iconService",void 0),(0,Me.Z)(this,"fontService",void 0),(0,Me.Z)(this,"styleAttributeService",void 0),(0,Me.Z)(this,"mapService",void 0),(0,Me.Z)(this,"cameraService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"pickingService",void 0),(0,Me.Z)(this,"attributeUnifoms",void 0),(0,Me.Z)(this,"commonUnifoms",void 0),this.layer=o,this.configService=o.getContainer().globalConfigService,this.rendererService=o.getContainer().rendererService,this.pickingService=o.getContainer().pickingService,this.shaderModuleService=o.getContainer().shaderModuleService,this.styleAttributeService=o.getContainer().styleAttributeService,this.mapService=o.getContainer().mapService,this.iconService=o.getContainer().iconService,this.fontService=o.getContainer().fontService,this.cameraService=o.getContainer().cameraService,this.layerService=o.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:f}=this.rendererService;this.createTexture2D=f}getBlend(){const{blend:o="normal"}=this.layer.getLayerConfig();return lg[X.h0[o]]}getStencil(o){const{mask:f=!1,maskInside:v=!0,enableMask:S,maskOperation:O=X.lE.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return vy({isStencil:!0,stencilType:X.yn.SINGLE});if(o.isStencil)return vy((0,Tn.Z)((0,Tn.Z)({},o),{},{maskOperation:O}));const L=f||S&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return k_(L,v)}getDefaultStyle(){return{}}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const v=(0,Tn.Z)((0,Tn.Z)({},f.uniformsOption),o.uniformsOption);return Object.keys(v).forEach(S=>{typeof v[S]=="boolean"&&(v[S]=v[S]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(v.u_texture=this.textures[0]),v}getAnimateUniforms(){return{}}needUpdate(){return(0,wi.Z)(function*(){return!1})()}buildModels(){return(0,wi.Z)(function*(){throw new Error("Method not implemented.")})()}initModels(){return(0,wi.Z)(function*(){throw new Error("Method not implemented.")})()}clearModels(o=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(o){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(o){return[o.enable?0:1,o.duration||4,o.interval||.2,o.trailLength||.1]}startModelAnimate(){const{animateOption:o}=this.layer.getLayerConfig();o.enable&&this.layer.setAnimateStartTime()}getInject(){return _y(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const o=Object.keys(this.attributeLocation).reduce((f,v)=>{const S=ug+v;return f[S]=this.attributeLocation[v],f},{});return(0,Tn.Z)({},o)}getStyleAttribute(){const o={};return this.layer.enableShaderEncodeStyles.forEach(f=>{if(!this.layer.encodeStyleAttribute[f]){const v=this.layer.getLayerConfig()[f];let S=typeof v=="undefined"?gy[f]:v;f==="stroke"&&(S=(0,_t.CI)(S)),o["u_"+f]=S}}),o}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(o=>{const f=ag(o);f&&this.styleAttributeService.registerStyleAttribute(f)})}registerPosition64LowAttribute(o=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:X.GC.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:X.gl.FLOAT},size:2,update:(f,v,S)=>o?[(0,_t.Ks)(S[0]),(0,_t.Ks)(S[1])]:[0,0]}})}updateEncodeAttribute(o,f){this.encodeStyleAttribute[o]=f}initUniformsBuffer(){const o=this.getUniformsBufferInfo(this.getStyleAttribute()),f=this.getCommonUniformsInfo();o.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(yy(o.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),f.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(yy(f.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(o){let f=0;const v=[];return Object.values(o).forEach(S=>{Array.isArray(S)?(v.push(...S),f+=S.length):typeof S=="number"?(v.push(S),f+=1):typeof S=="boolean"&&(v.push(Number(S)),f+=1)}),{uniformsOption:o,uniformsLength:f,uniformsArray:v}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var o,f;const{uniformsArray:v}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:S}=this.getCommonUniformsInfo();(o=this.attributeUnifoms)===null||o===void 0||o.subData({offset:0,data:new Uint8Array(new Float32Array(v).buffer)}),(f=this.commonUnifoms)===null||f===void 0||f.subData({offset:0,data:new Uint8Array(new Float32Array(S).buffer)})}}function _y(a,o){const f=[];let v="";a.forEach(L=>{const k=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),V=ug+k;o[L]?v+=`#define USE_ATTRIBUTE_${k} 0.0 
`:f.push(`  ${Om[L]} u_${L};`),v+=`
#ifdef USE_ATTRIBUTE_${k}
layout(location = ${V}) in ${Om[L]} a_${L.charAt(0).toUpperCase()+L.slice(1)};
#endif 
`});const S=f.length?`
layout(std140) uniform AttributeUniforms {
  ${f.join(`
`)}
};
`:"";v+=S;let O="";return a.forEach(L=>{const k=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();O+=`
  #ifdef USE_ATTRIBUTE_${k}
    ${Om[L]} ${L} = a_${L.charAt(0).toUpperCase()+L.slice(1)};
  #else
    ${Om[L]} ${L} = u_${L};
  #endif
  `}),{"vs:#decl":v,"fs:#decl":S,"vs:#main-start":O}}const xy=100,cx=36,B_=40;function fg(a){return a/180*Math.acos(-1)}function Cm(a){const o=fg(a[0])+Math.PI/2,f=fg(a[1]),v=xy+Math.random()*.4,S=v*Math.cos(f)*Math.cos(o),O=v*Math.cos(f)*Math.sin(o),L=v*Math.sin(f);return[O,L,S]}function ux(a,o){const f=mat4.create(),v=mat4.create(),S=vec3.fromValues(0,1,0),O=vec3.fromValues(0,0,0);o=o||{},a=typeof a!="undefined"?a:1;const k=2+(typeof o.segments!="undefined"?o.segments:32),V=2*k,Q=[],st=[],ft=[],Tt=[],se=[],Ve=[];for(let yn=0;yn<=k;yn++){const lr=yn/k,Nr=lr*Math.PI;for(let Ln=0;Ln<=V;Ln++){const ci=Ln/V,Fi=ci*Math.PI*2;mat4.identity(v),mat4.rotateZ(v,v,-Nr),mat4.identity(f),mat4.rotateY(f,f,Fi),vec3.transformMat4(O,S,v),vec3.transformMat4(O,O,f),vec3.scale(O,O,-a),ft.push(O.slice()),Tt.push(...O.slice()),vec3.normalize(O,O),se.push(...O.slice()),Ve.push([ci,1-lr]),Tt.push(ci,1-lr)}if(yn>0){const Ln=ft.length;let ci=Ln-2*(V+1);for(;ci+V+2<Ln;ci++)Q.push([ci,ci+1,ci+V+1]),st.push(ci,ci+1,ci+V+1),Q.push([ci+V+1,ci+1,ci+V+2]),st.push(ci+V+1,ci+1,ci+V+2)}}return{cells:Q,positions:ft,uvs:Ve,positionsArr:Tt,indicesArr:st,normalArr:se}}var cs=it(31437);const by=cs.Ue(),hg=cs.Ue(),Ph=cs.Ue(),Rm=cs.Ue(),Mm=cs.Ue();function Ey(a,o,f,v,S){cs.IH(a,f,v),cs.Fv(a,a),o=cs.al(-a[1],a[0]);const O=cs.al(-f[1],f[0]);return[S/cs.AK(o,O),o]}function W0(a,o){return cs.t8(a,-o[1],o[0])}function yv(a,o,f){return cs.lu(a,o,f),cs.Fv(a,a),a}function dg(a,o){return a[0]===o[0]&&a[1]===o[1]}function fx(a){const o=new Map;for(let f=0;f<a.length;f++){const v=a[0].toString()+"-"+a[1].toString();o.get(v)?(a.splice(f,1),f++):o.set(v,v)}return a}class od{constructor(o={}){(0,Me.Z)(this,"complex",void 0),(0,Me.Z)(this,"join",void 0),(0,Me.Z)(this,"cap",void 0),(0,Me.Z)(this,"miterLimit",void 0),(0,Me.Z)(this,"thickness",void 0),(0,Me.Z)(this,"normal",void 0),(0,Me.Z)(this,"lastFlip",-1),(0,Me.Z)(this,"miter",cs.al(0,0)),(0,Me.Z)(this,"started",!1),(0,Me.Z)(this,"dash",!1),(0,Me.Z)(this,"totalDistance",0),(0,Me.Z)(this,"currentIndex",0),this.join=o.join||"miter",this.cap=o.cap||"butt",this.miterLimit=o.miterLimit||10,this.thickness=o.thickness||1,this.dash=o.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let S=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],k=o[O],V=O<o.length-1?o[O+1]:null,Q=this.simpleSegment(f,S,L,k,V);S+=Q}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}extrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let S=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],k=o[O],V=O<o.length-1?o[O+1]:null,Q=this.segment(f,S,L,k,V);S+=Q}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}simpleSegment(o,f,v,S,O){let L=0;const k=o.indices,V=o.positions,Q=o.normals,st=(0,_t.Z)([S[0],S[1]]),ft=(0,_t.Z)([v[0],v[1]]);yv(Ph,st,ft);let Tt=0;if(this.dash&&(Tt=this.lineSegmentDistance(st,ft),this.totalDistance+=Tt),this.normal||(this.normal=cs.Ue(),W0(this.normal,Ph)),this.started||(this.started=!0,this.extrusions(V,Q,v,this.normal,this.thickness,this.totalDistance-Tt)),k.push(f+0,f+1,f+2),!O)W0(this.normal,Ph),this.extrusions(V,Q,S,this.normal,this.thickness,this.totalDistance),k.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2;else{const se=(0,_t.Z)([O[0],O[1]]);dg(st,se)&&cs.IH(se,st,cs.Fv(se,cs.$X(se,st,ft))),yv(Rm,se,st);const[Ve,yn]=Ey(Mm,cs.Ue(),Ph,Rm,this.thickness);let lr=cs.AK(Mm,this.normal)<0?-1:1;this.extrusions(V,Q,S,yn,Ve,this.totalDistance),k.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),lr=-1,cs.JG(this.normal,yn),L+=2,this.lastFlip=lr}return L}segment(o,f,v,S,O){let L=0;const k=o.indices,V=o.positions,Q=o.normals,st=this.cap==="square",ft=this.join==="bevel",Tt=(0,_t.Z)([S[0],S[1]]),se=(0,_t.Z)([v[0],v[1]]);yv(Ph,Tt,se);let Ve=0;if(this.dash&&(Ve=this.lineSegmentDistance(Tt,se),this.totalDistance+=Ve),this.normal||(this.normal=cs.Ue(),W0(this.normal,Ph)),!this.started)if(this.started=!0,st){const yn=cs.Ue(),lr=cs.Ue();cs.IH(yn,this.normal,Ph),cs.IH(lr,this.normal,Ph),Q.push(lr[0],lr[1],0),Q.push(yn[0],yn[1],0),V.push(v[0],v[1],v[2]|0,this.totalDistance-Ve,-this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),V.push(v[0],v[1],v[2]|0,this.totalDistance-Ve,this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,Q,v,this.normal,this.thickness,this.totalDistance-Ve);if(k.push(f+0,f+1,f+2),O){const yn=(0,_t.Z)([O[0],O[1]]);dg(Tt,yn)&&cs.IH(yn,Tt,cs.Fv(yn,cs.$X(yn,Tt,se))),yv(Rm,yn,Tt);const[lr,Nr]=Ey(Mm,cs.Ue(),Ph,Rm,this.thickness);let Ln=cs.AK(Mm,this.normal)<0?-1:1,ci=ft;!ci&&this.join==="miter"&&lr>this.miterLimit&&(ci=!0),ci?(Q.push(this.normal[0],this.normal[1],0),Q.push(Nr[0],Nr[1],0),V.push(S[0],S[1],S[2]|0,this.totalDistance,-this.thickness*Ln,S[2]|0),this.complex.indexes.push(this.currentIndex),V.push(S[0],S[1],S[2]|0,this.totalDistance,this.thickness*Ln,S[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,k.push(...this.lastFlip!==-Ln?[f,f+2,f+3]:[f+2,f+1,f+3]),k.push(f+2,f+3,f+4),W0(by,Rm),cs.JG(this.normal,by),Q.push(this.normal[0],this.normal[1],0),V.push(S[0],S[1],S[2]|0,this.totalDistance,-this.thickness*Ln,S[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,L+=3):(this.extrusions(V,Q,S,Nr,lr,this.totalDistance),k.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),Ln=-1,cs.JG(this.normal,Nr),L+=2),this.lastFlip=Ln}else{if(W0(this.normal,Ph),st){const yn=cs.Ue(),lr=cs.Ue();cs.lu(lr,Ph,this.normal),cs.IH(yn,Ph,this.normal),Q.push(lr[0],lr[1],0),Q.push(yn[0],yn[1],0),V.push(S[0],S[1],S[2]|0,this.totalDistance,this.thickness,S[2]|0),this.complex.indexes.push(this.currentIndex),V.push(S[0],S[1],S[2]|0,this.totalDistance,this.thickness,S[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,Q,S,this.normal,this.thickness,this.totalDistance);k.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2}return L}extrusions(o,f,v,S,O,L){f.push(S[0],S[1],0),f.push(S[0],S[1],0),o.push(v[0],v[1],v[2]|0,L,-O,v[2]|0),this.complex.indexes.push(this.currentIndex),o.push(v[0],v[1],v[2]|0,L,O,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(o,f){const v=f[0]-o[0],S=f[1]-o[1];return Math.sqrt(v*v+S*S)}}let zp=function(a){return a.CYLINDER="cylinder",a.SQUARECOLUMN="squareColumn",a.TRIANGLECOLUMN="triangleColumn",a.HEXAGONCOLUMN="hexagonColumn",a.PENTAGONCOLUMN="pentagonColumn",a}({}),g0=function(a){return a.CIRCLE="circle",a.SQUARE="square",a.TRIANGLE="triangle",a.HEXAGON="hexagon",a.PENTAGON="pentagon",a}({});function ip(a,o=0){const f=Math.PI*2/a,v=[];for(let O=0;O<a;O++)v.push(f*O+o*Math.PI/12);return v.map(O=>{const L=Math.sin(O+Math.PI/4),k=Math.cos(O+Math.PI/4);return[L,k,0]})}function _v(){return ip(30)}function hx(){return ip(4)}function dx(){return ip(3)}function px(){return ip(6,1)}function mx(){return ip(5)}const Sy={[g0.CIRCLE]:_v,[g0.HEXAGON]:px,[g0.TRIANGLE]:dx,[g0.SQUARE]:hx,[g0.PENTAGON]:mx,[zp.CYLINDER]:_v,[zp.HEXAGONCOLUMN]:px,[zp.TRIANGLECOLUMN]:dx,[zp.SQUARECOLUMN]:hx,[zp.PENTAGONCOLUMN]:mx};var Kl=it(77160);function Aw(a){const o=a[0][0],f=a[0][a[0].length-1];o[0]===f[0]&&o[1]===f[1]&&(a[0]=a[0].slice(0,a[0].length-1));const v=a[0].length,S=earcut.flatten(a),{vertices:O,dimensions:L}=S,k=[],V=[];for(let st=0;st<O.length/L;st++)L===2?k.push(O[st*2],O[st*2+1],1):k.push(O[st*3],O[st*3+1],1);const Q=earcut(S.vertices,S.holes,S.dimensions);V.push(...Q);for(let st=0;st<v;st++){const ft=S.vertices.slice(st*L,(st+1)*L);let Tt=S.vertices.slice((st+1)*L,(st+2)*L);Tt.length===0&&(Tt=S.vertices.slice(0,L));const se=k.length/3;k.push(ft[0],ft[1],1,Tt[0],Tt[1],1,ft[0],ft[1],0,Tt[0],Tt[1],0),V.push(...[0,2,1,2,3,1].map(Ve=>Ve+se))}return{positions:k,index:V}}function Ow(a){const o=earcut.flatten(a),f=earcut(o.vertices,o.holes,o.dimensions);return{positions:o.vertices,index:f}}function vx(a,o=!1){const f=a[0][0],v=a[0][a[0].length-1];f[0]===v[0]&&f[1]===v[1]&&(a[0]=a[0].slice(0,a[0].length-1));const S=a[0].length,O=Mh().flatten(a),{vertices:L,dimensions:k,holes:V}=O,Q=[],st=[],ft=[];for(let se=0;se<L.length/k;se++)Q.push(L[se*k],L[se*k+1],1,-1,-1),ft.push(0,0,1);const Tt=gv(L,V,k,o);st.push(...Tt);for(let se=0;se<S;se++){const Ve=O.vertices.slice(se*k,(se+1)*k);let yn=O.vertices.slice((se+1)*k,(se+2)*k);yn.length===0&&(yn=O.vertices.slice(0,k));const lr=Q.length/5;Q.push(Ve[0],Ve[1],1,0,0,yn[0],yn[1],1,.1,0,Ve[0],Ve[1],0,0,.8,yn[0],yn[1],0,.1,.8);const Nr=k2([yn[0],yn[1],1],[Ve[0],Ve[1],0],[Ve[0],Ve[1],1],o);ft.push(...Nr,...Nr,...Nr,...Nr),st.push(...[1,2,0,3,2,1].map(Ln=>Ln+lr))}return{positions:Q,index:st,normals:ft}}function k2(a,o,f,v=!1){const S=Kl.Ue(),O=Kl.Ue(),L=Kl.Ue();v&&(a=(0,_t.vP)(a),o=(0,_t.vP)(o),f=(0,_t.vP)(f));const k=Kl.al(...a),V=Kl.al(...o),Q=Kl.al(...f);Kl.lu(S,Q,V),Kl.lu(O,k,V),Kl.kC(L,S,O);const st=Kl.Ue();return Kl.Fv(st,L),st}const Ty={};function op(a){const o=(0,_t.SI)(a.coordinates);return{vertices:[...o,...o,...o,...o],indices:[0,1,2,2,3,0],size:o.length}}function B2(a){const o=(0,_t.SI)(a.coordinates),f=Cm(o);return{vertices:[...f,...f,...f,...f],indices:[0,1,2,2,3,0],size:f.length}}function F2(a){const{shape:o}=a,{positions:f,index:v,normals:S}=z_(o,!1);return{vertices:f,indices:v,normals:S,size:5}}function FM(a){const o=(0,_t.SI)(a.coordinates);return{vertices:[...o],indices:[0],size:o.length}}function F_(a){const{coordinates:o}=a,f=new od({dash:!0,join:"bevel"});let v=o;v[0]&&!Array.isArray(v[0][0])&&(v=[o]),v.forEach(O=>{f.extrude(O)});const S=f.complex;return{vertices:S.positions,indices:S.indices,normals:S.normals,indexes:S.indexes,size:6}}function Cw(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Rw(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:v,totalDistance:S}=Mw(o);return v.map(O=>{f.push(O[0],O[1],O[2],O[3],0,S)}),{vertices:f,indices:[],normals:[],size:6,count:v.length}}function UM(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],size:4,count:0};const{results:v}=Pw(o);return v.map(S=>{f.push(S[0],S[1],S[2],S[3])}),{vertices:f,indices:[],size:4,count:v.length}}function U2(a,o){const f=o[0]-a[0],v=o[1]-a[1];return Math.sqrt(f*f+v*v)}function pg(a,o){return a.length<3&&a.push(0),o!==void 0&&a.push(o),a}function Mw(a){let o=a;Array.isArray(o)&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&(o=a.flat());let f=0;if(o.length<2)return{results:o,totalDistance:0};{const v=[],S=pg(o[0],f);v.push(S);for(let L=1;L<o.length-1;L++){const k=U2((0,_t.Z)(o[L-1]),(0,_t.Z)(o[L]));f+=k;const V=pg(o[L],f);v.push(V),v.push(V)}const O=U2((0,_t.Z)(o[o.length-2]),(0,_t.Z)(o[o.length-1]));return f+=O,v.push(pg(o[o.length-1],f)),{results:v,totalDistance:f}}}function Pw(a){if(a.length<2)return{results:a};{const o=[],f=pg(a[0]);o.push(f);for(let v=1;v<a.length-1;v++){const S=pg(a[v]);o.push(S),o.push(S)}return o.push(pg(a[a.length-1])),{results:o}}}function wy(a){const{coordinates:o}=a,f=Mh().flatten(o),{vertices:v,dimensions:S,holes:O}=f;return{indices:gv(v,O,S),vertices:v,size:S}}function Iw(a){const{indices:o,vertices:f,size:v}=wy(a);return{indices:o,vertices:Lw(f),size:v+4}}function Lw(a){const o=[],{center:f,radius:v}=(0,_t.Rx)(a);for(let S=0;S<a.length;S+=2){const O=a[S],L=a[S+1];o.push(O,L,0,...f,v)}return o}function z2(a){const o=a.coordinates,{positions:f,index:v,normals:S}=vx(o,!0);return{vertices:f,indices:v,normals:S,size:5}}function zM(a){const{shape:o}=a,{positions:f,index:v}=j_(o);return{vertices:f,indices:v,size:3}}function U_(a){const o=a.coordinates;return{vertices:[...o[0],0,0,0,...o[1],0,1,0,...o[2],0,1,1,...o[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function gx(a,o){const{segmentNumber:f=30}=o,v=a.coordinates,S=[],O=[];for(let L=0;L<f;L++)S.push(L,1,L,v[0][0],v[0][1],v[1][0],v[1][1],L,-1,L,v[0][0],v[0][1],v[1][0],v[1][1]),L!==f-1&&O.push(...[0,1,2,1,3,2].map(k=>L*2+k));return{vertices:S,indices:O,size:7}}function jM(a){const o=a.coordinates;o.length===2&&o.push(0);const f=jp(-1,1),v=jp(1,1),S=jp(-1,-1),O=jp(1,-1);return{vertices:[...o,...f,...o,...S,...o,...O,...o,...v],indices:[0,1,2,3,0,2],size:5}}function z_(a,o=!1){if(Ty&&Ty[a])return Ty[a];const f=Sy[a]?Sy[a]():Sy.cylinder(),v=vx([f],o);return Ty[a]=v,v}function VM(a,o,f=3,v=!1){const S=new Float32Array(a.length/f*3);let O,L,k;const V=vec3.create(),Q=vec3.create(),st=vec3.create();for(let ft=0,Tt=o.length;ft<Tt;ft+=3){O=o[ft+0]*3,L=o[ft+1]*3,k=o[ft+2]*3;let se=[a[O],a[O+1]],Ve=[a[L],a[L+1]],yn=[a[k],a[k+1]];v&&(se=lngLatToMeters(se),Ve=lngLatToMeters(Ve),yn=lngLatToMeters(yn));const[lr,Nr]=se,Ln=vec3.fromValues(lr,Nr,a[O+2]),[ci,Fi]=Ve,So=vec3.fromValues(ci,Fi,a[L+2]),[Ji,Vr]=yn,Hi=vec3.fromValues(Ji,Vr,a[k+2]);vec3.sub(V,Hi,So),vec3.sub(Q,Ln,So),vec3.cross(st,V,Q),S[O]+=V[0],S[O+1]+=V[1],S[O+2]+=V[2],S[L]+=V[0],S[L+1]+=V[1],S[L+2]+=V[2],S[k]+=V[0],S[k+1]+=V[1],S[k+2]+=V[2]}return xv(S),S}function xv(a){for(let o=0,f=a.length;o<f;o+=3){const v=vec3.fromValues(a[o],a[o+1],a[o+2]),S=vec3.create();vec3.normalize(S,v),a.set(S,o)}}function ZM(a){const o=a[0][0],f=a[0][a[0].length-1];return o[0]===f[0]&&o[1]===f[1]}function j_(a){const o=["cylinder","triangleColumn","hexagonColumn","squareColumn"],f=geometryShape[a]?geometryShape[a]():geometryShape.circle();return o.indexOf(a)===-1?fillPolygon([f]):extrudePolygon([f])}function jp(a,o){const f=(a+1)/2,v=(o+1)/2;return[f,v]}function Dw(){const a=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}function HM(){const a=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}const yx=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,Nw=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,j2={solid:0,dash:1};class V2 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.NEAREST,min:X.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:S="solid",dashArray:O=[10,5],forward:L=!0,lineTexture:k=!1,iconStep:V=100,segmentNumber:Q=30}=this.layer.getLayerConfig(),{animateOption:st}=this.layer.getLayerConfig();let ft=O;S!=="dash"&&(ft=[0,0]),ft.length===2&&ft.push(0,0);let Tt=0,se=[0,0,0,0],Ve=[0,0,0,0];if(o&&f&&(se=(0,_t.CI)(o),Ve=(0,_t.CI)(f),Tt=1),this.rendererService.getDirty()){var yn;(yn=this.texture)===null||yn===void 0||yn.bind()}const lr={u_animate:this.animateOption2Array(st),u_dash_array:ft,u_sourceColor:se,u_targetColor:Ve,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:Q,u_lineDir:L?1:-1,u_icon_step:V,u_line_texture:k?1:0,u_textureBlend:v==="normal"?0:1,u_blur:.9,u_line_type:j2[S||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Tt};return this.getUniformsBufferInfo(lr)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:yx,vert:Nw,type:""}}buildModels(){var o=this;return(0,wi.Z)(function*(){o.initUniformsBuffer();const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:S,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc2d"+O,vertexShader:S,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:gx,depth:{enable:!1},styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:X.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:X.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[(0,_t.Ks)(v[3]),(0,_t.Ks)(v[4]),(0,_t.Ks)(v[5]),(0,_t.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:S,y:O}=f[v]||{x:0,y:0};return[S,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:X.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const kw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Bw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,Fw={solid:0,dash:1};class Z2 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.NEAREST,min:X.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:S="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:k=100,segmentNumber:V=30,globalArcHeight:Q=10}=this.layer.getLayerConfig(),{animateOption:st}=this.layer.getLayerConfig();O.length===2&&O.push(0,0);let ft=0,Tt=[0,0,0,0],se=[0,0,0,0];if(o&&f&&(Tt=(0,_t.CI)(o),se=(0,_t.CI)(f),ft=1),this.rendererService.getDirty()){var Ve;(Ve=this.texture)===null||Ve===void 0||Ve.bind()}const yn={u_animate:this.animateOption2Array(st),u_dash_array:O,u_sourceColor:Tt,u_targetColor:se,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:xy,u_global_height:Q,segmentNumber:V,u_line_type:Fw[S]||0,u_icon_step:k,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:ft};return this.getUniformsBufferInfo(yn)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:kw,vert:Bw,type:""}}buildModels(){var o=this;return(0,wi.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:S,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc3d"+O,vertexShader:S,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:gx,styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:X.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:X.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[(0,_t.Ks)(v[3]),(0,_t.Ks)(v[4]),(0,_t.Ks)(v[5]),(0,_t.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:S,y:O}=f[v]||{x:0,y:0};return[S,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:X.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const H2={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},ad=1/2;function Uw(a,o){const{width:f=2,height:v=1}=o;return{vertices:[0,ad*a,1*a*f,-(v+ad)*a,1*a*f,(v-ad)*a,0,ad*a,1*a*f,-(v+ad)*a,1*a*f,(v-ad)*a],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*a,-2*a,1,-2*a,1.5*a,1,1*a,1.5*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function zw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*a*f,1*v,1*a*f,-1*v,0,0,1*a*f,1*v,1*a*f,-1*v],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*a,1,2,1*a,1,-2,1*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function jw(a,o){const{width:f=2,height:v=2}=o;return{vertices:[0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2,0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Vw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v,0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Pm(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v,0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function V_(a,o){const{width:f=2,height:v=2}=o,S=_v(),O=Mh().flatten([S]),L=Mh()(O.vertices,O.holes,O.dimensions),k=S.map(V=>[V[0]*f*a,V[1]*v]).flat();return{vertices:[...k,...k],dimensions:2,indices:L.map(V=>V+S.length),outLineIndices:L,normals:[...S.map(V=>[V[1]*v,V[0]*f*a,1]).flat(),...new Array(S.length*3).fill(0)]}}function G2(a,o=0,f){const v=typeof f.source=="object"?f.source.type:f.source,S=typeof f.target=="object"?f.target.type:f.target,{width:O=v?H2[v]:0}=typeof f.source=="object"?f.source:{},{width:L=S?H2[S]:0}=typeof f.target=="object"?f.target:{};return{vertices:[0,ad,1*O,...a,1,ad,-1*L,...a,1,-ad,-1*L,...a,0,-ad,1*O,...a,0,ad,1*O,...a,1,ad,-1*L,...a,1,-ad,-1*L,...a,0,-ad,1*O,...a],outLineIndices:[0,1,2,0,2,3].map(k=>k+o),indices:[4,5,6,4,6,7].map(k=>k+o),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function _x(a,o){const f=typeof a=="object"?a.type:a,v=o==="source"?1:-1,S=typeof a=="object"?a:{};switch(f){case"circle":return V_(v,S);case"triangle":return zw(v,S);case"diamond":return Vw(v,S);case"rect":return jw(v,S);case"classic":return Pm(v,S);case"halfTriangle":return Uw(v,S);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function W2(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function xx(a,o){return o?Zw(a,o):W2(a)}function Zw(a,o){const f=a.coordinates.flat(),{target:v="classic",source:S="circle"}=o,O=X2(_x(S,"source"),f,0,0),L=G2(f,O.vertices.length/7,o),k=X2(_x(v,"target"),f,1,O.vertices.length/7+L.vertices.length/7);return{vertices:[...O.vertices,...L.vertices,...k.vertices],indices:[...O.outLineIndices,...L.outLineIndices,...k.outLineIndices,...O.indices,...L.indices,...k.indices],normals:[...O.normals,...L.normals,...k.normals],size:7}}function X2(a,o,f=1,v=0){const S=[],{vertices:O,indices:L,dimensions:k,outLineIndices:V}=a;for(let Q=0;Q<O.length;Q+=k)S.push(f,O[Q+1],O[Q],...o);return(0,Tn.Z)((0,Tn.Z)({},a),{},{vertices:S,indices:L.map(Q=>Q+v),outLineIndices:V.map(Q=>Q+v)})}const GM=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,WM=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class XM extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:o=2,strokeWidth:f=1,strokeOpacity:v=1}=this.layer.getLayerConfig(),S={u_gap_width:o,u_stroke_width:f,u_stroke_opacity:v};return this.getUniformsBufferInfo(S)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"flow_line",vertexShader:WM,fragmentShader:GM,defines:o.getDefines(),inject:o.getInject(),triangulation:xx,styleOption:o.layer.getLayerConfig().symbol,primitive:X.gl.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:X.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:X.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[(0,_t.Ks)(v[3]),(0,_t.Ks)(v[4]),(0,_t.Ks)(v[5]),(0,_t.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O)=>O}})}}const YM=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,qM=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,$M={solid:0,dash:1};class KM extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.NEAREST,min:X.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:S="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:k=100,segmentNumber:V=30}=this.layer.getLayerConfig(),{animateOption:Q}=this.layer.getLayerConfig();if(O.length===2&&O.push(0,0),this.rendererService.getDirty()){var st;(st=this.texture)===null||st===void 0||st.bind()}let ft=0,Tt=[0,0,0,0],se=[0,0,0,0];o&&f&&(Tt=(0,_t.CI)(o),se=(0,_t.CI)(f),ft=1);let Ve=this.layer.getLayerAnimateTime();isNaN(Ve)&&(Ve=0);const yn={u_animate:this.animateOption2Array(Q),u_dash_array:O,u_sourceColor:Tt,u_targetColor:se,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:V,u_line_type:$M[S]||0,u_icon_step:k,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:Ve,u_linearColor:ft};return this.getUniformsBufferInfo(yn)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,wi.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig();return[yield o.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:qM,fragmentShader:YM,triangulation:gx,styleOption:{segmentNumber:f},defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:X.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:X.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>[(0,_t.Ks)(v[3]),(0,_t.Ks)(v[4]),(0,_t.Ks)(v[5]),(0,_t.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:S,y:O}=f[v]||{x:0,y:0};return[S,O]}}})}}let QM=function(a){return a[a.solid=0]="solid",a[a.dash=1]="dash",a}({}),Y2=function(a){return a.VERTICAL="vertical",a.HORIZONTAL="horizontal",a}({}),Hw=function(a){return a.NORMAL="normal",a.REPLACE="replace",a}({}),bx=function(a){return a[a.pixel=0]="pixel",a[a.meter=1]="meter",a}({}),JM=function(a){return a.ALWAYS="always",a.DRAGEND="dragend",a}({});const Gw=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,Ww=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class q2 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"textureEventFlag",!1),(0,Me.Z)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.NEAREST,min:X.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:S="solid",dashArray:O=[10,5,0,0],lineTexture:L=!1,iconStep:k=100,vertexHeightScale:V=20,strokeWidth:Q=0,raisingHeight:st=0,heightfixed:ft=!1,linearDir:Tt=Y2.VERTICAL,blur:se=[1,1,1,0]}=this.layer.getLayerConfig();let Ve=O;if(S!=="dash"&&(Ve=[0,0,0,0]),Ve.length===2&&Ve.push(0,0),this.rendererService.getDirty()&&this.texture){var yn;(yn=this.texture)===null||yn===void 0||yn.bind()}const{animateOption:lr}=this.layer.getLayerConfig();let Nr=0,Ln=[0,0,0,0],ci=[0,0,0,0];o&&f&&(Ln=(0,_t.CI)(o),ci=(0,_t.CI)(f),Nr=1);const Fi={u_animate:this.animateOption2Array(lr),u_dash_array:Ve,u_blur:se,u_sourceColor:Ln,u_targetColor:ci,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:k,u_heightfixed:Number(ft),u_vertexScale:V,u_raisingHeight:Number(st),u_strokeWidth:Q,u_textureBlend:v===Hw.NORMAL?0:1,u_line_texture:L?1:0,u_linearDir:Tt===Y2.VERTICAL?1:0,u_linearColor:Nr,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Fi)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.textureEventFlag||(o.textureEventFlag=!0,o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture)),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,wi.Z)(function*(){const{depth:f=!1}=o.layer.getLayerConfig(),{frag:v,vert:S,type:O}=o.getShaders();return o.layer.triangulation=F_,[yield o.layer.buildLayerModel({moduleName:"line"+O,vertexShader:S,fragmentShader:v,triangulation:F_,defines:o.getDefines(),inject:o.getInject(),depth:{enable:f}})]})()}getShaders(){return{frag:Gw,vert:Ww,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:X.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O,L)=>L===void 0?[v[3],10,v[4]]:[v[3],L,v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:X.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v,S,O)=>[...O,v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:S,y:O}=f[v]||{x:0,y:0};return[S,O]}}})}}const Xw=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,Yw=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class qw extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,lineType:v="solid",dashArray:S=[10,5,0,0],vertexHeightScale:O=20}=this.layer.getLayerConfig();let L=S;v!=="dash"&&(L=[0,0,0,0]),L.length===2&&L.push(0,0);let k=0,V=[0,0,0,0],Q=[0,0,0,0];o&&f&&(V=(0,_t.CI)(o),Q=(0,_t.CI)(f),k=1);const st={u_sourceColor:V,u_targetColor:Q,u_dash_array:L,u_vertexScale:O,u_linearColor:k};return this.getUniformsBufferInfo(st)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}getShaders(){return{frag:Xw,vert:Yw,type:"lineSimpleNormal"}}buildModels(){var o=this;return(0,wi.Z)(function*(){o.initUniformsBuffer();const{frag:f,vert:v,type:S}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:S,vertexShader:v,fragmentShader:f,triangulation:Rw,defines:o.getDefines(),inject:o.getInject(),primitive:X.gl.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:X.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:(o,f,v)=>{const{size:S=1}=o,O=Array.isArray(S)?[S[0],S[1]]:[S,0];return[O[0],O[1],v[3],v[5]]}}})}}const $2=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,$w=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class K2 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.NEAREST,min:X.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",heightfixed:S=!1,lineTexture:O=!1,iconStep:L=100,iconStepCount:k=1}=this.layer.getLayerConfig(),{animateOption:V}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var Q;(Q=this.texture)===null||Q===void 0||Q.bind()}let st=0,ft=[0,0,0,0],Tt=[0,0,0,0];o&&f&&(ft=(0,_t.CI)(o),Tt=(0,_t.CI)(f),st=1);const se={u_animate:this.animateOption2Array(V),u_sourceColor:ft,u_targetColor:Tt,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:L,u_heightfixed:Number(S),u_linearColor:st,u_line_texture:O?1:0,u_textureBlend:v==="normal"?0:1,u_iconStepCount:k,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(se)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,wi.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"lineWall",vertexShader:$w,fragmentShader:$2,triangulation:F_,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:X.GC.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v)=>[v[3],v[4],v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:S,y:O}=f[v]||{x:0,y:0};return[S,O]}}})}}var Q2={arc:V2,arc3d:Z2,greatcircle:KM,wall:K2,line:q2,simple:qw,flowline:XM,earthArc3d:Z2};class Ex extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","LineLayer"),(0,Me.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,Me.Z)(this,"arrowInsertCount",0),(0,Me.Z)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel=new Q2[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[o]}getModelType(){var o;if(this.layerType)return this.layerType;const f=this.styleAttributeService.getLayerStyleAttribute("shape");return(f==null||(o=f.scale)===null||o===void 0?void 0:o.field)||"line"}processData(o){if(this.getModelType()!=="simple")return o;const f=[];return o.map(v=>{if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){const S=(0,Tn.Z)({},v);v.coordinates.map(O=>{f.push((0,Tn.Z)((0,Tn.Z)({},S),{},{coordinates:O}))})}else f.push(v)}),f}}const Sx=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Kw=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class y0 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"raiseCount",0),(0,Me.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},sourceColor:f,targetColor:v,pickLight:S=!1,heightfixed:O=!1,opacityLinear:L={enable:!1,dir:"up"},lightEnable:k=!0}=this.layer.getLayerConfig();let V=0,Q=[0,0,0,0],st=[0,0,0,0];if(f&&v&&(Q=(0,_t.CI)(f),st=(0,_t.CI)(v),V=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:se=.01}=o;this.raiseCount+=se,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const ft={u_pickLight:Number(S),u_heightfixed:Number(O),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:V,u_sourceColor:Q,u_targetColor:st,u_opacitylinear:Number(L.enable),u_opacitylinear_dir:L.dir==="up"?1:0,u_lightEnable:Number(k)};return this.getUniformsBufferInfo(ft)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{depth:f=!0,animateOption:{repeat:v=1}}=o.layer.getLayerConfig();return o.raiseRepeat=v,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Kw,fragmentShader:Sx,triangulation:F2,defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:X.gl.FRONT},depth:{enable:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:X.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:4,update:o=>{const f=(0,_t.SI)(o.coordinates);return[f[0],f[1],(0,_t.Ks)(f[0]),(0,_t.Ks)(f[1])]}}})}}const Qw=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Jw=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Tx extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:S=0,raisingHeight:O=0,heightfixed:L=!1,unit:k="pixel"}=this.layer.getLayerConfig();let V=this.getAnimateUniforms().u_time;isNaN(V)&&(V=-1);const Q={u_blur_height_fixed:[S,Number(O),Number(L)],u_stroke_width:f,u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_size_unit:bx[k],u_time:V,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(Q)}getAnimateUniforms(){const{animateOption:o={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{frag:f,vert:v,type:S}=o.getShaders();return o.layer.triangulation=op,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:S,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:op,depth:{enable:!1}})]})()}getShaders(){return{frag:Qw,vert:Jw,type:"pointFill"}}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){const o=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:X.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(f,v,S,O)=>{const L=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],k=O%4*3;return[L[k],L[k+1],L[k+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:f=>{const{size:v=5}=f;return Array.isArray(v)?[v[0]]:[v]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:X.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:f=>{const{shape:v=2}=f;return[o.indexOf(v)]}}})}}const tA=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,ti=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class J2 extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.LINEAR,min:X.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var o;(o=this.texture)===null||o===void 0||o.bind()}const f=this.getCommonUniformsInfo(),v=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},f.uniformsOption),v.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1}=this.layer.getLayerConfig(),v={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(o),u_heightfixed:Number(f),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointImage",vertexShader:ti,fragmentShader:tA,triangulation:FM,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:X.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:S,y:O}=f[v]||{x:-64,y:-64};return[S,O]}}})}}const eP=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,Ax=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function Ox(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class Cx extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const o={u_size_scale:.5};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.layer.triangulation=Ox,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:Ax,fragmentShader:eP,triangulation:Ox,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:X.gl.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var Z_=it(98333),Im=it(85975);class vc{constructor(o,f,v){(0,Me.Z)(this,"boxCells",[]),(0,Me.Z)(this,"xCellCount",void 0),(0,Me.Z)(this,"yCellCount",void 0),(0,Me.Z)(this,"boxKeys",void 0),(0,Me.Z)(this,"bboxes",void 0),(0,Me.Z)(this,"width",void 0),(0,Me.Z)(this,"height",void 0),(0,Me.Z)(this,"xScale",void 0),(0,Me.Z)(this,"yScale",void 0),(0,Me.Z)(this,"boxUid",void 0);const S=this.boxCells;this.xCellCount=Math.ceil(o/v),this.yCellCount=Math.ceil(f/v);for(let O=0;O<this.xCellCount*this.yCellCount;O++)S.push([]);this.boxKeys=[],this.bboxes=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0}insert(o,f,v,S,O){this.forEachCell(f,v,S,O,this.insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(O)}query(o,f,v,S,O){return this.queryHitTest(o,f,v,S,!1,O)}hitTest(o,f,v,S,O){return this.queryHitTest(o,f,v,S,!0,O)}insertBoxCell(o,f,v,S,O,L){this.boxCells[O].push(L)}queryHitTest(o,f,v,S,O,L){if(v<0||o>this.width||S<0||f>this.height)return O?!1:[];const k=[];if(o<=0&&f<=0&&this.width<=v&&this.height<=S){if(O)return!0;for(let Q=0;Q<this.boxKeys.length;Q++)k.push({key:this.boxKeys[Q],x1:this.bboxes[Q*4],y1:this.bboxes[Q*4+1],x2:this.bboxes[Q*4+2],y2:this.bboxes[Q*4+3]});return L?k.filter(L):k}const V={hitTest:O,seenUids:{box:{},circle:{}}};return this.forEachCell(o,f,v,S,this.queryCell,k,V,L),O?k.length>0:k}queryCell(o,f,v,S,O,L,k,V){const Q=k.seenUids,st=this.boxCells[O];if(st!==null){const ft=this.bboxes;for(const Tt of st)if(!Q.box[Tt]){Q.box[Tt]=!0;const se=Tt*4;if(o<=ft[se+2]&&f<=ft[se+3]&&v>=ft[se+0]&&S>=ft[se+1]&&(!V||V(this.boxKeys[Tt]))){if(k.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Tt],x1:ft[se],y1:ft[se+1],x2:ft[se+2],y2:ft[se+3]})}}}return!1}forEachCell(o,f,v,S,O,L,k,V){const Q=this.convertToXCellCoord(o),st=this.convertToYCellCoord(f),ft=this.convertToXCellCoord(v),Tt=this.convertToYCellCoord(S);for(let se=Q;se<=ft;se++)for(let Ve=st;Ve<=Tt;Ve++){const yn=this.xCellCount*Ve+se;if(O.call(this,o,f,v,S,yn,L,k,V))return}}convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}}var H_=vc;class tE{constructor(o,f){(0,Me.Z)(this,"width",void 0),(0,Me.Z)(this,"height",void 0),(0,Me.Z)(this,"grid",void 0),(0,Me.Z)(this,"viewportPadding",100),(0,Me.Z)(this,"screenRightBoundary",void 0),(0,Me.Z)(this,"screenBottomBoundary",void 0),(0,Me.Z)(this,"gridRightBoundary",void 0),(0,Me.Z)(this,"gridBottomBoundary",void 0),this.width=o,this.height=f,this.viewportPadding=Math.max(o,f),this.grid=new H_(o+this.viewportPadding,f+this.viewportPadding,25),this.screenRightBoundary=o+this.viewportPadding,this.screenBottomBoundary=f+this.viewportPadding,this.gridRightBoundary=o+2*this.viewportPadding,this.gridBottomBoundary=f+2*this.viewportPadding}placeCollisionBox(o){const f=o.x1+o.anchorPointX+this.viewportPadding,v=o.y1+o.anchorPointY+this.viewportPadding,S=o.x2+o.anchorPointX+this.viewportPadding,O=o.y2+o.anchorPointY+this.viewportPadding;return!this.isInsideGrid(f,v,S,O)||this.grid.hitTest(f,v,S,O)?{box:[]}:{box:[f,v,S,O]}}insertCollisionBox(o,f){const v={featureIndex:f};this.grid.insert(v,o[0],o[1],o[2],o[3])}project(o,f,v){const S=Z_.al(f,v,0,1),O=Z_.Ue(),L=Im.fromValues(...o);return Z_.fF(O,S,L),{x:(O[0]/O[3]+1)/2*this.width+this.viewportPadding,y:(-O[1]/O[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(o,f,v,S){return v>=0&&o<this.gridRightBoundary&&S>=0&&f<this.gridBottomBoundary}}function eA(a){let o=.5,f=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0;break;default:o=.5}switch(a){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0;break;default:f=.5}return{horizontalAlign:o,verticalAlign:f}}function nA(a,o,f,v,S){if(!S)return;const O=a[v],L=O.glyph;if(L){const k=o[L].advance*O.scale,V=(a[v].x+k)*S;for(let Q=f;Q<=v;Q++)a[Q].x-=V}}function G_(a,o,f,v,S,O,L){const k=(o-f)*S,V=(-v*L+.5)*O;for(const Q of a)Q.x+=k,Q.y+=V}function W_(a,o,f,v,S,O,L){let V=0,Q=-8,st=0;const ft=a.positionedGlyphs,Tt=O==="right"?1:O==="left"?0:.5,se=ft.length;f.forEach(Nr=>{if(Nr.split("").forEach(Ln=>{const ci=o[Ln];ci&&(ft.push({glyph:Ln,x:V,y:Q+0,vertical:!1,scale:1,metrics:ci}),V+=ci.advance+L)}),ft.length!==se){const Ln=V-L;st=Math.max(Ln,st),nA(ft,o,se,ft.length-1,Tt)}V=0,Q-=v+5});const{horizontalAlign:Ve,verticalAlign:yn}=eA(S);G_(ft,Tt,Ve,yn,st,v,f.length);const lr=Q- -8;a.top+=-yn*lr,a.bottom=a.top-lr,a.left+=-Ve*st,a.right=a.left+st}function nP(a,o,f,v,S,O,L){let V=0,Q=-8,st=0;const ft=a.positionedGlyphs,Tt=O==="right"?1:O==="left"?0:.5,se=ft.length;f.forEach(Nr=>{const Ln=o[Nr];if(Ln&&(ft.push({glyph:Nr,x:Ln.advance/2,y:Q+0,vertical:!1,scale:1,metrics:Ln}),V+=Ln.advance+L),ft.length!==se){const Fi=V-L;st=Math.max(Fi,st),nA(ft,o,se,ft.length-1,Tt)}V=0,Q-=v+5});const{horizontalAlign:Ve,verticalAlign:yn}=eA(S);G_(ft,Tt,Ve,yn,st,v,f.length);const lr=Q- -8;a.top+=-yn*lr,a.bottom=a.top-lr,a.left+=-Ve*st,a.right=a.left+st}function rP(a,o,f,v,S,O,L=[0,0],k){const V=a.split(`
`),Q=[],st={positionedGlyphs:Q,top:L[1],bottom:L[1],left:L[0],right:L[0],lineCount:V.length,text:a};return k?nP(st,o,V,f,v,S,O):W_(st,o,V,f,v,S,O),Q.length?st:!1}function eE(a,o=[0,0],f){const{positionedGlyphs:v=[]}=a,S=[];for(const O of v){const L=O.metrics,k=4,V=L.advance*O.scale/2,Q=f?[O.x+V,O.y]:[0,0],st=f?[0,0]:[O.x+V+o[0],O.y+o[1]],ft=(0-k)*O.scale-V+st[0],Tt=(0-k)*O.scale+st[1],se=ft+L.width*O.scale,Ve=Tt+L.height*O.scale,yn={x:ft,y:Tt},lr={x:se,y:Tt},Nr={x:ft,y:Ve},Ln={x:se,y:Ve};S.push({tl:yn,tr:lr,bl:Nr,br:Ln,tex:L,glyphOffset:Q})}return S}const bv=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,Rx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:Ay}=_t.lodashUtil;function Mx(a){const o=this,f=a.id,v=[],S=[];if(!o.glyphInfoMap||!o.glyphInfoMap[f])return{vertices:[],indices:[],size:7};const O=o.glyphInfoMap[f].centroid,L=O.length===2?[O[0],O[1],0]:O;return o.glyphInfoMap[f].glyphQuads.forEach((k,V)=>{v.push(...L,k.tex.x,k.tex.y+k.tex.height,k.tl.x,k.tl.y,...L,k.tex.x+k.tex.width,k.tex.y+k.tex.height,k.tr.x,k.tr.y,...L,k.tex.x+k.tex.width,k.tex.y,k.br.x,k.br.y,...L,k.tex.x,k.tex.y,k.bl.x,k.bl.y),S.push(0+V*4,1+V*4,2+V*4,2+V*4,3+V*4,0+V*4)}),{vertices:v,indices:S,size:7}}class nE extends Rl{constructor(...o){var f;super(...o),f=this,(0,Me.Z)(this,"glyphInfo",void 0),(0,Me.Z)(this,"glyphInfoMap",{}),(0,Me.Z)(this,"rawEncodeData",void 0),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"currentZoom",-1),(0,Me.Z)(this,"extent",void 0),(0,Me.Z)(this,"textureHeight",0),(0,Me.Z)(this,"textCount",0),(0,Me.Z)(this,"preTextStyle",{}),(0,Me.Z)(this,"mapping",(0,wi.Z)(function*(){f.initGlyph(),f.updateTexture(),yield f.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:o="#fff",strokeWidth:f=0,halo:v=.5,gamma:S=2,raisingHeight:O=0}=this.layer.getLayerConfig(),L=this.getFontServiceMapping(),k=this.getFontServiceCanvas();L&&Object.keys(L).length!==this.textCount&&k&&(this.updateTexture(),this.textCount=Object.keys(L).length),this.preTextStyle=this.getTextStyle();const V={u_stroke_color:(0,_t.CI)(o),u_sdf_map_size:[(k==null?void 0:k.width)||1,(k==null?void 0:k.height)||1],u_raisingHeight:Number(O),u_stroke_width:f,u_gamma_scale:S,u_halo_blur:v};return this.getUniformsBufferInfo(V)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.bindEvent(),o.extent=o.textExtent(),o.rawEncodeData=o.layer.getEncodedData(),o.preTextStyle=o.getTextStyle(),o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{textAllowOverlap:f=!1}=o.layer.getLayerConfig();return o.initGlyph(),o.updateTexture(),f||o.filterGlyphs(),[yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:Rx,fragmentShader:bv,defines:o.getDefines(),inject:o.getInject(),triangulation:Mx.bind(o),depth:{enable:!1}})]})()}needUpdate(){var o=this;return(0,wi.Z)(function*(){const{textAllowOverlap:f=!1,textAnchor:v="center",textOffset:S,padding:O,fontFamily:L,fontWeight:k}=o.getTextStyle();if(!Ay(O,o.preTextStyle.padding)||!Ay(S,o.preTextStyle.textOffset)||!Ay(v,o.preTextStyle.textAnchor)||!Ay(L,o.preTextStyle.fontFamily)||!Ay(k,o.preTextStyle.fontWeight))return yield o.mapping(),!0;if(f)return!1;const V=o.mapService.getZoom(),Q=o.mapService.getBounds(),st=(0,_t.oO)(o.extent,Q);return Math.abs(o.currentZoom-V)>.5||!st||f!==o.preTextStyle.textAllowOverlap?(yield o.reBuildModel(),!0):!1})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:X.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:X.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=12}=o;return Array.isArray(f)?[f[0]]:[f]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const o=this.mapService.getBounds();return(0,_t.yA)(o,.5)}initTextFont(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,S=[];v.forEach(O=>{let{shape:L=""}=O;L=L.toString();for(const k of L)S.indexOf(k)===-1&&S.push(k)}),this.fontService.setFontOptions({characterSet:S,fontWeight:o,fontFamily:f,iconfont:!1})}initIconFontTex(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,S=[];v.forEach(O=>{let{shape:L=""}=O;L=`${L}`,S.indexOf(L)===-1&&S.push(L)}),this.fontService.setFontOptions({characterSet:S,fontWeight:o,fontFamily:f,iconfont:!0})}getTextStyle(){const{fontWeight:o="400",fontFamily:f="sans-serif",textAllowOverlap:v=!1,padding:S=[0,0],textAnchor:O="center",textOffset:L=[0,0],opacity:k=1,strokeOpacity:V=1,strokeWidth:Q=0,stroke:st="#000"}=this.layer.getLayerConfig();return{fontWeight:o,fontFamily:f,textAllowOverlap:v,padding:S,textAnchor:O,textOffset:L,opacity:k,strokeOpacity:V,strokeWidth:Q,stroke:st}}generateGlyphLayout(o){const f=this.getFontServiceMapping(),{spacing:v=2,textAnchor:S="center",textOffset:O}=this.layer.getLayerConfig(),L=this.rawEncodeData;this.glyphInfo=L.map(k=>{const{shape:V="",id:Q,size:st=1}=k,ft=k.textOffset?k.textOffset:O||[0,0],Tt=k.textAnchor?k.textAnchor:S||"center",se=rP(V.toString(),f,st,Tt,"left",v,ft,o),Ve=eE(se,ft,!1);return k.shaping=se,k.glyphQuads=Ve,k.centroid=(0,_t.SI)(k.coordinates),this.glyphInfoMap[Q]={shaping:se,glyphQuads:Ve,centroid:(0,_t.SI)(k.coordinates)},k})}getFontServiceMapping(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${f}_${o}`)}getFontServiceCanvas(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${f}_${o}`)}filterGlyphs(){const{padding:o=[0,0],textAllowOverlap:f=!1}=this.layer.getLayerConfig();if(f)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:v,height:S}=this.rendererService.getViewportSize(),O=new tE(v,S);this.glyphInfo.filter(k=>{const{shaping:V,id:Q=0}=k,st=k.centroid,Tt=k.size/16,se=this.mapService.lngLatToContainer(st),{box:Ve}=O.placeCollisionBox({x1:V.left*Tt-o[0],x2:V.right*Tt+o[0],y1:V.top*Tt-o[1],y2:V.bottom*Tt+o[1],anchorPointX:se.x,anchorPointY:se.y});return Ve&&Ve.length?(O.insertCollisionBox(Ve,Q),!0):!1}).forEach(k=>{this.glyphInfoMap[k.id]=k})}initGlyph(){const{iconfont:o=!1}=this.layer.getLayerConfig();o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}updateTexture(){const{createTexture2D:o}=this.rendererService,f=this.getFontServiceCanvas();this.textureHeight=f.height,this.texture&&this.texture.destroy(),this.texture=o({data:f,mag:X.gl.LINEAR,min:X.gl.LINEAR,width:f.width,height:f.height}),this.textures=[this.texture]}reBuildModel(){var o=this;return(0,wi.Z)(function*(){o.filterGlyphs();const f=yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:Rx,fragmentShader:bv,triangulation:Mx.bind(o),defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}});o.layer.models=[f]})()}}function Ev(a){return Oy.apply(this,arguments)}function Oy(){return Oy=(0,wi.Z)(function*(a){if(window.createImageBitmap){const o=yield fetch(a);return yield createImageBitmap(yield o.blob())}else{const o=new window.Image;return new Promise(f=>{o.onload=()=>f(o),o.src=a,o.crossOrigin="Anonymous"})}}),Oy.apply(this,arguments)}const rA=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,Px=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,mg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Ix=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Ql=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,iP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class iA extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:o,heightfixed:f=!1,raisingHeight:v=0,topsurface:S=!0,sidesurface:O=!0,sourceColor:L,targetColor:k}=this.layer.getLayerConfig();let V=0,Q=[1,1,1,1],st=[1,1,1,1];L&&k&&(Q=(0,_t.CI)(L),st=(0,_t.CI)(k),V=1);const ft={u_sourceColor:Q,u_targetColor:st,u_linearColor:V,u_topsurface:Number(S),u_sidesurface:Number(O),u_heightfixed:Number(f),u_raisingHeight:Number(v)};return o&&this.texture&&(ft.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(ft)}initModels(){var o=this;return(0,wi.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{frag:f,vert:v,type:S}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:S,vertexShader:v,fragmentShader:f,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),triangulation:z2})]})()}getShaders(){const{pickLight:o,mapTexture:f}=this.layer.getLayerConfig();return f?{frag:Ql,vert:iP,type:"polygonExtrudeTexture"}:o?{frag:Px,vert:mg,type:"polygonExtrudePickLight"}:{frag:rA,vert:Ix,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.textures=[]}registerBuiltinAttributes(){const o=this.layer.getSource().extent,f=o[2]-o[0],v=o[3]-o[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:X.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(S,O,L)=>{const k=L[0],V=L[1];return[(k-o[0])/f,(V-o[1])/v,L[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(S,O,L,k,V)=>V}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:S=>{const{size:O=10}=S;return Array.isArray(O)?[O[0]]:[O]}}})}loadTexture(){var o=this;return(0,wi.Z)(function*(){const{mapTexture:f}=o.layer.getLayerConfig(),{createTexture2D:v}=o.rendererService;if(o.texture=v({height:1,width:1}),f){const S=yield Ev(f);o.texture=v({data:S,width:S.width,height:S.height,wrapS:X.gl.CLAMP_TO_EDGE,wrapT:X.gl.CLAMP_TO_EDGE,min:X.gl.LINEAR,mag:X.gl.LINEAR})}})()}}const oA=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,ho=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class rE extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const o={};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{frag:f,vert:v,type:S}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:S,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:z2,depth:{enable:!0}})]})()}getShaders(){return{frag:oA,vert:ho,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=10}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:X.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{extrusionBase:f=0}=o;return[f]}}})}}const oP=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,aA=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,Lx=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,iE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class vg extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,opacityLinear:f={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),v={u_raisingHeight:Number(o),u_opacitylinear:Number(f.enable),u_dir:f.dir==="in"?1:0};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{frag:f,vert:v,triangulation:S,type:O}=o.getModelParams();return o.initUniformsBuffer(),o.layer.triangulation=S,[yield o.layer.buildLayerModel({moduleName:O,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:S,primitive:X.gl.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:o={enable:!1,dir:"in"}}=this.layer.getLayerConfig();o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:X.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(f,v,S)=>[S[3],S[4],S[5]]}})}getModelParams(){const{opacityLinear:o={enable:!1}}=this.layer.getLayerConfig();return o.enable?{frag:aA,vert:Lx,type:"polygonLinear",triangulation:Iw}:{frag:oP,vert:iE,type:"polygonFill",triangulation:wy}}}const X0=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,oE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Ra extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture1",void 0),(0,Me.Z)(this,"texture2",void 0),(0,Me.Z)(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{watercolor:o="#6D99A8",watercolor2:f="#0F121C"}=this.layer.getLayerConfig(),v={u_watercolor:(0,_t.CI)(o),u_watercolor2:(0,_t.CI)(f),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(v)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,wi.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:oE,fragmentShader:X0,defines:o.getDefines(),inject:o.getInject(),triangulation:wy,primitive:X.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o,f,v;(o=this.texture1)===null||o===void 0||o.destroy(),(f=this.texture2)===null||f===void 0||f.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,S,O]=o,L=S-f,k=O-v;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:X.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(V,Q,st)=>{const[ft,Tt]=st;return[(ft-f)/L,(Tt-v)/k]}}})}loadTexture(){const{createTexture2D:o}=this.rendererService,f={height:0,width:0};this.texture1=o(f),this.texture2=o(f),this.texture3=o(f),v(O=>{this.texture1=S(O[0]),this.texture2=S(O[1]),this.texture3=S(O[2]),this.layerService.reRender()});function v(O){let L=0;const k=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(Q=>{const st=new Image;st.crossOrigin="",st.src=Q,k.push(st),st.onload=()=>{L++,L===3&&O(k)}})}function S(O){return o({data:O,width:O.width,height:O.height,wrapS:X.gl.MIRRORED_REPEAT,wrapT:X.gl.MIRRORED_REPEAT,min:X.gl.LINEAR,mag:X.gl.LINEAR})}}}const Su=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,bl=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class sA extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{speed:o=.5}=this.layer.getLayerConfig(),f={u_speed:o,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(f)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,wi.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:bl,fragmentShader:Su,triangulation:wy,defines:o.getDefines(),inject:o.getInject(),primitive:X.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,S,O]=o,L=S-f,k=O-v;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:X.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(V,Q,st)=>{const[ft,Tt]=st;return[(ft-f)/L,(Tt-v)/k]}}})}loadTexture(){const{waterTexture:o}=this.layer.getLayerConfig(),{createTexture2D:f}=this.rendererService;this.texture=f({height:1,width:1});const v=new Image;v.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),v.src=o):v.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",v.onload=()=>{this.texture=f({data:v,width:v.width,height:v.height,wrapS:X.gl.MIRRORED_REPEAT,wrapT:X.gl.MIRRORED_REPEAT,min:X.gl.LINEAR,mag:X.gl.LINEAR}),this.layerService.reRender()}}}var lA={fill:vg,line:q2,extrude:iA,text:nE,point_fill:Tx,point_image:J2,point_normal:Cx,point_extrude:y0,water:sA,ocean:Ra,extrusion:rE};class gg extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","PolygonLayer"),(0,Me.Z)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel=new lA[f](o),yield o.initLayerModels()})()}getModelType(){var o;const f=this.styleAttributeService.getLayerStyleAttribute("shape"),v=f==null||(o=f.scale)===null||o===void 0?void 0:o.field;return v==="fill"||!v?"fill":v==="extrude"?"extrude":v==="extrusion"?"extrusion":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":this.getPointModelType()}getPointModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v}=this.getLayerConfig(),S=this.iconService.getIconMap(),O=o.find(L=>L.hasOwnProperty("shape"));if(O){const L=O.shape;return L==="dot"?"point_normal":(f==null?void 0:f.indexOf(L))!==-1?"point_fill":(v==null?void 0:v.indexOf(L))!==-1?"point_extrude":S.hasOwnProperty(L)?"point_image":"text"}else return"fill"}}class cA{constructor({rendererService:o,layerService:f,parent:v}){(0,Me.Z)(this,"tileResource",new Map),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"parent",void 0),(0,Me.Z)(this,"layerTiles",[]),this.rendererService=o,this.layerService=f,this.parent=v}get tiles(){return this.layerTiles}hasTile(o){return this.layerTiles.some(f=>f.key===o)}addTile(o){this.layerTiles.push(o)}getTile(o){return this.layerTiles.find(f=>f.key===o)}getVisibleTileBylngLat(o){return this.layerTiles.find(f=>f.isLoaded&&f.visible&&f.lnglatInBounds(o))}removeTile(o){const f=this.layerTiles.findIndex(S=>S.key===o),v=this.layerTiles.splice(f,1);v[0]&&v[0].destroy()}updateTileVisible(o){const f=this.getTile(o.key);if(o.isVisible)if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(v)}else f==null||f.updateVisible(!0);else if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(!v)}else f==null||f.updateVisible(!1)}isParentLoaded(o){const f=o.parent;if(!f)return!0;const v=this.getTile(f==null?void 0:f.key);return!!(v!=null&&v.isLoaded)}isChildrenLoaded(o){const f=o==null?void 0:o.children;return f.length===0?!0:f.every(v=>{const S=this.getTile(v==null?void 0:v.key);return S?(S==null?void 0:S.isLoaded)===!0:!0})}render(){var o=this;return(0,wi.Z)(function*(){const v=o.getRenderLayers().map(function(){var S=(0,wi.Z)(function*(O){yield o.layerService.renderTileLayer(O)});return function(O){return S.apply(this,arguments)}}());yield Promise.all(v)})()}getRenderLayers(){const o=this.layerTiles.filter(v=>v.visible&&v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getLayers(){const o=this.layerTiles.filter(v=>v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(o=>o.destroy()),this.tileResource.clear()}}var uA=it(32676);function fA(a,o,f){f===void 0&&(f={});var v=Ut(a),S=Ut(o),O=uA.union(v.coordinates,S.coordinates);return O.length===0?null:O.length===1?(0,Je.yu)(O[0],f.properties):(0,Je.tw)(O,f.properties)}var hA=fA;class Dx{getCombineFeature(o){let f=null;const v=o[0];return o.map(S=>{const O=Je.yu(S.coordinates);f===null?f=O:f=hA(f,O)}),v&&(f.properties=(0,Tn.Z)({},v)),f}}const Tv="select",Cy="active";class aE{constructor({layerService:o,tileLayerService:f,parent:v}){(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"tileLayerService",void 0),(0,Me.Z)(this,"tileSourceService",void 0),(0,Me.Z)(this,"parent",void 0),(0,Me.Z)(this,"tilePickID",new Map),this.layerService=o,this.tileLayerService=f,this.parent=v,this.tileSourceService=new Dx}pickRender(o){const f=this.tileLayerService.getVisibleTileBylngLat(o.lngLat);if(f){const v=f.getMainLayer();v==null||v.layerPickService.pickRender(o)}}pick(o,f){var v=this;return(0,wi.Z)(function*(){const O=v.parent.getContainer().pickingService;if(o.type==="RasterLayer"){const L=v.tileLayerService.getVisibleTileBylngLat(f.lngLat);if(L&&L.getMainLayer()!==void 0){const k=L.getMainLayer();return k.layerPickService.pickRasterLayer(k,f,v.parent)}return!1}return v.pickRender(f),O.pickFromPickingFBO(o,f)})()}selectFeature(o){const[f,v,S]=o,O=this.color2PickId(f,v,S);this.tilePickID.set(Tv,O),this.updateHighLight(f,v,S,Tv)}highlightPickedFeature(o){const[f,v,S]=o,O=this.color2PickId(f,v,S);this.tilePickID.set(Cy,O),this.updateHighLight(f,v,S,Cy)}updateHighLight(o,f,v,S){this.tileLayerService.tiles.map(O=>{const L=O.getMainLayer();switch(S){case Tv:L==null||L.hooks.beforeSelect.call([o,f,v]);break;case Cy:L==null||L.hooks.beforeHighlight.call([o,f,v]);break}})}setPickState(){const o=this.tilePickID.get(Tv),f=this.tilePickID.get(Cy);if(o){const[v,S,O]=this.pickId2Color(o);this.updateHighLight(v,S,O,Tv);return}if(f){const[v,S,O]=this.pickId2Color(f);this.updateHighLight(v,S,O,Cy);return}}color2PickId(o,f,v){return(0,_t.W0)(new Uint8Array([o,f,v]))}pickId2Color(o){return(0,_t.Z6)(o)}getFeatureById(o){const f=this.tileLayerService.getTiles().filter(S=>S.visible),v=[];return f.forEach(S=>{v.push(...S.getFeatureById(o))}),v}pickRasterLayer(){return!1}}const dA=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,sE=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Nx(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class lE extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:o,strokeOpacity:f=1,strokeWidth:v=0,stroke:S="#fff"}=this.layer.getLayerConfig(),O={u_stroke_color:(0,_t.CI)(S),u_additive:o==="additive"?1:0,u_stroke_opacity:f,u_stroke_width:v};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.layer.triangulation=Nx,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:sE,fragmentShader:dA,defines:o.getDefines(),inject:o.getInject(),triangulation:Nx,depth:{enable:!1},primitive:X.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const cE=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,uE=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:pA}=_t.lodashUtil;class X_ extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"raiseCount",0),(0,Me.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},opacity:f=1,sourceColor:v,targetColor:S,pickLight:O=!1,heightfixed:L=!0,opacityLinear:k={enable:!1,dir:"up"},lightEnable:V=!0}=this.layer.getLayerConfig();let Q=0,st=[0,0,0,0],ft=[0,0,0,0];if(v&&S&&(st=(0,_t.CI)(v),ft=(0,_t.CI)(S),Q=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:Ve=.01}=o;this.raiseCount+=Ve,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Tt={u_sourceColor:st,u_targetColor:ft,u_linearColor:Q,u_pickLight:Number(O),u_heightfixed:Number(L),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:pA(f)?f:1,u_opacitylinear:Number(k.enable),u_opacitylinear_dir:k.dir==="up"?1:0,u_lightEnable:Number(V)};return this.getUniformsBufferInfo(Tt)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){const{animateOption:{repeat:f=1}}=o.layer.getLayerConfig();return o.raiseRepeat=f,[yield o.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:uE,fragmentShader:cE,triangulation:F2,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:X.gl.FRONT},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:X.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:X.gl.STATIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:X.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:o=>{const f=(0,_t.SI)(o.coordinates);return Cm([f[0],f[1]])}}})}}const Lm=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,mA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class vA extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:S=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const O={u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_stroke_width:f,u_blur:S};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.layer.triangulation=B2,[yield o.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:mA,fragmentShader:Lm,triangulation:B2,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!0},blend:o.getBlend()})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:X.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S)=>{const[O,L,k]=v,V=Kl.al(0,0,1),Q=Kl.al(O,0,k),st=O>=0?Kl.EU(V,Q):Math.PI*2-Kl.EU(V,Q),ft=Math.PI*2-Math.asin(L/100),Tt=Im.create();Im.rotateY(Tt,Tt,st),Im.rotateX(Tt,Tt,ft);const se=Kl.al(1,1,0);Kl.fF(se,se,Tt),Kl.Fv(se,se);const Ve=Kl.al(-1,1,0);Kl.fF(Ve,Ve,Tt),Kl.Fv(Ve,Ve);const yn=Kl.al(-1,-1,0);Kl.fF(yn,yn,Tt),Kl.Fv(yn,yn);const lr=Kl.al(1,-1,0);Kl.fF(lr,lr,Tt),Kl.Fv(lr,lr);const Nr=[...se,...Ve,...yn,...lr],Ln=S%4*3;return[Nr[Ln],Nr[Ln+1],Nr[Ln+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:X.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{shape:f=2}=o;return[this.layer.getLayerConfig().shape2d.indexOf(f)]}}})}}const _0=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,wv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class aP extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"meter2coord",1),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"isMeter",!1),(0,Me.Z)(this,"radian",0),(0,Me.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=f({data:this.iconService.getCanvas(),mag:X.gl.LINEAR,min:X.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1,unit:v="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var S;(S=this.texture)===null||S===void 0||S.bind()}const O={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(f),u_raisingHeight:Number(o),u_size_unit:bx[v]};return this.getUniformsBufferInfo(O)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:wv,fragmentShader:_0,triangulation:op,depth:{enable:!1},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:X.gl.FRONT}})]})()}clearModels(){var o;this.iconService.off("imageUpdate",this.updateTexture),(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:S,y:O}=f[v]||{x:-64,y:-64};return[S,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:X.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=S%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const gA=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,fE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class sP extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:o,speed:f=1,unit:v="pixel"}=this.layer.getLayerConfig(),S={u_additive:o==="additive"?1:0,u_size_unit:bx[v],u_speed:f,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(S)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:fE,fragmentShader:gA,triangulation:op,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:X.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:3,update:(o,f,v,S)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=S%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:X.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var hE={fillImage:aP,fill:Tx,radar:sP,image:J2,normal:Cx,simplePoint:lE,extrude:y0,text:nE,earthFill:vA,earthExtrude:X_};class Y_ extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","PointLayer"),(0,Me.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,Me.Z)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,Me.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel&&o.layerModel.clearModels(),o.layerModel=new hE[f](o),yield o.initLayerModels()})()}rebuildModels(){var o=this;return(0,wi.Z)(function*(){yield o.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:o,values:f}=this.shapeOption,{shape2d:v}=this.getLayerConfig(),S=this.iconService.getIconMap();if(o&&(v==null?void 0:v.indexOf(o))!==-1)return"fill";if(f==="text")return"text";if(f&&f instanceof Array){for(const O of f)if(typeof O=="string"&&S.hasOwnProperty(O))return"image"}}return"normal"}getDefaultConfig(){const o=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[o]}getModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v,billboard:S=!0}=this.getLayerConfig(),O=this.iconService.getIconMap(),L=o.find(k=>k.hasOwnProperty("shape"));if(L){const k=L.shape;return k==="dot"?"normal":k==="simple"?"simplePoint":k==="radar"?"radar":this.layerType==="fillImage"||S===!1?"fillImage":(f==null?void 0:f.indexOf(k))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(v==null?void 0:v.indexOf(k))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":O.hasOwnProperty(k)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function yA(a){return a==="PolygonLayer"?gg:a==="LineLayer"?Ex:Y_}function _A(a){return["PolygonLayer","LineLayer"].indexOf(a)!==-1}class ap extends Gc.EventEmitter{constructor(o,f){super(),(0,Me.Z)(this,"x",void 0),(0,Me.Z)(this,"y",void 0),(0,Me.Z)(this,"z",void 0),(0,Me.Z)(this,"key",void 0),(0,Me.Z)(this,"parent",void 0),(0,Me.Z)(this,"sourceTile",void 0),(0,Me.Z)(this,"visible",!0),(0,Me.Z)(this,"layers",[]),(0,Me.Z)(this,"isLoaded",!1),(0,Me.Z)(this,"tileMaskLayers",[]),(0,Me.Z)(this,"tileMask",void 0),this.parent=f,this.sourceTile=o,this.x=o.x,this.y=o.y,this.z=o.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...o){}lnglatInBounds(o){const[f,v,S,O]=this.sourceTile.bounds,{lng:L,lat:k}=o;return L>=f&&L<=S&&k>=v&&k<=O}getLayerOptions(){var o;const f=this.parent.getLayerConfig();return(0,Tn.Z)((0,Tn.Z)({},f),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:_A(this.parent.type),mask:f.mask||((o=f.maskLayers)===null||o===void 0?void 0:o.length)!==0&&f.enableMask})}getMaskLayer(){const{maskLayers:o}=this.parent.getLayerConfig(),f=[];return o==null||o.forEach(v=>{if(!v.tileLayer)return f.push(v),v;const O=v.tileLayer.getTile(this.sourceTile.key),L=O==null?void 0:O.getLayers()[0];L&&f.push(L)}),f}addTileMask(){var o=this;return(0,wi.Z)(function*(){const f=new gg({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[o.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),v=(0,X.e7)(o.parent.container);f.setContainer(v),yield f.init(),o.tileMask=f;const S=o.getMainLayer();return S!==void 0&&(S.tileMask=f),f})()}addMask(o,f){var v=this;return(0,wi.Z)(function*(){const S=(0,X.e7)(v.parent.container);f.setContainer(S),yield f.init(),o.addMask(f),v.tileMaskLayers.push(f)})()}addLayer(o){var f=this;return(0,wi.Z)(function*(){o.isTileLayer=!0;const v=(0,X.e7)(f.parent.container);o.setContainer(v),f.layers.push(o),yield o.init()})()}updateVisible(o){this.visible=o,this.updateOptions("visible",o)}updateOptions(o,f){this.layers.forEach(v=>{v.updateLayerConfig({[o]:f})})}getMainLayer(){return this.layers[0]}getFeatures(o){return[]}getFeatureById(o){return[]}destroy(){var o;(o=this.tileMask)===null||o===void 0||o.destroy(),this.layers.forEach(f=>f.destroy())}}class kx extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.getSourceOption(),v=f.data.features[0].properties,S=new Ex().source(f.data,f.options).size(1).shape("line").color("red"),O=new Y_({minZoom:o.z-1,maxZoom:o.z+1,textAllowOverlap:!0}).source([v],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(o.key).style({stroke:"#fff",strokeWidth:2});yield o.addLayer(S),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:o.transforms}}}}const dE=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,sp=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class El extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,brightness:f,contrast:v,saturation:S,gamma:O}=this.layer.getLayerConfig(),L={u_opacity:(0,_t.LS)(o,1),u_brightness:(0,_t.LS)(f,1),u_contrast:(0,_t.LS)(v,1),u_saturation:(0,_t.LS)(S,1),u_gamma:(0,_t.LS)(O,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}initModels(){var o=this;return(0,wi.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}loadTexture(){var o=this;return(0,wi.Z)(function*(){const{createTexture2D:f}=o.rendererService,S=yield o.layer.getSource().data.images;o.texture=f({data:S[0],width:S[0].width,height:S[0].height,mag:X.gl.LINEAR,min:X.gl.LINEAR})})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:sp,fragmentShader:dE,defines:o.getDefines(),triangulation:U_,primitive:X.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var cP={image:El};class xA extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","ImageLayer")}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel=new cP[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{image:{}}[o]}getModelType(){return"image"}}class pE extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=o.getSourceOption(),O=new xA((0,Tn.Z)({},v)).source(S.data,S.options);f&&Object.keys(f).forEach(L=>{var k,V;const Q=L;O[Q]((k=f[Q])===null||k===void 0?void 0:k.field,(V=f[Q])===null||V===void 0?void 0:V.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const Ry=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,mE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Bx extends Rl{getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,color:f="#000"}=this.layer.getLayerConfig(),v={u_color:(0,_t.CI)(f),u_opacity:o||1};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"mask",vertexShader:mE,fragmentShader:Ry,defines:o.getDefines(),triangulation:wy,depth:{enable:!1},pick:!1})]})()}clearModels(o=!0){o&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var q_={fill:Bx};class vE extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","MaskLayer")}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel=new q_[f](o),yield o.initLayerModels()})()}getModelType(){return"fill"}}class gE extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=o.getSourceOption(),O=new vE((0,Tn.Z)({},v)).source(S.data,S.options);f&&Object.keys(f).forEach(L=>{var k,V;const Q=L;O[Q]((k=f[Q])===null||k===void 0?void 0:k.field,(V=f[Q])===null||V===void 0?void 0:V.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getFeatures(o){return o?this.sourceTile.data.getTileData(o):[]}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f,featureId:v}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}}function gc(a,o){return{type:a.type,field:"value",items:a.positions.map((f,v)=>({[o]:v>=a.colors.length?null:a.colors[v],value:f}))}}const Ml=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,My=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Ux extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,clampLow:f=!0,clampHigh:v=!0,noDataValue:S=-9999999,domain:O,rampColors:L}=this.layer.getLayerConfig(),k=O||(0,_t.ZB)(L);this.colorTexture=this.layer.textureService.getColorTexture(L,k);const V={u_domain:k,u_opacity:o||1,u_noDataValue:S,u_clampLow:f?1:0,u_clampHigh:(typeof v!="undefined"?v:f)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(V)}getRasterData(o){return(0,wi.Z)(function*(){if(Array.isArray(o.data))return{data:o.data,width:o.width,height:o.height};{const{rasterData:f,width:v,height:S}=yield o.data;return{data:Array.from(f),width:v,height:S}}})()}initModels(){var o=this;return(0,wi.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,wi.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v,queryVerdorInfo:S}=o.rendererService,O=f.data.dataArray[0],{data:L,width:k,height:V}=yield o.getRasterData(O);return o.texture=v({data:new Float32Array(L),width:k,height:V,format:S()==="WebGL1"?X.gl.LUMINANCE:X.gl.RED,type:X.gl.FLOAT,alignment:1}),[yield o.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:My,fragmentShader:Ml,defines:o.getDefines(),triangulation:U_,primitive:X.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var o,f;(o=this.texture)===null||o===void 0||o.destroy(),(f=this.colorTexture)===null||f===void 0||f.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const Py=["data"],yE=["rasterData"],bA=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,yg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class _E extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0),(0,Me.Z)(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Tn.Z)((0,Tn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,noDataValue:f=0}=this.layer.getLayerConfig(),{rMinMax:v=[0,255],gMinMax:S=[0,255],bMinMax:O=[0,255]}=this.dataOption,L={u_rminmax:v,u_gminmax:S,u_bminmax:O,u_opacity:o||1,u_noDataValue:f,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}getRasterData(o){var f=this;return(0,wi.Z)(function*(){if(Array.isArray(o.data)){const{data:L}=o,k=(0,fl.Z)(o,Py);return f.dataOption=k,(0,Tn.Z)({data:L},k)}const v=yield o.data,{rasterData:S}=v,O=(0,fl.Z)(v,yE);return f.dataOption=O,Array.isArray(S)?(0,Tn.Z)({data:S},O):(0,Tn.Z)({data:Array.from(S)},O)})()}initModels(){var o=this;return(0,wi.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,S=f.data.dataArray[0],{data:O,width:L,height:k}=yield o.getRasterData(S);return o.texture=v({data:new Float32Array(O),width:L,height:k,format:X.gl.RGB,type:X.gl.FLOAT}),[yield o.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:yg,fragmentShader:bA,defines:o.getDefines(),triangulation:U_,primitive:X.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const uP=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,EA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class $_ extends Rl{constructor(...o){super(...o),(0,Me.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,clampLow:f=!0,clampHigh:v=!0,noDataValue:S=-9999999,domain:O,rampColors:L,colorTexture:k,rScaler:V=6553.6,gScaler:Q=25.6,bScaler:st=.1,offset:ft=1e4}=this.layer.getLayerConfig(),Tt=O||(0,_t.ZB)(L);let se=k;k?this.layer.textureService.setColorTexture(k,L,Tt):se=this.layer.textureService.getColorTexture(L,Tt);const Ve={u_unpack:[V,Q,st,ft],u_domain:Tt,u_opacity:o||1,u_noDataValue:S,u_clampLow:f,u_clampHigh:typeof v!="undefined"?v:f,u_texture:this.texture,u_colorTexture:se};return this.textures=[this.texture,se],this.getUniformsBufferInfo(Ve)}initModels(){var o=this;return(0,wi.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,S=yield f.data.images;return o.texture=v({data:S[0],width:S[0].width,height:S[0].height,min:X.gl.LINEAR,mag:X.gl.LINEAR}),[yield o.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:EA,fragmentShader:uP,defines:o.getDefines(),triangulation:U_,primitive:X.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}buildModels(){var o=this;return(0,wi.Z)(function*(){return o.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:X.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:X.gl.DYNAMIC_DRAW,data:[],type:X.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var SA={raster:Ux,rasterRgb:_E,raster3d:Ux,rasterTerrainRgb:$_};class K_ extends v0{constructor(...o){super(...o),(0,Me.Z)(this,"type","RasterLayer")}buildModels(){var o=this;return(0,wi.Z)(function*(){const f=o.getModelType();o.layerModel=new SA[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[o]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(o){if(o!=="color")return{type:void 0,field:void 0,items:[]};const f=this.getLayerConfig().rampColors;return gc(f,o)}}const Iy=["rasterData"];class Dm extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=o.getSourceOption(),O=new K_((0,Tn.Z)({},v)).source(S.data,S.options);f&&Object.keys(f).forEach(L=>{var k,V;const Q=L;O[Q]((k=f[Q])===null||k===void 0?void 0:k.field,(V=f[Q])===null||V===void 0?void 0:V.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,S=(0,fl.Z)(f,Iy);return{data:v,options:{parser:(0,Tn.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},S),transforms:o.transforms}}}}class Q_ extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=o.getSourceOption(),O=new K_((0,Tn.Z)({},v)).source(S.data,S.options);f&&Object.keys(f).forEach(L=>{var k,V;const Q=L;O[Q]((k=f[Q])===null||k===void 0?void 0:k.field,(V=f[Q])===null||V===void 0?void 0:V.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const TA=["rasterData"],bE={positions:[0,1],colors:["#000","#fff"]};class _g extends ap{constructor(...o){super(...o),(0,Me.Z)(this,"colorTexture",void 0)}initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=o.getSourceOption(),{rampColors:O,domain:L}=o.getLayerOptions();o.colorTexture=o.parent.textureService.getColorTexture(O,L);const k=new K_((0,Tn.Z)((0,Tn.Z)({},v),{},{colorTexture:o.colorTexture})).source(S.data,S.options);f&&Object.keys(f).forEach(V=>{var Q,st;const ft=V;k[ft]((Q=f[ft])===null||Q===void 0?void 0:Q.field,(st=f[ft])===null||st===void 0?void 0:st.values)}),yield o.addLayer(k),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,S=(0,fl.Z)(f,TA);return{data:v,options:{parser:(0,Tn.Z)({type:"raster",extent:this.sourceTile.bounds},S),transforms:o.transforms}}}styleUpdate(...o){const{rampColors:f=bE,domain:v}=o;this.colorTexture=this.parent.textureService.getColorTexture(f,v||(0,_t.ZB)(f)),this.layers.forEach(S=>S.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(o=>o.destroy())}}class J_ extends ap{initTileLayer(){var o=this;return(0,wi.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),S=yA(o.parent.type),O=o.getSourceOption();if(!O){o.isLoaded=!0,o.emit("loaded");return}const L=new S((0,Tn.Z)({},v)).source(O.data,O.options);Object.keys(f).forEach(k=>{var V,Q;const st=k;L[st]((V=f[st])===null||V===void 0?void 0:V.field,(Q=f[st])===null||Q===void 0?void 0:Q.values)}),yield o.addLayer(L),v.tileMask&&(yield o.addTileMask()),o.setLayerMinMaxZoom(L),o.isLoaded=!0,o.emit("loaded")})()}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f="defaultLayer",featureId:v="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}setLayerMinMaxZoom(o){o.getModelType()==="text"&&o.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(o){return this.sourceTile.data.getTileData(o)}getFeatureById(o){const f=this.getMainLayer();return f?f.getSource().data.dataArray.filter(S=>S._id===o):[]}}function EE(a){switch(a.type){case"PolygonLayer":return J_;case"LineLayer":return J_;case"PointLayer":return J_;case"TileDebugLayer":return kx;case"MaskLayer":return gE;case"RasterLayer":const{dataType:f}=a.getSource().parser;switch(f){case X.n3.RGB:case X.n3.CUSTOMRGB:return Dm;case X.n3.ARRAYBUFFER:case X.n3.CUSTOMARRAYBUFFER:return _g;case X.n3.TERRAINRGB:case X.n3.CUSTOMTERRAINRGB:return Q_;default:return pE}default:return J_}}const SE=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:wA}=_t.lodashUtil;class AA{constructor(o){(0,Me.Z)(this,"parent",void 0),(0,Me.Z)(this,"tileLayerService",void 0),(0,Me.Z)(this,"mapService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"rendererService",void 0),(0,Me.Z)(this,"pickingService",void 0),(0,Me.Z)(this,"tilePickService",void 0),(0,Me.Z)(this,"tilesetManager",void 0),(0,Me.Z)(this,"initedTileset",!1),(0,Me.Z)(this,"lastViewStates",void 0),(0,Me.Z)(this,"mapchange",()=>{var v;if(this.parent.isVisible()===!1)return;const{latLonBounds:S,zoom:O}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===O&&this.lastViewStates.latLonBounds.toString()===S.toString()||(this.lastViewStates={zoom:O,latLonBounds:S},(v=this.tilesetManager)===null||v===void 0||v.throttleUpdate(O,S))}),(0,Me.Z)(this,"viewchange",wA(this.mapchange,24)),this.parent=o;const f=this.parent.getContainer();this.rendererService=f.rendererService,this.layerService=f.layerService,this.mapService=f.mapService,this.pickingService=f.pickingService,this.tileLayerService=new cA({rendererService:this.rendererService,layerService:this.layerService,parent:o}),this.tilePickService=new aE({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:o}),this.parent.setLayerPickService(this.tilePickService),this.proxy(o),this.initTileSetManager()}initTileSetManager(){var o;const f=this.parent.getSource();if(this.tilesetManager=f.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:v,zoom:S}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(S,v)}getCurrentView(){const o=this.mapService.getBounds(),f=[o[0][0],o[0][1],o[1][0],o[1][1]],v=this.mapService.getZoom();return{latLonBounds:f,zoom:v}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",o=>{}),this.tilesetManager.on("tile-unload",o=>{this.tileUnLoad(o)}),this.tilesetManager.on("tile-error",(o,f)=>{this.tileError(o)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(o){return this.tileLayerService.getTile(o)}tileLoaded(o){}tileError(o){console.warn("error:",o)}destroy(){var o;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(o=this.tilesetManager)===null||o===void 0||o.destroy(),this.tileLayerService.destroy()}reload(){var o;this.tilesetManager.clear();const{latLonBounds:f,zoom:v}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(v,f)}tileUnLoad(o){this.tileLayerService.removeTile(o.key)}tileUpdate(){var o=this;return(0,wi.Z)(function*(){if(!o.tilesetManager)return;const f=o.parent.getMinZoom(),v=o.parent.getMaxZoom(),S=o.tilesetManager.tiles.filter(O=>O.isLoaded).filter(O=>O.isVisibleChange).filter(O=>O.data).filter(O=>O.z>=f&&O.z<v);yield Promise.all(S.map(function(){var O=(0,wi.Z)(function*(L){if(o.tileLayerService.hasTile(L.key))o.tileLayerService.updateTileVisible(L),o.tilePickService.setPickState(),o.layerService.reRender();else{const k=EE(o.parent),V=new k(L,o.parent);yield V.initTileLayer(),o.tilePickService.setPickState(),V.getLayers().length!==0&&(o.tileLayerService.addTile(V),o.tileLayerService.updateTileVisible(L),o.layerService.reRender())}});return function(L){return O.apply(this,arguments)}}())),o.tilesetManager.isLoaded&&o.parent.emit("tiles-loaded",o.tilesetManager.currentTiles)})()}setPickState(o){}pickRender(o){this.tilePickService.pickRender(o)}selectFeature(o){this.tilePickService.selectFeature(o)}highlightPickedFeature(o){this.tilePickService.highlightPickedFeature(o)}proxy(o){SE.forEach(f=>{const v=o[f].bind(o);o[f]=(...S)=>(v(...S),this.getLayers().map(O=>{O[f](...S)}),f==="style"&&this.getTiles().forEach(O=>O.styleUpdate(...S)),o)})}}class x0 extends null{constructor(...o){super(...o),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",f=>{switch(f.stopPropagation(),f.type){case"touchcancel":case"touchend":case"mouseup":{var v;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(S=>{document.removeEventListener(S,this.move)}),(v=this.scene)===null||v===void 0||v.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(S=>{document.addEventListener(S,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let S;if("pageX"in f?S=f.pageX:f.touches&&f.touches.length&&f.touches[0].pageX?S=f.touches[0].pageX:f.changedTouches&&f.changedTouches.length&&(S=f.changedTouches[0].pageX),!S)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),k=L[0],V=(O==null?void 0:O.left)||0,Q=S-V+window.scrollX-document.documentElement.clientLeft,st=k-Math.min(Math.max(0,k-Q),k),ft=st/k;this.setOptions({ratio:ft}),this.emit("moving",{size:[st,L[1]],ratio:[ft,0]})}else{let S;if("pageY"in f?S=f.pageY:f.touches&&f.touches.length&&f.touches[0].pageY?S=f.touches[0].pageY:f.changedTouches&&f.changedTouches.length&&(S=f.changedTouches[0].pageY),!S)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),k=L[1],V=(O==null?void 0:O.top)||0,Q=S-V+window.scrollY-document.documentElement.clientTop,st=k-Math.min(Math.max(0,k-Q),k),ft=st/k;this.setOptions({ratio:ft}),this.emit("moving",{size:[L[0],st],ratio:[0,ft]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var f;if(!this.mapsService)return;const v=this.getMaskGeoData();(f=this.maskLayer)===null||f===void 0||f.setData(v)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const o=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",o);const{orientation:f="vertical",ratio:v=.5}=this.controlOption;return f==="horizontal"?(o.style.top=v*100+"%",o.style.left=""):(o.style.left=v*100+"%",o.style.top=""),o.classList.add(f),o}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd();const{className:f,style:v,layers:S,rightLayers:O}=this.controlOption;f&&this.setClassName(f),v&&this.setStyle(v),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const L=createLayerContainer(o);return this.maskLayer.setContainer(L),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(S,!1),this.addMaskToLayers(O,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var o;const{layers:f,rightLayers:v}=this.controlOption;this.removeMaskFromLayers(f),this.removeMaskFromLayers(v),(o=this.layerService)===null||o===void 0||o.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var o;const f=this.container;DOM.removeClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:S}=this.controlOption;v.forEach(O=>O.enableMask()),S.forEach(O=>O.enableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!0,this.emit("show",this)}hide(){var o;const f=this.container;DOM.addClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:S}=this.controlOption;v.forEach(O=>O.disableMask()),S.forEach(O=>O.disableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!1,this.emit("hide",this)}setOptions(o){const f=_objectSpread(_objectSpread({},this.controlOption),o);if(o.className&&this.setClassName(o.className),o.style&&this.setStyle(o.style),(o.orientation||o.ratio!==void 0)&&this.setOrientationAndRatio(f.orientation,f.ratio),o.layers){const v=o.layers,S=this.controlOption.layers;this.setLayers(v,S,!1)}if(o.rightLayers){const v=o.rightLayers,S=this.controlOption.rightLayers;this.setLayers(v,S,!0)}this.controlOption=f,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var o;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(o=this.mapsService)===null||o===void 0||o.off("camerachange",this.updateMask)}setOrientationAndRatio(o="vertical",f=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(o),o==="horizontal"?(this.container.style.top=f*100+"%",this.container.style.left=""):(this.container.style.left=f*100+"%",this.container.style.top="")}setLayers(o,f,v=!1){const S=o.filter(L=>f.includes(L)===!1),O=f.filter(L=>o.includes(L)===!1);this.addMaskToLayers(S,v),this.removeMaskFromLayers(O)}addMaskToLayers(o,f){o.forEach(v=>{v.updateLayerConfig({maskInside:!f}),v.addMask(this.maskLayer)})}removeMaskFromLayers(o){o.forEach(f=>{f.updateLayerConfig({maskInside:!0}),f.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:o=.5,orientation:f="vertical"}=this.controlOption,v=f==="vertical",[S,O]=this.getBounds(),[L,k]=S,[V,Q]=O;let st;if(v){const Tt=L+(V-L)*o;st=[[L,Q],[Tt,Q],[Tt,k],S,[L,Q]]}else{const Tt=this.getContainerSize(),Ve=this.mapsService.containerToLngLat([Tt[0],Tt[1]*o]).lat;st=[[L,Q],O,[V,Ve],[L,Ve],[L,Q]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[st]}}]}}getContainerDOMRect(){var o;return(o=this.mapsService.getContainer())===null||o===void 0?void 0:o.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(o,f=!1){const v=Array.isArray(o)?o:[o];if(f){const S=this.controlOption.rightLayers.concat(...v);this.setOptions({rightLayers:S})}else{const S=this.controlOption.layers.concat(...v);this.setOptions({layers:S})}}removeLayer(o){const f=Array.isArray(o)?o:[o],v=this.controlOption.layers.filter(O=>f.includes(O)),S=this.controlOption.rightLayers.filter(O=>f.includes(O));this.setOptions({layers:v,rightLayers:S})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class fP extends null{constructor(...o){super(...o),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const f=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||f.getZoom()<=f.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(f.getZoom()))),(this.disabled||f.getZoom()>=f.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const o=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(o),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),o}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(o){DOM.clearChildren(o),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",o,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",o)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",o,this.zoomOut),this.updateDisabled()}createButton(o,f,v,S,O){const L=DOM.create("button",v,S);return typeof o=="string"?L.innerHTML=o:L.append(o),L.title=f,O&&L.addEventListener("click",O),L}}class TE extends Gc.EventEmitter{get lngLat(){var o;return(o=this.popupOption.lngLat)!==null&&o!==void 0?o:{lng:0,lat:0}}set lngLat(o){this.popupOption.lngLat=o}constructor(o){super(),(0,Me.Z)(this,"popupOption",void 0),(0,Me.Z)(this,"mapsService",void 0),(0,Me.Z)(this,"sceneService",void 0),(0,Me.Z)(this,"layerService",void 0),(0,Me.Z)(this,"scene",void 0),(0,Me.Z)(this,"closeButton",void 0),(0,Me.Z)(this,"container",void 0),(0,Me.Z)(this,"content",void 0),(0,Me.Z)(this,"contentTitle",void 0),(0,Me.Z)(this,"contentPanel",void 0),(0,Me.Z)(this,"tip",void 0),(0,Me.Z)(this,"isShow",!0),(0,Me.Z)(this,"onMouseMove",v=>{var S;const O=this.mapsService.getMapContainer(),{left:L=0,top:k=0}=(S=O==null?void 0:O.getBoundingClientRect())!==null&&S!==void 0?S:{};this.setPopupPosition(v.clientX-L,v.clientY-k)}),(0,Me.Z)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:v,lat:S}=this.lngLat,{x:O,y:L}=this.mapsService.lngLatToContainer([v,S]);this.setPopupPosition(O,L)}),(0,Me.Z)(this,"updateLngLatPositionWhenZoom",v=>{if(!this.mapsService||this.popupOption.followCursor)return;const S=v.map,O=S.getSize();O.x=O.x/2,O.y=O.y/2;const L=v.center,k=v.zoom,V=S.DE(this.lngLat,k,L);V.x=Math.round(V.x),V.y=Math.round(V.y),this.setPopupPosition(V.x,V.y,!0)}),(0,Me.Z)(this,"onKeyDown",v=>{v.keyCode===27&&this.remove()}),(0,Me.Z)(this,"onCloseButtonClick",v=>{v.stopPropagation&&v.stopPropagation(),this.hide()}),(0,Me.Z)(this,"updatePosition",(v,S=!0)=>{const O=!!this.lngLat,{className:L,style:k,maxWidth:V,anchor:Q,stopPropagation:st}=this.popupOption;if(!this.mapsService||!O||!this.content)return;const ft=this.mapsService.getMarkerContainer();if(!this.container&&ft&&(this.container=_t.SO.create("div",`l7-popup ${L!=null?L:""} ${this.isShow?"":"l7-popup-hide"}`,ft),k&&this.container.setAttribute("style",k),this.tip=_t.SO.create("div","l7-popup-tip",this.container),this.container.appendChild(this.content),st&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(Tt=>{this.container.addEventListener(Tt,se=>{se.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),S?this.updateLngLatPositionWhenZoom(v):this.updateLngLatPosition(),_t.SO.setTransform(this.container,`${_t.rQ[Q]}`),(0,_t.zi)(this.container,Q,"popup"),V){const{width:Tt}=this.container.getBoundingClientRect();Tt>parseFloat(V)&&(this.container.style.width=V)}else this.container.style.removeProperty("width")}),(0,Me.Z)(this,"updateWhenZoom",v=>{this.updatePosition(v,!0)}),(0,Me.Z)(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=(0,Tn.Z)((0,Tn.Z)({},this.getDefault(o!=null?o:{})),o);const{lngLat:f}=this.popupOption;f&&(this.lngLat=f)}getIsShow(){return this.isShow}addTo(o){this.mapsService=o.mapService,this.sceneService=o.sceneService,this.layerService=o.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=o,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:f,text:v,title:S}=this.popupOption;return f?this.setHTML(f):v&&this.setText(v),S&&this.setTitle(S),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&_t.SO.remove(this.content),this.container&&(_t.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(o){this.show();const{className:f}=this.popupOption;if(this.popupOption=(0,Tn.Z)((0,Tn.Z)({},this.popupOption),o),this.checkUpdateOption(o,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(_t.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(o,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(o,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(o,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(o,["html"])&&o.html?this.setHTML(o.html):this.checkUpdateOption(o,["text"])&&o.text&&this.setText(o.text),this.checkUpdateOption(o,["className"])){var v;f&&this.container.classList.remove(f!=null?f:""),this.container.classList.add((v=o.className)!==null&&v!==void 0?v:"")}if(this.checkUpdateOption(o,["style"])){var S;_t.SO.addStyle(this.container,(S=o.style)!==null&&S!==void 0?S:"")}return this.checkUpdateOption(o,["lngLat"])&&o.lngLat&&this.setLnglat(o.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&_t.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&_t.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(o){return this.popupOption.html=o,this.setDOMContent(o)}setText(o){return this.popupOption.text=o,this.setDOMContent(window.document.createTextNode(o))}setTitle(o){this.show(),this.popupOption.title=o,o?(this.contentTitle||(this.contentTitle=_t.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),_t.SO.clearChildren(this.contentTitle),_t.SO.appendElementType(this.contentTitle,o)):this.contentTitle&&(_t.SO.remove(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:o,lat:f}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([o,f]),this}setLngLat(o){return this.setLnglat(o)}setLnglat(o){return this.show(),this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(o){return this.popupOption.maxWidth=o,this.update(),this}isOpen(){return!!this.mapsService}getDefault(o){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:_t.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(o){return this.show(),this.createContent(),_t.SO.appendElementType(this.contentPanel,o),this.update(),this}updateCloseOnClick(o){const f=this.mapsService;f&&(f==null||f.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!o&&requestAnimationFrame(()=>{f==null||f.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(o){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!o&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(o){var f;const v=(f=this.mapsService)===null||f===void 0?void 0:f.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!o&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&_t.SO.remove(this.content),this.contentTitle=void 0,this.content=_t.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const o=ml("l7-icon-guanbi");_t.SO.addClass(o,"l7-popup-close-button"),this.content.appendChild(o),this.popupOption.closeButtonOffsets&&(o.style.right=this.popupOption.closeButtonOffsets[0]+"px",o.style.top=this.popupOption.closeButtonOffsets[1]+"px"),o.setAttribute("aria-label","Close popup"),o.addEventListener("click",()=>{this.hide()}),o.addEventListener("pointerup",f=>{f.stopPropagation()}),o.addEventListener("pointerdown",f=>{f.stopPropagation()}),this.closeButton=o}else this.closeButton=void 0;this.contentPanel=_t.SO.create("div","l7-popup-content__panel",this.content)}setPopupPosition(o,f,v=!1){if(this.container){const{offsets:S}=this.popupOption;this.container.style.left=o+S[0]+"px",this.container.style.top=f-S[1]+"px",v?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(o,f){return f.some(v=>v in o)}}const{get:Y0}=_t.lodashUtil;class hP extends null{constructor(...o){super(...o),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(f,v)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(f,v.featureId))this.hide();else{const{title:S,content:O}=this.getLayerInfoFrag(f,v);this.setDOMContent(O),this.setLnglat(v.lngLat),this.setTitle(S),this.setDisplayFeatureInfo({layer:f,featureId:v.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var o;const{config:f,items:v}=this.popupOption;return(o=f!=null?f:v)!==null&&o!==void 0?o:[]}addTo(o){return super.addTo(o),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(o){this.unbindLayerEvent();const f=_objectSpread({},o),v=f.trigger||this.popupOption.trigger,S=f.items||this.popupOption.items,O=(S==null?void 0:S.length)===0;f.followCursor=v==="hover"&&!O;const L=this.isShow;return super.setOptions(f),this.bindLayerEvent(),(O||!L)&&this.hide(),this}getDefault(o){const f=o.trigger!=="click";return _objectSpread(_objectSpread({},super.getDefault(o)),{},{trigger:"hover",followCursor:f,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:o,closeOnClick:f}=this.popupOption;this.layerConfigItems.forEach(v=>{var S;const O=this.getLayerByConfig(v);if(!O)return;const L=_objectSpread({},v);if(o==="hover"){const st=this.onLayerMouseMove.bind(this,O),ft=this.onLayerMouseOut.bind(this,O);L.onMouseMove=st,L.onMouseOut=ft,O==null||O.on("mousemove",st),O==null||O.on("mouseout",ft)}else{var k;const st=this.onLayerClick.bind(this,O);L.onClick=st,O==null||O.on("click",st);const ft=(k=this.mapsService)===null||k===void 0?void 0:k.getMapContainer();ft&&f&&ft.addEventListener("click",this.onSceneClick)}const V=O==null||(S=O.getSource)===null||S===void 0?void 0:S.call(O),Q=this.onSourceUpdate.bind(this);V==null||V.on("update",Q),L.onSourceUpdate=Q,this.layerConfigMap.set(O,L)})}unbindLayerEvent(){this.layerConfigItems.forEach(o=>{var f;const v=this.getLayerByConfig(o),S=v&&this.layerConfigMap.get(v);if(!S)return;const{onMouseMove:O,onMouseOut:L,onClick:k,onSourceUpdate:V}=S;if(O&&v.off("mousemove",O),L&&v.off("mouseout",L),k&&v.off("click",k),V){var Q;v==null||(Q=v.getSource())===null||Q===void 0||Q.off("update",V)}const st=(f=this.mapsService)===null||f===void 0?void 0:f.getMapContainer();st&&st.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(o,f){if(!this.isSameFeature(o,f.featureId)){const{title:v,content:S}=this.getLayerInfoFrag(o,f);this.setDOMContent(S),this.setTitle(v),this.setDisplayFeatureInfo({layer:o,featureId:f.featureId}),this.show()}}onLayerMouseOut(o,f){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(o,f){const v=this.layerConfigMap.get(o);let S;const O=document.createDocumentFragment();if(v){let L=f.feature;L.type==="Feature"&&"properties"in L&&"geometry"in L&&(L=L.properties);const{title:k,fields:V,customContent:Q}=v;if(k){S=document.createDocumentFragment();const st=k instanceof Function?k(L):k;DOM.appendElementType(S,st)}if(Q){const st=Q instanceof Function?Q(L):Q;DOM.appendElementType(O,st)}else V!=null&&V.length&&(V==null||V.forEach(st=>{var ft,Tt;const{field:se,formatField:Ve,formatValue:yn,getValue:lr}=typeof st=="string"?{field:st}:st,Nr=DOM.create("div","l7-layer-popup__row"),Ln=lr?lr(f.feature):Y0(L,se),ci=(ft=Ve instanceof Function?Ve(se,L):Ve)!==null&&ft!==void 0?ft:se;let Fi=(Tt=yn instanceof Function?yn(Ln,L):yn)!==null&&Tt!==void 0?Tt:Ln;const So=DOM.create("span","l7-layer-popup__key",Nr);DOM.appendElementType(So,ci),DOM.appendElementType(So,document.createTextNode("\uFF1A"));const Ji=DOM.create("span","l7-layer-popup__value",Nr);Array.isArray(Fi)&&Fi.every(Vr=>!(Vr instanceof Object))&&(Fi=Fi.map(Vr=>String(Vr)).join(",")),DOM.appendElementType(Ji,Fi),O.appendChild(Nr)}))}return{title:S,content:O}}getLayerByConfig(o){const f=o.layer;if(f instanceof Object)return f;if(typeof f=="string")return this.layerService.getLayer(f)||this.layerService.getLayerByName(f)}isSameFeature(o,f){const v=this.displayFeatureInfo;return v&&o===v.layer&&f===v.featureId}setDisplayFeatureInfo(o){const f=this.displayFeatureInfo;f&&f.layer.off("hide",this.onLayerHide),o&&o.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=o}}function wE(a,o){var f=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,v=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(f||v)&&(o||(o=document),!!o)){var S=o.head||o.getElementsByTagName("head")[0];if(!S){S=o.createElement("head");var O=o.body||o.getElementsByTagName("body")[0];O?O.parentNode.insertBefore(S,O):o.documentElement.appendChild(S)}var L=o.createElement("style");return L.type="text/css",L.styleSheet?L.styleSheet.cssText=a:L.appendChild(o.createTextNode(a)),S.appendChild(L),L}}wE(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var OA=it(81550),CA=it.n(OA),Af=class{constructor(a,o){const{buffer:f,offset:v,stride:S,normalized:O,size:L,divisor:k}=o;this.buffer=f,this.attribute={buffer:f.get(),offset:v||0,stride:S||0,normalized:O||!1,divisor:k||0},L&&(this.attribute.size=L)}get(){return this.attribute}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},sd={[X.gl.POINTS]:"points",[X.gl.LINES]:"lines",[X.gl.LINE_LOOP]:"line loop",[X.gl.LINE_STRIP]:"line strip",[X.gl.TRIANGLES]:"triangles",[X.gl.TRIANGLE_FAN]:"triangle fan",[X.gl.TRIANGLE_STRIP]:"triangle strip"},AE={[X.gl.STATIC_DRAW]:"static",[X.gl.DYNAMIC_DRAW]:"dynamic",[X.gl.STREAM_DRAW]:"stream"},Ly={[X.gl.BYTE]:"int8",[X.gl.INT]:"int32",[X.gl.UNSIGNED_BYTE]:"uint8",[X.gl.UNSIGNED_SHORT]:"uint16",[X.gl.UNSIGNED_INT]:"uint32",[X.gl.FLOAT]:"float"},RA={[X.gl.ALPHA]:"alpha",[X.gl.LUMINANCE]:"luminance",[X.gl.LUMINANCE_ALPHA]:"luminance alpha",[X.gl.RGB]:"rgb",[X.gl.RGBA]:"rgba",[X.gl.RGBA4]:"rgba4",[X.gl.RGB5_A1]:"rgb5 a1",[X.gl.RGB565]:"rgb565",[X.gl.DEPTH_COMPONENT]:"depth",[X.gl.DEPTH_STENCIL]:"depth stencil"},MA={[X.gl.DONT_CARE]:"dont care",[X.gl.NICEST]:"nice",[X.gl.FASTEST]:"fast"},OE={[X.gl.NEAREST]:"nearest",[X.gl.LINEAR]:"linear",[X.gl.LINEAR_MIPMAP_LINEAR]:"mipmap",[X.gl.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[X.gl.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[X.gl.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},Ga={[X.gl.REPEAT]:"repeat",[X.gl.CLAMP_TO_EDGE]:"clamp",[X.gl.MIRRORED_REPEAT]:"mirror"},PA={[X.gl.NONE]:"none",[X.gl.BROWSER_DEFAULT_WEBGL]:"browser"},lp={[X.gl.NEVER]:"never",[X.gl.ALWAYS]:"always",[X.gl.LESS]:"less",[X.gl.LEQUAL]:"lequal",[X.gl.GREATER]:"greater",[X.gl.GEQUAL]:"gequal",[X.gl.EQUAL]:"equal",[X.gl.NOTEQUAL]:"notequal"},t1={[X.gl.FUNC_ADD]:"add",[X.gl.MIN_EXT]:"min",[X.gl.MAX_EXT]:"max",[X.gl.FUNC_SUBTRACT]:"subtract",[X.gl.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},zx={[X.gl.ZERO]:"zero",[X.gl.ONE]:"one",[X.gl.SRC_COLOR]:"src color",[X.gl.ONE_MINUS_SRC_COLOR]:"one minus src color",[X.gl.SRC_ALPHA]:"src alpha",[X.gl.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[X.gl.DST_COLOR]:"dst color",[X.gl.ONE_MINUS_DST_COLOR]:"one minus dst color",[X.gl.DST_ALPHA]:"dst alpha",[X.gl.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[X.gl.CONSTANT_COLOR]:"constant color",[X.gl.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[X.gl.CONSTANT_ALPHA]:"constant alpha",[X.gl.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[X.gl.SRC_ALPHA_SATURATE]:"src alpha saturate"},dP={[X.gl.NEVER]:"never",[X.gl.ALWAYS]:"always",[X.gl.LESS]:"less",[X.gl.LEQUAL]:"lequal",[X.gl.GREATER]:"greater",[X.gl.GEQUAL]:"gequal",[X.gl.EQUAL]:"equal",[X.gl.NOTEQUAL]:"notequal"},el={[X.gl.ZERO]:"zero",[X.gl.KEEP]:"keep",[X.gl.REPLACE]:"replace",[X.gl.INVERT]:"invert",[X.gl.INCR]:"increment",[X.gl.DECR]:"decrement",[X.gl.INCR_WRAP]:"increment wrap",[X.gl.DECR_WRAP]:"decrement wrap"},Ih={[X.gl.FRONT]:"front",[X.gl.BACK]:"back"},q0=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:S}=o;this.buffer=a.buffer({data:f,usage:AE[v||X.gl.STATIC_DRAW],type:Ly[S||X.gl.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){this.buffer.subdata(a,o)}},Dy=class{constructor(a,o){const{data:f,usage:v,type:S,count:O}=o;this.elements=a.elements({data:f,usage:AE[v||X.gl.STATIC_DRAW],type:Ly[S||X.gl.UNSIGNED_BYTE],count:O})}get(){return this.elements}subData({data:a}){this.elements.subdata(a)}destroy(){}},jx=class{constructor(a,o){const{width:f,height:v,color:S,colors:O}=o,L={width:f,height:v};Array.isArray(O)&&(L.colors=O.map(k=>k.get())),S&&typeof S!="boolean"&&(L.color=S.get()),this.framebuffer=a.framebuffer(L)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:a,height:o}){this.framebuffer.resize(a,o)}},Of=it(95147),cp=it(25897),Ny=it(81957),go=it(97582),pP=it(90857),CE=pP,pn;(function(a){a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",a[a.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.CULL_FACE=2884]="CULL_FACE",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.BLEND=3042]="BLEND",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.DITHER=3024]="DITHER",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DOUBLE=5130]="DOUBLE",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.ALWAYS=519]="ALWAYS",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.GEQUAL=518]="GEQUAL",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",a[a.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",a[a.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.READ_BUFFER=3074]="READ_BUFFER",a[a.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",a[a.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",a[a.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",a[a.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",a[a.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",a[a.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",a[a.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",a[a.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",a[a.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",a[a.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",a[a.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",a[a.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",a[a.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",a[a.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",a[a.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",a[a.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",a[a.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",a[a.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",a[a.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",a[a.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",a[a.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",a[a.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",a[a.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",a[a.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",a[a.RED=6403]="RED",a[a.RGB8=32849]="RGB8",a[a.RGBA8=32856]="RGBA8",a[a.RGB10_A2=32857]="RGB10_A2",a[a.TEXTURE_3D=32879]="TEXTURE_3D",a[a.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",a[a.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",a[a.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",a[a.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",a[a.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",a[a.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",a[a.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",a[a.SRGB=35904]="SRGB",a[a.SRGB8=35905]="SRGB8",a[a.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",a[a.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",a[a.RGBA32F=34836]="RGBA32F",a[a.RGB32F=34837]="RGB32F",a[a.RGBA16F=34842]="RGBA16F",a[a.RGB16F=34843]="RGB16F",a[a.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",a[a.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",a[a.R11F_G11F_B10F=35898]="R11F_G11F_B10F",a[a.RGB9_E5=35901]="RGB9_E5",a[a.RGBA32UI=36208]="RGBA32UI",a[a.RGB32UI=36209]="RGB32UI",a[a.RGBA16UI=36214]="RGBA16UI",a[a.RGB16UI=36215]="RGB16UI",a[a.RGBA8UI=36220]="RGBA8UI",a[a.RGB8UI=36221]="RGB8UI",a[a.RGBA32I=36226]="RGBA32I",a[a.RGB32I=36227]="RGB32I",a[a.RGBA16I=36232]="RGBA16I",a[a.RGB16I=36233]="RGB16I",a[a.RGBA8I=36238]="RGBA8I",a[a.RGB8I=36239]="RGB8I",a[a.RED_INTEGER=36244]="RED_INTEGER",a[a.RGB_INTEGER=36248]="RGB_INTEGER",a[a.RGBA_INTEGER=36249]="RGBA_INTEGER",a[a.R8=33321]="R8",a[a.RG8=33323]="RG8",a[a.R16F=33325]="R16F",a[a.R32F=33326]="R32F",a[a.RG16F=33327]="RG16F",a[a.RG32F=33328]="RG32F",a[a.R8I=33329]="R8I",a[a.R8UI=33330]="R8UI",a[a.R16I=33331]="R16I",a[a.R16UI=33332]="R16UI",a[a.R32I=33333]="R32I",a[a.R32UI=33334]="R32UI",a[a.RG8I=33335]="RG8I",a[a.RG8UI=33336]="RG8UI",a[a.RG16I=33337]="RG16I",a[a.RG16UI=33338]="RG16UI",a[a.RG32I=33339]="RG32I",a[a.RG32UI=33340]="RG32UI",a[a.R8_SNORM=36756]="R8_SNORM",a[a.RG8_SNORM=36757]="RG8_SNORM",a[a.RGB8_SNORM=36758]="RGB8_SNORM",a[a.RGBA8_SNORM=36759]="RGBA8_SNORM",a[a.RGB10_A2UI=36975]="RGB10_A2UI",a[a.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",a[a.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",a[a.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",a[a.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",a[a.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",a[a.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",a[a.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",a[a.HALF_FLOAT=5131]="HALF_FLOAT",a[a.RG=33319]="RG",a[a.RG_INTEGER=33320]="RG_INTEGER",a[a.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",a[a.CURRENT_QUERY=34917]="CURRENT_QUERY",a[a.QUERY_RESULT=34918]="QUERY_RESULT",a[a.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",a[a.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",a[a.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",a[a.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",a[a.DRAW_BUFFER0=34853]="DRAW_BUFFER0",a[a.DRAW_BUFFER1=34854]="DRAW_BUFFER1",a[a.DRAW_BUFFER2=34855]="DRAW_BUFFER2",a[a.DRAW_BUFFER3=34856]="DRAW_BUFFER3",a[a.DRAW_BUFFER4=34857]="DRAW_BUFFER4",a[a.DRAW_BUFFER5=34858]="DRAW_BUFFER5",a[a.DRAW_BUFFER6=34859]="DRAW_BUFFER6",a[a.DRAW_BUFFER7=34860]="DRAW_BUFFER7",a[a.DRAW_BUFFER8=34861]="DRAW_BUFFER8",a[a.DRAW_BUFFER9=34862]="DRAW_BUFFER9",a[a.DRAW_BUFFER10=34863]="DRAW_BUFFER10",a[a.DRAW_BUFFER11=34864]="DRAW_BUFFER11",a[a.DRAW_BUFFER12=34865]="DRAW_BUFFER12",a[a.DRAW_BUFFER13=34866]="DRAW_BUFFER13",a[a.DRAW_BUFFER14=34867]="DRAW_BUFFER14",a[a.DRAW_BUFFER15=34868]="DRAW_BUFFER15",a[a.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",a[a.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",a[a.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",a[a.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",a[a.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",a[a.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",a[a.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",a[a.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",a[a.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",a[a.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",a[a.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",a[a.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",a[a.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",a[a.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",a[a.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",a[a.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",a[a.SAMPLER_3D=35679]="SAMPLER_3D",a[a.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",a[a.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",a[a.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",a[a.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",a[a.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",a[a.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",a[a.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",a[a.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",a[a.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",a[a.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",a[a.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",a[a.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",a[a.MAX_SAMPLES=36183]="MAX_SAMPLES",a[a.SAMPLER_BINDING=35097]="SAMPLER_BINDING",a[a.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",a[a.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",a[a.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",a[a.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",a[a.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",a[a.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",a[a.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",a[a.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",a[a.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",a[a.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",a[a.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",a[a.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",a[a.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",a[a.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",a[a.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",a[a.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",a[a.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",a[a.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",a[a.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",a[a.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",a[a.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",a[a.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",a[a.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",a[a.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",a[a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",a[a.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",a[a.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",a[a.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",a[a.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",a[a.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",a[a.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",a[a.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",a[a.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",a[a.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",a[a.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",a[a.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",a[a.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",a[a.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",a[a.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",a[a.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",a[a.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",a[a.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",a[a.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",a[a.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",a[a.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",a[a.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",a[a.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",a[a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",a[a.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",a[a.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",a[a.UNIFORM_TYPE=35383]="UNIFORM_TYPE",a[a.UNIFORM_SIZE=35384]="UNIFORM_SIZE",a[a.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",a[a.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",a[a.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",a[a.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",a[a.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",a[a.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",a[a.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",a[a.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",a[a.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",a[a.OBJECT_TYPE=37138]="OBJECT_TYPE",a[a.SYNC_CONDITION=37139]="SYNC_CONDITION",a[a.SYNC_STATUS=37140]="SYNC_STATUS",a[a.SYNC_FLAGS=37141]="SYNC_FLAGS",a[a.SYNC_FENCE=37142]="SYNC_FENCE",a[a.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",a[a.UNSIGNALED=37144]="UNSIGNALED",a[a.SIGNALED=37145]="SIGNALED",a[a.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",a[a.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",a[a.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",a[a.WAIT_FAILED=37149]="WAIT_FAILED",a[a.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",a[a.COLOR=6144]="COLOR",a[a.DEPTH=6145]="DEPTH",a[a.STENCIL=6146]="STENCIL",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX",a[a.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",a[a.STREAM_READ=35041]="STREAM_READ",a[a.STREAM_COPY=35042]="STREAM_COPY",a[a.STATIC_READ=35045]="STATIC_READ",a[a.STATIC_COPY=35046]="STATIC_COPY",a[a.DYNAMIC_READ=35049]="DYNAMIC_READ",a[a.DYNAMIC_COPY=35050]="DYNAMIC_COPY",a[a.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",a[a.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",a[a.INVALID_INDEX=4294967295]="INVALID_INDEX",a[a.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",a[a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",a[a.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",a[a.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",a[a.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",a[a.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",a[a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",a[a.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",a[a.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",a[a.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",a[a.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",a[a.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",a[a.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",a[a.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",a[a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",a[a.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",a[a.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",a[a.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",a[a.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",a[a.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",a[a.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",a[a.RGBA32F_EXT=34836]="RGBA32F_EXT",a[a.RGB32F_EXT=34837]="RGB32F_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",a[a.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.SRGB_EXT=35904]="SRGB_EXT",a[a.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",a[a.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",a[a.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",a[a.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",a[a.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",a[a.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",a[a.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",a[a.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",a[a.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",a[a.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",a[a.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",a[a.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",a[a.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",a[a.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",a[a.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",a[a.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",a[a.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",a[a.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",a[a.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",a[a.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",a[a.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",a[a.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",a[a.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",a[a.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",a[a.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",a[a.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",a[a.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",a[a.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",a[a.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",a[a.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",a[a.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",a[a.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",a[a.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",a[a.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",a[a.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",a[a.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",a[a.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",a[a.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",a[a.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",a[a.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",a[a.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",a[a.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",a[a.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",a[a.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(pn||(pn={}));var Ls;(function(a){a[a.Buffer=0]="Buffer",a[a.Texture=1]="Texture",a[a.RenderTarget=2]="RenderTarget",a[a.Sampler=3]="Sampler",a[a.Program=4]="Program",a[a.Bindings=5]="Bindings",a[a.InputLayout=6]="InputLayout",a[a.RenderPipeline=7]="RenderPipeline",a[a.ComputePipeline=8]="ComputePipeline",a[a.Readback=9]="Readback",a[a.QueryPool=10]="QueryPool",a[a.RenderBundle=11]="RenderBundle"})(Ls||(Ls={}));var Ha;(function(a){a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS"})(Ha||(Ha={}));var ky;(function(a){a[a.CCW=2305]="CCW",a[a.CW=2304]="CW"})(ky||(ky={}));var ld;(function(a){a[a.NONE=0]="NONE",a[a.FRONT=1]="FRONT",a[a.BACK=2]="BACK",a[a.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(ld||(ld={}));var os;(function(a){a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC=768]="SRC",a[a.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",a[a.DST=774]="DST",a[a.ONE_MINUS_DST=775]="ONE_MINUS_DST",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.CONST=32769]="CONST",a[a.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(os||(os={}));var hf;(function(a){a[a.ADD=32774]="ADD",a[a.SUBSTRACT=32778]="SUBSTRACT",a[a.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX"})(hf||(hf={}));var Cf;(function(a){a[a.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",a[a.REPEAT=1]="REPEAT",a[a.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(Cf||(Cf={}));var ia;(function(a){a[a.POINT=0]="POINT",a[a.BILINEAR=1]="BILINEAR"})(ia||(ia={}));var Zl;(function(a){a[a.NO_MIP=0]="NO_MIP",a[a.NEAREST=1]="NEAREST",a[a.LINEAR=2]="LINEAR"})(Zl||(Zl={}));var Pl;(function(a){a[a.POINTS=0]="POINTS",a[a.TRIANGLES=1]="TRIANGLES",a[a.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",a[a.LINES=3]="LINES",a[a.LINE_STRIP=4]="LINE_STRIP"})(Pl||(Pl={}));var _s;(function(a){a[a.MAP_READ=1]="MAP_READ",a[a.MAP_WRITE=2]="MAP_WRITE",a[a.COPY_SRC=4]="COPY_SRC",a[a.COPY_DST=8]="COPY_DST",a[a.INDEX=16]="INDEX",a[a.VERTEX=32]="VERTEX",a[a.UNIFORM=64]="UNIFORM",a[a.STORAGE=128]="STORAGE",a[a.INDIRECT=256]="INDIRECT",a[a.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(_s||(_s={}));var cd;(function(a){a[a.STATIC=1]="STATIC",a[a.DYNAMIC=2]="DYNAMIC"})(cd||(cd={}));var Av;(function(a){a[a.VERTEX=1]="VERTEX",a[a.INSTANCE=2]="INSTANCE"})(Av||(Av={}));var RE;(function(a){a.LOADED="loaded"})(RE||(RE={}));var ts;(function(a){a[a.TEXTURE_2D=0]="TEXTURE_2D",a[a.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",a[a.TEXTURE_3D=2]="TEXTURE_3D",a[a.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(ts||(ts={}));var hu;(function(a){a[a.SAMPLED=1]="SAMPLED",a[a.RENDER_TARGET=2]="RENDER_TARGET",a[a.STORAGE=4]="STORAGE"})(hu||(hu={}));var $u;(function(a){a[a.NONE=0]="NONE",a[a.RED=1]="RED",a[a.GREEN=2]="GREEN",a[a.BLUE=4]="BLUE",a[a.ALPHA=8]="ALPHA",a[a.RGB=7]="RGB",a[a.ALL=15]="ALL"})($u||($u={}));var Oc;(function(a){a[a.KEEP=7680]="KEEP",a[a.ZERO=0]="ZERO",a[a.REPLACE=7681]="REPLACE",a[a.INVERT=5386]="INVERT",a[a.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",a[a.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",a[a.INCREMENT_WRAP=34055]="INCREMENT_WRAP",a[a.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(Oc||(Oc={}));function ME(a,o,f,v){var S=ts.TEXTURE_2D,O=1,L=hu.SAMPLED;return{dimension:S,format:a,width:o,height:f,depthOrArrayLayers:O,mipLevelCount:v,usage:L}}var Cc;(function(a){a[a.Float=0]="Float",a[a.UnfilterableFloat=1]="UnfilterableFloat",a[a.Uint=2]="Uint",a[a.Sint=3]="Sint",a[a.Depth=4]="Depth"})(Cc||(Cc={}));var Vp;(function(a){a[a.LOWER_LEFT=0]="LOWER_LEFT",a[a.UPPER_LEFT=1]="UPPER_LEFT"})(Vp||(Vp={}));var xg;(function(a){a[a.NEGATIVE_ONE=0]="NEGATIVE_ONE",a[a.ZERO=1]="ZERO"})(xg||(xg={}));var e1;(function(a){a[a.OcclusionConservative=0]="OcclusionConservative"})(e1||(e1={}));var ii;(function(a){a[a.U8=1]="U8",a[a.U16=2]="U16",a[a.U32=3]="U32",a[a.S8=4]="S8",a[a.S16=5]="S16",a[a.S32=6]="S32",a[a.F16=7]="F16",a[a.F32=8]="F32",a[a.BC1=65]="BC1",a[a.BC2=66]="BC2",a[a.BC3=67]="BC3",a[a.BC4_UNORM=68]="BC4_UNORM",a[a.BC4_SNORM=69]="BC4_SNORM",a[a.BC5_UNORM=70]="BC5_UNORM",a[a.BC5_SNORM=71]="BC5_SNORM",a[a.U16_PACKED_5551=97]="U16_PACKED_5551",a[a.U16_PACKED_565=98]="U16_PACKED_565",a[a.D24=129]="D24",a[a.D32F=130]="D32F",a[a.D24S8=131]="D24S8",a[a.D32FS8=132]="D32FS8"})(ii||(ii={}));var Ii;(function(a){a[a.R=1]="R",a[a.RG=2]="RG",a[a.RGB=3]="RGB",a[a.RGBA=4]="RGBA",a[a.A=5]="A"})(Ii||(Ii={}));function mP(a){return a}var po;(function(a){a[a.None=0]="None",a[a.Normalized=1]="Normalized",a[a.sRGB=2]="sRGB",a[a.Depth=4]="Depth",a[a.Stencil=8]="Stencil",a[a.RenderTarget=16]="RenderTarget",a[a.Luminance=32]="Luminance"})(po||(po={}));function qo(a,o,f){return a<<16|o<<8|f}var $n;(function(a){a[a.ALPHA=qo(ii.U8,Ii.A,po.None)]="ALPHA",a[a.U8_LUMINANCE=qo(ii.U8,Ii.A,po.Luminance)]="U8_LUMINANCE",a[a.F16_LUMINANCE=qo(ii.F16,Ii.A,po.Luminance)]="F16_LUMINANCE",a[a.F32_LUMINANCE=qo(ii.F32,Ii.A,po.Luminance)]="F32_LUMINANCE",a[a.F16_R=qo(ii.F16,Ii.R,po.None)]="F16_R",a[a.F16_RG=qo(ii.F16,Ii.RG,po.None)]="F16_RG",a[a.F16_RGB=qo(ii.F16,Ii.RGB,po.None)]="F16_RGB",a[a.F16_RGBA=qo(ii.F16,Ii.RGBA,po.None)]="F16_RGBA",a[a.F32_R=qo(ii.F32,Ii.R,po.None)]="F32_R",a[a.F32_RG=qo(ii.F32,Ii.RG,po.None)]="F32_RG",a[a.F32_RGB=qo(ii.F32,Ii.RGB,po.None)]="F32_RGB",a[a.F32_RGBA=qo(ii.F32,Ii.RGBA,po.None)]="F32_RGBA",a[a.U8_R=qo(ii.U8,Ii.R,po.None)]="U8_R",a[a.U8_R_NORM=qo(ii.U8,Ii.R,po.Normalized)]="U8_R_NORM",a[a.U8_RG=qo(ii.U8,Ii.RG,po.None)]="U8_RG",a[a.U8_RG_NORM=qo(ii.U8,Ii.RG,po.Normalized)]="U8_RG_NORM",a[a.U8_RGB=qo(ii.U8,Ii.RGB,po.None)]="U8_RGB",a[a.U8_RGB_NORM=qo(ii.U8,Ii.RGB,po.Normalized)]="U8_RGB_NORM",a[a.U8_RGB_SRGB=qo(ii.U8,Ii.RGB,po.sRGB|po.Normalized)]="U8_RGB_SRGB",a[a.U8_RGBA=qo(ii.U8,Ii.RGBA,po.None)]="U8_RGBA",a[a.U8_RGBA_NORM=qo(ii.U8,Ii.RGBA,po.Normalized)]="U8_RGBA_NORM",a[a.U8_RGBA_SRGB=qo(ii.U8,Ii.RGBA,po.sRGB|po.Normalized)]="U8_RGBA_SRGB",a[a.U16_R=qo(ii.U16,Ii.R,po.None)]="U16_R",a[a.U16_R_NORM=qo(ii.U16,Ii.R,po.Normalized)]="U16_R_NORM",a[a.U16_RG_NORM=qo(ii.U16,Ii.RG,po.Normalized)]="U16_RG_NORM",a[a.U16_RGBA_NORM=qo(ii.U16,Ii.RGBA,po.Normalized)]="U16_RGBA_NORM",a[a.U16_RGBA=qo(ii.U16,Ii.RGBA,po.None)]="U16_RGBA",a[a.U16_RGB=qo(ii.U16,Ii.RGB,po.None)]="U16_RGB",a[a.U16_RG=qo(ii.U16,Ii.RG,po.None)]="U16_RG",a[a.U32_R=qo(ii.U32,Ii.R,po.None)]="U32_R",a[a.U32_RG=qo(ii.U32,Ii.RG,po.None)]="U32_RG",a[a.U32_RGB=qo(ii.U32,Ii.RGB,po.None)]="U32_RGB",a[a.U32_RGBA=qo(ii.U32,Ii.RGBA,po.None)]="U32_RGBA",a[a.S8_R=qo(ii.S8,Ii.R,po.None)]="S8_R",a[a.S8_R_NORM=qo(ii.S8,Ii.R,po.Normalized)]="S8_R_NORM",a[a.S8_RG_NORM=qo(ii.S8,Ii.RG,po.Normalized)]="S8_RG_NORM",a[a.S8_RGB_NORM=qo(ii.S8,Ii.RGB,po.Normalized)]="S8_RGB_NORM",a[a.S8_RGBA_NORM=qo(ii.S8,Ii.RGBA,po.Normalized)]="S8_RGBA_NORM",a[a.S16_R=qo(ii.S16,Ii.R,po.None)]="S16_R",a[a.S16_RG=qo(ii.S16,Ii.RG,po.None)]="S16_RG",a[a.S16_RG_NORM=qo(ii.S16,Ii.RG,po.Normalized)]="S16_RG_NORM",a[a.S16_RGB_NORM=qo(ii.S16,Ii.RGB,po.Normalized)]="S16_RGB_NORM",a[a.S16_RGBA=qo(ii.S16,Ii.RGBA,po.None)]="S16_RGBA",a[a.S16_RGBA_NORM=qo(ii.S16,Ii.RGBA,po.Normalized)]="S16_RGBA_NORM",a[a.S32_R=qo(ii.S32,Ii.R,po.None)]="S32_R",a[a.S32_RG=qo(ii.S32,Ii.RG,po.None)]="S32_RG",a[a.S32_RGB=qo(ii.S32,Ii.RGB,po.None)]="S32_RGB",a[a.S32_RGBA=qo(ii.S32,Ii.RGBA,po.None)]="S32_RGBA",a[a.U16_RGBA_5551=qo(ii.U16_PACKED_5551,Ii.RGBA,po.Normalized)]="U16_RGBA_5551",a[a.U16_RGB_565=qo(ii.U16_PACKED_565,Ii.RGB,po.Normalized)]="U16_RGB_565",a[a.BC1=qo(ii.BC1,Ii.RGBA,po.Normalized)]="BC1",a[a.BC1_SRGB=qo(ii.BC1,Ii.RGBA,po.Normalized|po.sRGB)]="BC1_SRGB",a[a.BC2=qo(ii.BC2,Ii.RGBA,po.Normalized)]="BC2",a[a.BC2_SRGB=qo(ii.BC2,Ii.RGBA,po.Normalized|po.sRGB)]="BC2_SRGB",a[a.BC3=qo(ii.BC3,Ii.RGBA,po.Normalized)]="BC3",a[a.BC3_SRGB=qo(ii.BC3,Ii.RGBA,po.Normalized|po.sRGB)]="BC3_SRGB",a[a.BC4_UNORM=qo(ii.BC4_UNORM,Ii.R,po.Normalized)]="BC4_UNORM",a[a.BC4_SNORM=qo(ii.BC4_SNORM,Ii.R,po.Normalized)]="BC4_SNORM",a[a.BC5_UNORM=qo(ii.BC5_UNORM,Ii.RG,po.Normalized)]="BC5_UNORM",a[a.BC5_SNORM=qo(ii.BC5_SNORM,Ii.RG,po.Normalized)]="BC5_SNORM",a[a.D24=qo(ii.D24,Ii.R,po.Depth)]="D24",a[a.D24_S8=qo(ii.D24S8,Ii.RG,po.Depth|po.Stencil)]="D24_S8",a[a.D32F=qo(ii.D32F,Ii.R,po.Depth)]="D32F",a[a.D32F_S8=qo(ii.D32FS8,Ii.RG,po.Depth|po.Stencil)]="D32F_S8",a[a.U8_RGB_RT=qo(ii.U8,Ii.RGB,po.RenderTarget|po.Normalized)]="U8_RGB_RT",a[a.U8_RGBA_RT=qo(ii.U8,Ii.RGBA,po.RenderTarget|po.Normalized)]="U8_RGBA_RT",a[a.U8_RGBA_RT_SRGB=qo(ii.U8,Ii.RGBA,po.RenderTarget|po.Normalized|po.sRGB)]="U8_RGBA_RT_SRGB"})($n||($n={}));function n1(a){return a>>>8&255}function fh(a){return a>>>16&255}function Nm(a){return a&255}function Vx(a){switch(a){case ii.F32:case ii.U32:case ii.S32:return 4;case ii.U16:case ii.S16:case ii.F16:return 2;case ii.U8:case ii.S8:return 1;default:throw new Error("whoops")}}function Zx(a){return Vx(fh(a))}function w8(a){return n1(a)}function Hx(a){var o=Vx(fh(a)),f=n1(a);return o*f}function IA(a,o){return a&4294967040|o}function Gx(a,o){return a&4294902015|o<<8}function r1(a){var o=Nm(a);if(o&po.Depth)return Cc.Depth;if(o&po.Normalized)return Cc.Float;var f=fh(a);if(f===ii.F16||f===ii.F32)return Cc.Float;if(f===ii.U8||f===ii.U16||f===ii.U32)return Cc.Uint;if(f===ii.S8||f===ii.S16||f===ii.S32)return Cc.Sint;throw new Error("whoops")}function Ma(a,o){if(o===void 0&&(o=""),!a)throw new Error("Assert fail: ".concat(o))}function Ov(a){if(a!=null)return a;throw new Error("Missing object")}function PE(a,o){return a.r===o.r&&a.g===o.g&&a.b===o.b&&a.a===o.a}function By(a,o){a.r=o.r,a.g=o.g,a.b=o.b,a.a=o.a}function Wx(a){var o=a.r,f=a.g,v=a.b,S=a.a;return{r:o,g:f,b:v,a:S}}function bg(a,o,f,v){return v===void 0&&(v=1),{r:a,g:o,b:f,a:v}}var Fy=bg(0,0,0,0),LA=bg(0,0,0,1),DA=bg(1,1,1,0),vP=bg(1,1,1,1),Eg=!0;function gP(a,o){o===void 0&&(o=Eg),o&&(a[10]=-a[10],a[14]=-a[14])}function NA(a,o){o===void 0&&(o=Eg),o&&(a[10]=-a[10],a[14]=-a[14]+1)}function kA(a,o){if(o===void 0&&(o=Eg),o)switch(a){case Ha.LESS:return Ha.GREATER;case Ha.LEQUAL:return Ha.GEQUAL;case Ha.GEQUAL:return Ha.LEQUAL;case Ha.GREATER:return Ha.LESS;default:return a}else return a}function yP(a,o){return o===void 0&&(o=Eg),o?1-a:a}function _P(a,o){return o===void 0&&(o=Eg),o?-a:a}function xP(a,o,f,v){if(v===void 0&&(v=Eg),f=kA(f,v),f===Ha.LESS)return a<o;if(f===Ha.LEQUAL)return a<=o;if(f===Ha.GREATER)return a>o;if(f===Ha.GEQUAL)return a>=o;throw new Error("whoops")}function Uy(a){return!!(a&&!(a&a-1))}function km(a,o){return a!=null?a:o}function BA(a){return a===void 0?null:a}function bP(a,o,f){a.length=o,a.fill(f)}function Ku(a,o){var f=o-1;return a+f&~f}function EP(a,o){return((a+o-1)/o|0)*o}function FA(a,o,f){for(var v=0,S=a.length;v<S;){var O=v+(S-v>>>1),L=f(o,a[O]);L<0?S=O:v=O+1}return v}function Xx(a,o,f){var v=FA(a,o,f);a.splice(v,0,o)}function IE(a,o,f){return f?a|=o:a&=~o,a}function SP(a,o){for(var f=new Array(a),v=0;v<a;v++)f[v]=o();return f}function UA(a,o){o===void 0&&(o=1);var f=a.split(`
`);return f.map(function(v,S){return"".concat(LE(""+(o+S),4," "),"  ").concat(v)}).join(`
`)}function LE(a,o,f){for(f===void 0&&(f="0");a.length<o;)a="".concat(f).concat(a);return a}function zA(a,o){for(var f=[],v=a;v<a+o;v++)f.push(v);return f}function Yx(a,o){a.blendDstFactor=o.blendDstFactor,a.blendSrcFactor=o.blendSrcFactor,a.blendMode=o.blendMode}function Sg(a,o){return a===void 0&&(a={}),a.compare=o.compare,a.depthFailOp=o.depthFailOp,a.passOp=o.passOp,a.failOp=o.failOp,a.mask=o.mask,a}function DE(a,o){return a===void 0&&(a={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),Yx(a.rgbBlendState,o.rgbBlendState),Yx(a.alphaBlendState,o.alphaBlendState),a.channelWriteMask=o.channelWriteMask,a}function qx(a,o){a.length!==o.length&&(a.length=o.length);for(var f=0;f<o.length;f++)a[f]=DE(a[f],o[f])}function NE(a,o){o.attachmentsState!==void 0&&qx(a.attachmentsState,o.attachmentsState),a.blendConstant&&o.blendConstant&&By(a.blendConstant,o.blendConstant),a.depthCompare=km(o.depthCompare,a.depthCompare),a.depthWrite=km(o.depthWrite,a.depthWrite),a.stencilWrite=km(o.stencilWrite,a.stencilWrite),a.stencilFront&&o.stencilFront&&Sg(a.stencilFront,o.stencilFront),a.stencilBack&&o.stencilBack&&Sg(a.stencilBack,o.stencilBack),a.cullMode=km(o.cullMode,a.cullMode),a.frontFace=km(o.frontFace,a.frontFace),a.polygonOffset=km(o.polygonOffset,a.polygonOffset),a.polygonOffsetFactor=km(o.polygonOffsetFactor,a.polygonOffsetFactor),a.polygonOffsetUnits=km(o.polygonOffsetUnits,a.polygonOffsetUnits)}function Cv(a){var o=Object.assign({},a);return o.attachmentsState=[],qx(o.attachmentsState,a.attachmentsState),o.blendConstant=o.blendConstant&&Wx(o.blendConstant),o.stencilFront=Sg(void 0,a.stencilFront),o.stencilBack=Sg(void 0,a.stencilBack),o}function jf(a,o){o.channelWriteMask!==void 0&&(a.channelWriteMask=o.channelWriteMask),o.rgbBlendMode!==void 0&&(a.rgbBlendState.blendMode=o.rgbBlendMode),o.alphaBlendMode!==void 0&&(a.alphaBlendState.blendMode=o.alphaBlendMode),o.rgbBlendSrcFactor!==void 0&&(a.rgbBlendState.blendSrcFactor=o.rgbBlendSrcFactor),o.alphaBlendSrcFactor!==void 0&&(a.alphaBlendState.blendSrcFactor=o.alphaBlendSrcFactor),o.rgbBlendDstFactor!==void 0&&(a.rgbBlendState.blendDstFactor=o.rgbBlendDstFactor),o.alphaBlendDstFactor!==void 0&&(a.alphaBlendState.blendDstFactor=o.alphaBlendDstFactor)}var i1={blendMode:hf.ADD,blendSrcFactor:os.ONE,blendDstFactor:os.ZERO},b0={attachmentsState:[{channelWriteMask:$u.ALL,rgbBlendState:i1,alphaBlendState:i1}],blendConstant:Wx(Fy),depthWrite:!0,depthCompare:Ha.LEQUAL,stencilWrite:!1,stencilFront:{compare:Ha.ALWAYS,passOp:Oc.KEEP,depthFailOp:Oc.KEEP,failOp:Oc.KEEP},stencilBack:{compare:Ha.ALWAYS,passOp:Oc.KEEP,depthFailOp:Oc.KEEP,failOp:Oc.KEEP},cullMode:ld.NONE,frontFace:ky.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function zy(a,o){a===void 0&&(a=null),o===void 0&&(o=b0);var f=Cv(o);return a!==null&&NE(f,a),f}var o1=zy({depthCompare:Ha.ALWAYS,depthWrite:!1},b0);function TP(a,o){return a.attachmentsState===void 0&&(a.attachmentsState=[],qx(a.attachmentsState,b0.attachmentsState)),jf(a.attachmentsState[0],o),a}var kE={texture:null,sampler:null,formatKind:Cc.Float,dimension:ts.TEXTURE_2D};function Bm(a,o,f){if(a.length!==o.length)return!1;for(var v=0;v<a.length;v++)if(!f(a[v],o[v]))return!1;return!0}function Tg(a,o){for(var f=Array(a.length),v=0;v<a.length;v++)f[v]=o(a[v]);return f}function BE(a,o){return a.texture===o.texture&&a.binding===o.binding}function $x(a,o){return a.buffer===o.buffer&&a.size===o.size&&a.binding===o.binding&&a.offset===o.offset}function wP(a,o){return a===null?o===null:o===null?!1:a.sampler===o.sampler&&a.texture===o.texture&&a.dimension===o.dimension&&a.formatKind===o.formatKind&&a.comparison===o.comparison}function jA(a,o){return a.samplerBindings=a.samplerBindings||[],a.uniformBufferBindings=a.uniformBufferBindings||[],a.storageBufferBindings=a.storageBufferBindings||[],a.storageTextureBindings=a.storageTextureBindings||[],o.samplerBindings=o.samplerBindings||[],o.uniformBufferBindings=o.uniformBufferBindings||[],o.storageBufferBindings=o.storageBufferBindings||[],o.storageTextureBindings=o.storageTextureBindings||[],!(a.samplerBindings.length!==o.samplerBindings.length||!Bm(a.samplerBindings,o.samplerBindings,wP)||!Bm(a.uniformBufferBindings,o.uniformBufferBindings,$x)||!Bm(a.storageBufferBindings,o.storageBufferBindings,$x)||!Bm(a.storageTextureBindings,o.storageTextureBindings,BE))}function FE(a,o){return a.blendMode==o.blendMode&&a.blendSrcFactor===o.blendSrcFactor&&a.blendDstFactor===o.blendDstFactor}function a1(a,o){return!(!FE(a.rgbBlendState,o.rgbBlendState)||!FE(a.alphaBlendState,o.alphaBlendState)||a.channelWriteMask!==o.channelWriteMask)}function wg(a,o){return a.compare==o.compare&&a.depthFailOp===o.depthFailOp&&a.failOp===o.failOp&&a.passOp===o.passOp&&a.mask===o.mask}function VA(a,o){return!Bm(a.attachmentsState,o.attachmentsState,a1)||a.blendConstant&&o.blendConstant&&!PE(a.blendConstant,o.blendConstant)||a.stencilFront&&o.stencilFront&&!wg(a.stencilFront,o.stencilFront)||a.stencilBack&&o.stencilBack&&!wg(a.stencilBack,o.stencilBack)?!1:a.depthCompare===o.depthCompare&&a.depthWrite===o.depthWrite&&a.stencilWrite===o.stencilWrite&&a.cullMode===o.cullMode&&a.frontFace===o.frontFace&&a.polygonOffset===o.polygonOffset&&a.polygonOffsetFactor===o.polygonOffsetFactor&&a.polygonOffsetUnits===o.polygonOffsetUnits}function ZA(a,o){return a.id===o.id}function UE(a,o){return a===o}function AP(a,o){return!(a.topology!==o.topology||a.inputLayout!==o.inputLayout||a.sampleCount!==o.sampleCount||a.megaStateDescriptor&&o.megaStateDescriptor&&!VA(a.megaStateDescriptor,o.megaStateDescriptor)||!ZA(a.program,o.program)||!Bm(a.colorAttachmentFormats,o.colorAttachmentFormats,UE)||a.depthStencilAttachmentFormat!==o.depthStencilAttachmentFormat)}function HA(a,o){return a.offset===o.offset&&a.shaderLocation===o.shaderLocation&&a.format===o.format&&a.divisor===o.divisor}function OP(a,o){return(0,Of.Z)(a)?(0,Of.Z)(o):(0,Of.Z)(o)?!1:a.arrayStride===o.arrayStride&&a.stepMode===o.stepMode&&Bm(a.attributes,o.attributes,HA)}function GA(a,o){return!(a.indexBufferFormat!==o.indexBufferFormat||!Bm(a.vertexBufferDescriptors,o.vertexBufferDescriptors,OP)||!ZA(a.program,o.program))}function CP(a,o){return a.addressModeU===o.addressModeU&&a.addressModeV===o.addressModeV&&a.minFilter===o.minFilter&&a.magFilter===o.magFilter&&a.mipmapFilter===o.mipmapFilter&&a.lodMinClamp===o.lodMinClamp&&a.lodMaxClamp===o.lodMaxClamp&&a.maxAnisotropy===o.maxAnisotropy&&a.compareFunction===o.compareFunction}function WA(a){var o=a.sampler,f=a.texture,v=a.dimension,S=a.formatKind,O=a.comparison;return{sampler:o,texture:f,dimension:v,formatKind:S,comparison:O}}function zE(a){var o=a.buffer,f=a.size,v=a.binding,S=a.offset;return{binding:v,buffer:o,offset:S,size:f}}function XA(a){var o=a.binding,f=a.texture;return{binding:o,texture:f}}function YA(a){var o=a.samplerBindings&&Tg(a.samplerBindings,WA),f=a.uniformBufferBindings&&Tg(a.uniformBufferBindings,zE),v=a.storageBufferBindings&&Tg(a.storageBufferBindings,zE),S=a.storageTextureBindings&&Tg(a.storageTextureBindings,XA);return{samplerBindings:o,uniformBufferBindings:f,storageBufferBindings:v,storageTextureBindings:S,pipeline:a.pipeline}}function qA(a){var o=a.inputLayout,f=a.program,v=a.topology,S=a.megaStateDescriptor&&Cv(a.megaStateDescriptor),O=a.colorAttachmentFormats.slice(),L=a.depthStencilAttachmentFormat,k=a.sampleCount;return{inputLayout:o,megaStateDescriptor:S,program:f,topology:v,colorAttachmentFormats:O,depthStencilAttachmentFormat:L,sampleCount:k}}function $A(a){var o=a.shaderLocation,f=a.format,v=a.offset,S=a.divisor;return{shaderLocation:o,format:f,offset:v,divisor:S}}function KA(a){if((0,Of.Z)(a))return a;var o=a.arrayStride,f=a.stepMode,v=Tg(a.attributes,$A);return{arrayStride:o,stepMode:f,attributes:v}}function QA(a){var o=Tg(a.vertexBufferDescriptors,KA),f=a.indexBufferFormat,v=a.program;return{vertexBufferDescriptors:o,indexBufferFormat:f,program:v}}var xs,jE=/([^[]*)(\[[0-9]+\])?/;function Kx(a){if(a[a.length-1]!=="]")return{name:a,length:1,isArray:!1};var o=a.match(jE);if(!o||o.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(a));return{name:o[1],length:Number(o[2])||1,isArray:!!o[2]}}function Lh(){var a=null;return function(o,f,v){var S=a!==v;return S&&(o.uniform1i(f,v),a=v),S}}function Rc(a,o,f,v){var S=null,O=null;return function(L,k,V){var Q=o(V,f),st=Q.length,ft=!1;if(S===null)S=new Float32Array(st),O=st,ft=!0;else{Ma(O===st,"Uniform length cannot change.");for(var Tt=0;Tt<st;++Tt)if(Q[Tt]!==S[Tt]){ft=!0;break}}return ft&&(v(L,a,k,Q),S.set(Q)),ft}}function Vf(a,o,f,v){a[o](f,v)}function $0(a,o,f,v){a[o](f,!1,v)}var VE={},JA={},ZE={},Qx=[0];function s1(a,o,f,v){o===1&&typeof a=="boolean"&&(a=a?1:0),Number.isFinite(a)&&(Qx[0]=a,a=Qx);var S=a.length;if(a instanceof f)return a;var O=v[S];O||(O=new f(S),v[S]=O);for(var L=0;L<S;L++)O[L]=a[L];return O}function Rd(a,o){return s1(a,o,Float32Array,VE)}function K0(a,o){return s1(a,o,Int32Array,JA)}function l1(a,o){return s1(a,o,Uint32Array,ZE)}var t3=(xs={},xs[pn.FLOAT]=Rc.bind(null,"uniform1fv",Rd,1,Vf),xs[pn.FLOAT_VEC2]=Rc.bind(null,"uniform2fv",Rd,2,Vf),xs[pn.FLOAT_VEC3]=Rc.bind(null,"uniform3fv",Rd,3,Vf),xs[pn.FLOAT_VEC4]=Rc.bind(null,"uniform4fv",Rd,4,Vf),xs[pn.INT]=Rc.bind(null,"uniform1iv",K0,1,Vf),xs[pn.INT_VEC2]=Rc.bind(null,"uniform2iv",K0,2,Vf),xs[pn.INT_VEC3]=Rc.bind(null,"uniform3iv",K0,3,Vf),xs[pn.INT_VEC4]=Rc.bind(null,"uniform4iv",K0,4,Vf),xs[pn.BOOL]=Rc.bind(null,"uniform1iv",K0,1,Vf),xs[pn.BOOL_VEC2]=Rc.bind(null,"uniform2iv",K0,2,Vf),xs[pn.BOOL_VEC3]=Rc.bind(null,"uniform3iv",K0,3,Vf),xs[pn.BOOL_VEC4]=Rc.bind(null,"uniform4iv",K0,4,Vf),xs[pn.FLOAT_MAT2]=Rc.bind(null,"uniformMatrix2fv",Rd,4,$0),xs[pn.FLOAT_MAT3]=Rc.bind(null,"uniformMatrix3fv",Rd,9,$0),xs[pn.FLOAT_MAT4]=Rc.bind(null,"uniformMatrix4fv",Rd,16,$0),xs[pn.UNSIGNED_INT]=Rc.bind(null,"uniform1uiv",l1,1,Vf),xs[pn.UNSIGNED_INT_VEC2]=Rc.bind(null,"uniform2uiv",l1,2,Vf),xs[pn.UNSIGNED_INT_VEC3]=Rc.bind(null,"uniform3uiv",l1,3,Vf),xs[pn.UNSIGNED_INT_VEC4]=Rc.bind(null,"uniform4uiv",l1,4,Vf),xs[pn.FLOAT_MAT2x3]=Rc.bind(null,"uniformMatrix2x3fv",Rd,6,$0),xs[pn.FLOAT_MAT2x4]=Rc.bind(null,"uniformMatrix2x4fv",Rd,8,$0),xs[pn.FLOAT_MAT3x2]=Rc.bind(null,"uniformMatrix3x2fv",Rd,6,$0),xs[pn.FLOAT_MAT3x4]=Rc.bind(null,"uniformMatrix3x4fv",Rd,12,$0),xs[pn.FLOAT_MAT4x2]=Rc.bind(null,"uniformMatrix4x2fv",Rd,8,$0),xs[pn.FLOAT_MAT4x3]=Rc.bind(null,"uniformMatrix4x3fv",Rd,12,$0),xs[pn.SAMPLER_2D]=Lh,xs[pn.SAMPLER_CUBE]=Lh,xs[pn.SAMPLER_3D]=Lh,xs[pn.SAMPLER_2D_SHADOW]=Lh,xs[pn.SAMPLER_2D_ARRAY]=Lh,xs[pn.SAMPLER_2D_ARRAY_SHADOW]=Lh,xs[pn.SAMPLER_CUBE_SHADOW]=Lh,xs[pn.INT_SAMPLER_2D]=Lh,xs[pn.INT_SAMPLER_3D]=Lh,xs[pn.INT_SAMPLER_CUBE]=Lh,xs[pn.INT_SAMPLER_2D_ARRAY]=Lh,xs[pn.UNSIGNED_INT_SAMPLER_2D]=Lh,xs[pn.UNSIGNED_INT_SAMPLER_3D]=Lh,xs[pn.UNSIGNED_INT_SAMPLER_CUBE]=Lh,xs[pn.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Lh,xs);function HE(a,o,f){var v=t3[f.type];if(!v)throw new Error("Unknown GLSL uniform type ".concat(f.type));return v().bind(null,a,o)}var e3={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function GE(a){return Object.prototype.toString.call(a)in e3}function jy(a,o){return"#define ".concat(a," ").concat(o)}function yc(a){var o={};return a.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(f,v,S){var O=Number(S);return o[v]=isNaN(O)?S:O,""}),o}function RP(a,o){var f=[];return a.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(v,S,O){var L=Number(S);return f.push({location:isNaN(L)?o[S]:L,name:O}),""}),f}function n3(a){var o=[],f=[];return a.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(v,S,O){var L=[];return O.trim().replace(`\r
`,`
`).split(`
`).forEach(function(k){var V=__read(k.trim().split(/\s+/),2),Q=V[0],st=V[1];L.push({type:Q.trim(),name:st.replace(";","").trim()})}),f.push({type:S.trim(),uniforms:L}),""}),a.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(v,S){return S.trim().replace(`\r
`,`
`).split(`
`).forEach(function(O){var L=O.trim().split(" "),k=L[0]||"",V=L[1]||"",Q=V.indexOf("[")>-1;if(V=V.replace(";","").replace("[","").trim(),!k.startsWith("#")){if(k){var st=f.find(function(se){return k===se.type});if(st)if(Q)for(var ft=function(se){st.uniforms.forEach(function(Ve){o.push("".concat(V,"[").concat(se,"].").concat(Ve.name))})},Tt=0;Tt<5;Tt++)ft(Tt);else st.uniforms.forEach(function(se){o.push("".concat(V,".").concat(se.name))})}V&&o.push(V)}}),""}),o}function Vy(a){if(a===void 0)return null;var o=/binding\s*=\s*(\d+)/.exec(a);if(o!==null){var f=parseInt(o[1],10);if(!Number.isNaN(f))return f}return null}function WE(a){var o="",f=a;return[f,o]}function Fm(a,o,f,v,S){var O;v===void 0&&(v=null),S===void 0&&(S=!0);var L=a.glslVersion==="#version 100",k=o==="frag"&&((O=f.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||O===void 0?void 0:O.length)>1,V=f.replace(`\r
`,`
`).split(`
`).map(function(Ji){return Ji.replace(/[/][/].*$/,"")}).filter(function(Ji){var Vr=!Ji||/^\s+$/.test(Ji);return!Vr}),Q="";v!==null&&(Q=Object.keys(v).map(function(Ji){return jy(Ji,v[Ji])}).join(`
`));var st=V.find(function(Ji){return Ji.startsWith("precision")})||"precision mediump float;",ft=S?V.filter(function(Ji){return!Ji.startsWith("precision")}).join(`
`):V.join(`
`),Tt="";if(a.viewportOrigin===Vp.UPPER_LEFT&&(Tt+="".concat(jy("VIEWPORT_ORIGIN_TL","1"),`
`)),a.clipSpaceNearZ===xg.ZERO&&(Tt+="".concat(jy("CLIPSPACE_NEAR_ZERO","1"),`
`)),a.explicitBindingLocations){var se=0,Ve=0,yn=0;ft=ft.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(Ji,Vr,Hi,za){var ps=Hi?"".concat(Hi,", "):"";return"layout(".concat(ps,"set = ").concat(se,", binding = ").concat(Ve++,") uniform ").concat(za)}),se++,Ve=0,Ma(a.separateSamplerTextures),ft=ft.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ji,Vr,Hi,za,ps){var Wo=Vy(Hi);Wo===null&&(Wo=Ve++);var as=(0,go.CR)(WE(za),2),Zs=as[0],Dh=as[1];return o==="frag"?`
layout(set = `.concat(se,", binding = ").concat(Wo*2+0,") uniform texture").concat(Zs," T_").concat(ps,`;
layout(set = `).concat(se,", binding = ").concat(Wo*2+1,") uniform sampler").concat(Dh," S_").concat(ps,";").trim():""}),ft=ft.replace(o==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(Ji,Vr){return"layout(location = ".concat(yn++,") ").concat(Vr)}),Tt+="".concat(jy("gl_VertexID","gl_VertexIndex"),`
`),Tt+="".concat(jy("gl_InstanceID","gl_InstanceIndex"),`
`),st=st.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var lr=0;ft=ft.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ji,Vr,Hi,za,ps){var Wo=Vy(Hi);return Wo===null&&(Wo=lr++),"uniform sampler".concat(za," ").concat(ps,"; // BINDING=").concat(Wo)})}if(ft=ft.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return"SAMPLER_".concat(Vr,"(P_").concat(Hi,")")}),ft=ft.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return"PP_SAMPLER_".concat(Vr,"(P_").concat(Hi,")")}),ft=ft.replace(/\bPU_TEXTURE\((.*?)\)/g,function(Ji,Vr){return"TEXTURE(P_".concat(Vr,")")}),a.separateSamplerTextures)ft=ft.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){var za=(0,go.CR)(WE(Vr),2),ps=za[0],Wo=za[1];return"texture".concat(ps," T_P_").concat(Hi,", sampler").concat(Wo," S_P_").concat(Hi)}),ft=ft.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return"T_".concat(Hi,", S_").concat(Hi)}),ft=ft.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return"sampler".concat(Vr,"(T_").concat(Hi,", S_").concat(Hi,")")}),ft=ft.replace(/\bTEXTURE\((.*?)\)/g,function(Ji,Vr){return"T_".concat(Vr)});else{var Nr=[];ft=ft.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return"sampler".concat(Vr," P_").concat(Hi)}),ft=ft.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return Hi}),ft=ft.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ji,Vr,Hi){return Nr.push([Hi,Vr]),Hi}),L&&Nr.forEach(function(Ji){var Vr=(0,go.CR)(Ji,2),Hi=Vr[0],za=Vr[1];ft=ft.replace(new RegExp("texture\\(".concat(Hi),"g"),function(){return"texture".concat(za,"(").concat(Hi)})}),ft=ft.replace(/\bTEXTURE\((.*?)\)/g,function(Ji,Vr){return Vr})}var Ln="".concat(L?"":a.glslVersion,`
`).concat(L&&k?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(L&&o==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(S?st:"",`
`).concat(Tt||"").concat(Q?Q+`
`:"",`
`).concat(ft,`
`).trim();if(a.explicitBindingLocations&&o==="frag"&&(Ln=Ln.replace(/^\b(out)\b/g,function(Ji,Vr){return"layout(location = 0) ".concat(Vr)})),L){if(o==="frag"&&(Ln=Ln.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(Ji,Vr,Hi){return"varying ".concat(Vr," ").concat(Hi,`;
`)})),o==="vert"&&(Ln=Ln.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ji,Vr,Hi){return"varying ".concat(Vr," ").concat(Hi,`;
`)}),Ln=Ln.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(Ji,Vr,Hi){return"attribute ".concat(Vr," ").concat(Hi,`;
`)})),Ln=Ln.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(Ji,Vr){return Vr.trim().replace(/^.*$/gm,function(Hi){var za=Hi.trim();return za.startsWith("#")?za:Hi?"uniform ".concat(za):""})}),o==="frag")if(k){var ci=[];Ln=Ln.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(Ji,Vr){return ci.push(Vr),"vec4 ".concat(Vr,`;
`)});var Fi=Ln.lastIndexOf("}");Ln=Ln.substring(0,Fi)+`
    `.concat(ci.map(function(Ji,Vr){return"gl_FragData[".concat(Vr,"] = ").concat(Ji,`;
    `)}).join(`
`))+Ln.substring(Fi)}else{var So;if(Ln=Ln.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ji,Vr,Hi){return So=Hi,"".concat(Vr," ").concat(Hi,`;
`)}),So){var Fi=Ln.lastIndexOf("}");Ln=Ln.substring(0,Fi)+`
  gl_FragColor = vec4(`.concat(So,`);
`)+Ln.substring(Fi)}}Ln=Ln.replace(/^\s*layout\((.*)\)/gm,"")}return Ln}function MP(a,o,f,v){v===void 0&&(v=null);var S=Fm(a,"vert",o,v),O=Fm(a,"frag",f,v);return{vert:o,frag:f,preprocessedVert:S,preprocessedFrag:O}}var Md=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=a.call(this)||this;return O.id=v,O.device=S,O.device.resourceCreationTracker!==null&&O.device.resourceCreationTracker.trackResourceCreated(O),O}return o.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},o}(CE),r3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.Bindings;var k=O.uniformBufferBindings,V=O.samplerBindings;return L.uniformBufferBindings=k||[],L.samplerBindings=V||[],L.bindingLayouts=L.createBindingLayouts(),L}return o.prototype.createBindingLayouts=function(){var f=0,v=0,S=[],O=this.uniformBufferBindings.length,L=this.samplerBindings.length;return S.push({firstUniformBuffer:f,numUniformBuffers:O,firstSampler:v,numSamplers:L}),f+=O,v+=L,{numUniformBuffers:f,numSamplers:v,bindingLayoutTables:S}},o}(Md);function zo(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}function Jx(a){var o=fh(a);switch(o){case ii.BC1:case ii.BC2:case ii.BC3:case ii.BC4_UNORM:case ii.BC4_SNORM:case ii.BC5_UNORM:case ii.BC5_SNORM:return!0;default:return!1}}function XE(a){var o=Nm(a);if(o&po.Normalized)return!1;var f=fh(a);return f===ii.S8||f===ii.S16||f===ii.S32||f===ii.U8||f===ii.U16||f===ii.U32}function YE(a){switch(a){case cd.STATIC:return pn.STATIC_DRAW;case cd.DYNAMIC:return pn.DYNAMIC_DRAW}}function c1(a){if(a&_s.INDEX)return pn.ELEMENT_ARRAY_BUFFER;if(a&_s.VERTEX)return pn.ARRAY_BUFFER;if(a&_s.UNIFORM)return pn.UNIFORM_BUFFER}function Rv(a){switch(a){case Pl.TRIANGLES:return pn.TRIANGLES;case Pl.POINTS:return pn.POINTS;case Pl.TRIANGLE_STRIP:return pn.TRIANGLE_STRIP;case Pl.LINES:return pn.LINES;case Pl.LINE_STRIP:return pn.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function Zy(a){switch(a){case ii.U8:return pn.UNSIGNED_BYTE;case ii.U16:return pn.UNSIGNED_SHORT;case ii.U32:return pn.UNSIGNED_INT;case ii.S8:return pn.BYTE;case ii.S16:return pn.SHORT;case ii.S32:return pn.INT;case ii.F16:return pn.HALF_FLOAT;case ii.F32:return pn.FLOAT;default:throw new Error("whoops")}}function u1(a){switch(a){case Ii.R:return 1;case Ii.RG:return 2;case Ii.RGB:return 3;case Ii.RGBA:return 4;default:return 1}}function Ag(a){var o=fh(a),f=n1(a),v=Nm(a),S=Zy(o),O=u1(f),L=!!(v&po.Normalized);return{size:O,type:S,normalized:L}}function tb(a){switch(a){case $n.U8_R:return pn.UNSIGNED_BYTE;case $n.U16_R:return pn.UNSIGNED_SHORT;case $n.U32_R:return pn.UNSIGNED_INT;default:throw new Error("whoops")}}function Hy(a){switch(a){case Cf.CLAMP_TO_EDGE:return pn.CLAMP_TO_EDGE;case Cf.REPEAT:return pn.REPEAT;case Cf.MIRRORED_REPEAT:return pn.MIRRORED_REPEAT;default:throw new Error("whoops")}}function f1(a,o){if(o===Zl.LINEAR&&a===ia.BILINEAR)return pn.LINEAR_MIPMAP_LINEAR;if(o===Zl.LINEAR&&a===ia.POINT)return pn.NEAREST_MIPMAP_LINEAR;if(o===Zl.NEAREST&&a===ia.BILINEAR)return pn.LINEAR_MIPMAP_NEAREST;if(o===Zl.NEAREST&&a===ia.POINT)return pn.NEAREST_MIPMAP_NEAREST;if(o===Zl.NO_MIP&&a===ia.BILINEAR)return pn.LINEAR;if(o===Zl.NO_MIP&&a===ia.POINT)return pn.NEAREST;throw new Error("Unknown texture filter mode")}function Um(a,o){o===void 0&&(o=0);var f=a;return f.gl_buffer_pages[o/f.pageByteSize|0]}function Og(a){var o=a;return o.gl_texture}function h1(a){var o=a;return o.gl_sampler}function E0(a,o){a.name=o,a.__SPECTOR_Metadata={name:o}}function qE(a,o){for(var f=[];;){var v=o.exec(a);if(!v)break;f.push(v)}return f}function up(a){return a.blendMode==hf.ADD&&a.blendSrcFactor==os.ONE&&a.blendDstFactor===os.ZERO}function i3(a){switch(a){case e1.OcclusionConservative:return pn.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function o3(a){if(a===ts.TEXTURE_2D)return pn.TEXTURE_2D;if(a===ts.TEXTURE_2D_ARRAY)return pn.TEXTURE_2D_ARRAY;if(a===ts.TEXTURE_CUBE_MAP)return pn.TEXTURE_CUBE_MAP;if(a===ts.TEXTURE_3D)return pn.TEXTURE_3D;throw new Error("whoops")}function eb(a,o,f,v){return!(a%f!==0||o%v!==0)}var d1=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.Buffer;var k=O.viewOrSize,V=O.usage,Q=O.hint,st=Q===void 0?cd.STATIC:Q,ft=S.uniformBufferMaxPageByteSize,Tt=S.gl,se=V&_s.UNIFORM;se||(zo(Tt)?Tt.bindVertexArray(null):S.OES_vertex_array_object.bindVertexArrayOES(null));var Ve=(0,cp.Z)(k)?Ku(k,4):Ku(k.byteLength,4);L.gl_buffer_pages=[];var yn;if(se){for(var lr=Ve;lr>0;)L.gl_buffer_pages.push(L.createBufferPage(Math.min(lr,ft),V,st)),lr-=ft;yn=ft}else L.gl_buffer_pages.push(L.createBufferPage(Ve,V,st)),yn=Ve;return L.pageByteSize=yn,L.byteSize=Ve,L.usage=V,L.gl_target=c1(V),(0,cp.Z)(k)||L.setSubData(0,new Uint8Array(k.buffer)),se||(zo(Tt)?Tt.bindVertexArray(L.device.currentBoundVAO):S.OES_vertex_array_object.bindVertexArrayOES(L.device.currentBoundVAO)),L}return o.prototype.setSubData=function(f,v,S,O){S===void 0&&(S=0),O===void 0&&(O=v.byteLength-S);for(var L=this.device.gl,k=this.pageByteSize,V=f+O,Q=f,st=f%k;Q<V;){var ft=zo(L)?L.COPY_WRITE_BUFFER:this.gl_target,Tt=Um(this,Q);if(Tt.ubo)return;L.bindBuffer(ft,Tt),zo(L)?L.bufferSubData(ft,st,v,S,Math.min(V-Q,k)):L.bufferSubData(ft,st,v),Q+=k,st=0,S+=k,this.device.debugGroupStatisticsBufferUpload()}},o.prototype.destroy=function(){a.prototype.destroy.call(this);for(var f=0;f<this.gl_buffer_pages.length;f++)this.gl_buffer_pages[f].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[f]);this.gl_buffer_pages=[]},o.prototype.createBufferPage=function(f,v,S){var O=this.device.gl,L=v&_s.UNIFORM;if(!zo(O)&&L)return{ubo:!0};var k=this.device.ensureResourceExists(O.createBuffer()),V=c1(v),Q=YE(S);return O.bindBuffer(V,k),O.bufferData(V,f,Q),k},o}(Md),nb=function(a){(0,go.ZT)(o,a);function o(f){var v,S,O,L,k=f.id,V=f.device,Q=f.descriptor,st,ft=a.call(this,{id:k,device:V})||this;ft.type=Ls.InputLayout;var Tt=Q.vertexBufferDescriptors,se=Q.indexBufferFormat,Ve=Q.program;Ma(se===$n.U16_R||se===$n.U32_R||se===null);var yn=se!==null?tb(se):null,lr=se!==null?Zx(se):null,Nr=ft.device.gl,Ln=ft.device.ensureResourceExists(zo(Nr)?Nr.createVertexArray():V.OES_vertex_array_object.createVertexArrayOES());zo(Nr)?Nr.bindVertexArray(Ln):V.OES_vertex_array_object.bindVertexArrayOES(Ln),Nr.bindBuffer(Nr.ARRAY_BUFFER,Um(ft.device.fallbackVertexBuffer));try{for(var ci=(0,go.XA)(Q.vertexBufferDescriptors),Fi=ci.next();!Fi.done;Fi=ci.next()){var So=Fi.value,Ji=So.stepMode,Vr=So.attributes;try{for(var Hi=(O=void 0,(0,go.XA)(Vr)),za=Hi.next();!za.done;za=Hi.next()){var ps=za.value,Wo=ps.shaderLocation,as=ps.format,Zs=ps.divisor,Dh=Zs===void 0?1:Zs,Id=zo(Nr)?Wo:(st=Ve.attributes[Wo])===null||st===void 0?void 0:st.location,Nh=Ag(as);if(ps.vertexFormat=Nh,!(0,Of.Z)(Id)){XE(as);var ll=Nh.size,J0=Nh.type,Gf=Nh.normalized;Nr.vertexAttribPointer(Id,ll,J0,Gf,0,0),Ji===Av.INSTANCE&&(zo(Nr)?Nr.vertexAttribDivisor(Id,Dh):V.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(Id,Dh)),Nr.enableVertexAttribArray(Id)}}}catch(Lv){O={error:Lv}}finally{try{za&&!za.done&&(L=Hi.return)&&L.call(Hi)}finally{if(O)throw O.error}}}}catch(Lv){v={error:Lv}}finally{try{Fi&&!Fi.done&&(S=ci.return)&&S.call(ci)}finally{if(v)throw v.error}}return zo(Nr)?Nr.bindVertexArray(null):V.OES_vertex_array_object.bindVertexArrayOES(null),ft.vertexBufferDescriptors=Tt,ft.vao=Ln,ft.indexBufferFormat=se,ft.indexBufferType=yn,ft.indexBufferCompByteSize=lr,ft.program=Ve,ft}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(zo(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},o}(Md),Gy=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=f.fake,k=a.call(this,{id:v,device:S})||this;k.type=Ls.Texture,O=(0,go.pi)({dimension:ts.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},O);var V=k.device.gl,Q,st,ft=k.clampmipLevelCount(O);if(k.immutable=O.usage===hu.RENDER_TARGET,k.pixelStore=O.pixelStore,k.format=O.format,k.dimension=O.dimension,k.formatKind=r1(O.format),k.width=O.width,k.height=O.height,k.depthOrArrayLayers=O.depthOrArrayLayers,k.mipmaps=ft>=1,!L){st=k.device.ensureResourceExists(V.createTexture());var Tt=k.device.translateTextureType(O.format),se=k.device.translateTextureInternalFormat(O.format);if(k.device.setActiveTexture(V.TEXTURE0),k.device.currentTextures[0]=null,k.preprocessImage(),O.dimension===ts.TEXTURE_2D){if(Q=pn.TEXTURE_2D,V.bindTexture(Q,st),k.immutable)if(zo(V))V.texStorage2D(Q,ft,se,O.width,O.height);else{var Ve=(se===pn.DEPTH_COMPONENT||k.isNPOT(),0);(k.format===$n.D32F||k.format===$n.D24_S8)&&!zo(V)&&!S.WEBGL_depth_texture||(V.texImage2D(Q,Ve,se,O.width,O.height,0,se,Tt,null),k.mipmaps&&(k.mipmaps=!1,V.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_MIN_FILTER,pn.LINEAR),V.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_WRAP_S,pn.CLAMP_TO_EDGE),V.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_WRAP_T,pn.CLAMP_TO_EDGE)))}Ma(O.depthOrArrayLayers===1)}else if(O.dimension===ts.TEXTURE_2D_ARRAY)Q=pn.TEXTURE_2D_ARRAY,V.bindTexture(Q,st),k.immutable&&zo(V)&&V.texStorage3D(Q,ft,se,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===ts.TEXTURE_3D)Q=pn.TEXTURE_3D,V.bindTexture(Q,st),k.immutable&&zo(V)&&V.texStorage3D(Q,ft,se,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===ts.TEXTURE_CUBE_MAP)Q=pn.TEXTURE_CUBE_MAP,V.bindTexture(Q,st),k.immutable&&zo(V)&&V.texStorage2D(Q,ft,se,O.width,O.height),Ma(O.depthOrArrayLayers===6);else throw new Error("whoops")}return k.gl_texture=st,k.gl_target=Q,k.mipLevelCount=ft,k}return o.prototype.setImageData=function(f,v){v===void 0&&(v=0);var S=this.device.gl;Jx(this.format);var O=this.gl_target===pn.TEXTURE_3D||this.gl_target===pn.TEXTURE_2D_ARRAY,L=this.gl_target===pn.TEXTURE_CUBE_MAP,k=GE(f[0]);this.device.setActiveTexture(S.TEXTURE0),this.device.currentTextures[0]=null;var V=f[0],Q,st;k?(Q=this.width,st=this.height):(Q=V.width,st=V.height,this.width=Q,this.height=st),S.bindTexture(this.gl_target,this.gl_texture);var ft=this.device.translateTextureFormat(this.format),Tt=zo(S)?this.device.translateInternalTextureFormat(this.format):ft,se=this.device.translateTextureType(this.format);this.preprocessImage();for(var Ve=0;Ve<this.depthOrArrayLayers;Ve++){var yn=f[Ve],lr=this.gl_target;L&&(lr=pn.TEXTURE_CUBE_MAP_POSITIVE_X+Ve%6),this.immutable?S.texSubImage2D(lr,v,0,0,Q,st,ft,se,yn):zo(S)?O?S.texImage3D(lr,v,Tt,Q,st,this.depthOrArrayLayers,0,ft,se,yn):S.texImage2D(lr,v,Tt,Q,st,0,ft,se,yn):k?S.texImage2D(lr,v,ft,Q,st,0,ft,se,yn):S.texImage2D(lr,v,ft,ft,se,yn)}this.mipmaps&&this.generateMipmap(O)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteTexture(Og(this))},o.prototype.clampmipLevelCount=function(f){if(f.dimension===ts.TEXTURE_2D_ARRAY&&f.depthOrArrayLayers>1){var v=fh(f.format);if(v===ii.BC1)for(var S=f.width,O=f.height,L=0;L<f.mipLevelCount;L++){if(S<=2||O<=2)return L-1;S=Math.max(S/2|0,1),O=Math.max(O/2|0,1)}}return f.mipLevelCount},o.prototype.preprocessImage=function(){var f=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&f.pixelStorei(pn.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&f.pixelStorei(pn.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&f.pixelStorei(pn.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},o.prototype.generateMipmap=function(f){f===void 0&&(f=!1);var v=this.device.gl;return!zo(v)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(v.bindTexture(this.gl_target,this.gl_texture),f?(v.texParameteri(this.gl_target,pn.TEXTURE_BASE_LEVEL,0),v.texParameteri(this.gl_target,pn.TEXTURE_MAX_LEVEL,Math.log2(this.width)),v.texParameteri(this.gl_target,pn.TEXTURE_MIN_FILTER,pn.LINEAR_MIPMAP_LINEAR),v.texParameteri(this.gl_target,pn.TEXTURE_MAG_FILTER,pn.LINEAR)):v.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_MIN_FILTER,pn.NEAREST_MIPMAP_LINEAR),v.generateMipmap(this.gl_target),v.bindTexture(this.gl_target,null)),this)},o.prototype.isNPOT=function(){var f=this.device.gl;return zo(f)?!1:!Uy(this.width)||!Uy(this.height)},o}(Md),rb=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.RenderTarget,L.gl_renderbuffer=null,L.texture=null;var k=L.device.gl,V=O.format,Q=O.width,st=O.height,ft=O.sampleCount,Tt=ft===void 0?1:ft,se=O.texture,Ve=!1;if((V===$n.D32F||V===$n.D24_S8)&&se&&!zo(k)&&!S.WEBGL_depth_texture&&(se.destroy(),L.texture=null,Ve=!0),!Ve&&se)L.texture=se;else{L.gl_renderbuffer=L.device.ensureResourceExists(k.createRenderbuffer()),k.bindRenderbuffer(k.RENDERBUFFER,L.gl_renderbuffer);var yn=L.device.translateTextureInternalFormat(V,!0);zo(k)&&Tt>1?k.renderbufferStorageMultisample(pn.RENDERBUFFER,Tt,yn,Q,st):k.renderbufferStorage(pn.RENDERBUFFER,yn,Q,st)}return L.format=V,L.width=Q,L.height=st,L.sampleCount=Tt,L}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},o}(Md),Zf;(function(a){a[a.NeedsCompile=0]="NeedsCompile",a[a.Compiling=1]="Compiling",a[a.NeedsBind=2]="NeedsBind",a[a.ReadyToUse=3]="ReadyToUse"})(Zf||(Zf={}));var $E=function(a){(0,go.ZT)(o,a);function o(f,v){var S=f.id,O=f.device,L=f.descriptor,k=a.call(this,{id:S,device:O})||this;k.rawVertexGLSL=v,k.type=Ls.Program,k.uniformSetters={},k.attributes=[];var V=k.device.gl;return k.descriptor=L,k.gl_program=k.device.ensureResourceExists(V.createProgram()),k.gl_shader_vert=null,k.gl_shader_frag=null,k.compileState=Zf.NeedsCompile,k.tryCompileProgram(),k}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},o.prototype.tryCompileProgram=function(){Ma(this.compileState===Zf.NeedsCompile);var f=this.descriptor,v=f.vertex,S=f.fragment,O=this.device.gl;v!=null&&v.glsl&&(S!=null&&S.glsl)&&(this.gl_shader_vert=this.compileShader(v.postprocess?v.postprocess(v.glsl):v.glsl,O.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(S.postprocess?S.postprocess(S.glsl):S.glsl,O.FRAGMENT_SHADER),O.attachShader(this.gl_program,this.gl_shader_vert),O.attachShader(this.gl_program,this.gl_shader_frag),O.linkProgram(this.gl_program),this.compileState=Zf.Compiling,zo(O)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},o.prototype.readAttributesFromLinkedProgram=function(){for(var f,v=this.device.gl,S=v.getProgramParameter(this.gl_program,v.ACTIVE_ATTRIBUTES),O=yc(this.descriptor.vertex.glsl),L=RP(this.rawVertexGLSL,O),k=function(st){var ft=v.getActiveAttrib(V.gl_program,st),Tt=ft.name,se=ft.type,Ve=ft.size,yn=v.getAttribLocation(V.gl_program,Tt),lr=(f=L.find(function(Nr){return Nr.name===Tt}))===null||f===void 0?void 0:f.location;yn>=0&&!(0,Of.Z)(lr)&&(V.attributes[lr]={name:Tt,location:yn,type:se,size:Ve})},V=this,Q=0;Q<S;Q++)k(Q)},o.prototype.readUniformLocationsFromLinkedProgram=function(){for(var f=this.device.gl,v=f.getProgramParameter(this.gl_program,f.ACTIVE_UNIFORMS),S=0;S<v;S++){var O=f.getActiveUniform(this.gl_program,S),L=Kx(O.name).name,k=f.getUniformLocation(this.gl_program,L);if(this.uniformSetters[L]=HE(f,k,O),O&&O.size>1)for(var V=0;V<O.size;V++)k=f.getUniformLocation(this.gl_program,"".concat(L,"[").concat(V,"]")),this.uniformSetters["".concat(L,"[").concat(V,"]")]=HE(f,k,O)}},o.prototype.compileShader=function(f,v){var S=this.device.gl,O=this.device.ensureResourceExists(S.createShader(v));return S.shaderSource(O,f),S.compileShader(O),O},o.prototype.setUniformsLegacy=function(f){f===void 0&&(f={});var v=this.device.gl;if(!zo(v)){var S=!1;for(var O in f){S||(v.useProgram(this.gl_program),S=!0);var L=f[O],k=this.uniformSetters[O];if(k){var V=L;V instanceof Gy&&(V=V.textureIndex),k(V)}}}return this},o}(Md),KE=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.QueryPool;var k=L.device.gl;if(zo(k)){var V=O.elemCount,Q=O.type;L.gl_query=SP(V,function(){return L.device.ensureResourceExists(k.createQuery())}),L.gl_query_type=i3(Q)}return L}return o.prototype.queryResultOcclusion=function(f){var v=this.device.gl;if(zo(v)){var S=this.gl_query[f];return v.getQueryParameter(S,v.QUERY_RESULT_AVAILABLE)?!!v.getQueryParameter(S,v.QUERY_RESULT):null}return null},o.prototype.destroy=function(){a.prototype.destroy.call(this);var f=this.device.gl;if(zo(f))for(var v=0;v<this.gl_query.length;v++)f.deleteQuery(this.gl_query[v])},o}(Md),a3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=a.call(this,{id:v,device:S})||this;return O.type=Ls.Readback,O.gl_pbo=null,O.gl_sync=null,O}return o.prototype.clientWaitAsync=function(f,v,S){v===void 0&&(v=0),S===void 0&&(S=10);var O=this.device.gl;return new Promise(function(L,k){function V(){var Q=O.clientWaitSync(f,v,0);if(Q==O.WAIT_FAILED){k();return}if(Q==O.TIMEOUT_EXPIRED){setTimeout(V,(0,Ny.Z)(S,0,O.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}L()}V()})},o.prototype.getBufferSubDataAsync=function(f,v,S,O,L,k){return(0,go.mG)(this,void 0,void 0,function(){var V;return(0,go.Jh)(this,function(Q){switch(Q.label){case 0:return V=this.device.gl,zo(V)?(this.gl_sync=V.fenceSync(V.SYNC_GPU_COMMANDS_COMPLETE,0),V.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return Q.sent(),V.bindBuffer(f,v),V.getBufferSubData(f,S,O,L,k),V.bindBuffer(f,null),[2,O];case 2:return[2]}})})},o.prototype.readTexture=function(f,v,S,O,L,k,V,Q){return V===void 0&&(V=0),Q===void 0&&(Q=k.byteLength||0),(0,go.mG)(this,void 0,void 0,function(){var st,ft,Tt,se,Ve;return(0,go.Jh)(this,function(yn){return st=this.device.gl,ft=f,Tt=this.device.translateTextureFormat(ft.format),se=this.device.translateTextureType(ft.format),Ve=Hx(ft.format),zo(st)?(this.gl_pbo=this.device.ensureResourceExists(st.createBuffer()),st.bindBuffer(st.PIXEL_PACK_BUFFER,this.gl_pbo),st.bufferData(st.PIXEL_PACK_BUFFER,Q,st.STREAM_READ),st.bindBuffer(st.PIXEL_PACK_BUFFER,null),st.bindFramebuffer(pn.READ_FRAMEBUFFER,this.device.readbackFramebuffer),st.framebufferTexture2D(pn.READ_FRAMEBUFFER,pn.COLOR_ATTACHMENT0,pn.TEXTURE_2D,ft.gl_texture,0),st.bindBuffer(st.PIXEL_PACK_BUFFER,this.gl_pbo),st.readPixels(v,S,O,L,Tt,se,V*Ve),st.bindBuffer(st.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(st.PIXEL_PACK_BUFFER,this.gl_pbo,0,k,V,0)]):[2,this.readTextureSync(f,v,S,O,L,k,V,Q)]})})},o.prototype.readTextureSync=function(f,v,S,O,L,k,V,Q){Q===void 0&&(Q=k.byteLength||0);var st=this.device.gl,ft=f,Tt=this.device.translateTextureType(ft.format);return st.bindFramebuffer(pn.FRAMEBUFFER,this.device.readbackFramebuffer),st.framebufferTexture2D(pn.FRAMEBUFFER,pn.COLOR_ATTACHMENT0,pn.TEXTURE_2D,ft.gl_texture,0),st.pixelStorei(st.PACK_ALIGNMENT,4),st.readPixels(v,S,O,L,st.RGBA,Tt,k),k},o.prototype.readBuffer=function(f,v,S,O,L){return(0,go.mG)(this,void 0,void 0,function(){var k;return(0,go.Jh)(this,function(V){return k=this.device.gl,zo(k)?[2,this.getBufferSubDataAsync(k.ARRAY_BUFFER,Um(f,v),v,S,O,L)]:[2,Promise.reject()]})})},o.prototype.destroy=function(){a.prototype.destroy.call(this),zo(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},o}(Md),s3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L,k,V=a.call(this,{id:v,device:S})||this;return V.type=Ls.RenderPipeline,V.drawMode=Rv((L=O.topology)!==null&&L!==void 0?L:Pl.TRIANGLES),V.program=O.program,V.inputLayout=O.inputLayout,V.megaState=(0,go.pi)((0,go.pi)({},Cv(b0)),O.megaStateDescriptor),V.colorAttachmentFormats=O.colorAttachmentFormats.slice(),V.depthStencilAttachmentFormat=O.depthStencilAttachmentFormat,V.sampleCount=(k=O.sampleCount)!==null&&k!==void 0?k:1,V}return o}(Md),l3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;return L.type=Ls.ComputePipeline,L.descriptor=O,L}return o}(Md),QE=function(){function a(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return a.prototype.trackResourceCreated=function(o){this.creationStacks.set(o,new Error().stack),this.liveObjects.add(o)},a.prototype.trackResourceDestroyed=function(o){this.deletionStacks.has(o)&&console.warn("Object double freed:",o,`

Creation stack: `,this.creationStacks.get(o),`

Deletion stack: `,this.deletionStacks.get(o),`

This stack: `,new Error().stack),this.deletionStacks.set(o,new Error().stack),this.liveObjects.delete(o)},a.prototype.checkForLeaks=function(){var o,f;try{for(var v=(0,go.XA)(this.liveObjects.values()),S=v.next();!S.done;S=v.next()){var O=S.value;console.warn("Object leaked:",O,"Creation stack:",this.creationStacks.get(O))}}catch(L){o={error:L}}finally{try{S&&!S.done&&(f=v.return)&&f.call(v)}finally{if(o)throw o.error}}},a.prototype.setResourceLeakCheck=function(o,f){f?this.liveObjects.add(o):this.liveObjects.delete(o)},a}(),p1=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L,k,V=a.call(this,{id:v,device:S})||this;V.type=Ls.Sampler;var Q=V.device.gl;if(zo(Q)){var st=V.device.ensureResourceExists(Q.createSampler());Q.samplerParameteri(st,pn.TEXTURE_WRAP_S,Hy(O.addressModeU)),Q.samplerParameteri(st,pn.TEXTURE_WRAP_T,Hy(O.addressModeV)),Q.samplerParameteri(st,pn.TEXTURE_WRAP_R,Hy((L=O.addressModeW)!==null&&L!==void 0?L:O.addressModeU)),Q.samplerParameteri(st,pn.TEXTURE_MIN_FILTER,f1(O.minFilter,O.mipmapFilter)),Q.samplerParameteri(st,pn.TEXTURE_MAG_FILTER,f1(O.magFilter,Zl.NO_MIP)),O.lodMinClamp!==void 0&&Q.samplerParameterf(st,pn.TEXTURE_MIN_LOD,O.lodMinClamp),O.lodMaxClamp!==void 0&&Q.samplerParameterf(st,pn.TEXTURE_MAX_LOD,O.lodMaxClamp),O.compareFunction!==void 0&&(Q.samplerParameteri(st,Q.TEXTURE_COMPARE_MODE,Q.COMPARE_REF_TO_TEXTURE),Q.samplerParameteri(st,Q.TEXTURE_COMPARE_FUNC,O.compareFunction));var ft=(k=O.maxAnisotropy)!==null&&k!==void 0?k:1;ft>1&&V.device.EXT_texture_filter_anisotropic!==null&&(Ma(O.minFilter===ia.BILINEAR&&O.magFilter===ia.BILINEAR&&O.mipmapFilter===Zl.LINEAR),Q.samplerParameterf(st,V.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ft)),V.gl_sampler=st}else V.descriptor=O;return V}return o.prototype.setTextureParameters=function(f,v,S){var O,L=this.device.gl,k=this.descriptor;this.isNPOT(v,S)?L.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_MIN_FILTER,pn.LINEAR):L.texParameteri(f,pn.TEXTURE_MIN_FILTER,f1(k.minFilter,k.mipmapFilter)),L.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_WRAP_S,Hy(k.addressModeU)),L.texParameteri(pn.TEXTURE_2D,pn.TEXTURE_WRAP_T,Hy(k.addressModeV)),L.texParameteri(f,pn.TEXTURE_MAG_FILTER,f1(k.magFilter,Zl.NO_MIP));var V=(O=k.maxAnisotropy)!==null&&O!==void 0?O:1;V>1&&this.device.EXT_texture_filter_anisotropic!==null&&(Ma(k.minFilter===ia.BILINEAR&&k.magFilter===ia.BILINEAR&&k.mipmapFilter===Zl.LINEAR),L.texParameteri(f,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V))},o.prototype.destroy=function(){a.prototype.destroy.call(this),zo(this.device.gl)&&this.device.gl.deleteSampler(h1(this))},o.prototype.isNPOT=function(f,v){return!Uy(f)||!Uy(v)},o}(Md),Mv=function(){function a(){}return a.prototype.dispatchWorkgroups=function(o,f,v){},a.prototype.dispatchWorkgroupsIndirect=function(o,f){},a.prototype.setPipeline=function(o){},a.prototype.setBindings=function(o){},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a}(),hh=function(a){(0,go.ZT)(o,a);function o(){var f=a!==null&&a.apply(this,arguments)||this;return f.type=Ls.RenderBundle,f.commands=[],f}return o.prototype.push=function(f){this.commands.push(f)},o.prototype.replay=function(){this.commands.forEach(function(f){return f()})},o}(Md),JE=65536,ib=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,c3=function(){function a(o,f){f===void 0&&(f={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=Cv(b0),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Vp.LOWER_LEFT,this.clipSpaceNearZ=xg.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=o,this.contextAttributes=Ov(o.getContextAttributes()),zo(o)?(this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=o.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=o.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=o.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=o.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=o.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=o.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=o.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=o.getExtension("EXT_color_buffer_half_float"),o.getExtension("EXT_frag_depth"),o.getExtension("OES_element_index_uint"),o.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=o.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=o.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=o.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=o.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=o.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=o.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=o.getExtension("KHR_parallel_shader_compile"),zo(o)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new Gy({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:ts.TEXTURE_2D,mipLevelCount:1,usage:hu.RENDER_TARGET,format:this.contextAttributes.alpha===!1?$n.U8_RGB_RT:$n.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Cc.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(ts.TEXTURE_2D,Cc.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(ts.TEXTURE_2D,Cc.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:_s.VERTEX,hint:cd.STATIC}),zo(o)&&(this.fallbackTexture2DArray=this.createFallbackTexture(ts.TEXTURE_2D_ARRAY,Cc.Float),this.fallbackTexture3D=this.createFallbackTexture(ts.TEXTURE_3D,Cc.Float),this.fallbackTextureCube=this.createFallbackTexture(ts.TEXTURE_CUBE_MAP,Cc.Float)),this.currentMegaState.depthCompare=Ha.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=$u.ALL,o.enable(o.DEPTH_TEST),o.enable(o.STENCIL_TEST),this.checkLimits(),f.shaderDebug&&(this.shaderDebug=!0),f.trackResources&&(this.resourceCreationTracker=new QE)}return a.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},a.prototype.createFallbackTexture=function(o,f){var v=o===ts.TEXTURE_CUBE_MAP?6:1,S=f===Cc.Depth?$n.D32F:$n.U8_RGBA_NORM,O=this.createTexture({dimension:o,format:S,usage:hu.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1});return f===Cc.Float&&O.setImageData([new Uint8Array(4*v)]),Og(O)},a.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},a.prototype.checkLimits=function(){var o=this.gl;if(this.maxVertexAttribs=o.getParameter(pn.MAX_VERTEX_ATTRIBS),zo(o)){this.uniformBufferMaxPageByteSize=Math.min(o.getParameter(pn.MAX_UNIFORM_BLOCK_SIZE),JE),this.uniformBufferWordAlignment=o.getParameter(o.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var f=o.getInternalformatParameter(o.RENDERBUFFER,o.DEPTH32F_STENCIL8,o.SAMPLES);this.supportedSampleCounts=f?(0,go.ev)([],(0,go.CR)(f),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=JE;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(v,S){return v-S})},a.prototype.configureSwapChain=function(o,f,v){var S=this.scTexture;S.width=o,S.height=f,this.scPlatformFramebuffer=BA(v)},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.gl.canvas},a.prototype.getOnscreenTexture=function(){return this.scTexture},a.prototype.beginFrame=function(){},a.prototype.endFrame=function(){},a.prototype.translateTextureInternalFormat=function(o,f){switch(f===void 0&&(f=!1),o){case $n.ALPHA:return pn.ALPHA;case $n.U8_LUMINANCE:case $n.F16_LUMINANCE:case $n.F32_LUMINANCE:return pn.LUMINANCE;case $n.F16_R:return pn.R16F;case $n.F16_RG:return pn.RG16F;case $n.F16_RGB:return pn.RGB16F;case $n.F16_RGBA:return pn.RGBA16F;case $n.F32_R:return pn.R32F;case $n.F32_RG:return pn.RG32F;case $n.F32_RGB:return pn.RGB32F;case $n.F32_RGBA:return zo(this.gl)?pn.RGBA32F:f?this.WEBGL_color_buffer_float.RGBA32F_EXT:pn.RGBA;case $n.U8_R_NORM:return pn.R8;case $n.U8_RG_NORM:return pn.RG8;case $n.U8_RGB_NORM:case $n.U8_RGB_RT:return pn.RGB8;case $n.U8_RGB_SRGB:return pn.SRGB8;case $n.U8_RGBA_NORM:case $n.U8_RGBA_RT:return zo(this.gl)?pn.RGBA8:f?pn.RGBA4:pn.RGBA;case $n.U8_RGBA:return pn.RGBA;case $n.U8_RGBA_SRGB:case $n.U8_RGBA_RT_SRGB:return pn.SRGB8_ALPHA8;case $n.U16_R:return pn.R16UI;case $n.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case $n.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case $n.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case $n.U16_RGBA_5551:return pn.RGB5_A1;case $n.U16_RGB_565:return pn.RGB565;case $n.U32_R:return pn.R32UI;case $n.S8_RGBA_NORM:return pn.RGBA8_SNORM;case $n.S8_RG_NORM:return pn.RG8_SNORM;case $n.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case $n.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case $n.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case $n.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case $n.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case $n.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case $n.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case $n.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case $n.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case $n.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case $n.D32F_S8:return zo(this.gl)?pn.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?pn.DEPTH_STENCIL:pn.DEPTH_COMPONENT16;case $n.D24_S8:return zo(this.gl)?pn.DEPTH24_STENCIL8:this.WEBGL_depth_texture?pn.DEPTH_STENCIL:pn.DEPTH_COMPONENT16;case $n.D32F:return zo(this.gl)?pn.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?pn.DEPTH_COMPONENT:pn.DEPTH_COMPONENT16;case $n.D24:return zo(this.gl)?pn.DEPTH_COMPONENT24:this.WEBGL_depth_texture?pn.DEPTH_COMPONENT:pn.DEPTH_COMPONENT16;default:throw new Error("whoops")}},a.prototype.translateTextureType=function(o){var f=fh(o);switch(f){case ii.U8:return pn.UNSIGNED_BYTE;case ii.U16:return pn.UNSIGNED_SHORT;case ii.U32:return pn.UNSIGNED_INT;case ii.S8:return pn.BYTE;case ii.F16:return pn.HALF_FLOAT;case ii.F32:return pn.FLOAT;case ii.U16_PACKED_5551:return pn.UNSIGNED_SHORT_5_5_5_1;case ii.D32F:return zo(this.gl)?pn.FLOAT:this.WEBGL_depth_texture?pn.UNSIGNED_INT:pn.UNSIGNED_BYTE;case ii.D24:return zo(this.gl)?pn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?pn.UNSIGNED_SHORT:pn.UNSIGNED_BYTE;case ii.D24S8:return zo(this.gl)?pn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?pn.UNSIGNED_INT_24_8_WEBGL:pn.UNSIGNED_BYTE;case ii.D32FS8:return pn.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},a.prototype.translateInternalTextureFormat=function(o){switch(o){case $n.F32_R:return pn.R32F;case $n.F32_RG:return pn.RG32F;case $n.F32_RGB:return pn.RGB32F;case $n.F32_RGBA:return pn.RGBA32F;case $n.F16_R:return pn.R16F;case $n.F16_RG:return pn.RG16F;case $n.F16_RGB:return pn.RGB16F;case $n.F16_RGBA:return pn.RGBA16F}return this.translateTextureFormat(o)},a.prototype.translateTextureFormat=function(o){if(Jx(o)||o===$n.F32_LUMINANCE||o===$n.U8_LUMINANCE)return this.translateTextureInternalFormat(o);var f=zo(this.gl)||!zo(this.gl)&&!!this.WEBGL_depth_texture;switch(o){case $n.D24_S8:case $n.D32F_S8:return f?pn.DEPTH_STENCIL:pn.RGBA;case $n.D24:case $n.D32F:return f?pn.DEPTH_COMPONENT:pn.RGBA}var v=XE(o),S=n1(o);switch(S){case Ii.A:return pn.ALPHA;case Ii.R:return v?pn.RED_INTEGER:pn.RED;case Ii.RG:return v?pn.RG_INTEGER:pn.RG;case Ii.RGB:return v?pn.RGB_INTEGER:pn.RGB;case Ii.RGBA:return pn.RGBA}},a.prototype.setActiveTexture=function(o){this.currentActiveTexture!==o&&(this.gl.activeTexture(o),this.currentActiveTexture=o)},a.prototype.bindVAO=function(o){this.currentBoundVAO!==o&&(zo(this.gl)?this.gl.bindVertexArray(o):this.OES_vertex_array_object.bindVertexArrayOES(o),this.currentBoundVAO=o)},a.prototype.programCompiled=function(o){Ma(o.compileState!==Zf.NeedsCompile),o.compileState===Zf.Compiling&&(o.compileState=Zf.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(o))},a.prototype.useProgram=function(o){this.currentProgram!==o&&(this.programCompiled(o),this.gl.useProgram(o.gl_program),this.currentProgram=o)},a.prototype.ensureResourceExists=function(o){if(o===null){var f=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(f))}else return o},a.prototype.createBuffer=function(o){return new d1({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new Gy({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new p1({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){return new rb({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,S=f.width,O=f.height,L=f.mipLevelCount;return Ma(L===1),this.createRenderTarget({format:v,width:S,height:O,sampleCount:1,texture:o})},a.prototype.createProgram=function(o){var f,v,S,O=(f=o.vertex)===null||f===void 0?void 0:f.glsl;return!((v=o.vertex)===null||v===void 0)&&v.glsl&&(o.vertex.glsl=Fm(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((S=o.fragment)===null||S===void 0)&&S.glsl&&(o.fragment.glsl=Fm(this.queryVendorInfo(),"frag",o.fragment.glsl)),this.createProgramSimple(o,O)},a.prototype.createProgramSimple=function(o,f){var v=new $E({id:this.getNextUniqueId(),device:this,descriptor:o},f);return v},a.prototype.createBindings=function(o){return new r3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new nb({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new s3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePass=function(){return new Mv},a.prototype.createComputePipeline=function(o){return new l3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createReadback=function(){return new a3({id:this.getNextUniqueId(),device:this})},a.prototype.createQueryPool=function(o,f){return new KE({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.formatRenderPassDescriptor=function(o){var f,v,S,O,L,k,V=o.colorAttachment;o.depthClearValue=(f=o.depthClearValue)!==null&&f!==void 0?f:"load",o.stencilClearValue=(v=o.stencilClearValue)!==null&&v!==void 0?v:"load";for(var Q=0;Q<V.length;Q++)o.colorAttachmentLevel||(o.colorAttachmentLevel=[]),o.colorAttachmentLevel[Q]=(S=o.colorAttachmentLevel[Q])!==null&&S!==void 0?S:0,o.colorResolveToLevel||(o.colorResolveToLevel=[]),o.colorResolveToLevel[Q]=(O=o.colorResolveToLevel[Q])!==null&&O!==void 0?O:0,o.colorClearColor||(o.colorClearColor=[]),o.colorClearColor[Q]=(L=o.colorClearColor[Q])!==null&&L!==void 0?L:"load",o.colorStore||(o.colorStore=[]),o.colorStore[Q]=(k=o.colorStore[Q])!==null&&k!==void 0?k:!1},a.prototype.createRenderBundle=function(){return new hh({id:this.getNextUniqueId(),device:this})},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle=void 0},a.prototype.executeBundles=function(o){o.forEach(function(f){f.replay()})},a.prototype.createRenderPass=function(o){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=o,this.formatRenderPassDescriptor(o);var f=o.colorAttachment,v=o.colorAttachmentLevel,S=o.colorClearColor,O=o.colorResolveTo,L=o.colorResolveToLevel,k=o.depthStencilAttachment,V=o.depthClearValue,Q=o.stencilClearValue,st=o.depthStencilResolveTo,ft=O&&O.length===1&&O[0]===this.scTexture;this.setRenderPassParametersBegin(f.length,ft);for(var Tt=0;Tt<f.length;Tt++)this.setRenderPassParametersColor(Tt,f[Tt],v[Tt],O[Tt],L[Tt],ft);this.setRenderPassParametersDepthStencil(k,st,ft),this.validateCurrentAttachments();for(var Tt=0;Tt<f.length;Tt++){var se=S[Tt];se!=="load"&&this.setRenderPassParametersClearColor(Tt,se.r,se.g,se.b,se.a)}return this.setRenderPassParametersClearDepthStencil(V,Q),this},a.prototype.submitPass=function(o){Ma(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},a.prototype.copySubTexture2D=function(o,f,v,S,O,L){var k=this.gl,V=o,Q=S;if(Ma(Q.mipLevelCount===1),Ma(V.mipLevelCount===1),zo(k))V===this.scTexture?k.bindFramebuffer(k.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(k.bindFramebuffer(k.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(k.DRAW_FRAMEBUFFER,k.COLOR_ATTACHMENT0,V,0)),k.bindFramebuffer(k.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(k.READ_FRAMEBUFFER,k.COLOR_ATTACHMENT0,Q,0),k.blitFramebuffer(O,L,O+Q.width,L+Q.height,f,v,f+Q.width,v+Q.height,k.COLOR_BUFFER_BIT,k.LINEAR),k.bindFramebuffer(k.READ_FRAMEBUFFER,null),k.bindFramebuffer(k.DRAW_FRAMEBUFFER,null);else if(V===this.scTexture){var st=this.createRenderTargetFromTexture(S);this.submitBlitRenderPass(st,V)}},a.prototype.queryLimits=function(){return this},a.prototype.queryTextureFormatSupported=function(o,f,v){switch(o){case $n.BC1_SRGB:case $n.BC2_SRGB:case $n.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?eb(f,v,4,4):!1;case $n.BC1:case $n.BC2:case $n.BC3:return this.WEBGL_compressed_texture_s3tc!==null?eb(f,v,4,4):!1;case $n.BC4_UNORM:case $n.BC4_SNORM:case $n.BC5_UNORM:case $n.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?eb(f,v,4,4):!1;case $n.U16_R_NORM:case $n.U16_RG_NORM:case $n.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case $n.F32_R:case $n.F32_RG:case $n.F32_RGB:case $n.F32_RGBA:return this.OES_texture_float_linear!==null;case $n.F16_R:case $n.F16_RG:case $n.F16_RGB:case $n.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},a.prototype.queryProgramReady=function(o){var f=this.gl;if(o.compileState===Zf.NeedsCompile)throw new Error("whoops");if(o.compileState===Zf.Compiling){var v=void 0;return this.KHR_parallel_shader_compile!==null?v=f.getProgramParameter(o.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):v=!0,v&&this.programCompiled(o),v}return o.compileState===Zf.NeedsBind||o.compileState===Zf.ReadyToUse},a.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){return this.currentRenderPassDescriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Ls.Buffer)for(var v=o.gl_buffer_pages,S=0;S<v.length;S++)E0(v[S],"".concat(f," Page ").concat(S));else if(o.type===Ls.Texture)E0(Og(o),f);else if(o.type===Ls.Sampler)E0(h1(o),f);else if(o.type===Ls.RenderTarget){var O=o.gl_renderbuffer;O!==null&&E0(O,f)}else o.type===Ls.InputLayout&&E0(o.vao,f)},a.prototype.setResourceLeakCheck=function(o,f){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(o,f)},a.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a.prototype.programPatched=function(o,f){Ma(this.shaderDebug)},a.prototype.getBufferData=function(o,f,v){v===void 0&&(v=0);var S=this.gl;zo(S)&&(S.bindBuffer(S.COPY_READ_BUFFER,Um(o,v*4)),S.getBufferSubData(S.COPY_READ_BUFFER,v*4,f))},a.prototype.debugGroupStatisticsDrawCall=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].drawCallCount+=o},a.prototype.debugGroupStatisticsBufferUpload=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].bufferUploadCount+=o},a.prototype.debugGroupStatisticsTextureBind=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].textureBindCount+=o},a.prototype.debugGroupStatisticsTriangles=function(o){for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].triangleCount+=o},a.prototype.reportShaderError=function(o,f){var v=this.gl,S=v.getShaderParameter(o,v.COMPILE_STATUS);if(!S){console.error(UA(f));var O=v.getExtension("WEBGL_debug_shaders");O&&console.error(O.getTranslatedShaderSource(o)),console.error(v.getShaderInfoLog(o))}return S},a.prototype.checkProgramCompilationForErrors=function(o){var f=this.gl,v=o.gl_program;if(!f.getProgramParameter(v,f.LINK_STATUS)){var S=o.descriptor;if(!this.reportShaderError(o.gl_shader_vert,S.vertex.glsl)||!this.reportShaderError(o.gl_shader_frag,S.fragment.glsl))return;console.error(f.getProgramInfoLog(o.gl_program))}},a.prototype.bindFramebufferAttachment=function(o,f,v,S){var O=this.gl;if((0,Of.Z)(v))O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,null);else if(v.type===Ls.RenderTarget)v.gl_renderbuffer!==null?O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,v.gl_renderbuffer):v.texture!==null&&O.framebufferTexture2D(o,f,pn.TEXTURE_2D,Og(v.texture),S);else if(v.type===Ls.Texture){var L=Og(v);v.dimension===ts.TEXTURE_2D?O.framebufferTexture2D(o,f,pn.TEXTURE_2D,L,S):zo(O)&&(v.dimension,ts.TEXTURE_2D_ARRAY)}},a.prototype.bindFramebufferDepthStencilAttachment=function(o,f){var v=this.gl,S=(0,Of.Z)(f)?po.Depth|po.Stencil:Nm(f.format),O=!!(S&po.Depth),L=!!(S&po.Stencil);if(O&&L){var k=zo(this.gl)||!zo(this.gl)&&!!this.WEBGL_depth_texture;k?this.bindFramebufferAttachment(o,v.DEPTH_STENCIL_ATTACHMENT,f,0):this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0)}else O?(this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,null,0)):L&&(this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,null,0))},a.prototype.validateCurrentAttachments=function(){for(var o=-1,f=-1,v=-1,S=0;S<this.currentColorAttachments.length;S++){var O=this.currentColorAttachments[S];O!==null&&(o===-1?(o=O.sampleCount,f=O.width,v=O.height):(Ma(o===O.sampleCount),Ma(f===O.width),Ma(v===O.height)))}this.currentDepthStencilAttachment&&(o===-1?o=this.currentDepthStencilAttachment.sampleCount:(Ma(o===this.currentDepthStencilAttachment.sampleCount),Ma(f===this.currentDepthStencilAttachment.width),Ma(v===this.currentDepthStencilAttachment.height))),this.currentSampleCount=o},a.prototype.setRenderPassParametersBegin=function(o,f){f===void 0&&(f=!1);var v=this.gl;if(f)v.bindFramebuffer(pn.FRAMEBUFFER,null);else if(zo(v)?v.bindFramebuffer(pn.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||v.bindFramebuffer(pn.FRAMEBUFFER,this.renderPassDrawFramebuffer),zo(v)?v.drawBuffers([pn.COLOR_ATTACHMENT0,pn.COLOR_ATTACHMENT1,pn.COLOR_ATTACHMENT2,pn.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([pn.COLOR_ATTACHMENT0_WEBGL,pn.COLOR_ATTACHMENT1_WEBGL,pn.COLOR_ATTACHMENT2_WEBGL,pn.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var S=o;S<this.currentColorAttachments.length;S++){var O=zo(v)?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,L=zo(v)?pn.COLOR_ATTACHMENT0:pn.COLOR_ATTACHMENT0_WEBGL;v.framebufferRenderbuffer(O,L+S,pn.RENDERBUFFER,null),v.framebufferTexture2D(O,L+S,pn.TEXTURE_2D,null,0)}this.currentColorAttachments.length=o},a.prototype.setRenderPassParametersColor=function(o,f,v,S,O,L){L===void 0&&(L=!1);var k=this.gl,V=zo(k);(this.currentColorAttachments[o]!==f||this.currentColorAttachmentLevels[o]!==v)&&(this.currentColorAttachments[o]=f,this.currentColorAttachmentLevels[o]=v,!L&&(V||!V&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(V?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,(V?pn.COLOR_ATTACHMENT0:pn.COLOR_ATTACHMENT0_WEBGL)+o,f,v),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[o]!==S||this.currentColorResolveToLevels[o]!==O)&&(this.currentColorResolveTos[o]=S,this.currentColorResolveToLevels[o]=O,S!==null&&(this.resolveColorAttachmentsChanged=!0))},a.prototype.setRenderPassParametersDepthStencil=function(o,f,v){v===void 0&&(v=!1);var S=this.gl;this.currentDepthStencilAttachment!==o&&(this.currentDepthStencilAttachment=o,!v&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(zo(S)?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==f&&(this.currentDepthStencilResolveTo=f,f&&(this.resolveDepthStencilAttachmentsChanged=!0))},a.prototype.setRenderPassParametersClearColor=function(o,f,v,S,O){var L=this.gl;if(this.OES_draw_buffers_indexed!==null){var k=this.currentMegaState.attachmentsState[o];k&&k.channelWriteMask!==$u.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(o,!0,!0,!0,!0),k.channelWriteMask=$u.ALL)}else{var k=this.currentMegaState.attachmentsState[0];k&&k.channelWriteMask!==$u.ALL&&(L.colorMask(!0,!0,!0,!0),k.channelWriteMask=$u.ALL)}this.setScissorRectEnabled(!1),zo(L)?L.clearBufferfv(L.COLOR,o,[f,v,S,O]):(L.clearColor(f,v,S,O),L.clear(L.COLOR_BUFFER_BIT))},a.prototype.setRenderPassParametersClearDepthStencil=function(o,f){o===void 0&&(o="load"),f===void 0&&(f="load");var v=this.gl;o!=="load"&&(Ma(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(v.depthMask(!0),this.currentMegaState.depthWrite=!0),zo(v)?v.clearBufferfv(v.DEPTH,0,[o]):(v.clearDepth(o),v.clear(v.DEPTH_BUFFER_BIT))),f!=="load"&&(Ma(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(v.enable(v.STENCIL_TEST),v.stencilMask(255),this.currentMegaState.stencilWrite=!0),zo(v)?v.clearBufferiv(v.STENCIL,0,[f]):(v.clearStencil(f),v.clear(v.STENCIL_BUFFER_BIT)))},a.prototype.setBindings=function(o){var f=this,v;if(this.renderBundle){this.renderBundle.push(function(){return f.setBindings(o)});return}var S=this.gl,O=o,L=O.uniformBufferBindings,k=O.samplerBindings,V=O.bindingLayouts;Ma(0<V.bindingLayoutTables.length);var Q=V.bindingLayoutTables[0];Ma(L.length>=Q.numUniformBuffers),Ma(k.length>=Q.numSamplers);for(var st=0;st<L.length;st++){var ft=L[st];if(ft.size!==0){var Tt=Q.firstUniformBuffer+st,se=ft.buffer,Ve=ft.offset||0,yn=ft.size||se.byteSize;if(se!==this.currentUniformBuffers[Tt]||Ve!==this.currentUniformBufferByteOffsets[Tt]||yn!==this.currentUniformBufferByteSizes[Tt]){var lr=Ve%se.pageByteSize,Nr=se.gl_buffer_pages[Ve/se.pageByteSize|0];Ma(lr+yn<=se.pageByteSize),zo(S)&&S.bindBufferRange(S.UNIFORM_BUFFER,Tt,Nr,lr,yn),this.currentUniformBuffers[Tt]=se,this.currentUniformBufferByteOffsets[Tt]=Ve,this.currentUniformBufferByteSizes[Tt]=yn}}}for(var st=0;st<Q.numSamplers;st++){var ft=k[st],Ln=Q.firstSampler+st,ci=ft!==null&&ft.sampler!==null?h1(ft.sampler):null,Fi=ft!==null&&ft.texture!==null?Og(ft.texture):null;if(this.currentSamplers[Ln]!==ci&&(zo(S)&&S.bindSampler(Ln,ci),this.currentSamplers[Ln]=ci),this.currentTextures[Ln]!==Fi){if(this.setActiveTexture(S.TEXTURE0+Ln),Fi!==null){var So=Ov(ft).texture,Ji=So.gl_target,Vr=So.width,Hi=So.height;ft.texture.textureIndex=Ln,S.bindTexture(Ji,Fi),zo(S)||(v=ft.sampler)===null||v===void 0||v.setTextureParameters(Ji,Vr,Hi),this.debugGroupStatisticsTextureBind()}else{var za=(0,go.pi)((0,go.pi)({},ft),kE),ps=za.dimension,Wo=za.formatKind,Ji=o3(ps);S.bindTexture(Ji,this.getFallbackTexture((0,go.pi)({gl_target:Ji,formatKind:Wo},za)))}this.currentTextures[Ln]=Fi}}},a.prototype.setViewport=function(o,f,v,S){var O=this.gl;O.viewport(o,f,v,S)},a.prototype.setScissorRect=function(o,f,v,S){var O=this.gl;this.setScissorRectEnabled(!0),O.scissor(o,f,v,S)},a.prototype.applyAttachmentStateIndexed=function(o,f,v){var S=this.gl,O=this.OES_draw_buffers_indexed;f.channelWriteMask!==v.channelWriteMask&&(O.colorMaskiOES(o,!!(v.channelWriteMask&$u.RED),!!(v.channelWriteMask&$u.GREEN),!!(v.channelWriteMask&$u.BLUE),!!(v.channelWriteMask&$u.ALPHA)),f.channelWriteMask=v.channelWriteMask);var L=f.rgbBlendState.blendMode!==v.rgbBlendState.blendMode||f.alphaBlendState.blendMode!==v.alphaBlendState.blendMode,k=f.rgbBlendState.blendSrcFactor!==v.rgbBlendState.blendSrcFactor||f.alphaBlendState.blendSrcFactor!==v.alphaBlendState.blendSrcFactor||f.rgbBlendState.blendDstFactor!==v.rgbBlendState.blendDstFactor||f.alphaBlendState.blendDstFactor!==v.alphaBlendState.blendDstFactor;(k||L)&&(up(f.rgbBlendState)&&up(f.alphaBlendState)?O.enableiOES(o,S.BLEND):up(v.rgbBlendState)&&up(v.alphaBlendState)&&O.disableiOES(o,S.BLEND)),L&&(O.blendEquationSeparateiOES(o,v.rgbBlendState.blendMode,v.alphaBlendState.blendMode),f.rgbBlendState.blendMode=v.rgbBlendState.blendMode,f.alphaBlendState.blendMode=v.alphaBlendState.blendMode),k&&(O.blendFuncSeparateiOES(o,v.rgbBlendState.blendSrcFactor,v.rgbBlendState.blendDstFactor,v.alphaBlendState.blendSrcFactor,v.alphaBlendState.blendDstFactor),f.rgbBlendState.blendSrcFactor=v.rgbBlendState.blendSrcFactor,f.alphaBlendState.blendSrcFactor=v.alphaBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor=v.rgbBlendState.blendDstFactor,f.alphaBlendState.blendDstFactor=v.alphaBlendState.blendDstFactor)},a.prototype.applyAttachmentState=function(o,f){var v=this.gl;o.channelWriteMask!==f.channelWriteMask&&(v.colorMask(!!(f.channelWriteMask&$u.RED),!!(f.channelWriteMask&$u.GREEN),!!(f.channelWriteMask&$u.BLUE),!!(f.channelWriteMask&$u.ALPHA)),o.channelWriteMask=f.channelWriteMask);var S=o.rgbBlendState.blendMode!==f.rgbBlendState.blendMode||o.alphaBlendState.blendMode!==f.alphaBlendState.blendMode,O=o.rgbBlendState.blendSrcFactor!==f.rgbBlendState.blendSrcFactor||o.alphaBlendState.blendSrcFactor!==f.alphaBlendState.blendSrcFactor||o.rgbBlendState.blendDstFactor!==f.rgbBlendState.blendDstFactor||o.alphaBlendState.blendDstFactor!==f.alphaBlendState.blendDstFactor;(O||S)&&(up(o.rgbBlendState)&&up(o.alphaBlendState)?v.enable(v.BLEND):up(f.rgbBlendState)&&up(f.alphaBlendState)&&v.disable(v.BLEND)),S&&(v.blendEquationSeparate(f.rgbBlendState.blendMode,f.alphaBlendState.blendMode),o.rgbBlendState.blendMode=f.rgbBlendState.blendMode,o.alphaBlendState.blendMode=f.alphaBlendState.blendMode),O&&(v.blendFuncSeparate(f.rgbBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor,f.alphaBlendState.blendSrcFactor,f.alphaBlendState.blendDstFactor),o.rgbBlendState.blendSrcFactor=f.rgbBlendState.blendSrcFactor,o.alphaBlendState.blendSrcFactor=f.alphaBlendState.blendSrcFactor,o.rgbBlendState.blendDstFactor=f.rgbBlendState.blendDstFactor,o.alphaBlendState.blendDstFactor=f.alphaBlendState.blendDstFactor)},a.prototype.setMegaState=function(o){var f=this.gl,v=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var S=0;S<o.attachmentsState.length;S++)this.applyAttachmentStateIndexed(S,v.attachmentsState[0],o.attachmentsState[0]);else Ma(o.attachmentsState.length===1),this.applyAttachmentState(v.attachmentsState[0],o.attachmentsState[0]);PE(v.blendConstant,o.blendConstant)||(f.blendColor(o.blendConstant.r,o.blendConstant.g,o.blendConstant.b,o.blendConstant.a),By(v.blendConstant,o.blendConstant)),v.depthCompare!==o.depthCompare&&(f.depthFunc(o.depthCompare),v.depthCompare=o.depthCompare),!!v.depthWrite!=!!o.depthWrite&&(f.depthMask(o.depthWrite),v.depthWrite=o.depthWrite),!!v.stencilWrite!=!!o.stencilWrite&&(f.stencilMask(o.stencilWrite?255:0),v.stencilWrite=o.stencilWrite);var O=!1;if(!wg(v.stencilFront,o.stencilFront)){O=!0;var L=o.stencilFront,k=L.passOp,V=L.failOp,Q=L.depthFailOp,st=L.compare;(v.stencilFront.passOp!==k||v.stencilFront.failOp!==V||v.stencilFront.depthFailOp!==Q)&&(f.stencilOpSeparate(f.FRONT,V,Q,k),v.stencilFront.passOp=k,v.stencilFront.failOp=V,v.stencilFront.depthFailOp=Q),v.stencilFront.compare!==st&&(this.setStencilReference(0),v.stencilFront.compare=st)}if(!wg(v.stencilBack,o.stencilBack)){O=!0;var ft=o.stencilBack,k=ft.passOp,V=ft.failOp,Q=ft.depthFailOp,st=ft.compare;(v.stencilBack.passOp!==k||v.stencilBack.failOp!==V||v.stencilBack.depthFailOp!==Q)&&(f.stencilOpSeparate(f.BACK,V,Q,k),v.stencilBack.passOp=k,v.stencilBack.failOp=V,v.stencilBack.depthFailOp=Q),v.stencilBack.compare!==st&&(this.setStencilReference(0),v.stencilBack.compare=st)}(v.stencilFront.mask!==o.stencilFront.mask||v.stencilBack.mask!==o.stencilBack.mask)&&(O=!0,v.stencilFront.mask=o.stencilFront.mask,v.stencilBack.mask=o.stencilBack.mask),O&&this.applyStencil(),v.cullMode!==o.cullMode&&(v.cullMode===ld.NONE?f.enable(f.CULL_FACE):o.cullMode===ld.NONE&&f.disable(f.CULL_FACE),o.cullMode===ld.BACK?f.cullFace(f.BACK):o.cullMode===ld.FRONT?f.cullFace(f.FRONT):o.cullMode===ld.FRONT_AND_BACK&&f.cullFace(f.FRONT_AND_BACK),v.cullMode=o.cullMode),v.frontFace!==o.frontFace&&(f.frontFace(o.frontFace),v.frontFace=o.frontFace),v.polygonOffset!==o.polygonOffset&&(o.polygonOffset?f.enable(f.POLYGON_OFFSET_FILL):f.disable(f.POLYGON_OFFSET_FILL),v.polygonOffset=o.polygonOffset),(v.polygonOffsetFactor!==o.polygonOffsetFactor||v.polygonOffsetUnits!==o.polygonOffsetUnits)&&(f.polygonOffset(o.polygonOffsetFactor,o.polygonOffsetUnits),v.polygonOffsetFactor=o.polygonOffsetFactor,v.polygonOffsetUnits=o.polygonOffsetUnits)},a.prototype.validatePipelineFormats=function(o){for(var f=0;f<this.currentColorAttachments.length;f++)var v=this.currentColorAttachments[f];this.currentDepthStencilAttachment&&Ma(this.currentDepthStencilAttachment.format===o.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&Ma(this.currentSampleCount===o.sampleCount)},a.prototype.setPipeline=function(o){var f=this;if(this.renderBundle){this.renderBundle.push(function(){return f.setPipeline(o)});return}this.currentPipeline=o,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var v=this.currentPipeline.program;if(this.useProgram(v),v.compileState===Zf.NeedsBind){var S=this.gl,O=v.gl_program,L=v.descriptor,k=qE(L.vertex.glsl,ib);if(zo(S))for(var V=0;V<k.length;V++){var Q=(0,go.CR)(k[V],2),st=Q[1],ft=S.getUniformBlockIndex(O,st);ft!==-1&&ft!==4294967295&&S.uniformBlockBinding(O,ft,V)}for(var Tt=qE(L.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),V=0;V<Tt.length;V++){var se=(0,go.CR)(Tt[V],3),Ve=se[1],yn=se[2],lr=S.getUniformLocation(O,Ve);S.uniform1i(lr,parseInt(yn))}v.compileState=Zf.ReadyToUse}},a.prototype.setVertexInput=function(o,f,v){var S,O,L=this,k;if(this.renderBundle){this.renderBundle.push(function(){return L.setVertexInput(o,f,v)});return}if(o!==null){Ma(this.currentPipeline.inputLayout===o);var V=o;this.bindVAO(V.vao);for(var Q=this.gl,st=0;st<V.vertexBufferDescriptors.length;st++){var ft=V.vertexBufferDescriptors[st],Tt=ft.arrayStride,se=ft.attributes;try{for(var Ve=(S=void 0,(0,go.XA)(se)),yn=Ve.next();!yn.done;yn=Ve.next()){var lr=yn.value,Nr=lr.shaderLocation,Ln=lr.offset,ci=zo(Q)?Nr:(k=V.program.attributes[Nr])===null||k===void 0?void 0:k.location;if(!(0,Of.Z)(ci)){var Fi=f[st];if(Fi===null)continue;var So=lr.vertexFormat;Q.bindBuffer(Q.ARRAY_BUFFER,Um(Fi.buffer));var Ji=(Fi.offset||0)+Ln;Q.vertexAttribPointer(ci,So.size,So.type,So.normalized,Tt,Ji)}}}catch(Hi){S={error:Hi}}finally{try{yn&&!yn.done&&(O=Ve.return)&&O.call(Ve)}finally{if(S)throw S.error}}}if(Ma(v!==null==(V.indexBufferFormat!==null)),v!==null){var Vr=v.buffer;Ma(Vr.usage===_s.INDEX),Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,Um(Vr)),this.currentIndexBufferByteOffset=v.offset||0}else this.currentIndexBufferByteOffset=null}else Ma(this.currentPipeline.inputLayout===null),Ma(v===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},a.prototype.setStencilReference=function(o){this.currentStencilRef!==o&&(this.currentStencilRef=o,this.applyStencil())},a.prototype.draw=function(o,f,v,S){var O,L=this;if(this.renderBundle){this.renderBundle.push(function(){return L.draw(o,f,v,S)});return}var k=this.gl,V=this.currentPipeline;if(f){var Q=[V.drawMode,v||0,o,f];zo(k)?k.drawArraysInstanced.apply(k,(0,go.ev)([],(0,go.CR)(Q),!1)):(O=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(O,(0,go.ev)([],(0,go.CR)(Q),!1))}else k.drawArrays(V.drawMode,v,o);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndexed=function(o,f,v,S,O){var L,k=this;if(this.renderBundle){this.renderBundle.push(function(){return k.drawIndexed(o,f,v,S,O)});return}var V=this.gl,Q=this.currentPipeline,st=Ov(Q.inputLayout),ft=Ov(this.currentIndexBufferByteOffset)+v*st.indexBufferCompByteSize;if(f){var Tt=[Q.drawMode,o,st.indexBufferType,ft,f];zo(V)?V.drawElementsInstanced.apply(V,(0,go.ev)([],(0,go.CR)(Tt),!1)):(L=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(L,(0,go.ev)([],(0,go.CR)(Tt),!1))}else V.drawElements(Q.drawMode,o,st.indexBufferType,ft);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndirect=function(o,f){},a.prototype.drawIndexedIndirect=function(o,f){},a.prototype.beginOcclusionQuery=function(o){var f=this.gl;if(zo(f)){var v=this.currentRenderPassDescriptor.occlusionQueryPool;f.beginQuery(v.gl_query_type,v.gl_query[o])}},a.prototype.endOcclusionQuery=function(){var o=this.gl;if(zo(o)){var f=this.currentRenderPassDescriptor.occlusionQueryPool;o.endQuery(f.gl_query_type)}},a.prototype.pipelineQueryReady=function(o){var f=o;return this.queryProgramReady(f.program)},a.prototype.pipelineForceReady=function(o){},a.prototype.endPass=function(){for(var o=this.gl,f=zo(o),v=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,S=!1,O=0;O<this.currentColorAttachments.length;O++){var L=this.currentColorAttachments[O];if(L!==null){var k=this.currentColorResolveTos[O],V=!1;k!==null&&(Ma(L.width===k.width&&L.height===k.height),this.setScissorRectEnabled(!1),v||(f&&o.bindFramebuffer(o.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&f&&this.bindFramebufferAttachment(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),V=!0,v||(k===this.scTexture?o.bindFramebuffer(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,this.scPlatformFramebuffer):(o.bindFramebuffer(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&o.framebufferTexture2D(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,k.gl_texture,this.currentColorResolveToLevels[O]))),v||(f?(o.blitFramebuffer(0,0,L.width,L.height,0,0,k.width,k.height,o.COLOR_BUFFER_BIT,o.LINEAR),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(L,k)),S=!0),this.currentRenderPassDescriptor.colorStore[O]||!v&&!V&&(o.bindFramebuffer(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),v||o.bindFramebuffer(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var Q=this.currentDepthStencilAttachment;if(Q){var st=this.currentDepthStencilResolveTo,V=!1;st&&(Ma(Q.width===st.width&&Q.height===st.height),this.setScissorRectEnabled(!1),v||(o.bindFramebuffer(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),o.bindFramebuffer(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,Q),this.bindFramebufferDepthStencilAttachment(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,st))),V=!0,v||(f&&o.blitFramebuffer(0,0,Q.width,Q.height,0,0,st.width,st.height,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,null)),S=!0),!v&&!this.currentRenderPassDescriptor.depthStencilStore&&(V||(o.bindFramebuffer(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,Q),V=!0),f&&o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[o.DEPTH_STENCIL_ATTACHMENT])),!v&&V&&o.bindFramebuffer(f?pn.READ_FRAMEBUFFER:pn.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!v&&!S&&o.bindFramebuffer(f?pn.DRAW_FRAMEBUFFER:pn.FRAMEBUFFER,null)},a.prototype.setScissorRectEnabled=function(o){if(this.currentScissorEnabled!==o){var f=this.gl;o?f.enable(f.SCISSOR_TEST):f.disable(f.SCISSOR_TEST),this.currentScissorEnabled=o}},a.prototype.applyStencil=function(){(0,Of.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(pn.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(pn.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},a.prototype.getFallbackTexture=function(o){var f=o.gl_target,v=o.formatKind;if(f===pn.TEXTURE_2D)return v===Cc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===pn.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===pn.TEXTURE_3D)return this.fallbackTexture3D;if(f===pn.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.submitBlitRenderPass=function(o,f){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:_s.VERTEX|_s.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Av.VERTEX,attributes:[{format:$n.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:Pl.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[$n.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:Cv(b0)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:o.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:o}));var v=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var S=this.createRenderPass({colorAttachment:[o],colorResolveTo:[f],colorClearColor:[DA]}),O=this.getCanvas(),L=O.width,k=O.height;S.setPipeline(this.blitRenderPipeline),S.setBindings(this.blitBindings),S.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),S.setViewport(0,0,L,k),this.gl.disable(this.gl.BLEND),S.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=v,this.inBlitRenderPass=!1},a}(),tS=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,go.mG)(this,void 0,void 0,function(){var f,v,S,O,L,k,V,Q,st,ft,Tt,se,Ve;return(0,go.Jh)(this,function(yn){return f=this.pluginOptions,v=f.targets,S=f.xrCompatible,O=f.antialias,L=O===void 0?!1:O,k=f.preserveDrawingBuffer,V=k===void 0?!1:k,Q=f.premultipliedAlpha,st=Q===void 0?!0:Q,ft=f.shaderDebug,Tt=f.trackResources,se={antialias:L,preserveDrawingBuffer:V,stencil:!0,premultipliedAlpha:st,xrCompatible:S},this.handleContextEvents(o),v.includes("webgl2")&&(Ve=o.getContext("webgl2",se)||o.getContext("experimental-webgl2",se)),!Ve&&v.includes("webgl1")&&(Ve=o.getContext("webgl",se)||o.getContext("experimental-webgl",se)),[2,new c3(Ve,{shaderDebug:ft,trackResources:Tt})]})})},a.prototype.handleContextEvents=function(o){var f=this.pluginOptions,v=f.onContextLost,S=f.onContextRestored,O=f.onContextCreationError;O&&o.addEventListener("webglcontextcreationerror",O,!1),v&&o.addEventListener("webglcontextlost",v,!1),S&&o.addEventListener("webglcontextrestored",S,!1)},a}();let oc;const S0=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&S0.decode();let Cg=null;function m1(){return(Cg===null||Cg.byteLength===0)&&(Cg=new Uint8Array(oc.memory.buffer)),Cg}function v1(a,o){return a=a>>>0,S0.decode(m1().subarray(a,a+o))}const Q0=new Array(128).fill(void 0);Q0.push(void 0,null,!0,!1);let Wy=Q0.length;function u3(a){Wy===Q0.length&&Q0.push(Q0.length+1);const o=Wy;return Wy=Q0[o],Q0[o]=a,o}function g1(a){return Q0[a]}function eS(a){a<132||(Q0[a]=Wy,Wy=a)}function y1(a){const o=g1(a);return eS(a),o}let Pv=0;const Xy=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},f3=typeof Xy.encodeInto=="function"?function(a,o){return Xy.encodeInto(a,o)}:function(a,o){const f=Xy.encode(a);return o.set(f),{read:a.length,written:f.length}};function Pd(a,o,f){if(f===void 0){const k=Xy.encode(a),V=o(k.length,1)>>>0;return m1().subarray(V,V+k.length).set(k),Pv=k.length,V}let v=a.length,S=o(v,1)>>>0;const O=m1();let L=0;for(;L<v;L++){const k=a.charCodeAt(L);if(k>127)break;O[S+L]=k}if(L!==v){L!==0&&(a=a.slice(L)),S=f(S,v,v=L+a.length*3,1)>>>0;const k=m1().subarray(S+L,S+v),V=f3(a,k);L+=V.written}return Pv=L,S}let Yy=null;function _1(){return(Yy===null||Yy.byteLength===0)&&(Yy=new Int32Array(oc.memory.buffer)),Yy}function nS(a,o,f){let v,S;try{const k=oc.__wbindgen_add_to_stack_pointer(-16),V=Pd(a,oc.__wbindgen_malloc,oc.__wbindgen_realloc),Q=Pv,st=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),ft=Pv;oc.glsl_compile(k,V,Q,st,ft,f);var O=_1()[k/4+0],L=_1()[k/4+1];return v=O,S=L,v1(O,L)}finally{oc.__wbindgen_add_to_stack_pointer(16),oc.__wbindgen_free(v,S,1)}}class qy{static __wrap(o){o=o>>>0;const f=Object.create(qy.prototype);return f.__wbg_ptr=o,f}__destroy_into_raw(){const o=this.__wbg_ptr;return this.__wbg_ptr=0,o}free(){const o=this.__destroy_into_raw();oc.__wbg_wgslcomposer_free(o)}constructor(){const o=oc.wgslcomposer_new();return qy.__wrap(o)}load_composable(o){const f=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),v=Pv;oc.wgslcomposer_load_composable(this.__wbg_ptr,f,v)}wgsl_compile(o){let f,v;try{const L=oc.__wbindgen_add_to_stack_pointer(-16),k=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),V=Pv;oc.wgslcomposer_wgsl_compile(L,this.__wbg_ptr,k,V);var S=_1()[L/4+0],O=_1()[L/4+1];return f=S,v=O,v1(S,O)}finally{oc.__wbindgen_add_to_stack_pointer(16),oc.__wbindgen_free(f,v,1)}}}function x1(a,o){return BM(this,null,function*(){if(typeof Response=="function"&&a instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(a,o)}catch(v){if(a.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",v);else throw v}const f=yield a.arrayBuffer();return yield WebAssembly.instantiate(f,o)}else{const f=yield WebAssembly.instantiate(a,o);return f instanceof WebAssembly.Instance?{instance:f,module:a}:f}})}function rS(){const a={};return a.wbg={},a.wbg.__wbindgen_string_new=function(o,f){const v=v1(o,f);return u3(v)},a.wbg.__wbindgen_object_drop_ref=function(o){y1(o)},a.wbg.__wbg_log_1d3ae0273d8f4f8a=function(o){console.log(g1(o))},a.wbg.__wbg_log_576ca876af0d4a77=function(o,f){console.log(g1(o),g1(f))},a.wbg.__wbindgen_throw=function(o,f){throw new Error(v1(o,f))},a}function iS(a,o){return oc=a.exports,ob.__wbindgen_wasm_module=o,Yy=null,Cg=null,oc}function ob(a){return BM(this,null,function*(){if(oc!==void 0)return oc;const o=rS();(typeof a=="string"||typeof Request=="function"&&a instanceof Request||typeof URL=="function"&&a instanceof URL)&&(a=fetch(a));const{instance:f,module:v}=yield x1(yield a,o);return iS(f,v)})}var Qu;(function(a){a[a.COPY_SRC=1]="COPY_SRC",a[a.COPY_DST=2]="COPY_DST",a[a.TEXTURE_BINDING=4]="TEXTURE_BINDING",a[a.STORAGE_BINDING=8]="STORAGE_BINDING",a[a.STORAGE=8]="STORAGE",a[a.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Qu||(Qu={}));var ab;(function(a){a[a.READ=1]="READ",a[a.WRITE=2]="WRITE"})(ab||(ab={}));function h3(a){var o=0;return a&hu.SAMPLED&&(o|=Qu.TEXTURE_BINDING|Qu.COPY_DST|Qu.COPY_SRC),a&hu.STORAGE&&(o|=Qu.TEXTURE_BINDING|Qu.STORAGE_BINDING|Qu.COPY_SRC|Qu.COPY_DST),a&hu.RENDER_TARGET&&(o|=Qu.RENDER_ATTACHMENT|Qu.TEXTURE_BINDING|Qu.COPY_SRC|Qu.COPY_DST),o}function b1(a){if(a===$n.U8_R_NORM)return"r8unorm";if(a===$n.S8_R_NORM)return"r8snorm";if(a===$n.U8_RG_NORM)return"rg8unorm";if(a===$n.S8_RG_NORM)return"rg8snorm";if(a===$n.U32_R)return"r32uint";if(a===$n.S32_R)return"r32sint";if(a===$n.F32_R)return"r32float";if(a===$n.U16_RG)return"rg16uint";if(a===$n.S16_RG)return"rg16sint";if(a===$n.F16_RG)return"rg16float";if(a===$n.U8_RGBA_RT)return"bgra8unorm";if(a===$n.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(a===$n.U8_RGBA_NORM)return"rgba8unorm";if(a===$n.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(a===$n.S8_RGBA_NORM)return"rgba8snorm";if(a===$n.U32_RG)return"rg32uint";if(a===$n.S32_RG)return"rg32sint";if(a===$n.F32_RG)return"rg32float";if(a===$n.U16_RGBA)return"rgba16uint";if(a===$n.S16_RGBA)return"rgba16sint";if(a===$n.F16_RGBA)return"rgba16float";if(a===$n.F32_RGBA)return"rgba32float";if(a===$n.U32_RGBA)return"rgba32uint";if(a===$n.S32_RGBA)return"rgba32sint";if(a===$n.D24)return"depth24plus";if(a===$n.D24_S8)return"depth24plus-stencil8";if(a===$n.D32F)return"depth32float";if(a===$n.D32F_S8)return"depth32float-stencil8";if(a===$n.BC1)return"bc1-rgba-unorm";if(a===$n.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(a===$n.BC2)return"bc2-rgba-unorm";if(a===$n.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(a===$n.BC3)return"bc3-rgba-unorm";if(a===$n.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(a===$n.BC4_SNORM)return"bc4-r-snorm";if(a===$n.BC4_UNORM)return"bc4-r-unorm";if(a===$n.BC5_SNORM)return"bc5-rg-snorm";if(a===$n.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function p3(a){if(a===ts.TEXTURE_2D)return"2d";if(a===ts.TEXTURE_CUBE_MAP)return"2d";if(a===ts.TEXTURE_2D_ARRAY)return"2d";if(a===ts.TEXTURE_3D)return"3d";throw new Error("whoops")}function m3(a){if(a===ts.TEXTURE_2D)return"2d";if(a===ts.TEXTURE_CUBE_MAP)return"cube";if(a===ts.TEXTURE_2D_ARRAY)return"2d-array";if(a===ts.TEXTURE_3D)return"3d";throw new Error("whoops")}function v3(a){var o=0;return a&_s.INDEX&&(o|=GPUBufferUsage.INDEX),a&_s.VERTEX&&(o|=GPUBufferUsage.VERTEX),a&_s.UNIFORM&&(o|=GPUBufferUsage.UNIFORM),a&_s.STORAGE&&(o|=GPUBufferUsage.STORAGE),a&_s.COPY_SRC&&(o|=GPUBufferUsage.COPY_SRC),a&_s.INDIRECT&&(o|=GPUBufferUsage.INDIRECT),o|=GPUBufferUsage.COPY_DST,o}function sb(a){if(a===Cf.CLAMP_TO_EDGE)return"clamp-to-edge";if(a===Cf.REPEAT)return"repeat";if(a===Cf.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function oS(a){if(a===ia.BILINEAR)return"linear";if(a===ia.POINT)return"nearest";throw new Error("whoops")}function g3(a){if(a===Zl.LINEAR)return"linear";if(a===Zl.NEAREST)return"nearest";if(a===Zl.NO_MIP)return"nearest";throw new Error("whoops")}function Rg(a){var o=a;return o.gpuBuffer}function y3(a){var o=a;return o.gpuSampler}function _3(a){var o=a;return o.querySet}function x3(a){if(a===e1.OcclusionConservative)return"occlusion";throw new Error("whoops")}function aS(a){switch(a){case Pl.TRIANGLES:return"triangle-list";case Pl.POINTS:return"point-list";case Pl.TRIANGLE_STRIP:return"triangle-strip";case Pl.LINES:return"line-list";case Pl.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function zm(a){if(a===ld.NONE)return"none";if(a===ld.FRONT)return"front";if(a===ld.BACK)return"back";throw new Error("whoops")}function sS(a){if(a===ky.CCW)return"ccw";if(a===ky.CW)return"cw";throw new Error("whoops")}function b3(a,o){return{topology:aS(a),cullMode:zm(o.cullMode),frontFace:sS(o.frontFace)}}function lS(a){if(a===os.ZERO)return"zero";if(a===os.ONE)return"one";if(a===os.SRC)return"src";if(a===os.ONE_MINUS_SRC)return"one-minus-src";if(a===os.DST)return"dst";if(a===os.ONE_MINUS_DST)return"one-minus-dst";if(a===os.SRC_ALPHA)return"src-alpha";if(a===os.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(a===os.DST_ALPHA)return"dst-alpha";if(a===os.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(a===os.CONST)return"constant";if(a===os.ONE_MINUS_CONSTANT)return"one-minus-constant";if(a===os.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function E3(a){if(a===hf.ADD)return"add";if(a===hf.SUBSTRACT)return"subtract";if(a===hf.REVERSE_SUBSTRACT)return"reverse-subtract";if(a===hf.MIN)return"min";if(a===hf.MAX)return"max";throw new Error("whoops")}function lb(a){return{operation:E3(a.blendMode),srcFactor:lS(a.blendSrcFactor),dstFactor:lS(a.blendDstFactor)}}function $y(a){return a.blendMode===hf.ADD&&a.blendSrcFactor===os.ONE&&a.blendDstFactor===os.ZERO}function PP(a){if(!($y(a.rgbBlendState)&&$y(a.alphaBlendState)))return{color:lb(a.rgbBlendState),alpha:lb(a.alphaBlendState)}}function IP(a,o){return{format:b1(o),blend:PP(a),writeMask:a.channelWriteMask}}function LP(a,o){return o.attachmentsState.map(function(f,v){return IP(f,a[v])})}function cb(a){if(a===Ha.NEVER)return"never";if(a===Ha.LESS)return"less";if(a===Ha.EQUAL)return"equal";if(a===Ha.LEQUAL)return"less-equal";if(a===Ha.GREATER)return"greater";if(a===Ha.NOTEQUAL)return"not-equal";if(a===Ha.GEQUAL)return"greater-equal";if(a===Ha.ALWAYS)return"always";throw new Error("whoops")}function Ky(a){if(a===Oc.KEEP)return"keep";if(a===Oc.REPLACE)return"replace";if(a===Oc.ZERO)return"zero";if(a===Oc.DECREMENT_CLAMP)return"decrement-clamp";if(a===Oc.DECREMENT_WRAP)return"decrement-wrap";if(a===Oc.INCREMENT_CLAMP)return"increment-clamp";if(a===Oc.INCREMENT_WRAP)return"increment-wrap";if(a===Oc.INVERT)return"invert";throw new Error("whoops")}function DP(a,o){if(!(0,Of.Z)(a))return{format:b1(a),depthWriteEnabled:!!o.depthWrite,depthCompare:cb(o.depthCompare),depthBias:o.polygonOffset?o.polygonOffsetUnits:0,depthBiasSlopeScale:o.polygonOffset?o.polygonOffsetFactor:0,stencilFront:{compare:cb(o.stencilFront.compare),passOp:Ky(o.stencilFront.passOp),failOp:Ky(o.stencilFront.failOp),depthFailOp:Ky(o.stencilFront.depthFailOp)},stencilBack:{compare:cb(o.stencilBack.compare),passOp:Ky(o.stencilBack.passOp),failOp:Ky(o.stencilBack.failOp),depthFailOp:Ky(o.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function NP(a){if(a!==null){if(a===$n.U16_R)return"uint16";if(a===$n.U32_R)return"uint32";throw new Error("whoops")}}function E1(a){if(a===Av.VERTEX)return"vertex";if(a===Av.INSTANCE)return"instance";throw new Error("whoops")}function S3(a){if(a===$n.U8_R)return"uint8x2";if(a===$n.U8_RG)return"uint8x2";if(a===$n.U8_RGB)return"uint8x4";if(a===$n.U8_RGBA)return"uint8x4";if(a===$n.U8_RG_NORM)return"unorm8x2";if(a===$n.U8_RGBA_NORM)return"unorm8x4";if(a===$n.S8_RGB_NORM)return"snorm8x4";if(a===$n.S8_RGBA_NORM)return"snorm8x4";if(a===$n.U16_RG_NORM)return"unorm16x2";if(a===$n.U16_RGBA_NORM)return"unorm16x4";if(a===$n.S16_RG_NORM)return"snorm16x2";if(a===$n.S16_RGBA_NORM)return"snorm16x4";if(a===$n.S16_RG)return"uint16x2";if(a===$n.F16_RG)return"float16x2";if(a===$n.F16_RGBA)return"float16x4";if(a===$n.F32_R)return"float32";if(a===$n.F32_RG)return"float32x2";if(a===$n.F32_RGB)return"float32x3";if(a===$n.F32_RGBA)return"float32x4";throw"whoops"}function ub(a){var o=fh(a);switch(o){case ii.BC1:case ii.BC2:case ii.BC3:case ii.BC4_SNORM:case ii.BC4_UNORM:case ii.BC5_SNORM:case ii.BC5_UNORM:return!0;default:return!1}}function T3(a){var o=fh(a);switch(o){case ii.BC1:case ii.BC2:case ii.BC3:case ii.BC4_SNORM:case ii.BC4_UNORM:case ii.BC5_SNORM:case ii.BC5_UNORM:return 4;default:return 1}}function fb(a,o,f,v){switch(f===void 0&&(f=!1),a){case $n.S8_R:case $n.S8_R_NORM:case $n.S8_RG_NORM:case $n.S8_RGB_NORM:case $n.S8_RGBA_NORM:{var S=o instanceof ArrayBuffer?new Int8Array(o):new Int8Array(o);return v&&S.set(new Int8Array(v)),S}case $n.U8_R:case $n.U8_R_NORM:case $n.U8_RG:case $n.U8_RG_NORM:case $n.U8_RGB:case $n.U8_RGB_NORM:case $n.U8_RGB_SRGB:case $n.U8_RGBA:case $n.U8_RGBA_NORM:case $n.U8_RGBA_SRGB:{var O=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&O.set(new Uint8Array(v)),O}case $n.S16_R:case $n.S16_RG:case $n.S16_RG_NORM:case $n.S16_RGB_NORM:case $n.S16_RGBA:case $n.S16_RGBA_NORM:{var L=o instanceof ArrayBuffer?new Int16Array(o):new Int16Array(f?o/2:o);return v&&L.set(new Int16Array(v)),L}case $n.U16_R:case $n.U16_RGB:case $n.U16_RGBA_5551:case $n.U16_RGBA_NORM:case $n.U16_RG_NORM:case $n.U16_R_NORM:{var k=o instanceof ArrayBuffer?new Uint16Array(o):new Uint16Array(f?o/2:o);return v&&k.set(new Uint16Array(v)),k}case $n.S32_R:{var V=o instanceof ArrayBuffer?new Int32Array(o):new Int32Array(f?o/4:o);return v&&V.set(new Int32Array(v)),V}case $n.U32_R:case $n.U32_RG:{var Q=o instanceof ArrayBuffer?new Uint32Array(o):new Uint32Array(f?o/4:o);return v&&Q.set(new Uint32Array(v)),Q}case $n.F32_R:case $n.F32_RG:case $n.F32_RGB:case $n.F32_RGBA:{var st=o instanceof ArrayBuffer?new Float32Array(o):new Float32Array(f?o/4:o);return v&&st.set(new Float32Array(v)),st}}var ft=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&ft.set(new Uint8Array(v)),ft}function cS(a){var o=(a&32768)>>15,f=(a&31744)>>10,v=a&1023;return f===0?(o?-1:1)*Math.pow(2,-14)*(v/Math.pow(2,10)):f==31?v?NaN:(o?-1:1)*(1/0):(o?-1:1)*Math.pow(2,f-15)*(1+v/Math.pow(2,10))}function hb(a){switch(a){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var Ju=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=a.call(this)||this;return O.id=v,O.device=S,O}return o.prototype.destroy=function(){},o}(CE),jm=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L,k,V=a.call(this,{id:v,device:S})||this;V.type=Ls.Bindings;var Q=O.pipeline;Ma(!!Q);var st=O.uniformBufferBindings,ft=O.storageBufferBindings,Tt=O.samplerBindings,se=O.storageTextureBindings;V.numUniformBuffers=(st==null?void 0:st.length)||0;var Ve=[[],[],[],[]],yn=0;if(st&&st.length)for(var lr=0;lr<st.length;lr++){var Nr=O.uniformBufferBindings[lr],Ln=Nr.binding,ci=Nr.size,Fi=Nr.offset,So=Nr.buffer,Ji={buffer:Rg(So),offset:Fi!=null?Fi:0,size:ci};Ve[0].push({binding:Ln!=null?Ln:yn++,resource:Ji})}if(Tt&&Tt.length){yn=0;for(var lr=0;lr<Tt.length;lr++){var Vr=(0,go.pi)((0,go.pi)({},Tt[lr]),kE),Ln=O.samplerBindings[lr],Hi=Ln.texture!==null?Ln.texture:V.device.getFallbackTexture(Vr);Vr.dimension=Hi.dimension,Vr.formatKind=r1(Hi.format);var za=Hi.gpuTextureView;if(Ve[1].push({binding:(L=Ln.textureBinding)!==null&&L!==void 0?L:yn++,resource:za}),Ln.samplerBinding!==-1){var ps=Ln.sampler!==null?Ln.sampler:V.device.getFallbackSampler(Vr),Wo=y3(ps);Ve[1].push({binding:(k=Ln.samplerBinding)!==null&&k!==void 0?k:yn++,resource:Wo})}}}if(ft&&ft.length){yn=0;for(var lr=0;lr<ft.length;lr++){var as=O.storageBufferBindings[lr],Ln=as.binding,ci=as.size,Fi=as.offset,So=as.buffer,Ji={buffer:Rg(So),offset:Fi!=null?Fi:0,size:ci};Ve[2].push({binding:Ln!=null?Ln:yn++,resource:Ji})}}if(se&&se.length){yn=0;for(var lr=0;lr<se.length;lr++){var Zs=O.storageTextureBindings[lr],Ln=Zs.binding,Hi=Zs.texture,za=Hi.gpuTextureView;Ve[3].push({binding:Ln!=null?Ln:yn++,resource:za})}}var Dh=Ve.findLastIndex(function(Id){return!!Id.length});return V.gpuBindGroup=Ve.map(function(Id,Nh){return Nh<=Dh&&V.device.device.createBindGroup({layout:Q.getBindGroupLayout(Nh),entries:Id})}),V}return o}(Ju),w3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.Buffer;var k=O.usage,V=O.viewOrSize,Q=!!(k&_s.MAP_READ);L.usage=v3(k),Q&&(L.usage=_s.MAP_READ|_s.COPY_DST);var st=!(0,cp.Z)(V);if(L.view=(0,cp.Z)(V)?null:V,L.size=(0,cp.Z)(V)?Ku(V,4):Ku(V.byteLength,4),(0,cp.Z)(V))L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:Q?st:!1});else{L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:!0});var ft=V&&V.constructor||Float32Array;new ft(L.gpuBuffer.getMappedRange()).set(V),L.gpuBuffer.unmap()}return L}return o.prototype.setSubData=function(f,v,S,O){S===void 0&&(S=0),O===void 0&&(O=0);var L=this.gpuBuffer;O=O||v.byteLength,O=Math.min(O,this.size-f);var k=v.byteOffset+S,V=k+O,Q=O+3&-4;if(Q!==O){var st=new Uint8Array(v.buffer.slice(k,V));v=new Uint8Array(Q),v.set(st),S=0,k=0,V=Q,O=Q}for(var ft=1024*1024*15,Tt=0;V-(k+Tt)>ft;)this.device.device.queue.writeBuffer(L,f+Tt,v.buffer,k+Tt,ft),Tt+=ft;this.device.device.queue.writeBuffer(L,f+Tt,v.buffer,k+Tt,O-Tt)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuBuffer.destroy()},o}(Ju),db=function(){function a(){this.gpuComputePassEncoder=null}return a.prototype.dispatchWorkgroups=function(o,f,v){this.gpuComputePassEncoder.dispatchWorkgroups(o,f,v)},a.prototype.dispatchWorkgroupsIndirect=function(o,f){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(o.gpuBuffer,f)},a.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},a.prototype.beginComputePass=function(o){Ma(this.gpuComputePassEncoder===null),this.frameCommandEncoder=o,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},a.prototype.setPipeline=function(o){var f=o,v=Ov(f.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(v)},a.prototype.setBindings=function(o){var f=this,v=o;v.gpuBindGroup.forEach(function(S,O){S&&f.gpuComputePassEncoder.setBindGroup(O,v.gpuBindGroup[O])})},a.prototype.pushDebugGroup=function(o){this.gpuComputePassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuComputePassEncoder.insertDebugMarker(o)},a}(),uS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.ComputePipeline,L.gpuComputePipeline=null,L.descriptor=O;var k=O.program,V=k.computeStage;if(V===null)return L;var Q={layout:"auto",compute:(0,go.pi)({},V)};return L.gpuComputePipeline=L.device.device.createComputePipeline(Q),L.name!==void 0&&(L.gpuComputePipeline.label=L.name),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuComputePipeline.getBindGroupLayout(f)},o}(Ju),A3=function(a){(0,go.ZT)(o,a);function o(f){var v,S,O,L,k=f.id,V=f.device,Q=f.descriptor,st=a.call(this,{id:k,device:V})||this;st.type=Ls.InputLayout;var ft=[];try{for(var Tt=(0,go.XA)(Q.vertexBufferDescriptors),se=Tt.next();!se.done;se=Tt.next()){var Ve=se.value,yn=Ve.arrayStride,lr=Ve.stepMode,Nr=Ve.attributes;ft.push({arrayStride:yn,stepMode:E1(lr),attributes:[]});try{for(var Ln=(O=void 0,(0,go.XA)(Nr)),ci=Ln.next();!ci.done;ci=Ln.next()){var Fi=ci.value,So=Fi.shaderLocation,Ji=Fi.format,Vr=Fi.offset;ft[ft.length-1].attributes.push({shaderLocation:So,format:S3(Ji),offset:Vr})}}catch(Hi){O={error:Hi}}finally{try{ci&&!ci.done&&(L=Ln.return)&&L.call(Ln)}finally{if(O)throw O.error}}}}catch(Hi){v={error:Hi}}finally{try{se&&!se.done&&(S=Tt.return)&&S.call(Tt)}finally{if(v)throw v.error}}return st.indexFormat=NP(Q.indexBufferFormat),st.buffers=ft,st}return o}(Ju),fS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;return L.type=Ls.Program,L.vertexStage=null,L.fragmentStage=null,L.computeStage=null,L.descriptor=O,O.vertex&&(L.vertexStage=L.createShaderStage(O.vertex,"vertex")),O.fragment&&(L.fragmentStage=L.createShaderStage(O.fragment,"fragment")),O.compute&&(L.computeStage=L.createShaderStage(O.compute,"compute")),L}return o.prototype.setUniformsLegacy=function(f){},o.prototype.createShaderStage=function(f,v){var S,O,L=f.glsl,k=f.wgsl,V=f.entryPoint,Q=f.postprocess,st=!1,ft=k;if(!ft)try{ft=this.device.glsl_compile(L,v,st)}catch(Nr){throw console.error(Nr,L),new Error("whoops")}var Tt=function(Nr){if(!ft.includes(Nr))return"continue";ft=ft.replace("var T_".concat(Nr,": texture_2d<f32>;"),"var T_".concat(Nr,": texture_depth_2d;")),ft=ft.replace(new RegExp("textureSample\\(T_".concat(Nr,"(.*)\\);$"),"gm"),function(Ln,ci){return"vec4<f32>(textureSample(T_".concat(Nr).concat(ci,"), 0.0, 0.0, 0.0);")})};try{for(var se=(0,go.XA)(["u_TextureFramebufferDepth"]),Ve=se.next();!Ve.done;Ve=se.next()){var yn=Ve.value;Tt(yn)}}catch(Nr){S={error:Nr}}finally{try{Ve&&!Ve.done&&(O=se.return)&&O.call(se)}finally{if(S)throw S.error}}Q&&(ft=Q(ft));var lr=this.device.device.createShaderModule({code:ft});return{module:lr,entryPoint:V||"main"}},o}(Ju),O3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;L.type=Ls.QueryPool;var k=O.elemCount,V=O.type;return L.querySet=L.device.device.createQuerySet({type:x3(V),count:k}),L.resolveBuffer=L.device.device.createBuffer({size:k*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),L.cpuBuffer=L.device.device.createBuffer({size:k*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),L.results=null,L}return o.prototype.queryResultOcclusion=function(f){return this.results===null?null:this.results[f]!==BigInt(0)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},o}(Ju),C3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=a.call(this,{id:v,device:S})||this;return O.type=Ls.Readback,O}return o.prototype.readTexture=function(f,v,S,O,L,k,V,Q){return V===void 0&&(V=0),(0,go.mG)(this,void 0,void 0,function(){var st,ft,Tt,se,Ve,yn,lr,Nr;return(0,go.Jh)(this,function(Ln){return st=f,ft=0,Tt=hb(st.gpuTextureformat),se=Math.ceil(O/Tt.width)*Tt.length,Ve=Math.ceil(se/256)*256,yn=Ve*L,lr=this.device.createBuffer({usage:_s.STORAGE|_s.MAP_READ|_s.COPY_DST,hint:cd.STATIC,viewOrSize:yn}),Nr=this.device.device.createCommandEncoder(),Nr.copyTextureToBuffer({texture:st.gpuTexture,mipLevel:0,origin:{x:v,y:S,z:Math.max(ft,0)}},{buffer:lr.gpuBuffer,offset:0,bytesPerRow:Ve},{width:O,height:L,depthOrArrayLayers:1}),this.device.device.queue.submit([Nr.finish()]),[2,this.readBuffer(lr,0,k.byteLength===yn?k:null,V,yn,st.format,!0,!1,se,Ve,L)]})})},o.prototype.readTextureSync=function(f,v,S,O,L,k,V,Q){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},o.prototype.readBuffer=function(f,v,S,O,L,k,V,Q,st,ft,Tt){var se=this;v===void 0&&(v=0),S===void 0&&(S=null),L===void 0&&(L=0),k===void 0&&(k=$n.U8_RGB),V===void 0&&(V=!1),st===void 0&&(st=0),ft===void 0&&(ft=0),Tt===void 0&&(Tt=0);var Ve=f,yn=L||Ve.size,lr=S||Ve.view,Nr=lr&&lr.constructor&&lr.constructor.BYTES_PER_ELEMENT||Zx(k),Ln=Ve;if(!(Ve.usage&_s.MAP_READ&&Ve.usage&_s.COPY_DST)){var ci=this.device.device.createCommandEncoder();Ln=this.device.createBuffer({usage:_s.STORAGE|_s.MAP_READ|_s.COPY_DST,hint:cd.STATIC,viewOrSize:yn}),ci.copyBufferToBuffer(Ve.gpuBuffer,v,Ln.gpuBuffer,0,yn),this.device.device.queue.submit([ci.finish()])}return new Promise(function(Fi,So){Ln.gpuBuffer.mapAsync(ab.READ,v,yn).then(function(){var Ji=Ln.gpuBuffer.getMappedRange(v,yn),Vr=lr;if(V)Vr===null?Vr=fb(k,yn,!0,Ji):Vr=fb(k,Vr.buffer,void 0,Ji);else if(Vr===null)switch(Nr){case 1:Vr=new Uint8Array(yn),Vr.set(new Uint8Array(Ji));break;case 2:Vr=se.getHalfFloatAsFloatRGBAArrayBuffer(yn/2,Ji);break;case 4:Vr=new Float32Array(yn/4),Vr.set(new Float32Array(Ji));break}else switch(Nr){case 1:Vr=new Uint8Array(Vr.buffer),Vr.set(new Uint8Array(Ji));break;case 2:Vr=se.getHalfFloatAsFloatRGBAArrayBuffer(yn/2,Ji,lr);break;case 4:var Hi=lr&&lr.constructor||Float32Array;Vr=new Hi(Vr.buffer),Vr.set(new Hi(Ji));break}if(st!==ft){Nr===1&&!V&&(st*=2,ft*=2);for(var za=new Uint8Array(Vr.buffer),ps=st,Wo=0,as=1;as<Tt;++as){Wo=as*ft;for(var Zs=0;Zs<st;++Zs)za[ps++]=za[Wo++]}Nr!==0&&!V?Vr=new Float32Array(za.buffer,0,ps/4):Vr=new Uint8Array(za.buffer,0,ps)}Ln.gpuBuffer.unmap(),Fi(Vr)},function(Ji){return So(Ji)})})},o.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(f,v,S){S||(S=new Float32Array(f));for(var O=new Uint16Array(v);f--;)S[f]=cS(O[f]);return S},o}(Ju),hS=function(){function a(o){this.device=o,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return a.prototype.getEncoder=function(){var o;return((o=this.renderBundle)===null||o===void 0?void 0:o.renderBundleEncoder)||this.gpuRenderPassEncoder},a.prototype.getTextureView=function(o,f){return Ma(f<o.mipLevelCount),o.mipLevelCount===1?o.gpuTextureView:o.gpuTexture.createView({baseMipLevel:f,mipLevelCount:1})},a.prototype.setRenderPassDescriptor=function(o){var f,v,S,O,L,k;this.descriptor=o,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var V=o.colorAttachment.length;this.gfxColorAttachment.length=V,this.gfxColorResolveTo.length=V;for(var Q=0;Q<o.colorAttachment.length;Q++){var st=o.colorAttachment[Q],ft=o.colorResolveTo[Q];if(st===null&&ft!==null&&(st=ft,ft=null),this.gfxColorAttachment[Q]=st,this.gfxColorResolveTo[Q]=ft,this.gfxColorAttachmentLevel[Q]=((f=o.colorAttachmentLevel)===null||f===void 0?void 0:f[Q])||0,this.gfxColorResolveToLevel[Q]=((v=o.colorResolveToLevel)===null||v===void 0?void 0:v[Q])||0,st!==null){this.gpuColorAttachments[Q]===void 0&&(this.gpuColorAttachments[Q]={});var Tt=this.gpuColorAttachments[Q];Tt.view=this.getTextureView(st,((S=this.gfxColorAttachmentLevel)===null||S===void 0?void 0:S[Q])||0);var se=(L=(O=o.colorClearColor)===null||O===void 0?void 0:O[Q])!==null&&L!==void 0?L:"load";se==="load"?Tt.loadOp="load":(Tt.loadOp="clear",Tt.clearValue=se),Tt.storeOp=!((k=o.colorStore)===null||k===void 0)&&k[Q]?"store":"discard",Tt.resolveTarget=void 0,ft!==null&&(st.sampleCount>1?Tt.resolveTarget=this.getTextureView(ft,this.gfxColorResolveToLevel[Q]):Tt.storeOp="store")}else{this.gpuColorAttachments.length=Q,this.gfxColorAttachment.length=Q,this.gfxColorResolveTo.length=Q;break}}if(this.gfxDepthStencilAttachment=o.depthStencilAttachment,this.gfxDepthStencilResolveTo=o.depthStencilResolveTo,o.depthStencilAttachment){var Ve=o.depthStencilAttachment,Tt=this.gpuDepthStencilAttachment;Tt.view=Ve.gpuTextureView;var yn=!!(Nm(Ve.format)&po.Depth);yn?(o.depthClearValue==="load"?Tt.depthLoadOp="load":(Tt.depthLoadOp="clear",Tt.depthClearValue=o.depthClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Tt.depthStoreOp="store":Tt.depthStoreOp="discard"):(Tt.depthLoadOp=void 0,Tt.depthStoreOp=void 0);var lr=!!(Nm(Ve.format)&po.Stencil);lr?(o.stencilClearValue==="load"?Tt.stencilLoadOp="load":(Tt.stencilLoadOp="clear",Tt.stencilClearValue=o.stencilClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Tt.stencilStoreOp="store":Tt.stencilStoreOp="discard"):(Tt.stencilLoadOp=void 0,Tt.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,Of.Z)(o.occlusionQueryPool)?void 0:_3(o.occlusionQueryPool)},a.prototype.beginRenderPass=function(o,f){Ma(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(f),this.frameCommandEncoder=o,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},a.prototype.flipY=function(o,f){var v=this.device.swapChainHeight;return v-o-f},a.prototype.setViewport=function(o,f,v,S,O,L){O===void 0&&(O=0),L===void 0&&(L=1),this.gpuRenderPassEncoder.setViewport(o,this.flipY(f,S),v,S,O,L)},a.prototype.setScissorRect=function(o,f,v,S){this.gpuRenderPassEncoder.setScissorRect(o,this.flipY(f,S),v,S)},a.prototype.setPipeline=function(o){var f=o,v=Ov(f.gpuRenderPipeline);this.getEncoder().setPipeline(v)},a.prototype.setVertexInput=function(o,f,v){if(o!==null){var S=this.getEncoder(),O=o;v!==null&&S.setIndexBuffer(Rg(v.buffer),Ov(O.indexFormat),v.offset);for(var L=0;L<f.length;L++){var k=f[L];k!==null&&S.setVertexBuffer(L,Rg(k.buffer),k.offset)}}},a.prototype.setBindings=function(o){var f=o,v=this.getEncoder();f.gpuBindGroup.forEach(function(S,O){S&&v.setBindGroup(O,f.gpuBindGroup[O])})},a.prototype.setStencilReference=function(o){this.gpuRenderPassEncoder.setStencilReference(o)},a.prototype.draw=function(o,f,v,S){this.getEncoder().draw(o,f,v,S)},a.prototype.drawIndexed=function(o,f,v,S,O){this.getEncoder().drawIndexed(o,f,v,S,O)},a.prototype.drawIndirect=function(o,f){this.getEncoder().drawIndirect(Rg(o),f)},a.prototype.drawIndexedIndirect=function(o,f){this.getEncoder().drawIndexedIndirect(Rg(o),f)},a.prototype.beginOcclusionQuery=function(o){this.gpuRenderPassEncoder.beginOcclusionQuery(o)},a.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},a.prototype.pushDebugGroup=function(o){this.gpuRenderPassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuRenderPassEncoder.insertDebugMarker(o)},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle.finish()},a.prototype.executeBundles=function(o){this.gpuRenderPassEncoder.executeBundles(o.map(function(f){return f.renderBundle}))},a.prototype.finish=function(){var o;(o=this.gpuRenderPassEncoder)===null||o===void 0||o.end(),this.gpuRenderPassEncoder=null;for(var f=0;f<this.gfxColorAttachment.length;f++){var v=this.gfxColorAttachment[f],S=this.gfxColorResolveTo[f];v!==null&&S!==null&&v.sampleCount===1&&this.copyAttachment(S,this.gfxColorAttachmentLevel[f],v,this.gfxColorResolveToLevel[f])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},a.prototype.copyAttachment=function(o,f,v,S){Ma(v.sampleCount===1);var O={texture:v.gpuTexture,mipLevel:S},L={texture:o.gpuTexture,mipLevel:f};Ma(v.width>>>S===o.width>>>f),Ma(v.height>>>S===o.height>>>f),Ma(!!(v.usage&Qu.COPY_SRC)),Ma(!!(o.usage&Qu.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(O,L,[o.width,o.height,1])},a}(),R3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=a.call(this,{id:v,device:S})||this;return L.type=Ls.RenderPipeline,L.isCreatingAsync=!1,L.gpuRenderPipeline=null,L.descriptor=O,L.device.createRenderPipelineInternal(L,!1),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuRenderPipeline.getBindGroupLayout(f)},o}(Ju),M3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L,k,V=a.call(this,{id:v,device:S})||this;V.type=Ls.Sampler;var Q=O.lodMinClamp,st=O.mipmapFilter===Zl.NO_MIP?O.lodMinClamp:O.lodMaxClamp,ft=(L=O.maxAnisotropy)!==null&&L!==void 0?L:1;return ft>1&&Ma(O.minFilter===ia.BILINEAR&&O.magFilter===ia.BILINEAR&&O.mipmapFilter===Zl.LINEAR),V.gpuSampler=V.device.device.createSampler({addressModeU:sb(O.addressModeU),addressModeV:sb(O.addressModeV),addressModeW:sb((k=O.addressModeW)!==null&&k!==void 0?k:O.addressModeU),lodMinClamp:Q,lodMaxClamp:st,minFilter:oS(O.minFilter),magFilter:oS(O.magFilter),mipmapFilter:g3(O.mipmapFilter),compare:O.compareFunction!==void 0?cb(O.compareFunction):void 0,maxAnisotropy:ft}),V}return o}(Ju),Qy=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=f.descriptor,L=f.skipCreate,k=f.sampleCount,V=a.call(this,{id:v,device:S})||this;V.type=Ls.Texture,V.flipY=!1;var Q=O.format,st=O.dimension,ft=O.width,Tt=O.height,se=O.depthOrArrayLayers,Ve=O.mipLevelCount,yn=O.usage,lr=O.pixelStore;return V.flipY=!!(lr!=null&&lr.unpackFlipY),V.device.createTextureShared({format:Q,dimension:st!=null?st:ts.TEXTURE_2D,width:ft,height:Tt,depthOrArrayLayers:se!=null?se:1,mipLevelCount:Ve!=null?Ve:1,usage:yn,sampleCount:k!=null?k:1},V,L),V}return o.prototype.textureFromImageBitmapOrCanvas=function(f,v,S){for(var O=v[0].width,L=v[0].height,k={size:{width:O,height:L,depthOrArrayLayers:S},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},V=f.createTexture(k),Q=0;Q<v.length;Q++)f.queue.copyExternalImageToTexture({source:v[Q],flipY:this.flipY},{texture:V,origin:[0,0,Q]},[O,L]);return[V,O,L]},o.prototype.isImageBitmapOrCanvases=function(f){var v=f[0];return v instanceof ImageBitmap||v instanceof HTMLCanvasElement||v instanceof OffscreenCanvas},o.prototype.isVideo=function(f){var v=f[0];return v instanceof HTMLVideoElement},o.prototype.setImageData=function(f,v){var S,O=this,L=this.device.device,k,V,Q;if(this.isImageBitmapOrCanvases(f))S=(0,go.CR)(this.textureFromImageBitmapOrCanvas(L,f,this.depthOrArrayLayers),3),k=S[0],V=S[1],Q=S[2];else if(this.isVideo(f))k=L.importExternalTexture({source:f[0]});else{var st=hb(this.gpuTextureformat),ft=Math.ceil(this.width/st.width)*st.length;f.forEach(function(Tt){L.queue.writeTexture({texture:O.gpuTexture},Tt,{bytesPerRow:ft},{width:O.width,height:O.height})})}this.width=V,this.height=Q,k&&(this.gpuTexture=k),this.gpuTextureView=this.gpuTexture.createView({dimension:m3(this.dimension)})},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuTexture.destroy()},o}(Ju),P3=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,S=f.device,O=a.call(this,{id:v,device:S})||this;return O.type=Ls.RenderBundle,O.renderBundleEncoder=O.device.device.createRenderBundleEncoder({colorFormats:[O.device.swapChainFormat]}),O}return o.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},o}(Ju),I3=function(){function a(o,f,v,S,O,L){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Qu.RENDER_ATTACHMENT|Qu.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Vp.UPPER_LEFT,this.clipSpaceNearZ=xg.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=f,this.canvas=v,this.canvasContext=S,this.glsl_compile=O,this.WGSLComposer=L,this.fallbackTexture2D=this.createFallbackTexture(ts.TEXTURE_2D,Cc.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(ts.TEXTURE_2D,Cc.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(ts.TEXTURE_2D_ARRAY,Cc.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(ts.TEXTURE_3D,Cc.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(ts.TEXTURE_CUBE_MAP,Cc.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:Cf.REPEAT,addressModeV:Cf.REPEAT,minFilter:ia.POINT,magFilter:ia.POINT,mipmapFilter:Zl.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:Cf.REPEAT,addressModeV:Cf.REPEAT,minFilter:ia.POINT,magFilter:ia.POINT,mipmapFilter:Zl.NEAREST,compareFunction:Ha.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(k){console.error(k.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return a.prototype.destroy=function(){},a.prototype.configureSwapChain=function(o,f){this.swapChainWidth===o&&this.swapChainHeight===f||(this.swapChainWidth=o,this.swapChainHeight=f)},a.prototype.getOnscreenTexture=function(){var o=this.canvasContext.getCurrentTexture(),f=o.createView(),v=new Qy({id:0,device:this,descriptor:{format:$n.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:ts.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return v.depthOrArrayLayers=1,v.sampleCount=1,v.gpuTexture=o,v.gpuTextureView=f,v.name="Onscreen",this.setResourceName(v,"Onscreen Texture"),v},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.canvas},a.prototype.beginFrame=function(){Ma(this.frameCommandEncoderPool.length===0)},a.prototype.endFrame=function(){Ma(this.frameCommandEncoderPool.every(function(o){return o!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(o){return o.finish()})),this.frameCommandEncoderPool=[]},a.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},a.prototype.createBuffer=function(o){return new w3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new Qy({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new M3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){var f=new Qy({id:this.getNextUniqueId(),device:this,descriptor:(0,go.pi)((0,go.pi)({},o),{dimension:ts.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:hu.RENDER_TARGET}),sampleCount:o.sampleCount});return f.depthOrArrayLayers=1,f.type=Ls.RenderTarget,f},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,S=f.width,O=f.height,L=f.depthOrArrayLayers,k=f.sampleCount,V=f.mipLevelCount,Q=f.gpuTexture,st=f.gpuTextureView,ft=f.usage;Ma(!!(ft&Qu.RENDER_ATTACHMENT));var Tt=new Qy({id:this.getNextUniqueId(),device:this,descriptor:{format:v,width:S,height:O,depthOrArrayLayers:L,dimension:ts.TEXTURE_2D,mipLevelCount:V,usage:ft},skipCreate:!0});return Tt.depthOrArrayLayers=L,Tt.sampleCount=k,Tt.gpuTexture=Q,Tt.gpuTextureView=st,Tt},a.prototype.createProgram=function(o){var f,v;return!((f=o.vertex)===null||f===void 0)&&f.glsl&&(o.vertex.glsl=Fm(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((v=o.fragment)===null||v===void 0)&&v.glsl&&(o.fragment.glsl=Fm(this.queryVendorInfo(),"frag",o.fragment.glsl)),new fS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createProgramSimple=function(o){return new fS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTextureShared=function(o,f,v){var S={width:o.width,height:o.height,depthOrArrayLayers:o.depthOrArrayLayers},O=o.mipLevelCount,L=b1(o.format),k=p3(o.dimension),V=h3(o.usage);if(f.gpuTextureformat=L,f.dimension=o.dimension,f.format=o.format,f.width=o.width,f.height=o.height,f.depthOrArrayLayers=o.depthOrArrayLayers,f.mipLevelCount=O,f.usage=V,f.sampleCount=o.sampleCount,!v){var Q=this.device.createTexture({size:S,mipLevelCount:O,format:L,dimension:k,sampleCount:o.sampleCount,usage:V}),st=Q.createView();f.gpuTexture=Q,f.gpuTextureView=st}},a.prototype.getFallbackSampler=function(o){var f=o.formatKind;return f===Cc.Depth&&o.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},a.prototype.getFallbackTexture=function(o){var f=o.dimension,v=o.formatKind;if(f===ts.TEXTURE_2D)return v===Cc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===ts.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===ts.TEXTURE_3D)return this.fallbackTexture3D;if(f===ts.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.createFallbackTexture=function(o,f){var v=o===ts.TEXTURE_CUBE_MAP?6:1,S=f===Cc.Float?$n.U8_RGBA_NORM:$n.D24;return this.createTexture({dimension:o,format:S,usage:hu.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1})},a.prototype.createBindings=function(o){return new jm({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new A3({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePipeline=function(o){return new uS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new R3({id:this.getNextUniqueId(),device:this,descriptor:(0,go.pi)({},o)})},a.prototype.createQueryPool=function(o,f){return new O3({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.createRenderPipelineInternal=function(o,f){var v;if(o.gpuRenderPipeline===null){var S=o.descriptor,O=S.program,L=O.vertexStage,k=O.fragmentStage;if(!(L===null||k===null)){var V=S.megaStateDescriptor||{},Q=V.stencilBack,st=V.stencilFront,ft=(0,go._T)(V,["stencilBack","stencilFront"]),Tt=Cv(b0);S.megaStateDescriptor=(0,go.pi)((0,go.pi)((0,go.pi)({},Tt),{stencilBack:(0,go.pi)((0,go.pi)({},Tt.stencilBack),Q),stencilFront:(0,go.pi)((0,go.pi)({},Tt.stencilFront),st)}),ft);var se=S.megaStateDescriptor.attachmentsState[0];S.colorAttachmentFormats.forEach(function(Fi,So){S.megaStateDescriptor.attachmentsState[So]||(S.megaStateDescriptor.attachmentsState[So]=DE(void 0,se))});var Ve=b3((v=S.topology)!==null&&v!==void 0?v:Pl.TRIANGLES,S.megaStateDescriptor),yn=LP(S.colorAttachmentFormats,S.megaStateDescriptor),lr=DP(S.depthStencilAttachmentFormat,S.megaStateDescriptor),Nr=void 0;S.inputLayout!==null&&(Nr=S.inputLayout.buffers);var Ln=S.sampleCount,ci={layout:"auto",vertex:(0,go.pi)((0,go.pi)({},L),{buffers:Nr}),primitive:Ve,depthStencil:lr,multisample:{count:Ln},fragment:(0,go.pi)((0,go.pi)({},k),{targets:yn})};o.gpuRenderPipeline=this.device.createRenderPipeline(ci)}}},a.prototype.createReadback=function(){return new C3({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderBundle=function(){return new P3({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderPass=function(o){var f=this.renderPassPool.pop();f===void 0&&(f=new hS(this));var v=this.frameCommandEncoderPool.pop();return v===void 0&&(v=this.device.createCommandEncoder()),f.beginRenderPass(v,o),f},a.prototype.createComputePass=function(){var o=this.computePassPool.pop();o===void 0&&(o=new db);var f=this.frameCommandEncoderPool.pop();return f===void 0&&(f=this.device.createCommandEncoder()),o.beginComputePass(f),o},a.prototype.submitPass=function(o){var f=o;f instanceof hS?(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.renderPassPool.push(f)):f instanceof db&&(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.computePassPool.push(f))},a.prototype.copySubTexture2D=function(o,f,v,S,O,L,k){var V=this.device.createCommandEncoder(),Q=o,st=S,ft={texture:st.gpuTexture,origin:[O,L,0],mipLevel:0,aspect:"all"},Tt={texture:Q.gpuTexture,origin:[f,v,0],mipLevel:0,aspect:"all"};Ma(!!(st.usage&Qu.COPY_SRC)),Ma(!!(Q.usage&Qu.COPY_DST)),V.copyTextureToTexture(ft,Tt,[st.width,st.height,k||1]),this.device.queue.submit([V.finish()])},a.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},a.prototype.queryTextureFormatSupported=function(o,f,v){if(ub(o)){if(!this.featureTextureCompressionBC)return!1;var S=T3(o);return f%S!==0||v%S!==0?!1:this.featureTextureCompressionBC}switch(o){case $n.U16_RGBA_NORM:return!1;case $n.F32_RGBA:return!1}return!0},a.prototype.queryPlatformAvailable=function(){return!0},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){var f=o;return f.descriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Ls.Buffer){var v=o;v.gpuBuffer.label=f}else if(o.type===Ls.Texture){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Ls.RenderTarget){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Ls.Sampler){var v=o;v.gpuSampler.label=f}else if(o.type===Ls.RenderPipeline){var v=o;v.gpuRenderPipeline!==null&&(v.gpuRenderPipeline.label=f)}},a.prototype.setResourceLeakCheck=function(o,f){},a.prototype.checkForLeaks=function(){},a.prototype.programPatched=function(o){},a.prototype.pipelineQueryReady=function(o){var f=o;return f.gpuRenderPipeline!==null},a.prototype.pipelineForceReady=function(o){var f=o;this.createRenderPipelineInternal(f,!1)},a}(),L3=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,go.mG)(this,void 0,void 0,function(){var f,v,S,O,L,k,V,Q;return(0,go.Jh)(this,function(st){switch(st.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];f=null,st.label=1;case 1:return st.trys.push([1,3,,4]),v=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:v})];case 2:return f=st.sent(),[3,4];case 3:return S=st.sent(),console.log(S),[3,4];case 4:return f===null?[2,null]:(O=["depth32float-stencil8","texture-compression-bc","float32-filterable"],L=O.filter(function(ft){return f.features.has(ft)}),[4,f.requestDevice({requiredFeatures:L})]);case 5:if(k=st.sent(),k&&(V=this.pluginOptions.onContextLost,k.lost.then(function(){V&&V()})),k===null)return[2,null];if(Q=o.getContext("webgpu"),!Q)return[2,null];st.label=6;case 6:return st.trys.push([6,8,,9]),[4,ob(this.pluginOptions.shaderCompilerPath)];case 7:return st.sent(),[3,9];case 8:return st.sent(),[3,9];case 9:return[2,new I3(f,k,o,Q,nS,qy&&new qy)]}})})},a}(),D3=Object.defineProperty,dS=Object.defineProperties,N3=Object.getOwnPropertyDescriptors,pS=Object.getOwnPropertySymbols,k3=Object.prototype.hasOwnProperty,B3=Object.prototype.propertyIsEnumerable,mS=(a,o,f)=>o in a?D3(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Jy=(a,o)=>{for(var f in o||(o={}))k3.call(o,f)&&mS(a,f,o[f]);if(pS)for(var f of pS(o))B3.call(o,f)&&mS(a,f,o[f]);return a},F3=(a,o)=>dS(a,N3(o)),{isPlainObject:U3,isTypedArray:z3}=_t.lodashUtil,dl=class{constructor(a,o){this.destroyed=!1,this.uniforms={},this.reGl=a;const{vs:f,fs:v,attributes:S,uniforms:O,primitive:L,count:k,elements:V,depth:Q,cull:st,instances:ft}=o,Tt={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Vp.LOWER_LEFT,clipSpaceNearZ:xg.NEGATIVE_ONE,supportMRT:!1},se={};this.options=o,O&&(this.uniforms=this.extractUniforms(O),Object.keys(O).forEach(Ln=>{se[Ln]=a.prop(Ln)}));const Ve={};Object.keys(S).forEach(Ln=>{Ve[Ln]=S[Ln].get()});const yn=(0,X.Vb)(Fm(Tt,"frag",v,null,!1)),lr=(0,X.Vb)(Fm(Tt,"vert",f,null,!1)),Nr={attributes:Ve,frag:yn,uniforms:se,vert:lr,colorMask:a.prop("colorMask"),lineWidth:1,blend:{enable:a.prop("blend.enable"),func:a.prop("blend.func"),equation:a.prop("blend.equation"),color:a.prop("blend.color")},stencil:{enable:a.prop("stencil.enable"),mask:a.prop("stencil.mask"),func:a.prop("stencil.func"),opFront:a.prop("stencil.opFront"),opBack:a.prop("stencil.opBack")},primitive:sd[L===void 0?X.gl.TRIANGLES:L]};ft&&(Nr.instances=ft),k?Nr.count=k:V&&(Nr.elements=V.get()),this.initDepthDrawParams({depth:Q},Nr),this.initCullDrawParams({cull:st},Nr),this.drawCommand=a(Nr),this.drawParams=Nr}updateAttributesAndElements(a,o){const f={};Object.keys(a).forEach(v=>{f[v]=a[v].get()}),this.drawParams.attributes=f,this.drawParams.elements=o.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(a){const o={};Object.keys(a).forEach(f=>{o[f]=a[f].get()}),this.drawParams.attributes=o,this.drawCommand=this.reGl(this.drawParams)}addUniforms(a){this.uniforms=Jy(Jy({},this.uniforms),this.extractUniforms(a))}draw(a,o){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const f=Jy(Jy({},this.uniforms),this.extractUniforms(a.uniforms||{})),v={};Object.keys(f).forEach(S=>{const O=typeof f[S];O==="boolean"||O==="number"||Array.isArray(f[S])||f[S].BYTES_PER_ELEMENT?v[S]=f[S]:v[S]=f[S].get()}),v.blend=o?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(a),v.stencil=this.getStencilDrawParams(a),v.colorMask=this.getColorMaskDrawParams(a,o),this.drawCommand(v)}destroy(){var a,o;(o=(a=this.drawParams)==null?void 0:a.elements)==null||o.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(f=>{f==null||f.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:a},o){a&&(o.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:lp[a.func||X.gl.LESS],range:a.range||[0,1]})}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:S=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:zx[f&&f.srcRGB||X.gl.SRC_ALPHA],srcAlpha:zx[f&&f.srcAlpha||X.gl.SRC_ALPHA],dstRGB:zx[f&&f.dstRGB||X.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:zx[f&&f.dstAlpha||X.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:t1[v&&v.rgb||X.gl.FUNC_ADD],alpha:t1[v&&v.alpha||X.gl.FUNC_ADD]},color:S}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=-1,func:v={cmp:X.gl.ALWAYS,ref:0,mask:-1},opFront:S={fail:X.gl.KEEP,zfail:X.gl.KEEP,zpass:X.gl.KEEP},opBack:O={fail:X.gl.KEEP,zfail:X.gl.KEEP,zpass:X.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:F3(Jy({},v),{cmp:dP[v.cmp]}),opFront:{fail:el[S.fail],zfail:el[S.zfail],zpass:el[S.zpass]},opBack:{fail:el[O.fail],zfail:el[O.zfail],zpass:el[O.zpass]}}}getColorMaskDrawParams({stencil:a},o){return a!=null&&a.enable&&a.opFront&&!o?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:a},o){if(a){const{enable:f,face:v=X.gl.BACK}=a;o.cull={enable:!!f,face:Ih[v]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||z3(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}U3(o)&&Object.keys(o).forEach(S=>{this.extractUniformsRecursively(S,o[S],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((S,O)=>{Object.keys(S).forEach(L=>{this.extractUniformsRecursively(L,S[L],f,`${v&&v+"."}${a}[${O}]`)})})}},j3=class{constructor(a,o){this.isDestroy=!1;const{data:f,type:v=X.gl.UNSIGNED_BYTE,width:S,height:O,flipY:L=!1,format:k=X.gl.RGBA,mipmap:V=!1,wrapS:Q=X.gl.CLAMP_TO_EDGE,wrapT:st=X.gl.CLAMP_TO_EDGE,aniso:ft=0,alignment:Tt=1,premultiplyAlpha:se=!1,mag:Ve=X.gl.NEAREST,min:yn=X.gl.NEAREST,colorSpace:lr=X.gl.BROWSER_DEFAULT_WEBGL,x:Nr=0,y:Ln=0,copy:ci=!1}=o;this.width=S,this.height=O;const Fi={width:S,height:O,type:Ly[v],format:RA[k],wrapS:Ga[Q],wrapT:Ga[st],mag:OE[Ve],min:OE[yn],alignment:Tt,flipY:L,colorSpace:PA[lr],premultiplyAlpha:se,aniso:ft,x:Nr,y:Ln,copy:ci};f&&(Fi.data=f),typeof V=="number"?Fi.mipmap=MA[V]:typeof V=="boolean"&&(Fi.mipmap=V),this.texture=a.texture(Fi)}get(){return this.texture}update(a={}){this.texture(a)}bind(){this.texture._texture.bind()}resize({width:a,height:o}){this.texture.resize(a,o),this.width=a,this.height=o}getSize(){return[this.width,this.height]}destroy(){var a;this.isDestroy||(a=this.texture)==null||a.destroy(),this.isDestroy=!0}},pb=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),vS=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=a=>new dl(this.gl,a),this.createAttribute=a=>new Af(this.gl,a),this.createBuffer=a=>new q0(this.gl,a),this.createElements=a=>new Dy(this.gl,a),this.createTexture2D=a=>new j3(this.gl,a),this.createFramebuffer=a=>new jx(this.gl,a),this.useFramebuffer=(a,o)=>{this.gl({framebuffer:a?a.get():null})(o)},this.useFramebufferAsync=(a,o)=>pb(this,null,function*(){this.gl({framebuffer:a?a.get():null})(o)}),this.clear=a=>{var o;const{color:f,depth:v,stencil:S,framebuffer:O=null}=a,L={color:f,depth:v,stencil:S};L.framebuffer=O===null?O:O.get(),(o=this.gl)==null||o.clear(L)},this.viewport=({x:a,y:o,width:f,height:v})=>{this.gl._gl.viewport(a,o,f,v),this.width=f,this.height=v,this.gl._refresh()},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:S,height:O}=a,L={x:f,y:v,width:S,height:O};return o&&(L.framebuffer=o.get()),this.gl.read(L)},this.readPixelsAsync=a=>pb(this,null,function*(){return this.readPixels(a)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var a,o,f;this.canvas=null,(f=(o=(a=this.gl)==null?void 0:a._gl)==null?void 0:o.getExtension("WEBGL_lose_context"))==null||f.loseContext(),this.gl.destroy(),this.gl=null}}init(a,o,f){return pb(this,null,function*(){this.canvas=a,f?this.gl=f:this.gl=yield new Promise((v,S)=>{CA()({canvas:this.canvas,attributes:{alpha:!0,antialias:o.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:o.preserveDrawingBuffer,stencil:o.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(O,L)=>{(O||!L)&&S(O),v(L)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const a=this.getGLContext();a.disable(a.CULL_FACE)}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},gS=class{constructor(a,o){const{buffer:f,offset:v,stride:S,normalized:O,size:L,divisor:k,shaderLocation:V}=o;this.buffer=f,this.attribute={shaderLocation:V,buffer:f.get(),offset:v||0,stride:S||0,normalized:O||!1,divisor:k||0},L&&(this.attribute.size=L)}get(){return this.buffer}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},S1={[X.gl.FLOAT]:Float32Array,[X.gl.UNSIGNED_BYTE]:Uint8Array,[X.gl.SHORT]:Int16Array,[X.gl.UNSIGNED_SHORT]:Uint16Array,[X.gl.INT]:Int32Array,[X.gl.UNSIGNED_INT]:Uint32Array},V3={[X.gl.POINTS]:Pl.POINTS,[X.gl.LINES]:Pl.LINES,[X.gl.LINE_LOOP]:Pl.LINES,[X.gl.LINE_STRIP]:Pl.LINE_STRIP,[X.gl.TRIANGLES]:Pl.TRIANGLES,[X.gl.TRIANGLE_FAN]:Pl.TRIANGLES,[X.gl.TRIANGLE_STRIP]:Pl.TRIANGLE_STRIP},kP={1:$n.F32_R,2:$n.F32_RG,3:$n.F32_RGB,4:$n.F32_RGBA},Z3={[X.gl.STATIC_DRAW]:cd.STATIC,[X.gl.DYNAMIC_DRAW]:cd.DYNAMIC,[X.gl.STREAM_DRAW]:cd.DYNAMIC},Zp={[X.gl.REPEAT]:Cf.REPEAT,[X.gl.CLAMP_TO_EDGE]:Cf.CLAMP_TO_EDGE,[X.gl.MIRRORED_REPEAT]:Cf.MIRRORED_REPEAT},t_={[X.gl.NEVER]:Ha.NEVER,[X.gl.ALWAYS]:Ha.ALWAYS,[X.gl.LESS]:Ha.LESS,[X.gl.LEQUAL]:Ha.LEQUAL,[X.gl.GREATER]:Ha.GREATER,[X.gl.GEQUAL]:Ha.GEQUAL,[X.gl.EQUAL]:Ha.EQUAL,[X.gl.NOTEQUAL]:Ha.NOTEQUAL},yS={[X.gl.FRONT]:ld.FRONT,[X.gl.BACK]:ld.BACK},_S={[X.gl.FUNC_ADD]:hf.ADD,[X.gl.MIN_EXT]:hf.MIN,[X.gl.MAX_EXT]:hf.MAX,[X.gl.FUNC_SUBTRACT]:hf.SUBSTRACT,[X.gl.FUNC_REVERSE_SUBTRACT]:hf.REVERSE_SUBSTRACT},e_={[X.gl.ZERO]:os.ZERO,[X.gl.ONE]:os.ONE,[X.gl.SRC_COLOR]:os.SRC,[X.gl.ONE_MINUS_SRC_COLOR]:os.ONE_MINUS_SRC,[X.gl.SRC_ALPHA]:os.SRC_ALPHA,[X.gl.ONE_MINUS_SRC_ALPHA]:os.ONE_MINUS_SRC_ALPHA,[X.gl.DST_COLOR]:os.DST,[X.gl.ONE_MINUS_DST_COLOR]:os.ONE_MINUS_DST,[X.gl.DST_ALPHA]:os.DST_ALPHA,[X.gl.ONE_MINUS_DST_ALPHA]:os.ONE_MINUS_DST_ALPHA,[X.gl.CONSTANT_COLOR]:os.CONST,[X.gl.ONE_MINUS_CONSTANT_COLOR]:os.ONE_MINUS_CONSTANT,[X.gl.CONSTANT_ALPHA]:os.CONST,[X.gl.ONE_MINUS_CONSTANT_ALPHA]:os.ONE_MINUS_CONSTANT,[X.gl.SRC_ALPHA_SATURATE]:os.SRC_ALPHA_SATURATE},Mg={[X.gl.REPLACE]:Oc.REPLACE,[X.gl.KEEP]:Oc.KEEP,[X.gl.ZERO]:Oc.ZERO,[X.gl.INVERT]:Oc.INVERT,[X.gl.INCR]:Oc.INCREMENT_CLAMP,[X.gl.DECR]:Oc.DECREMENT_CLAMP,[X.gl.INCR_WRAP]:Oc.INCREMENT_WRAP,[X.gl.DECR_WRAP]:Oc.DECREMENT_WRAP},H3={[X.gl.ALWAYS]:Ha.ALWAYS,[X.gl.EQUAL]:Ha.EQUAL,[X.gl.GEQUAL]:Ha.GEQUAL,[X.gl.GREATER]:Ha.GREATER,[X.gl.LEQUAL]:Ha.LEQUAL,[X.gl.LESS]:Ha.LESS,[X.gl.NEVER]:Ha.NEVER,[X.gl.NOTEQUAL]:Ha.NOTEQUAL},G3={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function mb(a){return Object.prototype.toString.call(a)in G3}function Hf(a,o){const f=a.length,v=Math.ceil(f/3),S=f+v,O=new Float32Array(S);for(let L=0;L<S;L+=4)O[L]=a[L/4*3],O[L+1]=a[L/4*3+1],O[L+2]=a[L/4*3+2],O[L+3]=o;return O}var W3=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:S,isUBO:O,label:L}=o;let k;mb(f)?k=f:k=new S1[this.type||X.gl.FLOAT](f),this.type=S,this.size=k.byteLength,this.buffer=a.createBuffer({viewOrSize:k,usage:O?_s.UNIFORM:_s.VERTEX,hint:Z3[v||X.gl.STATIC_DRAW]}),L&&a.setResourceName(this.buffer,L)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){let f;mb(a)?f=a:f=new S1[this.type||X.gl.FLOAT](a),this.buffer.setSubData(o,new Uint8Array(f.buffer))}};function al(a,o=0){return a+=o,a+=a<<10,a+=a>>>6,a>>>0}function vb(a){return a+=a<<3,a^=a>>>11,a+=a<<15,a>>>0}function Pg(){return 0}var xS=class{constructor(){this.keys=[],this.values=[]}},n_=class{constructor(a,o){this.keyEqualFunc=a,this.keyHashFunc=o,this.buckets=new Map}findBucketIndex(a,o){for(let f=0;f<a.keys.length;f++)if(this.keyEqualFunc(o,a.keys[f]))return f;return-1}findBucket(a){const o=this.keyHashFunc(a);return this.buckets.get(o)}get(a){const o=this.findBucket(a);if(o===void 0)return null;const f=this.findBucketIndex(o,a);return f<0?null:o.values[f]}add(a,o){const f=this.keyHashFunc(a);this.buckets.get(f)===void 0&&this.buckets.set(f,new xS);const v=this.buckets.get(f);v.keys.push(a),v.values.push(o)}delete(a){const o=this.findBucket(a);if(o===void 0)return;const f=this.findBucketIndex(o,a);f!==-1&&(o.keys.splice(f,1),o.values.splice(f,1))}clear(){this.buckets.clear()}size(){let a=0;for(const o of this.buckets.values())a+=o.values.length;return a}*values(){for(const a of this.buckets.values())for(let o=a.values.length-1;o>=0;o--)yield a.values[o]}};function bS(a,o){return a=al(a,o.blendMode),a=al(a,o.blendSrcFactor),a=al(a,o.blendDstFactor),a}function X3(a,o){return a=bS(a,o.rgbBlendState),a=bS(a,o.alphaBlendState),a=al(a,o.channelWriteMask),a}function Y3(a,o){return a=al(a,o.r<<24|o.g<<16|o.b<<8|o.a),a}function q3(a,o){var f,v,S,O,L,k,V,Q;for(let st=0;st<o.attachmentsState.length;st++)a=X3(a,o.attachmentsState[st]);return a=Y3(a,o.blendConstant||Fy),a=al(a,o.depthCompare),a=al(a,o.depthWrite?1:0),a=al(a,(f=o.stencilFront)==null?void 0:f.compare),a=al(a,(v=o.stencilFront)==null?void 0:v.passOp),a=al(a,(S=o.stencilFront)==null?void 0:S.failOp),a=al(a,(O=o.stencilFront)==null?void 0:O.depthFailOp),a=al(a,(L=o.stencilBack)==null?void 0:L.compare),a=al(a,(k=o.stencilBack)==null?void 0:k.passOp),a=al(a,(V=o.stencilBack)==null?void 0:V.failOp),a=al(a,(Q=o.stencilBack)==null?void 0:Q.depthFailOp),a=al(a,o.stencilWrite?1:0),a=al(a,o.cullMode),a=al(a,o.frontFace?1:0),a=al(a,o.polygonOffset?1:0),a}function $3(a){let o=0;o=al(o,a.program.id),a.inputLayout!==null&&(o=al(o,a.inputLayout.id)),o=q3(o,a.megaStateDescriptor);for(let f=0;f<a.colorAttachmentFormats.length;f++)o=al(o,a.colorAttachmentFormats[f]||0);return o=al(o,a.depthStencilAttachmentFormat||0),vb(o)}function K3(a){let o=0;if(a.samplerBindings)for(let f=0;f<a.samplerBindings.length;f++){const v=a.samplerBindings[f];v!==null&&v.texture!==null&&(o=al(o,v.texture.id))}if(a.uniformBufferBindings)for(let f=0;f<a.uniformBufferBindings.length;f++){const v=a.uniformBufferBindings[f];v!==null&&v.buffer!==null&&(o=al(o,v.buffer.id),o=al(o,v.binding),o=al(o,v.offset),o=al(o,v.size))}if(a.storageBufferBindings)for(let f=0;f<a.storageBufferBindings.length;f++){const v=a.storageBufferBindings[f];v!==null&&v.buffer!==null&&(o=al(o,v.buffer.id),o=al(o,v.binding),o=al(o,v.offset),o=al(o,v.size))}if(a.storageTextureBindings)for(let f=0;f<a.storageTextureBindings.length;f++){const v=a.storageTextureBindings[f];v!==null&&v.texture!==null&&(o=al(o,v.texture.id),o=al(o,v.binding))}return vb(o)}function Q3(a,o){var f,v,S,O;return((f=a.vertex)==null?void 0:f.glsl)===((v=o.vertex)==null?void 0:v.glsl)&&((S=a.fragment)==null?void 0:S.glsl)===((O=o.fragment)==null?void 0:O.glsl)}function J3(a){var o,f;return{vertex:{glsl:(o=a.vertex)==null?void 0:o.glsl},fragment:{glsl:(f=a.fragment)==null?void 0:f.glsl}}}var r_=class{constructor(a){this.device=a,this.bindingsCache=new n_(jA,K3),this.renderPipelinesCache=new n_(AP,$3),this.inputLayoutsCache=new n_(GA,Pg),this.programCache=new n_(Q3,Pg)}createBindings(a){var o;let f=this.bindingsCache.get(a);if(f===null){const v=YA(a);v.uniformBufferBindings=(o=v.uniformBufferBindings)==null?void 0:o.filter(({size:S})=>S&&S>0),f=this.device.createBindings(v),this.bindingsCache.add(v,f)}return f}createRenderPipeline(a){let o=this.renderPipelinesCache.get(a);if(o===null){const f=qA(a);f.colorAttachmentFormats=f.colorAttachmentFormats.filter(v=>v),o=this.device.createRenderPipeline(f),this.renderPipelinesCache.add(f,o)}return o}createInputLayout(a){a.vertexBufferDescriptors=a.vertexBufferDescriptors.filter(f=>!!f);let o=this.inputLayoutsCache.get(a);if(o===null){const f=QA(a);o=this.device.createInputLayout(f),this.inputLayoutsCache.add(f,o)}return o}createProgram(a){let o=this.programCache.get(a);if(o===null){const f=J3(a);o=this.device.createProgram(a),this.programCache.add(f,o)}return o}destroy(){for(const a of this.bindingsCache.values())a.destroy();for(const a of this.renderPipelinesCache.values())a.destroy();for(const a of this.inputLayoutsCache.values())a.destroy();for(const a of this.programCache.values())a.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},Ig=class{constructor(a,o){const{data:f,type:v,count:S=0}=o;let O;mb(f)?O=f:O=new S1[this.type||X.gl.UNSIGNED_INT](f),this.type=v,this.count=S,this.indexBuffer=a.createBuffer({viewOrSize:O,usage:_s.INDEX})}get(){return this.indexBuffer}subData({data:a}){let o;mb(a)?o=a:o=new S1[this.type||X.gl.UNSIGNED_INT](a),this.indexBuffer.setSubData(0,new Uint8Array(o.buffer))}destroy(){this.indexBuffer.destroy()}};function Lg(a){return!!(a&&a.texture)}var ES=class{constructor(a,o){this.device=a,this.options=o,this.isDestroy=!1;const{wrapS:f=X.gl.CLAMP_TO_EDGE,wrapT:v=X.gl.CLAMP_TO_EDGE,aniso:S,mag:O=X.gl.NEAREST,min:L=X.gl.NEAREST}=o;this.createTexture(o),this.sampler=a.createSampler({addressModeU:Zp[f],addressModeV:Zp[v],minFilter:L===X.gl.NEAREST?ia.POINT:ia.BILINEAR,magFilter:O===X.gl.NEAREST?ia.POINT:ia.BILINEAR,mipmapFilter:Zl.NO_MIP,maxAnisotropy:S})}createTexture(a){const{type:o=X.gl.UNSIGNED_BYTE,width:f,height:v,flipY:S=!1,format:O=X.gl.RGBA,alignment:L=1,usage:k=X.v2.SAMPLED,unorm:V=!1,label:Q}=a;let{data:st}=a;this.width=f,this.height=v;let ft=$n.U8_RGBA_RT;if(o===X.gl.UNSIGNED_BYTE&&O===X.gl.RGBA)ft=V?$n.U8_RGBA_NORM:$n.U8_RGBA_RT;else if(o===X.gl.UNSIGNED_BYTE&&O===X.gl.LUMINANCE)ft=$n.U8_LUMINANCE;else if(o===X.gl.FLOAT&&O===X.gl.LUMINANCE)ft=$n.F32_LUMINANCE;else if(o===X.gl.FLOAT&&O===X.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(st&&(st=Hf(st,0)),ft=$n.F32_RGBA):ft=$n.F32_RGB;else if(o===X.gl.FLOAT&&O===X.gl.RGBA)ft=$n.F32_RGBA;else if(o===X.gl.FLOAT&&O===X.gl.RED)ft=$n.F32_R;else throw new Error(`create texture error, type: ${o}, format: ${O}`);this.texture=this.device.createTexture({format:ft,width:f,height:v,usage:k===X.v2.SAMPLED?hu.SAMPLED:hu.RENDER_TARGET,pixelStore:{unpackFlipY:S,packAlignment:L},mipLevelCount:1}),Q&&this.device.setResourceName(this.texture,Q),st&&this.texture.setImageData([st])}get(){return this.texture}update(a){const{data:o}=a;this.texture.setImageData([o])}bind(){}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&this.destroy(),this.options.width=a,this.options.height=o,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var a;!this.isDestroy&&!this.texture.destroyed&&((a=this.texture)==null||a.destroy()),this.isDestroy=!0}},gb=class{constructor(a,o){this.device=a,this.options=o,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(a=!1){const{width:o,height:f,color:v}=this.options;v&&(Lg(v)?(a&&v.resize({width:o,height:f}),this.colorTexture=v.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=v.width,this.height=v.height):o&&f&&(this.colorTexture=this.device.createTexture({format:$n.U8_RGBA_RT,usage:hu.RENDER_TARGET,width:o,height:f}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=o,this.height=f))}createDepthRenderTarget(a=!1){const{width:o,height:f,depth:v}=this.options;v&&(Lg(v)?(a&&v.resize({width:o,height:f}),this.depthTexture=v.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=v.width,this.height=v.height):o&&f&&(this.depthTexture=this.device.createTexture({format:$n.D24_S8,usage:hu.RENDER_TARGET,width:o,height:f}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=o,this.height=f))}get(){return this.colorRenderTarget}destroy(){var a,o;(a=this.colorRenderTarget)==null||a.destroy(),(o=this.depthRenderTarget)==null||o.destroy()}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=a,this.options.height=o,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},i_=Object.defineProperty,tO=Object.defineProperties,BP=Object.getOwnPropertyDescriptors,yb=Object.getOwnPropertySymbols,eO=Object.prototype.hasOwnProperty,nO=Object.prototype.propertyIsEnumerable,SS=(a,o,f)=>o in a?i_(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Iv=(a,o)=>{for(var f in o||(o={}))eO.call(o,f)&&SS(a,f,o[f]);if(yb)for(var f of yb(o))nO.call(o,f)&&SS(a,f,o[f]);return a},rO=(a,o)=>tO(a,BP(o)),{isPlainObject:iO,isTypedArray:oO,isNil:TS}=_t.lodashUtil,aO=class{constructor(a,o,f){this.device=a,this.options=o,this.service=f,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:v,fs:S,attributes:O,uniforms:L,count:k,elements:V,diagnosticDerivativeUniformityEnabled:Q}=o;this.options=o;const st=Q?"":this.service.viewportOrigin===Vp.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=f.renderCache.createProgram({vertex:{glsl:v},fragment:{glsl:S,postprocess:Ve=>st+Ve}}),L&&(this.uniforms=this.extractUniforms(L));const ft=[];let Tt=0;Object.keys(O).forEach(Ve=>{const yn=O[Ve],lr=yn.get();this.vertexBuffers.push(lr.get());const{offset:Nr=0,stride:Ln=0,size:ci=1,divisor:Fi=0,shaderLocation:So=0}=yn.attribute;ft.push({arrayStride:Ln||ci*4,stepMode:Av.VERTEX,attributes:[{format:kP[ci],shaderLocation:So,offset:Nr,divisor:Fi}]}),Tt=lr.size/ci}),k||(this.options.count=Tt),V&&(this.indexBuffer=V.get());const se=f.renderCache.createInputLayout({vertexBufferDescriptors:ft,indexBufferFormat:V?$n.U32_R:null,program:this.program});this.inputLayout=se,this.pipeline=this.createPipeline(o)}createPipeline(a,o){var f;const{primitive:v=X.gl.TRIANGLES,depth:S,cull:O,blend:L,stencil:k}=a,V=this.initDepthDrawParams({depth:S}),Q=!!(V&&V.enable),st=this.initCullDrawParams({cull:O}),ft=!!(st&&st.enable),Tt=this.getBlendDrawParams({blend:L}),se=!!(Tt&&Tt.enable),Ve=this.getStencilDrawParams({stencil:k}),yn=!!(Ve&&Ve.enable),lr=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:V3[v],colorAttachmentFormats:[$n.U8_RGBA_RT],depthStencilAttachmentFormat:$n.D24_S8,megaStateDescriptor:{attachmentsState:[o?{channelWriteMask:$u.ALL,rgbBlendState:{blendMode:hf.ADD,blendSrcFactor:os.ONE,blendDstFactor:os.ZERO},alphaBlendState:{blendMode:hf.ADD,blendSrcFactor:os.ONE,blendDstFactor:os.ZERO}}:{channelWriteMask:yn&&Ve.opFront.zpass===Oc.REPLACE?$u.NONE:$u.ALL,rgbBlendState:{blendMode:se&&Tt.equation.rgb||hf.ADD,blendSrcFactor:se&&Tt.func.srcRGB||os.SRC_ALPHA,blendDstFactor:se&&Tt.func.dstRGB||os.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:se&&Tt.equation.alpha||hf.ADD,blendSrcFactor:se&&Tt.func.srcAlpha||os.ONE,blendDstFactor:se&&Tt.func.dstAlpha||os.ONE}}],blendConstant:se?Fy:void 0,depthWrite:Q,depthCompare:Q&&V.func||Ha.LESS,cullMode:ft&&st.face||ld.NONE,stencilWrite:yn,stencilFront:{compare:yn?Ve.func.cmp:Ha.ALWAYS,passOp:Ve.opFront.zpass,failOp:Ve.opFront.fail,depthFailOp:Ve.opFront.zfail,mask:Ve.opFront.mask},stencilBack:{compare:yn?Ve.func.cmp:Ha.ALWAYS,passOp:Ve.opBack.zpass,failOp:Ve.opBack.fail,depthFailOp:Ve.opBack.zfail,mask:Ve.opBack.mask}}});return yn&&!TS((f=k==null?void 0:k.func)==null?void 0:f.ref)&&(lr.stencilFuncReference=k.func.ref),lr}updateAttributesAndElements(){}updateAttributes(){}addUniforms(a){this.uniforms=Iv(Iv({},this.uniforms),this.extractUniforms(a))}draw(a,o){const f=Iv(Iv({},this.options),a),{count:v=0,instances:S,elements:O,uniforms:L={},uniformBuffers:k,textures:V}=f;this.uniforms=Iv(Iv({},this.uniforms),this.extractUniforms(L));const{renderPass:Q,currentFramebuffer:st,width:ft,height:Tt}=this.service;this.pipeline=this.createPipeline(f,o);const se=this.service.device,Ve=se.swapChainHeight;if(se.swapChainHeight=(st==null?void 0:st.height)||Tt,Q.setViewport(0,0,(st==null?void 0:st.width)||ft,(st==null?void 0:st.height)||Tt),se.swapChainHeight=Ve,Q.setPipeline(this.pipeline),TS(this.pipeline.stencilFuncReference)||Q.setStencilReference(this.pipeline.stencilFuncReference),Q.setVertexInput(this.inputLayout,this.vertexBuffers.map(yn=>({buffer:yn})),O?{buffer:this.indexBuffer,offset:0}:null),k&&(this.bindings=se.createBindings({pipeline:this.pipeline,uniformBufferBindings:k.map((yn,lr)=>{const Nr=yn;return{binding:lr,buffer:Nr.get(),size:Nr.size}}),samplerBindings:V==null?void 0:V.map(yn=>({texture:yn.texture,sampler:yn.sampler}))})),this.bindings&&(Q.setBindings(this.bindings),Object.keys(this.uniforms).forEach(yn=>{const lr=this.uniforms[yn];lr instanceof ES?this.uniforms[yn]=lr.get():lr instanceof gb&&(this.uniforms[yn]=lr.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),O){const yn=O.count;yn===0?Q.draw(v,S):Q.drawIndexed(yn,S)}else Q.draw(v,S)}destroy(){var a,o,f;(a=this.vertexBuffers)==null||a.forEach(v=>v.destroy()),(o=this.indexBuffer)==null||o.destroy(),(f=this.bindings)==null||f.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:a}){if(a)return{enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:t_[a.func||X.gl.LESS],range:a.range||[0,1]}}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:S=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:e_[f&&f.srcRGB||X.gl.SRC_ALPHA],srcAlpha:e_[f&&f.srcAlpha||X.gl.SRC_ALPHA],dstRGB:e_[f&&f.dstRGB||X.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:e_[f&&f.dstAlpha||X.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:_S[v&&v.rgb||X.gl.FUNC_ADD],alpha:_S[v&&v.alpha||X.gl.FUNC_ADD]},color:S}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=4294967295,func:v={cmp:X.gl.ALWAYS,ref:0,mask:4294967295},opFront:S={fail:X.gl.KEEP,zfail:X.gl.KEEP,zpass:X.gl.KEEP},opBack:O={fail:X.gl.KEEP,zfail:X.gl.KEEP,zpass:X.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:rO(Iv({},v),{cmp:H3[v.cmp]}),opFront:{fail:Mg[S.fail],zfail:Mg[S.zfail],zpass:Mg[S.zpass],mask:v.mask},opBack:{fail:Mg[O.fail],zfail:Mg[O.zfail],zpass:Mg[O.zpass],mask:v.mask}}}initCullDrawParams({cull:a}){if(a){const{enable:o,face:f=X.gl.BACK}=a;return{enable:!!o,face:yS[f]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||oO(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}iO(o)&&Object.keys(o).forEach(S=>{this.extractUniformsRecursively(S,o[S],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((S,O)=>{Object.keys(S).forEach(L=>{this.extractUniformsRecursively(L,S[L],f,`${v&&v+"."}${a}[${O}]`)})})}};function _b(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}var Dg=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),{isUndefined:T1}=_t.lodashUtil,sO=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=a=>new aO(this.device,a,this),this.createAttribute=a=>new gS(this.device,a),this.createBuffer=a=>new W3(this.device,a),this.createElements=a=>new Ig(this.device,a),this.createTexture2D=a=>new ES(this.device,a),this.createFramebuffer=a=>new gb(this.device,a),this.useFramebuffer=(a,o)=>{this.currentFramebuffer=a,this.beginFrame(),o(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(a,o)=>Dg(this,null,function*(){this.currentFramebuffer=a,this.preRenderPass=this.renderPass,this.beginFrame(),yield o(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=a=>{const{color:o,depth:f,stencil:v,framebuffer:S=null}=a;if(S)S.clearOptions={color:o,depth:f,stencil:v};else{const O=this.queryVerdorInfo();if(O==="WebGL1"){const L=this.getGLContext();T1(v)?T1(f)||(L.clearDepth(f),L.clear(L.DEPTH_BUFFER_BIT)):(L.clearStencil(v),L.clear(L.STENCIL_BUFFER_BIT))}else if(O==="WebGL2"){const L=this.getGLContext();T1(v)?T1(f)||L.clearBufferfv(L.DEPTH,0,[f]):L.clearBufferiv(L.STENCIL,0,[v])}}},this.viewport=({width:a,height:o})=>{this.swapChain.configureSwapChain(a,o),this.createMainColorDepthRT(a,o),this.width=a,this.height=o},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:S,height:O}=a,L=this.device.createReadback(),k=o.colorTexture,V=L.readTextureSync(k,f,this.viewportOrigin===Vp.LOWER_LEFT?v:this.height-v,S,O,new Uint8Array(S*O*4));if(this.viewportOrigin!==Vp.LOWER_LEFT)for(let Q=0;Q<V.length;Q+=4){const st=V[Q];V[Q]=V[Q+2],V[Q+2]=st}return L.destroy(),V},this.readPixelsAsync=a=>Dg(this,null,function*(){const{framebuffer:o,x:f,y:v,width:S,height:O}=a,L=this.device.createReadback(),k=o.colorTexture,V=yield L.readTexture(k,f,this.viewportOrigin===Vp.LOWER_LEFT?v:this.height-v,S,O,new Uint8Array(S*O*4));if(this.viewportOrigin!==Vp.LOWER_LEFT)for(let Q=0;Q<V.length;Q+=4){const st=V[Q];V[Q]=V[Q+2],V[Q+2]=st}return L.destroy(),V}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var a;this.canvas=null,(a=this.uniformBuffers)==null||a.forEach(o=>{o.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(a,o){return Dg(this,null,function*(){const{enableWebGPU:f,shaderCompilerPath:v,antialias:S}=o;this.canvas=a;const L=yield(f?new L3({shaderCompilerPath:v}):new tS({targets:["webgl2","webgl1"],antialias:S,onContextLost(V){console.warn("context lost",V)},onContextCreationError(V){console.warn("context creation error",V)},onContextRestored(V){console.warn("context restored",V)}})).createSwapChain(a);L.configureSwapChain(a.width,a.height),this.device=L.getDevice(),this.swapChain=L,this.renderCache=new r_(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const k=this.device.gl;this.extensionObject={OES_texture_float:!_b(k)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height)})}createMainColorDepthRT(a,o){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:$n.U8_RGBA_RT,width:a,height:o,usage:hu.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:$n.D24_S8,width:a,height:o,usage:hu.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:a,swapChain:o,mainColorRT:f,mainDepthRT:v}=this,S=a?a.colorRenderTarget:f,O=a?null:o.getOnscreenTexture(),L=a?a.depthRenderTarget:v,{color:k=[0,0,0,0],depth:V=1,stencil:Q=0}=(a==null?void 0:a.clearOptions)||{},st=S?bg(k[0]*255,k[1]*255,k[2]*255,k[3]):Fy,ft=L?V:void 0,Tt=L?Q:void 0,se=this.device.createRenderPass({colorAttachment:[S],colorResolveTo:[O],colorClearColor:[st],colorStore:[!0],depthStencilAttachment:L,depthClearValue:ft,stencilClearValue:Tt});this.renderPass=se}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const a=this.device.gl;return a.getParameter(a.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}},Ng=["selectstart","selecting","selectend"],lO=class extends Gc.EventEmitter{constructor(a,o={}){super(),this.isEnable=!1,this.onDragStart=f=>{this.box.style.display="block",this.startEvent=this.endEvent=f,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=f=>{this.endEvent=f,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=f=>{this.endEvent=f,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=a,this.options=o}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:a}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const o=_t.SO.create("div",void 0,this.container);o.classList.add("l7-select-box"),a&&o.classList.add(a),o.style.display="none",this.box=o}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:a,y:o}=this.startEvent,{x:f,y:v}=this.endEvent,S=Math.min(a,f),O=Math.min(o,v),L=Math.abs(a-f),k=Math.abs(o-v);this.box.style.top=`${O}px`,this.box.style.left=`${S}px`,this.box.style.width=`${L}px`,this.box.style.height=`${k}px`}getLngLatBox(){const{lngLat:{lng:a,lat:o}}=this.startEvent,{lngLat:{lng:f,lat:v}}=this.endEvent;return(0,_t.Ol)([[a,o],[f,v]])}},cO=Object.defineProperty,uO=Object.defineProperties,fO=Object.getOwnPropertyDescriptors,wS=Object.getOwnPropertySymbols,hO=Object.prototype.hasOwnProperty,xb=Object.prototype.propertyIsEnumerable,AS=(a,o,f)=>o in a?cO(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,dO=(a,o)=>{for(var f in o||(o={}))hO.call(o,f)&&AS(a,f,o[f]);if(wS)for(var f of wS(o))xb.call(o,f)&&AS(a,f,o[f]);return a},pO=(a,o)=>uO(a,fO(o)),fp=(a,o,f)=>new Promise((v,S)=>{var O=V=>{try{k(f.next(V))}catch(Q){S(Q)}},L=V=>{try{k(f.throw(V))}catch(Q){S(Q)}},k=V=>V.done?v(V.value):Promise.resolve(V.value).then(O,L);k((f=f.apply(a,o)).next())}),OS=class{constructor(a){const{id:o,map:f,renderer:v="device"}=a,S=(0,X.Hp)();this.container=S,f.setContainer(S,o),v==="regl"?S.rendererService=new vS:S.rendererService=new sO,this.sceneService=S.sceneService,this.mapService=S.mapService,this.iconService=S.iconService,this.fontService=S.fontService,this.controlService=S.controlService,this.layerService=S.layerService,this.debugService=S.debugService,this.debugService.setEnable(a.debug),this.markerService=S.markerService,this.interactionService=S.interactionService,this.popupService=S.popupService,this.boxSelect=new lO(this,{}),this.initComponent(o),this.sceneService.init(a),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(a){return fp(this,null,function*(){return this.sceneService.exportPng(a)})}exportMap(a){return fp(this,null,function*(){return this.sceneService.exportPng(a)})}registerRenderService(a){this.sceneService.loaded?new a(this).init():this.on("loaded",()=>{new a(this).init()})}setBgColor(a){this.mapService.setBgColor(a)}addLayer(a){this.loaded?this.preAddLayer(a):this.once("loaded",()=>{this.preAddLayer(a)})}preAddLayer(a){const o=(0,X.e7)(this.container);if(a.setContainer(o),this.sceneService.addLayer(a),a.inited){this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)}else a.on("inited",()=>{this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)})}initMask(a){const{mask:o,maskfence:f,maskColor:v="#000",maskOpacity:S=0}=a.getLayerConfig();return!o||!f?void 0:new vE().source(f).shape("fill").style({color:v,opacity:S})}addMask(a,o){if(!a)return;const f=this.getLayer(o);if(f){const v=(0,X.e7)(this.container);a.setContainer(v),f.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(a){return this.layerService.getLayer(a)}getLayerByName(a){return this.layerService.getLayerByName(a)}removeLayer(a,o){return fp(this,null,function*(){yield this.layerService.remove(a,o)})}removeAllLayer(){return fp(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(a){this.layerService.setEnableRender(a)}addIconFont(a,o){this.fontService.addIconFont(a,o)}addIconFonts(a){a.forEach(([o,f])=>{this.fontService.addIconFont(o,f)})}addFontFace(a,o){this.fontService.once("fontloaded",f=>{this.emit("fontloaded",f)}),this.fontService.addFontFace(a,o)}addImage(a,o){return fp(this,null,function*(){yield this.iconService.addImage(a,o)})}hasImage(a){return this.iconService.hasImage(a)}removeImage(a){this.iconService.removeImage(a)}addIconFontGlyphs(a,o){this.fontService.addIconGlyphs(o)}addControl(a){this.controlService.addControl(a,this.container)}removeControl(a){this.controlService.removeControl(a)}getControlByName(a){return this.controlService.getControlByName(a)}addMarker(a){this.markerService.addMarker(a)}addMarkerLayer(a){this.markerService.addMarkerLayer(a)}removeMarkerLayer(a){this.markerService.removeMarkerLayer(a)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(a){this.popupService.addPopup(a)}removePopup(a){this.popupService.removePopup(a)}on(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.on(a,o):X.P7.includes(a)?this.sceneService.on(a,o):this.mapService.on(a,o)}once(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.once(a,o):X.P7.includes(a)?this.sceneService.once(a,o):this.mapService.once(a,o)}emit(a,o){X.P7.indexOf(a)===-1?this.mapService.on(a,o):this.sceneService.emit(a,o)}off(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.off(a,o):X.P7.includes(a)?this.sceneService.off(a,o):this.mapService.off(a,o)}getZoom(){return this.mapService.getZoom()}getCenter(a){return this.mapService.getCenter(a)}setCenter(a,o){return this.mapService.setCenter(a,o)}getPitch(){return this.mapService.getPitch()}setPitch(a){return this.mapService.setPitch(a)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(a){this.mapService.setRotation(a)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(a){this.mapService.panTo(a)}panBy(a,o){this.mapService.panBy(a,o)}getContainer(){return this.mapService.getContainer()}setZoom(a){this.mapService.setZoom(a)}fitBounds(a,o){const{fitBoundsOptions:f,animate:v}=this.sceneService.getSceneConfig();this.mapService.fitBounds(a,o||pO(dO({},f),{animate:v}))}setZoomAndCenter(a,o){this.mapService.setZoomAndCenter(a,o)}setMapStyle(a){this.mapService.setMapStyle(a)}setMapStatus(a){this.mapService.setMapStatus(a)}pixelToLngLat(a){return this.mapService.pixelToLngLat(a)}lngLatToPixel(a){return this.mapService.lngLatToPixel(a)}containerToLngLat(a){return this.mapService.containerToLngLat(a)}lngLatToContainer(a){return this.mapService.lngLatToContainer(a)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(a){this.container.postProcessingPass.name=new a}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(a=!0){this.boxSelect.enable(),a&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(a,o){_t.SA.REGISTERED_PROTOCOLS[a]=o}static removeProtocol(a){delete _t.SA.REGISTERED_PROTOCOLS[a]}getProtocol(a){return _t.SA.REGISTERED_PROTOCOLS[a]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(a){this.controlService.init({container:_t.SO.getContainer(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:a,logoPosition:o}=this.sceneService.getSceneConfig();a&&this.addControl(new Vd({position:o}))}initTileLayer(a){a.getSource().isTile&&(a.tileLayer=new AA(a))}},CS="2.22.1"},81957:function(br,rr){"use strict";var it=function(ne,pt,R){return ne<pt?pt:ne>R?R:ne};rr.Z=it},95147:function(br,rr){"use strict";var it=function(ne){return ne==null};rr.Z=it},25897:function(br,rr,it){"use strict";var ne=it(95456),pt=function(R){return(0,ne.Z)(R,"Number")};rr.Z=pt},95456:function(br,rr){"use strict";var it={}.toString,ne=function(pt,R){return it.call(pt)==="[object "+R+"]"};rr.Z=ne},38163:function(br){br.exports=rr;function rr(pt,R){var $e=pt&&pt.type,yt;if($e==="FeatureCollection")for(yt=0;yt<pt.features.length;yt++)rr(pt.features[yt],R);else if($e==="GeometryCollection")for(yt=0;yt<pt.geometries.length;yt++)rr(pt.geometries[yt],R);else if($e==="Feature")rr(pt.geometry,R);else if($e==="Polygon")it(pt.coordinates,R);else if($e==="MultiPolygon")for(yt=0;yt<pt.coordinates.length;yt++)it(pt.coordinates[yt],R);return pt}function it(pt,R){if(pt.length!==0){ne(pt[0],R);for(var $e=1;$e<pt.length;$e++)ne(pt[$e],!R)}}function ne(pt,R){for(var $e=0,yt=0,xe=0,le=pt.length,Le=le-1;xe<le;Le=xe++){var Lt=(pt[xe][0]-pt[Le][0])*(pt[Le][1]+pt[xe][1]),fn=$e+Lt;yt+=Math.abs($e)>=Math.abs(Lt)?$e-fn+Lt:Lt-fn+$e,$e=fn}$e+yt>=0!=!!R&&pt.reverse()}},75550:function(br){"use strict";br.exports=rr;function rr(it,ne){this.x=it,this.y=ne}rr.prototype={clone:function(){return new rr(this.x,this.y)},add:function(it){return this.clone()._add(it)},sub:function(it){return this.clone()._sub(it)},multByPoint:function(it){return this.clone()._multByPoint(it)},divByPoint:function(it){return this.clone()._divByPoint(it)},mult:function(it){return this.clone()._mult(it)},div:function(it){return this.clone()._div(it)},rotate:function(it){return this.clone()._rotate(it)},rotateAround:function(it,ne){return this.clone()._rotateAround(it,ne)},matMult:function(it){return this.clone()._matMult(it)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(it){return this.x===it.x&&this.y===it.y},dist:function(it){return Math.sqrt(this.distSqr(it))},distSqr:function(it){var ne=it.x-this.x,pt=it.y-this.y;return ne*ne+pt*pt},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(it){return Math.atan2(this.y-it.y,this.x-it.x)},angleWith:function(it){return this.angleWithSep(it.x,it.y)},angleWithSep:function(it,ne){return Math.atan2(this.x*ne-this.y*it,this.x*it+this.y*ne)},_matMult:function(it){var ne=it[0]*this.x+it[1]*this.y,pt=it[2]*this.x+it[3]*this.y;return this.x=ne,this.y=pt,this},_add:function(it){return this.x+=it.x,this.y+=it.y,this},_sub:function(it){return this.x-=it.x,this.y-=it.y,this},_mult:function(it){return this.x*=it,this.y*=it,this},_div:function(it){return this.x/=it,this.y/=it,this},_multByPoint:function(it){return this.x*=it.x,this.y*=it.y,this},_divByPoint:function(it){return this.x/=it.x,this.y/=it.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var it=this.y;return this.y=this.x,this.x=-it,this},_rotate:function(it){var ne=Math.cos(it),pt=Math.sin(it),R=ne*this.x-pt*this.y,$e=pt*this.x+ne*this.y;return this.x=R,this.y=$e,this},_rotateAround:function(it,ne){var pt=Math.cos(it),R=Math.sin(it),$e=ne.x+pt*(this.x-ne.x)-R*(this.y-ne.y),yt=ne.y+R*(this.x-ne.x)+pt*(this.y-ne.y);return this.x=$e,this.y=yt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rr.convert=function(it){return it instanceof rr?it:Array.isArray(it)?new rr(it[0],it[1]):it}},49296:function(br){"use strict";br.exports=it,br.exports.default=it;var rr=1e20;function it(yt,xe,le,Le,Lt,fn){this.fontSize=yt||24,this.buffer=xe===void 0?3:xe,this.cutoff=Le||.25,this.fontFamily=Lt||"sans-serif",this.fontWeight=fn||"normal",this.radius=le||8;var Nt=this.size=this.fontSize+this.buffer*2,Jt=Nt+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Nt,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Jt*Jt),this.gridInner=new Float64Array(Jt*Jt),this.f=new Float64Array(Jt),this.z=new Float64Array(Jt+1),this.v=new Uint16Array(Jt),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(Nt/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ne(yt,xe,le,Le,Lt,fn,Nt){fn.fill(rr,0,xe*le),Nt.fill(0,0,xe*le);for(var Jt=(xe-Le)/2,Ie=0;Ie<Lt;Ie++)for(var fe=0;fe<Le;fe++){var ce=(Ie+Jt)*xe+fe+Jt,ve=yt.data[4*(Ie*Le+fe)+3]/255;if(ve===1)fn[ce]=0,Nt[ce]=rr;else if(ve===0)fn[ce]=rr,Nt[ce]=0;else{var Ze=Math.max(0,.5-ve),Un=Math.max(0,ve-.5);fn[ce]=Ze*Ze,Nt[ce]=Un*Un}}}function pt(yt,xe,le,Le,Lt,fn,Nt){for(var Jt=0;Jt<xe*le;Jt++){var Ie=Math.sqrt(Le[Jt])-Math.sqrt(Lt[Jt]);yt[Jt]=Math.round(255-255*(Ie/fn+Nt))}}it.prototype._draw=function(yt,xe){var le=this.ctx.measureText(yt),Le=le.width,Lt=2*this.buffer,fn,Nt,Jt,Ie,fe,ce,ve,Ze;xe&&this.useMetrics?(fe=Math.floor(le.actualBoundingBoxAscent),Ze=this.buffer+Math.ceil(le.actualBoundingBoxAscent),ce=this.buffer,ve=this.buffer,Nt=Math.min(this.size,Math.ceil(le.actualBoundingBoxRight-le.actualBoundingBoxLeft)),Ie=Math.min(this.size-ce,Math.ceil(le.actualBoundingBoxAscent+le.actualBoundingBoxDescent)),fn=Nt+Lt,Jt=Ie+Lt,this.ctx.textBaseline="alphabetic"):(fn=Nt=this.size,Jt=Ie=this.size,fe=19*this.fontSize/24,ce=ve=0,Ze=this.middle,this.ctx.textBaseline="middle");var Un;Nt&&Ie&&(this.ctx.clearRect(ve,ce,Nt,Ie),this.ctx.fillText(yt,this.buffer,Ze),Un=this.ctx.getImageData(ve,ce,Nt,Ie));var En=new Uint8ClampedArray(fn*Jt);return ne(Un,fn,Jt,Nt,Ie,this.gridOuter,this.gridInner),R(this.gridOuter,fn,Jt,this.f,this.v,this.z),R(this.gridInner,fn,Jt,this.f,this.v,this.z),pt(En,fn,Jt,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:En,metrics:{width:Nt,height:Ie,sdfWidth:fn,sdfHeight:Jt,top:fe,left:0,advance:Le}}},it.prototype.draw=function(yt){return this._draw(yt,!1).data},it.prototype.drawWithMetrics=function(yt){return this._draw(yt,!0)};function R(yt,xe,le,Le,Lt,fn){for(var Nt=0;Nt<xe;Nt++)$e(yt,Nt,xe,le,Le,Lt,fn);for(var Jt=0;Jt<le;Jt++)$e(yt,Jt*xe,1,xe,Le,Lt,fn)}function $e(yt,xe,le,Le,Lt,fn,Nt){var Jt,Ie,fe,ce;for(fn[0]=0,Nt[0]=-rr,Nt[1]=rr,Jt=0;Jt<Le;Jt++)Lt[Jt]=yt[xe+Jt*le];for(Jt=1,Ie=0,fe=0;Jt<Le;Jt++){do ce=fn[Ie],fe=(Lt[Jt]-Lt[ce]+Jt*Jt-ce*ce)/(Jt-ce)/2;while(fe<=Nt[Ie]&&--Ie>-1);Ie++,fn[Ie]=Jt,Nt[Ie]=fe,Nt[Ie+1]=rr}for(Jt=0,Ie=0;Jt<Le;Jt++){for(;Nt[Ie+1]<Jt;)Ie++;ce=fn[Ie],yt[xe+Jt*le]=Lt[ce]+(Jt-ce)*(Jt-ce)}}},38929:function(br,rr,it){br.exports.VectorTile=it(22779),it(66024),it(59701)},22779:function(br,rr,it){"use strict";var ne=it(59701);br.exports=pt;function pt($e,yt){this.layers=$e.readFields(R,{},yt)}function R($e,yt,xe){if($e===3){var le=new ne(xe,xe.readVarint()+xe.pos);le.length&&(yt[le.name]=le)}}},66024:function(br,rr,it){"use strict";var ne=it(75550);br.exports=pt;function pt(le,Le,Lt,fn,Nt){this.properties={},this.extent=Lt,this.type=0,this._pbf=le,this._geometry=-1,this._keys=fn,this._values=Nt,le.readFields(R,this,Le)}function R(le,Le,Lt){le==1?Le.id=Lt.readVarint():le==2?$e(Lt,Le):le==3?Le.type=Lt.readVarint():le==4&&(Le._geometry=Lt.pos)}function $e(le,Le){for(var Lt=le.readVarint()+le.pos;le.pos<Lt;){var fn=Le._keys[le.readVarint()],Nt=Le._values[le.readVarint()];Le.properties[fn]=Nt}}pt.types=["Unknown","Point","LineString","Polygon"],pt.prototype.loadGeometry=function(){var le=this._pbf;le.pos=this._geometry;for(var Le=le.readVarint()+le.pos,Lt=1,fn=0,Nt=0,Jt=0,Ie=[],fe;le.pos<Le;){if(fn<=0){var ce=le.readVarint();Lt=ce&7,fn=ce>>3}if(fn--,Lt===1||Lt===2)Nt+=le.readSVarint(),Jt+=le.readSVarint(),Lt===1&&(fe&&Ie.push(fe),fe=[]),fe.push(new ne(Nt,Jt));else if(Lt===7)fe&&fe.push(fe[0].clone());else throw new Error("unknown command "+Lt)}return fe&&Ie.push(fe),Ie},pt.prototype.bbox=function(){var le=this._pbf;le.pos=this._geometry;for(var Le=le.readVarint()+le.pos,Lt=1,fn=0,Nt=0,Jt=0,Ie=1/0,fe=-1/0,ce=1/0,ve=-1/0;le.pos<Le;){if(fn<=0){var Ze=le.readVarint();Lt=Ze&7,fn=Ze>>3}if(fn--,Lt===1||Lt===2)Nt+=le.readSVarint(),Jt+=le.readSVarint(),Nt<Ie&&(Ie=Nt),Nt>fe&&(fe=Nt),Jt<ce&&(ce=Jt),Jt>ve&&(ve=Jt);else if(Lt!==7)throw new Error("unknown command "+Lt)}return[Ie,ce,fe,ve]},pt.prototype.toGeoJSON=function(le,Le,Lt){var fn=this.extent*Math.pow(2,Lt),Nt=this.extent*le,Jt=this.extent*Le,Ie=this.loadGeometry(),fe=pt.types[this.type],ce,ve;function Ze(Vn){for(var mr=0;mr<Vn.length;mr++){var or=Vn[mr],He=180-(or.y+Jt)*360/fn;Vn[mr]=[(or.x+Nt)*360/fn-180,360/Math.PI*Math.atan(Math.exp(He*Math.PI/180))-90]}}switch(this.type){case 1:var Un=[];for(ce=0;ce<Ie.length;ce++)Un[ce]=Ie[ce][0];Ie=Un,Ze(Ie);break;case 2:for(ce=0;ce<Ie.length;ce++)Ze(Ie[ce]);break;case 3:for(Ie=yt(Ie),ce=0;ce<Ie.length;ce++)for(ve=0;ve<Ie[ce].length;ve++)Ze(Ie[ce][ve]);break}Ie.length===1?Ie=Ie[0]:fe="Multi"+fe;var En={type:"Feature",geometry:{type:fe,coordinates:Ie},properties:this.properties};return"id"in this&&(En.id=this.id),En};function yt(le){var Le=le.length;if(Le<=1)return[le];for(var Lt=[],fn,Nt,Jt=0;Jt<Le;Jt++){var Ie=xe(le[Jt]);Ie!==0&&(Nt===void 0&&(Nt=Ie<0),Nt===Ie<0?(fn&&Lt.push(fn),fn=[le[Jt]]):fn.push(le[Jt]))}return fn&&Lt.push(fn),Lt}function xe(le){for(var Le=0,Lt=0,fn=le.length,Nt=fn-1,Jt,Ie;Lt<fn;Nt=Lt++)Jt=le[Lt],Ie=le[Nt],Le+=(Ie.x-Jt.x)*(Jt.y+Ie.y);return Le}},59701:function(br,rr,it){"use strict";var ne=it(66024);br.exports=pt;function pt(yt,xe){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=yt,this._keys=[],this._values=[],this._features=[],yt.readFields(R,this,xe),this.length=this._features.length}function R(yt,xe,le){yt===15?xe.version=le.readVarint():yt===1?xe.name=le.readString():yt===5?xe.extent=le.readVarint():yt===2?xe._features.push(le.pos):yt===3?xe._keys.push(le.readString()):yt===4&&xe._values.push($e(le))}function $e(yt){for(var xe=null,le=yt.readVarint()+yt.pos;yt.pos<le;){var Le=yt.readVarint()>>3;xe=Le===1?yt.readString():Le===2?yt.readFloat():Le===3?yt.readDouble():Le===4?yt.readVarint64():Le===5?yt.readVarint():Le===6?yt.readSVarint():Le===7?yt.readBoolean():null}return xe}pt.prototype.feature=function(yt){if(yt<0||yt>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[yt];var xe=this._pbf.readVarint()+this._pbf.pos;return new ne(this._pbf,xe,this.extent,this._keys,this._values)}},98129:function(br,rr,it){"use strict";var ne=it(60690);br.exports=function($e){$e=$e||{};var yt=$e.reporter,xe=ne.getOption($e,"async",!0),le=ne.getOption($e,"auto",!0);le&&!xe&&(yt&&yt.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),xe=!0);var Le=pt(),Lt,fn=!1;function Nt(Un,En){!fn&&le&&xe&&Le.size()===0&&fe(),Le.add(Un,En)}function Jt(){for(fn=!0;Le.size();){var Un=Le;Le=pt(),Un.process()}fn=!1}function Ie(Un){fn||(Un===void 0&&(Un=xe),Lt&&(ve(Lt),Lt=null),Un?fe():Jt())}function fe(){Lt=Ze(Jt)}function ce(){Le={},batchSize=0,topLevel=0,bottomLevel=0}function ve(Un){var En=clearTimeout;return En(Un)}function Ze(Un){var En=function(Vn){return setTimeout(Vn,0)};return En(Un)}return{add:Nt,force:Ie}};function pt(){var R={},$e=0,yt=0,xe=0;function le(fn,Nt){Nt||(Nt=fn,fn=0),fn>yt?yt=fn:fn<xe&&(xe=fn),R[fn]||(R[fn]=[]),R[fn].push(Nt),$e++}function Le(){for(var fn=xe;fn<=yt;fn++)for(var Nt=R[fn],Jt=0;Jt<Nt.length;Jt++){var Ie=Nt[Jt];Ie()}}function Lt(){return $e}return{add:le,process:Le,size:Lt}}},60690:function(br){"use strict";var rr=br.exports={};rr.getOption=it;function it(ne,pt,R){var $e=ne[pt];return $e==null&&R!==void 0?R:$e}},8874:function(br){"use strict";br.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(br,rr,it){var ne=it(8874),pt=it(86851),R=Object.hasOwnProperty,$e=Object.create(null);for(var yt in ne)R.call(ne,yt)&&($e[ne[yt]]=yt);var xe=br.exports={to:{},get:{}};xe.get=function(Lt){var fn=Lt.substring(0,3).toLowerCase(),Nt,Jt;switch(fn){case"hsl":Nt=xe.get.hsl(Lt),Jt="hsl";break;case"hwb":Nt=xe.get.hwb(Lt),Jt="hwb";break;default:Nt=xe.get.rgb(Lt),Jt="rgb";break}return Nt?{model:Jt,value:Nt}:null},xe.get.rgb=function(Lt){if(!Lt)return null;var fn=/^#([a-f0-9]{3,4})$/i,Nt=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,Jt=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Ie=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,fe=/^(\w+)$/,ce=[0,0,0,1],ve,Ze,Un;if(ve=Lt.match(Nt)){for(Un=ve[2],ve=ve[1],Ze=0;Ze<3;Ze++){var En=Ze*2;ce[Ze]=parseInt(ve.slice(En,En+2),16)}Un&&(ce[3]=parseInt(Un,16)/255)}else if(ve=Lt.match(fn)){for(ve=ve[1],Un=ve[3],Ze=0;Ze<3;Ze++)ce[Ze]=parseInt(ve[Ze]+ve[Ze],16);Un&&(ce[3]=parseInt(Un+Un,16)/255)}else if(ve=Lt.match(Jt)){for(Ze=0;Ze<3;Ze++)ce[Ze]=parseInt(ve[Ze+1],0);ve[4]&&(ve[5]?ce[3]=parseFloat(ve[4])*.01:ce[3]=parseFloat(ve[4]))}else if(ve=Lt.match(Ie)){for(Ze=0;Ze<3;Ze++)ce[Ze]=Math.round(parseFloat(ve[Ze+1])*2.55);ve[4]&&(ve[5]?ce[3]=parseFloat(ve[4])*.01:ce[3]=parseFloat(ve[4]))}else return(ve=Lt.match(fe))?ve[1]==="transparent"?[0,0,0,0]:R.call(ne,ve[1])?(ce=ne[ve[1]],ce[3]=1,ce):null:null;for(Ze=0;Ze<3;Ze++)ce[Ze]=le(ce[Ze],0,255);return ce[3]=le(ce[3],0,1),ce},xe.get.hsl=function(Lt){if(!Lt)return null;var fn=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,Nt=Lt.match(fn);if(Nt){var Jt=parseFloat(Nt[4]),Ie=(parseFloat(Nt[1])%360+360)%360,fe=le(parseFloat(Nt[2]),0,100),ce=le(parseFloat(Nt[3]),0,100),ve=le(isNaN(Jt)?1:Jt,0,1);return[Ie,fe,ce,ve]}return null},xe.get.hwb=function(Lt){if(!Lt)return null;var fn=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,Nt=Lt.match(fn);if(Nt){var Jt=parseFloat(Nt[4]),Ie=(parseFloat(Nt[1])%360+360)%360,fe=le(parseFloat(Nt[2]),0,100),ce=le(parseFloat(Nt[3]),0,100),ve=le(isNaN(Jt)?1:Jt,0,1);return[Ie,fe,ce,ve]}return null},xe.to.hex=function(){var Lt=pt(arguments);return"#"+Le(Lt[0])+Le(Lt[1])+Le(Lt[2])+(Lt[3]<1?Le(Math.round(Lt[3]*255)):"")},xe.to.rgb=function(){var Lt=pt(arguments);return Lt.length<4||Lt[3]===1?"rgb("+Math.round(Lt[0])+", "+Math.round(Lt[1])+", "+Math.round(Lt[2])+")":"rgba("+Math.round(Lt[0])+", "+Math.round(Lt[1])+", "+Math.round(Lt[2])+", "+Lt[3]+")"},xe.to.rgb.percent=function(){var Lt=pt(arguments),fn=Math.round(Lt[0]/255*100),Nt=Math.round(Lt[1]/255*100),Jt=Math.round(Lt[2]/255*100);return Lt.length<4||Lt[3]===1?"rgb("+fn+"%, "+Nt+"%, "+Jt+"%)":"rgba("+fn+"%, "+Nt+"%, "+Jt+"%, "+Lt[3]+")"},xe.to.hsl=function(){var Lt=pt(arguments);return Lt.length<4||Lt[3]===1?"hsl("+Lt[0]+", "+Lt[1]+"%, "+Lt[2]+"%)":"hsla("+Lt[0]+", "+Lt[1]+"%, "+Lt[2]+"%, "+Lt[3]+")"},xe.to.hwb=function(){var Lt=pt(arguments),fn="";return Lt.length>=4&&Lt[3]!==1&&(fn=", "+Lt[3]),"hwb("+Lt[0]+", "+Lt[1]+"%, "+Lt[2]+"%"+fn+")"},xe.to.keyword=function(Lt){return $e[Lt.slice(0,3)]};function le(Lt,fn,Nt){return Math.min(Math.max(fn,Lt),Nt)}function Le(Lt){var fn=Math.round(Lt).toString(16).toUpperCase();return fn.length<2?"0"+fn:fn}},37620:function(br,rr,it){"use strict";it.d(rr,{ZP:function(){return Vn},B8:function(){return $t}});function ne(Ut,we,ie){Ut.prototype=we.prototype=ie,ie.constructor=Ut}function pt(Ut,we){var ie=Object.create(Ut.prototype);for(var _t in we)ie[_t]=we[_t];return ie}function R(){}var $e=.7,yt=1/$e,xe="\\s*([+-]?\\d+)\\s*",le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Le="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Lt=/^#([0-9a-f]{3,8})$/,fn=new RegExp("^rgb\\("+[xe,xe,xe]+"\\)$"),Nt=new RegExp("^rgb\\("+[Le,Le,Le]+"\\)$"),Jt=new RegExp("^rgba\\("+[xe,xe,xe,le]+"\\)$"),Ie=new RegExp("^rgba\\("+[Le,Le,Le,le]+"\\)$"),fe=new RegExp("^hsl\\("+[le,Le,Le]+"\\)$"),ce=new RegExp("^hsla\\("+[le,Le,Le,le]+"\\)$"),ve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ne(R,Vn,{copy:function(Ut){return Object.assign(new this.constructor,this,Ut)},displayable:function(){return this.rgb().displayable()},hex:Ze,formatHex:Ze,formatHsl:Un,formatRgb:En,toString:En});function Ze(){return this.rgb().formatHex()}function Un(){return Te(this).formatHsl()}function En(){return this.rgb().formatRgb()}function Vn(Ut){var we,ie;return Ut=(Ut+"").trim().toLowerCase(),(we=Lt.exec(Ut))?(ie=we[1].length,we=parseInt(we[1],16),ie===6?mr(we):ie===3?new nn(we>>8&15|we>>4&240,we>>4&15|we&240,(we&15)<<4|we&15,1):ie===8?or(we>>24&255,we>>16&255,we>>8&255,(we&255)/255):ie===4?or(we>>12&15|we>>8&240,we>>8&15|we>>4&240,we>>4&15|we&240,((we&15)<<4|we&15)/255):null):(we=fn.exec(Ut))?new nn(we[1],we[2],we[3],1):(we=Nt.exec(Ut))?new nn(we[1]*255/100,we[2]*255/100,we[3]*255/100,1):(we=Jt.exec(Ut))?or(we[1],we[2],we[3],we[4]):(we=Ie.exec(Ut))?or(we[1]*255/100,we[2]*255/100,we[3]*255/100,we[4]):(we=fe.exec(Ut))?kt(we[1],we[2]/100,we[3]/100,1):(we=ce.exec(Ut))?kt(we[1],we[2]/100,we[3]/100,we[4]):ve.hasOwnProperty(Ut)?mr(ve[Ut]):Ut==="transparent"?new nn(NaN,NaN,NaN,0):null}function mr(Ut){return new nn(Ut>>16&255,Ut>>8&255,Ut&255,1)}function or(Ut,we,ie,_t){return _t<=0&&(Ut=we=ie=NaN),new nn(Ut,we,ie,_t)}function He(Ut){return Ut instanceof R||(Ut=Vn(Ut)),Ut?(Ut=Ut.rgb(),new nn(Ut.r,Ut.g,Ut.b,Ut.opacity)):new nn}function $t(Ut,we,ie,_t){return arguments.length===1?He(Ut):new nn(Ut,we,ie,_t==null?1:_t)}function nn(Ut,we,ie,_t){this.r=+Ut,this.g=+we,this.b=+ie,this.opacity=+_t}ne(nn,$t,pt(R,{brighter:function(Ut){return Ut=Ut==null?yt:Math.pow(yt,Ut),new nn(this.r*Ut,this.g*Ut,this.b*Ut,this.opacity)},darker:function(Ut){return Ut=Ut==null?$e:Math.pow($e,Ut),new nn(this.r*Ut,this.g*Ut,this.b*Ut,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ke,formatHex:ke,formatRgb:Je,toString:Je}));function ke(){return"#"+er(this.r)+er(this.g)+er(this.b)}function Je(){var Ut=this.opacity;return Ut=isNaN(Ut)?1:Math.max(0,Math.min(1,Ut)),(Ut===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Ut===1?")":", "+Ut+")")}function er(Ut){return Ut=Math.max(0,Math.min(255,Math.round(Ut)||0)),(Ut<16?"0":"")+Ut.toString(16)}function kt(Ut,we,ie,_t){return _t<=0?Ut=we=ie=NaN:ie<=0||ie>=1?Ut=we=NaN:we<=0&&(Ut=NaN),new te(Ut,we,ie,_t)}function Te(Ut){if(Ut instanceof te)return new te(Ut.h,Ut.s,Ut.l,Ut.opacity);if(Ut instanceof R||(Ut=Vn(Ut)),!Ut)return new te;if(Ut instanceof te)return Ut;Ut=Ut.rgb();var we=Ut.r/255,ie=Ut.g/255,_t=Ut.b/255,Ne=Math.min(we,ie,_t),un=Math.max(we,ie,_t),Qn=NaN,hr=un-Ne,Er=(un+Ne)/2;return hr?(we===un?Qn=(ie-_t)/hr+(ie<_t)*6:ie===un?Qn=(_t-we)/hr+2:Qn=(we-ie)/hr+4,hr/=Er<.5?un+Ne:2-un-Ne,Qn*=60):hr=Er>0&&Er<1?0:Qn,new te(Qn,hr,Er,Ut.opacity)}function gt(Ut,we,ie,_t){return arguments.length===1?Te(Ut):new te(Ut,we,ie,_t==null?1:_t)}function te(Ut,we,ie,_t){this.h=+Ut,this.s=+we,this.l=+ie,this.opacity=+_t}ne(te,gt,pt(R,{brighter:function(Ut){return Ut=Ut==null?yt:Math.pow(yt,Ut),new te(this.h,this.s,this.l*Ut,this.opacity)},darker:function(Ut){return Ut=Ut==null?$e:Math.pow($e,Ut),new te(this.h,this.s,this.l*Ut,this.opacity)},rgb:function(){var Ut=this.h%360+(this.h<0)*360,we=isNaN(Ut)||isNaN(this.s)?0:this.s,ie=this.l,_t=ie+(ie<.5?ie:1-ie)*we,Ne=2*ie-_t;return new nn(Zt(Ut>=240?Ut-240:Ut+120,Ne,_t),Zt(Ut,Ne,_t),Zt(Ut<120?Ut+240:Ut-120,Ne,_t),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Ut=this.opacity;return Ut=isNaN(Ut)?1:Math.max(0,Math.min(1,Ut)),(Ut===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Ut===1?")":", "+Ut+")")}}));function Zt(Ut,we,ie){return(Ut<60?we+(ie-we)*Ut/60:Ut<180?ie:Ut<240?we+(ie-we)*(240-Ut)/60:we)*255}},9187:function(br){"use strict";br.exports=rr,br.exports.default=rr;function rr(gt,te,Zt){Zt=Zt||2;var Ut=te&&te.length,we=Ut?te[0]*Zt:gt.length,ie=it(gt,0,we,Zt,!0),_t=[];if(!ie||ie.next===ie.prev)return _t;var Ne,un,Qn,hr,Er,Ue,cn;if(Ut&&(ie=le(gt,te,ie,Zt)),gt.length>80*Zt){Ne=Qn=gt[0],un=hr=gt[1];for(var wn=Zt;wn<we;wn+=Zt)Er=gt[wn],Ue=gt[wn+1],Er<Ne&&(Ne=Er),Ue<un&&(un=Ue),Er>Qn&&(Qn=Er),Ue>hr&&(hr=Ue);cn=Math.max(Qn-Ne,hr-un),cn=cn!==0?32767/cn:0}return pt(ie,_t,Zt,Ne,un,cn,0),_t}function it(gt,te,Zt,Ut,we){var ie,_t;if(we===Te(gt,te,Zt,Ut)>0)for(ie=te;ie<Zt;ie+=Ut)_t=Je(ie,gt[ie],gt[ie+1],_t);else for(ie=Zt-Ut;ie>=te;ie-=Ut)_t=Je(ie,gt[ie],gt[ie+1],_t);return _t&&En(_t,_t.next)&&(er(_t),_t=_t.next),_t}function ne(gt,te){if(!gt)return gt;te||(te=gt);var Zt=gt,Ut;do if(Ut=!1,!Zt.steiner&&(En(Zt,Zt.next)||Un(Zt.prev,Zt,Zt.next)===0)){if(er(Zt),Zt=te=Zt.prev,Zt===Zt.next)break;Ut=!0}else Zt=Zt.next;while(Ut||Zt!==te);return te}function pt(gt,te,Zt,Ut,we,ie,_t){if(gt){!_t&&ie&&Jt(gt,Ut,we,ie);for(var Ne=gt,un,Qn;gt.prev!==gt.next;){if(un=gt.prev,Qn=gt.next,ie?$e(gt,Ut,we,ie):R(gt)){te.push(un.i/Zt|0),te.push(gt.i/Zt|0),te.push(Qn.i/Zt|0),er(gt),gt=Qn.next,Ne=Qn.next;continue}if(gt=Qn,gt===Ne){_t?_t===1?(gt=yt(ne(gt),te,Zt),pt(gt,te,Zt,Ut,we,ie,2)):_t===2&&xe(gt,te,Zt,Ut,we,ie):pt(ne(gt),te,Zt,Ut,we,ie,1);break}}}}function R(gt){var te=gt.prev,Zt=gt,Ut=gt.next;if(Un(te,Zt,Ut)>=0)return!1;for(var we=te.x,ie=Zt.x,_t=Ut.x,Ne=te.y,un=Zt.y,Qn=Ut.y,hr=we<ie?we<_t?we:_t:ie<_t?ie:_t,Er=Ne<un?Ne<Qn?Ne:Qn:un<Qn?un:Qn,Ue=we>ie?we>_t?we:_t:ie>_t?ie:_t,cn=Ne>un?Ne>Qn?Ne:Qn:un>Qn?un:Qn,wn=Ut.next;wn!==te;){if(wn.x>=hr&&wn.x<=Ue&&wn.y>=Er&&wn.y<=cn&&ve(we,Ne,ie,un,_t,Qn,wn.x,wn.y)&&Un(wn.prev,wn,wn.next)>=0)return!1;wn=wn.next}return!0}function $e(gt,te,Zt,Ut){var we=gt.prev,ie=gt,_t=gt.next;if(Un(we,ie,_t)>=0)return!1;for(var Ne=we.x,un=ie.x,Qn=_t.x,hr=we.y,Er=ie.y,Ue=_t.y,cn=Ne<un?Ne<Qn?Ne:Qn:un<Qn?un:Qn,wn=hr<Er?hr<Ue?hr:Ue:Er<Ue?Er:Ue,ir=Ne>un?Ne>Qn?Ne:Qn:un>Qn?un:Qn,rn=hr>Er?hr>Ue?hr:Ue:Er>Ue?Er:Ue,De=fe(cn,wn,te,Zt,Ut),Be=fe(ir,rn,te,Zt,Ut),At=gt.prevZ,Bt=gt.nextZ;At&&At.z>=De&&Bt&&Bt.z<=Be;){if(At.x>=cn&&At.x<=ir&&At.y>=wn&&At.y<=rn&&At!==we&&At!==_t&&ve(Ne,hr,un,Er,Qn,Ue,At.x,At.y)&&Un(At.prev,At,At.next)>=0||(At=At.prevZ,Bt.x>=cn&&Bt.x<=ir&&Bt.y>=wn&&Bt.y<=rn&&Bt!==we&&Bt!==_t&&ve(Ne,hr,un,Er,Qn,Ue,Bt.x,Bt.y)&&Un(Bt.prev,Bt,Bt.next)>=0))return!1;Bt=Bt.nextZ}for(;At&&At.z>=De;){if(At.x>=cn&&At.x<=ir&&At.y>=wn&&At.y<=rn&&At!==we&&At!==_t&&ve(Ne,hr,un,Er,Qn,Ue,At.x,At.y)&&Un(At.prev,At,At.next)>=0)return!1;At=At.prevZ}for(;Bt&&Bt.z<=Be;){if(Bt.x>=cn&&Bt.x<=ir&&Bt.y>=wn&&Bt.y<=rn&&Bt!==we&&Bt!==_t&&ve(Ne,hr,un,Er,Qn,Ue,Bt.x,Bt.y)&&Un(Bt.prev,Bt,Bt.next)>=0)return!1;Bt=Bt.nextZ}return!0}function yt(gt,te,Zt){var Ut=gt;do{var we=Ut.prev,ie=Ut.next.next;!En(we,ie)&&Vn(we,Ut,Ut.next,ie)&&$t(we,ie)&&$t(ie,we)&&(te.push(we.i/Zt|0),te.push(Ut.i/Zt|0),te.push(ie.i/Zt|0),er(Ut),er(Ut.next),Ut=gt=ie),Ut=Ut.next}while(Ut!==gt);return ne(Ut)}function xe(gt,te,Zt,Ut,we,ie){var _t=gt;do{for(var Ne=_t.next.next;Ne!==_t.prev;){if(_t.i!==Ne.i&&Ze(_t,Ne)){var un=ke(_t,Ne);_t=ne(_t,_t.next),un=ne(un,un.next),pt(_t,te,Zt,Ut,we,ie,0),pt(un,te,Zt,Ut,we,ie,0);return}Ne=Ne.next}_t=_t.next}while(_t!==gt)}function le(gt,te,Zt,Ut){var we=[],ie,_t,Ne,un,Qn;for(ie=0,_t=te.length;ie<_t;ie++)Ne=te[ie]*Ut,un=ie<_t-1?te[ie+1]*Ut:gt.length,Qn=it(gt,Ne,un,Ut,!1),Qn===Qn.next&&(Qn.steiner=!0),we.push(ce(Qn));for(we.sort(Le),ie=0;ie<we.length;ie++)Zt=Lt(we[ie],Zt);return Zt}function Le(gt,te){return gt.x-te.x}function Lt(gt,te){var Zt=fn(gt,te);if(!Zt)return te;var Ut=ke(Zt,gt);return ne(Ut,Ut.next),ne(Zt,Zt.next)}function fn(gt,te){var Zt=te,Ut=gt.x,we=gt.y,ie=-1/0,_t;do{if(we<=Zt.y&&we>=Zt.next.y&&Zt.next.y!==Zt.y){var Ne=Zt.x+(we-Zt.y)*(Zt.next.x-Zt.x)/(Zt.next.y-Zt.y);if(Ne<=Ut&&Ne>ie&&(ie=Ne,_t=Zt.x<Zt.next.x?Zt:Zt.next,Ne===Ut))return _t}Zt=Zt.next}while(Zt!==te);if(!_t)return null;var un=_t,Qn=_t.x,hr=_t.y,Er=1/0,Ue;Zt=_t;do Ut>=Zt.x&&Zt.x>=Qn&&Ut!==Zt.x&&ve(we<hr?Ut:ie,we,Qn,hr,we<hr?ie:Ut,we,Zt.x,Zt.y)&&(Ue=Math.abs(we-Zt.y)/(Ut-Zt.x),$t(Zt,gt)&&(Ue<Er||Ue===Er&&(Zt.x>_t.x||Zt.x===_t.x&&Nt(_t,Zt)))&&(_t=Zt,Er=Ue)),Zt=Zt.next;while(Zt!==un);return _t}function Nt(gt,te){return Un(gt.prev,gt,te.prev)<0&&Un(te.next,gt,gt.next)<0}function Jt(gt,te,Zt,Ut){var we=gt;do we.z===0&&(we.z=fe(we.x,we.y,te,Zt,Ut)),we.prevZ=we.prev,we.nextZ=we.next,we=we.next;while(we!==gt);we.prevZ.nextZ=null,we.prevZ=null,Ie(we)}function Ie(gt){var te,Zt,Ut,we,ie,_t,Ne,un,Qn=1;do{for(Zt=gt,gt=null,ie=null,_t=0;Zt;){for(_t++,Ut=Zt,Ne=0,te=0;te<Qn&&(Ne++,Ut=Ut.nextZ,!!Ut);te++);for(un=Qn;Ne>0||un>0&&Ut;)Ne!==0&&(un===0||!Ut||Zt.z<=Ut.z)?(we=Zt,Zt=Zt.nextZ,Ne--):(we=Ut,Ut=Ut.nextZ,un--),ie?ie.nextZ=we:gt=we,we.prevZ=ie,ie=we;Zt=Ut}ie.nextZ=null,Qn*=2}while(_t>1);return gt}function fe(gt,te,Zt,Ut,we){return gt=(gt-Zt)*we|0,te=(te-Ut)*we|0,gt=(gt|gt<<8)&16711935,gt=(gt|gt<<4)&252645135,gt=(gt|gt<<2)&858993459,gt=(gt|gt<<1)&1431655765,te=(te|te<<8)&16711935,te=(te|te<<4)&252645135,te=(te|te<<2)&858993459,te=(te|te<<1)&1431655765,gt|te<<1}function ce(gt){var te=gt,Zt=gt;do(te.x<Zt.x||te.x===Zt.x&&te.y<Zt.y)&&(Zt=te),te=te.next;while(te!==gt);return Zt}function ve(gt,te,Zt,Ut,we,ie,_t,Ne){return(we-_t)*(te-Ne)>=(gt-_t)*(ie-Ne)&&(gt-_t)*(Ut-Ne)>=(Zt-_t)*(te-Ne)&&(Zt-_t)*(ie-Ne)>=(we-_t)*(Ut-Ne)}function Ze(gt,te){return gt.next.i!==te.i&&gt.prev.i!==te.i&&!He(gt,te)&&($t(gt,te)&&$t(te,gt)&&nn(gt,te)&&(Un(gt.prev,gt,te.prev)||Un(gt,te.prev,te))||En(gt,te)&&Un(gt.prev,gt,gt.next)>0&&Un(te.prev,te,te.next)>0)}function Un(gt,te,Zt){return(te.y-gt.y)*(Zt.x-te.x)-(te.x-gt.x)*(Zt.y-te.y)}function En(gt,te){return gt.x===te.x&&gt.y===te.y}function Vn(gt,te,Zt,Ut){var we=or(Un(gt,te,Zt)),ie=or(Un(gt,te,Ut)),_t=or(Un(Zt,Ut,gt)),Ne=or(Un(Zt,Ut,te));return!!(we!==ie&&_t!==Ne||we===0&&mr(gt,Zt,te)||ie===0&&mr(gt,Ut,te)||_t===0&&mr(Zt,gt,Ut)||Ne===0&&mr(Zt,te,Ut))}function mr(gt,te,Zt){return te.x<=Math.max(gt.x,Zt.x)&&te.x>=Math.min(gt.x,Zt.x)&&te.y<=Math.max(gt.y,Zt.y)&&te.y>=Math.min(gt.y,Zt.y)}function or(gt){return gt>0?1:gt<0?-1:0}function He(gt,te){var Zt=gt;do{if(Zt.i!==gt.i&&Zt.next.i!==gt.i&&Zt.i!==te.i&&Zt.next.i!==te.i&&Vn(Zt,Zt.next,gt,te))return!0;Zt=Zt.next}while(Zt!==gt);return!1}function $t(gt,te){return Un(gt.prev,gt,gt.next)<0?Un(gt,te,gt.next)>=0&&Un(gt,gt.prev,te)>=0:Un(gt,te,gt.prev)<0||Un(gt,gt.next,te)<0}function nn(gt,te){var Zt=gt,Ut=!1,we=(gt.x+te.x)/2,ie=(gt.y+te.y)/2;do Zt.y>ie!=Zt.next.y>ie&&Zt.next.y!==Zt.y&&we<(Zt.next.x-Zt.x)*(ie-Zt.y)/(Zt.next.y-Zt.y)+Zt.x&&(Ut=!Ut),Zt=Zt.next;while(Zt!==gt);return Ut}function ke(gt,te){var Zt=new kt(gt.i,gt.x,gt.y),Ut=new kt(te.i,te.x,te.y),we=gt.next,ie=te.prev;return gt.next=te,te.prev=gt,Zt.next=we,we.prev=Zt,Ut.next=Zt,Zt.prev=Ut,ie.next=Ut,Ut.prev=ie,Ut}function Je(gt,te,Zt,Ut){var we=new kt(gt,te,Zt);return Ut?(we.next=Ut.next,we.prev=Ut,Ut.next.prev=we,Ut.next=we):(we.prev=we,we.next=we),we}function er(gt){gt.next.prev=gt.prev,gt.prev.next=gt.next,gt.prevZ&&(gt.prevZ.nextZ=gt.nextZ),gt.nextZ&&(gt.nextZ.prevZ=gt.prevZ)}function kt(gt,te,Zt){this.i=gt,this.x=te,this.y=Zt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}rr.deviation=function(gt,te,Zt,Ut){var we=te&&te.length,ie=we?te[0]*Zt:gt.length,_t=Math.abs(Te(gt,0,ie,Zt));if(we)for(var Ne=0,un=te.length;Ne<un;Ne++){var Qn=te[Ne]*Zt,hr=Ne<un-1?te[Ne+1]*Zt:gt.length;_t-=Math.abs(Te(gt,Qn,hr,Zt))}var Er=0;for(Ne=0;Ne<Ut.length;Ne+=3){var Ue=Ut[Ne]*Zt,cn=Ut[Ne+1]*Zt,wn=Ut[Ne+2]*Zt;Er+=Math.abs((gt[Ue]-gt[wn])*(gt[cn+1]-gt[Ue+1])-(gt[Ue]-gt[cn])*(gt[wn+1]-gt[Ue+1]))}return _t===0&&Er===0?0:Math.abs((Er-_t)/_t)};function Te(gt,te,Zt,Ut){for(var we=0,ie=te,_t=Zt-Ut;ie<Zt;ie+=Ut)we+=(gt[_t]-gt[ie])*(gt[ie+1]+gt[_t+1]),_t=ie;return we}rr.flatten=function(gt){for(var te=gt[0][0].length,Zt={vertices:[],holes:[],dimensions:te},Ut=0,we=0;we<gt.length;we++){for(var ie=0;ie<gt[we].length;ie++)for(var _t=0;_t<te;_t++)Zt.vertices.push(gt[we][ie][_t]);we>0&&(Ut+=gt[we-1].length,Zt.holes.push(Ut))}return Zt}},2268:function(br){"use strict";var rr=br.exports={};rr.isIE=function(it){function ne(){var R=navigator.userAgent.toLowerCase();return R.indexOf("msie")!==-1||R.indexOf("trident")!==-1||R.indexOf(" edge/")!==-1}if(!ne())return!1;if(!it)return!0;var pt=function(){var R,$e=3,yt=document.createElement("div"),xe=yt.getElementsByTagName("i");do yt.innerHTML="<!--[if gt IE "+ ++$e+"]><i></i><![endif]-->";while(xe[0]);return $e>4?$e:R}();return it===pt},rr.isLegacyOpera=function(){return!!window.opera}},17900:function(br){"use strict";var rr=br.exports={};rr.forEach=function(it,ne){for(var pt=0;pt<it.length;pt++){var R=ne(it[pt]);if(R)return R}}},58229:function(br,rr,it){"use strict";var ne=it(2268);br.exports=function(pt){pt=pt||{};var R=pt.reporter,$e=pt.batchProcessor,yt=pt.stateHandler.getState;if(!R)throw new Error("Missing required dependency: reporter.");function xe(Nt,Jt){function Ie(){Jt(Nt)}if(ne.isIE(8))yt(Nt).object={proxy:Ie},Nt.attachEvent("onresize",Ie);else{var fe=Lt(Nt);if(!fe)throw new Error("Element is not detectable by this strategy.");fe.contentDocument.defaultView.addEventListener("resize",Ie)}}function le(Nt){var Jt=pt.important?" !important; ":"; ";return(Nt.join(Jt)+Jt).trim()}function Le(Nt,Jt,Ie){Ie||(Ie=Jt,Jt=Nt,Nt=null),Nt=Nt||{};var fe=Nt.debug;function ce(ve,Ze){var Un=le(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),En=!1,Vn=window.getComputedStyle(ve),mr=ve.offsetWidth,or=ve.offsetHeight;yt(ve).startSize={width:mr,height:or};function He(){function $t(){if(Vn.position==="static"){ve.style.setProperty("position","relative",Nt.important?"important":"");var Je=function(er,kt,Te,gt){function te(Ut){return Ut.replace(/[^-\d\.]/g,"")}var Zt=Te[gt];Zt!=="auto"&&te(Zt)!=="0"&&(er.warn("An element that is positioned static has style."+gt+"="+Zt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+gt+" will be set to 0. Element: ",kt),kt.style.setProperty(gt,"0",Nt.important?"important":""))};Je(R,ve,Vn,"top"),Je(R,ve,Vn,"right"),Je(R,ve,Vn,"bottom"),Je(R,ve,Vn,"left")}}function nn(){En||$t();function Je(kt,Te){if(!kt.contentDocument){var gt=yt(kt);gt.checkForObjectDocumentTimeoutId&&window.clearTimeout(gt.checkForObjectDocumentTimeoutId),gt.checkForObjectDocumentTimeoutId=setTimeout(function(){gt.checkForObjectDocumentTimeoutId=0,Je(kt,Te)},100);return}Te(kt.contentDocument)}var er=this;Je(er,function(Te){Ze(ve)})}Vn.position!==""&&($t(Vn),En=!0);var ke=document.createElement("object");ke.style.cssText=Un,ke.tabIndex=-1,ke.type="text/html",ke.setAttribute("aria-hidden","true"),ke.onload=nn,ne.isIE()||(ke.data="about:blank"),yt(ve)&&(ve.appendChild(ke),yt(ve).object=ke,ne.isIE()&&(ke.data="about:blank"))}$e?$e.add(He):He()}ne.isIE(8)?Ie(Jt):ce(Jt,Ie)}function Lt(Nt){return yt(Nt).object}function fn(Nt){if(yt(Nt)){var Jt=Lt(Nt);Jt&&(ne.isIE(8)?Nt.detachEvent("onresize",Jt.proxy):Nt.removeChild(Jt),yt(Nt).checkForObjectDocumentTimeoutId&&window.clearTimeout(yt(Nt).checkForObjectDocumentTimeoutId),delete yt(Nt).object)}}return{makeDetectable:Le,addListener:xe,uninstall:fn}}},60787:function(br,rr,it){"use strict";var ne=it(17900).forEach;br.exports=function(pt){pt=pt||{};var R=pt.reporter,$e=pt.batchProcessor,yt=pt.stateHandler.getState,xe=pt.stateHandler.hasState,le=pt.idHandler;if(!$e)throw new Error("Missing required dependency: batchProcessor");if(!R)throw new Error("Missing required dependency: reporter.");var Le=Ie(),Lt="erd_scroll_detection_scrollbar_style",fn="erd_scroll_detection_container";function Nt(He){fe(He,Lt,fn)}Nt(window.document);function Jt(He){var $t=pt.important?" !important; ":"; ";return(He.join($t)+$t).trim()}function Ie(){var He=500,$t=500,nn=document.createElement("div");nn.style.cssText=Jt(["position: absolute","width: "+He*2+"px","height: "+$t*2+"px","visibility: hidden","margin: 0","padding: 0"]);var ke=document.createElement("div");ke.style.cssText=Jt(["position: absolute","width: "+He+"px","height: "+$t+"px","overflow: scroll","visibility: none","top: "+-He*3+"px","left: "+-$t*3+"px","visibility: hidden","margin: 0","padding: 0"]),ke.appendChild(nn),document.body.insertBefore(ke,document.body.firstChild);var Je=He-ke.clientWidth,er=$t-ke.clientHeight;return document.body.removeChild(ke),{width:Je,height:er}}function fe(He,$t,nn){function ke(Te,gt){gt=gt||function(Zt){He.head.appendChild(Zt)};var te=He.createElement("style");return te.innerHTML=Te,te.id=$t,gt(te),te}if(!He.getElementById($t)){var Je=nn+"_animation",er=nn+"_animation_active",kt=`/* Created by the element-resize-detector library. */
`;kt+="."+nn+" > div::-webkit-scrollbar { "+Jt(["display: none"])+` }

`,kt+="."+er+" { "+Jt(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+Je,"animation-name: "+Je])+` }
`,kt+="@-webkit-keyframes "+Je+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,kt+="@keyframes "+Je+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",ke(kt)}}function ce(He){He.className+=" "+fn+"_animation_active"}function ve(He,$t,nn){if(He.addEventListener)He.addEventListener($t,nn);else if(He.attachEvent)He.attachEvent("on"+$t,nn);else return R.error("[scroll] Don't know how to add event listeners.")}function Ze(He,$t,nn){if(He.removeEventListener)He.removeEventListener($t,nn);else if(He.detachEvent)He.detachEvent("on"+$t,nn);else return R.error("[scroll] Don't know how to remove event listeners.")}function Un(He){return yt(He).container.childNodes[0].childNodes[0].childNodes[0]}function En(He){return yt(He).container.childNodes[0].childNodes[0].childNodes[1]}function Vn(He,$t){var nn=yt(He).listeners;if(!nn.push)throw new Error("Cannot add listener to an element that is not detectable.");yt(He).listeners.push($t)}function mr(He,$t,nn){nn||(nn=$t,$t=He,He=null),He=He||{};function ke(){if(He.debug){var De=Array.prototype.slice.call(arguments);if(De.unshift(le.get($t),"Scroll: "),R.log.apply)R.log.apply(null,De);else for(var Be=0;Be<De.length;Be++)R.log(De[Be])}}function Je(De){function Be(At){var Bt=At.getRootNode&&At.getRootNode().contains(At);return At===At.ownerDocument.body||At.ownerDocument.body.contains(At)||Bt}return!Be(De)||window.getComputedStyle(De)===null}function er(De){var Be=yt(De).container.childNodes[0],At=window.getComputedStyle(Be);return!At.width||At.width.indexOf("px")===-1}function kt(){var De=window.getComputedStyle($t),Be={};return Be.position=De.position,Be.width=$t.offsetWidth,Be.height=$t.offsetHeight,Be.top=De.top,Be.right=De.right,Be.bottom=De.bottom,Be.left=De.left,Be.widthCSS=De.width,Be.heightCSS=De.height,Be}function Te(){var De=kt();yt($t).startSize={width:De.width,height:De.height},ke("Element start size",yt($t).startSize)}function gt(){yt($t).listeners=[]}function te(){if(ke("storeStyle invoked."),!yt($t)){ke("Aborting because element has been uninstalled");return}var De=kt();yt($t).style=De}function Zt(De,Be,At){yt(De).lastWidth=Be,yt(De).lastHeight=At}function Ut(De){return Un(De).childNodes[0]}function we(){return 2*Le.width+1}function ie(){return 2*Le.height+1}function _t(De){return De+10+we()}function Ne(De){return De+10+ie()}function un(De){return De*2+we()}function Qn(De){return De*2+ie()}function hr(De,Be,At){var Bt=Un(De),Ae=En(De),z=_t(Be),rt=Ne(At),F=un(Be),ot=Qn(At);Bt.scrollLeft=z,Bt.scrollTop=rt,Ae.scrollLeft=F,Ae.scrollTop=ot}function Er(){var De=yt($t).container;if(!De){De=document.createElement("div"),De.className=fn,De.style.cssText=Jt(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),yt($t).container=De,ce(De),$t.appendChild(De);var Be=function(){yt($t).onRendered&&yt($t).onRendered()};ve(De,"animationstart",Be),yt($t).onAnimationStart=Be}return De}function Ue(){function De(){var Cn=yt($t).style;if(Cn.position==="static"){$t.style.setProperty("position","relative",He.important?"important":"");var Zn=function(Qt,ct,bt,zt){function me(bn){return bn.replace(/[^-\d\.]/g,"")}var de=bt[zt];de!=="auto"&&me(de)!=="0"&&(Qt.warn("An element that is positioned static has style."+zt+"="+de+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+zt+" will be set to 0. Element: ",ct),ct.style[zt]=0)};Zn(R,$t,Cn,"top"),Zn(R,$t,Cn,"right"),Zn(R,$t,Cn,"bottom"),Zn(R,$t,Cn,"left")}}function Be(Cn,Zn,Qt,ct){return Cn=Cn?Cn+"px":"0",Zn=Zn?Zn+"px":"0",Qt=Qt?Qt+"px":"0",ct=ct?ct+"px":"0",["left: "+Cn,"top: "+Zn,"right: "+ct,"bottom: "+Qt]}if(ke("Injecting elements"),!yt($t)){ke("Aborting because element has been uninstalled");return}De();var At=yt($t).container;At||(At=Er());var Bt=Le.width,Ae=Le.height,z=Jt(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),rt=Jt(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(Be(-(1+Bt),-(1+Ae),-Ae,-Bt))),F=Jt(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ot=Jt(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ze=Jt(["position: absolute","left: 0","top: 0"]),Vt=Jt(["position: absolute","width: 200%","height: 200%"]),ae=document.createElement("div"),Mn=document.createElement("div"),zn=document.createElement("div"),Wn=document.createElement("div"),sn=document.createElement("div"),Kt=document.createElement("div");ae.dir="ltr",ae.style.cssText=z,ae.className=fn,Mn.className=fn,Mn.style.cssText=rt,zn.style.cssText=F,Wn.style.cssText=ze,sn.style.cssText=ot,Kt.style.cssText=Vt,zn.appendChild(Wn),sn.appendChild(Kt),Mn.appendChild(zn),Mn.appendChild(sn),ae.appendChild(Mn),At.appendChild(ae);function Ce(){var Cn=yt($t);Cn&&Cn.onExpand?Cn.onExpand():ke("Aborting expand scroll handler: element has been uninstalled")}function xn(){var Cn=yt($t);Cn&&Cn.onShrink?Cn.onShrink():ke("Aborting shrink scroll handler: element has been uninstalled")}ve(zn,"scroll",Ce),ve(sn,"scroll",xn),yt($t).onExpandScroll=Ce,yt($t).onShrinkScroll=xn}function cn(){function De(F,ot,ze){var Vt=Ut(F),ae=_t(ot),Mn=Ne(ze);Vt.style.setProperty("width",ae+"px",He.important?"important":""),Vt.style.setProperty("height",Mn+"px",He.important?"important":"")}function Be(F){var ot=$t.offsetWidth,ze=$t.offsetHeight,Vt=ot!==yt($t).lastWidth||ze!==yt($t).lastHeight;ke("Storing current size",ot,ze),Zt($t,ot,ze),$e.add(0,function(){if(Vt){if(!yt($t)){ke("Aborting because element has been uninstalled");return}if(!At()){ke("Aborting because element container has not been initialized");return}if(He.debug){var Mn=$t.offsetWidth,zn=$t.offsetHeight;(Mn!==ot||zn!==ze)&&R.warn(le.get($t),"Scroll: Size changed before updating detector elements.")}De($t,ot,ze)}}),$e.add(1,function(){if(!yt($t)){ke("Aborting because element has been uninstalled");return}if(!At()){ke("Aborting because element container has not been initialized");return}hr($t,ot,ze)}),Vt&&F&&$e.add(2,function(){if(!yt($t)){ke("Aborting because element has been uninstalled");return}if(!At()){ke("Aborting because element container has not been initialized");return}F()})}function At(){return!!yt($t).container}function Bt(){function F(){return yt($t).lastNotifiedWidth===void 0}ke("notifyListenersIfNeeded invoked");var ot=yt($t);if(F()&&ot.lastWidth===ot.startSize.width&&ot.lastHeight===ot.startSize.height)return ke("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(ot.lastWidth===ot.lastNotifiedWidth&&ot.lastHeight===ot.lastNotifiedHeight)return ke("Not notifying: Size already notified");ke("Current size not notified, notifying..."),ot.lastNotifiedWidth=ot.lastWidth,ot.lastNotifiedHeight=ot.lastHeight,ne(yt($t).listeners,function(ze){ze($t)})}function Ae(){if(ke("startanimation triggered."),er($t)){ke("Ignoring since element is still unrendered...");return}ke("Element rendered.");var F=Un($t),ot=En($t);(F.scrollLeft===0||F.scrollTop===0||ot.scrollLeft===0||ot.scrollTop===0)&&(ke("Scrollbars out of sync. Updating detector elements..."),Be(Bt))}function z(){if(ke("Scroll detected."),er($t)){ke("Scroll event fired while unrendered. Ignoring...");return}Be(Bt)}if(ke("registerListenersAndPositionElements invoked."),!yt($t)){ke("Aborting because element has been uninstalled");return}yt($t).onRendered=Ae,yt($t).onExpand=z,yt($t).onShrink=z;var rt=yt($t).style;De($t,rt.width,rt.height)}function wn(){if(ke("finalizeDomMutation invoked."),!yt($t)){ke("Aborting because element has been uninstalled");return}var De=yt($t).style;Zt($t,De.width,De.height),hr($t,De.width,De.height)}function ir(){nn($t)}function rn(){ke("Installing..."),gt(),Te(),$e.add(0,te),$e.add(1,Ue),$e.add(2,cn),$e.add(3,wn),$e.add(4,ir)}ke("Making detectable..."),Je($t)?(ke("Element is detached"),Er(),ke("Waiting until element is attached..."),yt($t).onRendered=function(){ke("Element is now attached"),rn()}):rn()}function or(He){var $t=yt(He);$t&&($t.onExpandScroll&&Ze(Un(He),"scroll",$t.onExpandScroll),$t.onShrinkScroll&&Ze(En(He),"scroll",$t.onShrinkScroll),$t.onAnimationStart&&Ze($t.container,"animationstart",$t.onAnimationStart),$t.container&&He.removeChild($t.container))}return{makeDetectable:mr,addListener:Vn,uninstall:or,initDocument:Nt}}},63844:function(br,rr,it){"use strict";var ne=it(17900).forEach,pt=it(68452),R=it(96199),$e=it(75805),yt=it(79799),xe=it(71724),le=it(2268),Le=it(98129),Lt=it(21931),fn=it(58229),Nt=it(60787);function Jt(ve){return Array.isArray(ve)||ve.length!==void 0}function Ie(ve){if(Array.isArray(ve))return ve;var Ze=[];return ne(ve,function(Un){Ze.push(Un)}),Ze}function fe(ve){return ve&&ve.nodeType===1}br.exports=function(ve){ve=ve||{};var Ze;if(ve.idHandler)Ze={get:function(Ut){return ve.idHandler.get(Ut,!0)},set:ve.idHandler.set};else{var Un=$e(),En=yt({idGenerator:Un,stateHandler:Lt});Ze=En}var Vn=ve.reporter;if(!Vn){var mr=Vn===!1;Vn=xe(mr)}var or=ce(ve,"batchProcessor",Le({reporter:Vn})),He={};He.callOnAdd=!!ce(ve,"callOnAdd",!0),He.debug=!!ce(ve,"debug",!1);var $t=R(Ze),nn=pt({stateHandler:Lt}),ke,Je=ce(ve,"strategy","object"),er=ce(ve,"important",!1),kt={reporter:Vn,batchProcessor:or,stateHandler:Lt,idHandler:Ze,important:er};if(Je==="scroll"&&(le.isLegacyOpera()?(Vn.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),Je="object"):le.isIE(9)&&(Vn.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),Je="object")),Je==="scroll")ke=Nt(kt);else if(Je==="object")ke=fn(kt);else throw new Error("Invalid strategy name: "+Je);var Te={};function gt(Ut,we,ie){function _t(Ue){var cn=$t.get(Ue);ne(cn,function(ir){ir(Ue)})}function Ne(Ue,cn,wn){$t.add(cn,wn),Ue&&wn(cn)}if(ie||(ie=we,we=Ut,Ut={}),!we)throw new Error("At least one element required.");if(!ie)throw new Error("Listener required.");if(fe(we))we=[we];else if(Jt(we))we=Ie(we);else return Vn.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var un=0,Qn=ce(Ut,"callOnAdd",He.callOnAdd),hr=ce(Ut,"onReady",function(){}),Er=ce(Ut,"debug",He.debug);ne(we,function(cn){Lt.getState(cn)||(Lt.initState(cn),Ze.set(cn));var wn=Ze.get(cn);if(Er&&Vn.log("Attaching listener to element",wn,cn),!nn.isDetectable(cn)){if(Er&&Vn.log(wn,"Not detectable."),nn.isBusy(cn)){Er&&Vn.log(wn,"System busy making it detectable"),Ne(Qn,cn,ie),Te[wn]=Te[wn]||[],Te[wn].push(function(){un++,un===we.length&&hr()});return}return Er&&Vn.log(wn,"Making detectable..."),nn.markBusy(cn,!0),ke.makeDetectable({debug:Er,important:er},cn,function(rn){if(Er&&Vn.log(wn,"onElementDetectable"),Lt.getState(rn)){nn.markAsDetectable(rn),nn.markBusy(rn,!1),ke.addListener(rn,_t),Ne(Qn,rn,ie);var De=Lt.getState(rn);if(De&&De.startSize){var Be=rn.offsetWidth,At=rn.offsetHeight;(De.startSize.width!==Be||De.startSize.height!==At)&&_t(rn)}Te[wn]&&ne(Te[wn],function(Bt){Bt()})}else Er&&Vn.log(wn,"Element uninstalled before being detectable.");delete Te[wn],un++,un===we.length&&hr()})}Er&&Vn.log(wn,"Already detecable, adding listener."),Ne(Qn,cn,ie),un++}),un===we.length&&hr()}function te(Ut){if(!Ut)return Vn.error("At least one element is required.");if(fe(Ut))Ut=[Ut];else if(Jt(Ut))Ut=Ie(Ut);else return Vn.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");ne(Ut,function(we){$t.removeAllListeners(we),ke.uninstall(we),Lt.cleanState(we)})}function Zt(Ut){ke.initDocument&&ke.initDocument(Ut)}return{listenTo:gt,removeListener:$t.removeListener,removeAllListeners:$t.removeAllListeners,uninstall:te,initDocument:Zt}};function ce(ve,Ze,Un){var En=ve[Ze];return En==null&&Un!==void 0?Un:En}},68452:function(br){"use strict";br.exports=function(rr){var it=rr.stateHandler.getState;function ne(yt){var xe=it(yt);return xe&&!!xe.isDetectable}function pt(yt){it(yt).isDetectable=!0}function R(yt){return!!it(yt).busy}function $e(yt,xe){it(yt).busy=!!xe}return{isDetectable:ne,markAsDetectable:pt,isBusy:R,markBusy:$e}}},75805:function(br){"use strict";br.exports=function(){var rr=1;function it(){return rr++}return{generate:it}}},79799:function(br){"use strict";br.exports=function(rr){var it=rr.idGenerator,ne=rr.stateHandler.getState;function pt($e){var yt=ne($e);return yt&&yt.id!==void 0?yt.id:null}function R($e){var yt=ne($e);if(!yt)throw new Error("setId required the element to have a resize detection state.");var xe=it.generate();return yt.id=xe,xe}return{get:pt,set:R}}},96199:function(br){"use strict";br.exports=function(rr){var it={};function ne(yt){var xe=rr.get(yt);return xe===void 0?[]:it[xe]||[]}function pt(yt,xe){var le=rr.get(yt);it[le]||(it[le]=[]),it[le].push(xe)}function R(yt,xe){for(var le=ne(yt),Le=0,Lt=le.length;Le<Lt;++Le)if(le[Le]===xe){le.splice(Le,1);break}}function $e(yt){var xe=ne(yt);xe&&(xe.length=0)}return{get:ne,add:pt,removeListener:R,removeAllListeners:$e}}},71724:function(br){"use strict";br.exports=function(rr){function it(){}var ne={log:it,warn:it,error:it};if(!rr&&window.console){var pt=function(R,$e){R[$e]=function(){var xe=console[$e];if(xe.apply)xe.apply(console,arguments);else for(var le=0;le<arguments.length;le++)xe(arguments[le])}};pt(ne,"log"),pt(ne,"warn"),pt(ne,"error")}return ne}},21931:function(br){"use strict";var rr="_erd";function it(R){return R[rr]={},ne(R)}function ne(R){return R[rr]}function pt(R){delete R[rr]}br.exports={initState:it,getState:ne,cleanState:pt}},26729:function(br){"use strict";var rr=Object.prototype.hasOwnProperty,it="~";function ne(){}Object.create&&(ne.prototype=Object.create(null),new ne().__proto__||(it=!1));function pt(xe,le,Le){this.fn=xe,this.context=le,this.once=Le||!1}function R(xe,le,Le,Lt,fn){if(typeof Le!="function")throw new TypeError("The listener must be a function");var Nt=new pt(Le,Lt||xe,fn),Jt=it?it+le:le;return xe._events[Jt]?xe._events[Jt].fn?xe._events[Jt]=[xe._events[Jt],Nt]:xe._events[Jt].push(Nt):(xe._events[Jt]=Nt,xe._eventsCount++),xe}function $e(xe,le){--xe._eventsCount===0?xe._events=new ne:delete xe._events[le]}function yt(){this._events=new ne,this._eventsCount=0}yt.prototype.eventNames=function(){var le=[],Le,Lt;if(this._eventsCount===0)return le;for(Lt in Le=this._events)rr.call(Le,Lt)&&le.push(it?Lt.slice(1):Lt);return Object.getOwnPropertySymbols?le.concat(Object.getOwnPropertySymbols(Le)):le},yt.prototype.listeners=function(le){var Le=it?it+le:le,Lt=this._events[Le];if(!Lt)return[];if(Lt.fn)return[Lt.fn];for(var fn=0,Nt=Lt.length,Jt=new Array(Nt);fn<Nt;fn++)Jt[fn]=Lt[fn].fn;return Jt},yt.prototype.listenerCount=function(le){var Le=it?it+le:le,Lt=this._events[Le];return Lt?Lt.fn?1:Lt.length:0},yt.prototype.emit=function(le,Le,Lt,fn,Nt,Jt){var Ie=it?it+le:le;if(!this._events[Ie])return!1;var fe=this._events[Ie],ce=arguments.length,ve,Ze;if(fe.fn){switch(fe.once&&this.removeListener(le,fe.fn,void 0,!0),ce){case 1:return fe.fn.call(fe.context),!0;case 2:return fe.fn.call(fe.context,Le),!0;case 3:return fe.fn.call(fe.context,Le,Lt),!0;case 4:return fe.fn.call(fe.context,Le,Lt,fn),!0;case 5:return fe.fn.call(fe.context,Le,Lt,fn,Nt),!0;case 6:return fe.fn.call(fe.context,Le,Lt,fn,Nt,Jt),!0}for(Ze=1,ve=new Array(ce-1);Ze<ce;Ze++)ve[Ze-1]=arguments[Ze];fe.fn.apply(fe.context,ve)}else{var Un=fe.length,En;for(Ze=0;Ze<Un;Ze++)switch(fe[Ze].once&&this.removeListener(le,fe[Ze].fn,void 0,!0),ce){case 1:fe[Ze].fn.call(fe[Ze].context);break;case 2:fe[Ze].fn.call(fe[Ze].context,Le);break;case 3:fe[Ze].fn.call(fe[Ze].context,Le,Lt);break;case 4:fe[Ze].fn.call(fe[Ze].context,Le,Lt,fn);break;default:if(!ve)for(En=1,ve=new Array(ce-1);En<ce;En++)ve[En-1]=arguments[En];fe[Ze].fn.apply(fe[Ze].context,ve)}}return!0},yt.prototype.on=function(le,Le,Lt){return R(this,le,Le,Lt,!1)},yt.prototype.once=function(le,Le,Lt){return R(this,le,Le,Lt,!0)},yt.prototype.removeListener=function(le,Le,Lt,fn){var Nt=it?it+le:le;if(!this._events[Nt])return this;if(!Le)return $e(this,Nt),this;var Jt=this._events[Nt];if(Jt.fn)Jt.fn===Le&&(!fn||Jt.once)&&(!Lt||Jt.context===Lt)&&$e(this,Nt);else{for(var Ie=0,fe=[],ce=Jt.length;Ie<ce;Ie++)(Jt[Ie].fn!==Le||fn&&!Jt[Ie].once||Lt&&Jt[Ie].context!==Lt)&&fe.push(Jt[Ie]);fe.length?this._events[Nt]=fe.length===1?fe[0]:fe:$e(this,Nt)}return this},yt.prototype.removeAllListeners=function(le){var Le;return le?(Le=it?it+le:le,this._events[Le]&&$e(this,Le)):(this._events=new ne,this._eventsCount=0),this},yt.prototype.off=yt.prototype.removeListener,yt.prototype.addListener=yt.prototype.on,yt.prefixed=it,yt.EventEmitter=yt,br.exports=yt},69916:function(br,rr){(function(it,ne){ne(rr)})(this,function(it){"use strict";function ne(Ie,fe,ce,ve){ve=ve||{};var Ze=ve.maxIterations||100,Un=ve.tolerance||1e-10,En=Ie(fe),Vn=Ie(ce),mr=ce-fe;if(En*Vn>0)throw"Initial bisect points must have opposite signs";if(En===0)return fe;if(Vn===0)return ce;for(var or=0;or<Ze;++or){mr/=2;var He=fe+mr,$t=Ie(He);if($t*En>=0&&(fe=He),Math.abs(mr)<Un||$t===0)return He}return fe+mr}function pt(Ie){for(var fe=new Array(Ie),ce=0;ce<Ie;++ce)fe[ce]=0;return fe}function R(Ie,fe){return pt(Ie).map(function(){return pt(fe)})}function $e(Ie,fe){for(var ce=0,ve=0;ve<Ie.length;++ve)ce+=Ie[ve]*fe[ve];return ce}function yt(Ie){return Math.sqrt($e(Ie,Ie))}function xe(Ie,fe,ce){for(var ve=0;ve<fe.length;++ve)Ie[ve]=fe[ve]*ce}function le(Ie,fe,ce,ve,Ze){for(var Un=0;Un<Ie.length;++Un)Ie[Un]=fe*ce[Un]+ve*Ze[Un]}function Le(Ie,fe,ce){ce=ce||{};var ve=ce.maxIterations||fe.length*200,Ze=ce.nonZeroDelta||1.05,Un=ce.zeroDelta||.001,En=ce.minErrorDelta||1e-6,Vn=ce.minErrorDelta||1e-5,mr=ce.rho!==void 0?ce.rho:1,or=ce.chi!==void 0?ce.chi:2,He=ce.psi!==void 0?ce.psi:-.5,$t=ce.sigma!==void 0?ce.sigma:.5,nn,ke=fe.length,Je=new Array(ke+1);Je[0]=fe,Je[0].fx=Ie(fe),Je[0].id=0;for(var er=0;er<ke;++er){var kt=fe.slice();kt[er]=kt[er]?kt[er]*Ze:Un,Je[er+1]=kt,Je[er+1].fx=Ie(kt),Je[er+1].id=er+1}function Te(hr){for(var Er=0;Er<hr.length;Er++)Je[ke][Er]=hr[Er];Je[ke].fx=hr.fx}for(var gt=function(hr,Er){return hr.fx-Er.fx},te=fe.slice(),Zt=fe.slice(),Ut=fe.slice(),we=fe.slice(),ie=0;ie<ve;++ie){if(Je.sort(gt),ce.history){var _t=Je.map(function(hr){var Er=hr.slice();return Er.fx=hr.fx,Er.id=hr.id,Er});_t.sort(function(hr,Er){return hr.id-Er.id}),ce.history.push({x:Je[0].slice(),fx:Je[0].fx,simplex:_t})}for(nn=0,er=0;er<ke;++er)nn=Math.max(nn,Math.abs(Je[0][er]-Je[1][er]));if(Math.abs(Je[0].fx-Je[ke].fx)<En&&nn<Vn)break;for(er=0;er<ke;++er){te[er]=0;for(var Ne=0;Ne<ke;++Ne)te[er]+=Je[Ne][er];te[er]/=ke}var un=Je[ke];if(le(Zt,1+mr,te,-mr,un),Zt.fx=Ie(Zt),Zt.fx<Je[0].fx)le(we,1+or,te,-or,un),we.fx=Ie(we),we.fx<Zt.fx?Te(we):Te(Zt);else if(Zt.fx>=Je[ke-1].fx){var Qn=!1;if(Zt.fx>un.fx?(le(Ut,1+He,te,-He,un),Ut.fx=Ie(Ut),Ut.fx<un.fx?Te(Ut):Qn=!0):(le(Ut,1-He*mr,te,He*mr,un),Ut.fx=Ie(Ut),Ut.fx<Zt.fx?Te(Ut):Qn=!0),Qn){if($t>=1)break;for(er=1;er<Je.length;++er)le(Je[er],1-$t,Je[0],$t,Je[er]),Je[er].fx=Ie(Je[er])}}else Te(Zt)}return Je.sort(gt),{fx:Je[0].fx,x:Je[0]}}function Lt(Ie,fe,ce,ve,Ze,Un,En){var Vn=ce.fx,mr=$e(ce.fxprime,fe),or=Vn,He=Vn,$t=mr,nn=0;Ze=Ze||1,Un=Un||1e-6,En=En||.1;function ke(er,kt,Te){for(var gt=0;gt<16;++gt)if(Ze=(er+kt)/2,le(ve.x,1,ce.x,Ze,fe),or=ve.fx=Ie(ve.x,ve.fxprime),$t=$e(ve.fxprime,fe),or>Vn+Un*Ze*mr||or>=Te)kt=Ze;else{if(Math.abs($t)<=-En*mr)return Ze;$t*(kt-er)>=0&&(kt=er),er=Ze,Te=or}return 0}for(var Je=0;Je<10;++Je){if(le(ve.x,1,ce.x,Ze,fe),or=ve.fx=Ie(ve.x,ve.fxprime),$t=$e(ve.fxprime,fe),or>Vn+Un*Ze*mr||Je&&or>=He)return ke(nn,Ze,He);if(Math.abs($t)<=-En*mr)return Ze;if($t>=0)return ke(Ze,nn,or);He=or,nn=Ze,Ze*=2}return Ze}function fn(Ie,fe,ce){var ve={x:fe.slice(),fx:0,fxprime:fe.slice()},Ze={x:fe.slice(),fx:0,fxprime:fe.slice()},Un=fe.slice(),En,Vn,mr=1,or;ce=ce||{},or=ce.maxIterations||fe.length*20,ve.fx=Ie(ve.x,ve.fxprime),En=ve.fxprime.slice(),xe(En,ve.fxprime,-1);for(var He=0;He<or;++He){if(mr=Lt(Ie,En,ve,Ze,mr),ce.history&&ce.history.push({x:ve.x.slice(),fx:ve.fx,fxprime:ve.fxprime.slice(),alpha:mr}),!mr)xe(En,ve.fxprime,-1);else{le(Un,1,Ze.fxprime,-1,ve.fxprime);var $t=$e(ve.fxprime,ve.fxprime),nn=Math.max(0,$e(Un,Ze.fxprime)/$t);le(En,nn,En,-1,Ze.fxprime),Vn=ve,ve=Ze,Ze=Vn}if(yt(ve.fxprime)<=1e-5)break}return ce.history&&ce.history.push({x:ve.x.slice(),fx:ve.fx,fxprime:ve.fxprime.slice(),alpha:mr}),ve}function Nt(Ie,fe,ce){ce=ce||{};for(var ve=ce.maxIterations||fe.length*100,Ze=ce.learnRate||.001,Un={x:fe.slice(),fx:0,fxprime:fe.slice()},En=0;En<ve&&(Un.fx=Ie(Un.x,Un.fxprime),ce.history&&ce.history.push({x:Un.x.slice(),fx:Un.fx,fxprime:Un.fxprime.slice()}),le(Un.x,1,Un.x,-Ze,Un.fxprime),!(yt(Un.fxprime)<=1e-5));++En);return Un}function Jt(Ie,fe,ce){ce=ce||{};var ve={x:fe.slice(),fx:0,fxprime:fe.slice()},Ze={x:fe.slice(),fx:0,fxprime:fe.slice()},Un=ce.maxIterations||fe.length*100,En=ce.learnRate||1,Vn=fe.slice(),mr=ce.c1||.001,or=ce.c2||.1,He,$t=[];if(ce.history){var nn=Ie;Ie=function(Je,er){return $t.push(Je.slice()),nn(Je,er)}}ve.fx=Ie(ve.x,ve.fxprime);for(var ke=0;ke<Un&&(xe(Vn,ve.fxprime,-1),En=Lt(Ie,Vn,ve,Ze,En,mr,or),ce.history&&(ce.history.push({x:ve.x.slice(),fx:ve.fx,fxprime:ve.fxprime.slice(),functionCalls:$t,learnRate:En,alpha:En}),$t=[]),He=ve,ve=Ze,Ze=He,!(En===0||yt(ve.fxprime)<1e-5));++ke);return ve}it.bisect=ne,it.nelderMead=Le,it.conjugateGradient=fn,it.gradientDescent=Nt,it.gradientDescentLineSearch=Jt,it.zeros=pt,it.zerosM=R,it.norm2=yt,it.weightedSum=le,it.scale=xe})},49685:function(br,rr,it){"use strict";it.d(rr,{Ib:function(){return ne},WT:function(){return pt}});var ne=1e-6,pt=typeof Float32Array!="undefined"?Float32Array:Array,R=Math.random;function $e(Le){pt=Le}var yt=Math.PI/180;function xe(Le){return Le*yt}function le(Le,Lt){return Math.abs(Le-Lt)<=ne*Math.max(1,Math.abs(Le),Math.abs(Lt))}Math.hypot||(Math.hypot=function(){for(var Le=0,Lt=arguments.length;Lt--;)Le+=arguments[Lt]*arguments[Lt];return Math.sqrt(Le)})},85975:function(br,rr,it){"use strict";it.r(rr),it.d(rr,{add:function(){return wn},adjoint:function(){return fn},clone:function(){return R},copy:function(){return $e},create:function(){return pt},determinant:function(){return Nt},equals:function(){return At},exactEquals:function(){return Be},frob:function(){return cn},fromQuat:function(){return te},fromQuat2:function(){return ke},fromRotation:function(){return mr},fromRotationTranslation:function(){return nn},fromRotationTranslationScale:function(){return Te},fromRotationTranslationScaleOrigin:function(){return gt},fromScaling:function(){return Vn},fromTranslation:function(){return En},fromValues:function(){return yt},fromXRotation:function(){return or},fromYRotation:function(){return He},fromZRotation:function(){return $t},frustum:function(){return Zt},getRotation:function(){return kt},getScaling:function(){return er},getTranslation:function(){return Je},identity:function(){return le},invert:function(){return Lt},lookAt:function(){return hr},mul:function(){return Bt},multiply:function(){return Jt},multiplyScalar:function(){return rn},multiplyScalarAndAdd:function(){return De},ortho:function(){return un},orthoNO:function(){return Ne},orthoZO:function(){return Qn},perspective:function(){return we},perspectiveFromFieldOfView:function(){return _t},perspectiveNO:function(){return Ut},perspectiveZO:function(){return ie},rotate:function(){return ce},rotateX:function(){return ve},rotateY:function(){return Ze},rotateZ:function(){return Un},scale:function(){return fe},set:function(){return xe},str:function(){return Ue},sub:function(){return Ae},subtract:function(){return ir},targetTo:function(){return Er},translate:function(){return Ie},transpose:function(){return Le}});var ne=it(49685);function pt(){var z=new ne.WT(16);return ne.WT!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[11]=0,z[12]=0,z[13]=0,z[14]=0),z[0]=1,z[5]=1,z[10]=1,z[15]=1,z}function R(z){var rt=new ne.WT(16);return rt[0]=z[0],rt[1]=z[1],rt[2]=z[2],rt[3]=z[3],rt[4]=z[4],rt[5]=z[5],rt[6]=z[6],rt[7]=z[7],rt[8]=z[8],rt[9]=z[9],rt[10]=z[10],rt[11]=z[11],rt[12]=z[12],rt[13]=z[13],rt[14]=z[14],rt[15]=z[15],rt}function $e(z,rt){return z[0]=rt[0],z[1]=rt[1],z[2]=rt[2],z[3]=rt[3],z[4]=rt[4],z[5]=rt[5],z[6]=rt[6],z[7]=rt[7],z[8]=rt[8],z[9]=rt[9],z[10]=rt[10],z[11]=rt[11],z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15],z}function yt(z,rt,F,ot,ze,Vt,ae,Mn,zn,Wn,sn,Kt,Ce,xn,Cn,Zn){var Qt=new ne.WT(16);return Qt[0]=z,Qt[1]=rt,Qt[2]=F,Qt[3]=ot,Qt[4]=ze,Qt[5]=Vt,Qt[6]=ae,Qt[7]=Mn,Qt[8]=zn,Qt[9]=Wn,Qt[10]=sn,Qt[11]=Kt,Qt[12]=Ce,Qt[13]=xn,Qt[14]=Cn,Qt[15]=Zn,Qt}function xe(z,rt,F,ot,ze,Vt,ae,Mn,zn,Wn,sn,Kt,Ce,xn,Cn,Zn,Qt){return z[0]=rt,z[1]=F,z[2]=ot,z[3]=ze,z[4]=Vt,z[5]=ae,z[6]=Mn,z[7]=zn,z[8]=Wn,z[9]=sn,z[10]=Kt,z[11]=Ce,z[12]=xn,z[13]=Cn,z[14]=Zn,z[15]=Qt,z}function le(z){return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function Le(z,rt){if(z===rt){var F=rt[1],ot=rt[2],ze=rt[3],Vt=rt[6],ae=rt[7],Mn=rt[11];z[1]=rt[4],z[2]=rt[8],z[3]=rt[12],z[4]=F,z[6]=rt[9],z[7]=rt[13],z[8]=ot,z[9]=Vt,z[11]=rt[14],z[12]=ze,z[13]=ae,z[14]=Mn}else z[0]=rt[0],z[1]=rt[4],z[2]=rt[8],z[3]=rt[12],z[4]=rt[1],z[5]=rt[5],z[6]=rt[9],z[7]=rt[13],z[8]=rt[2],z[9]=rt[6],z[10]=rt[10],z[11]=rt[14],z[12]=rt[3],z[13]=rt[7],z[14]=rt[11],z[15]=rt[15];return z}function Lt(z,rt){var F=rt[0],ot=rt[1],ze=rt[2],Vt=rt[3],ae=rt[4],Mn=rt[5],zn=rt[6],Wn=rt[7],sn=rt[8],Kt=rt[9],Ce=rt[10],xn=rt[11],Cn=rt[12],Zn=rt[13],Qt=rt[14],ct=rt[15],bt=F*Mn-ot*ae,zt=F*zn-ze*ae,me=F*Wn-Vt*ae,de=ot*zn-ze*Mn,bn=ot*Wn-Vt*Mn,qn=ze*Wn-Vt*zn,Sr=sn*Zn-Kt*Cn,Gn=sn*Qt-Ce*Cn,ht=sn*ct-xn*Cn,ut=Kt*Qt-Ce*Zn,wt=Kt*ct-xn*Zn,Gt=Ce*ct-xn*Qt,ue=bt*Gt-zt*wt+me*ut+de*ht-bn*Gn+qn*Sr;return ue?(ue=1/ue,z[0]=(Mn*Gt-zn*wt+Wn*ut)*ue,z[1]=(ze*wt-ot*Gt-Vt*ut)*ue,z[2]=(Zn*qn-Qt*bn+ct*de)*ue,z[3]=(Ce*bn-Kt*qn-xn*de)*ue,z[4]=(zn*ht-ae*Gt-Wn*Gn)*ue,z[5]=(F*Gt-ze*ht+Vt*Gn)*ue,z[6]=(Qt*me-Cn*qn-ct*zt)*ue,z[7]=(sn*qn-Ce*me+xn*zt)*ue,z[8]=(ae*wt-Mn*ht+Wn*Sr)*ue,z[9]=(ot*ht-F*wt-Vt*Sr)*ue,z[10]=(Cn*bn-Zn*me+ct*bt)*ue,z[11]=(Kt*me-sn*bn-xn*bt)*ue,z[12]=(Mn*Gn-ae*ut-zn*Sr)*ue,z[13]=(F*ut-ot*Gn+ze*Sr)*ue,z[14]=(Zn*zt-Cn*de-Qt*bt)*ue,z[15]=(sn*de-Kt*zt+Ce*bt)*ue,z):null}function fn(z,rt){var F=rt[0],ot=rt[1],ze=rt[2],Vt=rt[3],ae=rt[4],Mn=rt[5],zn=rt[6],Wn=rt[7],sn=rt[8],Kt=rt[9],Ce=rt[10],xn=rt[11],Cn=rt[12],Zn=rt[13],Qt=rt[14],ct=rt[15];return z[0]=Mn*(Ce*ct-xn*Qt)-Kt*(zn*ct-Wn*Qt)+Zn*(zn*xn-Wn*Ce),z[1]=-(ot*(Ce*ct-xn*Qt)-Kt*(ze*ct-Vt*Qt)+Zn*(ze*xn-Vt*Ce)),z[2]=ot*(zn*ct-Wn*Qt)-Mn*(ze*ct-Vt*Qt)+Zn*(ze*Wn-Vt*zn),z[3]=-(ot*(zn*xn-Wn*Ce)-Mn*(ze*xn-Vt*Ce)+Kt*(ze*Wn-Vt*zn)),z[4]=-(ae*(Ce*ct-xn*Qt)-sn*(zn*ct-Wn*Qt)+Cn*(zn*xn-Wn*Ce)),z[5]=F*(Ce*ct-xn*Qt)-sn*(ze*ct-Vt*Qt)+Cn*(ze*xn-Vt*Ce),z[6]=-(F*(zn*ct-Wn*Qt)-ae*(ze*ct-Vt*Qt)+Cn*(ze*Wn-Vt*zn)),z[7]=F*(zn*xn-Wn*Ce)-ae*(ze*xn-Vt*Ce)+sn*(ze*Wn-Vt*zn),z[8]=ae*(Kt*ct-xn*Zn)-sn*(Mn*ct-Wn*Zn)+Cn*(Mn*xn-Wn*Kt),z[9]=-(F*(Kt*ct-xn*Zn)-sn*(ot*ct-Vt*Zn)+Cn*(ot*xn-Vt*Kt)),z[10]=F*(Mn*ct-Wn*Zn)-ae*(ot*ct-Vt*Zn)+Cn*(ot*Wn-Vt*Mn),z[11]=-(F*(Mn*xn-Wn*Kt)-ae*(ot*xn-Vt*Kt)+sn*(ot*Wn-Vt*Mn)),z[12]=-(ae*(Kt*Qt-Ce*Zn)-sn*(Mn*Qt-zn*Zn)+Cn*(Mn*Ce-zn*Kt)),z[13]=F*(Kt*Qt-Ce*Zn)-sn*(ot*Qt-ze*Zn)+Cn*(ot*Ce-ze*Kt),z[14]=-(F*(Mn*Qt-zn*Zn)-ae*(ot*Qt-ze*Zn)+Cn*(ot*zn-ze*Mn)),z[15]=F*(Mn*Ce-zn*Kt)-ae*(ot*Ce-ze*Kt)+sn*(ot*zn-ze*Mn),z}function Nt(z){var rt=z[0],F=z[1],ot=z[2],ze=z[3],Vt=z[4],ae=z[5],Mn=z[6],zn=z[7],Wn=z[8],sn=z[9],Kt=z[10],Ce=z[11],xn=z[12],Cn=z[13],Zn=z[14],Qt=z[15],ct=rt*ae-F*Vt,bt=rt*Mn-ot*Vt,zt=rt*zn-ze*Vt,me=F*Mn-ot*ae,de=F*zn-ze*ae,bn=ot*zn-ze*Mn,qn=Wn*Cn-sn*xn,Sr=Wn*Zn-Kt*xn,Gn=Wn*Qt-Ce*xn,ht=sn*Zn-Kt*Cn,ut=sn*Qt-Ce*Cn,wt=Kt*Qt-Ce*Zn;return ct*wt-bt*ut+zt*ht+me*Gn-de*Sr+bn*qn}function Jt(z,rt,F){var ot=rt[0],ze=rt[1],Vt=rt[2],ae=rt[3],Mn=rt[4],zn=rt[5],Wn=rt[6],sn=rt[7],Kt=rt[8],Ce=rt[9],xn=rt[10],Cn=rt[11],Zn=rt[12],Qt=rt[13],ct=rt[14],bt=rt[15],zt=F[0],me=F[1],de=F[2],bn=F[3];return z[0]=zt*ot+me*Mn+de*Kt+bn*Zn,z[1]=zt*ze+me*zn+de*Ce+bn*Qt,z[2]=zt*Vt+me*Wn+de*xn+bn*ct,z[3]=zt*ae+me*sn+de*Cn+bn*bt,zt=F[4],me=F[5],de=F[6],bn=F[7],z[4]=zt*ot+me*Mn+de*Kt+bn*Zn,z[5]=zt*ze+me*zn+de*Ce+bn*Qt,z[6]=zt*Vt+me*Wn+de*xn+bn*ct,z[7]=zt*ae+me*sn+de*Cn+bn*bt,zt=F[8],me=F[9],de=F[10],bn=F[11],z[8]=zt*ot+me*Mn+de*Kt+bn*Zn,z[9]=zt*ze+me*zn+de*Ce+bn*Qt,z[10]=zt*Vt+me*Wn+de*xn+bn*ct,z[11]=zt*ae+me*sn+de*Cn+bn*bt,zt=F[12],me=F[13],de=F[14],bn=F[15],z[12]=zt*ot+me*Mn+de*Kt+bn*Zn,z[13]=zt*ze+me*zn+de*Ce+bn*Qt,z[14]=zt*Vt+me*Wn+de*xn+bn*ct,z[15]=zt*ae+me*sn+de*Cn+bn*bt,z}function Ie(z,rt,F){var ot=F[0],ze=F[1],Vt=F[2],ae,Mn,zn,Wn,sn,Kt,Ce,xn,Cn,Zn,Qt,ct;return rt===z?(z[12]=rt[0]*ot+rt[4]*ze+rt[8]*Vt+rt[12],z[13]=rt[1]*ot+rt[5]*ze+rt[9]*Vt+rt[13],z[14]=rt[2]*ot+rt[6]*ze+rt[10]*Vt+rt[14],z[15]=rt[3]*ot+rt[7]*ze+rt[11]*Vt+rt[15]):(ae=rt[0],Mn=rt[1],zn=rt[2],Wn=rt[3],sn=rt[4],Kt=rt[5],Ce=rt[6],xn=rt[7],Cn=rt[8],Zn=rt[9],Qt=rt[10],ct=rt[11],z[0]=ae,z[1]=Mn,z[2]=zn,z[3]=Wn,z[4]=sn,z[5]=Kt,z[6]=Ce,z[7]=xn,z[8]=Cn,z[9]=Zn,z[10]=Qt,z[11]=ct,z[12]=ae*ot+sn*ze+Cn*Vt+rt[12],z[13]=Mn*ot+Kt*ze+Zn*Vt+rt[13],z[14]=zn*ot+Ce*ze+Qt*Vt+rt[14],z[15]=Wn*ot+xn*ze+ct*Vt+rt[15]),z}function fe(z,rt,F){var ot=F[0],ze=F[1],Vt=F[2];return z[0]=rt[0]*ot,z[1]=rt[1]*ot,z[2]=rt[2]*ot,z[3]=rt[3]*ot,z[4]=rt[4]*ze,z[5]=rt[5]*ze,z[6]=rt[6]*ze,z[7]=rt[7]*ze,z[8]=rt[8]*Vt,z[9]=rt[9]*Vt,z[10]=rt[10]*Vt,z[11]=rt[11]*Vt,z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15],z}function ce(z,rt,F,ot){var ze=ot[0],Vt=ot[1],ae=ot[2],Mn=Math.hypot(ze,Vt,ae),zn,Wn,sn,Kt,Ce,xn,Cn,Zn,Qt,ct,bt,zt,me,de,bn,qn,Sr,Gn,ht,ut,wt,Gt,ue,Ge;return Mn<ne.Ib?null:(Mn=1/Mn,ze*=Mn,Vt*=Mn,ae*=Mn,zn=Math.sin(F),Wn=Math.cos(F),sn=1-Wn,Kt=rt[0],Ce=rt[1],xn=rt[2],Cn=rt[3],Zn=rt[4],Qt=rt[5],ct=rt[6],bt=rt[7],zt=rt[8],me=rt[9],de=rt[10],bn=rt[11],qn=ze*ze*sn+Wn,Sr=Vt*ze*sn+ae*zn,Gn=ae*ze*sn-Vt*zn,ht=ze*Vt*sn-ae*zn,ut=Vt*Vt*sn+Wn,wt=ae*Vt*sn+ze*zn,Gt=ze*ae*sn+Vt*zn,ue=Vt*ae*sn-ze*zn,Ge=ae*ae*sn+Wn,z[0]=Kt*qn+Zn*Sr+zt*Gn,z[1]=Ce*qn+Qt*Sr+me*Gn,z[2]=xn*qn+ct*Sr+de*Gn,z[3]=Cn*qn+bt*Sr+bn*Gn,z[4]=Kt*ht+Zn*ut+zt*wt,z[5]=Ce*ht+Qt*ut+me*wt,z[6]=xn*ht+ct*ut+de*wt,z[7]=Cn*ht+bt*ut+bn*wt,z[8]=Kt*Gt+Zn*ue+zt*Ge,z[9]=Ce*Gt+Qt*ue+me*Ge,z[10]=xn*Gt+ct*ue+de*Ge,z[11]=Cn*Gt+bt*ue+bn*Ge,rt!==z&&(z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15]),z)}function ve(z,rt,F){var ot=Math.sin(F),ze=Math.cos(F),Vt=rt[4],ae=rt[5],Mn=rt[6],zn=rt[7],Wn=rt[8],sn=rt[9],Kt=rt[10],Ce=rt[11];return rt!==z&&(z[0]=rt[0],z[1]=rt[1],z[2]=rt[2],z[3]=rt[3],z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15]),z[4]=Vt*ze+Wn*ot,z[5]=ae*ze+sn*ot,z[6]=Mn*ze+Kt*ot,z[7]=zn*ze+Ce*ot,z[8]=Wn*ze-Vt*ot,z[9]=sn*ze-ae*ot,z[10]=Kt*ze-Mn*ot,z[11]=Ce*ze-zn*ot,z}function Ze(z,rt,F){var ot=Math.sin(F),ze=Math.cos(F),Vt=rt[0],ae=rt[1],Mn=rt[2],zn=rt[3],Wn=rt[8],sn=rt[9],Kt=rt[10],Ce=rt[11];return rt!==z&&(z[4]=rt[4],z[5]=rt[5],z[6]=rt[6],z[7]=rt[7],z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15]),z[0]=Vt*ze-Wn*ot,z[1]=ae*ze-sn*ot,z[2]=Mn*ze-Kt*ot,z[3]=zn*ze-Ce*ot,z[8]=Vt*ot+Wn*ze,z[9]=ae*ot+sn*ze,z[10]=Mn*ot+Kt*ze,z[11]=zn*ot+Ce*ze,z}function Un(z,rt,F){var ot=Math.sin(F),ze=Math.cos(F),Vt=rt[0],ae=rt[1],Mn=rt[2],zn=rt[3],Wn=rt[4],sn=rt[5],Kt=rt[6],Ce=rt[7];return rt!==z&&(z[8]=rt[8],z[9]=rt[9],z[10]=rt[10],z[11]=rt[11],z[12]=rt[12],z[13]=rt[13],z[14]=rt[14],z[15]=rt[15]),z[0]=Vt*ze+Wn*ot,z[1]=ae*ze+sn*ot,z[2]=Mn*ze+Kt*ot,z[3]=zn*ze+Ce*ot,z[4]=Wn*ze-Vt*ot,z[5]=sn*ze-ae*ot,z[6]=Kt*ze-Mn*ot,z[7]=Ce*ze-zn*ot,z}function En(z,rt){return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=rt[0],z[13]=rt[1],z[14]=rt[2],z[15]=1,z}function Vn(z,rt){return z[0]=rt[0],z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=rt[1],z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=rt[2],z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function mr(z,rt,F){var ot=F[0],ze=F[1],Vt=F[2],ae=Math.hypot(ot,ze,Vt),Mn,zn,Wn;return ae<ne.Ib?null:(ae=1/ae,ot*=ae,ze*=ae,Vt*=ae,Mn=Math.sin(rt),zn=Math.cos(rt),Wn=1-zn,z[0]=ot*ot*Wn+zn,z[1]=ze*ot*Wn+Vt*Mn,z[2]=Vt*ot*Wn-ze*Mn,z[3]=0,z[4]=ot*ze*Wn-Vt*Mn,z[5]=ze*ze*Wn+zn,z[6]=Vt*ze*Wn+ot*Mn,z[7]=0,z[8]=ot*Vt*Wn+ze*Mn,z[9]=ze*Vt*Wn-ot*Mn,z[10]=Vt*Vt*Wn+zn,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z)}function or(z,rt){var F=Math.sin(rt),ot=Math.cos(rt);return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=ot,z[6]=F,z[7]=0,z[8]=0,z[9]=-F,z[10]=ot,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function He(z,rt){var F=Math.sin(rt),ot=Math.cos(rt);return z[0]=ot,z[1]=0,z[2]=-F,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=F,z[9]=0,z[10]=ot,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function $t(z,rt){var F=Math.sin(rt),ot=Math.cos(rt);return z[0]=ot,z[1]=F,z[2]=0,z[3]=0,z[4]=-F,z[5]=ot,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function nn(z,rt,F){var ot=rt[0],ze=rt[1],Vt=rt[2],ae=rt[3],Mn=ot+ot,zn=ze+ze,Wn=Vt+Vt,sn=ot*Mn,Kt=ot*zn,Ce=ot*Wn,xn=ze*zn,Cn=ze*Wn,Zn=Vt*Wn,Qt=ae*Mn,ct=ae*zn,bt=ae*Wn;return z[0]=1-(xn+Zn),z[1]=Kt+bt,z[2]=Ce-ct,z[3]=0,z[4]=Kt-bt,z[5]=1-(sn+Zn),z[6]=Cn+Qt,z[7]=0,z[8]=Ce+ct,z[9]=Cn-Qt,z[10]=1-(sn+xn),z[11]=0,z[12]=F[0],z[13]=F[1],z[14]=F[2],z[15]=1,z}function ke(z,rt){var F=new ne.WT(3),ot=-rt[0],ze=-rt[1],Vt=-rt[2],ae=rt[3],Mn=rt[4],zn=rt[5],Wn=rt[6],sn=rt[7],Kt=ot*ot+ze*ze+Vt*Vt+ae*ae;return Kt>0?(F[0]=(Mn*ae+sn*ot+zn*Vt-Wn*ze)*2/Kt,F[1]=(zn*ae+sn*ze+Wn*ot-Mn*Vt)*2/Kt,F[2]=(Wn*ae+sn*Vt+Mn*ze-zn*ot)*2/Kt):(F[0]=(Mn*ae+sn*ot+zn*Vt-Wn*ze)*2,F[1]=(zn*ae+sn*ze+Wn*ot-Mn*Vt)*2,F[2]=(Wn*ae+sn*Vt+Mn*ze-zn*ot)*2),nn(z,rt,F),z}function Je(z,rt){return z[0]=rt[12],z[1]=rt[13],z[2]=rt[14],z}function er(z,rt){var F=rt[0],ot=rt[1],ze=rt[2],Vt=rt[4],ae=rt[5],Mn=rt[6],zn=rt[8],Wn=rt[9],sn=rt[10];return z[0]=Math.hypot(F,ot,ze),z[1]=Math.hypot(Vt,ae,Mn),z[2]=Math.hypot(zn,Wn,sn),z}function kt(z,rt){var F=new ne.WT(3);er(F,rt);var ot=1/F[0],ze=1/F[1],Vt=1/F[2],ae=rt[0]*ot,Mn=rt[1]*ze,zn=rt[2]*Vt,Wn=rt[4]*ot,sn=rt[5]*ze,Kt=rt[6]*Vt,Ce=rt[8]*ot,xn=rt[9]*ze,Cn=rt[10]*Vt,Zn=ae+sn+Cn,Qt=0;return Zn>0?(Qt=Math.sqrt(Zn+1)*2,z[3]=.25*Qt,z[0]=(Kt-xn)/Qt,z[1]=(Ce-zn)/Qt,z[2]=(Mn-Wn)/Qt):ae>sn&&ae>Cn?(Qt=Math.sqrt(1+ae-sn-Cn)*2,z[3]=(Kt-xn)/Qt,z[0]=.25*Qt,z[1]=(Mn+Wn)/Qt,z[2]=(Ce+zn)/Qt):sn>Cn?(Qt=Math.sqrt(1+sn-ae-Cn)*2,z[3]=(Ce-zn)/Qt,z[0]=(Mn+Wn)/Qt,z[1]=.25*Qt,z[2]=(Kt+xn)/Qt):(Qt=Math.sqrt(1+Cn-ae-sn)*2,z[3]=(Mn-Wn)/Qt,z[0]=(Ce+zn)/Qt,z[1]=(Kt+xn)/Qt,z[2]=.25*Qt),z}function Te(z,rt,F,ot){var ze=rt[0],Vt=rt[1],ae=rt[2],Mn=rt[3],zn=ze+ze,Wn=Vt+Vt,sn=ae+ae,Kt=ze*zn,Ce=ze*Wn,xn=ze*sn,Cn=Vt*Wn,Zn=Vt*sn,Qt=ae*sn,ct=Mn*zn,bt=Mn*Wn,zt=Mn*sn,me=ot[0],de=ot[1],bn=ot[2];return z[0]=(1-(Cn+Qt))*me,z[1]=(Ce+zt)*me,z[2]=(xn-bt)*me,z[3]=0,z[4]=(Ce-zt)*de,z[5]=(1-(Kt+Qt))*de,z[6]=(Zn+ct)*de,z[7]=0,z[8]=(xn+bt)*bn,z[9]=(Zn-ct)*bn,z[10]=(1-(Kt+Cn))*bn,z[11]=0,z[12]=F[0],z[13]=F[1],z[14]=F[2],z[15]=1,z}function gt(z,rt,F,ot,ze){var Vt=rt[0],ae=rt[1],Mn=rt[2],zn=rt[3],Wn=Vt+Vt,sn=ae+ae,Kt=Mn+Mn,Ce=Vt*Wn,xn=Vt*sn,Cn=Vt*Kt,Zn=ae*sn,Qt=ae*Kt,ct=Mn*Kt,bt=zn*Wn,zt=zn*sn,me=zn*Kt,de=ot[0],bn=ot[1],qn=ot[2],Sr=ze[0],Gn=ze[1],ht=ze[2],ut=(1-(Zn+ct))*de,wt=(xn+me)*de,Gt=(Cn-zt)*de,ue=(xn-me)*bn,Ge=(1-(Ce+ct))*bn,ln=(Qt+bt)*bn,ee=(Cn+zt)*qn,Fe=(Qt-bt)*qn,Hn=(1-(Ce+Zn))*qn;return z[0]=ut,z[1]=wt,z[2]=Gt,z[3]=0,z[4]=ue,z[5]=Ge,z[6]=ln,z[7]=0,z[8]=ee,z[9]=Fe,z[10]=Hn,z[11]=0,z[12]=F[0]+Sr-(ut*Sr+ue*Gn+ee*ht),z[13]=F[1]+Gn-(wt*Sr+Ge*Gn+Fe*ht),z[14]=F[2]+ht-(Gt*Sr+ln*Gn+Hn*ht),z[15]=1,z}function te(z,rt){var F=rt[0],ot=rt[1],ze=rt[2],Vt=rt[3],ae=F+F,Mn=ot+ot,zn=ze+ze,Wn=F*ae,sn=ot*ae,Kt=ot*Mn,Ce=ze*ae,xn=ze*Mn,Cn=ze*zn,Zn=Vt*ae,Qt=Vt*Mn,ct=Vt*zn;return z[0]=1-Kt-Cn,z[1]=sn+ct,z[2]=Ce-Qt,z[3]=0,z[4]=sn-ct,z[5]=1-Wn-Cn,z[6]=xn+Zn,z[7]=0,z[8]=Ce+Qt,z[9]=xn-Zn,z[10]=1-Wn-Kt,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z}function Zt(z,rt,F,ot,ze,Vt,ae){var Mn=1/(F-rt),zn=1/(ze-ot),Wn=1/(Vt-ae);return z[0]=Vt*2*Mn,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=Vt*2*zn,z[6]=0,z[7]=0,z[8]=(F+rt)*Mn,z[9]=(ze+ot)*zn,z[10]=(ae+Vt)*Wn,z[11]=-1,z[12]=0,z[13]=0,z[14]=ae*Vt*2*Wn,z[15]=0,z}function Ut(z,rt,F,ot,ze){var Vt=1/Math.tan(rt/2),ae;return z[0]=Vt/F,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=Vt,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[11]=-1,z[12]=0,z[13]=0,z[15]=0,ze!=null&&ze!==1/0?(ae=1/(ot-ze),z[10]=(ze+ot)*ae,z[14]=2*ze*ot*ae):(z[10]=-1,z[14]=-2*ot),z}var we=Ut;function ie(z,rt,F,ot,ze){var Vt=1/Math.tan(rt/2),ae;return z[0]=Vt/F,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=Vt,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[11]=-1,z[12]=0,z[13]=0,z[15]=0,ze!=null&&ze!==1/0?(ae=1/(ot-ze),z[10]=ze*ae,z[14]=ze*ot*ae):(z[10]=-1,z[14]=-ot),z}function _t(z,rt,F,ot){var ze=Math.tan(rt.upDegrees*Math.PI/180),Vt=Math.tan(rt.downDegrees*Math.PI/180),ae=Math.tan(rt.leftDegrees*Math.PI/180),Mn=Math.tan(rt.rightDegrees*Math.PI/180),zn=2/(ae+Mn),Wn=2/(ze+Vt);return z[0]=zn,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=Wn,z[6]=0,z[7]=0,z[8]=-((ae-Mn)*zn*.5),z[9]=(ze-Vt)*Wn*.5,z[10]=ot/(F-ot),z[11]=-1,z[12]=0,z[13]=0,z[14]=ot*F/(F-ot),z[15]=0,z}function Ne(z,rt,F,ot,ze,Vt,ae){var Mn=1/(rt-F),zn=1/(ot-ze),Wn=1/(Vt-ae);return z[0]=-2*Mn,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=-2*zn,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=2*Wn,z[11]=0,z[12]=(rt+F)*Mn,z[13]=(ze+ot)*zn,z[14]=(ae+Vt)*Wn,z[15]=1,z}var un=Ne;function Qn(z,rt,F,ot,ze,Vt,ae){var Mn=1/(rt-F),zn=1/(ot-ze),Wn=1/(Vt-ae);return z[0]=-2*Mn,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=-2*zn,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=Wn,z[11]=0,z[12]=(rt+F)*Mn,z[13]=(ze+ot)*zn,z[14]=Vt*Wn,z[15]=1,z}function hr(z,rt,F,ot){var ze,Vt,ae,Mn,zn,Wn,sn,Kt,Ce,xn,Cn=rt[0],Zn=rt[1],Qt=rt[2],ct=ot[0],bt=ot[1],zt=ot[2],me=F[0],de=F[1],bn=F[2];return Math.abs(Cn-me)<ne.Ib&&Math.abs(Zn-de)<ne.Ib&&Math.abs(Qt-bn)<ne.Ib?le(z):(sn=Cn-me,Kt=Zn-de,Ce=Qt-bn,xn=1/Math.hypot(sn,Kt,Ce),sn*=xn,Kt*=xn,Ce*=xn,ze=bt*Ce-zt*Kt,Vt=zt*sn-ct*Ce,ae=ct*Kt-bt*sn,xn=Math.hypot(ze,Vt,ae),xn?(xn=1/xn,ze*=xn,Vt*=xn,ae*=xn):(ze=0,Vt=0,ae=0),Mn=Kt*ae-Ce*Vt,zn=Ce*ze-sn*ae,Wn=sn*Vt-Kt*ze,xn=Math.hypot(Mn,zn,Wn),xn?(xn=1/xn,Mn*=xn,zn*=xn,Wn*=xn):(Mn=0,zn=0,Wn=0),z[0]=ze,z[1]=Mn,z[2]=sn,z[3]=0,z[4]=Vt,z[5]=zn,z[6]=Kt,z[7]=0,z[8]=ae,z[9]=Wn,z[10]=Ce,z[11]=0,z[12]=-(ze*Cn+Vt*Zn+ae*Qt),z[13]=-(Mn*Cn+zn*Zn+Wn*Qt),z[14]=-(sn*Cn+Kt*Zn+Ce*Qt),z[15]=1,z)}function Er(z,rt,F,ot){var ze=rt[0],Vt=rt[1],ae=rt[2],Mn=ot[0],zn=ot[1],Wn=ot[2],sn=ze-F[0],Kt=Vt-F[1],Ce=ae-F[2],xn=sn*sn+Kt*Kt+Ce*Ce;xn>0&&(xn=1/Math.sqrt(xn),sn*=xn,Kt*=xn,Ce*=xn);var Cn=zn*Ce-Wn*Kt,Zn=Wn*sn-Mn*Ce,Qt=Mn*Kt-zn*sn;return xn=Cn*Cn+Zn*Zn+Qt*Qt,xn>0&&(xn=1/Math.sqrt(xn),Cn*=xn,Zn*=xn,Qt*=xn),z[0]=Cn,z[1]=Zn,z[2]=Qt,z[3]=0,z[4]=Kt*Qt-Ce*Zn,z[5]=Ce*Cn-sn*Qt,z[6]=sn*Zn-Kt*Cn,z[7]=0,z[8]=sn,z[9]=Kt,z[10]=Ce,z[11]=0,z[12]=ze,z[13]=Vt,z[14]=ae,z[15]=1,z}function Ue(z){return"mat4("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+", "+z[4]+", "+z[5]+", "+z[6]+", "+z[7]+", "+z[8]+", "+z[9]+", "+z[10]+", "+z[11]+", "+z[12]+", "+z[13]+", "+z[14]+", "+z[15]+")"}function cn(z){return Math.hypot(z[0],z[1],z[2],z[3],z[4],z[5],z[6],z[7],z[8],z[9],z[10],z[11],z[12],z[13],z[14],z[15])}function wn(z,rt,F){return z[0]=rt[0]+F[0],z[1]=rt[1]+F[1],z[2]=rt[2]+F[2],z[3]=rt[3]+F[3],z[4]=rt[4]+F[4],z[5]=rt[5]+F[5],z[6]=rt[6]+F[6],z[7]=rt[7]+F[7],z[8]=rt[8]+F[8],z[9]=rt[9]+F[9],z[10]=rt[10]+F[10],z[11]=rt[11]+F[11],z[12]=rt[12]+F[12],z[13]=rt[13]+F[13],z[14]=rt[14]+F[14],z[15]=rt[15]+F[15],z}function ir(z,rt,F){return z[0]=rt[0]-F[0],z[1]=rt[1]-F[1],z[2]=rt[2]-F[2],z[3]=rt[3]-F[3],z[4]=rt[4]-F[4],z[5]=rt[5]-F[5],z[6]=rt[6]-F[6],z[7]=rt[7]-F[7],z[8]=rt[8]-F[8],z[9]=rt[9]-F[9],z[10]=rt[10]-F[10],z[11]=rt[11]-F[11],z[12]=rt[12]-F[12],z[13]=rt[13]-F[13],z[14]=rt[14]-F[14],z[15]=rt[15]-F[15],z}function rn(z,rt,F){return z[0]=rt[0]*F,z[1]=rt[1]*F,z[2]=rt[2]*F,z[3]=rt[3]*F,z[4]=rt[4]*F,z[5]=rt[5]*F,z[6]=rt[6]*F,z[7]=rt[7]*F,z[8]=rt[8]*F,z[9]=rt[9]*F,z[10]=rt[10]*F,z[11]=rt[11]*F,z[12]=rt[12]*F,z[13]=rt[13]*F,z[14]=rt[14]*F,z[15]=rt[15]*F,z}function De(z,rt,F,ot){return z[0]=rt[0]+F[0]*ot,z[1]=rt[1]+F[1]*ot,z[2]=rt[2]+F[2]*ot,z[3]=rt[3]+F[3]*ot,z[4]=rt[4]+F[4]*ot,z[5]=rt[5]+F[5]*ot,z[6]=rt[6]+F[6]*ot,z[7]=rt[7]+F[7]*ot,z[8]=rt[8]+F[8]*ot,z[9]=rt[9]+F[9]*ot,z[10]=rt[10]+F[10]*ot,z[11]=rt[11]+F[11]*ot,z[12]=rt[12]+F[12]*ot,z[13]=rt[13]+F[13]*ot,z[14]=rt[14]+F[14]*ot,z[15]=rt[15]+F[15]*ot,z}function Be(z,rt){return z[0]===rt[0]&&z[1]===rt[1]&&z[2]===rt[2]&&z[3]===rt[3]&&z[4]===rt[4]&&z[5]===rt[5]&&z[6]===rt[6]&&z[7]===rt[7]&&z[8]===rt[8]&&z[9]===rt[9]&&z[10]===rt[10]&&z[11]===rt[11]&&z[12]===rt[12]&&z[13]===rt[13]&&z[14]===rt[14]&&z[15]===rt[15]}function At(z,rt){var F=z[0],ot=z[1],ze=z[2],Vt=z[3],ae=z[4],Mn=z[5],zn=z[6],Wn=z[7],sn=z[8],Kt=z[9],Ce=z[10],xn=z[11],Cn=z[12],Zn=z[13],Qt=z[14],ct=z[15],bt=rt[0],zt=rt[1],me=rt[2],de=rt[3],bn=rt[4],qn=rt[5],Sr=rt[6],Gn=rt[7],ht=rt[8],ut=rt[9],wt=rt[10],Gt=rt[11],ue=rt[12],Ge=rt[13],ln=rt[14],ee=rt[15];return Math.abs(F-bt)<=ne.Ib*Math.max(1,Math.abs(F),Math.abs(bt))&&Math.abs(ot-zt)<=ne.Ib*Math.max(1,Math.abs(ot),Math.abs(zt))&&Math.abs(ze-me)<=ne.Ib*Math.max(1,Math.abs(ze),Math.abs(me))&&Math.abs(Vt-de)<=ne.Ib*Math.max(1,Math.abs(Vt),Math.abs(de))&&Math.abs(ae-bn)<=ne.Ib*Math.max(1,Math.abs(ae),Math.abs(bn))&&Math.abs(Mn-qn)<=ne.Ib*Math.max(1,Math.abs(Mn),Math.abs(qn))&&Math.abs(zn-Sr)<=ne.Ib*Math.max(1,Math.abs(zn),Math.abs(Sr))&&Math.abs(Wn-Gn)<=ne.Ib*Math.max(1,Math.abs(Wn),Math.abs(Gn))&&Math.abs(sn-ht)<=ne.Ib*Math.max(1,Math.abs(sn),Math.abs(ht))&&Math.abs(Kt-ut)<=ne.Ib*Math.max(1,Math.abs(Kt),Math.abs(ut))&&Math.abs(Ce-wt)<=ne.Ib*Math.max(1,Math.abs(Ce),Math.abs(wt))&&Math.abs(xn-Gt)<=ne.Ib*Math.max(1,Math.abs(xn),Math.abs(Gt))&&Math.abs(Cn-ue)<=ne.Ib*Math.max(1,Math.abs(Cn),Math.abs(ue))&&Math.abs(Zn-Ge)<=ne.Ib*Math.max(1,Math.abs(Zn),Math.abs(Ge))&&Math.abs(Qt-ln)<=ne.Ib*Math.max(1,Math.abs(Qt),Math.abs(ln))&&Math.abs(ct-ee)<=ne.Ib*Math.max(1,Math.abs(ct),Math.abs(ee))}var Bt=Jt,Ae=ir},31437:function(br,rr,it){"use strict";it.d(rr,{$X:function(){return Le},AK:function(){return nn},Fv:function(){return $t},I6:function(){return _t},IH:function(){return le},JG:function(){return yt},Ue:function(){return pt},al:function(){return $e},lu:function(){return Qn},t7:function(){return Je},t8:function(){return xe},tk:function(){return or}});var ne=it(49685);function pt(){var rn=new ne.WT(2);return ne.WT!=Float32Array&&(rn[0]=0,rn[1]=0),rn}function R(rn){var De=new glMatrix.ARRAY_TYPE(2);return De[0]=rn[0],De[1]=rn[1],De}function $e(rn,De){var Be=new ne.WT(2);return Be[0]=rn,Be[1]=De,Be}function yt(rn,De){return rn[0]=De[0],rn[1]=De[1],rn}function xe(rn,De,Be){return rn[0]=De,rn[1]=Be,rn}function le(rn,De,Be){return rn[0]=De[0]+Be[0],rn[1]=De[1]+Be[1],rn}function Le(rn,De,Be){return rn[0]=De[0]-Be[0],rn[1]=De[1]-Be[1],rn}function Lt(rn,De,Be){return rn[0]=De[0]*Be[0],rn[1]=De[1]*Be[1],rn}function fn(rn,De,Be){return rn[0]=De[0]/Be[0],rn[1]=De[1]/Be[1],rn}function Nt(rn,De){return rn[0]=Math.ceil(De[0]),rn[1]=Math.ceil(De[1]),rn}function Jt(rn,De){return rn[0]=Math.floor(De[0]),rn[1]=Math.floor(De[1]),rn}function Ie(rn,De,Be){return rn[0]=Math.min(De[0],Be[0]),rn[1]=Math.min(De[1],Be[1]),rn}function fe(rn,De,Be){return rn[0]=Math.max(De[0],Be[0]),rn[1]=Math.max(De[1],Be[1]),rn}function ce(rn,De){return rn[0]=Math.round(De[0]),rn[1]=Math.round(De[1]),rn}function ve(rn,De,Be){return rn[0]=De[0]*Be,rn[1]=De[1]*Be,rn}function Ze(rn,De,Be,At){return rn[0]=De[0]+Be[0]*At,rn[1]=De[1]+Be[1]*At,rn}function Un(rn,De){var Be=De[0]-rn[0],At=De[1]-rn[1];return Math.hypot(Be,At)}function En(rn,De){var Be=De[0]-rn[0],At=De[1]-rn[1];return Be*Be+At*At}function Vn(rn){var De=rn[0],Be=rn[1];return Math.hypot(De,Be)}function mr(rn){var De=rn[0],Be=rn[1];return De*De+Be*Be}function or(rn,De){return rn[0]=-De[0],rn[1]=-De[1],rn}function He(rn,De){return rn[0]=1/De[0],rn[1]=1/De[1],rn}function $t(rn,De){var Be=De[0],At=De[1],Bt=Be*Be+At*At;return Bt>0&&(Bt=1/Math.sqrt(Bt)),rn[0]=De[0]*Bt,rn[1]=De[1]*Bt,rn}function nn(rn,De){return rn[0]*De[0]+rn[1]*De[1]}function ke(rn,De,Be){var At=De[0]*Be[1]-De[1]*Be[0];return rn[0]=rn[1]=0,rn[2]=At,rn}function Je(rn,De,Be,At){var Bt=De[0],Ae=De[1];return rn[0]=Bt+At*(Be[0]-Bt),rn[1]=Ae+At*(Be[1]-Ae),rn}function er(rn,De){De=De||1;var Be=glMatrix.RANDOM()*2*Math.PI;return rn[0]=Math.cos(Be)*De,rn[1]=Math.sin(Be)*De,rn}function kt(rn,De,Be){var At=De[0],Bt=De[1];return rn[0]=Be[0]*At+Be[2]*Bt,rn[1]=Be[1]*At+Be[3]*Bt,rn}function Te(rn,De,Be){var At=De[0],Bt=De[1];return rn[0]=Be[0]*At+Be[2]*Bt+Be[4],rn[1]=Be[1]*At+Be[3]*Bt+Be[5],rn}function gt(rn,De,Be){var At=De[0],Bt=De[1];return rn[0]=Be[0]*At+Be[3]*Bt+Be[6],rn[1]=Be[1]*At+Be[4]*Bt+Be[7],rn}function te(rn,De,Be){var At=De[0],Bt=De[1];return rn[0]=Be[0]*At+Be[4]*Bt+Be[12],rn[1]=Be[1]*At+Be[5]*Bt+Be[13],rn}function Zt(rn,De,Be,At){var Bt=De[0]-Be[0],Ae=De[1]-Be[1],z=Math.sin(At),rt=Math.cos(At);return rn[0]=Bt*rt-Ae*z+Be[0],rn[1]=Bt*z+Ae*rt+Be[1],rn}function Ut(rn,De){var Be=rn[0],At=rn[1],Bt=De[0],Ae=De[1],z=Math.sqrt(Be*Be+At*At)*Math.sqrt(Bt*Bt+Ae*Ae),rt=z&&(Be*Bt+At*Ae)/z;return Math.acos(Math.min(Math.max(rt,-1),1))}function we(rn){return rn[0]=0,rn[1]=0,rn}function ie(rn){return"vec2("+rn[0]+", "+rn[1]+")"}function _t(rn,De){return rn[0]===De[0]&&rn[1]===De[1]}function Ne(rn,De){var Be=rn[0],At=rn[1],Bt=De[0],Ae=De[1];return Math.abs(Be-Bt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Be),Math.abs(Bt))&&Math.abs(At-Ae)<=glMatrix.EPSILON*Math.max(1,Math.abs(At),Math.abs(Ae))}var un=null,Qn=Le,hr=null,Er=null,Ue=null,cn=null,wn=null,ir=function(){var rn=pt();return function(De,Be,At,Bt,Ae,z){var rt,F;for(Be||(Be=2),At||(At=0),Bt?F=Math.min(Bt*Be+At,De.length):F=De.length,rt=At;rt<F;rt+=Be)rn[0]=De[rt],rn[1]=De[rt+1],Ae(rn,rn,z),De[rt]=rn[0],De[rt+1]=rn[1];return De}}()},77160:function(br,rr,it){"use strict";it.d(rr,{$X:function(){return Lt},AK:function(){return nn},EU:function(){return _t},Fv:function(){return $t},IH:function(){return Le},JG:function(){return xe},Jp:function(){return fn},TK:function(){return wn},Ue:function(){return pt},VC:function(){return Zt},Zh:function(){return rn},al:function(){return yt},bA:function(){return Ze},d9:function(){return R},fF:function(){return gt},fS:function(){return hr},kC:function(){return ke},kE:function(){return $e},kK:function(){return te},lu:function(){return Er},t7:function(){return Je},t8:function(){return le},tk:function(){return or}});var ne=it(49685);function pt(){var At=new ne.WT(3);return ne.WT!=Float32Array&&(At[0]=0,At[1]=0,At[2]=0),At}function R(At){var Bt=new ne.WT(3);return Bt[0]=At[0],Bt[1]=At[1],Bt[2]=At[2],Bt}function $e(At){var Bt=At[0],Ae=At[1],z=At[2];return Math.hypot(Bt,Ae,z)}function yt(At,Bt,Ae){var z=new ne.WT(3);return z[0]=At,z[1]=Bt,z[2]=Ae,z}function xe(At,Bt){return At[0]=Bt[0],At[1]=Bt[1],At[2]=Bt[2],At}function le(At,Bt,Ae,z){return At[0]=Bt,At[1]=Ae,At[2]=z,At}function Le(At,Bt,Ae){return At[0]=Bt[0]+Ae[0],At[1]=Bt[1]+Ae[1],At[2]=Bt[2]+Ae[2],At}function Lt(At,Bt,Ae){return At[0]=Bt[0]-Ae[0],At[1]=Bt[1]-Ae[1],At[2]=Bt[2]-Ae[2],At}function fn(At,Bt,Ae){return At[0]=Bt[0]*Ae[0],At[1]=Bt[1]*Ae[1],At[2]=Bt[2]*Ae[2],At}function Nt(At,Bt,Ae){return At[0]=Bt[0]/Ae[0],At[1]=Bt[1]/Ae[1],At[2]=Bt[2]/Ae[2],At}function Jt(At,Bt){return At[0]=Math.ceil(Bt[0]),At[1]=Math.ceil(Bt[1]),At[2]=Math.ceil(Bt[2]),At}function Ie(At,Bt){return At[0]=Math.floor(Bt[0]),At[1]=Math.floor(Bt[1]),At[2]=Math.floor(Bt[2]),At}function fe(At,Bt,Ae){return At[0]=Math.min(Bt[0],Ae[0]),At[1]=Math.min(Bt[1],Ae[1]),At[2]=Math.min(Bt[2],Ae[2]),At}function ce(At,Bt,Ae){return At[0]=Math.max(Bt[0],Ae[0]),At[1]=Math.max(Bt[1],Ae[1]),At[2]=Math.max(Bt[2],Ae[2]),At}function ve(At,Bt){return At[0]=Math.round(Bt[0]),At[1]=Math.round(Bt[1]),At[2]=Math.round(Bt[2]),At}function Ze(At,Bt,Ae){return At[0]=Bt[0]*Ae,At[1]=Bt[1]*Ae,At[2]=Bt[2]*Ae,At}function Un(At,Bt,Ae,z){return At[0]=Bt[0]+Ae[0]*z,At[1]=Bt[1]+Ae[1]*z,At[2]=Bt[2]+Ae[2]*z,At}function En(At,Bt){var Ae=Bt[0]-At[0],z=Bt[1]-At[1],rt=Bt[2]-At[2];return Math.hypot(Ae,z,rt)}function Vn(At,Bt){var Ae=Bt[0]-At[0],z=Bt[1]-At[1],rt=Bt[2]-At[2];return Ae*Ae+z*z+rt*rt}function mr(At){var Bt=At[0],Ae=At[1],z=At[2];return Bt*Bt+Ae*Ae+z*z}function or(At,Bt){return At[0]=-Bt[0],At[1]=-Bt[1],At[2]=-Bt[2],At}function He(At,Bt){return At[0]=1/Bt[0],At[1]=1/Bt[1],At[2]=1/Bt[2],At}function $t(At,Bt){var Ae=Bt[0],z=Bt[1],rt=Bt[2],F=Ae*Ae+z*z+rt*rt;return F>0&&(F=1/Math.sqrt(F)),At[0]=Bt[0]*F,At[1]=Bt[1]*F,At[2]=Bt[2]*F,At}function nn(At,Bt){return At[0]*Bt[0]+At[1]*Bt[1]+At[2]*Bt[2]}function ke(At,Bt,Ae){var z=Bt[0],rt=Bt[1],F=Bt[2],ot=Ae[0],ze=Ae[1],Vt=Ae[2];return At[0]=rt*Vt-F*ze,At[1]=F*ot-z*Vt,At[2]=z*ze-rt*ot,At}function Je(At,Bt,Ae,z){var rt=Bt[0],F=Bt[1],ot=Bt[2];return At[0]=rt+z*(Ae[0]-rt),At[1]=F+z*(Ae[1]-F),At[2]=ot+z*(Ae[2]-ot),At}function er(At,Bt,Ae,z,rt,F){var ot=F*F,ze=ot*(2*F-3)+1,Vt=ot*(F-2)+F,ae=ot*(F-1),Mn=ot*(3-2*F);return At[0]=Bt[0]*ze+Ae[0]*Vt+z[0]*ae+rt[0]*Mn,At[1]=Bt[1]*ze+Ae[1]*Vt+z[1]*ae+rt[1]*Mn,At[2]=Bt[2]*ze+Ae[2]*Vt+z[2]*ae+rt[2]*Mn,At}function kt(At,Bt,Ae,z,rt,F){var ot=1-F,ze=ot*ot,Vt=F*F,ae=ze*ot,Mn=3*F*ze,zn=3*Vt*ot,Wn=Vt*F;return At[0]=Bt[0]*ae+Ae[0]*Mn+z[0]*zn+rt[0]*Wn,At[1]=Bt[1]*ae+Ae[1]*Mn+z[1]*zn+rt[1]*Wn,At[2]=Bt[2]*ae+Ae[2]*Mn+z[2]*zn+rt[2]*Wn,At}function Te(At,Bt){Bt=Bt||1;var Ae=glMatrix.RANDOM()*2*Math.PI,z=glMatrix.RANDOM()*2-1,rt=Math.sqrt(1-z*z)*Bt;return At[0]=Math.cos(Ae)*rt,At[1]=Math.sin(Ae)*rt,At[2]=z*Bt,At}function gt(At,Bt,Ae){var z=Bt[0],rt=Bt[1],F=Bt[2],ot=Ae[3]*z+Ae[7]*rt+Ae[11]*F+Ae[15];return ot=ot||1,At[0]=(Ae[0]*z+Ae[4]*rt+Ae[8]*F+Ae[12])/ot,At[1]=(Ae[1]*z+Ae[5]*rt+Ae[9]*F+Ae[13])/ot,At[2]=(Ae[2]*z+Ae[6]*rt+Ae[10]*F+Ae[14])/ot,At}function te(At,Bt,Ae){var z=Bt[0],rt=Bt[1],F=Bt[2];return At[0]=z*Ae[0]+rt*Ae[3]+F*Ae[6],At[1]=z*Ae[1]+rt*Ae[4]+F*Ae[7],At[2]=z*Ae[2]+rt*Ae[5]+F*Ae[8],At}function Zt(At,Bt,Ae){var z=Ae[0],rt=Ae[1],F=Ae[2],ot=Ae[3],ze=Bt[0],Vt=Bt[1],ae=Bt[2],Mn=rt*ae-F*Vt,zn=F*ze-z*ae,Wn=z*Vt-rt*ze,sn=rt*Wn-F*zn,Kt=F*Mn-z*Wn,Ce=z*zn-rt*Mn,xn=ot*2;return Mn*=xn,zn*=xn,Wn*=xn,sn*=2,Kt*=2,Ce*=2,At[0]=ze+Mn+sn,At[1]=Vt+zn+Kt,At[2]=ae+Wn+Ce,At}function Ut(At,Bt,Ae,z){var rt=[],F=[];return rt[0]=Bt[0]-Ae[0],rt[1]=Bt[1]-Ae[1],rt[2]=Bt[2]-Ae[2],F[0]=rt[0],F[1]=rt[1]*Math.cos(z)-rt[2]*Math.sin(z),F[2]=rt[1]*Math.sin(z)+rt[2]*Math.cos(z),At[0]=F[0]+Ae[0],At[1]=F[1]+Ae[1],At[2]=F[2]+Ae[2],At}function we(At,Bt,Ae,z){var rt=[],F=[];return rt[0]=Bt[0]-Ae[0],rt[1]=Bt[1]-Ae[1],rt[2]=Bt[2]-Ae[2],F[0]=rt[2]*Math.sin(z)+rt[0]*Math.cos(z),F[1]=rt[1],F[2]=rt[2]*Math.cos(z)-rt[0]*Math.sin(z),At[0]=F[0]+Ae[0],At[1]=F[1]+Ae[1],At[2]=F[2]+Ae[2],At}function ie(At,Bt,Ae,z){var rt=[],F=[];return rt[0]=Bt[0]-Ae[0],rt[1]=Bt[1]-Ae[1],rt[2]=Bt[2]-Ae[2],F[0]=rt[0]*Math.cos(z)-rt[1]*Math.sin(z),F[1]=rt[0]*Math.sin(z)+rt[1]*Math.cos(z),F[2]=rt[2],At[0]=F[0]+Ae[0],At[1]=F[1]+Ae[1],At[2]=F[2]+Ae[2],At}function _t(At,Bt){var Ae=At[0],z=At[1],rt=At[2],F=Bt[0],ot=Bt[1],ze=Bt[2],Vt=Math.sqrt(Ae*Ae+z*z+rt*rt),ae=Math.sqrt(F*F+ot*ot+ze*ze),Mn=Vt*ae,zn=Mn&&nn(At,Bt)/Mn;return Math.acos(Math.min(Math.max(zn,-1),1))}function Ne(At){return At[0]=0,At[1]=0,At[2]=0,At}function un(At){return"vec3("+At[0]+", "+At[1]+", "+At[2]+")"}function Qn(At,Bt){return At[0]===Bt[0]&&At[1]===Bt[1]&&At[2]===Bt[2]}function hr(At,Bt){var Ae=At[0],z=At[1],rt=At[2],F=Bt[0],ot=Bt[1],ze=Bt[2];return Math.abs(Ae-F)<=ne.Ib*Math.max(1,Math.abs(Ae),Math.abs(F))&&Math.abs(z-ot)<=ne.Ib*Math.max(1,Math.abs(z),Math.abs(ot))&&Math.abs(rt-ze)<=ne.Ib*Math.max(1,Math.abs(rt),Math.abs(ze))}var Er=Lt,Ue=null,cn=null,wn=En,ir=null,rn=$e,De=null,Be=function(){var At=pt();return function(Bt,Ae,z,rt,F,ot){var ze,Vt;for(Ae||(Ae=3),z||(z=0),rt?Vt=Math.min(rt*Ae+z,Bt.length):Vt=Bt.length,ze=z;ze<Vt;ze+=Ae)At[0]=Bt[ze],At[1]=Bt[ze+1],At[2]=Bt[ze+2],F(At,At,ot),Bt[ze]=At[0],Bt[ze+1]=At[1],Bt[ze+2]=At[2];return Bt}}()},98333:function(br,rr,it){"use strict";it.d(rr,{AK:function(){return nn},Fv:function(){return $t},I6:function(){return Zt},IH:function(){return le},JG:function(){return yt},Ue:function(){return pt},al:function(){return $e},bA:function(){return ve},d9:function(){return R},fF:function(){return kt},fS:function(){return Ut},kE:function(){return Vn},t7:function(){return Je},t8:function(){return xe},we:function(){return mr}});var ne=it(49685);function pt(){var Ue=new ne.WT(4);return ne.WT!=Float32Array&&(Ue[0]=0,Ue[1]=0,Ue[2]=0,Ue[3]=0),Ue}function R(Ue){var cn=new ne.WT(4);return cn[0]=Ue[0],cn[1]=Ue[1],cn[2]=Ue[2],cn[3]=Ue[3],cn}function $e(Ue,cn,wn,ir){var rn=new ne.WT(4);return rn[0]=Ue,rn[1]=cn,rn[2]=wn,rn[3]=ir,rn}function yt(Ue,cn){return Ue[0]=cn[0],Ue[1]=cn[1],Ue[2]=cn[2],Ue[3]=cn[3],Ue}function xe(Ue,cn,wn,ir,rn){return Ue[0]=cn,Ue[1]=wn,Ue[2]=ir,Ue[3]=rn,Ue}function le(Ue,cn,wn){return Ue[0]=cn[0]+wn[0],Ue[1]=cn[1]+wn[1],Ue[2]=cn[2]+wn[2],Ue[3]=cn[3]+wn[3],Ue}function Le(Ue,cn,wn){return Ue[0]=cn[0]-wn[0],Ue[1]=cn[1]-wn[1],Ue[2]=cn[2]-wn[2],Ue[3]=cn[3]-wn[3],Ue}function Lt(Ue,cn,wn){return Ue[0]=cn[0]*wn[0],Ue[1]=cn[1]*wn[1],Ue[2]=cn[2]*wn[2],Ue[3]=cn[3]*wn[3],Ue}function fn(Ue,cn,wn){return Ue[0]=cn[0]/wn[0],Ue[1]=cn[1]/wn[1],Ue[2]=cn[2]/wn[2],Ue[3]=cn[3]/wn[3],Ue}function Nt(Ue,cn){return Ue[0]=Math.ceil(cn[0]),Ue[1]=Math.ceil(cn[1]),Ue[2]=Math.ceil(cn[2]),Ue[3]=Math.ceil(cn[3]),Ue}function Jt(Ue,cn){return Ue[0]=Math.floor(cn[0]),Ue[1]=Math.floor(cn[1]),Ue[2]=Math.floor(cn[2]),Ue[3]=Math.floor(cn[3]),Ue}function Ie(Ue,cn,wn){return Ue[0]=Math.min(cn[0],wn[0]),Ue[1]=Math.min(cn[1],wn[1]),Ue[2]=Math.min(cn[2],wn[2]),Ue[3]=Math.min(cn[3],wn[3]),Ue}function fe(Ue,cn,wn){return Ue[0]=Math.max(cn[0],wn[0]),Ue[1]=Math.max(cn[1],wn[1]),Ue[2]=Math.max(cn[2],wn[2]),Ue[3]=Math.max(cn[3],wn[3]),Ue}function ce(Ue,cn){return Ue[0]=Math.round(cn[0]),Ue[1]=Math.round(cn[1]),Ue[2]=Math.round(cn[2]),Ue[3]=Math.round(cn[3]),Ue}function ve(Ue,cn,wn){return Ue[0]=cn[0]*wn,Ue[1]=cn[1]*wn,Ue[2]=cn[2]*wn,Ue[3]=cn[3]*wn,Ue}function Ze(Ue,cn,wn,ir){return Ue[0]=cn[0]+wn[0]*ir,Ue[1]=cn[1]+wn[1]*ir,Ue[2]=cn[2]+wn[2]*ir,Ue[3]=cn[3]+wn[3]*ir,Ue}function Un(Ue,cn){var wn=cn[0]-Ue[0],ir=cn[1]-Ue[1],rn=cn[2]-Ue[2],De=cn[3]-Ue[3];return Math.hypot(wn,ir,rn,De)}function En(Ue,cn){var wn=cn[0]-Ue[0],ir=cn[1]-Ue[1],rn=cn[2]-Ue[2],De=cn[3]-Ue[3];return wn*wn+ir*ir+rn*rn+De*De}function Vn(Ue){var cn=Ue[0],wn=Ue[1],ir=Ue[2],rn=Ue[3];return Math.hypot(cn,wn,ir,rn)}function mr(Ue){var cn=Ue[0],wn=Ue[1],ir=Ue[2],rn=Ue[3];return cn*cn+wn*wn+ir*ir+rn*rn}function or(Ue,cn){return Ue[0]=-cn[0],Ue[1]=-cn[1],Ue[2]=-cn[2],Ue[3]=-cn[3],Ue}function He(Ue,cn){return Ue[0]=1/cn[0],Ue[1]=1/cn[1],Ue[2]=1/cn[2],Ue[3]=1/cn[3],Ue}function $t(Ue,cn){var wn=cn[0],ir=cn[1],rn=cn[2],De=cn[3],Be=wn*wn+ir*ir+rn*rn+De*De;return Be>0&&(Be=1/Math.sqrt(Be)),Ue[0]=wn*Be,Ue[1]=ir*Be,Ue[2]=rn*Be,Ue[3]=De*Be,Ue}function nn(Ue,cn){return Ue[0]*cn[0]+Ue[1]*cn[1]+Ue[2]*cn[2]+Ue[3]*cn[3]}function ke(Ue,cn,wn,ir){var rn=wn[0]*ir[1]-wn[1]*ir[0],De=wn[0]*ir[2]-wn[2]*ir[0],Be=wn[0]*ir[3]-wn[3]*ir[0],At=wn[1]*ir[2]-wn[2]*ir[1],Bt=wn[1]*ir[3]-wn[3]*ir[1],Ae=wn[2]*ir[3]-wn[3]*ir[2],z=cn[0],rt=cn[1],F=cn[2],ot=cn[3];return Ue[0]=rt*Ae-F*Bt+ot*At,Ue[1]=-(z*Ae)+F*Be-ot*De,Ue[2]=z*Bt-rt*Be+ot*rn,Ue[3]=-(z*At)+rt*De-F*rn,Ue}function Je(Ue,cn,wn,ir){var rn=cn[0],De=cn[1],Be=cn[2],At=cn[3];return Ue[0]=rn+ir*(wn[0]-rn),Ue[1]=De+ir*(wn[1]-De),Ue[2]=Be+ir*(wn[2]-Be),Ue[3]=At+ir*(wn[3]-At),Ue}function er(Ue,cn){cn=cn||1;var wn,ir,rn,De,Be,At;do wn=glMatrix.RANDOM()*2-1,ir=glMatrix.RANDOM()*2-1,Be=wn*wn+ir*ir;while(Be>=1);do rn=glMatrix.RANDOM()*2-1,De=glMatrix.RANDOM()*2-1,At=rn*rn+De*De;while(At>=1);var Bt=Math.sqrt((1-Be)/At);return Ue[0]=cn*wn,Ue[1]=cn*ir,Ue[2]=cn*rn*Bt,Ue[3]=cn*De*Bt,Ue}function kt(Ue,cn,wn){var ir=cn[0],rn=cn[1],De=cn[2],Be=cn[3];return Ue[0]=wn[0]*ir+wn[4]*rn+wn[8]*De+wn[12]*Be,Ue[1]=wn[1]*ir+wn[5]*rn+wn[9]*De+wn[13]*Be,Ue[2]=wn[2]*ir+wn[6]*rn+wn[10]*De+wn[14]*Be,Ue[3]=wn[3]*ir+wn[7]*rn+wn[11]*De+wn[15]*Be,Ue}function Te(Ue,cn,wn){var ir=cn[0],rn=cn[1],De=cn[2],Be=wn[0],At=wn[1],Bt=wn[2],Ae=wn[3],z=Ae*ir+At*De-Bt*rn,rt=Ae*rn+Bt*ir-Be*De,F=Ae*De+Be*rn-At*ir,ot=-Be*ir-At*rn-Bt*De;return Ue[0]=z*Ae+ot*-Be+rt*-Bt-F*-At,Ue[1]=rt*Ae+ot*-At+F*-Be-z*-Bt,Ue[2]=F*Ae+ot*-Bt+z*-At-rt*-Be,Ue[3]=cn[3],Ue}function gt(Ue){return Ue[0]=0,Ue[1]=0,Ue[2]=0,Ue[3]=0,Ue}function te(Ue){return"vec4("+Ue[0]+", "+Ue[1]+", "+Ue[2]+", "+Ue[3]+")"}function Zt(Ue,cn){return Ue[0]===cn[0]&&Ue[1]===cn[1]&&Ue[2]===cn[2]&&Ue[3]===cn[3]}function Ut(Ue,cn){var wn=Ue[0],ir=Ue[1],rn=Ue[2],De=Ue[3],Be=cn[0],At=cn[1],Bt=cn[2],Ae=cn[3];return Math.abs(wn-Be)<=ne.Ib*Math.max(1,Math.abs(wn),Math.abs(Be))&&Math.abs(ir-At)<=ne.Ib*Math.max(1,Math.abs(ir),Math.abs(At))&&Math.abs(rn-Bt)<=ne.Ib*Math.max(1,Math.abs(rn),Math.abs(Bt))&&Math.abs(De-Ae)<=ne.Ib*Math.max(1,Math.abs(De),Math.abs(Ae))}var we=null,ie=null,_t=null,Ne=null,un=null,Qn=null,hr=null,Er=function(){var Ue=pt();return function(cn,wn,ir,rn,De,Be){var At,Bt;for(wn||(wn=4),ir||(ir=0),rn?Bt=Math.min(rn*wn+ir,cn.length):Bt=cn.length,At=ir;At<Bt;At+=wn)Ue[0]=cn[At],Ue[1]=cn[At+1],Ue[2]=cn[At+2],Ue[3]=cn[At+3],De(Ue,Ue,Be),cn[At]=Ue[0],cn[At+1]=Ue[1],cn[At+2]=Ue[2],cn[At+3]=Ue[3];return cn}}()},50840:function(br,rr,it){var ne;(function(pt,R,$e,yt){"use strict";var xe=["","webkit","Moz","MS","ms","o"],le=R.createElement("div"),Le="function",Lt=Math.round,fn=Math.abs,Nt=Date.now;function Jt(re,ge,An){return setTimeout(Vn(re,An),ge)}function Ie(re,ge,An){return Array.isArray(re)?(fe(re,An[ge],An),!0):!1}function fe(re,ge,An){var tr;if(re)if(re.forEach)re.forEach(ge,An);else if(re.length!==yt)for(tr=0;tr<re.length;)ge.call(An,re[tr],tr,re),tr++;else for(tr in re)re.hasOwnProperty(tr)&&ge.call(An,re[tr],tr,re)}function ce(re,ge,An){var tr="DEPRECATED METHOD: "+ge+`
`+An+` AT 
`;return function(){var Ei=new Error("get-stack-trace"),Si=Ei&&Ei.stack?Ei.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",uo=pt.console&&(pt.console.warn||pt.console.log);return uo&&uo.call(pt.console,tr,Si),re.apply(this,arguments)}}var ve;typeof Object.assign!="function"?ve=function(ge){if(ge===yt||ge===null)throw new TypeError("Cannot convert undefined or null to object");for(var An=Object(ge),tr=1;tr<arguments.length;tr++){var Ei=arguments[tr];if(Ei!==yt&&Ei!==null)for(var Si in Ei)Ei.hasOwnProperty(Si)&&(An[Si]=Ei[Si])}return An}:ve=Object.assign;var Ze=ce(function(ge,An,tr){for(var Ei=Object.keys(An),Si=0;Si<Ei.length;)(!tr||tr&&ge[Ei[Si]]===yt)&&(ge[Ei[Si]]=An[Ei[Si]]),Si++;return ge},"extend","Use `assign`."),Un=ce(function(ge,An){return Ze(ge,An,!0)},"merge","Use `assign`.");function En(re,ge,An){var tr=ge.prototype,Ei;Ei=re.prototype=Object.create(tr),Ei.constructor=re,Ei._super=tr,An&&ve(Ei,An)}function Vn(re,ge){return function(){return re.apply(ge,arguments)}}function mr(re,ge){return typeof re==Le?re.apply(ge&&ge[0]||yt,ge):re}function or(re,ge){return re===yt?ge:re}function He(re,ge,An){fe(Je(ge),function(tr){re.addEventListener(tr,An,!1)})}function $t(re,ge,An){fe(Je(ge),function(tr){re.removeEventListener(tr,An,!1)})}function nn(re,ge){for(;re;){if(re==ge)return!0;re=re.parentNode}return!1}function ke(re,ge){return re.indexOf(ge)>-1}function Je(re){return re.trim().split(/\s+/g)}function er(re,ge,An){if(re.indexOf&&!An)return re.indexOf(ge);for(var tr=0;tr<re.length;){if(An&&re[tr][An]==ge||!An&&re[tr]===ge)return tr;tr++}return-1}function kt(re){return Array.prototype.slice.call(re,0)}function Te(re,ge,An){for(var tr=[],Ei=[],Si=0;Si<re.length;){var uo=ge?re[Si][ge]:re[Si];er(Ei,uo)<0&&tr.push(re[Si]),Ei[Si]=uo,Si++}return An&&(ge?tr=tr.sort(function(Ns,As){return Ns[ge]>As[ge]}):tr=tr.sort()),tr}function gt(re,ge){for(var An,tr,Ei=ge[0].toUpperCase()+ge.slice(1),Si=0;Si<xe.length;){if(An=xe[Si],tr=An?An+Ei:ge,tr in re)return tr;Si++}return yt}var te=1;function Zt(){return te++}function Ut(re){var ge=re.ownerDocument||re;return ge.defaultView||ge.parentWindow||pt}var we=/mobile|tablet|ip(ad|hone|od)|android/i,ie="ontouchstart"in pt,_t=gt(pt,"PointerEvent")!==yt,Ne=ie&&we.test(navigator.userAgent),un="touch",Qn="pen",hr="mouse",Er="kinect",Ue=25,cn=1,wn=2,ir=4,rn=8,De=1,Be=2,At=4,Bt=8,Ae=16,z=Be|At,rt=Bt|Ae,F=z|rt,ot=["x","y"],ze=["clientX","clientY"];function Vt(re,ge){var An=this;this.manager=re,this.callback=ge,this.element=re.element,this.target=re.options.inputTarget,this.domHandler=function(tr){mr(re.options.enable,[re])&&An.handler(tr)},this.init()}Vt.prototype={handler:function(){},init:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(Ut(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$t(this.element,this.evEl,this.domHandler),this.evTarget&&$t(this.target,this.evTarget,this.domHandler),this.evWin&&$t(Ut(this.element),this.evWin,this.domHandler)}};function ae(re){var ge,An=re.options.inputClass;return An?ge=An:_t?ge=ut:Ne?ge=Hn:ie?ge=Ur:ge=bn,new ge(re,Mn)}function Mn(re,ge,An){var tr=An.pointers.length,Ei=An.changedPointers.length,Si=ge&cn&&tr-Ei===0,uo=ge&(ir|rn)&&tr-Ei===0;An.isFirst=!!Si,An.isFinal=!!uo,Si&&(re.session={}),An.eventType=ge,zn(re,An),re.emit("hammer.input",An),re.recognize(An),re.session.prevInput=An}function zn(re,ge){var An=re.session,tr=ge.pointers,Ei=tr.length;An.firstInput||(An.firstInput=Kt(ge)),Ei>1&&!An.firstMultiple?An.firstMultiple=Kt(ge):Ei===1&&(An.firstMultiple=!1);var Si=An.firstInput,uo=An.firstMultiple,Es=uo?uo.center:Si.center,Ns=ge.center=Ce(tr);ge.timeStamp=Nt(),ge.deltaTime=ge.timeStamp-Si.timeStamp,ge.angle=Qt(Es,Ns),ge.distance=Zn(Es,Ns),Wn(An,ge),ge.offsetDirection=Cn(ge.deltaX,ge.deltaY);var As=xn(ge.deltaTime,ge.deltaX,ge.deltaY);ge.overallVelocityX=As.x,ge.overallVelocityY=As.y,ge.overallVelocity=fn(As.x)>fn(As.y)?As.x:As.y,ge.scale=uo?bt(uo.pointers,tr):1,ge.rotation=uo?ct(uo.pointers,tr):0,ge.maxPointers=An.prevInput?ge.pointers.length>An.prevInput.maxPointers?ge.pointers.length:An.prevInput.maxPointers:ge.pointers.length,sn(An,ge);var rl=re.element;nn(ge.srcEvent.target,rl)&&(rl=ge.srcEvent.target),ge.target=rl}function Wn(re,ge){var An=ge.center,tr=re.offsetDelta||{},Ei=re.prevDelta||{},Si=re.prevInput||{};(ge.eventType===cn||Si.eventType===ir)&&(Ei=re.prevDelta={x:Si.deltaX||0,y:Si.deltaY||0},tr=re.offsetDelta={x:An.x,y:An.y}),ge.deltaX=Ei.x+(An.x-tr.x),ge.deltaY=Ei.y+(An.y-tr.y)}function sn(re,ge){var An=re.lastInterval||ge,tr=ge.timeStamp-An.timeStamp,Ei,Si,uo,Es;if(ge.eventType!=rn&&(tr>Ue||An.velocity===yt)){var Ns=ge.deltaX-An.deltaX,As=ge.deltaY-An.deltaY,rl=xn(tr,Ns,As);Si=rl.x,uo=rl.y,Ei=fn(rl.x)>fn(rl.y)?rl.x:rl.y,Es=Cn(Ns,As),re.lastInterval=ge}else Ei=An.velocity,Si=An.velocityX,uo=An.velocityY,Es=An.direction;ge.velocity=Ei,ge.velocityX=Si,ge.velocityY=uo,ge.direction=Es}function Kt(re){for(var ge=[],An=0;An<re.pointers.length;)ge[An]={clientX:Lt(re.pointers[An].clientX),clientY:Lt(re.pointers[An].clientY)},An++;return{timeStamp:Nt(),pointers:ge,center:Ce(ge),deltaX:re.deltaX,deltaY:re.deltaY}}function Ce(re){var ge=re.length;if(ge===1)return{x:Lt(re[0].clientX),y:Lt(re[0].clientY)};for(var An=0,tr=0,Ei=0;Ei<ge;)An+=re[Ei].clientX,tr+=re[Ei].clientY,Ei++;return{x:Lt(An/ge),y:Lt(tr/ge)}}function xn(re,ge,An){return{x:ge/re||0,y:An/re||0}}function Cn(re,ge){return re===ge?De:fn(re)>=fn(ge)?re<0?Be:At:ge<0?Bt:Ae}function Zn(re,ge,An){An||(An=ot);var tr=ge[An[0]]-re[An[0]],Ei=ge[An[1]]-re[An[1]];return Math.sqrt(tr*tr+Ei*Ei)}function Qt(re,ge,An){An||(An=ot);var tr=ge[An[0]]-re[An[0]],Ei=ge[An[1]]-re[An[1]];return Math.atan2(Ei,tr)*180/Math.PI}function ct(re,ge){return Qt(ge[1],ge[0],ze)+Qt(re[1],re[0],ze)}function bt(re,ge){return Zn(ge[0],ge[1],ze)/Zn(re[0],re[1],ze)}var zt={mousedown:cn,mousemove:wn,mouseup:ir},me="mousedown",de="mousemove mouseup";function bn(){this.evEl=me,this.evWin=de,this.pressed=!1,Vt.apply(this,arguments)}En(bn,Vt,{handler:function(ge){var An=zt[ge.type];An&cn&&ge.button===0&&(this.pressed=!0),An&wn&&ge.which!==1&&(An=ir),this.pressed&&(An&ir&&(this.pressed=!1),this.callback(this.manager,An,{pointers:[ge],changedPointers:[ge],pointerType:hr,srcEvent:ge}))}});var qn={pointerdown:cn,pointermove:wn,pointerup:ir,pointercancel:rn,pointerout:rn},Sr={2:un,3:Qn,4:hr,5:Er},Gn="pointerdown",ht="pointermove pointerup pointercancel";pt.MSPointerEvent&&!pt.PointerEvent&&(Gn="MSPointerDown",ht="MSPointerMove MSPointerUp MSPointerCancel");function ut(){this.evEl=Gn,this.evWin=ht,Vt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}En(ut,Vt,{handler:function(ge){var An=this.store,tr=!1,Ei=ge.type.toLowerCase().replace("ms",""),Si=qn[Ei],uo=Sr[ge.pointerType]||ge.pointerType,Es=uo==un,Ns=er(An,ge.pointerId,"pointerId");Si&cn&&(ge.button===0||Es)?Ns<0&&(An.push(ge),Ns=An.length-1):Si&(ir|rn)&&(tr=!0),!(Ns<0)&&(An[Ns]=ge,this.callback(this.manager,Si,{pointers:An,changedPointers:[ge],pointerType:uo,srcEvent:ge}),tr&&An.splice(Ns,1))}});var wt={touchstart:cn,touchmove:wn,touchend:ir,touchcancel:rn},Gt="touchstart",ue="touchstart touchmove touchend touchcancel";function Ge(){this.evTarget=Gt,this.evWin=ue,this.started=!1,Vt.apply(this,arguments)}En(Ge,Vt,{handler:function(ge){var An=wt[ge.type];if(An===cn&&(this.started=!0),!!this.started){var tr=ln.call(this,ge,An);An&(ir|rn)&&tr[0].length-tr[1].length===0&&(this.started=!1),this.callback(this.manager,An,{pointers:tr[0],changedPointers:tr[1],pointerType:un,srcEvent:ge})}}});function ln(re,ge){var An=kt(re.touches),tr=kt(re.changedTouches);return ge&(ir|rn)&&(An=Te(An.concat(tr),"identifier",!0)),[An,tr]}var ee={touchstart:cn,touchmove:wn,touchend:ir,touchcancel:rn},Fe="touchstart touchmove touchend touchcancel";function Hn(){this.evTarget=Fe,this.targetIds={},Vt.apply(this,arguments)}En(Hn,Vt,{handler:function(ge){var An=ee[ge.type],tr=Tr.call(this,ge,An);tr&&this.callback(this.manager,An,{pointers:tr[0],changedPointers:tr[1],pointerType:un,srcEvent:ge})}});function Tr(re,ge){var An=kt(re.touches),tr=this.targetIds;if(ge&(cn|wn)&&An.length===1)return tr[An[0].identifier]=!0,[An,An];var Ei,Si,uo=kt(re.changedTouches),Es=[],Ns=this.target;if(Si=An.filter(function(As){return nn(As.target,Ns)}),ge===cn)for(Ei=0;Ei<Si.length;)tr[Si[Ei].identifier]=!0,Ei++;for(Ei=0;Ei<uo.length;)tr[uo[Ei].identifier]&&Es.push(uo[Ei]),ge&(ir|rn)&&delete tr[uo[Ei].identifier],Ei++;if(Es.length)return[Te(Si.concat(Es),"identifier",!0),Es]}var Zr=2500,vr=25;function Ur(){Vt.apply(this,arguments);var re=Vn(this.handler,this);this.touch=new Hn(this.manager,re),this.mouse=new bn(this.manager,re),this.primaryTouch=null,this.lastTouches=[]}En(Ur,Vt,{handler:function(ge,An,tr){var Ei=tr.pointerType==un,Si=tr.pointerType==hr;if(!(Si&&tr.sourceCapabilities&&tr.sourceCapabilities.firesTouchEvents)){if(Ei)jr.call(this,An,tr);else if(Si&&Ar.call(this,tr))return;this.callback(ge,An,tr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function jr(re,ge){re&cn?(this.primaryTouch=ge.changedPointers[0].identifier,ni.call(this,ge)):re&(ir|rn)&&ni.call(this,ge)}function ni(re){var ge=re.changedPointers[0];if(ge.identifier===this.primaryTouch){var An={x:ge.clientX,y:ge.clientY};this.lastTouches.push(An);var tr=this.lastTouches,Ei=function(){var Si=tr.indexOf(An);Si>-1&&tr.splice(Si,1)};setTimeout(Ei,Zr)}}function Ar(re){for(var ge=re.srcEvent.clientX,An=re.srcEvent.clientY,tr=0;tr<this.lastTouches.length;tr++){var Ei=this.lastTouches[tr],Si=Math.abs(ge-Ei.x),uo=Math.abs(An-Ei.y);if(Si<=vr&&uo<=vr)return!0}return!1}var pi=gt(le.style,"touchAction"),mi=pi!==yt,xi="compute",wo="auto",Li="manipulation",aa="none",Pa="pan-x",Lo="pan-y",$o=Se();function Mt(re,ge){this.manager=re,this.set(ge)}Mt.prototype={set:function(re){re==xi&&(re=this.compute()),mi&&this.manager.element.style&&$o[re]&&(this.manager.element.style[pi]=re),this.actions=re.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var re=[];return fe(this.manager.recognizers,function(ge){mr(ge.options.enable,[ge])&&(re=re.concat(ge.getTouchAction()))}),Wt(re.join(" "))},preventDefaults:function(re){var ge=re.srcEvent,An=re.offsetDirection;if(this.manager.session.prevented){ge.preventDefault();return}var tr=this.actions,Ei=ke(tr,aa)&&!$o[aa],Si=ke(tr,Lo)&&!$o[Lo],uo=ke(tr,Pa)&&!$o[Pa];if(Ei){var Es=re.pointers.length===1,Ns=re.distance<2,As=re.deltaTime<250;if(Es&&Ns&&As)return}if(!(uo&&Si)&&(Ei||Si&&An&z||uo&&An&rt))return this.preventSrc(ge)},preventSrc:function(re){this.manager.session.prevented=!0,re.preventDefault()}};function Wt(re){if(ke(re,aa))return aa;var ge=ke(re,Pa),An=ke(re,Lo);return ge&&An?aa:ge||An?ge?Pa:Lo:ke(re,Li)?Li:wo}function Se(){if(!mi)return!1;var re={},ge=pt.CSS&&pt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(An){re[An]=ge?pt.CSS.supports("touch-action",An):!0}),re}var qe=1,Rn=2,Pn=4,tn=8,mn=tn,dr=16,fr=32;function ai(re){this.options=ve({},this.defaults,re||{}),this.id=Zt(),this.manager=null,this.options.enable=or(this.options.enable,!0),this.state=qe,this.simultaneous={},this.requireFail=[]}ai.prototype={defaults:{},set:function(re){return ve(this.options,re),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(re){if(Ie(re,"recognizeWith",this))return this;var ge=this.simultaneous;return re=si(re,this),ge[re.id]||(ge[re.id]=re,re.recognizeWith(this)),this},dropRecognizeWith:function(re){return Ie(re,"dropRecognizeWith",this)?this:(re=si(re,this),delete this.simultaneous[re.id],this)},requireFailure:function(re){if(Ie(re,"requireFailure",this))return this;var ge=this.requireFail;return re=si(re,this),er(ge,re)===-1&&(ge.push(re),re.requireFailure(this)),this},dropRequireFailure:function(re){if(Ie(re,"dropRequireFailure",this))return this;re=si(re,this);var ge=er(this.requireFail,re);return ge>-1&&this.requireFail.splice(ge,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(re){return!!this.simultaneous[re.id]},emit:function(re){var ge=this,An=this.state;function tr(Ei){ge.manager.emit(Ei,re)}An<tn&&tr(ge.options.event+Vi(An)),tr(ge.options.event),re.additionalEvent&&tr(re.additionalEvent),An>=tn&&tr(ge.options.event+Vi(An))},tryEmit:function(re){if(this.canEmit())return this.emit(re);this.state=fr},canEmit:function(){for(var re=0;re<this.requireFail.length;){if(!(this.requireFail[re].state&(fr|qe)))return!1;re++}return!0},recognize:function(re){var ge=ve({},re);if(!mr(this.options.enable,[this,ge])){this.reset(),this.state=fr;return}this.state&(mn|dr|fr)&&(this.state=qe),this.state=this.process(ge),this.state&(Rn|Pn|tn|dr)&&this.tryEmit(ge)},process:function(re){},getTouchAction:function(){},reset:function(){}};function Vi(re){return re&dr?"cancel":re&tn?"end":re&Pn?"move":re&Rn?"start":""}function mo(re){return re==Ae?"down":re==Bt?"up":re==Be?"left":re==At?"right":""}function si(re,ge){var An=ge.manager;return An?An.get(re):re}function Wi(){ai.apply(this,arguments)}En(Wi,ai,{defaults:{pointers:1},attrTest:function(re){var ge=this.options.pointers;return ge===0||re.pointers.length===ge},process:function(re){var ge=this.state,An=re.eventType,tr=ge&(Rn|Pn),Ei=this.attrTest(re);return tr&&(An&rn||!Ei)?ge|dr:tr||Ei?An&ir?ge|tn:ge&Rn?ge|Pn:Rn:fr}});function Ui(){Wi.apply(this,arguments),this.pX=null,this.pY=null}En(Ui,Wi,{defaults:{event:"pan",threshold:10,pointers:1,direction:F},getTouchAction:function(){var re=this.options.direction,ge=[];return re&z&&ge.push(Lo),re&rt&&ge.push(Pa),ge},directionTest:function(re){var ge=this.options,An=!0,tr=re.distance,Ei=re.direction,Si=re.deltaX,uo=re.deltaY;return Ei&ge.direction||(ge.direction&z?(Ei=Si===0?De:Si<0?Be:At,An=Si!=this.pX,tr=Math.abs(re.deltaX)):(Ei=uo===0?De:uo<0?Bt:Ae,An=uo!=this.pY,tr=Math.abs(re.deltaY))),re.direction=Ei,An&&tr>ge.threshold&&Ei&ge.direction},attrTest:function(re){return Wi.prototype.attrTest.call(this,re)&&(this.state&Rn||!(this.state&Rn)&&this.directionTest(re))},emit:function(re){this.pX=re.deltaX,this.pY=re.deltaY;var ge=mo(re.direction);ge&&(re.additionalEvent=this.options.event+ge),this._super.emit.call(this,re)}});function Xr(){Wi.apply(this,arguments)}En(Xr,Wi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[aa]},attrTest:function(re){return this._super.attrTest.call(this,re)&&(Math.abs(re.scale-1)>this.options.threshold||this.state&Rn)},emit:function(re){if(re.scale!==1){var ge=re.scale<1?"in":"out";re.additionalEvent=this.options.event+ge}this._super.emit.call(this,re)}});function bo(){ai.apply(this,arguments),this._timer=null,this._input=null}En(bo,ai,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wo]},process:function(re){var ge=this.options,An=re.pointers.length===ge.pointers,tr=re.distance<ge.threshold,Ei=re.deltaTime>ge.time;if(this._input=re,!tr||!An||re.eventType&(ir|rn)&&!Ei)this.reset();else if(re.eventType&cn)this.reset(),this._timer=Jt(function(){this.state=mn,this.tryEmit()},ge.time,this);else if(re.eventType&ir)return mn;return fr},reset:function(){clearTimeout(this._timer)},emit:function(re){this.state===mn&&(re&&re.eventType&ir?this.manager.emit(this.options.event+"up",re):(this._input.timeStamp=Nt(),this.manager.emit(this.options.event,this._input)))}});function Ni(){Wi.apply(this,arguments)}En(Ni,Wi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[aa]},attrTest:function(re){return this._super.attrTest.call(this,re)&&(Math.abs(re.rotation)>this.options.threshold||this.state&Rn)}});function Eo(){Wi.apply(this,arguments)}En(Eo,Wi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:z|rt,pointers:1},getTouchAction:function(){return Ui.prototype.getTouchAction.call(this)},attrTest:function(re){var ge=this.options.direction,An;return ge&(z|rt)?An=re.overallVelocity:ge&z?An=re.overallVelocityX:ge&rt&&(An=re.overallVelocityY),this._super.attrTest.call(this,re)&&ge&re.offsetDirection&&re.distance>this.options.threshold&&re.maxPointers==this.options.pointers&&fn(An)>this.options.velocity&&re.eventType&ir},emit:function(re){var ge=mo(re.offsetDirection);ge&&this.manager.emit(this.options.event+ge,re),this.manager.emit(this.options.event,re)}});function Xi(){ai.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}En(Xi,ai,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Li]},process:function(re){var ge=this.options,An=re.pointers.length===ge.pointers,tr=re.distance<ge.threshold,Ei=re.deltaTime<ge.time;if(this.reset(),re.eventType&cn&&this.count===0)return this.failTimeout();if(tr&&Ei&&An){if(re.eventType!=ir)return this.failTimeout();var Si=this.pTime?re.timeStamp-this.pTime<ge.interval:!0,uo=!this.pCenter||Zn(this.pCenter,re.center)<ge.posThreshold;this.pTime=re.timeStamp,this.pCenter=re.center,!uo||!Si?this.count=1:this.count+=1,this._input=re;var Es=this.count%ge.taps;if(Es===0)return this.hasRequireFailures()?(this._timer=Jt(function(){this.state=mn,this.tryEmit()},ge.interval,this),Rn):mn}return fr},failTimeout:function(){return this._timer=Jt(function(){this.state=fr},this.options.interval,this),fr},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Mo(re,ge){return ge=ge||{},ge.recognizers=or(ge.recognizers,Mo.defaults.preset),new Ya(re,ge)}Mo.VERSION="2.0.7",Mo.defaults={domEvents:!1,touchAction:xi,enable:!0,inputTarget:null,inputClass:null,preset:[[Ni,{enable:!1}],[Xr,{enable:!1},["rotate"]],[Eo,{direction:z}],[Ui,{direction:z},["swipe"]],[Xi],[Xi,{event:"doubletap",taps:2},["tap"]],[bo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Xo=1,wl=2;function Ya(re,ge){this.options=ve({},Mo.defaults,ge||{}),this.options.inputTarget=this.options.inputTarget||re,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=re,this.input=ae(this),this.touchAction=new Mt(this,this.options.touchAction),ca(this,!0),fe(this.options.recognizers,function(An){var tr=this.add(new An[0](An[1]));An[2]&&tr.recognizeWith(An[2]),An[3]&&tr.requireFailure(An[3])},this)}Ya.prototype={set:function(re){return ve(this.options,re),re.touchAction&&this.touchAction.update(),re.inputTarget&&(this.input.destroy(),this.input.target=re.inputTarget,this.input.init()),this},stop:function(re){this.session.stopped=re?wl:Xo},recognize:function(re){var ge=this.session;if(!ge.stopped){this.touchAction.preventDefaults(re);var An,tr=this.recognizers,Ei=ge.curRecognizer;(!Ei||Ei&&Ei.state&mn)&&(Ei=ge.curRecognizer=null);for(var Si=0;Si<tr.length;)An=tr[Si],ge.stopped!==wl&&(!Ei||An==Ei||An.canRecognizeWith(Ei))?An.recognize(re):An.reset(),!Ei&&An.state&(Rn|Pn|tn)&&(Ei=ge.curRecognizer=An),Si++}},get:function(re){if(re instanceof ai)return re;for(var ge=this.recognizers,An=0;An<ge.length;An++)if(ge[An].options.event==re)return ge[An];return null},add:function(re){if(Ie(re,"add",this))return this;var ge=this.get(re.options.event);return ge&&this.remove(ge),this.recognizers.push(re),re.manager=this,this.touchAction.update(),re},remove:function(re){if(Ie(re,"remove",this))return this;if(re=this.get(re),re){var ge=this.recognizers,An=er(ge,re);An!==-1&&(ge.splice(An,1),this.touchAction.update())}return this},on:function(re,ge){if(re!==yt&&ge!==yt){var An=this.handlers;return fe(Je(re),function(tr){An[tr]=An[tr]||[],An[tr].push(ge)}),this}},off:function(re,ge){if(re!==yt){var An=this.handlers;return fe(Je(re),function(tr){ge?An[tr]&&An[tr].splice(er(An[tr],ge),1):delete An[tr]}),this}},emit:function(re,ge){this.options.domEvents&&ws(re,ge);var An=this.handlers[re]&&this.handlers[re].slice();if(!(!An||!An.length)){ge.type=re,ge.preventDefault=function(){ge.srcEvent.preventDefault()};for(var tr=0;tr<An.length;)An[tr](ge),tr++}},destroy:function(){this.element&&ca(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ca(re,ge){var An=re.element;if(An.style){var tr;fe(re.options.cssProps,function(Ei,Si){tr=gt(An.style,Si),ge?(re.oldCssProps[tr]=An.style[tr],An.style[tr]=Ei):An.style[tr]=re.oldCssProps[tr]||""}),ge||(re.oldCssProps={})}}function ws(re,ge){var An=R.createEvent("Event");An.initEvent(re,!0,!0),An.gesture=ge,ge.target.dispatchEvent(An)}ve(Mo,{INPUT_START:cn,INPUT_MOVE:wn,INPUT_END:ir,INPUT_CANCEL:rn,STATE_POSSIBLE:qe,STATE_BEGAN:Rn,STATE_CHANGED:Pn,STATE_ENDED:tn,STATE_RECOGNIZED:mn,STATE_CANCELLED:dr,STATE_FAILED:fr,DIRECTION_NONE:De,DIRECTION_LEFT:Be,DIRECTION_RIGHT:At,DIRECTION_UP:Bt,DIRECTION_DOWN:Ae,DIRECTION_HORIZONTAL:z,DIRECTION_VERTICAL:rt,DIRECTION_ALL:F,Manager:Ya,Input:Vt,TouchAction:Mt,TouchInput:Hn,MouseInput:bn,PointerEventInput:ut,TouchMouseInput:Ur,SingleTouchInput:Ge,Recognizer:ai,AttrRecognizer:Wi,Tap:Xi,Pan:Ui,Swipe:Eo,Pinch:Xr,Rotate:Ni,Press:bo,on:He,off:$t,each:fe,merge:Un,extend:Ze,assign:ve,inherit:En,bindFn:Vn,prefixed:gt});var Ms=typeof pt!="undefined"?pt:typeof self!="undefined"?self:{};Ms.Hammer=Mo,ne=function(){return Mo}.call(rr,it,rr,br),ne!==yt&&(br.exports=ne)})(window,document,"Hammer")},47443:function(br,rr,it){var ne=it(42118);function pt(R,$e){var yt=R==null?0:R.length;return!!yt&&ne(R,$e,0)>-1}br.exports=pt},1196:function(br){function rr(it,ne,pt){for(var R=-1,$e=it==null?0:it.length;++R<$e;)if(pt(ne,it[R]))return!0;return!1}br.exports=rr},29750:function(br){function rr(it,ne,pt){return it===it&&(pt!==void 0&&(it=it<=pt?it:pt),ne!==void 0&&(it=it>=ne?it:ne)),it}br.exports=rr},41848:function(br){function rr(it,ne,pt,R){for(var $e=it.length,yt=pt+(R?1:-1);R?yt--:++yt<$e;)if(ne(it[yt],yt,it))return yt;return-1}br.exports=rr},42118:function(br,rr,it){var ne=it(41848),pt=it(62722),R=it(39375);function $e(yt,xe,le){return xe===xe?R(yt,xe,le):ne(yt,pt,le)}br.exports=$e},74221:function(br){function rr(it,ne,pt,R){for(var $e=pt-1,yt=it.length;++$e<yt;)if(R(it[$e],ne))return $e;return-1}br.exports=rr},62722:function(br){function rr(it){return it!==it}br.exports=rr},65464:function(br,rr,it){var ne=it(29932),pt=it(42118),R=it(74221),$e=it(51717),yt=it(6450),xe=Array.prototype,le=xe.splice;function Le(Lt,fn,Nt,Jt){var Ie=Jt?R:pt,fe=-1,ce=fn.length,ve=Lt;for(Lt===fn&&(fn=yt(fn)),Nt&&(ve=ne(Lt,$e(Nt)));++fe<ce;)for(var Ze=0,Un=fn[fe],En=Nt?Nt(Un):Un;(Ze=Ie(ve,En,Ze,Jt))>-1;)ve!==Lt&&le.call(ve,Ze,1),le.call(Lt,Ze,1);return Lt}br.exports=Le},45652:function(br,rr,it){var ne=it(88668),pt=it(47443),R=it(1196),$e=it(74757),yt=it(23593),xe=it(21814),le=200;function Le(Lt,fn,Nt){var Jt=-1,Ie=pt,fe=Lt.length,ce=!0,ve=[],Ze=ve;if(Nt)ce=!1,Ie=R;else if(fe>=le){var Un=fn?null:yt(Lt);if(Un)return xe(Un);ce=!1,Ie=$e,Ze=new ne}else Ze=fn?[]:ve;t:for(;++Jt<fe;){var En=Lt[Jt],Vn=fn?fn(En):En;if(En=Nt||En!==0?En:0,ce&&Vn===Vn){for(var mr=Ze.length;mr--;)if(Ze[mr]===Vn)continue t;fn&&Ze.push(Vn),ve.push(En)}else Ie(Ze,Vn,Nt)||(Ze!==ve&&Ze.push(Vn),ve.push(En))}return ve}br.exports=Le},23593:function(br,rr,it){var ne=it(58525),pt=it(28117),R=it(21814),$e=1/0,yt=ne&&1/R(new ne([,-0]))[1]==$e?function(xe){return new ne(xe)}:pt;br.exports=yt},39375:function(br){function rr(it,ne,pt){for(var R=pt-1,$e=it.length;++R<$e;)if(it[R]===ne)return R;return-1}br.exports=rr},74691:function(br,rr,it){var ne=it(29750),pt=it(14841);function R($e,yt,xe){return xe===void 0&&(xe=yt,yt=void 0),xe!==void 0&&(xe=pt(xe),xe=xe===xe?xe:0),yt!==void 0&&(yt=pt(yt),yt=yt===yt?yt:0),ne(pt($e),yt,xe)}br.exports=R},51584:function(br,rr,it){var ne=it(44239),pt=it(37005),R="[object Boolean]";function $e(yt){return yt===!0||yt===!1||pt(yt)&&ne(yt)==R}br.exports=$e},18446:function(br,rr,it){var ne=it(90939);function pt(R,$e){return ne(R,$e)}br.exports=pt},14293:function(br){function rr(it){return it==null}br.exports=rr},81763:function(br,rr,it){var ne=it(44239),pt=it(37005),R="[object Number]";function $e(yt){return typeof yt=="number"||pt(yt)&&ne(yt)==R}br.exports=$e},52353:function(br){function rr(it){return it===void 0}br.exports=rr},30236:function(br,rr,it){var ne=it(42980),pt=it(21463),R=pt(function($e,yt,xe,le){ne($e,yt,xe,le)});br.exports=R},28117:function(br){function rr(){}br.exports=rr},97019:function(br,rr,it){var ne=it(5976),pt=it(45604),R=ne(pt);br.exports=R},45604:function(br,rr,it){var ne=it(65464);function pt(R,$e){return R&&R.length&&$e&&$e.length?ne(R,$e):R}br.exports=pt},44908:function(br,rr,it){var ne=it(45652);function pt(R){return R&&R.length?ne(R):[]}br.exports=pt},73955:function(br,rr,it){var ne=it(79833),pt=0;function R($e){var yt=++pt;return ne($e)+yt}br.exports=R},6158:function(br){(function(rr,it){br.exports=it()})(this,function(){"use strict";var rr,it,ne;function pt(R,$e){if(!rr)rr=$e;else if(!it)it=$e;else{var yt="var sharedChunk = {}; ("+rr+")(sharedChunk); ("+it+")(sharedChunk);",xe={};rr(xe),ne=$e(xe),typeof window!="undefined"&&(ne.workerUrl=window.URL.createObjectURL(new Blob([yt],{type:"text/javascript"})))}}return pt(["exports"],function(R){"use strict";function $e(c,d){return c(d={exports:{}},d.exports),d.exports}var yt=xe;function xe(c,d,g,w){this.cx=3*c,this.bx=3*(g-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(w-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=w,this.p2x=g,this.p2y=w}xe.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c},xe.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c},xe.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},xe.prototype.solveCurveX=function(c,d){var g,w,P,N,j;for(d===void 0&&(d=1e-6),P=c,j=0;j<8;j++){if(N=this.sampleCurveX(P)-c,Math.abs(N)<d)return P;var q=this.sampleCurveDerivativeX(P);if(Math.abs(q)<1e-6)break;P-=N/q}if((P=c)<(g=0))return g;if(P>(w=1))return w;for(;g<w;){if(N=this.sampleCurveX(P),Math.abs(N-c)<d)return P;c>N?g=P:w=P,P=.5*(w-g)+g}return P},xe.prototype.solve=function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))};var le=Le;function Le(c,d){this.x=c,this.y=d}Le.prototype={clone:function(){return new Le(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,d){return this.clone()._rotateAround(c,d)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var d=c.x-this.x,g=c.y-this.y;return d*d+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)},_matMult:function(c){var d=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=d,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var d=Math.cos(c),g=Math.sin(c),w=g*this.x+d*this.y;return this.x=d*this.x-g*this.y,this.y=w,this},_rotateAround:function(c,d){var g=Math.cos(c),w=Math.sin(c),P=d.y+w*(this.x-d.x)+g*(this.y-d.y);return this.x=d.x+g*(this.x-d.x)-w*(this.y-d.y),this.y=P,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Le.convert=function(c){return c instanceof Le?c:Array.isArray(c)?new Le(c[0],c[1]):c};var Lt=typeof self!="undefined"?self:{},fn=Math.pow(2,53)-1;function Nt(c,d,g,w){var P=new yt(c,d,g,w);return function(N){return P.solve(N)}}var Jt=Nt(.25,.1,.25,1);function Ie(c,d,g){return Math.min(g,Math.max(d,c))}function fe(c,d,g){var w=g-d,P=((c-d)%w+w)%w+d;return P===d?g:P}function ce(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var w=0,P=d;w<P.length;w+=1){var N=P[w];for(var j in N)c[j]=N[j]}return c}var ve=1;function Ze(){return ve++}function Un(){return function c(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function En(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Vn(c,d){c.forEach(function(g){d[g]&&(d[g]=d[g].bind(d))})}function mr(c,d){return c.indexOf(d,c.length-d.length)!==-1}function or(c,d,g){var w={};for(var P in c)w[P]=d.call(g||this,c[P],P,c);return w}function He(c,d,g){var w={};for(var P in c)d.call(g||this,c[P],P,c)&&(w[P]=c[P]);return w}function $t(c){return Array.isArray(c)?c.map($t):typeof c=="object"&&c?or(c,$t):c}var nn={};function ke(c){nn[c]||(typeof console!="undefined"&&console.warn(c),nn[c]=!0)}function Je(c,d,g){return(g.y-c.y)*(d.x-c.x)>(d.y-c.y)*(g.x-c.x)}function er(c){for(var d=0,g=0,w=c.length,P=w-1,N=void 0,j=void 0;g<w;P=g++)d+=((j=c[P]).x-(N=c[g]).x)*(N.y+j.y);return d}function kt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Te(c){var d={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(w,P,N,j){var q=N||j;return d[P]=!q||q.toLowerCase(),""}),d["max-age"]){var g=parseInt(d["max-age"],10);isNaN(g)?delete d["max-age"]:d["max-age"]=g}return d}var gt=null;function te(c){if(gt==null){var d=c.navigator?c.navigator.userAgent:null;gt=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return gt}function Zt(c){try{var d=Lt[c];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(g){return!1}}var Ut,we,ie,_t,Ne=Lt.performance&&Lt.performance.now?Lt.performance.now.bind(Lt.performance):Date.now.bind(Date),un=Lt.requestAnimationFrame||Lt.mozRequestAnimationFrame||Lt.webkitRequestAnimationFrame||Lt.msRequestAnimationFrame,Qn=Lt.cancelAnimationFrame||Lt.mozCancelAnimationFrame||Lt.webkitCancelAnimationFrame||Lt.msCancelAnimationFrame,hr={now:Ne,frame:function(c){var d=un(c);return{cancel:function(){return Qn(d)}}},getImageData:function(c,d){d===void 0&&(d=0);var g=Lt.document.createElement("canvas"),w=g.getContext("2d");if(!w)throw new Error("failed to create canvas 2d context");return g.width=c.width,g.height=c.height,w.drawImage(c,0,0,c.width,c.height),w.getImageData(-d,-d,c.width+2*d,c.height+2*d)},resolveURL:function(c){return Ut||(Ut=Lt.document.createElement("a")),Ut.href=c,Ut.href},hardwareConcurrency:Lt.navigator&&Lt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Lt.devicePixelRatio},get prefersReducedMotion(){return!!Lt.matchMedia&&(we==null&&(we=Lt.matchMedia("(prefers-reduced-motion: reduce)")),we.matches)}},Er={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ue={supported:!1,testSupport:function(c){!cn&&_t&&(wn?ir(c):ie=c)}},cn=!1,wn=!1;function ir(c){var d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,_t),c.isContextLost())return;Ue.supported=!0}catch(g){}c.deleteTexture(d),cn=!0}Lt.document&&((_t=Lt.document.createElement("img")).onload=function(){ie&&ir(ie),ie=null,wn=!0},_t.onerror=function(){cn=!0,ie=null},_t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var rn="01",De=function(c,d){this._transformRequestFn=c,this._customAccessToken=d,this._createSkuToken()};function Be(c){return c.indexOf("mapbox:")===0}De.prototype._createSkuToken=function(){var c=function(){for(var d="",g=0;g<10;g++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",rn,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt},De.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},De.prototype.transformRequest=function(c,d){return this._transformRequestFn&&this._transformRequestFn(c,d)||{url:c}},De.prototype.normalizeStyleURL=function(c,d){if(!Be(c))return c;var g=z(c);return g.path="/styles/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},De.prototype.normalizeGlyphsURL=function(c,d){if(!Be(c))return c;var g=z(c);return g.path="/fonts/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},De.prototype.normalizeSourceURL=function(c,d){if(!Be(c))return c;var g=z(c);return g.path="/v4/"+g.authority+".json",g.params.push("secure"),this._makeAPIURL(g,this._customAccessToken||d)},De.prototype.normalizeSpriteURL=function(c,d,g,w){var P=z(c);return Be(c)?(P.path="/styles/v1"+P.path+"/sprite"+d+g,this._makeAPIURL(P,this._customAccessToken||w)):(P.path+=""+d+g,rt(P))},De.prototype.normalizeTileURL=function(c,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Be(c))return c;var g=z(c);g.path=g.path.replace(/(\.(png|jpg)\d*)(?=$)/,(hr.devicePixelRatio>=2||d===512?"@2x":"")+(Ue.supported?".webp":"$1")),g.path=g.path.replace(/^.+\/v4\//,"/"),g.path="/v4"+g.path;var w=this._customAccessToken||function(P){for(var N=0,j=P;N<j.length;N+=1){var q=j[N].match(/^access_token=(.*)$/);if(q)return q[1]}return null}(g.params)||Er.ACCESS_TOKEN;return Er.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&g.params.push("sku="+this._skuToken),this._makeAPIURL(g,w)},De.prototype.canonicalizeTileURL=function(c,d){var g=z(c);if(!g.path.match(/(^\/v4\/)/)||!g.path.match(/\.[\w]+$/))return c;var w="mapbox://tiles/";w+=g.path.replace("/v4/","");var P=g.params;return d&&(P=P.filter(function(N){return!N.match(/^access_token=/)})),P.length&&(w+="?"+P.join("&")),w},De.prototype.canonicalizeTileset=function(c,d){for(var g=!!d&&Be(d),w=[],P=0,N=c.tiles||[];P<N.length;P+=1){var j=N[P];Bt(j)?w.push(this.canonicalizeTileURL(j,g)):w.push(j)}return w},De.prototype._makeAPIURL=function(c,d){var g="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",w=z(Er.API_URL);if(c.protocol=w.protocol,c.authority=w.authority,c.protocol==="http"){var P=c.params.indexOf("secure");P>=0&&c.params.splice(P,1)}if(w.path!=="/"&&(c.path=""+w.path+c.path),!Er.REQUIRE_ACCESS_TOKEN)return rt(c);if(!(d=d||Er.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return c.params=c.params.filter(function(N){return N.indexOf("access_token")===-1}),c.params.push("access_token="+d),rt(c)};var At=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Bt(c){return At.test(c)}var Ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function z(c){var d=c.match(Ae);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function rt(c){var d=c.params.length?"?"+c.params.join("&"):"";return c.protocol+"://"+c.authority+c.path+d}function F(c){if(!c)return null;var d=c.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(Lt.atob(d[1]).split("").map(function(g){return"%"+("00"+g.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(g){return null}}var ot=function(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ot.prototype.getStorageKey=function(c){var d,g=F(Er.ACCESS_TOKEN);return d=g&&g.u?Lt.btoa(encodeURIComponent(g.u).replace(/%([0-9A-F]{2})/g,function(w,P){return String.fromCharCode(+("0x"+P))})):Er.ACCESS_TOKEN||"",c?"mapbox.eventData."+c+":"+d:"mapbox.eventData:"+d},ot.prototype.fetchEventData=function(){var c=Zt("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{var w=Lt.localStorage.getItem(d);w&&(this.eventData=JSON.parse(w));var P=Lt.localStorage.getItem(g);P&&(this.anonId=P)}catch(N){ke("Unable to read from LocalStorage")}},ot.prototype.saveEventData=function(){var c=Zt("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{Lt.localStorage.setItem(g,this.anonId),Object.keys(this.eventData).length>=1&&Lt.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(w){ke("Unable to write to LocalStorage")}},ot.prototype.processRequests=function(c){},ot.prototype.postEvent=function(c,d,g,w){var P=this;if(Er.EVENTS_URL){var N=z(Er.EVENTS_URL);N.params.push("access_token="+(w||Er.ACCESS_TOKEN||""));var j={event:this.type,created:new Date(c).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:rn,userId:this.anonId},q=d?ce(j,d):j,at={url:rt(N),headers:{"Content-Type":"text/plain"},body:JSON.stringify([q])};this.pendingRequest=Gn(at,function(vt){P.pendingRequest=null,g(vt),P.saveEventData(),P.processRequests(w)})}},ot.prototype.queueRequest=function(c,d){this.queue.push(c),this.processRequests(d)};var ze,Vt,ae=function(c){function d(){c.call(this,"map.load"),this.success={},this.skuToken=""}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(g,w,P,N){this.skuToken=P;var j=!(!N&&!Er.ACCESS_TOKEN),q=Array.isArray(g)&&g.some(function(at){return Be(at)||Bt(at)});Er.EVENTS_URL&&j&&q&&this.queueRequest({id:w,timestamp:Date.now()},N)},d.prototype.processRequests=function(g){var w=this;if(!this.pendingRequest&&this.queue.length!==0){var P=this.queue.shift(),N=P.id,j=P.timestamp;N&&this.success[N]||(this.anonId||this.fetchEventData(),En(this.anonId)||(this.anonId=Un()),this.postEvent(j,{skuToken:this.skuToken},function(q){q||N&&(w.success[N]=!0)},g))}},d}(ot),Mn=new(function(c){function d(g){c.call(this,"appUserTurnstile"),this._customAccessToken=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(g,w){Er.EVENTS_URL&&Er.ACCESS_TOKEN&&Array.isArray(g)&&g.some(function(P){return Be(P)||Bt(P)})&&this.queueRequest(Date.now(),w)},d.prototype.processRequests=function(g){var w=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var P=F(Er.ACCESS_TOKEN),N=P?P.u:Er.ACCESS_TOKEN,j=N!==this.eventData.tokenU;En(this.anonId)||(this.anonId=Un(),j=!0);var q=this.queue.shift();if(this.eventData.lastSuccess){var at=new Date(this.eventData.lastSuccess),vt=new Date(q),Ot=(q-this.eventData.lastSuccess)/864e5;j=j||Ot>=1||Ot<-1||at.getDate()!==vt.getDate()}else j=!0;if(!j)return this.processRequests();this.postEvent(q,{"enabled.telemetry":!1},function(Dt){Dt||(w.eventData.lastSuccess=q,w.eventData.tokenU=N)},g)}},d}(ot)),zn=Mn.postTurnstileEvent.bind(Mn),Wn=new ae,sn=Wn.postMapLoadEvent.bind(Wn),Kt=500,Ce=50;function xn(){Lt.caches&&!ze&&(ze=Lt.caches.open("mapbox-tiles"))}function Cn(c){var d=c.indexOf("?");return d<0?c:c.slice(0,d)}var Zn,Qt=1/0;function ct(){return Zn==null&&(Zn=Lt.OffscreenCanvas&&new Lt.OffscreenCanvas(1,1).getContext("2d")&&typeof Lt.createImageBitmap=="function"),Zn}var bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(bt);var zt=function(c){function d(g,w,P){w===401&&Bt(P)&&(g+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),c.call(this,g),this.status=w,this.url=P,this.name=this.constructor.name,this.message=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),me=kt()?function(){return self.worker&&self.worker.referrer}:function(){return(Lt.location.protocol==="blob:"?Lt.parent:Lt).location.href},de,bn,qn=function(c,d){if(!(/^file:/.test(g=c.url)||/^file:/.test(me())&&!/^\w+:/.test(g))){if(Lt.fetch&&Lt.Request&&Lt.AbortController&&Lt.Request.prototype.hasOwnProperty("signal"))return function(w,P){var N,j=new Lt.AbortController,q=new Lt.Request(w.url,{method:w.method||"GET",body:w.body,credentials:w.credentials,headers:w.headers,referrer:me(),signal:j.signal}),at=!1,vt=!1,Ot=(N=q.url).indexOf("sku=")>0&&Bt(N);w.type==="json"&&q.headers.set("Accept","application/json");var Dt=function(pe,Xe,en){if(!vt){if(pe&&pe.message!=="SecurityError"&&ke(pe),Xe&&en)return Yt(Xe);var kn=Date.now();Lt.fetch(q).then(function(Sn){if(Sn.ok){var sr=Ot?Sn.clone():null;return Yt(Sn,sr,kn)}return P(new zt(Sn.statusText,Sn.status,w.url))}).catch(function(Sn){Sn.code!==20&&P(new Error(Sn.message))})}},Yt=function(pe,Xe,en){(w.type==="arrayBuffer"?pe.arrayBuffer():w.type==="json"?pe.json():pe.text()).then(function(kn){vt||(Xe&&en&&function(Sn,sr,pr){if(xn(),ze){var xr={status:sr.status,statusText:sr.statusText,headers:new Lt.Headers};sr.headers.forEach(function(Wr,Ci){return xr.headers.set(Ci,Wr)});var Ir=Te(sr.headers.get("Cache-Control")||"");Ir["no-store"]||(Ir["max-age"]&&xr.headers.set("Expires",new Date(pr+1e3*Ir["max-age"]).toUTCString()),new Date(xr.headers.get("Expires")).getTime()-pr<42e4||function(Wr,Ci){if(Vt===void 0)try{new Response(new ReadableStream),Vt=!0}catch(Ai){Vt=!1}Vt?Ci(Wr.body):Wr.blob().then(Ci)}(sr,function(Wr){var Ci=new Lt.Response(Wr,xr);xn(),ze&&ze.then(function(Ai){return Ai.put(Cn(Sn.url),Ci)}).catch(function(Ai){return ke(Ai.message)})}))}}(q,Xe,en),at=!0,P(null,kn,pe.headers.get("Cache-Control"),pe.headers.get("Expires")))}).catch(function(kn){vt||P(new Error(kn.message))})};return Ot?function(pe,Xe){if(xn(),!ze)return Xe(null);var en=Cn(pe.url);ze.then(function(kn){kn.match(en).then(function(Sn){var sr=function(pr){if(!pr)return!1;var xr=new Date(pr.headers.get("Expires")||0),Ir=Te(pr.headers.get("Cache-Control")||"");return xr>Date.now()&&!Ir["no-cache"]}(Sn);kn.delete(en),sr&&kn.put(en,Sn.clone()),Xe(null,Sn,sr)}).catch(Xe)}).catch(Xe)}(q,Dt):Dt(null,null),{cancel:function(){vt=!0,at||j.abort()}}}(c,d);if(kt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,d,void 0,!0)}var g;return function(w,P){var N=new Lt.XMLHttpRequest;for(var j in N.open(w.method||"GET",w.url,!0),w.type==="arrayBuffer"&&(N.responseType="arraybuffer"),w.headers)N.setRequestHeader(j,w.headers[j]);return w.type==="json"&&(N.responseType="text",N.setRequestHeader("Accept","application/json")),N.withCredentials=w.credentials==="include",N.onerror=function(){P(new Error(N.statusText))},N.onload=function(){if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){var q=N.response;if(w.type==="json")try{q=JSON.parse(N.response)}catch(at){return P(at)}P(null,q,N.getResponseHeader("Cache-Control"),N.getResponseHeader("Expires"))}else P(new zt(N.statusText,N.status,w.url))},N.send(w.body),{cancel:function(){return N.abort()}}}(c,d)},Sr=function(c,d){return qn(ce(c,{type:"arrayBuffer"}),d)},Gn=function(c,d){return qn(ce(c,{method:"POST"}),d)},ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";de=[],bn=0;var ut=function(c,d){if(Ue.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),bn>=Er.MAX_PARALLEL_IMAGE_REQUESTS){var g={requestParameters:c,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return de.push(g),g}bn++;var w=!1,P=function(){if(!w)for(w=!0,bn--;de.length&&bn<Er.MAX_PARALLEL_IMAGE_REQUESTS;){var j=de.shift();j.cancelled||(j.cancel=ut(j.requestParameters,j.callback).cancel)}},N=Sr(c,function(j,q,at,vt){P(),j?d(j):q&&(ct()?function(Ot,Dt){var Yt=new Lt.Blob([new Uint8Array(Ot)],{type:"image/png"});Lt.createImageBitmap(Yt).then(function(pe){Dt(null,pe)}).catch(function(pe){Dt(new Error("Could not load image because of "+pe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(q,d):function(Ot,Dt,Yt,pe){var Xe=new Lt.Image,en=Lt.URL;Xe.onload=function(){Dt(null,Xe),en.revokeObjectURL(Xe.src),Xe.onload=null,Lt.requestAnimationFrame(function(){Xe.src=ht})},Xe.onerror=function(){return Dt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var kn=new Lt.Blob([new Uint8Array(Ot)],{type:"image/png"});Xe.cacheControl=Yt,Xe.expires=pe,Xe.src=Ot.byteLength?en.createObjectURL(kn):ht}(q,d,at,vt))});return{cancel:function(){N.cancel(),P()}}};function wt(c,d,g){g[c]&&g[c].indexOf(d)!==-1||(g[c]=g[c]||[],g[c].push(d))}function Gt(c,d,g){if(g&&g[c]){var w=g[c].indexOf(d);w!==-1&&g[c].splice(w,1)}}var ue=function(c,d){d===void 0&&(d={}),ce(this,d),this.type=c},Ge=function(c){function d(g,w){w===void 0&&(w={}),c.call(this,"error",ce({error:g},w))}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(ue),ln=function(){};ln.prototype.on=function(c,d){return this._listeners=this._listeners||{},wt(c,d,this._listeners),this},ln.prototype.off=function(c,d){return Gt(c,d,this._listeners),Gt(c,d,this._oneTimeListeners),this},ln.prototype.once=function(c,d){return this._oneTimeListeners=this._oneTimeListeners||{},wt(c,d,this._oneTimeListeners),this},ln.prototype.fire=function(c,d){typeof c=="string"&&(c=new ue(c,d||{}));var g=c.type;if(this.listens(g)){c.target=this;for(var w=0,P=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];w<P.length;w+=1)P[w].call(this,c);for(var N=0,j=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];N<j.length;N+=1){var q=j[N];Gt(g,q,this._oneTimeListeners),q.call(this,c)}var at=this._eventedParent;at&&(ce(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),at.fire(c))}else c instanceof Ge&&console.error(c.error);return this},ln.prototype.listens=function(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)},ln.prototype.setEventedParent=function(c,d){return this._eventedParent=c,this._eventedParentData=d,this};var ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Fe=function(c,d,g,w){this.message=(c?c+": ":"")+g,w&&(this.identifier=w),d!=null&&d.__line__&&(this.line=d.__line__)};function Hn(c){var d=c.value;return d?[new Fe(c.key,d,"constants have been deprecated as of v8")]:[]}function Tr(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var w=0,P=d;w<P.length;w+=1){var N=P[w];for(var j in N)c[j]=N[j]}return c}function Zr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function vr(c){if(Array.isArray(c))return c.map(vr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){var d={};for(var g in c)d[g]=vr(c[g]);return d}return Zr(c)}var Ur=function(c){function d(g,w){c.call(this,w),this.message=w,this.key=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Error),jr=function(c,d){d===void 0&&(d=[]),this.parent=c,this.bindings={};for(var g=0,w=d;g<w.length;g+=1){var P=w[g];this.bindings[P[0]]=P[1]}};jr.prototype.concat=function(c){return new jr(this,c)},jr.prototype.get=function(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(c+" not found in scope.")},jr.prototype.has=function(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)};var ni={kind:"null"},Ar={kind:"number"},pi={kind:"string"},mi={kind:"boolean"},xi={kind:"color"},wo={kind:"object"},Li={kind:"value"},aa={kind:"collator"},Pa={kind:"formatted"},Lo={kind:"resolvedImage"};function $o(c,d){return{kind:"array",itemType:c,N:d}}function Mt(c){if(c.kind==="array"){var d=Mt(c.itemType);return typeof c.N=="number"?"array<"+d+", "+c.N+">":c.itemType.kind==="value"?"array":"array<"+d+">"}return c.kind}var Wt=[ni,Ar,pi,mi,xi,Pa,wo,$o(Li),Lo];function Se(c,d){if(d.kind==="error")return null;if(c.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!Se(c.itemType,d.itemType))&&(typeof c.N!="number"||c.N===d.N))return null}else{if(c.kind===d.kind)return null;if(c.kind==="value"){for(var g=0,w=Wt;g<w.length;g+=1)if(!Se(w[g],d))return null}}return"Expected "+Mt(c)+" but found "+Mt(d)+" instead."}function qe(c,d){return d.some(function(g){return g.kind===c.kind})}function Rn(c,d){return d.some(function(g){return g==="null"?c===null:g==="array"?Array.isArray(c):g==="object"?c&&!Array.isArray(c)&&typeof c=="object":g===typeof c})}var Pn=$e(function(c,d){var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function w(q){return(q=Math.round(q))<0?0:q>255?255:q}function P(q){return w(q[q.length-1]==="%"?parseFloat(q)/100*255:parseInt(q))}function N(q){return(at=q[q.length-1]==="%"?parseFloat(q)/100:parseFloat(q))<0?0:at>1?1:at;var at}function j(q,at,vt){return vt<0?vt+=1:vt>1&&(vt-=1),6*vt<1?q+(at-q)*vt*6:2*vt<1?at:3*vt<2?q+(at-q)*(2/3-vt)*6:q}try{d.parseCSSColor=function(q){var at,vt=q.replace(/ /g,"").toLowerCase();if(vt in g)return g[vt].slice();if(vt[0]==="#")return vt.length===4?(at=parseInt(vt.substr(1),16))>=0&&at<=4095?[(3840&at)>>4|(3840&at)>>8,240&at|(240&at)>>4,15&at|(15&at)<<4,1]:null:vt.length===7&&(at=parseInt(vt.substr(1),16))>=0&&at<=16777215?[(16711680&at)>>16,(65280&at)>>8,255&at,1]:null;var Ot=vt.indexOf("("),Dt=vt.indexOf(")");if(Ot!==-1&&Dt+1===vt.length){var Yt=vt.substr(0,Ot),pe=vt.substr(Ot+1,Dt-(Ot+1)).split(","),Xe=1;switch(Yt){case"rgba":if(pe.length!==4)return null;Xe=N(pe.pop());case"rgb":return pe.length!==3?null:[P(pe[0]),P(pe[1]),P(pe[2]),Xe];case"hsla":if(pe.length!==4)return null;Xe=N(pe.pop());case"hsl":if(pe.length!==3)return null;var en=(parseFloat(pe[0])%360+360)%360/360,kn=N(pe[1]),Sn=N(pe[2]),sr=Sn<=.5?Sn*(kn+1):Sn+kn-Sn*kn,pr=2*Sn-sr;return[w(255*j(pr,sr,en+1/3)),w(255*j(pr,sr,en)),w(255*j(pr,sr,en-1/3)),Xe];default:return null}}return null}}catch(q){}}).parseCSSColor,tn=function(c,d,g,w){w===void 0&&(w=1),this.r=c,this.g=d,this.b=g,this.a=w};tn.parse=function(c){if(c){if(c instanceof tn)return c;if(typeof c=="string"){var d=Pn(c);if(d)return new tn(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},tn.prototype.toString=function(){var c=this.toArray(),d=c[1],g=c[2],w=c[3];return"rgba("+Math.round(c[0])+","+Math.round(d)+","+Math.round(g)+","+w+")"},tn.prototype.toArray=function(){var c=this.a;return c===0?[0,0,0,0]:[255*this.r/c,255*this.g/c,255*this.b/c,c]},tn.black=new tn(0,0,0,1),tn.white=new tn(1,1,1,1),tn.transparent=new tn(0,0,0,0),tn.red=new tn(1,0,0,1);var mn=function(c,d,g){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};mn.prototype.compare=function(c,d){return this.collator.compare(c,d)},mn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var dr=function(c,d,g,w,P){this.text=c,this.image=d,this.scale=g,this.fontStack=w,this.textColor=P},fr=function(c){this.sections=c};fr.fromString=function(c){return new fr([new dr(c,null,null,null,null)])},fr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(c){return c.text.length!==0||c.image&&c.image.name.length!==0})},fr.factory=function(c){return c instanceof fr?c:fr.fromString(c)},fr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(c){return c.text}).join("")},fr.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var w=g[d];if(w.image)c.push(["image",w.image.name]);else{c.push(w.text);var P={};w.fontStack&&(P["text-font"]=["literal",w.fontStack.split(",")]),w.scale&&(P["font-scale"]=w.scale),w.textColor&&(P["text-color"]=["rgba"].concat(w.textColor.toArray())),c.push(P)}}return c};var ai=function(c){this.name=c.name,this.available=c.available};function Vi(c,d,g,w){return typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof g=="number"&&g>=0&&g<=255?w===void 0||typeof w=="number"&&w>=0&&w<=1?null:"Invalid rgba value ["+[c,d,g,w].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof w=="number"?[c,d,g,w]:[c,d,g]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function mo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof tn||c instanceof mn||c instanceof fr||c instanceof ai)return!0;if(Array.isArray(c)){for(var d=0,g=c;d<g.length;d+=1)if(!mo(g[d]))return!1;return!0}if(typeof c=="object"){for(var w in c)if(!mo(c[w]))return!1;return!0}return!1}function si(c){if(c===null)return ni;if(typeof c=="string")return pi;if(typeof c=="boolean")return mi;if(typeof c=="number")return Ar;if(c instanceof tn)return xi;if(c instanceof mn)return aa;if(c instanceof fr)return Pa;if(c instanceof ai)return Lo;if(Array.isArray(c)){for(var d,g=c.length,w=0,P=c;w<P.length;w+=1){var N=si(P[w]);if(d){if(d===N)continue;d=Li;break}d=N}return $o(d||Li,g)}return wo}function Wi(c){var d=typeof c;return c===null?"":d==="string"||d==="number"||d==="boolean"?String(c):c instanceof tn||c instanceof fr||c instanceof ai?c.toString():JSON.stringify(c)}ai.prototype.toString=function(){return this.name},ai.fromString=function(c){return c?new ai({name:c,available:!1}):null},ai.prototype.serialize=function(){return["image",this.name]};var Ui=function(c,d){this.type=c,this.value=d};Ui.parse=function(c,d){if(c.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(!mo(c[1]))return d.error("invalid value");var g=c[1],w=si(g),P=d.expectedType;return w.kind!=="array"||w.N!==0||!P||P.kind!=="array"||typeof P.N=="number"&&P.N!==0||(w=P),new Ui(w,g)},Ui.prototype.evaluate=function(){return this.value},Ui.prototype.eachChild=function(){},Ui.prototype.outputDefined=function(){return!0},Ui.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof tn?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value};var Xr=function(c){this.name="ExpressionEvaluationError",this.message=c};Xr.prototype.toJSON=function(){return this.message};var bo={string:pi,number:Ar,boolean:mi,object:wo},Ni=function(c,d){this.type=c,this.args=d};Ni.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g,w=1,P=c[0];if(P==="array"){var N,j;if(c.length>2){var q=c[1];if(typeof q!="string"||!(q in bo)||q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);N=bo[q],w++}else N=Li;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);j=c[2],w++}g=$o(N,j)}else g=bo[P];for(var at=[];w<c.length;w++){var vt=d.parse(c[w],w,Li);if(!vt)return null;at.push(vt)}return new Ni(g,at)},Ni.prototype.evaluate=function(c){for(var d=0;d<this.args.length;d++){var g=this.args[d].evaluate(c);if(!Se(this.type,si(g)))return g;if(d===this.args.length-1)throw new Xr("Expected value to be of type "+Mt(this.type)+", but found "+Mt(si(g))+" instead.")}return null},Ni.prototype.eachChild=function(c){this.args.forEach(c)},Ni.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Ni.prototype.serialize=function(){var c=this.type,d=[c.kind];if(c.kind==="array"){var g=c.itemType;if(g.kind==="string"||g.kind==="number"||g.kind==="boolean"){d.push(g.kind);var w=c.N;(typeof w=="number"||this.args.length>1)&&d.push(w)}}return d.concat(this.args.map(function(P){return P.serialize()}))};var Eo=function(c){this.type=Pa,this.sections=c};Eo.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[1];if(!Array.isArray(g)&&typeof g=="object")return d.error("First argument must be an image or text section.");for(var w=[],P=!1,N=1;N<=c.length-1;++N){var j=c[N];if(P&&typeof j=="object"&&!Array.isArray(j)){P=!1;var q=null;if(j["font-scale"]&&!(q=d.parse(j["font-scale"],1,Ar)))return null;var at=null;if(j["text-font"]&&!(at=d.parse(j["text-font"],1,$o(pi))))return null;var vt=null;if(j["text-color"]&&!(vt=d.parse(j["text-color"],1,xi)))return null;var Ot=w[w.length-1];Ot.scale=q,Ot.font=at,Ot.textColor=vt}else{var Dt=d.parse(c[N],1,Li);if(!Dt)return null;var Yt=Dt.type.kind;if(Yt!=="string"&&Yt!=="value"&&Yt!=="null"&&Yt!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");P=!0,w.push({content:Dt,scale:null,font:null,textColor:null})}}return new Eo(w)},Eo.prototype.evaluate=function(c){return new fr(this.sections.map(function(d){var g=d.content.evaluate(c);return si(g)===Lo?new dr("",g,null,null,null):new dr(Wi(g),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null)}))},Eo.prototype.eachChild=function(c){for(var d=0,g=this.sections;d<g.length;d+=1){var w=g[d];c(w.content),w.scale&&c(w.scale),w.font&&c(w.font),w.textColor&&c(w.textColor)}},Eo.prototype.outputDefined=function(){return!1},Eo.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var w=g[d];c.push(w.content.serialize());var P={};w.scale&&(P["font-scale"]=w.scale.serialize()),w.font&&(P["text-font"]=w.font.serialize()),w.textColor&&(P["text-color"]=w.textColor.serialize()),c.push(P)}return c};var Xi=function(c){this.type=Lo,this.input=c};Xi.parse=function(c,d){if(c.length!==2)return d.error("Expected two arguments.");var g=d.parse(c[1],1,pi);return g?new Xi(g):d.error("No image name provided.")},Xi.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=ai.fromString(d);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(d)>-1),g},Xi.prototype.eachChild=function(c){c(this.input)},Xi.prototype.outputDefined=function(){return!1},Xi.prototype.serialize=function(){return["image",this.input.serialize()]};var Mo={"to-boolean":mi,"to-color":xi,"to-number":Ar,"to-string":pi},Xo=function(c,d){this.type=c,this.args=d};Xo.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[0];if((g==="to-boolean"||g==="to-string")&&c.length!==2)return d.error("Expected one argument.");for(var w=Mo[g],P=[],N=1;N<c.length;N++){var j=d.parse(c[N],N,Li);if(!j)return null;P.push(j)}return new Xo(w,P)},Xo.prototype.evaluate=function(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){for(var d,g,w=0,P=this.args;w<P.length;w+=1){if(g=null,(d=P[w].evaluate(c))instanceof tn)return d;if(typeof d=="string"){var N=c.parseColor(d);if(N)return N}else if(Array.isArray(d)&&!(g=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":Vi(d[0],d[1],d[2],d[3])))return new tn(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Xr(g||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var j=null,q=0,at=this.args;q<at.length;q+=1){if((j=at[q].evaluate(c))===null)return 0;var vt=Number(j);if(!isNaN(vt))return vt}throw new Xr("Could not convert "+JSON.stringify(j)+" to number.")}return this.type.kind==="formatted"?fr.fromString(Wi(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?ai.fromString(Wi(this.args[0].evaluate(c))):Wi(this.args[0].evaluate(c))},Xo.prototype.eachChild=function(c){this.args.forEach(c)},Xo.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Xo.prototype.serialize=function(){if(this.type.kind==="formatted")return new Eo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xi(this.args[0]).serialize();var c=["to-"+this.type.kind];return this.eachChild(function(d){c.push(d.serialize())}),c};var wl=["Unknown","Point","LineString","Polygon"],Ya=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ya.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ya.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?wl[this.feature.type]:this.feature.type:null},Ya.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ya.prototype.canonicalID=function(){return this.canonical},Ya.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ya.prototype.parseColor=function(c){var d=this._parseColorCache[c];return d||(d=this._parseColorCache[c]=tn.parse(c)),d};var ca=function(c,d,g,w){this.name=c,this.type=d,this._evaluate=g,this.args=w};ca.prototype.evaluate=function(c){return this._evaluate(c,this.args)},ca.prototype.eachChild=function(c){this.args.forEach(c)},ca.prototype.outputDefined=function(){return!1},ca.prototype.serialize=function(){return[this.name].concat(this.args.map(function(c){return c.serialize()}))},ca.parse=function(c,d){var g,w=c[0],P=ca.definitions[w];if(!P)return d.error('Unknown expression "'+w+'". If you wanted a literal array, use ["literal", [...]].',0);for(var N=Array.isArray(P)?P[0]:P.type,j=Array.isArray(P)?[[P[1],P[2]]]:P.overloads,q=j.filter(function(Ro){var Zi=Ro[0];return!Array.isArray(Zi)||Zi.length===c.length-1}),at=null,vt=0,Ot=q;vt<Ot.length;vt+=1){var Dt=Ot[vt],Yt=Dt[0],pe=Dt[1];at=new tu(d.registry,d.path,null,d.scope);for(var Xe=[],en=!1,kn=1;kn<c.length;kn++){var Sn=c[kn],sr=Array.isArray(Yt)?Yt[kn-1]:Yt.type,pr=at.parse(Sn,1+Xe.length,sr);if(!pr){en=!0;break}Xe.push(pr)}if(!en)if(Array.isArray(Yt)&&Yt.length!==Xe.length)at.error("Expected "+Yt.length+" arguments, but found "+Xe.length+" instead.");else{for(var xr=0;xr<Xe.length;xr++){var Ir=Array.isArray(Yt)?Yt[xr]:Yt.type,Wr=Xe[xr];at.concat(xr+1).checkSubtype(Ir,Wr.type)}if(at.errors.length===0)return new ca(w,N,pe,Xe)}}if(q.length===1)(g=d.errors).push.apply(g,at.errors);else{for(var Ci=(q.length?q:j).map(function(Ro){var Zi;return Zi=Ro[0],Array.isArray(Zi)?"("+Zi.map(Mt).join(", ")+")":"("+Mt(Zi.type)+"...)"}).join(" | "),Ai=[],To=1;To<c.length;To++){var ao=d.parse(c[To],1+Ai.length);if(!ao)return null;Ai.push(Mt(ao.type))}d.error("Expected arguments of type "+Ci+", but found ("+Ai.join(", ")+") instead.")}return null},ca.register=function(c,d){for(var g in ca.definitions=d,d)c[g]=ca};var ws=function(c,d,g){this.type=aa,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=d};function Ms(c,d){c[0]=Math.min(c[0],d[0]),c[1]=Math.min(c[1],d[1]),c[2]=Math.max(c[2],d[0]),c[3]=Math.max(c[3],d[1])}function re(c,d){return!(c[0]<=d[0]||c[2]>=d[2]||c[1]<=d[1]||c[3]>=d[3])}function ge(c,d){var g=(180+c[0])/360,w=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,P=Math.pow(2,d.z);return[Math.round(g*P*8192),Math.round(w*P*8192)]}function An(c,d,g){return d[1]>c[1]!=g[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]}function tr(c,d){for(var g,w,P,N,j,q,at,vt=!1,Ot=0,Dt=d.length;Ot<Dt;Ot++)for(var Yt=d[Ot],pe=0,Xe=Yt.length;pe<Xe-1;pe++){if((N=(g=c)[0]-(w=Yt[pe])[0])*(at=g[1]-(P=Yt[pe+1])[1])-(q=g[0]-P[0])*(j=g[1]-w[1])==0&&N*q<=0&&j*at<=0)return!1;An(c,Yt[pe],Yt[pe+1])&&(vt=!vt)}return vt}function Ei(c,d){for(var g=0;g<d.length;g++)if(tr(c,d[g]))return!0;return!1}function Si(c,d,g,w){var P=w[0]-g[0],N=w[1]-g[1],j=(c[0]-g[0])*N-P*(c[1]-g[1]),q=(d[0]-g[0])*N-P*(d[1]-g[1]);return j>0&&q<0||j<0&&q>0}function uo(c,d,g){for(var w=0,P=g;w<P.length;w+=1)for(var N=P[w],j=0;j<N.length-1;++j)if((Dt=[(Ot=N[j+1])[0]-(vt=N[j])[0],Ot[1]-vt[1]])[0]*(Yt=[(at=d)[0]-(q=c)[0],at[1]-q[1]])[1]-Dt[1]*Yt[0]!=0&&Si(q,at,vt,Ot)&&Si(vt,Ot,q,at))return!0;var q,at,vt,Ot,Dt,Yt;return!1}function Es(c,d){for(var g=0;g<c.length;++g)if(!tr(c[g],d))return!1;for(var w=0;w<c.length-1;++w)if(uo(c[w],c[w+1],d))return!1;return!0}function Ns(c,d){for(var g=0;g<d.length;g++)if(Es(c,d[g]))return!0;return!1}function As(c,d,g){for(var w=[],P=0;P<c.length;P++){for(var N=[],j=0;j<c[P].length;j++){var q=ge(c[P][j],g);Ms(d,q),N.push(q)}w.push(N)}return w}function rl(c,d,g){for(var w=[],P=0;P<c.length;P++){var N=As(c[P],d,g);w.push(N)}return w}function Xf(c,d,g,w){if(c[0]<g[0]||c[0]>g[2]){var P=.5*w,N=c[0]-g[0]>P?-w:g[0]-c[0]>P?w:0;N===0&&(N=c[0]-g[2]>P?-w:g[2]-c[0]>P?w:0),c[0]+=N}Ms(d,c)}function Ud(c,d,g,w){for(var P=8192*Math.pow(2,w.z),N=[8192*w.x,8192*w.y],j=[],q=0,at=c;q<at.length;q+=1)for(var vt=0,Ot=at[q];vt<Ot.length;vt+=1){var Dt=Ot[vt],Yt=[Dt.x+N[0],Dt.y+N[1]];Xf(Yt,d,g,P),j.push(Yt)}return j}function md(c,d,g,w){for(var P,N=8192*Math.pow(2,w.z),j=[8192*w.x,8192*w.y],q=[],at=0,vt=c;at<vt.length;at+=1){for(var Ot=[],Dt=0,Yt=vt[at];Dt<Yt.length;Dt+=1){var pe=Yt[Dt],Xe=[pe.x+j[0],pe.y+j[1]];Ms(d,Xe),Ot.push(Xe)}q.push(Ot)}if(d[2]-d[0]<=N/2){(P=d)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(var en=0,kn=q;en<kn.length;en+=1)for(var Sn=0,sr=kn[en];Sn<sr.length;Sn+=1)Xf(sr[Sn],d,g,N)}return q}ws.parse=function(c,d){if(c.length!==2)return d.error("Expected one argument.");var g=c[1];if(typeof g!="object"||Array.isArray(g))return d.error("Collator options argument must be an object.");var w=d.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,mi);if(!w)return null;var P=d.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,mi);if(!P)return null;var N=null;return g.locale&&!(N=d.parse(g.locale,1,pi))?null:new ws(w,P,N)},ws.prototype.evaluate=function(c){return new mn(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)},ws.prototype.eachChild=function(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)},ws.prototype.outputDefined=function(){return!1},ws.prototype.serialize=function(){var c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]};var Dl=function(c,d){this.type=mi,this.geojson=c,this.geometries=d};function Qc(c){if(c instanceof ca&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Dl)return!1;var d=!0;return c.eachChild(function(g){d&&!Qc(g)&&(d=!1)}),d}function Mf(c){if(c instanceof ca&&c.name==="feature-state")return!1;var d=!0;return c.eachChild(function(g){d&&!Mf(g)&&(d=!1)}),d}function Jc(c,d){if(c instanceof ca&&d.indexOf(c.name)>=0)return!1;var g=!0;return c.eachChild(function(w){g&&!Jc(w,d)&&(g=!1)}),g}Dl.parse=function(c,d){if(c.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(mo(c[1])){var g=c[1];if(g.type==="FeatureCollection")for(var w=0;w<g.features.length;++w){var P=g.features[w].geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Dl(g,g.features[w].geometry)}else if(g.type==="Feature"){var N=g.geometry.type;if(N==="Polygon"||N==="MultiPolygon")return new Dl(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Dl(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Dl.prototype.evaluate=function(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(d,g){var w=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(g.type==="Polygon"){var j=As(g.coordinates,P,N),q=Ud(d.geometry(),w,P,N);if(!re(w,P))return!1;for(var at=0,vt=q;at<vt.length;at+=1)if(!tr(vt[at],j))return!1}if(g.type==="MultiPolygon"){var Ot=rl(g.coordinates,P,N),Dt=Ud(d.geometry(),w,P,N);if(!re(w,P))return!1;for(var Yt=0,pe=Dt;Yt<pe.length;Yt+=1)if(!Ei(pe[Yt],Ot))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(d,g){var w=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(g.type==="Polygon"){var j=As(g.coordinates,P,N),q=md(d.geometry(),w,P,N);if(!re(w,P))return!1;for(var at=0,vt=q;at<vt.length;at+=1)if(!Es(vt[at],j))return!1}if(g.type==="MultiPolygon"){var Ot=rl(g.coordinates,P,N),Dt=md(d.geometry(),w,P,N);if(!re(w,P))return!1;for(var Yt=0,pe=Dt;Yt<pe.length;Yt+=1)if(!Ns(pe[Yt],Ot))return!1}return!0}(c,this.geometries)}return!1},Dl.prototype.eachChild=function(){},Dl.prototype.outputDefined=function(){return!0},Dl.prototype.serialize=function(){return["within",this.geojson]};var Ic=function(c,d){this.type=d.type,this.name=c,this.boundExpression=d};Ic.parse=function(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var g=c[1];return d.scope.has(g)?new Ic(g,d.scope.get(g)):d.error('Unknown variable "'+g+'". Make sure "'+g+'" has been bound in an enclosing "let" expression before using it.',1)},Ic.prototype.evaluate=function(c){return this.boundExpression.evaluate(c)},Ic.prototype.eachChild=function(){},Ic.prototype.outputDefined=function(){return!1},Ic.prototype.serialize=function(){return["var",this.name]};var tu=function(c,d,g,w,P){d===void 0&&(d=[]),w===void 0&&(w=new jr),P===void 0&&(P=[]),this.registry=c,this.path=d,this.key=d.map(function(N){return"["+N+"]"}).join(""),this.scope=w,this.errors=P,this.expectedType=g};function Yf(c,d){for(var g,w=c.length-1,P=0,N=w,j=0;P<=N;)if((g=c[j=Math.floor((P+N)/2)])<=d){if(j===w||d<c[j+1])return j;P=j+1}else{if(!(g>d))throw new Xr("Input is not a number.");N=j-1}return 0}tu.prototype.parse=function(c,d,g,w,P){return P===void 0&&(P={}),d?this.concat(d,g,w)._parse(c,P):this._parse(c,P)},tu.prototype._parse=function(c,d){function g(vt,Ot,Dt){return Dt==="assert"?new Ni(Ot,[vt]):Dt==="coerce"?new Xo(Ot,[vt]):vt}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var w=c[0];if(typeof w!="string")return this.error("Expression name must be a string, but found "+typeof w+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var P=this.registry[w];if(P){var N=P.parse(c,this);if(!N)return null;if(this.expectedType){var j=this.expectedType,q=N.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||q.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||q.kind!=="value"&&q.kind!=="string"){if(this.checkSubtype(j,q))return null}else N=g(N,j,d.typeAnnotation||"coerce");else N=g(N,j,d.typeAnnotation||"assert")}if(!(N instanceof Ui)&&N.type.kind!=="resolvedImage"&&function vt(Ot){if(Ot instanceof Ic)return vt(Ot.boundExpression);if(Ot instanceof ca&&Ot.name==="error"||Ot instanceof ws||Ot instanceof Dl)return!1;var Dt=Ot instanceof Xo||Ot instanceof Ni,Yt=!0;return Ot.eachChild(function(pe){Yt=Dt?Yt&&vt(pe):Yt&&pe instanceof Ui}),!!Yt&&Qc(Ot)&&Jc(Ot,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(N)){var at=new Ya;try{N=new Ui(N.type,N.evaluate(at))}catch(vt){return this.error(vt.message),null}}return N}return this.error('Unknown expression "'+w+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof c+" instead.")},tu.prototype.concat=function(c,d,g){var w=typeof c=="number"?this.path.concat(c):this.path,P=g?this.scope.concat(g):this.scope;return new tu(this.registry,w,d||null,P,this.errors)},tu.prototype.error=function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];var w=""+this.key+d.map(function(P){return"["+P+"]"}).join("");this.errors.push(new Ur(w,c))},tu.prototype.checkSubtype=function(c,d){var g=Se(c,d);return g&&this.error(g),g};var ac=function(c,d,g){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(var w=0,P=g;w<P.length;w+=1){var N=P[w],j=N[1];this.labels.push(N[0]),this.outputs.push(j)}};function Ws(c,d,g){return c*(1-g)+d*g}ac.parse=function(c,d){if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");var g=d.parse(c[1],1,Ar);if(!g)return null;var w=[],P=null;d.expectedType&&d.expectedType.kind!=="value"&&(P=d.expectedType);for(var N=1;N<c.length;N+=2){var j=N===1?-1/0:c[N],q=c[N+1],at=N,vt=N+1;if(typeof j!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',at);if(w.length&&w[w.length-1][0]>=j)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',at);var Ot=d.parse(q,vt,P);if(!Ot)return null;P=P||Ot.type,w.push([j,Ot])}return new ac(P,g,w)},ac.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var w=this.input.evaluate(c);if(w<=d[0])return g[0].evaluate(c);var P=d.length;return w>=d[P-1]?g[P-1].evaluate(c):g[Yf(d,w)].evaluate(c)},ac.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},ac.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},ac.prototype.serialize=function(){for(var c=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&c.push(this.labels[d]),c.push(this.outputs[d].serialize());return c};var Ru=Object.freeze({__proto__:null,number:Ws,color:function(c,d,g){return new tn(Ws(c.r,d.r,g),Ws(c.g,d.g,g),Ws(c.b,d.b,g),Ws(c.a,d.a,g))},array:function(c,d,g){return c.map(function(w,P){return Ws(w,d[P],g)})}}),gf=6/29*3*(6/29),Fh=Math.PI/180,Uh=180/Math.PI;function eu(c){return c>.008856451679035631?Math.pow(c,1/3):c/gf+4/29}function mh(c){return c>6/29?c*c*c:gf*(c-4/29)}function zh(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function vd(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function gd(c){var d=vd(c.r),g=vd(c.g),w=vd(c.b),P=eu((.4124564*d+.3575761*g+.1804375*w)/.95047),N=eu((.2126729*d+.7151522*g+.072175*w)/1);return{l:116*N-16,a:500*(P-N),b:200*(N-eu((.0193339*d+.119192*g+.9503041*w)/1.08883)),alpha:c.a}}function yd(c){var d=(c.l+16)/116,g=isNaN(c.a)?d:d+c.a/500,w=isNaN(c.b)?d:d-c.b/200;return d=1*mh(d),g=.95047*mh(g),w=1.08883*mh(w),new tn(zh(3.2404542*g-1.5371385*d-.4985314*w),zh(-.969266*g+1.8760108*d+.041556*w),zh(.0556434*g-.2040259*d+1.0572252*w),c.alpha)}function vp(c,d,g){var w=d-c;return c+g*(w>180||w<-180?w-360*Math.round(w/360):w)}var qf={forward:gd,reverse:yd,interpolate:function(c,d,g){return{l:Ws(c.l,d.l,g),a:Ws(c.a,d.a,g),b:Ws(c.b,d.b,g),alpha:Ws(c.alpha,d.alpha,g)}}},Mu={forward:function(c){var d=gd(c),g=d.l,w=d.a,P=d.b,N=Math.atan2(P,w)*Uh;return{h:N<0?N+360:N,c:Math.sqrt(w*w+P*P),l:g,alpha:c.a}},reverse:function(c){var d=c.h*Fh,g=c.c;return yd({l:c.l,a:Math.cos(d)*g,b:Math.sin(d)*g,alpha:c.alpha})},interpolate:function(c,d,g){return{h:vp(c.h,d.h,g),c:Ws(c.c,d.c,g),l:Ws(c.l,d.l,g),alpha:Ws(c.alpha,d.alpha,g)}}},_d=Object.freeze({__proto__:null,lab:qf,hcl:Mu}),Nl=function(c,d,g,w,P){this.type=c,this.operator=d,this.interpolation=g,this.input=w,this.labels=[],this.outputs=[];for(var N=0,j=P;N<j.length;N+=1){var q=j[N],at=q[1];this.labels.push(q[0]),this.outputs.push(at)}};function Ps(c,d,g,w){var P=w-g,N=c-g;return P===0?0:d===1?N/P:(Math.pow(d,N)-1)/(Math.pow(d,P)-1)}Nl.interpolationFactor=function(c,d,g,w){var P=0;if(c.name==="exponential")P=Ps(d,c.base,g,w);else if(c.name==="linear")P=Ps(d,1,g,w);else if(c.name==="cubic-bezier"){var N=c.controlPoints;P=new yt(N[0],N[1],N[2],N[3]).solve(Ps(d,1,g,w))}return P},Nl.parse=function(c,d){var g=c[0],w=c[1],P=c[2],N=c.slice(3);if(!Array.isArray(w)||w.length===0)return d.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){var j=w[1];if(typeof j!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:j}}else{if(w[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(w[0]),1,0);var q=w.slice(1);if(q.length!==4||q.some(function(kn){return typeof kn!="number"||kn<0||kn>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:q}}if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(P=d.parse(P,2,Ar)))return null;var at=[],vt=null;g==="interpolate-hcl"||g==="interpolate-lab"?vt=xi:d.expectedType&&d.expectedType.kind!=="value"&&(vt=d.expectedType);for(var Ot=0;Ot<N.length;Ot+=2){var Dt=N[Ot],Yt=N[Ot+1],pe=Ot+3,Xe=Ot+4;if(typeof Dt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(at.length&&at[at.length-1][0]>=Dt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);var en=d.parse(Yt,Xe,vt);if(!en)return null;vt=vt||en.type,at.push([Dt,en])}return vt.kind==="number"||vt.kind==="color"||vt.kind==="array"&&vt.itemType.kind==="number"&&typeof vt.N=="number"?new Nl(vt,g,w,P,at):d.error("Type "+Mt(vt)+" is not interpolatable.")},Nl.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var w=this.input.evaluate(c);if(w<=d[0])return g[0].evaluate(c);var P=d.length;if(w>=d[P-1])return g[P-1].evaluate(c);var N=Yf(d,w),j=Nl.interpolationFactor(this.interpolation,w,d[N],d[N+1]),q=g[N].evaluate(c),at=g[N+1].evaluate(c);return this.operator==="interpolate"?Ru[this.type.kind.toLowerCase()](q,at,j):this.operator==="interpolate-hcl"?Mu.reverse(Mu.interpolate(Mu.forward(q),Mu.forward(at),j)):qf.reverse(qf.interpolate(qf.forward(q),qf.forward(at),j))},Nl.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},Nl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},Nl.prototype.serialize=function(){var c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,c,this.input.serialize()],g=0;g<this.labels.length;g++)d.push(this.labels[g],this.outputs[g].serialize());return d};var nu=function(c,d){this.type=c,this.args=d};nu.parse=function(c,d){if(c.length<2)return d.error("Expectected at least one argument.");var g=null,w=d.expectedType;w&&w.kind!=="value"&&(g=w);for(var P=[],N=0,j=c.slice(1);N<j.length;N+=1){var q=d.parse(j[N],1+P.length,g,void 0,{typeAnnotation:"omit"});if(!q)return null;g=g||q.type,P.push(q)}var at=w&&P.some(function(vt){return Se(w,vt.type)});return new nu(at?Li:g,P)},nu.prototype.evaluate=function(c){for(var d,g=null,w=0,P=0,N=this.args;P<N.length&&(w++,(g=N[P].evaluate(c))&&g instanceof ai&&!g.available&&(d||(d=g.name),g=null,w===this.args.length&&(g=d)),g===null);P+=1);return g},nu.prototype.eachChild=function(c){this.args.forEach(c)},nu.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},nu.prototype.serialize=function(){var c=["coalesce"];return this.eachChild(function(d){c.push(d.serialize())}),c};var sc=function(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d};sc.prototype.evaluate=function(c){return this.result.evaluate(c)},sc.prototype.eachChild=function(c){for(var d=0,g=this.bindings;d<g.length;d+=1)c(g[d][1]);c(this.result)},sc.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found "+(c.length-1)+" instead.");for(var g=[],w=1;w<c.length-1;w+=2){var P=c[w];if(typeof P!="string")return d.error("Expected string, but found "+typeof P+" instead.",w);if(/[^a-zA-Z0-9_]/.test(P))return d.error("Variable names must contain only alphanumeric characters or '_'.",w);var N=d.parse(c[w+1],w+1);if(!N)return null;g.push([P,N])}var j=d.parse(c[c.length-1],c.length-1,d.expectedType,g);return j?new sc(g,j):null},sc.prototype.outputDefined=function(){return this.result.outputDefined()},sc.prototype.serialize=function(){for(var c=["let"],d=0,g=this.bindings;d<g.length;d+=1){var w=g[d];c.push(w[0],w[1].serialize())}return c.push(this.result.serialize()),c};var of=function(c,d,g){this.type=c,this.index=d,this.input=g};of.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Ar),w=d.parse(c[2],2,$o(d.expectedType||Li));return g&&w?new of(w.type.itemType,g,w):null},of.prototype.evaluate=function(c){var d=this.index.evaluate(c),g=this.input.evaluate(c);if(d<0)throw new Xr("Array index out of bounds: "+d+" < 0.");if(d>=g.length)throw new Xr("Array index out of bounds: "+d+" > "+(g.length-1)+".");if(d!==Math.floor(d))throw new Xr("Array index must be an integer, but found "+d+" instead.");return g[d]},of.prototype.eachChild=function(c){c(this.index),c(this.input)},of.prototype.outputDefined=function(){return!1},of.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var lc=function(c,d){this.type=mi,this.needle=c,this.haystack=d};lc.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Li),w=d.parse(c[2],2,Li);return g&&w?qe(g.type,[mi,pi,Ar,ni,Li])?new lc(g,w):d.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(g.type)+" instead"):null},lc.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!Rn(d,["boolean","string","number","null"]))throw new Xr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(si(d))+" instead.");if(!Rn(g,["string","array"]))throw new Xr("Expected second argument to be of type array or string, but found "+Mt(si(g))+" instead.");return g.indexOf(d)>=0},lc.prototype.eachChild=function(c){c(this.needle),c(this.haystack)},lc.prototype.outputDefined=function(){return!0},lc.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var af=function(c,d,g){this.type=Ar,this.needle=c,this.haystack=d,this.fromIndex=g};af.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Li),w=d.parse(c[2],2,Li);if(!g||!w)return null;if(!qe(g.type,[mi,pi,Ar,ni,Li]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+Mt(g.type)+" instead");if(c.length===4){var P=d.parse(c[3],3,Ar);return P?new af(g,w,P):null}return new af(g,w)},af.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!Rn(d,["boolean","string","number","null"]))throw new Xr("Expected first argument to be of type boolean, string, number or null, but found "+Mt(si(d))+" instead.");if(!Rn(g,["string","array"]))throw new Xr("Expected second argument to be of type array or string, but found "+Mt(si(g))+" instead.");if(this.fromIndex){var w=this.fromIndex.evaluate(c);return g.indexOf(d,w)}return g.indexOf(d)},af.prototype.eachChild=function(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)},af.prototype.outputDefined=function(){return!1},af.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var kl=function(c,d,g,w,P,N){this.inputType=c,this.type=d,this.input=g,this.cases=w,this.outputs=P,this.otherwise=N};kl.parse=function(c,d){if(c.length<5)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if(c.length%2!=1)return d.error("Expected an even number of arguments.");var g,w;d.expectedType&&d.expectedType.kind!=="value"&&(w=d.expectedType);for(var P={},N=[],j=2;j<c.length-1;j+=2){var q=c[j],at=c[j+1];Array.isArray(q)||(q=[q]);var vt=d.concat(j);if(q.length===0)return vt.error("Expected at least one branch label.");for(var Ot=0,Dt=q;Ot<Dt.length;Ot+=1){var Yt=Dt[Ot];if(typeof Yt!="number"&&typeof Yt!="string")return vt.error("Branch labels must be numbers or strings.");if(typeof Yt=="number"&&Math.abs(Yt)>Number.MAX_SAFE_INTEGER)return vt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Yt=="number"&&Math.floor(Yt)!==Yt)return vt.error("Numeric branch labels must be integer values.");if(g){if(vt.checkSubtype(g,si(Yt)))return null}else g=si(Yt);if(P[String(Yt)]!==void 0)return vt.error("Branch labels must be unique.");P[String(Yt)]=N.length}var pe=d.parse(at,j,w);if(!pe)return null;w=w||pe.type,N.push(pe)}var Xe=d.parse(c[1],1,Li);if(!Xe)return null;var en=d.parse(c[c.length-1],c.length-1,w);return en?Xe.type.kind!=="value"&&d.concat(1).checkSubtype(g,Xe.type)?null:new kl(g,w,Xe,P,N,en):null},kl.prototype.evaluate=function(c){var d=this.input.evaluate(c);return(si(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)},kl.prototype.eachChild=function(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)},kl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})&&this.otherwise.outputDefined()},kl.prototype.serialize=function(){for(var c=this,d=["match",this.input.serialize()],g=[],w={},P=0,N=Object.keys(this.cases).sort();P<N.length;P+=1){var j=N[P];(Dt=w[this.cases[j]])===void 0?(w[this.cases[j]]=g.length,g.push([this.cases[j],[j]])):g[Dt][1].push(j)}for(var q=function(pe){return c.inputType.kind==="number"?Number(pe):pe},at=0,vt=g;at<vt.length;at+=1){var Ot=vt[at],Dt=Ot[0],Yt=Ot[1];d.push(Yt.length===1?q(Yt[0]):Yt.map(q)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var Pu=function(c,d,g){this.type=c,this.branches=d,this.otherwise=g};Pu.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found only "+(c.length-1)+".");if(c.length%2!=0)return d.error("Expected an odd number of arguments.");var g;d.expectedType&&d.expectedType.kind!=="value"&&(g=d.expectedType);for(var w=[],P=1;P<c.length-1;P+=2){var N=d.parse(c[P],P,mi);if(!N)return null;var j=d.parse(c[P+1],P+1,g);if(!j)return null;w.push([N,j]),g=g||j.type}var q=d.parse(c[c.length-1],c.length-1,g);return q?new Pu(g,w,q):null},Pu.prototype.evaluate=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var w=g[d],P=w[1];if(w[0].evaluate(c))return P.evaluate(c)}return this.otherwise.evaluate(c)},Pu.prototype.eachChild=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var w=g[d],P=w[1];c(w[0]),c(P)}c(this.otherwise)},Pu.prototype.outputDefined=function(){return this.branches.every(function(c){return c[1].outputDefined()})&&this.otherwise.outputDefined()},Pu.prototype.serialize=function(){var c=["case"];return this.eachChild(function(d){c.push(d.serialize())}),c};var yf=function(c,d,g,w){this.type=c,this.input=d,this.beginIndex=g,this.endIndex=w};function vh(c,d){return c==="=="||c==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function $f(c,d,g,w){return w.compare(d,g)===0}function us(c,d,g){var w=c!=="=="&&c!=="!=";return function(){function P(N,j,q){this.type=mi,this.lhs=N,this.rhs=j,this.collator=q,this.hasUntypedArgument=N.type.kind==="value"||j.type.kind==="value"}return P.parse=function(N,j){if(N.length!==3&&N.length!==4)return j.error("Expected two or three arguments.");var q=N[0],at=j.parse(N[1],1,Li);if(!at)return null;if(!vh(q,at.type))return j.concat(1).error('"'+q+`" comparisons are not supported for type '`+Mt(at.type)+"'.");var vt=j.parse(N[2],2,Li);if(!vt)return null;if(!vh(q,vt.type))return j.concat(2).error('"'+q+`" comparisons are not supported for type '`+Mt(vt.type)+"'.");if(at.type.kind!==vt.type.kind&&at.type.kind!=="value"&&vt.type.kind!=="value")return j.error("Cannot compare types '"+Mt(at.type)+"' and '"+Mt(vt.type)+"'.");w&&(at.type.kind==="value"&&vt.type.kind!=="value"?at=new Ni(vt.type,[at]):at.type.kind!=="value"&&vt.type.kind==="value"&&(vt=new Ni(at.type,[vt])));var Ot=null;if(N.length===4){if(at.type.kind!=="string"&&vt.type.kind!=="string"&&at.type.kind!=="value"&&vt.type.kind!=="value")return j.error("Cannot use collator to compare non-string types.");if(!(Ot=j.parse(N[3],3,aa)))return null}return new P(at,vt,Ot)},P.prototype.evaluate=function(N){var j=this.lhs.evaluate(N),q=this.rhs.evaluate(N);if(w&&this.hasUntypedArgument){var at=si(j),vt=si(q);if(at.kind!==vt.kind||at.kind!=="string"&&at.kind!=="number")throw new Xr('Expected arguments for "'+c+'" to be (string, string) or (number, number), but found ('+at.kind+", "+vt.kind+") instead.")}if(this.collator&&!w&&this.hasUntypedArgument){var Ot=si(j),Dt=si(q);if(Ot.kind!=="string"||Dt.kind!=="string")return d(N,j,q)}return this.collator?g(N,j,q,this.collator.evaluate(N)):d(N,j,q)},P.prototype.eachChild=function(N){N(this.lhs),N(this.rhs),this.collator&&N(this.collator)},P.prototype.outputDefined=function(){return!0},P.prototype.serialize=function(){var N=[c];return this.eachChild(function(j){N.push(j.serialize())}),N},P}()}yf.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Li),w=d.parse(c[2],2,Ar);if(!g||!w)return null;if(!qe(g.type,[$o(Li),pi,Li]))return d.error("Expected first argument to be of type array or string, but found "+Mt(g.type)+" instead");if(c.length===4){var P=d.parse(c[3],3,Ar);return P?new yf(g.type,g,w,P):null}return new yf(g.type,g,w)},yf.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=this.beginIndex.evaluate(c);if(!Rn(d,["string","array"]))throw new Xr("Expected first argument to be of type array or string, but found "+Mt(si(d))+" instead.");if(this.endIndex){var w=this.endIndex.evaluate(c);return d.slice(g,w)}return d.slice(g)},yf.prototype.eachChild=function(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)},yf.prototype.outputDefined=function(){return!1},yf.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jh=us("==",function(c,d,g){return d===g},$f),Vh=us("!=",function(c,d,g){return d!==g},function(c,d,g,w){return!$f(0,d,g,w)}),gh=us("<",function(c,d,g){return d<g},function(c,d,g,w){return w.compare(d,g)<0}),il=us(">",function(c,d,g){return d>g},function(c,d,g,w){return w.compare(d,g)>0}),Kf=us("<=",function(c,d,g){return d<=g},function(c,d,g,w){return w.compare(d,g)<=0}),Qf=us(">=",function(c,d,g){return d>=g},function(c,d,g,w){return w.compare(d,g)>=0}),K=function(c,d,g,w,P){this.type=pi,this.number=c,this.locale=d,this.currency=g,this.minFractionDigits=w,this.maxFractionDigits=P};K.parse=function(c,d){if(c.length!==3)return d.error("Expected two arguments.");var g=d.parse(c[1],1,Ar);if(!g)return null;var w=c[2];if(typeof w!="object"||Array.isArray(w))return d.error("NumberFormat options argument must be an object.");var P=null;if(w.locale&&!(P=d.parse(w.locale,1,pi)))return null;var N=null;if(w.currency&&!(N=d.parse(w.currency,1,pi)))return null;var j=null;if(w["min-fraction-digits"]&&!(j=d.parse(w["min-fraction-digits"],1,Ar)))return null;var q=null;return w["max-fraction-digits"]&&!(q=d.parse(w["max-fraction-digits"],1,Ar))?null:new K(g,P,N,j,q)},K.prototype.evaluate=function(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))},K.prototype.eachChild=function(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)},K.prototype.outputDefined=function(){return!1},K.prototype.serialize=function(){var c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]};var lt=function(c){this.type=Ar,this.input=c};lt.parse=function(c,d){if(c.length!==2)return d.error("Expected 1 argument, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+Mt(g.type)+" instead."):new lt(g):null},lt.prototype.evaluate=function(c){var d=this.input.evaluate(c);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Xr("Expected value to be of type string or array, but found "+Mt(si(d))+" instead.")},lt.prototype.eachChild=function(c){c(this.input)},lt.prototype.outputDefined=function(){return!1},lt.prototype.serialize=function(){var c=["length"];return this.eachChild(function(d){c.push(d.serialize())}),c};var It={"==":jh,"!=":Vh,">":il,"<":gh,">=":Qf,"<=":Kf,array:Ni,at:of,boolean:Ni,case:Pu,coalesce:nu,collator:ws,format:Eo,image:Xi,in:lc,"index-of":af,interpolate:Nl,"interpolate-hcl":Nl,"interpolate-lab":Nl,length:lt,let:sc,literal:Ui,match:kl,number:Ni,"number-format":K,object:Ni,slice:yf,step:ac,string:Ni,"to-boolean":Xo,"to-color":Xo,"to-number":Xo,"to-string":Xo,var:Ic,within:Dl};function Ke(c,d){var g=d[0],w=d[1],P=d[2],N=d[3];g=g.evaluate(c),w=w.evaluate(c),P=P.evaluate(c);var j=N?N.evaluate(c):1,q=Vi(g,w,P,j);if(q)throw new Xr(q);return new tn(g/255*j,w/255*j,P/255*j,j)}function X(c,d){return c in d}function Xn(c,d){var g=d[c];return g===void 0?null:g}function Mr(c){return{type:c}}function ki(c){return{result:"success",value:c}}function Jr(c){return{result:"error",value:c}}function co(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function so(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function sa(c){return!!c.expression&&c.expression.interpolated}function Po(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function _a(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function qa(c){return c}function ra(c,d,g){return c!==void 0?c:d!==void 0?d:g!==void 0?g:void 0}function ma(c,d,g,w,P){return ra(typeof g===P?w[g]:void 0,c.default,d.default)}function ls(c,d,g){if(Po(g)!=="number")return ra(c.default,d.default);var w=c.stops.length;if(w===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[w-1][0])return c.stops[w-1][1];var P=Yf(c.stops.map(function(N){return N[0]}),g);return c.stops[P][1]}function Aa(c,d,g){var w=c.base!==void 0?c.base:1;if(Po(g)!=="number")return ra(c.default,d.default);var P=c.stops.length;if(P===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[P-1][0])return c.stops[P-1][1];var N=Yf(c.stops.map(function(Dt){return Dt[0]}),g),j=function(Dt,Yt,pe,Xe){var en=Xe-pe,kn=Dt-pe;return en===0?0:Yt===1?kn/en:(Math.pow(Yt,kn)-1)/(Math.pow(Yt,en)-1)}(g,w,c.stops[N][0],c.stops[N+1][0]),q=c.stops[N][1],at=c.stops[N+1][1],vt=Ru[d.type]||qa;if(c.colorSpace&&c.colorSpace!=="rgb"){var Ot=_d[c.colorSpace];vt=function(Dt,Yt){return Ot.reverse(Ot.interpolate(Ot.forward(Dt),Ot.forward(Yt),j))}}return typeof q.evaluate=="function"?{evaluate:function(){for(var Dt=[],Yt=arguments.length;Yt--;)Dt[Yt]=arguments[Yt];var pe=q.evaluate.apply(void 0,Dt),Xe=at.evaluate.apply(void 0,Dt);if(pe!==void 0&&Xe!==void 0)return vt(pe,Xe,j)}}:vt(q,at,j)}function Ia(c,d,g){return d.type==="color"?g=tn.parse(g):d.type==="formatted"?g=fr.fromString(g.toString()):d.type==="resolvedImage"?g=ai.fromString(g.toString()):Po(g)===d.type||d.type==="enum"&&d.values[g]||(g=void 0),ra(g,c.default,d.default)}ca.register(It,{error:[{kind:"error"},[pi],function(c,d){throw new Xr(d[0].evaluate(c))}],typeof:[pi,[Li],function(c,d){return Mt(si(d[0].evaluate(c)))}],"to-rgba":[$o(Ar,4),[xi],function(c,d){return d[0].evaluate(c).toArray()}],rgb:[xi,[Ar,Ar,Ar],Ke],rgba:[xi,[Ar,Ar,Ar,Ar],Ke],has:{type:mi,overloads:[[[pi],function(c,d){return X(d[0].evaluate(c),c.properties())}],[[pi,wo],function(c,d){var g=d[1];return X(d[0].evaluate(c),g.evaluate(c))}]]},get:{type:Li,overloads:[[[pi],function(c,d){return Xn(d[0].evaluate(c),c.properties())}],[[pi,wo],function(c,d){var g=d[1];return Xn(d[0].evaluate(c),g.evaluate(c))}]]},"feature-state":[Li,[pi],function(c,d){return Xn(d[0].evaluate(c),c.featureState||{})}],properties:[wo,[],function(c){return c.properties()}],"geometry-type":[pi,[],function(c){return c.geometryType()}],id:[Li,[],function(c){return c.id()}],zoom:[Ar,[],function(c){return c.globals.zoom}],"heatmap-density":[Ar,[],function(c){return c.globals.heatmapDensity||0}],"line-progress":[Ar,[],function(c){return c.globals.lineProgress||0}],accumulated:[Li,[],function(c){return c.globals.accumulated===void 0?null:c.globals.accumulated}],"+":[Ar,Mr(Ar),function(c,d){for(var g=0,w=0,P=d;w<P.length;w+=1)g+=P[w].evaluate(c);return g}],"*":[Ar,Mr(Ar),function(c,d){for(var g=1,w=0,P=d;w<P.length;w+=1)g*=P[w].evaluate(c);return g}],"-":{type:Ar,overloads:[[[Ar,Ar],function(c,d){var g=d[1];return d[0].evaluate(c)-g.evaluate(c)}],[[Ar],function(c,d){return-d[0].evaluate(c)}]]},"/":[Ar,[Ar,Ar],function(c,d){var g=d[1];return d[0].evaluate(c)/g.evaluate(c)}],"%":[Ar,[Ar,Ar],function(c,d){var g=d[1];return d[0].evaluate(c)%g.evaluate(c)}],ln2:[Ar,[],function(){return Math.LN2}],pi:[Ar,[],function(){return Math.PI}],e:[Ar,[],function(){return Math.E}],"^":[Ar,[Ar,Ar],function(c,d){var g=d[1];return Math.pow(d[0].evaluate(c),g.evaluate(c))}],sqrt:[Ar,[Ar],function(c,d){return Math.sqrt(d[0].evaluate(c))}],log10:[Ar,[Ar],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN10}],ln:[Ar,[Ar],function(c,d){return Math.log(d[0].evaluate(c))}],log2:[Ar,[Ar],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN2}],sin:[Ar,[Ar],function(c,d){return Math.sin(d[0].evaluate(c))}],cos:[Ar,[Ar],function(c,d){return Math.cos(d[0].evaluate(c))}],tan:[Ar,[Ar],function(c,d){return Math.tan(d[0].evaluate(c))}],asin:[Ar,[Ar],function(c,d){return Math.asin(d[0].evaluate(c))}],acos:[Ar,[Ar],function(c,d){return Math.acos(d[0].evaluate(c))}],atan:[Ar,[Ar],function(c,d){return Math.atan(d[0].evaluate(c))}],min:[Ar,Mr(Ar),function(c,d){return Math.min.apply(Math,d.map(function(g){return g.evaluate(c)}))}],max:[Ar,Mr(Ar),function(c,d){return Math.max.apply(Math,d.map(function(g){return g.evaluate(c)}))}],abs:[Ar,[Ar],function(c,d){return Math.abs(d[0].evaluate(c))}],round:[Ar,[Ar],function(c,d){var g=d[0].evaluate(c);return g<0?-Math.round(-g):Math.round(g)}],floor:[Ar,[Ar],function(c,d){return Math.floor(d[0].evaluate(c))}],ceil:[Ar,[Ar],function(c,d){return Math.ceil(d[0].evaluate(c))}],"filter-==":[mi,[pi,Li],function(c,d){var g=d[0],w=d[1];return c.properties()[g.value]===w.value}],"filter-id-==":[mi,[Li],function(c,d){var g=d[0];return c.id()===g.value}],"filter-type-==":[mi,[pi],function(c,d){var g=d[0];return c.geometryType()===g.value}],"filter-<":[mi,[pi,Li],function(c,d){var g=d[0],w=d[1],P=c.properties()[g.value],N=w.value;return typeof P==typeof N&&P<N}],"filter-id-<":[mi,[Li],function(c,d){var g=d[0],w=c.id(),P=g.value;return typeof w==typeof P&&w<P}],"filter->":[mi,[pi,Li],function(c,d){var g=d[0],w=d[1],P=c.properties()[g.value],N=w.value;return typeof P==typeof N&&P>N}],"filter-id->":[mi,[Li],function(c,d){var g=d[0],w=c.id(),P=g.value;return typeof w==typeof P&&w>P}],"filter-<=":[mi,[pi,Li],function(c,d){var g=d[0],w=d[1],P=c.properties()[g.value],N=w.value;return typeof P==typeof N&&P<=N}],"filter-id-<=":[mi,[Li],function(c,d){var g=d[0],w=c.id(),P=g.value;return typeof w==typeof P&&w<=P}],"filter->=":[mi,[pi,Li],function(c,d){var g=d[0],w=d[1],P=c.properties()[g.value],N=w.value;return typeof P==typeof N&&P>=N}],"filter-id->=":[mi,[Li],function(c,d){var g=d[0],w=c.id(),P=g.value;return typeof w==typeof P&&w>=P}],"filter-has":[mi,[Li],function(c,d){return d[0].value in c.properties()}],"filter-has-id":[mi,[],function(c){return c.id()!==null&&c.id()!==void 0}],"filter-type-in":[mi,[$o(pi)],function(c,d){return d[0].value.indexOf(c.geometryType())>=0}],"filter-id-in":[mi,[$o(Li)],function(c,d){return d[0].value.indexOf(c.id())>=0}],"filter-in-small":[mi,[pi,$o(Li)],function(c,d){var g=d[0];return d[1].value.indexOf(c.properties()[g.value])>=0}],"filter-in-large":[mi,[pi,$o(Li)],function(c,d){var g=d[0],w=d[1];return function(P,N,j,q){for(;j<=q;){var at=j+q>>1;if(N[at]===P)return!0;N[at]>P?q=at-1:j=at+1}return!1}(c.properties()[g.value],w.value,0,w.value.length-1)}],all:{type:mi,overloads:[[[mi,mi],function(c,d){var g=d[1];return d[0].evaluate(c)&&g.evaluate(c)}],[Mr(mi),function(c,d){for(var g=0,w=d;g<w.length;g+=1)if(!w[g].evaluate(c))return!1;return!0}]]},any:{type:mi,overloads:[[[mi,mi],function(c,d){var g=d[1];return d[0].evaluate(c)||g.evaluate(c)}],[Mr(mi),function(c,d){for(var g=0,w=d;g<w.length;g+=1)if(w[g].evaluate(c))return!0;return!1}]]},"!":[mi,[mi],function(c,d){return!d[0].evaluate(c)}],"is-supported-script":[mi,[pi],function(c,d){var g=c.globals&&c.globals.isSupportedScript;return!g||g(d[0].evaluate(c))}],upcase:[pi,[pi],function(c,d){return d[0].evaluate(c).toUpperCase()}],downcase:[pi,[pi],function(c,d){return d[0].evaluate(c).toLowerCase()}],concat:[pi,Mr(Li),function(c,d){return d.map(function(g){return Wi(g.evaluate(c))}).join("")}],"resolved-locale":[pi,[aa],function(c,d){return d[0].evaluate(c).resolvedLocale()}]});var ka=function(c,d){this.expression=c,this._warningHistory={},this._evaluator=new Ya,this._defaultValue=d?function(g){return g.type==="color"&&_a(g.default)?new tn(0,0,0,0):g.type==="color"?tn.parse(g.default)||null:g.default===void 0?null:g.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function qs(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in It}function ks(c,d){var g=new tu(It,[],d?function(P){var N={color:xi,string:pi,number:Ar,enum:pi,boolean:mi,formatted:Pa,resolvedImage:Lo};return P.type==="array"?$o(N[P.value]||Li,P.length):N[P.type]}(d):void 0),w=g.parse(c,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?ki(new ka(w,d)):Jr(g.errors)}ka.prototype.evaluateWithoutErrorHandling=function(c,d,g,w,P,N){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=w,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)},ka.prototype.evaluate=function(c,d,g,w,P,N){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=w,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=N||null;try{var j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Xr("Expected value to be one of "+Object.keys(this._enumValues).map(function(q){return JSON.stringify(q)}).join(", ")+", but found "+JSON.stringify(j)+" instead.");return j}catch(q){return this._warningHistory[q.message]||(this._warningHistory[q.message]=!0,typeof console!="undefined"&&console.warn(q.message)),this._defaultValue}};var Ec=function(c,d){this.kind=c,this._styleExpression=d,this.isStateDependent=c!=="constant"&&!Mf(d.expression)};Ec.prototype.evaluateWithoutErrorHandling=function(c,d,g,w,P,N){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,w,P,N)},Ec.prototype.evaluate=function(c,d,g,w,P,N){return this._styleExpression.evaluate(c,d,g,w,P,N)};var es=function(c,d,g,w){this.kind=c,this.zoomStops=g,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!Mf(d.expression),this.interpolationType=w};function Iu(c,d){if((c=ks(c,d)).result==="error")return c;var g=c.value.expression,w=Qc(g);if(!w&&!co(d))return Jr([new Ur("","data expressions not supported")]);var P=Jc(g,["zoom"]);if(!P&&!so(d))return Jr([new Ur("","zoom expressions not supported")]);var N=function j(q){var at=null;if(q instanceof sc)at=j(q.result);else if(q instanceof nu)for(var vt=0,Ot=q.args;vt<Ot.length&&!(at=j(Ot[vt]));vt+=1);else(q instanceof ac||q instanceof Nl)&&q.input instanceof ca&&q.input.name==="zoom"&&(at=q);return at instanceof Ur||q.eachChild(function(Dt){var Yt=j(Dt);Yt instanceof Ur?at=Yt:!at&&Yt?at=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):at&&Yt&&at!==Yt&&(at=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),at}(g);return N||P?N instanceof Ur?Jr([N]):N instanceof Nl&&!sa(d)?Jr([new Ur("",'"interpolate" expressions cannot be used with this property')]):ki(N?new es(w?"camera":"composite",c.value,N.labels,N instanceof Nl?N.interpolation:void 0):new Ec(w?"constant":"source",c.value)):Jr([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}es.prototype.evaluateWithoutErrorHandling=function(c,d,g,w,P,N){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,w,P,N)},es.prototype.evaluate=function(c,d,g,w,P,N){return this._styleExpression.evaluate(c,d,g,w,P,N)},es.prototype.interpolationFactor=function(c,d,g){return this.interpolationType?Nl.interpolationFactor(this.interpolationType,c,d,g):0};var du=function(c,d){this._parameters=c,this._specification=d,Tr(this,function g(w,P){var N,j,q,at=P.type==="color",vt=w.stops&&typeof w.stops[0][0]=="object",Ot=vt||!(vt||w.property!==void 0),Dt=w.type||(sa(P)?"exponential":"interval");if(at&&((w=Tr({},w)).stops&&(w.stops=w.stops.map(function(ao){return[ao[0],tn.parse(ao[1])]})),w.default=tn.parse(w.default?w.default:P.default)),w.colorSpace&&w.colorSpace!=="rgb"&&!_d[w.colorSpace])throw new Error("Unknown color space: "+w.colorSpace);if(Dt==="exponential")N=Aa;else if(Dt==="interval")N=ls;else if(Dt==="categorical"){N=ma,j=Object.create(null);for(var Yt=0,pe=w.stops;Yt<pe.length;Yt+=1){var Xe=pe[Yt];j[Xe[0]]=Xe[1]}q=typeof w.stops[0][0]}else{if(Dt!=="identity")throw new Error('Unknown function type "'+Dt+'"');N=Ia}if(vt){for(var en={},kn=[],Sn=0;Sn<w.stops.length;Sn++){var sr=w.stops[Sn],pr=sr[0].zoom;en[pr]===void 0&&(en[pr]={zoom:pr,type:w.type,property:w.property,default:w.default,stops:[]},kn.push(pr)),en[pr].stops.push([sr[0].value,sr[1]])}for(var xr=[],Ir=0,Wr=kn;Ir<Wr.length;Ir+=1){var Ci=Wr[Ir];xr.push([en[Ci].zoom,g(en[Ci],P)])}var Ai={name:"linear"};return{kind:"composite",interpolationType:Ai,interpolationFactor:Nl.interpolationFactor.bind(void 0,Ai),zoomStops:xr.map(function(ao){return ao[0]}),evaluate:function(ao,Ro){var Zi=ao.zoom;return Aa({stops:xr,base:w.base},P,Zi).evaluate(Zi,Ro)}}}if(Ot){var To=Dt==="exponential"?{name:"exponential",base:w.base!==void 0?w.base:1}:null;return{kind:"camera",interpolationType:To,interpolationFactor:Nl.interpolationFactor.bind(void 0,To),zoomStops:w.stops.map(function(ao){return ao[0]}),evaluate:function(ao){return N(w,P,ao.zoom,j,q)}}}return{kind:"source",evaluate:function(ao,Ro){var Zi=Ro&&Ro.properties?Ro.properties[w.property]:void 0;return Zi===void 0?ra(w.default,P.default):N(w,P,Zi,j,q)}}}(this._parameters,this._specification))};function Lc(c){var d=c.key,g=c.value,w=c.valueSpec||{},P=c.objectElementValidators||{},N=c.style,j=c.styleSpec,q=[],at=Po(g);if(at!=="object")return[new Fe(d,g,"object expected, "+at+" found")];for(var vt in g){var Ot=vt.split(".")[0],Dt=w[Ot]||w["*"],Yt=void 0;if(P[Ot])Yt=P[Ot];else if(w[Ot])Yt=mt;else if(P["*"])Yt=P["*"];else{if(!w["*"]){q.push(new Fe(d,g[vt],'unknown property "'+vt+'"'));continue}Yt=mt}q=q.concat(Yt({key:(d&&d+".")+vt,value:g[vt],valueSpec:Dt,style:N,styleSpec:j,object:g,objectKey:vt},g))}for(var pe in w)P[pe]||w[pe].required&&w[pe].default===void 0&&g[pe]===void 0&&q.push(new Fe(d,g,'missing required property "'+pe+'"'));return q}function Pf(c){var d=c.value,g=c.valueSpec,w=c.style,P=c.styleSpec,N=c.key,j=c.arrayElementValidator||mt;if(Po(d)!=="array")return[new Fe(N,d,"array expected, "+Po(d)+" found")];if(g.length&&d.length!==g.length)return[new Fe(N,d,"array length "+g.length+" expected, length "+d.length+" found")];if(g["min-length"]&&d.length<g["min-length"])return[new Fe(N,d,"array length at least "+g["min-length"]+" expected, length "+d.length+" found")];var q={type:g.value,values:g.values};P.$version<7&&(q.function=g.function),Po(g.value)==="object"&&(q=g.value);for(var at=[],vt=0;vt<d.length;vt++)at=at.concat(j({array:d,arrayIndex:vt,value:d[vt],valueSpec:q,style:w,styleSpec:P,key:N+"["+vt+"]"}));return at}function Zh(c){var d=c.key,g=c.value,w=c.valueSpec,P=Po(g);return P==="number"&&g!=g&&(P="NaN"),P!=="number"?[new Fe(d,g,"number expected, "+P+" found")]:"minimum"in w&&g<w.minimum?[new Fe(d,g,g+" is less than the minimum value "+w.minimum)]:"maximum"in w&&g>w.maximum?[new Fe(d,g,g+" is greater than the maximum value "+w.maximum)]:[]}function Hh(c){var d,g,w,P=c.valueSpec,N=Zr(c.value.type),j={},q=N!=="categorical"&&c.value.property===void 0,at=!q,vt=Po(c.value.stops)==="array"&&Po(c.value.stops[0])==="array"&&Po(c.value.stops[0][0])==="object",Ot=Lc({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(pe){if(N==="identity")return[new Fe(pe.key,pe.value,'identity function may not have a "stops" property')];var Xe=[],en=pe.value;return Xe=Xe.concat(Pf({key:pe.key,value:en,valueSpec:pe.valueSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:Dt})),Po(en)==="array"&&en.length===0&&Xe.push(new Fe(pe.key,en,"array must have at least one stop")),Xe},default:function(pe){return mt({key:pe.key,value:pe.value,valueSpec:P,style:pe.style,styleSpec:pe.styleSpec})}}});return N==="identity"&&q&&Ot.push(new Fe(c.key,c.value,'missing required property "property"')),N==="identity"||c.value.stops||Ot.push(new Fe(c.key,c.value,'missing required property "stops"')),N==="exponential"&&c.valueSpec.expression&&!sa(c.valueSpec)&&Ot.push(new Fe(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(at&&!co(c.valueSpec)?Ot.push(new Fe(c.key,c.value,"property functions not supported")):q&&!so(c.valueSpec)&&Ot.push(new Fe(c.key,c.value,"zoom functions not supported"))),N!=="categorical"&&!vt||c.value.property!==void 0||Ot.push(new Fe(c.key,c.value,'"property" property is required')),Ot;function Dt(pe){var Xe=[],en=pe.value,kn=pe.key;if(Po(en)!=="array")return[new Fe(kn,en,"array expected, "+Po(en)+" found")];if(en.length!==2)return[new Fe(kn,en,"array length 2 expected, length "+en.length+" found")];if(vt){if(Po(en[0])!=="object")return[new Fe(kn,en,"object expected, "+Po(en[0])+" found")];if(en[0].zoom===void 0)return[new Fe(kn,en,"object stop key must have zoom")];if(en[0].value===void 0)return[new Fe(kn,en,"object stop key must have value")];if(w&&w>Zr(en[0].zoom))return[new Fe(kn,en[0].zoom,"stop zoom values must appear in ascending order")];Zr(en[0].zoom)!==w&&(w=Zr(en[0].zoom),g=void 0,j={}),Xe=Xe.concat(Lc({key:kn+"[0]",value:en[0],valueSpec:{zoom:{}},style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:Zh,value:Yt}}))}else Xe=Xe.concat(Yt({key:kn+"[0]",value:en[0],valueSpec:{},style:pe.style,styleSpec:pe.styleSpec},en));return qs(vr(en[1]))?Xe.concat([new Fe(kn+"[1]",en[1],"expressions are not allowed in function stops.")]):Xe.concat(mt({key:kn+"[1]",value:en[1],valueSpec:P,style:pe.style,styleSpec:pe.styleSpec}))}function Yt(pe,Xe){var en=Po(pe.value),kn=Zr(pe.value),Sn=pe.value!==null?pe.value:Xe;if(d){if(en!==d)return[new Fe(pe.key,Sn,en+" stop domain type must match previous stop domain type "+d)]}else d=en;if(en!=="number"&&en!=="string"&&en!=="boolean")return[new Fe(pe.key,Sn,"stop domain value must be a number, string, or boolean")];if(en!=="number"&&N!=="categorical"){var sr="number expected, "+en+" found";return co(P)&&N===void 0&&(sr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(pe.key,Sn,sr)]}return N!=="categorical"||en!=="number"||isFinite(kn)&&Math.floor(kn)===kn?N!=="categorical"&&en==="number"&&g!==void 0&&kn<g?[new Fe(pe.key,Sn,"stop domain values must appear in ascending order")]:(g=kn,N==="categorical"&&kn in j?[new Fe(pe.key,Sn,"stop domain values must be unique")]:(j[kn]=!0,[])):[new Fe(pe.key,Sn,"integer expected, found "+kn)]}}function If(c){var d=(c.expressionContext==="property"?Iu:ks)(vr(c.value),c.valueSpec);if(d.result==="error")return d.value.map(function(w){return new Fe(""+c.key+w.key,c.value,w.message)});var g=d.value.expression||d.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!g.outputDefined())return[new Fe(c.key,c.value,'Invalid data expression for "'+c.propertyKey+'". Output values must be contained as literals within the expression.')];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Mf(g))return[new Fe(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Mf(g))return[new Fe(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Jc(g,["zoom","feature-state"]))return[new Fe(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Qc(g))return[new Fe(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lu(c){var d=c.key,g=c.value,w=c.valueSpec,P=[];return Array.isArray(w.values)?w.values.indexOf(Zr(g))===-1&&P.push(new Fe(d,g,"expected one of ["+w.values.join(", ")+"], "+JSON.stringify(g)+" found")):Object.keys(w.values).indexOf(Zr(g))===-1&&P.push(new Fe(d,g,"expected one of ["+Object.keys(w.values).join(", ")+"], "+JSON.stringify(g)+" found")),P}function Lf(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(var d=0,g=c.slice(1);d<g.length;d+=1){var w=g[d];if(!Lf(w)&&typeof w!="boolean")return!1}return!0;default:return!0}}du.deserialize=function(c){return new du(c._parameters,c._specification)},du.serialize=function(c){return{_parameters:c._parameters,_specification:c._specification}};var yh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Du(c){if(c==null)return{filter:function(){return!0},needGeometry:!1};Lf(c)||(c=xd(c));var d=ks(c,yh);if(d.result==="error")throw new Error(d.value.map(function(g){return g.key+": "+g.message}).join(", "));return{filter:function(g,w,P){return d.value.evaluate(g,w,{},P)},needGeometry:function g(w){if(!Array.isArray(w))return!1;if(w[0]==="within")return!0;for(var P=1;P<w.length;P++)if(g(w[P]))return!0;return!1}(c)}}function P0(c,d){return c<d?-1:c>d?1:0}function xd(c){if(!c)return!0;var d,g=c[0];return c.length<=1?g!=="any":g==="=="?Dc(c[1],c[2],"=="):g==="!="?Wh(Dc(c[1],c[2],"==")):g==="<"||g===">"||g==="<="||g===">="?Dc(c[1],c[2],g):g==="any"?(d=c.slice(1),["any"].concat(d.map(xd))):g==="all"?["all"].concat(c.slice(1).map(xd)):g==="none"?["all"].concat(c.slice(1).map(xd).map(Wh)):g==="in"?Gh(c[1],c.slice(2)):g==="!in"?Wh(Gh(c[1],c.slice(2))):g==="has"?gp(c[1]):g==="!has"?Wh(gp(c[1])):g!=="within"||c}function Dc(c,d,g){switch(c){case"$type":return["filter-type-"+g,d];case"$id":return["filter-id-"+g,d];default:return["filter-"+g,c,d]}}function Gh(c,d){if(d.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(g){return typeof g!=typeof d[0]})?["filter-in-large",c,["literal",d.sort(P0)]]:["filter-in-small",c,["literal",d]]}}function gp(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Wh(c){return["!",c]}function _h(c){return Lf(vr(c.value))?If(Tr({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(g){var w=g.value,P=g.key;if(Po(w)!=="array")return[new Fe(P,w,"array expected, "+Po(w)+" found")];var N,j=g.styleSpec,q=[];if(w.length<1)return[new Fe(P,w,"filter array must have at least 1 element")];switch(q=q.concat(Lu({key:P+"[0]",value:w[0],valueSpec:j.filter_operator,style:g.style,styleSpec:g.styleSpec})),Zr(w[0])){case"<":case"<=":case">":case">=":w.length>=2&&Zr(w[1])==="$type"&&q.push(new Fe(P,w,'"$type" cannot be use with operator "'+w[0]+'"'));case"==":case"!=":w.length!==3&&q.push(new Fe(P,w,'filter array for operator "'+w[0]+'" must have 3 elements'));case"in":case"!in":w.length>=2&&(N=Po(w[1]))!=="string"&&q.push(new Fe(P+"[1]",w[1],"string expected, "+N+" found"));for(var at=2;at<w.length;at++)N=Po(w[at]),Zr(w[1])==="$type"?q=q.concat(Lu({key:P+"["+at+"]",value:w[at],valueSpec:j.geometry_type,style:g.style,styleSpec:g.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&q.push(new Fe(P+"["+at+"]",w[at],"string, number, or boolean expected, "+N+" found"));break;case"any":case"all":case"none":for(var vt=1;vt<w.length;vt++)q=q.concat(d({key:P+"["+vt+"]",value:w[vt],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":N=Po(w[1]),w.length!==2?q.push(new Fe(P,w,'filter array for "'+w[0]+'" operator must have 2 elements')):N!=="string"&&q.push(new Fe(P+"[1]",w[1],"string expected, "+N+" found"));break;case"within":N=Po(w[1]),w.length!==2?q.push(new Fe(P,w,'filter array for "'+w[0]+'" operator must have 2 elements')):N!=="object"&&q.push(new Fe(P+"[1]",w[1],"object expected, "+N+" found"))}return q}(c)}function Nu(c,d){var g=c.key,w=c.style,P=c.styleSpec,N=c.value,j=c.objectKey,q=P[d+"_"+c.layerType];if(!q)return[];var at=j.match(/^(.*)-transition$/);if(d==="paint"&&at&&q[at[1]]&&q[at[1]].transition)return mt({key:g,value:N,valueSpec:P.transition,style:w,styleSpec:P});var vt,Ot=c.valueSpec||q[j];if(!Ot)return[new Fe(g,N,'unknown property "'+j+'"')];if(Po(N)==="string"&&co(Ot)&&!Ot.tokens&&(vt=/^{([^}]+)}$/.exec(N)))return[new Fe(g,N,'"'+j+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(vt[1])+" }`.")];var Dt=[];return c.layerType==="symbol"&&(j==="text-field"&&w&&!w.glyphs&&Dt.push(new Fe(g,N,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&_a(vr(N))&&Zr(N.type)==="identity"&&Dt.push(new Fe(g,N,'"text-font" does not support identity functions'))),Dt.concat(mt({key:c.key,value:N,valueSpec:Ot,style:w,styleSpec:P,expressionContext:"property",propertyType:d,propertyKey:j}))}function Df(c){return Nu(c,"paint")}function Jf(c){return Nu(c,"layout")}function Yp(c){var d=[],g=c.value,w=c.key,P=c.style,N=c.styleSpec;g.type||g.ref||d.push(new Fe(w,g,'either "type" or "ref" is required'));var j,q=Zr(g.type),at=Zr(g.ref);if(g.id)for(var vt=Zr(g.id),Ot=0;Ot<c.arrayIndex;Ot++){var Dt=P.layers[Ot];Zr(Dt.id)===vt&&d.push(new Fe(w,g.id,'duplicate layer id "'+g.id+'", previously used at line '+Dt.id.__line__))}if("ref"in g)["type","source","source-layer","filter","layout"].forEach(function(Xe){Xe in g&&d.push(new Fe(w,g[Xe],'"'+Xe+'" is prohibited for ref layers'))}),P.layers.forEach(function(Xe){Zr(Xe.id)===at&&(j=Xe)}),j?j.ref?d.push(new Fe(w,g.ref,"ref cannot reference another ref layer")):q=Zr(j.type):d.push(new Fe(w,g.ref,'ref layer "'+at+'" not found'));else if(q!=="background")if(g.source){var Yt=P.sources&&P.sources[g.source],pe=Yt&&Zr(Yt.type);Yt?pe==="vector"&&q==="raster"?d.push(new Fe(w,g.source,'layer "'+g.id+'" requires a raster source')):pe==="raster"&&q!=="raster"?d.push(new Fe(w,g.source,'layer "'+g.id+'" requires a vector source')):pe!=="vector"||g["source-layer"]?pe==="raster-dem"&&q!=="hillshade"?d.push(new Fe(w,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):q!=="line"||!g.paint||!g.paint["line-gradient"]||pe==="geojson"&&Yt.lineMetrics||d.push(new Fe(w,g,'layer "'+g.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new Fe(w,g,'layer "'+g.id+'" must specify a "source-layer"')):d.push(new Fe(w,g.source,'source "'+g.source+'" not found'))}else d.push(new Fe(w,g,'missing required property "source"'));return d=d.concat(Lc({key:w,value:g,valueSpec:N.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return mt({key:w+".type",value:g.type,valueSpec:N.layer.type,style:c.style,styleSpec:c.styleSpec,object:g,objectKey:"type"})},filter:_h,layout:function(Xe){return Lc({layer:g,key:Xe.key,value:Xe.value,style:Xe.style,styleSpec:Xe.styleSpec,objectElementValidators:{"*":function(en){return Jf(Tr({layerType:q},en))}}})},paint:function(Xe){return Lc({layer:g,key:Xe.key,value:Xe.value,style:Xe.style,styleSpec:Xe.styleSpec,objectElementValidators:{"*":function(en){return Df(Tr({layerType:q},en))}}})}}}))}function Nf(c){var d=c.value,g=c.key,w=Po(d);return w!=="string"?[new Fe(g,d,"string expected, "+w+" found")]:[]}var $a={promoteId:function(c){var d=c.key,g=c.value;if(Po(g)==="string")return Nf({key:d,value:g});var w=[];for(var P in g)w.push.apply(w,Nf({key:d+"."+P,value:g[P]}));return w}};function bd(c){var d=c.value,g=c.key,w=c.styleSpec,P=c.style;if(!d.type)return[new Fe(g,d,'"type" is required')];var N,j=Zr(d.type);switch(j){case"vector":case"raster":case"raster-dem":return Lc({key:g,value:d,valueSpec:w["source_"+j.replace("-","_")],style:c.style,styleSpec:w,objectElementValidators:$a});case"geojson":if(N=Lc({key:g,value:d,valueSpec:w.source_geojson,style:P,styleSpec:w,objectElementValidators:$a}),d.cluster)for(var q in d.clusterProperties){var at=d.clusterProperties[q],vt=at[0],Ot=typeof vt=="string"?[vt,["accumulated"],["get",q]]:vt;N.push.apply(N,If({key:g+"."+q+".map",value:at[1],expressionContext:"cluster-map"})),N.push.apply(N,If({key:g+"."+q+".reduce",value:Ot,expressionContext:"cluster-reduce"}))}return N;case"video":return Lc({key:g,value:d,valueSpec:w.source_video,style:P,styleSpec:w});case"image":return Lc({key:g,value:d,valueSpec:w.source_image,style:P,styleSpec:w});case"canvas":return[new Fe(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lu({key:g+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:P,styleSpec:w})}}function pu(c){var d=c.value,g=c.styleSpec,w=g.light,P=c.style,N=[],j=Po(d);if(d===void 0)return N;if(j!=="object")return N.concat([new Fe("light",d,"object expected, "+j+" found")]);for(var q in d){var at=q.match(/^(.*)-transition$/);N=N.concat(at&&w[at[1]]&&w[at[1]].transition?mt({key:q,value:d[q],valueSpec:g.transition,style:P,styleSpec:g}):w[q]?mt({key:q,value:d[q],valueSpec:w[q],style:P,styleSpec:g}):[new Fe(q,d[q],'unknown property "'+q+'"')])}return N}var tt={"*":function(){return[]},array:Pf,boolean:function(c){var d=c.value,g=c.key,w=Po(d);return w!=="boolean"?[new Fe(g,d,"boolean expected, "+w+" found")]:[]},number:Zh,color:function(c){var d=c.key,g=c.value,w=Po(g);return w!=="string"?[new Fe(d,g,"color expected, "+w+" found")]:Pn(g)===null?[new Fe(d,g,'color expected, "'+g+'" found')]:[]},constants:Hn,enum:Lu,filter:_h,function:Hh,layer:Yp,object:Lc,source:bd,light:pu,string:Nf,formatted:function(c){return Nf(c).length===0?[]:If(c)},resolvedImage:function(c){return Nf(c).length===0?[]:If(c)}};function mt(c){var d=c.value,g=c.valueSpec,w=c.styleSpec;return g.expression&&_a(Zr(d))?Hh(c):g.expression&&qs(vr(d))?If(c):g.type&&tt[g.type]?tt[g.type](c):Lc(Tr({},c,{valueSpec:g.type?w[g.type]:g}))}function Xt(c){var d=c.value,g=c.key,w=Nf(c);return w.length||(d.indexOf("{fontstack}")===-1&&w.push(new Fe(g,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&w.push(new Fe(g,d,'"glyphs" url must include a "{range}" token'))),w}function dn(c,d){d===void 0&&(d=ee);var g=[];return g=g.concat(mt({key:"",value:c,valueSpec:d.$root,styleSpec:d,style:c,objectElementValidators:{glyphs:Xt,"*":function(){return[]}}})),c.constants&&(g=g.concat(Hn({key:"constants",value:c.constants,style:c,styleSpec:d}))),nr(g)}function nr(c){return[].concat(c).sort(function(d,g){return d.line-g.line})}function Br(c){return function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];return nr(c.apply(this,d))}}dn.source=Br(bd),dn.light=Br(pu),dn.layer=Br(Yp),dn.filter=Br(_h),dn.paintProperty=Br(Df),dn.layoutProperty=Br(Jf);var vi=dn,qi=vi.light,da=vi.paintProperty,xa=vi.layoutProperty;function ms(c,d){var g=!1;if(d&&d.length)for(var w=0,P=d;w<P.length;w+=1)c.fire(new Ge(new Error(P[w].message))),g=!0;return g}var Fa=Ba;function Ba(c,d,g){var w=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var P=new Int32Array(this.arrayBuffer);c=P[0],this.d=(d=P[1])+2*(g=P[2]);for(var N=0;N<this.d*this.d;N++){var j=P[3+N],q=P[3+N+1];w.push(j===q?null:P.subarray(j,q))}var at=P[3+w.length+1];this.keys=P.subarray(P[3+w.length],at),this.bboxes=P.subarray(at),this.insert=this._insertReadonly}else{this.d=d+2*g;for(var vt=0;vt<this.d*this.d;vt++)w.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=c,this.padding=g,this.scale=d/c,this.uid=0;var Ot=g/d*c;this.min=-Ot,this.max=c+Ot}Ba.prototype.insert=function(c,d,g,w,P){this._forEachCell(d,g,w,P,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(P)},Ba.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ba.prototype._insertCell=function(c,d,g,w,P,N){this.cells[P].push(N)},Ba.prototype.query=function(c,d,g,w,P){var N=this.min,j=this.max;if(c<=N&&d<=N&&j<=g&&j<=w&&!P)return Array.prototype.slice.call(this.keys);var q=[];return this._forEachCell(c,d,g,w,this._queryCell,q,{},P),q},Ba.prototype._queryCell=function(c,d,g,w,P,N,j,q){var at=this.cells[P];if(at!==null)for(var vt=this.keys,Ot=this.bboxes,Dt=0;Dt<at.length;Dt++){var Yt=at[Dt];if(j[Yt]===void 0){var pe=4*Yt;(q?q(Ot[pe+0],Ot[pe+1],Ot[pe+2],Ot[pe+3]):c<=Ot[pe+2]&&d<=Ot[pe+3]&&g>=Ot[pe+0]&&w>=Ot[pe+1])?(j[Yt]=!0,N.push(vt[Yt])):j[Yt]=!1}}},Ba.prototype._forEachCell=function(c,d,g,w,P,N,j,q){for(var at=this._convertToCellCoord(c),vt=this._convertToCellCoord(d),Ot=this._convertToCellCoord(g),Dt=this._convertToCellCoord(w),Yt=at;Yt<=Ot;Yt++)for(var pe=vt;pe<=Dt;pe++){var Xe=this.d*pe+Yt;if((!q||q(this._convertFromCellCoord(Yt),this._convertFromCellCoord(pe),this._convertFromCellCoord(Yt+1),this._convertFromCellCoord(pe+1)))&&P.call(this,c,d,g,w,Xe,N,j,q))return}},Ba.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Ba.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Ba.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,d=3+this.cells.length+1+1,g=0,w=0;w<this.cells.length;w++)g+=this.cells[w].length;var P=new Int32Array(d+g+this.keys.length+this.bboxes.length);P[0]=this.extent,P[1]=this.n,P[2]=this.padding;for(var N=d,j=0;j<c.length;j++){var q=c[j];P[3+j]=N,P.set(q,N),N+=q.length}return P[3+c.length]=N,P.set(this.keys,N),P[3+c.length+1]=N+=this.keys.length,P.set(this.bboxes,N),N+=this.bboxes.length,P.buffer};var cc=Lt.ImageData,ku=Lt.ImageBitmap,$s={};function fo(c,d,g){g===void 0&&(g={}),Object.defineProperty(d,"_classRegistryKey",{value:c,writeable:!1}),$s[c]={klass:d,omit:g.omit||[],shallow:g.shallow||[]}}for(var ru in fo("Object",Object),Fa.serialize=function(c,d){var g=c.toArrayBuffer();return d&&d.push(g),{buffer:g}},Fa.deserialize=function(c){return new Fa(c.buffer)},fo("Grid",Fa),fo("Color",tn),fo("Error",Error),fo("ResolvedImage",ai),fo("StylePropertyFunction",du),fo("StyleExpression",ka,{omit:["_evaluator"]}),fo("ZoomDependentExpression",es),fo("ZoomConstantExpression",Ec),fo("CompoundExpression",ca,{omit:["_evaluate"]}),It)It[ru]._classRegistryKey||fo("Expression_"+ru,It[ru]);function Ed(c){return c&&typeof ArrayBuffer!="undefined"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function th(c){return ku&&c instanceof ku}function pl(c,d){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Ed(c)||th(c))return d&&d.push(c),c;if(ArrayBuffer.isView(c)){var g=c;return d&&d.push(g.buffer),g}if(c instanceof cc)return d&&d.push(c.data.buffer),c;if(Array.isArray(c)){for(var w=[],P=0,N=c;P<N.length;P+=1)w.push(pl(N[P],d));return w}if(typeof c=="object"){var j=c.constructor,q=j._classRegistryKey;if(!q)throw new Error("can't serialize object of unregistered class");var at=j.serialize?j.serialize(c,d):{};if(!j.serialize){for(var vt in c)if(c.hasOwnProperty(vt)&&!($s[q].omit.indexOf(vt)>=0)){var Ot=c[vt];at[vt]=$s[q].shallow.indexOf(vt)>=0?Ot:pl(Ot,d)}c instanceof Error&&(at.message=c.message)}if(at.$name)throw new Error("$name property is reserved for worker serialization logic.");return q!=="Object"&&(at.$name=q),at}throw new Error("can't serialize object of type "+typeof c)}function ns(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Ed(c)||th(c)||ArrayBuffer.isView(c)||c instanceof cc)return c;if(Array.isArray(c))return c.map(ns);if(typeof c=="object"){var d=c.$name||"Object",g=$s[d].klass;if(!g)throw new Error("can't deserialize unregistered class "+d);if(g.deserialize)return g.deserialize(c);for(var w=Object.create(g.prototype),P=0,N=Object.keys(c);P<N.length;P+=1){var j=N[P];if(j!=="$name"){var q=c[j];w[j]=$s[d].shallow.indexOf(j)>=0?q:ns(q)}}return w}throw new Error("can't deserialize object of type "+typeof c)}var yp=function(){this.first=!0};yp.prototype.update=function(c,d){var g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))};var Ri={"Latin-1 Supplement":function(c){return c>=128&&c<=255},Arabic:function(c){return c>=1536&&c<=1791},"Arabic Supplement":function(c){return c>=1872&&c<=1919},"Arabic Extended-A":function(c){return c>=2208&&c<=2303},"Hangul Jamo":function(c){return c>=4352&&c<=4607},"Unified Canadian Aboriginal Syllabics":function(c){return c>=5120&&c<=5759},Khmer:function(c){return c>=6016&&c<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(c){return c>=6320&&c<=6399},"General Punctuation":function(c){return c>=8192&&c<=8303},"Letterlike Symbols":function(c){return c>=8448&&c<=8527},"Number Forms":function(c){return c>=8528&&c<=8591},"Miscellaneous Technical":function(c){return c>=8960&&c<=9215},"Control Pictures":function(c){return c>=9216&&c<=9279},"Optical Character Recognition":function(c){return c>=9280&&c<=9311},"Enclosed Alphanumerics":function(c){return c>=9312&&c<=9471},"Geometric Shapes":function(c){return c>=9632&&c<=9727},"Miscellaneous Symbols":function(c){return c>=9728&&c<=9983},"Miscellaneous Symbols and Arrows":function(c){return c>=11008&&c<=11263},"CJK Radicals Supplement":function(c){return c>=11904&&c<=12031},"Kangxi Radicals":function(c){return c>=12032&&c<=12255},"Ideographic Description Characters":function(c){return c>=12272&&c<=12287},"CJK Symbols and Punctuation":function(c){return c>=12288&&c<=12351},Hiragana:function(c){return c>=12352&&c<=12447},Katakana:function(c){return c>=12448&&c<=12543},Bopomofo:function(c){return c>=12544&&c<=12591},"Hangul Compatibility Jamo":function(c){return c>=12592&&c<=12687},Kanbun:function(c){return c>=12688&&c<=12703},"Bopomofo Extended":function(c){return c>=12704&&c<=12735},"CJK Strokes":function(c){return c>=12736&&c<=12783},"Katakana Phonetic Extensions":function(c){return c>=12784&&c<=12799},"Enclosed CJK Letters and Months":function(c){return c>=12800&&c<=13055},"CJK Compatibility":function(c){return c>=13056&&c<=13311},"CJK Unified Ideographs Extension A":function(c){return c>=13312&&c<=19903},"Yijing Hexagram Symbols":function(c){return c>=19904&&c<=19967},"CJK Unified Ideographs":function(c){return c>=19968&&c<=40959},"Yi Syllables":function(c){return c>=40960&&c<=42127},"Yi Radicals":function(c){return c>=42128&&c<=42191},"Hangul Jamo Extended-A":function(c){return c>=43360&&c<=43391},"Hangul Syllables":function(c){return c>=44032&&c<=55215},"Hangul Jamo Extended-B":function(c){return c>=55216&&c<=55295},"Private Use Area":function(c){return c>=57344&&c<=63743},"CJK Compatibility Ideographs":function(c){return c>=63744&&c<=64255},"Arabic Presentation Forms-A":function(c){return c>=64336&&c<=65023},"Vertical Forms":function(c){return c>=65040&&c<=65055},"CJK Compatibility Forms":function(c){return c>=65072&&c<=65103},"Small Form Variants":function(c){return c>=65104&&c<=65135},"Arabic Presentation Forms-B":function(c){return c>=65136&&c<=65279},"Halfwidth and Fullwidth Forms":function(c){return c>=65280&&c<=65519}};function eh(c){for(var d=0,g=c;d<g.length;d+=1)if(Sd(g[d].charCodeAt(0)))return!0;return!1}function Sd(c){return!(c!==746&&c!==747&&(c<4352||!(Ri["Bopomofo Extended"](c)||Ri.Bopomofo(c)||Ri["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Ri["CJK Compatibility Ideographs"](c)||Ri["CJK Compatibility"](c)||Ri["CJK Radicals Supplement"](c)||Ri["CJK Strokes"](c)||!(!Ri["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Ri["CJK Unified Ideographs Extension A"](c)||Ri["CJK Unified Ideographs"](c)||Ri["Enclosed CJK Letters and Months"](c)||Ri["Hangul Compatibility Jamo"](c)||Ri["Hangul Jamo Extended-A"](c)||Ri["Hangul Jamo Extended-B"](c)||Ri["Hangul Jamo"](c)||Ri["Hangul Syllables"](c)||Ri.Hiragana(c)||Ri["Ideographic Description Characters"](c)||Ri.Kanbun(c)||Ri["Kangxi Radicals"](c)||Ri["Katakana Phonetic Extensions"](c)||Ri.Katakana(c)&&c!==12540||!(!Ri["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Ri["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Ri["Unified Canadian Aboriginal Syllabics"](c)||Ri["Unified Canadian Aboriginal Syllabics Extended"](c)||Ri["Vertical Forms"](c)||Ri["Yijing Hexagram Symbols"](c)||Ri["Yi Syllables"](c)||Ri["Yi Radicals"](c))))}function qp(c){return!(Sd(c)||function(d){return!!(Ri["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Ri["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Ri["Letterlike Symbols"](d)||Ri["Number Forms"](d)||Ri["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Ri["Control Pictures"](d)&&d!==9251||Ri["Optical Character Recognition"](d)||Ri["Enclosed Alphanumerics"](d)||Ri["Geometric Shapes"](d)||Ri["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Ri["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Ri["CJK Symbols and Punctuation"](d)||Ri.Katakana(d)||Ri["Private Use Area"](d)||Ri["CJK Compatibility Forms"](d)||Ri["Small Form Variants"](d)||Ri["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(c))}function Nc(c){return c>=1424&&c<=2303||Ri["Arabic Presentation Forms-A"](c)||Ri["Arabic Presentation Forms-B"](c)}function mu(c,d){return!(!d&&Nc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Ri.Khmer(c))}function _p(c){for(var d=0,g=c;d<g.length;d+=1)if(Nc(g[d].charCodeAt(0)))return!0;return!1}var $p=null,kc="unavailable",nh=null,Jm=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(kc="error"),$p&&$p(c)};function Td(){xp.fire(new ue("pluginStateChange",{pluginStatus:kc,pluginURL:nh}))}var xp=new ln,sm=function(){return kc},Bu=function(){if(kc!=="deferred"||!nh)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");kc="loading",Td(),nh&&Sr({url:nh},function(c){c?Jm(c):(kc="loaded",Td())})},vu={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return kc==="loaded"||vu.applyArabicShaping!=null},isLoading:function(){return kc==="loading"},setState:function(c){kc=c.pluginStatus,nh=c.pluginURL},isParsed:function(){return vu.applyArabicShaping!=null&&vu.processBidirectionalText!=null&&vu.processStyledBidirectionalText!=null},getPluginURL:function(){return nh}},va=function(c,d){this.zoom=c,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yp,this.transition={})};va.prototype.isSupportedScript=function(c){return function(d,g){for(var w=0,P=d;w<P.length;w+=1)if(!mu(P[w].charCodeAt(0),g))return!1;return!0}(c,vu.isLoaded())},va.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},va.prototype.getCrossfadeParameters=function(){var c=this.zoom,d=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}};var Fu=function(c,d){this.property=c,this.value=d,this.expression=function(g,w){if(_a(g))return new du(g,w);if(qs(g)){var P=Iu(g,w);if(P.result==="error")throw new Error(P.value.map(function(j){return j.key+": "+j.message}).join(", "));return P.value}var N=g;return typeof g=="string"&&w.type==="color"&&(N=tn.parse(g)),{kind:"constant",evaluate:function(){return N}}}(d===void 0?c.specification.default:d,c.specification)};Fu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Fu.prototype.possiblyEvaluate=function(c,d,g){return this.property.possiblyEvaluate(this,c,d,g)};var Uu=function(c){this.property=c,this.value=new Fu(c,void 0)};Uu.prototype.transitioned=function(c,d){return new Xh(this.property,this.value,d,ce({},c.transition,this.transition),c.now)},Uu.prototype.untransitioned=function(){return new Xh(this.property,this.value,null,{},0)};var uc=function(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)};uc.prototype.getValue=function(c){return $t(this._values[c].value.value)},uc.prototype.setValue=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Uu(this._values[c].property)),this._values[c].value=new Fu(this._values[c].property,d===null?void 0:$t(d))},uc.prototype.getTransition=function(c){return $t(this._values[c].transition)},uc.prototype.setTransition=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Uu(this._values[c].property)),this._values[c].transition=$t(d)||void 0},uc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var w=g[d],P=this.getValue(w);P!==void 0&&(c[w]=P);var N=this.getTransition(w);N!==void 0&&(c[w+"-transition"]=N)}return c},uc.prototype.transitioned=function(c,d){for(var g=new Gl(this._properties),w=0,P=Object.keys(this._values);w<P.length;w+=1){var N=P[w];g._values[N]=this._values[N].transitioned(c,d._values[N])}return g},uc.prototype.untransitioned=function(){for(var c=new Gl(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var w=g[d];c._values[w]=this._values[w].untransitioned()}return c};var Xh=function(c,d,g,w,P){this.property=c,this.value=d,this.begin=P+w.delay||0,this.end=this.begin+w.duration||0,c.specification.transition&&(w.delay||w.duration)&&(this.prior=g)};Xh.prototype.possiblyEvaluate=function(c,d,g){var w=c.now||0,P=this.value.possiblyEvaluate(c,d,g),N=this.prior;if(N){if(w>this.end)return this.prior=null,P;if(this.value.isDataDriven())return this.prior=null,P;if(w<this.begin)return N.possiblyEvaluate(c,d,g);var j=(w-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(c,d,g),P,function(q){if(q<=0)return 0;if(q>=1)return 1;var at=q*q,vt=at*q;return 4*(q<.5?vt:3*(q-at)+vt-.75)}(j))}return P};var Gl=function(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)};Gl.prototype.possiblyEvaluate=function(c,d,g){for(var w=new bp(this._properties),P=0,N=Object.keys(this._values);P<N.length;P+=1){var j=N[P];w._values[j]=this._values[j].possiblyEvaluate(c,d,g)}return w},Gl.prototype.hasTransition=function(){for(var c=0,d=Object.keys(this._values);c<d.length;c+=1)if(this._values[d[c]].prior)return!0;return!1};var Gc=function(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)};Gc.prototype.getValue=function(c){return $t(this._values[c].value)},Gc.prototype.setValue=function(c,d){this._values[c]=new Fu(this._values[c].property,d===null?void 0:$t(d))},Gc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var w=g[d],P=this.getValue(w);P!==void 0&&(c[w]=P)}return c},Gc.prototype.possiblyEvaluate=function(c,d,g){for(var w=new bp(this._properties),P=0,N=Object.keys(this._values);P<N.length;P+=1){var j=N[P];w._values[j]=this._values[j].possiblyEvaluate(c,d,g)}return w};var iu=function(c,d,g){this.property=c,this.value=d,this.parameters=g};iu.prototype.isConstant=function(){return this.value.kind==="constant"},iu.prototype.constantOr=function(c){return this.value.kind==="constant"?this.value.value:c},iu.prototype.evaluate=function(c,d,g,w){return this.property.evaluate(this.value,this.parameters,c,d,g,w)};var bp=function(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)};bp.prototype.get=function(c){return this._values[c]};var Ao=function(c){this.specification=c};Ao.prototype.possiblyEvaluate=function(c,d){return c.expression.evaluate(d)},Ao.prototype.interpolate=function(c,d,g){var w=Ru[this.specification.type];return w?w(c,d,g):c};var xo=function(c,d){this.specification=c,this.overrides=d};xo.prototype.possiblyEvaluate=function(c,d,g,w){return new iu(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},g,w)}:c.expression,d)},xo.prototype.interpolate=function(c,d,g){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new iu(this,{kind:"constant",value:void 0},c.parameters);var w=Ru[this.specification.type];return w?new iu(this,{kind:"constant",value:w(c.value.value,d.value.value,g)},c.parameters):c},xo.prototype.evaluate=function(c,d,g,w,P,N){return c.kind==="constant"?c.value:c.evaluate(d,g,w,P,N)};var zu=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,w,P,N){if(g.value===void 0)return new iu(this,{kind:"constant",value:void 0},w);if(g.expression.kind==="constant"){var j=g.expression.evaluate(w,null,{},P,N),q=g.property.specification.type==="resolvedImage"&&typeof j!="string"?j.name:j,at=this._calculate(q,q,q,w);return new iu(this,{kind:"constant",value:at},w)}if(g.expression.kind==="camera"){var vt=this._calculate(g.expression.evaluate({zoom:w.zoom-1}),g.expression.evaluate({zoom:w.zoom}),g.expression.evaluate({zoom:w.zoom+1}),w);return new iu(this,{kind:"constant",value:vt},w)}return new iu(this,g.expression,w)},d.prototype.evaluate=function(g,w,P,N,j,q){if(g.kind==="source"){var at=g.evaluate(w,P,N,j,q);return this._calculate(at,at,at,w)}return g.kind==="composite"?this._calculate(g.evaluate({zoom:Math.floor(w.zoom)-1},P,N),g.evaluate({zoom:Math.floor(w.zoom)},P,N),g.evaluate({zoom:Math.floor(w.zoom)+1},P,N),w):g.value},d.prototype._calculate=function(g,w,P,N){return N.zoom>N.zoomHistory.lastIntegerZoom?{from:g,to:w}:{from:P,to:w}},d.prototype.interpolate=function(g){return g},d}(xo),ou=function(c){this.specification=c};ou.prototype.possiblyEvaluate=function(c,d,g,w){if(c.value!==void 0){if(c.expression.kind==="constant"){var P=c.expression.evaluate(d,null,{},g,w);return this._calculate(P,P,P,d)}return this._calculate(c.expression.evaluate(new va(Math.floor(d.zoom-1),d)),c.expression.evaluate(new va(Math.floor(d.zoom),d)),c.expression.evaluate(new va(Math.floor(d.zoom+1),d)),d)}},ou.prototype._calculate=function(c,d,g,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:g,to:d}},ou.prototype.interpolate=function(c){return c};var rh=function(c){this.specification=c};rh.prototype.possiblyEvaluate=function(c,d,g,w){return!!c.expression.evaluate(d,null,{},g,w)},rh.prototype.interpolate=function(){return!1};var ul=function(c){for(var d in this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],c){var g=c[d];g.specification.overridable&&this.overridableProperties.push(d);var w=this.defaultPropertyValues[d]=new Fu(g,void 0),P=this.defaultTransitionablePropertyValues[d]=new Uu(g);this.defaultTransitioningPropertyValues[d]=P.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=w.possiblyEvaluate({})}};fo("DataDrivenProperty",xo),fo("DataConstantProperty",Ao),fo("CrossFadedDataDrivenProperty",zu),fo("CrossFadedProperty",ou),fo("ColorRampProperty",rh);var Wc=function(c){function d(g,w){if(c.call(this),this.id=g.id,this.type=g.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},g.type!=="custom"&&(this.metadata=(g=g).metadata,this.minzoom=g.minzoom,this.maxzoom=g.maxzoom,g.type!=="background"&&(this.source=g.source,this.sourceLayer=g["source-layer"],this.filter=g.filter),w.layout&&(this._unevaluatedLayout=new Gc(w.layout)),w.paint)){for(var P in this._transitionablePaint=new uc(w.paint),g.paint)this.setPaintProperty(P,g.paint[P],{validate:!1});for(var N in g.layout)this.setLayoutProperty(N,g.layout[N],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new bp(w.paint)}}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(g){return g==="visibility"?this.visibility:this._unevaluatedLayout.getValue(g)},d.prototype.setLayoutProperty=function(g,w,P){P===void 0&&(P={}),w!=null&&this._validate(xa,"layers."+this.id+".layout."+g,g,w,P)||(g!=="visibility"?this._unevaluatedLayout.setValue(g,w):this.visibility=w)},d.prototype.getPaintProperty=function(g){return mr(g,"-transition")?this._transitionablePaint.getTransition(g.slice(0,-11)):this._transitionablePaint.getValue(g)},d.prototype.setPaintProperty=function(g,w,P){if(P===void 0&&(P={}),w!=null&&this._validate(da,"layers."+this.id+".paint."+g,g,w,P))return!1;if(mr(g,"-transition"))return this._transitionablePaint.setTransition(g.slice(0,-11),w||void 0),!1;var N=this._transitionablePaint._values[g],j=N.property.specification["property-type"]==="cross-faded-data-driven",q=N.value.isDataDriven(),at=N.value;this._transitionablePaint.setValue(g,w),this._handleSpecialPaintPropertyUpdate(g);var vt=this._transitionablePaint._values[g].value;return vt.isDataDriven()||q||j||this._handleOverridablePaintPropertyUpdate(g,at,vt)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){},d.prototype._handleOverridablePaintPropertyUpdate=function(g,w,P){return!1},d.prototype.isHidden=function(g){return!!(this.minzoom&&g<this.minzoom)||!!(this.maxzoom&&g>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(g){this._transitioningPaint=this._transitionablePaint.transitioned(g,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(g,w){g.getCrossfadeParameters&&(this._crossfadeParameters=g.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(g,void 0,w)),this.paint=this._transitioningPaint.possiblyEvaluate(g,void 0,w)},d.prototype.serialize=function(){var g={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(g.layout=g.layout||{},g.layout.visibility=this.visibility),He(g,function(w,P){return!(w===void 0||P==="layout"&&!Object.keys(w).length||P==="paint"&&!Object.keys(w).length)})},d.prototype._validate=function(g,w,P,N,j){return j===void 0&&(j={}),(!j||j.validate!==!1)&&ms(this,g.call(vi,{key:w,layerType:this.type,objectKey:P,value:N,styleSpec:ee,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var g in this.paint._values){var w=this.paint.get(g);if(w instanceof iu&&co(w.property.specification)&&(w.value.kind==="source"||w.value.kind==="composite")&&w.value.isStateDependent)return!0}return!1},d}(ln),kf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wd=function(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},fs=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function fc(c,d){d===void 0&&(d=1);var g=0,w=0;return{members:c.map(function(P){var N=kf[P.type].BYTES_PER_ELEMENT,j=g=I0(g,Math.max(d,N)),q=P.components||1;return w=Math.max(w,N),g+=N*q,{name:P.name,type:P.type,components:q,offset:j}}),size:I0(g,Math.max(w,d)),alignment:d}}function I0(c,d){return Math.ceil(c/d)*d}fs.serialize=function(c,d){return c._trim(),d&&(c.isTransferred=!0,d.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}},fs.deserialize=function(c){var d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},fs.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},fs.prototype.clear=function(){this.length=0},fs.prototype.resize=function(c){this.reserve(c),this.length=c},fs.prototype.reserve=function(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},fs.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Yh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w){var P=this.length;return this.resize(P+1),this.emplace(P,g,w)},d.prototype.emplace=function(g,w,P){var N=2*g;return this.int16[N+0]=w,this.int16[N+1]=P,g},d}(fs);Yh.prototype.bytesPerElement=4,fo("StructArrayLayout2i4",Yh);var Kp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N){var j=this.length;return this.resize(j+1),this.emplace(j,g,w,P,N)},d.prototype.emplace=function(g,w,P,N,j){var q=4*g;return this.int16[q+0]=w,this.int16[q+1]=P,this.int16[q+2]=N,this.int16[q+3]=j,g},d}(fs);Kp.prototype.bytesPerElement=8,fo("StructArrayLayout4i8",Kp);var xh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q){var at=this.length;return this.resize(at+1),this.emplace(at,g,w,P,N,j,q)},d.prototype.emplace=function(g,w,P,N,j,q,at){var vt=6*g;return this.int16[vt+0]=w,this.int16[vt+1]=P,this.int16[vt+2]=N,this.int16[vt+3]=j,this.int16[vt+4]=q,this.int16[vt+5]=at,g},d}(fs);xh.prototype.bytesPerElement=12,fo("StructArrayLayout2i4i12",xh);var au=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q){var at=this.length;return this.resize(at+1),this.emplace(at,g,w,P,N,j,q)},d.prototype.emplace=function(g,w,P,N,j,q,at){var vt=4*g,Ot=8*g;return this.int16[vt+0]=w,this.int16[vt+1]=P,this.uint8[Ot+4]=N,this.uint8[Ot+5]=j,this.uint8[Ot+6]=q,this.uint8[Ot+7]=at,g},d}(fs);au.prototype.bytesPerElement=8,fo("StructArrayLayout2i4ub8",au);var zd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w){var P=this.length;return this.resize(P+1),this.emplace(P,g,w)},d.prototype.emplace=function(g,w,P){var N=2*g;return this.float32[N+0]=w,this.float32[N+1]=P,g},d}(fs);zd.prototype.bytesPerElement=8,fo("StructArrayLayout2f8",zd);var Gr=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q,at,vt,Ot,Dt){var Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,g,w,P,N,j,q,at,vt,Ot,Dt)},d.prototype.emplace=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt){var pe=10*g;return this.uint16[pe+0]=w,this.uint16[pe+1]=P,this.uint16[pe+2]=N,this.uint16[pe+3]=j,this.uint16[pe+4]=q,this.uint16[pe+5]=at,this.uint16[pe+6]=vt,this.uint16[pe+7]=Ot,this.uint16[pe+8]=Dt,this.uint16[pe+9]=Yt,g},d}(fs);Gr.prototype.bytesPerElement=20,fo("StructArrayLayout10ui20",Gr);var ih=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe){var Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe)},d.prototype.emplace=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe){var en=12*g;return this.int16[en+0]=w,this.int16[en+1]=P,this.int16[en+2]=N,this.int16[en+3]=j,this.uint16[en+4]=q,this.uint16[en+5]=at,this.uint16[en+6]=vt,this.uint16[en+7]=Ot,this.int16[en+8]=Dt,this.int16[en+9]=Yt,this.int16[en+10]=pe,this.int16[en+11]=Xe,g},d}(fs);ih.prototype.bytesPerElement=24,fo("StructArrayLayout4i4ui4i24",ih);var Xc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P){var N=this.length;return this.resize(N+1),this.emplace(N,g,w,P)},d.prototype.emplace=function(g,w,P,N){var j=3*g;return this.float32[j+0]=w,this.float32[j+1]=P,this.float32[j+2]=N,g},d}(fs);Xc.prototype.bytesPerElement=12,fo("StructArrayLayout3f12",Xc);var jd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var w=this.length;return this.resize(w+1),this.emplace(w,g)},d.prototype.emplace=function(g,w){return this.uint32[1*g+0]=w,g},d}(fs);jd.prototype.bytesPerElement=4,fo("StructArrayLayout1ul4",jd);var bh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q,at,vt,Ot){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,g,w,P,N,j,q,at,vt,Ot)},d.prototype.emplace=function(g,w,P,N,j,q,at,vt,Ot,Dt){var Yt=10*g,pe=5*g;return this.int16[Yt+0]=w,this.int16[Yt+1]=P,this.int16[Yt+2]=N,this.int16[Yt+3]=j,this.int16[Yt+4]=q,this.int16[Yt+5]=at,this.uint32[pe+3]=vt,this.uint16[Yt+8]=Ot,this.uint16[Yt+9]=Dt,g},d}(fs);bh.prototype.bytesPerElement=20,fo("StructArrayLayout6i1ul2ui20",bh);var oh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q){var at=this.length;return this.resize(at+1),this.emplace(at,g,w,P,N,j,q)},d.prototype.emplace=function(g,w,P,N,j,q,at){var vt=6*g;return this.int16[vt+0]=w,this.int16[vt+1]=P,this.int16[vt+2]=N,this.int16[vt+3]=j,this.int16[vt+4]=q,this.int16[vt+5]=at,g},d}(fs);oh.prototype.bytesPerElement=12,fo("StructArrayLayout2i2i2i12",oh);var ah=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j){var q=this.length;return this.resize(q+1),this.emplace(q,g,w,P,N,j)},d.prototype.emplace=function(g,w,P,N,j,q){var at=4*g,vt=8*g;return this.float32[at+0]=w,this.float32[at+1]=P,this.float32[at+2]=N,this.int16[vt+6]=j,this.int16[vt+7]=q,g},d}(fs);ah.prototype.bytesPerElement=16,fo("StructArrayLayout2f1f2i16",ah);var Qp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N){var j=this.length;return this.resize(j+1),this.emplace(j,g,w,P,N)},d.prototype.emplace=function(g,w,P,N,j){var q=12*g,at=3*g;return this.uint8[q+0]=w,this.uint8[q+1]=P,this.float32[at+1]=N,this.float32[at+2]=j,g},d}(fs);Qp.prototype.bytesPerElement=12,fo("StructArrayLayout2ub2f12",Qp);var sh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P){var N=this.length;return this.resize(N+1),this.emplace(N,g,w,P)},d.prototype.emplace=function(g,w,P,N){var j=3*g;return this.uint16[j+0]=w,this.uint16[j+1]=P,this.uint16[j+2]=N,g},d}(fs);sh.prototype.bytesPerElement=6,fo("StructArrayLayout3ui6",sh);var Bf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr){var pr=this.length;return this.resize(pr+1),this.emplace(pr,g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr)},d.prototype.emplace=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr,pr){var xr=24*g,Ir=12*g,Wr=48*g;return this.int16[xr+0]=w,this.int16[xr+1]=P,this.uint16[xr+2]=N,this.uint16[xr+3]=j,this.uint32[Ir+2]=q,this.uint32[Ir+3]=at,this.uint32[Ir+4]=vt,this.uint16[xr+10]=Ot,this.uint16[xr+11]=Dt,this.uint16[xr+12]=Yt,this.float32[Ir+7]=pe,this.float32[Ir+8]=Xe,this.uint8[Wr+36]=en,this.uint8[Wr+37]=kn,this.uint8[Wr+38]=Sn,this.uint32[Ir+10]=sr,this.int16[xr+22]=pr,g},d}(fs);Bf.prototype.bytesPerElement=48,fo("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Bf);var Eh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr,pr,xr,Ir,Wr,Ci,Ai,To,ao,Ro,Zi,Ta){var Qo=this.length;return this.resize(Qo+1),this.emplace(Qo,g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr,pr,xr,Ir,Wr,Ci,Ai,To,ao,Ro,Zi,Ta)},d.prototype.emplace=function(g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en,kn,Sn,sr,pr,xr,Ir,Wr,Ci,Ai,To,ao,Ro,Zi,Ta,Qo){var vo=34*g,pa=17*g;return this.int16[vo+0]=w,this.int16[vo+1]=P,this.int16[vo+2]=N,this.int16[vo+3]=j,this.int16[vo+4]=q,this.int16[vo+5]=at,this.int16[vo+6]=vt,this.int16[vo+7]=Ot,this.uint16[vo+8]=Dt,this.uint16[vo+9]=Yt,this.uint16[vo+10]=pe,this.uint16[vo+11]=Xe,this.uint16[vo+12]=en,this.uint16[vo+13]=kn,this.uint16[vo+14]=Sn,this.uint16[vo+15]=sr,this.uint16[vo+16]=pr,this.uint16[vo+17]=xr,this.uint16[vo+18]=Ir,this.uint16[vo+19]=Wr,this.uint16[vo+20]=Ci,this.uint16[vo+21]=Ai,this.uint16[vo+22]=To,this.uint32[pa+12]=ao,this.float32[pa+13]=Ro,this.float32[pa+14]=Zi,this.float32[pa+15]=Ta,this.float32[pa+16]=Qo,g},d}(fs);Eh.prototype.bytesPerElement=68,fo("StructArrayLayout8i15ui1ul4f68",Eh);var Al=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var w=this.length;return this.resize(w+1),this.emplace(w,g)},d.prototype.emplace=function(g,w){return this.float32[1*g+0]=w,g},d}(fs);Al.prototype.bytesPerElement=4,fo("StructArrayLayout1f4",Al);var Qa=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P){var N=this.length;return this.resize(N+1),this.emplace(N,g,w,P)},d.prototype.emplace=function(g,w,P,N){var j=3*g;return this.int16[j+0]=w,this.int16[j+1]=P,this.int16[j+2]=N,g},d}(fs);Qa.prototype.bytesPerElement=6,fo("StructArrayLayout3i6",Qa);var ju=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P){var N=this.length;return this.resize(N+1),this.emplace(N,g,w,P)},d.prototype.emplace=function(g,w,P,N){var j=4*g;return this.uint32[2*g+0]=w,this.uint16[j+2]=P,this.uint16[j+3]=N,g},d}(fs);ju.prototype.bytesPerElement=8,fo("StructArrayLayout1ul2ui8",ju);var Jp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w){var P=this.length;return this.resize(P+1),this.emplace(P,g,w)},d.prototype.emplace=function(g,w,P){var N=2*g;return this.uint16[N+0]=w,this.uint16[N+1]=P,g},d}(fs);Jp.prototype.bytesPerElement=4,fo("StructArrayLayout2ui4",Jp);var L0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var w=this.length;return this.resize(w+1),this.emplace(w,g)},d.prototype.emplace=function(g,w){return this.uint16[1*g+0]=w,g},d}(fs);L0.prototype.bytesPerElement=2,fo("StructArrayLayout1ui2",L0);var t0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,w,P,N){var j=this.length;return this.resize(j+1),this.emplace(j,g,w,P,N)},d.prototype.emplace=function(g,w,P,N,j){var q=4*g;return this.float32[q+0]=w,this.float32[q+1]=P,this.float32[q+2]=N,this.float32[q+3]=j,g},d}(fs);t0.prototype.bytesPerElement=16,fo("StructArrayLayout4f16",t0);var _=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return g.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},g.x1.get=function(){return this._structArray.int16[this._pos2+2]},g.y1.get=function(){return this._structArray.int16[this._pos2+3]},g.x2.get=function(){return this._structArray.int16[this._pos2+4]},g.y2.get=function(){return this._structArray.int16[this._pos2+5]},g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.anchorPoint.get=function(){return new le(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,g),d}(wd);_.prototype.size=20;var E=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new _(this,g)},d}(bh);fo("CollisionBoxArray",E);var b=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},g.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},g.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},g.segment.get=function(){return this._structArray.uint16[this._pos2+10]},g.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},g.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},g.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},g.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},g.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},g.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},g.placedOrientation.set=function(w){this._structArray.uint8[this._pos1+37]=w},g.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},g.hidden.set=function(w){this._structArray.uint8[this._pos1+38]=w},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},g.crossTileID.set=function(w){this._structArray.uint32[this._pos4+10]=w},g.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,g),d}(wd);b.prototype.size=48;var A=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new b(this,g)},d}(Bf);fo("PlacedSymbolArray",A);var B=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},g.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},g.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},g.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},g.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},g.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},g.key.get=function(){return this._structArray.uint16[this._pos2+8]},g.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},g.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},g.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},g.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},g.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},g.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},g.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},g.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},g.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},g.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},g.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},g.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},g.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},g.crossTileID.set=function(w){this._structArray.uint32[this._pos4+12]=w},g.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},g.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},g.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},g.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,g),d}(wd);B.prototype.size=68;var H=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new B(this,g)},d}(Eh);fo("SymbolInstanceArray",H);var Y=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getoffsetX=function(g){return this.float32[1*g+0]},d}(Al);fo("GlyphOffsetArray",Y);var et=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getx=function(g){return this.int16[3*g+0]},d.prototype.gety=function(g){return this.int16[3*g+1]},d.prototype.gettileUnitDistanceFromAnchor=function(g){return this.int16[3*g+2]},d}(Qa);fo("SymbolLineVertexArray",et);var St=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,g),d}(wd);St.prototype.size=8;var Rt=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new St(this,g)},d}(ju);fo("FeatureIndexArray",Rt);var ye=fc([{name:"a_pos",components:2,type:"Int16"}],4).members,be=function(c){c===void 0&&(c=[]),this.segments=c};function Oe(c,d){return 256*(c=Ie(Math.floor(c),0,255))+Ie(Math.floor(d),0,255)}be.prototype.prepareSegment=function(c,d,g,w){var P=this.segments[this.segments.length-1];return c>be.MAX_VERTEX_ARRAY_LENGTH&&ke("Max vertices per segment is "+be.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+c),(!P||P.vertexLength+c>be.MAX_VERTEX_ARRAY_LENGTH||P.sortKey!==w)&&(P={vertexOffset:d.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},w!==void 0&&(P.sortKey=w),this.segments.push(P)),P},be.prototype.get=function(){return this.segments},be.prototype.destroy=function(){for(var c=0,d=this.segments;c<d.length;c+=1){var g=d[c];for(var w in g.vaos)g.vaos[w].destroy()}},be.simpleSegment=function(c,d,g,w){return new be([{vertexOffset:c,primitiveOffset:d,vertexLength:g,primitiveLength:w,vaos:{},sortKey:0}])},be.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,fo("SegmentVector",be);var on=fc([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Qe=$e(function(c){c.exports=function(d,g){var w,P,N,j,q,at,vt,Ot;for(P=d.length-(w=3&d.length),N=g,q=3432918353,at=461845907,Ot=0;Ot<P;)vt=255&d.charCodeAt(Ot)|(255&d.charCodeAt(++Ot))<<8|(255&d.charCodeAt(++Ot))<<16|(255&d.charCodeAt(++Ot))<<24,++Ot,N=27492+(65535&(j=5*(65535&(N=(N^=vt=(65535&(vt=(vt=(65535&vt)*q+(((vt>>>16)*q&65535)<<16)&4294967295)<<15|vt>>>17))*at+(((vt>>>16)*at&65535)<<16)&4294967295)<<13|N>>>19))+((5*(N>>>16)&65535)<<16)&4294967295))+((58964+(j>>>16)&65535)<<16);switch(vt=0,w){case 3:vt^=(255&d.charCodeAt(Ot+2))<<16;case 2:vt^=(255&d.charCodeAt(Ot+1))<<8;case 1:N^=vt=(65535&(vt=(vt=(65535&(vt^=255&d.charCodeAt(Ot)))*q+(((vt>>>16)*q&65535)<<16)&4294967295)<<15|vt>>>17))*at+(((vt>>>16)*at&65535)<<16)&4294967295}return N^=d.length,N=2246822507*(65535&(N^=N>>>16))+((2246822507*(N>>>16)&65535)<<16)&4294967295,N=3266489909*(65535&(N^=N>>>13))+((3266489909*(N>>>16)&65535)<<16)&4294967295,(N^=N>>>16)>>>0}}),vn=$e(function(c){c.exports=function(d,g){for(var w,P=d.length,N=g^P,j=0;P>=4;)w=1540483477*(65535&(w=255&d.charCodeAt(j)|(255&d.charCodeAt(++j))<<8|(255&d.charCodeAt(++j))<<16|(255&d.charCodeAt(++j))<<24))+((1540483477*(w>>>16)&65535)<<16),N=1540483477*(65535&N)+((1540483477*(N>>>16)&65535)<<16)^(w=1540483477*(65535&(w^=w>>>24))+((1540483477*(w>>>16)&65535)<<16)),P-=4,++j;switch(P){case 3:N^=(255&d.charCodeAt(j+2))<<16;case 2:N^=(255&d.charCodeAt(j+1))<<8;case 1:N=1540483477*(65535&(N^=255&d.charCodeAt(j)))+((1540483477*(N>>>16)&65535)<<16)}return N=1540483477*(65535&(N^=N>>>13))+((1540483477*(N>>>16)&65535)<<16),(N^=N>>>15)>>>0}}),Ye=Qe,On=vn;Ye.murmur3=Qe,Ye.murmur2=On;var jn=function(){this.ids=[],this.positions=[],this.indexed=!1};jn.prototype.add=function(c,d,g,w){this.ids.push(Or(c)),this.positions.push(d,g,w)},jn.prototype.getPositions=function(c){for(var d=Or(c),g=0,w=this.ids.length-1;g<w;){var P=g+w>>1;this.ids[P]>=d?w=P:g=P+1}for(var N=[];this.ids[g]===d;)N.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return N},jn.serialize=function(c,d){var g=new Float64Array(c.ids),w=new Uint32Array(c.positions);return function P(N,j,q,at){for(;q<at;){for(var vt=N[q+at>>1],Ot=q-1,Dt=at+1;;){do Ot++;while(N[Ot]<vt);do Dt--;while(N[Dt]>vt);if(Ot>=Dt)break;cr(N,Ot,Dt),cr(j,3*Ot,3*Dt),cr(j,3*Ot+1,3*Dt+1),cr(j,3*Ot+2,3*Dt+2)}Dt-q<at-Dt?(P(N,j,q,Dt),q=Dt+1):(P(N,j,Dt+1,at),at=Dt)}}(g,w,0,g.length-1),d&&d.push(g.buffer,w.buffer),{ids:g,positions:w}},jn.deserialize=function(c){var d=new jn;return d.ids=c.ids,d.positions=c.positions,d.indexed=!0,d};var ar=Math.pow(2,53)-1;function Or(c){var d=+c;return!isNaN(d)&&d<=ar?d:Ye(String(c))}function cr(c,d,g){var w=c[d];c[d]=c[g],c[g]=w}fo("FeaturePositionMap",jn);var kr=function(c,d){this.gl=c.gl,this.location=d},ei=function(c){function d(g,w){c.call(this,g,w),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1i(this.location,g))},d}(kr),Yr=function(c){function d(g,w){c.call(this,g,w),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1f(this.location,g))},d}(kr),Ti=function(c){function d(g,w){c.call(this,g,w),this.current=[0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]||(this.current=g,this.gl.uniform2f(this.location,g[0],g[1]))},d}(kr),zi=function(c){function d(g,w){c.call(this,g,w),this.current=[0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]||(this.current=g,this.gl.uniform3f(this.location,g[0],g[1],g[2]))},d}(kr),Io=function(c){function d(g,w){c.call(this,g,w),this.current=[0,0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]&&g[3]===this.current[3]||(this.current=g,this.gl.uniform4f(this.location,g[0],g[1],g[2],g[3]))},d}(kr),Bo=function(c){function d(g,w){c.call(this,g,w),this.current=tn.transparent}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g.r===this.current.r&&g.g===this.current.g&&g.b===this.current.b&&g.a===this.current.a||(this.current=g,this.gl.uniform4f(this.location,g.r,g.g,g.b,g.a))},d}(kr),Fo=new Float32Array(16),ua=function(c){function d(g,w){c.call(this,g,w),this.current=Fo}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){if(g[12]!==this.current[12]||g[0]!==this.current[0])return this.current=g,void this.gl.uniformMatrix4fv(this.location,!1,g);for(var w=1;w<16;w++)if(g[w]!==this.current[w]){this.current=g,this.gl.uniformMatrix4fv(this.location,!1,g);break}},d}(kr);function Tn(c){return[Oe(255*c.r,255*c.g),Oe(255*c.b,255*c.a)]}var Me=function(c,d,g){this.value=c,this.uniformNames=d.map(function(w){return"u_"+w}),this.type=g};Me.prototype.setUniform=function(c,d,g){c.set(g.constantOr(this.value))},Me.prototype.getBinding=function(c,d,g){return this.type==="color"?new Bo(c,d):new Yr(c,d)};var la=function(c,d){this.uniformNames=d.map(function(g){return"u_"+g}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};la.prototype.setConstantPatternPositions=function(c,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=c.tlbr},la.prototype.setUniform=function(c,d,g,w){var P=w==="u_pattern_to"?this.patternTo:w==="u_pattern_from"?this.patternFrom:w==="u_pixel_ratio_to"?this.pixelRatioTo:w==="u_pixel_ratio_from"?this.pixelRatioFrom:null;P&&c.set(P)},la.prototype.getBinding=function(c,d,g){return g.substr(0,9)==="u_pattern"?new Io(c,d):new Yr(c,d)};var ta=function(c,d,g,w){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(function(P){return{name:"a_"+P,type:"Float32",components:g==="color"?2:1,offset:0}}),this.paintVertexArray=new w};ta.prototype.populatePaintArray=function(c,d,g,w,P){var N=this.paintVertexArray.length,j=this.expression.evaluate(new va(0),d,{},w,[],P);this.paintVertexArray.resize(c),this._setPaintValue(N,c,j)},ta.prototype.updatePaintArray=function(c,d,g,w){var P=this.expression.evaluate({zoom:0},g,w);this._setPaintValue(c,d,P)},ta.prototype._setPaintValue=function(c,d,g){if(this.type==="color")for(var w=Tn(g),P=c;P<d;P++)this.paintVertexArray.emplace(P,w[0],w[1]);else{for(var N=c;N<d;N++)this.paintVertexArray.emplace(N,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}},ta.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Vo=function(c,d,g,w,P,N){this.expression=c,this.uniformNames=d.map(function(j){return"u_"+j+"_t"}),this.type=g,this.useIntegerZoom=w,this.zoom=P,this.maxValue=0,this.paintVertexAttributes=d.map(function(j){return{name:"a_"+j,type:"Float32",components:g==="color"?4:2,offset:0}}),this.paintVertexArray=new N};Vo.prototype.populatePaintArray=function(c,d,g,w,P){var N=this.expression.evaluate(new va(this.zoom),d,{},w,[],P),j=this.expression.evaluate(new va(this.zoom+1),d,{},w,[],P),q=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(q,c,N,j)},Vo.prototype.updatePaintArray=function(c,d,g,w){var P=this.expression.evaluate({zoom:this.zoom},g,w),N=this.expression.evaluate({zoom:this.zoom+1},g,w);this._setPaintValue(c,d,P,N)},Vo.prototype._setPaintValue=function(c,d,g,w){if(this.type==="color")for(var P=Tn(g),N=Tn(w),j=c;j<d;j++)this.paintVertexArray.emplace(j,P[0],P[1],N[0],N[1]);else{for(var q=c;q<d;q++)this.paintVertexArray.emplace(q,g,w);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(w))}},Vo.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Vo.prototype.setUniform=function(c,d){var g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,w=Ie(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(w)},Vo.prototype.getBinding=function(c,d,g){return new Yr(c,d)};var ga=function(c,d,g,w,P,N){this.expression=c,this.type=d,this.useIntegerZoom=g,this.zoom=w,this.layerId=N,this.zoomInPaintVertexArray=new P,this.zoomOutPaintVertexArray=new P};ga.prototype.populatePaintArray=function(c,d,g){var w=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(w,c,d.patterns&&d.patterns[this.layerId],g)},ga.prototype.updatePaintArray=function(c,d,g,w,P){this._setPaintValues(c,d,g.patterns&&g.patterns[this.layerId],P)},ga.prototype._setPaintValues=function(c,d,g,w){if(w&&g){var P=w[g.min],N=w[g.mid],j=w[g.max];if(P&&N&&j)for(var q=c;q<d;q++)this.zoomInPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],N.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],N.pixelRatio,j.pixelRatio)}},ga.prototype.upload=function(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,on.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,on.members,this.expression.isStateDependent))},ga.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var jo=function(c,d,g){this.binders={},this._buffers=[];var w=[];for(var P in c.paint._values)if(g(P)){var N=c.paint.get(P);if(N instanceof iu&&co(N.property.specification)){var j=hc(P,c.type),q=N.value,at=N.property.specification.type,vt=N.property.useIntegerZoom,Ot=N.property.specification["property-type"],Dt=Ot==="cross-faded"||Ot==="cross-faded-data-driven";if(q.kind==="constant")this.binders[P]=Dt?new la(q.value,j):new Me(q.value,j,at),w.push("/u_"+P);else if(q.kind==="source"||Dt){var Yt=ml(P,at,"source");this.binders[P]=Dt?new ga(q,at,vt,d,Yt,c.id):new ta(q,j,at,Yt),w.push("/a_"+P)}else{var pe=ml(P,at,"composite");this.binders[P]=new Vo(q,j,at,vt,d,pe),w.push("/z_"+P)}}}this.cacheKey=w.sort().join("")};jo.prototype.getMaxValue=function(c){var d=this.binders[c];return d instanceof ta||d instanceof Vo?d.maxValue:0},jo.prototype.populatePaintArrays=function(c,d,g,w,P){for(var N in this.binders){var j=this.binders[N];(j instanceof ta||j instanceof Vo||j instanceof ga)&&j.populatePaintArray(c,d,g,w,P)}},jo.prototype.setConstantPatternPositions=function(c,d){for(var g in this.binders){var w=this.binders[g];w instanceof la&&w.setConstantPatternPositions(c,d)}},jo.prototype.updatePaintArrays=function(c,d,g,w,P){var N=!1;for(var j in c)for(var q=0,at=d.getPositions(j);q<at.length;q+=1){var vt=at[q],Ot=g.feature(vt.index);for(var Dt in this.binders){var Yt=this.binders[Dt];if((Yt instanceof ta||Yt instanceof Vo||Yt instanceof ga)&&Yt.expression.isStateDependent===!0){var pe=w.paint.get(Dt);Yt.expression=pe.value,Yt.updatePaintArray(vt.start,vt.end,Ot,c[j],P),N=!0}}}return N},jo.prototype.defines=function(){var c=[];for(var d in this.binders){var g=this.binders[d];(g instanceof Me||g instanceof la)&&c.push.apply(c,g.uniformNames.map(function(w){return"#define HAS_UNIFORM_"+w}))}return c},jo.prototype.getBinderAttributes=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof ta||g instanceof Vo)for(var w=0;w<g.paintVertexAttributes.length;w++)c.push(g.paintVertexAttributes[w].name);else if(g instanceof ga)for(var P=0;P<on.members.length;P++)c.push(on.members[P].name)}return c},jo.prototype.getBinderUniforms=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof Me||g instanceof la||g instanceof Vo)for(var w=0,P=g.uniformNames;w<P.length;w+=1)c.push(P[w])}return c},jo.prototype.getPaintVertexBuffers=function(){return this._buffers},jo.prototype.getUniforms=function(c,d){var g=[];for(var w in this.binders){var P=this.binders[w];if(P instanceof Me||P instanceof la||P instanceof Vo)for(var N=0,j=P.uniformNames;N<j.length;N+=1){var q=j[N];if(d[q]){var at=P.getBinding(c,d[q],q);g.push({name:q,property:w,binding:at})}}}return g},jo.prototype.setUniforms=function(c,d,g,w){for(var P=0,N=d;P<N.length;P+=1){var j=N[P],q=j.name,at=j.property;this.binders[at].setUniform(j.binding,w,g.get(at),q)}},jo.prototype.updatePaintBuffers=function(c){for(var d in this._buffers=[],this.binders){var g=this.binders[d];if(c&&g instanceof ga){var w=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;w&&this._buffers.push(w)}else(g instanceof ta||g instanceof Vo)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}},jo.prototype.upload=function(c){for(var d in this.binders){var g=this.binders[d];(g instanceof ta||g instanceof Vo||g instanceof ga)&&g.upload(c)}this.updatePaintBuffers()},jo.prototype.destroy=function(){for(var c in this.binders){var d=this.binders[c];(d instanceof ta||d instanceof Vo||d instanceof ga)&&d.destroy()}};var Do=function(c,d,g){g===void 0&&(g=function(){return!0}),this.programConfigurations={};for(var w=0,P=c;w<P.length;w+=1){var N=P[w];this.programConfigurations[N.id]=new jo(N,d,g)}this.needsUpload=!1,this._featureMap=new jn,this._bufferOffset=0};function hc(c,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(d+"-","").replace(/-/g,"_")]}function ml(c,d,g){var w={color:{source:zd,composite:t0},number:{source:Al,composite:zd}},P=function(N){return{"line-pattern":{source:Gr,composite:Gr},"fill-pattern":{source:Gr,composite:Gr},"fill-extrusion-pattern":{source:Gr,composite:Gr}}[N]}(c);return P&&P[g]||w[d][g]}Do.prototype.populatePaintArrays=function(c,d,g,w,P,N){for(var j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(c,d,w,P,N);d.id!==void 0&&this._featureMap.add(d.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0},Do.prototype.updatePaintArrays=function(c,d,g,w){for(var P=0,N=g;P<N.length;P+=1){var j=N[P];this.needsUpload=this.programConfigurations[j.id].updatePaintArrays(c,this._featureMap,d,j,w)||this.needsUpload}},Do.prototype.get=function(c){return this.programConfigurations[c]},Do.prototype.upload=function(c){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}},Do.prototype.destroy=function(){for(var c in this.programConfigurations)this.programConfigurations[c].destroy()},fo("ConstantBinder",Me),fo("CrossFadedConstantBinder",la),fo("SourceExpressionBinder",ta),fo("CrossFadedCompositeBinder",ga),fo("CompositeExpressionBinder",Vo),fo("ProgramConfiguration",jo,{omit:["_buffers"]}),fo("ProgramConfigurationSet",Do);var Bc=Math.pow(2,14)-1,Wl=-Bc-1;function vs(c){for(var d=8192/c.extent,g=c.loadGeometry(),w=0;w<g.length;w++)for(var P=g[w],N=0;N<P.length;N++){var j=P[N],q=Math.round(j.x*d),at=Math.round(j.y*d);j.x=Ie(q,Wl,Bc),j.y=Ie(at,Wl,Bc),(q<j.x||q>j.x+1||at<j.y||at>j.y+1)&&ke("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return g}function Ks(c,d){return{type:c.type,id:c.id,properties:c.properties,geometry:d?vs(c):[]}}function sl(c,d,g,w,P){c.emplaceBack(2*d+(w+1)/2,2*g+(P+1)/2)}var vl=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Yh,this.indexArray=new sh,this.segments=new be,this.programConfigurations=new Do(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function _f(c,d){for(var g=0;g<c.length;g++)if(xf(d,c[g]))return!0;for(var w=0;w<d.length;w++)if(xf(c,d[w]))return!0;return!!Vd(c,d)}function ol(c,d,g){return!!xf(c,d)||!!Sh(d,c,g)}function sf(c,d){if(c.length===1)return qh(d,c[0]);for(var g=0;g<d.length;g++)for(var w=d[g],P=0;P<w.length;P++)if(xf(c,w[P]))return!0;for(var N=0;N<c.length;N++)if(qh(d,c[N]))return!0;for(var j=0;j<d.length;j++)if(Vd(c,d[j]))return!0;return!1}function Vu(c,d,g){if(c.length>1){if(Vd(c,d))return!0;for(var w=0;w<d.length;w++)if(Sh(d[w],c,g))return!0}for(var P=0;P<c.length;P++)if(Sh(c[P],d,g))return!0;return!1}function Vd(c,d){if(c.length===0||d.length===0)return!1;for(var g=0;g<c.length-1;g++)for(var w=c[g],P=c[g+1],N=0;N<d.length-1;N++)if(Ff(w,P,d[N],d[N+1]))return!0;return!1}function Ff(c,d,g,w){return Je(c,g,w)!==Je(d,g,w)&&Je(c,d,g)!==Je(c,d,w)}function Sh(c,d,g){var w=g*g;if(d.length===1)return c.distSqr(d[0])<w;for(var P=1;P<d.length;P++)if(Zd(c,d[P-1],d[P])<w)return!0;return!1}function Zd(c,d,g){var w=d.distSqr(g);if(w===0)return c.distSqr(d);var P=((c.x-d.x)*(g.x-d.x)+(c.y-d.y)*(g.y-d.y))/w;return c.distSqr(P<0?d:P>1?g:g.sub(d)._mult(P)._add(d))}function qh(c,d){for(var g,w,P,N=!1,j=0;j<c.length;j++)for(var q=0,at=(g=c[j]).length-1;q<g.length;at=q++)(w=g[q]).y>d.y!=(P=g[at]).y>d.y&&d.x<(P.x-w.x)*(d.y-w.y)/(P.y-w.y)+w.x&&(N=!N);return N}function xf(c,d){for(var g=!1,w=0,P=c.length-1;w<c.length;P=w++){var N=c[w],j=c[P];N.y>d.y!=j.y>d.y&&d.x<(j.x-N.x)*(d.y-N.y)/(j.y-N.y)+N.x&&(g=!g)}return g}function wi(c,d,g){var w=g[0],P=g[2];if(c.x<w.x&&d.x<w.x||c.x>P.x&&d.x>P.x||c.y<w.y&&d.y<w.y||c.y>P.y&&d.y>P.y)return!1;var N=Je(c,d,g[0]);return N!==Je(c,d,g[1])||N!==Je(c,d,g[2])||N!==Je(c,d,g[3])}function fl(c,d,g){var w=d.paint.get(c).value;return w.kind==="constant"?w.value:g.programConfigurations.get(d.id).getMaxValue(c)}function ya(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function gs(c,d,g,w,P){if(!d[0]&&!d[1])return c;var N=le.convert(d)._mult(P);g==="viewport"&&N._rotate(-w);for(var j=[],q=0;q<c.length;q++)j.push(c[q].sub(N));return j}vl.prototype.populate=function(c,d,g){var w=this.layers[0],P=[],N=null;w.type==="circle"&&(N=w.layout.get("circle-sort-key"));for(var j=0,q=c;j<q.length;j+=1){var at=q[j],vt=at.feature,Ot=at.id,Dt=at.index,Yt=at.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Xe=Ks(vt,pe);if(this.layers[0]._featureFilter.filter(new va(this.zoom),Xe,g)){var en=N?N.evaluate(Xe,{},g):void 0,kn={id:Ot,properties:vt.properties,type:vt.type,sourceLayerIndex:Yt,index:Dt,geometry:pe?Xe.geometry:vs(vt),patterns:{},sortKey:en};P.push(kn)}}N&&P.sort(function(Ai,To){return Ai.sortKey-To.sortKey});for(var Sn=0,sr=P;Sn<sr.length;Sn+=1){var pr=sr[Sn],xr=pr.geometry,Ir=pr.index,Wr=pr.sourceLayerIndex,Ci=c[Ir].feature;this.addFeature(pr,xr,Ir,g),d.featureIndex.insert(Ci,xr,Ir,Wr,this.index)}},vl.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},vl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},vl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vl.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ye),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},vl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vl.prototype.addFeature=function(c,d,g,w){for(var P=0,N=d;P<N.length;P+=1)for(var j=0,q=N[P];j<q.length;j+=1){var at=q[j],vt=at.x,Ot=at.y;if(!(vt<0||vt>=8192||Ot<0||Ot>=8192)){var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),Yt=Dt.vertexLength;sl(this.layoutVertexArray,vt,Ot,-1,-1),sl(this.layoutVertexArray,vt,Ot,1,-1),sl(this.layoutVertexArray,vt,Ot,1,1),sl(this.layoutVertexArray,vt,Ot,-1,1),this.indexArray.emplaceBack(Yt,Yt+1,Yt+2),this.indexArray.emplaceBack(Yt,Yt+3,Yt+2),Dt.vertexLength+=4,Dt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},w)},fo("CircleBucket",vl,{omit:["layers"]});var Bl=new ul({"circle-sort-key":new xo(ee.layout_circle["circle-sort-key"])}),Zu={paint:new ul({"circle-radius":new xo(ee.paint_circle["circle-radius"]),"circle-color":new xo(ee.paint_circle["circle-color"]),"circle-blur":new xo(ee.paint_circle["circle-blur"]),"circle-opacity":new xo(ee.paint_circle["circle-opacity"]),"circle-translate":new Ao(ee.paint_circle["circle-translate"]),"circle-translate-anchor":new Ao(ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ao(ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ao(ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xo(ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xo(ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xo(ee.paint_circle["circle-stroke-opacity"])}),layout:Bl},No=typeof Float32Array!="undefined"?Float32Array:Array;function Fl(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Xl(c,d,g){var w=d[0],P=d[1],N=d[2],j=d[3],q=d[4],at=d[5],vt=d[6],Ot=d[7],Dt=d[8],Yt=d[9],pe=d[10],Xe=d[11],en=d[12],kn=d[13],Sn=d[14],sr=d[15],pr=g[0],xr=g[1],Ir=g[2],Wr=g[3];return c[0]=pr*w+xr*q+Ir*Dt+Wr*en,c[1]=pr*P+xr*at+Ir*Yt+Wr*kn,c[2]=pr*N+xr*vt+Ir*pe+Wr*Sn,c[3]=pr*j+xr*Ot+Ir*Xe+Wr*sr,c[4]=(pr=g[4])*w+(xr=g[5])*q+(Ir=g[6])*Dt+(Wr=g[7])*en,c[5]=pr*P+xr*at+Ir*Yt+Wr*kn,c[6]=pr*N+xr*vt+Ir*pe+Wr*Sn,c[7]=pr*j+xr*Ot+Ir*Xe+Wr*sr,c[8]=(pr=g[8])*w+(xr=g[9])*q+(Ir=g[10])*Dt+(Wr=g[11])*en,c[9]=pr*P+xr*at+Ir*Yt+Wr*kn,c[10]=pr*N+xr*vt+Ir*pe+Wr*Sn,c[11]=pr*j+xr*Ot+Ir*Xe+Wr*sr,c[12]=(pr=g[12])*w+(xr=g[13])*q+(Ir=g[14])*Dt+(Wr=g[15])*en,c[13]=pr*P+xr*at+Ir*Yt+Wr*kn,c[14]=pr*N+xr*vt+Ir*pe+Wr*Sn,c[15]=pr*j+xr*Ot+Ir*Xe+Wr*sr,c}Math.hypot||(Math.hypot=function(){for(var c=arguments,d=0,g=arguments.length;g--;)d+=c[g]*c[g];return Math.sqrt(d)});var bf,Hd=Xl;function lf(c,d,g){var w=d[0],P=d[1],N=d[2],j=d[3];return c[0]=g[0]*w+g[4]*P+g[8]*N+g[12]*j,c[1]=g[1]*w+g[5]*P+g[9]*N+g[13]*j,c[2]=g[2]*w+g[6]*P+g[10]*N+g[14]*j,c[3]=g[3]*w+g[7]*P+g[11]*N+g[15]*j,c}bf=new No(3),No!=Float32Array&&(bf[0]=0,bf[1]=0,bf[2]=0),function(){var c=new No(4);No!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0)}();var Ep=(function(){var c=new No(2);No!=Float32Array&&(c[0]=0,c[1]=0)}(),function(c){function d(g){c.call(this,g,Zu)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new vl(g)},d.prototype.queryRadius=function(g){var w=g;return fl("circle-radius",this,w)+fl("circle-stroke-width",this,w)+ya(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(g,w,P,N,j,q,at,vt){for(var Ot=gs(g,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),q.angle,at),Dt=this.paint.get("circle-radius").evaluate(w,P)+this.paint.get("circle-stroke-width").evaluate(w,P),Yt=this.paint.get("circle-pitch-alignment")==="map",pe=Yt?Ot:function(Ci,Ai){return Ci.map(function(To){return Ad(To,Ai)})}(Ot,vt),Xe=Yt?Dt*at:Dt,en=0,kn=N;en<kn.length;en+=1)for(var Sn=0,sr=kn[en];Sn<sr.length;Sn+=1){var pr=sr[Sn],xr=Yt?pr:Ad(pr,vt),Ir=Xe,Wr=lf([],[pr.x,pr.y,0,1],vt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ir*=Wr[3]/q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ir*=q.cameraToCenterDistance/Wr[3]),ol(pe,xr,Ir))return!0}return!1},d}(Wc));function Ad(c,d){var g=lf([],[c.x,c.y,0,1],d);return new le(g[0]/g[3],g[1]/g[3])}var Is=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(vl);function cf(c,d,g,w){var P=d.width,N=d.height;if(w){if(w instanceof Uint8ClampedArray)w=new Uint8Array(w.buffer);else if(w.length!==P*N*g)throw new RangeError("mismatched image size")}else w=new Uint8Array(P*N*g);return c.width=P,c.height=N,c.data=w,c}function lh(c,d,g){var w=d.width,P=d.height;if(w!==c.width||P!==c.height){var N=cf({},{width:w,height:P},g);D0(c,N,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,w),height:Math.min(c.height,P)},g),c.width=w,c.height=P,c.data=N.data}}function D0(c,d,g,w,P,N){if(P.width===0||P.height===0)return d;if(P.width>c.width||P.height>c.height||g.x>c.width-P.width||g.y>c.height-P.height)throw new RangeError("out of range source coordinates for image copy");if(P.width>d.width||P.height>d.height||w.x>d.width-P.width||w.y>d.height-P.height)throw new RangeError("out of range destination coordinates for image copy");for(var j=c.data,q=d.data,at=0;at<P.height;at++)for(var vt=((g.y+at)*c.width+g.x)*N,Ot=((w.y+at)*d.width+w.x)*N,Dt=0;Dt<P.width*N;Dt++)q[Ot+Dt]=j[vt+Dt];return d}fo("HeatmapBucket",Is,{omit:["layers"]});var io=function(c,d){cf(this,c,1,d)};io.prototype.resize=function(c){lh(this,c,1)},io.prototype.clone=function(){return new io({width:this.width,height:this.height},new Uint8Array(this.data))},io.copy=function(c,d,g,w,P){D0(c,d,g,w,P,1)};var gu=function(c,d){cf(this,c,4,d)};gu.prototype.resize=function(c){lh(this,c,4)},gu.prototype.replace=function(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c},gu.prototype.clone=function(){return new gu({width:this.width,height:this.height},new Uint8Array(this.data))},gu.copy=function(c,d,g,w,P){D0(c,d,g,w,P,4)},fo("AlphaImage",io),fo("RGBAImage",gu);var ty={paint:new ul({"heatmap-radius":new xo(ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xo(ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ao(ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new rh(ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ao(ee.paint_heatmap["heatmap-opacity"])})};function lm(c){var d={},g=c.resolution||256,w=c.clips?c.clips.length:1,P=c.image||new gu({width:g,height:w}),N=function(Xe,en,kn){d[c.evaluationKey]=kn;var Sn=c.expression.evaluate(d);P.data[Xe+en+0]=Math.floor(255*Sn.r/Sn.a),P.data[Xe+en+1]=Math.floor(255*Sn.g/Sn.a),P.data[Xe+en+2]=Math.floor(255*Sn.b/Sn.a),P.data[Xe+en+3]=Math.floor(255*Sn.a)};if(c.clips)for(var j=0,q=0;j<w;++j,q+=4*g)for(var at=0,vt=0;at<g;at++,vt+=4){var Ot=at/(g-1),Dt=c.clips[j];N(q,vt,Dt.start*(1-Ot)+Dt.end*Ot)}else for(var Yt=0,pe=0;Yt<g;Yt++,pe+=4)N(0,pe,Yt/(g-1));return P}var Sp=function(c){function d(g){c.call(this,g,ty),this._updateColorRamp()}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Is(g)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=lm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(Wc),ey={paint:new ul({"hillshade-illumination-direction":new Ao(ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ao(ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ao(ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ao(ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ao(ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ao(ee.paint_hillshade["hillshade-accent-color"])})},Wv=function(c){function d(g){c.call(this,g,ey)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(Wc),ny=fc([{name:"a_pos",components:2,type:"Int16"}],4).members,cm=N0,um=N0;function N0(c,d,g){g=g||2;var w,P,N,j,q,at,vt,Ot=d&&d.length,Dt=Ot?d[0]*g:c.length,Yt=ry(c,0,Dt,g,!0),pe=[];if(!Yt||Yt.next===Yt.prev)return pe;if(Ot&&(Yt=function(en,kn,Sn,sr){var pr,xr,Ir,Wr=[];for(pr=0,xr=kn.length;pr<xr;pr++)(Ir=ry(en,kn[pr]*sr,pr<xr-1?kn[pr+1]*sr:en.length,sr,!1))===Ir.next&&(Ir.steiner=!0),Wr.push(k0(Ir));for(Wr.sort(e0),pr=0;pr<Wr.length;pr++)$h(Wr[pr],Sn),Sn=Tp(Sn,Sn.next);return Sn}(c,d,Yt,g)),c.length>80*g){w=N=c[0],P=j=c[1];for(var Xe=g;Xe<Dt;Xe+=g)(q=c[Xe])<w&&(w=q),(at=c[Xe+1])<P&&(P=at),q>N&&(N=q),at>j&&(j=at);vt=(vt=Math.max(N-w,j-P))!==0?1/vt:0}return wp(Yt,pe,g,w,P,vt),pe}function ry(c,d,g,w,P){var N,j;if(P===n0(c,d,g,w)>0)for(N=d;N<g;N+=w)j=Qh(N,c[N],c[N+1],j);else for(N=g-w;N>=d;N-=w)j=Qh(N,c[N],c[N+1],j);return j&&Ef(j,j.next)&&(gl(j),j=j.next),j}function Tp(c,d){if(!c)return c;d||(d=c);var g,w=c;do if(g=!1,w.steiner||!Ef(w,w.next)&&Qs(w.prev,w,w.next)!==0)w=w.next;else{if(gl(w),(w=d=w.prev)===w.next)break;g=!0}while(g||w!==d);return d}function wp(c,d,g,w,P,N,j){if(c){!j&&N&&function(Ot,Dt,Yt,pe){var Xe=Ot;do Xe.z===null&&(Xe.z=Kh(Xe.x,Xe.y,Dt,Yt,pe)),Xe.prevZ=Xe.prev,Xe.nextZ=Xe.next,Xe=Xe.next;while(Xe!==Ot);Xe.prevZ.nextZ=null,Xe.prevZ=null,function(en){var kn,Sn,sr,pr,xr,Ir,Wr,Ci,Ai=1;do{for(Sn=en,en=null,xr=null,Ir=0;Sn;){for(Ir++,sr=Sn,Wr=0,kn=0;kn<Ai&&(Wr++,sr=sr.nextZ);kn++);for(Ci=Ai;Wr>0||Ci>0&&sr;)Wr!==0&&(Ci===0||!sr||Sn.z<=sr.z)?(pr=Sn,Sn=Sn.nextZ,Wr--):(pr=sr,sr=sr.nextZ,Ci--),xr?xr.nextZ=pr:en=pr,pr.prevZ=xr,xr=pr;Sn=sr}xr.nextZ=null,Ai*=2}while(Ir>1)}(Xe)}(c,w,P,N);for(var q,at,vt=c;c.prev!==c.next;)if(q=c.prev,at=c.next,N?ev(c,w,P,N):tv(c))d.push(q.i/g),d.push(c.i/g),d.push(at.i/g),gl(c),c=at.next,vt=at.next;else if((c=at)===vt){j?j===1?wp(c=iy(Tp(c),d,g),d,g,w,P,N,2):j===2&&Gd(c,d,g,w,P,N):wp(Tp(c),d,g,w,P,N,1);break}}}function tv(c){var d=c.prev,g=c,w=c.next;if(Qs(d,g,w)>=0)return!1;for(var P=c.next.next;P!==c.prev;){if(Yc(d.x,d.y,g.x,g.y,w.x,w.y,P.x,P.y)&&Qs(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function ev(c,d,g,w){var P=c.prev,N=c,j=c.next;if(Qs(P,N,j)>=0)return!1;for(var q=P.x>N.x?P.x>j.x?P.x:j.x:N.x>j.x?N.x:j.x,at=P.y>N.y?P.y>j.y?P.y:j.y:N.y>j.y?N.y:j.y,vt=Kh(P.x<N.x?P.x<j.x?P.x:j.x:N.x<j.x?N.x:j.x,P.y<N.y?P.y<j.y?P.y:j.y:N.y<j.y?N.y:j.y,d,g,w),Ot=Kh(q,at,d,g,w),Dt=c.prevZ,Yt=c.nextZ;Dt&&Dt.z>=vt&&Yt&&Yt.z<=Ot;){if(Dt!==c.prev&&Dt!==c.next&&Yc(P.x,P.y,N.x,N.y,j.x,j.y,Dt.x,Dt.y)&&Qs(Dt.prev,Dt,Dt.next)>=0||(Dt=Dt.prevZ,Yt!==c.prev&&Yt!==c.next&&Yc(P.x,P.y,N.x,N.y,j.x,j.y,Yt.x,Yt.y)&&Qs(Yt.prev,Yt,Yt.next)>=0))return!1;Yt=Yt.nextZ}for(;Dt&&Dt.z>=vt;){if(Dt!==c.prev&&Dt!==c.next&&Yc(P.x,P.y,N.x,N.y,j.x,j.y,Dt.x,Dt.y)&&Qs(Dt.prev,Dt,Dt.next)>=0)return!1;Dt=Dt.prevZ}for(;Yt&&Yt.z<=Ot;){if(Yt!==c.prev&&Yt!==c.next&&Yc(P.x,P.y,N.x,N.y,j.x,j.y,Yt.x,Yt.y)&&Qs(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.nextZ}return!0}function iy(c,d,g){var w=c;do{var P=w.prev,N=w.next.next;!Ef(P,N)&&B0(P,w,w.next,N)&&dc(P,N)&&dc(N,P)&&(d.push(P.i/g),d.push(w.i/g),d.push(N.i/g),gl(w),gl(w.next),w=c=N),w=w.next}while(w!==c);return Tp(w)}function Gd(c,d,g,w,P,N){var j=c;do{for(var q=j.next.next;q!==j.prev;){if(j.i!==q.i&&Ap(j,q)){var at=Xd(j,q);return j=Tp(j,j.next),at=Tp(at,at.next),wp(j,d,g,w,P,N),void wp(at,d,g,w,P,N)}q=q.next}j=j.next}while(j!==c)}function e0(c,d){return c.x-d.x}function $h(c,d){if(d=function(w,P){var N,j=P,q=w.x,at=w.y,vt=-1/0;do{if(at<=j.y&&at>=j.next.y&&j.next.y!==j.y){var Ot=j.x+(at-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(Ot<=q&&Ot>vt){if(vt=Ot,Ot===q){if(at===j.y)return j;if(at===j.next.y)return j.next}N=j.x<j.next.x?j:j.next}}j=j.next}while(j!==P);if(!N)return null;if(q===vt)return N;var Dt,Yt=N,pe=N.x,Xe=N.y,en=1/0;j=N;do q>=j.x&&j.x>=pe&&q!==j.x&&Yc(at<Xe?q:vt,at,pe,Xe,at<Xe?vt:q,at,j.x,j.y)&&(Dt=Math.abs(at-j.y)/(q-j.x),dc(j,w)&&(Dt<en||Dt===en&&(j.x>N.x||j.x===N.x&&nv(N,j)))&&(N=j,en=Dt)),j=j.next;while(j!==Yt);return N}(c,d)){var g=Xd(d,c);Tp(d,d.next),Tp(g,g.next)}}function nv(c,d){return Qs(c.prev,c,d.prev)<0&&Qs(d.next,c,c.next)<0}function Kh(c,d,g,w,P){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-g)*P)|c<<8))|c<<4))|c<<2))|c<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-w)*P)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function k0(c){var d=c,g=c;do(d.x<g.x||d.x===g.x&&d.y<g.y)&&(g=d),d=d.next;while(d!==c);return g}function Yc(c,d,g,w,P,N,j,q){return(P-j)*(d-q)-(c-j)*(N-q)>=0&&(c-j)*(w-q)-(g-j)*(d-q)>=0&&(g-j)*(N-q)-(P-j)*(w-q)>=0}function Ap(c,d){return c.next.i!==d.i&&c.prev.i!==d.i&&!function(g,w){var P=g;do{if(P.i!==g.i&&P.next.i!==g.i&&P.i!==w.i&&P.next.i!==w.i&&B0(P,P.next,g,w))return!0;P=P.next}while(P!==g);return!1}(c,d)&&(dc(c,d)&&dc(d,c)&&function(g,w){var P=g,N=!1,j=(g.x+w.x)/2,q=(g.y+w.y)/2;do P.y>q!=P.next.y>q&&P.next.y!==P.y&&j<(P.next.x-P.x)*(q-P.y)/(P.next.y-P.y)+P.x&&(N=!N),P=P.next;while(P!==g);return N}(c,d)&&(Qs(c.prev,c,d.prev)||Qs(c,d.prev,d))||Ef(c,d)&&Qs(c.prev,c,c.next)>0&&Qs(d.prev,d,d.next)>0)}function Qs(c,d,g){return(d.y-c.y)*(g.x-d.x)-(d.x-c.x)*(g.y-d.y)}function Ef(c,d){return c.x===d.x&&c.y===d.y}function B0(c,d,g,w){var P=Op(Qs(c,d,g)),N=Op(Qs(c,d,w)),j=Op(Qs(g,w,c)),q=Op(Qs(g,w,d));return P!==N&&j!==q||!(P!==0||!Wd(c,g,d))||!(N!==0||!Wd(c,w,d))||!(j!==0||!Wd(g,c,w))||!(q!==0||!Wd(g,d,w))}function Wd(c,d,g){return d.x<=Math.max(c.x,g.x)&&d.x>=Math.min(c.x,g.x)&&d.y<=Math.max(c.y,g.y)&&d.y>=Math.min(c.y,g.y)}function Op(c){return c>0?1:c<0?-1:0}function dc(c,d){return Qs(c.prev,c,c.next)<0?Qs(c,d,c.next)>=0&&Qs(c,c.prev,d)>=0:Qs(c,d,c.prev)<0||Qs(c,c.next,d)<0}function Xd(c,d){var g=new Cp(c.i,c.x,c.y),w=new Cp(d.i,d.x,d.y),P=c.next,N=d.prev;return c.next=d,d.prev=c,g.next=P,P.prev=g,w.next=g,g.prev=w,N.next=w,w.prev=N,w}function Qh(c,d,g,w){var P=new Cp(c,d,g);return w?(P.next=w.next,P.prev=w,w.next.prev=P,w.next=P):(P.prev=P,P.next=P),P}function gl(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Cp(c,d,g){this.i=c,this.x=d,this.y=g,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function n0(c,d,g,w){for(var P=0,N=d,j=g-w;N<g;N+=w)P+=(c[j]-c[N])*(c[N+1]+c[j+1]),j=N;return P}function fm(c,d,g,w,P){(function N(j,q,at,vt,Ot){for(;vt>at;){if(vt-at>600){var Dt=vt-at+1,Yt=q-at+1,pe=Math.log(Dt),Xe=.5*Math.exp(2*pe/3),en=.5*Math.sqrt(pe*Xe*(Dt-Xe)/Dt)*(Yt-Dt/2<0?-1:1);N(j,q,Math.max(at,Math.floor(q-Yt*Xe/Dt+en)),Math.min(vt,Math.floor(q+(Dt-Yt)*Xe/Dt+en)),Ot)}var kn=j[q],Sn=at,sr=vt;for(Th(j,at,q),Ot(j[vt],kn)>0&&Th(j,at,vt);Sn<sr;){for(Th(j,Sn,sr),Sn++,sr--;Ot(j[Sn],kn)<0;)Sn++;for(;Ot(j[sr],kn)>0;)sr--}Ot(j[at],kn)===0?Th(j,at,sr):Th(j,++sr,vt),sr<=q&&(at=sr+1),q<=sr&&(vt=sr-1)}})(c,d,g||0,w||c.length-1,P||su)}function Th(c,d,g){var w=c[d];c[d]=c[g],c[g]=w}function su(c,d){return c<d?-1:c>d?1:0}function yu(c,d){var g=c.length;if(g<=1)return[c];for(var w,P,N=[],j=0;j<g;j++){var q=er(c[j]);q!==0&&(c[j].area=Math.abs(q),P===void 0&&(P=q<0),P===q<0?(w&&N.push(w),w=[c[j]]):w.push(c[j]))}if(w&&N.push(w),d>1)for(var at=0;at<N.length;at++)N[at].length<=d||(fm(N[at],d,1,N[at].length-1,r0),N[at]=N[at].slice(0,d));return N}function r0(c,d){return d.area-c.area}function i0(c,d,g){for(var w=g.patternDependencies,P=!1,N=0,j=d;N<j.length;N+=1){var q=j[N].paint.get(c+"-pattern");q.isConstant()||(P=!0);var at=q.constantOr(null);at&&(P=!0,w[at.to]=!0,w[at.from]=!0)}return P}function Rp(c,d,g,w,P){for(var N=P.patternDependencies,j=0,q=d;j<q.length;j+=1){var at=q[j],vt=at.paint.get(c+"-pattern").value;if(vt.kind!=="constant"){var Ot=vt.evaluate({zoom:w-1},g,{},P.availableImages),Dt=vt.evaluate({zoom:w},g,{},P.availableImages),Yt=vt.evaluate({zoom:w+1},g,{},P.availableImages);Dt=Dt&&Dt.name?Dt.name:Dt,Yt=Yt&&Yt.name?Yt.name:Yt,N[Ot=Ot&&Ot.name?Ot.name:Ot]=!0,N[Dt]=!0,N[Yt]=!0,g.patterns[at.id]={min:Ot,mid:Dt,max:Yt}}}return g}N0.deviation=function(c,d,g,w){var P=d&&d.length,N=Math.abs(n0(c,0,P?d[0]*g:c.length,g));if(P)for(var j=0,q=d.length;j<q;j++)N-=Math.abs(n0(c,d[j]*g,j<q-1?d[j+1]*g:c.length,g));var at=0;for(j=0;j<w.length;j+=3){var vt=w[j]*g,Ot=w[j+1]*g,Dt=w[j+2]*g;at+=Math.abs((c[vt]-c[Dt])*(c[Ot+1]-c[vt+1])-(c[vt]-c[Ot])*(c[Dt+1]-c[vt+1]))}return N===0&&at===0?0:Math.abs((at-N)/N)},N0.flatten=function(c){for(var d=c[0][0].length,g={vertices:[],holes:[],dimensions:d},w=0,P=0;P<c.length;P++){for(var N=0;N<c[P].length;N++)for(var j=0;j<d;j++)g.vertices.push(c[P][N][j]);P>0&&g.holes.push(w+=c[P-1].length)}return g},cm.default=um;var Sf=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yh,this.indexArray=new sh,this.indexArray2=new Jp,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new be,this.segments2=new be,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Sf.prototype.populate=function(c,d,g){this.hasPattern=i0("fill",this.layers,d);for(var w=this.layers[0].layout.get("fill-sort-key"),P=[],N=0,j=c;N<j.length;N+=1){var q=j[N],at=q.feature,vt=q.id,Ot=q.index,Dt=q.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,pe=Ks(at,Yt);if(this.layers[0]._featureFilter.filter(new va(this.zoom),pe,g)){var Xe=w?w.evaluate(pe,{},g,d.availableImages):void 0,en={id:vt,properties:at.properties,type:at.type,sourceLayerIndex:Dt,index:Ot,geometry:Yt?pe.geometry:vs(at),patterns:{},sortKey:Xe};P.push(en)}}w&&P.sort(function(Ci,Ai){return Ci.sortKey-Ai.sortKey});for(var kn=0,Sn=P;kn<Sn.length;kn+=1){var sr=Sn[kn],pr=sr.geometry,xr=sr.index,Ir=sr.sourceLayerIndex;if(this.hasPattern){var Wr=Rp("fill",this.layers,sr,this.zoom,d);this.patternFeatures.push(Wr)}else this.addFeature(sr,pr,xr,g,{});d.featureIndex.insert(c[xr].feature,pr,xr,Ir,this.index)}},Sf.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Sf.prototype.addFeatures=function(c,d,g){for(var w=0,P=this.patternFeatures;w<P.length;w+=1){var N=P[w];this.addFeature(N,N.geometry,N.index,d,g)}},Sf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Sf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Sf.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ny),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0},Sf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Sf.prototype.addFeature=function(c,d,g,w,P){for(var N=0,j=yu(d,500);N<j.length;N+=1){for(var q=j[N],at=0,vt=0,Ot=q;vt<Ot.length;vt+=1)at+=Ot[vt].length;for(var Dt=this.segments.prepareSegment(at,this.layoutVertexArray,this.indexArray),Yt=Dt.vertexLength,pe=[],Xe=[],en=0,kn=q;en<kn.length;en+=1){var Sn=kn[en];if(Sn.length!==0){Sn!==q[0]&&Xe.push(pe.length/2);var sr=this.segments2.prepareSegment(Sn.length,this.layoutVertexArray,this.indexArray2),pr=sr.vertexLength;this.layoutVertexArray.emplaceBack(Sn[0].x,Sn[0].y),this.indexArray2.emplaceBack(pr+Sn.length-1,pr),pe.push(Sn[0].x),pe.push(Sn[0].y);for(var xr=1;xr<Sn.length;xr++)this.layoutVertexArray.emplaceBack(Sn[xr].x,Sn[xr].y),this.indexArray2.emplaceBack(pr+xr-1,pr+xr),pe.push(Sn[xr].x),pe.push(Sn[xr].y);sr.vertexLength+=Sn.length,sr.primitiveLength+=Sn.length}}for(var Ir=cm(pe,Xe),Wr=0;Wr<Ir.length;Wr+=3)this.indexArray.emplaceBack(Yt+Ir[Wr],Yt+Ir[Wr+1],Yt+Ir[Wr+2]);Dt.vertexLength+=at,Dt.primitiveLength+=Ir.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,w)},fo("FillBucket",Sf,{omit:["layers","patternFeatures"]});var Od=new ul({"fill-sort-key":new xo(ee.layout_fill["fill-sort-key"])}),oy={paint:new ul({"fill-antialias":new Ao(ee.paint_fill["fill-antialias"]),"fill-opacity":new xo(ee.paint_fill["fill-opacity"]),"fill-color":new xo(ee.paint_fill["fill-color"]),"fill-outline-color":new xo(ee.paint_fill["fill-outline-color"]),"fill-translate":new Ao(ee.paint_fill["fill-translate"]),"fill-translate-anchor":new Ao(ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new zu(ee.paint_fill["fill-pattern"])}),layout:Od},ay=function(c){function d(g){c.call(this,g,oy)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,w){c.prototype.recalculate.call(this,g,w);var P=this.paint._values["fill-outline-color"];P.value.kind==="constant"&&P.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(g){return new Sf(g)},d.prototype.queryRadius=function(){return ya(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(g,w,P,N,j,q,at){return sf(gs(g,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),q.angle,at),N)},d.prototype.isTileClipped=function(){return!0},d}(Wc),rv=fc([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,F0=Jh;function Jh(c,d,g,w,P){this.properties={},this.extent=g,this.type=0,this._pbf=c,this._geometry=-1,this._keys=w,this._values=P,c.readFields(hm,this,d)}function hm(c,d,g){c==1?d.id=g.readVarint():c==2?function(w,P){for(var N=w.readVarint()+w.pos;w.pos<N;){var j=P._keys[w.readVarint()],q=P._values[w.readVarint()];P.properties[j]=q}}(g,d):c==3?d.type=g.readVarint():c==4&&(d._geometry=g.pos)}function Uf(c){for(var d,g,w=0,P=0,N=c.length,j=N-1;P<N;j=P++)w+=((g=c[j]).x-(d=c[P]).x)*(d.y+g.y);return w}Jh.types=["Unknown","Point","LineString","Polygon"],Jh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d,g=c.readVarint()+c.pos,w=1,P=0,N=0,j=0,q=[];c.pos<g;){if(P<=0){var at=c.readVarint();w=7&at,P=at>>3}if(P--,w===1||w===2)N+=c.readSVarint(),j+=c.readSVarint(),w===1&&(d&&q.push(d),d=[]),d.push(new le(N,j));else{if(w!==7)throw new Error("unknown command "+w);d&&d.push(d[0].clone())}}return d&&q.push(d),q},Jh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,g=1,w=0,P=0,N=0,j=1/0,q=-1/0,at=1/0,vt=-1/0;c.pos<d;){if(w<=0){var Ot=c.readVarint();g=7&Ot,w=Ot>>3}if(w--,g===1||g===2)(P+=c.readSVarint())<j&&(j=P),P>q&&(q=P),(N+=c.readSVarint())<at&&(at=N),N>vt&&(vt=N);else if(g!==7)throw new Error("unknown command "+g)}return[j,at,q,vt]},Jh.prototype.toGeoJSON=function(c,d,g){var w,P,N=this.extent*Math.pow(2,g),j=this.extent*c,q=this.extent*d,at=this.loadGeometry(),vt=Jh.types[this.type];function Ot(pe){for(var Xe=0;Xe<pe.length;Xe++){var en=pe[Xe];pe[Xe]=[360*(en.x+j)/N-180,360/Math.PI*Math.atan(Math.exp((180-360*(en.y+q)/N)*Math.PI/180))-90]}}switch(this.type){case 1:var Dt=[];for(w=0;w<at.length;w++)Dt[w]=at[w][0];Ot(at=Dt);break;case 2:for(w=0;w<at.length;w++)Ot(at[w]);break;case 3:for(at=function(pe){var Xe=pe.length;if(Xe<=1)return[pe];for(var en,kn,Sn=[],sr=0;sr<Xe;sr++){var pr=Uf(pe[sr]);pr!==0&&(kn===void 0&&(kn=pr<0),kn===pr<0?(en&&Sn.push(en),en=[pe[sr]]):en.push(pe[sr]))}return en&&Sn.push(en),Sn}(at),w=0;w<at.length;w++)for(P=0;P<at[w].length;P++)Ot(at[w][P])}at.length===1?at=at[0]:vt="Multi"+vt;var Yt={type:"Feature",geometry:{type:vt,coordinates:at},properties:this.properties};return"id"in this&&(Yt.id=this.id),Yt};var o0=Yd;function Yd(c,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(qd,this,d),this.length=this._features.length}function qd(c,d,g){c===15?d.version=g.readVarint():c===1?d.name=g.readString():c===5?d.extent=g.readVarint():c===2?d._features.push(g.pos):c===3?d._keys.push(g.readString()):c===4&&d._values.push(function(w){for(var P=null,N=w.readVarint()+w.pos;w.pos<N;){var j=w.readVarint()>>3;P=j===1?w.readString():j===2?w.readFloat():j===3?w.readDouble():j===4?w.readVarint64():j===5?w.readVarint():j===6?w.readSVarint():j===7?w.readBoolean():null}return P}(g))}function iv(c,d,g){if(c===3){var w=new o0(g,g.readVarint()+g.pos);w.length&&(d[w.name]=w)}}Yd.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var d=this._pbf.readVarint()+this._pbf.pos;return new F0(this._pbf,d,this.extent,this._keys,this._values)};var wh={VectorTile:function(c,d){this.layers=c.readFields(iv,{},d)},VectorTileFeature:F0,VectorTileLayer:o0},a0=wh.VectorTileFeature.types,Mp=Math.pow(2,13);function _u(c,d,g,w,P,N,j,q){c.emplaceBack(d,g,2*Math.floor(w*Mp)+j,P*Mp*2,N*Mp*2,Math.round(q))}var lu=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new xh,this.indexArray=new sh,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new be,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function pc(c,d){return c.x===d.x&&(c.x<0||c.x>8192)||c.y===d.y&&(c.y<0||c.y>8192)}lu.prototype.populate=function(c,d,g){this.features=[],this.hasPattern=i0("fill-extrusion",this.layers,d);for(var w=0,P=c;w<P.length;w+=1){var N=P[w],j=N.feature,q=N.id,at=N.index,vt=N.sourceLayerIndex,Ot=this.layers[0]._featureFilter.needGeometry,Dt=Ks(j,Ot);if(this.layers[0]._featureFilter.filter(new va(this.zoom),Dt,g)){var Yt={id:q,sourceLayerIndex:vt,index:at,geometry:Ot?Dt.geometry:vs(j),properties:j.properties,type:j.type,patterns:{}};this.hasPattern?this.features.push(Rp("fill-extrusion",this.layers,Yt,this.zoom,d)):this.addFeature(Yt,Yt.geometry,at,g,{}),d.featureIndex.insert(j,Yt.geometry,at,vt,this.index,!0)}}},lu.prototype.addFeatures=function(c,d,g){for(var w=0,P=this.features;w<P.length;w+=1){var N=P[w];this.addFeature(N,N.geometry,N.index,d,g)}},lu.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},lu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},lu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},lu.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,rv),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},lu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},lu.prototype.addFeature=function(c,d,g,w,P){for(var N=0,j=yu(d,500);N<j.length;N+=1){for(var q=j[N],at=0,vt=0,Ot=q;vt<Ot.length;vt+=1)at+=Ot[vt].length;for(var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Yt=0,pe=q;Yt<pe.length;Yt+=1){var Xe=pe[Yt];if(Xe.length!==0&&!((pa=Xe).every(function(Ca){return Ca.x<0})||pa.every(function(Ca){return Ca.x>8192})||pa.every(function(Ca){return Ca.y<0})||pa.every(function(Ca){return Ca.y>8192})))for(var en=0,kn=0;kn<Xe.length;kn++){var Sn=Xe[kn];if(kn>=1){var sr=Xe[kn-1];if(!pc(Sn,sr)){Dt.vertexLength+4>be.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var pr=Sn.sub(sr)._perp()._unit(),xr=sr.dist(Sn);en+xr>32768&&(en=0),_u(this.layoutVertexArray,Sn.x,Sn.y,pr.x,pr.y,0,0,en),_u(this.layoutVertexArray,Sn.x,Sn.y,pr.x,pr.y,0,1,en),_u(this.layoutVertexArray,sr.x,sr.y,pr.x,pr.y,0,0,en+=xr),_u(this.layoutVertexArray,sr.x,sr.y,pr.x,pr.y,0,1,en);var Ir=Dt.vertexLength;this.indexArray.emplaceBack(Ir,Ir+2,Ir+1),this.indexArray.emplaceBack(Ir+1,Ir+2,Ir+3),Dt.vertexLength+=4,Dt.primitiveLength+=2}}}}if(Dt.vertexLength+at>be.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(at,this.layoutVertexArray,this.indexArray)),a0[c.type]==="Polygon"){for(var Wr=[],Ci=[],Ai=Dt.vertexLength,To=0,ao=q;To<ao.length;To+=1){var Ro=ao[To];if(Ro.length!==0){Ro!==q[0]&&Ci.push(Wr.length/2);for(var Zi=0;Zi<Ro.length;Zi++){var Ta=Ro[Zi];_u(this.layoutVertexArray,Ta.x,Ta.y,0,0,1,1,0),Wr.push(Ta.x),Wr.push(Ta.y)}}}for(var Qo=cm(Wr,Ci),vo=0;vo<Qo.length;vo+=3)this.indexArray.emplaceBack(Ai+Qo[vo],Ai+Qo[vo+2],Ai+Qo[vo+1]);Dt.primitiveLength+=Qo.length/3,Dt.vertexLength+=at}}var pa;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,w)},fo("FillExtrusionBucket",lu,{omit:["layers","features"]});var Hu={paint:new ul({"fill-extrusion-opacity":new Ao(ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xo(ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ao(ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ao(ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zu(ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xo(ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xo(ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ao(ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},xu=function(c){function d(g){c.call(this,g,Hu)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new lu(g)},d.prototype.queryRadius=function(){return ya(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(g,w,P,N,j,q,at,vt){var Ot=gs(g,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),q.angle,at),Dt=this.paint.get("fill-extrusion-height").evaluate(w,P),Yt=this.paint.get("fill-extrusion-base").evaluate(w,P),pe=function(en,kn,Sn,sr){for(var pr=[],xr=0,Ir=en;xr<Ir.length;xr+=1){var Wr=Ir[xr],Ci=[Wr.x,Wr.y,0,1];lf(Ci,Ci,kn),pr.push(new le(Ci[0]/Ci[3],Ci[1]/Ci[3]))}return pr}(Ot,vt),Xe=function(en,kn,Sn,sr){for(var pr=[],xr=[],Ir=sr[8]*kn,Wr=sr[9]*kn,Ci=sr[10]*kn,Ai=sr[11]*kn,To=sr[8]*Sn,ao=sr[9]*Sn,Ro=sr[10]*Sn,Zi=sr[11]*Sn,Ta=0,Qo=en;Ta<Qo.length;Ta+=1){for(var vo=[],pa=[],Ca=0,Ja=Qo[Ta];Ca<Ja.length;Ca+=1){var Ho=Ja[Ca],Ts=Ho.x,_l=Ho.y,zl=sr[0]*Ts+sr[4]*_l+sr[12],jl=sr[1]*Ts+sr[5]*_l+sr[13],xl=sr[2]*Ts+sr[6]*_l+sr[14],nc=sr[3]*Ts+sr[7]*_l+sr[15],Vs=xl+Ci,wc=nc+Ai,Xu=zl+To,Uc=jl+ao,uu=xl+Ro,Vl=nc+Zi,zc=new le((zl+Ir)/wc,(jl+Wr)/wc);zc.z=Vs/wc,vo.push(zc);var Ka=new le(Xu/Vl,Uc/Vl);Ka.z=uu/Vl,pa.push(Ka)}pr.push(vo),xr.push(pa)}return[pr,xr]}(N,Yt,Dt,vt);return function(en,kn,Sn){var sr=1/0;sf(Sn,kn)&&(sr=dm(Sn,kn[0]));for(var pr=0;pr<kn.length;pr++)for(var xr=kn[pr],Ir=en[pr],Wr=0;Wr<xr.length-1;Wr++){var Ci=xr[Wr],Ai=[Ci,xr[Wr+1],Ir[Wr+1],Ir[Wr],Ci];_f(Sn,Ai)&&(sr=Math.min(sr,dm(Sn,Ai)))}return sr!==1/0&&sr}(Xe[0],Xe[1],pe)},d}(Wc);function Pp(c,d){return c.x*d.x+c.y*d.y}function dm(c,d){if(c.length===1){for(var g,w=0,P=d[w++];!g||P.equals(g);)if(!(g=d[w++]))return 1/0;for(;w<d.length;w++){var N=d[w],j=c[0],q=g.sub(P),at=N.sub(P),vt=j.sub(P),Ot=Pp(q,q),Dt=Pp(q,at),Yt=Pp(at,at),pe=Pp(vt,q),Xe=Pp(vt,at),en=Ot*Yt-Dt*Dt,kn=(Yt*pe-Dt*Xe)/en,Sn=(Ot*Xe-Dt*pe)/en,sr=P.z*(1-kn-Sn)+g.z*kn+N.z*Sn;if(isFinite(sr))return sr}return 1/0}for(var pr=1/0,xr=0,Ir=d;xr<Ir.length;xr+=1)pr=Math.min(pr,Ir[xr].z);return pr}var A_=fc([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Xv=fc([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,U0=wh.VectorTileFeature.types,z0=Math.cos(Math.PI/180*37.5),ov=Math.pow(2,14)/.5,cu=function(c){var d=this;this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(g){d.gradients[g.id]={}}),this.layoutVertexArray=new au,this.layoutVertexArray2=new zd,this.indexArray=new sh,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new be,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id})};cu.prototype.populate=function(c,d,g){this.hasPattern=i0("line",this.layers,d);for(var w=this.layers[0].layout.get("line-sort-key"),P=[],N=0,j=c;N<j.length;N+=1){var q=j[N],at=q.feature,vt=q.id,Ot=q.index,Dt=q.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,pe=Ks(at,Yt);if(this.layers[0]._featureFilter.filter(new va(this.zoom),pe,g)){var Xe=w?w.evaluate(pe,{},g):void 0,en={id:vt,properties:at.properties,type:at.type,sourceLayerIndex:Dt,index:Ot,geometry:Yt?pe.geometry:vs(at),patterns:{},sortKey:Xe};P.push(en)}}w&&P.sort(function(Ci,Ai){return Ci.sortKey-Ai.sortKey});for(var kn=0,Sn=P;kn<Sn.length;kn+=1){var sr=Sn[kn],pr=sr.geometry,xr=sr.index,Ir=sr.sourceLayerIndex;if(this.hasPattern){var Wr=Rp("line",this.layers,sr,this.zoom,d);this.patternFeatures.push(Wr)}else this.addFeature(sr,pr,xr,g,{});d.featureIndex.insert(c[xr].feature,pr,xr,Ir,this.index)}},cu.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},cu.prototype.addFeatures=function(c,d,g){for(var w=0,P=this.patternFeatures;w<P.length;w+=1){var N=P[w];this.addFeature(N,N.geometry,N.index,d,g)}},cu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},cu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},cu.prototype.upload=function(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,Xv)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,A_),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},cu.prototype.lineFeatureClips=function(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}},cu.prototype.addFeature=function(c,d,g,w,P){var N=this.layers[0].layout,j=N.get("line-join").evaluate(c,{}),q=N.get("line-cap"),at=N.get("line-miter-limit"),vt=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(var Ot=0,Dt=d;Ot<Dt.length;Ot+=1)this.addLine(Dt[Ot],c,j,q,at,vt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,w)},cu.prototype.addLine=function(c,d,g,w,P,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var j=0;j<c.length-1;j++)this.totalDistance+=c[j].dist(c[j+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var q=U0[d.type]==="Polygon",at=c.length;at>=2&&c[at-1].equals(c[at-2]);)at--;for(var vt=0;vt<at-1&&c[vt].equals(c[vt+1]);)vt++;if(!(at<(q?3:2))){g==="bevel"&&(P=1.05);var Ot,Dt=this.overscaling<=16?122880/(512*this.overscaling):0,Yt=this.segments.prepareSegment(10*at,this.layoutVertexArray,this.indexArray),pe=void 0,Xe=void 0,en=void 0,kn=void 0;this.e1=this.e2=-1,q&&(kn=c[vt].sub(Ot=c[at-2])._unit()._perp());for(var Sn=vt;Sn<at;Sn++)if(!(Xe=Sn===at-1?q?c[vt+1]:void 0:c[Sn+1])||!c[Sn].equals(Xe)){kn&&(en=kn),Ot&&(pe=Ot),Ot=c[Sn],kn=Xe?Xe.sub(Ot)._unit()._perp():en;var sr=(en=en||kn).add(kn);sr.x===0&&sr.y===0||sr._unit();var pr=en.x*kn.x+en.y*kn.y,xr=sr.x*kn.x+sr.y*kn.y,Ir=xr!==0?1/xr:1/0,Wr=2*Math.sqrt(2-2*xr),Ci=xr<z0&&pe&&Xe,Ai=en.x*kn.y-en.y*kn.x>0;if(Ci&&Sn>vt){var To=Ot.dist(pe);if(To>2*Dt){var ao=Ot.sub(Ot.sub(pe)._mult(Dt/To)._round());this.updateDistance(pe,ao),this.addCurrentVertex(ao,en,0,0,Yt),pe=ao}}var Ro=pe&&Xe,Zi=Ro?g:q?"butt":w;if(Ro&&Zi==="round"&&(Ir<N?Zi="miter":Ir<=2&&(Zi="fakeround")),Zi==="miter"&&Ir>P&&(Zi="bevel"),Zi==="bevel"&&(Ir>2&&(Zi="flipbevel"),Ir<P&&(Zi="miter")),pe&&this.updateDistance(pe,Ot),Zi==="miter")sr._mult(Ir),this.addCurrentVertex(Ot,sr,0,0,Yt);else if(Zi==="flipbevel"){if(Ir>100)sr=kn.mult(-1);else{var Ta=Ir*en.add(kn).mag()/en.sub(kn).mag();sr._perp()._mult(Ta*(Ai?-1:1))}this.addCurrentVertex(Ot,sr,0,0,Yt),this.addCurrentVertex(Ot,sr.mult(-1),0,0,Yt)}else if(Zi==="bevel"||Zi==="fakeround"){var Qo=-Math.sqrt(Ir*Ir-1),vo=Ai?Qo:0,pa=Ai?0:Qo;if(pe&&this.addCurrentVertex(Ot,en,vo,pa,Yt),Zi==="fakeround")for(var Ca=Math.round(180*Wr/Math.PI/20),Ja=1;Ja<Ca;Ja++){var Ho=Ja/Ca;if(Ho!==.5){var Ts=Ho-.5;Ho+=Ho*Ts*(Ho-1)*((1.0904+pr*(pr*(3.55645-1.43519*pr)-3.2452))*Ts*Ts+(.848013+pr*(.215638*pr-1.06021)))}var _l=kn.sub(en)._mult(Ho)._add(en)._unit()._mult(Ai?-1:1);this.addHalfVertex(Ot,_l.x,_l.y,!1,Ai,0,Yt)}Xe&&this.addCurrentVertex(Ot,kn,-vo,-pa,Yt)}else if(Zi==="butt")this.addCurrentVertex(Ot,sr,0,0,Yt);else if(Zi==="square"){var zl=pe?1:-1;this.addCurrentVertex(Ot,sr,zl,zl,Yt)}else Zi==="round"&&(pe&&(this.addCurrentVertex(Ot,en,0,0,Yt),this.addCurrentVertex(Ot,en,1,1,Yt,!0)),Xe&&(this.addCurrentVertex(Ot,kn,-1,-1,Yt,!0),this.addCurrentVertex(Ot,kn,0,0,Yt)));if(Ci&&Sn<at-1){var jl=Ot.dist(Xe);if(jl>2*Dt){var xl=Ot.add(Xe.sub(Ot)._mult(Dt/jl)._round());this.updateDistance(Ot,xl),this.addCurrentVertex(xl,kn,0,0,Yt),Ot=xl}}}}},cu.prototype.addCurrentVertex=function(c,d,g,w,P,N){N===void 0&&(N=!1);var j=d.y*w-d.x,q=-d.y-d.x*w;this.addHalfVertex(c,d.x+d.y*g,d.y-d.x*g,N,!1,g,P),this.addHalfVertex(c,j,q,N,!0,-w,P),this.distance>ov/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(c,d,g,w,P,N))},cu.prototype.addHalfVertex=function(c,d,g,w,P,N,j){var q=.5*(this.lineClips?this.scaledDistance*(ov-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c.x<<1)+(w?1:0),(c.y<<1)+(P?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(N===0?0:N<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var at=j.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,at),j.primitiveLength++),P?this.e2=at:this.e1=at},cu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},cu.prototype.updateDistance=function(c,d){this.distance+=c.dist(d),this.updateScaledDistance()},fo("LineBucket",cu,{omit:["layers","patternFeatures"]});var pm=new ul({"line-cap":new Ao(ee.layout_line["line-cap"]),"line-join":new xo(ee.layout_line["line-join"]),"line-miter-limit":new Ao(ee.layout_line["line-miter-limit"]),"line-round-limit":new Ao(ee.layout_line["line-round-limit"]),"line-sort-key":new xo(ee.layout_line["line-sort-key"])}),Ol={paint:new ul({"line-opacity":new xo(ee.paint_line["line-opacity"]),"line-color":new xo(ee.paint_line["line-color"]),"line-translate":new Ao(ee.paint_line["line-translate"]),"line-translate-anchor":new Ao(ee.paint_line["line-translate-anchor"]),"line-width":new xo(ee.paint_line["line-width"]),"line-gap-width":new xo(ee.paint_line["line-gap-width"]),"line-offset":new xo(ee.paint_line["line-offset"]),"line-blur":new xo(ee.paint_line["line-blur"]),"line-dasharray":new ou(ee.paint_line["line-dasharray"]),"line-pattern":new zu(ee.paint_line["line-pattern"]),"line-gradient":new rh(ee.paint_line["line-gradient"])}),layout:pm},Gu=new(function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,w){return w=new va(Math.floor(w.zoom),{now:w.now,fadeDuration:w.fadeDuration,zoomHistory:w.zoomHistory,transition:w.transition}),c.prototype.possiblyEvaluate.call(this,g,w)},d.prototype.evaluate=function(g,w,P,N){return w=ce({},w,{zoom:Math.floor(w.zoom)}),c.prototype.evaluate.call(this,g,w,P,N)},d}(xo))(Ol.paint.properties["line-width"].specification);Gu.useIntegerZoom=!0;var Ah=function(c){function d(g){c.call(this,g,Ol),this.gradientVersion=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ac,this.gradientVersion=(this.gradientVersion+1)%fn)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(g,w){c.prototype.recalculate.call(this,g,w),this.paint._values["line-floorwidth"]=Gu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)},d.prototype.createBucket=function(g){return new cu(g)},d.prototype.queryRadius=function(g){var w=g,P=Oh(fl("line-width",this,w),fl("line-gap-width",this,w)),N=fl("line-offset",this,w);return P/2+Math.abs(N)+ya(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(g,w,P,N,j,q,at){var vt=gs(g,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),q.angle,at),Ot=at/2*Oh(this.paint.get("line-width").evaluate(w,P),this.paint.get("line-gap-width").evaluate(w,P)),Dt=this.paint.get("line-offset").evaluate(w,P);return Dt&&(N=function(Yt,pe){for(var Xe=[],en=new le(0,0),kn=0;kn<Yt.length;kn++){for(var Sn=Yt[kn],sr=[],pr=0;pr<Sn.length;pr++){var xr=Sn[pr],Ir=Sn[pr+1],Wr=pr===0?en:xr.sub(Sn[pr-1])._unit()._perp(),Ci=pr===Sn.length-1?en:Ir.sub(xr)._unit()._perp(),Ai=Wr._add(Ci)._unit();Ai._mult(1/(Ai.x*Ci.x+Ai.y*Ci.y)),sr.push(Ai._mult(pe)._add(xr))}Xe.push(sr)}return Xe}(N,Dt*at)),function(Yt,pe,Xe){for(var en=0;en<pe.length;en++){var kn=pe[en];if(Yt.length>=3){for(var Sn=0;Sn<kn.length;Sn++)if(xf(Yt,kn[Sn]))return!0}if(Vu(Yt,kn,Xe))return!0}return!1}(vt,N,Ot)},d.prototype.isTileClipped=function(){return!0},d}(Wc);function Oh(c,d){return d>0?d+2*c:c}var av=fc([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yv=fc([{name:"a_projected_pos",components:3,type:"Float32"}],4),qv=(fc([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),fc([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),$v=(fc([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),fc([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),xt=fc([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Pe(c,d,g){return c.sections.forEach(function(w){w.text=function(P,N,j){var q=N.layout.get("text-transform").evaluate(j,{});return q==="uppercase"?P=P.toLocaleUpperCase():q==="lowercase"&&(P=P.toLocaleLowerCase()),vu.applyArabicShaping&&(P=vu.applyArabicShaping(P)),P}(w.text,d,g)}),c}fc([{name:"triangle",components:3,type:"Uint16"}]),fc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fc([{type:"Float32",name:"offsetX"}]),fc([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var gn={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Cr=function(c,d,g,w,P){var N,j,q=8*P-w-1,at=(1<<q)-1,vt=at>>1,Ot=-7,Dt=g?P-1:0,Yt=g?-1:1,pe=c[d+Dt];for(Dt+=Yt,N=pe&(1<<-Ot)-1,pe>>=-Ot,Ot+=q;Ot>0;N=256*N+c[d+Dt],Dt+=Yt,Ot-=8);for(j=N&(1<<-Ot)-1,N>>=-Ot,Ot+=w;Ot>0;j=256*j+c[d+Dt],Dt+=Yt,Ot-=8);if(N===0)N=1-vt;else{if(N===at)return j?NaN:1/0*(pe?-1:1);j+=Math.pow(2,w),N-=vt}return(pe?-1:1)*j*Math.pow(2,N-w)},Hr=function(c,d,g,w,P,N){var j,q,at,vt=8*N-P-1,Ot=(1<<vt)-1,Dt=Ot>>1,Yt=P===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=w?0:N-1,Xe=w?1:-1,en=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(q=isNaN(d)?1:0,j=Ot):(j=Math.floor(Math.log(d)/Math.LN2),d*(at=Math.pow(2,-j))<1&&(j--,at*=2),(d+=j+Dt>=1?Yt/at:Yt*Math.pow(2,1-Dt))*at>=2&&(j++,at/=2),j+Dt>=Ot?(q=0,j=Ot):j+Dt>=1?(q=(d*at-1)*Math.pow(2,P),j+=Dt):(q=d*Math.pow(2,Dt-1)*Math.pow(2,P),j=0));P>=8;c[g+pe]=255&q,pe+=Xe,q/=256,P-=8);for(j=j<<P|q,vt+=P;vt>0;c[g+pe]=255&j,pe+=Xe,j/=256,vt-=8);c[g+pe-Xe]|=128*en},Rr=gr;function gr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}gr.Varint=0,gr.Fixed64=1,gr.Bytes=2,gr.Fixed32=5;var bi=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function li(c){return c.type===gr.Bytes?c.readVarint()+c.pos:c.pos+1}function Di(c,d,g){return g?4294967296*d+(c>>>0):4294967296*(d>>>0)+(c>>>0)}function Oi(c,d,g){var w=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));g.realloc(w);for(var P=g.pos-1;P>=c;P--)g.buf[P+w]=g.buf[P]}function Mi(c,d){for(var g=0;g<c.length;g++)d.writeVarint(c[g])}function Gi(c,d){for(var g=0;g<c.length;g++)d.writeSVarint(c[g])}function hi(c,d){for(var g=0;g<c.length;g++)d.writeFloat(c[g])}function Pi(c,d){for(var g=0;g<c.length;g++)d.writeDouble(c[g])}function ur(c,d){for(var g=0;g<c.length;g++)d.writeBoolean(c[g])}function Lr(c,d){for(var g=0;g<c.length;g++)d.writeFixed32(c[g])}function gi(c,d){for(var g=0;g<c.length;g++)d.writeSFixed32(c[g])}function to(c,d){for(var g=0;g<c.length;g++)d.writeFixed64(c[g])}function ri(c,d){for(var g=0;g<c.length;g++)d.writeSFixed64(c[g])}function oo(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+16777216*c[d+3]}function yi(c,d,g){c[g]=d,c[g+1]=d>>>8,c[g+2]=d>>>16,c[g+3]=d>>>24}function eo(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+(c[d+3]<<24)}function oi(c,d,g){c===1&&g.readMessage(Yi,d)}function Yi(c,d,g){if(c===3){var w=g.readMessage(ko,{}),P=w.width,N=w.height,j=w.left,q=w.top,at=w.advance;d.push({id:w.id,bitmap:new io({width:P+6,height:N+6},w.bitmap),metrics:{width:P,height:N,left:j,top:q,advance:at}})}}function ko(c,d,g){c===1?d.id=g.readVarint():c===2?d.bitmap=g.readBytes():c===3?d.width=g.readVarint():c===4?d.height=g.readVarint():c===5?d.left=g.readSVarint():c===6?d.top=g.readSVarint():c===7&&(d.advance=g.readVarint())}function fa(c){for(var d=0,g=0,w=0,P=c;w<P.length;w+=1){var N=P[w];d+=N.w*N.h,g=Math.max(g,N.w)}c.sort(function(en,kn){return kn.h-en.h});for(var j=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),g),h:1/0}],q=0,at=0,vt=0,Ot=c;vt<Ot.length;vt+=1)for(var Dt=Ot[vt],Yt=j.length-1;Yt>=0;Yt--){var pe=j[Yt];if(!(Dt.w>pe.w||Dt.h>pe.h)){if(Dt.x=pe.x,Dt.y=pe.y,at=Math.max(at,Dt.y+Dt.h),q=Math.max(q,Dt.x+Dt.w),Dt.w===pe.w&&Dt.h===pe.h){var Xe=j.pop();Yt<j.length&&(j[Yt]=Xe)}else Dt.h===pe.h?(pe.x+=Dt.w,pe.w-=Dt.w):Dt.w===pe.w?(pe.y+=Dt.h,pe.h-=Dt.h):(j.push({x:pe.x+Dt.w,y:pe.y,w:pe.w-Dt.w,h:Dt.h}),pe.y+=Dt.h,pe.h-=Dt.h);break}}return{w:q,h:at,fill:d/(q*at)||0}}gr.prototype={destroy:function(){this.buf=null},readFields:function(c,d,g){for(g=g||this.length;this.pos<g;){var w=this.readVarint(),P=w>>3,N=this.pos;this.type=7&w,c(P,d,this),this.pos===N&&this.skip(w)}return d},readMessage:function(c,d){return this.readFields(c,d,this.readVarint()+this.pos)},readFixed32:function(){var c=oo(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=eo(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=oo(this.buf,this.pos)+4294967296*oo(this.buf,this.pos+4);return this.pos+=8,c},readSFixed64:function(){var c=oo(this.buf,this.pos)+4294967296*eo(this.buf,this.pos+4);return this.pos+=8,c},readFloat:function(){var c=Cr(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=Cr(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var d,g,w=this.buf;return d=127&(g=w[this.pos++]),g<128?d:(d|=(127&(g=w[this.pos++]))<<7,g<128?d:(d|=(127&(g=w[this.pos++]))<<14,g<128?d:(d|=(127&(g=w[this.pos++]))<<21,g<128?d:function(P,N,j){var q,at,vt=j.buf;if(q=(112&(at=vt[j.pos++]))>>4,at<128||(q|=(127&(at=vt[j.pos++]))<<3,at<128)||(q|=(127&(at=vt[j.pos++]))<<10,at<128)||(q|=(127&(at=vt[j.pos++]))<<17,at<128)||(q|=(127&(at=vt[j.pos++]))<<24,at<128)||(q|=(1&(at=vt[j.pos++]))<<31,at<128))return Di(P,q,N);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(g=w[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,d=this.pos;return this.pos=c,c-d>=12&&bi?function(g,w,P){return bi.decode(g.subarray(w,P))}(this.buf,d,c):function(g,w,P){for(var N="",j=w;j<P;){var q,at,vt,Ot=g[j],Dt=null,Yt=Ot>239?4:Ot>223?3:Ot>191?2:1;if(j+Yt>P)break;Yt===1?Ot<128&&(Dt=Ot):Yt===2?(192&(q=g[j+1]))==128&&(Dt=(31&Ot)<<6|63&q)<=127&&(Dt=null):Yt===3?(at=g[j+2],(192&(q=g[j+1]))==128&&(192&at)==128&&((Dt=(15&Ot)<<12|(63&q)<<6|63&at)<=2047||Dt>=55296&&Dt<=57343)&&(Dt=null)):Yt===4&&(at=g[j+2],vt=g[j+3],(192&(q=g[j+1]))==128&&(192&at)==128&&(192&vt)==128&&((Dt=(15&Ot)<<18|(63&q)<<12|(63&at)<<6|63&vt)<=65535||Dt>=1114112)&&(Dt=null)),Dt===null?(Dt=65533,Yt=1):Dt>65535&&(Dt-=65536,N+=String.fromCharCode(Dt>>>10&1023|55296),Dt=56320|1023&Dt),N+=String.fromCharCode(Dt),j+=Yt}return N}(this.buf,d,c)},readBytes:function(){var c=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,c);return this.pos=c,d},readPackedVarint:function(c,d){if(this.type!==gr.Bytes)return c.push(this.readVarint(d));var g=li(this);for(c=c||[];this.pos<g;)c.push(this.readVarint(d));return c},readPackedSVarint:function(c){if(this.type!==gr.Bytes)return c.push(this.readSVarint());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==gr.Bytes)return c.push(this.readBoolean());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==gr.Bytes)return c.push(this.readFloat());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==gr.Bytes)return c.push(this.readDouble());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==gr.Bytes)return c.push(this.readFixed32());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==gr.Bytes)return c.push(this.readSFixed32());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==gr.Bytes)return c.push(this.readFixed64());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==gr.Bytes)return c.push(this.readSFixed64());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed64());return c},skip:function(c){var d=7&c;if(d===gr.Varint)for(;this.buf[this.pos++]>127;);else if(d===gr.Bytes)this.pos=this.readVarint()+this.pos;else if(d===gr.Fixed32)this.pos+=4;else{if(d!==gr.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(c,d){this.writeVarint(c<<3|d)},realloc:function(c){for(var d=this.length||16;d<this.pos+c;)d*=2;if(d!==this.length){var g=new Uint8Array(d);g.set(this.buf),this.buf=g,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),yi(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),yi(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),yi(this.buf,-1&c,this.pos),yi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),yi(this.buf,-1&c,this.pos),yi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(d,g){var w,P;if(d>=0?(w=d%4294967296|0,P=d/4294967296|0):(P=~(-d/4294967296),4294967295^(w=~(-d%4294967296))?w=w+1|0:(w=0,P=P+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(N,j,q){q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,q.buf[q.pos]=127&(N>>>=7)}(w,0,g),function(N,j){var q=(7&N)<<4;j.buf[j.pos++]|=q|((N>>>=3)?128:0),N&&(j.buf[j.pos++]=127&N|((N>>>=7)?128:0),N&&(j.buf[j.pos++]=127&N|((N>>>=7)?128:0),N&&(j.buf[j.pos++]=127&N|((N>>>=7)?128:0),N&&(j.buf[j.pos++]=127&N|((N>>>=7)?128:0),N&&(j.buf[j.pos++]=127&N)))))}(P,g)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var d=this.pos;this.pos=function(w,P,N){for(var j,q,at=0;at<P.length;at++){if((j=P.charCodeAt(at))>55295&&j<57344){if(!q){j>56319||at+1===P.length?(w[N++]=239,w[N++]=191,w[N++]=189):q=j;continue}if(j<56320){w[N++]=239,w[N++]=191,w[N++]=189,q=j;continue}j=q-55296<<10|j-56320|65536,q=null}else q&&(w[N++]=239,w[N++]=191,w[N++]=189,q=null);j<128?w[N++]=j:(j<2048?w[N++]=j>>6|192:(j<65536?w[N++]=j>>12|224:(w[N++]=j>>18|240,w[N++]=j>>12&63|128),w[N++]=j>>6&63|128),w[N++]=63&j|128)}return N}(this.buf,c,this.pos);var g=this.pos-d;g>=128&&Oi(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g},writeFloat:function(c){this.realloc(4),Hr(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),Hr(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var d=c.length;this.writeVarint(d),this.realloc(d);for(var g=0;g<d;g++)this.buf[this.pos++]=c[g]},writeRawMessage:function(c,d){this.pos++;var g=this.pos;c(d,this);var w=this.pos-g;w>=128&&Oi(g,w,this),this.pos=g-1,this.writeVarint(w),this.pos+=w},writeMessage:function(c,d,g){this.writeTag(c,gr.Bytes),this.writeRawMessage(d,g)},writePackedVarint:function(c,d){d.length&&this.writeMessage(c,Mi,d)},writePackedSVarint:function(c,d){d.length&&this.writeMessage(c,Gi,d)},writePackedBoolean:function(c,d){d.length&&this.writeMessage(c,ur,d)},writePackedFloat:function(c,d){d.length&&this.writeMessage(c,hi,d)},writePackedDouble:function(c,d){d.length&&this.writeMessage(c,Pi,d)},writePackedFixed32:function(c,d){d.length&&this.writeMessage(c,Lr,d)},writePackedSFixed32:function(c,d){d.length&&this.writeMessage(c,gi,d)},writePackedFixed64:function(c,d){d.length&&this.writeMessage(c,to,d)},writePackedSFixed64:function(c,d){d.length&&this.writeMessage(c,ri,d)},writeBytesField:function(c,d){this.writeTag(c,gr.Bytes),this.writeBytes(d)},writeFixed32Field:function(c,d){this.writeTag(c,gr.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(c,d){this.writeTag(c,gr.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(c,d){this.writeTag(c,gr.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(c,d){this.writeTag(c,gr.Fixed64),this.writeSFixed64(d)},writeVarintField:function(c,d){this.writeTag(c,gr.Varint),this.writeVarint(d)},writeSVarintField:function(c,d){this.writeTag(c,gr.Varint),this.writeSVarint(d)},writeStringField:function(c,d){this.writeTag(c,gr.Bytes),this.writeString(d)},writeFloatField:function(c,d){this.writeTag(c,gr.Fixed32),this.writeFloat(d)},writeDoubleField:function(c,d){this.writeTag(c,gr.Fixed64),this.writeDouble(d)},writeBooleanField:function(c,d){this.writeVarintField(c,!!d)}};var $i=function(c,d){var g=d.pixelRatio,w=d.version,P=d.stretchX,N=d.stretchY,j=d.content;this.paddedRect=c,this.pixelRatio=g,this.stretchX=P,this.stretchY=N,this.content=j,this.version=w},_i={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};_i.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},_i.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},_i.tlbr.get=function(){return this.tl.concat(this.br)},_i.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties($i.prototype,_i);var qr=function(c,d){var g={},w={};this.haveRenderCallbacks=[];var P=[];this.addImages(c,g,P),this.addImages(d,w,P);var N=fa(P),j=new gu({width:N.w||1,height:N.h||1});for(var q in c){var at=c[q],vt=g[q].paddedRect;gu.copy(at.data,j,{x:0,y:0},{x:vt.x+1,y:vt.y+1},at.data)}for(var Ot in d){var Dt=d[Ot],Yt=w[Ot].paddedRect,pe=Yt.x+1,Xe=Yt.y+1,en=Dt.data.width,kn=Dt.data.height;gu.copy(Dt.data,j,{x:0,y:0},{x:pe,y:Xe},Dt.data),gu.copy(Dt.data,j,{x:0,y:kn-1},{x:pe,y:Xe-1},{width:en,height:1}),gu.copy(Dt.data,j,{x:0,y:0},{x:pe,y:Xe+kn},{width:en,height:1}),gu.copy(Dt.data,j,{x:en-1,y:0},{x:pe-1,y:Xe},{width:1,height:kn}),gu.copy(Dt.data,j,{x:0,y:0},{x:pe+en,y:Xe},{width:1,height:kn})}this.image=j,this.iconPositions=g,this.patternPositions=w};qr.prototype.addImages=function(c,d,g){for(var w in c){var P=c[w],N={x:0,y:0,w:P.data.width+2,h:P.data.height+2};g.push(N),d[w]=new $i(N,P),P.hasRenderCallback&&this.haveRenderCallbacks.push(w)}},qr.prototype.patchUpdatedImages=function(c,d){for(var g in c.dispatchRenderCallbacks(this.haveRenderCallbacks),c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),d)},qr.prototype.patchUpdatedImage=function(c,d,g){if(c&&d&&c.version!==d.version){c.version=d.version;var w=c.tl;g.update(d.data,void 0,{x:w[0],y:w[1]})}},fo("ImagePosition",$i),fo("ImageAtlas",qr);var Uo={horizontal:1,vertical:2,horizontalOnly:3},Ua=function(){this.scale=1,this.fontStack="",this.imageName=null};Ua.forText=function(c,d){var g=new Ua;return g.scale=c||1,g.fontStack=d,g},Ua.forImage=function(c){var d=new Ua;return d.imageName=c,d};var lo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function La(c,d,g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en){var kn,Sn=lo.fromFeature(c,P);Dt===Uo.vertical&&Sn.verticalizePunctuation();var sr=vu.processBidirectionalText,pr=vu.processStyledBidirectionalText;if(sr&&Sn.sections.length===1){kn=[];for(var xr=0,Ir=sr(Sn.toString(),hl(Sn,vt,N,d,w,pe,Xe));xr<Ir.length;xr+=1){var Wr=Ir[xr],Ci=new lo;Ci.text=Wr,Ci.sections=Sn.sections;for(var Ai=0;Ai<Wr.length;Ai++)Ci.sectionIndex.push(0);kn.push(Ci)}}else if(pr){kn=[];for(var To=0,ao=pr(Sn.text,Sn.sectionIndex,hl(Sn,vt,N,d,w,pe,Xe));To<ao.length;To+=1){var Ro=ao[To],Zi=new lo;Zi.text=Ro[0],Zi.sectionIndex=Ro[1],Zi.sections=Sn.sections,kn.push(Zi)}}else kn=function(vo,pa){for(var Ca=[],Ja=vo.text,Ho=0,Ts=0,_l=pa;Ts<_l.length;Ts+=1){var zl=_l[Ts];Ca.push(vo.substring(Ho,zl)),Ho=zl}return Ho<Ja.length&&Ca.push(vo.substring(Ho,Ja.length)),Ca}(Sn,hl(Sn,vt,N,d,w,pe,Xe));var Ta=[],Qo={positionedLines:Ta,text:Sn.toString(),top:Ot[1],bottom:Ot[1],left:Ot[0],right:Ot[0],writingMode:Dt,iconsInText:!1,verticalizable:!1};return function(vo,pa,Ca,Ja,Ho,Ts,_l,zl,jl,xl,nc,Vs){for(var wc=0,Xu=-17,Uc=0,uu=0,Vl=zl==="right"?1:zl==="left"?0:.5,zc=0,Ka=0,Xs=Ho;Ka<Xs.length;Ka+=1){var Fs=Xs[Ka];Fs.trim();var ds=Fs.getMaxScale(),Yu=24*(ds-1),fu={positionedGlyphs:[],lineOffset:0};vo.positionedLines[zc]=fu;var Us=fu.positionedGlyphs,rc=0;if(Fs.length()){for(var Ac=0;Ac<Fs.length();Ac++){var is=Fs.getSection(Ac),qu=Fs.getSectionIndex(Ac),zf=Fs.getCharCode(Ac),Jd=0,ic=null,uh=null,Tf=null,tp=24,td=!(jl===Uo.horizontal||!nc&&!Sd(zf)||nc&&(ha[zf]||(nd=zf,Ri.Arabic(nd)||Ri["Arabic Supplement"](nd)||Ri["Arabic Extended-A"](nd)||Ri["Arabic Presentation Forms-A"](nd)||Ri["Arabic Presentation Forms-B"](nd))));if(is.imageName){var c0=Ja[is.imageName];if(!c0)continue;Tf=is.imageName,vo.iconsInText=vo.iconsInText||!0,uh=c0.paddedRect;var ed=c0.displaySize;is.scale=24*is.scale/Vs,Jd=Yu+(24-ed[1]*is.scale),tp=(ic={width:ed[0],height:ed[1],left:1,top:-3,advance:td?ed[1]:ed[0]}).advance;var u0=td?ed[0]*is.scale-24*ds:ed[1]*is.scale-24*ds;u0>0&&u0>rc&&(rc=u0)}else{var vm=Ca[is.fontStack],f0=vm&&vm[zf];if(f0&&f0.rect)uh=f0.rect,ic=f0.metrics;else{var gm=pa[is.fontStack],ng=gm&&gm[zf];if(!ng)continue;ic=ng.metrics}Jd=24*(ds-is.scale)}td?(vo.verticalizable=!0,Us.push({glyph:zf,imageName:Tf,x:wc,y:Xu+Jd,vertical:td,scale:is.scale,fontStack:is.fontStack,sectionIndex:qu,metrics:ic,rect:uh}),wc+=tp*is.scale+xl):(Us.push({glyph:zf,imageName:Tf,x:wc,y:Xu+Jd,vertical:td,scale:is.scale,fontStack:is.fontStack,sectionIndex:qu,metrics:ic,rect:uh}),wc+=ic.advance*is.scale+xl)}Us.length!==0&&(Uc=Math.max(wc-xl,Uc),Yl(Us,0,Us.length-1,Vl,rc)),wc=0;var uy=Ts*ds+rc;fu.lineOffset=Math.max(rc,Yu),Xu+=uy,uu=Math.max(uy,uu),++zc}else Xu+=Ts,++zc}var nd,Dp=Xu- -17,j0=Js(_l),rd=j0.horizontalAlign,Np=j0.verticalAlign;(function(lv,rg,ym,kp,h0,_m,cv,xm,uv){var V0,Bp=(rg-ym)*h0;V0=_m!==cv?-xm*kp- -17:(-kp*uv+.5)*cv;for(var Fp=0,d0=lv;Fp<d0.length;Fp+=1)for(var ep=0,p0=d0[Fp].positionedGlyphs;ep<p0.length;ep+=1){var Up=p0[ep];Up.x+=Bp,Up.y+=V0}})(vo.positionedLines,Vl,rd,Np,Uc,uu,Ts,Dp,Ho.length),vo.top+=-Np*Dp,vo.bottom=vo.top+Dp,vo.left+=-rd*Uc,vo.right=vo.left+Uc}(Qo,d,g,w,kn,j,q,at,Dt,vt,Yt,en),!function(vo){for(var pa=0,Ca=vo;pa<Ca.length;pa+=1)if(Ca[pa].positionedGlyphs.length!==0)return!1;return!0}(Ta)&&Qo}lo.fromFeature=function(c,d){for(var g=new lo,w=0;w<c.sections.length;w++){var P=c.sections[w];P.image?g.addImageSection(P):g.addTextSection(P,d)}return g},lo.prototype.length=function(){return this.text.length},lo.prototype.getSection=function(c){return this.sections[this.sectionIndex[c]]},lo.prototype.getSectionIndex=function(c){return this.sectionIndex[c]},lo.prototype.getCharCode=function(c){return this.text.charCodeAt(c)},lo.prototype.verticalizePunctuation=function(){this.text=function(c){for(var d="",g=0;g<c.length;g++){var w=c.charCodeAt(g+1)||null,P=c.charCodeAt(g-1)||null;d+=w&&qp(w)&&!gn[c[g+1]]||P&&qp(P)&&!gn[c[g-1]]||!gn[c[g]]?c[g]:gn[c[g]]}return d}(this.text)},lo.prototype.trim=function(){for(var c=0,d=0;d<this.text.length&&ha[this.text.charCodeAt(d)];d++)c++;for(var g=this.text.length,w=this.text.length-1;w>=0&&w>=c&&ha[this.text.charCodeAt(w)];w--)g--;this.text=this.text.substring(c,g),this.sectionIndex=this.sectionIndex.slice(c,g)},lo.prototype.substring=function(c,d){var g=new lo;return g.text=this.text.substring(c,d),g.sectionIndex=this.sectionIndex.slice(c,d),g.sections=this.sections,g},lo.prototype.toString=function(){return this.text},lo.prototype.getMaxScale=function(){var c=this;return this.sectionIndex.reduce(function(d,g){return Math.max(d,c.sections[g].scale)},0)},lo.prototype.addTextSection=function(c,d){this.text+=c.text,this.sections.push(Ua.forText(c.scale,c.fontStack||d));for(var g=this.sections.length-1,w=0;w<c.text.length;++w)this.sectionIndex.push(g)},lo.prototype.addImageSection=function(c){var d=c.image?c.image.name:"";if(d.length!==0){var g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Ua.forImage(d)),this.sectionIndex.push(this.sections.length-1)):ke("Reached maximum number of images 6401")}else ke("Can't add FormattedSection with an empty image.")},lo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ha={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ko={};function hs(c,d,g,w,P,N){if(d.imageName){var j=w[d.imageName];return j?j.displaySize[0]*d.scale*24/N+P:0}var q=g[d.fontStack],at=q&&q[c];return at?at.metrics.advance*d.scale+P:0}function yl(c,d,g,w){var P=Math.pow(c-d,2);return w?c<d?P/2:2*P:P+Math.abs(g)*g}function qc(c,d,g){var w=0;return c===10&&(w-=1e4),g&&(w+=150),c!==40&&c!==65288||(w+=50),d!==41&&d!==65289||(w+=50),w}function Va(c,d,g,w,P,N){for(var j=null,q=yl(d,g,P,N),at=0,vt=w;at<vt.length;at+=1){var Ot=vt[at],Dt=yl(d-Ot.x,g,P,N)+Ot.badness;Dt<=q&&(j=Ot,q=Dt)}return{index:c,x:d,priorBreak:j,badness:q}}function hl(c,d,g,w,P,N,j){if(N!=="point")return[];if(!c)return[];for(var q,at=[],vt=function(kn,Sn,sr,pr,xr,Ir){for(var Wr=0,Ci=0;Ci<kn.length();Ci++){var Ai=kn.getSection(Ci);Wr+=hs(kn.getCharCode(Ci),Ai,pr,xr,Sn,Ir)}return Wr/Math.max(1,Math.ceil(Wr/sr))}(c,d,g,w,P,j),Ot=c.text.indexOf("\u200B")>=0,Dt=0,Yt=0;Yt<c.length();Yt++){var pe=c.getSection(Yt),Xe=c.getCharCode(Yt);if(ha[Xe]||(Dt+=hs(Xe,pe,w,P,d,j)),Yt<c.length()-1){var en=!((q=Xe)<11904||!(Ri["Bopomofo Extended"](q)||Ri.Bopomofo(q)||Ri["CJK Compatibility Forms"](q)||Ri["CJK Compatibility Ideographs"](q)||Ri["CJK Compatibility"](q)||Ri["CJK Radicals Supplement"](q)||Ri["CJK Strokes"](q)||Ri["CJK Symbols and Punctuation"](q)||Ri["CJK Unified Ideographs Extension A"](q)||Ri["CJK Unified Ideographs"](q)||Ri["Enclosed CJK Letters and Months"](q)||Ri["Halfwidth and Fullwidth Forms"](q)||Ri.Hiragana(q)||Ri["Ideographic Description Characters"](q)||Ri["Kangxi Radicals"](q)||Ri["Katakana Phonetic Extensions"](q)||Ri.Katakana(q)||Ri["Vertical Forms"](q)||Ri["Yi Radicals"](q)||Ri["Yi Syllables"](q)));(Ko[Xe]||en||pe.imageName)&&at.push(Va(Yt+1,Dt,vt,at,qc(Xe,c.getCharCode(Yt+1),en&&Ot),!1))}}return function kn(Sn){return Sn?kn(Sn.priorBreak).concat(Sn.index):[]}(Va(c.length(),Dt,vt,at,0,!0))}function Js(c){var d=.5,g=.5;switch(c){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:d,verticalAlign:g}}function Yl(c,d,g,w,P){if(w||P)for(var N=c[g],j=(c[g].x+N.metrics.advance*N.scale)*w,q=d;q<=g;q++)c[q].x-=j,c[q].y+=P}function Ul(c,d,g,w,P,N){var j,q=c.image;if(q.content){var at=q.content,vt=q.pixelRatio||1;j=[at[0]/vt,at[1]/vt,q.displaySize[0]-at[2]/vt,q.displaySize[1]-at[3]/vt]}var Ot,Dt,Yt,pe,Xe=d.left*N,en=d.right*N;g==="width"||g==="both"?(pe=P[0]+Xe-w[3],Dt=P[0]+en+w[1]):Dt=(pe=P[0]+(Xe+en-q.displaySize[0])/2)+q.displaySize[0];var kn=d.top*N,Sn=d.bottom*N;return g==="height"||g==="both"?(Ot=P[1]+kn-w[0],Yt=P[1]+Sn+w[2]):Yt=(Ot=P[1]+(kn+Sn-q.displaySize[1])/2)+q.displaySize[1],{image:q,top:Ot,right:Dt,bottom:Yt,left:pe,collisionPadding:j}}Ko[10]=!0,Ko[32]=!0,Ko[38]=!0,Ko[40]=!0,Ko[41]=!0,Ko[43]=!0,Ko[45]=!0,Ko[47]=!0,Ko[173]=!0,Ko[183]=!0,Ko[8203]=!0,Ko[8208]=!0,Ko[8211]=!0,Ko[8231]=!0;var rs=function(c){function d(g,w,P,N){c.call(this,g,w),this.angle=P,N!==void 0&&(this.segment=N)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(le);function ql(c,d){var g=d.expression;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new va(c+1))};if(g.kind==="source")return{kind:"source"};for(var w=g.zoomStops,P=g.interpolationType,N=0;N<w.length&&w[N]<=c;)N++;for(var j=N=Math.max(0,N-1);j<w.length&&w[j]<c+1;)j++;j=Math.min(w.length-1,j);var q=w[N],at=w[j];return g.kind==="composite"?{kind:"composite",minZoom:q,maxZoom:at,interpolationType:P}:{kind:"camera",minZoom:q,maxZoom:at,minSize:g.evaluate(new va(q)),maxSize:g.evaluate(new va(at)),interpolationType:P}}function tc(c,d,g){var w=d.uSize,P=g.lowerSize;return c.kind==="source"?P/128:c.kind==="composite"?Ws(P/128,g.upperSize/128,d.uSizeT):w}function mc(c,d){var g=0,w=0;if(c.kind==="constant")w=c.layoutSize;else if(c.kind!=="source"){var P=c.interpolationType,N=P?Ie(Nl.interpolationFactor(P,d,c.minZoom,c.maxZoom),0,1):0;c.kind==="camera"?w=Ws(c.minSize,c.maxSize,N):g=N}return{uSizeT:g,uSize:w}}fo("Anchor",rs);var Oa=Object.freeze({__proto__:null,getSizeData:ql,evaluateSizeForFeature:tc,evaluateSizeForZoom:mc,SIZE_PACK_FACTOR:128});function $c(c,d,g,w,P){if(d.segment===void 0)return!0;for(var N=d,j=d.segment+1,q=0;q>-g/2;){if(--j<0)return!1;q-=c[j].dist(N),N=c[j]}q+=c[j].dist(c[j+1]),j++;for(var at=[],vt=0;q<g/2;){var Ot=c[j],Dt=c[j+1];if(!Dt)return!1;var Yt=c[j-1].angleTo(Ot)-Ot.angleTo(Dt);for(Yt=Math.abs((Yt+3*Math.PI)%(2*Math.PI)-Math.PI),at.push({distance:q,angleDelta:Yt}),vt+=Yt;q-at[0].distance>w;)vt-=at.shift().angleDelta;if(vt>P)return!1;j++,q+=Ot.dist(Dt)}return!0}function Os(c){for(var d=0,g=0;g<c.length-1;g++)d+=c[g].dist(c[g+1]);return d}function Zo(c,d,g){return c?.6*d*g:0}function Ea(c,d){return Math.max(c?c.right-c.left:0,d?d.right-d.left:0)}function ja(c,d,g,w,P,N){for(var j=Zo(g,P,N),q=Ea(g,w)*N,at=0,vt=Os(c)/2,Ot=0;Ot<c.length-1;Ot++){var Dt=c[Ot],Yt=c[Ot+1],pe=Dt.dist(Yt);if(at+pe>vt){var Xe=(vt-at)/pe,en=Ws(Dt.x,Yt.x,Xe),kn=Ws(Dt.y,Yt.y,Xe),Sn=new rs(en,kn,Yt.angleTo(Dt),Ot);return Sn._round(),!j||$c(c,Sn,q,j,d)?Sn:void 0}at+=pe}}function $l(c,d,g,w,P,N,j,q,at){var vt=Zo(w,N,j),Ot=Ea(w,P),Dt=Ot*j,Yt=c[0].x===0||c[0].x===at||c[0].y===0||c[0].y===at;return d-Dt<d/4&&(d=Dt+d/4),function pe(Xe,en,kn,Sn,sr,pr,xr,Ir,Wr){for(var Ci=pr/2,Ai=Os(Xe),To=0,ao=en-kn,Ro=[],Zi=0;Zi<Xe.length-1;Zi++){for(var Ta=Xe[Zi],Qo=Xe[Zi+1],vo=Ta.dist(Qo),pa=Qo.angleTo(Ta);ao+kn<To+vo;){var Ca=((ao+=kn)-To)/vo,Ja=Ws(Ta.x,Qo.x,Ca),Ho=Ws(Ta.y,Qo.y,Ca);if(Ja>=0&&Ja<Wr&&Ho>=0&&Ho<Wr&&ao-Ci>=0&&ao+Ci<=Ai){var Ts=new rs(Ja,Ho,pa,Zi);Ts._round(),Sn&&!$c(Xe,Ts,pr,Sn,sr)||Ro.push(Ts)}}To+=vo}return Ir||Ro.length||xr||(Ro=pe(Xe,To/2,kn,Sn,sr,pr,xr,!0,Wr)),Ro}(c,Yt?d/2*q%d:(Ot/2+2*N)*j*q%d,d,vt,g,Dt,Yt,!1,at)}function ch(c,d,g,w,P){for(var N=[],j=0;j<c.length;j++)for(var q=c[j],at=void 0,vt=0;vt<q.length-1;vt++){var Ot=q[vt],Dt=q[vt+1];Ot.x<d&&Dt.x<d||(Ot.x<d?Ot=new le(d,Ot.y+(d-Ot.x)/(Dt.x-Ot.x)*(Dt.y-Ot.y))._round():Dt.x<d&&(Dt=new le(d,Ot.y+(d-Ot.x)/(Dt.x-Ot.x)*(Dt.y-Ot.y))._round()),Ot.y<g&&Dt.y<g||(Ot.y<g?Ot=new le(Ot.x+(g-Ot.y)/(Dt.y-Ot.y)*(Dt.x-Ot.x),g)._round():Dt.y<g&&(Dt=new le(Ot.x+(g-Ot.y)/(Dt.y-Ot.y)*(Dt.x-Ot.x),g)._round()),Ot.x>=w&&Dt.x>=w||(Ot.x>=w?Ot=new le(w,Ot.y+(w-Ot.x)/(Dt.x-Ot.x)*(Dt.y-Ot.y))._round():Dt.x>=w&&(Dt=new le(w,Ot.y+(w-Ot.x)/(Dt.x-Ot.x)*(Dt.y-Ot.y))._round()),Ot.y>=P&&Dt.y>=P||(Ot.y>=P?Ot=new le(Ot.x+(P-Ot.y)/(Dt.y-Ot.y)*(Dt.x-Ot.x),P)._round():Dt.y>=P&&(Dt=new le(Ot.x+(P-Ot.y)/(Dt.y-Ot.y)*(Dt.x-Ot.x),P)._round()),at&&Ot.equals(at[at.length-1])||N.push(at=[Ot]),at.push(Dt)))))}return N}function We(c,d,g,w){var P=[],N=c.image,j=N.pixelRatio,q=N.paddedRect.w-2,at=N.paddedRect.h-2,vt=c.right-c.left,Ot=c.bottom-c.top,Dt=N.stretchX||[[0,q]],Yt=N.stretchY||[[0,at]],pe=function(Ja,Ho){return Ja+Ho[1]-Ho[0]},Xe=Dt.reduce(pe,0),en=Yt.reduce(pe,0),kn=q-Xe,Sn=at-en,sr=0,pr=Xe,xr=0,Ir=en,Wr=0,Ci=kn,Ai=0,To=Sn;if(N.content&&w){var ao=N.content;sr=Pr(Dt,0,ao[0]),xr=Pr(Yt,0,ao[1]),pr=Pr(Dt,ao[0],ao[2]),Ir=Pr(Yt,ao[1],ao[3]),Wr=ao[0]-sr,Ai=ao[1]-xr,Ci=ao[2]-ao[0]-pr,To=ao[3]-ao[1]-Ir}var Ro=function(Ja,Ho,Ts,_l){var zl=no(Ja.stretch-sr,pr,vt,c.left),jl=Da(Ja.fixed-Wr,Ci,Ja.stretch,Xe),xl=no(Ho.stretch-xr,Ir,Ot,c.top),nc=Da(Ho.fixed-Ai,To,Ho.stretch,en),Vs=no(Ts.stretch-sr,pr,vt,c.left),wc=Da(Ts.fixed-Wr,Ci,Ts.stretch,Xe),Xu=no(_l.stretch-xr,Ir,Ot,c.top),Uc=Da(_l.fixed-Ai,To,_l.stretch,en),uu=new le(zl,xl),Vl=new le(Vs,xl),zc=new le(Vs,Xu),Ka=new le(zl,Xu),Xs=new le(jl/j,nc/j),Fs=new le(wc/j,Uc/j),ds=d*Math.PI/180;if(ds){var Yu=Math.sin(ds),fu=Math.cos(ds),Us=[fu,-Yu,Yu,fu];uu._matMult(Us),Vl._matMult(Us),Ka._matMult(Us),zc._matMult(Us)}var rc=Ja.stretch+Ja.fixed,Ac=Ho.stretch+Ho.fixed;return{tl:uu,tr:Vl,bl:Ka,br:zc,tex:{x:N.paddedRect.x+1+rc,y:N.paddedRect.y+1+Ac,w:Ts.stretch+Ts.fixed-rc,h:_l.stretch+_l.fixed-Ac},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xs,pixelOffsetBR:Fs,minFontScaleX:Ci/j/vt,minFontScaleY:To/j/Ot,isSDF:g}};if(w&&(N.stretchX||N.stretchY))for(var Zi=_r(Dt,kn,Xe),Ta=_r(Yt,Sn,en),Qo=0;Qo<Zi.length-1;Qo++)for(var vo=Zi[Qo],pa=Zi[Qo+1],Ca=0;Ca<Ta.length-1;Ca++)P.push(Ro(vo,Ta[Ca],pa,Ta[Ca+1]));else P.push(Ro({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:q+1},{fixed:0,stretch:at+1}));return P}function Pr(c,d,g){for(var w=0,P=0,N=c;P<N.length;P+=1){var j=N[P];w+=Math.max(d,Math.min(g,j[1]))-Math.max(d,Math.min(g,j[0]))}return w}function _r(c,d,g){for(var w=[{fixed:-1,stretch:0}],P=0,N=c;P<N.length;P+=1){var j=N[P],q=j[0],at=j[1],vt=w[w.length-1];w.push({fixed:q-vt.stretch,stretch:vt.stretch}),w.push({fixed:q-vt.stretch,stretch:vt.stretch+(at-q)})}return w.push({fixed:d+1,stretch:g}),w}function no(c,d,g,w){return c/d*g+w}function Da(c,d,g,w){return c-d*g/w}var ys=function(c,d,g,w,P,N,j,q,at,vt){if(this.boxStartIndex=c.length,at){var Ot=N.top,Dt=N.bottom,Yt=N.collisionPadding;Yt&&(Ot-=Yt[1],Dt+=Yt[3]);var pe=Dt-Ot;pe>0&&(pe=Math.max(10,pe),this.circleDiameter=pe)}else{var Xe=N.top*j-q,en=N.bottom*j+q,kn=N.left*j-q,Sn=N.right*j+q,sr=N.collisionPadding;if(sr&&(kn-=sr[0]*j,Xe-=sr[1]*j,Sn+=sr[2]*j,en+=sr[3]*j),vt){var pr=new le(kn,Xe),xr=new le(Sn,Xe),Ir=new le(kn,en),Wr=new le(Sn,en),Ci=vt*Math.PI/180;pr._rotate(Ci),xr._rotate(Ci),Ir._rotate(Ci),Wr._rotate(Ci),kn=Math.min(pr.x,xr.x,Ir.x,Wr.x),Sn=Math.max(pr.x,xr.x,Ir.x,Wr.x),Xe=Math.min(pr.y,xr.y,Ir.y,Wr.y),en=Math.max(pr.y,xr.y,Ir.y,Wr.y)}c.emplaceBack(d.x,d.y,kn,Xe,Sn,en,g,w,P)}this.boxEndIndex=c.length},he=function(c,d){if(c===void 0&&(c=[]),d===void 0&&(d=je),this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(var g=(this.length>>1)-1;g>=0;g--)this._down(g)};function je(c,d){return c<d?-1:c>d?1:0}function _n(c,d,g){d===void 0&&(d=1),g===void 0&&(g=!1);for(var w=1/0,P=1/0,N=-1/0,j=-1/0,q=c[0],at=0;at<q.length;at++){var vt=q[at];(!at||vt.x<w)&&(w=vt.x),(!at||vt.y<P)&&(P=vt.y),(!at||vt.x>N)&&(N=vt.x),(!at||vt.y>j)&&(j=vt.y)}var Ot=Math.min(N-w,j-P),Dt=Ot/2,Yt=new he([],wr);if(Ot===0)return new le(w,P);for(var pe=w;pe<N;pe+=Ot)for(var Xe=P;Xe<j;Xe+=Ot)Yt.push(new yr(pe+Dt,Xe+Dt,Dt,c));for(var en=function(sr){for(var pr=0,xr=0,Ir=0,Wr=sr[0],Ci=0,Ai=Wr.length,To=Ai-1;Ci<Ai;To=Ci++){var ao=Wr[Ci],Ro=Wr[To],Zi=ao.x*Ro.y-Ro.x*ao.y;xr+=(ao.x+Ro.x)*Zi,Ir+=(ao.y+Ro.y)*Zi,pr+=3*Zi}return new yr(xr/pr,Ir/pr,0,sr)}(c),kn=Yt.length;Yt.length;){var Sn=Yt.pop();(Sn.d>en.d||!en.d)&&(en=Sn,g&&console.log("found best %d after %d probes",Math.round(1e4*Sn.d)/1e4,kn)),Sn.max-en.d<=d||(Yt.push(new yr(Sn.p.x-(Dt=Sn.h/2),Sn.p.y-Dt,Dt,c)),Yt.push(new yr(Sn.p.x+Dt,Sn.p.y-Dt,Dt,c)),Yt.push(new yr(Sn.p.x-Dt,Sn.p.y+Dt,Dt,c)),Yt.push(new yr(Sn.p.x+Dt,Sn.p.y+Dt,Dt,c)),kn+=4)}return g&&(console.log("num probes: "+kn),console.log("best distance: "+en.d)),en.p}function wr(c,d){return d.max-c.max}function yr(c,d,g,w){this.p=new le(c,d),this.h=g,this.d=function(P,N){for(var j=!1,q=1/0,at=0;at<N.length;at++)for(var vt=N[at],Ot=0,Dt=vt.length,Yt=Dt-1;Ot<Dt;Yt=Ot++){var pe=vt[Ot],Xe=vt[Yt];pe.y>P.y!=Xe.y>P.y&&P.x<(Xe.x-pe.x)*(P.y-pe.y)/(Xe.y-pe.y)+pe.x&&(j=!j),q=Math.min(q,Zd(P,pe,Xe))}return(j?1:-1)*Math.sqrt(q)}(this.p,w),this.max=this.d+this.h*Math.SQRT2}he.prototype.push=function(c){this.data.push(c),this.length++,this._up(this.length-1)},he.prototype.pop=function(){if(this.length!==0){var c=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),c}},he.prototype.peek=function(){return this.data[0]},he.prototype._up=function(c){for(var d=this.data,g=this.compare,w=d[c];c>0;){var P=c-1>>1,N=d[P];if(g(w,N)>=0)break;d[c]=N,c=P}d[c]=w},he.prototype._down=function(c){for(var d=this.data,g=this.compare,w=this.length>>1,P=d[c];c<w;){var N=1+(c<<1),j=d[N],q=N+1;if(q<this.length&&g(d[q],j)<0&&(N=q,j=d[q]),g(j,P)>=0)break;d[c]=j,c=N}d[c]=P};var In=Number.POSITIVE_INFINITY;function Fn(c,d){return d[1]!==In?function(g,w,P){var N=0,j=0;switch(w=Math.abs(w),P=Math.abs(P),g){case"top-right":case"top-left":case"top":j=P-7;break;case"bottom-right":case"bottom-left":case"bottom":j=7-P}switch(g){case"top-right":case"bottom-right":case"right":N=-w;break;case"top-left":case"bottom-left":case"left":N=w}return[N,j]}(c,d[0],d[1]):function(g,w){var P=0,N=0;w<0&&(w=0);var j=w/Math.sqrt(2);switch(g){case"top-right":case"top-left":N=j-7;break;case"bottom-right":case"bottom-left":N=7-j;break;case"bottom":N=7-w;break;case"top":N=w-7}switch(g){case"top-right":case"bottom-right":P=-j;break;case"top-left":case"bottom-left":P=j;break;case"left":P=w;break;case"right":P=-w}return[P,N]}(c,d[0])}function Yn(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function an(c,d,g,w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe){var en=function(xr,Ir,Wr,Ci,Ai,To,ao,Ro){for(var Zi=Ci.layout.get("text-rotate").evaluate(To,{})*Math.PI/180,Ta=[],Qo=0,vo=Ir.positionedLines;Qo<vo.length;Qo+=1)for(var pa=vo[Qo],Ca=0,Ja=pa.positionedGlyphs;Ca<Ja.length;Ca+=1){var Ho=Ja[Ca];if(Ho.rect){var Ts=Ho.rect||{},_l=4,zl=!0,jl=1,xl=0,nc=(Ai||Ro)&&Ho.vertical,Vs=Ho.metrics.advance*Ho.scale/2;if(Ro&&Ir.verticalizable&&(xl=pa.lineOffset/2-(Ho.imageName?-(24-Ho.metrics.width*Ho.scale)/2:24*(Ho.scale-1))),Ho.imageName){var wc=ao[Ho.imageName];zl=wc.sdf,_l=1/(jl=wc.pixelRatio)}var Xu=Ai?[Ho.x+Vs,Ho.y]:[0,0],Uc=Ai?[0,0]:[Ho.x+Vs+Wr[0],Ho.y+Wr[1]-xl],uu=[0,0];nc&&(uu=Uc,Uc=[0,0]);var Vl=(Ho.metrics.left-_l)*Ho.scale-Vs+Uc[0],zc=(-Ho.metrics.top-_l)*Ho.scale+Uc[1],Ka=Vl+Ts.w*Ho.scale/jl,Xs=zc+Ts.h*Ho.scale/jl,Fs=new le(Vl,zc),ds=new le(Ka,zc),Yu=new le(Vl,Xs),fu=new le(Ka,Xs);if(nc){var Us=new le(-Vs,Vs- -17),rc=-Math.PI/2,Ac=12-Vs,is=new le(22-Ac,-(Ho.imageName?Ac:0)),qu=new(Function.prototype.bind.apply(le,[null].concat(uu)));Fs._rotateAround(rc,Us)._add(is)._add(qu),ds._rotateAround(rc,Us)._add(is)._add(qu),Yu._rotateAround(rc,Us)._add(is)._add(qu),fu._rotateAround(rc,Us)._add(is)._add(qu)}if(Zi){var zf=Math.sin(Zi),Jd=Math.cos(Zi),ic=[Jd,-zf,zf,Jd];Fs._matMult(ic),ds._matMult(ic),Yu._matMult(ic),fu._matMult(ic)}var uh=new le(0,0),Tf=new le(0,0);Ta.push({tl:Fs,tr:ds,bl:Yu,br:fu,tex:Ts,writingMode:Ir.writingMode,glyphOffset:Xu,sectionIndex:Ho.sectionIndex,isSDF:zl,pixelOffsetTL:uh,pixelOffsetBR:Tf,minFontScaleX:0,minFontScaleY:0})}}return Ta}(0,g,q,P,N,j,w,c.allowVerticalPlacement),kn=c.textSizeData,Sn=null;kn.kind==="source"?(Sn=[128*P.layout.get("text-size").evaluate(j,{})])[0]>32640&&ke(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):kn.kind==="composite"&&((Sn=[128*pe.compositeTextSizes[0].evaluate(j,{},Xe),128*pe.compositeTextSizes[1].evaluate(j,{},Xe)])[0]>32640||Sn[1]>32640)&&ke(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),c.addSymbols(c.text,en,Sn,q,N,j,vt,d,at.lineStartIndex,at.lineLength,Yt,Xe);for(var sr=0,pr=Ot;sr<pr.length;sr+=1)Dt[pr[sr]]=c.text.placedSymbolArray.length-1;return 4*en.length}function Nn(c){for(var d in c)return c[d];return null}function Re(c,d,g,w){var P=c.compareText;if(d in P){for(var N=P[d],j=N.length-1;j>=0;j--)if(w.dist(N[j])<g)return!0}else P[d]=[];return P[d].push(w),!1}var Bn=wh.VectorTileFeature.types,Dr=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fr(c,d,g,w,P,N,j,q,at,vt,Ot,Dt,Yt){var pe=q?Math.min(32640,Math.round(q[0])):0,Xe=q?Math.min(32640,Math.round(q[1])):0;c.emplaceBack(d,g,Math.round(32*w),Math.round(32*P),N,j,(pe<<1)+(at?1:0),Xe,16*vt,16*Ot,256*Dt,256*Yt)}function di(c,d,g){c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g)}function $r(c){for(var d=0,g=c.sections;d<g.length;d+=1)if(_p(g[d].text))return!0;return!1}var fi=function(c){this.layoutVertexArray=new ih,this.indexArray=new sh,this.programConfigurations=c,this.segments=new be,this.dynamicLayoutVertexArray=new Xc,this.opacityVertexArray=new jd,this.placedSymbolArray=new A};fi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},fi.prototype.upload=function(c,d,g,w){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,av.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,Yv.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Dr,!0),this.opacityVertexBuffer.itemSize=1),(g||w)&&this.programConfigurations.upload(c))},fi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},fo("SymbolBuffers",fi);var Oo=function(c,d,g){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new g,this.segments=new be,this.collisionVertexArray=new Qp};Oo.prototype.upload=function(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,qv.members,!0)},Oo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},fo("CollisionBuffers",Oo);var Bi=function(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fl([]),this.placementViewportMatrix=Fl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ql(this.zoom,d["text-size"]),this.iconSizeData=ql(this.zoom,d["icon-size"]);var g=this.layers[0].layout,w=g.get("symbol-sort-key"),P=g.get("symbol-z-order");this.canOverlap=g.get("text-allow-overlap")||g.get("icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=P!=="viewport-y"&&w.constantOr(1)!==void 0,this.sortFeaturesByY=(P==="viewport-y"||P==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(function(N){return Uo[N]})),this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id}),this.sourceID=c.sourceID};Bi.prototype.createArrays=function(){this.text=new fi(new Do(this.layers,this.zoom,function(c){return/^text/.test(c)})),this.icon=new fi(new Do(this.layers,this.zoom,function(c){return/^icon/.test(c)})),this.glyphOffsetArray=new Y,this.lineVertexArray=new et,this.symbolInstances=new H},Bi.prototype.calculateGlyphDependencies=function(c,d,g,w,P){for(var N=0;N<c.length;N++)if(d[c.charCodeAt(N)]=!0,(g||w)&&P){var j=gn[c.charAt(N)];j&&(d[j.charCodeAt(0)]=!0)}},Bi.prototype.populate=function(c,d,g){var w=this.layers[0],P=w.layout,N=P.get("text-font"),j=P.get("text-field"),q=P.get("icon-image"),at=(j.value.kind!=="constant"||j.value.value instanceof fr&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),vt=q.value.kind!=="constant"||!!q.value.value||Object.keys(q.parameters).length>0,Ot=P.get("symbol-sort-key");if(this.features=[],at||vt){for(var Dt=d.iconDependencies,Yt=d.glyphDependencies,pe=d.availableImages,Xe=new va(this.zoom),en=0,kn=c;en<kn.length;en+=1){var Sn=kn[en],sr=Sn.feature,pr=Sn.id,xr=Sn.index,Ir=Sn.sourceLayerIndex,Wr=w._featureFilter.needGeometry,Ci=Ks(sr,Wr);if(w._featureFilter.filter(Xe,Ci,g)){Wr||(Ci.geometry=vs(sr));var Ai=void 0;if(at){var To=w.getValueAndResolveTokens("text-field",Ci,g,pe),ao=fr.factory(To);$r(ao)&&(this.hasRTLText=!0),(!this.hasRTLText||sm()==="unavailable"||this.hasRTLText&&vu.isParsed())&&(Ai=Pe(ao,w,Ci))}var Ro=void 0;if(vt){var Zi=w.getValueAndResolveTokens("icon-image",Ci,g,pe);Ro=Zi instanceof ai?Zi:ai.fromString(Zi)}if(Ai||Ro){var Ta=this.sortFeaturesByKey?Ot.evaluate(Ci,{},g):void 0;if(this.features.push({id:pr,text:Ai,icon:Ro,index:xr,sourceLayerIndex:Ir,geometry:Ci.geometry,properties:sr.properties,type:Bn[sr.type],sortKey:Ta}),Ro&&(Dt[Ro.name]=!0),Ai){var Qo=N.evaluate(Ci,{},g).join(","),vo=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Uo.vertical)>=0;for(var pa=0,Ca=Ai.sections;pa<Ca.length;pa+=1){var Ja=Ca[pa];if(Ja.image)Dt[Ja.image.name]=!0;else{var Ho=eh(Ai.toString()),Ts=Ja.fontStack||Qo,_l=Yt[Ts]=Yt[Ts]||{};this.calculateGlyphDependencies(Ja.text,_l,vo,this.allowVerticalPlacement,Ho)}}}}}}P.get("symbol-placement")==="line"&&(this.features=function(zl){var jl={},xl={},nc=[],Vs=0;function wc(Us){nc.push(zl[Us]),Vs++}function Xu(Us,rc,Ac){var is=xl[Us];return delete xl[Us],xl[rc]=is,nc[is].geometry[0].pop(),nc[is].geometry[0]=nc[is].geometry[0].concat(Ac[0]),is}function Uc(Us,rc,Ac){var is=jl[rc];return delete jl[rc],jl[Us]=is,nc[is].geometry[0].shift(),nc[is].geometry[0]=Ac[0].concat(nc[is].geometry[0]),is}function uu(Us,rc,Ac){var is=Ac?rc[0][rc[0].length-1]:rc[0][0];return Us+":"+is.x+":"+is.y}for(var Vl=0;Vl<zl.length;Vl++){var zc=zl[Vl],Ka=zc.geometry,Xs=zc.text?zc.text.toString():null;if(Xs){var Fs=uu(Xs,Ka),ds=uu(Xs,Ka,!0);if(Fs in xl&&ds in jl&&xl[Fs]!==jl[ds]){var Yu=Uc(Fs,ds,Ka),fu=Xu(Fs,ds,nc[Yu].geometry);delete jl[Fs],delete xl[ds],xl[uu(Xs,nc[fu].geometry,!0)]=fu,nc[Yu].geometry=null}else Fs in xl?Xu(Fs,ds,Ka):ds in jl?Uc(Fs,ds,Ka):(wc(Vl),jl[Fs]=Vs-1,xl[ds]=Vs-1)}else wc(Vl)}return nc.filter(function(Us){return Us.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(zl,jl){return zl.sortKey-jl.sortKey})}},Bi.prototype.update=function(c,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,d,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,d,this.layers,g))},Bi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Bi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Bi.prototype.upload=function(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Bi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Bi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Bi.prototype.addToLineVertexArray=function(c,d){var g=this.lineVertexArray.length;if(c.segment!==void 0){for(var w=c.dist(d[c.segment+1]),P=c.dist(d[c.segment]),N={},j=c.segment+1;j<d.length;j++)N[j]={x:d[j].x,y:d[j].y,tileUnitDistanceFromAnchor:w},j<d.length-1&&(w+=d[j+1].dist(d[j]));for(var q=c.segment||0;q>=0;q--)N[q]={x:d[q].x,y:d[q].y,tileUnitDistanceFromAnchor:P},q>0&&(P+=d[q-1].dist(d[q]));for(var at=0;at<d.length;at++){var vt=N[at];this.lineVertexArray.emplaceBack(vt.x,vt.y,vt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}},Bi.prototype.addSymbols=function(c,d,g,w,P,N,j,q,at,vt,Ot,Dt){for(var Yt=c.indexArray,pe=c.layoutVertexArray,Xe=c.segments.prepareSegment(4*d.length,pe,Yt,this.canOverlap?N.sortKey:void 0),en=this.glyphOffsetArray.length,kn=Xe.vertexLength,Sn=this.allowVerticalPlacement&&j===Uo.vertical?Math.PI/2:0,sr=N.text&&N.text.sections,pr=0;pr<d.length;pr++){var xr=d[pr],Ir=xr.tl,Wr=xr.tr,Ci=xr.bl,Ai=xr.br,To=xr.tex,ao=xr.pixelOffsetTL,Ro=xr.pixelOffsetBR,Zi=xr.minFontScaleX,Ta=xr.minFontScaleY,Qo=xr.glyphOffset,vo=xr.isSDF,pa=xr.sectionIndex,Ca=Xe.vertexLength,Ja=Qo[1];Fr(pe,q.x,q.y,Ir.x,Ja+Ir.y,To.x,To.y,g,vo,ao.x,ao.y,Zi,Ta),Fr(pe,q.x,q.y,Wr.x,Ja+Wr.y,To.x+To.w,To.y,g,vo,Ro.x,ao.y,Zi,Ta),Fr(pe,q.x,q.y,Ci.x,Ja+Ci.y,To.x,To.y+To.h,g,vo,ao.x,Ro.y,Zi,Ta),Fr(pe,q.x,q.y,Ai.x,Ja+Ai.y,To.x+To.w,To.y+To.h,g,vo,Ro.x,Ro.y,Zi,Ta),di(c.dynamicLayoutVertexArray,q,Sn),Yt.emplaceBack(Ca,Ca+1,Ca+2),Yt.emplaceBack(Ca+1,Ca+2,Ca+3),Xe.vertexLength+=4,Xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qo[0]),pr!==d.length-1&&pa===d[pr+1].sectionIndex||c.programConfigurations.populatePaintArrays(pe.length,N,N.index,{},Dt,sr&&sr[pa])}c.placedSymbolArray.emplaceBack(q.x,q.y,en,this.glyphOffsetArray.length-en,kn,at,vt,q.segment,g?g[0]:0,g?g[1]:0,w[0],w[1],j,0,!1,0,Ot)},Bi.prototype._addCollisionDebugVertex=function(c,d,g,w,P,N){return d.emplaceBack(0,0),c.emplaceBack(g.x,g.y,w,P,Math.round(N.x),Math.round(N.y))},Bi.prototype.addCollisionDebugVertices=function(c,d,g,w,P,N,j){var q=P.segments.prepareSegment(4,P.layoutVertexArray,P.indexArray),at=q.vertexLength,vt=P.layoutVertexArray,Ot=P.collisionVertexArray,Dt=j.anchorX,Yt=j.anchorY;this._addCollisionDebugVertex(vt,Ot,N,Dt,Yt,new le(c,d)),this._addCollisionDebugVertex(vt,Ot,N,Dt,Yt,new le(g,d)),this._addCollisionDebugVertex(vt,Ot,N,Dt,Yt,new le(g,w)),this._addCollisionDebugVertex(vt,Ot,N,Dt,Yt,new le(c,w)),q.vertexLength+=4;var pe=P.indexArray;pe.emplaceBack(at,at+1),pe.emplaceBack(at+1,at+2),pe.emplaceBack(at+2,at+3),pe.emplaceBack(at+3,at),q.primitiveLength+=4},Bi.prototype.addDebugCollisionBoxes=function(c,d,g,w){for(var P=c;P<d;P++){var N=this.collisionBoxArray.get(P);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,w?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,g)}},Bi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Oo(oh,$v.members,Jp),this.iconCollisionBox=new Oo(oh,$v.members,Jp);for(var c=0;c<this.symbolInstances.length;c++){var d=this.symbolInstances.get(c);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},Bi.prototype._deserializeCollisionBoxesForSymbol=function(c,d,g,w,P,N,j,q,at){for(var vt={},Ot=d;Ot<g;Ot++){var Dt=c.get(Ot);vt.textBox={x1:Dt.x1,y1:Dt.y1,x2:Dt.x2,y2:Dt.y2,anchorPointX:Dt.anchorPointX,anchorPointY:Dt.anchorPointY},vt.textFeatureIndex=Dt.featureIndex;break}for(var Yt=w;Yt<P;Yt++){var pe=c.get(Yt);vt.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},vt.verticalTextFeatureIndex=pe.featureIndex;break}for(var Xe=N;Xe<j;Xe++){var en=c.get(Xe);vt.iconBox={x1:en.x1,y1:en.y1,x2:en.x2,y2:en.y2,anchorPointX:en.anchorPointX,anchorPointY:en.anchorPointY},vt.iconFeatureIndex=en.featureIndex;break}for(var kn=q;kn<at;kn++){var Sn=c.get(kn);vt.verticalIconBox={x1:Sn.x1,y1:Sn.y1,x2:Sn.x2,y2:Sn.y2,anchorPointX:Sn.anchorPointX,anchorPointY:Sn.anchorPointY},vt.verticalIconFeatureIndex=Sn.featureIndex;break}return vt},Bi.prototype.deserializeCollisionBoxes=function(c){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}},Bi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Bi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Bi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Bi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Bi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Bi.prototype.addIndicesForPlacedSymbol=function(c,d){for(var g=c.placedSymbolArray.get(d),w=g.vertexStartIndex+4*g.numGlyphs,P=g.vertexStartIndex;P<w;P+=4)c.indexArray.emplaceBack(P,P+1,P+2),c.indexArray.emplaceBack(P+1,P+2,P+3)},Bi.prototype.getSortedSymbolIndexes=function(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(c),g=Math.cos(c),w=[],P=[],N=[],j=0;j<this.symbolInstances.length;++j){N.push(j);var q=this.symbolInstances.get(j);w.push(0|Math.round(d*q.anchorX+g*q.anchorY)),P.push(q.featureIndex)}return N.sort(function(at,vt){return w[at]-w[vt]||P[vt]-P[at]}),N},Bi.prototype.addToSortKeyRanges=function(c,d){var g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})},Bi.prototype.sortFeatures=function(c){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var g=0,w=this.symbolInstanceIndexes;g<w.length;g+=1){var P=this.symbolInstances.get(w[g]);this.featureSortOrder.push(P.featureIndex),[P.rightJustifiedTextSymbolIndex,P.centerJustifiedTextSymbolIndex,P.leftJustifiedTextSymbolIndex].forEach(function(N,j,q){N>=0&&q.indexOf(N)===j&&d.addIndicesForPlacedSymbol(d.text,N)}),P.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,P.verticalPlacedTextSymbolIndex),P.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.placedIconSymbolIndex),P.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},fo("SymbolBucket",Bi,{omit:["layers","collisionBoxArray","features","compareText"]}),Bi.MAX_GLYPHS=65535,Bi.addDynamicAttributes=di;var yo=new ul({"symbol-placement":new Ao(ee.layout_symbol["symbol-placement"]),"symbol-spacing":new Ao(ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ao(ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xo(ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ao(ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ao(ee.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ao(ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ao(ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ao(ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new xo(ee.layout_symbol["icon-size"]),"icon-text-fit":new Ao(ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ao(ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new xo(ee.layout_symbol["icon-image"]),"icon-rotate":new xo(ee.layout_symbol["icon-rotate"]),"icon-padding":new Ao(ee.layout_symbol["icon-padding"]),"icon-keep-upright":new Ao(ee.layout_symbol["icon-keep-upright"]),"icon-offset":new xo(ee.layout_symbol["icon-offset"]),"icon-anchor":new xo(ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ao(ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ao(ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ao(ee.layout_symbol["text-rotation-alignment"]),"text-field":new xo(ee.layout_symbol["text-field"]),"text-font":new xo(ee.layout_symbol["text-font"]),"text-size":new xo(ee.layout_symbol["text-size"]),"text-max-width":new xo(ee.layout_symbol["text-max-width"]),"text-line-height":new Ao(ee.layout_symbol["text-line-height"]),"text-letter-spacing":new xo(ee.layout_symbol["text-letter-spacing"]),"text-justify":new xo(ee.layout_symbol["text-justify"]),"text-radial-offset":new xo(ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ao(ee.layout_symbol["text-variable-anchor"]),"text-anchor":new xo(ee.layout_symbol["text-anchor"]),"text-max-angle":new Ao(ee.layout_symbol["text-max-angle"]),"text-writing-mode":new Ao(ee.layout_symbol["text-writing-mode"]),"text-rotate":new xo(ee.layout_symbol["text-rotate"]),"text-padding":new Ao(ee.layout_symbol["text-padding"]),"text-keep-upright":new Ao(ee.layout_symbol["text-keep-upright"]),"text-transform":new xo(ee.layout_symbol["text-transform"]),"text-offset":new xo(ee.layout_symbol["text-offset"]),"text-allow-overlap":new Ao(ee.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ao(ee.layout_symbol["text-ignore-placement"]),"text-optional":new Ao(ee.layout_symbol["text-optional"])}),Yo={paint:new ul({"icon-opacity":new xo(ee.paint_symbol["icon-opacity"]),"icon-color":new xo(ee.paint_symbol["icon-color"]),"icon-halo-color":new xo(ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new xo(ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xo(ee.paint_symbol["icon-halo-blur"]),"icon-translate":new Ao(ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ao(ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new xo(ee.paint_symbol["text-opacity"]),"text-color":new xo(ee.paint_symbol["text-color"],{runtimeType:xi,getOverride:function(c){return c.textColor},hasOverride:function(c){return!!c.textColor}}),"text-halo-color":new xo(ee.paint_symbol["text-halo-color"]),"text-halo-width":new xo(ee.paint_symbol["text-halo-width"]),"text-halo-blur":new xo(ee.paint_symbol["text-halo-blur"]),"text-translate":new Ao(ee.paint_symbol["text-translate"]),"text-translate-anchor":new Ao(ee.paint_symbol["text-translate-anchor"])}),layout:yo},ea=function(c){this.type=c.property.overrides?c.property.overrides.runtimeType:ni,this.defaultValue=c};ea.prototype.evaluate=function(c){if(c.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default},ea.prototype.eachChild=function(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)},ea.prototype.outputDefined=function(){return!1},ea.prototype.serialize=function(){return null},fo("FormatSectionOverride",ea,{omit:["defaultValue"]});var Ss=function(c){function d(g){c.call(this,g,Yo)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,w){if(c.prototype.recalculate.call(this,g,w),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var P=this.layout.get("text-writing-mode");if(P){for(var N=[],j=0,q=P;j<q.length;j+=1){var at=q[j];N.indexOf(at)<0&&N.push(at)}this.layout._values["text-writing-mode"]=N}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(g,w,P,N){var j=this.layout.get(g).evaluate(w,{},P,N),q=this._unevaluatedLayout._values[g];return q.isDataDriven()||qs(q.value)||!j?j:function(at,vt){return vt.replace(/{([^{}]+)}/g,function(Ot,Dt){return Dt in at?String(at[Dt]):""})}(w.properties,j)},d.prototype.createBucket=function(g){return new Bi(g)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var g=0,w=Yo.paint.overridableProperties;g<w.length;g+=1){var P=w[g];if(d.hasPaintOverride(this.layout,P)){var N,j=this.paint.get(P),q=new ea(j),at=new ka(q,j.property.specification);N=j.value.kind==="constant"||j.value.kind==="source"?new Ec("source",at):new es("composite",at,j.value.zoomStops,j.value._interpolationType),this.paint._values[P]=new iu(j.property,N,j.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(g,w,P){return!(!this.layout||w.isDataDriven()||P.isDataDriven())&&d.hasPaintOverride(this.layout,g)},d.hasPaintOverride=function(g,w){var P=g.get("text-field"),N=Yo.paint.properties[w],j=!1,q=function(Ot){for(var Dt=0,Yt=Ot;Dt<Yt.length;Dt+=1)if(N.overrides&&N.overrides.hasOverride(Yt[Dt]))return void(j=!0)};if(P.value.kind==="constant"&&P.value.value instanceof fr)q(P.value.value.sections);else if(P.value.kind==="source"){var at=function(Ot){j||(Ot instanceof Ui&&si(Ot.value)===Pa?q(Ot.value.sections):Ot instanceof Eo?q(Ot.sections):Ot.eachChild(at))},vt=P.value;vt._styleExpression&&at(vt._styleExpression.expression)}return j},d}(Wc),Sc={paint:new ul({"background-color":new Ao(ee.paint_background["background-color"]),"background-pattern":new ou(ee.paint_background["background-pattern"]),"background-opacity":new Ao(ee.paint_background["background-opacity"])})},bu=function(c){function d(g){c.call(this,g,Sc)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Wc),mm={paint:new ul({"raster-opacity":new Ao(ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ao(ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ao(ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ao(ee.paint_raster["raster-brightness-max"]),"raster-saturation":new Ao(ee.paint_raster["raster-saturation"]),"raster-contrast":new Ao(ee.paint_raster["raster-contrast"]),"raster-resampling":new Ao(ee.paint_raster["raster-resampling"]),"raster-fade-duration":new Ao(ee.paint_raster["raster-fade-duration"])})},uf=function(c){function d(g){c.call(this,g,mm)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Wc),Kv=function(c){function d(g){c.call(this,g,{}),this.implementation=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(g){this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},d.prototype.onRemove=function(g){this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},d}(Wc),Cd={circle:Ep,heatmap:Sp,hillshade:Wv,fill:ay,"fill-extrusion":xu,line:Ah,symbol:Ss,background:bu,raster:uf},$d=Lt.HTMLImageElement,O_=Lt.HTMLCanvasElement,C_=Lt.HTMLVideoElement,Qv=Lt.ImageData,Jv=Lt.ImageBitmap,s0=function(c,d,g,w){this.context=c,this.format=g,this.texture=c.gl.createTexture(),this.update(d,w)};s0.prototype.update=function(c,d,g){var w=c.width,P=c.height,N=!(this.size&&this.size[0]===w&&this.size[1]===P||g),j=this.context,q=j.gl;if(this.useMipmap=!!(d&&d.useMipmap),q.bindTexture(q.TEXTURE_2D,this.texture),j.pixelStoreUnpackFlipY.set(!1),j.pixelStoreUnpack.set(1),j.pixelStoreUnpackPremultiplyAlpha.set(this.format===q.RGBA&&(!d||d.premultiply!==!1)),N)this.size=[w,P],c instanceof $d||c instanceof O_||c instanceof C_||c instanceof Qv||Jv&&c instanceof Jv?q.texImage2D(q.TEXTURE_2D,0,this.format,this.format,q.UNSIGNED_BYTE,c):q.texImage2D(q.TEXTURE_2D,0,this.format,w,P,0,this.format,q.UNSIGNED_BYTE,c.data);else{var at=g||{x:0,y:0},vt=at.x,Ot=at.y;c instanceof $d||c instanceof O_||c instanceof C_||c instanceof Qv||Jv&&c instanceof Jv?q.texSubImage2D(q.TEXTURE_2D,0,vt,Ot,q.RGBA,q.UNSIGNED_BYTE,c):q.texSubImage2D(q.TEXTURE_2D,0,vt,Ot,w,P,q.RGBA,q.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&q.generateMipmap(q.TEXTURE_2D)},s0.prototype.bind=function(c,d,g){var w=this.context.gl;w.bindTexture(w.TEXTURE_2D,this.texture),g!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=w.LINEAR),c!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,c),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,g||c),this.filter=c),d!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,d),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,d),this.wrap=d)},s0.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},s0.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var tg=function(c){var d=this;this._callback=c,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};tg.prototype.trigger=function(){var c=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){c._triggered=!1,c._callback()},0))},tg.prototype.remove=function(){delete this._channel,this._callback=function(){}};var tl=function(c,d,g){this.target=c,this.parent=d,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Vn(["receive","process"],this),this.invoker=new tg(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=kt()?c:Lt};function R_(c,d,g){var w=2*Math.PI*6378137/256/Math.pow(2,g);return[c*w-2*Math.PI*6378137/2,d*w-2*Math.PI*6378137/2]}tl.prototype.send=function(c,d,g,w,P){var N=this;P===void 0&&(P=!1);var j=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[j]=g);var q=te(this.globalScope)?void 0:[];return this.target.postMessage({id:j,type:c,hasCallback:!!g,targetMapId:w,mustQueue:P,sourceMapId:this.mapId,data:pl(d,q)},q),{cancel:function(){g&&delete N.callbacks[j],N.target.postMessage({id:j,type:"<cancel>",targetMapId:w,sourceMapId:N.mapId})}}},tl.prototype.receive=function(c){var d=c.data,g=d.id;if(g&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[g];var w=this.cancelCallbacks[g];delete this.cancelCallbacks[g],w&&w()}else kt()||d.mustQueue?(this.tasks[g]=d,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,d)},tl.prototype.process=function(){if(this.taskQueue.length){var c=this.taskQueue.shift(),d=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(c,d)}},tl.prototype.processTask=function(c,d){var g=this;if(d.type==="<response>"){var w=this.callbacks[c];delete this.callbacks[c],w&&(d.error?w(ns(d.error)):w(null,ns(d.data)))}else{var P=!1,N=te(this.globalScope)?void 0:[],j=d.hasCallback?function(Ot,Dt){P=!0,delete g.cancelCallbacks[c],g.target.postMessage({id:c,type:"<response>",sourceMapId:g.mapId,error:Ot?pl(Ot):null,data:pl(Dt,N)},N)}:function(Ot){P=!0},q=null,at=ns(d.data);if(this.parent[d.type])q=this.parent[d.type](d.sourceMapId,at,j);else if(this.parent.getWorkerSource){var vt=d.type.split(".");q=this.parent.getWorkerSource(d.sourceMapId,vt[0],at.source)[vt[1]](at,j)}else j(new Error("Could not find function "+d.type));!P&&q&&q.cancel&&(this.cancelCallbacks[c]=q.cancel)}},tl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Tc=function(c,d){c&&(d?this.setSouthWest(c).setNorthEast(d):c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1]))};Tc.prototype.setNorthEast=function(c){return this._ne=c instanceof Za?new Za(c.lng,c.lat):Za.convert(c),this},Tc.prototype.setSouthWest=function(c){return this._sw=c instanceof Za?new Za(c.lng,c.lat):Za.convert(c),this},Tc.prototype.extend=function(c){var d,g,w=this._sw,P=this._ne;if(c instanceof Za)d=c,g=c;else{if(!(c instanceof Tc))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(Tc.convert(c)):this.extend(Za.convert(c)):this;if(g=c._ne,!(d=c._sw)||!g)return this}return w||P?(w.lng=Math.min(d.lng,w.lng),w.lat=Math.min(d.lat,w.lat),P.lng=Math.max(g.lng,P.lng),P.lat=Math.max(g.lat,P.lat)):(this._sw=new Za(d.lng,d.lat),this._ne=new Za(g.lng,g.lat)),this},Tc.prototype.getCenter=function(){return new Za((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tc.prototype.getSouthWest=function(){return this._sw},Tc.prototype.getNorthEast=function(){return this._ne},Tc.prototype.getNorthWest=function(){return new Za(this.getWest(),this.getNorth())},Tc.prototype.getSouthEast=function(){return new Za(this.getEast(),this.getSouth())},Tc.prototype.getWest=function(){return this._sw.lng},Tc.prototype.getSouth=function(){return this._sw.lat},Tc.prototype.getEast=function(){return this._ne.lng},Tc.prototype.getNorth=function(){return this._ne.lat},Tc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tc.prototype.contains=function(c){var d=Za.convert(c),g=d.lng,w=d.lat,P=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(P=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&P},Tc.convert=function(c){return!c||c instanceof Tc?c:new Tc(c)};var Za=function(c,d){if(isNaN(c)||isNaN(d))throw new Error("Invalid LngLat object: ("+c+", "+d+")");if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Za.prototype.wrap=function(){return new Za(fe(this.lng,-180,180),this.lat)},Za.prototype.toArray=function(){return[this.lng,this.lat]},Za.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Za.prototype.distanceTo=function(c){var d=Math.PI/180,g=this.lat*d,w=c.lat*d,P=Math.sin(g)*Math.sin(w)+Math.cos(g)*Math.cos(w)*Math.cos((c.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(P,1))},Za.prototype.toBounds=function(c){c===void 0&&(c=0);var d=360*c/40075017,g=d/Math.cos(Math.PI/180*this.lat);return new Tc(new Za(this.lng-g,this.lat-d),new Za(this.lng+g,this.lat+d))},Za.convert=function(c){if(c instanceof Za)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new Za(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new Za(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var sy=2*Math.PI*63710088e-1;function ax(c){return sy*Math.cos(c*Math.PI/180)}function eg(c){return(180+c)/360}function Ch(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function sx(c,d){return c/ax(d)}function sv(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}var Ip=function(c,d,g){g===void 0&&(g=0),this.x=+c,this.y=+d,this.z=+g};Ip.fromLngLat=function(c,d){d===void 0&&(d=0);var g=Za.convert(c);return new Ip(eg(g.lng),Ch(g.lat),sx(d,g.lat))},Ip.prototype.toLngLat=function(){return new Za(360*this.x-180,sv(this.y))},Ip.prototype.toAltitude=function(){return this.z*ax(sv(this.y))},Ip.prototype.meterInMercatorCoordinateUnits=function(){return 1/sy*(c=sv(this.y),1/Math.cos(c*Math.PI/180));var c};var Wu=function(c,d,g){this.z=c,this.x=d,this.y=g,this.key=Fc(0,c,c,d,g)};Wu.prototype.equals=function(c){return this.z===c.z&&this.x===c.x&&this.y===c.y},Wu.prototype.url=function(c,d){var g,w,P,N,j,q=(w=this.y,P=this.z,N=R_(256*(g=this.x),256*(w=Math.pow(2,P)-w-1),P),j=R_(256*(g+1),256*(w+1),P),N[0]+","+N[1]+","+j[0]+","+j[1]),at=function(vt,Ot,Dt){for(var Yt,pe="",Xe=vt;Xe>0;Xe--)pe+=(Ot&(Yt=1<<Xe-1)?1:0)+(Dt&Yt?2:0);return pe}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",at).replace("{bbox-epsg-3857}",q)},Wu.prototype.getTilePoint=function(c){var d=Math.pow(2,this.z);return new le(8192*(c.x*d-this.x),8192*(c.y*d-this.y))},Wu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Sa=function(c,d){this.wrap=c,this.canonical=d,this.key=Fc(c,d.z,d.z,d.x,d.y)},ec=function(c,d,g,w,P){this.overscaledZ=c,this.wrap=d,this.canonical=new Wu(g,+w,+P),this.key=Fc(d,c,g,w,P)};function Fc(c,d,g,w,P){(c*=2)<0&&(c=-1*c-1);var N=1<<g;return(N*N*c+N*P+w).toString(36)+g.toString(36)+d.toString(36)}ec.prototype.equals=function(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)},ec.prototype.scaledTo=function(c){var d=this.canonical.z-c;return c>this.canonical.z?new ec(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ec(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)},ec.prototype.calculateScaledKey=function(c,d){var g=this.canonical.z-c;return c>this.canonical.z?Fc(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y):Fc(this.wrap*+d,c,c,this.canonical.x>>g,this.canonical.y>>g)},ec.prototype.isChildOf=function(c){if(c.wrap!==this.wrap)return!1;var d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d},ec.prototype.children=function(c){if(this.overscaledZ>=c)return[new ec(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,g=2*this.canonical.x,w=2*this.canonical.y;return[new ec(d,this.wrap,d,g,w),new ec(d,this.wrap,d,g+1,w),new ec(d,this.wrap,d,g,w+1),new ec(d,this.wrap,d,g+1,w+1)]},ec.prototype.isLessThan=function(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))},ec.prototype.wrapped=function(){return new ec(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ec.prototype.unwrapTo=function(c){return new ec(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)},ec.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ec.prototype.toUnwrapped=function(){return new Sa(this.wrap,this.canonical)},ec.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ec.prototype.getTilePoint=function(c){return this.canonical.getTilePoint(new Ip(c.x-this.wrap,c.y))},fo("CanonicalTileID",Wu),fo("OverscaledTileID",ec,{omit:["posMatrix"]});var Lp=function(c,d,g){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return ke('"'+g+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var w=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=g||"mapbox";for(var P=0;P<w;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(w,P)]=this.data[this._idx(w-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,w)]=this.data[this._idx(P,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)]};Lp.prototype.get=function(c,d){var g=new Uint8Array(this.data.buffer),w=4*this._idx(c,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[w],g[w+1],g[w+2])},Lp.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Lp.prototype._idx=function(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)},Lp.prototype._unpackMapbox=function(c,d,g){return(256*c*256+256*d+g)/10-1e4},Lp.prototype._unpackTerrarium=function(c,d,g){return 256*c+d+g/256-32768},Lp.prototype.getPixels=function(){return new gu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Lp.prototype.backfillBorder=function(c,d,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");var w=d*this.dim,P=d*this.dim+this.dim,N=g*this.dim,j=g*this.dim+this.dim;switch(d){case-1:w=P-1;break;case 1:P=w+1}switch(g){case-1:N=j-1;break;case 1:j=N+1}for(var q=-d*this.dim,at=-g*this.dim,vt=N;vt<j;vt++)for(var Ot=w;Ot<P;Ot++)this.data[this._idx(Ot,vt)]=c.data[this._idx(Ot+q,vt+at)]},fo("DEMData",Lp);var Kd=function(c){this._stringToNumber={},this._numberToString=[];for(var d=0;d<c.length;d++){var g=c[d];this._stringToNumber[g]=d,this._numberToString[d]=g}};Kd.prototype.encode=function(c){return this._stringToNumber[c]},Kd.prototype.decode=function(c){return this._numberToString[c]};var Bs=function(c,d,g,w,P){this.type="Feature",this._vectorTileFeature=c,c._z=d,c._x=g,c._y=w,this.properties=c.properties,this.id=P},ly={geometry:{configurable:!0}};ly.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ly.geometry.set=function(c){this._geometry=c},Bs.prototype.toJSON=function(){var c={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(c[d]=this[d]);return c},Object.defineProperties(Bs.prototype,ly);var Qd=function(){this.state={},this.stateChanges={},this.deletedStates={}};Qd.prototype.updateState=function(c,d,g){var w=String(d);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][w]=this.stateChanges[c][w]||{},ce(this.stateChanges[c][w],g),this.deletedStates[c]===null)for(var P in this.deletedStates[c]={},this.state[c])P!==w&&(this.deletedStates[c][P]=null);else if(this.deletedStates[c]&&this.deletedStates[c][w]===null)for(var N in this.deletedStates[c][w]={},this.state[c][w])g[N]||(this.deletedStates[c][w][N]=null);else for(var j in g)this.deletedStates[c]&&this.deletedStates[c][w]&&this.deletedStates[c][w][j]===null&&delete this.deletedStates[c][w][j]},Qd.prototype.removeFeatureState=function(c,d,g){if(this.deletedStates[c]!==null){var w=String(d);if(this.deletedStates[c]=this.deletedStates[c]||{},g&&d!==void 0)this.deletedStates[c][w]!==null&&(this.deletedStates[c][w]=this.deletedStates[c][w]||{},this.deletedStates[c][w][g]=null);else if(d!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][w])for(g in this.deletedStates[c][w]={},this.stateChanges[c][w])this.deletedStates[c][w][g]=null;else this.deletedStates[c][w]=null;else this.deletedStates[c]=null}},Qd.prototype.getState=function(c,d){var g=String(d),w=ce({},(this.state[c]||{})[g],(this.stateChanges[c]||{})[g]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){var P=this.deletedStates[c][d];if(P===null)return{};for(var N in P)delete w[N]}return w},Qd.prototype.initializeTileState=function(c,d){c.setFeatureState(this.state,d)},Qd.prototype.coalesceChanges=function(c,d){var g={};for(var w in this.stateChanges){this.state[w]=this.state[w]||{};var P={};for(var N in this.stateChanges[w])this.state[w][N]||(this.state[w][N]={}),ce(this.state[w][N],this.stateChanges[w][N]),P[N]=this.state[w][N];g[w]=P}for(var j in this.deletedStates){this.state[j]=this.state[j]||{};var q={};if(this.deletedStates[j]===null)for(var at in this.state[j])q[at]={},this.state[j][at]={};else for(var vt in this.deletedStates[j]){if(this.deletedStates[j][vt]===null)this.state[j][vt]={};else for(var Ot=0,Dt=Object.keys(this.deletedStates[j][vt]);Ot<Dt.length;Ot+=1)delete this.state[j][vt][Dt[Ot]];q[vt]=this.state[j][vt]}g[j]=g[j]||{},ce(g[j],q)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(var Yt in c)c[Yt].setFeatureState(g,d)};var Rh=function(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Fa(8192,16,0),this.grid3D=new Fa(8192,16,0),this.featureIndexArray=new Rt,this.promoteId=d};function M_(c,d,g,w,P){return or(c,function(N,j){var q=d instanceof bp?d.get(j):null;return q&&q.evaluate?q.evaluate(g,w,P):q})}function P_(c){for(var d=1/0,g=1/0,w=-1/0,P=-1/0,N=0,j=c;N<j.length;N+=1){var q=j[N];d=Math.min(d,q.x),g=Math.min(g,q.y),w=Math.max(w,q.x),P=Math.max(P,q.y)}return{minX:d,minY:g,maxX:w,maxY:P}}function lx(c,d){return d-c}Rh.prototype.insert=function(c,d,g,w,P,N){var j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,w,P);for(var q=N?this.grid3D:this.grid,at=0;at<d.length;at++){for(var vt=d[at],Ot=[1/0,1/0,-1/0,-1/0],Dt=0;Dt<vt.length;Dt++){var Yt=vt[Dt];Ot[0]=Math.min(Ot[0],Yt.x),Ot[1]=Math.min(Ot[1],Yt.y),Ot[2]=Math.max(Ot[2],Yt.x),Ot[3]=Math.max(Ot[3],Yt.y)}Ot[0]<8192&&Ot[1]<8192&&Ot[2]>=0&&Ot[3]>=0&&q.insert(j,Ot[0],Ot[1],Ot[2],Ot[3])}},Rh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wh.VectorTile(new Rr(this.rawTileData)).layers,this.sourceLayerCoder=new Kd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Rh.prototype.query=function(c,d,g,w){var P=this;this.loadVTLayers();for(var N=c.params||{},j=8192/c.tileSize/c.scale,q=Du(N.filter),at=c.queryGeometry,vt=c.queryPadding*j,Ot=P_(at),Dt=this.grid.query(Ot.minX-vt,Ot.minY-vt,Ot.maxX+vt,Ot.maxY+vt),Yt=P_(c.cameraQueryGeometry),pe=this.grid3D.query(Yt.minX-vt,Yt.minY-vt,Yt.maxX+vt,Yt.maxY+vt,function(xr,Ir,Wr,Ci){return function(Ai,To,ao,Ro,Zi){for(var Ta=0,Qo=Ai;Ta<Qo.length;Ta+=1){var vo=Qo[Ta];if(To<=vo.x&&ao<=vo.y&&Ro>=vo.x&&Zi>=vo.y)return!0}var pa=[new le(To,ao),new le(To,Zi),new le(Ro,Zi),new le(Ro,ao)];if(Ai.length>2){for(var Ca=0,Ja=pa;Ca<Ja.length;Ca+=1)if(xf(Ai,Ja[Ca]))return!0}for(var Ho=0;Ho<Ai.length-1;Ho++)if(wi(Ai[Ho],Ai[Ho+1],pa))return!0;return!1}(c.cameraQueryGeometry,xr-vt,Ir-vt,Wr+vt,Ci+vt)}),Xe=0,en=pe;Xe<en.length;Xe+=1)Dt.push(en[Xe]);Dt.sort(lx);for(var kn,Sn={},sr=function(xr){var Ir=Dt[xr];if(Ir!==kn){kn=Ir;var Wr=P.featureIndexArray.get(Ir),Ci=null;P.loadMatchingFeature(Sn,Wr.bucketIndex,Wr.sourceLayerIndex,Wr.featureIndex,q,N.layers,N.availableImages,d,g,w,function(Ai,To,ao){return Ci||(Ci=vs(Ai)),To.queryIntersectsFeature(at,Ai,ao,Ci,P.z,c.transform,j,c.pixelPosMatrix)})}},pr=0;pr<Dt.length;pr++)sr(pr);return Sn},Rh.prototype.loadMatchingFeature=function(c,d,g,w,P,N,j,q,at,vt,Ot){var Dt=this.bucketLayerIDs[d];if(!N||function(Ai,To){for(var ao=0;ao<Ai.length;ao++)if(To.indexOf(Ai[ao])>=0)return!0;return!1}(N,Dt)){var Yt=this.sourceLayerCoder.decode(g),pe=this.vtLayers[Yt].feature(w);if(P.needGeometry){var Xe=Ks(pe,!0);if(!P.filter(new va(this.tileID.overscaledZ),Xe,this.tileID.canonical))return}else if(!P.filter(new va(this.tileID.overscaledZ),pe))return;for(var en=this.getId(pe,Yt),kn=0;kn<Dt.length;kn++){var Sn=Dt[kn];if(!(N&&N.indexOf(Sn)<0)){var sr=q[Sn];if(sr){var pr={};en!==void 0&&vt&&(pr=vt.getState(sr.sourceLayer||"_geojsonTileLayer",en));var xr=ce({},at[Sn]);xr.paint=M_(xr.paint,sr.paint,pe,pr,j),xr.layout=M_(xr.layout,sr.layout,pe,pr,j);var Ir=!Ot||Ot(pe,sr,pr);if(Ir){var Wr=new Bs(pe,this.z,this.x,this.y,en);Wr.layer=xr;var Ci=c[Sn];Ci===void 0&&(Ci=c[Sn]=[]),Ci.push({featureIndex:w,feature:Wr,intersectionZ:Ir})}}}}}},Rh.prototype.lookupSymbolFeatures=function(c,d,g,w,P,N,j,q){var at={};this.loadVTLayers();for(var vt=Du(P),Ot=0,Dt=c;Ot<Dt.length;Ot+=1)this.loadMatchingFeature(at,g,w,Dt[Ot],vt,N,j,q,d);return at},Rh.prototype.hasLayer=function(c){for(var d=0,g=this.bucketLayerIDs;d<g.length;d+=1)for(var w=0,P=g[d];w<P.length;w+=1)if(c===P[w])return!0;return!1},Rh.prototype.getId=function(c,d){var g=c.id;return this.promoteId&&typeof(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(g=Number(g)),g},fo("FeatureIndex",Rh,{omit:["rawTileData","sourceLayerCoder"]});var Kc=function(c,d){this.tileID=c,this.uid=Ze(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Kc.prototype.registerFadeDuration=function(c){var d=c+this.timeAdded;d<hr.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},Kc.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Kc.prototype.loadVectorData=function(c,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){for(var w in c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(vt,Ot){var Dt={};if(!Ot)return Dt;for(var Yt=function(){var en=Xe[pe],kn=en.layerIds.map(function(pr){return Ot.getLayer(pr)}).filter(Boolean);if(kn.length!==0){en.layers=kn,en.stateDependentLayerIds&&(en.stateDependentLayers=en.stateDependentLayerIds.map(function(pr){return kn.filter(function(xr){return xr.id===pr})[0]}));for(var Sn=0,sr=kn;Sn<sr.length;Sn+=1)Dt[sr[Sn].id]=en}},pe=0,Xe=vt;pe<Xe.length;pe+=1)Yt();return Dt}(c.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var P=this.buckets[w];if(P instanceof Bi){if(this.hasSymbolBuckets=!0,!g)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var N in this.buckets){var j=this.buckets[N];if(j instanceof Bi&&j.hasRTLText){this.hasRTLText=!0,vu.isLoading()||vu.isLoaded()||sm()!=="deferred"||Bu();break}}for(var q in this.queryPadding=0,this.buckets){var at=this.buckets[q];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(q).queryRadius(at))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new E},Kc.prototype.unloadVectorData=function(){for(var c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Kc.prototype.getBucket=function(c){return this.buckets[c.id]},Kc.prototype.upload=function(c){for(var d in this.buckets){var g=this.buckets[d];g.uploadPending()&&g.upload(c)}var w=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s0(c,this.imageAtlas.image,w.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s0(c,this.glyphAtlasImage,w.ALPHA),this.glyphAtlasImage=null)},Kc.prototype.prepare=function(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)},Kc.prototype.queryRenderedFeatures=function(c,d,g,w,P,N,j,q,at,vt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:w,cameraQueryGeometry:P,scale:N,tileSize:this.tileSize,pixelPosMatrix:vt,transform:q,params:j,queryPadding:this.queryPadding*at},c,d,g):{}},Kc.prototype.querySourceFeatures=function(c,d){var g=this.latestFeatureIndex;if(g&&g.rawTileData){var w=g.loadVTLayers(),P=d?d.sourceLayer:"",N=w._geojsonTileLayer||w[P];if(N)for(var j=Du(d&&d.filter),q=this.tileID.canonical,at=q.z,vt=q.x,Ot=q.y,Dt={z:at,x:vt,y:Ot},Yt=0;Yt<N.length;Yt++){var pe=N.feature(Yt);if(j.needGeometry){var Xe=Ks(pe,!0);if(!j.filter(new va(this.tileID.overscaledZ),Xe,this.tileID.canonical))continue}else if(!j.filter(new va(this.tileID.overscaledZ),pe))continue;var en=g.getId(pe,P),kn=new Bs(pe,at,vt,Ot,en);kn.tile=Dt,c.push(kn)}}},Kc.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Kc.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Kc.prototype.setExpiryData=function(c){var d=this.expirationTime;if(c.cacheControl){var g=Te(c.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){var w=Date.now(),P=!1;if(this.expirationTime>w)P=!1;else if(d)if(this.expirationTime<d)P=!0;else{var N=this.expirationTime-d;N?this.expirationTime=w+Math.max(N,3e4):P=!0}else P=!0;P?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Kc.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Kc.prototype.setFeatureState=function(c,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(c).length!==0){var g=this.latestFeatureIndex.loadVTLayers();for(var w in this.buckets)if(d.style.hasLayer(w)){var P=this.buckets[w],N=P.layers[0].sourceLayer||"_geojsonTileLayer",j=g[N],q=c[N];if(j&&q&&Object.keys(q).length!==0){P.update(q,j,this.imageAtlas&&this.imageAtlas.patternPositions||{});var at=d&&d.style&&d.style.getLayer(w);at&&(this.queryPadding=Math.max(this.queryPadding,at.queryRadius(P)))}}}},Kc.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Kc.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<hr.now()},Kc.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Kc.prototype.setHoldDuration=function(c){this.symbolFadeHoldUntil=hr.now()+c},Kc.prototype.setDependencies=function(c,d){for(var g={},w=0,P=d;w<P.length;w+=1)g[P[w]]=!0;this.dependencies[c]=g},Kc.prototype.hasDependency=function(c,d){for(var g=0,w=c;g<w.length;g+=1){var P=this.dependencies[w[g]];if(P){for(var N=0,j=d;N<j.length;N+=1)if(P[j[N]])return!0}}return!1};var l0=Lt.performance,cy=function(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},l0.mark(this._marks.start)};cy.prototype.finish=function(){l0.mark(this._marks.end);var c=l0.getEntriesByName(this._marks.measure);return c.length===0&&(l0.measure(this._marks.measure,this._marks.start,this._marks.end),c=l0.getEntriesByName(this._marks.measure),l0.clearMarks(this._marks.start),l0.clearMarks(this._marks.end),l0.clearMeasures(this._marks.measure)),c},R.Actor=tl,R.AlphaImage=io,R.CanonicalTileID=Wu,R.CollisionBoxArray=E,R.Color=tn,R.DEMData=Lp,R.DataConstantProperty=Ao,R.DictionaryCoder=Kd,R.EXTENT=8192,R.ErrorEvent=Ge,R.EvaluationParameters=va,R.Event=ue,R.Evented=ln,R.FeatureIndex=Rh,R.FillBucket=Sf,R.FillExtrusionBucket=lu,R.ImageAtlas=qr,R.ImagePosition=$i,R.LineBucket=cu,R.LngLat=Za,R.LngLatBounds=Tc,R.MercatorCoordinate=Ip,R.ONE_EM=24,R.OverscaledTileID=ec,R.Point=le,R.Point$1=le,R.Properties=ul,R.Protobuf=Rr,R.RGBAImage=gu,R.RequestManager=De,R.RequestPerformance=cy,R.ResourceType=bt,R.SegmentVector=be,R.SourceFeatureState=Qd,R.StructArrayLayout1ui2=L0,R.StructArrayLayout2f1f2i16=ah,R.StructArrayLayout2i4=Yh,R.StructArrayLayout3ui6=sh,R.StructArrayLayout4i8=Kp,R.SymbolBucket=Bi,R.Texture=s0,R.Tile=Kc,R.Transitionable=uc,R.Uniform1f=Yr,R.Uniform1i=ei,R.Uniform2f=Ti,R.Uniform3f=zi,R.Uniform4f=Io,R.UniformColor=Bo,R.UniformMatrix4f=ua,R.UnwrappedTileID=Sa,R.ValidationError=Fe,R.WritingMode=Uo,R.ZoomHistory=yp,R.add=function(c,d,g){return c[0]=d[0]+g[0],c[1]=d[1]+g[1],c[2]=d[2]+g[2],c},R.addDynamicAttributes=di,R.asyncAll=function(c,d,g){if(!c.length)return g(null,[]);var w=c.length,P=new Array(c.length),N=null;c.forEach(function(j,q){d(j,function(at,vt){at&&(N=at),P[q]=vt,--w==0&&g(N,P)})})},R.bezier=Nt,R.bindAll=Vn,R.browser=hr,R.cacheEntryPossiblyAdded=function(c){++Qt>Ce&&(c.getActor().send("enforceCacheSizeLimit",Kt),Qt=0)},R.clamp=Ie,R.clearTileCache=function(c){var d=Lt.caches.delete("mapbox-tiles");c&&d.catch(c).then(function(){return c()})},R.clipLine=ch,R.clone=function(c){var d=new No(16);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},R.clone$1=$t,R.clone$2=function(c){var d=new No(3);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d},R.collisionCircleLayout=xt,R.config=Er,R.create=function(){var c=new No(16);return No!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},R.create$1=function(){var c=new No(9);return No!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},R.create$2=function(){var c=new No(4);return No!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},R.createCommonjsModule=$e,R.createExpression=ks,R.createLayout=fc,R.createStyleLayer=function(c){return c.type==="custom"?new Kv(c):new Cd[c.type](c)},R.cross=function(c,d,g){var w=d[0],P=d[1],N=d[2],j=g[0],q=g[1],at=g[2];return c[0]=P*at-N*q,c[1]=N*j-w*at,c[2]=w*q-P*j,c},R.deepEqual=function c(d,g){if(Array.isArray(d)){if(!Array.isArray(g)||d.length!==g.length)return!1;for(var w=0;w<d.length;w++)if(!c(d[w],g[w]))return!1;return!0}if(typeof d=="object"&&d!==null&&g!==null){if(typeof g!="object"||Object.keys(d).length!==Object.keys(g).length)return!1;for(var P in d)if(!c(d[P],g[P]))return!1;return!0}return d===g},R.dot=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]},R.dot$1=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3]},R.ease=Jt,R.emitValidationErrors=ms,R.endsWith=mr,R.enforceCacheSizeLimit=function(c){xn(),ze&&ze.then(function(d){d.keys().then(function(g){for(var w=0;w<g.length-c;w++)d.delete(g[w])})})},R.evaluateSizeForFeature=tc,R.evaluateSizeForZoom=mc,R.evaluateVariableOffset=Fn,R.evented=xp,R.extend=ce,R.featureFilter=Du,R.filterObject=He,R.fromRotation=function(c,d){var g=Math.sin(d),w=Math.cos(d);return c[0]=w,c[1]=g,c[2]=0,c[3]=-g,c[4]=w,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},R.getAnchorAlignment=Js,R.getAnchorJustification=Yn,R.getArrayBuffer=Sr,R.getImage=ut,R.getJSON=function(c,d){return qn(ce(c,{type:"json"}),d)},R.getRTLTextPluginStatus=sm,R.getReferrer=me,R.getVideo=function(c,d){var g,w,P=Lt.document.createElement("video");P.muted=!0,P.onloadstart=function(){d(null,P)};for(var N=0;N<c.length;N++){var j=Lt.document.createElement("source");g=c[N],w=void 0,(w=Lt.document.createElement("a")).href=g,(w.protocol!==Lt.document.location.protocol||w.host!==Lt.document.location.host)&&(P.crossOrigin="Anonymous"),j.src=c[N],P.appendChild(j)}return{cancel:function(){}}},R.identity=Fl,R.invert=function(c,d){var g=d[0],w=d[1],P=d[2],N=d[3],j=d[4],q=d[5],at=d[6],vt=d[7],Ot=d[8],Dt=d[9],Yt=d[10],pe=d[11],Xe=d[12],en=d[13],kn=d[14],Sn=d[15],sr=g*q-w*j,pr=g*at-P*j,xr=g*vt-N*j,Ir=w*at-P*q,Wr=w*vt-N*q,Ci=P*vt-N*at,Ai=Ot*en-Dt*Xe,To=Ot*kn-Yt*Xe,ao=Ot*Sn-pe*Xe,Ro=Dt*kn-Yt*en,Zi=Dt*Sn-pe*en,Ta=Yt*Sn-pe*kn,Qo=sr*Ta-pr*Zi+xr*Ro+Ir*ao-Wr*To+Ci*Ai;return Qo?(c[0]=(q*Ta-at*Zi+vt*Ro)*(Qo=1/Qo),c[1]=(P*Zi-w*Ta-N*Ro)*Qo,c[2]=(en*Ci-kn*Wr+Sn*Ir)*Qo,c[3]=(Yt*Wr-Dt*Ci-pe*Ir)*Qo,c[4]=(at*ao-j*Ta-vt*To)*Qo,c[5]=(g*Ta-P*ao+N*To)*Qo,c[6]=(kn*xr-Xe*Ci-Sn*pr)*Qo,c[7]=(Ot*Ci-Yt*xr+pe*pr)*Qo,c[8]=(j*Zi-q*ao+vt*Ai)*Qo,c[9]=(w*ao-g*Zi-N*Ai)*Qo,c[10]=(Xe*Wr-en*xr+Sn*sr)*Qo,c[11]=(Dt*xr-Ot*Wr-pe*sr)*Qo,c[12]=(q*To-j*Ro-at*Ai)*Qo,c[13]=(g*Ro-w*To+P*Ai)*Qo,c[14]=(en*pr-Xe*Ir-kn*sr)*Qo,c[15]=(Ot*Ir-Dt*pr+Yt*sr)*Qo,c):null},R.isChar=Ri,R.isMapboxURL=Be,R.keysDifference=function(c,d){var g=[];for(var w in c)w in d||g.push(w);return g},R.makeRequest=qn,R.mapObject=or,R.mercatorXfromLng=eg,R.mercatorYfromLat=Ch,R.mercatorZfromAltitude=sx,R.mul=Hd,R.multiply=Xl,R.mvt=wh,R.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},R.normalize=function(c,d){var g=d[0],w=d[1],P=d[2],N=g*g+w*w+P*P;return N>0&&(N=1/Math.sqrt(N)),c[0]=d[0]*N,c[1]=d[1]*N,c[2]=d[2]*N,c},R.number=Ws,R.offscreenCanvasSupported=ct,R.ortho=function(c,d,g,w,P,N,j){var q=1/(d-g),at=1/(w-P),vt=1/(N-j);return c[0]=-2*q,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*at,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*vt,c[11]=0,c[12]=(d+g)*q,c[13]=(P+w)*at,c[14]=(j+N)*vt,c[15]=1,c},R.parseGlyphPBF=function(c){return new Rr(c).readFields(oi,[])},R.pbf=Rr,R.performSymbolLayout=function(c,d,g,w,P,N,j){c.createArrays(),c.tilePixelRatio=8192/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;var q=c.layers[0].layout,at=c.layers[0]._unevaluatedLayout._values,vt={};if(c.textSizeData.kind==="composite"){var Ot=c.textSizeData,Dt=Ot.maxZoom;vt.compositeTextSizes=[at["text-size"].possiblyEvaluate(new va(Ot.minZoom),j),at["text-size"].possiblyEvaluate(new va(Dt),j)]}if(c.iconSizeData.kind==="composite"){var Yt=c.iconSizeData,pe=Yt.maxZoom;vt.compositeIconSizes=[at["icon-size"].possiblyEvaluate(new va(Yt.minZoom),j),at["icon-size"].possiblyEvaluate(new va(pe),j)]}vt.layoutTextSize=at["text-size"].possiblyEvaluate(new va(c.zoom+1),j),vt.layoutIconSize=at["icon-size"].possiblyEvaluate(new va(c.zoom+1),j),vt.textMaxSize=at["text-size"].possiblyEvaluate(new va(18));for(var Xe=24*q.get("text-line-height"),en=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",kn=q.get("text-keep-upright"),Sn=q.get("text-size"),sr=function(){var Ir=xr[pr],Wr=q.get("text-font").evaluate(Ir,{},j).join(","),Ci=Sn.evaluate(Ir,{},j),Ai=vt.layoutTextSize.evaluate(Ir,{},j),To=vt.layoutIconSize.evaluate(Ir,{},j),ao={horizontal:{},vertical:void 0},Ro=Ir.text,Zi=[0,0];if(Ro){var Ta=Ro.toString(),Qo=24*q.get("text-letter-spacing").evaluate(Ir,{},j),vo=function(Ka){for(var Xs=0,Fs=Ka;Xs<Fs.length;Xs+=1)if(ds=Fs[Xs].charCodeAt(0),Ri.Arabic(ds)||Ri["Arabic Supplement"](ds)||Ri["Arabic Extended-A"](ds)||Ri["Arabic Presentation Forms-A"](ds)||Ri["Arabic Presentation Forms-B"](ds))return!1;var ds;return!0}(Ta)?Qo:0,pa=q.get("text-anchor").evaluate(Ir,{},j),Ca=q.get("text-variable-anchor");if(!Ca){var Ja=q.get("text-radial-offset").evaluate(Ir,{},j);Zi=Ja?Fn(pa,[24*Ja,In]):q.get("text-offset").evaluate(Ir,{},j).map(function(Ka){return 24*Ka})}var Ho=en?"center":q.get("text-justify").evaluate(Ir,{},j),Ts=q.get("symbol-placement"),_l=Ts==="point"?24*q.get("text-max-width").evaluate(Ir,{},j):0,zl=function(){c.allowVerticalPlacement&&eh(Ta)&&(ao.vertical=La(Ro,d,g,P,Wr,_l,Xe,pa,"left",vo,Zi,Uo.vertical,!0,Ts,Ai,Ci))};if(!en&&Ca){for(var jl=Ho==="auto"?Ca.map(function(Ka){return Yn(Ka)}):[Ho],xl=!1,nc=0;nc<jl.length;nc++){var Vs=jl[nc];if(!ao.horizontal[Vs])if(xl)ao.horizontal[Vs]=ao.horizontal[0];else{var wc=La(Ro,d,g,P,Wr,_l,Xe,"center",Vs,vo,Zi,Uo.horizontal,!1,Ts,Ai,Ci);wc&&(ao.horizontal[Vs]=wc,xl=wc.positionedLines.length===1)}}zl()}else{Ho==="auto"&&(Ho=Yn(pa));var Xu=La(Ro,d,g,P,Wr,_l,Xe,pa,Ho,vo,Zi,Uo.horizontal,!1,Ts,Ai,Ci);Xu&&(ao.horizontal[Ho]=Xu),zl(),eh(Ta)&&en&&kn&&(ao.vertical=La(Ro,d,g,P,Wr,_l,Xe,pa,Ho,vo,Zi,Uo.vertical,!1,Ts,Ai,Ci))}}var Uc=void 0,uu=!1;if(Ir.icon&&Ir.icon.name){var Vl=w[Ir.icon.name];Vl&&(Uc=function(Ka,Xs,Fs){var ds=Js(Fs),Yu=Xs[0]-Ka.displaySize[0]*ds.horizontalAlign,fu=Xs[1]-Ka.displaySize[1]*ds.verticalAlign;return{image:Ka,top:fu,bottom:fu+Ka.displaySize[1],left:Yu,right:Yu+Ka.displaySize[0]}}(P[Ir.icon.name],q.get("icon-offset").evaluate(Ir,{},j),q.get("icon-anchor").evaluate(Ir,{},j)),uu=Vl.sdf,c.sdfIcons===void 0?c.sdfIcons=Vl.sdf:c.sdfIcons!==Vl.sdf&&ke("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vl.pixelRatio!==c.pixelRatio||q.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}var zc=Nn(ao.horizontal)||ao.vertical;c.iconsInText=!!zc&&zc.iconsInText,(zc||Uc)&&function(Ka,Xs,Fs,ds,Yu,fu,Us,rc,Ac,is,qu){var zf=fu.textMaxSize.evaluate(Xs,{});zf===void 0&&(zf=Us);var Jd,ic=Ka.layers[0].layout,uh=ic.get("icon-offset").evaluate(Xs,{},qu),Tf=Nn(Fs.horizontal),tp=Us/24,td=Ka.tilePixelRatio*tp,c0=Ka.tilePixelRatio*zf/24,ed=Ka.tilePixelRatio*rc,u0=Ka.tilePixelRatio*ic.get("symbol-spacing"),vm=ic.get("text-padding")*Ka.tilePixelRatio,f0=ic.get("icon-padding")*Ka.tilePixelRatio,gm=ic.get("text-max-angle")/180*Math.PI,ng=ic.get("text-rotation-alignment")==="map"&&ic.get("symbol-placement")!=="point",uy=ic.get("icon-rotation-alignment")==="map"&&ic.get("symbol-placement")!=="point",nd=ic.get("symbol-placement"),Dp=u0/2,j0=ic.get("icon-text-fit");ds&&j0!=="none"&&(Ka.allowVerticalPlacement&&Fs.vertical&&(Jd=Ul(ds,Fs.vertical,j0,ic.get("icon-text-fit-padding"),uh,tp)),Tf&&(ds=Ul(ds,Tf,j0,ic.get("icon-text-fit-padding"),uh,tp)));var rd=function(ig,Sm){Sm.x<0||Sm.x>=8192||Sm.y<0||Sm.y>=8192||function(Cl,jc,id,Eu,dv,fy,og,ff,ag,pv,np,mv,Tm,I_,vv,L_,sg,D_,N_,lg,wf,H0,hy,rp,dy){var py,m0,Vc,wm,Am,G0=Cl.addToLineVertexArray(jc,id),v0=0,k_=0,vy=0,gy=0,Om=-1,cg=-1,Mh={},yy=Ye(""),gv=0,ug=0;if(ff._unevaluatedLayout.getValue("text-radial-offset")===void 0?(gv=(py=ff.layout.get("text-offset").evaluate(wf,{},rp).map(function(ip){return 24*ip}))[0],ug=py[1]):(gv=24*ff.layout.get("text-radial-offset").evaluate(wf,{},rp),ug=In),Cl.allowVerticalPlacement&&Eu.vertical){var Rl=ff.layout.get("text-rotate").evaluate(wf,{},rp)+90;wm=new ys(ag,jc,pv,np,mv,Eu.vertical,Tm,I_,vv,Rl),og&&(Am=new ys(ag,jc,pv,np,mv,og,sg,D_,vv,Rl))}if(dv){var _y=ff.layout.get("icon-rotate").evaluate(wf,{}),xy=ff.layout.get("icon-text-fit")!=="none",cx=We(dv,_y,hy,xy),B_=og?We(og,_y,hy,xy):void 0;Vc=new ys(ag,jc,pv,np,mv,dv,sg,D_,!1,_y),v0=4*cx.length;var fg=Cl.iconSizeData,Cm=null;fg.kind==="source"?(Cm=[128*ff.layout.get("icon-size").evaluate(wf,{})])[0]>32640&&ke(Cl.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fg.kind==="composite"&&((Cm=[128*H0.compositeIconSizes[0].evaluate(wf,{},rp),128*H0.compositeIconSizes[1].evaluate(wf,{},rp)])[0]>32640||Cm[1]>32640)&&ke(Cl.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Cl.addSymbols(Cl.icon,cx,Cm,lg,N_,wf,!1,jc,G0.lineStartIndex,G0.lineLength,-1,rp),Om=Cl.icon.placedSymbolArray.length-1,B_&&(k_=4*B_.length,Cl.addSymbols(Cl.icon,B_,Cm,lg,N_,wf,Uo.vertical,jc,G0.lineStartIndex,G0.lineLength,-1,rp),cg=Cl.icon.placedSymbolArray.length-1)}for(var ux in Eu.horizontal){var cs=Eu.horizontal[ux];if(!m0){yy=Ye(cs.text);var by=ff.layout.get("text-rotate").evaluate(wf,{},rp);m0=new ys(ag,jc,pv,np,mv,cs,Tm,I_,vv,by)}var hg=cs.positionedLines.length===1;if(vy+=an(Cl,jc,cs,fy,ff,vv,wf,L_,G0,Eu.vertical?Uo.horizontal:Uo.horizontalOnly,hg?Object.keys(Eu.horizontal):[ux],Mh,Om,H0,rp),hg)break}Eu.vertical&&(gy+=an(Cl,jc,Eu.vertical,fy,ff,vv,wf,L_,G0,Uo.vertical,["vertical"],Mh,cg,H0,rp));var Ph=m0?m0.boxStartIndex:Cl.collisionBoxArray.length,Rm=m0?m0.boxEndIndex:Cl.collisionBoxArray.length,Mm=wm?wm.boxStartIndex:Cl.collisionBoxArray.length,Ey=wm?wm.boxEndIndex:Cl.collisionBoxArray.length,W0=Vc?Vc.boxStartIndex:Cl.collisionBoxArray.length,yv=Vc?Vc.boxEndIndex:Cl.collisionBoxArray.length,dg=Am?Am.boxStartIndex:Cl.collisionBoxArray.length,fx=Am?Am.boxEndIndex:Cl.collisionBoxArray.length,od=-1,zp=function(ip,_v){return ip&&ip.circleDiameter?Math.max(ip.circleDiameter,_v):_v};od=zp(m0,od),od=zp(wm,od),od=zp(Vc,od);var g0=(od=zp(Am,od))>-1?1:0;g0&&(od*=dy/24),Cl.glyphOffsetArray.length>=Bi.MAX_GLYPHS&&ke("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wf.sortKey!==void 0&&Cl.addToSortKeyRanges(Cl.symbolInstances.length,wf.sortKey),Cl.symbolInstances.emplaceBack(jc.x,jc.y,Mh.right>=0?Mh.right:-1,Mh.center>=0?Mh.center:-1,Mh.left>=0?Mh.left:-1,Mh.vertical||-1,Om,cg,yy,Ph,Rm,Mm,Ey,W0,yv,dg,fx,pv,vy,gy,v0,k_,g0,0,Tm,gv,ug,od)}(Ka,Sm,ig,Fs,ds,Yu,Jd,Ka.layers[0],Ka.collisionBoxArray,Xs.index,Xs.sourceLayerIndex,Ka.index,td,vm,ng,Ac,ed,f0,uy,uh,Xs,fu,is,qu,Us)};if(nd==="line")for(var Np=0,lv=ch(Xs.geometry,0,0,8192,8192);Np<lv.length;Np+=1)for(var rg=lv[Np],ym=0,kp=$l(rg,u0,gm,Fs.vertical||Tf,ds,24,c0,Ka.overscaling,8192);ym<kp.length;ym+=1){var h0=kp[ym];Tf&&Re(Ka,Tf.text,Dp,h0)||rd(rg,h0)}else if(nd==="line-center")for(var _m=0,cv=Xs.geometry;_m<cv.length;_m+=1){var xm=cv[_m];if(xm.length>1){var uv=ja(xm,gm,Fs.vertical||Tf,ds,24,c0);uv&&rd(xm,uv)}}else if(Xs.type==="Polygon")for(var V0=0,Bp=yu(Xs.geometry,0);V0<Bp.length;V0+=1){var Fp=Bp[V0],d0=_n(Fp,16);rd(Fp[0],new rs(d0.x,d0.y,0))}else if(Xs.type==="LineString")for(var ep=0,p0=Xs.geometry;ep<p0.length;ep+=1){var Up=p0[ep];rd(Up,new rs(Up[0].x,Up[0].y,0))}else if(Xs.type==="Point")for(var bm=0,fv=Xs.geometry;bm<fv.length;bm+=1)for(var Em=0,hv=fv[bm];Em<hv.length;Em+=1){var Z0=hv[Em];rd([Z0],new rs(Z0.x,Z0.y,0))}}(c,Ir,ao,Uc,w,vt,Ai,To,Zi,uu,j)},pr=0,xr=c.features;pr<xr.length;pr+=1)sr();N&&c.generateCollisionDebugBuffers()},R.perspective=function(c,d,g,w,P){var N,j=1/Math.tan(d/2);return c[0]=j/g,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=j,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,P!=null&&P!==1/0?(c[10]=(P+w)*(N=1/(w-P)),c[14]=2*P*w*N):(c[10]=-1,c[14]=-2*w),c},R.pick=function(c,d){for(var g={},w=0;w<d.length;w++){var P=d[w];P in c&&(g[P]=c[P])}return g},R.plugin=vu,R.polygonIntersectsPolygon=_f,R.postMapLoadEvent=sn,R.postTurnstileEvent=zn,R.potpack=fa,R.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],R.register=fo,R.registerForPluginStateChange=function(c){return c({pluginStatus:kc,pluginURL:nh}),xp.on("pluginStateChange",c),c},R.renderColorRamp=lm,R.rotate=function(c,d,g){var w=d[0],P=d[1],N=d[2],j=d[3],q=Math.sin(g),at=Math.cos(g);return c[0]=w*at+N*q,c[1]=P*at+j*q,c[2]=w*-q+N*at,c[3]=P*-q+j*at,c},R.rotateX=function(c,d,g){var w=Math.sin(g),P=Math.cos(g),N=d[4],j=d[5],q=d[6],at=d[7],vt=d[8],Ot=d[9],Dt=d[10],Yt=d[11];return d!==c&&(c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[4]=N*P+vt*w,c[5]=j*P+Ot*w,c[6]=q*P+Dt*w,c[7]=at*P+Yt*w,c[8]=vt*P-N*w,c[9]=Ot*P-j*w,c[10]=Dt*P-q*w,c[11]=Yt*P-at*w,c},R.rotateZ=function(c,d,g){var w=Math.sin(g),P=Math.cos(g),N=d[0],j=d[1],q=d[2],at=d[3],vt=d[4],Ot=d[5],Dt=d[6],Yt=d[7];return d!==c&&(c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[0]=N*P+vt*w,c[1]=j*P+Ot*w,c[2]=q*P+Dt*w,c[3]=at*P+Yt*w,c[4]=vt*P-N*w,c[5]=Ot*P-j*w,c[6]=Dt*P-q*w,c[7]=Yt*P-at*w,c},R.scale=function(c,d,g){var w=g[0],P=g[1],N=g[2];return c[0]=d[0]*w,c[1]=d[1]*w,c[2]=d[2]*w,c[3]=d[3]*w,c[4]=d[4]*P,c[5]=d[5]*P,c[6]=d[6]*P,c[7]=d[7]*P,c[8]=d[8]*N,c[9]=d[9]*N,c[10]=d[10]*N,c[11]=d[11]*N,c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],c},R.scale$1=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c[3]=d[3]*g,c},R.scale$2=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c},R.setCacheLimits=function(c,d){Kt=c,Ce=d},R.setRTLTextPlugin=function(c,d,g){if(g===void 0&&(g=!1),kc==="deferred"||kc==="loading"||kc==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");nh=hr.resolveURL(c),kc="deferred",$p=d,Td(),g||Bu()},R.sphericalToCartesian=function(c){var d=c[0],g=c[1],w=c[2];return g+=90,g*=Math.PI/180,w*=Math.PI/180,{x:d*Math.cos(g)*Math.sin(w),y:d*Math.sin(g)*Math.sin(w),z:d*Math.cos(w)}},R.sqrLen=function(c){var d=c[0],g=c[1];return d*d+g*g},R.styleSpec=ee,R.sub=function(c,d,g){return c[0]=d[0]-g[0],c[1]=d[1]-g[1],c[2]=d[2]-g[2],c},R.symbolSize=Oa,R.transformMat3=function(c,d,g){var w=d[0],P=d[1],N=d[2];return c[0]=w*g[0]+P*g[3]+N*g[6],c[1]=w*g[1]+P*g[4]+N*g[7],c[2]=w*g[2]+P*g[5]+N*g[8],c},R.transformMat4=lf,R.translate=function(c,d,g){var w,P,N,j,q,at,vt,Ot,Dt,Yt,pe,Xe,en=g[0],kn=g[1],Sn=g[2];return d===c?(c[12]=d[0]*en+d[4]*kn+d[8]*Sn+d[12],c[13]=d[1]*en+d[5]*kn+d[9]*Sn+d[13],c[14]=d[2]*en+d[6]*kn+d[10]*Sn+d[14],c[15]=d[3]*en+d[7]*kn+d[11]*Sn+d[15]):(P=d[1],N=d[2],j=d[3],q=d[4],at=d[5],vt=d[6],Ot=d[7],Dt=d[8],Yt=d[9],pe=d[10],Xe=d[11],c[0]=w=d[0],c[1]=P,c[2]=N,c[3]=j,c[4]=q,c[5]=at,c[6]=vt,c[7]=Ot,c[8]=Dt,c[9]=Yt,c[10]=pe,c[11]=Xe,c[12]=w*en+q*kn+Dt*Sn+d[12],c[13]=P*en+at*kn+Yt*Sn+d[13],c[14]=N*en+vt*kn+pe*Sn+d[14],c[15]=j*en+Ot*kn+Xe*Sn+d[15]),c},R.triggerPluginCompletionEvent=Jm,R.uniqueId=Ze,R.validateCustomStyleLayer=function(c){var d=[],g=c.id;return g===void 0&&d.push({message:"layers."+g+': missing required property "id"'}),c.render===void 0&&d.push({message:"layers."+g+': missing required method "render"'}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&d.push({message:"layers."+g+': property "renderingMode" must be either "2d" or "3d"'}),d},R.validateLight=qi,R.validateStyle=vi,R.values=function(c){var d=[];for(var g in c)d.push(c[g]);return d},R.vectorTile=wh,R.version="1.13.3",R.warnOnce=ke,R.webpSupported=Ue,R.window=Lt,R.wrap=fe}),pt(["./shared"],function(R){"use strict";function $e(ht){var ut=typeof ht;if(ut==="number"||ut==="boolean"||ut==="string"||ht==null)return JSON.stringify(ht);if(Array.isArray(ht)){for(var wt="[",Gt=0,ue=ht;Gt<ue.length;Gt+=1)wt+=$e(ue[Gt])+",";return wt+"]"}for(var Ge=Object.keys(ht).sort(),ln="{",ee=0;ee<Ge.length;ee++)ln+=JSON.stringify(Ge[ee])+":"+$e(ht[Ge[ee]])+",";return ln+"}"}function yt(ht){for(var ut="",wt=0,Gt=R.refProperties;wt<Gt.length;wt+=1)ut+="/"+$e(ht[Gt[wt]]);return ut}var xe=function(ht){this.keyCache={},ht&&this.replace(ht)};xe.prototype.replace=function(ht){this._layerConfigs={},this._layers={},this.update(ht,[])},xe.prototype.update=function(ht,ut){for(var wt=this,Gt=0,ue=ht;Gt<ue.length;Gt+=1){var Ge=ue[Gt];this._layerConfigs[Ge.id]=Ge;var ln=this._layers[Ge.id]=R.createStyleLayer(Ge);ln._featureFilter=R.featureFilter(ln.filter),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id]}for(var ee=0,Fe=ut;ee<Fe.length;ee+=1){var Hn=Fe[ee];delete this.keyCache[Hn],delete this._layerConfigs[Hn],delete this._layers[Hn]}this.familiesBySource={};for(var Tr=0,Zr=function(mi,xi){for(var wo={},Li=0;Li<mi.length;Li++){var aa=xi&&xi[mi[Li].id]||yt(mi[Li]);xi&&(xi[mi[Li].id]=aa);var Pa=wo[aa];Pa||(Pa=wo[aa]=[]),Pa.push(mi[Li])}var Lo=[];for(var $o in wo)Lo.push(wo[$o]);return Lo}(R.values(this._layerConfigs),this.keyCache);Tr<Zr.length;Tr+=1){var vr=Zr[Tr].map(function(mi){return wt._layers[mi.id]}),Ur=vr[0];if(Ur.visibility!=="none"){var jr=Ur.source||"",ni=this.familiesBySource[jr];ni||(ni=this.familiesBySource[jr]={});var Ar=Ur.sourceLayer||"_geojsonTileLayer",pi=ni[Ar];pi||(pi=ni[Ar]=[]),pi.push(vr)}}};var le=function(ht){var ut={},wt=[];for(var Gt in ht){var ue=ht[Gt],Ge=ut[Gt]={};for(var ln in ue){var ee=ue[+ln];if(ee&&ee.bitmap.width!==0&&ee.bitmap.height!==0){var Fe={x:0,y:0,w:ee.bitmap.width+2,h:ee.bitmap.height+2};wt.push(Fe),Ge[ln]={rect:Fe,metrics:ee.metrics}}}}var Hn=R.potpack(wt),Tr=new R.AlphaImage({width:Hn.w||1,height:Hn.h||1});for(var Zr in ht){var vr=ht[Zr];for(var Ur in vr){var jr=vr[+Ur];if(jr&&jr.bitmap.width!==0&&jr.bitmap.height!==0){var ni=ut[Zr][Ur].rect;R.AlphaImage.copy(jr.bitmap,Tr,{x:0,y:0},{x:ni.x+1,y:ni.y+1},jr.bitmap)}}}this.image=Tr,this.positions=ut};R.register("GlyphAtlas",le);var Le=function(ht){this.tileID=new R.OverscaledTileID(ht.tileID.overscaledZ,ht.tileID.wrap,ht.tileID.canonical.z,ht.tileID.canonical.x,ht.tileID.canonical.y),this.uid=ht.uid,this.zoom=ht.zoom,this.pixelRatio=ht.pixelRatio,this.tileSize=ht.tileSize,this.source=ht.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ht.showCollisionBoxes,this.collectResourceTiming=!!ht.collectResourceTiming,this.returnDependencies=!!ht.returnDependencies,this.promoteId=ht.promoteId};function Lt(ht,ut,wt){for(var Gt=new R.EvaluationParameters(ut),ue=0,Ge=ht;ue<Ge.length;ue+=1)Ge[ue].recalculate(Gt,wt)}function fn(ht,ut){var wt=R.getArrayBuffer(ht.request,function(Gt,ue,Ge,ln){Gt?ut(Gt):ue&&ut(null,{vectorTile:new R.vectorTile.VectorTile(new R.pbf(ue)),rawData:ue,cacheControl:Ge,expires:ln})});return function(){wt.cancel(),ut()}}Le.prototype.parse=function(ht,ut,wt,Gt,ue){var Ge=this;this.status="parsing",this.data=ht,this.collisionBoxArray=new R.CollisionBoxArray;var ln=new R.DictionaryCoder(Object.keys(ht.layers).sort()),ee=new R.FeatureIndex(this.tileID,this.promoteId);ee.bucketLayerIDs=[];var Fe,Hn,Tr,Zr,vr={},Ur={featureIndex:ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:wt},jr=ut.familiesBySource[this.source];for(var ni in jr){var Ar=ht.layers[ni];if(Ar){Ar.version===1&&R.warnOnce('Vector tile source "'+this.source+'" layer "'+ni+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var pi=ln.encode(ni),mi=[],xi=0;xi<Ar.length;xi++){var wo=Ar.feature(xi),Li=ee.getId(wo,ni);mi.push({feature:wo,id:Li,index:xi,sourceLayerIndex:pi})}for(var aa=0,Pa=jr[ni];aa<Pa.length;aa+=1){var Lo=Pa[aa],$o=Lo[0];$o.minzoom&&this.zoom<Math.floor($o.minzoom)||$o.maxzoom&&this.zoom>=$o.maxzoom||$o.visibility!=="none"&&(Lt(Lo,this.zoom,wt),(vr[$o.id]=$o.createBucket({index:ee.bucketLayerIDs.length,layers:Lo,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pi,sourceID:this.source})).populate(mi,Ur,this.tileID.canonical),ee.bucketLayerIDs.push(Lo.map(function(Rn){return Rn.id})))}}}var Mt=R.mapObject(Ur.glyphDependencies,function(Rn){return Object.keys(Rn).map(Number)});Object.keys(Mt).length?Gt.send("getGlyphs",{uid:this.uid,stacks:Mt},function(Rn,Pn){Fe||(Fe=Rn,Hn=Pn,qe.call(Ge))}):Hn={};var Wt=Object.keys(Ur.iconDependencies);Wt.length?Gt.send("getImages",{icons:Wt,source:this.source,tileID:this.tileID,type:"icons"},function(Rn,Pn){Fe||(Fe=Rn,Tr=Pn,qe.call(Ge))}):Tr={};var Se=Object.keys(Ur.patternDependencies);function qe(){if(Fe)return ue(Fe);if(Hn&&Tr&&Zr){var Rn=new le(Hn),Pn=new R.ImageAtlas(Tr,Zr);for(var tn in vr){var mn=vr[tn];mn instanceof R.SymbolBucket?(Lt(mn.layers,this.zoom,wt),R.performSymbolLayout(mn,Hn,Rn.positions,Tr,Pn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):mn.hasPattern&&(mn instanceof R.LineBucket||mn instanceof R.FillBucket||mn instanceof R.FillExtrusionBucket)&&(Lt(mn.layers,this.zoom,wt),mn.addFeatures(Ur,this.tileID.canonical,Pn.patternPositions))}this.status="done",ue(null,{buckets:R.values(vr).filter(function(dr){return!dr.isEmpty()}),featureIndex:ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:Pn,glyphMap:this.returnDependencies?Hn:null,iconMap:this.returnDependencies?Tr:null,glyphPositions:this.returnDependencies?Rn.positions:null})}}Se.length?Gt.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"patterns"},function(Rn,Pn){Fe||(Fe=Rn,Zr=Pn,qe.call(Ge))}):Zr={},qe.call(this)};var Nt=function(ht,ut,wt,Gt){this.actor=ht,this.layerIndex=ut,this.availableImages=wt,this.loadVectorData=Gt||fn,this.loading={},this.loaded={}};Nt.prototype.loadTile=function(ht,ut){var wt=this,Gt=ht.uid;this.loading||(this.loading={});var ue=!!(ht&&ht.request&&ht.request.collectResourceTiming)&&new R.RequestPerformance(ht.request),Ge=this.loading[Gt]=new Le(ht);Ge.abort=this.loadVectorData(ht,function(ln,ee){if(delete wt.loading[Gt],ln||!ee)return Ge.status="done",wt.loaded[Gt]=Ge,ut(ln);var Fe=ee.rawData,Hn={};ee.expires&&(Hn.expires=ee.expires),ee.cacheControl&&(Hn.cacheControl=ee.cacheControl);var Tr={};if(ue){var Zr=ue.finish();Zr&&(Tr.resourceTiming=JSON.parse(JSON.stringify(Zr)))}Ge.vectorTile=ee.vectorTile,Ge.parse(ee.vectorTile,wt.layerIndex,wt.availableImages,wt.actor,function(vr,Ur){if(vr||!Ur)return ut(vr);ut(null,R.extend({rawTileData:Fe.slice(0)},Ur,Hn,Tr))}),wt.loaded=wt.loaded||{},wt.loaded[Gt]=Ge})},Nt.prototype.reloadTile=function(ht,ut){var wt=this,Gt=this.loaded,ue=ht.uid,Ge=this;if(Gt&&Gt[ue]){var ln=Gt[ue];ln.showCollisionBoxes=ht.showCollisionBoxes;var ee=function(Fe,Hn){var Tr=ln.reloadCallback;Tr&&(delete ln.reloadCallback,ln.parse(ln.vectorTile,Ge.layerIndex,wt.availableImages,Ge.actor,Tr)),ut(Fe,Hn)};ln.status==="parsing"?ln.reloadCallback=ee:ln.status==="done"&&(ln.vectorTile?ln.parse(ln.vectorTile,this.layerIndex,this.availableImages,this.actor,ee):ee())}},Nt.prototype.abortTile=function(ht,ut){var wt=this.loading,Gt=ht.uid;wt&&wt[Gt]&&wt[Gt].abort&&(wt[Gt].abort(),delete wt[Gt]),ut()},Nt.prototype.removeTile=function(ht,ut){var wt=this.loaded,Gt=ht.uid;wt&&wt[Gt]&&delete wt[Gt],ut()};var Jt=R.window.ImageBitmap,Ie=function(){this.loaded={}};function fe(ht,ut){if(ht.length!==0){ce(ht[0],ut);for(var wt=1;wt<ht.length;wt++)ce(ht[wt],!ut)}}function ce(ht,ut){for(var wt=0,Gt=0,ue=0,Ge=ht.length,ln=Ge-1;ue<Ge;ln=ue++){var ee=(ht[ue][0]-ht[ln][0])*(ht[ln][1]+ht[ue][1]),Fe=wt+ee;Gt+=Math.abs(wt)>=Math.abs(ee)?wt-Fe+ee:ee-Fe+wt,wt=Fe}wt+Gt>=0!=!!ut&&ht.reverse()}Ie.prototype.loadTile=function(ht,ut){var wt=ht.uid,Gt=ht.encoding,ue=ht.rawImageData,Ge=Jt&&ue instanceof Jt?this.getImageData(ue):ue,ln=new R.DEMData(wt,Ge,Gt);this.loaded=this.loaded||{},this.loaded[wt]=ln,ut(null,ln)},Ie.prototype.getImageData=function(ht){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ht.width,ht.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ht.width,this.offscreenCanvas.height=ht.height,this.offscreenCanvasContext.drawImage(ht,0,0,ht.width,ht.height);var ut=this.offscreenCanvasContext.getImageData(-1,-1,ht.width+2,ht.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new R.RGBAImage({width:ut.width,height:ut.height},ut.data)},Ie.prototype.removeTile=function(ht){var ut=this.loaded,wt=ht.uid;ut&&ut[wt]&&delete ut[wt]};var ve=R.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ze=function(ht){this._feature=ht,this.extent=R.EXTENT,this.type=ht.type,this.properties=ht.tags,"id"in ht&&!isNaN(ht.id)&&(this.id=parseInt(ht.id,10))};Ze.prototype.loadGeometry=function(){if(this._feature.type===1){for(var ht=[],ut=0,wt=this._feature.geometry;ut<wt.length;ut+=1){var Gt=wt[ut];ht.push([new R.Point$1(Gt[0],Gt[1])])}return ht}for(var ue=[],Ge=0,ln=this._feature.geometry;Ge<ln.length;Ge+=1){for(var ee=[],Fe=0,Hn=ln[Ge];Fe<Hn.length;Fe+=1){var Tr=Hn[Fe];ee.push(new R.Point$1(Tr[0],Tr[1]))}ue.push(ee)}return ue},Ze.prototype.toGeoJSON=function(ht,ut,wt){return ve.call(this,ht,ut,wt)};var Un=function(ht){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=R.EXTENT,this.length=ht.length,this._features=ht};Un.prototype.feature=function(ht){return new Ze(this._features[ht])};var En=R.vectorTile.VectorTileFeature,Vn=mr;function mr(ht,ut){this.options=ut||{},this.features=ht,this.length=ht.length}function or(ht,ut){this.id=typeof ht.id=="number"?ht.id:void 0,this.type=ht.type,this.rawGeometry=ht.type===1?[ht.geometry]:ht.geometry,this.properties=ht.tags,this.extent=ut||4096}mr.prototype.feature=function(ht){return new or(this.features[ht],this.options.extent)},or.prototype.loadGeometry=function(){var ht=this.rawGeometry;this.geometry=[];for(var ut=0;ut<ht.length;ut++){for(var wt=ht[ut],Gt=[],ue=0;ue<wt.length;ue++)Gt.push(new R.Point$1(wt[ue][0],wt[ue][1]));this.geometry.push(Gt)}return this.geometry},or.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ht=this.geometry,ut=1/0,wt=-1/0,Gt=1/0,ue=-1/0,Ge=0;Ge<ht.length;Ge++)for(var ln=ht[Ge],ee=0;ee<ln.length;ee++){var Fe=ln[ee];ut=Math.min(ut,Fe.x),wt=Math.max(wt,Fe.x),Gt=Math.min(Gt,Fe.y),ue=Math.max(ue,Fe.y)}return[ut,Gt,wt,ue]},or.prototype.toGeoJSON=En.prototype.toGeoJSON;var He=nn,$t=Vn;function nn(ht){var ut=new R.pbf;return function(wt,Gt){for(var ue in wt.layers)Gt.writeMessage(3,ke,wt.layers[ue])}(ht,ut),ut.finish()}function ke(ht,ut){var wt;ut.writeVarintField(15,ht.version||1),ut.writeStringField(1,ht.name||""),ut.writeVarintField(5,ht.extent||4096);var Gt={keys:[],values:[],keycache:{},valuecache:{}};for(wt=0;wt<ht.length;wt++)Gt.feature=ht.feature(wt),ut.writeMessage(2,Je,Gt);var ue=Gt.keys;for(wt=0;wt<ue.length;wt++)ut.writeStringField(3,ue[wt]);var Ge=Gt.values;for(wt=0;wt<Ge.length;wt++)ut.writeMessage(4,te,Ge[wt])}function Je(ht,ut){var wt=ht.feature;wt.id!==void 0&&ut.writeVarintField(1,wt.id),ut.writeMessage(2,er,ht),ut.writeVarintField(3,wt.type),ut.writeMessage(4,gt,wt)}function er(ht,ut){var wt=ht.feature,Gt=ht.keys,ue=ht.values,Ge=ht.keycache,ln=ht.valuecache;for(var ee in wt.properties){var Fe=Ge[ee];Fe===void 0&&(Gt.push(ee),Ge[ee]=Fe=Gt.length-1),ut.writeVarint(Fe);var Hn=wt.properties[ee],Tr=typeof Hn;Tr!=="string"&&Tr!=="boolean"&&Tr!=="number"&&(Hn=JSON.stringify(Hn));var Zr=Tr+":"+Hn,vr=ln[Zr];vr===void 0&&(ue.push(Hn),ln[Zr]=vr=ue.length-1),ut.writeVarint(vr)}}function kt(ht,ut){return(ut<<3)+(7&ht)}function Te(ht){return ht<<1^ht>>31}function gt(ht,ut){for(var wt=ht.loadGeometry(),Gt=ht.type,ue=0,Ge=0,ln=wt.length,ee=0;ee<ln;ee++){var Fe=wt[ee],Hn=1;Gt===1&&(Hn=Fe.length),ut.writeVarint(kt(1,Hn));for(var Tr=Gt===3?Fe.length-1:Fe.length,Zr=0;Zr<Tr;Zr++){Zr===1&&Gt!==1&&ut.writeVarint(kt(2,Tr-1));var vr=Fe[Zr].x-ue,Ur=Fe[Zr].y-Ge;ut.writeVarint(Te(vr)),ut.writeVarint(Te(Ur)),ue+=vr,Ge+=Ur}Gt===3&&ut.writeVarint(kt(7,1))}}function te(ht,ut){var wt=typeof ht;wt==="string"?ut.writeStringField(1,ht):wt==="boolean"?ut.writeBooleanField(7,ht):wt==="number"&&(ht%1!=0?ut.writeDoubleField(3,ht):ht<0?ut.writeSVarintField(6,ht):ut.writeVarintField(5,ht))}function Zt(ht,ut,wt,Gt){Ut(ht,wt,Gt),Ut(ut,2*wt,2*Gt),Ut(ut,2*wt+1,2*Gt+1)}function Ut(ht,ut,wt){var Gt=ht[ut];ht[ut]=ht[wt],ht[wt]=Gt}function we(ht,ut,wt,Gt){var ue=ht-wt,Ge=ut-Gt;return ue*ue+Ge*Ge}He.fromVectorTileJs=nn,He.fromGeojsonVt=function(ht,ut){ut=ut||{};var wt={};for(var Gt in ht)wt[Gt]=new Vn(ht[Gt].features,ut),wt[Gt].name=Gt,wt[Gt].version=ut.version,wt[Gt].extent=ut.extent;return nn({layers:wt})},He.GeoJSONWrapper=$t;var ie=function(ht){return ht[0]},_t=function(ht){return ht[1]},Ne=function(ht,ut,wt,Gt,ue){ut===void 0&&(ut=ie),wt===void 0&&(wt=_t),Gt===void 0&&(Gt=64),ue===void 0&&(ue=Float64Array),this.nodeSize=Gt,this.points=ht;for(var Ge=ht.length<65536?Uint16Array:Uint32Array,ln=this.ids=new Ge(ht.length),ee=this.coords=new ue(2*ht.length),Fe=0;Fe<ht.length;Fe++)ln[Fe]=Fe,ee[2*Fe]=ut(ht[Fe]),ee[2*Fe+1]=wt(ht[Fe]);(function Hn(Tr,Zr,vr,Ur,jr,ni){if(!(jr-Ur<=vr)){var Ar=Ur+jr>>1;(function pi(mi,xi,wo,Li,aa,Pa){for(;aa>Li;){if(aa-Li>600){var Lo=aa-Li+1,$o=wo-Li+1,Mt=Math.log(Lo),Wt=.5*Math.exp(2*Mt/3),Se=.5*Math.sqrt(Mt*Wt*(Lo-Wt)/Lo)*($o-Lo/2<0?-1:1);pi(mi,xi,wo,Math.max(Li,Math.floor(wo-$o*Wt/Lo+Se)),Math.min(aa,Math.floor(wo+(Lo-$o)*Wt/Lo+Se)),Pa)}var qe=xi[2*wo+Pa],Rn=Li,Pn=aa;for(Zt(mi,xi,Li,wo),xi[2*aa+Pa]>qe&&Zt(mi,xi,Li,aa);Rn<Pn;){for(Zt(mi,xi,Rn,Pn),Rn++,Pn--;xi[2*Rn+Pa]<qe;)Rn++;for(;xi[2*Pn+Pa]>qe;)Pn--}xi[2*Li+Pa]===qe?Zt(mi,xi,Li,Pn):Zt(mi,xi,++Pn,aa),Pn<=wo&&(Li=Pn+1),wo<=Pn&&(aa=Pn-1)}})(Tr,Zr,Ar,Ur,jr,ni%2),Hn(Tr,Zr,vr,Ur,Ar-1,ni+1),Hn(Tr,Zr,vr,Ar+1,jr,ni+1)}})(ln,ee,Gt,0,ln.length-1,0)};Ne.prototype.range=function(ht,ut,wt,Gt){return function(ue,Ge,ln,ee,Fe,Hn,Tr){for(var Zr,vr,Ur=[0,ue.length-1,0],jr=[];Ur.length;){var ni=Ur.pop(),Ar=Ur.pop(),pi=Ur.pop();if(Ar-pi<=Tr)for(var mi=pi;mi<=Ar;mi++)vr=Ge[2*mi+1],(Zr=Ge[2*mi])>=ln&&Zr<=Fe&&vr>=ee&&vr<=Hn&&jr.push(ue[mi]);else{var xi=Math.floor((pi+Ar)/2);vr=Ge[2*xi+1],(Zr=Ge[2*xi])>=ln&&Zr<=Fe&&vr>=ee&&vr<=Hn&&jr.push(ue[xi]);var wo=(ni+1)%2;(ni===0?ln<=Zr:ee<=vr)&&(Ur.push(pi),Ur.push(xi-1),Ur.push(wo)),(ni===0?Fe>=Zr:Hn>=vr)&&(Ur.push(xi+1),Ur.push(Ar),Ur.push(wo))}}return jr}(this.ids,this.coords,ht,ut,wt,Gt,this.nodeSize)},Ne.prototype.within=function(ht,ut,wt){return function(Gt,ue,Ge,ln,ee,Fe){for(var Hn=[0,Gt.length-1,0],Tr=[],Zr=ee*ee;Hn.length;){var vr=Hn.pop(),Ur=Hn.pop(),jr=Hn.pop();if(Ur-jr<=Fe)for(var ni=jr;ni<=Ur;ni++)we(ue[2*ni],ue[2*ni+1],Ge,ln)<=Zr&&Tr.push(Gt[ni]);else{var Ar=Math.floor((jr+Ur)/2),pi=ue[2*Ar],mi=ue[2*Ar+1];we(pi,mi,Ge,ln)<=Zr&&Tr.push(Gt[Ar]);var xi=(vr+1)%2;(vr===0?Ge-ee<=pi:ln-ee<=mi)&&(Hn.push(jr),Hn.push(Ar-1),Hn.push(xi)),(vr===0?Ge+ee>=pi:ln+ee>=mi)&&(Hn.push(Ar+1),Hn.push(Ur),Hn.push(xi))}}return Tr}(this.ids,this.coords,ht,ut,wt,this.nodeSize)};var un={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ht){return ht}},Qn=function(ht){this.options=rn(Object.create(un),ht),this.trees=new Array(this.options.maxZoom+1)};function hr(ht,ut,wt,Gt,ue){return{x:ht,y:ut,zoom:1/0,id:wt,parentId:-1,numPoints:Gt,properties:ue}}function Er(ht,ut){var wt=ht.geometry.coordinates,Gt=wt[1];return{x:wn(wt[0]),y:ir(Gt),zoom:1/0,index:ut,parentId:-1}}function Ue(ht){return{type:"Feature",id:ht.id,properties:cn(ht),geometry:{type:"Point",coordinates:[(Gt=ht.x,360*(Gt-.5)),(ut=ht.y,wt=(180-360*ut)*Math.PI/180,360*Math.atan(Math.exp(wt))/Math.PI-90)]}};var ut,wt,Gt}function cn(ht){var ut=ht.numPoints,wt=ut>=1e4?Math.round(ut/1e3)+"k":ut>=1e3?Math.round(ut/100)/10+"k":ut;return rn(rn({},ht.properties),{cluster:!0,cluster_id:ht.id,point_count:ut,point_count_abbreviated:wt})}function wn(ht){return ht/360+.5}function ir(ht){var ut=Math.sin(ht*Math.PI/180),wt=.5-.25*Math.log((1+ut)/(1-ut))/Math.PI;return wt<0?0:wt>1?1:wt}function rn(ht,ut){for(var wt in ut)ht[wt]=ut[wt];return ht}function De(ht){return ht.x}function Be(ht){return ht.y}function At(ht,ut,wt,Gt,ue,Ge){var ln=ue-wt,ee=Ge-Gt;if(ln!==0||ee!==0){var Fe=((ht-wt)*ln+(ut-Gt)*ee)/(ln*ln+ee*ee);Fe>1?(wt=ue,Gt=Ge):Fe>0&&(wt+=ln*Fe,Gt+=ee*Fe)}return(ln=ht-wt)*ln+(ee=ut-Gt)*ee}function Bt(ht,ut,wt,Gt){var ue={id:ht===void 0?null:ht,type:ut,geometry:wt,tags:Gt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ge){var ln=Ge.geometry,ee=Ge.type;if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Ae(Ge,ln);else if(ee==="Polygon"||ee==="MultiLineString")for(var Fe=0;Fe<ln.length;Fe++)Ae(Ge,ln[Fe]);else if(ee==="MultiPolygon")for(Fe=0;Fe<ln.length;Fe++)for(var Hn=0;Hn<ln[Fe].length;Hn++)Ae(Ge,ln[Fe][Hn])}(ue),ue}function Ae(ht,ut){for(var wt=0;wt<ut.length;wt+=3)ht.minX=Math.min(ht.minX,ut[wt]),ht.minY=Math.min(ht.minY,ut[wt+1]),ht.maxX=Math.max(ht.maxX,ut[wt]),ht.maxY=Math.max(ht.maxY,ut[wt+1])}function z(ht,ut,wt,Gt){if(ut.geometry){var ue=ut.geometry.coordinates,Ge=ut.geometry.type,ln=Math.pow(wt.tolerance/((1<<wt.maxZoom)*wt.extent),2),ee=[],Fe=ut.id;if(wt.promoteId?Fe=ut.properties[wt.promoteId]:wt.generateId&&(Fe=Gt||0),Ge==="Point")rt(ue,ee);else if(Ge==="MultiPoint")for(var Hn=0;Hn<ue.length;Hn++)rt(ue[Hn],ee);else if(Ge==="LineString")F(ue,ee,ln,!1);else if(Ge==="MultiLineString"){if(wt.lineMetrics){for(Hn=0;Hn<ue.length;Hn++)F(ue[Hn],ee=[],ln,!1),ht.push(Bt(Fe,"LineString",ee,ut.properties));return}ot(ue,ee,ln,!1)}else if(Ge==="Polygon")ot(ue,ee,ln,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(Hn=0;Hn<ut.geometry.geometries.length;Hn++)z(ht,{id:Fe,geometry:ut.geometry.geometries[Hn],properties:ut.properties},wt,Gt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Hn=0;Hn<ue.length;Hn++){var Tr=[];ot(ue[Hn],Tr,ln,!0),ee.push(Tr)}}ht.push(Bt(Fe,Ge,ee,ut.properties))}}function rt(ht,ut){ut.push(ze(ht[0])),ut.push(Vt(ht[1])),ut.push(0)}function F(ht,ut,wt,Gt){for(var ue,Ge,ln=0,ee=0;ee<ht.length;ee++){var Fe=ze(ht[ee][0]),Hn=Vt(ht[ee][1]);ut.push(Fe),ut.push(Hn),ut.push(0),ee>0&&(ln+=Gt?(ue*Hn-Fe*Ge)/2:Math.sqrt(Math.pow(Fe-ue,2)+Math.pow(Hn-Ge,2))),ue=Fe,Ge=Hn}var Tr=ut.length-3;ut[2]=1,function Zr(vr,Ur,jr,ni){for(var Ar,pi=ni,mi=jr-Ur>>1,xi=jr-Ur,wo=vr[Ur],Li=vr[Ur+1],aa=vr[jr],Pa=vr[jr+1],Lo=Ur+3;Lo<jr;Lo+=3){var $o=At(vr[Lo],vr[Lo+1],wo,Li,aa,Pa);if($o>pi)Ar=Lo,pi=$o;else if($o===pi){var Mt=Math.abs(Lo-mi);Mt<xi&&(Ar=Lo,xi=Mt)}}pi>ni&&(Ar-Ur>3&&Zr(vr,Ur,Ar,ni),vr[Ar+2]=pi,jr-Ar>3&&Zr(vr,Ar,jr,ni))}(ut,0,Tr,wt),ut[Tr+2]=1,ut.size=Math.abs(ln),ut.start=0,ut.end=ut.size}function ot(ht,ut,wt,Gt){for(var ue=0;ue<ht.length;ue++){var Ge=[];F(ht[ue],Ge,wt,Gt),ut.push(Ge)}}function ze(ht){return ht/360+.5}function Vt(ht){var ut=Math.sin(ht*Math.PI/180),wt=.5-.25*Math.log((1+ut)/(1-ut))/Math.PI;return wt<0?0:wt>1?1:wt}function ae(ht,ut,wt,Gt,ue,Ge,ln,ee){if(Gt/=ut,Ge>=(wt/=ut)&&ln<Gt)return ht;if(ln<wt||Ge>=Gt)return null;for(var Fe=[],Hn=0;Hn<ht.length;Hn++){var Tr=ht[Hn],Zr=Tr.geometry,vr=Tr.type,Ur=ue===0?Tr.minX:Tr.minY,jr=ue===0?Tr.maxX:Tr.maxY;if(Ur>=wt&&jr<Gt)Fe.push(Tr);else if(!(jr<wt||Ur>=Gt)){var ni=[];if(vr==="Point"||vr==="MultiPoint")Mn(Zr,ni,wt,Gt,ue);else if(vr==="LineString")zn(Zr,ni,wt,Gt,ue,!1,ee.lineMetrics);else if(vr==="MultiLineString")sn(Zr,ni,wt,Gt,ue,!1);else if(vr==="Polygon")sn(Zr,ni,wt,Gt,ue,!0);else if(vr==="MultiPolygon")for(var Ar=0;Ar<Zr.length;Ar++){var pi=[];sn(Zr[Ar],pi,wt,Gt,ue,!0),pi.length&&ni.push(pi)}if(ni.length){if(ee.lineMetrics&&vr==="LineString"){for(Ar=0;Ar<ni.length;Ar++)Fe.push(Bt(Tr.id,vr,ni[Ar],Tr.tags));continue}vr!=="LineString"&&vr!=="MultiLineString"||(ni.length===1?(vr="LineString",ni=ni[0]):vr="MultiLineString"),vr!=="Point"&&vr!=="MultiPoint"||(vr=ni.length===3?"Point":"MultiPoint"),Fe.push(Bt(Tr.id,vr,ni,Tr.tags))}}}return Fe.length?Fe:null}function Mn(ht,ut,wt,Gt,ue){for(var Ge=0;Ge<ht.length;Ge+=3){var ln=ht[Ge+ue];ln>=wt&&ln<=Gt&&(ut.push(ht[Ge]),ut.push(ht[Ge+1]),ut.push(ht[Ge+2]))}}function zn(ht,ut,wt,Gt,ue,Ge,ln){for(var ee,Fe,Hn=Wn(ht),Tr=ue===0?Ce:xn,Zr=ht.start,vr=0;vr<ht.length-3;vr+=3){var Ur=ht[vr],jr=ht[vr+1],ni=ht[vr+2],Ar=ht[vr+3],pi=ht[vr+4],mi=ue===0?Ur:jr,xi=ue===0?Ar:pi,wo=!1;ln&&(ee=Math.sqrt(Math.pow(Ur-Ar,2)+Math.pow(jr-pi,2))),mi<wt?xi>wt&&(Fe=Tr(Hn,Ur,jr,Ar,pi,wt),ln&&(Hn.start=Zr+ee*Fe)):mi>Gt?xi<Gt&&(Fe=Tr(Hn,Ur,jr,Ar,pi,Gt),ln&&(Hn.start=Zr+ee*Fe)):Kt(Hn,Ur,jr,ni),xi<wt&&mi>=wt&&(Fe=Tr(Hn,Ur,jr,Ar,pi,wt),wo=!0),xi>Gt&&mi<=Gt&&(Fe=Tr(Hn,Ur,jr,Ar,pi,Gt),wo=!0),!Ge&&wo&&(ln&&(Hn.end=Zr+ee*Fe),ut.push(Hn),Hn=Wn(ht)),ln&&(Zr+=ee)}var Li=ht.length-3;Ur=ht[Li],jr=ht[Li+1],ni=ht[Li+2],(mi=ue===0?Ur:jr)>=wt&&mi<=Gt&&Kt(Hn,Ur,jr,ni),Li=Hn.length-3,Ge&&Li>=3&&(Hn[Li]!==Hn[0]||Hn[Li+1]!==Hn[1])&&Kt(Hn,Hn[0],Hn[1],Hn[2]),Hn.length&&ut.push(Hn)}function Wn(ht){var ut=[];return ut.size=ht.size,ut.start=ht.start,ut.end=ht.end,ut}function sn(ht,ut,wt,Gt,ue,Ge){for(var ln=0;ln<ht.length;ln++)zn(ht[ln],ut,wt,Gt,ue,Ge,!1)}function Kt(ht,ut,wt,Gt){ht.push(ut),ht.push(wt),ht.push(Gt)}function Ce(ht,ut,wt,Gt,ue,Ge){var ln=(Ge-ut)/(Gt-ut);return ht.push(Ge),ht.push(wt+(ue-wt)*ln),ht.push(1),ln}function xn(ht,ut,wt,Gt,ue,Ge){var ln=(Ge-wt)/(ue-wt);return ht.push(ut+(Gt-ut)*ln),ht.push(Ge),ht.push(1),ln}function Cn(ht,ut){for(var wt=[],Gt=0;Gt<ht.length;Gt++){var ue,Ge=ht[Gt],ln=Ge.type;if(ln==="Point"||ln==="MultiPoint"||ln==="LineString")ue=Zn(Ge.geometry,ut);else if(ln==="MultiLineString"||ln==="Polygon"){ue=[];for(var ee=0;ee<Ge.geometry.length;ee++)ue.push(Zn(Ge.geometry[ee],ut))}else if(ln==="MultiPolygon")for(ue=[],ee=0;ee<Ge.geometry.length;ee++){for(var Fe=[],Hn=0;Hn<Ge.geometry[ee].length;Hn++)Fe.push(Zn(Ge.geometry[ee][Hn],ut));ue.push(Fe)}wt.push(Bt(Ge.id,ln,ue,Ge.tags))}return wt}function Zn(ht,ut){var wt=[];wt.size=ht.size,ht.start!==void 0&&(wt.start=ht.start,wt.end=ht.end);for(var Gt=0;Gt<ht.length;Gt+=3)wt.push(ht[Gt]+ut,ht[Gt+1],ht[Gt+2]);return wt}function Qt(ht,ut){if(ht.transformed)return ht;var wt,Gt,ue,Ge=1<<ht.z,ln=ht.x,ee=ht.y;for(wt=0;wt<ht.features.length;wt++){var Fe=ht.features[wt],Hn=Fe.geometry,Tr=Fe.type;if(Fe.geometry=[],Tr===1)for(Gt=0;Gt<Hn.length;Gt+=2)Fe.geometry.push(ct(Hn[Gt],Hn[Gt+1],ut,Ge,ln,ee));else for(Gt=0;Gt<Hn.length;Gt++){var Zr=[];for(ue=0;ue<Hn[Gt].length;ue+=2)Zr.push(ct(Hn[Gt][ue],Hn[Gt][ue+1],ut,Ge,ln,ee));Fe.geometry.push(Zr)}}return ht.transformed=!0,ht}function ct(ht,ut,wt,Gt,ue,Ge){return[Math.round(wt*(ht*Gt-ue)),Math.round(wt*(ut*Gt-Ge))]}function bt(ht,ut,wt,Gt,ue){for(var Ge=ut===ue.maxZoom?0:ue.tolerance/((1<<ut)*ue.extent),ln={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:wt,y:Gt,z:ut,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ee=0;ee<ht.length;ee++){ln.numFeatures++,zt(ln,ht[ee],Ge,ue);var Fe=ht[ee].minX,Hn=ht[ee].minY,Tr=ht[ee].maxX,Zr=ht[ee].maxY;Fe<ln.minX&&(ln.minX=Fe),Hn<ln.minY&&(ln.minY=Hn),Tr>ln.maxX&&(ln.maxX=Tr),Zr>ln.maxY&&(ln.maxY=Zr)}return ln}function zt(ht,ut,wt,Gt){var ue=ut.geometry,Ge=ut.type,ln=[];if(Ge==="Point"||Ge==="MultiPoint")for(var ee=0;ee<ue.length;ee+=3)ln.push(ue[ee]),ln.push(ue[ee+1]),ht.numPoints++,ht.numSimplified++;else if(Ge==="LineString")me(ln,ue,ht,wt,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(ee=0;ee<ue.length;ee++)me(ln,ue[ee],ht,wt,Ge==="Polygon",ee===0);else if(Ge==="MultiPolygon")for(var Fe=0;Fe<ue.length;Fe++){var Hn=ue[Fe];for(ee=0;ee<Hn.length;ee++)me(ln,Hn[ee],ht,wt,!0,ee===0)}if(ln.length){var Tr=ut.tags||null;if(Ge==="LineString"&&Gt.lineMetrics){for(var Zr in Tr={},ut.tags)Tr[Zr]=ut.tags[Zr];Tr.mapbox_clip_start=ue.start/ue.size,Tr.mapbox_clip_end=ue.end/ue.size}var vr={geometry:ln,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Tr};ut.id!==null&&(vr.id=ut.id),ht.features.push(vr)}}function me(ht,ut,wt,Gt,ue,Ge){var ln=Gt*Gt;if(Gt>0&&ut.size<(ue?ln:Gt))wt.numPoints+=ut.length/3;else{for(var ee=[],Fe=0;Fe<ut.length;Fe+=3)(Gt===0||ut[Fe+2]>ln)&&(wt.numSimplified++,ee.push(ut[Fe]),ee.push(ut[Fe+1])),wt.numPoints++;ue&&function(Hn,Tr){for(var Zr=0,vr=0,Ur=Hn.length,jr=Ur-2;vr<Ur;jr=vr,vr+=2)Zr+=(Hn[vr]-Hn[jr])*(Hn[vr+1]+Hn[jr+1]);if(Zr>0===Tr)for(vr=0,Ur=Hn.length;vr<Ur/2;vr+=2){var ni=Hn[vr],Ar=Hn[vr+1];Hn[vr]=Hn[Ur-2-vr],Hn[vr+1]=Hn[Ur-1-vr],Hn[Ur-2-vr]=ni,Hn[Ur-1-vr]=Ar}}(ee,Ge),ht.push(ee)}}function de(ht,ut){var wt=(ut=this.options=function(ue,Ge){for(var ln in Ge)ue[ln]=Ge[ln];return ue}(Object.create(this.options),ut)).debug;if(wt&&console.time("preprocess data"),ut.maxZoom<0||ut.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ut.promoteId&&ut.generateId)throw new Error("promoteId and generateId cannot be used together.");var Gt=function(ue,Ge){var ln=[];if(ue.type==="FeatureCollection")for(var ee=0;ee<ue.features.length;ee++)z(ln,ue.features[ee],Ge,ee);else z(ln,ue.type==="Feature"?ue:{geometry:ue},Ge);return ln}(ht,ut);this.tiles={},this.tileCoords=[],wt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ut.indexMaxZoom,ut.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Gt=function(ue,Ge){var ln=Ge.buffer/Ge.extent,ee=ue,Fe=ae(ue,1,-1-ln,ln,0,-1,2,Ge),Hn=ae(ue,1,1-ln,2+ln,0,-1,2,Ge);return(Fe||Hn)&&(ee=ae(ue,1,-ln,1+ln,0,-1,2,Ge)||[],Fe&&(ee=Cn(Fe,1).concat(ee)),Hn&&(ee=ee.concat(Cn(Hn,-1)))),ee}(Gt,ut)).length&&this.splitTile(Gt,0,0,0),wt&&(Gt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function bn(ht,ut,wt){return 32*((1<<ht)*wt+ut)+ht}function qn(ht,ut){var wt=ht.tileID.canonical;if(!this._geoJSONIndex)return ut(null,null);var Gt=this._geoJSONIndex.getTile(wt.z,wt.x,wt.y);if(!Gt)return ut(null,null);var ue=new Un(Gt.features),Ge=He(ue);Ge.byteOffset===0&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),ut(null,{vectorTile:ue,rawData:Ge.buffer})}Qn.prototype.load=function(ht){var ut=this.options,wt=ut.log,Gt=ut.minZoom,ue=ut.maxZoom,Ge=ut.nodeSize;wt&&console.time("total time");var ln="prepare "+ht.length+" points";wt&&console.time(ln),this.points=ht;for(var ee=[],Fe=0;Fe<ht.length;Fe++)ht[Fe].geometry&&ee.push(Er(ht[Fe],Fe));this.trees[ue+1]=new Ne(ee,De,Be,Ge,Float32Array),wt&&console.timeEnd(ln);for(var Hn=ue;Hn>=Gt;Hn--){var Tr=+Date.now();ee=this._cluster(ee,Hn),this.trees[Hn]=new Ne(ee,De,Be,Ge,Float32Array),wt&&console.log("z%d: %d clusters in %dms",Hn,ee.length,+Date.now()-Tr)}return wt&&console.timeEnd("total time"),this},Qn.prototype.getClusters=function(ht,ut){var wt=((ht[0]+180)%360+360)%360-180,Gt=Math.max(-90,Math.min(90,ht[1])),ue=ht[2]===180?180:((ht[2]+180)%360+360)%360-180,Ge=Math.max(-90,Math.min(90,ht[3]));if(ht[2]-ht[0]>=360)wt=-180,ue=180;else if(wt>ue){var ln=this.getClusters([wt,Gt,180,Ge],ut),ee=this.getClusters([-180,Gt,ue,Ge],ut);return ln.concat(ee)}for(var Fe=this.trees[this._limitZoom(ut)],Hn=[],Tr=0,Zr=Fe.range(wn(wt),ir(Ge),wn(ue),ir(Gt));Tr<Zr.length;Tr+=1){var vr=Fe.points[Zr[Tr]];Hn.push(vr.numPoints?Ue(vr):this.points[vr.index])}return Hn},Qn.prototype.getChildren=function(ht){var ut=this._getOriginId(ht),wt=this._getOriginZoom(ht),Gt="No cluster with the specified id.",ue=this.trees[wt];if(!ue)throw new Error(Gt);var Ge=ue.points[ut];if(!Ge)throw new Error(Gt);for(var ln=this.options.radius/(this.options.extent*Math.pow(2,wt-1)),ee=[],Fe=0,Hn=ue.within(Ge.x,Ge.y,ln);Fe<Hn.length;Fe+=1){var Tr=ue.points[Hn[Fe]];Tr.parentId===ht&&ee.push(Tr.numPoints?Ue(Tr):this.points[Tr.index])}if(ee.length===0)throw new Error(Gt);return ee},Qn.prototype.getLeaves=function(ht,ut,wt){var Gt=[];return this._appendLeaves(Gt,ht,ut=ut||10,wt=wt||0,0),Gt},Qn.prototype.getTile=function(ht,ut,wt){var Gt=this.trees[this._limitZoom(ht)],ue=Math.pow(2,ht),Ge=this.options,ln=Ge.radius/Ge.extent,ee=(wt-ln)/ue,Fe=(wt+1+ln)/ue,Hn={features:[]};return this._addTileFeatures(Gt.range((ut-ln)/ue,ee,(ut+1+ln)/ue,Fe),Gt.points,ut,wt,ue,Hn),ut===0&&this._addTileFeatures(Gt.range(1-ln/ue,ee,1,Fe),Gt.points,ue,wt,ue,Hn),ut===ue-1&&this._addTileFeatures(Gt.range(0,ee,ln/ue,Fe),Gt.points,-1,wt,ue,Hn),Hn.features.length?Hn:null},Qn.prototype.getClusterExpansionZoom=function(ht){for(var ut=this._getOriginZoom(ht)-1;ut<=this.options.maxZoom;){var wt=this.getChildren(ht);if(ut++,wt.length!==1)break;ht=wt[0].properties.cluster_id}return ut},Qn.prototype._appendLeaves=function(ht,ut,wt,Gt,ue){for(var Ge=0,ln=this.getChildren(ut);Ge<ln.length;Ge+=1){var ee=ln[Ge],Fe=ee.properties;if(Fe&&Fe.cluster?ue+Fe.point_count<=Gt?ue+=Fe.point_count:ue=this._appendLeaves(ht,Fe.cluster_id,wt,Gt,ue):ue<Gt?ue++:ht.push(ee),ht.length===wt)break}return ue},Qn.prototype._addTileFeatures=function(ht,ut,wt,Gt,ue,Ge){for(var ln=0,ee=ht;ln<ee.length;ln+=1){var Fe=ut[ee[ln]],Hn=Fe.numPoints,Tr={type:1,geometry:[[Math.round(this.options.extent*(Fe.x*ue-wt)),Math.round(this.options.extent*(Fe.y*ue-Gt))]],tags:Hn?cn(Fe):this.points[Fe.index].properties},Zr=void 0;Hn?Zr=Fe.id:this.options.generateId?Zr=Fe.index:this.points[Fe.index].id&&(Zr=this.points[Fe.index].id),Zr!==void 0&&(Tr.id=Zr),Ge.features.push(Tr)}},Qn.prototype._limitZoom=function(ht){return Math.max(this.options.minZoom,Math.min(+ht,this.options.maxZoom+1))},Qn.prototype._cluster=function(ht,ut){for(var wt=[],Gt=this.options,ue=Gt.reduce,Ge=Gt.minPoints,ln=Gt.radius/(Gt.extent*Math.pow(2,ut)),ee=0;ee<ht.length;ee++){var Fe=ht[ee];if(!(Fe.zoom<=ut)){Fe.zoom=ut;for(var Hn=this.trees[ut+1],Tr=Hn.within(Fe.x,Fe.y,ln),Zr=Fe.numPoints||1,vr=Zr,Ur=0,jr=Tr;Ur<jr.length;Ur+=1){var ni=Hn.points[jr[Ur]];ni.zoom>ut&&(vr+=ni.numPoints||1)}if(vr>=Ge){for(var Ar=Fe.x*Zr,pi=Fe.y*Zr,mi=ue&&Zr>1?this._map(Fe,!0):null,xi=(ee<<5)+(ut+1)+this.points.length,wo=0,Li=Tr;wo<Li.length;wo+=1){var aa=Hn.points[Li[wo]];if(!(aa.zoom<=ut)){aa.zoom=ut;var Pa=aa.numPoints||1;Ar+=aa.x*Pa,pi+=aa.y*Pa,aa.parentId=xi,ue&&(mi||(mi=this._map(Fe,!0)),ue(mi,this._map(aa)))}}Fe.parentId=xi,wt.push(hr(Ar/vr,pi/vr,xi,vr,mi))}else if(wt.push(Fe),vr>1)for(var Lo=0,$o=Tr;Lo<$o.length;Lo+=1){var Mt=Hn.points[$o[Lo]];Mt.zoom<=ut||(Mt.zoom=ut,wt.push(Mt))}}}return wt},Qn.prototype._getOriginId=function(ht){return ht-this.points.length>>5},Qn.prototype._getOriginZoom=function(ht){return(ht-this.points.length)%32},Qn.prototype._map=function(ht,ut){if(ht.numPoints)return ut?rn({},ht.properties):ht.properties;var wt=this.points[ht.index].properties,Gt=this.options.map(wt);return ut&&Gt===wt?rn({},Gt):Gt},de.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},de.prototype.splitTile=function(ht,ut,wt,Gt,ue,Ge,ln){for(var ee=[ht,ut,wt,Gt],Fe=this.options,Hn=Fe.debug;ee.length;){Gt=ee.pop(),wt=ee.pop(),ut=ee.pop(),ht=ee.pop();var Tr=1<<ut,Zr=bn(ut,wt,Gt),vr=this.tiles[Zr];if(!vr&&(Hn>1&&console.time("creation"),vr=this.tiles[Zr]=bt(ht,ut,wt,Gt,Fe),this.tileCoords.push({z:ut,x:wt,y:Gt}),Hn)){Hn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ut,wt,Gt,vr.numFeatures,vr.numPoints,vr.numSimplified),console.timeEnd("creation"));var Ur="z"+ut;this.stats[Ur]=(this.stats[Ur]||0)+1,this.total++}if(vr.source=ht,ue){if(ut===Fe.maxZoom||ut===ue)continue;var jr=1<<ue-ut;if(wt!==Math.floor(Ge/jr)||Gt!==Math.floor(ln/jr))continue}else if(ut===Fe.indexMaxZoom||vr.numPoints<=Fe.indexMaxPoints)continue;if(vr.source=null,ht.length!==0){Hn>1&&console.time("clipping");var ni,Ar,pi,mi,xi,wo,Li=.5*Fe.buffer/Fe.extent,aa=.5-Li,Pa=.5+Li,Lo=1+Li;ni=Ar=pi=mi=null,xi=ae(ht,Tr,wt-Li,wt+Pa,0,vr.minX,vr.maxX,Fe),wo=ae(ht,Tr,wt+aa,wt+Lo,0,vr.minX,vr.maxX,Fe),ht=null,xi&&(ni=ae(xi,Tr,Gt-Li,Gt+Pa,1,vr.minY,vr.maxY,Fe),Ar=ae(xi,Tr,Gt+aa,Gt+Lo,1,vr.minY,vr.maxY,Fe),xi=null),wo&&(pi=ae(wo,Tr,Gt-Li,Gt+Pa,1,vr.minY,vr.maxY,Fe),mi=ae(wo,Tr,Gt+aa,Gt+Lo,1,vr.minY,vr.maxY,Fe),wo=null),Hn>1&&console.timeEnd("clipping"),ee.push(ni||[],ut+1,2*wt,2*Gt),ee.push(Ar||[],ut+1,2*wt,2*Gt+1),ee.push(pi||[],ut+1,2*wt+1,2*Gt),ee.push(mi||[],ut+1,2*wt+1,2*Gt+1)}}},de.prototype.getTile=function(ht,ut,wt){var Gt=this.options,ue=Gt.extent,Ge=Gt.debug;if(ht<0||ht>24)return null;var ln=1<<ht,ee=bn(ht,ut=(ut%ln+ln)%ln,wt);if(this.tiles[ee])return Qt(this.tiles[ee],ue);Ge>1&&console.log("drilling down to z%d-%d-%d",ht,ut,wt);for(var Fe,Hn=ht,Tr=ut,Zr=wt;!Fe&&Hn>0;)Hn--,Tr=Math.floor(Tr/2),Zr=Math.floor(Zr/2),Fe=this.tiles[bn(Hn,Tr,Zr)];return Fe&&Fe.source?(Ge>1&&console.log("found parent tile z%d-%d-%d",Hn,Tr,Zr),Ge>1&&console.time("drilling down"),this.splitTile(Fe.source,Hn,Tr,Zr,ht,ut,wt),Ge>1&&console.timeEnd("drilling down"),this.tiles[ee]?Qt(this.tiles[ee],ue):null):null};var Sr=function(ht){function ut(wt,Gt,ue,Ge){ht.call(this,wt,Gt,ue,qn),Ge&&(this.loadGeoJSON=Ge)}return ht&&(ut.__proto__=ht),(ut.prototype=Object.create(ht&&ht.prototype)).constructor=ut,ut.prototype.loadData=function(wt,Gt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Gt,this._pendingLoadDataParams=wt,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ut.prototype._loadData=function(){var wt=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Gt=this._pendingCallback,ue=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ge=!!(ue&&ue.request&&ue.request.collectResourceTiming)&&new R.RequestPerformance(ue.request);this.loadGeoJSON(ue,function(ln,ee){if(ln||!ee)return Gt(ln);if(typeof ee!="object")return Gt(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."));(function vr(Ur,jr){var ni,Ar=Ur&&Ur.type;if(Ar==="FeatureCollection")for(ni=0;ni<Ur.features.length;ni++)vr(Ur.features[ni],jr);else if(Ar==="GeometryCollection")for(ni=0;ni<Ur.geometries.length;ni++)vr(Ur.geometries[ni],jr);else if(Ar==="Feature")vr(Ur.geometry,jr);else if(Ar==="Polygon")fe(Ur.coordinates,jr);else if(Ar==="MultiPolygon")for(ni=0;ni<Ur.coordinates.length;ni++)fe(Ur.coordinates[ni],jr);return Ur})(ee,!0);try{if(ue.filter){var Fe=R.createExpression(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Fe.result==="error")throw new Error(Fe.value.map(function(vr){return vr.key+": "+vr.message}).join(", "));var Hn=ee.features.filter(function(vr){return Fe.value.evaluate({zoom:0},vr)});ee={type:"FeatureCollection",features:Hn}}wt._geoJSONIndex=ue.cluster?new Qn(function(vr){var Ur=vr.superclusterOptions,jr=vr.clusterProperties;if(!jr||!Ur)return Ur;for(var ni={},Ar={},pi={accumulated:null,zoom:0},mi={properties:null},xi=Object.keys(jr),wo=0,Li=xi;wo<Li.length;wo+=1){var aa=Li[wo],Pa=jr[aa],Lo=Pa[0],$o=R.createExpression(Pa[1]),Mt=R.createExpression(typeof Lo=="string"?[Lo,["accumulated"],["get",aa]]:Lo);ni[aa]=$o.value,Ar[aa]=Mt.value}return Ur.map=function(Wt){mi.properties=Wt;for(var Se={},qe=0,Rn=xi;qe<Rn.length;qe+=1){var Pn=Rn[qe];Se[Pn]=ni[Pn].evaluate(pi,mi)}return Se},Ur.reduce=function(Wt,Se){mi.properties=Se;for(var qe=0,Rn=xi;qe<Rn.length;qe+=1){var Pn=Rn[qe];pi.accumulated=Wt[Pn],Wt[Pn]=Ar[Pn].evaluate(pi,mi)}},Ur}(ue)).load(ee.features):function(vr,Ur){return new de(vr,Ur)}(ee,ue.geojsonVtOptions)}catch(vr){return Gt(vr)}wt.loaded={};var Tr={};if(Ge){var Zr=Ge.finish();Zr&&(Tr.resourceTiming={},Tr.resourceTiming[ue.source]=JSON.parse(JSON.stringify(Zr)))}Gt(null,Tr)})}},ut.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},ut.prototype.reloadTile=function(wt,Gt){var ue=this.loaded;return ue&&ue[wt.uid]?ht.prototype.reloadTile.call(this,wt,Gt):this.loadTile(wt,Gt)},ut.prototype.loadGeoJSON=function(wt,Gt){if(wt.request)R.getJSON(wt.request,Gt);else{if(typeof wt.data!="string")return Gt(new Error("Input data given to '"+wt.source+"' is not a valid GeoJSON object."));try{return Gt(null,JSON.parse(wt.data))}catch(ue){return Gt(new Error("Input data given to '"+wt.source+"' is not a valid GeoJSON object."))}}},ut.prototype.removeSource=function(wt,Gt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Gt()},ut.prototype.getClusterExpansionZoom=function(wt,Gt){try{Gt(null,this._geoJSONIndex.getClusterExpansionZoom(wt.clusterId))}catch(ue){Gt(ue)}},ut.prototype.getClusterChildren=function(wt,Gt){try{Gt(null,this._geoJSONIndex.getChildren(wt.clusterId))}catch(ue){Gt(ue)}},ut.prototype.getClusterLeaves=function(wt,Gt){try{Gt(null,this._geoJSONIndex.getLeaves(wt.clusterId,wt.limit,wt.offset))}catch(ue){Gt(ue)}},ut}(Nt),Gn=function(ht){var ut=this;this.self=ht,this.actor=new R.Actor(ht,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Nt,geojson:Sr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(wt,Gt){if(ut.workerSourceTypes[wt])throw new Error('Worker source with name "'+wt+'" already registered.');ut.workerSourceTypes[wt]=Gt},this.self.registerRTLTextPlugin=function(wt){if(R.plugin.isParsed())throw new Error("RTL text plugin already registered.");R.plugin.applyArabicShaping=wt.applyArabicShaping,R.plugin.processBidirectionalText=wt.processBidirectionalText,R.plugin.processStyledBidirectionalText=wt.processStyledBidirectionalText}};return Gn.prototype.setReferrer=function(ht,ut){this.referrer=ut},Gn.prototype.setImages=function(ht,ut,wt){for(var Gt in this.availableImages[ht]=ut,this.workerSources[ht]){var ue=this.workerSources[ht][Gt];for(var Ge in ue)ue[Ge].availableImages=ut}wt()},Gn.prototype.setLayers=function(ht,ut,wt){this.getLayerIndex(ht).replace(ut),wt()},Gn.prototype.updateLayers=function(ht,ut,wt){this.getLayerIndex(ht).update(ut.layers,ut.removedIds),wt()},Gn.prototype.loadTile=function(ht,ut,wt){this.getWorkerSource(ht,ut.type,ut.source).loadTile(ut,wt)},Gn.prototype.loadDEMTile=function(ht,ut,wt){this.getDEMWorkerSource(ht,ut.source).loadTile(ut,wt)},Gn.prototype.reloadTile=function(ht,ut,wt){this.getWorkerSource(ht,ut.type,ut.source).reloadTile(ut,wt)},Gn.prototype.abortTile=function(ht,ut,wt){this.getWorkerSource(ht,ut.type,ut.source).abortTile(ut,wt)},Gn.prototype.removeTile=function(ht,ut,wt){this.getWorkerSource(ht,ut.type,ut.source).removeTile(ut,wt)},Gn.prototype.removeDEMTile=function(ht,ut){this.getDEMWorkerSource(ht,ut.source).removeTile(ut)},Gn.prototype.removeSource=function(ht,ut,wt){if(this.workerSources[ht]&&this.workerSources[ht][ut.type]&&this.workerSources[ht][ut.type][ut.source]){var Gt=this.workerSources[ht][ut.type][ut.source];delete this.workerSources[ht][ut.type][ut.source],Gt.removeSource!==void 0?Gt.removeSource(ut,wt):wt()}},Gn.prototype.loadWorkerSource=function(ht,ut,wt){try{this.self.importScripts(ut.url),wt()}catch(Gt){wt(Gt.toString())}},Gn.prototype.syncRTLPluginState=function(ht,ut,wt){try{R.plugin.setState(ut);var Gt=R.plugin.getPluginURL();if(R.plugin.isLoaded()&&!R.plugin.isParsed()&&Gt!=null){this.self.importScripts(Gt);var ue=R.plugin.isParsed();wt(ue?void 0:new Error("RTL Text Plugin failed to import scripts from "+Gt),ue)}}catch(Ge){wt(Ge.toString())}},Gn.prototype.getAvailableImages=function(ht){var ut=this.availableImages[ht];return ut||(ut=[]),ut},Gn.prototype.getLayerIndex=function(ht){var ut=this.layerIndexes[ht];return ut||(ut=this.layerIndexes[ht]=new xe),ut},Gn.prototype.getWorkerSource=function(ht,ut,wt){var Gt=this;return this.workerSources[ht]||(this.workerSources[ht]={}),this.workerSources[ht][ut]||(this.workerSources[ht][ut]={}),this.workerSources[ht][ut][wt]||(this.workerSources[ht][ut][wt]=new this.workerSourceTypes[ut]({send:function(ue,Ge,ln){Gt.actor.send(ue,Ge,ln,ht)}},this.getLayerIndex(ht),this.getAvailableImages(ht))),this.workerSources[ht][ut][wt]},Gn.prototype.getDEMWorkerSource=function(ht,ut){return this.demWorkerSources[ht]||(this.demWorkerSources[ht]={}),this.demWorkerSources[ht][ut]||(this.demWorkerSources[ht][ut]=new Ie),this.demWorkerSources[ht][ut]},Gn.prototype.enforceCacheSizeLimit=function(ht,ut){R.enforceCacheSizeLimit(ut)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Gn(self)),Gn}),pt(["./shared"],function(R){"use strict";var $e=R.createCommonjsModule(function(_){function E(B){return!b(B)}function b(B){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Y,et,St=new Blob([""],{type:"text/javascript"}),Rt=URL.createObjectURL(St);try{et=new Worker(Rt),Y=!0}catch(ye){Y=!1}return et&&et.terminate(),URL.revokeObjectURL(Rt),Y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var Y=document.createElement("canvas");Y.width=Y.height=1;var et=Y.getContext("2d");if(!et)return!1;var St=et.getImageData(0,0,1,1);return St&&St.width===Y.width}()?(A[H=B&&B.failIfMajorPerformanceCaveat]===void 0&&(A[H]=function(Y){var et=function(Rt){var ye=document.createElement("canvas"),be=Object.create(E.webGLContextAttributes);return be.failIfMajorPerformanceCaveat=Rt,ye.probablySupportsContext?ye.probablySupportsContext("webgl",be)||ye.probablySupportsContext("experimental-webgl",be):ye.supportsContext?ye.supportsContext("webgl",be)||ye.supportsContext("experimental-webgl",be):ye.getContext("webgl",be)||ye.getContext("experimental-webgl",be)}(Y);if(!et)return!1;var St=et.createShader(et.VERTEX_SHADER);return!(!St||et.isContextLost())&&(et.shaderSource(St,"void main() {}"),et.compileShader(St),et.getShaderParameter(St,et.COMPILE_STATUS)===!0)}(H)),A[H]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var H}_.exports?_.exports=E:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=E,window.mapboxgl.notSupportedReason=b);var A={};E.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),yt={create:function(_,E,b){var A=R.window.document.createElement(_);return E!==void 0&&(A.className=E),b&&b.appendChild(A),A},createNS:function(_,E){return R.window.document.createElementNS(_,E)}},xe=R.window.document&&R.window.document.documentElement.style;function le(_){if(!xe)return _[0];for(var E=0;E<_.length;E++)if(_[E]in xe)return _[E];return _[0]}var Le,Lt=le(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);yt.disableDrag=function(){xe&&Lt&&(Le=xe[Lt],xe[Lt]="none")},yt.enableDrag=function(){xe&&Lt&&(xe[Lt]=Le)};var fn=le(["transform","WebkitTransform"]);yt.setTransform=function(_,E){_.style[fn]=E};var Nt=!1;try{var Jt=Object.defineProperty({},"passive",{get:function(){Nt=!0}});R.window.addEventListener("test",Jt,Jt),R.window.removeEventListener("test",Jt,Jt)}catch(_){Nt=!1}yt.addEventListener=function(_,E,b,A){A===void 0&&(A={}),_.addEventListener(E,b,"passive"in A&&Nt?A:A.capture)},yt.removeEventListener=function(_,E,b,A){A===void 0&&(A={}),_.removeEventListener(E,b,"passive"in A&&Nt?A:A.capture)};var Ie=function(_){_.preventDefault(),_.stopPropagation(),R.window.removeEventListener("click",Ie,!0)};function fe(_){var E=_.userImage;return!!(E&&E.render&&E.render())&&(_.data.replace(new Uint8Array(E.data.buffer)),!0)}yt.suppressClick=function(){R.window.addEventListener("click",Ie,!0),R.window.setTimeout(function(){R.window.removeEventListener("click",Ie,!0)},0)},yt.mousePos=function(_,E){var b=_.getBoundingClientRect();return new R.Point(E.clientX-b.left-_.clientLeft,E.clientY-b.top-_.clientTop)},yt.touchPos=function(_,E){for(var b=_.getBoundingClientRect(),A=[],B=0;B<E.length;B++)A.push(new R.Point(E[B].clientX-b.left-_.clientLeft,E[B].clientY-b.top-_.clientTop));return A},yt.mouseButton=function(_){return R.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&R.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button},yt.remove=function(_){_.parentNode&&_.parentNode.removeChild(_)};var ce=function(_){function E(){_.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new R.RGBAImage({width:1,height:1}),this.dirty=!0}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.isLoaded=function(){return this.loaded},E.prototype.setLoaded=function(b){if(this.loaded!==b&&(this.loaded=b,b)){for(var A=0,B=this.requestors;A<B.length;A+=1){var H=B[A];this._notify(H.ids,H.callback)}this.requestors=[]}},E.prototype.getImage=function(b){return this.images[b]},E.prototype.addImage=function(b,A){this._validate(b,A)&&(this.images[b]=A)},E.prototype._validate=function(b,A){var B=!0;return this._validateStretch(A.stretchX,A.data&&A.data.width)||(this.fire(new R.ErrorEvent(new Error('Image "'+b+'" has invalid "stretchX" value'))),B=!1),this._validateStretch(A.stretchY,A.data&&A.data.height)||(this.fire(new R.ErrorEvent(new Error('Image "'+b+'" has invalid "stretchY" value'))),B=!1),this._validateContent(A.content,A)||(this.fire(new R.ErrorEvent(new Error('Image "'+b+'" has invalid "content" value'))),B=!1),B},E.prototype._validateStretch=function(b,A){if(!b)return!0;for(var B=0,H=0,Y=b;H<Y.length;H+=1){var et=Y[H];if(et[0]<B||et[1]<et[0]||A<et[1])return!1;B=et[1]}return!0},E.prototype._validateContent=function(b,A){return!(b&&(b.length!==4||b[0]<0||A.data.width<b[0]||b[1]<0||A.data.height<b[1]||b[2]<0||A.data.width<b[2]||b[3]<0||A.data.height<b[3]||b[2]<b[0]||b[3]<b[1]))},E.prototype.updateImage=function(b,A){A.version=this.images[b].version+1,this.images[b]=A,this.updatedImages[b]=!0},E.prototype.removeImage=function(b){var A=this.images[b];delete this.images[b],delete this.patterns[b],A.userImage&&A.userImage.onRemove&&A.userImage.onRemove()},E.prototype.listImages=function(){return Object.keys(this.images)},E.prototype.getImages=function(b,A){var B=!0;if(!this.isLoaded())for(var H=0,Y=b;H<Y.length;H+=1)this.images[Y[H]]||(B=!1);this.isLoaded()||B?this._notify(b,A):this.requestors.push({ids:b,callback:A})},E.prototype._notify=function(b,A){for(var B={},H=0,Y=b;H<Y.length;H+=1){var et=Y[H];this.images[et]||this.fire(new R.Event("styleimagemissing",{id:et}));var St=this.images[et];St?B[et]={data:St.data.clone(),pixelRatio:St.pixelRatio,sdf:St.sdf,version:St.version,stretchX:St.stretchX,stretchY:St.stretchY,content:St.content,hasRenderCallback:!!(St.userImage&&St.userImage.render)}:R.warnOnce('Image "'+et+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}A(null,B)},E.prototype.getPixelSize=function(){var b=this.atlasImage;return{width:b.width,height:b.height}},E.prototype.getPattern=function(b){var A=this.patterns[b],B=this.getImage(b);if(!B)return null;if(A&&A.position.version===B.version)return A.position;if(A)A.position.version=B.version;else{var H={w:B.data.width+2,h:B.data.height+2,x:0,y:0},Y=new R.ImagePosition(H,B);this.patterns[b]={bin:H,position:Y}}return this._updatePatternAtlas(),this.patterns[b].position},E.prototype.bind=function(b){var A=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new R.Texture(b,this.atlasImage,A.RGBA),this.atlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE)},E.prototype._updatePatternAtlas=function(){var b=[];for(var A in this.patterns)b.push(this.patterns[A].bin);var B=R.potpack(b),H=B.w,Y=B.h,et=this.atlasImage;for(var St in et.resize({width:H||1,height:Y||1}),this.patterns){var Rt=this.patterns[St].bin,ye=Rt.x+1,be=Rt.y+1,Oe=this.images[St].data,on=Oe.width,Qe=Oe.height;R.RGBAImage.copy(Oe,et,{x:0,y:0},{x:ye,y:be},{width:on,height:Qe}),R.RGBAImage.copy(Oe,et,{x:0,y:Qe-1},{x:ye,y:be-1},{width:on,height:1}),R.RGBAImage.copy(Oe,et,{x:0,y:0},{x:ye,y:be+Qe},{width:on,height:1}),R.RGBAImage.copy(Oe,et,{x:on-1,y:0},{x:ye-1,y:be},{width:1,height:Qe}),R.RGBAImage.copy(Oe,et,{x:0,y:0},{x:ye+on,y:be},{width:1,height:Qe})}this.dirty=!0},E.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},E.prototype.dispatchRenderCallbacks=function(b){for(var A=0,B=b;A<B.length;A+=1){var H=B[A];if(!this.callbackDispatchedThisFrame[H]){this.callbackDispatchedThisFrame[H]=!0;var Y=this.images[H];fe(Y)&&this.updateImage(H,Y)}}},E}(R.Evented),ve=En,Ze=En,Un=1e20;function En(_,E,b,A,B,H){this.fontSize=_||24,this.buffer=E===void 0?3:E,this.cutoff=A||.25,this.fontFamily=B||"sans-serif",this.fontWeight=H||"normal",this.radius=b||8;var Y=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Vn(_,E,b,A,B,H,Y){for(var et=0;et<E;et++){for(var St=0;St<b;St++)A[St]=_[St*E+et];for(mr(A,B,H,Y,b),St=0;St<b;St++)_[St*E+et]=B[St]}for(St=0;St<b;St++){for(et=0;et<E;et++)A[et]=_[St*E+et];for(mr(A,B,H,Y,E),et=0;et<E;et++)_[St*E+et]=Math.sqrt(B[et])}}function mr(_,E,b,A,B){b[0]=0,A[0]=-Un,A[1]=+Un;for(var H=1,Y=0;H<B;H++){for(var et=(_[H]+H*H-(_[b[Y]]+b[Y]*b[Y]))/(2*H-2*b[Y]);et<=A[Y];)Y--,et=(_[H]+H*H-(_[b[Y]]+b[Y]*b[Y]))/(2*H-2*b[Y]);b[++Y]=H,A[Y]=et,A[Y+1]=+Un}for(H=0,Y=0;H<B;H++){for(;A[Y+1]<H;)Y++;E[H]=(H-b[Y])*(H-b[Y])+_[b[Y]]}}En.prototype.draw=function(_){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(_,this.buffer,this.middle);for(var E=this.ctx.getImageData(0,0,this.size,this.size),b=new Uint8ClampedArray(this.size*this.size),A=0;A<this.size*this.size;A++){var B=E.data[4*A+3]/255;this.gridOuter[A]=B===1?0:B===0?Un:Math.pow(Math.max(0,.5-B),2),this.gridInner[A]=B===1?Un:B===0?0:Math.pow(Math.max(0,B-.5),2)}for(Vn(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Vn(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),A=0;A<this.size*this.size;A++)b[A]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[A]-this.gridInner[A])/this.radius+this.cutoff))));return b},ve.default=Ze;var or=function(_,E){this.requestManager=_,this.localIdeographFontFamily=E,this.entries={}};or.prototype.setURL=function(_){this.url=_},or.prototype.getGlyphs=function(_,E){var b=this,A=[];for(var B in _)for(var H=0,Y=_[B];H<Y.length;H+=1)A.push({stack:B,id:Y[H]});R.asyncAll(A,function(et,St){var Rt=et.stack,ye=et.id,be=b.entries[Rt];be||(be=b.entries[Rt]={glyphs:{},requests:{},ranges:{}});var Oe=be.glyphs[ye];if(Oe===void 0){if(Oe=b._tinySDF(be,Rt,ye))return be.glyphs[ye]=Oe,void St(null,{stack:Rt,id:ye,glyph:Oe});var on=Math.floor(ye/256);if(256*on>65535)St(new Error("glyphs > 65535 not supported"));else if(be.ranges[on])St(null,{stack:Rt,id:ye,glyph:Oe});else{var Qe=be.requests[on];Qe||(Qe=be.requests[on]=[],or.loadGlyphRange(Rt,on,b.url,b.requestManager,function(vn,Ye){if(Ye){for(var On in Ye)b._doesCharSupportLocalGlyph(+On)||(be.glyphs[+On]=Ye[+On]);be.ranges[on]=!0}for(var jn=0,ar=Qe;jn<ar.length;jn+=1)(0,ar[jn])(vn,Ye);delete be.requests[on]})),Qe.push(function(vn,Ye){vn?St(vn):Ye&&St(null,{stack:Rt,id:ye,glyph:Ye[ye]||null})})}}else St(null,{stack:Rt,id:ye,glyph:Oe})},function(et,St){if(et)E(et);else if(St){for(var Rt={},ye=0,be=St;ye<be.length;ye+=1){var Oe=be[ye],on=Oe.stack,Qe=Oe.id,vn=Oe.glyph;(Rt[on]||(Rt[on]={}))[Qe]=vn&&{id:vn.id,bitmap:vn.bitmap.clone(),metrics:vn.metrics}}E(null,Rt)}})},or.prototype._doesCharSupportLocalGlyph=function(_){return!!this.localIdeographFontFamily&&(R.isChar["CJK Unified Ideographs"](_)||R.isChar["Hangul Syllables"](_)||R.isChar.Hiragana(_)||R.isChar.Katakana(_))},or.prototype._tinySDF=function(_,E,b){var A=this.localIdeographFontFamily;if(A&&this._doesCharSupportLocalGlyph(b)){var B=_.tinySDF;if(!B){var H="400";/bold/i.test(E)?H="900":/medium/i.test(E)?H="500":/light/i.test(E)&&(H="200"),B=_.tinySDF=new or.TinySDF(24,3,8,.25,A,H)}return{id:b,bitmap:new R.AlphaImage({width:30,height:30},B.draw(String.fromCharCode(b))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},or.loadGlyphRange=function(_,E,b,A,B){var H=256*E,Y=H+255,et=A.transformRequest(A.normalizeGlyphsURL(b).replace("{fontstack}",_).replace("{range}",H+"-"+Y),R.ResourceType.Glyphs);R.getArrayBuffer(et,function(St,Rt){if(St)B(St);else if(Rt){for(var ye={},be=0,Oe=R.parseGlyphPBF(Rt);be<Oe.length;be+=1){var on=Oe[be];ye[on.id]=on}B(null,ye)}})},or.TinySDF=ve;var He=function(){this.specification=R.styleSpec.light.position};He.prototype.possiblyEvaluate=function(_,E){return R.sphericalToCartesian(_.expression.evaluate(E))},He.prototype.interpolate=function(_,E,b){return{x:R.number(_.x,E.x,b),y:R.number(_.y,E.y,b),z:R.number(_.z,E.z,b)}};var $t=new R.Properties({anchor:new R.DataConstantProperty(R.styleSpec.light.anchor),position:new He,color:new R.DataConstantProperty(R.styleSpec.light.color),intensity:new R.DataConstantProperty(R.styleSpec.light.intensity)}),nn=function(_){function E(b){_.call(this),this._transitionable=new R.Transitionable($t),this.setLight(b),this._transitioning=this._transitionable.untransitioned()}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getLight=function(){return this._transitionable.serialize()},E.prototype.setLight=function(b,A){if(A===void 0&&(A={}),!this._validate(R.validateLight,b,A))for(var B in b){var H=b[B];R.endsWith(B,"-transition")?this._transitionable.setTransition(B.slice(0,-11),H):this._transitionable.setValue(B,H)}},E.prototype.updateTransitions=function(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)},E.prototype.hasTransition=function(){return this._transitioning.hasTransition()},E.prototype.recalculate=function(b){this.properties=this._transitioning.possiblyEvaluate(b)},E.prototype._validate=function(b,A,B){return(!B||B.validate!==!1)&&R.emitValidationErrors(this,b.call(R.validateStyle,R.extend({value:A,style:{glyphs:!0,sprite:!0},styleSpec:R.styleSpec})))},E}(R.Evented),ke=function(_,E){this.width=_,this.height=E,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ke.prototype.getDash=function(_,E){var b=_.join(",")+String(E);return this.dashEntry[b]||(this.dashEntry[b]=this.addDash(_,E)),this.dashEntry[b]},ke.prototype.getDashRanges=function(_,E,b){var A=[],B=_.length%2==1?-_[_.length-1]*b:0,H=_[0]*b,Y=!0;A.push({left:B,right:H,isDash:Y,zeroLength:_[0]===0});for(var et=_[0],St=1;St<_.length;St++){var Rt=_[St];A.push({left:B=et*b,right:H=(et+=Rt)*b,isDash:Y=!Y,zeroLength:Rt===0})}return A},ke.prototype.addRoundDash=function(_,E,b){for(var A=E/2,B=-b;B<=b;B++)for(var H=this.width*(this.nextRow+b+B),Y=0,et=_[Y],St=0;St<this.width;St++){St/et.right>1&&(et=_[++Y]);var Rt=Math.abs(St-et.left),ye=Math.abs(St-et.right),be=Math.min(Rt,ye),Oe=void 0,on=B/b*(A+1);if(et.isDash){var Qe=A-Math.abs(on);Oe=Math.sqrt(be*be+Qe*Qe)}else Oe=A-Math.sqrt(be*be+on*on);this.data[H+St]=Math.max(0,Math.min(255,Oe+128))}},ke.prototype.addRegularDash=function(_){for(var E=_.length-1;E>=0;--E){var b=_[E],A=_[E+1];b.zeroLength?_.splice(E,1):A&&A.isDash===b.isDash&&(A.left=b.left,_.splice(E,1))}var B=_[0],H=_[_.length-1];B.isDash===H.isDash&&(B.left=H.left-this.width,H.right=B.right+this.width);for(var Y=this.width*this.nextRow,et=0,St=_[et],Rt=0;Rt<this.width;Rt++){Rt/St.right>1&&(St=_[++et]);var ye=Math.abs(Rt-St.left),be=Math.abs(Rt-St.right),Oe=Math.min(ye,be);this.data[Y+Rt]=Math.max(0,Math.min(255,(St.isDash?Oe:-Oe)+128))}},ke.prototype.addDash=function(_,E){var b=E?7:0,A=2*b+1;if(this.nextRow+A>this.height)return R.warnOnce("LineAtlas out of space"),null;for(var B=0,H=0;H<_.length;H++)B+=_[H];if(B!==0){var Y=this.width/B,et=this.getDashRanges(_,this.width,Y);E?this.addRoundDash(et,Y,b):this.addRegularDash(et)}var St={y:(this.nextRow+b+.5)/this.height,height:2*b/this.height,width:B};return this.nextRow+=A,this.dirty=!0,St},ke.prototype.bind=function(_){var E=_.gl;this.texture?(E.bindTexture(E.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,E.texSubImage2D(E.TEXTURE_2D,0,0,0,this.width,this.height,E.ALPHA,E.UNSIGNED_BYTE,this.data))):(this.texture=E.createTexture(),E.bindTexture(E.TEXTURE_2D,this.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.ALPHA,this.width,this.height,0,E.ALPHA,E.UNSIGNED_BYTE,this.data))};var Je=function _(E,b){this.workerPool=E,this.actors=[],this.currentActor=0,this.id=R.uniqueId();for(var A=this.workerPool.acquire(this.id),B=0;B<A.length;B++){var H=new _.Actor(A[B],b,this.id);H.name="Worker "+B,this.actors.push(H)}};function er(_,E,b){var A=function(B,H){if(B)return b(B);if(H){var Y=R.pick(R.extend(H,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);H.vector_layers&&(Y.vectorLayers=H.vector_layers,Y.vectorLayerIds=Y.vectorLayers.map(function(et){return et.id})),Y.tiles=E.canonicalizeTileset(Y,_.url),b(null,Y)}};return _.url?R.getJSON(E.transformRequest(E.normalizeSourceURL(_.url),R.ResourceType.Source),A):R.browser.frame(function(){return A(null,_)})}Je.prototype.broadcast=function(_,E,b){R.asyncAll(this.actors,function(A,B){A.send(_,E,B)},b=b||function(){})},Je.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Je.prototype.remove=function(){this.actors.forEach(function(_){_.remove()}),this.actors=[],this.workerPool.release(this.id)},Je.Actor=R.Actor;var kt=function(_,E,b){this.bounds=R.LngLatBounds.convert(this.validateBounds(_)),this.minzoom=E||0,this.maxzoom=b||24};kt.prototype.validateBounds=function(_){return Array.isArray(_)&&_.length===4?[Math.max(-180,_[0]),Math.max(-90,_[1]),Math.min(180,_[2]),Math.min(90,_[3])]:[-180,-90,180,90]},kt.prototype.contains=function(_){var E=Math.pow(2,_.z),b=Math.floor(R.mercatorXfromLng(this.bounds.getWest())*E),A=Math.floor(R.mercatorYfromLat(this.bounds.getNorth())*E),B=Math.ceil(R.mercatorXfromLng(this.bounds.getEast())*E),H=Math.ceil(R.mercatorYfromLat(this.bounds.getSouth())*E);return _.x>=b&&_.x<B&&_.y>=A&&_.y<H};var Te=function(_){function E(b,A,B,H){if(_.call(this),this.id=b,this.dispatcher=B,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,R.extend(this,R.pick(A,["url","scheme","tileSize","promoteId"])),this._options=R.extend({type:"vector"},A),this._collectResourceTiming=A.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(H)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new R.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=er(this._options,this.map._requestManager,function(A,B){b._tileJSONRequest=null,b._loaded=!0,A?b.fire(new R.ErrorEvent(A)):B&&(R.extend(b,B),B.bounds&&(b.tileBounds=new kt(B.bounds,b.minzoom,b.maxzoom)),R.postTurnstileEvent(B.tiles,b.map._requestManager._customAccessToken),R.postMapLoadEvent(B.tiles,b.map._getMapId(),b.map._requestManager._skuToken,b.map._requestManager._customAccessToken),b.fire(new R.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new R.Event("data",{dataType:"source",sourceDataType:"content"})))})},E.prototype.loaded=function(){return this._loaded},E.prototype.hasTile=function(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)},E.prototype.onAdd=function(b){this.map=b,this.load()},E.prototype.setSourceProperty=function(b){this._tileJSONRequest&&this._tileJSONRequest.cancel(),b(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},E.prototype.setTiles=function(b){var A=this;return this.setSourceProperty(function(){A._options.tiles=b}),this},E.prototype.setUrl=function(b){var A=this;return this.setSourceProperty(function(){A.url=b,A._options.url=b}),this},E.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},E.prototype.serialize=function(){return R.extend({},this._options)},E.prototype.loadTile=function(b,A){var B=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme)),H={request:this.map._requestManager.transformRequest(B,R.ResourceType.Tile),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:R.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function Y(et,St){return delete b.request,b.aborted?A(null):et&&et.status!==404?A(et):(St&&St.resourceTiming&&(b.resourceTiming=St.resourceTiming),this.map._refreshExpiredTiles&&St&&b.setExpiryData(St),b.loadVectorData(St,this.map.painter),R.cacheEntryPossiblyAdded(this.dispatcher),A(null),void(b.reloadCallback&&(this.loadTile(b,b.reloadCallback),b.reloadCallback=null)))}H.request.collectResourceTiming=this._collectResourceTiming,b.actor&&b.state!=="expired"?b.state==="loading"?b.reloadCallback=A:b.request=b.actor.send("reloadTile",H,Y.bind(this)):(b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",H,Y.bind(this)))},E.prototype.abortTile=function(b){b.request&&(b.request.cancel(),delete b.request),b.actor&&b.actor.send("abortTile",{uid:b.uid,type:this.type,source:this.id},void 0)},E.prototype.unloadTile=function(b){b.unloadVectorData(),b.actor&&b.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id},void 0)},E.prototype.hasTransition=function(){return!1},E}(R.Evented),gt=function(_){function E(b,A,B,H){_.call(this),this.id=b,this.dispatcher=B,this.setEventedParent(H),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=R.extend({type:"raster"},A),R.extend(this,R.pick(A,["url","scheme","tileSize"]))}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new R.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=er(this._options,this.map._requestManager,function(A,B){b._tileJSONRequest=null,b._loaded=!0,A?b.fire(new R.ErrorEvent(A)):B&&(R.extend(b,B),B.bounds&&(b.tileBounds=new kt(B.bounds,b.minzoom,b.maxzoom)),R.postTurnstileEvent(B.tiles),R.postMapLoadEvent(B.tiles,b.map._getMapId(),b.map._requestManager._skuToken),b.fire(new R.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new R.Event("data",{dataType:"source",sourceDataType:"content"})))})},E.prototype.loaded=function(){return this._loaded},E.prototype.onAdd=function(b){this.map=b,this.load()},E.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},E.prototype.serialize=function(){return R.extend({},this._options)},E.prototype.hasTile=function(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)},E.prototype.loadTile=function(b,A){var B=this,H=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);b.request=R.getImage(this.map._requestManager.transformRequest(H,R.ResourceType.Tile),function(Y,et){if(delete b.request,b.aborted)b.state="unloaded",A(null);else if(Y)b.state="errored",A(Y);else if(et){B.map._refreshExpiredTiles&&b.setExpiryData(et),delete et.cacheControl,delete et.expires;var St=B.map.painter.context,Rt=St.gl;b.texture=B.map.painter.getTileTexture(et.width),b.texture?b.texture.update(et,{useMipmap:!0}):(b.texture=new R.Texture(St,et,Rt.RGBA,{useMipmap:!0}),b.texture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE,Rt.LINEAR_MIPMAP_NEAREST),St.extTextureFilterAnisotropic&&Rt.texParameterf(Rt.TEXTURE_2D,St.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,St.extTextureFilterAnisotropicMax)),b.state="loaded",R.cacheEntryPossiblyAdded(B.dispatcher),A(null)}})},E.prototype.abortTile=function(b,A){b.request&&(b.request.cancel(),delete b.request),A()},E.prototype.unloadTile=function(b,A){b.texture&&this.map.painter.saveTileTexture(b.texture),A()},E.prototype.hasTransition=function(){return!1},E}(R.Evented),te=function(_){function E(b,A,B,H){_.call(this,b,A,B,H),this.type="raster-dem",this.maxzoom=22,this._options=R.extend({type:"raster-dem"},A),this.encoding=A.encoding||"mapbox"}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},E.prototype.loadTile=function(b,A){var B=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function H(Y,et){Y&&(b.state="errored",A(Y)),et&&(b.dem=et,b.needsHillshadePrepare=!0,b.state="loaded",A(null))}b.request=R.getImage(this.map._requestManager.transformRequest(B,R.ResourceType.Tile),function(Y,et){if(delete b.request,b.aborted)b.state="unloaded",A(null);else if(Y)b.state="errored",A(Y);else if(et){this.map._refreshExpiredTiles&&b.setExpiryData(et),delete et.cacheControl,delete et.expires;var St=R.window.ImageBitmap&&et instanceof R.window.ImageBitmap&&R.offscreenCanvasSupported()?et:R.browser.getImageData(et,1),Rt={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:St,encoding:this.encoding};b.actor&&b.state!=="expired"||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",Rt,H.bind(this)))}}.bind(this)),b.neighboringTiles=this._getNeighboringTiles(b.tileID)},E.prototype._getNeighboringTiles=function(b){var A=b.canonical,B=Math.pow(2,A.z),H=(A.x-1+B)%B,Y=A.x===0?b.wrap-1:b.wrap,et=(A.x+1+B)%B,St=A.x+1===B?b.wrap+1:b.wrap,Rt={};return Rt[new R.OverscaledTileID(b.overscaledZ,Y,A.z,H,A.y).key]={backfilled:!1},Rt[new R.OverscaledTileID(b.overscaledZ,St,A.z,et,A.y).key]={backfilled:!1},A.y>0&&(Rt[new R.OverscaledTileID(b.overscaledZ,Y,A.z,H,A.y-1).key]={backfilled:!1},Rt[new R.OverscaledTileID(b.overscaledZ,b.wrap,A.z,A.x,A.y-1).key]={backfilled:!1},Rt[new R.OverscaledTileID(b.overscaledZ,St,A.z,et,A.y-1).key]={backfilled:!1}),A.y+1<B&&(Rt[new R.OverscaledTileID(b.overscaledZ,Y,A.z,H,A.y+1).key]={backfilled:!1},Rt[new R.OverscaledTileID(b.overscaledZ,b.wrap,A.z,A.x,A.y+1).key]={backfilled:!1},Rt[new R.OverscaledTileID(b.overscaledZ,St,A.z,et,A.y+1).key]={backfilled:!1}),Rt},E.prototype.unloadTile=function(b){b.demTexture&&this.map.painter.saveTileTexture(b.demTexture),b.fbo&&(b.fbo.destroy(),delete b.fbo),b.dem&&delete b.dem,delete b.neighboringTiles,b.state="unloaded",b.actor&&b.actor.send("removeDEMTile",{uid:b.uid,source:this.id})},E}(gt),Zt=function(_){function E(b,A,B,H){_.call(this),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=B.getActor(),this.setEventedParent(H),this._data=A.data,this._options=R.extend({},A),this._collectResourceTiming=A.collectResourceTiming,this._resourceTiming=[],A.maxzoom!==void 0&&(this.maxzoom=A.maxzoom),A.type&&(this.type=A.type),A.attribution&&(this.attribution=A.attribution),this.promoteId=A.promoteId;var Y=R.EXTENT/this.tileSize;this.workerOptions=R.extend({source:this.id,cluster:A.cluster||!1,geojsonVtOptions:{buffer:(A.buffer!==void 0?A.buffer:128)*Y,tolerance:(A.tolerance!==void 0?A.tolerance:.375)*Y,extent:R.EXTENT,maxZoom:this.maxzoom,lineMetrics:A.lineMetrics||!1,generateId:A.generateId||!1},superclusterOptions:{maxZoom:A.clusterMaxZoom!==void 0?Math.min(A.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,A.clusterMinPoints||2),extent:R.EXTENT,radius:(A.clusterRadius||50)*Y,log:!1,generateId:A.generateId||!1},clusterProperties:A.clusterProperties,filter:A.filter},A.workerOptions)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(){var b=this;this.fire(new R.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(A){if(A)b.fire(new R.ErrorEvent(A));else{var B={dataType:"source",sourceDataType:"metadata"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(B.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new R.Event("data",B))}})},E.prototype.onAdd=function(b){this.map=b,this.load()},E.prototype.setData=function(b){var A=this;return this._data=b,this.fire(new R.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(B){if(B)A.fire(new R.ErrorEvent(B));else{var H={dataType:"source",sourceDataType:"content"};A._collectResourceTiming&&A._resourceTiming&&A._resourceTiming.length>0&&(H.resourceTiming=A._resourceTiming,A._resourceTiming=[]),A.fire(new R.Event("data",H))}}),this},E.prototype.getClusterExpansionZoom=function(b,A){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id},A),this},E.prototype.getClusterChildren=function(b,A){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id},A),this},E.prototype.getClusterLeaves=function(b,A,B,H){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:b,limit:A,offset:B},H),this},E.prototype._updateWorkerData=function(b){var A=this;this._loaded=!1;var B=R.extend({},this.workerOptions),H=this._data;typeof H=="string"?(B.request=this.map._requestManager.transformRequest(R.browser.resolveURL(H),R.ResourceType.Source),B.request.collectResourceTiming=this._collectResourceTiming):B.data=JSON.stringify(H),this.actor.send(this.type+".loadData",B,function(Y,et){A._removed||et&&et.abandoned||(A._loaded=!0,et&&et.resourceTiming&&et.resourceTiming[A.id]&&(A._resourceTiming=et.resourceTiming[A.id].slice(0)),A.actor.send(A.type+".coalesce",{source:B.source},null),b(Y))})},E.prototype.loaded=function(){return this._loaded},E.prototype.loadTile=function(b,A){var B=this,H=b.actor?"reloadTile":"loadTile";b.actor=this.actor,b.request=this.actor.send(H,{type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:R.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(Y,et){return delete b.request,b.unloadVectorData(),b.aborted?A(null):Y?A(Y):(b.loadVectorData(et,B.map.painter,H==="reloadTile"),A(null))})},E.prototype.abortTile=function(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0},E.prototype.unloadTile=function(b){b.unloadVectorData(),this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id})},E.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},E.prototype.serialize=function(){return R.extend({},this._options,{type:this.type,data:this._data})},E.prototype.hasTransition=function(){return!1},E}(R.Evented),Ut=R.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),we=function(_){function E(b,A,B,H){_.call(this),this.id=b,this.dispatcher=B,this.coordinates=A.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(H),this.options=A}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(b,A){var B=this;this._loaded=!1,this.fire(new R.Event("dataloading",{dataType:"source"})),this.url=this.options.url,R.getImage(this.map._requestManager.transformRequest(this.url,R.ResourceType.Image),function(H,Y){B._loaded=!0,H?B.fire(new R.ErrorEvent(H)):Y&&(B.image=Y,b&&(B.coordinates=b),A&&A(),B._finishLoading())})},E.prototype.loaded=function(){return this._loaded},E.prototype.updateImage=function(b){var A=this;return this.image&&b.url?(this.options.url=b.url,this.load(b.coordinates,function(){A.texture=null}),this):this},E.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new R.Event("data",{dataType:"source",sourceDataType:"metadata"})))},E.prototype.onAdd=function(b){this.map=b,this.load()},E.prototype.setCoordinates=function(b){var A=this;this.coordinates=b;var B=b.map(R.MercatorCoordinate.fromLngLat);this.tileID=function(Y){for(var et=1/0,St=1/0,Rt=-1/0,ye=-1/0,be=0,Oe=Y;be<Oe.length;be+=1){var on=Oe[be];et=Math.min(et,on.x),St=Math.min(St,on.y),Rt=Math.max(Rt,on.x),ye=Math.max(ye,on.y)}var Qe=Math.max(Rt-et,ye-St),vn=Math.max(0,Math.floor(-Math.log(Qe)/Math.LN2)),Ye=Math.pow(2,vn);return new R.CanonicalTileID(vn,Math.floor((et+Rt)/2*Ye),Math.floor((St+ye)/2*Ye))}(B),this.minzoom=this.maxzoom=this.tileID.z;var H=B.map(function(Y){return A.tileID.getTilePoint(Y)._round()});return this._boundsArray=new R.StructArrayLayout4i8,this._boundsArray.emplaceBack(H[0].x,H[0].y,0,0),this._boundsArray.emplaceBack(H[1].x,H[1].y,R.EXTENT,0),this._boundsArray.emplaceBack(H[3].x,H[3].y,0,R.EXTENT),this._boundsArray.emplaceBack(H[2].x,H[2].y,R.EXTENT,R.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new R.Event("data",{dataType:"source",sourceDataType:"content"})),this},E.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var b=this.map.painter.context,A=b.gl;for(var B in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Ut.members)),this.boundsSegments||(this.boundsSegments=R.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new R.Texture(b,this.image,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[B];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},E.prototype.loadTile=function(b,A){this.tileID&&this.tileID.equals(b.tileID.canonical)?(this.tiles[String(b.tileID.wrap)]=b,b.buckets={},A(null)):(b.state="errored",A(null))},E.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},E.prototype.hasTransition=function(){return!1},E}(R.Evented),ie=function(_){function E(b,A,B,H){_.call(this,b,A,B,H),this.roundZoom=!0,this.type="video",this.options=A}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(){var b=this;this._loaded=!1;var A=this.options;this.urls=[];for(var B=0,H=A.urls;B<H.length;B+=1)this.urls.push(this.map._requestManager.transformRequest(H[B],R.ResourceType.Source).url);R.getVideo(this.urls,function(Y,et){b._loaded=!0,Y?b.fire(new R.ErrorEvent(Y)):et&&(b.video=et,b.video.loop=!0,b.video.setAttribute("playsinline",""),b.video.addEventListener("playing",function(){b.map.triggerRepaint()}),b.map&&b.video.play(),b._finishLoading())})},E.prototype.pause=function(){this.video&&this.video.pause()},E.prototype.play=function(){this.video&&this.video.play()},E.prototype.seek=function(b){if(this.video){var A=this.video.seekable;b<A.start(0)||b>A.end(0)?this.fire(new R.ErrorEvent(new R.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+A.start(0)+" and "+A.end(0)+"-second mark."))):this.video.currentTime=b}},E.prototype.getVideo=function(){return this.video},E.prototype.onAdd=function(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},E.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var b=this.map.painter.context,A=b.gl;for(var B in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Ut.members)),this.boundsSegments||(this.boundsSegments=R.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.texSubImage2D(A.TEXTURE_2D,0,0,0,A.RGBA,A.UNSIGNED_BYTE,this.video)):(this.texture=new R.Texture(b,this.video,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[B];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},E.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},E.prototype.hasTransition=function(){return this.video&&!this.video.paused},E}(we),_t=function(_){function E(b,A,B,H){_.call(this,b,A,B,H),A.coordinates?Array.isArray(A.coordinates)&&A.coordinates.length===4&&!A.coordinates.some(function(Y){return!Array.isArray(Y)||Y.length!==2||Y.some(function(et){return typeof et!="number"})})||this.fire(new R.ErrorEvent(new R.ValidationError("sources."+b,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new R.ErrorEvent(new R.ValidationError("sources."+b,null,'missing required property "coordinates"'))),A.animate&&typeof A.animate!="boolean"&&this.fire(new R.ErrorEvent(new R.ValidationError("sources."+b,null,'optional "animate" property must be a boolean value'))),A.canvas?typeof A.canvas=="string"||A.canvas instanceof R.window.HTMLCanvasElement||this.fire(new R.ErrorEvent(new R.ValidationError("sources."+b,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new R.ErrorEvent(new R.ValidationError("sources."+b,null,'missing required property "canvas"'))),this.options=A,this.animate=A.animate===void 0||A.animate}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof R.window.HTMLCanvasElement?this.options.canvas:R.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new R.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},E.prototype.getCanvas=function(){return this.canvas},E.prototype.onAdd=function(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()},E.prototype.onRemove=function(){this.pause()},E.prototype.prepare=function(){var b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var A=this.map.painter.context,B=A.gl;for(var H in this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,Ut.members)),this.boundsSegments||(this.boundsSegments=R.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new R.Texture(A,this.canvas,B.RGBA,{premultiply:!0}),this.tiles){var Y=this.tiles[H];Y.state!=="loaded"&&(Y.state="loaded",Y.texture=this.texture)}}},E.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},E.prototype.hasTransition=function(){return this._playing},E.prototype._hasInvalidDimensions=function(){for(var b=0,A=[this.canvas.width,this.canvas.height];b<A.length;b+=1){var B=A[b];if(isNaN(B)||B<=0)return!0}return!1},E}(we),Ne={vector:Te,raster:gt,"raster-dem":te,geojson:Zt,video:ie,image:we,canvas:_t};function un(_,E){var b=R.identity([]);return R.translate(b,b,[1,1,0]),R.scale(b,b,[.5*_.width,.5*_.height,1]),R.multiply(b,b,_.calculatePosMatrix(E.toUnwrapped()))}function Qn(_,E,b,A,B,H){var Y=function(vn,Ye,On){if(vn)for(var jn=0,ar=vn;jn<ar.length;jn+=1){var Or=Ye[ar[jn]];if(Or&&Or.source===On&&Or.type==="fill-extrusion")return!0}else for(var cr in Ye){var kr=Ye[cr];if(kr.source===On&&kr.type==="fill-extrusion")return!0}return!1}(B&&B.layers,E,_.id),et=H.maxPitchScaleFactor(),St=_.tilesIn(A,et,Y);St.sort(hr);for(var Rt=[],ye=0,be=St;ye<be.length;ye+=1){var Oe=be[ye];Rt.push({wrappedTileID:Oe.tileID.wrapped().key,queryResults:Oe.tile.queryRenderedFeatures(E,b,_._state,Oe.queryGeometry,Oe.cameraQueryGeometry,Oe.scale,B,H,et,un(_.transform,Oe.tileID))})}var on=function(vn){for(var Ye={},On={},jn=0,ar=vn;jn<ar.length;jn+=1){var Or=ar[jn],cr=Or.queryResults,kr=Or.wrappedTileID,ei=On[kr]=On[kr]||{};for(var Yr in cr)for(var Ti=cr[Yr],zi=ei[Yr]=ei[Yr]||{},Io=Ye[Yr]=Ye[Yr]||[],Bo=0,Fo=Ti;Bo<Fo.length;Bo+=1){var ua=Fo[Bo];zi[ua.featureIndex]||(zi[ua.featureIndex]=!0,Io.push(ua))}}return Ye}(Rt);for(var Qe in on)on[Qe].forEach(function(vn){var Ye=vn.feature,On=_.getFeatureState(Ye.layer["source-layer"],Ye.id);Ye.source=Ye.layer.source,Ye.layer["source-layer"]&&(Ye.sourceLayer=Ye.layer["source-layer"]),Ye.state=On});return on}function hr(_,E){var b=_.tileID,A=E.tileID;return b.overscaledZ-A.overscaledZ||b.canonical.y-A.canonical.y||b.wrap-A.wrap||b.canonical.x-A.canonical.x}var Er=function(_,E){this.max=_,this.onRemove=E,this.reset()};Er.prototype.reset=function(){for(var _ in this.data)for(var E=0,b=this.data[_];E<b.length;E+=1){var A=b[E];A.timeout&&clearTimeout(A.timeout),this.onRemove(A.value)}return this.data={},this.order=[],this},Er.prototype.add=function(_,E,b){var A=this,B=_.wrapped().key;this.data[B]===void 0&&(this.data[B]=[]);var H={value:E,timeout:void 0};if(b!==void 0&&(H.timeout=setTimeout(function(){A.remove(_,H)},b)),this.data[B].push(H),this.order.push(B),this.order.length>this.max){var Y=this._getAndRemoveByKey(this.order[0]);Y&&this.onRemove(Y)}return this},Er.prototype.has=function(_){return _.wrapped().key in this.data},Er.prototype.getAndRemove=function(_){return this.has(_)?this._getAndRemoveByKey(_.wrapped().key):null},Er.prototype._getAndRemoveByKey=function(_){var E=this.data[_].shift();return E.timeout&&clearTimeout(E.timeout),this.data[_].length===0&&delete this.data[_],this.order.splice(this.order.indexOf(_),1),E.value},Er.prototype.getByKey=function(_){var E=this.data[_];return E?E[0].value:null},Er.prototype.get=function(_){return this.has(_)?this.data[_.wrapped().key][0].value:null},Er.prototype.remove=function(_,E){if(!this.has(_))return this;var b=_.wrapped().key,A=E===void 0?0:this.data[b].indexOf(E),B=this.data[b][A];return this.data[b].splice(A,1),B.timeout&&clearTimeout(B.timeout),this.data[b].length===0&&delete this.data[b],this.onRemove(B.value),this.order.splice(this.order.indexOf(b),1),this},Er.prototype.setMaxSize=function(_){for(this.max=_;this.order.length>this.max;){var E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this},Er.prototype.filter=function(_){var E=[];for(var b in this.data)for(var A=0,B=this.data[b];A<B.length;A+=1){var H=B[A];_(H.value)||E.push(H)}for(var Y=0,et=E;Y<et.length;Y+=1){var St=et[Y];this.remove(St.value.tileID,St)}};var Ue=function(_,E,b){this.context=_;var A=_.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),_.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer};Ue.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ue.prototype.updateData=function(_){var E=this.context.gl;this.context.unbindVAO(),this.bind(),E.bufferSubData(E.ELEMENT_ARRAY_BUFFER,0,_.arrayBuffer)},Ue.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var cn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},wn=function(_,E,b,A){this.length=E.length,this.attributes=b,this.itemSize=E.bytesPerElement,this.dynamicDraw=A,this.context=_;var B=_.gl;this.buffer=B.createBuffer(),_.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer};wn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},wn.prototype.updateData=function(_){var E=this.context.gl;this.bind(),E.bufferSubData(E.ARRAY_BUFFER,0,_.arrayBuffer)},wn.prototype.enableAttributes=function(_,E){for(var b=0;b<this.attributes.length;b++){var A=E.attributes[this.attributes[b].name];A!==void 0&&_.enableVertexAttribArray(A)}},wn.prototype.setVertexAttribPointers=function(_,E,b){for(var A=0;A<this.attributes.length;A++){var B=this.attributes[A],H=E.attributes[B.name];H!==void 0&&_.vertexAttribPointer(H,B.components,_[cn[B.type]],!1,this.itemSize,B.offset+this.itemSize*(b||0))}},wn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ir=function(_){this.gl=_.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ir.prototype.get=function(){return this.current},ir.prototype.set=function(_){},ir.prototype.getDefault=function(){return this.default},ir.prototype.setDefault=function(){this.set(this.default)};var rn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return R.Color.transparent},E.prototype.set=function(b){var A=this.current;(b.r!==A.r||b.g!==A.g||b.b!==A.b||b.a!==A.a||this.dirty)&&(this.gl.clearColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)},E}(ir),De=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return 1},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.clearDepth(b),this.current=b,this.dirty=!1)},E}(ir),Be=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return 0},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.clearStencil(b),this.current=b,this.dirty=!1)},E}(ir),At=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return[!0,!0,!0,!0]},E.prototype.set=function(b){var A=this.current;(b[0]!==A[0]||b[1]!==A[1]||b[2]!==A[2]||b[3]!==A[3]||this.dirty)&&(this.gl.colorMask(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)},E}(ir),Bt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!0},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.depthMask(b),this.current=b,this.dirty=!1)},E}(ir),Ae=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return 255},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.stencilMask(b),this.current=b,this.dirty=!1)},E}(ir),z=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},E.prototype.set=function(b){var A=this.current;(b.func!==A.func||b.ref!==A.ref||b.mask!==A.mask||this.dirty)&&(this.gl.stencilFunc(b.func,b.ref,b.mask),this.current=b,this.dirty=!1)},E}(ir),rt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){var b=this.gl;return[b.KEEP,b.KEEP,b.KEEP]},E.prototype.set=function(b){var A=this.current;(b[0]!==A[0]||b[1]!==A[1]||b[2]!==A[2]||this.dirty)&&(this.gl.stencilOp(b[0],b[1],b[2]),this.current=b,this.dirty=!1)},E}(ir),F=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;b?A.enable(A.STENCIL_TEST):A.disable(A.STENCIL_TEST),this.current=b,this.dirty=!1}},E}(ir),ot=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return[0,1]},E.prototype.set=function(b){var A=this.current;(b[0]!==A[0]||b[1]!==A[1]||this.dirty)&&(this.gl.depthRange(b[0],b[1]),this.current=b,this.dirty=!1)},E}(ir),ze=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;b?A.enable(A.DEPTH_TEST):A.disable(A.DEPTH_TEST),this.current=b,this.dirty=!1}},E}(ir),Vt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.LESS},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.depthFunc(b),this.current=b,this.dirty=!1)},E}(ir),ae=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;b?A.enable(A.BLEND):A.disable(A.BLEND),this.current=b,this.dirty=!1}},E}(ir),Mn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){var b=this.gl;return[b.ONE,b.ZERO]},E.prototype.set=function(b){var A=this.current;(b[0]!==A[0]||b[1]!==A[1]||this.dirty)&&(this.gl.blendFunc(b[0],b[1]),this.current=b,this.dirty=!1)},E}(ir),zn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return R.Color.transparent},E.prototype.set=function(b){var A=this.current;(b.r!==A.r||b.g!==A.g||b.b!==A.b||b.a!==A.a||this.dirty)&&(this.gl.blendColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)},E}(ir),Wn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.FUNC_ADD},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.blendEquation(b),this.current=b,this.dirty=!1)},E}(ir),sn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;b?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE),this.current=b,this.dirty=!1}},E}(ir),Kt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.BACK},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.cullFace(b),this.current=b,this.dirty=!1)},E}(ir),Ce=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.CCW},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.frontFace(b),this.current=b,this.dirty=!1)},E}(ir),xn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)},E}(ir),Cn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.TEXTURE0},E.prototype.set=function(b){(b!==this.current||this.dirty)&&(this.gl.activeTexture(b),this.current=b,this.dirty=!1)},E}(ir),Zn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){var b=this.gl;return[0,0,b.drawingBufferWidth,b.drawingBufferHeight]},E.prototype.set=function(b){var A=this.current;(b[0]!==A[0]||b[1]!==A[1]||b[2]!==A[2]||b[3]!==A[3]||this.dirty)&&(this.gl.viewport(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)},E}(ir),Qt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.bindFramebuffer(A.FRAMEBUFFER,b),this.current=b,this.dirty=!1}},E}(ir),ct=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.bindRenderbuffer(A.RENDERBUFFER,b),this.current=b,this.dirty=!1}},E}(ir),bt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.bindTexture(A.TEXTURE_2D,b),this.current=b,this.dirty=!1}},E}(ir),zt=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.bindBuffer(A.ARRAY_BUFFER,b),this.current=b,this.dirty=!1}},E}(ir),me=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){var A=this.gl;A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,b),this.current=b,this.dirty=!1},E}(ir),de=function(_){function E(b){_.call(this,b),this.vao=b.extVertexArrayObject}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(b){this.vao&&(b!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(b),this.current=b,this.dirty=!1)},E}(ir),bn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return 4},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.pixelStorei(A.UNPACK_ALIGNMENT,b),this.current=b,this.dirty=!1}},E}(ir),qn=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b),this.current=b,this.dirty=!1}},E}(ir),Sr=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(b){if(b!==this.current||this.dirty){var A=this.gl;A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,b),this.current=b,this.dirty=!1}},E}(ir),Gn=function(_){function E(b,A){_.call(this,b),this.context=b,this.parent=A}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E}(ir),ht=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.setDirty=function(){this.dirty=!0},E.prototype.set=function(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var A=this.gl;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,b,0),this.current=b,this.dirty=!1}},E}(Gn),ut=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.set=function(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.RENDERBUFFER,b),this.current=b,this.dirty=!1}},E}(Gn),wt=function(_,E,b,A){this.context=_,this.width=E,this.height=b;var B=this.framebuffer=_.gl.createFramebuffer();this.colorAttachment=new ht(_,B),A&&(this.depthAttachment=new ut(_,B))};wt.prototype.destroy=function(){var _=this.context.gl,E=this.colorAttachment.get();if(E&&_.deleteTexture(E),this.depthAttachment){var b=this.depthAttachment.get();b&&_.deleteRenderbuffer(b)}_.deleteFramebuffer(this.framebuffer)};var Gt=function(_,E,b){this.func=_,this.mask=E,this.range=b};Gt.ReadOnly=!1,Gt.ReadWrite=!0,Gt.disabled=new Gt(519,Gt.ReadOnly,[0,1]);var ue=function(_,E,b,A,B,H){this.test=_,this.ref=E,this.mask=b,this.fail=A,this.depthFail=B,this.pass=H};ue.disabled=new ue({func:519,mask:0},0,0,7680,7680,7680);var Ge=function(_,E,b){this.blendFunction=_,this.blendColor=E,this.mask=b};Ge.disabled=new Ge(Ge.Replace=[1,0],R.Color.transparent,[!1,!1,!1,!1]),Ge.unblended=new Ge(Ge.Replace,R.Color.transparent,[!0,!0,!0,!0]),Ge.alphaBlended=new Ge([1,771],R.Color.transparent,[!0,!0,!0,!0]);var ln=function(_,E,b){this.enable=_,this.mode=E,this.frontFace=b};ln.disabled=new ln(!1,1029,2305),ln.backCCW=new ln(!0,1029,2305);var ee=function(_){this.gl=_,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new rn(this),this.clearDepth=new De(this),this.clearStencil=new Be(this),this.colorMask=new At(this),this.depthMask=new Bt(this),this.stencilMask=new Ae(this),this.stencilFunc=new z(this),this.stencilOp=new rt(this),this.stencilTest=new F(this),this.depthRange=new ot(this),this.depthTest=new ze(this),this.depthFunc=new Vt(this),this.blend=new ae(this),this.blendFunc=new Mn(this),this.blendColor=new zn(this),this.blendEquation=new Wn(this),this.cullFace=new sn(this),this.cullFaceSide=new Kt(this),this.frontFace=new Ce(this),this.program=new xn(this),this.activeTexture=new Cn(this),this.viewport=new Zn(this),this.bindFramebuffer=new Qt(this),this.bindRenderbuffer=new ct(this),this.bindTexture=new bt(this),this.bindVertexBuffer=new zt(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new de(this),this.pixelStoreUnpack=new bn(this),this.pixelStoreUnpackPremultiplyAlpha=new qn(this),this.pixelStoreUnpackFlipY=new Sr(this),this.extTextureFilterAnisotropic=_.getExtension("EXT_texture_filter_anisotropic")||_.getExtension("MOZ_EXT_texture_filter_anisotropic")||_.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=_.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=_.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(_.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=_.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=_.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=_.getParameter(_.MAX_TEXTURE_SIZE)};ee.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ee.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ee.prototype.createIndexBuffer=function(_,E){return new Ue(this,_,E)},ee.prototype.createVertexBuffer=function(_,E,b){return new wn(this,_,E,b)},ee.prototype.createRenderbuffer=function(_,E,b){var A=this.gl,B=A.createRenderbuffer();return this.bindRenderbuffer.set(B),A.renderbufferStorage(A.RENDERBUFFER,_,E,b),this.bindRenderbuffer.set(null),B},ee.prototype.createFramebuffer=function(_,E,b){return new wt(this,_,E,b)},ee.prototype.clear=function(_){var E=_.color,b=_.depth,A=this.gl,B=0;E&&(B|=A.COLOR_BUFFER_BIT,this.clearColor.set(E),this.colorMask.set([!0,!0,!0,!0])),b!==void 0&&(B|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(b),this.depthMask.set(!0)),A.clear(B)},ee.prototype.setCullFace=function(_){_.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(_.mode),this.frontFace.set(_.frontFace))},ee.prototype.setDepthMode=function(_){_.func!==this.gl.ALWAYS||_.mask?(this.depthTest.set(!0),this.depthFunc.set(_.func),this.depthMask.set(_.mask),this.depthRange.set(_.range)):this.depthTest.set(!1)},ee.prototype.setStencilMode=function(_){_.test.func!==this.gl.ALWAYS||_.mask?(this.stencilTest.set(!0),this.stencilMask.set(_.mask),this.stencilOp.set([_.fail,_.depthFail,_.pass]),this.stencilFunc.set({func:_.test.func,ref:_.ref,mask:_.test.mask})):this.stencilTest.set(!1)},ee.prototype.setColorMode=function(_){R.deepEqual(_.blendFunction,Ge.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(_.blendFunction),this.blendColor.set(_.blendColor)),this.colorMask.set(_.mask)},ee.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Fe=function(_){function E(b,A,B){var H=this;_.call(this),this.id=b,this.dispatcher=B,this.on("data",function(Y){Y.dataType==="source"&&Y.sourceDataType==="metadata"&&(H._sourceLoaded=!0),H._sourceLoaded&&!H._paused&&Y.dataType==="source"&&Y.sourceDataType==="content"&&(H.reload(),H.transform&&H.update(H.transform))}),this.on("error",function(){H._sourceErrored=!0}),this._source=function(Y,et,St,Rt){var ye=new Ne[et.type](Y,et,St,Rt);if(ye.id!==Y)throw new Error("Expected Source id to be "+Y+" instead of "+ye.id);return R.bindAll(["load","abort","unload","serialize","prepare"],ye),ye}(b,A,B,this),this._tiles={},this._cache=new Er(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new R.SourceFeatureState}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.onAdd=function(b){this.map=b,this._maxTileCacheSize=b?b._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(b)},E.prototype.onRemove=function(b){this._source&&this._source.onRemove&&this._source.onRemove(b)},E.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var b in this._tiles){var A=this._tiles[b];if(A.state!=="loaded"&&A.state!=="errored")return!1}return!0},E.prototype.getSource=function(){return this._source},E.prototype.pause=function(){this._paused=!0},E.prototype.resume=function(){if(this._paused){var b=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,b&&this.reload(),this.transform&&this.update(this.transform)}},E.prototype._loadTile=function(b,A){return this._source.loadTile(b,A)},E.prototype._unloadTile=function(b){if(this._source.unloadTile)return this._source.unloadTile(b,function(){})},E.prototype._abortTile=function(b){if(this._source.abortTile)return this._source.abortTile(b,function(){})},E.prototype.serialize=function(){return this._source.serialize()},E.prototype.prepare=function(b){for(var A in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var B=this._tiles[A];B.upload(b),B.prepare(this.map.style.imageManager)}},E.prototype.getIds=function(){return R.values(this._tiles).map(function(b){return b.tileID}).sort(Hn).map(function(b){return b.key})},E.prototype.getRenderableIds=function(b){var A=this,B=[];for(var H in this._tiles)this._isIdRenderable(H,b)&&B.push(this._tiles[H]);return b?B.sort(function(Y,et){var St=Y.tileID,Rt=et.tileID,ye=new R.Point(St.canonical.x,St.canonical.y)._rotate(A.transform.angle),be=new R.Point(Rt.canonical.x,Rt.canonical.y)._rotate(A.transform.angle);return St.overscaledZ-Rt.overscaledZ||be.y-ye.y||be.x-ye.x}).map(function(Y){return Y.tileID.key}):B.map(function(Y){return Y.tileID}).sort(Hn).map(function(Y){return Y.key})},E.prototype.hasRenderableParent=function(b){var A=this.findLoadedParent(b,0);return!!A&&this._isIdRenderable(A.tileID.key)},E.prototype._isIdRenderable=function(b,A){return this._tiles[b]&&this._tiles[b].hasData()&&!this._coveredTiles[b]&&(A||!this._tiles[b].holdingForFade())},E.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var b in this._cache.reset(),this._tiles)this._tiles[b].state!=="errored"&&this._reloadTile(b,"reloading")},E.prototype._reloadTile=function(b,A){var B=this._tiles[b];B&&(B.state!=="loading"&&(B.state=A),this._loadTile(B,this._tileLoaded.bind(this,B,b,A)))},E.prototype._tileLoaded=function(b,A,B,H){if(H)return b.state="errored",void(H.status!==404?this._source.fire(new R.ErrorEvent(H,{tile:b})):this.update(this.transform));b.timeAdded=R.browser.now(),B==="expired"&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(A,b),this.getSource().type==="raster-dem"&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),this._source.fire(new R.Event("data",{dataType:"source",tile:b,coord:b.tileID}))},E.prototype._backfillDEM=function(b){for(var A=this.getRenderableIds(),B=0;B<A.length;B++){var H=A[B];if(b.neighboringTiles&&b.neighboringTiles[H]){var Y=this.getTileByID(H);et(b,Y),et(Y,b)}}function et(St,Rt){St.needsHillshadePrepare=!0;var ye=Rt.tileID.canonical.x-St.tileID.canonical.x,be=Rt.tileID.canonical.y-St.tileID.canonical.y,Oe=Math.pow(2,St.tileID.canonical.z),on=Rt.tileID.key;ye===0&&be===0||Math.abs(be)>1||(Math.abs(ye)>1&&(Math.abs(ye+Oe)===1?ye+=Oe:Math.abs(ye-Oe)===1&&(ye-=Oe)),Rt.dem&&St.dem&&(St.dem.backfillBorder(Rt.dem,ye,be),St.neighboringTiles&&St.neighboringTiles[on]&&(St.neighboringTiles[on].backfilled=!0)))}},E.prototype.getTile=function(b){return this.getTileByID(b.key)},E.prototype.getTileByID=function(b){return this._tiles[b]},E.prototype._retainLoadedChildren=function(b,A,B,H){for(var Y in this._tiles){var et=this._tiles[Y];if(!(H[Y]||!et.hasData()||et.tileID.overscaledZ<=A||et.tileID.overscaledZ>B)){for(var St=et.tileID;et&&et.tileID.overscaledZ>A+1;){var Rt=et.tileID.scaledTo(et.tileID.overscaledZ-1);(et=this._tiles[Rt.key])&&et.hasData()&&(St=Rt)}for(var ye=St;ye.overscaledZ>A;)if(b[(ye=ye.scaledTo(ye.overscaledZ-1)).key]){H[St.key]=St;break}}}},E.prototype.findLoadedParent=function(b,A){if(b.key in this._loadedParentTiles){var B=this._loadedParentTiles[b.key];return B&&B.tileID.overscaledZ>=A?B:null}for(var H=b.overscaledZ-1;H>=A;H--){var Y=b.scaledTo(H),et=this._getLoadedTile(Y);if(et)return et}},E.prototype._getLoadedTile=function(b){var A=this._tiles[b.key];return A&&A.hasData()?A:this._cache.getByKey(b.wrapped().key)},E.prototype.updateCacheSize=function(b){var A=Math.ceil(b.width/this._source.tileSize)+1,B=Math.ceil(b.height/this._source.tileSize)+1,H=Math.floor(A*B*5),Y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,H):H;this._cache.setMaxSize(Y)},E.prototype.handleWrapJump=function(b){var A=Math.round((b-(this._prevLng===void 0?b:this._prevLng))/360);if(this._prevLng=b,A){var B={};for(var H in this._tiles){var Y=this._tiles[H];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+A),B[Y.tileID.key]=Y}for(var et in this._tiles=B,this._timers)clearTimeout(this._timers[et]),delete this._timers[et];for(var St in this._tiles)this._setTileReloadTimer(St,this._tiles[St])}},E.prototype.update=function(b){var A=this;if(this.transform=b,this._sourceLoaded&&!this._paused){var B;this.updateCacheSize(b),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?B=b.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ei){return new R.OverscaledTileID(ei.canonical.z,ei.wrap,ei.canonical.z,ei.canonical.x,ei.canonical.y)}):(B=b.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(B=B.filter(function(ei){return A._source.hasTile(ei)}))):B=[];var H=b.coveringZoomLevel(this._source),Y=Math.max(H-E.maxOverzooming,this._source.minzoom),et=Math.max(H+E.maxUnderzooming,this._source.minzoom),St=this._updateRetainedTiles(B,H);if(Tr(this._source.type)){for(var Rt={},ye={},be=0,Oe=Object.keys(St);be<Oe.length;be+=1){var on=Oe[be],Qe=St[on],vn=this._tiles[on];if(vn&&!(vn.fadeEndTime&&vn.fadeEndTime<=R.browser.now())){var Ye=this.findLoadedParent(Qe,Y);Ye&&(this._addTile(Ye.tileID),Rt[Ye.tileID.key]=Ye.tileID),ye[on]=Qe}}for(var On in this._retainLoadedChildren(ye,H,et,St),Rt)St[On]||(this._coveredTiles[On]=!0,St[On]=Rt[On])}for(var jn in St)this._tiles[jn].clearFadeHold();for(var ar=0,Or=R.keysDifference(this._tiles,St);ar<Or.length;ar+=1){var cr=Or[ar],kr=this._tiles[cr];kr.hasSymbolBuckets&&!kr.holdingForFade()?kr.setHoldDuration(this.map._fadeDuration):kr.hasSymbolBuckets&&!kr.symbolFadeFinished()||this._removeTile(cr)}this._updateLoadedParentTileCache()}},E.prototype.releaseSymbolFadeTiles=function(){for(var b in this._tiles)this._tiles[b].holdingForFade()&&this._removeTile(b)},E.prototype._updateRetainedTiles=function(b,A){for(var B={},H={},Y=Math.max(A-E.maxOverzooming,this._source.minzoom),et=Math.max(A+E.maxUnderzooming,this._source.minzoom),St={},Rt=0,ye=b;Rt<ye.length;Rt+=1){var be=ye[Rt],Oe=this._addTile(be);B[be.key]=be,Oe.hasData()||A<this._source.maxzoom&&(St[be.key]=be)}this._retainLoadedChildren(St,A,et,B);for(var on=0,Qe=b;on<Qe.length;on+=1){var vn=Qe[on],Ye=this._tiles[vn.key];if(!Ye.hasData()){if(A+1>this._source.maxzoom){var On=vn.children(this._source.maxzoom)[0],jn=this.getTile(On);if(jn&&jn.hasData()){B[On.key]=On;continue}}else{var ar=vn.children(this._source.maxzoom);if(B[ar[0].key]&&B[ar[1].key]&&B[ar[2].key]&&B[ar[3].key])continue}for(var Or=Ye.wasRequested(),cr=vn.overscaledZ-1;cr>=Y;--cr){var kr=vn.scaledTo(cr);if(H[kr.key]||(H[kr.key]=!0,!(Ye=this.getTile(kr))&&Or&&(Ye=this._addTile(kr)),Ye&&(B[kr.key]=kr,Or=Ye.wasRequested(),Ye.hasData())))break}}}return B},E.prototype._updateLoadedParentTileCache=function(){for(var b in this._loadedParentTiles={},this._tiles){for(var A=[],B=void 0,H=this._tiles[b].tileID;H.overscaledZ>0;){if(H.key in this._loadedParentTiles){B=this._loadedParentTiles[H.key];break}A.push(H.key);var Y=H.scaledTo(H.overscaledZ-1);if(B=this._getLoadedTile(Y))break;H=Y}for(var et=0,St=A;et<St.length;et+=1)this._loadedParentTiles[St[et]]=B}},E.prototype._addTile=function(b){var A=this._tiles[b.key];if(A)return A;(A=this._cache.getAndRemove(b))&&(this._setTileReloadTimer(b.key,A),A.tileID=b,this._state.initializeTileState(A,this.map?this.map.painter:null),this._cacheTimers[b.key]&&(clearTimeout(this._cacheTimers[b.key]),delete this._cacheTimers[b.key],this._setTileReloadTimer(b.key,A)));var B=!!A;return B||(A=new R.Tile(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(A,this._tileLoaded.bind(this,A,b.key,A.state))),A?(A.uses++,this._tiles[b.key]=A,B||this._source.fire(new R.Event("dataloading",{tile:A,coord:A.tileID,dataType:"source"})),A):null},E.prototype._setTileReloadTimer=function(b,A){var B=this;b in this._timers&&(clearTimeout(this._timers[b]),delete this._timers[b]);var H=A.getExpiryTimeout();H&&(this._timers[b]=setTimeout(function(){B._reloadTile(b,"expired"),delete B._timers[b]},H))},E.prototype._removeTile=function(b){var A=this._tiles[b];A&&(A.uses--,delete this._tiles[b],this._timers[b]&&(clearTimeout(this._timers[b]),delete this._timers[b]),A.uses>0||(A.hasData()&&A.state!=="reloading"?this._cache.add(A.tileID,A,A.getExpiryTimeout()):(A.aborted=!0,this._abortTile(A),this._unloadTile(A))))},E.prototype.clearTiles=function(){for(var b in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(b);this._cache.reset()},E.prototype.tilesIn=function(b,A,B){var H=this,Y=[],et=this.transform;if(!et)return Y;for(var St=B?et.getCameraQueryGeometry(b):b,Rt=b.map(function(cr){return et.pointCoordinate(cr)}),ye=St.map(function(cr){return et.pointCoordinate(cr)}),be=this.getIds(),Oe=1/0,on=1/0,Qe=-1/0,vn=-1/0,Ye=0,On=ye;Ye<On.length;Ye+=1){var jn=On[Ye];Oe=Math.min(Oe,jn.x),on=Math.min(on,jn.y),Qe=Math.max(Qe,jn.x),vn=Math.max(vn,jn.y)}for(var ar=function(cr){var kr=H._tiles[be[cr]];if(!kr.holdingForFade()){var ei=kr.tileID,Yr=Math.pow(2,et.zoom-kr.tileID.overscaledZ),Ti=A*kr.queryPadding*R.EXTENT/kr.tileSize/Yr,zi=[ei.getTilePoint(new R.MercatorCoordinate(Oe,on)),ei.getTilePoint(new R.MercatorCoordinate(Qe,vn))];if(zi[0].x-Ti<R.EXTENT&&zi[0].y-Ti<R.EXTENT&&zi[1].x+Ti>=0&&zi[1].y+Ti>=0){var Io=Rt.map(function(Fo){return ei.getTilePoint(Fo)}),Bo=ye.map(function(Fo){return ei.getTilePoint(Fo)});Y.push({tile:kr,tileID:ei,queryGeometry:Io,cameraQueryGeometry:Bo,scale:Yr})}}},Or=0;Or<be.length;Or++)ar(Or);return Y},E.prototype.getVisibleCoordinates=function(b){for(var A=this,B=this.getRenderableIds(b).map(function(St){return A._tiles[St].tileID}),H=0,Y=B;H<Y.length;H+=1){var et=Y[H];et.posMatrix=this.transform.calculatePosMatrix(et.toUnwrapped())}return B},E.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Tr(this._source.type))for(var b in this._tiles){var A=this._tiles[b];if(A.fadeEndTime!==void 0&&A.fadeEndTime>=R.browser.now())return!0}return!1},E.prototype.setFeatureState=function(b,A,B){this._state.updateState(b=b||"_geojsonTileLayer",A,B)},E.prototype.removeFeatureState=function(b,A,B){this._state.removeFeatureState(b=b||"_geojsonTileLayer",A,B)},E.prototype.getFeatureState=function(b,A){return this._state.getState(b=b||"_geojsonTileLayer",A)},E.prototype.setDependencies=function(b,A,B){var H=this._tiles[b];H&&H.setDependencies(A,B)},E.prototype.reloadTilesForDependencies=function(b,A){for(var B in this._tiles)this._tiles[B].hasDependency(b,A)&&this._reloadTile(B,"reloading");this._cache.filter(function(H){return!H.hasDependency(b,A)})},E}(R.Evented);function Hn(_,E){var b=Math.abs(2*_.wrap)-+(_.wrap<0),A=Math.abs(2*E.wrap)-+(E.wrap<0);return _.overscaledZ-E.overscaledZ||A-b||E.canonical.y-_.canonical.y||E.canonical.x-_.canonical.x}function Tr(_){return _==="raster"||_==="image"||_==="video"}function Zr(){return new R.window.Worker(t0.workerUrl)}Fe.maxOverzooming=10,Fe.maxUnderzooming=3;var vr="mapboxgl_preloaded_worker_pool",Ur=function(){this.active={}};Ur.prototype.acquire=function(_){if(!this.workers)for(this.workers=[];this.workers.length<Ur.workerCount;)this.workers.push(new Zr);return this.active[_]=!0,this.workers.slice()},Ur.prototype.release=function(_){delete this.active[_],this.numActive()===0&&(this.workers.forEach(function(E){E.terminate()}),this.workers=null)},Ur.prototype.isPreloaded=function(){return!!this.active[vr]},Ur.prototype.numActive=function(){return Object.keys(this.active).length};var jr,ni=Math.floor(R.browser.hardwareConcurrency/2);function Ar(){return jr||(jr=new Ur),jr}function pi(_,E){var b={};for(var A in _)A!=="ref"&&(b[A]=_[A]);return R.refProperties.forEach(function(B){B in E&&(b[B]=E[B])}),b}function mi(_){_=_.slice();for(var E=Object.create(null),b=0;b<_.length;b++)E[_[b].id]=_[b];for(var A=0;A<_.length;A++)"ref"in _[A]&&(_[A]=pi(_[A],E[_[A].ref]));return _}Ur.workerCount=Math.max(Math.min(ni,6),1);var xi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wo(_,E,b){b.push({command:xi.addSource,args:[_,E[_]]})}function Li(_,E,b){E.push({command:xi.removeSource,args:[_]}),b[_]=!0}function aa(_,E,b,A){Li(_,b,A),wo(_,E,b)}function Pa(_,E,b){var A;for(A in _[b])if(_[b].hasOwnProperty(A)&&A!=="data"&&!R.deepEqual(_[b][A],E[b][A]))return!1;for(A in E[b])if(E[b].hasOwnProperty(A)&&A!=="data"&&!R.deepEqual(_[b][A],E[b][A]))return!1;return!0}function Lo(_,E,b,A,B,H){var Y;for(Y in E=E||{},_=_||{})_.hasOwnProperty(Y)&&(R.deepEqual(_[Y],E[Y])||b.push({command:H,args:[A,Y,E[Y],B]}));for(Y in E)E.hasOwnProperty(Y)&&!_.hasOwnProperty(Y)&&(R.deepEqual(_[Y],E[Y])||b.push({command:H,args:[A,Y,E[Y],B]}))}function $o(_){return _.id}function Mt(_,E){return _[E.id]=E,_}var Wt=function(_,E){this.reset(_,E)};Wt.prototype.reset=function(_,E){this.points=_||[],this._distances=[0];for(var b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(E||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Wt.prototype.lerp=function(_){if(this.points.length===1)return this.points[0];_=R.clamp(_,0,1);for(var E=1,b=this._distances[E],A=_*this.paddedLength+this.padding;b<A&&E<this._distances.length;)b=this._distances[++E];var B=E-1,H=this._distances[B],Y=b-H,et=Y>0?(A-H)/Y:0;return this.points[B].mult(1-et).add(this.points[E].mult(et))};var Se=function(_,E,b){var A=this.boxCells=[],B=this.circleCells=[];this.xCellCount=Math.ceil(_/b),this.yCellCount=Math.ceil(E/b);for(var H=0;H<this.xCellCount*this.yCellCount;H++)A.push([]),B.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=_,this.height=E,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/E,this.boxUid=0,this.circleUid=0};function qe(_,E,b,A,B){var H=R.create();return E?(R.scale(H,H,[1/B,1/B,1]),b||R.rotateZ(H,H,A.angle)):R.multiply(H,A.labelPlaneMatrix,_),H}function Rn(_,E,b,A,B){if(E){var H=R.clone(_);return R.scale(H,H,[B,B,1]),b||R.rotateZ(H,H,-A.angle),H}return A.glCoordMatrix}function Pn(_,E){var b=[_.x,_.y,0,1];Xr(b,b,E);var A=b[3];return{point:new R.Point(b[0]/A,b[1]/A),signedDistanceFromCamera:A}}function tn(_,E){return .5+_/E*.5}function mn(_,E){var b=_[0]/_[3],A=_[1]/_[3];return b>=-E[0]&&b<=E[0]&&A>=-E[1]&&A<=E[1]}function dr(_,E,b,A,B,H,Y,et){var St=A?_.textSizeData:_.iconSizeData,Rt=R.evaluateSizeForZoom(St,b.transform.zoom),ye=[256/b.width*2+1,256/b.height*2+1],be=A?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;be.clear();for(var Oe=_.lineVertexArray,on=A?_.text.placedSymbolArray:_.icon.placedSymbolArray,Qe=b.transform.width/b.transform.height,vn=!1,Ye=0;Ye<on.length;Ye++){var On=on.get(Ye);if(On.hidden||On.writingMode===R.WritingMode.vertical&&!vn)Ui(On.numGlyphs,be);else{vn=!1;var jn=[On.anchorX,On.anchorY,0,1];if(R.transformMat4(jn,jn,E),mn(jn,ye)){var ar=tn(b.transform.cameraToCenterDistance,jn[3]),Or=R.evaluateSizeForFeature(St,Rt,On),cr=Y?Or/ar:Or*ar,kr=new R.Point(On.anchorX,On.anchorY),ei=Pn(kr,B).point,Yr={},Ti=Vi(On,cr,!1,et,E,B,H,_.glyphOffsetArray,Oe,be,ei,kr,Yr,Qe);vn=Ti.useVertical,(Ti.notEnoughRoom||vn||Ti.needsFlipping&&Vi(On,cr,!0,et,E,B,H,_.glyphOffsetArray,Oe,be,ei,kr,Yr,Qe).notEnoughRoom)&&Ui(On.numGlyphs,be)}else Ui(On.numGlyphs,be)}}A?_.text.dynamicLayoutVertexBuffer.updateData(be):_.icon.dynamicLayoutVertexBuffer.updateData(be)}function fr(_,E,b,A,B,H,Y,et,St,Rt,ye){var be=et.glyphStartIndex+et.numGlyphs,Oe=et.lineStartIndex,on=et.lineStartIndex+et.lineLength,Qe=E.getoffsetX(et.glyphStartIndex),vn=E.getoffsetX(be-1),Ye=si(_*Qe,b,A,B,H,Y,et.segment,Oe,on,St,Rt,ye);if(!Ye)return null;var On=si(_*vn,b,A,B,H,Y,et.segment,Oe,on,St,Rt,ye);return On?{first:Ye,last:On}:null}function ai(_,E,b,A){return _===R.WritingMode.horizontal&&Math.abs(b.y-E.y)>Math.abs(b.x-E.x)*A?{useVertical:!0}:(_===R.WritingMode.vertical?E.y<b.y:E.x>b.x)?{needsFlipping:!0}:null}function Vi(_,E,b,A,B,H,Y,et,St,Rt,ye,be,Oe,on){var Qe,vn=E/24,Ye=_.lineOffsetX*vn,On=_.lineOffsetY*vn;if(_.numGlyphs>1){var jn=_.glyphStartIndex+_.numGlyphs,ar=_.lineStartIndex,Or=_.lineStartIndex+_.lineLength,cr=fr(vn,et,Ye,On,b,ye,be,_,St,H,Oe);if(!cr)return{notEnoughRoom:!0};var kr=Pn(cr.first.point,Y).point,ei=Pn(cr.last.point,Y).point;if(A&&!b){var Yr=ai(_.writingMode,kr,ei,on);if(Yr)return Yr}Qe=[cr.first];for(var Ti=_.glyphStartIndex+1;Ti<jn-1;Ti++)Qe.push(si(vn*et.getoffsetX(Ti),Ye,On,b,ye,be,_.segment,ar,Or,St,H,Oe));Qe.push(cr.last)}else{if(A&&!b){var zi=Pn(be,B).point,Io=_.lineStartIndex+_.segment+1,Bo=new R.Point(St.getx(Io),St.gety(Io)),Fo=Pn(Bo,B),ua=Fo.signedDistanceFromCamera>0?Fo.point:mo(be,Bo,zi,1,B),Tn=ai(_.writingMode,zi,ua,on);if(Tn)return Tn}var Me=si(vn*et.getoffsetX(_.glyphStartIndex),Ye,On,b,ye,be,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,St,H,Oe);if(!Me)return{notEnoughRoom:!0};Qe=[Me]}for(var la=0,ta=Qe;la<ta.length;la+=1){var Vo=ta[la];R.addDynamicAttributes(Rt,Vo.point,Vo.angle)}return{}}function mo(_,E,b,A,B){var H=Pn(_.add(_.sub(E)._unit()),B).point,Y=b.sub(H);return b.add(Y._mult(A/Y.mag()))}function si(_,E,b,A,B,H,Y,et,St,Rt,ye,be){var Oe=A?_-E:_+E,on=Oe>0?1:-1,Qe=0;A&&(on*=-1,Qe=Math.PI),on<0&&(Qe+=Math.PI);for(var vn=on>0?et+Y:et+Y+1,Ye=B,On=B,jn=0,ar=0,Or=Math.abs(Oe),cr=[];jn+ar<=Or;){if((vn+=on)<et||vn>=St)return null;if(On=Ye,cr.push(Ye),(Ye=be[vn])===void 0){var kr=new R.Point(Rt.getx(vn),Rt.gety(vn)),ei=Pn(kr,ye);if(ei.signedDistanceFromCamera>0)Ye=be[vn]=ei.point;else{var Yr=vn-on;Ye=mo(jn===0?H:new R.Point(Rt.getx(Yr),Rt.gety(Yr)),kr,On,Or-jn+1,ye)}}jn+=ar,ar=On.dist(Ye)}var Ti=(Or-jn)/ar,zi=Ye.sub(On),Io=zi.mult(Ti)._add(On);Io._add(zi._unit()._perp()._mult(b*on));var Bo=Qe+Math.atan2(Ye.y-On.y,Ye.x-On.x);return cr.push(Io),{point:Io,angle:Bo,path:cr}}Se.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Se.prototype.insert=function(_,E,b,A,B){this._forEachCell(E,b,A,B,this._insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(E),this.bboxes.push(b),this.bboxes.push(A),this.bboxes.push(B)},Se.prototype.insertCircle=function(_,E,b,A){this._forEachCell(E-A,b-A,E+A,b+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(_),this.circles.push(E),this.circles.push(b),this.circles.push(A)},Se.prototype._insertBoxCell=function(_,E,b,A,B,H){this.boxCells[B].push(H)},Se.prototype._insertCircleCell=function(_,E,b,A,B,H){this.circleCells[B].push(H)},Se.prototype._query=function(_,E,b,A,B,H){if(b<0||_>this.width||A<0||E>this.height)return!B&&[];var Y=[];if(_<=0&&E<=0&&this.width<=b&&this.height<=A){if(B)return!0;for(var et=0;et<this.boxKeys.length;et++)Y.push({key:this.boxKeys[et],x1:this.bboxes[4*et],y1:this.bboxes[4*et+1],x2:this.bboxes[4*et+2],y2:this.bboxes[4*et+3]});for(var St=0;St<this.circleKeys.length;St++){var Rt=this.circles[3*St],ye=this.circles[3*St+1],be=this.circles[3*St+2];Y.push({key:this.circleKeys[St],x1:Rt-be,y1:ye-be,x2:Rt+be,y2:ye+be})}return H?Y.filter(H):Y}return this._forEachCell(_,E,b,A,this._queryCell,Y,{hitTest:B,seenUids:{box:{},circle:{}}},H),B?Y.length>0:Y},Se.prototype._queryCircle=function(_,E,b,A,B){var H=_-b,Y=_+b,et=E-b,St=E+b;if(Y<0||H>this.width||St<0||et>this.height)return!A&&[];var Rt=[];return this._forEachCell(H,et,Y,St,this._queryCellCircle,Rt,{hitTest:A,circle:{x:_,y:E,radius:b},seenUids:{box:{},circle:{}}},B),A?Rt.length>0:Rt},Se.prototype.query=function(_,E,b,A,B){return this._query(_,E,b,A,!1,B)},Se.prototype.hitTest=function(_,E,b,A,B){return this._query(_,E,b,A,!0,B)},Se.prototype.hitTestCircle=function(_,E,b,A){return this._queryCircle(_,E,b,!0,A)},Se.prototype._queryCell=function(_,E,b,A,B,H,Y,et){var St=Y.seenUids,Rt=this.boxCells[B];if(Rt!==null)for(var ye=this.bboxes,be=0,Oe=Rt;be<Oe.length;be+=1){var on=Oe[be];if(!St.box[on]){St.box[on]=!0;var Qe=4*on;if(_<=ye[Qe+2]&&E<=ye[Qe+3]&&b>=ye[Qe+0]&&A>=ye[Qe+1]&&(!et||et(this.boxKeys[on]))){if(Y.hitTest)return H.push(!0),!0;H.push({key:this.boxKeys[on],x1:ye[Qe],y1:ye[Qe+1],x2:ye[Qe+2],y2:ye[Qe+3]})}}}var vn=this.circleCells[B];if(vn!==null)for(var Ye=this.circles,On=0,jn=vn;On<jn.length;On+=1){var ar=jn[On];if(!St.circle[ar]){St.circle[ar]=!0;var Or=3*ar;if(this._circleAndRectCollide(Ye[Or],Ye[Or+1],Ye[Or+2],_,E,b,A)&&(!et||et(this.circleKeys[ar]))){if(Y.hitTest)return H.push(!0),!0;var cr=Ye[Or],kr=Ye[Or+1],ei=Ye[Or+2];H.push({key:this.circleKeys[ar],x1:cr-ei,y1:kr-ei,x2:cr+ei,y2:kr+ei})}}}},Se.prototype._queryCellCircle=function(_,E,b,A,B,H,Y,et){var St=Y.circle,Rt=Y.seenUids,ye=this.boxCells[B];if(ye!==null)for(var be=this.bboxes,Oe=0,on=ye;Oe<on.length;Oe+=1){var Qe=on[Oe];if(!Rt.box[Qe]){Rt.box[Qe]=!0;var vn=4*Qe;if(this._circleAndRectCollide(St.x,St.y,St.radius,be[vn+0],be[vn+1],be[vn+2],be[vn+3])&&(!et||et(this.boxKeys[Qe])))return H.push(!0),!0}}var Ye=this.circleCells[B];if(Ye!==null)for(var On=this.circles,jn=0,ar=Ye;jn<ar.length;jn+=1){var Or=ar[jn];if(!Rt.circle[Or]){Rt.circle[Or]=!0;var cr=3*Or;if(this._circlesCollide(On[cr],On[cr+1],On[cr+2],St.x,St.y,St.radius)&&(!et||et(this.circleKeys[Or])))return H.push(!0),!0}}},Se.prototype._forEachCell=function(_,E,b,A,B,H,Y,et){for(var St=this._convertToXCellCoord(_),Rt=this._convertToYCellCoord(E),ye=this._convertToXCellCoord(b),be=this._convertToYCellCoord(A),Oe=St;Oe<=ye;Oe++)for(var on=Rt;on<=be;on++)if(B.call(this,_,E,b,A,this.xCellCount*on+Oe,H,Y,et))return},Se.prototype._convertToXCellCoord=function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))},Se.prototype._convertToYCellCoord=function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))},Se.prototype._circlesCollide=function(_,E,b,A,B,H){var Y=A-_,et=B-E,St=b+H;return St*St>Y*Y+et*et},Se.prototype._circleAndRectCollide=function(_,E,b,A,B,H,Y){var et=(H-A)/2,St=Math.abs(_-(A+et));if(St>et+b)return!1;var Rt=(Y-B)/2,ye=Math.abs(E-(B+Rt));if(ye>Rt+b)return!1;if(St<=et||ye<=Rt)return!0;var be=St-et,Oe=ye-Rt;return be*be+Oe*Oe<=b*b};var Wi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ui(_,E){for(var b=0;b<_;b++){var A=E.length;E.resize(A+4),E.float32.set(Wi,3*A)}}function Xr(_,E,b){var A=E[0],B=E[1];return _[0]=b[0]*A+b[4]*B+b[12],_[1]=b[1]*A+b[5]*B+b[13],_[3]=b[3]*A+b[7]*B+b[15],_}var bo=function(_,E,b){E===void 0&&(E=new Se(_.width+200,_.height+200,25)),b===void 0&&(b=new Se(_.width+200,_.height+200,25)),this.transform=_,this.grid=E,this.ignoredGrid=b,this.pitchfactor=Math.cos(_._pitch)*_.cameraToCenterDistance,this.screenRightBoundary=_.width+100,this.screenBottomBoundary=_.height+100,this.gridRightBoundary=_.width+200,this.gridBottomBoundary=_.height+200};function Ni(_,E,b){return E*(R.EXTENT/(_.tileSize*Math.pow(2,b-_.tileID.overscaledZ)))}bo.prototype.placeCollisionBox=function(_,E,b,A,B){var H=this.projectAndGetPerspectiveRatio(A,_.anchorPointX,_.anchorPointY),Y=b*H.perspectiveRatio,et=_.x1*Y+H.point.x,St=_.y1*Y+H.point.y,Rt=_.x2*Y+H.point.x,ye=_.y2*Y+H.point.y;return!this.isInsideGrid(et,St,Rt,ye)||!E&&this.grid.hitTest(et,St,Rt,ye,B)?{box:[],offscreen:!1}:{box:[et,St,Rt,ye],offscreen:this.isOffscreen(et,St,Rt,ye)}},bo.prototype.placeCollisionCircles=function(_,E,b,A,B,H,Y,et,St,Rt,ye,be,Oe){var on=[],Qe=new R.Point(E.anchorX,E.anchorY),vn=Pn(Qe,H),Ye=tn(this.transform.cameraToCenterDistance,vn.signedDistanceFromCamera),On=(Rt?B/Ye:B*Ye)/R.ONE_EM,jn=Pn(Qe,Y).point,ar=fr(On,A,E.lineOffsetX*On,E.lineOffsetY*On,!1,jn,Qe,E,b,Y,{}),Or=!1,cr=!1,kr=!0;if(ar){for(var ei=.5*be*Ye+Oe,Yr=new R.Point(-100,-100),Ti=new R.Point(this.screenRightBoundary,this.screenBottomBoundary),zi=new Wt,Io=ar.first,Bo=ar.last,Fo=[],ua=Io.path.length-1;ua>=1;ua--)Fo.push(Io.path[ua]);for(var Tn=1;Tn<Bo.path.length;Tn++)Fo.push(Bo.path[Tn]);var Me=2.5*ei;if(et){var la=Fo.map(function(Vu){return Pn(Vu,et)});Fo=la.some(function(Vu){return Vu.signedDistanceFromCamera<=0})?[]:la.map(function(Vu){return Vu.point})}var ta=[];if(Fo.length>0){for(var Vo=Fo[0].clone(),ga=Fo[0].clone(),jo=1;jo<Fo.length;jo++)Vo.x=Math.min(Vo.x,Fo[jo].x),Vo.y=Math.min(Vo.y,Fo[jo].y),ga.x=Math.max(ga.x,Fo[jo].x),ga.y=Math.max(ga.y,Fo[jo].y);ta=Vo.x>=Yr.x&&ga.x<=Ti.x&&Vo.y>=Yr.y&&ga.y<=Ti.y?[Fo]:ga.x<Yr.x||Vo.x>Ti.x||ga.y<Yr.y||Vo.y>Ti.y?[]:R.clipLine([Fo],Yr.x,Yr.y,Ti.x,Ti.y)}for(var Do=0,hc=ta;Do<hc.length;Do+=1){var ml;zi.reset(hc[Do],.25*ei),ml=zi.length<=.5*ei?1:Math.ceil(zi.paddedLength/Me)+1;for(var Bc=0;Bc<ml;Bc++){var Wl=Bc/Math.max(ml-1,1),vs=zi.lerp(Wl),Ks=vs.x+100,sl=vs.y+100;on.push(Ks,sl,ei,0);var vl=Ks-ei,_f=sl-ei,ol=Ks+ei,sf=sl+ei;if(kr=kr&&this.isOffscreen(vl,_f,ol,sf),cr=cr||this.isInsideGrid(vl,_f,ol,sf),!_&&this.grid.hitTestCircle(Ks,sl,ei,ye)&&(Or=!0,!St))return{circles:[],offscreen:!1,collisionDetected:Or}}}}return{circles:!St&&Or||!cr?[]:on,offscreen:kr,collisionDetected:Or}},bo.prototype.queryRenderedSymbols=function(_){if(_.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var E=[],b=1/0,A=1/0,B=-1/0,H=-1/0,Y=0,et=_;Y<et.length;Y+=1){var St=et[Y],Rt=new R.Point(St.x+100,St.y+100);b=Math.min(b,Rt.x),A=Math.min(A,Rt.y),B=Math.max(B,Rt.x),H=Math.max(H,Rt.y),E.push(Rt)}for(var ye={},be={},Oe=0,on=this.grid.query(b,A,B,H).concat(this.ignoredGrid.query(b,A,B,H));Oe<on.length;Oe+=1){var Qe=on[Oe],vn=Qe.key;if(ye[vn.bucketInstanceId]===void 0&&(ye[vn.bucketInstanceId]={}),!ye[vn.bucketInstanceId][vn.featureIndex]){var Ye=[new R.Point(Qe.x1,Qe.y1),new R.Point(Qe.x2,Qe.y1),new R.Point(Qe.x2,Qe.y2),new R.Point(Qe.x1,Qe.y2)];R.polygonIntersectsPolygon(E,Ye)&&(ye[vn.bucketInstanceId][vn.featureIndex]=!0,be[vn.bucketInstanceId]===void 0&&(be[vn.bucketInstanceId]=[]),be[vn.bucketInstanceId].push(vn.featureIndex))}}return be},bo.prototype.insertCollisionBox=function(_,E,b,A,B){(E?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:A,collisionGroupID:B},_[0],_[1],_[2],_[3])},bo.prototype.insertCollisionCircles=function(_,E,b,A,B){for(var H=E?this.ignoredGrid:this.grid,Y={bucketInstanceId:b,featureIndex:A,collisionGroupID:B},et=0;et<_.length;et+=4)H.insertCircle(Y,_[et],_[et+1],_[et+2])},bo.prototype.projectAndGetPerspectiveRatio=function(_,E,b){var A=[E,b,0,1];return Xr(A,A,_),{point:new R.Point((A[0]/A[3]+1)/2*this.transform.width+100,(-A[1]/A[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}},bo.prototype.isOffscreen=function(_,E,b,A){return b<100||_>=this.screenRightBoundary||A<100||E>this.screenBottomBoundary},bo.prototype.isInsideGrid=function(_,E,b,A){return b>=0&&_<this.gridRightBoundary&&A>=0&&E<this.gridBottomBoundary},bo.prototype.getViewportMatrix=function(){var _=R.identity([]);return R.translate(_,_,[-100,-100,0]),_};var Eo=function(_,E,b,A){this.opacity=_?Math.max(0,Math.min(1,_.opacity+(_.placed?E:-E))):A&&b?1:0,this.placed=b};Eo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Xi=function(_,E,b,A,B){this.text=new Eo(_?_.text:null,E,b,B),this.icon=new Eo(_?_.icon:null,E,A,B)};Xi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Mo=function(_,E,b){this.text=_,this.icon=E,this.skipFade=b},Xo=function(){this.invProjMatrix=R.create(),this.viewportMatrix=R.create(),this.circles=[]},wl=function(_,E,b,A,B){this.bucketInstanceId=_,this.featureIndex=E,this.sourceLayerIndex=b,this.bucketIndex=A,this.tileID=B},Ya=function(_){this.crossSourceCollisions=_,this.maxGroupID=0,this.collisionGroups={}};function ca(_,E,b,A,B){var H=R.getAnchorAlignment(_),Y=-(H.horizontalAlign-.5)*E,et=-(H.verticalAlign-.5)*b,St=R.evaluateVariableOffset(_,A);return new R.Point(Y+St[0]*B,et+St[1]*B)}function ws(_,E,b,A,B,H){var Y=_.x1,et=_.x2,St=_.y1,Rt=_.y2,ye=_.anchorPointX,be=_.anchorPointY,Oe=new R.Point(E,b);return A&&Oe._rotate(B?H:-H),{x1:Y+Oe.x,y1:St+Oe.y,x2:et+Oe.x,y2:Rt+Oe.y,anchorPointX:ye,anchorPointY:be}}Ya.prototype.get=function(_){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[_]){var E=++this.maxGroupID;this.collisionGroups[_]={ID:E,predicate:function(b){return b.collisionGroupID===E}}}return this.collisionGroups[_]};var Ms=function(_,E,b,A){this.transform=_.clone(),this.collisionIndex=new bo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=E,this.retainedQueryData={},this.collisionGroups=new Ya(b),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}};function re(_,E,b,A,B){_.emplaceBack(E?1:0,b?1:0,A||0,B||0),_.emplaceBack(E?1:0,b?1:0,A||0,B||0),_.emplaceBack(E?1:0,b?1:0,A||0,B||0),_.emplaceBack(E?1:0,b?1:0,A||0,B||0)}Ms.prototype.getBucketParts=function(_,E,b,A){var B=b.getBucket(E),H=b.latestFeatureIndex;if(B&&H&&E.id===B.layerIds[0]){var Y=b.collisionBoxArray,et=B.layers[0].layout,St=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),Rt=b.tileSize/R.EXTENT,ye=this.transform.calculatePosMatrix(b.tileID.toUnwrapped()),be=et.get("text-pitch-alignment")==="map",Oe=et.get("text-rotation-alignment")==="map",on=Ni(b,1,this.transform.zoom),Qe=qe(ye,be,Oe,this.transform,on),vn=null;if(be){var Ye=Rn(ye,be,Oe,this.transform,on);vn=R.multiply([],this.transform.labelPlaneMatrix,Ye)}this.retainedQueryData[B.bucketInstanceId]=new wl(B.bucketInstanceId,H,B.sourceLayerIndex,B.index,b.tileID);var On={bucket:B,layout:et,posMatrix:ye,textLabelPlaneMatrix:Qe,labelToScreenMatrix:vn,scale:St,textPixelRatio:Rt,holdingForFade:b.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:R.evaluateSizeForZoom(B.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(B.sourceID)};if(A)for(var jn=0,ar=B.sortKeyRanges;jn<ar.length;jn+=1){var Or=ar[jn];_.push({sortKey:Or.sortKey,symbolInstanceStart:Or.symbolInstanceStart,symbolInstanceEnd:Or.symbolInstanceEnd,parameters:On})}else _.push({symbolInstanceStart:0,symbolInstanceEnd:B.symbolInstances.length,parameters:On})}},Ms.prototype.attemptAnchorPlacement=function(_,E,b,A,B,H,Y,et,St,Rt,ye,be,Oe,on,Qe){var vn,Ye=[be.textOffset0,be.textOffset1],On=ca(_,b,A,Ye,B),jn=this.collisionIndex.placeCollisionBox(ws(E,On.x,On.y,H,Y,this.transform.angle),ye,et,St,Rt.predicate);if(!Qe||this.collisionIndex.placeCollisionBox(ws(Qe,On.x,On.y,H,Y,this.transform.angle),ye,et,St,Rt.predicate).box.length!==0)return jn.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[be.crossTileID]&&this.prevPlacement.placements[be.crossTileID]&&this.prevPlacement.placements[be.crossTileID].text&&(vn=this.prevPlacement.variableOffsets[be.crossTileID].anchor),this.variableOffsets[be.crossTileID]={textOffset:Ye,width:b,height:A,anchor:_,textBoxScale:B,prevAnchor:vn},this.markUsedJustification(Oe,_,be,on),Oe.allowVerticalPlacement&&(this.markUsedOrientation(Oe,on,be),this.placedOrientations[be.crossTileID]=on),{shift:On,placedGlyphBoxes:jn}):void 0},Ms.prototype.placeLayerBucketPart=function(_,E,b){var A=this,B=_.parameters,H=B.bucket,Y=B.layout,et=B.posMatrix,St=B.textLabelPlaneMatrix,Rt=B.labelToScreenMatrix,ye=B.textPixelRatio,be=B.holdingForFade,Oe=B.collisionBoxArray,on=B.partiallyEvaluatedTextSize,Qe=B.collisionGroup,vn=Y.get("text-optional"),Ye=Y.get("icon-optional"),On=Y.get("text-allow-overlap"),jn=Y.get("icon-allow-overlap"),ar=Y.get("text-rotation-alignment")==="map",Or=Y.get("text-pitch-alignment")==="map",cr=Y.get("icon-text-fit")!=="none",kr=Y.get("symbol-z-order")==="viewport-y",ei=On&&(jn||!H.hasIconData()||Ye),Yr=jn&&(On||!H.hasTextData()||vn);!H.collisionArrays&&Oe&&H.deserializeCollisionBoxes(Oe);var Ti=function(Tn,Me){if(!E[Tn.crossTileID])if(be)A.placements[Tn.crossTileID]=new Mo(!1,!1,!1);else{var la,ta=!1,Vo=!1,ga=!0,jo=null,Do={box:null,offscreen:null},hc={box:null,offscreen:null},ml=null,Bc=null,Wl=0,vs=0,Ks=0;Me.textFeatureIndex?Wl=Me.textFeatureIndex:Tn.useRuntimeCollisionCircles&&(Wl=Tn.featureIndex),Me.verticalTextFeatureIndex&&(vs=Me.verticalTextFeatureIndex);var sl=Me.textBox;if(sl){var vl=function(No){var Fl=R.WritingMode.horizontal;if(H.allowVerticalPlacement&&!No&&A.prevPlacement){var Xl=A.prevPlacement.placedOrientations[Tn.crossTileID];Xl&&(A.placedOrientations[Tn.crossTileID]=Xl,A.markUsedOrientation(H,Fl=Xl,Tn))}return Fl},_f=function(No,Fl){if(H.allowVerticalPlacement&&Tn.numVerticalGlyphVertices>0&&Me.verticalTextBox)for(var Xl=0,bf=H.writingModes;Xl<bf.length&&(bf[Xl]===R.WritingMode.vertical?(Do=Fl(),hc=Do):Do=No(),!(Do&&Do.box&&Do.box.length));Xl+=1);else Do=No()};if(Y.get("text-variable-anchor")){var ol=Y.get("text-variable-anchor");if(A.prevPlacement&&A.prevPlacement.variableOffsets[Tn.crossTileID]){var sf=A.prevPlacement.variableOffsets[Tn.crossTileID];ol.indexOf(sf.anchor)>0&&(ol=ol.filter(function(No){return No!==sf.anchor})).unshift(sf.anchor)}var Vu=function(No,Fl,Xl){for(var bf=No.x2-No.x1,Hd=No.y2-No.y1,lf=Tn.textBoxScale,Ep=cr&&!jn?Fl:null,Ad={box:[],offscreen:!1},Is=On?2*ol.length:ol.length,cf=0;cf<Is;++cf){var lh=A.attemptAnchorPlacement(ol[cf%ol.length],No,bf,Hd,lf,ar,Or,ye,et,Qe,cf>=ol.length,Tn,H,Xl,Ep);if(lh&&(Ad=lh.placedGlyphBoxes)&&Ad.box&&Ad.box.length){ta=!0,jo=lh.shift;break}}return Ad};_f(function(){return Vu(sl,Me.iconBox,R.WritingMode.horizontal)},function(){var No=Me.verticalTextBox;return H.allowVerticalPlacement&&!(Do&&Do.box&&Do.box.length)&&Tn.numVerticalGlyphVertices>0&&No?Vu(No,Me.verticalIconBox,R.WritingMode.vertical):{box:null,offscreen:null}}),Do&&(ta=Do.box,ga=Do.offscreen);var Vd=vl(Do&&Do.box);if(!ta&&A.prevPlacement){var Ff=A.prevPlacement.variableOffsets[Tn.crossTileID];Ff&&(A.variableOffsets[Tn.crossTileID]=Ff,A.markUsedJustification(H,Ff.anchor,Tn,Vd))}}else{var Sh=function(No,Fl){var Xl=A.collisionIndex.placeCollisionBox(No,On,ye,et,Qe.predicate);return Xl&&Xl.box&&Xl.box.length&&(A.markUsedOrientation(H,Fl,Tn),A.placedOrientations[Tn.crossTileID]=Fl),Xl};_f(function(){return Sh(sl,R.WritingMode.horizontal)},function(){var No=Me.verticalTextBox;return H.allowVerticalPlacement&&Tn.numVerticalGlyphVertices>0&&No?Sh(No,R.WritingMode.vertical):{box:null,offscreen:null}}),vl(Do&&Do.box&&Do.box.length)}}if(ta=(la=Do)&&la.box&&la.box.length>0,ga=la&&la.offscreen,Tn.useRuntimeCollisionCircles){var Zd=H.text.placedSymbolArray.get(Tn.centerJustifiedTextSymbolIndex),qh=R.evaluateSizeForFeature(H.textSizeData,on,Zd),xf=Y.get("text-padding");ml=A.collisionIndex.placeCollisionCircles(On,Zd,H.lineVertexArray,H.glyphOffsetArray,qh,et,St,Rt,b,Or,Qe.predicate,Tn.collisionCircleDiameter,xf),ta=On||ml.circles.length>0&&!ml.collisionDetected,ga=ga&&ml.offscreen}if(Me.iconFeatureIndex&&(Ks=Me.iconFeatureIndex),Me.iconBox){var wi=function(No){var Fl=cr&&jo?ws(No,jo.x,jo.y,ar,Or,A.transform.angle):No;return A.collisionIndex.placeCollisionBox(Fl,jn,ye,et,Qe.predicate)};Vo=hc&&hc.box&&hc.box.length&&Me.verticalIconBox?(Bc=wi(Me.verticalIconBox)).box.length>0:(Bc=wi(Me.iconBox)).box.length>0,ga=ga&&Bc.offscreen}var fl=vn||Tn.numHorizontalGlyphVertices===0&&Tn.numVerticalGlyphVertices===0,ya=Ye||Tn.numIconVertices===0;if(fl||ya?ya?fl||(Vo=Vo&&ta):ta=Vo&&ta:Vo=ta=Vo&&ta,ta&&la&&la.box&&A.collisionIndex.insertCollisionBox(la.box,Y.get("text-ignore-placement"),H.bucketInstanceId,hc&&hc.box&&vs?vs:Wl,Qe.ID),Vo&&Bc&&A.collisionIndex.insertCollisionBox(Bc.box,Y.get("icon-ignore-placement"),H.bucketInstanceId,Ks,Qe.ID),ml&&(ta&&A.collisionIndex.insertCollisionCircles(ml.circles,Y.get("text-ignore-placement"),H.bucketInstanceId,Wl,Qe.ID),b)){var gs=H.bucketInstanceId,Bl=A.collisionCircleArrays[gs];Bl===void 0&&(Bl=A.collisionCircleArrays[gs]=new Xo);for(var Zu=0;Zu<ml.circles.length;Zu+=4)Bl.circles.push(ml.circles[Zu+0]),Bl.circles.push(ml.circles[Zu+1]),Bl.circles.push(ml.circles[Zu+2]),Bl.circles.push(ml.collisionDetected?1:0)}A.placements[Tn.crossTileID]=new Mo(ta||ei,Vo||Yr,ga||H.justReloaded),E[Tn.crossTileID]=!0}};if(kr)for(var zi=H.getSortedSymbolIndexes(this.transform.angle),Io=zi.length-1;Io>=0;--Io){var Bo=zi[Io];Ti(H.symbolInstances.get(Bo),H.collisionArrays[Bo])}else for(var Fo=_.symbolInstanceStart;Fo<_.symbolInstanceEnd;Fo++)Ti(H.symbolInstances.get(Fo),H.collisionArrays[Fo]);if(b&&H.bucketInstanceId in this.collisionCircleArrays){var ua=this.collisionCircleArrays[H.bucketInstanceId];R.invert(ua.invProjMatrix,et),ua.viewportMatrix=this.collisionIndex.getViewportMatrix()}H.justReloaded=!1},Ms.prototype.markUsedJustification=function(_,E,b,A){var B;B=A===R.WritingMode.vertical?b.verticalPlacedTextSymbolIndex:{left:b.leftJustifiedTextSymbolIndex,center:b.centerJustifiedTextSymbolIndex,right:b.rightJustifiedTextSymbolIndex}[R.getAnchorJustification(E)];for(var H=0,Y=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex,b.verticalPlacedTextSymbolIndex];H<Y.length;H+=1){var et=Y[H];et>=0&&(_.text.placedSymbolArray.get(et).crossTileID=B>=0&&et!==B?0:b.crossTileID)}},Ms.prototype.markUsedOrientation=function(_,E,b){for(var A=E===R.WritingMode.horizontal||E===R.WritingMode.horizontalOnly?E:0,B=E===R.WritingMode.vertical?E:0,H=0,Y=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex];H<Y.length;H+=1)_.text.placedSymbolArray.get(Y[H]).placedOrientation=A;b.verticalPlacedTextSymbolIndex&&(_.text.placedSymbolArray.get(b.verticalPlacedTextSymbolIndex).placedOrientation=B)},Ms.prototype.commit=function(_){this.commitTime=_,this.zoomAtLastRecencyCheck=this.transform.zoom;var E=this.prevPlacement,b=!1;this.prevZoomAdjustment=E?E.zoomAdjustment(this.transform.zoom):0;var A=E?E.symbolFadeChange(_):1,B=E?E.opacities:{},H=E?E.variableOffsets:{},Y=E?E.placedOrientations:{};for(var et in this.placements){var St=this.placements[et],Rt=B[et];Rt?(this.opacities[et]=new Xi(Rt,A,St.text,St.icon),b=b||St.text!==Rt.text.placed||St.icon!==Rt.icon.placed):(this.opacities[et]=new Xi(null,A,St.text,St.icon,St.skipFade),b=b||St.text||St.icon)}for(var ye in B){var be=B[ye];if(!this.opacities[ye]){var Oe=new Xi(be,A,!1,!1);Oe.isHidden()||(this.opacities[ye]=Oe,b=b||be.text.placed||be.icon.placed)}}for(var on in H)this.variableOffsets[on]||!this.opacities[on]||this.opacities[on].isHidden()||(this.variableOffsets[on]=H[on]);for(var Qe in Y)this.placedOrientations[Qe]||!this.opacities[Qe]||this.opacities[Qe].isHidden()||(this.placedOrientations[Qe]=Y[Qe]);b?this.lastPlacementChangeTime=_:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=E?E.lastPlacementChangeTime:_)},Ms.prototype.updateLayerOpacities=function(_,E){for(var b={},A=0,B=E;A<B.length;A+=1){var H=B[A],Y=H.getBucket(_);Y&&H.latestFeatureIndex&&_.id===Y.layerIds[0]&&this.updateBucketOpacities(Y,b,H.collisionBoxArray)}},Ms.prototype.updateBucketOpacities=function(_,E,b){var A=this;_.hasTextData()&&_.text.opacityVertexArray.clear(),_.hasIconData()&&_.icon.opacityVertexArray.clear(),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexArray.clear(),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexArray.clear();var B=_.layers[0].layout,H=new Xi(null,0,!1,!1,!0),Y=B.get("text-allow-overlap"),et=B.get("icon-allow-overlap"),St=B.get("text-variable-anchor"),Rt=B.get("text-rotation-alignment")==="map",ye=B.get("text-pitch-alignment")==="map",be=B.get("icon-text-fit")!=="none",Oe=new Xi(null,0,Y&&(et||!_.hasIconData()||B.get("icon-optional")),et&&(Y||!_.hasTextData()||B.get("text-optional")),!0);!_.collisionArrays&&b&&(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData())&&_.deserializeCollisionBoxes(b);for(var on=function(On,jn,ar){for(var Or=0;Or<jn/4;Or++)On.opacityVertexArray.emplaceBack(ar)},Qe=function(On){var jn=_.symbolInstances.get(On),ar=jn.numHorizontalGlyphVertices,Or=jn.numVerticalGlyphVertices,cr=jn.crossTileID,kr=A.opacities[cr];E[cr]?kr=H:kr||(A.opacities[cr]=kr=Oe),E[cr]=!0;var ei=jn.numIconVertices>0,Yr=A.placedOrientations[jn.crossTileID],Ti=Yr===R.WritingMode.vertical,zi=Yr===R.WritingMode.horizontal||Yr===R.WritingMode.horizontalOnly;if(ar>0||Or>0){var Io=Ns(kr.text);on(_.text,ar,Ti?As:Io),on(_.text,Or,zi?As:Io);var Bo=kr.text.isHidden();[jn.rightJustifiedTextSymbolIndex,jn.centerJustifiedTextSymbolIndex,jn.leftJustifiedTextSymbolIndex].forEach(function(Do){Do>=0&&(_.text.placedSymbolArray.get(Do).hidden=Bo||Ti?1:0)}),jn.verticalPlacedTextSymbolIndex>=0&&(_.text.placedSymbolArray.get(jn.verticalPlacedTextSymbolIndex).hidden=Bo||zi?1:0);var Fo=A.variableOffsets[jn.crossTileID];Fo&&A.markUsedJustification(_,Fo.anchor,jn,Yr);var ua=A.placedOrientations[jn.crossTileID];ua&&(A.markUsedJustification(_,"left",jn,ua),A.markUsedOrientation(_,ua,jn))}if(ei){var Tn=Ns(kr.icon),Me=!(be&&jn.verticalPlacedIconSymbolIndex&&Ti);jn.placedIconSymbolIndex>=0&&(on(_.icon,jn.numIconVertices,Me?Tn:As),_.icon.placedSymbolArray.get(jn.placedIconSymbolIndex).hidden=kr.icon.isHidden()),jn.verticalPlacedIconSymbolIndex>=0&&(on(_.icon,jn.numVerticalIconVertices,Me?As:Tn),_.icon.placedSymbolArray.get(jn.verticalPlacedIconSymbolIndex).hidden=kr.icon.isHidden())}if(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData()){var la=_.collisionArrays[On];if(la){var ta=new R.Point(0,0);if(la.textBox||la.verticalTextBox){var Vo=!0;if(St){var ga=A.variableOffsets[cr];ga?(ta=ca(ga.anchor,ga.width,ga.height,ga.textOffset,ga.textBoxScale),Rt&&ta._rotate(ye?A.transform.angle:-A.transform.angle)):Vo=!1}la.textBox&&re(_.textCollisionBox.collisionVertexArray,kr.text.placed,!Vo||Ti,ta.x,ta.y),la.verticalTextBox&&re(_.textCollisionBox.collisionVertexArray,kr.text.placed,!Vo||zi,ta.x,ta.y)}var jo=!!(!zi&&la.verticalIconBox);la.iconBox&&re(_.iconCollisionBox.collisionVertexArray,kr.icon.placed,jo,be?ta.x:0,be?ta.y:0),la.verticalIconBox&&re(_.iconCollisionBox.collisionVertexArray,kr.icon.placed,!jo,be?ta.x:0,be?ta.y:0)}}},vn=0;vn<_.symbolInstances.length;vn++)Qe(vn);if(_.sortFeatures(this.transform.angle),this.retainedQueryData[_.bucketInstanceId]&&(this.retainedQueryData[_.bucketInstanceId].featureSortOrder=_.featureSortOrder),_.hasTextData()&&_.text.opacityVertexBuffer&&_.text.opacityVertexBuffer.updateData(_.text.opacityVertexArray),_.hasIconData()&&_.icon.opacityVertexBuffer&&_.icon.opacityVertexBuffer.updateData(_.icon.opacityVertexArray),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexBuffer&&_.iconCollisionBox.collisionVertexBuffer.updateData(_.iconCollisionBox.collisionVertexArray),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexBuffer&&_.textCollisionBox.collisionVertexBuffer.updateData(_.textCollisionBox.collisionVertexArray),_.bucketInstanceId in this.collisionCircleArrays){var Ye=this.collisionCircleArrays[_.bucketInstanceId];_.placementInvProjMatrix=Ye.invProjMatrix,_.placementViewportMatrix=Ye.viewportMatrix,_.collisionCircleArray=Ye.circles,delete this.collisionCircleArrays[_.bucketInstanceId]}},Ms.prototype.symbolFadeChange=function(_){return this.fadeDuration===0?1:(_-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ms.prototype.zoomAdjustment=function(_){return Math.max(0,(this.transform.zoom-_)/1.5)},Ms.prototype.hasTransitions=function(_){return this.stale||_-this.lastPlacementChangeTime<this.fadeDuration},Ms.prototype.stillRecent=function(_,E){var b=this.zoomAtLastRecencyCheck===E?1-this.zoomAdjustment(E):1;return this.zoomAtLastRecencyCheck=E,this.commitTime+this.fadeDuration*b>_},Ms.prototype.setStale=function(){this.stale=!0};var ge=Math.pow(2,25),An=Math.pow(2,24),tr=Math.pow(2,17),Ei=Math.pow(2,16),Si=Math.pow(2,9),uo=Math.pow(2,8),Es=Math.pow(2,1);function Ns(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;var E=_.placed?1:0,b=Math.floor(127*_.opacity);return b*ge+E*An+b*tr+E*Ei+b*Si+E*uo+b*Es+E}var As=0,rl=function(_){this._sortAcrossTiles=_.layout.get("symbol-z-order")!=="viewport-y"&&_.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};rl.prototype.continuePlacement=function(_,E,b,A,B){for(var H=this._bucketParts;this._currentTileIndex<_.length;)if(E.getBucketParts(H,A,_[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,B())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,H.sort(function(Y,et){return Y.sortKey-et.sortKey}));this._currentPartIndex<H.length;)if(E.placeLayerBucketPart(H[this._currentPartIndex],this._seenCrossTileIDs,b),this._currentPartIndex++,B())return!0;return!1};var Xf=function(_,E,b,A,B,H,Y){this.placement=new Ms(_,B,H,Y),this._currentPlacementIndex=E.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=A,this._done=!1};Xf.prototype.isDone=function(){return this._done},Xf.prototype.continuePlacement=function(_,E,b){for(var A=this,B=R.browser.now(),H=function(){var St=R.browser.now()-B;return!A._forceFullPlacement&&St>2};this._currentPlacementIndex>=0;){var Y=E[_[this._currentPlacementIndex]],et=this.placement.collisionIndex.transform.zoom;if(Y.type==="symbol"&&(!Y.minzoom||Y.minzoom<=et)&&(!Y.maxzoom||Y.maxzoom>et)){if(this._inProgressLayer||(this._inProgressLayer=new rl(Y)),this._inProgressLayer.continuePlacement(b[Y.source],this.placement,this._showCollisionBoxes,Y,H))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Xf.prototype.commit=function(_){return this.placement.commit(_),this.placement};var Ud=512/R.EXTENT/2,md=function(_,E,b){this.tileID=_,this.indexedSymbolInstances={},this.bucketInstanceId=b;for(var A=0;A<E.length;A++){var B=E.get(A),H=B.key;this.indexedSymbolInstances[H]||(this.indexedSymbolInstances[H]=[]),this.indexedSymbolInstances[H].push({crossTileID:B.crossTileID,coord:this.getScaledCoordinates(B,_)})}};md.prototype.getScaledCoordinates=function(_,E){var b=Ud/Math.pow(2,E.canonical.z-this.tileID.canonical.z);return{x:Math.floor((E.canonical.x*R.EXTENT+_.anchorX)*b),y:Math.floor((E.canonical.y*R.EXTENT+_.anchorY)*b)}},md.prototype.findMatches=function(_,E,b){for(var A=this.tileID.canonical.z<E.canonical.z?1:Math.pow(2,this.tileID.canonical.z-E.canonical.z),B=0;B<_.length;B++){var H=_.get(B);if(!H.crossTileID){var Y=this.indexedSymbolInstances[H.key];if(Y)for(var et=this.getScaledCoordinates(H,E),St=0,Rt=Y;St<Rt.length;St+=1){var ye=Rt[St];if(Math.abs(ye.coord.x-et.x)<=A&&Math.abs(ye.coord.y-et.y)<=A&&!b[ye.crossTileID]){b[ye.crossTileID]=!0,H.crossTileID=ye.crossTileID;break}}}}};var Dl=function(){this.maxCrossTileID=0};Dl.prototype.generate=function(){return++this.maxCrossTileID};var Qc=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qc.prototype.handleWrapJump=function(_){var E=Math.round((_-this.lng)/360);if(E!==0)for(var b in this.indexes){var A=this.indexes[b],B={};for(var H in A){var Y=A[H];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+E),B[Y.tileID.key]=Y}this.indexes[b]=B}this.lng=_},Qc.prototype.addBucket=function(_,E,b){if(this.indexes[_.overscaledZ]&&this.indexes[_.overscaledZ][_.key]){if(this.indexes[_.overscaledZ][_.key].bucketInstanceId===E.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(_.overscaledZ,this.indexes[_.overscaledZ][_.key])}for(var A=0;A<E.symbolInstances.length;A++)E.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[_.overscaledZ]||(this.usedCrossTileIDs[_.overscaledZ]={});var B=this.usedCrossTileIDs[_.overscaledZ];for(var H in this.indexes){var Y=this.indexes[H];if(Number(H)>_.overscaledZ)for(var et in Y){var St=Y[et];St.tileID.isChildOf(_)&&St.findMatches(E.symbolInstances,_,B)}else{var Rt=Y[_.scaledTo(Number(H)).key];Rt&&Rt.findMatches(E.symbolInstances,_,B)}}for(var ye=0;ye<E.symbolInstances.length;ye++){var be=E.symbolInstances.get(ye);be.crossTileID||(be.crossTileID=b.generate(),B[be.crossTileID]=!0)}return this.indexes[_.overscaledZ]===void 0&&(this.indexes[_.overscaledZ]={}),this.indexes[_.overscaledZ][_.key]=new md(_,E.symbolInstances,E.bucketInstanceId),!0},Qc.prototype.removeBucketCrossTileIDs=function(_,E){for(var b in E.indexedSymbolInstances)for(var A=0,B=E.indexedSymbolInstances[b];A<B.length;A+=1)delete this.usedCrossTileIDs[_][B[A].crossTileID]},Qc.prototype.removeStaleBuckets=function(_){var E=!1;for(var b in this.indexes){var A=this.indexes[b];for(var B in A)_[A[B].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,A[B]),delete A[B],E=!0)}return E};var Mf=function(){this.layerIndexes={},this.crossTileIDs=new Dl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Mf.prototype.addLayer=function(_,E,b){var A=this.layerIndexes[_.id];A===void 0&&(A=this.layerIndexes[_.id]=new Qc);var B=!1,H={};A.handleWrapJump(b);for(var Y=0,et=E;Y<et.length;Y+=1){var St=et[Y],Rt=St.getBucket(_);Rt&&_.id===Rt.layerIds[0]&&(Rt.bucketInstanceId||(Rt.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(St.tileID,Rt,this.crossTileIDs)&&(B=!0),H[Rt.bucketInstanceId]=!0)}return A.removeStaleBuckets(H)&&(B=!0),B},Mf.prototype.pruneUnusedLayers=function(_){var E={};for(var b in _.forEach(function(A){E[A]=!0}),this.layerIndexes)E[b]||delete this.layerIndexes[b]};var Jc=function(_,E){return R.emitValidationErrors(_,E&&E.filter(function(b){return b.identifier!=="source.canvas"}))},Ic=R.pick(xi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),tu=R.pick(xi,["setCenter","setZoom","setBearing","setPitch"]),Yf=function(){var _={},E=R.styleSpec.$version;for(var b in R.styleSpec.$root){var A,B=R.styleSpec.$root[b];B.required&&(A=b==="version"?E:B.type==="array"?[]:{})!=null&&(_[b]=A)}return _}(),ac=function(_){function E(b,A){var B=this;A===void 0&&(A={}),_.call(this),this.map=b,this.dispatcher=new Je(Ar(),this),this.imageManager=new ce,this.imageManager.setEventedParent(this),this.glyphManager=new or(b._requestManager,A.localIdeographFontFamily),this.lineAtlas=new ke(256,512),this.crossTileSymbolIndex=new Mf,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new R.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",R.getReferrer());var H=this;this._rtlTextPluginCallback=E.registerForPluginStateChange(function(Y){H.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Y.pluginStatus,pluginURL:Y.pluginURL},function(et,St){if(R.triggerPluginCompletionEvent(et),St&&St.every(function(ye){return ye}))for(var Rt in H.sourceCaches)H.sourceCaches[Rt].reload()})}),this.on("data",function(Y){if(Y.dataType==="source"&&Y.sourceDataType==="metadata"){var et=B.sourceCaches[Y.sourceId];if(et){var St=et.getSource();if(St&&St.vectorLayerIds)for(var Rt in B._layers){var ye=B._layers[Rt];ye.source===St.id&&B._validateLayer(ye)}}}})}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.loadURL=function(b,A){var B=this;A===void 0&&(A={}),this.fire(new R.Event("dataloading",{dataType:"style"}));var H=typeof A.validate=="boolean"?A.validate:!R.isMapboxURL(b);b=this.map._requestManager.normalizeStyleURL(b,A.accessToken);var Y=this.map._requestManager.transformRequest(b,R.ResourceType.Style);this._request=R.getJSON(Y,function(et,St){B._request=null,et?B.fire(new R.ErrorEvent(et)):St&&B._load(St,H)})},E.prototype.loadJSON=function(b,A){var B=this;A===void 0&&(A={}),this.fire(new R.Event("dataloading",{dataType:"style"})),this._request=R.browser.frame(function(){B._request=null,B._load(b,A.validate!==!1)})},E.prototype.loadEmpty=function(){this.fire(new R.Event("dataloading",{dataType:"style"})),this._load(Yf,!1)},E.prototype._load=function(b,A){if(!A||!Jc(this,R.validateStyle(b))){for(var B in this._loaded=!0,this.stylesheet=b,b.sources)this.addSource(B,b.sources[B],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs);var H=mi(this.stylesheet.layers);this._order=H.map(function(Rt){return Rt.id}),this._layers={},this._serializedLayers={};for(var Y=0,et=H;Y<et.length;Y+=1){var St=et[Y];(St=R.createStyleLayer(St)).setEventedParent(this,{layer:{id:St.id}}),this._layers[St.id]=St,this._serializedLayers[St.id]=St.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new nn(this.stylesheet.light),this.fire(new R.Event("data",{dataType:"style"})),this.fire(new R.Event("style.load"))}},E.prototype._loadSprite=function(b){var A=this;this._spriteRequest=function(B,H,Y){var et,St,Rt,ye=R.browser.devicePixelRatio>1?"@2x":"",be=R.getJSON(H.transformRequest(H.normalizeSpriteURL(B,ye,".json"),R.ResourceType.SpriteJSON),function(Qe,vn){be=null,Rt||(Rt=Qe,et=vn,on())}),Oe=R.getImage(H.transformRequest(H.normalizeSpriteURL(B,ye,".png"),R.ResourceType.SpriteImage),function(Qe,vn){Oe=null,Rt||(Rt=Qe,St=vn,on())});function on(){if(Rt)Y(Rt);else if(et&&St){var Qe=R.browser.getImageData(St),vn={};for(var Ye in et){var On=et[Ye],jn=On.width,ar=On.height,Or=On.x,cr=On.y,kr=On.sdf,ei=On.pixelRatio,Yr=On.stretchX,Ti=On.stretchY,zi=On.content,Io=new R.RGBAImage({width:jn,height:ar});R.RGBAImage.copy(Qe,Io,{x:Or,y:cr},{x:0,y:0},{width:jn,height:ar}),vn[Ye]={data:Io,pixelRatio:ei,sdf:kr,stretchX:Yr,stretchY:Ti,content:zi}}Y(null,vn)}}return{cancel:function(){be&&(be.cancel(),be=null),Oe&&(Oe.cancel(),Oe=null)}}}(b,this.map._requestManager,function(B,H){if(A._spriteRequest=null,B)A.fire(new R.ErrorEvent(B));else if(H)for(var Y in H)A.imageManager.addImage(Y,H[Y]);A.imageManager.setLoaded(!0),A._availableImages=A.imageManager.listImages(),A.dispatcher.broadcast("setImages",A._availableImages),A.fire(new R.Event("data",{dataType:"style"}))})},E.prototype._validateLayer=function(b){var A=this.sourceCaches[b.source];if(A){var B=b.sourceLayer;if(B){var H=A.getSource();(H.type==="geojson"||H.vectorLayerIds&&H.vectorLayerIds.indexOf(B)===-1)&&this.fire(new R.ErrorEvent(new Error('Source layer "'+B+'" does not exist on source "'+H.id+'" as specified by style layer "'+b.id+'"')))}}},E.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var b in this.sourceCaches)if(!this.sourceCaches[b].loaded())return!1;return!!this.imageManager.isLoaded()},E.prototype._serializeLayers=function(b){for(var A=[],B=0,H=b;B<H.length;B+=1){var Y=this._layers[H[B]];Y.type!=="custom"&&A.push(Y.serialize())}return A},E.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var b in this.sourceCaches)if(this.sourceCaches[b].hasTransition())return!0;for(var A in this._layers)if(this._layers[A].hasTransition())return!0;return!1},E.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},E.prototype.update=function(b){if(this._loaded){var A=this._changed;if(this._changed){var B=Object.keys(this._updatedLayers),H=Object.keys(this._removedLayers);for(var Y in(B.length||H.length)&&this._updateWorkerLayers(B,H),this._updatedSources){var et=this._updatedSources[Y];et==="reload"?this._reloadSource(Y):et==="clear"&&this._clearSource(Y)}for(var St in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[St].updateTransitions(b);this.light.updateTransitions(b),this._resetUpdates()}var Rt={};for(var ye in this.sourceCaches){var be=this.sourceCaches[ye];Rt[ye]=be.used,be.used=!1}for(var Oe=0,on=this._order;Oe<on.length;Oe+=1){var Qe=this._layers[on[Oe]];Qe.recalculate(b,this._availableImages),!Qe.isHidden(b.zoom)&&Qe.source&&(this.sourceCaches[Qe.source].used=!0)}for(var vn in Rt){var Ye=this.sourceCaches[vn];Rt[vn]!==Ye.used&&Ye.fire(new R.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:vn}))}this.light.recalculate(b),this.z=b.zoom,A&&this.fire(new R.Event("data",{dataType:"style"}))}},E.prototype._updateTilesForChangedImages=function(){var b=Object.keys(this._changedImages);if(b.length){for(var A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["icons","patterns"],b);this._changedImages={}}},E.prototype._updateWorkerLayers=function(b,A){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(b),removedIds:A})},E.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},E.prototype.setState=function(b){var A=this;if(this._checkLoaded(),Jc(this,R.validateStyle(b)))return!1;(b=R.clone$1(b)).layers=mi(b.layers);var B=function(Y,et){if(!Y)return[{command:xi.setStyle,args:[et]}];var St=[];try{if(!R.deepEqual(Y.version,et.version))return[{command:xi.setStyle,args:[et]}];R.deepEqual(Y.center,et.center)||St.push({command:xi.setCenter,args:[et.center]}),R.deepEqual(Y.zoom,et.zoom)||St.push({command:xi.setZoom,args:[et.zoom]}),R.deepEqual(Y.bearing,et.bearing)||St.push({command:xi.setBearing,args:[et.bearing]}),R.deepEqual(Y.pitch,et.pitch)||St.push({command:xi.setPitch,args:[et.pitch]}),R.deepEqual(Y.sprite,et.sprite)||St.push({command:xi.setSprite,args:[et.sprite]}),R.deepEqual(Y.glyphs,et.glyphs)||St.push({command:xi.setGlyphs,args:[et.glyphs]}),R.deepEqual(Y.transition,et.transition)||St.push({command:xi.setTransition,args:[et.transition]}),R.deepEqual(Y.light,et.light)||St.push({command:xi.setLight,args:[et.light]});var Rt={},ye=[];(function(Oe,on,Qe,vn){var Ye;for(Ye in on=on||{},Oe=Oe||{})Oe.hasOwnProperty(Ye)&&(on.hasOwnProperty(Ye)||Li(Ye,Qe,vn));for(Ye in on)on.hasOwnProperty(Ye)&&(Oe.hasOwnProperty(Ye)?R.deepEqual(Oe[Ye],on[Ye])||(Oe[Ye].type==="geojson"&&on[Ye].type==="geojson"&&Pa(Oe,on,Ye)?Qe.push({command:xi.setGeoJSONSourceData,args:[Ye,on[Ye].data]}):aa(Ye,on,Qe,vn)):wo(Ye,on,Qe))})(Y.sources,et.sources,ye,Rt);var be=[];Y.layers&&Y.layers.forEach(function(Oe){Rt[Oe.source]?St.push({command:xi.removeLayer,args:[Oe.id]}):be.push(Oe)}),St=St.concat(ye),function(Oe,on,Qe){on=on||[];var vn,Ye,On,jn,ar,Or,cr,kr=(Oe=Oe||[]).map($o),ei=on.map($o),Yr=Oe.reduce(Mt,{}),Ti=on.reduce(Mt,{}),zi=kr.slice(),Io=Object.create(null);for(vn=0,Ye=0;vn<kr.length;vn++)Ti.hasOwnProperty(On=kr[vn])?Ye++:(Qe.push({command:xi.removeLayer,args:[On]}),zi.splice(zi.indexOf(On,Ye),1));for(vn=0,Ye=0;vn<ei.length;vn++)zi[zi.length-1-vn]!==(On=ei[ei.length-1-vn])&&(Yr.hasOwnProperty(On)?(Qe.push({command:xi.removeLayer,args:[On]}),zi.splice(zi.lastIndexOf(On,zi.length-Ye),1)):Ye++,Qe.push({command:xi.addLayer,args:[Ti[On],Or=zi[zi.length-vn]]}),zi.splice(zi.length-vn,0,On),Io[On]=!0);for(vn=0;vn<ei.length;vn++)if(jn=Yr[On=ei[vn]],ar=Ti[On],!Io[On]&&!R.deepEqual(jn,ar))if(R.deepEqual(jn.source,ar.source)&&R.deepEqual(jn["source-layer"],ar["source-layer"])&&R.deepEqual(jn.type,ar.type)){for(cr in Lo(jn.layout,ar.layout,Qe,On,null,xi.setLayoutProperty),Lo(jn.paint,ar.paint,Qe,On,null,xi.setPaintProperty),R.deepEqual(jn.filter,ar.filter)||Qe.push({command:xi.setFilter,args:[On,ar.filter]}),R.deepEqual(jn.minzoom,ar.minzoom)&&R.deepEqual(jn.maxzoom,ar.maxzoom)||Qe.push({command:xi.setLayerZoomRange,args:[On,ar.minzoom,ar.maxzoom]}),jn)jn.hasOwnProperty(cr)&&cr!=="layout"&&cr!=="paint"&&cr!=="filter"&&cr!=="metadata"&&cr!=="minzoom"&&cr!=="maxzoom"&&(cr.indexOf("paint.")===0?Lo(jn[cr],ar[cr],Qe,On,cr.slice(6),xi.setPaintProperty):R.deepEqual(jn[cr],ar[cr])||Qe.push({command:xi.setLayerProperty,args:[On,cr,ar[cr]]}));for(cr in ar)ar.hasOwnProperty(cr)&&!jn.hasOwnProperty(cr)&&cr!=="layout"&&cr!=="paint"&&cr!=="filter"&&cr!=="metadata"&&cr!=="minzoom"&&cr!=="maxzoom"&&(cr.indexOf("paint.")===0?Lo(jn[cr],ar[cr],Qe,On,cr.slice(6),xi.setPaintProperty):R.deepEqual(jn[cr],ar[cr])||Qe.push({command:xi.setLayerProperty,args:[On,cr,ar[cr]]}))}else Qe.push({command:xi.removeLayer,args:[On]}),Or=zi[zi.lastIndexOf(On)+1],Qe.push({command:xi.addLayer,args:[ar,Or]})}(be,et.layers,St)}catch(Oe){console.warn("Unable to compute style diff:",Oe),St=[{command:xi.setStyle,args:[et]}]}return St}(this.serialize(),b).filter(function(Y){return!(Y.command in tu)});if(B.length===0)return!1;var H=B.filter(function(Y){return!(Y.command in Ic)});if(H.length>0)throw new Error("Unimplemented: "+H.map(function(Y){return Y.command}).join(", ")+".");return B.forEach(function(Y){Y.command!=="setTransition"&&A[Y.command].apply(A,Y.args)}),this.stylesheet=b,!0},E.prototype.addImage=function(b,A){if(this.getImage(b))return this.fire(new R.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(b,A),this._afterImageUpdated(b)},E.prototype.updateImage=function(b,A){this.imageManager.updateImage(b,A)},E.prototype.getImage=function(b){return this.imageManager.getImage(b)},E.prototype.removeImage=function(b){if(!this.getImage(b))return this.fire(new R.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(b),this._afterImageUpdated(b)},E.prototype._afterImageUpdated=function(b){this._availableImages=this.imageManager.listImages(),this._changedImages[b]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new R.Event("data",{dataType:"style"}))},E.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},E.prototype.addSource=function(b,A,B){var H=this;if(B===void 0&&(B={}),this._checkLoaded(),this.sourceCaches[b]!==void 0)throw new Error("There is already a source with this ID");if(!A.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(A).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(A.type)>=0&&this._validate(R.validateStyle.source,"sources."+b,A,null,B))){this.map&&this.map._collectResourceTiming&&(A.collectResourceTiming=!0);var Y=this.sourceCaches[b]=new Fe(b,A,this.dispatcher);Y.style=this,Y.setEventedParent(this,function(){return{isSourceLoaded:H.loaded(),source:Y.serialize(),sourceId:b}}),Y.onAdd(this.map),this._changed=!0}},E.prototype.removeSource=function(b){if(this._checkLoaded(),this.sourceCaches[b]===void 0)throw new Error("There is no source with this ID");for(var A in this._layers)if(this._layers[A].source===b)return this.fire(new R.ErrorEvent(new Error('Source "'+b+'" cannot be removed while layer "'+A+'" is using it.')));var B=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],B.fire(new R.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),B.setEventedParent(null),B.clearTiles(),B.onRemove&&B.onRemove(this.map),this._changed=!0},E.prototype.setGeoJSONSourceData=function(b,A){this._checkLoaded(),this.sourceCaches[b].getSource().setData(A),this._changed=!0},E.prototype.getSource=function(b){return this.sourceCaches[b]&&this.sourceCaches[b].getSource()},E.prototype.addLayer=function(b,A,B){B===void 0&&(B={}),this._checkLoaded();var H=b.id;if(this.getLayer(H))this.fire(new R.ErrorEvent(new Error('Layer with id "'+H+'" already exists on this map')));else{var Y;if(b.type==="custom"){if(Jc(this,R.validateCustomStyleLayer(b)))return;Y=R.createStyleLayer(b)}else{if(typeof b.source=="object"&&(this.addSource(H,b.source),b=R.clone$1(b),b=R.extend(b,{source:H})),this._validate(R.validateStyle.layer,"layers."+H,b,{arrayIndex:-1},B))return;Y=R.createStyleLayer(b),this._validateLayer(Y),Y.setEventedParent(this,{layer:{id:H}}),this._serializedLayers[Y.id]=Y.serialize()}var et=A?this._order.indexOf(A):this._order.length;if(A&&et===-1)this.fire(new R.ErrorEvent(new Error('Layer with id "'+A+'" does not exist on this map.')));else{if(this._order.splice(et,0,H),this._layerOrderChanged=!0,this._layers[H]=Y,this._removedLayers[H]&&Y.source&&Y.type!=="custom"){var St=this._removedLayers[H];delete this._removedLayers[H],St.type!==Y.type?this._updatedSources[Y.source]="clear":(this._updatedSources[Y.source]="reload",this.sourceCaches[Y.source].pause())}this._updateLayer(Y),Y.onAdd&&Y.onAdd(this.map)}}},E.prototype.moveLayer=function(b,A){if(this._checkLoaded(),this._changed=!0,this._layers[b]){if(b!==A){var B=this._order.indexOf(b);this._order.splice(B,1);var H=A?this._order.indexOf(A):this._order.length;A&&H===-1?this.fire(new R.ErrorEvent(new Error('Layer with id "'+A+'" does not exist on this map.'))):(this._order.splice(H,0,b),this._layerOrderChanged=!0)}}else this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be moved.")))},E.prototype.removeLayer=function(b){this._checkLoaded();var A=this._layers[b];if(A){A.setEventedParent(null);var B=this._order.indexOf(b);this._order.splice(B,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=A,delete this._layers[b],delete this._serializedLayers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],A.onRemove&&A.onRemove(this.map)}else this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be removed.")))},E.prototype.getLayer=function(b){return this._layers[b]},E.prototype.hasLayer=function(b){return b in this._layers},E.prototype.setLayerZoomRange=function(b,A,B){this._checkLoaded();var H=this.getLayer(b);H?H.minzoom===A&&H.maxzoom===B||(A!=null&&(H.minzoom=A),B!=null&&(H.maxzoom=B),this._updateLayer(H)):this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot have zoom extent.")))},E.prototype.setFilter=function(b,A,B){B===void 0&&(B={}),this._checkLoaded();var H=this.getLayer(b);if(H){if(!R.deepEqual(H.filter,A))return A==null?(H.filter=void 0,void this._updateLayer(H)):void(this._validate(R.validateStyle.filter,"layers."+H.id+".filter",A,null,B)||(H.filter=R.clone$1(A),this._updateLayer(H)))}else this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be filtered.")))},E.prototype.getFilter=function(b){return R.clone$1(this.getLayer(b).filter)},E.prototype.setLayoutProperty=function(b,A,B,H){H===void 0&&(H={}),this._checkLoaded();var Y=this.getLayer(b);Y?R.deepEqual(Y.getLayoutProperty(A),B)||(Y.setLayoutProperty(A,B,H),this._updateLayer(Y)):this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},E.prototype.getLayoutProperty=function(b,A){var B=this.getLayer(b);if(B)return B.getLayoutProperty(A);this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style.")))},E.prototype.setPaintProperty=function(b,A,B,H){H===void 0&&(H={}),this._checkLoaded();var Y=this.getLayer(b);Y?R.deepEqual(Y.getPaintProperty(A),B)||(Y.setPaintProperty(A,B,H)&&this._updateLayer(Y),this._changed=!0,this._updatedPaintProps[b]=!0):this.fire(new R.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},E.prototype.getPaintProperty=function(b,A){return this.getLayer(b).getPaintProperty(A)},E.prototype.setFeatureState=function(b,A){this._checkLoaded();var B=b.source,H=b.sourceLayer,Y=this.sourceCaches[B];if(Y!==void 0){var et=Y.getSource().type;et==="geojson"&&H?this.fire(new R.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):et!=="vector"||H?(b.id===void 0&&this.fire(new R.ErrorEvent(new Error("The feature id parameter must be provided."))),Y.setFeatureState(H,b.id,A)):this.fire(new R.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new R.ErrorEvent(new Error("The source '"+B+"' does not exist in the map's style.")))},E.prototype.removeFeatureState=function(b,A){this._checkLoaded();var B=b.source,H=this.sourceCaches[B];if(H!==void 0){var Y=H.getSource().type,et=Y==="vector"?b.sourceLayer:void 0;Y!=="vector"||et?A&&typeof b.id!="string"&&typeof b.id!="number"?this.fire(new R.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):H.removeFeatureState(et,b.id,A):this.fire(new R.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new R.ErrorEvent(new Error("The source '"+B+"' does not exist in the map's style.")))},E.prototype.getFeatureState=function(b){this._checkLoaded();var A=b.source,B=b.sourceLayer,H=this.sourceCaches[A];if(H!==void 0){if(H.getSource().type!=="vector"||B)return b.id===void 0&&this.fire(new R.ErrorEvent(new Error("The feature id parameter must be provided."))),H.getFeatureState(B,b.id);this.fire(new R.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new R.ErrorEvent(new Error("The source '"+A+"' does not exist in the map's style.")))},E.prototype.getTransition=function(){return R.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},E.prototype.serialize=function(){return R.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:R.mapObject(this.sourceCaches,function(b){return b.serialize()}),layers:this._serializeLayers(this._order)},function(b){return b!==void 0})},E.prototype._updateLayer=function(b){this._updatedLayers[b.id]=!0,b.source&&!this._updatedSources[b.source]&&this.sourceCaches[b.source].getSource().type!=="raster"&&(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause()),this._changed=!0},E.prototype._flattenAndSortRenderedFeatures=function(b){for(var A=this,B=function(Yr){return A._layers[Yr].type==="fill-extrusion"},H={},Y=[],et=this._order.length-1;et>=0;et--){var St=this._order[et];if(B(St)){H[St]=et;for(var Rt=0,ye=b;Rt<ye.length;Rt+=1){var be=ye[Rt][St];if(be)for(var Oe=0,on=be;Oe<on.length;Oe+=1)Y.push(on[Oe])}}}Y.sort(function(Yr,Ti){return Ti.intersectionZ-Yr.intersectionZ});for(var Qe=[],vn=this._order.length-1;vn>=0;vn--){var Ye=this._order[vn];if(B(Ye))for(var On=Y.length-1;On>=0;On--){var jn=Y[On].feature;if(H[jn.layer.id]<vn)break;Qe.push(jn),Y.pop()}else for(var ar=0,Or=b;ar<Or.length;ar+=1){var cr=Or[ar][Ye];if(cr)for(var kr=0,ei=cr;kr<ei.length;kr+=1)Qe.push(ei[kr].feature)}}return Qe},E.prototype.queryRenderedFeatures=function(b,A,B){A&&A.filter&&this._validate(R.validateStyle.filter,"queryRenderedFeatures.filter",A.filter,null,A);var H={};if(A&&A.layers){if(!Array.isArray(A.layers))return this.fire(new R.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Y=0,et=A.layers;Y<et.length;Y+=1){var St=et[Y],Rt=this._layers[St];if(!Rt)return this.fire(new R.ErrorEvent(new Error("The layer '"+St+"' does not exist in the map's style and cannot be queried for features."))),[];H[Rt.source]=!0}}var ye=[];for(var be in A.availableImages=this._availableImages,this.sourceCaches)A.layers&&!H[be]||ye.push(Qn(this.sourceCaches[be],this._layers,this._serializedLayers,b,A,B));return this.placement&&ye.push(function(Oe,on,Qe,vn,Ye,On,jn){for(var ar={},Or=On.queryRenderedSymbols(vn),cr=[],kr=0,ei=Object.keys(Or).map(Number);kr<ei.length;kr+=1)cr.push(jn[ei[kr]]);cr.sort(hr);for(var Yr=function(){var Fo=zi[Ti],ua=Fo.featureIndex.lookupSymbolFeatures(Or[Fo.bucketInstanceId],on,Fo.bucketIndex,Fo.sourceLayerIndex,Ye.filter,Ye.layers,Ye.availableImages,Oe);for(var Tn in ua){var Me=ar[Tn]=ar[Tn]||[],la=ua[Tn];la.sort(function(ga,jo){var Do=Fo.featureSortOrder;if(Do){var hc=Do.indexOf(ga.featureIndex);return Do.indexOf(jo.featureIndex)-hc}return jo.featureIndex-ga.featureIndex});for(var ta=0,Vo=la;ta<Vo.length;ta+=1)Me.push(Vo[ta])}},Ti=0,zi=cr;Ti<zi.length;Ti+=1)Yr();var Io=function(Fo){ar[Fo].forEach(function(ua){var Tn=ua.feature,Me=Qe[Oe[Fo].source].getFeatureState(Tn.layer["source-layer"],Tn.id);Tn.source=Tn.layer.source,Tn.layer["source-layer"]&&(Tn.sourceLayer=Tn.layer["source-layer"]),Tn.state=Me})};for(var Bo in ar)Io(Bo);return ar}(this._layers,this._serializedLayers,this.sourceCaches,b,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ye)},E.prototype.querySourceFeatures=function(b,A){A&&A.filter&&this._validate(R.validateStyle.filter,"querySourceFeatures.filter",A.filter,null,A);var B=this.sourceCaches[b];return B?function(H,Y){for(var et=H.getRenderableIds().map(function(on){return H.getTileByID(on)}),St=[],Rt={},ye=0;ye<et.length;ye++){var be=et[ye],Oe=be.tileID.canonical.key;Rt[Oe]||(Rt[Oe]=!0,be.querySourceFeatures(St,Y))}return St}(B,A):[]},E.prototype.addSourceType=function(b,A,B){return E.getSourceType(b)?B(new Error('A source type called "'+b+'" already exists.')):(E.setSourceType(b,A),A.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:b,url:A.workerSourceURL},B):B(null,null))},E.prototype.getLight=function(){return this.light.getLight()},E.prototype.setLight=function(b,A){A===void 0&&(A={}),this._checkLoaded();var B=this.light.getLight(),H=!1;for(var Y in b)if(!R.deepEqual(b[Y],B[Y])){H=!0;break}if(H){var et={now:R.browser.now(),transition:R.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,A),this.light.updateTransitions(et)}},E.prototype._validate=function(b,A,B,H,Y){return Y===void 0&&(Y={}),(!Y||Y.validate!==!1)&&Jc(this,b.call(R.validateStyle,R.extend({key:A,style:this.serialize(),value:B,styleSpec:R.styleSpec},H)))},E.prototype._remove=function(){for(var b in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),R.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[b].setEventedParent(null);for(var A in this.sourceCaches)this.sourceCaches[A].clearTiles(),this.sourceCaches[A].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},E.prototype._clearSource=function(b){this.sourceCaches[b].clearTiles()},E.prototype._reloadSource=function(b){this.sourceCaches[b].resume(),this.sourceCaches[b].reload()},E.prototype._updateSources=function(b){for(var A in this.sourceCaches)this.sourceCaches[A].update(b)},E.prototype._generateCollisionBoxes=function(){for(var b in this.sourceCaches)this._reloadSource(b)},E.prototype._updatePlacement=function(b,A,B,H,Y){Y===void 0&&(Y=!1);for(var et=!1,St=!1,Rt={},ye=0,be=this._order;ye<be.length;ye+=1){var Oe=this._layers[be[ye]];if(Oe.type==="symbol"){if(!Rt[Oe.source]){var on=this.sourceCaches[Oe.source];Rt[Oe.source]=on.getRenderableIds(!0).map(function(jn){return on.getTileByID(jn)}).sort(function(jn,ar){return ar.tileID.overscaledZ-jn.tileID.overscaledZ||(jn.tileID.isLessThan(ar.tileID)?-1:1)})}var Qe=this.crossTileSymbolIndex.addLayer(Oe,Rt[Oe.source],b.center.lng);et=et||Qe}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((Y=Y||this._layerOrderChanged||B===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(R.browser.now(),b.zoom))&&(this.pauseablePlacement=new Xf(b,this._order,Y,A,B,H,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Rt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(R.browser.now()),St=!0),et&&this.pauseablePlacement.placement.setStale()),St||et)for(var vn=0,Ye=this._order;vn<Ye.length;vn+=1){var On=this._layers[Ye[vn]];On.type==="symbol"&&this.placement.updateLayerOpacities(On,Rt[On.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(R.browser.now())},E.prototype._releaseSymbolFadeTiles=function(){for(var b in this.sourceCaches)this.sourceCaches[b].releaseSymbolFadeTiles()},E.prototype.getImages=function(b,A,B){this.imageManager.getImages(A.icons,B),this._updateTilesForChangedImages();var H=this.sourceCaches[A.source];H&&H.setDependencies(A.tileID.key,A.type,A.icons)},E.prototype.getGlyphs=function(b,A,B){this.glyphManager.getGlyphs(A.stacks,B)},E.prototype.getResource=function(b,A,B){return R.makeRequest(A,B)},E}(R.Evented);ac.getSourceType=function(_){return Ne[_]},ac.setSourceType=function(_,E){Ne[_]=E},ac.registerForPluginStateChange=R.registerForPluginStateChange;var Ws=R.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ru=us(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),gf=us(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Fh=us(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Uh=us(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),eu=us("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),mh=us(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),zh=us(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),vd=us("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),gd=us("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),yd=us("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),vp=us(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),qf=us(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Mu=us(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),_d=us(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Nl=us(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Ps=us(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),nu=us(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),sc=us(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),of=us(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lc=us(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),af=us(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),kl=us(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Pu=us(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),yf=us(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),vh=us(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),$f=us(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function us(_,E){var b=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,A=E.match(/attribute ([\w]+) ([\w]+)/g),B=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),H=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Y=H?H.concat(B):B,et={};return{fragmentSource:_=_.replace(b,function(St,Rt,ye,be,Oe){return et[Oe]=!0,Rt==="define"?`
#ifndef HAS_UNIFORM_u_`+Oe+`
varying `+ye+" "+be+" "+Oe+`;
#else
uniform `+ye+" "+be+" u_"+Oe+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Oe+`
    `+ye+" "+be+" "+Oe+" = u_"+Oe+`;
#endif
`}),vertexSource:E=E.replace(b,function(St,Rt,ye,be,Oe){var on=be==="float"?"vec2":"vec4",Qe=Oe.match(/color/)?"color":on;return et[Oe]?Rt==="define"?`
#ifndef HAS_UNIFORM_u_`+Oe+`
uniform lowp float u_`+Oe+`_t;
attribute `+ye+" "+on+" a_"+Oe+`;
varying `+ye+" "+be+" "+Oe+`;
#else
uniform `+ye+" "+be+" u_"+Oe+`;
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Oe+`
    `+Oe+" = a_"+Oe+`;
#else
    `+ye+" "+be+" "+Oe+" = u_"+Oe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Oe+`
    `+Oe+" = unpack_mix_"+Qe+"(a_"+Oe+", u_"+Oe+`_t);
#else
    `+ye+" "+be+" "+Oe+" = u_"+Oe+`;
#endif
`:Rt==="define"?`
#ifndef HAS_UNIFORM_u_`+Oe+`
uniform lowp float u_`+Oe+`_t;
attribute `+ye+" "+on+" a_"+Oe+`;
#else
uniform `+ye+" "+be+" u_"+Oe+`;
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Oe+`
    `+ye+" "+be+" "+Oe+" = a_"+Oe+`;
#else
    `+ye+" "+be+" "+Oe+" = u_"+Oe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Oe+`
    `+ye+" "+be+" "+Oe+" = unpack_mix_"+Qe+"(a_"+Oe+", u_"+Oe+`_t);
#else
    `+ye+" "+be+" "+Oe+" = u_"+Oe+`;
#endif
`}),staticAttributes:A,staticUniforms:Y}}var jh=Object.freeze({__proto__:null,prelude:Ru,background:gf,backgroundPattern:Fh,circle:Uh,clippingMask:eu,heatmap:mh,heatmapTexture:zh,collisionBox:vd,collisionCircle:gd,debug:yd,fill:vp,fillOutline:qf,fillOutlinePattern:Mu,fillPattern:_d,fillExtrusion:Nl,fillExtrusionPattern:Ps,hillshadePrepare:nu,hillshade:sc,line:of,lineGradient:lc,linePattern:af,lineSDF:kl,raster:Pu,symbolIcon:yf,symbolSDF:vh,symbolTextAndIcon:$f}),Vh=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function gh(_){for(var E=[],b=0;b<_.length;b++)if(_[b]!==null){var A=_[b].split(" ");E.push(A.pop())}return E}Vh.prototype.bind=function(_,E,b,A,B,H,Y,et){this.context=_;for(var St=this.boundPaintVertexBuffers.length!==A.length,Rt=0;!St&&Rt<A.length;Rt++)this.boundPaintVertexBuffers[Rt]!==A[Rt]&&(St=!0);_.extVertexArrayObject&&this.vao&&this.boundProgram===E&&this.boundLayoutVertexBuffer===b&&!St&&this.boundIndexBuffer===B&&this.boundVertexOffset===H&&this.boundDynamicVertexBuffer===Y&&this.boundDynamicVertexBuffer2===et?(_.bindVertexArrayOES.set(this.vao),Y&&Y.bind(),B&&B.dynamicDraw&&B.bind(),et&&et.bind()):this.freshBind(E,b,A,B,H,Y,et)},Vh.prototype.freshBind=function(_,E,b,A,B,H,Y){var et,St=_.numAttributes,Rt=this.context,ye=Rt.gl;if(Rt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Rt.extVertexArrayObject.createVertexArrayOES(),Rt.bindVertexArrayOES.set(this.vao),et=0,this.boundProgram=_,this.boundLayoutVertexBuffer=E,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=A,this.boundVertexOffset=B,this.boundDynamicVertexBuffer=H,this.boundDynamicVertexBuffer2=Y;else{et=Rt.currentNumAttributes||0;for(var be=St;be<et;be++)ye.disableVertexAttribArray(be)}E.enableAttributes(ye,_);for(var Oe=0,on=b;Oe<on.length;Oe+=1)on[Oe].enableAttributes(ye,_);H&&H.enableAttributes(ye,_),Y&&Y.enableAttributes(ye,_),E.bind(),E.setVertexAttribPointers(ye,_,B);for(var Qe=0,vn=b;Qe<vn.length;Qe+=1){var Ye=vn[Qe];Ye.bind(),Ye.setVertexAttribPointers(ye,_,B)}H&&(H.bind(),H.setVertexAttribPointers(ye,_,B)),A&&A.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(ye,_,B)),Rt.currentNumAttributes=St},Vh.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var il=function(_,E,b,A,B,H){var Y=_.gl;this.program=Y.createProgram();for(var et=gh(b.staticAttributes),St=A?A.getBinderAttributes():[],Rt=et.concat(St),ye=b.staticUniforms?gh(b.staticUniforms):[],be=A?A.getBinderUniforms():[],Oe=[],on=0,Qe=ye.concat(be);on<Qe.length;on+=1){var vn=Qe[on];Oe.indexOf(vn)<0&&Oe.push(vn)}var Ye=A?A.defines():[];H&&Ye.push("#define OVERDRAW_INSPECTOR;");var On=Ye.concat(Ru.fragmentSource,b.fragmentSource).join(`
`),jn=Ye.concat(Ru.vertexSource,b.vertexSource).join(`
`),ar=Y.createShader(Y.FRAGMENT_SHADER);if(Y.isContextLost())this.failedToCreate=!0;else{Y.shaderSource(ar,On),Y.compileShader(ar),Y.attachShader(this.program,ar);var Or=Y.createShader(Y.VERTEX_SHADER);if(Y.isContextLost())this.failedToCreate=!0;else{Y.shaderSource(Or,jn),Y.compileShader(Or),Y.attachShader(this.program,Or),this.attributes={};var cr={};this.numAttributes=Rt.length;for(var kr=0;kr<this.numAttributes;kr++)Rt[kr]&&(Y.bindAttribLocation(this.program,kr,Rt[kr]),this.attributes[Rt[kr]]=kr);Y.linkProgram(this.program),Y.deleteShader(Or),Y.deleteShader(ar);for(var ei=0;ei<Oe.length;ei++){var Yr=Oe[ei];if(Yr&&!cr[Yr]){var Ti=Y.getUniformLocation(this.program,Yr);Ti&&(cr[Yr]=Ti)}}this.fixedUniforms=B(_,cr),this.binderUniforms=A?A.getUniforms(_,cr):[]}}};function Kf(_,E,b){var A=1/Ni(b,1,E.transform.tileZoom),B=Math.pow(2,b.tileID.overscaledZ),H=b.tileSize*Math.pow(2,E.transform.tileZoom)/B,Y=H*(b.tileID.canonical.x+b.tileID.wrap*B),et=H*b.tileID.canonical.y;return{u_image:0,u_texsize:b.imageAtlasTexture.size,u_scale:[A,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[Y>>16,et>>16],u_pixel_coord_lower:[65535&Y,65535&et]}}il.prototype.draw=function(_,E,b,A,B,H,Y,et,St,Rt,ye,be,Oe,on,Qe,vn){var Ye,On=_.gl;if(!this.failedToCreate){for(var jn in _.program.set(this.program),_.setDepthMode(b),_.setStencilMode(A),_.setColorMode(B),_.setCullFace(H),this.fixedUniforms)this.fixedUniforms[jn].set(Y[jn]);on&&on.setUniforms(_,this.binderUniforms,be,{zoom:Oe});for(var ar=(Ye={},Ye[On.LINES]=2,Ye[On.TRIANGLES]=3,Ye[On.LINE_STRIP]=1,Ye)[E],Or=0,cr=ye.get();Or<cr.length;Or+=1){var kr=cr[Or],ei=kr.vaos||(kr.vaos={});(ei[et]||(ei[et]=new Vh)).bind(_,this,St,on?on.getPaintVertexBuffers():[],Rt,kr.vertexOffset,Qe,vn),On.drawElements(E,kr.primitiveLength*ar,On.UNSIGNED_SHORT,kr.primitiveOffset*ar*2)}}};var Qf=function(_,E,b,A){var B=E.style.light,H=B.properties.get("position"),Y=[H.x,H.y,H.z],et=R.create$1();B.properties.get("anchor")==="viewport"&&R.fromRotation(et,-E.transform.angle),R.transformMat3(Y,Y,et);var St=B.properties.get("color");return{u_matrix:_,u_lightpos:Y,u_lightintensity:B.properties.get("intensity"),u_lightcolor:[St.r,St.g,St.b],u_vertical_gradient:+b,u_opacity:A}},K=function(_,E,b,A,B,H,Y){return R.extend(Qf(_,E,b,A),Kf(H,E,Y),{u_height_factor:-Math.pow(2,B.overscaledZ)/Y.tileSize/8})},lt=function(_){return{u_matrix:_}},It=function(_,E,b,A){return R.extend(lt(_),Kf(b,E,A))},Ke=function(_,E){return{u_matrix:_,u_world:E}},X=function(_,E,b,A,B){return R.extend(It(_,E,b,A),{u_world:B})},Xn=function(_,E,b,A){var B,H,Y=_.transform;if(A.paint.get("circle-pitch-alignment")==="map"){var et=Ni(b,1,Y.zoom);B=!0,H=[et,et]}else B=!1,H=Y.pixelsToGLUnits;return{u_camera_to_center_distance:Y.cameraToCenterDistance,u_scale_with_map:+(A.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(E.posMatrix,b,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_pitch_with_map:+B,u_device_pixel_ratio:R.browser.devicePixelRatio,u_extrude_scale:H}},Mr=function(_,E,b){var A=Ni(b,1,E.zoom),B=Math.pow(2,E.zoom-b.tileID.overscaledZ),H=b.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:E.cameraToCenterDistance,u_pixels_to_tile_units:A,u_extrude_scale:[E.pixelsToGLUnits[0]/(A*B),E.pixelsToGLUnits[1]/(A*B)],u_overscale_factor:H}},ki=function(_,E,b){return{u_matrix:_,u_inv_matrix:E,u_camera_to_center_distance:b.cameraToCenterDistance,u_viewport_size:[b.width,b.height]}},Jr=function(_,E,b){return b===void 0&&(b=1),{u_matrix:_,u_color:E,u_overlay:0,u_overlay_scale:b}},co=function(_){return{u_matrix:_}},so=function(_,E,b,A){return{u_matrix:_,u_extrude_scale:Ni(E,1,b),u_intensity:A}},sa=function(_,E,b){var A=_.transform;return{u_matrix:ma(_,E,b),u_ratio:1/Ni(E,1,A.zoom),u_device_pixel_ratio:R.browser.devicePixelRatio,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},Po=function(_,E,b,A){return R.extend(sa(_,E,b),{u_image:0,u_image_height:A})},_a=function(_,E,b,A){var B=_.transform,H=ra(E,B);return{u_matrix:ma(_,E,b),u_texsize:E.imageAtlasTexture.size,u_ratio:1/Ni(E,1,B.zoom),u_device_pixel_ratio:R.browser.devicePixelRatio,u_image:0,u_scale:[H,A.fromScale,A.toScale],u_fade:A.t,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]]}},qa=function(_,E,b,A,B){var H=_.lineAtlas,Y=ra(E,_.transform),et=b.layout.get("line-cap")==="round",St=H.getDash(A.from,et),Rt=H.getDash(A.to,et),ye=St.width*B.fromScale,be=Rt.width*B.toScale;return R.extend(sa(_,E,b),{u_patternscale_a:[Y/ye,-St.height/2],u_patternscale_b:[Y/be,-Rt.height/2],u_sdfgamma:H.width/(256*Math.min(ye,be)*R.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:St.y,u_tex_y_b:Rt.y,u_mix:B.t})};function ra(_,E){return 1/Ni(_,1,E.tileZoom)}function ma(_,E,b){return _.translatePosMatrix(E.tileID.posMatrix,E,b.paint.get("line-translate"),b.paint.get("line-translate-anchor"))}var ls=function(_,E,b,A,B){return{u_matrix:_,u_tl_parent:E,u_scale_parent:b,u_buffer_scale:1,u_fade_t:A.mix,u_opacity:A.opacity*B.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:B.paint.get("raster-brightness-min"),u_brightness_high:B.paint.get("raster-brightness-max"),u_saturation_factor:(Y=B.paint.get("raster-saturation"),Y>0?1-1/(1.001-Y):-Y),u_contrast_factor:(H=B.paint.get("raster-contrast"),H>0?1/(1-H):1+H),u_spin_weights:Aa(B.paint.get("raster-hue-rotate"))};var H,Y};function Aa(_){_*=Math.PI/180;var E=Math.sin(_),b=Math.cos(_);return[(2*b+1)/3,(-Math.sqrt(3)*E-b+1)/3,(Math.sqrt(3)*E-b+1)/3]}var Ia,ka=function(_,E,b,A,B,H,Y,et,St,Rt){var ye=B.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:E?E.uSizeT:0,u_size:E?E.uSize:0,u_camera_to_center_distance:ye.cameraToCenterDistance,u_pitch:ye.pitch/360*2*Math.PI,u_rotate_symbol:+b,u_aspect_ratio:ye.width/ye.height,u_fade_change:B.options.fadeDuration?B.symbolFadeChange:1,u_matrix:H,u_label_plane_matrix:Y,u_coord_matrix:et,u_is_text:+St,u_pitch_with_map:+A,u_texsize:Rt,u_texture:0}},qs=function(_,E,b,A,B,H,Y,et,St,Rt,ye){var be=B.transform;return R.extend(ka(_,E,b,A,B,H,Y,et,St,Rt),{u_gamma_scale:A?Math.cos(be._pitch)*be.cameraToCenterDistance:1,u_device_pixel_ratio:R.browser.devicePixelRatio,u_is_halo:+ye})},ks=function(_,E,b,A,B,H,Y,et,St,Rt){return R.extend(qs(_,E,b,A,B,H,Y,et,!0,St,!0),{u_texsize_icon:Rt,u_texture_icon:1})},Ec=function(_,E,b){return{u_matrix:_,u_opacity:E,u_color:b}},es=function(_,E,b,A,B,H){return R.extend(function(Y,et,St,Rt){var ye=St.imageManager.getPattern(Y.from.toString()),be=St.imageManager.getPattern(Y.to.toString()),Oe=St.imageManager.getPixelSize(),on=Oe.width,Qe=Oe.height,vn=Math.pow(2,Rt.tileID.overscaledZ),Ye=Rt.tileSize*Math.pow(2,St.transform.tileZoom)/vn,On=Ye*(Rt.tileID.canonical.x+Rt.tileID.wrap*vn),jn=Ye*Rt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ye.tl,u_pattern_br_a:ye.br,u_pattern_tl_b:be.tl,u_pattern_br_b:be.br,u_texsize:[on,Qe],u_mix:et.t,u_pattern_size_a:ye.displaySize,u_pattern_size_b:be.displaySize,u_scale_a:et.fromScale,u_scale_b:et.toScale,u_tile_units_to_pixels:1/Ni(Rt,1,St.transform.tileZoom),u_pixel_coord_upper:[On>>16,jn>>16],u_pixel_coord_lower:[65535&On,65535&jn]}}(A,H,b,B),{u_matrix:_,u_opacity:E})},Iu={fillExtrusion:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_lightpos:new R.Uniform3f(_,E.u_lightpos),u_lightintensity:new R.Uniform1f(_,E.u_lightintensity),u_lightcolor:new R.Uniform3f(_,E.u_lightcolor),u_vertical_gradient:new R.Uniform1f(_,E.u_vertical_gradient),u_opacity:new R.Uniform1f(_,E.u_opacity)}},fillExtrusionPattern:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_lightpos:new R.Uniform3f(_,E.u_lightpos),u_lightintensity:new R.Uniform1f(_,E.u_lightintensity),u_lightcolor:new R.Uniform3f(_,E.u_lightcolor),u_vertical_gradient:new R.Uniform1f(_,E.u_vertical_gradient),u_height_factor:new R.Uniform1f(_,E.u_height_factor),u_image:new R.Uniform1i(_,E.u_image),u_texsize:new R.Uniform2f(_,E.u_texsize),u_pixel_coord_upper:new R.Uniform2f(_,E.u_pixel_coord_upper),u_pixel_coord_lower:new R.Uniform2f(_,E.u_pixel_coord_lower),u_scale:new R.Uniform3f(_,E.u_scale),u_fade:new R.Uniform1f(_,E.u_fade),u_opacity:new R.Uniform1f(_,E.u_opacity)}},fill:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix)}},fillPattern:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_image:new R.Uniform1i(_,E.u_image),u_texsize:new R.Uniform2f(_,E.u_texsize),u_pixel_coord_upper:new R.Uniform2f(_,E.u_pixel_coord_upper),u_pixel_coord_lower:new R.Uniform2f(_,E.u_pixel_coord_lower),u_scale:new R.Uniform3f(_,E.u_scale),u_fade:new R.Uniform1f(_,E.u_fade)}},fillOutline:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_world:new R.Uniform2f(_,E.u_world)}},fillOutlinePattern:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_world:new R.Uniform2f(_,E.u_world),u_image:new R.Uniform1i(_,E.u_image),u_texsize:new R.Uniform2f(_,E.u_texsize),u_pixel_coord_upper:new R.Uniform2f(_,E.u_pixel_coord_upper),u_pixel_coord_lower:new R.Uniform2f(_,E.u_pixel_coord_lower),u_scale:new R.Uniform3f(_,E.u_scale),u_fade:new R.Uniform1f(_,E.u_fade)}},circle:function(_,E){return{u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_scale_with_map:new R.Uniform1i(_,E.u_scale_with_map),u_pitch_with_map:new R.Uniform1i(_,E.u_pitch_with_map),u_extrude_scale:new R.Uniform2f(_,E.u_extrude_scale),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_matrix:new R.UniformMatrix4f(_,E.u_matrix)}},collisionBox:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_pixels_to_tile_units:new R.Uniform1f(_,E.u_pixels_to_tile_units),u_extrude_scale:new R.Uniform2f(_,E.u_extrude_scale),u_overscale_factor:new R.Uniform1f(_,E.u_overscale_factor)}},collisionCircle:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_inv_matrix:new R.UniformMatrix4f(_,E.u_inv_matrix),u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_viewport_size:new R.Uniform2f(_,E.u_viewport_size)}},debug:function(_,E){return{u_color:new R.UniformColor(_,E.u_color),u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_overlay:new R.Uniform1i(_,E.u_overlay),u_overlay_scale:new R.Uniform1f(_,E.u_overlay_scale)}},clippingMask:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix)}},heatmap:function(_,E){return{u_extrude_scale:new R.Uniform1f(_,E.u_extrude_scale),u_intensity:new R.Uniform1f(_,E.u_intensity),u_matrix:new R.UniformMatrix4f(_,E.u_matrix)}},heatmapTexture:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_world:new R.Uniform2f(_,E.u_world),u_image:new R.Uniform1i(_,E.u_image),u_color_ramp:new R.Uniform1i(_,E.u_color_ramp),u_opacity:new R.Uniform1f(_,E.u_opacity)}},hillshade:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_image:new R.Uniform1i(_,E.u_image),u_latrange:new R.Uniform2f(_,E.u_latrange),u_light:new R.Uniform2f(_,E.u_light),u_shadow:new R.UniformColor(_,E.u_shadow),u_highlight:new R.UniformColor(_,E.u_highlight),u_accent:new R.UniformColor(_,E.u_accent)}},hillshadePrepare:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_image:new R.Uniform1i(_,E.u_image),u_dimension:new R.Uniform2f(_,E.u_dimension),u_zoom:new R.Uniform1f(_,E.u_zoom),u_unpack:new R.Uniform4f(_,E.u_unpack)}},line:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_ratio:new R.Uniform1f(_,E.u_ratio),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_units_to_pixels:new R.Uniform2f(_,E.u_units_to_pixels)}},lineGradient:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_ratio:new R.Uniform1f(_,E.u_ratio),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_units_to_pixels:new R.Uniform2f(_,E.u_units_to_pixels),u_image:new R.Uniform1i(_,E.u_image),u_image_height:new R.Uniform1f(_,E.u_image_height)}},linePattern:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_texsize:new R.Uniform2f(_,E.u_texsize),u_ratio:new R.Uniform1f(_,E.u_ratio),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_image:new R.Uniform1i(_,E.u_image),u_units_to_pixels:new R.Uniform2f(_,E.u_units_to_pixels),u_scale:new R.Uniform3f(_,E.u_scale),u_fade:new R.Uniform1f(_,E.u_fade)}},lineSDF:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_ratio:new R.Uniform1f(_,E.u_ratio),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_units_to_pixels:new R.Uniform2f(_,E.u_units_to_pixels),u_patternscale_a:new R.Uniform2f(_,E.u_patternscale_a),u_patternscale_b:new R.Uniform2f(_,E.u_patternscale_b),u_sdfgamma:new R.Uniform1f(_,E.u_sdfgamma),u_image:new R.Uniform1i(_,E.u_image),u_tex_y_a:new R.Uniform1f(_,E.u_tex_y_a),u_tex_y_b:new R.Uniform1f(_,E.u_tex_y_b),u_mix:new R.Uniform1f(_,E.u_mix)}},raster:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_tl_parent:new R.Uniform2f(_,E.u_tl_parent),u_scale_parent:new R.Uniform1f(_,E.u_scale_parent),u_buffer_scale:new R.Uniform1f(_,E.u_buffer_scale),u_fade_t:new R.Uniform1f(_,E.u_fade_t),u_opacity:new R.Uniform1f(_,E.u_opacity),u_image0:new R.Uniform1i(_,E.u_image0),u_image1:new R.Uniform1i(_,E.u_image1),u_brightness_low:new R.Uniform1f(_,E.u_brightness_low),u_brightness_high:new R.Uniform1f(_,E.u_brightness_high),u_saturation_factor:new R.Uniform1f(_,E.u_saturation_factor),u_contrast_factor:new R.Uniform1f(_,E.u_contrast_factor),u_spin_weights:new R.Uniform3f(_,E.u_spin_weights)}},symbolIcon:function(_,E){return{u_is_size_zoom_constant:new R.Uniform1i(_,E.u_is_size_zoom_constant),u_is_size_feature_constant:new R.Uniform1i(_,E.u_is_size_feature_constant),u_size_t:new R.Uniform1f(_,E.u_size_t),u_size:new R.Uniform1f(_,E.u_size),u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_pitch:new R.Uniform1f(_,E.u_pitch),u_rotate_symbol:new R.Uniform1i(_,E.u_rotate_symbol),u_aspect_ratio:new R.Uniform1f(_,E.u_aspect_ratio),u_fade_change:new R.Uniform1f(_,E.u_fade_change),u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_label_plane_matrix:new R.UniformMatrix4f(_,E.u_label_plane_matrix),u_coord_matrix:new R.UniformMatrix4f(_,E.u_coord_matrix),u_is_text:new R.Uniform1i(_,E.u_is_text),u_pitch_with_map:new R.Uniform1i(_,E.u_pitch_with_map),u_texsize:new R.Uniform2f(_,E.u_texsize),u_texture:new R.Uniform1i(_,E.u_texture)}},symbolSDF:function(_,E){return{u_is_size_zoom_constant:new R.Uniform1i(_,E.u_is_size_zoom_constant),u_is_size_feature_constant:new R.Uniform1i(_,E.u_is_size_feature_constant),u_size_t:new R.Uniform1f(_,E.u_size_t),u_size:new R.Uniform1f(_,E.u_size),u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_pitch:new R.Uniform1f(_,E.u_pitch),u_rotate_symbol:new R.Uniform1i(_,E.u_rotate_symbol),u_aspect_ratio:new R.Uniform1f(_,E.u_aspect_ratio),u_fade_change:new R.Uniform1f(_,E.u_fade_change),u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_label_plane_matrix:new R.UniformMatrix4f(_,E.u_label_plane_matrix),u_coord_matrix:new R.UniformMatrix4f(_,E.u_coord_matrix),u_is_text:new R.Uniform1i(_,E.u_is_text),u_pitch_with_map:new R.Uniform1i(_,E.u_pitch_with_map),u_texsize:new R.Uniform2f(_,E.u_texsize),u_texture:new R.Uniform1i(_,E.u_texture),u_gamma_scale:new R.Uniform1f(_,E.u_gamma_scale),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_is_halo:new R.Uniform1i(_,E.u_is_halo)}},symbolTextAndIcon:function(_,E){return{u_is_size_zoom_constant:new R.Uniform1i(_,E.u_is_size_zoom_constant),u_is_size_feature_constant:new R.Uniform1i(_,E.u_is_size_feature_constant),u_size_t:new R.Uniform1f(_,E.u_size_t),u_size:new R.Uniform1f(_,E.u_size),u_camera_to_center_distance:new R.Uniform1f(_,E.u_camera_to_center_distance),u_pitch:new R.Uniform1f(_,E.u_pitch),u_rotate_symbol:new R.Uniform1i(_,E.u_rotate_symbol),u_aspect_ratio:new R.Uniform1f(_,E.u_aspect_ratio),u_fade_change:new R.Uniform1f(_,E.u_fade_change),u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_label_plane_matrix:new R.UniformMatrix4f(_,E.u_label_plane_matrix),u_coord_matrix:new R.UniformMatrix4f(_,E.u_coord_matrix),u_is_text:new R.Uniform1i(_,E.u_is_text),u_pitch_with_map:new R.Uniform1i(_,E.u_pitch_with_map),u_texsize:new R.Uniform2f(_,E.u_texsize),u_texsize_icon:new R.Uniform2f(_,E.u_texsize_icon),u_texture:new R.Uniform1i(_,E.u_texture),u_texture_icon:new R.Uniform1i(_,E.u_texture_icon),u_gamma_scale:new R.Uniform1f(_,E.u_gamma_scale),u_device_pixel_ratio:new R.Uniform1f(_,E.u_device_pixel_ratio),u_is_halo:new R.Uniform1i(_,E.u_is_halo)}},background:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_opacity:new R.Uniform1f(_,E.u_opacity),u_color:new R.UniformColor(_,E.u_color)}},backgroundPattern:function(_,E){return{u_matrix:new R.UniformMatrix4f(_,E.u_matrix),u_opacity:new R.Uniform1f(_,E.u_opacity),u_image:new R.Uniform1i(_,E.u_image),u_pattern_tl_a:new R.Uniform2f(_,E.u_pattern_tl_a),u_pattern_br_a:new R.Uniform2f(_,E.u_pattern_br_a),u_pattern_tl_b:new R.Uniform2f(_,E.u_pattern_tl_b),u_pattern_br_b:new R.Uniform2f(_,E.u_pattern_br_b),u_texsize:new R.Uniform2f(_,E.u_texsize),u_mix:new R.Uniform1f(_,E.u_mix),u_pattern_size_a:new R.Uniform2f(_,E.u_pattern_size_a),u_pattern_size_b:new R.Uniform2f(_,E.u_pattern_size_b),u_scale_a:new R.Uniform1f(_,E.u_scale_a),u_scale_b:new R.Uniform1f(_,E.u_scale_b),u_pixel_coord_upper:new R.Uniform2f(_,E.u_pixel_coord_upper),u_pixel_coord_lower:new R.Uniform2f(_,E.u_pixel_coord_lower),u_tile_units_to_pixels:new R.Uniform1f(_,E.u_tile_units_to_pixels)}}};function du(_,E,b,A,B,H,Y){for(var et=_.context,St=et.gl,Rt=_.useProgram("collisionBox"),ye=[],be=0,Oe=0,on=0;on<A.length;on++){var Qe=A[on],vn=E.getTile(Qe),Ye=vn.getBucket(b);if(Ye){var On=Qe.posMatrix;B[0]===0&&B[1]===0||(On=_.translatePosMatrix(Qe.posMatrix,vn,B,H));var jn=Y?Ye.textCollisionBox:Ye.iconCollisionBox,ar=Ye.collisionCircleArray;if(ar.length>0){var Or=R.create(),cr=On;R.mul(Or,Ye.placementInvProjMatrix,_.transform.glCoordMatrix),R.mul(Or,Or,Ye.placementViewportMatrix),ye.push({circleArray:ar,circleOffset:Oe,transform:cr,invTransform:Or}),Oe=be+=ar.length/4}jn&&Rt.draw(et,St.LINES,Gt.disabled,ue.disabled,_.colorModeForRenderPass(),ln.disabled,Mr(On,_.transform,vn),b.id,jn.layoutVertexBuffer,jn.indexBuffer,jn.segments,null,_.transform.zoom,null,null,jn.collisionVertexBuffer)}}if(Y&&ye.length){var kr=_.useProgram("collisionCircle"),ei=new R.StructArrayLayout2f1f2i16;ei.resize(4*be),ei._trim();for(var Yr=0,Ti=0,zi=ye;Ti<zi.length;Ti+=1)for(var Io=zi[Ti],Bo=0;Bo<Io.circleArray.length/4;Bo++){var Fo=4*Bo,ua=Io.circleArray[Fo+0],Tn=Io.circleArray[Fo+1],Me=Io.circleArray[Fo+2],la=Io.circleArray[Fo+3];ei.emplace(Yr++,ua,Tn,Me,la,0),ei.emplace(Yr++,ua,Tn,Me,la,1),ei.emplace(Yr++,ua,Tn,Me,la,2),ei.emplace(Yr++,ua,Tn,Me,la,3)}(!Ia||Ia.length<2*be)&&(Ia=function(ml){var Bc=2*ml,Wl=new R.StructArrayLayout3ui6;Wl.resize(Bc),Wl._trim();for(var vs=0;vs<Bc;vs++){var Ks=6*vs;Wl.uint16[Ks+0]=4*vs+0,Wl.uint16[Ks+1]=4*vs+1,Wl.uint16[Ks+2]=4*vs+2,Wl.uint16[Ks+3]=4*vs+2,Wl.uint16[Ks+4]=4*vs+3,Wl.uint16[Ks+5]=4*vs+0}return Wl}(be));for(var ta=et.createIndexBuffer(Ia,!0),Vo=et.createVertexBuffer(ei,R.collisionCircleLayout.members,!0),ga=0,jo=ye;ga<jo.length;ga+=1){var Do=jo[ga],hc=ki(Do.transform,Do.invTransform,_.transform);kr.draw(et,St.TRIANGLES,Gt.disabled,ue.disabled,_.colorModeForRenderPass(),ln.disabled,hc,b.id,Vo,ta,R.SegmentVector.simpleSegment(0,2*Do.circleOffset,Do.circleArray.length,Do.circleArray.length/2),null,_.transform.zoom,null,null,null)}Vo.destroy(),ta.destroy()}}var Lc=R.identity(new Float32Array(16));function Pf(_,E,b,A,B,H){var Y=R.getAnchorAlignment(_),et=-(Y.horizontalAlign-.5)*E,St=-(Y.verticalAlign-.5)*b,Rt=R.evaluateVariableOffset(_,A);return new R.Point((et/B+Rt[0])*H,(St/B+Rt[1])*H)}function Zh(_,E,b,A,B,H,Y,et,St,Rt,ye){var be=_.text.placedSymbolArray,Oe=_.text.dynamicLayoutVertexArray,on=_.icon.dynamicLayoutVertexArray,Qe={};Oe.clear();for(var vn=0;vn<be.length;vn++){var Ye=be.get(vn),On=Ye.hidden||!Ye.crossTileID||_.allowVerticalPlacement&&!Ye.placedOrientation?null:A[Ye.crossTileID];if(On){var jn=new R.Point(Ye.anchorX,Ye.anchorY),ar=Pn(jn,b?et:Y),Or=tn(H.cameraToCenterDistance,ar.signedDistanceFromCamera),cr=B.evaluateSizeForFeature(_.textSizeData,Rt,Ye)*Or/R.ONE_EM;b&&(cr*=_.tilePixelRatio/St);for(var kr=Pf(On.anchor,On.width,On.height,On.textOffset,On.textBoxScale,cr),ei=b?Pn(jn.add(kr),Y).point:ar.point.add(E?kr.rotate(-H.angle):kr),Yr=_.allowVerticalPlacement&&Ye.placedOrientation===R.WritingMode.vertical?Math.PI/2:0,Ti=0;Ti<Ye.numGlyphs;Ti++)R.addDynamicAttributes(Oe,ei,Yr);ye&&Ye.associatedIconIndex>=0&&(Qe[Ye.associatedIconIndex]={shiftedAnchor:ei,angle:Yr})}else Ui(Ye.numGlyphs,Oe)}if(ye){on.clear();for(var zi=_.icon.placedSymbolArray,Io=0;Io<zi.length;Io++){var Bo=zi.get(Io);if(Bo.hidden)Ui(Bo.numGlyphs,on);else{var Fo=Qe[Io];if(Fo)for(var ua=0;ua<Bo.numGlyphs;ua++)R.addDynamicAttributes(on,Fo.shiftedAnchor,Fo.angle);else Ui(Bo.numGlyphs,on)}}_.icon.dynamicLayoutVertexBuffer.updateData(on)}_.text.dynamicLayoutVertexBuffer.updateData(Oe)}function Hh(_,E,b){return b.iconsInText&&E?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function If(_,E,b,A,B,H,Y,et,St,Rt,ye,be){for(var Oe=_.context,on=Oe.gl,Qe=_.transform,vn=et==="map",Ye=St==="map",On=vn&&b.layout.get("symbol-placement")!=="point",jn=vn&&!Ye&&!On,ar=b.layout.get("symbol-sort-key").constantOr(1)!==void 0,Or=!1,cr=_.depthModeForSublayer(0,Gt.ReadOnly),kr=b.layout.get("text-variable-anchor"),ei=[],Yr=0,Ti=A;Yr<Ti.length;Yr+=1){var zi=Ti[Yr],Io=E.getTile(zi),Bo=Io.getBucket(b);if(Bo){var Fo=B?Bo.text:Bo.icon;if(Fo&&Fo.segments.get().length){var ua=Fo.programConfigurations.get(b.id),Tn=B||Bo.sdfIcons,Me=B?Bo.textSizeData:Bo.iconSizeData,la=Ye||Qe.pitch!==0,ta=_.useProgram(Hh(Tn,B,Bo),ua),Vo=R.evaluateSizeForZoom(Me,Qe.zoom),ga=void 0,jo=[0,0],Do=void 0,hc=void 0,ml=null,Bc=void 0;if(B)Do=Io.glyphAtlasTexture,hc=on.LINEAR,ga=Io.glyphAtlasTexture.size,Bo.iconsInText&&(jo=Io.imageAtlasTexture.size,ml=Io.imageAtlasTexture,Bc=la||_.options.rotating||_.options.zooming||Me.kind==="composite"||Me.kind==="camera"?on.LINEAR:on.NEAREST);else{var Wl=b.layout.get("icon-size").constantOr(0)!==1||Bo.iconsNeedLinear;Do=Io.imageAtlasTexture,hc=Tn||_.options.rotating||_.options.zooming||Wl||la?on.LINEAR:on.NEAREST,ga=Io.imageAtlasTexture.size}var vs=Ni(Io,1,_.transform.zoom),Ks=qe(zi.posMatrix,Ye,vn,_.transform,vs),sl=Rn(zi.posMatrix,Ye,vn,_.transform,vs),vl=kr&&Bo.hasTextData(),_f=b.layout.get("icon-text-fit")!=="none"&&vl&&Bo.hasIconData();On&&dr(Bo,zi.posMatrix,_,B,Ks,sl,Ye,Rt);var ol=_.translatePosMatrix(zi.posMatrix,Io,H,Y),sf=On||B&&kr||_f?Lc:Ks,Vu=_.translatePosMatrix(sl,Io,H,Y,!0),Vd=Tn&&b.paint.get(B?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ff={program:ta,buffers:Fo,uniformValues:Tn?Bo.iconsInText?ks(Me.kind,Vo,jn,Ye,_,ol,sf,Vu,ga,jo):qs(Me.kind,Vo,jn,Ye,_,ol,sf,Vu,B,ga,!0):ka(Me.kind,Vo,jn,Ye,_,ol,sf,Vu,B,ga),atlasTexture:Do,atlasTextureIcon:ml,atlasInterpolation:hc,atlasInterpolationIcon:Bc,isSDF:Tn,hasHalo:Vd};if(ar&&Bo.canOverlap){Or=!0;for(var Sh=0,Zd=Fo.segments.get();Sh<Zd.length;Sh+=1){var qh=Zd[Sh];ei.push({segments:new R.SegmentVector([qh]),sortKey:qh.sortKey,state:Ff})}}else ei.push({segments:Fo.segments,sortKey:0,state:Ff})}}}Or&&ei.sort(function(Bl,Zu){return Bl.sortKey-Zu.sortKey});for(var xf=0,wi=ei;xf<wi.length;xf+=1){var fl=wi[xf],ya=fl.state;if(Oe.activeTexture.set(on.TEXTURE0),ya.atlasTexture.bind(ya.atlasInterpolation,on.CLAMP_TO_EDGE),ya.atlasTextureIcon&&(Oe.activeTexture.set(on.TEXTURE1),ya.atlasTextureIcon&&ya.atlasTextureIcon.bind(ya.atlasInterpolationIcon,on.CLAMP_TO_EDGE)),ya.isSDF){var gs=ya.uniformValues;ya.hasHalo&&(gs.u_is_halo=1,Lu(ya.buffers,fl.segments,b,_,ya.program,cr,ye,be,gs)),gs.u_is_halo=0}Lu(ya.buffers,fl.segments,b,_,ya.program,cr,ye,be,ya.uniformValues)}}function Lu(_,E,b,A,B,H,Y,et,St){var Rt=A.context;B.draw(Rt,Rt.gl.TRIANGLES,H,Y,et,ln.disabled,St,b.id,_.layoutVertexBuffer,_.indexBuffer,E,b.paint,A.transform.zoom,_.programConfigurations.get(b.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function Lf(_,E,b,A,B,H,Y){var et,St,Rt,ye,be,Oe=_.context.gl,on=b.paint.get("fill-pattern"),Qe=on&&on.constantOr(1),vn=b.getCrossfadeParameters();Y?(St=Qe&&!b.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",et=Oe.LINES):(St=Qe?"fillPattern":"fill",et=Oe.TRIANGLES);for(var Ye=0,On=A;Ye<On.length;Ye+=1){var jn=On[Ye],ar=E.getTile(jn);if(!Qe||ar.patternsLoaded()){var Or=ar.getBucket(b);if(Or){var cr=Or.programConfigurations.get(b.id),kr=_.useProgram(St,cr);Qe&&(_.context.activeTexture.set(Oe.TEXTURE0),ar.imageAtlasTexture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),cr.updatePaintBuffers(vn));var ei=on.constantOr(null);if(ei&&ar.imageAtlas){var Yr=ar.imageAtlas,Ti=Yr.patternPositions[ei.to.toString()],zi=Yr.patternPositions[ei.from.toString()];Ti&&zi&&cr.setConstantPatternPositions(Ti,zi)}var Io=_.translatePosMatrix(jn.posMatrix,ar,b.paint.get("fill-translate"),b.paint.get("fill-translate-anchor"));if(Y){ye=Or.indexBuffer2,be=Or.segments2;var Bo=[Oe.drawingBufferWidth,Oe.drawingBufferHeight];Rt=St==="fillOutlinePattern"&&Qe?X(Io,_,vn,ar,Bo):Ke(Io,Bo)}else ye=Or.indexBuffer,be=Or.segments,Rt=Qe?It(Io,_,vn,ar):lt(Io);kr.draw(_.context,et,B,_.stencilModeForClipping(jn),H,ln.disabled,Rt,b.id,Or.layoutVertexBuffer,ye,be,b.paint,_.transform.zoom,cr)}}}}function yh(_,E,b,A,B,H,Y){for(var et=_.context,St=et.gl,Rt=b.paint.get("fill-extrusion-pattern"),ye=Rt.constantOr(1),be=b.getCrossfadeParameters(),Oe=b.paint.get("fill-extrusion-opacity"),on=0,Qe=A;on<Qe.length;on+=1){var vn=Qe[on],Ye=E.getTile(vn),On=Ye.getBucket(b);if(On){var jn=On.programConfigurations.get(b.id),ar=_.useProgram(ye?"fillExtrusionPattern":"fillExtrusion",jn);ye&&(_.context.activeTexture.set(St.TEXTURE0),Ye.imageAtlasTexture.bind(St.LINEAR,St.CLAMP_TO_EDGE),jn.updatePaintBuffers(be));var Or=Rt.constantOr(null);if(Or&&Ye.imageAtlas){var cr=Ye.imageAtlas,kr=cr.patternPositions[Or.to.toString()],ei=cr.patternPositions[Or.from.toString()];kr&&ei&&jn.setConstantPatternPositions(kr,ei)}var Yr=_.translatePosMatrix(vn.posMatrix,Ye,b.paint.get("fill-extrusion-translate"),b.paint.get("fill-extrusion-translate-anchor")),Ti=b.paint.get("fill-extrusion-vertical-gradient"),zi=ye?K(Yr,_,Ti,Oe,vn,be,Ye):Qf(Yr,_,Ti,Oe);ar.draw(et,et.gl.TRIANGLES,B,H,Y,ln.backCCW,zi,b.id,On.layoutVertexBuffer,On.indexBuffer,On.segments,b.paint,_.transform.zoom,jn)}}}function Du(_,E,b,A,B,H){var Y=_.context,et=Y.gl,St=E.fbo;if(St){var Rt=_.useProgram("hillshade");Y.activeTexture.set(et.TEXTURE0),et.bindTexture(et.TEXTURE_2D,St.colorAttachment.get());var ye=function(be,Oe,on){var Qe=on.paint.get("hillshade-shadow-color"),vn=on.paint.get("hillshade-highlight-color"),Ye=on.paint.get("hillshade-accent-color"),On=on.paint.get("hillshade-illumination-direction")*(Math.PI/180);on.paint.get("hillshade-illumination-anchor")==="viewport"&&(On-=be.transform.angle);var jn,ar,Or,cr=!be.options.moving;return{u_matrix:be.transform.calculatePosMatrix(Oe.tileID.toUnwrapped(),cr),u_image:0,u_latrange:(jn=Oe.tileID,ar=Math.pow(2,jn.canonical.z),Or=jn.canonical.y,[new R.MercatorCoordinate(0,Or/ar).toLngLat().lat,new R.MercatorCoordinate(0,(Or+1)/ar).toLngLat().lat]),u_light:[on.paint.get("hillshade-exaggeration"),On],u_shadow:Qe,u_highlight:vn,u_accent:Ye}}(_,E,b);Rt.draw(Y,et.TRIANGLES,A,B,H,ln.disabled,ye,b.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}}function P0(_,E,b,A,B,H){var Y=_.context,et=Y.gl,St=E.dem;if(St&&St.data){var Rt=St.dim,ye=St.stride,be=St.getPixels();if(Y.activeTexture.set(et.TEXTURE1),Y.pixelStoreUnpackPremultiplyAlpha.set(!1),E.demTexture=E.demTexture||_.getTileTexture(ye),E.demTexture){var Oe=E.demTexture;Oe.update(be,{premultiply:!1}),Oe.bind(et.NEAREST,et.CLAMP_TO_EDGE)}else E.demTexture=new R.Texture(Y,be,et.RGBA,{premultiply:!1}),E.demTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE);Y.activeTexture.set(et.TEXTURE0);var on=E.fbo;if(!on){var Qe=new R.Texture(Y,{width:Rt,height:Rt,data:null},et.RGBA);Qe.bind(et.LINEAR,et.CLAMP_TO_EDGE),(on=E.fbo=Y.createFramebuffer(Rt,Rt,!0)).colorAttachment.set(Qe.texture)}Y.bindFramebuffer.set(on.framebuffer),Y.viewport.set([0,0,Rt,Rt]),_.useProgram("hillshadePrepare").draw(Y,et.TRIANGLES,A,B,H,ln.disabled,function(vn,Ye){var On=Ye.stride,jn=R.create();return R.ortho(jn,0,R.EXTENT,-R.EXTENT,0,0,1),R.translate(jn,jn,[0,-R.EXTENT,0]),{u_matrix:jn,u_image:1,u_dimension:[On,On],u_zoom:vn.overscaledZ,u_unpack:Ye.getUnpackVector()}}(E.tileID,St),b.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),E.needsHillshadePrepare=!1}}function xd(_,E,b,A,B){var H=A.paint.get("raster-fade-duration");if(H>0){var Y=R.browser.now(),et=(Y-_.timeAdded)/H,St=E?(Y-E.timeAdded)/H:-1,Rt=b.getSource(),ye=B.coveringZoomLevel({tileSize:Rt.tileSize,roundZoom:Rt.roundZoom}),be=!E||Math.abs(E.tileID.overscaledZ-ye)>Math.abs(_.tileID.overscaledZ-ye),Oe=be&&_.refreshedUponExpiration?1:R.clamp(be?et:1-St,0,1);return _.refreshedUponExpiration&&et>=1&&(_.refreshedUponExpiration=!1),E?{opacity:1,mix:1-Oe}:{opacity:Oe,mix:0}}return{opacity:1,mix:0}}var Dc=new R.Color(1,0,0,1),Gh=new R.Color(0,1,0,1),gp=new R.Color(0,0,1,1),Wh=new R.Color(1,0,1,1),_h=new R.Color(0,1,1,1);function Nu(_,E,b,A){Jf(_,0,E+b/2,_.transform.width,b,A)}function Df(_,E,b,A){Jf(_,E-b/2,0,b,_.transform.height,A)}function Jf(_,E,b,A,B,H){var Y=_.context,et=Y.gl;et.enable(et.SCISSOR_TEST),et.scissor(E*R.browser.devicePixelRatio,b*R.browser.devicePixelRatio,A*R.browser.devicePixelRatio,B*R.browser.devicePixelRatio),Y.clear({color:H}),et.disable(et.SCISSOR_TEST)}function Yp(_,E,b){var A=_.context,B=A.gl,H=b.posMatrix,Y=_.useProgram("debug"),et=Gt.disabled,St=ue.disabled,Rt=_.colorModeForRenderPass();A.activeTexture.set(B.TEXTURE0),_.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Y.draw(A,B.LINE_STRIP,et,St,Rt,ln.disabled,Jr(H,R.Color.red),"$debug",_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments);var ye=E.getTileByID(b.key).latestRawTileData,be=Math.floor((ye&&ye.byteLength||0)/1024),Oe=E.getTile(b).tileSize,on=512/Math.min(Oe,512)*(b.overscaledZ/_.transform.zoom)*.5,Qe=b.canonical.toString();b.overscaledZ!==b.canonical.z&&(Qe+=" => "+b.overscaledZ),function(vn,Ye){vn.initDebugOverlayCanvas();var On=vn.debugOverlayCanvas,jn=vn.context.gl,ar=vn.debugOverlayCanvas.getContext("2d");ar.clearRect(0,0,On.width,On.height),ar.shadowColor="white",ar.shadowBlur=2,ar.lineWidth=1.5,ar.strokeStyle="white",ar.textBaseline="top",ar.font="bold 36px Open Sans, sans-serif",ar.fillText(Ye,5,5),ar.strokeText(Ye,5,5),vn.debugOverlayTexture.update(On),vn.debugOverlayTexture.bind(jn.LINEAR,jn.CLAMP_TO_EDGE)}(_,Qe+" "+be+"kb"),Y.draw(A,B.TRIANGLES,et,St,Ge.alphaBlended,ln.disabled,Jr(H,R.Color.transparent,on),"$debug",_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments)}var Nf={symbol:function(_,E,b,A,B){if(_.renderPass==="translucent"){var H=ue.disabled,Y=_.colorModeForRenderPass();b.layout.get("text-variable-anchor")&&function(et,St,Rt,ye,be,Oe,on){for(var Qe=St.transform,vn=be==="map",Ye=Oe==="map",On=0,jn=et;On<jn.length;On+=1){var ar=jn[On],Or=ye.getTile(ar),cr=Or.getBucket(Rt);if(cr&&cr.text&&cr.text.segments.get().length){var kr=R.evaluateSizeForZoom(cr.textSizeData,Qe.zoom),ei=Ni(Or,1,St.transform.zoom),Yr=qe(ar.posMatrix,Ye,vn,St.transform,ei),Ti=Rt.layout.get("icon-text-fit")!=="none"&&cr.hasIconData();if(kr){var zi=Math.pow(2,Qe.zoom-Or.tileID.overscaledZ);Zh(cr,vn,Ye,on,R.symbolSize,Qe,Yr,ar.posMatrix,zi,kr,Ti)}}}}(A,_,b,E,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),B),b.paint.get("icon-opacity").constantOr(1)!==0&&If(_,E,b,A,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),H,Y),b.paint.get("text-opacity").constantOr(1)!==0&&If(_,E,b,A,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),H,Y),E.map.showCollisionBoxes&&(du(_,E,b,A,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),!0),du(_,E,b,A,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),!1))}},circle:function(_,E,b,A){if(_.renderPass==="translucent"){var B=b.paint.get("circle-opacity"),H=b.paint.get("circle-stroke-width"),Y=b.paint.get("circle-stroke-opacity"),et=b.layout.get("circle-sort-key").constantOr(1)!==void 0;if(B.constantOr(1)!==0||H.constantOr(1)!==0&&Y.constantOr(1)!==0){for(var St=_.context,Rt=St.gl,ye=_.depthModeForSublayer(0,Gt.ReadOnly),be=ue.disabled,Oe=_.colorModeForRenderPass(),on=[],Qe=0;Qe<A.length;Qe++){var vn=A[Qe],Ye=E.getTile(vn),On=Ye.getBucket(b);if(On){var jn=On.programConfigurations.get(b.id),ar={programConfiguration:jn,program:_.useProgram("circle",jn),layoutVertexBuffer:On.layoutVertexBuffer,indexBuffer:On.indexBuffer,uniformValues:Xn(_,vn,Ye,b)};if(et)for(var Or=0,cr=On.segments.get();Or<cr.length;Or+=1){var kr=cr[Or];on.push({segments:new R.SegmentVector([kr]),sortKey:kr.sortKey,state:ar})}else on.push({segments:On.segments,sortKey:0,state:ar})}}et&&on.sort(function(Io,Bo){return Io.sortKey-Bo.sortKey});for(var ei=0,Yr=on;ei<Yr.length;ei+=1){var Ti=Yr[ei],zi=Ti.state;zi.program.draw(St,Rt.TRIANGLES,ye,be,Oe,ln.disabled,zi.uniformValues,b.id,zi.layoutVertexBuffer,zi.indexBuffer,Ti.segments,b.paint,_.transform.zoom,zi.programConfiguration)}}}},heatmap:function(_,E,b,A){if(b.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){var B=_.context,H=B.gl,Y=ue.disabled,et=new Ge([H.ONE,H.ONE],R.Color.transparent,[!0,!0,!0,!0]);(function(on,Qe,vn){var Ye=on.gl;on.activeTexture.set(Ye.TEXTURE1),on.viewport.set([0,0,Qe.width/4,Qe.height/4]);var On=vn.heatmapFbo;if(On)Ye.bindTexture(Ye.TEXTURE_2D,On.colorAttachment.get()),on.bindFramebuffer.set(On.framebuffer);else{var jn=Ye.createTexture();Ye.bindTexture(Ye.TEXTURE_2D,jn),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR),On=vn.heatmapFbo=on.createFramebuffer(Qe.width/4,Qe.height/4,!1),function(ar,Or,cr,kr){var ei=ar.gl;ei.texImage2D(ei.TEXTURE_2D,0,ei.RGBA,Or.width/4,Or.height/4,0,ei.RGBA,ar.extRenderToTextureHalfFloat?ar.extTextureHalfFloat.HALF_FLOAT_OES:ei.UNSIGNED_BYTE,null),kr.colorAttachment.set(cr)}(on,Qe,jn,On)}})(B,_,b),B.clear({color:R.Color.transparent});for(var St=0;St<A.length;St++){var Rt=A[St];if(!E.hasRenderableParent(Rt)){var ye=E.getTile(Rt),be=ye.getBucket(b);if(be){var Oe=be.programConfigurations.get(b.id);_.useProgram("heatmap",Oe).draw(B,H.TRIANGLES,Gt.disabled,Y,et,ln.disabled,so(Rt.posMatrix,ye,_.transform.zoom,b.paint.get("heatmap-intensity")),b.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,b.paint,_.transform.zoom,Oe)}}}B.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(on,Qe){var vn=on.context,Ye=vn.gl,On=Qe.heatmapFbo;if(On){vn.activeTexture.set(Ye.TEXTURE0),Ye.bindTexture(Ye.TEXTURE_2D,On.colorAttachment.get()),vn.activeTexture.set(Ye.TEXTURE1);var jn=Qe.colorRampTexture;jn||(jn=Qe.colorRampTexture=new R.Texture(vn,Qe.colorRamp,Ye.RGBA)),jn.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),on.useProgram("heatmapTexture").draw(vn,Ye.TRIANGLES,Gt.disabled,ue.disabled,on.colorModeForRenderPass(),ln.disabled,function(ar,Or,cr,kr){var ei=R.create();R.ortho(ei,0,ar.width,ar.height,0,0,1);var Yr=ar.context.gl;return{u_matrix:ei,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Or.paint.get("heatmap-opacity")}}(on,Qe),Qe.id,on.viewportBuffer,on.quadTriangleIndexBuffer,on.viewportSegments,Qe.paint,on.transform.zoom)}}(_,b))},line:function(_,E,b,A){if(_.renderPass==="translucent"){var B=b.paint.get("line-opacity"),H=b.paint.get("line-width");if(B.constantOr(1)!==0&&H.constantOr(1)!==0)for(var Y=_.depthModeForSublayer(0,Gt.ReadOnly),et=_.colorModeForRenderPass(),St=b.paint.get("line-dasharray"),Rt=b.paint.get("line-pattern"),ye=Rt.constantOr(1),be=b.paint.get("line-gradient"),Oe=b.getCrossfadeParameters(),on=ye?"linePattern":St?"lineSDF":be?"lineGradient":"line",Qe=_.context,vn=Qe.gl,Ye=!0,On=0,jn=A;On<jn.length;On+=1){var ar=jn[On],Or=E.getTile(ar);if(!ye||Or.patternsLoaded()){var cr=Or.getBucket(b);if(cr){var kr=cr.programConfigurations.get(b.id),ei=_.context.program.get(),Yr=_.useProgram(on,kr),Ti=Ye||Yr.program!==ei,zi=Rt.constantOr(null);if(zi&&Or.imageAtlas){var Io=Or.imageAtlas,Bo=Io.patternPositions[zi.to.toString()],Fo=Io.patternPositions[zi.from.toString()];Bo&&Fo&&kr.setConstantPatternPositions(Bo,Fo)}var ua=ye?_a(_,Or,b,Oe):St?qa(_,Or,b,St,Oe):be?Po(_,Or,b,cr.lineClipsArray.length):sa(_,Or,b);if(ye)Qe.activeTexture.set(vn.TEXTURE0),Or.imageAtlasTexture.bind(vn.LINEAR,vn.CLAMP_TO_EDGE),kr.updatePaintBuffers(Oe);else if(St&&(Ti||_.lineAtlas.dirty))Qe.activeTexture.set(vn.TEXTURE0),_.lineAtlas.bind(Qe);else if(be){var Tn=cr.gradients[b.id],Me=Tn.texture;if(b.gradientVersion!==Tn.version){var la=256;if(b.stepInterpolant){var ta=E.getSource().maxzoom,Vo=ar.canonical.z===ta?Math.ceil(1<<_.transform.maxZoom-ar.canonical.z):1;la=R.clamp(R.nextPowerOfTwo(cr.maxLineLength/R.EXTENT*1024*Vo),256,Qe.maxTextureSize)}Tn.gradient=R.renderColorRamp({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:la,image:Tn.gradient||void 0,clips:cr.lineClipsArray}),Tn.texture?Tn.texture.update(Tn.gradient):Tn.texture=new R.Texture(Qe,Tn.gradient,vn.RGBA),Tn.version=b.gradientVersion,Me=Tn.texture}Qe.activeTexture.set(vn.TEXTURE0),Me.bind(b.stepInterpolant?vn.NEAREST:vn.LINEAR,vn.CLAMP_TO_EDGE)}Yr.draw(Qe,vn.TRIANGLES,Y,_.stencilModeForClipping(ar),et,ln.disabled,ua,b.id,cr.layoutVertexBuffer,cr.indexBuffer,cr.segments,b.paint,_.transform.zoom,kr,cr.layoutVertexBuffer2),Ye=!1}}}}},fill:function(_,E,b,A){var B=b.paint.get("fill-color"),H=b.paint.get("fill-opacity");if(H.constantOr(1)!==0){var Y=_.colorModeForRenderPass(),et=b.paint.get("fill-pattern"),St=_.opaquePassEnabledForLayer()&&!et.constantOr(1)&&B.constantOr(R.Color.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===St){var Rt=_.depthModeForSublayer(1,_.renderPass==="opaque"?Gt.ReadWrite:Gt.ReadOnly);Lf(_,E,b,A,Rt,Y,!1)}if(_.renderPass==="translucent"&&b.paint.get("fill-antialias")){var ye=_.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,Gt.ReadOnly);Lf(_,E,b,A,ye,Y,!0)}}},"fill-extrusion":function(_,E,b,A){var B=b.paint.get("fill-extrusion-opacity");if(B!==0&&_.renderPass==="translucent"){var H=new Gt(_.context.gl.LEQUAL,Gt.ReadWrite,_.depthRangeFor3D);if(B!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))yh(_,E,b,A,H,ue.disabled,Ge.disabled),yh(_,E,b,A,H,_.stencilModeFor3D(),_.colorModeForRenderPass());else{var Y=_.colorModeForRenderPass();yh(_,E,b,A,H,ue.disabled,Y)}}},hillshade:function(_,E,b,A){if(_.renderPass==="offscreen"||_.renderPass==="translucent"){for(var B=_.context,H=_.depthModeForSublayer(0,Gt.ReadOnly),Y=_.colorModeForRenderPass(),et=_.renderPass==="translucent"?_.stencilConfigForOverlap(A):[{},A],St=et[0],Rt=0,ye=et[1];Rt<ye.length;Rt+=1){var be=ye[Rt],Oe=E.getTile(be);Oe.needsHillshadePrepare&&_.renderPass==="offscreen"?P0(_,Oe,b,H,ue.disabled,Y):_.renderPass==="translucent"&&Du(_,Oe,b,H,St[be.overscaledZ],Y)}B.viewport.set([0,0,_.width,_.height])}},raster:function(_,E,b,A){if(_.renderPass==="translucent"&&b.paint.get("raster-opacity")!==0&&A.length)for(var B=_.context,H=B.gl,Y=E.getSource(),et=_.useProgram("raster"),St=_.colorModeForRenderPass(),Rt=Y instanceof we?[{},A]:_.stencilConfigForOverlap(A),ye=Rt[0],be=Rt[1],Oe=be[be.length-1].overscaledZ,on=!_.options.moving,Qe=0,vn=be;Qe<vn.length;Qe+=1){var Ye=vn[Qe],On=_.depthModeForSublayer(Ye.overscaledZ-Oe,b.paint.get("raster-opacity")===1?Gt.ReadWrite:Gt.ReadOnly,H.LESS),jn=E.getTile(Ye),ar=_.transform.calculatePosMatrix(Ye.toUnwrapped(),on);jn.registerFadeDuration(b.paint.get("raster-fade-duration"));var Or=E.findLoadedParent(Ye,0),cr=xd(jn,Or,E,b,_.transform),kr=void 0,ei=void 0,Yr=b.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;B.activeTexture.set(H.TEXTURE0),jn.texture.bind(Yr,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(H.TEXTURE1),Or?(Or.texture.bind(Yr,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),kr=Math.pow(2,Or.tileID.overscaledZ-jn.tileID.overscaledZ),ei=[jn.tileID.canonical.x*kr%1,jn.tileID.canonical.y*kr%1]):jn.texture.bind(Yr,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);var Ti=ls(ar,ei||[0,0],kr||1,cr,b);Y instanceof we?et.draw(B,H.TRIANGLES,On,ue.disabled,St,ln.disabled,Ti,b.id,Y.boundsBuffer,_.quadTriangleIndexBuffer,Y.boundsSegments):et.draw(B,H.TRIANGLES,On,ye[Ye.overscaledZ],St,ln.disabled,Ti,b.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}},background:function(_,E,b){var A=b.paint.get("background-color"),B=b.paint.get("background-opacity");if(B!==0){var H=_.context,Y=H.gl,et=_.transform,St=et.tileSize,Rt=b.paint.get("background-pattern");if(!_.isPatternMissing(Rt)){var ye=!Rt&&A.a===1&&B===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass===ye){var be=ue.disabled,Oe=_.depthModeForSublayer(0,ye==="opaque"?Gt.ReadWrite:Gt.ReadOnly),on=_.colorModeForRenderPass(),Qe=_.useProgram(Rt?"backgroundPattern":"background"),vn=et.coveringTiles({tileSize:St});Rt&&(H.activeTexture.set(Y.TEXTURE0),_.imageManager.bind(_.context));for(var Ye=b.getCrossfadeParameters(),On=0,jn=vn;On<jn.length;On+=1){var ar=jn[On],Or=_.transform.calculatePosMatrix(ar.toUnwrapped()),cr=Rt?es(Or,B,_,Rt,{tileID:ar,tileSize:St},Ye):Ec(Or,B,A);Qe.draw(H,Y.TRIANGLES,Oe,be,on,ln.disabled,cr,b.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}}}},debug:function(_,E,b){for(var A=0;A<b.length;A++)Yp(_,E,b[A])},custom:function(_,E,b){var A=_.context,B=b.implementation;if(_.renderPass==="offscreen"){var H=B.prerender;H&&(_.setCustomLayerDefaults(),A.setColorMode(_.colorModeForRenderPass()),H.call(B,A.gl,_.transform.customLayerMatrix()),A.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),A.setColorMode(_.colorModeForRenderPass()),A.setStencilMode(ue.disabled);var Y=B.renderingMode==="3d"?new Gt(_.context.gl.LEQUAL,Gt.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,Gt.ReadOnly);A.setDepthMode(Y),B.render(A.gl,_.transform.customLayerMatrix()),A.setDirty(),_.setBaseState(),A.bindFramebuffer.set(null)}}},$a=function(_,E){this.context=new ee(_),this.transform=E,this._tileTextures={},this.setup(),this.numSublayers=Fe.maxUnderzooming+Fe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Mf,this.gpuTimers={}};$a.prototype.resize=function(_,E){if(this.width=_*R.browser.devicePixelRatio,this.height=E*R.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var b=0,A=this.style._order;b<A.length;b+=1)this.style._layers[A[b]].resize()},$a.prototype.setup=function(){var _=this.context,E=new R.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(R.EXTENT,0),E.emplaceBack(0,R.EXTENT),E.emplaceBack(R.EXTENT,R.EXTENT),this.tileExtentBuffer=_.createVertexBuffer(E,Ws.members),this.tileExtentSegments=R.SegmentVector.simpleSegment(0,0,4,2);var b=new R.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(R.EXTENT,0),b.emplaceBack(0,R.EXTENT),b.emplaceBack(R.EXTENT,R.EXTENT),this.debugBuffer=_.createVertexBuffer(b,Ws.members),this.debugSegments=R.SegmentVector.simpleSegment(0,0,4,5);var A=new R.StructArrayLayout4i8;A.emplaceBack(0,0,0,0),A.emplaceBack(R.EXTENT,0,R.EXTENT,0),A.emplaceBack(0,R.EXTENT,0,R.EXTENT),A.emplaceBack(R.EXTENT,R.EXTENT,R.EXTENT,R.EXTENT),this.rasterBoundsBuffer=_.createVertexBuffer(A,Ut.members),this.rasterBoundsSegments=R.SegmentVector.simpleSegment(0,0,4,2);var B=new R.StructArrayLayout2i4;B.emplaceBack(0,0),B.emplaceBack(1,0),B.emplaceBack(0,1),B.emplaceBack(1,1),this.viewportBuffer=_.createVertexBuffer(B,Ws.members),this.viewportSegments=R.SegmentVector.simpleSegment(0,0,4,2);var H=new R.StructArrayLayout1ui2;H.emplaceBack(0),H.emplaceBack(1),H.emplaceBack(3),H.emplaceBack(2),H.emplaceBack(0),this.tileBorderIndexBuffer=_.createIndexBuffer(H);var Y=new R.StructArrayLayout3ui6;Y.emplaceBack(0,1,2),Y.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=_.createIndexBuffer(Y),this.emptyTexture=new R.Texture(_,{width:1,height:1,data:new Uint8Array([0,0,0,0])},_.gl.RGBA);var et=this.context.gl;this.stencilClearMode=new ue({func:et.ALWAYS,mask:0},0,255,et.ZERO,et.ZERO,et.ZERO)},$a.prototype.clearStencil=function(){var _=this.context,E=_.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var b=R.create();R.ortho(b,0,this.width,this.height,0,0,1),R.scale(b,b,[E.drawingBufferWidth,E.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(_,E.TRIANGLES,Gt.disabled,this.stencilClearMode,Ge.disabled,ln.disabled,co(b),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},$a.prototype._renderTileClippingMasks=function(_,E){if(this.currentStencilSource!==_.source&&_.isTileClipped()&&E&&E.length){this.currentStencilSource=_.source;var b=this.context,A=b.gl;this.nextStencilID+E.length>256&&this.clearStencil(),b.setColorMode(Ge.disabled),b.setDepthMode(Gt.disabled);var B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var H=0,Y=E;H<Y.length;H+=1){var et=Y[H],St=this._tileClippingMaskIDs[et.key]=this.nextStencilID++;B.draw(b,A.TRIANGLES,Gt.disabled,new ue({func:A.ALWAYS,mask:0},St,255,A.KEEP,A.KEEP,A.REPLACE),Ge.disabled,ln.disabled,co(et.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},$a.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var _=this.nextStencilID++,E=this.context.gl;return new ue({func:E.NOTEQUAL,mask:255},_,255,E.KEEP,E.KEEP,E.REPLACE)},$a.prototype.stencilModeForClipping=function(_){var E=this.context.gl;return new ue({func:E.EQUAL,mask:255},this._tileClippingMaskIDs[_.key],0,E.KEEP,E.KEEP,E.REPLACE)},$a.prototype.stencilConfigForOverlap=function(_){var E,b=this.context.gl,A=_.sort(function(St,Rt){return Rt.overscaledZ-St.overscaledZ}),B=A[A.length-1].overscaledZ,H=A[0].overscaledZ-B+1;if(H>1){this.currentStencilSource=void 0,this.nextStencilID+H>256&&this.clearStencil();for(var Y={},et=0;et<H;et++)Y[et+B]=new ue({func:b.GEQUAL,mask:255},et+this.nextStencilID,255,b.KEEP,b.KEEP,b.REPLACE);return this.nextStencilID+=H,[Y,A]}return[(E={},E[B]=ue.disabled,E),A]},$a.prototype.colorModeForRenderPass=function(){var _=this.context.gl;return this._showOverdrawInspector?new Ge([_.CONSTANT_COLOR,_.ONE],new R.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ge.unblended:Ge.alphaBlended},$a.prototype.depthModeForSublayer=function(_,E,b){if(!this.opaquePassEnabledForLayer())return Gt.disabled;var A=1-((1+this.currentLayer)*this.numSublayers+_)*this.depthEpsilon;return new Gt(b||this.context.gl.LEQUAL,E,[A,A])},$a.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},$a.prototype.render=function(_,E){var b=this;this.style=_,this.options=E,this.lineAtlas=_.lineAtlas,this.imageManager=_.imageManager,this.glyphManager=_.glyphManager,this.symbolFadeChange=_.placement.symbolFadeChange(R.browser.now()),this.imageManager.beginFrame();var A=this.style._order,B=this.style.sourceCaches;for(var H in B){var Y=B[H];Y.used&&Y.prepare(this.context)}var et,St,Rt={},ye={},be={};for(var Oe in B){var on=B[Oe];Rt[Oe]=on.getVisibleCoordinates(),ye[Oe]=Rt[Oe].slice().reverse(),be[Oe]=on.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Qe=0;Qe<A.length;Qe++)if(this.style._layers[A[Qe]].is3D()){this.opaquePassCutoff=Qe;break}this.renderPass="offscreen";for(var vn=0,Ye=A;vn<Ye.length;vn+=1){var On=this.style._layers[Ye[vn]];if(On.hasOffscreenPass()&&!On.isHidden(this.transform.zoom)){var jn=ye[On.source];(On.type==="custom"||jn.length)&&this.renderLayer(this,B[On.source],On,jn)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:E.showOverdrawInspector?R.Color.black:R.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=E.showOverdrawInspector,this.depthRangeFor3D=[0,1-(_._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=A.length-1;this.currentLayer>=0;this.currentLayer--){var ar=this.style._layers[A[this.currentLayer]],Or=B[ar.source],cr=Rt[ar.source];this._renderTileClippingMasks(ar,cr),this.renderLayer(this,Or,ar,cr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<A.length;this.currentLayer++){var kr=this.style._layers[A[this.currentLayer]],ei=B[kr.source],Yr=(kr.type==="symbol"?be:ye)[kr.source];this._renderTileClippingMasks(kr,Rt[kr.source]),this.renderLayer(this,ei,kr,Yr)}this.options.showTileBoundaries&&(R.values(this.style._layers).forEach(function(Ti){Ti.source&&!Ti.isHidden(b.transform.zoom)&&(Ti.source!==(St&&St.id)&&(St=b.style.sourceCaches[Ti.source]),(!et||et.getSource().maxzoom<St.getSource().maxzoom)&&(et=St))}),et&&Nf.debug(this,et,et.getVisibleCoordinates())),this.options.showPadding&&function(Ti){var zi=Ti.transform.padding;Nu(Ti,Ti.transform.height-(zi.top||0),3,Dc),Nu(Ti,zi.bottom||0,3,Gh),Df(Ti,zi.left||0,3,gp),Df(Ti,Ti.transform.width-(zi.right||0),3,Wh);var Io=Ti.transform.centerPoint;(function(Bo,Fo,ua,Tn){Jf(Bo,Fo-1,ua-10,2,20,Tn),Jf(Bo,Fo-10,ua-1,20,2,Tn)})(Ti,Io.x,Ti.transform.height-Io.y,_h)}(this),this.context.setDefault()},$a.prototype.renderLayer=function(_,E,b,A){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="custom"||A.length)&&(this.id=b.id,this.gpuTimingStart(b),Nf[b.type](_,E,b,A,this.style.placement.variableOffsets),this.gpuTimingEnd())},$a.prototype.gpuTimingStart=function(_){if(this.options.gpuTiming){var E=this.context.extTimerQuery,b=this.gpuTimers[_.id];b||(b=this.gpuTimers[_.id]={calls:0,cpuTime:0,query:E.createQueryEXT()}),b.calls++,E.beginQueryEXT(E.TIME_ELAPSED_EXT,b.query)}},$a.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var _=this.context.extTimerQuery;_.endQueryEXT(_.TIME_ELAPSED_EXT)}},$a.prototype.collectGpuTimers=function(){var _=this.gpuTimers;return this.gpuTimers={},_},$a.prototype.queryGpuTimers=function(_){var E={};for(var b in _){var A=_[b],B=this.context.extTimerQuery,H=B.getQueryObjectEXT(A.query,B.QUERY_RESULT_EXT)/1e6;B.deleteQueryEXT(A.query),E[b]=H}return E},$a.prototype.translatePosMatrix=function(_,E,b,A,B){if(!b[0]&&!b[1])return _;var H=B?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(H){var Y=Math.sin(H),et=Math.cos(H);b=[b[0]*et-b[1]*Y,b[0]*Y+b[1]*et]}var St=[B?b[0]:Ni(E,b[0],this.transform.zoom),B?b[1]:Ni(E,b[1],this.transform.zoom),0],Rt=new Float32Array(16);return R.translate(Rt,_,St),Rt},$a.prototype.saveTileTexture=function(_){var E=this._tileTextures[_.size[0]];E?E.push(_):this._tileTextures[_.size[0]]=[_]},$a.prototype.getTileTexture=function(_){var E=this._tileTextures[_];return E&&E.length>0?E.pop():null},$a.prototype.isPatternMissing=function(_){if(!_)return!1;if(!_.from||!_.to)return!0;var E=this.imageManager.getPattern(_.from.toString()),b=this.imageManager.getPattern(_.to.toString());return!E||!b},$a.prototype.useProgram=function(_,E){this.cache=this.cache||{};var b=""+_+(E?E.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[b]||(this.cache[b]=new il(this.context,_,jh[_],E,Iu[_],this._showOverdrawInspector)),this.cache[b]},$a.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},$a.prototype.setBaseState=function(){var _=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(_.FUNC_ADD)},$a.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=R.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new R.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},$a.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var bd=function(_,E){this.points=_,this.planes=E};bd.fromInvProjectionMatrix=function(_,E,b){var A=Math.pow(2,b),B=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(Y){return R.transformMat4([],Y,_)}).map(function(Y){return R.scale$1([],Y,1/Y[3]/E*A)}),H=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(Y){var et=R.sub([],B[Y[0]],B[Y[1]]),St=R.sub([],B[Y[2]],B[Y[1]]),Rt=R.normalize([],R.cross([],et,St)),ye=-R.dot(Rt,B[Y[1]]);return Rt.concat(ye)});return new bd(B,H)};var pu=function(_,E){this.min=_,this.max=E,this.center=R.scale$2([],R.add([],this.min,this.max),.5)};pu.prototype.quadrant=function(_){for(var E=[_%2==0,_<2],b=R.clone$2(this.min),A=R.clone$2(this.max),B=0;B<E.length;B++)b[B]=E[B]?this.min[B]:this.center[B],A[B]=E[B]?this.center[B]:this.max[B];return A[2]=this.max[2],new pu(b,A)},pu.prototype.distanceX=function(_){return Math.max(Math.min(this.max[0],_[0]),this.min[0])-_[0]},pu.prototype.distanceY=function(_){return Math.max(Math.min(this.max[1],_[1]),this.min[1])-_[1]},pu.prototype.intersects=function(_){for(var E=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],b=!0,A=0;A<_.planes.length;A++){for(var B=_.planes[A],H=0,Y=0;Y<E.length;Y++)H+=R.dot$1(B,E[Y])>=0;if(H===0)return 0;H!==E.length&&(b=!1)}if(b)return 2;for(var et=0;et<3;et++){for(var St=Number.MAX_VALUE,Rt=-Number.MAX_VALUE,ye=0;ye<_.points.length;ye++){var be=_.points[ye][et]-this.min[et];St=Math.min(St,be),Rt=Math.max(Rt,be)}if(Rt<0||St>this.max[et]-this.min[et])return 0}return 1};var tt=function(_,E,b,A){if(_===void 0&&(_=0),E===void 0&&(E=0),b===void 0&&(b=0),A===void 0&&(A=0),isNaN(_)||_<0||isNaN(E)||E<0||isNaN(b)||b<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=_,this.bottom=E,this.left=b,this.right=A};tt.prototype.interpolate=function(_,E,b){return E.top!=null&&_.top!=null&&(this.top=R.number(_.top,E.top,b)),E.bottom!=null&&_.bottom!=null&&(this.bottom=R.number(_.bottom,E.bottom,b)),E.left!=null&&_.left!=null&&(this.left=R.number(_.left,E.left,b)),E.right!=null&&_.right!=null&&(this.right=R.number(_.right,E.right,b)),this},tt.prototype.getCenter=function(_,E){var b=R.clamp((this.left+_-this.right)/2,0,_),A=R.clamp((this.top+E-this.bottom)/2,0,E);return new R.Point(b,A)},tt.prototype.equals=function(_){return this.top===_.top&&this.bottom===_.bottom&&this.left===_.left&&this.right===_.right},tt.prototype.clone=function(){return new tt(this.top,this.bottom,this.left,this.right)},tt.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var mt=function(_,E,b,A,B){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=B===void 0||B,this._minZoom=_||0,this._maxZoom=E||22,this._minPitch=b==null?0:b,this._maxPitch=A==null?60:A,this.setMaxBounds(),this.width=0,this.height=0,this._center=new R.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new tt,this._posMatrixCache={},this._alignedPosMatrixCache={}},Xt={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};mt.prototype.clone=function(){var _=new mt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return _.tileSize=this.tileSize,_.latRange=this.latRange,_.width=this.width,_.height=this.height,_._center=this._center,_.zoom=this.zoom,_.angle=this.angle,_._fov=this._fov,_._pitch=this._pitch,_._unmodified=this._unmodified,_._edgeInsets=this._edgeInsets.clone(),_._calcMatrices(),_},Xt.minZoom.get=function(){return this._minZoom},Xt.minZoom.set=function(_){this._minZoom!==_&&(this._minZoom=_,this.zoom=Math.max(this.zoom,_))},Xt.maxZoom.get=function(){return this._maxZoom},Xt.maxZoom.set=function(_){this._maxZoom!==_&&(this._maxZoom=_,this.zoom=Math.min(this.zoom,_))},Xt.minPitch.get=function(){return this._minPitch},Xt.minPitch.set=function(_){this._minPitch!==_&&(this._minPitch=_,this.pitch=Math.max(this.pitch,_))},Xt.maxPitch.get=function(){return this._maxPitch},Xt.maxPitch.set=function(_){this._maxPitch!==_&&(this._maxPitch=_,this.pitch=Math.min(this.pitch,_))},Xt.renderWorldCopies.get=function(){return this._renderWorldCopies},Xt.renderWorldCopies.set=function(_){_===void 0?_=!0:_===null&&(_=!1),this._renderWorldCopies=_},Xt.worldSize.get=function(){return this.tileSize*this.scale},Xt.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Xt.size.get=function(){return new R.Point(this.width,this.height)},Xt.bearing.get=function(){return-this.angle/Math.PI*180},Xt.bearing.set=function(_){var E=-R.wrap(_,-180,180)*Math.PI/180;this.angle!==E&&(this._unmodified=!1,this.angle=E,this._calcMatrices(),this.rotationMatrix=R.create$2(),R.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Xt.pitch.get=function(){return this._pitch/Math.PI*180},Xt.pitch.set=function(_){var E=R.clamp(_,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==E&&(this._unmodified=!1,this._pitch=E,this._calcMatrices())},Xt.fov.get=function(){return this._fov/Math.PI*180},Xt.fov.set=function(_){_=Math.max(.01,Math.min(60,_)),this._fov!==_&&(this._unmodified=!1,this._fov=_/180*Math.PI,this._calcMatrices())},Xt.zoom.get=function(){return this._zoom},Xt.zoom.set=function(_){var E=Math.min(Math.max(_,this.minZoom),this.maxZoom);this._zoom!==E&&(this._unmodified=!1,this._zoom=E,this.scale=this.zoomScale(E),this.tileZoom=Math.floor(E),this.zoomFraction=E-this.tileZoom,this._constrain(),this._calcMatrices())},Xt.center.get=function(){return this._center},Xt.center.set=function(_){_.lat===this._center.lat&&_.lng===this._center.lng||(this._unmodified=!1,this._center=_,this._constrain(),this._calcMatrices())},Xt.padding.get=function(){return this._edgeInsets.toJSON()},Xt.padding.set=function(_){this._edgeInsets.equals(_)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,_,1),this._calcMatrices())},Xt.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},mt.prototype.isPaddingEqual=function(_){return this._edgeInsets.equals(_)},mt.prototype.interpolatePadding=function(_,E,b){this._unmodified=!1,this._edgeInsets.interpolate(_,E,b),this._constrain(),this._calcMatrices()},mt.prototype.coveringZoomLevel=function(_){var E=(_.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/_.tileSize));return Math.max(0,E)},mt.prototype.getVisibleUnwrappedCoordinates=function(_){var E=[new R.UnwrappedTileID(0,_)];if(this._renderWorldCopies)for(var b=this.pointCoordinate(new R.Point(0,0)),A=this.pointCoordinate(new R.Point(this.width,0)),B=this.pointCoordinate(new R.Point(this.width,this.height)),H=this.pointCoordinate(new R.Point(0,this.height)),Y=Math.floor(Math.min(b.x,A.x,B.x,H.x)),et=Math.floor(Math.max(b.x,A.x,B.x,H.x)),St=Y-1;St<=et+1;St++)St!==0&&E.push(new R.UnwrappedTileID(St,_));return E},mt.prototype.coveringTiles=function(_){var E=this.coveringZoomLevel(_),b=E;if(_.minzoom!==void 0&&E<_.minzoom)return[];_.maxzoom!==void 0&&E>_.maxzoom&&(E=_.maxzoom);var A=R.MercatorCoordinate.fromLngLat(this.center),B=Math.pow(2,E),H=[B*A.x,B*A.y,0],Y=bd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,E),et=_.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(et=E);var St=function(Ti){return{aabb:new pu([Ti*B,0,0],[(Ti+1)*B,B,0]),zoom:0,x:0,y:0,wrap:Ti,fullyVisible:!1}},Rt=[],ye=[],be=E,Oe=_.reparseOverscaled?b:E;if(this._renderWorldCopies)for(var on=1;on<=3;on++)Rt.push(St(-on)),Rt.push(St(on));for(Rt.push(St(0));Rt.length>0;){var Qe=Rt.pop(),vn=Qe.x,Ye=Qe.y,On=Qe.fullyVisible;if(!On){var jn=Qe.aabb.intersects(Y);if(jn===0)continue;On=jn===2}var ar=Qe.aabb.distanceX(H),Or=Qe.aabb.distanceY(H),cr=Math.max(Math.abs(ar),Math.abs(Or));if(Qe.zoom===be||cr>3+(1<<be-Qe.zoom)-2&&Qe.zoom>=et)ye.push({tileID:new R.OverscaledTileID(Qe.zoom===be?Oe:Qe.zoom,Qe.wrap,Qe.zoom,vn,Ye),distanceSq:R.sqrLen([H[0]-.5-vn,H[1]-.5-Ye])});else for(var kr=0;kr<4;kr++){var ei=(vn<<1)+kr%2,Yr=(Ye<<1)+(kr>>1);Rt.push({aabb:Qe.aabb.quadrant(kr),zoom:Qe.zoom+1,x:ei,y:Yr,wrap:Qe.wrap,fullyVisible:On})}}return ye.sort(function(Ti,zi){return Ti.distanceSq-zi.distanceSq}).map(function(Ti){return Ti.tileID})},mt.prototype.resize=function(_,E){this.width=_,this.height=E,this.pixelsToGLUnits=[2/_,-2/E],this._constrain(),this._calcMatrices()},Xt.unmodified.get=function(){return this._unmodified},mt.prototype.zoomScale=function(_){return Math.pow(2,_)},mt.prototype.scaleZoom=function(_){return Math.log(_)/Math.LN2},mt.prototype.project=function(_){var E=R.clamp(_.lat,-this.maxValidLatitude,this.maxValidLatitude);return new R.Point(R.mercatorXfromLng(_.lng)*this.worldSize,R.mercatorYfromLat(E)*this.worldSize)},mt.prototype.unproject=function(_){return new R.MercatorCoordinate(_.x/this.worldSize,_.y/this.worldSize).toLngLat()},Xt.point.get=function(){return this.project(this.center)},mt.prototype.setLocationAtPoint=function(_,E){var b=this.pointCoordinate(E),A=this.pointCoordinate(this.centerPoint),B=this.locationCoordinate(_),H=new R.MercatorCoordinate(B.x-(b.x-A.x),B.y-(b.y-A.y));this.center=this.coordinateLocation(H),this._renderWorldCopies&&(this.center=this.center.wrap())},mt.prototype.locationPoint=function(_){return this.coordinatePoint(this.locationCoordinate(_))},mt.prototype.pointLocation=function(_){return this.coordinateLocation(this.pointCoordinate(_))},mt.prototype.locationCoordinate=function(_){return R.MercatorCoordinate.fromLngLat(_)},mt.prototype.coordinateLocation=function(_){return _.toLngLat()},mt.prototype.pointCoordinate=function(_){var E=[_.x,_.y,0,1],b=[_.x,_.y,1,1];R.transformMat4(E,E,this.pixelMatrixInverse),R.transformMat4(b,b,this.pixelMatrixInverse);var A=E[3],B=b[3],H=E[1]/A,Y=b[1]/B,et=E[2]/A,St=b[2]/B,Rt=et===St?0:(0-et)/(St-et);return new R.MercatorCoordinate(R.number(E[0]/A,b[0]/B,Rt)/this.worldSize,R.number(H,Y,Rt)/this.worldSize)},mt.prototype.coordinatePoint=function(_){var E=[_.x*this.worldSize,_.y*this.worldSize,0,1];return R.transformMat4(E,E,this.pixelMatrix),new R.Point(E[0]/E[3],E[1]/E[3])},mt.prototype.getBounds=function(){return new R.LngLatBounds().extend(this.pointLocation(new R.Point(0,0))).extend(this.pointLocation(new R.Point(this.width,0))).extend(this.pointLocation(new R.Point(this.width,this.height))).extend(this.pointLocation(new R.Point(0,this.height)))},mt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new R.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},mt.prototype.setMaxBounds=function(_){_?(this.lngRange=[_.getWest(),_.getEast()],this.latRange=[_.getSouth(),_.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},mt.prototype.calculatePosMatrix=function(_,E){E===void 0&&(E=!1);var b=_.key,A=E?this._alignedPosMatrixCache:this._posMatrixCache;if(A[b])return A[b];var B=_.canonical,H=this.worldSize/this.zoomScale(B.z),Y=B.x+Math.pow(2,B.z)*_.wrap,et=R.identity(new Float64Array(16));return R.translate(et,et,[Y*H,B.y*H,0]),R.scale(et,et,[H/R.EXTENT,H/R.EXTENT,1]),R.multiply(et,E?this.alignedProjMatrix:this.projMatrix,et),A[b]=new Float32Array(et),A[b]},mt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},mt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var _,E,b,A,B=-90,H=90,Y=-180,et=180,St=this.size,Rt=this._unmodified;if(this.latRange){var ye=this.latRange;B=R.mercatorYfromLat(ye[1])*this.worldSize,_=(H=R.mercatorYfromLat(ye[0])*this.worldSize)-B<St.y?St.y/(H-B):0}if(this.lngRange){var be=this.lngRange;Y=R.mercatorXfromLng(be[0])*this.worldSize,E=(et=R.mercatorXfromLng(be[1])*this.worldSize)-Y<St.x?St.x/(et-Y):0}var Oe=this.point,on=Math.max(E||0,_||0);if(on)return this.center=this.unproject(new R.Point(E?(et+Y)/2:Oe.x,_?(H+B)/2:Oe.y)),this.zoom+=this.scaleZoom(on),this._unmodified=Rt,void(this._constraining=!1);if(this.latRange){var Qe=Oe.y,vn=St.y/2;Qe-vn<B&&(A=B+vn),Qe+vn>H&&(A=H-vn)}if(this.lngRange){var Ye=Oe.x,On=St.x/2;Ye-On<Y&&(b=Y+On),Ye+On>et&&(b=et-On)}b===void 0&&A===void 0||(this.center=this.unproject(new R.Point(b!==void 0?b:Oe.x,A!==void 0?A:Oe.y))),this._unmodified=Rt,this._constraining=!1}},mt.prototype._calcMatrices=function(){if(this.height){var _=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var E=Math.PI/2+this._pitch,b=this._fov*(.5+_.y/this.height),A=Math.sin(b)*this.cameraToCenterDistance/Math.sin(R.clamp(Math.PI-E-b,.01,Math.PI-.01)),B=this.point,H=B.x,Y=B.y,et=1.01*(Math.cos(Math.PI/2-this._pitch)*A+this.cameraToCenterDistance),St=this.height/50,Rt=new Float64Array(16);R.perspective(Rt,this._fov,this.width/this.height,St,et),Rt[8]=2*-_.x/this.width,Rt[9]=2*_.y/this.height,R.scale(Rt,Rt,[1,-1,1]),R.translate(Rt,Rt,[0,0,-this.cameraToCenterDistance]),R.rotateX(Rt,Rt,this._pitch),R.rotateZ(Rt,Rt,this.angle),R.translate(Rt,Rt,[-H,-Y,0]),this.mercatorMatrix=R.scale([],Rt,[this.worldSize,this.worldSize,this.worldSize]),R.scale(Rt,Rt,[1,1,R.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Rt,this.invProjMatrix=R.invert([],this.projMatrix);var ye=this.width%2/2,be=this.height%2/2,Oe=Math.cos(this.angle),on=Math.sin(this.angle),Qe=H-Math.round(H)+Oe*ye+on*be,vn=Y-Math.round(Y)+Oe*be+on*ye,Ye=new Float64Array(Rt);if(R.translate(Ye,Ye,[Qe>.5?Qe-1:Qe,vn>.5?vn-1:vn,0]),this.alignedProjMatrix=Ye,Rt=R.create(),R.scale(Rt,Rt,[this.width/2,-this.height/2,1]),R.translate(Rt,Rt,[1,-1,0]),this.labelPlaneMatrix=Rt,Rt=R.create(),R.scale(Rt,Rt,[1,-1,1]),R.translate(Rt,Rt,[-1,-1,0]),R.scale(Rt,Rt,[2/this.width,2/this.height,1]),this.glCoordMatrix=Rt,this.pixelMatrix=R.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Rt=R.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Rt,this._posMatrixCache={},this._alignedPosMatrixCache={}}},mt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var _=this.pointCoordinate(new R.Point(0,0)),E=[_.x*this.worldSize,_.y*this.worldSize,0,1];return R.transformMat4(E,E,this.pixelMatrix)[3]/this.cameraToCenterDistance},mt.prototype.getCameraPoint=function(){var _=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new R.Point(0,_))},mt.prototype.getCameraQueryGeometry=function(_){var E=this.getCameraPoint();if(_.length===1)return[_[0],E];for(var b=E.x,A=E.y,B=E.x,H=E.y,Y=0,et=_;Y<et.length;Y+=1){var St=et[Y];b=Math.min(b,St.x),A=Math.min(A,St.y),B=Math.max(B,St.x),H=Math.max(H,St.y)}return[new R.Point(b,A),new R.Point(B,A),new R.Point(B,H),new R.Point(b,H),new R.Point(b,A)]},Object.defineProperties(mt.prototype,Xt);var dn=function(_){var E,b,A,B;this._hashName=_&&encodeURIComponent(_),R.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(E=this._updateHashUnthrottled.bind(this),b=!1,A=null,B=function(){A=null,b&&(E(),A=setTimeout(B,300),b=!1)},function(){return b=!0,A||B(),A})};dn.prototype.addTo=function(_){return this._map=_,R.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},dn.prototype.remove=function(){return R.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},dn.prototype.getHashString=function(_){var E=this._map.getCenter(),b=Math.round(100*this._map.getZoom())/100,A=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),B=Math.pow(10,A),H=Math.round(E.lng*B)/B,Y=Math.round(E.lat*B)/B,et=this._map.getBearing(),St=this._map.getPitch(),Rt="";if(Rt+=_?"/"+H+"/"+Y+"/"+b:b+"/"+Y+"/"+H,(et||St)&&(Rt+="/"+Math.round(10*et)/10),St&&(Rt+="/"+Math.round(St)),this._hashName){var ye=this._hashName,be=!1,Oe=R.window.location.hash.slice(1).split("&").map(function(on){var Qe=on.split("=")[0];return Qe===ye?(be=!0,Qe+"="+Rt):on}).filter(function(on){return on});return be||Oe.push(ye+"="+Rt),"#"+Oe.join("&")}return"#"+Rt},dn.prototype._getCurrentHash=function(){var _,E=this,b=R.window.location.hash.replace("#","");return this._hashName?(b.split("&").map(function(A){return A.split("=")}).forEach(function(A){A[0]===E._hashName&&(_=A)}),(_&&_[1]||"").split("/")):b.split("/")},dn.prototype._onHashChange=function(){var _=this._getCurrentHash();if(_.length>=3&&!_.some(function(b){return isNaN(b)})){var E=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(_[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:E,pitch:+(_[4]||0)}),!0}return!1},dn.prototype._updateHashUnthrottled=function(){var _=R.window.location.href.replace(/(#.+)?$/,this.getHashString());try{R.window.history.replaceState(R.window.history.state,null,_)}catch(E){}};var nr={linearity:.3,easing:R.bezier(0,0,.3,1)},Br=R.extend({deceleration:2500,maxSpeed:1400},nr),vi=R.extend({deceleration:20,maxSpeed:1400},nr),qi=R.extend({deceleration:1e3,maxSpeed:360},nr),da=R.extend({deceleration:1e3,maxSpeed:90},nr),xa=function(_){this._map=_,this.clear()};function ms(_,E){(!_.duration||_.duration<E.duration)&&(_.duration=E.duration,_.easing=E.easing)}function Fa(_,E,b){var A=b.maxSpeed,B=b.linearity,H=b.deceleration,Y=R.clamp(_*B/(E/1e3),-A,A),et=Math.abs(Y)/(H*B);return{easing:b.easing,duration:1e3*et,amount:Y*(et/2)}}xa.prototype.clear=function(){this._inertiaBuffer=[]},xa.prototype.record=function(_){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:R.browser.now(),settings:_})},xa.prototype._drainInertiaBuffer=function(){for(var _=this._inertiaBuffer,E=R.browser.now();_.length>0&&E-_[0].time>160;)_.shift()},xa.prototype._onMoveEnd=function(_){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var E={zoom:0,bearing:0,pitch:0,pan:new R.Point(0,0),pinchAround:void 0,around:void 0},b=0,A=this._inertiaBuffer;b<A.length;b+=1){var B=A[b].settings;E.zoom+=B.zoomDelta||0,E.bearing+=B.bearingDelta||0,E.pitch+=B.pitchDelta||0,B.panDelta&&E.pan._add(B.panDelta),B.around&&(E.around=B.around),B.pinchAround&&(E.pinchAround=B.pinchAround)}var H=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,Y={};if(E.pan.mag()){var et=Fa(E.pan.mag(),H,R.extend({},Br,_||{}));Y.offset=E.pan.mult(et.amount/E.pan.mag()),Y.center=this._map.transform.center,ms(Y,et)}if(E.zoom){var St=Fa(E.zoom,H,vi);Y.zoom=this._map.transform.zoom+St.amount,ms(Y,St)}if(E.bearing){var Rt=Fa(E.bearing,H,qi);Y.bearing=this._map.transform.bearing+R.clamp(Rt.amount,-179,179),ms(Y,Rt)}if(E.pitch){var ye=Fa(E.pitch,H,da);Y.pitch=this._map.transform.pitch+ye.amount,ms(Y,ye)}if(Y.zoom||Y.bearing){var be=E.pinchAround===void 0?E.around:E.pinchAround;Y.around=be?this._map.unproject(be):this._map.getCenter()}return this.clear(),R.extend(Y,{noMoveStart:!0})}};var Ba=function(_){function E(A,B,H,Y){Y===void 0&&(Y={});var et=yt.mousePos(B.getCanvasContainer(),H),St=B.unproject(et);_.call(this,A,R.extend({point:et,lngLat:St,originalEvent:H},Y)),this._defaultPrevented=!1,this.target=B}_&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E;var b={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},b.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,b),E}(R.Event),cc=function(_){function E(A,B,H){var Y=A==="touchend"?H.changedTouches:H.touches,et=yt.touchPos(B.getCanvasContainer(),Y),St=et.map(function(be){return B.unproject(be)}),Rt=et.reduce(function(be,Oe,on,Qe){return be.add(Oe.div(Qe.length))},new R.Point(0,0)),ye=B.unproject(Rt);_.call(this,A,{points:et,point:Rt,lngLats:St,lngLat:ye,originalEvent:H}),this._defaultPrevented=!1}_&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E;var b={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},b.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,b),E}(R.Event),ku=function(_){function E(A,B,H){_.call(this,A,{originalEvent:H}),this._defaultPrevented=!1}_&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E;var b={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},b.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,b),E}(R.Event),$s=function(_,E){this._map=_,this._clickTolerance=E.clickTolerance};$s.prototype.reset=function(){delete this._mousedownPos},$s.prototype.wheel=function(_){return this._firePreventable(new ku(_.type,this._map,_))},$s.prototype.mousedown=function(_,E){return this._mousedownPos=E,this._firePreventable(new Ba(_.type,this._map,_))},$s.prototype.mouseup=function(_){this._map.fire(new Ba(_.type,this._map,_))},$s.prototype.click=function(_,E){this._mousedownPos&&this._mousedownPos.dist(E)>=this._clickTolerance||this._map.fire(new Ba(_.type,this._map,_))},$s.prototype.dblclick=function(_){return this._firePreventable(new Ba(_.type,this._map,_))},$s.prototype.mouseover=function(_){this._map.fire(new Ba(_.type,this._map,_))},$s.prototype.mouseout=function(_){this._map.fire(new Ba(_.type,this._map,_))},$s.prototype.touchstart=function(_){return this._firePreventable(new cc(_.type,this._map,_))},$s.prototype.touchmove=function(_){this._map.fire(new cc(_.type,this._map,_))},$s.prototype.touchend=function(_){this._map.fire(new cc(_.type,this._map,_))},$s.prototype.touchcancel=function(_){this._map.fire(new cc(_.type,this._map,_))},$s.prototype._firePreventable=function(_){if(this._map.fire(_),_.defaultPrevented)return{}},$s.prototype.isEnabled=function(){return!0},$s.prototype.isActive=function(){return!1},$s.prototype.enable=function(){},$s.prototype.disable=function(){};var fo=function(_){this._map=_};fo.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},fo.prototype.mousemove=function(_){this._map.fire(new Ba(_.type,this._map,_))},fo.prototype.mousedown=function(){this._delayContextMenu=!0},fo.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ba("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},fo.prototype.contextmenu=function(_){this._delayContextMenu?this._contextMenuEvent=_:this._map.fire(new Ba(_.type,this._map,_)),this._map.listens("contextmenu")&&_.preventDefault()},fo.prototype.isEnabled=function(){return!0},fo.prototype.isActive=function(){return!1},fo.prototype.enable=function(){},fo.prototype.disable=function(){};var ru=function(_,E){this._map=_,this._el=_.getCanvasContainer(),this._container=_.getContainer(),this._clickTolerance=E.clickTolerance||1};function Ed(_,E){for(var b={},A=0;A<_.length;A++)b[_[A].identifier]=E[A];return b}ru.prototype.isEnabled=function(){return!!this._enabled},ru.prototype.isActive=function(){return!!this._active},ru.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ru.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ru.prototype.mousedown=function(_,E){this.isEnabled()&&_.shiftKey&&_.button===0&&(yt.disableDrag(),this._startPos=this._lastPos=E,this._active=!0)},ru.prototype.mousemoveWindow=function(_,E){if(this._active){var b=E;if(!(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)){var A=this._startPos;this._lastPos=b,this._box||(this._box=yt.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",_));var B=Math.min(A.x,b.x),H=Math.max(A.x,b.x),Y=Math.min(A.y,b.y),et=Math.max(A.y,b.y);yt.setTransform(this._box,"translate("+B+"px,"+Y+"px)"),this._box.style.width=H-B+"px",this._box.style.height=et-Y+"px"}}},ru.prototype.mouseupWindow=function(_,E){var b=this;if(this._active&&_.button===0){var A=this._startPos,B=E;if(this.reset(),yt.suppressClick(),A.x!==B.x||A.y!==B.y)return this._map.fire(new R.Event("boxzoomend",{originalEvent:_})),{cameraAnimation:function(H){return H.fitScreenCoordinates(A,B,b._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",_)}},ru.prototype.keydown=function(_){this._active&&_.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",_))},ru.prototype.blur=function(){this.reset()},ru.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(yt.remove(this._box),this._box=null),yt.enableDrag(),delete this._startPos,delete this._lastPos},ru.prototype._fireEvent=function(_,E){return this._map.fire(new R.Event(_,{originalEvent:E}))};var th=function(_){this.reset(),this.numTouches=_.numTouches};th.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},th.prototype.touchstart=function(_,E,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=_.timeStamp),b.length===this.numTouches&&(this.centroid=function(A){for(var B=new R.Point(0,0),H=0,Y=A;H<Y.length;H+=1)B._add(Y[H]);return B.div(A.length)}(E),this.touches=Ed(b,E)))},th.prototype.touchmove=function(_,E,b){if(!this.aborted&&this.centroid){var A=Ed(b,E);for(var B in this.touches){var H=A[B];(!H||H.dist(this.touches[B])>30)&&(this.aborted=!0)}}},th.prototype.touchend=function(_,E,b){if((!this.centroid||_.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){var A=!this.aborted&&this.centroid;if(this.reset(),A)return A}};var pl=function(_){this.singleTap=new th(_),this.numTaps=_.numTaps,this.reset()};pl.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},pl.prototype.touchstart=function(_,E,b){this.singleTap.touchstart(_,E,b)},pl.prototype.touchmove=function(_,E,b){this.singleTap.touchmove(_,E,b)},pl.prototype.touchend=function(_,E,b){var A=this.singleTap.touchend(_,E,b);if(A){var B=_.timeStamp-this.lastTime<500,H=!this.lastTap||this.lastTap.dist(A)<30;if(B&&H||this.reset(),this.count++,this.lastTime=_.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}};var ns=function(){this._zoomIn=new pl({numTouches:1,numTaps:2}),this._zoomOut=new pl({numTouches:2,numTaps:1}),this.reset()};ns.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ns.prototype.touchstart=function(_,E,b){this._zoomIn.touchstart(_,E,b),this._zoomOut.touchstart(_,E,b)},ns.prototype.touchmove=function(_,E,b){this._zoomIn.touchmove(_,E,b),this._zoomOut.touchmove(_,E,b)},ns.prototype.touchend=function(_,E,b){var A=this,B=this._zoomIn.touchend(_,E,b),H=this._zoomOut.touchend(_,E,b);return B?(this._active=!0,_.preventDefault(),setTimeout(function(){return A.reset()},0),{cameraAnimation:function(Y){return Y.easeTo({duration:300,zoom:Y.getZoom()+1,around:Y.unproject(B)},{originalEvent:_})}}):H?(this._active=!0,_.preventDefault(),setTimeout(function(){return A.reset()},0),{cameraAnimation:function(Y){return Y.easeTo({duration:300,zoom:Y.getZoom()-1,around:Y.unproject(H)},{originalEvent:_})}}):void 0},ns.prototype.touchcancel=function(){this.reset()},ns.prototype.enable=function(){this._enabled=!0},ns.prototype.disable=function(){this._enabled=!1,this.reset()},ns.prototype.isEnabled=function(){return this._enabled},ns.prototype.isActive=function(){return this._active};var yp={0:1,2:2},Ri=function(_){this.reset(),this._clickTolerance=_.clickTolerance||1};Ri.prototype.blur=function(){this.reset()},Ri.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ri.prototype._correctButton=function(_,E){return!1},Ri.prototype._move=function(_,E){return{}},Ri.prototype.mousedown=function(_,E){if(!this._lastPoint){var b=yt.mouseButton(_);this._correctButton(_,b)&&(this._lastPoint=E,this._eventButton=b)}},Ri.prototype.mousemoveWindow=function(_,E){var b=this._lastPoint;if(b){if(_.preventDefault(),function(A,B){var H=yp[B];return A.buttons===void 0||(A.buttons&H)!==H}(_,this._eventButton))this.reset();else if(this._moved||!(E.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=E,this._move(b,E)}},Ri.prototype.mouseupWindow=function(_){this._lastPoint&&yt.mouseButton(_)===this._eventButton&&(this._moved&&yt.suppressClick(),this.reset())},Ri.prototype.enable=function(){this._enabled=!0},Ri.prototype.disable=function(){this._enabled=!1,this.reset()},Ri.prototype.isEnabled=function(){return this._enabled},Ri.prototype.isActive=function(){return this._active};var eh=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.mousedown=function(b,A){_.prototype.mousedown.call(this,b,A),this._lastPoint&&(this._active=!0)},E.prototype._correctButton=function(b,A){return A===0&&!b.ctrlKey},E.prototype._move=function(b,A){return{around:A,panDelta:A.sub(b)}},E}(Ri),Sd=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype._correctButton=function(b,A){return A===0&&b.ctrlKey||A===2},E.prototype._move=function(b,A){var B=.8*(A.x-b.x);if(B)return this._active=!0,{bearingDelta:B}},E.prototype.contextmenu=function(b){b.preventDefault()},E}(Ri),qp=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype._correctButton=function(b,A){return A===0&&b.ctrlKey||A===2},E.prototype._move=function(b,A){var B=-.5*(A.y-b.y);if(B)return this._active=!0,{pitchDelta:B}},E.prototype.contextmenu=function(b){b.preventDefault()},E}(Ri),Nc=function(_){this._minTouches=1,this._clickTolerance=_.clickTolerance||1,this.reset()};Nc.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new R.Point(0,0)},Nc.prototype.touchstart=function(_,E,b){return this._calculateTransform(_,E,b)},Nc.prototype.touchmove=function(_,E,b){if(this._active&&!(b.length<this._minTouches))return _.preventDefault(),this._calculateTransform(_,E,b)},Nc.prototype.touchend=function(_,E,b){this._calculateTransform(_,E,b),this._active&&b.length<this._minTouches&&this.reset()},Nc.prototype.touchcancel=function(){this.reset()},Nc.prototype._calculateTransform=function(_,E,b){b.length>0&&(this._active=!0);var A=Ed(b,E),B=new R.Point(0,0),H=new R.Point(0,0),Y=0;for(var et in A){var St=A[et],Rt=this._touches[et];Rt&&(B._add(St),H._add(St.sub(Rt)),Y++,A[et]=St)}if(this._touches=A,!(Y<this._minTouches)&&H.mag()){var ye=H.div(Y);if(this._sum._add(ye),!(this._sum.mag()<this._clickTolerance))return{around:B.div(Y),panDelta:ye}}},Nc.prototype.enable=function(){this._enabled=!0},Nc.prototype.disable=function(){this._enabled=!1,this.reset()},Nc.prototype.isEnabled=function(){return this._enabled},Nc.prototype.isActive=function(){return this._active};var mu=function(){this.reset()};function _p(_,E,b){for(var A=0;A<_.length;A++)if(_[A].identifier===b)return E[A]}function $p(_,E){return Math.log(_/E)/Math.LN2}mu.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},mu.prototype._start=function(_){},mu.prototype._move=function(_,E,b){return{}},mu.prototype.touchstart=function(_,E,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([E[0],E[1]]))},mu.prototype.touchmove=function(_,E,b){if(this._firstTwoTouches){_.preventDefault();var A=this._firstTwoTouches,B=A[1],H=_p(b,E,A[0]),Y=_p(b,E,B);if(H&&Y){var et=this._aroundCenter?null:H.add(Y).div(2);return this._move([H,Y],et,_)}}},mu.prototype.touchend=function(_,E,b){if(this._firstTwoTouches){var A=this._firstTwoTouches,B=A[1],H=_p(b,E,A[0]),Y=_p(b,E,B);H&&Y||(this._active&&yt.suppressClick(),this.reset())}},mu.prototype.touchcancel=function(){this.reset()},mu.prototype.enable=function(_){this._enabled=!0,this._aroundCenter=!!_&&_.around==="center"},mu.prototype.disable=function(){this._enabled=!1,this.reset()},mu.prototype.isEnabled=function(){return this._enabled},mu.prototype.isActive=function(){return this._active};var kc=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.reset=function(){_.prototype.reset.call(this),delete this._distance,delete this._startDistance},E.prototype._start=function(b){this._startDistance=this._distance=b[0].dist(b[1])},E.prototype._move=function(b,A){var B=this._distance;if(this._distance=b[0].dist(b[1]),this._active||!(Math.abs($p(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$p(this._distance,B),pinchAround:A}},E}(mu);function nh(_,E){return 180*_.angleWith(E)/Math.PI}var Jm=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.reset=function(){_.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},E.prototype._start=function(b){this._startVector=this._vector=b[0].sub(b[1]),this._minDiameter=b[0].dist(b[1])},E.prototype._move=function(b,A){var B=this._vector;if(this._vector=b[0].sub(b[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:nh(this._vector,B),pinchAround:A}},E.prototype._isBelowThreshold=function(b){this._minDiameter=Math.min(this._minDiameter,b.mag());var A=25/(Math.PI*this._minDiameter)*360,B=nh(b,this._startVector);return Math.abs(B)<A},E}(mu);function Td(_){return Math.abs(_.y)>Math.abs(_.x)}var xp=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.reset=function(){_.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},E.prototype._start=function(b){this._lastPoints=b,Td(b[0].sub(b[1]))&&(this._valid=!1)},E.prototype._move=function(b,A,B){var H=b[0].sub(this._lastPoints[0]),Y=b[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(H,Y,B.timeStamp),this._valid)return this._lastPoints=b,this._active=!0,{pitchDelta:(H.y+Y.y)/2*-.5}},E.prototype.gestureBeginsVertically=function(b,A,B){if(this._valid!==void 0)return this._valid;var H=b.mag()>=2,Y=A.mag()>=2;if(H||Y){if(!H||!Y)return this._firstMove===void 0&&(this._firstMove=B),B-this._firstMove<100&&void 0;var et=b.y>0==A.y>0;return Td(b)&&Td(A)&&et}},E}(mu),sm={panStep:100,bearingStep:15,pitchStep:10},Bu=function(){var _=sm;this._panStep=_.panStep,this._bearingStep=_.bearingStep,this._pitchStep=_.pitchStep,this._rotationDisabled=!1};function vu(_){return _*(2-_)}Bu.prototype.blur=function(){this.reset()},Bu.prototype.reset=function(){this._active=!1},Bu.prototype.keydown=function(_){var E=this;if(!(_.altKey||_.ctrlKey||_.metaKey)){var b=0,A=0,B=0,H=0,Y=0;switch(_.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:_.shiftKey?A=-1:(_.preventDefault(),H=-1);break;case 39:_.shiftKey?A=1:(_.preventDefault(),H=1);break;case 38:_.shiftKey?B=1:(_.preventDefault(),Y=-1);break;case 40:_.shiftKey?B=-1:(_.preventDefault(),Y=1);break;default:return}return this._rotationDisabled&&(A=0,B=0),{cameraAnimation:function(et){var St=et.getZoom();et.easeTo({duration:300,easeId:"keyboardHandler",easing:vu,zoom:b?Math.round(St)+b*(_.shiftKey?2:1):St,bearing:et.getBearing()+A*E._bearingStep,pitch:et.getPitch()+B*E._pitchStep,offset:[-H*E._panStep,-Y*E._panStep],center:et.getCenter()},{originalEvent:_})}}}},Bu.prototype.enable=function(){this._enabled=!0},Bu.prototype.disable=function(){this._enabled=!1,this.reset()},Bu.prototype.isEnabled=function(){return this._enabled},Bu.prototype.isActive=function(){return this._active},Bu.prototype.disableRotation=function(){this._rotationDisabled=!0},Bu.prototype.enableRotation=function(){this._rotationDisabled=!1};var va=function(_,E){this._map=_,this._el=_.getCanvasContainer(),this._handler=E,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,R.bindAll(["_onTimeout"],this)};va.prototype.setZoomRate=function(_){this._defaultZoomRate=_},va.prototype.setWheelZoomRate=function(_){this._wheelZoomRate=_},va.prototype.isEnabled=function(){return!!this._enabled},va.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},va.prototype.isZooming=function(){return!!this._zooming},va.prototype.enable=function(_){this.isEnabled()||(this._enabled=!0,this._aroundCenter=_&&_.around==="center")},va.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},va.prototype.wheel=function(_){if(this.isEnabled()){var E=_.deltaMode===R.window.WheelEvent.DOM_DELTA_LINE?40*_.deltaY:_.deltaY,b=R.browser.now(),A=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,E!==0&&E%4.000244140625==0?this._type="wheel":E!==0&&Math.abs(E)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=E,this._timeout=setTimeout(this._onTimeout,40,_)):this._type||(this._type=Math.abs(A*E)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,E+=this._lastValue)),_.shiftKey&&E&&(E/=4),this._type&&(this._lastWheelEvent=_,this._delta-=E,this._active||this._start(_)),_.preventDefault()}},va.prototype._onTimeout=function(_){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(_)},va.prototype._start=function(_){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var E=yt.mousePos(this._el,_);this._around=R.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(E)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},va.prototype.renderFrame=function(){var _=this;if(this._frameId&&(this._frameId=null,this.isActive())){var E=this._map.transform;if(this._delta!==0){var b=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,A=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&A!==0&&(A=1/A);var B=typeof this._targetZoom=="number"?E.zoomScale(this._targetZoom):E.scale;this._targetZoom=Math.min(E.maxZoom,Math.max(E.minZoom,E.scaleZoom(B*A))),this._type==="wheel"&&(this._startZoom=E.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var H,Y=typeof this._targetZoom=="number"?this._targetZoom:E.zoom,et=this._startZoom,St=this._easing,Rt=!1;if(this._type==="wheel"&&et&&St){var ye=Math.min((R.browser.now()-this._lastWheelEventTime)/200,1),be=St(ye);H=R.number(et,Y,be),ye<1?this._frameId||(this._frameId=!0):Rt=!0}else H=Y,Rt=!0;return this._active=!0,Rt&&(this._active=!1,this._finishTimeout=setTimeout(function(){_._zooming=!1,_._handler._triggerRenderFrame(),delete _._targetZoom,delete _._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Rt,zoomDelta:H-E.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},va.prototype._smoothOutEasing=function(_){var E=R.ease;if(this._prevEase){var b=this._prevEase,A=(R.browser.now()-b.start)/b.duration,B=b.easing(A+.01)-b.easing(A),H=.27/Math.sqrt(B*B+1e-4)*.01,Y=Math.sqrt(.0729-H*H);E=R.bezier(H,Y,.25,1)}return this._prevEase={start:R.browser.now(),duration:_,easing:E},E},va.prototype.blur=function(){this.reset()},va.prototype.reset=function(){this._active=!1};var Fu=function(_,E){this._clickZoom=_,this._tapZoom=E};Fu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Fu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Fu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Fu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Uu=function(){this.reset()};Uu.prototype.reset=function(){this._active=!1},Uu.prototype.blur=function(){this.reset()},Uu.prototype.dblclick=function(_,E){return _.preventDefault(),{cameraAnimation:function(b){b.easeTo({duration:300,zoom:b.getZoom()+(_.shiftKey?-1:1),around:b.unproject(E)},{originalEvent:_})}}},Uu.prototype.enable=function(){this._enabled=!0},Uu.prototype.disable=function(){this._enabled=!1,this.reset()},Uu.prototype.isEnabled=function(){return this._enabled},Uu.prototype.isActive=function(){return this._active};var uc=function(){this._tap=new pl({numTouches:1,numTaps:1}),this.reset()};uc.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},uc.prototype.touchstart=function(_,E,b){this._swipePoint||(this._tapTime&&_.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=E[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(_,E,b))},uc.prototype.touchmove=function(_,E,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;var A=E[0],B=A.y-this._swipePoint.y;return this._swipePoint=A,_.preventDefault(),this._active=!0,{zoomDelta:B/128}}}else this._tap.touchmove(_,E,b)},uc.prototype.touchend=function(_,E,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(_,E,b)&&(this._tapTime=_.timeStamp)},uc.prototype.touchcancel=function(){this.reset()},uc.prototype.enable=function(){this._enabled=!0},uc.prototype.disable=function(){this._enabled=!1,this.reset()},uc.prototype.isEnabled=function(){return this._enabled},uc.prototype.isActive=function(){return this._active};var Xh=function(_,E,b){this._el=_,this._mousePan=E,this._touchPan=b};Xh.prototype.enable=function(_){this._inertiaOptions=_||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Xh.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Xh.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Xh.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Gl=function(_,E,b){this._pitchWithRotate=_.pitchWithRotate,this._mouseRotate=E,this._mousePitch=b};Gl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Gl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Gl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Gl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Gc=function(_,E,b,A){this._el=_,this._touchZoom=E,this._touchRotate=b,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0};Gc.prototype.enable=function(_){this._touchZoom.enable(_),this._rotationDisabled||this._touchRotate.enable(_),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Gc.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Gc.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Gc.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Gc.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Gc.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var iu=function(_){return _.zoom||_.drag||_.pitch||_.rotate},bp=function(_){function E(){_.apply(this,arguments)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E}(R.Event);function Ao(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}var xo=function(_,E){this._map=_,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xa(_),this._bearingSnap=E.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(E),R.bindAll(["handleEvent","handleWindowEvent"],this);var b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[R.window.document,"mousemove",{capture:!0}],[R.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[R.window,"blur",void 0]];for(var A=0,B=this._listeners;A<B.length;A+=1){var H=B[A],Y=H[0];yt.addEventListener(Y,H[1],Y===R.window.document?this.handleWindowEvent:this.handleEvent,H[2])}};xo.prototype.destroy=function(){for(var _=0,E=this._listeners;_<E.length;_+=1){var b=E[_],A=b[0];yt.removeEventListener(A,b[1],A===R.window.document?this.handleWindowEvent:this.handleEvent,b[2])}},xo.prototype._addDefaultHandlers=function(_){var E=this._map,b=E.getCanvasContainer();this._add("mapEvent",new $s(E,_));var A=E.boxZoom=new ru(E,_);this._add("boxZoom",A);var B=new ns,H=new Uu;E.doubleClickZoom=new Fu(H,B),this._add("tapZoom",B),this._add("clickZoom",H);var Y=new uc;this._add("tapDragZoom",Y);var et=E.touchPitch=new xp;this._add("touchPitch",et);var St=new Sd(_),Rt=new qp(_);E.dragRotate=new Gl(_,St,Rt),this._add("mouseRotate",St,["mousePitch"]),this._add("mousePitch",Rt,["mouseRotate"]);var ye=new eh(_),be=new Nc(_);E.dragPan=new Xh(b,ye,be),this._add("mousePan",ye),this._add("touchPan",be,["touchZoom","touchRotate"]);var Oe=new Jm,on=new kc;E.touchZoomRotate=new Gc(b,on,Oe,Y),this._add("touchRotate",Oe,["touchPan","touchZoom"]),this._add("touchZoom",on,["touchPan","touchRotate"]);var Qe=E.scrollZoom=new va(E,this);this._add("scrollZoom",Qe,["mousePan"]);var vn=E.keyboard=new Bu;this._add("keyboard",vn),this._add("blockableMapEvent",new fo(E));for(var Ye=0,On=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ye<On.length;Ye+=1){var jn=On[Ye];_.interactive&&_[jn]&&E[jn].enable(_[jn])}},xo.prototype._add=function(_,E,b){this._handlers.push({handlerName:_,handler:E,allowed:b}),this._handlersById[_]=E},xo.prototype.stop=function(_){if(!this._updatingCamera){for(var E=0,b=this._handlers;E<b.length;E+=1)b[E].handler.reset();this._inertia.clear(),this._fireEvents({},{},_),this._changes=[]}},xo.prototype.isActive=function(){for(var _=0,E=this._handlers;_<E.length;_+=1)if(E[_].handler.isActive())return!0;return!1},xo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},xo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},xo.prototype.isMoving=function(){return!!iu(this._eventsInProgress)||this.isZooming()},xo.prototype._blockedByActive=function(_,E,b){for(var A in _)if(A!==b&&(!E||E.indexOf(A)<0))return!0;return!1},xo.prototype.handleWindowEvent=function(_){this.handleEvent(_,_.type+"Window")},xo.prototype._getMapTouches=function(_){for(var E=[],b=0,A=_;b<A.length;b+=1){var B=A[b];this._el.contains(B.target)&&E.push(B)}return E},xo.prototype.handleEvent=function(_,E){this._updatingCamera=!0;for(var b=_.type==="renderFrame"?void 0:_,A={needsRenderFrame:!1},B={},H={},Y=_.touches?this._getMapTouches(_.touches):void 0,et=Y?yt.touchPos(this._el,Y):yt.mousePos(this._el,_),St=0,Rt=this._handlers;St<Rt.length;St+=1){var ye=Rt[St],be=ye.handlerName,Oe=ye.handler,on=ye.allowed;if(Oe.isEnabled()){var Qe=void 0;this._blockedByActive(H,on,be)?Oe.reset():Oe[E||_.type]&&(Qe=Oe[E||_.type](_,et,Y),this.mergeHandlerResult(A,B,Qe,be,b),Qe&&Qe.needsRenderFrame&&this._triggerRenderFrame()),(Qe||Oe.isActive())&&(H[be]=Oe)}}var vn={};for(var Ye in this._previousActiveHandlers)H[Ye]||(vn[Ye]=b);this._previousActiveHandlers=H,(Object.keys(vn).length||Ao(A))&&(this._changes.push([A,B,vn]),this._triggerRenderFrame()),(Object.keys(H).length||Ao(A))&&this._map._stop(!0),this._updatingCamera=!1;var On=A.cameraAnimation;On&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],On(this._map))},xo.prototype.mergeHandlerResult=function(_,E,b,A,B){if(b){R.extend(_,b);var H={handlerName:A,originalEvent:b.originalEvent||B};b.zoomDelta!==void 0&&(E.zoom=H),b.panDelta!==void 0&&(E.drag=H),b.pitchDelta!==void 0&&(E.pitch=H),b.bearingDelta!==void 0&&(E.rotate=H)}},xo.prototype._applyChanges=function(){for(var _={},E={},b={},A=0,B=this._changes;A<B.length;A+=1){var H=B[A],Y=H[0],et=H[1],St=H[2];Y.panDelta&&(_.panDelta=(_.panDelta||new R.Point(0,0))._add(Y.panDelta)),Y.zoomDelta&&(_.zoomDelta=(_.zoomDelta||0)+Y.zoomDelta),Y.bearingDelta&&(_.bearingDelta=(_.bearingDelta||0)+Y.bearingDelta),Y.pitchDelta&&(_.pitchDelta=(_.pitchDelta||0)+Y.pitchDelta),Y.around!==void 0&&(_.around=Y.around),Y.pinchAround!==void 0&&(_.pinchAround=Y.pinchAround),Y.noInertia&&(_.noInertia=Y.noInertia),R.extend(E,et),R.extend(b,St)}this._updateMapTransform(_,E,b),this._changes=[]},xo.prototype._updateMapTransform=function(_,E,b){var A=this._map,B=A.transform;if(!Ao(_))return this._fireEvents(E,b,!0);var H=_.panDelta,Y=_.zoomDelta,et=_.bearingDelta,St=_.pitchDelta,Rt=_.around,ye=_.pinchAround;ye!==void 0&&(Rt=ye),A._stop(!0),Rt=Rt||A.transform.centerPoint;var be=B.pointLocation(H?Rt.sub(H):Rt);et&&(B.bearing+=et),St&&(B.pitch+=St),Y&&(B.zoom+=Y),B.setLocationAtPoint(be,Rt),this._map._update(),_.noInertia||this._inertia.record(_),this._fireEvents(E,b,!0)},xo.prototype._fireEvents=function(_,E,b){var A=this,B=iu(this._eventsInProgress),H=iu(_),Y={};for(var et in _)this._eventsInProgress[et]||(Y[et+"start"]=_[et].originalEvent),this._eventsInProgress[et]=_[et];for(var St in!B&&H&&this._fireEvent("movestart",H.originalEvent),Y)this._fireEvent(St,Y[St]);for(var Rt in H&&this._fireEvent("move",H.originalEvent),_)this._fireEvent(Rt,_[Rt].originalEvent);var ye,be={};for(var Oe in this._eventsInProgress){var on=this._eventsInProgress[Oe],Qe=on.handlerName,vn=on.originalEvent;this._handlersById[Qe].isActive()||(delete this._eventsInProgress[Oe],be[Oe+"end"]=ye=E[Qe]||vn)}for(var Ye in be)this._fireEvent(Ye,be[Ye]);var On=iu(this._eventsInProgress);if(b&&(B||H)&&!On){this._updatingCamera=!0;var jn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ar=function(Or){return Or!==0&&-A._bearingSnap<Or&&Or<A._bearingSnap};jn?(ar(jn.bearing||this._map.getBearing())&&(jn.bearing=0),this._map.easeTo(jn,{originalEvent:ye})):(this._map.fire(new R.Event("moveend",{originalEvent:ye})),ar(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},xo.prototype._fireEvent=function(_,E){this._map.fire(new R.Event(_,E?{originalEvent:E}:{}))},xo.prototype._requestFrame=function(){var _=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(E){delete _._frameId,_.handleEvent(new bp("renderFrame",{timeStamp:E})),_._applyChanges()})},xo.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var zu=function(_){function E(b,A){_.call(this),this._moving=!1,this._zooming=!1,this.transform=b,this._bearingSnap=A.bearingSnap,R.bindAll(["_renderFrameCallback"],this)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.getCenter=function(){return new R.LngLat(this.transform.center.lng,this.transform.center.lat)},E.prototype.setCenter=function(b,A){return this.jumpTo({center:b},A)},E.prototype.panBy=function(b,A,B){return b=R.Point.convert(b).mult(-1),this.panTo(this.transform.center,R.extend({offset:b},A),B)},E.prototype.panTo=function(b,A,B){return this.easeTo(R.extend({center:b},A),B)},E.prototype.getZoom=function(){return this.transform.zoom},E.prototype.setZoom=function(b,A){return this.jumpTo({zoom:b},A),this},E.prototype.zoomTo=function(b,A,B){return this.easeTo(R.extend({zoom:b},A),B)},E.prototype.zoomIn=function(b,A){return this.zoomTo(this.getZoom()+1,b,A),this},E.prototype.zoomOut=function(b,A){return this.zoomTo(this.getZoom()-1,b,A),this},E.prototype.getBearing=function(){return this.transform.bearing},E.prototype.setBearing=function(b,A){return this.jumpTo({bearing:b},A),this},E.prototype.getPadding=function(){return this.transform.padding},E.prototype.setPadding=function(b,A){return this.jumpTo({padding:b},A),this},E.prototype.rotateTo=function(b,A,B){return this.easeTo(R.extend({bearing:b},A),B)},E.prototype.resetNorth=function(b,A){return this.rotateTo(0,R.extend({duration:1e3},b),A),this},E.prototype.resetNorthPitch=function(b,A){return this.easeTo(R.extend({bearing:0,pitch:0,duration:1e3},b),A),this},E.prototype.snapToNorth=function(b,A){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(b,A):this},E.prototype.getPitch=function(){return this.transform.pitch},E.prototype.setPitch=function(b,A){return this.jumpTo({pitch:b},A),this},E.prototype.cameraForBounds=function(b,A){b=R.LngLatBounds.convert(b);var B=A&&A.bearing||0;return this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),B,A)},E.prototype._cameraForBoxAndBearing=function(b,A,B,H){var Y={top:0,bottom:0,right:0,left:0};if(typeof(H=R.extend({padding:Y,offset:[0,0],maxZoom:this.transform.maxZoom},H)).padding=="number"){var et=H.padding;H.padding={top:et,bottom:et,right:et,left:et}}H.padding=R.extend(Y,H.padding);var St=this.transform,Rt=St.padding,ye=St.project(R.LngLat.convert(b)),be=St.project(R.LngLat.convert(A)),Oe=ye.rotate(-B*Math.PI/180),on=be.rotate(-B*Math.PI/180),Qe=new R.Point(Math.max(Oe.x,on.x),Math.max(Oe.y,on.y)),vn=new R.Point(Math.min(Oe.x,on.x),Math.min(Oe.y,on.y)),Ye=Qe.sub(vn),On=(St.width-(Rt.left+Rt.right+H.padding.left+H.padding.right))/Ye.x,jn=(St.height-(Rt.top+Rt.bottom+H.padding.top+H.padding.bottom))/Ye.y;if(!(jn<0||On<0)){var ar=Math.min(St.scaleZoom(St.scale*Math.min(On,jn)),H.maxZoom),Or=typeof H.offset.x=="number"?new R.Point(H.offset.x,H.offset.y):R.Point.convert(H.offset),cr=new R.Point((H.padding.left-H.padding.right)/2,(H.padding.top-H.padding.bottom)/2).rotate(B*Math.PI/180),kr=Or.add(cr).mult(St.scale/St.zoomScale(ar));return{center:St.unproject(ye.add(be).div(2).sub(kr)),zoom:ar,bearing:B}}R.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},E.prototype.fitBounds=function(b,A,B){return this._fitInternal(this.cameraForBounds(b,A),A,B)},E.prototype.fitScreenCoordinates=function(b,A,B,H,Y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(R.Point.convert(b)),this.transform.pointLocation(R.Point.convert(A)),B,H),H,Y)},E.prototype._fitInternal=function(b,A,B){return b?(delete(A=R.extend(b,A)).padding,A.linear?this.easeTo(A,B):this.flyTo(A,B)):this},E.prototype.jumpTo=function(b,A){this.stop();var B=this.transform,H=!1,Y=!1,et=!1;return"zoom"in b&&B.zoom!==+b.zoom&&(H=!0,B.zoom=+b.zoom),b.center!==void 0&&(B.center=R.LngLat.convert(b.center)),"bearing"in b&&B.bearing!==+b.bearing&&(Y=!0,B.bearing=+b.bearing),"pitch"in b&&B.pitch!==+b.pitch&&(et=!0,B.pitch=+b.pitch),b.padding==null||B.isPaddingEqual(b.padding)||(B.padding=b.padding),this.fire(new R.Event("movestart",A)).fire(new R.Event("move",A)),H&&this.fire(new R.Event("zoomstart",A)).fire(new R.Event("zoom",A)).fire(new R.Event("zoomend",A)),Y&&this.fire(new R.Event("rotatestart",A)).fire(new R.Event("rotate",A)).fire(new R.Event("rotateend",A)),et&&this.fire(new R.Event("pitchstart",A)).fire(new R.Event("pitch",A)).fire(new R.Event("pitchend",A)),this.fire(new R.Event("moveend",A))},E.prototype.easeTo=function(b,A){var B=this;this._stop(!1,b.easeId),((b=R.extend({offset:[0,0],duration:500,easing:R.ease},b)).animate===!1||!b.essential&&R.browser.prefersReducedMotion)&&(b.duration=0);var H=this.transform,Y=this.getZoom(),et=this.getBearing(),St=this.getPitch(),Rt=this.getPadding(),ye="zoom"in b?+b.zoom:Y,be="bearing"in b?this._normalizeBearing(b.bearing,et):et,Oe="pitch"in b?+b.pitch:St,on="padding"in b?b.padding:H.padding,Qe=R.Point.convert(b.offset),vn=H.centerPoint.add(Qe),Ye=H.pointLocation(vn),On=R.LngLat.convert(b.center||Ye);this._normalizeCenter(On);var jn,ar,Or=H.project(Ye),cr=H.project(On).sub(Or),kr=H.zoomScale(ye-Y);b.around&&(jn=R.LngLat.convert(b.around),ar=H.locationPoint(jn));var ei={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ye!==Y,this._rotating=this._rotating||et!==be,this._pitching=this._pitching||Oe!==St,this._padding=!H.isPaddingEqual(on),this._easeId=b.easeId,this._prepareEase(A,b.noMoveStart,ei),this._ease(function(Yr){if(B._zooming&&(H.zoom=R.number(Y,ye,Yr)),B._rotating&&(H.bearing=R.number(et,be,Yr)),B._pitching&&(H.pitch=R.number(St,Oe,Yr)),B._padding&&(H.interpolatePadding(Rt,on,Yr),vn=H.centerPoint.add(Qe)),jn)H.setLocationAtPoint(jn,ar);else{var Ti=H.zoomScale(H.zoom-Y),zi=ye>Y?Math.min(2,kr):Math.max(.5,kr),Io=Math.pow(zi,1-Yr),Bo=H.unproject(Or.add(cr.mult(Yr*Io)).mult(Ti));H.setLocationAtPoint(H.renderWorldCopies?Bo.wrap():Bo,vn)}B._fireMoveEvents(A)},function(Yr){B._afterEase(A,Yr)},b),this},E.prototype._prepareEase=function(b,A,B){B===void 0&&(B={}),this._moving=!0,A||B.moving||this.fire(new R.Event("movestart",b)),this._zooming&&!B.zooming&&this.fire(new R.Event("zoomstart",b)),this._rotating&&!B.rotating&&this.fire(new R.Event("rotatestart",b)),this._pitching&&!B.pitching&&this.fire(new R.Event("pitchstart",b))},E.prototype._fireMoveEvents=function(b){this.fire(new R.Event("move",b)),this._zooming&&this.fire(new R.Event("zoom",b)),this._rotating&&this.fire(new R.Event("rotate",b)),this._pitching&&this.fire(new R.Event("pitch",b))},E.prototype._afterEase=function(b,A){if(!this._easeId||!A||this._easeId!==A){delete this._easeId;var B=this._zooming,H=this._rotating,Y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,B&&this.fire(new R.Event("zoomend",b)),H&&this.fire(new R.Event("rotateend",b)),Y&&this.fire(new R.Event("pitchend",b)),this.fire(new R.Event("moveend",b))}},E.prototype.flyTo=function(b,A){var B=this;if(!b.essential&&R.browser.prefersReducedMotion){var H=R.pick(b,["center","zoom","bearing","pitch","around"]);return this.jumpTo(H,A)}this.stop(),b=R.extend({offset:[0,0],speed:1.2,curve:1.42,easing:R.ease},b);var Y=this.transform,et=this.getZoom(),St=this.getBearing(),Rt=this.getPitch(),ye=this.getPadding(),be="zoom"in b?R.clamp(+b.zoom,Y.minZoom,Y.maxZoom):et,Oe="bearing"in b?this._normalizeBearing(b.bearing,St):St,on="pitch"in b?+b.pitch:Rt,Qe="padding"in b?b.padding:Y.padding,vn=Y.zoomScale(be-et),Ye=R.Point.convert(b.offset),On=Y.centerPoint.add(Ye),jn=Y.pointLocation(On),ar=R.LngLat.convert(b.center||jn);this._normalizeCenter(ar);var Or=Y.project(jn),cr=Y.project(ar).sub(Or),kr=b.curve,ei=Math.max(Y.width,Y.height),Yr=ei/vn,Ti=cr.mag();if("minZoom"in b){var zi=R.clamp(Math.min(b.minZoom,et,be),Y.minZoom,Y.maxZoom),Io=ei/Y.zoomScale(zi-et);kr=Math.sqrt(Io/Ti*2)}var Bo=kr*kr;function Fo(jo){var Do=(Yr*Yr-ei*ei+(jo?-1:1)*Bo*Bo*Ti*Ti)/(2*(jo?Yr:ei)*Bo*Ti);return Math.log(Math.sqrt(Do*Do+1)-Do)}function ua(jo){return(Math.exp(jo)-Math.exp(-jo))/2}function Tn(jo){return(Math.exp(jo)+Math.exp(-jo))/2}var Me=Fo(0),la=function(jo){return Tn(Me)/Tn(Me+kr*jo)},ta=function(jo){return ei*((Tn(Me)*(ua(Do=Me+kr*jo)/Tn(Do))-ua(Me))/Bo)/Ti;var Do},Vo=(Fo(1)-Me)/kr;if(Math.abs(Ti)<1e-6||!isFinite(Vo)){if(Math.abs(ei-Yr)<1e-6)return this.easeTo(b,A);var ga=Yr<ei?-1:1;Vo=Math.abs(Math.log(Yr/ei))/kr,ta=function(){return 0},la=function(jo){return Math.exp(ga*kr*jo)}}return b.duration="duration"in b?+b.duration:1e3*Vo/("screenSpeed"in b?+b.screenSpeed/kr:+b.speed),b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=St!==Oe,this._pitching=on!==Rt,this._padding=!Y.isPaddingEqual(Qe),this._prepareEase(A,!1),this._ease(function(jo){var Do=jo*Vo,hc=1/la(Do);Y.zoom=jo===1?be:et+Y.scaleZoom(hc),B._rotating&&(Y.bearing=R.number(St,Oe,jo)),B._pitching&&(Y.pitch=R.number(Rt,on,jo)),B._padding&&(Y.interpolatePadding(ye,Qe,jo),On=Y.centerPoint.add(Ye));var ml=jo===1?ar:Y.unproject(Or.add(cr.mult(ta(Do))).mult(hc));Y.setLocationAtPoint(Y.renderWorldCopies?ml.wrap():ml,On),B._fireMoveEvents(A)},function(){return B._afterEase(A)},b),this},E.prototype.isEasing=function(){return!!this._easeFrameId},E.prototype.stop=function(){return this._stop()},E.prototype._stop=function(b,A){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var B=this._onEaseEnd;delete this._onEaseEnd,B.call(this,A)}if(!b){var H=this.handlers;H&&H.stop(!1)}return this},E.prototype._ease=function(b,A,B){B.animate===!1||B.duration===0?(b(1),A()):(this._easeStart=R.browser.now(),this._easeOptions=B,this._onEaseFrame=b,this._onEaseEnd=A,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},E.prototype._renderFrameCallback=function(){var b=Math.min((R.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},E.prototype._normalizeBearing=function(b,A){b=R.wrap(b,-180,180);var B=Math.abs(b-A);return Math.abs(b-360-A)<B&&(b-=360),Math.abs(b+360-A)<B&&(b+=360),b},E.prototype._normalizeCenter=function(b){var A=this.transform;if(A.renderWorldCopies&&!A.lngRange){var B=b.lng-A.center.lng;b.lng+=B>180?-360:B<-180?360:0}},E}(R.Evented),ou=function(_){_===void 0&&(_={}),this.options=_,R.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ou.prototype.getDefaultPosition=function(){return"bottom-right"},ou.prototype.onAdd=function(_){var E=this.options&&this.options.compact;return this._map=_,this._container=yt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=yt.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=yt.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),E&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),E===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ou.prototype.onRemove=function(){yt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ou.prototype._setElementTitle=function(_,E){var b=this._map._getUIString("AttributionControl."+E);_.title=b,_.setAttribute("aria-label",b)},ou.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ou.prototype._updateEditLink=function(){var _=this._editLink;_||(_=this._editLink=this._container.querySelector(".mapbox-improve-map"));var E=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||R.config.ACCESS_TOKEN}];if(_){var b=E.reduce(function(A,B,H){return B.value&&(A+=B.key+"="+B.value+(H<E.length-1?"&":"")),A},"?");_.href=R.config.FEEDBACK_URL+"/"+b+(this._map._hash?this._map._hash.getHashString(!0):""),_.rel="noopener nofollow",this._setElementTitle(_,"MapFeedback")}},ou.prototype._updateData=function(_){!_||_.sourceDataType!=="metadata"&&_.sourceDataType!=="visibility"&&_.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ou.prototype._updateAttributions=function(){if(this._map.style){var _=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?_=_.concat(this.options.customAttribution.map(function(et){return typeof et!="string"?"":et})):typeof this.options.customAttribution=="string"&&_.push(this.options.customAttribution)),this._map.style.stylesheet){var E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}var b=this._map.style.sourceCaches;for(var A in b){var B=b[A];if(B.used){var H=B.getSource();H.attribution&&_.indexOf(H.attribution)<0&&_.push(H.attribution)}}_.sort(function(et,St){return et.length-St.length});var Y=(_=_.filter(function(et,St){for(var Rt=St+1;Rt<_.length;Rt++)if(_[Rt].indexOf(et)>=0)return!1;return!0})).join(" | ");Y!==this._attribHTML&&(this._attribHTML=Y,_.length?(this._innerContainer.innerHTML=Y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ou.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var rh=function(){R.bindAll(["_updateLogo"],this),R.bindAll(["_updateCompact"],this)};rh.prototype.onAdd=function(_){this._map=_,this._container=yt.create("div","mapboxgl-ctrl");var E=yt.create("a","mapboxgl-ctrl-logo");return E.target="_blank",E.rel="noopener nofollow",E.href="https://www.mapbox.com/",E.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),E.setAttribute("rel","noopener nofollow"),this._container.appendChild(E),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},rh.prototype.onRemove=function(){yt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},rh.prototype.getDefaultPosition=function(){return"bottom-left"},rh.prototype._updateLogo=function(_){_&&_.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},rh.prototype._logoRequired=function(){if(this._map.style){var _=this._map.style.sourceCaches;for(var E in _)if(_[E].getSource().mapbox_logo)return!0;return!1}},rh.prototype._updateCompact=function(){var _=this._container.children;if(_.length){var E=_[0];this._map.getCanvasContainer().offsetWidth<250?E.classList.add("mapboxgl-compact"):E.classList.remove("mapboxgl-compact")}};var ul=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ul.prototype.add=function(_){var E=++this._id;return this._queue.push({callback:_,id:E,cancelled:!1}),E},ul.prototype.remove=function(_){for(var E=this._currentlyRunning,b=0,A=E?this._queue.concat(E):this._queue;b<A.length;b+=1){var B=A[b];if(B.id===_)return void(B.cancelled=!0)}},ul.prototype.run=function(_){_===void 0&&(_=0);var E=this._currentlyRunning=this._queue;this._queue=[];for(var b=0,A=E;b<A.length;b+=1){var B=A[b];if(!B.cancelled&&(B.callback(_),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ul.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Wc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},kf=R.window.HTMLImageElement,wd=R.window.HTMLElement,fs=R.window.ImageBitmap,fc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},I0=function(_){function E(A){var B=this;if((A=R.extend({},fc,A)).minZoom!=null&&A.maxZoom!=null&&A.minZoom>A.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(A.minPitch!=null&&A.maxPitch!=null&&A.minPitch>A.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(A.minPitch!=null&&A.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(A.maxPitch!=null&&A.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var H=new mt(A.minZoom,A.maxZoom,A.minPitch,A.maxPitch,A.renderWorldCopies);if(_.call(this,H,A),this._interactive=A.interactive,this._maxTileCacheSize=A.maxTileCacheSize,this._failIfMajorPerformanceCaveat=A.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=A.preserveDrawingBuffer,this._antialias=A.antialias,this._trackResize=A.trackResize,this._bearingSnap=A.bearingSnap,this._refreshExpiredTiles=A.refreshExpiredTiles,this._fadeDuration=A.fadeDuration,this._crossSourceCollisions=A.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=A.collectResourceTiming,this._renderTaskQueue=new ul,this._controls=[],this._mapId=R.uniqueId(),this._locale=R.extend({},Wc,A.locale),this._clickTolerance=A.clickTolerance,this._requestManager=new R.RequestManager(A.transformRequest,A.accessToken),typeof A.container=="string"){if(this._container=R.window.document.getElementById(A.container),!this._container)throw new Error("Container '"+A.container+"' not found.")}else{if(!(A.container instanceof wd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=A.container}if(A.maxBounds&&this.setMaxBounds(A.maxBounds),R.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return B._update(!1)}),this.on("moveend",function(){return B._update(!1)}),this.on("zoom",function(){return B._update(!0)}),R.window!==void 0&&(R.window.addEventListener("online",this._onWindowOnline,!1),R.window.addEventListener("resize",this._onWindowResize,!1),R.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new xo(this,A),this._hash=A.hash&&new dn(typeof A.hash=="string"&&A.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:A.center,zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}),A.bounds&&(this.resize(),this.fitBounds(A.bounds,R.extend({},A.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=A.localIdeographFontFamily,A.style&&this.setStyle(A.style,{localIdeographFontFamily:A.localIdeographFontFamily}),A.attributionControl&&this.addControl(new ou({customAttribution:A.customAttribution})),this.addControl(new rh,A.logoPosition),this.on("style.load",function(){B.transform.unmodified&&B.jumpTo(B.style.stylesheet)}),this.on("data",function(Y){B._update(Y.dataType==="style"),B.fire(new R.Event(Y.dataType+"data",Y))}),this.on("dataloading",function(Y){B.fire(new R.Event(Y.dataType+"dataloading",Y))})}_&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E;var b={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return E.prototype._getMapId=function(){return this._mapId},E.prototype.addControl=function(A,B){if(B===void 0&&(B=A.getDefaultPosition?A.getDefaultPosition():"top-right"),!A||!A.onAdd)return this.fire(new R.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var H=A.onAdd(this);this._controls.push(A);var Y=this._controlPositions[B];return B.indexOf("bottom")!==-1?Y.insertBefore(H,Y.firstChild):Y.appendChild(H),this},E.prototype.removeControl=function(A){if(!A||!A.onRemove)return this.fire(new R.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var B=this._controls.indexOf(A);return B>-1&&this._controls.splice(B,1),A.onRemove(this),this},E.prototype.hasControl=function(A){return this._controls.indexOf(A)>-1},E.prototype.resize=function(A){var B=this._containerDimensions(),H=B[0],Y=B[1];if(H===this.transform.width&&Y===this.transform.height)return this;this._resizeCanvas(H,Y),this.transform.resize(H,Y),this.painter.resize(H,Y);var et=!this._moving;return et&&this.fire(new R.Event("movestart",A)).fire(new R.Event("move",A)),this.fire(new R.Event("resize",A)),et&&this.fire(new R.Event("moveend",A)),this},E.prototype.getBounds=function(){return this.transform.getBounds()},E.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},E.prototype.setMaxBounds=function(A){return this.transform.setMaxBounds(R.LngLatBounds.convert(A)),this._update()},E.prototype.setMinZoom=function(A){if((A=A==null?-2:A)>=-2&&A<=this.transform.maxZoom)return this.transform.minZoom=A,this._update(),this.getZoom()<A&&this.setZoom(A),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},E.prototype.getMinZoom=function(){return this.transform.minZoom},E.prototype.setMaxZoom=function(A){if((A=A==null?22:A)>=this.transform.minZoom)return this.transform.maxZoom=A,this._update(),this.getZoom()>A&&this.setZoom(A),this;throw new Error("maxZoom must be greater than the current minZoom")},E.prototype.getMaxZoom=function(){return this.transform.maxZoom},E.prototype.setMinPitch=function(A){if((A=A==null?0:A)<0)throw new Error("minPitch must be greater than or equal to 0");if(A>=0&&A<=this.transform.maxPitch)return this.transform.minPitch=A,this._update(),this.getPitch()<A&&this.setPitch(A),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},E.prototype.getMinPitch=function(){return this.transform.minPitch},E.prototype.setMaxPitch=function(A){if((A=A==null?60:A)>60)throw new Error("maxPitch must be less than or equal to 60");if(A>=this.transform.minPitch)return this.transform.maxPitch=A,this._update(),this.getPitch()>A&&this.setPitch(A),this;throw new Error("maxPitch must be greater than the current minPitch")},E.prototype.getMaxPitch=function(){return this.transform.maxPitch},E.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},E.prototype.setRenderWorldCopies=function(A){return this.transform.renderWorldCopies=A,this._update()},E.prototype.project=function(A){return this.transform.locationPoint(R.LngLat.convert(A))},E.prototype.unproject=function(A){return this.transform.pointLocation(R.Point.convert(A))},E.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},E.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},E.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},E.prototype._createDelegatedListener=function(A,B,H){var Y,et=this;if(A==="mouseenter"||A==="mouseover"){var St=!1;return{layer:B,listener:H,delegates:{mousemove:function(ye){var be=et.getLayer(B)?et.queryRenderedFeatures(ye.point,{layers:[B]}):[];be.length?St||(St=!0,H.call(et,new Ba(A,et,ye.originalEvent,{features:be}))):St=!1},mouseout:function(){St=!1}}}}if(A==="mouseleave"||A==="mouseout"){var Rt=!1;return{layer:B,listener:H,delegates:{mousemove:function(ye){(et.getLayer(B)?et.queryRenderedFeatures(ye.point,{layers:[B]}):[]).length?Rt=!0:Rt&&(Rt=!1,H.call(et,new Ba(A,et,ye.originalEvent)))},mouseout:function(ye){Rt&&(Rt=!1,H.call(et,new Ba(A,et,ye.originalEvent)))}}}}return{layer:B,listener:H,delegates:(Y={},Y[A]=function(ye){var be=et.getLayer(B)?et.queryRenderedFeatures(ye.point,{layers:[B]}):[];be.length&&(ye.features=be,H.call(et,ye),delete ye.features)},Y)}},E.prototype.on=function(A,B,H){if(H===void 0)return _.prototype.on.call(this,A,B);var Y=this._createDelegatedListener(A,B,H);for(var et in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[A]=this._delegatedListeners[A]||[],this._delegatedListeners[A].push(Y),Y.delegates)this.on(et,Y.delegates[et]);return this},E.prototype.once=function(A,B,H){if(H===void 0)return _.prototype.once.call(this,A,B);var Y=this._createDelegatedListener(A,B,H);for(var et in Y.delegates)this.once(et,Y.delegates[et]);return this},E.prototype.off=function(A,B,H){var Y=this;return H===void 0?_.prototype.off.call(this,A,B):(this._delegatedListeners&&this._delegatedListeners[A]&&function(et){for(var St=et[A],Rt=0;Rt<St.length;Rt++){var ye=St[Rt];if(ye.layer===B&&ye.listener===H){for(var be in ye.delegates)Y.off(be,ye.delegates[be]);return St.splice(Rt,1),Y}}}(this._delegatedListeners),this)},E.prototype.queryRenderedFeatures=function(A,B){if(!this.style)return[];var H;if(B!==void 0||A===void 0||A instanceof R.Point||Array.isArray(A)||(B=A,A=void 0),B=B||{},(A=A||[[0,0],[this.transform.width,this.transform.height]])instanceof R.Point||typeof A[0]=="number")H=[R.Point.convert(A)];else{var Y=R.Point.convert(A[0]),et=R.Point.convert(A[1]);H=[Y,new R.Point(et.x,Y.y),et,new R.Point(Y.x,et.y),Y]}return this.style.queryRenderedFeatures(H,B,this.transform)},E.prototype.querySourceFeatures=function(A,B){return this.style.querySourceFeatures(A,B)},E.prototype.setStyle=function(A,B){return(B=R.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},B)).diff!==!1&&B.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&A?(this._diffStyle(A,B),this):(this._localIdeographFontFamily=B.localIdeographFontFamily,this._updateStyle(A,B))},E.prototype._getUIString=function(A){var B=this._locale[A];if(B==null)throw new Error("Missing UI string '"+A+"'");return B},E.prototype._updateStyle=function(A,B){return this.style&&(this.style.setEventedParent(null),this.style._remove()),A?(this.style=new ac(this,B||{}),this.style.setEventedParent(this,{style:this.style}),typeof A=="string"?this.style.loadURL(A):this.style.loadJSON(A),this):(delete this.style,this)},E.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ac(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},E.prototype._diffStyle=function(A,B){var H=this;if(typeof A=="string"){var Y=this._requestManager.normalizeStyleURL(A),et=this._requestManager.transformRequest(Y,R.ResourceType.Style);R.getJSON(et,function(St,Rt){St?H.fire(new R.ErrorEvent(St)):Rt&&H._updateDiff(Rt,B)})}else typeof A=="object"&&this._updateDiff(A,B)},E.prototype._updateDiff=function(A,B){try{this.style.setState(A)&&this._update(!0)}catch(H){R.warnOnce("Unable to perform style diff: "+(H.message||H.error||H)+".  Rebuilding the style from scratch."),this._updateStyle(A,B)}},E.prototype.getStyle=function(){if(this.style)return this.style.serialize()},E.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():R.warnOnce("There is no style added to the map.")},E.prototype.addSource=function(A,B){return this._lazyInitEmptyStyle(),this.style.addSource(A,B),this._update(!0)},E.prototype.isSourceLoaded=function(A){var B=this.style&&this.style.sourceCaches[A];if(B!==void 0)return B.loaded();this.fire(new R.ErrorEvent(new Error("There is no source with ID '"+A+"'")))},E.prototype.areTilesLoaded=function(){var A=this.style&&this.style.sourceCaches;for(var B in A){var H=A[B]._tiles;for(var Y in H){var et=H[Y];if(et.state!=="loaded"&&et.state!=="errored")return!1}}return!0},E.prototype.addSourceType=function(A,B,H){return this._lazyInitEmptyStyle(),this.style.addSourceType(A,B,H)},E.prototype.removeSource=function(A){return this.style.removeSource(A),this._update(!0)},E.prototype.getSource=function(A){return this.style.getSource(A)},E.prototype.addImage=function(A,B,H){H===void 0&&(H={});var Y=H.pixelRatio;Y===void 0&&(Y=1);var et=H.sdf;et===void 0&&(et=!1);var St=H.stretchX,Rt=H.stretchY,ye=H.content;if(this._lazyInitEmptyStyle(),B instanceof kf||fs&&B instanceof fs){var be=R.browser.getImageData(B);this.style.addImage(A,{data:new R.RGBAImage({width:be.width,height:be.height},be.data),pixelRatio:Y,stretchX:St,stretchY:Rt,content:ye,sdf:et,version:0})}else{if(B.width===void 0||B.height===void 0)return this.fire(new R.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Oe=B;this.style.addImage(A,{data:new R.RGBAImage({width:B.width,height:B.height},new Uint8Array(B.data)),pixelRatio:Y,stretchX:St,stretchY:Rt,content:ye,sdf:et,version:0,userImage:Oe}),Oe.onAdd&&Oe.onAdd(this,A)}},E.prototype.updateImage=function(A,B){var H=this.style.getImage(A);if(!H)return this.fire(new R.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Y=B instanceof kf||fs&&B instanceof fs?R.browser.getImageData(B):B,et=Y.width,St=Y.height,Rt=Y.data;return et===void 0||St===void 0?this.fire(new R.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):et!==H.data.width||St!==H.data.height?this.fire(new R.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(H.data.replace(Rt,!(B instanceof kf||fs&&B instanceof fs)),void this.style.updateImage(A,H))},E.prototype.hasImage=function(A){return A?!!this.style.getImage(A):(this.fire(new R.ErrorEvent(new Error("Missing required image id"))),!1)},E.prototype.removeImage=function(A){this.style.removeImage(A)},E.prototype.loadImage=function(A,B){R.getImage(this._requestManager.transformRequest(A,R.ResourceType.Image),B)},E.prototype.listImages=function(){return this.style.listImages()},E.prototype.addLayer=function(A,B){return this._lazyInitEmptyStyle(),this.style.addLayer(A,B),this._update(!0)},E.prototype.moveLayer=function(A,B){return this.style.moveLayer(A,B),this._update(!0)},E.prototype.removeLayer=function(A){return this.style.removeLayer(A),this._update(!0)},E.prototype.getLayer=function(A){return this.style.getLayer(A)},E.prototype.setLayerZoomRange=function(A,B,H){return this.style.setLayerZoomRange(A,B,H),this._update(!0)},E.prototype.setFilter=function(A,B,H){return H===void 0&&(H={}),this.style.setFilter(A,B,H),this._update(!0)},E.prototype.getFilter=function(A){return this.style.getFilter(A)},E.prototype.setPaintProperty=function(A,B,H,Y){return Y===void 0&&(Y={}),this.style.setPaintProperty(A,B,H,Y),this._update(!0)},E.prototype.getPaintProperty=function(A,B){return this.style.getPaintProperty(A,B)},E.prototype.setLayoutProperty=function(A,B,H,Y){return Y===void 0&&(Y={}),this.style.setLayoutProperty(A,B,H,Y),this._update(!0)},E.prototype.getLayoutProperty=function(A,B){return this.style.getLayoutProperty(A,B)},E.prototype.setLight=function(A,B){return B===void 0&&(B={}),this._lazyInitEmptyStyle(),this.style.setLight(A,B),this._update(!0)},E.prototype.getLight=function(){return this.style.getLight()},E.prototype.setFeatureState=function(A,B){return this.style.setFeatureState(A,B),this._update()},E.prototype.removeFeatureState=function(A,B){return this.style.removeFeatureState(A,B),this._update()},E.prototype.getFeatureState=function(A){return this.style.getFeatureState(A)},E.prototype.getContainer=function(){return this._container},E.prototype.getCanvasContainer=function(){return this._canvasContainer},E.prototype.getCanvas=function(){return this._canvas},E.prototype._containerDimensions=function(){var A=0,B=0;return this._container&&(A=this._container.clientWidth||400,B=this._container.clientHeight||300),[A,B]},E.prototype._detectMissingCSS=function(){R.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&R.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},E.prototype._setupContainer=function(){var A=this._container;A.classList.add("mapboxgl-map"),(this._missingCSSCanary=yt.create("div","mapboxgl-canary",A)).style.visibility="hidden",this._detectMissingCSS();var B=this._canvasContainer=yt.create("div","mapboxgl-canvas-container",A);this._interactive&&B.classList.add("mapboxgl-interactive"),this._canvas=yt.create("canvas","mapboxgl-canvas",B),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var H=this._containerDimensions();this._resizeCanvas(H[0],H[1]);var Y=this._controlContainer=yt.create("div","mapboxgl-control-container",A),et=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(St){et[St]=yt.create("div","mapboxgl-ctrl-"+St,Y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},E.prototype._resizeCanvas=function(A,B){var H=R.browser.devicePixelRatio||1;this._canvas.width=H*A,this._canvas.height=H*B,this._canvas.style.width=A+"px",this._canvas.style.height=B+"px"},E.prototype._setupPainter=function(){var A=R.extend({},$e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),B=this._canvas.getContext("webgl",A)||this._canvas.getContext("experimental-webgl",A);B?(this.painter=new $a(B,this.transform),R.webpSupported.testSupport(B)):this.fire(new R.ErrorEvent(new Error("Failed to initialize WebGL")))},E.prototype._contextLost=function(A){A.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new R.Event("webglcontextlost",{originalEvent:A}))},E.prototype._contextRestored=function(A){this._setupPainter(),this.resize(),this._update(),this.fire(new R.Event("webglcontextrestored",{originalEvent:A}))},E.prototype._onMapScroll=function(A){if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},E.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},E.prototype._update=function(A){return this.style?(this._styleDirty=this._styleDirty||A,this._sourcesDirty=!0,this.triggerRepaint(),this):this},E.prototype._requestRenderFrame=function(A){return this._update(),this._renderTaskQueue.add(A)},E.prototype._cancelRenderFrame=function(A){this._renderTaskQueue.remove(A)},E.prototype._render=function(A){var B,H=this,Y=0,et=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(B=et.createQueryEXT(),et.beginQueryEXT(et.TIME_ELAPSED_EXT,B),Y=R.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(A),!this._removed){var St=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Rt=this.transform.zoom,ye=R.browser.now();this.style.zoomHistory.update(Rt,ye);var be=new R.EvaluationParameters(Rt,{now:ye,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Oe=be.crossFadingFactor();Oe===1&&Oe===this._crossFadingFactor||(St=!0,this._crossFadingFactor=Oe),this.style.update(be)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new R.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new R.Event("load"))),this.style&&(this.style.hasTransitions()||St)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var on=R.browser.now()-Y;et.endQueryEXT(et.TIME_ELAPSED_EXT,B),setTimeout(function(){var Ye=et.getQueryObjectEXT(B,et.QUERY_RESULT_EXT)/1e6;et.deleteQueryEXT(B),H.fire(new R.Event("gpu-timing-frame",{cpuTime:on,gpuTime:Ye}))},50)}if(this.listens("gpu-timing-layer")){var Qe=this.painter.collectGpuTimers();setTimeout(function(){var Ye=H.painter.queryGpuTimers(Qe);H.fire(new R.Event("gpu-timing-layer",{layerTimes:Ye}))},50)}var vn=this._sourcesDirty||this._styleDirty||this._placementDirty;return vn||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new R.Event("idle")),!this._loaded||this._fullyLoaded||vn||(this._fullyLoaded=!0),this}},E.prototype.remove=function(){this._hash&&this._hash.remove();for(var A=0,B=this._controls;A<B.length;A+=1)B[A].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),R.window!==void 0&&(R.window.removeEventListener("resize",this._onWindowResize,!1),R.window.removeEventListener("orientationchange",this._onWindowResize,!1),R.window.removeEventListener("online",this._onWindowOnline,!1));var H=this.painter.context.gl.getExtension("WEBGL_lose_context");H&&H.loseContext(),Yh(this._canvasContainer),Yh(this._controlContainer),Yh(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new R.Event("remove"))},E.prototype.triggerRepaint=function(){var A=this;this.style&&!this._frame&&(this._frame=R.browser.frame(function(B){A._frame=null,A._render(B)}))},E.prototype._onWindowOnline=function(){this._update()},E.prototype._onWindowResize=function(A){this._trackResize&&this.resize({originalEvent:A})._update()},b.showTileBoundaries.get=function(){return!!this._showTileBoundaries},b.showTileBoundaries.set=function(A){this._showTileBoundaries!==A&&(this._showTileBoundaries=A,this._update())},b.showPadding.get=function(){return!!this._showPadding},b.showPadding.set=function(A){this._showPadding!==A&&(this._showPadding=A,this._update())},b.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},b.showCollisionBoxes.set=function(A){this._showCollisionBoxes!==A&&(this._showCollisionBoxes=A,A?this.style._generateCollisionBoxes():this._update())},b.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},b.showOverdrawInspector.set=function(A){this._showOverdrawInspector!==A&&(this._showOverdrawInspector=A,this._update())},b.repaint.get=function(){return!!this._repaint},b.repaint.set=function(A){this._repaint!==A&&(this._repaint=A,this.triggerRepaint())},b.vertices.get=function(){return!!this._vertices},b.vertices.set=function(A){this._vertices=A,this._update()},E.prototype._setCacheLimits=function(A,B){R.setCacheLimits(A,B)},b.version.get=function(){return R.version},Object.defineProperties(E.prototype,b),E}(zu);function Yh(_){_.parentNode&&_.parentNode.removeChild(_)}var Kp={showCompass:!0,showZoom:!0,visualizePitch:!1},xh=function(_){var E=this;this.options=R.extend({},Kp,_),this._container=yt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(b){return b.preventDefault()}),this.options.showZoom&&(R.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(b){return E._map.zoomIn({},{originalEvent:b})}),yt.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(b){return E._map.zoomOut({},{originalEvent:b})}),yt.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(R.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(b){E.options.visualizePitch?E._map.resetNorthPitch({},{originalEvent:b}):E._map.resetNorth({},{originalEvent:b})}),this._compassIcon=yt.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};xh.prototype._updateZoomButtons=function(){var _=this._map.getZoom(),E=_===this._map.getMaxZoom(),b=_===this._map.getMinZoom();this._zoomInButton.disabled=E,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",E.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())},xh.prototype._rotateCompassArrow=function(){var _=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=_},xh.prototype.onAdd=function(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new au(this._map,this._compass,this.options.visualizePitch)),this._container},xh.prototype.onRemove=function(){yt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},xh.prototype._createButton=function(_,E){var b=yt.create("button",_,this._container);return b.type="button",b.addEventListener("click",E),b},xh.prototype._setButtonTitle=function(_,E){var b=this._map._getUIString("NavigationControl."+E);_.title=b,_.setAttribute("aria-label",b)};var au=function(_,E,b){b===void 0&&(b=!1),this._clickTolerance=10,this.element=E,this.mouseRotate=new Sd({clickTolerance:_.dragRotate._mouseRotate._clickTolerance}),this.map=_,b&&(this.mousePitch=new qp({clickTolerance:_.dragRotate._mousePitch._clickTolerance})),R.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),yt.addEventListener(E,"mousedown",this.mousedown),yt.addEventListener(E,"touchstart",this.touchstart,{passive:!1}),yt.addEventListener(E,"touchmove",this.touchmove),yt.addEventListener(E,"touchend",this.touchend),yt.addEventListener(E,"touchcancel",this.reset)};function zd(_,E,b){if(_=new R.LngLat(_.lng,_.lat),E){var A=new R.LngLat(_.lng-360,_.lat),B=new R.LngLat(_.lng+360,_.lat),H=b.locationPoint(_).distSqr(E);b.locationPoint(A).distSqr(E)<H?_=A:b.locationPoint(B).distSqr(E)<H&&(_=B)}for(;Math.abs(_.lng-b.center.lng)>180;){var Y=b.locationPoint(_);if(Y.x>=0&&Y.y>=0&&Y.x<=b.width&&Y.y<=b.height)break;_.lng>b.center.lng?_.lng-=360:_.lng+=360}return _}au.prototype.down=function(_,E){this.mouseRotate.mousedown(_,E),this.mousePitch&&this.mousePitch.mousedown(_,E),yt.disableDrag()},au.prototype.move=function(_,E){var b=this.map,A=this.mouseRotate.mousemoveWindow(_,E);if(A&&A.bearingDelta&&b.setBearing(b.getBearing()+A.bearingDelta),this.mousePitch){var B=this.mousePitch.mousemoveWindow(_,E);B&&B.pitchDelta&&b.setPitch(b.getPitch()+B.pitchDelta)}},au.prototype.off=function(){var _=this.element;yt.removeEventListener(_,"mousedown",this.mousedown),yt.removeEventListener(_,"touchstart",this.touchstart,{passive:!1}),yt.removeEventListener(_,"touchmove",this.touchmove),yt.removeEventListener(_,"touchend",this.touchend),yt.removeEventListener(_,"touchcancel",this.reset),this.offTemp()},au.prototype.offTemp=function(){yt.enableDrag(),yt.removeEventListener(R.window,"mousemove",this.mousemove),yt.removeEventListener(R.window,"mouseup",this.mouseup)},au.prototype.mousedown=function(_){this.down(R.extend({},_,{ctrlKey:!0,preventDefault:function(){return _.preventDefault()}}),yt.mousePos(this.element,_)),yt.addEventListener(R.window,"mousemove",this.mousemove),yt.addEventListener(R.window,"mouseup",this.mouseup)},au.prototype.mousemove=function(_){this.move(_,yt.mousePos(this.element,_))},au.prototype.mouseup=function(_){this.mouseRotate.mouseupWindow(_),this.mousePitch&&this.mousePitch.mouseupWindow(_),this.offTemp()},au.prototype.touchstart=function(_){_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=yt.touchPos(this.element,_.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return _.preventDefault()}},this._startPos))},au.prototype.touchmove=function(_){_.targetTouches.length!==1?this.reset():(this._lastPos=yt.touchPos(this.element,_.targetTouches)[0],this.move({preventDefault:function(){return _.preventDefault()}},this._lastPos))},au.prototype.touchend=function(_){_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},au.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Gr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ih(_,E,b){var A=_.classList;for(var B in Gr)A.remove("mapboxgl-"+b+"-anchor-"+B);A.add("mapboxgl-"+b+"-anchor-"+E)}var Xc,jd=function(_){function E(b,A){if(_.call(this),(b instanceof R.window.HTMLElement||A)&&(b=R.extend({element:b},A)),R.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=b&&b.anchor||"center",this._color=b&&b.color||"#3FB1CE",this._scale=b&&b.scale||1,this._draggable=b&&b.draggable||!1,this._clickTolerance=b&&b.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=b&&b.rotation||0,this._rotationAlignment=b&&b.rotationAlignment||"auto",this._pitchAlignment=b&&b.pitchAlignment&&b.pitchAlignment!=="auto"?b.pitchAlignment:this._rotationAlignment,b&&b.element)this._element=b.element,this._offset=R.Point.convert(b&&b.offset||[0,0]);else{this._defaultMarker=!0,this._element=yt.create("div"),this._element.setAttribute("aria-label","Map marker");var B=yt.createNS("http://www.w3.org/2000/svg","svg");B.setAttributeNS(null,"display","block"),B.setAttributeNS(null,"height","41px"),B.setAttributeNS(null,"width","27px"),B.setAttributeNS(null,"viewBox","0 0 27 41");var H=yt.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"stroke","none"),H.setAttributeNS(null,"stroke-width","1"),H.setAttributeNS(null,"fill","none"),H.setAttributeNS(null,"fill-rule","evenodd");var Y=yt.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"fill-rule","nonzero");var et=yt.createNS("http://www.w3.org/2000/svg","g");et.setAttributeNS(null,"transform","translate(3.0, 29.0)"),et.setAttributeNS(null,"fill","#000000");for(var St=0,Rt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];St<Rt.length;St+=1){var ye=Rt[St],be=yt.createNS("http://www.w3.org/2000/svg","ellipse");be.setAttributeNS(null,"opacity","0.04"),be.setAttributeNS(null,"cx","10.5"),be.setAttributeNS(null,"cy","5.80029008"),be.setAttributeNS(null,"rx",ye.rx),be.setAttributeNS(null,"ry",ye.ry),et.appendChild(be)}var Oe=yt.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"fill",this._color);var on=yt.createNS("http://www.w3.org/2000/svg","path");on.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Oe.appendChild(on);var Qe=yt.createNS("http://www.w3.org/2000/svg","g");Qe.setAttributeNS(null,"opacity","0.25"),Qe.setAttributeNS(null,"fill","#000000");var vn=yt.createNS("http://www.w3.org/2000/svg","path");vn.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Qe.appendChild(vn);var Ye=yt.createNS("http://www.w3.org/2000/svg","g");Ye.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ye.setAttributeNS(null,"fill","#FFFFFF");var On=yt.createNS("http://www.w3.org/2000/svg","g");On.setAttributeNS(null,"transform","translate(8.0, 8.0)");var jn=yt.createNS("http://www.w3.org/2000/svg","circle");jn.setAttributeNS(null,"fill","#000000"),jn.setAttributeNS(null,"opacity","0.25"),jn.setAttributeNS(null,"cx","5.5"),jn.setAttributeNS(null,"cy","5.5"),jn.setAttributeNS(null,"r","5.4999962");var ar=yt.createNS("http://www.w3.org/2000/svg","circle");ar.setAttributeNS(null,"fill","#FFFFFF"),ar.setAttributeNS(null,"cx","5.5"),ar.setAttributeNS(null,"cy","5.5"),ar.setAttributeNS(null,"r","5.4999962"),On.appendChild(jn),On.appendChild(ar),Y.appendChild(et),Y.appendChild(Oe),Y.appendChild(Qe),Y.appendChild(Ye),Y.appendChild(On),B.appendChild(Y),B.setAttributeNS(null,"height",41*this._scale+"px"),B.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(B),this._offset=R.Point.convert(b&&b.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Or){Or.preventDefault()}),this._element.addEventListener("mousedown",function(Or){Or.preventDefault()}),ih(this._element,this._anchor,"marker"),this._popup=null}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.addTo=function(b){return this.remove(),this._map=b,b.getCanvasContainer().appendChild(this._element),b.on("move",this._update),b.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},E.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),yt.remove(this._element),this._popup&&this._popup.remove(),this},E.prototype.getLngLat=function(){return this._lngLat},E.prototype.setLngLat=function(b){return this._lngLat=R.LngLat.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},E.prototype.getElement=function(){return this._element},E.prototype.setPopup=function(b){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),b){if(!("offset"in b.options)){var A=Math.sqrt(Math.pow(13.5,2)/2);b.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(24.6+A)],"bottom-right":[-A,-1*(24.6+A)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=b,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},E.prototype._onKeyPress=function(b){var A=b.code,B=b.charCode||b.keyCode;A!=="Space"&&A!=="Enter"&&B!==32&&B!==13||this.togglePopup()},E.prototype._onMapClick=function(b){var A=b.originalEvent.target,B=this._element;this._popup&&(A===B||B.contains(A))&&this.togglePopup()},E.prototype.getPopup=function(){return this._popup},E.prototype.togglePopup=function(){var b=this._popup;return b?(b.isOpen()?b.remove():b.addTo(this._map),this):this},E.prototype._update=function(b){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=zd(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var A="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?A="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(A="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var B="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?B="rotateX(0deg)":this._pitchAlignment==="map"&&(B="rotateX("+this._map.getPitch()+"deg)"),b&&b.type!=="moveend"||(this._pos=this._pos.round()),yt.setTransform(this._element,Gr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+B+" "+A)}},E.prototype.getOffset=function(){return this._offset},E.prototype.setOffset=function(b){return this._offset=R.Point.convert(b),this._update(),this},E.prototype._onMove=function(b){if(!this._isDragging){var A=this._clickTolerance||this._map._clickTolerance;this._isDragging=b.point.dist(this._pointerdownPos)>=A}this._isDragging&&(this._pos=b.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new R.Event("dragstart"))),this.fire(new R.Event("drag")))},E.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new R.Event("dragend")),this._state="inactive"},E.prototype._addDragHandler=function(b){this._element.contains(b.originalEvent.target)&&(b.preventDefault(),this._positionDelta=b.point.sub(this._pos).add(this._offset),this._pointerdownPos=b.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},E.prototype.setDraggable=function(b){return this._draggable=!!b,this._map&&(b?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},E.prototype.isDraggable=function(){return this._draggable},E.prototype.setRotation=function(b){return this._rotation=b||0,this._update(),this},E.prototype.getRotation=function(){return this._rotation},E.prototype.setRotationAlignment=function(b){return this._rotationAlignment=b||"auto",this._update(),this},E.prototype.getRotationAlignment=function(){return this._rotationAlignment},E.prototype.setPitchAlignment=function(b){return this._pitchAlignment=b&&b!=="auto"?b:this._rotationAlignment,this._update(),this},E.prototype.getPitchAlignment=function(){return this._pitchAlignment},E}(R.Evented),bh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},oh=0,ah=!1,Qp=function(_){function E(b){_.call(this),this.options=R.extend({},bh,b),R.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.onAdd=function(b){var A;return this._map=b,this._container=yt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),A=this._setupUI,Xc!==void 0?A(Xc):R.window.navigator.permissions!==void 0?R.window.navigator.permissions.query({name:"geolocation"}).then(function(B){A(Xc=B.state!=="denied")}):A(Xc=!!R.window.navigator.geolocation),this._container},E.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(R.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),yt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,oh=0,ah=!1},E.prototype._isOutOfMapMaxBounds=function(b){var A=this._map.getMaxBounds(),B=b.coords;return A&&(B.longitude<A.getWest()||B.longitude>A.getEast()||B.latitude<A.getSouth()||B.latitude>A.getNorth())},E.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},E.prototype._onSuccess=function(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new R.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new R.Event("geolocate",b)),this._finish()}},E.prototype._updateCamera=function(b){var A=new R.LngLat(b.coords.longitude,b.coords.latitude),B=b.coords.accuracy,H=this._map.getBearing(),Y=R.extend({bearing:H},this.options.fitBoundsOptions);this._map.fitBounds(A.toBounds(B),Y,{geolocateSource:!0})},E.prototype._updateMarker=function(b){if(b){var A=new R.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(A).addTo(this._map),this._userLocationDotMarker.setLngLat(A).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},E.prototype._updateCircleRadius=function(){var b=this._map._container.clientHeight/2,A=this._map.unproject([0,b]),B=this._map.unproject([1,b]),H=A.distanceTo(B),Y=Math.ceil(2*this._accuracy/H);this._circleElement.style.width=Y+"px",this._circleElement.style.height=Y+"px"},E.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},E.prototype._onError=function(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var A=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&ah)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new R.Event("error",b)),this._finish()}},E.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},E.prototype._setupUI=function(b){var A=this;if(this._container.addEventListener("contextmenu",function(Y){return Y.preventDefault()}),this._geolocateButton=yt.create("button","mapboxgl-ctrl-geolocate",this._container),yt.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",b===!1){R.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var B=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=B,this._geolocateButton.setAttribute("aria-label",B)}else{var H=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=yt.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new jd(this._dotElement),this._circleElement=yt.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Y){Y.geolocateSource||A._watchState!=="ACTIVE_LOCK"||Y.originalEvent&&Y.originalEvent.type==="resize"||(A._watchState="BACKGROUND",A._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),A._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),A.fire(new R.Event("trackuserlocationend")))})},E.prototype.trigger=function(){if(!this._setup)return R.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new R.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":oh--,ah=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new R.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new R.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++oh>1?(b={maximumAge:6e5,timeout:0},ah=!0):(b=this.options.positionOptions,ah=!1),this._geolocationWatchID=R.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else R.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},E.prototype._clearWatch=function(){R.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},E}(R.Evented),sh={maxWidth:100,unit:"metric"},Bf=function(_){this.options=R.extend({},sh,_),R.bindAll(["_onMove","setUnit"],this)};function Eh(_,E,b){var A=b&&b.maxWidth||100,B=_._container.clientHeight/2,H=_.unproject([0,B]),Y=_.unproject([A,B]),et=H.distanceTo(Y);if(b&&b.unit==="imperial"){var St=3.2808*et;St>5280?Al(E,A,St/5280,_._getUIString("ScaleControl.Miles")):Al(E,A,St,_._getUIString("ScaleControl.Feet"))}else b&&b.unit==="nautical"?Al(E,A,et/1852,_._getUIString("ScaleControl.NauticalMiles")):et>=1e3?Al(E,A,et/1e3,_._getUIString("ScaleControl.Kilometers")):Al(E,A,et,_._getUIString("ScaleControl.Meters"))}function Al(_,E,b,A){var B,H,Y,et=(B=b,(H=Math.pow(10,(""+Math.floor(B)).length-1))*(Y=(Y=B/H)>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:function(St){var Rt=Math.pow(10,Math.ceil(-Math.log(St)/Math.LN10));return Math.round(St*Rt)/Rt}(Y)));_.style.width=E*(et/b)+"px",_.innerHTML=et+"&nbsp;"+A}Bf.prototype.getDefaultPosition=function(){return"bottom-left"},Bf.prototype._onMove=function(){Eh(this._map,this._container,this.options)},Bf.prototype.onAdd=function(_){return this._map=_,this._container=yt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Bf.prototype.onRemove=function(){yt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Bf.prototype.setUnit=function(_){this.options.unit=_,Eh(this._map,this._container,this.options)};var Qa=function(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof R.window.HTMLElement?this._container=_.container:R.warnOnce("Full screen control 'container' must be a DOM element.")),R.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in R.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in R.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in R.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in R.window.document&&(this._fullscreenchange="MSFullscreenChange")};Qa.prototype.onAdd=function(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=yt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",R.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Qa.prototype.onRemove=function(){yt.remove(this._controlContainer),this._map=null,R.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Qa.prototype._checkFullscreenSupport=function(){return!!(R.window.document.fullscreenEnabled||R.window.document.mozFullScreenEnabled||R.window.document.msFullscreenEnabled||R.window.document.webkitFullscreenEnabled)},Qa.prototype._setupUI=function(){var _=this._fullscreenButton=yt.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);yt.create("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden",!0),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),R.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Qa.prototype._updateTitle=function(){var _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_},Qa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Qa.prototype._isFullscreen=function(){return this._fullscreen},Qa.prototype._changeIcon=function(){(R.window.document.fullscreenElement||R.window.document.mozFullScreenElement||R.window.document.webkitFullscreenElement||R.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Qa.prototype._onClickFullscreen=function(){this._isFullscreen()?R.window.document.exitFullscreen?R.window.document.exitFullscreen():R.window.document.mozCancelFullScreen?R.window.document.mozCancelFullScreen():R.window.document.msExitFullscreen?R.window.document.msExitFullscreen():R.window.document.webkitCancelFullScreen&&R.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ju={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Jp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),L0=function(_){function E(b){_.call(this),this.options=R.extend(Object.create(ju),b),R.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return _&&(E.__proto__=_),(E.prototype=Object.create(_&&_.prototype)).constructor=E,E.prototype.addTo=function(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new R.Event("open")),this},E.prototype.isOpen=function(){return!!this._map},E.prototype.remove=function(){return this._content&&yt.remove(this._content),this._container&&(yt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new R.Event("close")),this},E.prototype.getLngLat=function(){return this._lngLat},E.prototype.setLngLat=function(b){return this._lngLat=R.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},E.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},E.prototype.getElement=function(){return this._container},E.prototype.setText=function(b){return this.setDOMContent(R.window.document.createTextNode(b))},E.prototype.setHTML=function(b){var A,B=R.window.document.createDocumentFragment(),H=R.window.document.createElement("body");for(H.innerHTML=b;A=H.firstChild;)B.appendChild(A);return this.setDOMContent(B)},E.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},E.prototype.setMaxWidth=function(b){return this.options.maxWidth=b,this._update(),this},E.prototype.setDOMContent=function(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=yt.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this},E.prototype.addClassName=function(b){this._container&&this._container.classList.add(b)},E.prototype.removeClassName=function(b){this._container&&this._container.classList.remove(b)},E.prototype.setOffset=function(b){return this.options.offset=b,this._update(),this},E.prototype.toggleClassName=function(b){if(this._container)return this._container.classList.toggle(b)},E.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=yt.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},E.prototype._onMouseUp=function(b){this._update(b.point)},E.prototype._onMouseMove=function(b){this._update(b.point)},E.prototype._onDrag=function(b){this._update(b.point)},E.prototype._update=function(b){var A=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=yt.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=yt.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(be){return A._container.classList.add(be)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zd(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||b)){var B=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat),H=this.options.anchor,Y=function be(Oe){if(Oe){if(typeof Oe=="number"){var on=Math.round(Math.sqrt(.5*Math.pow(Oe,2)));return{center:new R.Point(0,0),top:new R.Point(0,Oe),"top-left":new R.Point(on,on),"top-right":new R.Point(-on,on),bottom:new R.Point(0,-Oe),"bottom-left":new R.Point(on,-on),"bottom-right":new R.Point(-on,-on),left:new R.Point(Oe,0),right:new R.Point(-Oe,0)}}if(Oe instanceof R.Point||Array.isArray(Oe)){var Qe=R.Point.convert(Oe);return{center:Qe,top:Qe,"top-left":Qe,"top-right":Qe,bottom:Qe,"bottom-left":Qe,"bottom-right":Qe,left:Qe,right:Qe}}return{center:R.Point.convert(Oe.center||[0,0]),top:R.Point.convert(Oe.top||[0,0]),"top-left":R.Point.convert(Oe["top-left"]||[0,0]),"top-right":R.Point.convert(Oe["top-right"]||[0,0]),bottom:R.Point.convert(Oe.bottom||[0,0]),"bottom-left":R.Point.convert(Oe["bottom-left"]||[0,0]),"bottom-right":R.Point.convert(Oe["bottom-right"]||[0,0]),left:R.Point.convert(Oe.left||[0,0]),right:R.Point.convert(Oe.right||[0,0])}}return be(new R.Point(0,0))}(this.options.offset);if(!H){var et,St=this._container.offsetWidth,Rt=this._container.offsetHeight;et=B.y+Y.bottom.y<Rt?["top"]:B.y>this._map.transform.height-Rt?["bottom"]:[],B.x<St/2?et.push("left"):B.x>this._map.transform.width-St/2&&et.push("right"),H=et.length===0?"bottom":et.join("-")}var ye=B.add(Y[H]).round();yt.setTransform(this._container,Gr[H]+" translate("+ye.x+"px,"+ye.y+"px)"),ih(this._container,H,"popup")}},E.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var b=this._container.querySelector(Jp);b&&b.focus()}},E.prototype._onClose=function(){this.remove()},E}(R.Evented),t0={version:R.version,supported:$e,setRTLTextPlugin:R.setRTLTextPlugin,getRTLTextPluginStatus:R.getRTLTextPluginStatus,Map:I0,NavigationControl:xh,GeolocateControl:Qp,AttributionControl:ou,ScaleControl:Bf,FullscreenControl:Qa,Popup:L0,Marker:jd,Style:ac,LngLat:R.LngLat,LngLatBounds:R.LngLatBounds,Point:R.Point,MercatorCoordinate:R.MercatorCoordinate,Evented:R.Evented,config:R.config,prewarm:function(){Ar().acquire(vr)},clearPrewarmedResources:function(){var _=jr;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(vr),jr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return R.config.ACCESS_TOKEN},set accessToken(_){R.config.ACCESS_TOKEN=_},get baseApiUrl(){return R.config.API_URL},set baseApiUrl(_){R.config.API_URL=_},get workerCount(){return Ur.workerCount},set workerCount(_){Ur.workerCount=_},get maxParallelImageRequests(){return R.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){R.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage:function(_){R.clearTileCache(_)},workerUrl:""};return t0}),ne})},92077:function(br,rr,it){var ne,pt;(function(R,$e){ne=$e,pt=typeof ne=="function"?ne.call(rr,it,rr,br):ne,pt!==void 0&&(br.exports=pt)})(this,function(){var R,$e,yt="2.0.6",xe={},le={},Le={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},Lt={currentLocale:Le.currentLocale,zeroFormat:Le.zeroFormat,nullFormat:Le.nullFormat,defaultFormat:Le.defaultFormat,scalePercentBy100:Le.scalePercentBy100};function fn(Nt,Jt){this._input=Nt,this._value=Jt}return R=function(Nt){var Jt,Ie,fe,ce;if(R.isNumeral(Nt))Jt=Nt.value();else if(Nt===0||typeof Nt=="undefined")Jt=0;else if(Nt===null||$e.isNaN(Nt))Jt=null;else if(typeof Nt=="string")if(Lt.zeroFormat&&Nt===Lt.zeroFormat)Jt=0;else if(Lt.nullFormat&&Nt===Lt.nullFormat||!Nt.replace(/[^0-9]+/g,"").length)Jt=null;else{for(Ie in xe)if(ce=typeof xe[Ie].regexps.unformat=="function"?xe[Ie].regexps.unformat():xe[Ie].regexps.unformat,ce&&Nt.match(ce)){fe=xe[Ie].unformat;break}fe=fe||R._.stringToNumber,Jt=fe(Nt)}else Jt=Number(Nt)||null;return new fn(Nt,Jt)},R.version=yt,R.isNumeral=function(Nt){return Nt instanceof fn},R._=$e={numberToFormat:function(Nt,Jt,Ie){var fe=le[R.options.currentLocale],ce=!1,ve=!1,Ze=0,Un="",En=1e12,Vn=1e9,mr=1e6,or=1e3,He="",$t=!1,nn,ke,Je,er,kt,Te,gt,te,Zt,Ut;if(Nt=Nt||0,ke=Math.abs(Nt),R._.includes(Jt,"(")?(ce=!0,Jt=Jt.replace(/[\(|\)]/g,"")):(R._.includes(Jt,"+")||R._.includes(Jt,"-"))&&(te=R._.includes(Jt,"+")?Jt.indexOf("+"):Nt<0?Jt.indexOf("-"):-1,Jt=Jt.replace(/[\+|\-]/g,"")),R._.includes(Jt,"a")&&(nn=Jt.match(/a(k|m|b|t)?/),nn=nn?nn[1]:!1,R._.includes(Jt," a")&&(Un=" "),Jt=Jt.replace(new RegExp(Un+"a[kmbt]?"),""),ke>=En&&!nn||nn==="t"?(Un+=fe.abbreviations.trillion,Nt=Nt/En):ke<En&&ke>=Vn&&!nn||nn==="b"?(Un+=fe.abbreviations.billion,Nt=Nt/Vn):ke<Vn&&ke>=mr&&!nn||nn==="m"?(Un+=fe.abbreviations.million,Nt=Nt/mr):(ke<mr&&ke>=or&&!nn||nn==="k")&&(Un+=fe.abbreviations.thousand,Nt=Nt/or)),R._.includes(Jt,"[.]")&&(ve=!0,Jt=Jt.replace("[.]",".")),Te=Nt.toString().split(".")[0],gt=Jt.split(".")[1],Zt=Jt.indexOf(","),Ze=(Jt.split(".")[0].split(",")[0].match(/0/g)||[]).length,gt?(R._.includes(gt,"[")?(gt=gt.replace("]",""),gt=gt.split("["),He=R._.toFixed(Nt,gt[0].length+gt[1].length,Ie,gt[1].length)):He=R._.toFixed(Nt,gt.length,Ie),Te=He.split(".")[0],R._.includes(He,".")?He=fe.delimiters.decimal+He.split(".")[1]:He="",ve&&Number(He.slice(1))===0&&(He="")):Te=R._.toFixed(Nt,0,Ie),Un&&!nn&&Number(Te)>=1e3&&Un!==fe.abbreviations.trillion)switch(Te=String(Number(Te)/1e3),Un){case fe.abbreviations.thousand:Un=fe.abbreviations.million;break;case fe.abbreviations.million:Un=fe.abbreviations.billion;break;case fe.abbreviations.billion:Un=fe.abbreviations.trillion;break}if(R._.includes(Te,"-")&&(Te=Te.slice(1),$t=!0),Te.length<Ze)for(var we=Ze-Te.length;we>0;we--)Te="0"+Te;return Zt>-1&&(Te=Te.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+fe.delimiters.thousands)),Jt.indexOf(".")===0&&(Te=""),Ut=Te+He+(Un||""),ce?Ut=(ce&&$t?"(":"")+Ut+(ce&&$t?")":""):te>=0?Ut=te===0?($t?"-":"+")+Ut:Ut+($t?"-":"+"):$t&&(Ut="-"+Ut),Ut},stringToNumber:function(Nt){var Jt=le[Lt.currentLocale],Ie=Nt,fe={thousand:3,million:6,billion:9,trillion:12},ce,ve,Ze,Un;if(Lt.zeroFormat&&Nt===Lt.zeroFormat)ve=0;else if(Lt.nullFormat&&Nt===Lt.nullFormat||!Nt.replace(/[^0-9]+/g,"").length)ve=null;else{ve=1,Jt.delimiters.decimal!=="."&&(Nt=Nt.replace(/\./g,"").replace(Jt.delimiters.decimal,"."));for(ce in fe)if(Un=new RegExp("[^a-zA-Z]"+Jt.abbreviations[ce]+"(?:\\)|(\\"+Jt.currency.symbol+")?(?:\\))?)?$"),Ie.match(Un)){ve*=Math.pow(10,fe[ce]);break}ve*=(Nt.split("-").length+Math.min(Nt.split("(").length-1,Nt.split(")").length-1))%2?1:-1,Nt=Nt.replace(/[^0-9\.]+/g,""),ve*=Number(Nt)}return ve},isNaN:function(Nt){return typeof Nt=="number"&&isNaN(Nt)},includes:function(Nt,Jt){return Nt.indexOf(Jt)!==-1},insert:function(Nt,Jt,Ie){return Nt.slice(0,Ie)+Jt+Nt.slice(Ie)},reduce:function(Nt,Jt){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof Jt!="function")throw new TypeError(Jt+" is not a function");var Ie=Object(Nt),fe=Ie.length>>>0,ce=0,ve;if(arguments.length===3)ve=arguments[2];else{for(;ce<fe&&!(ce in Ie);)ce++;if(ce>=fe)throw new TypeError("Reduce of empty array with no initial value");ve=Ie[ce++]}for(;ce<fe;ce++)ce in Ie&&(ve=Jt(ve,Ie[ce],ce,Ie));return ve},multiplier:function(Nt){var Jt=Nt.toString().split(".");return Jt.length<2?1:Math.pow(10,Jt[1].length)},correctionFactor:function(){var Nt=Array.prototype.slice.call(arguments);return Nt.reduce(function(Jt,Ie){var fe=$e.multiplier(Ie);return Jt>fe?Jt:fe},1)},toFixed:function(Nt,Jt,Ie,fe){var ce=Nt.toString().split("."),ve=Jt-(fe||0),Ze,Un,En,Vn;return ce.length===2?Ze=Math.min(Math.max(ce[1].length,ve),Jt):Ze=ve,En=Math.pow(10,Ze),Vn=(Ie(Nt+"e+"+Ze)/En).toFixed(Ze),fe>Jt-Ze&&(Un=new RegExp("\\.?0{1,"+(fe-(Jt-Ze))+"}$"),Vn=Vn.replace(Un,"")),Vn}},R.options=Lt,R.formats=xe,R.locales=le,R.locale=function(Nt){return Nt&&(Lt.currentLocale=Nt.toLowerCase()),Lt.currentLocale},R.localeData=function(Nt){if(!Nt)return le[Lt.currentLocale];if(Nt=Nt.toLowerCase(),!le[Nt])throw new Error("Unknown locale : "+Nt);return le[Nt]},R.reset=function(){for(var Nt in Le)Lt[Nt]=Le[Nt]},R.zeroFormat=function(Nt){Lt.zeroFormat=typeof Nt=="string"?Nt:null},R.nullFormat=function(Nt){Lt.nullFormat=typeof Nt=="string"?Nt:null},R.defaultFormat=function(Nt){Lt.defaultFormat=typeof Nt=="string"?Nt:"0.0"},R.register=function(Nt,Jt,Ie){if(Jt=Jt.toLowerCase(),this[Nt+"s"][Jt])throw new TypeError(Jt+" "+Nt+" already registered.");return this[Nt+"s"][Jt]=Ie,Ie},R.validate=function(Nt,Jt){var Ie,fe,ce,ve,Ze,Un,En,Vn;if(typeof Nt!="string"&&(Nt+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",Nt)),Nt=Nt.trim(),Nt.match(/^\d+$/))return!0;if(Nt==="")return!1;try{En=R.localeData(Jt)}catch(mr){En=R.localeData(R.locale())}return ce=En.currency.symbol,Ze=En.abbreviations,Ie=En.delimiters.decimal,En.delimiters.thousands==="."?fe="\\.":fe=En.delimiters.thousands,Vn=Nt.match(/^[^\d]+/),Vn!==null&&(Nt=Nt.substr(1),Vn[0]!==ce)||(Vn=Nt.match(/[^\d]+$/),Vn!==null&&(Nt=Nt.slice(0,-1),Vn[0]!==Ze.thousand&&Vn[0]!==Ze.million&&Vn[0]!==Ze.billion&&Vn[0]!==Ze.trillion))?!1:(Un=new RegExp(fe+"{2}"),Nt.match(/[^\d.,]/g)?!1:(ve=Nt.split(Ie),ve.length>2?!1:ve.length<2?!!ve[0].match(/^\d+.*\d$/)&&!ve[0].match(Un):ve[0].length===1?!!ve[0].match(/^\d+$/)&&!ve[0].match(Un)&&!!ve[1].match(/^\d+$/):!!ve[0].match(/^\d+.*\d$/)&&!ve[0].match(Un)&&!!ve[1].match(/^\d+$/)))},R.fn=fn.prototype={clone:function(){return R(this)},format:function(Nt,Jt){var Ie=this._value,fe=Nt||Lt.defaultFormat,ce,ve,Ze;if(Jt=Jt||Math.round,Ie===0&&Lt.zeroFormat!==null)ve=Lt.zeroFormat;else if(Ie===null&&Lt.nullFormat!==null)ve=Lt.nullFormat;else{for(ce in xe)if(fe.match(xe[ce].regexps.format)){Ze=xe[ce].format;break}Ze=Ze||R._.numberToFormat,ve=Ze(Ie,fe,Jt)}return ve},value:function(){return this._value},input:function(){return this._input},set:function(Nt){return this._value=Number(Nt),this},add:function(Nt){var Jt=$e.correctionFactor.call(null,this._value,Nt);function Ie(fe,ce,ve,Ze){return fe+Math.round(Jt*ce)}return this._value=$e.reduce([this._value,Nt],Ie,0)/Jt,this},subtract:function(Nt){var Jt=$e.correctionFactor.call(null,this._value,Nt);function Ie(fe,ce,ve,Ze){return fe-Math.round(Jt*ce)}return this._value=$e.reduce([Nt],Ie,Math.round(this._value*Jt))/Jt,this},multiply:function(Nt){function Jt(Ie,fe,ce,ve){var Ze=$e.correctionFactor(Ie,fe);return Math.round(Ie*Ze)*Math.round(fe*Ze)/Math.round(Ze*Ze)}return this._value=$e.reduce([this._value,Nt],Jt,1),this},divide:function(Nt){function Jt(Ie,fe,ce,ve){var Ze=$e.correctionFactor(Ie,fe);return Math.round(Ie*Ze)/Math.round(fe*Ze)}return this._value=$e.reduce([this._value,Nt],Jt),this},difference:function(Nt){return Math.abs(R(this._value).subtract(Nt).value())}},R.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(Nt){var Jt=Nt%10;return~~(Nt%100/10)===1?"th":Jt===1?"st":Jt===2?"nd":Jt===3?"rd":"th"},currency:{symbol:"$"}}),function(){R.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(Nt,Jt,Ie){var fe=R._.includes(Jt," BPS")?" ":"",ce;return Nt=Nt*1e4,Jt=Jt.replace(/\s?BPS/,""),ce=R._.numberToFormat(Nt,Jt,Ie),R._.includes(ce,")")?(ce=ce.split(""),ce.splice(-1,0,fe+"BPS"),ce=ce.join("")):ce=ce+fe+"BPS",ce},unformat:function(Nt){return+(R._.stringToNumber(Nt)*1e-4).toFixed(15)}})}(),function(){var Nt={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},Jt={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},Ie=Nt.suffixes.concat(Jt.suffixes.filter(function(ce){return Nt.suffixes.indexOf(ce)<0})),fe=Ie.join("|");fe="("+fe.replace("B","B(?!PS)")+")",R.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(fe)},format:function(ce,ve,Ze){var Un,En=R._.includes(ve,"ib")?Jt:Nt,Vn=R._.includes(ve," b")||R._.includes(ve," ib")?" ":"",mr,or,He;for(ve=ve.replace(/\s?i?b/,""),mr=0;mr<=En.suffixes.length;mr++)if(or=Math.pow(En.base,mr),He=Math.pow(En.base,mr+1),ce===null||ce===0||ce>=or&&ce<He){Vn+=En.suffixes[mr],or>0&&(ce=ce/or);break}return Un=R._.numberToFormat(ce,ve,Ze),Un+Vn},unformat:function(ce){var ve=R._.stringToNumber(ce),Ze,Un;if(ve){for(Ze=Nt.suffixes.length-1;Ze>=0;Ze--){if(R._.includes(ce,Nt.suffixes[Ze])){Un=Math.pow(Nt.base,Ze);break}if(R._.includes(ce,Jt.suffixes[Ze])){Un=Math.pow(Jt.base,Ze);break}}ve*=Un||1}return ve}})}(),function(){R.register("format","currency",{regexps:{format:/(\$)/},format:function(Nt,Jt,Ie){var fe=R.locales[R.options.currentLocale],ce={before:Jt.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:Jt.match(/([\+|\-|\)|\s|\$]*)$/)[0]},ve,Ze,Un;for(Jt=Jt.replace(/\s?\$\s?/,""),ve=R._.numberToFormat(Nt,Jt,Ie),Nt>=0?(ce.before=ce.before.replace(/[\-\(]/,""),ce.after=ce.after.replace(/[\-\)]/,"")):Nt<0&&!R._.includes(ce.before,"-")&&!R._.includes(ce.before,"(")&&(ce.before="-"+ce.before),Un=0;Un<ce.before.length;Un++)switch(Ze=ce.before[Un],Ze){case"$":ve=R._.insert(ve,fe.currency.symbol,Un);break;case" ":ve=R._.insert(ve," ",Un+fe.currency.symbol.length-1);break}for(Un=ce.after.length-1;Un>=0;Un--)switch(Ze=ce.after[Un],Ze){case"$":ve=Un===ce.after.length-1?ve+fe.currency.symbol:R._.insert(ve,fe.currency.symbol,-(ce.after.length-(1+Un)));break;case" ":ve=Un===ce.after.length-1?ve+" ":R._.insert(ve," ",-(ce.after.length-(1+Un)+fe.currency.symbol.length-1));break}return ve}})}(),function(){R.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(Nt,Jt,Ie){var fe,ce=typeof Nt=="number"&&!R._.isNaN(Nt)?Nt.toExponential():"0e+0",ve=ce.split("e");return Jt=Jt.replace(/e[\+|\-]{1}0/,""),fe=R._.numberToFormat(Number(ve[0]),Jt,Ie),fe+"e"+ve[1]},unformat:function(Nt){var Jt=R._.includes(Nt,"e+")?Nt.split("e+"):Nt.split("e-"),Ie=Number(Jt[0]),fe=Number(Jt[1]);fe=R._.includes(Nt,"e-")?fe*=-1:fe;function ce(ve,Ze,Un,En){var Vn=R._.correctionFactor(ve,Ze),mr=ve*Vn*(Ze*Vn)/(Vn*Vn);return mr}return R._.reduce([Ie,Math.pow(10,fe)],ce,1)}})}(),function(){R.register("format","ordinal",{regexps:{format:/(o)/},format:function(Nt,Jt,Ie){var fe=R.locales[R.options.currentLocale],ce,ve=R._.includes(Jt," o")?" ":"";return Jt=Jt.replace(/\s?o/,""),ve+=fe.ordinal(Nt),ce=R._.numberToFormat(Nt,Jt,Ie),ce+ve}})}(),function(){R.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(Nt,Jt,Ie){var fe=R._.includes(Jt," %")?" ":"",ce;return R.options.scalePercentBy100&&(Nt=Nt*100),Jt=Jt.replace(/\s?\%/,""),ce=R._.numberToFormat(Nt,Jt,Ie),R._.includes(ce,")")?(ce=ce.split(""),ce.splice(-1,0,fe+"%"),ce=ce.join("")):ce=ce+fe+"%",ce},unformat:function(Nt){var Jt=R._.stringToNumber(Nt);return R.options.scalePercentBy100?Jt*.01:Jt}})}(),function(){R.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(Nt,Jt,Ie){var fe=Math.floor(Nt/60/60),ce=Math.floor((Nt-fe*60*60)/60),ve=Math.round(Nt-fe*60*60-ce*60);return fe+":"+(ce<10?"0"+ce:ce)+":"+(ve<10?"0"+ve:ve)},unformat:function(Nt){var Jt=Nt.split(":"),Ie=0;return Jt.length===3?(Ie=Ie+Number(Jt[0])*60*60,Ie=Ie+Number(Jt[1])*60,Ie=Ie+Number(Jt[2])):Jt.length===2&&(Ie=Ie+Number(Jt[0])*60,Ie=Ie+Number(Jt[1])),Number(Ie)}})}(),R})},3614:function(br,rr,it){"use strict";br.exports=pt;var ne=it(80645);function pt(kt){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(kt)?kt:new Uint8Array(kt||0),this.pos=0,this.type=0,this.length=this.buf.length}pt.Varint=0,pt.Fixed64=1,pt.Bytes=2,pt.Fixed32=5;var R=65536*65536,$e=1/R,yt=12,xe=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");pt.prototype={destroy:function(){this.buf=null},readFields:function(kt,Te,gt){for(gt=gt||this.length;this.pos<gt;){var te=this.readVarint(),Zt=te>>3,Ut=this.pos;this.type=te&7,kt(Zt,Te,this),this.pos===Ut&&this.skip(te)}return Te},readMessage:function(kt,Te){return this.readFields(kt,Te,this.readVarint()+this.pos)},readFixed32:function(){var kt=He(this.buf,this.pos);return this.pos+=4,kt},readSFixed32:function(){var kt=nn(this.buf,this.pos);return this.pos+=4,kt},readFixed64:function(){var kt=He(this.buf,this.pos)+He(this.buf,this.pos+4)*R;return this.pos+=8,kt},readSFixed64:function(){var kt=He(this.buf,this.pos)+nn(this.buf,this.pos+4)*R;return this.pos+=8,kt},readFloat:function(){var kt=ne.read(this.buf,this.pos,!0,23,4);return this.pos+=4,kt},readDouble:function(){var kt=ne.read(this.buf,this.pos,!0,52,8);return this.pos+=8,kt},readVarint:function(kt){var Te=this.buf,gt,te;return te=Te[this.pos++],gt=te&127,te<128||(te=Te[this.pos++],gt|=(te&127)<<7,te<128)||(te=Te[this.pos++],gt|=(te&127)<<14,te<128)||(te=Te[this.pos++],gt|=(te&127)<<21,te<128)?gt:(te=Te[this.pos],gt|=(te&15)<<28,le(gt,kt,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var kt=this.readVarint();return kt%2===1?(kt+1)/-2:kt/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var kt=this.readVarint()+this.pos,Te=this.pos;return this.pos=kt,kt-Te>=yt&&xe?Je(this.buf,Te,kt):ke(this.buf,Te,kt)},readBytes:function(){var kt=this.readVarint()+this.pos,Te=this.buf.subarray(this.pos,kt);return this.pos=kt,Te},readPackedVarint:function(kt,Te){if(this.type!==pt.Bytes)return kt.push(this.readVarint(Te));var gt=Le(this);for(kt=kt||[];this.pos<gt;)kt.push(this.readVarint(Te));return kt},readPackedSVarint:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readSVarint());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readSVarint());return kt},readPackedBoolean:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readBoolean());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readBoolean());return kt},readPackedFloat:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readFloat());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readFloat());return kt},readPackedDouble:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readDouble());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readDouble());return kt},readPackedFixed32:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readFixed32());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readFixed32());return kt},readPackedSFixed32:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readSFixed32());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readSFixed32());return kt},readPackedFixed64:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readFixed64());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readFixed64());return kt},readPackedSFixed64:function(kt){if(this.type!==pt.Bytes)return kt.push(this.readSFixed64());var Te=Le(this);for(kt=kt||[];this.pos<Te;)kt.push(this.readSFixed64());return kt},skip:function(kt){var Te=kt&7;if(Te===pt.Varint)for(;this.buf[this.pos++]>127;);else if(Te===pt.Bytes)this.pos=this.readVarint()+this.pos;else if(Te===pt.Fixed32)this.pos+=4;else if(Te===pt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Te)},writeTag:function(kt,Te){this.writeVarint(kt<<3|Te)},realloc:function(kt){for(var Te=this.length||16;Te<this.pos+kt;)Te*=2;if(Te!==this.length){var gt=new Uint8Array(Te);gt.set(this.buf),this.buf=gt,this.length=Te}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(kt){this.realloc(4),$t(this.buf,kt,this.pos),this.pos+=4},writeSFixed32:function(kt){this.realloc(4),$t(this.buf,kt,this.pos),this.pos+=4},writeFixed64:function(kt){this.realloc(8),$t(this.buf,kt&-1,this.pos),$t(this.buf,Math.floor(kt*$e),this.pos+4),this.pos+=8},writeSFixed64:function(kt){this.realloc(8),$t(this.buf,kt&-1,this.pos),$t(this.buf,Math.floor(kt*$e),this.pos+4),this.pos+=8},writeVarint:function(kt){if(kt=+kt||0,kt>268435455||kt<0){fn(kt,this);return}this.realloc(4),this.buf[this.pos++]=kt&127|(kt>127?128:0),!(kt<=127)&&(this.buf[this.pos++]=(kt>>>=7)&127|(kt>127?128:0),!(kt<=127)&&(this.buf[this.pos++]=(kt>>>=7)&127|(kt>127?128:0),!(kt<=127)&&(this.buf[this.pos++]=kt>>>7&127)))},writeSVarint:function(kt){this.writeVarint(kt<0?-kt*2-1:kt*2)},writeBoolean:function(kt){this.writeVarint(!!kt)},writeString:function(kt){kt=String(kt),this.realloc(kt.length*4),this.pos++;var Te=this.pos;this.pos=er(this.buf,kt,this.pos);var gt=this.pos-Te;gt>=128&&Ie(Te,gt,this),this.pos=Te-1,this.writeVarint(gt),this.pos+=gt},writeFloat:function(kt){this.realloc(4),ne.write(this.buf,kt,this.pos,!0,23,4),this.pos+=4},writeDouble:function(kt){this.realloc(8),ne.write(this.buf,kt,this.pos,!0,52,8),this.pos+=8},writeBytes:function(kt){var Te=kt.length;this.writeVarint(Te),this.realloc(Te);for(var gt=0;gt<Te;gt++)this.buf[this.pos++]=kt[gt]},writeRawMessage:function(kt,Te){this.pos++;var gt=this.pos;kt(Te,this);var te=this.pos-gt;te>=128&&Ie(gt,te,this),this.pos=gt-1,this.writeVarint(te),this.pos+=te},writeMessage:function(kt,Te,gt){this.writeTag(kt,pt.Bytes),this.writeRawMessage(Te,gt)},writePackedVarint:function(kt,Te){Te.length&&this.writeMessage(kt,fe,Te)},writePackedSVarint:function(kt,Te){Te.length&&this.writeMessage(kt,ce,Te)},writePackedBoolean:function(kt,Te){Te.length&&this.writeMessage(kt,Un,Te)},writePackedFloat:function(kt,Te){Te.length&&this.writeMessage(kt,ve,Te)},writePackedDouble:function(kt,Te){Te.length&&this.writeMessage(kt,Ze,Te)},writePackedFixed32:function(kt,Te){Te.length&&this.writeMessage(kt,En,Te)},writePackedSFixed32:function(kt,Te){Te.length&&this.writeMessage(kt,Vn,Te)},writePackedFixed64:function(kt,Te){Te.length&&this.writeMessage(kt,mr,Te)},writePackedSFixed64:function(kt,Te){Te.length&&this.writeMessage(kt,or,Te)},writeBytesField:function(kt,Te){this.writeTag(kt,pt.Bytes),this.writeBytes(Te)},writeFixed32Field:function(kt,Te){this.writeTag(kt,pt.Fixed32),this.writeFixed32(Te)},writeSFixed32Field:function(kt,Te){this.writeTag(kt,pt.Fixed32),this.writeSFixed32(Te)},writeFixed64Field:function(kt,Te){this.writeTag(kt,pt.Fixed64),this.writeFixed64(Te)},writeSFixed64Field:function(kt,Te){this.writeTag(kt,pt.Fixed64),this.writeSFixed64(Te)},writeVarintField:function(kt,Te){this.writeTag(kt,pt.Varint),this.writeVarint(Te)},writeSVarintField:function(kt,Te){this.writeTag(kt,pt.Varint),this.writeSVarint(Te)},writeStringField:function(kt,Te){this.writeTag(kt,pt.Bytes),this.writeString(Te)},writeFloatField:function(kt,Te){this.writeTag(kt,pt.Fixed32),this.writeFloat(Te)},writeDoubleField:function(kt,Te){this.writeTag(kt,pt.Fixed64),this.writeDouble(Te)},writeBooleanField:function(kt,Te){this.writeVarintField(kt,!!Te)}};function le(kt,Te,gt){var te=gt.buf,Zt,Ut;if(Ut=te[gt.pos++],Zt=(Ut&112)>>4,Ut<128||(Ut=te[gt.pos++],Zt|=(Ut&127)<<3,Ut<128)||(Ut=te[gt.pos++],Zt|=(Ut&127)<<10,Ut<128)||(Ut=te[gt.pos++],Zt|=(Ut&127)<<17,Ut<128)||(Ut=te[gt.pos++],Zt|=(Ut&127)<<24,Ut<128)||(Ut=te[gt.pos++],Zt|=(Ut&1)<<31,Ut<128))return Lt(kt,Zt,Te);throw new Error("Expected varint not more than 10 bytes")}function Le(kt){return kt.type===pt.Bytes?kt.readVarint()+kt.pos:kt.pos+1}function Lt(kt,Te,gt){return gt?Te*4294967296+(kt>>>0):(Te>>>0)*4294967296+(kt>>>0)}function fn(kt,Te){var gt,te;if(kt>=0?(gt=kt%4294967296|0,te=kt/4294967296|0):(gt=~(-kt%4294967296),te=~(-kt/4294967296),gt^4294967295?gt=gt+1|0:(gt=0,te=te+1|0)),kt>=18446744073709552e3||kt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Te.realloc(10),Nt(gt,te,Te),Jt(te,Te)}function Nt(kt,Te,gt){gt.buf[gt.pos++]=kt&127|128,kt>>>=7,gt.buf[gt.pos++]=kt&127|128,kt>>>=7,gt.buf[gt.pos++]=kt&127|128,kt>>>=7,gt.buf[gt.pos++]=kt&127|128,kt>>>=7,gt.buf[gt.pos]=kt&127}function Jt(kt,Te){var gt=(kt&7)<<4;Te.buf[Te.pos++]|=gt|((kt>>>=3)?128:0),kt&&(Te.buf[Te.pos++]=kt&127|((kt>>>=7)?128:0),kt&&(Te.buf[Te.pos++]=kt&127|((kt>>>=7)?128:0),kt&&(Te.buf[Te.pos++]=kt&127|((kt>>>=7)?128:0),kt&&(Te.buf[Te.pos++]=kt&127|((kt>>>=7)?128:0),kt&&(Te.buf[Te.pos++]=kt&127)))))}function Ie(kt,Te,gt){var te=Te<=16383?1:Te<=2097151?2:Te<=268435455?3:Math.floor(Math.log(Te)/(Math.LN2*7));gt.realloc(te);for(var Zt=gt.pos-1;Zt>=kt;Zt--)gt.buf[Zt+te]=gt.buf[Zt]}function fe(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeVarint(kt[gt])}function ce(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeSVarint(kt[gt])}function ve(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeFloat(kt[gt])}function Ze(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeDouble(kt[gt])}function Un(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeBoolean(kt[gt])}function En(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeFixed32(kt[gt])}function Vn(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeSFixed32(kt[gt])}function mr(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeFixed64(kt[gt])}function or(kt,Te){for(var gt=0;gt<kt.length;gt++)Te.writeSFixed64(kt[gt])}function He(kt,Te){return(kt[Te]|kt[Te+1]<<8|kt[Te+2]<<16)+kt[Te+3]*16777216}function $t(kt,Te,gt){kt[gt]=Te,kt[gt+1]=Te>>>8,kt[gt+2]=Te>>>16,kt[gt+3]=Te>>>24}function nn(kt,Te){return(kt[Te]|kt[Te+1]<<8|kt[Te+2]<<16)+(kt[Te+3]<<24)}function ke(kt,Te,gt){for(var te="",Zt=Te;Zt<gt;){var Ut=kt[Zt],we=null,ie=Ut>239?4:Ut>223?3:Ut>191?2:1;if(Zt+ie>gt)break;var _t,Ne,un;ie===1?Ut<128&&(we=Ut):ie===2?(_t=kt[Zt+1],(_t&192)===128&&(we=(Ut&31)<<6|_t&63,we<=127&&(we=null))):ie===3?(_t=kt[Zt+1],Ne=kt[Zt+2],(_t&192)===128&&(Ne&192)===128&&(we=(Ut&15)<<12|(_t&63)<<6|Ne&63,(we<=2047||we>=55296&&we<=57343)&&(we=null))):ie===4&&(_t=kt[Zt+1],Ne=kt[Zt+2],un=kt[Zt+3],(_t&192)===128&&(Ne&192)===128&&(un&192)===128&&(we=(Ut&15)<<18|(_t&63)<<12|(Ne&63)<<6|un&63,(we<=65535||we>=1114112)&&(we=null))),we===null?(we=65533,ie=1):we>65535&&(we-=65536,te+=String.fromCharCode(we>>>10&1023|55296),we=56320|we&1023),te+=String.fromCharCode(we),Zt+=ie}return te}function Je(kt,Te,gt){return xe.decode(kt.subarray(Te,gt))}function er(kt,Te,gt){for(var te=0,Zt,Ut;te<Te.length;te++){if(Zt=Te.charCodeAt(te),Zt>55295&&Zt<57344)if(Ut)if(Zt<56320){kt[gt++]=239,kt[gt++]=191,kt[gt++]=189,Ut=Zt;continue}else Zt=Ut-55296<<10|Zt-56320|65536,Ut=null;else{Zt>56319||te+1===Te.length?(kt[gt++]=239,kt[gt++]=191,kt[gt++]=189):Ut=Zt;continue}else Ut&&(kt[gt++]=239,kt[gt++]=191,kt[gt++]=189,Ut=null);Zt<128?kt[gt++]=Zt:(Zt<2048?kt[gt++]=Zt>>6|192:(Zt<65536?kt[gt++]=Zt>>12|224:(kt[gt++]=Zt>>18|240,kt[gt++]=Zt>>12&63|128),kt[gt++]=Zt>>6&63|128),kt[gt++]=Zt&63|128)}return gt}},73807:function(br){"use strict";var rr=br.exports;br.exports.isNumber=function(it){return typeof it=="number"},br.exports.findMin=function(it){if(it.length===0)return 1/0;for(var ne=it[0],pt=1;pt<it.length;pt++)ne=Math.min(ne,it[pt]);return ne},br.exports.findMax=function(it){if(it.length===0)return-1/0;for(var ne=it[0],pt=1;pt<it.length;pt++)ne=Math.max(ne,it[pt]);return ne},br.exports.findMinMulti=function(it){for(var ne=rr.findMin(it[0]),pt=1;pt<it.length;pt++)ne=Math.min(ne,rr.findMin(it[pt]));return ne},br.exports.findMaxMulti=function(it){for(var ne=rr.findMax(it[0]),pt=1;pt<it.length;pt++)ne=Math.max(ne,rr.findMax(it[pt]));return ne},br.exports.inside=function(it,ne,pt){return it<=pt&&pt<=ne}},53843:function(br,rr,it){"use strict";var ne=50,pt=2,R=Math.log(2),$e=br.exports,yt=it(73807);function xe(Le){return 1-Math.abs(Le)}br.exports.getUnifiedMinMax=function(Le,Lt){return $e.getUnifiedMinMaxMulti([Le],Lt)},br.exports.getUnifiedMinMaxMulti=function(Le,Lt){Lt=Lt||{};var fn=!1,Nt=!1,Jt=yt.isNumber(Lt.width)?Lt.width:pt,Ie=yt.isNumber(Lt.size)?Lt.size:ne,fe=yt.isNumber(Lt.min)?Lt.min:(fn=!0,yt.findMinMulti(Le)),ce=yt.isNumber(Lt.max)?Lt.max:(Nt=!0,yt.findMaxMulti(Le)),ve=ce-fe,Ze=ve/(Ie-1);return fn&&(fe=fe-2*Jt*Ze),Nt&&(ce=ce+2*Jt*Ze),{min:fe,max:ce}},br.exports.create=function(Le,Lt){if(Lt=Lt||{},!Le||Le.length===0)return[];var fn=yt.isNumber(Lt.size)?Lt.size:ne,Nt=yt.isNumber(Lt.width)?Lt.width:pt,Jt=$e.getUnifiedMinMax(Le,{size:fn,width:Nt,min:Lt.min,max:Lt.max}),Ie=Jt.min,fe=Jt.max,ce=fe-Ie,ve=ce/(fn-1);if(ce===0)return[{x:Ie,y:1}];for(var Ze=[],Un=0;Un<fn;Un++)Ze.push({x:Ie+Un*ve,y:0});var En=function(Je){return Math.floor((Je-Ie)/ve)},Vn=le(xe,Nt),mr=Vn[Nt],or=Vn[Nt-1]-Vn[Nt-2],He=0;Le.forEach(function(Je){var er=En(Je);if(!(er+Nt<0||er-Nt>=Ze.length)){var kt=Math.max(er-Nt,0),Te=er,gt=Math.min(er+Nt,Ze.length-1),te=kt-(er-Nt),Zt=er+Nt-gt,Ut=Vn[-Nt-1+te]||0,we=Vn[-Nt-1+Zt]||0,ie=mr/(mr-Ut-we);te>0&&(He+=ie*(te-1)*or);var _t=Math.max(0,er-Nt+1);yt.inside(0,Ze.length-1,_t)&&(Ze[_t].y+=ie*1*or),yt.inside(0,Ze.length-1,Te+1)&&(Ze[Te+1].y-=ie*2*or),yt.inside(0,Ze.length-1,gt+1)&&(Ze[gt+1].y+=ie*1*or)}});var $t=He,nn=0,ke=0;return Ze.forEach(function(Je){nn+=Je.y,$t+=nn,Je.y=$t,ke+=$t}),ke>0&&Ze.forEach(function(Je){Je.y/=ke}),Ze};function le(Le,Lt){for(var fn={},Nt=0,Jt=-Lt;Jt<=Lt;Jt++)Nt+=Le(Jt/Lt),fn[Jt]=Nt;return fn}br.exports.getExpectedValueFromPdf=function(Le){if(!(!Le||Le.length===0)){var Lt=0;return Le.forEach(function(fn){Lt+=fn.x*fn.y}),Lt}},br.exports.getXWithLeftTailArea=function(Le,Lt){if(!(!Le||Le.length===0)){for(var fn=0,Nt=0,Jt=0;Jt<Le.length&&(Nt=Jt,fn+=Le[Jt].y,!(fn>=Lt));Jt++);return Le[Nt].x}},br.exports.getPerplexity=function(Le){if(!(!Le||Le.length===0)){var Lt=0;return Le.forEach(function(fn){var Nt=Math.log(fn.y);isFinite(Nt)&&(Lt+=fn.y*Nt)}),Lt=-Lt/R,Math.pow(2,Lt)}}},32676:function(br,rr,it){var ne=it(34155);(function(pt,R){br.exports=R()})(this,function(){"use strict";function pt(Qt,ct){var bt={label:0,sent:function(){if(de[0]&1)throw de[1];return de[1]},trys:[],ops:[]},zt,me,de,bn;return bn={next:qn(0),throw:qn(1),return:qn(2)},typeof Symbol=="function"&&(bn[Symbol.iterator]=function(){return this}),bn;function qn(Gn){return function(ht){return Sr([Gn,ht])}}function Sr(Gn){if(zt)throw new TypeError("Generator is already executing.");for(;bt;)try{if(zt=1,me&&(de=Gn[0]&2?me.return:Gn[0]?me.throw||((de=me.return)&&de.call(me),0):me.next)&&!(de=de.call(me,Gn[1])).done)return de;switch(me=0,de&&(Gn=[Gn[0]&2,de.value]),Gn[0]){case 0:case 1:de=Gn;break;case 4:return bt.label++,{value:Gn[1],done:!1};case 5:bt.label++,me=Gn[1],Gn=[0];continue;case 7:Gn=bt.ops.pop(),bt.trys.pop();continue;default:if(de=bt.trys,!(de=de.length>0&&de[de.length-1])&&(Gn[0]===6||Gn[0]===2)){bt=0;continue}if(Gn[0]===3&&(!de||Gn[1]>de[0]&&Gn[1]<de[3])){bt.label=Gn[1];break}if(Gn[0]===6&&bt.label<de[1]){bt.label=de[1],de=Gn;break}if(de&&bt.label<de[2]){bt.label=de[2],bt.ops.push(Gn);break}de[2]&&bt.ops.pop(),bt.trys.pop();continue}Gn=ct.call(Qt,bt)}catch(ht){Gn=[6,ht],me=0}finally{zt=de=0}if(Gn[0]&5)throw Gn[1];return{value:Gn[0]?Gn[1]:void 0,done:!0}}}var R=function(){function Qt(ct,bt){this.next=null,this.key=ct,this.data=bt,this.left=null,this.right=null}return Qt}();function $e(Qt,ct){return Qt>ct?1:Qt<ct?-1:0}function yt(Qt,ct,bt){for(var zt=new R(null,null),me=zt,de=zt;;){var bn=bt(Qt,ct.key);if(bn<0){if(ct.left===null)break;if(bt(Qt,ct.left.key)<0){var qn=ct.left;if(ct.left=qn.right,qn.right=ct,ct=qn,ct.left===null)break}de.left=ct,de=ct,ct=ct.left}else if(bn>0){if(ct.right===null)break;if(bt(Qt,ct.right.key)>0){var qn=ct.right;if(ct.right=qn.left,qn.left=ct,ct=qn,ct.right===null)break}me.right=ct,me=ct,ct=ct.right}else break}return me.right=ct.left,de.left=ct.right,ct.left=zt.right,ct.right=zt.left,ct}function xe(Qt,ct,bt,zt){var me=new R(Qt,ct);if(bt===null)return me.left=me.right=null,me;bt=yt(Qt,bt,zt);var de=zt(Qt,bt.key);return de<0?(me.left=bt.left,me.right=bt,bt.left=null):de>=0&&(me.right=bt.right,me.left=bt,bt.right=null),me}function le(Qt,ct,bt){var zt=null,me=null;if(ct){ct=yt(Qt,ct,bt);var de=bt(ct.key,Qt);de===0?(zt=ct.left,me=ct.right):de<0?(me=ct.right,ct.right=null,zt=ct):(zt=ct.left,ct.left=null,me=ct)}return{left:zt,right:me}}function Le(Qt,ct,bt){return ct===null?Qt:(Qt===null||(ct=yt(Qt.key,ct,bt),ct.left=Qt),ct)}function Lt(Qt,ct,bt,zt,me){if(Qt){zt(""+ct+(bt?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+me(Qt)+`
`);var de=ct+(bt?"    ":"\u2502   ");Qt.left&&Lt(Qt.left,de,!1,zt,me),Qt.right&&Lt(Qt.right,de,!0,zt,me)}}var fn=function(){function Qt(ct){ct===void 0&&(ct=$e),this._root=null,this._size=0,this._comparator=ct}return Qt.prototype.insert=function(ct,bt){return this._size++,this._root=xe(ct,bt,this._root,this._comparator)},Qt.prototype.add=function(ct,bt){var zt=new R(ct,bt);this._root===null&&(zt.left=zt.right=null,this._size++,this._root=zt);var me=this._comparator,de=yt(ct,this._root,me),bn=me(ct,de.key);return bn===0?this._root=de:(bn<0?(zt.left=de.left,zt.right=de,de.left=null):bn>0&&(zt.right=de.right,zt.left=de,de.right=null),this._size++,this._root=zt),this._root},Qt.prototype.remove=function(ct){this._root=this._remove(ct,this._root,this._comparator)},Qt.prototype._remove=function(ct,bt,zt){var me;if(bt===null)return null;bt=yt(ct,bt,zt);var de=zt(ct,bt.key);return de===0?(bt.left===null?me=bt.right:(me=yt(ct,bt.left,zt),me.right=bt.right),this._size--,me):bt},Qt.prototype.pop=function(){var ct=this._root;if(ct){for(;ct.left;)ct=ct.left;return this._root=yt(ct.key,this._root,this._comparator),this._root=this._remove(ct.key,this._root,this._comparator),{key:ct.key,data:ct.data}}return null},Qt.prototype.findStatic=function(ct){for(var bt=this._root,zt=this._comparator;bt;){var me=zt(ct,bt.key);if(me===0)return bt;me<0?bt=bt.left:bt=bt.right}return null},Qt.prototype.find=function(ct){return this._root&&(this._root=yt(ct,this._root,this._comparator),this._comparator(ct,this._root.key)!==0)?null:this._root},Qt.prototype.contains=function(ct){for(var bt=this._root,zt=this._comparator;bt;){var me=zt(ct,bt.key);if(me===0)return!0;me<0?bt=bt.left:bt=bt.right}return!1},Qt.prototype.forEach=function(ct,bt){for(var zt=this._root,me=[],de=!1;!de;)zt!==null?(me.push(zt),zt=zt.left):me.length!==0?(zt=me.pop(),ct.call(bt,zt),zt=zt.right):de=!0;return this},Qt.prototype.range=function(ct,bt,zt,me){for(var de=[],bn=this._comparator,qn=this._root,Sr;de.length!==0||qn;)if(qn)de.push(qn),qn=qn.left;else{if(qn=de.pop(),Sr=bn(qn.key,bt),Sr>0)break;if(bn(qn.key,ct)>=0&&zt.call(me,qn))return this;qn=qn.right}return this},Qt.prototype.keys=function(){var ct=[];return this.forEach(function(bt){var zt=bt.key;return ct.push(zt)}),ct},Qt.prototype.values=function(){var ct=[];return this.forEach(function(bt){var zt=bt.data;return ct.push(zt)}),ct},Qt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Qt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Qt.prototype.minNode=function(ct){if(ct===void 0&&(ct=this._root),ct)for(;ct.left;)ct=ct.left;return ct},Qt.prototype.maxNode=function(ct){if(ct===void 0&&(ct=this._root),ct)for(;ct.right;)ct=ct.right;return ct},Qt.prototype.at=function(ct){for(var bt=this._root,zt=!1,me=0,de=[];!zt;)if(bt)de.push(bt),bt=bt.left;else if(de.length>0){if(bt=de.pop(),me===ct)return bt;me++,bt=bt.right}else zt=!0;return null},Qt.prototype.next=function(ct){var bt=this._root,zt=null;if(ct.right){for(zt=ct.right;zt.left;)zt=zt.left;return zt}for(var me=this._comparator;bt;){var de=me(ct.key,bt.key);if(de===0)break;de<0?(zt=bt,bt=bt.left):bt=bt.right}return zt},Qt.prototype.prev=function(ct){var bt=this._root,zt=null;if(ct.left!==null){for(zt=ct.left;zt.right;)zt=zt.right;return zt}for(var me=this._comparator;bt;){var de=me(ct.key,bt.key);if(de===0)break;de<0?bt=bt.left:(zt=bt,bt=bt.right)}return zt},Qt.prototype.clear=function(){return this._root=null,this._size=0,this},Qt.prototype.toList=function(){return Ie(this._root)},Qt.prototype.load=function(ct,bt,zt){bt===void 0&&(bt=[]),zt===void 0&&(zt=!1);var me=ct.length,de=this._comparator;if(zt&&ve(ct,bt,0,me-1,de),this._root===null)this._root=Nt(ct,bt,0,me),this._size=me;else{var bn=ce(this.toList(),Jt(ct,bt),de);me=this._size+me,this._root=fe({head:bn},0,me)}return this},Qt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Qt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Qt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Qt.prototype.toString=function(ct){ct===void 0&&(ct=function(zt){return String(zt.key)});var bt=[];return Lt(this._root,"",!0,function(zt){return bt.push(zt)},ct),bt.join("")},Qt.prototype.update=function(ct,bt,zt){var me=this._comparator,de=le(ct,this._root,me),bn=de.left,qn=de.right;me(ct,bt)<0?qn=xe(bt,zt,qn,me):bn=xe(bt,zt,bn,me),this._root=Le(bn,qn,me)},Qt.prototype.split=function(ct){return le(ct,this._root,this._comparator)},Qt.prototype[Symbol.iterator]=function(){var ct,bt,zt;return pt(this,function(me){switch(me.label){case 0:ct=this._root,bt=[],zt=!1,me.label=1;case 1:return zt?[3,6]:ct===null?[3,2]:(bt.push(ct),ct=ct.left,[3,5]);case 2:return bt.length===0?[3,4]:(ct=bt.pop(),[4,ct]);case 3:return me.sent(),ct=ct.right,[3,5];case 4:zt=!0,me.label=5;case 5:return[3,1];case 6:return[2]}})},Qt}();function Nt(Qt,ct,bt,zt){var me=zt-bt;if(me>0){var de=bt+Math.floor(me/2),bn=Qt[de],qn=ct[de],Sr=new R(bn,qn);return Sr.left=Nt(Qt,ct,bt,de),Sr.right=Nt(Qt,ct,de+1,zt),Sr}return null}function Jt(Qt,ct){for(var bt=new R(null,null),zt=bt,me=0;me<Qt.length;me++)zt=zt.next=new R(Qt[me],ct[me]);return zt.next=null,bt.next}function Ie(Qt){for(var ct=Qt,bt=[],zt=!1,me=new R(null,null),de=me;!zt;)ct?(bt.push(ct),ct=ct.left):bt.length>0?(ct=de=de.next=bt.pop(),ct=ct.right):zt=!0;return de.next=null,me.next}function fe(Qt,ct,bt){var zt=bt-ct;if(zt>0){var me=ct+Math.floor(zt/2),de=fe(Qt,ct,me),bn=Qt.head;return bn.left=de,Qt.head=Qt.head.next,bn.right=fe(Qt,me+1,bt),bn}return null}function ce(Qt,ct,bt){for(var zt=new R(null,null),me=zt,de=Qt,bn=ct;de!==null&&bn!==null;)bt(de.key,bn.key)<0?(me.next=de,de=de.next):(me.next=bn,bn=bn.next),me=me.next;return de!==null?me.next=de:bn!==null&&(me.next=bn),zt.next}function ve(Qt,ct,bt,zt,me){if(!(bt>=zt)){for(var de=Qt[bt+zt>>1],bn=bt-1,qn=zt+1;;){do bn++;while(me(Qt[bn],de)<0);do qn--;while(me(Qt[qn],de)>0);if(bn>=qn)break;var Sr=Qt[bn];Qt[bn]=Qt[qn],Qt[qn]=Sr,Sr=ct[bn],ct[bn]=ct[qn],ct[qn]=Sr}ve(Qt,ct,bt,qn,me),ve(Qt,ct,qn+1,zt,me)}}const Ze=(Qt,ct)=>Qt.ll.x<=ct.x&&ct.x<=Qt.ur.x&&Qt.ll.y<=ct.y&&ct.y<=Qt.ur.y,Un=(Qt,ct)=>{if(ct.ur.x<Qt.ll.x||Qt.ur.x<ct.ll.x||ct.ur.y<Qt.ll.y||Qt.ur.y<ct.ll.y)return null;const bt=Qt.ll.x<ct.ll.x?ct.ll.x:Qt.ll.x,zt=Qt.ur.x<ct.ur.x?Qt.ur.x:ct.ur.x,me=Qt.ll.y<ct.ll.y?ct.ll.y:Qt.ll.y,de=Qt.ur.y<ct.ur.y?Qt.ur.y:ct.ur.y;return{ll:{x:bt,y:me},ur:{x:zt,y:de}}};let En=Number.EPSILON;En===void 0&&(En=Math.pow(2,-52));const Vn=En*En,mr=(Qt,ct)=>{if(-En<Qt&&Qt<En&&-En<ct&&ct<En)return 0;const bt=Qt-ct;return bt*bt<Vn*Qt*ct?0:Qt<ct?-1:1};class or{constructor(){this.reset()}reset(){this.xRounder=new He,this.yRounder=new He}round(ct,bt){return{x:this.xRounder.round(ct),y:this.yRounder.round(bt)}}}class He{constructor(){this.tree=new fn,this.round(0)}round(ct){const bt=this.tree.add(ct),zt=this.tree.prev(bt);if(zt!==null&&mr(bt.key,zt.key)===0)return this.tree.remove(ct),zt.key;const me=this.tree.next(bt);return me!==null&&mr(bt.key,me.key)===0?(this.tree.remove(ct),me.key):ct}}const $t=new or,nn=11102230246251565e-32,ke=134217729,Je=(3+8*nn)*nn;function er(Qt,ct,bt,zt,me){let de,bn,qn,Sr,Gn=ct[0],ht=zt[0],ut=0,wt=0;ht>Gn==ht>-Gn?(de=Gn,Gn=ct[++ut]):(de=ht,ht=zt[++wt]);let Gt=0;if(ut<Qt&&wt<bt)for(ht>Gn==ht>-Gn?(bn=Gn+de,qn=de-(bn-Gn),Gn=ct[++ut]):(bn=ht+de,qn=de-(bn-ht),ht=zt[++wt]),de=bn,qn!==0&&(me[Gt++]=qn);ut<Qt&&wt<bt;)ht>Gn==ht>-Gn?(bn=de+Gn,Sr=bn-de,qn=de-(bn-Sr)+(Gn-Sr),Gn=ct[++ut]):(bn=de+ht,Sr=bn-de,qn=de-(bn-Sr)+(ht-Sr),ht=zt[++wt]),de=bn,qn!==0&&(me[Gt++]=qn);for(;ut<Qt;)bn=de+Gn,Sr=bn-de,qn=de-(bn-Sr)+(Gn-Sr),Gn=ct[++ut],de=bn,qn!==0&&(me[Gt++]=qn);for(;wt<bt;)bn=de+ht,Sr=bn-de,qn=de-(bn-Sr)+(ht-Sr),ht=zt[++wt],de=bn,qn!==0&&(me[Gt++]=qn);return(de!==0||Gt===0)&&(me[Gt++]=de),Gt}function kt(Qt,ct){let bt=ct[0];for(let zt=1;zt<Qt;zt++)bt+=ct[zt];return bt}function Te(Qt){return new Float64Array(Qt)}const gt=(3+16*nn)*nn,te=(2+12*nn)*nn,Zt=(9+64*nn)*nn*nn,Ut=Te(4),we=Te(8),ie=Te(12),_t=Te(16),Ne=Te(4);function un(Qt,ct,bt,zt,me,de,bn){let qn,Sr,Gn,ht,ut,wt,Gt,ue,Ge,ln,ee,Fe,Hn,Tr,Zr,vr,Ur,jr;const ni=Qt-me,Ar=bt-me,pi=ct-de,mi=zt-de;Tr=ni*mi,wt=ke*ni,Gt=wt-(wt-ni),ue=ni-Gt,wt=ke*mi,Ge=wt-(wt-mi),ln=mi-Ge,Zr=ue*ln-(Tr-Gt*Ge-ue*Ge-Gt*ln),vr=pi*Ar,wt=ke*pi,Gt=wt-(wt-pi),ue=pi-Gt,wt=ke*Ar,Ge=wt-(wt-Ar),ln=Ar-Ge,Ur=ue*ln-(vr-Gt*Ge-ue*Ge-Gt*ln),ee=Zr-Ur,ut=Zr-ee,Ut[0]=Zr-(ee+ut)+(ut-Ur),Fe=Tr+ee,ut=Fe-Tr,Hn=Tr-(Fe-ut)+(ee-ut),ee=Hn-vr,ut=Hn-ee,Ut[1]=Hn-(ee+ut)+(ut-vr),jr=Fe+ee,ut=jr-Fe,Ut[2]=Fe-(jr-ut)+(ee-ut),Ut[3]=jr;let xi=kt(4,Ut),wo=te*bn;if(xi>=wo||-xi>=wo||(ut=Qt-ni,qn=Qt-(ni+ut)+(ut-me),ut=bt-Ar,Gn=bt-(Ar+ut)+(ut-me),ut=ct-pi,Sr=ct-(pi+ut)+(ut-de),ut=zt-mi,ht=zt-(mi+ut)+(ut-de),qn===0&&Sr===0&&Gn===0&&ht===0)||(wo=Zt*bn+Je*Math.abs(xi),xi+=ni*ht+mi*qn-(pi*Gn+Ar*Sr),xi>=wo||-xi>=wo))return xi;Tr=qn*mi,wt=ke*qn,Gt=wt-(wt-qn),ue=qn-Gt,wt=ke*mi,Ge=wt-(wt-mi),ln=mi-Ge,Zr=ue*ln-(Tr-Gt*Ge-ue*Ge-Gt*ln),vr=Sr*Ar,wt=ke*Sr,Gt=wt-(wt-Sr),ue=Sr-Gt,wt=ke*Ar,Ge=wt-(wt-Ar),ln=Ar-Ge,Ur=ue*ln-(vr-Gt*Ge-ue*Ge-Gt*ln),ee=Zr-Ur,ut=Zr-ee,Ne[0]=Zr-(ee+ut)+(ut-Ur),Fe=Tr+ee,ut=Fe-Tr,Hn=Tr-(Fe-ut)+(ee-ut),ee=Hn-vr,ut=Hn-ee,Ne[1]=Hn-(ee+ut)+(ut-vr),jr=Fe+ee,ut=jr-Fe,Ne[2]=Fe-(jr-ut)+(ee-ut),Ne[3]=jr;const Li=er(4,Ut,4,Ne,we);Tr=ni*ht,wt=ke*ni,Gt=wt-(wt-ni),ue=ni-Gt,wt=ke*ht,Ge=wt-(wt-ht),ln=ht-Ge,Zr=ue*ln-(Tr-Gt*Ge-ue*Ge-Gt*ln),vr=pi*Gn,wt=ke*pi,Gt=wt-(wt-pi),ue=pi-Gt,wt=ke*Gn,Ge=wt-(wt-Gn),ln=Gn-Ge,Ur=ue*ln-(vr-Gt*Ge-ue*Ge-Gt*ln),ee=Zr-Ur,ut=Zr-ee,Ne[0]=Zr-(ee+ut)+(ut-Ur),Fe=Tr+ee,ut=Fe-Tr,Hn=Tr-(Fe-ut)+(ee-ut),ee=Hn-vr,ut=Hn-ee,Ne[1]=Hn-(ee+ut)+(ut-vr),jr=Fe+ee,ut=jr-Fe,Ne[2]=Fe-(jr-ut)+(ee-ut),Ne[3]=jr;const aa=er(Li,we,4,Ne,ie);Tr=qn*ht,wt=ke*qn,Gt=wt-(wt-qn),ue=qn-Gt,wt=ke*ht,Ge=wt-(wt-ht),ln=ht-Ge,Zr=ue*ln-(Tr-Gt*Ge-ue*Ge-Gt*ln),vr=Sr*Gn,wt=ke*Sr,Gt=wt-(wt-Sr),ue=Sr-Gt,wt=ke*Gn,Ge=wt-(wt-Gn),ln=Gn-Ge,Ur=ue*ln-(vr-Gt*Ge-ue*Ge-Gt*ln),ee=Zr-Ur,ut=Zr-ee,Ne[0]=Zr-(ee+ut)+(ut-Ur),Fe=Tr+ee,ut=Fe-Tr,Hn=Tr-(Fe-ut)+(ee-ut),ee=Hn-vr,ut=Hn-ee,Ne[1]=Hn-(ee+ut)+(ut-vr),jr=Fe+ee,ut=jr-Fe,Ne[2]=Fe-(jr-ut)+(ee-ut),Ne[3]=jr;const Pa=er(aa,ie,4,Ne,_t);return _t[Pa-1]}function Qn(Qt,ct,bt,zt,me,de){const bn=(ct-de)*(bt-me),qn=(Qt-me)*(zt-de),Sr=bn-qn,Gn=Math.abs(bn+qn);return Math.abs(Sr)>=gt*Gn?Sr:-un(Qt,ct,bt,zt,me,de,Gn)}const hr=(Qt,ct)=>Qt.x*ct.y-Qt.y*ct.x,Er=(Qt,ct)=>Qt.x*ct.x+Qt.y*ct.y,Ue=(Qt,ct,bt)=>{const zt=Qn(Qt.x,Qt.y,ct.x,ct.y,bt.x,bt.y);return zt>0?-1:zt<0?1:0},cn=Qt=>Math.sqrt(Er(Qt,Qt)),wn=(Qt,ct,bt)=>{const zt={x:ct.x-Qt.x,y:ct.y-Qt.y},me={x:bt.x-Qt.x,y:bt.y-Qt.y};return hr(me,zt)/cn(me)/cn(zt)},ir=(Qt,ct,bt)=>{const zt={x:ct.x-Qt.x,y:ct.y-Qt.y},me={x:bt.x-Qt.x,y:bt.y-Qt.y};return Er(me,zt)/cn(me)/cn(zt)},rn=(Qt,ct,bt)=>ct.y===0?null:{x:Qt.x+ct.x/ct.y*(bt-Qt.y),y:bt},De=(Qt,ct,bt)=>ct.x===0?null:{x:bt,y:Qt.y+ct.y/ct.x*(bt-Qt.x)},Be=(Qt,ct,bt,zt)=>{if(ct.x===0)return De(bt,zt,Qt.x);if(zt.x===0)return De(Qt,ct,bt.x);if(ct.y===0)return rn(bt,zt,Qt.y);if(zt.y===0)return rn(Qt,ct,bt.y);const me=hr(ct,zt);if(me==0)return null;const de={x:bt.x-Qt.x,y:bt.y-Qt.y},bn=hr(de,ct)/me,qn=hr(de,zt)/me,Sr=Qt.x+qn*ct.x,Gn=bt.x+bn*zt.x,ht=Qt.y+qn*ct.y,ut=bt.y+bn*zt.y,wt=(Sr+Gn)/2,Gt=(ht+ut)/2;return{x:wt,y:Gt}};class At{static compare(ct,bt){const zt=At.comparePoints(ct.point,bt.point);return zt!==0?zt:(ct.point!==bt.point&&ct.link(bt),ct.isLeft!==bt.isLeft?ct.isLeft?1:-1:Ae.compare(ct.segment,bt.segment))}static comparePoints(ct,bt){return ct.x<bt.x?-1:ct.x>bt.x?1:ct.y<bt.y?-1:ct.y>bt.y?1:0}constructor(ct,bt){ct.events===void 0?ct.events=[this]:ct.events.push(this),this.point=ct,this.isLeft=bt}link(ct){if(ct.point===this.point)throw new Error("Tried to link already linked events");const bt=ct.point.events;for(let zt=0,me=bt.length;zt<me;zt++){const de=bt[zt];this.point.events.push(de),de.point=this.point}this.checkForConsuming()}checkForConsuming(){const ct=this.point.events.length;for(let bt=0;bt<ct;bt++){const zt=this.point.events[bt];if(zt.segment.consumedBy===void 0)for(let me=bt+1;me<ct;me++){const de=this.point.events[me];de.consumedBy===void 0&&zt.otherSE.point.events===de.otherSE.point.events&&zt.segment.consume(de.segment)}}}getAvailableLinkedEvents(){const ct=[];for(let bt=0,zt=this.point.events.length;bt<zt;bt++){const me=this.point.events[bt];me!==this&&!me.segment.ringOut&&me.segment.isInResult()&&ct.push(me)}return ct}getLeftmostComparator(ct){const bt=new Map,zt=me=>{const de=me.otherSE;bt.set(me,{sine:wn(this.point,ct.point,de.point),cosine:ir(this.point,ct.point,de.point)})};return(me,de)=>{bt.has(me)||zt(me),bt.has(de)||zt(de);const{sine:bn,cosine:qn}=bt.get(me),{sine:Sr,cosine:Gn}=bt.get(de);return bn>=0&&Sr>=0?qn<Gn?1:qn>Gn?-1:0:bn<0&&Sr<0?qn<Gn?-1:qn>Gn?1:0:Sr<bn?-1:Sr>bn?1:0}}}let Bt=0;class Ae{static compare(ct,bt){const zt=ct.leftSE.point.x,me=bt.leftSE.point.x,de=ct.rightSE.point.x,bn=bt.rightSE.point.x;if(bn<zt)return 1;if(de<me)return-1;const qn=ct.leftSE.point.y,Sr=bt.leftSE.point.y,Gn=ct.rightSE.point.y,ht=bt.rightSE.point.y;if(zt<me){if(Sr<qn&&Sr<Gn)return 1;if(Sr>qn&&Sr>Gn)return-1;const ut=ct.comparePoint(bt.leftSE.point);if(ut<0)return 1;if(ut>0)return-1;const wt=bt.comparePoint(ct.rightSE.point);return wt!==0?wt:-1}if(zt>me){if(qn<Sr&&qn<ht)return-1;if(qn>Sr&&qn>ht)return 1;const ut=bt.comparePoint(ct.leftSE.point);if(ut!==0)return ut;const wt=ct.comparePoint(bt.rightSE.point);return wt<0?1:wt>0?-1:1}if(qn<Sr)return-1;if(qn>Sr)return 1;if(de<bn){const ut=bt.comparePoint(ct.rightSE.point);if(ut!==0)return ut}if(de>bn){const ut=ct.comparePoint(bt.rightSE.point);if(ut<0)return 1;if(ut>0)return-1}if(de!==bn){const ut=Gn-qn,wt=de-zt,Gt=ht-Sr,ue=bn-me;if(ut>wt&&Gt<ue)return 1;if(ut<wt&&Gt>ue)return-1}return de>bn?1:de<bn||Gn<ht?-1:Gn>ht?1:ct.id<bt.id?-1:ct.id>bt.id?1:0}constructor(ct,bt,zt,me){this.id=++Bt,this.leftSE=ct,ct.segment=this,ct.otherSE=bt,this.rightSE=bt,bt.segment=this,bt.otherSE=ct,this.rings=zt,this.windings=me}static fromRing(ct,bt,zt){let me,de,bn;const qn=At.comparePoints(ct,bt);if(qn<0)me=ct,de=bt,bn=1;else if(qn>0)me=bt,de=ct,bn=-1;else throw new Error(`Tried to create degenerate segment at [${ct.x}, ${ct.y}]`);const Sr=new At(me,!0),Gn=new At(de,!1);return new Ae(Sr,Gn,[zt],[bn])}replaceRightSE(ct){this.rightSE=ct,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const ct=this.leftSE.point.y,bt=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:ct<bt?ct:bt},ur:{x:this.rightSE.point.x,y:ct>bt?ct:bt}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(ct){return ct.x===this.leftSE.point.x&&ct.y===this.leftSE.point.y||ct.x===this.rightSE.point.x&&ct.y===this.rightSE.point.y}comparePoint(ct){if(this.isAnEndpoint(ct))return 0;const bt=this.leftSE.point,zt=this.rightSE.point,me=this.vector();if(bt.x===zt.x)return ct.x===bt.x?0:ct.x<bt.x?1:-1;const de=(ct.y-bt.y)/me.y,bn=bt.x+de*me.x;if(ct.x===bn)return 0;const qn=(ct.x-bt.x)/me.x,Sr=bt.y+qn*me.y;return ct.y===Sr?0:ct.y<Sr?-1:1}getIntersection(ct){const bt=this.bbox(),zt=ct.bbox(),me=Un(bt,zt);if(me===null)return null;const de=this.leftSE.point,bn=this.rightSE.point,qn=ct.leftSE.point,Sr=ct.rightSE.point,Gn=Ze(bt,qn)&&this.comparePoint(qn)===0,ht=Ze(zt,de)&&ct.comparePoint(de)===0,ut=Ze(bt,Sr)&&this.comparePoint(Sr)===0,wt=Ze(zt,bn)&&ct.comparePoint(bn)===0;if(ht&&Gn)return wt&&!ut?bn:!wt&&ut?Sr:null;if(ht)return ut&&de.x===Sr.x&&de.y===Sr.y?null:de;if(Gn)return wt&&bn.x===qn.x&&bn.y===qn.y?null:qn;if(wt&&ut)return null;if(wt)return bn;if(ut)return Sr;const Gt=Be(de,this.vector(),qn,ct.vector());return Gt===null||!Ze(me,Gt)?null:$t.round(Gt.x,Gt.y)}split(ct){const bt=[],zt=ct.events!==void 0,me=new At(ct,!0),de=new At(ct,!1),bn=this.rightSE;this.replaceRightSE(de),bt.push(de),bt.push(me);const qn=new Ae(me,bn,this.rings.slice(),this.windings.slice());return At.comparePoints(qn.leftSE.point,qn.rightSE.point)>0&&qn.swapEvents(),At.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),zt&&(me.checkForConsuming(),de.checkForConsuming()),bt}swapEvents(){const ct=this.rightSE;this.rightSE=this.leftSE,this.leftSE=ct,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let bt=0,zt=this.windings.length;bt<zt;bt++)this.windings[bt]*=-1}consume(ct){let bt=this,zt=ct;for(;bt.consumedBy;)bt=bt.consumedBy;for(;zt.consumedBy;)zt=zt.consumedBy;const me=Ae.compare(bt,zt);if(me!==0){if(me>0){const de=bt;bt=zt,zt=de}if(bt.prev===zt){const de=bt;bt=zt,zt=de}for(let de=0,bn=zt.rings.length;de<bn;de++){const qn=zt.rings[de],Sr=zt.windings[de],Gn=bt.rings.indexOf(qn);Gn===-1?(bt.rings.push(qn),bt.windings.push(Sr)):bt.windings[Gn]+=Sr}zt.rings=null,zt.windings=null,zt.consumedBy=bt,zt.leftSE.consumedBy=bt.leftSE,zt.rightSE.consumedBy=bt.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const ct=this.prev.consumedBy||this.prev;this._beforeState=ct.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const ct=this.beforeState();this._afterState={rings:ct.rings.slice(0),windings:ct.windings.slice(0),multiPolys:[]};const bt=this._afterState.rings,zt=this._afterState.windings,me=this._afterState.multiPolys;for(let qn=0,Sr=this.rings.length;qn<Sr;qn++){const Gn=this.rings[qn],ht=this.windings[qn],ut=bt.indexOf(Gn);ut===-1?(bt.push(Gn),zt.push(ht)):zt[ut]+=ht}const de=[],bn=[];for(let qn=0,Sr=bt.length;qn<Sr;qn++){if(zt[qn]===0)continue;const Gn=bt[qn],ht=Gn.poly;if(bn.indexOf(ht)===-1)if(Gn.isExterior)de.push(ht);else{bn.indexOf(ht)===-1&&bn.push(ht);const ut=de.indexOf(Gn.poly);ut!==-1&&de.splice(ut,1)}}for(let qn=0,Sr=de.length;qn<Sr;qn++){const Gn=de[qn].multiPoly;me.indexOf(Gn)===-1&&me.push(Gn)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const ct=this.beforeState().multiPolys,bt=this.afterState().multiPolys;switch(sn.type){case"union":{const zt=ct.length===0,me=bt.length===0;this._isInResult=zt!==me;break}case"intersection":{let zt,me;ct.length<bt.length?(zt=ct.length,me=bt.length):(zt=bt.length,me=ct.length),this._isInResult=me===sn.numMultiPolys&&zt<me;break}case"xor":{const zt=Math.abs(ct.length-bt.length);this._isInResult=zt%2===1;break}case"difference":{const zt=me=>me.length===1&&me[0].isSubject;this._isInResult=zt(ct)!==zt(bt);break}default:throw new Error(`Unrecognized operation type found ${sn.type}`)}return this._isInResult}}class z{constructor(ct,bt,zt){if(!Array.isArray(ct)||ct.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=bt,this.isExterior=zt,this.segments=[],typeof ct[0][0]!="number"||typeof ct[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const me=$t.round(ct[0][0],ct[0][1]);this.bbox={ll:{x:me.x,y:me.y},ur:{x:me.x,y:me.y}};let de=me;for(let bn=1,qn=ct.length;bn<qn;bn++){if(typeof ct[bn][0]!="number"||typeof ct[bn][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let Sr=$t.round(ct[bn][0],ct[bn][1]);Sr.x===de.x&&Sr.y===de.y||(this.segments.push(Ae.fromRing(de,Sr,this)),Sr.x<this.bbox.ll.x&&(this.bbox.ll.x=Sr.x),Sr.y<this.bbox.ll.y&&(this.bbox.ll.y=Sr.y),Sr.x>this.bbox.ur.x&&(this.bbox.ur.x=Sr.x),Sr.y>this.bbox.ur.y&&(this.bbox.ur.y=Sr.y),de=Sr)}(me.x!==de.x||me.y!==de.y)&&this.segments.push(Ae.fromRing(de,me,this))}getSweepEvents(){const ct=[];for(let bt=0,zt=this.segments.length;bt<zt;bt++){const me=this.segments[bt];ct.push(me.leftSE),ct.push(me.rightSE)}return ct}}class rt{constructor(ct,bt){if(!Array.isArray(ct))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new z(ct[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let zt=1,me=ct.length;zt<me;zt++){const de=new z(ct[zt],this,!1);de.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=de.bbox.ll.x),de.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=de.bbox.ll.y),de.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=de.bbox.ur.x),de.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=de.bbox.ur.y),this.interiorRings.push(de)}this.multiPoly=bt}getSweepEvents(){const ct=this.exteriorRing.getSweepEvents();for(let bt=0,zt=this.interiorRings.length;bt<zt;bt++){const me=this.interiorRings[bt].getSweepEvents();for(let de=0,bn=me.length;de<bn;de++)ct.push(me[de])}return ct}}class F{constructor(ct,bt){if(!Array.isArray(ct))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof ct[0][0][0]=="number"&&(ct=[ct])}catch(zt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let zt=0,me=ct.length;zt<me;zt++){const de=new rt(ct[zt],this);de.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=de.bbox.ll.x),de.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=de.bbox.ll.y),de.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=de.bbox.ur.x),de.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=de.bbox.ur.y),this.polys.push(de)}this.isSubject=bt}getSweepEvents(){const ct=[];for(let bt=0,zt=this.polys.length;bt<zt;bt++){const me=this.polys[bt].getSweepEvents();for(let de=0,bn=me.length;de<bn;de++)ct.push(me[de])}return ct}}class ot{static factory(ct){const bt=[];for(let zt=0,me=ct.length;zt<me;zt++){const de=ct[zt];if(!de.isInResult()||de.ringOut)continue;let bn=null,qn=de.leftSE,Sr=de.rightSE;const Gn=[qn],ht=qn.point,ut=[];for(;bn=qn,qn=Sr,Gn.push(qn),qn.point!==ht;)for(;;){const wt=qn.getAvailableLinkedEvents();if(wt.length===0){const Ge=Gn[0].point,ln=Gn[Gn.length-1].point;throw new Error(`Unable to complete output ring starting at [${Ge.x}, ${Ge.y}]. Last matching segment found ends at [${ln.x}, ${ln.y}].`)}if(wt.length===1){Sr=wt[0].otherSE;break}let Gt=null;for(let Ge=0,ln=ut.length;Ge<ln;Ge++)if(ut[Ge].point===qn.point){Gt=Ge;break}if(Gt!==null){const Ge=ut.splice(Gt)[0],ln=Gn.splice(Ge.index);ln.unshift(ln[0].otherSE),bt.push(new ot(ln.reverse()));continue}ut.push({index:Gn.length,point:qn.point});const ue=qn.getLeftmostComparator(bn);Sr=wt.sort(ue)[0].otherSE;break}bt.push(new ot(Gn))}return bt}constructor(ct){this.events=ct;for(let bt=0,zt=ct.length;bt<zt;bt++)ct[bt].segment.ringOut=this;this.poly=null}getGeom(){let ct=this.events[0].point;const bt=[ct];for(let Gn=1,ht=this.events.length-1;Gn<ht;Gn++){const ut=this.events[Gn].point,wt=this.events[Gn+1].point;Ue(ut,ct,wt)!==0&&(bt.push(ut),ct=ut)}if(bt.length===1)return null;const zt=bt[0],me=bt[1];Ue(zt,ct,me)===0&&bt.shift(),bt.push(bt[0]);const de=this.isExteriorRing()?1:-1,bn=this.isExteriorRing()?0:bt.length-1,qn=this.isExteriorRing()?bt.length:-1,Sr=[];for(let Gn=bn;Gn!=qn;Gn+=de)Sr.push([bt[Gn].x,bt[Gn].y]);return Sr}isExteriorRing(){if(this._isExteriorRing===void 0){const ct=this.enclosingRing();this._isExteriorRing=ct?!ct.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let ct=this.events[0];for(let me=1,de=this.events.length;me<de;me++){const bn=this.events[me];At.compare(ct,bn)>0&&(ct=bn)}let bt=ct.segment.prevInResult(),zt=bt?bt.prevInResult():null;for(;;){if(!bt)return null;if(!zt)return bt.ringOut;if(zt.ringOut!==bt.ringOut)return zt.ringOut.enclosingRing()!==bt.ringOut?bt.ringOut:bt.ringOut.enclosingRing();bt=zt.prevInResult(),zt=bt?bt.prevInResult():null}}}class ze{constructor(ct){this.exteriorRing=ct,ct.poly=this,this.interiorRings=[]}addInterior(ct){this.interiorRings.push(ct),ct.poly=this}getGeom(){const ct=[this.exteriorRing.getGeom()];if(ct[0]===null)return null;for(let bt=0,zt=this.interiorRings.length;bt<zt;bt++){const me=this.interiorRings[bt].getGeom();me!==null&&ct.push(me)}return ct}}class Vt{constructor(ct){this.rings=ct,this.polys=this._composePolys(ct)}getGeom(){const ct=[];for(let bt=0,zt=this.polys.length;bt<zt;bt++){const me=this.polys[bt].getGeom();me!==null&&ct.push(me)}return ct}_composePolys(ct){const bt=[];for(let zt=0,me=ct.length;zt<me;zt++){const de=ct[zt];if(!de.poly)if(de.isExteriorRing())bt.push(new ze(de));else{const bn=de.enclosingRing();bn.poly||bt.push(new ze(bn)),bn.poly.addInterior(de)}}return bt}}class ae{constructor(ct){let bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae.compare;this.queue=ct,this.tree=new fn(bt),this.segments=[]}process(ct){const bt=ct.segment,zt=[];if(ct.consumedBy)return ct.isLeft?this.queue.remove(ct.otherSE):this.tree.remove(bt),zt;const me=ct.isLeft?this.tree.add(bt):this.tree.find(bt);if(!me)throw new Error(`Unable to find segment #${bt.id} [${bt.leftSE.point.x}, ${bt.leftSE.point.y}] -> [${bt.rightSE.point.x}, ${bt.rightSE.point.y}] in SweepLine tree.`);let de=me,bn=me,qn,Sr;for(;qn===void 0;)de=this.tree.prev(de),de===null?qn=null:de.key.consumedBy===void 0&&(qn=de.key);for(;Sr===void 0;)bn=this.tree.next(bn),bn===null?Sr=null:bn.key.consumedBy===void 0&&(Sr=bn.key);if(ct.isLeft){let Gn=null;if(qn){const ut=qn.getIntersection(bt);if(ut!==null&&(bt.isAnEndpoint(ut)||(Gn=ut),!qn.isAnEndpoint(ut))){const wt=this._splitSafely(qn,ut);for(let Gt=0,ue=wt.length;Gt<ue;Gt++)zt.push(wt[Gt])}}let ht=null;if(Sr){const ut=Sr.getIntersection(bt);if(ut!==null&&(bt.isAnEndpoint(ut)||(ht=ut),!Sr.isAnEndpoint(ut))){const wt=this._splitSafely(Sr,ut);for(let Gt=0,ue=wt.length;Gt<ue;Gt++)zt.push(wt[Gt])}}if(Gn!==null||ht!==null){let ut=null;Gn===null?ut=ht:ht===null?ut=Gn:ut=At.comparePoints(Gn,ht)<=0?Gn:ht,this.queue.remove(bt.rightSE),zt.push(bt.rightSE);const wt=bt.split(ut);for(let Gt=0,ue=wt.length;Gt<ue;Gt++)zt.push(wt[Gt])}zt.length>0?(this.tree.remove(bt),zt.push(ct)):(this.segments.push(bt),bt.prev=qn)}else{if(qn&&Sr){const Gn=qn.getIntersection(Sr);if(Gn!==null){if(!qn.isAnEndpoint(Gn)){const ht=this._splitSafely(qn,Gn);for(let ut=0,wt=ht.length;ut<wt;ut++)zt.push(ht[ut])}if(!Sr.isAnEndpoint(Gn)){const ht=this._splitSafely(Sr,Gn);for(let ut=0,wt=ht.length;ut<wt;ut++)zt.push(ht[ut])}}}this.tree.remove(bt)}return zt}_splitSafely(ct,bt){this.tree.remove(ct);const zt=ct.rightSE;this.queue.remove(zt);const me=ct.split(bt);return me.push(zt),ct.consumedBy===void 0&&this.tree.add(ct),me}}const Mn=typeof ne!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,zn=typeof ne!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Wn{run(ct,bt,zt){sn.type=ct,$t.reset();const me=[new F(bt,!0)];for(let ut=0,wt=zt.length;ut<wt;ut++)me.push(new F(zt[ut],!1));if(sn.numMultiPolys=me.length,sn.type==="difference"){const ut=me[0];let wt=1;for(;wt<me.length;)Un(me[wt].bbox,ut.bbox)!==null?wt++:me.splice(wt,1)}if(sn.type==="intersection")for(let ut=0,wt=me.length;ut<wt;ut++){const Gt=me[ut];for(let ue=ut+1,Ge=me.length;ue<Ge;ue++)if(Un(Gt.bbox,me[ue].bbox)===null)return[]}const de=new fn(At.compare);for(let ut=0,wt=me.length;ut<wt;ut++){const Gt=me[ut].getSweepEvents();for(let ue=0,Ge=Gt.length;ue<Ge;ue++)if(de.insert(Gt[ue]),de.size>Mn)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const bn=new ae(de);let qn=de.size,Sr=de.pop();for(;Sr;){const ut=Sr.key;if(de.size===qn){const Gt=ut.segment;throw new Error(`Unable to pop() ${ut.isLeft?"left":"right"} SweepEvent [${ut.point.x}, ${ut.point.y}] from segment #${Gt.id} [${Gt.leftSE.point.x}, ${Gt.leftSE.point.y}] -> [${Gt.rightSE.point.x}, ${Gt.rightSE.point.y}] from queue.`)}if(de.size>Mn)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(bn.segments.length>zn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const wt=bn.process(ut);for(let Gt=0,ue=wt.length;Gt<ue;Gt++){const Ge=wt[Gt];Ge.consumedBy===void 0&&de.insert(Ge)}qn=de.size,Sr=de.pop()}$t.reset();const Gn=ot.factory(bn.segments);return new Vt(Gn).getGeom()}}const sn=new Wn;var Zn={union:function(Qt){for(var ct=arguments.length,bt=new Array(ct>1?ct-1:0),zt=1;zt<ct;zt++)bt[zt-1]=arguments[zt];return sn.run("union",Qt,bt)},intersection:function(Qt){for(var ct=arguments.length,bt=new Array(ct>1?ct-1:0),zt=1;zt<ct;zt++)bt[zt-1]=arguments[zt];return sn.run("intersection",Qt,bt)},xor:function(Qt){for(var ct=arguments.length,bt=new Array(ct>1?ct-1:0),zt=1;zt<ct;zt++)bt[zt-1]=arguments[zt];return sn.run("xor",Qt,bt)},difference:function(Qt){for(var ct=arguments.length,bt=new Array(ct>1?ct-1:0),zt=1;zt<ct;zt++)bt[zt-1]=arguments[zt];return sn.run("difference",Qt,bt)}};return Zn})},81550:function(br){(function(rr,it){br.exports=it()})(this,function(){"use strict";var rr=function(xt){return xt instanceof Uint8Array||xt instanceof Uint16Array||xt instanceof Uint32Array||xt instanceof Int8Array||xt instanceof Int16Array||xt instanceof Int32Array||xt instanceof Float32Array||xt instanceof Float64Array||xt instanceof Uint8ClampedArray},it=function(xt,Pe){for(var gn=Object.keys(Pe),Cr=0;Cr<gn.length;++Cr)xt[gn[Cr]]=Pe[gn[Cr]];return xt},ne=`
`;function pt(xt){return typeof atob!="undefined"?atob(xt):"base64:"+xt}function R(xt){var Pe=new Error("(regl) "+xt);throw console.error(Pe),Pe}function $e(xt,Pe){xt||R(Pe)}function yt(xt){return xt?": "+xt:""}function xe(xt,Pe,gn){xt in Pe||R("unknown parameter ("+xt+")"+yt(gn)+". possible values: "+Object.keys(Pe).join())}function le(xt,Pe){rr(xt)||R("invalid parameter type"+yt(Pe)+". must be a typed array")}function Le(xt,Pe){switch(Pe){case"number":return typeof xt=="number";case"object":return typeof xt=="object";case"string":return typeof xt=="string";case"boolean":return typeof xt=="boolean";case"function":return typeof xt=="function";case"undefined":return typeof xt=="undefined";case"symbol":return typeof xt=="symbol"}}function Lt(xt,Pe,gn){Le(xt,Pe)||R("invalid parameter type"+yt(gn)+". expected "+Pe+", got "+typeof xt)}function fn(xt,Pe){xt>=0&&(xt|0)===xt||R("invalid parameter type, ("+xt+")"+yt(Pe)+". must be a nonnegative integer")}function Nt(xt,Pe,gn){Pe.indexOf(xt)<0&&R("invalid value"+yt(gn)+". must be one of: "+Pe)}var Jt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ie(xt){Object.keys(xt).forEach(function(Pe){Jt.indexOf(Pe)<0&&R('invalid regl constructor argument "'+Pe+'". must be one of '+Jt)})}function fe(xt,Pe){for(xt=xt+"";xt.length<Pe;)xt=" "+xt;return xt}function ce(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ve(xt,Pe){this.number=xt,this.line=Pe,this.errors=[]}function Ze(xt,Pe,gn){this.file=xt,this.line=Pe,this.message=gn}function Un(){var xt=new Error,Pe=(xt.stack||xt).toString(),gn=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Pe);if(gn)return gn[1];var Cr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Pe);return Cr?Cr[1]:"unknown"}function En(){var xt=new Error,Pe=(xt.stack||xt).toString(),gn=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Pe);if(gn)return gn[1];var Cr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Pe);return Cr?Cr[1]:"unknown"}function Vn(xt,Pe){var gn=xt.split(`
`),Cr=1,Hr=0,Rr={unknown:new ce,0:new ce};Rr.unknown.name=Rr[0].name=Pe||Un(),Rr.unknown.lines.push(new ve(0,""));for(var gr=0;gr<gn.length;++gr){var bi=gn[gr],li=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(bi);if(li)switch(li[1]){case"line":var Di=/(\d+)(\s+\d+)?/.exec(li[2]);Di&&(Cr=Di[1]|0,Di[2]&&(Hr=Di[2]|0,Hr in Rr||(Rr[Hr]=new ce)));break;case"define":var Oi=/SHADER_NAME(_B64)?\s+(.*)$/.exec(li[2]);Oi&&(Rr[Hr].name=Oi[1]?pt(Oi[2]):Oi[2]);break}Rr[Hr].lines.push(new ve(Cr++,bi))}return Object.keys(Rr).forEach(function(Mi){var Gi=Rr[Mi];Gi.lines.forEach(function(hi){Gi.index[hi.number]=hi})}),Rr}function mr(xt){var Pe=[];return xt.split(`
`).forEach(function(gn){if(!(gn.length<5)){var Cr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(gn);Cr?Pe.push(new Ze(Cr[1]|0,Cr[2]|0,Cr[3].trim())):gn.length>0&&Pe.push(new Ze("unknown",0,gn))}}),Pe}function or(xt,Pe){Pe.forEach(function(gn){var Cr=xt[gn.file];if(Cr){var Hr=Cr.index[gn.line];if(Hr){Hr.errors.push(gn),Cr.hasErrors=!0;return}}xt.unknown.hasErrors=!0,xt.unknown.lines[0].errors.push(gn)})}function He(xt,Pe,gn,Cr,Hr){if(!xt.getShaderParameter(Pe,xt.COMPILE_STATUS)){var Rr=xt.getShaderInfoLog(Pe),gr=Cr===xt.FRAGMENT_SHADER?"fragment":"vertex";Te(gn,"string",gr+" shader source must be a string",Hr);var bi=Vn(gn,Hr),li=mr(Rr);or(bi,li),Object.keys(bi).forEach(function(Di){var Oi=bi[Di];if(!Oi.hasErrors)return;var Mi=[""],Gi=[""];function hi(Pi,ur){Mi.push(Pi),Gi.push(ur||"")}hi("file number "+Di+": "+Oi.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Oi.lines.forEach(function(Pi){if(Pi.errors.length>0){hi(fe(Pi.number,4)+"|  ","background-color:yellow; font-weight:bold"),hi(Pi.line+ne,"color:red; background-color:yellow; font-weight:bold");var ur=0;Pi.errors.forEach(function(Lr){var gi=Lr.message,to=/^\s*'(.*)'\s*:\s*(.*)$/.exec(gi);if(to){var ri=to[1];switch(gi=to[2],ri){case"assign":ri="=";break}ur=Math.max(Pi.line.indexOf(ri,ur),0)}else ur=0;hi(fe("| ",6)),hi(fe("^^^",ur+3)+ne,"font-weight:bold"),hi(fe("| ",6)),hi(gi+ne,"font-weight:bold")}),hi(fe("| ",6)+ne)}else hi(fe(Pi.number,4)+"|  "),hi(Pi.line+ne,"color:red")}),typeof document!="undefined"&&!window.chrome?(Gi[0]=Mi.join("%c"),console.log.apply(console,Gi)):console.log(Mi.join(""))}),$e.raise("Error compiling "+gr+" shader, "+bi[0].name)}}function $t(xt,Pe,gn,Cr,Hr){if(!xt.getProgramParameter(Pe,xt.LINK_STATUS)){var Rr=xt.getProgramInfoLog(Pe),gr=Vn(gn,Hr),bi=Vn(Cr,Hr),li='Error linking program with vertex shader, "'+bi[0].name+'", and fragment shader "'+gr[0].name+'"';typeof document!="undefined"?console.log("%c"+li+ne+"%c"+Rr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(li+ne+Rr),$e.raise(li)}}function nn(xt){xt._commandRef=Un()}function ke(xt,Pe,gn,Cr){nn(xt);function Hr(li){return li?Cr.id(li):0}xt._fragId=Hr(xt.static.frag),xt._vertId=Hr(xt.static.vert);function Rr(li,Di){Object.keys(Di).forEach(function(Oi){li[Cr.id(Oi)]=!0})}var gr=xt._uniformSet={};Rr(gr,Pe.static),Rr(gr,Pe.dynamic);var bi=xt._attributeSet={};Rr(bi,gn.static),Rr(bi,gn.dynamic),xt._hasCount="count"in xt.static||"count"in xt.dynamic||"elements"in xt.static||"elements"in xt.dynamic}function Je(xt,Pe){var gn=En();R(xt+" in command "+(Pe||Un())+(gn==="unknown"?"":" called from "+gn))}function er(xt,Pe,gn){xt||Je(Pe,gn||Un())}function kt(xt,Pe,gn,Cr){xt in Pe||Je("unknown parameter ("+xt+")"+yt(gn)+". possible values: "+Object.keys(Pe).join(),Cr||Un())}function Te(xt,Pe,gn,Cr){Le(xt,Pe)||Je("invalid parameter type"+yt(gn)+". expected "+Pe+", got "+typeof xt,Cr||Un())}function gt(xt){xt()}function te(xt,Pe,gn){xt.texture?Nt(xt.texture._texture.internalformat,Pe,"unsupported texture format for attachment"):Nt(xt.renderbuffer._renderbuffer.format,gn,"unsupported renderbuffer format for attachment")}var Zt=33071,Ut=9728,we=9984,ie=9985,_t=9986,Ne=9987,un=5120,Qn=5121,hr=5122,Er=5123,Ue=5124,cn=5125,wn=5126,ir=32819,rn=32820,De=33635,Be=34042,At=36193,Bt={};Bt[un]=Bt[Qn]=1,Bt[hr]=Bt[Er]=Bt[At]=Bt[De]=Bt[ir]=Bt[rn]=2,Bt[Ue]=Bt[cn]=Bt[wn]=Bt[Be]=4;function Ae(xt,Pe){return xt===rn||xt===ir||xt===De?2:xt===Be?4:Bt[xt]*Pe}function z(xt){return!(xt&xt-1)&&!!xt}function rt(xt,Pe,gn){var Cr,Hr=Pe.width,Rr=Pe.height,gr=Pe.channels;$e(Hr>0&&Hr<=gn.maxTextureSize&&Rr>0&&Rr<=gn.maxTextureSize,"invalid texture shape"),(xt.wrapS!==Zt||xt.wrapT!==Zt)&&$e(z(Hr)&&z(Rr),"incompatible wrap mode for texture, both width and height must be power of 2"),Pe.mipmask===1?Hr!==1&&Rr!==1&&$e(xt.minFilter!==we&&xt.minFilter!==_t&&xt.minFilter!==ie&&xt.minFilter!==Ne,"min filter requires mipmap"):($e(z(Hr)&&z(Rr),"texture must be a square power of 2 to support mipmapping"),$e(Pe.mipmask===(Hr<<1)-1,"missing or incomplete mipmap data")),Pe.type===wn&&(gn.extensions.indexOf("oes_texture_float_linear")<0&&$e(xt.minFilter===Ut&&xt.magFilter===Ut,"filter not supported, must enable oes_texture_float_linear"),$e(!xt.genMipmaps,"mipmap generation not supported with float textures"));var bi=Pe.images;for(Cr=0;Cr<16;++Cr)if(bi[Cr]){var li=Hr>>Cr,Di=Rr>>Cr;$e(Pe.mipmask&1<<Cr,"missing mipmap data");var Oi=bi[Cr];if($e(Oi.width===li&&Oi.height===Di,"invalid shape for mip images"),$e(Oi.format===Pe.format&&Oi.internalformat===Pe.internalformat&&Oi.type===Pe.type,"incompatible type for mip image"),!Oi.compressed)if(Oi.data){var Mi=Math.ceil(Ae(Oi.type,gr)*li/Oi.unpackAlignment)*Oi.unpackAlignment;$e(Oi.data.byteLength===Mi*Di,"invalid data for image, buffer size is inconsistent with image format")}else Oi.element||Oi.copy}else xt.genMipmaps||$e((Pe.mipmask&1<<Cr)===0,"extra mipmap data");Pe.compressed&&$e(!xt.genMipmaps,"mipmap generation for compressed images not supported")}function F(xt,Pe,gn,Cr){var Hr=xt.width,Rr=xt.height,gr=xt.channels;$e(Hr>0&&Hr<=Cr.maxTextureSize&&Rr>0&&Rr<=Cr.maxTextureSize,"invalid texture shape"),$e(Hr===Rr,"cube map must be square"),$e(Pe.wrapS===Zt&&Pe.wrapT===Zt,"wrap mode not supported by cube map");for(var bi=0;bi<gn.length;++bi){var li=gn[bi];$e(li.width===Hr&&li.height===Rr,"inconsistent cube map face shape"),Pe.genMipmaps&&($e(!li.compressed,"can not generate mipmap for compressed textures"),$e(li.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Di=li.images,Oi=0;Oi<16;++Oi){var Mi=Di[Oi];if(Mi){var Gi=Hr>>Oi,hi=Rr>>Oi;$e(li.mipmask&1<<Oi,"missing mipmap data"),$e(Mi.width===Gi&&Mi.height===hi,"invalid shape for mip images"),$e(Mi.format===xt.format&&Mi.internalformat===xt.internalformat&&Mi.type===xt.type,"incompatible type for mip image"),Mi.compressed||(Mi.data?$e(Mi.data.byteLength===Gi*hi*Math.max(Ae(Mi.type,gr),Mi.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Mi.element||Mi.copy)}}}}var ot=it($e,{optional:gt,raise:R,commandRaise:Je,command:er,parameter:xe,commandParameter:kt,constructor:Ie,type:Lt,commandType:Te,isTypedArray:le,nni:fn,oneOf:Nt,shaderError:He,linkError:$t,callSite:En,saveCommandRef:nn,saveDrawInfo:ke,framebufferFormat:te,guessCommand:Un,texture2D:rt,textureCube:F}),ze=0,Vt=0;function ae(xt,Pe){this.id=ze++,this.type=xt,this.data=Pe}function Mn(xt){return xt.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function zn(xt){if(xt.length===0)return[];var Pe=xt.charAt(0),gn=xt.charAt(xt.length-1);if(xt.length>1&&Pe===gn&&(Pe==='"'||Pe==="'"))return['"'+Mn(xt.substr(1,xt.length-2))+'"'];var Cr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xt);if(Cr)return zn(xt.substr(0,Cr.index)).concat(zn(Cr[1])).concat(zn(xt.substr(Cr.index+Cr[0].length)));var Hr=xt.split(".");if(Hr.length===1)return['"'+Mn(xt)+'"'];for(var Rr=[],gr=0;gr<Hr.length;++gr)Rr=Rr.concat(zn(Hr[gr]));return Rr}function Wn(xt){return"["+zn(xt).join("][")+"]"}function sn(xt,Pe){return new ae(xt,Wn(Pe+""))}function Kt(xt){return typeof xt=="function"&&!xt._reglType||xt instanceof ae}function Ce(xt,Pe){return typeof xt=="function"?new ae(Vt,xt):xt}var xn={DynamicVariable:ae,define:sn,isDynamic:Kt,unbox:Ce,accessor:Wn},Cn={next:typeof requestAnimationFrame=="function"?function(xt){return requestAnimationFrame(xt)}:function(xt){return setTimeout(xt,16)},cancel:typeof cancelAnimationFrame=="function"?function(xt){return cancelAnimationFrame(xt)}:clearTimeout},Zn=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Qt(){var xt={"":0},Pe=[""];return{id:function(gn){var Cr=xt[gn];return Cr||(Cr=xt[gn]=Pe.length,Pe.push(gn),Cr)},str:function(gn){return Pe[gn]}}}function ct(xt,Pe,gn){var Cr=document.createElement("canvas");it(Cr.style,{border:0,margin:0,padding:0,top:0,left:0}),xt.appendChild(Cr),xt===document.body&&(Cr.style.position="absolute",it(xt.style,{margin:0,padding:0}));function Hr(){var bi=window.innerWidth,li=window.innerHeight;if(xt!==document.body){var Di=xt.getBoundingClientRect();bi=Di.right-Di.left,li=Di.bottom-Di.top}Cr.width=gn*bi,Cr.height=gn*li,it(Cr.style,{width:bi+"px",height:li+"px"})}var Rr;xt!==document.body&&typeof ResizeObserver=="function"?(Rr=new ResizeObserver(function(){setTimeout(Hr)}),Rr.observe(xt)):window.addEventListener("resize",Hr,!1);function gr(){Rr?Rr.disconnect():window.removeEventListener("resize",Hr),xt.removeChild(Cr)}return Hr(),{canvas:Cr,onDestroy:gr}}function bt(xt,Pe){function gn(Cr){try{return xt.getContext(Cr,Pe)}catch(Hr){return null}}return gn("webgl")||gn("experimental-webgl")||gn("webgl-experimental")}function zt(xt){return typeof xt.nodeName=="string"&&typeof xt.appendChild=="function"&&typeof xt.getBoundingClientRect=="function"}function me(xt){return typeof xt.drawArrays=="function"||typeof xt.drawElements=="function"}function de(xt){return typeof xt=="string"?xt.split():(ot(Array.isArray(xt),"invalid extension array"),xt)}function bn(xt){return typeof xt=="string"?(ot(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xt)):xt}function qn(xt){var Pe=xt||{},gn,Cr,Hr,Rr,gr={},bi=[],li=[],Di=typeof window=="undefined"?1:window.devicePixelRatio,Oi=!1,Mi=function(Pi){Pi&&ot.raise(Pi)},Gi=function(){};if(typeof Pe=="string"?(ot(typeof document!="undefined","selector queries only supported in DOM enviroments"),gn=document.querySelector(Pe),ot(gn,"invalid query string for element")):typeof Pe=="object"?zt(Pe)?gn=Pe:me(Pe)?(Rr=Pe,Hr=Rr.canvas):(ot.constructor(Pe),"gl"in Pe?Rr=Pe.gl:"canvas"in Pe?Hr=bn(Pe.canvas):"container"in Pe&&(Cr=bn(Pe.container)),"attributes"in Pe&&(gr=Pe.attributes,ot.type(gr,"object","invalid context attributes")),"extensions"in Pe&&(bi=de(Pe.extensions)),"optionalExtensions"in Pe&&(li=de(Pe.optionalExtensions)),"onDone"in Pe&&(ot.type(Pe.onDone,"function","invalid or missing onDone callback"),Mi=Pe.onDone),"profile"in Pe&&(Oi=!!Pe.profile),"pixelRatio"in Pe&&(Di=+Pe.pixelRatio,ot(Di>0,"invalid pixel ratio"))):ot.raise("invalid arguments to regl"),gn&&(gn.nodeName.toLowerCase()==="canvas"?Hr=gn:Cr=gn),!Rr){if(!Hr){ot(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var hi=ct(Cr||document.body,Mi,Di);if(!hi)return null;Hr=hi.canvas,Gi=hi.onDestroy}gr.premultipliedAlpha===void 0&&(gr.premultipliedAlpha=!0),Rr=bt(Hr,gr)}return Rr?{gl:Rr,canvas:Hr,container:Cr,extensions:bi,optionalExtensions:li,pixelRatio:Di,profile:Oi,onDone:Mi,onDestroy:Gi}:(Gi(),Mi("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Sr(xt,Pe){var gn={};function Cr(gr){ot.type(gr,"string","extension name must be string");var bi=gr.toLowerCase(),li;try{li=gn[bi]=xt.getExtension(bi)}catch(Di){}return!!li}for(var Hr=0;Hr<Pe.extensions.length;++Hr){var Rr=Pe.extensions[Hr];if(!Cr(Rr))return Pe.onDestroy(),Pe.onDone('"'+Rr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Pe.optionalExtensions.forEach(Cr),{extensions:gn,restore:function(){Object.keys(gn).forEach(function(gr){if(gn[gr]&&!Cr(gr))throw new Error("(regl): error restoring extension "+gr)})}}}function Gn(xt,Pe){for(var gn=Array(xt),Cr=0;Cr<xt;++Cr)gn[Cr]=Pe(Cr);return gn}var ht=5120,ut=5121,wt=5122,Gt=5123,ue=5124,Ge=5125,ln=5126;function ee(xt){for(var Pe=16;Pe<=1<<28;Pe*=16)if(xt<=Pe)return Pe;return 0}function Fe(xt){var Pe,gn;return Pe=(xt>65535)<<4,xt>>>=Pe,gn=(xt>255)<<3,xt>>>=gn,Pe|=gn,gn=(xt>15)<<2,xt>>>=gn,Pe|=gn,gn=(xt>3)<<1,xt>>>=gn,Pe|=gn,Pe|xt>>1}function Hn(){var xt=Gn(8,function(){return[]});function Pe(Rr){var gr=ee(Rr),bi=xt[Fe(gr)>>2];return bi.length>0?bi.pop():new ArrayBuffer(gr)}function gn(Rr){xt[Fe(Rr.byteLength)>>2].push(Rr)}function Cr(Rr,gr){var bi=null;switch(Rr){case ht:bi=new Int8Array(Pe(gr),0,gr);break;case ut:bi=new Uint8Array(Pe(gr),0,gr);break;case wt:bi=new Int16Array(Pe(2*gr),0,gr);break;case Gt:bi=new Uint16Array(Pe(2*gr),0,gr);break;case ue:bi=new Int32Array(Pe(4*gr),0,gr);break;case Ge:bi=new Uint32Array(Pe(4*gr),0,gr);break;case ln:bi=new Float32Array(Pe(4*gr),0,gr);break;default:return null}return bi.length!==gr?bi.subarray(0,gr):bi}function Hr(Rr){gn(Rr.buffer)}return{alloc:Pe,free:gn,allocType:Cr,freeType:Hr}}var Tr=Hn();Tr.zero=Hn();var Zr=3408,vr=3410,Ur=3411,jr=3412,ni=3413,Ar=3414,pi=3415,mi=33901,xi=33902,wo=3379,Li=3386,aa=34921,Pa=36347,Lo=36348,$o=35661,Mt=35660,Wt=34930,Se=36349,qe=34076,Rn=34024,Pn=7936,tn=7937,mn=7938,dr=35724,fr=34047,ai=36063,Vi=34852,mo=3553,si=34067,Wi=34069,Ui=33984,Xr=6408,bo=5126,Ni=5121,Eo=36160,Xi=36053,Mo=36064,Xo=16384,wl=function(xt,Pe){var gn=1;Pe.ext_texture_filter_anisotropic&&(gn=xt.getParameter(fr));var Cr=1,Hr=1;Pe.webgl_draw_buffers&&(Cr=xt.getParameter(Vi),Hr=xt.getParameter(ai));var Rr=!!Pe.oes_texture_float;if(Rr){var gr=xt.createTexture();xt.bindTexture(mo,gr),xt.texImage2D(mo,0,Xr,1,1,0,Xr,bo,null);var bi=xt.createFramebuffer();if(xt.bindFramebuffer(Eo,bi),xt.framebufferTexture2D(Eo,Mo,mo,gr,0),xt.bindTexture(mo,null),xt.checkFramebufferStatus(Eo)!==Xi)Rr=!1;else{xt.viewport(0,0,1,1),xt.clearColor(1,0,0,1),xt.clear(Xo);var li=Tr.allocType(bo,4);xt.readPixels(0,0,1,1,Xr,bo,li),xt.getError()?Rr=!1:(xt.deleteFramebuffer(bi),xt.deleteTexture(gr),Rr=li[0]===1),Tr.freeType(li)}}var Di=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Oi=!0;if(!Di){var Mi=xt.createTexture(),Gi=Tr.allocType(Ni,36);xt.activeTexture(Ui),xt.bindTexture(si,Mi),xt.texImage2D(Wi,0,Xr,3,3,0,Xr,Ni,Gi),Tr.freeType(Gi),xt.bindTexture(si,null),xt.deleteTexture(Mi),Oi=!xt.getError()}return{colorBits:[xt.getParameter(vr),xt.getParameter(Ur),xt.getParameter(jr),xt.getParameter(ni)],depthBits:xt.getParameter(Ar),stencilBits:xt.getParameter(pi),subpixelBits:xt.getParameter(Zr),extensions:Object.keys(Pe).filter(function(hi){return!!Pe[hi]}),maxAnisotropic:gn,maxDrawbuffers:Cr,maxColorAttachments:Hr,pointSizeDims:xt.getParameter(mi),lineWidthDims:xt.getParameter(xi),maxViewportDims:xt.getParameter(Li),maxCombinedTextureUnits:xt.getParameter($o),maxCubeMapSize:xt.getParameter(qe),maxRenderbufferSize:xt.getParameter(Rn),maxTextureUnits:xt.getParameter(Wt),maxTextureSize:xt.getParameter(wo),maxAttributes:xt.getParameter(aa),maxVertexUniforms:xt.getParameter(Pa),maxVertexTextureUnits:xt.getParameter(Mt),maxVaryingVectors:xt.getParameter(Lo),maxFragmentUniforms:xt.getParameter(Se),glsl:xt.getParameter(dr),renderer:xt.getParameter(tn),vendor:xt.getParameter(Pn),version:xt.getParameter(mn),readFloat:Rr,npotTextureCube:Oi}};function Ya(xt){return!!xt&&typeof xt=="object"&&Array.isArray(xt.shape)&&Array.isArray(xt.stride)&&typeof xt.offset=="number"&&xt.shape.length===xt.stride.length&&(Array.isArray(xt.data)||rr(xt.data))}var ca=function(xt){return Object.keys(xt).map(function(Pe){return xt[Pe]})},ws={shape:Ei,flatten:tr};function Ms(xt,Pe,gn){for(var Cr=0;Cr<Pe;++Cr)gn[Cr]=xt[Cr]}function re(xt,Pe,gn,Cr){for(var Hr=0,Rr=0;Rr<Pe;++Rr)for(var gr=xt[Rr],bi=0;bi<gn;++bi)Cr[Hr++]=gr[bi]}function ge(xt,Pe,gn,Cr,Hr,Rr){for(var gr=Rr,bi=0;bi<Pe;++bi)for(var li=xt[bi],Di=0;Di<gn;++Di)for(var Oi=li[Di],Mi=0;Mi<Cr;++Mi)Hr[gr++]=Oi[Mi]}function An(xt,Pe,gn,Cr,Hr){for(var Rr=1,gr=gn+1;gr<Pe.length;++gr)Rr*=Pe[gr];var bi=Pe[gn];if(Pe.length-gn===4){var li=Pe[gn+1],Di=Pe[gn+2],Oi=Pe[gn+3];for(gr=0;gr<bi;++gr)ge(xt[gr],li,Di,Oi,Cr,Hr),Hr+=Rr}else for(gr=0;gr<bi;++gr)An(xt[gr],Pe,gn+1,Cr,Hr),Hr+=Rr}function tr(xt,Pe,gn,Cr){var Hr=1;if(Pe.length)for(var Rr=0;Rr<Pe.length;++Rr)Hr*=Pe[Rr];else Hr=0;var gr=Cr||Tr.allocType(gn,Hr);switch(Pe.length){case 0:break;case 1:Ms(xt,Pe[0],gr);break;case 2:re(xt,Pe[0],Pe[1],gr);break;case 3:ge(xt,Pe[0],Pe[1],Pe[2],gr,0);break;default:An(xt,Pe,0,gr,0)}return gr}function Ei(xt){for(var Pe=[],gn=xt;gn.length;gn=gn[0])Pe.push(gn.length);return Pe}var Si={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},uo=5120,Es=5122,Ns=5124,As=5121,rl=5123,Xf=5125,Ud=5126,md=5126,Dl={int8:uo,int16:Es,int32:Ns,uint8:As,uint16:rl,uint32:Xf,float:Ud,float32:md},Qc=35048,Mf=35040,Jc={dynamic:Qc,stream:Mf,static:35044},Ic=ws.flatten,tu=ws.shape,Yf=35044,ac=35040,Ws=5121,Ru=5126,gf=[];gf[5120]=1,gf[5122]=2,gf[5124]=4,gf[5121]=1,gf[5123]=2,gf[5125]=4,gf[5126]=4;function Fh(xt){return Si[Object.prototype.toString.call(xt)]|0}function Uh(xt,Pe){for(var gn=0;gn<Pe.length;++gn)xt[gn]=Pe[gn]}function eu(xt,Pe,gn,Cr,Hr,Rr,gr){for(var bi=0,li=0;li<gn;++li)for(var Di=0;Di<Cr;++Di)xt[bi++]=Pe[Hr*li+Rr*Di+gr]}function mh(xt,Pe,gn,Cr){var Hr=0,Rr={};function gr(ur){this.id=Hr++,this.buffer=xt.createBuffer(),this.type=ur,this.usage=Yf,this.byteLength=0,this.dimension=1,this.dtype=Ws,this.persistentData=null,gn.profile&&(this.stats={size:0})}gr.prototype.bind=function(){xt.bindBuffer(this.type,this.buffer)},gr.prototype.destroy=function(){Gi(this)};var bi=[];function li(ur,Lr){var gi=bi.pop();return gi||(gi=new gr(ur)),gi.bind(),Mi(gi,Lr,ac,0,1,!1),gi}function Di(ur){bi.push(ur)}function Oi(ur,Lr,gi){ur.byteLength=Lr.byteLength,xt.bufferData(ur.type,Lr,gi)}function Mi(ur,Lr,gi,to,ri,oo){var yi;if(ur.usage=gi,Array.isArray(Lr)){if(ur.dtype=to||Ru,Lr.length>0){var eo;if(Array.isArray(Lr[0])){yi=tu(Lr);for(var oi=1,Yi=1;Yi<yi.length;++Yi)oi*=yi[Yi];ur.dimension=oi,eo=Ic(Lr,yi,ur.dtype),Oi(ur,eo,gi),oo?ur.persistentData=eo:Tr.freeType(eo)}else if(typeof Lr[0]=="number"){ur.dimension=ri;var ko=Tr.allocType(ur.dtype,Lr.length);Uh(ko,Lr),Oi(ur,ko,gi),oo?ur.persistentData=ko:Tr.freeType(ko)}else rr(Lr[0])?(ur.dimension=Lr[0].length,ur.dtype=to||Fh(Lr[0])||Ru,eo=Ic(Lr,[Lr.length,Lr[0].length],ur.dtype),Oi(ur,eo,gi),oo?ur.persistentData=eo:Tr.freeType(eo)):ot.raise("invalid buffer data")}}else if(rr(Lr))ur.dtype=to||Fh(Lr),ur.dimension=ri,Oi(ur,Lr,gi),oo&&(ur.persistentData=new Uint8Array(new Uint8Array(Lr.buffer)));else if(Ya(Lr)){yi=Lr.shape;var fa=Lr.stride,$i=Lr.offset,_i=0,qr=0,Uo=0,Ua=0;yi.length===1?(_i=yi[0],qr=1,Uo=fa[0],Ua=0):yi.length===2?(_i=yi[0],qr=yi[1],Uo=fa[0],Ua=fa[1]):ot.raise("invalid shape"),ur.dtype=to||Fh(Lr.data)||Ru,ur.dimension=qr;var lo=Tr.allocType(ur.dtype,_i*qr);eu(lo,Lr.data,_i,qr,Uo,Ua,$i),Oi(ur,lo,gi),oo?ur.persistentData=lo:Tr.freeType(lo)}else Lr instanceof ArrayBuffer?(ur.dtype=Ws,ur.dimension=ri,Oi(ur,Lr,gi),oo&&(ur.persistentData=new Uint8Array(new Uint8Array(Lr)))):ot.raise("invalid buffer data")}function Gi(ur){Pe.bufferCount--,Cr(ur);var Lr=ur.buffer;ot(Lr,"buffer must not be deleted already"),xt.deleteBuffer(Lr),ur.buffer=null,delete Rr[ur.id]}function hi(ur,Lr,gi,to){Pe.bufferCount++;var ri=new gr(Lr);Rr[ri.id]=ri;function oo(oi){var Yi=Yf,ko=null,fa=0,$i=0,_i=1;return Array.isArray(oi)||rr(oi)||Ya(oi)||oi instanceof ArrayBuffer?ko=oi:typeof oi=="number"?fa=oi|0:oi&&(ot.type(oi,"object","buffer arguments must be an object, a number or an array"),"data"in oi&&(ot(ko===null||Array.isArray(ko)||rr(ko)||Ya(ko),"invalid data for buffer"),ko=oi.data),"usage"in oi&&(ot.parameter(oi.usage,Jc,"invalid buffer usage"),Yi=Jc[oi.usage]),"type"in oi&&(ot.parameter(oi.type,Dl,"invalid buffer type"),$i=Dl[oi.type]),"dimension"in oi&&(ot.type(oi.dimension,"number","invalid dimension"),_i=oi.dimension|0),"length"in oi&&(ot.nni(fa,"buffer length must be a nonnegative integer"),fa=oi.length|0)),ri.bind(),ko?Mi(ri,ko,Yi,$i,_i,to):(fa&&xt.bufferData(ri.type,fa,Yi),ri.dtype=$i||Ws,ri.usage=Yi,ri.dimension=_i,ri.byteLength=fa),gn.profile&&(ri.stats.size=ri.byteLength*gf[ri.dtype]),oo}function yi(oi,Yi){ot(Yi+oi.byteLength<=ri.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+oi.byteLength+" starting from offset "+Yi+" to a buffer of size "+ri.byteLength),xt.bufferSubData(ri.type,Yi,oi)}function eo(oi,Yi){var ko=(Yi||0)|0,fa;if(ri.bind(),rr(oi)||oi instanceof ArrayBuffer)yi(oi,ko);else if(Array.isArray(oi)){if(oi.length>0)if(typeof oi[0]=="number"){var $i=Tr.allocType(ri.dtype,oi.length);Uh($i,oi),yi($i,ko),Tr.freeType($i)}else if(Array.isArray(oi[0])||rr(oi[0])){fa=tu(oi);var _i=Ic(oi,fa,ri.dtype);yi(_i,ko),Tr.freeType(_i)}else ot.raise("invalid buffer data")}else if(Ya(oi)){fa=oi.shape;var qr=oi.stride,Uo=0,Ua=0,lo=0,La=0;fa.length===1?(Uo=fa[0],Ua=1,lo=qr[0],La=0):fa.length===2?(Uo=fa[0],Ua=fa[1],lo=qr[0],La=qr[1]):ot.raise("invalid shape");var ha=Array.isArray(oi.data)?ri.dtype:Fh(oi.data),Ko=Tr.allocType(ha,Uo*Ua);eu(Ko,oi.data,Uo,Ua,lo,La,oi.offset),yi(Ko,ko),Tr.freeType(Ko)}else ot.raise("invalid data for buffer subdata");return oo}return gi||oo(ur),oo._reglType="buffer",oo._buffer=ri,oo.subdata=eo,gn.profile&&(oo.stats=ri.stats),oo.destroy=function(){Gi(ri)},oo}function Pi(){ca(Rr).forEach(function(ur){ur.buffer=xt.createBuffer(),xt.bindBuffer(ur.type,ur.buffer),xt.bufferData(ur.type,ur.persistentData||ur.byteLength,ur.usage)})}return gn.profile&&(Pe.getTotalBufferSize=function(){var ur=0;return Object.keys(Rr).forEach(function(Lr){ur+=Rr[Lr].stats.size}),ur}),{create:hi,createStream:li,destroyStream:Di,clear:function(){ca(Rr).forEach(Gi),bi.forEach(Gi)},getBuffer:function(ur){return ur&&ur._buffer instanceof gr?ur._buffer:null},restore:Pi,_initBuffer:Mi}}var zh=0,vd=0,gd=1,yd=1,vp=4,qf=4,Mu={points:zh,point:vd,lines:gd,line:yd,triangles:vp,triangle:qf,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},_d=0,Nl=1,Ps=4,nu=5120,sc=5121,of=5122,lc=5123,af=5124,kl=5125,Pu=34963,yf=35040,vh=35044;function $f(xt,Pe,gn,Cr){var Hr={},Rr=0,gr={uint8:sc,uint16:lc};Pe.oes_element_index_uint&&(gr.uint32=kl);function bi(Pi){this.id=Rr++,Hr[this.id]=this,this.buffer=Pi,this.primType=Ps,this.vertCount=0,this.type=0}bi.prototype.bind=function(){this.buffer.bind()};var li=[];function Di(Pi){var ur=li.pop();return ur||(ur=new bi(gn.create(null,Pu,!0,!1)._buffer)),Mi(ur,Pi,yf,-1,-1,0,0),ur}function Oi(Pi){li.push(Pi)}function Mi(Pi,ur,Lr,gi,to,ri,oo){Pi.buffer.bind();var yi;if(ur){var eo=oo;!oo&&(!rr(ur)||Ya(ur)&&!rr(ur.data))&&(eo=Pe.oes_element_index_uint?kl:lc),gn._initBuffer(Pi.buffer,ur,Lr,eo,3)}else xt.bufferData(Pu,ri,Lr),Pi.buffer.dtype=yi||sc,Pi.buffer.usage=Lr,Pi.buffer.dimension=3,Pi.buffer.byteLength=ri;if(yi=oo,!oo){switch(Pi.buffer.dtype){case sc:case nu:yi=sc;break;case lc:case of:yi=lc;break;case kl:case af:yi=kl;break;default:ot.raise("unsupported type for element array")}Pi.buffer.dtype=yi}Pi.type=yi,ot(yi!==kl||!!Pe.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var oi=to;oi<0&&(oi=Pi.buffer.byteLength,yi===lc?oi>>=1:yi===kl&&(oi>>=2)),Pi.vertCount=oi;var Yi=gi;if(gi<0){Yi=Ps;var ko=Pi.buffer.dimension;ko===1&&(Yi=_d),ko===2&&(Yi=Nl),ko===3&&(Yi=Ps)}Pi.primType=Yi}function Gi(Pi){Cr.elementsCount--,ot(Pi.buffer!==null,"must not double destroy elements"),delete Hr[Pi.id],Pi.buffer.destroy(),Pi.buffer=null}function hi(Pi,ur){var Lr=gn.create(null,Pu,!0),gi=new bi(Lr._buffer);Cr.elementsCount++;function to(ri){if(!ri)Lr(),gi.primType=Ps,gi.vertCount=0,gi.type=sc;else if(typeof ri=="number")Lr(ri),gi.primType=Ps,gi.vertCount=ri|0,gi.type=sc;else{var oo=null,yi=vh,eo=-1,oi=-1,Yi=0,ko=0;Array.isArray(ri)||rr(ri)||Ya(ri)?oo=ri:(ot.type(ri,"object","invalid arguments for elements"),"data"in ri&&(oo=ri.data,ot(Array.isArray(oo)||rr(oo)||Ya(oo),"invalid data for element buffer")),"usage"in ri&&(ot.parameter(ri.usage,Jc,"invalid element buffer usage"),yi=Jc[ri.usage]),"primitive"in ri&&(ot.parameter(ri.primitive,Mu,"invalid element buffer primitive"),eo=Mu[ri.primitive]),"count"in ri&&(ot(typeof ri.count=="number"&&ri.count>=0,"invalid vertex count for elements"),oi=ri.count|0),"type"in ri&&(ot.parameter(ri.type,gr,"invalid buffer type"),ko=gr[ri.type]),"length"in ri?Yi=ri.length|0:(Yi=oi,ko===lc||ko===of?Yi*=2:(ko===kl||ko===af)&&(Yi*=4))),Mi(gi,oo,yi,eo,oi,Yi,ko)}return to}return to(Pi),to._reglType="elements",to._elements=gi,to.subdata=function(ri,oo){return Lr.subdata(ri,oo),to},to.destroy=function(){Gi(gi)},to}return{create:hi,createStream:Di,destroyStream:Oi,getElements:function(Pi){return typeof Pi=="function"&&Pi._elements instanceof bi?Pi._elements:null},clear:function(){ca(Hr).forEach(Gi)}}}var us=new Float32Array(1),jh=new Uint32Array(us.buffer),Vh=5123;function gh(xt){for(var Pe=Tr.allocType(Vh,xt.length),gn=0;gn<xt.length;++gn)if(isNaN(xt[gn]))Pe[gn]=65535;else if(xt[gn]===1/0)Pe[gn]=31744;else if(xt[gn]===-1/0)Pe[gn]=64512;else{us[0]=xt[gn];var Cr=jh[0],Hr=Cr>>>31<<15,Rr=(Cr<<1>>>24)-127,gr=Cr>>13&1023;if(Rr<-24)Pe[gn]=Hr;else if(Rr<-14){var bi=-14-Rr;Pe[gn]=Hr+(gr+1024>>bi)}else Rr>15?Pe[gn]=Hr+31744:Pe[gn]=Hr+(Rr+15<<10)+gr}return Pe}function il(xt){return Array.isArray(xt)||rr(xt)}var Kf=function(xt){return!(xt&xt-1)&&!!xt},Qf=34467,K=3553,lt=34067,It=34069,Ke=6408,X=6406,Xn=6407,Mr=6409,ki=6410,Jr=32854,co=32855,so=36194,sa=32819,Po=32820,_a=33635,qa=34042,ra=6402,ma=34041,ls=35904,Aa=35906,Ia=36193,ka=33776,qs=33777,ks=33778,Ec=33779,es=35986,Iu=35987,du=34798,Lc=35840,Pf=35841,Zh=35842,Hh=35843,If=36196,Lu=5121,Lf=5123,yh=5125,Du=5126,P0=10242,xd=10243,Dc=10497,Gh=33071,gp=33648,Wh=10240,_h=10241,Nu=9728,Df=9729,Jf=9984,Yp=9985,Nf=9986,$a=9987,bd=33170,pu=4352,tt=4353,mt=4354,Xt=34046,dn=3317,nr=37440,Br=37441,vi=37443,qi=37444,da=33984,xa=[Jf,Nf,Yp,$a],ms=[0,Mr,ki,Xn,Ke],Fa={};Fa[Mr]=Fa[X]=Fa[ra]=1,Fa[ma]=Fa[ki]=2,Fa[Xn]=Fa[ls]=3,Fa[Ke]=Fa[Aa]=4;function Ba(xt){return"[object "+xt+"]"}var cc=Ba("HTMLCanvasElement"),ku=Ba("OffscreenCanvas"),$s=Ba("CanvasRenderingContext2D"),fo=Ba("ImageBitmap"),ru=Ba("HTMLImageElement"),Ed=Ba("HTMLVideoElement"),th=Object.keys(Si).concat([cc,ku,$s,fo,ru,Ed]),pl=[];pl[Lu]=1,pl[Du]=4,pl[Ia]=2,pl[Lf]=2,pl[yh]=4;var ns=[];ns[Jr]=2,ns[co]=2,ns[so]=2,ns[ma]=4,ns[ka]=.5,ns[qs]=.5,ns[ks]=1,ns[Ec]=1,ns[es]=.5,ns[Iu]=1,ns[du]=1,ns[Lc]=.5,ns[Pf]=.25,ns[Zh]=.5,ns[Hh]=.25,ns[If]=.5;function yp(xt){return Array.isArray(xt)&&(xt.length===0||typeof xt[0]=="number")}function Ri(xt){if(!Array.isArray(xt))return!1;var Pe=xt.length;return!(Pe===0||!il(xt[0]))}function eh(xt){return Object.prototype.toString.call(xt)}function Sd(xt){return eh(xt)===cc}function qp(xt){return eh(xt)===ku}function Nc(xt){return eh(xt)===$s}function mu(xt){return eh(xt)===fo}function _p(xt){return eh(xt)===ru}function $p(xt){return eh(xt)===Ed}function kc(xt){if(!xt)return!1;var Pe=eh(xt);return th.indexOf(Pe)>=0?!0:yp(xt)||Ri(xt)||Ya(xt)}function nh(xt){return Si[Object.prototype.toString.call(xt)]|0}function Jm(xt,Pe){var gn=Pe.length;switch(xt.type){case Lu:case Lf:case yh:case Du:var Cr=Tr.allocType(xt.type,gn);Cr.set(Pe),xt.data=Cr;break;case Ia:xt.data=gh(Pe);break;default:ot.raise("unsupported texture type, must specify a typed array")}}function Td(xt,Pe){return Tr.allocType(xt.type===Ia?Du:xt.type,Pe)}function xp(xt,Pe){xt.type===Ia?(xt.data=gh(Pe),Tr.freeType(Pe)):xt.data=Pe}function sm(xt,Pe,gn,Cr,Hr,Rr){for(var gr=xt.width,bi=xt.height,li=xt.channels,Di=gr*bi*li,Oi=Td(xt,Di),Mi=0,Gi=0;Gi<bi;++Gi)for(var hi=0;hi<gr;++hi)for(var Pi=0;Pi<li;++Pi)Oi[Mi++]=Pe[gn*hi+Cr*Gi+Hr*Pi+Rr];xp(xt,Oi)}function Bu(xt,Pe,gn,Cr,Hr,Rr){var gr;if(typeof ns[xt]!="undefined"?gr=ns[xt]:gr=Fa[xt]*pl[Pe],Rr&&(gr*=6),Hr){for(var bi=0,li=gn;li>=1;)bi+=gr*li*li,li/=2;return bi}else return gr*gn*Cr}function vu(xt,Pe,gn,Cr,Hr,Rr,gr){var bi={"don't care":pu,"dont care":pu,nice:mt,fast:tt},li={repeat:Dc,clamp:Gh,mirror:gp},Di={nearest:Nu,linear:Df},Oi=it({mipmap:$a,"nearest mipmap nearest":Jf,"linear mipmap nearest":Yp,"nearest mipmap linear":Nf,"linear mipmap linear":$a},Di),Mi={none:0,browser:qi},Gi={uint8:Lu,rgba4:sa,rgb565:_a,"rgb5 a1":Po},hi={alpha:X,luminance:Mr,"luminance alpha":ki,rgb:Xn,rgba:Ke,rgba4:Jr,"rgb5 a1":co,rgb565:so},Pi={};Pe.ext_srgb&&(hi.srgb=ls,hi.srgba=Aa),Pe.oes_texture_float&&(Gi.float32=Gi.float=Du),Pe.oes_texture_half_float&&(Gi.float16=Gi["half float"]=Ia),Pe.webgl_depth_texture&&(it(hi,{depth:ra,"depth stencil":ma}),it(Gi,{uint16:Lf,uint32:yh,"depth stencil":qa})),Pe.webgl_compressed_texture_s3tc&&it(Pi,{"rgb s3tc dxt1":ka,"rgba s3tc dxt1":qs,"rgba s3tc dxt3":ks,"rgba s3tc dxt5":Ec}),Pe.webgl_compressed_texture_atc&&it(Pi,{"rgb atc":es,"rgba atc explicit alpha":Iu,"rgba atc interpolated alpha":du}),Pe.webgl_compressed_texture_pvrtc&&it(Pi,{"rgb pvrtc 4bppv1":Lc,"rgb pvrtc 2bppv1":Pf,"rgba pvrtc 4bppv1":Zh,"rgba pvrtc 2bppv1":Hh}),Pe.webgl_compressed_texture_etc1&&(Pi["rgb etc1"]=If);var ur=Array.prototype.slice.call(xt.getParameter(Qf));Object.keys(Pi).forEach(function(We){var Pr=Pi[We];ur.indexOf(Pr)>=0&&(hi[We]=Pr)});var Lr=Object.keys(hi);gn.textureFormats=Lr;var gi=[];Object.keys(hi).forEach(function(We){var Pr=hi[We];gi[Pr]=We});var to=[];Object.keys(Gi).forEach(function(We){var Pr=Gi[We];to[Pr]=We});var ri=[];Object.keys(Di).forEach(function(We){var Pr=Di[We];ri[Pr]=We});var oo=[];Object.keys(Oi).forEach(function(We){var Pr=Oi[We];oo[Pr]=We});var yi=[];Object.keys(li).forEach(function(We){var Pr=li[We];yi[Pr]=We});var eo=Lr.reduce(function(We,Pr){var _r=hi[Pr];return _r===Mr||_r===X||_r===Mr||_r===ki||_r===ra||_r===ma||Pe.ext_srgb&&(_r===ls||_r===Aa)?We[_r]=_r:_r===co||Pr.indexOf("rgba")>=0?We[_r]=Ke:We[_r]=Xn,We},{});function oi(){this.internalformat=Ke,this.format=Ke,this.type=Lu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=qi,this.width=0,this.height=0,this.channels=0}function Yi(We,Pr){We.internalformat=Pr.internalformat,We.format=Pr.format,We.type=Pr.type,We.compressed=Pr.compressed,We.premultiplyAlpha=Pr.premultiplyAlpha,We.flipY=Pr.flipY,We.unpackAlignment=Pr.unpackAlignment,We.colorSpace=Pr.colorSpace,We.width=Pr.width,We.height=Pr.height,We.channels=Pr.channels}function ko(We,Pr){if(!(typeof Pr!="object"||!Pr)){if("premultiplyAlpha"in Pr&&(ot.type(Pr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),We.premultiplyAlpha=Pr.premultiplyAlpha),"flipY"in Pr&&(ot.type(Pr.flipY,"boolean","invalid texture flip"),We.flipY=Pr.flipY),"alignment"in Pr&&(ot.oneOf(Pr.alignment,[1,2,4,8],"invalid texture unpack alignment"),We.unpackAlignment=Pr.alignment),"colorSpace"in Pr&&(ot.parameter(Pr.colorSpace,Mi,"invalid colorSpace"),We.colorSpace=Mi[Pr.colorSpace]),"type"in Pr){var _r=Pr.type;ot(Pe.oes_texture_float||!(_r==="float"||_r==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),ot(Pe.oes_texture_half_float||!(_r==="half float"||_r==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ot(Pe.webgl_depth_texture||!(_r==="uint16"||_r==="uint32"||_r==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ot.parameter(_r,Gi,"invalid texture type"),We.type=Gi[_r]}var no=We.width,Da=We.height,ys=We.channels,he=!1;"shape"in Pr?(ot(Array.isArray(Pr.shape)&&Pr.shape.length>=2,"shape must be an array"),no=Pr.shape[0],Da=Pr.shape[1],Pr.shape.length===3&&(ys=Pr.shape[2],ot(ys>0&&ys<=4,"invalid number of channels"),he=!0),ot(no>=0&&no<=gn.maxTextureSize,"invalid width"),ot(Da>=0&&Da<=gn.maxTextureSize,"invalid height")):("radius"in Pr&&(no=Da=Pr.radius,ot(no>=0&&no<=gn.maxTextureSize,"invalid radius")),"width"in Pr&&(no=Pr.width,ot(no>=0&&no<=gn.maxTextureSize,"invalid width")),"height"in Pr&&(Da=Pr.height,ot(Da>=0&&Da<=gn.maxTextureSize,"invalid height")),"channels"in Pr&&(ys=Pr.channels,ot(ys>0&&ys<=4,"invalid number of channels"),he=!0)),We.width=no|0,We.height=Da|0,We.channels=ys|0;var je=!1;if("format"in Pr){var _n=Pr.format;ot(Pe.webgl_depth_texture||!(_n==="depth"||_n==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ot.parameter(_n,hi,"invalid texture format");var wr=We.internalformat=hi[_n];We.format=eo[wr],_n in Gi&&("type"in Pr||(We.type=Gi[_n])),_n in Pi&&(We.compressed=!0),je=!0}!he&&je?We.channels=Fa[We.format]:he&&!je?We.channels!==ms[We.format]&&(We.format=We.internalformat=ms[We.channels]):je&&he&&ot(We.channels===Fa[We.format],"number of channels inconsistent with specified format")}}function fa(We){xt.pixelStorei(nr,We.flipY),xt.pixelStorei(Br,We.premultiplyAlpha),xt.pixelStorei(vi,We.colorSpace),xt.pixelStorei(dn,We.unpackAlignment)}function $i(){oi.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _i(We,Pr){var _r=null;if(kc(Pr)?_r=Pr:Pr&&(ot.type(Pr,"object","invalid pixel data type"),ko(We,Pr),"x"in Pr&&(We.xOffset=Pr.x|0),"y"in Pr&&(We.yOffset=Pr.y|0),kc(Pr.data)&&(_r=Pr.data)),ot(!We.compressed||_r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Pr.copy){ot(!_r,"can not specify copy and data field for the same texture");var no=Hr.viewportWidth,Da=Hr.viewportHeight;We.width=We.width||no-We.xOffset,We.height=We.height||Da-We.yOffset,We.needsCopy=!0,ot(We.xOffset>=0&&We.xOffset<no&&We.yOffset>=0&&We.yOffset<Da&&We.width>0&&We.width<=no&&We.height>0&&We.height<=Da,"copy texture read out of bounds")}else if(!_r)We.width=We.width||1,We.height=We.height||1,We.channels=We.channels||4;else if(rr(_r))We.channels=We.channels||4,We.data=_r,!("type"in Pr)&&We.type===Lu&&(We.type=nh(_r));else if(yp(_r))We.channels=We.channels||4,Jm(We,_r),We.alignment=1,We.needsFree=!0;else if(Ya(_r)){var ys=_r.data;!Array.isArray(ys)&&We.type===Lu&&(We.type=nh(ys));var he=_r.shape,je=_r.stride,_n,wr,yr,In,Fn,Yn;he.length===3?(yr=he[2],Yn=je[2]):(ot(he.length===2,"invalid ndarray pixel data, must be 2 or 3D"),yr=1,Yn=1),_n=he[0],wr=he[1],In=je[0],Fn=je[1],We.alignment=1,We.width=_n,We.height=wr,We.channels=yr,We.format=We.internalformat=ms[yr],We.needsFree=!0,sm(We,ys,In,Fn,Yn,_r.offset)}else if(Sd(_r)||qp(_r)||Nc(_r))Sd(_r)||qp(_r)?We.element=_r:We.element=_r.canvas,We.width=We.element.width,We.height=We.element.height,We.channels=4;else if(mu(_r))We.element=_r,We.width=_r.width,We.height=_r.height,We.channels=4;else if(_p(_r))We.element=_r,We.width=_r.naturalWidth,We.height=_r.naturalHeight,We.channels=4;else if($p(_r))We.element=_r,We.width=_r.videoWidth,We.height=_r.videoHeight,We.channels=4;else if(Ri(_r)){var an=We.width||_r[0].length,Nn=We.height||_r.length,Re=We.channels;il(_r[0][0])?Re=Re||_r[0][0].length:Re=Re||1;for(var Bn=ws.shape(_r),Dr=1,Fr=0;Fr<Bn.length;++Fr)Dr*=Bn[Fr];var di=Td(We,Dr);ws.flatten(_r,Bn,"",di),xp(We,di),We.alignment=1,We.width=an,We.height=Nn,We.channels=Re,We.format=We.internalformat=ms[Re],We.needsFree=!0}We.type===Du?ot(gn.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):We.type===Ia&&ot(gn.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function qr(We,Pr,_r){var no=We.element,Da=We.data,ys=We.internalformat,he=We.format,je=We.type,_n=We.width,wr=We.height;fa(We),no?xt.texImage2D(Pr,_r,he,he,je,no):We.compressed?xt.compressedTexImage2D(Pr,_r,ys,_n,wr,0,Da):We.needsCopy?(Cr(),xt.copyTexImage2D(Pr,_r,he,We.xOffset,We.yOffset,_n,wr,0)):xt.texImage2D(Pr,_r,he,_n,wr,0,he,je,Da||null)}function Uo(We,Pr,_r,no,Da){var ys=We.element,he=We.data,je=We.internalformat,_n=We.format,wr=We.type,yr=We.width,In=We.height;fa(We),ys?xt.texSubImage2D(Pr,Da,_r,no,_n,wr,ys):We.compressed?xt.compressedTexSubImage2D(Pr,Da,_r,no,je,yr,In,he):We.needsCopy?(Cr(),xt.copyTexSubImage2D(Pr,Da,_r,no,We.xOffset,We.yOffset,yr,In)):xt.texSubImage2D(Pr,Da,_r,no,yr,In,_n,wr,he)}var Ua=[];function lo(){return Ua.pop()||new $i}function La(We){We.needsFree&&Tr.freeType(We.data),$i.call(We),Ua.push(We)}function ha(){oi.call(this),this.genMipmaps=!1,this.mipmapHint=pu,this.mipmask=0,this.images=Array(16)}function Ko(We,Pr,_r){var no=We.images[0]=lo();We.mipmask=1,no.width=We.width=Pr,no.height=We.height=_r,no.channels=We.channels=4}function hs(We,Pr){var _r=null;if(kc(Pr))_r=We.images[0]=lo(),Yi(_r,We),_i(_r,Pr),We.mipmask=1;else if(ko(We,Pr),Array.isArray(Pr.mipmap))for(var no=Pr.mipmap,Da=0;Da<no.length;++Da)_r=We.images[Da]=lo(),Yi(_r,We),_r.width>>=Da,_r.height>>=Da,_i(_r,no[Da]),We.mipmask|=1<<Da;else _r=We.images[0]=lo(),Yi(_r,We),_i(_r,Pr),We.mipmask=1;Yi(We,We.images[0]),We.compressed&&(We.internalformat===ka||We.internalformat===qs||We.internalformat===ks||We.internalformat===Ec)&&ot(We.width%4===0&&We.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function yl(We,Pr){for(var _r=We.images,no=0;no<_r.length;++no){if(!_r[no])return;qr(_r[no],Pr,no)}}var qc=[];function Va(){var We=qc.pop()||new ha;oi.call(We),We.mipmask=0;for(var Pr=0;Pr<16;++Pr)We.images[Pr]=null;return We}function hl(We){for(var Pr=We.images,_r=0;_r<Pr.length;++_r)Pr[_r]&&La(Pr[_r]),Pr[_r]=null;qc.push(We)}function Js(){this.minFilter=Nu,this.magFilter=Nu,this.wrapS=Gh,this.wrapT=Gh,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=pu}function Yl(We,Pr){if("min"in Pr){var _r=Pr.min;ot.parameter(_r,Oi),We.minFilter=Oi[_r],xa.indexOf(We.minFilter)>=0&&!("faces"in Pr)&&(We.genMipmaps=!0)}if("mag"in Pr){var no=Pr.mag;ot.parameter(no,Di),We.magFilter=Di[no]}var Da=We.wrapS,ys=We.wrapT;if("wrap"in Pr){var he=Pr.wrap;typeof he=="string"?(ot.parameter(he,li),Da=ys=li[he]):Array.isArray(he)&&(ot.parameter(he[0],li),ot.parameter(he[1],li),Da=li[he[0]],ys=li[he[1]])}else{if("wrapS"in Pr){var je=Pr.wrapS;ot.parameter(je,li),Da=li[je]}if("wrapT"in Pr){var _n=Pr.wrapT;ot.parameter(_n,li),ys=li[_n]}}if(We.wrapS=Da,We.wrapT=ys,"anisotropic"in Pr){var wr=Pr.anisotropic;ot(typeof wr=="number"&&wr>=1&&wr<=gn.maxAnisotropic,"aniso samples must be between 1 and "),We.anisotropic=Pr.anisotropic}if("mipmap"in Pr){var yr=!1;switch(typeof Pr.mipmap){case"string":ot.parameter(Pr.mipmap,bi,"invalid mipmap hint"),We.mipmapHint=bi[Pr.mipmap],We.genMipmaps=!0,yr=!0;break;case"boolean":yr=We.genMipmaps=Pr.mipmap;break;case"object":ot(Array.isArray(Pr.mipmap),"invalid mipmap type"),We.genMipmaps=!1,yr=!0;break;default:ot.raise("invalid mipmap type")}yr&&!("min"in Pr)&&(We.minFilter=Jf)}}function Ul(We,Pr){xt.texParameteri(Pr,_h,We.minFilter),xt.texParameteri(Pr,Wh,We.magFilter),xt.texParameteri(Pr,P0,We.wrapS),xt.texParameteri(Pr,xd,We.wrapT),Pe.ext_texture_filter_anisotropic&&xt.texParameteri(Pr,Xt,We.anisotropic),We.genMipmaps&&(xt.hint(bd,We.mipmapHint),xt.generateMipmap(Pr))}var rs=0,ql={},tc=gn.maxTextureUnits,mc=Array(tc).map(function(){return null});function Oa(We){oi.call(this),this.mipmask=0,this.internalformat=Ke,this.id=rs++,this.refCount=1,this.target=We,this.texture=xt.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Js,gr.profile&&(this.stats={size:0})}function $c(We){xt.activeTexture(da),xt.bindTexture(We.target,We.texture)}function Os(){var We=mc[0];We?xt.bindTexture(We.target,We.texture):xt.bindTexture(K,null)}function Zo(We){var Pr=We.texture;ot(Pr,"must not double destroy texture");var _r=We.unit,no=We.target;_r>=0&&(xt.activeTexture(da+_r),xt.bindTexture(no,null),mc[_r]=null),xt.deleteTexture(Pr),We.texture=null,We.params=null,We.pixels=null,We.refCount=0,delete ql[We.id],Rr.textureCount--}it(Oa.prototype,{bind:function(){var We=this;We.bindCount+=1;var Pr=We.unit;if(Pr<0){for(var _r=0;_r<tc;++_r){var no=mc[_r];if(no){if(no.bindCount>0)continue;no.unit=-1}mc[_r]=We,Pr=_r;break}Pr>=tc&&ot.raise("insufficient number of texture units"),gr.profile&&Rr.maxTextureUnits<Pr+1&&(Rr.maxTextureUnits=Pr+1),We.unit=Pr,xt.activeTexture(da+Pr),xt.bindTexture(We.target,We.texture)}return Pr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Zo(this)}});function Ea(We,Pr){var _r=new Oa(K);ql[_r.id]=_r,Rr.textureCount++;function no(he,je){var _n=_r.texInfo;Js.call(_n);var wr=Va();return typeof he=="number"?typeof je=="number"?Ko(wr,he|0,je|0):Ko(wr,he|0,he|0):he?(ot.type(he,"object","invalid arguments to regl.texture"),Yl(_n,he),hs(wr,he)):Ko(wr,1,1),_n.genMipmaps&&(wr.mipmask=(wr.width<<1)-1),_r.mipmask=wr.mipmask,Yi(_r,wr),ot.texture2D(_n,wr,gn),_r.internalformat=wr.internalformat,no.width=wr.width,no.height=wr.height,$c(_r),yl(wr,K),Ul(_n,K),Os(),hl(wr),gr.profile&&(_r.stats.size=Bu(_r.internalformat,_r.type,wr.width,wr.height,_n.genMipmaps,!1)),no.format=gi[_r.internalformat],no.type=to[_r.type],no.mag=ri[_n.magFilter],no.min=oo[_n.minFilter],no.wrapS=yi[_n.wrapS],no.wrapT=yi[_n.wrapT],no}function Da(he,je,_n,wr){ot(!!he,"must specify image data");var yr=je|0,In=_n|0,Fn=wr|0,Yn=lo();return Yi(Yn,_r),Yn.width=0,Yn.height=0,_i(Yn,he),Yn.width=Yn.width||(_r.width>>Fn)-yr,Yn.height=Yn.height||(_r.height>>Fn)-In,ot(_r.type===Yn.type&&_r.format===Yn.format&&_r.internalformat===Yn.internalformat,"incompatible format for texture.subimage"),ot(yr>=0&&In>=0&&yr+Yn.width<=_r.width&&In+Yn.height<=_r.height,"texture.subimage write out of bounds"),ot(_r.mipmask&1<<Fn,"missing mipmap data"),ot(Yn.data||Yn.element||Yn.needsCopy,"missing image data"),$c(_r),Uo(Yn,K,yr,In,Fn),Os(),La(Yn),no}function ys(he,je){var _n=he|0,wr=je|0||_n;if(_n===_r.width&&wr===_r.height)return no;no.width=_r.width=_n,no.height=_r.height=wr,$c(_r);for(var yr=0;_r.mipmask>>yr;++yr){var In=_n>>yr,Fn=wr>>yr;if(!In||!Fn)break;xt.texImage2D(K,yr,_r.format,In,Fn,0,_r.format,_r.type,null)}return Os(),gr.profile&&(_r.stats.size=Bu(_r.internalformat,_r.type,_n,wr,!1,!1)),no}return no(We,Pr),no.subimage=Da,no.resize=ys,no._reglType="texture2d",no._texture=_r,gr.profile&&(no.stats=_r.stats),no.destroy=function(){_r.decRef()},no}function ja(We,Pr,_r,no,Da,ys){var he=new Oa(lt);ql[he.id]=he,Rr.cubeCount++;var je=new Array(6);function _n(In,Fn,Yn,an,Nn,Re){var Bn,Dr=he.texInfo;for(Js.call(Dr),Bn=0;Bn<6;++Bn)je[Bn]=Va();if(typeof In=="number"||!In){var Fr=In|0||1;for(Bn=0;Bn<6;++Bn)Ko(je[Bn],Fr,Fr)}else if(typeof In=="object")if(Fn)hs(je[0],In),hs(je[1],Fn),hs(je[2],Yn),hs(je[3],an),hs(je[4],Nn),hs(je[5],Re);else if(Yl(Dr,In),ko(he,In),"faces"in In){var di=In.faces;for(ot(Array.isArray(di)&&di.length===6,"cube faces must be a length 6 array"),Bn=0;Bn<6;++Bn)ot(typeof di[Bn]=="object"&&!!di[Bn],"invalid input for cube map face"),Yi(je[Bn],he),hs(je[Bn],di[Bn])}else for(Bn=0;Bn<6;++Bn)hs(je[Bn],In);else ot.raise("invalid arguments to cube map");for(Yi(he,je[0]),gn.npotTextureCube||ot(Kf(he.width)&&Kf(he.height),"your browser does not support non power or two texture dimensions"),Dr.genMipmaps?he.mipmask=(je[0].width<<1)-1:he.mipmask=je[0].mipmask,ot.textureCube(he,Dr,je,gn),he.internalformat=je[0].internalformat,_n.width=je[0].width,_n.height=je[0].height,$c(he),Bn=0;Bn<6;++Bn)yl(je[Bn],It+Bn);for(Ul(Dr,lt),Os(),gr.profile&&(he.stats.size=Bu(he.internalformat,he.type,_n.width,_n.height,Dr.genMipmaps,!0)),_n.format=gi[he.internalformat],_n.type=to[he.type],_n.mag=ri[Dr.magFilter],_n.min=oo[Dr.minFilter],_n.wrapS=yi[Dr.wrapS],_n.wrapT=yi[Dr.wrapT],Bn=0;Bn<6;++Bn)hl(je[Bn]);return _n}function wr(In,Fn,Yn,an,Nn){ot(!!Fn,"must specify image data"),ot(typeof In=="number"&&In===(In|0)&&In>=0&&In<6,"invalid face");var Re=Yn|0,Bn=an|0,Dr=Nn|0,Fr=lo();return Yi(Fr,he),Fr.width=0,Fr.height=0,_i(Fr,Fn),Fr.width=Fr.width||(he.width>>Dr)-Re,Fr.height=Fr.height||(he.height>>Dr)-Bn,ot(he.type===Fr.type&&he.format===Fr.format&&he.internalformat===Fr.internalformat,"incompatible format for texture.subimage"),ot(Re>=0&&Bn>=0&&Re+Fr.width<=he.width&&Bn+Fr.height<=he.height,"texture.subimage write out of bounds"),ot(he.mipmask&1<<Dr,"missing mipmap data"),ot(Fr.data||Fr.element||Fr.needsCopy,"missing image data"),$c(he),Uo(Fr,It+In,Re,Bn,Dr),Os(),La(Fr),_n}function yr(In){var Fn=In|0;if(Fn!==he.width){_n.width=he.width=Fn,_n.height=he.height=Fn,$c(he);for(var Yn=0;Yn<6;++Yn)for(var an=0;he.mipmask>>an;++an)xt.texImage2D(It+Yn,an,he.format,Fn>>an,Fn>>an,0,he.format,he.type,null);return Os(),gr.profile&&(he.stats.size=Bu(he.internalformat,he.type,_n.width,_n.height,!1,!0)),_n}}return _n(We,Pr,_r,no,Da,ys),_n.subimage=wr,_n.resize=yr,_n._reglType="textureCube",_n._texture=he,gr.profile&&(_n.stats=he.stats),_n.destroy=function(){he.decRef()},_n}function $l(){for(var We=0;We<tc;++We)xt.activeTexture(da+We),xt.bindTexture(K,null),mc[We]=null;ca(ql).forEach(Zo),Rr.cubeCount=0,Rr.textureCount=0}gr.profile&&(Rr.getTotalTextureSize=function(){var We=0;return Object.keys(ql).forEach(function(Pr){We+=ql[Pr].stats.size}),We});function ch(){for(var We=0;We<tc;++We){var Pr=mc[We];Pr&&(Pr.bindCount=0,Pr.unit=-1,mc[We]=null)}ca(ql).forEach(function(_r){_r.texture=xt.createTexture(),xt.bindTexture(_r.target,_r.texture);for(var no=0;no<32;++no)if(_r.mipmask&1<<no)if(_r.target===K)xt.texImage2D(K,no,_r.internalformat,_r.width>>no,_r.height>>no,0,_r.internalformat,_r.type,null);else for(var Da=0;Da<6;++Da)xt.texImage2D(It+Da,no,_r.internalformat,_r.width>>no,_r.height>>no,0,_r.internalformat,_r.type,null);Ul(_r.texInfo,_r.target)})}return{create2D:Ea,createCube:ja,clear:$l,getTexture:function(We){return null},restore:ch}}var va=36161,Fu=32854,Uu=32855,uc=36194,Xh=33189,Gl=36168,Gc=34041,iu=35907,bp=34836,Ao=34842,xo=34843,zu=[];zu[Fu]=2,zu[Uu]=2,zu[uc]=2,zu[Xh]=2,zu[Gl]=1,zu[Gc]=4,zu[iu]=4,zu[bp]=16,zu[Ao]=8,zu[xo]=6;function ou(xt,Pe,gn){return zu[xt]*Pe*gn}var rh=function(xt,Pe,gn,Cr,Hr){var Rr={rgba4:Fu,rgb565:uc,"rgb5 a1":Uu,depth:Xh,stencil:Gl,"depth stencil":Gc};Pe.ext_srgb&&(Rr.srgba=iu),Pe.ext_color_buffer_half_float&&(Rr.rgba16f=Ao,Rr.rgb16f=xo),Pe.webgl_color_buffer_float&&(Rr.rgba32f=bp);var gr=[];Object.keys(Rr).forEach(function(hi){var Pi=Rr[hi];gr[Pi]=hi});var bi=0,li={};function Di(hi){this.id=bi++,this.refCount=1,this.renderbuffer=hi,this.format=Fu,this.width=0,this.height=0,Hr.profile&&(this.stats={size:0})}Di.prototype.decRef=function(){--this.refCount<=0&&Oi(this)};function Oi(hi){var Pi=hi.renderbuffer;ot(Pi,"must not double destroy renderbuffer"),xt.bindRenderbuffer(va,null),xt.deleteRenderbuffer(Pi),hi.renderbuffer=null,hi.refCount=0,delete li[hi.id],Cr.renderbufferCount--}function Mi(hi,Pi){var ur=new Di(xt.createRenderbuffer());li[ur.id]=ur,Cr.renderbufferCount++;function Lr(to,ri){var oo=0,yi=0,eo=Fu;if(typeof to=="object"&&to){var oi=to;if("shape"in oi){var Yi=oi.shape;ot(Array.isArray(Yi)&&Yi.length>=2,"invalid renderbuffer shape"),oo=Yi[0]|0,yi=Yi[1]|0}else"radius"in oi&&(oo=yi=oi.radius|0),"width"in oi&&(oo=oi.width|0),"height"in oi&&(yi=oi.height|0);"format"in oi&&(ot.parameter(oi.format,Rr,"invalid renderbuffer format"),eo=Rr[oi.format])}else typeof to=="number"?(oo=to|0,typeof ri=="number"?yi=ri|0:yi=oo):to?ot.raise("invalid arguments to renderbuffer constructor"):oo=yi=1;if(ot(oo>0&&yi>0&&oo<=gn.maxRenderbufferSize&&yi<=gn.maxRenderbufferSize,"invalid renderbuffer size"),!(oo===ur.width&&yi===ur.height&&eo===ur.format))return Lr.width=ur.width=oo,Lr.height=ur.height=yi,ur.format=eo,xt.bindRenderbuffer(va,ur.renderbuffer),xt.renderbufferStorage(va,eo,oo,yi),ot(xt.getError()===0,"invalid render buffer format"),Hr.profile&&(ur.stats.size=ou(ur.format,ur.width,ur.height)),Lr.format=gr[ur.format],Lr}function gi(to,ri){var oo=to|0,yi=ri|0||oo;return oo===ur.width&&yi===ur.height||(ot(oo>0&&yi>0&&oo<=gn.maxRenderbufferSize&&yi<=gn.maxRenderbufferSize,"invalid renderbuffer size"),Lr.width=ur.width=oo,Lr.height=ur.height=yi,xt.bindRenderbuffer(va,ur.renderbuffer),xt.renderbufferStorage(va,ur.format,oo,yi),ot(xt.getError()===0,"invalid render buffer format"),Hr.profile&&(ur.stats.size=ou(ur.format,ur.width,ur.height))),Lr}return Lr(hi,Pi),Lr.resize=gi,Lr._reglType="renderbuffer",Lr._renderbuffer=ur,Hr.profile&&(Lr.stats=ur.stats),Lr.destroy=function(){ur.decRef()},Lr}Hr.profile&&(Cr.getTotalRenderbufferSize=function(){var hi=0;return Object.keys(li).forEach(function(Pi){hi+=li[Pi].stats.size}),hi});function Gi(){ca(li).forEach(function(hi){hi.renderbuffer=xt.createRenderbuffer(),xt.bindRenderbuffer(va,hi.renderbuffer),xt.renderbufferStorage(va,hi.format,hi.width,hi.height)}),xt.bindRenderbuffer(va,null)}return{create:Mi,clear:function(){ca(li).forEach(Oi)},restore:Gi}},ul=36160,Wc=36161,kf=3553,wd=34069,fs=36064,fc=36096,I0=36128,Yh=33306,Kp=36053,xh=36054,au=36055,zd=36057,Gr=36061,ih=36193,Xc=5121,jd=5126,bh=6407,oh=6408,ah=6402,Qp=[bh,oh],sh=[];sh[oh]=4,sh[bh]=3;var Bf=[];Bf[Xc]=1,Bf[jd]=4,Bf[ih]=2;var Eh=32854,Al=32855,Qa=36194,ju=33189,Jp=36168,L0=34041,t0=35907,_=34836,E=34842,b=34843,A=[Eh,Al,Qa,t0,E,b,_],B={};B[Kp]="complete",B[xh]="incomplete attachment",B[zd]="incomplete dimensions",B[au]="incomplete, missing attachment",B[Gr]="unsupported";function H(xt,Pe,gn,Cr,Hr,Rr){var gr={cur:null,next:null,dirty:!1,setFBO:null},bi=["rgba"],li=["rgba4","rgb565","rgb5 a1"];Pe.ext_srgb&&li.push("srgba"),Pe.ext_color_buffer_half_float&&li.push("rgba16f","rgb16f"),Pe.webgl_color_buffer_float&&li.push("rgba32f");var Di=["uint8"];Pe.oes_texture_half_float&&Di.push("half float","float16"),Pe.oes_texture_float&&Di.push("float","float32");function Oi($i,_i,qr){this.target=$i,this.texture=_i,this.renderbuffer=qr;var Uo=0,Ua=0;_i?(Uo=_i.width,Ua=_i.height):qr&&(Uo=qr.width,Ua=qr.height),this.width=Uo,this.height=Ua}function Mi($i){$i&&($i.texture&&$i.texture._texture.decRef(),$i.renderbuffer&&$i.renderbuffer._renderbuffer.decRef())}function Gi($i,_i,qr){if($i)if($i.texture){var Uo=$i.texture._texture,Ua=Math.max(1,Uo.width),lo=Math.max(1,Uo.height);ot(Ua===_i&&lo===qr,"inconsistent width/height for supplied texture"),Uo.refCount+=1}else{var La=$i.renderbuffer._renderbuffer;ot(La.width===_i&&La.height===qr,"inconsistent width/height for renderbuffer"),La.refCount+=1}}function hi($i,_i){_i&&(_i.texture?xt.framebufferTexture2D(ul,$i,_i.target,_i.texture._texture.texture,0):xt.framebufferRenderbuffer(ul,$i,Wc,_i.renderbuffer._renderbuffer.renderbuffer))}function Pi($i){var _i=kf,qr=null,Uo=null,Ua=$i;typeof $i=="object"&&(Ua=$i.data,"target"in $i&&(_i=$i.target|0)),ot.type(Ua,"function","invalid attachment data");var lo=Ua._reglType;return lo==="texture2d"?(qr=Ua,ot(_i===kf)):lo==="textureCube"?(qr=Ua,ot(_i>=wd&&_i<wd+6,"invalid cube map target")):lo==="renderbuffer"?(Uo=Ua,_i=Wc):ot.raise("invalid regl object for attachment"),new Oi(_i,qr,Uo)}function ur($i,_i,qr,Uo,Ua){if(qr){var lo=Cr.create2D({width:$i,height:_i,format:Uo,type:Ua});return lo._texture.refCount=0,new Oi(kf,lo,null)}else{var La=Hr.create({width:$i,height:_i,format:Uo});return La._renderbuffer.refCount=0,new Oi(Wc,null,La)}}function Lr($i){return $i&&($i.texture||$i.renderbuffer)}function gi($i,_i,qr){$i&&($i.texture?$i.texture.resize(_i,qr):$i.renderbuffer&&$i.renderbuffer.resize(_i,qr),$i.width=_i,$i.height=qr)}var to=0,ri={};function oo(){this.id=to++,ri[this.id]=this,this.framebuffer=xt.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function yi($i){$i.colorAttachments.forEach(Mi),Mi($i.depthAttachment),Mi($i.stencilAttachment),Mi($i.depthStencilAttachment)}function eo($i){var _i=$i.framebuffer;ot(_i,"must not double destroy framebuffer"),xt.deleteFramebuffer(_i),$i.framebuffer=null,Rr.framebufferCount--,delete ri[$i.id]}function oi($i){var _i;xt.bindFramebuffer(ul,$i.framebuffer);var qr=$i.colorAttachments;for(_i=0;_i<qr.length;++_i)hi(fs+_i,qr[_i]);for(_i=qr.length;_i<gn.maxColorAttachments;++_i)xt.framebufferTexture2D(ul,fs+_i,kf,null,0);xt.framebufferTexture2D(ul,Yh,kf,null,0),xt.framebufferTexture2D(ul,fc,kf,null,0),xt.framebufferTexture2D(ul,I0,kf,null,0),hi(fc,$i.depthAttachment),hi(I0,$i.stencilAttachment),hi(Yh,$i.depthStencilAttachment);var Uo=xt.checkFramebufferStatus(ul);!xt.isContextLost()&&Uo!==Kp&&ot.raise("framebuffer configuration not supported, status = "+B[Uo]),xt.bindFramebuffer(ul,gr.next?gr.next.framebuffer:null),gr.cur=gr.next,xt.getError()}function Yi($i,_i){var qr=new oo;Rr.framebufferCount++;function Uo(lo,La){var ha;ot(gr.next!==qr,"can not update framebuffer which is currently in use");var Ko=0,hs=0,yl=!0,qc=!0,Va=null,hl=!0,Js="rgba",Yl="uint8",Ul=1,rs=null,ql=null,tc=null,mc=!1;if(typeof lo=="number")Ko=lo|0,hs=La|0||Ko;else if(!lo)Ko=hs=1;else{ot.type(lo,"object","invalid arguments for framebuffer");var Oa=lo;if("shape"in Oa){var $c=Oa.shape;ot(Array.isArray($c)&&$c.length>=2,"invalid shape for framebuffer"),Ko=$c[0],hs=$c[1]}else"radius"in Oa&&(Ko=hs=Oa.radius),"width"in Oa&&(Ko=Oa.width),"height"in Oa&&(hs=Oa.height);("color"in Oa||"colors"in Oa)&&(Va=Oa.color||Oa.colors,Array.isArray(Va)&&ot(Va.length===1||Pe.webgl_draw_buffers,"multiple render targets not supported")),Va||("colorCount"in Oa&&(Ul=Oa.colorCount|0,ot(Ul>0,"invalid color buffer count")),"colorTexture"in Oa&&(hl=!!Oa.colorTexture,Js="rgba4"),"colorType"in Oa&&(Yl=Oa.colorType,hl?(ot(Pe.oes_texture_float||!(Yl==="float"||Yl==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ot(Pe.oes_texture_half_float||!(Yl==="half float"||Yl==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Yl==="half float"||Yl==="float16"?(ot(Pe.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Js="rgba16f"):(Yl==="float"||Yl==="float32")&&(ot(Pe.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Js="rgba32f"),ot.oneOf(Yl,Di,"invalid color type")),"colorFormat"in Oa&&(Js=Oa.colorFormat,bi.indexOf(Js)>=0?hl=!0:li.indexOf(Js)>=0?hl=!1:hl?ot.oneOf(Oa.colorFormat,bi,"invalid color format for texture"):ot.oneOf(Oa.colorFormat,li,"invalid color format for renderbuffer"))),("depthTexture"in Oa||"depthStencilTexture"in Oa)&&(mc=!!(Oa.depthTexture||Oa.depthStencilTexture),ot(!mc||Pe.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Oa&&(typeof Oa.depth=="boolean"?yl=Oa.depth:(rs=Oa.depth,qc=!1)),"stencil"in Oa&&(typeof Oa.stencil=="boolean"?qc=Oa.stencil:(ql=Oa.stencil,yl=!1)),"depthStencil"in Oa&&(typeof Oa.depthStencil=="boolean"?yl=qc=Oa.depthStencil:(tc=Oa.depthStencil,yl=!1,qc=!1))}var Os=null,Zo=null,Ea=null,ja=null;if(Array.isArray(Va))Os=Va.map(Pi);else if(Va)Os=[Pi(Va)];else for(Os=new Array(Ul),ha=0;ha<Ul;++ha)Os[ha]=ur(Ko,hs,hl,Js,Yl);ot(Pe.webgl_draw_buffers||Os.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ot(Os.length<=gn.maxColorAttachments,"too many color attachments, not supported"),Ko=Ko||Os[0].width,hs=hs||Os[0].height,rs?Zo=Pi(rs):yl&&!qc&&(Zo=ur(Ko,hs,mc,"depth","uint32")),ql?Ea=Pi(ql):qc&&!yl&&(Ea=ur(Ko,hs,!1,"stencil","uint8")),tc?ja=Pi(tc):!rs&&!ql&&qc&&yl&&(ja=ur(Ko,hs,mc,"depth stencil","depth stencil")),ot(!!rs+!!ql+!!tc<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var $l=null;for(ha=0;ha<Os.length;++ha)if(Gi(Os[ha],Ko,hs),ot(!Os[ha]||Os[ha].texture&&Qp.indexOf(Os[ha].texture._texture.format)>=0||Os[ha].renderbuffer&&A.indexOf(Os[ha].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ha+" is invalid"),Os[ha]&&Os[ha].texture){var ch=sh[Os[ha].texture._texture.format]*Bf[Os[ha].texture._texture.type];$l===null?$l=ch:ot($l===ch,"all color attachments much have the same number of bits per pixel.")}return Gi(Zo,Ko,hs),ot(!Zo||Zo.texture&&Zo.texture._texture.format===ah||Zo.renderbuffer&&Zo.renderbuffer._renderbuffer.format===ju,"invalid depth attachment for framebuffer object"),Gi(Ea,Ko,hs),ot(!Ea||Ea.renderbuffer&&Ea.renderbuffer._renderbuffer.format===Jp,"invalid stencil attachment for framebuffer object"),Gi(ja,Ko,hs),ot(!ja||ja.texture&&ja.texture._texture.format===L0||ja.renderbuffer&&ja.renderbuffer._renderbuffer.format===L0,"invalid depth-stencil attachment for framebuffer object"),yi(qr),qr.width=Ko,qr.height=hs,qr.colorAttachments=Os,qr.depthAttachment=Zo,qr.stencilAttachment=Ea,qr.depthStencilAttachment=ja,Uo.color=Os.map(Lr),Uo.depth=Lr(Zo),Uo.stencil=Lr(Ea),Uo.depthStencil=Lr(ja),Uo.width=qr.width,Uo.height=qr.height,oi(qr),Uo}function Ua(lo,La){ot(gr.next!==qr,"can not resize a framebuffer which is currently in use");var ha=Math.max(lo|0,1),Ko=Math.max(La|0||ha,1);if(ha===qr.width&&Ko===qr.height)return Uo;for(var hs=qr.colorAttachments,yl=0;yl<hs.length;++yl)gi(hs[yl],ha,Ko);return gi(qr.depthAttachment,ha,Ko),gi(qr.stencilAttachment,ha,Ko),gi(qr.depthStencilAttachment,ha,Ko),qr.width=Uo.width=ha,qr.height=Uo.height=Ko,oi(qr),Uo}return Uo($i,_i),it(Uo,{resize:Ua,_reglType:"framebuffer",_framebuffer:qr,destroy:function(){eo(qr),yi(qr)},use:function(lo){gr.setFBO({framebuffer:Uo},lo)}})}function ko($i){var _i=Array(6);function qr(Ua){var lo;ot(_i.indexOf(gr.next)<0,"can not update framebuffer which is currently in use");var La={color:null},ha=0,Ko=null,hs="rgba",yl="uint8",qc=1;if(typeof Ua=="number")ha=Ua|0;else if(!Ua)ha=1;else{ot.type(Ua,"object","invalid arguments for framebuffer");var Va=Ua;if("shape"in Va){var hl=Va.shape;ot(Array.isArray(hl)&&hl.length>=2,"invalid shape for framebuffer"),ot(hl[0]===hl[1],"cube framebuffer must be square"),ha=hl[0]}else"radius"in Va&&(ha=Va.radius|0),"width"in Va?(ha=Va.width|0,"height"in Va&&ot(Va.height===ha,"must be square")):"height"in Va&&(ha=Va.height|0);("color"in Va||"colors"in Va)&&(Ko=Va.color||Va.colors,Array.isArray(Ko)&&ot(Ko.length===1||Pe.webgl_draw_buffers,"multiple render targets not supported")),Ko||("colorCount"in Va&&(qc=Va.colorCount|0,ot(qc>0,"invalid color buffer count")),"colorType"in Va&&(ot.oneOf(Va.colorType,Di,"invalid color type"),yl=Va.colorType),"colorFormat"in Va&&(hs=Va.colorFormat,ot.oneOf(Va.colorFormat,bi,"invalid color format for texture"))),"depth"in Va&&(La.depth=Va.depth),"stencil"in Va&&(La.stencil=Va.stencil),"depthStencil"in Va&&(La.depthStencil=Va.depthStencil)}var Js;if(Ko)if(Array.isArray(Ko))for(Js=[],lo=0;lo<Ko.length;++lo)Js[lo]=Ko[lo];else Js=[Ko];else{Js=Array(qc);var Yl={radius:ha,format:hs,type:yl};for(lo=0;lo<qc;++lo)Js[lo]=Cr.createCube(Yl)}for(La.color=Array(Js.length),lo=0;lo<Js.length;++lo){var Ul=Js[lo];ot(typeof Ul=="function"&&Ul._reglType==="textureCube","invalid cube map"),ha=ha||Ul.width,ot(Ul.width===ha&&Ul.height===ha,"invalid cube map shape"),La.color[lo]={target:wd,data:Js[lo]}}for(lo=0;lo<6;++lo){for(var rs=0;rs<Js.length;++rs)La.color[rs].target=wd+lo;lo>0&&(La.depth=_i[0].depth,La.stencil=_i[0].stencil,La.depthStencil=_i[0].depthStencil),_i[lo]?_i[lo](La):_i[lo]=Yi(La)}return it(qr,{width:ha,height:ha,color:Js})}function Uo(Ua){var lo,La=Ua|0;if(ot(La>0&&La<=gn.maxCubeMapSize,"invalid radius for cube fbo"),La===qr.width)return qr;var ha=qr.color;for(lo=0;lo<ha.length;++lo)ha[lo].resize(La);for(lo=0;lo<6;++lo)_i[lo].resize(La);return qr.width=qr.height=La,qr}return qr($i),it(qr,{faces:_i,resize:Uo,_reglType:"framebufferCube",destroy:function(){_i.forEach(function(Ua){Ua.destroy()})}})}function fa(){gr.cur=null,gr.next=null,gr.dirty=!0,ca(ri).forEach(function($i){$i.framebuffer=xt.createFramebuffer(),oi($i)})}return it(gr,{getFramebuffer:function($i){if(typeof $i=="function"&&$i._reglType==="framebuffer"){var _i=$i._framebuffer;if(_i instanceof oo)return _i}return null},create:Yi,createCube:ko,clear:function(){ca(ri).forEach(eo)},restore:fa})}var Y=5126,et=34962;function St(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Y,this.offset=0,this.stride=0,this.divisor=0}function Rt(xt,Pe,gn,Cr,Hr){for(var Rr=gn.maxAttributes,gr=new Array(Rr),bi=0;bi<Rr;++bi)gr[bi]=new St;var li=0,Di={},Oi={Record:St,scope:{},state:gr,currentVAO:null,targetVAO:null,restore:Gi()?ri:function(){},createVAO:oo,getVAO:Pi,destroyBuffer:Mi,setVAO:Gi()?ur:Lr,clear:Gi()?gi:function(){}};function Mi(yi){for(var eo=0;eo<gr.length;++eo){var oi=gr[eo];oi.buffer===yi&&(xt.disableVertexAttribArray(eo),oi.buffer=null)}}function Gi(){return Pe.oes_vertex_array_object}function hi(){return Pe.angle_instanced_arrays}function Pi(yi){return typeof yi=="function"&&yi._vao?yi._vao:null}function ur(yi){if(yi!==Oi.currentVAO){var eo=Gi();yi?eo.bindVertexArrayOES(yi.vao):eo.bindVertexArrayOES(null),Oi.currentVAO=yi}}function Lr(yi){if(yi!==Oi.currentVAO){if(yi)yi.bindAttrs();else for(var eo=hi(),oi=0;oi<gr.length;++oi){var Yi=gr[oi];Yi.buffer?(xt.enableVertexAttribArray(oi),xt.vertexAttribPointer(oi,Yi.size,Yi.type,Yi.normalized,Yi.stride,Yi.offfset),eo&&eo.vertexAttribDivisorANGLE(oi,Yi.divisor)):(xt.disableVertexAttribArray(oi),xt.vertexAttrib4f(oi,Yi.x,Yi.y,Yi.z,Yi.w))}Oi.currentVAO=yi}}function gi(){ca(Di).forEach(function(yi){yi.destroy()})}function to(){this.id=++li,this.attributes=[];var yi=Gi();yi?this.vao=yi.createVertexArrayOES():this.vao=null,Di[this.id]=this,this.buffers=[]}to.prototype.bindAttrs=function(){for(var yi=hi(),eo=this.attributes,oi=0;oi<eo.length;++oi){var Yi=eo[oi];Yi.buffer?(xt.enableVertexAttribArray(oi),xt.bindBuffer(et,Yi.buffer.buffer),xt.vertexAttribPointer(oi,Yi.size,Yi.type,Yi.normalized,Yi.stride,Yi.offset),yi&&yi.vertexAttribDivisorANGLE(oi,Yi.divisor)):(xt.disableVertexAttribArray(oi),xt.vertexAttrib4f(oi,Yi.x,Yi.y,Yi.z,Yi.w))}for(var ko=eo.length;ko<Rr;++ko)xt.disableVertexAttribArray(ko)},to.prototype.refresh=function(){var yi=Gi();yi&&(yi.bindVertexArrayOES(this.vao),this.bindAttrs(),Oi.currentVAO=this)},to.prototype.destroy=function(){if(this.vao){var yi=Gi();this===Oi.currentVAO&&(Oi.currentVAO=null,yi.bindVertexArrayOES(null)),yi.deleteVertexArrayOES(this.vao),this.vao=null}Di[this.id]&&(delete Di[this.id],Cr.vaoCount-=1)};function ri(){var yi=Gi();yi&&ca(Di).forEach(function(eo){eo.refresh()})}function oo(yi){var eo=new to;Cr.vaoCount+=1;function oi(Yi){ot(Array.isArray(Yi),"arguments to vertex array constructor must be an array"),ot(Yi.length<Rr,"too many attributes"),ot(Yi.length>0,"must specify at least one attribute");for(var ko=0;ko<eo.buffers.length;++ko)eo.buffers[ko].destroy();eo.buffers.length=0;var fa=eo.attributes;fa.length=Yi.length;for(var $i=0;$i<Yi.length;++$i){var _i=Yi[$i],qr=fa[$i]=new St;if(Array.isArray(_i)||rr(_i)||Ya(_i)){var Uo=Hr.create(_i,et,!1,!0);qr.buffer=Hr.getBuffer(Uo),qr.size=qr.buffer.dimension|0,qr.normalized=!1,qr.type=qr.buffer.dtype,qr.offset=0,qr.stride=0,qr.divisor=0,qr.state=1,eo.buffers.push(Uo)}else Hr.getBuffer(_i)?(qr.buffer=Hr.getBuffer(_i),qr.size=qr.buffer.dimension|0,qr.normalized=!1,qr.type=qr.buffer.dtype,qr.offset=0,qr.stride=0,qr.divisor=0,qr.state=1):Hr.getBuffer(_i.buffer)?(qr.buffer=Hr.getBuffer(_i.buffer),qr.size=(+_i.size||qr.buffer.dimension)|0,qr.normalized=!!_i.normalized||!1,"type"in _i?(ot.parameter(_i.type,Dl,"invalid buffer type"),qr.type=Dl[_i.type]):qr.type=qr.buffer.dtype,qr.offset=(_i.offset||0)|0,qr.stride=(_i.stride||0)|0,qr.divisor=(_i.divisor||0)|0,qr.state=1,ot(qr.size>=1&&qr.size<=4,"size must be between 1 and 4"),ot(qr.offset>=0,"invalid offset"),ot(qr.stride>=0&&qr.stride<=255,"stride must be between 0 and 255"),ot(qr.divisor>=0,"divisor must be positive"),ot(!qr.divisor||!!Pe.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in _i?(ot($i>0,"first attribute must not be a constant"),qr.x=+_i.x||0,qr.y=+_i.y||0,qr.z=+_i.z||0,qr.w=+_i.w||0,qr.state=2):ot(!1,"invalid attribute spec for location "+$i)}return eo.refresh(),oi}return oi.destroy=function(){eo.destroy()},oi._vao=eo,oi._reglType="vao",oi(yi)}return Oi}var ye=35632,be=35633,Oe=35718,on=35721;function Qe(xt,Pe,gn,Cr){var Hr={},Rr={};function gr(ur,Lr,gi,to){this.name=ur,this.id=Lr,this.location=gi,this.info=to}function bi(ur,Lr){for(var gi=0;gi<ur.length;++gi)if(ur[gi].id===Lr.id){ur[gi].location=Lr.location;return}ur.push(Lr)}function li(ur,Lr,gi){var to=ur===ye?Hr:Rr,ri=to[Lr];if(!ri){var oo=Pe.str(Lr);ri=xt.createShader(ur),xt.shaderSource(ri,oo),xt.compileShader(ri),ot.shaderError(xt,ri,oo,ur,gi),to[Lr]=ri}return ri}var Di={},Oi=[],Mi=0;function Gi(ur,Lr){this.id=Mi++,this.fragId=ur,this.vertId=Lr,this.program=null,this.uniforms=[],this.attributes=[],Cr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function hi(ur,Lr,gi){var to,ri,oo=li(ye,ur.fragId),yi=li(be,ur.vertId),eo=ur.program=xt.createProgram();if(xt.attachShader(eo,oo),xt.attachShader(eo,yi),gi)for(to=0;to<gi.length;++to){var oi=gi[to];xt.bindAttribLocation(eo,oi[0],oi[1])}xt.linkProgram(eo),ot.linkError(xt,eo,Pe.str(ur.fragId),Pe.str(ur.vertId),Lr);var Yi=xt.getProgramParameter(eo,Oe);Cr.profile&&(ur.stats.uniformsCount=Yi);var ko=ur.uniforms;for(to=0;to<Yi;++to)if(ri=xt.getActiveUniform(eo,to),ri)if(ri.size>1)for(var fa=0;fa<ri.size;++fa){var $i=ri.name.replace("[0]","["+fa+"]");bi(ko,new gr($i,Pe.id($i),xt.getUniformLocation(eo,$i),ri))}else bi(ko,new gr(ri.name,Pe.id(ri.name),xt.getUniformLocation(eo,ri.name),ri));var _i=xt.getProgramParameter(eo,on);Cr.profile&&(ur.stats.attributesCount=_i);var qr=ur.attributes;for(to=0;to<_i;++to)ri=xt.getActiveAttrib(eo,to),ri&&bi(qr,new gr(ri.name,Pe.id(ri.name),xt.getAttribLocation(eo,ri.name),ri))}Cr.profile&&(gn.getMaxUniformsCount=function(){var ur=0;return Oi.forEach(function(Lr){Lr.stats.uniformsCount>ur&&(ur=Lr.stats.uniformsCount)}),ur},gn.getMaxAttributesCount=function(){var ur=0;return Oi.forEach(function(Lr){Lr.stats.attributesCount>ur&&(ur=Lr.stats.attributesCount)}),ur});function Pi(){Hr={},Rr={};for(var ur=0;ur<Oi.length;++ur)hi(Oi[ur],null,Oi[ur].attributes.map(function(Lr){return[Lr.location,Lr.name]}))}return{clear:function(){var ur=xt.deleteShader.bind(xt);ca(Hr).forEach(ur),Hr={},ca(Rr).forEach(ur),Rr={},Oi.forEach(function(Lr){xt.deleteProgram(Lr.program)}),Oi.length=0,Di={},gn.shaderCount=0},program:function(ur,Lr,gi,to){ot.command(ur>=0,"missing vertex shader",gi),ot.command(Lr>=0,"missing fragment shader",gi);var ri=Di[Lr];ri||(ri=Di[Lr]={});var oo=ri[ur];if(oo&&!to)return oo;var yi=new Gi(Lr,ur);return gn.shaderCount++,hi(yi,gi,to),oo||(ri[ur]=yi),Oi.push(yi),yi},restore:Pi,shader:li,frag:-1,vert:-1}}var vn=6408,Ye=5121,On=3333,jn=5126;function ar(xt,Pe,gn,Cr,Hr,Rr,gr){function bi(Oi){var Mi;Pe.next===null?(ot(Hr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Mi=Ye):(ot(Pe.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Mi=Pe.next.colorAttachments[0].texture._texture.type,Rr.oes_texture_float?(ot(Mi===Ye||Mi===jn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Mi===jn&&ot(gr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ot(Mi===Ye,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Gi=0,hi=0,Pi=Cr.framebufferWidth,ur=Cr.framebufferHeight,Lr=null;rr(Oi)?Lr=Oi:Oi&&(ot.type(Oi,"object","invalid arguments to regl.read()"),Gi=Oi.x|0,hi=Oi.y|0,ot(Gi>=0&&Gi<Cr.framebufferWidth,"invalid x offset for regl.read"),ot(hi>=0&&hi<Cr.framebufferHeight,"invalid y offset for regl.read"),Pi=(Oi.width||Cr.framebufferWidth-Gi)|0,ur=(Oi.height||Cr.framebufferHeight-hi)|0,Lr=Oi.data||null),Lr&&(Mi===Ye?ot(Lr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Mi===jn&&ot(Lr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ot(Pi>0&&Pi+Gi<=Cr.framebufferWidth,"invalid width for read pixels"),ot(ur>0&&ur+hi<=Cr.framebufferHeight,"invalid height for read pixels"),gn();var gi=Pi*ur*4;return Lr||(Mi===Ye?Lr=new Uint8Array(gi):Mi===jn&&(Lr=Lr||new Float32Array(gi))),ot.isTypedArray(Lr,"data buffer for regl.read() must be a typedarray"),ot(Lr.byteLength>=gi,"data buffer for regl.read() too small"),xt.pixelStorei(On,4),xt.readPixels(Gi,hi,Pi,ur,vn,Mi,Lr),Lr}function li(Oi){var Mi;return Pe.setFBO({framebuffer:Oi.framebuffer},function(){Mi=bi(Oi)}),Mi}function Di(Oi){return!Oi||!("framebuffer"in Oi)?bi(Oi):li(Oi)}return Di}function Or(xt){return Array.prototype.slice.call(xt)}function cr(xt){return Or(xt).join("")}function kr(){var xt=0,Pe=[],gn=[];function Cr(Mi){for(var Gi=0;Gi<gn.length;++Gi)if(gn[Gi]===Mi)return Pe[Gi];var hi="g"+xt++;return Pe.push(hi),gn.push(Mi),hi}function Hr(){var Mi=[];function Gi(){Mi.push.apply(Mi,Or(arguments))}var hi=[];function Pi(){var ur="v"+xt++;return hi.push(ur),arguments.length>0&&(Mi.push(ur,"="),Mi.push.apply(Mi,Or(arguments)),Mi.push(";")),ur}return it(Gi,{def:Pi,toString:function(){return cr([hi.length>0?"var "+hi.join(",")+";":"",cr(Mi)])}})}function Rr(){var Mi=Hr(),Gi=Hr(),hi=Mi.toString,Pi=Gi.toString;function ur(Lr,gi){Gi(Lr,gi,"=",Mi.def(Lr,gi),";")}return it(function(){Mi.apply(Mi,Or(arguments))},{def:Mi.def,entry:Mi,exit:Gi,save:ur,set:function(Lr,gi,to){ur(Lr,gi),Mi(Lr,gi,"=",to,";")},toString:function(){return hi()+Pi()}})}function gr(){var Mi=cr(arguments),Gi=Rr(),hi=Rr(),Pi=Gi.toString,ur=hi.toString;return it(Gi,{then:function(){return Gi.apply(Gi,Or(arguments)),this},else:function(){return hi.apply(hi,Or(arguments)),this},toString:function(){var Lr=ur();return Lr&&(Lr="else{"+Lr+"}"),cr(["if(",Mi,"){",Pi(),"}",Lr])}})}var bi=Hr(),li={};function Di(Mi,Gi){var hi=[];function Pi(){var ri="a"+hi.length;return hi.push(ri),ri}Gi=Gi||0;for(var ur=0;ur<Gi;++ur)Pi();var Lr=Rr(),gi=Lr.toString,to=li[Mi]=it(Lr,{arg:Pi,toString:function(){return cr(["function(",hi.join(),"){",gi(),"}"])}});return to}function Oi(){var Mi=['"use strict";',bi,"return {"];Object.keys(li).forEach(function(Pi){Mi.push('"',Pi,'":',li[Pi].toString(),",")}),Mi.push("}");var Gi=cr(Mi).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),hi=Function.apply(null,Pe.concat(Gi));return hi.apply(null,gn)}return{global:bi,link:Cr,block:Hr,proc:Di,scope:Rr,cond:gr,compile:Oi}}var ei="xyzw".split(""),Yr=5121,Ti=1,zi=2,Io=0,Bo=1,Fo=2,ua=3,Tn=4,Me="dither",la="blend.enable",ta="blend.color",Vo="blend.equation",ga="blend.func",jo="depth.enable",Do="depth.func",hc="depth.range",ml="depth.mask",Bc="colorMask",Wl="cull.enable",vs="cull.face",Ks="frontFace",sl="lineWidth",vl="polygonOffset.enable",_f="polygonOffset.offset",ol="sample.alpha",sf="sample.enable",Vu="sample.coverage",Vd="stencil.enable",Ff="stencil.mask",Sh="stencil.func",Zd="stencil.opFront",qh="stencil.opBack",xf="scissor.enable",wi="scissor.box",fl="viewport",ya="profile",gs="framebuffer",Bl="vert",Zu="frag",No="elements",Fl="primitive",Xl="count",bf="offset",Hd="instances",lf="vao",Ep="Width",Ad="Height",Is=gs+Ep,cf=gs+Ad,lh=fl+Ep,D0=fl+Ad,io="drawingBuffer",gu=io+Ep,ty=io+Ad,lm=[ga,Vo,Sh,Zd,qh,Vu,fl,wi,_f],Sp=34962,ey=34963,Wv=35632,ny=35633,cm=3553,um=34067,N0=2884,ry=3042,Tp=3024,wp=2960,tv=2929,ev=3089,iy=32823,Gd=32926,e0=32928,$h=5126,nv=35664,Kh=35665,k0=35666,Yc=5124,Ap=35667,Qs=35668,Ef=35669,B0=35670,Wd=35671,Op=35672,dc=35673,Xd=35674,Qh=35675,gl=35676,Cp=35678,n0=35680,fm=4,Th=1028,su=1029,yu=2304,r0=2305,i0=32775,Rp=32776,Sf=519,Od=7680,oy=0,ay=1,rv=32774,F0=513,Jh=36160,hm=36064,Uf={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},o0=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Yd={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},qd={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},iv={frag:Wv,vert:ny},wh={cw:yu,ccw:r0};function a0(xt){return Array.isArray(xt)||rr(xt)||Ya(xt)}function Mp(xt){return xt.sort(function(Pe,gn){return Pe===fl?-1:gn===fl?1:Pe<gn?-1:1})}function _u(xt,Pe,gn,Cr){this.thisDep=xt,this.contextDep=Pe,this.propDep=gn,this.append=Cr}function lu(xt){return xt&&!(xt.thisDep||xt.contextDep||xt.propDep)}function pc(xt){return new _u(!1,!1,!1,xt)}function Hu(xt,Pe){var gn=xt.type;if(gn===Io){var Cr=xt.data.length;return new _u(!0,Cr>=1,Cr>=2,Pe)}else if(gn===Tn){var Hr=xt.data;return new _u(Hr.thisDep,Hr.contextDep,Hr.propDep,Pe)}else return new _u(gn===ua,gn===Fo,gn===Bo,Pe)}var xu=new _u(!1,!1,!1,function(){});function Pp(xt,Pe,gn,Cr,Hr,Rr,gr,bi,li,Di,Oi,Mi,Gi,hi,Pi){var ur=Di.Record,Lr={add:32774,subtract:32778,"reverse subtract":32779};gn.ext_blend_minmax&&(Lr.min=i0,Lr.max=Rp);var gi=gn.angle_instanced_arrays,to=gn.webgl_draw_buffers,ri={dirty:!0,profile:Pi.profile},oo={},yi=[],eo={},oi={};function Yi(he){return he.replace(".","_")}function ko(he,je,_n){var wr=Yi(he);yi.push(he),oo[wr]=ri[wr]=!!_n,eo[wr]=je}function fa(he,je,_n){var wr=Yi(he);yi.push(he),Array.isArray(_n)?(ri[wr]=_n.slice(),oo[wr]=_n.slice()):ri[wr]=oo[wr]=_n,oi[wr]=je}ko(Me,Tp),ko(la,ry),fa(ta,"blendColor",[0,0,0,0]),fa(Vo,"blendEquationSeparate",[rv,rv]),fa(ga,"blendFuncSeparate",[ay,oy,ay,oy]),ko(jo,tv,!0),fa(Do,"depthFunc",F0),fa(hc,"depthRange",[0,1]),fa(ml,"depthMask",!0),fa(Bc,Bc,[!0,!0,!0,!0]),ko(Wl,N0),fa(vs,"cullFace",su),fa(Ks,Ks,r0),fa(sl,sl,1),ko(vl,iy),fa(_f,"polygonOffset",[0,0]),ko(ol,Gd),ko(sf,e0),fa(Vu,"sampleCoverage",[1,!1]),ko(Vd,wp),fa(Ff,"stencilMask",-1),fa(Sh,"stencilFunc",[Sf,0,-1]),fa(Zd,"stencilOpSeparate",[Th,Od,Od,Od]),fa(qh,"stencilOpSeparate",[su,Od,Od,Od]),ko(xf,ev),fa(wi,"scissor",[0,0,xt.drawingBufferWidth,xt.drawingBufferHeight]),fa(fl,fl,[0,0,xt.drawingBufferWidth,xt.drawingBufferHeight]);var $i={gl:xt,context:Gi,strings:Pe,next:oo,current:ri,draw:Mi,elements:Rr,buffer:Hr,shader:Oi,attributes:Di.state,vao:Di,uniforms:li,framebuffer:bi,extensions:gn,timer:hi,isBufferArgs:a0},_i={primTypes:Mu,compareFuncs:Yd,blendFuncs:Uf,blendEquations:Lr,stencilOps:qd,glTypes:Dl,orientationType:wh};ot.optional(function(){$i.isArrayLike=il}),to&&(_i.backBuffer=[su],_i.drawBuffer=Gn(Cr.maxDrawbuffers,function(he){return he===0?[0]:Gn(he,function(je){return hm+je})}));var qr=0;function Uo(){var he=kr(),je=he.link,_n=he.global;he.id=qr++,he.batchId="0";var wr=je($i),yr=he.shared={props:"a0"};Object.keys($i).forEach(function(Nn){yr[Nn]=_n.def(wr,".",Nn)}),ot.optional(function(){he.CHECK=je(ot),he.commandStr=ot.guessCommand(),he.command=je(he.commandStr),he.assert=function(Nn,Re,Bn){Nn("if(!(",Re,"))",this.CHECK,".commandRaise(",je(Bn),",",this.command,");")},_i.invalidBlendCombinations=o0});var In=he.next={},Fn=he.current={};Object.keys(oi).forEach(function(Nn){Array.isArray(ri[Nn])&&(In[Nn]=_n.def(yr.next,".",Nn),Fn[Nn]=_n.def(yr.current,".",Nn))});var Yn=he.constants={};Object.keys(_i).forEach(function(Nn){Yn[Nn]=_n.def(JSON.stringify(_i[Nn]))}),he.invoke=function(Nn,Re){switch(Re.type){case Io:var Bn=["this",yr.context,yr.props,he.batchId];return Nn.def(je(Re.data),".call(",Bn.slice(0,Math.max(Re.data.length+1,4)),")");case Bo:return Nn.def(yr.props,Re.data);case Fo:return Nn.def(yr.context,Re.data);case ua:return Nn.def("this",Re.data);case Tn:return Re.data.append(he,Nn),Re.data.ref}},he.attribCache={};var an={};return he.scopeAttrib=function(Nn){var Re=Pe.id(Nn);if(Re in an)return an[Re];var Bn=Di.scope[Re];Bn||(Bn=Di.scope[Re]=new ur);var Dr=an[Re]=je(Bn);return Dr},he}function Ua(he){var je=he.static,_n=he.dynamic,wr;if(ya in je){var yr=!!je[ya];wr=pc(function(Fn,Yn){return yr}),wr.enable=yr}else if(ya in _n){var In=_n[ya];wr=Hu(In,function(Fn,Yn){return Fn.invoke(Yn,In)})}return wr}function lo(he,je){var _n=he.static,wr=he.dynamic;if(gs in _n){var yr=_n[gs];return yr?(yr=bi.getFramebuffer(yr),ot.command(yr,"invalid framebuffer object"),pc(function(Fn,Yn){var an=Fn.link(yr),Nn=Fn.shared;Yn.set(Nn.framebuffer,".next",an);var Re=Nn.context;return Yn.set(Re,"."+Is,an+".width"),Yn.set(Re,"."+cf,an+".height"),an})):pc(function(Fn,Yn){var an=Fn.shared;Yn.set(an.framebuffer,".next","null");var Nn=an.context;return Yn.set(Nn,"."+Is,Nn+"."+gu),Yn.set(Nn,"."+cf,Nn+"."+ty),"null"})}else if(gs in wr){var In=wr[gs];return Hu(In,function(Fn,Yn){var an=Fn.invoke(Yn,In),Nn=Fn.shared,Re=Nn.framebuffer,Bn=Yn.def(Re,".getFramebuffer(",an,")");ot.optional(function(){Fn.assert(Yn,"!"+an+"||"+Bn,"invalid framebuffer object")}),Yn.set(Re,".next",Bn);var Dr=Nn.context;return Yn.set(Dr,"."+Is,Bn+"?"+Bn+".width:"+Dr+"."+gu),Yn.set(Dr,"."+cf,Bn+"?"+Bn+".height:"+Dr+"."+ty),Bn})}else return null}function La(he,je,_n){var wr=he.static,yr=he.dynamic;function In(an){if(an in wr){var Nn=wr[an];ot.commandType(Nn,"object","invalid "+an,_n.commandStr);var Re=!0,Bn=Nn.x|0,Dr=Nn.y|0,Fr,di;return"width"in Nn?(Fr=Nn.width|0,ot.command(Fr>=0,"invalid "+an,_n.commandStr)):Re=!1,"height"in Nn?(di=Nn.height|0,ot.command(di>=0,"invalid "+an,_n.commandStr)):Re=!1,new _u(!Re&&je&&je.thisDep,!Re&&je&&je.contextDep,!Re&&je&&je.propDep,function(Oo,Bi){var yo=Oo.shared.context,Yo=Fr;"width"in Nn||(Yo=Bi.def(yo,".",Is,"-",Bn));var ea=di;return"height"in Nn||(ea=Bi.def(yo,".",cf,"-",Dr)),[Bn,Dr,Yo,ea]})}else if(an in yr){var $r=yr[an],fi=Hu($r,function(Oo,Bi){var yo=Oo.invoke(Bi,$r);ot.optional(function(){Oo.assert(Bi,yo+"&&typeof "+yo+'==="object"',"invalid "+an)});var Yo=Oo.shared.context,ea=Bi.def(yo,".x|0"),Ss=Bi.def(yo,".y|0"),Sc=Bi.def('"width" in ',yo,"?",yo,".width|0:","(",Yo,".",Is,"-",ea,")"),bu=Bi.def('"height" in ',yo,"?",yo,".height|0:","(",Yo,".",cf,"-",Ss,")");return ot.optional(function(){Oo.assert(Bi,Sc+">=0&&"+bu+">=0","invalid "+an)}),[ea,Ss,Sc,bu]});return je&&(fi.thisDep=fi.thisDep||je.thisDep,fi.contextDep=fi.contextDep||je.contextDep,fi.propDep=fi.propDep||je.propDep),fi}else return je?new _u(je.thisDep,je.contextDep,je.propDep,function(Oo,Bi){var yo=Oo.shared.context;return[0,0,Bi.def(yo,".",Is),Bi.def(yo,".",cf)]}):null}var Fn=In(fl);if(Fn){var Yn=Fn;Fn=new _u(Fn.thisDep,Fn.contextDep,Fn.propDep,function(an,Nn){var Re=Yn.append(an,Nn),Bn=an.shared.context;return Nn.set(Bn,"."+lh,Re[2]),Nn.set(Bn,"."+D0,Re[3]),Re})}return{viewport:Fn,scissor_box:In(wi)}}function ha(he,je){var _n=he.static,wr=typeof _n[Zu]=="string"&&typeof _n[Bl]=="string";if(wr){if(Object.keys(je.dynamic).length>0)return null;var yr=je.static,In=Object.keys(yr);if(In.length>0&&typeof yr[In[0]]=="number"){for(var Fn=[],Yn=0;Yn<In.length;++Yn)ot(typeof yr[In[Yn]]=="number","must specify all vertex attribute locations when using vaos"),Fn.push([yr[In[Yn]]|0,In[Yn]]);return Fn}}return null}function Ko(he,je,_n){var wr=he.static,yr=he.dynamic;function In(Re){if(Re in wr){var Bn=Pe.id(wr[Re]);ot.optional(function(){Oi.shader(iv[Re],Bn,ot.guessCommand())});var Dr=pc(function(){return Bn});return Dr.id=Bn,Dr}else if(Re in yr){var Fr=yr[Re];return Hu(Fr,function(di,$r){var fi=di.invoke($r,Fr),Oo=$r.def(di.shared.strings,".id(",fi,")");return ot.optional(function(){$r(di.shared.shader,".shader(",iv[Re],",",Oo,",",di.command,");")}),Oo})}return null}var Fn=In(Zu),Yn=In(Bl),an=null,Nn;return lu(Fn)&&lu(Yn)?(an=Oi.program(Yn.id,Fn.id,null,_n),Nn=pc(function(Re,Bn){return Re.link(an)})):Nn=new _u(Fn&&Fn.thisDep||Yn&&Yn.thisDep,Fn&&Fn.contextDep||Yn&&Yn.contextDep,Fn&&Fn.propDep||Yn&&Yn.propDep,function(Re,Bn){var Dr=Re.shared.shader,Fr;Fn?Fr=Fn.append(Re,Bn):Fr=Bn.def(Dr,".",Zu);var di;Yn?di=Yn.append(Re,Bn):di=Bn.def(Dr,".",Bl);var $r=Dr+".program("+di+","+Fr;return ot.optional(function(){$r+=","+Re.command}),Bn.def($r+")")}),{frag:Fn,vert:Yn,progVar:Nn,program:an}}function hs(he,je){var _n=he.static,wr=he.dynamic;function yr(){if(No in _n){var Re=_n[No];a0(Re)?Re=Rr.getElements(Rr.create(Re,!0)):Re&&(Re=Rr.getElements(Re),ot.command(Re,"invalid elements",je.commandStr));var Bn=pc(function(Fr,di){if(Re){var $r=Fr.link(Re);return Fr.ELEMENTS=$r,$r}return Fr.ELEMENTS=null,null});return Bn.value=Re,Bn}else if(No in wr){var Dr=wr[No];return Hu(Dr,function(Fr,di){var $r=Fr.shared,fi=$r.isBufferArgs,Oo=$r.elements,Bi=Fr.invoke(di,Dr),yo=di.def("null"),Yo=di.def(fi,"(",Bi,")"),ea=Fr.cond(Yo).then(yo,"=",Oo,".createStream(",Bi,");").else(yo,"=",Oo,".getElements(",Bi,");");return ot.optional(function(){Fr.assert(ea.else,"!"+Bi+"||"+yo,"invalid elements")}),di.entry(ea),di.exit(Fr.cond(Yo).then(Oo,".destroyStream(",yo,");")),Fr.ELEMENTS=yo,yo})}return null}var In=yr();function Fn(){if(Fl in _n){var Re=_n[Fl];return ot.commandParameter(Re,Mu,"invalid primitve",je.commandStr),pc(function(Dr,Fr){return Mu[Re]})}else if(Fl in wr){var Bn=wr[Fl];return Hu(Bn,function(Dr,Fr){var di=Dr.constants.primTypes,$r=Dr.invoke(Fr,Bn);return ot.optional(function(){Dr.assert(Fr,$r+" in "+di,"invalid primitive, must be one of "+Object.keys(Mu))}),Fr.def(di,"[",$r,"]")})}else if(In)return lu(In)?In.value?pc(function(Dr,Fr){return Fr.def(Dr.ELEMENTS,".primType")}):pc(function(){return fm}):new _u(In.thisDep,In.contextDep,In.propDep,function(Dr,Fr){var di=Dr.ELEMENTS;return Fr.def(di,"?",di,".primType:",fm)});return null}function Yn(Re,Bn){if(Re in _n){var Dr=_n[Re]|0;return ot.command(!Bn||Dr>=0,"invalid "+Re,je.commandStr),pc(function(di,$r){return Bn&&(di.OFFSET=Dr),Dr})}else if(Re in wr){var Fr=wr[Re];return Hu(Fr,function(di,$r){var fi=di.invoke($r,Fr);return Bn&&(di.OFFSET=fi,ot.optional(function(){di.assert($r,fi+">=0","invalid "+Re)})),fi})}else if(Bn&&In)return pc(function(di,$r){return di.OFFSET="0",0});return null}var an=Yn(bf,!0);function Nn(){if(Xl in _n){var Re=_n[Xl]|0;return ot.command(typeof Re=="number"&&Re>=0,"invalid vertex count",je.commandStr),pc(function(){return Re})}else if(Xl in wr){var Bn=wr[Xl];return Hu(Bn,function(di,$r){var fi=di.invoke($r,Bn);return ot.optional(function(){di.assert($r,"typeof "+fi+'==="number"&&'+fi+">=0&&"+fi+"===("+fi+"|0)","invalid vertex count")}),fi})}else if(In)if(lu(In)){if(In)return an?new _u(an.thisDep,an.contextDep,an.propDep,function(di,$r){var fi=$r.def(di.ELEMENTS,".vertCount-",di.OFFSET);return ot.optional(function(){di.assert($r,fi+">=0","invalid vertex offset/element buffer too small")}),fi}):pc(function(di,$r){return $r.def(di.ELEMENTS,".vertCount")});var Dr=pc(function(){return-1});return ot.optional(function(){Dr.MISSING=!0}),Dr}else{var Fr=new _u(In.thisDep||an.thisDep,In.contextDep||an.contextDep,In.propDep||an.propDep,function(di,$r){var fi=di.ELEMENTS;return di.OFFSET?$r.def(fi,"?",fi,".vertCount-",di.OFFSET,":-1"):$r.def(fi,"?",fi,".vertCount:-1")});return ot.optional(function(){Fr.DYNAMIC=!0}),Fr}return null}return{elements:In,primitive:Fn(),count:Nn(),instances:Yn(Hd,!1),offset:an}}function yl(he,je){var _n=he.static,wr=he.dynamic,yr={};return yi.forEach(function(In){var Fn=Yi(In);function Yn(an,Nn){if(In in _n){var Re=an(_n[In]);yr[Fn]=pc(function(){return Re})}else if(In in wr){var Bn=wr[In];yr[Fn]=Hu(Bn,function(Dr,Fr){return Nn(Dr,Fr,Dr.invoke(Fr,Bn))})}}switch(In){case Wl:case la:case Me:case Vd:case jo:case xf:case vl:case ol:case sf:case ml:return Yn(function(an){return ot.commandType(an,"boolean",In,je.commandStr),an},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,"typeof "+Re+'==="boolean"',"invalid flag "+In,an.commandStr)}),Re});case Do:return Yn(function(an){return ot.commandParameter(an,Yd,"invalid "+In,je.commandStr),Yd[an]},function(an,Nn,Re){var Bn=an.constants.compareFuncs;return ot.optional(function(){an.assert(Nn,Re+" in "+Bn,"invalid "+In+", must be one of "+Object.keys(Yd))}),Nn.def(Bn,"[",Re,"]")});case hc:return Yn(function(an){return ot.command(il(an)&&an.length===2&&typeof an[0]=="number"&&typeof an[1]=="number"&&an[0]<=an[1],"depth range is 2d array",je.commandStr),an},function(an,Nn,Re){ot.optional(function(){an.assert(Nn,an.shared.isArrayLike+"("+Re+")&&"+Re+".length===2&&typeof "+Re+'[0]==="number"&&typeof '+Re+'[1]==="number"&&'+Re+"[0]<="+Re+"[1]","depth range must be a 2d array")});var Bn=Nn.def("+",Re,"[0]"),Dr=Nn.def("+",Re,"[1]");return[Bn,Dr]});case ga:return Yn(function(an){ot.commandType(an,"object","blend.func",je.commandStr);var Nn="srcRGB"in an?an.srcRGB:an.src,Re="srcAlpha"in an?an.srcAlpha:an.src,Bn="dstRGB"in an?an.dstRGB:an.dst,Dr="dstAlpha"in an?an.dstAlpha:an.dst;return ot.commandParameter(Nn,Uf,Fn+".srcRGB",je.commandStr),ot.commandParameter(Re,Uf,Fn+".srcAlpha",je.commandStr),ot.commandParameter(Bn,Uf,Fn+".dstRGB",je.commandStr),ot.commandParameter(Dr,Uf,Fn+".dstAlpha",je.commandStr),ot.command(o0.indexOf(Nn+", "+Bn)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Nn+", "+Bn+")",je.commandStr),[Uf[Nn],Uf[Bn],Uf[Re],Uf[Dr]]},function(an,Nn,Re){var Bn=an.constants.blendFuncs;ot.optional(function(){an.assert(Nn,Re+"&&typeof "+Re+'==="object"',"invalid blend func, must be an object")});function Dr(yo,Yo){var ea=Nn.def('"',yo,Yo,'" in ',Re,"?",Re,".",yo,Yo,":",Re,".",yo);return ot.optional(function(){an.assert(Nn,ea+" in "+Bn,"invalid "+In+"."+yo+Yo+", must be one of "+Object.keys(Uf))}),ea}var Fr=Dr("src","RGB"),di=Dr("dst","RGB");ot.optional(function(){var yo=an.constants.invalidBlendCombinations;an.assert(Nn,yo+".indexOf("+Fr+'+", "+'+di+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var $r=Nn.def(Bn,"[",Fr,"]"),fi=Nn.def(Bn,"[",Dr("src","Alpha"),"]"),Oo=Nn.def(Bn,"[",di,"]"),Bi=Nn.def(Bn,"[",Dr("dst","Alpha"),"]");return[$r,Oo,fi,Bi]});case Vo:return Yn(function(an){if(typeof an=="string")return ot.commandParameter(an,Lr,"invalid "+In,je.commandStr),[Lr[an],Lr[an]];if(typeof an=="object")return ot.commandParameter(an.rgb,Lr,In+".rgb",je.commandStr),ot.commandParameter(an.alpha,Lr,In+".alpha",je.commandStr),[Lr[an.rgb],Lr[an.alpha]];ot.commandRaise("invalid blend.equation",je.commandStr)},function(an,Nn,Re){var Bn=an.constants.blendEquations,Dr=Nn.def(),Fr=Nn.def(),di=an.cond("typeof ",Re,'==="string"');return ot.optional(function(){function $r(fi,Oo,Bi){an.assert(fi,Bi+" in "+Bn,"invalid "+Oo+", must be one of "+Object.keys(Lr))}$r(di.then,In,Re),an.assert(di.else,Re+"&&typeof "+Re+'==="object"',"invalid "+In),$r(di.else,In+".rgb",Re+".rgb"),$r(di.else,In+".alpha",Re+".alpha")}),di.then(Dr,"=",Fr,"=",Bn,"[",Re,"];"),di.else(Dr,"=",Bn,"[",Re,".rgb];",Fr,"=",Bn,"[",Re,".alpha];"),Nn(di),[Dr,Fr]});case ta:return Yn(function(an){return ot.command(il(an)&&an.length===4,"blend.color must be a 4d array",je.commandStr),Gn(4,function(Nn){return+an[Nn]})},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,an.shared.isArrayLike+"("+Re+")&&"+Re+".length===4","blend.color must be a 4d array")}),Gn(4,function(Bn){return Nn.def("+",Re,"[",Bn,"]")})});case Ff:return Yn(function(an){return ot.commandType(an,"number",Fn,je.commandStr),an|0},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,"typeof "+Re+'==="number"',"invalid stencil.mask")}),Nn.def(Re,"|0")});case Sh:return Yn(function(an){ot.commandType(an,"object",Fn,je.commandStr);var Nn=an.cmp||"keep",Re=an.ref||0,Bn="mask"in an?an.mask:-1;return ot.commandParameter(Nn,Yd,In+".cmp",je.commandStr),ot.commandType(Re,"number",In+".ref",je.commandStr),ot.commandType(Bn,"number",In+".mask",je.commandStr),[Yd[Nn],Re,Bn]},function(an,Nn,Re){var Bn=an.constants.compareFuncs;ot.optional(function(){function $r(){an.assert(Nn,Array.prototype.join.call(arguments,""),"invalid stencil.func")}$r(Re+"&&typeof ",Re,'==="object"'),$r('!("cmp" in ',Re,")||(",Re,".cmp in ",Bn,")")});var Dr=Nn.def('"cmp" in ',Re,"?",Bn,"[",Re,".cmp]",":",Od),Fr=Nn.def(Re,".ref|0"),di=Nn.def('"mask" in ',Re,"?",Re,".mask|0:-1");return[Dr,Fr,di]});case Zd:case qh:return Yn(function(an){ot.commandType(an,"object",Fn,je.commandStr);var Nn=an.fail||"keep",Re=an.zfail||"keep",Bn=an.zpass||"keep";return ot.commandParameter(Nn,qd,In+".fail",je.commandStr),ot.commandParameter(Re,qd,In+".zfail",je.commandStr),ot.commandParameter(Bn,qd,In+".zpass",je.commandStr),[In===qh?su:Th,qd[Nn],qd[Re],qd[Bn]]},function(an,Nn,Re){var Bn=an.constants.stencilOps;ot.optional(function(){an.assert(Nn,Re+"&&typeof "+Re+'==="object"',"invalid "+In)});function Dr(Fr){return ot.optional(function(){an.assert(Nn,'!("'+Fr+'" in '+Re+")||("+Re+"."+Fr+" in "+Bn+")","invalid "+In+"."+Fr+", must be one of "+Object.keys(qd))}),Nn.def('"',Fr,'" in ',Re,"?",Bn,"[",Re,".",Fr,"]:",Od)}return[In===qh?su:Th,Dr("fail"),Dr("zfail"),Dr("zpass")]});case _f:return Yn(function(an){ot.commandType(an,"object",Fn,je.commandStr);var Nn=an.factor|0,Re=an.units|0;return ot.commandType(Nn,"number",Fn+".factor",je.commandStr),ot.commandType(Re,"number",Fn+".units",je.commandStr),[Nn,Re]},function(an,Nn,Re){ot.optional(function(){an.assert(Nn,Re+"&&typeof "+Re+'==="object"',"invalid "+In)});var Bn=Nn.def(Re,".factor|0"),Dr=Nn.def(Re,".units|0");return[Bn,Dr]});case vs:return Yn(function(an){var Nn=0;return an==="front"?Nn=Th:an==="back"&&(Nn=su),ot.command(!!Nn,Fn,je.commandStr),Nn},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,Re+'==="front"||'+Re+'==="back"',"invalid cull.face")}),Nn.def(Re,'==="front"?',Th,":",su)});case sl:return Yn(function(an){return ot.command(typeof an=="number"&&an>=Cr.lineWidthDims[0]&&an<=Cr.lineWidthDims[1],"invalid line width, must be a positive number between "+Cr.lineWidthDims[0]+" and "+Cr.lineWidthDims[1],je.commandStr),an},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,"typeof "+Re+'==="number"&&'+Re+">="+Cr.lineWidthDims[0]+"&&"+Re+"<="+Cr.lineWidthDims[1],"invalid line width")}),Re});case Ks:return Yn(function(an){return ot.commandParameter(an,wh,Fn,je.commandStr),wh[an]},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,Re+'==="cw"||'+Re+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Nn.def(Re+'==="cw"?'+yu+":"+r0)});case Bc:return Yn(function(an){return ot.command(il(an)&&an.length===4,"color.mask must be length 4 array",je.commandStr),an.map(function(Nn){return!!Nn})},function(an,Nn,Re){return ot.optional(function(){an.assert(Nn,an.shared.isArrayLike+"("+Re+")&&"+Re+".length===4","invalid color.mask")}),Gn(4,function(Bn){return"!!"+Re+"["+Bn+"]"})});case Vu:return Yn(function(an){ot.command(typeof an=="object"&&an,Fn,je.commandStr);var Nn="value"in an?an.value:1,Re=!!an.invert;return ot.command(typeof Nn=="number"&&Nn>=0&&Nn<=1,"sample.coverage.value must be a number between 0 and 1",je.commandStr),[Nn,Re]},function(an,Nn,Re){ot.optional(function(){an.assert(Nn,Re+"&&typeof "+Re+'==="object"',"invalid sample.coverage")});var Bn=Nn.def('"value" in ',Re,"?+",Re,".value:1"),Dr=Nn.def("!!",Re,".invert");return[Bn,Dr]})}}),yr}function qc(he,je){var _n=he.static,wr=he.dynamic,yr={};return Object.keys(_n).forEach(function(In){var Fn=_n[In],Yn;if(typeof Fn=="number"||typeof Fn=="boolean")Yn=pc(function(){return Fn});else if(typeof Fn=="function"){var an=Fn._reglType;an==="texture2d"||an==="textureCube"?Yn=pc(function(Nn){return Nn.link(Fn)}):an==="framebuffer"||an==="framebufferCube"?(ot.command(Fn.color.length>0,'missing color attachment for framebuffer sent to uniform "'+In+'"',je.commandStr),Yn=pc(function(Nn){return Nn.link(Fn.color[0])})):ot.commandRaise('invalid data for uniform "'+In+'"',je.commandStr)}else il(Fn)?Yn=pc(function(Nn){var Re=Nn.global.def("[",Gn(Fn.length,function(Bn){return ot.command(typeof Fn[Bn]=="number"||typeof Fn[Bn]=="boolean","invalid uniform "+In,Nn.commandStr),Fn[Bn]}),"]");return Re}):ot.commandRaise('invalid or missing data for uniform "'+In+'"',je.commandStr);Yn.value=Fn,yr[In]=Yn}),Object.keys(wr).forEach(function(In){var Fn=wr[In];yr[In]=Hu(Fn,function(Yn,an){return Yn.invoke(an,Fn)})}),yr}function Va(he,je){var _n=he.static,wr=he.dynamic,yr={};return Object.keys(_n).forEach(function(In){var Fn=_n[In],Yn=Pe.id(In),an=new ur;if(a0(Fn))an.state=Ti,an.buffer=Hr.getBuffer(Hr.create(Fn,Sp,!1,!0)),an.type=0;else{var Nn=Hr.getBuffer(Fn);if(Nn)an.state=Ti,an.buffer=Nn,an.type=0;else if(ot.command(typeof Fn=="object"&&Fn,"invalid data for attribute "+In,je.commandStr),"constant"in Fn){var Re=Fn.constant;an.buffer="null",an.state=zi,typeof Re=="number"?an.x=Re:(ot.command(il(Re)&&Re.length>0&&Re.length<=4,"invalid constant for attribute "+In,je.commandStr),ei.forEach(function(Oo,Bi){Bi<Re.length&&(an[Oo]=Re[Bi])}))}else{a0(Fn.buffer)?Nn=Hr.getBuffer(Hr.create(Fn.buffer,Sp,!1,!0)):Nn=Hr.getBuffer(Fn.buffer),ot.command(!!Nn,'missing buffer for attribute "'+In+'"',je.commandStr);var Bn=Fn.offset|0;ot.command(Bn>=0,'invalid offset for attribute "'+In+'"',je.commandStr);var Dr=Fn.stride|0;ot.command(Dr>=0&&Dr<256,'invalid stride for attribute "'+In+'", must be integer betweeen [0, 255]',je.commandStr);var Fr=Fn.size|0;ot.command(!("size"in Fn)||Fr>0&&Fr<=4,'invalid size for attribute "'+In+'", must be 1,2,3,4',je.commandStr);var di=!!Fn.normalized,$r=0;"type"in Fn&&(ot.commandParameter(Fn.type,Dl,"invalid type for attribute "+In,je.commandStr),$r=Dl[Fn.type]);var fi=Fn.divisor|0;"divisor"in Fn&&(ot.command(fi===0||gi,'cannot specify divisor for attribute "'+In+'", instancing not supported',je.commandStr),ot.command(fi>=0,'invalid divisor for attribute "'+In+'"',je.commandStr)),ot.optional(function(){var Oo=je.commandStr,Bi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Fn).forEach(function(yo){ot.command(Bi.indexOf(yo)>=0,'unknown parameter "'+yo+'" for attribute pointer "'+In+'" (valid parameters are '+Bi+")",Oo)})}),an.buffer=Nn,an.state=Ti,an.size=Fr,an.normalized=di,an.type=$r||Nn.dtype,an.offset=Bn,an.stride=Dr,an.divisor=fi}}yr[In]=pc(function(Oo,Bi){var yo=Oo.attribCache;if(Yn in yo)return yo[Yn];var Yo={isStream:!1};return Object.keys(an).forEach(function(ea){Yo[ea]=an[ea]}),an.buffer&&(Yo.buffer=Oo.link(an.buffer),Yo.type=Yo.type||Yo.buffer+".dtype"),yo[Yn]=Yo,Yo})}),Object.keys(wr).forEach(function(In){var Fn=wr[In];function Yn(an,Nn){var Re=an.invoke(Nn,Fn),Bn=an.shared,Dr=an.constants,Fr=Bn.isBufferArgs,di=Bn.buffer;ot.optional(function(){an.assert(Nn,Re+"&&(typeof "+Re+'==="object"||typeof '+Re+'==="function")&&('+Fr+"("+Re+")||"+di+".getBuffer("+Re+")||"+di+".getBuffer("+Re+".buffer)||"+Fr+"("+Re+'.buffer)||("constant" in '+Re+"&&(typeof "+Re+'.constant==="number"||'+Bn.isArrayLike+"("+Re+".constant))))",'invalid dynamic attribute "'+In+'"')});var $r={isStream:Nn.def(!1)},fi=new ur;fi.state=Ti,Object.keys(fi).forEach(function(Yo){$r[Yo]=Nn.def(""+fi[Yo])});var Oo=$r.buffer,Bi=$r.type;Nn("if(",Fr,"(",Re,")){",$r.isStream,"=true;",Oo,"=",di,".createStream(",Sp,",",Re,");",Bi,"=",Oo,".dtype;","}else{",Oo,"=",di,".getBuffer(",Re,");","if(",Oo,"){",Bi,"=",Oo,".dtype;",'}else if("constant" in ',Re,"){",$r.state,"=",zi,";","if(typeof "+Re+'.constant === "number"){',$r[ei[0]],"=",Re,".constant;",ei.slice(1).map(function(Yo){return $r[Yo]}).join("="),"=0;","}else{",ei.map(function(Yo,ea){return $r[Yo]+"="+Re+".constant.length>"+ea+"?"+Re+".constant["+ea+"]:0;"}).join(""),"}}else{","if(",Fr,"(",Re,".buffer)){",Oo,"=",di,".createStream(",Sp,",",Re,".buffer);","}else{",Oo,"=",di,".getBuffer(",Re,".buffer);","}",Bi,'="type" in ',Re,"?",Dr.glTypes,"[",Re,".type]:",Oo,".dtype;",$r.normalized,"=!!",Re,".normalized;");function yo(Yo){Nn($r[Yo],"=",Re,".",Yo,"|0;")}return yo("size"),yo("offset"),yo("stride"),yo("divisor"),Nn("}}"),Nn.exit("if(",$r.isStream,"){",di,".destroyStream(",Oo,");","}"),$r}yr[In]=Hu(Fn,Yn)}),yr}function hl(he,je){var _n=he.static,wr=he.dynamic;if(lf in _n){var yr=_n[lf];return yr!==null&&Di.getVAO(yr)===null&&(yr=Di.createVAO(yr)),pc(function(Fn){return Fn.link(Di.getVAO(yr))})}else if(lf in wr){var In=wr[lf];return Hu(In,function(Fn,Yn){var an=Fn.invoke(Yn,In);return Yn.def(Fn.shared.vao+".getVAO("+an+")")})}return null}function Js(he){var je=he.static,_n=he.dynamic,wr={};return Object.keys(je).forEach(function(yr){var In=je[yr];wr[yr]=pc(function(Fn,Yn){return typeof In=="number"||typeof In=="boolean"?""+In:Fn.link(In)})}),Object.keys(_n).forEach(function(yr){var In=_n[yr];wr[yr]=Hu(In,function(Fn,Yn){return Fn.invoke(Yn,In)})}),wr}function Yl(he,je,_n,wr,yr){var In=he.static,Fn=he.dynamic;ot.optional(function(){var yo=[gs,Bl,Zu,No,Fl,bf,Xl,Hd,ya,lf].concat(yi);function Yo(ea){Object.keys(ea).forEach(function(Ss){ot.command(yo.indexOf(Ss)>=0,'unknown parameter "'+Ss+'"',yr.commandStr)})}Yo(In),Yo(Fn)});var Yn=ha(he,je),an=lo(he,yr),Nn=La(he,an,yr),Re=hs(he,yr),Bn=yl(he,yr),Dr=Ko(he,yr,Yn);function Fr(yo){var Yo=Nn[yo];Yo&&(Bn[yo]=Yo)}Fr(fl),Fr(Yi(wi));var di=Object.keys(Bn).length>0,$r={framebuffer:an,draw:Re,shader:Dr,state:Bn,dirty:di,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if($r.profile=Ua(he,yr),$r.uniforms=qc(_n,yr),$r.drawVAO=$r.scopeVAO=hl(he,yr),!$r.drawVAO&&Dr.program&&!Yn&&gn.angle_instanced_arrays){var fi=!0,Oo=Dr.program.attributes.map(function(yo){var Yo=je.static[yo];return fi=fi&&!!Yo,Yo});if(fi&&Oo.length>0){var Bi=Di.getVAO(Di.createVAO(Oo));$r.drawVAO=new _u(null,null,null,function(yo,Yo){return yo.link(Bi)}),$r.useVAO=!0}}return Yn?$r.useVAO=!0:$r.attributes=Va(je,yr),$r.context=Js(wr,yr),$r}function Ul(he,je,_n){var wr=he.shared,yr=wr.context,In=he.scope();Object.keys(_n).forEach(function(Fn){je.save(yr,"."+Fn);var Yn=_n[Fn];In(yr,".",Fn,"=",Yn.append(he,je),";")}),je(In)}function rs(he,je,_n,wr){var yr=he.shared,In=yr.gl,Fn=yr.framebuffer,Yn;to&&(Yn=je.def(yr.extensions,".webgl_draw_buffers"));var an=he.constants,Nn=an.drawBuffer,Re=an.backBuffer,Bn;_n?Bn=_n.append(he,je):Bn=je.def(Fn,".next"),wr||je("if(",Bn,"!==",Fn,".cur){"),je("if(",Bn,"){",In,".bindFramebuffer(",Jh,",",Bn,".framebuffer);"),to&&je(Yn,".drawBuffersWEBGL(",Nn,"[",Bn,".colorAttachments.length]);"),je("}else{",In,".bindFramebuffer(",Jh,",null);"),to&&je(Yn,".drawBuffersWEBGL(",Re,");"),je("}",Fn,".cur=",Bn,";"),wr||je("}")}function ql(he,je,_n){var wr=he.shared,yr=wr.gl,In=he.current,Fn=he.next,Yn=wr.current,an=wr.next,Nn=he.cond(Yn,".dirty");yi.forEach(function(Re){var Bn=Yi(Re);if(!(Bn in _n.state)){var Dr,Fr;if(Bn in Fn){Dr=Fn[Bn],Fr=In[Bn];var di=Gn(ri[Bn].length,function(fi){return Nn.def(Dr,"[",fi,"]")});Nn(he.cond(di.map(function(fi,Oo){return fi+"!=="+Fr+"["+Oo+"]"}).join("||")).then(yr,".",oi[Bn],"(",di,");",di.map(function(fi,Oo){return Fr+"["+Oo+"]="+fi}).join(";"),";"))}else{Dr=Nn.def(an,".",Bn);var $r=he.cond(Dr,"!==",Yn,".",Bn);Nn($r),Bn in eo?$r(he.cond(Dr).then(yr,".enable(",eo[Bn],");").else(yr,".disable(",eo[Bn],");"),Yn,".",Bn,"=",Dr,";"):$r(yr,".",oi[Bn],"(",Dr,");",Yn,".",Bn,"=",Dr,";")}}}),Object.keys(_n.state).length===0&&Nn(Yn,".dirty=false;"),je(Nn)}function tc(he,je,_n,wr){var yr=he.shared,In=he.current,Fn=yr.current,Yn=yr.gl;Mp(Object.keys(_n)).forEach(function(an){var Nn=_n[an];if(!(wr&&!wr(Nn))){var Re=Nn.append(he,je);if(eo[an]){var Bn=eo[an];lu(Nn)?Re?je(Yn,".enable(",Bn,");"):je(Yn,".disable(",Bn,");"):je(he.cond(Re).then(Yn,".enable(",Bn,");").else(Yn,".disable(",Bn,");")),je(Fn,".",an,"=",Re,";")}else if(il(Re)){var Dr=In[an];je(Yn,".",oi[an],"(",Re,");",Re.map(function(Fr,di){return Dr+"["+di+"]="+Fr}).join(";"),";")}else je(Yn,".",oi[an],"(",Re,");",Fn,".",an,"=",Re,";")}})}function mc(he,je){gi&&(he.instancing=je.def(he.shared.extensions,".angle_instanced_arrays"))}function Oa(he,je,_n,wr,yr){var In=he.shared,Fn=he.stats,Yn=In.current,an=In.timer,Nn=_n.profile;function Re(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Bn,Dr;function Fr(yo){Bn=je.def(),yo(Bn,"=",Re(),";"),typeof yr=="string"?yo(Fn,".count+=",yr,";"):yo(Fn,".count++;"),hi&&(wr?(Dr=je.def(),yo(Dr,"=",an,".getNumPendingQueries();")):yo(an,".beginQuery(",Fn,");"))}function di(yo){yo(Fn,".cpuTime+=",Re(),"-",Bn,";"),hi&&(wr?yo(an,".pushScopeStats(",Dr,",",an,".getNumPendingQueries(),",Fn,");"):yo(an,".endQuery();"))}function $r(yo){var Yo=je.def(Yn,".profile");je(Yn,".profile=",yo,";"),je.exit(Yn,".profile=",Yo,";")}var fi;if(Nn){if(lu(Nn)){Nn.enable?(Fr(je),di(je.exit),$r("true")):$r("false");return}fi=Nn.append(he,je),$r(fi)}else fi=je.def(Yn,".profile");var Oo=he.block();Fr(Oo),je("if(",fi,"){",Oo,"}");var Bi=he.block();di(Bi),je.exit("if(",fi,"){",Bi,"}")}function $c(he,je,_n,wr,yr){var In=he.shared;function Fn(an){switch(an){case nv:case Ap:case Wd:return 2;case Kh:case Qs:case Op:return 3;case k0:case Ef:case dc:return 4;default:return 1}}function Yn(an,Nn,Re){var Bn=In.gl,Dr=je.def(an,".location"),Fr=je.def(In.attributes,"[",Dr,"]"),di=Re.state,$r=Re.buffer,fi=[Re.x,Re.y,Re.z,Re.w],Oo=["buffer","normalized","offset","stride"];function Bi(){je("if(!",Fr,".buffer){",Bn,".enableVertexAttribArray(",Dr,");}");var Yo=Re.type,ea;if(Re.size?ea=je.def(Re.size,"||",Nn):ea=Nn,je("if(",Fr,".type!==",Yo,"||",Fr,".size!==",ea,"||",Oo.map(function(Sc){return Fr+"."+Sc+"!=="+Re[Sc]}).join("||"),"){",Bn,".bindBuffer(",Sp,",",$r,".buffer);",Bn,".vertexAttribPointer(",[Dr,ea,Yo,Re.normalized,Re.stride,Re.offset],");",Fr,".type=",Yo,";",Fr,".size=",ea,";",Oo.map(function(Sc){return Fr+"."+Sc+"="+Re[Sc]+";"}).join(""),"}"),gi){var Ss=Re.divisor;je("if(",Fr,".divisor!==",Ss,"){",he.instancing,".vertexAttribDivisorANGLE(",[Dr,Ss],");",Fr,".divisor=",Ss,";}")}}function yo(){je("if(",Fr,".buffer){",Bn,".disableVertexAttribArray(",Dr,");",Fr,".buffer=null;","}if(",ei.map(function(Yo,ea){return Fr+"."+Yo+"!=="+fi[ea]}).join("||"),"){",Bn,".vertexAttrib4f(",Dr,",",fi,");",ei.map(function(Yo,ea){return Fr+"."+Yo+"="+fi[ea]+";"}).join(""),"}")}di===Ti?Bi():di===zi?yo():(je("if(",di,"===",Ti,"){"),Bi(),je("}else{"),yo(),je("}"))}wr.forEach(function(an){var Nn=an.name,Re=_n.attributes[Nn],Bn;if(Re){if(!yr(Re))return;Bn=Re.append(he,je)}else{if(!yr(xu))return;var Dr=he.scopeAttrib(Nn);ot.optional(function(){he.assert(je,Dr+".state","missing attribute "+Nn)}),Bn={},Object.keys(new ur).forEach(function(Fr){Bn[Fr]=je.def(Dr,".",Fr)})}Yn(he.link(an),Fn(an.info.type),Bn)})}function Os(he,je,_n,wr,yr){for(var In=he.shared,Fn=In.gl,Yn,an=0;an<wr.length;++an){var Nn=wr[an],Re=Nn.name,Bn=Nn.info.type,Dr=_n.uniforms[Re],Fr=he.link(Nn),di=Fr+".location",$r;if(Dr){if(!yr(Dr))continue;if(lu(Dr)){var fi=Dr.value;if(ot.command(fi!==null&&typeof fi!="undefined",'missing uniform "'+Re+'"',he.commandStr),Bn===Cp||Bn===n0){ot.command(typeof fi=="function"&&(Bn===Cp&&(fi._reglType==="texture2d"||fi._reglType==="framebuffer")||Bn===n0&&(fi._reglType==="textureCube"||fi._reglType==="framebufferCube")),"invalid texture for uniform "+Re,he.commandStr);var Oo=he.link(fi._texture||fi.color[0]._texture);je(Fn,".uniform1i(",di,",",Oo+".bind());"),je.exit(Oo,".unbind();")}else if(Bn===Xd||Bn===Qh||Bn===gl){ot.optional(function(){ot.command(il(fi),"invalid matrix for uniform "+Re,he.commandStr),ot.command(Bn===Xd&&fi.length===4||Bn===Qh&&fi.length===9||Bn===gl&&fi.length===16,"invalid length for matrix uniform "+Re,he.commandStr)});var Bi=he.global.def("new Float32Array(["+Array.prototype.slice.call(fi)+"])"),yo=2;Bn===Qh?yo=3:Bn===gl&&(yo=4),je(Fn,".uniformMatrix",yo,"fv(",di,",false,",Bi,");")}else{switch(Bn){case $h:ot.commandType(fi,"number","uniform "+Re,he.commandStr),Yn="1f";break;case nv:ot.command(il(fi)&&fi.length===2,"uniform "+Re,he.commandStr),Yn="2f";break;case Kh:ot.command(il(fi)&&fi.length===3,"uniform "+Re,he.commandStr),Yn="3f";break;case k0:ot.command(il(fi)&&fi.length===4,"uniform "+Re,he.commandStr),Yn="4f";break;case B0:ot.commandType(fi,"boolean","uniform "+Re,he.commandStr),Yn="1i";break;case Yc:ot.commandType(fi,"number","uniform "+Re,he.commandStr),Yn="1i";break;case Wd:ot.command(il(fi)&&fi.length===2,"uniform "+Re,he.commandStr),Yn="2i";break;case Ap:ot.command(il(fi)&&fi.length===2,"uniform "+Re,he.commandStr),Yn="2i";break;case Op:ot.command(il(fi)&&fi.length===3,"uniform "+Re,he.commandStr),Yn="3i";break;case Qs:ot.command(il(fi)&&fi.length===3,"uniform "+Re,he.commandStr),Yn="3i";break;case dc:ot.command(il(fi)&&fi.length===4,"uniform "+Re,he.commandStr),Yn="4i";break;case Ef:ot.command(il(fi)&&fi.length===4,"uniform "+Re,he.commandStr),Yn="4i";break}je(Fn,".uniform",Yn,"(",di,",",il(fi)?Array.prototype.slice.call(fi):fi,");")}continue}else $r=Dr.append(he,je)}else{if(!yr(xu))continue;$r=je.def(In.uniforms,"[",Pe.id(Re),"]")}Bn===Cp?je("if(",$r,"&&",$r,'._reglType==="framebuffer"){',$r,"=",$r,".color[0];","}"):Bn===n0&&je("if(",$r,"&&",$r,'._reglType==="framebufferCube"){',$r,"=",$r,".color[0];","}"),ot.optional(function(){function bu(Cd,$d){he.assert(je,Cd,'bad data or missing for uniform "'+Re+'".  '+$d)}function mm(Cd){bu("typeof "+$r+'==="'+Cd+'"',"invalid type, expected "+Cd)}function uf(Cd,$d){bu(In.isArrayLike+"("+$r+")&&"+$r+".length==="+Cd,"invalid vector, should have length "+Cd,he.commandStr)}function Kv(Cd){bu("typeof "+$r+'==="function"&&'+$r+'._reglType==="texture'+(Cd===cm?"2d":"Cube")+'"',"invalid texture type",he.commandStr)}switch(Bn){case Yc:mm("number");break;case Ap:uf(2,"number");break;case Qs:uf(3,"number");break;case Ef:uf(4,"number");break;case $h:mm("number");break;case nv:uf(2,"number");break;case Kh:uf(3,"number");break;case k0:uf(4,"number");break;case B0:mm("boolean");break;case Wd:uf(2,"boolean");break;case Op:uf(3,"boolean");break;case dc:uf(4,"boolean");break;case Xd:uf(4,"number");break;case Qh:uf(9,"number");break;case gl:uf(16,"number");break;case Cp:Kv(cm);break;case n0:Kv(um);break}});var Yo=1;switch(Bn){case Cp:case n0:var ea=je.def($r,"._texture");je(Fn,".uniform1i(",di,",",ea,".bind());"),je.exit(ea,".unbind();");continue;case Yc:case B0:Yn="1i";break;case Ap:case Wd:Yn="2i",Yo=2;break;case Qs:case Op:Yn="3i",Yo=3;break;case Ef:case dc:Yn="4i",Yo=4;break;case $h:Yn="1f";break;case nv:Yn="2f",Yo=2;break;case Kh:Yn="3f",Yo=3;break;case k0:Yn="4f",Yo=4;break;case Xd:Yn="Matrix2fv";break;case Qh:Yn="Matrix3fv";break;case gl:Yn="Matrix4fv";break}if(je(Fn,".uniform",Yn,"(",di,","),Yn.charAt(0)==="M"){var Ss=Math.pow(Bn-Xd+2,2),Sc=he.global.def("new Float32Array(",Ss,")");je("false,(Array.isArray(",$r,")||",$r," instanceof Float32Array)?",$r,":(",Gn(Ss,function(bu){return Sc+"["+bu+"]="+$r+"["+bu+"]"}),",",Sc,")")}else Yo>1?je(Gn(Yo,function(bu){return $r+"["+bu+"]"})):je($r);je(");")}}function Zo(he,je,_n,wr){var yr=he.shared,In=yr.gl,Fn=yr.draw,Yn=wr.draw;function an(){var ea=Yn.elements,Ss,Sc=je;return ea?((ea.contextDep&&wr.contextDynamic||ea.propDep)&&(Sc=_n),Ss=ea.append(he,Sc)):Ss=Sc.def(Fn,".",No),Ss&&Sc("if("+Ss+")"+In+".bindBuffer("+ey+","+Ss+".buffer.buffer);"),Ss}function Nn(){var ea=Yn.count,Ss,Sc=je;return ea?((ea.contextDep&&wr.contextDynamic||ea.propDep)&&(Sc=_n),Ss=ea.append(he,Sc),ot.optional(function(){ea.MISSING&&he.assert(je,"false","missing vertex count"),ea.DYNAMIC&&he.assert(Sc,Ss+">=0","missing vertex count")})):(Ss=Sc.def(Fn,".",Xl),ot.optional(function(){he.assert(Sc,Ss+">=0","missing vertex count")})),Ss}var Re=an();function Bn(ea){var Ss=Yn[ea];return Ss?Ss.contextDep&&wr.contextDynamic||Ss.propDep?Ss.append(he,_n):Ss.append(he,je):je.def(Fn,".",ea)}var Dr=Bn(Fl),Fr=Bn(bf),di=Nn();if(typeof di=="number"){if(di===0)return}else _n("if(",di,"){"),_n.exit("}");var $r,fi;gi&&($r=Bn(Hd),fi=he.instancing);var Oo=Re+".type",Bi=Yn.elements&&lu(Yn.elements);function yo(){function ea(){_n(fi,".drawElementsInstancedANGLE(",[Dr,di,Oo,Fr+"<<(("+Oo+"-"+Yr+")>>1)",$r],");")}function Ss(){_n(fi,".drawArraysInstancedANGLE(",[Dr,Fr,di,$r],");")}Re?Bi?ea():(_n("if(",Re,"){"),ea(),_n("}else{"),Ss(),_n("}")):Ss()}function Yo(){function ea(){_n(In+".drawElements("+[Dr,di,Oo,Fr+"<<(("+Oo+"-"+Yr+")>>1)"]+");")}function Ss(){_n(In+".drawArrays("+[Dr,Fr,di]+");")}Re?Bi?ea():(_n("if(",Re,"){"),ea(),_n("}else{"),Ss(),_n("}")):Ss()}gi&&(typeof $r!="number"||$r>=0)?typeof $r=="string"?(_n("if(",$r,">0){"),yo(),_n("}else if(",$r,"<0){"),Yo(),_n("}")):yo():Yo()}function Ea(he,je,_n,wr,yr){var In=Uo(),Fn=In.proc("body",yr);return ot.optional(function(){In.commandStr=je.commandStr,In.command=In.link(je.commandStr)}),gi&&(In.instancing=Fn.def(In.shared.extensions,".angle_instanced_arrays")),he(In,Fn,_n,wr),In.compile().body}function ja(he,je,_n,wr){mc(he,je),_n.useVAO?_n.drawVAO?je(he.shared.vao,".setVAO(",_n.drawVAO.append(he,je),");"):je(he.shared.vao,".setVAO(",he.shared.vao,".targetVAO);"):(je(he.shared.vao,".setVAO(null);"),$c(he,je,_n,wr.attributes,function(){return!0})),Os(he,je,_n,wr.uniforms,function(){return!0}),Zo(he,je,je,_n)}function $l(he,je){var _n=he.proc("draw",1);mc(he,_n),Ul(he,_n,je.context),rs(he,_n,je.framebuffer),ql(he,_n,je),tc(he,_n,je.state),Oa(he,_n,je,!1,!0);var wr=je.shader.progVar.append(he,_n);if(_n(he.shared.gl,".useProgram(",wr,".program);"),je.shader.program)ja(he,_n,je,je.shader.program);else{_n(he.shared.vao,".setVAO(null);");var yr=he.global.def("{}"),In=_n.def(wr,".id"),Fn=_n.def(yr,"[",In,"]");_n(he.cond(Fn).then(Fn,".call(this,a0);").else(Fn,"=",yr,"[",In,"]=",he.link(function(Yn){return Ea(ja,he,je,Yn,1)}),"(",wr,");",Fn,".call(this,a0);"))}Object.keys(je.state).length>0&&_n(he.shared.current,".dirty=true;")}function ch(he,je,_n,wr){he.batchId="a1",mc(he,je);function yr(){return!0}$c(he,je,_n,wr.attributes,yr),Os(he,je,_n,wr.uniforms,yr),Zo(he,je,je,_n)}function We(he,je,_n,wr){mc(he,je);var yr=_n.contextDep,In=je.def(),Fn="a0",Yn="a1",an=je.def();he.shared.props=an,he.batchId=In;var Nn=he.scope(),Re=he.scope();je(Nn.entry,"for(",In,"=0;",In,"<",Yn,";++",In,"){",an,"=",Fn,"[",In,"];",Re,"}",Nn.exit);function Bn(Oo){return Oo.contextDep&&yr||Oo.propDep}function Dr(Oo){return!Bn(Oo)}if(_n.needsContext&&Ul(he,Re,_n.context),_n.needsFramebuffer&&rs(he,Re,_n.framebuffer),tc(he,Re,_n.state,Bn),_n.profile&&Bn(_n.profile)&&Oa(he,Re,_n,!1,!0),wr)_n.useVAO?_n.drawVAO?Bn(_n.drawVAO)?Re(he.shared.vao,".setVAO(",_n.drawVAO.append(he,Re),");"):Nn(he.shared.vao,".setVAO(",_n.drawVAO.append(he,Nn),");"):Nn(he.shared.vao,".setVAO(",he.shared.vao,".targetVAO);"):(Nn(he.shared.vao,".setVAO(null);"),$c(he,Nn,_n,wr.attributes,Dr),$c(he,Re,_n,wr.attributes,Bn)),Os(he,Nn,_n,wr.uniforms,Dr),Os(he,Re,_n,wr.uniforms,Bn),Zo(he,Nn,Re,_n);else{var Fr=he.global.def("{}"),di=_n.shader.progVar.append(he,Re),$r=Re.def(di,".id"),fi=Re.def(Fr,"[",$r,"]");Re(he.shared.gl,".useProgram(",di,".program);","if(!",fi,"){",fi,"=",Fr,"[",$r,"]=",he.link(function(Oo){return Ea(ch,he,_n,Oo,2)}),"(",di,");}",fi,".call(this,a0[",In,"],",In,");")}}function Pr(he,je){var _n=he.proc("batch",2);he.batchId="0",mc(he,_n);var wr=!1,yr=!0;Object.keys(je.context).forEach(function(Fr){wr=wr||je.context[Fr].propDep}),wr||(Ul(he,_n,je.context),yr=!1);var In=je.framebuffer,Fn=!1;In?(In.propDep?wr=Fn=!0:In.contextDep&&wr&&(Fn=!0),Fn||rs(he,_n,In)):rs(he,_n,null),je.state.viewport&&je.state.viewport.propDep&&(wr=!0);function Yn(Fr){return Fr.contextDep&&wr||Fr.propDep}ql(he,_n,je),tc(he,_n,je.state,function(Fr){return!Yn(Fr)}),(!je.profile||!Yn(je.profile))&&Oa(he,_n,je,!1,"a1"),je.contextDep=wr,je.needsContext=yr,je.needsFramebuffer=Fn;var an=je.shader.progVar;if(an.contextDep&&wr||an.propDep)We(he,_n,je,null);else{var Nn=an.append(he,_n);if(_n(he.shared.gl,".useProgram(",Nn,".program);"),je.shader.program)We(he,_n,je,je.shader.program);else{_n(he.shared.vao,".setVAO(null);");var Re=he.global.def("{}"),Bn=_n.def(Nn,".id"),Dr=_n.def(Re,"[",Bn,"]");_n(he.cond(Dr).then(Dr,".call(this,a0,a1);").else(Dr,"=",Re,"[",Bn,"]=",he.link(function(Fr){return Ea(We,he,je,Fr,2)}),"(",Nn,");",Dr,".call(this,a0,a1);"))}}Object.keys(je.state).length>0&&_n(he.shared.current,".dirty=true;")}function _r(he,je){var _n=he.proc("scope",3);he.batchId="a2";var wr=he.shared,yr=wr.current;Ul(he,_n,je.context),je.framebuffer&&je.framebuffer.append(he,_n),Mp(Object.keys(je.state)).forEach(function(Fn){var Yn=je.state[Fn],an=Yn.append(he,_n);il(an)?an.forEach(function(Nn,Re){_n.set(he.next[Fn],"["+Re+"]",Nn)}):_n.set(wr.next,"."+Fn,an)}),Oa(he,_n,je,!0,!0),[No,bf,Xl,Hd,Fl].forEach(function(Fn){var Yn=je.draw[Fn];Yn&&_n.set(wr.draw,"."+Fn,""+Yn.append(he,_n))}),Object.keys(je.uniforms).forEach(function(Fn){_n.set(wr.uniforms,"["+Pe.id(Fn)+"]",je.uniforms[Fn].append(he,_n))}),Object.keys(je.attributes).forEach(function(Fn){var Yn=je.attributes[Fn].append(he,_n),an=he.scopeAttrib(Fn);Object.keys(new ur).forEach(function(Nn){_n.set(an,"."+Nn,Yn[Nn])})}),je.scopeVAO&&_n.set(wr.vao,".targetVAO",je.scopeVAO.append(he,_n));function In(Fn){var Yn=je.shader[Fn];Yn&&_n.set(wr.shader,"."+Fn,Yn.append(he,_n))}In(Bl),In(Zu),Object.keys(je.state).length>0&&(_n(yr,".dirty=true;"),_n.exit(yr,".dirty=true;")),_n("a1(",he.shared.context,",a0,",he.batchId,");")}function no(he){if(!(typeof he!="object"||il(he))){for(var je=Object.keys(he),_n=0;_n<je.length;++_n)if(xn.isDynamic(he[je[_n]]))return!0;return!1}}function Da(he,je,_n){var wr=je.static[_n];if(!wr||!no(wr))return;var yr=he.global,In=Object.keys(wr),Fn=!1,Yn=!1,an=!1,Nn=he.global.def("{}");In.forEach(function(Bn){var Dr=wr[Bn];if(xn.isDynamic(Dr)){typeof Dr=="function"&&(Dr=wr[Bn]=xn.unbox(Dr));var Fr=Hu(Dr,null);Fn=Fn||Fr.thisDep,an=an||Fr.propDep,Yn=Yn||Fr.contextDep}else{switch(yr(Nn,".",Bn,"="),typeof Dr){case"number":yr(Dr);break;case"string":yr('"',Dr,'"');break;case"object":Array.isArray(Dr)&&yr("[",Dr.join(),"]");break;default:yr(he.link(Dr));break}yr(";")}});function Re(Bn,Dr){In.forEach(function(Fr){var di=wr[Fr];if(xn.isDynamic(di)){var $r=Bn.invoke(Dr,di);Dr(Nn,".",Fr,"=",$r,";")}})}je.dynamic[_n]=new xn.DynamicVariable(Tn,{thisDep:Fn,contextDep:Yn,propDep:an,ref:Nn,append:Re}),delete je.static[_n]}function ys(he,je,_n,wr,yr){var In=Uo();In.stats=In.link(yr),Object.keys(je.static).forEach(function(Yn){Da(In,je,Yn)}),lm.forEach(function(Yn){Da(In,he,Yn)});var Fn=Yl(he,je,_n,wr,In);return $l(In,Fn),_r(In,Fn),Pr(In,Fn),In.compile()}return{next:oo,current:ri,procs:function(){var he=Uo(),je=he.proc("poll"),_n=he.proc("refresh"),wr=he.block();je(wr),_n(wr);var yr=he.shared,In=yr.gl,Fn=yr.next,Yn=yr.current;wr(Yn,".dirty=false;"),rs(he,je),rs(he,_n,null,!0);var an;gi&&(an=he.link(gi)),gn.oes_vertex_array_object&&_n(he.link(gn.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Nn=0;Nn<Cr.maxAttributes;++Nn){var Re=_n.def(yr.attributes,"[",Nn,"]"),Bn=he.cond(Re,".buffer");Bn.then(In,".enableVertexAttribArray(",Nn,");",In,".bindBuffer(",Sp,",",Re,".buffer.buffer);",In,".vertexAttribPointer(",Nn,",",Re,".size,",Re,".type,",Re,".normalized,",Re,".stride,",Re,".offset);").else(In,".disableVertexAttribArray(",Nn,");",In,".vertexAttrib4f(",Nn,",",Re,".x,",Re,".y,",Re,".z,",Re,".w);",Re,".buffer=null;"),_n(Bn),gi&&_n(an,".vertexAttribDivisorANGLE(",Nn,",",Re,".divisor);")}return _n(he.shared.vao,".currentVAO=null;",he.shared.vao,".setVAO(",he.shared.vao,".targetVAO);"),Object.keys(eo).forEach(function(Dr){var Fr=eo[Dr],di=wr.def(Fn,".",Dr),$r=he.block();$r("if(",di,"){",In,".enable(",Fr,")}else{",In,".disable(",Fr,")}",Yn,".",Dr,"=",di,";"),_n($r),je("if(",di,"!==",Yn,".",Dr,"){",$r,"}")}),Object.keys(oi).forEach(function(Dr){var Fr=oi[Dr],di=ri[Dr],$r,fi,Oo=he.block();if(Oo(In,".",Fr,"("),il(di)){var Bi=di.length;$r=he.global.def(Fn,".",Dr),fi=he.global.def(Yn,".",Dr),Oo(Gn(Bi,function(yo){return $r+"["+yo+"]"}),");",Gn(Bi,function(yo){return fi+"["+yo+"]="+$r+"["+yo+"];"}).join("")),je("if(",Gn(Bi,function(yo){return $r+"["+yo+"]!=="+fi+"["+yo+"]"}).join("||"),"){",Oo,"}")}else $r=wr.def(Fn,".",Dr),fi=wr.def(Yn,".",Dr),Oo($r,");",Yn,".",Dr,"=",$r,";"),je("if(",$r,"!==",fi,"){",Oo,"}");_n(Oo)}),he.compile()}(),compile:ys}}function dm(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var A_=34918,Xv=34919,U0=35007,z0=function(xt,Pe){if(!Pe.ext_disjoint_timer_query)return null;var gn=[];function Cr(){return gn.pop()||Pe.ext_disjoint_timer_query.createQueryEXT()}function Hr(gi){gn.push(gi)}var Rr=[];function gr(gi){var to=Cr();Pe.ext_disjoint_timer_query.beginQueryEXT(U0,to),Rr.push(to),hi(Rr.length-1,Rr.length,gi)}function bi(){Pe.ext_disjoint_timer_query.endQueryEXT(U0)}function li(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Di=[];function Oi(){return Di.pop()||new li}function Mi(gi){Di.push(gi)}var Gi=[];function hi(gi,to,ri){var oo=Oi();oo.startQueryIndex=gi,oo.endQueryIndex=to,oo.sum=0,oo.stats=ri,Gi.push(oo)}var Pi=[],ur=[];function Lr(){var gi,to,ri=Rr.length;if(ri!==0){ur.length=Math.max(ur.length,ri+1),Pi.length=Math.max(Pi.length,ri+1),Pi[0]=0,ur[0]=0;var oo=0;for(gi=0,to=0;to<Rr.length;++to){var yi=Rr[to];Pe.ext_disjoint_timer_query.getQueryObjectEXT(yi,Xv)?(oo+=Pe.ext_disjoint_timer_query.getQueryObjectEXT(yi,A_),Hr(yi)):Rr[gi++]=yi,Pi[to+1]=oo,ur[to+1]=gi}for(Rr.length=gi,gi=0,to=0;to<Gi.length;++to){var eo=Gi[to],oi=eo.startQueryIndex,Yi=eo.endQueryIndex;eo.sum+=Pi[Yi]-Pi[oi];var ko=ur[oi],fa=ur[Yi];fa===ko?(eo.stats.gpuTime+=eo.sum/1e6,Mi(eo)):(eo.startQueryIndex=ko,eo.endQueryIndex=fa,Gi[gi++]=eo)}Gi.length=gi}}return{beginQuery:gr,endQuery:bi,pushScopeStats:hi,update:Lr,getNumPendingQueries:function(){return Rr.length},clear:function(){gn.push.apply(gn,Rr);for(var gi=0;gi<gn.length;gi++)Pe.ext_disjoint_timer_query.deleteQueryEXT(gn[gi]);Rr.length=0,gn.length=0},restore:function(){Rr.length=0,gn.length=0}}},ov=16384,cu=256,pm=1024,Ol=34962,Gu="webglcontextlost",Ah="webglcontextrestored",Oh=1,av=2,Yv=3;function qv(xt,Pe){for(var gn=0;gn<xt.length;++gn)if(xt[gn]===Pe)return gn;return-1}function $v(xt){var Pe=qn(xt);if(!Pe)return null;var gn=Pe.gl,Cr=gn.getContextAttributes(),Hr=gn.isContextLost(),Rr=Sr(gn,Pe);if(!Rr)return null;var gr=Qt(),bi=dm(),li=Rr.extensions,Di=z0(gn,li),Oi=Zn(),Mi=gn.drawingBufferWidth,Gi=gn.drawingBufferHeight,hi={tick:0,time:0,viewportWidth:Mi,viewportHeight:Gi,framebufferWidth:Mi,framebufferHeight:Gi,drawingBufferWidth:Mi,drawingBufferHeight:Gi,pixelRatio:Pe.pixelRatio},Pi={},ur={elements:null,primitive:4,count:-1,offset:0,instances:-1},Lr=wl(gn,li),gi=mh(gn,bi,Pe,ri),to=Rt(gn,li,Lr,bi,gi);function ri(Zo){return to.destroyBuffer(Zo)}var oo=$f(gn,li,gi,bi),yi=Qe(gn,gr,bi,Pe),eo=vu(gn,li,Lr,function(){ko.procs.poll()},hi,bi,Pe),oi=rh(gn,li,Lr,bi,Pe),Yi=H(gn,li,Lr,eo,oi,bi),ko=Pp(gn,gr,li,Lr,gi,oo,eo,Yi,Pi,to,yi,ur,hi,Di,Pe),fa=ar(gn,Yi,ko.procs.poll,hi,Cr,li,Lr),$i=ko.next,_i=gn.canvas,qr=[],Uo=[],Ua=[],lo=[Pe.onDestroy],La=null;function ha(){if(qr.length===0){Di&&Di.update(),La=null;return}La=Cn.next(ha),tc();for(var Zo=qr.length-1;Zo>=0;--Zo){var Ea=qr[Zo];Ea&&Ea(hi,null,0)}gn.flush(),Di&&Di.update()}function Ko(){!La&&qr.length>0&&(La=Cn.next(ha))}function hs(){La&&(Cn.cancel(ha),La=null)}function yl(Zo){Zo.preventDefault(),Hr=!0,hs(),Uo.forEach(function(Ea){Ea()})}function qc(Zo){gn.getError(),Hr=!1,Rr.restore(),yi.restore(),gi.restore(),eo.restore(),oi.restore(),Yi.restore(),to.restore(),Di&&Di.restore(),ko.procs.refresh(),Ko(),Ua.forEach(function(Ea){Ea()})}_i&&(_i.addEventListener(Gu,yl,!1),_i.addEventListener(Ah,qc,!1));function Va(){qr.length=0,hs(),_i&&(_i.removeEventListener(Gu,yl),_i.removeEventListener(Ah,qc)),yi.clear(),Yi.clear(),oi.clear(),eo.clear(),oo.clear(),gi.clear(),to.clear(),Di&&Di.clear(),lo.forEach(function(Zo){Zo()})}function hl(Zo){ot(!!Zo,"invalid args to regl({...})"),ot.type(Zo,"object","invalid args to regl({...})");function Ea(yr){var In=it({},yr);delete In.uniforms,delete In.attributes,delete In.context,delete In.vao,"stencil"in In&&In.stencil.op&&(In.stencil.opBack=In.stencil.opFront=In.stencil.op,delete In.stencil.op);function Fn(Yn){if(Yn in In){var an=In[Yn];delete In[Yn],Object.keys(an).forEach(function(Nn){In[Yn+"."+Nn]=an[Nn]})}}return Fn("blend"),Fn("depth"),Fn("cull"),Fn("stencil"),Fn("polygonOffset"),Fn("scissor"),Fn("sample"),"vao"in yr&&(In.vao=yr.vao),In}function ja(yr){var In={},Fn={};return Object.keys(yr).forEach(function(Yn){var an=yr[Yn];xn.isDynamic(an)?Fn[Yn]=xn.unbox(an,Yn):In[Yn]=an}),{dynamic:Fn,static:In}}var $l=ja(Zo.context||{}),ch=ja(Zo.uniforms||{}),We=ja(Zo.attributes||{}),Pr=ja(Ea(Zo)),_r={gpuTime:0,cpuTime:0,count:0},no=ko.compile(Pr,We,ch,$l,_r),Da=no.draw,ys=no.batch,he=no.scope,je=[];function _n(yr){for(;je.length<yr;)je.push(null);return je}function wr(yr,In){var Fn;if(Hr&&ot.raise("context lost"),typeof yr=="function")return he.call(this,null,yr,0);if(typeof In=="function")if(typeof yr=="number")for(Fn=0;Fn<yr;++Fn)he.call(this,null,In,Fn);else if(Array.isArray(yr))for(Fn=0;Fn<yr.length;++Fn)he.call(this,yr[Fn],In,Fn);else return he.call(this,yr,In,0);else if(typeof yr=="number"){if(yr>0)return ys.call(this,_n(yr|0),yr|0)}else if(Array.isArray(yr)){if(yr.length)return ys.call(this,yr,yr.length)}else return Da.call(this,yr)}return it(wr,{stats:_r})}var Js=Yi.setFBO=hl({framebuffer:xn.define.call(null,Oh,"framebuffer")});function Yl(Zo,Ea){var ja=0;ko.procs.poll();var $l=Ea.color;$l&&(gn.clearColor(+$l[0]||0,+$l[1]||0,+$l[2]||0,+$l[3]||0),ja|=ov),"depth"in Ea&&(gn.clearDepth(+Ea.depth),ja|=cu),"stencil"in Ea&&(gn.clearStencil(Ea.stencil|0),ja|=pm),ot(!!ja,"called regl.clear with no buffer specified"),gn.clear(ja)}function Ul(Zo){if(ot(typeof Zo=="object"&&Zo,"regl.clear() takes an object as input"),"framebuffer"in Zo)if(Zo.framebuffer&&Zo.framebuffer_reglType==="framebufferCube")for(var Ea=0;Ea<6;++Ea)Js(it({framebuffer:Zo.framebuffer.faces[Ea]},Zo),Yl);else Js(Zo,Yl);else Yl(null,Zo)}function rs(Zo){ot.type(Zo,"function","regl.frame() callback must be a function"),qr.push(Zo);function Ea(){var ja=qv(qr,Zo);ot(ja>=0,"cannot cancel a frame twice");function $l(){var ch=qv(qr,$l);qr[ch]=qr[qr.length-1],qr.length-=1,qr.length<=0&&hs()}qr[ja]=$l}return Ko(),{cancel:Ea}}function ql(){var Zo=$i.viewport,Ea=$i.scissor_box;Zo[0]=Zo[1]=Ea[0]=Ea[1]=0,hi.viewportWidth=hi.framebufferWidth=hi.drawingBufferWidth=Zo[2]=Ea[2]=gn.drawingBufferWidth,hi.viewportHeight=hi.framebufferHeight=hi.drawingBufferHeight=Zo[3]=Ea[3]=gn.drawingBufferHeight}function tc(){hi.tick+=1,hi.time=Oa(),ql(),ko.procs.poll()}function mc(){ql(),ko.procs.refresh(),Di&&Di.update()}function Oa(){return(Zn()-Oi)/1e3}mc();function $c(Zo,Ea){ot.type(Ea,"function","listener callback must be a function");var ja;switch(Zo){case"frame":return rs(Ea);case"lost":ja=Uo;break;case"restore":ja=Ua;break;case"destroy":ja=lo;break;default:ot.raise("invalid event, must be one of frame,lost,restore,destroy")}return ja.push(Ea),{cancel:function(){for(var $l=0;$l<ja.length;++$l)if(ja[$l]===Ea){ja[$l]=ja[ja.length-1],ja.pop();return}}}}var Os=it(hl,{clear:Ul,prop:xn.define.bind(null,Oh),context:xn.define.bind(null,av),this:xn.define.bind(null,Yv),draw:hl({}),buffer:function(Zo){return gi.create(Zo,Ol,!1,!1)},elements:function(Zo){return oo.create(Zo,!1)},texture:eo.create2D,cube:eo.createCube,renderbuffer:oi.create,framebuffer:Yi.create,framebufferCube:Yi.createCube,vao:to.createVAO,attributes:Cr,frame:rs,on:$c,limits:Lr,hasExtension:function(Zo){return Lr.extensions.indexOf(Zo.toLowerCase())>=0},read:fa,destroy:Va,_gl:gn,_refresh:mc,poll:function(){tc(),Di&&Di.update()},now:Oa,stats:bi});return Pe.onDone(null,Os),Os}return $v})},86851:function(br,rr,it){"use strict";var ne=it(89594),pt=Array.prototype.concat,R=Array.prototype.slice,$e=br.exports=function(xe){for(var le=[],Le=0,Lt=xe.length;Le<Lt;Le++){var fn=xe[Le];ne(fn)?le=pt.call(le,R.call(fn)):le.push(fn)}return le};$e.wrap=function(yt){return function(){return yt($e(arguments))}}},89594:function(br){br.exports=function(it){return!it||typeof it=="string"?!1:it instanceof Array||Array.isArray(it)||it.length>=0&&(it.splice instanceof Function||Object.getOwnPropertyDescriptor(it,it.length-1)&&it.constructor.name!=="String")}},69848:function(br){(function(rr,it){br.exports=it()})(this,function(){"use strict";function rr(He,$t,nn,ke,Je,er){if(!(Je-ke<=nn)){var kt=ke+Je>>1;it(He,$t,kt,ke,Je,er%2),rr(He,$t,nn,ke,kt-1,er+1),rr(He,$t,nn,kt+1,Je,er+1)}}function it(He,$t,nn,ke,Je,er){for(;Je>ke;){if(Je-ke>600){var kt=Je-ke+1,Te=nn-ke+1,gt=Math.log(kt),te=.5*Math.exp(2*gt/3),Zt=.5*Math.sqrt(gt*te*(kt-te)/kt)*(Te-kt/2<0?-1:1),Ut=Math.max(ke,Math.floor(nn-Te*te/kt+Zt)),we=Math.min(Je,Math.floor(nn+(kt-Te)*te/kt+Zt));it(He,$t,nn,Ut,we,er)}var ie=$t[2*nn+er],_t=ke,Ne=Je;for(ne(He,$t,ke,nn),$t[2*Je+er]>ie&&ne(He,$t,ke,Je);_t<Ne;){for(ne(He,$t,_t,Ne),_t++,Ne--;$t[2*_t+er]<ie;)_t++;for(;$t[2*Ne+er]>ie;)Ne--}$t[2*ke+er]===ie?ne(He,$t,ke,Ne):(Ne++,ne(He,$t,Ne,Je)),Ne<=nn&&(ke=Ne+1),nn<=Ne&&(Je=Ne-1)}}function ne(He,$t,nn,ke){pt(He,nn,ke),pt($t,2*nn,2*ke),pt($t,2*nn+1,2*ke+1)}function pt(He,$t,nn){var ke=He[$t];He[$t]=He[nn],He[nn]=ke}function R(He,$t,nn,ke,Je,er,kt){for(var Te=[0,He.length-1,0],gt=[],te,Zt;Te.length;){var Ut=Te.pop(),we=Te.pop(),ie=Te.pop();if(we-ie<=kt){for(var _t=ie;_t<=we;_t++)te=$t[2*_t],Zt=$t[2*_t+1],te>=nn&&te<=Je&&Zt>=ke&&Zt<=er&&gt.push(He[_t]);continue}var Ne=Math.floor((ie+we)/2);te=$t[2*Ne],Zt=$t[2*Ne+1],te>=nn&&te<=Je&&Zt>=ke&&Zt<=er&&gt.push(He[Ne]);var un=(Ut+1)%2;(Ut===0?nn<=te:ke<=Zt)&&(Te.push(ie),Te.push(Ne-1),Te.push(un)),(Ut===0?Je>=te:er>=Zt)&&(Te.push(Ne+1),Te.push(we),Te.push(un))}return gt}function $e(He,$t,nn,ke,Je,er){for(var kt=[0,He.length-1,0],Te=[],gt=Je*Je;kt.length;){var te=kt.pop(),Zt=kt.pop(),Ut=kt.pop();if(Zt-Ut<=er){for(var we=Ut;we<=Zt;we++)yt($t[2*we],$t[2*we+1],nn,ke)<=gt&&Te.push(He[we]);continue}var ie=Math.floor((Ut+Zt)/2),_t=$t[2*ie],Ne=$t[2*ie+1];yt(_t,Ne,nn,ke)<=gt&&Te.push(He[ie]);var un=(te+1)%2;(te===0?nn-Je<=_t:ke-Je<=Ne)&&(kt.push(Ut),kt.push(ie-1),kt.push(un)),(te===0?nn+Je>=_t:ke+Je>=Ne)&&(kt.push(ie+1),kt.push(Zt),kt.push(un))}return Te}function yt(He,$t,nn,ke){var Je=He-nn,er=$t-ke;return Je*Je+er*er}var xe=function(He){return He[0]},le=function(He){return He[1]},Le=function($t,nn,ke,Je,er){nn===void 0&&(nn=xe),ke===void 0&&(ke=le),Je===void 0&&(Je=64),er===void 0&&(er=Float64Array),this.nodeSize=Je,this.points=$t;for(var kt=$t.length<65536?Uint16Array:Uint32Array,Te=this.ids=new kt($t.length),gt=this.coords=new er($t.length*2),te=0;te<$t.length;te++)Te[te]=te,gt[2*te]=nn($t[te]),gt[2*te+1]=ke($t[te]);rr(Te,gt,Je,0,Te.length-1,0)};Le.prototype.range=function($t,nn,ke,Je){return R(this.ids,this.coords,$t,nn,ke,Je,this.nodeSize)},Le.prototype.within=function($t,nn,ke){return $e(this.ids,this.coords,$t,nn,ke,this.nodeSize)};var Lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(He){return He}},fn=Math.fround||function(He){return function($t){return He[0]=+$t,He[0]}}(new Float32Array(1)),Nt=function($t){this.options=Vn(Object.create(Lt),$t),this.trees=new Array(this.options.maxZoom+1)};Nt.prototype.load=function($t){var nn=this.options,ke=nn.log,Je=nn.minZoom,er=nn.maxZoom,kt=nn.nodeSize;ke&&console.time("total time");var Te="prepare "+$t.length+" points";ke&&console.time(Te),this.points=$t;for(var gt=[],te=0;te<$t.length;te++)$t[te].geometry&&gt.push(Ie($t[te],te));this.trees[er+1]=new Le(gt,mr,or,kt,Float32Array),ke&&console.timeEnd(Te);for(var Zt=er;Zt>=Je;Zt--){var Ut=+Date.now();gt=this._cluster(gt,Zt),this.trees[Zt]=new Le(gt,mr,or,kt,Float32Array),ke&&console.log("z%d: %d clusters in %dms",Zt,gt.length,+Date.now()-Ut)}return ke&&console.timeEnd("total time"),this},Nt.prototype.getClusters=function($t,nn){var ke=(($t[0]+180)%360+360)%360-180,Je=Math.max(-90,Math.min(90,$t[1])),er=$t[2]===180?180:(($t[2]+180)%360+360)%360-180,kt=Math.max(-90,Math.min(90,$t[3]));if($t[2]-$t[0]>=360)ke=-180,er=180;else if(ke>er){var Te=this.getClusters([ke,Je,180,kt],nn),gt=this.getClusters([-180,Je,er,kt],nn);return Te.concat(gt)}for(var te=this.trees[this._limitZoom(nn)],Zt=te.range(ve(ke),Ze(kt),ve(er),Ze(Je)),Ut=[],we=0,ie=Zt;we<ie.length;we+=1){var _t=ie[we],Ne=te.points[_t];Ut.push(Ne.numPoints?fe(Ne):this.points[Ne.index])}return Ut},Nt.prototype.getChildren=function($t){var nn=this._getOriginId($t),ke=this._getOriginZoom($t),Je="No cluster with the specified id.",er=this.trees[ke];if(!er)throw new Error(Je);var kt=er.points[nn];if(!kt)throw new Error(Je);for(var Te=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),gt=er.within(kt.x,kt.y,Te),te=[],Zt=0,Ut=gt;Zt<Ut.length;Zt+=1){var we=Ut[Zt],ie=er.points[we];ie.parentId===$t&&te.push(ie.numPoints?fe(ie):this.points[ie.index])}if(te.length===0)throw new Error(Je);return te},Nt.prototype.getLeaves=function($t,nn,ke){nn=nn||10,ke=ke||0;var Je=[];return this._appendLeaves(Je,$t,nn,ke,0),Je},Nt.prototype.getTile=function($t,nn,ke){var Je=this.trees[this._limitZoom($t)],er=Math.pow(2,$t),kt=this.options,Te=kt.extent,gt=kt.radius,te=gt/Te,Zt=(ke-te)/er,Ut=(ke+1+te)/er,we={features:[]};return this._addTileFeatures(Je.range((nn-te)/er,Zt,(nn+1+te)/er,Ut),Je.points,nn,ke,er,we),nn===0&&this._addTileFeatures(Je.range(1-te/er,Zt,1,Ut),Je.points,er,ke,er,we),nn===er-1&&this._addTileFeatures(Je.range(0,Zt,te/er,Ut),Je.points,-1,ke,er,we),we.features.length?we:null},Nt.prototype.getClusterExpansionZoom=function($t){for(var nn=this._getOriginZoom($t)-1;nn<=this.options.maxZoom;){var ke=this.getChildren($t);if(nn++,ke.length!==1)break;$t=ke[0].properties.cluster_id}return nn},Nt.prototype._appendLeaves=function($t,nn,ke,Je,er){for(var kt=this.getChildren(nn),Te=0,gt=kt;Te<gt.length;Te+=1){var te=gt[Te],Zt=te.properties;if(Zt&&Zt.cluster?er+Zt.point_count<=Je?er+=Zt.point_count:er=this._appendLeaves($t,Zt.cluster_id,ke,Je,er):er<Je?er++:$t.push(te),$t.length===ke)break}return er},Nt.prototype._addTileFeatures=function($t,nn,ke,Je,er,kt){for(var Te=0,gt=$t;Te<gt.length;Te+=1){var te=gt[Te],Zt=nn[te],Ut=Zt.numPoints,we=void 0,ie=void 0,_t=void 0;if(Ut)we=ce(Zt),ie=Zt.x,_t=Zt.y;else{var Ne=this.points[Zt.index];we=Ne.properties,ie=ve(Ne.geometry.coordinates[0]),_t=Ze(Ne.geometry.coordinates[1])}var un={type:1,geometry:[[Math.round(this.options.extent*(ie*er-ke)),Math.round(this.options.extent*(_t*er-Je))]],tags:we},Qn=void 0;Ut?Qn=Zt.id:this.options.generateId?Qn=Zt.index:this.points[Zt.index].id&&(Qn=this.points[Zt.index].id),Qn!==void 0&&(un.id=Qn),kt.features.push(un)}},Nt.prototype._limitZoom=function($t){return Math.max(this.options.minZoom,Math.min(Math.floor(+$t),this.options.maxZoom+1))},Nt.prototype._cluster=function($t,nn){for(var ke=[],Je=this.options,er=Je.radius,kt=Je.extent,Te=Je.reduce,gt=Je.minPoints,te=er/(kt*Math.pow(2,nn)),Zt=0;Zt<$t.length;Zt++){var Ut=$t[Zt];if(!(Ut.zoom<=nn)){Ut.zoom=nn;for(var we=this.trees[nn+1],ie=we.within(Ut.x,Ut.y,te),_t=Ut.numPoints||1,Ne=_t,un=0,Qn=ie;un<Qn.length;un+=1){var hr=Qn[un],Er=we.points[hr];Er.zoom>nn&&(Ne+=Er.numPoints||1)}if(Ne>_t&&Ne>=gt){for(var Ue=Ut.x*_t,cn=Ut.y*_t,wn=Te&&_t>1?this._map(Ut,!0):null,ir=(Zt<<5)+(nn+1)+this.points.length,rn=0,De=ie;rn<De.length;rn+=1){var Be=De[rn],At=we.points[Be];if(!(At.zoom<=nn)){At.zoom=nn;var Bt=At.numPoints||1;Ue+=At.x*Bt,cn+=At.y*Bt,At.parentId=ir,Te&&(wn||(wn=this._map(Ut,!0)),Te(wn,this._map(At)))}}Ut.parentId=ir,ke.push(Jt(Ue/Ne,cn/Ne,ir,Ne,wn))}else if(ke.push(Ut),Ne>1)for(var Ae=0,z=ie;Ae<z.length;Ae+=1){var rt=z[Ae],F=we.points[rt];F.zoom<=nn||(F.zoom=nn,ke.push(F))}}}return ke},Nt.prototype._getOriginId=function($t){return $t-this.points.length>>5},Nt.prototype._getOriginZoom=function($t){return($t-this.points.length)%32},Nt.prototype._map=function($t,nn){if($t.numPoints)return nn?Vn({},$t.properties):$t.properties;var ke=this.points[$t.index].properties,Je=this.options.map(ke);return nn&&Je===ke?Vn({},Je):Je};function Jt(He,$t,nn,ke,Je){return{x:fn(He),y:fn($t),zoom:1/0,id:nn,parentId:-1,numPoints:ke,properties:Je}}function Ie(He,$t){var nn=He.geometry.coordinates,ke=nn[0],Je=nn[1];return{x:fn(ve(ke)),y:fn(Ze(Je)),zoom:1/0,index:$t,parentId:-1}}function fe(He){return{type:"Feature",id:He.id,properties:ce(He),geometry:{type:"Point",coordinates:[Un(He.x),En(He.y)]}}}function ce(He){var $t=He.numPoints,nn=$t>=1e4?Math.round($t/1e3)+"k":$t>=1e3?Math.round($t/100)/10+"k":$t;return Vn(Vn({},He.properties),{cluster:!0,cluster_id:He.id,point_count:$t,point_count_abbreviated:nn})}function ve(He){return He/360+.5}function Ze(He){var $t=Math.sin(He*Math.PI/180),nn=.5-.25*Math.log((1+$t)/(1-$t))/Math.PI;return nn<0?0:nn>1?1:nn}function Un(He){return(He-.5)*360}function En(He){var $t=(180-He*360)*Math.PI/180;return 360*Math.atan(Math.exp($t))/Math.PI-90}function Vn(He,$t){for(var nn in $t)He[nn]=$t[nn];return He}function mr(He){return He.x}function or(He){return He.y}return Nt})},1449:function(br,rr,it){"use strict";it.d(rr,{Tu:function(){return Nt},tw:function(){return ve},uf:function(){return Ie},yu:function(){return Lt},zL:function(){return yt}});var ne=63710088e-1,pt={centimeters:ne*100,centimetres:ne*100,degrees:ne/111325,feet:ne*3.28084,inches:ne*39.37,kilometers:ne/1e3,kilometres:ne/1e3,meters:ne,metres:ne,miles:ne/1609.344,millimeters:ne*1e3,millimetres:ne*1e3,nauticalmiles:ne/1852,radians:1,yards:ne*1.0936},R={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ne,yards:1.0936133},$e={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function yt(gt,te,Zt){Zt===void 0&&(Zt={});var Ut={type:"Feature"};return(Zt.id===0||Zt.id)&&(Ut.id=Zt.id),Zt.bbox&&(Ut.bbox=Zt.bbox),Ut.properties=te||{},Ut.geometry=gt,Ut}function xe(gt,te,Zt){switch(Zt===void 0&&(Zt={}),gt){case"Point":return le(te).geometry;case"LineString":return Nt(te).geometry;case"Polygon":return Lt(te).geometry;case"MultiPoint":return ce(te).geometry;case"MultiLineString":return fe(te).geometry;case"MultiPolygon":return ve(te).geometry;default:throw new Error(gt+" is invalid")}}function le(gt,te,Zt){if(Zt===void 0&&(Zt={}),!gt)throw new Error("coordinates is required");if(!Array.isArray(gt))throw new Error("coordinates must be an Array");if(gt.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Je(gt[0])||!Je(gt[1]))throw new Error("coordinates must contain numbers");var Ut={type:"Point",coordinates:gt};return yt(Ut,te,Zt)}function Le(gt,te,Zt){return Zt===void 0&&(Zt={}),Ie(gt.map(function(Ut){return le(Ut,te)}),Zt)}function Lt(gt,te,Zt){Zt===void 0&&(Zt={});for(var Ut=0,we=gt;Ut<we.length;Ut++){var ie=we[Ut];if(ie.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _t=0;_t<ie[ie.length-1].length;_t++)if(ie[ie.length-1][_t]!==ie[0][_t])throw new Error("First and last Position are not equivalent.")}var Ne={type:"Polygon",coordinates:gt};return yt(Ne,te,Zt)}function fn(gt,te,Zt){return Zt===void 0&&(Zt={}),Ie(gt.map(function(Ut){return Lt(Ut,te)}),Zt)}function Nt(gt,te,Zt){if(Zt===void 0&&(Zt={}),gt.length<2)throw new Error("coordinates must be an array of two or more positions");var Ut={type:"LineString",coordinates:gt};return yt(Ut,te,Zt)}function Jt(gt,te,Zt){return Zt===void 0&&(Zt={}),Ie(gt.map(function(Ut){return Nt(Ut,te)}),Zt)}function Ie(gt,te){te===void 0&&(te={});var Zt={type:"FeatureCollection"};return te.id&&(Zt.id=te.id),te.bbox&&(Zt.bbox=te.bbox),Zt.features=gt,Zt}function fe(gt,te,Zt){Zt===void 0&&(Zt={});var Ut={type:"MultiLineString",coordinates:gt};return yt(Ut,te,Zt)}function ce(gt,te,Zt){Zt===void 0&&(Zt={});var Ut={type:"MultiPoint",coordinates:gt};return yt(Ut,te,Zt)}function ve(gt,te,Zt){Zt===void 0&&(Zt={});var Ut={type:"MultiPolygon",coordinates:gt};return yt(Ut,te,Zt)}function Ze(gt,te,Zt){Zt===void 0&&(Zt={});var Ut={type:"GeometryCollection",geometries:gt};return yt(Ut,te,Zt)}function Un(gt,te){if(te===void 0&&(te=0),te&&!(te>=0))throw new Error("precision must be a positive number");var Zt=Math.pow(10,te||0);return Math.round(gt*Zt)/Zt}function En(gt,te){te===void 0&&(te="kilometers");var Zt=pt[te];if(!Zt)throw new Error(te+" units is invalid");return gt*Zt}function Vn(gt,te){te===void 0&&(te="kilometers");var Zt=pt[te];if(!Zt)throw new Error(te+" units is invalid");return gt/Zt}function mr(gt,te){return He(Vn(gt,te))}function or(gt){var te=gt%360;return te<0&&(te+=360),te}function He(gt){var te=gt%(2*Math.PI);return te*180/Math.PI}function $t(gt){var te=gt%360;return te*Math.PI/180}function nn(gt,te,Zt){if(te===void 0&&(te="kilometers"),Zt===void 0&&(Zt="kilometers"),!(gt>=0))throw new Error("length must be a positive number");return En(Vn(gt,te),Zt)}function ke(gt,te,Zt){if(te===void 0&&(te="meters"),Zt===void 0&&(Zt="kilometers"),!(gt>=0))throw new Error("area must be a positive number");var Ut=$e[te];if(!Ut)throw new Error("invalid original units");var we=$e[Zt];if(!we)throw new Error("invalid final units");return gt/Ut*we}function Je(gt){return!isNaN(gt)&&gt!==null&&!Array.isArray(gt)}function er(gt){return!!gt&&gt.constructor===Object}function kt(gt){if(!gt)throw new Error("bbox is required");if(!Array.isArray(gt))throw new Error("bbox must be an Array");if(gt.length!==4&&gt.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");gt.forEach(function(te){if(!Je(te))throw new Error("bbox must only contain numbers")})}function Te(gt){if(!gt)throw new Error("id is required");if(["string","number"].indexOf(typeof gt)===-1)throw new Error("id must be a number or a string")}},39034:function(br,rr,it){"use strict";it.d(rr,{nG:function(){return Nt},pZ:function(){return pt}});var ne=it(1449);function pt(En,Vn,mr){if(En!==null)for(var or,He,$t,nn,ke,Je,er,kt=0,Te=0,gt,te=En.type,Zt=te==="FeatureCollection",Ut=te==="Feature",we=Zt?En.features.length:1,ie=0;ie<we;ie++){er=Zt?En.features[ie].geometry:Ut?En.geometry:En,gt=er?er.type==="GeometryCollection":!1,ke=gt?er.geometries.length:1;for(var _t=0;_t<ke;_t++){var Ne=0,un=0;if(nn=gt?er.geometries[_t]:er,nn!==null){Je=nn.coordinates;var Qn=nn.type;switch(kt=mr&&(Qn==="Polygon"||Qn==="MultiPolygon")?1:0,Qn){case null:break;case"Point":if(Vn(Je,Te,ie,Ne,un)===!1)return!1;Te++,Ne++;break;case"LineString":case"MultiPoint":for(or=0;or<Je.length;or++){if(Vn(Je[or],Te,ie,Ne,un)===!1)return!1;Te++,Qn==="MultiPoint"&&Ne++}Qn==="LineString"&&Ne++;break;case"Polygon":case"MultiLineString":for(or=0;or<Je.length;or++){for(He=0;He<Je[or].length-kt;He++){if(Vn(Je[or][He],Te,ie,Ne,un)===!1)return!1;Te++}Qn==="MultiLineString"&&Ne++,Qn==="Polygon"&&un++}Qn==="Polygon"&&Ne++;break;case"MultiPolygon":for(or=0;or<Je.length;or++){for(un=0,He=0;He<Je[or].length;He++){for($t=0;$t<Je[or][He].length-kt;$t++){if(Vn(Je[or][He][$t],Te,ie,Ne,un)===!1)return!1;Te++}un++}Ne++}break;case"GeometryCollection":for(or=0;or<nn.geometries.length;or++)if(pt(nn.geometries[or],Vn,mr)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function R(En,Vn,mr,or){var He=mr;return pt(En,function($t,nn,ke,Je,er){nn===0&&mr===void 0?He=$t:He=Vn(He,$t,nn,ke,Je,er)},or),He}function $e(En,Vn){var mr;switch(En.type){case"FeatureCollection":for(mr=0;mr<En.features.length&&Vn(En.features[mr].properties,mr)!==!1;mr++);break;case"Feature":Vn(En.properties,0);break}}function yt(En,Vn,mr){var or=mr;return $e(En,function(He,$t){$t===0&&mr===void 0?or=He:or=Vn(or,He,$t)}),or}function xe(En,Vn){if(En.type==="Feature")Vn(En,0);else if(En.type==="FeatureCollection")for(var mr=0;mr<En.features.length&&Vn(En.features[mr],mr)!==!1;mr++);}function le(En,Vn,mr){var or=mr;return xe(En,function(He,$t){$t===0&&mr===void 0?or=He:or=Vn(or,He,$t)}),or}function Le(En){var Vn=[];return pt(En,function(mr){Vn.push(mr)}),Vn}function Lt(En,Vn){var mr,or,He,$t,nn,ke,Je,er,kt,Te,gt=0,te=En.type==="FeatureCollection",Zt=En.type==="Feature",Ut=te?En.features.length:1;for(mr=0;mr<Ut;mr++){for(ke=te?En.features[mr].geometry:Zt?En.geometry:En,er=te?En.features[mr].properties:Zt?En.properties:{},kt=te?En.features[mr].bbox:Zt?En.bbox:void 0,Te=te?En.features[mr].id:Zt?En.id:void 0,Je=ke?ke.type==="GeometryCollection":!1,nn=Je?ke.geometries.length:1,He=0;He<nn;He++){if($t=Je?ke.geometries[He]:ke,$t===null){if(Vn(null,gt,er,kt,Te)===!1)return!1;continue}switch($t.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Vn($t,gt,er,kt,Te)===!1)return!1;break}case"GeometryCollection":{for(or=0;or<$t.geometries.length;or++)if(Vn($t.geometries[or],gt,er,kt,Te)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}gt++}}function fn(En,Vn,mr){var or=mr;return Lt(En,function(He,$t,nn,ke,Je){$t===0&&mr===void 0?or=He:or=Vn(or,He,$t,nn,ke,Je)}),or}function Nt(En,Vn){Lt(En,function(mr,or,He,$t,nn){var ke=mr===null?null:mr.type;switch(ke){case null:case"Point":case"LineString":case"Polygon":return Vn((0,ne.zL)(mr,He,{bbox:$t,id:nn}),or,0)===!1?!1:void 0}var Je;switch(ke){case"MultiPoint":Je="Point";break;case"MultiLineString":Je="LineString";break;case"MultiPolygon":Je="Polygon";break}for(var er=0;er<mr.coordinates.length;er++){var kt=mr.coordinates[er],Te={type:Je,coordinates:kt};if(Vn((0,ne.zL)(Te,He),or,er)===!1)return!1}})}function Jt(En,Vn,mr){var or=mr;return Nt(En,function(He,$t,nn){$t===0&&nn===0&&mr===void 0?or=He:or=Vn(or,He,$t,nn)}),or}function Ie(En,Vn){Nt(En,function(mr,or,He){var $t=0;if(mr.geometry){var nn=mr.geometry.type;if(!(nn==="Point"||nn==="MultiPoint")){var ke,Je=0,er=0,kt=0;if(pt(mr,function(Te,gt,te,Zt,Ut){if(ke===void 0||or>Je||Zt>er||Ut>kt){ke=Te,Je=or,er=Zt,kt=Ut,$t=0;return}var we=lineString([ke,Te],mr.properties);if(Vn(we,or,He,Ut,$t)===!1)return!1;$t++,ke=Te})===!1)return!1}}})}function fe(En,Vn,mr){var or=mr,He=!1;return Ie(En,function($t,nn,ke,Je,er){He===!1&&mr===void 0?or=$t:or=Vn(or,$t,nn,ke,Je,er),He=!0}),or}function ce(En,Vn){if(!En)throw new Error("geojson is required");Nt(En,function(mr,or,He){if(mr.geometry!==null){var $t=mr.geometry.type,nn=mr.geometry.coordinates;switch($t){case"LineString":if(Vn(mr,or,He,0,0)===!1)return!1;break;case"Polygon":for(var ke=0;ke<nn.length;ke++)if(Vn(lineString(nn[ke],mr.properties),or,He,ke)===!1)return!1;break}}})}function ve(En,Vn,mr){var or=mr;return ce(En,function(He,$t,nn,ke){$t===0&&mr===void 0?or=He:or=Vn(or,He,$t,nn,ke)}),or}function Ze(En,Vn){if(Vn=Vn||{},!isObject(Vn))throw new Error("options is invalid");var mr=Vn.featureIndex||0,or=Vn.multiFeatureIndex||0,He=Vn.geometryIndex||0,$t=Vn.segmentIndex||0,nn=Vn.properties,ke;switch(En.type){case"FeatureCollection":mr<0&&(mr=En.features.length+mr),nn=nn||En.features[mr].properties,ke=En.features[mr].geometry;break;case"Feature":nn=nn||En.properties,ke=En.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ke=En;break;default:throw new Error("geojson is invalid")}if(ke===null)return null;var Je=ke.coordinates;switch(ke.type){case"Point":case"MultiPoint":return null;case"LineString":return $t<0&&($t=Je.length+$t-1),lineString([Je[$t],Je[$t+1]],nn,Vn);case"Polygon":return He<0&&(He=Je.length+He),$t<0&&($t=Je[He].length+$t-1),lineString([Je[He][$t],Je[He][$t+1]],nn,Vn);case"MultiLineString":return or<0&&(or=Je.length+or),$t<0&&($t=Je[or].length+$t-1),lineString([Je[or][$t],Je[or][$t+1]],nn,Vn);case"MultiPolygon":return or<0&&(or=Je.length+or),He<0&&(He=Je[or].length+He),$t<0&&($t=Je[or][He].length-$t-1),lineString([Je[or][He][$t],Je[or][He][$t+1]],nn,Vn)}throw new Error("geojson is invalid")}function Un(En,Vn){if(Vn=Vn||{},!isObject(Vn))throw new Error("options is invalid");var mr=Vn.featureIndex||0,or=Vn.multiFeatureIndex||0,He=Vn.geometryIndex||0,$t=Vn.coordIndex||0,nn=Vn.properties,ke;switch(En.type){case"FeatureCollection":mr<0&&(mr=En.features.length+mr),nn=nn||En.features[mr].properties,ke=En.features[mr].geometry;break;case"Feature":nn=nn||En.properties,ke=En.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ke=En;break;default:throw new Error("geojson is invalid")}if(ke===null)return null;var Je=ke.coordinates;switch(ke.type){case"Point":return point(Je,nn,Vn);case"MultiPoint":return or<0&&(or=Je.length+or),point(Je[or],nn,Vn);case"LineString":return $t<0&&($t=Je.length+$t),point(Je[$t],nn,Vn);case"Polygon":return He<0&&(He=Je.length+He),$t<0&&($t=Je[He].length+$t),point(Je[He][$t],nn,Vn);case"MultiLineString":return or<0&&(or=Je.length+or),$t<0&&($t=Je[or].length+$t),point(Je[or][$t],nn,Vn);case"MultiPolygon":return or<0&&(or=Je.length+or),He<0&&(He=Je[or].length+He),$t<0&&($t=Je[or][He].length-$t),point(Je[or][He][$t],nn,Vn)}throw new Error("geojson is invalid")}},97582:function(br,rr,it){"use strict";it.d(rr,{CR:function(){return Ze},Jh:function(){return Ie},Q_:function(){return kt},XA:function(){return ve},ZT:function(){return pt},_T:function(){return $e},ev:function(){return Vn},mG:function(){return Jt},pi:function(){return R}});var ne=function(ie,_t){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ne,un){Ne.__proto__=un}||function(Ne,un){for(var Qn in un)Object.prototype.hasOwnProperty.call(un,Qn)&&(Ne[Qn]=un[Qn])},ne(ie,_t)};function pt(ie,_t){if(typeof _t!="function"&&_t!==null)throw new TypeError("Class extends value "+String(_t)+" is not a constructor or null");ne(ie,_t);function Ne(){this.constructor=ie}ie.prototype=_t===null?Object.create(_t):(Ne.prototype=_t.prototype,new Ne)}var R=function(){return R=Object.assign||function(_t){for(var Ne,un=1,Qn=arguments.length;un<Qn;un++){Ne=arguments[un];for(var hr in Ne)Object.prototype.hasOwnProperty.call(Ne,hr)&&(_t[hr]=Ne[hr])}return _t},R.apply(this,arguments)};function $e(ie,_t){var Ne={};for(var un in ie)Object.prototype.hasOwnProperty.call(ie,un)&&_t.indexOf(un)<0&&(Ne[un]=ie[un]);if(ie!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Qn=0,un=Object.getOwnPropertySymbols(ie);Qn<un.length;Qn++)_t.indexOf(un[Qn])<0&&Object.prototype.propertyIsEnumerable.call(ie,un[Qn])&&(Ne[un[Qn]]=ie[un[Qn]]);return Ne}function yt(ie,_t,Ne,un){var Qn=arguments.length,hr=Qn<3?_t:un===null?un=Object.getOwnPropertyDescriptor(_t,Ne):un,Er;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")hr=Reflect.decorate(ie,_t,Ne,un);else for(var Ue=ie.length-1;Ue>=0;Ue--)(Er=ie[Ue])&&(hr=(Qn<3?Er(hr):Qn>3?Er(_t,Ne,hr):Er(_t,Ne))||hr);return Qn>3&&hr&&Object.defineProperty(_t,Ne,hr),hr}function xe(ie,_t){return function(Ne,un){_t(Ne,un,ie)}}function le(ie,_t,Ne,un,Qn,hr){function Er(z){if(z!==void 0&&typeof z!="function")throw new TypeError("Function expected");return z}for(var Ue=un.kind,cn=Ue==="getter"?"get":Ue==="setter"?"set":"value",wn=!_t&&ie?un.static?ie:ie.prototype:null,ir=_t||(wn?Object.getOwnPropertyDescriptor(wn,un.name):{}),rn,De=!1,Be=Ne.length-1;Be>=0;Be--){var At={};for(var Bt in un)At[Bt]=Bt==="access"?{}:un[Bt];for(var Bt in un.access)At.access[Bt]=un.access[Bt];At.addInitializer=function(z){if(De)throw new TypeError("Cannot add initializers after decoration has completed");hr.push(Er(z||null))};var Ae=(0,Ne[Be])(Ue==="accessor"?{get:ir.get,set:ir.set}:ir[cn],At);if(Ue==="accessor"){if(Ae===void 0)continue;if(Ae===null||typeof Ae!="object")throw new TypeError("Object expected");(rn=Er(Ae.get))&&(ir.get=rn),(rn=Er(Ae.set))&&(ir.set=rn),(rn=Er(Ae.init))&&Qn.unshift(rn)}else(rn=Er(Ae))&&(Ue==="field"?Qn.unshift(rn):ir[cn]=rn)}wn&&Object.defineProperty(wn,un.name,ir),De=!0}function Le(ie,_t,Ne){for(var un=arguments.length>2,Qn=0;Qn<_t.length;Qn++)Ne=un?_t[Qn].call(ie,Ne):_t[Qn].call(ie);return un?Ne:void 0}function Lt(ie){return typeof ie=="symbol"?ie:"".concat(ie)}function fn(ie,_t,Ne){return typeof _t=="symbol"&&(_t=_t.description?"[".concat(_t.description,"]"):""),Object.defineProperty(ie,"name",{configurable:!0,value:Ne?"".concat(Ne," ",_t):_t})}function Nt(ie,_t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(ie,_t)}function Jt(ie,_t,Ne,un){function Qn(hr){return hr instanceof Ne?hr:new Ne(function(Er){Er(hr)})}return new(Ne||(Ne=Promise))(function(hr,Er){function Ue(ir){try{wn(un.next(ir))}catch(rn){Er(rn)}}function cn(ir){try{wn(un.throw(ir))}catch(rn){Er(rn)}}function wn(ir){ir.done?hr(ir.value):Qn(ir.value).then(Ue,cn)}wn((un=un.apply(ie,_t||[])).next())})}function Ie(ie,_t){var Ne={label:0,sent:function(){if(hr[0]&1)throw hr[1];return hr[1]},trys:[],ops:[]},un,Qn,hr,Er;return Er={next:Ue(0),throw:Ue(1),return:Ue(2)},typeof Symbol=="function"&&(Er[Symbol.iterator]=function(){return this}),Er;function Ue(wn){return function(ir){return cn([wn,ir])}}function cn(wn){if(un)throw new TypeError("Generator is already executing.");for(;Er&&(Er=0,wn[0]&&(Ne=0)),Ne;)try{if(un=1,Qn&&(hr=wn[0]&2?Qn.return:wn[0]?Qn.throw||((hr=Qn.return)&&hr.call(Qn),0):Qn.next)&&!(hr=hr.call(Qn,wn[1])).done)return hr;switch(Qn=0,hr&&(wn=[wn[0]&2,hr.value]),wn[0]){case 0:case 1:hr=wn;break;case 4:return Ne.label++,{value:wn[1],done:!1};case 5:Ne.label++,Qn=wn[1],wn=[0];continue;case 7:wn=Ne.ops.pop(),Ne.trys.pop();continue;default:if(hr=Ne.trys,!(hr=hr.length>0&&hr[hr.length-1])&&(wn[0]===6||wn[0]===2)){Ne=0;continue}if(wn[0]===3&&(!hr||wn[1]>hr[0]&&wn[1]<hr[3])){Ne.label=wn[1];break}if(wn[0]===6&&Ne.label<hr[1]){Ne.label=hr[1],hr=wn;break}if(hr&&Ne.label<hr[2]){Ne.label=hr[2],Ne.ops.push(wn);break}hr[2]&&Ne.ops.pop(),Ne.trys.pop();continue}wn=_t.call(ie,Ne)}catch(ir){wn=[6,ir],Qn=0}finally{un=hr=0}if(wn[0]&5)throw wn[1];return{value:wn[0]?wn[1]:void 0,done:!0}}}var fe=Object.create?function(ie,_t,Ne,un){un===void 0&&(un=Ne);var Qn=Object.getOwnPropertyDescriptor(_t,Ne);(!Qn||("get"in Qn?!_t.__esModule:Qn.writable||Qn.configurable))&&(Qn={enumerable:!0,get:function(){return _t[Ne]}}),Object.defineProperty(ie,un,Qn)}:function(ie,_t,Ne,un){un===void 0&&(un=Ne),ie[un]=_t[Ne]};function ce(ie,_t){for(var Ne in ie)Ne!=="default"&&!Object.prototype.hasOwnProperty.call(_t,Ne)&&fe(_t,ie,Ne)}function ve(ie){var _t=typeof Symbol=="function"&&Symbol.iterator,Ne=_t&&ie[_t],un=0;if(Ne)return Ne.call(ie);if(ie&&typeof ie.length=="number")return{next:function(){return ie&&un>=ie.length&&(ie=void 0),{value:ie&&ie[un++],done:!ie}}};throw new TypeError(_t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ze(ie,_t){var Ne=typeof Symbol=="function"&&ie[Symbol.iterator];if(!Ne)return ie;var un=Ne.call(ie),Qn,hr=[],Er;try{for(;(_t===void 0||_t-- >0)&&!(Qn=un.next()).done;)hr.push(Qn.value)}catch(Ue){Er={error:Ue}}finally{try{Qn&&!Qn.done&&(Ne=un.return)&&Ne.call(un)}finally{if(Er)throw Er.error}}return hr}function Un(){for(var ie=[],_t=0;_t<arguments.length;_t++)ie=ie.concat(Ze(arguments[_t]));return ie}function En(){for(var ie=0,_t=0,Ne=arguments.length;_t<Ne;_t++)ie+=arguments[_t].length;for(var un=Array(ie),Qn=0,_t=0;_t<Ne;_t++)for(var hr=arguments[_t],Er=0,Ue=hr.length;Er<Ue;Er++,Qn++)un[Qn]=hr[Er];return un}function Vn(ie,_t,Ne){if(Ne||arguments.length===2)for(var un=0,Qn=_t.length,hr;un<Qn;un++)(hr||!(un in _t))&&(hr||(hr=Array.prototype.slice.call(_t,0,un)),hr[un]=_t[un]);return ie.concat(hr||Array.prototype.slice.call(_t))}function mr(ie){return this instanceof mr?(this.v=ie,this):new mr(ie)}function or(ie,_t,Ne){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var un=Ne.apply(ie,_t||[]),Qn,hr=[];return Qn={},Ue("next"),Ue("throw"),Ue("return",Er),Qn[Symbol.asyncIterator]=function(){return this},Qn;function Er(Be){return function(At){return Promise.resolve(At).then(Be,rn)}}function Ue(Be,At){un[Be]&&(Qn[Be]=function(Bt){return new Promise(function(Ae,z){hr.push([Be,Bt,Ae,z])>1||cn(Be,Bt)})},At&&(Qn[Be]=At(Qn[Be])))}function cn(Be,At){try{wn(un[Be](At))}catch(Bt){De(hr[0][3],Bt)}}function wn(Be){Be.value instanceof mr?Promise.resolve(Be.value.v).then(ir,rn):De(hr[0][2],Be)}function ir(Be){cn("next",Be)}function rn(Be){cn("throw",Be)}function De(Be,At){Be(At),hr.shift(),hr.length&&cn(hr[0][0],hr[0][1])}}function He(ie){var _t,Ne;return _t={},un("next"),un("throw",function(Qn){throw Qn}),un("return"),_t[Symbol.iterator]=function(){return this},_t;function un(Qn,hr){_t[Qn]=ie[Qn]?function(Er){return(Ne=!Ne)?{value:mr(ie[Qn](Er)),done:!1}:hr?hr(Er):Er}:hr}}function $t(ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _t=ie[Symbol.asyncIterator],Ne;return _t?_t.call(ie):(ie=typeof ve=="function"?ve(ie):ie[Symbol.iterator](),Ne={},un("next"),un("throw"),un("return"),Ne[Symbol.asyncIterator]=function(){return this},Ne);function un(hr){Ne[hr]=ie[hr]&&function(Er){return new Promise(function(Ue,cn){Er=ie[hr](Er),Qn(Ue,cn,Er.done,Er.value)})}}function Qn(hr,Er,Ue,cn){Promise.resolve(cn).then(function(wn){hr({value:wn,done:Ue})},Er)}}function nn(ie,_t){return Object.defineProperty?Object.defineProperty(ie,"raw",{value:_t}):ie.raw=_t,ie}var ke=Object.create?function(ie,_t){Object.defineProperty(ie,"default",{enumerable:!0,value:_t})}:function(ie,_t){ie.default=_t};function Je(ie){if(ie&&ie.__esModule)return ie;var _t={};if(ie!=null)for(var Ne in ie)Ne!=="default"&&Object.prototype.hasOwnProperty.call(ie,Ne)&&fe(_t,ie,Ne);return ke(_t,ie),_t}function er(ie){return ie&&ie.__esModule?ie:{default:ie}}function kt(ie,_t,Ne,un){if(Ne==="a"&&!un)throw new TypeError("Private accessor was defined without a getter");if(typeof _t=="function"?ie!==_t||!un:!_t.has(ie))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Ne==="m"?un:Ne==="a"?un.call(ie):un?un.value:_t.get(ie)}function Te(ie,_t,Ne,un,Qn){if(un==="m")throw new TypeError("Private method is not writable");if(un==="a"&&!Qn)throw new TypeError("Private accessor was defined without a setter");if(typeof _t=="function"?ie!==_t||!Qn:!_t.has(ie))throw new TypeError("Cannot write private member to an object whose class did not declare it");return un==="a"?Qn.call(ie,Ne):Qn?Qn.value=Ne:_t.set(ie,Ne),Ne}function gt(ie,_t){if(_t===null||typeof _t!="object"&&typeof _t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof ie=="function"?_t===ie:ie.has(_t)}function te(ie,_t,Ne){if(_t!=null){if(typeof _t!="object"&&typeof _t!="function")throw new TypeError("Object expected.");var un,Qn;if(Ne){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");un=_t[Symbol.asyncDispose]}if(un===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");un=_t[Symbol.dispose],Ne&&(Qn=un)}if(typeof un!="function")throw new TypeError("Object not disposable.");Qn&&(un=function(){try{Qn.call(this)}catch(hr){return Promise.reject(hr)}}),ie.stack.push({value:_t,dispose:un,async:Ne})}else Ne&&ie.stack.push({async:!0});return _t}var Zt=typeof SuppressedError=="function"?SuppressedError:function(ie,_t,Ne){var un=new Error(Ne);return un.name="SuppressedError",un.error=ie,un.suppressed=_t,un};function Ut(ie){function _t(un){ie.error=ie.hasError?new Zt(un,ie.error,"An error was suppressed during disposal."):un,ie.hasError=!0}function Ne(){for(;ie.stack.length;){var un=ie.stack.pop();try{var Qn=un.dispose&&un.dispose.call(un.value);if(un.async)return Promise.resolve(Qn).then(Ne,function(hr){return _t(hr),Ne()})}catch(hr){_t(hr)}}if(ie.hasError)throw ie.error}return Ne()}var we={__extends:pt,__assign:R,__rest:$e,__decorate:yt,__param:xe,__metadata:Nt,__awaiter:Jt,__generator:Ie,__createBinding:fe,__exportStar:ce,__values:ve,__read:Ze,__spread:Un,__spreadArrays:En,__spreadArray:Vn,__await:mr,__asyncGenerator:or,__asyncDelegator:He,__asyncValues:$t,__makeTemplateObject:nn,__importStar:Je,__importDefault:er,__classPrivateFieldGet:kt,__classPrivateFieldSet:Te,__classPrivateFieldIn:gt,__addDisposableResource:te,__disposeResources:Ut}}}]);
}());