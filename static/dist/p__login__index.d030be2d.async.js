"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{92594:function(ct,ge,t){t.r(ge),t.d(ge,{default:function(){return lt}});var Be=t(15009),A=t.n(Be),Ie=t(97857),z=t.n(Ie),Te=t(99289),Y=t.n(Te),be=t(5574),$=t.n(be),Re=t(56034),ie=t(45360),Ae=t(42075),he=t(96365),me=t(14726),$e=t(75081),s=t(67294),ee=t(33067),e=t(85893),De=function(r){var i=r.value,C=i===void 0?{}:i,Z=r.onChange,d=r.reload,x=d===void 0?0:d,B=r.placeholder,D=B===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":B,T=(0,s.useState)(""),n=$()(T,2),h=n[0],k=n[1],w=(0,s.useState)(""),P=$()(w,2),G=P[0],K=P[1],N=(0,s.useState)(""),m=$()(N,2),f=m[0],L=m[1],M=(0,s.useState)(!1),I=$()(M,2),H=I[0],b=I[1],v=function(){var O=Y()(A()().mark(function E(){var S;return A()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,(0,ee.xx)({key:G});case 3:if(S=g.sent,S.code!==0){g.next=6;break}return g.abrupt("return",S.data);case 6:g.next=12;break;case 8:return g.prev=8,g.t0=g.catch(0),ie.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),g.abrupt("return",[]);case 12:return ie.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),g.abrupt("return",[]);case 14:case"end":return g.stop()}},E,null,[[0,8]])}));return function(){return O.apply(this,arguments)}}(),c=function(E){Z&&Z(z()(z()({captchaCode:h,captchaKey:G},C),E))},p=function(E){b(!0),v().then(function(S){b(!1),K(S.key),L(S.img),E&&c({captchaKey:S.key})})};(0,s.useEffect)(function(){p(!1)},[]),(0,s.useEffect)(function(){x>0&&p(!0)},[x]);var u=function(E){var S=E.target.value||"";S&&k(S),c({captchaCode:S})},j=function(){p(!0)};return(0,e.jsxs)(Ae.Z,{children:[(0,e.jsx)(he.Z,{prefix:(0,e.jsx)(Re.Z,{}),size:"large",placeholder:D,onChange:u}),(0,e.jsx)(me.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)($e.Z,{spinning:H,size:"small",children:(0,e.jsx)("img",{src:f,onClick:j})})})]})},se=De,Ne=t(99702),fe=t(87547),pe=t(94149),Le=t(84517),le=t(5966),te=t(34994),Ee=t(97462),l=t(1413),ne=t(74165),Se=t(15861),oe=t(45987),ue=t(97685),ze=t(8232),xe=t(90789),ke=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],we=s.forwardRef(function(a,r){var i=ze.Z.useFormInstance(),C=(0,s.useState)(a.countDown||60),Z=(0,ue.Z)(C,2),d=Z[0],x=Z[1],B=(0,s.useState)(!1),D=(0,ue.Z)(B,2),T=D[0],n=D[1],h=(0,s.useState)(),k=(0,ue.Z)(h,2),w=k[0],P=k[1],G=a.rules,K=a.name,N=a.phoneName,m=a.fieldProps,f=a.onTiming,L=a.captchaTextRender,M=L===void 0?function(v,c){return v?"".concat(c," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:L,I=a.captchaProps,H=(0,oe.Z)(a,ke),b=function(){var v=(0,Se.Z)((0,ne.Z)().mark(function c(p){return(0,ne.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,P(!0),j.next=4,H.onGetCaptcha(p);case 4:P(!1),n(!0),j.next=13;break;case 8:j.prev=8,j.t0=j.catch(0),n(!1),P(!1),console.log(j.t0);case 13:case"end":return j.stop()}},c,null,[[0,8]])}));return function(p){return v.apply(this,arguments)}}();return(0,s.useImperativeHandle)(r,function(){return{startTiming:function(){return n(!0)},endTiming:function(){return n(!1)}}}),(0,s.useEffect)(function(){var v=0,c=a.countDown;return T&&(v=window.setInterval(function(){x(function(p){return p<=1?(n(!1),clearInterval(v),c||60):p-1})},1e3)),function(){return clearInterval(v)}},[T]),(0,s.useEffect)(function(){f&&f(d)},[d,f]),(0,e.jsxs)("div",{style:(0,l.Z)((0,l.Z)({},m==null?void 0:m.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(he.Z,(0,l.Z)((0,l.Z)({},m),{},{style:(0,l.Z)({flex:1,transition:"width .3s",marginRight:8},m==null?void 0:m.style)})),(0,e.jsx)(me.ZP,(0,l.Z)((0,l.Z)({style:{display:"block"},disabled:T,loading:w},I),{},{onClick:(0,Se.Z)((0,ne.Z)().mark(function v(){var c;return(0,ne.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,!N){u.next=9;break}return u.next=4,i.validateFields([N].flat(1));case 4:return c=i.getFieldValue([N].flat(1)),u.next=7,b(c);case 7:u.next=11;break;case 9:return u.next=11,b("");case 11:u.next=16;break;case 13:u.prev=13,u.t0=u.catch(0),console.log(u.t0);case 16:case"end":return u.stop()}},v,null,[[0,13]])})),children:M(T,d)}))]})}),Ge=(0,xe.G)(we),Me=Ge,He=t(10915),We=t(28459),Ke=t(93967),Oe=t.n(Ke),ce=t(4942),Ue=t(98082),Ve=function(r){return(0,ce.Z)((0,ce.Z)({},r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,ce.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function Xe(a){return(0,Ue.Xj)("LoginForm",function(r){var i=(0,l.Z)((0,l.Z)({},r),{},{componentCls:".".concat(a)});return[Ve(i)]})}var Ye=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function Je(a){var r,i=a.logo,C=a.message,Z=a.contentStyle,d=a.title,x=a.subTitle,B=a.actions,D=a.children,T=a.containerStyle,n=a.otherStyle,h=(0,oe.Z)(a,Ye),k=(0,He.YB)(),w=h.submitter===!1?!1:(0,l.Z)((0,l.Z)({searchConfig:{submitText:k.getMessage("loginForm.submitText","\u767B\u5F55")}},h.submitter),{},{submitButtonProps:(0,l.Z)({size:"large",style:{width:"100%"}},(r=h.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function(I,H){var b,v=H.pop();if(typeof(h==null||(b=h.submitter)===null||b===void 0?void 0:b.render)=="function"){var c,p;return h==null||(c=h.submitter)===null||c===void 0||(p=c.render)===null||p===void 0?void 0:p.call(c,I,H)}return v}}),P=(0,s.useContext)(We.ZP.ConfigContext),G=P.getPrefixCls("pro-form-login"),K=Xe(G),N=K.wrapSSR,m=K.hashId,f=function(I){return"".concat(G,"-").concat(I," ").concat(m)},L=(0,s.useMemo)(function(){return i?typeof i=="string"?(0,e.jsx)("img",{src:i}):i:null},[i]);return N((0,e.jsxs)("div",{className:Oe()(f("container"),m),style:T,children:[(0,e.jsxs)("div",{className:"".concat(f("top")," ").concat(m).trim(),children:[d||L?(0,e.jsxs)("div",{className:"".concat(f("header")),children:[L?(0,e.jsx)("span",{className:f("logo"),children:L}):null,d?(0,e.jsx)("span",{className:f("title"),children:d}):null]}):null,x?(0,e.jsx)("div",{className:f("desc"),children:x}):null]}),(0,e.jsxs)("div",{className:f("main"),style:(0,l.Z)({width:328},Z),children:[(0,e.jsxs)(te.A,(0,l.Z)((0,l.Z)({isKeyPressSubmit:!0},h),{},{submitter:w,children:[C,D]})),B?(0,e.jsx)("div",{className:f("main-other"),style:n,children:B}):null]})]}))}var ye=t(22270),Qe=t(84567),Ce=t(61137),qe=["options","fieldProps","proFieldProps","valueEnum"],_e=s.forwardRef(function(a,r){var i=a.options,C=a.fieldProps,Z=a.proFieldProps,d=a.valueEnum,x=(0,oe.Z)(a,qe);return(0,e.jsx)(Ce.Z,(0,l.Z)({ref:r,valueType:"checkbox",valueEnum:(0,ye.h)(d,void 0),fieldProps:(0,l.Z)({options:i},C),lightProps:(0,l.Z)({labelFormatter:function(){return(0,e.jsx)(Ce.Z,(0,l.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,ye.h)(d,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,l.Z)({options:i},C),proFieldProps:Z},x))}},x.lightProps),proFieldProps:Z},x))}),et=s.forwardRef(function(a,r){var i=a.fieldProps,C=a.children;return(0,e.jsx)(Qe.Z,(0,l.Z)((0,l.Z)({ref:r},i),{},{children:C}))}),tt=(0,xe.G)(et,{valuePropName:"checked"}),Ze=tt;Ze.Group=_e;var nt=Ze,V=t(7837),at=t(31418),rt=t(48096),it=t(73935),J={container:"container___ldtvs",lang:"lang___qrAB8",content:"content___wB3e_","ant-pro-form-login-container":"ant-pro-form-login-container___Z1bnX",icon:"icon___CBYA8"},dt=function(r){var i=r.content;return _jsx(Alert,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},st=function(){var r,i,C,Z,d,x,B,D,T=(0,V.useModel)("@@initialState"),n=T.initialState,h=T.setInitialState,k=(0,s.useState)(0),w=$()(k,2),P=w[0],G=w[1],K=(0,s.useState)(0),N=$()(K,2),m=N[0],f=N[1],L=(0,s.useState)(!1),M=$()(L,2),I=M[0],H=M[1],b=(0,V.useSearchParams)(),v=$()(b,1),c=v[0],p=ie.ZP.useMessage(),u=$()(p,2),j=u[0],O=u[1],E=function(){var W=Y()(A()().mark(function R(U){return A()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,ee.ZP.post("login",{data:z()(z()({},U),{},{loginType:Q}),duration:1,msgcls:function(){var q=Y()(A()().mark(function X(F){return A()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:F.code?(Q=="phone"&&F.code==3&&f(P+1),I&&G(P+1),(F.code==3||F.code==2)&&H(!0)):F.code||(U.autoLogin?localStorage.setItem("Sa-Remember","1"):localStorage.setItem("Sa-Remember","0"),localStorage.setItem(ee.lH,F.data.access_token),(0,it.flushSync)(function(){h(function(o){return z()(z()({},o),{},{currentUser:F.data.userinfo,settings:z()(z()({},o==null?void 0:o.settings),F.data.setting)})}).then(function(){var o,Fe="/";if(F.data.userinfo.redirect)V.history.push(F.data.userinfo.redirect);else if(n!=null&&(o=n.settings)!==null&&o!==void 0&&o.baseurl){var ve;V.history.push(Fe.replace(n==null||(ve=n.settings)===null||ve===void 0?void 0:ve.baseurl,"/"))}else V.history.push(Fe)})}));case 1:case"end":return re.stop()}},X)}));function _(X){return q.apply(this,arguments)}return _}()});case 2:return y.abrupt("return");case 3:case"end":return y.stop()}},R)}));return function(U){return W.apply(this,arguments)}}(),S={},je=(0,s.useState)(n==null||(r=n.settings)===null||r===void 0?void 0:r.loginTypeDefault),g=$()(je,2),Q=g[0],ot=g[1];n!=null&&(i=n.settings)!==null&&i!==void 0&&i.loginBgImgage&&(S.backgroundImage='url("'+(n==null?void 0:n.settings.loginBgImgage)+'")');var Pe=(0,s.useRef)(),ut=[{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"phone",children:Q!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(le.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(fe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"},{pattern:/^1\d{10}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"}]}),(0,e.jsx)(te.A.Item,{name:"captchaPhone",rules:[{required:!0,message:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(se,{reload:m,placeholder:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"})}),(0,e.jsx)(Ee.Z,{name:["captchaPhone"],children:function(R){var U=R.captchaPhone;return(0,e.jsx)(Me,{fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(y,q){return y?"".concat(q," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"mobilecode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"}],onGetCaptcha:function(){var ae=Y()(A()().mark(function y(q){var _,X,F,de;return A()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(_=Pe.current)===null||_===void 0?void 0:_.validateFields(["captcha"]);case 3:o.next=8;break;case 5:throw o.prev=5,o.t0=o.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return o.next=10,ee.ZP.post("sms",{data:{mobile:q,captcha:U}});case 10:if(X=o.sent,F=X.code,de=X.msg,!F){o.next=15;break}throw new Error(de);case 15:case"end":return o.stop()}},y,null,[[0,5]])}));return function(y){return ae.apply(this,arguments)}}()})}}),I&&(0,e.jsx)(te.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(se,{reload:P})})]})},{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"password",children:Q!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(le.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(fe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,e.jsx)(le.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),I&&(0,e.jsx)(te.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(se,{reload:P})})]})}];return(0,e.jsx)(at.Z,{children:(0,e.jsxs)("div",{className:J.container,style:z()({},S),children:[(0,e.jsx)(V.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",n==null||(C=n.settings)===null||C===void 0?void 0:C.title]})}),(0,e.jsx)("div",{className:J.content,style:S.backgroundImage?{}:{padding:0},children:(0,e.jsxs)(Le.ZP,{style:{margin:"0px auto",padding:"20px 0",background:S.backgroundImage?"#fff":"none"},children:[O,(0,e.jsxs)(Je,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:Pe,logo:n==null||(Z=n.settings)===null||Z===void 0?void 0:Z.logo,title:n==null||(d=n.settings)===null||d===void 0?void 0:d.title,subTitle:n!=null&&(x=n.settings)!==null&&x!==void 0&&x.subtitle?(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:n==null||(B=n.settings)===null||B===void 0?void 0:B.subtitle}}):null,initialValues:{autoLogin:!0},onFinish:function(){var W=Y()(A()().mark(function R(U){return A()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,E(U);case 2:case"end":return y.stop()}},R)}));return function(R){return W.apply(this,arguments)}}(),children:[(0,e.jsx)(rt.Z,{centered:!0,activeKey:Q,onChange:function(R){return ot(R)},items:n==null||(D=n.settings.loginType)===null||D===void 0?void 0:D.map(function(W){return ut.find(function(R){return R.key==W})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(nt,{noStyle:!0,name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){j.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:"\u5FD8\u8BB0\u5BC6\u7801"})]})]})]})}),(0,e.jsx)(Ne.Z,{})]})})},lt=st}}]);
