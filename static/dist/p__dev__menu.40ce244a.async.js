"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[833],{33579:function(Ze,ee,a){a.r(ee),a.d(ee,{default:function(){return Se}});var te=a(57288),re=a(32250),de=a(85175),se=a(71965),U=a(42075),s=a(67294),ue=a(9783),fe=a.n(ue),ce=a(97857),G=a.n(ce),ve=a(19632),K=a.n(ve),me=a(5574),b=a.n(me),W=a(72644),he=a(82061),ge=a(51042),pe=a(63783),Y=a(83062),ne=a(66309),le=a(96365),xe=a(9361),ae=a(70145),oe=a(21352),M=a(60887),Q=a(45587),t=a(85893),Ce=function(e){var r=e.model,C=e.setOpen,n=e.actionRef,f=e.contentRender,u=(0,s.useRef)();return(0,t.jsx)(W.T,{msgcls:function(c){var S=c.code;if(!S){var v;console.log("loading dispear here"),C(!1),(v=n.current)===null||v===void 0||v.reload();return}},formColumns:["id",{dataIndex:"other_config",valueType:"jsonEditor",title:"\u914D\u7F6E\u4FE1\u606F",fieldProps:{height:700}}],formRef:u,paramExtra:{id:r==null?void 0:r.id},url:"dev/menu/show",postUrl:"dev/menu/otherConfig",showTabs:!1,submitter:"dom",formProps:{contentRender:f,submitter:{searchConfig:{resetText:"\u53D6\u6D88"},resetButtonProps:{onClick:function(){C(!1)}}}},align:"left",dataId:r.id,pageType:"drawer"})},ye=function(g){var e=g.model,r=g.setOpen,C=g.actionRef,n=g.contentRender,f=(0,s.useState)(),u=b()(f,2),o=u[0],c=u[1],S=(0,s.useContext)(ae.r),v=S.setting;(0,s.useEffect)(function(){c((0,oe.YK)({model_id:e.admin_model_id,dev:v==null?void 0:v.dev}))},[]);var R=(0,s.useState)([]),y=b()(R,2),j=y[0],m=y[1],p=(0,s.useState)([]),x=b()(p,2),P=x[0],D=x[1],Z=(0,s.useState)("0"),k=b()(Z,2),O=k[0],A=k[1],E=(0,s.useRef)();(0,s.useEffect)(function(){w(P)},[P]);var w=function(d){var l=d==null?void 0:d.map(function(i,h){if(i.hidden)return null;var I={dataIndex:"form_config".concat(h==0?"":h),valueType:"saFormList",columns:K()(o)};return{title:i.title,formColumns:h==0?["id",I]:[I]}}).filter(function(i){return i});m(l),D(d)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(U.Z,{children:[(0,t.jsx)(be,{tags:P,onChange:function(d){w(d)},formRef:E}),(0,t.jsx)(Y.Z,{title:"\u6E05\u7A7A\u5F53\u524Dtab\u7684\u503C",children:(0,t.jsx)(he.Z,{onClick:function(){var d,l="form_config"+(O=="0"?"":O);(d=E.current)===null||d===void 0||d.setFieldValue(l,[])}})})]}),(0,t.jsx)("br",{}),(0,t.jsx)(W.T,{onTabChange:function(d){A(d)},beforeGet:function(d){var l,i=(l=d.admin_model)===null||l===void 0?void 0:l.columns;d.form_config||(d.form_config=i.map(function(h){return{columns:[{key:h.name}]}})),d.admin_model&&D(d.tabs)},msgcls:function(d){var l=d.code;if(!l){var i;console.log("loading dispear here"),r(!1),(i=C.current)===null||i===void 0||i.reload();return}},tabs:j,formRef:E,paramExtra:{id:e==null?void 0:e.id},postExtra:{id:e==null?void 0:e.id,tags:P},url:"dev/menu/show",postUrl:"dev/menu/formConfig",showTabs:!0,submitter:"dom",formProps:{contentRender:n,submitter:{searchConfig:{resetText:"\u53D6\u6D88"},resetButtonProps:{onClick:function(){r(!1)}}}},align:"left",dataId:e.id,pageType:"drawer",grid:!1,devEnable:!1})]})},Te=function(e){var r,C=e.tag,n=C===void 0?{title:"\u57FA\u7840\u4FE1\u606F"}:C,f=e.index,u=e.handleClose,o=e.setTag,c=(0,Q.nB)({id:n.title}),S=c.listeners,v=c.setNodeRef,R=c.setActivatorNodeRef,y=c.transform,j=c.transition,m=c.isDragging,p=(0,s.useState)(!1),x=b()(p,2),P=x[0],D=x[1],Z={cursor:"move",transition:"unset",display:"inline-block"},k=y?G()(G()({},Z),{},{transform:"translate3d(".concat(y.x,"px, ").concat(y.y,"px, 0)"),transition:m?"unset":j}):Z,O=(0,s.useState)(""),A=b()(O,2),E=A[0],w=A[1],T=(n==null||(r=n.title)===null||r===void 0?void 0:r.length)>20,d=(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ne.Z,{closable:f!==0,style:{userSelect:"none"},onClose:function(i){u(n),i.preventDefault()},children:(0,t.jsx)("span",{onDoubleClick:function(i){f!==-1&&(w(n.title),D(!0),i.preventDefault())},children:T?"".concat(n.title.slice(0,20),"..."):n.title})},n==null?void 0:n.title)});return(0,t.jsx)("div",G()(G()({style:k,ref:v},S),{},{children:n.hidden?null:P?(0,t.jsx)(le.Z,{size:"small",style:{width:"auto",verticalAlign:"top"},value:E,onChange:function(i){w(i.target.value)},onBlur:function(){D(!1),o(E,f)},onPressEnter:function(){D(!1),o(E,f)}},n.title):T?(0,t.jsx)(Y.Z,{title:n.title,children:d},n.title):d}))},be=function(e){var r=e.formRef,C=xe.Z.useToken(),n=C.token,f=(0,s.useState)([]),u=b()(f,2),o=u[0],c=u[1];(0,s.useEffect)(function(){e.tags&&c(e.tags)},[e.tags]);var S=(0,s.useState)(!1),v=b()(S,2),R=v[0],y=v[1],j=(0,s.useState)(""),m=b()(j,2),p=m[0],x=m[1],P=(0,s.useRef)(null),D=(0,s.useRef)(null);(0,s.useEffect)(function(){if(R){var l;(l=P.current)===null||l===void 0||l.focus()}},[R]),(0,s.useEffect)(function(){var l;(l=D.current)===null||l===void 0||l.focus()},[p]);var Z=(0,M.Dy)((0,M.VT)(M.we,{activationConstraint:{distance:10}})),k=function(i){var h=i.active,I=i.over;if(I&&h.id!==I.id){var F,B=function(H,J,X,$){var V=H.findIndex(function(_){return _.title===h.id}),z=H.findIndex(function(_){return _.title===I.id}),ie=r==null||(J=r.current)===null||J===void 0?void 0:J.getFieldsValue(!0),je="form_config"+(V||""),Pe="form_config"+(z||""),Ee=r==null||(X=r.current)===null||X===void 0?void 0:X.getFieldValue(je),q=fe()({},Pe,Ee);if(V>z)for(var L=z+1;L<=V;L++){var Re="form_config"+(L||""),De="form_config"+(L-1?L-1:"");q[Re]=ie[De]}else for(var N=V;N<z;N++){var we="form_config"+(N||""),Fe="form_config"+(N+1?N+1:"");q[we]=ie[Fe]}return r==null||($=r.current)===null||$===void 0||$.setFieldsValue(G()({},q)),(0,Q.Rp)(H,V,z)}(o);c(B),(F=e.onChange)===null||F===void 0||F.call(e,B)}},O=function(i){var h,I=o==null?void 0:o.findIndex(function(F){return F.title==i.title});o[I].hidden=!0,c(o),(h=e.onChange)===null||h===void 0||h.call(e,o)},A=function(){y(!0)},E=function(i){x(i.target.value)},w=function(){if(p&&o.findIndex(function(h){return h.title==p})===-1){var i;c([].concat(K()(o),[{title:p}])),(i=e.onChange)===null||i===void 0||i.call(e,[].concat(K()(o),[{title:p}]))}y(!1),x("")},T={width:78,verticalAlign:"top"},d={background:n.colorBgContainer,borderStyle:"dashed"};return(0,t.jsxs)(U.Z,{size:[0,8],wrap:!0,children:[(0,t.jsx)(U.Z,{size:[0,8],wrap:!0,children:(0,t.jsx)(M.LB,{sensors:Z,onDragEnd:k,collisionDetection:M.pE,children:(0,t.jsx)(Q.Fo,{items:o.map(function(l){return l.title}),strategy:Q.PG,children:o==null?void 0:o.map(function(l,i){return(0,t.jsx)(Te,{tag:l,index:i,handleClose:O,setTag:function(I,F){var B;o[F].title=I,c(o),(B=e.onChange)===null||B===void 0||B.call(e,K()(o))}},l.title)})})})}),R?(0,t.jsx)(le.Z,{ref:P,type:"text",size:"small",style:T,value:p,onChange:E,onBlur:w,onPressEnter:w}):(0,t.jsxs)(ne.Z,{style:d,onClick:A,children:[(0,t.jsx)(ge.Z,{})," new Tab"]}),(0,t.jsx)(Y.Z,{title:"\u5220\u9664\u6216\u62D6\u62FD\u6392\u5E8Ftab \u8868\u5355\u6E32\u67D3\u53EF\u80FD\u9700\u8981\u4E00\u70B9\u65F6\u95F4",children:(0,t.jsx)(pe.Z,{})})]})},Ie=function(g){var e=g.model,r=g.setOpen,C=g.actionRef,n=g.contentRender,f=(0,s.useState)(),u=b()(f,2),o=u[0],c=u[1],S=(0,s.useContext)(ae.r),v=S.setting;(0,s.useEffect)(function(){c((0,oe.dm)({model_id:e.admin_model_id,dev:v==null?void 0:v.dev}))},[]);var R=function(m){if(m.admin_model){var p=m.admin_model.columns;m.table_config||(m.table_config=p.map(function(x){return{key:x.name}}),m.table_config.push({key:"option"}))}},y=(0,s.useRef)();return(0,t.jsx)(W.T,{beforeGet:function(m){R(m)},msgcls:function(m){var p=m.code;if(!p){var x;console.log("loading dispear here"),r(!1),(x=C.current)===null||x===void 0||x.reload();return}},formColumns:["id",{dataIndex:"table_config",valueType:"saFormList",fieldProps:{showtype:"table"},columns:o}],formRef:y,paramExtra:{id:e==null?void 0:e.id},url:"dev/menu/show",postUrl:"dev/menu/tableConfig",showTabs:!1,formProps:{contentRender:n,submitter:{searchConfig:{resetText:"\u53D6\u6D88"},resetButtonProps:{onClick:function(){r(!1)}}}},align:"left",dataId:e.id,pageType:"drawer",grid:!1,devEnable:!1})},Se=function(){var g=function(n){var f=[];for(var u in n)f.push({label:n[u],value:u});return f},e=(0,s.useRef)(),r=function(n){return[{title:"\u83DC\u5355\u540D\u79F0",dataIndex:"title2",key:"title2",render:function(u,o){return(0,t.jsxs)(U.Z,{children:[te.q0[o.icon],o.title]})}},{title:"path",dataIndex:"path",key:"path"},"displayorder",{title:"\u914D\u7F6E",dataIndex:"type",valueType:"customerColumn",search:!1,readonly:!0,width:300,fieldProps:{items:[{domtype:"button",modal:{title:'{{record.title + " - \u5217\u8868\u914D\u7F6E"}}',drawerProps:{width:1600},childrenRender:function(u){return(0,t.jsx)(Ie,{model:u,actionRef:e})}},action:"drawer",btn:{text:"\u5217\u8868",size:"small"}},{domtype:"button",modal:{title:'{{record.title + " - \u8868\u5355\u914D\u7F6E"}}',drawerProps:{width:1310},childrenRender:function(u){return(0,t.jsx)(ye,{model:u,actionRef:e})}},action:"drawer",btn:{text:"\u8868\u5355",size:"small"}},{domtype:"button",modal:{title:'{{record.title + " - \u5176\u5B83\u914D\u7F6E"}}',drawerProps:{width:1600},childrenRender:function(u){return(0,t.jsx)(Ce,{model:{id:u==null?void 0:u.id},actionRef:e})}},action:"drawer",btn:{text:"\u5176\u5B83",size:"small"}},{domtype:"button",modal:{msg:"\u8BF7\u9009\u62E9\u590D\u5236\u5230",formColumns:[{dataIndex:"toid",width:"md",title:"\u590D\u5236\u5230",valueType:"treeSelect",fieldProps:{options:n==null?void 0:n.menus,treeLine:{showLeafIcon:!0},treeDefaultExpandAll:!0}}]},request:{url:"dev/menu/copyTo"},action:"confirmForm",btn:{text:"",size:"small",icon:(0,t.jsx)(de.Z,{}),tooltip:"\u590D\u5236"}},{domtype:"button",modal:{msg:"\u8BF7\u9009\u62E9\u79FB\u52A8\u5230",formColumns:[{dataIndex:"toid",width:"md",title:"\u79FB\u52A8\u5230",valueType:"treeSelect",fieldProps:{options:n==null?void 0:n.menus,treeLine:{showLeafIcon:!0},treeDefaultExpandAll:!0}}]},request:{postUrl:"dev/menu/moveTo"},action:"confirmForm",btn:{text:"",size:"small",icon:(0,t.jsx)(se.Z,{}),tooltip:"\u79FB\u52A8\u81F3"}}]}},{dataIndex:"state",title:"\u72B6\u6001",valueType:"customerColumn",search:!1,readonly:!0,fieldProps:{items:[{domtype:"text",action:"dropdown",request:{url:"{{url}}",modelName:"state",fieldNames:"value,label",data:{actype:"state"}}}]}},{dataIndex:"status",title:"\u663E\u793A",valueType:"select",search:!1,valueEnum:[{text:"\u9690\u85CF",status:"error"},{text:"\u663E\u793A",status:"success"}]},"option"]};return(0,t.jsx)(re.Z,{name:"\u83DC\u5355",title:!1,actionRef:e,table_menu_key:"state",table_menu_all:!1,tableColumns:r,toolBarButton:[{valueType:"export"},{valueType:"import",uploadProps:{accept:".sql"}},{valueType:"toolbar",fieldProps:{items:[{domtype:"button",btn:{text:"\u751F\u6210\u914D\u7F6E"},action:"confirm",request:{url:"dev/menu/remenu"},modal:{msg:"\u786E\u5B9A\u8981\u91CD\u65B0\u751F\u6210\u914D\u7F6E\u5417\uFF1F"}}]}}],formColumns:[{valueType:"group",columns:[{title:"\u83DC\u5355\u540D\u79F0",dataIndex:"title",width:"md",fieldProps:{placeholder:"\u4E3A\u7A7A\u65F6\u83DC\u5355\u4F1A\u9690\u85CF"}},{title:"path",dataIndex:"path",width:"sm",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u8DEF\u5F84"}},{title:"\u56FE\u6807",dataIndex:"icon",valueType:"select",width:"sm",tooltip:"\u9700\u8981\u5148\u5C06\u8981\u4F7F\u7528\u5230\u7684\u56FE\u6807\u914D\u7F6E\u5230iconmap\u4E2D\u624D\u80FD\u9009\u62E9",fieldProps:{placeholder:"\u8BF7\u9009\u62E9\u56FE\u6807",options:g(te.q0)}},{title:"\u83DC\u5355\u7C7B\u578B",dataIndex:"type",valueType:"select",requestDataName:"types",width:"sm"},{title:"\u65B0\u589E\u6309\u94AE",dataIndex:"addable",valueType:"switch",tooltip:"\u5F00\u542F\u540E\u5217\u8868\u4E2D\u65E0\u65B0\u5EFA\u6309\u94AE",fieldProps:{checkedChildren:"\u663E\u793A",unCheckedChildren:"\u9690\u85CF",defaultChecked:!0}},{title:"form\u662F\u5426\u53EF\u7F16\u8F91",dataIndex:"editable",valueType:"switch",tooltip:"\u5F00\u542F\u540E\u8868\u5355\u65E0\u63D0\u4EA4\u6309\u94AE",fieldProps:{checkedChildren:"\u53EF\u7F16\u8F91",unCheckedChildren:"\u53EA\u8BFB",defaultChecked:!0}},{title:"\u662F\u5426\u53EF\u5220\u9664",dataIndex:"deleteable",valueType:"switch",tooltip:"\u6570\u636E\u662F\u5426\u53EF\u4EE5\u5220\u9664",fieldProps:{checkedChildren:"\u53EF\u5220\u9664",unCheckedChildren:"\u4E0D\u53EF\u5220",defaultChecked:!0}}]},{valueType:"group",columns:[{dataIndex:"admin_model_id",title:"\u5173\u8054\u6A21\u578B",valueType:"treeSelect",requestDataName:"admin_model_ids",fieldProps:{treeLine:{showLeafIcon:!0},treeDefaultExpandAll:!0,allowClear:!0},width:"md"},{title:"\u9875\u9762\u7C7B\u578B",dataIndex:"page_type",valueType:"radioButton",fieldProps:{options:[{label:"\u5217\u8868",value:"table"},{label:"\u5206\u7C7B",value:"category"},{label:"\u8868\u5355",value:"form"},{label:"\u9762\u677F",value:"panel"}]}},{title:"form\u6253\u5F00\u65B9\u5F0F",dataIndex:"open_type",valueType:"radioButton",fieldProps:{options:[{label:"page",value:"page"},{label:"drawer",value:"drawer"},{label:"modal",value:"modal"}]}},"displayorder","state",{title:"\u663E\u793A",dataIndex:"status",valueType:"switch",tooltip:"\u9690\u85CF\u540E\u83DC\u5355\u4E0D\u663E\u793A\uFF0C\u4F46\u8FD8\u662F\u53EF\u4EE5\u8BBF\u95EE",fieldProps:{checkedChildren:"\u663E\u793A",unCheckedChildren:"\u9690\u85CF",defaultChecked:!0}},{title:"\u8BBE\u7F6E",dataIndex:"setting",valueType:"confirmForm",fieldProps:{btn:{title:"\u8BBE\u7F6E",size:"middle"},formColumns:[{dataIndex:"steps_form",title:"\u5206\u6B65\u8868\u5355",valueType:"switch"}]}}]},{title:"\u5C5E\u6027\u8BBE\u7F6E",dataIndex:"desc",valueType:"jsonEditor",fieldProps:{height:600}},{title:"\u5B50\u6743\u9650",dataIndex:"perms",valueType:"jsonEditor"},"parent_id"],expandAll:!1,level:4,openWidth:1600,tableProps:{scroll:{y:600}},url:"dev/menu",grid:!1,devEnable:!1})}}}]);
