"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{92594:function(st,he,t){t.r(he),t.d(he,{default:function(){return it}});var Pe=t(15009),R=t.n(Pe),Fe=t(97857),L=t.n(Fe),Be=t(99289),Y=t.n(Be),Ie=t(5574),b=t.n(Ie),Te=t(56034),re=t(45360),Re=t(42075),ge=t(96365),fe=t(15867),be=t(57953),s=t(67294),_=t(33067),e=t(85893),Ae=function(r){var i=r.value,y=i===void 0?{}:i,C=r.onChange,h=r.reload,n=h===void 0?0:h,A=r.placeholder,z=A===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":A,I=(0,s.useState)(""),x=b()(I,2),g=x[0],k=x[1],w=(0,s.useState)(""),D=b()(w,2),G=D[0],K=D[1],N=(0,s.useState)(""),d=b()(N,2),f=d[0],E=d[1],O=(0,s.useState)(!1),$=b()(O,2),M=$[0],B=$[1],v=function(){var W=Y()(R()().mark(function j(){var P;return R()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,(0,_.xx)({key:G});case 3:if(P=p.sent,P.code!==0){p.next=6;break}return p.abrupt("return",P.data);case 6:p.next=12;break;case 8:return p.prev=8,p.t0=p.catch(0),re.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 12:return re.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 14:case"end":return p.stop()}},j,null,[[0,8]])}));return function(){return W.apply(this,arguments)}}(),c=function(j){C&&C(L()(L()({captchaCode:g,captchaKey:G},y),j))},m=function(j){B(!0),v().then(function(P){B(!1),K(P.key),E(P.img),j&&c({captchaKey:P.key})})};(0,s.useEffect)(function(){m(!1)},[]),(0,s.useEffect)(function(){n>0&&m(!0)},[n]);var o=function(j){var P=j.target.value||"";P&&k(P),c({captchaCode:P})},Z=function(){m(!0)};return(0,e.jsxs)(Re.Z,{children:[(0,e.jsx)(ge.Z,{prefix:(0,e.jsx)(Te.Z,{}),size:"large",placeholder:z,onChange:o}),(0,e.jsx)(fe.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(be.Z,{spinning:M,size:"small",children:(0,e.jsx)("img",{src:f,onClick:Z})})})]})},ie=Ae,De=t(99702),me=t(87547),pe=t(94149),Ne=t(84517),se=t(5966),ee=t(34994),Ee=t(97462),l=t(1413),te=t(74165),xe=t(15861),le=t(91),oe=t(97685),Le=t(40741),Se=t(90789),$e=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],ze=s.forwardRef(function(a,r){var i=Le.Z.useFormInstance(),y=(0,s.useState)(a.countDown||60),C=(0,oe.Z)(y,2),h=C[0],n=C[1],A=(0,s.useState)(!1),z=(0,oe.Z)(A,2),I=z[0],x=z[1],g=(0,s.useState)(),k=(0,oe.Z)(g,2),w=k[0],D=k[1],G=a.rules,K=a.name,N=a.phoneName,d=a.fieldProps,f=a.onTiming,E=a.captchaTextRender,O=E===void 0?function(v,c){return v?"".concat(c," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:E,$=a.captchaProps,M=(0,le.Z)(a,$e),B=function(){var v=(0,xe.Z)((0,te.Z)().mark(function c(m){return(0,te.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,D(!0),Z.next=4,M.onGetCaptcha(m);case 4:D(!1),x(!0),Z.next=13;break;case 8:Z.prev=8,Z.t0=Z.catch(0),x(!1),D(!1),console.log(Z.t0);case 13:case"end":return Z.stop()}},c,null,[[0,8]])}));return function(m){return v.apply(this,arguments)}}();return(0,s.useImperativeHandle)(r,function(){return{startTiming:function(){return x(!0)},endTiming:function(){return x(!1)}}}),(0,s.useEffect)(function(){var v=0,c=a.countDown;return I&&(v=window.setInterval(function(){n(function(m){return m<=1?(x(!1),clearInterval(v),c||60):m-1})},1e3)),function(){return clearInterval(v)}},[I]),(0,s.useEffect)(function(){f&&f(h)},[h,f]),(0,e.jsxs)("div",{style:(0,l.Z)((0,l.Z)({},d==null?void 0:d.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(ge.Z,(0,l.Z)((0,l.Z)({},d),{},{style:(0,l.Z)({flex:1,transition:"width .3s",marginRight:8},d==null?void 0:d.style)})),(0,e.jsx)(fe.ZP,(0,l.Z)((0,l.Z)({style:{display:"block"},disabled:I,loading:w},$),{},{onClick:(0,xe.Z)((0,te.Z)().mark(function v(){var c;return(0,te.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,!N){o.next=9;break}return o.next=4,i.validateFields([N].flat(1));case 4:return c=i.getFieldValue([N].flat(1)),o.next=7,B(c);case 7:o.next=11;break;case 9:return o.next=11,B("");case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(0),console.log(o.t0);case 16:case"end":return o.stop()}},v,null,[[0,13]])})),children:O(I,h)}))]})}),ke=(0,Se.G)(ze),we=ke,Ge=t(10915),Me=t(28459),We=t(93967),He=t.n(We),ue=t(4942),Ke=t(64847),Oe=function(r){var i;return i={},(0,ue.Z)(i,r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),(0,ue.Z)(i,"@media (min-width: @screen-md-min)",(0,ue.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"})),i};function Ue(a){return(0,Ke.Xj)("LoginForm",function(r){var i=(0,l.Z)((0,l.Z)({},r),{},{componentCls:".".concat(a)});return[Oe(i)]})}var Ve=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function Xe(a){var r,i=a.logo,y=a.message,C=a.contentStyle,h=a.title,n=a.subTitle,A=a.actions,z=a.children,I=a.containerStyle,x=a.otherStyle,g=(0,le.Z)(a,Ve),k=(0,Ge.YB)(),w=g.submitter===!1?!1:(0,l.Z)((0,l.Z)({searchConfig:{submitText:k.getMessage("loginForm.submitText","\u767B\u5F55")}},g.submitter),{},{submitButtonProps:(0,l.Z)({size:"large",style:{width:"100%"}},(r=g.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function($,M){var B,v=M.pop();if(typeof(g==null||(B=g.submitter)===null||B===void 0?void 0:B.render)=="function"){var c,m;return g==null||(c=g.submitter)===null||c===void 0||(m=c.render)===null||m===void 0?void 0:m.call(c,$,M)}return v}}),D=(0,s.useContext)(Me.ZP.ConfigContext),G=D.getPrefixCls("pro-form-login"),K=Ue(G),N=K.wrapSSR,d=K.hashId,f=function($){return"".concat(G,"-").concat($," ").concat(d)},E=(0,s.useMemo)(function(){return i?typeof i=="string"?(0,e.jsx)("img",{src:i}):i:null},[i]);return N((0,e.jsxs)("div",{className:He()(f("container"),d),style:I,children:[(0,e.jsxs)("div",{className:"".concat(f("top")," ").concat(d).trim(),children:[h||E?(0,e.jsxs)("div",{className:"".concat(f("header")),children:[E?(0,e.jsx)("span",{className:f("logo"),children:E}):null,h?(0,e.jsx)("span",{className:f("title"),children:h}):null]}):null,n?(0,e.jsx)("div",{className:f("desc"),children:n}):null]}),(0,e.jsxs)("div",{className:f("main"),style:(0,l.Z)({width:328},C),children:[(0,e.jsxs)(ee.A,(0,l.Z)((0,l.Z)({isKeyPressSubmit:!0},g),{},{submitter:w,children:[y,z]})),A?(0,e.jsx)("div",{className:f("main-other"),style:x,children:A}):null]})]}))}var ye=t(22270),Ye=t(84567),Ce=t(19323),Je=["options","fieldProps","proFieldProps","valueEnum"],Qe=s.forwardRef(function(a,r){var i=a.options,y=a.fieldProps,C=a.proFieldProps,h=a.valueEnum,n=(0,le.Z)(a,Je);return(0,e.jsx)(Ce.Z,(0,l.Z)({ref:r,valueType:"checkbox",valueEnum:(0,ye.h)(h,void 0),fieldProps:(0,l.Z)({options:i},y),lightProps:(0,l.Z)({labelFormatter:function(){return(0,e.jsx)(Ce.Z,(0,l.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,ye.h)(h,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,l.Z)({options:i},y),proFieldProps:C},n))}},n.lightProps),proFieldProps:C},n))}),qe=s.forwardRef(function(a,r){var i=a.fieldProps,y=a.children;return(0,e.jsx)(Ye.Z,(0,l.Z)((0,l.Z)({ref:r},i),{},{children:y}))}),_e=(0,Se.G)(qe,{valuePropName:"checked"}),Ze=_e;Ze.Group=Qe;var et=Ze,V=t(7837),tt=t(3321),nt=t(48096),at=t(73935),J={container:"container___ldtvs",lang:"lang___qrAB8",content:"content___wB3e_","ant-pro-form-login-container":"ant-pro-form-login-container___Z1bnX",icon:"icon___CBYA8"},lt=function(r){var i=r.content;return _jsx(Alert,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},rt=function(){var r,i,y,C,h=(0,V.useModel)("@@initialState"),n=h.initialState,A=h.setInitialState,z=(0,s.useState)(0),I=b()(z,2),x=I[0],g=I[1],k=(0,s.useState)(0),w=b()(k,2),D=w[0],G=w[1],K=(0,s.useState)(!1),N=b()(K,2),d=N[0],f=N[1],E=(0,V.useSearchParams)(),O=b()(E,1),$=O[0],M=re.ZP.useMessage(),B=b()(M,2),v=B[0],c=B[1],m=function(){var H=Y()(R()().mark(function T(U){return R()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,_.ZP.post("login",{data:L()(L()({},U),{},{loginType:j}),duration:1,msgcls:function(){var Q=Y()(R()().mark(function X(F){return R()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:F.code?(j=="phone"&&F.code==3&&G(x+1),d&&g(x+1),(F.code==3||F.code==2)&&f(!0)):F.code||(U.autoLogin?localStorage.setItem("Sa-Remember","1"):localStorage.setItem("Sa-Remember","0"),localStorage.setItem(_.lH,F.data.access_token),(0,at.flushSync)(function(){A(function(u){return L()(L()({},u),{},{currentUser:F.data.userinfo,settings:L()(L()({},u==null?void 0:u.settings),F.data.setting)})}).then(function(){var u,je="/";if(F.data.userinfo.redirect)V.history.push(F.data.userinfo.redirect);else if(n!=null&&(u=n.settings)!==null&&u!==void 0&&u.baseurl){var ve;V.history.push(je.replace(n==null||(ve=n.settings)===null||ve===void 0?void 0:ve.baseurl,"/"))}else V.history.push(je)})}));case 1:case"end":return ae.stop()}},X)}));function q(X){return Q.apply(this,arguments)}return q}()});case 2:return S.abrupt("return");case 3:case"end":return S.stop()}},T)}));return function(U){return H.apply(this,arguments)}}(),o={},Z=(0,s.useState)(n==null||(r=n.settings)===null||r===void 0?void 0:r.loginTypeDefault),W=b()(Z,2),j=W[0],P=W[1];n!=null&&(i=n.settings)!==null&&i!==void 0&&i.loginBgImgage&&(o.backgroundImage='url("'+(n==null?void 0:n.settings.loginBgImgage)+'")');var ce=(0,s.useRef)(),p=[{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"phone",children:j!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(me.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"},{pattern:/^1\d{10}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"}]}),(0,e.jsx)(ee.A.Item,{name:"captchaPhone",rules:[{required:!0,message:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:D,placeholder:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"})}),(0,e.jsx)(Ee.Z,{name:["captchaPhone"],children:function(T){var U=T.captchaPhone;return(0,e.jsx)(we,{fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(S,Q){return S?"".concat(Q," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"mobilecode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"}],onGetCaptcha:function(){var ne=Y()(R()().mark(function S(Q){var q,X,F,de;return R()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(q=ce.current)===null||q===void 0?void 0:q.validateFields(["captcha"]);case 3:u.next=8;break;case 5:throw u.prev=5,u.t0=u.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return u.next=10,_.ZP.post("sms",{data:{mobile:Q,captcha:U}});case 10:if(X=u.sent,F=X.code,de=X.msg,!F){u.next=15;break}throw new Error(de);case 15:case"end":return u.stop()}},S,null,[[0,5]])}));return function(S){return ne.apply(this,arguments)}}()})}}),d&&(0,e.jsx)(ee.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:x})})]})},{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"password",children:j!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(me.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,e.jsx)(se.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),d&&(0,e.jsx)(ee.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:x})})]})}];return(0,e.jsx)(tt.Z,{children:(0,e.jsxs)("div",{className:J.container,style:L()({},o),children:[(0,e.jsx)(V.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",n==null||(y=n.settings)===null||y===void 0?void 0:y.title]})}),(0,e.jsx)("div",{className:J.content,children:(0,e.jsxs)(Ne.ZP,{style:{margin:"60px auto",padding:"20px 0",background:o.backgroundImage?"#fff":"none"},children:[c,(0,e.jsxs)(Xe,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:ce,logo:n==null?void 0:n.settings.logo,title:n==null?void 0:n.settings.title,subTitle:n==null?void 0:n.settings.subtitle,initialValues:{autoLogin:!0},onFinish:function(){var H=Y()(R()().mark(function T(U){return R()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,m(U);case 2:case"end":return S.stop()}},T)}));return function(T){return H.apply(this,arguments)}}(),children:[(0,e.jsx)(nt.Z,{centered:!0,activeKey:j,onChange:function(T){return P(T)},items:n==null||(C=n.settings.loginType)===null||C===void 0?void 0:C.map(function(H){return p.find(function(T){return T.key==H})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(et,{noStyle:!0,name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){v.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:"\u5FD8\u8BB0\u5BC6\u7801"})]})]})]})}),(0,e.jsx)(De.Z,{})]})})},it=rt}}]);
