!(function(){var J4=(ke,Se)=>(Se=Symbol[ke])?Se:Symbol.for("Symbol."+ke),TV=ke=>{throw TypeError(ke)},Ri=Math.pow;var CV=function(ke,Se){this[0]=ke,this[1]=Se};var KR=ke=>{var Se=ke[J4("asyncIterator")],k=!1,pt,it={};return Se==null?(Se=ke[J4("iterator")](),pt=_t=>it[_t]=qt=>Se[_t](qt)):(Se=Se.call(ke),pt=_t=>it[_t]=qt=>{if(k){if(k=!1,_t==="throw")throw qt;return qt}return k=!0,{done:!1,value:new CV(new Promise(q=>{var Zt=Se[_t](qt);Zt instanceof Object||TV("Object expected"),q(Zt)}),1)}}),it[J4("iterator")]=()=>it,pt("next"),"throw"in Se?pt("throw"):it.throw=_t=>{throw _t},"return"in Se&&pt("return"),it};(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[772],{79611:function(ke,Se,k){"use strict";var pt=k(67294),it=k(54686),_t=function(){return _t=Object.assign||function(q){for(var Zt,Bt=1,Wt=arguments.length;Bt<Wt;Bt++){Zt=arguments[Bt];for(var ct in Zt)Object.prototype.hasOwnProperty.call(Zt,ct)&&(q[ct]=Zt[ct])}return q},_t.apply(this,arguments)},qt=(0,pt.forwardRef)(function(q,Zt){return pt.createElement(it.P,_t({},q,{chartType:"Bar",ref:Zt}))});Se.Z=qt},54686:function(ke,Se,k){"use strict";k.d(Se,{P:function(){return SV}});var pt={};k.r(pt),k.d(pt,{area:function(){return hA},bottom:function(){return Ia},bottomLeft:function(){return Ia},bottomRight:function(){return Ia},inside:function(){return Ia},left:function(){return Ia},outside:function(){return vA},right:function(){return Ia},spider:function(){return bA},surround:function(){return _A},top:function(){return Ia},topLeft:function(){return Ia},topRight:function(){return Ia}});var it={};k.r(it),k.d(it,{interpolateBlues:function(){return C_},interpolateBrBG:function(){return qA},interpolateBuGn:function(){return g_},interpolateBuPu:function(){return m_},interpolateCividis:function(){return Md},interpolateCool:function(){return s6},interpolateCubehelixDefault:function(){return o6},interpolateGnBu:function(){return y_},interpolateGreens:function(){return J0},interpolateGreys:function(){return io},interpolateInferno:function(){return c5},interpolateMagma:function(){return N_},interpolateOrRd:function(){return JA},interpolateOranges:function(){return i6},interpolatePRGn:function(){return a_},interpolatePiYG:function(){return c_},interpolatePlasma:function(){return u6},interpolatePuBu:function(){return S_},interpolatePuBuGn:function(){return t5},interpolatePuOr:function(){return l_},interpolatePuRd:function(){return E_},interpolatePurples:function(){return Gc},interpolateRainbow:function(){return eg},interpolateRdBu:function(){return u_},interpolateRdGy:function(){return Ed},interpolateRdPu:function(){return w_},interpolateRdYlBu:function(){return d_},interpolateRdYlGn:function(){return KA},interpolateReds:function(){return M_},interpolateSinebow:function(){return c6},interpolateSpectral:function(){return QA},interpolateTurbo:function(){return F_},interpolateViridis:function(){return l6},interpolateWarm:function(){return a6},interpolateYlGn:function(){return n5},interpolateYlGnBu:function(){return e5},interpolateYlOrBr:function(){return r5},interpolateYlOrRd:function(){return r6},schemeAccent:function(){return B0},schemeBlues:function(){return K0},schemeBrBG:function(){return i_},schemeBuGn:function(){return Wc},schemeBuPu:function(){return v_},schemeCategory10:function(){return N0},schemeDark2:function(){return Wb},schemeGnBu:function(){return $0},schemeGreens:function(){return Q0},schemeGreys:function(){return Td},schemeObservable10:function(){return vd},schemeOrRd:function(){return b_},schemeOranges:function(){return L_},schemePRGn:function(){return o_},schemePaired:function(){return j0},schemePastel1:function(){return t6},schemePastel2:function(){return e6},schemePiYG:function(){return s_},schemePuBu:function(){return x_},schemePuBuGn:function(){return __},schemePuOr:function(){return G0},schemePuRd:function(){return O_},schemePurples:function(){return Cd},schemeRdBu:function(){return Y0},schemeRdGy:function(){return f_},schemeRdPu:function(){return X0},schemeRdYlBu:function(){return wd},schemeRdYlGn:function(){return h_},schemeReds:function(){return i5},schemeSet1:function(){return HA},schemeSet2:function(){return VA},schemeSet3:function(){return Fo},schemeSpectral:function(){return p_},schemeTableau10:function(){return md},schemeYlGn:function(){return q0},schemeYlGnBu:function(){return A_},schemeYlOrBr:function(){return T_},schemeYlOrRd:function(){return Ad}});var _t={};k.r(_t),k.d(_t,{geoAlbers:function(){return LI},geoAlbersUsa:function(){return jB},geoAzimuthalEqualArea:function(){return zB},geoAzimuthalEqualAreaRaw:function(){return d4},geoAzimuthalEquidistant:function(){return UB},geoAzimuthalEquidistantRaw:function(){return h4},geoConicConformal:function(){return HB},geoConicConformalRaw:function(){return RI},geoConicEqualArea:function(){return GS},geoConicEqualAreaRaw:function(){return MI},geoConicEquidistant:function(){return WB},geoConicEquidistantRaw:function(){return kI},geoEqualEarth:function(){return YB},geoEqualEarthRaw:function(){return p4},geoEquirectangular:function(){return VB},geoEquirectangularRaw:function(){return tm},geoGnomonic:function(){return $B},geoGnomonicRaw:function(){return g4},geoIdentity:function(){return XB},geoMercator:function(){return ZB},geoMercatorRaw:function(){return Jv},geoNaturalEarth1:function(){return qB},geoNaturalEarth1Raw:function(){return v4},geoOrthographic:function(){return KB},geoOrthographicRaw:function(){return m4},geoProjection:function(){return Ss},geoProjectionMutator:function(){return u4},geoStereographic:function(){return QB},geoStereographicRaw:function(){return y4},geoTransverseMercator:function(){return JB},geoTransverseMercatorRaw:function(){return b4}});var qt={};k.r(qt),k.d(qt,{frequency:function(){return Jz},id:function(){return tU},name:function(){return eU},weight:function(){return Qz}});var q=k(67294),Zt=k(73935),Bt=k.t(Zt,2),Wt=function(){return Wt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Wt.apply(this,arguments)},ct=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},ee=function(t,e){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},r,o,c,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(h){return function(p){return d([h,p])}}function d(h){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,h[0]&&(n=0)),n;)try{if(r=1,o&&(c=h[0]&2?o.return:h[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,h[1])).done)return c;switch(o=0,c&&(h=[h[0]&2,c.value]),h[0]){case 0:case 1:c=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,o=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!c||h[1]>c[0]&&h[1]<c[3])){n.label=h[1];break}if(h[0]===6&&n.label<c[1]){n.label=c[1],c=h;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(h);break}c[2]&&n.ops.pop(),n.trys.pop();continue}h=e.call(t,n)}catch(p){h=[6,p],o=0}finally{r=c=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},K=Wt({},Bt),J=K.version,Ct=K.render,ft=K.unmountComponentAtNode,mt;try{var lt=Number((J||"").split(".")[0]);lt>=18&&(mt=K.createRoot)}catch(t){}function jt(t){var e=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&typeof e=="object"&&(e.usingClientEntryPoint=t)}var ue="__rc_react_root__";function we(t,e){jt(!0);var n=e[ue]||mt(e);jt(!1),n.render(t),e[ue]=n}function Ne(t,e){Ct(t,e)}function Ge(t,e){}function ye(t,e){if(mt){we(t,e);return}Ne(t,e)}function Vt(t){return ct(this,void 0,void 0,function(){return ee(this,function(e){return[2,Promise.resolve().then(function(){var n;(n=t[ue])===null||n===void 0||n.unmount(),delete t[ue]})]})})}function $(t){ft(t)}function ae(t){}function Gt(t){return ct(this,void 0,void 0,function(){return ee(this,function(e){return mt!==void 0?[2,Vt(t)]:($(t),[2])})})}var _e=new Map;typeof document!="undefined"&&_e.set("tooltip",document.createElement("div"));var xe=function(t,e){e===void 0&&(e=!1);var n=null;if(e)n=_e.get("tooltip");else if(n=document.createElement("div"),t!=null&&t.key){var r=_e.get(t.key);r?n=r:_e.set(t.key,n)}return ye(t,n),n},X=function(t){if(typeof document=="undefined")return"loading";var e=t.attachShadow({mode:"open"}),n=document.createElement("div"),r=document.createElement("style");r.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `,n.classList.add("loading"),n.innerHTML="<div></div><div></div><div></div><div></div>",e.appendChild(r),e.appendChild(n)},Rt=function(t){var e=t.loadingTemplate,n=t.theme,r=n===void 0?"light":n,o=q.useRef(null);q.useEffect(function(){!e&&o.current&&X(o.current)},[]);var c=function(){return e||q.createElement("div",{ref:o})};return q.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:r==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},c())},V=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(t){V(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state={hasError:!1},n.renderError=function(r){var o=n.props.errorTemplate;switch(r){default:return typeof o=="function"?o(r):o||q.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",r.message)}},n}return e.getDerivedStateFromError=function(n){return{hasError:!0,error:n}},e.getDerivedStateFromProps=function(n,r){return r.children!==n.children?{children:n.children,hasError:!1,error:void 0}:null},e.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):q.createElement(q.Fragment,null,this.props.children)},e}(q.Component),H=k(96486),N=function(t){var e=/react|\.jsx|children:\[\(|return\s+[A-Za-z0-9].createElement\((?!['"][g|circle|ellipse|image|rect|line|polyline|polygon|text|path|html|mesh]['"])([^\)])*,/i;return e.test(t)},et=function(){return et=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},et.apply(this,arguments)};function ot(t,e){var n=(0,q.useRef)(),r=(0,q.useRef)(),o=(0,q.useRef)(null),c=e.onReady,l=e.onEvent,u=function(p,v){var m;p===void 0&&(p="image/png");var b=(m=o.current)===null||m===void 0?void 0:m.getElementsByTagName("canvas")[0];return b==null?void 0:b.toDataURL(p,v)},d=function(p,v,m){p===void 0&&(p="download"),v===void 0&&(v="image/png");var b=p;p.indexOf(".")===-1&&(b="".concat(p,".").concat(v.split("/")[1]));var x=u(v,m),S=document.createElement("a");return S.href=x,S.download=b,document.body.appendChild(S),S.click(),document.body.removeChild(S),S=null,b},h=function(p,v){v===void 0&&(v=!1);var m=Object.keys(p),b=v;m.forEach(function(x){var S=p[x];x==="tooltip"&&(b=!0),(0,H.isFunction)(S)&&N("".concat(S))?p[x]=function(){for(var E=[],w=0;w<arguments.length;w++)E[w]=arguments[w];return xe(S.apply(void 0,E),b)}:(0,H.isArray)(S)?S.forEach(function(E){h(E,b)}):(0,H.isObject)(S)?h(S,b):b=v})};return(0,q.useEffect)(function(){n.current&&!(0,H.isEqual)(r.current,e)&&(r.current=(0,H.cloneDeep)(e),h(e),n.current.update(e),n.current.render())},[e]),(0,q.useEffect)(function(){if(!o.current)return function(){return null};r.current||(r.current=(0,H.cloneDeep)(e)),h(e);var p=new t(o.current,et({},e));p.toDataURL=u,p.downloadImage=d,p.render(),n.current=p,c&&c(p);var v=function(m){l&&l(p,m)};return p.on("*",v),function(){n.current&&(n.current.destroy(),n.current.off("*",v),n.current=void 0)}},[]),{chart:n,container:o}}var At="*",Dt=function(){function t(){this._events={}}return t.prototype.on=function(e,n,r){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:n,once:!!r}),this},t.prototype.once=function(e,n){return this.on(e,n,!0)},t.prototype.emit=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var c=this._events[e]||[],l=this._events[At]||[],u=function(d){for(var h=d.length,p=0;p<h;p++)if(d[p]){var v=d[p],m=v.callback,b=v.once;b&&(d.splice(p,1),d.length===0&&delete n._events[e],h--,p--),m.apply(n,r)}};u(c),u(l)},t.prototype.off=function(e,n){if(!e)this._events={};else if(!n)delete this._events[e];else{for(var r=this._events[e]||[],o=r.length,c=0;c<o;c++)r[c].callback===n&&(r.splice(c,1),o--,c--);r.length===0&&delete this._events[e]}return this},t.prototype.getEvents=function(){return this._events},t}(),ie=Dt;const Tt="main-layer",zt="label-layer",Oe="element",Lt="view",nt="plot",Ft="component",he="label",yt="area",St="mask";var F=k(4559),T=k(97582),gt=k(76714),ne=k(25897),C=k(32945),j=k(85975),Pt=k(77160),Jt=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.landmarks=[],n}return e.prototype.rotate=function(n,r,o){if(this.relElevation=(0,F._O)(r),this.relAzimuth=(0,F._O)(n),this.relRoll=(0,F._O)(o),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===F.iM.EXPLORING){var c=C.yY(C.Ue(),[1,0,0],(0,F.Vl)((this.rotateWorld?1:-1)*this.relElevation)),l=C.yY(C.Ue(),[0,1,0],(0,F.Vl)((this.rotateWorld?1:-1)*this.relAzimuth)),u=C.yY(C.Ue(),[0,0,1],(0,F.Vl)(this.relRoll)),d=C.Jp(C.Ue(),l,c);d=C.Jp(C.Ue(),d,u);var h=j.fromQuat(j.create(),d);j.translate(this.matrix,this.matrix,[0,0,-this.distance]),j.multiply(this.matrix,this.matrix,h),j.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===F.iM.ORBITING||this.type===F.iM.EXPLORING?this._getPosition():this.type===F.iM.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(n,r){var o=(0,F.O4)(n,r,0),c=Pt.d9(this.position);return Pt.IH(c,c,Pt.bA(Pt.Ue(),this.right,o[0])),Pt.IH(c,c,Pt.bA(Pt.Ue(),this.up,o[1])),this._setPosition(c),this.triggerUpdate(),this},e.prototype.dolly=function(n){var r=this.forward,o=Pt.d9(this.position),c=n*this.dollyingStep,l=this.distance+n*this.dollyingStep;return c=Math.max(Math.min(l,this.maxDistance),this.minDistance)-this.distance,o[0]+=c*r[0],o[1]+=c*r[1],o[2]+=c*r[2],this._setPosition(o),this.type===F.iM.ORBITING||this.type===F.iM.EXPLORING?this._getDistance():this.type===F.iM.TRACKING&&Pt.IH(this.focalPoint,o,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(n,r){var o,c,l,u;r===void 0&&(r={});var d=r.position,h=d===void 0?this.position:d,p=r.focalPoint,v=p===void 0?this.focalPoint:p,m=r.roll,b=r.zoom,x=new F.GZ.CameraContribution;x.setType(this.type,void 0),x.setPosition(h[0],(o=h[1])!==null&&o!==void 0?o:this.position[1],(c=h[2])!==null&&c!==void 0?c:this.position[2]),x.setFocalPoint(v[0],(l=v[1])!==null&&l!==void 0?l:this.focalPoint[1],(u=v[2])!==null&&u!==void 0?u:this.focalPoint[2]),x.setRoll(m!=null?m:this.roll),x.setZoom(b!=null?b:this.zoom);var S={name:n,matrix:j.clone(x.getWorldTransform()),right:Pt.d9(x.right),up:Pt.d9(x.up),forward:Pt.d9(x.forward),position:Pt.d9(x.getPosition()),focalPoint:Pt.d9(x.getFocalPoint()),distanceVector:Pt.d9(x.getDistanceVector()),distance:x.getDistance(),dollyingStep:x.getDollyingStep(),azimuth:x.getAzimuth(),elevation:x.getElevation(),roll:x.getRoll(),relAzimuth:x.relAzimuth,relElevation:x.relElevation,relRoll:x.relRoll,zoom:x.getZoom()};return this.landmarks.push(S),S},e.prototype.gotoLandmark=function(n,r){var o=this;r===void 0&&(r={});var c=(0,gt.Z)(n)?this.landmarks.find(function(xt){return xt.name===n}):n;if(c){var l=(0,ne.Z)(r)?{duration:r}:r,u=l.easing,d=u===void 0?"linear":u,h=l.duration,p=h===void 0?100:h,v=l.easingFunction,m=v===void 0?void 0:v,b=l.onfinish,x=b===void 0?void 0:b,S=l.onframe,E=S===void 0?void 0:S,w=.01;this.cancelLandmarkAnimation();var M=c.position,L=c.focalPoint,I=c.zoom,R=c.roll,z=m||F.GZ.EasingFunction(d),W,Y=function(){o.setFocalPoint(L),o.setPosition(M),o.setRoll(R),o.setZoom(I),o.computeMatrix(),o.triggerUpdate(),x==null||x()};if(p===0)return Y();var st=function(xt){W===void 0&&(W=xt);var Nt=xt-W;if(Nt>=p){Y();return}var Ht=z(Nt/p),dt=Pt.Ue(),Ot=Pt.Ue(),bt=1,wt=0;Pt.t7(dt,o.focalPoint,L,Ht),Pt.t7(Ot,o.position,M,Ht),wt=o.roll*(1-Ht)+R*Ht,bt=o.zoom*(1-Ht)+I*Ht,o.setFocalPoint(dt),o.setPosition(Ot),o.setRoll(wt),o.setZoom(bt);var oe=Pt.TK(dt,L)+Pt.TK(Ot,M);if(oe<=w&&I==null&&R==null)return Y();o.computeMatrix(),o.triggerUpdate(),Nt<p&&(E==null||E(Ht),o.landmarkAnimationID=o.canvas.requestAnimationFrame(st))};this.canvas.requestAnimationFrame(st)}},e}(F.V1);F.GZ.CameraContribution=Jt;var se=function(){function t(e,n){this.type=e,this.target=n,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return t.copy=function(e){var n=new t(e.type,e.target);return n.addedNodes=e.addedNodes.slice(),n.removedNodes=e.removedNodes.slice(),n.previousSibling=e.previousSibling,n.nextSibling=e.nextSibling,n.attributeName=e.attributeName,n.attributeNamespace=e.attributeNamespace,n.oldValue=e.oldValue,n},t}(),Ae=0,Le=new WeakMap,De=function(){function t(e,n,r){this.observer=e,this.target=n,this.options=r,this.transientObservedNodes=[]}return t.prototype.enqueue=function(e){var n=this.observer.records,r=n.length;if(n.length>0){var o=n[r-1],c=pe(o,e);if(c){n[r-1]=c;return}}else Et(this.observer);n[r]=e},t.prototype.addListeners=function(){this.addListeners_(this.target)},t.prototype.addListeners_=function(e){var n=this.options;n.attributes&&e.addEventListener(F.Dk.ATTR_MODIFIED,this,!0),n.childList&&e.addEventListener(F.Dk.INSERTED,this,!0),(n.childList||n.subtree)&&e.addEventListener(F.Dk.REMOVED,this,!0)},t.prototype.removeListeners=function(){this.removeListeners_(this.target)},t.prototype.removeListeners_=function(e){var n=this.options;n.attributes&&e.removeEventListener(F.Dk.ATTR_MODIFIED,this,!0),n.childList&&e.removeEventListener(F.Dk.INSERTED,this,!0),(n.childList||n.subtree)&&e.removeEventListener(F.Dk.REMOVED,this,!0)},t.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(n){this.removeListeners_(n);for(var r=Le.get(n),o=0;o<r.length;o++)if(r[o]===this){r.splice(o,1);break}},this)},t.prototype.handleEvent=function(e){e.stopImmediatePropagation();var n,r;switch(e.type){case F.Dk.ATTR_MODIFIED:var o=e.attrName,c=e.relatedNode.namespaceURI;r=e.target,n=Ye("attributes",r),n.attributeName=o,n.attributeNamespace=c;var l=e.attrChange===F.jd.ADDITION?null:e.prevValue;D(r,function(m){if(m.attributes&&!(m.attributeFilter&&m.attributeFilter.length&&m.attributeFilter.indexOf(o)===-1&&m.attributeFilter.indexOf(c)===-1))return m.attributeOldValue?Xt(l):n});break;case F.Dk.REMOVED:case F.Dk.INSERTED:r=e.relatedNode;var u=e.target,d=void 0,h=void 0;e.type===F.Dk.INSERTED?(d=[u],h=[]):(d=[],h=[u]);var p=u.previousSibling,v=u.nextSibling;n=Ye("childList",r),n.addedNodes=d,n.removedNodes=h,n.previousSibling=p,n.nextSibling=v,D(r,function(m){if(m.childList)return n})}re()},t}(),Ve=function(){function t(e){this.callback=e,this.nodes=[],this.records=[],this.uid=Ae++}return t.prototype.observe=function(e,n){if(!n.childList&&!n.attributes&&!n.characterData||n.attributeOldValue&&!n.attributes||n.attributeFilter&&n.attributeFilter.length&&!n.attributes||n.characterDataOldValue&&!n.characterData)throw new SyntaxError;var r=Le.get(e);r||Le.set(e,r=[]);for(var o,c=0;c<r.length;c++)if(r[c].observer===this){o=r[c],o.removeListeners(),o.options=n;break}o||(o=new De(this,e,n),r.push(o),this.nodes.push(e)),o.addListeners()},t.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(n){for(var r=Le.get(n),o=0;o<r.length;o++){var c=r[o];if(c.observer===e){c.removeListeners(),r.splice(o,1);break}}},this),this.records=[]},t.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},t}(),We,$e;function Ye(t,e){return We=new se(t,e)}function Xt(t){return $e||($e=se.copy(We),$e.oldValue=t,$e)}function re(){We=$e=void 0}function le(t){return t===$e||t===We}function pe(t,e){return t===e?t:$e&&le(t)?$e:null}function Q(t){t.nodes.forEach(function(e){var n=Le.get(e);n&&n.forEach(function(r){r.observer===t&&r.removeTransientObservers()})})}function D(t,e){for(var n=t;n;n=n.parentNode){var r=Le.get(n);if(r)for(var o=0;o<r.length;o++){var c=r[o],l=c.options;if(!(n!==t&&!l.subtree)){var u=e(l);u&&c.enqueue(u)}}}}var Z=!1,tt=[];function Et(t){tt.push(t),Z||(Z=!0,typeof F.GZ.globalThis!="undefined"?F.GZ.globalThis.setTimeout(It):It())}function It(){Z=!1;var t=tt;tt=[],t.sort(function(n,r){return n.uid-r.uid});var e=!1;t.forEach(function(n){var r=n.takeRecords();Q(n),r.length&&(n.callback(r,n),e=!0)}),e&&It()}var ce=k(81957),fe=k(95147),Be=function(t){(0,T.ZT)(e,t);function e(n,r,o,c){var l=t.call(this,n)||this;return l.currentTime=o,l.timelineTime=c,l.target=r,l.type="finish",l.bubbles=!1,l.currentTarget=r,l.defaultPrevented=!1,l.eventPhase=l.AT_TARGET,l.timeStamp=Date.now(),l.currentTime=o,l.timelineTime=c,l}return e}(F.xA),ze=0,an=function(){function t(e,n){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(ze++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,r){e.resolveReadyPromise=function(){n(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,r){e.resolveFinishedPromise=function(){n(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var n;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var e=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==e&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==e&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new Be(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(n)})}},t.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},t.prototype.updatePlaybackRate=function(e){this.playbackRate=e},t.prototype.targetAnimations=function(){var e,n=(e=this.effect)===null||e===void 0?void 0:e.target;return n.getAnimations()},t.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},t.prototype.unmarkTarget=function(){var e=this.targetAnimations(),n=e.indexOf(this);n!==-1&&e.splice(n,1)},t.prototype.tick=function(e,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(e))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},t.prototype.persist=function(){throw new Error(F.jf)},t.prototype.addEventListener=function(e,n,r){throw new Error(F.jf)},t.prototype.removeEventListener=function(e,n,r){throw new Error(F.jf)},t.prototype.dispatchEvent=function(e){throw new Error(F.jf)},t.prototype.commitStyles=function(){throw new Error(F.jf)},t.prototype.ensureAlive=function(){var e,n;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((n=this.effect)===null||n===void 0)&&n.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(e,n){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(e){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new Be(null,this,this.currentTime,e);setTimeout(function(){n.onfinish&&n.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var o=new Be(null,this,this.currentTime,e);this.onframe(o)}this._finishedFlag=!1}},t}(),Re=4,Ke=.001,cn=1e-7,pn=10,An=11,Gn=1/(An-1),Vn=typeof Float32Array=="function",fr=function(t,e){return 1-3*e+3*t},yr=function(t,e){return 3*e-6*t},Cr=function(t){return 3*t},jr=function(t,e,n){return((fr(e,n)*t+yr(e,n))*t+Cr(e))*t},Dr=function(t,e,n){return 3*fr(e,n)*t*t+2*yr(e,n)*t+Cr(e)},Fr=function(t,e,n,r,o){var c,l,u=0;do l=e+(n-e)/2,c=jr(l,r,o)-t,c>0?n=l:e=l;while(Math.abs(c)>cn&&++u<pn);return l},zr=function(t,e,n,r){for(var o=0;o<Re;++o){var c=Dr(e,n,r);if(c===0)return e;var l=jr(e,n,r)-t;e-=l/c}return e},si=function(t,e,n,r){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(u){return u};for(var o=Vn?new Float32Array(An):new Array(An),c=0;c<An;++c)o[c]=jr(c*Gn,t,n);var l=function(u){for(var d=0,h=1,p=An-1;h!==p&&o[h]<=u;++h)d+=Gn;--h;var v=(u-o[h])/(o[h+1]-o[h]),m=d+v*Gn,b=Dr(m,t,n);return b>=Ke?zr(u,m,t,n):b===0?m:Fr(u,d,d+Gn,t,n)};return function(u){return u===0||u===1?u:jr(l(u),e,r)}},ki=function(t){return t=t.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},ui=function(t){return Math.pow(t,2)},ri=function(t){return Math.pow(t,3)},Oi=function(t){return Math.pow(t,4)},Ui=function(t){return Math.pow(t,5)},Zo=function(t){return Math.pow(t,6)},Xi=function(t){return 1-Math.cos(t*Math.PI/2)},bo=function(t){return 1-Math.sqrt(1-t*t)},Xr=function(t){return t*t*(3*t-2)},ti=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((e*3-2)/22-t,2)},rt=function(t,e){e===void 0&&(e=[]);var n=(0,T.CR)(e,2),r=n[0],o=r===void 0?1:r,c=n[1],l=c===void 0?.5:c,u=(0,ce.Z)(Number(o),1,10),d=(0,ce.Z)(Number(l),.1,2);return t===0||t===1?t:-u*Math.pow(2,10*(t-1))*Math.sin((t-1-d/(Math.PI*2)*Math.asin(1/u))*(Math.PI*2)/d)},ht=function(t,e,n){e===void 0&&(e=[]);var r=(0,T.CR)(e,4),o=r[0],c=o===void 0?1:o,l=r[1],u=l===void 0?100:l,d=r[2],h=d===void 0?10:d,p=r[3],v=p===void 0?0:p;c=(0,ce.Z)(c,.1,1e3),u=(0,ce.Z)(u,.1,1e3),h=(0,ce.Z)(h,.1,1e3),v=(0,ce.Z)(v,.1,1e3);var m=Math.sqrt(u/c),b=h/(2*Math.sqrt(u*c)),x=b<1?m*Math.sqrt(1-b*b):0,S=1,E=b<1?(b*m+-v)/x:-v+m,w=n?n*t/1e3:t;return b<1?w=Math.exp(-w*b*m)*(S*Math.cos(x*w)+E*Math.sin(x*w)):w=(S+E*w)*Math.exp(-w*m),t===0||t===1?t:1-w},Qt=function(t,e){e===void 0&&(e=[]);var n=(0,T.CR)(e,2),r=n[0],o=r===void 0?10:r,c=n[1],l=c=="start"?Math.ceil:Math.floor;return l((0,ce.Z)(t,0,1)*o)/o},de=function(t,e){e===void 0&&(e=[]);var n=(0,T.CR)(e,4),r=n[0],o=n[1],c=n[2],l=n[3];return si(r,o,c,l)(t)},Ce=si(.42,0,1,1),Me=function(t){return function(e,n,r){return n===void 0&&(n=[]),1-t(1-e,n,r)}},ge=function(t){return function(e,n,r){return n===void 0&&(n=[]),e<.5?t(e*2,n,r)/2:1-t(e*-2+2,n,r)/2}},ve=function(t){return function(e,n,r){return n===void 0&&(n=[]),e<.5?(1-t(1-e*2,n,r))/2:(t(e*2-1,n,r)+1)/2}},Ue={steps:Qt,"step-start":function(t){return Qt(t,[1,"start"])},"step-end":function(t){return Qt(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":de,ease:function(t){return de(t,[.25,.1,.25,1])},in:Ce,out:Me(Ce),"in-out":ge(Ce),"out-in":ve(Ce),"in-quad":ui,"out-quad":Me(ui),"in-out-quad":ge(ui),"out-in-quad":ve(ui),"in-cubic":ri,"out-cubic":Me(ri),"in-out-cubic":ge(ri),"out-in-cubic":ve(ri),"in-quart":Oi,"out-quart":Me(Oi),"in-out-quart":ge(Oi),"out-in-quart":ve(Oi),"in-quint":Ui,"out-quint":Me(Ui),"in-out-quint":ge(Ui),"out-in-quint":ve(Ui),"in-expo":Zo,"out-expo":Me(Zo),"in-out-expo":ge(Zo),"out-in-expo":ve(Zo),"in-sine":Xi,"out-sine":Me(Xi),"in-out-sine":ge(Xi),"out-in-sine":ve(Xi),"in-circ":bo,"out-circ":Me(bo),"in-out-circ":ge(bo),"out-in-circ":ve(bo),"in-back":Xr,"out-back":Me(Xr),"in-out-back":ge(Xr),"out-in-back":ve(Xr),"in-bounce":ti,"out-bounce":Me(ti),"in-out-bounce":ge(ti),"out-in-bounce":ve(ti),"in-elastic":rt,"out-elastic":Me(rt),"in-out-elastic":ge(rt),"out-in-elastic":ve(rt),spring:ht,"spring-in":ht,"spring-out":Me(ht),"spring-in-out":ge(ht),"spring-out-in":ve(ht)},He=function(t){return ki(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},hn=function(t){return Ue[He(t)]||Ue.linear},vn=function(t){return t},Ln=1,dn=.5,Sn=0;function On(t,e){return function(n){if(n>=1)return 1;var r=1/t;return n+=e*r,n-n%r}}var un="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",zn=new RegExp("cubic-bezier\\("+un+","+un+","+un+","+un+"\\)"),Pn=/steps\(\s*(\d+)\s*\)/,Un=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function En(t){var e=zn.exec(t);if(e)return si.apply(void 0,(0,T.ev)([],(0,T.CR)(e.slice(1).map(Number)),!1));var n=Pn.exec(t);if(n)return On(Number(n[1]),Sn);var r=Un.exec(t);return r?On(Number(r[1]),{start:Ln,middle:dn,end:Sn}[r[2]]):hn(t)}function Dn(t){return Math.abs(tr(t)/(t.playbackRate||1))}function tr(t){var e;return t.duration===0||t.iterations===0?0:(t.duration==="auto"?0:Number(t.duration))*((e=t.iterations)!==null&&e!==void 0?e:1)}var Ei=0,fi=1,Ur=2,wi=3;function Di(t,e,n){if(e===null)return Ei;var r=n.endTime;return e<Math.min(n.delay,r)?fi:e>=Math.min(n.delay+t+n.endDelay,r)?Ur:wi}function kt(t,e,n,r,o){switch(r){case fi:return e==="backwards"||e==="both"?0:null;case wi:return n-o;case Ur:return e==="forwards"||e==="both"?t:null;case Ei:return null}}function Yt(t,e,n,r,o){var c=o;return t===0?e!==fi&&(c+=n):c+=r/t,c}function be(t,e,n,r,o,c){var l=t===1/0?e%1:t%1;return l===0&&n===Ur&&r!==0&&(o!==0||c===0)&&(l=1),l}function Xe(t,e,n,r){return t===Ur&&e===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function fn(t,e,n){var r=t;if(t!=="normal"&&t!=="reverse"){var o=e;t==="alternate-reverse"&&(o+=1),r="normal",o!==1/0&&o%2!==0&&(r="reverse")}return r==="normal"?n:1-n}function Tn(t,e,n){var r=Di(t,e,n),o=kt(t,n.fill,e,r,n.delay);if(o===null)return null;var c=n.duration==="auto"?0:n.duration,l=Yt(c,r,n.iterations,o,n.iterationStart),u=be(l,n.iterationStart,r,n.iterations,o,c),d=Xe(r,n.iterations,u,l),h=fn(n.direction,d,u);return n.currentIteration=d,n.progress=h,n.easingFunction(h)}function Zn(t,e,n){var r=ei(t,e),o=xr(r,n);return function(c,l){if(l!==null)o.filter(function(d){return l>=d.applyFrom&&l<d.applyTo}).forEach(function(d){var h=l-d.startOffset,p=d.endOffset-d.startOffset,v=p===0?0:h/p;c.setAttribute(d.property,d.interpolation(v),!1,!1)});else for(var u in r)Zr(u)&&c.setAttribute(u,null)}}function Zr(t){return t!=="offset"&&t!=="easing"&&t!=="composite"&&t!=="computedOffset"}function ei(t,e){for(var n={},r=0;r<t.length;r++)for(var o in t[r])if(Zr(o)){var c={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:En(t[r].easing)||e.easingFunction,value:t[r][o]};n[o]=n[o]||[],n[o].push(c)}return n}function xr(t,e){var n=[];for(var r in t)for(var o=t[r],c=0;c<o.length-1;c++){var l=c,u=c+1,d=o[l].computedOffset,h=o[u].computedOffset,p=d,v=h;c===0&&(p=-1/0,h===0&&(u=l)),c===o.length-2&&(v=1/0,d===1&&(l=u)),n.push({applyFrom:p,applyTo:v,startOffset:o[l].computedOffset,endOffset:o[u].computedOffset,easingFunction:o[l].easingFunction,property:r,interpolation:tL(r,o[l].value,o[u].value,e)})}return n.sort(function(m,b){return m.startOffset-b.startOffset}),n}var ii=function(t,e,n){return function(r){var o=Lr(t,e,r);return!F.GZ.enableCSSParsing&&(0,ne.Z)(o)?o:n(o)}};function tL(t,e,n,r){var o=F.N1[t];if(o&&o.syntax&&o.int){var c=F.GZ.styleValueRegistry.getPropertySyntax(o.syntax);if(c){var l=void 0,u=void 0;if(F.GZ.enableCSSParsing){var d=F.GZ.styleValueRegistry.parseProperty(t,e,r,!1),h=F.GZ.styleValueRegistry.parseProperty(t,n,r,!1);l=F.GZ.styleValueRegistry.computeProperty(t,d,r,!1),u=F.GZ.styleValueRegistry.computeProperty(t,h,r,!1)}else{var p=c.parserWithCSSDisabled;l=p?p(e,r):e,u=p?p(n,r):n}var v=c.mixer(l,u,r);if(v){var m=ii.apply(void 0,(0,T.ev)([],(0,T.CR)(v),!1));return function(b){return b===0?e:b===1?n:m(b)}}}}return ii(!1,!0,function(b){return b?n:e})}function Lr(t,e,n){if(typeof t=="number"&&typeof e=="number")return t*(1-n)+e*n;if(typeof t=="boolean"&&typeof e=="boolean"||typeof t=="string"&&typeof e=="string")return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,o=e.length,c=Math.max(r,o),l=[],u=0;u<c;u++)l.push(Lr(t[u<r?u:r-1],e[u<o?u:o-1],n));return l}throw new Error("Mismatched interpolation arguments "+t+":"+e)}var Os=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=vn,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=En(e),this._easing=e},enumerable:!1,configurable:!0}),t}();function _c(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var o=r.length,c=0;c<o;c++){if(!e[c]){var l={};"offset"in t&&(l.offset=Number(t.offset)),"easing"in t&&(l.easing=t.easing),"composite"in t&&(l.composite=t.composite),e[c]=l}r[c]!==void 0&&r[c]!==null&&(e[c][n]=r[c])}}return e.sort(function(u,d){return(u.computedOffset||0)-(d.computedOffset||0)}),e}function bm(t,e){if(t===null)return[];Array.isArray(t)||(t=_c(t));for(var n=t.map(function(d){var h={};e!=null&&e.composite&&(h.composite="auto");for(var p in d){var v=d[p];if(p==="offset"){if(v!==null){if(v=Number(v),!isFinite(v))throw new Error("Keyframe offsets must be numbers.");if(v<0||v>1)throw new Error("Keyframe offsets must be between 0 and 1.");h.computedOffset=v}}else if(p==="composite"&&["replace","add","accumulate","auto"].indexOf(v)===-1)throw new Error("".concat(v," compositing is not supported"));h[p]=v}return h.offset===void 0&&(h.offset=null),h.easing===void 0&&(h.easing=(e==null?void 0:e.easing)||"linear"),h.composite===void 0&&(h.composite="auto"),h}),r=!0,o=-1/0,c=0;c<n.length;c++){var l=n[c].offset;if((0,fe.Z)(l))r=!1;else{if(l<o)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");o=l}}n=n.filter(function(d){return Number(d.offset)>=0&&Number(d.offset)<=1});function u(){var d,h,p=n.length;n[p-1].computedOffset=Number((d=n[p-1].offset)!==null&&d!==void 0?d:1),p>1&&(n[0].computedOffset=Number((h=n[0].offset)!==null&&h!==void 0?h:0));for(var v=0,m=Number(n[0].computedOffset),b=1;b<p;b++){var x=n[b].computedOffset;if(!(0,fe.Z)(x)&&!(0,fe.Z)(m)){for(var S=1;S<b-v;S++)n[v+S].computedOffset=m+(Number(x)-m)*S/(b-v);v=b,m=Number(x)}}}return r||u(),n}var gO="backwards|forwards|both|none".split("|"),vO="reverse|alternate|alternate-reverse".split("|");function mO(t,e){var n=new Os;return e&&(n.fill="both",n.duration="auto"),typeof t=="number"&&!isNaN(t)?n.duration=t:t!==void 0&&Object.keys(t).forEach(function(r){if(t[r]!==void 0&&t[r]!==null&&t[r]!=="auto"){if((typeof n[r]=="number"||r==="duration")&&(typeof t[r]!="number"||isNaN(t[r]))||r==="fill"&&gO.indexOf(t[r])===-1||r==="direction"&&vO.indexOf(t[r])===-1)return;n[r]=t[r]}}),n}function yO(t,e){return t=Nh(t!=null?t:{duration:"auto"}),mO(t,e)}function Nh(t){return typeof t=="number"&&(isNaN(t)?t={duration:"auto"}:t={duration:t}),t}var Bh=function(){function t(e,n,r){var o=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=yO(r,!1),this.timing.effect=this,this.timing.activeDuration=Dn(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=bm(n,this.timing),this.interpolations=Zn(this.normalizedKeyframes,this.timing,this.target);var c=F.GZ.globalThis.Proxy;this.computedTiming=c?new c(this.timing,{get:function(l,u){return u==="duration"?l.duration==="auto"?0:l.duration:u==="fill"?l.fill==="auto"?"none":l.fill:u==="localTime"?o.animation&&o.animation.currentTime||null:u==="currentIteration"?!o.animation||o.animation.playState!=="running"?null:l.currentIteration||0:u==="progress"?!o.animation||o.animation.playState!=="running"?null:l.progress||0:l[u]},set:function(){return!0}}):this.timing}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(e){return e===null?!1:(this.timeFraction=Tn(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(e){this.normalizedKeyframes=bm(e)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(e){var n=this;Object.keys(e||{}).forEach(function(r){n.timing[r]=e[r]})},t}();function _m(t,e){return Number(t.id)-Number(e.id)}var bO=function(){function t(e){var n=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){n.currentTime=r,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(r){var o=n.rafCallbacks;n.rafCallbacks=[],r<Number(n.currentTime)&&(r=Number(n.currentTime)),n.animations.sort(_m),n.animations=n.tick(r,!0,n.animations)[0],o.forEach(function(c){c[1](r)}),n.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(e,n,r){var o=new Bh(e,n,r),c=new an(o,this);return this.animations.push(c),this.restartWebAnimationsNextTick(),c.updatePromises(),c.play(),c.updatePromises(),c},t.prototype.applyDirtiedAnimation=function(e){var n=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(_m);var o=this.tick(Number(this.currentTime),!1,r.slice())[1];o.forEach(function(c){var l=n.animations.indexOf(c);l!==-1&&n.animations.splice(l,1)}),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(e){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,e]),n},t.prototype.requestAnimationFrame=function(e){var n=this;return this.rAF(function(r){n.updateAnimationsPromises(),e(r),n.updateAnimationsPromises()})},t.prototype.tick=function(e,n,r){var o,c,l=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var u=[],d=[],h=[],p=[];return r.forEach(function(v){v.tick(e,n),v._inEffect?(d.push(v.effect),v.markTarget()):(u.push(v.effect),v.unmarkTarget()),v._needsTick&&(l.ticking=!0);var m=v._inEffect||v._needsTick;v._inTimeline=m,m?h.push(v):p.push(v)}),(o=this.pendingEffects).push.apply(o,(0,T.ev)([],(0,T.CR)(u),!1)),(c=this.pendingEffects).push.apply(c,(0,T.ev)([],(0,T.CR)(d),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[h,p]},t}();F.GZ.EasingFunction=En,F.GZ.AnimationTimeline=bO;var _O=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const jh=(t,e,n)=>[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]];jh.style=["fill"];const xm=jh.bind(void 0);xm.style=["stroke","lineWidth"];const gf=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]];gf.style=["fill"];const Sm=gf.bind(void 0);Sm.style=["fill"];const Om=gf.bind(void 0);Om.style=["stroke","lineWidth"];const zh=(t,e,n)=>{const r=n*.618;return[["M",t-r,e],["L",t,e-n],["L",t+r,e],["L",t,e+n],["Z"]]};zh.style=["fill"];const Em=zh.bind(void 0);Em.style=["stroke","lineWidth"];const Uh=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]};Uh.style=["fill"];const wm=Uh.bind(void 0);wm.style=["stroke","lineWidth"];const Zh=(t,e,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]};Zh.style=["fill"];const Am=Zh.bind(void 0);Am.style=["stroke","lineWidth"];const Hh=(t,e,n)=>{const r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]};Hh.style=["fill"];const Tm=Hh.bind(void 0);Tm.style=["stroke","lineWidth"];const Vh=(t,e,n)=>{const r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]};Vh.style=["fill"];const Cm=Vh.bind(void 0);Cm.style=["stroke","lineWidth"];const Mm=(t,e,n)=>[["M",t,e+n],["L",t,e-n]];Mm.style=["stroke","lineWidth"];const Lm=(t,e,n)=>[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]];Lm.style=["stroke","lineWidth"];const Pm=(t,e,n)=>[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]];Pm.style=["stroke","lineWidth"];const Im=(t,e,n)=>[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]];Im.style=["stroke","lineWidth"];const Rm=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];Rm.style=["stroke","lineWidth"];const Wh=(t,e,n)=>[["M",t-n,e],["L",t+n,e]];Wh.style=["stroke","lineWidth"];const km=Wh.bind(void 0);km.style=["stroke","lineWidth"];const Dm=(t,e,n)=>[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]];Dm.style=["stroke","lineWidth"];const Fm=(t,e,n)=>[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]];Fm.style=["stroke","lineWidth"];const Nm=(t,e,n)=>[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]];Nm.style=["stroke","lineWidth"];const Bm=(t,e,n)=>[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]];Bm.style=["stroke","lineWidth"];const jm=(t,e,n)=>[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]];jm.style=["stroke","lineWidth"];const xc=new Map([["bowtie",Vh],["cross",Lm],["dash",km],["diamond",zh],["dot",Wh],["hexagon",Hh],["hollowBowtie",Cm],["hollowDiamond",Em],["hollowHexagon",Tm],["hollowPoint",xm],["hollowSquare",Om],["hollowTriangle",wm],["hollowTriangleDown",Am],["hv",Fm],["hvh",Bm],["hyphen",Rm],["line",Mm],["plus",Im],["point",jh],["rect",Sm],["smooth",Dm],["square",gf],["tick",Pm],["triangleDown",Zh],["triangle",Uh],["vh",Nm],["vhv",jm]]);function xO(t,e){var{d:n,fill:r,lineWidth:o,path:c,stroke:l,color:u}=e,d=_O(e,["d","fill","lineWidth","path","stroke","color"]);const h=xc.get(t)||xc.get("point");return(...p)=>new F.y$({style:Object.assign(Object.assign({},d),{d:h(...p),stroke:h.style.includes("stroke")?u||l:"",fill:h.style.includes("fill")?u||r:"",lineWidth:h.style.includes("lineWidth")?o||o||2:0})})}function SO(t,e){xc.set(t,e)}function eL(t){xc.delete(t)}const zm={};function Um(t,e){t.startsWith("symbol.")?SO(t.split(".").pop(),e):Object.assign(zm,{[t]:e})}function OO(t,e){var n=e.cx,r=n===void 0?0:n,o=e.cy,c=o===void 0?0:o,l=e.r;t.arc(r,c,l,0,Math.PI*2,!1)}function EO(t,e){var n=e.cx,r=n===void 0?0:n,o=e.cy,c=o===void 0?0:o,l=e.rx,u=e.ry;if(t.ellipse)t.ellipse(r,c,l,u,0,0,Math.PI*2,!1);else{var d=l>u?l:u,h=l>u?1:l/u,p=l>u?u/l:1;t.save(),t.scale(h,p),t.arc(r,c,d,0,Math.PI*2)}}function wO(t,e){var n=e.x1,r=e.y1,o=e.x2,c=e.y2,l=e.markerStart,u=e.markerEnd,d=e.markerStartOffset,h=e.markerEndOffset,p=0,v=0,m=0,b=0,x=0,S,E;l&&(0,F.RV)(l)&&d&&(S=o-n,E=c-r,x=Math.atan2(E,S),p=Math.cos(x)*(d||0),v=Math.sin(x)*(d||0)),u&&(0,F.RV)(u)&&h&&(S=n-o,E=r-c,x=Math.atan2(E,S),m=Math.cos(x)*(h||0),b=Math.sin(x)*(h||0)),t.moveTo(n+p,r+v),t.lineTo(o+m,c+b)}function AO(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.d,u=l.absolutePath,d=l.segments,h=0,p=0,v=0,m=0,b=0,x,S;if(n&&(0,F.RV)(n)&&o){var E=(0,T.CR)(n.parentNode.getStartTangent(),2),w=E[0],M=E[1];x=w[0]-M[0],S=w[1]-M[1],b=Math.atan2(S,x),h=Math.cos(b)*(o||0),p=Math.sin(b)*(o||0)}if(r&&(0,F.RV)(r)&&c){var L=(0,T.CR)(r.parentNode.getEndTangent(),2),w=L[0],M=L[1];x=w[0]-M[0],S=w[1]-M[1],b=Math.atan2(S,x),v=Math.cos(b)*(c||0),m=Math.sin(b)*(c||0)}for(var I=0;I<u.length;I++){var R=u[I],z=R[0],W=u[I+1],Y=I===0&&(h!==0||p!==0),st=(I===u.length-1||W&&(W[0]==="M"||W[0]==="Z"))&&v!==0&&m!==0;switch(z){case"M":Y?t.moveTo(R[1]+h,R[2]+p):t.moveTo(R[1],R[2]);break;case"L":st?t.lineTo(R[1]+v,R[2]+m):t.lineTo(R[1],R[2]);break;case"Q":t.quadraticCurveTo(R[1],R[2],R[3],R[4]),st&&t.lineTo(R[3]+v,R[4]+m);break;case"C":t.bezierCurveTo(R[1],R[2],R[3],R[4],R[5],R[6]),st&&t.lineTo(R[5]+v,R[6]+m);break;case"A":{var xt=d[I].arcParams,Nt=xt.cx,Ht=xt.cy,dt=xt.rx,Ot=xt.ry,bt=xt.startAngle,wt=xt.endAngle,oe=xt.xRotation,Ut=xt.sweepFlag;if(t.ellipse)t.ellipse(Nt,Ht,dt,Ot,oe,bt,wt,!!(1-Ut));else{var Kt=dt>Ot?dt:Ot,me=dt>Ot?1:dt/Ot,Ee=dt>Ot?Ot/dt:1;t.translate(Nt,Ht),t.rotate(oe),t.scale(me,Ee),t.arc(0,0,Kt,bt,wt,!!(1-Ut)),t.scale(1/me,1/Ee),t.rotate(-oe),t.translate(-Nt,-Ht)}st&&t.lineTo(R[6]+v,R[7]+m);break}case"Z":t.closePath();break}}}function TO(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.points.points,u=l.length,d=l[0][0],h=l[0][1],p=l[u-1][0],v=l[u-1][1],m=0,b=0,x=0,S=0,E=0,w,M;n&&(0,F.RV)(n)&&o&&(w=l[1][0]-l[0][0],M=l[1][1]-l[0][1],E=Math.atan2(M,w),m=Math.cos(E)*(o||0),b=Math.sin(E)*(o||0)),r&&(0,F.RV)(r)&&c&&(w=l[u-1][0]-l[0][0],M=l[u-1][1]-l[0][1],E=Math.atan2(M,w),x=Math.cos(E)*(c||0),S=Math.sin(E)*(c||0)),t.moveTo(d+(m||x),h+(b||S));for(var L=1;L<u-1;L++){var I=l[L];t.lineTo(I[0],I[1])}t.lineTo(p,v)}function CO(t,e){var n=e.markerStart,r=e.markerEnd,o=e.markerStartOffset,c=e.markerEndOffset,l=e.points.points,u=l.length,d=l[0][0],h=l[0][1],p=l[u-1][0],v=l[u-1][1],m=0,b=0,x=0,S=0,E=0,w,M;n&&(0,F.RV)(n)&&o&&(w=l[1][0]-l[0][0],M=l[1][1]-l[0][1],E=Math.atan2(M,w),m=Math.cos(E)*(o||0),b=Math.sin(E)*(o||0)),r&&(0,F.RV)(r)&&c&&(w=l[u-2][0]-l[u-1][0],M=l[u-2][1]-l[u-1][1],E=Math.atan2(M,w),x=Math.cos(E)*(c||0),S=Math.sin(E)*(c||0)),t.moveTo(d+m,h+b);for(var L=1;L<u-1;L++){var I=l[L];t.lineTo(I[0],I[1])}t.lineTo(p+x,v+S)}function MO(t,e){var n=e.x,r=n===void 0?0:n,o=e.y,c=o===void 0?0:o,l=e.radius,u=e.width,d=e.height,h=u,p=d,v=l&&l.some(function(I){return I!==0});if(!v)t.rect(r,c,h,p);else{var m=u>0?1:-1,b=d>0?1:-1,x=m+b===0,S=(0,T.CR)(l.map(function(I){return(0,ce.Z)(I,0,Math.min(Math.abs(h)/2,Math.abs(p)/2))}),4),E=S[0],w=S[1],M=S[2],L=S[3];t.moveTo(m*E+r,c),t.lineTo(h-m*w+r,c),w!==0&&t.arc(h-m*w+r,b*w+c,w,-b*Math.PI/2,m>0?0:Math.PI,x),t.lineTo(h+r,p-b*M+c),M!==0&&t.arc(h-m*M+r,p-b*M+c,M,m>0?0:Math.PI,b>0?Math.PI/2:1.5*Math.PI,x),t.lineTo(m*L+r,p+c),L!==0&&t.arc(m*L+r,p-b*L+c,L,b>0?Math.PI/2:-Math.PI/2,m>0?Math.PI:0,x),t.lineTo(r,b*E+c),E!==0&&t.arc(m*E+r,b*E+c,E,m>0?Math.PI:0,b>0?Math.PI*1.5:Math.PI/2,x)}}var LO=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="canvas-path-generator",n}return e.prototype.init=function(){var n,r=(n={},n[F.bn.CIRCLE]=OO,n[F.bn.ELLIPSE]=EO,n[F.bn.RECT]=MO,n[F.bn.LINE]=wO,n[F.bn.POLYLINE]=CO,n[F.bn.POLYGON]=TO,n[F.bn.PATH]=AO,n[F.bn.TEXT]=void 0,n[F.bn.GROUP]=void 0,n[F.bn.IMAGE]=void 0,n[F.bn.HTML]=void 0,n[F.bn.MESH]=void 0,n);this.context.pathGeneratorFactory=r},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(F.F6),Nr=k(11702),PO=k(74873),IO=Pt.Ue(),Zm=Pt.Ue(),Hm=Pt.Ue(),RO=j.create(),Fi=function(){function t(){var e=this;this.isHit=function(n,r,o,c){var l=e.context.pointInPathPickerFactory[n.nodeName];if(l){var u=j.invert(RO,o),d=Pt.fF(Zm,Pt.t8(Hm,r[0],r[1],0),u);if(l(n,new F.E9(d[0],d[1]),c,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(n,r){var o=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),c=e.context.pathGeneratorFactory[n.nodeName];return c&&(o.beginPath(),c(o,n.parsedStyle),o.closePath()),o.isPointInPath(r.x,r.y)}}return t.prototype.apply=function(e,n){var r=this,o,c=e.renderingService,l=e.renderingContext;this.context=e,this.runtime=n;var u=(o=l.root)===null||o===void 0?void 0:o.ownerDocument;c.hooks.pick.tapPromise(t.tag,function(d){return(0,T.mG)(r,void 0,void 0,function(){return(0,T.Jh)(this,function(h){return[2,this.pick(u,d)]})})}),c.hooks.pickSync.tap(t.tag,function(d){return r.pick(u,d)})},t.prototype.pick=function(e,n){var r,o,c=n.topmost,l=n.position,u=l.x,d=l.y,h=Pt.t8(IO,u,d,0),p=e.elementsFromBBox(h[0],h[1],h[0],h[1]),v=[];try{for(var m=(0,T.XA)(p),b=m.next();!b.done;b=m.next()){var x=b.value,S=x.getWorldTransform(),E=this.isHit(x,h,S,!1);if(E){var w=(0,F.Oi)(x);if(w){var M=w.parsedStyle.clipPath,L=this.isHit(M,h,M.getWorldTransform(),!0);if(L){if(c)return n.picked=[x],n;v.push(x)}}else{if(c)return n.picked=[x],n;v.push(x)}}}}catch(I){r={error:I}}finally{try{b&&!b.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}return n.picked=v,n},t.tag="CanvasPicker",t}();function wa(t,e,n){var r=t.parsedStyle,o=r.cx,c=o===void 0?0:o,l=r.cy,u=l===void 0?0:l,d=r.r,h=r.fill,p=r.stroke,v=r.lineWidth,m=v===void 0?1:v,b=r.increasedLineWidthForHitTesting,x=b===void 0?0:b,S=r.pointerEvents,E=S===void 0?"auto":S,w=(m+x)/2,M=(0,Nr.TE)(c,u,e.x,e.y),L=(0,T.CR)((0,F.L1)(E,h,p),2),I=L[0],R=L[1];return I&&R||n?M<=d+w:I?M<=d:R?M>=d-w&&M<=d+w:!1}function Co(t,e,n,r){return t/(n*n)+e/(r*r)}function Sc(t,e,n){var r=t.parsedStyle,o=r.cx,c=o===void 0?0:o,l=r.cy,u=l===void 0?0:l,d=r.rx,h=r.ry,p=r.fill,v=r.stroke,m=r.lineWidth,b=m===void 0?1:m,x=r.increasedLineWidthForHitTesting,S=x===void 0?0:x,E=r.pointerEvents,w=E===void 0?"auto":E,M=e.x,L=e.y,I=(0,T.CR)((0,F.L1)(w,p,v),2),R=I[0],z=I[1],W=(b+S)/2,Y=(M-c)*(M-c),st=(L-u)*(L-u);return R&&z||n?Co(Y,st,d+W,h+W)<=1:R?Co(Y,st,d,h)<=1:z?Co(Y,st,d-W,h-W)>=1&&Co(Y,st,d+W,h+W)<=1:!1}function Wa(t,e,n,r,o,c){return o>=t&&o<=t+n&&c>=e&&c<=e+r}function Vm(t,e,n,r,o,c,l){var u=o/2;return Wa(t-u,e-u,n,o,c,l)||Wa(t+n-u,e-u,o,r,c,l)||Wa(t+u,e+r-u,n,o,c,l)||Wa(t-u,e+u,o,r,c,l)}function Gh(t,e,n,r,o,c,l,u){var d=(Math.atan2(u-e,l-t)+Math.PI*2)%(Math.PI*2),h={x:t+n*Math.cos(d),y:e+n*Math.sin(d)};return(0,Nr.TE)(h.x,h.y,l,u)<=c/2}function ta(t,e,n,r,o,c,l){var u=Math.min(t,n),d=Math.max(t,n),h=Math.min(e,r),p=Math.max(e,r),v=o/2;return c>=u-v&&c<=d+v&&l>=h-v&&l<=p+v?(0,Nr._x)(t,e,n,r,c,l)<=o/2:!1}function kO(t,e,n,r,o){var c=t.length;if(c<2)return!1;for(var l=0;l<c-1;l++){var u=t[l][0],d=t[l][1],h=t[l+1][0],p=t[l+1][1];if(ta(u,d,h,p,e,n,r))return!0}if(o){var v=t[0],m=t[c-1];if(ta(v[0],v[1],m[0],m[1],e,n,r))return!0}return!1}var DO=1e-6;function Yh(t){return Math.abs(t)<DO?0:t<0?-1:1}function nL(t,e,n){return(n[0]-t[0])*(e[1]-t[1])===(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function FO(t,e,n){var r=!1,o=t.length;if(o<=2)return!1;for(var c=0;c<o;c++){var l=t[c],u=t[(c+1)%o];if(nL(l,u,[e,n]))return!0;Yh(l[1]-n)>0!=Yh(u[1]-n)>0&&Yh(e-(n-l[1])*(l[0]-u[0])/(l[1]-u[1])-l[0])<0&&(r=!r)}return r}function Wm(t,e,n){for(var r=!1,o=0;o<t.length;o++){var c=t[o];if(r=FO(c,e,n),r)break}return r}function so(t,e,n){var r=t.parsedStyle,o=r.x1,c=r.y1,l=r.x2,u=r.y2,d=r.lineWidth,h=d===void 0?1:d,p=r.increasedLineWidthForHitTesting,v=p===void 0?0:p,m=r.pointerEvents,b=m===void 0?"auto":m,x=r.fill,S=r.stroke,E=(0,T.CR)((0,F.L1)(b,x,S),2),w=E[1];return!w&&!n||!h?!1:ta(o,c,l,u,h+v,e.x,e.y)}function Gm(t,e,n,r,o){for(var c=!1,l=e/2,u=0;u<t.length;u++){var d=t[u],h=d.currentPoint,p=d.params,v=d.prePoint,m=d.box;if(!(m&&!Wa(m.x-l,m.y-l,m.width+e,m.height+e,n,r)))switch(d.command){case"L":case"Z":if(c=ta(v[0],v[1],h[0],h[1],e,n,r),c)return!0;break;case"Q":var b=(0,Nr.Y1)(v[0],v[1],p[1],p[2],p[3],p[4],n,r);if(c=b<=e/2,c)return!0;break;case"C":var x=(0,Nr.ph)(v[0],v[1],p[1],p[2],p[3],p[4],p[5],p[6],n,r,o);if(c=x<=e/2,c)return!0;break;case"A":d.cubicParams||(d.cubicParams=(0,PO.W)(v[0],v[1],p[1],p[2],p[3],p[4],p[5],p[6],p[7],void 0));for(var S=d.cubicParams,E=v,w=0;w<S.length;w+=6){var M=(0,Nr.ph)(E[0],E[1],S[w],S[w+1],S[w+2],S[w+3],S[w+4],S[w+5],n,r,o);if(E=[S[w+4],S[w+5]],c=M<=e/2,c)return!0}break}}return c}function Ym(t,e,n,r,o,c){var l=t.parsedStyle,u=l.lineWidth,d=u===void 0?1:u,h=l.increasedLineWidthForHitTesting,p=h===void 0?0:h,v=l.stroke,m=l.fill,b=l.d,x=l.pointerEvents,S=x===void 0?"auto":x,E=b.segments,w=b.hasArc,M=b.polylines,L=b.polygons,I=(0,T.CR)((0,F.L1)(S,(L==null?void 0:L.length)&&m,v),2),R=I[0],z=I[1],W=(0,F.gz)(t),Y=!1;return R||n?(w?Y=r(t,e):Y=Wm(L,e.x,e.y)||Wm(M,e.x,e.y),Y):((z||n)&&(Y=Gm(E,d+p,e.x,e.y,W)),Y)}function rL(t,e,n){var r=t.parsedStyle,o=r.stroke,c=r.fill,l=r.lineWidth,u=l===void 0?1:l,d=r.increasedLineWidthForHitTesting,h=d===void 0?0:d,p=r.points,v=r.pointerEvents,m=v===void 0?"auto":v,b=(0,T.CR)((0,F.L1)(m,c,o),2),x=b[0],S=b[1],E=!1;return(S||n)&&(E=kO(p.points,u+h,e.x,e.y,!0)),!E&&(x||n)&&(E=FO(p.points,e.x,e.y)),E}function NO(t,e,n){var r=t.parsedStyle,o=r.lineWidth,c=o===void 0?1:o,l=r.increasedLineWidthForHitTesting,u=l===void 0?0:l,d=r.points,h=r.pointerEvents,p=h===void 0?"auto":h,v=r.fill,m=r.stroke,b=(0,T.CR)((0,F.L1)(p,v,m),2),x=b[1];return!x&&!n||!c?!1:kO(d.points,c+u,e.x,e.y,!1)}function BO(t,e,n,r,o){var c=t.parsedStyle,l=c.radius,u=c.fill,d=c.stroke,h=c.lineWidth,p=h===void 0?1:h,v=c.increasedLineWidthForHitTesting,m=v===void 0?0:v,b=c.x,x=b===void 0?0:b,S=c.y,E=S===void 0?0:S,w=c.width,M=c.height,L=c.pointerEvents,I=L===void 0?"auto":L,R=(0,T.CR)((0,F.L1)(I,u,d),2),z=R[0],W=R[1],Y=l&&l.some(function(Ht){return Ht!==0}),st=p+m;if(Y){var Nt=!1;return(W||n)&&(Nt=iL(x,E,w,M,l.map(function(Ht){return(0,ce.Z)(Ht,0,Math.min(Math.abs(w)/2,Math.abs(M)/2))}),st,e.x,e.y)),!Nt&&(z||n)&&(Nt=r(t,e)),Nt}else{var xt=st/2;if(z&&W||n)return Wa(x-xt,E-xt,w+xt,M+xt,e.x,e.y);if(z)return Wa(x,E,w,M,e.x,e.y);if(W)return Vm(x,E,w,M,st,e.x,e.y)}return!1}function iL(t,e,n,r,o,c,l,u){var d=(0,T.CR)(o,4),h=d[0],p=d[1],v=d[2],m=d[3];return ta(t+h,e,t+n-p,e,c,l,u)||ta(t+n,e+p,t+n,e+r-v,c,l,u)||ta(t+n-v,e+r,t+m,e+r,c,l,u)||ta(t,e+r-m,t,e+h,c,l,u)||Gh(t+n-p,e+p,p,1.5*Math.PI,2*Math.PI,c,l,u)||Gh(t+n-v,e+r-v,v,0,.5*Math.PI,c,l,u)||Gh(t+m,e+r-m,m,.5*Math.PI,Math.PI,c,l,u)||Gh(t+h,e+h,h,Math.PI,1.5*Math.PI,c,l,u)}function $h(t,e,n,r,o,c){var l=t.parsedStyle,u=l.pointerEvents,d=u===void 0?"auto":u,h=l.x,p=h===void 0?0:h,v=l.y,m=v===void 0?0:v,b=l.width,x=l.height;if(d==="non-transparent-pixel"){var S=o.config.offscreenCanvas,E=c.offscreenCanvasCreator.getOrCreateCanvas(S),w=c.offscreenCanvasCreator.getOrCreateContext(S,{willReadFrequently:!0});E.width=b,E.height=x,o.defaultStyleRendererFactory[F.bn.IMAGE].render(w,(0,T.pi)((0,T.pi)({},t.parsedStyle),{x:0,y:0}),t,void 0,void 0,void 0);var M=w.getImageData(e.x-p,e.y-m,1,1).data;return M.every(function(L){return L!==0})}return!0}function jO(t,e,n,r){var o=t.getGeometryBounds();return e.x>=o.min[0]&&e.y>=o.min[1]&&e.x<=o.max[0]&&e.y<=o.max[1]}var $m=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="canvas-picker",n}return e.prototype.init=function(){var n,r=(n={},n[F.bn.CIRCLE]=wa,n[F.bn.ELLIPSE]=Sc,n[F.bn.RECT]=BO,n[F.bn.LINE]=so,n[F.bn.POLYLINE]=NO,n[F.bn.POLYGON]=rL,n[F.bn.PATH]=Ym,n[F.bn.TEXT]=jO,n[F.bn.GROUP]=null,n[F.bn.IMAGE]=$h,n[F.bn.HTML]=null,n[F.bn.MESH]=null,n);this.context.pointInPathPickerFactory=r,this.addRenderingPlugin(new Fi)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(F.F6),zO=function(){function t(e){this.canvasRendererPluginOptions=e,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=j.create(),this.dprMatrix=j.create(),this.tmpMat4=j.create(),this.vec3a=Pt.Ue(),this.vec3b=Pt.Ue(),this.vec3c=Pt.Ue(),this.vec3d=Pt.Ue()}return t.prototype.apply=function(e,n){var r=this;this.context=e;var o=e.config,c=e.camera,l=e.renderingService,u=e.renderingContext,d=e.rBushRoot,h=e.pathGeneratorFactory;this.rBush=d,this.pathGeneratorFactory=h;var p=e.contextService,v=u.root.ownerDocument.defaultView,m=function(S){var E=S.target,w=E.rBushNode;w.aabb&&r.removedRBushNodeAABBs.push(w.aabb)},b=function(S){var E=S.target,w=E.rBushNode;w.aabb&&r.removedRBushNodeAABBs.push(w.aabb)};l.hooks.init.tap(t.tag,function(){v.addEventListener(F.Dk.UNMOUNTED,m),v.addEventListener(F.Dk.CULLED,b);var S=p.getDPR(),E=o.width,w=o.height,M=p.getContext();r.clearRect(M,0,0,E*S,w*S,o.background)}),l.hooks.destroy.tap(t.tag,function(){v.removeEventListener(F.Dk.UNMOUNTED,m),v.removeEventListener(F.Dk.CULLED,b),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),l.hooks.beginFrame.tap(t.tag,function(){var S,E=p.getContext(),w=p.getDPR(),M=o.width,L=o.height,I=r.canvasRendererPluginOptions,R=I.dirtyObjectNumThreshold,z=I.dirtyObjectRatioThreshold,W=l.getStats(),Y=W.total,st=W.rendered,xt=st/Y;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((S=v.context.renderingPlugins[1])===null||S===void 0)&&S.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||st>R&&xt>z,E&&(E.resetTransform?E.resetTransform():E.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(E,0,0,M*w,L*w,o.background))});var x=function(S,E){S.isVisible()&&!S.isCulled()&&r.renderDisplayObject(S,E,r.context,r.restoreStack,n);var w=S.sortable.sorted||S.childNodes;w.forEach(function(M){x(M,E)})};l.hooks.endFrame.tap(t.tag,function(){if(u.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var S=p.getContext(),E=p.getDPR();if(j.fromScaling(r.dprMatrix,[E,E,1]),j.multiply(r.vpMatrix,r.dprMatrix,c.getOrthoMatrix()),r.clearFullScreen)x(u.root,S);else{var w=r.safeMergeAABB.apply(r,(0,T.ev)([r.mergeDirtyAABBs(r.renderQueue)],(0,T.CR)(r.removedRBushNodeAABBs.map(function(Ee){var Pe=Ee.minX,Ie=Ee.minY,qe=Ee.maxX,sn=Ee.maxY,yn=new F.mN;return yn.setMinMax([Pe,Ie,0],[qe,sn,0]),yn})),!1));if(r.removedRBushNodeAABBs=[],F.mN.isEmpty(w)){r.renderQueue=[];return}var M=r.convertAABB2Rect(w),L=M.x,I=M.y,R=M.width,z=M.height,W=Pt.fF(r.vec3a,[L,I,0],r.vpMatrix),Y=Pt.fF(r.vec3b,[L+R,I,0],r.vpMatrix),st=Pt.fF(r.vec3c,[L,I+z,0],r.vpMatrix),xt=Pt.fF(r.vec3d,[L+R,I+z,0],r.vpMatrix),Nt=Math.min(W[0],Y[0],xt[0],st[0]),Ht=Math.min(W[1],Y[1],xt[1],st[1]),dt=Math.max(W[0],Y[0],xt[0],st[0]),Ot=Math.max(W[1],Y[1],xt[1],st[1]),bt=Math.floor(Nt),wt=Math.floor(Ht),oe=Math.ceil(dt-Nt),Ut=Math.ceil(Ot-Ht);S.save(),r.clearRect(S,bt,wt,oe,Ut,o.background),S.beginPath(),S.rect(bt,wt,oe,Ut),S.clip(),S.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var Kt=o.renderer.getConfig().enableDirtyRectangleRenderingDebug;Kt&&v.dispatchEvent(new F.Aw(F.$6.DIRTY_RECTANGLE,{dirtyRect:{x:bt,y:wt,width:oe,height:Ut}}));var me=r.searchDirtyObjects(w);me.sort(function(Ee,Pe){return Ee.sortable.renderOrder-Pe.sortable.renderOrder}).forEach(function(Ee){Ee&&Ee.isVisible()&&!Ee.isCulled()&&r.renderDisplayObject(Ee,S,r.context,r.restoreStack,n)}),S.restore(),r.renderQueue.forEach(function(Ee){r.saveDirtyAABB(Ee)}),r.renderQueue=[]}r.restoreStack.forEach(function(){S.restore()}),r.restoreStack=[]}),l.hooks.render.tap(t.tag,function(S){r.clearFullScreen||r.renderQueue.push(S)})},t.prototype.clearRect=function(e,n,r,o,c,l){e.clearRect(n,r,o,c),l&&(e.fillStyle=l,e.fillRect(n,r,o,c))},t.prototype.renderDisplayObject=function(e,n,r,o,c){var l=e.nodeName,u=o[o.length-1];u&&!(e.compareDocumentPosition(u)&F.NB.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),o.pop());var d=this.context.styleRendererFactory[l],h=this.pathGeneratorFactory[l],p=e.parsedStyle.clipPath;if(p){this.applyWorldTransform(n,p);var v=this.pathGeneratorFactory[p.nodeName];v&&(n.save(),o.push(e),n.beginPath(),v(n,p.parsedStyle),n.closePath(),n.clip())}d&&(this.applyWorldTransform(n,e),n.save(),this.applyAttributesToContext(n,e)),h&&(n.beginPath(),h(n,e.parsedStyle),e.nodeName!==F.bn.LINE&&e.nodeName!==F.bn.PATH&&e.nodeName!==F.bn.POLYLINE&&n.closePath()),d&&(d.render(n,e.parsedStyle,e,r,this,c),n.restore()),e.renderable.dirty=!1},t.prototype.convertAABB2Rect=function(e){var n=e.getMin(),r=e.getMax(),o=Math.floor(n[0]),c=Math.floor(n[1]),l=Math.ceil(r[0]),u=Math.ceil(r[1]),d=l-o,h=u-c;return{x:o,y:c,width:d,height:h}},t.prototype.mergeDirtyAABBs=function(e){var n=new F.mN;return e.forEach(function(r){var o=r.getRenderBounds();n.add(o);var c=r.renderable.dirtyRenderBounds;c&&n.add(c)}),n},t.prototype.searchDirtyObjects=function(e){var n=(0,T.CR)(e.getMin(),2),r=n[0],o=n[1],c=(0,T.CR)(e.getMax(),2),l=c[0],u=c[1],d=this.rBush.search({minX:r,minY:o,maxX:l,maxY:u});return d.map(function(h){var p=h.displayObject;return p})},t.prototype.saveDirtyAABB=function(e){var n=e.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new F.mN);var r=e.getRenderBounds();r&&n.dirtyRenderBounds.update(r.center,r.halfExtents)},t.prototype.applyAttributesToContext=function(e,n){var r=n.parsedStyle,o=r.stroke,c=r.fill,l=r.opacity,u=r.lineDash,d=r.lineDashOffset;u&&e.setLineDash(u),(0,fe.Z)(d)||(e.lineDashOffset=d),(0,fe.Z)(l)||(e.globalAlpha*=l),!(0,fe.Z)(o)&&!Array.isArray(o)&&!o.isNone&&(e.strokeStyle=n.attributes.stroke),!(0,fe.Z)(c)&&!Array.isArray(c)&&!c.isNone&&(e.fillStyle=n.attributes.fill)},t.prototype.applyWorldTransform=function(e,n,r){r?(j.copy(this.tmpMat4,n.getLocalTransform()),j.multiply(this.tmpMat4,r,this.tmpMat4),j.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(j.copy(this.tmpMat4,n.getWorldTransform()),j.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},t.prototype.safeMergeAABB=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=new F.mN;return e.forEach(function(o){r.add(o)}),r},t.tag="CanvasRenderer",t}(),Ga=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r,o,c,l){var u=n.fill,d=n.fillRule,h=n.opacity,p=h===void 0?1:h,v=n.fillOpacity,m=v===void 0?1:v,b=n.stroke,x=n.strokeOpacity,S=x===void 0?1:x,E=n.lineWidth,w=E===void 0?1:E,M=n.lineCap,L=n.lineJoin,I=n.shadowType,R=n.shadowColor,z=n.shadowBlur,W=n.filter,Y=n.miterLimit,st=u&&!u.isNone,xt=b&&!b.isNone&&w>0,Nt=(u==null?void 0:u.alpha)===0,Ht=!!(W&&W.length),dt=!(0,fe.Z)(R)&&z>0,Ot=r.nodeName,bt=I==="inner",wt=xt&&dt&&(Ot===F.bn.PATH||Ot===F.bn.LINE||Ot===F.bn.POLYLINE||Nt||bt);st&&(e.globalAlpha=p*m,wt||vf(r,e,dt),ZO(e,r,u,d,o,c,l,this.imagePool),wt||this.clearShadowAndFilter(e,Ht,dt)),xt&&(e.globalAlpha=p*S,e.lineWidth=w,(0,fe.Z)(Y)||(e.miterLimit=Y),(0,fe.Z)(M)||(e.lineCap=M),(0,fe.Z)(L)||(e.lineJoin=L),wt&&(bt&&(e.globalCompositeOperation="source-atop"),vf(r,e,!0),bt&&(Xm(e,r,b,o,c,l,this.imagePool),e.globalCompositeOperation="source-over",this.clearShadowAndFilter(e,Ht,!0))),Xm(e,r,b,o,c,l,this.imagePool))},t.prototype.clearShadowAndFilter=function(e,n,r){if(r&&(e.shadowColor="transparent",e.shadowBlur=0),n){var o=e.filter;!(0,fe.Z)(o)&&o.indexOf("drop-shadow")>-1&&(e.filter=o.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},t}();function vf(t,e,n){var r=t.parsedStyle,o=r.filter,c=r.shadowColor,l=r.shadowBlur,u=r.shadowOffsetX,d=r.shadowOffsetY;o&&o.length&&(e.filter=t.style.filter),n&&(e.shadowColor=c.toString(),e.shadowBlur=l||0,e.shadowOffsetX=u||0,e.shadowOffsetY=d||0)}function UO(t,e,n,r,o,c,l){var u,d;if(t.image.nodeName==="rect"){var h=t.image.parsedStyle,p=h.width,v=h.height;d=r.contextService.getDPR();var m=r.config.offscreenCanvas;u=c.offscreenCanvasCreator.getOrCreateCanvas(m),u.width=p*d,u.height=v*d;var b=c.offscreenCanvasCreator.getOrCreateContext(m),x=[];t.image.forEach(function(E){o.renderDisplayObject(E,b,r,x,c)}),x.forEach(function(){b.restore()})}var S=l.getOrCreatePatternSync(t,n,u,d,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,r.renderingService.dirtify()});return S}function wl(t,e,n,r){var o;if(t.type===F.GL.LinearGradient||t.type===F.GL.RadialGradient){var c=e.getGeometryBounds(),l=c&&c.halfExtents[0]*2||1,u=c&&c.halfExtents[1]*2||1,d=c&&c.min||[0,0];o=r.getOrCreateGradient((0,T.pi)((0,T.pi)({type:t.type},t.value),{min:d,width:l,height:u}),n)}return o}function ZO(t,e,n,r,o,c,l,u,d){d===void 0&&(d=!1),Array.isArray(n)?n.forEach(function(h){t.fillStyle=wl(h,e,t,u),d||(r?t.fill(r):t.fill())}):((0,F.R)(n)&&(t.fillStyle=UO(n,e,t,o,c,l,u)),d||(r?t.fill(r):t.fill()))}function Xm(t,e,n,r,o,c,l,u){u===void 0&&(u=!1),Array.isArray(n)?n.forEach(function(d){t.strokeStyle=wl(d,e,t,l),u||t.stroke()}):((0,F.R)(n)&&(t.strokeStyle=UO(n,e,t,r,o,c,l)),u||t.stroke())}var oL=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r){var o=n.x,c=o===void 0?0:o,l=n.y,u=l===void 0?0:l,d=n.width,h=n.height,p=n.src,v=n.shadowColor,m=n.shadowBlur,b,x=d,S=h;if((0,gt.Z)(p)?b=this.imagePool.getImageSync(p):(x||(x=p.width),S||(S=p.height),b=p),b){var E=!(0,fe.Z)(v)&&m>0;vf(r,e,E);try{e.drawImage(b,c,u,x,S)}catch(w){}}},t}(),aL=function(){function t(e){this.imagePool=e}return t.prototype.render=function(e,n,r,o,c,l){r.getBounds();var u=n,d=u.lineWidth,h=d===void 0?1:d,p=u.textAlign,v=p===void 0?"start":p,m=u.textBaseline,b=m===void 0?"alphabetic":m,x=u.lineJoin,S=x===void 0?"miter":x,E=u.miterLimit,w=E===void 0?10:E,M=u.letterSpacing,L=M===void 0?0:M,I=u.stroke,R=u.fill,z=u.fillRule,W=u.fillOpacity,Y=W===void 0?1:W,st=u.strokeOpacity,xt=st===void 0?1:st,Nt=u.opacity,Ht=Nt===void 0?1:Nt,dt=u.metrics,Ot=u.x,bt=Ot===void 0?0:Ot,wt=u.y,oe=wt===void 0?0:wt,Ut=u.dx,Kt=u.dy,me=u.shadowColor,Ee=u.shadowBlur,Pe=dt.font,Ie=dt.lines,qe=dt.height,sn=dt.lineHeight,yn=dt.lineMetrics;e.font=Pe,e.lineWidth=h,e.textAlign=v==="middle"?"center":v;var on=b;!l.enableCSSParsing&&on==="alphabetic"&&(on="bottom"),e.lineJoin=S,(0,fe.Z)(w)||(e.miterLimit=w);var rn=oe;b==="middle"?rn+=-qe/2-sn/2:b==="bottom"||b==="alphabetic"||b==="ideographic"?rn+=-qe:(b==="top"||b==="hanging")&&(rn+=-sn);var Rn=bt+(Ut||0);rn+=Kt||0,Ie.length===1&&(on==="bottom"?(on="middle",rn-=.5*qe):on==="top"&&(on="middle",rn+=.5*qe)),e.textBaseline=on;var xn=!(0,fe.Z)(me)&&Ee>0;vf(r,e,xn);for(var gn=0;gn<Ie.length;gn++){var Cn=h/2+Rn;rn+=sn,!(0,fe.Z)(I)&&!I.isNone&&h&&this.drawLetterSpacing(e,r,Ie[gn],yn[gn],v,Cn,rn,L,R,z,Y,I,xt,Ht,!0,o,c,l),(0,fe.Z)(R)||this.drawLetterSpacing(e,r,Ie[gn],yn[gn],v,Cn,rn,L,R,z,Y,I,xt,Ht,!1,o,c,l)}},t.prototype.drawLetterSpacing=function(e,n,r,o,c,l,u,d,h,p,v,m,b,x,S,E,w,M){if(d===0){S?this.strokeText(e,n,r,l,u,m,b,E,w,M):this.fillText(e,n,r,l,u,h,p,v,x,E,w,M);return}var L=e.textAlign;e.textAlign="left";var I=l;c==="center"||c==="middle"?I=l-o.width/2:(c==="right"||c==="end")&&(I=l-o.width);for(var R=Array.from(r),z=e.measureText(r).width,W=0,Y=0;Y<R.length;++Y){var st=R[Y];S?this.strokeText(e,n,st,I,u,m,b,E,w,M):this.fillText(e,n,st,I,u,h,p,v,x,E,w,M),W=e.measureText(r.substring(Y+1)).width,I+=z-W+d,z=W}e.textAlign=L},t.prototype.fillText=function(e,n,r,o,c,l,u,d,h,p,v,m){ZO(e,n,l,u,p,v,m,this.imagePool,!0);var b,x=!(0,fe.Z)(d)&&d!==1;x&&(b=e.globalAlpha,e.globalAlpha=d*h),e.fillText(r,o,c),x&&(e.globalAlpha=b)},t.prototype.strokeText=function(e,n,r,o,c,l,u,d,h,p){Xm(e,n,l,d,h,p,this.imagePool,!0);var v,m=!(0,fe.Z)(u)&&u!==1;m&&(v=e.globalAlpha,e.globalAlpha=u),e.strokeText(r,o,c),m&&(e.globalAlpha=v)},t}(),QR=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),qm=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),sL=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),Km=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),Ai=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),Xh=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),cL=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ga),HO=function(t){(0,T.ZT)(e,t);function e(n){n===void 0&&(n={});var r=t.call(this)||this;return r.options=n,r.name="canvas-renderer",r}return e.prototype.init=function(){var n,r=(0,T.pi)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),o=this.context.imagePool,c=new Ga(o),l=(n={},n[F.bn.CIRCLE]=c,n[F.bn.ELLIPSE]=c,n[F.bn.RECT]=c,n[F.bn.IMAGE]=new oL(o),n[F.bn.TEXT]=new aL(o),n[F.bn.LINE]=c,n[F.bn.POLYLINE]=c,n[F.bn.POLYGON]=c,n[F.bn.PATH]=c,n[F.bn.GROUP]=void 0,n[F.bn.HTML]=void 0,n[F.bn.MESH]=void 0,n);this.context.defaultStyleRendererFactory=l,this.context.styleRendererFactory=l,this.addRenderingPlugin(new zO(r))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(F.F6),Qm=function(){function t(){}return t.prototype.apply=function(e,n){var r=this,o=e.renderingService,c=e.renderingContext,l=e.config;this.context=e;var u=c.root.ownerDocument.defaultView,d=function(z){o.hooks.pointerMove.call(z)},h=function(z){o.hooks.pointerUp.call(z)},p=function(z){o.hooks.pointerDown.call(z)},v=function(z){o.hooks.pointerOver.call(z)},m=function(z){o.hooks.pointerOut.call(z)},b=function(z){o.hooks.pointerCancel.call(z)},x=function(z){o.hooks.pointerWheel.call(z)},S=function(z){o.hooks.click.call(z)},E=function(z){n.globalThis.document.addEventListener("pointermove",d,!0),z.addEventListener("pointerdown",p,!0),z.addEventListener("pointerleave",m,!0),z.addEventListener("pointerover",v,!0),n.globalThis.addEventListener("pointerup",h,!0),n.globalThis.addEventListener("pointercancel",b,!0)},w=function(z){z.addEventListener("touchstart",p,!0),z.addEventListener("touchend",h,!0),z.addEventListener("touchmove",d,!0),z.addEventListener("touchcancel",b,!0)},M=function(z){n.globalThis.document.addEventListener("mousemove",d,!0),z.addEventListener("mousedown",p,!0),z.addEventListener("mouseout",m,!0),z.addEventListener("mouseover",v,!0),n.globalThis.addEventListener("mouseup",h,!0)},L=function(z){n.globalThis.document.removeEventListener("pointermove",d,!0),z.removeEventListener("pointerdown",p,!0),z.removeEventListener("pointerleave",m,!0),z.removeEventListener("pointerover",v,!0),n.globalThis.removeEventListener("pointerup",h,!0)},I=function(z){z.removeEventListener("touchstart",p,!0),z.removeEventListener("touchend",h,!0),z.removeEventListener("touchmove",d,!0),z.removeEventListener("touchcancel",b,!0)},R=function(z){n.globalThis.document.removeEventListener("mousemove",d,!0),z.removeEventListener("mousedown",p,!0),z.removeEventListener("mouseout",m,!0),z.removeEventListener("mouseover",v,!0),n.globalThis.removeEventListener("mouseup",h,!0)};o.hooks.init.tap(t.tag,function(){var z=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(z.style.msContentZooming="none",z.style.msTouchAction="none"):u.supportsPointerEvents&&(z.style.touchAction="none"),u.supportsPointerEvents?E(z):M(z),u.supportsTouchEvents&&w(z),l.useNativeClickEvent&&z.addEventListener("click",S,!0),z.addEventListener("wheel",x,{passive:!0,capture:!0})}),o.hooks.destroy.tap(t.tag,function(){var z=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(z.style.msContentZooming="",z.style.msTouchAction=""):u.supportsPointerEvents&&(z.style.touchAction=""),u.supportsPointerEvents?L(z):R(z),u.supportsTouchEvents&&I(z),l.useNativeClickEvent&&z.removeEventListener("click",S,!0),z.removeEventListener("wheel",x,!0)})},t.tag="DOMInteraction",t}(),lL=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="dom-interaction",n}return e.prototype.init=function(){this.addRenderingPlugin(new Qm)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(F.F6),Jm="g-canvas-camera",mf=function(){function t(){this.displayObjectHTMLElementMap=new WeakMap}return t.prototype.joinTransformMatrix=function(e,n){return n===void 0&&(n=[0,0,0]),"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+n[0],e[13]+n[1]].join(","),")")},t.prototype.apply=function(e,n){var r=this,o=e.camera,c=e.renderingContext,l=e.renderingService;this.context=e;var u=c.root.ownerDocument.defaultView,d=u.context.eventService.nativeHTMLMap,h=function(S,E){E.style.transform=r.joinTransformMatrix(S.getWorldTransform(),S.getOrigin())},p=function(S){var E=S.target;if(E.nodeName===F.bn.HTML){r.$camera||(r.$camera=r.createCamera(o));var w=r.getOrCreateEl(E);if(r.$camera.appendChild(w),n.enableCSSParsing){var M=E.ownerDocument.documentElement.attributes;Object.keys(M).forEach(function(L){w.style[L]=M[L]})}Object.keys(E.attributes).forEach(function(L){r.updateAttribute(L,E)}),h(E,w),d.set(w,E)}},v=function(S){var E=S.target;if(E.nodeName===F.bn.HTML&&r.$camera){var w=r.getOrCreateEl(E);w&&(w.remove(),d.delete(w))}},m=function(S){var E=S.target;if(E.nodeName===F.bn.HTML){var w=S.attrName;r.updateAttribute(w,E)}},b=function(S){var E=S.target;if(E.nodeName===F.bn.HTML){var w=r.getOrCreateEl(E);h(E,w)}},x=function(){if(r.$camera){var S=r.context.config,E=S.width,w=S.height;r.$camera.parentElement.style.width="".concat(E||0,"px"),r.$camera.parentElement.style.height="".concat(w||0,"px")}};l.hooks.init.tap(t.tag,function(){u.addEventListener(F.$6.RESIZE,x),u.addEventListener(F.Dk.MOUNTED,p),u.addEventListener(F.Dk.UNMOUNTED,v),u.addEventListener(F.Dk.ATTR_MODIFIED,m),u.addEventListener(F.Dk.BOUNDS_CHANGED,b)}),l.hooks.endFrame.tap(t.tag,function(){r.$camera&&c.renderReasons.has(F.Rr.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(o.getOrthoMatrix()))}),l.hooks.destroy.tap(t.tag,function(){r.$camera&&r.$camera.remove(),u.removeEventListener(F.$6.RESIZE,x),u.removeEventListener(F.Dk.MOUNTED,p),u.removeEventListener(F.Dk.UNMOUNTED,v),u.removeEventListener(F.Dk.ATTR_MODIFIED,m),u.removeEventListener(F.Dk.BOUNDS_CHANGED,b)})},t.prototype.createCamera=function(e){var n=this.context.config,r=n.document,o=n.width,c=n.height,l=this.context.contextService.getDomElement(),u=l.parentNode;if(u){var d=Jm,h=u.querySelector("#"+d);if(!h){var p=(r||document).createElement("div");p.style.overflow="hidden",p.style.pointerEvents="none",p.style.position="absolute",p.style.left="0px",p.style.top="0px",p.style.width="".concat(o||0,"px"),p.style.height="".concat(c||0,"px");var v=(r||document).createElement("div");h=v,v.id=d,v.style.position="absolute",v.style.left="".concat(l.offsetLeft||0,"px"),v.style.top="".concat(l.offsetTop||0,"px"),v.style.transformOrigin="left top",v.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),v.style.pointerEvents="none",v.style.width="100%",v.style.height="100%",p.appendChild(v),u.appendChild(p)}return h}return null},t.prototype.getOrCreateEl=function(e){var n=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(n||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),r},t.prototype.updateAttribute=function(e,n){var r=this.getOrCreateEl(n);switch(e){case"innerHTML":var o=n.parsedStyle.innerHTML;(0,gt.Z)(o)?r.innerHTML=o:(r.innerHTML="",r.appendChild(o));break;case"x":r.style.left="".concat(n.parsedStyle.x,"px");break;case"y":r.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var c=n.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(c[0].buildCSSText(null,null,"")," ").concat(c[1].buildCSSText(null,null,""));break;case"width":if(this.context.enableCSSParsing){var l=n.computedStyleMap().get("width");r.style.width=l.toString()}else{var l=n.parsedStyle.width;r.style.width=(0,ne.Z)(l)?"".concat(l,"px"):l.toString()}break;case"height":if(this.context.enableCSSParsing){var u=n.computedStyleMap().get("height");r.style.height=u.toString()}else{var u=n.parsedStyle.height;r.style.height=(0,ne.Z)(u)?"".concat(u,"px"):u.toString()}break;case"zIndex":var d=n.parsedStyle.zIndex;r.style["z-index"]="".concat(d);break;case"visibility":var h=n.parsedStyle.visibility;r.style.visibility=h;break;case"pointerEvents":var p=n.parsedStyle.pointerEvents,v=p===void 0?"auto":p;r.style.pointerEvents=v;break;case"opacity":var m=n.parsedStyle.opacity;r.style.opacity="".concat(m);break;case"fill":var b=n.parsedStyle.fill,x="";(0,F.qA)(b)?b.isNone?x="transparent":x=n.getAttribute("fill"):Array.isArray(b)?x=n.getAttribute("fill"):(0,F.R)(b),r.style.background=x;break;case"stroke":var S=n.parsedStyle.stroke,E="";(0,F.qA)(S)?S.isNone?E="transparent":E=n.getAttribute("stroke"):Array.isArray(S)?E=n.getAttribute("stroke"):(0,F.R)(S),r.style["border-color"]=E,r.style["border-style"]="solid";break;case"lineWidth":var w=n.parsedStyle.lineWidth;r.style["border-width"]="".concat(w||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var M=n.style.filter;r.style.filter=M;break;default:!(0,fe.Z)(n.style[e])&&n.style[e]!==""&&(r.style[e]=n.style[e])}},t.tag="HTMLRendering",t}(),uL=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="html-renderer",n}return e.prototype.init=function(){this.addRenderingPlugin(new mf)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(F.F6),VO=function(){function t(e){this.canvasConfig=e,this.imageCache={},this.gradientCache={},this.patternCache={}}return t.prototype.getImageSync=function(e,n){return this.imageCache[e]?n&&n(this.imageCache[e]):this.getOrCreateImage(e).then(function(r){n&&n(r)}),this.imageCache[e]},t.prototype.getOrCreateImage=function(e){var n=this;if(this.imageCache[e])return Promise.resolve(this.imageCache[e]);var r=this.canvasConfig.createImage;return new Promise(function(o,c){var l;r?l=r(e):F.jU&&(l=new window.Image),l&&(l.onload=function(){n.imageCache[e]=l,o(l)},l.onerror=function(u){c(u)},l.crossOrigin="Anonymous",l.src=e)})},t.prototype.getOrCreatePatternSync=function(e,n,r,o,c,l){var u=this.generatePatternKey(e);if(u&&this.patternCache[u])return this.patternCache[u];var d=e.image,h=e.repetition,p=e.transform,v,m=!1;(0,gt.Z)(d)?v=this.getImageSync(d,l):r?(v=r,m=!0):v=d;var b=v&&n.createPattern(v,h);if(b){var x=void 0;p?x=(0,F.G0)((0,F.G$)(p),new F.s$({})):x=j.identity(j.create()),m&&j.scale(x,x,[1/o,1/o,1]),b.setTransform({a:x[0],b:x[1],c:x[4],d:x[5],e:x[12]+c[0],f:x[13]+c[1]})}return u&&b&&(this.patternCache[u]=b),b},t.prototype.getOrCreateGradient=function(e,n){var r=this.generateGradientKey(e),o=e.type,c=e.steps,l=e.min,u=e.width,d=e.height,h=e.angle,p=e.cx,v=e.cy,m=e.size;if(this.gradientCache[r])return this.gradientCache[r];var b=null;if(o===F.GL.LinearGradient){var x=(0,F.Rx)(l,u,d,h),S=x.x1,E=x.y1,w=x.x2,M=x.y2;b=n.createLinearGradient(S,E,w,M)}else if(o===F.GL.RadialGradient){var L=(0,F.o6)(l,u,d,p,v,m),I=L.x,R=L.y,z=L.r;b=n.createRadialGradient(I,R,0,I,R,z)}return b&&(c.forEach(function(W){var Y=W.offset,st=W.color;Y.unit===F.Cm.kPercentage&&(b==null||b.addColorStop(Y.value/100,st.toString()))}),this.gradientCache[r]=b),this.gradientCache[r]},t.prototype.generateGradientKey=function(e){var n=e.type,r=e.min,o=e.width,c=e.height,l=e.steps,u=e.angle,d=e.cx,h=e.cy,p=e.size;return"gradient-".concat(n,"-").concat((u==null?void 0:u.toString())||0,"-").concat((d==null?void 0:d.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat((p==null?void 0:p.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(o,"-").concat(c,"-").concat(l.map(function(v){var m=v.offset,b=v.color;return"".concat(m).concat(b)}).join("-"))},t.prototype.generatePatternKey=function(e){var n=e.image,r=e.repetition;if((0,gt.Z)(n))return"pattern-".concat(n,"-").concat(r);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(r)},t}(),WO=function(){function t(){}return t.prototype.apply=function(e){var n=e.renderingService,r=e.renderingContext,o=e.imagePool,c=r.root.ownerDocument.defaultView,l=function(h,p,v){var m=h.parsedStyle,b=m.width,x=m.height;b&&!x?h.setAttribute("height",v/p*b):!b&&x&&h.setAttribute("width",p/v*x)},u=function(h){var p=h.target,v=p.nodeName,m=p.attributes;if(v===F.bn.IMAGE){var b=m.src,x=m.keepAspectRatio;(0,gt.Z)(b)&&o.getImageSync(b,function(S){var E=S.width,w=S.height;x&&l(p,E,w),p.renderable.dirty=!0,n.dirtify()})}},d=function(h){var p=h.target,v=h.attrName,m=h.newValue;p.nodeName===F.bn.IMAGE&&v==="src"&&(0,gt.Z)(m)&&o.getOrCreateImage(m).then(function(b){var x=b.width,S=b.height;p.attributes.keepAspectRatio&&l(p,x,S),p.renderable.dirty=!0,n.dirtify()})};n.hooks.init.tap(t.tag,function(){c.addEventListener(F.Dk.MOUNTED,u),c.addEventListener(F.Dk.ATTR_MODIFIED,d)}),n.hooks.destroy.tap(t.tag,function(){c.removeEventListener(F.Dk.MOUNTED,u),c.removeEventListener(F.Dk.ATTR_MODIFIED,d)})},t.tag="LoadImage",t}(),GO=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="image-loader",n}return e.prototype.init=function(){this.context.imagePool=new VO(this.context.config),this.addRenderingPlugin(new WO)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(F.F6),Mo=function(){function t(e){this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return t.prototype.init=function(){var e=this.canvasConfig,n=e.container,r=e.canvas;if(r)this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=(0,gt.Z)(n)?document.getElementById(n):n,this.$container)){var o=document.createElement("canvas");this.$container.appendChild(o),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=o}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(e,n){var r=this.canvasConfig.devicePixelRatio,o=r||F.jU&&window.devicePixelRatio||1;o=o>=1?Math.ceil(o):1,this.dpr=o,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*n,(0,F.$p)(this.$canvas,e,n)),this.renderingContext.renderReasons.add(F.Rr.CAMERA_CHANGED)},t.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},t.prototype.toDataURL=function(){return(0,T.mG)(this,arguments,void 0,function(e){var n,r;return e===void 0&&(e={}),(0,T.Jh)(this,function(o){return n=e.type,r=e.encoderOptions,[2,this.context.canvas.toDataURL(n,r)]})})},t}(),fL=function(t){(0,T.ZT)(e,t);function e(){var n=t.apply(this,(0,T.ev)([],(0,T.CR)(arguments),!1))||this;return n.name="canvas-context-register",n}return e.prototype.init=function(){this.context.ContextService=Mo},e.prototype.destroy=function(){delete this.context.ContextService},e}(F.F6),YO=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n)||this;return r.registerPlugin(new fL),r.registerPlugin(new GO),r.registerPlugin(new LO),r.registerPlugin(new HO),r.registerPlugin(new lL),r.registerPlugin(new $m),r.registerPlugin(new uL),r}return e}(F.I8),dL=k(44078),hL=function(){function t(e){this.dragndropPluginOptions=e}return t.prototype.apply=function(e){var n=this,r=e.renderingService,o=e.renderingContext,c=o.root.ownerDocument,l=c.defaultView,u=function(d){var h=d.target,p=h===c,v=p&&n.dragndropPluginOptions.isDocumentDraggable?c:h.closest&&h.closest("[draggable=true]");if(v){var m=!1,b=d.timeStamp,x=[d.clientX,d.clientY],S=null,E=[d.clientX,d.clientY],w=function(L){return(0,T.mG)(n,void 0,void 0,function(){var I,R,z,W,Y,st;return(0,T.Jh)(this,function(xt){switch(xt.label){case 0:if(!m){if(I=L.timeStamp-b,R=(0,dL.y)([L.clientX,L.clientY],x),I<=this.dragndropPluginOptions.dragstartTimeThreshold||R<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];L.type="dragstart",v.dispatchEvent(L),m=!0}return L.type="drag",L.dx=L.clientX-E[0],L.dy=L.clientY-E[1],v.dispatchEvent(L),E=[L.clientX,L.clientY],p?[3,2]:(z=this.dragndropPluginOptions.overlap==="pointer"?[L.canvasX,L.canvasY]:h.getBounds().center,[4,c.elementsFromPoint(z[0],z[1])]);case 1:W=xt.sent(),Y=W[W.indexOf(h)+1],st=(Y==null?void 0:Y.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?c:null),S!==st&&(S&&(L.type="dragleave",L.target=S,S.dispatchEvent(L)),st&&(L.type="dragenter",L.target=st,st.dispatchEvent(L)),S=st,S&&(L.type="dragover",L.target=S,S.dispatchEvent(L))),xt.label=2;case 2:return[2]}})})};l.addEventListener("pointermove",w);var M=function(L){if(m){L.detail={preventClick:!0};var I=L.clone();S&&(I.type="drop",I.target=S,S.dispatchEvent(I)),I.type="dragend",v.dispatchEvent(I),m=!1}l.removeEventListener("pointermove",w)};h.addEventListener("pointerup",M,{once:!0}),h.addEventListener("pointerupoutside",M,{once:!0})}};r.hooks.init.tap(t.tag,function(){l.addEventListener("pointerdown",u)}),r.hooks.destroy.tap(t.tag,function(){l.removeEventListener("pointerdown",u)})},t.tag="Dragndrop",t}(),$O=function(t){(0,T.ZT)(e,t);function e(n){n===void 0&&(n={});var r=t.call(this)||this;return r.options=n,r.name="dragndrop",r}return e.prototype.init=function(){this.addRenderingPlugin(new hL((0,T.pi)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)},e}(F.F6);function qh(t,e,n){var r;return function(){var o=this,c=arguments,l=function(){r=null,n||t.apply(o,c)},u=n&&!r;clearTimeout(r),r=setTimeout(l,e),u&&t.apply(o,c)}}var Kh=qh,mi=k(5199),XO=function(t){return typeof t=="object"&&t!==null},yf=XO,qO=k(95456),ty=function(t){if(!yf(t)||!(0,qO.Z)(t,"Object"))return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},Ya=ty,KO=5;function pL(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(t==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function $a(t,e,n,r){n=n||0,r=r||KO;for(var o in e)if(pL(e,o)){var c=e[o];c!==null&&Ya(c)?(Ya(t[o])||(t[o]={}),n<r?$a(t[o],c,n+1,r):t[o]=e[o]):(0,mi.Z)(c)?(t[o]=[],t[o]=t[o].concat(c)):c!==void 0&&(t[o]=c)}}var QO=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)$a(t,e[r]);return t},en=QO;class gL extends Map{constructor(e,n=ey){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,o]of e)this.set(r,o)}get(e){return super.get(Qh(this,e))}has(e){return super.has(Qh(this,e))}set(e,n){return super.set(JO(this,e),n)}delete(e){return super.delete(Jh(this,e))}}class JR extends null{constructor(e,n=ey){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const r of e)this.add(r)}has(e){return super.has(Qh(this,e))}add(e){return super.add(JO(this,e))}delete(e){return super.delete(Jh(this,e))}}function Qh({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function JO({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Jh({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function ey(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Al(t){return t}function Gr(t,...e){return Oc(t,Al,Al,e)}function tp(t,...e){return Oc(t,Array.from,Al,e)}function ny(t,e){for(let n=1,r=e.length;n<r;++n)t=t.flatMap(o=>o.pop().map(([c,l])=>[...o,c,l]));return t}function vL(t,...e){return ny(tp(t,...e),e)}function tk(t,e,...n){return ny(bf(t,e,...n),n)}function ep(t,e,...n){return Oc(t,Al,e,n)}function bf(t,e,...n){return Oc(t,Array.from,e,n)}function mL(t,...e){return Oc(t,identity,ry,e)}function tE(t,...e){return Oc(t,Array.from,ry,e)}function ry(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function Oc(t,e,n,r){return function o(c,l){if(l>=r.length)return n(c);const u=new gL,d=r[l++];let h=-1;for(const p of c){const v=d(p,++h,c),m=u.get(v);m?m.push(p):u.set(v,[p])}for(const[p,v]of u)u.set(p,o(v,l));return e(u)}(t,0)}var np=function(t){return(0,fe.Z)(t)?"":t.toString()},iy=function(t){var e=np(t);return e.charAt(0).toLowerCase()+e.substring(1)},rp=iy,yL=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};function Es(t){return t}function ip(t){return t.reduce((e,n)=>(r,...o)=>n(e(r,...o),...o),Es)}function eE(t){return t.reduce((e,n)=>r=>yL(this,void 0,void 0,function*(){const o=yield e(r);return n(o)}),Es)}function op(t){return t.replace(/( |^)[a-z]/g,e=>e.toUpperCase())}function ws(t=""){throw new Error(t)}function ap(t,e){const{attributes:n}=e,r=new Set(["id","className"]);for(const[o,c]of Object.entries(n))r.has(o)||t.attr(o,c)}function Hr(t){return t!=null&&!Number.isNaN(t)}function oy(t,e){return t+(e-t)*Math.random()}function ay(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const r=t(n);return e.set(n,r),r}}function bL(t,e){const{transform:n}=t.style,o=(c=>c==="none"||c===void 0)(n)?"":n;t.style.transform=`${o} ${e}`.trimStart()}function bn(t,e){return no(t,e)||{}}function no(t,e){const n=Object.entries(t||{}).filter(([r])=>r.startsWith(e)).map(([r,o])=>[rp(r.replace(e,"").trim()),o]).filter(([r])=>!!r);return n.length===0?null:Object.fromEntries(n)}function sy(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[`${e}${upperFirst(n)}`,r]))}function Tl(t,e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.find(r=>n.startsWith(r))))}function co(t,...e){return Object.fromEntries(Object.entries(t).filter(([n])=>e.every(r=>!n.startsWith(r))))}function sp(t,e){if(t===void 0)return null;if(typeof t=="number")return t;const n=+t.replace("%","");return Number.isNaN(n)?null:n/100*e}function As(t){return typeof t=="object"&&!(t instanceof Date)&&t!==null&&!Array.isArray(t)}function Lo(t){return t===null||t===!1}function cy(t,e,n=5,r=0){if(!(r>=n)){for(const o of Object.keys(e)){const c=e[o];!Ya(c)||!Ya(t[o])?t[o]=c:cy(t[o],c,n,r+1)}return t}}function Wn(t){return new di([t],null,t,t.ownerDocument)}class di{constructor(e=null,n=null,r=null,o=null,c=[null,null,null,null,null],l=[],u=[]){this._elements=Array.from(e),this._data=n,this._parent=r,this._document=o,this._enter=c[0],this._update=c[1],this._exit=c[2],this._merge=c[3],this._split=c[4],this._transitions=l,this._facetElements=u}selectAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new di(n,null,this._elements[0],this._document)}selectFacetAll(e){const n=typeof e=="string"?this._parent.querySelectorAll(e):e;return new di(this._elements,null,this._parent,this._document,void 0,void 0,n)}select(e){const n=typeof e=="string"?this._parent.querySelectorAll(e)[0]||null:e;return new di([n],null,n,this._document)}append(e){const n=typeof e=="function"?e:()=>this.createElement(e),r=[];if(this._data!==null){for(let o=0;o<this._data.length;o++){const c=this._data[o],[l,u]=Array.isArray(c)?c:[c,null],d=n(l,o);d.__data__=l,u!==null&&(d.__fromElements__=u),this._parent.appendChild(d),r.push(d)}return new di(r,null,this._parent,this._document)}else{for(let o=0;o<this._elements.length;o++){const c=this._elements[o],l=c.__data__,u=n(l,o);c.appendChild(u),r.push(u)}return new di(r,null,r[0],this._document)}}maybeAppend(e,n,r){const o=this._elements[0],c=o.getElementById(e);if(c)return new di([c],null,this._parent,this._document);const l=typeof n=="string"?this.createElement(n):n();return l.id=e,r&&(l.className=r),o.appendChild(l),new di([l],null,this._parent,this._document)}data(e,n=o=>o,r=()=>null){const o=[],c=[],l=new Set(this._elements),u=[],d=new Set,h=new Map(this._elements.map((b,x)=>[n(b.__data__,x),b])),p=new Map(this._facetElements.map((b,x)=>[n(b.__data__,x),b])),v=Gr(this._elements,b=>r(b.__data__));for(let b=0;b<e.length;b++){const x=e[b],S=n(x,b),E=r(x,b);if(h.has(S)){const w=h.get(S);w.__data__=x,w.__facet__=!1,c.push(w),l.delete(w),h.delete(S)}else if(p.has(S)){const w=p.get(S);w.__data__=x,w.__facet__=!0,c.push(w),p.delete(S)}else if(v.has(S)){const w=v.get(S);u.push([x,w]);for(const M of w)l.delete(M);v.delete(S)}else if(h.has(E)){const w=h.get(E);w.__toData__?w.__toData__.push(x):w.__toData__=[x],d.add(w),l.delete(w)}else o.push(x)}const m=[new di([],o,this._parent,this._document),new di(c,null,this._parent,this._document),new di(l,null,this._parent,this._document),new di([],u,this._parent,this._document),new di(d,null,this._parent,this._document)];return new di(this._elements,null,this._parent,this._document,m)}merge(e){const n=[...this._elements,...e._elements],r=[...this._transitions,...e._transitions];return new di(n,null,this._parent,this._document,void 0,r)}createElement(e){if(this._document)return this._document.createElement(e,{});const n=di.registry[e];return n?new n:ws(`Unknown node type: ${e}`)}join(e=l=>l,n=l=>l,r=l=>l.remove(),o=l=>l,c=l=>l.remove()){const l=e(this._enter),u=n(this._update),d=r(this._exit),h=o(this._merge),p=c(this._split);return u.merge(l).merge(d).merge(h).merge(p)}remove(){for(let e=0;e<this._elements.length;e++){const n=this._transitions[e];if(n){const r=Array.isArray(n)?n:[n];Promise.all(r.map(o=>o.finished)).then(()=>{this._elements[e].remove()})}else this._elements[e].remove()}return new di([],null,this._parent,this._document,void 0,this._transitions)}each(e){for(let n=0;n<this._elements.length;n++){const r=this._elements[n],o=r.__data__;e(o,n,r)}return this}attr(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(o,c,l){n!==void 0&&(l[e]=r(o,c,l))})}style(e,n){const r=typeof n!="function"?()=>n:n;return this.each(function(o,c,l){n!==void 0&&(l.style[e]=r(o,c,l))})}transition(e){const n=typeof e!="function"?()=>e:e,{_transitions:r}=this;return this.each(function(o,c,l){r[c]=n(o,c,l)})}on(e,n){return this.each(function(r,o,c){c.addEventListener(e,n)}),this}call(e,...n){return e(this,...n),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}di.registry={g:F.ZA,rect:F.UL,circle:F.Cd,path:F.y$,text:F.xv,ellipse:F.Pj,image:F.Ee,line:F.x1,polygon:F.mg,polyline:F.aH,html:F.k9};const Sr={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"};var cp=function(t){var e=np(t);return e.charAt(0).toUpperCase()+e.substring(1)},Ts=cp;function ly(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function _f(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function nE(t){return t=_f(Math.abs(t)),t?t[1]:NaN}function rE(t,e){return function(n,r){for(var o=n.length,c=[],l=0,u=t[0],d=0;o>0&&u>0&&(d+u+1>r&&(u=Math.max(1,r-d)),c.push(n.substring(o-=u,o+u)),!((d+=u+1)>r));)u=t[l=(l+1)%t.length];return c.reverse().join(e)}}function iE(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var lp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xf(t){if(!(e=lp.exec(t)))throw new Error("invalid format: "+t);var e;return new Sf({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}xf.prototype=Sf.prototype;function Sf(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Sf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oE(t){t:for(var e=t.length,n=1,r=-1,o;n<e;++n)switch(t[n]){case".":r=o=n;break;case"0":r===0&&(r=n),o=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(o+1):t}var uy;function aE(t,e){var n=_f(t,e);if(!n)return t+"";var r=n[0],o=n[1],c=o-(uy=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,l=r.length;return c===l?r:c>l?r+new Array(c-l+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+_f(t,Math.max(0,e+c-1))[0]}function fy(t,e){var n=_f(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}var dy={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:ly,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fy(t*100,e),r:fy,s:aE,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function hy(t){return t}var py=Array.prototype.map,gy=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function sE(t){var e=t.grouping===void 0||t.thousands===void 0?hy:rE(py.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",c=t.numerals===void 0?hy:iE(py.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"\u2212":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function h(v){v=xf(v);var m=v.fill,b=v.align,x=v.sign,S=v.symbol,E=v.zero,w=v.width,M=v.comma,L=v.precision,I=v.trim,R=v.type;R==="n"?(M=!0,R="g"):dy[R]||(L===void 0&&(L=12),I=!0,R="g"),(E||m==="0"&&b==="=")&&(E=!0,m="0",b="=");var z=S==="$"?n:S==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",W=S==="$"?r:/[%p]/.test(R)?l:"",Y=dy[R],st=/[defgprs%]/.test(R);L=L===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,L)):Math.max(0,Math.min(20,L));function xt(Nt){var Ht=z,dt=W,Ot,bt,wt;if(R==="c")dt=Y(Nt)+dt,Nt="";else{Nt=+Nt;var oe=Nt<0||1/Nt<0;if(Nt=isNaN(Nt)?d:Y(Math.abs(Nt),L),I&&(Nt=oE(Nt)),oe&&+Nt==0&&x!=="+"&&(oe=!1),Ht=(oe?x==="("?x:u:x==="-"||x==="("?"":x)+Ht,dt=(R==="s"?gy[8+uy/3]:"")+dt+(oe&&x==="("?")":""),st){for(Ot=-1,bt=Nt.length;++Ot<bt;)if(wt=Nt.charCodeAt(Ot),48>wt||wt>57){dt=(wt===46?o+Nt.slice(Ot+1):Nt.slice(Ot))+dt,Nt=Nt.slice(0,Ot);break}}}M&&!E&&(Nt=e(Nt,1/0));var Ut=Ht.length+Nt.length+dt.length,Kt=Ut<w?new Array(w-Ut+1).join(m):"";switch(M&&E&&(Nt=e(Kt+Nt,Kt.length?w-dt.length:1/0),Kt=""),b){case"<":Nt=Ht+Nt+dt+Kt;break;case"=":Nt=Ht+Kt+Nt+dt;break;case"^":Nt=Kt.slice(0,Ut=Kt.length>>1)+Ht+Nt+dt+Kt.slice(Ut);break;default:Nt=Kt+Ht+Nt+dt;break}return c(Nt)}return xt.toString=function(){return v+""},xt}function p(v,m){var b=h((v=xf(v),v.type="f",v)),x=Math.max(-8,Math.min(8,Math.floor(nE(m)/3)))*3,S=Math.pow(10,-x),E=gy[8+x/3];return function(w){return b(S*w)+E}}return{format:h,formatPrefix:p}}var Cl,Xa,cE;vy({thousands:",",grouping:[3],currency:["$",""]});function vy(t){return Cl=sE(t),Xa=Cl.format,cE=Cl.formatPrefix,Cl}function Ho(t,e){return Object.entries(t).reduce((n,[r,o])=>(n[r]=e(o,r,t),n),{})}function Cs(t){return t.map((e,n)=>n)}function _L(t){const e=t.length,n=t[0].length,r=new Array(n).fill(0).map(()=>new Array(e));for(let o=0;o<n;o++)for(let c=0;c<e;c++)r[o][c]=t[c][o];return r}function lE(t){return t[0]}function yy(t){return t[t.length-1]}function ek(t){return!t.some(Array.isArray)}function by(t){return Array.from(new Set(t))}function Ms(t,e){const n=[[],[]];return t.forEach(r=>{n[e(r)?0:1].push(r)}),n}function _y(t,e=t.length){if(e===1)return t.map(r=>[r]);const n=[];for(let r=0;r<t.length;r++){const o=t.slice(r+1);_y(o,e-1).forEach(l=>{n.push([t[r],...l])})}return n}function Ml(t){if(t.length===1)return[t];const e=[];for(let n=1;n<=t.length;n++)e.push(..._y(t,n));return e}var uE=function(t){return t!==null&&typeof t!="function"&&isFinite(t.length)},Ec=uE,up=function(t,e){if(t===e)return!0;if(!t||!e||(0,gt.Z)(t)||(0,gt.Z)(e))return!1;if(Ec(t)||Ec(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=up(t[r],e[r]),!!n);r++);return n}if(yf(t)||yf(e)){var o=Object.keys(t),c=Object.keys(e);if(o.length!==c.length)return!1;for(var n=!0,r=0;r<o.length&&(n=up(t[o[r]],e[o[r]]),!!n);r++);return n}return!1},xy=up;function Vo(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let o of t)(o=+e(o,++r,t))&&(n+=o)}return n}function Or(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}function Sy(t){return t*Math.PI/180}function Of(t){return t*180/Math.PI}function fE(t,e){return t=t%(2*Math.PI),e=e%(2*Math.PI),t<0&&(t=2*Math.PI+t),e<0&&(e=2*Math.PI+e),t>=e&&(e=e+2*Math.PI),{startAngle:t,endAngle:e}}const Oy=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},n=Object.assign(Object.assign({},e),t);return Object.assign(Object.assign({},n),fE(n.startAngle,n.endAngle))},Ll=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=Oy(t);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",e,n,r,o]]};Ll.props={};const fp=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},dp=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=fp(t);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...Ll({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};dp.props={};function Ef(t,e,n){return Math.max(e,Math.min(t,n))}function Pl(t,e=10){return typeof t!="number"||Math.abs(t)<1e-15?t:parseFloat(t.toFixed(e))}const Ey=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]];var hp=k(17816);function Yr(t){const{transformations:e}=t.getOptions();return e.map(([r])=>r).filter(r=>r==="transpose").length%2!==0}function Pr(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="polar")}function Il(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="reflect")&&e.some(([n])=>n.startsWith("transpose"))}function wy(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="helix")}function Rl(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="parallel")}function pp(t){const{transformations:e}=t.getOptions();return e.some(([n])=>n==="fisheye")}function dE(t){return Rl(t)&&Pr(t)}function wc(t){return wy(t)||Pr(t)}function gp(t){return Pr(t)&&Yr(t)}function xL(t){return Pr(t)||Rl(t)||Il(t)||gp(t)}function hE(t){if(wc(t)){const[e,n]=t.getSize(),r=t.getOptions().transformations.find(o=>o[0]==="polar");if(r)return Math.max(e,n)/2*r[4]}return 0}function wf(t){const{transformations:e}=t.getOptions(),[,,,n,r]=e.find(o=>o[0]==="polar");return[+n,+r]}function vp(t,e=!0){const{transformations:n}=t.getOptions(),[,r,o]=n.find(c=>c[0]==="polar");return e?[+r*180/Math.PI,+o*180/Math.PI]:[r,o]}function pE(t,e){const{transformations:n}=t.getOptions(),[,...r]=n.find(o=>o[0]===e);return r}function Af(t,e){e(t),t.children&&t.children.forEach(function(n){n&&Af(n,e)})}function kl(t){Tf(t,!0)}function Po(t){Tf(t,!1)}function Tf(t,e){var n=e?"visible":"hidden";Af(t,function(r){r.attr("visibility",n)})}function mp(t){return typeof t=="boolean"?!1:"enter"in t&&"update"in t&&"exit"in t}function Ay(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter(function(r){var o=(0,T.CR)(r,1),c=o[0];return!e.includes(c)}));return Object.fromEntries(e.map(function(r){return mp(t)?t[r]===!1?[r,!1]:[r,(0,T.pi)((0,T.pi)({},t[r]),n)]:[r,n]}))}function Aa(t,e){t?t.finished.then(e):e()}function Ty(t,e){t.length===0?e():Promise.all(t.map(function(n){return n==null?void 0:n.finished})).then(e)}function Cf(t,e){"update"in t?t.update(e):t.attr(e)}function Mf(t,e,n){if(e.length===0)return null;if(!n){var r=e.slice(-1)[0];return Cf(t,{style:r}),null}return t.animate(e,n)}function Cy(t,e){return!(t.nodeName!=="text"||e.nodeName!=="text"||t.attributes.text!==e.attributes.text)}function My(t,e,n,r){if(r===void 0&&(r="destroy"),Cy(t,e))return t.remove(),[null];var o=function(){r==="destroy"?t.destroy():r==="hide"&&Po(t),e.isVisible()&&kl(e)};if(!n)return o(),[null];var c=n.duration,l=c===void 0?0:c,u=n.delay,d=u===void 0?0:u,h=Math.ceil(+l/2),p=+l/4,v=(0,T.CR)(t.getGeometryBounds().center,2),m=v[0],b=v[1],x=(0,T.CR)(e.getGeometryBounds().center,2),S=x[0],E=x[1],w=(0,T.CR)([(m+S)/2-m,(b+E)/2-b],2),M=w[0],L=w[1],I=t.style.opacity,R=I===void 0?1:I,z=e.style.opacity,W=z===void 0?1:z,Y=t.style.transform||"",st=e.style.transform||"",xt=t.animate([{opacity:R,transform:"translate(0, 0) ".concat(Y)},{opacity:0,transform:"translate(".concat(M,", ").concat(L,") ").concat(Y)}],(0,T.pi)((0,T.pi)({fill:"both"},n),{duration:d+h+p})),Nt=e.animate([{opacity:0,transform:"translate(".concat(-M,", ").concat(-L,") ").concat(st),offset:.01},{opacity:W,transform:"translate(0, 0) ".concat(st)}],(0,T.pi)((0,T.pi)({fill:"both"},n),{duration:h+p,delay:d+h-p}));return Aa(Nt,o),[xt,Nt]}function Ti(t,e,n){var r={},o={};return Object.entries(e).forEach(function(c){var l=(0,T.CR)(c,2),u=l[0],d=l[1];if(!(0,fe.Z)(d)){var h=t.style[u]||t.parsedStyle[u]||0;h!==d&&(r[u]=h,o[u]=d)}}),n?Mf(t,[r,o],(0,T.pi)({fill:"both"},n)):(Cf(t,o),null)}var gE=5,yp=function(t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=gE),Object.entries(e).forEach(function(o){var c=(0,T.CR)(o,2),l=c[0],u=c[1],d=t;Object.prototype.hasOwnProperty.call(e,l)&&(u?Ya(u)?(Ya(t[l])||(d[l]={}),n<r?yp(t[l],u,n+1,r):d[l]=e[l]):(0,mi.Z)(u)?(d[l]=[],d[l]=d[l].concat(u)):d[l]=u:d[l]=u)})},ea=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)yp(t,e[r]);return t},bp=function(t){(0,T.ZT)(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(this,(0,T.ev)([],(0,T.CR)(n),!1))||this;return o.isMutationObserved=!0,o.addEventListener(F.Dk.INSERTED,function(){Po(o)}),o}return e}(F.ZA);function Lf(t){var e=t.appendChild(new bp({class:"offscreen"}));return Po(e),e}function vE(t){for(var e=t;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}function mE(){Tf(this,this.attributes.visibility!=="hidden")}var Ni=function(t){(0,T.ZT)(e,t);function e(n,r){r===void 0&&(r={});var o=t.call(this,ea({},{style:r},n))||this;return o.initialized=!1,o._defaultOptions=r,o}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Lf(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e.prototype.attributeChangedCallback=function(n){n==="visibility"&&mE.call(this)},e.prototype.update=function(n,r){var o;return this.attr(ea({},this.attributes,n||{})),(o=this.render)===null||o===void 0?void 0:o.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(n,r){},e.prototype.getSubShapeStyle=function(n){var r=n.x,o=n.y,c=n.transform,l=n.transformOrigin,u=n.class,d=n.className,h=n.zIndex,p=(0,T._T)(n,["x","y","transform","transformOrigin","class","className","zIndex"]);return p},e}(F.b_);function ro(t,e,n,r,o){return r===void 0&&(r=!0),o===void 0&&(o=function(c){c.node().removeChildren()}),t?n(e):(r&&o(e),null)}function _p(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],o=0;o<t.length;o+=n)r.push(t[o]);return r}var Pf=function(t){(0,T.ZT)(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=(0,T._T)(n,["style"]);return t.call(this,(0,T.pi)({style:(0,T.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},o))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Lf(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},e}(F.xv);function Ly(t,e){var n=new Map;return t.forEach(function(r){var o=e(r);n.has(o)||n.set(o,[]),n.get(o).push(r)}),n}function yE(t){throw new Error(t)}var bE=function(){function t(o,c,l,u,d,h,p){o===void 0&&(o=null),c===void 0&&(c=null),l===void 0&&(l=null),u===void 0&&(u=null),d===void 0&&(d=[null,null,null,null,null]),h===void 0&&(h=[]),p===void 0&&(p=[]),e.add(this),this._elements=Array.from(o),this._data=c,this._parent=l,this._document=u,this._enter=d[0],this._update=d[1],this._exit=d[2],this._merge=d[3],this._split=d[4],this._transitions=h,this._facetElements=p}t.prototype.selectAll=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o):o;return new n(c,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o):o;return new n(this._elements,null,this._parent,this._document,void 0,void 0,c)},t.prototype.select=function(o){var c=typeof o=="string"?this._parent.querySelectorAll(o)[0]||null:o;return new n([c],null,c,this._document)},t.prototype.append=function(o){var c=this,l=typeof o=="function"?o:function(){return c.createElement(o)},u=[];if(this._data!==null){for(var d=0;d<this._data.length;d++){var h=this._data[d],p=(0,T.CR)(Array.isArray(h)?h:[h,null],2),v=p[0],m=p[1],b=l(v,d);b.__data__=v,m!==null&&(b.__fromElements__=m),this._parent.appendChild(b),u.push(b)}return new n(u,null,this._parent,this._document)}for(var d=0;d<this._elements.length;d++){var x=this._elements[d],v=x.__data__,b=l(v,d);x.appendChild(b),u.push(b)}return new n(u,null,u[0],this._document)},t.prototype.maybeAppend=function(o,c){var l=(0,T.Q_)(this,e,"m",r).call(this,o[0]==="#"?o:"#".concat(o),c);return l.attr("id",o),l},t.prototype.maybeAppendByClassName=function(o,c){var l=o.toString(),u=(0,T.Q_)(this,e,"m",r).call(this,l[0]==="."?l:".".concat(l),c);return u.attr("className",l),u},t.prototype.maybeAppendByName=function(o,c){var l=(0,T.Q_)(this,e,"m",r).call(this,'[name="'.concat(o,'"]'),c);return l.attr("name",o),l},t.prototype.data=function(o,c,l){var u,d;c===void 0&&(c=function(xt){return xt}),l===void 0&&(l=function(){return null});for(var h=[],p=[],v=new Set(this._elements),m=[],b=new Set,x=new Map(this._elements.map(function(xt,Nt){return[c(xt.__data__,Nt),xt]})),S=new Map(this._facetElements.map(function(xt,Nt){return[c(xt.__data__,Nt),xt]})),E=Ly(this._elements,function(xt){return l(xt.__data__)}),w=0;w<o.length;w++){var M=o[w],L=c(M,w),I=l(M,w);if(x.has(L)){var R=x.get(L);R.__data__=M,R.__facet__=!1,p.push(R),v.delete(R),x.delete(L)}else if(S.has(L)){var R=S.get(L);R.__data__=M,R.__facet__=!0,p.push(R),S.delete(L)}else if(E.has(L)){var z=E.get(L);m.push([M,z]);try{for(var W=(u=void 0,(0,T.XA)(z)),Y=W.next();!Y.done;Y=W.next()){var R=Y.value;v.delete(R)}}catch(xt){u={error:xt}}finally{try{Y&&!Y.done&&(d=W.return)&&d.call(W)}finally{if(u)throw u.error}}E.delete(L)}else if(x.has(I)){var R=x.get(I);R.__toData__?R.__toData__.push(M):R.__toData__=[M],b.add(R),v.delete(R)}else h.push(M)}var st=[new n([],h,this._parent,this._document),new n(p,null,this._parent,this._document),new n(v,null,this._parent,this._document),new n([],m,this._parent,this._document),new n(b,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,st)},t.prototype.merge=function(o){var c=(0,T.ev)((0,T.ev)([],(0,T.CR)(this._elements),!1),(0,T.CR)(o._elements),!1),l=(0,T.ev)((0,T.ev)([],(0,T.CR)(this._transitions),!1),(0,T.CR)(o._transitions),!1);return new n(c,null,this._parent,this._document,void 0,l)},t.prototype.createElement=function(o){if(this._document)return this._document.createElement(o,{});var c=n.registry[o];return c?new c:yE("Unknown node type: ".concat(o))},t.prototype.join=function(o,c,l,u,d){o===void 0&&(o=function(x){return x}),c===void 0&&(c=function(x){return x}),l===void 0&&(l=function(x){return x.remove()}),u===void 0&&(u=function(x){return x}),d===void 0&&(d=function(x){return x.remove()});var h=o(this._enter),p=c(this._update),v=l(this._exit),m=u(this._merge),b=d(this._split);return p.merge(h).merge(v).merge(m).merge(b)},t.prototype.remove=function(){for(var o=function(u){var d=c._elements[u],h=c._transitions[u];h?h.then(function(){return d.remove()}):d.remove()},c=this,l=0;l<this._elements.length;l++)o(l);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(o){for(var c=0;c<this._elements.length;c++){var l=this._elements[c],u=l.__data__;o.call(l,u,c)}return this},t.prototype.attr=function(o,c){var l=typeof c!="function"?function(){return c}:c;return this.each(function(u,d){c!==void 0&&(this[o]=l.call(this,u,d))})},t.prototype.style=function(o,c,l){l===void 0&&(l=!0);var u=typeof c!="function"||!l?function(){return c}:c;return this.each(function(d,h){c!==void 0&&(this.style[o]=u.call(this,d,h))})},t.prototype.styles=function(o,c){return o===void 0&&(o={}),c===void 0&&(c=!0),this.each(function(l,u){var d=this;Object.entries(o).forEach(function(h){var p=(0,T.CR)(h,2),v=p[0],m=p[1],b=typeof m!="function"||!c?function(){return m}:m;m!==void 0&&d.attr(v,b.call(d,l,u))})})},t.prototype.update=function(o,c){c===void 0&&(c=!0);var l=typeof o!="function"||!c?function(){return o}:o;return this.each(function(u,d){o&&this.update&&this.update(l.call(this,u,d))})},t.prototype.maybeUpdate=function(o,c){c===void 0&&(c=!0);var l=typeof o!="function"||!c?function(){return o}:o;return this.each(function(u,d){o&&this.update&&this.update(l.call(this,u,d))})},t.prototype.transition=function(o){var c=this._transitions;return this.each(function(l,u){c[u]=o.call(this,l,u)})},t.prototype.on=function(o,c){return this.each(function(){this.addEventListener(o,c)}),this},t.prototype.call=function(o){for(var c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];return o.call.apply(o,(0,T.ev)([this._parent,this],(0,T.CR)(c),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter(function(o){return!!o})},t.prototype.parent=function(){return this._parent};var e,n,r;return n=t,e=new WeakSet,r=function(c,l){var u=this._elements[0],d=u.querySelector(c);if(d)return new n([d],null,this._parent,this._document);var h=typeof l=="string"?this.createElement(l):l();return u.appendChild(h),new n([h],null,this._parent,this._document)},t.registry={g:F.ZA,rect:F.UL,circle:F.Cd,path:F.y$,text:Pf,ellipse:F.Pj,image:F.Ee,line:F.x1,polygon:F.mg,polyline:F.aH,html:F.k9},t}();function qn(t){return new bE([t],null,t,t.ownerDocument)}function _E(t,e,n){return t.querySelector(e)?qn(t).select(e):qn(t).append(n)}var Io=function(t,e){var n=function(o){return"".concat(e,"-").concat(o)},r=Object.fromEntries(Object.entries(t).map(function(o){var c=(0,T.CR)(o,2),l=c[0],u=c[1],d=n(u);return[l,{name:d,class:".".concat(d),id:"#".concat(d),toString:function(){return d}}]}));return Object.assign(r,{prefix:n}),r},Ac={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new F.y$({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},Py=en({},Ac,{style:{type:"arc"}}),SL=en({},Ac,{style:{}}),_r=Io({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis");function lo(t){return typeof t=="function"}function Ta(t,e){return[t[0]*e,t[1]*e]}function Dl(t,e){return[t[0]+e[0],t[1]+e[1]]}function If(t,e){return[t[0]-e[0],t[1]-e[1]]}function Ls(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function Ps(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function Tc(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Fl(t){if(t[0]===0&&t[1]===0)return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function OL(t,e,n){var r=__read(t,2),o=r[0],c=r[1],l=__read(e,2),u=l[0],d=l[1],h=o-u,p=c-d,v=Math.sin(n),m=Math.cos(n);return[h*m-p*v+u,h*v+p*m+d]}function xE(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}function Cc(t){return t*Math.PI/180}function Iy(t){return Number((t*180/Math.PI).toPrecision(5))}function xp(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function SE(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}function OE(t,e){return"".concat(e).concat(xp(t))}function Ry(t,e,n){var r;n===void 0&&(n=!0);var o=e||((r=t.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",c=t.replace(new RegExp("^(".concat(o,")")),"");return n?SE(c):c}function EE(t,e){Object.entries(e).forEach(function(n){var r=(0,T.CR)(n,2),o=r[0],c=r[1];(0,T.ev)([t],(0,T.CR)(t.querySelectorAll(o)),!1).filter(function(l){return l.matches(o)}).forEach(function(l){if(l){var u=l;u.style.cssText+=Object.entries(c).reduce(function(d,h){return"".concat(d).concat(h.join(":"),";")},"")}})})}var Rf=function(t,e){if(!(t!=null&&t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function or(t,e,n){n===void 0&&(n=!1);var r={};return Object.entries(t).forEach(function(o){var c=(0,T.CR)(o,2),l=c[0],u=c[1];if(!(l==="className"||l==="class")){if(Rf(l,"show")&&Rf(Ry(l,"show"),e)!==n)l===OE(e,"show")?r[l]=u:r[l.replace(new RegExp(xp(e)),"")]=u;else if(!Rf(l,"show")&&Rf(l,e)!==n){var d=Ry(l,e);d==="filter"&&typeof u=="function"||(r[d]=u)}}}),r}function na(t,e){return Object.entries(t).reduce(function(n,r){var o=(0,T.CR)(r,2),c=o[0],l=o[1];return c.startsWith("show")?n["show".concat(e).concat(c.slice(4))]=l:n["".concat(e).concat(xp(c))]=l,n},{})}function Ca(t,e){e===void 0&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},o={};return Object.entries(t).forEach(function(c){var l=(0,T.CR)(c,2),u=l[0],d=l[1];e.includes(u)||(n.indexOf(u)!==-1?o[u]=d:r[u]=d)}),[r,o]}function _o(t,e){return lo(t)?t.apply(void 0,(0,T.ev)([],(0,T.CR)(e),!1)):t}function kf(t,e){return t.style.opacity||(t.style.opacity=1),Ti(t,{opacity:0},e)}var wE=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function ky(t){return wE.includes(t)}function Sp(t){var e={};for(var n in t)ky(n)&&(e[n]=t[n]);return e}var Is=Io({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function Op(t){return t.reduce(function(e,n,r){return e.push((0,T.ev)([r===0?"M":"L"],(0,T.CR)(n),!1)),e},[])}function AE(t,e,n){var r=e.connect,o=r===void 0?"line":r,c=e.center;if(o==="line")return Op(t);if(!c)return[];var l=Tc(t[0],c),u=n?0:1;return t.reduce(function(d,h,p){return p===0?d.push((0,T.ev)(["M"],(0,T.CR)(h),!1)):d.push((0,T.ev)(["A",l,l,0,0,u],(0,T.CR)(h),!1)),d},[])}function Ep(t,e,n){return e.type==="surround"?AE(t,e,n):Op(t)}function TE(t,e,n){var r=n.type,o=n.connect,c=n.center,l=n.closed,u=l?[["Z"]]:[],d=(0,T.CR)([Ep(t,n),Ep(e.slice().reverse(),n,!0)],2),h=d[0],p=d[1],v=(0,T.CR)([t[0],e.slice(-1)[0]],2),m=v[0],b=v[1],x=function(M,L){return[h,M,p,L,u].flat()};if(o==="line"||r==="surround")return x([(0,T.ev)(["L"],(0,T.CR)(b),!1)],[(0,T.ev)(["L"],(0,T.CR)(m),!1)]);if(!c)throw new Error("Arc grid need to specified center");var S=(0,T.CR)([Tc(b,c),Tc(m,c)],2),E=S[0],w=S[1];return x([(0,T.ev)(["A",E,E,0,0,1],(0,T.CR)(b),!1),(0,T.ev)(["L"],(0,T.CR)(b),!1)],[(0,T.ev)(["A",w,w,0,0,0],(0,T.CR)(m),!1),(0,T.ev)(["L"],(0,T.CR)(m),!1)])}function CE(t,e,n,r){var o=n.animate,c=n.isBillboard,l=e.map(function(u,d){return{id:u.id||"grid-line-".concat(d),d:Ep(u.points,n)}});return t.selectAll(Is.line.class).data(l,function(u){return u.id}).join(function(u){return u.append("path").each(function(d,h){var p=_o(Sp((0,T.pi)({d:d.d},r)),[d,h,l]);this.attr((0,T.pi)({class:Is.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:c},p))})},function(u){return u.transition(function(d,h){var p=_o(Sp((0,T.pi)({d:d.d},r)),[d,h,l]);return Ti(this,p,o.update)})},function(u){return u.transition(function(){var d=this,h=kf(this,o.exit);return Aa(h,function(){return d.remove()}),h})}).transitions()}function Dy(t,e,n){var r=n.animate,o=n.connect,c=n.areaFill;if(e.length<2||!c||!o)return[];for(var l=Array.isArray(c)?c:[c,"transparent"],u=function(x){return l[x%l.length]},d=[],h=0;h<e.length-1;h++){var p=(0,T.CR)([e[h].points,e[h+1].points],2),v=p[0],m=p[1],b=TE(v,m,n);d.push({d:b,fill:u(h)})}return t.selectAll(Is.region.class).data(d,function(x,S){return S}).join(function(x){return x.append("path").each(function(S,E){var w=_o(S,[S,E,d]);this.attr(w)}).attr("className",Is.region.name)},function(x){return x.transition(function(S,E){var w=_o(S,[S,E,d]);return Ti(this,w,r.update)})},function(x){return x.transition(function(){var S=this,E=kf(this,r.exit);return Aa(E,function(){return S.remove()}),E})}).transitions()}function ME(t){var e=t.data,n=e===void 0?[]:e,r=t.closed;return r?n.map(function(o){var c=o.points,l=(0,T.CR)(c,1),u=l[0];return(0,T.pi)((0,T.pi)({},o),{points:(0,T.ev)((0,T.ev)([],(0,T.CR)(c),!1),[u],!1)})}):n}var LE=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.type,c=n.center,l=n.areaFill,u=n.closed,d=(0,T._T)(n,["type","center","areaFill","closed"]),h=ME(n),p=qn(r).maybeAppendByClassName(Is.lineGroup,"g"),v=qn(r).maybeAppendByClassName(Is.regionGroup,"g"),m=CE(p,h,n,d),b=Dy(v,h,n);return(0,T.ev)((0,T.ev)([],(0,T.CR)(m),!1),(0,T.CR)(b),!1)},e}(Ni),hr=function(t,e,n){for(var r=0,o=(0,gt.Z)(e)?e.split("."):e;t&&r<o.length;)t=t[o[r++]];return t===void 0||r<o.length?n:t},Fy=function(t,e){return function(n){return t*(1-n)+e*n}};function Ny(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(o){var c=new Array(r),l=new Array(n),u=0;for(u=0;u<r;++u)c[u]=wp(t[u],e[u]);for(;u<n;++u)l[u]=e[u];for(u=0;u<r;++u)l[u]=c[u](o);return l}}function PE(t,e){t===void 0&&(t={}),e===void 0&&(e={});var n={},r={};return Object.entries(e).forEach(function(o){var c=(0,T.CR)(o,2),l=c[0],u=c[1];l in t?n[l]=wp(t[l],u):r[l]=u}),function(o){return Object.entries(n).forEach(function(c){var l=(0,T.CR)(c,2),u=l[0],d=l[1];return r[u]=d(o)}),r}}function wp(t,e){return typeof t=="number"&&typeof e=="number"?Fy(t,e):Array.isArray(t)&&Array.isArray(e)?Ny(t,e):typeof t=="object"&&typeof e=="object"?PE(t,e):function(n){return t}}function IE(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var o=r.duration,c=o===void 0?0:o,l=wp(e,n),u=Math.ceil(+c/16),d=new Array(u).fill(0).map(function(h,p,v){return{__keyframe_data__:l(p/(v.length-1))}});return t.animate(d,(0,T.pi)({fill:"both"},r))}function Rs(t){return typeof t=="function"?t():(0,gt.Z)(t)||(0,ne.Z)(t)?new Pf({style:{text:String(t)}}):t}function Ap(t,e,n){n===void 0&&(n=!1);var r=t.getBBox(),o=r.width,c=r.height,l=e/Math.max(o,c);return n&&(t.style.transform="scale(".concat(l,")")),l}function By(t,e){var n={},r=Array.isArray(e)?e:[e];for(var o in t)r.includes(o)||(n[o]=t[o]);return n}function jy(t,e){return Object.fromEntries(Object.entries(t).map(function(n){var r=(0,T.CR)(n,2),o=r[0],c=r[1];return[o,_o(c,e)]}))}function EL(t){if(t.type==="linear"){var e=t.startPos,n=t.endPos;return __spreadArray(__spreadArray([],__read(e),!1),__read(n),!1)}var r=t.startAngle,o=t.endAngle,c=t.center,l=t.radius;return __spreadArray(__spreadArray([r,o],__read(c),!1),[l],!1)}function Tp(t,e){return e&&lo(e)?t.filter(e):t}function Cp(t,e){var n=e.startAngle,r=e.endAngle;return(r-n)*t+n}function Df(t,e){if(e.type==="linear"){var n=(0,T.CR)(e.startPos,2),r=n[0],o=n[1],c=(0,T.CR)(e.endPos,2),l=c[0],u=c[1],d=(0,T.CR)([l-r,u-o],2),h=d[0],p=d[1];return Fl([h,p])}var v=Cc(Cp(t,e));return[-Math.sin(v),Math.cos(v)]}function Mp(t,e,n){var r=Df(t,n);return xE(r,e!=="positive")}function Mc(t,e){return Mp(t,e.labelDirection,e)}function zy(t,e){var n=(0,T.CR)(e.startPos,2),r=n[0],o=n[1],c=(0,T.CR)(e.endPos,2),l=c[0],u=c[1],d=(0,T.CR)([l-r,u-o],2),h=d[0],p=d[1];return[r+h*t,o+p*t]}function RE(t,e){var n=e.radius,r=(0,T.CR)(e.center,2),o=r[0],c=r[1],l=Cc(Cp(t,e));return[o+n*Math.cos(l),c+n*Math.sin(l)]}function Nl(t,e){return e.type==="linear"?zy(t,e):RE(t,e)}function Uy(t){return Df(0,t)[1]===0}function Zy(t){return Df(0,t)[0]===0}function Hy(t,e){return e-t===360}function Lp(t,e,n,r,o){var c=e-t,l=(0,T.CR)([o,o],2),u=l[0],d=l[1],h=(0,T.CR)([Cc(t),Cc(e)],2),p=h[0],v=h[1],m=function(xt){return[n+o*Math.cos(xt),r+o*Math.sin(xt)]},b=(0,T.CR)(m(p),2),x=b[0],S=b[1],E=(0,T.CR)(m(v),2),w=E[0],M=E[1];if(Hy(t,e)){var L=(v+p)/2,I=(0,T.CR)(m(L),2),R=I[0],z=I[1];return[["M",x,S],["A",u,d,0,1,0,R,z],["A",u,d,0,1,0,w,M]]}var W=c>180?1:0,Y=t>e?0:1,st=!1;return st?"M".concat(n,",").concat(r,",L").concat(x,",").concat(S,",A").concat(u,",").concat(d,",0,").concat(W,",").concat(Y,",").concat(w,",").concat(M,",L").concat(n,",").concat(r):"M".concat(x,",").concat(S,",A").concat(u,",").concat(d,",0,").concat(W,",").concat(Y,",").concat(w,",").concat(M)}function kE(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,o=e.center,c=e.radius;return(0,T.ev)((0,T.ev)([n,r],(0,T.CR)(o),!1),[c],!1)}function DE(t,e,n,r){var o=e.startAngle,c=e.endAngle,l=e.center,u=e.radius;return t.selectAll(_r.line.class).data([{d:Lp.apply(void 0,(0,T.ev)((0,T.ev)([o,c],(0,T.CR)(l),!1),[u],!1))}],function(d,h){return h}).join(function(d){return d.append("path").attr("className",_r.line.name).styles(e).styles({d:function(h){return h.d}})},function(d){return d.transition(function(){var h=this,p=IE(this,kE(this),(0,T.ev)((0,T.ev)([o,c],(0,T.CR)(l),!1),[u],!1),r.update);if(p){var v=function(){var m=hr(h.attributes,"__keyframe_data__");h.style.d=Lp.apply(void 0,(0,T.ev)([],(0,T.CR)(m),!1))};p.onframe=v,p.onfinish=v}return p}).styles(e)},function(d){return d.remove()}).styles(n).transitions()}function Vy(t,e){var n=e.truncRange,r=e.truncShape,o=e.lineExtension}function Pp(t,e,n){n===void 0&&(n=[0,0]);var r=(0,T.CR)([t,e,n],3),o=(0,T.CR)(r[0],2),c=o[0],l=o[1],u=(0,T.CR)(r[1],2),d=u[0],h=u[1],p=(0,T.CR)(r[2],2),v=p[0],m=p[1],b=(0,T.CR)([d-c,h-l],2),x=b[0],S=b[1],E=Math.sqrt(Math.pow(x,2)+Math.pow(S,2)),w=(0,T.CR)([-v/E,m/E],2),M=w[0],L=w[1];return[M*x,M*S,L*x,L*S]}function Ip(t){var e=(0,T.CR)(t,2),n=(0,T.CR)(e[0],2),r=n[0],o=n[1],c=(0,T.CR)(e[1],2),l=c[0],u=c[1];return{x1:r,y1:o,x2:l,y2:u}}function FE(t,e,n,r){var o=e.showTrunc,c=e.startPos,l=e.endPos,u=e.truncRange,d=e.lineExtension,h=(0,T.CR)([c,l],2),p=(0,T.CR)(h[0],2),v=p[0],m=p[1],b=(0,T.CR)(h[1],2),x=b[0],S=b[1],E=(0,T.CR)(d?Pp(c,l,d):new Array(4).fill(0),4),w=E[0],M=E[1],L=E[2],I=E[3],R=function(Ut){return t.selectAll(_r.line.class).data(Ut,function(Kt,me){return me}).join(function(Kt){return Kt.append("line").attr("className",function(me){return"".concat(_r.line.name," ").concat(me.className)}).styles(n).transition(function(me){return Ti(this,Ip(me.line),!1)})},function(Kt){return Kt.styles(n).transition(function(me){var Ee=me.line;return Ti(this,Ip(Ee),r.update)})},function(Kt){return Kt.remove()}).transitions()};if(!o||!u)return R([{line:[[v+w,m+M],[x+L,S+I]],className:_r.line.name}]);var z=(0,T.CR)(u,2),W=z[0],Y=z[1],st=x-v,xt=S-m,Nt=(0,T.CR)([v+st*W,m+xt*W],2),Ht=Nt[0],dt=Nt[1],Ot=(0,T.CR)([v+st*Y,m+xt*Y],2),bt=Ot[0],wt=Ot[1],oe=R([{line:[[v+w,m+M],[Ht,dt]],className:_r.lineFirst.name},{line:[[bt,wt],[x+L,S+I]],className:_r.lineSecond.name}]);return Vy(t,e),oe}function NE(t,e,n,r){var o=n.showArrow,c=n.showTrunc,l=n.lineArrow,u=n.lineArrowOffset,d=n.lineArrowSize,h;if(e==="arc"?h=t.select(_r.line.class):c?h=t.select(_r.lineSecond.class):h=t.select(_r.line.class),!o||!l||n.type==="arc"&&Hy(n.startAngle,n.endAngle)){var p=h.node();p&&(p.style.markerEnd=void 0);return}var v=Rs(l);v.attr(r),Ap(v,d,!0),h.style("markerEnd",v).style("markerEndOffset",-u)}function BE(t,e,n){var r=e.type,o,c=or(e,"line");return r==="linear"?o=FE(t,e,By(c,"arrow"),n):o=DE(t,e,By(c,"arrow"),n),NE(t,r,e,c),o}function jE(t,e){return Mp(t,e.gridDirection,e)}function Wy(t){var e=t.type,n=t.gridCenter;return e==="linear"?n:n||t.center}function Bl(t,e){var n=e.gridLength;return t.map(function(r,o){var c=r.value,l=(0,T.CR)(Nl(c,e),2),u=l[0],d=l[1],h=(0,T.CR)(Ta(jE(c,e),n),2),p=h[0],v=h[1];return{id:o,points:[[u,d],[u+p,d+v]]}})}function Gy(t,e){var n=e.gridControlAngles,r=Wy(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||n.length===0)throw new Error("Invalid gridControlAngles");var o=(0,T.CR)(r,2),c=o[0],l=o[1];return t.map(function(u,d){var h=u.value,p=(0,T.CR)(Nl(h,e),2),v=p[0],m=p[1],b=(0,T.CR)([v-c,m-l],2),x=b[0],S=b[1],E=[];return n.forEach(function(w){var M=Cc(w),L=(0,T.CR)([Math.cos(M),Math.sin(M)],2),I=L[0],R=L[1],z=x*I-S*R+c,W=x*R+S*I+l;E.push([z,W])}),{points:E,id:d}})}function zE(t,e,n,r){var o=or(n,"grid"),c=o.type,l=o.areaFill,u=Wy(n),d=Tp(e,n.gridFilter),h=c==="segment"?Bl(d,n):Gy(d,n),p=(0,T.pi)((0,T.pi)({},o),{center:u,areaFill:lo(l)?d.map(function(v,m){return _o(l,[v,m,d])}):l,animate:r,data:h});return t.selectAll(_r.grid.class).data([1]).join(function(v){return v.append(function(){return new LE({style:p})}).attr("className",_r.grid.name)},function(v){return v.transition(function(){return this.update(p)})},function(v){return v.remove()}).transitions()}function Ci(t,e,n,r,o){return r===void 0&&(r=!0),o===void 0&&(o=!1),r&&t===e||o&&t===n?!0:t>e&&t<n}function UE(t){var e,n,r,o=t||1;function c(u,d){++e>o&&(r=n,l(1),++e),n[u]=d}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var d=n[u];if(d!==void 0)return d;if((d=r[u])!==void 0)return c(u,d),d},set:function(u,d){n[u]!==void 0?n[u]=d:c(u,d)}}}var Rp=new Map;function Lc(t,e,n){n===void 0&&(n=128);var r=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];var l=e?e.apply(this,o):o[0];Rp.has(t)||Rp.set(t,UE(n));var u=Rp.get(t);if(u.has(l))return u.get(l);var d=t.apply(this,o);return u.set(l,d),d};return r}var Ff,kp;function wL(t){kp=t}var Yy=Lc(function(t,e){var n=e.fontSize,r=e.fontFamily,o=e.fontWeight,c=e.fontStyle,l=e.fontVariant;return kp?kp(t,n):(Ff||(Ff=F.GZ.offscreenCanvasCreator.getOrCreateContext(void 0)),Ff.font=[c,l,o,"".concat(n,"px"),r].join(" "),Ff.measureText(t).width)},function(t,e){return[t,Object.values(e||$y(t)).join()].join("")},4096),$y=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",o=t.style.fontVariant,c=t.style.fontSize;return c=typeof c=="object"?c.value:c,{fontSize:c,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:o}};function Xy(t){return t.nodeName==="text"?t:t.nodeName==="g"&&t.children.length===1&&t.children[0].nodeName==="text"?t.children[0]:null}function Dp(t,e){var n=Xy(t);n&&n.attr(e)}function Fp(t,e,n){n===void 0&&(n="..."),Dp(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function ZE(t,e,n,r){n===void 0&&(n=2),r===void 0&&(r="top"),Dp(t,{wordWrap:!0,wordWrapWidth:e,maxLines:n,textBaseline:r})}function qy(t,e,n){var r=t.getBBox(),o=r.width,c=r.height,l=(0,T.CR)([e,n].map(function(h,p){var v;return h.includes("%")?parseFloat(((v=h.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||v===void 0?void 0:v[0])||"0")/100*(p===0?o:c):h}),2),u=l[0],d=l[1];return[u,d]}function Nf(t,e){if(e)try{var n=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(n,function(o,c,l){return"translate(".concat(qy(t,c,l),")")});t.attr("transform",r)}catch(o){}}var Ky=function(t){return t!==void 0&&t!=null&&!Number.isNaN(t)};function Zi(t){if((0,ne.Z)(t))return[t,t,t,t];if((0,mi.Z)(t)){var e=t.length;if(e===1)return[t[0],t[0],t[0],t[0]];if(e===2)return[t[0],t[1],t[0],t[1]];if(e===3)return[t[0],t[1],t[2],t[1]];if(e===4)return t}return[0,0,0,0]}var jl=function(){function t(e,n,r,o){this.set(e,n,r,o)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(e,n,r){var o=this,c=o.x1,l=o.y1,u=o.x2,d=o.y2,h=Math.cos(e),p=Math.sin(e),v=n-n*h+r*p,m=r-n*p-r*h,b=[[h*c-p*d+v,p*c+h*d+m],[h*u-p*d+v,p*u+h*d+m],[h*c-p*l+v,p*c+h*l+m],[h*u-p*l+v,p*u+h*l+m]];return b},t.prototype.set=function(e,n,r,o){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),o<n?(this.y2=n,this.y1=o):(this.y1=n,this.y2=o),this},t.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},t}();function Bf(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),o=(0,T.CR)(r.min,2),c=o[0],l=o[1],u=(0,T.CR)(r.max,2),d=u[0],h=u[1],p=t.getBBox(),v=p.width,m=p.height,b=m,x=0,S=0,E=c,w=l,M=Xy(t);if(M){b-=1.5;var L=M.style.textAlign,I=M.style.textBaseline;L==="center"?E=(c+d)/2:(L==="right"||L==="end")&&(E=d),I==="middle"?w=(l+h)/2:I==="bottom"&&(w=h)}var R=(0,T.CR)(Zi(e),4),z=R[0],W=z===void 0?0:z,Y=R[1],st=Y===void 0?0:Y,xt=R[2],Nt=xt===void 0?W:xt,Ht=R[3],dt=Ht===void 0?st:Ht,Ot=new jl((x+=c)-dt,(S+=l)-W,x+v+st,S+b+Nt);return t.setEulerAngles(n),Ot.rotatedPoints(Cc(n),E,w)}function Je(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function ut(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return r===0?0:r<0?2:1}function zl(t,e){var n=ut(t[0],t[1],e[0]),r=ut(t[0],t[1],e[1]),o=ut(e[0],e[1],t[0]),c=ut(e[0],e[1],t[1]);return!!(n!==r&&o!==c||n===0&&Je(t,e[0])||r===0&&Je(t,e[1])||o===0&&Je(e,t[0])||c===0&&Je(e,t[1]))}function at(t,e){var n=t.length;if(n<3)return!1;var r=[e,[9999,e[1]]],o=0,c=0;do{var l=[t[c],t[(c+1)%n]];if(zl(l,r)){if(ut(l[0],e,l[1])===0)return Je(l,e);o++}c=(c+1)%n}while(c!==0);return!!(o&1)}function HE(t,e){return e.every(function(n){return at(t,n)})}function VE(t,e,n){var r=t.x1,o=t.x2,c=t.y1,l=t.y2,u=[[r,c],[o,c],[o,l],[r,l]],d=Bf(e,n);return HE(u,d)}function Qy(t,e){var n=(0,T.CR)(t,4),r=n[0],o=n[1],c=n[2],l=n[3],u=(0,T.CR)(e,4),d=u[0],h=u[1],p=u[2],v=u[3],m=c-r,b=l-o,x=p-d,S=v-h,E=m*S-x*b;if(E===0)return!1;var w=E>0,M=r-d,L=o-h,I=m*L-b*M;if(I<0===w)return!1;var R=x*L-S*M;return!(R<0===w||I>E===w||R>E===w)}function Jy(t,e){var n=[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]];return n.some(function(r){return Qy(e,r)})}var qa={lineToLine:Qy,intersectBoxLine:Jy,getBounds:Bf};function WE(t,e,n){var r,o,c=Bf(t,n).flat(1),l=Bf(e,n).flat(1),u=[[c[0],c[1],c[2],c[3]],[c[0],c[1],c[4],c[5]],[c[4],c[5],c[6],c[7]],[c[2],c[3],c[6],c[7]]];try{for(var d=(0,T.XA)(u),h=d.next();!h.done;h=d.next()){var p=h.value;if(Jy(l,p))return!0}}catch(v){r={error:v}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return!1}function t1(t,e){var n=t.type,r=t.labelDirection,o=t.crossSize;if(!o)return!1;if(n==="arc"){var c=t.center,l=t.radius,u=(0,T.CR)(c,2),d=u[0],h=u[1],p=r==="negative"?0:o,v=-l-p,m=l+p,b=(0,T.CR)(Zi(e),4),x=b[0],S=b[1],E=b[2],w=b[3];return new jl(d+v-w,h+v-x,d+m+S,h+m+E)}var M=(0,T.CR)(t.startPos,2),L=M[0],I=M[1],R=(0,T.CR)(t.endPos,2),z=R[0],W=R[1],Y=(0,T.CR)(Zy(t)?[-e,0,e,0]:[0,e,0,-e],4),st=Y[0],xt=Y[1],Nt=Y[2],Ht=Y[3],dt=Mc(0,t),Ot=Ta(dt,o),bt=new jl(L,I,z,W);return bt.x1+=Ht,bt.y1+=st,bt.x2+=xt+Ot[0],bt.y2+=Nt+Ot[1],bt}function Ul(t,e,n){var r,o,c=e.crossPadding,l=new Set,u=null,d=t1(e,c),h=function(x){return d?VE(d,x):!0},p=function(x,S){return!x||!x.firstChild?!0:!WE(x.firstChild,S.firstChild,Zi(n))};try{for(var v=(0,T.XA)(t),m=v.next();!m.done;m=v.next()){var b=m.value;h(b)?!u||p(u,b)?u=b:(l.add(u),l.add(b)):l.add(b)}}catch(x){r={error:x}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}return Array.from(l)}function Zl(t,e){return e===void 0&&(e={}),(0,fe.Z)(t)?0:typeof t=="number"?t:Math.floor(Yy(t,e))}function e1(t,e,n,r){if(!(t.length<=1)){var o=e.suffix,c=o===void 0?"...":o,l=e.minLength,u=e.maxLength,d=u===void 0?1/0:u,h=e.step,p=h===void 0?" ":h,v=e.margin,m=v===void 0?[0,0,0,0]:v,b=$y(r.getTextShape(t[0])),x=Zl(p,b),S=l?Zl(l,b):x,E=Zl(d,b);((0,fe.Z)(E)||E===1/0)&&(E=Math.max.apply(null,t.map(function(Ot){return Ot.getBBox().width})));for(var w=t.slice(),M=(0,T.CR)(m,4),L=M[0],I=L===void 0?0:L,R=M[1],z=R===void 0?0:R,W=M[2],Y=W===void 0?I:W,st=M[3],xt=st===void 0?z:st,Nt=function(Ot){if(w.forEach(function(bt){r.ellipsis(r.getTextShape(bt),Ot,c)}),w=Ul(t,n,m),w.length<1)return{value:void 0}},Ht=E;Ht>S+x;Ht-=x){var dt=Nt(Ht);if(typeof dt=="object")return dt.value}}}function AL(t){var e=t&&t.getRenderBounds();if(!e)return{width:0,height:0};var n=e.getMax(),r=e.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function GE(t){var e=t.getLocalBounds(),n=e.min,r=e.max,o=(0,T.CR)([n,r],2),c=(0,T.CR)(o[0],2),l=c[0],u=c[1],d=(0,T.CR)(o[1],2),h=d[0],p=d[1];return{x:l,y:u,width:h-l,height:p-u,left:l,bottom:p,top:u,right:h}}function YE(t,e){var n=select(t).append("text").node();return n.attr(__assign(__assign({},e),{visibility:"hidden"})),n}function $E(t,e){var n=(0,T.CR)(t,2),r=n[0],o=n[1],c=(0,T.CR)(e,2),l=c[0],u=c[1];return r!==l&&o===u}function nk(t,e){var n=__read(t,2),r=n[0],o=n[1],c=__read(e,2),l=c[0],u=c[1];return r===l&&o!==u}function XE(t,e){var n,r,o=e.attributes;try{for(var c=(0,T.XA)(Object.entries(o)),l=c.next();!l.done;l=c.next()){var u=(0,T.CR)(l.value,2),d=u[0],h=u[1];d!=="id"&&d!=="className"&&t.attr(d,h)}}catch(p){n={error:p}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}var TL={parity:function(t,e){var n=e.seq,r=n===void 0?2:n;return t.filter(function(o,c){return c%r?(Po(o),!1):!0})}},qE=function(t){return t.filter(Ky)};function KE(t,e,n,r){var o=t.length,c=e.keepHeader,l=e.keepTail;if(!(o<=1||o===2&&c&&l)){var u=TL.parity,d=function(L){return L.forEach(r.show),L},h=2,p=t.slice(),v=t.slice(),m=Math.min.apply(Math,(0,T.ev)([1],(0,T.CR)(t.map(function(L){return L.getBBox().width})),!1));if(n.type==="linear"&&(Uy(n)||Zy(n))){var b=GE(t[0]).left,x=GE(t[o-1]).right,S=Math.abs(x-b)||1;h=Math.max(Math.floor(o*m/S),h)}var E,w;for(c&&(E=p.splice(0,1)[0]),l&&(w=p.splice(-1,1)[0],p.reverse()),d(p);h<t.length&&Ul(qE(w?(0,T.ev)((0,T.ev)([w],(0,T.CR)(v),!1),[E],!1):(0,T.ev)([E],(0,T.CR)(v),!1)),n,e==null?void 0:e.margin).length;){if(w&&!E&&h%2===0){var M=p.splice(0,1);M.forEach(r.hide)}else if(w&&E){var M=p.splice(0,1);M.forEach(r.hide)}v=u(d(p),{seq:h}),h++}}}function CL(t,e,n,r){var o,c,l=e.optionalAngles,u=l===void 0?[0,45,90]:l,d=e.margin,h=e.recoverWhenFailed,p=h===void 0?!0:h,v=t.map(function(w){return w.getLocalEulerAngles()}),m=function(){return Ul(t,n,d).length<1},b=function(w){return t.forEach(function(M,L){var I=Array.isArray(w)?w[L]:w;r.rotate(M,+I)})};try{for(var x=(0,T.XA)(u),S=x.next();!S.done;S=x.next()){var E=S.value;if(b(E),m())return}}catch(w){o={error:w}}finally{try{S&&!S.done&&(c=x.return)&&c.call(x)}finally{if(o)throw o.error}}p&&b(v)}function ML(t){var e=t.type,n=t.labelDirection;return e==="linear"&&Uy(t)?n==="negative"?"bottom":"top":"middle"}function LL(t,e,n,r){var o=e.wordWrapWidth,c=o===void 0?50:o,l=e.maxLines,u=l===void 0?3:l,d=e.recoverWhenFailed,h=d===void 0?!0:d,p=e.margin,v=p===void 0?[0,0,0,0]:p,m=t.map(function(M){return M.attr("maxLines")||1}),b=Math.min.apply(Math,(0,T.ev)([],(0,T.CR)(m),!1)),x=function(){return Ul(t,n,v).length<1},S=ML(n),E=function(M){return t.forEach(function(L,I){var R=Array.isArray(M)?M[I]:M;r.wrap(L,c,R,S)})};if(!(b>u)){for(var w=b;w<=u;w++)if(E(w),x())return;h&&E(m)}}var QE=new Map([["hide",KE],["rotate",CL],["ellipsis",e1],["wrap",LL]]);function n1(t,e,n){return e.labelOverlap.length<1?!1:n==="hide"?!vE(t[0]):n==="rotate"?!t.some(function(r){var o;return!!(!((o=r.attr("transform"))===null||o===void 0)&&o.includes("rotate"))}):n==="ellipsis"||n==="wrap"?t.filter(function(r){return r.querySelector("text")}).length>1:!0}function PL(t,e,n){var r=e.labelOverlap,o=r===void 0?[]:r;o.length&&o.forEach(function(c){var l=c.type,u=QE.get(l);n1(t,e,l)&&(u==null||u(t,c,e,n))})}function JE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(r){return r==="positive"?-1:1};return t.reduce(function(r,o){return r*n(o)},1)}function tw(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function Np(t,e){var n=(0,T.CR)(t,2),r=n[0],o=n[1],c=(0,T.CR)(e,2),l=c[0],u=c[1],d=(0,T.CR)([r*l+o*u,r*u-o*l],2),h=d[0],p=d[1];return Math.atan2(p,h)}function IL(t){var e=(t+360)%180;return Ci(e,-90,90)||(e+=180),e}function ew(t,e,n){var r,o=n.labelAlign,c=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(c)return e.getLocalEulerAngles();var l=0,u=Mc(t.value,n),d=Df(t.value,n);return o==="horizontal"?0:(o==="perpendicular"?l=Np([1,0],u):l=Np([d[0]<0?-1:1,0],d),IL(Iy(l)))}function r1(t,e,n){var r=n.type,o=n.labelAlign,c=Mc(t,n),l=tw(e),u=tw(Iy(Np([1,0],c))),d="center",h="middle";return r==="linear"?[90,270].includes(u)&&l===0?(d="center",h=c[1]===1?"top":"bottom"):!(u%180)&&[90,270].includes(l)?d="center":u===0?(Ci(l,0,90,!1,!0)||Ci(l,0,90)||Ci(l,270,360))&&(d="start"):u===90?Ci(l,0,90,!1,!0)?d="start":(Ci(l,90,180)||Ci(l,270,360))&&(d="end"):u===270?Ci(l,0,90,!1,!0)?d="end":(Ci(l,90,180)||Ci(l,270,360))&&(d="start"):u===180&&(l===90?d="start":(Ci(l,0,90)||Ci(l,270,360))&&(d="end")):o==="parallel"?Ci(u,0,180,!0)?h="top":h="bottom":o==="horizontal"?Ci(u,90,270,!1)?d="end":(Ci(u,270,360,!1)||Ci(u,0,90))&&(d="start"):o==="perpendicular"&&(Ci(u,90,270)?d="end":d="start"),{textAlign:d,textBaseline:h}}function nw(t,e,n){e.setLocalEulerAngles(t);var r=e.__data__.value,o=r1(r,t,n),c=e.querySelector(_r.labelItem.class);c&&rw(c,o)}function Hl(t,e,n){var r=n.showTick,o=n.tickLength,c=n.tickDirection,l=n.labelDirection,u=n.labelSpacing,d=e.indexOf(t),h=_o(u,[t,d,e]),p=(0,T.CR)([Mc(t.value,n),JE(l,c)],2),v=p[0],m=p[1],b=m===1?_o(r?o:0,[t,d,e]):0,x=(0,T.CR)(Dl(Ta(v,h+b),Nl(t.value,n)),2),S=x[0],E=x[1];return{x:S,y:E}}function RL(t,e,n,r){var o=r.labelFormatter,c=lo(o)?function(){return Rs(_o(o,[t,e,n,Mc(t.value,r)]))}:function(){return Rs(t.label||"")};return c}function rw(t,e){t.nodeName==="text"&&t.attr(e)}function Ka(t){PL(this.node().childNodes,t,{hide:Po,show:kl,rotate:function(e,n){nw(+n,e,t)},ellipsis:function(e,n,r){e&&Fp(e,n||1/0,r)},wrap:function(e,n,r){e&&ZE(e,n,r)},getTextShape:function(e){return e.querySelector("text")}})}function Vl(t,e,n,r,o){var c=n.indexOf(e),l=qn(t).append(RL(e,c,n,o)).attr("className",_r.labelItem.name).node(),u=(0,T.CR)(Ca(jy(r,[e,c,n])),2),d=u[0],h=u[1],p=h.transform,v=(0,T._T)(h,["transform"]);Nf(l,p);var m=ew(e,l,o);return l.getLocalEulerAngles()||l.setLocalEulerAngles(m),rw(l,(0,T.pi)((0,T.pi)({},r1(e.value,m,o)),d)),t.attr(v),l}function jf(t,e,n,r){var o=Tp(e,n.labelFilter),c=or(n,"label");return t.selectAll(_r.label.class).data(o,function(l,u){return u}).join(function(l){return l.append("g").attr("className",_r.label.name).transition(function(u){Vl(this,u,e,c,n);var d=Hl(u,e,n),h=d.x,p=d.y;return this.style.transform="translate(".concat(h,", ").concat(p,")"),null}).call(function(){Ka.call(t,n)})},function(l){return l.transition(function(u){var d=this.querySelector(_r.labelItem.class),h=Vl(this,u,e,c,n),p=My(d,h,r.update),v=Hl(u,e,n),m=v.x,b=v.y,x=Ti(this,{transform:"translate(".concat(m,", ").concat(b,")")},r.update);return(0,T.ev)((0,T.ev)([],(0,T.CR)(p),!1),[x],!1)}).call(function(u){var d=hr(u,"_transitions").flat().filter(Ky);Ty(d,function(){Ka.call(t,n)})})},function(l){return l.transition(function(){var u=this,d=kf(this.childNodes[0],r.exit);return Aa(d,function(){return qn(u).remove()}),d})}).transitions()}function ks(t,e){return Mp(t,e.tickDirection,e)}function Mi(t,e){var n=(0,T.CR)(t,2),r=n[0],o=n[1];return[[0,0],[r*e,o*e]]}function uo(t,e,n,r,o){var c=o.tickLength,l=(0,T.CR)(Mi(r,_o(c,[t,e,n])),2),u=(0,T.CR)(l[0],2),d=u[0],h=u[1],p=(0,T.CR)(l[1],2),v=p[0],m=p[1];return{x1:d,x2:v,y1:h,y2:m}}function Qa(t,e,n,r,o){var c=o.tickFormatter,l=ks(e.value,o),u="line";return lo(c)&&(u=function(){return _o(c,[e,n,r,l])}),t.append(u).attr("className",_r.tickItem.name)}function Ds(t,e,n,r,o,c,l){var u=ks(t.value,c),d=uo(t,e,n,u,c),h=d.x1,p=d.x2,v=d.y1,m=d.y2,b=(0,T.CR)(Ca(jy(l,[t,e,n,u])),2),x=b[0],S=b[1];r.node().nodeName==="line"&&r.styles((0,T.pi)({x1:h,x2:p,y1:v,y2:m},x)),o.attr(S),r.styles(x)}function Wl(t,e,n,r,o,c){var l=Qa(qn(this),t,e,n,r);Ds(t,e,n,l,this,r,o);var u=(0,T.CR)(Nl(t.value,r),2),d=u[0],h=u[1];return Ti(this,{transform:"translate(".concat(d,", ").concat(h,")")},c)}function Hi(t,e,n,r){var o=Tp(e,n.tickFilter),c=or(n,"tick");return t.selectAll(_r.tick.class).data(o,function(l){return l.id||l.label}).join(function(l){return l.append("g").attr("className",_r.tick.name).transition(function(u,d){return Wl.call(this,u,d,o,n,c,!1)})},function(l){return l.transition(function(u,d){return this.removeChildren(),Wl.call(this,u,d,o,n,c,r.update)})},function(l){return l.transition(function(){var u=this,d=kf(this.childNodes[0],r.exit);return Aa(d,function(){return u.remove()}),d})}).transitions()}var Hn=function(){function t(e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=0),o===void 0&&(o=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=n,this.width=r,this.height=o}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(e,n){return e>=this.left&&e<=this.right&&n>=this.top&&n<=this.bottom},t}();function Gl(t){var e=t.getRenderBounds(),n=__read(e.min,2),r=n[0],o=n[1],c=__read(e.max,2),l=c[0],u=c[1],d=l-r,h=u-o;return new Hn(r,o,d,h)}var In=Io({text:"text"},"title");function zf(t){return/\S+-\S+/g.test(t)?t.split("-").map(function(e){return e[0]}):t.length>2?[t[0]]:t.split("")}function iw(t,e){var n=t.attributes,r=n.position,o=n.spacing,c=n.inset,l=n.text,u=t.getBBox(),d=e.getBBox(),h=zf(r),p=(0,T.CR)(Zi(l?o:0),4),v=p[0],m=p[1],b=p[2],x=p[3],S=(0,T.CR)(Zi(c),4),E=S[0],w=S[1],M=S[2],L=S[3],I=(0,T.CR)([x+m,v+b],2),R=I[0],z=I[1],W=(0,T.CR)([L+w,E+M],2),Y=W[0],st=W[1];if(h[0]==="l")return new Hn(u.x,u.y,d.width+u.width+R+Y,Math.max(d.height+st,u.height));if(h[0]==="t")return new Hn(u.x,u.y,Math.max(d.width+Y,u.width),d.height+u.height+z+st);var xt=(0,T.CR)([e.attributes.width||d.width,e.attributes.height||d.height],2),Nt=xt[0],Ht=xt[1];return new Hn(d.x,d.y,Nt+u.width+R+Y,Ht+u.height+z+st)}function ow(t,e){var n=Object.entries(e).reduce(function(r,o){var c=(0,T.CR)(o,2),l=c[0],u=c[1],d=t.node().attr(l);return d||(r[l]=u),r},{});t.styles(n)}function Yl(t){var e,n,r,o,c=t,l=c.width,u=c.height,d=c.position,h=(0,T.CR)([+l/2,+u/2],2),p=h[0],v=h[1],m=(0,T.CR)([+p,+v,"center","middle"],4),b=m[0],x=m[1],S=m[2],E=m[3],w=zf(d);return w.includes("l")&&(e=(0,T.CR)([0,"start"],2),b=e[0],S=e[1]),w.includes("r")&&(n=(0,T.CR)([+l,"end"],2),b=n[0],S=n[1]),w.includes("t")&&(r=(0,T.CR)([0,"top"],2),x=r[0],E=r[1]),w.includes("b")&&(o=(0,T.CR)([+u,"bottom"],2),x=o[0],E=o[1]),{x:b,y:x,textAlign:S,textBaseline:E}}var i1=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var n=this,r=this.attributes,o=r.width,c=r.height,l=r.position,u=r.spacing,d=r.inset,h=n.querySelector(In.text.class);if(!h)return new Hn(0,0,+o,+c);var p=h.getBBox(),v=p.width,m=p.height,b=(0,T.CR)(Zi(u),4),x=b[0],S=b[1],E=b[2],w=b[3],M=(0,T.CR)([0,0,+o,+c],4),L=M[0],I=M[1],R=M[2],z=M[3],W=zf(l);if(W.includes("i"))return new Hn(L,I,R,z);W.forEach(function(wt,oe){var Ut,Kt,me,Ee;wt==="t"&&(Ut=(0,T.CR)(oe===0?[m+E,+c-m-E]:[0,+c],2),I=Ut[0],z=Ut[1]),wt==="r"&&(Kt=(0,T.CR)([+o-v-w],1),R=Kt[0]),wt==="b"&&(me=(0,T.CR)([+c-m-x],1),z=me[0]),wt==="l"&&(Ee=(0,T.CR)(oe===0?[v+S,+o-v-S]:[0,+o],2),L=Ee[0],R=Ee[1])});var Y=(0,T.CR)(Zi(d),4),st=Y[0],xt=Y[1],Nt=Y[2],Ht=Y[3],dt=(0,T.CR)([Ht+xt,st+Nt],2),Ot=dt[0],bt=dt[1];return new Hn(L+Ht,I+st,R-Ot,z-bt)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new Hn(0,0,0,0)},e.prototype.render=function(n,r){var o=this,c=n.width,l=n.height,u=n.position,d=n.spacing,h=(0,T._T)(n,["width","height","position","spacing"]),p=(0,T.CR)(Ca(h),1),v=p[0],m=Yl(n),b=m.x,x=m.y,S=m.textAlign,E=m.textBaseline;ro(!!h.text,qn(r),function(w){o.title=w.maybeAppendByClassName(In.text,"text").styles(v).call(ow,{x:b,y:x,textAlign:S,textBaseline:E}).node()})},e}(Ni);function aw(t,e,n){var r=n.titlePosition,o=r===void 0?"lb":r,c=n.titleSpacing,l=zf(o),u=t.node().getLocalBounds(),d=(0,T.CR)(u.min,2),h=d[0],p=d[1],v=(0,T.CR)(u.halfExtents,2),m=v[0],b=v[1],x=(0,T.CR)(e.node().getLocalBounds().halfExtents,2),S=x[0],E=x[1],w=(0,T.CR)([h+m,p+b],2),M=w[0],L=w[1],I=(0,T.CR)(Zi(c),4),R=I[0],z=I[1],W=I[2],Y=I[3];if(["start","end"].includes(o)&&n.type==="linear"){var st=n.startPos,xt=n.endPos,Nt=(0,T.CR)(o==="start"?[st,xt]:[xt,st],2),Ht=Nt[0],dt=Nt[1],Ot=Fl([-dt[0]+Ht[0],-dt[1]+Ht[1]]),bt=(0,T.CR)(Ta(Ot,R),2),wt=bt[0],oe=bt[1];return{x:Ht[0]+wt,y:Ht[1]+oe}}return l.includes("t")&&(L-=b+E+R),l.includes("r")&&(M+=m+S+z),l.includes("l")&&(M-=m+S+Y),l.includes("b")&&(L+=b+E+W),{x:M,y:L}}function o1(t,e,n){var r=t.getGeometryBounds().halfExtents,o=r[1]*2;if(e==="vertical"){if(n==="left")return"rotate(-90) translate(0, ".concat(o/2,")");if(n==="right")return"rotate(-90) translate(0, -".concat(o/2,")")}return""}function Bp(t,e,n,r,o){var c=or(r,"title"),l=(0,T.CR)(Ca(c),2),u=l[0],d=l[1],h=d.transform,p=d.transformOrigin,v=(0,T._T)(d,["transform","transformOrigin"]);e.styles(v);var m=h||o1(t.node(),u.direction,u.position);t.styles((0,T.pi)((0,T.pi)({},u),{transformOrigin:p})),Nf(t.node(),m);var b=aw(qn(n._offscreen||n.querySelector(_r.mainGroup.class)),e,r),x=b.x,S=b.y,E=Ti(e.node(),{transform:"translate(".concat(x,", ").concat(S,")")},o);return E}function sw(t,e,n,r){var o=n.titleText;return t.selectAll(_r.title.class).data([{title:o}].filter(function(c){return!!c.title}),function(c,l){return c.title}).join(function(c){return c.append(function(){return Rs(o)}).attr("className",_r.title.name).transition(function(){return Bp(qn(this),t,e,n,r.enter)})},function(c){return c.transition(function(){return Bp(qn(this),t,e,n,r.update)})},function(c){return c.remove()}).transitions()}function a1(t,e,n,r){var o=t.showLine,c=t.showTick,l=t.showLabel,u=e.maybeAppendByClassName(_r.lineGroup,"g"),d=ro(o,u,function(b){return BE(b,t,r)})||[],h=e.maybeAppendByClassName(_r.tickGroup,"g"),p=ro(c,h,function(b){return Hi(b,n,t,r)})||[],v=e.maybeAppendByClassName(_r.labelGroup,"g"),m=ro(l,v,function(b){return jf(b,n,t,r)})||[];return(0,T.ev)((0,T.ev)((0,T.ev)([],(0,T.CR)(d),!1),(0,T.CR)(p),!1),(0,T.CR)(m),!1).filter(function(b){return!!b})}var jp=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,Ac)||this}return e.prototype.render=function(n,r,o){var c=this,l=n.titleText,u=n.data,d=n.animate,h=n.showTitle,p=n.showGrid,v=n.dataThreshold,m=n.truncRange,b=_p(u,v).filter(function(R){var z=R.value;return!(m&&z>m[0]&&z<m[1])}),x=Ay(o===void 0?d:o),S=qn(r).maybeAppendByClassName(_r.gridGroup,"g"),E=ro(p,S,function(R){return zE(R,b,n,x)})||[],w=qn(r).maybeAppendByClassName(_r.mainGroup,"g");l&&(!this.initialized&&x.enter||this.initialized&&x.update)&&a1(n,qn(this.offscreenGroup),b,Ay(!1));var M=a1(n,qn(w.node()),b,x),L=qn(r).maybeAppendByClassName(_r.titleGroup,"g"),I=ro(h,L,function(R){return sw(R,c,n,x)})||[];return(0,T.ev)((0,T.ev)((0,T.ev)([],(0,T.CR)(E),!1),(0,T.CR)(M),!1),(0,T.CR)(I),!1).flat().filter(function(R){return!!R})},e}(Ni),Fs=function(t){return t};class $l{constructor(e){this.options=en({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=en({},this.options,e),this.rescale(e)}rescale(e){}}function Uf(t,e){return e-t?n=>(n-t)/(e-t):n=>.5}function Pc(t,...e){return e.reduce((n,r)=>o=>n(r(o)),t)}function Zf(t,e,n,r,o){let c=n||0,l=r||t.length;const u=o||(d=>d);for(;c<l;){const d=Math.floor((c+l)/2);u(t[d])>e?l=d:c=d+1}return c}var cw=k(19818),s1=k.n(cw);function zp(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function kL(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,o=t[3];if(n===0)return[r*255,r*255,r*255,o];const c=r<.5?r*(1+n):r+n-r*n,l=2*r-c,u=zp(l,c,e+1/3),d=zp(l,c,e),h=zp(l,c,e-1/3);return[u*255,d*255,h*255,o]}function c1(t){const e=s1().get(t);if(!e)return null;const{model:n,value:r}=e;return n==="rgb"?r:n==="hsl"?kL(r):null}const Ns=(t,e)=>n=>t*(1-n)+e*n,l1=(t,e)=>{const n=c1(t),r=c1(e);return n===null||r===null?n?()=>t:()=>e:o=>{const c=new Array(4);for(let p=0;p<4;p+=1){const v=n[p],m=r[p];c[p]=v*(1-o)+m*o}const[l,u,d,h]=c;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(d)}, ${h})`}},Xl=(t,e)=>typeof t=="number"&&typeof e=="number"?Ns(t,e):typeof t=="string"&&typeof e=="string"?l1(t,e):()=>t,nn=(t,e)=>{const n=Ns(t,e);return r=>Math.round(n(r))};var Hf=k(71154);function u1(t){return t===null}function Ja(t){return!(0,Hf.Z)(t)&&!u1(t)&&!Number.isNaN(t)}const Up=Math.sqrt(50),Er=Math.sqrt(10),Zp=Math.sqrt(2);function Vf(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),c=r/Ri(10,o);return o>=0?(c>=Up?10:c>=Er?5:c>=Zp?2:1)*Ri(10,o):-Ri(10,-o)/(c>=Up?10:c>=Er?5:c>=Zp?2:1)}function f1(t,e,n){const r=Math.abs(e-t)/Math.max(0,n);let o=Ri(10,Math.floor(Math.log(r)/Math.LN10));const c=r/o;return c>=Up?o*=10:c>=Er?o*=5:c>=Zp&&(o*=2),e<t?-o:o}const d1=(t,e,n=5)=>{const r=[t,e];let o=0,c=r.length-1,l=r[o],u=r[c],d;return u<l&&([l,u]=[u,l],[o,c]=[c,o]),d=Vf(l,u,n),d>0?(l=Math.floor(l/d)*d,u=Math.ceil(u/d)*d,d=Vf(l,u,n)):d<0&&(l=Math.ceil(l*d)/d,u=Math.floor(u*d)/d,d=Vf(l,u,n)),d>0?(r[o]=Math.floor(l/d)*d,r[c]=Math.ceil(u/d)*d):d<0&&(r[o]=Math.ceil(l*d)/d,r[c]=Math.floor(u*d)/d),r};function lw(t,e){const n=e<t?e:t,r=t>e?t:e;return o=>Math.min(Math.max(n,o),r)}const DL=(t,e,n)=>{const[r,o]=t,[c,l]=e;let u,d;return r<o?(u=Uf(r,o),d=n(c,l)):(u=Uf(o,r),d=n(l,c)),Pc(d,u)},uw=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,o=new Array(r),c=new Array(r),l=t[0]>t[r],u=l?[...t].reverse():t,d=l?[...e].reverse():e;for(let h=0;h<r;h+=1)o[h]=Uf(u[h],u[h+1]),c[h]=n(d[h],d[h+1]);return h=>{const p=Zf(t,h,1,r)-1,v=o[p],m=c[p];return Pc(m,v)(h)}},h1=(t,e,n,r)=>(Math.min(t.length,e.length)>2?uw:DL)(t,e,r?nn:n);class Wf extends $l{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Ns,tickCount:5}}map(e){return Ja(e)?this.output(e):this.options.unknown}invert(e){return Ja(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,n,r,...o]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,n,r,...o)}getTicks(){const{tickMethod:e}=this.options,[n,r,o,...c]=this.getTickMethodOptions();return e(n,r,o,...c)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],o=e[e.length-1];return[r,o,n]}chooseNice(){return d1}rescale(){this.nice();const[e,n]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,n,this.chooseClamp(n))}chooseClamp(e){const{clamp:n,range:r}=this.options,o=this.options.domain.map(e),c=Math.min(o.length,r.length);return n?lw(o[0],o[c-1]):Fs}composeOutput(e,n){const{domain:r,range:o,round:c,interpolate:l}=this.options,u=h1(r.map(e),o,l,c);this.output=Pc(u,n,e)}composeInput(e,n,r){const{domain:o,range:c}=this.options,l=h1(c,o.map(e),Ns);this.input=Pc(n,r,l)}}const Bs=(t,e,n)=>{let r,o,c=t,l=e;if(c===l&&n>0)return[c];let u=Vf(c,l,n);if(u===0||!Number.isFinite(u))return[];if(u>0){c=Math.ceil(c/u),l=Math.floor(l/u),o=new Array(r=Math.ceil(l-c+1));for(let d=0;d<r;d+=1)o[d]=(c+d)*u}else{u=-u,c=Math.ceil(c*u),l=Math.floor(l*u),o=new Array(r=Math.ceil(l-c+1));for(let d=0;d<r;d+=1)o[d]=(c+d)/u}return o};class qi extends Wf{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Xl,tickMethod:Bs,tickCount:5}}chooseTransforms(){return[Fs,Fs]}clone(){return new qi(this.options)}}var ts=k(4637);function Hp(t,e){if(t){var n;if((0,mi.Z)(t))for(var r=0,o=t.length;r<o&&(n=e(t[r],r),n!==!1);r++);else if((0,ts.Z)(t)){for(var c in t)if(t.hasOwnProperty(c)&&(n=e(t[c],c),n===!1))break}}}var Vp=Hp,p1=function(t,e,n){if(!(0,mi.Z)(t)&&!Ya(t))return t;var r=n;return Vp(t,function(o,c){r=e(r,o,c)}),r},Wp=p1,Gp=function(t,e){return Wp(t,function(n,r,o){return e.includes(o)||(n[o]=r),n},{})};function Ma(t,e){let n,r;if(e===void 0)for(const o of t)o!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)));else{let o=-1;for(let c of t)(c=e(c,++o,t))!=null&&(n===void 0?c>=c&&(n=r=c):(n>c&&(n=c),r<c&&(r=c)))}return[n,r]}function g1(t){for(var e=1/0,n=1/0,r=-1/0,o=-1/0,c=0;c<t.length;c++){var l=t[c],u=l.x,d=l.y,h=l.width,p=l.height,v=(0,T.CR)([u+h,d+p],2),m=v[0],b=v[1];u<e&&(e=u),d<n&&(n=d),m>r&&(r=m),b>o&&(o=b)}return new Hn(e,n,r-e,o-n)}var fw=function(t,e,n){var r=t.width,o=t.height,c=n.flexDirection,l=c===void 0?"row":c,u=n.flexWrap,d=u===void 0?"nowrap":u,h=n.justifyContent,p=h===void 0?"flex-start":h,v=n.alignContent,m=v===void 0?"flex-start":v,b=n.alignItems,x=b===void 0?"flex-start":b,S=l==="row",E=l==="row"||l==="column",w=S?E?[1,0]:[-1,0]:E?[0,1]:[0,-1],M=(0,T.CR)([0,0],2),L=M[0],I=M[1],R=e.map(function(dt){var Ot,bt=dt.width,wt=dt.height,oe=(0,T.CR)([L,I],2),Ut=oe[0],Kt=oe[1];return Ot=(0,T.CR)([L+bt*w[0],I+wt*w[1]],2),L=Ot[0],I=Ot[1],new Hn(Ut,Kt,bt,wt)}),z=g1(R),W={"flex-start":0,"flex-end":S?r-z.width:o-z.height,center:S?(r-z.width)/2:(o-z.height)/2},Y=R.map(function(dt){var Ot=dt.x,bt=dt.y,wt=Hn.fromRect(dt);return wt.x=S?Ot+W[p]:Ot,wt.y=S?bt:bt+W[p],wt}),st=g1(Y),xt=function(dt){var Ot=(0,T.CR)(S?["height",o]:["width",r],2),bt=Ot[0],wt=Ot[1];switch(x){case"flex-start":return 0;case"flex-end":return wt-dt[bt];case"center":return wt/2-dt[bt]/2;default:return 0}},Nt=Y.map(function(dt){var Ot=dt.x,bt=dt.y,wt=Hn.fromRect(dt);return wt.x=S?Ot:Ot+xt(wt),wt.y=S?bt+xt(wt):bt,wt}),Ht=Nt.map(function(dt){var Ot,bt,wt=Hn.fromRect(dt);return wt.x+=(Ot=t.x)!==null&&Ot!==void 0?Ot:0,wt.y+=(bt=t.y)!==null&&bt!==void 0?bt:0,wt});return Ht},ql=function(t,e,n){return[]},dw=function(t,e,n){if(e.length===0)return[];var r={flex:fw,grid:ql},o=n.display in r?r[n.display]:null;return(o==null?void 0:o.call(null,t,e,n))||[]},hw=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n)||this;r.layoutEvents=[F.Dk.BOUNDS_CHANGED,F.Dk.INSERTED,F.Dk.REMOVED],r.$margin=Zi(0),r.$padding=Zi(0);var o=n.style||{},c=o.margin,l=c===void 0?0:c,u=o.padding,d=u===void 0?0:u;return r.margin=l,r.padding=d,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(n){this.$margin=Zi(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(n){this.$padding=Zi(n)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.x,o=r===void 0?0:r,c=n.y,l=c===void 0?0:c,u=n.width,d=n.height,h=(0,T.CR)(this.$margin,4),p=h[0],v=h[1],m=h[2],b=h[3];return new Hn(o-b,l-p,u+b+v,d+p+m)},e.prototype.appendChild=function(n,r){return n.isMutationObserved=!0,t.prototype.appendChild.call(this,n,r),n},e.prototype.getAvailableSpace=function(){var n=this.attributes,r=n.width,o=n.height,c=(0,T.CR)(this.$padding,4),l=c[0],u=c[1],d=c[2],h=c[3],p=(0,T.CR)(this.$margin,4),v=p[0],m=p[3];return new Hn(h+m,l+v,r-h-u,o-l-d)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(l){return!l.isConnected}))try{var n=this.attributes,r=n.x,o=n.y;this.style.transform="translate(".concat(r,", ").concat(o,")");var c=dw(this.getAvailableSpace(),this.children.map(function(l){return l.getBBox()}),this.attributes);this.children.forEach(function(l,u){var d=c[u],h=d.x,p=d.y;l.style.transform="translate(".concat(h,", ").concat(p,")")})}catch(l){}},e.prototype.bindEvents=function(){var n=this;this.layoutEvents.forEach(function(r){n.addEventListener(r,function(o){o.target.isMutationObserved=!0,n.layout()})})},e.prototype.attributeChangedCallback=function(n,r,o){n==="margin"?this.margin=o:n==="padding"&&(this.padding=o),this.layout()},e}(F.ZA),pw=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function gw(t){return class extends F.b_{constructor(e){super(e),this.descriptor=t}connectedCallback(){var e,n;(n=(e=this.descriptor).render)===null||n===void 0||n.call(e,this.attributes,this)}update(e={}){var n,r;this.attr(en({},this.attributes,e)),(r=(n=this.descriptor).render)===null||r===void 0||r.call(n,this.attributes,this)}}}function v1(t,e,n){return t.querySelector(e)?Wn(t).select(e):Wn(t).append(n)}function es(t){return Array.isArray(t)?t.join(", "):`${t||""}`}function m1(t,e){const n={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:r,justifyContent:o,alignItems:c}=n;const l={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return t in l&&([r,o,c]=l[t]),Object.assign({display:"flex",flexDirection:r,justifyContent:o,alignItems:c},e)}class y1 extends hw{get child(){var e;return(e=this.children)===null||e===void 0?void 0:e[0]}update(e){var n;this.attr(e);const{subOptions:r}=e;(n=this.child)===null||n===void 0||n.update(r)}}class b1 extends y1{update(e){var n;const{subOptions:r}=e;this.attr(e),(n=this.child)===null||n===void 0||n.update(r)}}function ra(t,e){var n;return(n=t.filter(r=>r.getOptions().name===e))===null||n===void 0?void 0:n[0]}function ia(t){return t==="horizontal"||t===0}function vw(t){return t==="vertical"||t===-Math.PI/2}function _1(t,e,n){const{bbox:r}=t,{position:o="top",size:c,length:l}=e,u=["top","bottom","center"].includes(o),[d,h]=u?[r.height,r.width]:[r.width,r.height],{defaultSize:p,defaultLength:v}=n.props,m=c||p||d,b=l||v||h,x=u?"horizontal":"vertical",[S,E]=u?[b,m]:[m,b];return{orientation:x,width:S,height:E,size:m,length:b}}function mw(t){return t.find(e=>e.getOptions().domain.length>0).getOptions().domain}function Gf(t){const e=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:n}=t,r=pw(t,["style"]),o={};return Object.entries(r).forEach(([c,l])=>{e.includes(c)?o[`show${Ts(c)}`]=l:o[c]=l}),Object.assign(Object.assign({},o),n)}var x1=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function S1(t,e){const{eulerAngles:n,origin:r}=e;r&&t.setOrigin(r),n&&t.rotate(n[0],n[1],n[2])}function Yf(t){const{innerWidth:e,innerHeight:n,depth:r}=t.getOptions();return[e,n,r]}function Yp(t,e){const{width:n,height:r}=e.getOptions();return o=>{if(!pp(e))return o;const c=t==="bottom"?[o,1]:[0,o],l=e.map(c);if(t==="bottom"){const u=l[0];return new qi({domain:[0,n],range:[0,1]}).map(u)}else if(t==="left"){const u=l[1];return new qi({domain:[0,r],range:[0,1]}).map(u)}return o}}function $p(t,e,n){if(t.getTicks)return t.getTicks();if(!n)return e;const[r,o]=Ma(e,l=>+l),{tickCount:c}=t.getOptions();return n(r,o,c)}function $f(t,e){if(Pr(e))return b=>b;const n=e.getOptions(),{innerWidth:r,innerHeight:o,insetTop:c,insetBottom:l,insetLeft:u,insetRight:d}=n,[h,p,v]=t==="left"||t==="right"?[c,l,o]:[u,d,r],m=new qi({domain:[0,1],range:[h/v,1-p/v]});return b=>m.map(b)}function Kl(t,e,n,r,o,c,l,u){var d;(n!==void 0||c!==void 0)&&t.update(Object.assign(Object.assign({},n&&{tickCount:n}),c&&{tickMethod:c}));const h=$p(t,e,c),p=o?h.filter(o):h,v=w=>w instanceof Date?String(w):typeof w=="object"&&w?w:String(w),m=r||((d=t.getFormatter)===null||d===void 0?void 0:d.call(t))||v,b=$f(l,u),x=Yp(l,u),S=w=>["top","bottom","center","outer"].includes(w),E=w=>["left","right"].includes(w);return Pr(u)||Yr(u)?p.map((w,M,L)=>{var I,R;const z=((I=t.getBandWidth)===null||I===void 0?void 0:I.call(t,w))/2||0,W=b(t.map(w)+z);return{value:Il(u)&&l==="center"||Yr(u)&&((R=t.getTicks)===null||R===void 0?void 0:R.call(t))&&S(l)||Yr(u)&&E(l)?1-W:W,label:v(m(Pl(w),M,L)),id:String(M)}}):p.map((w,M,L)=>{var I;const R=((I=t.getBandWidth)===null||I===void 0?void 0:I.call(t,w))/2||0,z=x(b(t.map(w)+R));return{value:E(l)?1-z:z,label:v(m(Pl(w),M,L)),id:String(M)}})}function Xp(t,e,n="xy"){const[r,o,c]=Yf(e);return n==="xy"?t.includes("bottom")||t.includes("top")?o:r:n==="xz"?t.includes("bottom")||t.includes("top")?c:r:t.includes("bottom")||t.includes("top")?o:c}function qp(t=[],e){if(t.length>0)return t;const{labelAutoRotate:n,labelAutoHide:r,labelAutoEllipsis:o,labelAutoWrap:c}=e,l=[],u=(d,h)=>{h&&l.push(Object.assign(Object.assign({},d),h))};return u({type:"rotate",optionalAngles:[0,15,30,45,60,90]},n),u({type:"ellipsis",minLength:20},o),u({type:"hide"},r),u({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},c),l}function Xf(t,e,n,r,o){const{x:c,y:l,width:u,height:d}=e,h=[c+u/2,l+d/2],p=Math.min(u,d)/2,[v,m]=vp(o),[b,x]=Yf(o),S=Math.min(b,x)/2,E={center:h,radius:p,startAngle:v,endAngle:m,gridLength:(r-n)*S};if(t==="inner"){const{insetLeft:w,insetTop:M}=o.getOptions();return Object.assign(Object.assign({},E),{center:[h[0]-w,h[1]-M],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},E),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function Ql(t,e,n){return gp(e)||Rl(e)?!1:t===void 0?!!n.getTicks:t}function fo(t){const{depth:e}=t.getOptions();return e?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function Kp(t,e,n,r,o){const{x:c,y:l,width:u,height:d}=n;if(t==="bottom")return{startPos:[c,l],endPos:[c+u,l]};if(t==="left")return{startPos:[c+u,l+d],endPos:[c+u,l]};if(t==="right")return{startPos:[c,l+d],endPos:[c,l]};if(t==="top")return{startPos:[c,l+d],endPos:[c+u,l+d]};if(t==="center"){if(e==="vertical")return{startPos:[c,l],endPos:[c,l+d]};if(e==="horizontal")return{startPos:[c,l],endPos:[c+u,l]};if(typeof e=="number"){const[h,p]=r.getCenter(),[v,m]=wf(r),[b,x]=vp(r),S=Math.min(u,d)/2,{insetLeft:E,insetTop:w}=r.getOptions(),M=v*S,L=m*S,[I,R]=[h+c-E,p+l-w],[z,W]=[Math.cos(e),Math.sin(e)],Y=[I+L*z,R+L*W],st=[I+M*z,R+M*W],xt=()=>{const{domain:Ht}=o.getOptions();return Ht.length},Nt=Pr(r)&&o?xt():3;return{startPos:Y,endPos:st,gridClosed:Math.abs(x-b-360)<1e-6,gridCenter:[I,R],gridControlAngles:new Array(Nt).fill(0).map((Ht,dt,Ot)=>(x-b)/Nt*dt)}}}return{}}const Qp=t=>{const{order:e,size:n,position:r,orientation:o,labelFormatter:c,tickFilter:l,tickCount:u,tickMethod:d,important:h={},style:p={},indexBBox:v,title:m,grid:b=!1}=t,x=x1(t,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","important","style","indexBBox","title","grid"]);return({scales:[S],value:E,coordinate:w,theme:M})=>{const{bbox:L}=E,{domain:I}=S.getOptions(),R=Kl(S,I,u,c,l,d,r,w),z=v?R.map((dt,Ot)=>{const bt=v.get(Ot);return!bt||bt[0]!==dt.label?dt:Object.assign(Object.assign({},dt),{bbox:bt[1]})}):R,[W,Y]=wf(w),st=Xf(r,L,W,Y,w),{axis:xt,axisArc:Nt={}}=M,Ht=Gf(en({},xt,Nt,st,Object.assign(Object.assign({type:"arc",data:z,titleText:es(m),grid:b},x),h)));return new jp({style:Gp(Ht,["transform"])})}};function ns(t,e,n,r,o,c){const l=n.axis,u=["top","right","bottom","left"].includes(o)?n[`axis${op(o)}`]:n.axisLinear,d=t.getOptions().name,h=n[`axis${Ts(d)}`]||{};return Object.assign({},l,u,h)}function yw(t,e,n,r,o,c){const l=ns(t,e,n,r,o,c);return o==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},l),{labelDirection:r==="right"?"negative":"positive"}),r==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:r==="right"?"negative":"positive",labelSpacing:r==="center"?0:4,titleSpacing:vw(c)?10:0,tick:r==="center"?!1:void 0}):l}const bw=t=>{const{direction:e="left",important:n={},labelFormatter:r,order:o,orientation:c,actualPosition:l,position:u,size:d,style:h={},title:p,tickCount:v,tickFilter:m,tickMethod:b,transform:x,indexBBox:S}=t,E=x1(t,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","transform","indexBBox"]);return({scales:w,value:M,coordinate:L,theme:I})=>{const{bbox:R}=M,[z]=w,{domain:W,xScale:Y}=z.getOptions(),st=yw(z,L,I,e,u,c),xt=Object.assign(Object.assign(Object.assign({},st),h),E),Nt=Xp(l||u,L,t.plane),Ht=Kp(u,c,R,L,Y),dt=fo(L),Ot=Kl(z,W,v,r,m,b,u,L),bt=S?Ot.map((Ut,Kt)=>{const me=S.get(Kt);return!me||me[0]!==Ut.label?Ut:Object.assign(Object.assign({},Ut),{bbox:me[1]})}):Ot,wt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},xt),{type:"linear",data:bt,crossSize:d,titleText:es(p),labelOverlap:qp(x,xt),grid:Ql(xt.grid,L,z),gridLength:Nt,line:!0,indexBBox:S}),xt.line?null:{lineOpacity:0}),Ht),dt),n);return wt.labelOverlap.find(Ut=>Ut.type==="hide")&&(wt.crossSize=!1),new jp({className:"axis",style:Gf(wt)})}},O1=t=>e=>{const{labelFormatter:n,labelFilter:r=()=>!0}=e;return o=>{var c;const{scales:[l]}=o,u=((c=l.getTicks)===null||c===void 0?void 0:c.call(l))||l.getOptions().domain,d=typeof n=="string"?Xa(n):n,h=(v,m,b)=>r(u[m],m,u),p=Object.assign(Object.assign({},e),{labelFormatter:d,labelFilter:h,scale:l});return t(p)(o)}},La=O1(bw),Jp=O1(Qp);La.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},Jp.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var Jl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function _w(t){const e=t%(Math.PI*2);return e===Math.PI/2?{titleTransform:"translate(0, 50%)"}:e>-Math.PI/2&&e<Math.PI/2?{titleTransform:"translate(50%, 0)"}:e>Math.PI/2&&e<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function xw(t,e,n,r){const{radar:o}=t,[c]=r,l=c.getOptions().name,[u,d]=vp(n),{axisRadar:h={}}=e;return Object.assign(Object.assign({},h),{grid:l==="position",gridConnect:"line",gridControlAngles:new Array(o.count).fill(0).map((p,v)=>(d-u)/o.count*v)})}const E1=t=>{const{important:e={}}=t,n=Jl(t,["important"]);return r=>{const{theme:o,coordinate:c,scales:l}=r;return La(Object.assign(Object.assign(Object.assign({},n),_w(t.orientation)),{important:Object.assign(Object.assign({},xw(t,o,c,l)),e)}))(r)}};E1.props=Object.assign(Object.assign({},La.props),{defaultPosition:"center"});function tu(t,e){return+t.toPrecision(e)}function FL(t){return t.toLocaleString()}function NL(t){return t.toExponential()}function BL(t,e){return e===void 0&&(e=0),Math.abs(t)<1e3?String(t):"".concat(tu(t/1e3,e).toLocaleString(),"K")}var Ic=function(t,e,n){return t<0&&Number.isFinite(t)?e:n},w1=function(t,e,n){return t>0&&Number.isFinite(t)?e:n},t0=function(t,e){return t*e},A1=function(t,e){return t/2+(e||0)/2};function rs(t){var e=t.canvas,n=t.touches,r=t.offsetX,o=t.offsetY;if(e){var c=e.x,l=e.y;return[c,l]}if(n){var u=n[0],d=u.clientX,h=u.clientY;return[d,h]}return r&&o?[r,o]:[0,0]}var e0={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},eu=Io({background:"background",labelGroup:"label-group",label:"label"},"indicator"),nu=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,e0)||this;return r.point=[0,0],r.group=r.appendChild(new F.ZA({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var n=this.attributes,r=n.position,o=n.padding,c=(0,T.CR)(Zi(o),4),l=c[0],u=c[1],d=c[2],h=c[3],p=this.label.node().getLocalBounds(),v=p.min,m=p.max,b=new Hn(v[0]-h,v[1]-l,m[0]+u-v[0]+h,m[1]+d-v[1]+l),x=this.getPath(r,b),S=or(this.attributes,"background");this.background=qn(this.group).maybeAppendByClassName(eu.background,"path").styles((0,T.pi)((0,T.pi)({},S),{d:x})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var n=this.attributes,r=n.formatter,o=n.labelText,c=or(this.attributes,"label"),l=(0,T.CR)(Ca(c),2),u=l[0],d=l[1],h=u.text,p=(0,T._T)(u,["text"]);if(this.label=qn(this.group).maybeAppendByClassName(eu.labelGroup,"g").styles(d),!!o){var v=this.label.maybeAppendByClassName(eu.label,function(){return Rs(r(o))}).style("text",r(o).toString());v.selectAll("text").styles(p)}},e.prototype.adjustLayout=function(){var n=(0,T.CR)(this.point,2),r=n[0],o=n[1],c=this.attributes,l=c.x,u=c.y;this.group.attr("transform","translate(".concat(l-r,", ").concat(u-o,")"))},e.prototype.getPath=function(n,r){var o=this.attributes.radius,c=r.x,l=r.y,u=r.width,d=r.height,h=[["M",c+o,l],["L",c+u-o,l],["A",o,o,0,0,1,c+u,l+o],["L",c+u,l+d-o],["A",o,o,0,0,1,c+u-o,l+d],["L",c+o,l+d],["A",o,o,0,0,1,c,l+d-o],["L",c,l+o],["A",o,o,0,0,1,c+o,l],["Z"]],p={top:4,right:6,bottom:0,left:2},v=p[n],m=this.createCorner([h[v].slice(-2),h[v+1].slice(-2)]);return h.splice.apply(h,(0,T.ev)([v+1,1],(0,T.CR)(m),!1)),h[0][0]="M",h},e.prototype.createCorner=function(n,r){r===void 0&&(r=10);var o=.8,c=$E.apply(void 0,(0,T.ev)([],(0,T.CR)(n),!1)),l=(0,T.CR)(n,2),u=(0,T.CR)(l[0],2),d=u[0],h=u[1],p=(0,T.CR)(l[1],2),v=p[0],m=p[1],b=(0,T.CR)(c?[v-d,[d,v]]:[m-h,[h,m]],2),x=b[0],S=(0,T.CR)(b[1],2),E=S[0],w=S[1],M=x/2,L=x/Math.abs(x),I=r*L,R=I/2,z=I*Math.sqrt(3)/2*o,W=(0,T.CR)([E,E+M-R,E+M,E+M+R,w],5),Y=W[0],st=W[1],xt=W[2],Nt=W[3],Ht=W[4];return c?(this.point=[xt,h-z],[["L",Y,h],["L",st,h],["L",xt,h-z],["L",Nt,h],["L",Ht,h]]):(this.point=[d+z,xt],[["L",d,Y],["L",d,st],["L",d+z,xt],["L",d,Nt],["L",d,Ht]])},e.prototype.applyVisibility=function(){var n=this.attributes.visibility;n==="hidden"?Po(this):kl(this)},e.prototype.bindEvents=function(){this.label.on(F.Dk.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Ni),qf={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},Rc={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},ru={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Li=Io({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),oa=Io({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),n0=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.x,c=n.y,l=n.size,u=l===void 0?10:l,d=n.radius,h=d===void 0?u/4:d,p=n.orientation,v=(0,T._T)(n,["x","y","size","radius","orientation"]),m=u,b=m*2.4,x=qn(r).maybeAppendByClassName(oa.iconRect,"rect").styles((0,T.pi)((0,T.pi)({},v),{width:m,height:b,radius:h,x:o-m/2,y:c-b/2,transformOrigin:"center"})),S=o+1/3*m-m/2,E=o+2/3*m-m/2,w=c+1/4*b-b/2,M=c+3/4*b-b/2;x.maybeAppendByClassName("".concat(oa.iconLine,"-1"),"line").styles((0,T.pi)({x1:S,x2:S,y1:w,y2:M},v)),x.maybeAppendByClassName("".concat(oa.iconLine,"-2"),"line").styles((0,T.pi)({x1:E,x2:E,y1:w,y2:M},v)),p==="vertical"&&(x.node().style.transform="rotate(90)")},e}(Ni),T1=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,ru)||this}return e.prototype.renderLabel=function(n){var r=this,o=this.attributes,c=o.x,l=o.y,u=o.showLabel,d=or(this.attributes,"label"),h=d.x,p=h===void 0?0:h,v=d.y,m=v===void 0?0:v,b=d.transform,x=d.transformOrigin,S=(0,T._T)(d,["x","y","transform","transformOrigin"]),E=(0,T.CR)(Ca(S,[]),2),w=E[0],M=E[1],L=qn(n).maybeAppendByClassName(oa.labelGroup,"g").styles(M),I=(0,T.pi)((0,T.pi)({},Rc),w),R=I.text,z=(0,T._T)(I,["text"]);ro(!!u,L,function(W){r.label=W.maybeAppendByClassName(oa.label,"text").styles((0,T.pi)((0,T.pi)({},z),{x:c+p,y:l+m,transform:b,transformOrigin:x,text:"".concat(R)})),r.label.on("mousedown",function(Y){Y.stopPropagation()}),r.label.on("touchstart",function(Y){Y.stopPropagation()})})},e.prototype.renderIcon=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.orientation,u=r.type,d=(0,T.pi)((0,T.pi)({x:o,y:c,orientation:l},qf),or(this.attributes,"icon")),h=this.attributes.iconShape,p=h===void 0?function(){return new n0({style:d})}:h,v=qn(n).maybeAppendByClassName(oa.iconGroup,"g");v.selectAll(oa.icon.class).data([p]).join(function(m){return m.append(typeof p=="string"?p:function(){return p(u)}).attr("className",oa.icon.name)},function(m){return m.update(d)},function(m){return m.remove()})},e.prototype.render=function(n,r){this.renderIcon(r),this.renderLabel(r)},e}(Ni),Sw=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},r0=Sw,C1=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]},jL=function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]},M1=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]},Ow=function(t,e,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]},Ew=function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]},ww=function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]},L1=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},Aw=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]},Tw=function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]},Cw=function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]},P1=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},I1=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},Mw=I1,Lw=function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]},Pw=function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]},Iw=function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]},R1=function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]};function Rw(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}var k1=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]};function kw(t){var e="default";if((0,ts.Z)(t)&&t instanceof Image)e="image";else if(lo(t))e="symbol";else if((0,gt.Z)(t)){var n=new RegExp("data:(image|text)");t.match(n)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?e="url":e="symbol"}return e}function D1(t){var e=kw(t);return["base64","url","image"].includes(e)?"image":t&&e==="symbol"?"path":null}var wr=function(t){(0,T.ZT)(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(n,r){var o=n.x,c=o===void 0?0:o,l=n.y,u=l===void 0?0:l,d=this.getSubShapeStyle(n),h=d.symbol,p=d.size,v=p===void 0?16:p,m=(0,T._T)(d,["symbol","size"]),b=D1(h);ro(!!b,qn(r),function(x){x.maybeAppendByClassName("marker",b).attr("className","marker ".concat(b,"-marker")).call(function(S){if(b==="image"){var E=v*2;S.styles({img:h,width:E,height:E,x:c-v,y:u-v})}else{var E=v/2,w=lo(h)?h:e.getSymbol(h);S.styles((0,T.pi)({d:w==null?void 0:w(c,u,E)},m))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(n,r){e.MARKER_SYMBOL_MAP.set(n,r)},e.getSymbol=function(n){return e.MARKER_SYMBOL_MAP.get(n)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Ni);wr.registerSymbol("cross",Aw),wr.registerSymbol("hyphen",P1),wr.registerSymbol("line",L1),wr.registerSymbol("plus",Cw),wr.registerSymbol("tick",Tw),wr.registerSymbol("circle",Sw),wr.registerSymbol("point",r0),wr.registerSymbol("bowtie",ww),wr.registerSymbol("hexagon",Ew),wr.registerSymbol("square",C1),wr.registerSymbol("diamond",jL),wr.registerSymbol("triangle",M1),wr.registerSymbol("triangle-down",Ow),wr.registerSymbol("line",L1),wr.registerSymbol("dot",I1),wr.registerSymbol("dash",Mw),wr.registerSymbol("smooth",Lw),wr.registerSymbol("hv",Pw),wr.registerSymbol("vh",Iw),wr.registerSymbol("hvh",R1),wr.registerSymbol("vhv",Rw);function F1(t,e,n){var r=Math.round((t-n)/e);return n+r*e}function N1(t,e,n){var r=1.4,o=r*n;return[["M",t-n,e-o],["L",t+n,e-o],["L",t+n,e+o],["L",t-n,e+o],["Z"]]}var B1=1.4,j1=.4;function Dw(t,e,n){var r=n,o=r*B1,c=r/2,l=r/6,u=t+o*j1;return[["M",t,e],["L",u,e+c],["L",t+o,e+c],["L",t+o,e-c],["L",u,e-c],["Z"],["M",u,e+l],["L",t+o-2,e+l],["M",u,e-l],["L",t+o-2,e-l]]}function Fw(t,e,n){var r=n,o=r*B1,c=r/2,l=r/6,u=e+o*j1;return[["M",t,e],["L",t-c,u],["L",t-c,e+o],["L",t+c,e+o],["L",t+c,u],["Z"],["M",t-l,u],["L",t-l,e+o-2],["M",t+l,u],["L",t+l,e+o-2]]}wr.registerSymbol("hiddenHandle",N1),wr.registerSymbol("verticalHandle",Dw),wr.registerSymbol("horizontalHandle",Fw);var z1=function(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n};function Nw(t,e,n,r){var o;r===void 0&&(r=4);var c=(0,T.CR)(t,2),l=c[0],u=c[1],d=(0,T.CR)(e,2),h=d[0],p=d[1],v=(0,T.CR)(n,2),m=v[0],b=v[1],x=(0,T.CR)([h,p],2),S=x[0],E=x[1],w=E-S;return S>E&&(o=(0,T.CR)([E,S],2),S=o[0],E=o[1]),w>u-l?[l,u]:S<l?m===l&&b===E?[l,E]:[l,w+l]:E>u?b===u&&m===S?[S,u]:[u-w,u]:[S,E]}function aa(t,e,n){return t===void 0&&(t="horizontal"),t==="horizontal"?e:n}var iu=Io({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),U1={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},Bw=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,U1)||this}return e.prototype.render=function(n,r){var o=qn(r).maybeAppendByClassName(iu.markerGroup,"g");this.renderMarker(o);var c=qn(r).maybeAppendByClassName(iu.labelGroup,"g");this.renderLabel(c)},e.prototype.renderMarker=function(n){var r=this,o=this.attributes,c=o.orientation,l=o.markerSymbol,u=l===void 0?aa(c,"horizontalHandle","verticalHandle"):l;ro(!!u,n,function(d){var h=or(r.attributes,"marker"),p=(0,T.pi)({symbol:u},h);r.marker=d.maybeAppendByClassName(iu.marker,function(){return new wr({style:p})}).update(p)})},e.prototype.renderLabel=function(n){var r=this,o=this.attributes,c=o.showLabel,l=o.orientation,u=o.spacing,d=u===void 0?0:u,h=o.formatter;ro(c,n,function(p){var v,m=or(r.attributes,"label"),b=m.text,x=(0,T._T)(m,["text"]),S=((v=p.select(iu.marker.class))===null||v===void 0?void 0:v.node().getBBox())||{},E=S.width,w=E===void 0?0:E,M=S.height,L=M===void 0?0:M,I=(0,T.CR)(aa(l,[0,L+d,"center","top"],[w+d,0,"start","middle"]),4),R=I[0],z=I[1],W=I[2],Y=I[3];p.maybeAppendByClassName(iu.label,"text").styles((0,T.pi)((0,T.pi)({},x),{x:R,y:z,text:h(b).toString(),textAlign:W,textBaseline:Y}))})},e}(Ni),Z1={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},jw=ea({},Z1,{}),i0=ea({},Z1,na(U1,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),zw=.01,zL=.5,Vi=Io({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend");function Uw(t,e){for(var n=1;n<t.length;n+=1){var r=t[n-1],o=t[n];if(e>=r&&e<=o)return[r,o]}return[e,e]}function Zw(t,e,n){var r=Array.from(e),o=t.length;return new Array(o).fill(0).reduce(function(c,l,u){var d=r[u%r.length];return c+=" ".concat(t[u],":").concat(d).concat(u<o-1?" ".concat(t[u+1],":").concat(d):"")},"l(".concat(n==="horizontal"?"0":"270",")"))}function H1(t,e){var n=(0,T.CR)(Uw(t,e),2),r=n[0],o=n[1];return{tick:e>(r+o)/2?o:r,range:[r,o]}}var ou=Io({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function V1(t){var e=t.orientation,n=t.size,r=t.length;return aa(e,[r,n],[n,r])}function W1(t){var e=t.type,n=(0,T.CR)(V1(t),2),r=n[0],o=n[1];return e==="size"?[["M",0,o],["L",0+r,0],["L",0+r,o],["Z"]]:[["M",0,o],["L",0,0],["L",0+r,0],["L",0+r,o],["Z"]]}function Hw(t){return W1(t)}function Vw(t){var e=t.orientation,n=t.color,r=t.block,o=t.partition,c;if(lo(n)){var l=20;c=new Array(l).fill(0).map(function(h,p,v){return n(p/(v.length-1))})}else c=n;var u=c.length,d=c.map(function(h){return(0,F.lu)(h).toString()});return u?u===1?d[0]:r?Zw(o,d,e):d.reduce(function(h,p,v){return h+=" ".concat(v/(u-1),":").concat(p)},"l(".concat(aa(e,"0","270"),")")):""}function Ww(t){var e=t.orientation,n=t.range;if(!n)return[];var r=(0,T.CR)(V1(t),2),o=r[0],c=r[1],l=(0,T.CR)(n,2),u=l[0],d=l[1],h=aa(e,u*o,0),p=aa(e,0,u*c),v=aa(e,d*o,o),m=aa(e,c,d*c);return[["M",h,p],["L",h,m],["L",v,m],["L",v,p],["Z"]]}function Gw(t,e){var n=or(e,"track");t.maybeAppendByClassName(ou.track,"path").styles((0,T.pi)({d:W1(e)},n))}function Yw(t,e){var n=or(e,"selection"),r=Vw(e),o=t.maybeAppendByClassName(ou.selection,"path").styles((0,T.pi)({d:Hw(e),fill:r},n)),c=o.maybeAppendByClassName(ou.clipPath,"path").styles({d:Ww(e)}).node();o.style("clipPath",c)}var $w=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return e.prototype.render=function(n,r){var o=qn(r).maybeAppendByClassName(ou.trackGroup,"g");Gw(o,n);var c=qn(r).maybeAppendByClassName(ou.selectionGroup,"g");Yw(c,n)},e}(Ni);function Xw(t){return{min:Math.min.apply(Math,(0,T.ev)([],(0,T.CR)(t.map(function(e){return e.value})),!1)),max:Math.max.apply(Math,(0,T.ev)([],(0,T.CR)(t.map(function(e){return e.value})),!1))}}var qw=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,i0)||this;return r.eventToOffsetScale=new qi({}),r.innerRibbonScale=new qi({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(o){var c=r.attributes,l=c.data,u=c.block;o.stopPropagation();var d=r.getValueByCanvasPoint(o);if(u){var h=H1(l.map(function(m){var b=m.value;return b}),d).range,p=r.getRealSelection(h);r.showIndicator((h[0]+h[1])/2,"".concat(p[0],"-").concat(p[1])),r.dispatchIndicated(d,h)}else{var v=r.getTickValue(d);r.showIndicator(v,"".concat(r.getRealValue(v))),r.dispatchIndicated(v)}},r.onDragStart=function(o){return function(c){c.stopPropagation(),r.attributes.slidable&&(r.target=o,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(c)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(o){var c=r.target;r.updateMouse();var l=(0,T.CR)(r.selection,2),u=l[0],d=l[1],h=r.getTickValue(r.getValueByCanvasPoint(o)),p=h-r.prevValue;c==="start"?u!==h&&r.updateSelection(h,d):c==="end"?d!==h&&r.updateSelection(u,h):c==="ribbon"&&p!==0&&(r.prevValue=h,r.updateSelection(p,p,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(e.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=this.attributes,r=n.width,o=n.height;return new Hn(0,0,r,o)},e.prototype.render=function(n,r){var o=this,c=n.showLabel;this.renderTitle(qn(r));var l=this.availableSpace,u=l.x,d=l.y,h=qn(r).maybeAppendByClassName(Vi.contentGroup,"g").styles({transform:"translate(".concat(u,", ").concat(d,")")}),p=h.maybeAppendByClassName(Vi.labelGroup,"g").styles({zIndex:1});ro(!!c,p,function(m){o.renderLabel(m)});var v=h.maybeAppendByClassName(Vi.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=h.maybeAppendByClassName(Vi.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(v),this.renderIndicator(h),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(e.prototype,"range",{get:function(){var n=this.attributes,r=n.data,o=n.domain;return o?{min:o[0],max:o[1]}:Xw(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonScale",{get:function(){var n=this.range,r=n.min,o=n.max;return this.innerRibbonScale.update({domain:[r,o],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonRange",{get:function(){var n=(0,T.CR)(this.selection,2),r=n[0],o=n[1],c=this.ribbonScale;return[c.map(r),c.map(o)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var n=this.range,r=n.min,o=n.max,c=this.attributes.defaultValue,l=c===void 0?[r,o]:c,u=(0,T.CR)(l,2),d=u[0],h=u[1];return[d,h]},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){return aa(this.attributes.orientation,typeof n=="function"?n():n,typeof r=="function"?r():r)},e.prototype.renderTitle=function(n){var r=this.attributes,o=r.showTitle,c=r.titleText,l=r.width,u=r.height,d=or(this.attributes,"title"),h=(0,T.pi)((0,T.pi)({},d),{width:l,height:u,text:c}),p=this;n.selectAll(Vi.title.class).data(o?[c]:[]).join(function(v){return v.append(function(){return new i1({style:h})}).attr("className",Vi.title.name).each(function(){p.title=this})},function(v){return v.update(h)},function(v){return v.each(function(){p.title=void 0}).remove()})},Object.defineProperty(e.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var n=this.attributes,r=n.width,o=n.height;return new Hn(0,0,r,o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelFixedSpacing",{get:function(){var n=this.attributes.showTick;return n?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){var n=this.attributes,r=n.orientation,o=n.labelDirection,c={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return c[r][o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelBBox",{get:function(){var n,r=this.attributes.showLabel;if(!r)return new Hn(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var o=((n=this.label.querySelector(_r.labelGroup.class))===null||n===void 0?void 0:n.children.slice(-1)[0]).getBBox(),c=o.width,l=o.height;return this.cacheLabelBBox=new Hn(0,0,c,l),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelShape",{get:function(){var n=this.attributes,r=n.showLabel,o=n.labelSpacing,c=o===void 0?0:o;if(!r)return{width:0,height:0,size:0,length:0};var l=this.labelBBox,u=l.width,d=l.height,h=this.ifHorizontal(d,u)+c+this.labelFixedSpacing,p=this.ifHorizontal(u,d);return{width:u,height:d,size:h,length:p}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonBBox",{get:function(){var n=this.attributes,r=n.showHandle,o=n.ribbonSize,c=this.availableSpace,l=c.width,u=c.height,d=this.labelShape,h=d.size,p=d.length,v=(0,T.CR)(this.ifHorizontal([u,l],[l,u]),2),m=v[0],b=v[1],x=r?this.handleShape:{size:0,length:0},S=x.size,E=x.length,w=this.handleOffsetRatio,M=0,L=this.labelPosition;o?M=o:["bottom","right"].includes(L)?M=Math.min(m-h,(m-S)/w):m*(1-w)>S?M=Math.max(m-h,0):M=Math.max((m-h-S)/w,0);var I=Math.max(E,p),R=b-I,z=(0,T.CR)(this.ifHorizontal([R,M],[M,R]),2),W=z[0],Y=z[1],st=["top","left"].includes(L)?h:0,xt=(0,T.CR)(this.ifHorizontal([I/2,st],[st,I/2]),2),Nt=xt[0],Ht=xt[1];return new Hn(Nt,Ht,W,Y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonShape",{get:function(){var n=this.ribbonBBox,r=n.width,o=n.height;return this.ifHorizontal({size:o,length:r},{size:r,length:o})},enumerable:!1,configurable:!0}),e.prototype.renderRibbon=function(n){var r=this.attributes,o=r.data,c=r.type,l=r.orientation,u=r.color,d=r.block,h=or(this.attributes,"ribbon"),p=this.range,v=p.min,m=p.max,b=this.ribbonBBox,x=b.x,S=b.y,E=this.ribbonShape,w=E.length,M=E.size,L=ea({transform:"translate(".concat(x,", ").concat(S,")"),length:w,size:M,type:c,orientation:l,color:u,block:d,partition:o.map(function(I){return(I.value-v)/(m-v)}),range:this.ribbonRange},h);this.ribbon=n.maybeAppendByClassName(Vi.ribbon,function(){return new $w({style:L})}).update(L)},e.prototype.getHandleClassName=function(n){return"".concat(Vi.prefix("".concat(n,"-handle")))},e.prototype.renderHandles=function(){var n=this.attributes,r=n.showHandle,o=n.orientation,c=or(this.attributes,"handle"),l=(0,T.CR)(this.selection,2),u=l[0],d=l[1],h=(0,T.pi)((0,T.pi)({},c),{orientation:o}),p=c.shape,v=p===void 0?"slider":p,m=v==="basic"?Bw:T1,b=this;this.handlesGroup.selectAll(Vi.handle.class).data(r?[{value:u,type:"start"},{value:d,type:"end"}]:[],function(x){return x.type}).join(function(x){return x.append(function(){return new m({style:h})}).attr("className",function(S){var E=S.type;return"".concat(Vi.handle," ").concat(b.getHandleClassName(E))}).each(function(S){var E=S.type,w=S.value;this.update({labelText:w});var M="".concat(E,"Handle");b[M]=this,this.addEventListener("pointerdown",b.onDragStart(E))})},function(x){return x.update(h).each(function(S){var E=S.value;this.update({labelText:E})})},function(x){return x.each(function(S){var E=S.type,w="".concat(E,"Handle");b[w]=void 0}).remove()})},e.prototype.adjustHandles=function(){var n=(0,T.CR)(this.selection,2),r=n[0],o=n[1];this.setHandlePosition("start",r),this.setHandlePosition("end",o)},Object.defineProperty(e.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new Hn(0,0,0,0);var n=this.startHandle.getBBox(),r=n.width,o=n.height,c=this.endHandle.getBBox(),l=c.width,u=c.height,d=(0,T.CR)([Math.max(r,l),Math.max(o,u)],2),h=d[0],p=d[1];return this.cacheHandleBBox=new Hn(0,0,h,p),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"handleShape",{get:function(){var n=this.handleBBox,r=n.width,o=n.height,c=(0,T.CR)(this.ifHorizontal([o,r],[r,o]),2),l=c[0],u=c[1];return{width:r,height:o,size:l,length:u}},enumerable:!1,configurable:!0}),e.prototype.setHandlePosition=function(n,r){var o=this.attributes.handleFormatter,c=this.ribbonBBox,l=c.x,u=c.y,d=this.ribbonShape.size,h=this.getOffset(r),p=(0,T.CR)(this.ifHorizontal([l+h,u+d*this.handleOffsetRatio],[l+d*this.handleOffsetRatio,u+h]),2),v=p[0],m=p[1],b=this.handlesGroup.select(".".concat(this.getHandleClassName(n))).node();b==null||b.update({transform:"translate(".concat(v,", ").concat(m,")"),formatter:o})},e.prototype.renderIndicator=function(n){var r=or(this.attributes,"indicator");this.indicator=n.maybeAppendByClassName(Vi.indicator,function(){return new nu({})}).update(r)},Object.defineProperty(e.prototype,"labelData",{get:function(){var n=this,r=this.attributes.data;return r.reduce(function(o,c,l,u){var d,h,p=(d=c==null?void 0:c.id)!==null&&d!==void 0?d:l.toString();if(o.push((0,T.pi)((0,T.pi)({},c),{id:p,index:l,type:"value",label:(h=c==null?void 0:c.label)!==null&&h!==void 0?h:c.value.toString(),value:n.ribbonScale.map(c.value)})),l<u.length-1){var v=u[l+1],m=(0,T.CR)([c.value,v.value],2),b=m[0],x=m[1],S=(b+x)/2;o.push((0,T.pi)((0,T.pi)({},c),{id:p,index:l,type:"range",range:[b,x],label:[b,x].join("~"),value:n.ribbonScale.map(S)}))}return o},[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){var n=(0,T.CR)(["center","middle"],2),r=n[0],o=n[1],c=this.labelPosition;return c==="top"?o="bottom":c==="bottom"?o="top":c==="left"?r="end":c==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:o}},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(n){var r=this.attributes,o=r.showTick,c=o===void 0?!1:o,l=r.labelFilter,u=r.labelFormatter,d=or(this.attributes,"tick"),h=or(this.attributes,"label"),p=h.align,v=ea((0,T.pi)({showLine:!1,showGrid:!1,showTick:c,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),na(d,"tick"),na(h,"label"),{data:this.labelData}),m={tickFilter:function(x,S,E){return(x==null?void 0:x.type)!=="value"?!1:l?l(x,x.index,E.filter(function(w){return w.type!=="value"})):!0},labelFilter:function(x,S,E){return(x==null?void 0:x.type)!==p?!1:l?l(x,x.index,E.filter(function(w){return w.type===p})):!0},labelFormatter:u},b=(0,T.pi)((0,T.pi)((0,T.pi)({},v),m),{labelOverlap:[{type:"hide"}]});this.label=n.maybeAppendByClassName(Vi.label,function(){return new jp({style:b})}).node(),this.label.update(b,!1)},Object.defineProperty(e.prototype,"labelAxisStyle",{get:function(){var n=this.attributes,r=n.showTick,o=n.labelDirection,c=n.labelSpacing,l=n.tickLength,u=this.ribbonShape.size,d=this.labelPosition,h=this.labelFixedSpacing,p=(0,T.CR)([0,0,0],3),v=p[0],m=p[1],b=p[2],x=l!=null?l:u;return r?(b=x,m=h,o==="positive"?d==="right"?(v=x,b=x):d==="bottom"&&(v=b):o==="negative"&&(d==="top"||d==="left")&&(v=u)):o==="positive"?d==="right"?m=x:d==="bottom"&&(v=u+h,m=c):o==="negative"&&(d==="left"||d==="top")&&(m=c),{offset:v,spacing:m,tickLength:b}},enumerable:!1,configurable:!0}),e.prototype.adjustLabel=function(){var n=this.attributes.showLabel;if(n){var r=this.ribbonBBox,o=r.x,c=r.y,l=r.width,u=r.height,d=this.labelAxisStyle,h=d.offset,p=d.spacing,v=d.tickLength,m=(0,T.CR)(this.ifHorizontal([[o,c+h],[o+l,c+h]],[[o+h,c+u],[o+h,c]]),2),b=m[0],x=m[1];this.label.update({startPos:b,endPos:x,tickLength:v,labelSpacing:p},!1)}},e.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},e.prototype.showIndicator=function(n,r){r===void 0&&(r="".concat(n));var o=this.attributes.showIndicator;if(!o||typeof n!="number"){this.hideIndicator();return}var c=this.range,l=c.min,u=c.max,d=this.ribbonBBox,h=d.x,p=d.y,v=(0,ce.Z)(n,l,u),m=this.getOffset(v),b=this.ifHorizontal([m+h,p],[h,m+p]);this.indicator.update({x:b[0],y:b[1],position:this.ifHorizontal("top","left"),labelText:r}),kl(this.indicator.node())},e.prototype.hideIndicator=function(){Po(this.indicator.node())},e.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},e.prototype.setSelection=function(n,r){this.updateSelection(n,r)},e.prototype.updateSelection=function(n,r,o){var c;o===void 0&&(o=!1);var l=(0,T.CR)(this.selection,2),u=l[0],d=l[1],h=(0,T.CR)([n,r],2),p=h[0],v=h[1];o&&(p+=u,v+=d);var m=this.range,b=m.min,x=m.max;c=(0,T.CR)(Nw([b,x],[p,v],this.selection),2),p=c[0],v=c[1],this.update({defaultValue:[p,v]}),this.dispatchSelection()},Object.defineProperty(e.prototype,"step",{get:function(){var n=this.attributes.step,r=n===void 0?1:n,o=this.range,c=o.min,l=o.max;return(0,Hf.Z)(r)?tu((l-c)*zw,0):r},enumerable:!1,configurable:!0}),e.prototype.getTickValue=function(n){var r=this.attributes,o=r.data,c=r.block,l=this.range.min;return c?H1(o.map(function(u){var d=u.value;return d}),n).tick:F1(n,this.step,l)},e.prototype.getValueByCanvasPoint=function(n){var r=this.range,o=r.min,c=r.max,l=(0,T.CR)(this.ribbon.node().getPosition(),2),u=l[0],d=l[1],h=this.ifHorizontal(u,d),p=this.ifHorizontal.apply(this,(0,T.ev)([],(0,T.CR)(rs(n)),!1)),v=p-h,m=(0,ce.Z)(this.getOffset(v,!0),o,c);return m},e.prototype.getOffset=function(n,r){r===void 0&&(r=!1);var o=this.range,c=o.min,l=o.max,u=this.ribbonShape.length,d=this.eventToOffsetScale;return d.update({domain:[c,l],range:[0,u]}),r?d.invert(n):d.map(n)},e.prototype.getRealSelection=function(n){var r=this.range.max,o=(0,T.CR)(n,2),c=o[0],l=o[1];return this.ifHorizontal([c,l],[r-l,r-c])},e.prototype.getRealValue=function(n){var r=this.range.max;return this.ifHorizontal(n,r-n)},e.prototype.dispatchSelection=function(){var n=this.getRealSelection(this.selection),r=new F.Aw("valuechange",{detail:{value:n}});this.dispatchEvent(r)},e.prototype.dispatchIndicated=function(n,r){var o=this,c=this.range.max,l=this.ifHorizontal(function(){return{value:n,range:r}},function(){return{value:c-n,range:r?o.getRealSelection(r):void 0}}),u=new F.Aw("indicate",{detail:l});this.dispatchEvent(u)},e}(Ni);class au extends $l{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:Bs}}map(e){const[n]=this.options.range;return n!==void 0?n:this.options.unknown}invert(e){const[n]=this.options.range;return e===n&&n!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:e,domain:n,tickCount:r}=this.options,[o,c]=n;return!(0,ne.Z)(o)||!(0,ne.Z)(c)?[]:e(o,c,r)}clone(){return new au(this.options)}}class kc extends $l{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(e){super(e)}map(e){if(!Ja(e))return this.options.unknown;const n=Zf(this.thresholds,e,0,this.n);return this.options.range[n]}invert(e){const{range:n}=this.options,r=n.indexOf(e),o=this.thresholds;return[o[r-1],o[r]]}clone(){return new kc(this.options)}rescale(){const{domain:e,range:n}=this.options;this.n=Math.min(e.length,n.length-1),this.thresholds=e}}function su(t){return(0,fe.Z)(t)?0:Ec(t)?t.length:Object.keys(t).length}var Kw=function(t,e){if(!Ec(t))return-1;var n=Array.prototype.indexOf;if(n)return n.call(t,e);for(var r=-1,o=0;o<t.length;o++)if(t[o]===e){r=o;break}return r},G1=Kw;function cu(t){return Math.abs(t)<1e-14?t:parseFloat(t.toFixed(14))}const Qw=[1,5,2,2.5,4,3],UL=null,Y1=Number.EPSILON*100;function Jw(t,e){return(t%e+e)%e}function $1(t){return Math.round(t*1e12)/1e12}function tA(t,e,n,r,o,c){const l=su(e),u=G1(e,t);let d=0;const h=Jw(r,c);return(h<Y1||c-h<Y1)&&r<=0&&o>=0&&(d=1),1-u/(l-1)-n+d}function eA(t,e,n){const r=su(e);return 1-G1(e,t)/(r-1)-n+1}function lu(t,e,n,r,o,c){const l=(t-1)/(c-o),u=(e-1)/(Math.max(c,r)-Math.min(n,o));return 2-Math.max(l/u,u/l)}function Kf(t,e){return t>=e?2-(t-1)/(e-1):1}function Wi(t,e,n,r){const o=e-t;return 1-.5*(Ri(e-r,2)+Ri(t-n,2))/Ri(.1*o,2)}function X1(t,e,n){const r=e-t;if(n>r){const o=(n-r)/2;return 1-Ri(o,2)/Ri(.1*r,2)}return 1}function nA(){return 1}const o0=(t,e,n=5,r=!0,o=Qw,c=[.25,.2,.5,.05])=>{const l=n<0?0:Math.round(n);if(Number.isNaN(t)||Number.isNaN(e)||typeof t!="number"||typeof e!="number"||!l)return[];if(e-t<1e-15||l===1)return[t];const u={score:-2,lmin:0,lmax:0,lstep:0};let d=1;for(;d<1/0;){for(let x=0;x<o.length;x+=1){const S=o[x],E=eA(S,o,d);if(c[0]*E+c[1]+c[2]+c[3]<u.score){d=1/0;break}let w=2;for(;w<1/0;){const M=Kf(w,l);if(c[0]*E+c[1]+c[2]*M+c[3]<u.score)break;const L=(e-t)/(w+1)/d/S;let I=Math.ceil(Math.log10(L));for(;I<1/0;){const R=d*S*Ri(10,I),z=X1(t,e,R*(w-1));if(c[0]*E+c[1]*z+c[2]*M+c[3]<u.score)break;const W=Math.floor(e/R)*d-(w-1)*d,Y=Math.ceil(t/R)*d;if(W<=Y){const st=Y-W;for(let xt=0;xt<=st;xt+=1){const Ht=(W+xt)*(R/d),dt=Ht+R*(w-1),Ot=R,bt=tA(S,o,d,Ht,dt,Ot),wt=Wi(t,e,Ht,dt),oe=lu(w,l,t,e,Ht,dt),Ut=nA(),Kt=c[0]*bt+c[1]*wt+c[2]*oe+c[3]*Ut;Kt>u.score&&(!r||Ht<=t&&dt>=e)&&(u.lmin=Ht,u.lmax=dt,u.lstep=Ot,u.score=Kt)}}I+=1}w+=1}}d+=1}const h=cu(u.lmax),p=cu(u.lmin),v=cu(u.lstep),m=Math.floor($1((h-p)/v))+1,b=new Array(m);b[0]=cu(p);for(let x=1;x<m;x+=1)b[x]=cu(b[x-1]+v);return b};class Qf extends kc{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:o0}}constructor(e){super(e)}nice(){const{nice:e}=this.options;if(e){const[n,r,o]=this.getTickMethodOptions();this.options.domain=d1(n,r,o)}}getTicks(){const{tickMethod:e}=this.options,[n,r,o]=this.getTickMethodOptions();return e(n,r,o)}getTickMethodOptions(){const{domain:e,tickCount:n}=this.options,r=e[0],o=e[e.length-1];return[r,o,n]}rescale(){this.nice();const{range:e,domain:n}=this.options,[r,o]=n;this.n=e.length-1,this.thresholds=new Array(this.n);for(let c=0;c<this.n;c+=1)this.thresholds[c]=((c+1)*o-(c-this.n)*r)/(this.n+1)}invert(e){const[n,r]=super.invert(e),[o,c]=this.options.domain;return n===void 0&&r===void 0?[n,r]:[n||o,r||c]}getThresholds(){return this.thresholds}clone(){return new Qf(this.options)}}function rA(t,e){const n=t.length;if(!n)return;if(n<2)return t[n-1];const r=(n-1)*e,o=Math.floor(r),c=t[o],l=t[o+1];return c+(l-c)*(r-o)}function q1(t,e,n=!1){const r=t;n||r.sort((c,l)=>c-l);const o=[];for(let c=1;c<e;c+=1)o.push(rA(r,c/e));return o}class Jf extends kc{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:o0}}constructor(e){super(e)}rescale(){const{domain:e,range:n}=this.options;this.n=n.length-1,this.thresholds=q1(e,this.n+1,!1)}invert(e){const[n,r]=super.invert(e),{domain:o}=this.options,c=o[0],l=o[o.length-1];return n===void 0&&r===void 0?[n,r]:[n||c,r||l]}getThresholds(){return this.thresholds}clone(){return new Jf(this.options)}getTicks(){const{tickCount:e,domain:n,tickMethod:r}=this.options,o=n.length-1,c=n[0],l=n[o];return r(c,l,e)}}var iA=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function oA(t,e,n){return t.size=e,ia(n)?t.height=e:t.width=e,t}function K1(t,e,n){const{size:r}=e,o=_1(t,e,n);return oA(o,r,o.orientation)}function aA(t){return e=>({value:e/t,label:String(e)})}function sA(t,e,n,r,o){const c=e.thresholds,l=aA(r);return Object.assign(Object.assign({},t),{color:o,data:[n,...c,r].map(l)})}function Q1(t,e,n){const o=[-1/0,...e.thresholds,1/0].map((c,l)=>({value:l,label:c}));return Object.assign(Object.assign({},t),{data:o,color:n,labelFilter:(c,l)=>l>0&&l<o.length-1})}function td(t){const{domain:e}=t.getOptions(),[n,r]=[e[0],yy(e)];return[n,r]}function J1(t,e){const n=t.getOptions(),r=t.clone();return r.update(Object.assign(Object.assign({},n),{range:[(0,F.lu)(e).toString()]})),r}function tb(t,e,n,r,o,c){const{length:l}=t,u=n||r,d=o.color?c.legendContinuous.ribbonFill||"black":c.color,h=e||J1(u,d),[p,v]=td(h),[m,b]=td([e,n,r].filter(x=>x!==void 0).find(x=>!(x instanceof au)));return Object.assign(Object.assign({},t),{domain:[m,b],data:h.getTicks().map(x=>({value:x})),color:new Array(Math.floor(l)).fill(0).map((x,S)=>{const E=(v-p)/(l-1)*S+p,w=h.map(E)||d,M=r?r.map(E):1;return w.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(L,I,R,z)=>`rgba(${I}, ${R}, ${z}, ${M})`)})})}function cA(t,e,n,r,o,c){const l=ra(t,"color"),u=K1(n,r,o);if(l instanceof kc){const{range:p}=l.getOptions(),[v,m]=td(l);return l instanceof Qf||l instanceof Jf?sA(u,l,v,m,p):Q1(u,l,p)}const d=ra(t,"size"),h=ra(t,"opacity");return tb(u,l,d,h,e,c)}const is=t=>{const{labelFormatter:e,layout:n,order:r,orientation:o,position:c,size:l,title:u,style:d,crossPadding:h,padding:p}=t,v=iA(t,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:m,value:b,theme:x,scale:S})=>{const{bbox:E}=b,{x:w,y:M,width:L,height:I}=E,R=m1(c,n),{legendContinuous:z={}}=x,W=Gf(Object.assign({},z,Object.assign(Object.assign({titleText:es(u),labelAlign:"value",labelFormatter:typeof e=="string"?st=>Xa(e)(st.label):e},cA(m,S,b,t,is,x)),d),v)),Y=new y1({style:Object.assign(Object.assign({x:w,y:M,width:L,height:I},R),{subOptions:W})});return Y.appendChild(new qw({className:"legend-continuous",style:W})),Y}};is.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]};const eb=t=>(...e)=>is(Object.assign({},{block:!0},t))(...e);eb.props=Object.assign(Object.assign({},is.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const a0=t=>e=>{const{scales:n}=e,r=ra(n,"size");return is(Object.assign({},{type:"size",data:r.getTicks().map((o,c)=>({value:o,label:String(o)}))},t))(e)};a0.props=Object.assign(Object.assign({},is.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const nb=t=>a0(Object.assign({},{block:!0},t));nb.props=Object.assign(Object.assign({},is.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var rb=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ib=({static:t=!1}={})=>e=>{const{width:n,height:r,depth:o,paddingLeft:c,paddingRight:l,paddingTop:u,paddingBottom:d,padding:h,inset:p,insetLeft:v,insetTop:m,insetRight:b,insetBottom:x,margin:S,marginLeft:E,marginBottom:w,marginTop:M,marginRight:L,data:I,coordinate:R,theme:z,component:W,interaction:Y,x:st,y:xt,z:Nt,key:Ht,frame:dt,labelTransform:Ot,parentKey:bt,clip:wt,viewStyle:oe,title:Ut}=e,Kt=rb(e,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:st,y:xt,z:Nt,key:Ht,width:n,height:r,depth:o,padding:h,paddingLeft:c,paddingRight:l,paddingTop:u,inset:p,insetLeft:v,insetTop:m,insetRight:b,insetBottom:x,paddingBottom:d,theme:z,coordinate:R,component:W,interaction:Y,frame:dt,labelTransform:Ot,margin:S,marginLeft:E,marginBottom:w,marginTop:M,marginRight:L,parentKey:bt,clip:wt,style:oe},!t&&{title:Ut}),{marks:[Object.assign(Object.assign(Object.assign({},Kt),{key:`${Ht}-0`,data:I}),t&&{title:Ut})]})]};ib.props={};var lA=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Dc(t){return(e,...n)=>en({},t(e,...n),e)}function sa(t){return(e,...n)=>en({},e,t(e,...n))}function ob(t){return t instanceof Date?!1:typeof t=="object"}function ed(t,e){if(!t)return e;if(Array.isArray(t))return t;if(ob(t)){const{value:n=e}=t,r=lA(t,["value"]);return Object.assign(Object.assign({},r),{value:n})}return t}var s0=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const c0=()=>t=>{const{children:e}=t,n=s0(t,["children"]);if(!Array.isArray(e))return[];const{data:r,scale:o={},axis:c={},legend:l={},encode:u={},transform:d=[]}=n,h=s0(n,["data","scale","axis","legend","encode","transform"]),p=e.map(v=>{var{data:m,scale:b={},axis:x={},legend:S={},encode:E={},transform:w=[]}=v,M=s0(v,["data","scale","axis","legend","encode","transform"]);return Object.assign({data:ed(m,r),scale:en({},o,b),encode:en({},u,E),transform:[...d,...w],axis:x&&c?en({},c,x):!1,legend:S&&l?en({},l,S):!1},M)});return[Object.assign(Object.assign({},h),{marks:p,type:"standardView"})]};c0.props={};function oi([t,e],[n,r]){return[t-n,e-r]}function nd([t,e],[n,r]){return[t+n,e+r]}function ai([t,e],[n,r]){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))}function Ro([t,e]){return Math.atan2(e,t)}function js([t,e]){return Ro([t,e])+Math.PI/2}function ab(t,e){const n=Ro(t),r=Ro(e);return n<r?r-n:Math.PI*2-(n-r)}function l0(t){let e=1/0,n=-1/0,r=1/0,o=-1/0;for(const[u,d]of t)e=Math.min(u,e),n=Math.max(u,n),r=Math.min(d,r),o=Math.max(d,o);const c=n-e,l=o-r;return[e,r,c,l]}function u0([t,e],[n,r]){return[(t+n)/2,(e+r)/2]}function Fn(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function uA(t,e){return e.forEach((n,r)=>r===0?t.moveTo(n[0],n[1]):t.lineTo(n[0],n[1])),t.closePath(),t}function fA(t,e,n){const{arrowSize:r}=n,o=typeof r=="string"?+parseFloat(r)/100*ai(t,e):r,c=Math.PI/6,l=Math.atan2(e[1]-t[1],e[0]-t[0]),u=Math.PI/2-l-c,d=[e[0]-o*Math.sin(u),e[1]-o*Math.cos(u)],h=l-c,p=[e[0]-o*Math.cos(h),e[1]-o*Math.sin(h)];return[d,p]}function rd(t,e,n,r,o){const c=Ro(oi(r,e))+Math.PI,l=Ro(oi(r,n))+Math.PI;return t.arc(r[0],r[1],o,c,l,l-c<0),t}function sb(t,e,n,r="y",o="between",c=!1){const l=(E,w)=>E==="y"||E===!0?w?180:90:w?90:0,u=r==="y"||r===!0?n:e,d=l(r,c),h=Cs(u),[p,v]=Ma(h,E=>u[E]),m=new qi({domain:[p,v],range:[0,100]}),b=E=>(0,ne.Z)(u[E])&&!Number.isNaN(u[E])?m.map(u[E]):0,x={between:E=>`${t[E]} ${b(E)}%`,start:E=>E===0?`${t[E]} ${b(E)}%`:`${t[E-1]} ${b(E)}%, ${t[E]} ${b(E)}%`,end:E=>E===t.length-1?`${t[E]} ${b(E)}%`:`${t[E]} ${b(E)}%, ${t[E+1]} ${b(E)}%`},S=h.sort((E,w)=>b(E)-b(w)).map(x[o]||x.between).join(",");return`linear-gradient(${d}deg, ${S})`}function id(t){const[e,n,r,o]=t;return[o,e,n,r]}function zs(t,e,n){const[r,o,,c]=Yr(t)?id(e):e,[l,u]=n,d=t.getCenter(),h=js(oi(r,d)),p=js(oi(o,d)),v=p===h&&l!==u?p+Math.PI*2:p;return{startAngle:h,endAngle:v-h>=0?v:Math.PI*2+v,innerRadius:ai(c,d),outerRadius:ai(r,d)}}function ZL(t){const e="connect";return Object.fromEntries(Object.entries(t).filter(([n])=>n.startsWith(e)).map(([n,r])=>[lowerFirst(n.replace(e,"").trim()),r]).filter(([n])=>n!==void 0))}function f0(t){const{colorAttribute:e,opacityAttribute:n=e}=t;return`${n}Opacity`}function uu(t,e){if(!Pr(t))return"";const n=t.getCenter(),{transform:r}=e;return`translate(${n[0]}, ${n[1]}) ${r||""}`}function od(t){if(t.length===1)return t[0];const[[e,n,r=0],[o,c,l=0]]=t;return[(e+o)/2,(n+c)/2,(r+l)/2]}function d0(t){return t.replace(/-(\w)/g,function(e,n){return n.toUpperCase()})}function cb(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}var HL=Array.prototype.slice;function lb(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function qr(t){return function(){return t}}function ub(t){this._context=t}ub.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function fu(t){return new ub(t)}const h0=Math.PI,p0=2*h0,ca=1e-6,fb=p0-ca;function g0(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function db(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return g0;const n=Ri(10,e);return function(r){this._+=r[0];for(let o=1,c=r.length;o<c;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}class ad{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?g0:db(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,o){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(e,n,r,o,c,l){this._append`C${+e},${+n},${+r},${+o},${this._x1=+c},${this._y1=+l}`}arcTo(e,n,r,o,c){if(e=+e,n=+n,r=+r,o=+o,c=+c,c<0)throw new Error(`negative radius: ${c}`);let l=this._x1,u=this._y1,d=r-e,h=o-n,p=l-e,v=u-n,m=p*p+v*v;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(m>ca)if(!(Math.abs(v*d-h*p)>ca)||!c)this._append`L${this._x1=e},${this._y1=n}`;else{let b=r-l,x=o-u,S=d*d+h*h,E=b*b+x*x,w=Math.sqrt(S),M=Math.sqrt(m),L=c*Math.tan((h0-Math.acos((S+m-E)/(2*w*M)))/2),I=L/M,R=L/w;Math.abs(I-1)>ca&&this._append`L${e+I*p},${n+I*v}`,this._append`A${c},${c},0,0,${+(v*b>p*x)},${this._x1=e+R*d},${this._y1=n+R*h}`}}arc(e,n,r,o,c,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(o),d=r*Math.sin(o),h=e+u,p=n+d,v=1^l,m=l?o-c:c-o;this._x1===null?this._append`M${h},${p}`:(Math.abs(this._x1-h)>ca||Math.abs(this._y1-p)>ca)&&this._append`L${h},${p}`,r&&(m<0&&(m=m%p0+p0),m>fb?this._append`A${r},${r},0,1,${v},${e-u},${n-d}A${r},${r},0,1,${v},${this._x1=h},${this._y1=p}`:m>ca&&this._append`A${r},${r},0,${+(m>=h0)},${v},${this._x1=e+r*Math.cos(c)},${this._y1=n+r*Math.sin(c)}`)}rect(e,n,r,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function ko(){return new ad}ko.prototype=ad.prototype;function VL(t=3){return new ad(+t)}function v0(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new ad(e)}function hb(t){return t[0]}function pb(t){return t[1]}function Us(t,e){var n=qr(!0),r=null,o=fu,c=null,l=v0(u);t=typeof t=="function"?t:t===void 0?hb:qr(t),e=typeof e=="function"?e:e===void 0?pb:qr(e);function u(d){var h,p=(d=lb(d)).length,v,m=!1,b;for(r==null&&(c=o(b=l())),h=0;h<=p;++h)!(h<p&&n(v=d[h],h,d))===m&&((m=!m)?c.lineStart():c.lineEnd()),m&&c.point(+t(v,h,d),+e(v,h,d));if(b)return c=null,b+""||null}return u.x=function(d){return arguments.length?(t=typeof d=="function"?d:qr(+d),u):t},u.y=function(d){return arguments.length?(e=typeof d=="function"?d:qr(+d),u):e},u.defined=function(d){return arguments.length?(n=typeof d=="function"?d:qr(!!d),u):n},u.curve=function(d){return arguments.length?(o=d,r!=null&&(c=o(r)),u):o},u.context=function(d){return arguments.length?(d==null?r=c=null:c=o(r=d),u):r},u}function Pa(t){const e=typeof t=="function"?t:t.render;return class extends F.b_{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){e(this)}}}var sd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function gb(t){const{min:[e,n],max:[r,o]}=t.getLocalBounds();let c=0,l=0;return e>0&&(c=e),r<0&&(c=r),n>0&&(l=n),o<0&&(l=o),[c,l]}function vb(t,e=[]){const[n=0,r=0,o=n,c=r]=e,l=t.parentNode,u=l.getEulerAngles();l.setEulerAngles(0);const{min:d,halfExtents:h}=t.getLocalBounds(),[p,v]=d,[m,b]=h;return l.setEulerAngles(u),{x:p-c,y:v-n,width:m*2+c+r,height:b*2+n+o}}const WL=(t,e,n)=>{const r=dist(t,e),o=dist(e,n),c=dist(n,t);return(Math.pow(r,2)+Math.pow(o,2)-Math.pow(c,2))/(2*r*o)};function dA(t,e,n,r,o=!0,c=!0){const l=v=>Us()(v);if(!e[0]&&!e[1])return l([gb(t),e]);if(!n.length)return l([[0,0],e]);const[u,d]=n,h=[...d],p=[...u];if(d[0]!==u[0]){const v=o?-4:4;h[1]=d[1],c&&!o&&(h[0]=Math.max(u[0],d[0]-v),d[1]<u[1]?p[1]=h[1]:(p[1]=u[1],p[0]=Math.max(p[0],h[0]-v))),!c&&!o&&(h[0]=Math.max(u[0],d[0]-v),d[1]>u[1]?p[1]=h[1]:(p[1]=u[1],p[0]=Math.max(p[0],h[0]-v))),!c&&o&&(h[0]=Math.min(u[0],d[0]-v),d[1]>u[1]?p[1]=h[1]:(p[1]=u[1],p[0]=Math.min(p[0],h[0]-v))),c&&o&&(h[0]=Math.min(u[0],d[0]-v),d[1]<u[1]?p[1]=h[1]:(p[1]=u[1],p[0]=Math.min(p[0],h[0]-v)))}return l([d,h,p,u,e])}const mb=Pa(t=>{const e=t.attributes,{className:n,class:r,transform:o,rotate:c,labelTransform:l,labelTransformOrigin:u,x:d,y:h,x0:p=d,y0:v=h,text:m,background:b,connector:x,startMarker:S,endMarker:E,coordCenter:w,innerHTML:M}=e,L=sd(e,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(t.style.transform=`translate(${d}, ${h})`,[d,h,p,v].some(Ut=>!(0,ne.Z)(Ut))){t.children.forEach(Ut=>Ut.remove());return}const I=bn(L,"background"),{padding:R}=I,z=sd(I,["padding"]),W=bn(L,"connector"),{points:Y=[]}=W,st=sd(W,["points"]);let xt;M?xt=Wn(t).maybeAppend("html","html",n).style("zIndex",0).style("innerHTML",M).call(Fn,Object.assign({transform:l,transformOrigin:u},L)).node():xt=Wn(t).maybeAppend("text","text").style("zIndex",0).style("text",m).call(Fn,Object.assign({textBaseline:"middle",transform:l,transformOrigin:u},L)).node();const Nt=Wn(t).maybeAppend("background","rect").style("zIndex",-1).call(Fn,vb(xt,R)).call(Fn,b?z:{}).node(),Ht=+p<w[0],dt=+v<w[1],Ot=[+p-+d,+v-+h],bt=dA(Nt,Ot,Y,w,Ht,dt),wt=S&&new wr({id:"startMarker",style:Object.assign({x:0,y:0},bn(L,"startMarker"))}),oe=E&&new wr({id:"endMarker",style:Object.assign({x:0,y:0},bn(L,"endMarker"))});Wn(t).maybeAppend("connector","path").style("zIndex",0).style("d",bt).style("markerStart",wt).style("markerEnd",oe).call(Fn,x?st:{})});function Fc(t,e){let n,r=-1,o=-1;if(e===void 0)for(const c of t)++o,c!=null&&(n<c||n===void 0&&c>=c)&&(n=c,r=o);else for(let c of t)(c=e(c,++o,t))!=null&&(n<c||n===void 0&&c>=c)&&(n=c,r=o);return r}function hA(t,e,n,r){const o=e.length/2,c=e.slice(0,o),l=e.slice(o);let u=Fc(c,(b,x)=>Math.abs(b[1]-l[x][1]));u=Math.max(Math.min(u,o-2),1);const d=b=>[c[b][0],(c[b][1]+l[b][1])/2],h=d(u),p=d(u-1),v=d(u+1),m=Ro(oi(v,p))/Math.PI*180;return{x:h[0],y:h[1],transform:`rotate(${m})`,textAlign:"center",textBaseline:"middle"}}function yb(t,e,n,r){const{bounds:o}=n,[[c,l],[u,d]]=o,h=u-c,p=d-l,v=m=>{const{x:b,y:x}=m,S=sp(n.x,h),E=sp(n.y,p);return Object.assign(Object.assign({},m),{x:(S||b)+c,y:(E||x)+l})};return v(t==="left"?{x:0,y:p/2,textAlign:"start",textBaseline:"middle"}:t==="right"?{x:h,y:p/2,textAlign:"end",textBaseline:"middle"}:t==="top"?{x:h/2,y:0,textAlign:"center",textBaseline:"top"}:t==="bottom"?{x:h/2,y:p,textAlign:"center",textBaseline:"bottom"}:t==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:t==="top-right"?{x:h,y:0,textAlign:"end",textBaseline:"top"}:t==="bottom-left"?{x:0,y:p,textAlign:"start",textBaseline:"bottom"}:t==="bottom-right"?{x:h,y:p,textAlign:"end",textBaseline:"bottom"}:{x:h/2,y:p/2,textAlign:"center",textBaseline:"middle"})}function bb(t,e,n,r){const{y:o,y1:c,autoRotate:l,rotateToAlignArc:u}=n,d=r.getCenter(),h=zs(r,e,[o,c]),{innerRadius:p,outerRadius:v,startAngle:m,endAngle:b}=h,x=t==="inside"?(m+b)/2:b,S=m0(x,l,u),E=(()=>{const[w,M]=e,L=p+(v-p)*.5,[I,R]=t==="inside"?Nc(d,x,L):u0(w,M);return{x:I,y:R}})();return Object.assign(Object.assign({},E),{textAlign:t==="inside"?"center":"start",textBaseline:"middle",rotate:S})}function Nc(t,e,n){return[t[0]+Math.sin(e)*n,t[1]-Math.cos(e)*n]}function m0(t,e,n){if(!e)return 0;const r=n?0:Math.sin(t)<0?90:-90;return t/Math.PI*180+r}function pA(t,e,n,r){const{y:o,y1:c,autoRotate:l,rotateToAlignArc:u,radius:d=.5,offset:h=0}=n,p=zs(r,e,[o,c]),{startAngle:v,endAngle:m}=p,b=r.getCenter(),x=(v+m)/2,E={textAlign:"center",textBaseline:"middle",rotate:m0(x,l,u)},{innerRadius:w,outerRadius:M}=p,I=w+(M-w)*d+h,[R,z]=Nc(b,x,I);return Object.assign({x:R,y:z},E)}function y0(t){return t===void 0?null:t}function b0(t,e,n,r){const{bounds:o}=n,[c]=o;return{x:y0(c[0]),y:y0(c[1])}}function Ia(t,e,n,r){const{bounds:o}=n;return o.length===1?b0(t,e,n,r):(Il(r)?bb:wc(r)?pA:yb)(t,e,n,r)}function gA(t,e,n,r,o){const[c,l]=Nc(t,e,n),[u,d]=Nc(t,e,r),h=Math.sin(e)>0?1:-1;return[[c,l],[u,d],[u+h*o,d]]}function _b(t,e,n){const r=zs(n,t,[e.y,e.y1]),{innerRadius:o,outerRadius:c}=r;return o+(c-o)}function xb(t,e,n){const r=zs(n,t,[e.y,e.y1]),{startAngle:o,endAngle:c}=r;return(o+c)/2}function _0(t,e,n,r){const{autoRotate:o,rotateToAlignArc:c,offset:l=0,connector:u=!0,connectorLength:d=l,connectorLength2:h=0,connectorDistance:p=0}=n,v=r.getCenter(),m=xb(e,n,r),b=Math.sin(m)>0?1:-1,x=m0(m,o,c),S={textAlign:b>0||Il(r)?"start":"end",textBaseline:"middle",rotate:x},E=_b(e,n,r),w=E+(u?d:l),[[M,L],[I,R],[z,W]]=gA(v,m,E,w,u?h:0),Y=u?+p*b:0,st=z+Y,xt=W,Nt={connector:u,connectorPoints:[[I-st,R-xt],[z-st,W-xt]]};return Object.assign(Object.assign({x0:M,y0:L,x:z+Y,y:W},S),Nt)}function vA(t,e,n,r){const{bounds:o}=n;return o.length===1?b0(t,e,n,r):(Il(r)?bb:wc(r)?_0:yb)(t,e,n,r)}function ci(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mA(t,e){return Array.from(e,n=>t[n])}function Do(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const r=Uint32Array.from(t,(o,c)=>c);return e.length>1?(e=e.map(o=>t.map(o)),r.sort((o,c)=>{for(const l of e){const u=du(l[o],l[c]);if(u)return u}})):(n=t.map(n),r.sort((o,c)=>du(n[o],n[c]))),mA(t,r)}return t.sort(Sb(n))}function Sb(t=ci){if(t===ci)return du;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function du(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function x0(t,e={}){const{labelHeight:n=14,height:r}=e,o=Do(t,h=>h.y),c=o.length,l=new Array(c);for(let h=0;h<c;h++){const p=o[h],{y:v}=p;l[h]={y:v,y1:v+n,labels:[v]}}let u=!0;for(;u;){u=!1;for(let h=l.length-1;h>0;h--){const p=l[h],v=l[h-1];if(v.y1>p.y){u=!0,v.labels.push(...p.labels),l.splice(h,1),v.y1+=p.y1-p.y;const m=v.y1-v.y;v.y1=Math.max(Math.min(v.y1,r),m),v.y=v.y1-m}}}let d=0;for(const h of l){const{y:p,labels:v}=h;let m=p-n;for(const b of v){const x=o[d++],E=m+n-b;x.connectorPoints[0][1]-=E,x.y=m+n,m+=n}}}function S0(t,e){const n=Do(t,u=>u.y),{height:r,labelHeight:o=14}=e,c=Math.ceil(r/o);if(n.length<=c)return x0(n,e);const l=[];for(let u=0;u<n.length;u++)u<n.length-c?(n[u].opacity=0,n[u].connector=!1):l.push(n[u]);x0(l,e)}var Ob=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const cd=new WeakMap;function yA(t,e,n){const{connectorLength:r,connectorLength2:o,connectorDistance:c}=e,l=Ob(_0("outside",t,e,n),[]),u=n.getCenter(),d=_b(t,e,n),h=xb(t,e,n),p=d+r+o,v=Math.sin(h)>0?1:-1,m=u[0]+(p+ +c)*v,{x:b}=l,x=m-b;return l.x+=x,l.connectorPoints[0][0]-=x,l}function bA(t,e,n,r,o,c){if(!wc(r))return{};if(cd.has(e))return cd.get(e);const l=c.map(m=>yA(m,n,r)),{width:u,height:d}=r.getOptions(),h=l.filter(m=>m.x<u/2),p=l.filter(m=>m.x>=u/2),v=Object.assign(Object.assign({},o),{height:d});return S0(h,v),S0(p,v),l.forEach((m,b)=>cd.set(c[b],m)),cd.get(e)}var Eb=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function _A(t,e,n,r){if(!wc(r))return{};const{connectorLength:o,connectorLength2:c,connectorDistance:l}=n,u=Eb(_0("outside",e,n,r),[]),{x0:d,y0:h}=u,p=r.getCenter(),m=hE(r)+o,b=js([d-p[0],h-p[1]]),x=Math.sin(b)>0?1:-1,[S,E]=Nc(p,b,m);return u.x=S+(c+l)*x,u.y=E,u}var wb=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function xA(t,e){return t!==void 0?t:wc(e)?"inside":Yr(e)?"right":"top"}function Ab(t,e,n,r,o,c){const{position:l}=e,{render:u}=o,d=xA(l,n),p=r[u?"htmlLabel":d==="inside"?"innerLabel":"label"],v=Object.assign({},p,e),m=pt[d0(d)];if(!m)throw new Error(`Unknown position: ${d}`);return Object.assign(Object.assign({},p),m(d,t,v,n,o,c))}const Tb=(t,e)=>{const{coordinate:n,theme:r}=e,{render:o}=t;return(c,l,u,d)=>{const{text:h,x:p,y:v,transform:m="",transformOrigin:b,className:x=""}=l,S=wb(l,["text","x","y","transform","transformOrigin","className"]),E=Ab(c,l,n,r,t,d),{rotate:w=0,transform:M=""}=E,L=wb(E,["rotate","transform"]);return Wn(new mb).call(Fn,L).style("text",`${h}`).style("className",`${x} g2-label`).style("innerHTML",o?o(h,l.datum,l.index):void 0).style("labelTransform",`${M} rotate(${+w}) ${m}`.trim()).style("labelTransformOrigin",b).style("coordCenter",n.getCenter()).call(Fn,S).node()}};Tb.props={defaultMarker:"point"};var SA=function(t,e){if(!Ec(t))return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];e(o,r)&&n.push(o)}return n},O0=SA;function hu(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ra(t){let e,n,r;t.length!==2?(e=ci,n=(u,d)=>ci(t(u),d),r=(u,d)=>t(u)-d):(e=t===ci||t===hu?t:OA,n=t,r=t);function o(u,d,h=0,p=u.length){if(h<p){if(e(d,d)!==0)return p;do{const v=h+p>>>1;n(u[v],d)<0?h=v+1:p=v}while(h<p)}return h}function c(u,d,h=0,p=u.length){if(h<p){if(e(d,d)!==0)return p;do{const v=h+p>>>1;n(u[v],d)<=0?h=v+1:p=v}while(h<p)}return h}function l(u,d,h=0,p=u.length){const v=o(u,d,h,p-1);return v>h&&r(u[v-1],d)>-r(u[v],d)?v-1:v}return{left:o,center:l,right:c}}function OA(){return 0}function ld(t){return t===null?NaN:+t}function*EA(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const Cb=Ra(ci),wA=Cb.right,AA=Cb.left,TA=Ra(ld).center;var E0=wA;function CA(t,e,n){return Math.min(n,Math.max(e,t))}function pu(t){return!!t.getBandWidth}function Bc(t,e,n){if(!pu(t))return t.invert(e);const{adjustedRange:r}=t,{domain:o}=t.getOptions(),c=n?-1:0,l=t.getStep(),u=n?r:r.map(p=>p+l),d=AA(u,e),h=CA(d+c,0,o.length-1);return o[h]}function os(t,e,n){if(!e)return t.getOptions().domain;if(!pu(t)){const d=Do(e);if(!n)return d;const[h]=d,{range:p}=t.getOptions(),[v,m]=p,b=v>m?-1:1,x=t.invert(t.map(h)+b*n);return[h,x]}const{domain:r}=t.getOptions(),o=e[0],c=r.indexOf(o);if(n){const d=c+Math.round(r.length*n);return r.slice(c,d)}const l=e[e.length-1],u=r.indexOf(l);return r.slice(c,u+1)}function ud(t,e,n,r,o,c){const{x:l,y:u}=o,d=(b,x)=>{const[S,E]=c.invert(b);return[Bc(l,S,x),Bc(u,E,x)]},h=d([t,e],!0),p=d([n,r],!1),v=os(l,[h[0],p[0]]),m=os(u,[h[1],p[1]]);return[v,m]}function fd(t,e){const[n,r]=t,o=c=>c.getStep?c.getStep():0;return[e.map(n),e.map(r)+o(e)]}function jc(t,e,n){const{x:r,y:o}=e,[c,l]=t,u=fd(c,r),d=fd(l,o),h=[u[0],d[0]],p=[u[1],d[1]],[v,m]=n.map(h),[b,x]=n.map(p);return[v,m,b,x]}const Mb=Math.abs,Ki=Math.atan2,Zs=Math.cos,MA=Math.max,w0=Math.min,la=Math.sin,zc=Math.sqrt,Gi=1e-12,gu=Math.PI,dd=gu/2,Lb=2*gu;function LA(t){return t>1?0:t<-1?gu:Math.acos(t)}function Pb(t){return t>=1?dd:t<=-1?-dd:Math.asin(t)}function PA(t){return t.innerRadius}function IA(t){return t.outerRadius}function RA(t){return t.startAngle}function Ib(t){return t.endAngle}function kA(t){return t&&t.padAngle}function DA(t,e,n,r,o,c,l,u){var d=n-t,h=r-e,p=l-o,v=u-c,m=v*d-p*h;if(!(m*m<Gi))return m=(p*(e-c)-v*(t-o))/m,[t+m*d,e+m*h]}function vu(t,e,n,r,o,c,l){var u=t-n,d=e-r,h=(l?c:-c)/zc(u*u+d*d),p=h*d,v=-h*u,m=t+p,b=e+v,x=n+p,S=r+v,E=(m+x)/2,w=(b+S)/2,M=x-m,L=S-b,I=M*M+L*L,R=o-c,z=m*S-x*b,W=(L<0?-1:1)*zc(MA(0,R*R*I-z*z)),Y=(z*L-M*W)/I,st=(-z*M-L*W)/I,xt=(z*L+M*W)/I,Nt=(-z*M+L*W)/I,Ht=Y-E,dt=st-w,Ot=xt-E,bt=Nt-w;return Ht*Ht+dt*dt>Ot*Ot+bt*bt&&(Y=xt,st=Nt),{cx:Y,cy:st,x01:-p,y01:-v,x11:Y*(o/R-1),y11:st*(o/R-1)}}function mu(){var t=PA,e=IA,n=qr(0),r=null,o=RA,c=Ib,l=kA,u=null,d=v0(h);function h(){var p,v,m=+t.apply(this,arguments),b=+e.apply(this,arguments),x=o.apply(this,arguments)-dd,S=c.apply(this,arguments)-dd,E=Mb(S-x),w=S>x;if(u||(u=p=d()),b<m&&(v=b,b=m,m=v),!(b>Gi))u.moveTo(0,0);else if(E>Lb-Gi)u.moveTo(b*Zs(x),b*la(x)),u.arc(0,0,b,x,S,!w),m>Gi&&(u.moveTo(m*Zs(S),m*la(S)),u.arc(0,0,m,S,x,w));else{var M=x,L=S,I=x,R=S,z=E,W=E,Y=l.apply(this,arguments)/2,st=Y>Gi&&(r?+r.apply(this,arguments):zc(m*m+b*b)),xt=w0(Mb(b-m)/2,+n.apply(this,arguments)),Nt=xt,Ht=xt,dt,Ot;if(st>Gi){var bt=Pb(st/m*la(Y)),wt=Pb(st/b*la(Y));(z-=bt*2)>Gi?(bt*=w?1:-1,I+=bt,R-=bt):(z=0,I=R=(x+S)/2),(W-=wt*2)>Gi?(wt*=w?1:-1,M+=wt,L-=wt):(W=0,M=L=(x+S)/2)}var oe=b*Zs(M),Ut=b*la(M),Kt=m*Zs(R),me=m*la(R);if(xt>Gi){var Ee=b*Zs(L),Pe=b*la(L),Ie=m*Zs(I),qe=m*la(I),sn;if(E<gu)if(sn=DA(oe,Ut,Ie,qe,Ee,Pe,Kt,me)){var yn=oe-sn[0],on=Ut-sn[1],rn=Ee-sn[0],Rn=Pe-sn[1],xn=1/la(LA((yn*rn+on*Rn)/(zc(yn*yn+on*on)*zc(rn*rn+Rn*Rn)))/2),gn=zc(sn[0]*sn[0]+sn[1]*sn[1]);Nt=w0(xt,(m-gn)/(xn-1)),Ht=w0(xt,(b-gn)/(xn+1))}else Nt=Ht=0}W>Gi?Ht>Gi?(dt=vu(Ie,qe,oe,Ut,b,Ht,w),Ot=vu(Ee,Pe,Kt,me,b,Ht,w),u.moveTo(dt.cx+dt.x01,dt.cy+dt.y01),Ht<xt?u.arc(dt.cx,dt.cy,Ht,Ki(dt.y01,dt.x01),Ki(Ot.y01,Ot.x01),!w):(u.arc(dt.cx,dt.cy,Ht,Ki(dt.y01,dt.x01),Ki(dt.y11,dt.x11),!w),u.arc(0,0,b,Ki(dt.cy+dt.y11,dt.cx+dt.x11),Ki(Ot.cy+Ot.y11,Ot.cx+Ot.x11),!w),u.arc(Ot.cx,Ot.cy,Ht,Ki(Ot.y11,Ot.x11),Ki(Ot.y01,Ot.x01),!w))):(u.moveTo(oe,Ut),u.arc(0,0,b,M,L,!w)):u.moveTo(oe,Ut),!(m>Gi)||!(z>Gi)?u.lineTo(Kt,me):Nt>Gi?(dt=vu(Kt,me,Ee,Pe,m,-Nt,w),Ot=vu(oe,Ut,Ie,qe,m,-Nt,w),u.lineTo(dt.cx+dt.x01,dt.cy+dt.y01),Nt<xt?u.arc(dt.cx,dt.cy,Nt,Ki(dt.y01,dt.x01),Ki(Ot.y01,Ot.x01),!w):(u.arc(dt.cx,dt.cy,Nt,Ki(dt.y01,dt.x01),Ki(dt.y11,dt.x11),!w),u.arc(0,0,m,Ki(dt.cy+dt.y11,dt.cx+dt.x11),Ki(Ot.cy+Ot.y11,Ot.cx+Ot.x11),w),u.arc(Ot.cx,Ot.cy,Nt,Ki(Ot.y11,Ot.x11),Ki(Ot.y01,Ot.x01),!w))):u.arc(0,0,m,R,I,w)}if(u.closePath(),p)return u=null,p+""||null}return h.centroid=function(){var p=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,v=(+o.apply(this,arguments)+ +c.apply(this,arguments))/2-gu/2;return[Zs(v)*p,la(v)*p]},h.innerRadius=function(p){return arguments.length?(t=typeof p=="function"?p:qr(+p),h):t},h.outerRadius=function(p){return arguments.length?(e=typeof p=="function"?p:qr(+p),h):e},h.cornerRadius=function(p){return arguments.length?(n=typeof p=="function"?p:qr(+p),h):n},h.padRadius=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:qr(+p),h):r},h.startAngle=function(p){return arguments.length?(o=typeof p=="function"?p:qr(+p),h):o},h.endAngle=function(p){return arguments.length?(c=typeof p=="function"?p:qr(+p),h):c},h.padAngle=function(p){return arguments.length?(l=typeof p=="function"?p:qr(+p),h):l},h.context=function(p){return arguments.length?(u=p==null?null:p,h):u},h}var hd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Rb(t,e,n,r,o={}){const{inset:c=0,radius:l=0,insetLeft:u=c,insetTop:d=c,insetRight:h=c,insetBottom:p=c,radiusBottomLeft:v=l,radiusBottomRight:m=l,radiusTopLeft:b=l,radiusTopRight:x=l,minWidth:S=-1/0,maxWidth:E=1/0,minHeight:w=-1/0}=o,M=hd(o,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!Pr(r)&&!wy(r)){const Y=!!Yr(r),[st,,xt]=Y?id(e):e,[Nt,Ht]=st,[dt,Ot]=oi(xt,st),bt=dt>0?Nt:Nt+dt,wt=Ot>0?Ht:Ht+Ot,oe=Math.abs(dt),Ut=Math.abs(Ot),Kt=bt+u,me=wt+d,Ee=oe-(u+h),Pe=Ut-(d+p),Ie=Y?Ef(Ee,w,1/0):Ef(Ee,S,E),qe=Y?Ef(Pe,S,E):Ef(Pe,w,1/0),sn=Y?Kt:Kt-(Ie-Ee)/2,yn=Y?me-(qe-Pe)/2:me-(qe-Pe);return Wn(t.createElement("rect",{})).style("x",sn).style("y",yn).style("width",Ie).style("height",qe).style("radius",[b,x,m,v]).call(Fn,M).node()}const{y:L,y1:I}=n,R=r.getCenter(),z=zs(r,e,[L,I]),W=mu().cornerRadius(l).padAngle(c*Math.PI/180);return Wn(t.createElement("path",{})).style("d",W(z)).style("transform",`translate(${R[0]}, ${R[1]})`).style("radius",l).style("inset",c).call(Fn,M).node()}const pd=(t,e)=>{const{colorAttribute:n,opacityAttribute:r="fill",first:o=!0,last:c=!0}=t,l=hd(t,["colorAttribute","opacityAttribute","first","last"]),{coordinate:u,document:d}=e;return(h,p,v)=>{const{color:m,radius:b=0}=v,x=hd(v,["color","radius"]),S=x.lineWidth||1,{stroke:E,radius:w=b,radiusTopLeft:M=w,radiusTopRight:L=w,radiusBottomRight:I=w,radiusBottomLeft:R=w,innerRadius:z=0,innerRadiusTopLeft:W=z,innerRadiusTopRight:Y=z,innerRadiusBottomRight:st=z,innerRadiusBottomLeft:xt=z,lineWidth:Nt=n==="stroke"||E?S:0,inset:Ht=0,insetLeft:dt=Ht,insetRight:Ot=Ht,insetBottom:bt=Ht,insetTop:wt=Ht,minWidth:oe,maxWidth:Ut,minHeight:Kt}=l,me=hd(l,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:Ee=m,opacity:Pe}=p,Ie=[o?M:W,o?L:Y,c?I:st,c?R:xt],qe=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];Yr(u)&&qe.push(qe.shift());const sn=Object.assign(Object.assign({radius:w},Object.fromEntries(qe.map((yn,on)=>[yn,Ie[on]]))),{inset:Ht,insetLeft:dt,insetRight:Ot,insetBottom:bt,insetTop:wt,minWidth:oe,maxWidth:Ut,minHeight:Kt});return Wn(Rb(d,h,p,u,sn)).call(Fn,x).style("fill","transparent").style(n,Ee).style(f0(t),Pe).style("lineWidth",Nt).style("stroke",E===void 0?Ee:E).call(Fn,me).node()}};pd.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const FA={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function GL(t,e){var n;return(n=t.style[e])!==null&&n!==void 0?n:FA[e]}function A0(t,e,n,r){t.style[e]=n,r&&t.children.forEach(o=>A0(o,e,n,r))}function kb(t){A0(t,"visibility","hidden",!0)}function T0(t){A0(t,"visibility","visible",!0)}var ua=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Hs(t){return Wn(t).selectAll(`.${Oe}`).nodes().filter(e=>!e.__removed__)}function yu(t,e){return C0(t,e).flatMap(({container:n})=>Hs(n))}function C0(t,e){return e.filter(n=>n!==t&&n.options.parentKey===t.options.key)}function ka(t){return Wn(t).select(`.${nt}`).node()}function as(t){if(t.tagName==="g")return t.getRenderBounds();const e=t.getGeometryBounds(),n=new F.mN;return n.setFromTransformedAABB(e,t.getWorldTransform()),n}function gd(t,e){const{offsetX:n,offsetY:r}=e,o=as(t),{min:[c,l],max:[u,d]}=o,h=n<c||n>u,p=r<l||r>d;return h||p?null:[n-c,r-l]}function M0(t,e){const{offsetX:n,offsetY:r}=e,[o,c,l,u]=YL(t);return[Math.min(l,Math.max(o,n))-o,Math.min(u,Math.max(c,r))-c]}function YL(t){const e=t.getRenderBounds(),{min:[n,r],max:[o,c]}=e;return[n,r,o,c]}function L0(t){return e=>e.__data__.color}function Wo(t){return e=>e.__data__.x}function ss(t){const e=Array.isArray(t)?t:[t],n=new Map(e.flatMap(r=>Array.from(r.markState.keys()).map(c=>[P0(r.key,c.key),c.data])));return r=>{const{index:o,markKey:c,viewKey:l}=r.__data__;return n.get(P0(l,c))[o]}}function yi(t,e=(r,o)=>r,n=(r,o,c)=>r.setAttribute(o,c)){const r="__states__",o="__ordinal__",c=p=>{const{[r]:v=[],[o]:m={}}=p,b=v.reduce((x,S)=>Object.assign(Object.assign({},x),t[S]),m);if(Object.keys(b).length!==0){for(const[x,S]of Object.entries(b)){const E=GL(p,x),w=e(S,p);n(p,x,w),x in m||(m[x]=E)}p[o]=m}},l=p=>{p[r]||(p[r]=[])};return{setState:(p,...v)=>{l(p),p[r]=[...v],c(p)},removeState:(p,...v)=>{l(p);for(const m of v){const b=p[r].indexOf(m);b!==-1&&p[r].splice(b,1)}c(p)},hasState:(p,v)=>(l(p),p[r].indexOf(v)!==-1)}}function $L(t){return t===void 0?!0:typeof t!="object"?!1:Object.keys(t).length===0}function P0(t,e){return`${t},${e}`}function bu(t,e){const r=(Array.isArray(t)?t:[t]).flatMap(c=>c.marks.map(l=>[P0(c.key,l.key),l.state])),o={};for(const c of e){const[l,u]=Array.isArray(c)?c:[c,{}];o[l]=r.reduce((d,h)=>{const[p,v={}]=h,m=$L(v[l])?u:v[l];for(const[b,x]of Object.entries(m)){const S=d[b],E=(w,M,L,I)=>{const R=P0(I.__data__.viewKey,I.__data__.markKey);return p!==R?S==null?void 0:S(w,M,L,I):typeof x!="function"?x:x(w,M,L,I)};d[b]=E}return d},{})}return o}function Uc(t,e){const n=new Map(t.map((o,c)=>[o,c])),r=e?t.map(e):t;return(o,c)=>{if(typeof o!="function")return o;const l=n.get(c),u=e?e(c):c;return o(u,l,r,c)}}function NA(t){var{link:e=!1,valueof:n=(p,v)=>p,coordinate:r}=t,o=ua(t,["link","valueof","coordinate"]);const c="element-link";if(!e)return[()=>{},()=>{}];const l=p=>p.__data__.points,u=(p,v)=>{const[,m,b]=p,[x,,,S]=v;return[m,x,S,b]};return[p=>{var v;if(p.length<=1)return;const m=Do(p,(b,x)=>{const{x:S}=b.__data__,{x:E}=x.__data__;return S-E});for(let b=1;b<m.length;b++){const x=ko(),S=m[b-1],E=m[b],[w,M,L,I]=u(l(S),l(E));x.moveTo(...w),x.lineTo(...M),x.lineTo(...L),x.lineTo(...I),x.closePath();const R=Ho(o,st=>n(st,S)),{fill:z=S.getAttribute("fill")}=R,W=ua(R,["fill"]),Y=new F.y$({className:c,style:Object.assign({d:x.toString(),fill:z,zIndex:-2},W)});(v=S.link)===null||v===void 0||v.remove(),S.parentNode.appendChild(Y),S.link=Y}},p=>{var v;(v=p.link)===null||v===void 0||v.remove(),p.link=null}]}function Db(t,e,n){const r=o=>{const{transform:c}=t.style;return c?`${c} ${o}`:o};if(Pr(n)){const{points:o}=t.__data__,[c,l]=Yr(n)?id(o):o,u=n.getCenter(),d=oi(c,u),h=oi(l,u),p=Ro(d),v=ab(d,h),m=p+v/2,b=e*Math.cos(m),x=e*Math.sin(m);return r(`translate(${b}, ${x})`)}return Yr(n)?r(`translate(${e}, 0)`):r(`translate(0, ${-e})`)}function BA(t){var{document:e,background:n,scale:r,coordinate:o,valueof:c}=t,l=ua(t,["document","background","scale","coordinate","valueof"]);const u="element-background";if(!n)return[()=>{},()=>{}];const d=(w,M,L)=>{const I=w.invert(M),R=M+w.getBandWidth(I)/2,z=w.getStep(I)/2,W=z*L;return[R-z+W,R+z-W]},h=(w,M)=>{const{x:L}=r;if(!pu(L))return[0,1];const{__data__:I}=w,{x:R}=I,[z,W]=d(L,R,M);return[z,W]},p=(w,M)=>{const{y:L}=r;if(!pu(L))return[0,1];const{__data__:I}=w,{y:R}=I,[z,W]=d(L,R,M);return[z,W]},v=(w,M)=>{const{padding:L}=M,[I,R]=h(w,L),[z,W]=p(w,L),Y=[[I,z],[R,z],[R,W],[I,W]].map(Ht=>o.map(Ht)),{__data__:st}=w,{y:xt,y1:Nt}=st;return Rb(e,Y,{y:xt,y1:Nt},o,M)},m=(w,M)=>{const{transform:L="scale(1.2, 1.2)",transformOrigin:I="center center",stroke:R=""}=M,z=ua(M,["transform","transformOrigin","stroke"]),W=Object.assign({transform:L,transformOrigin:I,stroke:R},z),Y=w.cloneNode(!0);for(const[st,xt]of Object.entries(W))Y.style[st]=xt;return Y},b=()=>{const{x:w,y:M}=r;return[w,M].some(pu)};return[w=>{w.background&&w.background.remove();const M=Ho(l,Ht=>c(Ht,w)),{fill:L="#CCD6EC",fillOpacity:I=.3,zIndex:R=-2,padding:z=.001,lineWidth:W=0}=M,Y=ua(M,["fill","fillOpacity","zIndex","padding","lineWidth"]),st=Object.assign(Object.assign({},Y),{fill:L,fillOpacity:I,zIndex:R,padding:z,lineWidth:W}),Nt=(b()?v:m)(w,st);Nt.className=u,w.parentNode.parentNode.appendChild(Nt),w.background=Nt},w=>{var M;(M=w.background)===null||M===void 0||M.remove(),w.background=null},w=>w.className===u]}function Vs(t,e){const r=t.getRootNode().defaultView.getContextService().getDomElement();r!=null&&r.style&&(t.cursor=r.style.cursor,r.style.cursor=e)}function XL(t){Vs(t,t.cursor)}function Fb(t,e,n){return t.find(r=>Object.entries(e).every(([o,c])=>n(r)[o]===c))}function I0(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function _u(t,e=!1){const n=O0(t,r=>!!r).map((r,o)=>[o===0?"M":"L",...r]);return e&&n.push(["Z"]),n}function Nb(t){return t.querySelectorAll(".element")}function jA(t,e,n=0){const r=[["M",...e[1]]],o=I0(t,e[1]),c=I0(t,e[0]);return o===0?r.push(["L",...e[3]],["A",c,c,0,n,1,...e[0]],["Z"]):r.push(["A",o,o,0,n,0,...e[2]],["L",...e[3]],["A",c,c,0,n,1,...e[0]],["Z"]),r}function xu(t,e){if(e(t))return t;let n=t.parent;for(;n&&!e(n);)n=n.parent;return n}function R0(t,e){const{__data__:n}=t,{markKey:r,index:o,seriesIndex:c}=n,{markState:l}=e,u=Array.from(l.keys()).find(d=>d.key===r);if(u)return c?c.map(d=>u.data[d]):u.data[o]}function Bb(t){return xu(t,e=>e.className==="component")}function zA(t){return xu(t,e=>e.className==="element")}function UA(t){return xu(t,e=>e.className==="label")}function bi(t,e,n,r=o=>!0){return o=>{if(!r(o))return;n.emit(`plot:${t}`,o);const{target:c}=o;if(!c)return;const{className:l}=c;if(l==="plot")return;const u=zA(c),d=Bb(c),h=UA(c),p=u||d||h;if(!p)return;const{className:v,markType:m}=p,b=Object.assign(Object.assign({},o),{nativeEvent:!0});v==="element"?(b.data={data:R0(p,e)},n.emit(`element:${t}`,b),n.emit(`${m}:${t}`,b)):v==="label"?(b.data={data:p.attributes.datum},n.emit(`label:${t}`,b),n.emit(`${l}:${t}`,b)):(n.emit(`component:${t}`,b),n.emit(`${l}:${t}`,b))}}function k0(){return(t,e,n)=>{const{container:r,view:o}=t,c=bi(Sr.CLICK,o,n,W=>W.detail===1),l=bi(Sr.DBLCLICK,o,n,W=>W.detail===2),u=bi(Sr.POINTER_TAP,o,n),d=bi(Sr.POINTER_DOWN,o,n),h=bi(Sr.POINTER_UP,o,n),p=bi(Sr.POINTER_OVER,o,n),v=bi(Sr.POINTER_OUT,o,n),m=bi(Sr.POINTER_MOVE,o,n),b=bi(Sr.POINTER_ENTER,o,n),x=bi(Sr.POINTER_LEAVE,o,n),S=bi(Sr.POINTER_UPOUTSIDE,o,n),E=bi(Sr.DRAG_START,o,n),w=bi(Sr.DRAG,o,n),M=bi(Sr.DRAG_END,o,n),L=bi(Sr.DRAG_ENTER,o,n),I=bi(Sr.DRAG_LEAVE,o,n),R=bi(Sr.DRAG_OVER,o,n),z=bi(Sr.DROP,o,n);return r.addEventListener("click",c),r.addEventListener("click",l),r.addEventListener("pointertap",u),r.addEventListener("pointerdown",d),r.addEventListener("pointerup",h),r.addEventListener("pointerover",p),r.addEventListener("pointerout",v),r.addEventListener("pointermove",m),r.addEventListener("pointerenter",b),r.addEventListener("pointerleave",x),r.addEventListener("pointerupoutside",S),r.addEventListener("dragstart",E),r.addEventListener("drag",w),r.addEventListener("dragend",M),r.addEventListener("dragenter",L),r.addEventListener("dragleave",I),r.addEventListener("dragover",R),r.addEventListener("drop",z),()=>{r.removeEventListener("click",c),r.removeEventListener("click",l),r.removeEventListener("pointertap",u),r.removeEventListener("pointerdown",d),r.removeEventListener("pointerup",h),r.removeEventListener("pointerover",p),r.removeEventListener("pointerout",v),r.removeEventListener("pointermove",m),r.removeEventListener("pointerenter",b),r.removeEventListener("pointerleave",x),r.removeEventListener("pointerupoutside",S),r.removeEventListener("dragstart",E),r.removeEventListener("drag",w),r.removeEventListener("dragend",M),r.removeEventListener("dragenter",L),r.removeEventListener("dragleave",I),r.removeEventListener("dragover",R),r.removeEventListener("drop",z)}}}k0.props={reapplyWhenUpdate:!0};function ZA(){return{"component.axisRadar":E1,"component.axisLinear":La,"component.axisArc":Jp,"component.legendContinuousBlock":eb,"component.legendContinuousBlockSize":nb,"component.legendContinuousSize":a0,"interaction.event":k0,"composition.mark":ib,"composition.view":c0,"shape.label.label":Tb}}var qL=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Kr(t,e){const n=Object.assign(Object.assign({},ZA()),e),r=c=>{if(typeof c!="string")return c;const l=`${t}.${c}`;return n[l]||ws(`Unknown Component: ${l}`)};return[(c,l)=>{const{type:u}=c,d=qL(c,["type"]);u||ws("Plot type is required!");const h=r(u);return h==null?void 0:h(d,l)},r]}function D0(t){const{canvas:e,group:n}=t;return(e==null?void 0:e.document)||(n==null?void 0:n.ownerDocument)||ws("Cannot find library document")}var F0=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function jb(t,e,n){const[r]=Kr("coordinate",n),{innerHeight:o,innerWidth:c,insetLeft:l,insetTop:u,insetRight:d,insetBottom:h}=t,{coordinates:p=[]}=e,v=JL(p),m=v[0].type==="cartesian3D",b=Object.assign(Object.assign({},t),{x:l,y:u,width:c-l-d,height:o-h-u,transformations:v.flatMap(r)});return m?new hp.Coordinate3D(b):new hp.Coordinate(b)}function zb(t,e){const{coordinate:n={},coordinates:r}=t,o=F0(t,["coordinate","coordinates"]);if(r)return t;const{type:c,transform:l=[]}=n,u=F0(n,["type","transform"]);if(!c)return Object.assign(Object.assign({},o),{coordinates:l});const[,d]=Kr("coordinate",e),{transform:h=!1}=d(c).props||{};if(h)throw new Error(`Unknown coordinate: ${c}.`);return Object.assign(Object.assign({},o),{coordinates:[Object.assign({type:c},u),...l]})}function fa(t,e){return t.filter(n=>n.type===e)}function Da(t){return fa(t,"polar").length>0}function Ub(t){return fa(t,"helix").length>0}function Zc(t){return fa(t,"transpose").length%2===1}function Zb(t){return fa(t,"parallel").length>0}function Hb(t){return fa(t,"theta").length>0}function KL(t){return fa(t,"reflect").length>0}function cs(t){return fa(t,"radial").length>0}function Vb(t){return fa(t,"radar").length>0}function QL(t){return fa(t,"reflectY").length>0}function JL(t){return t.find(e=>e.type==="cartesian"||e.type==="cartesian3D")?t:[...t,{type:"cartesian"}]}function er(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}var N0=er("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),B0=er("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Wb=er("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),vd=er("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),j0=er("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),t6=er("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),e6=er("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),HA=er("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),VA=er("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Fo=er("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),md=er("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function Su(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ou(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Eu(){}var Ws=.7,Hc=1/Ws,Gs="\\s*([+-]?\\d+)\\s*",Vc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ys=/^#([0-9a-f]{3,8})$/,WA=new RegExp("^rgb\\(".concat(Gs,",").concat(Gs,",").concat(Gs,"\\)$")),n6=new RegExp("^rgb\\(".concat(xo,",").concat(xo,",").concat(xo,"\\)$")),Gb=new RegExp("^rgba\\(".concat(Gs,",").concat(Gs,",").concat(Gs,",").concat(Vc,"\\)$")),Yb=new RegExp("^rgba\\(".concat(xo,",").concat(xo,",").concat(xo,",").concat(Vc,"\\)$")),$s=new RegExp("^hsl\\(".concat(Vc,",").concat(xo,",").concat(xo,"\\)$")),ls=new RegExp("^hsla\\(".concat(Vc,",").concat(xo,",").concat(xo,",").concat(Vc,"\\)$")),z0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Su(Eu,Xb,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:U0,formatHex:U0,formatHex8:yd,formatHsl:$b,formatRgb:Z0,toString:Z0});function U0(){return this.rgb().formatHex()}function yd(){return this.rgb().formatHex8()}function $b(){return xd(this).formatHsl()}function Z0(){return this.rgb().formatRgb()}function Xb(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ys.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?GA(e):n===3?new Qi(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?wu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?wu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WA.exec(t))?new Qi(e[1],e[2],e[3],1):(e=n6.exec(t))?new Qi(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Gb.exec(t))?wu(e[1],e[2],e[3],e[4]):(e=Yb.exec(t))?wu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=$s.exec(t))?Qb(e[1],e[2]/100,e[3]/100,1):(e=ls.exec(t))?Qb(e[1],e[2]/100,e[3]/100,e[4]):z0.hasOwnProperty(t)?GA(z0[t]):t==="transparent"?new Qi(NaN,NaN,NaN,0):null}function GA(t){return new Qi(t>>16&255,t>>8&255,t&255,1)}function wu(t,e,n,r){return r<=0&&(t=e=n=NaN),new Qi(t,e,n,r)}function qb(t){return t instanceof Eu||(t=Xb(t)),t?(t=t.rgb(),new Qi(t.r,t.g,t.b,t.opacity)):new Qi}function us(t,e,n,r){return arguments.length===1?qb(t):new Qi(t,e,n,r==null?1:r)}function Qi(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Su(Qi,us,Ou(Eu,{brighter:function(e){return e=e==null?Hc:Math.pow(Hc,e),new Qi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ws:Math.pow(Ws,e),new Qi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new Qi(Xs(this.r),Xs(this.g),Xs(this.b),_d(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bd,formatHex:bd,formatHex8:H0,formatRgb:Kb,toString:Kb}));function bd(){return"#".concat(qs(this.r)).concat(qs(this.g)).concat(qs(this.b))}function H0(){return"#".concat(qs(this.r)).concat(qs(this.g)).concat(qs(this.b)).concat(qs((isNaN(this.opacity)?1:this.opacity)*255))}function Kb(){var t=_d(this.opacity);return"".concat(t===1?"rgb(":"rgba(").concat(Xs(this.r),", ").concat(Xs(this.g),", ").concat(Xs(this.b)).concat(t===1?")":", ".concat(t,")"))}function _d(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xs(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function qs(t){return t=Xs(t),(t<16?"0":"")+t.toString(16)}function Qb(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Go(t,e,n,r)}function xd(t){if(t instanceof Go)return new Go(t.h,t.s,t.l,t.opacity);if(t instanceof Eu||(t=Xb(t)),!t)return new Go;if(t instanceof Go)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),c=Math.max(e,n,r),l=NaN,u=c-o,d=(c+o)/2;return u?(e===c?l=(n-r)/u+(n<r)*6:n===c?l=(r-e)/u+2:l=(e-n)/u+4,u/=d<.5?c+o:2-c-o,l*=60):u=d>0&&d<1?0:l,new Go(l,u,d,t.opacity)}function YA(t,e,n,r){return arguments.length===1?xd(t):new Go(t,e,n,r==null?1:r)}function Go(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Su(Go,YA,Ou(Eu,{brighter:function(e){return e=e==null?Hc:Math.pow(Hc,e),new Go(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ws:Math.pow(Ws,e),new Go(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*n,c=2*r-o;return new Qi(Bi(e>=240?e-240:e+120,c,o),Bi(e,c,o),Bi(e<120?e+240:e-120,c,o),this.opacity)},clamp:function(){return new Go(Jb(this.h),Au(this.s),Au(this.l),_d(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=_d(this.opacity);return"".concat(e===1?"hsl(":"hsla(").concat(Jb(this.h),", ").concat(Au(this.s)*100,"%, ").concat(Au(this.l)*100,"%").concat(e===1?")":", ".concat(e,")"))}}));function Jb(t){return t=(t||0)%360,t<0?t+360:t}function Au(t){return Math.max(0,Math.min(1,t||0))}function Bi(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Sd(t,e,n,r,o){var c=t*t,l=c*t;return((1-3*t+3*c-l)*e+(4-6*c+3*l)*n+(1+3*t+3*c-3*l)*r+l*o)/6}function t_(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],c=t[r+1],l=r>0?t[r-1]:2*o-c,u=r<e-1?t[r+2]:2*c-o;return Sd((n-r/e)*e,l,o,c,u)}}function $A(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],c=t[r%e],l=t[(r+1)%e],u=t[(r+2)%e];return Sd((n-r/e)*e,o,c,l,u)}}var V0=function(t){return function(){return t}};function Tu(t,e){return function(n){return t+n*e}}function W0(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function e_(t,e){var n=e-t;return n?Tu(t,n>180||n<-180?n-360*Math.round(n/360):n):V0(isNaN(t)?e:t)}function XA(t){return(t=+t)==1?Fa:function(e,n){return n-e?W0(e,n,t):V0(isNaN(e)?n:e)}}function Fa(t,e){var n=e-t;return n?Tu(t,n):V0(isNaN(t)?e:t)}var n_=function t(e){var n=XA(e);function r(o,c){var l=n((o=us(o)).r,(c=us(c)).r),u=n(o.g,c.g),d=n(o.b,c.b),h=Fa(o.opacity,c.opacity);return function(p){return o.r=l(p),o.g=u(p),o.b=d(p),o.opacity=h(p),o+""}}return r.gamma=t,r}(1);function r_(t){return function(e){var n=e.length,r=new Array(n),o=new Array(n),c=new Array(n),l,u;for(l=0;l<n;++l)u=us(e[l]),r[l]=u.r||0,o[l]=u.g||0,c[l]=u.b||0;return r=t(r),o=t(o),c=t(c),u.opacity=1,function(d){return u.r=r(d),u.g=o(d),u.b=c(d),u+""}}}var Od=r_(t_),Cu=r_($A),$r=t=>Od(t[t.length-1]),i_=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(er),qA=$r(i_),o_=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(er),a_=$r(o_),s_=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(er),c_=$r(s_),G0=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(er),l_=$r(G0),Y0=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(er),u_=$r(Y0),f_=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(er),Ed=$r(f_),wd=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(er),d_=$r(wd),h_=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(er),KA=$r(h_),p_=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(er),QA=$r(p_),Wc=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(er),g_=$r(Wc),v_=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(er),m_=$r(v_),$0=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(er),y_=$r($0),b_=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(er),JA=$r(b_),__=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(er),t5=$r(__),x_=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(er),S_=$r(x_),O_=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(er),E_=$r(O_),X0=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(er),w_=$r(X0),A_=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(er),e5=$r(A_),q0=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(er),n5=$r(q0),T_=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(er),r5=$r(T_),Ad=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(er),r6=$r(Ad),K0=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(er),C_=$r(K0),Q0=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(er),J0=$r(Q0),Td=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(er),io=$r(Td),Cd=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(er),Gc=$r(Cd),i5=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(er),M_=$r(i5),L_=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(er),i6=$r(L_);function Md(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}var Mu=Math.PI/180,P_=180/Math.PI,tg=-.14861,Ld=1.78277,Na=-.29227,Yc=-.90649,fs=1.97294,I_=fs*Yc,R_=fs*Ld,Ks=Ld*Na-Yc*tg;function o5(t){if(t instanceof $c)return new $c(t.h,t.s,t.l,t.opacity);t instanceof Qi||(t=qb(t));var e=t.r/255,n=t.g/255,r=t.b/255,o=(Ks*r+I_*e-R_*n)/(Ks+I_-R_),c=r-o,l=(fs*(n-o)-Na*c)/Yc,u=Math.sqrt(l*l+c*c)/(fs*o*(1-o)),d=u?Math.atan2(l,c)*P_-120:NaN;return new $c(d<0?d+360:d,u,o,t.opacity)}function da(t,e,n,r){return arguments.length===1?o5(t):new $c(t,e,n,r==null?1:r)}function $c(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Su($c,da,Ou(Eu,{brighter:function(e){return e=e==null?Hc:Math.pow(Hc,e),new $c(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ws:Math.pow(Ws,e),new $c(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Mu,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),o=Math.cos(e),c=Math.sin(e);return new Qi(255*(n+r*(tg*o+Ld*c)),255*(n+r*(Na*o+Yc*c)),255*(n+r*(fs*o)),this.opacity)}}));function a5(t){return function e(n){n=+n;function r(o,c){var l=t((o=da(o)).h,(c=da(c)).h),u=Fa(o.s,c.s),d=Fa(o.l,c.l),h=Fa(o.opacity,c.opacity);return function(p){return o.h=l(p),o.s=u(p),o.l=d(Math.pow(p,n)),o.opacity=h(p),o+""}}return r.gamma=e,r}(1)}var rk=a5(e_),k_=a5(Fa),o6=k_(da(300,.5,0),da(-240,.5,1)),a6=k_(da(-100,.75,.35),da(80,1.5,.8)),s6=k_(da(260,.75,.35),da(80,1.5,.8)),Lu=da();function eg(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Lu.h=360*t-100,Lu.s=1.5-1.5*e,Lu.l=.8-.9*e,Lu+""}var ng=us(),D_=Math.PI/3,s5=Math.PI*2/3;function c6(t){var e;return t=(.5-t)*Math.PI,ng.r=255*(e=Math.sin(t))*e,ng.g=255*(e=Math.sin(t+D_))*e,ng.b=255*(e=Math.sin(t+s5))*e,ng+""}function F_(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function Pd(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var l6=Pd(er("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),N_=Pd(er("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),c5=Pd(er("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),u6=Pd(er("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Id(t,e,n,r,o,c){const{guide:l={}}=n,u=p6(t,e,n);if(typeof u!="string")return n;const d=g6(u,t,e,n),h=f5(u,d,n);return Object.assign(Object.assign(Object.assign({},n),U_(u,t,e,n,r)),{domain:h,range:v6(u,t,e,n,h,o,c),expectedDomain:d,guide:l,name:t,type:u})}function l5(t,e){const n={};for(const r of t){const{values:o,name:c}=r,l=e[c];for(const u of o){const{name:d,value:h}=u;n[d]=h.map(p=>l.map(p))}}return n}function f6(t,e){const n=Array.from(t.values()).flatMap(o=>o.channels);bf(n,o=>o.map(c=>e.get(c.scale.uid)),o=>o.name).filter(([,o])=>o.some(c=>typeof c.getOptions().groupTransform=="function")&&o.every(c=>c.getTicks)).map(o=>o[1]).forEach(o=>{const c=o.map(l=>l.getOptions().groupTransform)[0];c(o)})}function Qs(t,e){var n;const{components:r=[]}=e,o=["scale","encode","axis","legend","data","transform"],c=Array.from(new Set(t.flatMap(u=>u.channels.map(d=>d.scale)))),l=new Map(c.map(u=>[u.name,u]));for(const u of r){const d=Xc(u);for(const h of d){const p=l.get(h),v=((n=u.scale)===null||n===void 0?void 0:n[h])||{},{independent:m=!1}=v;if(p&&!m){const{guide:b}=p,x=typeof b=="boolean"?{}:b;p.guide=en({},x,u),Object.assign(p,v)}else{const b=Object.assign(Object.assign({},v),{expectedDomain:v.domain,name:h,guide:Gp(u,o)});c.push(b)}}}return c}function B_(t){if(!t||!Array.isArray(t))return[Es,Es];let e,n;return[c=>{var l;e=c.map.bind(c),n=(l=c.invert)===null||l===void 0?void 0:l.bind(c);const u=t.filter(([m])=>typeof m=="function"),d=t.filter(([m])=>typeof m!="function"),h=new Map(d);if(c.map=m=>{for(const[b,x]of u)if(b(m))return x;return h.has(m)?h.get(m):e(m)},!n)return c;const p=new Map(d.map(([m,b])=>[b,m])),v=new Map(u.map(([m,b])=>[b,m]));return c.invert=m=>v.has(m)?m:p.has(m)?p.get(m):n(m),c},c=>(e!==null&&(c.map=e),n!==null&&(c.invert=n),c)]}function Pu(t,e){const n=Object.keys(t);for(const r of Object.values(e)){const{name:o}=r.getOptions();if(!(o in t))t[o]=r;else{const c=n.filter(d=>d.startsWith(o)).map(d=>+(d.replace(o,"")||0)),l=Or(c)+1,u=`${o}${l}`;t[u]=r,r.getOptions().key=u}}return t}function j_(t,e){const[n]=Kr("scale",e),{relations:r}=t,[o]=B_(r),c=n(t);return o(c)}function u5(t){const e=t.flatMap(n=>Array.from(n.values())).flatMap(n=>n.channels.map(r=>r.scale));z_(e,"x"),z_(e,"y")}function Xc(t){const{channels:e=[],type:n,scale:r={}}=t,o=["shape","color","opacity","size"];return e.length!==0?e:n==="axisX"?["x"]:n==="axisY"?["y"]:n==="legends"?Object.keys(r).filter(c=>o.includes(c)):[]}function z_(t,e){const n=t.filter(({name:c,facet:l=!0})=>l&&c===e),r=n.flatMap(c=>c.domain),o=n.every(d5)?Ma(r):n.every(h5)?Array.from(new Set(r)):null;if(o!==null)for(const c of n)c.domain=o}function f5(t,e,n){const{ratio:r}=n;return r==null?e:d5({type:t})?d6(e,r,t):h5({type:t})?h6(e,r):e}function d6(t,e,n){const r=t.map(Number),o=new qi({domain:r,range:[r[0],r[0]+(r[r.length-1]-r[0])*e]});return n==="time"?t.map(c=>new Date(o.map(c))):t.map(c=>o.map(c))}function h6(t,e){const n=Math.round(t.length*e);return t.slice(0,n)}function d5(t){const{type:e}=t;return typeof e!="string"?!1:["linear","log","pow","time"].includes(e)}function h5(t){const{type:e}=t;return typeof e!="string"?!1:["band","point","ordinal"].includes(e)}function p6(t,e,n){const{type:r,domain:o,range:c,quantitative:l,ordinal:u}=n;return r!==void 0?r:m5(e)?"identity":typeof c=="string"?"linear":(o||c||[]).length>2?Js(t,u):o!==void 0?qc([o])?Js(t,u):Kc(e)?"time":Z_(t,c,l):qc(e)?Js(t,u):Kc(e)?"time":Z_(t,c,l)}function g6(t,e,n,r){const{domain:o}=r;if(o!==void 0)return o;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return sg(ji(n,r),r);case"band":case"ordinal":case"point":return p5(n);case"quantile":return g5(n);case"sequential":return sg(Ar(n),r);default:return[]}}function v6(t,e,n,r,o,c,l){const{range:u}=r;if(typeof u=="string")return m6(u);if(u!==void 0)return u;const{rangeMin:d,rangeMax:h}=r;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":{const p=rg(n,r,o,c,l),[v,m]=v5(e,p);return[d!=null?d:v,h!=null?h:m]}case"band":case"point":{const p=e==="size"?5:0,v=e==="size"?10:1;return[d!=null?d:p,h!=null?h:v]}case"ordinal":return rg(n,r,o,c,l);case"sequential":return;case"constant":return[n[0][0]];default:return[]}}function U_(t,e,n,r,o){switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":return y6(o,r);case"band":case"point":return og(t,e,o,r);case"sequential":return Iu(r);default:return r}}function rg(t,e,n,r,o){const[c]=Kr("palette",o),{category10:l,category20:u}=r,d=by(n).length<=l.length?l:u,{palette:h=d,offset:p}=e;if(Array.isArray(h))return h;try{return c({type:h})}catch(v){const m=ig(h,n,p);if(m)return m;throw new Error(`Unknown Component: ${h} `)}}function m6(t){return t.split("-")}function ig(t,e,n=r=>r){if(!t)return null;const r=Ts(t),o=it[`scheme${r}`],c=it[`interpolate${r}`];if(!o&&!c)return null;if(o){if(!o.some(Array.isArray))return o;const l=o[e.length];if(l)return l}return e.map((l,u)=>c(n(u/e.length)))}function Iu(t){const{palette:e="ylGnBu",offset:n}=t,r=Ts(e),o=it[`interpolate${r}`];if(!o)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?c=>o(n(c)):o}}function y6(t,e){const{interpolate:n=Xl,nice:r=!1,tickCount:o=5}=e;return Object.assign(Object.assign({},e),{interpolate:n,nice:r,tickCount:o})}function og(t,e,n,r){if(r.padding!==void 0||r.paddingInner!==void 0||r.paddingOuter!==void 0)return Object.assign(Object.assign({},r),{unknown:NaN});const o=ag(t,e,n),{paddingInner:c=o,paddingOuter:l=o}=r;return Object.assign(Object.assign({},r),{paddingInner:c,paddingOuter:l,padding:o,unknown:NaN})}function ag(t,e,n){return e==="enterDelay"||e==="enterDuration"||e==="size"?0:t==="band"?Hb(n)?0:.1:t==="point"?.5:0}function Js(t,e){return e||(y5(t)?"point":"ordinal")}function Z_(t,e,n){return n||(t!=="color"||e?"linear":"sequential")}function sg(t,e){if(t.length===0)return t;const{domainMin:n,domainMax:r}=e,[o,c]=t;return[n!=null?n:o,r!=null?r:c]}function ji(t,e){const{zero:n=!1}=e;let r=1/0,o=-1/0;for(const c of t)for(const l of c)Hr(l)&&(r=Math.min(r,+l),o=Math.max(o,+l));return r===1/0?[]:n?[Math.min(0,r),o]:[r,o]}function p5(t){return Array.from(new Set(t.flat()))}function g5(t){return t.flat().sort()}function Ar(t){let e=1/0,n=-1/0;for(const r of t)for(const o of r)Hr(o)&&(e=Math.min(e,+o),n=Math.max(n,+o));return e===1/0?[]:[e<0?-n:e,n]}function v5(t,e){return t==="enterDelay"?[0,1e3]:t=="enterDuration"?[300,1e3]:t.startsWith("y")||t.startsWith("position")?[1,0]:t==="color"?[lE(e),yy(e)]:t==="opacity"?[0,1]:t==="size"?[1,10]:[0,1]}function qc(t){return cg(t,e=>{const n=typeof e;return n==="string"||n==="boolean"})}function Kc(t){return cg(t,e=>e instanceof Date)}function m5(t){return cg(t,As)}function cg(t,e){for(const n of t)if(n.some(e))return!0;return!1}function y5(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t.startsWith("size")}function b5(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t==="enterDelay"||t==="enterDuration"||t==="updateDelay"||t==="updateDuration"||t==="exitDelay"||t==="exitDuration"}function _5(t){if(!t||!t.type)return!1;if(typeof t.type=="function")return!0;const{type:e,domain:n,range:r,interpolator:o}=t,c=n&&n.length>0,l=r&&r.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(e)&&c&&l||["sequential"].includes(e)&&c&&(l||o)||["constant","identity"].includes(e)&&l)}const H_={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},V_={threshold:"threshold",quantize:"quantize",quantile:"quantile"},x5={ordinal:"ordinal",band:"band",point:"point"},S5={constant:"constant"};var ds=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function W_(t,e,n){const{coordinates:r=[],title:o}=e,[,c]=Kr("component",n),l=t.filter(({guide:p})=>p!==null),u=[],d=q_(e,t,n);if(u.push(...d),o){const{props:p}=c("title"),{defaultPosition:v,defaultOrientation:m,defaultOrder:b,defaultSize:x,defaultCrossPadding:S}=p,E=typeof o=="string"?{title:o}:o;u.push(Object.assign({type:"title",position:v,orientation:m,order:b,crossPadding:S[0],defaultSize:x},E))}return A5(l,r).forEach(([p,v])=>{const{props:m}=c(p),{defaultPosition:b,defaultPlane:x="xy",defaultOrientation:S,defaultSize:E,defaultOrder:w,defaultLength:M,defaultPadding:L=[0,0],defaultCrossPadding:I=[0,0]}=m,R=en({},...v),{guide:z,field:W}=R,Y=Array.isArray(z)?z:[z];for(const st of Y){const[xt,Nt]=C5(p,b,S,st,v,l,r);if(!xt&&!Nt)continue;const Ht=xt==="left"||xt==="right",dt=Ht?L[1]:L[0],Ot=Ht?I[1]:I[0],{size:bt,order:wt=w,length:oe=M,padding:Ut=dt,crossPadding:Kt=Ot}=st;u.push(Object.assign(Object.assign({title:W},st),{defaultSize:E,length:oe,position:xt,plane:x,orientation:Nt,padding:Ut,order:wt,crossPadding:Kt,size:bt,type:p,scales:v}))}}),u}function G_(t,e,n,r,o){const[c]=Kr("component",r),{scaleInstances:l,scale:u,bbox:d}=t,h=ds(t,["scaleInstances","scale","bbox"]),p={bbox:d,library:r};return c(h)({coordinate:e,library:r,markState:o,scales:l,theme:n,value:p,scale:u})}function Y_(t){return t.map(e=>{const n=en(e,e.style);return delete n.style,n})}function b6(t){return t.flatMap(e=>e.type=="group"?e.children:e)}function $_(t,e){const n=["left","right","bottom","top"];return tp(t,({type:c,position:l,group:u})=>n.includes(l)?u===void 0?c.startsWith("legend")?`legend-${l}`:Symbol("independent"):u==="independent"?Symbol("independent"):u:Symbol("independent")).flatMap(([,c])=>{if(c.length===1)return c[0];if(e!==void 0){const p=c.filter(S=>S.length!==void 0).map(S=>S.length),v=Vo(p);if(v>e)return c.forEach(S=>S.group=Symbol("independent")),c;const m=e-v,b=c.length-p.length,x=m/b;c.forEach(S=>{S.length===void 0&&(S.length=x)})}const l=Or(c,p=>p.size),u=Or(c,p=>p.order),d=Or(c,p=>p.crossPadding),h=c[0].position;return{type:"group",size:l,order:u,position:h,children:c,crossPadding:d}})}function O5(t,e){const n=["shape","size","color","opacity"],r=(m,b)=>m==="constant"&&b==="size",o=t.filter(({type:m,name:b})=>typeof m=="string"&&n.includes(b)&&!r(m,b)),c=o.filter(({type:m})=>m==="constant"),l=o.filter(({type:m})=>m!=="constant"),d=tp(l,m=>m.field?m.field:Symbol("independent")).map(([m,b])=>[m,[...b,...c]]).filter(([,m])=>m.some(b=>b.type!=="constant")),h=new Map(d);if(h.size===0)return[];const p=m=>m.sort(([b],[x])=>b.localeCompare(x));return Array.from(h).map(([,m])=>{const x=Ml(m).sort((S,E)=>E.length-S.length).map(S=>({combination:S,option:S.map(E=>[E.name,E5(E)])}));for(const{option:S,combination:E}of x)if(!S.every(w=>w[1]==="constant")&&S.every(w=>w[1]==="discrete"||w[1]==="constant"))return["legendCategory",E];for(const[S,E]of Ey)for(const{option:w,combination:M}of x)if(E.some(L=>xy(p(L),p(w))))return[S,M];return null}).filter(Hr)}function E5(t){const{type:e}=t;return typeof e!="string"?null:e in H_?"continuous":e in x5?"discrete":e in V_?"distribution":e in S5?"constant":null}function w5(t,e){return t.map(n=>{const{name:r}=n;if(Ub(e)||Hb(e)||Zc(e)&&(Da(e)||cs(e)))return null;if(r.startsWith("x"))return Da(e)?["axisArc",[n]]:cs(e)?["axisLinear",[n]]:[Zc(e)?"axisY":"axisX",[n]];if(r.startsWith("y"))return Da(e)?["axisLinear",[n]]:cs(e)?["axisArc",[n]]:[Zc(e)?"axisX":"axisY",[n]];if(r.startsWith("z"))return["axisZ",[n]];if(r.startsWith("position")){if(Vb(e))return["axisRadar",[n]];if(!Da(e))return["axisY",[n]]}return null}).filter(Hr)}function A5(t,e){const n=t.filter(r=>_5(r));return[...O5(n,e),...w5(n,e)]}function lg(t){const e=fa(t,"polar");if(e.length){const r=e[e.length-1],{startAngle:o,endAngle:c}=Oy(r);return[o,c]}const n=fa(t,"radial");if(n.length){const r=n[n.length-1],{startAngle:o,endAngle:c}=fp(r);return[o,c]}return[-Math.PI/2,Math.PI/2*3]}function X_(t){const e=/position(\d*)/g.exec(t);return e?+e[1]:null}function T5(t,e,n,r,o){const{name:c}=n[0];if(t==="axisRadar"){const l=r.filter(v=>v.name.startsWith("position")),u=X_(c);if(c===l.slice(-1)[0].name||u===null)return[null,null];const[d,h]=lg(o);return["center",(h-d)/(l.length-1)*u+d]}if(t==="axisY"&&Zb(o))return Zc(o)?["center","horizontal"]:["center","vertical"];if(t==="axisLinear"){const[l]=lg(o);return["center",l]}return t==="axisArc"?e[0]==="inner"?["inner",null]:["outer",null]:Da(o)?["center",null]:cs(o)?["center",null]:t==="axisX"&&KL(o)||t==="axisX"&&QL(o)?["top",null]:e}function C5(t,e,n,r,o,c,l){const[u]=lg(l),d=[r.position||e,u!=null?u:n];return typeof t=="string"&&t.startsWith("axis")?T5(t,d,o,c,l):typeof t=="string"&&t.startsWith("legend")&&Da(l)&&r.position==="center"?["center","vertical"]:d}function M5(t,e,n=[]){return t==="x"?Zc(n)?`${e}Y`:`${e}X`:t==="y"?Zc(n)?`${e}X`:`${e}Y`:null}function q_(t,e,n){const[,r]=Kr("component",n),{coordinates:o}=t;function c(l,u,d,h){const p=M5(u,l,o);if(!h||!p)return;const{props:v}=r(p),{defaultPosition:m,defaultSize:b,defaultOrder:x,defaultCrossPadding:[S]}=v;return Object.assign(Object.assign({position:m,defaultSize:b,order:x,type:p,crossPadding:S},h),{scales:[d]})}return e.filter(l=>l.slider||l.scrollbar).flatMap(l=>{const{slider:u,scrollbar:d,name:h}=l;return[c("slider",h,l,u),c("scrollbar",h,l,d)]}).filter(l=>!!l)}function K_(t,e,n,r,o,c){const{type:l}=t;if(!["left","right","bottom","top"].includes(r)||typeof l!="string")return;const d=l;return(d.startsWith("axis")?k5:d.startsWith("group")?L5:d.startsWith("legendContinuous")?Q_:d==="legendCategory"?D5:d.startsWith("slider")?R5:d==="title"?I5:d.startsWith("scrollbar")?P5:()=>{})(t,e,n,r,o,c)}function L5(t,e,n,r,o,c){const{children:l}=t,u=Or(l,h=>h.crossPadding);l.forEach(h=>h.crossPadding=u),l.forEach(h=>K_(h,e,n,r,o,c));const d=Or(l,h=>h.size);t.size=d,l.forEach(h=>h.size=d)}function P5(t,e,n,r,o,c){const{trackSize:l=6}=en({},o.scrollbar,t);t.size=l}function I5(t,e,n,r,o,c){const l=en({},o.title,t),{title:u,subtitle:d,spacing:h=0}=l,p=ds(l,["title","subtitle","spacing"]);if(u){const v=bn(p,"title"),m=Fd(u,v);t.size=m.height}if(d){const v=bn(p,"subtitle"),m=Fd(d,v);t.size+=h+m.height}}function R5(t,e,n,r,o,c){const l=()=>{const{slider:p}=o;return en({},p,t)},{trackSize:u,handleIconSize:d}=l(),h=Math.max(u,d*2.4);t.size=h}function k5(t,e,n,r,o,c){var l;t.transform=t.transform||[{type:"hide"}];const u=r==="left"||r==="right",d=J_(t,r,o),{tickLength:h=0,labelSpacing:p=0,titleSpacing:v=0,labelAutoRotate:m}=d,b=ds(d,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),x=Rd(t,c),S=kd(b,x),E=h+p;if(S&&S.length){const M=Or(S,I=>I.width),L=Or(S,I=>I.height);if(u)t.size=M+E;else{const{tickFilter:I,labelTransform:R}=t;e2(x,S,e,n,I)&&!R&&m!==!1&&m!==null?(t.labelTransform="rotate(90)",t.size=M+E):(t.labelTransform=(l=t.labelTransform)!==null&&l!==void 0?l:"rotate(0)",t.size=L+E)}}else t.size=h;const w=Dd(b);w&&(u?t.size+=v+w.width:t.size+=v+w.height)}function Q_(t,e,n,r,o,c){const u=(()=>{const{legendContinuous:I}=o;return en({},I,t)})(),{labelSpacing:d=0,titleSpacing:h=0}=u,p=ds(u,["labelSpacing","titleSpacing"]),v=r==="left"||r==="right",m=bn(p,"ribbon"),{size:b}=m,x=bn(p,"handleIcon"),{size:S}=x,E=Math.max(b,S*2.4);t.size=E;const w=Rd(t,c),M=kd(p,w);if(M){const I=v?"width":"height",R=Or(M,z=>z[I]);t.size+=R+d}const L=Dd(p);L&&(v?t.size=Math.max(t.size,L.width):t.size+=h+L.height)}function D5(t,e,n,r,o,c){const u=(()=>{const{legendCategory:Ot}=o,{title:bt}=t,[wt,oe]=Array.isArray(bt)?[bt,void 0]:[void 0,bt];return en({title:wt},Ot,Object.assign(Object.assign({},t),{title:oe}))})(),{itemSpacing:d,itemMarkerSize:h,titleSpacing:p,rowPadding:v,colPadding:m,maxCols:b=1/0,maxRows:x=1/0}=u,S=ds(u,["itemSpacing","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:E,length:w}=t,M=Ot=>Math.min(Ot,x),L=Ot=>Math.min(Ot,b),I=r==="left"||r==="right",R=w===void 0?e+(I?0:n[0]+n[1]):w,z=Dd(S),W=Rd(t,c),Y=kd(S,W,"itemLabel"),st=Math.max(Y[0].height,h)+v,xt=(Ot,bt=0)=>h+Ot+d[0]+bt;I?(()=>{let Ot=-1/0,bt=0,wt=1,oe=0,Ut=-1/0,Kt=-1/0;const me=z?z.height:0,Ee=R-me;for(const{width:Pe}of Y){const Ie=xt(Pe,m);Ot=Math.max(Ot,Ie),bt+st>Ee?(wt++,Ut=Math.max(Ut,oe),Kt=Math.max(Kt,bt),oe=1,bt=st):(bt+=st,oe++)}wt<=1&&(Ut=oe,Kt=bt),t.size=Ot*L(wt),t.length=Kt+me,en(t,{cols:L(wt),gridRow:Ut})})():typeof E=="number"?(()=>{const Ot=Math.ceil(Y.length/E),bt=Or(Y,wt=>xt(wt.width))*E;t.size=st*M(Ot)-v,t.length=Math.min(bt,R)})():(()=>{let Ot=1,bt=0,wt=-1/0;for(const{width:oe}of Y){const Ut=xt(oe,m);bt+Ut>R?(wt=Math.max(wt,bt),bt=Ut,Ot++):bt+=Ut}Ot===1&&(wt=bt),t.size=st*M(Ot)-v,t.length=wt})(),z&&(I?t.size=Math.max(t.size,z.width):t.size+=p+z.height)}function Rd(t,e){const[n]=Kr("scale",e),{scales:r,tickCount:o,tickMethod:c}=t,l=r.find(u=>u.type!=="constant"&&u.type!=="identity");return o!==void 0&&(l.tickCount=o),c!==void 0&&(l.tickMethod=c),n(l)}function kd(t,e,n="label"){const{labelFormatter:r,tickFilter:o,label:c=!0}=t,l=ds(t,["labelFormatter","tickFilter","label"]);if(!c)return null;const u=F5(e,r,o),d=bn(l,n),h=u.map((m,b)=>Object.fromEntries(Object.entries(d).map(([x,S])=>[x,typeof S=="function"?S(m,b):S]))),p=u.map((m,b)=>{const x=h[b];return Fd(m,x)});if(!h.some(m=>m.transform)){const m=u.map((b,x)=>x);t.indexBBox=new Map(m.map(b=>[b,[u[b],p[b]]]))}return p}function Dd(t){const e=h=>h===!1||h===null,{title:n}=t,r=ds(t,["title"]);if(e(n)||n===void 0)return null;const o=bn(r,"title"),{direction:c,transform:l}=o,u=Array.isArray(n)?n.join(","):n;return typeof u!="string"?null:Fd(u,Object.assign(Object.assign({},o),{transform:l||(c==="vertical"?"rotate(-90)":"")}))}function J_(t,e,n){const{title:r}=t,[o,c]=Array.isArray(r)?[r,void 0]:[void 0,r],{axis:l,[`axis${op(e)}`]:u}=n;return en({title:o},l,u,Object.assign(Object.assign({},t),{title:c}))}function t2(t,e){const n=t.getTicks?t.getTicks():t.getOptions().domain;return e?n.filter(e):n}function F5(t,e,n){const o=t2(t,n).map(l=>typeof l=="number"?Pl(l):l),c=e?typeof e=="string"?Xa(e):e:t.getFormatter?t.getFormatter():l=>`${l}`;return o.map(c)}function N5(t,e){return t.getBandWidth?t.getBandWidth(e)/2:0}function e2(t,e,n,r,o){if(Vo(e,b=>b.width)>n)return!0;const l=t.clone();l.update({range:[0,n]});const u=t2(t,o),d=u.map(b=>l.map(b)+N5(l,b)),h=u.map((b,x)=>x),p=-r[0],v=n+r[1],m=(b,x)=>{const{width:S}=x;return[b-S/2,b+S/2]};for(let b=0;b<h.length;b++){const x=d[b],[S,E]=m(x,e[b]);if(S<p||E>v)return!0;const w=d[b+1];if(w){const[M]=m(w,e[b+1]);if(E>M)return!0}}return!1}function Fd(t,e){const n=B5(t),{filter:r}=e,o=ds(e,["filter"]);return n.attr(Object.assign(Object.assign({},o),{visibility:"none"})),n.getBBox()}function B5(t){return t instanceof F.s$?t:new F.xv({style:{text:`${t}`}})}function So(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n>o||n===void 0&&o>=o)&&(n=o)}return n}function n2(t){const e=t.find(({type:o})=>o==="axisX"),n=t.find(({type:o})=>o==="axisY"),r=t.find(({type:o})=>o==="axisZ");e&&n&&r&&(e.plane="xy",n.plane="xy",r.plane="yz",r.origin=[e.bbox.x,e.bbox.y,0],r.eulerAngles=[0,-90,0],r.bbox.x=e.bbox.x,r.bbox.y=e.bbox.y,t.push(Object.assign(Object.assign({},e),{plane:"xz",showLabel:!1,showTitle:!1,origin:[e.bbox.x,e.bbox.y,0],eulerAngles:[-90,0,0]})),t.push(Object.assign(Object.assign({},n),{plane:"yz",showLabel:!1,showTitle:!1,origin:[n.bbox.x+n.bbox.width,n.bbox.y,0],eulerAngles:[0,-90,0]})),t.push(Object.assign(Object.assign({},r),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function j5(t,e,n,r){var o,c;const{width:l,height:u,depth:d,x:h=0,y:p=0,z:v=0,inset:m=(o=n.inset)!==null&&o!==void 0?o:0,insetLeft:b=m,insetTop:x=m,insetBottom:S=m,insetRight:E=m,margin:w=(c=n.margin)!==null&&c!==void 0?c:0,marginLeft:M=w,marginBottom:L=w,marginTop:I=w,marginRight:R=w,padding:z=n.padding,paddingBottom:W=z,paddingLeft:Y=z,paddingRight:st=z,paddingTop:xt=z}=U5(t,e,n,r),Nt=1/4,Ht=(xn,gn,Cn,kn,Bn)=>{const{marks:$n}=e;if($n.length===0)return[kn,Bn];if(xn-kn-Bn-xn*Nt>0)return[kn,Bn];const nr=xn*(1-Nt);return[gn==="auto"?nr*kn/(kn+Bn):kn,Cn==="auto"?nr*Bn/(kn+Bn):Bn]},dt=xn=>xn==="auto"?20:xn!=null?xn:20,Ot=dt(xt),bt=dt(W),wt=r2(t,u-Ot-bt,[Ot+I,bt+L],["left","right"],e,n,r),{paddingLeft:oe,paddingRight:Ut}=wt,Kt=l-M-R,[me,Ee]=Ht(Kt,Y,st,oe,Ut),Pe=Kt-me-Ee,Ie=r2(t,Pe,[me+M,Ee+R],["bottom","top"],e,n,r),{paddingTop:qe,paddingBottom:sn}=Ie,yn=u-L-I,[on,rn]=Ht(yn,W,xt,sn,qe),Rn=yn-on-rn;return{width:l,height:u,depth:d,insetLeft:b,insetTop:x,insetBottom:S,insetRight:E,innerWidth:Pe,innerHeight:Rn,paddingLeft:me,paddingRight:Ee,paddingTop:rn,paddingBottom:on,marginLeft:M,marginBottom:L,marginTop:I,marginRight:R,x:h,y:p,z:v}}function z5(t){const{height:e,width:n,padding:r=0,paddingLeft:o=r,paddingRight:c=r,paddingTop:l=r,paddingBottom:u=r,margin:d=16,marginLeft:h=d,marginRight:p=d,marginTop:v=d,marginBottom:m=d,inset:b=0,insetLeft:x=b,insetRight:S=b,insetTop:E=b,insetBottom:w=b}=t,M=R=>R==="auto"?20:R,L=n-M(o)-M(c)-h-p-x-S,I=e-M(l)-M(u)-v-m-E-w;return{width:L,height:I}}function U5(t,e,n,r){const{coordinates:o}=e;if(!Da(o)&&!cs(o))return e;const c=t.filter(w=>typeof w.type=="string"&&w.type.startsWith("axis"));if(c.length===0)return e;const l=c.map(w=>{const M=w.type==="axisArc"?"arc":"linear";return J_(w,M,n)}),u=Or(l,w=>{var M;return(M=w.labelSpacing)!==null&&M!==void 0?M:0}),d=c.flatMap((w,M)=>{const L=l[M],I=Rd(w,r);return kd(L,I)}).filter(Hr),h=Or(d,w=>w.height)+u,p=c.flatMap((w,M)=>{const L=l[M];return Dd(L)}).filter(w=>w!==null),v=p.length===0?0:Or(p,w=>w.height),{inset:m=h,insetLeft:b=m,insetBottom:x=m,insetTop:S=m+v,insetRight:E=m}=e;return Object.assign(Object.assign({},e),{insetLeft:b,insetBottom:x,insetTop:S,insetRight:E})}function r2(t,e,n,r,o,c,l){const u=Gr(t,x=>x.position),{padding:d=c.padding,paddingLeft:h=d,paddingRight:p=d,paddingBottom:v=d,paddingTop:m=d}=o,b={paddingBottom:v,paddingLeft:h,paddingTop:m,paddingRight:p};for(const x of r){const S=`padding${op(d0(x))}`,E=u.get(x)||[],w=b[S],M=st=>{st.size===void 0&&(st.size=st.defaultSize)},L=st=>{st.type==="group"?(st.children.forEach(M),st.size=Or(st.children,xt=>xt.size)):st.size=st.defaultSize},I=st=>{st.size||(w!=="auto"?L(st):(K_(st,e,n,x,c,l),M(st)))},R=st=>{st.type.startsWith("axis")&&st.labelAutoHide===void 0&&(st.labelAutoHide=!0)},z=x==="bottom"||x==="top",W=So(E,st=>st.order),Y=E.filter(st=>st.type.startsWith("axis")&&st.order==W);if(Y.length&&(Y[0].crossPadding=0),typeof w=="number")E.forEach(M),E.forEach(R);else if(E.length===0)b[S]=0;else{const st=z?e+n[0]+n[1]:e,xt=$_(E,st);xt.forEach(I);const Nt=xt.reduce((Ht,{size:dt,crossPadding:Ot=12})=>Ht+dt+Ot,0);b[S]=Nt}}return b}function Z5(t,e,n){const r=Gr(t,z=>`${z.plane||"xy"}-${z.position}`),{paddingLeft:o,paddingRight:c,paddingTop:l,paddingBottom:u,marginLeft:d,marginTop:h,marginBottom:p,marginRight:v,innerHeight:m,innerWidth:b,insetBottom:x,insetLeft:S,insetRight:E,insetTop:w,height:M,width:L,depth:I}=n,R={xy:ug({width:L,height:M,paddingLeft:o,paddingRight:c,paddingTop:l,paddingBottom:u,marginLeft:d,marginTop:h,marginBottom:p,marginRight:v,innerHeight:m,innerWidth:b,insetBottom:x,insetLeft:S,insetRight:E,insetTop:w}),yz:ug({width:I,height:M,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:I,innerHeight:M,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:ug({width:L,height:I,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:L,innerHeight:I,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[z,W]of r.entries()){const[Y,st]=z.split("-"),xt=R[Y][st],[Nt,Ht]=Ms(W,dt=>typeof dt.type!="string"?!1:!!(st==="center"||dt.type.startsWith("axis")&&["inner","outer"].includes(st)));Nt.length&&i2(Nt,e,xt,st),Ht.length&&o2(W,e,xt)}}function ug({width:t,height:e,paddingLeft:n,paddingRight:r,paddingTop:o,paddingBottom:c,marginLeft:l,marginTop:u,marginBottom:d,marginRight:h,innerHeight:p,innerWidth:v,insetBottom:m,insetLeft:b,insetRight:x,insetTop:S}){const E=n+l,w=o+u,M=r+h,L=c+d,I=t-l-h,R=[E+b,w+S,v-b-x,p-S-m,"center",null,null];return{top:[E,0,v,w,"vertical",!0,ci,l,I],right:[t-M,w,M,p,"horizontal",!1,ci],bottom:[E,e-L,v,L,"vertical",!1,ci,l,I],left:[0,w,E,p,"horizontal",!0,ci],"top-left":[E,0,v,w,"vertical",!0,ci],"top-right":[E,0,v,w,"vertical",!0,ci],"bottom-left":[E,e-L,v,L,"vertical",!1,ci],"bottom-right":[E,e-L,v,L,"vertical",!1,ci],center:R,inner:R,outer:R}}function i2(t,e,n,r){const[o,c]=Ms(t,l=>!!(typeof l.type=="string"&&l.type.startsWith("axis")));H5(o,e,n,r),a2(c,e,n)}function H5(t,e,n,r){r==="center"?dE(e)?q5(t,e,n,r):Pr(e)?G5(t,e,n):Rl(e)&&Y5(t,e,n,t[0].orientation):r==="inner"?V5(t,e,n):r==="outer"&&W5(t,e,n)}function V5(t,e,n){const[r,o,,c]=n,[l,u]=e.getCenter(),[d]=wf(e),h=c/2,p=d*h,v=l-p,m=u-p;for(let b=0;b<t.length;b++){const x=t[b];x.bbox={x:r+v,y:o+m,width:p*2,height:p*2}}}function W5(t,e,n){const[r,o,c,l]=n;for(const u of t)u.bbox={x:r,y:o,width:c,height:l}}function G5(t,e,n){const[r,o,c,l]=n;for(const u of t)u.bbox={x:r,y:o,width:c,height:l}}function Y5(t,e,n,r){r==="horizontal"?X5(t,e,n):r==="vertical"&&$5(t,e,n)}function $5(t,e,n){const[r,o,,c]=n,l=new Array(t.length).fill(0),d=e.map(l).filter((h,p)=>p%2===0).map(h=>h+r);for(let h=0;h<t.length;h++){const p=t[h],v=d[h],m=d[h+1]-v;p.bbox={x:v,y:o,width:m,height:c}}}function X5(t,e,n){const[r,o,c]=n,l=new Array(t.length).fill(0),d=e.map(l).filter((h,p)=>p%2===1).map(h=>h+o);for(let h=0;h<t.length;h++){const p=t[h],v=d[h],m=d[h+1]-v;p.bbox={x:r,y:v,width:c,height:m}}}function q5(t,e,n,r){const[o,c,l,u]=n;for(const d of t)d.bbox={x:o,y:c,width:l,height:u},d.radar={index:t.indexOf(d),count:t.length}}function o2(t,e,n){const[r,o,c,l,u,d,h,p,v]=n,[m,b,x,S,E,w,M,L]=u==="vertical"?["y",o,"x",r,"height",l,"width",c]:["x",r,"y",o,"width",c,"height",l];t.sort((st,xt)=>h==null?void 0:h(st.order,xt.order));const I=st=>st==="title"||st==="group"||st.startsWith("legend"),R=(st,xt,Nt)=>Nt===void 0?xt:I(st)?Nt:xt,z=(st,xt,Nt)=>Nt===void 0?xt:I(st)?Nt:xt,W=d?b+w:b;for(let st=0,xt=W;st<t.length;st++){const Nt=t[st],{crossPadding:Ht=0,type:dt}=Nt,{size:Ot}=Nt;Nt.bbox={[m]:d?xt-Ot-Ht:xt+Ht,[x]:z(dt,S,p),[E]:Ot,[M]:R(dt,L,v)},xt+=(Ot+Ht)*(d?-1:1)}const Y=t.filter(st=>st.type==="group");for(const st of Y){const{bbox:xt,children:Nt}=st,Ht=xt[M],dt=Ht/Nt.length,Ot=Nt.reduce((Kt,me)=>{var Ee;const Pe=(Ee=me.layout)===null||Ee===void 0?void 0:Ee.justifyContent;return Pe||Kt},"flex-start"),bt=Nt.map((Kt,me)=>{const{length:Ee=dt,padding:Pe=0}=Kt;return Ee+(me===Nt.length-1?0:Pe)}),wt=Vo(bt),oe=Ht-wt,Ut=Ot==="flex-start"?0:Ot==="center"?oe/2:oe;for(let Kt=0,me=xt[x]+Ut;Kt<Nt.length;Kt++){const Ee=Nt[Kt],{padding:Pe=0}=Ee,Ie=Kt===Nt.length-1?0:Pe;Ee.bbox={[E]:xt[E],[m]:xt[m],[x]:me,[M]:bt[Kt]-Ie},en(Ee,{layout:{justifyContent:Ot}}),me+=bt[Kt]}}}function a2(t,e,n){if(t.length===0)return;const[r,o,c,l]=n,[u]=wf(e),d=l/2*u/Math.sqrt(2),h=r+c/2,p=o+l/2;for(let v=0;v<t.length;v++){const m=t[v];m.bbox={x:h-d,y:p-d,width:d*2,height:d*2}}}function Yo(t,e,n={},r=!1){if(Lo(t)||Array.isArray(t)&&r)return t;const o=bn(t,e);return en(n,o)}function Ba(t,e={}){return Lo(t)||Array.isArray(t)||!fg(t)?t:en(e,t)}function fg(t){if(Object.keys(t).length===0)return!0;const{title:e,items:n}=t;return e!==void 0||n!==void 0}function ha(t,e){return typeof t=="object"?bn(t,e):t}var K5=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},Qc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Q5(t,e,n){const{encode:r={},scale:o={},transform:c=[]}=e,l=Qc(e,["encode","scale","transform"]);return[t,Object.assign(Object.assign({},l),{encode:r,scale:o,transform:c})]}function Jc(t,e,n){return K5(this,void 0,void 0,function*(){const{library:r}=n,{data:o}=e,[c]=Kr("data",r),l=Fu(o),{transform:u=[]}=l,p=[Qc(l,["transform"]),...u].map(b=>c(b,n)),v=yield eE(p)(o),m=o&&!Array.isArray(o)&&!Array.isArray(v)?{value:v}:v;return[Array.isArray(v)?Cs(v):[],Object.assign(Object.assign({},e),{data:m})]})}function Ru(t,e,n){const{encode:r}=e;if(!r)return[t,e];const o={};for(const[c,l]of Object.entries(r))if(Array.isArray(l))for(let u=0;u<l.length;u++){const d=`${c}${u===0?"":u}`;o[d]=l[u]}else o[c]=l;return[t,Object.assign(Object.assign({},e),{encode:o})]}function ku(t,e,n){const{encode:r,data:o}=e;if(!r)return[t,e];const c=Ho(r,l=>nT(l)?l:{type:_6(o,l),value:l});return[t,Object.assign(Object.assign({},e),{encode:c})]}function Du(t,e,n){const{encode:r}=e;if(!r)return[t,e];const o=Ho(r,(c,l)=>{const{type:u}=c;return u!=="constant"||b5(l)?c:Object.assign(Object.assign({},c),{constant:!0})});return[t,Object.assign(Object.assign({},e),{encode:o})]}function J5(t,e,n){const{encode:r,data:o}=e;if(!r)return[t,e];const{library:c}=n,l=l2(c),u=Ho(r,d=>l(o,d));return[t,Object.assign(Object.assign({},e),{encode:u})]}function s2(t,e,n){const{tooltip:r={}}=e;return Lo(r)?[t,e]:Array.isArray(r)?[t,Object.assign(Object.assign({},e),{tooltip:{items:r}})]:As(r)&&fg(r)?[t,Object.assign(Object.assign({},e),{tooltip:r})]:[t,Object.assign(Object.assign({},e),{tooltip:{items:[r]}})]}function dg(t,e,n){const{data:r,encode:o,tooltip:c={}}=e;if(Lo(c))return[t,e];const l=v=>{if(!v)return v;if(typeof v=="string")return t.map(m=>({name:v,value:r[m][v]}));if(As(v)){const{field:m,channel:b,color:x,name:S=m,valueFormatter:E=z=>z}=v,w=typeof E=="string"?Xa(E):E,M=b&&o[b],L=M&&o[b].field,I=S||L||b,R=[];for(const z of t){const W=m?r[z][m]:M?o[b].value[z]:null;R[z]={name:I,color:x,value:w(W)}}return R}if(typeof v=="function"){const m=[];for(const b of t){const x=v(r[b],b,r,o);As(x)?m[b]=x:m[b]={value:x}}return m}return v},{title:u,items:d=[]}=c,h=Qc(c,["title","items"]),p=Object.assign({title:l(u),items:Array.isArray(d)?d.map(l):[]},h);return[t,Object.assign(Object.assign({},e),{tooltip:p})]}function tT(t,e,n){const{encode:r}=e,o=Qc(e,["encode"]);if(!r)return[t,e];const c=Object.entries(r),l=c.filter(([,d])=>{const{value:h}=d;return Array.isArray(h[0])}).flatMap(([d,h])=>{const p=[[d,new Array(t.length).fill(void 0)]],{value:v}=h,m=Qc(h,["value"]);for(let b=0;b<v.length;b++){const x=v[b];if(Array.isArray(x))for(let S=0;S<x.length;S++){const E=p[S]||[`${d}${S}`,new Array(t).fill(void 0)];E[1][b]=x[S],p[S]=E}}return p.map(([b,x])=>[b,Object.assign({type:"column",value:x},m)])}),u=Object.fromEntries([...c,...l]);return[t,Object.assign(Object.assign({},o),{encode:u})]}function eT(t,e,n){const{axis:r={},legend:o={},slider:c={},scrollbar:l={}}=e,u=(h,p)=>{if(typeof h=="boolean")return h?{}:null;const v=h[p];return v===void 0||v?v:null},d=typeof r=="object"?Array.from(new Set(["x","y","z",...Object.keys(r)])):["x","y","z"];return en(e,{scale:Object.assign(Object.assign({},Object.fromEntries(d.map(h=>{const p=u(l,h);return[h,Object.assign({guide:u(r,h),slider:u(c,h),scrollbar:p},p&&{ratio:p.ratio===void 0?.5:p.ratio})]}))),{color:{guide:u(o,"color")},size:{guide:u(o,"size")},shape:{guide:u(o,"shape")},opacity:{guide:u(o,"opacity")}})}),[t,e]}function c2(t,e,n){const{animate:r}=e;return r||r===void 0?[t,e]:(en(e,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[t,e])}function nT(t){if(typeof t!="object"||t instanceof Date||t===null)return!1;const{type:e}=t;return Hr(e)}function _6(t,e){return typeof e=="function"?"transform":typeof e=="string"&&Nd(t,e)?"field":"constant"}function Nd(t,e){return Array.isArray(t)?t.some(n=>n[e]!==void 0):!1}function Fu(t){if((0,ne.Z)(t))return{type:"inline",value:t};if(!t)return{type:"inline",value:null};if(Array.isArray(t))return{type:"inline",value:t};const{type:e="inline"}=t,n=Qc(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}var hg=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},rT=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function iT(t,e,n){return hg(this,void 0,void 0,function*(){const[r,o]=yield x6(t,e,n),{encode:c,scale:l,data:u,tooltip:d}=o;if(Array.isArray(u)===!1)return null;const{channels:h}=e,p=bf(Object.entries(c).filter(([,m])=>Hr(m)),m=>m.map(([b,x])=>Object.assign({name:b},x)),([m])=>{var b;const x=(b=/([^\d]+)\d*$/.exec(m))===null||b===void 0?void 0:b[1],S=h.find(E=>E.name===x);return S!=null&&S.independent?m:x}),v=h.filter(m=>{const{name:b,required:x}=m;if(p.find(([S])=>S===b))return!0;if(x)throw new Error(`Missing encoding for channel: ${b}.`);return!1}).flatMap(m=>{const{name:b,scale:x,scaleKey:S,range:E,quantitative:w,ordinal:M}=m;return p.filter(([I])=>I.startsWith(b)).map(([I,R],z)=>{const W=R.some(wt=>wt.visual),Y=R.some(wt=>wt.constant),st=l[I]||{},{independent:xt=!1,key:Nt=S||I,type:Ht=Y?"constant":W?"identity":x}=st,dt=rT(st,["independent","key","type"]),Ot=Ht==="constant",bt=Ot?void 0:E;return{name:I,values:R,scaleKey:xt||Ot?Symbol("independent"):Nt,scale:Object.assign(Object.assign({type:Ht,range:bt},dt),{quantitative:w,ordinal:M})}})});return[o,Object.assign(Object.assign({},e),{index:r,channels:v,tooltip:d})]})}function l2(t){const[e]=Kr("encode",t);return(n,r)=>r===void 0||n===void 0?null:Object.assign(Object.assign({},r),{type:"column",value:e(r)(n),field:oT(r)})}function x6(t,e,n){return hg(this,void 0,void 0,function*(){const{library:r}=n,[o]=Kr("transform",r),{preInference:c=[],postInference:l=[]}=e,{transform:u=[]}=t,d=[Q5,Jc,Ru,ku,Du,J5,tT,c2,eT,s2,...c.map(o),...u.map(o),...l.map(o),dg];let h=[],p=t;for(const v of d)[h,p]=yield v(h,p,n);return[h,p]})}function oT(t){const{type:e,value:n}=t;return e==="field"&&typeof n=="string"?n:null}var No=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},ja=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function pg(t,e,n){var r;return No(this,void 0,void 0,function*(){const{library:o}=n,[c]=Kr("composition",o),[l]=Kr("interaction",o),u=new Set(Object.keys(o).map(dt=>{var Ot;return(Ot=/mark\.(.*)/.exec(dt))===null||Ot===void 0?void 0:Ot[1]}).filter(Hr)),d=new Set(Object.keys(o).map(dt=>{var Ot;return(Ot=/component\.(.*)/.exec(dt))===null||Ot===void 0?void 0:Ot[1]}).filter(Hr)),h=dt=>{const{type:Ot}=dt;if(typeof Ot=="function"){const{props:bt={}}=Ot,{composite:wt=!0}=bt;if(wt)return"mark"}return typeof Ot!="string"?Ot:u.has(Ot)||d.has(Ot)?"mark":Ot},p=dt=>h(dt)==="mark",v=dt=>h(dt)==="standardView",m=dt=>{const{type:Ot}=dt;return typeof Ot!="string"?!1:!!d.has(Ot)},b=dt=>{if(v(dt))return[dt];const Ot=h(dt);return c({type:Ot,static:m(dt)})(dt)},x=[],S=new Map,E=new Map,w=[t],M=[];for(;w.length;){const dt=w.shift();if(v(dt)){const Ot=E.get(dt),[bt,wt]=Ot?p2(Ot,dt,o):yield Bd(dt,n);S.set(bt,dt),x.push(bt);const oe=wt.flatMap(b).map(Ut=>zb(Ut,o));if(w.push(...oe),oe.every(v)){const Ut=yield Promise.all(oe.map(Kt=>h2(Kt,n)));u5(Ut);for(let Kt=0;Kt<oe.length;Kt++){const me=oe[Kt],Ee=Ut[Kt];E.set(me,Ee)}}}else{const Ot=p(dt)?dt:yield b2(dt,n),bt=b(Ot);Array.isArray(bt)?w.push(...bt):typeof bt=="function"&&M.push(bt())}}n.emitter.emit(Sr.BEFORE_PAINT);const L=new Map,I=new Map,R=[];e.selectAll(pa(Lt)).data(x,dt=>dt.key).join(dt=>dt.append("g").attr("className",Lt).attr("id",Ot=>Ot.key).call(u2).each(function(Ot,bt,wt){vg(Ot,Wn(wt),R,n),L.set(Ot,wt)}),dt=>dt.call(u2).each(function(Ot,bt,wt){vg(Ot,Wn(wt),R,n),I.set(Ot,wt)}),dt=>dt.each(function(Ot,bt,wt){const oe=wt.nameInteraction.values();for(const Ut of oe)Ut.destroy()}).remove());const z=(dt,Ot,bt)=>Array.from(dt.entries()).map(([wt,oe])=>{const Ut=bt||new Map,Kt=(Pe,Ie=qe=>qe)=>Ut.set(Pe,Ie),me=S.get(wt),Ee=S6(Wn(oe),me,n);return{view:wt,container:oe,options:me,setState:Kt,update:(Pe,Ie)=>No(this,void 0,void 0,function*(){const sn=ip(Array.from(Ut.values()))(me);return yield Ee(sn,Pe,()=>{(0,mi.Z)(Ie)&&Ot(dt,Ie,Ut)})})}}),W=(dt=I,Ot,bt)=>{var wt;const oe=z(dt,W,bt);for(const Ut of oe){const{options:Kt,container:me}=Ut,Ee=me.nameInteraction;let Pe=jd(Kt);Ot&&(Pe=Pe.filter(Ie=>Ot.includes(Ie[0])));for(const Ie of Pe){const[qe,sn]=Ie,yn=Ee.get(qe);if(yn&&((wt=yn.destroy)===null||wt===void 0||wt.call(yn)),sn){const rn=gg(Ut.view,qe,sn,l)(Ut,oe,n.emitter);Ee.set(qe,{destroy:rn})}}}},Y=z(L,W);for(const dt of Y){const{options:Ot}=dt,bt=new Map;dt.container.nameInteraction=bt;for(const wt of jd(Ot)){const[oe,Ut]=wt;if(Ut){const me=gg(dt.view,oe,Ut,l)(dt,Y,n.emitter);bt.set(oe,{destroy:me})}}}W();const{width:st,height:xt}=t,Nt=[];for(const dt of M){const Ot=new Promise(bt=>No(this,void 0,void 0,function*(){for(const wt of dt){const oe=Object.assign({width:st,height:xt},wt);yield pg(oe,e,n)}bt()}));Nt.push(Ot)}n.views=x,(r=n.animations)===null||r===void 0||r.forEach(dt=>dt==null?void 0:dt.cancel()),n.animations=R,n.emitter.emit(Sr.AFTER_PAINT);const Ht=R.filter(Hr).map(vT).map(dt=>dt.finished);return Promise.all([...Ht,...Nt])})}function u2(t){t.style("transform",e=>`translate(${e.layout.x}, ${e.layout.y})`)}function f2(t){const[,e]=Kr("interaction",t);return n=>{const[r,o]=n;try{return[r,e(r)]}catch(c){return[r,o.type]}}}function S6(t,e,n){const{library:r}=n,o=f2(r),c=d=>d[1]&&d[1].props&&d[1].props.reapplyWhenUpdate,u=jd(e).map(o).filter(c).map(d=>d[0]);return(d,h,p)=>No(this,void 0,void 0,function*(){const v=[],[m,b]=yield Bd(d,n);vg(m,t,v,n);for(const x of u.filter(S=>S!==h))d2(x,t,d,m,n);for(const x of b)pg(x,t,n);return p(),{options:d,view:m}})}function d2(t,e,n,r,o){var c;const{library:l}=o,[u]=Kr("interaction",l),h=e.node().nameInteraction,p=jd(n).find(([S])=>S===t),v=h.get(t);if(!v||((c=v.destroy)===null||c===void 0||c.call(v),!p[1]))return;const m=gg(r,t,p[1],u),b={options:n,view:r,container:e.node(),update:S=>Promise.resolve(S)},x=m(b,[],o.emitter);h.set(t,{destroy:x})}function Bd(t,e){return No(this,void 0,void 0,function*(){const{library:n}=e,r=yield sT(t,e),o=aT(r);t.interaction=o.interaction,t.coordinate=o.coordinate,t.marks=[...o.marks,...o.components];const c=zb(o,n),l=yield h2(c,e);return p2(l,c,n)})}function aT(t){const{coordinate:e={},interaction:n={},style:r={},marks:o}=t,c=ja(t,["coordinate","interaction","style","marks"]),l=o.map(m=>m.coordinate||{}),u=o.map(m=>m.interaction||{}),d=o.map(m=>m.viewStyle||{}),h=[...l,e].reduceRight((m,b)=>en(m,b),{}),p=[n,...u].reduce((m,b)=>en(m,b),{}),v=[...d,r].reduce((m,b)=>en(m,b),{});return Object.assign(Object.assign({},c),{marks:o,coordinate:h,interaction:p,style:v})}function sT(t,e){return No(this,void 0,void 0,function*(){const{library:n}=e,[r,o]=Kr("mark",n),c=new Set(Object.keys(n).map(b=>{var x;return(x=/component\.(.*)/.exec(b))===null||x===void 0?void 0:x[1]}).filter(Hr)),{marks:l}=t,u=[],d=[],h=[...l],{width:p,height:v}=z5(t),m={options:t,width:p,height:v};for(;h.length;){const[b]=h.splice(0,1),x=yield b2(b,e),{type:S=ws("G2Mark type is required."),key:E}=x;if(c.has(S))d.push(x);else{const{props:w={}}=o(S),{composite:M=!0}=w;if(!M)u.push(x);else{const{data:L}=x,I=Object.assign(Object.assign({},x),{data:L&&(Array.isArray(L)?L:L.value)}),R=yield r(I,m),z=Array.isArray(R)?R:[R];h.unshift(...z.map((W,Y)=>Object.assign(Object.assign({},W),{key:`${E}-${Y}`})))}}}return Object.assign(Object.assign({},t),{marks:u,components:d})})}function h2(t,e){return No(this,void 0,void 0,function*(){const{library:n}=e,[r]=Kr("theme",n),[,o]=Kr("mark",n),{theme:c,marks:l,coordinates:u=[]}=t,d=r(y2(c)),h=new Map;for(const v of l){const{type:m}=v,{props:b={}}=o(m),x=yield iT(v,b,e);if(x){const[S,E]=x;h.set(S,E)}}const p=Gr(Array.from(h.values()).flatMap(v=>v.channels),({scaleKey:v})=>v);for(const v of p.values()){const m=v.reduce((I,{scale:R})=>en(I,R),{}),{scaleKey:b}=v[0],{values:x}=v[0],S=Array.from(new Set(x.map(I=>I.field).filter(Hr))),E=en({guide:{title:S.length===0?void 0:S},field:S[0]},m),{name:w}=v[0],M=v.flatMap(({values:I})=>I.map(R=>R.value)),L=Object.assign(Object.assign({},Id(w,M,E,u,d,n)),{uid:Symbol("scale"),key:b});v.forEach(I=>I.scale=L)}return h})}function gg(t,e,n,r){const o=t.theme,c=typeof e=="string"?o[e]||{}:{};return r(en(c,Object.assign({type:e},n)))}function p2(t,e,n){var r;const[o]=Kr("mark",n),[c]=Kr("theme",n),[l]=Kr("labelTransform",n),{key:u,frame:d=!1,theme:h,clip:p,style:v={},labelTransform:m=[]}=e,b=c(y2(h)),x=Array.from(t.values()),S=Qs(x,e),E=Y_(W_(bT(Array.from(S),x,t),e,n)),w=j5(E,e,b,n),M=jb(w,e,n),L=d?en({mainLineWidth:1,mainStroke:"#000"},v):v;Z5($_(E),M,w),n2(E);const I=new Map(Array.from(t.values()).flatMap(Y=>{const{channels:st}=Y;return st.map(({scale:xt})=>[xt.uid,j_(xt,n)])}));f6(t,I);const R={};for(const Y of E){const{scales:st=[]}=Y,xt=[];for(const Nt of st){const{name:Ht,uid:dt}=Nt,Ot=(r=I.get(dt))!==null&&r!==void 0?r:j_(Nt,n);xt.push(Ot),Ht==="y"&&Ot.update(Object.assign(Object.assign({},Ot.getOptions()),{xScale:R.x})),Pu(R,{[Ht]:Ot})}Y.scaleInstances=xt}const z=[];for(const[Y,st]of t.entries()){const{children:xt,dataDomain:Nt,modifier:Ht,key:dt}=Y,{index:Ot,channels:bt,tooltip:wt}=st,oe=Object.fromEntries(bt.map(({name:xn,scale:gn})=>[xn,gn])),Ut=Ho(oe,({uid:xn})=>I.get(xn));Pu(R,Ut);const Kt=l5(bt,Ut),me=o(Y),[Ee,Pe,Ie]=uT(me(Ot,Ut,Kt,M)),qe=Nt||Ee.length,sn=Ht?Ht(Pe,qe,w):[],yn=xn=>{var gn,Cn;return(Cn=(gn=wt.title)===null||gn===void 0?void 0:gn[xn])===null||Cn===void 0?void 0:Cn.value},on=xn=>wt.items.map(gn=>gn[xn]),rn=Ee.map((xn,gn)=>{const Cn=Object.assign({points:Pe[gn],transform:sn[gn],index:xn,markKey:dt,viewKey:u},wt&&{title:yn(xn),items:on(xn)});for(const[kn,Bn]of Object.entries(Kt))Cn[kn]=Bn[xn],Ie&&(Cn[`series${Ts(kn)}`]=Ie[gn].map($n=>Bn[$n]));return Ie&&(Cn.seriesIndex=Ie[gn]),Ie&&wt&&(Cn.seriesItems=Ie[gn].map(kn=>on(kn)),Cn.seriesTitle=Ie[gn].map(kn=>yn(kn))),Cn});st.data=rn,st.index=Ee;const Rn=xt==null?void 0:xt(rn,Ut,w);z.push(...Rn||[])}return[{layout:w,theme:b,coordinate:M,markState:t,key:u,clip:p,scale:R,style:L,components:E,labelTransform:ip(m.map(l))},z]}function vg(t,e,n,r){return No(this,void 0,void 0,function*(){const{library:o}=r,{components:c,theme:l,layout:u,markState:d,coordinate:h,key:p,style:v,clip:m,scale:b}=t,{x,y:S,width:E,height:w}=u,M=ja(u,["x","y","width","height"]),L=["view","plot","main","content"],I=L.map((Ut,Kt)=>Kt),R=["a","margin","padding","inset"],z=L.map(Ut=>no(Object.assign({},l.view,v),Ut)),W=R.map(Ut=>bn(M,Ut)),Y=Ut=>Ut.style("x",Kt=>dt[Kt].x).style("y",Kt=>dt[Kt].y).style("width",Kt=>dt[Kt].width).style("height",Kt=>dt[Kt].height).each(function(Kt,me,Ee){_T(Wn(Ee),z[Kt])});let st=0,xt=0,Nt=E,Ht=w;const dt=I.map(Ut=>{const Kt=W[Ut],{left:me=0,top:Ee=0,bottom:Pe=0,right:Ie=0}=Kt;return st+=me,xt+=Ee,Nt-=me+Ie,Ht-=Ee+Pe,{x:st,y:xt,width:Nt,height:Ht}});e.selectAll(pa(yt)).data(I.filter(Ut=>Hr(z[Ut])),Ut=>L[Ut]).join(Ut=>Ut.append("rect").attr("className",yt).style("zIndex",-2).call(Y),Ut=>Ut.call(Y),Ut=>Ut.remove());const Ot=hT(d),bt=Ot?{duration:Ot[1]}:!1;for(const[,Ut]of tp(c,Kt=>`${Kt.type}-${Kt.position}`))Ut.forEach((Kt,me)=>Kt.index=me);const wt=e.selectAll(pa(Ft)).data(c,Ut=>`${Ut.type}-${Ut.position}-${Ut.index}`).join(Ut=>Ut.append("g").style("zIndex",({zIndex:Kt})=>Kt||-1).attr("className",Ft).append(Kt=>G_(en({animate:bt,scale:b},Kt),h,l,o,d)),Ut=>Ut.transition(function(Kt,me,Ee){const{preserve:Pe=!1}=Kt;if(Pe)return;const Ie=G_(en({animate:bt,scale:b},Kt),h,l,o,d),{attributes:qe}=Ie,[sn]=Ee.childNodes;return sn.update(qe,!1)})).transitions();n.push(...wt.flat().filter(Hr));const oe=e.selectAll(pa(nt)).data([u],()=>p).join(Ut=>Ut.append("rect").style("zIndex",0).style("fill","transparent").attr("className",nt).call(_2).call(S2,Array.from(d.keys())).call(bg,m),Ut=>Ut.call(S2,Array.from(d.keys())).call(Kt=>Ot?yT(Kt,Ot):_2(Kt)).call(bg,m)).transitions();n.push(...oe.flat());for(const[Ut,Kt]of d.entries()){const{data:me}=Kt,{key:Ee,class:Pe,type:Ie}=Ut,qe=e.select(`#${Ee}`),sn=m2(Ut,Kt,t,r),yn=hs(Ut,Kt,t,o),on=mT(Ut,Kt,t,o),rn=tl(Ut,Kt,t,o),Rn=pT(e,qe,Pe,"element"),xn=qe.selectAll(pa(Oe)).selectFacetAll(Rn).data(me,gn=>gn.key,gn=>gn.groupKey).join(gn=>gn.append(sn).attr("className",Oe).attr("markType",Ie).transition(function(Cn,kn,Bn){return yn(Cn,[Bn])}),gn=>gn.call(Cn=>{const kn=Cn.parent(),Bn=ay($n=>{const[vr,Xn]=$n.getBounds().min;return[vr,Xn]});Cn.transition(function($n,vr,Xn){gT(Xn,kn,Bn);const nr=sn($n,vr),ni=on($n,[Xn],[nr]);return ni!==null||(Xn.nodeName===nr.nodeName&&nr.nodeName!=="g"?ap(Xn,nr):(Xn.parentNode.replaceChild(nr,Xn),nr.className=Oe,nr.markType=Ie,nr.__data__=Xn.__data__)),ni}).attr("markType",Ie).attr("className",Oe)}),gn=>gn.each(function(Cn,kn,Bn){Bn.__removed__=!0}).transition(function(Cn,kn,Bn){return rn(Cn,[Bn])}).remove(),gn=>gn.append(sn).attr("className",Oe).attr("markType",Ie).transition(function(Cn,kn,Bn){const{__fromElements__:$n}=Bn,vr=on(Cn,$n,[Bn]);return new di($n,null,Bn.parentNode).transition(vr).remove(),vr}),gn=>gn.transition(function(Cn,kn,Bn){const vr=new di([],Bn.__toData__,Bn.parentNode).append(sn).attr("className",Oe).attr("markType",Ie).nodes();return on(Cn,[Bn],vr)}).remove()).transitions();n.push(...xn.flat())}cT(t,e,n,o,r)})}function cT(t,e,n,r,o){const[c]=Kr("labelTransform",r),{markState:l,labelTransform:u}=t,d=e.select(pa(zt)).node(),h=new Map,p=new Map,v=Array.from(l.entries()).flatMap(([E,w])=>{const{labels:M=[],key:L}=E,I=dT(E,w,t,r,o),R=e.select(`#${L}`).selectAll(pa(Oe)).nodes().filter(z=>!z.__removed__);return M.flatMap((z,W)=>{const{transform:Y=[]}=z,st=ja(z,["transform"]);return R.flatMap(xt=>{const Nt=lT(st,W,xt);return Nt.forEach(Ht=>{h.set(Ht,I),p.set(Ht,z)}),Nt})})}),m=Wn(d).selectAll(pa(he)).data(v,E=>E.key).join(E=>E.append(w=>h.get(w)(w)).attr("className",he),E=>E.each(function(w,M,L){const R=h.get(w)(w);ap(L,R)}),E=>E.remove()).nodes(),b=Gr(m,E=>p.get(E.__data__)),{coordinate:x}=t,S={canvas:o.canvas,coordinate:x};for(const[E,w]of b){const{transform:M=[]}=E;ip(M.map(c))(w,S)}u&&u(m,S)}function lT(t,e,n){const{seriesIndex:r,seriesKey:o,points:c,key:l,index:u}=n.__data__,d=g2(n);if(!r)return[Object.assign(Object.assign({},t),{key:`${l}-${e}`,bounds:d,index:u,points:c,dependentElement:n})];const h=fT(t),p=r.map((v,m)=>Object.assign(Object.assign({},t),{key:`${o[m]}-${e}`,bounds:[c[m]],index:v,points:c,dependentElement:n}));return h?h(p):p}function uT([t,e,n]){if(n)return[t,e,n];const r=[],o=[];for(let c=0;c<t.length;c++){const l=t[c],u=e[c];u.every(([d,h])=>Hr(d)&&Hr(h))&&(r.push(l),o.push(u))}return[r,o]}function fT(t){const{selector:e}=t;if(!e)return null;if(typeof e=="function")return e;if(e==="first")return n=>[n[0]];if(e==="last")return n=>[n[n.length-1]];throw new Error(`Unknown selector: ${e}`)}function g2(t){const e=t.cloneNode(),n=t.getAnimations();e.style.visibility="hidden",n.forEach(l=>{const u=l.effect.getKeyframes();e.attr(u[u.length-1])}),t.parentNode.appendChild(e);const r=e.getLocalBounds();e.destroy();const{min:o,max:c}=r;return[o,c]}function dT(t,e,n,r,o){const[c]=Kr("shape",r),{data:l,encode:u}=t,{data:d,defaultLabelShape:h}=e,p=d.map(S=>S.points),v=Ho(u,S=>S.value),{theme:m,coordinate:b}=n,x=Object.assign(Object.assign({},o),{document:D0(o),theme:m,coordinate:b});return S=>{const{index:E,points:w}=S,M=l[E],{formatter:L=oe=>`${oe}`,transform:I,style:R,render:z}=S,W=ja(S,["formatter","transform","style","render"]),Y=Ho(Object.assign(Object.assign({},W),R),oe=>v2(oe,M,E,l,{channel:v})),{shape:st=h,text:xt}=Y,Nt=ja(Y,["shape","text"]),Ht=typeof L=="string"?Xa(L):L,dt=Object.assign(Object.assign({},Nt),{text:Ht(xt,M,E,l),datum:M}),Ot=Object.assign({type:`label.${st}`,render:z},Nt),bt=c(Ot,x),wt=mg(m,"label",st,"label");return bt(w,dt,wt,p)}}function v2(t,e,n,r,o){return typeof t=="function"?t(e,n,r,o):typeof t!="string"?t:As(e)&&e[t]!==void 0?e[t]:t}function hT(t){let e=-1/0,n=1/0;for(const[r,o]of t){const{animate:c={}}=r,{data:l}=o,{enter:u={},update:d={},exit:h={}}=c,{type:p,duration:v=300,delay:m=0}=d,{type:b,duration:x=300,delay:S=0}=u,{type:E,duration:w=300,delay:M=0}=h;for(const L of l){const{updateType:I=p,updateDuration:R=v,updateDelay:z=m,enterType:W=b,enterDuration:Y=x,enterDelay:st=S,exitDuration:xt=w,exitDelay:Nt=M,exitType:Ht=E}=L;(I===void 0||I)&&(e=Math.max(e,R+z),n=Math.min(n,z)),(Ht===void 0||Ht)&&(e=Math.max(e,xt+Nt),n=Math.min(n,Nt)),(W===void 0||W)&&(e=Math.max(e,Y+st),n=Math.min(n,st))}}return e===-1/0?null:[n,e-n]}function pT(t,e,n,r){return t.node().parentElement.findAll(c=>c.style.facet!==void 0&&c.style.facet===n&&c!==e.node()).flatMap(c=>c.getElementsByClassName(r))}function gT(t,e,n){if(!t.__facet__)return;const r=t.parentNode.parentNode,o=e.parentNode,[c,l]=n(r),[u,d]=n(o),h=`translate(${c-u}, ${l-d})`;bL(t,h),e.append(t)}function m2(t,e,n,r){const{library:o}=r,[c]=Kr("shape",o),{data:l,encode:u}=t,{defaultShape:d,data:h,shape:p}=e,v=Ho(u,M=>M.value),m=h.map(M=>M.points),{theme:b,coordinate:x}=n,{type:S,style:E={}}=t,w=Object.assign(Object.assign({},r),{document:D0(r),coordinate:x,theme:b});return M=>{const{shape:L=d}=E,{shape:I=L,points:R,seriesIndex:z,index:W}=M,Y=ja(M,["shape","points","seriesIndex","index"]),st=Object.assign(Object.assign({},Y),{index:W}),xt=z?z.map(bt=>l[bt]):l[W],Nt=z||W,Ht=Ho(E,bt=>v2(bt,xt,Nt,l,{channel:v})),dt=p[I]?p[I](Ht,w):c(Object.assign(Object.assign({},Ht),{type:x2(t,I)}),w),Ot=mg(b,S,I,d);return dt(R,st,Ot,m)}}function mg(t,e,n,r){if(typeof e!="string")return;const{color:o}=t,c=t[e]||{},l=c[n]||c[r];return Object.assign({color:o},l)}function yg(t,e,n,r,o){var c,l;const[,u]=Kr("shape",o),[d]=Kr("animation",o),{defaultShape:h,shape:p}=n,{theme:v,coordinate:m}=r,x=`default${Ts(t)}Animation`,{[x]:S}=((c=p[h])===null||c===void 0?void 0:c.props)||u(x2(e,h)).props,{[t]:E={}}=v,w=((l=e.animate)===null||l===void 0?void 0:l[t])||{},M={coordinate:m};return(L,I,R)=>{const{[`${t}Type`]:z,[`${t}Delay`]:W,[`${t}Duration`]:Y,[`${t}Easing`]:st}=L,xt=Object.assign({type:z||S},w);if(!xt.type)return null;const dt=d(xt,M)(I,R,en(E,{delay:W,duration:Y,easing:st}));return Array.isArray(dt)?dt:[dt]}}function hs(t,e,n,r){return yg("enter",t,e,n,r)}function vT(t){return t.finished.then(()=>{t.cancel()}),t}function mT(t,e,n,r){return yg("update",t,e,n,r)}function tl(t,e,n,r){return yg("exit",t,e,n,r)}function y2(t={}){if(typeof t=="string")return{type:t};const{type:e="light"}=t,n=ja(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}function jd(t){const e={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:n={}}=t;return Object.entries(en(e,n)).reverse()}function b2(t,e){return No(this,void 0,void 0,function*(){const{data:n}=t,r=ja(t,["data"]);if(n==null)return t;const[,{data:o}]=yield Jc([],{data:n},e);return Object.assign({data:o},r)})}function _2(t){t.style("transform",e=>`translate(${e.paddingLeft+e.marginLeft}, ${e.paddingTop+e.marginTop})`).style("width",e=>e.innerWidth).style("height",e=>e.innerHeight)}function yT(t,e){const[n,r]=e;t.transition(function(o,c,l){const{transform:u,width:d,height:h}=l.style,{paddingLeft:p,paddingTop:v,innerWidth:m,innerHeight:b,marginLeft:x,marginTop:S}=o,E=[{transform:u,width:d,height:h},{transform:`translate(${p+x}, ${v+S})`,width:m,height:b}];return l.animate(E,{delay:n,duration:r,fill:"both"})})}function x2(t,e){const{type:n}=t;return typeof e=="string"?`${n}.${e}`:e}function S2(t,e){const n=c=>c.class!==void 0?`${c.class}`:"";t.nodes().length===0||(t.selectAll(pa(Tt)).data(e,c=>c.key).join(c=>c.append("g").attr("className",Tt).attr("id",l=>l.key).style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),c=>c.style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),c=>c.remove()),t.select(pa(zt)).node())||t.append("g").attr("className",zt).style("zIndex",0)}function pa(...t){return t.map(e=>`.${e}`).join("")}function bg(t,e){t.node()&&t.style("clipPath",n=>{if(!e)return null;const{paddingTop:r,paddingLeft:o,marginLeft:c,marginTop:l,innerWidth:u,innerHeight:d}=n;return new F.UL({style:{x:o+c,y:r+l,width:u,height:d}})})}function bT(t,e,n){var r;for(const[h]of n.entries())if(h.type==="cell")return t.filter(p=>p.name!=="shape");if(e.length!==1||t.some(h=>h.name==="shape"))return t;const{defaultShape:o}=e[0];if(!["point","line","rect","hollow"].includes(o))return t;const l={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},d={field:((r=t.find(h=>h.name==="color"))===null||r===void 0?void 0:r.field)||null,name:"shape",type:"constant",domain:[],range:[l[o]]};return[...t,d]}function _T(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function xT(...t){return e=>t.reduce((n,r)=>r(n),e)}function ST(t){const{style:e,scale:n,type:r}=t,o={},c=hr(e,"columnWidthRatio");return c&&r==="interval"&&(o.x=Object.assign(Object.assign({},n==null?void 0:n.x),{padding:1-c})),Object.assign(Object.assign({},t),{scale:Object.assign(Object.assign({},n),o)})}function zd(t){const e=O2(t);return e.children&&Array.isArray(e.children)&&(e.children=e.children.map(n=>zd(n))),e}function O2(t){return xT(ST)(t)}function _g(t){const e=en({},t),n=new Map([[e,null]]),r=new Map([[null,-1]]),o=[e];for(;o.length;){const c=o.shift();if(c.key===void 0){const u=n.get(c),d=r.get(c),h=u===null?"0":`${u.key}-${d}`;c.key=h}const{children:l=[]}=c;if(Array.isArray(l))for(let u=0;u<l.length;u++){const d=en({},l[u]);l[u]=d,n.set(d,c),r.set(d,u),o.push(d)}}return e}function Yi(t,e){const n=new YO;return n.registerPlugin(new $O),new F.Xz({width:t,height:e,container:document.createElement("div"),renderer:n})}function OT(t,e={},n=()=>{},r=o=>{throw o}){const{width:o=640,height:c=480,depth:l=0}=t,u=zd(t),d=_g(u),{canvas:h=Yi(o,c),emitter:p=new ie,library:v}=e;e.canvas=h,e.emitter=p;const{width:m,height:b}=h.getConfig();(m!==o||b!==c)&&h.resize(o,c),p.emit(Sr.BEFORE_RENDER);const x=Wn(h.document.documentElement);return h.ready.then(()=>pg(Object.assign(Object.assign({},d),{width:o,height:c,depth:l}),x,e)).then(()=>{if(l){const[S,E]=h.document.documentElement.getPosition();h.document.documentElement.setPosition(S,E,-l/2)}h.requestAnimationFrame(()=>{p.emit(Sr.AFTER_RENDER),n==null||n()})}).catch(S=>{r==null||r(S)}),ET(h.getConfig().container)}function O6(t,e={},n=()=>{},r=o=>{throw o}){var o;const{width:c=640,height:l=480}=t,u=_g(t),{group:d=new Group,emitter:h=new EventEmitter,library:p}=e;d!=null&&d.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const v=select(d);return e.group=d,e.emitter=h,e.canvas=e.canvas||((o=d==null?void 0:d.ownerDocument)===null||o===void 0?void 0:o.defaultView),h.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},u),{width:c,height:l}),v,e).then(()=>{var m;(m=e.canvas)===null||m===void 0||m.requestAnimationFrame(()=>{h.emit(ChartEvent.AFTER_RENDER),n==null||n()})}).catch(m=>{r==null||r(m)}),d}function xg(t,e={},n=!1){const{canvas:r,emitter:o}=e;r&&(el(r),n?r.destroy():r.destroyChildren()),o.off()}function el(t){const e=t.getRoot().querySelectorAll(`.${Lt}`);e==null||e.forEach(n=>{const{nameInteraction:r=new Map}=n;(r==null?void 0:r.size)>0&&Array.from(r==null?void 0:r.values()).forEach(o=>{o==null||o.destroy()})})}function ET(t){return typeof t=="string"?document.getElementById(t):t}const tc=t=>t?parseInt(t):0;function wT(t){const e=getComputedStyle(t),n=t.clientWidth||tc(e.width),r=t.clientHeight||tc(e.height),o=tc(e.paddingLeft)+tc(e.paddingRight),c=tc(e.paddingTop)+tc(e.paddingBottom);return{width:n-o,height:r-c}}function Sg(t){const{height:e,width:n,padding:r=0,paddingLeft:o=r,paddingRight:c=r,paddingTop:l=r,paddingBottom:u=r,margin:d=0,marginLeft:h=d,marginRight:p=d,marginTop:v=d,marginBottom:m=d,inset:b=0,insetLeft:x=b,insetRight:S=b,insetTop:E=b,insetBottom:w=b}=t,M=R=>R==="auto"?20:R,L=n-M(o)-M(c)-h-p-x-S,I=e-M(l)-M(u)-v-m-E-w;return{width:L,height:I}}function Og(t,e){const n=[t];for(;n.length;){const r=n.shift();e&&e(r);const o=r.children||[];for(const c of o)n.push(c)}}class ec{constructor(e={},n){this.parentNode=null,this.children=[],this.index=0,this.type=n,this.value=e}map(e=n=>n){const n=e(this.value);return this.value=n,this}attr(e,n){return arguments.length===1?this.value[e]:this.map(r=>(r[e]=n,r))}append(e){const n=new e({});return n.children=[],this.push(n),n}push(e){return e.parentNode=this,e.index=this.children.length,this.children.push(e),this}remove(){const e=this.parentNode;if(e){const{children:n}=e,r=n.findIndex(o=>o===this);n.splice(r,1)}return this}getNodeByKey(e){let n=null;return Og(this,o=>{e===o.attr("key")&&(n=o)}),n}getNodesByType(e){const n=[];return Og(this,o=>{e===o.type&&n.push(o)}),n}getNodeByType(e){let n=null;return Og(this,r=>{n||e===r.type&&(n=r)}),n}call(e,...n){return e(this.map(),...n),this}getRoot(){let e=this;for(;e&&e.parentNode;)e=e.parentNode;return e}}var Eg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Ud=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title","interaction"],wg="__remove__",Vr="__callback__",E2=1,Ag=1;function E6(t){if(t===void 0){const e=document.createElement("div");return e[wg]=!0,e}return typeof t=="string"?document.getElementById(t):t}function w6(t){const e=t.parentNode;e&&e.removeChild(t)}function w2(t){if(t.type!==null)return t;const e=t.children[t.children.length-1];for(const n of Ud)e.attr(n,t.attr(n));return e}function Tg(t){return Object.assign(Object.assign({},t.value),{type:t.type})}function A2(t,e){const{width:n,height:r,autoFit:o,depth:c=0}=t;let l=640,u=480;if(o){const{width:d,height:h}=wT(e);l=d||l,u=h||u}return l=n||l,u=r||u,{width:Math.max((0,ne.Z)(l)?l:E2,E2),height:Math.max((0,ne.Z)(u)?u:Ag,Ag),depth:c}}function ar(t){const e=w2(t),n=[e],r=new Map;for(r.set(e,Tg(e));n.length;){const o=n.pop(),c=r.get(o),{children:l=[]}=o;for(const u of l)if(u.type===Vr)c.children=u.value;else{const d=Tg(u),{children:h=[]}=c;h.push(d),n.push(u),r.set(u,d),c.children=h}}return r.get(e)}function T2(t,e){return typeof t=="function"?!0:new Set(Object.keys(e)).has(t)}function A6(t,e){return typeof t!="function"&&new Set(Object.keys(e)).has(t)}function Bo(t,e,n,r,o){const{type:c}=t,{type:l=n||c}=e;if(A6(l,o)){for(const u of Ud)t.attr(u)!==void 0&&e[u]===void 0&&(e[u]=t.attr(u));return e}if(T2(l,r)){const u={type:"view"},d=Object.assign({},e);for(const h of Ud)d[h]!==void 0&&(u[h]=d[h],delete d[h]);return Object.assign(Object.assign({},u),{children:[d]})}return e}function Nu(t,e,n){if(typeof t=="function")return e.mark;const o=Object.assign(Object.assign({},e),n)[t];if(!o)throw new Error(`Unknown mark: ${t}.`);return o}function Zd(t,e,n){if(typeof t=="function"){const d=new ec;return d.value=t,d.type=Vr,d}const{type:r,children:o}=t,c=Eg(t,["type","children"]),l=Nu(r,e,n),u=new l;return u.value=c,u.type=r,u}function C2(t,e){const{type:n,children:r}=e,o=Eg(e,["type","children"]);t.type===n||n===void 0?cy(t.value,o):typeof n=="string"&&(t.type=n,t.value=o)}function Bu(t,e,n,r){if(!t)return;const o=[[t,e]];for(;o.length;){const[c,l]=o.shift(),u=Zd(l,n,r);Array.isArray(c.children)&&c.push(u);const{children:d}=l;if(Array.isArray(d))for(const h of d)o.push([u,h]);else typeof d=="function"&&o.push([u,d])}}function Hd(t,e,n,r,o){const c=Bo(t,e,n,r,o),l=[[null,t,c]];for(;l.length;){const[u,d,h]=l.shift();if(!d)Bu(u,h,r,o);else if(!h)d.remove();else{C2(d,h);const{children:p}=h,{children:v}=d;if(Array.isArray(p)&&Array.isArray(v)){const m=Math.max(p.length,v.length);for(let b=0;b<m;b++){const x=p[b],S=v[b];l.push([d,S,x])}}else typeof p=="function"&&l.push([d,null,p])}}}function M2(){let t,e;return[new Promise((r,o)=>{e=r,t=o}),e,t]}function T6(t,e,{key:n=e}){t.prototype[e]=function(r){return arguments.length===0?this.attr(n):this.attr(n,r)}}function AT(t,e,{key:n=e}){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(n);if(Array.isArray(r))return this.attr(n,r);const o=[...this.attr(n)||[],r];return this.attr(n,o)}}function ju(t,e,{key:n=e}){t.prototype[e]=function(r,o){if(arguments.length===0)return this.attr(n);if(arguments.length===1&&typeof r!="string")return this.attr(n,r);const c=this.attr(n)||{};return c[r]=arguments.length===1?!0:o,this.attr(n,c)}}function zu(t,e,n){t.prototype[e]=function(r){if(arguments.length===0)return this.attr(e);if(Array.isArray(r))return this.attr(e,{items:r});if(As(r)&&(r.title!==void 0||r.items!==void 0))return this.attr(e,r);if(r===null||r===!1)return this.attr(e,r);const o=this.attr(e)||{},{items:c=[]}=o;return c.push(r),o.items=c,this.attr(e,o)}}function Uu(t,e,{ctor:n}){t.prototype[e]=function(r){const o=this.append(n);return e==="mark"&&(o.type=r),o}}function Cg(t,e,{ctor:n}){t.prototype[e]=function(){return this.type=null,this.append(n)}}function Zu(t){return e=>{for(const[n,r]of Object.entries(t)){const{type:o}=r;o==="value"?T6(e,n,r):o==="array"?AT(e,n,r):o==="object"?ju(e,n,r):o==="node"?Uu(e,n,r):o==="container"?Cg(e,n,r):o==="mix"&&zu(e,n,r)}return e}}function Mg(t){return Object.fromEntries(Object.entries(t).map(([e,n])=>[e,{type:"node",ctor:n}]))}const Lg={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},L2=Object.assign(Object.assign({},Lg),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),Pg=Object.assign(Object.assign({},Lg),{labelTransform:{type:"array"}});var Ir=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c};let Ig=class extends ec{changeData(e){var n;const r=this.getRoot();if(r)return this.attr("data",e),!((n=this.children)===null||n===void 0)&&n.length&&this.children.forEach(o=>{o.attr("data",e)}),r==null?void 0:r.render()}getView(){const e=this.getRoot(),{views:n}=e.getContext();if(n!=null&&n.length)return n.find(r=>r.key===this._key)}getScale(){var e;return(e=this.getView())===null||e===void 0?void 0:e.scale}getScaleByChannel(e){const n=this.getScale();if(n)return n[e]}getCoordinate(){var e;return(e=this.getView())===null||e===void 0?void 0:e.coordinate}getTheme(){var e;return(e=this.getView())===null||e===void 0?void 0:e.theme}getGroup(){const e=this._key;return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}show(){const e=this.getGroup();e&&!e.isVisible()&&T0(e)}hide(){const e=this.getGroup();e&&e.isVisible()&&kb(e)}};Ig=Ir([Zu(Pg)],Ig);var C6=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c};let Vd=class extends ec{changeData(e){const n=this.getRoot();if(n)return this.attr("data",e),n==null?void 0:n.render()}getMark(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(!n)return;const{markState:r}=n,o=Array.from(r.keys()).find(c=>c.key===this.attr("key"));return r.get(o)}getScale(){var e;const n=(e=this.getRoot())===null||e===void 0?void 0:e.getView();if(n)return n==null?void 0:n.scale}getScaleByChannel(e){var n,r;const o=(n=this.getRoot())===null||n===void 0?void 0:n.getView();if(o)return(r=o==null?void 0:o.scale)===null||r===void 0?void 0:r[e]}getGroup(){const e=this.attr("key");return e?this.getRoot().getContext().canvas.getRoot().getElementById(e):void 0}};Vd=C6([Zu(L2)],Vd);var TT=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},Wd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const nc="G2_CHART_KEY";class P2 extends Ig{constructor(e){const{container:n,canvas:r,renderer:o,plugins:c,lib:l,createCanvas:u}=e,d=Wd(e,["container","canvas","renderer","plugins","lib","createCanvas"]);super(d,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=Kh(()=>{this.forceFit()},300),this._renderer=o||new YO,this._plugins=c||[],this._container=E6(n),this._emitter=new ie,this._context={library:Object.assign(Object.assign({},l),zm),emitter:this._emitter,canvas:r,createCanvas:u},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._context.canvas.getConfig().supportsCSSTransform=!0,this._bindAutoFit(),this._rendering=!0;const e=new Promise((c,l)=>OT(this._computedOptions(),this._context,this._createResolve(c),this._createReject(l))),[n,r,o]=M2();return e.then(r).catch(o).then(()=>this._renderTrailing()),n}options(e){if(arguments.length===0)return ar(this);const{type:n}=e;return n&&(this._previousDefinedType=n),Hd(this,e,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(e,n,r){return this._emitter.on(e,n,r),this}once(e,n){return this._emitter.once(e,n),this}emit(e,...n){return this._emitter.emit(e,...n),this}off(e,n){return this._emitter.off(e,n),this}clear(){const e=this.options();this.emit(Sr.BEFORE_CLEAR),this._reset(),xg(e,this._context,!1),this.emit(Sr.AFTER_CLEAR)}destroy(){const e=this.options();this.emit(Sr.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),xg(e,this._context,!0),this._container[wg]&&w6(this._container),this.emit(Sr.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:e,height:n}=A2(this.options(),this._container);if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(Sr.BEFORE_CHANGE_SIZE);const r=this.render();return r.then(()=>{this.emit(Sr.AFTER_CHANGE_SIZE)}),r}changeSize(e,n){if(e===this._width&&n===this._height)return Promise.resolve(this);this.emit(Sr.BEFORE_CHANGE_SIZE),this.attr("width",e),this.attr("height",n);const r=this.render();return r.then(()=>{this.emit(Sr.AFTER_CHANGE_SIZE)}),r}_create(){const{library:e}=this._context,n=c=>c.startsWith("mark.")||c==="component.axisX"||c==="component.axisY"||c==="component.legends",r=["mark.mark",...Object.keys(e).filter(n)];this._marks={};for(const c of r){const l=c.split(".").pop();class u extends Vd{constructor(){super({},l)}}this._marks[l]=u,this[l]=function(d){const h=this.append(u);return l==="mark"&&(h.type=d),h}}const o=["composition.view",...Object.keys(e).filter(c=>c.startsWith("composition.")&&c!=="composition.mark")];this._compositions=Object.fromEntries(o.map(c=>{const l=c.split(".").pop();let u=class extends Ig{constructor(){super({},l)}};return u=TT([Zu(Mg(this._marks))],u),[l,u]}));for(const c of Object.values(this._compositions))Zu(Mg(this._compositions))(c);for(const c of o){const l=c.split(".").pop();this[l]=function(){const u=this._compositions[l];return this.type=null,this.append(u)}}}_reset(){const e=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([n])=>n.startsWith("margin")||n.startsWith("padding")||n.startsWith("inset")||e.includes(n))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const e=this._trailingResolve.bind(this);this._trailingResolve=null,e(this)}).catch(e=>{const n=this._trailingReject.bind(this);this._trailingReject=null,n(e)}))}_createResolve(e){return()=>{this._rendering=!1,e(this)}}_createReject(e){return n=>{this._rendering=!1,e(n)}}_computedOptions(){const e=this.options(),{key:n=nc}=e,{width:r,height:o,depth:c}=A2(e,this._container);return this._width=r,this._height=o,this._key=n,Object.assign(Object.assign({key:this._key},e),{width:r,height:o,depth:c})}_createCanvas(){const{width:e,height:n}=A2(this.options(),this._container);this._plugins.push(new $O),this._plugins.forEach(r=>this._renderer.registerPlugin(r)),this._context.canvas=new F.Xz({container:this._container,width:e,height:n,renderer:this._renderer})}_addToTrailing(){var e;return(e=this._trailingResolve)===null||e===void 0||e.call(this,this),this._trailing=!0,new Promise((r,o)=>{this._trailingResolve=r,this._trailingReject=o})}_bindAutoFit(){const e=this.options(),{autoFit:n}=e;if(this._hasBindAutoFit){n||this._unbindAutoFit();return}n&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function I2(t,e){class n extends t{constructor(o){super(Object.assign(Object.assign({},o),{lib:e}))}}return n}var CT=Object.prototype.hasOwnProperty,Hu=function(t,e){if(t===null||!Ya(t))return{};var n={};return Vp(e,function(r){CT.call(t,r)&&(n[r]=t[r])}),n};function MT(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Vu(t,e,n,r,o){for(var c=t.children,l,u=-1,d=c.length,h=t.value&&(r-e)/t.value;++u<d;)l=c[u],l.y0=n,l.y1=o,l.x0=e,l.x1=e+=l.value*h}function M6(){var t=1,e=1,n=0,r=!1;function o(l){var u=l.height+1;return l.x0=l.y0=n,l.x1=t,l.y1=e/u,l.eachBefore(c(e,u)),r&&l.eachBefore(MT),l}function c(l,u){return function(d){d.children&&Vu(d,d.x0,l*(d.depth+1)/u,d.x1,l*(d.depth+2)/u);var h=d.x0,p=d.y0,v=d.x1-n,m=d.y1-n;v<h&&(h=v=(h+v)/2),m<p&&(p=m=(p+m)/2),d.x0=h,d.y0=p,d.x1=v,d.y1=m}}return o.round=function(l){return arguments.length?(r=!!l,o):r},o.size=function(l){return arguments.length?(t=+l[0],e=+l[1],o):[t,e]},o.padding=function(l){return arguments.length?(n=+l,o):n},o}var R2=k(9783);function nl(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function LT(){return this.eachAfter(nl)}var Rg=k(64599);function Wu(t,e){var n=-1,r=Rg(this),o;try{for(r.s();!(o=r.n()).done;){var c=o.value;t.call(e,c,++n,this)}}catch(l){r.e(l)}finally{r.f()}return this}function PT(t,e){for(var n=this,r=[n],o,c,l=-1;n=r.pop();)if(t.call(e,n,++l,this),o=n.children)for(c=o.length-1;c>=0;--c)r.push(o[c]);return this}function IT(t,e){for(var n=this,r=[n],o=[],c,l,u,d=-1;n=r.pop();)if(o.push(n),c=n.children)for(l=0,u=c.length;l<u;++l)r.push(c[l]);for(;n=o.pop();)t.call(e,n,++d,this);return this}function k2(t,e){var n=-1,r=Rg(this),o;try{for(r.s();!(o=r.n()).done;){var c=o.value;if(t.call(e,c,++n,this))return c}}catch(l){r.e(l)}finally{r.f()}}function L6(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,o=r&&r.length;--o>=0;)n+=r[o].value;e.value=n})}function Gd(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function kg(t){for(var e=this,n=P6(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var o=r.length;t!==n;)r.splice(o,0,t),t=t.parent;return r}function P6(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),o=null;for(t=n.pop(),e=r.pop();t===e;)o=t,t=n.pop(),e=r.pop();return o}function RT(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function I6(){return Array.from(this)}function kT(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function R6(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}var D2=k(15009),Yd=D2().mark(DT);function DT(){var t,e,n,r,o,c;return D2().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=this,n=[t];case 1:e=n.reverse(),n=[];case 2:if(!(t=e.pop())){u.next=8;break}return u.next=5,t;case 5:if(r=t.children)for(o=0,c=r.length;o<c;++o)n.push(r[o]);u.next=2;break;case 8:if(n.length){u.next=1;break}case 9:case"end":return u.stop()}},Yd,this)}function Gu(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=BT)):e===void 0&&(e=NT);for(var n=new rl(t),r,o=[n],c,l,u,d;r=o.pop();)if((l=e(r.data))&&(d=(l=Array.from(l)).length))for(r.children=l,u=d-1;u>=0;--u)o.push(c=l[u]=new rl(l[u])),c.parent=r,c.depth=r.depth+1;return n.eachBefore(F2)}function FT(){return Gu(this).eachBefore(jT)}function NT(t){return t.children}function BT(t){return Array.isArray(t)?t[1]:null}function jT(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function F2(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function rl(t){this.data=t,this.depth=this.height=0,this.parent=null}rl.prototype=Gu.prototype=R2({constructor:rl,count:LT,each:Wu,eachAfter:IT,eachBefore:PT,find:k2,sum:L6,sort:Gd,path:kg,ancestors:RT,descendants:I6,leaves:kT,links:R6,copy:FT},Symbol.iterator,DT);function Dg(t,e){for(var n in e)e.hasOwnProperty(n)&&n!=="constructor"&&e[n]!==void 0&&(t[n]=e[n])}function N2(t,e,n,r){return e&&Dg(t,e),n&&Dg(t,n),r&&Dg(t,r),t}const B2={field:"value",size:[1,1],round:!1,padding:0,sort:(t,e)=>e.value-t.value,as:["x","y"],ignoreParentValue:!0},ho="nodeIndex",Yu="childNodeCount",zT="nodeAncestor",Fg="Invalid field: it must be a string!";function UT(t,e){const{field:n,fields:r}=t;if((0,gt.Z)(n))return n;if((0,mi.Z)(n))return console.warn(Fg),n[0];if(console.warn(`${Fg} will try to get fields instead.`),(0,gt.Z)(r))return r;if((0,mi.Z)(r)&&r.length)return r[0];if(e)return e;throw new TypeError(Fg)}function ZT(t){const e=[];if(t&&t.each){let n,r;t.each(o=>{var c,l;o.parent!==n?(n=o.parent,r=0):r+=1;const u=O0((((c=o.ancestors)===null||c===void 0?void 0:c.call(o))||[]).map(d=>e.find(h=>h.name===d.name)||d),({depth:d})=>d>0&&d<o.depth);o[zT]=u,o[Yu]=((l=o.children)===null||l===void 0?void 0:l.length)||0,o[ho]=r,e.push(o)})}else t&&t.eachNode&&t.eachNode(n=>{e.push(n)});return e}function HT(t,e){e=N2({},B2,e);const n=e.as;if(!(0,mi.Z)(n)||n.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let r;try{r=UT(e)}catch(d){console.warn(d)}const c=(d=>M6().size(e.size).round(e.round).padding(e.padding)(Gu(d).sum(h=>su(h.children)?e.ignoreParentValue?0:h[r]-Wp(h.children,(p,v)=>p+v[r],0):h[r]).sort(e.sort)))(t),l=n[0],u=n[1];return c.each(d=>{var h,p;d[l]=[d.x0,d.x1,d.x1,d.x0],d[u]=[d.y1,d.y1,d.y0,d.y0],d.name=d.name||((h=d.data)===null||h===void 0?void 0:h.name)||((p=d.data)===null||p===void 0?void 0:p.label),d.data.name=d.name,["x0","x1","y0","y1"].forEach(v=>{n.indexOf(v)===-1&&delete d[v]})}),ZT(c)}var VT=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const rc="sunburst",Ng="markType",k6="value",j2="path",$u="ancestor-node";function WT(t){const{data:e,encode:n}=t,{color:r,value:o}=n,l=HT(e,{field:o,type:"hierarchy.partition",as:["x","y"]}),u=[];return l.forEach(d=>{var h,p,v,m;if(d.depth===0)return null;let b=d.data.name;const x=[b];let S=Object.assign({},d);for(;S.depth>1;)b=`${(h=S.parent.data)===null||h===void 0?void 0:h.name} / ${b}`,x.unshift((p=S.parent.data)===null||p===void 0?void 0:p.name),S=S.parent;const E=Object.assign(Object.assign(Object.assign({},Hu(d.data,[o])),{[j2]:b,[$u]:S.data.name}),d);r&&r!==$u&&(E[r]=d.data[r]||((m=(v=d.parent)===null||v===void 0?void 0:v.data)===null||m===void 0?void 0:m[r])),u.push(E)}),u.map(d=>{const h=d.x.slice(0,2),p=[d.y[2],d.y[0]];return h[0]===h[1]&&(p[0]=p[1]=(d.y[2]+d.y[0])/2),Object.assign(Object.assign({},d),{x:h,y:p,fillOpacity:Math.pow(.85,d.depth)})})}const z2={id:rc,encode:{x:"x",y:"y",key:j2,color:$u,value:"value"},axis:{x:!1,y:!1},style:{[Ng]:rc,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[Yu]:Yu,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},U2=t=>{const{encode:e,data:n=[],legend:r}=t,o=VT(t,["encode","data","legend"]),c=Object.assign(Object.assign({},o.coordinate),{innerRadius:Math.max(hr(o,["coordinate","innerRadius"],.2),1e-5)}),l=Object.assign(Object.assign({},z2.encode),e),{value:u}=l,d=WT({encode:l,data:n});return console.log(d,"rectData"),[en({},z2,Object.assign(Object.assign({type:"rect",data:d,encode:l,tooltip:{title:"path",items:[h=>({name:u,value:h[u]})]}},o),{coordinate:c}))]};U2.props={};var GT=Object.keys?function(t){return Object.keys(t)}:function(t){var e=[];return Vp(t,function(n,r){lo(t)&&r==="prototype"||e.push(r)}),e},Bg=GT,YT=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const $T=t=>t.querySelectorAll(".element").filter(e=>hr(e,["style",Ng])===rc);function D6(t){return Wn(t).select(`.${nt}`).node()}const Z2={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function XT(t={}){const{breadCrumb:e={},isFixedColor:n=!1}=t,r=en({},Z2,e);return o=>{const{update:c,setState:l,container:u,view:d,options:h}=o,p=u.ownerDocument,v=D6(u),m=h.marks.find(({id:L})=>L===rc),{state:b}=m,x=p.createElement("g");v.appendChild(x);const S=(L,I)=>YT(this,void 0,void 0,function*(){if(x.removeChildren(),L){const R=p.createElement("text",{style:Object.assign({x:0,text:r.rootText,depth:0},r.style)});x.appendChild(R);let z="";const W=L==null?void 0:L.split(" / ");let Y=r.style.y,st=x.getBBox().width;const xt=v.getBBox().width,Nt=W.map((Ht,dt)=>{const Ot=p.createElement("text",{style:Object.assign(Object.assign({x:st,text:" / "},r.style),{y:Y})});x.appendChild(Ot),st+=Ot.getBBox().width,z=`${z}${Ht} / `;const bt=p.createElement("text",{name:z.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:Ht,x:st,depth:dt+1},r.style),{y:Y})});return x.appendChild(bt),st+=bt.getBBox().width,st>xt&&(Y=x.getBBox().height,st=0,Ot.attr({x:st,y:Y}),st+=Ot.getBBox().width,bt.attr({x:st,y:Y}),st+=bt.getBBox().width),bt});[R,...Nt].forEach((Ht,dt)=>{if(dt===Nt.length)return;const Ot=Object.assign({},Ht.attributes);Ht.attr("cursor","pointer"),Ht.addEventListener("mouseenter",()=>{Ht.attr(r.active)}),Ht.addEventListener("mouseleave",()=>{Ht.attr(Ot)}),Ht.addEventListener("click",()=>{S(Ht.name,hr(Ht,["style","depth"]))})})}l("drillDown",R=>{const{marks:z}=R,W=z.map(Y=>{if(Y.id!==rc&&Y.type!=="rect")return Y;const{data:st}=Y,xt=Object.fromEntries(["color"].map(Ht=>[Ht,{domain:d.scale[Ht].getOptions().domain}])),Nt=st.filter(Ht=>{const dt=Ht.path;return n||(Ht[$u]=dt.split(" / ")[I]),L?new RegExp(`^${L}.+`).test(dt):!0});return en({},Y,n?{data:Nt,scale:xt}:{data:Nt})});return Object.assign(Object.assign({},R),{marks:W})}),yield c()}),E=L=>{const I=L.target;if(hr(I,["style",Ng])!==rc||hr(I,["markType"])!=="rect"||!hr(I,["style",Yu]))return;const R=hr(I,["__data__","key"]),z=hr(I,["style","depth"]);I.style.cursor="pointer",S(R,z)};v.addEventListener("click",E);const w=Bg(Object.assign(Object.assign({},b.active),b.inactive)),M=()=>{$T(v).forEach(I=>{const R=hr(I,["style",Yu]);if(hr(I,["style","cursor"])!=="pointer"&&R){I.style.cursor="pointer";const W=Hu(I.attributes,w);I.addEventListener("mouseenter",()=>{I.attr(b.active)}),I.addEventListener("mouseleave",()=>{I.attr(en(W,b.inactive))})}})};return v.addEventListener("mousemove",M),()=>{x.remove(),v.removeEventListener("click",E),v.removeEventListener("mousemove",M)}}}function jg(){return{"interaction.drillDown":XT,"mark.sunburst":U2}}const qT=()=>[["cartesian"]];qT.props={};const zg=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];zg.props={transform:!0};const KT=(t={})=>{const e={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},e),t)},Ug=t=>{const{startAngle:e,endAngle:n,innerRadius:r,outerRadius:o}=KT(t);return[...zg(),...Ll({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};Ug.props={};const Zg=()=>[["parallel",0,1,0,1]];Zg.props={};const H2=({focusX:t=0,focusY:e=0,distortionX:n=2,distortionY:r=2,visual:o=!1})=>[["fisheye",t,e,n,r,o]];H2.props={transform:!0};const V2=t=>{const{startAngle:e=-Math.PI/2,endAngle:n=Math.PI*3/2,innerRadius:r=0,outerRadius:o=1}=t;return[...Zg(),...Ll({startAngle:e,endAngle:n,innerRadius:r,outerRadius:o})]};V2.props={};const W2=({value:t})=>e=>e.map(()=>t);W2.props={};const G2=({value:t})=>e=>e.map(n=>n[t]);G2.props={};const Y2=({value:t})=>e=>e.map(t);Y2.props={};const QT=({value:t})=>()=>t;QT.props={};function Wr(t,e){if(t!==null)return{type:"column",value:t,field:e}}function il(t,e){const n=Wr(t,e);return Object.assign(Object.assign({},n),{inferred:!0})}function $d(t,e){if(t!==null)return{type:"column",value:t,field:e,visual:!0}}function JT(t,e){const n=Wr(t,e);return Object.assign(Object.assign({},n),{constant:!1})}function za(t,e){const n=[];for(const r of t)n[r]=e;return n}function pr(t,e){const n=t[e];if(!n)return[null,null];const{value:r,field:o=null}=n;return[r,o]}function Xu(t,...e){for(const n of e)if(typeof n=="string"){const[r,o]=pr(t,n);if(r!==null)return[r,o]}else return[n,null];return[null,null]}function ol(t){return t instanceof Date?!1:typeof t=="object"}const qu=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;return r!==void 0?[t,e]:[t,en({},e,{encode:{y1:il(za(t,0))}})]};qu.props={};const ic=()=>(t,e)=>{const{encode:n}=e,{x:r}=n;return r!==void 0?[t,e]:[t,en({},e,{encode:{x:il(za(t,0))},scale:{x:{guide:null}}})]};ic.props={};const ps=(t,e)=>pd(Object.assign({colorAttribute:"fill"},t),e);ps.props=Object.assign(Object.assign({},pd.props),{defaultMarker:"square"});const Xd=(t,e)=>pd(Object.assign({colorAttribute:"stroke"},t),e);Xd.props=Object.assign(Object.assign({},pd.props),{defaultMarker:"hollowSquare"});function al(){}function Hg(t){this._context=t}Hg.prototype={areaStart:al,areaEnd:al,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function qd(t){return new Hg(t)}var $2=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function tC(t,e,n){const[r,o,c,l]=t;if(Yr(n)){const h=[e?e[0][0]:o[0],o[1]],p=[e?e[3][0]:c[0],c[1]];return[r,h,p,l]}const u=[o[0],e?e[0][1]:o[1]],d=[c[0],e?e[3][1]:c[1]];return[r,u,d,l]}const Vg=(t,e)=>{const{adjustPoints:n=tC}=t,r=$2(t,["adjustPoints"]),{coordinate:o,document:c}=e;return(l,u,d,h)=>{const{index:p}=u,{color:v}=d,m=$2(d,["color"]),b=h[p+1],x=n(l,b,o),S=!!Yr(o),[E,w,M,L]=S?id(x):x,{color:I=v,opacity:R}=u,z=Us().curve(qd)([E,w,M,L]);return Wn(c.createElement("path",{})).call(Fn,m).style("d",z).style("fill",I).style("fillOpacity",R).call(Fn,r).node()}};Vg.props={defaultMarker:"square"};function X2(t,e,n){const[r,o,c,l]=t;if(Yr(n)){const h=[e?e[0][0]:(o[0]+c[0])/2,o[1]],p=[e?e[3][0]:(o[0]+c[0])/2,c[1]];return[r,h,p,l]}const u=[o[0],e?e[0][1]:(o[1]+c[1])/2],d=[c[0],e?e[3][1]:(o[1]+c[1])/2];return[r,u,d,l]}const Wg=(t,e)=>Vg(Object.assign({adjustPoints:X2},t),e);Wg.props={defaultMarker:"square"};function sl(t){return Math.abs(t)>10?String(t):t.toString().padStart(2,"0")}function eC(t){const e=t.getFullYear(),n=sl(t.getMonth()+1),r=sl(t.getDate()),o=`${e}-${n}-${r}`,c=t.getHours(),l=t.getMinutes(),u=t.getSeconds();return c||l||u?`${o} ${sl(c)}:${sl(l)}:${sl(u)}`:o}const Kd=(t={})=>{const{channel:e="x"}=t;return(n,r)=>{const{encode:o}=r,{tooltip:c}=r;if(Lo(c))return[n,r];const{title:l}=c;if(l!==void 0)return[n,r];const u=Object.keys(o).filter(h=>h.startsWith(e)).filter(h=>!o[h].inferred).map(h=>pr(o,h)).filter(([h])=>h).map(h=>h[0]);if(u.length===0)return[n,r];const d=[];for(const h of n)d[h]={value:u.map(p=>p[h]instanceof Date?eC(p[h]):p[h]).join(", ")};return[n,en({},r,{tooltip:{title:d}})]}};Kd.props={};const Qd=t=>{const{channel:e}=t;return(n,r)=>{const{encode:o,tooltip:c}=r;if(Lo(c))return[n,r];const{items:l=[]}=c;if(!l||l.length>0)return[n,r];const d=(Array.isArray(e)?e:[e]).flatMap(h=>Object.keys(o).filter(p=>p.startsWith(h)).map(p=>{const{field:v,value:m,inferred:b=!1,aggregate:x}=o[p];return b?null:x&&m?{channel:p}:v?{field:v}:m?{channel:p}:null}).filter(p=>p!==null));return[n,en({},r,{tooltip:{items:d}})]}};Qd.props={};var nC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Gg=()=>(t,e)=>{const{encode:n}=e,{key:r}=n,o=nC(n,["key"]);if(r!==void 0)return[t,e];const c=Object.values(o).map(({value:u})=>u),l=t.map(u=>c.filter(Array.isArray).map(d=>d[u]).join("-"));return[t,en({},e,{encode:{key:Wr(l)}})]};Gg.props={};function Yg(t={}){const{shapes:e}=t;return[{name:"color"},{name:"opacity"},{name:"shape",range:e},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function Pi(t={}){return[...Yg(t),{name:"title",scale:"identity"}]}function rC(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function Ua(){return[{type:Kd,channel:"color"},{type:Qd,channel:["x","y"]}]}function cl(){return[{type:Kd,channel:"x"},{type:Qd,channel:["y"]}]}function $g(){return[{type:Kd,channel:"color"},{type:Qd,channel:["position"]}]}function ll(t={}){return Yg(t)}function li(){return[{type:Gg}]}function hi(){return[]}function Xg(t,e){return t.getBandWidth(t.invert(e))}function oc(t,e,n={}){const{x:r,y:o,series:c}=e,{x:l,y:u,series:d}=t,{style:{bandOffset:h=d?0:.5,bandOffsetX:p=h,bandOffsetY:v=h}={}}=n,m=!!(l!=null&&l.getBandWidth),b=!!(u!=null&&u.getBandWidth),x=!!(d!=null&&d.getBandWidth);return!m&&!b?S=>S:(S,E)=>{const w=m?Xg(l,r[E]):0,M=b?Xg(u,o[E]):0,I=x&&c?(Xg(d,c[E])/2+ +c[E])*w:0,[R,z]=S;return[R+p*w+I,z+v*M]}}function Jd(t){return parseFloat(t)/100}function qg(t,e,n,r){const{x:o,y:c}=n,{innerWidth:l,innerHeight:u}=r.getOptions(),d=Array.from(t,h=>{const p=o[h],v=c[h],m=typeof p=="string"?Jd(p)*l:+p,b=typeof v=="string"?Jd(v)*u:+v;return[[m,b]]});return[t,d]}function ga(t){return typeof t=="function"?t:e=>e[t]}function Kg(t,e){return Array.from(t,ga(e))}function Qg(t,e){const{source:n=p=>p.source,target:r=p=>p.target,value:o=p=>p.value}=e,{links:c,nodes:l}=t,u=Kg(c,n),d=Kg(c,r),h=Kg(c,o);return{links:c.map((p,v)=>({target:d[v],source:u[v],value:h[v]})),nodes:l||Array.from(new Set([...u,...d]),p=>({key:p}))}}function q2(t,e){return t.getBandWidth(t.invert(e))}const K2={rect:ps,hollow:Xd,funnel:Vg,pyramid:Wg},Q2=()=>(t,e,n,r)=>{const{x:o,y:c,y1:l,series:u,size:d}=n,h=e.x,p=e.series,[v]=r.getSize(),m=d?d.map(S=>+S/v):null,b=d?(S,E,w)=>{const M=S+E/2,L=m[w];return[M-L/2,M+L/2]}:(S,E,w)=>[S,S+E],x=Array.from(t,S=>{const E=q2(h,o[S]),w=p?q2(p,u==null?void 0:u[S]):1,M=E*w,L=(+(u==null?void 0:u[S])||0)*E,I=+o[S]+L,[R,z]=b(I,M,S),W=+c[S],Y=+l[S];return[[R,W],[z,W],[z,Y],[R,Y]].map(dt=>r.map(dt))});return[t,x]};Q2.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:K2,channels:[...Pi({shapes:Object.keys(K2)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...li(),{type:qu},{type:ic}],postInference:[...hi(),...cl()],interaction:{shareTooltip:!0}};const J2={rect:ps,hollow:Xd},tx=()=>(t,e,n,r)=>{const{x:o,x1:c,y:l,y1:u}=n,d=Array.from(t,h=>{const p=[+o[h],+l[h]],v=[+c[h],+l[h]],m=[+c[h],+u[h]],b=[+o[h],+u[h]];return[p,v,m,b].map(x=>r.map(x))});return[t,d]};tx.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:J2,channels:[...Pi({shapes:Object.keys(J2)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li(),{type:qu}],postInference:[...hi(),...cl()],interaction:{shareTooltip:!0}};var ex=Jg(fu);function nx(t){this._curve=t}nx.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function Jg(t){function e(n){return new nx(t(n))}return e._curve=t,e}function Ku(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(Jg(n)):e()._curve},t}function iC(){return Ku(Us().curve(ex))}var rx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const F6=Pa(t=>{const{d1:e,d2:n,style1:r,style2:o}=t.attributes,c=t.ownerDocument;Wn(t).maybeAppend("line",()=>c.createElement("path",{})).style("d",e).call(Fn,r),Wn(t).maybeAppend("line1",()=>c.createElement("path",{})).style("d",n).call(Fn,o)});function oC(t,e){const n=[],r=[];let o=!1,c=null;for(const l of t)!e(l[0])||!e(l[1])?o=!0:(n.push(l),o&&(o=!1,r.push([c,l])),c=l);return[n,r]}const po=(t,e)=>{const{curve:n,gradient:r=!1,gradientColor:o="between",defined:c=p=>!Number.isNaN(p)&&p!==void 0&&p!==null,connect:l=!1}=t,u=rx(t,["curve","gradient","gradientColor","defined","connect"]),{coordinate:d,document:h}=e;return(p,v,m)=>{const{color:b,lineWidth:x}=m,S=rx(m,["color","lineWidth"]),{color:E=b,size:w=x,seriesColor:M,seriesX:L,seriesY:I}=v,R=uu(d,v),z=Yr(d),W=r&&M?sb(M,L,I,r,o,z):E,Y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},S),W&&{stroke:W}),w&&{lineWidth:w}),R&&{transform:R}),u);let st;if(Pr(d)){const bt=d.getCenter();st=wt=>iC().angle((oe,Ut)=>js(oi(wt[Ut],bt))).radius((oe,Ut)=>ai(wt[Ut],bt)).defined(([oe,Ut])=>c(oe)&&c(Ut)).curve(n)(wt)}else st=Us().x(bt=>bt[0]).y(bt=>bt[1]).defined(([bt,wt])=>c(bt)&&c(wt)).curve(n);const[xt,Nt]=oC(p,c),Ht=bn(Y,"connect"),dt=!!Nt.length;if(!dt||l&&!Object.keys(Ht).length)return Wn(h.createElement("path",{})).style("d",st(xt)||[]).call(Fn,Y).node();if(dt&&!l)return Wn(h.createElement("path",{})).style("d",st(p)).call(Fn,Y).node();const Ot=bt=>bt.map(st).join(",");return Wn(new F6).style("style1",Object.assign(Object.assign({},Y),Ht)).style("style2",Y).style("d1",Ot(Nt)).style("d2",st(p)).node()}};po.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ix=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const o=Pr(n)?qd:fu;return po(Object.assign({curve:o},t),e)(...r)}};ix.props=Object.assign(Object.assign({},po.props),{defaultMarker:"line"});function tv(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function ev(t,e){this._context=t,this._k=(1-e)/6}ev.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:tv(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:tv(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var N6=function t(e){function n(r){return new ev(r,e)}return n.tension=function(r){return t(+r)},n}(0);function nv(t,e){this._context=t,this._k=(1-e)/6}nv.prototype={areaStart:al,areaEnd:al,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:tv(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var th=function t(e){function n(r){return new nv(r,e)}return n.tension=function(r){return t(+r)},n}(0);function ul(t,e,n){var r=t._x1,o=t._y1,c=t._x2,l=t._y2;if(t._l01_a>Gi){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,d=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/d,o=(o*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/d}if(t._l23_a>Gi){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,p=3*t._l23_a*(t._l23_a+t._l12_a);c=(c*h+t._x1*t._l23_2a-e*t._l12_2a)/p,l=(l*h+t._y1*t._l23_2a-n*t._l12_2a)/p}t._context.bezierCurveTo(r,o,c,l,t._x2,t._y2)}function ox(t,e){this._context=t,this._alpha=e}ox.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ul(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var B6=function t(e){function n(r){return e?new ox(r,e):new ev(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function ax(t,e){this._context=t,this._alpha=e}ax.prototype={areaStart:al,areaEnd:al,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ul(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var rv=function t(e){function n(r){return e?new ax(r,e):new nv(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function sx(t){return t<0?-1:1}function cx(t,e,n){var r=t._x1-t._x0,o=e-t._x1,c=(t._y1-t._y0)/(r||o<0&&-0),l=(n-t._y1)/(o||r<0&&-0),u=(c*o+l*r)/(r+o);return(sx(c)+sx(l))*Math.min(Math.abs(c),Math.abs(l),.5*Math.abs(u))||0}function lx(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function iv(t,e,n){var r=t._x0,o=t._y0,c=t._x1,l=t._y1,u=(c-r)/3;t._context.bezierCurveTo(r+u,o+u*e,c-u,l-u*n,c,l)}function eh(t){this._context=t}eh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iv(this,this._t0,lx(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,iv(this,lx(this,n=cx(this,t,e)),n);break;default:iv(this,this._t0,n=cx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function ux(t){this._context=new fx(t)}(ux.prototype=Object.create(eh.prototype)).point=function(t,e){eh.prototype.point.call(this,e,t)};function fx(t){this._context=t}fx.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,o,c){this._context.bezierCurveTo(e,t,r,n,c,o)}};function dx(t){return new eh(t)}function hx(t){return new ux(t)}var aC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const px=(t,e)=>{const n=aC(t,[]),{coordinate:r}=e;return(...o)=>{const c=Pr(r)?rv:Yr(r)?hx:dx;return po(Object.assign({curve:c},n),e)(...o)}};px.props=Object.assign(Object.assign({},po.props),{defaultMarker:"smooth"});function nh(t,e){this._context=t,this._t=e}nh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function gx(t){return new nh(t,.5)}function vx(t){return new nh(t,0)}function sC(t){return new nh(t,1)}const mx=(t,e)=>po(Object.assign({curve:sC},t),e);mx.props=Object.assign(Object.assign({},po.props),{defaultMarker:"hv"});const rh=(t,e)=>po(Object.assign({curve:vx},t),e);rh.props=Object.assign(Object.assign({},po.props),{defaultMarker:"vh"});const yx=(t,e)=>po(Object.assign({curve:gx},t),e);yx.props=Object.assign(Object.assign({},po.props),{defaultMarker:"hvh"});var cC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function ac(t,e,n,r,o){const c=oi(n,e),l=Ro(c),u=l+Math.PI/2,d=[r/2*Math.cos(u),r/2*Math.sin(u)],h=[o/2*Math.cos(u),o/2*Math.sin(u)],p=[o/2*Math.cos(l),o/2*Math.sin(l)],v=[r/2*Math.cos(l),r/2*Math.sin(l)],m=nd(e,d),b=nd(n,h),x=nd(b,p),S=nd(n,p),E=oi(S,h),w=oi(n,h),M=oi(e,d),L=oi(M,v),I=oi(e,v),R=oi(m,v);t.moveTo(...m),t.lineTo(...b),t.arcTo(...x,...S,o/2),t.arcTo(...E,...w,o/2),t.lineTo(...M),t.arcTo(...L,...I,r/2),t.arcTo(...R,...m,r/2),t.closePath()}const bx=(t,e)=>{const{document:n}=e;return(r,o,c)=>{const{seriesSize:l,color:u}=o,{color:d}=c,h=cC(c,["color"]),p=ko();for(let v=0;v<r.length-1;v++){const m=r[v],b=r[v+1],x=l[v],S=l[v+1];[...m,...b].every(Hr)&&ac(p,m,b,x,S)}return Wn(n.createElement("path",{})).call(Fn,h).style("fill",u||d).style("d",p.toString()).call(Fn,t).node()}};bx.props=Object.assign(Object.assign({},po.props),{defaultMarker:"line"});const _x=()=>(t,e)=>{const{style:n={},encode:r}=e,{series:o}=r,{gradient:c}=n;return!c||o?[t,e]:[t,en({},e,{encode:{series:$d(za(t,void 0))}})]};_x.props={};const ov=()=>(t,e)=>{const{encode:n}=e,{series:r,color:o}=n;if(r!==void 0||o===void 0)return[t,e];const[c,l]=pr(n,"color");return[t,en({},e,{encode:{series:Wr(c,l)}})]};ov.props={};const xx={line:ix,smooth:px,hv:mx,vh:rh,hvh:yx,trail:bx},j6=(t,e,n,r)=>{var o,c;const{series:l,x:u,y:d}=n,{x:h,y:p}=e;if(u===void 0||d===void 0)throw new Error("Missing encode for x or y channel.");const v=l?Array.from(Gr(t,E=>l[E]).values()):[t],m=v.map(E=>E[0]).filter(E=>E!==void 0),b=(((o=h==null?void 0:h.getBandWidth)===null||o===void 0?void 0:o.call(h))||0)/2,x=(((c=p==null?void 0:p.getBandWidth)===null||c===void 0?void 0:c.call(p))||0)/2,S=Array.from(v,E=>E.map(w=>r.map([+u[w]+b,+d[w]+x])));return[m,S,v]},lC=(t,e,n,r)=>{const o=Object.entries(n).filter(([l])=>l.startsWith("position")).map(([,l])=>l);if(o.length===0)throw new Error("Missing encode for position channel.");const c=Array.from(t,l=>{const u=o.map(p=>+p[l]),d=r.map(u),h=[];for(let p=0;p<d.length;p+=2)h.push([d[p],d[p+1]]);return h});return[t,c]},Sx=()=>(t,e,n,r)=>(Rl(r)?lC:j6)(t,e,n,r);Sx.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:xx,channels:[...Pi({shapes:Object.keys(xx)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...li(),{type:_x},{type:ov}],postInference:[...hi(),...cl(),...$g()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var uC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Ox(t,e,n,r){if(e.length===1)return;const{size:o}=n;if(t==="fixed")return o;if(t==="normal"||pp(r)){const[[c,l],[u,d]]=e,h=Math.abs((u-c)/2),p=Math.abs((d-l)/2);return Math.max(0,(h+p)/2)}return o}const cr=(t,e)=>{const{colorAttribute:n,symbol:r,mode:o="auto"}=t,c=uC(t,["colorAttribute","symbol","mode"]),l=xc.get(r)||xc.get("point"),{coordinate:u,document:d}=e;return(h,p,v)=>{const{lineWidth:m,color:b}=v,x=c.stroke?m||1:m,{color:S=b,transform:E,opacity:w}=p,[M,L]=od(h),R=Ox(o,h,p,u)||c.r||v.r;return Wn(d.createElement("path",{})).call(Fn,v).style("fill","transparent").style("d",l(M,L,R)).style("lineWidth",x).style("transform",E).style("transformOrigin",`${M-R} ${L-R}`).style("stroke",S).style(f0(t),w).style(n,S).call(Fn,c).node()}};cr.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Ex=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"point"},t),e);Ex.props=Object.assign({defaultMarker:"hollowPoint"},cr.props);const fC=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"diamond"},t),e);fC.props=Object.assign({defaultMarker:"hollowDiamond"},cr.props);const Ax=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},t),e);Ax.props=Object.assign({defaultMarker:"hollowHexagon"},cr.props);const av=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"square"},t),e);av.props=Object.assign({defaultMarker:"hollowSquare"},cr.props);const Tx=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},t),e);Tx.props=Object.assign({defaultMarker:"hollowTriangleDown"},cr.props);const Cx=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"triangle"},t),e);Cx.props=Object.assign({defaultMarker:"hollowTriangle"},cr.props);const Mx=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},t),e);Mx.props=Object.assign({defaultMarker:"hollowBowtie"},cr.props);var dC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const sv=(t,e)=>{const{colorAttribute:n,mode:r="auto"}=t,o=dC(t,["colorAttribute","mode"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{lineWidth:p,color:v}=h,m=o.stroke?p||1:p,{color:b=v,transform:x,opacity:S}=d,[E,w]=od(u),L=Ox(r,u,d,c)||o.r||h.r;return Wn(l.createElement("circle",{})).call(Fn,h).style("fill","transparent").style("cx",E).style("cy",w).style("r",L).style("lineWidth",m).style("transform",x).style("transformOrigin",`${E} ${w}`).style("stroke",b).style(f0(t),S).style(n,b).call(Fn,o).node()}},cv=(t,e)=>sv(Object.assign({colorAttribute:"fill"},t),e);cv.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const Lx=(t,e)=>sv(Object.assign({colorAttribute:"stroke"},t),e);Lx.props=Object.assign({defaultMarker:"hollowPoint"},cv.props);const Px=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"point"},t),e);Px.props=Object.assign({defaultMarker:"point"},cr.props);const Ix=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"plus"},t),e);Ix.props=Object.assign({defaultMarker:"plus"},cr.props);const Rx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"diamond"},t),e);Rx.props=Object.assign({defaultMarker:"diamond"},cr.props);const kx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"square"},t),e);kx.props=Object.assign({defaultMarker:"square"},cr.props);const Dx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"triangle"},t),e);Dx.props=Object.assign({defaultMarker:"triangle"},cr.props);const Fx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"hexagon"},t),e);Fx.props=Object.assign({defaultMarker:"hexagon"},cr.props);const hC=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"cross"},t),e);hC.props=Object.assign({defaultMarker:"cross"},cr.props);const Nx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"bowtie"},t),e);Nx.props=Object.assign({defaultMarker:"bowtie"},cr.props);const ih=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},t),e);ih.props=Object.assign({defaultMarker:"hyphen"},cr.props);const Bx=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"line"},t),e);Bx.props=Object.assign({defaultMarker:"line"},cr.props);const jx=(t,e)=>cr(Object.assign({colorAttribute:"stroke",symbol:"tick"},t),e);jx.props=Object.assign({defaultMarker:"tick"},cr.props);const zx=(t,e)=>cr(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},t),e);zx.props=Object.assign({defaultMarker:"triangleDown"},cr.props);const oh=()=>(t,e)=>{const{encode:n}=e,{y:r}=n;return r!==void 0?[t,e]:[t,en({},e,{encode:{y:il(za(t,0))},scale:{y:{guide:null}}})]};oh.props={};const Ux=()=>(t,e)=>{const{encode:n}=e,{size:r}=n;return r!==void 0?[t,e]:[t,en({},e,{encode:{size:$d(za(t,3))}})]};Ux.props={};const Zx={hollow:Ex,hollowDiamond:fC,hollowHexagon:Ax,hollowSquare:av,hollowTriangleDown:Tx,hollowTriangle:Cx,hollowBowtie:Mx,hollowCircle:Lx,point:Px,plus:Ix,diamond:Rx,square:kx,triangle:Dx,hexagon:Fx,cross:hC,bowtie:Nx,hyphen:ih,line:Bx,tick:jx,triangleDown:zx,circle:cv},Qu=t=>(e,n,r,o)=>{const{x:c,y:l,x1:u,y1:d,size:h,dx:p,dy:v}=r,[m,b]=o.getSize(),x=oc(n,r,t),S=w=>{const M=+((p==null?void 0:p[w])||0),L=+((v==null?void 0:v[w])||0),I=u?(+c[w]+ +u[w])/2:+c[w],R=d?(+l[w]+ +d[w])/2:+l[w],z=I+M,W=R+L;return[z,W]},E=h?Array.from(e,w=>{const[M,L]=S(w),I=+h[w],R=I/m,z=I/b,W=[M-R,L-z],Y=[M+R,L+z];return[o.map(x(W,w)),o.map(x(Y,w))]}):Array.from(e,w=>[o.map(x(S(w),w))]);return[e,E]};Qu.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:Zx,channels:[...Pi({shapes:Object.keys(Zx)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...li(),{type:ic},{type:oh}],postInference:[...hi(),{type:Ux},...Ua()]};const Hx=(t,e)=>{const{coordinate:n}=e;return(r,o,c)=>{const{color:l,text:u="",fontSize:d,rotate:h=0,transform:p=""}=o,v={text:String(u),stroke:l,fill:l,fontSize:d},[[m,b]]=r;return Wn(new mb).style("x",m).style("y",b).call(Fn,c).style("transform",`${p}rotate(${+h})`).style("coordCenter",n.getCenter()).call(Fn,v).call(Fn,t).node()}};Hx.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var lv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function pC(t){const e=t/Math.sqrt(2),n=t*Math.sqrt(2),[r,o]=[-e,e-n],[c,l]=[0,0],[u,d]=[e,e-n];return[["M",r,o],["A",t,t,0,1,1,u,d],["L",c,l],["Z"]]}function gC(t){const{min:e,max:n}=t.getLocalBounds();return[(e[0]+n[0])*.5,(e[1]+n[1])*.5]}const z6=Pa(t=>{const e=t.attributes,{class:n,x:r,y:o,transform:c}=e,l=lv(e,["class","x","y","transform"]),u=bn(l,"marker"),{size:d=24}=u,h=()=>pC(d/2),p=Wn(t).maybeAppend("marker",()=>new wr({})).call(b=>b.node().update(Object.assign({symbol:h},u))).node(),[v,m]=gC(p);Wn(t).maybeAppend("text","text").style("x",v).style("y",m).call(Fn,l)}),vC=(t,e)=>{const n=lv(t,[]);return(r,o,c)=>{const{color:l}=c,u=lv(c,["color"]),{color:d=l,text:h=""}=o,p={text:String(h),stroke:d,fill:d},[[v,m]]=r;return Wn(new z6).call(Fn,u).style("transform",`translate(${v},${m})`).call(Fn,p).call(Fn,n).node()}};vC.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Vx=(t,e)=>{const{coordinate:n}=e;return(r,o,c)=>{const{color:l,text:u="",fontSize:d,rotate:h=0,transform:p=""}=o,v={text:String(u),stroke:l,fill:l,fontSize:d,textAlign:"center",textBaseline:"middle"},[[m,b]]=r;return Wn(new F.xv).style("x",m).style("y",b).call(Fn,c).style("transformOrigin","center center").style("transform",`${p}rotate(${h}deg)`).style("coordCenter",n.getCenter()).call(Fn,v).call(Fn,t).node()}};Vx.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ah=()=>(t,e)=>{const{data:n}=e;if(!Array.isArray(n)||n.some(ol))return[t,e];const r=Array.isArray(n[0])?n:[n],o=r.map(l=>l[0]),c=r.map(l=>l[1]);return[t,en({},e,{encode:{x:Wr(o),y:Wr(c)}})]};ah.props={};var mC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const sh=()=>(t,e)=>{const{data:n,style:r={}}=e,o=mC(e,["data","style"]),{x:c,y:l}=r,u=mC(r,["x","y"]);if(c==null||l==null)return[t,e];const d=c||0,h=l||0;return[[0],en({},o,{data:[0],cartesian:!0,encode:{x:Wr([d]),y:Wr([h])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:u})]};sh.props={};const Wx={text:Hx,badge:vC,tag:Vx},Gx=t=>{const{cartesian:e=!1}=t;return e?qg:(n,r,o,c)=>{const{x:l,y:u}=o,d=oc(r,o,t),h=Array.from(n,p=>{const v=[+l[p],+u[p]];return[c.map(d(v,p))]});return[n,h]}};Gx.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:Wx,channels:[...Pi({shapes:Object.keys(Wx)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...li(),{type:ah},{type:sh}],postInference:[...hi(),...Ua()]};const uv=()=>(t,e)=>[t,en({scale:{x:{padding:0},y:{padding:0}}},e)];uv.props={};const Yx={cell:ps,hollow:Xd},fv=()=>(t,e,n,r)=>{const{x:o,y:c}=n,l=e.x,u=e.y,d=Array.from(t,h=>{const p=l.getBandWidth(l.invert(+o[h])),v=u.getBandWidth(u.invert(+c[h])),m=+o[h],b=+c[h],x=[m,b],S=[m+p,b],E=[m+p,b+v],w=[m,b+v];return[x,S,E,w].map(M=>r.map(M))});return[t,d]};fv.props={defaultShape:"cell",defaultLabelShape:"label",shape:Yx,composite:!1,channels:[...Pi({shapes:Object.keys(Yx)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...li(),{type:ic},{type:oh},{type:uv}],postInference:[...hi(),...Ua()]};function Ju(t,e,n){var r=null,o=qr(!0),c=null,l=fu,u=null,d=v0(h);t=typeof t=="function"?t:t===void 0?hb:qr(+t),e=typeof e=="function"?e:qr(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?pb:qr(+n);function h(v){var m,b,x,S=(v=lb(v)).length,E,w=!1,M,L=new Array(S),I=new Array(S);for(c==null&&(u=l(M=d())),m=0;m<=S;++m){if(!(m<S&&o(E=v[m],m,v))===w)if(w=!w)b=m,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),x=m-1;x>=b;--x)u.point(L[x],I[x]);u.lineEnd(),u.areaEnd()}w&&(L[m]=+t(E,m,v),I[m]=+e(E,m,v),u.point(r?+r(E,m,v):L[m],n?+n(E,m,v):I[m]))}if(M)return u=null,M+""||null}function p(){return Us().defined(o).curve(l).context(c)}return h.x=function(v){return arguments.length?(t=typeof v=="function"?v:qr(+v),r=null,h):t},h.x0=function(v){return arguments.length?(t=typeof v=="function"?v:qr(+v),h):t},h.x1=function(v){return arguments.length?(r=v==null?null:typeof v=="function"?v:qr(+v),h):r},h.y=function(v){return arguments.length?(e=typeof v=="function"?v:qr(+v),n=null,h):e},h.y0=function(v){return arguments.length?(e=typeof v=="function"?v:qr(+v),h):e},h.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:qr(+v),h):n},h.lineX0=h.lineY0=function(){return p().x(t).y(e)},h.lineY1=function(){return p().x(t).y(n)},h.lineX1=function(){return p().x(r).y(e)},h.defined=function(v){return arguments.length?(o=typeof v=="function"?v:qr(!!v),h):o},h.curve=function(v){return arguments.length?(l=v,c!=null&&(u=l(c)),h):l},h.context=function(v){return arguments.length?(v==null?c=u=null:u=l(c=v),h):c},h}function yC(){var t=Ju().curve(ex),e=t.curve,n=t.lineX0,r=t.lineX1,o=t.lineY0,c=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Ku(n())},delete t.lineX0,t.lineEndAngle=function(){return Ku(r())},delete t.lineX1,t.lineInnerRadius=function(){return Ku(o())},delete t.lineY0,t.lineOuterRadius=function(){return Ku(c())},delete t.lineY1,t.curve=function(l){return arguments.length?e(Jg(l)):e()._curve},t}var bC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function $x(t,e){const n=[],r=[],o=[];let c=!1,l=null;const u=t.length/2;for(let d=0;d<u;d++){const h=t[d],p=t[d+u];if([...h,...p].some(v=>!e(v)))c=!0;else{if(n.push(h),r.push(p),c&&l){c=!1;const[v,m]=l;o.push([v,h,m,p])}l=[h,p]}}return[n.concat(r),o]}const dv=Pa(t=>{const{areaPath:e,connectPath:n,areaStyle:r,connectStyle:o}=t.attributes,c=t.ownerDocument;Wn(t).maybeAppend("connect-path",()=>c.createElement("path",{})).style("d",n).call(Fn,o),Wn(t).maybeAppend("area-path",()=>c.createElement("path",{})).style("d",e).call(Fn,r)}),$o=(t,e)=>{const{curve:n,gradient:r=!1,defined:o=h=>!Number.isNaN(h)&&h!==void 0&&h!==null,connect:c=!1}=t,l=bC(t,["curve","gradient","defined","connect"]),{coordinate:u,document:d}=e;return(h,p,v)=>{const{color:m}=v,{color:b=m,seriesColor:x,seriesX:S,seriesY:E}=p,w=Yr(u),M=uu(u,p),L=r&&x?sb(x,S,E,r,void 0,w):b,I=Object.assign(Object.assign(Object.assign(Object.assign({},v),{stroke:L,fill:L}),M&&{transform:M}),l),[R,z]=$x(h,o),W=bn(I,"connect"),Y=!!z.length,st=xt=>Wn(d.createElement("path",{})).style("d",xt||"").call(Fn,I).node();if(Pr(u)){const xt=Nt=>{const Ht=u.getCenter(),dt=Nt.slice(0,Nt.length/2),Ot=Nt.slice(Nt.length/2);return yC().angle((bt,wt)=>js(oi(dt[wt],Ht))).outerRadius((bt,wt)=>ai(dt[wt],Ht)).innerRadius((bt,wt)=>ai(Ot[wt],Ht)).defined((bt,wt)=>[...dt[wt],...Ot[wt]].every(o)).curve(n)(Ot)};return!Y||c&&!Object.keys(W).length?st(xt(R)):Y&&!c?st(xt(h)):Wn(new dv).style("areaStyle",I).style("connectStyle",Object.assign(Object.assign({},W),l)).style("areaPath",xt(h)).style("connectPath",z.map(xt).join("")).node()}else{const xt=Nt=>{const Ht=Nt.slice(0,Nt.length/2),dt=Nt.slice(Nt.length/2);return w?Ju().y((Ot,bt)=>Ht[bt][1]).x1((Ot,bt)=>Ht[bt][0]).x0((Ot,bt)=>dt[bt][0]).defined((Ot,bt)=>[...Ht[bt],...dt[bt]].every(o)).curve(n)(Ht):Ju().x((Ot,bt)=>Ht[bt][0]).y1((Ot,bt)=>Ht[bt][1]).y0((Ot,bt)=>dt[bt][1]).defined((Ot,bt)=>[...Ht[bt],...dt[bt]].every(o)).curve(n)(Ht)};return!Y||c&&!Object.keys(W).length?st(xt(R)):Y&&!c?st(xt(h)):Wn(new dv).style("areaStyle",I).style("connectStyle",Object.assign(Object.assign({},W),l)).style("areaPath",xt(h)).style("connectPath",z.map(xt).join("")).node()}}};$o.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Xx=(t,e)=>{const{coordinate:n}=e;return(...r)=>{const o=Pr(n)?qd:fu;return $o(Object.assign({curve:o},t),e)(...r)}};Xx.props=Object.assign(Object.assign({},$o.props),{defaultMarker:"square"});var qx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const tf=(t,e)=>{const n=qx(t,[]),{coordinate:r}=e;return(...o)=>{const c=Pr(r)?rv:Yr(r)?hx:dx;return $o(Object.assign({curve:c},n),e)(...o)}};tf.props=Object.assign(Object.assign({},$o.props),{defaultMarker:"smooth"});const Kx=(t,e)=>(...n)=>$o(Object.assign({curve:gx},t),e)(...n);Kx.props=Object.assign(Object.assign({},$o.props),{defaultMarker:"hvh"});const sc=(t,e)=>(...n)=>$o(Object.assign({curve:vx},t),e)(...n);sc.props=Object.assign(Object.assign({},$o.props),{defaultMarker:"vh"});const Qx=(t,e)=>(...n)=>$o(Object.assign({curve:sC},t),e)(...n);Qx.props=Object.assign(Object.assign({},$o.props),{defaultMarker:"hv"});const Jx={area:Xx,smooth:tf,hvh:Kx,vh:sc,hv:Qx},t3=()=>(t,e,n,r)=>{var o,c;const{x:l,y:u,y1:d,series:h}=n,{x:p,y:v}=e,m=h?Array.from(Gr(t,w=>h[w]).values()):[t],b=m.map(w=>w[0]).filter(w=>w!==void 0),x=(((o=p==null?void 0:p.getBandWidth)===null||o===void 0?void 0:o.call(p))||0)/2,S=(((c=v==null?void 0:v.getBandWidth)===null||c===void 0?void 0:c.call(v))||0)/2,E=Array.from(m,w=>{const M=w.length,L=new Array(M*2);for(let I=0;I<w.length;I++){const R=w[I];L[I]=r.map([+l[R]+x,+u[R]+S]),L[M+I]=r.map([+l[R]+x,+d[R]+S])}return L});return[b,E,m]};t3.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:Jx,channels:[...Pi({shapes:Object.keys(Jx)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...li(),{type:ov},{type:qu},{type:uv}],postInference:[...hi(),...cl()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const e3=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;if(r)return[t,e];const[o]=pr(n,"y");return[t,en({},e,{encode:{y1:Wr([...o])}})]};e3.props={};const tn=()=>(t,e)=>{const{encode:n}=e,{x1:r}=n;if(r)return[t,e];const[o]=pr(n,"x");return[t,en({},e,{encode:{x1:Wr([...o])}})]};tn.props={};var n3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const hv=(t,e)=>{const{arrow:n=!0,arrowSize:r="40%"}=t,o=n3(t,["arrow","arrowSize"]),{document:c}=e;return(l,u,d)=>{const{defaultColor:h}=d,p=n3(d,["defaultColor"]),{color:v=h,transform:m}=u,[b,x]=l,S=ko();if(S.moveTo(...b),S.lineTo(...x),n){const[E,w]=fA(b,x,{arrowSize:r});S.moveTo(...E),S.lineTo(...x),S.lineTo(...w)}return Wn(c.createElement("path",{})).call(Fn,p).style("d",S.toString()).style("stroke",v).style("transform",m).call(Fn,o).node()}};hv.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const r3=(t,e)=>{const{arrow:n=!1}=t;return(...r)=>hv(Object.assign(Object.assign({},t),{arrow:n}),e)(...r)};r3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var pv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const i3=(t,e)=>{const n=pv(t,[]),{coordinate:r,document:o}=e;return(c,l,u)=>{const{color:d}=u,h=pv(u,["color"]),{color:p=d,transform:v}=l,[m,b]=c,x=ko();if(x.moveTo(m[0],m[1]),Pr(r)){const S=r.getCenter();x.quadraticCurveTo(S[0],S[1],b[0],b[1])}else{const S=u0(m,b),E=ai(m,b)/2;rd(x,m,b,S,E)}return Wn(o.createElement("path",{})).call(Fn,h).style("d",x.toString()).style("stroke",p).style("transform",v).call(Fn,n).node()}};i3.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var o3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const gv=(t,e)=>{const n=o3(t,[]),{document:r}=e;return(o,c,l)=>{const{color:u}=l,d=o3(l,["color"]),{color:h=u,transform:p}=c,[v,m]=o,b=ko();return b.moveTo(v[0],v[1]),b.bezierCurveTo(v[0]/2+m[0]/2,v[1],v[0]/2+m[0]/2,m[1],m[0],m[1]),Wn(r.createElement("path",{})).call(Fn,d).style("d",b.toString()).style("stroke",h).style("transform",p).call(Fn,n).node()}};gv.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var fl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function _C(t,e,n,r){const o=ko();if(Pr(n)){const c=n.getCenter(),l=ai(t,c),d=(ai(e,c)-l)*r+l;return o.moveTo(t[0],t[1]),rd(o,t,e,c,d),o.lineTo(e[0],e[1]),o}return Yr(n)?(o.moveTo(t[0],t[1]),o.lineTo(t[0]+(e[0]-t[0])*r,t[1]),o.lineTo(t[0]+(e[0]-t[0])*r,e[1]),o.lineTo(e[0],e[1]),o):(o.moveTo(t[0],t[1]),o.lineTo(t[0],t[1]+(e[1]-t[1])*r),o.lineTo(e[0],t[1]+(e[1]-t[1])*r),o.lineTo(e[0],e[1]),o)}const a3=(t,e)=>{const{cornerRatio:n=1/3}=t,r=fl(t,["cornerRatio"]),{coordinate:o,document:c}=e;return(l,u,d)=>{const{defaultColor:h}=d,p=fl(d,["defaultColor"]),{color:v=h,transform:m}=u,[b,x]=l,S=_C(b,x,o,n);return Wn(c.createElement("path",{})).call(Fn,p).style("d",S.toString()).style("stroke",v).style("transform",m).call(Fn,r).node()}};a3.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const s3={link:r3,arc:i3,smooth:gv,vhv:a3},vv=t=>(e,n,r,o)=>{const{x:c,y:l,x1:u=c,y1:d=l}=r,h=oc(n,r,t),p=e.map(v=>[o.map(h([+c[v],+l[v]],v)),o.map(h([+u[v],+d[v]],v))]);return[e,p]};vv.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:s3,channels:[...Pi({shapes:Object.keys(s3)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li(),{type:e3},{type:tn}],postInference:[...hi(),...Ua()]};var xC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ch=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u}=l,d=xC(l,["color"]),{color:h=u,src:p="",size:v=32,transform:m=""}=c;let{width:b=v,height:x=v}=t;const[[S,E]]=o,[w,M]=n.getSize();b=typeof b=="string"?Jd(b)*w:b,x=typeof x=="string"?Jd(x)*M:x;const L=S-Number(b)/2,I=E-Number(x)/2;return Wn(r.createElement("image",{})).call(Fn,d).style("x",L).style("y",I).style("src",p).style("stroke",h).style("transform",m).call(Fn,t).style("width",b).style("height",x).node()}};ch.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const c3={image:ch},l3=t=>{const{cartesian:e}=t;return e?qg:(n,r,o,c)=>{const{x:l,y:u}=o,d=oc(r,o,t),h=Array.from(n,p=>{const v=[+l[p],+u[p]];return[c.map(d(v,p))]});return[n,h]}};l3.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:c3,channels:[...Pi({shapes:Object.keys(c3)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...li(),{type:ah},{type:sh}],postInference:[...hi(),...Ua()]};var lh=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function SC(t,e){const n=ko();if(Pr(e)){const r=e.getCenter(),o=[...t,t[0]],c=o.map(l=>ai(l,r));return o.forEach((l,u)=>{if(u===0){n.moveTo(l[0],l[1]);return}const d=c[u],h=t[u-1],p=c[u-1];p!==void 0&&Math.abs(d-p)<1e-10?rd(n,h,l,r,d):n.lineTo(l[0],l[1])}),n.closePath(),n}return uA(n,t)}const u3=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u}=l,d=lh(l,["color"]),{color:h=u,transform:p}=c,v=SC(o,n);return Wn(r.createElement("path",{})).call(Fn,d).style("d",v.toString()).style("stroke",h).style("fill",h).style("transform",p).call(Fn,t).node()}};u3.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var f3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function h3(t,e){const[n,r,o,c]=t,l=ko();if(Pr(e)){const u=e.getCenter(),d=ai(u,n);return l.moveTo(n[0],n[1]),l.quadraticCurveTo(u[0],u[1],o[0],o[1]),rd(l,o,c,u,d),l.quadraticCurveTo(u[0],u[1],r[0],r[1]),rd(l,r,n,u,d),l.closePath(),l}return l.moveTo(n[0],n[1]),l.bezierCurveTo(n[0]/2+o[0]/2,n[1],n[0]/2+o[0]/2,o[1],o[0],o[1]),l.lineTo(c[0],c[1]),l.bezierCurveTo(c[0]/2+r[0]/2,c[1],c[0]/2+r[0]/2,r[1],r[0],r[1]),l.lineTo(n[0],n[1]),l.closePath(),l}const p3=(t,e)=>{const n=f3(t,[]),{coordinate:r,document:o}=e;return(c,l,u)=>{const{color:d}=u,h=f3(u,["color"]),{color:p=d,transform:v}=l,m=h3(c,r);return Wn(o.createElement("path",{})).call(Fn,h).style("d",m.toString()).style("fill",p||d).style("stroke",p||d).style("transform",v).call(Fn,n).node()}};p3.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const g3={polygon:u3,ribbon:p3},mv=()=>(t,e,n,r)=>{const o=Object.entries(n).filter(([u])=>u.startsWith("x")).map(([,u])=>u),c=Object.entries(n).filter(([u])=>u.startsWith("y")).map(([,u])=>u),l=t.map(u=>{const d=[];for(let h=0;h<o.length;h++){const p=o[h][u];if(p===void 0)break;const v=c[h][u];d.push(r.map([+p,+v]))}return d});return[t,l]};mv.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:g3,channels:[...Pi({shapes:Object.keys(g3)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li()],postInference:[...hi(),...Ua()]};var uh=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function dl(t,e){const n=ko();if(!Pr(e))n.moveTo(...t[0]),n.lineTo(...t[1]),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.lineTo(...t[5]),n.lineTo(...t[6]),n.lineTo(...t[7]),n.closePath(),n.moveTo(...t[8]),n.lineTo(...t[9]),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.lineTo(...t[13]);else{const r=e.getCenter(),[o,c]=r,l=Ro(oi(t[0],r)),u=Ro(oi(t[1],r)),d=ai(r,t[2]),h=ai(r,t[3]),p=ai(r,t[8]),v=ai(r,t[10]),m=ai(r,t[11]);n.moveTo(...t[0]),n.arc(o,c,d,l,u),n.arc(o,c,d,u,l,!0),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.arc(o,c,h,l,u),n.lineTo(...t[6]),n.arc(o,c,v,u,l,!0),n.closePath(),n.moveTo(...t[8]),n.arc(o,c,p,l,u),n.arc(o,c,p,u,l,!0),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.arc(o,c,m,l,u),n.arc(o,c,m,u,l,!0)}return n}const v3=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u,transform:d}=c,{color:h,fill:p=h,stroke:v=h}=l,m=uh(l,["color","fill","stroke"]),b=dl(o,n);return Wn(r.createElement("path",{})).call(Fn,m).style("d",b.toString()).style("stroke",v).style("fill",u||p).style("transform",d).call(Fn,t).node()}};v3.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var OC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function fh(t,e,n=4){const r=ko();if(!Pr(e))return r.moveTo(...t[2]),r.lineTo(...t[3]),r.lineTo(t[3][0]-n,t[3][1]),r.lineTo(t[10][0]-n,t[10][1]),r.lineTo(t[10][0]+n,t[10][1]),r.lineTo(t[3][0]+n,t[3][1]),r.lineTo(...t[3]),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]),r.moveTo(t[3][0]+n/2,t[8][1]),r.arc(t[3][0],t[8][1],n/2,0,Math.PI*2),r.closePath(),r;const o=e.getCenter(),[c,l]=o,u=ai(o,t[3]),d=ai(o,t[8]),h=ai(o,t[10]),p=Ro(oi(t[2],o)),v=Math.asin(n/d),m=p-v,b=p+v;r.moveTo(...t[2]),r.lineTo(...t[3]),r.moveTo(Math.cos(m)*u+c,Math.sin(m)*u+l),r.arc(c,l,u,m,b),r.lineTo(Math.cos(b)*h+c,Math.sin(b)*h+l),r.arc(c,l,h,b,m,!0),r.lineTo(Math.cos(m)*u+c,Math.sin(m)*u+l),r.closePath(),r.moveTo(...t[10]),r.lineTo(...t[11]);const x=(m+b)/2;return r.moveTo(Math.cos(x)*(d+n/2)+c,Math.sin(x)*(d+n/2)+l),r.arc(Math.cos(x)*d+c,Math.sin(x)*d+l,n/2,x,Math.PI*2+x),r.closePath(),r}const m3=(t,e)=>{const{coordinate:n,document:r}=e;return(o,c,l)=>{const{color:u,transform:d}=c,h=4,{color:p,fill:v=p,stroke:m=p}=l,b=OC(l,["color","fill","stroke"]),x=fh(o,n,h);return Wn(r.createElement("path",{})).call(Fn,b).style("d",x.toString()).style("stroke",m).style("fill",u||v).style("transform",d).call(Fn,t).node()}};m3.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const y3={box:v3,violin:m3},br=()=>(t,e,n,r)=>{const{x:o,y:c,y1:l,y2:u,y3:d,y4:h,series:p}=n,v=e.x,m=e.series,b=Array.from(t,x=>{const S=v.getBandWidth(v.invert(+o[x])),E=m?m.getBandWidth(m.invert(+(p==null?void 0:p[x]))):1,w=S*E,M=(+(p==null?void 0:p[x])||0)*S,L=+o[x]+M+w/2,[I,R,z,W,Y]=[+c[x],+l[x],+u[x],+d[x],+h[x]];return[[L-w/2,Y],[L+w/2,Y],[L,Y],[L,W],[L-w/2,W],[L+w/2,W],[L+w/2,R],[L-w/2,R],[L-w/2,z],[L+w/2,z],[L,R],[L,I],[L-w/2,I],[L+w/2,I]].map(xt=>r.map(xt))});return[t,b]};br.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:y3,channels:[...Pi({shapes:Object.keys(y3)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...li(),{type:ic}],postInference:[...hi(),...cl()],interaction:{shareTooltip:!0}};const yv={vector:hv},bv=()=>(t,e,n,r)=>{const{x:o,y:c,size:l,rotate:u}=n,[d,h]=r.getSize(),p=t.map(v=>{const m=+u[v]/180*Math.PI,b=+l[v],x=b/d,S=b/h,E=x*Math.cos(m),w=-S*Math.sin(m);return[r.map([+o[v]-E/2,+c[v]-w/2]),r.map([+o[v]+E/2,+c[v]+w/2])]});return[t,p]};bv.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:yv,channels:[...Pi({shapes:Object.keys(yv)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...li()],postInference:[...hi(),...Ua()]};var b3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function dh(t,e,n){return t.createElement("path",{style:Object.assign({d:`M ${e},${e} L -${e},0 L ${e},-${e} L 0,0 Z`,transformOrigin:"center"},n)})}function _3(t,e){if(!Pr(e))return Us().x(r=>r[0]).y(r=>r[1])(t);const n=e.getCenter();return mu()({startAngle:0,endAngle:Math.PI*2,outerRadius:ai(t[0],n),innerRadius:ai(t[1],n)})}function EC(t,e){if(!Pr(t))return e;const[n,r]=t.getCenter();return`translate(${n}, ${r}) ${e||""}`}const _v=(t,e)=>{const{arrow:n,arrowSize:r=4}=t,o=b3(t,["arrow","arrowSize"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{color:p,lineWidth:v}=h,m=b3(h,["color","lineWidth"]),{color:b=p,size:x=v}=d,S=n?dh(l,r,Object.assign({fill:o.stroke||b,stroke:o.stroke||b},bn(o,"arrow"))):null,E=_3(u,c),w=EC(c,d.transform);return Wn(l.createElement("path",{})).call(Fn,m).style("d",E).style("stroke",b).style("lineWidth",x).style("transform",w).style("markerEnd",S).call(Fn,o).node()}};_v.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const x3=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(ol)?[t,e]:[t,en({},e,{encode:{x:Wr(n)}})]};x3.props={};const S3={line:_v},O3=t=>(e,n,r,o)=>{const{x:c}=r,l=oc(n,r,en({style:{bandOffset:0}},t)),u=Array.from(e,d=>{const h=[c[d],1],p=[c[d],0];return[h,p].map(v=>o.map(l(v,d)))});return[e,u]};O3.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:S3,channels:[...ll({shapes:Object.keys(S3)}),{name:"x",required:!0}],preInference:[...li(),{type:x3}],postInference:[...hi()]};const E3=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(ol)?[t,e]:[t,en({},e,{encode:{y:Wr(n)}})]};E3.props={};const w3={line:_v},A3=t=>(e,n,r,o)=>{const{y:c}=r,l=oc(n,r,en({style:{bandOffset:0}},t)),u=Array.from(e,d=>{const h=[0,c[d]],p=[1,c[d]];return[h,p].map(v=>o.map(l(v,d)))});return[e,u]};A3.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:w3,channels:[...ll({shapes:Object.keys(w3)}),{name:"y",required:!0}],preInference:[...li(),{type:E3}],postInference:[...hi()]};var T3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function C3(t,e,n){return[["M",t,e],["L",t+2*n,e-n],["L",t+2*n,e+n],["Z"]]}function M3(t){return Us().x(e=>e[0]).y(e=>e[1])(t)}function L3(t,e,n,r,o=0){const[[c,l],[u,d]]=e;if(Yr(t)){const m=c+n,b=u+r,x=m+o;return[[m,l],[x,l],[x,d],[b,d]]}const h=l-n,p=d-r,v=h-o;return[[c,h],[c,v],[u,v],[u,p]]}const P3=(t,e)=>{const{offset:n=0,offset1:r=n,offset2:o=n,connectLength1:c,endMarker:l=!0}=t,u=T3(t,["offset","offset1","offset2","connectLength1","endMarker"]),{coordinate:d}=e;return(h,p,v)=>{const{color:m,connectLength1:b}=v,x=T3(v,["color","connectLength1"]),{color:S,transform:E}=p,w=L3(d,h,r,o,c!=null?c:b),M=bn(Object.assign(Object.assign({},u),v),"endMarker");return Wn(new F.y$).call(Fn,x).style("d",M3(w)).style("stroke",S||m).style("transform",E).style("markerEnd",l?new wr({className:"marker",style:Object.assign(Object.assign({},M),{symbol:C3})}):null).call(Fn,u).node()}};P3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const I3={connector:P3},R3=(...t)=>vv(...t);R3.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:I3,channels:[...ll({shapes:Object.keys(I3)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li()],postInference:[...hi()]};function xv(t,e,n,r){if(e)return()=>[0,1];const{[t]:o,[`${t}1`]:c}=n;return l=>{var u;const d=((u=r.getBandWidth)===null||u===void 0?void 0:u.call(r,r.invert(+c[l])))||0;return[o[l],c[l]+d]}}function Sv(t={}){const{extendX:e=!1,extendY:n=!1}=t;return(r,o,c,l)=>{const u=xv("x",e,c,o.x),d=xv("y",n,c,o.y),h=Array.from(r,p=>{const[v,m]=u(p),[b,x]=d(p);return[[v,b],[m,b],[m,x],[v,x]].map(L=>l.map(L))});return[r,h]}}const k3={range:ps},Ov=()=>Sv();Ov.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:k3,channels:[...ll({shapes:Object.keys(k3)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li()],postInference:[...hi()]};const gs=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(ol))){const r=(o,c)=>Array.isArray(o[0])?o.map(l=>l[c]):[o[c]];return[t,en({},e,{encode:{x:Wr(r(n,0)),x1:Wr(r(n,1))}})]}return[t,e]};gs.props={};const D3={range:ps},F3=()=>Sv({extendY:!0});F3.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:D3,channels:[...ll({shapes:Object.keys(D3)}),{name:"x",required:!0}],preInference:[...li(),{type:gs}],postInference:[...hi()]};const N3=()=>(t,e)=>{const{data:n}=e;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(ol))){const r=(o,c)=>Array.isArray(o[0])?o.map(l=>l[c]):[o[c]];return[t,en({},e,{encode:{y:Wr(r(n,0)),y1:Wr(r(n,1))}})]}return[t,e]};N3.props={};const Ev={range:ps},B3=()=>Sv({extendX:!0});B3.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:Ev,channels:[...ll({shapes:Object.keys(Ev)}),{name:"y",required:!0}],preInference:[...li(),{type:N3}],postInference:[...hi()]};var j3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const ef=(t,e)=>{const{arrow:n,colorAttribute:r}=t,o=j3(t,["arrow","colorAttribute"]),{coordinate:c,document:l}=e;return(u,d,h)=>{const{color:p,stroke:v}=h,m=j3(h,["color","stroke"]),{d:b,color:x=p}=d,[S,E]=c.getSize();return Wn(l.createElement("path",{})).call(Fn,m).style("d",typeof b=="function"?b({width:S,height:E}):b).style(r,x).call(Fn,o).node()}};ef.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const nf=(t,e)=>ef(Object.assign({colorAttribute:"fill"},t),e);nf.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const z3=(t,e)=>ef(Object.assign({fill:"none",colorAttribute:"stroke"},t),e);z3.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const hh={path:nf,hollow:z3},U3=t=>(e,n,r,o)=>[e,e.map(()=>[[0,0]])];U3.props={defaultShape:"path",defaultLabelShape:"label",shape:hh,composite:!1,channels:[...Pi({shapes:Object.keys(hh)}),{name:"d",scale:"identity"}],preInference:[...li()],postInference:[...hi()]};var wC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Z3=(t,e)=>{const{render:n}=t,r=wC(t,["render"]);return o=>{const[[c,l]]=o;return n(Object.assign(Object.assign({},r),{x:c,y:l}),e)}};Z3.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const H3=()=>(t,e)=>{const{style:n={}}=e;return[t,en({},e,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter(([,r])=>typeof r=="function").map(([r,o])=>[r,()=>o])))})]};H3.props={};const V3={shape:Z3},W3=t=>{const{cartesian:e}=t;return e?qg:(n,r,o,c)=>{const{x:l,y:u}=o,d=oc(r,o,t),h=Array.from(n,p=>{const v=[+l[p],+u[p]];return[c.map(d(v,p))]});return[n,h]}};W3.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:V3,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...li(),{type:ah},{type:sh},{type:H3}]};var AC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const wv=(t,e)=>{const{document:n}=e;return(r,o,c)=>{const{transform:l}=o,{color:u}=c,d=AC(c,["color"]),{color:h=u}=o,[p,...v]=r,m=ko();return m.moveTo(...p),v.forEach(([b,x])=>{m.lineTo(b,x)}),m.closePath(),Wn(n.createElement("path",{})).call(Fn,d).style("d",m.toString()).style("stroke",h||u).style("fill",h||u).style("fillOpacity",.4).style("transform",l).call(Fn,t).node()}};wv.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const G3={density:wv},Y3=()=>(t,e,n,r)=>{const{x:o,series:c}=n,l=Object.entries(n).filter(([v])=>v.startsWith("y")).map(([,v])=>v),u=Object.entries(n).filter(([v])=>v.startsWith("size")).map(([,v])=>v);if(o===void 0||l===void 0||u===void 0)throw new Error("Missing encode for x or y or size channel.");const d=e.x,h=e.series,p=Array.from(t,v=>{const m=d.getBandWidth(d.invert(+o[v])),b=h?h.getBandWidth(h.invert(+(c==null?void 0:c[v]))):1,x=m*b,S=(+(c==null?void 0:c[v])||0)*m,E=+o[v]+S+x/2;return[...l.map((M,L)=>[E+ +u[L][v]/t.length,+l[L][v]]),...l.map((M,L)=>[E-+u[L][v]/t.length,+l[L][v]]).reverse()].map(M=>r.map(M))});return[t,p]};Y3.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:G3,channels:[...Pi({shapes:Object.keys(G3)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...li(),{type:qu},{type:ic}],postInference:[...hi(),...cl()],interaction:{shareTooltip:!0}};function hl(t){var e,n,r,o=t||1;function c(u,d){++e>o&&(r=n,l(1),++e),n[u]=d}function l(u){e=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var d=n[u];if(d!==void 0)return d;if((d=r[u])!==void 0)return c(u,d),d},set:function(u,d){n[u]!==void 0?n[u]=d:c(u,d)}}}const U6=hl(3);function Z6(t,e=(...r)=>`${r[0]}`,n=16){const r=hl(n);return(...o)=>{const c=e(...o);let l=r.get(c);return r.has(c)?r.get(c):(l=t(...o),r.set(c,l),l)}}function TC(t){return typeof t=="string"?t.split(" ").map(e=>{const[n,r]=e.split(":");return[+n,r]}):t}function ph(t,e,n){const r=t?t():document.createElement("canvas");return r.width=e,r.height=n,r}const rf=Z6((t,e,n)=>{const r=ph(n,t*2,t*2),o=r.getContext("2d"),c=t,l=t;if(e===1)o.beginPath(),o.arc(c,l,t,0,2*Math.PI,!1),o.fillStyle="rgba(0,0,0,1)",o.fill();else{const u=o.createRadialGradient(c,l,t*e,c,l,t);u.addColorStop(0,"rgba(0,0,0,1)"),u.addColorStop(1,"rgba(0,0,0,0)"),o.fillStyle=u,o.fillRect(0,0,2*t,2*t)}return r},t=>`${t}`);function $3(t,e){const r=ph(e,256,1).getContext("2d"),o=r.createLinearGradient(0,0,256,1);return TC(t).forEach(([c,l])=>{o.addColorStop(c,l)}),r.fillStyle=o,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}function X3(t,e,n,r,o,c){const{blur:l}=o;let u=r.length;for(;u--;){const{x:d,y:h,value:p,radius:v}=r[u],m=Math.min(p,n),b=d-v,x=h-v,S=rf(v,1-l,c),E=(m-e)/(n-e);t.globalAlpha=Math.max(E,.001),t.drawImage(S,b,x)}return t}function CC(t,e,n,r,o){const{minOpacity:c,opacity:l,maxOpacity:u,useGradientOpacity:d}=o,h=0,p=0,v=e,m=n,b=t.getImageData(h,p,v,m),x=b.data,S=x.length;for(let E=3;E<S;E+=4){const w=x[E],M=w*4;if(!M)continue;const L=l||Math.max(0,Math.min(u,Math.max(c,w)));x[E-3]=r[M],x[E-2]=r[M+1],x[E-1]=r[M+2],x[E]=d?r[M+3]:L}return b}function MC(t,e,n,r,o,c,l){const u=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},c);u.minOpacity*=255,u.opacity*=255,u.maxOpacity*=255;const h=ph(l,t,e).getContext("2d"),p=$3(u.gradient,l);h.clearRect(0,0,t,e),X3(h,n,r,o,u,l);const v=CC(h,t,e,p,u),b=ph(l,t,e).getContext("2d");return b.putImageData(v,0,0),b}var LC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function gh(t,e){return Object.keys(t).reduce((n,r)=>{const o=t[r];return e(o,r)||(n[r]=o),n},{})}const Oo=(t,e)=>{const{gradient:n,opacity:r,maxOpacity:o,minOpacity:c,blur:l,useGradientOpacity:u}=t,d=LC(t,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:h,createCanvas:p,document:v}=e;return(m,b,x)=>{const{transform:S}=b,[E,w]=h.getSize(),M=m.map(W=>({x:W[0],y:W[1],value:W[2],radius:W[3]})),L=So(m,W=>W[2]),I=Or(m,W=>W[2]),z=E&&w?MC(E,w,L,I,M,gh({gradient:n,opacity:r,minOpacity:c,maxOpacity:o,blur:l,useGradientOpacity:u},W=>W===void 0),p):{canvas:null};return Wn(v.createElement("image",{})).call(Fn,x).style("x",0).style("y",0).style("width",E).style("height",w).style("src",z.canvas).style("transform",S).call(Fn,d).node()}};Oo.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const pl={heatmap:Oo},of=t=>(e,n,r,o)=>{const{x:c,y:l,size:u,color:d}=r,h=Array.from(e,p=>{const v=u?+u[p]:40;return[...o.map([+c[p],+l[p]]),d[p],v]});return[[0],[h]]};of.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:pl,channels:[...Pi({shapes:Object.keys(pl)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...li(),{type:ic},{type:oh}],postInference:[...hi(),...Ua()]};var H6=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},V6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function cc(t,e){const{text:n="text",value:r="value"}=e;return t.map(o=>Object.assign(Object.assign({},o),{text:o[n],value:o[r]}))}const Xo=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:t=>t.fontFamily}}),vh=(t,e)=>H6(void 0,void 0,void 0,function*(){const{width:n,height:r}=e,{data:o,encode:c={},scale:l,style:u={},layout:d={}}=t,h=V6(t,["data","encode","scale","style","layout"]),p=cc(o,c);return en({},Xo(),Object.assign(Object.assign({data:{value:p,transform:[Object.assign({type:"wordCloud",size:[n,r]},d)]},encode:c,scale:l,style:u},h),{axis:!1}))});vh.props={};const va=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];va.props={};const Av=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];Av.props={};const mh=t=>new qi(t);mh.props={};const gl=Symbol("defaultUnknown");function q3(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function Tv(t){const{value:e,from:n,to:r,mapper:o,notFoundReturn:c}=t;let l=o.get(e);if(l===void 0){if(c!==gl)return c;l=n.push(e)-1,o.set(e,l)}return r[l%r.length]}function K3(t){return t instanceof Date?e=>`${e}`:typeof t=="object"?e=>JSON.stringify(e):e=>e}class lc extends $l{getDefaultOptions(){return{domain:[],range:[],unknown:gl}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&q3(this.domainIndexMap,this.getDomain(),this.domainKey),Tv({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&q3(this.rangeIndexMap,this.getRange(),this.rangeKey),Tv({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=K3(n),this.rangeKey=K3(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new lc(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:n}=this.options;return this.sortedDomain=n?[...e].sort(n):e,this.sortedDomain}}const yh=t=>new lc(t);yh.props={};function PC({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Q3({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function W6({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function IC(t){return typeof t=="object"?t.valueOf():t}class J3 extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=IC,e!==null)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(PC({map:this.map,initKey:this.initKey},e))}has(e){return super.has(PC({map:this.map,initKey:this.initKey},e))}set(e,n){return super.set(Q3({map:this.map,initKey:this.initKey},e),n)}delete(e){return super.delete(W6({map:this.map,initKey:this.initKey},e))}}function RC(t){const e=Math.min(...t);return t.map(n=>n/e)}function kC(t,e){const n=t.length,r=e-n;return r>0?[...t,...new Array(r).fill(1)]:r<0?t.slice(0,e):t}function tS(t){return Math.round(t*1e12)/1e12}function eS(t){const{domain:e,range:n,paddingOuter:r,paddingInner:o,flex:c,round:l,align:u}=t,d=e.length,h=kC(c,d),[p,v]=n,m=v-p,b=2/d*r+1-1/d*o,x=m/b,S=x*o/d,E=x-d*S,w=RC(h),M=w.reduce((Ht,dt)=>Ht+dt),L=E/M,I=new J3(e.map((Ht,dt)=>{const Ot=w[dt]*L;return[Ht,l?Math.floor(Ot):Ot]})),R=new J3(e.map((Ht,dt)=>{const bt=w[dt]*L+S;return[Ht,l?Math.floor(bt):bt]})),z=Array.from(R.values()).reduce((Ht,dt)=>Ht+dt),Y=(m-(z-z/d*o))*u,st=p+Y;let xt=l?Math.round(st):st;const Nt=new Array(d);for(let Ht=0;Ht<d;Ht+=1){Nt[Ht]=tS(xt);const dt=e[Ht];xt+=R.get(dt)}return{valueBandWidth:I,valueStep:R,adjustedRange:Nt}}function DC(t){var e;const{domain:n}=t,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=t.flex)===null||e===void 0)&&e.length))return eS(t);const{range:c,paddingOuter:l,paddingInner:u,round:d,align:h}=t;let p,v,m=c[0];const x=c[1]-m,S=l*2,E=r-u;p=x/Math.max(1,S+E),d&&(p=Math.floor(p)),m+=(x-p*(r-u))*h,v=p*(1-u),d&&(m=Math.round(m),v=Math.round(v));const w=new Array(r).fill(0).map((M,L)=>m+L*p);return{valueStep:p,valueBandWidth:v,adjustedRange:w}}class vs extends lc{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:gl,flex:[]}}constructor(e){super(e)}clone(){return new vs(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:n}=this.options;return e>0?e:n}getPaddingOuter(){const{padding:e,paddingOuter:n}=this.options;return e>0?e:n}rescale(){super.rescale();const{align:e,domain:n,range:r,round:o,flex:c}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:d}=DC({align:e,range:r,round:o,flex:c,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=d,this.valueBandWidth=u,this.adjustedRange=l}}const bh=t=>new vs(t);bh.props={};class _h extends $l{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:o0}}map(e){return Ja(e)?e:this.options.unknown}invert(e){return this.map(e)}clone(){return new _h(this.options)}getTicks(){const{domain:e,tickCount:n,tickMethod:r}=this.options,[o,c]=e;return!(0,ne.Z)(o)||!(0,ne.Z)(c)?[]:r(o,c,n)}}const nS=t=>new _h(t);nS.props={};class Cv extends vs{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:gl,paddingInner:1,paddingOuter:0}}constructor(e){super(e)}getPaddingInner(){return 1}clone(){return new Cv(this.options)}update(e){super.update(e)}getPaddingOuter(){return this.options.padding}}const Mv=t=>new Cv(t);Mv.props={};var rS=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,ms="\\d\\d?",ys="\\d\\d",FC="\\d{3}",NC="\\d{4}",vl="[^\\s]+",iS=/\[([^]*?)\]/gm;function oS(t,e){for(var n=[],r=0,o=t.length;r<o;r++)n.push(t[r].substr(0,e));return n}var aS=function(t){return function(e,n){var r=n[t].map(function(c){return c.toLowerCase()}),o=r.indexOf(e.toLowerCase());return o>-1?o:null}};function uc(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,o=e;r<o.length;r++){var c=o[r];for(var l in c)t[l]=c[l]}return t}var sS=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],cS=["January","February","March","April","May","June","July","August","September","October","November","December"],BC=oS(cS,3),a=oS(sS,3),i={dayNamesShort:a,dayNames:sS,monthNamesShort:BC,monthNames:cS,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!==10?1:0)*t%10]}},s=uc({},i),f=function(t){return s=uc(s,t)},g=function(t){return t.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},y=function(t,e){for(e===void 0&&(e=2),t=String(t);t.length<e;)t="0"+t;return t},_={D:function(t){return String(t.getDate())},DD:function(t){return y(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return y(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return y(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return y(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return y(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return y(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return y(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return y(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return y(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return y(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return y(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+y(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+y(Math.floor(Math.abs(e)/60),2)+":"+y(Math.abs(e)%60,2)}},O=function(t){return+t-1},A=[null,ms],P=[null,vl],B=["isPm",vl,function(t,e){var n=t.toLowerCase();return n===e.amPm[0]?0:n===e.amPm[1]?1:null}],U=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(t){var e=(t+"").match(/([+-]|\d\d)/gi);if(e){var n=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?n:-n}return 0}],G={D:["day",ms],DD:["day",ys],Do:["day",ms+vl,function(t){return parseInt(t,10)}],M:["month",ms,O],MM:["month",ys,O],YY:["year",ys,function(t){var e=new Date,n=+(""+e.getFullYear()).substr(0,2);return+(""+(+t>68?n-1:n)+t)}],h:["hour",ms,void 0,"isPm"],hh:["hour",ys,void 0,"isPm"],H:["hour",ms],HH:["hour",ys],m:["minute",ms],mm:["minute",ys],s:["second",ms],ss:["second",ys],YYYY:["year",NC],S:["millisecond","\\d",function(t){return+t*100}],SS:["millisecond",ys,function(t){return+t*10}],SSS:["millisecond",FC],d:A,dd:A,ddd:P,dddd:P,MMM:["month",vl,aS("monthNamesShort")],MMMM:["month",vl,aS("monthNames")],a:B,A:B,ZZ:U,Z:U},vt={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},$t=function(t){return uc(vt,t)},te=function(t,e,n){if(e===void 0&&(e=vt.default),n===void 0&&(n={}),typeof t=="number"&&(t=new Date(t)),Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");e=vt[e]||e;var r=[];e=e.replace(iS,function(c,l){return r.push(l),"@@@"});var o=uc(uc({},s),n);return e=e.replace(rS,function(c){return _[c](t,o)}),e.replace(/@@@/g,function(){return r.shift()})};function Te(t,e,n){if(n===void 0&&(n={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=vt[e]||e,t.length>1e3)return null;var r=new Date,o={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},c=[],l=[],u=e.replace(iS,function(I,R){return l.push(g(R)),"@@@"}),d={},h={};u=g(u).replace(rS,function(I){var R=G[I],z=R[0],W=R[1],Y=R[3];if(d[z])throw new Error("Invalid format. "+z+" specified twice in format");return d[z]=!0,Y&&(h[Y]=!0),c.push(R),"("+W+")"}),Object.keys(h).forEach(function(I){if(!d[I])throw new Error("Invalid format. "+I+" is required in specified format")}),u=u.replace(/@@@/g,function(){return l.shift()});var p=t.match(new RegExp(u,"i"));if(!p)return null;for(var v=uc(uc({},s),n),m=1;m<p.length;m++){var b=c[m-1],x=b[0],S=b[2],E=S?S(p[m],v):+p[m];if(E==null)return null;o[x]=E}o.isPm===1&&o.hour!=null&&+o.hour!=12?o.hour=+o.hour+12:o.isPm===0&&+o.hour==12&&(o.hour=0);var w;if(o.timezoneOffset==null){w=new Date(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond);for(var M=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],m=0,L=M.length;m<L;m++)if(d[M[m][0]]&&o[M[m][0]]!==w[M[m][1]]())return null}else if(w=new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute-o.timezoneOffset,o.second,o.millisecond)),o.month>11||o.month<0||o.day>31||o.day<1||o.hour>23||o.hour<0||o.minute>59||o.minute<0||o.second>59||o.second<0)return null;return w}var Fe={format:te,parse:Te,defaultI18n:i,setGlobalDateI18n:f,setGlobalDateMasks:$t},Ze=null;const je=1e3,Qe=je*60,ln=Qe*60,wn=ln*24,mn=wn*7,Mn=wn*30,rr=wn*365;function Qn(t,e,n,r){const o=(h,p)=>{const v=b=>r(b)%p===0;let m=p;for(;m&&!v(h);)n(h,-1),m-=1;return h},c=(h,p)=>{p&&o(h,p),e(h)},l=(h,p)=>{const v=new Date(+h);return c(v,p),v},u=(h,p)=>{const v=new Date(+h-1);return c(v,p),n(v,p),c(v),v};return{ceil:u,floor:l,range:(h,p,v,m)=>{const b=[],x=Math.floor(v),S=m?u(h,v):u(h);for(let E=S;E<p;n(E,x),c(E))b.push(new Date(+E));return b},duration:t}}const Yn=Qn(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),lr=Qn(je,t=>{t.setMilliseconds(0)},(t,e=1)=>{t.setTime(+t+je*e)},t=>t.getSeconds()),Rr=Qn(Qe,t=>{t.setSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Qe*e)},t=>t.getMinutes()),qo=Qn(ln,t=>{t.setMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+ln*e)},t=>t.getHours()),ml=Qn(wn,t=>{t.setHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+wn*e)},t=>t.getDate()-1),fc=Qn(Mn,t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getMonth();t.setMonth(n+e)},t=>t.getMonth()),yl=Qn(mn,t=>{t.setDate(t.getDate()-t.getDay()%7),t.setHours(0,0,0,0)},(t,e=1)=>{t.setDate(t.getDate()+7*e)},t=>{const e=fc.floor(t),n=new Date(+t);return Math.floor((+n-+e)/mn)}),bl=Qn(rr,t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e=1)=>{const n=t.getFullYear();t.setFullYear(n+e)},t=>t.getFullYear()),jo={millisecond:Yn,second:lr,minute:Rr,hour:qo,day:ml,week:yl,month:fc,year:bl},jC=Qn(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),zC=Qn(je,t=>{t.setUTCMilliseconds(0)},(t,e=1)=>{t.setTime(+t+je*e)},t=>t.getUTCSeconds()),UC=Qn(Qe,t=>{t.setUTCSeconds(0,0)},(t,e=1)=>{t.setTime(+t+Qe*e)},t=>t.getUTCMinutes()),ZC=Qn(ln,t=>{t.setUTCMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+ln*e)},t=>t.getUTCHours()),HC=Qn(wn,t=>{t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+wn*e)},t=>t.getUTCDate()-1),lS=Qn(Mn,t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCMonth();t.setUTCMonth(n+e)},t=>t.getUTCMonth()),VC=Qn(mn,t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7)%7),t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+mn*e)},t=>{const e=lS.floor(t),n=new Date(+t);return Math.floor((+n-+e)/mn)}),WC=Qn(rr,t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{const n=t.getUTCFullYear();t.setUTCFullYear(n+e)},t=>t.getUTCFullYear()),uS={millisecond:jC,second:zC,minute:UC,hour:ZC,day:HC,week:VC,month:lS,year:WC};function jn(t){const e=t?uS:jo,{year:n,month:r,week:o,day:c,hour:l,minute:u,second:d,millisecond:h}=e;return{tickIntervals:[[d,1],[d,5],[d,15],[d,30],[u,1],[u,5],[u,15],[u,30],[l,1],[l,3],[l,6],[l,12],[c,1],[c,2],[o,1],[r,1],[r,3],[n,1]],year:n,millisecond:h}}function gr(t,e,n,r,o){const c=+t,l=+e,{tickIntervals:u,year:d,millisecond:h}=jn(o),p=([E,w])=>E.duration*w,v=r?(l-c)/r:n||5,m=r||(l-c)/v,b=u.length,x=Zf(u,m,0,b,p);let S;if(x===b){const E=f1(c/d.duration,l/d.duration,v);S=[d,E]}else if(x){const E=m/p(u[x-1])<p(u[x])/m,[w,M]=E?u[x-1]:u[x],L=r?Math.ceil(r/w.duration):M;S=[w,L]}else{const E=Math.max(f1(c,l,v),1);S=[h,E]}return S}const Tr=(t,e,n,r,o)=>{const c=t>e,l=c?e:t,u=c?t:e,[d,h]=gr(l,u,n,r,o),p=d.range(l,new Date(+u+1),h,!0);return c?p.reverse():p},_n=(t,e,n,r,o)=>{const c=t>e,l=c?e:t,u=c?t:e,[d,h]=gr(l,u,n,r,o),p=[d.floor(l,h),d.ceil(u,h)];return c?p.reverse():p};function go(t,e){const{second:n,minute:r,hour:o,day:c,week:l,month:u,year:d}=e;return n.floor(t)<t?".SSS":r.floor(t)<t?":ss":o.floor(t)<t?"hh:mm":c.floor(t)<t?"hh A":u.floor(t)<t?l.floor(t)<t?"MMM DD":"ddd DD":d.floor(t)<t?"MMMM":"YYYY"}function Qr(t){const e=t.getTimezoneOffset(),n=new Date(t);return n.setMinutes(n.getMinutes()+e,n.getSeconds(),n.getMilliseconds()),n}class oo extends Wf{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:Tr,interpolate:Ns,mask:void 0,utc:!1}}chooseTransforms(){return[r=>+r,r=>new Date(r)]}chooseNice(){return _n}getTickMethodOptions(){const{domain:e,tickCount:n,tickInterval:r,utc:o}=this.options,c=e[0],l=e[e.length-1];return[c,l,n,r,o]}getFormatter(){const{mask:e,utc:n}=this.options,r=n?uS:jo,o=n?Qr:Fs;return c=>te(o(c),e||go(c,r))}clone(){return new oo(this.options)}}const vo=t=>new oo(t);vo.props={};const bs=t=>e=>-t(-e),xh=(t,e)=>{const n=Math.log(t),r=t===Math.E?Math.log:t===10?Math.log10:t===2?Math.log2:o=>Math.log(o)/n;return e?bs(r):r},GC=(t,e)=>{const n=t===Math.E?Math.exp:r=>Ri(t,r);return e?bs(n):n},ik=(t,e,n,r=10)=>{const o=t<0,c=GC(r,o),l=xh(r,o),u=e<t,d=u?e:t,h=u?t:e;let p=l(d),v=l(h),m=[];if(!(r%1)&&v-p<n){if(p=Math.floor(p),v=Math.ceil(v),o)for(;p<=v;p+=1){const b=c(p);for(let x=r-1;x>=1;x-=1){const S=b*x;if(S>h)break;S>=d&&m.push(S)}}else for(;p<=v;p+=1){const b=c(p);for(let x=1;x<r;x+=1){const S=b*x;if(S>h)break;S>=d&&m.push(S)}}m.length*2<n&&(m=Bs(d,h,n))}else{const b=n===-1?v-p:Math.min(v-p,n);m=Bs(p,v,b).map(c)}return u?m.reverse():m},ok=(t,e,n,r)=>{const o=t<0,c=xh(r,o),l=GC(r,o),u=t>e,d=u?e:t,h=u?t:e,p=[l(Math.floor(c(d))),l(Math.ceil(c(h)))];return u?p.reverse():p};class YC extends Wf{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:Xl,tickMethod:ik,tickCount:5}}chooseNice(){return ok}getTickMethodOptions(){const{domain:e,tickCount:n,base:r}=this.options,o=e[0],c=e[e.length-1];return[o,c,n,r]}chooseTransforms(){const{base:e,domain:n}=this.options,r=n[0]<0;return[xh(e,r),GC(e,r)]}clone(){return new YC(this.options)}}const G6=t=>new YC(t);G6.props={};const ak=t=>e=>e<0?-Ri(-e,t):Ri(e,t),sk=t=>e=>e<0?-Ri(-e,1/t):Ri(e,1/t),ck=t=>t<0?-Math.sqrt(-t):Math.sqrt(t);class fS extends Wf{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:Xl,tickMethod:Bs,tickCount:5}}constructor(e){super(e)}chooseTransforms(){const{exponent:e}=this.options;if(e===1)return[Fs,Fs];const n=e===.5?ck:ak(e),r=sk(e);return[n,r]}clone(){return new fS(this.options)}}const Y6=t=>new fS(t);Y6.props={};class $C extends fS{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Xl,tickMethod:Bs,tickCount:5,exponent:.5}}constructor(e){super(e)}update(e){super.update(e)}clone(){return new $C(this.options)}}const $6=t=>new $C(t);$6.props={};const X6=t=>new kc(t);X6.props={};const q6=t=>new Jf(t);q6.props={};const K6=t=>new Qf(t);K6.props={};const lk=t=>e=>{const n=t(e);return(0,ne.Z)(n)?Math.round(n):n};function uk(t,e){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[r]=this.chooseTransforms();this.composeOutput(r,this.chooseClamp(r))},n.prototype.initRange=function(){const{interpolator:r}=this.options;this.options.range=t(r)},n.prototype.composeOutput=function(r,o){const{domain:c,interpolator:l,round:u}=this.getOptions(),d=e(c.map(r)),h=u?lk(l):l;this.output=Pc(h,d,o,r)},n.prototype.invert=void 0}}var fk=function(t,e,n,r){var o=arguments.length,c=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(l=t[u])&&(c=(o<3?l(c):o>3?l(e,n,c):l(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},XC;function dk(t){return[t(0),t(1)]}const hk=t=>{const[e,n]=t;return Pc(Ns(0,1),Uf(e,n))};let qC=XC=class extends qi{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Fs,tickMethod:Bs,tickCount:5}}constructor(e){super(e)}clone(){return new XC(this.options)}};qC=XC=fk([uk(dk,hk)],qC);const Q6=t=>new qC(t);Q6.props={};const J6=t=>new au(t);J6.props={};function KC({colorDefault:t,colorBlack:e,colorWhite:n,colorStroke:r,colorBackground:o,padding1:c,padding2:l,padding3:u,alpha90:d,alpha65:h,alpha45:p,alpha25:v,alpha10:m,category10:b,category20:x,sizeDefault:S=1,padding:E="auto",margin:w=16}){return{padding:E,margin:w,size:S,color:t,category10:b,category20:x,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:o,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:e,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:r,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:r,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:r,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:r,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:r,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:r,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:r,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:e,gridStrokeOpacity:m,labelAlign:"horizontal",labelFill:e,labelOpacity:p,labelFontSize:12,labelFontWeight:"normal",labelSpacing:c,line:!1,lineLineWidth:.5,lineStroke:e,lineStrokeOpacity:p,tickLength:4,tickLineWidth:1,tickStroke:e,tickOpacity:p,titleFill:e,titleOpacity:d,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",label:!1,tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:e,itemLabelFillOpacity:d,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[c,c],itemValueFill:e,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:e,navButtonFillOpacity:.65,navPageNumFill:e,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:e,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:e,tickStrokeOpacity:.25,rowPadding:c,colPadding:l,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:e,handleLabelFillOpacity:p,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:e,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:e,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:e,labelFillOpacity:p,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:d,tickStroke:e,tickStrokeOpacity:p},label:{fill:e,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:e,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:n,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:e,fontWeight:"normal"},slider:{trackSize:16,trackFill:r,trackFillOpacity:1,selectionFill:t,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:e,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:e,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:e,titleFillOpacity:d,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:e,subtitleFillOpacity:h,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{".g2-tooltip":{"font-family":"sans-serif"}}}}}const pk=KC({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),QC=t=>en({},pk,t);QC.props={};const tP=t=>en({},QC(),{category10:"category10",category20:"category20"},t);tP.props={};const gk=KC({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),eP=t=>en({},gk,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{".g2-tooltip":{background:"#1f1f1f",opacity:.95},".g2-tooltip-title":{color:"#A6A6A6"},".g2-tooltip-list-item-name-label":{color:"#A6A6A6"},".g2-tooltip-list-item-value":{color:"#A6A6A6"}}}},t),nP=t=>Object.assign({},eP(),{category10:"category10",category20:"category20"},t);nP.props={};const vk=KC({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),rP=t=>en({},vk,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(e,n)=>n!==0},axisRight:{gridFilter:(e,n)=>n!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},t);rP.props={};const iP=t=>(...e)=>{const n=La(Object.assign({},{crossPadding:50},t))(...e);return S1(n,t),n};iP.props=Object.assign(Object.assign({},La.props),{defaultPosition:"bottom"});function IV(){}const oP=t=>(...e)=>{const n=La(Object.assign({},{crossPadding:10},t))(...e);return S1(n,t),n};oP.props=Object.assign(Object.assign({},La.props),{defaultPosition:"left"});var JC=function(){},mk=function(t,e,n){var r=t,o=(0,gt.Z)(e)?e.split("."):e;return o.forEach(function(c,l){l<o.length-1?((0,ts.Z)(r[c])||(r[c]=(0,ne.Z)(o[l+1])?[]:{}),r=r[c]):r[c]=n}),t};function yk(t,e){return t.reduce(function(n,r){return(n[r[e]]=n[r[e]]||[]).push(r),n},{})}function bk(t){var e;return((e=t[0])===null||e===void 0?void 0:e.map(function(n,r){return t.map(function(o){return o[r]})}))||[]}var ma=Io({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),_k=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:k1(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(o,c){return"".concat(o,"/").concat(c)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new F.ZA({class:ma.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new F.ZA({class:ma.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var n=this.attributes.defaultPage;return(0,ce.Z)(n,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var n=this.pageViews,r=(0,T.CR)(bk(n.map(function(v){var m=v.getBBox(),b=m.width,x=m.height;return[b,x]})).map(function(v){return Math.max.apply(Math,(0,T.ev)([],(0,T.CR)(v),!1))}),2),o=r[0],c=r[1],l=this.attributes,u=l.pageWidth,d=u===void 0?o:u,h=l.pageHeight,p=h===void 0?c:h;return{pageWidth:d,pageHeight:p}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n=t.prototype.getBBox.call(this),r=n.x,o=n.y,c=this.controllerShape,l=this.pageShape,u=l.pageWidth,d=l.pageHeight;return new Hn(r,o,u+c.width,d)},e.prototype.goTo=function(n){var r=this,o=this.attributes.animate,c=this,l=c.currPage,u=c.playState,d=c.playWindow,h=c.pageViews;if(u!=="idle"||n<0||h.length<=0||n>=h.length)return null;h[l].setLocalPosition(0,0),this.prepareFollowingPage(n);var p=(0,T.CR)(this.getFollowingPageDiff(n),2),v=p[0],m=p[1];this.playState="running";var b=Mf(d,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-v,", ").concat(-m,")")}],o);return Aa(b,function(){r.innerCurrPage=n,r.playState="idle",r.setVisiblePages([n]),r.updatePageInfo()}),b},e.prototype.prev=function(){var n=this.attributes.loop,r=this.pageViews.length,o=this.currPage;if(!n&&o<=0)return null;var c=n?(o-1+r)%r:(0,ce.Z)(o-1,0,r);return this.goTo(c)},e.prototype.next=function(){var n=this.attributes.loop,r=this.pageViews.length,o=this.currPage;if(!n&&o>=r-1)return null;var c=n?(o+1)%r:(0,ce.Z)(o+1,0,r);return this.goTo(c)},e.prototype.renderClipPath=function(n){var r=this.pageShape,o=r.pageWidth,c=r.pageHeight;if(!o||!c){this.contentGroup.style.clipPath=void 0;return}this.clipPath=n.maybeAppendByClassName(ma.clipPath,"rect").styles({width:o,height:c}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(n){this.playWindow.children.forEach(function(r,o){n.includes(o)?kl(r):Po(r)})},e.prototype.adjustControllerLayout=function(){var n=this,r=n.prevBtnGroup,o=n.nextBtnGroup,c=n.pageInfoGroup,l=this.attributes,u=l.orientation,d=l.controllerPadding,h=c.getBBox(),p=h.width,v=h.height,m=(0,T.CR)(u==="horizontal"?[-180,0]:[-90,90],2),b=m[0],x=m[1];r.setLocalEulerAngles(b),o.setLocalEulerAngles(x);var S=r.getBBox(),E=S.width,w=S.height,M=o.getBBox(),L=M.width,I=M.height,R=Math.max(E,p,L),z=u==="horizontal"?{offset:[[0,0],[E/2+d,0],[E+p+d*2,0]],textAlign:"start"}:{offset:[[R/2,-w-d],[R/2,0],[R/2,I+d]],textAlign:"center"},W=(0,T.CR)(z.offset,3),Y=(0,T.CR)(W[0],2),st=Y[0],xt=Y[1],Nt=(0,T.CR)(W[1],2),Ht=Nt[0],dt=Nt[1],Ot=(0,T.CR)(W[2],2),bt=Ot[0],wt=Ot[1],oe=z.textAlign,Ut=c.querySelector("text");Ut&&(Ut.style.textAlign=oe),r.setLocalPosition(st,xt),c.setLocalPosition(Ht,dt),o.setLocalPosition(bt,wt)},e.prototype.updatePageInfo=function(){var n,r=this,o=r.currPage,c=r.pageViews,l=r.attributes.formatter;c.length<2||((n=this.pageInfoGroup.querySelector(ma.pageInfo.class))===null||n===void 0||n.attr("text",l(o+1,c.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(n){var r=this.currPage;if(r===n)return[0,0];var o=this.attributes.orientation,c=this.pageShape,l=c.pageWidth,u=c.pageHeight,d=n<r?-1:1;return o==="horizontal"?[d*l,0]:[0,d*u]},e.prototype.prepareFollowingPage=function(n){var r=this,o=r.currPage,c=r.pageViews;if(this.setVisiblePages([n,o]),n!==o){var l=(0,T.CR)(this.getFollowingPageDiff(n),2),u=l[0],d=l[1];c[n].setLocalPosition(u,d)}},e.prototype.renderController=function(n){var r=this,o=this.attributes.controllerSpacing,c=this.pageShape,l=c.pageWidth,u=c.pageHeight,d=this.pageViews.length>=2,h=n.maybeAppendByClassName(ma.controller,"g");if(Tf(h.node(),d),!!d){var p=or(this.attributes,"button"),v=or(this.attributes,"pageNum"),m=(0,T.CR)(Ca(p),2),b=m[0],x=m[1],S=b.size,E=(0,T._T)(b,["size"]),w=!h.select(ma.prevBtnGroup.class).node(),M=h.maybeAppendByClassName(ma.prevBtnGroup,"g").styles(x);this.prevBtnGroup=M.node();var L=M.maybeAppendByClassName(ma.prevBtn,"path"),I=h.maybeAppendByClassName(ma.nextBtnGroup,"g").styles(x);this.nextBtnGroup=I.node();var R=I.maybeAppendByClassName(ma.nextBtn,"path");[L,R].forEach(function(W){W.styles((0,T.pi)((0,T.pi)({},E),{transformOrigin:"center"})),Ap(W.node(),S,!0)});var z=h.maybeAppendByClassName(ma.pageInfoGroup,"g");this.pageInfoGroup=z.node(),z.maybeAppendByClassName(ma.pageInfo,"text").styles(v),this.updatePageInfo(),h.node().setLocalPosition(l+o,u/2),w&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(n,r){var o=n.x,c=o===void 0?0:o,l=n.y,u=l===void 0?0:l;this.attr("transform","translate(".concat(c,", ").concat(u,")"));var d=qn(r);this.renderClipPath(d),this.renderController(d),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var n=this,r=Kh(function(){return n.render(n.attributes,n)},50);this.playWindow.addEventListener(F.Dk.INSERTED,r),this.playWindow.addEventListener(F.Dk.REMOVED,r)},e}(Ni),Ko=Io({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function xk(t){var e=t.querySelector(Ko.marker.class);return e?e.style:{}}var Sk=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,{span:[1,1],marker:function(){return new F.Cd({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var n=this.attributes.valueText;return n?typeof n=="string"||typeof n=="number"?n!=="":typeof n=="function"?!0:n.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var n=this.labelGroup,r=this.valueGroup,o=this.attributes.markerSize,c=n.node().getBBox(),l=c.width,u=c.height,d=r.node().getBBox(),h=d.width,p=d.height;return{markerWidth:o,labelWidth:l,valueWidth:h,height:Math.max(o,u,p)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var n=this.attributes.span;if(!n)return[1,1];var r=(0,T.CR)(Zi(n),2),o=r[0],c=r[1],l=this.showValue?c:0,u=o+l;return[o/u,l/u]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var n,r=this.attributes,o=r.markerSize,c=r.width,l=this.actualSpace,u=l.markerWidth,d=l.height,h=this.actualSpace,p=h.labelWidth,v=h.valueWidth,m=(0,T.CR)(this.spacing,2),b=m[0],x=m[1];if(c){var S=c-o-b-x,E=(0,T.CR)(this.span,2),w=E[0],M=E[1];n=(0,T.CR)([w*S,M*S],2),p=n[0],v=n[1]}var L=u+p+v+b+x;return{width:L,height:d,markerWidth:u,labelWidth:p,valueWidth:v}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var n=this.attributes.spacing;if(!n)return[0,0];var r=(0,T.CR)(Zi(n),2),o=r[0],c=r[1];return this.showValue?[o,c]:[o,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var n=this.shape,r=n.markerWidth,o=n.labelWidth,c=n.valueWidth,l=n.width,u=n.height,d=(0,T.CR)(this.spacing,2),h=d[0],p=d[1];return{height:u,width:l,markerWidth:r,labelWidth:o,valueWidth:c,position:[r/2,r+h,r+o+h+p]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var n=xk(this.markerGroup.node()),r=this.attributes,o=r.markerSize,c=r.markerStrokeWidth,l=c===void 0?n.strokeWidth:c,u=r.markerLineWidth,d=u===void 0?n.lineWidth:u,h=r.markerStroke,p=h===void 0?n.stroke:h,v=+(l||d||(p?1:0))*Math.sqrt(2),m=this.markerGroup.node().getBBox(),b=m.width,x=m.height;return(1-v/Math.max(b,x))*o},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(n){var r=this,o=this.attributes.marker,c=or(this.attributes,"marker");this.markerGroup=n.maybeAppendByClassName(Ko.markerGroup,"g").style("zIndex",0),ro(!!o,this.markerGroup,function(){var l,u=r.markerGroup.node(),d=(l=u.childNodes)===null||l===void 0?void 0:l[0],h=typeof o=="string"?new wr({style:{symbol:o},className:Ko.marker.name}):o();d?h.nodeName===d.nodeName?d instanceof wr?d.update((0,T.pi)((0,T.pi)({},c),{symbol:o})):(XE(d,h),qn(d).styles(c)):(d.remove(),qn(h).attr("className",Ko.marker.name).styles(c),u.appendChild(h)):(h instanceof wr||qn(h).attr("className",Ko.marker.name).styles(c),u.appendChild(h)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var p=Ap(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(p,")")})},e.prototype.renderLabel=function(n){var r=or(this.attributes,"label"),o=r.text,c=(0,T._T)(r,["text"]);this.labelGroup=n.maybeAppendByClassName(Ko.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Ko.label,function(){return Rs(o)}).styles(c)},e.prototype.renderValue=function(n){var r=this,o=or(this.attributes,"value"),c=o.text,l=(0,T._T)(o,["text"]);this.valueGroup=n.maybeAppendByClassName(Ko.valueGroup,"g").style("zIndex",0),ro(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Ko.value,function(){return Rs(c)}).styles(l)})},e.prototype.renderBackground=function(n){var r=this.shape,o=r.width,c=r.height,l=or(this.attributes,"background");this.background=n.maybeAppendByClassName(Ko.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Ko.background,"rect").styles((0,T.pi)({width:o,height:c},l))},e.prototype.adjustLayout=function(){var n=this.layout,r=n.labelWidth,o=n.valueWidth,c=n.height,l=(0,T.CR)(n.position,3),u=l[0],d=l[1],h=l[2],p=c/2;this.markerGroup.styles({transform:"translate(".concat(u,", ").concat(p,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(d,", ").concat(p,")")}),Fp(this.labelGroup.select(Ko.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(h,", ").concat(p,")")}),Fp(this.valueGroup.select(Ko.value.class).node(),Math.ceil(o)))},e.prototype.render=function(n,r){var o=qn(r),c=n.x,l=c===void 0?0:c,u=n.y,d=u===void 0?0:u;o.styles({transform:"translate(".concat(l,", ").concat(d,")")}),this.renderMarker(o),this.renderLabel(o),this.renderValue(o),this.renderBackground(o),this.adjustLayout()},e}(Ni),af=Io({page:"item-page",navigator:"navigator",item:"item"},"items"),aP=function(t,e,n){return n===void 0&&(n=!0),t?e(t):n},Ok=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:JC,mouseenter:JC,mouseleave:JC})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var n=this.attributes,r=n.gridRow,o=n.gridCol,c=n.data;if(!r&&!o)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&o?[r,o]:r?[r,c.length]:[c.length,o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var n=this.attributes,r=n.data,o=n.layout,c=or(this.attributes,"item"),l=r.map(function(u,d){var h=u.id,p=h===void 0?d:h,v=u.label,m=u.value;return{id:"".concat(p),index:d,style:(0,T.pi)({layout:o,labelText:v,valueText:m},Object.fromEntries(Object.entries(c).map(function(b){var x=(0,T.CR)(b,2),S=x[0],E=x[1];return[S,_o(E,[u,d,r])]})))}});return l},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var n=this,r=this.attributes,o=r.orientation,c=r.width,l=r.rowPadding,u=r.colPadding,d=(0,T.CR)(this.navigatorShape,1),h=d[0],p=(0,T.CR)(this.grid,2),v=p[0],m=p[1],b=m*v,x=0;return this.pageViews.children.map(function(S,E){var w,M,L=Math.floor(E/b),I=E%b,R=n.ifHorizontal(m,v),z=[Math.floor(I/R),I%R];o==="vertical"&&z.reverse();var W=(0,T.CR)(z,2),Y=W[0],st=W[1],xt=(c-h-(m-1)*u)/m,Nt=S.getBBox().height,Ht=(0,T.CR)([0,0],2),dt=Ht[0],Ot=Ht[1];return o==="horizontal"?(w=(0,T.CR)([x,Y*(Nt+l)],2),dt=w[0],Ot=w[1],x=st===m-1?0:x+xt+u):(M=(0,T.CR)([st*(xt+u),x],2),dt=M[0],Ot=M[1],x=Y===v-1?0:x+Nt+l),{page:L,index:E,row:Y,col:st,pageIndex:I,width:xt,height:Nt,x:dt,y:Ot}})},e.prototype.getFlexLayout=function(){var n=this.attributes,r=n.width,o=n.height,c=n.rowPadding,l=n.colPadding,u=(0,T.CR)(this.navigatorShape,1),d=u[0],h=(0,T.CR)(this.grid,2),p=h[0],v=h[1],m=(0,T.CR)([r-d,o],2),b=m[0],x=m[1],S=(0,T.CR)([0,0,0,0,0,0,0,0],8),E=S[0],w=S[1],M=S[2],L=S[3],I=S[4],R=S[5],z=S[6],W=S[7];return this.pageViews.children.map(function(Y,st){var xt,Nt,Ht,dt,Ot=Y.getBBox(),bt=Ot.width,wt=Ot.height,oe=z===0?0:l,Ut=z+oe+bt;if(Ut<=b&&aP(I,function(me){return me<v}))return xt=(0,T.CR)([z+oe,W,Ut],3),E=xt[0],w=xt[1],z=xt[2],{width:bt,height:wt,x:E,y:w,page:M,index:st,pageIndex:L++,row:R,col:I++};Nt=(0,T.CR)([R+1,0,0,W+wt+c],4),R=Nt[0],I=Nt[1],z=Nt[2],W=Nt[3];var Kt=W+wt;return Kt<=x&&aP(R,function(me){return me<p})?(Ht=(0,T.CR)([z,W,bt],3),E=Ht[0],w=Ht[1],z=Ht[2],{width:bt,height:wt,x:E,y:w,page:M,index:st,pageIndex:L++,row:R,col:I++}):(dt=(0,T.CR)([0,0,bt,0,M+1,0,0,0],8),E=dt[0],w=dt[1],z=dt[2],W=dt[3],M=dt[4],L=dt[5],R=dt[6],I=dt[7],{width:bt,height:wt,x:E,y:w,page:M,index:st,pageIndex:L++,row:R,col:I++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var n=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=n.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],n.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(n,r){var o=this.attributes.orientation;return aa(o,n,r)},e.prototype.flattenPage=function(n){n.querySelectorAll(af.item.class).forEach(function(r){n.appendChild(r)}),n.querySelectorAll(af.page.class).forEach(function(r){var o=n.removeChild(r);o.destroy()})},e.prototype.renderItems=function(n){var r=this.attributes,o=r.click,c=r.mouseenter,l=r.mouseleave;this.flattenPage(n);var u=this.dispatchCustomEvent.bind(this);qn(n).selectAll(af.item.class).data(this.renderData,function(d){return d.id}).join(function(d){return d.append(function(h){var p=h.style;return new Sk({style:p})}).attr("className",af.item.name).on("click",function(){o==null||o(this),u("itemClick",{item:this})}).on("pointerenter",function(){c==null||c(this),u("itemMouseenter",{item:this})}).on("pointerleave",function(){l==null||l(this),u("itemMouseleave",{item:this})})},function(d){return d.each(function(h){var p=h.style;this.update(p)})},function(d){return d.remove()})},e.prototype.relayoutNavigator=function(){var n,r=this.attributes,o=r.layout,c=r.width,l=((n=this.pageViews.children[0])===null||n===void 0?void 0:n.getBBox().height)||0,u=(0,T.CR)(this.navigatorShape,2),d=u[0],h=u[1];this.navigator.update(o==="grid"?{pageWidth:c-d,pageHeight:l-h}:{})},e.prototype.adjustLayout=function(){var n=this,r=Object.entries(yk(this.itemsLayout,"page")).map(function(c){var l=(0,T.CR)(c,2),u=l[0],d=l[1];return{page:u,layouts:d}}),o=(0,T.ev)([],(0,T.CR)(this.navigator.getContainer().children),!1);r.forEach(function(c){var l=c.layouts,u=n.pageViews.appendChild(new F.ZA({className:af.page.name}));l.forEach(function(d){var h=d.x,p=d.y,v=d.index,m=d.width,b=d.height,x=o[v];u.appendChild(x),mk(x,"__layout__",d),x.update({x:h,y:p,width:m,height:b})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(n){var r=this.attributes.orientation,o=or(this.attributes,"nav"),c=ea({orientation:r},o),l=this;return n.selectAll(af.navigator.class).data(["nav"]).join(function(u){return u.append(function(){return new _k({style:c})}).attr("className",af.navigator.name).each(function(){l.navigator=this})},function(u){return u.each(function(){this.update(c)})},function(u){return u.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(n,r){var o=this.attributes.data;if(!(!o||o.length===0)){var c=this.renderNavigator(qn(r));this.renderItems(c.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(n,r){var o=new F.Aw(n,{detail:r});this.dispatchEvent(o)},e}(Ni),Ek=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,jw)||this}return e.prototype.renderTitle=function(n,r,o){var c=this.attributes,l=c.showTitle,u=c.titleText,d=or(this.attributes,"title"),h=(0,T.CR)(Ca(d),2),p=h[0],v=h[1];this.titleGroup=n.maybeAppendByClassName(Vi.titleGroup,"g").styles(v);var m=(0,T.pi)((0,T.pi)({width:r,height:o},p),{text:l?u:""});this.title=this.titleGroup.maybeAppendByClassName(Vi.title,function(){return new i1({style:m})}).update(m)},e.prototype.renderItems=function(n,r){var o=r.x,c=r.y,l=r.width,u=r.height,d=or(this.attributes,"title",!0),h=(0,T.CR)(Ca(d),2),p=h[0],v=h[1],m=(0,T.pi)((0,T.pi)({},p),{width:l,height:u,x:0,y:0});this.itemsGroup=n.maybeAppendByClassName(Vi.itemsGroup,"g").styles((0,T.pi)((0,T.pi)({},v),{transform:"translate(".concat(o,", ").concat(c,")")}));var b=this;this.itemsGroup.selectAll(Vi.items.class).data(["items"]).join(function(x){return x.append(function(){return new Ok({style:m})}).attr("className",Vi.items.name).each(function(){b.items=qn(this)})},function(x){return x.update(m)},function(x){return x.remove()})},e.prototype.adjustLayout=function(){var n=this.attributes.showTitle;if(n){var r=this.title.node().getAvailableSpace(),o=r.x,c=r.y;this.itemsGroup.node().style.transform="translate(".concat(o,", ").concat(c,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.showTitle,o=n.width,c=n.height;return r?this.title.node().getAvailableSpace():new Hn(0,0,o,c)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var n,r,o=(n=this.title)===null||n===void 0?void 0:n.node(),c=(r=this.items)===null||r===void 0?void 0:r.node();return!o||!c?t.prototype.getBBox.call(this):iw(o,c)},e.prototype.render=function(n,r){var o=this.attributes,c=o.width,l=o.height,u=o.x,d=u===void 0?0:u,h=o.y,p=h===void 0?0:h,v=qn(r);r.style.transform="translate(".concat(d,", ").concat(p,")"),this.renderTitle(v,c,l),this.renderItems(v,this.availableSpace),this.adjustLayout()},e}(Ni);function Lv(t){if(Ec(t)){var e=t;return e[e.length-1]}}var wk=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Ak(t,e){const n=ra(t,"shape"),r=ra(t,"color"),o=n?n.clone():null,c=[];for(const[u,d]of e){const h=u.type,v=((r==null?void 0:r.getOptions().domain.length)>0?r==null?void 0:r.getOptions().domain:d.data).map((m,b)=>{var x;return o?o.map(m||"point"):((x=u==null?void 0:u.style)===null||x===void 0?void 0:x.shape)||d.defaultShape||"point"});typeof h=="string"&&c.push([h,v])}if(c.length===0)return["point",["point"]];if(c.length===1||!n)return c[0];const{range:l}=n.getOptions();return c.map(([u,d])=>{let h=0;for(let p=0;p<c.length;p++){const v=l[p%l.length];d[p]===v&&h++}return[h/d.length,[u,d]]}).sort((u,d)=>d[0]-u[0])[0][1]}function Tk(t,e){const{scales:n,library:r,markState:o}=e,[c,l]=Ak(n,o),{itemMarker:u,itemMarkerSize:d}=t,h=(m,b)=>{var x,S,E;const w=((E=(S=(x=r[`mark.${c}`])===null||x===void 0?void 0:x.props)===null||S===void 0?void 0:S.shape[m])===null||E===void 0?void 0:E.props.defaultMarker)||Lv(m.split(".")),M=typeof d=="function"?d(b):d;return()=>xO(w,{color:b.color})(0,0,M)},p=m=>`${l[m]}`;return ra(n,"shape")&&!u?(m,b)=>h(p(b),m):typeof u=="function"?(m,b)=>{const x=u(m.id,b);return typeof x=="string"?h(x,m):x}:(m,b)=>h(u||p(b),m)}function Ck(t){const e=ra(t,"opacity");if(e){const{range:n}=e.getOptions();return(r,o)=>n[o]}}function Mk(t,e){const n=ra(t,"size");return n instanceof _h?n.map(NaN)*2:e}function Lk(t,e){const{labelFormatter:n=m=>`${m}`}=t,{scales:r,theme:o}=e,c=o.legendCategory.itemMarkerSize,l=Mk(r,c),u={itemMarker:Tk(Object.assign(Object.assign({},t),{itemMarkerSize:l}),e),itemMarkerSize:l,itemMarkerOpacity:Ck(r)},d=typeof n=="string"?Xa(n):n,h=ra(r,"color"),p=mw(r),v=h?m=>h.map(m):()=>e.theme.color;return Object.assign(Object.assign({},u),{data:p.map(m=>({id:m,label:d(m),color:v(m)}))})}function Pk(t,e,n){const{position:r}=e;if(r==="center"){const{bbox:l}=t,{width:u,height:d}=l;return{width:u,height:d}}const{width:o,height:c}=_1(t,e,n);return{width:o,height:c}}const tM=t=>{const{labelFormatter:e,layout:n,order:r,orientation:o,position:c,size:l,title:u,cols:d,itemMarker:h}=t,p=wk(t,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker"]),{gridRow:v}=p;return m=>{const{value:b,theme:x}=m,{bbox:S}=b,{width:E,height:w}=Pk(b,t,tM),M=m1(c,n),L=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(c)?"vertical":"horizontal",width:E,height:w,layout:d!==void 0?"grid":"flex"},d!==void 0&&{gridCol:d}),v!==void 0&&{gridRow:v}),{titleText:es(u)}),Lk(t,m)),{legendCategory:I={}}=x,R=Gf(Object.assign({},I,L,p)),z=new b1({style:Object.assign(Object.assign({x:S.x,y:S.y,width:S.width,height:S.height},M),{subOptions:R})});return z.appendChild(new Ek({className:"legend-category",style:R})),z}};tM.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const sP=t=>()=>new F.ZA;sP.props={};var Ik=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function cP(t,e,n,r){switch(r){case"center":return{x:t+n/2,y:e,textAlign:"middle"};case"right":return{x:t+n,y:e,textAlign:"right"};default:return{x:t,y:e,textAlign:"left"}}}const Rk=gw({render(t,e){const{width:n,title:r,subtitle:o,spacing:c=2,align:l="left",x:u,y:d}=t,h=Ik(t,["width","title","subtitle","spacing","align","x","y"]);e.style.transform=`translate(${u}, ${d})`;const p=bn(h,"title"),v=bn(h,"subtitle"),b=v1(e,".title","text").attr("className","title").call(Fn,Object.assign(Object.assign(Object.assign({},cP(0,0,n,l)),{fontSize:14,textBaseline:"top",text:r}),p)).node().getLocalBounds();v1(e,".sub-title","text").attr("className","sub-title").call(x=>{if(!o)return x.node().remove();x.node().attr(Object.assign(Object.assign(Object.assign({},cP(0,b.max[1]+c,n,l)),{fontSize:12,textBaseline:"top",text:o}),v))})}}),lP=t=>({value:e,theme:n})=>{const{x:r,y:o,width:c,height:l}=e.bbox;return new Rk({style:en({},n.title,Object.assign({x:r,y:o,width:c,height:l},t))})};lP.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};var eM=function(t){if(typeof t!="object"||t===null)return t;var e;if((0,mi.Z)(t)){e=[];for(var n=0,r=t.length;n<r;n++)typeof t[n]=="object"&&t[n]!=null?e[n]=eM(t[n]):e[n]=t[n]}else{e={};for(var o in t)typeof t[o]=="object"&&t[o]!=null?e[o]=eM(t[o]):e[o]=t[o]}return e},nM=eM,kk=function(t){(0,T.ZT)(e,t);function e(n){var r=this,o=n.style,c=(0,T._T)(n,["style"]);return r=t.call(this,en({},{type:"column"},(0,T.pi)({style:o},c)))||this,r.columnsGroup=new F.ZA({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.columns,o=n.x,c=n.y;this.columnsGroup.style.transform="translate(".concat(o,", ").concat(c,")"),qn(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(l){return l.append("rect").attr("className","column").each(function(u){this.attr(u)})},function(l){return l.each(function(u){this.attr(u)})},function(l){return l.remove()})},e.prototype.update=function(n){this.attr(ea({},this.attributes,n)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(F.s$),Dk=function(t){(0,T.ZT)(e,t);function e(n){var r=this,o=n.style,c=(0,T._T)(n,["style"]);return r=t.call(this,en({},{type:"lines"},(0,T.pi)({style:o},c)))||this,r.linesGroup=r.appendChild(new F.ZA),r.areasGroup=r.appendChild(new F.ZA),r.render(),r}return e.prototype.render=function(){var n=this.attributes,r=n.lines,o=n.areas,c=n.x,l=n.y;this.style.transform="translate(".concat(c,", ").concat(l,")"),r&&this.renderLines(r),o&&this.renderAreas(o)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(n){this.attr(ea({},this.attributes,n)),this.render()},e.prototype.renderLines=function(n){qn(this.linesGroup).selectAll(".line").data(n).join(function(r){return r.append("path").attr("className","line").each(function(o){this.attr(o)})},function(r){return r.each(function(o){this.attr(o)})},function(r){return r.remove()})},e.prototype.renderAreas=function(n){qn(this.linesGroup).selectAll(".area").data(n).join(function(r){return r.append("path").attr("className","area").each(function(o){this.attr(o)})},function(r){return r.each(function(o){this.style(o)})},function(r){return r.remove()})},e}(F.s$);function Fk(t,e,n,r){var o,c=[],l=!!r,u,d,h=[1/0,1/0],p=[-1/0,-1/0],v,m,b;if(l){o=(0,T.CR)(r,2),h=o[0],p=o[1];for(var x=0,S=t.length;x<S;x+=1){var E=t[x];h=Ls(h,E),p=Ps(p,E)}}for(var x=0,w=t.length;x<w;x+=1){var E=t[x];if(x===0&&!n)b=E;else if(x===w-1&&!n)m=E,c.push(b),c.push(m);else{var M=[x?x-1:w-1,x-1][n?0:1];u=t[M],d=t[n?(x+1)%w:x+1];var L=[0,0];L=If(d,u),L=Ta(L,e);var I=Tc(E,u),R=Tc(E,d),z=I+R;z!==0&&(I/=z,R/=z);var W=Ta(L,-I),Y=Ta(L,R);m=Dl(E,W),v=Dl(E,Y),v=Ls(v,Ps(d,E)),v=Ps(v,Ls(d,E)),W=If(v,E),W=Ta(W,-I/R),m=Dl(E,W),m=Ls(m,Ps(u,E)),m=Ps(m,Ls(u,E)),Y=If(E,m),Y=Ta(Y,R/I),v=Dl(E,Y),l&&(m=Ps(m,h),m=Ls(m,p),v=Ps(v,h),v=Ls(v,p)),c.push(b),c.push(m),b=v}}return n&&c.push(c.shift()),c}function Nk(t,e,n){var r;e===void 0&&(e=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var o=!!e,c=[],l=0,u=t.length;l<u;l+=2)c.push([t[l],t[l+1]]);for(var d=Fk(c,.4,o,n),h=c.length,p=[],v,m,b,l=0;l<h-1;l+=1)v=d[l*2],m=d[l*2+1],b=c[l+1],p.push(["C",v[0],v[1],m[0],m[1],b[0],b[1]]);return o&&(v=d[h],m=d[h+1],r=(0,T.CR)(c,1),b=r[0],p.push(["C",v[0],v[1],m[0],m[1],b[0],b[1]])),p}function Bk(t,e){var n,r=e.x,o=e.y,c=(0,T.CR)(o.getOptions().range||[0,0],2),l=c[0],u=c[1];return u>l&&(n=(0,T.CR)([l,u],2),u=n[0],l=n[1]),t.map(function(d){var h=d.map(function(p,v){return[r.map(v),(0,ce.Z)(o.map(p),u,l)]});return h})}function Pv(t,e){e===void 0&&(e=!1);var n=e?t.length-1:0,r=t.map(function(o,c){return(0,T.ev)([c===n?"M":"L"],(0,T.CR)(o),!1)});return e?r.reverse():r}function dS(t,e){if(e===void 0&&(e=!1),t.length<=2)return Pv(t);for(var n=[],r=t.length,o=0;o<r;o+=1){var c=e?t[r-o-1]:t[o];xy(c,n.slice(-2))||n.push.apply(n,(0,T.ev)([],(0,T.CR)(c),!1))}var l=Nk(n,!1);return e?l.unshift((0,T.ev)(["M"],(0,T.CR)(t[r-1]),!1)):l.unshift((0,T.ev)(["M"],(0,T.CR)(t[0]),!1)),l}function rM(t,e,n){var r=nM(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}function jk(t,e,n,r){return t.map(function(o){return rM(e?dS(o):Pv(o),n,r)})}function zk(t,e,n){for(var r=[],o=t.length-1;o>=0;o-=1){var c=t[o],l=Pv(c),u=void 0;if(o===0)u=rM(l,e,n);else{var d=t[o-1],h=Pv(d,!0);h[0][0]="L",u=(0,T.ev)((0,T.ev)((0,T.ev)([],(0,T.CR)(l),!1),(0,T.CR)(h),!1),[["Z"]],!1)}r.push(u)}return r}function Uk(t,e,n){for(var r=[],o=t.length-1;o>=0;o-=1){var c=t[o],l=dS(c),u=void 0;if(o===0)u=rM(l,e,n);else{var d=t[o-1],h=dS(d,!0),p=c[0];h[0][0]="L",u=(0,T.ev)((0,T.ev)((0,T.ev)([],(0,T.CR)(l),!1),(0,T.CR)(h),!1),[(0,T.ev)(["M"],(0,T.CR)(p),!1),["Z"]],!1)}r.push(u)}return r}var uP=k(71523),Zk=function(t,e){if((0,mi.Z)(t)){for(var n,r=1/0,o=0;o<t.length;o++){var c=t[o],l=lo(e)?e(c):c[e];l<r&&(n=c,r=l)}return n}},fP=k(13882),Hk=function(t,e){if((0,mi.Z)(t)){for(var n,r=-1/0,o=0;o<t.length;o++){var c=t[o],l=lo(e)?e(c):c[e];l>r&&(n=c,r=l)}return n}};function dP(t){return t.length===0?[0,0]:[(0,uP.Z)(Zk(t,function(e){return(0,uP.Z)(e)||0})),(0,fP.Z)(Hk(t,function(e){return(0,fP.Z)(e)||0}))]}function hP(t){for(var e=nM(t),n=e[0].length,r=(0,T.CR)([Array(n).fill(0),Array(n).fill(0)],2),o=r[0],c=r[1],l=0;l<e.length;l+=1)for(var u=e[l],d=0;d<n;d+=1)u[d]>=0?(u[d]+=o[d],o[d]=u[d]):(u[d]+=c[d],c[d]=u[d]);return e}var Vk=function(t){(0,T.ZT)(e,t);function e(n){return t.call(this,n,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var n=this.attributes.data;if(!n||(n==null?void 0:n.length)===0)return[[]];var r=nM(n);return(0,ne.Z)(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?hP(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var n=this.scales.y,r=(0,T.CR)(n.getOptions().domain||[0,0],2),o=r[0],c=r[1];return c<0?n.map(c):n.map(o<0?0:o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var n=this.attributes,r=n.width,o=n.height;return{width:r,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var n=this,r=this.attributes,o=r.type,c=r.isStack,l=r.smooth;if(o!=="line")throw new Error("linesStyle can only be used in line type");var u=or(this.attributes,"area"),d=or(this.attributes,"line"),h=this.containerShape.width,p=this.data;if(p[0].length===0)return{lines:[],areas:[]};var v=this.scales,m=v.x,b=v.y,x=Bk(p,{type:"line",x:m,y:b}),S=[];if(u){var E=this.baseline;c?S=l?Uk(x,h,E):zk(x,h,E):S=jk(x,l,h,E)}return{lines:x.map(function(w,M){return(0,T.pi)({stroke:n.getColor(M),d:l?dS(w):Pv(w)},d)}),areas:S.map(function(w,M){return(0,T.pi)({d:w,fill:n.getColor(M)},u)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var n=this,r=or(this.attributes,"column"),o=this.attributes,c=o.isStack,l=o.type,u=o.scale;if(l!=="column")throw new Error("columnsStyle can only be used in column type");var d=this.containerShape.height,h=this.rawData;if(!h)return{columns:[]};c&&(h=hP(h));var p=this.createScales(h),v=p.x,m=p.y,b=(0,T.CR)(dP(h),2),x=b[0],S=b[1],E=new qi({domain:[0,S-(x>0?0:x)],range:[0,d*u]}),w=v.getBandWidth(),M=this.rawData;return{columns:h.map(function(L,I){return L.map(function(R,z){var W=w/h.length,Y=function(){return{x:v.map(z)+W*I,y:R>=0?m.map(R):m.map(0),width:W,height:E.map(Math.abs(R))}},st=function(){return{x:v.map(z),y:m.map(R),width:w,height:E.map(M[I][z])}};return(0,T.pi)((0,T.pi)({fill:n.getColor(I)},r),c?st():Y())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){_E(r,".container","rect").attr("className","container").node();var o=n.type,c=n.x,l=n.y,u="spark".concat(o),d=(0,T.pi)({x:c,y:l},o==="line"?this.linesStyle:this.columnsStyle);qn(r).selectAll(".spark").data([o]).join(function(h){return h.append(function(p){return p==="line"?new Dk({className:u,style:d}):new kk({className:u,style:d})}).attr("className","spark ".concat(u))},function(h){return h.update(d)},function(h){return h.remove()})},e.prototype.getColor=function(n){var r=this.attributes.color;return(0,mi.Z)(r)?r[n%r.length]:lo(r)?r.call(null,n):r},e.prototype.createScales=function(n){var r,o,c=this.attributes,l=c.type,u=c.scale,d=c.range,h=d===void 0?[]:d,p=c.spacing,v=this.containerShape,m=v.width,b=v.height,x=(0,T.CR)(dP(n),2),S=x[0],E=x[1],w=new qi({domain:[(r=h[0])!==null&&r!==void 0?r:S,(o=h[1])!==null&&o!==void 0?o:E],range:[b,b*(1-u)]});return l==="line"?{type:l,x:new qi({domain:[0,n[0].length-1],range:[0,m]}),y:w}:{type:l,x:new vs({domain:n[0].map(function(M,L){return L}),range:[0,m],paddingInner:p,paddingOuter:p/2,align:.5}),y:w}},e.tag="sparkline",e}(Ni),pP=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,(0,T.pi)((0,T.pi)((0,T.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(o){return o.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},na(ru,"handle")),na(qf,"handleIcon")),na(Rc,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(o){return function(c){c.stopPropagation(),r.target=o,r.prevPos=r.getOrientVal(rs(c));var l=r.availableSpace,u=l.x,d=l.y,h=r.getBBox(),p=h.x,v=h.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([u,d])-r.getOrientVal([+p,+v])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(o){var c=r.attributes,l=c.slidable,u=c.brushable,d=c.type;o.stopPropagation();var h=r.getOrientVal(rs(o)),p=h-r.prevPos;if(p){var v=r.getRatio(p);switch(r.target){case"start":l&&r.setValuesOffset(v);break;case"end":l&&r.setValuesOffset(0,v);break;case"selection":l&&r.setValuesOffset(v,v);break;case"track":if(!u)return;r.selectionWidth+=v,d==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=h}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(o){var c=r.attributes,l=c.onChange,u=c.type,d=u==="range"?o:o[1],h=u==="range"?r.getValues():r.getValues()[1],p=new F.Aw("valuechange",{detail:{oldValue:d,value:h}});r.dispatchEvent(p),l==null||l(h)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(n){this.attributes.values=this.clampValues(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var n=this.attributes.orientation;if(n!=="horizontal")return null;var r=or(this.attributes,"sparkline");return(0,T.pi)((0,T.pi)({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var n=this.attributes,r=n.trackLength,o=n.trackSize,c=(0,T.CR)(this.getOrientVal([[r,o],[o,r]]),2),l=c[0],u=c[1];return{width:l,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.x,o=n.y,c=n.padding,l=(0,T.CR)(Zi(c),4),u=l[0],d=l[1],h=l[2],p=l[3],v=this.shape,m=v.width,b=v.height;return{x:p,y:u,width:m-(p+d),height:b-(u+h)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1),this.attributes.values=n;var o=r===!1?!1:this.attributes.animate;this.updateSelectionArea(o),this.updateHandlesPosition(o)},e.prototype.updateSelectionArea=function(n){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(Li.selection.class).each(function(o,c){Ti(this,r[c],n)})},e.prototype.updateHandlesPosition=function(n){this.attributes.showHandle&&(this.startHandle&&Ti(this.startHandle,this.getHandleStyle("start"),n),this.endHandle&&Ti(this.endHandle,this.getHandleStyle("end"),n))},e.prototype.innerSetValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1);var o=this.values,c=this.clampValues(n);this.attributes.values=c,this.setValues(c),r&&this.onValueChange(o)},e.prototype.renderTrack=function(n){var r=this.attributes,o=r.x,c=r.y,l=or(this.attributes,"track");this.trackShape=qn(n).maybeAppendByClassName(Li.track,"rect").styles((0,T.pi)((0,T.pi)({x:o,y:c},this.shape),l))},e.prototype.renderBrushArea=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.brushable;this.brushArea=qn(n).maybeAppendByClassName(Li.brushArea,"rect").styles((0,T.pi)({x:o,y:c,fill:"transparent",cursor:l?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(n){var r=this,o=this.attributes,c=o.x,l=o.y,u=o.orientation,d=qn(n).maybeAppendByClassName(Li.sparklineGroup,"g");ro(u==="horizontal",d,function(h){var p=(0,T.pi)((0,T.pi)({},r.sparklineStyle),{x:c,y:l});h.maybeAppendByClassName(Li.sparkline,function(){return new Vk({style:p})}).update(p)})},e.prototype.renderHandles=function(){var n=this,r,o=this.attributes,c=o.showHandle,l=o.type,u=l==="range"?["start","end"]:["end"],d=c?u:[],h=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(Li.handle.class).data(d.map(function(p){return{type:p}}),function(p){return p.type}).join(function(p){return p.append(function(v){var m=v.type;return new T1({style:n.getHandleStyle(m)})}).each(function(v){var m=v.type;this.attr("class","".concat(Li.handle.name," ").concat(m,"-handle"));var b="".concat(m,"Handle");h[b]=this,this.addEventListener("pointerdown",h.onDragStart(m))})},function(p){return p.each(function(v){var m=v.type;this.update(h.getHandleStyle(m))})},function(p){return p.each(function(v){var m=v.type,b="".concat(m,"Handle");h[b]=void 0}).remove()})},e.prototype.renderSelection=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.type,u=r.selectionType;this.foregroundGroup=qn(n).maybeAppendByClassName(Li.foreground,"g");var d=or(this.attributes,"selection"),h=function(v){return v.style("visibility",function(m){return m.show?"visible":"hidden"}).style("cursor",function(m){return u==="select"?"grab":u==="invert"?"crosshair":"default"}).styles((0,T.pi)((0,T.pi)({},d),{transform:"translate(".concat(o,", ").concat(c,")")}))},p=this;this.foregroundGroup.selectAll(Li.selection.class).data(l==="value"?[]:this.calcSelectionArea().map(function(v,m){return{style:(0,T.pi)({},v),index:m,show:u==="select"?m===1:m!==1}}),function(v){return v.index}).join(function(v){return v.append("rect").attr("className",Li.selection.name).call(h).each(function(m,b){var x=this;b===1?(p.selectionShape=qn(this),this.on("pointerdown",function(S){x.attr("cursor","grabbing"),p.onDragStart("selection")(S)}),p.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),p.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),p.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){x.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){x.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){x.attr("cursor","pointer")})):this.on("pointerdown",p.onDragStart("track"))})},function(v){return v.call(h)},function(v){return v.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(n,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(n,r){var o;r===void 0&&(r=4);var c=(0,T.CR)(this.range,2),l=c[0],u=c[1],d=(0,T.CR)(this.getValues().map(function(E){return tu(E,r)}),2),h=d[0],p=d[1],v=Array.isArray(n)?n:[h,n!=null?n:p],m=(0,T.CR)((v||[h,p]).map(function(E){return tu(E,r)}),2),b=m[0],x=m[1];if(this.attributes.type==="value")return[0,(0,ce.Z)(x,l,u)];b>x&&(o=(0,T.CR)([x,b],2),b=o[0],x=o[1]);var S=x-b;return S>u-l?[l,u]:b<l?h===l&&p===x?[l,x]:[l,S+l]:x>u?p===u&&h===b?[b,u]:[u-S,u]:[b,x]},e.prototype.calcSelectionArea=function(n){var r=(0,T.CR)(this.clampValues(n),2),o=r[0],c=r[1],l=this.availableSpace,u=l.x,d=l.y,h=l.width,p=l.height;return this.getOrientVal([[{y:d,height:p,x:u,width:o*h},{y:d,height:p,x:o*h+u,width:(c-o)*h},{y:d,height:p,x:c*h,width:(1-c)*h}],[{x:u,width:h,y:d,height:o*p},{x:u,width:h,y:o*p+d,height:(c-o)*p},{x:u,width:h,y:c*p,height:(1-c)*p}]])},e.prototype.calcHandlePosition=function(n){var r=this.attributes.handleIconOffset,o=this.availableSpace,c=o.x,l=o.y,u=o.width,d=o.height,h=(0,T.CR)(this.clampValues(),2),p=h[0],v=h[1],m=n==="start"?-r:r,b=(n==="start"?p:v)*this.getOrientVal([u,d])+m;return{x:c+this.getOrientVal([b,u/2]),y:l+this.getOrientVal([d/2,b])}},e.prototype.inferTextStyle=function(n){var r=this.attributes.orientation;return r==="horizontal"?{}:n==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:n==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(n){var r,o=this.attributes,c=o.type,l=o.orientation,u=o.formatter,d=o.autoFitLabel,h=or(this.attributes,"handle"),p=or(h,"label"),v=h.spacing,m=this.getHandleSize(),b=this.clampValues(),x=n==="start"?b[0]:b[1],S=u(x),E=new Pf({style:(0,T.pi)((0,T.pi)((0,T.pi)({},p),this.inferTextStyle(n)),{text:S})}),w=E.getBBox(),M=w.width,L=w.height;if(E.destroy(),!d){if(c==="value")return{text:S,x:0,y:-L-v};var I=v+m+(l==="horizontal"?M/2:0);return r={text:S},r[l==="horizontal"?"x":"y"]=n==="start"?-I:I,r}var R=0,z=0,W=this.availableSpace,Y=W.width,st=W.height,xt=this.calcSelectionArea()[1],Nt=xt.x,Ht=xt.y,dt=xt.width,Ot=xt.height,bt=v+m;if(l==="horizontal"){var wt=bt+M/2;if(n==="start"){var oe=Nt-bt-M;R=oe>0?-wt:wt}else{var Ut=Y-Nt-dt-bt>M;R=Ut?wt:-wt}}else{var Kt=bt,me=L+bt;n==="start"?z=Ht-m>L?-me:Kt:z=st-(Ht+Ot)-m>L?me:-Kt}return{x:R,y:z,text:S}},e.prototype.getHandleLabelStyle=function(n){var r=or(this.attributes,"handleLabel");return(0,T.pi)((0,T.pi)((0,T.pi)({},r),this.calcHandleText(n)),this.inferTextStyle(n))},e.prototype.getHandleIconStyle=function(){var n=this.attributes.handleIconShape,r=or(this.attributes,"handleIcon"),o=this.getOrientVal(["ew-resize","ns-resize"]),c=this.getHandleSize();return(0,T.pi)({cursor:o,shape:n,size:c},r)},e.prototype.getHandleStyle=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.showLabel,u=r.showLabelOnInteraction,d=r.orientation,h=this.calcHandlePosition(n),p=h.x,v=h.y,m=this.calcHandleText(n),b=l;return!l&&u&&(this.target?b=!0:b=!1),(0,T.pi)((0,T.pi)((0,T.pi)({},na(this.getHandleIconStyle(),"icon")),na((0,T.pi)((0,T.pi)({},this.getHandleLabelStyle(n)),m),"label")),{transform:"translate(".concat(p+o,", ").concat(v+c,")"),orientation:d,showLabel:b,type:n,zIndex:3})},e.prototype.getHandleSize=function(){var n=this.attributes,r=n.handleIconSize,o=n.width,c=n.height;return r||Math.floor((this.getOrientVal([+c,+o])+4)/2.4)},e.prototype.getOrientVal=function(n){var r=(0,T.CR)(n,2),o=r[0],c=r[1],l=this.attributes.orientation;return l==="horizontal"?o:c},e.prototype.setValuesOffset=function(n,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var c=this.attributes.type,l=(0,T.CR)(this.getValues(),2),u=l[0],d=l[1],h=c==="range"?n:0,p=[u+h,d+r].sort();o?this.setValues(p):this.innerSetValues(p,!0)},e.prototype.getRatio=function(n){var r=this.availableSpace,o=r.width,c=r.height;return n/this.getOrientVal([o,c])},e.prototype.dispatchCustomEvent=function(n,r,o){var c=this;n.on(r,function(l){l.stopPropagation(),c.dispatchEvent(new F.Aw(o,{detail:l}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var n=this.brushArea;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(n,"pointerleave","trackMouseleave"),n.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(n){var r=this.attributes.scrollable;if(r){var o=n.deltaX,c=n.deltaY,l=c||o,u=this.getRatio(l);this.setValuesOffset(u,u,!0)}},e.tag="slider",e}(Ni),Wk=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Gk(t,e,n){const{x:r,y:o,width:c,height:l}=t;if(e==="left")return[r+c-n,o];if(e==="right")return[r,o];if(e==="bottom")return[r,o];if(e==="top")return[r,o+l-n]}const Iv=t=>{const{orientation:e,labelFormatter:n,size:r,style:o={},position:c}=t,l=Wk(t,["orientation","labelFormatter","size","style","position"]);return u=>{var d;const{scales:[h],value:p,theme:v,coordinate:m}=u,{bbox:b}=p,{width:x,height:S}=b,{slider:E={}}=v,w=((d=h.getFormatter)===null||d===void 0?void 0:d.call(h))||(Y=>Y+""),M=typeof n=="string"?Xa(n):n,L=e==="horizontal",I=Yr(m)&&L,{trackSize:R=E.trackSize}=o,[z,W]=Gk(b,c,R);return new pP({className:"slider",style:Object.assign({},E,Object.assign(Object.assign({x:z,y:W,trackLength:L?x:S,orientation:e,formatter:Y=>{const st=M||w,xt=I?1-Y:Y,Nt=Bc(h,xt,!0);return st(Nt)},sparklineData:$k(t,u)},o),l))})}};function Yk(t,e){const[n]=Array.from(t.entries()).filter(([o])=>o.type==="line"||o.type==="area").filter(([o])=>o.slider).map(([o])=>{const{encode:c,slider:l}=o;if(l!=null&&l.x){const u=d=>{const h=c[d];return[d,h?h.value:void 0]};return Object.fromEntries(e.map(u))}});if(!(n!=null&&n.series))return n==null?void 0:n.y;const r=n.series.reduce((o,c,l)=>(o[c]=o[c]||[],o[c].push(n.y[l]),o),{});return Object.values(r)}function $k(t,e){const{markState:n}=e;return(0,mi.Z)(t.sparklineData)?t.sparklineData:Yk(n,["y","series"])}Iv.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const gP=t=>Iv(Object.assign(Object.assign({},t),{orientation:"horizontal"}));gP.props=Object.assign(Object.assign({},Iv.props),{defaultPosition:"bottom"});const vP=t=>Iv(Object.assign(Object.assign({},t),{orientation:"vertical"}));vP.props=Object.assign(Object.assign({},Iv.props),{defaultPosition:"left"});var Xk=function(t){(0,T.ZT)(e,t);function e(n){var r=t.call(this,n,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(o){var c=r.attributes.value;if(o!==c){var l={detail:{oldValue:o,value:c}};r.dispatchEvent(new F.Aw("scroll",l)),r.dispatchEvent(new F.Aw("valuechange",l))}},r.onTrackClick=function(o){var c=r.attributes.slidable;if(c){var l=(0,T.CR)(r.getLocalPosition(),2),u=l[0],d=l[1],h=(0,T.CR)(r.padding,4),p=h[0],v=h[3],m=r.getOrientVal([u+v,d+p]),b=r.getOrientVal(rs(o)),x=(b-m)/r.trackLength;r.setValue(x,!0)}},r.onThumbMouseenter=function(o){r.dispatchEvent(new F.Aw("thumbMouseenter",{detail:o.detail}))},r.onTrackMouseenter=function(o){r.dispatchEvent(new F.Aw("trackMouseenter",{detail:o.detail}))},r.onThumbMouseleave=function(o){r.dispatchEvent(new F.Aw("thumbMouseleave",{detail:o.detail}))},r.onTrackMouseleave=function(o){r.dispatchEvent(new F.Aw("trackMouseleave",{detail:o.detail}))},r}return Object.defineProperty(e.prototype,"padding",{get:function(){var n=this.attributes.padding;return Zi(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var n=this.attributes.value,r=(0,T.CR)(this.range,2),o=r[0],c=r[1];return(0,ce.Z)(n,o,c)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLength",{get:function(){var n=this.attributes,r=n.viewportLength,o=n.trackLength,c=o===void 0?r:o;return c},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var n=this.attributes.trackSize,r=this.trackLength,o=(0,T.CR)(this.padding,4),c=o[0],l=o[1],u=o[2],d=o[3],h=(0,T.CR)(this.getOrientVal([[r,n],[n,r]]),2),p=h[0],v=h[1];return{x:d,y:c,width:+p-(d+l),height:+v-(c+u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackRadius",{get:function(){var n=this.attributes,r=n.isRound,o=n.trackSize;return r?o/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbRadius",{get:function(){var n=this.attributes,r=n.isRound,o=n.thumbRadius;if(!r)return 0;var c=this.availableSpace,l=c.width,u=c.height;return o||this.getOrientVal([u,l])/2},enumerable:!1,configurable:!0}),e.prototype.getValues=function(n){n===void 0&&(n=this.value);var r=this.attributes,o=r.viewportLength,c=r.contentLength,l=o/c,u=(0,T.CR)(this.range,2),d=u[0],h=u[1],p=n*(h-d-l);return[p,p+l]},e.prototype.getValue=function(){return this.value},e.prototype.renderSlider=function(n){var r=this.attributes,o=r.x,c=r.y,l=r.orientation,u=r.trackSize,d=r.padding,h=r.slidable,p=or(this.attributes,"track"),v=or(this.attributes,"thumb"),m=(0,T.pi)((0,T.pi)({x:o,y:c,brushable:!1,orientation:l,padding:d,selectionRadius:this.thumbRadius,showHandle:!1,slidable:h,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:u,values:this.getValues()},na(p,"track")),na(v,"selection"));this.slider=qn(n).maybeAppendByClassName("scrollbar",function(){return new pP({style:m})}).update(m).node()},e.prototype.render=function(n,r){this.renderSlider(r)},e.prototype.setValue=function(n,r){r===void 0&&(r=!1);var o=this.attributes.value,c=(0,T.CR)(this.range,2),l=c[0],u=c[1];this.slider.setValues(this.getValues((0,ce.Z)(n,l,u)),r),this.onValueChange(o)},e.prototype.bindEvents=function(){var n=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),n.onTrackClick(r.detail)}),this.onHover()},e.prototype.getOrientVal=function(n){var r=this.attributes.orientation;return r==="horizontal"?n[0]:n[1]},e.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},e.tag="scrollbar",e}(Ni),qk=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Rv=t=>{const{orientation:e,labelFormatter:n,style:r}=t,o=qk(t,["orientation","labelFormatter","style"]);return({scales:[c],value:l,theme:u})=>{const{bbox:d}=l,{x:h,y:p,width:v,height:m}=d,{scrollbar:b={}}=u,{ratio:x,range:S}=c.getOptions(),E=e==="horizontal"?v:m,w=E/x,[M,L]=S,I=L>M?0:1;return new Xk({className:"g2-scrollbar",style:Object.assign({},b,Object.assign(Object.assign(Object.assign(Object.assign({},r),{x:h,y:p,trackLength:E,value:I}),o),{orientation:e,contentLength:w,viewportLength:E}))})}};Rv.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const mP=t=>Rv(Object.assign(Object.assign({},t),{orientation:"horizontal"}));mP.props=Object.assign(Object.assign({},Rv.props),{defaultPosition:"bottom"});const yP=t=>Rv(Object.assign(Object.assign({},t),{orientation:"vertical"}));yP.props=Object.assign(Object.assign({},Rv.props),{defaultPosition:"left"});const iM=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:p=1,opacity:v=1}=u.style,[m,b]=Yr(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],x=[{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:p,opacity:v,offset:.01},{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:p,opacity:v}];return u.animate(x,Object.assign(Object.assign({},l),t))}},Kk=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:p=1,opacity:v=1}=u.style,[m,b]=Yr(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],x=[{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m},{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:p,opacity:v,offset:.99},{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(x,Object.assign(Object.assign({},l),t))}},bP=(t,e)=>{const{coordinate:r}=e;return F.ux.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:F.h0.NUMBER}),(o,c,l)=>{const[u]=o,d=p=>{const{__data__:v,style:m}=p,{radius:b=0,inset:x=0,fillOpacity:S=1,strokeOpacity:E=1,opacity:w=1}=m,{points:M,y:L,y1:I}=v,R=zs(r,M,[L,I]),{innerRadius:z,outerRadius:W}=R,Y=mu().cornerRadius(b).padAngle(x*Math.PI/180),st=new F.y$({}),xt=dt=>(st.attr({d:Y(dt)}),(0,F.YR)(st)),Nt=[{scaleInYRadius:z+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:z+1e-4,fillOpacity:S,strokeOpacity:E,opacity:w,offset:.01},{scaleInYRadius:W,fillOpacity:S,strokeOpacity:E,opacity:w}],Ht=p.animate(Nt,Object.assign(Object.assign({},l),t));return Ht.onframe=function(){p.style.d=xt(Object.assign(Object.assign({},R),{outerRadius:Number(p.style.scaleInYRadius)}))},Ht.onfinish=function(){p.style.d=xt(Object.assign(Object.assign({},R),{outerRadius:W}))},Ht},h=p=>{const{style:v}=p,{transform:m="",fillOpacity:b=1,strokeOpacity:x=1,opacity:S=1}=v,[E,w]=Yr(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],M=[{transform:`${m} ${w}`.trimStart(),transformOrigin:E,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${m} ${w}`.trimStart(),transformOrigin:E,fillOpacity:b,strokeOpacity:x,opacity:S,offset:.01},{transform:`${m} scale(1, 1)`.trimStart(),transformOrigin:E,fillOpacity:b,strokeOpacity:x,opacity:S}];return p.animate(M,Object.assign(Object.assign({},l),t))};return Pr(r)?d(u):h(u)}},Qk=(t,e)=>{const{coordinate:r}=e;return(o,c,l)=>{const[u]=o,{transform:d="",fillOpacity:h=1,strokeOpacity:p=1,opacity:v=1}=u.style,[m,b]=Yr(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],x=[{transform:`${d} scale(1, 1)`.trimStart(),transformOrigin:m},{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:h,strokeOpacity:p,opacity:v,offset:.99},{transform:`${d} ${b}`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(x,Object.assign(Object.assign({},l),t))}},_P=(t,e)=>{F.ux.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:F.h0.NUMBER});const{coordinate:r}=e;return(o,c,l)=>{const[u]=o;if(!Pr(r))return iM(t,e)(o,c,l);const{__data__:d,style:h}=u,{radius:p=0,inset:v=0,fillOpacity:m=1,strokeOpacity:b=1,opacity:x=1}=h,{points:S,y:E,y1:w}=d,M=mu().cornerRadius(p).padAngle(v*Math.PI/180),L=zs(r,S,[E,w]),{startAngle:I,endAngle:R}=L,z=[{waveInArcAngle:I+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:I+1e-4,fillOpacity:m,strokeOpacity:b,opacity:x,offset:.01},{waveInArcAngle:R,fillOpacity:m,strokeOpacity:b,opacity:x}],W=u.animate(z,Object.assign(Object.assign({},l),t));return W.onframe=function(){u.style.d=M(Object.assign(Object.assign({},L),{endAngle:Number(u.style.waveInArcAngle)}))},W.onfinish=function(){u.style.d=M(Object.assign(Object.assign({},L),{endAngle:R}))},W}};_P.props={};const xP=t=>(e,n,r)=>{const[o]=e,{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=o.style,d=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:c,strokeOpacity:l,opacity:u}];return o.animate(d,Object.assign(Object.assign({},r),t))};xP.props={};const SP=t=>(e,n,r)=>{const[o]=e,{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=o.style,d=[{fillOpacity:c,strokeOpacity:l,opacity:u},{fillOpacity:0,strokeOpacity:0,opacity:0}];return o.animate(d,Object.assign(Object.assign({},r),t))};SP.props={};const Jk=t=>(n,r,o)=>{const[c]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:d=1,opacity:h=1}=c.style,p="center center",v=[{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:p,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:p,fillOpacity:u,strokeOpacity:d,opacity:h,offset:.01},{transform:`${l} scale(1)`.trimStart(),transformOrigin:p,fillOpacity:u,strokeOpacity:d,opacity:h}];return c.animate(v,Object.assign(Object.assign({},o),t))},tD=t=>(n,r,o)=>{const[c]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:d=1,opacity:h=1}=c.style,p="center center",v=[{transform:`${l} scale(1)`.trimStart(),transformOrigin:p},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:p,fillOpacity:u,strokeOpacity:d,opacity:h,offset:.99},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:p,fillOpacity:0,strokeOpacity:0,opacity:0}];return c.animate(v,Object.assign(Object.assign({},o),t))},OP=t=>(e,n,r)=>{var o,c;const[l]=e,u=((c=(o=l).getTotalLength)===null||c===void 0?void 0:c.call(o))||0,d=[{lineDash:[0,u]},{lineDash:[u,0]}];return l.animate(d,Object.assign(Object.assign({},r),t))};OP.props={};const eD={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},nD={[F.bn.CIRCLE]:["cx","cy","r"],[F.bn.ELLIPSE]:["cx","cy","rx","ry"],[F.bn.RECT]:["x","y","width","height"],[F.bn.IMAGE]:["x","y","width","height"],[F.bn.LINE]:["x1","y1","x2","y2"],[F.bn.POLYLINE]:["points"],[F.bn.POLYGON]:["points"]};function Sh(t,e,n=!1){const r={};for(const o of e){const c=t.style[o];c?r[o]=c:n&&(r[o]=eD[o])}return r}const kv=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function oM(t){const{min:e,max:n}=t.getLocalBounds(),[r,o]=e,[c,l]=n,u=l-o,d=c-r;return[r,o,d,u]}function rD(t){const[e,n,r,o]=t;return`
    M ${e} ${n}
    L ${e+r} ${n}
    L ${e+r} ${n+o}
    L ${e} ${n+o}
    Z
  `}function iD(t,e){const[n,r,o,c]=oM(t),l=c/o,u=Math.ceil(Math.sqrt(e/l)),d=Math.ceil(e/u),h=[],p=c/d;let v=0,m=e;for(;m>0;){const b=Math.min(m,u),x=o/b;for(let S=0;S<b;S++){const E=n+S*x,w=r+v*p;h.push(rD([E,w,x,p]))}m-=b,v+=1}return h}function oD(t="pack"){return typeof t=="function"?t:iD}function aD(t,e,n){let{transform:r}=t.style;const{transform:o}=e.style;EP(e,t);let c=kv;if(t.nodeName===F.bn.GROUP){const[d,h,p,v]=oM(t),[m,b,x,S]=oM(e),E=d-m,w=h-b,M=p/x,L=v/S;r=`translate(${E}, ${w}) scale(${M}, ${L})`}else c=c.concat(nD[t.nodeName]||[]);const l=[Object.assign({transform:r!=null?r:"none"},Sh(t,c,!0)),Object.assign({transform:o!=null?o:"none"},Sh(e,c,!0))];return e.animate(l,n)}function EP(t,e){t.__data__=e.__data__,t.className=e.className,t.markType=e.markType,e.parentNode.replaceChild(t,e)}function sD(t,e){const{nodeName:n}=t;if(n==="path")return t;const r=new F.y$({style:Object.assign(Object.assign({},Sh(t,kv)),{d:e})});return EP(r,t),r}function wP(t,e){const n=t.indexOf(e),r=t.lastIndexOf(e);return n===r}function cD(t){return!wP(t,"m")||!wP(t,"M")}function AP(t){const e=(0,F.YR)(t);if(e&&!cD(e))return e}function TP(t){const{nodeName:e}=t;if(e==="path"){const n=hr(t,"attributes");return n.markerEnd||n.markerStart}return!1}function aM(t,e,n,r){const{nodeName:o}=e,{nodeName:c}=n,l=AP(e),u=AP(n),d=o===c&&o!=="path",h=l===void 0||u===void 0,p=TP(e)||TP(n);if(d||h||p)return aD(e,n,r);const v=sD(t,l),m=[Object.assign({},Sh(e,kv)),Object.assign({},Sh(n,kv))];if(l!==u){m[0].d=l,m[1].d=u;const b=v.animate(m,r);return b.onfinish=()=>{const x=v.style.d;ap(v,n),v.style.d=x,v.style.transform="none"},v.style.transform="none",b}return null}function lD(t,e,n,r){t.style.visibility="hidden";const o=r(t,e.length);return e.map((c,l)=>{const u=new F.y$({style:Object.assign({d:o[l]},Sh(t,kv))});return aM(c,u,c,n)})}function uD(t,e,n,r){const o=r(e,t.length),{fillOpacity:c=1,strokeOpacity:l=1,opacity:u=1}=e.style,d=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:c,strokeOpacity:l,opacity:u}],h=e.animate(d,n);return[...t.map((v,m)=>{const b=new F.y$({style:{d:o[m],fill:e.style.fill}});return aM(v,v,b,n)}),h]}const CP=t=>(e,n,r)=>{const o=oD(t.split),c=Object.assign(Object.assign({},r),t),{length:l}=e,{length:u}=n;if(l===1&&u===1||l>1&&u>1){const[d]=e,[h]=n;return aM(d,d,h,c)}if(l===1&&u>1){const[d]=e;return lD(d,n,c,o)}if(l>1&&u===1){const[d]=n;return uD(e,d,c,o)}return null};CP.props={};const MP=(t,e)=>(n,r,o)=>{const[c]=n,{min:[l,u],halfExtents:d}=c.getLocalBounds(),h=d[0]*2,p=d[1]*2,v=new F.y$({style:{d:`M${l},${u}L${l+h},${u}L${l+h},${u+p}L${l},${u+p}Z`}});return c.appendChild(v),c.style.clipPath=v,iM(t,e)([v],r,o)};MP.props={};const LP=(t,e)=>(n,r,o)=>{const[c]=n,{min:[l,u],halfExtents:d}=c.getLocalBounds(),h=d[0]*2,p=d[1]*2,v=new F.y$({style:{d:`M${l},${u}L${l+h},${u}L${l+h},${u+p}L${l},${u+p}Z`}});return c.appendChild(v),c.style.clipPath=v,bP(t,e)([v],r,o)};LP.props={};var fD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function dD(t,{elements:e,datum:n,groupKey:r=v=>v,link:o=!1,background:c=!1,delay:l=60,scale:u,coordinate:d,emitter:h,state:p={}}){var v;const m=e(t),b=new Set(m),x=Gr(m,r),S=Uc(m,n),[E,w]=NA(Object.assign({elements:m,valueof:S,link:o,coordinate:d},bn(p.active,"link"))),[M,L,I]=BA(Object.assign({document:t.ownerDocument,scale:u,coordinate:d,background:c,valueof:S},bn(p.active,"background"))),R=en(p,{active:Object.assign({},((v=p.active)===null||v===void 0?void 0:v.offset)&&{transform:(...oe)=>{const Ut=p.active.offset(...oe),[,Kt]=oe;return Db(m[Kt],Ut,d)}})}),{setState:z,removeState:W,hasState:Y}=yi(R,S);let st;const xt=oe=>{const{target:Ut,nativeEvent:Kt=!0}=oe;if(!b.has(Ut))return;st&&clearTimeout(st);const me=r(Ut),Ee=x.get(me),Pe=new Set(Ee);for(const Ie of m)Pe.has(Ie)?Y(Ie,"active")||z(Ie,"active"):(z(Ie,"inactive"),w(Ie)),Ie!==Ut&&L(Ie);M(Ut),E(Ee),Kt&&h.emit("element:highlight",{nativeEvent:Kt,data:{data:n(Ut),group:Ee.map(n)}})},Nt=()=>{st&&clearTimeout(st),st=setTimeout(()=>{Ht(),st=null},l)},Ht=(oe=!0)=>{for(const Ut of m)W(Ut,"active","inactive"),L(Ut),w(Ut);oe&&h.emit("element:unhighlight",{nativeEvent:oe})},dt=oe=>{const{target:Ut}=oe;c&&!I(Ut)||!c&&!b.has(Ut)||(l>0?Nt():Ht())},Ot=()=>{Ht()};t.addEventListener("pointerover",xt),t.addEventListener("pointerout",dt),t.addEventListener("pointerleave",Ot);const bt=oe=>{const{nativeEvent:Ut}=oe;Ut||Ht(!1)},wt=oe=>{const{nativeEvent:Ut}=oe;if(Ut)return;const{data:Kt}=oe.data,me=Fb(m,Kt,n);me&&xt({target:me,nativeEvent:!1})};return h.on("element:highlight",wt),h.on("element:unhighlight",bt),()=>{t.removeEventListener("pointerover",xt),t.removeEventListener("pointerout",dt),t.removeEventListener("pointerleave",Ot),h.off("element:highlight",wt),h.off("element:unhighlight",bt);for(const oe of m)L(oe),w(oe)}}function hS(t){var{delay:e,createGroup:n,background:r=!1,link:o=!1}=t,c=fD(t,["delay","createGroup","background","link"]);return(l,u,d)=>{const{container:h,view:p,options:v}=l,{scale:m,coordinate:b}=p,x=ka(h);return dD(x,Object.assign({elements:Hs,datum:ss(p),groupKey:n?n(p):void 0,coordinate:b,scale:m,state:bu(v,[["active",r?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:r,link:o,delay:e,emitter:d},c))}}hS.props={reapplyWhenUpdate:!0};function PP(t){return hS(Object.assign(Object.assign({},t),{createGroup:Wo}))}PP.props={reapplyWhenUpdate:!0};function IP(t){return hS(Object.assign(Object.assign({},t),{createGroup:L0}))}IP.props={reapplyWhenUpdate:!0};var hD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function pD(t,{elements:e,datum:n,groupKey:r=v=>v,link:o=!1,single:c=!1,coordinate:l,background:u=!1,scale:d,emitter:h,state:p={}}){var v;const m=e(t),b=new Set(m),x=Gr(m,r),S=Uc(m,n),[E,w]=NA(Object.assign({link:o,elements:m,valueof:S,coordinate:l},bn(p.selected,"link"))),[M,L]=BA(Object.assign({document:t.ownerDocument,background:u,coordinate:l,scale:d,valueof:S},bn(p.selected,"background"))),I=en(p,{selected:Object.assign({},((v=p.selected)===null||v===void 0?void 0:v.offset)&&{transform:(...Ot)=>{const bt=p.selected.offset(...Ot),[,wt]=Ot;return Db(m[wt],bt,l)}})}),{setState:R,removeState:z,hasState:W}=yi(I,S),Y=(Ot=!0)=>{for(const bt of m)z(bt,"selected","unselected"),w(bt),L(bt);Ot&&h.emit("element:unselect",{nativeEvent:!0})},st=(Ot,bt,wt=!0)=>{if(W(bt,"selected"))Y();else{const oe=r(bt),Ut=x.get(oe),Kt=new Set(Ut);for(const me of m)Kt.has(me)?R(me,"selected"):(R(me,"unselected"),w(me)),me!==bt&&L(me);if(E(Ut),M(bt),!wt)return;h.emit("element:select",Object.assign(Object.assign({},Ot),{nativeEvent:wt,data:{data:[n(bt),...Ut.map(n)]}}))}},xt=(Ot,bt,wt=!0)=>{const oe=r(bt),Ut=x.get(oe),Kt=new Set(Ut);if(W(bt,"selected")){if(!m.some(Ee=>!Kt.has(Ee)&&W(Ee,"selected")))return Y();for(const Ee of Ut)R(Ee,"unselected"),w(Ee),L(Ee)}else{const me=Ut.some(Ee=>W(Ee,"selected"));for(const Ee of m)Kt.has(Ee)?R(Ee,"selected"):W(Ee,"selected")||R(Ee,"unselected");!me&&o&&E(Ut),M(bt)}wt&&h.emit("element:select",Object.assign(Object.assign({},Ot),{nativeEvent:wt,data:{data:m.filter(me=>W(me,"selected")).map(n)}}))},Nt=Ot=>{const{target:bt,nativeEvent:wt=!0}=Ot;return b.has(bt)?c?st(Ot,bt,wt):xt(Ot,bt,wt):Y()};t.addEventListener("click",Nt);const Ht=Ot=>{const{nativeEvent:bt,data:wt}=Ot;if(bt)return;const oe=c?wt.data.slice(0,1):wt.data;for(const Ut of oe){const Kt=Fb(m,Ut,n);Nt({target:Kt,nativeEvent:!1})}},dt=()=>{Y(!1)};return h.on("element:select",Ht),h.on("element:unselect",dt),()=>{for(const Ot of m)w(Ot);t.removeEventListener("click",Nt),h.off("element:select",Ht),h.off("element:unselect",dt)}}function pS(t){var{createGroup:e,background:n=!1,link:r=!1}=t,o=hD(t,["createGroup","background","link"]);return(c,l,u)=>{const{container:d,view:h,options:p}=c,{coordinate:v,scale:m}=h,b=ka(d);return pD(b,Object.assign({elements:Hs,datum:ss(h),groupKey:e?e(h):void 0,coordinate:v,scale:m,state:bu(p,[["selected",n?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:n,link:r,emitter:u},o))}}pS.props={reapplyWhenUpdate:!0};function RP(t){return pS(Object.assign(Object.assign({},t),{createGroup:Wo}))}RP.props={reapplyWhenUpdate:!0};function kP(t){return pS(Object.assign(Object.assign({},t),{createGroup:L0}))}kP.props={reapplyWhenUpdate:!0};var sf=function(t,e,n){var r,o,c,l,u=0;n||(n={});var d=function(){u=n.leading===!1?0:Date.now(),r=null,l=t.apply(o,c),r||(o=c=null)},h=function(){var p=Date.now();!u&&n.leading===!1&&(u=p);var v=e-(p-u);return o=this,c=arguments,v<=0||v>e?(r&&(clearTimeout(r),r=null),u=p,l=t.apply(o,c),r||(o=c=null)):!r&&n.trailing!==!1&&(r=setTimeout(d,v)),l};return h.cancel=function(){clearTimeout(r),u=0,r=o=c=null},h};function gD(t){const{coordinate:e={}}=t,{transform:n=[]}=e,r=n.find(c=>c.type==="fisheye");if(r)return r;const o={type:"fisheye"};return n.push(o),e.transform=n,t.coordinate=e,o}function vD({wait:t=30,leading:e,trailing:n=!1}){return r=>{const{options:o,update:c,setState:l,container:u}=r,d=ka(u),h=sf(p=>{const v=gd(d,p);if(!v){l("fisheye"),c();return}l("fisheye",m=>{const b=en({},m,{interaction:{tooltip:{preserve:!0}}});for(const w of b.marks)w.animate=!1;const[x,S]=v,E=gD(b);return E.focusX=x,E.focusY=S,E.visual=!0,b}),c()},t,{leading:e,trailing:n});return d.addEventListener("pointerenter",h),d.addEventListener("pointermove",h),d.addEventListener("pointerleave",h),()=>{d.removeEventListener("pointerenter",h),d.removeEventListener("pointermove",h),d.removeEventListener("pointerleave",h)}}}var mD=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},yD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function bD(t){const{transform:e=[]}=t,n=e.find(o=>o.type==="normalizeY");if(n)return n;const r={type:"normalizeY"};return e.push(r),t.transform=e,r}function _D(t,e,n){const[r]=Array.from(t.entries()).filter(([o])=>o.type===e).map(([o])=>{const{encode:c}=o,l=u=>{const d=c[u];return[u,d?d.value:void 0]};return Object.fromEntries(n.map(l))});return r}function DP(t){var{wait:e=20,leading:n,trailing:r=!1,labelFormatter:o=l=>`${l}`}=t,c=yD(t,["wait","leading","trailing","labelFormatter"]);return l=>{const{view:u,container:d,update:h,setState:p}=l,{markState:v,scale:m,coordinate:b}=u,x=_D(v,"line",["x","y","series"]);if(!x)return;const{y:S,x:E,series:w=[]}=x,M=S.map((oe,Ut)=>Ut),L=Do(M.map(oe=>E[oe])),I=ka(d),R=d.getElementsByClassName(Oe),z=d.getElementsByClassName(he),Y=Gr(z,oe=>oe.__data__.key.split("-")[0]),st=new F.x1({style:Object.assign({x1:0,y1:0,x2:0,y2:I.getAttribute("height"),stroke:"black",lineWidth:1},bn(c,"rule"))}),xt=new F.xv({style:Object.assign({x:0,y:I.getAttribute("height"),text:"",fontSize:10},bn(c,"label"))});st.append(xt),I.appendChild(st);const Nt=(oe,Ut,Kt)=>{const[me]=oe.invert(Kt),Ee=Ut.invert(me);return L[TA(L,Ee)]},Ht=(oe,Ut)=>{st.setAttribute("x1",oe[0]),st.setAttribute("x2",oe[0]),xt.setAttribute("text",o(Ut))};let dt;const Ot=oe=>mD(this,void 0,void 0,function*(){const{x:Ut}=m,Kt=Nt(b,Ut,oe);Ht(oe,Kt),p("chartIndex",Ee=>{const Pe=en({},Ee),Ie=Pe.marks.find(rn=>rn.type==="line"),sn=Or(ep(M,rn=>Or(rn,Rn=>+S[Rn])/So(rn,Rn=>+S[Rn]),rn=>w[rn]).values()),yn=[1/sn,sn];en(Ie,{scale:{y:{domain:yn}}});const on=bD(Ie);on.groupBy="color",on.basis=(rn,Rn)=>{const xn=rn[Ra(gn=>E[+gn]).center(rn,Kt)];return Rn[xn]};for(const rn of Pe.marks)rn.animate=!1;return Pe}),dt=(yield h("chartIndex")).view}),bt=oe=>{const{scale:Ut,coordinate:Kt}=dt,{x:me,y:Ee}=Ut,Pe=Nt(Kt,me,oe);Ht(oe,Pe);for(const Ie of R){const{seriesIndex:qe,key:sn}=Ie.__data__,yn=qe[Ra(kn=>E[+kn]).center(qe,Pe)],on=[0,Ee.map(1)],rn=[0,Ee.map(S[yn]/S[qe[0]])],[,Rn]=Kt.map(on),[,xn]=Kt.map(rn),gn=Rn-xn;Ie.setAttribute("transform",`translate(0, ${gn})`);const Cn=Y.get(sn)||[];for(const kn of Cn)kn.setAttribute("dy",gn)}},wt=sf(oe=>{const Ut=gd(I,oe);Ut&&bt(Ut)},e,{leading:n,trailing:r});return Ot([0,0]),I.addEventListener("pointerenter",wt),I.addEventListener("pointermove",wt),I.addEventListener("pointerleave",wt),()=>{st.remove(),I.removeEventListener("pointerenter",wt),I.removeEventListener("pointermove",wt),I.removeEventListener("pointerleave",wt)}}}DP.props={reapplyWhenUpdate:!0};function Dv(t,e){let n,r=-1,o=-1;if(e===void 0)for(const c of t)++o,c!=null&&(n>c||n===void 0&&c>=c)&&(n=c,r=o);else for(let c of t)(c=e(c,++o,t))!=null&&(n>c||n===void 0&&c>=c)&&(n=c,r=o);return r}function Fv(t,e){let n=0,r=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(++n,r+=o);else{let o=-1;for(let c of t)(c=e(c,++o,t))!=null&&(c=+c)>=c&&(++n,r+=c)}if(n)return r/n}function FP(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}function xD(t,e){return!t||!e?t:t.replace(/\\?\{([^{}]+)\}/g,function(n,r){return n.charAt(0)==="\\"?n.slice(1):e[r]===void 0?"":e[r]})}var SD=xD,NP=function(t,e){if(e==null){t.innerHTML="";return}t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,(0,T.ev)([],(0,T.CR)(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach(function(n){return t.appendChild(n)}):t.appendChild(e))};function sM(t){return t===void 0&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var BP={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function OD(t){var e;t===void 0&&(t="");var n=sM(t);return e={},e[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=(0,T.pi)({flex:1},BP),e[".".concat(n.VALUE)]=(0,T.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},BP),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var ED=function(t){(0,T.ZT)(e,t);function e(n){var r=this,o,c,l=(c=(o=n.style)===null||o===void 0?void 0:o.template)===null||c===void 0?void 0:c.prefixCls,u=sM(l);return r=t.call(this,n,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(u.NAME,`">
          <span class="`).concat(u.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(u.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(u.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:OD(l)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var n=this.element.offsetWidth,r=this.element.offsetHeight;return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var n=this.attributes,r=n.data,o=n.template;return r.map(function(c,l){var u=c.name,d=u===void 0?"":u,h=c.color,p=h===void 0?"black":h,v=c.index,m=(0,T._T)(c,["name","color","index"]),b=(0,T.pi)({name:d,color:p,index:v!=null?v:l},m);return FP(SD(o.item,b))})},enumerable:!1,configurable:!0}),e.prototype.render=function(n,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var n;(n=this.element)===null||n===void 0||n.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(n,r){var o=this;if(n!==void 0&&r!==void 0){var c=this.element.style.visibility==="hidden",l=function(){o.attributes.x=n!=null?n:o.attributes.x,o.attributes.y=r!=null?r:o.attributes.y,o.updatePosition()};c?this.closeTransition(l):l()}this.element.style.visibility="visible"},e.prototype.hide=function(n,r){n===void 0&&(n=0),r===void 0&&(r=0);var o=this.attributes.enterable;o&&this.isCursorEntered(n,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var n=this.attributes.template;this.element=FP(n.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var n=this.attributes.content;n&&(typeof n=="string"?this.element.innerHTML=n:NP(this.element,n))}},e.prototype.renderHTMLTooltipElement=function(){var n,r,o=this.attributes,c=o.template,l=o.title,u=o.enterable,d=o.style,h=o.content,p=sM(c.prefixCls),v=this.element;if(this.element.style.pointerEvents=u?"auto":"none",h)this.renderCustomContent();else{l?(v.innerHTML=c.title,v.getElementsByClassName(p.TITLE)[0].innerHTML=l):(r=(n=v.getElementsByClassName(p.TITLE))===null||n===void 0?void 0:n[0])===null||r===void 0||r.remove();var m=this.HTMLTooltipItemsElements,b=document.createElement("ul");b.className=p.LIST,NP(b,m);var x=this.element.querySelector(".".concat(p.LIST));x?x.replaceWith(b):v.appendChild(b)}EE(v,d)},e.prototype.getRelativeOffsetFromCursor=function(n){var r=this.attributes,o=r.position,c=r.offset,l=n||o,u=l.split("-"),d={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},h=this.elementSize,p=h.width,v=h.height,m=[-p/2,-v/2];return u.forEach(function(b){var x=(0,T.CR)(m,2),S=x[0],E=x[1],w=(0,T.CR)(d[b],2),M=w[0],L=w[1];m=[S+(p/2+c[0])*M,E+(v/2+c[1])*L]}),m},e.prototype.setOffsetPosition=function(n){var r=(0,T.CR)(n,2),o=r[0],c=r[1],l=this.attributes,u=l.x,d=u===void 0?0:u,h=l.y,p=h===void 0?0:h,v=l.container,m=v.x,b=v.y;this.element.style.left="".concat(+d+m+o,"px"),this.element.style.top="".concat(+p+b+c,"px")},e.prototype.updatePosition=function(){var n=this.attributes.showDelay,r=n===void 0?60:n,o=Date.now();this.timestamp>0&&o-this.timestamp<r||(this.timestamp=o,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(n){var r=(0,T.CR)(n,2),o=r[0],c=r[1],l=this.attributes,u=l.x,d=l.y,h=l.bounding,p=l.position;if(!h)return[o,c];var v=this.element,m=v.offsetWidth,b=v.offsetHeight,x=(0,T.CR)([+u+o,+d+c],2),S=x[0],E=x[1],w={left:"right",right:"left",top:"bottom",bottom:"top"},M=h.x,L=h.y,I=h.width,R=h.height,z={left:S<M,right:S+m>M+I,top:E<L,bottom:E+b>L+R},W=[];p.split("-").forEach(function(st){z[st]?W.push(w[st]):W.push(st)});var Y=W.join("-");return this.getRelativeOffsetFromCursor(Y)},e.prototype.isCursorEntered=function(n,r){if(this.element){var o=this.element.getBoundingClientRect(),c=o.x,l=o.y,u=o.width,d=o.height;return new Hn(c,l,u,d).isPointIn(n,r)}return!1},e.prototype.closeTransition=function(n){var r=this,o=this.element.style.transition;this.element.style.transition="none",n(),setTimeout(function(){r.element.style.transition=o},10)},e.tag="tooltip",e}(Ni),cf=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function gS(t,e){return e?typeof e=="string"?document.querySelector(e):e:t.ownerDocument.defaultView.getContextService().getDomElement().parentElement}function wD(t){const e=t.getRenderBounds(),{min:[n,r],max:[o,c]}=e;return{x:n,y:r,width:o-n,height:c-r}}function AD(t,e){const n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:n.x-r.x,y:n.y-r.y}}function TD(t,e,n,r,o,c,l,u={},d=[10,10]){const h={".g2-tooltip":{},".g2-tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},p=new ED({className:"tooltip",style:{x:e,y:n,container:l,data:[],bounding:c,position:r,enterable:o,title:"",offset:d,template:{prefixCls:"g2-"},style:en(h,u)}});return t.appendChild(p.HTMLTooltipElement),p}function jP({root:t,data:e,x:n,y:r,render:o,event:c,single:l,position:u="right-bottom",enterable:d=!1,css:h,mount:p,bounding:v,offset:m}){const b=gS(t,p),x=gS(t),S=l?x:t,E=v||wD(t),w=AD(x,b),{tooltipElement:M=TD(b,n,r,u,d,E,w,h,m)}=S,{items:L,title:I=""}=e;M.update(Object.assign({x:n,y:r,data:L,title:I,position:u,enterable:d,container:w},o!==void 0&&{content:o(c,{items:L,title:I})})),S.tooltipElement=M}function _l({root:t,single:e,emitter:n,nativeEvent:r=!0,event:o=null}){r&&n.emit("tooltip:hide",{nativeEvent:r});const c=gS(t),l=e?c:t,{tooltipElement:u}=l;u&&u.hide(o==null?void 0:o.clientX,o==null?void 0:o.clientY),VP(t),WP(t),GP(t)}function cM({root:t,single:e}){const n=gS(t),r=e?n:t;if(!r)return;const{tooltipElement:o}=r;o&&(o.destroy(),r.tooltipElement=void 0),VP(t),WP(t),GP(t)}function zP(t){const{value:e}=t;return Object.assign(Object.assign({},t),{value:e===void 0?"undefined":e})}function CD(t){const{__data__:e}=t,{title:n,items:r=[]}=e,o=r.filter(Hr).map(c=>{var{color:l=UP(t)}=c,u=cf(c,["color"]);return Object.assign(Object.assign({},u),{color:l})}).map(zP);return Object.assign(Object.assign({},n&&{title:n}),{items:o})}function MD(t,e){const{color:n,series:r,facet:o=!1}=t,{color:c,series:l}=e,u=d=>d&&d.invert&&!(d instanceof vs)&&!(d instanceof au);if(u(r))return r.clone().invert(l);if(l&&r instanceof vs&&r.invert(l)!==c&&!o)return r.invert(l);if(u(n)){const d=n.invert(c);return Array.isArray(d)?null:d}return null}function UP(t){const e=t.getAttribute("fill"),n=t.getAttribute("stroke"),{__data__:r}=t,{color:o=e&&e!=="transparent"?e:n}=r;return o}function ZP(t,e=n=>n){const n=new Map(t.map(r=>[e(r),r]));return Array.from(n.values())}function HP(t,e,n,r=t.map(c=>c.__data__),o={}){const c=d=>d instanceof Date?+d:d,l=ZP(r.map(d=>d.title),c).filter(Hr),u=r.flatMap((d,h)=>{const p=t[h],{items:v=[],title:m}=d,b=v.filter(Hr),x=n!==void 0?n:v.length<=1;return b.map(S=>{var{color:E=UP(p)||o.color,name:w}=S,M=cf(S,["color","name"]);const L=MD(e,d),I=x?L||w:w||L;return Object.assign(Object.assign({},M),{color:E,name:I||m})})}).map(zP);return Object.assign(Object.assign({},l.length>0&&{title:l.join(",")}),{items:ZP(u,d=>`(${c(d.name)}, ${c(d.value)}, ${c(d.color)})`)})}function LD(t,e,n,r){var{plotWidth:o,plotHeight:c,mainWidth:l,mainHeight:u,startX:d,startY:h,transposed:p,polar:v,insetLeft:m,insetTop:b}=r,x=cf(r,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const S=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},x),E=(z,W,Y)=>{const st=new F.Cd({style:Object.assign({cx:z,cy:W,r:Y},S)});return t.appendChild(st),st},w=(z,W,Y,st)=>{const xt=new F.x1({style:Object.assign({x1:z,x2:W,y1:Y,y2:st},S)});return t.appendChild(xt),xt},L=((z,W)=>{if(W.length===1)return W[0];const Y=W.map(xt=>ai(xt,z)),st=Dv(Y,xt=>xt);return W[st]})(n,e),I=()=>p?[d+L[0],d+L[0],h,h+c]:[d,d+o,L[1]+h,L[1]+h],R=()=>{const z=d+m+l/2,W=h+b+u/2,Y=ai([z,W],L);return[z,W,Y]};if(v){const[z,W,Y]=R(),st=t.ruleX||E(z,W,Y);st.style.cx=z,st.style.cy=W,st.style.r=Y,t.ruleX=st}else{const[z,W,Y,st]=I(),xt=t.ruleX||w(z,W,Y,st);xt.style.x1=z,xt.style.x2=W,xt.style.y1=Y,xt.style.y2=st,t.ruleX=xt}}function PD(t,e,n){var{plotWidth:r,plotHeight:o,mainWidth:c,mainHeight:l,startX:u,startY:d,transposed:h,polar:p,insetLeft:v,insetTop:m}=n,b=cf(n,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const x=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},b),S=e.map(st=>st[1]),E=e.map(st=>st[0]),w=Fv(S),M=Fv(E),L=()=>{if(p){const st=Math.min(c,l)/2,xt=u+v+c/2,Nt=d+m+l/2,Ht=Ro(oi([M,w],[xt,Nt])),dt=xt+st*Math.cos(Ht),Ot=Nt+st*Math.sin(Ht);return[xt,dt,Nt,Ot]}return h?[u,u+r,w+d,w+d]:[M+u,M+u,d,d+o]},[I,R,z,W]=L(),Y=()=>{const st=new F.x1({style:Object.assign({x1:I,x2:R,y1:z,y2:W},x)});return t.appendChild(st),st};if(E.length>0){const st=t.ruleY||Y();st.style.x1=I,st.style.x2=R,st.style.y1=z,st.style.y2=W,t.ruleY=st}}function VP(t){t.ruleY&&(t.ruleY.remove(),t.ruleY=void 0)}function WP(t){t.ruleX&&(t.ruleX.remove(),t.ruleX=void 0)}function ID(t,{data:e,style:n,theme:r}){t.markers&&t.markers.forEach(l=>l.remove());const{type:o=""}=n,c=e.filter(l=>{const[{x:u,y:d}]=l;return Hr(u)&&Hr(d)}).map(l=>{const[{color:u,element:d},h]=l,p=u||d.style.fill||d.style.stroke||r.color,v=o==="hollow"?"transparent":p,m=o==="hollow"?p:"#fff";return new F.Cd({className:"g2-tooltip-marker",style:Object.assign({cx:h[0],cy:h[1],fill:v,r:4,stroke:m,lineWidth:2},n)})});for(const l of c)t.appendChild(l);t.markers=c}function GP(t){t.markers&&(t.markers.forEach(e=>e.remove()),t.markers=[])}function YP(t,e){return Array.from(t.values()).some(n=>{var r;return(r=n.interaction)===null||r===void 0?void 0:r[e]})}function dc(t,e){return t===void 0?e:t}function $P(t){const{title:e,items:n}=t;return n.length===0&&e===void 0}function RD(t){return Array.from(t.values()).some(e=>{var n;return((n=e.interaction)===null||n===void 0?void 0:n.seriesTooltip)&&e.tooltip})}function XP(t,e){var{elements:n,sort:r,filter:o,scale:c,coordinate:l,crosshairs:u,crosshairsX:d,crosshairsY:h,render:p,groupName:v,emitter:m,wait:b=50,leading:x=!0,trailing:S=!1,startX:E=0,startY:w=0,body:M=!0,single:L=!0,position:I,enterable:R,mount:z,bounding:W,theme:Y,offset:st,disableNative:xt=!1,marker:Nt=!0,preserve:Ht=!1,style:dt={},css:Ot={}}=e,bt=cf(e,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css"]);const wt=n(t),oe=Yr(l),Ut=Pr(l),Kt=en(dt,bt),{innerWidth:me,innerHeight:Ee,width:Pe,height:Ie,insetLeft:qe,insetTop:sn}=l.getOptions(),yn=[],on=[];for(const Nn of wt){const{__data__:Jn}=Nn,{seriesX:sr,title:ur,items:Jr}=Jn;sr?yn.push(Nn):(ur||Jr)&&on.push(Nn)}const rn=Nn=>Nn.markType==="interval",Rn=on.length&&on.every(rn)&&!Pr(l),xn=Nn=>Nn.__data__.x,Cn=!!c.x.getBandWidth&&on.length>0;yn.sort((Nn,Jn)=>{const sr=oe?0:1,ur=Jr=>Jr.getBounds().min[sr];return oe?ur(Jn)-ur(Nn):ur(Nn)-ur(Jn)});const kn=Nn=>{const Jn=oe?1:0,{min:sr,max:ur}=Nn.getLocalBounds();return Do([sr[Jn],ur[Jn]])};Rn?wt.sort((Nn,Jn)=>xn(Nn)-xn(Jn)):on.sort((Nn,Jn)=>{const[sr,ur]=kn(Nn),[Jr,xi]=kn(Jn),Si=(sr+ur)/2,ao=(Jr+xi)/2;return oe?ao-Si:Si-ao});const Bn=new Map(yn.map(Nn=>{const{__data__:Jn}=Nn,{seriesX:sr}=Jn,ur=sr.map((xi,Si)=>Si),Jr=Do(ur,xi=>sr[+xi]);return[Nn,[Jr,sr]]})),{x:$n}=c,vr=$n!=null&&$n.getBandWidth?$n.getBandWidth()/2:0,Xn=Nn=>{const[Jn]=l.invert(Nn);return Jn-vr},nr=(Nn,Jn,sr,ur)=>{const{_x:Jr}=Nn,xi=Jr!==void 0?$n.map(Jr):Xn(Jn),Si=ur.filter(Hr),[ao,Ea]=Do([Si[0],Si[Si.length-1]]),Va=ao===Ea;if(!Cn&&(xi<ao||xi>Ea)&&!Va)return null;const Fh=Ra(bc=>ur[+bc]).center,gm=Fh(sr,xi);return sr[gm]},ni=Rn?(Nn,Jn)=>{const sr=Ra(xn).center,ur=sr(Jn,Xn(Nn)),Jr=Jn[ur];return Gr(Jn,xn).get(xn(Jr))}:(Nn,Jn)=>{const ur=Nn[oe?1:0],Jr=Jn.filter(ao=>{const[Ea,Va]=kn(ao);return ur>=Ea&&ur<=Va});if(!Cn||Jr.length>0)return Jr;const xi=Ra(ao=>{const[Ea,Va]=kn(ao);return(Ea+Va)/2}).center,Si=xi(Jn,ur);return[Jn[Si]].filter(Hr)},Ji=(Nn,Jn)=>{const{__data__:sr}=Nn;return Object.fromEntries(Object.entries(sr).filter(([ur])=>ur.startsWith("series")&&ur!=="series").map(([ur,Jr])=>{const xi=Jr[Jn];return[rp(ur.replace("series","")),xi]}))},yo=sf(Nn=>{var Jn;const sr=gd(t,Nn);if(!sr)return;const ur=as(t),Jr=ur.min[0],xi=ur.min[1],Si=[sr[0]-E,sr[1]-w];if(!Si)return;const ao=ni(Si,on),Ea=[],Va=[];for(const Ii of yn){const[mm,Q4]=Bn.get(Ii),ym=nr(Nn,Si,mm,Q4);if(ym!==null){Ea.push(Ii);const pO=Ji(Ii,ym),{x:EV,y:wV}=pO,AV=l.map([(EV||0)+vr,wV||0]);Va.push([Object.assign(Object.assign({},pO),{element:Ii}),AV])}}const Fh=Array.from(new Set(Va.map(Ii=>Ii[0].x))),gm=Fh[Dv(Fh,Ii=>Math.abs(Ii-Xn(Si)))],bc=Va.filter(Ii=>Ii[0].x===gm),q4=[...bc.map(Ii=>Ii[0]),...ao.map(Ii=>Ii.__data__)],hO=[...Ea,...ao],vm=HP(hO,c,v,q4,Y);if(r&&vm.items.sort((Ii,mm)=>r(Ii)-r(mm)),o&&(vm.items=vm.items.filter(o)),hO.length===0||$P(vm)){vi(Nn);return}if(M&&jP({root:t,data:vm,x:sr[0]+Jr,y:sr[1]+xi,render:p,event:Nn,single:L,position:I,enterable:R,mount:z,bounding:W,css:Ot,offset:st}),u||d||h){const Ii=bn(Kt,"crosshairs"),mm=Object.assign(Object.assign({},Ii),bn(Kt,"crosshairsX")),Q4=Object.assign(Object.assign({},Ii),bn(Kt,"crosshairsY")),ym=bc.map(pO=>pO[1]);d&&LD(t,ym,sr,Object.assign(Object.assign({},mm),{plotWidth:me,plotHeight:Ee,mainWidth:Pe,mainHeight:Ie,insetLeft:qe,insetTop:sn,startX:E,startY:w,transposed:oe,polar:Ut})),h&&PD(t,ym,Object.assign(Object.assign({},Q4),{plotWidth:me,plotHeight:Ee,mainWidth:Pe,mainHeight:Ie,insetLeft:qe,insetTop:sn,startX:E,startY:w,transposed:oe,polar:Ut}))}if(Nt){const Ii=bn(Kt,"marker");ID(t,{data:bc,style:Ii,theme:Y})}const K4=(Jn=bc[0])===null||Jn===void 0?void 0:Jn[0].x,OV=K4!=null?K4:Xn(Si);m.emit("tooltip:show",Object.assign(Object.assign({},Nn),{nativeEvent:!0,data:{data:{x:Bc(c.x,OV,!0)}}}))},b,{leading:x,trailing:S}),vi=Nn=>{_l({root:t,single:L,emitter:m,event:Nn})},Ao=()=>{cM({root:t,single:L})},to=Nn=>{var Jn,{nativeEvent:sr,data:ur,offsetX:Jr,offsetY:xi}=Nn,Si=cf(Nn,["nativeEvent","data","offsetX","offsetY"]);if(sr)return;const ao=(Jn=ur==null?void 0:ur.data)===null||Jn===void 0?void 0:Jn.x,Va=c.x.map(ao),[Fh,gm]=l.map([Va,.5]),bc=t.getRenderBounds(),q4=bc.min[0],hO=bc.min[1];yo(Object.assign(Object.assign({},Si),{offsetX:Jr!==void 0?Jr:q4+Fh,offsetY:xi!==void 0?xi:hO+gm,_x:ao}))},Oa=()=>{_l({root:t,single:L,emitter:m,nativeEvent:!1})},zi=()=>{eo(),Ao()},$i=()=>{To()},To=()=>{xt||(t.addEventListener("pointerenter",yo),t.addEventListener("pointermove",yo),t.addEventListener("pointerleave",Nn=>{gd(t,Nn)||vi(Nn)}))},eo=()=>{xt||(t.removeEventListener("pointerenter",yo),t.removeEventListener("pointermove",yo),t.removeEventListener("pointerleave",vi))};return To(),m.on("tooltip:show",to),m.on("tooltip:hide",Oa),m.on("tooltip:disable",zi),m.on("tooltip:enable",$i),()=>{eo(),m.off("tooltip:show",to),m.off("tooltip:hide",Oa),m.off("tooltip:disable",zi),m.off("tooltip:enable",$i),Ht?_l({root:t,single:L,emitter:m,nativeEvent:!1}):Ao()}}function kD(t,{elements:e,coordinate:n,scale:r,render:o,groupName:c,sort:l,filter:u,emitter:d,wait:h=50,leading:p=!0,trailing:v=!1,groupKey:m=Nt=>Nt,single:b=!0,position:x,enterable:S,datum:E,view:w,mount:M,bounding:L,theme:I,offset:R,shared:z=!1,body:W=!0,disableNative:Y=!1,preserve:st=!1,css:xt={}}){var Nt,Ht;const dt=e(t),Ot=Gr(dt,m),bt=gn=>gn.markType==="interval",wt=dt.every(bt)&&!Pr(n),oe=r.x,Ut=r.series,Kt=(Ht=(Nt=oe==null?void 0:oe.getBandWidth)===null||Nt===void 0?void 0:Nt.call(oe))!==null&&Ht!==void 0?Ht:0,me=Ut?gn=>gn.__data__.x:gn=>gn.__data__.x+Kt/2;wt&&dt.sort((gn,Cn)=>me(gn)-me(Cn));const Ee=gn=>{const{target:Cn}=gn;return xu(Cn,kn=>kn.classList?kn.classList.includes("element"):!1)},Pe=wt?gn=>{const Cn=gd(t,gn);if(!Cn)return;const[kn]=n.invert(Cn),Bn=Ra(me).center,$n=Bn(dt,kn),vr=dt[$n];return!z&&dt.find(nr=>nr!==vr&&me(nr)===me(vr))?Ee(gn):vr}:Ee,Ie=sf(gn=>{const Cn=Pe(gn);if(!Cn){_l({root:t,single:b,emitter:d,event:gn});return}const kn=m(Cn),Bn=Ot.get(kn);if(!Bn)return;const $n=Bn.length===1&&!z?CD(Bn[0]):HP(Bn,r,c,void 0,I);if(l&&$n.items.sort((nr,ni)=>l(nr)-l(ni)),u&&($n.items=$n.items.filter(u)),$P($n)){_l({root:t,single:b,emitter:d,event:gn});return}const{offsetX:vr,offsetY:Xn}=gn;W&&jP({root:t,data:$n,x:vr,y:Xn,render:o,event:gn,single:b,position:x,enterable:S,mount:M,bounding:L,css:xt,offset:R}),d.emit("tooltip:show",Object.assign(Object.assign({},gn),{nativeEvent:!0,data:{data:R0(Cn,w)}}))},h,{leading:p,trailing:v}),qe=gn=>{_l({root:t,single:b,emitter:d,event:gn})},sn=()=>{Y||(t.addEventListener("pointermove",Ie),t.addEventListener("pointerleave",qe))},yn=()=>{Y||(t.removeEventListener("pointermove",Ie),t.removeEventListener("pointerleave",qe))},on=({nativeEvent:gn,offsetX:Cn,offsetY:kn,data:Bn})=>{if(gn)return;const{data:$n}=Bn,vr=Fb(dt,$n,E);if(!vr)return;const Xn=vr.getBBox(),{x:nr,y:ni,width:Ji,height:yo}=Xn,vi=t.getBBox();Ie({target:vr,offsetX:Cn!==void 0?Cn+vi.x:nr+Ji/2,offsetY:kn!==void 0?kn+vi.y:ni+yo/2})},rn=({nativeEvent:gn}={})=>{gn||_l({root:t,single:b,emitter:d,nativeEvent:!1})},Rn=()=>{yn(),cM({root:t,single:b})},xn=()=>{sn()};return d.on("tooltip:show",on),d.on("tooltip:hide",rn),d.on("tooltip:enable",xn),d.on("tooltip:disable",Rn),sn(),()=>{yn(),d.off("tooltip:show",on),d.off("tooltip:hide",rn),st?_l({root:t,single:b,emitter:d,nativeEvent:!1}):cM({root:t,single:b})}}function qP(t){const{shared:e,crosshairs:n,crosshairsX:r,crosshairsY:o,series:c,name:l,item:u=()=>({}),facet:d=!1}=t,h=cf(t,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(p,v,m)=>{const{container:b,view:x}=p,{scale:S,markState:E,coordinate:w,theme:M}=x,L=YP(E,"seriesTooltip"),I=YP(E,"crosshairs"),R=ka(b),z=dc(c,L),W=dc(n,I);if(z&&RD(E)&&!d)return XP(R,Object.assign(Object.assign({},h),{theme:M,elements:Hs,scale:S,coordinate:w,crosshairs:W,crosshairsX:dc(dc(r,n),!1),crosshairsY:dc(o,W),item:u,emitter:m}));if(z&&d){const Y=v.filter(Ot=>Ot!==p&&Ot.options.parentKey===p.options.key),st=yu(p,v),xt=Y[0].view.scale,Nt=R.getBounds(),Ht=Nt.min[0],dt=Nt.min[1];return Object.assign(xt,{facet:!0}),XP(R.parentNode.parentNode,Object.assign(Object.assign({},h),{theme:M,elements:()=>st,scale:xt,coordinate:w,crosshairs:dc(n,I),crosshairsX:dc(dc(r,n),!1),crosshairsY:dc(o,W),item:u,startX:Ht,startY:dt,emitter:m}))}return kD(R,Object.assign(Object.assign({},h),{datum:ss(x),elements:Hs,scale:S,coordinate:w,groupKey:e?Wo(x):void 0,item:u,emitter:m,view:x,theme:M,shared:e}))}}qP.props={reapplyWhenUpdate:!0};var vS=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const KP="legend-category",DD="legend-continuous",FD="items-item",ND="legend-category-item-marker",BD="legend-category-item-label";function QP(t){return t.getElementsByClassName(ND)[0]}function JP(t){return t.getElementsByClassName(BD)[0]}function t7(t){return t.getElementsByClassName(FD)}function lM(t){return t.getElementsByClassName(KP)}function e7(t){return t.getElementsByClassName(DD)}function jD(t,e){[...lM(t),...e7(t)].forEach(r=>{e(r,o=>o)})}function uM(t){let e=t.parentNode;for(;e&&!e.__data__;)e=e.parentNode;return e.__data__}function RV(t){let e=t;for(;e&&!e.attr("class").startsWith("legend");)e=e.children[0];return e.attributes}function zD(t,{legends:e,marker:n,label:r,datum:o,filter:c,emitter:l,channel:u,state:d={}}){const h=new Map,p=new Map,v=new Map,{unselected:m={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=d,b={unselected:bn(m,"marker")},x={unselected:bn(m,"label")},{setState:S,removeState:E}=yi(b,void 0),{setState:w,removeState:M}=yi(x,void 0),L=Array.from(e(t));let I=L.map(o);const R=()=>{for(const Y of L){const st=o(Y),xt=n(Y),Nt=r(Y);I.includes(st)?(E(xt,"unselected"),M(Nt,"unselected")):(S(xt,"unselected"),w(Nt,"unselected"))}};for(const Y of L){const st=()=>{Vs(t,"pointer")},xt=()=>{XL(t)},Nt=Ht=>vS(this,void 0,void 0,function*(){const dt=o(Y),Ot=I.indexOf(dt);Ot===-1?I.push(dt):I.splice(Ot,1),yield c(I),R();const{nativeEvent:bt=!0}=Ht;bt&&(I.length===L.length?l.emit("legend:reset",{nativeEvent:bt}):l.emit("legend:filter",Object.assign(Object.assign({},Ht),{nativeEvent:bt,data:{channel:u,values:I}})))});Y.addEventListener("click",Nt),Y.addEventListener("pointerenter",st),Y.addEventListener("pointerout",xt),h.set(Y,Nt),p.set(Y,st),v.set(Y,xt)}const z=Y=>vS(this,void 0,void 0,function*(){const{nativeEvent:st}=Y;if(st)return;const{data:xt}=Y,{channel:Nt,values:Ht}=xt;Nt===u&&(I=Ht,yield c(I),R())}),W=Y=>vS(this,void 0,void 0,function*(){const{nativeEvent:st}=Y;st||(I=L.map(o),yield c(I),R())});return l.on("legend:filter",z),l.on("legend:reset",W),()=>{for(const Y of L)Y.removeEventListener("click",h.get(Y)),Y.removeEventListener("pointerenter",p.get(Y)),Y.removeEventListener("pointerout",v.get(Y)),l.off("legend:filter",z),l.off("legend:reset",W)}}function UD(t,{legend:e,filter:n,emitter:r,channel:o}){const c=({detail:{value:l}})=>{n(l),r.emit({nativeEvent:!0,data:{channel:o,values:l}})};return e.addEventListener("valuechange",c),()=>{e.removeEventListener("valuechange",c)}}function n7(t,{legend:e,channel:n,value:r,ordinal:o,channels:c,allChannels:l,facet:u=!1}){return vS(this,void 0,void 0,function*(){const{view:d,update:h,setState:p}=t;p(e,v=>{const{marks:m}=v,b=m.map(x=>{if(x.type==="legends")return x;const{transform:S=[],data:E=[]}=x,w=S.findIndex(({type:I})=>I.startsWith("group")||I.startsWith("bin")),M=[...S];E.length&&M.splice(w+1,0,{type:"filter",[n]:{value:r,ordinal:o}});const L=Object.fromEntries(c.map(I=>[I,{domain:d.scale[I].getOptions().domain}]));return en({},x,Object.assign(Object.assign({transform:M,scale:L},!o&&{animate:!1}),{legend:u?!1:Object.fromEntries(l.map(I=>[I,{preserve:!0}]))}))});return Object.assign(Object.assign({},v),{marks:b})}),yield h()})}function ZD(t,e){for(const n of t)n7(n,Object.assign(Object.assign({},e),{facet:!0}))}function HD(){return(t,e,n)=>{const{container:r}=t,o=e.filter(v=>v!==t),c=o.length>0,l=v=>uM(v).scales.map(m=>m.name),u=[...lM(r),...e7(r)],d=u.flatMap(l),h=c?sf(ZD,50,{trailing:!0}):sf(n7,50,{trailing:!0}),p=u.map(v=>{const{name:m,domain:b}=uM(v).scales[0],x=l(v),S={legend:v,channel:m,channels:x,allChannels:d};return v.className===KP?zD(r,{legends:t7,marker:QP,label:JP,datum:E=>{const{__data__:w}=E,{index:M}=w;return b[M]},filter:E=>{const w=Object.assign(Object.assign({},S),{value:E,ordinal:!0});h(c?o:t,w)},state:v.attributes.state,channel:m,emitter:n}):UD(r,{legend:v,filter:E=>{const w=Object.assign(Object.assign({},S),{value:E,ordinal:!1});h(c?o:t,w)},emitter:n,channel:m})});return()=>{p.forEach(v=>v())}}}function VD(){return(t,e,n)=>{const{container:r,view:o,options:c}=t,l=lM(r),u=Hs(r),d=b=>uM(b).scales[0].name,h=b=>{const{scale:{[b]:x}}=o;return x},p=bu(c,["active","inactive"]),v=Uc(u,ss(o)),m=[];for(const b of l){const x=me=>{const{data:Ee}=b.attributes,{__data__:Pe}=me,{index:Ie}=Pe;return Ee[Ie].label},S=d(b),E=t7(b),w=h(S),M=Gr(u,me=>w.invert(me.__data__[S])),{state:L={}}=b.attributes,{inactive:I={}}=L,{setState:R,removeState:z}=yi(p,v),W={inactive:bn(I,"marker")},Y={inactive:bn(I,"label")},{setState:st,removeState:xt}=yi(W),{setState:Nt,removeState:Ht}=yi(Y),dt=me=>{for(const Ee of E){const Pe=QP(Ee),Ie=JP(Ee);Ee===me||me===null?(xt(Pe,"inactive"),Ht(Ie,"inactive")):(st(Pe,"inactive"),Nt(Ie,"inactive"))}},Ot=(me,Ee)=>{const Pe=x(Ee),Ie=new Set(M.get(Pe));for(const sn of u)Ie.has(sn)?R(sn,"active"):R(sn,"inactive");dt(Ee);const{nativeEvent:qe=!0}=me;qe&&n.emit("legend:highlight",Object.assign(Object.assign({},me),{nativeEvent:qe,data:{channel:S,value:Pe}}))},bt=new Map;for(const me of E){const Ee=Pe=>{Ot(Pe,me)};me.addEventListener("pointerover",Ee),bt.set(me,Ee)}const wt=me=>{for(const Pe of u)z(Pe,"inactive","active");dt(null);const{nativeEvent:Ee=!0}=me;Ee&&n.emit("legend:unhighlight",{nativeEvent:Ee})},oe=me=>{const{nativeEvent:Ee,data:Pe}=me;if(Ee)return;const{channel:Ie,value:qe}=Pe;if(Ie!==S)return;const sn=E.find(yn=>x(yn)===qe);sn&&Ot({nativeEvent:!1},sn)},Ut=me=>{const{nativeEvent:Ee}=me;Ee||wt({nativeEvent:!1})};b.addEventListener("pointerleave",wt),n.on("legend:highlight",oe),n.on("legend:unhighlight",Ut);const Kt=()=>{b.removeEventListener(wt),n.off("legend:highlight",oe),n.off("legend:unhighlight",Ut);for(const[me,Ee]of bt)me.removeEventListener(Ee)};m.push(Kt)}return()=>m.forEach(b=>b())}}var ya=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function WD(t,e){const[n,r,o,c]=t,[l,u,d,h]=e;return!(l>o||d<n||u>c||h<r)}function GD(t,e,n,r,o){const[c,l,u,d]=o;return[Math.max(c,Math.min(t,n)),Math.max(l,Math.min(e,r)),Math.min(u,Math.max(t,n)),Math.min(d,Math.max(e,r))]}function YD(t){const{width:e,height:n}=t.getBBox();return[0,0,e,n]}function hc(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}const r7=Pa(t=>{const e=t.attributes,{x:n,y:r,width:o,height:c,class:l,renders:u={},handleSize:d=10,document:h}=e,p=ya(e,["x","y","width","height","class","renders","handleSize","document"]);if(!h||o===void 0||c===void 0||n===void 0||r===void 0)return;const v=d/2,m=(qe,sn,yn)=>{qe.handle||(qe.handle=yn.createElement("rect"),qe.append(qe.handle));const{handle:on}=qe;return on.attr(sn),on},b=bn(co(p,"handleNW","handleNE"),"handleN"),{render:x=m}=b,S=ya(b,["render"]),E=bn(p,"handleE"),{render:w=m}=E,M=ya(E,["render"]),L=bn(co(p,"handleSE","handleSW"),"handleS"),{render:I=m}=L,R=ya(L,["render"]),z=bn(p,"handleW"),{render:W=m}=z,Y=ya(z,["render"]),st=bn(p,"handleNW"),{render:xt=m}=st,Nt=ya(st,["render"]),Ht=bn(p,"handleNE"),{render:dt=m}=Ht,Ot=ya(Ht,["render"]),bt=bn(p,"handleSE"),{render:wt=m}=bt,oe=ya(bt,["render"]),Ut=bn(p,"handleSW"),{render:Kt=m}=Ut,me=ya(Ut,["render"]),Ee=(qe,sn)=>{const{id:yn}=qe,on=sn(qe,qe.attributes,h);on.id=yn,on.style.draggable=!0},Pe=qe=>()=>{const sn=Pa(yn=>Ee(yn,qe));return new sn({})},Ie=Wn(t).attr("className",l).style("transform",`translate(${n}, ${r})`).style("draggable",!0);Ie.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(hc,Object.assign(Object.assign({width:o,height:c},co(p,"handle")),{transform:void 0})),Ie.maybeAppend("handle-n",Pe(x)).style("x",v).style("y",-v).style("width",o-d).style("height",d).style("fill","transparent").call(hc,S),Ie.maybeAppend("handle-e",Pe(w)).style("x",o-v).style("y",v).style("width",d).style("height",c-d).style("fill","transparent").call(hc,M),Ie.maybeAppend("handle-s",Pe(I)).style("x",v).style("y",c-v).style("width",o-d).style("height",d).style("fill","transparent").call(hc,R),Ie.maybeAppend("handle-w",Pe(W)).style("x",-v).style("y",v).style("width",d).style("height",c-d).style("fill","transparent").call(hc,Y),Ie.maybeAppend("handle-nw",Pe(xt)).style("x",-v).style("y",-v).style("width",d).style("height",d).style("fill","transparent").call(hc,Nt),Ie.maybeAppend("handle-ne",Pe(dt)).style("x",o-v).style("y",-v).style("width",d).style("height",d).style("fill","transparent").call(hc,Ot),Ie.maybeAppend("handle-se",Pe(wt)).style("x",o-v).style("y",c-v).style("width",d).style("height",d).style("fill","transparent").call(hc,oe),Ie.maybeAppend("handle-sw",Pe(Kt)).style("x",-v).style("y",c-v).style("width",d).style("height",d).style("fill","transparent").call(hc,me)});function fM(t,e){var{brushed:n=()=>{},brushended:r=()=>{},brushcreated:o=()=>{},brushstarted:c=()=>{},brushupdated:l=()=>{},extent:u=YD(t),brushRegion:d=(on,rn,Rn,xn,gn)=>[on,rn,Rn,xn],reverse:h=!1,fill:p="#777",fillOpacity:v="0.3",stroke:m="#fff",selectedHandles:b=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=e,x=ya(e,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let S=null,E=null,w=null,M=null,L=null,I=!1;const[R,z,W,Y]=u;Vs(t,"crosshair"),t.style.draggable=!0;const st=(on,rn,Rn)=>{if(c(Rn),M&&M.remove(),L&&L.remove(),S=[on,rn],h)return xt();Nt()},xt=()=>{L=new F.y$({style:Object.assign(Object.assign({},x),{fill:p,fillOpacity:v,stroke:m,pointerEvents:"none"})}),M=new r7({style:{x:0,y:0,width:0,height:0,draggable:!0,document:t.ownerDocument},className:"mask"}),t.appendChild(L),t.appendChild(M)},Nt=()=>{M=new r7({style:Object.assign(Object.assign({document:t.ownerDocument,x:0,y:0},x),{fill:p,fillOpacity:v,stroke:m,draggable:!0}),className:"mask"}),t.appendChild(M)},Ht=(on=!0)=>{M&&M.remove(),L&&L.remove(),S=null,E=null,w=null,I=!1,M=null,L=null,r(on)},dt=(on,rn,Rn=!0)=>{const[xn,gn,Cn,kn]=GD(on[0],on[1],rn[0],rn[1],u),[Bn,$n,vr,Xn]=d(xn,gn,Cn,kn,u);return h?bt(Bn,$n,vr,Xn):Ot(Bn,$n,vr,Xn),n(Bn,$n,vr,Xn,Rn),[Bn,$n,vr,Xn]},Ot=(on,rn,Rn,xn)=>{M.style.x=on,M.style.y=rn,M.style.width=Rn-on,M.style.height=xn-rn},bt=(on,rn,Rn,xn)=>{L.style.d=`
      M${R},${z}L${W},${z}L${W},${Y}L${R},${Y}Z
      M${on},${rn}L${on},${xn}L${Rn},${xn}L${Rn},${rn}Z
    `,M.style.x=on,M.style.y=rn,M.style.width=Rn-on,M.style.height=xn-rn},wt=on=>{const rn=($n,vr,Xn,nr,ni)=>$n+vr<nr?nr-vr:$n+Xn>ni?ni-Xn:$n,Rn=on[0]-w[0],xn=on[1]-w[1],gn=rn(Rn,S[0],E[0],R,W),Cn=rn(xn,S[1],E[1],z,Y),kn=[S[0]+gn,S[1]+Cn],Bn=[E[0]+gn,E[1]+Cn];dt(kn,Bn)},oe={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},Ut=on=>me(on)||Kt(on),Kt=on=>{const{id:rn}=on;return b.indexOf(rn)===-1?!1:new Set(Object.keys(oe)).has(rn)},me=on=>on===M.getElementById("selection"),Ee=on=>{const{target:rn}=on,[Rn,xn]=M0(t,on);if(!M||!Ut(rn)){st(Rn,xn,on),I=!0;return}Ut(rn)&&(w=[Rn,xn])},Pe=on=>{const{target:rn}=on,Rn=M0(t,on);if(!S)return;if(!w)return dt(S,Rn);if(me(rn))return wt(Rn);const[xn,gn]=[Rn[0]-w[0],Rn[1]-w[1]],{id:Cn}=rn;if(oe[Cn]){const[kn,Bn,$n,vr]=oe[Cn].vector;return dt([S[0]+xn*kn,S[1]+gn*Bn],[E[0]+xn*$n,E[1]+gn*vr])}},Ie=on=>{if(w){w=null;const{x:Cn,y:kn,width:Bn,height:$n}=M.style;S=[Cn,kn],E=[Cn+Bn,kn+$n],l(Cn,kn,Cn+Bn,kn+$n,on);return}E=M0(t,on);const[rn,Rn,xn,gn]=dt(S,E);I=!1,o(rn,Rn,xn,gn,on)},qe=on=>{const{target:rn}=on;M&&!Ut(rn)&&Ht()},sn=on=>{const{target:rn}=on;!M||!Ut(rn)||I?Vs(t,"crosshair"):me(rn)?Vs(t,"move"):Kt(rn)&&Vs(t,oe[rn.id].cursor)},yn=()=>{Vs(t,"default")};return t.addEventListener("dragstart",Ee),t.addEventListener("drag",Pe),t.addEventListener("dragend",Ie),t.addEventListener("click",qe),t.addEventListener("pointermove",sn),t.addEventListener("pointerleave",yn),{mask:M,move(on,rn,Rn,xn,gn=!0){M||st(on,rn,{}),S=[on,rn],E=[Rn,xn],dt([on,rn],[Rn,xn],gn)},remove(on=!0){M&&Ht(on)},destroy(){M&&Ht(!1),Vs(t,"default"),t.removeEventListener("dragstart",Ee),t.removeEventListener("drag",Pe),t.removeEventListener("dragend",Ie),t.removeEventListener("click",qe),t.removeEventListener("pointermove",sn),t.removeEventListener("pointerleave",yn)}}}function dM(t,e,n){return e.filter(r=>{if(r===t)return!1;const{interaction:o={}}=r.options;return Object.values(o).find(c=>c.brushKey===n)})}function $D(t,e,n){return dM(t,e,n).map(r=>ka(r.container))}function XD(t,e,n){return dM(t,e,n).map(r=>r.options)}function i7(t,e){var{elements:n,selectedHandles:r,siblings:o=Pe=>[],datum:c,brushRegion:l,extent:u,reverse:d,scale:h,coordinate:p,series:v=!1,key:m=Pe=>Pe,bboxOf:b=Pe=>{const{x:Ie,y:qe,width:sn,height:yn}=Pe.style;return{x:Ie,y:qe,width:sn,height:yn}},state:x={},emitter:S}=e,E=ya(e,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const w=n(t),M=o(t),L=M.flatMap(n),I=Uc(w,c),R=bn(E,"mask"),{setState:z,removeState:W}=yi(x,I),Y=new Map,{width:st,height:xt,x:Nt=0,y:Ht=0}=b(t),dt=u||[0,0,st,xt],Ot=()=>{for(const Pe of[...w,...L])W(Pe,"active","inactive")},bt=(Pe,Ie,qe,sn)=>{var yn;for(const rn of M)(yn=rn.brush)===null||yn===void 0||yn.remove();const on=new Set;for(const rn of w){const{min:Rn,max:xn}=rn.getLocalBounds(),[gn,Cn]=Rn,[kn,Bn]=xn;WD([gn,Cn,kn,Bn],[Pe,Ie,qe,sn])?(z(rn,"active"),on.add(m(rn))):z(rn,"inactive")}for(const rn of L)on.has(m(rn))?z(rn,"active"):z(rn,"inactive")},wt=()=>{for(const Pe of w)W(Pe,"inactive");for(const Pe of Y.values())Pe.remove();Y.clear()},oe=(Pe,Ie,qe,sn)=>{const yn=rn=>{const Rn=rn.cloneNode();return Rn.__data__=rn.__data__,rn.parentNode.appendChild(Rn),Y.set(rn,Rn),Rn},on=new F.UL({style:{x:Pe+Nt,y:Ie+Ht,width:qe-Pe,height:sn-Ie}});t.appendChild(on);for(const rn of w){const Rn=Y.get(rn)||yn(rn);Rn.style.clipPath=on,z(rn,"inactive"),z(Rn,"active")}},Ut=fM(t,Object.assign(Object.assign({},R),{extent:dt,brushRegion:l,reverse:d,selectedHandles:r,brushended:Pe=>{const Ie=v?wt:Ot;Pe&&S.emit("brush:remove",{nativeEvent:!0}),Ie()},brushed:(Pe,Ie,qe,sn,yn)=>{const on=ud(Pe,Ie,qe,sn,h,p);yn&&S.emit("brush:highlight",{nativeEvent:!0,data:{selection:on}}),(v?oe:bt)(Pe,Ie,qe,sn)},brushcreated:(Pe,Ie,qe,sn,yn)=>{const on=ud(Pe,Ie,qe,sn,h,p);S.emit("brush:end",Object.assign(Object.assign({},yn),{nativeEvent:!0,data:{selection:on}}))},brushupdated:(Pe,Ie,qe,sn,yn)=>{const on=ud(Pe,Ie,qe,sn,h,p);S.emit("brush:end",Object.assign(Object.assign({},yn),{nativeEvent:!0,data:{selection:on}}))},brushstarted:Pe=>{S.emit("brush:start",Pe)}})),Kt=({nativeEvent:Pe,data:Ie})=>{if(Pe)return;const{selection:qe}=Ie,[sn,yn,on,rn]=jc(qe,h,p);Ut.move(sn,yn,on,rn,!1)};S.on("brush:highlight",Kt);const me=({nativeEvent:Pe}={})=>{Pe||Ut.remove(!1)};S.on("brush:remove",me);const Ee=Ut.destroy.bind(Ut);return Ut.destroy=()=>{S.off("brush:highlight",Kt),S.off("brush:remove",me),Ee()},Ut}function hM(t){var{facet:e,brushKey:n}=t,r=ya(t,["facet","brushKey"]);return(o,c,l)=>{const{container:u,view:d,options:h}=o,p=ka(u),v={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},m=["active",["inactive",{opacity:.5}]],{scale:b,coordinate:x}=d;if(e){const E=p.getBounds(),w=E.min[0],M=E.min[1],L=E.max[0],I=E.max[1];return i7(p.parentNode.parentNode,Object.assign(Object.assign({elements:()=>yu(o,c),datum:ss(C0(o,c).map(R=>R.view)),brushRegion:(R,z,W,Y)=>[R,z,W,Y],extent:[w,M,L,I],state:bu(C0(o,c).map(R=>R.options),m),emitter:l,scale:b,coordinate:x,selectedHandles:void 0},v),r))}const S=i7(p,Object.assign(Object.assign({elements:Hs,key:E=>E.__data__.key,siblings:()=>$D(o,c,n),datum:ss([d,...dM(o,c,n).map(E=>E.view)]),brushRegion:(E,w,M,L)=>[E,w,M,L],extent:void 0,state:bu([h,...XD(o,c,n)],m),emitter:l,scale:b,coordinate:x,selectedHandles:void 0},v),r));return p.brush=S,()=>S.destroy()}}function pM(t,e,n,r,o){const[,c,,l]=o;return[t,c,n,l]}function qD(t){return hM(Object.assign(Object.assign({},t),{brushRegion:pM,selectedHandles:["handle-e","handle-w"]}))}function gM(t,e,n,r,o){const[c,,l]=o;return[c,e,l,r]}function KD(t){return hM(Object.assign(Object.assign({},t),{brushRegion:gM,selectedHandles:["handle-n","handle-s"]}))}var vM=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const QD="axis",JD="axis-line",t9="axis-main-group",o7="axis-hot-area";function e9(t){return t.getElementsByClassName(QD)}function a7(t){return t.getElementsByClassName(JD)[0]}function n9(t){return t.getElementsByClassName(t9)[0]}function s7(t){return n9(t).getLocalBounds()}function r9(t,e){var{cross:n,offsetX:r,offsetY:o}=e,c=vM(e,["cross","offsetX","offsetY"]);const l=s7(t),u=a7(t),[d]=u.getLocalBounds().min,[h,p]=l.min,[v,m]=l.max,b=(v-h)*2;return{brushRegion:gM,hotZone:new F.UL({className:o7,style:Object.assign({width:n?b/2:b,transform:`translate(${(n?h:d-b/2).toFixed(2)}, ${p})`,height:m-p},c)}),extent:n?(x,S,E,w)=>[-1/0,S,1/0,w]:(x,S,E,w)=>[Math.floor(h-r),S,Math.ceil(v-r),w]}}function i9(t,e){var{offsetY:n,offsetX:r,cross:o=!1}=e,c=vM(e,["offsetY","offsetX","cross"]);const l=s7(t),u=a7(t),[,d]=u.getLocalBounds().min,[h,p]=l.min,[v,m]=l.max,b=m-p;return{brushRegion:pM,hotZone:new F.UL({className:o7,style:Object.assign({width:v-h,height:o?b:b*2,transform:`translate(${h}, ${o?p:d-b})`},c)}),extent:o?(x,S,E,w)=>[x,-1/0,E,1/0]:(x,S,E,w)=>[x,Math.floor(p-n),E,Math.ceil(m-n)]}}function o9(t,e){var{axes:n,elements:r,points:o,horizontal:c,datum:l,offsetY:u,offsetX:d,reverse:h=!1,state:p={},emitter:v,coordinate:m}=e,b=vM(e,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const x=r(t),S=n(t),E=Uc(x,l),{setState:w,removeState:M}=yi(p,E),L=new Map,I=bn(b,"mask"),R=Kt=>Array.from(L.values()).every(([me,Ee,Pe,Ie])=>Kt.some(([qe,sn])=>qe>=me&&qe<=Pe&&sn>=Ee&&sn<=Ie)),z=S.map(Kt=>Kt.attributes.scale),W=Kt=>Kt.length>2?[Kt[0],Kt[Kt.length-1]]:Kt,Y=new Map,st=()=>{Y.clear();for(let Kt=0;Kt<S.length;Kt++){const me=z[Kt],{domain:Ee}=me.getOptions();Y.set(Kt,W(Ee))}};st();const xt=(Kt,me)=>{const Ee=[];for(const Ie of x){const qe=o(Ie);R(qe)?(w(Ie,"active"),Ee.push(Ie)):w(Ie,"inactive")}if(Y.set(Kt,Ht(Ee,Kt)),!me)return;const Pe=()=>{if(!dt)return Array.from(Y.values());const Ie=[];for(const[qe,sn]of Y){const yn=z[qe],{name:on}=yn.getOptions();on==="x"?Ie[0]=sn:Ie[1]=sn}return Ie};v.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:Pe()}})},Nt=Kt=>{for(const me of x)M(me,"active","inactive");st(),Kt&&v.emit("brushAxis:remove",{nativeEvent:!0})},Ht=(Kt,me)=>{const Ee=z[me],{name:Pe}=Ee.getOptions(),Ie=Kt.map(qe=>{const sn=qe.__data__;return Ee.invert(sn[Pe])});return W(os(Ee,Ie))},dt=S.some(c)&&S.some(Kt=>!c(Kt)),Ot=[];for(let Kt=0;Kt<S.length;Kt++){const me=S[Kt],Ee=c(me)?i9:r9,{hotZone:Pe,brushRegion:Ie,extent:qe}=Ee(me,{offsetY:u,offsetX:d,cross:dt,zIndex:999,fill:"transparent"});me.parentNode.appendChild(Pe);const sn=fM(Pe,Object.assign(Object.assign({},I),{reverse:h,brushRegion:Ie,brushended(yn){L.delete(me),Array.from(L.entries()).length===0?Nt(yn):xt(Kt,yn)},brushed(yn,on,rn,Rn,xn){L.set(me,qe(yn,on,rn,Rn)),xt(Kt,xn)}}));Ot.push(sn)}const bt=(Kt={})=>{const{nativeEvent:me}=Kt;me||Ot.forEach(Ee=>Ee.remove(!1))},wt=(Kt,me,Ee)=>{const[Pe,Ie]=Kt,qe=on=>on.getStep?on.getStep():0,sn=oe(Pe,me,Ee),yn=oe(Ie,me,Ee)+qe(me);return c(Ee)?[sn,-1/0,yn,1/0]:[-1/0,sn,1/0,yn]},oe=(Kt,me,Ee)=>{const{height:Pe,width:Ie}=m.getOptions(),qe=me.clone();return c(Ee)?qe.update({range:[0,Ie]}):qe.update({range:[Pe,0]}),qe.map(Kt)},Ut=Kt=>{const{nativeEvent:me}=Kt;if(me)return;const{selection:Ee}=Kt.data;for(let Pe=0;Pe<Ot.length;Pe++){const Ie=Ee[Pe],qe=Ot[Pe],sn=S[Pe];if(Ie){const yn=z[Pe];qe.move(...wt(Ie,yn,sn),!1)}else qe.remove(!1)}};return v.on("brushAxis:remove",bt),v.on("brushAxis:highlight",Ut),()=>{Ot.forEach(Kt=>Kt.destroy()),v.off("brushAxis:remove",bt),v.off("brushAxis:highlight",Ut)}}function a9(t){return(e,n,r)=>{const{container:o,view:c,options:l}=e,u=ka(o),{x:d,y:h}=u.getBBox(),{coordinate:p}=c;return o9(o,Object.assign({elements:Hs,axes:e9,offsetY:h,offsetX:d,points:v=>v.__data__.points,horizontal:v=>{const{startPos:[m,b],endPos:[x,S]}=v.attributes;return m!==x&&b===S},datum:ss(c),state:bu(l,["active",["inactive",{opacity:.5}]]),coordinate:p,emitter:r},t))}}var s9=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},c7=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function c9(t=300){let e=null;return n=>{const{timeStamp:r}=n;return e!==null&&r-e<t?(e=r,!0):(e=r,!1)}}function l9(t,e){var{filter:n,reset:r,brushRegion:o,extent:c,reverse:l,emitter:u,scale:d,coordinate:h,selection:p,series:v=!1}=e,m=c7(e,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const b=bn(m,"mask"),{width:x,height:S}=t.getBBox(),E=c||[0,0,x,S],w=c9(),M=fM(t,Object.assign(Object.assign({},b),{extent:E,brushRegion:o,reverse:l,brushcreated:L}));t.addEventListener("click",I);function L(z,W,Y,st,xt){xt.nativeEvent=!0,n(p(z,W,Y,st),xt),M.remove()}function I(z){w(z)&&(z.nativeEvent=!0,r(z))}const R=({nativeEvent:z,data:W})=>{if(z)return;const{selection:Y}=W;n(Y,{nativeEvent:!1})};return u.on("brush:filter",R),()=>{M.destroy(),u.off("brush:filter",R),t.removeEventListener("click",I)}}function mM(t){var{hideX:e=!0,hideY:n=!0}=t,r=c7(t,["hideX","hideY"]);return(o,c,l)=>{const{container:u,view:d,options:h,update:p,setState:v}=o,m=ka(u),b={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let x=!1,S=!1,E=d;const{scale:w,coordinate:M}=d;return l9(m,Object.assign(Object.assign({brushRegion:(L,I,R,z)=>[L,I,R,z],selection:(L,I,R,z)=>{const{scale:W,coordinate:Y}=E;return ud(L,I,R,z,W,Y)},filter:(L,I)=>s9(this,void 0,void 0,function*(){if(S)return;S=!0;const[R,z]=L;v("brushFilter",Y=>{const{marks:st}=Y,xt=st.map(Nt=>en({axis:Object.assign(Object.assign({},e&&{x:{transform:[{type:"hide"}]}}),n&&{y:{transform:[{type:"hide"}]}})},Nt,{scale:{x:{domain:R,nice:!1},y:{domain:z,nice:!1}}}));return Object.assign(Object.assign({},h),{marks:xt,clip:!0})}),l.emit("brush:filter",Object.assign(Object.assign({},I),{data:{selection:[R,z]}})),E=(yield p()).view,S=!1,x=!0}),reset:L=>{if(S||!x)return;const{scale:I}=d,{x:R,y:z}=I,W=R.getOptions().domain,Y=z.getOptions().domain;l.emit("brush:filter",Object.assign(Object.assign({},L),{data:{selection:[W,Y]}})),x=!1,E=d,v("brushFilter"),p()},extent:void 0,emitter:l,scale:w,coordinate:M},b),r))}}function u9(t){return mM(Object.assign(Object.assign({hideX:!0},t),{brushRegion:pM}))}function f9(t){return mM(Object.assign(Object.assign({hideY:!0},t),{brushRegion:gM}))}var d9=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const h9="slider";function p9(t,e,n,r=!1,o="x",c="y"){const{marks:l}=t,u=l.map(d=>{var h,p;return en({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},d,{scale:e,[n]:Object.assign(Object.assign({},((h=d[n])===null||h===void 0?void 0:h[o])&&{[o]:Object.assign({preserve:!0},r&&{ratio:null})}),((p=d[n])===null||p===void 0?void 0:p[c])&&{[c]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},t),{marks:u,clip:!0,animate:!1})}function g9(t,e,n){const[r,o]=t,c=n?d=>1-d:d=>d,l=Bc(e,c(r),!0),u=Bc(e,c(o),!1);return os(e,[l,u])}function mS(t){return[t[0],t[t.length-1]]}function l7({initDomain:t={},className:e=h9,prefix:n="slider",setValue:r=(h,p)=>h.setValues(p),hasState:o=!1,wait:c=50,leading:l=!0,trailing:u=!1,getInitValues:d=h=>{var p;const v=(p=h==null?void 0:h.attributes)===null||p===void 0?void 0:p.values;if(v[0]!==0||v[1]!==1)return v}}){return(h,p,v)=>{const{container:m,view:b,update:x,setState:S}=h,E=m.getElementsByClassName(e);if(!E.length)return()=>{};let w=!1;const{scale:M,coordinate:L,layout:I}=b,{paddingLeft:R,paddingTop:z,paddingBottom:W,paddingRight:Y}=I,{x:st,y:xt}=M,Nt=Yr(L),Ht=wt=>{const oe=wt==="vertical"?"y":"x",Ut=wt==="vertical"?"x":"y";return Nt?[Ut,oe]:[oe,Ut]},dt=new Map,Ot=new Set,bt={x:t.x||st.getOptions().domain,y:t.y||xt.getOptions().domain};for(const wt of E){const{orientation:oe}=wt.attributes,[Ut,Kt]=Ht(oe),me=`${n}${Ts(Ut)}:filter`,Ee=Ut==="x",{ratio:Pe}=st.getOptions(),{ratio:Ie}=xt.getOptions(),qe=rn=>{if(rn.data){const{selection:kn}=rn.data,[Bn=mS(bt.x),$n=mS(bt.y)]=kn;return Ee?[os(st,Bn,Pe),os(xt,$n,Ie)]:[os(xt,$n,Ie),os(st,Bn,Pe)]}const{value:Rn}=rn.detail,xn=M[Ut],gn=g9(Rn,xn,Nt&&oe==="horizontal"),Cn=bt[Kt];return[gn,Cn]},sn=sf(rn=>d9(this,void 0,void 0,function*(){const{initValue:Rn=!1}=rn;if(w&&!Rn)return;w=!0;const{nativeEvent:xn=!0}=rn,[gn,Cn]=qe(rn);if(bt[Ut]=gn,bt[Kt]=Cn,xn){const kn=Ee?gn:Cn,Bn=Ee?Cn:gn;v.emit(me,Object.assign(Object.assign({},rn),{nativeEvent:xn,data:{selection:[mS(kn),mS(Bn)]}}))}S(wt,kn=>Object.assign(Object.assign({},p9(kn,{[Ut]:{domain:gn,nice:!1}},n,o,Ut,Kt)),{paddingLeft:R,paddingTop:z,paddingBottom:W,paddingRight:Y})),yield x(),w=!1}),c,{leading:l,trailing:u}),yn=rn=>{const{nativeEvent:Rn}=rn;if(Rn)return;const{data:xn}=rn,{selection:gn}=xn,[Cn,kn]=gn;wt.dispatchEvent(new F.Aw("valuechange",{data:xn,nativeEvent:!1}));const Bn=Ee?fd(Cn,st):fd(kn,xt);r(wt,Bn)};v.on(me,yn),wt.addEventListener("valuechange",sn),dt.set(wt,sn),Ot.add([me,yn]);const on=d(wt);on&&wt.dispatchEvent(new F.Aw("valuechange",{detail:{value:on},nativeEvent:!1,initValue:!0}))}return()=>{for(const[wt,oe]of dt)wt.removeEventListener("valuechange",oe);for(const[wt,oe]of Ot)v.off(wt,oe)}}}const u7="g2-scrollbar";function v9(t={}){return(e,n,r)=>{const{view:o,container:c}=e;if(!c.getElementsByClassName(u7).length)return()=>{};const{scale:u}=o,{x:d,y:h}=u,p={x:[...d.getOptions().domain],y:[...h.getOptions().domain]};return d.update({domain:d.getOptions().expectedDomain}),h.update({domain:h.getOptions().expectedDomain}),l7(Object.assign(Object.assign({},t),{initDomain:p,className:u7,prefix:"scrollbar",hasState:!0,setValue:(m,b)=>m.setValue(b[0]),getInitValues:m=>{const b=m.slider.attributes.values;if(b[0]!==0)return b}}))(e,n,r)}}var m9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function y9(t,e,n){return`<${t} style="${Object.entries(n).map(([r,o])=>`${cb(r)}:${o}`).join(";")}">${e}</${t}>`}const b9={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function f7(t){return t.nodeName!=="text"?!1:!!t.isOverflowing()}function d7(t){var{offsetX:e=8,offsetY:n=8}=t,r=m9(t,["offsetX","offsetY"]);return o=>{const{container:c}=o,[l,u]=c.getBounds().min,d=bn(r,"tip"),h=new Set,p=m=>{const{target:b}=m;if(!f7(b)){m.stopPropagation();return}const{offsetX:x,offsetY:S}=m,E=x+e-l,w=S+n-u;if(b.tip){b.tip.style.x=E,b.tip.style.y=w;return}const{text:M}=b.style,L=new F.k9({className:"poptip",style:{innerHTML:y9("div",M,Object.assign(Object.assign({},b9),d)),x:E,y:w}});c.appendChild(L),b.tip=L,h.add(L)},v=m=>{const{target:b}=m;if(!f7(b)){m.stopPropagation();return}b.tip&&(b.tip.remove(),b.tip=null,h.delete(b.tip))};return c.addEventListener("pointerover",p),c.addEventListener("pointerout",v),()=>{c.removeEventListener("pointerover",p),c.removeEventListener("pointerout",v),h.forEach(m=>m.remove())}}}d7.props={reapplyWhenUpdate:!0};function _9(t,e){var n=Bg(e),r=n.length;if((0,fe.Z)(t))return!r;for(var o=0;o<r;o+=1){var c=n[o];if(e[c]!==t[c]||!(c in t))return!1}return!0}var x9=_9;function S9(t,e){if(!(0,mi.Z)(t))return null;var n;if(lo(e)&&(n=e),Ya(e)&&(n=function(o){return x9(o,e)}),n){for(var r=0;r<t.length;r+=1)if(n(t[r]))return t[r]}return null}var Oh=S9;function yS(t){return t==null?null:h7(t)}function h7(t){if(typeof t!="function")throw new Error;return t}var O9={depth:-1},p7={},yM={};function E9(t){return t.id}function w9(t){return t.parentId}function bM(){var t=E9,e=w9,n;function r(o){var c=Array.from(o),l=t,u=e,d,h,p,v,m,b,x,S,E=new Map;if(n!=null){var w=c.map(function(Y,st){return A9(n(Y,st,o))}),M=w.map(g7),L=new Set(w).add(""),I=Rg(M),R;try{for(I.s();!(R=I.n()).done;){var z=R.value;L.has(z)||(L.add(z),w.push(z),M.push(g7(z)),c.push(yM))}}catch(Y){I.e(Y)}finally{I.f()}l=function(st,xt){return w[xt]},u=function(st,xt){return M[xt]}}for(p=0,d=c.length;p<d;++p)h=c[p],b=c[p]=new rl(h),(x=l(h,p,o))!=null&&(x+="")&&(S=b.id=x,E.set(S,E.has(S)?p7:b)),(x=u(h,p,o))!=null&&(x+="")&&(b.parent=x);for(p=0;p<d;++p)if(b=c[p],x=b.parent){if(m=E.get(x),!m)throw new Error("missing: "+x);if(m===p7)throw new Error("ambiguous: "+x);m.children?m.children.push(b):m.children=[b],b.parent=m}else{if(v)throw new Error("multiple roots");v=b}if(!v)throw new Error("no root");if(n!=null){for(;v.data===yM&&v.children.length===1;)v=v.children[0],--d;for(var W=c.length-1;W>=0&&(b=c[W],b.data===yM);--W)b.data=null}if(v.parent=O9,v.eachBefore(function(Y){Y.depth=Y.parent.depth+1,--d}).eachBefore(F2),v.parent=null,d>0)throw new Error("cycle");return v}return r.id=function(o){return arguments.length?(t=yS(o),r):t},r.parentId=function(o){return arguments.length?(e=yS(o),r):e},r.path=function(o){return arguments.length?(n=yS(o),r):n},r}function A9(t){t="".concat(t);var e=t.length;return _M(t,e-1)&&!_M(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:"/".concat(t)}function g7(t){var e=t.length;if(e<2)return"";for(;--e>1&&!_M(t,e););return t.slice(0,e)}function _M(t,e){if(t[e]==="/"){for(var n=0;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}function T9(t,e,n,r,o){var c=t.children,l,u=c.length,d,h=new Array(u+1);for(h[0]=d=l=0;l<u;++l)h[l+1]=d+=c[l].value;p(0,u,t.value,e,n,r,o);function p(v,m,b,x,S,E,w){if(v>=m-1){var M=c[v];M.x0=x,M.y0=S,M.x1=E,M.y1=w;return}for(var L=h[v],I=b/2+L,R=v+1,z=m-1;R<z;){var W=R+z>>>1;h[W]<I?R=W+1:z=W}I-h[R-1]<h[R]-I&&v+1<R&&--R;var Y=h[R]-L,st=b-Y;if(E-x>w-S){var xt=b?(x*st+E*Y)/b:E;p(v,R,Y,x,S,xt,w),p(R,m,st,xt,S,E,w)}else{var Nt=b?(S*st+w*Y)/b:w;p(v,R,Y,x,S,E,Nt),p(R,m,st,x,Nt,E,w)}}}function bS(t,e,n,r,o){for(var c=t.children,l,u=-1,d=c.length,h=t.value&&(o-n)/t.value;++u<d;)l=c[u],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*h}function C9(t,e,n,r,o){(t.depth&1?bS:Vu)(t,e,n,r,o)}var v7=(1+Math.sqrt(5))/2;function m7(t,e,n,r,o,c){for(var l=[],u=e.children,d,h,p=0,v=0,m=u.length,b,x,S=e.value,E,w,M,L,I,R,z;p<m;){b=o-n,x=c-r;do E=u[v++].value;while(!E&&v<m);for(w=M=E,R=Math.max(x/b,b/x)/(S*t),z=E*E*R,I=Math.max(M/z,z/w);v<m;++v){if(E+=h=u[v].value,h<w&&(w=h),h>M&&(M=h),z=E*E*R,L=Math.max(M/z,z/w),L>I){E-=h;break}I=L}l.push(d={value:E,dice:b<x,children:u.slice(p,v)}),d.dice?Vu(d,n,r,o,S?r+=x*E/S:c):bS(d,n,r,S?n+=b*E/S:o,c),S-=E,p=v}return l}var y7=function t(e){function n(r,o,c,l,u){m7(e,r,o,c,l,u)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(v7),M9=function t(e){function n(r,o,c,l,u){if((d=r._squarify)&&d.ratio===e)for(var d,h,p,v,m=-1,b,x=d.length,S=r.value;++m<x;){for(h=d[m],p=h.children,v=h.value=0,b=p.length;v<b;++v)h.value+=p[v].value;h.dice?Vu(h,o,c,l,S?c+=(u-c)*h.value/S:u):bS(h,o,c,S?o+=(l-o)*h.value/S:l,u),S-=h.value}else r._squarify=d=m7(e,r,o,c,l,u),d.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(v7);function lf(){return 0}function Eh(t){return function(){return t}}function L9(){var t=y7,e=!1,n=1,r=1,o=[0],c=lf,l=lf,u=lf,d=lf,h=lf;function p(m){return m.x0=m.y0=0,m.x1=n,m.y1=r,m.eachBefore(v),o=[0],e&&m.eachBefore(MT),m}function v(m){var b=o[m.depth],x=m.x0+b,S=m.y0+b,E=m.x1-b,w=m.y1-b;E<x&&(x=E=(x+E)/2),w<S&&(S=w=(S+w)/2),m.x0=x,m.y0=S,m.x1=E,m.y1=w,m.children&&(b=o[m.depth+1]=c(m)/2,x+=h(m)-b,S+=l(m)-b,E-=u(m)-b,w-=d(m)-b,E<x&&(x=E=(x+E)/2),w<S&&(S=w=(S+w)/2),t(m,x,S,E,w))}return p.round=function(m){return arguments.length?(e=!!m,p):e},p.size=function(m){return arguments.length?(n=+m[0],r=+m[1],p):[n,r]},p.tile=function(m){return arguments.length?(t=h7(m),p):t},p.padding=function(m){return arguments.length?p.paddingInner(m).paddingOuter(m):p.paddingInner()},p.paddingInner=function(m){return arguments.length?(c=typeof m=="function"?m:Eh(+m),p):c},p.paddingOuter=function(m){return arguments.length?p.paddingTop(m).paddingRight(m).paddingBottom(m).paddingLeft(m):p.paddingTop()},p.paddingTop=function(m){return arguments.length?(l=typeof m=="function"?m:Eh(+m),p):l},p.paddingRight=function(m){return arguments.length?(u=typeof m=="function"?m:Eh(+m),p):u},p.paddingBottom=function(m){return arguments.length?(d=typeof m=="function"?m:Eh(+m),p):d},p.paddingLeft=function(m){return arguments.length?(h=typeof m=="function"?m:Eh(+m),p):h},p}function P9(t,e){return Array.isArray(t)?typeof e=="function"?bM().path(e)(t):bM()(t):Gu(t)}function b7(t,e=[t.data.name]){t.id=t.id||t.data.name,t.path=e,t.children&&t.children.forEach(n=>{n.id=`${t.id}/${n.data.name}`,n.path=[...e,n.data.name],b7(n,n.path)})}function _7(t){const e=hr(t,["data","name"]);e.replaceAll&&(t.path=e.replaceAll(".","/").split("/")),t.children&&t.children.forEach(n=>{_7(n)})}function I9(t,e){const n={treemapBinary:T9,treemapDice:Vu,treemapSlice:bS,treemapSliceDice:C9,treemapSquarify:y7,treemapResquarify:M9},r=t==="treemapSquarify"?n[t].ratio(e):n[t];if(!r)throw new TypeError("Invalid tile method!");return r}function x7(t,e,n){const{value:r}=n,o=I9(e.tile,e.ratio),c=P9(t,e.path);(0,mi.Z)(t)?_7(c):b7(c),r?c.sum(d=>e.ignoreParentValue&&d.children?0:ga(r)(d)).sort(e.sort):c.count(),L9().tile(o).size(e.size).round(e.round).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(c);const l=c.descendants().map(d=>Object.assign(d,{id:d.id.replace(/^\//,""),x:[d.x0,d.x1],y:[d.y0,d.y1]}));return[l.filter(typeof e.layer=="function"?e.layer:d=>d.height===e.layer),l]}var R9=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},k9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function D9(t){return Wn(t).select(`.${nt}`).node()}const F9={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function N9(t={}){const{originData:e=[],layout:n}=t,r=k9(t,["originData","layout"]),o=en({},F9,r),c=bn(o,"breadCrumb"),l=bn(o,"active");return u=>{const{update:d,setState:h,container:p,options:v}=u,m=D9(p),b=v.marks[0],{state:x}=b,S=new F.ZA;m.appendChild(S);const E=(I,R)=>R9(this,void 0,void 0,function*(){if(S.removeChildren(),R){let z="",W=c.y,Y=0;const st=[],xt=m.getBBox().width,Nt=I.map((Ht,dt)=>{z=`${z}${Ht}/`,st.push(Ht);const Ot=new F.xv({name:z.replace(/\/$/,""),style:Object.assign(Object.assign({text:Ht,x:Y,path:[...st],depth:dt},c),{y:W})});S.appendChild(Ot),Y+=Ot.getBBox().width;const bt=new F.xv({style:Object.assign(Object.assign({x:Y,text:" / "},c),{y:W})});return S.appendChild(bt),Y+=bt.getBBox().width,Y>xt&&(W=S.getBBox().height+c.y,Y=0,Ot.attr({x:Y,y:W}),Y+=Ot.getBBox().width,bt.attr({x:Y,y:W}),Y+=bt.getBBox().width),dt===su(I)-1&&bt.remove(),Ot});Nt.forEach((Ht,dt)=>{if(dt===su(Nt)-1)return;const Ot=Object.assign({},Ht.attributes);Ht.attr("cursor","pointer"),Ht.addEventListener("mouseenter",()=>{Ht.attr(l)}),Ht.addEventListener("mouseleave",()=>{Ht.attr(Ot)}),Ht.addEventListener("click",()=>{E(hr(Ht,["style","path"]),hr(Ht,["style","depth"]))})})}jD(p,h),h("treemapDrillDown",z=>{const{marks:W}=z,Y=I.join("/"),st=W.map(xt=>{if(xt.type!=="rect")return xt;let Nt=e;if(R){const dt=e.filter(Ut=>{const Kt=hr(Ut,["id"]);return Kt&&(Kt.match(`${Y}/`)||Y.match(Kt))}).map(Ut=>({value:Ut.height===0?hr(Ut,["value"]):void 0,name:hr(Ut,["id"])})),{paddingLeft:Ot,paddingBottom:bt,paddingRight:wt}=n,oe=Object.assign(Object.assign({},n),{paddingTop:(n.paddingTop||S.getBBox().height+10)/(R+1),paddingLeft:Ot/(R+1),paddingBottom:bt/(R+1),paddingRight:wt/(R+1),path:Ut=>Ut.name,layer:Ut=>Ut.depth===R+1});Nt=x7(dt,oe,{value:"value"})[0]}else Nt=e.filter(dt=>dt.depth===1);const Ht=[];return Nt.forEach(({path:dt})=>{Ht.push(Lv(dt))}),en({},xt,{data:Nt,scale:{color:{domain:Ht}}})});return Object.assign(Object.assign({},z),{marks:st})}),yield d(void 0,["legendFilter"])}),w=I=>{const R=I.target;if(hr(R,["markType"])!=="rect")return;const z=hr(R,["__data__","key"]),W=Oh(e,Y=>Y.id===z);hr(W,"height")&&E(hr(W,"path"),hr(W,"depth"))};m.addEventListener("click",w);const M=Bg(Object.assign(Object.assign({},x.active),x.inactive)),L=()=>{Nb(m).forEach(R=>{const z=hr(R,["style","cursor"]),W=Oh(e,Y=>Y.id===hr(R,["__data__","key"]));if(z!=="pointer"&&(W!=null&&W.height)){R.style.cursor="pointer";const Y=Hu(R.attributes,M);R.addEventListener("mouseenter",()=>{R.attr(x.active)}),R.addEventListener("mouseleave",()=>{R.attr(en(Y,x.inactive))})}})};return L(),m.addEventListener("mousemove",L),()=>{S.remove(),m.removeEventListener("click",w),m.removeEventListener("mousemove",L)}}}var xM=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},B9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const j9={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},SM="movePoint",S7=t=>{const e=t.target,{markType:n}=e;n==="line"&&(e.attr("_lineWidth",e.attr("lineWidth")||1),e.attr("lineWidth",e.attr("_lineWidth")+3)),n==="interval"&&(e.attr("_opacity",e.attr("opacity")||1),e.attr("opacity",.7*e.attr("_opacity")))},O7=t=>{const e=t.target,{markType:n}=e;n==="line"&&e.attr("lineWidth",e.attr("_lineWidth")),n==="interval"&&e.attr("opacity",e.attr("_opacity"))},z9=(t,e,n)=>e.map(r=>["x","color"].reduce((c,l)=>{const u=n[l];return u&&r[u]!==t[u]?!1:c},!0)?Object.assign(Object.assign({},r),t):r),U9=t=>{const e=hr(t,["__data__","y"]),r=hr(t,["__data__","y1"])-e,{__data__:{data:o,encode:c,transform:l},childNodes:u}=t.parentNode,d=Oh(l,({type:v})=>v==="normalizeY"),h=hr(c,["y","field"]),p=o[u.indexOf(t)][h];return(v,m=!1)=>d||m?v/(1-v)/(r/(1-r))*p:v},Z9=(t,e)=>{const n=hr(t,["__data__","seriesItems",e,"0","value"]),r=hr(t,["__data__","seriesIndex",e]),{__data__:{data:o,encode:c,transform:l}}=t.parentNode,u=Oh(l,({type:p})=>p==="normalizeY"),d=hr(c,["y","field"]),h=o[r][d];return p=>u?n===1?p:p/(1-p)/(n/(1-n))*h:p},E7=(t,e,n)=>{t.forEach((r,o)=>{r.attr("stroke",e[1]===o?n.activeStroke:n.stroke)})},w7=(t,e,n,r)=>{const o=new F.y$({style:n}),c=new F.xv({style:r});return e.appendChild(c),t.appendChild(o),[o,c]},A7=(t,e)=>{if(!hr(t,["options","range","indexOf"]))return;const r=t.options.range.indexOf(e);return t.sortedDomain[r]},OM=(t,e,n)=>{const r=I0(t,e),c=I0(t,n)/r,l=t[0]+(e[0]-t[0])*c,u=t[1]+(e[1]-t[1])*c;return[l,u]};function H9(t={}){const{selection:e=[],precision:n=2}=t,r=B9(t,["selection","precision"]),o=Object.assign(Object.assign({},j9),r||{}),c=bn(o,"path"),l=bn(o,"label"),u=bn(o,"point");return(d,h,p)=>{const{update:v,setState:m,container:b,view:x,options:{marks:S,coordinate:E}}=d,w=ka(b);let M=Nb(w),L,I=e;const{transform:R=[],type:z}=E,W=!!Oh(R,({type:Ut})=>Ut==="transpose"),Y=z==="polar",st=z==="theta",xt=!!Oh(M,({markType:Ut})=>Ut==="area");xt&&(M=M.filter(({markType:Ut})=>Ut==="area"));const Nt=new F.ZA({style:{zIndex:2}});w.appendChild(Nt);const Ht=()=>{p.emit("element-point:select",{nativeEvent:!0,data:{selection:I}})},dt=(Ut,Kt)=>{p.emit("element-point:moved",{nativeEvent:!0,data:{changeData:Ut,data:Kt}})},Ot=Ut=>{const Kt=Ut.target;I=[Kt.parentNode.childNodes.indexOf(Kt)],Ht(),wt(Kt)},bt=Ut=>{const{data:{selection:Kt},nativeEvent:me}=Ut;if(me)return;I=Kt;const Ee=hr(M,[I==null?void 0:I[0]]);Ee&&wt(Ee)},wt=Ut=>{const{attributes:Kt,markType:me,__data__:Ee}=Ut,{stroke:Pe}=Kt,{points:Ie,seriesTitle:qe,color:sn,title:yn,seriesX:on,y1:rn}=Ee;if(W&&me!=="interval")return;const{scale:Rn,coordinate:xn}=(L==null?void 0:L.view)||x,{color:gn,y:Cn,x:kn}=Rn,Bn=xn.getCenter();Nt.removeChildren();let $n;const vr=(Xn,nr,ni,Ji)=>xM(this,void 0,void 0,function*(){return m("elementPointMove",yo=>{var vi;const Ao=(((vi=L==null?void 0:L.options)===null||vi===void 0?void 0:vi.marks)||S).map(to=>{if(!Ji.includes(to.type))return to;const{data:Oa,encode:zi}=to,To=Object.keys(zi).reduce((Nn,Jn)=>{const sr=zi[Jn];return Jn==="x"&&(Nn[sr]=Xn),Jn==="y"&&(Nn[sr]=nr),Jn==="color"&&(Nn[sr]=ni),Nn},{}),eo=z9(To,Oa,zi);return dt(To,eo),en({},to,{data:eo,animate:!1})});return Object.assign(Object.assign({},yo),{marks:Ao})}),yield v("elementPointMove")});if(["line","area"].includes(me))Ie.forEach((Xn,nr)=>{const ni=kn.invert(on[nr]);if(!ni)return;const Ji=new F.Cd({name:SM,style:Object.assign({cx:Xn[0],cy:Xn[1],fill:Pe},u)}),yo=Z9(Ut,nr);Ji.addEventListener("mousedown",vi=>{const Ao=xn.output([on[nr],0]),to=qe==null?void 0:qe.length;b.attr("cursor","move"),I[1]!==nr&&(I[1]=nr,Ht()),E7(Nt.childNodes,I,u);const[Oa,zi]=w7(Nt,Ji,c,l),$i=eo=>{const Nn=Xn[1]+eo.clientY-$n[1];if(xt)if(Y){const Jn=Xn[0]+eo.clientX-$n[0],[sr,ur]=OM(Bn,Ao,[Jn,Nn]),[,Jr]=xn.output([1,Cn.output(0)]),[,xi]=xn.invert([sr,Jr-(Ie[nr+to][1]-ur)]),Si=(nr+1)%to,ao=(nr-1+to)%to,Ea=_u([Ie[ao],[sr,ur],qe[Si]&&Ie[Si]]);zi.attr("text",yo(Cn.invert(xi)).toFixed(n)),Oa.attr("d",Ea),Ji.attr("cx",sr),Ji.attr("cy",ur)}else{const[,Jn]=xn.output([1,Cn.output(0)]),[,sr]=xn.invert([Xn[0],Jn-(Ie[nr+to][1]-Nn)]),ur=_u([Ie[nr-1],[Xn[0],Nn],qe[nr+1]&&Ie[nr+1]]);zi.attr("text",yo(Cn.invert(sr)).toFixed(n)),Oa.attr("d",ur),Ji.attr("cy",Nn)}else{const[,Jn]=xn.invert([Xn[0],Nn]),sr=_u([Ie[nr-1],[Xn[0],Nn],Ie[nr+1]]);zi.attr("text",Cn.invert(Jn).toFixed(n)),Oa.attr("d",sr),Ji.attr("cy",Nn)}};$n=[vi.clientX,vi.clientY],window.addEventListener("mousemove",$i);const To=()=>xM(this,void 0,void 0,function*(){if(b.attr("cursor","default"),window.removeEventListener("mousemove",$i),b.removeEventListener("mouseup",To),(0,Hf.Z)(zi.attr("text")))return;const eo=Number(zi.attr("text")),Nn=A7(gn,sn);L=yield vr(ni,eo,Nn,["line","area"]),zi.remove(),Oa.remove(),wt(Ut)});b.addEventListener("mouseup",To)}),Nt.appendChild(Ji)}),E7(Nt.childNodes,I,u);else if(me==="interval"){let Xn=[(Ie[0][0]+Ie[1][0])/2,Ie[0][1]];W?Xn=[Ie[0][0],(Ie[0][1]+Ie[1][1])/2]:st&&(Xn=Ie[0]);const nr=U9(Ut),ni=new F.Cd({name:SM,style:Object.assign(Object.assign({cx:Xn[0],cy:Xn[1],fill:Pe},u),{stroke:u.activeStroke})});ni.addEventListener("mousedown",Ji=>{b.attr("cursor","move");const yo=A7(gn,sn),[vi,Ao]=w7(Nt,ni,c,l),to=zi=>{if(W){const $i=Xn[0]+zi.clientX-$n[0],[To]=xn.output([Cn.output(0),Cn.output(0)]),[,eo]=xn.invert([To+($i-Ie[2][0]),Xn[1]]),Nn=_u([[$i,Ie[0][1]],[$i,Ie[1][1]],Ie[2],Ie[3]],!0);Ao.attr("text",nr(Cn.invert(eo)).toFixed(n)),vi.attr("d",Nn),ni.attr("cx",$i)}else if(st){const $i=Xn[1]+zi.clientY-$n[1],To=Xn[0]+zi.clientX-$n[0],[eo,Nn]=OM(Bn,[To,$i],Xn),[Jn,sr]=OM(Bn,[To,$i],Ie[1]),ur=xn.invert([eo,Nn])[1],Jr=rn-ur;if(Jr<0)return;const xi=jA(Bn,[[eo,Nn],[Jn,sr],Ie[2],Ie[3]],Jr>.5?1:0);Ao.attr("text",nr(Jr,!0).toFixed(n)),vi.attr("d",xi),ni.attr("cx",eo),ni.attr("cy",Nn)}else{const $i=Xn[1]+zi.clientY-$n[1],[,To]=xn.output([1,Cn.output(0)]),[,eo]=xn.invert([Xn[0],To-(Ie[2][1]-$i)]),Nn=_u([[Ie[0][0],$i],[Ie[1][0],$i],Ie[2],Ie[3]],!0);Ao.attr("text",nr(Cn.invert(eo)).toFixed(n)),vi.attr("d",Nn),ni.attr("cy",$i)}};$n=[Ji.clientX,Ji.clientY],window.addEventListener("mousemove",to);const Oa=()=>xM(this,void 0,void 0,function*(){if(b.attr("cursor","default"),b.removeEventListener("mouseup",Oa),window.removeEventListener("mousemove",to),(0,Hf.Z)(Ao.attr("text")))return;const zi=Number(Ao.attr("text"));L=yield vr(yn,zi,yo,[me]),Ao.remove(),vi.remove(),wt(Ut)});b.addEventListener("mouseup",Oa)}),Nt.appendChild(ni)}};M.forEach((Ut,Kt)=>{I[0]===Kt&&wt(Ut),Ut.addEventListener("click",Ot),Ut.addEventListener("mouseenter",S7),Ut.addEventListener("mouseleave",O7)});const oe=Ut=>{const Kt=Ut==null?void 0:Ut.target;(!Kt||Kt.name!==SM&&!M.includes(Kt))&&(I=[],Ht(),Nt.removeChildren())};return p.on("element-point:select",bt),p.on("element-point:unselect",oe),b.addEventListener("mousedown",oe),()=>{Nt.remove(),p.off("element-point:select",bt),p.off("element-point:unselect",oe),b.removeEventListener("mousedown",oe),M.forEach(Ut=>{Ut.removeEventListener("click",Ot),Ut.removeEventListener("mouseenter",S7),Ut.removeEventListener("mouseleave",O7)})}}}var V9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const T7=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{x:n=0,y:r=0,width:o,height:c,data:l}=t;return e.map(u=>{var{data:d,x:h,y:p,width:v,height:m}=u,b=V9(u,["data","x","y","width","height"]);return Object.assign(Object.assign({},b),{data:ed(d,l),x:h!=null?h:n,y:p!=null?p:r,width:v!=null?v:o,height:m!=null?m:c})})};T7.props={};var W9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const C7=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{direction:n="row",ratio:r=e.map(()=>1),padding:o=0,data:c}=t,[l,u,d,h]=n==="col"?["y","height","width","x"]:["x","width","height","y"],p=r.reduce((S,E)=>S+E),v=t[u]-o*(e.length-1),m=r.map(S=>v*(S/p)),b=[];let x=t[l]||0;for(let S=0;S<m.length;S+=1){const E=e[S],{data:w}=E,M=W9(E,["data"]),L=ed(w,c);b.push(Object.assign({[l]:x,[u]:m[S],[h]:t[h]||0,[d]:t[d],data:L},M)),x+=m[S]+o}return b};C7.props={};class Nv{constructor(e){this.$value=e}static of(e){return new Nv(e)}call(e,...n){return this.$value=e(this.$value,...n),this}value(){return this.$value}}var G9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Y9=Dc(t=>{const{encode:e,data:n,scale:r,shareSize:o=!1}=t,{x:c,y:l}=e,u=(d,h)=>{var p;if(d===void 0||!o)return{};const v=Gr(n,x=>x[d]),m=((p=r==null?void 0:r[h])===null||p===void 0?void 0:p.domain)||Array.from(v.keys()),b=m.map(x=>v.has(x)?v.get(x).length:1);return{domain:m,flex:b}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:c===void 0?null:{position:"top"}},c===void 0&&{paddingInner:0}),u(c,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:l===void 0?null:{position:"right"}},l===void 0&&{paddingInner:0}),u(l,"y"))}}}),EM=sa(t=>{const{data:e,scale:n,legend:r}=t,o=[t];let c,l,u;for(;o.length;){const m=o.shift(),{children:b,encode:x={},scale:S={},legend:E={}}=m,{color:w}=x,{color:M}=S,{color:L}=E;w!==void 0&&(c=w),M!==void 0&&(l=M),L!==void 0&&(u=L),Array.isArray(b)&&o.push(...b)}const d=()=>{var m;const b=(m=n==null?void 0:n.color)===null||m===void 0?void 0:m.domain;if(b!==void 0)return[b];if(c===void 0)return[void 0];const x=typeof c=="function"?c:E=>E[c],S=e.map(x);return S.some(E=>typeof E=="number")?[Ma(S)]:[Array.from(new Set(S)),"ordinal"]},h=typeof c=="string"?c:"",[p,v]=d();return Object.assign({encode:{color:{type:"column",value:p!=null?p:[]}},scale:{color:en({},l,{domain:p,type:v})}},r===void 0&&{legend:{color:en({title:h},u)}})}),wM=Dc(()=>({animate:{enterType:"fadeIn"}})),AM=sa(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),TM=sa(()=>({type:"cell"})),M7=sa(t=>{const{data:e}=t;return{data:{type:"inline",value:e,transform:[{type:"custom",callback:()=>{const{data:r,encode:o}=t,{x:c,y:l}=o,u=c?Array.from(new Set(r.map(p=>p[c]))):[],d=l?Array.from(new Set(r.map(p=>p[l]))):[];return(()=>{if(u.length&&d.length){const p=[];for(const v of u)for(const m of d)p.push({[c]:v,[l]:m});return p}if(u.length)return u.map(p=>({[c]:p}));if(d.length)return d.map(p=>({[l]:p}))})()}}]}}}),L7=sa((t,e=$9,n=X9,r=q9,o={})=>{const{data:c,encode:l,children:u,scale:d,x:h=0,y:p=0,shareData:v=!1,key:m}=t,{value:b}=c,{x,y:S}=l,{color:E}=d,{domain:w}=E;return{children:(L,I,R)=>{const{x:z,y:W}=I,{paddingLeft:Y,paddingTop:st,marginLeft:xt,marginTop:Nt}=R,{domain:Ht}=z.getOptions(),{domain:dt}=W.getOptions(),Ot=Cs(L),bt=L.map(e),wt=L.map(({x:Pe,y:Ie})=>[z.invert(Pe),W.invert(Ie)]),Ut=wt.map(([Pe,Ie])=>qe=>{const{[x]:sn,[S]:yn}=qe;return(x!==void 0?sn===Pe:!0)&&(S!==void 0?yn===Ie:!0)}).map(Pe=>b.filter(Pe)),Kt=v?Or(Ut,Pe=>Pe.length):void 0,me=wt.map(([Pe,Ie])=>({columnField:x,columnIndex:Ht.indexOf(Pe),columnValue:Pe,columnValuesLength:Ht.length,rowField:S,rowIndex:dt.indexOf(Ie),rowValue:Ie,rowValuesLength:dt.length})),Ee=me.map(Pe=>Array.isArray(u)?u:[u(Pe)].flat(1));return Ot.flatMap(Pe=>{const[Ie,qe,sn,yn]=bt[Pe],on=me[Pe],rn=Ut[Pe];return Ee[Pe].map(xn=>{var gn,Cn,{scale:kn,key:Bn,facet:$n=!0,axis:vr={},legend:Xn={}}=xn,nr=G9(xn,["scale","key","facet","axis","legend"]);const ni=((gn=kn==null?void 0:kn.y)===null||gn===void 0?void 0:gn.guide)||vr.y,Ji=((Cn=kn==null?void 0:kn.x)===null||Cn===void 0?void 0:Cn.guide)||vr.x,yo={x:{tickCount:x?5:void 0},y:{tickCount:S?5:void 0}},vi=$n?rn:rn.length===0?[]:b,Ao={color:{domain:w}},to={x:P7(Ji,n)(on,vi),y:P7(ni,r)(on,vi)};return Object.assign(Object.assign({key:`${Bn}-${Pe}`,data:vi,margin:0,x:Ie+Y+h+xt,y:qe+st+p+Nt,parentKey:m,width:sn,height:yn,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!vi.length,dataDomain:Kt,scale:en(yo,kn,Ao),axis:en({},vr,to),legend:!1},nr),o)})})}}});function $9(t){const{points:e}=t;return l0(e)}function _S(t,e){return e.length?en({title:!1,tick:null,label:null},t):en({title:!1,tick:null,label:null,grid:null},t)}function X9(t){return(e,n)=>{const{rowIndex:r,rowValuesLength:o,columnIndex:c,columnValuesLength:l}=e;if(r!==o-1)return _S(t,n);const u=c!==l-1?!1:void 0,d=n.length?void 0:null;return en({title:u,grid:d},t)}}function q9(t){return(e,n)=>{const{rowIndex:r,columnIndex:o}=e;if(o!==0)return _S(t,n);const c=r!==0?!1:void 0,l=n.length?void 0:null;return en({title:c,grid:l},t)}}function P7(t,e){return typeof t=="function"?t:t===null||t===!1?()=>null:e(t)}const I7=()=>t=>[Nv.of(t).call(TM).call(EM).call(wM).call(Y9).call(AM).call(M7).call(L7).value()];I7.props={};var CM=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const K9=Dc(t=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),Q9=sa(t=>{const{data:e,children:n,x:r=0,y:o=0,key:c}=t;return{children:(u,d,h)=>{const{x:p,y:v}=d,{paddingLeft:m,paddingTop:b,marginLeft:x,marginTop:S}=h,{domain:E}=p.getOptions(),{domain:w}=v.getOptions(),M=Cs(u),L=u.map(({points:W})=>l0(W)),I=u.map(({x:W,y:Y})=>[p.invert(W),v.invert(Y)]),R=I.map(([W,Y])=>({columnField:W,columnIndex:E.indexOf(W),columnValue:W,columnValuesLength:E.length,rowField:Y,rowIndex:w.indexOf(Y),rowValue:Y,rowValuesLength:w.length})),z=R.map(W=>Array.isArray(n)?n:[n(W)].flat(1));return M.flatMap(W=>{const[Y,st,xt,Nt]=L[W],[Ht,dt]=I[W],Ot=R[W];return z[W].map(wt=>{var oe,Ut;const{scale:Kt,key:me,encode:Ee,axis:Pe,interaction:Ie}=wt,qe=CM(wt,["scale","key","encode","axis","interaction"]),sn=(oe=Kt==null?void 0:Kt.y)===null||oe===void 0?void 0:oe.guide,yn=(Ut=Kt==null?void 0:Kt.x)===null||Ut===void 0?void 0:Ut.guide,on={x:{facet:!1},y:{facet:!1}},rn={x:tF(yn)(Ot,e),y:eF(sn)(Ot,e)},Rn={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:e,parentKey:c,key:`${me}-${W}`,x:Y+m+r+x,y:st+b+o+S,width:xt,height:Nt,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:en(on,Kt),axis:en(Rn,Pe,rn),legend:!1,encode:en({},Ee,{x:Ht,y:dt}),interaction:en({},Ie,{legendFilter:!1})},qe)})})}}}),J9=sa(t=>{const{encode:e}=t,n=CM(t,["encode"]),{position:r=[],x:o=r,y:c=[...r].reverse()}=e,l=CM(e,["position","x","y"]),u=[];for(const d of[o].flat(1))for(const h of[c].flat(1))u.push({$x:d,$y:h});return Object.assign(Object.assign({},n),{data:u,encode:Object.assign(Object.assign({},l),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[o].flat(1).length===1&&{x:{paddingInner:0}}),[c].flat(1).length===1&&{y:{paddingInner:0}})})});function tF(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{rowIndex:r,rowValuesLength:o}=e;if(r!==o-1)return _S(t,n)}}function eF(t){return typeof t=="function"?t:t===null?()=>null:(e,n)=>{const{columnIndex:r}=e;if(r!==0)return _S(t,n)}}const nF=()=>t=>[Nv.of(t).call(TM).call(EM).call(Q9).call(J9).call(wM).call(AM).call(K9).value()];var rF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const iF=Dc(t=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),oF=Dc(t=>({coordinate:{type:"polar"}})),aF=t=>{const{encode:e}=t,n=rF(t,["encode"]),{position:r}=e;return Object.assign(Object.assign({},n),{encode:{x:r}})};function R7(t){return e=>null}function sF(t){const{points:e}=t,[n,r,o,c]=e,l=ai(n,c),u=oi(n,c),d=oi(r,o),h=ab(u,d),p=1/Math.sin(h/2),v=l/(1+p),m=v*Math.sqrt(2),[b,x]=o,E=js(u)+h/2,w=v*p,M=b+w*Math.sin(E),L=x-w*Math.cos(E);return[M-m/2,L-m/2,m,m]}const cF=()=>t=>[Nv.of(t).call(TM).call(aF).call(EM).call(oF).call(M7).call(L7,sF,R7,R7,{frame:!1}).call(wM).call(AM).call(iF).value()];function lF(t,e,n){const o=n,c=[0,o],l=[-o+1,1];if(t==="normal")return c;if(t==="reverse")return l;if(t==="alternate")return e%2===0?c:l;if(t==="reverse-alternate")return e%2===0?l:c}function uF(t,e,n){const r=[t];for(;r.length;){const o=r.pop();o.animate=en({enter:{duration:e},update:{duration:e,easing:n,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:e}},o.animate||{});const{children:c}=o;Array.isArray(c)&&r.push(...c)}return t}const k7=()=>t=>{const{children:e=[],duration:n=1e3,iterationCount:r=1,direction:o="normal",easing:c="ease-in-out-sine"}=t,l=e.length;if(!Array.isArray(e)||l===0)return[];const{key:u}=e[0],d=e.map(h=>Object.assign(Object.assign({},h),{key:u})).map(h=>uF(h,n,c));return function*(){let h=0,p;for(;r==="infinite"||h<r;){const[v,m]=lF(o,h,l);for(let b=v;b<m;b+=1){const x=Math.abs(b);p!==x&&(yield d[x]),p=x}h++}}};k7.props={};function xl(t,e,n){const{encode:r}=n;if(t===null)return[e];const o=fF(t).map(l=>{var u;return[l,(u=pr(r,l))===null||u===void 0?void 0:u[0]]}).filter(([,l])=>Hr(l)),c=l=>o.map(([,u])=>u[l]).join("-");return Array.from(Gr(e,c).values())}function D7(t){return Array.isArray(t)?pF(t):typeof t=="function"?hF(t):t==="series"?dF:t==="value"?gF:t==="sum"?vF:t==="maxIndex"?mF:null}function F7(t,e){for(const n of t)n.sort(e)}function N7(t,e){return(e==null?void 0:e.domain)||Array.from(new Set(t))}function fF(t){return Array.isArray(t)?t:[t]}function dF(t,e,n){return Bv(r=>n[r])}function hF(t){return(e,n,r)=>Bv(o=>t(e[o]))}function pF(t){return(e,n,r)=>(o,c)=>t.reduce((l,u)=>l!==0?l:ci(e[o][u],e[c][u]),0)}function gF(t,e,n){return Bv(r=>e[r])}function vF(t,e,n){const r=Cs(t),o=Array.from(Gr(r,l=>n[+l]).entries()),c=new Map(o.map(([l,u])=>[l,u.reduce((d,h)=>d+ +e[h])]));return Bv(l=>c.get(n[l]))}function mF(t,e,n){const r=Cs(t),o=Array.from(Gr(r,l=>n[+l]).entries()),c=new Map(o.map(([l,u])=>[l,Fc(u,d=>e[d])]));return Bv(l=>c.get(n[l]))}function Bv(t){return(e,n)=>ci(t(e),t(n))}const B7=(t={})=>{const{groupBy:e="x",orderBy:n=null,reverse:r=!1,y:o="y",y1:c="y1",series:l=!0}=t;return(u,d)=>{var h;const{data:p,encode:v,style:m={}}=d,[b,x]=pr(v,"y"),[S,E]=pr(v,"y1"),[w]=l?Xu(v,"series","color"):pr(v,"color"),M=xl(e,u,d),I=((h=D7(n))!==null&&h!==void 0?h:()=>null)(p,b,w);I&&F7(M,I);const R=new Array(u.length),z=new Array(u.length),W=new Array(u.length),Y=[],st=[];for(const Ot of M){r&&Ot.reverse();const bt=S?+S[Ot[0]]:0,wt=[],oe=[];for(const qe of Ot){const sn=W[qe]=+b[qe]-bt;sn<0?oe.push(qe):sn>=0&&wt.push(qe)}const Ut=wt.length>0?wt:oe,Kt=oe.length>0?oe:wt;let me=wt.length-1,Ee=0;for(;me>0&&b[Ut[me]]===0;)me--;for(;Ee<Kt.length-1&&b[Kt[Ee]]===0;)Ee++;Y.push(Ut[me]),st.push(Kt[Ee]);let Pe=bt;for(const qe of oe.reverse()){const sn=W[qe];Pe=R[qe]=(z[qe]=Pe)+sn}let Ie=bt;for(const qe of wt){const sn=W[qe];sn>0?Ie=R[qe]=(z[qe]=Ie)+sn:R[qe]=z[qe]=Ie}}const xt=new Set(Y),Nt=new Set(st),Ht=o==="y"?R:z,dt=c==="y"?R:z;return[u,en({},d,{encode:{y0:il(b,x),y:Wr(Ht,x),y1:Wr(dt,E)},style:Object.assign({first:(Ot,bt)=>xt.has(bt),last:(Ot,bt)=>Nt.has(bt)},m)})]}};B7.props={};function j7(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(o=+o)>=o&&++n}return n}function yF(t,e){let n=0,r,o=0,c=0;if(e===void 0)for(let l of t)l!=null&&(l=+l)>=l&&(r=l-o,o+=r/++n,c+=r*(l-o));else{let l=-1;for(let u of t)(u=e(u,++l,t))!=null&&(u=+u)>=u&&(r=u-o,o+=r/++n,c+=r*(u-o))}if(n>1)return c/(n-1)}function z7(t,e){const n=yF(t,e);return n&&Math.sqrt(n)}function bF(t,e,n){const r=j7(t),o=z7(t);return r&&o?Math.ceil((n-e)*Math.cbrt(r)/(3.49*o)):1}var U7=Array.prototype,_F=U7.slice,kV=U7.map;function MM(t){return()=>t}const xF=Math.sqrt(50),SF=Math.sqrt(10),OF=Math.sqrt(2);function xS(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(r)),c=r/Math.pow(10,o),l=c>=xF?10:c>=SF?5:c>=OF?2:1;let u,d,h;return o<0?(h=Math.pow(10,-o)/l,u=Math.round(t*h),d=Math.round(e*h),u/h<t&&++u,d/h>e&&--d,h=-h):(h=Math.pow(10,o)*l,u=Math.round(t/h),d=Math.round(e/h),u*h<t&&++u,d*h>e&&--d),d<u&&.5<=n&&n<2?xS(t,e,n*2):[u,d,h]}function EF(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[o,c,l]=r?xS(e,t,n):xS(t,e,n);if(!(c>=o))return[];const u=c-o+1,d=new Array(u);if(r)if(l<0)for(let h=0;h<u;++h)d[h]=(c-h)/-l;else for(let h=0;h<u;++h)d[h]=(c-h)*l;else if(l<0)for(let h=0;h<u;++h)d[h]=(o+h)/-l;else for(let h=0;h<u;++h)d[h]=(o+h)*l;return d}function jv(t,e,n){return e=+e,t=+t,n=+n,xS(t,e,n)[2]}function DV(t,e,n){e=+e,t=+t,n=+n;const r=e<t,o=r?jv(e,t,n):jv(t,e,n);return(r?-1:1)*(o<0?1/-o:o)}function wF(t,e,n){let r;for(;;){const o=jv(t,e,n);if(o===r||o===0||!isFinite(o))return[t,e];o>0?(t=Math.floor(t/o)*o,e=Math.ceil(e/o)*o):o<0&&(t=Math.ceil(t*o)/o,e=Math.floor(e*o)/o),r=o}}function AF(t){return Math.max(1,Math.ceil(Math.log(j7(t))/Math.LN2)+1)}function TF(){var t=Al,e=Ma,n=AF;function r(o){Array.isArray(o)||(o=Array.from(o));var c,l=o.length,u,d,h=new Array(l);for(c=0;c<l;++c)h[c]=t(o[c],c,o);var p=e(h),v=p[0],m=p[1],b=n(h,v,m);if(!Array.isArray(b)){const L=m,I=+b;if(e===Ma&&([v,m]=wF(v,m,I)),b=EF(v,m,I),b[0]<=v&&(d=jv(v,m,I)),b[b.length-1]>=m)if(L>=m&&e===Ma){const R=jv(v,m,I);isFinite(R)&&(R>0?m=(Math.floor(m/R)+1)*R:R<0&&(m=(Math.ceil(m*-R)+1)/-R))}else b.pop()}for(var x=b.length,S=0,E=x;b[S]<=v;)++S;for(;b[E-1]>m;)--E;(S||E<x)&&(b=b.slice(S,E),x=E-S);var w=new Array(x+1),M;for(c=0;c<=x;++c)M=w[c]=[],M.x0=c>0?b[c-1]:v,M.x1=c<x?b[c]:m;if(isFinite(d)){if(d>0)for(c=0;c<l;++c)(u=h[c])!=null&&v<=u&&u<=m&&w[Math.min(x,Math.floor((u-v)/d))].push(o[c]);else if(d<0){for(c=0;c<l;++c)if((u=h[c])!=null&&v<=u&&u<=m){const L=Math.floor((v-u)*d);w[Math.min(x,L+(b[L]<=u))].push(o[c])}}}else for(c=0;c<l;++c)(u=h[c])!=null&&v<=u&&u<=m&&w[E0(b,u,0,x)].push(o[c]);return w}return r.value=function(o){return arguments.length?(t=typeof o=="function"?o:MM(o),r):t},r.domain=function(o){return arguments.length?(e=typeof o=="function"?o:MM([o[0],o[1]]),r):e},r.thresholds=function(o){return arguments.length?(n=typeof o=="function"?o:MM(Array.isArray(o)?_F.call(o):o),r):n},r}function LM(t,e,n=0,r=1/0,o){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(o=o===void 0?du:Sb(o);r>n;){if(r-n>600){const d=r-n+1,h=e-n+1,p=Math.log(d),v=.5*Math.exp(2*p/3),m=.5*Math.sqrt(p*v*(d-v)/d)*(h-d/2<0?-1:1),b=Math.max(n,Math.floor(e-h*v/d+m)),x=Math.min(r,Math.floor(e+(d-h)*v/d+m));LM(t,e,b,x,o)}const c=t[e];let l=n,u=r;for(zv(t,n,e),o(t[r],c)>0&&zv(t,n,r);l<u;){for(zv(t,l,u),++l,--u;o(t[l],c)<0;)++l;for(;o(t[u],c)>0;)--u}o(t[n],c)===0?zv(t,n,u):(++u,zv(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function zv(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function CF(t,e=ci){let n,r=!1;if(e.length===1){let o;for(const c of t){const l=e(c);(r?ci(l,o)>0:ci(l,l)===0)&&(n=c,o=l,r=!0)}}else for(const o of t)(r?e(o,n)>0:e(o,o)===0)&&(n=o,r=!0);return n}function SS(t,e,n){if(t=Float64Array.from(EA(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return So(t);if(e>=1)return Or(t);var r,o=(r-1)*e,c=Math.floor(o),l=Or(LM(t,c).subarray(0,c+1)),u=So(t.subarray(c+1));return l+(u-l)*(o-c)}}function FV(t,e,n=number){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,c=Math.floor(o),l=+n(t[c],c,t),u=+n(t[c+1],c+1,t);return l+(u-l)*(o-c)}}function MF(t,e,n=ld){if(!isNaN(e=+e)){if(r=Float64Array.from(t,(u,d)=>ld(n(t[d],d,t))),e<=0)return Dv(r);if(e>=1)return Fc(r);var r,o=Uint32Array.from(t,(u,d)=>d),c=r.length-1,l=Math.floor(c*e);return LM(o,l,0,c,(u,d)=>du(r[u],r[d])),l=CF(o.subarray(0,l+1),u=>r[u]),l>=0?l:-1}}function PM(t,e){return SS(t,.5,e)}function LF(t,e){return MF(t,.5,e)}var PF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Sl(t){return e=>e===null?t:`${t} of ${e}`}function IF(t){if(typeof t=="function")return[t,null];const n={mean:RF,max:DF,count:NF,first:jF,last:zF,sum:BF,min:FF,median:kF}[t];if(!n)throw new Error(`Unknown reducer: ${t}.`);return n()}function RF(){const t=(n,r)=>Fv(n,o=>+r[o]),e=Sl("mean");return[t,e]}function kF(){const t=(n,r)=>PM(n,o=>+r[o]),e=Sl("median");return[t,e]}function DF(){const t=(n,r)=>Or(n,o=>+r[o]),e=Sl("max");return[t,e]}function FF(){const t=(n,r)=>So(n,o=>+r[o]),e=Sl("min");return[t,e]}function NF(){const t=(n,r)=>n.length,e=Sl("count");return[t,e]}function BF(){const t=(n,r)=>Vo(n,o=>+r[o]),e=Sl("sum");return[t,e]}function jF(){const t=(n,r)=>r[n[0]],e=Sl("first");return[t,e]}function zF(){const t=(n,r)=>r[n[n.length-1]],e=Sl("last");return[t,e]}const IM=(t={})=>{const{groupBy:e}=t,n=PF(t,["groupBy"]);return(r,o)=>{const{data:c,encode:l}=o,u=e(r,o);if(!u)return[r,o];const d=(b,x)=>{if(b)return b;const{from:S}=x;if(!S)return b;const[,E]=pr(l,S);return E},h=Object.entries(n).map(([b,x])=>{const[S,E]=IF(x),[w,M]=pr(l,b),L=d(M,x),I=u.map(R=>S(R,w!=null?w:c));return[b,Object.assign(Object.assign({},JT(I,(E==null?void 0:E(L))||L)),{aggregate:!0})]}),p=Object.keys(l).map(b=>{const[x,S]=pr(l,b),E=u.map(w=>x[w[0]]);return[b,Wr(E,S)]}),v=u.map(b=>c[b[0]]);return[Cs(u),en({},o,{data:v,encode:Object.fromEntries([...p,...h])})]}};IM.props={};var UF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Z7="thresholds";function ZF(t){const[e,n]=Ma(t);return Math.min(200,bF(t,e,n))}const RM=(t={})=>{const{groupChannels:e=["color"],binChannels:n=["x","y"]}=t,r=UF(t,["groupChannels","binChannels"]),o={},c=(l,u)=>{const{encode:d}=u,h=n.map(x=>{const[S]=pr(d,x);return S}),p=bn(r,Z7),v=l.filter(x=>h.every(S=>Hr(S[x]))),m=[...e.map(x=>{const[S]=pr(d,x);return S}).filter(Hr).map(x=>S=>x[S]),...n.map((x,S)=>{const E=h[S],w=p[x]||ZF(E),M=TF().thresholds(w).value(I=>+E[I])(v),L=new Map(M.flatMap(I=>{const{x0:R,x1:z}=I,W=`${R},${z}`;return I.map(Y=>[Y,W])}));return o[x]=L,I=>L.get(I)})],b=x=>m.map(S=>S(x)).join("-");return Array.from(Gr(v,b).values())};return IM(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter(([l])=>!l.startsWith(Z7)))),Object.fromEntries(n.flatMap(l=>{const u=([h])=>+o[l].get(h).split(",")[0],d=([h])=>+o[l].get(h).split(",")[1];return d.from=l,[[l,u],[`${l}1`,d]]}))),{groupBy:c}))};RM.props={};const H7=(t={})=>{const{thresholds:e}=t;return RM(Object.assign(Object.assign({},t),{thresholdsX:e,groupChannels:["color"],binChannels:["x"]}))};H7.props={};var HF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const V7=(t={})=>{const{groupBy:e="x",reverse:n=!1,orderBy:r,padding:o}=t,c=HF(t,["groupBy","reverse","orderBy","padding"]);return(l,u)=>{const{data:d,encode:h,scale:p}=u,{series:v}=p,[m]=pr(h,"y"),[b]=Xu(h,"series","color"),x=N7(b,v),S=en({},u,{scale:{series:{domain:x,paddingInner:o}}}),E=xl(e,l,u),w=D7(r);if(!w)return[l,en(S,{encode:{series:Wr(b)}})];const M=w(d,m,b);M&&F7(E,M);const L=new Array(l.length);for(const I of E){n&&I.reverse();for(let R=0;R<I.length;R++)L[I[R]]=x[R]}return[l,en(S,{encode:{series:Wr(r?L:b)}})]}};V7.props={};function OS(t,e,n){if(t===null)return[-.5,.5];const r=N7(t,e),c=new vs({domain:r,range:[0,1],padding:n}).getBandWidth();return[-c/2,c/2]}function ES(t,e,n){return e*(1-t)+n*t}const W7=(t={})=>{const{padding:e=0,paddingX:n=e,paddingY:r=e,random:o=Math.random}=t;return(c,l)=>{const{encode:u,scale:d}=l,{x:h,y:p}=d,[v]=pr(u,"x"),[m]=pr(u,"y"),b=OS(v,h,n),x=OS(m,p,r),S=c.map(()=>ES(o(),...x)),E=c.map(()=>ES(o(),...b));return[c,en({scale:{x:{padding:.5},y:{padding:.5}}},l,{encode:{dy:Wr(S),dx:Wr(E)}})]}};W7.props={};const G7=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,o)=>{const{encode:c,scale:l}=o,{x:u}=l,[d]=pr(c,"x"),h=OS(d,u,e),p=r.map(()=>ES(n(),...h));return[r,en({scale:{x:{padding:.5}}},o,{encode:{dx:Wr(p)}})]}};G7.props={};const Y7=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(r,o)=>{const{encode:c,scale:l}=o,{y:u}=l,[d]=pr(c,"y"),h=OS(d,u,e),p=r.map(()=>ES(n(),...h));return[r,en({scale:{y:{padding:.5}}},o,{encode:{dy:Wr(p)}})]}};Y7.props={};var VF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const $7=(t={})=>{const{groupBy:e="x"}=t;return(n,r)=>{const{encode:o}=r,{x:c}=o,l=VF(o,["x"]),u=Object.entries(l).filter(([m])=>m.startsWith("y")).map(([m])=>[m,pr(o,m)[0]]),d=u.map(([m])=>[m,new Array(n.length)]),h=xl(e,n,r),p=new Array(h.length);for(let m=0;m<h.length;m++){const x=h[m].flatMap(w=>u.map(([,M])=>+M[w])),[S,E]=Ma(x);p[m]=(S+E)/2}const v=Math.max(...p);for(let m=0;m<h.length;m++){const b=v-p[m],x=h[m];for(const S of x)for(let E=0;E<u.length;E++){const[,w]=u[E],[,M]=d[E];M[S]=+w[S]+b}}return[n,en({},r,{encode:Object.fromEntries(d.map(([m,b])=>[m,Wr(b,pr(o,m)[1])]))})]}};$7.props={};const X7=(t={})=>{const{groupBy:e="x",series:n=!0}=t;return(r,o)=>{const{encode:c}=o,[l]=pr(c,"y"),[u,d]=pr(c,"y1"),[h]=n?Xu(c,"series","color"):pr(c,"color"),p=xl(e,r,o),v=new Array(r.length);for(const m of p){const b=m.map(x=>+l[x]);for(let x=0;x<m.length;x++){const S=m[x],E=Math.max(...b.filter((w,M)=>M!==x));v[S]=+l[S]>E?E:l[S]}}return[r,en({},o,{encode:{y1:Wr(v,d)}})]}};X7.props={};const q7=t=>{const{groupBy:e=["x"],reducer:n=(l,u)=>u[l[0]],orderBy:r=null,reverse:o=!1,duration:c}=t;return(l,u)=>{const{encode:d}=u,p=(Array.isArray(e)?e:[e]).map(E=>[E,pr(d,E)[0]]);if(p.length===0)return[l,u];let v=[l];for(const[,E]of p){const w=[];for(const M of v){const L=Array.from(Gr(M,I=>E[I]).values());w.push(...L)}v=w}if(r){const[E]=pr(d,r);E&&v.sort((w,M)=>n(w,E)-n(M,E)),o&&v.reverse()}const m=(c||3e3)/v.length,[b]=c?[za(l,m)]:Xu(d,"enterDuration",za(l,m)),[x]=Xu(d,"enterDelay",za(l,0)),S=new Array(l.length);for(let E=0,w=0;E<v.length;E++){const M=v[E],L=Or(M,I=>+b[I]);for(const I of M)S[I]=+x[I]+w;w+=L}return[l,en({},u,{encode:{enterDuration:$d(b),enterDelay:$d(S)}})]}};q7.props={};var WF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function GF(t){return typeof t=="function"?t:{min:(n,r)=>So(n,o=>r[+o]),max:(n,r)=>Or(n,o=>r[+o]),first:(n,r)=>r[n[0]],last:(n,r)=>r[n[n.length-1]],mean:(n,r)=>Fv(n,o=>r[+o]),median:(n,r)=>PM(n,o=>r[+o]),sum:(n,r)=>Vo(n,o=>r[+o]),deviation:(n,r)=>z7(n,o=>r[+o])}[t]||Or}const K7=(t={})=>{const{groupBy:e="x",basis:n="max"}=t;return(r,o)=>{const{encode:c,tooltip:l}=o,{x:u}=c,d=WF(c,["x"]),h=Object.entries(d).filter(([S])=>S.startsWith("y")).map(([S])=>[S,pr(c,S)[0]]),[,p]=h.find(([S])=>S==="y"),v=h.map(([S])=>[S,new Array(r.length)]),m=xl(e,r,o),b=GF(n);for(const S of m){const E=b(S,p);for(const w of S)for(let M=0;M<h.length;M++){const[,L]=h[M],[,I]=v[M];I[w]=+L[w]/E}}const x=Lo(l)||(l==null?void 0:l.items)&&(l==null?void 0:l.items.length)!==0;return[r,en({},o,Object.assign({encode:Object.fromEntries(v.map(([S,E])=>[S,Wr(E,pr(c,S)[1])]))},!x&&c.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};K7.props={};function Q7(t,e){return[t[0]]}function YF(t,e){const n=t.length-1;return[t[n]]}function $F(t,e){const n=Fc(t,r=>e[r]);return[t[n]]}function XF(t,e){const n=Dv(t,r=>e[r]);return[t[n]]}function qF(t){return typeof t=="function"?t:{first:Q7,last:YF,max:$F,min:XF}[t]||Q7}const wS=(t={})=>{const{groupBy:e="series",channel:n,selector:r}=t;return(o,c)=>{const{encode:l}=c,u=xl(e,o,c),[d]=pr(l,n),h=qF(r);return[u.flatMap(p=>h(p,d)),c]}};wS.props={};var KF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const J7=(t={})=>{const{selector:e}=t,n=KF(t,["selector"]);return wS(Object.assign({channel:"x",selector:e},n))};J7.props={};var QF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const t8=(t={})=>{const{selector:e}=t,n=QF(t,["selector"]);return wS(Object.assign({channel:"y",selector:e},n))};t8.props={};var JF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Uv=(t={})=>{const{channels:e=["x","y"]}=t,n=JF(t,["channels"]),r=(o,c)=>xl(e,o,c);return IM(Object.assign(Object.assign({},n),{groupBy:r}))};Uv.props={};const e8=(t={})=>Uv(Object.assign(Object.assign({},t),{channels:["x","color","series"]}));e8.props={};const n8=(t={})=>Uv(Object.assign(Object.assign({},t),{channels:["y","color","series"]}));n8.props={};const r8=(t={})=>Uv(Object.assign(Object.assign({},t),{channels:["color"]}));r8.props={};function tN(t,e,n){return(e.length!==2?Do(ep(t,e,n),([r,o],[c,l])=>ci(o,l)||ci(r,c)):Do(Gr(t,n),([r,o],[c,l])=>e(o,l)||ci(r,c))).map(([r])=>r)}var i8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function eN(t,e,n){const{by:r=t,reducer:o="max"}=e,[c]=pr(n,r);if(typeof o=="function")return l=>o(l,c);if(o==="max")return l=>Or(l,u=>+c[u]);if(o==="min")return l=>So(l,u=>+c[u]);if(o==="sum")return l=>Vo(l,u=>+c[u]);if(o==="median")return l=>PM(l,u=>+c[u]);if(o==="mean")return l=>Fv(l,u=>+c[u]);if(o==="first")return l=>c[l[0]];if(o==="last")return l=>c[l[l.length-1]];throw new Error(`Unknown reducer: ${o}`)}function nN(t,e,n){const{reverse:r,channel:o}=n,{encode:c}=e,[l]=pr(c,o),u=Do(t,d=>l[d]);return r&&u.reverse(),[u,e]}function rN(t,e,n){if(!Array.isArray(n))return t;const r=new Set(n);return t.filter(o=>r.has(e[o]))}function iN(t,e,n){var r;const{reverse:o,slice:c,channel:l}=n,u=i8(n,["reverse","slice","channel"]),{encode:d,scale:h={}}=e,p=(r=h[l])===null||r===void 0?void 0:r.domain,[v]=pr(d,l),m=eN(l,u,d),b=rN(t,v,p),x=tN(b,m,w=>v[w]);o&&x.reverse();const S=typeof c=="number"?[0,c]:c,E=c?x.slice(...S):x;return[t,en(e,{scale:{[l]:{domain:E}}})]}const AS=(t={})=>{const{reverse:e=!1,slice:n,channel:r,ordinal:o=!0}=t,c=i8(t,["reverse","slice","channel","ordinal"]);return(l,u)=>o?iN(l,u,Object.assign({reverse:e,slice:n,channel:r},c)):nN(l,u,Object.assign({reverse:e,slice:n,channel:r},c))};AS.props={};const o8=(t={})=>AS(Object.assign(Object.assign({},t),{channel:"x"}));o8.props={};const a8=(t={})=>AS(Object.assign(Object.assign({},t),{channel:"y"}));a8.props={};const s8=(t={})=>AS(Object.assign(Object.assign({},t),{channel:"color"}));s8.props={};function oN(t,e){return typeof e=="string"?t.map(n=>n[e]):t.map(e)}function aN(t,e){if(typeof t=="function")return n=>t(n,e);if(t==="sum")return n=>Vo(n,r=>+e[r]);throw new Error(`Unknown reducer: ${t}`)}const c8=(t={})=>{const{field:e,channel:n="y",reducer:r="sum"}=t;return(o,c)=>{const{data:l,encode:u}=c,[d]=pr(u,"x"),h=e?oN(l,e):pr(u,n)[0],p=aN(r,h),v=bf(o,p,m=>d[m]).map(m=>m[1]);return[o,en({},c,{scale:{x:{flex:v}}})]}};c8.props={};function sN(t){const{padding:e=0,direction:n="col"}=t;return(r,o,c)=>{const l=r.length;if(l===0)return[];const{innerWidth:u,innerHeight:d}=c,h=d/u;let p=Math.ceil(Math.sqrt(o/h)),v=u/p,m=Math.ceil(o/p),b=m*v;for(;b>d;)p=p+1,v=u/p,m=Math.ceil(o/p),b=m*v;const x=d-m*v,S=m<=1?0:x/(m-1),[E,w]=m<=1?[(u-l*v)/(l-1),(d-v)/2]:[0,0];return r.map((M,L)=>{const[I,R,z,W]=l0(M),Y=n==="col"?L%p:Math.floor(L/m),st=n==="col"?Math.floor(L/p):L%m,xt=Y*v,Nt=(m-st-1)*v+x,Ht=(v-e)/z,dt=(v-e)/W,Ot=xt-I+E*Y+1/2*e,bt=Nt-R-S*st-w+1/2*e;return`translate(${Ot}, ${bt}) scale(${Ht}, ${dt})`})}}const l8=t=>(e,n)=>[e,en({},n,{modifier:sN(t),axis:!1})];l8.props={};function cN(t,e,n,r){const o=t.length;if(r>=o||r===0)return t;const c=b=>e[t[b]]*1,l=b=>n[t[b]]*1,u=[],d=(o-2)/(r-2);let h=0,p,v,m;u.push(h);for(let b=0;b<r-2;b++){let x=0,S=0,E=Math.floor((b+1)*d)+1,w=Math.floor((b+2)*d)+1;w=Math.min(w,o);const M=w-E;for(;E<w;E++)x+=c(E),S+=l(E);x/=M,S/=M;let L=Math.floor((b+0)*d)+1;const I=Math.floor((b+1)*d)+1,R=[c(h),l(h)];for(p=v=-1;L<I;L++)v=Math.abs((R[0]-x)*(c(L)-R[1])-(R[0]-l(L))*(S-R[0]))*.5,v>p&&(p=v,m=L);u.push(m),h=m}return u.push(o-1),u.map(b=>t[b])}function lN(t){if(typeof t=="function")return t;if(t==="lttb")return cN;const e={first:r=>[r[0]],last:r=>[r[r.length-1]],min:(r,o,c)=>[r[Dv(r,l=>c[l])]],max:(r,o,c)=>[r[Fc(r,l=>c[l])]],median:(r,o,c)=>[r[LF(r,l=>c[l])]]},n=e[t]||e.median;return(r,o,c,l)=>{const u=Math.max(1,Math.floor(r.length/l));return uN(r,u).flatMap(h=>n(h,o,c))}}function uN(t,e){const n=t.length,r=[];let o=0;for(;o<n;)r.push(t.slice(o,o+=e));return r}const u8=(t={})=>{const{strategy:e="median",thresholds:n=2e3,groupBy:r=["series","color"]}=t,o=lN(e);return(c,l)=>{const{encode:u}=l,d=xl(r,c,l),[h]=pr(u,"x"),[p]=pr(u,"y");return[d.flatMap(v=>o(v,h,p,n)),l]}};u8.props={};function fN(t){return typeof t=="object"?[t.value,t.ordinal]:[t,!0]}function dN(t){var e;const{encode:n}=t,r=Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),{y:Object.assign(Object.assign({},t.encode.y),{value:[]})})}),o=(e=n==null?void 0:n.color)===null||e===void 0?void 0:e.field;if(!n||!o)return r;let c;for(const[l,u]of Object.entries(n))(l==="x"||l==="y")&&u.field===o&&(c=Object.assign(Object.assign({},c),{[l]:Object.assign(Object.assign({},u),{value:[]})}));return c?Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),c)}):r}const f8=(t={})=>(e,n)=>{const{encode:r,data:o}=n,c=Object.entries(t).map(([p,v])=>{const[m]=pr(r,p);if(!m)return null;const[b,x=!0]=fN(v);if(typeof b=="function")return S=>b(m[S]);if(x){const S=Array.isArray(b)?b:[b];return S.length===0?null:E=>S.includes(m[E])}else{const[S,E]=b;return w=>m[w]>=S&&m[w]<=E}}).filter(Hr),l=p=>c.every(v=>v(p)),u=e.filter(l),d=u.map((p,v)=>v);if(c.length===0){const p=dN(n);return[e,p]}const h=Object.entries(r).map(([p,v])=>[p,Object.assign(Object.assign({},v),{value:d.map(m=>v.value[u[m]]).filter(m=>m!==void 0)})]);return[d,en({},n,{encode:Object.fromEntries(h),data:u.map(p=>o[p])})]};f8.props={};var d8={},kM={},DM=34,Zv=10,FM=13;function h8(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function hN(t,e){var n=h8(t);return function(r,o){return e(n(r),o,t)}}function p8(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var o in r)o in e||n.push(e[o]=o)}),n}function zo(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function pN(t){return t<0?"-"+zo(-t,6):t>9999?"+"+zo(t,6):zo(t,4)}function gN(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":pN(t.getUTCFullYear(),4)+"-"+zo(t.getUTCMonth()+1,2)+"-"+zo(t.getUTCDate(),2)+(o?"T"+zo(e,2)+":"+zo(n,2)+":"+zo(r,2)+"."+zo(o,3)+"Z":r?"T"+zo(e,2)+":"+zo(n,2)+":"+zo(r,2)+"Z":n||e?"T"+zo(e,2)+":"+zo(n,2)+"Z":"")}function vN(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(v,m){var b,x,S=o(v,function(E,w){if(b)return b(E,w-1);x=E,b=m?hN(E,m):h8(E)});return S.columns=x||[],S}function o(v,m){var b=[],x=v.length,S=0,E=0,w,M=x<=0,L=!1;v.charCodeAt(x-1)===Zv&&--x,v.charCodeAt(x-1)===FM&&--x;function I(){if(M)return kM;if(L)return L=!1,d8;var z,W=S,Y;if(v.charCodeAt(W)===DM){for(;S++<x&&v.charCodeAt(S)!==DM||v.charCodeAt(++S)===DM;);return(z=S)>=x?M=!0:(Y=v.charCodeAt(S++))===Zv?L=!0:Y===FM&&(L=!0,v.charCodeAt(S)===Zv&&++S),v.slice(W+1,z-1).replace(/""/g,'"')}for(;S<x;){if((Y=v.charCodeAt(z=S++))===Zv)L=!0;else if(Y===FM)L=!0,v.charCodeAt(S)===Zv&&++S;else if(Y!==n)continue;return v.slice(W,z)}return M=!0,v.slice(W,x)}for(;(w=I())!==kM;){for(var R=[];w!==d8&&w!==kM;)R.push(w),w=I();m&&(R=m(R,E++))==null||b.push(R)}return b}function c(v,m){return v.map(function(b){return m.map(function(x){return p(b[x])}).join(t)})}function l(v,m){return m==null&&(m=p8(v)),[m.map(p).join(t)].concat(c(v,m)).join(`
`)}function u(v,m){return m==null&&(m=p8(v)),c(v,m).join(`
`)}function d(v){return v.map(h).join(`
`)}function h(v){return v.map(p).join(t)}function p(v){return v==null?"":v instanceof Date?gN(v):e.test(v+="")?'"'+v.replace(/"/g,'""')+'"':v}return{parse:r,parseRows:o,format:l,formatBody:u,formatRows:d,formatRow:h,formatValue:p}}function mN(t){for(var e in t){var n=t[e].trim(),r,o;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(o=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))yN&&o[4]&&!o[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;t[e]=n}return t}const yN=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var bN=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};const g8=t=>{const{value:e,format:n=e.split(".").pop(),delimiter:r=",",autoType:o=!0}=t;return()=>bN(void 0,void 0,void 0,function*(){const c=yield fetch(e);if(n==="csv"){const l=yield c.text();return vN(r).parse(l,o?mN:Es)}else if(n==="json")return yield c.json();throw new Error(`Unknown format: ${n}.`)})};g8.props={};const v8=t=>{const{value:e}=t;return()=>e};v8.props={};function _N(t,e){return t.map(n=>{if(Array.isArray(n)){const[r,o=e]=n;return[r,o]}return[n,e]})}const m8=t=>{const{fields:e=[]}=t,n=_N(e,!0);return r=>{const o=(c,l)=>n.reduce((u,[d,h=!0])=>u!==0?u:h?c[d]<l[d]?-1:+(c[d]!==l[d]):c[d]>l[d]?-1:+(c[d]!==l[d]),0);return[...r].sort(o)}};m8.props={};function NV(t){return t!=null&&!Number.isNaN(t)}const y8=t=>{const{callback:e}=t;return n=>Array.isArray(n)?[...n].sort(e):n};y8.props={};function xN(t){return t!=null&&!Number.isNaN(t)}const b8=t=>{const{callback:e=xN}=t;return n=>n.filter(e)};b8.props={};function SN(t,e=[]){return e.reduce((n,r)=>(r in t&&(n[r]=t[r]),n),{})}const _8=t=>{const{fields:e}=t;return n=>n.map(r=>SN(r,e))};_8.props={};function ON(t){return Object.keys(t).length===0}const x8=t=>e=>{if(!t||ON(t))return e;const n=r=>Object.entries(r).reduce((o,[c,l])=>(o[t[c]||c]=l,o),{});return e.map(n)};x8.props={};function EN(t){return!t||Object.keys(t).length===0}const S8=t=>{const{fields:e,key:n="key",value:r="value"}=t;return o=>EN(e)?o:o.flatMap(c=>e.map(l=>Object.assign(Object.assign({},c),{[n]:l,[r]:c[l]})))};S8.props={};const O8=t=>{const{start:e,end:n}=t;return r=>r.slice(e,n)};O8.props={};const E8=t=>{const{callback:e=Es}=t;return n=>e(n)};E8.props={};const w8=t=>{const{callback:e=Es}=t;return n=>Array.isArray(n)?n.map(e):n};w8.props={};function A8(t){return typeof t=="string"?e=>e[t]:t}const T8=t=>{const{join:e,on:n,select:r=[],as:o=r,unknown:c=NaN}=t,[l,u]=n,d=A8(u),h=A8(l),p=ep(e,([v])=>v,v=>d(v));return v=>v.map(m=>{const b=p.get(h(m));return Object.assign(Object.assign({},m),r.reduce((x,S,E)=>(x[o[E]]=b?b[S]:c,x),{}))})};T8.props={};var wN=k(53843),AN=k.n(wN);function BV(t){return t!=null&&!Number.isNaN(t)}const C8=t=>{const{field:e,groupBy:n,as:r=["y","size"],min:o,max:c,size:l=10,width:u}=t,[d,h]=r;return p=>Array.from(Gr(p,m=>n.map(b=>m[b]).join("-")).values()).map(m=>{const b=AN().create(m.map(E=>E[e]),{min:o,max:c,size:l,width:u}),x=b.map(E=>E.x),S=b.map(E=>E.y);return Object.assign(Object.assign({},m[0]),{[d]:x,[h]:S})})};C8.props={};const M8=()=>t=>(console.log("G2 data section:",t),t);M8.props={};var TN=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})};function CN(t,e){return{set(n,r,o){if(e[n]===void 0)return this;const c=r?r.call(null,e[n]):e[n];return o?o.call(null,c):typeof t[n]=="function"?t[n](c):t[n]=c,this},setAsync(n,r,o){return TN(this,void 0,void 0,function*(){if(e[n]===void 0)return this;const c=r?yield r.call(null,e[n]):e[n];return o?o.call(null,c):typeof t[n]=="function"?t[n](c):t[n]=c,this})}}}const NM=Math.PI/180,Hv=64,TS=2048;function MN(t){return t.text}function LN(){return"serif"}function L8(){return"normal"}function PN(t){return t.value}function IN(){return~~(Math.random()*2)*90}function RN(){return 1}function kN(){}function DN(t,e,n,r){if(e.sprite)return;const o=t.context,c=t.ratio;o.clearRect(0,0,(Hv<<5)/c,TS/c);let l=0,u=0,d=0;const h=n.length;for(--r;++r<h;){e=n[r],o.save(),o.font=e.style+" "+e.weight+" "+~~((e.size+1)/c)+"px "+e.font;let m=o.measureText(e.text+"m").width*c,b=e.size<<1;if(e.rotate){const x=Math.sin(e.rotate*NM),S=Math.cos(e.rotate*NM),E=m*S,w=m*x,M=b*S,L=b*x;m=Math.max(Math.abs(E+L),Math.abs(E-L))+31>>5<<5,b=~~Math.max(Math.abs(w+M),Math.abs(w-M))}else m=m+31>>5<<5;if(b>d&&(d=b),l+m>=Hv<<5&&(l=0,u+=d,d=0),u+b>=TS)break;o.translate((l+(m>>1))/c,(u+(b>>1))/c),e.rotate&&o.rotate(e.rotate*NM),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=m,e.height=b,e.xoff=l,e.yoff=u,e.x1=m>>1,e.y1=b>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,l+=m}const p=o.getImageData(0,0,(Hv<<5)/c,TS/c).data,v=[];for(;--r>=0;){if(e=n[r],!e.hasText)continue;const m=e.width,b=m>>5;let x=e.y1-e.y0;for(let w=0;w<x*b;w++)v[w]=0;if(l=e.xoff,l==null)return;u=e.yoff;let S=0,E=-1;for(let w=0;w<x;w++){for(let M=0;M<m;M++){const L=b*w+(M>>5),I=p[(u+w)*(Hv<<5)+(l+M)<<2]?1<<31-M%32:0;v[L]|=I,S|=I}S?E=w:(e.y0++,x--,w--,u++)}e.y1=e.y0+E,e.sprite=v.slice(0,(e.y1-e.y0)*b)}}function FN(t,e,n){n>>=5;const r=t.sprite,o=t.width>>5,c=t.x-(o<<4),l=c&127,u=32-l,d=t.y1-t.y0;let h=(t.y+t.y0)*n+(c>>5),p;for(let v=0;v<d;v++){p=0;for(let m=0;m<=o;m++)if((p<<u|(m<o?(p=r[v*o+m])>>>l:0))&e[h+m])return!0;h+=n}return!1}function NN(t,e){const n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function BN(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function P8(t){const e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function jN(t){const n=4*t[0]/t[1];let r=0,o=0;return function(c){const l=c<0?-1:1;switch(Math.sqrt(1+4*l*c)-l&3){case 0:r+=n;break;case 1:o+=4;break;case 2:r-=n;break;default:o-=4;break}return[r,o]}}function I8(t){const e=[];let n=-1;for(;++n<t;)e[n]=0;return e}function zN(){return document.createElement("canvas")}function pc(t){return typeof t=="function"?t:function(){return t}}const UN={archimedean:P8,rectangular:jN};function ZN(){let t=[256,256],e=MN,n=LN,r=PN,o=L8,c=IN,l=RN,u=P8,d=Math.random,h=kN,p=[],v=null,m=1/0,b=zN;const x=L8,S={};S.start=function(){const[M,L]=t,I=E(b()),R=S.board?S.board:I8((t[0]>>5)*t[1]),z=p.length,W=[],Y=p.map(function(Ht,dt,Ot){return Ht.text=e.call(this,Ht,dt,Ot),Ht.font=n.call(this,Ht,dt,Ot),Ht.style=x.call(this,Ht,dt,Ot),Ht.weight=o.call(this,Ht,dt,Ot),Ht.rotate=c.call(this,Ht,dt,Ot),Ht.size=~~r.call(this,Ht,dt,Ot),Ht.padding=l.call(this,Ht,dt,Ot),Ht}).sort(function(Ht,dt){return dt.size-Ht.size});let st=-1,xt=S.board?[{x:0,y:0},{x:M,y:L}]:void 0;v&&clearInterval(v),v=setInterval(Nt,0),Nt();function Nt(){const Ht=Date.now();for(;Date.now()-Ht<m&&++st<z;){const dt=Y[st];dt.x=M*(d()+.5)>>1,dt.y=L*(d()+.5)>>1,DN(I,dt,Y,st),dt.hasText&&w(R,dt,xt)&&(h.call(null,"word",{cloud:S,word:dt}),W.push(dt),xt?S.hasImage||NN(xt,dt):xt=[{x:dt.x+dt.x0,y:dt.y+dt.y0},{x:dt.x+dt.x1,y:dt.y+dt.y1}],dt.x-=t[0]>>1,dt.y-=t[1]>>1)}S._tags=W,S._bounds=xt,st>=z&&(S.stop(),h.call(null,"end",{cloud:S,words:W,bounds:xt}))}return S},S.stop=function(){return v&&(clearInterval(v),v=null),S};function E(M){M.width=M.height=1;const L=Math.sqrt(M.getContext("2d").getImageData(0,0,1,1).data.length>>2);M.width=(Hv<<5)/L,M.height=TS/L;const I=M.getContext("2d");return I.fillStyle=I.strokeStyle="red",I.textAlign="center",I.textBaseline="middle",{context:I,ratio:L}}function w(M,L,I){const R=L.x,z=L.y,W=Math.sqrt(t[0]*t[0]+t[1]*t[1]),Y=u(t),st=d()<.5?1:-1;let xt,Nt=-st,Ht,dt;for(;(xt=Y(Nt+=st))&&(Ht=~~xt[0],dt=~~xt[1],!(Math.min(Math.abs(Ht),Math.abs(dt))>=W));)if(L.x=R+Ht,L.y=z+dt,!(L.x+L.x0<0||L.y+L.y0<0||L.x+L.x1>t[0]||L.y+L.y1>t[1])&&(!I||!FN(L,M,t[0]))&&(!I||BN(L,I))){const Ot=L.sprite,bt=L.width>>5,wt=t[0]>>5,oe=L.x-(bt<<4),Ut=oe&127,Kt=32-Ut,me=L.y1-L.y0;let Ee,Pe=(L.y+L.y0)*wt+(oe>>5);for(let Ie=0;Ie<me;Ie++){Ee=0;for(let qe=0;qe<=bt;qe++)M[Pe+qe]|=Ee<<Kt|(qe<bt?(Ee=Ot[Ie*bt+qe])>>>Ut:0);Pe+=wt}return delete L.sprite,!0}return!1}return S.createMask=M=>{const L=document.createElement("canvas"),[I,R]=t;if(!I||!R)return;const z=I>>5,W=I8((I>>5)*R);L.width=I,L.height=R;const Y=L.getContext("2d");Y.drawImage(M,0,0,M.width,M.height,0,0,I,R);const st=Y.getImageData(0,0,I,R).data;for(let xt=0;xt<R;xt++)for(let Nt=0;Nt<I;Nt++){const Ht=z*xt+(Nt>>5),dt=xt*I+Nt<<2,bt=st[dt]>=250&&st[dt+1]>=250&&st[dt+2]>=250?1<<31-Nt%32:0;W[Ht]|=bt}S.board=W,S.hasImage=!0},S.timeInterval=function(M){m=M==null?1/0:M},S.words=function(M){p=M},S.size=function(M=[]){t=[+M[0],+M[1]]},S.text=function(M){e=pc(M)},S.font=function(M){n=pc(M)},S.fontWeight=function(M){o=pc(M)},S.rotate=function(M){c=pc(M)},S.canvas=function(M){b=pc(M)},S.spiral=function(M){u=UN[M]||M},S.fontSize=function(M){r=pc(M)},S.padding=function(M){l=pc(M)},S.random=function(M){d=pc(M)},S.on=function(M){h=pc(M)},S}var HN=function(t,e,n,r){function o(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(p){try{h(r.next(p))}catch(v){l(v)}}function d(p){try{h(r.throw(p))}catch(v){l(v)}}function h(p){p.done?c(p.value):o(p.value).then(u,d)}h((r=r.apply(t,e||[])).next())})},VN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const WN={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function GN(t){return new Promise((e,n)=>{if(t instanceof HTMLImageElement){e(t);return}if(typeof t=="string"){const r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=()=>e(r),r.onerror=()=>{console.error(`'image ${t} load failed !!!'`),n()};return}n()})}function YN(t,e){if(typeof t=="function")return t;if(Array.isArray(t)){const[n,r]=t;if(!e)return()=>(r+n)/2;const[o,c]=e;return c===o?()=>(r+n)/2:({value:l})=>(r-n)/(c-o)*(l-o)+n}return()=>t}const R8=(t,e)=>n=>HN(void 0,void 0,void 0,function*(){const r=Object.assign({},WN,t,{canvas:e.createCanvas}),o=ZN();yield CN(o,r).set("fontSize",M=>{const L=n.map(I=>I.value);return YN(M,[So(L),Or(L)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",GN,o.createMask),o.words([...n]);const c=o.start(),[l,u]=r.size,d=[{x:0,y:0},{x:l,y:u}],{_bounds:h=d,_tags:p,hasImage:v}=c,m=p.map(M=>{var{x:L,y:I,font:R}=M,z=VN(M,["x","y","font"]);return Object.assign(Object.assign({},z),{x:L+l/2,y:I+u/2,fontFamily:R})}),[{x:b,y:x},{x:S,y:E}]=h,w={text:"",value:0,opacity:0,fontSize:0};return m.push(Object.assign(Object.assign({},w),{x:v?0:b,y:v?0:x}),Object.assign(Object.assign({},w),{x:v?l:S,y:v?u:E})),m});R8.props={};function BM(t){const{min:e,max:n}=t;return[[e[0],e[1]],[n[0],n[1]]]}function k8(t,e){const[n,r]=t,[o,c]=e;return n>=o[0]&&n<=c[0]&&r>=o[1]&&r<=c[1]}function $N(t,e){const[n,r]=t;return!(k8(n,e)&&k8(r,e))}function XN(t,e){const[n,r]=t,[o,c]=e;return n[0]<c[0]&&r[0]>o[0]&&n[1]<c[1]&&r[1]>o[1]}const qN=t=>{const{priority:e}=t;return n=>{const r=[];return e&&n.sort(e),n.forEach(o=>{T0(o);const c=o.getLocalBounds();r.some(u=>XN(BM(c),BM(u.getLocalBounds())))?kb(o):r.push(o)}),n}};function KN([t,e],[n,r]){return r>t&&e>n}function CS(){const t=new Map;return[r=>t.get(r),(r,o)=>t.set(r,o)]}function QN(t){const e=t.cloneNode(!0),n=e.getElementById("connector");n&&e.removeChild(n);const{min:r,max:o}=e.getRenderBounds();return e.destroy(),{min:r,max:o}}const JN=t=>{const{maxIterations:e=10,maxError:n=.1,padding:r=1}=t;return o=>{const c=o.length;if(c<=1)return o;const[l,u]=CS(),[d,h]=CS(),[p,v]=CS(),[m,b]=CS();for(const x of o){const{min:S,max:E}=QN(x),[w,M]=S,[L,I]=E;u(x,M),h(x,M),v(x,I-M),b(x,[w,L])}for(let x=0;x<e;x++){o.sort((E,w)=>ci(d(E),d(w)));let S=0;for(let E=0;E<c-1;E++){const w=o[E];let M=E+1,L;for(;(L=o[M])&&!KN(m(w),m(L));)M+=1;if(L){const I=d(w),R=p(w),z=d(L),W=z-(I+R);if(W<r){const Y=(r-W)/2;S=Math.max(S,Y),h(w,I-Y),h(L,z+Y)}}}if(S<n)break}for(const x of o)x.style.y+=d(x)-l(x);return o}},tB=()=>t=>(t.forEach(e=>{T0(e);const n=e.attr("bounds"),r=e.getLocalBounds();$N(BM(r),n)&&kb(e)}),t);function eB(t){return typeof t=="object"?t:(0,F.lu)(t)}function jM(t){let e=t/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),e}function D8(t,e,n){return .2126*jM(t)+.7152*jM(e)+.0722*jM(n)}function F8(t,e){const{r:n,g:r,b:o}=t,{r:c,g:l,b:u}=e,d=D8(n,r,o),h=D8(c,l,u);return(Math.max(d,h)+.05)/(Math.min(d,h)+.05)}function nB(t,e){const n=Fc(e,r=>F8(t,eB(r)));return e[n]}const rB=t=>{const{threshold:e=4.5,palette:n=["#000","#fff"]}=t;return r=>(r.forEach(o=>{const c=o.attr("dependentElement").parsedStyle.fill,l=o.parsedStyle.fill;F8(l,c)<e&&o.attr("fill",nB(c,n))}),r)},iB=(t,e)=>{const[[n,r],[o,c]]=e,[[l,u],[d,h]]=t;let p=0,v=0;return l<n?p=n-l:d>o&&(p=o-d),u<r?v=r-u:h>c&&(v=c-h),[p,v]},oB=()=>(t,{canvas:e})=>{const{width:n,height:r}=e.getConfig();return t.forEach(o=>{T0(o);const{max:c,min:l}=o.getRenderBounds(),[u,d]=c,[h,p]=l,v=iB([[h,p],[u,d]],[[0,0],[n,r]]);o.style.connector&&o.style.connectorPoints&&(o.style.connectorPoints[0][0]-=v[0],o.style.connectorPoints[0][1]-=v[1]),o.style.x+=v[0],o.style.y+=v[1]}),t};function aB(){return{"data.fetch":g8,"data.inline":v8,"data.sortBy":m8,"data.sort":y8,"data.filter":b8,"data.pick":_8,"data.rename":x8,"data.fold":S8,"data.slice":O8,"data.custom":E8,"data.map":w8,"data.join":T8,"data.kde":C8,"data.log":M8,"data.wordCloud":R8,"transform.stackY":B7,"transform.binX":H7,"transform.bin":RM,"transform.dodgeX":V7,"transform.jitter":W7,"transform.jitterX":G7,"transform.jitterY":Y7,"transform.symmetryY":$7,"transform.diffY":X7,"transform.stackEnter":q7,"transform.normalizeY":K7,"transform.select":wS,"transform.selectX":J7,"transform.selectY":t8,"transform.groupX":e8,"transform.groupY":n8,"transform.groupColor":r8,"transform.group":Uv,"transform.sortX":o8,"transform.sortY":a8,"transform.sortColor":s8,"transform.flexX":c8,"transform.pack":l8,"transform.sample":u8,"transform.filter":f8,"coordinate.cartesian":qT,"coordinate.polar":Ll,"coordinate.transpose":zg,"coordinate.theta":Ug,"coordinate.parallel":Zg,"coordinate.fisheye":H2,"coordinate.radial":dp,"coordinate.radar":V2,"encode.constant":W2,"encode.field":G2,"encode.transform":Y2,"encode.column":QT,"mark.interval":Q2,"mark.rect":tx,"mark.line":Sx,"mark.point":Qu,"mark.text":Gx,"mark.cell":fv,"mark.area":t3,"mark.link":vv,"mark.image":l3,"mark.polygon":mv,"mark.box":br,"mark.vector":bv,"mark.lineX":O3,"mark.lineY":A3,"mark.connector":R3,"mark.range":Ov,"mark.rangeX":F3,"mark.rangeY":B3,"mark.path":U3,"mark.shape":W3,"mark.density":Y3,"mark.heatmap":of,"mark.wordCloud":vh,"palette.category10":va,"palette.category20":Av,"scale.linear":mh,"scale.ordinal":yh,"scale.band":bh,"scale.identity":nS,"scale.point":Mv,"scale.time":vo,"scale.log":G6,"scale.pow":Y6,"scale.sqrt":$6,"scale.threshold":X6,"scale.quantile":q6,"scale.quantize":K6,"scale.sequential":Q6,"scale.constant":J6,"theme.classic":tP,"theme.classicDark":nP,"theme.academy":rP,"theme.light":QC,"theme.dark":eP,"component.axisX":iP,"component.axisY":oP,"component.legendCategory":tM,"component.legendContinuous":is,"component.legends":sP,"component.title":lP,"component.sliderX":gP,"component.sliderY":vP,"component.scrollbarX":mP,"component.scrollbarY":yP,"animation.scaleInX":iM,"animation.scaleOutX":Kk,"animation.scaleInY":bP,"animation.scaleOutY":Qk,"animation.waveIn":_P,"animation.fadeIn":xP,"animation.fadeOut":SP,"animation.zoomIn":Jk,"animation.zoomOut":tD,"animation.pathIn":OP,"animation.morphing":CP,"animation.growInX":MP,"animation.growInY":LP,"interaction.elementHighlight":hS,"interaction.elementHighlightByX":PP,"interaction.elementHighlightByColor":IP,"interaction.elementSelect":pS,"interaction.elementSelectByX":RP,"interaction.elementSelectByColor":kP,"interaction.fisheye":vD,"interaction.chartIndex":DP,"interaction.tooltip":qP,"interaction.legendFilter":HD,"interaction.legendHighlight":VD,"interaction.brushHighlight":hM,"interaction.brushXHighlight":qD,"interaction.brushYHighlight":KD,"interaction.brushAxisHighlight":a9,"interaction.brushFilter":mM,"interaction.brushXFilter":u9,"interaction.brushYFilter":f9,"interaction.sliderFilter":l7,"interaction.scrollbarFilter":v9,"interaction.poptip":d7,"interaction.treemapDrillDown":N9,"interaction.elementPointMove":H9,"composition.spaceLayer":T7,"composition.spaceFlex":C7,"composition.facetRect":I7,"composition.repeatMatrix":nF,"composition.facetCircle":cF,"composition.timingKeyframe":k7,"labelTransform.overlapHide":qN,"labelTransform.overlapDodgeY":JN,"labelTransform.overflowHide":tB,"labelTransform.contrastReverse":rB,"labelTransform.exceedAdjust":oB}}var Vv=t=>t;function MS(t,e){t&&B8.hasOwnProperty(t.type)&&B8[t.type](t,e)}var N8={Feature:function(t,e){MS(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)MS(n[r].geometry,e)}},B8={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){zM(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)zM(n[r],e,0)},Polygon:function(t,e){j8(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)j8(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)MS(n[r],e)}};function zM(t,e,n){var r=-1,o=t.length-n,c;for(e.lineStart();++r<o;)c=t[r],e.point(c[0],c[1],c[2]);e.lineEnd()}function j8(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)zM(t[n],e,1);e.polygonEnd()}function wh(t,e){t&&N8.hasOwnProperty(t.type)?N8[t.type](t,e):MS(t,e)}class gc{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let o=0;o<this._n&&o<32;o++){const c=n[o],l=e+c,u=Math.abs(e)<Math.abs(c)?e-(l-c):c-(l-e);u&&(n[r++]=u),e=l}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,o,c,l=0;if(n>0){for(l=e[--n];n>0&&(r=l,o=e[--n],l=r+o,c=o-(l-r),!c););n>0&&(c<0&&e[n-1]<0||c>0&&e[n-1]>0)&&(o=c*2,r=l+o,o==r-l&&(l=r))}return l}}function jV(t,e){const n=new gc;if(e===void 0)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let o of t)(o=+e(o,++r,t))&&n.add(o)}return+n}function zV(t,e){const n=new gc;let r=-1;return Float64Array.from(t,e===void 0?o=>n.add(+o||0):o=>n.add(+e(o,++r,t)||0))}var Kn=1e-6,z8=1e-12,mr=Math.PI,_i=mr/2,U8=mr/4,Qo=mr*2,mo=180/mr,pi=mr/180,kr=Math.abs,Ah=Math.atan,vc=Math.atan2,dr=Math.cos,LS=Math.ceil,Z8=Math.exp,UV=Math.floor,ZV=Math.hypot,PS=Math.log,UM=Math.pow,ir=Math.sin,ba=Math.sign||function(t){return t>0?1:t<0?-1:0},Uo=Math.sqrt,ZM=Math.tan;function H8(t){return t>1?0:t<-1?mr:Math.acos(t)}function _a(t){return t>1?_i:t<-1?-_i:Math.asin(t)}function HV(t){return(t=ir(t/2))*t}function xa(){}var HM=new gc,VM=new gc,V8,W8,WM,GM,Ol={point:xa,lineStart:xa,lineEnd:xa,polygonStart:function(){Ol.lineStart=sB,Ol.lineEnd=lB},polygonEnd:function(){Ol.lineStart=Ol.lineEnd=Ol.point=xa,HM.add(kr(VM)),VM=new gc},result:function(){var t=HM/2;return HM=new gc,t}};function sB(){Ol.point=cB}function cB(t,e){Ol.point=G8,V8=WM=t,W8=GM=e}function G8(t,e){VM.add(GM*t-WM*e),WM=t,GM=e}function lB(){G8(V8,W8)}var Y8=Ol,Th=1/0,IS=Th,Wv=-Th,RS=Wv,uB={point:fB,lineStart:xa,lineEnd:xa,polygonStart:xa,polygonEnd:xa,result:function(){var t=[[Th,IS],[Wv,RS]];return Wv=RS=-(IS=Th=1/0),t}};function fB(t,e){t<Th&&(Th=t),t>Wv&&(Wv=t),e<IS&&(IS=e),e>RS&&(RS=e)}var kS=uB,YM=0,$M=0,Gv=0,DS=0,FS=0,Ch=0,XM=0,qM=0,Yv=0,$8,X8,_s,xs,Za={point:uf,lineStart:q8,lineEnd:K8,polygonStart:function(){Za.lineStart=pB,Za.lineEnd=gB},polygonEnd:function(){Za.point=uf,Za.lineStart=q8,Za.lineEnd=K8},result:function(){var t=Yv?[XM/Yv,qM/Yv]:Ch?[DS/Ch,FS/Ch]:Gv?[YM/Gv,$M/Gv]:[NaN,NaN];return YM=$M=Gv=DS=FS=Ch=XM=qM=Yv=0,t}};function uf(t,e){YM+=t,$M+=e,++Gv}function q8(){Za.point=dB}function dB(t,e){Za.point=hB,uf(_s=t,xs=e)}function hB(t,e){var n=t-_s,r=e-xs,o=Uo(n*n+r*r);DS+=o*(_s+t)/2,FS+=o*(xs+e)/2,Ch+=o,uf(_s=t,xs=e)}function K8(){Za.point=uf}function pB(){Za.point=vB}function gB(){Q8($8,X8)}function vB(t,e){Za.point=Q8,uf($8=_s=t,X8=xs=e)}function Q8(t,e){var n=t-_s,r=e-xs,o=Uo(n*n+r*r);DS+=o*(_s+t)/2,FS+=o*(xs+e)/2,Ch+=o,o=xs*t-_s*e,XM+=o*(_s+t),qM+=o*(xs+e),Yv+=o*3,uf(_s=t,xs=e)}var J8=Za;function tI(t){this._context=t}tI.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Qo);break}}},result:xa};var KM=new gc,QM,eI,nI,$v,Xv,NS={point:xa,lineStart:function(){NS.point=mB},lineEnd:function(){QM&&rI(eI,nI),NS.point=xa},polygonStart:function(){QM=!0},polygonEnd:function(){QM=null},result:function(){var t=+KM;return KM=new gc,t}};function mB(t,e){NS.point=rI,eI=$v=t,nI=Xv=e}function rI(t,e){$v-=t,Xv-=e,KM.add(Uo($v*$v+Xv*Xv)),$v=t,Xv=e}var iI=NS;let oI,BS,aI,sI;class cI{constructor(e){this._append=e==null?lI:yB(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==aI||this._append!==BS){const r=this._radius,o=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,aI=r,BS=this._append,sI=this._,this._=o}this._+=sI;break}}}result(){const e=this._;return this._="",e.length?e:null}}function lI(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function yB(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return lI;if(e!==oI){const n=Ri(10,e);oI=e,BS=function(o){let c=1;this._+=o[0];for(const l=o.length;c<l;++c)this._+=Math.round(arguments[c]*n)/n+o[c]}}return BS}function uI(t,e){let n=3,r=4.5,o,c;function l(u){return u&&(typeof r=="function"&&c.pointRadius(+r.apply(this,arguments)),wh(u,o(c))),c.result()}return l.area=function(u){return wh(u,o(Y8)),Y8.result()},l.measure=function(u){return wh(u,o(iI)),iI.result()},l.bounds=function(u){return wh(u,o(kS)),kS.result()},l.centroid=function(u){return wh(u,o(J8)),J8.result()},l.projection=function(u){return arguments.length?(o=u==null?(t=null,Vv):(t=u).stream,l):t},l.context=function(u){return arguments.length?(c=u==null?(e=null,new cI(n)):new tI(e=u),typeof r!="function"&&c.pointRadius(r),l):e},l.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(c.pointRadius(+u),+u),l):r},l.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const d=Math.floor(u);if(!(d>=0))throw new RangeError(`invalid digits: ${u}`);n=d}return e===null&&(c=new cI(n)),l},l.projection(t).digits(n).context(e)}function Mh(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=Math.max(0,Math.ceil((e-t)/n))|0,c=new Array(o);++r<o;)c[r]=t+r*n;return c}function fI(t,e,n){var r=Mh(t,e-Kn,n).concat(e);return function(o){return r.map(function(c){return[o,c]})}}function dI(t,e,n){var r=Mh(t,e-Kn,n).concat(e);return function(o){return r.map(function(c){return[c,o]})}}function bB(){var t,e,n,r,o,c,l,u,d=10,h=d,p=90,v=360,m,b,x,S,E=2.5;function w(){return{type:"MultiLineString",coordinates:M()}}function M(){return Mh(LS(r/p)*p,n,p).map(x).concat(Mh(LS(u/v)*v,l,v).map(S)).concat(Mh(LS(e/d)*d,t,d).filter(function(L){return kr(L%p)>Kn}).map(m)).concat(Mh(LS(c/h)*h,o,h).filter(function(L){return kr(L%v)>Kn}).map(b))}return w.lines=function(){return M().map(function(L){return{type:"LineString",coordinates:L}})},w.outline=function(){return{type:"Polygon",coordinates:[x(r).concat(S(l).slice(1),x(n).reverse().slice(1),S(u).reverse().slice(1))]}},w.extent=function(L){return arguments.length?w.extentMajor(L).extentMinor(L):w.extentMinor()},w.extentMajor=function(L){return arguments.length?(r=+L[0][0],n=+L[1][0],u=+L[0][1],l=+L[1][1],r>n&&(L=r,r=n,n=L),u>l&&(L=u,u=l,l=L),w.precision(E)):[[r,u],[n,l]]},w.extentMinor=function(L){return arguments.length?(e=+L[0][0],t=+L[1][0],c=+L[0][1],o=+L[1][1],e>t&&(L=e,e=t,t=L),c>o&&(L=c,c=o,o=L),w.precision(E)):[[e,c],[t,o]]},w.step=function(L){return arguments.length?w.stepMajor(L).stepMinor(L):w.stepMinor()},w.stepMajor=function(L){return arguments.length?(p=+L[0],v=+L[1],w):[p,v]},w.stepMinor=function(L){return arguments.length?(d=+L[0],h=+L[1],w):[d,h]},w.precision=function(L){return arguments.length?(E=+L,m=fI(c,o,90),b=dI(e,t,E),x=fI(u,l,90),S=dI(r,n,E),w):E},w.extentMajor([[-180,-90+Kn],[180,90-Kn]]).extentMinor([[-180,-80-Kn],[180,80+Kn]])}function _B(){return bB()()}function hI(){var t=[],e;return{point:function(n,r,o){e.push([n,r,o])},lineStart:function(){t.push(e=[])},lineEnd:xa,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function jS(t,e){return kr(t[0]-e[0])<Kn&&kr(t[1]-e[1])<Kn}function zS(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function pI(t,e,n,r,o){var c=[],l=[],u,d;if(t.forEach(function(x){if(!((S=x.length-1)<=0)){var S,E=x[0],w=x[S],M;if(jS(E,w)){if(!E[2]&&!w[2]){for(o.lineStart(),u=0;u<S;++u)o.point((E=x[u])[0],E[1]);o.lineEnd();return}w[0]+=2*Kn}c.push(M=new zS(E,x,null,!0)),l.push(M.o=new zS(E,null,M,!1)),c.push(M=new zS(w,x,null,!1)),l.push(M.o=new zS(w,null,M,!0))}}),!!c.length){for(l.sort(e),gI(c),gI(l),u=0,d=l.length;u<d;++u)l[u].e=n=!n;for(var h=c[0],p,v;;){for(var m=h,b=!0;m.v;)if((m=m.n)===h)return;p=m.z,o.lineStart();do{if(m.v=m.o.v=!0,m.e){if(b)for(u=0,d=p.length;u<d;++u)o.point((v=p[u])[0],v[1]);else r(m.x,m.n.x,1,o);m=m.n}else{if(b)for(p=m.p.z,u=p.length-1;u>=0;--u)o.point((v=p[u])[0],v[1]);else r(m.x,m.p.x,-1,o);m=m.p}m=m.o,p=m.z,b=!b}while(!m.v);o.lineEnd()}}}function gI(t){if(e=t.length){for(var e,n=0,r=t[0],o;++n<e;)r.n=o=t[n],o.p=r,r=o;r.n=o=t[0],o.p=r}}function JM(t){return[vc(t[1],t[0]),_a(t[2])]}function Lh(t){var e=t[0],n=t[1],r=dr(n);return[r*dr(e),r*ir(e),ir(n)]}function US(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ZS(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function t4(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function HS(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function e4(t){var e=Uo(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function n4(t){return kr(t[0])<=mr?t[0]:ba(t[0])*((kr(t[0])+mr)%Qo-mr)}function xB(t,e){var n=n4(e),r=e[1],o=ir(r),c=[ir(n),-dr(n),0],l=0,u=0,d=new gc;o===1?r=_i+Kn:o===-1&&(r=-_i-Kn);for(var h=0,p=t.length;h<p;++h)if(m=(v=t[h]).length)for(var v,m,b=v[m-1],x=n4(b),S=b[1]/2+U8,E=ir(S),w=dr(S),M=0;M<m;++M,x=I,E=z,w=W,b=L){var L=v[M],I=n4(L),R=L[1]/2+U8,z=ir(R),W=dr(R),Y=I-x,st=Y>=0?1:-1,xt=st*Y,Nt=xt>mr,Ht=E*z;if(d.add(vc(Ht*st*ir(xt),w*W+Ht*dr(xt))),l+=Nt?Y+st*Qo:Y,Nt^x>=n^I>=n){var dt=ZS(Lh(b),Lh(L));e4(dt);var Ot=ZS(c,dt);e4(Ot);var bt=(Nt^Y>=0?-1:1)*_a(Ot[2]);(r>bt||r===bt&&(dt[0]||dt[1]))&&(u+=Nt^Y>=0?1:-1)}}return(l<-Kn||l<Kn&&d<-z8)^u&1}function*SB(t){for(const e of t)yield*KR(e)}function vI(t){return Array.from(SB(t))}function mI(t,e,n,r){return function(o){var c=e(o),l=hI(),u=e(l),d=!1,h,p,v,m={point:b,lineStart:S,lineEnd:E,polygonStart:function(){m.point=w,m.lineStart=M,m.lineEnd=L,p=[],h=[]},polygonEnd:function(){m.point=b,m.lineStart=S,m.lineEnd=E,p=vI(p);var I=xB(h,r);p.length?(d||(o.polygonStart(),d=!0),pI(p,EB,I,n,o)):I&&(d||(o.polygonStart(),d=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),d&&(o.polygonEnd(),d=!1),p=h=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function b(I,R){t(I,R)&&o.point(I,R)}function x(I,R){c.point(I,R)}function S(){m.point=x,c.lineStart()}function E(){m.point=b,c.lineEnd()}function w(I,R){v.push([I,R]),u.point(I,R)}function M(){u.lineStart(),v=[]}function L(){w(v[0][0],v[0][1]),u.lineEnd();var I=u.clean(),R=l.result(),z,W=R.length,Y,st,xt;if(v.pop(),h.push(v),v=null,!!W){if(I&1){if(st=R[0],(Y=st.length-1)>0){for(d||(o.polygonStart(),d=!0),o.lineStart(),z=0;z<Y;++z)o.point((xt=st[z])[0],xt[1]);o.lineEnd()}return}W>1&&I&2&&R.push(R.pop().concat(R.shift())),p.push(R.filter(OB))}}return m}}function OB(t){return t.length>1}function EB(t,e){return((t=t.x)[0]<0?t[1]-_i-Kn:_i-t[1])-((e=e.x)[0]<0?e[1]-_i-Kn:_i-e[1])}var yI=mI(function(){return!0},wB,TB,[-mr,-_i]);function wB(t){var e=NaN,n=NaN,r=NaN,o;return{lineStart:function(){t.lineStart(),o=1},point:function(c,l){var u=c>0?mr:-mr,d=kr(c-e);kr(d-mr)<Kn?(t.point(e,n=(n+l)/2>0?_i:-_i),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(c,n),o=0):r!==u&&d>=mr&&(kr(e-r)<Kn&&(e-=r*Kn),kr(c-u)<Kn&&(c-=u*Kn),n=AB(e,n,c,l),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),o=0),t.point(e=c,n=l),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-o}}}function AB(t,e,n,r){var o,c,l=ir(t-n);return kr(l)>Kn?Ah((ir(e)*(c=dr(r))*ir(n)-ir(r)*(o=dr(e))*ir(t))/(o*c*l)):(e+r)/2}function TB(t,e,n,r){var o;if(t==null)o=n*_i,r.point(-mr,o),r.point(0,o),r.point(mr,o),r.point(mr,0),r.point(mr,-o),r.point(0,-o),r.point(-mr,-o),r.point(-mr,0),r.point(-mr,o);else if(kr(t[0]-e[0])>Kn){var c=t[0]<e[0]?mr:-mr;o=n*c/2,r.point(-c,o),r.point(0,o),r.point(c,o)}else r.point(e[0],e[1])}function bI(t,e,n,r,o,c){if(n){var l=dr(e),u=ir(e),d=r*n;o==null?(o=e+r*Qo,c=e-d/2):(o=_I(l,o),c=_I(l,c),(r>0?o<c:o>c)&&(o+=r*Qo));for(var h,p=o;r>0?p>c:p<c;p-=d)h=JM([l,-u*dr(p),-u*ir(p)]),t.point(h[0],h[1])}}function _I(t,e){e=Lh(e),e[0]-=t,e4(e);var n=H8(-e[1]);return((-e[2]<0?-n:n)+Qo-Kn)%Qo}function VV(){var t=constant([0,0]),e=constant(90),n=constant(2),r,o,c={point:l};function l(d,h){r.push(d=o(d,h)),d[0]*=degrees,d[1]*=degrees}function u(){var d=t.apply(this,arguments),h=e.apply(this,arguments)*radians,p=n.apply(this,arguments)*radians;return r=[],o=rotateRadians(-d[0]*radians,-d[1]*radians,0).invert,bI(c,h,p,1),d={type:"Polygon",coordinates:[r]},r=o=null,d}return u.center=function(d){return arguments.length?(t=typeof d=="function"?d:constant([+d[0],+d[1]]),u):t},u.radius=function(d){return arguments.length?(e=typeof d=="function"?d:constant(+d),u):e},u.precision=function(d){return arguments.length?(n=typeof d=="function"?d:constant(+d),u):n},u}function CB(t){var e=dr(t),n=2*pi,r=e>0,o=kr(e)>Kn;function c(p,v,m,b){bI(b,t,n,m,p,v)}function l(p,v){return dr(p)*dr(v)>e}function u(p){var v,m,b,x,S;return{lineStart:function(){x=b=!1,S=1},point:function(E,w){var M=[E,w],L,I=l(E,w),R=r?I?0:h(E,w):I?h(E+(E<0?mr:-mr),w):0;if(!v&&(x=b=I)&&p.lineStart(),I!==b&&(L=d(v,M),(!L||jS(v,L)||jS(M,L))&&(M[2]=1)),I!==b)S=0,I?(p.lineStart(),L=d(M,v),p.point(L[0],L[1])):(L=d(v,M),p.point(L[0],L[1],2),p.lineEnd()),v=L;else if(o&&v&&r^I){var z;!(R&m)&&(z=d(M,v,!0))&&(S=0,r?(p.lineStart(),p.point(z[0][0],z[0][1]),p.point(z[1][0],z[1][1]),p.lineEnd()):(p.point(z[1][0],z[1][1]),p.lineEnd(),p.lineStart(),p.point(z[0][0],z[0][1],3)))}I&&(!v||!jS(v,M))&&p.point(M[0],M[1]),v=M,b=I,m=R},lineEnd:function(){b&&p.lineEnd(),v=null},clean:function(){return S|(x&&b)<<1}}}function d(p,v,m){var b=Lh(p),x=Lh(v),S=[1,0,0],E=ZS(b,x),w=US(E,E),M=E[0],L=w-M*M;if(!L)return!m&&p;var I=e*w/L,R=-e*M/L,z=ZS(S,E),W=HS(S,I),Y=HS(E,R);t4(W,Y);var st=z,xt=US(W,st),Nt=US(st,st),Ht=xt*xt-Nt*(US(W,W)-1);if(!(Ht<0)){var dt=Uo(Ht),Ot=HS(st,(-xt-dt)/Nt);if(t4(Ot,W),Ot=JM(Ot),!m)return Ot;var bt=p[0],wt=v[0],oe=p[1],Ut=v[1],Kt;wt<bt&&(Kt=bt,bt=wt,wt=Kt);var me=wt-bt,Ee=kr(me-mr)<Kn,Pe=Ee||me<Kn;if(!Ee&&Ut<oe&&(Kt=oe,oe=Ut,Ut=Kt),Pe?Ee?oe+Ut>0^Ot[1]<(kr(Ot[0]-bt)<Kn?oe:Ut):oe<=Ot[1]&&Ot[1]<=Ut:me>mr^(bt<=Ot[0]&&Ot[0]<=wt)){var Ie=HS(st,(-xt+dt)/Nt);return t4(Ie,W),[Ot,JM(Ie)]}}}function h(p,v){var m=r?t:mr-t,b=0;return p<-m?b|=1:p>m&&(b|=2),v<-m?b|=4:v>m&&(b|=8),b}return mI(l,u,c,r?[0,-t]:[-mr,t-mr])}function MB(t,e,n,r,o,c){var l=t[0],u=t[1],d=e[0],h=e[1],p=0,v=1,m=d-l,b=h-u,x;if(x=n-l,!(!m&&x>0)){if(x/=m,m<0){if(x<p)return;x<v&&(v=x)}else if(m>0){if(x>v)return;x>p&&(p=x)}if(x=o-l,!(!m&&x<0)){if(x/=m,m<0){if(x>v)return;x>p&&(p=x)}else if(m>0){if(x<p)return;x<v&&(v=x)}if(x=r-u,!(!b&&x>0)){if(x/=b,b<0){if(x<p)return;x<v&&(v=x)}else if(b>0){if(x>v)return;x>p&&(p=x)}if(x=c-u,!(!b&&x<0)){if(x/=b,b<0){if(x>v)return;x>p&&(p=x)}else if(b>0){if(x<p)return;x<v&&(v=x)}return p>0&&(t[0]=l+p*m,t[1]=u+p*b),v<1&&(e[0]=l+v*m,e[1]=u+v*b),!0}}}}}var qv=1e9,VS=-qv;function xI(t,e,n,r){function o(h,p){return t<=h&&h<=n&&e<=p&&p<=r}function c(h,p,v,m){var b=0,x=0;if(h==null||(b=l(h,v))!==(x=l(p,v))||d(h,p)<0^v>0)do m.point(b===0||b===3?t:n,b>1?r:e);while((b=(b+v+4)%4)!==x);else m.point(p[0],p[1])}function l(h,p){return kr(h[0]-t)<Kn?p>0?0:3:kr(h[0]-n)<Kn?p>0?2:1:kr(h[1]-e)<Kn?p>0?1:0:p>0?3:2}function u(h,p){return d(h.x,p.x)}function d(h,p){var v=l(h,1),m=l(p,1);return v!==m?v-m:v===0?p[1]-h[1]:v===1?h[0]-p[0]:v===2?h[1]-p[1]:p[0]-h[0]}return function(h){var p=h,v=hI(),m,b,x,S,E,w,M,L,I,R,z,W={point:Y,lineStart:Ht,lineEnd:dt,polygonStart:xt,polygonEnd:Nt};function Y(bt,wt){o(bt,wt)&&p.point(bt,wt)}function st(){for(var bt=0,wt=0,oe=b.length;wt<oe;++wt)for(var Ut=b[wt],Kt=1,me=Ut.length,Ee=Ut[0],Pe,Ie,qe=Ee[0],sn=Ee[1];Kt<me;++Kt)Pe=qe,Ie=sn,Ee=Ut[Kt],qe=Ee[0],sn=Ee[1],Ie<=r?sn>r&&(qe-Pe)*(r-Ie)>(sn-Ie)*(t-Pe)&&++bt:sn<=r&&(qe-Pe)*(r-Ie)<(sn-Ie)*(t-Pe)&&--bt;return bt}function xt(){p=v,m=[],b=[],z=!0}function Nt(){var bt=st(),wt=z&&bt,oe=(m=vI(m)).length;(wt||oe)&&(h.polygonStart(),wt&&(h.lineStart(),c(null,null,1,h),h.lineEnd()),oe&&pI(m,u,bt,c,h),h.polygonEnd()),p=h,m=b=x=null}function Ht(){W.point=Ot,b&&b.push(x=[]),R=!0,I=!1,M=L=NaN}function dt(){m&&(Ot(S,E),w&&I&&v.rejoin(),m.push(v.result())),W.point=Y,I&&p.lineEnd()}function Ot(bt,wt){var oe=o(bt,wt);if(b&&x.push([bt,wt]),R)S=bt,E=wt,w=oe,R=!1,oe&&(p.lineStart(),p.point(bt,wt));else if(oe&&I)p.point(bt,wt);else{var Ut=[M=Math.max(VS,Math.min(qv,M)),L=Math.max(VS,Math.min(qv,L))],Kt=[bt=Math.max(VS,Math.min(qv,bt)),wt=Math.max(VS,Math.min(qv,wt))];MB(Ut,Kt,t,e,n,r)?(I||(p.lineStart(),p.point(Ut[0],Ut[1])),p.point(Kt[0],Kt[1]),oe||p.lineEnd(),z=!1):oe&&(p.lineStart(),p.point(bt,wt),z=!1)}M=bt,L=wt,I=oe}return W}}function r4(t,e){function n(r,o){return r=t(r,o),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,o){return r=e.invert(r,o),r&&t.invert(r[0],r[1])}),n}function i4(t,e){return kr(t)>mr&&(t-=Math.round(t/Qo)*Qo),[t,e]}i4.invert=i4;function SI(t,e,n){return(t%=Qo)?e||n?r4(EI(t),wI(e,n)):EI(t):e||n?wI(e,n):i4}function OI(t){return function(e,n){return e+=t,kr(e)>mr&&(e-=Math.round(e/Qo)*Qo),[e,n]}}function EI(t){var e=OI(t);return e.invert=OI(-t),e}function wI(t,e){var n=dr(t),r=ir(t),o=dr(e),c=ir(e);function l(u,d){var h=dr(d),p=dr(u)*h,v=ir(u)*h,m=ir(d),b=m*n+p*r;return[vc(v*o-b*c,p*n-m*r),_a(b*o+v*c)]}return l.invert=function(u,d){var h=dr(d),p=dr(u)*h,v=ir(u)*h,m=ir(d),b=m*o-v*c;return[vc(v*o+m*c,p*n+b*r),_a(b*n-p*r)]},l}function LB(t){t=SI(t[0]*pi,t[1]*pi,t.length>2?t[2]*pi:0);function e(n){return n=t(n[0]*pi,n[1]*pi),n[0]*=mo,n[1]*=mo,n}return e.invert=function(n){return n=t.invert(n[0]*pi,n[1]*pi),n[0]*=mo,n[1]*=mo,n},e}function WV(t){return{stream:Kv(t)}}function Kv(t){return function(e){var n=new o4;for(var r in t)n[r]=t[r];return n.stream=e,n}}function o4(){}o4.prototype={constructor:o4,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function a4(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),wh(n,t.stream(kS)),e(kS.result()),r!=null&&t.clipExtent(r),t}function WS(t,e,n){return a4(t,function(r){var o=e[1][0]-e[0][0],c=e[1][1]-e[0][1],l=Math.min(o/(r[1][0]-r[0][0]),c/(r[1][1]-r[0][1])),u=+e[0][0]+(o-l*(r[1][0]+r[0][0]))/2,d=+e[0][1]+(c-l*(r[1][1]+r[0][1]))/2;t.scale(150*l).translate([u,d])},n)}function s4(t,e,n){return WS(t,[[0,0],e],n)}function c4(t,e,n){return a4(t,function(r){var o=+e,c=o/(r[1][0]-r[0][0]),l=(o-c*(r[1][0]+r[0][0]))/2,u=-c*r[0][1];t.scale(150*c).translate([l,u])},n)}function l4(t,e,n){return a4(t,function(r){var o=+e,c=o/(r[1][1]-r[0][1]),l=-c*r[0][0],u=(o-c*(r[1][1]+r[0][1]))/2;t.scale(150*c).translate([l,u])},n)}var AI=16,PB=dr(30*pi);function TI(t,e){return+e?RB(t,e):IB(t)}function IB(t){return Kv({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function RB(t,e){function n(r,o,c,l,u,d,h,p,v,m,b,x,S,E){var w=h-r,M=p-o,L=w*w+M*M;if(L>4*e&&S--){var I=l+m,R=u+b,z=d+x,W=Uo(I*I+R*R+z*z),Y=_a(z/=W),st=kr(kr(z)-1)<Kn||kr(c-v)<Kn?(c+v)/2:vc(R,I),xt=t(st,Y),Nt=xt[0],Ht=xt[1],dt=Nt-r,Ot=Ht-o,bt=M*dt-w*Ot;(bt*bt/L>e||kr((w*dt+M*Ot)/L-.5)>.3||l*m+u*b+d*x<PB)&&(n(r,o,c,l,u,d,Nt,Ht,st,I/=W,R/=W,z,S,E),E.point(Nt,Ht),n(Nt,Ht,st,I,R,z,h,p,v,m,b,x,S,E))}}return function(r){var o,c,l,u,d,h,p,v,m,b,x,S,E={point:w,lineStart:M,lineEnd:I,polygonStart:function(){r.polygonStart(),E.lineStart=R},polygonEnd:function(){r.polygonEnd(),E.lineStart=M}};function w(Y,st){Y=t(Y,st),r.point(Y[0],Y[1])}function M(){v=NaN,E.point=L,r.lineStart()}function L(Y,st){var xt=Lh([Y,st]),Nt=t(Y,st);n(v,m,p,b,x,S,v=Nt[0],m=Nt[1],p=Y,b=xt[0],x=xt[1],S=xt[2],AI,r),r.point(v,m)}function I(){E.point=w,r.lineEnd()}function R(){M(),E.point=z,E.lineEnd=W}function z(Y,st){L(o=Y,st),c=v,l=m,u=b,d=x,h=S,E.point=L}function W(){n(v,m,p,b,x,S,c,l,o,u,d,h,AI,r),E.lineEnd=I,I()}return E}}var kB=Kv({point:function(t,e){this.stream.point(t*pi,e*pi)}});function DB(t){return Kv({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function FB(t,e,n,r,o){function c(l,u){return l*=r,u*=o,[e+t*l,n-t*u]}return c.invert=function(l,u){return[(l-e)/t*r,(n-u)/t*o]},c}function CI(t,e,n,r,o,c){if(!c)return FB(t,e,n,r,o);var l=dr(c),u=ir(c),d=l*t,h=u*t,p=l/t,v=u/t,m=(u*n-l*e)/t,b=(u*e+l*n)/t;function x(S,E){return S*=r,E*=o,[d*S-h*E+e,n-h*S-d*E]}return x.invert=function(S,E){return[r*(p*S-v*E+m),o*(b-v*S-p*E)]},x}function Ss(t){return u4(function(){return t})()}function u4(t){var e,n=150,r=480,o=250,c=0,l=0,u=0,d=0,h=0,p,v=0,m=1,b=1,x=null,S=yI,E=null,w,M,L,I=Vv,R=.5,z,W,Y,st,xt;function Nt(bt){return Y(bt[0]*pi,bt[1]*pi)}function Ht(bt){return bt=Y.invert(bt[0],bt[1]),bt&&[bt[0]*mo,bt[1]*mo]}Nt.stream=function(bt){return st&&xt===bt?st:st=kB(DB(p)(S(z(I(xt=bt)))))},Nt.preclip=function(bt){return arguments.length?(S=bt,x=void 0,Ot()):S},Nt.postclip=function(bt){return arguments.length?(I=bt,E=w=M=L=null,Ot()):I},Nt.clipAngle=function(bt){return arguments.length?(S=+bt?CB(x=bt*pi):(x=null,yI),Ot()):x*mo},Nt.clipExtent=function(bt){return arguments.length?(I=bt==null?(E=w=M=L=null,Vv):xI(E=+bt[0][0],w=+bt[0][1],M=+bt[1][0],L=+bt[1][1]),Ot()):E==null?null:[[E,w],[M,L]]},Nt.scale=function(bt){return arguments.length?(n=+bt,dt()):n},Nt.translate=function(bt){return arguments.length?(r=+bt[0],o=+bt[1],dt()):[r,o]},Nt.center=function(bt){return arguments.length?(c=bt[0]%360*pi,l=bt[1]%360*pi,dt()):[c*mo,l*mo]},Nt.rotate=function(bt){return arguments.length?(u=bt[0]%360*pi,d=bt[1]%360*pi,h=bt.length>2?bt[2]%360*pi:0,dt()):[u*mo,d*mo,h*mo]},Nt.angle=function(bt){return arguments.length?(v=bt%360*pi,dt()):v*mo},Nt.reflectX=function(bt){return arguments.length?(m=bt?-1:1,dt()):m<0},Nt.reflectY=function(bt){return arguments.length?(b=bt?-1:1,dt()):b<0},Nt.precision=function(bt){return arguments.length?(z=TI(W,R=bt*bt),Ot()):Uo(R)},Nt.fitExtent=function(bt,wt){return WS(Nt,bt,wt)},Nt.fitSize=function(bt,wt){return s4(Nt,bt,wt)},Nt.fitWidth=function(bt,wt){return c4(Nt,bt,wt)},Nt.fitHeight=function(bt,wt){return l4(Nt,bt,wt)};function dt(){var bt=CI(n,0,0,m,b,v).apply(null,e(c,l)),wt=CI(n,r-bt[0],o-bt[1],m,b,v);return p=SI(u,d,h),W=r4(e,wt),Y=r4(p,W),z=TI(W,R),Ot()}function Ot(){return st=xt=null,Nt}return function(){return e=t.apply(this,arguments),Nt.invert=e.invert&&Ht,dt()}}function f4(t){var e=0,n=mr/3,r=u4(t),o=r(e,n);return o.parallels=function(c){return arguments.length?r(e=c[0]*pi,n=c[1]*pi):[e*mo,n*mo]},o}function NB(t){var e=dr(t);function n(r,o){return[r*e,ir(o)/e]}return n.invert=function(r,o){return[r/e,_a(o*e)]},n}function MI(t,e){var n=ir(t),r=(n+ir(e))/2;if(kr(r)<Kn)return NB(t);var o=1+n*(2*r-n),c=Uo(o)/r;function l(u,d){var h=Uo(o-2*r*ir(d))/r;return[h*ir(u*=r),c-h*dr(u)]}return l.invert=function(u,d){var h=c-d,p=vc(u,kr(h))*ba(h);return h*r<0&&(p-=mr*ba(u)*ba(h)),[p/r,_a((o-(u*u+h*h)*r*r)/(2*r))]},l}function GS(){return f4(MI).scale(155.424).center([0,33.6442])}function LI(){return GS().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function BB(t){var e=t.length;return{point:function(n,r){for(var o=-1;++o<e;)t[o].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function jB(){var t,e,n=LI(),r,o=GS().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c,l=GS().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,d,h={point:function(m,b){d=[m,b]}};function p(m){var b=m[0],x=m[1];return d=null,r.point(b,x),d||(c.point(b,x),d)||(u.point(b,x),d)}p.invert=function(m){var b=n.scale(),x=n.translate(),S=(m[0]-x[0])/b,E=(m[1]-x[1])/b;return(E>=.12&&E<.234&&S>=-.425&&S<-.214?o:E>=.166&&E<.234&&S>=-.214&&S<-.115?l:n).invert(m)},p.stream=function(m){return t&&e===m?t:t=BB([n.stream(e=m),o.stream(m),l.stream(m)])},p.precision=function(m){return arguments.length?(n.precision(m),o.precision(m),l.precision(m),v()):n.precision()},p.scale=function(m){return arguments.length?(n.scale(m),o.scale(m*.35),l.scale(m),p.translate(n.translate())):n.scale()},p.translate=function(m){if(!arguments.length)return n.translate();var b=n.scale(),x=+m[0],S=+m[1];return r=n.translate(m).clipExtent([[x-.455*b,S-.238*b],[x+.455*b,S+.238*b]]).stream(h),c=o.translate([x-.307*b,S+.201*b]).clipExtent([[x-.425*b+Kn,S+.12*b+Kn],[x-.214*b-Kn,S+.234*b-Kn]]).stream(h),u=l.translate([x-.205*b,S+.212*b]).clipExtent([[x-.214*b+Kn,S+.166*b+Kn],[x-.115*b-Kn,S+.234*b-Kn]]).stream(h),v()},p.fitExtent=function(m,b){return WS(p,m,b)},p.fitSize=function(m,b){return s4(p,m,b)},p.fitWidth=function(m,b){return c4(p,m,b)},p.fitHeight=function(m,b){return l4(p,m,b)};function v(){return t=e=null,p}return p.scale(1070)}function PI(t){return function(e,n){var r=dr(e),o=dr(n),c=t(r*o);return c===1/0?[2,0]:[c*o*ir(e),c*ir(n)]}}function Qv(t){return function(e,n){var r=Uo(e*e+n*n),o=t(r),c=ir(o),l=dr(o);return[vc(e*c,r*l),_a(r&&n*c/r)]}}var d4=PI(function(t){return Uo(2/(1+t))});d4.invert=Qv(function(t){return 2*_a(t/2)});function zB(){return Ss(d4).scale(124.75).clipAngle(180-.001)}var h4=PI(function(t){return(t=H8(t))&&t/ir(t)});h4.invert=Qv(function(t){return t});function UB(){return Ss(h4).scale(79.4188).clipAngle(180-.001)}function Jv(t,e){return[t,PS(ZM((_i+e)/2))]}Jv.invert=function(t,e){return[t,2*Ah(Z8(e))-_i]};function ZB(){return II(Jv).scale(961/Qo)}function II(t){var e=Ss(t),n=e.center,r=e.scale,o=e.translate,c=e.clipExtent,l=null,u,d,h;e.scale=function(v){return arguments.length?(r(v),p()):r()},e.translate=function(v){return arguments.length?(o(v),p()):o()},e.center=function(v){return arguments.length?(n(v),p()):n()},e.clipExtent=function(v){return arguments.length?(v==null?l=u=d=h=null:(l=+v[0][0],u=+v[0][1],d=+v[1][0],h=+v[1][1]),p()):l==null?null:[[l,u],[d,h]]};function p(){var v=mr*r(),m=e(LB(e.rotate()).invert([0,0]));return c(l==null?[[m[0]-v,m[1]-v],[m[0]+v,m[1]+v]]:t===Jv?[[Math.max(m[0]-v,l),u],[Math.min(m[0]+v,d),h]]:[[l,Math.max(m[1]-v,u)],[d,Math.min(m[1]+v,h)]])}return p()}function YS(t){return ZM((_i+t)/2)}function RI(t,e){var n=dr(t),r=t===e?ir(t):PS(n/dr(e))/PS(YS(e)/YS(t)),o=n*UM(YS(t),r)/r;if(!r)return Jv;function c(l,u){o>0?u<-_i+Kn&&(u=-_i+Kn):u>_i-Kn&&(u=_i-Kn);var d=o/UM(YS(u),r);return[d*ir(r*l),o-d*dr(r*l)]}return c.invert=function(l,u){var d=o-u,h=ba(r)*Uo(l*l+d*d),p=vc(l,kr(d))*ba(d);return d*r<0&&(p-=mr*ba(l)*ba(d)),[p/r,2*Ah(UM(o/h,1/r))-_i]},c}function HB(){return f4(RI).scale(109.5).parallels([30,30])}function tm(t,e){return[t,e]}tm.invert=tm;function VB(){return Ss(tm).scale(152.63)}function kI(t,e){var n=dr(t),r=t===e?ir(t):(n-dr(e))/(e-t),o=n/r+t;if(kr(r)<Kn)return tm;function c(l,u){var d=o-u,h=r*l;return[d*ir(h),o-d*dr(h)]}return c.invert=function(l,u){var d=o-u,h=vc(l,kr(d))*ba(d);return d*r<0&&(h-=mr*ba(l)*ba(d)),[h/r,o-ba(r)*Uo(l*l+d*d)]},c}function WB(){return f4(kI).scale(131.154).center([0,13.9389])}var em=1.340264,nm=-.081106,rm=893e-6,im=.003796,$S=Uo(3)/2,GB=12;function p4(t,e){var n=_a($S*ir(e)),r=n*n,o=r*r*r;return[t*dr(n)/($S*(em+3*nm*r+o*(7*rm+9*im*r))),n*(em+nm*r+o*(rm+im*r))]}p4.invert=function(t,e){for(var n=e,r=n*n,o=r*r*r,c=0,l,u,d;c<GB&&(u=n*(em+nm*r+o*(rm+im*r))-e,d=em+3*nm*r+o*(7*rm+9*im*r),n-=l=u/d,r=n*n,o=r*r*r,!(kr(l)<z8));++c);return[$S*t*(em+3*nm*r+o*(7*rm+9*im*r))/dr(n),_a(ir(n)/$S)]};function YB(){return Ss(p4).scale(177.158)}function g4(t,e){var n=dr(e),r=dr(t)*n;return[n*ir(t)/r,ir(e)/r]}g4.invert=Qv(Ah);function $B(){return Ss(g4).scale(144.049).clipAngle(60)}function XB(){var t=1,e=0,n=0,r=1,o=1,c=0,l,u,d=null,h,p,v,m=1,b=1,x=Kv({point:function(I,R){var z=L([I,R]);this.stream.point(z[0],z[1])}}),S=Vv,E,w;function M(){return m=t*r,b=t*o,E=w=null,L}function L(I){var R=I[0]*m,z=I[1]*b;if(c){var W=z*l-R*u;R=R*l+z*u,z=W}return[R+e,z+n]}return L.invert=function(I){var R=I[0]-e,z=I[1]-n;if(c){var W=z*l+R*u;R=R*l-z*u,z=W}return[R/m,z/b]},L.stream=function(I){return E&&w===I?E:E=x(S(w=I))},L.postclip=function(I){return arguments.length?(S=I,d=h=p=v=null,M()):S},L.clipExtent=function(I){return arguments.length?(S=I==null?(d=h=p=v=null,Vv):xI(d=+I[0][0],h=+I[0][1],p=+I[1][0],v=+I[1][1]),M()):d==null?null:[[d,h],[p,v]]},L.scale=function(I){return arguments.length?(t=+I,M()):t},L.translate=function(I){return arguments.length?(e=+I[0],n=+I[1],M()):[e,n]},L.angle=function(I){return arguments.length?(c=I%360*pi,u=ir(c),l=dr(c),M()):c*mo},L.reflectX=function(I){return arguments.length?(r=I?-1:1,M()):r<0},L.reflectY=function(I){return arguments.length?(o=I?-1:1,M()):o<0},L.fitExtent=function(I,R){return WS(L,I,R)},L.fitSize=function(I,R){return s4(L,I,R)},L.fitWidth=function(I,R){return c4(L,I,R)},L.fitHeight=function(I,R){return l4(L,I,R)},L}function v4(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),e*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}v4.invert=function(t,e){var n=e,r=25,o;do{var c=n*n,l=c*c;n-=o=(n*(1.007226+c*(.015085+l*(-.044475+.028874*c-.005916*l)))-e)/(1.007226+c*(.015085*3+l*(-.044475*7+.028874*9*c-.005916*11*l)))}while(kr(o)>Kn&&--r>0);return[t/(.8707+(c=n*n)*(-.131979+c*(-.013791+c*c*c*(.003971-.001529*c)))),n]};function qB(){return Ss(v4).scale(175.295)}function m4(t,e){return[dr(e)*ir(t),ir(e)]}m4.invert=Qv(_a);function KB(){return Ss(m4).scale(249.5).clipAngle(90+Kn)}function y4(t,e){var n=dr(e),r=1+dr(t)*n;return[n*ir(t)/r,ir(e)/r]}y4.invert=Qv(function(t){return 2*Ah(t)});function QB(){return Ss(y4).scale(250).clipAngle(142)}function b4(t,e){return[PS(ZM((_i+e)/2)),-t]}b4.invert=function(t,e){return[-e,2*Ah(Z8(t))-_i]};function JB(){var t=II(b4),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):(r=e(),[r[1],-r[0]])},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var tj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function ej(t){if(typeof t=="function")return t;const e=`geo${Ts(t)}`,n=_t[e];if(!n)throw new Error(`Unknown coordinate: ${t}`);return n}function nj(t){return{type:"FeatureCollection",features:t.flatMap(e=>rj(e).features)}}function rj(t){const e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!t||!t.type)return null;const n=e[t.type];if(!n)return null;if(n==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if(n==="feature")return{type:"FeatureCollection",features:[t]};if(n==="featureCollection")return t}function ij(t,e){var n;for(const[r,o]of Object.entries(e))(n=t[r])===null||n===void 0||n.call(t,o)}function oj(t,e,n,r){const o=()=>{const u=e.filter(DI);return u.find(h=>h.sphere)?{type:"Sphere"}:nj(u.filter(h=>!h.sphere).flatMap(h=>h.data.value))},{outline:c=o()}=r,{size:l="fitExtent"}=r;if(l==="fitExtent")return aj(t,c,n);if(l==="fitWidth")return sj(t,c,n)}function aj(t,e,n){const{x:r,y:o,width:c,height:l}=n;t.fitExtent([[r,o],[c,l]],e)}function sj(t,e,n){const{width:r,height:o}=n,[[c,l],[u,d]]=uI(t.fitWidth(r,e)).bounds(e),h=Math.ceil(d-l),p=Math.min(Math.ceil(u-c),h),v=t.scale()*(p-1)/p,[m,b]=t.translate(),x=b+(o-h)/2;t.scale(v).translate([m,x]).precision(.2)}function cj(t){const{data:e}=t;if(Array.isArray(e))return Object.assign(Object.assign({},t),{data:{value:e}});const{type:n}=e;return n==="graticule10"?Object.assign(Object.assign({},t),{data:{value:[_B()]}}):n==="sphere"?Object.assign(Object.assign({},t),{sphere:!0,data:{value:[{type:"Sphere"}]}}):t}function DI(t){return t.type==="geoPath"}const FI=()=>t=>{const{children:e,coordinate:n={}}=t;if(!Array.isArray(e))return[];const{type:r="equalEarth"}=n,o=tj(n,["type"]),c=ej(r),l=e.map(cj);let u;function d(){return[["custom",(v,m,b,x)=>{const S=c();oj(S,l,{x:v,y:m,width:b,height:x},o),ij(S,o),u=uI(S);const w=new qi({domain:[v,v+b]}),M=new qi({domain:[m,m+x]}),L=R=>{const z=S(R);if(!z)return[null,null];const[W,Y]=z;return[w.map(W),M.map(Y)]},I=R=>{if(!R)return null;const[z,W]=R,Y=[w.invert(z),M.invert(W)];return S.invert(Y)};return{transform:R=>L(R),untransform:R=>I(R)}}]]}function h(v){const{style:m,tooltip:b={}}=v;return Object.assign(Object.assign({},v),{type:"path",tooltip:Ba(b,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},m),{d:x=>u(x)||[]})})}const p=v=>DI(v)?h(v):v;return[Object.assign(Object.assign({},t),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:d},children:l.flatMap(p)})]};FI.props={};var lj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const NI=()=>t=>{const{type:e,data:n,scale:r,encode:o,style:c,animate:l,key:u,state:d}=t,h=lj(t,["type","data","scale","encode","style","animate","key","state"]);return[Object.assign(Object.assign({type:"geoView"},h),{children:[{type:"geoPath",key:`${u}-0`,data:{value:n},scale:r,encode:o,style:c,animate:l,state:d}]})]};NI.props={};function uj(){return{"composition.geoView":FI,"composition.geoPath":NI}}function fj(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return BI(this.cover(e,n),e,n,t)}function BI(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var o,c=t._root,l={data:r},u=t._x0,d=t._y0,h=t._x1,p=t._y1,v,m,b,x,S,E,w,M;if(!c)return t._root=l,t;for(;c.length;)if((S=e>=(v=(u+h)/2))?u=v:h=v,(E=n>=(m=(d+p)/2))?d=m:p=m,o=c,!(c=c[w=E<<1|S]))return o[w]=l,t;if(b=+t._x.call(null,c.data),x=+t._y.call(null,c.data),e===b&&n===x)return l.next=c,o?o[w]=l:t._root=l,t;do o=o?o[w]=new Array(4):t._root=new Array(4),(S=e>=(v=(u+h)/2))?u=v:h=v,(E=n>=(m=(d+p)/2))?d=m:p=m;while((w=E<<1|S)===(M=(x>=m)<<1|b>=v));return o[M]=c,o[w]=l,t}function dj(t){var e,n,r=t.length,o,c,l=new Array(r),u=new Array(r),d=1/0,h=1/0,p=-1/0,v=-1/0;for(n=0;n<r;++n)isNaN(o=+this._x.call(null,e=t[n]))||isNaN(c=+this._y.call(null,e))||(l[n]=o,u[n]=c,o<d&&(d=o),o>p&&(p=o),c<h&&(h=c),c>v&&(v=c));if(d>p||h>v)return this;for(this.cover(d,h).cover(p,v),n=0;n<r;++n)BI(this,l[n],u[n],t[n]);return this}function hj(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,o=this._x1,c=this._y1;if(isNaN(n))o=(n=Math.floor(t))+1,c=(r=Math.floor(e))+1;else{for(var l=o-n||1,u=this._root,d,h;n>t||t>=o||r>e||e>=c;)switch(h=(e<r)<<1|t<n,d=new Array(4),d[h]=u,u=d,l*=2,h){case 0:o=n+l,c=r+l;break;case 1:n=o-l,c=r+l;break;case 2:o=n+l,r=c-l;break;case 3:n=o-l,r=c-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=o,this._y1=c,this}function pj(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function gj(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Eo(t,e,n,r,o){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=o}function vj(t,e,n){var r,o=this._x0,c=this._y0,l,u,d,h,p=this._x1,v=this._y1,m=[],b=this._root,x,S;for(b&&m.push(new Eo(b,o,c,p,v)),n==null?n=1/0:(o=t-n,c=e-n,p=t+n,v=e+n,n*=n);x=m.pop();)if(!(!(b=x.node)||(l=x.x0)>p||(u=x.y0)>v||(d=x.x1)<o||(h=x.y1)<c))if(b.length){var E=(l+d)/2,w=(u+h)/2;m.push(new Eo(b[3],E,w,d,h),new Eo(b[2],l,w,E,h),new Eo(b[1],E,u,d,w),new Eo(b[0],l,u,E,w)),(S=(e>=w)<<1|t>=E)&&(x=m[m.length-1],m[m.length-1]=m[m.length-1-S],m[m.length-1-S]=x)}else{var M=t-+this._x.call(null,b.data),L=e-+this._y.call(null,b.data),I=M*M+L*L;if(I<n){var R=Math.sqrt(n=I);o=t-R,c=e-R,p=t+R,v=e+R,r=b.data}}return r}function mj(t){if(isNaN(p=+this._x.call(null,t))||isNaN(v=+this._y.call(null,t)))return this;var e,n=this._root,r,o,c,l=this._x0,u=this._y0,d=this._x1,h=this._y1,p,v,m,b,x,S,E,w;if(!n)return this;if(n.length)for(;;){if((x=p>=(m=(l+d)/2))?l=m:d=m,(S=v>=(b=(u+h)/2))?u=b:h=b,e=n,!(n=n[E=S<<1|x]))return this;if(!n.length)break;(e[E+1&3]||e[E+2&3]||e[E+3&3])&&(r=e,w=E)}for(;n.data!==t;)if(o=n,!(n=n.next))return this;return(c=n.next)&&delete n.next,o?(c?o.next=c:delete o.next,this):e?(c?e[E]=c:delete e[E],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[w]=n:this._root=n),this):(this._root=c,this)}function yj(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function bj(){return this._root}function _j(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function xj(t){var e=[],n,r=this._root,o,c,l,u,d;for(r&&e.push(new Eo(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,c=n.x0,l=n.y0,u=n.x1,d=n.y1)&&r.length){var h=(c+u)/2,p=(l+d)/2;(o=r[3])&&e.push(new Eo(o,h,p,u,d)),(o=r[2])&&e.push(new Eo(o,c,p,h,d)),(o=r[1])&&e.push(new Eo(o,h,l,u,p)),(o=r[0])&&e.push(new Eo(o,c,l,h,p))}return this}function Sj(t){var e=[],n=[],r;for(this._root&&e.push(new Eo(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var o=r.node;if(o.length){var c,l=r.x0,u=r.y0,d=r.x1,h=r.y1,p=(l+d)/2,v=(u+h)/2;(c=o[0])&&e.push(new Eo(c,l,u,p,v)),(c=o[1])&&e.push(new Eo(c,p,u,d,v)),(c=o[2])&&e.push(new Eo(c,l,v,p,h)),(c=o[3])&&e.push(new Eo(c,p,v,d,h))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Oj(t){return t[0]}function Ej(t){return arguments.length?(this._x=t,this):this._x}function wj(t){return t[1]}function Aj(t){return arguments.length?(this._y=t,this):this._y}function jI(t,e,n){var r=new _4(e==null?Oj:e,n==null?wj:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function _4(t,e,n,r,o,c){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=o,this._y1=c,this._root=void 0}function zI(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var wo=jI.prototype=_4.prototype;wo.copy=function(){var t=new _4(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=zI(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var o=0;o<4;++o)(r=e.source[o])&&(r.length?n.push({source:r,target:e.target[o]=new Array(4)}):e.target[o]=zI(r));return t},wo.add=fj,wo.addAll=dj,wo.cover=hj,wo.data=pj,wo.extent=gj,wo.find=vj,wo.remove=mj,wo.removeAll=yj,wo.root=bj,wo.size=_j,wo.visit=xj,wo.visitAfter=Sj,wo.x=Ej,wo.y=Aj;function Jo(t){return function(){return t}}function Ph(t){return(t()-.5)*1e-6}var Tj={value:function(){}};function UI(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new XS(n)}function XS(t){this._=t}function Cj(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}XS.prototype=UI.prototype={constructor:XS,on:function(e,n){var r=this._,o=Cj(e+"",r),c,l=-1,u=o.length;if(arguments.length<2){for(;++l<u;)if((c=(e=o[l]).type)&&(c=Mj(r[c],e.name)))return c;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++l<u;)if(c=(e=o[l]).type)r[c]=ZI(r[c],e.name,n);else if(n==null)for(c in r)r[c]=ZI(r[c],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new XS(e)},call:function(e,n){if((c=arguments.length-2)>0)for(var r=new Array(c),o=0,c,l;o<c;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],o=0,c=l.length;o<c;++o)l[o].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],c=0,l=o.length;c<l;++c)o[c].value.apply(n,r)}};function Mj(t,e){for(var n=0,r=t.length,o;n<r;++n)if((o=t[n]).name===e)return o.value}function ZI(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Tj,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Lj=UI,Ih=0,om=0,am=0,HI=1e3,qS,sm,KS=0,ff=0,QS=0,cm=typeof performance=="object"&&performance.now?performance:Date,VI=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function WI(){return ff||(VI(Pj),ff=cm.now()+QS)}function Pj(){ff=0}function x4(){this._call=this._time=this._next=null}x4.prototype=GI.prototype={constructor:x4,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?WI():+n)+(e==null?0:+e),!this._next&&sm!==this&&(sm?sm._next=this:qS=this,sm=this),this._call=t,this._time=n,S4()},stop:function(){this._call&&(this._call=null,this._time=1/0,S4())}};function GI(t,e,n){var r=new x4;return r.restart(t,e,n),r}function Ij(){WI(),++Ih;for(var t=qS,e;t;)(e=ff-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ih}function YI(){ff=(KS=cm.now())+QS,Ih=om=0;try{Ij()}finally{Ih=0,kj(),ff=0}}function Rj(){var t=cm.now(),e=t-KS;e>HI&&(QS-=e,KS=t)}function kj(){for(var t,e=qS,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:qS=n);sm=t,S4(r)}function S4(t){if(!Ih){om&&(om=clearTimeout(om));var e=t-ff;e>24?(t<1/0&&(om=setTimeout(YI,t-cm.now()-QS)),am&&(am=clearInterval(am))):(am||(KS=cm.now(),am=setInterval(Rj,HI)),Ih=1,VI(YI))}}const Dj=1664525,Fj=1013904223,$I=4294967296;function Nj(){let t=1;return()=>(t=(Dj*t+Fj)%$I)/$I}function Bj(t){return t.x}function jj(t){return t.y}var zj=10,Uj=Math.PI*(3-Math.sqrt(5));function Zj(t){var e,n=1,r=.001,o=1-Math.pow(r,1/300),c=0,l=.6,u=new Map,d=GI(v),h=Lj("tick","end"),p=Nj();t==null&&(t=[]);function v(){m(),h.call("tick",e),n<r&&(d.stop(),h.call("end",e))}function m(S){var E,w=t.length,M;S===void 0&&(S=1);for(var L=0;L<S;++L)for(n+=(c-n)*o,u.forEach(function(I){I(n)}),E=0;E<w;++E)M=t[E],M.fx==null?M.x+=M.vx*=l:(M.x=M.fx,M.vx=0),M.fy==null?M.y+=M.vy*=l:(M.y=M.fy,M.vy=0);return e}function b(){for(var S=0,E=t.length,w;S<E;++S){if(w=t[S],w.index=S,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),isNaN(w.x)||isNaN(w.y)){var M=zj*Math.sqrt(.5+S),L=S*Uj;w.x=M*Math.cos(L),w.y=M*Math.sin(L)}(isNaN(w.vx)||isNaN(w.vy))&&(w.vx=w.vy=0)}}function x(S){return S.initialize&&S.initialize(t,p),S}return b(),e={tick:m,restart:function(){return d.restart(v),e},stop:function(){return d.stop(),e},nodes:function(S){return arguments.length?(t=S,b(),u.forEach(x),e):t},alpha:function(S){return arguments.length?(n=+S,e):n},alphaMin:function(S){return arguments.length?(r=+S,e):r},alphaDecay:function(S){return arguments.length?(o=+S,e):+o},alphaTarget:function(S){return arguments.length?(c=+S,e):c},velocityDecay:function(S){return arguments.length?(l=1-S,e):1-l},randomSource:function(S){return arguments.length?(p=S,u.forEach(x),e):p},force:function(S,E){return arguments.length>1?(E==null?u.delete(S):u.set(S,x(E)),e):u.get(S)},find:function(S,E,w){var M=0,L=t.length,I,R,z,W,Y;for(w==null?w=1/0:w*=w,M=0;M<L;++M)W=t[M],I=S-W.x,R=E-W.y,z=I*I+R*R,z<w&&(Y=W,w=z);return Y},on:function(S,E){return arguments.length>1?(h.on(S,E),e):h.on(S)}}}function Hj(){var t,e,n,r,o=Jo(-30),c,l=1,u=1/0,d=.81;function h(b){var x,S=t.length,E=jI(t,Bj,jj).visitAfter(v);for(r=b,x=0;x<S;++x)e=t[x],E.visit(m)}function p(){if(t){var b,x=t.length,S;for(c=new Array(x),b=0;b<x;++b)S=t[b],c[S.index]=+o(S,b,t)}}function v(b){var x=0,S,E,w=0,M,L,I;if(b.length){for(M=L=I=0;I<4;++I)(S=b[I])&&(E=Math.abs(S.value))&&(x+=S.value,w+=E,M+=E*S.x,L+=E*S.y);b.x=M/w,b.y=L/w}else{S=b,S.x=S.data.x,S.y=S.data.y;do x+=c[S.data.index];while(S=S.next)}b.value=x}function m(b,x,S,E){if(!b.value)return!0;var w=b.x-e.x,M=b.y-e.y,L=E-x,I=w*w+M*M;if(L*L/d<I)return I<u&&(w===0&&(w=Ph(n),I+=w*w),M===0&&(M=Ph(n),I+=M*M),I<l&&(I=Math.sqrt(l*I)),e.vx+=w*b.value*r/I,e.vy+=M*b.value*r/I),!0;if(b.length||I>=u)return;(b.data!==e||b.next)&&(w===0&&(w=Ph(n),I+=w*w),M===0&&(M=Ph(n),I+=M*M),I<l&&(I=Math.sqrt(l*I)));do b.data!==e&&(L=c[b.data.index]*r/I,e.vx+=w*L,e.vy+=M*L);while(b=b.next)}return h.initialize=function(b,x){t=b,n=x,p()},h.strength=function(b){return arguments.length?(o=typeof b=="function"?b:Jo(+b),p(),h):o},h.distanceMin=function(b){return arguments.length?(l=b*b,h):Math.sqrt(l)},h.distanceMax=function(b){return arguments.length?(u=b*b,h):Math.sqrt(u)},h.theta=function(b){return arguments.length?(d=b*b,h):Math.sqrt(d)},h}function Vj(t){return t.index}function XI(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Wj(t){var e=Vj,n=v,r,o=Jo(30),c,l,u,d,h,p=1;t==null&&(t=[]);function v(E){return 1/Math.min(u[E.source.index],u[E.target.index])}function m(E){for(var w=0,M=t.length;w<p;++w)for(var L=0,I,R,z,W,Y,st,xt;L<M;++L)I=t[L],R=I.source,z=I.target,W=z.x+z.vx-R.x-R.vx||Ph(h),Y=z.y+z.vy-R.y-R.vy||Ph(h),st=Math.sqrt(W*W+Y*Y),st=(st-c[L])/st*E*r[L],W*=st,Y*=st,z.vx-=W*(xt=d[L]),z.vy-=Y*xt,R.vx+=W*(xt=1-xt),R.vy+=Y*xt}function b(){if(l){var E,w=l.length,M=t.length,L=new Map(l.map((R,z)=>[e(R,z,l),R])),I;for(E=0,u=new Array(w);E<M;++E)I=t[E],I.index=E,typeof I.source!="object"&&(I.source=XI(L,I.source)),typeof I.target!="object"&&(I.target=XI(L,I.target)),u[I.source.index]=(u[I.source.index]||0)+1,u[I.target.index]=(u[I.target.index]||0)+1;for(E=0,d=new Array(M);E<M;++E)I=t[E],d[E]=u[I.source.index]/(u[I.source.index]+u[I.target.index]);r=new Array(M),x(),c=new Array(M),S()}}function x(){if(l)for(var E=0,w=t.length;E<w;++E)r[E]=+n(t[E],E,t)}function S(){if(l)for(var E=0,w=t.length;E<w;++E)c[E]=+o(t[E],E,t)}return m.initialize=function(E,w){l=E,h=w,b()},m.links=function(E){return arguments.length?(t=E,b(),m):t},m.id=function(E){return arguments.length?(e=E,m):e},m.iterations=function(E){return arguments.length?(p=+E,m):p},m.strength=function(E){return arguments.length?(n=typeof E=="function"?E:Jo(+E),x(),m):n},m.distance=function(E){return arguments.length?(o=typeof E=="function"?E:Jo(+E),S(),m):o},m}function Gj(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function o(){var c,l=n.length,u,d=0,h=0;for(c=0;c<l;++c)u=n[c],d+=u.x,h+=u.y;for(d=(d/l-t)*r,h=(h/l-e)*r,c=0;c<l;++c)u=n[c],u.x-=d,u.y-=h}return o.initialize=function(c){n=c},o.x=function(c){return arguments.length?(t=+c,o):t},o.y=function(c){return arguments.length?(e=+c,o):e},o.strength=function(c){return arguments.length?(r=+c,o):r},o}function Yj(t){var e=Jo(.1),n,r,o;typeof t!="function"&&(t=Jo(t==null?0:+t));function c(u){for(var d=0,h=n.length,p;d<h;++d)p=n[d],p.vx+=(o[d]-p.x)*r[d]*u}function l(){if(n){var u,d=n.length;for(r=new Array(d),o=new Array(d),u=0;u<d;++u)r[u]=isNaN(o[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return c.initialize=function(u){n=u,l()},c.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Jo(+u),l(),c):e},c.x=function(u){return arguments.length?(t=typeof u=="function"?u:Jo(+u),l(),c):t},c}function $j(t){var e=Jo(.1),n,r,o;typeof t!="function"&&(t=Jo(t==null?0:+t));function c(u){for(var d=0,h=n.length,p;d<h;++d)p=n[d],p.vy+=(o[d]-p.y)*r[d]*u}function l(){if(n){var u,d=n.length;for(r=new Array(d),o=new Array(d),u=0;u<d;++u)r[u]=isNaN(o[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return c.initialize=function(u){n=u,l()},c.strength=function(u){return arguments.length?(e=typeof u=="function"?u:Jo(+u),l(),c):e},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:Jo(+u),l(),c):t},c}var Xj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const qj={joint:!0},Kj={type:"link",axis:!1,legend:!1,encode:{x:[t=>t.source.x,t=>t.target.x],y:[t=>t.source.y,t=>t.target.y]},style:{stroke:"#999",strokeOpacity:.6}},Qj={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},Jj={text:""};function tz(t,e,n){const{nodes:r,links:o}=t,{joint:c,nodeStrength:l,linkStrength:u}=e,{nodeKey:d=x=>x.id,linkKey:h=x=>x.id}=n,p=Hj(),v=Wj(o).id(ga(h));typeof l=="function"&&p.strength(l),typeof u=="function"&&v.strength(u);const m=Zj(r).force("link",v).force("charge",p);c?m.force("center",Gj()):m.force("x",Yj()).force("y",$j()),m.stop();const b=Math.ceil(Math.log(m.alphaMin())/Math.log(1-m.alphaDecay()));for(let x=0;x<b;x++)m.tick();return{nodesData:r,linksData:o}}const qI=t=>{const{data:e,encode:n={},scale:r,style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={}}=t,{nodeKey:p=z=>z.id,linkKey:v=z=>z.id}=n,m=Xj(n,["nodeKey","linkKey"]),b=Object.assign({nodeKey:p,linkKey:v},m),x=bn(b,"node"),S=bn(b,"link"),{links:E,nodes:w}=Qg(e,b),{nodesData:M,linksData:L}=tz({links:E,nodes:w},en({},qj,c),b),I=Yo(h,"link",{items:[z=>({name:"source",value:ga(v)(z.source)}),z=>({name:"target",value:ga(v)(z.target)})]}),R=Yo(h,"node",{items:[z=>({name:"key",value:ga(p)(z)})]},!0);return[en({},Kj,{data:L,encode:S,labels:u,style:bn(o,"link"),tooltip:I,animate:ha(d,"link")}),en({},Qj,{data:M,encode:Object.assign({},x),scale:r,style:bn(o,"node"),tooltip:R,labels:[Object.assign(Object.assign({},Jj),bn(o,"label")),...l],animate:ha(d,"link")})]};qI.props={};function ez(t,e){return t.parent===e.parent?1:2}function O4(t){var e=t.children;return e?e[0]:t.t}function E4(t){var e=t.children;return e?e[e.length-1]:t.t}function nz(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function rz(t){for(var e=0,n=0,r=t.children,o=r.length,c;--o>=0;)c=r[o],c.z+=e,c.m+=e,e+=c.s+(n+=c.c)}function iz(t,e,n){return t.a.parent===e.parent?t.a:n}function JS(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}JS.prototype=Object.create(rl.prototype);function oz(t){for(var e=new JS(t,0),n,r=[e],o,c,l,u;n=r.pop();)if(c=n._.children)for(n.children=new Array(u=c.length),l=u-1;l>=0;--l)r.push(o=n.children[l]=new JS(c[l],l)),o.parent=n;return(e.parent=new JS(null,0)).children=[e],e}function az(){var t=ez,e=1,n=1,r=null;function o(h){var p=oz(h);if(p.eachAfter(c),p.parent.m=-p.z,p.eachBefore(l),r)h.eachBefore(d);else{var v=h,m=h,b=h;h.eachBefore(function(M){M.x<v.x&&(v=M),M.x>m.x&&(m=M),M.depth>b.depth&&(b=M)});var x=v===m?1:t(v,m)/2,S=x-v.x,E=e/(m.x+x+S),w=n/(b.depth||1);h.eachBefore(function(M){M.x=(M.x+S)*E,M.y=M.depth*w})}return h}function c(h){var p=h.children,v=h.parent.children,m=h.i?v[h.i-1]:null;if(p){rz(h);var b=(p[0].z+p[p.length-1].z)/2;m?(h.z=m.z+t(h._,m._),h.m=h.z-b):h.z=b}else m&&(h.z=m.z+t(h._,m._));h.parent.A=u(h,m,h.parent.A||v[0])}function l(h){h._.x=h.z+h.parent.m,h.m+=h.parent.m}function u(h,p,v){if(p){for(var m=h,b=h,x=p,S=m.parent.children[0],E=m.m,w=b.m,M=x.m,L=S.m,I;x=E4(x),m=O4(m),x&&m;)S=O4(S),b=E4(b),b.a=h,I=x.z+M-m.z-E+t(x._,m._),I>0&&(nz(iz(x,h,v),h,I),E+=I,w+=I),M+=x.m,E+=m.m,L+=S.m,w+=b.m;x&&!E4(b)&&(b.t=x,b.m+=M-w),m&&!O4(S)&&(S.t=m,S.m+=E-L,v=h)}return v}function d(h){h.x*=e,h.y=h.depth*n}return o.separation=function(h){return arguments.length?(t=h,o):t},o.size=function(h){return arguments.length?(r=!1,e=+h[0],n=+h[1],o):r?null:[e,n]},o.nodeSize=function(h){return arguments.length?(r=!0,e=+h[0],n=+h[1],o):r?[e,n]:null},o}function sz(t,e){return t.parent===e.parent?1:2}function cz(t){return t.reduce(lz,0)/t.length}function lz(t,e){return t+e.x}function uz(t){return 1+t.reduce(fz,0)}function fz(t,e){return Math.max(t,e.y)}function dz(t){for(var e;e=t.children;)t=e[0];return t}function hz(t){for(var e;e=t.children;)t=e[e.length-1];return t}function pz(){var t=sz,e=1,n=1,r=!1;function o(c){var l,u=0;c.eachAfter(function(m){var b=m.children;b?(m.x=cz(b),m.y=uz(b)):(m.x=l?u+=t(m,l):0,m.y=0,l=m)});var d=dz(c),h=hz(c),p=d.x-t(d,h)/2,v=h.x+t(h,d)/2;return c.eachAfter(r?function(m){m.x=(m.x-c.x)*e,m.y=(c.y-m.y)*n}:function(m){m.x=(m.x-p)/(v-p)*e,m.y=(1-(c.y?m.y/c.y:1))*n})}return o.separation=function(c){return arguments.length?(t=c,o):t},o.size=function(c){return arguments.length?(r=!1,e=+c[0],n=+c[1],o):r?null:[e,n]},o.nodeSize=function(c){return arguments.length?(r=!0,e=+c[0],n=+c[1],o):r?[e,n]:null},o}const KI=t=>e=>n=>{const{field:r="value",nodeSize:o,separation:c,sortBy:l,as:u=["x","y"]}=e,[d,h]=u,p=Gu(n,x=>x.children).sum(x=>x[r]).sort(l),v=t();v.size([1,1]),o&&v.nodeSize(o),c&&v.separation(c),v(p);const m=[];p.each(x=>{x[d]=x.x,x[h]=x.y,x.name=x.data.name,m.push(x)});const b=p.links();return b.forEach(x=>{x[d]=[x.source[d],x.target[d]],x[h]=[x.source[h],x.target[h]]}),{nodes:m,edges:b}},QI=t=>KI(pz)(t);QI.props={};const JI=t=>KI(az)(t);JI.props={};const gz={sortBy:(t,e)=>e.value-t.value},vz={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},mz={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},yz={text:"",fontSize:10},tR=t=>{const{data:e,encode:n={},scale:r={},style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={}}=t,p=n==null?void 0:n.value,{nodes:v,edges:m}=JI(Object.assign(Object.assign(Object.assign({},gz),c),{field:p}))(e),b=Yo(h,"node",{title:"name",items:["value"]},!0),x=Yo(h,"link",{title:"",items:[S=>({name:"source",value:S.source.name}),S=>({name:"target",value:S.target.name})]});return[en({},mz,{data:m,encode:bn(n,"link"),scale:bn(r,"link"),labels:u,style:Object.assign({stroke:"#999"},bn(o,"link")),tooltip:x,animate:ha(d,"link")}),en({},vz,{data:v,scale:bn(r,"node"),encode:bn(n,"node"),labels:[Object.assign(Object.assign({},yz),bn(o,"label")),...l],style:Object.assign({},bn(o,"node")),tooltip:b,animate:ha(d,"node")})]};tR.props={};var bz=1664525,_z=1013904223,eR=4294967296;function xz(){var t=1;return function(){return(t=(bz*t+_z)%eR)/eR}}var Sz=k(52677);function Oz(t){return Sz(t)==="object"&&"length"in t?t:Array.from(t)}function Ez(t,e){for(var n=t.length,r,o;n;)o=e()*n--|0,r=t[n],t[n]=t[o],t[o]=r;return t}function GV(t){return nR(t,lcg())}function nR(t,e){for(var n=0,r=(t=Ez(Array.from(t),e)).length,o=[],c,l;n<r;)c=t[n],l&&rR(l,c)?++n:(l=Az(o=wz(o,c)),n=0);return l}function wz(t,e){var n,r;if(w4(e,t))return[e];for(n=0;n<t.length;++n)if(tO(e,t[n])&&w4(lm(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(tO(lm(t[n],t[r]),e)&&tO(lm(t[n],e),t[r])&&tO(lm(t[r],e),t[n])&&w4(iR(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function tO(t,e){var n=t.r-e.r,r=e.x-t.x,o=e.y-t.y;return n<0||n*n<r*r+o*o}function rR(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,o=e.y-t.y;return n>0&&n*n>r*r+o*o}function w4(t,e){for(var n=0;n<e.length;++n)if(!rR(t,e[n]))return!1;return!0}function Az(t){switch(t.length){case 1:return Tz(t[0]);case 2:return lm(t[0],t[1]);case 3:return iR(t[0],t[1],t[2])}}function Tz(t){return{x:t.x,y:t.y,r:t.r}}function lm(t,e){var n=t.x,r=t.y,o=t.r,c=e.x,l=e.y,u=e.r,d=c-n,h=l-r,p=u-o,v=Math.sqrt(d*d+h*h);return{x:(n+c+d/v*p)/2,y:(r+l+h/v*p)/2,r:(v+o+u)/2}}function iR(t,e,n){var r=t.x,o=t.y,c=t.r,l=e.x,u=e.y,d=e.r,h=n.x,p=n.y,v=n.r,m=r-l,b=r-h,x=o-u,S=o-p,E=d-c,w=v-c,M=r*r+o*o-c*c,L=M-l*l-u*u+d*d,I=M-h*h-p*p+v*v,R=b*x-m*S,z=(x*I-S*L)/(R*2)-r,W=(S*E-x*w)/R,Y=(b*L-m*I)/(R*2)-o,st=(m*w-b*E)/R,xt=W*W+st*st-1,Nt=2*(c+z*W+Y*st),Ht=z*z+Y*Y-c*c,dt=-(Math.abs(xt)>1e-6?(Nt+Math.sqrt(Nt*Nt-4*xt*Ht))/(2*xt):Ht/Nt);return{x:r+z+W*dt,y:o+Y+st*dt,r:dt}}function oR(t,e,n){var r=t.x-e.x,o,c,l=t.y-e.y,u,d,h=r*r+l*l;h?(c=e.r+n.r,c*=c,d=t.r+n.r,d*=d,c>d?(o=(h+d-c)/(2*h),u=Math.sqrt(Math.max(0,d/h-o*o)),n.x=t.x-o*r-u*l,n.y=t.y-o*l+u*r):(o=(h+c-d)/(2*h),u=Math.sqrt(Math.max(0,c/h-o*o)),n.x=e.x+o*r-u*l,n.y=e.y+o*l+u*r)):(n.x=e.x+n.r,n.y=e.y)}function aR(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,o=e.y-t.y;return n>0&&n*n>r*r+o*o}function sR(t){var e=t._,n=t.next._,r=e.r+n.r,o=(e.x*n.r+n.x*e.r)/r,c=(e.y*n.r+n.y*e.r)/r;return o*o+c*c}function eO(t){this._=t,this.next=null,this.previous=null}function cR(t,e){if(!(c=(t=Oz(t)).length))return 0;var n,r,o,c,l,u,d,h,p,v,m;if(n=t[0],n.x=0,n.y=0,!(c>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(c>2))return n.r+r.r;oR(r,n,o=t[2]),n=new eO(n),r=new eO(r),o=new eO(o),n.next=o.previous=r,r.next=n.previous=o,o.next=r.previous=n;t:for(d=3;d<c;++d){oR(n._,r._,o=t[d]),o=new eO(o),h=r.next,p=n.previous,v=r._.r,m=n._.r;do if(v<=m){if(aR(h._,o._)){r=h,n.next=r,r.previous=n,--d;continue t}v+=h._.r,h=h.next}else{if(aR(p._,o._)){n=p,n.next=r,r.previous=n,--d;continue t}m+=p._.r,p=p.previous}while(h!==p.next);for(o.previous=n,o.next=r,n.next=r.previous=r=o,l=sR(n);(o=o.next)!==r;)(u=sR(o))<l&&(n=o,l=u);r=n.next}for(n=[r._],o=r;(o=o.next)!==r;)n.push(o._);for(o=nR(n,e),d=0;d<c;++d)n=t[d],n.x-=o.x,n.y-=o.y;return o.r}function YV(t){return cR(t,lcg()),t}function Cz(t){return Math.sqrt(t.value)}function Mz(){var t=null,e=1,n=1,r=lf;function o(c){var l=xz();return c.x=e/2,c.y=n/2,t?c.eachBefore(lR(t)).eachAfter(A4(r,.5,l)).eachBefore(uR(1)):c.eachBefore(lR(Cz)).eachAfter(A4(lf,1,l)).eachAfter(A4(r,c.r/Math.min(e,n),l)).eachBefore(uR(Math.min(e,n)/(2*c.r))),c}return o.radius=function(c){return arguments.length?(t=yS(c),o):t},o.size=function(c){return arguments.length?(e=+c[0],n=+c[1],o):[e,n]},o.padding=function(c){return arguments.length?(r=typeof c=="function"?c:Eh(+c),o):r},o}function lR(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function A4(t,e,n){return function(r){if(o=r.children){var o,c,l=o.length,u=t(r)*e||0,d;if(u)for(c=0;c<l;++c)o[c].r+=u;if(d=cR(o,n),u)for(c=0;c<l;++c)o[c].r-=u;r.r=d+u}}}function uR(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var Lz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Pz=(t,e)=>({size:[t,e],padding:0,sort:(n,r)=>r.value-n.value}),Iz=(t,e,n)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,t]},y:{domain:[0,e]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:n.color?void 0:r=>r.height===0?"#ddd":"#fff",stroke:n.color?void 0:r=>r.height===0?"":"#000"}}),Rz={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.r*2},kz={title:t=>t.data.name,items:[{field:"value"}]},Dz=(t,e,n)=>{const{value:r}=n,o=(0,mi.Z)(t)?bM().path(e.path)(t):Gu(t);return r?o.sum(c=>ga(r)(c)).sort(e.sort):o.count(),Mz().size(e.size).padding(e.padding)(o),o.descendants()},fR=(t,e)=>{const{width:n,height:r}=e,{data:o,encode:c={},scale:l={},style:u={},layout:d={},labels:h=[],tooltip:p={}}=t,v=Lz(t,["data","encode","scale","style","layout","labels","tooltip"]),m=Iz(n,r,c),b=Dz(o,en({},Pz(n,r),d),en({},m.encode,c)),x=bn(u,"label");return en({},m,Object.assign(Object.assign({data:b,encode:c,scale:l,style:u,labels:[Object.assign(Object.assign({},Rz),x),...h]},v),{tooltip:Ba(p,kz),axis:!1}))};fR.props={};function Fz(t){return t.target.depth}function Nz(t){return t.depth}function Bz(t,e){return e-1-t.height}function nO(t,e){return t.sourceLinks.length?t.depth:e-1}function jz(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?So(t.sourceLinks,Fz)-1:0}function rO(t){return function(){return t}}function dR(t,e){return iO(t.source,e.source)||t.index-e.index}function hR(t,e){return iO(t.target,e.target)||t.index-e.index}function iO(t,e){return t.y0-e.y0}function T4(t){return t.value}function zz(t){return t.index}function Uz(t){return t.nodes}function Zz(t){return t.links}function pR(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function gR({nodes:t}){for(const e of t){let n=e.y0,r=n;for(const o of e.sourceLinks)o.y0=n+o.width/2,n+=o.width;for(const o of e.targetLinks)o.y1=r+o.width/2,r+=o.width}}function Hz(){let t=0,e=0,n=1,r=1,o=24,c=8,l,u=zz,d=nO,h,p,v,m=Uz,b=Zz,x=6;function S(wt){const oe={nodes:m(wt),links:b(wt)};return E(oe),w(oe),M(oe),L(oe),z(oe),gR(oe),oe}S.update=function(wt){return gR(wt),wt},S.nodeId=function(wt){return arguments.length?(u=typeof wt=="function"?wt:rO(wt),S):u},S.nodeAlign=function(wt){return arguments.length?(d=typeof wt=="function"?wt:rO(wt),S):d},S.nodeDepth=function(wt){return arguments.length?(h=wt,S):h},S.nodeSort=function(wt){return arguments.length?(p=wt,S):p},S.nodeWidth=function(wt){return arguments.length?(o=+wt,S):o},S.nodePadding=function(wt){return arguments.length?(c=l=+wt,S):c},S.nodes=function(wt){return arguments.length?(m=typeof wt=="function"?wt:rO(wt),S):m},S.links=function(wt){return arguments.length?(b=typeof wt=="function"?wt:rO(wt),S):b},S.linkSort=function(wt){return arguments.length?(v=wt,S):v},S.size=function(wt){return arguments.length?(t=e=0,n=+wt[0],r=+wt[1],S):[n-t,r-e]},S.extent=function(wt){return arguments.length?(t=+wt[0][0],n=+wt[1][0],e=+wt[0][1],r=+wt[1][1],S):[[t,e],[n,r]]},S.iterations=function(wt){return arguments.length?(x=+wt,S):x};function E({nodes:wt,links:oe}){wt.forEach((Kt,me)=>{Kt.index=me,Kt.sourceLinks=[],Kt.targetLinks=[]});const Ut=new Map(wt.map(Kt=>[u(Kt),Kt]));if(oe.forEach((Kt,me)=>{Kt.index=me;let{source:Ee,target:Pe}=Kt;typeof Ee!="object"&&(Ee=Kt.source=pR(Ut,Ee)),typeof Pe!="object"&&(Pe=Kt.target=pR(Ut,Pe)),Ee.sourceLinks.push(Kt),Pe.targetLinks.push(Kt)}),v!=null)for(const{sourceLinks:Kt,targetLinks:me}of wt)Kt.sort(v),me.sort(v)}function w({nodes:wt}){for(const oe of wt)oe.value=oe.fixedValue===void 0?Math.max(Vo(oe.sourceLinks,T4),Vo(oe.targetLinks,T4)):oe.fixedValue}function M({nodes:wt}){const oe=wt.length;let Ut=new Set(wt),Kt=new Set,me=0;for(;Ut.size;){if(Ut.forEach(Ee=>{Ee.depth=me;for(const{target:Pe}of Ee.sourceLinks)Kt.add(Pe)}),++me>oe)throw new Error("circular link");Ut=Kt,Kt=new Set}if(h){const Ee=Math.max(Or(wt,Ie=>Ie.depth)+1,0);let Pe;for(let Ie=0;Ie<wt.length;Ie++)Pe=wt[Ie],Pe.depth=h.call(null,Pe,Ee)}}function L({nodes:wt}){const oe=wt.length;let Ut=new Set(wt),Kt=new Set,me=0;for(;Ut.size;){if(Ut.forEach(Ee=>{Ee.height=me;for(const{source:Pe}of Ee.targetLinks)Kt.add(Pe)}),++me>oe)throw new Error("circular link");Ut=Kt,Kt=new Set}}function I({nodes:wt}){const oe=Math.max(Or(wt,me=>me.depth)+1,0),Ut=(n-t-o)/(oe-1),Kt=new Array(oe).fill(0).map(()=>[]);for(const me of wt){const Ee=Math.max(0,Math.min(oe-1,Math.floor(d.call(null,me,oe))));me.layer=Ee,me.x0=t+Ee*Ut,me.x1=me.x0+o,Kt[Ee]?Kt[Ee].push(me):Kt[Ee]=[me]}if(p)for(const me of Kt)me.sort(p);return Kt}function R(wt){const oe=So(wt,Ut=>(r-e-(Ut.length-1)*l)/Vo(Ut,T4));for(const Ut of wt){let Kt=e;for(const me of Ut){me.y0=Kt,me.y1=Kt+me.value*oe,Kt=me.y1+l;for(const Ee of me.sourceLinks)Ee.width=Ee.value*oe}Kt=(r-Kt+l)/(Ut.length+1);for(let me=0;me<Ut.length;++me){const Ee=Ut[me];Ee.y0+=Kt*(me+1),Ee.y1+=Kt*(me+1)}dt(Ut)}}function z(wt){const oe=I(wt);l=Math.min(c,(r-e)/(Or(oe,Ut=>Ut.length)-1)),R(oe);for(let Ut=0;Ut<x;++Ut){const Kt=Math.pow(.99,Ut),me=Math.max(1-Kt,(Ut+1)/x);Y(oe,Kt,me),W(oe,Kt,me)}}function W(wt,oe,Ut){for(let Kt=1,me=wt.length;Kt<me;++Kt){const Ee=wt[Kt];for(const Pe of Ee){let Ie=0,qe=0;for(const{source:yn,value:on}of Pe.targetLinks){const rn=on*(Pe.layer-yn.layer);Ie+=Ot(yn,Pe)*rn,qe+=rn}if(!(qe>0))continue;const sn=(Ie/qe-Pe.y0)*oe;Pe.y0+=sn,Pe.y1+=sn,Ht(Pe)}p===void 0&&Ee.sort(iO),Ee.length&&st(Ee,Ut)}}function Y(wt,oe,Ut){for(let Kt=wt.length,me=Kt-2;me>=0;--me){const Ee=wt[me];for(const Pe of Ee){let Ie=0,qe=0;for(const{target:yn,value:on}of Pe.sourceLinks){const rn=on*(yn.layer-Pe.layer);Ie+=bt(Pe,yn)*rn,qe+=rn}if(!(qe>0))continue;const sn=(Ie/qe-Pe.y0)*oe;Pe.y0+=sn,Pe.y1+=sn,Ht(Pe)}p===void 0&&Ee.sort(iO),Ee.length&&st(Ee,Ut)}}function st(wt,oe){const Ut=wt.length>>1,Kt=wt[Ut];Nt(wt,Kt.y0-l,Ut-1,oe),xt(wt,Kt.y1+l,Ut+1,oe),Nt(wt,r,wt.length-1,oe),xt(wt,e,0,oe)}function xt(wt,oe,Ut,Kt){for(;Ut<wt.length;++Ut){const me=wt[Ut],Ee=(oe-me.y0)*Kt;Ee>1e-6&&(me.y0+=Ee,me.y1+=Ee),oe=me.y1+l}}function Nt(wt,oe,Ut,Kt){for(;Ut>=0;--Ut){const me=wt[Ut],Ee=(me.y1-oe)*Kt;Ee>1e-6&&(me.y0-=Ee,me.y1-=Ee),oe=me.y0-l}}function Ht({sourceLinks:wt,targetLinks:oe}){if(v===void 0){for(const{source:{sourceLinks:Ut}}of oe)Ut.sort(hR);for(const{target:{targetLinks:Ut}}of wt)Ut.sort(dR)}}function dt(wt){if(v===void 0)for(const{sourceLinks:oe,targetLinks:Ut}of wt)oe.sort(hR),Ut.sort(dR)}function Ot(wt,oe){let Ut=wt.y0-(wt.sourceLinks.length-1)*l/2;for(const{target:Kt,width:me}of wt.sourceLinks){if(Kt===oe)break;Ut+=me+l}for(const{source:Kt,width:me}of oe.targetLinks){if(Kt===wt)break;Ut-=me}return Ut}function bt(wt,oe){let Ut=oe.y0-(oe.targetLinks.length-1)*l/2;for(const{source:Kt,width:me}of oe.targetLinks){if(Kt===wt)break;Ut+=me+l}for(const{target:Kt,width:me}of wt.sourceLinks){if(Kt===oe)break;Ut-=me}return Ut}return S}const Vz={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:t=>t.nodes,links:t=>t.links,nodeSort:void 0,linkSort:void 0,iterations:6},Wz={left:Nz,right:Bz,center:jz,justify:nO};function Gz(t){const e=typeof t;return e==="string"?Wz[t]||nO:e==="function"?t:nO}const vR=t=>e=>{const{nodeId:n,nodeSort:r,nodeAlign:o,nodeWidth:c,nodePadding:l,nodeDepth:u,nodes:d,links:h,linkSort:p,iterations:v}=Object.assign({},Vz,t),m=Hz().nodeSort(r).linkSort(p).links(h).nodes(d).nodeWidth(c).nodePadding(l).nodeDepth(u).nodeAlign(Gz(o)).iterations(v).extent([[0,0],[1,1]]);typeof n=="function"&&m.nodeId(n);const b=m(e),{nodes:x,links:S}=b,E=x.map(M=>{const{x0:L,x1:I,y0:R,y1:z}=M;return Object.assign(Object.assign({},M),{x:[L,I,I,L],y:[R,R,z,z]})}),w=S.map(M=>{const{source:L,target:I}=M,R=L.x1,z=I.x0,W=M.width/2;return Object.assign(Object.assign({},M),{x:[R,R,z,z],y:[M.y0+W,M.y0-W,M.y1+W,M.y1-W]})});return{nodes:E,links:w}};vR.props={};var Yz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const $z={nodeId:t=>t.key,nodeWidth:.02,nodePadding:.02},Xz={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},qz={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},Kz={textAlign:t=>t.x[0]<.5?"start":"end",position:t=>t.x[0]<.5?"right":"left",fontSize:10},mR=t=>{const{data:e,encode:n={},scale:r,style:o={},layout:c={},nodeLabels:l=[],linkLabels:u=[],animate:d={},tooltip:h={},interaction:p}=t,{links:v,nodes:m}=Qg(e,n),b=bn(n,"node"),x=bn(n,"link"),{key:S=xt=>xt.key,color:E=S}=b,{links:w,nodes:M}=vR(Object.assign(Object.assign(Object.assign({},$z),{nodeId:ga(S)}),c))({links:v,nodes:m}),L=bn(o,"label"),{text:I=S,spacing:R=5}=L,z=Yz(L,["text","spacing"]),W=ga(S),Y=Yo(h,"node",{title:W,items:[{field:"value"}]},!0),st=Yo(h,"link",{title:"",items:[xt=>({name:"source",value:W(xt.source)}),xt=>({name:"target",value:W(xt.target)})]});return[en({},Xz,{data:M,encode:Object.assign(Object.assign({},b),{color:E}),scale:r,style:bn(o,"node"),labels:[Object.assign(Object.assign(Object.assign({},Kz),{text:I,dx:xt=>xt.x[0]<.5?R:-R}),z),...l],tooltip:Y,animate:ha(d,"node"),axis:!1,interaction:p}),en({},qz,{data:w,encode:x,labels:u,style:Object.assign({fill:x.color?void 0:"#aaa",lineWidth:0},bn(o,"link")),tooltip:st,animate:ha(d,"link"),interaction:p})]};mR.props={};function Qz(t,e){return e.value-t.value}function Jz(t,e){return e.frequency-t.frequency}function tU(t,e){return`${t.id}`.localeCompare(`${e.id}`)}function eU(t,e){return`${t.name}`.localeCompare(`${e.name}`)}const nU={y:0,thickness:.05,weight:!1,marginRatio:.1,id:t=>t.id,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null};function rU(t){const{y:e,thickness:n,weight:r,marginRatio:o,id:c,source:l,target:u,sourceWeight:d,targetWeight:h,sortBy:p}=Object.assign(Object.assign({},nU),t);function v(E){const w=E.nodes.map(L=>Object.assign({},L)),M=E.edges.map(L=>Object.assign({},L));return m(w,M),b(w,M),x(w,M),S(w,M),{nodes:w,edges:M}}function m(E,w){w.forEach(I=>{I.source=l(I),I.target=u(I),I.sourceWeight=d(I),I.targetWeight=h(I)});const M=Gr(w,I=>I.source),L=Gr(w,I=>I.target);return E.forEach(I=>{I.id=c(I);const R=M.has(I.id)?M.get(I.id):[],z=L.has(I.id)?L.get(I.id):[];I.frequency=R.length+z.length,I.value=Vo(R,W=>W.sourceWeight)+Vo(z,W=>W.targetWeight)}),{nodes:E,edges:w}}function b(E,w){const M=typeof p=="function"?p:qt[p];M&&E.sort(M)}function x(E,w){const M=E.length;if(!M)throw ws("Invalid nodes: it's empty!");if(!r){const R=1/M;return E.forEach((z,W)=>{z.x=(W+.5)*R,z.y=e}),{nodes:E,edges:w}}const L=o/(2*M),I=E.reduce((R,z)=>R+=z.value,0);return E.reduce((R,z)=>{z.weight=z.value/I,z.width=z.weight*(1-o),z.height=n;const W=L+R,Y=W+z.width,st=e-n/2,xt=st+n;return z.x=[W,Y,Y,W],z.y=[st,st,xt,xt],R+z.width+2*L},0),{nodes:E,edges:w}}function S(E,w){const M=new Map(E.map(R=>[R.id,R]));if(!r)return w.forEach(R=>{const z=l(R),W=u(R),Y=M.get(z),st=M.get(W);Y&&st&&(R.x=[Y.x,st.x],R.y=[Y.y,st.y])}),{nodes:E,edges:w};w.forEach(R=>{R.x=[0,0,0,0],R.y=[e,e,e,e]});const L=Gr(w,R=>R.source),I=Gr(w,R=>R.target);E.forEach(R=>{const{edges:z,width:W,x:Y,y:st,value:xt,id:Nt}=R,Ht=L.get(Nt)||[],dt=I.get(Nt)||[];let Ot=0;Ht.map(bt=>{const wt=bt.sourceWeight/xt*W;bt.x[0]=Y[0]+Ot,bt.x[1]=Y[0]+Ot+wt,Ot+=wt}),dt.forEach(bt=>{const wt=bt.targetWeight/xt*W;bt.x[3]=Y[0]+Ot,bt.x[2]=Y[0]+Ot+wt,Ot+=wt})})}return v}const C4=t=>e=>rU(t)(e);C4.props={};var yR=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const M4={y:0,thickness:.05,marginRatio:.1,id:t=>t.key,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null},iU={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},oU={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},aU={position:"outside",fontSize:10},bR=(t,e)=>{const{data:n,encode:r={},scale:o,style:c={},layout:l={},nodeLabels:u=[],linkLabels:d=[],animate:h={},tooltip:p={}}=t,{nodes:v,links:m}=Qg(n,r),b=bn(r,"node"),x=bn(r,"link"),{key:S=bt=>bt.key,color:E=S}=b,{linkEncodeColor:w=bt=>bt.source}=x,{nodeWidthRatio:M=M4.thickness,nodePaddingRatio:L=M4.marginRatio}=l,I=yR(l,["nodeWidthRatio","nodePaddingRatio"]),{nodes:R,edges:z}=C4(Object.assign(Object.assign(Object.assign(Object.assign({},M4),{id:ga(S),thickness:M,marginRatio:L}),I),{weight:!0}))({nodes:v,edges:m}),W=bn(c,"label"),{text:Y=S}=W,st=yR(W,["text"]),xt=Yo(p,"node",{title:"",items:[bt=>({name:bt.key,value:bt.value})]},!0),Nt=Yo(p,"link",{title:"",items:[bt=>({name:`${bt.source} -> ${bt.target}`,value:bt.value})]}),{height:Ht,width:dt}=e,Ot=Math.min(Ht,dt);return[en({},oU,{data:z,encode:Object.assign(Object.assign({},x),{color:w}),labels:d,style:Object.assign({fill:w?void 0:"#aaa"},bn(c,"link")),tooltip:Nt,animate:ha(h,"link")}),en({},iU,{data:R,encode:Object.assign(Object.assign({},b),{color:E}),scale:o,style:bn(c,"node"),coordinate:{type:"polar",outerRadius:(Ot-20)/Ot,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},aU),{text:Y}),st),...u],tooltip:xt,animate:ha(h,"node"),axis:!1})]};bR.props={};var sU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const cU=(t,e)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[t,e],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(n,r)=>r.value-n.value,layer:0}),lU=(t,e)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:n=>n.path[1]},scale:{x:{domain:[0,t],range:[0,1]},y:{domain:[0,e],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),uU={fontSize:10,text:t=>Lv(t.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.x1-t.x0},fU={title:t=>{var e,n;return(n=(e=t.path)===null||e===void 0?void 0:e.join)===null||n===void 0?void 0:n.call(e,".")},items:[{field:"value"}]},dU={title:t=>Lv(t.path),items:[{field:"value"}]},_R=(t,e)=>{const{width:n,height:r,options:o}=e,{data:c,encode:l={},scale:u,style:d={},layout:h={},labels:p=[],tooltip:v={}}=t,m=sU(t,["data","encode","scale","style","layout","labels","tooltip"]),b=hr(o,["interaction","treemapDrillDown"]),x=en({},cU(n,r),h,{layer:b?M=>M.depth===1:h.layer}),[S,E]=x7(c,x,l),w=bn(d,"label");return en({},lU(n,r),Object.assign(Object.assign({data:S,scale:u,style:d,labels:[Object.assign(Object.assign({},uU),w),...p]},m),{encode:l,tooltip:Ba(v,fU),axis:!1}),b?{interaction:Object.assign(Object.assign({},m.interaction),{treemapDrillDown:b?Object.assign(Object.assign({},b),{originData:E,layout:x}):void 0}),encode:Object.assign({color:M=>Lv(M.path)},l),tooltip:Ba(v,dU)}:{})};_R.props={};function hU(){return{"data.arc":C4,"data.cluster":QI,"mark.forceGraph":qI,"mark.tree":tR,"mark.pack":fR,"mark.sankey":mR,"mark.chord":bR,"mark.treemap":_R}}var xR=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function pU(t,e){return So(t,n=>e[n])}function gU(t,e){return Or(t,n=>e[n])}function SR(t,e){const n=L4(t,e)*2.5-P4(t,e)*1.5;return So(t,r=>e[r]>=n?e[r]:NaN)}function L4(t,e){return SS(t,.25,n=>e[n])}function vU(t,e){return SS(t,.5,n=>e[n])}function P4(t,e){return SS(t,.75,n=>e[n])}function OR(t,e){const n=P4(t,e)*2.5-L4(t,e)*1.5;return Or(t,r=>e[r]<=n?e[r]:NaN)}function mU(){return(t,e)=>{const{encode:n}=e,{y:r,x:o}=n,{value:c}=r,{value:l}=o;return[Array.from(Gr(t,h=>l[+h]).values()).flatMap(h=>{const p=SR(h,c),v=OR(h,c);return h.filter(m=>c[m]<p||c[m]>v)}),e]}}const ER=t=>{const{data:e,encode:n,style:r={},tooltip:o={},transform:c,animate:l}=t,u=xR(t,["data","encode","style","tooltip","transform","animate"]),{point:d=!0}=r,h=xR(r,["point"]),{y:p}=n,v={y:p,y1:p,y2:p,y3:p,y4:p},m={y1:L4,y2:vU,y3:P4},b=Yo(o,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),x=Yo(o,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!d)return Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:pU},m),{y4:gU})],encode:Object.assign(Object.assign({},n),v),style:h,tooltip:b},u);const S=bn(h,"box"),E=bn(h,"point");return[Object.assign({type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:SR},m),{y4:OR})],encode:Object.assign(Object.assign({},n),v),style:S,tooltip:b,animate:ha(l,"box")},u),{type:"point",data:e,transform:[{type:mU}],encode:n,style:Object.assign({},E),tooltip:x,animate:ha(l,"point")}]};ER.props={};const wR=(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))/2,yU=(t,e)=>{if(!e)return;const{coordinate:n}=e;if(!(n!=null&&n.getCenter))return;const r=n.getCenter();return(o,c,l)=>{const{document:u}=e.canvas,{color:d,index:h}=c,p=u.createElement("g",{}),v=wR(o[0],o[1]),m=wR(o[0],r)*2,b=u.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...o[0]],["A",v,v,0,1,0,...o[1]],["A",m+v*2,m+v*2,0,0,0,...o[2]],["A",v,v,0,1,h===0?0:1,...o[3]],["A",m,m,0,0,1,...o[0]],["Z"]]},l),Gp(t,["shape","last","first"])),{fill:d||l.color})});return p.appendChild(b),p}};var oO=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const bU=(t,e)=>{const{shape:n,radius:r}=t,o=oO(t,["shape","radius"]),c=bn(o,"pointer"),l=bn(o,"pin"),{shape:u}=c,d=oO(c,["shape"]),{shape:h}=l,p=oO(l,["shape"]),{coordinate:v,theme:m}=e;return(b,x)=>{const S=b.map(Ot=>v.invert(Ot)),[E,w,M]=pE(v,"polar"),L=v.clone(),{color:I}=x,R=dp({startAngle:E,endAngle:w,innerRadius:M,outerRadius:r});R.push(["cartesian"]),L.update({transformations:R});const z=S.map(Ot=>L.map(Ot)),[W,Y]=od(z),[st,xt]=v.getCenter(),Nt=Object.assign(Object.assign({x1:W,y1:Y,x2:st,y2:xt,stroke:I},d),o),Ht=Object.assign(Object.assign({cx:st,cy:xt,stroke:I},p),o),dt=Wn(new F.ZA);return Lo(u)||(typeof u=="function"?dt.append(()=>u(z,x,L,m)):dt.append("line").call(Fn,Nt).node()),Lo(h)||(typeof h=="function"?dt.append(()=>h(z,x,L,m)):dt.append("circle").call(Fn,Ht).node()),dt.node()}},AR={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},_U={style:{shape:bU,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},xU={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"}};function SU(t){if((0,ne.Z)(t)){const e=Math.max(0,Math.min(t,1));return{percent:e,target:e,total:1}}return t}function OU(t,e){const{name:n="score",target:r,total:o,percent:c,thresholds:l=[]}=SU(t),u=c||r,d=c?1:o,h=Object.assign({y:{domain:[0,d]}},e);return l.length?{targetData:[{x:n,y:u,color:"target"}],totalData:l.map((p,v)=>({x:n,y:v>=1?p-l[v-1]:p,color:v})),target:u,total:d,scale:h}:{targetData:[{x:n,y:u,color:"target"}],totalData:[{x:n,y:u,color:"target"},{x:n,y:d-u,color:"total"}],target:u,total:d,scale:h}}function EU(t,{target:e,total:n}){const{content:r}=t;return r?r(e,n):e.toString()}const TR=t=>{const{data:e={},scale:n={},style:r={},animate:o={},transform:c=[]}=t,l=oO(t,["data","scale","style","animate","transform"]),{targetData:u,totalData:d,target:h,total:p,scale:v}=OU(e,n),m=bn(r,"text"),b=Tl(r,["pointer","pin"]),x=bn(r,"arc"),S=x.shape;return[en({},AR,Object.assign({type:"interval",transform:[{type:"stackY"}],data:d,scale:v,style:S==="round"?Object.assign(Object.assign({},x),{shape:yU}):x,animate:typeof o=="object"?bn(o,"arc"):o},l)),en({},AR,_U,Object.assign({type:"point",data:u,scale:v,style:b,animate:typeof o=="object"?bn(o,"indicator"):o},l)),en({},xU,{style:Object.assign({text:EU(m,{target:h,total:p})},m),animate:typeof o=="object"?bn(o,"text"):o})]};TR.props={};const CR=5e3;function MR(t,e,n){return t+(e-t)*n}function wU(t,e,n,r){return e===0?[[t+1/2*n/Math.PI/2,r/2],[t+1/2*n/Math.PI,r],[t+n/4,r]]:e===1?[[t+1/2*n/Math.PI/2*(Math.PI-2),r],[t+1/2*n/Math.PI/2*(Math.PI-1),r/2],[t+n/4,0]]:e===2?[[t+1/2*n/Math.PI/2,-r/2],[t+1/2*n/Math.PI,-r],[t+n/4,-r]]:[[t+1/2*n/Math.PI/2*(Math.PI-2),-r],[t+1/2*n/Math.PI/2*(Math.PI-1),-r/2],[t+n/4,0]]}function AU(t,e,n,r,o,c,l){const u=Math.ceil(2*t/n*4)*4,d=[];let h=r;for(;h<-Math.PI*2;)h+=Math.PI*2;for(;h>0;)h-=Math.PI*2;h=h/Math.PI/2*n;const p=c-t+h-t*2;d.push(["M",p,e]);let v=0;for(let m=0;m<u;++m){const b=m%4,x=wU(m*n/4,b,n,o);d.push(["C",x[0][0]+p,-x[0][1]+e,x[1][0]+p,-x[1][1]+e,x[2][0]+p,-x[2][1]+e]),m===u-1&&(v=x[2][0])}return d.push(["L",v+p,l+t]),d.push(["L",p,l+t]),d.push(["Z"]),d}function TU(t,e,n,r,o,c,l,u,d,h,p){const{fill:v,fillOpacity:m,opacity:b}=o;for(let x=0;x<r;x++){const S=r<=1?1:x/(r-1),E=AU(u,l+u*n,d,0,u/40,t,e),w=p.createElement("path",{style:{d:E,fill:v,opacity:MR(.2,.9,S)*Number(b||m)}});c.appendChild(w);try{if(h===!1)return;const M=[{transform:"translate(0, 0)"},{transform:`translate(${d*2}, 0)`}];w.animate(M,{duration:MR(.5*CR,CR,S)*2,iterations:1/0})}catch(M){console.warn("off-screen group animate error!")}}}function CU(t,e,n){return`
      M ${t} ${e-n} 
      a ${n} ${n} 0 1 0 0 ${n*2}
      a ${n} ${n} 0 1 0 0 ${-n*2}
      Z
    `}function MU(t,e,n){const o=n*.618;return`
      M ${t-o} ${e-n}
      L ${t+o} ${e-n}
      L ${t+o} ${e+n}
      L ${t-o} ${e+n}
      Z
    `}function LU(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e}
      L ${t} ${e+n}
      L ${t-n} ${e}
      Z
    `}function PU(t,e,n){return`
      M ${t} ${e-n}
      L ${t+n} ${e+n}
      L ${t-n} ${e+n}
      Z
    `}function IU(t,e,n){const r=n*4/3,o=Math.max(r,n*2),c=r/2,l=t,u=c+e-o/2,d=Math.asin(c/((o-c)*.85)),h=Math.sin(d)*c,p=Math.cos(d)*c,v=l-p,m=u+h,b=t,x=u+c/Math.sin(d);return`
      M ${v} ${m}
      A ${c} ${c} 0 1 1 ${v+p*2} ${m}
      Q ${b} ${x} ${t} ${e+o/2}
      Q ${b} ${x} ${v} ${m}
      Z 
    `}const LR={pin:IU,rect:MU,circle:CU,diamond:LU,triangle:PU};var PR=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const RU=(t="circle")=>LR[t]||LR.circle,IR=(t,e)=>{if(!e)return;const{coordinate:n}=e,{liquidOptions:r,styleOptions:o}=t,{liquidShape:c,percent:l}=r,{background:u,outline:d={},wave:h={}}=o,p=PR(o,["background","outline","wave"]),{border:v=2,distance:m=0}=d,b=PR(d,["border","distance"]),{length:x=192,count:S=3}=h;return(E,w,M)=>{const{document:L}=e.canvas,{color:I,fillOpacity:R}=M,z=Object.assign(Object.assign({fill:I},M),p),W=L.createElement("g",{}),[Y,st]=n.getCenter(),xt=n.getSize(),Nt=Math.min(...xt)/2,dt=(lo(c)?c:RU(c))(Y,st,Nt,...xt);if(Object.keys(u).length){const wt=L.createElement("path",{style:Object.assign({d:dt,fill:"#fff"},u)});W.appendChild(wt)}if(l>0){const wt=L.createElement("path",{style:{d:dt}});W.appendChild(wt),W.style.clipPath=wt,TU(Y,st,1-l,S,z,W,wt.getBBox().y,Nt*2,x,!0,L)}const Ot=L.createElement("path",{style:{d:dt,fill:"transparent",lineWidth:v+2*m,stroke:"#fff"}}),bt=L.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:dt,stroke:I,strokeOpacity:R,lineWidth:v},z),b),{fill:"transparent"})});return W.appendChild(Ot),W.appendChild(bt),W}};IR.props={};var kU=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const DU={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:IR},animate:{enter:{type:"fadeIn"}}},FU={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},RR=t=>{const{data:e={},style:n={},animate:r}=t,o=kU(t,["data","style","animate"]),c=Math.max(0,(0,ne.Z)(e)?e:e==null?void 0:e.percent),l=[{percent:c,type:"liquid"}],u=Object.assign(Object.assign({},bn(n,"text")),bn(n,"content")),d=bn(n,"outline"),h=bn(n,"wave"),p=bn(n,"background");return[en({},DU,Object.assign({type:"interval",data:l,style:{liquidOptions:{percent:c,liquidShape:n==null?void 0:n.shape},styleOptions:Object.assign(Object.assign({},n),{outline:d,wave:h,background:p})},animate:r},o)),en({},FU,{style:Object.assign({text:`${Pl(c*100)} %`},u),animate:r})]};RR.props={};var mc=k(69916);const kR=1e-10;function DR(t,e){const n=BU(t),r=n.filter(function(d){return NU(d,t)});let o=0,c=0,l;const u=[];if(r.length>1){const d=jU(r);for(l=0;l<r.length;++l){const p=r[l];p.angle=Math.atan2(p.x-d.x,p.y-d.y)}r.sort(function(p,v){return v.angle-p.angle});let h=r[r.length-1];for(l=0;l<r.length;++l){const p=r[l];c+=(h.x+p.x)*(p.y-h.y);const v={x:(p.x+h.x)/2,y:(p.y+h.y)/2};let m=null;for(let b=0;b<p.parentIndex.length;++b)if(h.parentIndex.indexOf(p.parentIndex[b])>-1){const x=t[p.parentIndex[b]],S=Math.atan2(p.x-x.x,p.y-x.y),E=Math.atan2(h.x-x.x,h.y-x.y);let w=E-S;w<0&&(w+=2*Math.PI);const M=E-w/2;let L=um(v,{x:x.x+x.radius*Math.sin(M),y:x.y+x.radius*Math.cos(M)});L>x.radius*2&&(L=x.radius*2),(m===null||m.width>L)&&(m={circle:x,width:L,p1:p,p2:h})}m!==null&&(u.push(m),o+=I4(m.circle.radius,m.width),h=p)}}else{let d=t[0];for(l=1;l<t.length;++l)t[l].radius<d.radius&&(d=t[l]);let h=!1;for(l=0;l<t.length;++l)if(um(t[l],d)>Math.abs(d.radius-t[l].radius)){h=!0;break}h?o=c=0:(o=d.radius*d.radius*Math.PI,u.push({circle:d,p1:{x:d.x,y:d.y+d.radius},p2:{x:d.x-kR,y:d.y+d.radius},width:d.radius*2}))}return c/=2,e&&(e.area=o+c,e.arcArea=o,e.polygonArea=c,e.arcs=u,e.innerPoints=r,e.intersectionPoints=n),o+c}function NU(t,e){for(let n=0;n<e.length;++n)if(um(t,e[n])>e[n].radius+kR)return!1;return!0}function BU(t){const e=[];for(let n=0;n<t.length;++n)for(let r=n+1;r<t.length;++r){const o=NR(t[n],t[r]);for(let c=0;c<o.length;++c){const l=o[c];l.parentIndex=[n,r],e.push(l)}}return e}function I4(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function um(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function FR(t,e,n){if(n>=t+e)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);const r=t-(n*n-e*e+t*t)/(2*n),o=e-(n*n-t*t+e*e)/(2*n);return I4(t,r)+I4(e,o)}function NR(t,e){const n=um(t,e),r=t.radius,o=e.radius;if(n>=r+o||n<=Math.abs(r-o))return[];const c=(r*r-o*o+n*n)/(2*n),l=Math.sqrt(r*r-c*c),u=t.x+c*(e.x-t.x)/n,d=t.y+c*(e.y-t.y)/n,h=-(e.y-t.y)*(l/n),p=-(e.x-t.x)*(l/n);return[{x:u+h,y:d-p},{x:u-h,y:d+p}]}function jU(t){const e={x:0,y:0};for(let n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}function zU(t,e){e=e||{},e.maxIterations=e.maxIterations||500;const n=e.initialLayout||VU,r=e.lossFunction||k4;t=UU(t);const o=n(t,e),c=[],l=[];let u;for(u in o)o.hasOwnProperty(u)&&(c.push(o[u].x),c.push(o[u].y),l.push(u));const h=(0,mc.nelderMead)(function(p){const v={};for(let m=0;m<l.length;++m){const b=l[m];v[b]={x:p[2*m],y:p[2*m+1],radius:o[b].radius}}return r(v,t)},c,e).x;for(let p=0;p<l.length;++p)u=l[p],o[u].x=h[2*p],o[u].y=h[2*p+1];return o}const BR=1e-10;function R4(t,e,n){return Math.min(t,e)*Math.min(t,e)*Math.PI<=n+BR?Math.abs(t-e):(0,mc.bisect)(function(r){return FR(t,e,r)-n},0,t+e)}function UU(t){t=t.slice();const e=[],n={};let r,o,c,l;for(r=0;r<t.length;++r){const u=t[r];u.sets.length==1?e.push(u.sets[0]):u.sets.length==2&&(c=u.sets[0],l=u.sets[1],n[[c,l]]=!0,n[[l,c]]=!0)}for(e.sort((u,d)=>u>d?1:-1),r=0;r<e.length;++r)for(c=e[r],o=r+1;o<e.length;++o)l=e[o],[c,l]in n||t.push({sets:[c,l],size:0});return t}function ZU(t,e,n){const r=(0,mc.zerosM)(e.length,e.length),o=(0,mc.zerosM)(e.length,e.length);return t.filter(function(c){return c.sets.length==2}).map(function(c){const l=n[c.sets[0]],u=n[c.sets[1]],d=Math.sqrt(e[l].size/Math.PI),h=Math.sqrt(e[u].size/Math.PI),p=R4(d,h,c.size);r[l][u]=r[u][l]=p;let v=0;c.size+1e-10>=Math.min(e[l].size,e[u].size)?v=1:c.size<=1e-10&&(v=-1),o[l][u]=o[u][l]=v}),{distances:r,constraints:o}}function HU(t,e,n,r){let o=0,c;for(c=0;c<e.length;++c)e[c]=0;for(c=0;c<n.length;++c){const l=t[2*c],u=t[2*c+1];for(let d=c+1;d<n.length;++d){const h=t[2*d],p=t[2*d+1],v=n[c][d],m=r[c][d],b=(h-l)*(h-l)+(p-u)*(p-u),x=Math.sqrt(b),S=b-v*v;m>0&&x<=v||m<0&&x>=v||(o+=2*S*S,e[2*c]+=4*S*(l-h),e[2*c+1]+=4*S*(u-p),e[2*d]+=4*S*(h-l),e[2*d+1]+=4*S*(p-u))}}return o}function VU(t,e){let n=GU(t,e);const r=e.lossFunction||k4;if(t.length>=8){const o=WU(t,e),c=r(o,t),l=r(n,t);c+1e-8<l&&(n=o)}return n}function WU(t,e){e=e||{};const n=e.restarts||10,r=[],o={};let c;for(c=0;c<t.length;++c){const S=t[c];S.sets.length==1&&(o[S.sets[0]]=r.length,r.push(S))}const l=ZU(t,r,o);let u=l.distances;const d=l.constraints,h=(0,mc.norm2)(u.map(mc.norm2))/u.length;u=u.map(function(S){return S.map(function(E){return E/h})});const p=function(S,E){return HU(S,E,u,d)};let v,m;for(c=0;c<n;++c){const S=(0,mc.zeros)(u.length*2).map(Math.random);m=(0,mc.conjugateGradient)(p,S,e),(!v||m.fx<v.fx)&&(v=m)}const b=v.x,x={};for(c=0;c<r.length;++c){const S=r[c];x[S.sets[0]]={x:b[2*c]*h,y:b[2*c+1]*h,radius:Math.sqrt(S.size/Math.PI)}}if(e.history)for(c=0;c<e.history.length;++c)(0,mc.scale)(e.history[c].x,h);return x}function GU(t,e){const n=e&&e.lossFunction?e.lossFunction:k4,r={},o={};let c;for(let v=0;v<t.length;++v){const m=t[v];m.sets.length==1&&(c=m.sets[0],r[c]={x:1e10,y:1e10,rowid:Object.keys(r).length,size:m.size,radius:Math.sqrt(m.size/Math.PI)},o[c]=[])}t=t.filter(function(v){return v.sets.length==2});for(let v=0;v<t.length;++v){const m=t[v];let b=m.hasOwnProperty("weight")?m.weight:1;const x=m.sets[0],S=m.sets[1];m.size+BR>=Math.min(r[x].size,r[S].size)&&(b=0),o[x].push({set:S,size:m.size,weight:b}),o[S].push({set:x,size:m.size,weight:b})}const l=[];for(c in o)if(o.hasOwnProperty(c)){let v=0;for(let m=0;m<o[c].length;++m)v+=o[c][m].size*o[c][m].weight;l.push({set:c,size:v})}function u(v,m){return m.size-v.size}l.sort(u);const d={};function h(v){return v.set in d}function p(v,m){r[m].x=v.x,r[m].y=v.y,d[m]=!0}p({x:0,y:0},l[0].set);for(let v=1;v<l.length;++v){const m=l[v].set,b=o[m].filter(h);if(c=r[m],b.sort(u),b.length===0)throw"ERROR: missing pairwise overlap information";const x=[];for(let w=0;w<b.length;++w){const M=r[b[w].set],L=R4(c.radius,M.radius,b[w].size);x.push({x:M.x+L,y:M.y}),x.push({x:M.x-L,y:M.y}),x.push({y:M.y+L,x:M.x}),x.push({y:M.y-L,x:M.x});for(let I=w+1;I<b.length;++I){const R=r[b[I].set],z=R4(c.radius,R.radius,b[I].size),W=NR({x:M.x,y:M.y,radius:L},{x:R.x,y:R.y,radius:z});for(let Y=0;Y<W.length;++Y)x.push(W[Y])}}let S=1e50,E=x[0];for(let w=0;w<x.length;++w){r[m].x=x[w].x,r[m].y=x[w].y;const M=n(r,t);M<S&&(S=M,E=x[w])}p(E,m)}return r}function k4(t,e){let n=0;function r(o){return o.map(function(c){return t[c]})}for(let o=0;o<e.length;++o){const c=e[o];let l;if(c.sets.length==1)continue;if(c.sets.length==2){const d=t[c.sets[0]],h=t[c.sets[1]];l=FR(d.radius,h.radius,um(d,h))}else l=DR(r(c.sets));const u=c.hasOwnProperty("weight")?c.weight:1;n+=u*(l-c.size)*(l-c.size)}return n}function YU(t,e,n){n===null?t.sort(function(o,c){return c.radius-o.radius}):t.sort(n);let r;if(t.length>0){const o=t[0].x,c=t[0].y;for(r=0;r<t.length;++r)t[r].x-=o,t[r].y-=c}if(t.length==2&&distance(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){const o=Math.atan2(t[1].x,t[1].y)-e;let c,l;const u=Math.cos(o),d=Math.sin(o);for(r=0;r<t.length;++r)c=t[r].x,l=t[r].y,t[r].x=u*c-d*l,t[r].y=d*c+u*l}if(t.length>2){let o=Math.atan2(t[2].x,t[2].y)-e;for(;o<0;)o+=2*Math.PI;for(;o>2*Math.PI;)o-=2*Math.PI;if(o>Math.PI){const c=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){const l=(t[r].x+c*t[r].y)/(1+c*c);t[r].x=2*l-t[r].x,t[r].y=2*l*c-t[r].y}}}}function $U(t){t.map(function(l){l.parent=l});function e(l){return l.parent!==l&&(l.parent=e(l.parent)),l.parent}function n(l,u){const d=e(l),h=e(u);d.parent=h}for(let l=0;l<t.length;++l)for(let u=l+1;u<t.length;++u){const d=t[l].radius+t[u].radius;distance(t[l],t[u])+1e-10<d&&n(t[u],t[l])}const r={};let o;for(let l=0;l<t.length;++l)o=e(t[l]).parent.setid,o in r||(r[o]=[]),r[o].push(t[l]);t.map(function(l){delete l.parent});const c=[];for(o in r)r.hasOwnProperty(o)&&c.push(r[o]);return c}function D4(t){const e=function(n){const r=Math.max.apply(null,t.map(function(c){return c[n]+c.radius})),o=Math.min.apply(null,t.map(function(c){return c[n]-c.radius}));return{max:r,min:o}};return{xRange:e("x"),yRange:e("y")}}function $V(t,e,n){e===null&&(e=Math.PI/2);let r=[],o,c;for(c in t)if(t.hasOwnProperty(c)){const m=t[c];r.push({x:m.x,y:m.y,radius:m.radius,setid:c})}const l=$U(r);for(o=0;o<l.length;++o){YU(l[o],e,n);const m=D4(l[o]);l[o].size=(m.xRange.max-m.xRange.min)*(m.yRange.max-m.yRange.min),l[o].bounds=m}l.sort(function(m,b){return b.size-m.size}),r=l[0];let u=r.bounds;const d=(u.xRange.max-u.xRange.min)/50;function h(m,b,x){if(!m)return;const S=m.bounds;let E,w,M;b?E=u.xRange.max-S.xRange.min+d:(E=u.xRange.max-S.xRange.max,M=(S.xRange.max-S.xRange.min)/2-(u.xRange.max-u.xRange.min)/2,M<0&&(E+=M)),x?w=u.yRange.max-S.yRange.min+d:(w=u.yRange.max-S.yRange.max,M=(S.yRange.max-S.yRange.min)/2-(u.yRange.max-u.yRange.min)/2,M<0&&(w+=M));for(let L=0;L<m.length;++L)m[L].x+=E,m[L].y+=w,r.push(m[L])}let p=1;for(;p<l.length;)h(l[p],!0,!1),h(l[p+1],!1,!0),h(l[p+2],!0,!0),p+=3,u=D4(r);const v={};for(o=0;o<r.length;++o)v[r[o].setid]=r[o];return v}function XU(t,e,n,r){const o=[],c=[];for(const S in t)t.hasOwnProperty(S)&&(c.push(S),o.push(t[S]));e-=2*r,n-=2*r;const l=D4(o),u=l.xRange,d=l.yRange;if(u.max==u.min||d.max==d.min)return console.log("not scaling solution: zero size detected"),t;const h=e/(u.max-u.min),p=n/(d.max-d.min),v=Math.min(p,h),m=(e-(u.max-u.min)*v)/2,b=(n-(d.max-d.min)*v)/2,x={};for(let S=0;S<o.length;++S){const E=o[S];x[c[S]]={radius:v*E.radius,x:r+m+(E.x-u.min)*v,y:r+b+(E.y-d.min)*v}}return x}function qU(t,e,n){const r=[],o=t-n,c=e;return r.push("M",o,c),r.push("A",n,n,0,1,0,o+2*n,c),r.push("A",n,n,0,1,0,o,c),r.join(" ")}function KU(t){const e={};DR(t,e);const n=e.arcs;if(n.length===0)return"M 0 0";if(n.length==1){const r=n[0].circle;return qU(r.x,r.y,r.radius)}else{const r=[`
M`,n[0].p2.x,n[0].p2.y];for(let o=0;o<n.length;++o){const c=n[o],l=c.circle.radius,u=c.width>l;r.push(`
A`,l,l,0,u?1:0,1,c.p1.x,c.p1.y)}return r.join(" ")}}const jR=t=>{const{sets:e="sets",size:n="size",as:r=["key","path"],padding:o=0}=t,[c,l]=r;return u=>{const d=u.map(v=>Object.assign(Object.assign({},v),{sets:v[e],size:v[n],[c]:v.sets.join("&")}));d.sort((v,m)=>v.sets.length-m.sets.length);const h=zU(d);let p;return d.map(v=>{const m=v[e],b=({width:x,height:S})=>{p=p||XU(h,x,S,o);const E=m.map(M=>p[M]);let w=KU(E);return/[zZ]$/.test(w)||(w+=" Z"),w};return Object.assign(Object.assign({},v),{[l]:b})})}};jR.props={};function QU(){return{"data.venn":jR,"mark.boxplot":ER,"mark.gauge":TR,"mark.wordCloud":vh,"mark.liquid":RR}}function JU(){return Object.assign(Object.assign(Object.assign(Object.assign({},uj()),hU()),QU()),aB())}var aO=function(){return aO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},aO.apply(this,arguments)},tZ=I2(P2,aO(aO({},JU()),jg())),fm=function(){return fm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},fm.apply(this,arguments)},eZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},nZ=["renderer"],zR=["width","height","autoFit","theme","inset","insetLeft","insetRight","insetTop","insetBottom","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","depth","title","clip","children","type","data","direction"],F4="__transform__",rZ="__skipDelCustomKeys__",df=function(t,e){return(0,H.isBoolean)(e)?{type:t,available:e}:fm({type:t},e)},N4={xField:"encode.x",yField:"encode.y",colorField:"encode.color",angleField:"encode.y",keyField:"encode.key",sizeField:"encode.size",shapeField:"encode.shape",seriesField:"encode.series",positionField:"encode.position",textField:"encode.text",valueField:"encode.value",binField:"encode.x",srcField:"encode.src",linkColorField:"encode.linkColor",fontSizeField:"encode.fontSize",radius:"coordinate.outerRadius",innerRadius:"coordinate.innerRadius",startAngle:"coordinate.startAngle",endAngle:"coordinate.endAngle",focusX:"coordinate.focusX",focusY:"coordinate.focusY",distortionX:"coordinate.distortionX",distortionY:"coordinate.distortionY",visual:"coordinate.visual",stack:{target:"transform",value:function(t){return df("stackY",t)}},normalize:{target:"transform",value:function(t){return df("normalizeY",t)}},percent:{target:"transform",value:function(t){return df("normalizeY",t)}},group:{target:"transform",value:function(t){return df("dodgeX",t)}},sort:{target:"transform",value:function(t){return df("sortX",t)}},symmetry:{target:"transform",value:function(t){return df("symmetryY",t)}},diff:{target:"transform",value:function(t){return df("diffY",t)}},meta:{target:"scale",value:function(t){return t}},label:{target:"labels",value:function(t){return t}},shape:"style.shape",connectNulls:{target:"style",value:function(t){return(0,H.isBoolean)(t)?{connect:t}:t}}},B4=["xField","yField","seriesField","colorField","keyField","positionField","meta","tooltip","animate","stack","normalize","percent","group","sort","symmetry","diff"],sO=[{key:"annotations",extend_keys:[]},{key:"line",type:"line",extend_keys:B4},{key:"point",type:"point",extend_keys:B4},{key:"area",type:"area",extend_keys:B4}],iZ=[{key:"transform",callback:function(t,e,n){var r;t[e]=t[e]||[];var o=n.available,c=o===void 0?!0:o,l=eZ(n,["available"]);if(c)t[e].push(fm((r={},r[F4]=!0,r),l));else{var u=t[e].indexOf(function(d){return d.type===n.type});u!==-1&&t[e].splice(u,1)}}},{key:"labels",callback:function(t,e,n){var r;if(!n||(0,H.isArray)(n)){t[e]=n||[];return}n.text||(n.text=t.yField),t[e]=t[e]||[],t[e].push(fm((r={},r[F4]=!0,r),n))}}],j4=[{key:"conversionTag",shape:"ConversionTag"},{key:"axisText",shape:"BidirectionalBarAxisText"}],oZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),cO=function(){return cO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},cO.apply(this,arguments)},aZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},sZ=function(t){oZ(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=aZ(n,["style"]);return t.call(this,cO({style:cO({fill:"#eee"},r)},o))||this}return e}(F.mg),cZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lO=function(){return lO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},lO.apply(this,arguments)},lZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},UR=function(t){cZ(e,t);function e(n){n===void 0&&(n={});var r=n.style,o=lZ(n,["style"]);return t.call(this,lO({style:lO({text:"",fontSize:12,textBaseline:"middle",textAlign:"center",fill:"#000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1},r)},o))||this}return e}(F.xv),ZR=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))},uZ=function(t,e){if((0,H.isArray)(e))return e},El=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return H.mergeWith.apply(void 0,ZR(ZR([],t,!1),[uZ],!1))},fZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),HR=function(t){fZ(e,t);function e(n,r,o){var c=t.call(this,{style:El(o,r)})||this;return c.chart=n,c}return e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},e.prototype.disconnectedCallback=function(){},e.prototype.attributeChangedCallback=function(n){},e.prototype.update=function(n,r){var o;return this.attr(El({},this.attributes,n||{})),(o=this.render)===null||o===void 0?void 0:o.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.getElementsLayout=function(){var n=this.chart.getContext().canvas,r=n.document.getElementsByClassName("element"),o=[];return r.forEach(function(c){var l=c.getBBox(),u=l.x,d=l.y,h=l.width,p=l.height,v=c.__data__;o.push({bbox:l,x:u,y:d,width:h,height:p,key:v.key,data:v})}),o},e.prototype.bindEvents=function(n,r){},e}(F.b_),dZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),uO=function(){return uO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},uO.apply(this,arguments)},hZ=function(t){dZ(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.getConversionTagLayout=function(){var n=this.direction==="vertical",r=this.getElementsLayout(),o=r[0],c=o.x,l=o.y,u=o.height,d=o.width,h=o.data,p=["items",0,"value"],v=(0,H.get)(h,p),m=n?r[1].y-l-u:r[1].x-c-d,b=[],x=this.attributes,S=x.size,E=S===void 0?40:S,w=x.arrowSize,M=w===void 0?20:w,L=x.spacing,I=L===void 0?4:L;return r.forEach(function(R,z){if(z>0){var W=R.x,Y=R.y,st=R.height,xt=R.width,Nt=R.data,Ht=R.key,dt=(0,H.get)(Nt,p),Ot=E/2;if(n){var bt=W+xt/2,wt=Y;b.push({points:[[bt+Ot,wt-m+I],[bt+Ot,wt-M-I],[bt,wt-I],[bt-Ot,wt-M-I],[bt-Ot,wt-m+I]],center:[bt,wt-m/2-I],width:m,value:[v,dt],key:Ht})}else{var bt=W,wt=Y+st/2;b.push({points:[[W-m+I,wt-Ot],[W-M-I,wt-Ot],[bt-I,wt],[W-M-I,wt+Ot],[W-m+I,wt+Ot]],center:[bt-m/2-I,wt],width:m,value:[v,dt],key:Ht})}v=dt}}),b},e.prototype.render=function(){this.setDirection(),this.drawConversionTag()},e.prototype.setDirection=function(){var n=this.chart.getCoordinate(),r=(0,H.get)(n,"options.transformations"),o="horizontal";r.forEach(function(c){c.includes("transpose")&&(o="vertical")}),this.direction=o},e.prototype.drawConversionTag=function(){var n=this,r=this.getConversionTagLayout(),o=this.attributes,c=o.style,l=o.text,u=l.style,d=l.formatter;r.forEach(function(h){var p=h.points,v=h.center,m=h.value,b=h.key,x=m[0],S=m[1],E=v[0],w=v[1],M=new sZ({style:uO({points:p,fill:"#eee"},c),id:"polygon-".concat(b)}),L=new UR({style:uO({x:E,y:w,text:(0,H.isFunction)(d)?d(x,S):(S/x*100).toFixed(2)+"%"},u),id:"text-".concat(b)});n.appendChild(M),n.appendChild(L)})},e.prototype.update=function(){var n=this,r=this.getConversionTagLayout();r.forEach(function(o){var c=o.points,l=o.center,u=o.key,d=l[0],h=l[1],p=n.getElementById("polygon-".concat(u)),v=n.getElementById("text-".concat(u));p.setAttribute("points",c),v.setAttribute("x",d),v.setAttribute("y",h)})},e.tag="ConversionTag",e}(HR),z4=32,VR=16,WR=48,pZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dm=function(){return dm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},dm.apply(this,arguments)},gZ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},vZ=function(t){pZ(e,t);function e(n,r){return t.call(this,n,r,{type:e.tag})||this}return e.prototype.render=function(){this.drawText()},e.prototype.getBidirectionalBarAxisTextLayout=function(){var n=this.attributes.layout,r=n==="vertical",o=this.getElementsLayout(),c=r?(0,H.uniqBy)(o,"x"):(0,H.uniqBy)(o,"y"),l=["title"],u=[],d=this.chart.getContext().views,h=(0,H.get)(d,[0,"layout"]),p=h.width,v=h.height;return c.forEach(function(m){var b=m.x,x=m.y,S=m.height,E=m.width,w=m.data,M=m.key,L=(0,H.get)(w,l);r?u.push({x:b+E/2,y:v,text:L,key:M}):u.push({x:p,y:x+S/2,text:L,key:M})}),(0,H.uniqBy)(u,"text").length!==u.length&&(u=Object.values((0,H.groupBy)(u,"text")).map(function(m){var b,x=m.reduce(function(S,E){return S+(r?E.x:E.y)},0);return dm(dm({},m[0]),(b={},b[r?"x":"y"]=x/m.length,b))})),u},e.prototype.transformLabelStyle=function(n){var r={},o=/^label[A-Z]/;return Object.keys(n).forEach(function(c){o.test(c)&&(r[c.replace("label","").replace(/^[A-Z]/,function(l){return l.toLowerCase()})]=n[c])}),r},e.prototype.drawText=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout(),o=this.attributes,c=o.layout,l=o.labelFormatter,u=gZ(o,["layout","labelFormatter"]);r.forEach(function(d){var h=d.x,p=d.y,v=d.text,m=d.key,b=new UR({style:dm({x:h,y:p,text:(0,H.isFunction)(l)?l(v):v,wordWrap:!0,wordWrapWidth:c==="horizontal"?z4*2:120,maxLines:2,textOverflow:"ellipsis"},n.transformLabelStyle(u)),id:"text-".concat(m)});n.appendChild(b)})},e.prototype.update=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout();r.forEach(function(o){var c=o.x,l=o.y,u=o.key,d=n.getElementById("text-".concat(u));d.setAttribute("x",c),d.setAttribute("y",l)})},e.tag="BidirectionalBarAxisText",e}(HR),mZ={ConversionTag:hZ,BidirectionalBarAxisText:vZ},yZ=function(){function t(e,n){this.container=new Map,this.chart=e,this.config=n,this.init()}return t.prototype.init=function(){var e=this;j4.forEach(function(n){var r,o=n.key,c=n.shape,l=e.config[o];if(l){var u=new mZ[c](e.chart,l),d=e.chart.getContext().canvas;d.appendChild(u),e.container.set(o,u)}else(r=e.container.get(o))===null||r===void 0||r.clear()})},t.prototype.update=function(){var e=this;this.container.size&&j4.forEach(function(n){var r=n.key,o=e.container.get(r);o==null||o.update()})},t}(),bZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rh=function(){return Rh=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Rh.apply(this,arguments)},GR="data-chart-source-type",Mr=function(t){bZ(e,t);function e(n,r){var o=t.call(this)||this;return o.container=typeof n=="string"?document.getElementById(n):n,o.options=o.mergeOption(r),o.createG2(),o.bindEvents(),o}return e.prototype.getChartOptions=function(){return Rh(Rh({},(0,H.pick)(this.options,nZ)),{container:this.container})},e.prototype.getSpecOptions=function(){return this.type==="base"||this[rZ]?Rh(Rh({},this.options),this.getChartOptions()):this.options},e.prototype.createG2=function(){if(!this.container)throw Error("The container is not initialized!");this.chart=new tZ(this.getChartOptions()),this.container.setAttribute(GR,"Ant Design Charts")},e.prototype.bindEvents=function(){var n=this;this.chart&&this.chart.on("*",function(r){r!=null&&r.type&&n.emit(r.type,r)})},e.prototype.getBaseOptions=function(){return{type:"view",autoFit:!0}},e.prototype.getDefaultOptions=function(){},e.prototype.render=function(){var n=this;this.type!=="base"&&this.execAdaptor(),this.chart.options(this.getSpecOptions()),this.chart.render().then(function(){n.annotation=new yZ(n.chart,n.options)}),this.bindSizeSensor()},e.prototype.update=function(n){this.options=this.mergeOption(n)},e.prototype.mergeOption=function(n){return El({},this.getBaseOptions(),this.getDefaultOptions(),n)},e.prototype.changeData=function(n){this.chart.changeData(n)},e.prototype.changeSize=function(n,r){this.chart.changeSize(n,r)},e.prototype.destroy=function(){this.chart.destroy(),this.off(),this.container.removeAttribute(GR)},e.prototype.execAdaptor=function(){var n=this.getSchemaAdaptor();n({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var n=this,r=this.options.autoFit,o=r===void 0?!0:r;o&&this.chart.on(Sr.AFTER_CHANGE_SIZE,function(){n.annotation.update()})},e}(ie),_Z=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),xZ=function(t){_Z(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="base",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return function(n){return n}},e}(Mr),SZ=function(t){var e=t.options,n=e.children,r=n===void 0?[]:n;return r.forEach(function(o){Object.keys(o).forEach(function(c){(0,H.isArray)(o[c])&&c!=="data"&&(o[c]=o[c].filter(function(l){return!l[F4]}))})}),e},YR=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))},OZ=function(t){var e=t.children,n=e===void 0?[]:e,r=Object.keys(N4).concat(sO.map(function(o){return o.key}));return r.forEach(function(o){delete t[o]}),n.forEach(function(o){Object.keys(o).forEach(function(c){r.includes(c)&&delete o[c]})}),Object.keys(t).forEach(function(o){YR(YR([],zR,!0),j4.map(function(c){return c.key}),!0).includes(o)||delete t[o]}),t},Br=function(t){var e=SZ(t),n=e.children,r=n===void 0?[]:n,o=(0,H.omit)(e,[].concat(zR,sO.map(function(h){return h.key}))),c=function(h){var p;return(p=iZ.find(function(v){return v.key===h}))===null||p===void 0?void 0:p.callback},l=function(h,p,v){var m=c(p);m?m(h,p,v):h[p]=El({},h[p],v)},u=function(h){Object.keys(h).forEach(function(p){if(h[p]){var v=sO.find(function(x){return x.key===p});if(v){var m=v.type,b=v.extend_keys;m?r.push(d(El({},(0,H.pick)(h,b),{type:m},h[p]))):(0,H.isArray)(h[p])&&h[p].forEach(function(x){r.push(d(x))})}}})},d=function(h){return u(h),Object.keys(N4).forEach(function(p){var v=N4[p];if(!(0,H.isUndefined)(h[p]))if((0,H.isObject)(v)){var m=v.value,b=v.target,x=m(h[p]);l(h,b,x)}else(0,H.set)(h,v,h[p])}),h};return r.forEach(function(h){var p=El({},o,h);d(El(h,p))}),u(e),OZ(e),t},U4=function(){return U4=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},U4.apply(this,arguments)};function EZ(t){var e=t.options,n=e.stack,r=e.tooltip,o=e.xField;if(!n)return t;var c=sO.map(function(u){return u.type}).filter(function(u){return!!u}),l=!1;return c.forEach(function(u){e[u]&&(l=!0,(0,H.set)(e,[u,"stack"],U4({y1:"y"},typeof n=="object"?n:{})))}),l&&!(0,H.isBoolean)(r)&&!r&&(0,H.set)(e,"tooltip",{title:o,items:[{channel:"y"}]}),t}function gi(t){return(0,H.flow)(EZ)(t)}function wZ(t){return(0,H.flow)(gi,Br)(t)}var AZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),TZ=function(t){AZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="area",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"area"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return wZ},e}(Mr),kh=function(){return kh=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},kh.apply(this,arguments)};function $R(t){var e=function(n){var r=n.options;(0,H.get)(r,"children.length")>1&&(0,H.set)(r,"children",[{type:"interval"}]);var o=r.scale,c=r.markBackground,l=r.data,u=r.children,d=r.yField,h=(0,H.get)(o,"y.domain",[]);if(c&&h.length&&(0,H.isArray)(l)){var p="domainMax",v=l.map(function(m){var b;return kh(kh({originData:kh({},m)},(0,H.omit)(m,d)),(b={},b[p]=h[h.length-1],b))});u.unshift(kh({type:"interval",data:v,yField:p,tooltip:!1,style:{fill:"#eee"},label:!1},c))}return n};return(0,H.flow)(e,gi,Br)(t)}var CZ=function(){var t=function(e,n){return function(r){var o=e.fill,c=o===void 0?"#2888FF":o,l=e.stroke,u=e.fillOpacity,d=u===void 0?1:u,h=e.strokeOpacity,p=h===void 0?.2:h,v=e.pitch,m=v===void 0?8:v,b=r[0],x=r[1],S=r[2],E=r[3],w=(x[1]-b[1])/2,M=n.document,L=M.createElement("g",{}),I=M.createElement("polygon",{style:{points:[b,[b[0]-m,b[1]+w],[S[0]-m,b[1]+w],E],fill:c,fillOpacity:d,stroke:l,strokeOpacity:p,inset:30}}),R=M.createElement("polygon",{style:{points:[[b[0]-m,b[1]+w],x,S,[S[0]-m,b[1]+w]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:p}}),z=M.createElement("polygon",{style:{points:[b,[b[0]-m,b[1]+w],x,[b[0]+m,b[1]+w]],fill:c,fillOpacity:d-.2}});return L.appendChild(I),L.appendChild(R),L.appendChild(z),L}};Um("shape.interval.bar25D",t)},MZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();CZ();var LZ=function(t){MZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Bar",n}return e.getDefaultOptions=function(){return{type:"view",coordinate:{transform:[{type:"transpose"}]},children:[{type:"interval"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return $R},e}(Mr),PZ=function(){var t=function(e,n){return function(r){var o=e.fill,c=o===void 0?"#2888FF":o,l=e.stroke,u=e.fillOpacity,d=u===void 0?1:u,h=e.strokeOpacity,p=h===void 0?.2:h,v=e.pitch,m=v===void 0?8:v,b=r[1][0]-r[0][0],x=b/2+r[0][0],S=n.document,E=S.createElement("g",{}),w=S.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[x,r[1][1]+m],[x,r[3][1]+m],[r[3][0],r[3][1]]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:p,inset:30}}),M=S.createElement("polygon",{style:{points:[[x,r[1][1]+m],[r[1][0],r[1][1]],[r[2][0],r[2][1]],[x,r[2][1]+m]],fill:c,fillOpacity:d,stroke:l,strokeOpacity:p}}),L=S.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[x,r[1][1]-m],[r[1][0],r[1][1]],[x,r[1][1]+m]],fill:c,fillOpacity:d-.2}});return E.appendChild(M),E.appendChild(w),E.appendChild(L),E}};Um("shape.interval.column25D",t)},IZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();PZ();var RZ=function(t){IZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return $R},e}(Mr);function kZ(t){var e=function(r){var o=r.options,c=o.children,l=c===void 0?[]:c,u=o.legend;return u&&l.forEach(function(d){if(!(0,H.get)(d,"colorField")){var h=(0,H.get)(d,"yField");(0,H.set)(d,"colorField",function(){return h})}}),r},n=function(r){var o=r.options,c=o.annotations,l=c===void 0?[]:c,u=o.children,d=u===void 0?[]:u,h=o.scale,p=!1;return(0,H.get)(h,"y.key")||d.forEach(function(v,m){if(!(0,H.get)(v,"scale.y.key")){var b="child".concat(m,"Scale");(0,H.set)(v,"scale.y.key",b);var x=v.annotations,S=x===void 0?[]:x;S.length>0&&((0,H.set)(v,"scale.y.independent",!1),S.forEach(function(E){(0,H.set)(E,"scale.y.key",b)})),!p&&l.length>0&&(0,H.get)(v,"scale.y.independent")===void 0&&(p=!0,(0,H.set)(v,"scale.y.independent",!1),l.forEach(function(E){(0,H.set)(E,"scale.y.key",b)}))}}),r};return(0,H.flow)(e,n,gi,Br)(t)}var DZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),XR=function(t){DZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="DualAxes",n}return e.getDefaultOptions=function(){return{type:"view",axis:{y:{title:!1,tick:!1},x:{title:!1}},scale:{y:{independent:!0,nice:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return kZ},e}(Mr);function FZ(t){var e=function(c){var l=c.options,u=l.xField,d=l.colorField;return d||(0,H.set)(l,"colorField",u),c},n=function(c){var l=c.options,u=l.compareField,d=l.transform,h=l.isTransposed,p=h===void 0?!0:h,v=l.coordinate;return d||(u?(0,H.set)(l,"transform",[]):(0,H.set)(l,"transform",[{type:"symmetryY"}])),!v&&p&&(0,H.set)(l,"coordinate",{transform:[{type:"transpose"}]}),c},r=function(c){var l=c.options,u=l.compareField,d=l.seriesField,h=l.data,p=l.children,v=l.yField,m=l.isTransposed,b=m===void 0?!0:m;if(u||d){var x=Object.values((0,H.groupBy)(h,function(S){return S[u||d]}));p[0].data=x[0],p.push({type:"interval",data:x[1],yField:function(S){return-S[v]}}),delete l.compareField,delete l.data}return d&&((0,H.set)(l,"type","spaceFlex"),(0,H.set)(l,"ratio",[1,1]),(0,H.set)(l,"direction",b?"row":"col"),delete l.seriesField),c},o=function(c){var l=c.options,u=l.tooltip,d=l.xField,h=l.yField;return u||(0,H.set)(l,"tooltip",{title:!1,items:[function(p){return{name:p[d],value:p[h]}}]}),c};return(0,H.flow)(e,n,r,o,gi,Br)(t)}var NZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BZ=function(t){NZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="column",n}return e.getDefaultOptions=function(){return{type:"view",scale:{x:{padding:0}},animate:{enter:{type:"fadeIn"}},axis:!1,shapeField:"funnel",label:{position:"inside",transform:[{type:"contrastReverse"}]},children:[{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return FZ},e}(Mr);function jZ(t){return(0,H.flow)(gi,Br)(t)}var zZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),UZ=function(t){zZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="line",n}return e.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"line"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return jZ},e}(Mr);function hm(t){switch(typeof t){case"function":return t;case"string":return function(e){return(0,H.get)(e,[t])};default:return function(){return t}}}var Sa=function(){return Sa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Sa.apply(this,arguments)};function ZZ(t){var e=function(n){var r=n.options,o=r.angleField,c=r.data,l=r.label,u=r.tooltip,d=r.colorField,h=hm(d);if((0,H.isArray)(c)&&c.length>0){var p=c.reduce(function(m,b){return m+b[o]},0);if(p===0){var v=c.map(function(m){var b;return Sa(Sa({},m),(b={},b[o]=1,b))});(0,H.set)(r,"data",v),l&&(0,H.set)(r,"label",Sa(Sa({},l),{formatter:function(){return 0}})),u!==!1&&((0,H.isFunction)(u)?(0,H.set)(r,"tooltip",function(m,b,x){var S;return u(Sa(Sa({},m),(S={},S[o]=0,S)),b,x.map(function(E){var w;return Sa(Sa({},E),(w={},w[o]=0,w))}))}):(0,H.set)(r,"tooltip",Sa(Sa({},u),{items:[function(m,b,x){return{name:h(m,b,x),value:0}}]})))}}return n};return(0,H.flow)(e,Br)(t)}var HZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),VZ=function(t){HZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="pie",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"theta"},transform:[{type:"stackY",reverse:!0}],animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ZZ},e}(Mr);function WZ(t){return(0,H.flow)(gi,Br)(t)}var GZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),YZ=function(t){GZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="scatter",n}return e.getDefaultOptions=function(){return{axis:{y:{title:!1},x:{title:!1}},legend:{size:!1},children:[{type:"point"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return WZ},e}(Mr);function $Z(t){var e=function(n){return(0,H.set)(n,"options.coordinate",{type:(0,H.get)(n,"options.coordinateType","polar")}),n};return(0,H.flow)(e,Br)(t)}var XZ=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qZ=function(t){XZ(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radar",n}return e.getDefaultOptions=function(){return{axis:{x:{grid:!0,line:!0},y:{zIndex:1,title:!1,line:!0,nice:!0}},meta:{x:{padding:.5,align:0}},interaction:{tooltip:{style:{crosshairsLineDash:[4,4]}}},children:[{type:"line"}],coordinateType:"polar"}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return $Z},e}(Mr),yc=function(){return yc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},yc.apply(this,arguments)},KZ="__stock-range__",QZ="trend",JZ="up",tH="down";function eH(t){var e=function(r){var o=r.options,c=o.data,l=o.yField;return r.options.data=(0,H.map)(c,function(u){var d=u&&yc({},u);if(Array.isArray(l)&&d){var h=l[0],p=l[1],v=l[2],m=l[3];d[QZ]=d[h]<=d[p]?JZ:tH,d[KZ]=[d[h],d[p],d[v],d[m]]}return d}),r},n=function(r){var o=r.options,c=o.xField,l=o.yField,u=o.fallingFill,d=o.risingFill,h=l[0],p=l[1],v=l[2],m=l[3],b=hm(c);return r.options.children=(0,H.map)(r.options.children,function(x,S){var E=S===0;return yc(yc({},x),{tooltip:{title:function(w,M,L){var I=b(w,M,L);return I instanceof Date?I.toLocaleString():I},items:[{field:v},{field:m},{field:h},{field:p}]},encode:yc(yc({},x.encode||{}),{y:E?[v,m]:[h,p],color:function(w){return Math.sign(w[p]-w[h])}}),style:yc(yc({},x.style||{}),{lineWidth:E?1:10})})}),delete o.yField,r.options.legend={color:!1},u&&(0,H.set)(r,"options.scale.color.range[0]",u),d&&(0,H.set)(r,"options.scale.color.range[2]",d),r};return(0,H.flow)(e,n,Br)(t)}var nH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),rH=["#26a69a","#999999","#ef5350"],iH=function(t){nH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="stock",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{domain:[-1,0,1],range:rH},y:{nice:!0}},children:[{type:"link"},{type:"link"}],axis:{x:{title:!1,grid:!1},y:{title:!1,grid:!0,gridLineDash:null}},animate:{enter:{type:"scaleInY"}},interaction:{tooltip:{shared:!0,marker:!1,groupName:!1,crosshairs:!0}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return eH},e}(Mr);function oH(t){return(0,H.flow)(gi,Br)(t)}var aH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sH=function(t){aH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyLine",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"line",axis:!1}],animate:{enter:{type:"growInX",duration:500}},padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return oH},e}(Mr);function cH(t){return(0,H.flow)(gi,Br)(t)}var lH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),uH=function(t){lH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyArea",n}return e.getDefaultOptions=function(){return{type:"view",animate:{enter:{type:"growInX",duration:500}},children:[{type:"area",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cH},e}(Mr);function fH(t){return(0,H.flow)(gi,Br)(t)}var dH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hH=function(t){dH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyColumn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval",axis:!1}],padding:0,margin:0,tooltip:!1}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return fH},e}(Mr),Z4=function(){return Z4=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Z4.apply(this,arguments)};function pH(t){var e=function(n){var r=n.options,o=r.percent,c=r.color,l=c===void 0?[]:c;if(!o)return n;var u={scale:{color:{range:l.length?l:[]}},data:[1,o]};return Object.assign(r,Z4({},u)),n};return(0,H.flow)(e,gi,Br)(t)}var gH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vH=function(t){gH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyProgress",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,tooltip:!1,children:[{interaction:{tooltip:!1},coordinate:{transform:[{type:"transpose"}]},type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return pH},e}(Mr),H4=function(){return H4=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},H4.apply(this,arguments)};function mH(t){var e=function(r){var o=r.options,c=o.radius,l=c===void 0?.8:c;return(0,H.set)(r,"options.coordinate.innerRadius",l),r},n=function(r){var o=r.options,c=o.percent,l=o.color,u=l===void 0?[]:l;if(!c)return r;var d={scale:{color:{range:u.length?u:[]}},data:[1,c]};return Object.assign(o,H4({},d)),r};return(0,H.flow)(e,n,gi,Br)(t)}var yH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),bH=function(t){yH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="TinyRing",n}return e.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,coordinate:{type:"theta"},animate:{enter:{type:"waveIn"}},interaction:{tooltip:!1},tooltip:!1,children:[{type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return mH},e}(Mr);function _H(t){return(0,H.flow)(Br)(t)}var xH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),SH=function(t){xH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="rose",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"polar"},animate:{enter:{type:"waveIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _H},e}(Mr),V4="__start__",Dh="__end__",W4="__waterfall_value__",G4=function(){return G4=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},G4.apply(this,arguments)},OH=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))};function EH(t){var e=function(r){var o=r.options,c=o.data,l=c===void 0?[]:c,u=o.yField;return l.length&&(l.reduce(function(d,h,p){var v,m=hm(u),b=m(h,p,l);if(p===0||h.isTotal)h[V4]=0,h[Dh]=b,h[W4]=b;else{var x=(v=d[Dh])!==null&&v!==void 0?v:m(d,p,l);h[V4]=x,h[Dh]=x+b,h[W4]=d[Dh]}return h},[]),Object.assign(o,{yField:[V4,Dh]})),r},n=function(r){var o=r.options,c=o.data,l=c===void 0?[]:c,u=o.xField,d=o.children,h=o.linkStyle,p=OH([],l,!0);return p.reduce(function(v,m,b){return b>0&&(m.x1=v[u],m.x2=m[u],m.y1=v[Dh]),m},[]),p.shift(),d.push({type:"link",xField:["x1","x2"],yField:"y1",zIndex:-1,data:p,style:G4({stroke:"#697474"},h),label:!1,tooltip:!1}),r};return(0,H.flow)(e,n,gi,Br)(t)}var wH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),AH=function(t){wH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="waterfall",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{field:W4,valueFormatter:"~s",name:"value"},axis:{y:{title:null,labelFormatter:"~s"},x:{title:null}},children:[{type:"interval",interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return EH},e}(Mr);function TH(t){var e=function(n){var r=n.options,o=r.data,c=r.binNumber,l=r.binWidth,u=r.children,d=r.channel,h=d===void 0?"count":d,p=(0,H.get)(u,"[0].transform[0]",{});return(0,H.isNumber)(l)?((0,H.assign)(p,{thresholds:(0,H.ceil)((0,H.divide)(o.length,l)),y:h}),n):((0,H.isNumber)(c)&&(0,H.assign)(p,{thresholds:c,y:h}),n)};return(0,H.flow)(e,gi,Br)(t)}var CH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),MH=function(t){CH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Histogram",n}return e.getDefaultOptions=function(){return{type:"view",autoFit:!0,axis:{y:{title:!1},x:{title:!1}},children:[{type:"rect",transform:[{type:"binX",y:"count"}],interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return TH},e}(Mr);function LH(t){var e=function(r){var o=r.options,c=o.tooltip,l=c===void 0?{}:c,u=o.colorField,d=o.sizeField;return l&&!l.field&&(l.field=u||d),r},n=function(r){var o=r.options,c=o.mark,l=o.children;return c&&(l[0].type=c),r};return(0,H.flow)(e,n,gi,Br)(t)}var PH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),IH=function(t){PH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="heatmap",n}return e.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{valueFormatter:"~s"},axis:{y:{title:null,grid:!0},x:{title:null,grid:!0}},children:[{type:"point",interaction:{elementHighlight:{background:!0}}}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return LH},e}(Mr);function RH(t){var e=function(n){var r=n.options.boxType,o=r===void 0?"box":r;return n.options.children[0].type=o,n};return(0,H.flow)(e,gi,Br)(t)}var kH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DH=function(t){kH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="box",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"box"}],axis:{y:{title:!1},x:{title:!1}},tooltip:{items:[{name:"min",channel:"y"},{name:"q1",channel:"y1"},{name:"q2",channel:"y2"},{name:"q3",channel:"y3"},{name:"max",channel:"y4"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return RH},e}(Mr);function FH(t){var e=function(n){var r=n.options,o=r.data,c=[{type:"custom",callback:function(u){return{links:u}}}];if((0,H.isArray)(o))o.length>0?(0,H.set)(r,"data",{value:o,transform:c}):delete r.children;else if((0,H.get)(o,"type")==="fetch"&&(0,H.get)(o,"value")){var l=(0,H.get)(o,"transform");(0,H.isArray)(l)?(0,H.set)(o,"transform",l.concat(c)):(0,H.set)(o,"transform",c)}return n};return(0,H.flow)(e,gi,Br)(t)}var NH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BH=function(t){NH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="sankey",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sankey"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return FH},e}(Mr);function jH(t){var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}],t}function zH(t){jH(t);var e=t.options.layout,n=e===void 0?"horizontal":e;return t.options.children.forEach(function(r){var o;!((o=r==null?void 0:r.coordinate)===null||o===void 0)&&o.transform&&(r.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}])}),t}var Ha=function(){return Ha=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ha.apply(this,arguments)},fO=["#f0efff","#5B8FF9","#3D76DD"];function Y4(t,e,n,r){r===void 0&&(r=!0);var o=0,c=!1,l=(0,H.map)(t,function(u){var d,h,p=(0,H.get)(u,[e]);if((0,H.isNil)(p))return[];if((0,H.isString)(p)){var v=Number(p);return isNaN(v)?[]:(d={},d[n]=u[n],d[e]=v,d)}return(0,H.isArray)(p)?(c=!0,o=Math.max(o,p.length),(0,H.map)(r?p.sort(function(m,b){return b-m}):p,function(m,b){var x;return x={},x[n]=u[n],x[e]=m,x.index=b,x})):(o=Math.max(1,o),h={},h[n]=u[n],h[e]=p,h)}).flat();return c?[l.map(function(u){return Ha({index:0},u)}),o]:[l,o]}function $4(t,e){return new Array(t).fill("").map(function(n,r){return(0,H.isArray)(e)?e[r%e.length]:e})}function UH(t){var e=function(o){var c=o.options,l=c.color,u=c.rangeField,d=u===void 0?"ranges":u,h=c.measureField,p=h===void 0?"measures":h,v=c.targetField,m=v===void 0?"targets":v,b=c.xField,x=b===void 0?"title":b,S=c.mapField,E=c.data,w=Y4(E,d,x),M=w[0],L=w[1],I=Y4(E,p,x,!1),R=I[0],z=I[1],W=Y4(E,m,x,!1),Y=W[0],st=W[1],xt=(0,H.get)(l,[d],fO[0]),Nt=(0,H.get)(l,[p],fO[1]),Ht=(0,H.get)(l,[m],fO[2]),dt=[$4(L,xt),$4(z,Nt),$4(st,Ht)].flat();return o.options.children=(0,H.map)(o.options.children,function(Ot,bt){var wt=[M,R,Y][bt],oe=[d,p,m][bt];return Ha(Ha({},Ot),{data:wt,encode:Ha(Ha({},Ot.encode||{}),{x,y:oe,color:function(Ut){var Kt=Ut.index,me=(0,H.isNumber)(Kt)?"".concat(oe,"_").concat(Kt):oe;return S?(0,H.get)(S,[oe,Kt],me):me}}),style:Ha(Ha({},Ot.style||{}),{zIndex:function(Ut){return-Ut[oe]}}),labels:bt!==0?(0,H.map)(Ot.labels,function(Ut){return Ha(Ha({},Ut),{text:oe})}):void 0})}),o.options.scale.color.range=dt,o.options.legend.color.itemMarker=function(Ot){return S&&(0,H.includes)(S==null?void 0:S[m],Ot)||(Ot==null?void 0:Ot.replace(/\_\d$/,""))===m?"line":"square"},o},n=function(o){var c=o.options.layout,l=c===void 0?"horizontal":c;return l!=="horizontal"&&(0,H.set)(o,"options.children[2].shapeField","hyphen"),o},r=function(o){var c=o.options,l=c.range,u=l===void 0?{}:l,d=c.measure,h=d===void 0?{}:d,p=c.target,v=p===void 0?{}:p,m=c.children;return o.options.children=[u,h,v].map(function(b,x){return El(m[x],b)}),o};return(0,H.flow)(e,n,r,zH,Br)(t)}var ZH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),HH=function(t){ZH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="bullet",n}return e.getDefaultOptions=function(){return{type:"view",scale:{color:{range:fO}},legend:{color:{itemMarker:function(n){return n==="target"?"line":"square"}}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval",style:{maxWidth:30},axis:{y:{grid:!0,gridLineWidth:2}}},{type:"interval",style:{maxWidth:20},transform:[{type:"stackY"}]},{type:"point",encode:{size:8,shape:"line"}}],interaction:{tooltip:{shared:!0}},coordinate:{transform:[{type:"transpose"}]}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return UH},e}(Mr);function VH(t){var e=function(n){var r=n.options.data;return n.options.data={value:r},n};return(0,H.flow)(e,gi,Br)(t)}var WH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),GH=function(t){WH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Gauge",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"gauge"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return VH},e}(Mr);function YH(t){var e=function(n){var r=n.options.percent;return(0,H.isNumber)(r)&&((0,H.set)(n,"options.data",r),delete n.options.percent),n};return(0,H.flow)(e,gi,Br)(t)}var $H=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),XH=function(t){$H(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Liquid",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"liquid"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return YH},e}(Mr);function qH(t){return(0,H.flow)(gi,Br)(t)}var KH=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),QH=function(t){KH(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="WordCloud",n}return e.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"wordCloud"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return qH},e}(Mr);function JH(t){var e=function(n){var r=n.options,o=r.data;return o&&(0,H.set)(r,"data",{value:o}),n};return(0,H.flow)(e,gi,Br)(t)}var tV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),eV=function(t){tV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="treemap",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"treemap"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return JH},e}(Mr),hf=function(){return hf=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},hf.apply(this,arguments)};function nV(t){var e=function(o){var c=o.options,l=c.startAngle,u=c.maxAngle,d=c.coordinate,h=(0,H.isNumber)(l)?l/(2*Math.PI)*360:-90,p=(0,H.isNumber)(u)?(Number(u)+h)/180*Math.PI:Math.PI;return(0,H.set)(o,["options","coordinate"],hf(hf({},d),{endAngle:p,startAngle:l!=null?l:-Math.PI/2})),o},n=function(o){var c=o.options,l=c.tooltip,u=c.xField,d=c.yField,h=hm(u),p=hm(d);return l||(0,H.set)(c,"tooltip",{title:!1,items:[function(v,m,b){return{name:h(v,m,b),value:p(v,m,b)}}]}),o},r=function(o){var c=o.options,l=c.markBackground,u=c.children,d=c.scale,h=c.coordinate,p=c.xField,v=(0,H.get)(d,"y.domain",[]);return l&&u.unshift(hf({type:"interval",xField:p,yField:v[v.length-1],colorField:l.color,scale:{color:{type:"identity"}},style:{fillOpacity:l.opacity,fill:l.color?void 0:"#e0e4ee"},coordinate:hf(hf({},h),{startAngle:-Math.PI/2,endAngle:1.5*Math.PI}),animate:!1},l)),o};return(0,H.flow)(e,n,r,gi,Br)(t)}var rV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),iV=function(t){rV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="radial",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"radial",innerRadius:.1,outerRadius:1,endAngle:Math.PI},animate:{enter:{type:"waveIn",duration:800}},axis:{y:{nice:!0,labelAutoHide:!0,labelAutoRotate:!1},x:{title:!1,nice:!0,labelAutoRotate:!1,labelAutoHide:{type:"equidistance",cfg:{minGap:6}}}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return nV},e}(Mr);function oV(t){return(0,H.flow)(Br)(t)}var aV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sV=function(t){aV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="CirclePacking",n}return e.getDefaultOptions=function(){return{legend:!1,type:"view",children:[{type:"pack"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return oV},e}(Mr),dO=function(){return dO=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},dO.apply(this,arguments)};function cV(t){var e=function(n){var r=n.options,o=r.xField,c=r.yField,l=r.seriesField,u=r.children,d=u==null?void 0:u.map(function(h){return dO(dO({},h),{xField:o,yField:c,seriesField:l,colorField:l,data:h.type==="density"?{transform:[{type:"kde",field:c,groupBy:[o,l]}]}:h.data})}).filter(function(h){return r.violinType!=="density"||h.type==="density"});return(0,H.set)(r,"children",d),r.violinType==="polar"&&(0,H.set)(r,"coordinate",{type:"polar"}),(0,H.set)(r,"violinType",void 0),n};return(0,H.flow)(e,gi,Br)(t)}var lV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),uV=function(t){lV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="violin",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"density",sizeField:"size",tooltip:!1},{type:"boxplot",shapeField:"violin",style:{opacity:.5,point:!1}}],animate:{enter:{type:"fadeIn"}}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cV},e}(Mr),pm=function(){return pm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},pm.apply(this,arguments)},fV=function(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return t.concat(c||Array.prototype.slice.call(e))};function dV(t){var e=function(c){var l=c.options,u=l.yField,d=l.children;return d.forEach(function(h,p){(0,H.set)(h,"yField",u[p])}),c},n=function(c){var l=c.options,u=l.yField,d=l.children,h=l.data;if((0,H.isPlainObject)(h))return c;var p=(0,H.isArray)((0,H.get)(h,[0]))?h:[h,h];return d.forEach(function(v,m){(0,H.set)(v,"data",fV([],p[m].map(function(b){return pm({groupKey:u[m]},b)}),!0))}),c},r=function(c){var l=c.options,u=l.yField,d=u[0],h=u[1],p=l.tooltip;return p||(0,H.set)(l,"tooltip",{items:[{field:d,value:d},{field:h,value:h}]}),c},o=function(c){var l=c.options,u=l.children,d=l.layout,h=l.coordinate.transform,p=l.paddingBottom,v=p===void 0?WR:p,m=l.paddingLeft,b=m===void 0?WR:m,x=l.axis;(0,H.set)(l,"axisText",pm(pm({},(x==null?void 0:x.x)||{}),{layout:d}));var S=u[0],E=u[1];if(d==="vertical")(0,H.set)(l,"direction","col"),(0,H.set)(l,"paddingLeft",b),(0,H.set)(l,"coordinate.transform",h.filter(function(R){return R.type!=="transpose"})),(0,H.set)(S,"paddingBottom",VR),(0,H.set)(E,"paddingTop",VR),(0,H.set)(E,"axis",{x:{position:"top"}}),(0,H.set)(E,"scale",{y:{range:[0,1]}});else{(0,H.set)(l,"paddingBottom",v),(0,H.set)(S,"scale",{y:{range:[0,1]}});var w=S.paddingRight,M=w===void 0?z4:w,L=E.paddingLeft,I=L===void 0?z4:L;(0,H.set)(S,"paddingRight",M),(0,H.set)(S,"axis",{x:{position:"right"}}),(0,H.set)(E,"paddingLeft",I)}return c};return(0,H.flow)(e,n,r,o,gi,Br)(t)}var hV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pV=function(t){hV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="BidirectionalBar",n}return e.getDefaultOptions=function(){return{type:"spaceFlex",coordinate:{transform:[{type:"transpose"}]},scale:{y:{nice:!0}},direction:"row",layout:"horizontal",legend:!1,axis:{y:{title:!1},x:{title:!1,label:!1}},children:[{type:"interval"},{type:"interval"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return dV},e}(Mr),pf;(function(t){t.color="key",t.d="path"})(pf||(pf={}));function gV(t){var e=function(n){var r=n.options,o=r.data,c=r.setsField,l=r.sizeField;return(0,H.isArray)(o)&&((0,H.set)(r,"data",{type:"inline",value:o,transform:[{type:"venn",sets:c,size:l,as:[pf.color,pf.d]}]}),(0,H.set)(r,"colorField",c),(0,H.set)(r,["children","0","encode","d"],pf.d)),(0,H.set)(n,"options",(0,H.omit)(r,["sizeField","setsField"])),n};return(0,H.flow)(e,Br)(t)}var vV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),mV=function(t){vV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="venn",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"path"}],legend:{color:{itemMarker:"circle"}},encode:{color:pf.color,d:pf.d}}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return gV},e}(Mr);function yV(t){var e=function(n){return n};return(0,H.flow)(e,Br)(t)}var bV=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(r[c]=o[c])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_V=function(t){bV(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.type="Sunburst",n}return e.getDefaultOptions=function(){return{type:"view",children:[{type:"sunburst"}]}},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return yV},e}(Mr),xV={Base:xZ,Line:UZ,Column:RZ,Pie:VZ,Area:TZ,Bar:LZ,DualAxes:XR,Funnel:BZ,Scatter:YZ,Radar:qZ,Rose:SH,Stock:iH,TinyLine:sH,TinyArea:uH,TinyColumn:hH,TinyProgress:vH,TinyRing:bH,Waterfall:AH,Histogram:MH,Heatmap:IH,Box:DH,Sankey:BH,Bullet:HH,Gauge:GH,Liquid:XH,WordCloud:QH,Treemap:eV,RadialBar:iV,CirclePacking:sV,Violin:uV,BidirectionalBar:pV,Venn:mV,Mix:XR,Sunburst:_V},X4=function(){return X4=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},X4.apply(this,arguments)},qR=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n},SV=(0,q.forwardRef)(function(t,e){var n=t.chartType,r=n===void 0?"Base":n,o=qR(t,["chartType"]),c=o.containerStyle,l=c===void 0?{height:"inherit",flex:1}:c,u=o.containerAttributes,d=u===void 0?{}:u,h=o.className,p=o.loading,v=o.loadingTemplate,m=o.errorTemplate,b=qR(o,["containerStyle","containerAttributes","className","loading","loadingTemplate","errorTemplate"]),x=ot(xV[r],b),S=x.chart,E=x.container;return(0,q.useImperativeHandle)(e,function(){return S.current}),q.createElement(Mt,{errorTemplate:m},p&&q.createElement(Rt,{loadingTemplate:v}),q.createElement("div",X4({className:h,style:l,ref:E},d)))})},78677:function(ke,Se,k){"use strict";var pt=k(67294),it=k(54686),_t=function(){return _t=Object.assign||function(q){for(var Zt,Bt=1,Wt=arguments.length;Bt<Wt;Bt++){Zt=arguments[Bt];for(var ct in Zt)Object.prototype.hasOwnProperty.call(Zt,ct)&&(q[ct]=Zt[ct])}return q},_t.apply(this,arguments)},qt=(0,pt.forwardRef)(function(q,Zt){return pt.createElement(it.P,_t({},q,{chartType:"Column",ref:Zt}))});Se.Z=qt},80652:function(ke,Se,k){"use strict";var pt=k(67294),it=k(54686),_t=function(){return _t=Object.assign||function(q){for(var Zt,Bt=1,Wt=arguments.length;Bt<Wt;Bt++){Zt=arguments[Bt];for(var ct in Zt)Object.prototype.hasOwnProperty.call(Zt,ct)&&(q[ct]=Zt[ct])}return q},_t.apply(this,arguments)},qt=(0,pt.forwardRef)(function(q,Zt){return pt.createElement(it.P,_t({},q,{chartType:"Line",ref:Zt}))});Se.Z=qt},63430:function(ke,Se,k){"use strict";var pt=k(67294),it=k(54686),_t=function(){return _t=Object.assign||function(q){for(var Zt,Bt=1,Wt=arguments.length;Bt<Wt;Bt++){Zt=arguments[Bt];for(var ct in Zt)Object.prototype.hasOwnProperty.call(Zt,ct)&&(q[ct]=Zt[ct])}return q},_t.apply(this,arguments)},qt=(0,pt.forwardRef)(function(q,Zt){return pt.createElement(it.P,_t({},q,{chartType:"Pie",ref:Zt}))});Se.Z=qt},6466:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return ye}});var pt=k(4942),it=k(1413),_t=k(45987),qt=k(28459),q=k(93967),Zt=k.n(q),Bt=k(67294),Wt=k(53911),ct=k(44962),ee=k(98082),K=function($){return(0,pt.Z)({},$.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:$.marginLG,marginInline:0,color:$.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function J(Vt){return(0,ee.Xj)("ProCardOperation",function($){var ae=(0,it.Z)((0,it.Z)({},$),{},{componentCls:".".concat(Vt)});return[K(ae)]})}var Ct=k(85893),ft=function($){var ae=$.className,Gt=$.style,_e=Gt===void 0?{}:Gt,xe=$.children,X=(0,Bt.useContext)(qt.ZP.ConfigContext),Rt=X.getPrefixCls,V=Rt("pro-card-operation"),Mt=J(V),H=Mt.wrapSSR,N=Mt.hashId,et=Zt()(V,ae,N);return H((0,Ct.jsx)("div",{className:et,style:_e,children:xe}))},mt=ft,lt=k(96604),jt=function($){return(0,pt.Z)({},$.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,pt.Z)({flexDirection:"row"},"".concat($.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat($.colorBorder)}})};function ue(Vt){return(0,ee.Xj)("StatisticCard",function($){var ae=(0,it.Z)((0,it.Z)({},$),{},{componentCls:".".concat(Vt)});return[jt(ae)]})}var we=["children","statistic","className","chart","chartPlacement","footer"],Ne=function($){var ae=$.children,Gt=$.statistic,_e=$.className,xe=$.chart,X=$.chartPlacement,Rt=$.footer,V=(0,_t.Z)($,we),Mt=(0,Bt.useContext)(qt.ZP.ConfigContext),H=Mt.getPrefixCls,N=H("pro-statistic-card"),et=ue(N),ot=et.wrapSSR,At=et.hashId,Dt=Zt()(N,_e,At),ie=Gt&&(0,Ct.jsx)(lt.Z,(0,it.Z)({layout:"vertical"},Gt)),Tt=Zt()("".concat(N,"-chart"),At,(0,pt.Z)((0,pt.Z)({},"".concat(N,"-chart-left"),X==="left"&&xe&&Gt),"".concat(N,"-chart-right"),X==="right"&&xe&&Gt)),zt=xe&&(0,Ct.jsx)("div",{className:Tt,children:xe}),Oe=Zt()("".concat(N,"-content "),At,(0,pt.Z)({},"".concat(N,"-content-horizontal"),X==="left"||X==="right")),Lt=(zt||ie)&&(X==="left"?(0,Ct.jsxs)("div",{className:Oe,children:[zt,ie]}):(0,Ct.jsxs)("div",{className:Oe,children:[ie,zt]})),nt=Rt&&(0,Ct.jsx)("div",{className:"".concat(N,"-footer ").concat(At).trim(),children:Rt});return ot((0,Ct.jsxs)(Wt.Z,(0,it.Z)((0,it.Z)({className:Dt},V),{},{children:[Lt,ae,nt]})))},Ge=function($){return(0,Ct.jsx)(Ne,(0,it.Z)({bodyStyle:{padding:0}},$))};Ne.Statistic=lt.Z,Ne.Divider=ct.Z,Ne.Operation=mt,Ne.isProCard=!0,Ne.Group=Ge;var ye=Ne},96604:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return yt}});var pt=k(1413),it=k(4942),_t=k(45987),qt=k(87462),q=k(67294),Zt=k(36688),Bt=k(55304),Wt=function(F,T){return q.createElement(Bt.Z,(0,qt.Z)({},F,{ref:T,icon:Zt.Z}))},ct=q.forwardRef(Wt),ee=ct,K=k(28459),J=k(83062),Ct=k(40411),ft=k(57838),mt=k(96159),lt=k(93967),jt=k.n(lt),ue=k(64217),we=k(53124),Ne=k(48054),ye=St=>{const{value:F,formatter:T,precision:gt,decimalSeparator:ne,groupSeparator:C="",prefixCls:j}=St;let Pt;if(typeof T=="function")Pt=T(F);else{const Jt=String(F),se=Jt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!se||Jt==="-")Pt=Jt;else{const Ae=se[1];let Le=se[2]||"0",De=se[4]||"";Le=Le.replace(/\B(?=(\d{3})+(?!\d))/g,C),typeof gt=="number"&&(De=De.padEnd(gt,"0").slice(0,gt>0?gt:0)),De&&(De=`${ne}${De}`),Pt=[q.createElement("span",{key:"int",className:`${j}-content-value-int`},Ae,Le),De&&q.createElement("span",{key:"decimal",className:`${j}-content-value-decimal`},De)]}}return q.createElement("span",{className:`${j}-content-value`},Pt)},Vt=k(14747),$=k(83559),ae=k(83262);const Gt=St=>{const{componentCls:F,marginXXS:T,padding:gt,colorTextDescription:ne,titleFontSize:C,colorTextHeading:j,contentFontSize:Pt,fontFamily:Jt}=St;return{[F]:Object.assign(Object.assign({},(0,Vt.Wf)(St)),{[`${F}-title`]:{marginBottom:T,color:ne,fontSize:C},[`${F}-skeleton`]:{paddingTop:gt},[`${F}-content`]:{color:j,fontSize:Pt,fontFamily:Jt,[`${F}-content-value`]:{display:"inline-block",direction:"ltr"},[`${F}-content-prefix, ${F}-content-suffix`]:{display:"inline-block"},[`${F}-content-prefix`]:{marginInlineEnd:T},[`${F}-content-suffix`]:{marginInlineStart:T}}})}},_e=St=>{const{fontSizeHeading3:F,fontSize:T}=St;return{titleFontSize:T,contentFontSize:F}};var xe=(0,$.I$)("Statistic",St=>{const F=(0,ae.mergeToken)(St,{});return[Gt(F)]},_e),X=function(St,F){var T={};for(var gt in St)Object.prototype.hasOwnProperty.call(St,gt)&&F.indexOf(gt)<0&&(T[gt]=St[gt]);if(St!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ne=0,gt=Object.getOwnPropertySymbols(St);ne<gt.length;ne++)F.indexOf(gt[ne])<0&&Object.prototype.propertyIsEnumerable.call(St,gt[ne])&&(T[gt[ne]]=St[gt[ne]]);return T},V=St=>{const{prefixCls:F,className:T,rootClassName:gt,style:ne,valueStyle:C,value:j=0,title:Pt,valueRender:Jt,prefix:se,suffix:Ae,loading:Le=!1,formatter:De,precision:Ve,decimalSeparator:We=".",groupSeparator:$e=",",onMouseEnter:Ye,onMouseLeave:Xt}=St,re=X(St,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:le,direction:pe,statistic:Q}=q.useContext(we.E_),D=le("statistic",F),[Z,tt,Et]=xe(D),It=q.createElement(ye,{decimalSeparator:We,groupSeparator:$e,prefixCls:D,formatter:De,precision:Ve,value:j}),ce=jt()(D,{[`${D}-rtl`]:pe==="rtl"},Q==null?void 0:Q.className,T,gt,tt,Et),fe=(0,ue.Z)(re,{aria:!0,data:!0});return Z(q.createElement("div",Object.assign({},fe,{className:ce,style:Object.assign(Object.assign({},Q==null?void 0:Q.style),ne),onMouseEnter:Ye,onMouseLeave:Xt}),Pt&&q.createElement("div",{className:`${D}-title`},Pt),q.createElement(Ne.Z,{paragraph:!1,loading:Le,className:`${D}-skeleton`},q.createElement("div",{style:C,className:`${D}-content`},se&&q.createElement("span",{className:`${D}-content-prefix`},se),Jt?Jt(It):It,Ae&&q.createElement("span",{className:`${D}-content-suffix`},Ae)))))};const Mt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function H(St,F){let T=St;const gt=/\[[^\]]*]/g,ne=(F.match(gt)||[]).map(Jt=>Jt.slice(1,-1)),C=F.replace(gt,"[]"),j=Mt.reduce((Jt,se)=>{let[Ae,Le]=se;if(Jt.includes(Ae)){const De=Math.floor(T/Le);return T-=De*Le,Jt.replace(new RegExp(`${Ae}+`,"g"),Ve=>{const We=Ve.length;return De.toString().padStart(We,"0")})}return Jt},C);let Pt=0;return j.replace(gt,()=>{const Jt=ne[Pt];return Pt+=1,Jt})}function N(St,F){const{format:T=""}=F,gt=new Date(St).getTime(),ne=Date.now(),C=Math.max(gt-ne,0);return H(C,T)}var et=function(St,F){var T={};for(var gt in St)Object.prototype.hasOwnProperty.call(St,gt)&&F.indexOf(gt)<0&&(T[gt]=St[gt]);if(St!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ne=0,gt=Object.getOwnPropertySymbols(St);ne<gt.length;ne++)F.indexOf(gt[ne])<0&&Object.prototype.propertyIsEnumerable.call(St,gt[ne])&&(T[gt[ne]]=St[gt[ne]]);return T};const ot=1e3/30;function At(St){return new Date(St).getTime()}const Dt=St=>{const{value:F,format:T="HH:mm:ss",onChange:gt,onFinish:ne}=St,C=et(St,["value","format","onChange","onFinish"]),j=(0,ft.Z)(),Pt=q.useRef(null),Jt=()=>{ne==null||ne(),Pt.current&&(clearInterval(Pt.current),Pt.current=null)},se=()=>{const De=At(F);De>=Date.now()&&(Pt.current=setInterval(()=>{j(),gt==null||gt(De-Date.now()),De<Date.now()&&Jt()},ot))};q.useEffect(()=>(se(),()=>{Pt.current&&(clearInterval(Pt.current),Pt.current=null)}),[F]);const Ae=(De,Ve)=>N(De,Object.assign(Object.assign({},Ve),{format:T})),Le=De=>(0,mt.Tm)(De,{title:void 0});return q.createElement(V,Object.assign({},C,{value:F,valueRender:Le,formatter:Ae}))};var ie=q.memo(Dt);V.Countdown=ie;var Tt=V,zt=k(98082),Oe=function(F){return(0,it.Z)({},F.componentCls,(0,it.Z)((0,it.Z)((0,it.Z)((0,it.Z)((0,it.Z)({display:"flex",fontSize:F.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,it.Z)({display:"flex",width:"100%"},"".concat(F.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,it.Z)({width:"100%"},"".concat(F.antCls,"-statistic-content"),{"&-value-int":{fontSize:F.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(F.antCls,"-statistic-title"),{color:F.colorText}),"&-trend-up",(0,it.Z)({},"".concat(F.antCls,"-statistic-content"),(0,it.Z)({color:"#f5222d"},"".concat(F.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,it.Z)({},"".concat(F.antCls,"-statistic-content"),(0,it.Z)({color:"#389e0d"},"".concat(F.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,it.Z)((0,it.Z)((0,it.Z)({display:"flex",justifyContent:"space-between"},"".concat(F.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(F.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(F.antCls,"-statistic-title,").concat(F.antCls,"-statistic-content,").concat(F.antCls,"-statistic-content-suffix,").concat(F.antCls,"-statistic-content-prefix,").concat(F.antCls,"-statistic-content-value-decimal"),{fontSize:F.fontSize})),"& &-layout-inline",(0,it.Z)((0,it.Z)((0,it.Z)({display:"inline-flex",color:F.colorTextSecondary},"".concat(F.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(F.antCls,"-statistic-content"),{color:F.colorTextSecondary}),"".concat(F.antCls,"-statistic-title,").concat(F.antCls,"-statistic-content,").concat(F.antCls,"-statistic-content-suffix,").concat(F.antCls,"-statistic-content-prefix,").concat(F.antCls,"-statistic-content-value-decimal"),{fontSize:F.fontSizeSM})))};function Lt(St){return(0,zt.Xj)("Statistic",function(F){var T=(0,pt.Z)((0,pt.Z)({},F),{},{componentCls:".".concat(St)});return[Oe(T)]})}var nt=k(85893),Ft=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],he=function(F){var T=F.className,gt=F.layout,ne=gt===void 0?"inline":gt,C=F.style,j=F.description,Pt=F.children,Jt=F.title,se=F.tip,Ae=F.status,Le=F.trend,De=F.prefix,Ve=F.icon,We=(0,_t.Z)(F,Ft),$e=(0,q.useContext)(K.ZP.ConfigContext),Ye=$e.getPrefixCls,Xt=Ye("pro-card-statistic"),re=Lt(Xt),le=re.wrapSSR,pe=re.hashId,Q=jt()(Xt,T,pe),D=jt()("".concat(Xt,"-status"),pe),Z=jt()("".concat(Xt,"-icon"),pe),tt=jt()("".concat(Xt,"-wrapper"),pe),Et=jt()("".concat(Xt,"-content"),pe),It=jt()(pe,(0,it.Z)((0,it.Z)({},"".concat(Xt,"-layout-").concat(ne),ne),"".concat(Xt,"-trend-").concat(Le),Le)),ce=se&&(0,nt.jsx)(J.Z,{title:se,children:(0,nt.jsx)(ee,{className:"".concat(Xt,"-tip ").concat(pe).trim()})}),fe=jt()("".concat(Xt,"-trend-icon"),pe,(0,it.Z)({},"".concat(Xt,"-trend-icon-").concat(Le),Le)),Be=Le&&(0,nt.jsx)("div",{className:fe}),ze=Ae&&(0,nt.jsx)("div",{className:D,children:(0,nt.jsx)(Ct.Z,{status:Ae,text:null})}),an=Ve&&(0,nt.jsx)("div",{className:Z,children:Ve});return le((0,nt.jsxs)("div",{className:Q,style:C,children:[an,(0,nt.jsxs)("div",{className:tt,children:[ze,(0,nt.jsxs)("div",{className:Et,children:[(0,nt.jsx)(Tt,(0,pt.Z)({title:(Jt||ce)&&(0,nt.jsxs)(nt.Fragment,{children:[Jt,ce]}),prefix:(Be||De)&&(0,nt.jsxs)(nt.Fragment,{children:[Be,De]}),className:It},We)),j&&(0,nt.jsx)("div",{className:"".concat(Xt,"-description ").concat(pe).trim(),children:j})]})]})]}))},yt=he},17816:function(ke,Se){(function(k,pt){pt(Se)})(this,function(k){"use strict";function pt(rt){var ht=typeof Symbol=="function"&&Symbol.iterator,Qt=ht&&rt[ht],de=0;if(Qt)return Qt.call(rt);if(rt&&typeof rt.length=="number")return{next:function(){return{value:(rt=rt&&de>=rt.length?void 0:rt)&&rt[de++],done:!rt}}};throw new TypeError(ht?"Object is not iterable.":"Symbol.iterator is not defined.")}function it(rt,ht){var Qt=typeof Symbol=="function"&&rt[Symbol.iterator];if(!Qt)return rt;var de,Ce,Me=Qt.call(rt),ge=[];try{for(;(ht===void 0||0<ht--)&&!(de=Me.next()).done;)ge.push(de.value)}catch(ve){Ce={error:ve}}finally{try{de&&!de.done&&(Qt=Me.return)&&Qt.call(Me)}finally{if(Ce)throw Ce.error}}return ge}function _t(rt,ht,Qt){if(Qt||arguments.length===2)for(var de,Ce=0,Me=ht.length;Ce<Me;Ce++)!de&&Ce in ht||((de=de||Array.prototype.slice.call(ht,0,Ce))[Ce]=ht[Ce]);return rt.concat(de||Array.prototype.slice.call(ht))}function qt(rt){return Zt(rt,"Function")}var q={}.toString,Zt=function(rt,ht){return q.call(rt)==="[object "+ht+"]"},Bt=function(rt){return Array.isArray?Array.isArray(rt):Zt(rt,"Array")},Wt=function(rt){if(typeof(ht=rt)!="object"||ht===null||!Zt(rt,"Object"))return!1;var ht;if(Object.getPrototypeOf(rt)===null)return!0;for(var Qt=rt;Object.getPrototypeOf(Qt)!==null;)Qt=Object.getPrototypeOf(Qt);return Object.getPrototypeOf(rt)===Qt},ct=function(rt){return Zt(rt,"Number")},ee=Object.values?function(rt){return Object.values(rt)}:function(rt){var ht,Qt=[],de=rt,Ce=function(Ue,He){qt(rt)&&He==="prototype"||Qt.push(Ue)};if(de){if(Bt(de))for(var Me=0,ge=de.length;Me<ge&&Ce(de[Me],Me)!==!1;Me++);else if(ht=typeof de,de!==null&&ht=="object"||ht=="function"){for(var ve in de)if(de.hasOwnProperty(ve)&&Ce(de[ve],ve)===!1)break}}return Qt},K=5;function J(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];for(var de=0;de<ht.length;de+=1)(function Ce(Me,ge,ve,Ue){for(var He in ve=ve||0,Ue=Ue||K,ge){var hn;ge.hasOwnProperty(He)&&((hn=ge[He])!==null&&Wt(hn)?(Wt(Me[He])||(Me[He]={}),ve<Ue?Ce(Me[He],hn,ve+1,Ue):Me[He]=ge[He]):Bt(hn)?(Me[He]=[],Me[He]=Me[He].concat(hn)):hn!==void 0&&(Me[He]=hn))}})(rt,ht[de]);return rt}function Ct(rt){return rt}(function(rt,ht){var Qt;if(qt(rt))return(Qt=function(){for(var de=[],Ce=0;Ce<arguments.length;Ce++)de[Ce]=arguments[Ce];var Me,ge=ht?ht.apply(this,de):de[0],ve=Qt.cache;return ve.has(ge)?ve.get(ge):(Me=rt.apply(this,de),ve.set(ge,Me),Me)}).cache=new Map;throw new TypeError("Expected a function")})(function(rt,ge){var Qt=(ge=ge===void 0?{}:ge).fontSize,de=ge.fontFamily,Ce=ge.fontWeight,Me=ge.fontStyle,ge=ge.fontVariant;return(ft=ft||document.createElement("canvas").getContext("2d")).font=[Me,ge,Ce,Qt+"px",de].join(" "),ft.measureText(Zt(rt,"String")?rt:"").width},function(rt,ht){return function(){for(var Qt=0,de=0,Ce=arguments.length;de<Ce;de++)Qt+=arguments[de].length;for(var Me=Array(Qt),ge=0,de=0;de<Ce;de++)for(var ve=arguments[de],Ue=0,He=ve.length;Ue<He;Ue++,ge++)Me[ge]=ve[Ue];return Me}([rt],ee(ht=ht===void 0?{}:ht)).join("")});var ft,mt=typeof Float32Array!="undefined"?Float32Array:Array;function lt(){var rt=new mt(9);return mt!=Float32Array&&(rt[1]=0,rt[2]=0,rt[3]=0,rt[5]=0,rt[6]=0,rt[7]=0),rt[0]=1,rt[4]=1,rt[8]=1,rt}Math.hypot||(Math.hypot=function(){for(var rt=0,ht=arguments.length;ht--;)rt+=arguments[ht]*arguments[ht];return Math.sqrt(rt)});var jt=function(rt,vn,En){var de=vn[0],Ce=vn[1],Me=vn[2],ge=vn[3],ve=vn[4],Ue=vn[5],He=vn[6],hn=vn[7],vn=vn[8],Ln=En[0],dn=En[1],Sn=En[2],On=En[3],un=En[4],zn=En[5],Pn=En[6],Un=En[7],En=En[8];return rt[0]=Ln*de+dn*ge+Sn*He,rt[1]=Ln*Ce+dn*ve+Sn*hn,rt[2]=Ln*Me+dn*Ue+Sn*vn,rt[3]=On*de+un*ge+zn*He,rt[4]=On*Ce+un*ve+zn*hn,rt[5]=On*Me+un*Ue+zn*vn,rt[6]=Pn*de+Un*ge+En*He,rt[7]=Pn*Ce+Un*ve+En*hn,rt[8]=Pn*Me+Un*Ue+En*vn,rt};function ue(){var rt=new mt(16);return mt!=Float32Array&&(rt[1]=0,rt[2]=0,rt[3]=0,rt[4]=0,rt[6]=0,rt[7]=0,rt[8]=0,rt[9]=0,rt[11]=0,rt[12]=0,rt[13]=0,rt[14]=0),rt[0]=1,rt[5]=1,rt[10]=1,rt[15]=1,rt}var we=function(rt,Pn,Qt){var de=Pn[0],Ce=Pn[1],Me=Pn[2],ge=Pn[3],ve=Pn[4],Ue=Pn[5],He=Pn[6],hn=Pn[7],vn=Pn[8],Ln=Pn[9],dn=Pn[10],Sn=Pn[11],On=Pn[12],un=Pn[13],zn=Pn[14],Pn=Pn[15],Un=Qt[0],En=Qt[1],Dn=Qt[2],tr=Qt[3];return rt[0]=Un*de+En*ve+Dn*vn+tr*On,rt[1]=Un*Ce+En*Ue+Dn*Ln+tr*un,rt[2]=Un*Me+En*He+Dn*dn+tr*zn,rt[3]=Un*ge+En*hn+Dn*Sn+tr*Pn,Un=Qt[4],En=Qt[5],Dn=Qt[6],tr=Qt[7],rt[4]=Un*de+En*ve+Dn*vn+tr*On,rt[5]=Un*Ce+En*Ue+Dn*Ln+tr*un,rt[6]=Un*Me+En*He+Dn*dn+tr*zn,rt[7]=Un*ge+En*hn+Dn*Sn+tr*Pn,Un=Qt[8],En=Qt[9],Dn=Qt[10],tr=Qt[11],rt[8]=Un*de+En*ve+Dn*vn+tr*On,rt[9]=Un*Ce+En*Ue+Dn*Ln+tr*un,rt[10]=Un*Me+En*He+Dn*dn+tr*zn,rt[11]=Un*ge+En*hn+Dn*Sn+tr*Pn,Un=Qt[12],En=Qt[13],Dn=Qt[14],tr=Qt[15],rt[12]=Un*de+En*ve+Dn*vn+tr*On,rt[13]=Un*Ce+En*Ue+Dn*Ln+tr*un,rt[14]=Un*Me+En*He+Dn*dn+tr*zn,rt[15]=Un*ge+En*hn+Dn*Sn+tr*Pn,rt};function Ne(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];return rt?ht.reduce(function(de,Ce){return function(Me){return Ce(de(Me))}},rt):Ct}function Ge(rt){return rt instanceof Float32Array||rt instanceof Array}function ye(rt,ht,Qt){for(;rt<ht;)rt+=2*Math.PI;for(;Qt<rt;)rt-=2*Math.PI;return rt}tt=new mt(3),mt!=Float32Array&&(tt[0]=0,tt[1]=0,tt[2]=0),tt=new mt(4),mt!=Float32Array&&(tt[0]=0,tt[1]=0,tt[2]=0,tt[3]=0);function Vt(ge,ht,Qt,de,Ce){var Me=(ge=it(ge,2))[0],ge=ge[1],ve=lt();return Me=[Me,ge],(ge=ve)[0]=1,ge[1]=0,ge[2]=0,ge[3]=0,ge[4]=1,ge[5]=0,ge[6]=Me[0],ge[7]=Me[1],ge[8]=1,ge}function $(rt,...ht){return ht.reduce((Qt,de)=>Ce=>Qt(de(Ce)),rt)}function ae(rt,ht){return ht-rt?Qt=>(Qt-rt)/(ht-rt):Qt=>.5}const Gt=Math.sqrt(50),_e=Math.sqrt(10),xe=Math.sqrt(2);function X(rt,ht,Qt){return ht=(ht-rt)/Math.max(0,Qt),rt=Math.floor(Math.log(ht)/Math.LN10),Qt=ht/Ri(10,rt),0<=rt?(Qt>=Gt?10:Qt>=_e?5:Qt>=xe?2:1)*Ri(10,rt):-Ri(10,-rt)/(Qt>=Gt?10:Qt>=_e?5:Qt>=xe?2:1)}const Rt=(rt,ht,Qt=5)=>{rt=[rt,ht];let de=0,Ce=rt.length-1,Me=rt[de],ge=rt[Ce],ve;return ge<Me&&([Me,ge]=[ge,Me],[de,Ce]=[Ce,de]),0<(ve=X(Me,ge,Qt))?(Me=Math.floor(Me/ve)*ve,ge=Math.ceil(ge/ve)*ve,ve=X(Me,ge,Qt)):ve<0&&(Me=Math.ceil(Me*ve)/ve,ge=Math.floor(ge*ve)/ve,ve=X(Me,ge,Qt)),0<ve?(rt[de]=Math.floor(Me/ve)*ve,rt[Ce]=Math.ceil(ge/ve)*ve):ve<0&&(rt[de]=Math.ceil(Me*ve)/ve,rt[Ce]=Math.floor(ge*ve)/ve),rt};function V(rt){return rt!=null&&!Number.isNaN(rt)}function Mt(rt,ht){return Qt=>{Qt.prototype.rescale=function(){this.initRange(),this.nice();var[de]=this.chooseTransforms();this.composeOutput(de,this.chooseClamp(de))},Qt.prototype.initRange=function(){var de=this.options.interpolator;this.options.range=rt(de)},Qt.prototype.composeOutput=function(de,Ce){var Me,{domain:ve,interpolator:ge,round:Ue}=this.getOptions(),ve=ht(ve.map(de)),Ue=Ue?(Me=ge,He=>(He=Me(He),ct(He)?Math.round(He):He)):ge;this.output=$(Ue,ve,Ce,de)},Qt.prototype.invert=void 0}}var H,tt={exports:{}},Z={exports:{}},N=function(rt){return!(!rt||typeof rt=="string")&&(rt instanceof Array||Array.isArray(rt)||0<=rt.length&&(rt.splice instanceof Function||Object.getOwnPropertyDescriptor(rt,rt.length-1)&&rt.constructor.name!=="String"))},et=Array.prototype.concat,ot=Array.prototype.slice,At=Z.exports=function(rt){for(var ht=[],Qt=0,de=rt.length;Qt<de;Qt++){var Ce=rt[Qt];N(Ce)?ht=et.call(ht,ot.call(Ce)):ht.push(Ce)}return ht},Dt=(At.wrap=function(rt){return function(){return rt(At(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),ie=Z.exports,Tt=Object.hasOwnProperty,zt=Object.create(null);for(H in Dt)Tt.call(Dt,H)&&(zt[Dt[H]]=H);var Oe=tt.exports={to:{},get:{}};function Lt(rt,ht,Qt){return Math.min(Math.max(ht,rt),Qt)}function nt(rt){return rt=Math.round(rt).toString(16).toUpperCase(),rt.length<2?"0"+rt:rt}Oe.get=function(rt){var ht,Qt;switch(rt.substring(0,3).toLowerCase()){case"hsl":ht=Oe.get.hsl(rt),Qt="hsl";break;case"hwb":ht=Oe.get.hwb(rt),Qt="hwb";break;default:ht=Oe.get.rgb(rt),Qt="rgb"}return ht?{model:Qt,value:ht}:null},Oe.get.rgb=function(rt){if(!rt)return null;var ht,Qt,de,Ce=[0,0,0,1];if(ht=rt.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(de=ht[2],ht=ht[1],Qt=0;Qt<3;Qt++){var Me=2*Qt;Ce[Qt]=parseInt(ht.slice(Me,2+Me),16)}de&&(Ce[3]=parseInt(de,16)/255)}else if(ht=rt.match(/^#([a-f0-9]{3,4})$/i)){for(de=(ht=ht[1])[3],Qt=0;Qt<3;Qt++)Ce[Qt]=parseInt(ht[Qt]+ht[Qt],16);de&&(Ce[3]=parseInt(de+de,16)/255)}else{if(ht=rt.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(Qt=0;Qt<3;Qt++)Ce[Qt]=parseInt(ht[Qt+1],0);else{if(!(ht=rt.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(ht=rt.match(/^(\w+)$/))?ht[1]==="transparent"?[0,0,0,0]:Tt.call(Dt,ht[1])?((Ce=Dt[ht[1]])[3]=1,Ce):null:null;for(Qt=0;Qt<3;Qt++)Ce[Qt]=Math.round(2.55*parseFloat(ht[Qt+1]))}ht[4]&&(ht[5]?Ce[3]=.01*parseFloat(ht[4]):Ce[3]=parseFloat(ht[4]))}for(Qt=0;Qt<3;Qt++)Ce[Qt]=Lt(Ce[Qt],0,255);return Ce[3]=Lt(Ce[3],0,1),Ce},Oe.get.hsl=function(rt){var ht;return(rt=rt&&rt.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(ht=parseFloat(rt[4]),[(parseFloat(rt[1])%360+360)%360,Lt(parseFloat(rt[2]),0,100),Lt(parseFloat(rt[3]),0,100),Lt(isNaN(ht)?1:ht,0,1)]):null},Oe.get.hwb=function(rt){var ht;return(rt=rt&&rt.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(ht=parseFloat(rt[4]),[(parseFloat(rt[1])%360+360)%360,Lt(parseFloat(rt[2]),0,100),Lt(parseFloat(rt[3]),0,100),Lt(isNaN(ht)?1:ht,0,1)]):null},Oe.to.hex=function(){var rt=ie(arguments);return"#"+nt(rt[0])+nt(rt[1])+nt(rt[2])+(rt[3]<1?nt(Math.round(255*rt[3])):"")},Oe.to.rgb=function(){var rt=ie(arguments);return rt.length<4||rt[3]===1?"rgb("+Math.round(rt[0])+", "+Math.round(rt[1])+", "+Math.round(rt[2])+")":"rgba("+Math.round(rt[0])+", "+Math.round(rt[1])+", "+Math.round(rt[2])+", "+rt[3]+")"},Oe.to.rgb.percent=function(){var rt=ie(arguments),ht=Math.round(rt[0]/255*100),Qt=Math.round(rt[1]/255*100),de=Math.round(rt[2]/255*100);return rt.length<4||rt[3]===1?"rgb("+ht+"%, "+Qt+"%, "+de+"%)":"rgba("+ht+"%, "+Qt+"%, "+de+"%, "+rt[3]+")"},Oe.to.hsl=function(){var rt=ie(arguments);return rt.length<4||rt[3]===1?"hsl("+rt[0]+", "+rt[1]+"%, "+rt[2]+"%)":"hsla("+rt[0]+", "+rt[1]+"%, "+rt[2]+"%, "+rt[3]+")"},Oe.to.hwb=function(){var rt=ie(arguments),ht="";return 4<=rt.length&&rt[3]!==1&&(ht=", "+rt[3]),"hwb("+rt[0]+", "+rt[1]+"%, "+rt[2]+"%"+ht+")"},Oe.to.keyword=function(rt){return zt[rt.slice(0,3)]};var Ft=tt.exports;function he(rt,ht,Qt){let de=Qt;return de<0&&(de+=1),1<de&&--de,de<1/6?rt+6*(ht-rt)*de:de<.5?ht:de<2/3?rt+(ht-rt)*(2/3-de)*6:rt}function yt(Ce){var ht,Qt,de,Ce=Ft.get(Ce);return Ce?({model:Ce,value:ht}=Ce,Ce==="rgb"?ht:Ce==="hsl"?(ht=(Ce=ht)[0]/360,Qt=Ce[1]/100,de=Ce[2]/100,Ce=Ce[3],Qt==0?[255*de,255*de,255*de,Ce]:[255*he(Qt=2*de-(de=de<.5?de*(1+Qt):de+Qt-de*Qt),de,ht+1/3),255*he(Qt,de,ht),255*he(Qt,de,ht-1/3),Ce]):null):null}const St=(rt,ht)=>Qt=>rt*(1-Qt)+ht*Qt,F=(rt,ht)=>{if(typeof rt=="number"&&typeof ht=="number")return St(rt,ht);if(typeof rt!="string"||typeof ht!="string")return()=>rt;{var Qt=rt,de=ht;const Ce=yt(Qt),Me=yt(de);return Ce===null||Me===null?Ce?()=>Qt:()=>de:ge=>{var ve=new Array(4);for(let Sn=0;Sn<4;Sn+=1){var Ue=Ce[Sn],He=Me[Sn];ve[Sn]=Ue*(1-ge)+He*ge}var[hn,vn,Ln,dn]=ve;return`rgba(${Math.round(hn)}, ${Math.round(vn)}, ${Math.round(Ln)}, ${dn})`}}},T=(rt,ht)=>{const Qt=St(rt,ht);return de=>Math.round(Qt(de))};function gt({map:rt,initKey:ht},Qt){return ht=ht(Qt),rt.has(ht)?rt.get(ht):Qt}function ne(rt){return typeof rt=="object"?rt.valueOf():rt}class C extends Map{constructor(ht){if(super(),this.map=new Map,this.initKey=ne,ht!==null)for(var[Qt,de]of ht)this.set(Qt,de)}get(ht){return super.get(gt({map:this.map,initKey:this.initKey},ht))}has(ht){return super.has(gt({map:this.map,initKey:this.initKey},ht))}set(ht,Qt){return super.set(([{map:ht,initKey:de},Ce]=[{map:this.map,initKey:this.initKey},ht],de=de(Ce),ht.has(de)?ht.get(de):(ht.set(de,Ce),Ce)),Qt);var de,Ce}delete(ht){return super.delete(([{map:ht,initKey:Qt},de]=[{map:this.map,initKey:this.initKey},ht],Qt=Qt(de),ht.has(Qt)&&(de=ht.get(Qt),ht.delete(Qt)),de));var Qt,de}}class j{constructor(ht){this.options=J({},this.getDefaultOptions()),this.update(ht)}getOptions(){return this.options}update(ht={}){this.options=J({},this.options,ht),this.rescale(ht)}rescale(ht){}}const Pt=Symbol("defaultUnknown");function Jt(rt,ht,Qt){for(let de=0;de<ht.length;de+=1)rt.has(ht[de])||rt.set(Qt(ht[de]),de)}function se(ht){var{value:ht,from:Qt,to:de,mapper:Ce,notFoundReturn:Me}=ht;let ge=Ce.get(ht);if(ge===void 0){if(Me!==Pt)return Me;ge=Qt.push(ht)-1,Ce.set(ht,ge)}return de[ge%de.length]}function Ae(rt){return rt instanceof Date?ht=>""+ht:typeof rt=="object"?ht=>JSON.stringify(ht):ht=>ht}class Le extends j{getDefaultOptions(){return{domain:[],range:[],unknown:Pt}}constructor(ht){super(ht)}map(ht){return this.domainIndexMap.size===0&&Jt(this.domainIndexMap,this.getDomain(),this.domainKey),se({value:this.domainKey(ht),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(ht){return this.rangeIndexMap.size===0&&Jt(this.rangeIndexMap,this.getRange(),this.rangeKey),se({value:this.rangeKey(ht),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(ht){var[Qt]=this.options.domain,[de]=this.options.range;this.domainKey=Ae(Qt),this.rangeKey=Ae(de),this.rangeIndexMap?(ht&&!ht.range||this.rangeIndexMap.clear(),ht&&!ht.domain&&!ht.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new Le(this.options)}getRange(){return this.options.range}getDomain(){var ht,Qt;return this.sortedDomain||({domain:ht,compare:Qt}=this.options,this.sortedDomain=Qt?[...ht].sort(Qt):ht),this.sortedDomain}}function De(un){const{domain:ht,range:Qt,paddingOuter:de,paddingInner:Ce,flex:Me,round:ge,align:ve}=un;var Ue=ht.length,dn=0<(dn=(un=Ue)-(He=Me).length)?[...He,...new Array(dn).fill(1)]:dn<0?He.slice(0,un):He,[un,He]=Qt,He=He-un,On=He/(2/Ue*de+1-1/Ue*Ce);const hn=On*Ce/Ue;On-=Ue*hn;const vn=function(En){const Dn=Math.min(...En);return En.map(tr=>tr/Dn)}(dn),Ln=On/vn.reduce((En,Dn)=>En+Dn);var dn=new C(ht.map((En,Dn)=>(Dn=vn[Dn]*Ln,[En,ge?Math.floor(Dn):Dn]))),Sn=new C(ht.map((En,Dn)=>(Dn=vn[Dn]*Ln+hn,[En,ge?Math.floor(Dn):Dn]))),On=Array.from(Sn.values()).reduce((En,Dn)=>En+Dn),un=un+(He-(On-On/Ue*Ce))*ve;let zn=ge?Math.round(un):un;var Pn=new Array(Ue);for(let En=0;En<Ue;En+=1){Pn[En]=(Un=zn,Math.round(1e12*Un)/1e12);var Un=ht[En];zn+=Sn.get(Un)}return{valueBandWidth:dn,valueStep:Sn,adjustedRange:Pn}}class Ve extends Le{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:Pt,flex:[]}}constructor(ht){super(ht)}clone(){return new Ve(this.options)}getStep(ht){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:ht===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(ht)}getBandWidth(ht){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:ht===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(ht)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:ht,paddingInner:Qt}=this.options;return 0<ht?ht:Qt}getPaddingOuter(){var{padding:ht,paddingOuter:Qt}=this.options;return 0<ht?ht:Qt}rescale(){super.rescale();var{align:de,domain:ht,range:Ce,round:Me,flex:Qt}=this.options,{adjustedRange:de,valueBandWidth:Ce,valueStep:Me}=function(He){var ve=He.domain;if((ve=ve.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((Ue=He.flex)==null||!Ue.length))return De(He);var{range:Ue,paddingOuter:He,paddingInner:hn,round:vn,align:Ln}=He;let dn,Sn,On=Ue[0];return Ue=Ue[1]-On,dn=Ue/Math.max(1,2*He+(ve-hn)),vn&&(dn=Math.floor(dn)),On+=(Ue-dn*(ve-hn))*Ln,Sn=dn*(1-hn),vn&&(On=Math.round(On),Sn=Math.round(Sn)),He=new Array(ve).fill(0).map((un,zn)=>On+zn*dn),{valueStep:dn,valueBandWidth:Sn,adjustedRange:He}}({align:de,range:Ce,round:Me,flex:Qt,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:ht});this.valueStep=Me,this.valueBandWidth=Ce,this.adjustedRange=de}}const We=(rt,ht,Qt)=>{let de,Ce,Me=rt,ge=ht;if(Me===ge&&0<Qt)return[Me];let ve=X(Me,ge,Qt);if(ve===0||!Number.isFinite(ve))return[];if(0<ve){Me=Math.ceil(Me/ve),ge=Math.floor(ge/ve),Ce=new Array(de=Math.ceil(ge-Me+1));for(let Ue=0;Ue<de;Ue+=1)Ce[Ue]=(Me+Ue)*ve}else{ve=-ve,Me=Math.ceil(Me*ve),ge=Math.floor(ge*ve),Ce=new Array(de=Math.ceil(ge-Me+1));for(let Ue=0;Ue<de;Ue+=1)Ce[Ue]=(Me+Ue)/ve}return Ce},$e=(de,Me,Qt)=>{var[de,Ce]=de,[Me,ge]=Me;let ve,Ue;return $(Ue=de<Ce?(ve=ae(de,Ce),Qt(Me,ge)):(ve=ae(Ce,de),Qt(ge,Me)),ve)},Ye=(rt,ht,Qt)=>{const de=Math.min(rt.length,ht.length)-1,Ce=new Array(de),Me=new Array(de);var ge=rt[0]>rt[de],ve=ge?[...rt].reverse():rt,Ue=ge?[...ht].reverse():ht;for(let He=0;He<de;He+=1)Ce[He]=ae(ve[He],ve[He+1]),Me[He]=Qt(Ue[He],Ue[He+1]);return He=>{var hn=function(Ln,dn,Sn,On,un){let zn=Sn||0,Pn=On||Ln.length;for(var Un=un||(Dn=>Dn);zn<Pn;){var En=Math.floor((zn+Pn)/2);Un(Ln[En])>dn?Pn=En:zn=En+1}return zn}(rt,He,1,de)-1,vn=Ce[hn];return $(Me[hn],vn)(He)}},Xt=(rt,ht,Qt,de)=>(2<Math.min(rt.length,ht.length)?Ye:$e)(rt,ht,de?T:Qt);class re extends j{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:St,tickCount:5}}map(ht){return V(ht)?this.output(ht):this.options.unknown}invert(ht){return V(ht)?this.input(ht):this.options.unknown}nice(){var ht,Qt,de,Ce;this.options.nice&&([ht,Qt,de,...Ce]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(ht,Qt,de,...Ce))}getTicks(){var ht=this.options.tickMethod,[Qt,de,Ce,...Me]=this.getTickMethodOptions();return ht(Qt,de,Ce,...Me)}getTickMethodOptions(){var{domain:ht,tickCount:Qt}=this.options;return[ht[0],ht[ht.length-1],Qt]}chooseNice(){return Rt}rescale(){this.nice();var[ht,Qt]=this.chooseTransforms();this.composeOutput(ht,this.chooseClamp(ht)),this.composeInput(ht,Qt,this.chooseClamp(Qt))}chooseClamp(de){var{clamp:Qt,range:Ce}=this.options,de=this.options.domain.map(de),Ce=Math.min(de.length,Ce.length);if(Qt){Qt=de[0],de=de[Ce-1];const Me=de<Qt?de:Qt,ge=de<Qt?Qt:de;return ve=>Math.min(Math.max(Me,ve),ge)}return Ct}composeOutput(ht,Qt){var{domain:ge,range:de,round:Ce,interpolate:Me}=this.options,ge=Xt(ge.map(ht),de,Me,Ce);this.output=$(ge,Qt,ht)}composeInput(ht,Qt,de){var{domain:Ce,range:Me}=this.options,Me=Xt(Me,Ce.map(ht),St);this.input=$(Qt,de,Me)}}class le extends re{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:F,tickMethod:We,tickCount:5}}chooseTransforms(){return[Ct,Ct]}clone(){return new le(this.options)}}class pe extends Ve{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:Pt,paddingInner:1,paddingOuter:0}}constructor(ht){super(ht)}getPaddingInner(){return 1}clone(){return new pe(this.options)}update(ht){super.update(ht)}getPaddingOuter(){return this.options.padding}}function Q(rt,ht){for(var Qt=[],de=0,Ce=rt.length;de<Ce;de++)Qt.push(rt[de].substr(0,ht));return Qt}var D,Z=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],tt=["January","February","March","April","May","June","July","August","September","October","November","December"],Et=Q(tt,3);(function(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];for(var de=0,Ce=ht;de<Ce.length;de++){var Me,ge=Ce[de];for(Me in ge)rt[Me]=ge[Me]}})({},{dayNamesShort:Q(Z,3),dayNames:Z,monthNamesShort:Et,monthNames:tt,amPm:["am","pm"],DoFn:function(rt){return rt+["th","st","nd","rd"][3<rt%10?0:(rt-rt%10!=10?1:0)*rt%10]}});var It;let ce=D=class extends le{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Ct,tickMethod:We,tickCount:5}}constructor(rt){super(rt)}clone(){return new D(this.options)}};ce=D=function(rt,ht,Qt,de){var Ce,Me=arguments.length,ge=Me<3?ht:de===null?de=Object.getOwnPropertyDescriptor(ht,Qt):de;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ge=Reflect.decorate(rt,ht,Qt,de);else for(var ve=rt.length-1;0<=ve;ve--)(Ce=rt[ve])&&(ge=(Me<3?Ce(ge):3<Me?Ce(ht,Qt,ge):Ce(ht,Qt))||ge);return 3<Me&&ge&&Object.defineProperty(ht,Qt,ge),ge}([Mt(function(rt){return[rt(0),rt(1)]},ht=>{var[ht,Qt]=ht;return $(St(0,1),ae(ht,Qt))})],ce);let fe=It=class extends le{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Ct,tickMethod:We,tickCount:5}}constructor(rt){super(rt)}clone(){return new It(this.options)}};fe=It=function(rt,ht,Qt,de){var Ce,Me=arguments.length,ge=Me<3?ht:de===null?de=Object.getOwnPropertyDescriptor(ht,Qt):de;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ge=Reflect.decorate(rt,ht,Qt,de);else for(var ve=rt.length-1;0<=ve;ve--)(Ce=rt[ve])&&(ge=(Me<3?Ce(ge):3<Me?Ce(ht,Qt,ge):Ce(ht,Qt))||ge);return 3<Me&&ge&&Object.defineProperty(ht,Qt,ge),ge}([Mt(function(rt){return[rt(0),rt(.5),rt(1)]},rt=>{const[ht,Qt,de]=rt,Ce=$(St(0,.5),ae(ht,Qt)),Me=$(St(.5,1),ae(Qt,de));return ge=>(ht>de?ge<Qt?Me:Ce:ge<Qt?Ce:Me)(ge)})],fe);function Be(rt,ht,Qt,de,Ce){var Me=new le({range:[ht,ht+de]}),ge=new le({range:[Qt,Qt+Ce]});return{transform:function(He){var He=it(He,2),Ue=He[0],He=He[1];return[Me.map(Ue),ge.map(He)]},untransform:function(He){var He=it(He,2),Ue=He[0],He=He[1];return[Me.invert(Ue),ge.invert(He)]}}}function ze(rt,ht,Qt,de,Ce){return(0,it(rt,1)[0])(ht,Qt,de,Ce)}function an(rt,ht,Qt,de,Ce){return it(rt,1)[0]}function Re(Ue,ht,Qt,de,Ce){var Me=(Ue=it(Ue,4))[0],ge=Ue[1],ve=Ue[2],Ue=Ue[3],He=new le({range:[ve,Ue]}),hn=new le({range:[Me,ge]}),vn=1<(ve=Ce/de)?1:ve,Ln=1<ve?1/ve:1;return{transform:function(On){var On=it(On,2),Sn=On[0],On=On[1],Sn=hn.map(Sn),On=He.map(On);return[.5*(On*Math.cos(Sn)*vn)+.5,.5*(On*Math.sin(Sn)*Ln)+.5]},untransform:function(un){var un=it(un,2),Sn=un[0],un=un[1],Sn=2*(Sn-.5)/vn,un=2*(un-.5)/Ln,On=Math.sqrt(Math.pow(Sn,2)+Math.pow(un,2)),un=ye(Math.atan2(un,Sn),Me,ge);return[hn.invert(un),He.invert(On)]}}}function Ke(rt,ht,Qt,de,Ce){return{transform:function(ge){var ge=it(ge,2),ve=ge[0];return[ge[1],ve]},untransform:function(ge){var ge=it(ge,2),ve=ge[0];return[ge[1],ve]}}}function cn(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];return yr.apply(void 0,_t([[-1,-1]],it(ht),!1))}function pn(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];return yr.apply(void 0,_t([[-1,1]],it(ht),!1))}function An(rt){for(var ht=[],Qt=1;Qt<arguments.length;Qt++)ht[Qt-1]=arguments[Qt];return yr.apply(void 0,_t([[1,-1]],it(ht),!1))}function Gn(ge,ht,Qt,de,Ce){var Me,ge=it(ge,1)[0],ve=lt();return ve=ve,ge=ge,Me=Math.sin(ge),ge=Math.cos(ge),ve[0]=ge,ve[1]=Me,ve[2]=0,ve[3]=-Me,ve[4]=ge,ve[5]=0,ve[6]=0,ve[7]=0,ve[8]=1,ve}function Vn(rt,ht,Qt,de,Ce){var Me=(rt=it(rt,4))[0],ge=rt[1],ve=rt[2],Ue=(rt[3]-ve)/(+ge/(2*Math.PI)+1),He=Ue/(2*Math.PI),hn=new le({range:[ve,ve+.99*Ue]}),vn=new le({range:[Me,ge]}),Ln=1<(rt=Ce/de)?1:rt,dn=1<rt?1/rt:1;return{transform:function(un){var un=it(un,2),On=un[0],un=un[1],On=vn.map(On),un=hn.map(un);return[.5*(Math.cos(On)*(He*On+un)*Ln)+.5,.5*(Math.sin(On)*(He*On+un)*dn)+.5]},untransform:function(un){var un=it(un,2),zn=un[0],un=un[1],zn=2*(zn-.5)/Ln,un=2*(un-.5)/dn,On=Math.sqrt(Math.pow(zn,2)+Math.pow(un,2)),un=ye(Math.atan2(un,zn)+Math.floor(On/Ue)*Math.PI*2,Me,ge),zn=On-He*un;return[vn.invert(un),hn.invert(zn)]}}}function fr(Ue,ht,Qt,de,Ce){var Me=(Ue=it(Ue,4))[0],ge=Ue[1],ve=Ue[2],Ue=Ue[3],He=new le({range:[ve,Ue]});return{transform:function(hn){for(var vn=[],Ln=hn.length,dn=new pe({domain:new Array(Ln).fill(0).map(function(zn,Pn){return Pn}),range:[Me,ge]}),Sn=0;Sn<Ln;Sn++){var un=hn[Sn],On=dn.map(Sn),un=He.map(un);vn.push(On,un)}return vn},untransform:function(hn){for(var vn=[],Ln=0;Ln<hn.length;Ln+=2){var dn=hn[Ln+1];vn.push(He.invert(dn))}return vn}}}var yr=function(ge,ht,Qt,de,Ce){var ge=it(ge,2),Me=ge[0],ge=ge[1],ve=lt();return Me=[Me,ge],(ge=ve)[0]=Me[0],ge[1]=0,ge[2]=0,ge[3]=0,ge[4]=Me[1],ge[5]=0,ge[6]=0,ge[7]=0,ge[8]=1,ge};function Cr(rt){return 1/Math.tan(rt)}function jr(rt,ht,Qt,de,Ce){var Me=Cr(it(rt,1)[0]);return{transform:function(Ue){var Ue=it(Ue,2),ve=Ue[0],Ue=Ue[1];return[ve+Ue*Me,Ue]},untransform:function(Ue){var Ue=it(Ue,2),ve=Ue[0],Ue=Ue[1];return[ve-Ue*Me,Ue]}}}function Dr(rt,ht,Qt,de,Ce){var Me=Cr(it(rt,1)[0]);return{transform:function(ve){var ve=it(ve,2),Ue=ve[0];return[Ue,ve[1]+Ue*Me]},untransform:function(ve){var ve=it(ve,2),Ue=ve[0];return[Ue,ve[1]-Ue*Me]}}}function Fr(rt,ht,Qt,ve,ge){var Me=rt<ht,ge=(Me?ht-ve:ge-ht)||ge-ve,ve=Me?-1:1;return ve*ge*(Qt+1)/(Qt+ge/((rt-ht)*ve))+ht}function zr(rt,ht,Qt,de,ge){var Me=rt<ht,ge=(Me?ht-de:ge-ht)||ge-de;return ge/(ge*(Qt+1)/(rt-ht)-Qt*(Me?-1:1))+ht}function si(rt,ht,Qt){return Qt?new le({range:[0,1],domain:[0,ht]}).map(rt):rt}function ki(ve,ht,Qt,de,Ce){var Me=(ve=it(ve,3))[0],ge=ve[1],ve=ve[2],Ue=si(Me,de,ve!==void 0&&ve);return{transform:function(vn){var vn=it(vn,2),hn=vn[0],vn=vn[1];return[Fr(hn,Ue,ge,0,1),vn]},untransform:function(vn){var vn=it(vn,2),hn=vn[0],vn=vn[1];return[zr(hn,Ue,ge,0,1),vn]}}}function ui(ve,ht,Qt,de,Ce){var Me=(ve=it(ve,3))[0],ge=ve[1],ve=ve[2],Ue=si(Me,Ce,ve!==void 0&&ve);return{transform:function(He){return He=it(He,2),[He[0],Fr(He[1],Ue,ge,0,1)]},untransform:function(He){return He=it(He,2),[He[0],zr(He[1],Ue,ge,0,1)]}}}function ri(He,ht,Qt,de,Ce){var Me=(He=it(He,5))[0],ge=He[1],ve=He[2],Ue=He[3],He=He[4],hn=si(Me,de,He=He!==void 0&&He),vn=si(ge,Ce,He);return{transform:function(Sn){var Sn=it(Sn,2),dn=Sn[0],Sn=Sn[1];return[Fr(dn,hn,ve,0,1),Fr(Sn,vn,Ue,0,1)]},untransform:function(Sn){var Sn=it(Sn,2),dn=Sn[0],Sn=Sn[1];return[zr(dn,hn,ve,0,1),zr(Sn,vn,Ue,0,1)]}}}function Oi(He,ht,Qt,de,Ce){var Me=(He=it(He,5))[0],ge=He[1],ve=He[2],Ue=He[3],He=(He=He[4])!==void 0&&He,hn=new le({range:[0,de]}),vn=new le({range:[0,Ce]}),Ln=He?Me:hn.map(Me),dn=He?ge:vn.map(ge);return{transform:function(un){var un=it(un,2),On=un[0],un=un[1],zn=hn.map(On)-Ln,Pn=vn.map(un)-dn,Un=Math.sqrt(zn*zn+Pn*Pn);return ve<Un?[On,un]:(On=Fr(Un,0,Ue,0,ve),un=Math.atan2(Pn,zn),Un=Ln+On*Math.cos(un),Pn=dn+On*Math.sin(un),[hn.invert(Un),vn.invert(Pn)])},untransform:function(un){var un=it(un,2),On=un[0],un=un[1],zn=hn.map(On)-Ln,Pn=vn.map(un)-dn,Un=Math.sqrt(zn*zn+Pn*Pn);return ve<Un?[On,un]:(On=zr(Un,0,Ue,0,ve),un=Math.atan2(Pn,zn),Un=Ln+On*Math.cos(un),Pn=dn+On*Math.sin(un),[hn.invert(Un),vn.invert(Pn)])}}}function Ui(rt,ht,Qt,de,Ce,Me,ge){var ve=new le({range:[ht,ht+Ce]}),Ue=new le({range:[Qt,Qt+Me]}),He=new le({range:[de,de+ge]});return{transform:function(dn){var dn=it(dn,3),vn=dn[0],Ln=dn[1],dn=dn[2];return[ve.map(vn),Ue.map(Ln),He.map(dn)]},untransform:function(dn){var dn=it(dn,3),vn=dn[0],Ln=dn[1],dn=dn[2];return[ve.invert(vn),Ue.invert(Ln),He.invert(dn)]}}}function Zo(hn,ht,Qt,de,Ce,Me,ge){var ve,Ue=(hn=it(hn,3))[0],He=hn[1],hn=hn[2];return ve=ue(),Ue=[Ue,He,hn],ve[0]=1,ve[1]=0,ve[2]=0,ve[3]=0,ve[4]=0,ve[5]=1,ve[6]=0,ve[7]=0,ve[8]=0,ve[9]=0,ve[10]=1,ve[11]=0,ve[12]=Ue[0],ve[13]=Ue[1],ve[14]=Ue[2],ve[15]=1,ve}function Xi(rt,ht,Qt,de,Ce,Me,ge){return{transform:function(Ue){var Ue=it(Ue,3),He=Ue[0];return[Ue[1],He,Ue[2]]},untransform:function(Ue){var Ue=it(Ue,3),He=Ue[0];return[Ue[1],He,Ue[2]]}}}function bo(hn,ht,Qt,de,Ce,Me,ge){var ve,Ue=(hn=it(hn,3))[0],He=hn[1],hn=hn[2];return ve=ue(),Ue=[Ue,He,hn],ve[0]=Ue[0],ve[1]=0,ve[2]=0,ve[3]=0,ve[4]=0,ve[5]=Ue[1],ve[6]=0,ve[7]=0,ve[8]=0,ve[9]=0,ve[10]=Ue[2],ve[11]=0,ve[12]=0,ve[13]=0,ve[14]=0,ve[15]=1,ve}Xr.prototype.update=function(rt){this.options=J({},this.options,rt),this.recoordinate()},Xr.prototype.clone=function(){return new Xr(this.options)},Xr.prototype.getOptions=function(){return this.options},Xr.prototype.clear=function(){this.update({transformations:[]})},Xr.prototype.getSize=function(){var rt=this.options;return[rt.width,rt.height]},Xr.prototype.getCenter=function(){var rt=this.options,ht=rt.x,Qt=rt.y;return[(2*ht+rt.width)/2,(2*Qt+rt.height)/2]},Xr.prototype.transform=function(){for(var rt=[],ht=0;ht<arguments.length;ht++)rt[ht]=arguments[ht];var Qt=this.options.transformations;return this.update({transformations:_t(_t([],it(Qt),!1),[_t([],it(rt),!1)],!1)}),this},Xr.prototype.map=function(rt){return this.output(rt)},Xr.prototype.invert=function(rt){return this.input(rt)},Xr.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Xr.prototype.compose=function(rt){function ht(En,Dn){var tr;ve.push((Dn=Dn===void 0?!0:Dn)?(tr=En,function(Ei){for(var fi=[],Ur=0;Ur<Ei.length-1;Ur+=2){var wi=[Ei[Ur],Ei[Ur+1]],wi=tr(wi);fi.push.apply(fi,_t([],it(wi),!1))}return fi}):En)}var Qt,de,Ce=(rt=rt===void 0?!1:rt)?_t([],it(this.options.transformations),!1).reverse():this.options.transformations,Me=rt?function(En){return En.untransform}:function(En){return En.transform},ge=[],ve=[];try{for(var Ue=pt(Ce),He=Ue.next();!He.done;He=Ue.next()){var hn,vn,Ln,dn,Sn,On,un=it(He.value),zn=un[0],Pn=un.slice(1),Un=this.transformers[zn];Un&&(vn=(hn=this.options).x,Ln=hn.y,dn=hn.width,Sn=hn.height,Ge(On=Un(_t([],it(Pn),!1),vn,Ln,dn,Sn))?ge.push(On):(ge.length&&(ht(this.createMatrixTransform(ge,rt)),ge.splice(0,ge.length)),ht(Me(On)||Ct,zn!=="parallel")))}}catch(En){Qt={error:En}}finally{try{He&&!He.done&&(de=Ue.return)&&de.call(Ue)}finally{if(Qt)throw Qt.error}}return ge.length&&ht(this.createMatrixTransform(ge,rt)),Ne.apply(void 0,_t([],it(ve),!1))},Xr.prototype.createMatrixTransform=function(rt,ht){var Qt,de,Ce,Me,ge,ve,Ue,He,hn,vn,Ln,dn,Sn=lt();return ht&&rt.reverse(),rt.forEach(function(On){return jt(Sn,Sn,On)}),ht&&(ht=rt=Sn,(dn=new mt(9))[0]=ht[0],dn[1]=ht[1],dn[2]=ht[2],dn[3]=ht[3],dn[4]=ht[4],dn[5]=ht[5],dn[6]=ht[6],dn[7]=ht[7],dn[8]=ht[8],dn=(ht=dn)[0],Qt=ht[1],de=ht[2],Ce=ht[3],Me=ht[4],ge=ht[5],ve=ht[6],Ue=ht[7],He=(ht=ht[8])*Me-ge*Ue,Ln=dn*He+Qt*(hn=-ht*Ce+ge*ve)+de*(vn=Ue*Ce-Me*ve))&&(rt[0]=He*(Ln=1/Ln),rt[1]=(-ht*Qt+de*Ue)*Ln,rt[2]=(ge*Qt-de*Me)*Ln,rt[3]=hn*Ln,rt[4]=(ht*dn-de*ve)*Ln,rt[5]=(-ge*dn+de*Ce)*Ln,rt[6]=vn*Ln,rt[7]=(-Ue*dn+Qt*ve)*Ln,rt[8]=(Me*dn-Qt*Ce)*Ln),function(Dn){var un,zn,Pn,Un,En,Dn=[Dn[0],Dn[1],1];return Pn=Sn,Un=(zn=un=Dn)[0],En=zn[1],zn=zn[2],un[0]=Un*Pn[0]+En*Pn[3]+zn*Pn[6],un[1]=Un*Pn[1]+En*Pn[4]+zn*Pn[7],un[2]=Un*Pn[2]+En*Pn[5]+zn*Pn[8],[Dn[0],Dn[1]]}},Z=Xr;function Xr(rt){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:Be,translate:Vt,custom:ze,matrix:an,polar:Re,transpose:Ke,scale:yr,"shear.x":jr,"shear.y":Dr,reflect:cn,"reflect.x":pn,"reflect.y":An,rotate:Gn,helix:Vn,parallel:fr,fisheye:ri,"fisheye.x":ki,"fisheye.y":ui,"fisheye.circular":Oi},this.update(rt)}ti.prototype.update=function(rt){this.options=J({},this.options,rt),this.recoordinate()},ti.prototype.clone=function(){return new ti(this.options)},ti.prototype.getOptions=function(){return this.options},ti.prototype.clear=function(){this.update({transformations:[]})},ti.prototype.getSize=function(){var rt=this.options;return[rt.width,rt.height,rt.depth]},ti.prototype.getCenter=function(){var rt=this.options,ht=rt.x,Qt=rt.y,de=rt.z;return[(2*ht+rt.width)/2,(2*Qt+rt.height)/2,(2*de+rt.depth)/2]},ti.prototype.transform=function(){for(var rt=[],ht=0;ht<arguments.length;ht++)rt[ht]=arguments[ht];var Qt=this.options.transformations;return this.update({transformations:_t(_t([],it(Qt),!1),[_t([],it(rt),!1)],!1)}),this},ti.prototype.map=function(rt){return this.output(rt)},ti.prototype.invert=function(rt){return this.input(rt)},ti.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},ti.prototype.compose=function(rt){function ht(tr,Ei){var fi;ve.push((Ei=Ei===void 0?!0:Ei)?(fi=tr,function(Ur){for(var wi=[],Di=0;Di<Ur.length-1;Di+=3){var kt=[Ur[Di],Ur[Di+1],Ur[Di+2]],kt=fi(kt);wi.push.apply(wi,_t([],it(kt),!1))}return wi}):tr)}var Qt,de,Ce=(rt=rt===void 0?!1:rt)?_t([],it(this.options.transformations),!1).reverse():this.options.transformations,Me=rt?function(tr){return tr.untransform}:function(tr){return tr.transform},ge=[],ve=[];try{for(var Ue=pt(Ce),He=Ue.next();!He.done;He=Ue.next()){var hn,vn,Ln,dn,Sn,On,un,zn,Pn=it(He.value),Un=Pn[0],En=Pn.slice(1),Dn=this.transformers[Un];Dn&&(vn=(hn=this.options).x,Ln=hn.y,dn=hn.z,Sn=hn.width,On=hn.height,un=hn.depth,Ge(zn=Dn(_t([],it(En),!1),vn,Ln,dn,Sn,On,un))?ge.push(zn):(ge.length&&(ht(this.createMatrixTransform(ge,rt)),ge.splice(0,ge.length)),ht(Me(zn)||Ct,!0)))}}catch(tr){Qt={error:tr}}finally{try{He&&!He.done&&(de=Ue.return)&&de.call(Ue)}finally{if(Qt)throw Qt.error}}return ge.length&&ht(this.createMatrixTransform(ge,rt)),Ne.apply(void 0,_t([],it(ve),!1))},ti.prototype.createMatrixTransform=function(rt,ht){var Qt,de,Ce,Me,ge,ve,Ue,He,hn,vn,Ln,dn,Sn,On,un,zn,Pn,Un,En,Dn,tr,Ei,fi,Ur,wi,Di,kt,Yt,be=ue();return ht&&rt.reverse(),rt.forEach(function(Xe){return we(be,be,Xe)}),ht&&(ht=rt=be,(Yt=new mt(16))[0]=ht[0],Yt[1]=ht[1],Yt[2]=ht[2],Yt[3]=ht[3],Yt[4]=ht[4],Yt[5]=ht[5],Yt[6]=ht[6],Yt[7]=ht[7],Yt[8]=ht[8],Yt[9]=ht[9],Yt[10]=ht[10],Yt[11]=ht[11],Yt[12]=ht[12],Yt[13]=ht[13],Yt[14]=ht[14],Yt[15]=ht[15],Yt=(ht=Yt)[0],Qt=ht[1],de=ht[2],Ce=ht[3],Me=ht[4],ge=ht[5],ve=ht[6],Ue=ht[7],He=ht[8],hn=ht[9],vn=ht[10],Ln=ht[11],dn=ht[12],Sn=ht[13],On=ht[14],ht=ht[15],kt=(un=Yt*ge-Qt*Me)*(Di=vn*ht-Ln*On)-(zn=Yt*ve-de*Me)*(wi=hn*ht-Ln*Sn)+(Pn=Yt*Ue-Ce*Me)*(Ur=hn*On-vn*Sn)+(Un=Qt*ve-de*ge)*(fi=He*ht-Ln*dn)-(En=Qt*Ue-Ce*ge)*(Ei=He*On-vn*dn)+(Dn=de*Ue-Ce*ve)*(tr=He*Sn-hn*dn))&&(rt[0]=(ge*Di-ve*wi+Ue*Ur)*(kt=1/kt),rt[1]=(de*wi-Qt*Di-Ce*Ur)*kt,rt[2]=(Sn*Dn-On*En+ht*Un)*kt,rt[3]=(vn*En-hn*Dn-Ln*Un)*kt,rt[4]=(ve*fi-Me*Di-Ue*Ei)*kt,rt[5]=(Yt*Di-de*fi+Ce*Ei)*kt,rt[6]=(On*Pn-dn*Dn-ht*zn)*kt,rt[7]=(He*Dn-vn*Pn+Ln*zn)*kt,rt[8]=(Me*wi-ge*fi+Ue*tr)*kt,rt[9]=(Qt*fi-Yt*wi-Ce*tr)*kt,rt[10]=(dn*En-Sn*Pn+ht*un)*kt,rt[11]=(hn*Pn-He*En-Ln*un)*kt,rt[12]=(ge*Ei-Me*Ur-ve*tr)*kt,rt[13]=(Yt*Ur-Qt*Ei+de*tr)*kt,rt[14]=(Sn*zn-dn*Un-On*un)*kt,rt[15]=(He*Un-hn*zn+vn*un)*kt),function(ii){var fn,Tn,Zn,Zr,ei,xr,ii=[ii[0],ii[1],ii[2],1];return Zn=be,Zr=(Tn=fn=ii)[0],ei=Tn[1],xr=Tn[2],Tn=Tn[3],fn[0]=Zn[0]*Zr+Zn[4]*ei+Zn[8]*xr+Zn[12]*Tn,fn[1]=Zn[1]*Zr+Zn[5]*ei+Zn[9]*xr+Zn[13]*Tn,fn[2]=Zn[2]*Zr+Zn[6]*ei+Zn[10]*xr+Zn[14]*Tn,fn[3]=Zn[3]*Zr+Zn[7]*ei+Zn[11]*xr+Zn[15]*Tn,[ii[0],ii[1],ii[2]]}},Et=ti;function ti(rt){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:Ui,translate3D:Zo,scale3D:bo,transpose3D:Xi},this.update(rt)}k.Coordinate=Z,k.Coordinate3D=Et,Object.defineProperty(k,"__esModule",{value:!0})})},90857:function(ke){"use strict";var Se=Object.prototype.hasOwnProperty,k="~";function pt(){}Object.create&&(pt.prototype=Object.create(null),new pt().__proto__||(k=!1));function it(Zt,Bt,Wt){this.fn=Zt,this.context=Bt,this.once=Wt||!1}function _t(Zt,Bt,Wt,ct,ee){if(typeof Wt!="function")throw new TypeError("The listener must be a function");var K=new it(Wt,ct||Zt,ee),J=k?k+Bt:Bt;return Zt._events[J]?Zt._events[J].fn?Zt._events[J]=[Zt._events[J],K]:Zt._events[J].push(K):(Zt._events[J]=K,Zt._eventsCount++),Zt}function qt(Zt,Bt){--Zt._eventsCount===0?Zt._events=new pt:delete Zt._events[Bt]}function q(){this._events=new pt,this._eventsCount=0}q.prototype.eventNames=function(){var Bt=[],Wt,ct;if(this._eventsCount===0)return Bt;for(ct in Wt=this._events)Se.call(Wt,ct)&&Bt.push(k?ct.slice(1):ct);return Object.getOwnPropertySymbols?Bt.concat(Object.getOwnPropertySymbols(Wt)):Bt},q.prototype.listeners=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];if(!ct)return[];if(ct.fn)return[ct.fn];for(var ee=0,K=ct.length,J=new Array(K);ee<K;ee++)J[ee]=ct[ee].fn;return J},q.prototype.listenerCount=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];return ct?ct.fn?1:ct.length:0},q.prototype.emit=function(Bt,Wt,ct,ee,K,J){var Ct=k?k+Bt:Bt;if(!this._events[Ct])return!1;var ft=this._events[Ct],mt=arguments.length,lt,jt;if(ft.fn){switch(ft.once&&this.removeListener(Bt,ft.fn,void 0,!0),mt){case 1:return ft.fn.call(ft.context),!0;case 2:return ft.fn.call(ft.context,Wt),!0;case 3:return ft.fn.call(ft.context,Wt,ct),!0;case 4:return ft.fn.call(ft.context,Wt,ct,ee),!0;case 5:return ft.fn.call(ft.context,Wt,ct,ee,K),!0;case 6:return ft.fn.call(ft.context,Wt,ct,ee,K,J),!0}for(jt=1,lt=new Array(mt-1);jt<mt;jt++)lt[jt-1]=arguments[jt];ft.fn.apply(ft.context,lt)}else{var ue=ft.length,we;for(jt=0;jt<ue;jt++)switch(ft[jt].once&&this.removeListener(Bt,ft[jt].fn,void 0,!0),mt){case 1:ft[jt].fn.call(ft[jt].context);break;case 2:ft[jt].fn.call(ft[jt].context,Wt);break;case 3:ft[jt].fn.call(ft[jt].context,Wt,ct);break;case 4:ft[jt].fn.call(ft[jt].context,Wt,ct,ee);break;default:if(!lt)for(we=1,lt=new Array(mt-1);we<mt;we++)lt[we-1]=arguments[we];ft[jt].fn.apply(ft[jt].context,lt)}}return!0},q.prototype.on=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!1)},q.prototype.once=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!0)},q.prototype.removeListener=function(Bt,Wt,ct,ee){var K=k?k+Bt:Bt;if(!this._events[K])return this;if(!Wt)return qt(this,K),this;var J=this._events[K];if(J.fn)J.fn===Wt&&(!ee||J.once)&&(!ct||J.context===ct)&&qt(this,K);else{for(var Ct=0,ft=[],mt=J.length;Ct<mt;Ct++)(J[Ct].fn!==Wt||ee&&!J[Ct].once||ct&&J[Ct].context!==ct)&&ft.push(J[Ct]);ft.length?this._events[K]=ft.length===1?ft[0]:ft:qt(this,K)}return this},q.prototype.removeAllListeners=function(Bt){var Wt;return Bt?(Wt=k?k+Bt:Bt,this._events[Wt]&&qt(this,Wt)):(this._events=new pt,this._eventsCount=0),this},q.prototype.off=q.prototype.removeListener,q.prototype.addListener=q.prototype.on,q.prefixed=k,q.EventEmitter=q,ke.exports=q},38554:function(ke){"use strict";var Se=Object.prototype.hasOwnProperty,k="~";function pt(){}Object.create&&(pt.prototype=Object.create(null),new pt().__proto__||(k=!1));function it(Zt,Bt,Wt){this.fn=Zt,this.context=Bt,this.once=Wt||!1}function _t(Zt,Bt,Wt,ct,ee){if(typeof Wt!="function")throw new TypeError("The listener must be a function");var K=new it(Wt,ct||Zt,ee),J=k?k+Bt:Bt;return Zt._events[J]?Zt._events[J].fn?Zt._events[J]=[Zt._events[J],K]:Zt._events[J].push(K):(Zt._events[J]=K,Zt._eventsCount++),Zt}function qt(Zt,Bt){--Zt._eventsCount===0?Zt._events=new pt:delete Zt._events[Bt]}function q(){this._events=new pt,this._eventsCount=0}q.prototype.eventNames=function(){var Bt=[],Wt,ct;if(this._eventsCount===0)return Bt;for(ct in Wt=this._events)Se.call(Wt,ct)&&Bt.push(k?ct.slice(1):ct);return Object.getOwnPropertySymbols?Bt.concat(Object.getOwnPropertySymbols(Wt)):Bt},q.prototype.listeners=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];if(!ct)return[];if(ct.fn)return[ct.fn];for(var ee=0,K=ct.length,J=new Array(K);ee<K;ee++)J[ee]=ct[ee].fn;return J},q.prototype.listenerCount=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];return ct?ct.fn?1:ct.length:0},q.prototype.emit=function(Bt,Wt,ct,ee,K,J){var Ct=k?k+Bt:Bt;if(!this._events[Ct])return!1;var ft=this._events[Ct],mt=arguments.length,lt,jt;if(ft.fn){switch(ft.once&&this.removeListener(Bt,ft.fn,void 0,!0),mt){case 1:return ft.fn.call(ft.context),!0;case 2:return ft.fn.call(ft.context,Wt),!0;case 3:return ft.fn.call(ft.context,Wt,ct),!0;case 4:return ft.fn.call(ft.context,Wt,ct,ee),!0;case 5:return ft.fn.call(ft.context,Wt,ct,ee,K),!0;case 6:return ft.fn.call(ft.context,Wt,ct,ee,K,J),!0}for(jt=1,lt=new Array(mt-1);jt<mt;jt++)lt[jt-1]=arguments[jt];ft.fn.apply(ft.context,lt)}else{var ue=ft.length,we;for(jt=0;jt<ue;jt++)switch(ft[jt].once&&this.removeListener(Bt,ft[jt].fn,void 0,!0),mt){case 1:ft[jt].fn.call(ft[jt].context);break;case 2:ft[jt].fn.call(ft[jt].context,Wt);break;case 3:ft[jt].fn.call(ft[jt].context,Wt,ct);break;case 4:ft[jt].fn.call(ft[jt].context,Wt,ct,ee);break;default:if(!lt)for(we=1,lt=new Array(mt-1);we<mt;we++)lt[we-1]=arguments[we];ft[jt].fn.apply(ft[jt].context,lt)}}return!0},q.prototype.on=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!1)},q.prototype.once=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!0)},q.prototype.removeListener=function(Bt,Wt,ct,ee){var K=k?k+Bt:Bt;if(!this._events[K])return this;if(!Wt)return qt(this,K),this;var J=this._events[K];if(J.fn)J.fn===Wt&&(!ee||J.once)&&(!ct||J.context===ct)&&qt(this,K);else{for(var Ct=0,ft=[],mt=J.length;Ct<mt;Ct++)(J[Ct].fn!==Wt||ee&&!J[Ct].once||ct&&J[Ct].context!==ct)&&ft.push(J[Ct]);ft.length?this._events[K]=ft.length===1?ft[0]:ft:qt(this,K)}return this},q.prototype.removeAllListeners=function(Bt){var Wt;return Bt?(Wt=k?k+Bt:Bt,this._events[Wt]&&qt(this,Wt)):(this._events=new pt,this._eventsCount=0),this},q.prototype.off=q.prototype.removeListener,q.prototype.addListener=q.prototype.on,q.prefixed=k,q.EventEmitter=q,ke.exports=q},11702:function(ke,Se,k){"use strict";k.d(Se,{TE:function(){return qt},U4:function(){return Gt},Xk:function(){return ae},Y1:function(){return Ye},_x:function(){return xe},hE:function(){return yt},l5:function(){return et},ph:function(){return Dt},vp:function(){return ue},x4:function(){return Ve}});var pt=k(97582),it=k(80450),_t=k(31437);function qt(Xt,re,le,pe){var Q=Xt-le,D=re-pe;return Math.sqrt(Q*Q+D*D)}function q(Xt,re){var le=Math.min.apply(Math,(0,pt.ev)([],(0,pt.CR)(Xt),!1)),pe=Math.min.apply(Math,(0,pt.ev)([],(0,pt.CR)(re),!1)),Q=Math.max.apply(Math,(0,pt.ev)([],(0,pt.CR)(Xt),!1)),D=Math.max.apply(Math,(0,pt.ev)([],(0,pt.CR)(re),!1));return{x:le,y:pe,width:Q-le,height:D-pe}}function Zt(Xt){return(Xt+Math.PI*2)%(Math.PI*2)}function Bt(Xt,re){var le=Math.abs(Xt);return re>0?le:le*-1}function Wt(Xt,re,le,pe,Q,D){var Z=le,tt=pe;if(Z===0||tt===0)return{x:Xt,y:re};for(var Et=Q-Xt,It=D-re,ce=Math.abs(Et),fe=Math.abs(It),Be=Z*Z,ze=tt*tt,an=Math.PI/4,Re=0,Ke=0,cn=0;cn<4;cn++){Re=Z*Math.cos(an),Ke=tt*Math.sin(an);var pn=(Be-ze)*Math.pow(Math.cos(an),3)/Z,An=(ze-Be)*Math.pow(Math.sin(an),3)/tt,Gn=Re-pn,Vn=Ke-An,fr=ce-pn,yr=fe-An,Cr=Math.hypot(Vn,Gn),jr=Math.hypot(yr,fr),Dr=Cr*Math.asin((Gn*yr-Vn*fr)/(Cr*jr)),Fr=Dr/Math.sqrt(Be+ze-Re*Re-Ke*Ke);an+=Fr,an=Math.min(Math.PI/2,Math.max(0,an))}return{x:Xt+Bt(Re,Et),y:re+Bt(Ke,It)}}function ct(Xt,re,le,pe,Q,D,Z,tt){return-1*le*Math.cos(Q)*Math.sin(tt)-pe*Math.sin(Q)*Math.cos(tt)}function ee(Xt,re,le,pe,Q,D,Z,tt){return-1*le*Math.sin(Q)*Math.sin(tt)+pe*Math.cos(Q)*Math.cos(tt)}function K(Xt,re,le){return Math.atan(-re/Xt*Math.tan(le))}function J(Xt,re,le){return Math.atan(re/(Xt*Math.tan(le)))}function Ct(Xt,re,le,pe,Q,D){return le*Math.cos(Q)*Math.cos(D)-pe*Math.sin(Q)*Math.sin(D)+Xt}function ft(Xt,re,le,pe,Q,D){return le*Math.sin(Q)*Math.cos(D)+pe*Math.cos(Q)*Math.sin(D)+re}function mt(Xt,re,le,pe){var Q=Math.atan2(pe*Xt,le*re);return(Q+Math.PI*2)%(Math.PI*2)}function lt(Xt,re,le){return{x:Xt*Math.cos(le),y:re*Math.sin(le)}}function jt(Xt,re,le){var pe=Math.cos(le),Q=Math.sin(le);return[Xt*pe-re*Q,Xt*Q+re*pe]}function ue(Xt,re,le,pe,Q,D,Z){for(var tt=K(le,pe,Q),Et=1/0,It=-1/0,ce=[D,Z],fe=-Math.PI*2;fe<=Math.PI*2;fe+=Math.PI){var Be=tt+fe;D<Z?D<Be&&Be<Z&&ce.push(Be):Z<Be&&Be<D&&ce.push(Be)}for(var fe=0;fe<ce.length;fe++){var ze=Ct(Xt,re,le,pe,Q,ce[fe]);ze<Et&&(Et=ze),ze>It&&(It=ze)}for(var an=J(le,pe,Q),Re=1/0,Ke=-1/0,cn=[D,Z],fe=-Math.PI*2;fe<=Math.PI*2;fe+=Math.PI){var pn=an+fe;D<Z?D<pn&&pn<Z&&cn.push(pn):Z<pn&&pn<D&&cn.push(pn)}for(var fe=0;fe<cn.length;fe++){var An=ft(Xt,re,le,pe,Q,cn[fe]);An<Re&&(Re=An),An>Ke&&(Ke=An)}return{x:Et,y:Re,width:It-Et,height:Ke-Re}}function we(Xt,re,le,pe,Q,D,Z,tt,Et){var It=jt(tt-Xt,Et-re,-Q),ce=__read(It,2),fe=ce[0],Be=ce[1],ze=Wt(0,0,le,pe,fe,Be),an=mt(le,pe,ze.x,ze.y);an<D?ze=lt(le,pe,D):an>Z&&(ze=lt(le,pe,Z));var Re=jt(ze.x,ze.y,Q);return{x:Re[0]+Xt,y:Re[1]+re}}function Ne(Xt,re,le,pe,Q,D,Z,tt){var Et=(Z-D)*tt+D,It=ct(Xt,re,le,pe,Q,D,Z,Et),ce=ee(Xt,re,le,pe,Q,D,Z,Et);return Zt(Math.atan2(ce,It))}var Ge=1e-4;function ye(Xt,re,le,pe,Q,D){var Z=-1,tt=1/0,Et=[le,pe],It=20;D&&D>200&&(It=D/10);for(var ce=1/It,fe=ce/10,Be=0;Be<=It;Be++){var ze=Be*ce,an=[Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(Xt.concat([ze])),!1)),Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(re.concat([ze])),!1))],Re=qt(Et[0],Et[1],an[0],an[1]);Re<tt&&(Z=ze,tt=Re)}if(Z===0)return{x:Xt[0],y:re[0]};if(Z===1){var Ke=Xt.length;return{x:Xt[Ke-1],y:re[Ke-1]}}tt=1/0;for(var Be=0;Be<32&&!(fe<Ge);Be++){var cn=Z-fe,pn=Z+fe,an=[Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(Xt.concat([cn])),!1)),Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(re.concat([cn])),!1))],Re=qt(Et[0],Et[1],an[0],an[1]);if(cn>=0&&Re<tt)Z=cn,tt=Re;else{var An=[Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(Xt.concat([pn])),!1)),Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(re.concat([pn])),!1))],Gn=qt(Et[0],Et[1],An[0],An[1]);pn<=1&&Gn<tt?(Z=pn,tt=Gn):fe*=.5}}return{x:Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(Xt.concat([Z])),!1)),y:Q.apply(void 0,(0,pt.ev)([],(0,pt.CR)(re.concat([Z])),!1))}}function Vt(Xt,re){for(var le=0,pe=Xt.length,Q=0;Q<pe;Q++){var D=Xt[Q],Z=re[Q],tt=Xt[(Q+1)%pe],Et=re[(Q+1)%pe];le+=qt(D,Z,tt,Et)}return le/2}function $(Xt,re,le,pe){return q([Xt,le],[re,pe])}function ae(Xt,re,le,pe){return qt(Xt,re,le,pe)}function Gt(Xt,re,le,pe,Q){return{x:(1-Q)*Xt+Q*le,y:(1-Q)*re+Q*pe}}function _e(Xt,re,le,pe,Q,D){var Z=(le-Xt)*(Q-Xt)+(pe-re)*(D-re);if(Z<0)return qt(Xt,re,Q,D);var tt=(le-Xt)*(le-Xt)+(pe-re)*(pe-re);return Z>tt?qt(le,pe,Q,D):xe(Xt,re,le,pe,Q,D)}function xe(Xt,re,le,pe,Q,D){var Z=[le-Xt,pe-re];if(_t.I6(Z,[0,0]))return Math.sqrt((Q-Xt)*(Q-Xt)+(D-re)*(D-re));var tt=[-Z[1],Z[0]];_t.Fv(tt,tt);var Et=[Q-Xt,D-re];return Math.abs(_t.AK(Et,tt))}function X(Xt,re,le,pe){return Math.atan2(pe-re,le-Xt)}function Rt(Xt,re,le,pe,Q){var D=1-Q;return D*D*D*Xt+3*re*Q*D*D+3*le*Q*Q*D+pe*Q*Q*Q}function V(Xt,re,le,pe,Q){var D=1-Q;return 3*(D*D*(re-Xt)+2*D*Q*(le-re)+Q*Q*(pe-le))}function Mt(Xt,re,le,pe){var Q=-3*Xt+9*re-9*le+3*pe,D=6*Xt-12*re+6*le,Z=3*re-3*Xt,tt=[],Et,It,ce;if((0,it.Z)(Q,0))(0,it.Z)(D,0)||(Et=-Z/D,Et>=0&&Et<=1&&tt.push(Et));else{var fe=D*D-4*Q*Z;(0,it.Z)(fe,0)?tt.push(-D/(2*Q)):fe>0&&(ce=Math.sqrt(fe),Et=(-D+ce)/(2*Q),It=(-D-ce)/(2*Q),Et>=0&&Et<=1&&tt.push(Et),It>=0&&It<=1&&tt.push(It))}return tt}function H(Xt,re,le,pe,Q,D,Z,tt,Et){var It=Rt(Xt,le,Q,Z,Et),ce=Rt(re,pe,D,tt,Et),fe=Gt(Xt,re,le,pe,Et),Be=Gt(le,pe,Q,D,Et),ze=Gt(Q,D,Z,tt,Et),an=Gt(fe.x,fe.y,Be.x,Be.y,Et),Re=Gt(Be.x,Be.y,ze.x,ze.y,Et);return[[Xt,re,fe.x,fe.y,an.x,an.y,It,ce],[It,ce,Re.x,Re.y,ze.x,ze.y,Z,tt]]}function N(Xt,re,le,pe,Q,D,Z,tt,Et){if(Et===0)return Vt([Xt,le,Q,Z],[re,pe,D,tt]);var It=H(Xt,re,le,pe,Q,D,Z,tt,.5),ce=__spreadArray(__spreadArray([],__read(It[0]),!1),[Et-1],!1),fe=__spreadArray(__spreadArray([],__read(It[1]),!1),[Et-1],!1);return N.apply(void 0,__spreadArray([],__read(ce),!1))+N.apply(void 0,__spreadArray([],__read(fe),!1))}function et(Xt,re,le,pe,Q,D,Z,tt){for(var Et=[Xt,Z],It=[re,tt],ce=Mt(Xt,le,Q,Z),fe=Mt(re,pe,D,tt),Be=0;Be<ce.length;Be++)Et.push(Rt(Xt,le,Q,Z,ce[Be]));for(var Be=0;Be<fe.length;Be++)It.push(Rt(re,pe,D,tt,fe[Be]));return q(Et,It)}function ot(Xt,re,le,pe,Q,D,Z,tt){return N(Xt,re,le,pe,Q,D,Z,tt,3)}function At(Xt,re,le,pe,Q,D,Z,tt,Et,It,ce){return ye([Xt,le,Q,Z],[re,pe,D,tt],Et,It,Rt,ce)}function Dt(Xt,re,le,pe,Q,D,Z,tt,Et,It,ce){var fe=At(Xt,re,le,pe,Q,D,Z,tt,Et,It,ce);return qt(fe.x,fe.y,Et,It)}function ie(Xt,re,le,pe,Q,D,Z,tt,Et){return{x:Rt(Xt,le,Q,Z,Et),y:Rt(re,pe,D,tt,Et)}}function Tt(Xt,re,le,pe,Q,D,Z,tt,Et){var It=V(Xt,le,Q,Z,Et),ce=V(re,pe,D,tt,Et);return Zt(Math.atan2(ce,It))}function zt(Xt){for(var re=0,le=[],pe=0;pe<Xt.length-1;pe++){var Q=Xt[pe],D=Xt[pe+1],Z=qt(Q[0],Q[1],D[0],D[1]),tt={from:Q,to:D,length:Z};le.push(tt),re+=Z}return{segments:le,totalLength:re}}function Oe(Xt){if(Xt.length<2)return 0;for(var re=0,le=0;le<Xt.length-1;le++){var pe=Xt[le],Q=Xt[le+1];re+=qt(pe[0],pe[1],Q[0],Q[1])}return re}function Lt(Xt,re){if(re>1||re<0||Xt.length<2)return null;var le=zt(Xt),pe=le.segments,Q=le.totalLength;if(Q===0)return{x:Xt[0][0],y:Xt[0][1]};for(var D=0,Z=null,tt=0;tt<pe.length;tt++){var Et=pe[tt],It=Et.from,ce=Et.to,fe=Et.length/Q;if(re>=D&&re<=D+fe){var Be=(re-D)/fe;Z=Gt(It[0],It[1],ce[0],ce[1],Be);break}D+=fe}return Z}function nt(Xt,re){if(re>1||re<0||Xt.length<2)return 0;for(var le=zt(Xt),pe=le.segments,Q=le.totalLength,D=0,Z=0,tt=0;tt<pe.length;tt++){var Et=pe[tt],It=Et.from,ce=Et.to,fe=Et.length/Q;if(re>=D&&re<=D+fe){Z=Math.atan2(ce[1]-It[1],ce[0]-It[0]);break}D+=fe}return Z}function Ft(Xt,re,le){for(var pe=1/0,Q=0;Q<Xt.length-1;Q++){var D=Xt[Q],Z=Xt[Q+1],tt=_e(D[0],D[1],Z[0],Z[1],re,le);tt<pe&&(pe=tt)}return pe}function he(Xt){for(var re=[],le=[],pe=0;pe<Xt.length;pe++){var Q=Xt[pe];re.push(Q[0]),le.push(Q[1])}return q(re,le)}function yt(Xt){return Oe(Xt)}function St(Xt,re){return Lt(Xt,re)}function F(Xt,re,le){return Ft(Xt,re,le)}function T(Xt,re){return nt(Xt,re)}function gt(Xt){var re=Xt.slice(0);return Xt.length&&re.push(Xt[0]),re}function ne(Xt){return he(Xt)}function C(Xt){return Oe(gt(Xt))}function j(Xt,re){return Lt(gt(Xt),re)}function Pt(Xt,re,le){return Ft(gt(Xt),re,le)}function Jt(Xt,re){return nt(gt(Xt),re)}function se(Xt,re,le,pe){var Q=1-pe;return Q*Q*Xt+2*pe*Q*re+pe*pe*le}function Ae(Xt,re,le){var pe=Xt+le-2*re;if((0,it.Z)(pe,0))return[.5];var Q=(Xt-re)/pe;return Q<=1&&Q>=0?[Q]:[]}function Le(Xt,re,le,pe,Q,D,Z){var tt=se(Xt,le,Q,Z),Et=se(re,pe,D,Z),It=Gt(Xt,re,le,pe,Z),ce=Gt(le,pe,Q,D,Z);return[[Xt,re,It.x,It.y,tt,Et],[tt,Et,ce.x,ce.y,Q,D]]}function De(Xt,re,le,pe,Q,D,Z){if(Z===0)return(qt(Xt,re,le,pe)+qt(le,pe,Q,D)+qt(Xt,re,Q,D))/2;var tt=Le(Xt,re,le,pe,Q,D,.5),Et=tt[0],It=tt[1];return Et.push(Z-1),It.push(Z-1),De.apply(void 0,__spreadArray([],__read(Et),!1))+De.apply(void 0,__spreadArray([],__read(It),!1))}function Ve(Xt,re,le,pe,Q,D){var Z=Ae(Xt,le,Q)[0],tt=Ae(re,pe,D)[0],Et=[Xt,Q],It=[re,D];return Z!==void 0&&Et.push(se(Xt,le,Q,Z)),tt!==void 0&&It.push(se(re,pe,D,tt)),q(Et,It)}function We(Xt,re,le,pe,Q,D){return De(Xt,re,le,pe,Q,D,3)}function $e(Xt,re,le,pe,Q,D,Z,tt){return ye([Xt,le,Q],[re,pe,D],Z,tt,se)}function Ye(Xt,re,le,pe,Q,D,Z,tt){var Et=$e(Xt,re,le,pe,Q,D,Z,tt);return qt(Et.x,Et.y,Z,tt)}},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(ke){try{let ct=function(){q||(q=!0,_t())},ee=function(){try{qt.documentElement.doScroll("left")}catch(K){return void setTimeout(ee,50)}ct()};var Bt=ct,Wt=ee,k=(k=document.getElementsByTagName("script"))[k.length-1],Se=k.getAttribute("data-injectcss"),k=k.getAttribute("data-disable-injectsvg");if(!k){var pt,it,_t,qt,q,Zt=function(K,J){J.parentNode.insertBefore(K,J)};if(Se&&!ke.__iconfont__svg__cssinject__){ke.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(K){console&&console.log(K)}}pt=function(){var K,J=document.createElement("div");J.innerHTML=ke._iconfont_svg_string_3580659,(J=J.getElementsByTagName("svg")[0])&&(J.setAttribute("aria-hidden","true"),J.style.position="absolute",J.style.width=0,J.style.height=0,J.style.overflow="hidden",J=J,(K=document.body).firstChild?Zt(J,K.firstChild):K.appendChild(J))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(pt,0):(it=function(){document.removeEventListener("DOMContentLoaded",it,!1),pt()},document.addEventListener("DOMContentLoaded",it,!1)):document.attachEvent&&(_t=pt,qt=ke.document,q=!1,ee(),qt.onreadystatechange=function(){qt.readyState=="complete"&&(qt.onreadystatechange=null,ct())})}}catch(ct){}}(window)},4771:function(){},81957:function(ke,Se){"use strict";var k=function(pt,it,_t){return pt<it?it:pt>_t?_t:pt};Se.Z=k},5199:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return pt}});function pt(it){return Array.isArray(it)}},90134:function(ke,Se,k){"use strict";var pt=k(95456),it=function(_t){return(0,pt.Z)(_t,"Boolean")};Se.Z=it},95147:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return pt}});function pt(it){return it==null}},80450:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return it}});var pt=1e-5;function it(_t,qt,q){return q===void 0&&(q=pt),_t===qt||Math.abs(_t-qt)<q}},25897:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return pt}});function pt(it){return typeof it=="number"}},4637:function(ke,Se){"use strict";Se.Z=function(k){var pt=typeof k;return k!==null&&pt==="object"||pt==="function"}},76714:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return pt}});function pt(it){return typeof it=="string"}},95456:function(ke,Se){"use strict";var k={}.toString,pt=function(it,_t){return k.call(it)==="[object "+_t+"]"};Se.Z=pt},71154:function(ke,Se){"use strict";var k=function(pt){return pt===void 0};Se.Z=k},13882:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return pt}});function pt(it){if(!Array.isArray(it))return-1/0;var _t=it.length;if(!_t)return-1/0;for(var qt=it[0],q=1;q<_t;q++)qt=Math.max(qt,it[q]);return qt}},71523:function(ke,Se,k){"use strict";var pt=k(5199);Se.Z=function(it){if((0,pt.Z)(it))return it.reduce(function(_t,qt){return Math.min(_t,qt)},it[0])}},8614:function(ke,Se){"use strict";var k=function(pt,it){return(pt%it+it)%it};Se.Z=k},75839:function(ke,Se,k){"use strict";k.d(Se,{Y:function(){return J}});var pt=k(97582),it=k(64985);function _t(Ct,ft,mt){if(Ct[mt].length>7){Ct[mt].shift();for(var lt=Ct[mt],jt=mt;lt.length;)ft[mt]="A",Ct.splice(jt+=1,0,["C"].concat(lt.splice(0,6)));Ct.splice(mt,1)}}var qt=k(4848),q=k(11013);function Zt(Ct){return(0,q.y)(Ct)&&Ct.every(function(ft){var mt=ft[0];return"MC".includes(mt)})}var Bt=k(74873);function Wt(Ct,ft,mt,lt,jt,ue){var we=.3333333333333333,Ne=2/3;return[we*Ct+Ne*mt,we*ft+Ne*lt,we*jt+Ne*mt,we*ue+Ne*lt,jt,ue]}var ct=k(17570),ee=function(Ct,ft,mt,lt){var jt=.5,ue=(0,ct.k)([Ct,ft],[mt,lt],jt);return(0,pt.ev)((0,pt.ev)([],ue,!0),[mt,lt,mt,lt],!1)};function K(Ct,ft){var mt=Ct[0],lt=Ct.slice(1).map(Number),jt=lt[0],ue=lt[1],we,Ne=ft.x1,Ge=ft.y1,ye=ft.x,Vt=ft.y;switch("TQ".includes(mt)||(ft.qx=null,ft.qy=null),mt){case"M":return ft.x=jt,ft.y=ue,Ct;case"A":return we=[Ne,Ge].concat(lt),["C"].concat((0,Bt.W)(we[0],we[1],we[2],we[3],we[4],we[5],we[6],we[7],we[8],we[9]));case"Q":return ft.qx=jt,ft.qy=ue,we=[Ne,Ge].concat(lt),["C"].concat(Wt(we[0],we[1],we[2],we[3],we[4],we[5]));case"L":return["C"].concat(ee(Ne,Ge,jt,ue));case"Z":return Ne===ye&&Ge===Vt?["C",Ne,Ge,ye,Vt,ye,Vt]:["C"].concat(ee(Ne,Ge,ye,Vt));default:}return Ct}function J(Ct,ft){if(ft===void 0&&(ft=!1),Zt(Ct)){var mt=[].concat(Ct);return ft?[mt,[]]:mt}for(var lt=(0,qt.A)(Ct),jt=(0,pt.pi)({},it.z),ue=[],we="",Ne=lt.length,Ge,ye,Vt=[],$=0;$<Ne;$+=1){lt[$]&&(we=lt[$][0]),ue[$]=we;var ae=K(lt[$],jt);lt[$]=ae,_t(lt,ue,$),Ne=lt.length,we==="Z"&&Vt.push($),Ge=lt[$],ye=Ge.length,jt.x1=+Ge[ye-2],jt.y1=+Ge[ye-1],jt.x2=+Ge[ye-4]||jt.x1,jt.y2=+Ge[ye-3]||jt.y1}return ft?[lt,Vt]:lt}},18323:function(ke,Se,k){"use strict";k.d(Se,{R:function(){return pt}});var pt={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0}},64985:function(ke,Se,k){"use strict";k.d(Se,{z:function(){return pt}});var pt={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null}},74873:function(ke,Se,k){"use strict";k.d(Se,{W:function(){return it}});function pt(_t,qt,q){var Zt=_t*Math.cos(q)-qt*Math.sin(q),Bt=_t*Math.sin(q)+qt*Math.cos(q);return{x:Zt,y:Bt}}function it(_t,qt,q,Zt,Bt,Wt,ct,ee,K,J){var Ct=_t,ft=qt,mt=q,lt=Zt,jt=ee,ue=K,we=Math.PI*120/180,Ne=Math.PI/180*(+Bt||0),Ge=[],ye,Vt,$,ae,Gt;if(J)Vt=J[0],$=J[1],ae=J[2],Gt=J[3];else{ye=pt(Ct,ft,-Ne),Ct=ye.x,ft=ye.y,ye=pt(jt,ue,-Ne),jt=ye.x,ue=ye.y;var _e=(Ct-jt)/2,xe=(ft-ue)/2,X=_e*_e/(mt*mt)+xe*xe/(lt*lt);X>1&&(X=Math.sqrt(X),mt*=X,lt*=X);var Rt=mt*mt,V=lt*lt,Mt=(Wt===ct?-1:1)*Math.sqrt(Math.abs((Rt*V-Rt*xe*xe-V*_e*_e)/(Rt*xe*xe+V*_e*_e)));ae=Mt*mt*xe/lt+(Ct+jt)/2,Gt=Mt*-lt*_e/mt+(ft+ue)/2,Vt=Math.asin(((ft-Gt)/lt*Math.pow(10,9)>>0)/Math.pow(10,9)),$=Math.asin(((ue-Gt)/lt*Math.pow(10,9)>>0)/Math.pow(10,9)),Vt=Ct<ae?Math.PI-Vt:Vt,$=jt<ae?Math.PI-$:$,Vt<0&&(Vt=Math.PI*2+Vt),$<0&&($=Math.PI*2+$),ct&&Vt>$&&(Vt-=Math.PI*2),!ct&&$>Vt&&($-=Math.PI*2)}var H=$-Vt;if(Math.abs(H)>we){var N=$,et=jt,ot=ue;$=Vt+we*(ct&&$>Vt?1:-1),jt=ae+mt*Math.cos($),ue=Gt+lt*Math.sin($),Ge=it(jt,ue,mt,lt,Bt,0,ct,et,ot,[$,N,ae,Gt])}H=$-Vt;var At=Math.cos(Vt),Dt=Math.sin(Vt),ie=Math.cos($),Tt=Math.sin($),zt=Math.tan(H/4),Oe=4/3*mt*zt,Lt=4/3*lt*zt,nt=[Ct,ft],Ft=[Ct+Oe*Dt,ft-Lt*At],he=[jt+Oe*Tt,ue-Lt*ie],yt=[jt,ue];if(Ft[0]=2*nt[0]-Ft[0],Ft[1]=2*nt[1]-Ft[1],J)return Ft.concat(he,yt,Ge);Ge=Ft.concat(he,yt,Ge);for(var St=[],F=0,T=Ge.length;F<T;F+=1)St[F]=F%2?pt(Ge[F-1],Ge[F],Ne).y:pt(Ge[F],Ge[F+1],Ne).x;return St}},28659:function(ke,Se,k){"use strict";k.d(Se,{U:function(){return pt}});function pt(it){return it.map(function(_t){return Array.isArray(_t)?[].concat(_t):_t})}},4848:function(ke,Se,k){"use strict";k.d(Se,{A:function(){return Ge}});var pt=k(97582),it=k(11013),_t=k(64985),qt=k(41010),q=k(56346),Zt=k(18323);function Bt(ye){for(var Vt=ye.pathValue[ye.segmentStart],$=Vt.toLowerCase(),ae=ye.data;ae.length>=Zt.R[$]&&($==="m"&&ae.length>2?(ye.segments.push([Vt].concat(ae.splice(0,2))),$="l",Vt=Vt==="m"?"l":"L"):ye.segments.push([Vt].concat(ae.splice(0,Zt.R[$]))),!!Zt.R[$]););}function Wt(ye){var Vt=ye.index,$=ye.pathValue,ae=$.charCodeAt(Vt);if(ae===48){ye.param=0,ye.index+=1;return}if(ae===49){ye.param=1,ye.index+=1;return}ye.err='[path-util]: invalid Arc flag "'.concat($[Vt],'", expecting 0 or 1 at index ').concat(Vt)}function ct(ye){return ye>=48&&ye<=57||ye===43||ye===45||ye===46}function ee(ye){return ye>=48&&ye<=57}function K(ye){var Vt=ye.max,$=ye.pathValue,ae=ye.index,Gt=ae,_e=!1,xe=!1,X=!1,Rt=!1,V;if(Gt>=Vt){ye.err="[path-util]: Invalid path value at index ".concat(Gt,', "pathValue" is missing param');return}if(V=$.charCodeAt(Gt),(V===43||V===45)&&(Gt+=1,V=$.charCodeAt(Gt)),!ee(V)&&V!==46){ye.err="[path-util]: Invalid path value at index ".concat(Gt,', "').concat($[Gt],'" is not a number');return}if(V!==46){if(_e=V===48,Gt+=1,V=$.charCodeAt(Gt),_e&&Gt<Vt&&V&&ee(V)){ye.err="[path-util]: Invalid path value at index ".concat(ae,', "').concat($[ae],'" illegal number');return}for(;Gt<Vt&&ee($.charCodeAt(Gt));)Gt+=1,xe=!0;V=$.charCodeAt(Gt)}if(V===46){for(Rt=!0,Gt+=1;ee($.charCodeAt(Gt));)Gt+=1,X=!0;V=$.charCodeAt(Gt)}if(V===101||V===69){if(Rt&&!xe&&!X){ye.err="[path-util]: Invalid path value at index ".concat(Gt,', "').concat($[Gt],'" invalid float exponent');return}if(Gt+=1,V=$.charCodeAt(Gt),(V===43||V===45)&&(Gt+=1),Gt<Vt&&ee($.charCodeAt(Gt)))for(;Gt<Vt&&ee($.charCodeAt(Gt));)Gt+=1;else{ye.err="[path-util]: Invalid path value at index ".concat(Gt,', "').concat($[Gt],'" invalid integer exponent');return}}ye.index=Gt,ye.param=+ye.pathValue.slice(ae,Gt)}function J(ye){var Vt=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return ye===10||ye===13||ye===8232||ye===8233||ye===32||ye===9||ye===11||ye===12||ye===160||ye>=5760&&Vt.includes(ye)}function Ct(ye){for(var Vt=ye.pathValue,$=ye.max;ye.index<$&&J(Vt.charCodeAt(ye.index));)ye.index+=1}function ft(ye){switch(ye|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function mt(ye){return(ye|32)===97}function lt(ye){var Vt=ye.max,$=ye.pathValue,ae=ye.index,Gt=$.charCodeAt(ae),_e=Zt.R[$[ae].toLowerCase()];if(ye.segmentStart=ae,!ft(Gt)){ye.err='[path-util]: Invalid path value "'.concat($[ae],'" is not a path command');return}if(ye.index+=1,Ct(ye),ye.data=[],!_e){Bt(ye);return}for(;;){for(var xe=_e;xe>0;xe-=1){if(mt(Gt)&&(xe===3||xe===4)?Wt(ye):K(ye),ye.err.length)return;ye.data.push(ye.param),Ct(ye),ye.index<Vt&&$.charCodeAt(ye.index)===44&&(ye.index+=1,Ct(ye))}if(ye.index>=ye.max||!ct($.charCodeAt(ye.index)))break}Bt(ye)}var jt=function(){function ye(Vt){this.pathValue=Vt,this.segments=[],this.max=Vt.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return ye}();function ue(ye){if((0,q.n)(ye))return[].concat(ye);var Vt=new jt(ye);for(Ct(Vt);Vt.index<Vt.max&&!Vt.err.length;)lt(Vt);return Vt.err?Vt.err:Vt.segments}function we(ye){if((0,qt.b)(ye))return[].concat(ye);var Vt=ue(ye),$=0,ae=0,Gt=0,_e=0;return Vt.map(function(xe){var X=xe.slice(1).map(Number),Rt=xe[0],V=Rt.toUpperCase();if(Rt==="M")return $=X[0],ae=X[1],Gt=$,_e=ae,["M",$,ae];var Mt;if(Rt!==V)switch(V){case"A":Mt=[V,X[0],X[1],X[2],X[3],X[4],X[5]+$,X[6]+ae];break;case"V":Mt=[V,X[0]+ae];break;case"H":Mt=[V,X[0]+$];break;default:{var H=X.map(function(et,ot){return et+(ot%2?ae:$)});Mt=[V].concat(H)}}else Mt=[V].concat(X);var N=Mt.length;switch(V){case"Z":$=Gt,ae=_e;break;case"H":$=Mt[1];break;case"V":ae=Mt[1];break;default:$=Mt[N-2],ae=Mt[N-1],V==="M"&&(Gt=$,_e=ae)}return Mt})}function Ne(ye,Vt){var $=ye[0],ae=Vt.x1,Gt=Vt.y1,_e=Vt.x2,xe=Vt.y2,X=ye.slice(1).map(Number),Rt=ye;if("TQ".includes($)||(Vt.qx=null,Vt.qy=null),$==="H")Rt=["L",ye[1],Gt];else if($==="V")Rt=["L",ae,ye[1]];else if($==="S"){var V=ae*2-_e,Mt=Gt*2-xe;Vt.x1=V,Vt.y1=Mt,Rt=["C",V,Mt].concat(X)}else if($==="T"){var H=ae*2-Vt.qx,N=Gt*2-Vt.qy;Vt.qx=H,Vt.qy=N,Rt=["Q",H,N].concat(X)}else if($==="Q"){var et=X[0],ot=X[1];Vt.qx=et,Vt.qy=ot}return Rt}function Ge(ye){if((0,it.y)(ye))return[].concat(ye);for(var Vt=we(ye),$=(0,pt.pi)({},_t.z),ae=0;ae<Vt.length;ae+=1){Vt[ae]=Ne(Vt[ae],$);var Gt=Vt[ae],_e=Gt.length;$.x1=+Gt[_e-2],$.y1=+Gt[_e-1],$.x2=+Gt[_e-4]||$.x1,$.y2=+Gt[_e-3]||$.y1}return Vt}},65850:function(ke,Se,k){"use strict";k.d(Se,{G:function(){return pt}});function pt(it){var _t=it.slice(1).map(function(qt,q,Zt){return q?Zt[q-1].slice(-2).concat(qt.slice(1)):it[0].slice(1).concat(qt.slice(1))}).map(function(qt){return qt.map(function(q,Zt){return qt[qt.length-Zt-2*(1-Zt%2)]})}).reverse();return[["M"].concat(_t[0].slice(0,2))].concat(_t.map(function(qt){return["C"].concat(qt.slice(2))}))}},44078:function(ke,Se,k){"use strict";k.d(Se,{y:function(){return pt}});function pt(it,_t){return Math.sqrt((it[0]-_t[0])*(it[0]-_t[0])+(it[1]-_t[1])*(it[1]-_t[1]))}},99872:function(ke,Se,k){"use strict";k.d(Se,{x:function(){return q}});var pt=k(17570),it=k(6489);function _t(Zt,Bt){Bt===void 0&&(Bt=.5);var Wt=Zt.slice(0,2),ct=Zt.slice(2,4),ee=Zt.slice(4,6),K=Zt.slice(6,8),J=(0,pt.k)(Wt,ct,Bt),Ct=(0,pt.k)(ct,ee,Bt),ft=(0,pt.k)(ee,K,Bt),mt=(0,pt.k)(J,Ct,Bt),lt=(0,pt.k)(Ct,ft,Bt),jt=(0,pt.k)(mt,lt,Bt);return[["C"].concat(J,mt,jt),["C"].concat(lt,ft,K)]}function qt(Zt){return Zt.map(function(Bt,Wt,ct){var ee=Wt&&ct[Wt-1].slice(-2).concat(Bt.slice(1)),K=Wt?(0,it.S)(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5],ee[6],ee[7],ee[8],{bbox:!1}).length:0,J;return Wt?J=K?_t(ee):[Bt,Bt]:J=[Bt],{s:Bt,ss:J,l:K}})}function q(Zt,Bt,Wt){var ct=qt(Zt),ee=qt(Bt),K=ct.length,J=ee.length,Ct=ct.filter(function(ye){return ye.l}).length,ft=ee.filter(function(ye){return ye.l}).length,mt=ct.filter(function(ye){return ye.l}).reduce(function(ye,Vt){var $=Vt.l;return ye+$},0)/Ct||0,lt=ee.filter(function(ye){return ye.l}).reduce(function(ye,Vt){var $=Vt.l;return ye+$},0)/ft||0,jt=Wt||Math.max(K,J),ue=[mt,lt],we=[jt-K,jt-J],Ne=0,Ge=[ct,ee].map(function(ye,Vt){return ye.l===jt?ye.map(function($){return $.s}):ye.map(function($,ae){return Ne=ae&&we[Vt]&&$.l>=ue[Vt],we[Vt]-=Ne?1:0,Ne?$.ss:[$.s]}).flat()});return Ge[0].length===Ge[1].length?Ge:q(Ge[0],Ge[1],jt)}},92455:function(ke,Se,k){"use strict";k.d(Se,{b:function(){return qt}});var pt=k(75839);function it(q,Zt,Bt,Wt,ct,ee,K,J){return 3*((J-Zt)*(Bt+ct)-(K-q)*(Wt+ee)+Wt*(q-ct)-Bt*(Zt-ee)+J*(ct+q/3)-K*(ee+Zt/3))/20}function _t(q){var Zt=0,Bt=0,Wt=0;return(0,pt.Y)(q).map(function(ct){var ee;switch(ct[0]){case"M":return Zt=ct[1],Bt=ct[2],0;default:var K=ct.slice(1),J=K[0],Ct=K[1],ft=K[2],mt=K[3],lt=K[4],jt=K[5];return Wt=it(Zt,Bt,J,Ct,ft,mt,lt,jt),ee=ct.slice(-2),Zt=ee[0],Bt=ee[1],Wt}}).reduce(function(ct,ee){return ct+ee},0)}function qt(q){return _t(q)>=0}},84329:function(ke,Se,k){"use strict";k.d(Se,{r:function(){return _t}});var pt=k(97582),it=k(32262);function _t(qt,q,Zt){return(0,it.s)(qt,q,(0,pt.pi)((0,pt.pi)({},Zt),{bbox:!1,length:!0})).point}},83555:function(ke,Se,k){"use strict";k.d(Se,{g:function(){return _t}});var pt=k(44078);function it(qt){var q=qt.length,Zt=q-1;return qt.map(function(Bt,Wt){return qt.map(function(ct,ee){var K=Wt+ee,J;return ee===0||qt[K]&&qt[K][0]==="M"?(J=qt[K],["M"].concat(J.slice(-2))):(K>=q&&(K-=Zt),qt[K])})})}function _t(qt,q){var Zt=qt.length-1,Bt=[],Wt=0,ct=0,ee=it(qt);return ee.forEach(function(K,J){qt.slice(1).forEach(function(Ct,ft){ct+=(0,pt.y)(qt[(J+ft)%Zt].slice(-2),q[ft%Zt].slice(-2))}),Bt[J]=ct,ct=0}),Wt=Bt.indexOf(Math.min.apply(null,Bt)),ee[Wt]}},69877:function(ke,Se,k){"use strict";k.d(Se,{D:function(){return _t}});var pt=k(97582),it=k(32262);function _t(qt,q){return(0,it.s)(qt,void 0,(0,pt.pi)((0,pt.pi)({},q),{bbox:!1,length:!0})).length}},41010:function(ke,Se,k){"use strict";k.d(Se,{b:function(){return it}});var pt=k(56346);function it(_t){return(0,pt.n)(_t)&&_t.every(function(qt){var q=qt[0];return q===q.toUpperCase()})}},11013:function(ke,Se,k){"use strict";k.d(Se,{y:function(){return it}});var pt=k(41010);function it(_t){return(0,pt.b)(_t)&&_t.every(function(qt){var q=qt[0];return"ACLMQZ".includes(q)})}},56346:function(ke,Se,k){"use strict";k.d(Se,{n:function(){return it}});var pt=k(18323);function it(_t){return Array.isArray(_t)&&_t.every(function(qt){var q=qt[0].toLowerCase();return pt.R[q]===qt.length-1&&"achlmqstvz".includes(q)})}},17570:function(ke,Se,k){"use strict";k.d(Se,{k:function(){return pt}});function pt(it,_t,qt){var q=it[0],Zt=it[1],Bt=_t[0],Wt=_t[1];return[q+(Bt-q)*qt,Zt+(Wt-Zt)*qt]}},32262:function(ke,Se,k){"use strict";k.d(Se,{s:function(){return K}});var pt=k(4848),it=k(17570),_t=k(44078);function qt(J,Ct,ft,mt,lt){var jt=(0,_t.y)([J,Ct],[ft,mt]),ue={x:0,y:0};if(typeof lt=="number")if(lt<=0)ue={x:J,y:Ct};else if(lt>=jt)ue={x:ft,y:mt};else{var we=(0,it.k)([J,Ct],[ft,mt],lt/jt),Ne=we[0],Ge=we[1];ue={x:Ne,y:Ge}}return{length:jt,point:ue,min:{x:Math.min(J,ft),y:Math.min(Ct,mt)},max:{x:Math.max(J,ft),y:Math.max(Ct,mt)}}}function q(J,Ct){var ft=J.x,mt=J.y,lt=Ct.x,jt=Ct.y,ue=ft*lt+mt*jt,we=Math.sqrt((Math.pow(ft,2)+Math.pow(mt,2))*(Math.pow(lt,2)+Math.pow(jt,2))),Ne=ft*jt-mt*lt<0?-1:1,Ge=Ne*Math.acos(ue/we);return Ge}function Zt(J,Ct,ft,mt,lt,jt,ue,we,Ne,Ge){var ye=Math.abs,Vt=Math.sin,$=Math.cos,ae=Math.sqrt,Gt=Math.PI,_e=ye(ft),xe=ye(mt),X=(lt%360+360)%360,Rt=X*(Gt/180);if(J===we&&Ct===Ne)return{x:J,y:Ct};if(_e===0||xe===0)return qt(J,Ct,we,Ne,Ge).point;var V=(J-we)/2,Mt=(Ct-Ne)/2,H={x:$(Rt)*V+Vt(Rt)*Mt,y:-Vt(Rt)*V+$(Rt)*Mt},N=Math.pow(H.x,2)/Math.pow(_e,2)+Math.pow(H.y,2)/Math.pow(xe,2);N>1&&(_e*=ae(N),xe*=ae(N));var et=Math.pow(_e,2)*Math.pow(xe,2)-Math.pow(_e,2)*Math.pow(H.y,2)-Math.pow(xe,2)*Math.pow(H.x,2),ot=Math.pow(_e,2)*Math.pow(H.y,2)+Math.pow(xe,2)*Math.pow(H.x,2),At=et/ot;At=At<0?0:At;var Dt=(jt!==ue?1:-1)*ae(At),ie={x:Dt*(_e*H.y/xe),y:Dt*(-(xe*H.x)/_e)},Tt={x:$(Rt)*ie.x-Vt(Rt)*ie.y+(J+we)/2,y:Vt(Rt)*ie.x+$(Rt)*ie.y+(Ct+Ne)/2},zt={x:(H.x-ie.x)/_e,y:(H.y-ie.y)/xe},Oe=q({x:1,y:0},zt),Lt={x:(-H.x-ie.x)/_e,y:(-H.y-ie.y)/xe},nt=q(zt,Lt);!ue&&nt>0?nt-=2*Gt:ue&&nt<0&&(nt+=2*Gt),nt%=2*Gt;var Ft=Oe+nt*Ge,he=_e*$(Ft),yt=xe*Vt(Ft),St={x:$(Rt)*he-Vt(Rt)*yt+Tt.x,y:Vt(Rt)*he+$(Rt)*yt+Tt.y};return St}function Bt(J,Ct,ft,mt,lt,jt,ue,we,Ne,Ge,ye){var Vt,$=ye.bbox,ae=$===void 0?!0:$,Gt=ye.length,_e=Gt===void 0?!0:Gt,xe=ye.sampleSize,X=xe===void 0?30:xe,Rt=typeof Ge=="number",V=J,Mt=Ct,H=0,N=[V,Mt,H],et=[V,Mt],ot=0,At={x:0,y:0},Dt=[{x:V,y:Mt}];Rt&&Ge<=0&&(At={x:V,y:Mt});for(var ie=0;ie<=X;ie+=1){if(ot=ie/X,Vt=Zt(J,Ct,ft,mt,lt,jt,ue,we,Ne,ot),V=Vt.x,Mt=Vt.y,ae&&Dt.push({x:V,y:Mt}),_e&&(H+=(0,_t.y)(et,[V,Mt])),et=[V,Mt],Rt&&H>=Ge&&Ge>N[2]){var Tt=(H-Ge)/(H-N[2]);At={x:et[0]*(1-Tt)+N[0]*Tt,y:et[1]*(1-Tt)+N[1]*Tt}}N=[V,Mt,H]}return Rt&&Ge>=H&&(At={x:we,y:Ne}),{length:H,point:At,min:{x:Math.min.apply(null,Dt.map(function(zt){return zt.x})),y:Math.min.apply(null,Dt.map(function(zt){return zt.y}))},max:{x:Math.max.apply(null,Dt.map(function(zt){return zt.x})),y:Math.max.apply(null,Dt.map(function(zt){return zt.y}))}}}var Wt=k(6489);function ct(J,Ct,ft,mt,lt,jt,ue){var we=1-ue;return{x:Math.pow(we,2)*J+2*we*ue*ft+Math.pow(ue,2)*lt,y:Math.pow(we,2)*Ct+2*we*ue*mt+Math.pow(ue,2)*jt}}function ee(J,Ct,ft,mt,lt,jt,ue,we){var Ne,Ge=we.bbox,ye=Ge===void 0?!0:Ge,Vt=we.length,$=Vt===void 0?!0:Vt,ae=we.sampleSize,Gt=ae===void 0?10:ae,_e=typeof ue=="number",xe=J,X=Ct,Rt=0,V=[xe,X,Rt],Mt=[xe,X],H=0,N={x:0,y:0},et=[{x:xe,y:X}];_e&&ue<=0&&(N={x:xe,y:X});for(var ot=0;ot<=Gt;ot+=1){if(H=ot/Gt,Ne=ct(J,Ct,ft,mt,lt,jt,H),xe=Ne.x,X=Ne.y,ye&&et.push({x:xe,y:X}),$&&(Rt+=(0,_t.y)(Mt,[xe,X])),Mt=[xe,X],_e&&Rt>=ue&&ue>V[2]){var At=(Rt-ue)/(Rt-V[2]);N={x:Mt[0]*(1-At)+V[0]*At,y:Mt[1]*(1-At)+V[1]*At}}V=[xe,X,Rt]}return _e&&ue>=Rt&&(N={x:lt,y:jt}),{length:Rt,point:N,min:{x:Math.min.apply(null,et.map(function(Dt){return Dt.x})),y:Math.min.apply(null,et.map(function(Dt){return Dt.y}))},max:{x:Math.max.apply(null,et.map(function(Dt){return Dt.x})),y:Math.max.apply(null,et.map(function(Dt){return Dt.y}))}}}function K(J,Ct,ft){for(var mt,lt,jt,ue,we,Ne,Ge=(0,pt.A)(J),ye=typeof Ct=="number",Vt,$=[],ae,Gt=0,_e=0,xe=0,X=0,Rt,V=[],Mt=[],H=0,N={x:0,y:0},et=N,ot=N,At=N,Dt=0,ie=0,Tt=Ge.length;ie<Tt;ie+=1)Rt=Ge[ie],ae=Rt[0],Vt=ae==="M",$=Vt?$:[Gt,_e].concat(Rt.slice(1)),Vt?(xe=Rt[1],X=Rt[2],N={x:xe,y:X},et=N,H=0,ye&&Ct<.001&&(At=N)):ae==="L"?(mt=qt($[0],$[1],$[2],$[3],(Ct||0)-Dt),H=mt.length,N=mt.min,et=mt.max,ot=mt.point):ae==="A"?(lt=Bt($[0],$[1],$[2],$[3],$[4],$[5],$[6],$[7],$[8],(Ct||0)-Dt,ft||{}),H=lt.length,N=lt.min,et=lt.max,ot=lt.point):ae==="C"?(jt=(0,Wt.S)($[0],$[1],$[2],$[3],$[4],$[5],$[6],$[7],(Ct||0)-Dt,ft||{}),H=jt.length,N=jt.min,et=jt.max,ot=jt.point):ae==="Q"?(ue=ee($[0],$[1],$[2],$[3],$[4],$[5],(Ct||0)-Dt,ft||{}),H=ue.length,N=ue.min,et=ue.max,ot=ue.point):ae==="Z"&&($=[Gt,_e,xe,X],we=qt($[0],$[1],$[2],$[3],(Ct||0)-Dt),H=we.length,N=we.min,et=we.max,ot=we.point),ye&&Dt<Ct&&Dt+H>=Ct&&(At=ot),Mt.push(et),V.push(N),Dt+=H,Ne=ae!=="Z"?Rt.slice(-2):[xe,X],Gt=Ne[0],_e=Ne[1];return ye&&Ct>=Dt&&(At={x:Gt,y:_e}),{length:Dt,point:At,min:{x:Math.min.apply(null,V.map(function(zt){return zt.x})),y:Math.min.apply(null,V.map(function(zt){return zt.y}))},max:{x:Math.max.apply(null,Mt.map(function(zt){return zt.x})),y:Math.max.apply(null,Mt.map(function(zt){return zt.y}))}}}},6489:function(ke,Se,k){"use strict";k.d(Se,{S:function(){return _t}});var pt=k(44078);function it(qt,q,Zt,Bt,Wt,ct,ee,K,J){var Ct=1-J;return{x:Math.pow(Ct,3)*qt+3*Math.pow(Ct,2)*J*Zt+3*Ct*Math.pow(J,2)*Wt+Math.pow(J,3)*ee,y:Math.pow(Ct,3)*q+3*Math.pow(Ct,2)*J*Bt+3*Ct*Math.pow(J,2)*ct+Math.pow(J,3)*K}}function _t(qt,q,Zt,Bt,Wt,ct,ee,K,J,Ct){var ft,mt=Ct.bbox,lt=mt===void 0?!0:mt,jt=Ct.length,ue=jt===void 0?!0:jt,we=Ct.sampleSize,Ne=we===void 0?10:we,Ge=typeof J=="number",ye=qt,Vt=q,$=0,ae=[ye,Vt,$],Gt=[ye,Vt],_e=0,xe={x:0,y:0},X=[{x:ye,y:Vt}];Ge&&J<=0&&(xe={x:ye,y:Vt});for(var Rt=0;Rt<=Ne;Rt+=1){if(_e=Rt/Ne,ft=it(qt,q,Zt,Bt,Wt,ct,ee,K,_e),ye=ft.x,Vt=ft.y,lt&&X.push({x:ye,y:Vt}),ue&&($+=(0,pt.y)(Gt,[ye,Vt])),Gt=[ye,Vt],Ge&&$>=J&&J>ae[2]){var V=($-J)/($-ae[2]);xe={x:Gt[0]*(1-V)+ae[0]*V,y:Gt[1]*(1-V)+ae[1]*V}}ae=[ye,Vt,$]}return Ge&&J>=$&&(xe={x:ee,y:K}),{length:$,point:xe,min:{x:Math.min.apply(null,X.map(function(Mt){return Mt.x})),y:Math.min.apply(null,X.map(function(Mt){return Mt.y}))},max:{x:Math.max.apply(null,X.map(function(Mt){return Mt.x})),y:Math.max.apply(null,X.map(function(Mt){return Mt.y}))}}}},38163:function(ke){ke.exports=Se;function Se(it,_t){var qt=it&&it.type,q;if(qt==="FeatureCollection")for(q=0;q<it.features.length;q++)Se(it.features[q],_t);else if(qt==="GeometryCollection")for(q=0;q<it.geometries.length;q++)Se(it.geometries[q],_t);else if(qt==="Feature")Se(it.geometry,_t);else if(qt==="Polygon")k(it.coordinates,_t);else if(qt==="MultiPolygon")for(q=0;q<it.coordinates.length;q++)k(it.coordinates[q],_t);return it}function k(it,_t){if(it.length!==0){pt(it[0],_t);for(var qt=1;qt<it.length;qt++)pt(it[qt],!_t)}}function pt(it,_t){for(var qt=0,q=0,Zt=0,Bt=it.length,Wt=Bt-1;Zt<Bt;Wt=Zt++){var ct=(it[Zt][0]-it[Wt][0])*(it[Wt][1]+it[Zt][1]),ee=qt+ct;q+=Math.abs(qt)>=Math.abs(ct)?qt-ee+ct:ct-ee+qt,qt=ee}qt+q>=0!=!!_t&&it.reverse()}},75550:function(ke){"use strict";ke.exports=Se;function Se(k,pt){this.x=k,this.y=pt}Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(k){return this.clone()._add(k)},sub:function(k){return this.clone()._sub(k)},multByPoint:function(k){return this.clone()._multByPoint(k)},divByPoint:function(k){return this.clone()._divByPoint(k)},mult:function(k){return this.clone()._mult(k)},div:function(k){return this.clone()._div(k)},rotate:function(k){return this.clone()._rotate(k)},rotateAround:function(k,pt){return this.clone()._rotateAround(k,pt)},matMult:function(k){return this.clone()._matMult(k)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(k){return this.x===k.x&&this.y===k.y},dist:function(k){return Math.sqrt(this.distSqr(k))},distSqr:function(k){var pt=k.x-this.x,it=k.y-this.y;return pt*pt+it*it},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(k){return Math.atan2(this.y-k.y,this.x-k.x)},angleWith:function(k){return this.angleWithSep(k.x,k.y)},angleWithSep:function(k,pt){return Math.atan2(this.x*pt-this.y*k,this.x*k+this.y*pt)},_matMult:function(k){var pt=k[0]*this.x+k[1]*this.y,it=k[2]*this.x+k[3]*this.y;return this.x=pt,this.y=it,this},_add:function(k){return this.x+=k.x,this.y+=k.y,this},_sub:function(k){return this.x-=k.x,this.y-=k.y,this},_mult:function(k){return this.x*=k,this.y*=k,this},_div:function(k){return this.x/=k,this.y/=k,this},_multByPoint:function(k){return this.x*=k.x,this.y*=k.y,this},_divByPoint:function(k){return this.x/=k.x,this.y/=k.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var k=this.y;return this.y=this.x,this.x=-k,this},_rotate:function(k){var pt=Math.cos(k),it=Math.sin(k),_t=pt*this.x-it*this.y,qt=it*this.x+pt*this.y;return this.x=_t,this.y=qt,this},_rotateAround:function(k,pt){var it=Math.cos(k),_t=Math.sin(k),qt=pt.x+it*(this.x-pt.x)-_t*(this.y-pt.y),q=pt.y+_t*(this.x-pt.x)+it*(this.y-pt.y);return this.x=qt,this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Se.convert=function(k){return k instanceof Se?k:Array.isArray(k)?new Se(k[0],k[1]):k}},49296:function(ke){"use strict";ke.exports=k,ke.exports.default=k;var Se=1e20;function k(q,Zt,Bt,Wt,ct,ee){this.fontSize=q||24,this.buffer=Zt===void 0?3:Zt,this.cutoff=Wt||.25,this.fontFamily=ct||"sans-serif",this.fontWeight=ee||"normal",this.radius=Bt||8;var K=this.size=this.fontSize+this.buffer*2,J=K+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=K,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(J*J),this.gridInner=new Float64Array(J*J),this.f=new Float64Array(J),this.z=new Float64Array(J+1),this.v=new Uint16Array(J),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(K/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function pt(q,Zt,Bt,Wt,ct,ee,K){ee.fill(Se,0,Zt*Bt),K.fill(0,0,Zt*Bt);for(var J=(Zt-Wt)/2,Ct=0;Ct<ct;Ct++)for(var ft=0;ft<Wt;ft++){var mt=(Ct+J)*Zt+ft+J,lt=q.data[4*(Ct*Wt+ft)+3]/255;if(lt===1)ee[mt]=0,K[mt]=Se;else if(lt===0)ee[mt]=Se,K[mt]=0;else{var jt=Math.max(0,.5-lt),ue=Math.max(0,lt-.5);ee[mt]=jt*jt,K[mt]=ue*ue}}}function it(q,Zt,Bt,Wt,ct,ee,K){for(var J=0;J<Zt*Bt;J++){var Ct=Math.sqrt(Wt[J])-Math.sqrt(ct[J]);q[J]=Math.round(255-255*(Ct/ee+K))}}k.prototype._draw=function(q,Zt){var Bt=this.ctx.measureText(q),Wt=Bt.width,ct=2*this.buffer,ee,K,J,Ct,ft,mt,lt,jt;Zt&&this.useMetrics?(ft=Math.floor(Bt.actualBoundingBoxAscent),jt=this.buffer+Math.ceil(Bt.actualBoundingBoxAscent),mt=this.buffer,lt=this.buffer,K=Math.min(this.size,Math.ceil(Bt.actualBoundingBoxRight-Bt.actualBoundingBoxLeft)),Ct=Math.min(this.size-mt,Math.ceil(Bt.actualBoundingBoxAscent+Bt.actualBoundingBoxDescent)),ee=K+ct,J=Ct+ct,this.ctx.textBaseline="alphabetic"):(ee=K=this.size,J=Ct=this.size,ft=19*this.fontSize/24,mt=lt=0,jt=this.middle,this.ctx.textBaseline="middle");var ue;K&&Ct&&(this.ctx.clearRect(lt,mt,K,Ct),this.ctx.fillText(q,this.buffer,jt),ue=this.ctx.getImageData(lt,mt,K,Ct));var we=new Uint8ClampedArray(ee*J);return pt(ue,ee,J,K,Ct,this.gridOuter,this.gridInner),_t(this.gridOuter,ee,J,this.f,this.v,this.z),_t(this.gridInner,ee,J,this.f,this.v,this.z),it(we,ee,J,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:we,metrics:{width:K,height:Ct,sdfWidth:ee,sdfHeight:J,top:ft,left:0,advance:Wt}}},k.prototype.draw=function(q){return this._draw(q,!1).data},k.prototype.drawWithMetrics=function(q){return this._draw(q,!0)};function _t(q,Zt,Bt,Wt,ct,ee){for(var K=0;K<Zt;K++)qt(q,K,Zt,Bt,Wt,ct,ee);for(var J=0;J<Bt;J++)qt(q,J*Zt,1,Zt,Wt,ct,ee)}function qt(q,Zt,Bt,Wt,ct,ee,K){var J,Ct,ft,mt;for(ee[0]=0,K[0]=-Se,K[1]=Se,J=0;J<Wt;J++)ct[J]=q[Zt+J*Bt];for(J=1,Ct=0,ft=0;J<Wt;J++){do mt=ee[Ct],ft=(ct[J]-ct[mt]+J*J-mt*mt)/(J-mt)/2;while(ft<=K[Ct]&&--Ct>-1);Ct++,ee[Ct]=J,K[Ct]=ft,K[Ct+1]=Se}for(J=0,Ct=0;J<Wt;J++){for(;K[Ct+1]<J;)Ct++;mt=ee[Ct],q[Zt+J*Bt]=ct[mt]+(J-mt)*(J-mt)}}},38929:function(ke,Se,k){ke.exports.VectorTile=k(22779),k(66024),k(59701)},22779:function(ke,Se,k){"use strict";var pt=k(59701);ke.exports=it;function it(qt,q){this.layers=qt.readFields(_t,{},q)}function _t(qt,q,Zt){if(qt===3){var Bt=new pt(Zt,Zt.readVarint()+Zt.pos);Bt.length&&(q[Bt.name]=Bt)}}},66024:function(ke,Se,k){"use strict";var pt=k(75550);ke.exports=it;function it(Bt,Wt,ct,ee,K){this.properties={},this.extent=ct,this.type=0,this._pbf=Bt,this._geometry=-1,this._keys=ee,this._values=K,Bt.readFields(_t,this,Wt)}function _t(Bt,Wt,ct){Bt==1?Wt.id=ct.readVarint():Bt==2?qt(ct,Wt):Bt==3?Wt.type=ct.readVarint():Bt==4&&(Wt._geometry=ct.pos)}function qt(Bt,Wt){for(var ct=Bt.readVarint()+Bt.pos;Bt.pos<ct;){var ee=Wt._keys[Bt.readVarint()],K=Wt._values[Bt.readVarint()];Wt.properties[ee]=K}}it.types=["Unknown","Point","LineString","Polygon"],it.prototype.loadGeometry=function(){var Bt=this._pbf;Bt.pos=this._geometry;for(var Wt=Bt.readVarint()+Bt.pos,ct=1,ee=0,K=0,J=0,Ct=[],ft;Bt.pos<Wt;){if(ee<=0){var mt=Bt.readVarint();ct=mt&7,ee=mt>>3}if(ee--,ct===1||ct===2)K+=Bt.readSVarint(),J+=Bt.readSVarint(),ct===1&&(ft&&Ct.push(ft),ft=[]),ft.push(new pt(K,J));else if(ct===7)ft&&ft.push(ft[0].clone());else throw new Error("unknown command "+ct)}return ft&&Ct.push(ft),Ct},it.prototype.bbox=function(){var Bt=this._pbf;Bt.pos=this._geometry;for(var Wt=Bt.readVarint()+Bt.pos,ct=1,ee=0,K=0,J=0,Ct=1/0,ft=-1/0,mt=1/0,lt=-1/0;Bt.pos<Wt;){if(ee<=0){var jt=Bt.readVarint();ct=jt&7,ee=jt>>3}if(ee--,ct===1||ct===2)K+=Bt.readSVarint(),J+=Bt.readSVarint(),K<Ct&&(Ct=K),K>ft&&(ft=K),J<mt&&(mt=J),J>lt&&(lt=J);else if(ct!==7)throw new Error("unknown command "+ct)}return[Ct,mt,ft,lt]},it.prototype.toGeoJSON=function(Bt,Wt,ct){var ee=this.extent*Math.pow(2,ct),K=this.extent*Bt,J=this.extent*Wt,Ct=this.loadGeometry(),ft=it.types[this.type],mt,lt;function jt(Ne){for(var Ge=0;Ge<Ne.length;Ge++){var ye=Ne[Ge],Vt=180-(ye.y+J)*360/ee;Ne[Ge]=[(ye.x+K)*360/ee-180,360/Math.PI*Math.atan(Math.exp(Vt*Math.PI/180))-90]}}switch(this.type){case 1:var ue=[];for(mt=0;mt<Ct.length;mt++)ue[mt]=Ct[mt][0];Ct=ue,jt(Ct);break;case 2:for(mt=0;mt<Ct.length;mt++)jt(Ct[mt]);break;case 3:for(Ct=q(Ct),mt=0;mt<Ct.length;mt++)for(lt=0;lt<Ct[mt].length;lt++)jt(Ct[mt][lt]);break}Ct.length===1?Ct=Ct[0]:ft="Multi"+ft;var we={type:"Feature",geometry:{type:ft,coordinates:Ct},properties:this.properties};return"id"in this&&(we.id=this.id),we};function q(Bt){var Wt=Bt.length;if(Wt<=1)return[Bt];for(var ct=[],ee,K,J=0;J<Wt;J++){var Ct=Zt(Bt[J]);Ct!==0&&(K===void 0&&(K=Ct<0),K===Ct<0?(ee&&ct.push(ee),ee=[Bt[J]]):ee.push(Bt[J]))}return ee&&ct.push(ee),ct}function Zt(Bt){for(var Wt=0,ct=0,ee=Bt.length,K=ee-1,J,Ct;ct<ee;K=ct++)J=Bt[ct],Ct=Bt[K],Wt+=(Ct.x-J.x)*(J.y+Ct.y);return Wt}},59701:function(ke,Se,k){"use strict";var pt=k(66024);ke.exports=it;function it(q,Zt){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=q,this._keys=[],this._values=[],this._features=[],q.readFields(_t,this,Zt),this.length=this._features.length}function _t(q,Zt,Bt){q===15?Zt.version=Bt.readVarint():q===1?Zt.name=Bt.readString():q===5?Zt.extent=Bt.readVarint():q===2?Zt._features.push(Bt.pos):q===3?Zt._keys.push(Bt.readString()):q===4&&Zt._values.push(qt(Bt))}function qt(q){for(var Zt=null,Bt=q.readVarint()+q.pos;q.pos<Bt;){var Wt=q.readVarint()>>3;Zt=Wt===1?q.readString():Wt===2?q.readFloat():Wt===3?q.readDouble():Wt===4?q.readVarint64():Wt===5?q.readVarint():Wt===6?q.readSVarint():Wt===7?q.readBoolean():null}return Zt}it.prototype.feature=function(q){if(q<0||q>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[q];var Zt=this._pbf.readVarint()+this._pbf.pos;return new pt(this._pbf,Zt,this.extent,this._keys,this._values)}},58092:function(ke,Se,k){"use strict";k.d(Se,{Z:function(){return BC}});var pt=k(48134),it={},_t={},qt=a=>_t[a],q=(a,i)=>{_t[a]=i},Zt=a=>it[a],Bt=(a,i)=>{it[a]=i},Wt={},ct={},ee=34,K=10,J=13;function Ct(a){return new Function("d","return {"+a.map(function(i,s){return JSON.stringify(i)+": d["+s+'] || ""'}).join(",")+"}")}function ft(a,i){var s=Ct(a);return function(f,g){return i(s(f),g,a)}}function mt(a){var i=Object.create(null),s=[];return a.forEach(function(f){for(var g in f)g in i||s.push(i[g]=g)}),s}function lt(a,i){var s=a+"",f=s.length;return f<i?new Array(i-f+1).join(0)+s:s}function jt(a){return a<0?"-"+lt(-a,6):a>9999?"+"+lt(a,6):lt(a,4)}function ue(a){var i=a.getUTCHours(),s=a.getUTCMinutes(),f=a.getUTCSeconds(),g=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":jt(a.getUTCFullYear(),4)+"-"+lt(a.getUTCMonth()+1,2)+"-"+lt(a.getUTCDate(),2)+(g?"T"+lt(i,2)+":"+lt(s,2)+":"+lt(f,2)+"."+lt(g,3)+"Z":f?"T"+lt(i,2)+":"+lt(s,2)+":"+lt(f,2)+"Z":s||i?"T"+lt(i,2)+":"+lt(s,2)+"Z":"")}function we(a){var i=new RegExp('["'+a+`
\r]`),s=a.charCodeAt(0);function f(U,G){var vt,$t,te=g(U,function(Te,Fe){if(vt)return vt(Te,Fe-1);$t=Te,vt=G?ft(Te,G):Ct(Te)});return te.columns=$t||[],te}function g(U,G){var vt=[],$t=U.length,te=0,Te=0,Fe,Ze=$t<=0,je=!1;U.charCodeAt($t-1)===K&&--$t,U.charCodeAt($t-1)===J&&--$t;function Qe(){if(Ze)return ct;if(je)return je=!1,Wt;var wn,mn=te,Mn;if(U.charCodeAt(mn)===ee){for(;te++<$t&&U.charCodeAt(te)!==ee||U.charCodeAt(++te)===ee;);return(wn=te)>=$t?Ze=!0:(Mn=U.charCodeAt(te++))===K?je=!0:Mn===J&&(je=!0,U.charCodeAt(te)===K&&++te),U.slice(mn+1,wn-1).replace(/""/g,'"')}for(;te<$t;){if((Mn=U.charCodeAt(wn=te++))===K)je=!0;else if(Mn===J)je=!0,U.charCodeAt(te)===K&&++te;else if(Mn!==s)continue;return U.slice(mn,wn)}return Ze=!0,U.slice(mn,$t)}for(;(Fe=Qe())!==ct;){for(var ln=[];Fe!==Wt&&Fe!==ct;)ln.push(Fe),Fe=Qe();G&&(ln=G(ln,Te++))==null||vt.push(ln)}return vt}function y(U,G){return U.map(function(vt){return G.map(function($t){return B(vt[$t])}).join(a)})}function _(U,G){return G==null&&(G=mt(U)),[G.map(B).join(a)].concat(y(U,G)).join(`
`)}function O(U,G){return G==null&&(G=mt(U)),y(U,G).join(`
`)}function A(U){return U.map(P).join(`
`)}function P(U){return U.map(B).join(a)}function B(U){return U==null?"":U instanceof Date?ue(U):i.test(U+="")?'"'+U.replace(/"/g,'""')+'"':U}return{parse:f,parseRows:g,format:_,formatBody:O,formatRows:A,formatRow:P,formatValue:B}}var Ne=we(","),Ge=Ne.parse,ye=Ne.parseRows,Vt=Ne.format,$=Ne.formatBody,ae=Ne.formatRows,Gt=Ne.formatRow,_e=Ne.formatValue,xe=63710088e-1,X={centimeters:xe*100,centimetres:xe*100,degrees:xe/111325,feet:xe*3.28084,inches:xe*39.37,kilometers:xe/1e3,kilometres:xe/1e3,meters:xe,metres:xe,miles:xe/1609.344,millimeters:xe*1e3,millimetres:xe*1e3,nauticalmiles:xe/1852,radians:1,yards:xe*1.0936},Rt={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/xe,yards:1.0936133},V={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Mt(a,i,s){s===void 0&&(s={});var f={type:"Feature"};return(s.id===0||s.id)&&(f.id=s.id),s.bbox&&(f.bbox=s.bbox),f.properties=i||{},f.geometry=a,f}function H(a,i,s){switch(s===void 0&&(s={}),a){case"Point":return N(i).geometry;case"LineString":return Dt(i).geometry;case"Polygon":return ot(i).geometry;case"MultiPoint":return Oe(i).geometry;case"MultiLineString":return zt(i).geometry;case"MultiPolygon":return Lt(i).geometry;default:throw new Error(a+" is invalid")}}function N(a,i,s){if(s===void 0&&(s={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!j(a[0])||!j(a[1]))throw new Error("coordinates must contain numbers");var f={type:"Point",coordinates:a};return Mt(f,i,s)}function et(a,i,s){return s===void 0&&(s={}),Tt(a.map(function(f){return N(f,i)}),s)}function ot(a,i,s){s===void 0&&(s={});for(var f=0,g=a;f<g.length;f++){var y=g[f];if(y.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<y[y.length-1].length;_++)if(y[y.length-1][_]!==y[0][_])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:a};return Mt(O,i,s)}function At(a,i,s){return s===void 0&&(s={}),Tt(a.map(function(f){return ot(f,i)}),s)}function Dt(a,i,s){if(s===void 0&&(s={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");var f={type:"LineString",coordinates:a};return Mt(f,i,s)}function ie(a,i,s){return s===void 0&&(s={}),Tt(a.map(function(f){return Dt(f,i)}),s)}function Tt(a,i){i===void 0&&(i={});var s={type:"FeatureCollection"};return i.id&&(s.id=i.id),i.bbox&&(s.bbox=i.bbox),s.features=a,s}function zt(a,i,s){s===void 0&&(s={});var f={type:"MultiLineString",coordinates:a};return Mt(f,i,s)}function Oe(a,i,s){s===void 0&&(s={});var f={type:"MultiPoint",coordinates:a};return Mt(f,i,s)}function Lt(a,i,s){s===void 0&&(s={});var f={type:"MultiPolygon",coordinates:a};return Mt(f,i,s)}function nt(a,i,s){s===void 0&&(s={});var f={type:"GeometryCollection",geometries:a};return Mt(f,i,s)}function Ft(a,i){if(i===void 0&&(i=0),i&&!(i>=0))throw new Error("precision must be a positive number");var s=Math.pow(10,i||0);return Math.round(a*s)/s}function he(a,i){i===void 0&&(i="kilometers");var s=X[i];if(!s)throw new Error(i+" units is invalid");return a*s}function yt(a,i){i===void 0&&(i="kilometers");var s=X[i];if(!s)throw new Error(i+" units is invalid");return a/s}function St(a,i){return T(yt(a,i))}function F(a){var i=a%360;return i<0&&(i+=360),i}function T(a){var i=a%(2*Math.PI);return i*180/Math.PI}function gt(a){var i=a%360;return i*Math.PI/180}function ne(a,i,s){if(i===void 0&&(i="kilometers"),s===void 0&&(s="kilometers"),!(a>=0))throw new Error("length must be a positive number");return he(yt(a,i),s)}function C(a,i,s){if(i===void 0&&(i="meters"),s===void 0&&(s="kilometers"),!(a>=0))throw new Error("area must be a positive number");var f=V[i];if(!f)throw new Error("invalid original units");var g=V[s];if(!g)throw new Error("invalid final units");return a/f*g}function j(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)}function Pt(a){return!!a&&a.constructor===Object}function Jt(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(a.length!==4&&a.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(i){if(!j(i))throw new Error("bbox must only contain numbers")})}function se(a){if(!a)throw new Error("id is required");if(["string","number"].indexOf(typeof a)===-1)throw new Error("id must be a number or a string")}function Ae(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Le(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function De(a){if(a.length>1&&isNumber(a[0])&&isNumber(a[1]))return!0;if(Array.isArray(a[0])&&a[0].length)return De(a[0]);throw new Error("coordinates must only contain numbers")}function Ve(a,i,s){if(!i||!s)throw new Error("type and name required");if(!a||a.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+a.type)}function We(a,i,s){if(!a)throw new Error("No feature passed");if(!s)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+s+", Feature with geometry required");if(!a.geometry||a.geometry.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+a.geometry.type)}function $e(a,i,s){if(!a)throw new Error("No featureCollection passed");if(!s)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+s+", FeatureCollection required");for(var f=0,g=a.features;f<g.length;f++){var y=g[f];if(!y||y.type!=="Feature"||!y.geometry)throw new Error("Invalid input to "+s+", Feature with geometry required");if(!y.geometry||y.geometry.type!==i)throw new Error("Invalid input to "+s+": must be a "+i+", given "+y.geometry.type)}}function Ye(a){return a.type==="Feature"?a.geometry:a}function Xt(a,i){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}function re(a,i,s){if(a!==null)for(var f,g,y,_,O,A,P,B=0,U=0,G,vt=a.type,$t=vt==="FeatureCollection",te=vt==="Feature",Te=$t?a.features.length:1,Fe=0;Fe<Te;Fe++){P=$t?a.features[Fe].geometry:te?a.geometry:a,G=P?P.type==="GeometryCollection":!1,O=G?P.geometries.length:1;for(var Ze=0;Ze<O;Ze++){var je=0,Qe=0;if(_=G?P.geometries[Ze]:P,_!==null){A=_.coordinates;var ln=_.type;switch(B=s&&(ln==="Polygon"||ln==="MultiPolygon")?1:0,ln){case null:break;case"Point":if(i(A,U,Fe,je,Qe)===!1)return!1;U++,je++;break;case"LineString":case"MultiPoint":for(f=0;f<A.length;f++){if(i(A[f],U,Fe,je,Qe)===!1)return!1;U++,ln==="MultiPoint"&&je++}ln==="LineString"&&je++;break;case"Polygon":case"MultiLineString":for(f=0;f<A.length;f++){for(g=0;g<A[f].length-B;g++){if(i(A[f][g],U,Fe,je,Qe)===!1)return!1;U++}ln==="MultiLineString"&&je++,ln==="Polygon"&&Qe++}ln==="Polygon"&&je++;break;case"MultiPolygon":for(f=0;f<A.length;f++){for(Qe=0,g=0;g<A[f].length;g++){for(y=0;y<A[f][g].length-B;y++){if(i(A[f][g][y],U,Fe,je,Qe)===!1)return!1;U++}Qe++}je++}break;case"GeometryCollection":for(f=0;f<_.geometries.length;f++)if(re(_.geometries[f],i,s)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function le(a,i,s,f){var g=s;return re(a,function(y,_,O,A,P){_===0&&s===void 0?g=y:g=i(g,y,_,O,A,P)},f),g}function pe(a,i){var s;switch(a.type){case"FeatureCollection":for(s=0;s<a.features.length&&i(a.features[s].properties,s)!==!1;s++);break;case"Feature":i(a.properties,0);break}}function Q(a,i,s){var f=s;return pe(a,function(g,y){y===0&&s===void 0?f=g:f=i(f,g,y)}),f}function D(a,i){if(a.type==="Feature")i(a,0);else if(a.type==="FeatureCollection")for(var s=0;s<a.features.length&&i(a.features[s],s)!==!1;s++);}function Z(a,i,s){var f=s;return D(a,function(g,y){y===0&&s===void 0?f=g:f=i(f,g,y)}),f}function tt(a){var i=[];return re(a,function(s){i.push(s)}),i}function Et(a,i){var s,f,g,y,_,O,A,P,B,U,G=0,vt=a.type==="FeatureCollection",$t=a.type==="Feature",te=vt?a.features.length:1;for(s=0;s<te;s++){for(O=vt?a.features[s].geometry:$t?a.geometry:a,P=vt?a.features[s].properties:$t?a.properties:{},B=vt?a.features[s].bbox:$t?a.bbox:void 0,U=vt?a.features[s].id:$t?a.id:void 0,A=O?O.type==="GeometryCollection":!1,_=A?O.geometries.length:1,g=0;g<_;g++){if(y=A?O.geometries[g]:O,y===null){if(i(null,G,P,B,U)===!1)return!1;continue}switch(y.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(i(y,G,P,B,U)===!1)return!1;break}case"GeometryCollection":{for(f=0;f<y.geometries.length;f++)if(i(y.geometries[f],G,P,B,U)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}G++}}function It(a,i,s){var f=s;return Et(a,function(g,y,_,O,A){y===0&&s===void 0?f=g:f=i(f,g,y,_,O,A)}),f}function ce(a,i){Et(a,function(s,f,g,y,_){var O=s===null?null:s.type;switch(O){case null:case"Point":case"LineString":case"Polygon":return i(Mt(s,g,{bbox:y,id:_}),f,0)===!1?!1:void 0}var A;switch(O){case"MultiPoint":A="Point";break;case"MultiLineString":A="LineString";break;case"MultiPolygon":A="Polygon";break}for(var P=0;P<s.coordinates.length;P++){var B=s.coordinates[P],U={type:A,coordinates:B};if(i(Mt(U,g),f,P)===!1)return!1}})}function fe(a,i,s){var f=s;return ce(a,function(g,y,_){y===0&&_===0&&s===void 0?f=g:f=i(f,g,y,_)}),f}function Be(a,i){ce(a,function(s,f,g){var y=0;if(s.geometry){var _=s.geometry.type;if(!(_==="Point"||_==="MultiPoint")){var O,A=0,P=0,B=0;if(re(s,function(U,G,vt,$t,te){if(O===void 0||f>A||$t>P||te>B){O=U,A=f,P=$t,B=te,y=0;return}var Te=lineString([O,U],s.properties);if(i(Te,f,g,te,y)===!1)return!1;y++,O=U})===!1)return!1}}})}function ze(a,i,s){var f=s,g=!1;return Be(a,function(y,_,O,A,P){g===!1&&s===void 0?f=y:f=i(f,y,_,O,A,P),g=!0}),f}function an(a,i){if(!a)throw new Error("geojson is required");ce(a,function(s,f,g){if(s.geometry!==null){var y=s.geometry.type,_=s.geometry.coordinates;switch(y){case"LineString":if(i(s,f,g,0,0)===!1)return!1;break;case"Polygon":for(var O=0;O<_.length;O++)if(i(lineString(_[O],s.properties),f,g,O)===!1)return!1;break}}})}function Re(a,i,s){var f=s;return an(a,function(g,y,_,O){y===0&&s===void 0?f=g:f=i(f,g,y,_,O)}),f}function Ke(a,i){if(i=i||{},!isObject(i))throw new Error("options is invalid");var s=i.featureIndex||0,f=i.multiFeatureIndex||0,g=i.geometryIndex||0,y=i.segmentIndex||0,_=i.properties,O;switch(a.type){case"FeatureCollection":s<0&&(s=a.features.length+s),_=_||a.features[s].properties,O=a.features[s].geometry;break;case"Feature":_=_||a.properties,O=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=a;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var A=O.coordinates;switch(O.type){case"Point":case"MultiPoint":return null;case"LineString":return y<0&&(y=A.length+y-1),lineString([A[y],A[y+1]],_,i);case"Polygon":return g<0&&(g=A.length+g),y<0&&(y=A[g].length+y-1),lineString([A[g][y],A[g][y+1]],_,i);case"MultiLineString":return f<0&&(f=A.length+f),y<0&&(y=A[f].length+y-1),lineString([A[f][y],A[f][y+1]],_,i);case"MultiPolygon":return f<0&&(f=A.length+f),g<0&&(g=A[f].length+g),y<0&&(y=A[f][g].length-y-1),lineString([A[f][g][y],A[f][g][y+1]],_,i)}throw new Error("geojson is invalid")}function cn(a,i){if(i=i||{},!isObject(i))throw new Error("options is invalid");var s=i.featureIndex||0,f=i.multiFeatureIndex||0,g=i.geometryIndex||0,y=i.coordIndex||0,_=i.properties,O;switch(a.type){case"FeatureCollection":s<0&&(s=a.features.length+s),_=_||a.features[s].properties,O=a.features[s].geometry;break;case"Feature":_=_||a.properties,O=a.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=a;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var A=O.coordinates;switch(O.type){case"Point":return point(A,_,i);case"MultiPoint":return f<0&&(f=A.length+f),point(A[f],_,i);case"LineString":return y<0&&(y=A.length+y),point(A[y],_,i);case"Polygon":return g<0&&(g=A.length+g),y<0&&(y=A[g].length+y),point(A[g][y],_,i);case"MultiLineString":return f<0&&(f=A.length+f),y<0&&(y=A[f].length+y),point(A[f][y],_,i);case"MultiPolygon":return f<0&&(f=A.length+f),g<0&&(g=A[f].length+g),y<0&&(y=A[f][g].length-y),point(A[f][g][y],_,i)}throw new Error("geojson is invalid")}var pn={REGISTERED_PROTOCOLS:{}},An=Object.defineProperty,Gn=Object.defineProperties,Vn=Object.getOwnPropertyDescriptors,fr=Object.getOwnPropertySymbols,yr=Object.prototype.hasOwnProperty,Cr=Object.prototype.propertyIsEnumerable,jr=(a,i,s)=>i in a?An(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Dr=(a,i)=>{for(var s in i||(i={}))yr.call(i,s)&&jr(a,s,i[s]);if(fr)for(var s of fr(i))Cr.call(i,s)&&jr(a,s,i[s]);return a},Fr=(a,i)=>Gn(a,Vn(i)),zr=a=>pn.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))],si=class extends Error{constructor(a,i,s,f){super(`AJAXError: ${i} (${a}): ${s}`),this.status=a,this.statusText=i,this.url=s,this.body=f}};function ki(a,i){const s=new XMLHttpRequest,f=Array.isArray(a.url)?a.url[0]:a.url;s.open(a.method||"GET",f,!0),a.type==="arrayBuffer"&&(s.responseType="arraybuffer");for(const g in a.headers)a.headers.hasOwnProperty(g)&&s.setRequestHeader(g,a.headers[g]);return a.type==="json"&&(s.responseType="text",s.setRequestHeader("Accept","application/json")),s.withCredentials=a.credentials==="include",s.onerror=()=>{i(new Error(s.statusText))},s.onload=()=>{if((s.status>=200&&s.status<300||s.status===0)&&s.response!==null){let g=s.response;if(a.type==="json")try{g=JSON.parse(s.response)}catch(y){return i(y)}i(null,g,s.getResponseHeader("Cache-Control"),s.getResponseHeader("Expires"),s)}else{const g=new Blob([s.response],{type:s.getResponseHeader("Content-Type")});i(new si(s.status,s.statusText,f.toString(),g))}},s.cancel=s.abort,s.send(a.body),s}function ui(a){return new Promise((i,s)=>{ki(a,(f,g,y,_,O)=>{f?s({err:f,data:null,xhr:O}):i({err:null,data:g,cacheControl:y,expires:_,xhr:O})})})}function ri(a,i){return ki(a,i)}var Oi=(a,i)=>(zr(a.url)||ri)(Fr(Dr({},a),{type:"json"}),i),Ui=(a,i)=>(zr(a.url)||ri)(Fr(Dr({},a),{type:"arrayBuffer"}),i),Zo=(a,i)=>ri(Fr(Dr({},a),{method:"POST"}),i),Xi=(a,i)=>ri(Fr(Dr({},a),{method:"GET"}),i);function bo(a){const i=window.document.createElement("a");return i.href=a,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}var Xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ti(a,i){const s=new window.Image,f=window.URL||window.webkitURL;s.crossOrigin="anonymous",s.onload=()=>{i(null,s),f.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=Xr})},s.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(a)],{type:"image/png"});s.src=a.byteLength?f.createObjectURL(g):Xr}function rt(a,i){const s=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(s).then(f=>{i(null,f)}).catch(f=>{i(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var ht=(a,i,s)=>{const f=(g,y)=>{if(g)i(g);else if(y){const _=typeof createImageBitmap=="function",O=s?s(y):y;_?rt(O,i):ti(O,i)}};return a.type==="json"?Oi(a,f):Ui(a,f)},Qt=(a,i)=>{typeof createImageBitmap=="function"?rt(a,i):ti(a,i)},de=(a=>(a.CENTER="center",a.TOP="top",a["TOP-LEFT"]="top-left",a["TOP-RIGHT"]="top-right",a.BOTTOM="bottom",a["BOTTOM-LEFT"]="bottom-left",a["BOTTOM-RIGHT"]="bottom-right",a.LEFT="left",a.RIGHT="right",a))(de||{}),Ce={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Me(a,i,s){const f=a.classList;for(const g in Ce)Ce.hasOwnProperty(g)&&f.remove(`l7-${s}-anchor-${g}`);f.add(`l7-${s}-anchor-${i}`)}function ge(a,i,s){a.prototype=i.prototype=s,s.constructor=a}function ve(a,i){var s=Object.create(a.prototype);for(var f in i)s[f]=i[f];return s}function Ue(){}var He=.7,hn=1/He,vn="\\s*([+-]?\\d+)\\s*",Ln="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Sn=/^#([0-9a-f]{3,8})$/,On=new RegExp("^rgb\\("+[vn,vn,vn]+"\\)$"),un=new RegExp("^rgb\\("+[dn,dn,dn]+"\\)$"),zn=new RegExp("^rgba\\("+[vn,vn,vn,Ln]+"\\)$"),Pn=new RegExp("^rgba\\("+[dn,dn,dn,Ln]+"\\)$"),Un=new RegExp("^hsl\\("+[Ln,dn,dn]+"\\)$"),En=new RegExp("^hsla\\("+[Ln,dn,dn,Ln]+"\\)$"),Dn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ge(Ue,Ur,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:tr,formatHex:tr,formatHsl:Ei,formatRgb:fi,toString:fi});function tr(){return this.rgb().formatHex()}function Ei(){return Zr(this).formatHsl()}function fi(){return this.rgb().formatRgb()}function Ur(a){var i,s;return a=(a+"").trim().toLowerCase(),(i=Sn.exec(a))?(s=i[1].length,i=parseInt(i[1],16),s===6?wi(i):s===3?new be(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):s===8?Di(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):s===4?Di(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=On.exec(a))?new be(i[1],i[2],i[3],1):(i=un.exec(a))?new be(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=zn.exec(a))?Di(i[1],i[2],i[3],i[4]):(i=Pn.exec(a))?Di(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Un.exec(a))?Zn(i[1],i[2]/100,i[3]/100,1):(i=En.exec(a))?Zn(i[1],i[2]/100,i[3]/100,i[4]):Dn.hasOwnProperty(a)?wi(Dn[a]):a==="transparent"?new be(NaN,NaN,NaN,0):null}function wi(a){return new be(a>>16&255,a>>8&255,a&255,1)}function Di(a,i,s,f){return f<=0&&(a=i=s=NaN),new be(a,i,s,f)}function kt(a){return a instanceof Ue||(a=Ur(a)),a?(a=a.rgb(),new be(a.r,a.g,a.b,a.opacity)):new be}function Yt(a,i,s,f){return arguments.length===1?kt(a):new be(a,i,s,f==null?1:f)}function be(a,i,s,f){this.r=+a,this.g=+i,this.b=+s,this.opacity=+f}ge(be,Yt,ve(Ue,{brighter:function(a){return a=a==null?hn:Math.pow(hn,a),new be(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=a==null?He:Math.pow(He,a),new be(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xe,formatHex:Xe,formatRgb:fn,toString:fn}));function Xe(){return"#"+Tn(this.r)+Tn(this.g)+Tn(this.b)}function fn(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(a===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(a===1?")":", "+a+")")}function Tn(a){return a=Math.max(0,Math.min(255,Math.round(a)||0)),(a<16?"0":"")+a.toString(16)}function Zn(a,i,s,f){return f<=0?a=i=s=NaN:s<=0||s>=1?a=i=NaN:i<=0&&(a=NaN),new xr(a,i,s,f)}function Zr(a){if(a instanceof xr)return new xr(a.h,a.s,a.l,a.opacity);if(a instanceof Ue||(a=Ur(a)),!a)return new xr;if(a instanceof xr)return a;a=a.rgb();var i=a.r/255,s=a.g/255,f=a.b/255,g=Math.min(i,s,f),y=Math.max(i,s,f),_=NaN,O=y-g,A=(y+g)/2;return O?(i===y?_=(s-f)/O+(s<f)*6:s===y?_=(f-i)/O+2:_=(i-s)/O+4,O/=A<.5?y+g:2-y-g,_*=60):O=A>0&&A<1?0:_,new xr(_,O,A,a.opacity)}function ei(a,i,s,f){return arguments.length===1?Zr(a):new xr(a,i,s,f==null?1:f)}function xr(a,i,s,f){this.h=+a,this.s=+i,this.l=+s,this.opacity=+f}ge(xr,ei,ve(Ue,{brighter:function(a){return a=a==null?hn:Math.pow(hn,a),new xr(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=a==null?He:Math.pow(He,a),new xr(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+(this.h<0)*360,i=isNaN(a)||isNaN(this.s)?0:this.s,s=this.l,f=s+(s<.5?s:1-s)*i,g=2*s-f;return new be(ii(a>=240?a-240:a+120,g,f),ii(a,g,f),ii(a<120?a+240:a-120,g,f),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(a===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(a===1?")":", "+a+")")}}));function ii(a,i,s){return(a<60?i+(s-i)*a/60:a<180?s:a<240?i+(s-i)*(240-a)/60:i)*255}function tL(a){return typeof a=="string"?!!d3.color(a):!1}function Lr(a){const i=Ur(a),s=[0,0,0,0];return i!=null&&(s[0]=i.r/255,s[1]=i.g/255,s[2]=i.b/255,s[3]=i.opacity),s}function Os(a){const i=a&&a[0],s=a&&a[1],f=a&&a[2];return i+s*256+f*65536-1}function _c(a){return[a+1&255,a+1>>8&255,a+1>>8>>8&255]}function bm(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");i.width=256,i.height=1;let f=null;const g=s.createLinearGradient(0,0,256,1),y=a.positions[0],_=a.positions[a.positions.length-1];for(let O=0;O<a.colors.length;++O){const A=(a.positions[O]-y)/(_-y);g.addColorStop(A,a.colors[O])}return s.fillStyle=g,s.fillRect(0,0,256,1),f=new Uint8ClampedArray(s.getImageData(0,0,256,1).data),i=null,s=null,{data:f,width:256,height:1}}function gO(a,i){let s=window.document.createElement("canvas"),f=s.getContext("2d");s.width=256,s.height=1;const g=f.createLinearGradient(0,0,256,1),y=i[1]-i[0];for(let A=0;A<a.colors.length;++A){const P=Math.max((a.positions[A]-i[0])/y,0);g.addColorStop(P,a.colors[A])}f.fillStyle=g,f.fillRect(0,0,256,1);const _=f.getImageData(0,0,256,1).data,O=Nh(f,_);return s=null,f=null,O}function vO(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");i.width=256,i.height=1;const f=s.createImageData(256,1);return f.data.fill(0),a.positions.forEach((g,y)=>{const _=Lr(a.colors[y]);f.data[g*4+0]=_[0]*255,f.data[g*4+1]=_[1]*255,f.data[g*4+2]=_[2]*255,f.data[g*4+3]=_[3]*255}),i=null,s=null,f}function mO(a){let i=window.document.createElement("canvas"),s=i.getContext("2d");s.globalAlpha=1,i.width=256,i.height=1;const f=256/a.colors.length;for(let _=0;_<a.colors.length;_++)s.beginPath(),s.lineWidth=2,s.strokeStyle=a.colors[_],s.moveTo(_*f,0),s.lineTo((_+1)*f,0),s.stroke();const g=s.getImageData(0,0,256,1).data,y=Nh(s,g);return i=null,s=null,y}function yO(a,i){let s=window.document.createElement("canvas"),f=s.getContext("2d");f.globalAlpha=1,s.width=256,s.height=1;const g=i[1]-i[0];a.positions.length-a.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let O=0;O<a.colors.length;O++)f.beginPath(),f.lineWidth=2,f.strokeStyle=a.colors[O],f.moveTo((a.positions[O]-i[0])/g*255,0),f.lineTo((a.positions[O+1]-i[0])/g*255,0),f.stroke();const y=f.getImageData(0,0,256,1).data,_=Nh(f,y);return s=null,f=null,_}function Nh(a,i){const s=a.createImageData(256,1);for(let f=0;f<s.data.length;f+=4)s.data[f+0]=i[f+0],s.data[f+1]=i[f+1],s.data[f+2]=i[f+2],s.data[f+3]=i[f+3];return s}function Bh(a){switch(a==null?void 0:a.type){case"cat":return[0,255];default:return[0,1]}}var _m=k(74691),bO=k.n(_m),_O=k(50361),jh=k.n(_O),xm=k(23279),gf=k.n(xm),Sm=k(27361),Om=k.n(Sm),zh=k(51584),Em=k.n(zh),Uh=k(18446),wm=k.n(Uh),Zh=k(14293),Am=k.n(Zh),Hh=k(81763),Tm=k.n(Hh),Vh=k(68630),Cm=k.n(Vh),Mm=k(47037),Lm=k.n(Mm),Pm=k(36719),Im=k.n(Pm),Rm=k(82492),Wh=k.n(Rm),km=k(30236),Dm=k.n(km),Fm=k(97019),Nm=k.n(Fm),Bm=k(23493),jm=k.n(Bm),xc=k(44908),xO=k.n(xc),SO=k(11700),eL=k.n(SO),zm=k(23560),Um=k.n(zm),OO=k(13218),EO=k.n(OO),wO=k(52353),AO=k.n(wO),TO=k(68929),CO=k.n(TO),MO=k(73955),LO=k.n(MO),Nr={isNil:Am(),merge:Wh(),throttle:jm(),isString:Lm(),debounce:gf(),pull:Nm(),isTypedArray:Im(),isPlainObject:Cm(),isNumber:Tm(),isBoolean:Em(),isEqual:wm(),cloneDeep:jh(),uniq:xO(),clamp:bO(),upperFirst:eL(),get:Om(),mergeWith:Dm(),isFunction:Um(),isObject:EO(),isUndefined:AO(),camelCase:CO(),uniqueId:LO()},{pull:PO}=Nr;function IO(a){let i=a;return typeof a=="string"&&(i=window.document.getElementById(a)),i}function Zm(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Hm(a){return Zm(a).split(/\s+/)}function RO(a){var i;const s=(i=document==null?void 0:document.documentElement)==null?void 0:i.style;if(!s)return a[0];for(const f in a)if(a[f]&&a[f]in s)return a[f];return a[0]}function Fi(a,i,s){const f=window.document.createElement(a);return i&&(f.className=i||""),s&&s.appendChild(f),f}function wa(a){const i=a.parentNode;i&&i.removeChild(a)}function Co(a,i){if(a.classList!==void 0){const s=Hm(i);for(let f=0,g=s.length;f<g;f++)a.classList.add(s[f])}else if(!Wa(a,i)){const s=ta(a);Vm(a,(s?s+" ":"")+i)}}function Sc(a,i){a.classList!==void 0?Hm(i).forEach(f=>{a.classList.remove(f)}):Vm(a,Zm((" "+ta(a)+" ").replace(" "+i+" "," ")))}function Wa(a,i){if(a.classList!==void 0)return a.classList.contains(i);const s=ta(a);return s.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(s)}function Vm(a,i){a instanceof HTMLElement?a.className=i:a.className.baseVal=i}function Gh(a,i,s){s===void 0?Wa(a,i)?Sc(a,i):Co(a,i):s?Co(a,i):Sc(a,i)}function ta(a){return a instanceof SVGElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function kO(a){for(;a&&a.firstChild;)a.removeChild(a.firstChild)}var DO=RO(["transform","WebkitTransform"]);function Yh(a,i){a.style[DO]=i}function nL(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const a=window.document.createEvent("UIEvents");a.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(a)}}function FO(a){const i=["padding: "+(a.height/2-8)+"px "+a.width/2+"px;","line-height: "+a.height+"px;","background-image: url("+a.toDataURL()+");"];console.log(`%c
`,i.join(""))}function Wm(){var a;const i=window.document.querySelector('meta[name="viewport"]');if(!i)return 1;const f=((a=i.content)==null?void 0:a.split(",")).find(g=>{const[y]=g.split("=");return y==="initial-scale"});return f?f.split("=")[1]*1:1}var so=Wm()<1?1:window.devicePixelRatio;function Gm(a,i){a.setAttribute("style",`${a.style.cssText}${i}`)}function Ym(a){return a.split(";").map(i=>i.trim()).filter(i=>i)}function rL(a,i){var s;const f=Ym((s=a.getAttribute("style"))!=null?s:""),g=Ym(i),y=PO(f,...g);a.setAttribute("style",y.join(";"))}function NO(a){return Object.entries(a).map(([i,s])=>`${i}: ${s}`).join(";")}function BO(a,i){return{left:a.left-i.left,top:a.top-i.top,right:i.left+i.width-a.left-a.width,bottom:i.top+i.height-a.top-a.height}}function iL(a,i){a.checked=i,i?a.setAttribute("checked","true"):a.removeAttribute("checked")}function $h(a){a.innerHTML=""}function jO(a){a.setAttribute("draggable","false")}function $m(a,i){if(typeof i=="string"){const s=document.createElement("div");for(s.innerHTML=i;s.firstChild;)a.append(s.firstChild)}else Array.isArray(i)?a.append(...i):a.append(i)}function zO(a,i){var s;const f=Array.isArray(i)?i:[i];let g=a;for(;g instanceof Element&&g!==window.document.body;){if(f.find(y=>g==null?void 0:g.matches(y)))return g;g=(s=g==null?void 0:g.parentElement)!=null?s:null}}function Ga(a){return typeof ImageBitmap!="undefined"&&a instanceof ImageBitmap}function vf(){return typeof importScripts=="function"}var UO=vf()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,wl=navigator==null?void 0:navigator.userAgent,ZO=!!wl.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Xm=wl.indexOf("Android")>-1||wl.indexOf("Adr")>-1;function oL(){const a=wl,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let s=!0;for(const f of i)if(a.indexOf(f)>0){s=!1;break}return s}function aL(a,i){a.forEach(s=>{i[s]&&(i[s]=i[s].bind(i))})}var QR=class{constructor(a=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=a}run(a){const i=new Date().getTime(),s=i-this.timestamp;this.timestamp=i,s>=this.duration&&a()}};function qm(a){var i=[1/0,1/0,-1/0,-1/0];return re(a,function(s){i[0]>s[0]&&(i[0]=s[0]),i[1]>s[1]&&(i[1]=s[1]),i[2]<s[0]&&(i[2]=s[0]),i[3]<s[1]&&(i[3]=s[1])}),i}qm.default=qm;var sL=qm;function Km(a){return typeof a=="number"}function Ai(a){return a-Math.fround(a)}var Xh=2*Math.PI*6378137/2;function cL(a,i){const[s,f,g,y]=i;return a.lng>s&&a.lng<=g&&a.lat>f&&a.lat<=y}function HO(a){const i=[1/0,1/0,-1/0,-1/0];return a.forEach(s=>{const{coordinates:f}=s;Qm(i,f)}),i}function Qm(a,i){return Array.isArray(i[0])?i.forEach(s=>{Qm(a,s)}):(a[0]>i[0]&&(a[0]=i[0]),a[1]>i[1]&&(a[1]=i[1]),a[2]<i[0]&&(a[2]=i[0]),a[3]<i[1]&&(a[3]=i[1])),a}function lL(a,i){return Jm(a,i)}function Jm(a,i){return Array.isArray(a[0])?a.map(s=>Jm(s,i)):i(a)}function mf(a,i=!0,s={enable:!0,decimal:1}){a=GO(a,i);const f=a[0],g=a[1];let y=f*Xh/180,_=Math.log(Math.tan((90+g)*Math.PI/360))/(Math.PI/180);return _=_*Xh/180,s.enable&&(y=Number(y.toFixed(s.decimal)),_=Number(_.toFixed(s.decimal))),a.length===3?[y,_,a[2]]:[y,_]}function uL(a,i=6){const s=a[0],f=a[1];let g=s/Xh*180,y=f/Xh*180;return y=180/Math.PI*(2*Math.atan(Math.exp(y*Math.PI/180))-Math.PI/2),i!=null&&(g=Number(g.toFixed(i)),y=Number(y.toFixed(i))),a.length===3?[g,y,a[2]]:[g,y]}function VO(a){if(a==null)throw new Error("lng is required");return(a>180||a<-180)&&(a=a%360,a>180&&(a=-360+a),a<-180&&(a=360+a),a===0&&(a=0)),a}function WO(a){if(a==null)throw new Error("lat is required");return(a>90||a<-90)&&(a=a%180,a>90&&(a=-180+a),a<-90&&(a=180+a),a===0&&(a=0)),a}function GO(a,i){if(i===!1)return a;const s=VO(a[0]);let f=WO(a[1]);return f>85&&(f=85),f<-85&&(f=-85),a.length===3?[s,f,a[2]]:[s,f]}function Mo(a){const i=85.0511287798,s=Math.max(Math.min(i,a[1]),-i),f=256<<20;let g=Math.PI/180,y=a[0]*g,_=s*g;_=Math.log(Math.tan(Math.PI/4+_/2));const O=.5/Math.PI,A=.5,P=-.5/Math.PI;return g=.5,y=f*(O*y+A),_=f*(P*_+g),[Math.floor(y),Math.floor(_)]}function fL(a){const i=.5/Math.PI,s=.5,f=-.5/Math.PI;let g=.5;const y=256<<20;let[_,O]=a;_=(_/y-s)/i,O=(O/y-g)/f,O=(Math.atan(Math.pow(Math.E,O))-Math.PI/4)*2,g=Math.PI/180;const A=O/g;return[_/g,A]}function YO(a,i){const s=85.0511287798,f=Math.PI/180,g=6378137;return i=Math.max(Math.min(s,i),-s),a*=f,i*=f,i=Math.log(Math.tan(Math.PI/4+i/2)),[a*g,i*g]}function dL(a,i){const s=Math.PI/180,f=6378137,g=a/f/s,y=2*(Math.atan(Math.exp(i/f))-Math.PI/4)/s;return[g,y]}function hL(a,i,s){const f=degreesToRadians(i[1]-a[1]),g=degreesToRadians(i[0]-a[0]),y=degreesToRadians(a[1]),_=degreesToRadians(i[1]),O=Math.pow(Math.sin(f/2),2)+Math.pow(Math.sin(g/2),2)*Math.cos(y)*Math.cos(_);return radiansToLength(2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O)),s="meters")}function $O(a){const i=Math.PI/180,s=85.0511287798,f=6378137,g=Math.max(Math.min(s,a[1]),-s),y=Math.sin(g*i),_=f*a[0]*i,O=f*Math.log((1+y)/(1-y))/2;return[_,O]}function qh(a,i){const s=Math.abs(a[1][1]-a[0][1])*i,f=Math.abs(a[1][0]-a[0][0])*i;return[[a[0][0]-f,a[0][1]-s],[a[1][0]+f,a[1][1]+s]]}function Kh(a,i){return a[0][0]<=i[0][0]&&a[0][1]<=i[0][1]&&a[1][0]>=i[1][0]&&a[1][1]>=i[1][1]}function mi(a){return[[a[0],a[1]],[a[2],a[3]]]}function XO(a){const i=yf(a,[0,0]);return[a[0]/i,a[1]/i]}function yf(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}function qO(a,i){return a[0]*i[0]+a[1]*i[1]}function ty(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Ya(a,i){return Math.acos(qO(a,i)/(ty(a)*ty(i)))*180/Math.PI}function KO(a,i){return i[0]>0?i[1]>0?90-Math.atan(i[1]/i[0])*180/Math.PI:90+Math.atan(-i[1]/i[0])*180/Math.PI:i[1]<0?180+(90-Math.atan(i[1]/i[0])*180/Math.PI):270+Math.atan(i[1]/-i[0])*180/Math.PI}function pL(a,i=100){if(!a||a.length<2)return;const s=[0,1];let f=0;const g=[];for(let y=0;y<a.length-1;y++){const _=a[y],O=a[y+1],A=yf(_,O);f+=A;const P=[_[0]-O[0],_[1]-O[1]];let B=KO(s,P);if(y>0){const U=g[y-1].rotation;U-B>360-U+B&&(B=B+360)}g.push({start:_,end:O,dis:A,rotation:B,duration:0})}return g.map(y=>{y.duration=i*(y.dis/f)}),g}function $a(a){if(Km(a[0]))return a;if(Km(a[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Km(a[0][0][0])){const i=a;let s=0,f=0,g=0;return i.forEach(y=>{y.forEach(_=>{s+=_[0],f+=_[1],g++})}),[s/g,f/g,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function QO(a){let i=a[0],s=a[1],f=a[0],g=a[1],y=0,_=0,O=0;for(let A=0;A<a.length;A+=2){const P=a[A],B=a[A+1];P&&B&&(i=Math.max(P,i),s=Math.max(B,s),f=Math.min(P,f),g=Math.min(B,g),y+=P,_+=B,O++)}return{center:[y/O,_/O],radius:Math.sqrt(Math.pow(i-f,2)+Math.pow(s-g,2))/2}}function en(a){return sL(Tt([Dt(a)]))}function gL(a){let f=0;a+="x";const g=Math.floor(9007199254740991/137);for(let y=0;y<a.length;y++)f>g&&(f=Math.floor(f/137)),f=f*131+a.charCodeAt(y);return f}function JR(a){a=a.toString();let i=5381,s=a.length;for(;s;)i=i*33^a.charCodeAt(--s);return i>>>0}function Qh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const i=Math.random()*16|0;return(a==="x"?i:i&3|8).toString(16)})}function JO(a,i,s,f,g=30,y){let _=s;return y&&(_=Math.round(s*(g-1))/(g-1)),f?Gr(a,i,_,f):Gr(a,i,_,.314)}function Jh(a,i){const s=1-i;return(a[0]*s+a[1]*i)*s+(a[1]*s+a[2]*i)*i}function ey(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}function Al(a,i,s){const f=[i[0]-a[0],i[1]-a[1]],g=ey(f,[0,0]),y=Math.atan2(f[1],f[0]),_=g/2/Math.cos(s),O=y+s;return[_*Math.cos(O)+a[0],_*Math.sin(O)+a[1]]}function Gr(a,i,s,f){const g=Al(a,i,f),y=[a[0],g[0],i[0]],_=[a[1],g[1],i[1]];return[Jh(y,s),Jh(_,s),0]}function tp(a,i,s,f,g=30,y){let _=s;return y&&(_=Math.round(s*29)/29),vL(a,i,_)}function ny(a,i){const s=[a[0]-i[0],a[1]-i[1]],f=[Math.sin(s[0]/2),Math.sin(s[1]/2)],g=f[1]*f[1]+Math.cos(a[1])*Math.cos(i[1])*f[0]*f[0];return 2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))}function vL(a,i,s){const f=[degreesToRadians(a[0]),degreesToRadians(a[1])],g=[degreesToRadians(i[0]),degreesToRadians(i[1])],y=ny(f,g);if(Math.abs(y-Math.PI)<.001)return[(1-s)*f[0]+s*g[0],(1-s)*f[1]+s*g[1]];const _=Math.sin((1-s)*y)/Math.sin(y),O=Math.sin(s*y)/Math.sin(y),A=[Math.sin(f[0]),Math.sin(f[1])],P=[Math.cos(f[0]),Math.cos(f[1])],B=[Math.sin(g[0]),Math.sin(g[1])],U=[Math.cos(g[0]),Math.cos(g[1])],G=_*P[1]*P[0]+O*U[1]*U[0],vt=_*P[1]*A[0]+O*U[1]*B[0],$t=_*A[1]+O*B[1];return[radiansToDegrees(Math.atan2(vt,G)),radiansToDegrees(Math.atan2($t,Math.sqrt(G*G+vt*vt)))]}function tk(a,i){let s=0;const f=[];for(let O=0;O<a.length-1;O++){const A=a[O],P=a[O+1],B=bf(A,P),U=s;s+=B,f.push({p1:A,p2:P,totalDistance:s,distance:B,lastTotalDistance:U})}const g=s*i;let y,_;for(const O of f)if(O.totalDistance>g){const P=O.p1,B=O.p2,U=(g-O.lastTotalDistance)/O.distance,G=ep(B,P,U);y=G[0],_=G[1];break}return{lng:y,lat:_,height:0}}function ep(a,i,s){return[a[0]*s+i[0]*(1-s),a[1]*s+i[1]*(1-s)]}function bf(a,i){return Math.sqrt(Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2))}var mL=Object.defineProperty,tE=Object.getOwnPropertySymbols,ry=Object.prototype.hasOwnProperty,Oc=Object.prototype.propertyIsEnumerable,np=(a,i,s)=>i in a?mL(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,iy=(a,i)=>{for(var s in i||(i={}))ry.call(i,s)&&np(a,s,i[s]);if(tE)for(var s of tE(i))Oc.call(i,s)&&np(a,s,i[s]);return a};function rp(a,i){const{featureId:s}=i;let f=a.data.dataArray;return typeof s=="number"&&(f=f.filter(({id:g})=>g===s)),f.map(g=>{const y=Es(g,i);return iy(iy({},g),y)})}function yL(a,i){return new Promise(s=>{a.inited?s(rp(a,i)):a.once("update",()=>{s(rp(a,i))})})}function Es(a,i){const{offset:s,shape:f,thetaOffset:g,segmentNumber:y=30,autoFit:_=!0}=i,{coordinates:O}=a;if(f==="line")return pathLineAtOffset(O,s);const A=O[0],P=O[1],B=typeof g=="string"?a[g]||0:g;let U;switch(f){case"arc":U=arcLineAtOffset;break;case"greatcircle":U=greatCircleLineAtOffset;break;default:U=arcLineAtOffset}const[G,vt,$t]=U(A,P,s,B,y,_);return{lng:G,lat:vt,height:$t}}var ip=class{constructor(a=50,i){this.limit=a,this.destroy=i||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(a=>{this.delete(a)}),this.cache={},this.order=[]}get(a){const i=this.cache[a];return i&&(this.deleteOrder(a),this.appendOrder(a)),i}set(a,i){this.cache[a]?(this.delete(a),this.cache[a]=i,this.appendOrder(a)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[a]=i,this.appendOrder(a))}delete(a){const i=this.cache[a];i&&(this.deleteCache(a),this.deleteOrder(a),this.destroy(i,a))}deleteCache(a){delete this.cache[a]}deleteOrder(a){const i=this.order.findIndex(s=>s===a);i>=0&&this.order.splice(i,1)}appendOrder(a){this.order.push(a)}defaultDestroy(a,i){return null}};function eE(a){if(a.length===0)throw new Error("max requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]>i&&(i=a[s]);return i*1}function op(a){if(a.length===0)throw new Error("min requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]<i&&(i=a[s]);return i*1}function ws(a){if(a.length===0)return 0;let i=a[0]*1;for(let s=1;s<a.length;s++)i+=a[s]*1;return i}function ap(a){if(a.length===0)throw new Error("mean requires at least one data point");return ws(a)/a.length}function Hr(a){if(a.length===0)throw new Error("mean requires at least one data point");if(a.length<3)return a[0];a.sort();let i=a[0],s=NaN,f=0,g=1;for(let y=1;y<a.length+1;y++)a[y]!==i?(g>f&&(f=g,s=i),g=1,i=a[y]):g++;return s*1}var oy={min:op,max:eE,mean:ap,sum:ws,mode:Hr};function ay(a,i){return a.map(s=>s[i])}function bL(a,i){return oy[a](i)}function bn(a,i){i===void 0&&(i={});var s=Number(a[0]),f=Number(a[1]),g=Number(a[2]),y=Number(a[3]);if(a.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var _=[s,f],O=[s,y],A=[g,y],P=[g,f];return ot([[_,P,A,O,_]],i.properties,{bbox:a,id:i.id})}var no=k(26729),sy=k.n(no),Tl=(a=>(a.Realtime="realtime",a.Overlap="overlap",a.Replace="replace",a))(Tl||{}),co=(a=>(a.Loading="Loading",a.Loaded="Loaded",a.Failure="Failure",a.Cancelled="Cancelled",a))(co||{}),sp=0,As=1,Lo=2;function cy(a){a.forEach(i=>{i.isCurrent&&(i.isVisible=i.isLoaded)})}function Wn(a){a.forEach(i=>{i.properties.state=sp}),a.forEach(i=>{i.isCurrent&&!Sr(i)&&cp(i)}),a.forEach(i=>{i.isVisible=!!(i.properties.state&Lo)})}function di(a){a.forEach(s=>{s.properties.state=sp}),a.forEach(s=>{s.isCurrent&&Sr(s)}),a.slice().sort((s,f)=>s.z-f.z).forEach(s=>{s.isVisible=!!(s.properties.state&Lo),s.children.length&&(s.isVisible||s.properties.state&As)?s.children.forEach(f=>{f.properties.state=As}):s.isCurrent&&cp(s)})}function Sr(a){for(;a;){if(a.isLoaded)return a.properties.state|=Lo,!0;a=a.parent}return!1}function cp(a){a.children.forEach(i=>{i.isLoaded?i.properties.state|=Lo:cp(i)})}var Ts=256,ly=[-1/0,-1/0,1/0,1/0],_f=.2,nE=5,rE={[Tl.Realtime]:cy,[Tl.Overlap]:Wn,[Tl.Replace]:di},iE=()=>{};function lp(a,i,s){const f=Math.floor((a+180)/360*Math.pow(2,s)),g=Math.floor((1-Math.log(Math.tan(i*Math.PI/180)+1/Math.cos(i*Math.PI/180))/Math.PI)/2*Math.pow(2,s));return[f,g]}function xf(a,i,s){const f=a/Math.pow(2,s)*360-180,g=Math.PI-2*Math.PI*i/Math.pow(2,s),y=180/Math.PI*Math.atan(.5*(Math.exp(g)-Math.exp(-g)));return[f,y]}var Sf=(a,i,s)=>{const[f,g]=xf(a,i,s),[y,_]=xf(a+1,i+1,s);return[f,_,y,g]};function oE({zoom:a,latLonBounds:i,maxZoom:s=1/0,minZoom:f=0,zoomOffset:g=0,extent:y=ly}){let _=Math.ceil(a)+g;if(Number.isFinite(f)&&_<f)return[];Number.isFinite(s)&&_>s&&(_=s);const[O,A,P,B]=i,U=[Math.max(O,y[0]),Math.max(A,y[1]),Math.min(P,y[2]),Math.min(B,y[3])],G=[],[vt,$t]=lp(U[0],U[1],_),[te,Te]=lp(U[2],U[3],_);for(let Qe=vt;Qe<=te;Qe++)for(let ln=Te;ln<=$t;ln++)G.push({x:Qe,y:ln,z:_});const Fe=(te+vt)/2,Ze=($t+Te)/2,je=(Qe,ln)=>Math.abs(Qe-Fe)+Math.abs(ln-Ze);return G.sort((Qe,ln)=>je(Qe.x,Qe.y)-je(ln.x,ln.y)),G}var uy=(a,i,s,f=!0)=>{const g=Math.pow(2,s),y=g-1,_=g;let O=a;const A=i;return f&&(O<0?O=O+_:O>y&&(O=O%_)),{warpX:O,warpY:A}},aE=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),fy=class extends no.EventEmitter{constructor(a){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:i,y:s,z:f,tileSize:g,warp:y=!0}=a;this.x=i,this.y=s,this.z=f,this.warp=y||!0,this.tileSize=g}get isLoading(){return this.loadStatus===co.Loading}get isLoaded(){return this.loadStatus===co.Loaded}get isFailure(){return this.loadStatus===co.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===co.Cancelled}get isDone(){return[co.Loaded,co.Cancelled,co.Failure].includes(this.loadStatus)}get bounds(){return Sf(this.x,this.y,this.z)}get bboxPolygon(){const[a,i,s,f]=this.bounds,g=[(s-a)/2,(f-i)/2];return bn(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:g,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(a){return aE(this,arguments,function*({getData:i,onLoad:s,onError:f}){this.loadDataId++;const g=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=co.Loading;let y=null,_;try{const{x:O,y:A,z:P,bounds:B,tileSize:U,warp:G}=this,{warpX:vt,warpY:$t}=uy(O,A,P,G),{signal:te}=this.abortController;y=yield i({x:vt,y:$t,z:P,bounds:B,tileSize:U,signal:te,warp:G},this)}catch(O){_=O}if(g===this.loadDataId&&!(this.isCancelled&&!y)){if(_||!y){this.loadStatus=co.Failure,f(_,this);return}this.loadStatus=co.Loaded,this.data=y,s(this)}})}reloadData(a){this.isLoading&&this.abortLoad(),this.loadData(a)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=co.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},dy=(a,i)=>{const s=mi(a),f=qh(s,i),g=360*3-180,y=85.0511287798065;return[Math.max(f[0][0],-g),Math.max(f[0][1],-y),Math.min(f[1][0],g),Math.min(f[1][1],y)]},hy=(a,i)=>{const s=mi(a),f=mi(i);return Kh(s,f)},py=Object.defineProperty,gy=Object.defineProperties,sE=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,Xa=Object.prototype.hasOwnProperty,cE=Object.prototype.propertyIsEnumerable,vy=(a,i,s)=>i in a?py(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Ho=(a,i)=>{for(var s in i||(i={}))Xa.call(i,s)&&vy(a,s,i[s]);if(Cl)for(var s of Cl(i))cE.call(i,s)&&vy(a,s,i[s]);return a},Cs=(a,i)=>gy(a,sE(i)),{throttle:_L}=Nr,lE=(a=>(a.TilesLoadStart="tiles-load-start",a.TileLoaded="tile-loaded",a.TileError="tile-error",a.TileUnload="tile-unload",a.TileUpdate="tile-update",a.TilesLoadFinished="tiles-load-finished",a))(lE||{}),yy=class extends sy(){constructor(a){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=_L((i,s)=>{this.update(i,s)},16),this.onTileLoad=i=>{this.emit("tile-loaded",i),this.updateTileVisible(),this.loadFinished()},this.onTileError=(i,s)=>{this.emit("tile-error",{error:i,tile:s}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=i=>{this.emit("tile-unload",i),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:ly,getTileData:iE,warp:!0,updateStrategy:Tl.Replace},this.updateOptions(a)}get isLoaded(){return this.currentTiles.every(a=>a.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((i,s)=>i.z-s.z)}updateOptions(a){const i=a.minZoom===void 0?this.options.minZoom:Math.ceil(a.minZoom),s=a.maxZoom===void 0?this.options.maxZoom:Math.floor(a.maxZoom);this.options=Cs(Ho(Ho({},this.options),a),{minZoom:i,maxZoom:s})}update(a,i){const s=Math.max(0,Math.ceil(a));if(this.lastViewStates&&this.lastViewStates.zoom===s&&hy(this.lastViewStates.latLonBoundsBuffer,i))return;const f=dy(i,_f);this.lastViewStates={zoom:s,latLonBounds:i,latLonBoundsBuffer:f},this.currentZoom=s;let g=!1;const y=this.getTileIndices(s,f).filter(_=>this.options.warp||_.x>=0&&_.x<Math.pow(2,s));this.emit("tiles-load-start"),this.currentTiles=y.map(({x:_,y:O,z:A})=>{let P=this.getTile(_,O,A);return P?(((P==null?void 0:P.isFailure)||(P==null?void 0:P.isCancelled))&&P.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),P):(P=this.createTile(_,O,A),g=!0,P)}),g&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[a,i]of this.cacheTiles){if(!this.currentTiles.includes(i)){this.cacheTiles.delete(a),this.onTileUnload(i);return}this.onTileUnload(i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(a,i,s){const f=this.cacheTiles.get(`${i},${s},${a}`);f&&(this.onTileUnload(f),f.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(a,i,s){const f=this.getTileByLngLat(a,i,s);f&&this.reloadTileById(f.z,f.x,f.y)}reloadTileByExtent(a,i){this.getTileIndices(i,a).forEach(f=>{this.reloadTileById(f.z,f.x,f.y)})}pruneRequests(){const a=[];for(const i of this.cacheTiles.values())i.isLoading&&!i.isCurrent&&!i.isVisible&&a.push(i);for(;a.length>0;)a.shift().abortLoad()}getTileByLngLat(a,i,s){const{zoomOffset:f}=this.options,g=Math.ceil(s)+f,y=lp(a,i,g);return this.tiles.filter(O=>O.key===`${y[0]}_${y[1]}_${g}`)[0]}getTileExtent(a,i){return this.getTileIndices(i,a)}getTileByZXY(a,i,s){return this.tiles.filter(g=>g.key===`${i}_${s}_${a}`)[0]}clear(){for(const a of this.cacheTiles.values())a.isLoading?a.abortLoad():this.onTileUnload(a);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const a=this.options.updateStrategy,i=new Map;for(const g of this.cacheTiles.values())i.set(g.key,g.isVisible),g.isCurrent=!1,g.isVisible=!1;for(const g of this.currentTiles)g.isCurrent=!0,g.isVisible=!0;const s=Array.from(this.cacheTiles.values());typeof a=="function"?a(s):rE[a](s);let f=!1;Array.from(this.cacheTiles.values()).forEach(g=>{g.isVisible!==i.get(g.key)?(g.isVisibleChange=!0,f=!0):g.isVisibleChange=!1}),f&&this.emit("tile-update")}getTileIndices(a,i){const{tileSize:s,extent:f,zoomOffset:g}=this.options,y=Math.floor(this.options.maxZoom),_=Math.ceil(this.options.minZoom);return oE({maxZoom:y,minZoom:_,zoomOffset:g,tileSize:s,zoom:a,latLonBounds:i,extent:f})}getTileId(a,i,s){return`${a},${i},${s}`}loadFinished(){const a=!this.currentTiles.some(i=>!i.isDone);return a&&this.emit("tiles-load-finished"),a}getTile(a,i,s){const f=this.getTileId(a,i,s);return this.cacheTiles.get(f)}createTile(a,i,s){const f=this.getTileId(a,i,s),g=new fy({x:a,y:i,z:s,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(f,g),g.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),g}resizeCacheTiles(){const a=nE*this.currentTiles.length;if(this.cacheTiles.size>a){for(const[s,f]of this.cacheTiles)if(!f.isVisible&&!this.currentTiles.includes(f)&&(this.cacheTiles.delete(s),this.onTileUnload(f)),this.cacheTiles.size<=a)break}this.rebuildTileTree()}rebuildTileTree(){for(const a of this.cacheTiles.values())a.parent=null,a.children.length=0;for(const a of this.cacheTiles.values()){const i=this.getNearestAncestor(a.x,a.y,a.z);a.parent=i,i!=null&&i.children&&i.children.push(a)}}getNearestAncestor(a,i,s){for(;s>this.options.minZoom;){a=Math.floor(a/2),i=Math.floor(i/2),s=s-1;const f=this.getTile(a,i,s);if(f)return f}return null}};function ek(a){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(a)}function by(a){const i=[];let s=/\{([a-z])-([a-z])\}/.exec(a);if(s){const f=s[1].charCodeAt(0),g=s[2].charCodeAt(0);let y;for(y=f;y<=g;++y)i.push(a.replace(s[0],String.fromCharCode(y)));return i}if(s=/\{(\d+)-(\d+)\}/.exec(a),s){const f=parseInt(s[2],10);for(let g=parseInt(s[1],10);g<=f;g++)i.push(a.replace(s[0],g.toString()));return i}return i.push(a),i}function Ms(a,i){if(!a||!a.length)throw new Error("url is not allowed to be empty");const{x:s,y:f,z:g}=i,y=by(a),_=Math.abs(s+f)%y.length;return(zr(y[_])?`${y[_]}/{z}/{x}/{y}`:y[_]).replace(/\{x\}/g,s.toString()).replace(/\{y\}/g,f.toString()).replace(/\{z\}/g,g.toString()).replace(/\{bbox\}/g,Sf(s,f,g).join(",")).replace(/\{-y\}/g,(Math.pow(2,g)-f-1).toString())}function _y(a,i){const{x:s,y:f,z:g,layer:y,version:_="1.0.0",style:O="default",format:A,service:P="WMTS",tileMatrixset:B}=i,U=by(a),G=Math.abs(s+f)%U.length;return`${U[G]}&SERVICE=${P}&REQUEST=GetTile&VERSION=${_}&LAYER=${y}&STYLE=${O}&TILEMATRIXSET=${B}&FORMAT=${A}&TILECOL=${s}&TILEROW=${f}&TILEMATRIX=${g}`}function Ml(a,i){return a==null?i:a}var uE=k(38163),Ec=k.n(uE);function up(a,i){return a.map(s=>s[i]*1)}function xy(a){return a===void 0?!1:!Array.isArray(a)&&a.data!==void 0}function Vo(a){return Array.isArray(a)?a.length===0?!1:!!xy(a[0]):!1}function Or(a){return Array.isArray(a)?a.length===0||typeof a[0]=="number":!1}function Sy(a){const i=Object.isFrozen(a)?Nr.cloneDeep(a):a;return Ec()(i,!0),i}function Of(a,i){return a||[[i[0],i[3]],[i[2],i[3]],[i[2],i[1]],[i[0],i[1]]]}var fE=Object.defineProperty,Oy=Object.defineProperties,Ll=Object.getOwnPropertyDescriptors,fp=Object.getOwnPropertySymbols,dp=Object.prototype.hasOwnProperty,Ef=Object.prototype.propertyIsEnumerable,Pl=(a,i,s)=>i in a?fE(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Ey=(a,i)=>{for(var s in i||(i={}))dp.call(i,s)&&Pl(a,s,i[s]);if(fp)for(var s of fp(i))Ef.call(i,s)&&Pl(a,s,i[s]);return a},hp=(a,i)=>Oy(a,Ll(i));function Yr(a,i){const{x:s,y:f,x1:g,y1:y,coordinates:_,geometry:O}=i,A=[];if(!Array.isArray(a))return{dataArray:[]};if(O)return a.filter(P=>P[O]&&P[O].type&&P[O].coordinates&&P[O].coordinates.length>0).forEach((P,B)=>{const U=Sy(P[O]);ce(U,G=>{const vt=Le(G),$t=hp(Ey({},P),{_id:B,coordinates:vt});A.push($t)})}),{dataArray:A};for(let P=0;P<a.length;P++){const B=a[P];let U=[];if(_){let vt="Polygon";Array.isArray(_[0])||(vt="Point"),Array.isArray(_[0])&&!Array.isArray(_[0][0])&&(vt="LineString"),U=Sy({type:vt,coordinates:B[_]}).coordinates}else if(s&&f&&g&&y){const vt=[parseFloat(B[s]),parseFloat(B[f])],$t=[parseFloat(B[g]),parseFloat(B[y])];U=[vt,$t]}else s&&f&&(U=[parseFloat(B[s]),parseFloat(B[f])]);const G=hp(Ey({},B),{_id:P,coordinates:U});A.push(G)}return{dataArray:A}}function Pr(a,i){const s=Ge(a);return Yr(s,i)}var Il=Object.defineProperty,wy=Object.defineProperties,Rl=Object.getOwnPropertyDescriptors,pp=Object.getOwnPropertySymbols,dE=Object.prototype.hasOwnProperty,wc=Object.prototype.propertyIsEnumerable,gp=(a,i,s)=>i in a?Il(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,xL=(a,i)=>{for(var s in i||(i={}))dE.call(i,s)&&gp(a,s,i[s]);if(pp)for(var s of pp(i))wc.call(i,s)&&gp(a,s,i[s]);return a},hE=(a,i)=>wy(a,Rl(i));function wf(a){const i=a.toString();let s=5381,f=i.length;for(;f;)s=s*33^i.charCodeAt(--f);return s>>>0}function vp(a,i){return i===void 0?null:typeof(a.properties[i]*1)=="number"?a.properties[i]*1:a.properties&&a.properties[i]?wf(a.properties[i]+"")%1000019:null}function pE(a,i){const s=[],f={};return a.features?(a.features=a.features.filter(g=>{const y=g.geometry;return g!=null&&y&&y.type&&y.coordinates&&y.coordinates.length>0}),a=Sy(a),a.features.length===0?{dataArray:[],featureKeys:f}:(ce(a,(g,y)=>{let _=vp(g,i==null?void 0:i.featureId);_===null&&(_=y);const O=_,A=Le(g),P=hE(xL({},g.properties),{coordinates:A,_id:O});s.push(P)}),{dataArray:s,featureKeys:f})):(a.features=[],{dataArray:[]})}function Af(a,i,s,f){for(var g=f,y=s-i>>1,_=s-i,O,A=a[i],P=a[i+1],B=a[s],U=a[s+1],G=i+3;G<s;G+=3){var vt=kl(a[G],a[G+1],A,P,B,U);if(vt>g)O=G,g=vt;else if(vt===g){var $t=Math.abs(G-y);$t<_&&(O=G,_=$t)}}g>f&&(O-i>3&&Af(a,i,O,f),a[O+2]=g,s-O>3&&Af(a,O,s,f))}function kl(a,i,s,f,g,y){var _=g-s,O=y-f;if(_!==0||O!==0){var A=((a-s)*_+(i-f)*O)/(_*_+O*O);A>1?(s=g,f=y):A>0&&(s+=_*A,f+=O*A)}return _=a-s,O=i-f,_*_+O*O}function Po(a,i,s,f){var g={id:typeof a=="undefined"?null:a,type:i,geometry:s,tags:f,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Tf(g),g}function Tf(a){var i=a.geometry,s=a.type;if(s==="Point"||s==="MultiPoint"||s==="LineString")mp(a,i);else if(s==="Polygon"||s==="MultiLineString")for(var f=0;f<i.length;f++)mp(a,i[f]);else if(s==="MultiPolygon")for(f=0;f<i.length;f++)for(var g=0;g<i[f].length;g++)mp(a,i[f][g])}function mp(a,i){for(var s=0;s<i.length;s+=3)a.minX=Math.min(a.minX,i[s]),a.minY=Math.min(a.minY,i[s+1]),a.maxX=Math.max(a.maxX,i[s]),a.maxY=Math.max(a.maxY,i[s+1])}function Ay(a,i){var s=[];if(a.type==="FeatureCollection")for(var f=0;f<a.features.length;f++)Aa(s,a.features[f],i,f);else a.type==="Feature"?Aa(s,a,i):Aa(s,{geometry:a},i);return s}function Aa(a,i,s,f){if(i.geometry){var g=i.geometry.coordinates,y=i.geometry.type,_=Math.pow(s.tolerance/((1<<s.maxZoom)*s.extent),2),O=[],A=i.id;if(s.promoteId?A=i.properties[s.promoteId]:s.generateId&&(A=f||0),y==="Point")Ty(g,O);else if(y==="MultiPoint")for(var P=0;P<g.length;P++)Ty(g[P],O);else if(y==="LineString")Cf(g,O,_,!1);else if(y==="MultiLineString")if(s.lineMetrics){for(P=0;P<g.length;P++)O=[],Cf(g[P],O,_,!1),a.push(Po(A,"LineString",O,i.properties));return}else Mf(g,O,_,!1);else if(y==="Polygon")Mf(g,O,_,!0);else if(y==="MultiPolygon")for(P=0;P<g.length;P++){var B=[];Mf(g[P],B,_,!0),O.push(B)}else if(y==="GeometryCollection"){for(P=0;P<i.geometry.geometries.length;P++)Aa(a,{id:A,geometry:i.geometry.geometries[P],properties:i.properties},s,f);return}else throw new Error("Input data is not a valid GeoJSON object.");a.push(Po(A,y,O,i.properties))}}function Ty(a,i){i.push(Cy(a[0])),i.push(My(a[1])),i.push(0)}function Cf(a,i,s,f){for(var g,y,_=0,O=0;O<a.length;O++){var A=Cy(a[O][0]),P=My(a[O][1]);i.push(A),i.push(P),i.push(0),O>0&&(f?_+=(g*P-A*y)/2:_+=Math.sqrt(Math.pow(A-g,2)+Math.pow(P-y,2))),g=A,y=P}var B=i.length-3;i[2]=1,Af(i,0,B,s),i[B+2]=1,i.size=Math.abs(_),i.start=0,i.end=i.size}function Mf(a,i,s,f){for(var g=0;g<a.length;g++){var y=[];Cf(a[g],y,s,f),i.push(y)}}function Cy(a){return a/360+.5}function My(a){var i=Math.sin(a*Math.PI/180),s=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return s<0?0:s>1?1:s}function Ti(a,i,s,f,g,y,_,O){if(s/=i,f/=i,y>=s&&_<f)return a;if(_<s||y>=f)return null;for(var A=[],P=0;P<a.length;P++){var B=a[P],U=B.geometry,G=B.type,vt=g===0?B.minX:B.minY,$t=g===0?B.maxX:B.maxY;if(vt>=s&&$t<f){A.push(B);continue}else if($t<s||vt>=f)continue;var te=[];if(G==="Point"||G==="MultiPoint")gE(U,te,s,f,g);else if(G==="LineString")yp(U,te,s,f,g,!1,O.lineMetrics);else if(G==="MultiLineString")bp(U,te,s,f,g,!1);else if(G==="Polygon")bp(U,te,s,f,g,!0);else if(G==="MultiPolygon")for(var Te=0;Te<U.length;Te++){var Fe=[];bp(U[Te],Fe,s,f,g,!0),Fe.length&&te.push(Fe)}if(te.length){if(O.lineMetrics&&G==="LineString"){for(Te=0;Te<te.length;Te++)A.push(Po(B.id,G,te[Te],B.tags));continue}(G==="LineString"||G==="MultiLineString")&&(te.length===1?(G="LineString",te=te[0]):G="MultiLineString"),(G==="Point"||G==="MultiPoint")&&(G=te.length===3?"Point":"MultiPoint"),A.push(Po(B.id,G,te,B.tags))}}return A.length?A:null}function gE(a,i,s,f,g){for(var y=0;y<a.length;y+=3){var _=a[y+g];_>=s&&_<=f&&(i.push(a[y]),i.push(a[y+1]),i.push(a[y+2]))}}function yp(a,i,s,f,g,y,_){for(var O=ea(a),A=g===0?vE:mE,P=a.start,B,U,G=0;G<a.length-3;G+=3){var vt=a[G],$t=a[G+1],te=a[G+2],Te=a[G+3],Fe=a[G+4],Ze=g===0?vt:$t,je=g===0?Te:Fe,Qe=!1;_&&(B=Math.sqrt(Math.pow(vt-Te,2)+Math.pow($t-Fe,2))),Ze<s?je>s&&(U=A(O,vt,$t,Te,Fe,s),_&&(O.start=P+B*U)):Ze>f?je<f&&(U=A(O,vt,$t,Te,Fe,f),_&&(O.start=P+B*U)):Lf(O,vt,$t,te),je<s&&Ze>=s&&(U=A(O,vt,$t,Te,Fe,s),Qe=!0),je>f&&Ze<=f&&(U=A(O,vt,$t,Te,Fe,f),Qe=!0),!y&&Qe&&(_&&(O.end=P+B*U),i.push(O),O=ea(a)),_&&(P+=B)}var ln=a.length-3;vt=a[ln],$t=a[ln+1],te=a[ln+2],Ze=g===0?vt:$t,Ze>=s&&Ze<=f&&Lf(O,vt,$t,te),ln=O.length-3,y&&ln>=3&&(O[ln]!==O[0]||O[ln+1]!==O[1])&&Lf(O,O[0],O[1],O[2]),O.length&&i.push(O)}function ea(a){var i=[];return i.size=a.size,i.start=a.start,i.end=a.end,i}function bp(a,i,s,f,g,y){for(var _=0;_<a.length;_++)yp(a[_],i,s,f,g,y,!1)}function Lf(a,i,s,f){a.push(i),a.push(s),a.push(f)}function vE(a,i,s,f,g,y){var _=(y-i)/(f-i);return a.push(y),a.push(s+(g-s)*_),a.push(1),_}function mE(a,i,s,f,g,y){var _=(y-s)/(g-s);return a.push(i+(f-i)*_),a.push(y),a.push(1),_}function Ni(a,i){var s=i.buffer/i.extent,f=a,g=Ti(a,1,-1-s,s,0,-1,2,i),y=Ti(a,1,1-s,2+s,0,-1,2,i);return(g||y)&&(f=Ti(a,1,-s,1+s,0,-1,2,i)||[],g&&(f=ro(g,1).concat(f)),y&&(f=f.concat(ro(y,-1)))),f}function ro(a,i){for(var s=[],f=0;f<a.length;f++){var g=a[f],y=g.type,_;if(y==="Point"||y==="MultiPoint"||y==="LineString")_=_p(g.geometry,i);else if(y==="MultiLineString"||y==="Polygon"){_=[];for(var O=0;O<g.geometry.length;O++)_.push(_p(g.geometry[O],i))}else if(y==="MultiPolygon")for(_=[],O=0;O<g.geometry.length;O++){for(var A=[],P=0;P<g.geometry[O].length;P++)A.push(_p(g.geometry[O][P],i));_.push(A)}s.push(Po(g.id,y,_,g.tags))}return s}function _p(a,i){var s=[];s.size=a.size,a.start!==void 0&&(s.start=a.start,s.end=a.end);for(var f=0;f<a.length;f+=3)s.push(a[f]+i,a[f+1],a[f+2]);return s}function Pf(a,i){if(a.transformed)return a;var s=1<<a.z,f=a.x,g=a.y,y,_,O;for(y=0;y<a.features.length;y++){var A=a.features[y],P=A.geometry,B=A.type;if(A.geometry=[],B===1)for(_=0;_<P.length;_+=2)A.geometry.push(Ly(P[_],P[_+1],i,s,f,g));else for(_=0;_<P.length;_++){var U=[];for(O=0;O<P[_].length;O+=2)U.push(Ly(P[_][O],P[_][O+1],i,s,f,g));A.geometry.push(U)}}return a.transformed=!0,a}function Ly(a,i,s,f,g,y){return[Math.round(s*(a*f-g)),Math.round(s*(i*f-y))]}function yE(a,i,s,f,g){for(var y=i===g.maxZoom?0:g.tolerance/((1<<i)*g.extent),_={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:s,y:f,z:i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},O=0;O<a.length;O++){_.numFeatures++,bE(_,a[O],y,g);var A=a[O].minX,P=a[O].minY,B=a[O].maxX,U=a[O].maxY;A<_.minX&&(_.minX=A),P<_.minY&&(_.minY=P),B>_.maxX&&(_.maxX=B),U>_.maxY&&(_.maxY=U)}return _}function bE(a,i,s,f){var g=i.geometry,y=i.type,_=[];if(y==="Point"||y==="MultiPoint")for(var O=0;O<g.length;O+=3)_.push(g[O]),_.push(g[O+1]),a.numPoints++,a.numSimplified++;else if(y==="LineString")qn(_,g,a,s,!1,!1);else if(y==="MultiLineString"||y==="Polygon")for(O=0;O<g.length;O++)qn(_,g[O],a,s,y==="Polygon",O===0);else if(y==="MultiPolygon")for(var A=0;A<g.length;A++){var P=g[A];for(O=0;O<P.length;O++)qn(_,P[O],a,s,!0,O===0)}if(_.length){var B=i.tags||null;if(y==="LineString"&&f.lineMetrics){B={};for(var U in i.tags)B[U]=i.tags[U];B.mapbox_clip_start=g.start/g.size,B.mapbox_clip_end=g.end/g.size}var G={geometry:_,type:y==="Polygon"||y==="MultiPolygon"?3:y==="LineString"||y==="MultiLineString"?2:1,tags:B};i.id!==null&&(G.id=i.id),a.features.push(G)}}function qn(a,i,s,f,g,y){var _=f*f;if(f>0&&i.size<(g?_:f)){s.numPoints+=i.length/3;return}for(var O=[],A=0;A<i.length;A+=3)(f===0||i[A+2]>_)&&(s.numSimplified++,O.push(i[A]),O.push(i[A+1])),s.numPoints++;g&&_E(O,y),a.push(O)}function _E(a,i){for(var s=0,f=0,g=a.length,y=g-2;f<g;y=f,f+=2)s+=(a[f]-a[y])*(a[f+1]+a[y+1]);if(s>0===i)for(f=0,g=a.length;f<g/2;f+=2){var _=a[f],O=a[f+1];a[f]=a[g-2-f],a[f+1]=a[g-1-f],a[g-2-f]=_,a[g-1-f]=O}}function Io(a,i){return new Ac(a,i)}function Ac(a,i){i=this.options=SL(Object.create(this.options),i);var s=i.debug;if(s&&console.time("preprocess data"),i.maxZoom<0||i.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(i.promoteId&&i.generateId)throw new Error("promoteId and generateId cannot be used together.");var f=Ay(a,i);this.tiles={},this.tileCoords=[],s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",i.indexMaxZoom,i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),f=Ni(f,i),f.length&&this.splitTile(f,0,0,0),s&&(f.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ac.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ac.prototype.splitTile=function(a,i,s,f,g,y,_){for(var O=[a,i,s,f],A=this.options,P=A.debug;O.length;){f=O.pop(),s=O.pop(),i=O.pop(),a=O.pop();var B=1<<i,U=Py(i,s,f),G=this.tiles[U];if(!G&&(P>1&&console.time("creation"),G=this.tiles[U]=yE(a,i,s,f,A),this.tileCoords.push({z:i,x:s,y:f}),P)){P>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",i,s,f,G.numFeatures,G.numPoints,G.numSimplified),console.timeEnd("creation"));var vt="z"+i;this.stats[vt]=(this.stats[vt]||0)+1,this.total++}if(G.source=a,g){if(i===A.maxZoom||i===g)continue;var $t=1<<g-i;if(s!==Math.floor(y/$t)||f!==Math.floor(_/$t))continue}else if(i===A.indexMaxZoom||G.numPoints<=A.indexMaxPoints)continue;if(G.source=null,a.length!==0){P>1&&console.time("clipping");var te=.5*A.buffer/A.extent,Te=.5-te,Fe=.5+te,Ze=1+te,je,Qe,ln,wn,mn,Mn;je=Qe=ln=wn=null,mn=Ti(a,B,s-te,s+Fe,0,G.minX,G.maxX,A),Mn=Ti(a,B,s+Te,s+Ze,0,G.minX,G.maxX,A),a=null,mn&&(je=Ti(mn,B,f-te,f+Fe,1,G.minY,G.maxY,A),Qe=Ti(mn,B,f+Te,f+Ze,1,G.minY,G.maxY,A),mn=null),Mn&&(ln=Ti(Mn,B,f-te,f+Fe,1,G.minY,G.maxY,A),wn=Ti(Mn,B,f+Te,f+Ze,1,G.minY,G.maxY,A),Mn=null),P>1&&console.timeEnd("clipping"),O.push(je||[],i+1,s*2,f*2),O.push(Qe||[],i+1,s*2,f*2+1),O.push(ln||[],i+1,s*2+1,f*2),O.push(wn||[],i+1,s*2+1,f*2+1)}}},Ac.prototype.getTile=function(a,i,s){var f=this.options,g=f.extent,y=f.debug;if(a<0||a>24)return null;var _=1<<a;i=(i%_+_)%_;var O=Py(a,i,s);if(this.tiles[O])return Pf(this.tiles[O],g);y>1&&console.log("drilling down to z%d-%d-%d",a,i,s);for(var A=a,P=i,B=s,U;!U&&A>0;)A--,P=Math.floor(P/2),B=Math.floor(B/2),U=this.tiles[Py(A,P,B)];return!U||!U.source?null:(y>1&&console.log("found parent tile z%d-%d-%d",A,P,B),y>1&&console.time("drilling down"),this.splitTile(U.source,A,P,B,a,i,s),y>1&&console.timeEnd("drilling down"),this.tiles[O]?Pf(this.tiles[O],g):null)};function Py(a,i,s){return((1<<a)*s+i)*32+a}function SL(a,i){for(var s in i)a[s]=i[s];return a}var _r=class{constructor(a,i,s,f){this.vectorLayerCache={},this.x=i,this.y=s,this.z=f,this.vectorTile=a}getTileData(a){return!a||!this.vectorTile.layers[a]?[]:this.vectorLayerCache[a]?this.vectorLayerCache[a]:this.vectorTile.layers[a].features}getFeatureById(){throw new Error("Method not implemented.")}},lo=Object.defineProperty,Ta=Object.defineProperties,Dl=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,Ls=Object.prototype.hasOwnProperty,Ps=Object.prototype.propertyIsEnumerable,Tc=(a,i,s)=>i in a?lo(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Fl=(a,i)=>{for(var s in i||(i={}))Ls.call(i,s)&&Tc(a,s,i[s]);if(If)for(var s of If(i))Ps.call(i,s)&&Tc(a,s,i[s]);return a},OL=(a,i)=>Ta(a,Dl(i)),xE=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),Cc={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function Iy(a){let i=0;for(let s=0,f=a.length,g=f-1,y,_;s<f;g=s++)y=a[s],_=a[g],i+=(_.x-y.x)*(y.y+_.y);return i}function xp(a){const i=a.length;if(i<=1)return[a];const s=[];let f,g;for(let y=0;y<i;y++){const _=Iy(a[y]);_!==0&&(g===void 0&&(g=_<0),g===_<0?(f&&s.push(f),f=[a[y]]):f.push(a[y]))}return f&&s.push(f),s}var SE=["Unknown","Point","LineString","Polygon"];function OE(a,i,s,f,g){let y=g.geometry;const _=g.type,O=g.tags,A=g.id,P=a*Math.pow(2,f),B=a*i,U=a*s;let G=SE[_],vt,$t;function te(Fe){for(let Ze=0;Ze<Fe.length;Ze++){const je=Fe[Ze];if(je[3])break;const Qe=180-(je[1]+U)*360/P,ln=(je[0]+B)*360/P-180,wn=360/Math.PI*Math.atan(Math.exp(Qe*Math.PI/180))-90;Fe[Ze]=[ln,wn,0,1]}}switch(_){case 1:const Fe=[];for(vt=0;vt<y.length;vt++)Fe[vt]=y[vt][0];y=Fe,te(y);break;case 2:for(vt=0;vt<y.length;vt++)te(y[vt]);break;case 3:for(y=xp(y),vt=0;vt<y.length;vt++)for($t=0;$t<y[vt].length;$t++)te(y[vt][$t]);break}return y.length===1?y=y[0]:G="Multi"+G,{type:"Feature",geometry:{type:G,coordinates:y},properties:O,id:A,tileOrigin:[0,0],coord:""}}var Ry=(a,i,s,f)=>xE(void 0,null,function*(){return new Promise(g=>{const y=i.getTile(a.z,a.x,a.y),O={layers:{defaultLayer:{features:y?y.features.map(P=>OE(f,s.x,s.y,s.z,P)):[]}}},A=new _r(O,a.x,a.y,a.z);g(A)})});function EE(a){const i={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return a===void 0||typeof a.geojsonvtOptions=="undefined"?i:Fl(Fl({},i),a.geojsonvtOptions)}function Rf(a,i){const s=EE(i),f=s.extent||4096,g=Io(a,s),y=(O,A)=>Ry(A,g,O,f),_=OL(Fl(Fl({},Cc),i),{getTileData:y});return{data:a,dataArray:[],tilesetOptions:_,isTile:!0}}var or=Object.defineProperty,na=Object.defineProperties,Ca=Object.getOwnPropertyDescriptors,_o=Object.getOwnPropertySymbols,kf=Object.prototype.hasOwnProperty,wE=Object.prototype.propertyIsEnumerable,ky=(a,i,s)=>i in a?or(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Sp=(a,i)=>{for(var s in i||(i={}))kf.call(i,s)&&ky(a,s,i[s]);if(_o)for(var s of _o(i))wE.call(i,s)&&ky(a,s,i[s]);return a},Is=(a,i)=>na(a,Ca(i));function Op(a,i){const{extent:s=[121.168,30.2828,121.384,30.4219],coordinates:f,requestParameters:g={}}=i,y=new Promise(A=>{a instanceof HTMLImageElement||Ga(a)?A([a]):AE(a,g,P=>{A(P)})}),_=Of(f,s);return{originData:a,images:y,_id:1,dataArray:[{_id:0,coordinates:_}]}}function AE(a,i,s){const f=[];if(typeof a=="string")ht(Is(Sp({},i),{url:a}),(g,y)=>{y&&(f.push(y),s(f))});else{const g=a.length;let y=0;a.forEach(_=>{ht(Is(Sp({},i),{url:_}),(O,A)=>{y++,A&&f.push(A),y===g&&s(f)})})}return Op}var Ep=Object.defineProperty,TE=Object.defineProperties,CE=Object.getOwnPropertyDescriptors,Dy=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,LE=Object.prototype.propertyIsEnumerable,hr=(a,i,s)=>i in a?Ep(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Fy=(a,i)=>{for(var s in i||(i={}))ME.call(i,s)&&hr(a,s,i[s]);if(Dy)for(var s of Dy(i))LE.call(i,s)&&hr(a,s,i[s]);return a},Ny=(a,i)=>TE(a,CE(i)),PE=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),wp=(a,i,s,f)=>PE(void 0,null,function*(){const g={x:i.x,y:i.y,z:i.z},y=Ms(a,g);return new Promise(_=>{f?f(g,(O,A)=>{if(O||!A){const P={layers:{defaultLayer:{features:[]}}},B=new _r(P,i.x,i.y,i.z);_(B)}else{const P={layers:{defaultLayer:{features:A.features}}},B=new _r(P,i.x,i.y,i.z);_(B)}}):Xi(Ny(Fy({},s),{url:y}),(O,A)=>{if(O||!A){const P={layers:{defaultLayer:{features:[]}}},B=new _r(P,i.x,i.y,i.z);_(B)}else{const B={layers:{defaultLayer:{features:JSON.parse(A)}}},U=new _r(B,i.x,i.y,i.z);_(U)}})})});function IE(a,i){const s=(g,y)=>wp(a,y,i==null?void 0:i.requestParameters,i.getCustomData),f=Ny(Fy({},i),{getTileData:s});return{dataArray:[],tilesetOptions:f,isTile:!0}}var Rs=k(38929),Ap=k(3614),By=k.n(Ap),jy=Object.defineProperty,EL=Object.defineProperties,Tp=Object.getOwnPropertyDescriptors,Cp=Object.getOwnPropertySymbols,Df=Object.prototype.hasOwnProperty,Mp=Object.prototype.propertyIsEnumerable,Mc=(a,i,s)=>i in a?jy(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,zy=(a,i)=>{for(var s in i||(i={}))Df.call(i,s)&&Mc(a,s,i[s]);if(Cp)for(var s of Cp(i))Mp.call(i,s)&&Mc(a,s,i[s]);return a},RE=(a,i)=>EL(a,Tp(i)),Nl=class{constructor(a,i,s,f){this.vectorLayerCache={},this.x=i,this.y=s,this.z=f,this.vectorTile=new Rs.VectorTile(new(By())(a))}getTileData(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];const i=this.vectorTile.layers[a];if(Array.isArray(i.features))return this.vectorLayerCache[a]=i.features,i.features;const s=[];for(let f=0;f<i.length;f++){const y=i.feature(f).toGeoJSON(this.x,this.y,this.z);s.push(RE(zy({},y),{properties:zy({id:y.id},y.properties)}))}return this.vectorLayerCache[a]=s,s}getFeatureById(){throw new Error("Method not implemented.")}},Uy=Object.defineProperty,Zy=Object.defineProperties,Hy=Object.getOwnPropertyDescriptors,Lp=Object.getOwnPropertySymbols,kE=Object.prototype.hasOwnProperty,DE=Object.prototype.propertyIsEnumerable,Vy=(a,i,s)=>i in a?Uy(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Pp=(a,i)=>{for(var s in i||(i={}))kE.call(i,s)&&Vy(a,s,i[s]);if(Lp)for(var s of Lp(i))DE.call(i,s)&&Vy(a,s,i[s]);return a},Ip=(a,i)=>Zy(a,Hy(i)),FE=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),NE={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},BE=(a,i,s,f,g)=>FE(void 0,null,function*(){const y=Ms(a,i);return new Promise(_=>{if(g)g({x:s.x,y:s.y,z:s.z},(O,A)=>{if(O||!A)_(void 0);else{const P=new Nl(A,s.x,s.y,s.z);_(P)}});else{const O=Ui(Ip(Pp({},f),{url:y}),(A,P)=>{if(A||!P)_(void 0);else{const B=new Nl(P,s.x,s.y,s.z);_(B)}});s.xhrCancel=()=>O.cancel()}})});function jE(a,i){const s=Array.isArray(a)?a[0]:a,f=(y,_)=>BE(s,y,_,i==null?void 0:i.requestParameters,i==null?void 0:i.getCustomData),g=Ip(Pp(Pp({},NE),i),{getTileData:f});return{data:s,dataArray:[],tilesetOptions:g,isTile:!0}}function Wy(a,i,s){switch(a){case"+":return i+s;case"-":return i-s;case"*":return i*s;case"/":return i/s;case"%":return i%s;case"^":return Math.pow(i,s);case"abs":return Math.abs(i);case"floor":return Math.floor(i);case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"sin":return Math.sin(i);case"cos":return Math.cos(i);case"atan":return s===-1?Math.atan(i):Math.atan2(i,s);case"min":return Math.min(i,s);case"max":return Math.max(i,s);case"log10":return Math.log(i);case"log2":return Math.log2(i);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Bl(a,i){const{width:s,height:f}=i[0],g=i.map(A=>A.rasterData),y=s*f,_=[],O=JSON.stringify(a);for(let A=0;A<y;A++){const P=JSON.parse(O),B=Gy(P,g,A);if(typeof B=="number")_.push(B);else{const U=Ci(P);_.push(U)}}return _}function Gy(a,i,s){if(a.length===2&&a[0]==="band"&&typeof a[1]=="number")try{return i[a[1]][s]}catch(f){return console.warn("Raster Data err!"),0}a.map((f,g)=>{if(Array.isArray(f)&&f.length>0)switch(f[0]){case"band":try{a[g]=i[f[1]][s]}catch(y){console.warn("Raster Data err!"),a[g]=0}break;default:Gy(f,i,s)}})}function zE(a){const[i,s=-1,f=-1]=a;return i===void 0?(console.warn("Express err!"),["+",0,0]):[i.replace(/\s+/g,""),s,f]}function Ci(a){const i=zE(a),s=i[0];let f=i[1],g=i[2];return Array.isArray(f)&&(f=Ci(a[1])),Array.isArray(g)&&(g=Ci(a[2])),Wy(s,f,g)}var UE={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Rp}};function Rp(a,i){const s=a[0].rasterData,f=a[1].rasterData,g=a[2].rasterData,y=[],[_,O]=(i==null?void 0:i.countCut)||[2,98],A=(i==null?void 0:i.RMinMax)||Lc(s,_,O),P=(i==null?void 0:i.GMinMax)||Lc(f,_,O),B=(i==null?void 0:i.BMinMax)||Lc(g,_,O);for(let U=0;U<s.length;U++)y.push(Math.max(0,s[U]-A[0])),y.push(Math.max(0,f[U]-P[0])),y.push(Math.max(0,g[U]-B[0]));return{rasterData:y,rMinMax:A,gMinMax:P,bMinMax:B}}function Lc(a,i,s){const f=a.slice().sort((O,A)=>O-A),g=f.length,y=f[Math.ceil(g*i/100)],_=f[Math.ceil(g*s/100)];return[y,_]}var Ff=Object.defineProperty,kp=Object.defineProperties,wL=Object.getOwnPropertyDescriptors,Yy=Object.getOwnPropertySymbols,$y=Object.prototype.hasOwnProperty,Xy=Object.prototype.propertyIsEnumerable,Dp=(a,i,s)=>i in a?Ff(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Fp=(a,i)=>{for(var s in i||(i={}))$y.call(i,s)&&Dp(a,s,i[s]);if(Yy)for(var s of Yy(i))Xy.call(i,s)&&Dp(a,s,i[s]);return a},ZE=(a,i)=>kp(a,wL(i)),qy=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())});function Nf(a,i,s){return qy(this,null,function*(){if(a.length===0)return{rasterData:[0],width:1,heigh:1};const f=yield Promise.all(a.map(({data:A,bands:P=[0]})=>i(A,P))),g=[];f.forEach(A=>{Array.isArray(A)?g.push(...A):g.push(A)});const{width:y,height:_}=g[0];let O;switch(typeof s){case"function":O=s(g);break;case"object":Array.isArray(s)?O={rasterData:Bl(s,g)}:O=Ky(s,g);break;default:O={rasterData:g[0].rasterData}}return ZE(Fp({},O),{width:y,height:_})})}function Ky(a,i){const s=UE[a.type];if(s.type==="function")return s.method(i,a==null?void 0:a.options);if(s.type==="operation")return a.type==="rgb"?Zi(s.expression,i):{rasterData:Bl(s.expression,i)}}function Zi(a,i){a.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),a.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),a.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const s=Bl(a.r||["band",0],i),f=Bl(a.g||["band",0],i),g=Bl(a.b||["band",0],i);return[s,f,g]}function jl(a,i,s,f){return qy(this,null,function*(){const g=yield Nf(a,i,s);f(null,{data:g})})}function Bf(a,i){const{extent:s=[121.168,30.2828,121.384,30.4219],coordinates:f,width:g,height:y,min:_,max:O,format:A,operation:P}=i;let B,U,G;if(A===void 0||Or(a))B=Array.from(a),U=g,G=y;else{const te=Array.isArray(a)?a:[a];B=Nf(te,A,P)}const vt=Of(f,s);return{_id:1,dataArray:[{_id:1,data:B,width:U,height:G,min:_,max:O,coordinates:vt}]}}var Je=k(1413),ut=k(4942);let zl=function(a){return a.Normal="normal",a.PostProcessing="post-processing",a}({}),at=function(a){return a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.CULL_FACE=2884]="CULL_FACE",a[a.BLEND=3042]="BLEND",a[a.DITHER=3024]="DITHER",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.RED=6403]="RED",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.TEXTURE1=33985]="TEXTURE1",a[a.TEXTURE2=33986]="TEXTURE2",a[a.TEXTURE3=33987]="TEXTURE3",a[a.TEXTURE4=33988]="TEXTURE4",a[a.TEXTURE5=33989]="TEXTURE5",a[a.TEXTURE6=33990]="TEXTURE6",a[a.TEXTURE7=33991]="TEXTURE7",a[a.TEXTURE8=33992]="TEXTURE8",a[a.TEXTURE9=33993]="TEXTURE9",a[a.TEXTURE10=33994]="TEXTURE10",a[a.TEXTURE11=33995]="TEXTURE11",a[a.TEXTURE12=33996]="TEXTURE12",a[a.TEXTURE13=33997]="TEXTURE13",a[a.TEXTURE14=33998]="TEXTURE14",a[a.TEXTURE15=33999]="TEXTURE15",a[a.TEXTURE16=34e3]="TEXTURE16",a[a.TEXTURE17=34001]="TEXTURE17",a[a.TEXTURE18=34002]="TEXTURE18",a[a.TEXTURE19=34003]="TEXTURE19",a[a.TEXTURE20=34004]="TEXTURE20",a[a.TEXTURE21=34005]="TEXTURE21",a[a.TEXTURE22=34006]="TEXTURE22",a[a.TEXTURE23=34007]="TEXTURE23",a[a.TEXTURE24=34008]="TEXTURE24",a[a.TEXTURE25=34009]="TEXTURE25",a[a.TEXTURE26=34010]="TEXTURE26",a[a.TEXTURE27=34011]="TEXTURE27",a[a.TEXTURE28=34012]="TEXTURE28",a[a.TEXTURE29=34013]="TEXTURE29",a[a.TEXTURE30=34014]="TEXTURE30",a[a.TEXTURE31=34015]="TEXTURE31",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a}({});const HE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:VE,isNil:Qy,upperFirst:Jy}=Nr;class qa{constructor(){(0,ut.Z)(this,"shaderModuleService",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"config",void 0),(0,ut.Z)(this,"quad",HE),(0,ut.Z)(this,"enabled",!0),(0,ut.Z)(this,"renderToScreen",!1),(0,ut.Z)(this,"model",void 0),(0,ut.Z)(this,"name",void 0),(0,ut.Z)(this,"optionsToUpdate",{})}getName(){return this.name}setName(i){this.name=i}getType(){return zl.PostProcessing}init(i,s){this.config=s,this.rendererService=i.getContainer().rendererService,this.shaderModuleService=i.getContainer().shaderModuleService;const{createAttribute:f,createBuffer:g,createModel:y}=this.rendererService,{vs:_,fs:O,uniforms:A}=this.setupShaders();this.model=y({vs:_,fs:O,attributes:{a_Position:f({buffer:g({data:[-4,-4,4,-4,0,4],type:at.FLOAT}),size:2})},uniforms:(0,Je.Z)((0,Je.Z)({u_Texture:null},A),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(i,s){const f=i.multiPassRenderer.getPostProcessor(),{useFramebuffer:g,getViewportSize:y,clear:_}=this.rendererService,{width:O,height:A}=y();g(this.renderToScreen?null:f.getWriteFBO(),()=>{_({framebuffer:f.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const P=(0,Je.Z)({u_BloomFinal:0,u_Texture:f.getReadFBO(),u_ViewportSize:[O,A]},this.convertOptionsToUniforms(this.optionsToUpdate));s&&(P.u_BloomFinal=1,P.u_Texture2=s),this.model.draw({uniforms:P})})}isEnabled(){return this.enabled}setEnabled(i){this.enabled=i}setRenderToScreen(i){this.renderToScreen=i}updateOptions(i){this.optionsToUpdate=(0,Je.Z)((0,Je.Z)({},this.optionsToUpdate),i)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(i){const s={};return Object.keys(i).forEach(f=>{Qy(i[f])||(s[`u_${Jy(VE(f))}`]=i[f])}),s}}function WE(a){let i=0;switch(a){case"vec2":case"ivec2":i=2;break;case"vec3":case"ivec3":i=3;break;case"vec4":case"ivec4":case"mat2":i=4;break;case"mat3":i=9;break;case"mat4":i=16;break;default:}return i}const t1=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Ul(a,i=!1){const s={};return a=a.replace(t1,(f,g,y)=>{const _=y.split(":"),O=_[0].trim();let A="";switch(_.length>1&&(A=_[1].trim()),g){case"bool":A=A==="true";break;case"float":case"int":A=Number(A);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":A?A=A.replace("[","").replace("]","").split(",").reduce((P,B)=>(P.push(Number(B.trim())),P),[]):A=new Array(WE(g)).fill(0);break;default:}return s[O]=A,`${i?"uniform ":""}${g} ${O};
`}),{content:a,uniforms:s}}function Zl(a){let{content:i,uniforms:s}=Ul(a,!0);return i=i.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(f,g,y)=>{y=y.trim().replace(/^.*$/gm,A=>`uniform ${A}`);const{content:_,uniforms:O}=Ul(y);return Object.assign(s,O),`${g}{
${_}
};`}),{content:i,uniforms:s}}function e1(a){const i={};return a.replace(t1,(s,f,g)=>{const y=g.trim();return i[y]?"":(i[y]=!0,`uniform ${f} ${y};
`)})}const AL=null;function GE(a){return AL.indexOf(a)}const{clamp:YE}=Nr,$E=2,nk=4,XE=64,TL=128,qE=256,KE=512,CL=8192,ML=16384,LL=32768,QE=null,n1=131072,PL=262144,JE=524288,tw=1048576,Np=2097152,IL=4194304,ew=8388608,r1=16777216,nw=null;function Hl(a,i){return a=YE(Math.floor(a),0,255),i=YE(Math.floor(i),0,255),256*a+i}function RL(a){const{color:i,radius:s,tileX:f,tileY:g,shape:y,opacity:_,stroke:O,strokeWidth:A,strokeOpacity:P}=a,B=[],U=[],G=[],vt=[Hl(i[0],i[1]),Hl(i[2],i[3])],$t=[Hl(O[0],O[1]),Hl(O[2],O[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([te,Te])=>{B.push([...vt,(te+1)*ew+(Te+1)*Np+getShapeIndex(y)*n1+s,(f+512)*JE+(g+512)*XE]),U.push([...$t,A,P]),G.push([_,0,0,0])}),{packedBuffer:B,packedBuffer2:U,packedBuffer3:G}}function rw(a,i){if(a===0&&!i)return 0;if(a===1&&i)return 4294967295;const s=i?1:0,f=Math.floor(a*127);return f*nw+s*r1+f*n1+s*QE+f*KE+s*qE+f*$E+s}const Ka={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let Vl=function(a){return a.TOPRIGHT="topright",a.TOPLEFT="topleft",a.BOTTOMRIGHT="bottomright",a.BOTTOMLEFT="bottomleft",a.TOPCENTER="topcenter",a.BOTTOMCENTER="bottomcenter",a.LEFTCENTER="leftcenter",a.RIGHTCENTER="rightcenter",a.LEFTTOP="lefttop",a.RIGHTTOP="righttop",a.LEFTBOTTOM="leftbottom",a.RIGHTBOTTOM="rightbottom",a}({}),jf=function(a){return a[a.LNGLAT=1]="LNGLAT",a[a.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",a[a.VECTOR_TILE=3]="VECTOR_TILE",a[a.IDENTITY=4]="IDENTITY",a[a.METER_OFFSET=5]="METER_OFFSET",a}({});const ks={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var Mi={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let uo=function(a){return a.Hover="hover",a.Click="click",a.Select="select",a.Active="active",a.Drag="drag",a}({}),Qa=function(a){return a.normal="normal",a.additive="additive",a.subtractive="subtractive",a.min="min",a.max="max",a.none="none",a}({}),Ds=function(a){return a.MULTIPLE="MULTIPLE",a.SINGLE="SINGLE",a}({}),Wl=function(a){return a.AND="and",a.OR="or",a}({}),Hi=function(a){return a.INIT="init",a.UPDATE="update",a}({}),Hn=function(a){return a.LINEAR="linear",a.SEQUENTIAL="sequential",a.POWER="power",a.LOG="log",a.IDENTITY="identity",a.TIME="time",a.QUANTILE="quantile",a.QUANTIZE="quantize",a.THRESHOLD="threshold",a.CAT="cat",a.DIVERGING="diverging",a.CUSTOM="threshold",a}({}),Gl=function(a){return a.CONSTANT="constant",a.VARIABLE="variable",a}({}),In=function(a){return a[a.Attribute=0]="Attribute",a[a.InstancedAttribute=1]="InstancedAttribute",a[a.Uniform=2]="Uniform",a}({});const zf=["mapload","mapchange","mapAfterFrameChange"];var iw=k(49296),ow=k.n(iw);const Yl=30;function i1({characterSet:a,getFontWidth:i,fontHeight:s,buffer:f,maxCanvasWidth:g,mapping:y={},xOffset:_=0,yOffset:O=0}){let A=0,P=_;Array.from(a).forEach((U,G)=>{if(!y[U]){const vt=i(U,G);P+Yl>g&&(P=0,A++),y[U]={x:P,y:O+A*Yl,width:Yl,height:Yl,advance:vt},P+=Yl}});const B=s+f*2;return{mapping:y,xOffset:P,yOffset:O+A*B,canvasHeight:Bp(O+(A+1)*B)}}function aw(a,i,s){let f=0,g=0,y=0,_=[];const O={};for(const P of a)if(!O[P.id]){const{size:B}=P;f+B+i>s&&(o1(O,_,g),f=0,g=y+g+i,y=0,_=[]),_.push({icon:P,xOffset:f}),f=f+B+i,y=Math.max(y,B)}_.length>0&&o1(O,_,g);const A=Bp(y+g+i);return{mapping:O,canvasHeight:A}}function o1(a,i,s){for(const f of i){const{icon:g,xOffset:y}=f;a[g.id]=(0,Je.Z)((0,Je.Z)({},g),{},{x:y,y:s,image:g.image,width:g.width,height:g.height})}}function Bp(a){return Math.pow(2,Math.ceil(Math.log2(a)))}const sw=c1(),a1="sans-serif",jp="normal",Fs=24,$l=3,Uf=.25,Pc=8,Zf=1024,cw=1,s1=1,zp=3,kL=null;function c1(){const a=[];for(let i=32;i<128;i++)a.push(String.fromCharCode(i));return a}function Ns(a,i,s,f){a.font=`${f} ${s}px ${i}`,a.fillStyle="black",a.textBaseline="middle"}function l1(a,i){for(let s=0;s<a.length;s++)i.data[4*s+3]=a[s]}class Xl extends no.EventEmitter{constructor(...i){super(...i),(0,ut.Z)(this,"fontAtlas",void 0),(0,ut.Z)(this,"iconFontMap",void 0),(0,ut.Z)(this,"iconFontGlyphs",{}),(0,ut.Z)(this,"fontOptions",void 0),(0,ut.Z)(this,"key",void 0),(0,ut.Z)(this,"cache",new ip(zp))}get scale(){return s1}get canvas(){const i=this.cache.get(this.key);return i&&i.data}get mapping(){const i=this.cache.get(this.key);return i&&i.mapping||{}}getCanvasByKey(i){const s=this.cache.get(i);return s&&s.data}getMappingByKey(i){const s=this.cache.get(i);return s&&s.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:a1,fontWeight:jp,characterSet:sw,fontSize:Fs,buffer:$l,sdf:!0,cutoff:Uf,radius:Pc,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(i){i.forEach(s=>{this.iconFontGlyphs[s.name]=s.unicode})}addIconFont(i,s){this.iconFontMap.set(i,s)}getIconFontKey(i){return this.iconFontMap.get(i)||i}getGlyph(i){return this.iconFontGlyphs[i]?String.fromCharCode(parseInt(this.iconFontGlyphs[i],16)):""}setFontOptions(i){this.fontOptions=(0,Je.Z)((0,Je.Z)({},this.fontOptions),i),this.key=this.getKey();const s=this.getNewChars(this.key,this.fontOptions.characterSet),f=this.cache.get(this.key);if(f&&s.length===0)return;const g=this.generateFontAtlas(this.key,s,f);this.fontAtlas=g,this.cache.set(this.key,g)}addFontFace(i,s){const f=document.createElement("style");f.type="text/css",f.innerText=`
        @font-face{
            font-family: '${i}';
            src: url('${s}') format('woff2'),
            url('${s}') format('woff'),
            url('${s}') format('truetype');
        }`,f.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${i}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:i})})}catch(g){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(g)}},document.getElementsByTagName("head")[0].appendChild(f)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(i,s,f){const{fontFamily:g,fontWeight:y,fontSize:_,buffer:O,sdf:A,radius:P,cutoff:B,iconfont:U}=this.fontOptions;let G=f&&f.data;G||(G=window.document.createElement("canvas"),G.width=Zf);const vt=G.getContext("2d",{willReadFrequently:!0});Ns(vt,g,_,y);const{mapping:$t,canvasHeight:te,xOffset:Te,yOffset:Fe}=i1((0,Je.Z)({getFontWidth:je=>vt.measureText(je).width,fontHeight:_*s1,buffer:O,characterSet:s,maxCanvasWidth:Zf},f&&{mapping:f.mapping,xOffset:f.xOffset,yOffset:f.yOffset})),Ze=vt.getImageData(0,0,G.width,G.height);if(G.height=te,vt.putImageData(Ze,0,0),Ns(vt,g,_,y),A){const je=new(ow())(_,O,P,B,g,y),Qe=vt.getImageData(0,0,je.size,je.size);for(const ln of s){if(U){const wn=String.fromCharCode(parseInt(ln.replace("&#x","").replace(";",""),16)),mn=je.draw(wn);l1(mn,Qe)}else l1(je.draw(ln),Qe);vt.putImageData(Qe,$t[ln].x,$t[ln].y)}}else for(const je of s)vt.fillText(je,$t[je].x,$t[je].y+_*cw);return{xOffset:Te,yOffset:Fe,mapping:$t,data:G,width:G.width,height:G.height}}getKey(){const{fontFamily:i,fontWeight:s}=this.fontOptions;return`${i}_${s}`}getNewChars(i,s){const f=this.cache.get(i);if(!f)return s;const g=[],y=f.mapping,_=new Set(Object.keys(y));return new Set(s).forEach(A=>{_.has(A)||g.push(A)}),g}}var nn=k(15861);const Hf=3,u1=1024,Ja=64;class Up extends no.EventEmitter{constructor(...i){super(...i),(0,ut.Z)(this,"canvasHeight",128),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"canvas",void 0),(0,ut.Z)(this,"iconData",void 0),(0,ut.Z)(this,"iconMap",void 0),(0,ut.Z)(this,"ctx",void 0),(0,ut.Z)(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(i,s){var f=this;return(0,nn.Z)(function*(){let g=new Image;f.loadingImageCount++,f.hasImage(i)?console.warn("Image Id already exists"):f.iconData.push({id:i,size:Ja}),f.updateIconMap(),g=yield f.loadImage(s);const y=f.iconData.find(_=>_.id===i);y&&(y.image=g,y.width=g.width,y.height=g.height),f.update()})()}addImageMini(i,s,f){const g=f.getSceneConfig().canvas;let y=g.createImage();if(this.loadingImageCount++,this.hasImage(i))throw new Error("Image Id already exists");this.iconData.push({id:i,size:Ja}),this.updateIconMap(),this.loadImageMini(s,g).then(_=>{y=_;const O=this.iconData.find(A=>A.id===i);O&&(O.image=y,O.width=y.width,O.height=y.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(i){return this.iconMap.hasOwnProperty(i)}removeImage(i){this.hasImage(i)&&(this.iconData=this.iconData.filter(s=>s.id!==i),delete this.iconMap[i],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(i){return new Promise((s,f)=>{if(i instanceof HTMLImageElement){s(i);return}const g=new Image;g.crossOrigin="anonymous",g.onload=()=>{s(g)},g.onerror=()=>{f(new Error("Could not load image at "+i))},g.src=i instanceof File?URL.createObjectURL(i):i})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=u1,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(i=>{const{x:s,y:f,image:g,width:y=64,height:_=64}=this.iconMap[i],A=Math.max(y,_)/Ja,P=_/A,B=y/A;g&&this.ctx.drawImage(g,s+(Ja-B)/2,f+(Ja-P)/2,B,P)})}updateIconMap(){const{mapping:i,canvasHeight:s}=aw(this.iconData,Hf,u1);this.iconMap=i,this.canvasHeight=s}loadImageMini(i,s){return new Promise((f,g)=>{const y=s.createImage();y.crossOrigin="anonymous",y.onload=()=>{f(y)},y.onerror=()=>{g(new Error("Could not load image at "+i))},y.src=i})}}var Er=k(85975);class Zp{constructor(){(0,ut.Z)(this,"viewport",void 0),(0,ut.Z)(this,"overridedViewProjectionMatrix",void 0),(0,ut.Z)(this,"viewMatrixInverse",void 0),(0,ut.Z)(this,"cameraPosition",void 0)}init(){}update(i){this.viewport=i,this.viewMatrixInverse=Er.create(),Er.invert(this.viewMatrixInverse,i.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[i,s]=this.viewport.getCenter();return[i,s]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(i,s){return this.viewport.projectFlat(i,s)}setViewProjectionMatrix(i){this.overridedViewProjectionMatrix=i}}const Vf={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class f1{constructor(){(0,ut.Z)(this,"container",void 0),(0,ut.Z)(this,"controlCorners",void 0),(0,ut.Z)(this,"controlContainer",void 0),(0,ut.Z)(this,"scene",void 0),(0,ut.Z)(this,"mapsService",void 0),(0,ut.Z)(this,"controls",[]),(0,ut.Z)(this,"unAddControls",[])}init(i,s){this.container=i.container,this.scene=s,this.mapsService=s.mapService,this.initControlPos()}addControl(i,s){s.mapService.map?(i.addTo(this.scene),this.controls.push(i)):this.unAddControls.push(i)}getControlByName(i){return this.controls.find(s=>s.controlOption.name===i)}removeControl(i){const s=this.controls.indexOf(i);return s>-1&&this.controls.splice(s,1),i.remove(),this}addControls(){this.unAddControls.forEach(i=>{i.addTo(this.scene),this.controls.push(i)}),this.unAddControls=[]}destroy(){for(const i of this.controls)i.remove();this.controls=[],this.clearControlPos()}initControlPos(){const i=this.controlCorners={},s="l7-",f=this.controlContainer=Fi("div",s+"control-container",this.container);function g(_=[]){const O=_.map(A=>s+A).join(" ");i[_.filter(A=>!["row","column"].includes(A)).join("")]=Fi("div",O,f)}function y(_){return[..._.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),Vf[_]]}Object.values(Vl).forEach(_=>{g(y(_))}),this.checkCornerOverlap()}clearControlPos(){for(const i in this.controlCorners)this.controlCorners[i]&&wa(this.controlCorners[i]);this.controlContainer&&wa(this.controlContainer)}checkCornerOverlap(){const i=window.MutationObserver;if(i)for(const s of Object.keys(this.controlCorners)){const f=s.match(/^(top|bottom)(left|right)$/);if(f){const[,g,y]=f,_=this.controlCorners[`${g}${y}`];new i(([{target:A}])=>{_&&(_.style[g]=A.clientHeight+"px")}).observe(this.controlCorners[`${y}${g}`],{childList:!0,attributes:!0})}}}}class d1{constructor(){(0,ut.Z)(this,"container",void 0),(0,ut.Z)(this,"scene",void 0),(0,ut.Z)(this,"mapsService",void 0),(0,ut.Z)(this,"markers",[]),(0,ut.Z)(this,"markerLayers",[]),(0,ut.Z)(this,"unAddMarkers",[]),(0,ut.Z)(this,"unAddMarkerLayers",[])}addMarkerLayer(i){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(i),i.addTo(this.scene)):this.unAddMarkerLayers.push(i)}removeMarkerLayer(i){i.destroy(),this.markerLayers.indexOf(i);const s=this.markerLayers.indexOf(i);s>-1&&this.markerLayers.splice(s,1)}addMarker(i){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(i),i.addTo(this.scene)):this.unAddMarkers.push(i)}addMarkers(){this.unAddMarkers.forEach(i=>{i.addTo(this.scene),this.markers.push(i)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(i=>{this.markerLayers.push(i),i.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(i){i.remove(),this.markers.indexOf(i);const s=this.markers.indexOf(i);s>-1&&this.markers.splice(s,1)}removeAllMarkers(){this.destroy()}init(i){this.scene=i,this.mapsService=i.mapService}destroy(){this.markers.forEach(i=>{i.remove()}),this.markers=[],this.markerLayers.forEach(i=>{i.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(i){i.destroy()}}class lw{constructor(){(0,ut.Z)(this,"scene",void 0),(0,ut.Z)(this,"mapsService",void 0),(0,ut.Z)(this,"popups",[]),(0,ut.Z)(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(i){i!=null&&i.isOpen()&&i.remove();const s=this.popups.indexOf(i);s>-1&&this.popups.splice(s,1);const f=this.unAddPopups.indexOf(i);f>-1&&this.unAddPopups.splice(f,1)}destroy(){this.popups.forEach(i=>i.remove())}addPopup(i){i&&i.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(s=>{s.getOptions().autoClose&&this.removePopup(s)}),this.isMarkerReady?(i.addTo(this.scene),this.popups.push(i)):this.unAddPopups.push(i),i.on("close",()=>{this.removePopup(i)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(i=>{this.addPopup(i),this.unAddPopups=[]})}init(i){this.scene=i,this.mapsService=i.mapService}}var uw={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:h1}=Nr,Wf={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Bs={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Wl.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class qi{constructor(){(0,ut.Z)(this,"sceneConfigCache",{}),(0,ut.Z)(this,"layerConfigCache",{}),(0,ut.Z)(this,"layerAttributeConfigCache",{})}getSceneConfig(i){return this.sceneConfigCache[i]}getSceneWarninfo(i){return uw[i]}setSceneConfig(i,s){this.sceneConfigCache[i]=(0,Je.Z)((0,Je.Z)({},Wf),s)}getLayerConfig(i){return this.layerConfigCache[i]}setLayerConfig(i,s,f){this.layerConfigCache[s]=(0,Je.Z)({},h1({},this.sceneConfigCache[i],Bs,f))}getAttributeConfig(i){return this.layerAttributeConfigCache[i]}setAttributeConfig(i,s){this.layerAttributeConfigCache[i]=(0,Je.Z)((0,Je.Z)({},this.layerAttributeConfigCache[i]),s)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var ts=k(98333);const Hp=Math.PI/180,Vp=512,p1=4003e4;function Wp({latitude:a=0,zoom:i=0,scale:s,highPrecision:f=!1,flipY:g=!1}){s=s!==void 0?s:Math.pow(2,i);const y={},_=Vp*s,O=Math.cos(a*Hp),A=_/360,P=A/O,B=_/p1/O;if(y.pixelsPerMeter=[B,-B,B],y.metersPerPixel=[1/B,-1/B,1/B],y.pixelsPerDegree=[A,-P,B],y.degreesPerPixel=[1/A,-1/P,1/B],f){const U=Hp*Math.tan(a*Hp)/O,G=A*U/2,vt=_/p1*U,$t=vt/P*B;y.pixelsPerDegree2=[0,-G,vt],y.pixelsPerMeter2=[$t,0,$t],g&&(y.pixelsPerDegree2[1]=-y.pixelsPerDegree2[1],y.pixelsPerMeter2[1]=-y.pixelsPerMeter2[1])}return g&&(y.pixelsPerMeter[1]=-y.pixelsPerMeter[1],y.metersPerPixel[1]=-y.metersPerPixel[1],y.pixelsPerDegree[1]=-y.pixelsPerDegree[1],y.degreesPerPixel[1]=-y.degreesPerPixel[1]),y}const Gp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class Ma{constructor(i){(0,ut.Z)(this,"needRefresh",!0),(0,ut.Z)(this,"coordinateSystem",void 0),(0,ut.Z)(this,"viewportCenter",void 0),(0,ut.Z)(this,"viewportCenterProjection",void 0),(0,ut.Z)(this,"pixelsPerDegree",void 0),(0,ut.Z)(this,"pixelsPerDegree2",void 0),(0,ut.Z)(this,"pixelsPerMeter",void 0),this.cameraService=i}refresh(i){const s=this.cameraService.getZoom(),f=i||this.cameraService.getCenter(),{pixelsPerMeter:g,pixelsPerDegree:y}=Wp({latitude:f[1],zoom:s});this.viewportCenter=f,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=g,this.pixelsPerDegree=y,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===jf.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===jf.LNGLAT_OFFSET&&this.calculateLnglatOffset(f,s),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(i){this.coordinateSystem=i}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(i,s,f,g){const{pixelsPerMeter:y,pixelsPerDegree:_,pixelsPerDegree2:O}=Wp({latitude:i[1],zoom:s,scale:f,flipY:g,highPrecision:!0});let A=this.cameraService.getViewMatrix();const P=this.cameraService.getProjectionMatrix();let B=Er.multiply([],P,A);const U=this.cameraService.projectFlat([Math.fround(i[0]),Math.fround(i[1])],Math.pow(2,s));this.viewportCenterProjection=ts.fF([],[U[0],U[1],0,1],B),A=this.cameraService.getViewMatrixUncentered()||A,B=Er.multiply([],P,A),B=Er.multiply([],B,Gp),this.cameraService.setViewProjectionMatrix(B),this.pixelsPerMeter=y,this.pixelsPerDegree=_,this.pixelsPerDegree2=O}}class g1 extends no.EventEmitter{constructor(...i){super(...i),(0,ut.Z)(this,"renderMap",new Map),(0,ut.Z)(this,"enable",!1),(0,ut.Z)(this,"renderEnable",!1),(0,ut.Z)(this,"cacheLogs",{})}setEnable(i){this.enable=!!i}log(i,s){if(!this.enable)return;const f=i.split(".");let g=null;f.forEach((y,_)=>{g!==null?(g[y]||(g[y]={}),_!==f.length-1&&(g=g[y])):(this.cacheLogs[y]||(this.cacheLogs[y]={}),_!==f.length-1&&(g=this.cacheLogs[y])),_===f.length-1&&(g[y]=(0,Je.Z)((0,Je.Z)({time:Date.now()},g[y]),s))})}getLog(i){switch(typeof i){case"string":return this.cacheLogs[i];case"object":return i.map(s=>this.cacheLogs[s]).filter(s=>s!==void 0);case"undefined":return this.cacheLogs}}removeLog(i){delete this.cacheLogs[i]}generateRenderUid(){return this.renderEnable?Qh():""}renderDebug(i){this.renderEnable=i}renderStart(i){if(!this.renderEnable||!this.enable)return;const s=this.renderMap.get(i)||{};this.renderMap.set(i,(0,Je.Z)((0,Je.Z)({},s),{},{renderUid:i,renderStart:Date.now()}))}renderEnd(i){if(!this.renderEnable||!this.enable)return;const s=this.renderMap.get(i);if(s){const f=s.renderStart,g=Date.now();this.emit("renderEnd",(0,Je.Z)((0,Je.Z)({},s),{},{renderEnd:g,renderDuration:g-f})),this.renderMap.delete(i)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var fw=k(50840),ql=k.n(fw);const dw={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class hw extends sy(){get mapService(){return this.container.mapService}constructor(i){super(),(0,ut.Z)(this,"indragging",!1),(0,ut.Z)(this,"hammertime",void 0),(0,ut.Z)(this,"lastClickTime",0),(0,ut.Z)(this,"lastClickXY",[-1,-1]),(0,ut.Z)(this,"clickTimer",void 0),(0,ut.Z)(this,"$containter",void 0),(0,ut.Z)(this,"onDrag",s=>{const f=this.interactionEvent(s);f.type=dw[f.type],f.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(uo.Drag,f)}),(0,ut.Z)(this,"onHammer",s=>{s.srcEvent.stopPropagation();const f=this.interactionEvent(s);this.emit(uo.Hover,f)}),(0,ut.Z)(this,"onTouch",s=>{const f=s.touches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchstart"})}),(0,ut.Z)(this,"onTouchEnd",s=>{if(s.changedTouches.length>0){const f=s.changedTouches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchend"})}}),(0,ut.Z)(this,"onTouchMove",s=>{const f=s.changedTouches[0];this.onHover({clientX:f.clientX,clientY:f.clientY,type:"touchmove"})}),(0,ut.Z)(this,"onHover",s=>{const{clientX:f,clientY:g}=s;let y=f,_=g;const O=s.type,A=this.mapService.getMapContainer();if(A){const{top:B,left:U}=A.getBoundingClientRect();y=y-U-A.clientLeft,_=_-B-A.clientTop}const P=this.mapService.containerToLngLat([y,_]);if(O==="click"){this.isDoubleTap(y,_,P);return}if(O==="touch"){this.isDoubleTap(y,_,P);return}O!=="click"&&O!=="dblclick"&&this.emit(uo.Hover,{x:y,y:_,lngLat:P,type:O,target:s})}),this.container=i}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(uo.Hover)}triggerHover({x:i,y:s}){this.emit(uo.Hover,{x:i,y:s})}triggerSelect(i){this.emit(uo.Select,{featureId:i})}triggerActive(i){this.emit(uo.Active,{featureId:i})}addEventListenerOnMap(){const i=this.mapService.getMapContainer();if(i){const s=new(ql()).Manager(i);s.add(new(ql()).Tap({event:"dblclick",taps:2})),s.add(new(ql()).Tap({event:"click"})),s.add(new(ql()).Pan({threshold:0,pointers:0})),s.add(new(ql()).Press({})),s.on("dblclick click",this.onHammer),s.on("panstart panmove panend pancancel",this.onDrag),i.addEventListener("touchstart",this.onTouch),i.addEventListener("touchend",this.onTouchEnd),i.addEventListener("mousemove",this.onHover),i.addEventListener("touchmove",this.onTouchMove),i.addEventListener("mousedown",this.onHover,!0),i.addEventListener("mouseup",this.onHover),i.addEventListener("contextmenu",this.onHover),this.hammertime=s}}removeEventListenerOnMap(){const i=this.mapService.getMapContainer();i&&(i.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),i.removeEventListener("touchstart",this.onTouch),i.removeEventListener("touchend",this.onTouchEnd),i.removeEventListener("mousedown",this.onHover),i.removeEventListener("mouseup",this.onHover),i.removeEventListener("contextmenu",this.onHover))}interactionEvent(i){const{type:s,pointerType:f}=i;let g,y;f==="touch"?(y=Math.floor(i.pointers[0].clientY),g=Math.floor(i.pointers[0].clientX)):(y=Math.floor(i.srcEvent.y),g=Math.floor(i.srcEvent.x));const _=this.mapService.getMapContainer();if(_){const{top:A,left:P}=_.getBoundingClientRect();g-=P,y-=A}const O=this.mapService.containerToLngLat([g,y]);return{x:g,y,lngLat:O,type:s,target:i.srcEvent}}isDoubleTap(i,s,f){const g=new Date().getTime();let y="click";g-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-i)<10&&Math.abs(this.lastClickXY[1]-s)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),y="dblclick",this.emit(uo.Hover,{x:i,y:s,lngLat:f,type:y})):(this.lastClickTime=g,this.lastClickXY=[i,s],this.clickTimer=setTimeout(()=>{y="click",this.emit(uo.Hover,{x:i,y:s,lngLat:f,type:y})},400))}}let pw=0;function gw(a){let i=a;if(typeof a=="string"&&(i=document.getElementById(a)),i){const s=document.createElement("div");return s.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,s.id=`l7-scene-${pw++}`,s.classList.add("l7-scene"),i.appendChild(s),s}return null}function v1(a){var i;let s=!0;if((a==null||(i=a.target)===null||i===void 0?void 0:i.target)instanceof HTMLElement){var f;let y=a==null||(f=a.target)===null||f===void 0?void 0:f.target;for(;y;){var g;const _=Array.from(y.classList);if(_.includes("l7-marker")||_.includes("l7-popup")){s=!1;break}y=(g=y)===null||g===void 0?void 0:g.parentElement}}return s}let es=function(a){return a[a.SAMPLED=0]="SAMPLED",a[a.RENDER_TARGET=1]="RENDER_TARGET",a}({});class m1{constructor(i){var s=this;(0,ut.Z)(this,"pickedColors",void 0),(0,ut.Z)(this,"pickedTileLayers",[]),(0,ut.Z)(this,"pickingFBO",void 0),(0,ut.Z)(this,"width",0),(0,ut.Z)(this,"height",0),(0,ut.Z)(this,"alreadyInPicking",!1),(0,ut.Z)(this,"pickBufferScale",1),(0,ut.Z)(this,"pickFromPickingFBO",function(){var f=(0,nn.Z)(function*(g,{x:y,y:_,lngLat:O,type:A,target:P}){var B;let U=!1;const{readPixels:G,readPixelsAsync:vt,getViewportSize:$t,queryVerdorInfo:te}=s.rendererService,{width:Te,height:Fe}=$t(),{enableHighlight:Ze,enableSelect:je}=g.getLayerConfig(),Qe=y*so,ln=_*so;if(Qe>Te-1*so||Qe<0||ln>Fe-1*so||ln<0)return!1;let wn;if(te()==="WebGPU"?wn=yield vt({x:Math.floor(Qe/s.pickBufferScale),y:Math.floor((Fe-(_+1)*so)/s.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:s.pickingFBO}):wn=G({x:Math.floor(Qe/s.pickBufferScale),y:Math.floor((Fe-(_+1)*so)/s.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:s.pickingFBO}),s.pickedColors=wn,wn[0]!==0||wn[1]!==0||wn[2]!==0){const Mn=Os(wn),rr=g.layerPickService.getFeatureById(Mn);Mn!==g.getCurrentPickId()&&A==="mousemove"&&(A="mouseenter");const Qn={x:y,y:_,type:A,lngLat:O,featureId:Mn,feature:rr,target:P};rr&&(U=!0,g.setCurrentPickId(Mn),s.triggerHoverOnLayer(g,Qn))}else{const Mn={x:y,y:_,lngLat:O,type:g.getCurrentPickId()!==null&&A==="mousemove"?"mouseout":"un"+A,featureId:null,target:P,feature:null};s.triggerHoverOnLayer(g,(0,Je.Z)((0,Je.Z)({},Mn),{},{type:"unpick"})),s.triggerHoverOnLayer(g,Mn),g.setCurrentPickId(null)}if(Ze&&g.layerPickService.highlightPickedFeature(wn),je&&A==="click"&&((B=wn)===null||B===void 0?void 0:B.toString())!==[0,0,0,0].toString()){const Mn=Os(wn);g.getCurrentSelectedId()===null||Mn!==g.getCurrentSelectedId()?(g.layerPickService.selectFeature(wn),g.setCurrentSelectedId(Mn)):(g.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),g.setCurrentSelectedId(null))}return U});return function(g,y){return f.apply(this,arguments)}}()),this.container=i}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(i){const{createTexture2D:s,createFramebuffer:f,getViewportSize:g}=this.rendererService;let{width:y,height:_}=g();this.pickBufferScale=this.configService.getSceneConfig(i).pickBufferScale||1,y=Math.round(y/this.pickBufferScale),_=Math.round(_/this.pickBufferScale);const O=s({width:y,height:_,usage:es.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=f({color:O,depth:!0,width:y,height:_}),this.interactionService.on(uo.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(i,s,f){var g=this;return(0,nn.Z)(function*(){const{useFramebufferAsync:y,clear:_}=g.rendererService;g.resizePickingFBO(),i.hooks.beforePickingEncode.call(),yield y(g.pickingFBO,(0,nn.Z)(function*(){_({framebuffer:g.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.renderModels({ispick:!0})})),i.hooks.afterPickingEncode.call();const O=yield g.pickBox(i,s);f(O)})()}pickBox(i,s){var f=this;return(0,nn.Z)(function*(){const[g,y,_,O]=s.map(Fe=>{const Ze=Fe<0?0:Fe;return Math.floor(Ze*so/f.pickBufferScale)}),{readPixelsAsync:A,getViewportSize:P}=f.rendererService,{width:B,height:U}=P();if(g>(B-1)*so/f.pickBufferScale||_<0||y>(U-1)*so/f.pickBufferScale||O<0)return[];const G=Math.min(B/f.pickBufferScale,_)-g,vt=Math.min(U/f.pickBufferScale,O)-y,$t=yield A({x:g,y:Math.floor(U/f.pickBufferScale-(O+1)),width:G,height:vt,data:new Uint8Array(G*vt*4),framebuffer:f.pickingFBO}),te=[],Te={};for(let Fe=0;Fe<$t.length/4;Fe=Fe+1){const Ze=$t.slice(Fe*4,Fe*4+4),je=Os(Ze);if(je!==-1&&!Te[je]){const Qe=i.layerPickService.getFeatureById(je);te.push((0,Je.Z)((0,Je.Z)({},Qe),{},{pickedFeatureIdx:je})),Te[je]=!0}}return te})()}handleCursor(i,s){const{cursor:f="",cursorEnabled:g}=i.getLayerConfig();if(g){const _=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),O=_==null?void 0:_.style.getPropertyValue("cursor");s==="unmousemove"&&O!==""?_==null||_.style.setProperty("cursor",""):s==="mousemove"&&(_==null||_.style.setProperty("cursor",f))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(i){var s=this;return(0,nn.Z)(function*(){!s.layerService.needPick(i.type)||!s.isPickingAllLayer()||(s.alreadyInPicking=!0,yield s.pickingLayers(i),s.layerService.renderLayers(),s.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:i}=this.rendererService,{width:s,height:f}=i();(this.width!==s||this.height!==f)&&(this.pickingFBO.resize({width:Math.round(s/this.pickBufferScale),height:Math.round(f/this.pickBufferScale)}),this.width=s,this.height=f)}pickingLayers(i){var s=this;return(0,nn.Z)(function*(){const{clear:f,useFramebufferAsync:g}=s.rendererService;s.resizePickingFBO();const y=s.layerService.getRenderList();for(const _ of y.filter(O=>O.needPick(i.type)).reverse()){yield g(s.pickingFBO,(0,nn.Z)(function*(){f({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),_.layerPickService.pickRender(i)}));const O=yield s.pickFromPickingFBO(_,i);if(s.layerService.pickedLayerId=O?+_.id:-1,O&&!_.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(i,s){v1(s)&&(this.handleCursor(i,s.type),i.emit(s.type,s))}}class y1{constructor(i=!0){(0,ut.Z)(this,"autoStart",void 0),(0,ut.Z)(this,"startTime",0),(0,ut.Z)(this,"oldTime",0),(0,ut.Z)(this,"running",!1),(0,ut.Z)(this,"elapsedTime",0),this.autoStart=i}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let i=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const s=(typeof performance=="undefined"?Date:performance).now();i=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=i}return i}}const{throttle:b1}=Nr;class ra extends no.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(i){super(),(0,ut.Z)(this,"pickedLayerId",-1),(0,ut.Z)(this,"clock",new y1),(0,ut.Z)(this,"alreadyInRendering",!1),(0,ut.Z)(this,"layers",[]),(0,ut.Z)(this,"layerList",[]),(0,ut.Z)(this,"layerRenderID",void 0),(0,ut.Z)(this,"sceneInited",!1),(0,ut.Z)(this,"animateInstanceCount",0),(0,ut.Z)(this,"shaderPicking",!0),(0,ut.Z)(this,"enableRender",!0),(0,ut.Z)(this,"reRender",b1(()=>{this.renderLayers()},32)),(0,ut.Z)(this,"throttleRenderLayers",b1(()=>{this.renderLayers()},16)),this.container=i}needPick(i){return this.updateLayerRenderList(),this.layerList.some(s=>s.needPick(i))}add(i){this.layers.push(i),this.sceneInited&&i.init().then(()=>{this.renderLayers()})}addMask(i){this.sceneInited&&i.init().then(()=>{this.renderLayers()})}initLayers(){var i=this;return(0,nn.Z)(function*(){i.sceneInited=!0,i.layers.forEach(function(){var s=(0,nn.Z)(function*(f){f.startInit||(yield f.init(),i.updateLayerRenderList())});return function(f){return s.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(i){return this.layers.find(s=>s.id===i)}getLayerByName(i){return this.layers.find(s=>s.name===i)}remove(i,s){var f=this;return(0,nn.Z)(function*(){s?s.layerChildren=s.layerChildren.filter(g=>g!==i):f.layers=f.layers.filter(g=>g!==i),i.destroy(),f.reRender(),f.emit("layerChange",f.layers)})()}removeAllLayers(){var i=this;return(0,nn.Z)(function*(){i.destroy(),i.reRender()})()}setEnableRender(i){this.enableRender=i}renderLayers(){var i=this;return(0,nn.Z)(function*(){if(i.alreadyInRendering||!i.enableRender)return;i.updateLayerRenderList();const s=i.debugService.generateRenderUid();i.debugService.renderStart(s),i.alreadyInRendering=!0,i.clear();for(const f of i.layerList)f.prerender();i.renderService.beginFrame();for(const f of i.layerList){const{enableMask:g}=f.getLayerConfig();f.masks.filter(y=>y.inited).length>0&&g&&i.renderMask(f.masks),f.getLayerConfig().enableMultiPassRenderer?yield f.renderMultiPass():f.render()}i.renderService.endFrame(),i.debugService.renderEnd(s),i.alreadyInRendering=!1})()}renderMask(i){let s=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const f=i.length>1?Ds.MULTIPLE:Ds.SINGLE;for(const g of i)g.render({isStencil:!0,stencilType:f,stencilIndex:s++})}beforeRenderData(i){var s=this;return(0,nn.Z)(function*(){(yield i.hooks.beforeRenderData.promise())&&s.renderLayers()})()}renderTileLayerMask(i){let s=0;const{enableMask:f=!0}=i.getLayerConfig();let g=i.tileMask?1:0;const y=i.masks.filter(O=>O.inited);g=g+(f?y.length:1);const _=g>1?Ds.MULTIPLE:Ds.SINGLE;if((i.tileMask||y.length&&f)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),y.length&&f)for(const O of y)O.render({isStencil:!0,stencilType:_,stencilIndex:s++});i.tileMask&&i.tileMask.render({isStencil:!0,stencilType:_,stencilIndex:s++,stencilOperation:Wl.OR})}renderTileLayer(i){var s=this;return(0,nn.Z)(function*(){s.renderTileLayerMask(i),i.getLayerConfig().enableMultiPassRenderer?yield i.renderMultiPass():yield i.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(i=>i.inited).filter(i=>i.isVisible()).sort((i,s)=>i.zIndex-s.zIndex).forEach(i=>{this.layerList.push(i)})}destroy(){this.layers.forEach(i=>{i.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const i=Lr(this.mapService.bgColor);this.renderService.clear({color:i,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var ia=k(45987);const{isNil:vw}=Nr;class _1{constructor(i){(0,ut.Z)(this,"name",void 0),(0,ut.Z)(this,"type",void 0),(0,ut.Z)(this,"scale",void 0),(0,ut.Z)(this,"descriptor",void 0),(0,ut.Z)(this,"featureBufferLayout",[]),(0,ut.Z)(this,"needRescale",!1),(0,ut.Z)(this,"needRemapping",!1),(0,ut.Z)(this,"needRegenerateVertices",!1),(0,ut.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,ut.Z)(this,"vertexAttribute",void 0),(0,ut.Z)(this,"defaultCallback",s=>{if(s.length===0){var f;return((f=this.scale)===null||f===void 0?void 0:f.defaultValues)||[]}return s.map((g,y)=>{var _;return((_=this.scale)===null||_===void 0?void 0:_.scalers[y].func)(g)})}),this.setProps(i)}setProps(i){Object.assign(this,i)}mapping(i){var s;if((s=this.scale)!==null&&s!==void 0&&s.callback){var f;const g=(f=this.scale)===null||f===void 0?void 0:f.callback(...i);if(!vw(g))return[g]}return this.defaultCallback(i)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const mw=["buffer","update","name"],Gf=["buffer","update","name"],x1={[at.FLOAT]:4,[at.UNSIGNED_BYTE]:1,[at.UNSIGNED_SHORT]:2};class S1{constructor(i){(0,ut.Z)(this,"attributesAndIndices",void 0),(0,ut.Z)(this,"attributes",[]),(0,ut.Z)(this,"triangulation",void 0),(0,ut.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=i}registerStyleAttribute(i){let s=this.getLayerStyleAttribute(i.name||"");return s?s.setProps(i):(s=new _1(i),this.attributes.push(s)),s}unRegisterStyleAttribute(i){const s=this.attributes.findIndex(f=>f.name===i);s>-1&&this.attributes.splice(s,1)}updateScaleAttribute(i){this.attributes.forEach(s=>{var f;const g=s.name,y=(f=s.scale)===null||f===void 0?void 0:f.field;(i[g]||y&&i[y])&&(s.needRescale=!0,s.needRemapping=!0,s.needRegenerateVertices=!0)})}updateStyleAttribute(i,s,f){let g=this.getLayerStyleAttribute(i);g||(g=this.registerStyleAttribute((0,Je.Z)((0,Je.Z)({},s),{},{name:i})));const{scale:y}=s;y&&g&&(g.scale=y,g.needRescale=!0,g.needRemapping=!0,g.needRegenerateVertices=!0,f&&f.featureRange&&(g.featureRange=f.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(i){return this.attributes.find(s=>s.name===i)}getLayerAttributeScale(i){var s;const f=this.getLayerStyleAttribute(i),g=f==null||(s=f.scale)===null||s===void 0?void 0:s.scalers;return g&&g[0]?g[0].func:null}updateAttributeByFeatureRange(i,s,f=0,g,y){const _=this.attributes.find(O=>O.name===i);if(_&&_.descriptor){const{descriptor:O}=_,{update:A,buffer:P,size:B=0}=O,U=x1[P.type||at.FLOAT];if(A){const{elements:G,sizePerElement:vt}=this.featureLayout,$t=G.slice(f,g);if(!$t.length)return;const{offset:te}=$t[0],Te=te*B*U,Fe=$t.map(({featureIdx:Ze,vertices:je,normals:Qe},ln)=>{const wn=je.length/vt,mn=[];for(let Mn=0;Mn<wn;Mn++){const rr=Qe?Qe.slice(Mn*3,Mn*3+3):[];mn.push(...A(s[Ze],Ze,je.slice(Mn*vt,Mn*vt+vt),ln,rr))}return mn}).flat();_.vertexAttribute.updateBuffer({data:Fe,offset:Te}),y==null||y.emit(`legend:${i}`,y.getLegend(i))}}}createAttributesAndIndices(i,s,f,g){this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);const y=this.attributes.map(te=>(te.resetDescriptor(),te.descriptor));let _=0,O=0;const A=[];let P=3;i.forEach((te,Te)=>{const{indices:Fe,vertices:Ze,normals:je,size:Qe,indexes:ln,count:wn}=this.triangulation(te,f);typeof wn=="number"&&(O+=wn),Fe.forEach(Mn=>{A.push(Mn+_)}),P=Qe;const mn=Ze.length/Qe;this.featureLayout.sizePerElement=P,this.featureLayout.elements.push({featureIdx:Te,vertices:Ze,normals:je,offset:_}),_+=mn;for(let Mn=0;Mn<mn;Mn++){const rr=(je==null?void 0:je.slice(Mn*3,Mn*3+3))||[],Qn=Ze.slice(Mn*Qe,Mn*Qe+Qe);let Yn=0;ln&&ln[Mn]!==void 0&&(Yn=ln[Mn]),y.forEach((lr,Rr)=>{lr&&lr.update&&lr.buffer.data.push(...lr.update(te,Te,Qn,Mn,rr,Yn))})}});const{createAttribute:B,createBuffer:U,createElements:G}=this.rendererService,vt={};y.forEach((te,Te)=>{if(te){const{buffer:Fe,update:Ze,name:je}=te,Qe=(0,ia.Z)(te,mw),ln=B((0,Je.Z)({buffer:U(Fe)},Qe));vt[te.name||""]=ln,this.attributes[Te].vertexAttribute=ln}});const $t=G({data:A,type:at.UNSIGNED_INT,count:A.length});return this.attributesAndIndices={attributes:vt,elements:$t,count:O},Object.values(this.attributes).filter(te=>te.scale).forEach(te=>{const Te=te.name;g==null||g.emit(`legend:${Te}`,g.getLegend(Te))}),this.attributesAndIndices}createAttributes(i,s){this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);const f=this.attributes.map(B=>(B.resetDescriptor(),B.descriptor));let g=0;const y=[];let _=3;i.forEach((B,U)=>{const{indices:G,vertices:vt,normals:$t,size:te,indexes:Te}=this.triangulation(B);G.forEach(Ze=>{y.push(Ze+g)}),_=te;const Fe=vt.length/te;this.featureLayout.sizePerElement=_,this.featureLayout.elements.push({featureIdx:U,vertices:vt,normals:$t,offset:g}),g+=Fe;for(let Ze=0;Ze<Fe;Ze++){const je=($t==null?void 0:$t.slice(Ze*3,Ze*3+3))||[],Qe=vt.slice(Ze*te,Ze*te+te);let ln=0;Te&&Te[Ze]!==void 0&&(ln=Te[Ze]),f.forEach((wn,mn)=>{wn&&wn.update&&wn.buffer.data.push(...wn.update(B,U,Qe,Ze,je,ln))})}});const{createAttribute:O,createBuffer:A}=this.rendererService,P={};return f.forEach((B,U)=>{if(B){const{buffer:G,update:vt,name:$t}=B,te=(0,ia.Z)(B,Gf),Te=O((0,Je.Z)({buffer:A(G)},te));P[B.name||""]=Te,this.attributes[U].vertexAttribute=Te}}),{attributes:P}}clearAllAttributes(){var i;this.attributes.forEach(s=>{s.vertexAttribute&&s.vertexAttribute.destroy()}),(i=this.attributesAndIndices)===null||i===void 0||i.elements.destroy(),this.attributes=[]}}var Yf=k(34155);function Yp(a,i,s,f){function g(y){return y instanceof s?y:new s(function(_){_(y)})}return new(s||(s=Promise))(function(y,_){function O(B){try{P(f.next(B))}catch(U){_(U)}}function A(B){try{P(f.throw(B))}catch(U){_(U)}}function P(B){B.done?y(B.value):g(B.value).then(O,A)}P((f=f.apply(a,i||[])).next())})}function $p(a,i){var s={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},f,g,y,_;return _={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function O(P){return function(B){return A([P,B])}}function A(P){if(f)throw new TypeError("Generator is already executing.");for(;s;)try{if(f=1,g&&(y=P[0]&2?g.return:P[0]?g.throw||((y=g.return)&&y.call(g),0):g.next)&&!(y=y.call(g,P[1])).done)return y;switch(g=0,y&&(P=[P[0]&2,y.value]),P[0]){case 0:case 1:y=P;break;case 4:return s.label++,{value:P[1],done:!1};case 5:s.label++,g=P[1],P=[0];continue;case 7:P=s.ops.pop(),s.trys.pop();continue;default:if(y=s.trys,!(y=y.length>0&&y[y.length-1])&&(P[0]===6||P[0]===2)){s=0;continue}if(P[0]===3&&(!y||P[1]>y[0]&&P[1]<y[3])){s.label=P[1];break}if(P[0]===6&&s.label<y[1]){s.label=y[1],y=P;break}if(y&&s.label<y[2]){s.label=y[2],s.ops.push(P);break}y[2]&&s.ops.pop(),s.trys.pop();continue}P=i.call(a,s)}catch(B){P=[6,B],g=0}finally{f=y=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}function $f(a,i){var s=typeof Symbol=="function"&&a[Symbol.iterator];if(!s)return a;var f=s.call(a),g,y=[],_;try{for(;(i===void 0||i-- >0)&&!(g=f.next()).done;)y.push(g.value)}catch(O){_={error:O}}finally{try{g&&!g.done&&(s=f.return)&&s.call(f)}finally{if(_)throw _.error}}return y}function Kl(a,i,s){if(s||arguments.length===2)for(var f=0,g=i.length,y;f<g;f++)(y||!(f in i))&&(y||(y=Array.prototype.slice.call(i,0,f)),y[f]=i[f]);return a.concat(y||Array.prototype.slice.call(i))}function Xp(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var qp={exports:{}},Xf={exports:{}},Ql={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){return f&&typeof f.length=="number"&&f.length>=0&&f.length%1===0}a.exports=i.default})(Ql,Ql.exports);var fo={},Kp={exports:{}},Qp={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(s){return function(){for(var f=[],g=arguments.length;g--;)f[g]=arguments[g];var y=f.pop();return s.call(this,f,y)}},a.exports=i.default})(Qp,Qp.exports);var ns={};Object.defineProperty(ns,"__esModule",{value:!0}),ns.fallback=La,ns.wrap=Jp;var yw=ns.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,bw=ns.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,O1=ns.hasNextTick=typeof Yf=="object"&&typeof Yf.nextTick=="function";function La(a){setTimeout(a,0)}function Jp(a){return function(i){for(var s=[],f=arguments.length-1;f-- >0;)s[f]=arguments[f+1];return a(function(){return i.apply(void 0,s)})}}var Jl;yw?Jl=queueMicrotask:bw?Jl=setImmediate:O1?Jl=Yf.nextTick:Jl=La,ns.default=Jp(Jl),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=A;var s=Qp.exports,f=O(s),g=ns,y=O(g),_=fo;function O(U){return U&&U.__esModule?U:{default:U}}function A(U){return(0,_.isAsync)(U)?function(){for(var G=[],vt=arguments.length;vt--;)G[vt]=arguments[vt];var $t=G.pop(),te=U.apply(this,G);return P(te,$t)}:(0,f.default)(function(G,vt){var $t;try{$t=U.apply(this,G)}catch(te){return vt(te)}if($t&&typeof $t.then=="function")return P($t,vt);vt(null,$t)})}function P(U,G){return U.then(function(vt){B(G,null,vt)},function(vt){B(G,vt&&vt.message?vt:new Error(vt))})}function B(U,G,vt){try{U(G,vt)}catch($t){(0,y.default)(function(te){throw te},$t)}}a.exports=i.default}(Kp,Kp.exports),Object.defineProperty(fo,"__esModule",{value:!0}),fo.isAsyncIterable=fo.isAsyncGenerator=fo.isAsync=void 0;var _w=Kp.exports,xw=E1(_w);function E1(a){return a&&a.__esModule?a:{default:a}}function tu(a){return a[Symbol.toStringTag]==="AsyncFunction"}function FL(a){return a[Symbol.toStringTag]==="AsyncGenerator"}function NL(a){return typeof a[Symbol.asyncIterator]=="function"}function BL(a){if(typeof a!="function")throw new Error("expected a function");return tu(a)?(0,xw.default)(a):a}fo.default=BL,fo.isAsync=tu,fo.isAsyncGenerator=FL,fo.isAsyncIterable=NL;var Ic={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f,g){if(g===void 0&&(g=f.length),!g)throw new Error("arity is undefined");function y(){for(var _=this,O=[],A=arguments.length;A--;)O[A]=arguments[A];return typeof O[g-1]=="function"?f.apply(this,O):new Promise(function(P,B){O[g-1]=function(U){for(var G=[],vt=arguments.length-1;vt-- >0;)G[vt]=arguments[vt+1];if(U)return B(U);P(G.length>1?G:G[0])},f.apply(_,O)})}return y}a.exports=i.default})(Ic,Ic.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=Ql.exports,f=A(s),g=fo,y=A(g),_=Ic.exports,O=A(_);function A(P){return P&&P.__esModule?P:{default:P}}i.default=(0,O.default)(function(P,B,U){var G=(0,f.default)(B)?[]:{};P(B,function(vt,$t,te){(0,y.default)(vt)(function(Te){for(var Fe,Ze=[],je=arguments.length-1;je-- >0;)Ze[je]=arguments[je+1];Ze.length<2&&(Fe=Ze,Ze=Fe[0]),G[$t]=Ze,te(Te)})},function(vt){return U(vt,G)})},3),a.exports=i.default}(Xf,Xf.exports);var w1={exports:{}},t0={exports:{}},A1={exports:{}},rs={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){function g(){for(var y=[],_=arguments.length;_--;)y[_]=arguments[_];if(f!==null){var O=f;f=null,O.apply(this,y)}}return Object.assign(g,f),g}a.exports=i.default})(rs,rs.exports);var e0={exports:{}},eu={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(s){return s[Symbol.iterator]&&s[Symbol.iterator]()},a.exports=i.default})(eu,eu.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=B;var s=Ql.exports,f=_(s),g=eu.exports,y=_(g);function _(U){return U&&U.__esModule?U:{default:U}}function O(U){var G=-1,vt=U.length;return function(){return++G<vt?{value:U[G],key:G}:null}}function A(U){var G=-1;return function(){var $t=U.next();return $t.done?null:(G++,{value:$t.value,key:G})}}function P(U){var G=U?Object.keys(U):[],vt=-1,$t=G.length;return function te(){var Te=G[++vt];return Te==="__proto__"?te():vt<$t?{value:U[Te],key:Te}:null}}function B(U){if((0,f.default)(U))return O(U);var G=(0,y.default)(U);return G?A(G):P(U)}a.exports=i.default}(e0,e0.exports);var nu={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=s;function s(f){return function(){for(var g=[],y=arguments.length;y--;)g[y]=arguments[y];if(f===null)throw new Error("Callback was already called.");var _=f;f=null,_.apply(this,g)}}a.exports=i.default})(nu,nu.exports);var qf={exports:{}},Rc={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s={};i.default=s,a.exports=i.default})(Rc,Rc.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=y;var s=Rc.exports,f=g(s);function g(_){return _&&_.__esModule?_:{default:_}}function y(_,O,A,P){var B=!1,U=!1,G=!1,vt=0,$t=0;function te(){vt>=O||G||B||(G=!0,_.next().then(function(Ze){var je=Ze.value,Qe=Ze.done;if(!(U||B)){if(G=!1,Qe){B=!0,vt<=0&&P(null);return}vt++,A(je,$t,Te),$t++,te()}}).catch(Fe))}function Te(Ze,je){if(vt-=1,!U){if(Ze)return Fe(Ze);if(Ze===!1){B=!0,U=!0;return}if(je===f.default||B&&vt<=0)return B=!0,P(null);te()}}function Fe(Ze){U||(G=!1,B=!0,P(Ze))}te()}a.exports=i.default}(qf,qf.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=rs.exports,f=vt(s),g=e0.exports,y=vt(g),_=nu.exports,O=vt(_),A=fo,P=qf.exports,B=vt(P),U=Rc.exports,G=vt(U);function vt($t){return $t&&$t.__esModule?$t:{default:$t}}i.default=function($t){return function(te,Te,Fe){if(Fe=(0,f.default)(Fe),$t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!te)return Fe(null);if((0,A.isAsyncGenerator)(te))return(0,B.default)(te,$t,Te,Fe);if((0,A.isAsyncIterable)(te))return(0,B.default)(te[Symbol.asyncIterator](),$t,Te,Fe);var Ze=(0,y.default)(te),je=!1,Qe=!1,ln=0,wn=!1;function mn(rr,Qn){if(!Qe)if(ln-=1,rr)je=!0,Fe(rr);else if(rr===!1)je=!0,Qe=!0;else{if(Qn===G.default||je&&ln<=0)return je=!0,Fe(null);wn||Mn()}}function Mn(){for(wn=!0;ln<$t&&!je;){var rr=Ze();if(rr===null){je=!0,ln<=0&&Fe(null);return}ln+=1,Te(rr.value,rr.key,(0,O.default)(mn))}wn=!1}Mn()}},a.exports=i.default}(A1,A1.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=A1.exports,f=A(s),g=fo,y=A(g),_=Ic.exports,O=A(_);function A(B){return B&&B.__esModule?B:{default:B}}function P(B,U,G,vt){return(0,f.default)(U)(B,(0,y.default)(G),vt)}i.default=(0,O.default)(P,4),a.exports=i.default}(t0,t0.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=t0.exports,f=_(s),g=Ic.exports,y=_(g);function _(A){return A&&A.__esModule?A:{default:A}}function O(A,P,B){return(0,f.default)(A,1,P,B)}i.default=(0,y.default)(O,3),a.exports=i.default}(w1,w1.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=O;var s=Xf.exports,f=_(s),g=w1.exports,y=_(g);function _(A){return A&&A.__esModule?A:{default:A}}function O(A,P){return(0,f.default)(y.default,A,P)}a.exports=i.default}(qp,qp.exports);var ru=Xp(qp.exports),Li=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.call=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,ru(this.tasks)},a.prototype.tap=function(i,s){var f=this;this.tasks.push(function(g){s.apply(void 0,Kl([],$f(f.args),!1)),g(null,i)})},a}(),oa={exports:{}},n0={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=Ql.exports,f=Te(s),g=Rc.exports,y=Te(g),_=t0.exports,O=Te(_),A=rs.exports,P=Te(A),B=nu.exports,U=Te(B),G=fo,vt=Te(G),$t=Ic.exports,te=Te($t);function Te(Qe){return Qe&&Qe.__esModule?Qe:{default:Qe}}function Fe(Qe,ln,wn){wn=(0,P.default)(wn);var mn=0,Mn=0,rr=Qe.length,Qn=!1;rr===0&&wn(null);function Yn(lr,Rr){lr===!1&&(Qn=!0),Qn!==!0&&(lr?wn(lr):(++Mn===rr||Rr===y.default)&&wn(null))}for(;mn<rr;mn++)ln(Qe[mn],mn,(0,U.default)(Yn))}function Ze(Qe,ln,wn){return(0,O.default)(Qe,1/0,ln,wn)}function je(Qe,ln,wn){var mn=(0,f.default)(Qe)?Fe:Ze;return mn(Qe,(0,vt.default)(ln),wn)}i.default=(0,te.default)(je,3),a.exports=i.default})(n0,n0.exports),function(a,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=O;var s=n0.exports,f=_(s),g=Xf.exports,y=_(g);function _(A){return A&&A.__esModule?A:{default:A}}function O(A,P){return(0,y.default)(f.default,A,P)}a.exports=i.default}(oa,oa.exports);var T1=Xp(oa.exports),Sw=function(){function a(){this.tasks=[]}return a.prototype.promise=function(){return T1(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(g){return Yp(f,void 0,void 0,function(){return $p(this,function(y){switch(y.label){case 0:return[4,s()];case 1:return y.sent(),g(null,i),[2]}})})})},a}(),r0={exports:{}};(function(a,i){Object.defineProperty(i,"__esModule",{value:!0});var s=rs.exports,f=B(s),g=nu.exports,y=B(g),_=fo,O=B(_),A=Ic.exports,P=B(A);function B(G){return G&&G.__esModule?G:{default:G}}function U(G,vt){if(vt=(0,f.default)(vt),!Array.isArray(G))return vt(new Error("First argument to waterfall must be an array of functions"));if(!G.length)return vt();var $t=0;function te(Fe){var Ze=(0,O.default)(G[$t++]);Ze.apply(void 0,Fe.concat([(0,y.default)(Te)]))}function Te(Fe){for(var Ze=[],je=arguments.length-1;je-- >0;)Ze[je]=arguments[je+1];if(Fe!==!1){if(Fe||$t===G.length)return vt.apply(void 0,[Fe].concat(Ze));te(Ze)}}te([])}i.default=(0,P.default)(U),a.exports=i.default})(r0,r0.exports);var C1=Xp(r0.exports),jL=function(){function a(){this.tasks=[]}return a.prototype.call=function(){return C1(this.tasks)},a.prototype.tap=function(i,s){this.tasks.length===0?this.tasks.push(function(f){var g=s();f(g?null:!1,g)}):this.tasks.push(function(f,g){var y=s.apply(void 0,Kl([],$f(f),!1));g(y?null:!1,i)})},a}(),M1=function(){function a(){this.tasks=[]}return a.prototype.call=function(){return ru(this.tasks)},a.prototype.tap=function(i,s){this.tasks.push(function(f){var g=s();f(g,i)})},a}(),Ow=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.promise=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,ru(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(g){return Yp(f,void 0,void 0,function(){return $p(this,function(y){switch(y.label){case 0:return[4,s.apply(void 0,Kl([],$f(this.args),!1))];case 1:return y.sent(),g(null,i),[2]}})})})},a}(),Ew=function(){function a(){this.args=[],this.tasks=[]}return a.prototype.promise=function(){for(var i=arguments,s=[],f=0;f<arguments.length;f++)s[f]=i[f];return this.args=s,ru(this.tasks)},a.prototype.tapPromise=function(i,s){var f=this;this.tasks.push(function(g){return Yp(f,void 0,void 0,function(){var y;return $p(this,function(_){switch(_.label){case 0:return[4,s.apply(void 0,Kl([],$f(this.args),!1))];case 1:return y=_.sent(),g(y,i),[2]}})})})},a}(),ww=function(){function a(){this.tasks=[]}return a.prototype.promise=function(){return C1(this.tasks)},a.prototype.tapPromise=function(i,s){this.tasks.length===0?this.tasks.push(function(f){s().then(function(g){f(null,g)})}):this.tasks.push(function(f,g){s(f).then(function(y){g(null,y)})})},a}(),L1=k(63844),Aw=k.n(L1);class Tw extends no.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(i){super(),(0,ut.Z)(this,"destroyed",!1),(0,ut.Z)(this,"loaded",!1),(0,ut.Z)(this,"id",void 0),(0,ut.Z)(this,"inited",!1),(0,ut.Z)(this,"rendering",!1),(0,ut.Z)(this,"$container",void 0),(0,ut.Z)(this,"canvas",void 0),(0,ut.Z)(this,"markerContainer",void 0),(0,ut.Z)(this,"resizeDetector",void 0),(0,ut.Z)(this,"hooks",void 0),(0,ut.Z)(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),(0,ut.Z)(this,"handleMapCameraChanged",s=>{this.cameraService.update(s),this.render()}),this.container=i,this.hooks={init:new Ow},this.id=i.id}init(i){var s=this;this.configService.setSceneConfig(this.id,i),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,nn.Z)(function*(){s.debugService.log("map.mapInitStart",{type:s.map.version}),yield new Promise(f=>{s.map.onCameraChanged(g=>{s.cameraService.init(),s.cameraService.update(g),f()}),s.map.init()}),s.map.onCameraChanged(s.handleMapCameraChanged),s.map.addMarkerContainer(),s.markerService.addMarkers(),s.markerService.addMarkerLayers(),s.popupService.initPopup(),s.interactionService.init(),s.interactionService.on(uo.Drag,s.addSceneEvent.bind(s))})),this.hooks.init.tapPromise("initRenderer",(0,nn.Z)(function*(){var f;const g=((f=s.map)===null||f===void 0?void 0:f.getOverlayContainer())||void 0;if(g?s.$container=g:s.$container=gw(s.configService.getSceneConfig(s.id).id||""),s.$container){const{canvas:_}=i;if(s.canvas=_||Fi("canvas","",s.$container),s.setCanvas(),yield s.rendererService.init(s.canvas,s.configService.getSceneConfig(s.id),i.gl),s.registerContextLost(),s.initContainer(),s.resizeDetector=Aw()({strategy:"scroll"}),s.resizeDetector.listenTo(s.$container,s.handleWindowResized),window.matchMedia){var y;(y=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||y===void 0||y.addListener(s.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");s.pickingService.init(s.id)})),this.render()}registerContextLost(){const i=this.rendererService.getCanvas();i&&i.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(i){this.layerService.sceneService=this,this.layerService.add(i)}addMask(i){this.layerService.sceneService=this,this.layerService.addMask(i)}render(){var i=this;return(0,nn.Z)(function*(){i.rendering||i.destroyed||(i.rendering=!0,i.inited?(yield i.layerService.initLayers(),yield i.layerService.renderLayers()):(yield i.hooks.init.promise(),i.destroyed&&i.destroy(),yield i.layerService.initLayers(),i.layerService.renderLayers(),i.controlService.addControls(),i.loaded=!0,i.emit("loaded"),i.inited=!0),i.rendering=!1)})()}addFontFace(i,s){this.fontService.addFontFace(i,s)}getSceneContainer(){return this.$container}exportPng(i){var s=this;return(0,nn.Z)(function*(){var f;const g=(f=s.$container)===null||f===void 0?void 0:f.getElementsByTagName("canvas")[0];return yield s.render(),i==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const i=this.$container.parentElement;i!==null&&(this.markerContainer=Fi("div","l7-marker-container",i))}getMarkerContainer(){return this.markerContainer}destroy(){var i;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var s;(s=this.$container)===null||s===void 0||s.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(i=this.$container)===null||i===void 0||(i=i.parentNode)===null||i===void 0||i.removeChild(this.$container),this.emit("destroy")}initContainer(){var i,s;const f=so,g=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,_=this.canvas;_&&(_.width=g*f,_.height=y*f),this.rendererService.viewport({x:0,y:0,width:f*g,height:f*y})}setCanvas(){var i,s;const f=so,g=((i=this.$container)===null||i===void 0?void 0:i.clientWidth)||400,y=((s=this.$container)===null||s===void 0?void 0:s.clientHeight)||300,_=this.canvas;_.width=g*f,_.height=y*f,_.style.width="100%",_.style.height="100%"}addSceneEvent(i){this.emit(i.type,i)}}const{uniq:Cw}=Nr,P1="#define PI 3.14159265359",I1=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Mw=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Lw=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Pw=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Iw=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,R1=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,Rw=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,k1=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,kw=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,D1=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,wr=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,F1=/precision\s+(high|low|medium)p\s+float/,N1=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,B1=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,j1=/void\s+main\s*\([^)]*\)\s*\{\n?/;class Dw{constructor(){(0,ut.Z)(this,"moduleCache",{}),(0,ut.Z)(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:P1,fs:P1}),this.registerModule("decode",{vs:Mw,fs:""}),this.registerModule("scene_uniforms",{vs:D1,fs:D1}),this.registerModule("picking_uniforms",{vs:R1,fs:R1}),this.registerModule("projection",{vs:k1,fs:k1}),this.registerModule("project",{vs:Rw,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:wr}),this.registerModule("lighting",{vs:Lw,fs:""}),this.registerModule("light",{vs:I1,fs:""}),this.registerModule("picking",{vs:Iw,fs:Pw}),this.registerModule("rotation_2d",{vs:kw,fs:""})}registerModule(i,s){s.vs=s.vs.replace(/\r\n/g,`
`),s.fs=s.fs.replace(/\r\n/g,`
`);const{vs:f,fs:g,uniforms:y,defines:_,inject:O}=s,{content:A,uniforms:P}=Zl(f),{content:B,uniforms:U}=Zl(g);this.rawContentCache[i]={fs:B,defines:_,inject:O,uniforms:(0,Je.Z)((0,Je.Z)((0,Je.Z)({},P),U),y),vs:A}}getModule(i){let s=this.rawContentCache[i].vs,f=this.rawContentCache[i].fs;const{defines:g={},inject:y={}}=this.rawContentCache[i];let _={};y["vs:#decl"]&&(s=y["vs:#decl"]+s,_=Zl(y["vs:#decl"]).uniforms),y["vs:#main-start"]&&(s=s.replace(j1,te=>te+y["vs:#main-start"])),y["fs:#decl"]&&(f=y["fs:#decl"]+f),s=Fw(g)+s;const{content:A,includeList:P}=this.processModule(s,[],"vs"),{content:B,includeList:U}=this.processModule(f,[],"fs"),G=Cw(P.concat(U).concat(i)).reduce((te,Te)=>(0,Je.Z)((0,Je.Z)({},te),this.rawContentCache[Te].uniforms),(0,Je.Z)({},_)),vt=(F1.test(B)?"":N1)+A,$t=(F1.test(B)?"":N1)+B;return this.moduleCache[i]={vs:vt.trim(),fs:$t.trim(),uniforms:G},this.moduleCache[i]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(i,s,f){return{content:i.replace(B1,(y,_)=>{const A=_.split(" ")[0].replace(/"/g,"");if(s.indexOf(A)>-1)return"";const P=this.rawContentCache[A][f];s.push(A);const{content:B}=this.processModule(P,s,f);return B}),includeList:s}}}function Fw(a){return Object.keys(a).reduce((s,f)=>s+`#define ${f.toUpperCase()} ${a[f]}
`,`
`)}class z1{constructor(){(0,ut.Z)(this,"shaderModuleService",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"cameraService",void 0),(0,ut.Z)(this,"mapService",void 0),(0,ut.Z)(this,"interactionService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"config",void 0)}getName(){return""}getType(){return zl.Normal}init(i,s){this.config=s,this.rendererService=i.getContainer().rendererService,this.cameraService=i.getContainer().cameraService,this.mapService=i.getContainer().mapService,this.interactionService=i.getContainer().interactionService,this.layerService=i.getContainer().layerService,this.shaderModuleService=i.getContainer().shaderModuleService}render(i){}}class Nw extends z1{getName(){return"clear"}init(i,s){super.init(i,s)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class aa{constructor(i){(0,ut.Z)(this,"passes",[]),(0,ut.Z)(this,"layer",void 0),(0,ut.Z)(this,"renderFlag",void 0),(0,ut.Z)(this,"width",0),(0,ut.Z)(this,"height",0),this.postProcessor=i}setLayer(i){this.layer=i}setRenderFlag(i){this.renderFlag=i}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var i=this;return(0,nn.Z)(function*(){for(const s of i.passes)yield s.render(i.layer);yield i.postProcessor.render(i.layer)})()}resize(i,s){(this.width!==i||this.height!==s)&&(this.postProcessor.resize(i,s),this.width=i,this.height=s)}add(i,s){i.getType()===zl.PostProcessing?this.postProcessor.add(i,this.layer,s):(i.init(this.layer,s),this.passes.push(i))}insert(i,s,f){i.init(this.layer,s),this.passes.splice(f,0,i)}destroy(){this.passes.length=0}}class iu extends z1{constructor(...i){var s;super(...i),s=this,(0,ut.Z)(this,"pickingFBO",void 0),(0,ut.Z)(this,"layer",void 0),(0,ut.Z)(this,"width",0),(0,ut.Z)(this,"height",0),(0,ut.Z)(this,"alreadyInRendering",!1),(0,ut.Z)(this,"pickFromPickingFBO",({x:f,y:g,lngLat:y,type:_})=>{if(!this.layer.isVisible()||!this.layer.needPick(_))return;const{getViewportSize:O,readPixelsAsync:A,useFramebuffer:P}=this.rendererService,{width:B,height:U}=O(),{enableHighlight:G,enableSelect:vt}=this.layer.getLayerConfig(),$t=f*so,te=g*so;if($t>B||$t<0||te>U||te<0)return;let Te;P(this.pickingFBO,(0,nn.Z)(function*(){var Fe;if(Te=yield A({x:Math.round($t),y:Math.round(U-(g+1)*so),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:s.pickingFBO}),Te[0]!==0||Te[1]!==0||Te[2]!==0){const Ze=Os(Te),je=s.layer.getSource().getFeatureById(Ze),Qe={x:f,y:g,type:_,lngLat:y,featureId:Ze,feature:je};je&&(s.layer.setCurrentPickId(Ze),s.triggerHoverOnLayer(Qe))}else{const Ze={x:f,y:g,lngLat:y,type:s.layer.getCurrentPickId()===null?"un"+_:"mouseout",featureId:null,feature:null};s.triggerHoverOnLayer((0,Je.Z)((0,Je.Z)({},Ze),{},{type:"unpick"})),s.triggerHoverOnLayer(Ze),s.layer.setCurrentPickId(null)}G&&s.highlightPickedFeature(Te),vt&&_==="click"&&((Fe=Te)===null||Fe===void 0?void 0:Fe.toString())!==[0,0,0,0].toString()&&s.selectFeature(Te)}))})}getType(){return zl.Normal}getName(){return"pixelPicking"}init(i,s){super.init(i,s),this.layer=i;const{createTexture2D:f,createFramebuffer:g,getViewportSize:y}=this.rendererService,{width:_,height:O}=y(),A=f({width:_,height:O,wrapS:at.CLAMP_TO_EDGE,wrapT:at.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=g({color:A}),this.interactionService.on(uo.Hover,this.pickFromPickingFBO),this.interactionService.on(uo.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(uo.Active,this.highlightFeatureHandle.bind(this))}render(i){if(this.alreadyInRendering)return;const{getViewportSize:s,useFramebuffer:f,clear:g}=this.rendererService,{width:y,height:_}=s();this.alreadyInRendering=!0,(this.width!==y||this.height!==_)&&(this.pickingFBO.resize({width:y,height:_}),this.width=y,this.height=_),f(this.pickingFBO,()=>{g({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const O=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),i.hooks.beforePickingEncode.call(),i.render(),i.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(O),this.alreadyInRendering=!1})}triggerHoverOnLayer(i){this.layer.emit(i.type,i)}highlightPickedFeature(i){const[s,f,g]=i;this.layer.hooks.beforeHighlight.call([s,f,g]),this.layerService.renderLayers()}selectFeature(i){const[s,f,g]=i;this.layer.hooks.beforeSelect.call([s,f,g]),this.layerService.renderLayers()}selectFeatureHandle({featureId:i}){const s=_c(i);this.selectFeature(new Uint8Array(s))}highlightFeatureHandle({featureId:i}){const s=_c(i);this.highlightPickedFeature(new Uint8Array(s))}}class U1{constructor(i){(0,ut.Z)(this,"passes",[]),(0,ut.Z)(this,"readFBO",void 0),(0,ut.Z)(this,"writeFBO",void 0),this.rendererService=i,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:i,createTexture2D:s}=this.rendererService,{width:f,height:g}=i();return s({x:0,y:0,width:f,height:g,copy:!0})}getReadFBOTex(){var i=this;const{useFramebuffer:s}=this.rendererService;return new Promise(f=>{s(this.readFBO,(0,nn.Z)(function*(){f(i.getCurrentFBOTex())}))})}renderBloomPass(i,s){var f=this;return(0,nn.Z)(function*(){const g=yield f.getReadFBOTex();let y=0;for(;y<4;)yield s.render(i,g),f.swap(),y++})()}render(i){var s=this;return(0,nn.Z)(function*(){for(let f=0;f<s.passes.length;f++){const g=s.passes[f];g.setRenderToScreen(s.isLastEnabledPass(f)),g.getName()==="bloom"?yield s.renderBloomPass(i,g):(yield g.render(i),f!==s.passes.length-1&&s.swap())}})()}resize(i,s){this.readFBO.resize({width:i,height:s}),this.writeFBO.resize({width:i,height:s})}add(i,s,f){i.init(s,f),this.passes.push(i)}insert(i,s,f,g){i.init(f,g),this.passes.splice(s,0,i)}getPostProcessingPassByName(i){return this.passes.find(s=>s.getName()===i)}init(){const{createFramebuffer:i,createTexture2D:s}=this.rendererService;this.readFBO=i({color:s({width:1,height:1,wrapS:at.CLAMP_TO_EDGE,wrapT:at.CLAMP_TO_EDGE,usage:es.RENDER_TARGET})}),this.writeFBO=i({color:s({width:1,height:1,wrapS:at.CLAMP_TO_EDGE,wrapT:at.CLAMP_TO_EDGE,usage:es.RENDER_TARGET})})}isLastEnabledPass(i){for(let s=i+1;s<this.passes.length;s++)if(this.passes[s].isEnabled())return!1;return!0}swap(){const i=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=i}}class Bw extends z1{getType(){return zl.Normal}getName(){return"render"}init(i,s){super.init(i,s)}render(i){const{useFramebuffer:s,clear:f}=this.rendererService,g=i.multiPassRenderer.getPostProcessor().getReadFBO();s(g,()=>{f({color:[0,0,0,0],depth:1,stencil:0,framebuffer:g}),i.multiPassRenderer.setRenderFlag(!1),i.models.forEach(y=>{y.draw({uniforms:i.layerModel.getUninforms()})}),i.multiPassRenderer.setRenderFlag(!0)})}}const Z1=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,jw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:i0}=Nr;class zw extends qa{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:jw,fs:Z1});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}convertOptionsToUniforms(i){const s={};return i0(i.bloomRadius)||(s.u_radius=i.bloomRadius),i0(i.bloomIntensity)||(s.u_intensity=i.bloomIntensity),i0(i.bloomBaseRadio)||(s.u_baseRadio=i.bloomBaseRadio),s}}const zL=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Vi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Uw}=Nr;class Zw extends qa{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:Vi,fs:zL});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}convertOptionsToUniforms(i){const s={};return Uw(i.blurRadius)||(s.u_BlurDir=[i.blurRadius,0]),s}}const H1=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,ou=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:V1}=Nr;class W1 extends qa{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:ou,fs:H1});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("blur-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}convertOptionsToUniforms(i){const s={};return V1(i.blurRadius)||(s.u_BlurDir=[0,i.blurRadius]),s}}const Hw=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Vw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Ww extends qa{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Vw,fs:Hw});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}}const Gw=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Yw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class $w extends qa{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:Yw,fs:Gw}),this.shaderModuleService.getModule("copy-pass")}}const Xw=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,qw=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class au extends qa{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:qw,fs:Xw});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}}const kc=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,su=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Kw extends qa{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:su,fs:kc});const{vs:i,fs:s,uniforms:f}=this.shaderModuleService.getModule("ink-pass"),{width:g,height:y}=this.rendererService.getViewportSize();return{vs:i,fs:s,uniforms:(0,Je.Z)((0,Je.Z)({},f),{},{u_ViewportSize:[g,y]})}}}const G1=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,cu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Qw extends qa{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:cu,fs:G1}),this.shaderModuleService.getModule("noise-pass")}}const UL=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Y1=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class Jw extends qa{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:UL,fs:Y1}),this.shaderModuleService.getModule("sepia-pass")}}const $1=new qi;let tA=0;function eA(){const a=new Dw,i=new g1,s=new Zp,f=new Ma(s),g=new Xl,y=new Up,_=new d1,O=new lw,A=new f1,P={id:`${tA++}`,globalConfigService:$1,shaderModuleService:a,debugService:i,cameraService:s,coordinateSystemService:f,fontService:g,iconService:y,markerService:_,popupService:O,controlService:A,customRenderService:{}},B=new ra(P);P.layerService=B;const U=new Tw(P);P.sceneService=U;const G=new hw(P);P.interactionService=G;const vt=new m1(P);P.pickingService=vt;const $t={clear:new Nw,pixelPicking:new iu,render:new Bw};P.normalPassFactory=Te=>$t[Te];const te={copy:new $w,bloom:new zw,blurH:new Zw,blurV:new W1,noise:new Qw,sepia:new Jw,colorHalftone:new Ww,hexagonalPixelate:new au,ink:new Kw};return P.postProcessingPass=te,P.postProcessingPassFactory=Te=>te[Te],P}function lu(a){const i=(0,Je.Z)({},a);return i.postProcessor=new U1(i.rendererService),i.multiPassRenderer=new aa(i.postProcessor),i.styleAttributeService=new S1(i.rendererService),i}const Kf=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let Wi=function(a){return a.IMAGE="image",a.CUSTOMIMAGE="customImage",a.ARRAYBUFFER="arraybuffer",a.RGB="rgb",a.TERRAINRGB="terrainRGB",a.CUSTOMRGB="customRGB",a.CUSTOMARRAYBUFFER="customArrayBuffer",a.CUSTOMTERRAINRGB="customTerrainRGB",a}({});var X1=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),nA=(a,i,s,f)=>X1(void 0,null,function*(){return new Promise((g,y)=>{i({x:a.x,y:a.y,z:a.z},(_,O)=>{if(_||O.length===0){y(_);return}O&&jl([{data:O,bands:[0]}],s,f,(A,P)=>{A?y(A):P&&g(P)})})})}),o0=(a,i)=>X1(void 0,null,function*(){return new Promise((s,f)=>{i({x:a.x,y:a.y,z:a.z},(g,y)=>{if(g||!y){f(g);return}y instanceof ArrayBuffer?Qt(y,(_,O)=>{_&&f(_),s(O)}):y instanceof HTMLImageElement?s(y):f(g)})})});function Qf(a,i){return Array.isArray(a)?typeof a[0]=="string"?a.map(s=>Ms(s,i)):a.map(s=>({url:Ms(s.url,i),bands:s.bands||[0]})):Ms(a,i)}function rA(a){return typeof a=="string"?[{url:a,bands:[0]}]:typeof a[0]=="string"?a.map(i=>({url:i,bands:[0]})):a}function q1(a,i){a.xhrCancel=()=>{i.map(s=>{s.abort()})}}var Jf=Object.defineProperty,iA=Object.defineProperties,oA=Object.getOwnPropertyDescriptors,K1=Object.getOwnPropertySymbols,aA=Object.prototype.hasOwnProperty,sA=Object.prototype.propertyIsEnumerable,Q1=(a,i,s)=>i in a?Jf(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,td=(a,i)=>{for(var s in i||(i={}))aA.call(i,s)&&Q1(a,s,i[s]);if(K1)for(var s of K1(i))sA.call(i,s)&&Q1(a,s,i[s]);return a},J1=(a,i)=>iA(a,oA(i)),tb=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),cA=(a,i,s,f,g)=>tb(void 0,null,function*(){const y=rA(i.url);if(y.length>1){const{rasterFiles:_,xhrList:O,errList:A}=yield is(y,i);if(q1(a,O),A.length>0){s(A,null);return}jl(_,f,g,s)}else{const _=Ui(i,(O,A)=>{if(O)s(O);else if(A){const P=[{data:A,bands:y[0].bands}];jl(P,f,g,s)}});q1(a,[_])}});function is(a,i){return tb(this,null,function*(){const s=[],f=[],g=[];for(let y=0;y<a.length;y++){const _=a[y],O=J1(td({},i),{url:_.url}),A=_.bands,{err:P,data:B,xhr:U}=yield ui(J1(td({},O),{type:"arrayBuffer"}));P&&g.push(P),f.push(U),s.push({data:B,bands:A})}return{rasterFiles:s,xhrList:f,errList:g}})}var eb=Object.defineProperty,a0=Object.defineProperties,nb=Object.getOwnPropertyDescriptors,rb=Object.getOwnPropertySymbols,ib=Object.prototype.hasOwnProperty,lA=Object.prototype.propertyIsEnumerable,Dc=(a,i,s)=>i in a?eb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,sa=(a,i)=>{for(var s in i||(i={}))ib.call(i,s)&&Dc(a,s,i[s]);if(rb)for(var s of rb(i))lA.call(i,s)&&Dc(a,s,i[s]);return a},ob=(a,i)=>a0(a,nb(i)),ed=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),s0=(a,i,s,f)=>ed(void 0,null,function*(){const{format:g=oi,operation:y,requestParameters:_={}}=f,O=ob(sa({},_),{url:Qf(a,i)});return new Promise((A,P)=>{cA(s,O,(B,U)=>{B?P(B):U&&A(U)},g,y)})}),c0=(a,i,s,f)=>ed(void 0,null,function*(){let g;const y=Array.isArray(a)?a[0]:a;return f.wmtsOptions?g=((f==null?void 0:f.getURLFromTemplate)||_y)(y,sa(sa({},i),f.wmtsOptions)):g=((f==null?void 0:f.getURLFromTemplate)||Ms)(y,i),new Promise((_,O)=>{var A;const P=ht(ob(sa({},f==null?void 0:f.requestParameters),{url:g,type:((A=f==null?void 0:f.requestParameters)==null?void 0:A.type)||"arrayBuffer"}),(B,U)=>{B?O(B):U&&_(U)},f.transformResponse);s.xhrCancel=()=>P.cancel()})}),oi=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),nd=Object.defineProperty,ai=Object.defineProperties,Ro=Object.getOwnPropertyDescriptors,js=Object.getOwnPropertySymbols,ab=Object.prototype.hasOwnProperty,l0=Object.prototype.propertyIsEnumerable,u0=(a,i,s)=>i in a?nd(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,Fn=(a,i)=>{for(var s in i||(i={}))ab.call(i,s)&&u0(a,s,i[s]);if(js)for(var s of js(i))l0.call(i,s)&&u0(a,s,i[s]);return a},uA=(a,i)=>ai(a,Ro(i)),fA={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},rd=[Wi.ARRAYBUFFER,Wi.RGB];function sb(a){return!!(Array.isArray(a)&&a.length===0||!Array.isArray(a)&&typeof a!="string")}function id(a,i={}){if(sb(a))throw new Error("tile server url is error");let s=(i==null?void 0:i.dataType)||Wi.IMAGE;s===Wi.RGB&&(s=Wi.ARRAYBUFFER);const f=(y,_)=>{switch(s){case Wi.IMAGE:return c0(a,y,_,i);case Wi.CUSTOMIMAGE:case Wi.CUSTOMTERRAINRGB:return o0(_,i==null?void 0:i.getCustomData);case Wi.ARRAYBUFFER:return s0(a,y,_,i);case Wi.CUSTOMARRAYBUFFER:case Wi.CUSTOMRGB:return nA(_,i==null?void 0:i.getCustomData,(i==null?void 0:i.format)||oi,i==null?void 0:i.operation);default:return c0(a,y,_,i)}},g=uA(Fn(Fn({},fA),i),{getTileData:f});return{data:a,dataArray:[],tilesetOptions:g,isTile:!0}}var zs=Object.defineProperty,ZL=Object.defineProperties,f0=Object.getOwnPropertyDescriptors,uu=Object.getOwnPropertySymbols,od=Object.prototype.hasOwnProperty,d0=Object.prototype.propertyIsEnumerable,cb=(a,i,s)=>i in a?zs(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,HL=(a,i)=>{for(var s in i||(i={}))od.call(i,s)&&cb(a,s,i[s]);if(uu)for(var s of uu(i))d0.call(i,s)&&cb(a,s,i[s]);return a},lb=(a,i)=>ZL(a,f0(i)),qr=(a,i)=>{var s={};for(var f in a)od.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&uu)for(var f of uu(a))i.indexOf(f)<0&&d0.call(a,f)&&(s[f]=a[f]);return s};function ub(a,i){const s=i,{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:g,width:y,height:_}=s,O=qr(s,["extent","coordinates","width","height"]);a.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[A,P]=O.bands||[0,1],B=[a[A],a[P]],U=[];for(let $t=0;$t<B[0].length;$t++)U.push((B[1][$t]-B[0][$t])/(B[1][$t]+B[0][$t]));const G=Of(g,f);return{_id:1,dataArray:[lb(HL({_id:1,data:U,width:y,height:_},O),{coordinates:G})]}}var fu=Object.defineProperty,h0=Object.defineProperties,p0=Object.getOwnPropertyDescriptors,ca=Object.getOwnPropertySymbols,fb=Object.prototype.hasOwnProperty,g0=Object.prototype.propertyIsEnumerable,db=(a,i,s)=>i in a?fu(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,ad=(a,i)=>{for(var s in i||(i={}))fb.call(i,s)&&db(a,s,i[s]);if(ca)for(var s of ca(i))g0.call(i,s)&&db(a,s,i[s]);return a},ko=(a,i)=>h0(a,p0(i)),VL=(a,i)=>{var s={};for(var f in a)fb.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&ca)for(var f of ca(a))i.indexOf(f)<0&&g0.call(a,f)&&(s[f]=a[f]);return s};function v0(a,i){const s=i,{extent:f,coordinates:g,width:y,height:_}=s,O=VL(s,["extent","coordinates","width","height"]);a.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[A,P,B]=O.bands||[0,1,2],U=[a[A],a[P],a[B]],G=[],[vt,$t]=(O==null?void 0:O.countCut)||[2,98],te=(O==null?void 0:O.RMinMax)||Lc(U[0],vt,$t),Te=(O==null?void 0:O.GMinMax)||Lc(U[1],vt,$t),Fe=(O==null?void 0:O.BMinMax)||Lc(U[2],vt,$t);for(let Qe=0;Qe<U[0].length;Qe++)G.push(Math.max(0,U[0][Qe]-te[0])),G.push(Math.max(0,U[1][Qe]-Te[0])),G.push(Math.max(0,U[2][Qe]-Fe[0]));const Ze=Of(g,f);return{_id:1,dataArray:[ko(ad({_id:1,data:G,width:y,height:_,rMinMax:te,gMinMax:Te,bMinMax:Fe},O),{coordinates:Ze})]}}var hb=Object.defineProperty,pb=Object.defineProperties,Us=Object.getOwnPropertyDescriptors,Pa=Object.getOwnPropertySymbols,sd=Object.prototype.hasOwnProperty,gb=Object.prototype.propertyIsEnumerable,vb=(a,i,s)=>i in a?hb(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,WL=(a,i)=>{for(var s in i||(i={}))sd.call(i,s)&&vb(a,s,i[s]);if(Pa)for(var s of Pa(i))gb.call(i,s)&&vb(a,s,i[s]);return a},dA=(a,i)=>pb(a,Us(i)),mb=(a,i)=>{var s={};for(var f in a)sd.call(a,f)&&i.indexOf(f)<0&&(s[f]=a[f]);if(a!=null&&Pa)for(var f of Pa(a))i.indexOf(f)<0&&gb.call(a,f)&&(s[f]=a[f]);return s};function Fc(a,i){const s=i,{extent:f,coordinates:g,min:y,max:_,width:O,height:A,format:P,operation:B}=s,U=mb(s,["extent","coordinates","min","max","width","height","format","operation"]);let G;if(P===void 0||Or(a))G=Array.from(a);else{const te=Array.isArray(a)?a:[a];G=Nf(te,P,B)}const vt=Of(g,f);return{_id:1,dataArray:[dA(WL({_id:1,data:G,width:O,height:A},U),{min:y,max:_,coordinates:vt})]}}var hA=Object.defineProperty,yb=Object.defineProperties,bb=Object.getOwnPropertyDescriptors,Nc=Object.getOwnPropertySymbols,m0=Object.prototype.hasOwnProperty,pA=Object.prototype.propertyIsEnumerable,y0=(a,i,s)=>i in a?hA(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,b0=(a,i)=>{for(var s in i||(i={}))m0.call(i,s)&&y0(a,s,i[s]);if(Nc)for(var s of Nc(i))pA.call(i,s)&&y0(a,s,i[s]);return a},Ia=(a,i)=>yb(a,bb(i)),gA=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),_b={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},xb=a=>gA(void 0,null,function*(){return new Promise(i=>{const[s,f,g,y]=a.bounds,_={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,x:(s+g)/2,y:(f+y)/2},geometry:{type:"LineString",coordinates:[[g,y],[g,f],[s,f],[s,f]]}}]}}};i(_)})});function _0(a,i){const s=g=>xb(g),f=Ia(b0(b0({},_b),i),{getTileData:s});return{data:a,dataArray:[],tilesetOptions:f,isTile:!0}}var vA=k(69848),ci=k.n(vA),mA=Object.defineProperty,Do=Object.getOwnPropertySymbols,Sb=Object.prototype.hasOwnProperty,du=Object.prototype.propertyIsEnumerable,x0=(a,i,s)=>i in a?mA(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,S0=(a,i)=>{for(var s in i||(i={}))Sb.call(i,s)&&x0(a,s,i[s]);if(Do)for(var s of Do(i))du.call(i,s)&&x0(a,s,i[s]);return a};function Ob(a,i){const{radius:s=40,maxZoom:f=18,minZoom:g=0,zoom:y=2}=i;if(a.pointIndex){const A=a.pointIndex.getClusters(a.extent,Math.floor(y));return a.dataArray=cd(A),a}const _=new(ci())({radius:s,minZoom:g,maxZoom:f}),O={type:"FeatureCollection",features:[]};return O.features=a.dataArray.map(A=>({type:"Feature",geometry:{type:"Point",coordinates:A.coordinates},properties:S0({},A)})),_.load(O.features),_}function cd(a){return a.map((i,s)=>S0({coordinates:i.geometry.coordinates,_id:s+1},i.properties))}function yA(a){if(a.length===0)throw new Error("max requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]>i&&(i=a[s]);return i}function bA(a){if(a.length===0)throw new Error("min requires at least one data point");let i=a[0];for(let s=1;s<a.length;s++)a[s]<i&&(i=a[s]);return i}function Eb(a){if(a.length===0)return 0;let i=a[0],s=0,f;for(let g=1;g<a.length;g++)f=i+a[g]*1,Math.abs(i)>=Math.abs(a[g])?s+=i-f+a[g]:s+=a[g]-f+i,i=f;return i+s*1}function _A(a){if(a.length===0)throw new Error("mean requires at least one data point");return Eb(a)/a.length}var wb={min:bA,max:yA,mean:_A,sum:Eb},xA=Object.defineProperty,Ab=Object.getOwnPropertySymbols,Tb=Object.prototype.hasOwnProperty,SA=Object.prototype.propertyIsEnumerable,O0=(a,i,s)=>i in a?xA(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,hu=(a,i)=>{for(var s in i||(i={}))Tb.call(i,s)&&O0(a,s,i[s]);if(Ab)for(var s of Ab(i))SA.call(i,s)&&O0(a,s,i[s]);return a},Ra=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),{cloneDeep:OA,isFunction:ld,isString:EA,mergeWith:Cb}=Nr;function wA(a,i){if(Array.isArray(i))return i}var AA=class extends no.EventEmitter{constructor(a,i){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new Li},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=a,this.initCfg(i),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}getClustersLeaves(a){return this.clusterIndex.getLeaves(a,1/0)}getParserType(){return this.parser.type}updateClusterData(a){const{method:i="sum",field:s}=this.clusterOptions;let f=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,f.forEach(g=>{g.id||(g.properties.point_count=1)}),(s||ld(i))&&(f=f.map(g=>{const y=g.id;if(y){const O=this.clusterIndex.getLeaves(y,1/0).map(P=>P.properties);let A;if(EA(i)&&s){const P=up(O,s);A=wb[i](P)}ld(i)&&(A=i(O)),g.properties.stat=A}else g.properties.point_count=1;return g})),this.data=qt("geojson")({type:"FeatureCollection",features:f}),this.executeTrans()}getFeatureById(a){const{type:i="geojson",geometry:s}=this.parser;if(i==="geojson"&&!this.cluster){const f=a<this.originData.features.length?this.originData.features[a]:"null",g=OA(f);if(g!=null&&g.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const y=this.data.dataArray.find(_=>_._id===a);g.properties=y}return g}else return i==="json"&&s?this.data.dataArray.find(f=>f._id===a):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}updateFeaturePropertiesById(a,i){this.data.dataArray=this.data.dataArray.map(s=>s._id===a?hu(hu({},s),i):s),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(a,i){const s=this.data.dataArray.find(f=>f[a]===i);return s==null?void 0:s._id}setData(a,i){this.originData=a,this.dataArrayChanged=!1,this.initCfg(i),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var a;(a=this.tileset)==null||a.reloadAll()}reloadTilebyId(a,i,s){var f;(f=this.tileset)==null||f.reloadTileById(a,i,s)}reloadTileByLnglat(a,i,s){var f;(f=this.tileset)==null||f.reloadTileByLnglat(a,i,s)}getTileExtent(a,i){var s;return(s=this.tileset)==null?void 0:s.getTileExtent(a,i)}getTileByZXY(a,i,s){var f;return(f=this.tileset)==null?void 0:f.getTileByZXY(a,i,s)}reloadTileByExtent(a,i){var s;(s=this.tileset)==null||s.reloadTileByExtent(a,i)}destroy(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)==null||a.destroy()}processData(){return Ra(this,null,function*(){return new Promise((a,i)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),a({})}catch(s){i(s)}})})}initCfg(a){this.cfg=Cb(this.cfg,a,wA);const i=this.cfg;i&&(i.parser&&(this.parser=i.parser),i.transforms&&(this.transforms=i.transforms),this.cluster=i.cluster||!1,i.clusterOptions&&(this.cluster=!0,this.clusterOptions=hu(hu({},this.clusterOptions),i.clusterOptions)))}init(){return Ra(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const a=this.parser,i=a.type||"geojson",s=qt(i);this.data=s(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=HO(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:a}=this.data;return a?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(a),this.tileset):new yy(hu({},a))):void 0}executeTrans(){this.transforms.forEach(i=>{const{type:s}=i,f=Zt(s)(this.data,i);Object.assign(this.data,f)})}initCluster(){if(!this.cluster)return;const a=this.clusterOptions||{};this.clusterIndex=Ob(this.data,a)}caculClusterExtent(a){let i=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(i=qh(mi(this.extent),a)),i[0].concat(i[1])}};function TA(a,i){const{callback:s}=i;return s&&(a.dataArray=a.dataArray.filter(s)),a}var E0=6378e3;function CA(a,i){const s=a.dataArray,{size:f=10}=i,g=f/(2*Math.PI*E0)*(256<<20)/2,{gridHash:y,gridOffset:_}=pu(s,f),O=fd(y,_,i);return{yOffset:g,xOffset:g,radius:g,type:"grid",dataArray:O}}function pu(a,i){let s=1/0,f=-1/0,g;for(const A of a)g=A.coordinates[1],Number.isFinite(g)&&(s=g<s?g:s,f=g>f?g:f);const y=(s+f)/2,_=Bc(i,y);if(_.xOffset<=0||_.yOffset<=0)return{gridHash:{},gridOffset:_};const O={};for(const A of a){const P=A.coordinates[1],B=A.coordinates[0];if(Number.isFinite(P)&&Number.isFinite(B)){const U=Math.floor((P+90)/_.yOffset),G=Math.floor((B+180)/_.xOffset),vt=`${U}-${G}`;O[vt]=O[vt]||{count:0,points:[]},O[vt].count+=1,O[vt].points.push(A)}}return{gridHash:O,gridOffset:_}}function Bc(a,i){const s=os(a),f=ud(i,a);return{yOffset:s,xOffset:f}}function os(a){return a/E0*(180/Math.PI)}function ud(a,i){return i/E0*(180/Math.PI)/Math.cos(a*Math.PI/180)}function fd(a,i,s){return Object.keys(a).reduce((f,g,y)=>{const _=g.split("-"),O=parseInt(_[0],10),A=parseInt(_[1],10),P={};if(s.field&&s.method){const B=ay(a[g].points,s.field);P[s.method]=oy[s.method](B)}return Object.assign(P,{_id:y,coordinates:Mo([-180+i.xOffset*(A+.5),-90+i.yOffset*(O+.5)]),rawData:a[g].points,count:a[g].count}),f.push(P),f},[])}var jc=Math.PI/3,Mb=[0,jc,2*jc,3*jc,4*jc,5*jc];function Ki(a){return a[0]}function Zs(a){return a[1]}function MA(){var a=0,i=0,s=1,f=1,g=Ki,y=Zs,_,O,A;function P(U){var G={},vt=[],$t,te=U.length;for($t=0;$t<te;++$t)if(!(isNaN(Fe=+g.call(null,Te=U[$t],$t,U))||isNaN(Ze=+y.call(null,Te,$t,U)))){var Te,Fe,Ze,je=Math.round(Ze=Ze/A),Qe=Math.round(Fe=Fe/O-(je&1)/2),ln=Ze-je;if(Math.abs(ln)*3>1){var wn=Fe-Qe,mn=Qe+(Fe<Qe?-1:1)/2,Mn=je+(Ze<je?-1:1),rr=Fe-mn,Qn=Ze-Mn;wn*wn+ln*ln>rr*rr+Qn*Qn&&(Qe=mn+(je&1?1:-1)/2,je=Mn)}var Yn=Qe+"-"+je,lr=G[Yn];lr?lr.push(Te):(vt.push(lr=G[Yn]=[Te]),lr.x=(Qe+(je&1)/2)*O,lr.y=je*A)}return vt}function B(U){var G=0,vt=0;return Mb.map(function($t){var te=Math.sin($t)*U,Te=-Math.cos($t)*U,Fe=te-G,Ze=Te-vt;return G=te,vt=Te,[Fe,Ze]})}return P.hexagon=function(U){return"m"+B(U==null?_:+U).join("l")+"z"},P.centers=function(){for(var U=[],G=Math.round(i/A),vt=Math.round(a/O),$t=G*A;$t<f+_;$t+=A,++G)for(var te=vt*O+(G&1)*O/2;te<s+O/2;te+=O)U.push([te,$t]);return U},P.mesh=function(){var U=B(_).slice(0,4).join("l");return P.centers().map(function(G){return"M"+G+"m"+U}).join("")},P.x=function(U){return arguments.length?(g=U,P):g},P.y=function(U){return arguments.length?(y=U,P):y},P.radius=function(U){return arguments.length?(_=+U,O=_*2*Math.sin(jc),A=_*1.5,P):_},P.size=function(U){return arguments.length?(a=i=0,s=+U[0],f=+U[1],P):[s-a,f-i]},P.extent=function(U){return arguments.length?(a=+U[0][0],i=+U[0][1],s=+U[1][0],f=+U[1][1],P):[[a,i],[s,f]]},P.radius(1)}var w0=Object.defineProperty,la=Object.defineProperties,zc=Object.getOwnPropertyDescriptors,Gi=Object.getOwnPropertySymbols,gu=Object.prototype.hasOwnProperty,dd=Object.prototype.propertyIsEnumerable,Lb=(a,i,s)=>i in a?w0(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,LA=(a,i)=>{for(var s in i||(i={}))gu.call(i,s)&&Lb(a,s,i[s]);if(Gi)for(var s of Gi(i))dd.call(i,s)&&Lb(a,s,i[s]);return a},Pb=(a,i)=>la(a,zc(i)),PA=6378e3;function IA(a,i){const s=a.dataArray,{size:f=10,method:g="sum"}=i,y=f/(2*Math.PI*PA)*(256<<20)/2,_=s.map(B=>{const[U,G]=Mo(B.coordinates);return Pb(LA({},B),{coordinates:[U,G]})});return{dataArray:MA().radius(y).x(B=>B.coordinates[0]).y(B=>B.coordinates[1])(_).map((B,U)=>{if(i.field&&g){const G=ay(B,i.field);B[g]=oy[g](G)}return{[i.method]:B[g],count:B.length,rawData:B,coordinates:[B.x,B.y],_id:U}}),radius:y,xOffset:y,yOffset:y,type:"hexagon"}}var RA=Object.defineProperty,Ib=Object.getOwnPropertySymbols,kA=Object.prototype.hasOwnProperty,DA=Object.prototype.propertyIsEnumerable,vu=(a,i,s)=>i in a?RA(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,mu=(a,i)=>{for(var s in i||(i={}))kA.call(i,s)&&vu(a,s,i[s]);if(Ib)for(var s of Ib(i))DA.call(i,s)&&vu(a,s,i[s]);return a};function hd(a,i){const{sourceField:s,targetField:f,data:g}=i,y={};return g.forEach(_=>{y[_[s]]=_}),a.dataArray=a.dataArray.map(_=>{const O=_[f];return mu(mu({},_),y[O])}),a}function Rb(a,i){const{callback:s}=i;return s&&(a.dataArray=a.dataArray.map(s)),a}var pd=k(4771);q("rasterTile",id),q("mvt",jE),q("geojsonvt",Rf),q("testTile",_0),q("geojson",pE),q("jsonTile",IE),q("image",Op),q("csv",Pr),q("json",Yr),q("raster",Bf),q("rasterRgb",Fc),q("rgb",v0),q("ndi",ub),Bt("cluster",Ob),Bt("filter",TA),Bt("join",hd),Bt("map",Rb),Bt("grid",CA),Bt("hexagon",IA);var FA=AA;class GL extends null{getMarkerLayerContainerSize(){}constructor(i){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",s=>{const f=this.mapsService.getContainer();if(!f)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:g,top:y}=f.getClientRects()[0],{x:_,y:O}=s;this.preLngLat=this.mapsService.containerToLngLat([_-g,O-y]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",s=>{const f=s.lngLat||s.lnglat,{lng:g,lat:y}=this.preLngLat,{lng:_,lat:O}=f,A={lng:this.lngLat.lng+_-g,lat:this.lngLat.lat+O-y};this.setLnglat(A),this.preLngLat=f,this.emit("dragging",A)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",s=>{this.polyfillEvent(s),this.emit(s.type,{target:s,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),i),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(i){this.scene=i,this.mapsService=i.mapService;const{element:s}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(s),this.registerMarkerEvent(s),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:i}=this.markerOption;return i&&DOM.remove(i),this.popup&&this.popup.remove(),this}setLnglat(i){return this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(i){if(!this.added)return this.once("added",()=>{this.setElement(i)}),this;const{element:s}=this.markerOption;return s&&DOM.remove(s),this.markerOption.element=i,this.init(),this.mapsService.getMarkerContainer().appendChild(i),this.registerMarkerEvent(i),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const i=this.popup;return i?(i.isOpen()||i.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const i=this.popup;return i&&i.remove(),this}setPopup(i){return this.popup=i,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const i=this.popup;if(i)i.isOpen()?i.remove():i.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(i){this.markerOption.draggable=i,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(i){this.markerOption.extData=i}update(){if(!this.mapsService)return;const{element:i,anchor:s}=this.markerOption;this.updatePosition(),DOM.setTransform(i,`${anchorTranslate[s]}`)}updatePositionWhenZoom(i){if(!this.mapsService)return;const{element:s,offsets:f}=this.markerOption,{lng:g,lat:y}=this.lngLat;if(s){s.style.display="block",s.style.whiteSpace="nowrap";const{containerHeight:_,containerWidth:O,bounds:A}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!A)return;const P=i.map,B=i.center,U=i.zoom,G=P.DE(this.lngLat,U,B);if(G.x=Math.round(G.x+f[0]),G.y=Math.round(G.y-f[1]),Math.abs(A[0][0])>180||Math.abs(A[1][0])>180){if(G.x>O){const vt=this.mapsService.lngLatToContainer([g-360,y]);G.x=vt.x}if(G.x<0){const vt=this.mapsService.lngLatToContainer([g+360,y]);G.x=vt.x}}(G.x>O||G.x<0||G.y>_||G.y<0)&&(s.style.display="none"),s.style.left=G.x+"px",s.style.top=G.y+"px",s.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(i){const{element:s}=this.markerOption;this.popup&&s&&this.togglePopup()}getCurrentContainerSize(){const i=this.mapsService.getContainer();return{containerHeight:(i==null?void 0:i.scrollHeight)||0,containerWidth:(i==null?void 0:i.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:i}=this.markerOption;i==null||i.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(i==null||i.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:i,offsets:s}=this.markerOption,{lng:f,lat:g}=this.lngLat,y=this.mapsService.lngLatToContainer([f,g]);if(i){i.style.display="block",i.style.whiteSpace="nowrap";const{containerHeight:_,containerWidth:O,bounds:A}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!A)return;if(Math.abs(A[0][0])>180||Math.abs(A[1][0])>180){if(y.x>O){const P=this.mapsService.lngLatToContainer([f-360,g]);y.x=P.x}if(y.x<0){const P=this.mapsService.lngLatToContainer([f+360,g]);y.x=P.x}}this.markerOption.overflowHide&&(y.x>O||y.x<0||y.y>_||y.y<0)&&(i.style.display="none"),i.style.left=y.x+s[0]+"px",i.style.top=y.y-s[1]+"px"}}init(){let{element:i}=this.markerOption;const{color:s,anchor:f}=this.markerOption;if(!i){i=DOM.create("div"),this.markerOption.element=i;const g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height","48px"),g.setAttributeNS(null,"width","48px"),g.setAttributeNS(null,"viewBox","0 0 1024 1024");const y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),y.setAttributeNS(null,"fill",s),g.appendChild(y),i.appendChild(g)}DOM.addClass(i,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(g=>{var y,_;const O=((y=this.markerOption)===null||y===void 0?void 0:y.style)&&((_=this.markerOption)===null||_===void 0?void 0:_.style[g]);i&&(i.style[g]=O)}),applyAnchorClass(i,f,"marker")}registerMarkerEvent(i){i.addEventListener("click",this.onMapClick),i.addEventListener("mousemove",this.eventHandle),i.addEventListener("click",this.eventHandle),i.addEventListener("mousedown",this.eventHandle),i.addEventListener("mouseup",this.eventHandle),i.addEventListener("dblclick",this.eventHandle),i.addEventListener("contextmenu",this.eventHandle),i.addEventListener("mouseover",this.eventHandle),i.addEventListener("mouseout",this.eventHandle),i.addEventListener("touchstart",this.eventHandle),i.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const i=this.getElement();i.removeEventListener("click",this.onMapClick),i.removeEventListener("mousemove",this.eventHandle),i.removeEventListener("click",this.eventHandle),i.removeEventListener("mousedown",this.eventHandle),i.removeEventListener("mouseup",this.eventHandle),i.removeEventListener("dblclick",this.eventHandle),i.removeEventListener("contextmenu",this.eventHandle),i.removeEventListener("mouseover",this.eventHandle),i.removeEventListener("mouseout",this.eventHandle),i.removeEventListener("touchstart",this.eventHandle),i.removeEventListener("touchend",this.eventHandle)}polyfillEvent(i){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(i.type==="touchstart"&&(this.touchStartTime=Date.now()),i.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:i,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(i){return null}onUp(i){throw new Error("Method not implemented.")}}const{merge:A0}=Nr;class kb extends null{constructor(i){var s;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=A0(this.getDefault(),i),bindAll(["update"],this),this.zoom=((s=this.markerLayerOption.clusterOption)===null||s===void 0?void 0:s.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(i){return this.scene=i,this.mapsService=i.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const i=this.mapsService.getContainer();this.containerSize={containerWidth:(i==null?void 0:i.scrollWidth)||0,containerHeight:(i==null?void 0:i.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(i){const s=this.markerLayerOption.cluster;if(i.getMarkerLayerContainerSize=this.getContainerSize.bind(this),s&&(this.addPoint(i,this.markers.length),this.mapsService)){const f=this.mapsService.getZoom(),g=this.mapsService.getBounds();this.bbox=padBounds(g,.5),this.zoom=Math.floor(f),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(i)}removeMarker(i){this.markers.indexOf(i);const s=this.markers.indexOf(i);s>-1&&(this.markers.splice(s,1),this.markerLayerOption.cluster&&(this.removePoint(s),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(i=>{i.getElement().style.opacity="0"}),this.clusterMarkers.map(i=>{i.getElement().style.opacity="0"})}show(){this.markers.map(i=>{i.getElement().style.opacity="1"}),this.clusterMarkers.map(i=>{i.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(i=>{i.addTo(this.scene)})}clear(){this.markers.forEach(i=>{i.remove()}),this.clusterMarkers.forEach(i=>{i.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(i,s){const{lng:f,lat:g}=i.getLnglat(),y={geometry:{type:"Point",coordinates:[f,g]},properties:_objectSpread(_objectSpread({},i.getExtData()),{},{marker_id:s})};this.points.push(y),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(i){const s=this.points.findIndex(f=>f.properties.marker_id===i);s>-1&&this.points.splice(s,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:i,minZoom:s=0,maxZoom:f}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:i,minZoom:s,maxZoom:f}),this.clusterIndex.load(this.points)}getClusterMarker(i,s){const f=i[0].concat(i[1]),g=this.clusterIndex.getClusters(f,s);this.clusterMarkers.forEach(y=>{y.remove()}),this.clusterMarkers=[],g.forEach(y=>{var _;const{field:O,method:A}=this.markerLayerOption.clusterOption;if((_=y.properties)!==null&&_!==void 0&&_.cluster_id){var P;const U=this.getLeaves((P=y.properties)===null||P===void 0?void 0:P.cluster_id);if(y.properties.clusterData=U,O&&A){const G=U==null?void 0:U.map(Te=>({[O]:Te.properties[O]})),vt=Satistics.getColumn(G,O),$t=Satistics.getSatByColumn(A,vt),te="point_"+A;y.properties[te]=$t.toFixed(2)}}const B=this.clusterMarker(y);this.clusterMarkers.push(B),B.addTo(this.scene)})}getLeaves(i,s=1/0,f=0){return i?this.clusterIndex.getLeaves(i,s,f):null}clusterMarker(i){const s=this.markerLayerOption.clusterOption,{element:f=this.generateElement.bind(this)}=s;return new Marker({element:f(i)}).setLnglat({lng:i.geometry.coordinates[0],lat:i.geometry.coordinates[1]})}normalMarker(i){const s=i.properties.marker_id;return this.markers[s]}update(){if(!this.mapsService||this.markers.length===0)return;const i=this.mapsService.getZoom(),s=this.mapsService.getBounds();(!this.bbox||Math.abs(i-this.zoom)>=1||!boundsContains(this.bbox,s))&&(this.bbox=padBounds(s,.5),this.zoom=Math.floor(i),this.getClusterMarker(this.bbox,this.zoom))}generateElement(i){const s=DOM.create("div","l7-marker-cluster"),f=DOM.create("div","",s),g=DOM.create("span","",f),{field:y,method:_}=this.markerLayerOption.clusterOption;i.properties.point_count=i.properties.point_count||1;const O=y&&_?i.properties["point_"+_]||i.properties[y]:i.properties.point_count;return g.textContent=O,s}}var T0=k(4157);class ua extends sy(){constructor(i){super(),(0,ut.Z)(this,"controlOption",void 0),(0,ut.Z)(this,"container",void 0),(0,ut.Z)(this,"isShow",void 0),(0,ut.Z)(this,"sceneContainer",void 0),(0,ut.Z)(this,"scene",void 0),(0,ut.Z)(this,"mapsService",void 0),(0,ut.Z)(this,"renderService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"controlService",void 0),(0,ut.Z)(this,"configService",void 0),ua.controlCount++,this.controlOption=(0,Je.Z)((0,Je.Z)({},this.getDefault(i)),i||{})}getOptions(){return this.controlOption}setOptions(i){const s=this.getDefault(i);Object.entries(i).forEach(([f,g])=>{g===void 0&&(i[f]=s[f])}),"position"in i&&this.setPosition(i.position),"className"in i&&this.setClassName(i.className),"style"in i&&this.setStyle(i.style),this.controlOption=(0,Je.Z)((0,Je.Z)({},this.controlOption),i)}addTo(i){this.mapsService=i.mapService,this.renderService=i.rendererService,this.layerService=i.layerService,this.controlService=i.controlService,this.configService=i.globalConfigService,this.scene=i.sceneService,this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd(),Co(this.container,"l7-control");const{className:s,style:f}=this.controlOption;return s&&this.setClassName(s),f&&this.setStyle(f),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;wa(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return Fi("div")}onRemove(){}show(){const i=this.container;Sc(i,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const i=this.container;Co(i,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(i){return{position:Vl.TOPRIGHT,name:`${ua.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(i){if(this.mapsService&&i&&i.screenX>0&&i.screenY>0){const s=this.mapsService.getContainer();s!==null&&s.focus()}}setPosition(i=Vl.TOPLEFT){const s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=i,s&&s.addControl(this,this.sceneContainer),this}setClassName(i){const s=this.container,{className:f}=this.controlOption;f&&Sc(s,f),i&&Co(s,i)}setStyle(i){const s=this.container;i?s.setAttribute("style",i):s.removeAttribute("style")}insertContainer(){const i=this.controlOption.position,s=this.container;if(i instanceof Element)i.appendChild(s);else{const f=this.controlService.controlCorners[i];["bottomleft","bottomright","righttop","rightbottom"].includes(i)?f.insertBefore(s,f.firstChild):f.appendChild(s)}}checkUpdateOption(i,s){return s.some(f=>f in i)}}(0,ut.Z)(ua,"controlCount",0);class Hs extends null{constructor(...i){super(...i),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(i){if(this.isDisable=i,i){var s;(s=this.button)===null||s===void 0||s.setAttribute("disabled","true")}else{var f;(f=this.button)===null||f===void 0||f.removeAttribute("disabled")}}createButton(i=""){return DOM.create("button",`l7-button-control ${i}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:i,btnText:s,btnIcon:f}=this.controlOption;return this.setBtnTitle(i),this.setBtnText(s),this.setBtnIcon(f),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(i){const{title:s,btnText:f,btnIcon:g}=i;this.checkUpdateOption(i,["title"])&&this.setBtnTitle(s),this.checkUpdateOption(i,["btnIcon"])&&this.setBtnIcon(g),this.checkUpdateOption(i,["btnText"])&&this.setBtnText(f),super.setOptions(i)}setBtnTitle(i){var s;(s=this.button)===null||s===void 0||s.setAttribute("title",i!=null?i:"")}setBtnIcon(i){if(this.buttonIcon&&DOM.remove(this.buttonIcon),i){var s;const y=(s=this.button)===null||s===void 0?void 0:s.firstChild;if(y){var f;(f=this.button)===null||f===void 0||f.insertBefore(i,y)}else{var g;(g=this.button)===null||g===void 0||g.appendChild(i)}this.buttonIcon=i}}setBtnText(i){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),i){let f=this.buttonText;if(!f){var s;f=DOM.create("div","l7-button-control__text"),(s=this.button)===null||s===void 0||s.appendChild(f),this.buttonText=f}f.innerText=i,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!i&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class yu extends no.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(i,s){super(),(0,ut.Z)(this,"popperDOM",void 0),(0,ut.Z)(this,"contentDOM",void 0),(0,ut.Z)(this,"button",void 0),(0,ut.Z)(this,"option",void 0),(0,ut.Z)(this,"isShow",!1),(0,ut.Z)(this,"content",void 0),(0,ut.Z)(this,"timeout",null),(0,ut.Z)(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),Sc(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&yu.conflictPopperList.forEach(f=>{f!==this&&f.isShow&&f.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),(0,ut.Z)(this,"hide",()=>this.isShow?(Co(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),(0,ut.Z)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),(0,ut.Z)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),(0,ut.Z)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),(0,ut.Z)(this,"onPopperUnClick",f=>{zO(f.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),(0,ut.Z)(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),(0,ut.Z)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=i,this.option=s,this.init(),s.unique&&yu.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(i){typeof i=="string"?this.contentDOM.innerHTML=i:i instanceof HTMLElement&&($h(this.contentDOM),this.contentDOM.appendChild(i)),this.content=i}init(){const{trigger:i}=this.option;this.popperDOM=this.createPopper(),i==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),wa(this.popperDOM)}resetPopperPosition(){const i={},{container:s,offset:f=[0,0],placement:g}=this.option,[y,_]=f,O=this.button.getBoundingClientRect(),A=s.getBoundingClientRect(),{left:P,right:B,top:U,bottom:G}=BO(O,A);let vt=!1,$t=!1;/^(left|right)/.test(g)?(g.includes("left")?i.right=`${O.width+B}px`:g.includes("right")&&(i.left=`${O.width+P}px`),g.includes("start")?i.top=`${U}px`:g.includes("end")?i.bottom=`${G}px`:(i.top=`${U+O.height/2}px`,$t=!0,i.transform=`translate(${y}px, calc(${_}px - 50%))`)):/^(top|bottom)/.test(g)&&(g.includes("top")?i.bottom=`${O.height+G}px`:g.includes("bottom")&&(i.top=`${O.height+U}px`),g.includes("start")?i.left=`${P}px`:g.includes("end")?i.right=`${B}px`:(i.left=`${P+O.width/2}px`,vt=!0,i.transform=`translate(calc(${y}px - 50%), ${_}px)`)),i.transform=`translate(calc(${y}px - ${vt?"50%":"0%"}), calc(${_}px - ${$t?"50%":"0%"})`;const te=g.split("-");te.length&&Co(this.popperDOM,te.map(Te=>`l7-popper-${Te}`).join(" ")),Gm(this.popperDOM,NO(i))}createPopper(){const{container:i,className:s="",content:f}=this.option,g=Fi("div",`l7-popper l7-popper-hide ${s}`),y=Fi("div","l7-popper-content"),_=Fi("div","l7-popper-arrow");return g.appendChild(y),g.appendChild(_),i.appendChild(g),this.popperDOM=g,this.contentDOM=y,f&&this.setContent(f),g}}(0,ut.Z)(yu,"conflictPopperList",[]);const C0={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class ka extends null{constructor(...i){super(...i),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(i){var s;const f=super.getDefault(i),g=(s=i==null?void 0:i.position)!==null&&s!==void 0?s:f.position;return _objectSpread(_objectSpread({},super.getDefault(i)),{},{popperPlacement:g instanceof Element?"bottom":C0[g],popperTrigger:"click"})}onAdd(){const i=super.onAdd();return this.initPopper(),i}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:i,popperPlacement:s,popperTrigger:f}=this.controlOption,g=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:i,placement:s,trigger:f,container:g,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(i){if(super.setOptions(i),this.checkUpdateOption(i,["popperPlacement","popperTrigger","popperClassName"])){const s=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(s)}}}var as=function(a){return a.ActiveOptionClassName="l7-select-control-item-active",a.OptionValueAttrKey="data-option-value",a.OptionIndexAttrKey="data-option-index",a}(as||{});class gd extends null{constructor(...i){super(...i),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",s=>{const f=this.selectValue.includes(s.value),g=DOM.create("div",`l7-select-control-item ${f?as.ActiveOptionClassName:""}`);this.getIsMultiple()?g.appendChild(this.createCheckbox(f)):g.appendChild(this.createRadio(f)),s.icon&&g.appendChild(s.icon);const y=DOM.create("span");return y.innerText=s.text,g.appendChild(y),g}),_defineProperty(this,"onItemClick",s=>{if(this.getIsMultiple()){const f=this.selectValue.findIndex(g=>g===s.value);f>-1?this.selectValue.splice(f,1):this.selectValue=[...this.selectValue,s.value]}else this.selectValue=[s.value];this.setSelectValue(this.selectValue)})}setOptions(i){super.setOptions(i);const{options:s}=i;s&&this.popper.setContent(this.getPopperContent(s))}onAdd(){const i=super.onAdd(),{defaultValue:s}=this.controlOption;return s&&(this.selectValue=this.transSelectValue(s)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),i}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(i,s=!0){const f=this.transSelectValue(i);this.optionDOMList.forEach(g=>{const y=g.getAttribute(as.OptionValueAttrKey),_=g.querySelector("input[type=checkbox]"),O=g.querySelector("input[type=radio]"),A=f.includes(y),P=(B,U)=>{DOM.toggleClass(g,as.ActiveOptionClassName,U),B&&DOM.setChecked(B,U)};P(_,A),P(O,A)}),this.selectValue=f,s&&this.emit("selectChange",this.getIsMultiple()?f:f[0])}getIsMultiple(){return!1}getPopperContent(i){const s=this.isImageOptions(),f=DOM.create("div",s?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(f,"l7-select-control--multiple");const g=i.map((y,_)=>{const O=s?this.createImageOption(y):this.createNormalOption(y);return O.setAttribute(as.OptionValueAttrKey,y.value),O.setAttribute(as.OptionIndexAttrKey,window.String(_)),O.addEventListener("click",this.onItemClick.bind(this,y)),O});return f.append(...g),this.optionDOMList=g,f}createImageOption(i){const s=this.selectValue.includes(i.value),f=DOM.create("div",`l7-select-control-item ${s?as.ActiveOptionClassName:""}`),g=DOM.create("img");g.setAttribute("src",i.img),DOM.setUnDraggable(g),f.appendChild(g);const y=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&f.appendChild(this.createCheckbox(s));const _=DOM.create("span");return _.innerText=i.text,y.appendChild(_),f.appendChild(y),f}createCheckbox(i){const s=DOM.create("input");return s.setAttribute("type","checkbox"),i&&DOM.setChecked(s,!0),s}createRadio(i){const s=DOM.create("input");return s.setAttribute("type","radio"),i&&DOM.setChecked(s,!0),s}isImageOptions(){return!!this.controlOption.options.find(i=>i.img)}transSelectValue(i){return Array.isArray(i)?i:[i]}}const M0=a=>{const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.classList.add("l7-iconfont"),i.setAttribute("aria-hidden","true");const s=document.createElementNS("http://www.w3.org/2000/svg","use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${a}`),i.appendChild(s),i};class YL extends null{constructor(...i){var s;super(...i),s=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:f}=s.controlOption;f==null||f(yield s.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...f){var g,y;const{imageType:_}=s.controlOption,{width:O=0,height:A=0}=(g=(y=s.mapsService.getContainer())===null||y===void 0?void 0:y.getBoundingClientRect())!==null&&g!==void 0?g:{},P=document.createElement("canvas");P.width=O,P.height=A;const B=P.getContext("2d");return(yield Promise.all(f.map(G=>new Promise(vt=>{const $t=new Image;$t.onload=()=>{vt($t)},$t.src=G})))).forEach(G=>{B==null||B.drawImage(G,0,0,O,A)}),P.toDataURL(`image/${_}`)}))}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),i}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var i=this;return _asyncToGenerator(function*(){const s=yield i.mapsService.exportMap("png"),f=yield i.scene.exportPng("png");return i.mergeImage(...[s,f].filter(g=>g))})()}}const L0=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Wo=(()=>{if(typeof document=="undefined")return!1;const a=L0[0],i={};for(const s of L0)if((s==null?void 0:s[1])in document){for(const[g,y]of s.entries())i[a[g]]=y;return i}return!1})(),ss={change:Wo.fullscreenchange,error:Wo.fullscreenerror};let yi={request(a=document.documentElement,i){return new Promise((s,f)=>{const g=()=>{yi.off("change",g),s()};yi.on("change",g);const y=a[Wo.requestFullscreen](i);y instanceof Promise&&y.then(g).catch(f)})},exit(){return new Promise((a,i)=>{if(!yi.isFullscreen){a();return}const s=()=>{yi.off("change",s),a()};yi.on("change",s);const f=document[Wo.exitFullscreen]();f instanceof Promise&&f.then(s).catch(i)})},toggle(a,i){return yi.isFullscreen?yi.exit():yi.request(a,i)},onchange(a){yi.on("change",a)},onerror(a){yi.on("error",a)},on(a,i){const s=ss[a];s&&document.addEventListener(s,i,!1)},off(a,i){const s=ss[a];s&&document.removeEventListener(s,i,!1)},raw:Wo};Object.defineProperties(yi,{isFullscreen:{get:()=>!!document[Wo.fullscreenElement]},element:{enumerable:!0,get:()=>{var a;return(a=document[Wo.fullscreenElement])!==null&&a!==void 0?a:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[Wo.fullscreenEnabled]}}),Wo||(yi={isEnabled:!1});var $L=null;class P0 extends null{constructor(i){var s;super(i),s=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(s.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:f,btnIcon:g,title:y,exitBtnText:_,exitBtnIcon:O,exitTitle:A}=this.controlOption;this.isFullscreen?(this.setBtnTitle(A),this.setBtnText(_),this.setBtnIcon(O)):(this.setBtnTitle(y),this.setBtnText(f),this.setBtnIcon(g)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(i){const{exitBtnText:s,exitBtnIcon:f,exitTitle:g}=i;this.isFullscreen&&(this.checkUpdateOption(i,["exitBtnIcon"])&&this.setBtnIcon(f),this.checkUpdateOption(i,["exitBtnText"])&&this.setBtnText(s),this.checkUpdateOption(i,["exitTitle"])&&this.setBtnTitle(g)),super.setOptions(i)}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),i}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class bu extends null{constructor(i){var s;super(i),s=this,_defineProperty(this,"getGeoLocation",()=>new Promise((f,g)=>{window.navigator.geolocation.getCurrentPosition(({coords:y})=>{const{longitude:_,latitude:O}=y!=null?y:{};!isNaN(_)&&!isNaN(O)?f([_,O]):g()},y=>{g(y)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:f}=s.controlOption,g=yield s.getGeoLocation(),y=s.mapsService.getZoom();s.mapsService.setZoomAndCenter(y>15?y:15,f?yield f(g):g)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const i=super.onAdd();return i.addEventListener("click",this.onClick),i}}function Uc(a){return Object.keys(a!=null?a:{}).every(i=>["layer","name","img"].includes(i))}class NA extends null{constructor(...i){super(...i),_defineProperty(this,"onLayerChange",()=>{var s;(s=this.controlOption.layers)!==null&&s!==void 0&&s.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(s=>{const f=this.selectValue.includes(s.name),g=s.isVisible();f&&!g&&s.show(),!f&&g&&s.hide()})})}get layers(){const i=this.layerService,{layers:s}=this.controlOption;if(Array.isArray(s)&&s.length){const f=[];return s.forEach(g=>{if(g instanceof Object&&(Uc(g)?f.push(g.layer):f.push(g)),typeof g=="string"){const y=i.getLayer(g)||i.getLayerByName(g);y&&f.push(y)}}),f}return i.getLayers()||[]}getDefault(i){var s;return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(s=i==null?void 0:i.multiple)!==null&&s!==void 0?s:!0})}getLayerVisible(){return this.layers.filter(i=>i.isVisible()).map(i=>i.name)}getLayerOptions(){const{layers:i}=this.controlOption,s=i==null?void 0:i.every(f=>f.img);return i?i==null?void 0:i.map(f=>{if(Uc(f))return{text:f.name||f.layer.name,value:f.layer.name,img:s?f.img:void 0};if(typeof f=="string"){const g=this.layerService.getLayer(f)||this.layerService.getLayerByName(f);return{text:g==null?void 0:g.name,value:g==null?void 0:g.name}}return{text:f.name,value:f.name}}):this.layers.map(f=>({text:f.name,value:f.name}))}setOptions(i){const s=this.checkUpdateOption(i,["layers","multiple"]);super.setOptions(i),s&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((i,s)=>{s===0?i.show():i.hide()})}onAdd(){var i;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(i=this.controlOption.options)!==null&&i!==void 0&&i.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class Db extends ua{getDefault(){return{position:Vl.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const i=Fi("div","l7-control-logo");return this.setLogoContent(i),i}onRemove(){return null}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["img","href"])&&($h(this.container),this.setLogoContent(this.container))}setLogoContent(i){const{href:s,img:f}=this.controlOption,g=Fi("img");if(g.setAttribute("src",f),g.setAttribute("aria-label","AntV logo"),jO(g),s){const y=Fi("a","l7-control-logo-link");y.target="_blank",y.href=s,y.rel="noopener nofollow",y.setAttribute("rel","noopener nofollow"),y.appendChild(g),i.appendChild(y)}else i.appendChild(g)}}const BA={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},Vs={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class XL extends null{constructor(...i){super(...i),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const i=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([s,f])=>typeof f=="string"&&s!=="blank").map(([s,f])=>{var g;const{text:y,img:_}=(g=i[s])!==null&&g!==void 0?g:{};return{text:y!=null?y:s,value:f,img:_,key:s}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var i;if((i=this.controlOption.options)!==null&&i!==void 0&&i.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var s,f;const g=this.controlOption.defaultValue;this.controlOption.defaultValue=(s=(f=this.controlOption.options.find(y=>y.key===g))===null||f===void 0?void 0:f.value)!==null&&s!==void 0?s:g}else{const g=this.getMapStyle();g?this.controlOption.defaultValue=g:this.mapsService.map.once("styledata",()=>{const y=this.mapsService.getMapStyle();this.controlOption.defaultValue=y,this.setSelectValue(y,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class Fb extends null{constructor(...i){super(...i),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",s=>{let f=this.location;const g=s.lngLat||s.lnglat,{transform:y}=this.controlOption;g&&(f=[g.lng,g.lat]),this.location=f,y&&(f=y(f)),this.insertLocation2HTML(f),this.emit("locationChange",f)})}getLocation(){return this.location}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{position:PositionType.BOTTOMLEFT,transform:([s,f])=>[+(+s).toFixed(6),+(+f).toFixed(6)]})}onAdd(){const i=DOM.create("div","l7-control-mouse-location");return i.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),i}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(i){this.container.innerText=i.join(", ")}}class I0 extends null{constructor(...i){super(...i),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const s=this.mapsService,{maxWidth:f}=this.controlOption,g=s.getSize()[1]/2,y=s.containerToLngLat([0,g]),_=s.containerToLngLat([f,g]),O=lnglatDistance([y.lng,y.lat],[_.lng,_.lat]);this.updateScales(O)})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const s=DOM.create("div","l7-control-scale");this.resetScaleLines(s);const{updateWhenIdle:f}=this.controlOption;return this.mapsService.on(f?"moveend":"mapmove",this.update),this.mapsService.on(f?"zoomend":"zoomchange",this.update),s}onRemove(){const{updateWhenIdle:i}=this.controlOption;this.mapsService.off(i?"zoomend":"zoomchange",this.update),this.mapsService.off(i?"moveend":"mapmove",this.update)}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(i){const{metric:s,imperial:f}=this.controlOption;s&&i&&this.updateMetric(i),f&&i&&this.updateImperial(i)}resetScaleLines(i){DOM.clearChildren(i);const{metric:s,imperial:f,maxWidth:g,lockWidth:y}=this.controlOption;y&&DOM.addStyle(i,`width: ${g}px`),s&&(this.mScale=DOM.create("div","l7-control-scale-line",i)),f&&(this.iScale=DOM.create("div","l7-control-scale-line",i)),this.update()}updateScale(i,s,f){const{maxWidth:g}=this.controlOption;i.style.width=Math.round(g*f)+"px",i.innerHTML=s}getRoundNum(i){const s=Math.pow(10,(Math.floor(i)+"").length-1);let f=i/s;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,s*f}updateMetric(i){const s=this.getRoundNum(i),f=s<1e3?s+" m":s/1e3+" km";this.updateScale(this.mScale,f,s/i)}updateImperial(i){const s=i*3.2808399;let f,g,y;s>5280?(f=s/5280,g=this.getRoundNum(f),this.updateScale(this.iScale,g+" mi",g/f)):(y=this.getRoundNum(s),this.updateScale(this.iScale,y+" ft",y/s))}}class _u{constructor(){(0,ut.Z)(this,"mapService",void 0),(0,ut.Z)(this,"fontService",void 0)}apply(i,{styleAttributeService:s,mapService:f,fontService:g}){var y=this;this.mapService=f,this.fontService=g,i.hooks.init.tapPromise("DataMappingPlugin",(0,nn.Z)(function*(){i.log(Mi.MappingStart,Hi.INIT),y.generateMaping(i,{styleAttributeService:s}),i.log(Mi.MappingEnd,Hi.INIT)})),i.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var _=(0,nn.Z)(function*(O){if(!O)return O;i.dataState.dataMappingNeedUpdate=!1,i.log(Mi.MappingStart,Hi.UPDATE);const A=y.generateMaping(i,{styleAttributeService:s});return i.log(Mi.MappingEnd,Hi.UPDATE),A});return function(O){return _.apply(this,arguments)}}()),i.hooks.beforeRender.tap("DataMappingPlugin",()=>{const _=i.getSource();if(i.layerModelNeedUpdate||!_||!_.inited)return;const O=s.getLayerStyleAttributes()||[],A=s.getLayerStyleAttribute("filter"),{dataArray:P}=_.data;if(Array.isArray(P)&&P.length===0)return;const B=O.filter(G=>G.needRemapping);let U=P;if(A!=null&&A.needRemapping&&A!==null&&A!==void 0&&A.scale&&(U=P.filter(G=>this.applyAttributeMapping(A,G)[0])),B.length){const G=this.mapping(i,B,U,i.getEncodedData());i.setEncodedData(G)}})}generateMaping(i,{styleAttributeService:s}){const f=s.getLayerStyleAttributes()||[],g=s.getLayerStyleAttribute("filter"),{dataArray:y}=i.getSource().data;let _=y;g!=null&&g.scale&&(_=y.filter(A=>this.applyAttributeMapping(g,A)[0])),_=i.processData(_);const O=this.mapping(i,f,_,void 0);return i.setEncodedData(O),i.emit("dataUpdate",null),!0}mapping(i,s,f,g){const y=s.filter(O=>O.scale!==void 0).filter(O=>O.name!=="filter"),_=f.map((O,A)=>{const P=g?g[A]:{},B=(0,Je.Z)({id:O._id,coordinates:O.coordinates},P);return y.forEach(U=>{let G=this.applyAttributeMapping(U,O);(U.name==="color"||U.name==="stroke")&&(G=G.map(vt=>Lr(vt))),B[U.name]=Array.isArray(G)&&G.length===1?G[0]:G,U.name==="shape"&&(B.shape=this.fontService.getIconFontKey(B[U.name]))}),B});return s.forEach(O=>{O.needRemapping=!1}),this.adjustData2SimpleCoordinates(_),_}adjustData2SimpleCoordinates(i){i.length>0&&this.mapService.version==="SIMPLE"&&i.map(s=>{s.simpleCoordinate||(s.coordinates=this.unProjectCoordinates(s.coordinates),s.simpleCoordinate=!0)})}unProjectCoordinates(i){if(typeof i[0]=="number")return this.mapService.simpleMapCoord.unproject(i);if(i[0]&&i[0][0]instanceof Array){const s=[];return i.map(f=>{const g=[];f.map(y=>{g.push(this.mapService.simpleMapCoord.unproject(y))}),s.push(g)}),s}else{const s=[];return i.map(f=>{s.push(this.mapService.simpleMapCoord.unproject(f))}),s}}applyAttributeMapping(i,s){var f;if(!i.scale)return[];const g=(i==null||(f=i.scale)===null||f===void 0?void 0:f.scalers)||[],y=[];return g.forEach(({field:O})=>{var A;(s.hasOwnProperty(O)||((A=i.scale)===null||A===void 0?void 0:A.type)==="variable")&&y.push(s[O])}),i.mapping?i.mapping(y):[]}getArrowPoints(i,s){const f=[s[0]-i[0],s[1]-i[1]],g=XO(f);return[i[0]+g[0]*1e-4,i[1]+g[1]*1e-4]}}class Nb{constructor(){(0,ut.Z)(this,"mapService",void 0)}apply(i){var s=this;this.mapService=i.getContainer().mapService,i.hooks.init.tapPromise("DataSourcePlugin",(0,nn.Z)(function*(){i.log(Mi.SourceInitStart,Hi.INIT);let f=i.getSource();if(!f){const{data:g,options:y}=i.sourceOption||i.defaultSourceConfig;f=new FA(g,y),i.setSource(f)}f.inited?(s.updateClusterData(i),i.log(Mi.SourceInitEnd,Hi.INIT)):yield new Promise(g=>{f.on("update",y=>{y.type==="inited"&&(s.updateClusterData(i),i.log(Mi.SourceInitEnd,Hi.INIT)),g(null)})})})),i.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,nn.Z)(function*(){const f=s.updateClusterData(i),g=i.dataState.dataSourceNeedUpdate;return i.dataState.dataSourceNeedUpdate=!1,f||g}))}updateClusterData(i){if(i.isTileLayer||i.tileLayer||!i.getSource())return!1;const s=i.getSource(),f=s.cluster,{zoom:g=0}=s.clusterOptions,y=this.mapService.getZoom()-1,_=i.dataState.dataSourceNeedUpdate;return f&&_&&s.updateClusterData(Math.floor(y)),f&&Math.abs(i.clusterZoom-y)>=1?(g!==Math.floor(y)&&s.updateClusterData(Math.floor(y)),i.clusterZoom=y,!0):!1}}var jA=k(64599),xu=k.n(jA);function R0(a,i){var s,f;if(i===void 0){var g=xu()(a),y;try{for(g.s();!(y=g.n()).done;){var _=y.value;_!=null&&(s===void 0?_>=_&&(s=f=_):(s>_&&(s=_),f<_&&(f=_)))}}catch(U){g.e(U)}finally{g.f()}}else{var O=-1,A=xu()(a),P;try{for(A.s();!(P=A.n()).done;){var B=P.value;(B=i(B,++O,a))!=null&&(s===void 0?B>=B&&(s=f=B):(s>B&&(s=B),f<B&&(f=B)))}}catch(U){A.e(U)}finally{A.f()}}return[s,f]}function Bb(a,i,s,f,g){var y=a*a,_=y*a;return((1-3*a+3*y-_)*i+(4-6*y+3*_)*s+(1+3*a+3*y-3*_)*f+_*g)/6}function zA(a){var i=a.length-1;return function(s){var f=s<=0?s=0:s>=1?(s=1,i-1):Math.floor(s*i),g=a[f],y=a[f+1],_=f>0?a[f-1]:2*g-y,O=f<i-1?a[f+2]:2*y-g;return Bb((s-f/i)*i,_,g,y,O)}}function UA(a){var i=a.length;return function(s){var f=Math.floor(((s%=1)<0?++s:s)*i),g=a[(f+i-1)%i],y=a[f%i],_=a[(f+1)%i],O=a[(f+2)%i];return Bb((s-f/i)*i,g,y,_,O)}}function bi(a){return function(){return a}}function k0(a,i){return function(s){return a+s*i}}function ZA(a,i,s){return a=Math.pow(a,s),i=Math.pow(i,s)-a,s=1/s,function(f){return Math.pow(a+f*i,s)}}function qL(a,i){var s=i-a;return s?k0(a,s>180||s<-180?s-360*Math.round(s/360):s):constant(isNaN(a)?i:a)}function Kr(a){return(a=+a)==1?D0:function(i,s){return s-i?ZA(i,s,a):bi(isNaN(i)?s:i)}}function D0(a,i){var s=i-a;return s?k0(a,s):bi(isNaN(a)?i:a)}var F0=function a(i){var s=Kr(i);function f(g,y){var _=s((g=Yt(g)).r,(y=Yt(y)).r),O=s(g.g,y.g),A=s(g.b,y.b),P=D0(g.opacity,y.opacity);return function(B){return g.r=_(B),g.g=O(B),g.b=A(B),g.opacity=P(B),g+""}}return f.gamma=a,f}(1);function jb(a){return function(i){var s=i.length,f=new Array(s),g=new Array(s),y=new Array(s),_,O;for(_=0;_<s;++_)O=Yt(i[_]),f[_]=O.r||0,g[_]=O.g||0,y[_]=O.b||0;return f=a(f),g=a(g),y=a(y),O.opacity=1,function(A){return O.r=f(A),O.g=g(A),O.b=y(A),O+""}}}var zb=jb(zA),fa=jb(UA);function Da(a,i){return a<i?-1:a>i?1:a>=i?0:NaN}function Ub(a){return a.length===1&&(a=Zc(a)),{left:function(i,s,f,g){for(f==null&&(f=0),g==null&&(g=i.length);f<g;){var y=f+g>>>1;a(i[y],s)<0?f=y+1:g=y}return f},right:function(i,s,f,g){for(f==null&&(f=0),g==null&&(g=i.length);f<g;){var y=f+g>>>1;a(i[y],s)>0?g=y:f=y+1}return f}}}function Zc(a){return function(i,s){return Da(a(i),s)}}var Zb=Ub(Da),Hb=Zb.right,KL=Zb.left,cs=Hb,Vb=Array.prototype,QL=Vb.slice,JL=Vb.map,er=Math.sqrt(50),N0=Math.sqrt(10),B0=Math.sqrt(2);function Wb(a,i,s){var f,g=-1,y,_,O;if(i=+i,a=+a,s=+s,a===i&&s>0)return[a];if((f=i<a)&&(y=a,a=i,i=y),(O=vd(a,i,s))===0||!isFinite(O))return[];if(O>0)for(a=Math.ceil(a/O),i=Math.floor(i/O),_=new Array(y=Math.ceil(i-a+1));++g<y;)_[g]=(a+g)*O;else for(a=Math.floor(a*O),i=Math.ceil(i*O),_=new Array(y=Math.ceil(a-i+1));++g<y;)_[g]=(a-g)/O;return f&&_.reverse(),_}function vd(a,i,s){var f=(i-a)/Math.max(0,s),g=Math.floor(Math.log(f)/Math.LN10),y=f/Math.pow(10,g);return g>=0?(y>=er?10:y>=N0?5:y>=B0?2:1)*Math.pow(10,g):-Math.pow(10,-g)/(y>=er?10:y>=N0?5:y>=B0?2:1)}function j0(a,i,s){var f=Math.abs(i-a)/Math.max(0,s),g=Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),y=f/g;return y>=er?g*=10:y>=N0?g*=5:y>=B0&&(g*=2),i<a?-g:g}function t6(){var a=identity,i=extent,s=sturges;function f(g){var y,_=g.length,O,A=new Array(_);for(y=0;y<_;++y)A[y]=a(g[y],y,g);var P=i(A),B=P[0],U=P[1],G=s(A,B,U);Array.isArray(G)||(G=tickStep(B,U,G),G=range(Math.ceil(B/G)*G,U,G));for(var vt=G.length;G[0]<=B;)G.shift(),--vt;for(;G[vt-1]>U;)G.pop(),--vt;var $t=new Array(vt+1),te;for(y=0;y<=vt;++y)te=$t[y]=[],te.x0=y>0?G[y-1]:B,te.x1=y<vt?G[y]:U;for(y=0;y<_;++y)O=A[y],B<=O&&O<=U&&$t[bisect(G,O,0,vt)].push(g[y]);return $t}return f.value=function(g){return arguments.length?(a=typeof g=="function"?g:constant(g),f):a},f.domain=function(g){return arguments.length?(i=typeof g=="function"?g:constant([g[0],g[1]]),f):i},f.thresholds=function(g){return arguments.length?(s=typeof g=="function"?g:Array.isArray(g)?constant(slice.call(g)):constant(g),f):s},f}function e6(a,i,s){return a=map.call(a,number).sort(ascending),Math.ceil((s-i)/(2*(quantile(a,.75)-quantile(a,.25))*Math.pow(a.length,-1/3)))}function HA(a){return a===null?NaN:+a}function VA(a,i,s){if(s==null&&(s=HA),!!(f=a.length)){if((i=+i)<=0||f<2)return+s(a[0],0,a);if(i>=1)return+s(a[f-1],f-1,a);var f,g=(f-1)*i,y=Math.floor(g),_=+s(a[y],y,a),O=+s(a[y+1],y+1,a);return _+(O-_)*(g-y)}}var Fo="$";function md(){}md.prototype=Su.prototype={constructor:md,has:function(a){return Fo+a in this},get:function(a){return this[Fo+a]},set:function(a,i){return this[Fo+a]=i,this},remove:function(a){var i=Fo+a;return i in this&&delete this[i]},clear:function(){for(var a in this)a[0]===Fo&&delete this[a]},keys:function(){var a=[];for(var i in this)i[0]===Fo&&a.push(i.slice(1));return a},values:function(){var a=[];for(var i in this)i[0]===Fo&&a.push(this[i]);return a},entries:function(){var a=[];for(var i in this)i[0]===Fo&&a.push({key:i.slice(1),value:this[i]});return a},size:function(){var a=0;for(var i in this)i[0]===Fo&&++a;return a},empty:function(){for(var a in this)if(a[0]===Fo)return!1;return!0},each:function(a){for(var i in this)i[0]===Fo&&a(this[i],i.slice(1),this)}};function Su(a,i){var s=new md;if(a instanceof md)a.each(function(O,A){s.set(A,O)});else if(Array.isArray(a)){var f=-1,g=a.length,y;if(i==null)for(;++f<g;)s.set(f,a[f]);else for(;++f<g;)s.set(i(y=a[f],f,a),y)}else if(a)for(var _ in a)s.set(_,a[_]);return s}var Ou=Su;function Eu(){var a=[],i=[],s,f,g;function y(O,A,P,B){if(A>=a.length)return s!=null&&O.sort(s),f!=null?f(O):O;for(var U=-1,G=O.length,vt=a[A++],$t,te,Te=map(),Fe,Ze=P();++U<G;)(Fe=Te.get($t=vt(te=O[U])+""))?Fe.push(te):Te.set($t,[te]);return Te.each(function(je,Qe){B(Ze,Qe,y(je,A,P,B))}),Ze}function _(O,A){if(++A>a.length)return O;var P,B=i[A-1];return f!=null&&A>=a.length?P=O.entries():(P=[],O.each(function(U,G){P.push({key:G,values:_(U,A)})})),B!=null?P.sort(function(U,G){return B(U.key,G.key)}):P}return g={object:function(O){return y(O,0,Ws,Hc)},map:function(O){return y(O,0,Gs,Vc)},entries:function(O){return _(y(O,0,Gs,Vc),0)},key:function(O){return a.push(O),g},sortKeys:function(O){return i[a.length-1]=O,g},sortValues:function(O){return s=O,g},rollup:function(O){return f=O,g}}}function Ws(){return{}}function Hc(a,i,s){a[i]=s}function Gs(){return map()}function Vc(a,i,s){a.set(i,s)}function xo(){}var Ys=Ou.prototype;xo.prototype=WA.prototype={constructor:xo,has:Ys.has,add:function(a){return a+="",this[Fo+a]=a,this},remove:Ys.remove,clear:Ys.clear,values:Ys.keys,size:Ys.size,empty:Ys.empty,each:Ys.each};function WA(a,i){var s=new xo;if(a instanceof xo)a.each(function(y){s.add(y)});else if(a){var f=-1,g=a.length;if(i==null)for(;++f<g;)s.add(a[f]);else for(;++f<g;)s.add(i(a[f],f,a))}return s}var n6=null,Gb=Array.prototype,Yb=Gb.map,$s=Gb.slice;function ls(a,i){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(i).domain(a);break}return this}function z0(a,i){switch(arguments.length){case 0:break;case 1:this.interpolator(a);break;default:this.interpolator(i).domain(a);break}return this}var U0={name:"implicit"};function yd(){var a=Ou(),i=[],s=[],f=U0;function g(y){var _=y+"",O=a.get(_);if(!O){if(f!==U0)return f;a.set(_,O=i.push(y))}return s[(O-1)%s.length]}return g.domain=function(y){if(!arguments.length)return i.slice();i=[],a=Ou();for(var _=-1,O=y.length,A,P;++_<O;)a.has(P=(A=y[_])+"")||a.set(P,i.push(A));return g},g.range=function(y){return arguments.length?(s=$s.call(y),g):s.slice()},g.unknown=function(y){return arguments.length?(f=y,g):f},g.copy=function(){return yd(i,s).unknown(f)},ls.apply(g,arguments),g}function $b(){var a=ordinal().unknown(void 0),i=a.domain,s=a.range,f=[0,1],g,y,_=!1,O=0,A=0,P=.5;delete a.unknown;function B(){var U=i().length,G=f[1]<f[0],vt=f[G-0],$t=f[1-G];g=($t-vt)/Math.max(1,U-O+A*2),_&&(g=Math.floor(g)),vt+=($t-vt-g*(U-O))*P,y=g*(1-O),_&&(vt=Math.round(vt),y=Math.round(y));var te=sequence(U).map(function(Te){return vt+g*Te});return s(G?te.reverse():te)}return a.domain=function(U){return arguments.length?(i(U),B()):i()},a.range=function(U){return arguments.length?(f=[+U[0],+U[1]],B()):f.slice()},a.rangeRound=function(U){return f=[+U[0],+U[1]],_=!0,B()},a.bandwidth=function(){return y},a.step=function(){return g},a.round=function(U){return arguments.length?(_=!!U,B()):_},a.padding=function(U){return arguments.length?(O=Math.min(1,A=+U),B()):O},a.paddingInner=function(U){return arguments.length?(O=Math.min(1,U),B()):O},a.paddingOuter=function(U){return arguments.length?(A=+U,B()):A},a.align=function(U){return arguments.length?(P=Math.max(0,Math.min(1,U)),B()):P},a.copy=function(){return $b(i(),f).round(_).paddingInner(O).paddingOuter(A).align(P)},initRange.apply(B(),arguments)}function Z0(a){var i=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return Z0(i())},a}function Xb(){return Z0($b.apply(null,arguments).paddingInner(1))}function GA(a,i){return(isNumberArray(i)?numberArray:wu)(a,i)}function wu(a,i){var s=i?i.length:0,f=a?Math.min(s,a.length):0,g=new Array(f),y=new Array(s),_;for(_=0;_<f;++_)g[_]=xd(a[_],i[_]);for(;_<s;++_)y[_]=i[_];return function(O){for(_=0;_<f;++_)y[_]=g[_](O);return y}}function qb(a,i){var s=new Date;return a=+a,i=+i,function(f){return s.setTime(a*(1-f)+i*f),s}}function us(a,i){return a=+a,i=+i,function(s){return a*(1-s)+i*s}}function Qi(a,i){var s={},f={},g;(a===null||typeof a!="object")&&(a={}),(i===null||typeof i!="object")&&(i={});for(g in i)g in a?s[g]=xd(a[g],i[g]):f[g]=i[g];return function(y){for(g in s)f[g]=s[g](y);return f}}var bd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,H0=new RegExp(bd.source,"g");function Kb(a){return function(){return a}}function _d(a){return function(i){return a(i)+""}}function Xs(a,i){var s=bd.lastIndex=H0.lastIndex=0,f,g,y,_=-1,O=[],A=[];for(a=a+"",i=i+"";(f=bd.exec(a))&&(g=H0.exec(i));)(y=g.index)>s&&(y=i.slice(s,y),O[_]?O[_]+=y:O[++_]=y),(f=f[0])===(g=g[0])?O[_]?O[_]+=g:O[++_]=g:(O[++_]=null,A.push({i:_,x:us(f,g)})),s=H0.lastIndex;return s<i.length&&(y=i.slice(s),O[_]?O[_]+=y:O[++_]=y),O.length<2?A[0]?_d(A[0].x):Kb(i):(i=A.length,function(P){for(var B=0,U;B<i;++B)O[(U=A[B]).i]=U.x(P);return O.join("")})}function qs(a,i){i||(i=[]);var s=a?Math.min(i.length,a.length):0,f=i.slice(),g;return function(y){for(g=0;g<s;++g)f[g]=a[g]*(1-y)+i[g]*y;return f}}function Qb(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function xd(a,i){var s=typeof i,f;return i==null||s==="boolean"?bi(i):(s==="number"?us:s==="string"?(f=Ur(i))?(i=f,F0):Xs:i instanceof Ur?F0:i instanceof Date?qb:Qb(i)?qs:Array.isArray(i)?wu:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?Qi:us)(a,i)}function YA(a,i){return a=+a,i=+i,function(s){return Math.round(a*(1-s)+i*s)}}function Go(a){return function(){return a}}function Jb(a){return+a}var Au=[0,1];function Bi(a){return a}function Sd(a,i){return(i-=a=+a)?function(s){return(s-a)/i}:Go(isNaN(i)?NaN:.5)}function t_(a){var i=a[0],s=a[a.length-1],f;return i>s&&(f=i,i=s,s=f),function(g){return Math.max(i,Math.min(s,g))}}function $A(a,i,s){var f=a[0],g=a[1],y=i[0],_=i[1];return g<f?(f=Sd(g,f),y=s(_,y)):(f=Sd(f,g),y=s(y,_)),function(O){return y(f(O))}}function V0(a,i,s){var f=Math.min(a.length,i.length)-1,g=new Array(f),y=new Array(f),_=-1;for(a[f]<a[0]&&(a=a.slice().reverse(),i=i.slice().reverse());++_<f;)g[_]=Sd(a[_],a[_+1]),y[_]=s(i[_],i[_+1]);return function(O){var A=cs(a,O,1,f)-1;return y[A](g[A](O))}}function Tu(a,i){return i.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function W0(){var a=Au,i=Au,s=xd,f,g,y,_=Bi,O,A,P;function B(){return O=Math.min(a.length,i.length)>2?V0:$A,A=P=null,U}function U(G){return isNaN(G=+G)?y:(A||(A=O(a.map(f),i,s)))(f(_(G)))}return U.invert=function(G){return _(g((P||(P=O(i,a.map(f),us)))(G)))},U.domain=function(G){return arguments.length?(a=Yb.call(G,Jb),_===Bi||(_=t_(a)),B()):a.slice()},U.range=function(G){return arguments.length?(i=$s.call(G),B()):i.slice()},U.rangeRound=function(G){return i=$s.call(G),s=YA,B()},U.clamp=function(G){return arguments.length?(_=G?t_(a):Bi,U):_!==Bi},U.interpolate=function(G){return arguments.length?(s=G,B()):s},U.unknown=function(G){return arguments.length?(y=G,U):y},function(G,vt){return f=G,g=vt,B()}}function e_(a,i){return W0()(a,i)}var XA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fa(a){if(!(i=XA.exec(a)))throw new Error("invalid format: "+a);var i;return new n_({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}Fa.prototype=n_.prototype;function n_(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}n_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function r_(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function Od(a,i){if((s=(a=i?a.toExponential(i-1):a.toExponential()).indexOf("e"))<0)return null;var s,f=a.slice(0,s);return[f.length>1?f[0]+f.slice(2):f,+a.slice(s+1)]}function Cu(a){return a=Od(Math.abs(a)),a?a[1]:NaN}function $r(a,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cu(i)/3)))*3-Cu(Math.abs(a)))}function i_(a,i){return function(s,f){for(var g=s.length,y=[],_=0,O=a[0],A=0;g>0&&O>0&&(A+O+1>f&&(O=Math.max(1,f-A)),y.push(s.substring(g-=O,g+O)),!((A+=O+1)>f));)O=a[_=(_+1)%a.length];return y.reverse().join(i)}}function qA(a){return function(i){return i.replace(/[0-9]/g,function(s){return a[+s]})}}function o_(a){t:for(var i=a.length,s=1,f=-1,g;s<i;++s)switch(a[s]){case".":f=g=s;break;case"0":f===0&&(f=s),g=s;break;default:if(!+a[s])break t;f>0&&(f=0);break}return f>0?a.slice(0,f)+a.slice(g+1):a}var a_;function s_(a,i){var s=Od(a,i);if(!s)return a+"";var f=s[0],g=s[1],y=g-(a_=Math.max(-8,Math.min(8,Math.floor(g/3)))*3)+1,_=f.length;return y===_?f:y>_?f+new Array(y-_+1).join("0"):y>0?f.slice(0,y)+"."+f.slice(y):"0."+new Array(1-y).join("0")+Od(a,Math.max(0,i+y-1))[0]}function c_(a,i){var s=Od(a,i);if(!s)return a+"";var f=s[0],g=s[1];return g<0?"0."+new Array(-g).join("0")+f:f.length>g+1?f.slice(0,g+1)+"."+f.slice(g+1):f+new Array(g-f.length+2).join("0")}var G0={"%":function(a,i){return(a*100).toFixed(i)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:r_,e:function(a,i){return a.toExponential(i)},f:function(a,i){return a.toFixed(i)},g:function(a,i){return a.toPrecision(i)},o:function(a){return Math.round(a).toString(8)},p:function(a,i){return c_(a*100,i)},r:c_,s:s_,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function l_(a){return a}var Y0=Array.prototype.map,u_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function f_(a){var i=a.grouping===void 0||a.thousands===void 0?l_:i_(Y0.call(a.grouping,Number),a.thousands+""),s=a.currency===void 0?"":a.currency[0]+"",f=a.currency===void 0?"":a.currency[1]+"",g=a.decimal===void 0?".":a.decimal+"",y=a.numerals===void 0?l_:qA(Y0.call(a.numerals,String)),_=a.percent===void 0?"%":a.percent+"",O=a.minus===void 0?"-":a.minus+"",A=a.nan===void 0?"NaN":a.nan+"";function P(U){U=Fa(U);var G=U.fill,vt=U.align,$t=U.sign,te=U.symbol,Te=U.zero,Fe=U.width,Ze=U.comma,je=U.precision,Qe=U.trim,ln=U.type;ln==="n"?(Ze=!0,ln="g"):G0[ln]||(je===void 0&&(je=12),Qe=!0,ln="g"),(Te||G==="0"&&vt==="=")&&(Te=!0,G="0",vt="=");var wn=te==="$"?s:te==="#"&&/[boxX]/.test(ln)?"0"+ln.toLowerCase():"",mn=te==="$"?f:/[%p]/.test(ln)?_:"",Mn=G0[ln],rr=/[defgprs%]/.test(ln);je=je===void 0?6:/[gprs]/.test(ln)?Math.max(1,Math.min(21,je)):Math.max(0,Math.min(20,je));function Qn(Yn){var lr=wn,Rr=mn,qo,ml,fc;if(ln==="c")Rr=Mn(Yn)+Rr,Yn="";else{Yn=+Yn;var yl=Yn<0||1/Yn<0;if(Yn=isNaN(Yn)?A:Mn(Math.abs(Yn),je),Qe&&(Yn=o_(Yn)),yl&&+Yn==0&&$t!=="+"&&(yl=!1),lr=(yl?$t==="("?$t:O:$t==="-"||$t==="("?"":$t)+lr,Rr=(ln==="s"?u_[8+a_/3]:"")+Rr+(yl&&$t==="("?")":""),rr){for(qo=-1,ml=Yn.length;++qo<ml;)if(fc=Yn.charCodeAt(qo),48>fc||fc>57){Rr=(fc===46?g+Yn.slice(qo+1):Yn.slice(qo))+Rr,Yn=Yn.slice(0,qo);break}}}Ze&&!Te&&(Yn=i(Yn,1/0));var bl=lr.length+Yn.length+Rr.length,jo=bl<Fe?new Array(Fe-bl+1).join(G):"";switch(Ze&&Te&&(Yn=i(jo+Yn,jo.length?Fe-Rr.length:1/0),jo=""),vt){case"<":Yn=lr+Yn+Rr+jo;break;case"=":Yn=lr+jo+Yn+Rr;break;case"^":Yn=jo.slice(0,bl=jo.length>>1)+lr+Yn+Rr+jo.slice(bl);break;default:Yn=jo+lr+Yn+Rr;break}return y(Yn)}return Qn.toString=function(){return U+""},Qn}function B(U,G){var vt=P((U=Fa(U),U.type="f",U)),$t=Math.max(-8,Math.min(8,Math.floor(Cu(G)/3)))*3,te=Math.pow(10,-$t),Te=u_[8+$t/3];return function(Fe){return vt(te*Fe)+Te}}return{format:P,formatPrefix:B}}var Ed,wd,d_;h_({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function h_(a){return Ed=f_(a),wd=Ed.format,d_=Ed.formatPrefix,Ed}function KA(a,i){return a=Math.abs(a),i=Math.abs(i)-a,Math.max(0,Cu(i)-Cu(a))+1}function p_(a){return Math.max(0,-Cu(Math.abs(a)))}function QA(a,i,s,f){var g=j0(a,i,s),y;switch(f=Fa(f==null?",f":f),f.type){case"s":{var _=Math.max(Math.abs(a),Math.abs(i));return f.precision==null&&!isNaN(y=$r(g,_))&&(f.precision=y),d_(f,_)}case"":case"e":case"g":case"p":case"r":{f.precision==null&&!isNaN(y=KA(g,Math.max(Math.abs(a),Math.abs(i))))&&(f.precision=y-(f.type==="e"));break}case"f":case"%":{f.precision==null&&!isNaN(y=p_(g))&&(f.precision=y-(f.type==="%")*2);break}}return wd(f)}function Wc(a){var i=a.domain;return a.ticks=function(s){var f=i();return Wb(f[0],f[f.length-1],s==null?10:s)},a.tickFormat=function(s,f){var g=i();return QA(g[0],g[g.length-1],s==null?10:s,f)},a.nice=function(s){s==null&&(s=10);var f=i(),g=0,y=f.length-1,_=f[g],O=f[y],A;return O<_&&(A=_,_=O,O=A,A=g,g=y,y=A),A=vd(_,O,s),A>0?(_=Math.floor(_/A)*A,O=Math.ceil(O/A)*A,A=vd(_,O,s)):A<0&&(_=Math.ceil(_*A)/A,O=Math.floor(O*A)/A,A=vd(_,O,s)),A>0?(f[g]=Math.floor(_/A)*A,f[y]=Math.ceil(O/A)*A,i(f)):A<0&&(f[g]=Math.ceil(_*A)/A,f[y]=Math.floor(O*A)/A,i(f)),a},a}function g_(){var a=e_(Bi,Bi);return a.copy=function(){return Tu(a,g_())},ls.apply(a,arguments),Wc(a)}function v_(a){var i;function s(f){return isNaN(f=+f)?i:f}return s.invert=s,s.domain=s.range=function(f){return arguments.length?(a=map.call(f,number),s):a.slice()},s.unknown=function(f){return arguments.length?(i=f,s):i},s.copy=function(){return v_(a).unknown(i)},a=arguments.length?map.call(a,number):[0,1],linearish(s)}function m_(a,i){a=a.slice();var s=0,f=a.length-1,g=a[s],y=a[f],_;return y<g&&(_=s,s=f,f=_,_=g,g=y,y=_),a[s]=i.floor(g),a[f]=i.ceil(y),a}function $0(a){return Math.log(a)}function y_(a){return Math.exp(a)}function b_(a){return-Math.log(-a)}function JA(a){return-Math.exp(-a)}function __(a){return isFinite(a)?+("1e"+a):a<0?0:a}function t5(a){return a===10?__:a===Math.E?Math.exp:function(i){return Math.pow(a,i)}}function x_(a){return a===Math.E?Math.log:a===10&&Math.log10||a===2&&Math.log2||(a=Math.log(a),function(i){return Math.log(i)/a})}function S_(a){return function(i){return-a(-i)}}function O_(a){var i=a($0,y_),s=i.domain,f=10,g,y;function _(){return g=x_(f),y=t5(f),s()[0]<0?(g=S_(g),y=S_(y),a(b_,JA)):a($0,y_),i}return i.base=function(O){return arguments.length?(f=+O,_()):f},i.domain=function(O){return arguments.length?(s(O),_()):s()},i.ticks=function(O){var A=s(),P=A[0],B=A[A.length-1],U;(U=B<P)&&(G=P,P=B,B=G);var G=g(P),vt=g(B),$t,te,Te,Fe=O==null?10:+O,Ze=[];if(!(f%1)&&vt-G<Fe){if(G=Math.round(G)-1,vt=Math.round(vt)+1,P>0){for(;G<vt;++G)for(te=1,$t=y(G);te<f;++te)if(Te=$t*te,!(Te<P)){if(Te>B)break;Ze.push(Te)}}else for(;G<vt;++G)for(te=f-1,$t=y(G);te>=1;--te)if(Te=$t*te,!(Te<P)){if(Te>B)break;Ze.push(Te)}}else Ze=Wb(G,vt,Math.min(vt-G,Fe)).map(y);return U?Ze.reverse():Ze},i.tickFormat=function(O,A){if(A==null&&(A=f===10?".0e":","),typeof A!="function"&&(A=wd(A)),O===1/0)return A;O==null&&(O=10);var P=Math.max(1,f*O/i.ticks().length);return function(B){var U=B/y(Math.round(g(B)));return U*f<f-.5&&(U*=f),U<=P?A(B):""}},i.nice=function(){return s(m_(s(),{floor:function(O){return y(Math.floor(g(O)))},ceil:function(O){return y(Math.ceil(g(O)))}}))},i}function E_(){var a=O_(W0()).domain([1,10]);return a.copy=function(){return Tu(a,E_()).base(a.base())},ls.apply(a,arguments),a}function X0(a){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/a))}}function w_(a){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*a}}function A_(a){var i=1,s=a(X0(i),w_(i));return s.constant=function(f){return arguments.length?a(X0(i=+f),w_(i)):i},linearish(s)}function e5(){var a=A_(transformer());return a.copy=function(){return copy(a,e5()).constant(a.constant())},initRange.apply(a,arguments)}function q0(a){return function(i){return i<0?-Math.pow(-i,a):Math.pow(i,a)}}function n5(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function T_(a){return a<0?-a*a:a*a}function r5(a){var i=a(Bi,Bi),s=1;function f(){return s===1?a(Bi,Bi):s===.5?a(n5,T_):a(q0(s),q0(1/s))}return i.exponent=function(g){return arguments.length?(s=+g,f()):s},Wc(i)}function Ad(){var a=r5(W0());return a.copy=function(){return Tu(a,Ad()).exponent(a.exponent())},ls.apply(a,arguments),a}function r6(){return Ad.apply(null,arguments).exponent(.5)}function K0(){var a=[],i=[],s=[],f;function g(){var _=0,O=Math.max(1,i.length);for(s=new Array(O-1);++_<O;)s[_-1]=VA(a,_/O);return y}function y(_){return isNaN(_=+_)?f:i[cs(s,_)]}return y.invertExtent=function(_){var O=i.indexOf(_);return O<0?[NaN,NaN]:[O>0?s[O-1]:a[0],O<s.length?s[O]:a[a.length-1]]},y.domain=function(_){if(!arguments.length)return a.slice();a=[];for(var O=0,A=_.length,P;O<A;++O)P=_[O],P!=null&&!isNaN(P=+P)&&a.push(P);return a.sort(Da),g()},y.range=function(_){return arguments.length?(i=$s.call(_),g()):i.slice()},y.unknown=function(_){return arguments.length?(f=_,y):f},y.quantiles=function(){return s.slice()},y.copy=function(){return K0().domain(a).range(i).unknown(f)},ls.apply(y,arguments)}function C_(){var a=0,i=1,s=1,f=[.5],g=[0,1],y;function _(A){return A<=A?g[cs(f,A,0,s)]:y}function O(){var A=-1;for(f=new Array(s);++A<s;)f[A]=((A+1)*i-(A-s)*a)/(s+1);return _}return _.domain=function(A){return arguments.length?(a=+A[0],i=+A[1],O()):[a,i]},_.range=function(A){return arguments.length?(s=(g=$s.call(A)).length-1,O()):g.slice()},_.invertExtent=function(A){var P=g.indexOf(A);return P<0?[NaN,NaN]:P<1?[a,f[0]]:P>=s?[f[s-1],i]:[f[P-1],f[P]]},_.unknown=function(A){return arguments.length&&(y=A),_},_.thresholds=function(){return f.slice()},_.copy=function(){return C_().domain([a,i]).range(g).unknown(y)},ls.apply(Wc(_),arguments)}function Q0(){var a=[.5],i=[0,1],s,f=1;function g(y){return y<=y?i[cs(a,y,0,f)]:s}return g.domain=function(y){return arguments.length?(a=$s.call(y),f=Math.min(a.length,i.length-1),g):a.slice()},g.range=function(y){return arguments.length?(i=$s.call(y),f=Math.min(a.length,i.length-1),g):i.slice()},g.invertExtent=function(y){var _=i.indexOf(y);return[a[_-1],a[_]]},g.unknown=function(y){return arguments.length?(s=y,g):s},g.copy=function(){return Q0().domain(a).range(i).unknown(s)},ls.apply(g,arguments)}var J0=new Date,Td=new Date;function io(a,i,s,f){function g(y){return a(y=arguments.length===0?new Date:new Date(+y)),y}return g.floor=function(y){return a(y=new Date(+y)),y},g.ceil=function(y){return a(y=new Date(y-1)),i(y,1),a(y),y},g.round=function(y){var _=g(y),O=g.ceil(y);return y-_<O-y?_:O},g.offset=function(y,_){return i(y=new Date(+y),_==null?1:Math.floor(_)),y},g.range=function(y,_,O){var A=[],P;if(y=g.ceil(y),O=O==null?1:Math.floor(O),!(y<_)||!(O>0))return A;do A.push(P=new Date(+y)),i(y,O),a(y);while(P<y&&y<_);return A},g.filter=function(y){return io(function(_){if(_>=_)for(;a(_),!y(_);)_.setTime(_-1)},function(_,O){if(_>=_)if(O<0)for(;++O<=0;)for(;i(_,-1),!y(_););else for(;--O>=0;)for(;i(_,1),!y(_););})},s&&(g.count=function(y,_){return J0.setTime(+y),Td.setTime(+_),a(J0),a(Td),Math.floor(s(J0,Td))},g.every=function(y){return y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?g.filter(f?function(_){return f(_)%y===0}:function(_){return g.count(0,_)%y===0}):g}),g}var Cd=io(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,i){a.setFullYear(a.getFullYear()+i)},function(a,i){return i.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});Cd.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:io(function(i){i.setFullYear(Math.floor(i.getFullYear()/a)*a),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,s){i.setFullYear(i.getFullYear()+s*a)})};var Gc=Cd,i5=Cd.range,M_=io(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,i){a.setMonth(a.getMonth()+i)},function(a,i){return i.getMonth()-a.getMonth()+(i.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),L_=M_,i6=M_.range,Md=1e3,Mu=6e4,P_=36e5,tg=864e5,Ld=6048e5;function Na(a){return io(function(i){i.setDate(i.getDate()-(i.getDay()+7-a)%7),i.setHours(0,0,0,0)},function(i,s){i.setDate(i.getDate()+s*7)},function(i,s){return(s-i-(s.getTimezoneOffset()-i.getTimezoneOffset())*Mu)/Ld})}var Yc=Na(0),fs=Na(1),I_=Na(2),R_=Na(3),Ks=Na(4),o5=Na(5),da=Na(6),$c=Yc.range,a5=fs.range,rk=I_.range,k_=R_.range,o6=Ks.range,a6=o5.range,s6=da.range,Lu=io(function(a){a.setHours(0,0,0,0)},function(a,i){a.setDate(a.getDate()+i)},function(a,i){return(i-a-(i.getTimezoneOffset()-a.getTimezoneOffset())*Mu)/tg},function(a){return a.getDate()-1}),eg=Lu,ng=Lu.range,D_=io(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Md-a.getMinutes()*Mu)},function(a,i){a.setTime(+a+i*P_)},function(a,i){return(i-a)/P_},function(a){return a.getHours()}),s5=D_,c6=D_.range,F_=io(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Md)},function(a,i){a.setTime(+a+i*Mu)},function(a,i){return(i-a)/Mu},function(a){return a.getMinutes()}),Pd=F_,l6=F_.range,N_=io(function(a){a.setTime(a-a.getMilliseconds())},function(a,i){a.setTime(+a+i*Md)},function(a,i){return(i-a)/Md},function(a){return a.getUTCSeconds()}),c5=N_,u6=N_.range,Id=io(function(){},function(a,i){a.setTime(+a+i)},function(a,i){return i-a});Id.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?io(function(i){i.setTime(Math.floor(i/a)*a)},function(i,s){i.setTime(+i+s*a)},function(i,s){return(s-i)/a}):Id};var l5=Id,f6=Id.range;function Qs(a){return io(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-a)%7),i.setUTCHours(0,0,0,0)},function(i,s){i.setUTCDate(i.getUTCDate()+s*7)},function(i,s){return(s-i)/Ld})}var B_=Qs(0),Pu=Qs(1),j_=Qs(2),u5=Qs(3),Xc=Qs(4),z_=Qs(5),f5=Qs(6),d6=B_.range,h6=Pu.range,d5=j_.range,h5=u5.range,p6=Xc.range,g6=z_.range,v6=f5.range,U_=io(function(a){a.setUTCHours(0,0,0,0)},function(a,i){a.setUTCDate(a.getUTCDate()+i)},function(a,i){return(i-a)/tg},function(a){return a.getUTCDate()-1}),rg=U_,m6=U_.range,ig=io(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,i){a.setUTCFullYear(a.getUTCFullYear()+i)},function(a,i){return i.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});ig.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:io(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/a)*a),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,s){i.setUTCFullYear(i.getUTCFullYear()+s*a)})};var Iu=ig,y6=ig.range;function og(a){if(0<=a.y&&a.y<100){var i=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return i.setFullYear(a.y),i}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function ag(a){if(0<=a.y&&a.y<100){var i=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return i.setUTCFullYear(a.y),i}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function Js(a,i,s){return{y:a,m:i,d:s,H:0,M:0,S:0,L:0}}function Z_(a){var i=a.dateTime,s=a.date,f=a.time,g=a.periods,y=a.days,_=a.shortDays,O=a.months,A=a.shortMonths,P=qc(g),B=Kc(g),U=qc(y),G=Kc(y),vt=qc(_),$t=Kc(_),te=qc(O),Te=Kc(O),Fe=qc(A),Ze=Kc(A),je={a:yl,A:bl,b:jo,B:jC,c:null,d:X_,e:X_,f:K_,g:J_,G:F5,H:T5,I:C5,j:M5,L:q_,m:L5,M:P5,p:zC,q:UC,Q:a2,s:Yo,S:I5,u:R5,U:k5,V:D5,w:Rd,W:kd,x:null,X:null,y:Dd,Y:t2,Z:N5,"%":o2},Qe={a:ZC,A:HC,b:lS,B:VC,c:null,d:e2,e:e2,f:j5,g:Y5,G:X5,H:Fd,I:B5,j:So,L:n2,m:z5,M:U5,p:WC,q:uS,Q:a2,s:Yo,S:r2,u:Z5,U:ug,V:H5,w:V5,W:W5,x:null,X:null,y:G5,Y:$5,Z:q5,"%":o2},ln={a:Qn,A:Yn,b:lr,B:Rr,c:qo,d:W_,e:W_,f:E5,g:V_,G:H_,H:Y_,I:Y_,j:G_,L:O5,m:ds,M:b6,p:rr,q:S5,Q:A5,s:lg,S:$_,u:cg,U:y5,V:b5,w:m5,W:_5,x:ml,X:fc,y:V_,Y:H_,Z:x5,"%":w5};je.x=wn(s,je),je.X=wn(f,je),je.c=wn(i,je),Qe.x=wn(s,Qe),Qe.X=wn(f,Qe),Qe.c=wn(i,Qe);function wn(jn,gr){return function(Tr){var _n=[],go=-1,Qr=0,oo=jn.length,vo,bs,xh;for(Tr instanceof Date||(Tr=new Date(+Tr));++go<oo;)jn.charCodeAt(go)===37&&(_n.push(jn.slice(Qr,go)),(bs=sg[vo=jn.charAt(++go)])!=null?vo=jn.charAt(++go):bs=vo==="e"?" ":"0",(xh=gr[vo])&&(vo=xh(Tr,bs)),_n.push(vo),Qr=go+1);return _n.push(jn.slice(Qr,go)),_n.join("")}}function mn(jn,gr){return function(Tr){var _n=Js(1900,void 0,1),go=Mn(_n,jn,Tr+="",0),Qr,oo;if(go!=Tr.length)return null;if("Q"in _n)return new Date(_n.Q);if("s"in _n)return new Date(_n.s*1e3+("L"in _n?_n.L:0));if(gr&&!("Z"in _n)&&(_n.Z=0),"p"in _n&&(_n.H=_n.H%12+_n.p*12),_n.m===void 0&&(_n.m="q"in _n?_n.q:0),"V"in _n){if(_n.V<1||_n.V>53)return null;"w"in _n||(_n.w=1),"Z"in _n?(Qr=ag(Js(_n.y,0,1)),oo=Qr.getUTCDay(),Qr=oo>4||oo===0?Pu.ceil(Qr):Pu(Qr),Qr=rg.offset(Qr,(_n.V-1)*7),_n.y=Qr.getUTCFullYear(),_n.m=Qr.getUTCMonth(),_n.d=Qr.getUTCDate()+(_n.w+6)%7):(Qr=og(Js(_n.y,0,1)),oo=Qr.getDay(),Qr=oo>4||oo===0?fs.ceil(Qr):fs(Qr),Qr=eg.offset(Qr,(_n.V-1)*7),_n.y=Qr.getFullYear(),_n.m=Qr.getMonth(),_n.d=Qr.getDate()+(_n.w+6)%7)}else("W"in _n||"U"in _n)&&("w"in _n||(_n.w="u"in _n?_n.u%7:"W"in _n?1:0),oo="Z"in _n?ag(Js(_n.y,0,1)).getUTCDay():og(Js(_n.y,0,1)).getDay(),_n.m=0,_n.d="W"in _n?(_n.w+6)%7+_n.W*7-(oo+5)%7:_n.w+_n.U*7-(oo+6)%7);return"Z"in _n?(_n.H+=_n.Z/100|0,_n.M+=_n.Z%100,ag(_n)):og(_n)}}function Mn(jn,gr,Tr,_n){for(var go=0,Qr=gr.length,oo=Tr.length,vo,bs;go<Qr;){if(_n>=oo)return-1;if(vo=gr.charCodeAt(go++),vo===37){if(vo=gr.charAt(go++),bs=ln[vo in sg?gr.charAt(go++):vo],!bs||(_n=bs(jn,Tr,_n))<0)return-1}else if(vo!=Tr.charCodeAt(_n++))return-1}return _n}function rr(jn,gr,Tr){var _n=P.exec(gr.slice(Tr));return _n?(jn.p=B[_n[0].toLowerCase()],Tr+_n[0].length):-1}function Qn(jn,gr,Tr){var _n=vt.exec(gr.slice(Tr));return _n?(jn.w=$t[_n[0].toLowerCase()],Tr+_n[0].length):-1}function Yn(jn,gr,Tr){var _n=U.exec(gr.slice(Tr));return _n?(jn.w=G[_n[0].toLowerCase()],Tr+_n[0].length):-1}function lr(jn,gr,Tr){var _n=Fe.exec(gr.slice(Tr));return _n?(jn.m=Ze[_n[0].toLowerCase()],Tr+_n[0].length):-1}function Rr(jn,gr,Tr){var _n=te.exec(gr.slice(Tr));return _n?(jn.m=Te[_n[0].toLowerCase()],Tr+_n[0].length):-1}function qo(jn,gr,Tr){return Mn(jn,i,gr,Tr)}function ml(jn,gr,Tr){return Mn(jn,s,gr,Tr)}function fc(jn,gr,Tr){return Mn(jn,f,gr,Tr)}function yl(jn){return _[jn.getDay()]}function bl(jn){return y[jn.getDay()]}function jo(jn){return A[jn.getMonth()]}function jC(jn){return O[jn.getMonth()]}function zC(jn){return g[+(jn.getHours()>=12)]}function UC(jn){return 1+~~(jn.getMonth()/3)}function ZC(jn){return _[jn.getUTCDay()]}function HC(jn){return y[jn.getUTCDay()]}function lS(jn){return A[jn.getUTCMonth()]}function VC(jn){return O[jn.getUTCMonth()]}function WC(jn){return g[+(jn.getUTCHours()>=12)]}function uS(jn){return 1+~~(jn.getUTCMonth()/3)}return{format:function(jn){var gr=wn(jn+="",je);return gr.toString=function(){return jn},gr},parse:function(jn){var gr=mn(jn+="",!1);return gr.toString=function(){return jn},gr},utcFormat:function(jn){var gr=wn(jn+="",Qe);return gr.toString=function(){return jn},gr},utcParse:function(jn){var gr=mn(jn+="",!0);return gr.toString=function(){return jn},gr}}}var sg={"-":"",_:" ",0:"0"},ji=/^\s*\d+/,p5=/^%/,g5=/[\\^$*+?|[\]().{}]/g;function Ar(a,i,s){var f=a<0?"-":"",g=(f?-a:a)+"",y=g.length;return f+(y<s?new Array(s-y+1).join(i)+g:g)}function v5(a){return a.replace(g5,"\\$&")}function qc(a){return new RegExp("^(?:"+a.map(v5).join("|")+")","i")}function Kc(a){for(var i={},s=-1,f=a.length;++s<f;)i[a[s].toLowerCase()]=s;return i}function m5(a,i,s){var f=ji.exec(i.slice(s,s+1));return f?(a.w=+f[0],s+f[0].length):-1}function cg(a,i,s){var f=ji.exec(i.slice(s,s+1));return f?(a.u=+f[0],s+f[0].length):-1}function y5(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.U=+f[0],s+f[0].length):-1}function b5(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.V=+f[0],s+f[0].length):-1}function _5(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.W=+f[0],s+f[0].length):-1}function H_(a,i,s){var f=ji.exec(i.slice(s,s+4));return f?(a.y=+f[0],s+f[0].length):-1}function V_(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.y=+f[0]+(+f[0]>68?1900:2e3),s+f[0].length):-1}function x5(a,i,s){var f=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(s,s+6));return f?(a.Z=f[1]?0:-(f[2]+(f[3]||"00")),s+f[0].length):-1}function S5(a,i,s){var f=ji.exec(i.slice(s,s+1));return f?(a.q=f[0]*3-3,s+f[0].length):-1}function ds(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.m=f[0]-1,s+f[0].length):-1}function W_(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.d=+f[0],s+f[0].length):-1}function G_(a,i,s){var f=ji.exec(i.slice(s,s+3));return f?(a.m=0,a.d=+f[0],s+f[0].length):-1}function Y_(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.H=+f[0],s+f[0].length):-1}function b6(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.M=+f[0],s+f[0].length):-1}function $_(a,i,s){var f=ji.exec(i.slice(s,s+2));return f?(a.S=+f[0],s+f[0].length):-1}function O5(a,i,s){var f=ji.exec(i.slice(s,s+3));return f?(a.L=+f[0],s+f[0].length):-1}function E5(a,i,s){var f=ji.exec(i.slice(s,s+6));return f?(a.L=Math.floor(f[0]/1e3),s+f[0].length):-1}function w5(a,i,s){var f=p5.exec(i.slice(s,s+1));return f?s+f[0].length:-1}function A5(a,i,s){var f=ji.exec(i.slice(s));return f?(a.Q=+f[0],s+f[0].length):-1}function lg(a,i,s){var f=ji.exec(i.slice(s));return f?(a.s=+f[0],s+f[0].length):-1}function X_(a,i){return Ar(a.getDate(),i,2)}function T5(a,i){return Ar(a.getHours(),i,2)}function C5(a,i){return Ar(a.getHours()%12||12,i,2)}function M5(a,i){return Ar(1+eg.count(Gc(a),a),i,3)}function q_(a,i){return Ar(a.getMilliseconds(),i,3)}function K_(a,i){return q_(a,i)+"000"}function L5(a,i){return Ar(a.getMonth()+1,i,2)}function P5(a,i){return Ar(a.getMinutes(),i,2)}function I5(a,i){return Ar(a.getSeconds(),i,2)}function R5(a){var i=a.getDay();return i===0?7:i}function k5(a,i){return Ar(Yc.count(Gc(a)-1,a),i,2)}function Q_(a){var i=a.getDay();return i>=4||i===0?Ks(a):Ks.ceil(a)}function D5(a,i){return a=Q_(a),Ar(Ks.count(Gc(a),a)+(Gc(a).getDay()===4),i,2)}function Rd(a){return a.getDay()}function kd(a,i){return Ar(fs.count(Gc(a)-1,a),i,2)}function Dd(a,i){return Ar(a.getFullYear()%100,i,2)}function J_(a,i){return a=Q_(a),Ar(a.getFullYear()%100,i,2)}function t2(a,i){return Ar(a.getFullYear()%1e4,i,4)}function F5(a,i){var s=a.getDay();return a=s>=4||s===0?Ks(a):Ks.ceil(a),Ar(a.getFullYear()%1e4,i,4)}function N5(a){var i=a.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+Ar(i/60|0,"0",2)+Ar(i%60,"0",2)}function e2(a,i){return Ar(a.getUTCDate(),i,2)}function Fd(a,i){return Ar(a.getUTCHours(),i,2)}function B5(a,i){return Ar(a.getUTCHours()%12||12,i,2)}function So(a,i){return Ar(1+rg.count(Iu(a),a),i,3)}function n2(a,i){return Ar(a.getUTCMilliseconds(),i,3)}function j5(a,i){return n2(a,i)+"000"}function z5(a,i){return Ar(a.getUTCMonth()+1,i,2)}function U5(a,i){return Ar(a.getUTCMinutes(),i,2)}function r2(a,i){return Ar(a.getUTCSeconds(),i,2)}function Z5(a){var i=a.getUTCDay();return i===0?7:i}function ug(a,i){return Ar(B_.count(Iu(a)-1,a),i,2)}function i2(a){var i=a.getUTCDay();return i>=4||i===0?Xc(a):Xc.ceil(a)}function H5(a,i){return a=i2(a),Ar(Xc.count(Iu(a),a)+(Iu(a).getUTCDay()===4),i,2)}function V5(a){return a.getUTCDay()}function W5(a,i){return Ar(Pu.count(Iu(a)-1,a),i,2)}function G5(a,i){return Ar(a.getUTCFullYear()%100,i,2)}function Y5(a,i){return a=i2(a),Ar(a.getUTCFullYear()%100,i,2)}function $5(a,i){return Ar(a.getUTCFullYear()%1e4,i,4)}function X5(a,i){var s=a.getUTCDay();return a=s>=4||s===0?Xc(a):Xc.ceil(a),Ar(a.getUTCFullYear()%1e4,i,4)}function q5(){return"+0000"}function o2(){return"%"}function a2(a){return+a}function Yo(a){return Math.floor(+a/1e3)}var Ba,fg,ha,K5,Qc;Q5({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Q5(a){return Ba=Z_(a),fg=Ba.format,ha=Ba.parse,K5=Ba.utcFormat,Qc=Ba.utcParse,Ba}var Jc=1e3,Ru=Jc*60,ku=Ru*60,Du=ku*24,J5=Du*7,s2=Du*30,dg=Du*365;function tT(a){return new Date(a)}function eT(a){return a instanceof Date?+a:+new Date(+a)}function c2(a,i,s,f,g,y,_,O,A){var P=e_(Bi,Bi),B=P.invert,U=P.domain,G=A(".%L"),vt=A(":%S"),$t=A("%I:%M"),te=A("%I %p"),Te=A("%a %d"),Fe=A("%b %d"),Ze=A("%B"),je=A("%Y"),Qe=[[_,1,Jc],[_,5,5*Jc],[_,15,15*Jc],[_,30,30*Jc],[y,1,Ru],[y,5,5*Ru],[y,15,15*Ru],[y,30,30*Ru],[g,1,ku],[g,3,3*ku],[g,6,6*ku],[g,12,12*ku],[f,1,Du],[f,2,2*Du],[s,1,J5],[i,1,s2],[i,3,3*s2],[a,1,dg]];function ln(mn){return(_(mn)<mn?G:y(mn)<mn?vt:g(mn)<mn?$t:f(mn)<mn?te:i(mn)<mn?s(mn)<mn?Te:Fe:a(mn)<mn?Ze:je)(mn)}function wn(mn,Mn,rr,Qn){if(mn==null&&(mn=10),typeof mn=="number"){var Yn=Math.abs(rr-Mn)/mn,lr=Ub(function(Rr){return Rr[2]}).right(Qe,Yn);lr===Qe.length?(Qn=j0(Mn/dg,rr/dg,mn),mn=a):lr?(lr=Qe[Yn/Qe[lr-1][2]<Qe[lr][2]/Yn?lr-1:lr],Qn=lr[1],mn=lr[0]):(Qn=Math.max(j0(Mn,rr,mn),1),mn=O)}return Qn==null?mn:mn.every(Qn)}return P.invert=function(mn){return new Date(B(mn))},P.domain=function(mn){return arguments.length?U(Yb.call(mn,eT)):U().map(tT)},P.ticks=function(mn,Mn){var rr=U(),Qn=rr[0],Yn=rr[rr.length-1],lr=Yn<Qn,Rr;return lr&&(Rr=Qn,Qn=Yn,Yn=Rr),Rr=wn(mn,Qn,Yn,Mn),Rr=Rr?Rr.range(Qn,Yn+1):[],lr?Rr.reverse():Rr},P.tickFormat=function(mn,Mn){return Mn==null?ln:A(Mn)},P.nice=function(mn,Mn){var rr=U();return(mn=wn(mn,rr[0],rr[rr.length-1],Mn))?U(m_(rr,mn)):P},P.copy=function(){return Tu(P,c2(a,i,s,f,g,y,_,O,A))},P}function nT(){return ls.apply(c2(Gc,L_,Yc,eg,s5,Pd,c5,l5,fg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function _6(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Nd(){var a=0,i=1,s,f,g,y,_=Bi,O=!1,A;function P(B){return isNaN(B=+B)?A:_(g===0?.5:(B=(y(B)-s)*g,O?Math.max(0,Math.min(1,B)):B))}return P.domain=function(B){return arguments.length?(s=y(a=+B[0]),f=y(i=+B[1]),g=s===f?0:1/(f-s),P):[a,i]},P.clamp=function(B){return arguments.length?(O=!!B,P):O},P.interpolator=function(B){return arguments.length?(_=B,P):_},P.unknown=function(B){return arguments.length?(A=B,P):A},function(B){return y=B,s=B(a),f=B(i),g=s===f?0:1/(f-s),P}}function Fu(a,i){return i.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function hg(){var a=Wc(Nd()(Bi));return a.copy=function(){return Fu(a,hg())},z0.apply(a,arguments)}function rT(){var a=loggish(Nd()).domain([1,10]);return a.copy=function(){return Fu(a,rT()).base(a.base())},initInterpolator.apply(a,arguments)}function iT(){var a=symlogish(Nd());return a.copy=function(){return Fu(a,iT()).constant(a.constant())},initInterpolator.apply(a,arguments)}function l2(){var a=powish(Nd());return a.copy=function(){return Fu(a,l2()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function x6(){return l2.apply(null,arguments).exponent(.5)}function oT(){var a=[],i=identity;function s(f){if(!isNaN(f=+f))return i((bisect(a,f)-1)/(a.length-1))}return s.domain=function(f){if(!arguments.length)return a.slice();a=[];for(var g=0,y=f.length,_;g<y;++g)_=f[g],_!=null&&!isNaN(_=+_)&&a.push(_);return a.sort(ascending),s},s.interpolator=function(f){return arguments.length?(i=f,s):i},s.copy=function(){return oT(i).domain(a)},initInterpolator.apply(s,arguments)}function No(){var a=0,i=.5,s=1,f,g,y,_,O,A=Bi,P,B=!1,U;function G(vt){return isNaN(vt=+vt)?U:(vt=.5+((vt=+P(vt))-g)*(vt<g?_:O),A(B?Math.max(0,Math.min(1,vt)):vt))}return G.domain=function(vt){return arguments.length?(f=P(a=+vt[0]),g=P(i=+vt[1]),y=P(s=+vt[2]),_=f===g?0:.5/(g-f),O=g===y?0:.5/(y-g),G):[a,i,s]},G.clamp=function(vt){return arguments.length?(B=!!vt,G):B},G.interpolator=function(vt){return arguments.length?(A=vt,G):A},G.unknown=function(vt){return arguments.length?(U=vt,G):U},function(vt){return P=vt,f=vt(a),g=vt(i),y=vt(s),_=f===g?0:.5/(g-f),O=g===y?0:.5/(y-g),G}}function ja(){var a=Wc(No()(Bi));return a.copy=function(){return Fu(a,ja())},z0.apply(a,arguments)}function pg(){var a=loggish(No()).domain([.1,1,10]);return a.copy=function(){return copy(a,pg()).base(a.base())},initInterpolator.apply(a,arguments)}function u2(){var a=symlogish(No());return a.copy=function(){return copy(a,u2()).constant(a.constant())},initInterpolator.apply(a,arguments)}function f2(){var a=powish(No());return a.copy=function(){return copy(a,f2()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function S6(){return f2.apply(null,arguments).exponent(.5)}function d2(a){let i,s=[];function f(g){return g==null?i:g}return f.invert=f,f.domain=f.range=g=>g?(s=g,g):s,f.unknown=g=>g?(i=g,g):i,f.copy=()=>d2(a).unknown(i),f}const{isNil:Bd,isString:aT,uniq:sT}=Nr,h2=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,gg={[Hn.LINEAR]:g_,[Hn.POWER]:Ad,[Hn.LOG]:E_,[Hn.IDENTITY]:d2,[Hn.SEQUENTIAL]:hg,[Hn.TIME]:nT,[Hn.QUANTILE]:K0,[Hn.QUANTIZE]:C_,[Hn.THRESHOLD]:Q0,[Hn.CAT]:yd,[Hn.DIVERGING]:ja};class p2{constructor(){(0,ut.Z)(this,"scaleOptions",{})}apply(i,{styleAttributeService:s}){var f=this;i.hooks.init.tapPromise("FeatureScalePlugin",(0,nn.Z)(function*(){var g;i.log(Mi.ScaleInitStart,Hi.INIT),f.scaleOptions=i.getScaleOptions();const y=s.getLayerStyleAttributes(),_=(g=i.getSource())===null||g===void 0?void 0:g.data.dataArray;Array.isArray(_)&&_.length===0||(f.caculateScalesForAttributes(y||[],_),i.log(Mi.ScaleInitEnd,Hi.INIT))})),i.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var g=(0,nn.Z)(function*(y){if(!y)return y;i.log(Mi.ScaleInitStart,Hi.UPDATE),f.scaleOptions=i.getScaleOptions();const _=s.getLayerStyleAttributes(),O=i.getSource().data.dataArray;return Array.isArray(O)&&O.length===0||(f.caculateScalesForAttributes(_||[],O),i.log(Mi.ScaleInitEnd,Hi.UPDATE),i.layerModelNeedUpdate=!0),!0});return function(y){return g.apply(this,arguments)}}()),i.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(i.layerModelNeedUpdate)return;this.scaleOptions=i.getScaleOptions();const g=s.getLayerStyleAttributes(),y=i.getSource().data.dataArray;if(!(Array.isArray(y)&&y.length===0)&&g){const _=g.filter(O=>O.needRescale);_.length&&this.caculateScalesForAttributes(_,y)}})}isNumber(i){return!isNaN(parseFloat(i))&&isFinite(i)}caculateScalesForAttributes(i,s){i.forEach(f=>{if(f.scale){const g=f.scale,y=f.scale.field;g.names=this.parseFields(Bd(y)?[]:y);const _=[];g.names.forEach(O=>{var A;_.push(this.createScale(O,f.name,(A=f.scale)===null||A===void 0?void 0:A.values,s))}),_.some(O=>O.type===Gl.VARIABLE)?(g.type=Gl.VARIABLE,_.forEach(O=>{if(!g.callback&&g.values!=="text"){var A;switch((A=O.option)===null||A===void 0?void 0:A.type){case Hn.LOG:case Hn.LINEAR:case Hn.POWER:if(g.values&&g.values.length>2){const B=O.scale.ticks(g.values.length);O.scale.domain(B)}g.values?O.scale.range(g.values):O.scale.range(O.option.domain);break;case Hn.QUANTILE:case Hn.QUANTIZE:case Hn.THRESHOLD:O.scale.range(g.values);break;case Hn.IDENTITY:break;case Hn.CAT:g.values?O.scale.range(g.values):O.scale.range(O.option.domain);break;case Hn.DIVERGING:case Hn.SEQUENTIAL:O.scale.interpolator(zb(g.values));break}}if(g.values==="text"){var P;O.scale.range((P=O.option)===null||P===void 0?void 0:P.domain)}})):(g.type=Gl.CONSTANT,g.defaultValues=_.map((O,A)=>O.scale(g.names[A]))),g.scalers=_.map(O=>({field:O.field,func:O.scale,option:O.option})),f.needRescale=!1}})}parseFields(i){return Array.isArray(i)?i:aT(i)?i.split("*"):[i]}createScale(i,s,f,g){var y,_;const O=this.scaleOptions[s]&&((y=this.scaleOptions[s])===null||y===void 0?void 0:y.field)===i?this.scaleOptions[s]:this.scaleOptions[i],A={field:i,scale:void 0,type:Gl.VARIABLE,option:O};if(!g||!g.length)return O&&O.type?A.scale=this.createDefaultScale(O):(A.scale=yd([i]),A.type=Gl.CONSTANT),A;const P=(_=g.find(B=>!Bd(B[i])))===null||_===void 0?void 0:_[i];if(this.isNumber(i)||Bd(P)&&!O)A.scale=yd([i]),A.type=Gl.CONSTANT;else{let B=O&&O.type||this.getDefaultType(P);f==="text"&&(B=Hn.CAT),f===void 0&&(B=Hn.IDENTITY);const U=this.createScaleConfig(B,i,O,g);A.scale=this.createDefaultScale(U),A.option=U}return A}getDefaultType(i){let s=Hn.LINEAR;return typeof i=="string"&&(s=h2.test(i)?Hn.TIME:Hn.CAT),s}createScaleConfig(i,s,f,g){const y={type:i};let _=[];if(i===Hn.QUANTILE){const O=new Map;g==null||g.forEach(A=>{O.set(A._id,A[s])}),_=Array.from(O.values())}else _=(g==null?void 0:g.map(O=>O[s]))||[];if(f!=null&&f.domain)y.domain=f==null?void 0:f.domain;else if(i===Hn.CAT||i===Hn.IDENTITY)y.domain=sT(_);else if(i===Hn.QUANTILE)y.domain=_;else if(i===Hn.DIVERGING){const O=R0(_),A=(f==null?void 0:f.neutral)!==void 0?f==null?void 0:f.neutral:(O[0]+O[1])/2;y.domain=[O[0],A,O[1]]}else y.domain=R0(_);return(0,Je.Z)((0,Je.Z)({},y),f)}createDefaultScale({type:i,domain:s,unknown:f,clamp:g,nice:y}){const _=gg[i]();return s&&_.domain&&_.domain(s),f&&_.unknown(f),g!==void 0&&_.clamp&&_.clamp(g),y!==void 0&&_.nice&&_.nice(y),_}}class vg{apply(i){i.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{i.animateStatus&&i.models.forEach(f=>{f.addUniforms((0,Je.Z)({},i.layerModel.getAnimateUniforms()))})})}}class cT{apply(i){i.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:s,enableMask:f}=i.getLayerConfig();!i.tileLayer&&s&&s.length>0&&i.updateLayerConfig({mask:f})})}}class lT{build(i){return(0,nn.Z)(function*(){i.prepareBuildModel(),yield i.buildModels()})()}initLayerModel(i){var s=this;return(0,nn.Z)(function*(){yield s.build(i),i.styleNeedUpdate=!1})()}prepareLayerModel(i){var s=this;return(0,nn.Z)(function*(){yield s.build(i),i.styleNeedUpdate=!1})()}apply(i){var s=this;i.hooks.init.tapPromise("LayerModelPlugin",(0,nn.Z)(function*(){if(i.getSource().isTile){i.prepareBuildModel();return}i.log(Mi.BuildModelStart,Hi.INIT),yield s.initLayerModel(i),i.log(Mi.BuildModelEnd,Hi.INIT)})),i.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var f=(0,nn.Z)(function*(g){return!g||i.getSource().isTile?!1:(i.log(Mi.BuildModelStart,Hi.UPDATE),yield s.prepareLayerModel(i),i.log(Mi.BuildModelEnd,Hi.UPDATE),!0)});return function(g){return f.apply(this,arguments)}}())}}class uT{apply(i){i.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:s,fitBoundsOptions:f}=i.getLayerConfig();s&&i.fitBounds(f),i.styleNeedUpdate=!1})}}const fT=["type"],g2={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},dT={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},v2={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},hT={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function pT(a){const i={u_DirectionalLights:new Array(3).fill((0,Je.Z)({},v2)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,Je.Z)({},hT)),u_NumOfSpotLights:0};return(!a||!a.length)&&(a=[dT]),a.forEach(s=>{let{type:f="directional"}=s,g=(0,ia.Z)(s,fT);const y=g2[f].lights,_=g2[f].num,O=i[_];i[y][O]=(0,Je.Z)((0,Je.Z)({},i[y][O]),g),i[_]++}),i}class gT{apply(i){i.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:s}=i.getLayerConfig();s&&i.models.forEach(f=>f.addUniforms((0,Je.Z)({},pT())))})}}function m2(a){return a.map(i=>(typeof i=="string"&&(i=[i,{}]),i))}function mg(a,i,s,f){const g=a.multiPassRenderer;return g.add(f("render")),m2(i).forEach(y=>{const[_,O]=y;g.add(s(_),O)}),g.add(s("copy")),g}class yg{constructor(){(0,ut.Z)(this,"enabled",void 0)}apply(i,{rendererService:s,postProcessingPassFactory:f,normalPassFactory:g}){i.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:y,passes:_=[]}=i.getLayerConfig();this.enabled=!!y&&i.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(i.multiPassRenderer=mg(i,_,f,g),i.multiPassRenderer.setRenderFlag(!0))}),i.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:y,height:_}=s.getViewportSize();i.multiPassRenderer.resize(y,_)}})}}const hs={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function vT(a){switch(a){case"rotation":return{name:"Rotation",type:In.Attribute,descriptor:{name:"a_Rotation",shaderLocation:hs.ROTATION,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{rotation:s=0}=i;return Array.isArray(s)?[s[0]]:[s]}}};case"stroke":return{name:"stroke",type:In.Attribute,descriptor:{name:"a_Stroke",shaderLocation:hs.STROKE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:4,update:i=>{const{stroke:s=[1,1,1,1]}=i;return s}}};case"opacity":return{name:"opacity",type:In.Attribute,descriptor:{name:"a_Opacity",shaderLocation:hs.OPACITY,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{opacity:s=1}=i;return[s]}}};case"offsets":return{name:"offsets",type:In.Attribute,descriptor:{name:"a_Offsets",shaderLocation:hs.OFFSETS,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const{offsets:s}=i;return s}}};default:return}}const{isNumber:mT}=Nr,tl={NONE:0,ENCODE:1,HIGHLIGHT:2};class y2{constructor(){(0,ut.Z)(this,"pickingUniformMap",void 0)}pickOption2Array(){const i=[];return this.pickingUniformMap.forEach(s=>{mT(s)?i.push(s):i.push(...s)}),i}updatePickOption(i,s){Object.keys(i).forEach(_=>{this.pickingUniformMap.set(_,i[_])});const f=s.getLayerConfig().pickingBuffer||0,g=Number(s.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",f),this.pickingUniformMap.set("u_shaderPick",g),s.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(i,{styleAttributeService:s}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),i.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();s.registerStyleAttribute({name:"pickingColor",type:In.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:hs.PICKING_COLOR,buffer:{data:[],type:at.FLOAT},size:3,update:g=>{const{id:y}=g;return f?_c(y):[0,0,0]}}})}),i.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();f&&i.isVisible()&&(this.updatePickOption({u_PickingStage:tl.ENCODE},i),i.models.forEach(g=>g.addUniforms({u_PickingStage:tl.ENCODE})))}),i.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:f}=i.getLayerConfig();f&&i.isVisible()&&(this.updatePickOption({u_PickingStage:tl.HIGHLIGHT},i),i.models.forEach(g=>g.addUniforms({u_PickingStage:tl.HIGHLIGHT})))}),i.hooks.beforeHighlight.tap("PixelPickingPlugin",f=>{const{highlightColor:g,activeMix:y=0}=i.getLayerConfig(),_=typeof g=="string"?Lr(g):g||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:Os(new Uint8Array(f))});const O={u_PickingStage:tl.HIGHLIGHT,u_PickingColor:f,u_HighlightColor:_.map(A=>A*255),u_activeMix:y};this.updatePickOption(O,i),i.models.forEach(A=>A.addUniforms(O))}),i.hooks.beforeSelect.tap("PixelPickingPlugin",f=>{const{selectColor:g,selectMix:y=0}=i.getLayerConfig(),_=typeof g=="string"?Lr(g):g||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:Os(new Uint8Array(f))});const O={u_PickingStage:tl.HIGHLIGHT,u_PickingColor:f,u_HighlightColor:_.map(A=>A*255),u_activeMix:y,u_CurrentSelectedId:f,u_SelectColor:_.map(A=>A*255)};this.updatePickOption(O,i),i.models.forEach(A=>A.addUniforms(O))})}}const jd=["mvt","geojsonvt","testTile"];function b2(a){const i=a.getSource();return jd.includes(i.parser.type)}class _2{apply(i,{styleAttributeService:s}){i.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{b2(i)||this.registerBuiltinAttributes(s,i)})}registerBuiltinAttributes(i,s){if(s.type==="MaskLayer"){this.registerPositionAttribute(i);return}this.registerPositionAttribute(i),this.registerColorAttribute(i)}registerPositionAttribute(i){i.registerStyleAttribute({name:"position",type:In.Attribute,descriptor:{name:"a_Position",shaderLocation:hs.POSITION,buffer:{data:[],type:at.FLOAT},size:3,update:(s,f,g)=>g.length===2?[g[0],g[1],0]:[g[0],g[1],g[2]]}})}registerColorAttribute(i){i.registerStyleAttribute({name:"color",type:In.Attribute,descriptor:{name:"a_Color",shaderLocation:hs.COLOR,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:4,update:s=>{const{color:f}=s;return!f||!f.length?[1,1,1,1]:f}}})}}class yT{constructor(){(0,ut.Z)(this,"cameraService",void 0),(0,ut.Z)(this,"coordinateSystemService",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"mapService",void 0),(0,ut.Z)(this,"layerService",void 0)}apply(i,{rendererService:s,mapService:f,layerService:g,coordinateSystemService:y,cameraService:_}){this.rendererService=s,this.mapService=f,this.layerService=g,this.coordinateSystemService=y,this.cameraService=_;let O;this.rendererService.uniformBuffers[0]||(O=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=O),i.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const A=i.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(A);const{width:P,height:B}=this.rendererService.getViewportSize(),{data:U,uniforms:G}=this.generateUBO(P,B);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:U}),this.rendererService.queryVerdorInfo()==="WebGL1"&&i.models.forEach($t=>{$t.addUniforms((0,Je.Z)((0,Je.Z)({},G),{},{u_PickingBuffer:i.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(i.getShaderPickStat())}))})})}generateUBO(i,s){const f=this.cameraService.getProjectionMatrix(),g=this.cameraService.getViewMatrix(),y=this.cameraService.getViewProjectionMatrix(),_=this.cameraService.getModelMatrix(),O=this.coordinateSystemService.getViewportCenterProjection(),A=this.coordinateSystemService.getPixelsPerDegree(),P=this.cameraService.getZoom(),B=this.coordinateSystemService.getPixelsPerDegree2(),U=this.cameraService.getZoomScale(),G=this.coordinateSystemService.getPixelsPerMeter(),vt=this.coordinateSystemService.getCoordinateSystem(),$t=this.cameraService.getCameraPosition(),te=window.devicePixelRatio,Te=this.coordinateSystemService.getViewportCenter(),Fe=[i,s],Ze=this.cameraService.getFocalDistance();return{data:[...g,...f,...y,..._,...O,...A,P,...B,U,...G,vt,...$t,te,...Te,...Fe,Ze,0,0,0],uniforms:{[Ka.ProjectionMatrix]:f,[Ka.ViewMatrix]:g,[Ka.ViewProjectionMatrix]:y,[Ka.Zoom]:P,[Ka.ZoomScale]:U,[Ka.FocalDistance]:Ze,[Ka.CameraPosition]:$t,[ks.CoordinateSystem]:vt,[ks.ViewportCenter]:Te,[ks.ViewportCenterProjection]:O,[ks.PixelsPerDegree]:A,[ks.PixelsPerDegree2]:B,[ks.PixelsPerMeter]:G,u_ViewportSize:Fe,u_ModelMatrix:_,u_DevicePixelRatio:te}}}}class x2{apply(i){i.hooks.beforeRender.tap("UpdateModelPlugin",()=>{i.layerModel&&i.layerModel.needUpdate().then(s=>{s&&i.renderLayers()})}),i.hooks.afterRender.tap("UpdateModelPlugin",()=>{i.layerModelNeedUpdate=!1})}}class S2{apply(i,{styleAttributeService:s}){i.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(i,{styleAttributeService:s})}),i.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{i.layerModelNeedUpdate||i.inited&&this.updateStyleAttribute(i,{styleAttributeService:s})})}updateStyleAttribute(i,{styleAttributeService:s}){const f=s.getLayerStyleAttributes()||[],g=s.getLayerStyleAttribute("filter");if(g&&g.needRegenerateVertices){i.layerModelNeedUpdate=!0,f.forEach(y=>y.needRegenerateVertices=!1);return}f.filter(y=>y.needRegenerateVertices).forEach(y=>{s.updateAttributeByFeatureRange(y.name,i.getEncodedData(),y.featureRange.startIndex,y.featureRange.endIndex,i),y.needRegenerateVertices=!1})}initStyleAttribute(i,{styleAttributeService:s}){(s.getLayerStyleAttributes()||[]).filter(g=>g.needRegenerateVertices).forEach(g=>{s.updateAttributeByFeatureRange(g.name,i.getEncodedData(),g.featureRange.startIndex,g.featureRange.endIndex),g.needRegenerateVertices=!1})}}function pa(){return[new Nb,new _2,new p2,new _u,new uT,new cT,new S2,new x2,new yg,new yT,new vg,new gT,new y2,new lT]}const bg={[Qa.additive]:{enable:!0,func:{srcRGB:at.ONE,dstRGB:at.ONE,srcAlpha:1,dstAlpha:1}},[Qa.none]:{enable:!1},[Qa.normal]:{enable:!0,func:{srcRGB:at.SRC_ALPHA,dstRGB:at.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[Qa.subtractive]:{enable:!0,func:{srcRGB:at.ONE,dstRGB:at.ONE,srcAlpha:at.ZERO,dstAlpha:at.ONE_MINUS_SRC_COLOR},equation:{rgb:at.FUNC_SUBTRACT,alpha:at.FUNC_SUBTRACT}},[Qa.max]:{enable:!0,func:{srcRGB:at.ONE,dstRGB:at.ONE},equation:{rgb:at.MAX_EXT}},[Qa.min]:{enable:!0,func:{srcRGB:at.ONE,dstRGB:at.ONE},equation:{rgb:at.MIN_EXT}}};class bT{constructor(i){(0,ut.Z)(this,"layer",void 0),this.layer=i}pickRender(i){const f=this.layer.getContainer().layerService,g=this.layer;if(g.tileLayer)return g.tileLayer.pickRender(i);g.hooks.beforePickingEncode.call(),f.renderTileLayerMask(g),g.renderModels({ispick:!0}),g.hooks.afterPickingEncode.call()}pick(i,s){var f=this;return(0,nn.Z)(function*(){const y=f.layer.getContainer().pickingService;return i.type==="RasterLayer"?f.pickRasterLayer(i,s):(f.pickRender(s),y.pickFromPickingFBO(i,s))})()}pickRasterLayer(i,s,f){const g=this.layer.getContainer(),y=g.pickingService,_=g.mapService,O=this.layer.getSource().extent,A=cL(s.lngLat,O),P={x:s.x,y:s.y,type:s.type,lngLat:s.lngLat,target:s,rasterValue:null},B=f||i;if(A){const U=this.readRasterValue(i,O,_,s.x,s.y);return P.rasterValue=U,y.triggerHoverOnLayer(B,P),!0}else return P.type=s.type==="mousemove"?"mouseout":"un"+s.type,y.triggerHoverOnLayer(B,(0,Je.Z)((0,Je.Z)({},P),{},{type:"unpick"})),y.triggerHoverOnLayer(B,P),!1}readRasterValue(i,s,f,g,y){const _=i.getSource().data.dataArray[0],[O=0,A=0,P=10,B=-10]=s,U=f.lngLatToContainer([O,A]),G=f.lngLatToContainer([P,B]),vt=G.x-U.x,$t=U.y-G.y,te=[(g-U.x)/vt,(y-G.y)/$t],Te=_.width||1,Fe=_.height||1,Ze=Math.floor(te[0]*Te),je=Math.floor(te[1]*Fe),Qe=Math.max(0,je-1)*Te+Ze;return _.data[Qe]}selectFeature(i){const s=this.layer,[f,g,y]=i;s.hooks.beforeSelect.call([f,g,y])}highlightPickedFeature(i){const[s,f,g]=i;this.layer.hooks.beforeHighlight.call([s,f,g])}getFeatureById(i){return this.layer.getSource().getFeatureById(i)}}class _T{constructor(i){(0,ut.Z)(this,"layer",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"colorTexture",void 0),(0,ut.Z)(this,"key",void 0),this.layer=i;const s=this.layer.getContainer();this.rendererService=s.rendererService}getColorTexture(i,s){const f=this.getTextureKey(i,s);return this.key===f?this.colorTexture:(this.createColorTexture(i,s),this.key=f,this.colorTexture)}createColorTexture(i,s){const{createTexture2D:f}=this.rendererService,g=this.getColorRampBar(i,s),y=f({data:new Uint8Array(g.data),width:g.width,height:g.height,flipY:!1,unorm:!0});return this.colorTexture=y,y}setColorTexture(i,s,f){this.key=this.getTextureKey(s,f),this.colorTexture=i}destroy(){var i;(i=this.colorTexture)===null||i===void 0||i.destroy()}getColorRampBar(i,s){switch(i.type){case"cat":return vO(i);case"quantize":return mO(i);case"custom":return yO(i,s);case"linear":return gO(i,s);default:return bm(i)}}getTextureKey(i,s){var f;return`${i.colors.join("_")}_${i==null||(f=i.positions)===null||f===void 0?void 0:f.join("_")}_${i.type}_${s==null?void 0:s.join("_")}`}}const xT=["passes"],ST=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:zd,isFunction:O2,isNumber:_g,isObject:Yi,isPlainObject:OT,isUndefined:O6}=Nr;let xg=0;class el extends no.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var i;return(i=this.container)===null||i===void 0?void 0:i.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(i={}){super(),(0,ut.Z)(this,"id",`${xg++}`),(0,ut.Z)(this,"name",`${xg}`),(0,ut.Z)(this,"parent",void 0),(0,ut.Z)(this,"coordCenter",void 0),(0,ut.Z)(this,"type",void 0),(0,ut.Z)(this,"visible",!0),(0,ut.Z)(this,"zIndex",0),(0,ut.Z)(this,"minZoom",void 0),(0,ut.Z)(this,"maxZoom",void 0),(0,ut.Z)(this,"inited",!1),(0,ut.Z)(this,"layerModelNeedUpdate",!1),(0,ut.Z)(this,"pickedFeatureID",null),(0,ut.Z)(this,"selectedFeatureID",null),(0,ut.Z)(this,"styleNeedUpdate",!1),(0,ut.Z)(this,"rendering",void 0),(0,ut.Z)(this,"forceRender",!1),(0,ut.Z)(this,"clusterZoom",0),(0,ut.Z)(this,"layerType",void 0),(0,ut.Z)(this,"triangulation",void 0),(0,ut.Z)(this,"layerPickService",void 0),(0,ut.Z)(this,"textureService",void 0),(0,ut.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,ut.Z)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,ut.Z)(this,"hooks",{init:new Ew,afterInit:new M1,beforeRender:new M1,beforeRenderData:new ww,afterRender:new Li,beforePickingEncode:new Li,afterPickingEncode:new Li,beforeHighlight:new Li(["pickedColor"]),afterHighlight:new Li,beforeSelect:new Li(["pickedColor"]),afterSelect:new Li,beforeDestroy:new Li,afterDestroy:new Li}),(0,ut.Z)(this,"models",[]),(0,ut.Z)(this,"multiPassRenderer",void 0),(0,ut.Z)(this,"plugins",void 0),(0,ut.Z)(this,"startInit",!1),(0,ut.Z)(this,"sourceOption",void 0),(0,ut.Z)(this,"layerModel",void 0),(0,ut.Z)(this,"shapeOption",void 0),(0,ut.Z)(this,"tileLayer",void 0),(0,ut.Z)(this,"layerChildren",[]),(0,ut.Z)(this,"masks",[]),(0,ut.Z)(this,"configService",$1),(0,ut.Z)(this,"styleAttributeService",void 0),(0,ut.Z)(this,"layerSource",void 0),(0,ut.Z)(this,"postProcessingPassFactory",void 0),(0,ut.Z)(this,"animateOptions",{enable:!1}),(0,ut.Z)(this,"container",void 0),(0,ut.Z)(this,"encodedData",void 0),(0,ut.Z)(this,"currentPickId",null),(0,ut.Z)(this,"rawConfig",void 0),(0,ut.Z)(this,"needUpdateConfig",void 0),(0,ut.Z)(this,"encodeStyleAttribute",{}),(0,ut.Z)(this,"enableShaderEncodeStyles",[]),(0,ut.Z)(this,"enableDataEncodeStyles",[]),(0,ut.Z)(this,"pendingStyleAttributes",[]),(0,ut.Z)(this,"scaleOptions",{}),(0,ut.Z)(this,"animateStartTime",void 0),(0,ut.Z)(this,"animateStatus",!1),(0,ut.Z)(this,"isDestroyed",!1),(0,ut.Z)(this,"uniformBuffers",[]),(0,ut.Z)(this,"encodeDataLength",0),(0,ut.Z)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const s=this.getLayerConfig();s&&s.autoFit&&this.fitBounds(s.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=i.name||this.id,this.zIndex=i.zIndex||0,this.rawConfig=i,this.masks=i.maskLayers||[]}addMask(i){this.masks.push(i),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(i){const s=this.masks.indexOf(i);s>-1&&this.masks.splice(s,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(i){this.masks.push(i)}removeMaskLayer(i){const s=this.masks.indexOf(i);s>-1&&this.masks.splice(s,1),i.destroy()}getAttribute(i){return this.styleAttributeService.getLayerStyleAttribute(i)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(i){if(Object.keys(i).map(s=>{s in this.rawConfig&&(this.rawConfig[s]=i[s])}),!this.startInit)this.needUpdateConfig=(0,Je.Z)((0,Je.Z)({},this.needUpdateConfig),i);else{const s=this.container.id;this.configService.setLayerConfig(s,this.id,(0,Je.Z)((0,Je.Z)((0,Je.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),i)),this.needUpdateConfig={}}}setContainer(i){this.container=i}getContainer(){return this.container}addPlugin(i){return this.plugins.push(i),this}init(){var i=this;return(0,nn.Z)(function*(){const s=i.container.id;i.startInit=!0,i.configService.setLayerConfig(s,i.id,i.rawConfig),i.layerType=i.rawConfig.layerType;const{enableMultiPassRenderer:f,passes:g}=i.getLayerConfig();f&&g!==null&&g!==void 0&&g.length&&g.length>0&&i.mapService.on("mapAfterFrameChange",()=>{i.renderLayers()}),i.postProcessingPassFactory=i.container.postProcessingPassFactory,i.styleAttributeService=i.container.styleAttributeService,f&&(i.multiPassRenderer=i.container.multiPassRenderer,i.multiPassRenderer.setLayer(i)),i.pendingStyleAttributes.forEach(({attributeName:y,attributeField:_,attributeValues:O,updateOptions:A})=>{i.styleAttributeService.updateStyleAttribute(y,{scale:(0,Je.Z)({field:_},i.splitValuesAndCallbackInAttribute(O,_?void 0:i.getLayerConfig()[y]))},A)}),i.pendingStyleAttributes=[],i.plugins=pa();for(const y of i.plugins)y.apply(i,i.container);i.layerPickService=new bT(i),i.textureService=new _T(i),i.log(Mi.LayerInitStart),yield i.hooks.init.promise(),i.log(Mi.LayerInitEnd),i.inited=!0,i.emit("inited",{target:i,type:"inited"}),i.emit("add",{target:i,type:"add"}),i.hooks.afterInit.call()})()}log(i,s="init"){var f;if(this.tileLayer||this.isTileLayer)return;const g=`${this.id}.${s}.${i}`,y={id:this.id,type:this.type};(f=this.debugService)===null||f===void 0||f.log(g,y)}updateModelData(i){i.attributes&&i.elements?this.models.map(s=>{s.updateAttributesAndElements(i.attributes,i.elements)}):console.warn("data error")}setLayerPickService(i){this.layerPickService=i}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:i}=this.getLayerConfig();i!=null&&i.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(i,s,f){return this.updateStyleAttribute("color",i,s,f),this}texture(i,s,f){return this.updateStyleAttribute("texture",i,s,f),this}rotate(i,s,f){return this.updateStyleAttribute("rotate",i,s,f),this}size(i,s,f){return this.updateStyleAttribute("size",i,s,f),this}filter(i,s,f){const g=this.updateStyleAttribute("filter",i,s,f);return this.dataState.dataSourceNeedUpdate=g&&this.inited,this}shape(i,s,f){this.shapeOption={field:i,values:s};const g=this.updateStyleAttribute("shape",i,s,f);return this.dataState.dataSourceNeedUpdate=g&&this.inited,this}label(i,s,f){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:i,attributeValues:s,updateOptions:f}),this}animate(i){let s={};return Yi(i)?(s.enable=!0,s=(0,Je.Z)((0,Je.Z)({},s),i)):s.enable=i,this.updateLayerConfig({animateOption:s}),this}source(i,s){return(i==null?void 0:i.type)==="source"?(this.setSource(i),this):(this.sourceOption={data:i,options:s},this.clusterZoom=0,this)}setData(i,s){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(i,s)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(i,s)}),this}dataUpdatelog(){this.log(Mi.SourceInitStart,Hi.UPDATE),this.layerSource.once("update",()=>{this.log(Mi.SourceInitEnd,Hi.UPDATE)})}style(i){const{passes:s}=i,f=(0,ia.Z)(i,xT);s&&m2(s).forEach(y=>{const _=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(y[0]);_&&_.updateOptions(y[1])}),f.borderColor&&(f.stroke=f.borderColor),f.borderWidth&&(f.strokeWidth=f.borderWidth);const g=f;return Object.keys(f).forEach(y=>{const _=f[y];Array.isArray(_)&&_.length===2&&!_g(_[0])&&!_g(_[1])&&(g[y]={field:_[0],value:_[1]})}),this.encodeStyle(g),this.updateLayerConfig(g),this}encodeStyle(i){Object.keys(i).forEach(s=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(s)&&OT(i[s])&&(i[s].field||i[s].value)&&!zd(this.encodeStyleAttribute[s],i[s])?(this.encodeStyleAttribute[s]=i[s],this.updateStyleAttribute(s,i[s].field,i[s].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[s]&&(delete this.encodeStyleAttribute[s],this.dataState.dataSourceNeedUpdate=!0)})}scale(i,s){const f=(0,Je.Z)({},this.scaleOptions);if(Yi(i)?this.scaleOptions=(0,Je.Z)((0,Je.Z)({},this.scaleOptions),i):this.scaleOptions[i]=s,this.styleAttributeService&&!zd(f,this.scaleOptions)){const g=Yi(i)?i:{[i]:s};this.styleAttributeService.updateScaleAttribute(g)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(i={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(i),this))}renderMultiPass(){var i=this;return(0,nn.Z)(function*(){i.encodeDataLength<=0&&!i.forceRender||(i.multiPassRenderer&&i.multiPassRenderer.getRenderFlag()?yield i.multiPassRenderer.render():i.renderModels())})()}active(i){const s={};return s.enableHighlight=Yi(i)?!0:i,Yi(i)?(s.enableHighlight=!0,i.color&&(s.highlightColor=i.color),i.mix&&(s.activeMix=i.mix)):s.enableHighlight=!!i,this.updateLayerConfig(s),this}setActive(i,s){if(Yi(i)){const{x:f=0,y:g=0}=i;this.updateLayerConfig({highlightColor:Yi(s)?s.color:this.getLayerConfig().highlightColor,activeMix:Yi(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:f,y:g})}else this.updateLayerConfig({pickedFeatureID:i,highlightColor:Yi(s)?s.color:this.getLayerConfig().highlightColor,activeMix:Yi(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(_c(i)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(i){const s={};return s.enableSelect=Yi(i)?!0:i,Yi(i)?(s.enableSelect=!0,i.color&&(s.selectColor=i.color),i.mix&&(s.selectMix=i.mix)):s.enableSelect=!!i,this.updateLayerConfig(s),this}setSelect(i,s){if(Yi(i)){const{x:f=0,y:g=0}=i;this.updateLayerConfig({selectColor:Yi(s)?s.color:this.getLayerConfig().selectColor,selectMix:Yi(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:f,y:g})}else this.updateLayerConfig({pickedFeatureID:i,selectColor:Yi(s)?s.color:this.getLayerConfig().selectColor,selectMix:Yi(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(_c(i)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(i){return this.updateLayerConfig({blend:i}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(i){return this.zIndex=i,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(i){this.currentPickId=i}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(i){this.selectedFeatureID=i}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const i=this.mapService.getZoom(),{visible:s,minZoom:f=-1/0,maxZoom:g=1/0}=this.getLayerConfig();return!!s&&i>=f&&i<g}setMultiPass(i,s){if(this.updateLayerConfig({enableMultiPassRenderer:i}),s&&this.updateLayerConfig({passes:s}),i){const{passes:f=[]}=this.getLayerConfig();this.multiPassRenderer=mg(this,f,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:g,height:y}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(g,y)}return this}setMinZoom(i){return this.updateLayerConfig({minZoom:i}),this}getMinZoom(){const{minZoom:i}=this.getLayerConfig();return i}getMaxZoom(){const{maxZoom:i}=this.getLayerConfig();return i}get(i){return this.getLayerConfig()[i]}setMaxZoom(i){return this.updateLayerConfig({maxZoom:i}),this}setAutoFit(i){return this.updateLayerConfig({autoFit:i}),this}fitBounds(i){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const f=this.getSource().extent;return f.some(y=>Math.abs(y)===1/0)?this:(this.mapService.fitBounds([[f[0],f[1]],[f[2],f[3]]],i),this)}destroy(i=!0){var s,f,g,y,_;if(this.isDestroyed)return;(s=this.layerModel)===null||s===void 0||s.uniformBuffers.forEach(A=>{A.destroy()}),this.layerChildren.map(A=>A.destroy(!1)),this.layerChildren=[];const{maskfence:O}=this.getLayerConfig();O&&(this.masks.map(A=>A.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(f=this.multiPassRenderer)===null||f===void 0||f.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(g=this.layerModel)===null||g===void 0||g.clearModels(i),(y=this.tileLayer)===null||y===void 0||y.destroy(),this.models=[],(_=this.debugService)===null||_===void 0||_.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var i;this.models.forEach(s=>s.destroy()),(i=this.layerModel)===null||i===void 0||i.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(i=>i.needRescale||i.needRemapping||i.needRegenerateVertices).length}setSource(i){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=i,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:s})=>{if(this.coordCenter===void 0){const f=this.layerSource.center;this.coordCenter=f}if(s==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(i){this.encodedData=i,this.encodeDataLength=i.length}getEncodedData(){return this.encodedData}getScale(i){return this.styleAttributeService.getLayerAttributeScale(i)}getLegend(i){var s,f,g;const y=this.styleAttributeService.getLayerStyleAttribute(i);return{type:(f=((y==null||(s=y.scale)===null||s===void 0?void 0:s.scalers)||[])[0])===null||f===void 0||(f=f.option)===null||f===void 0?void 0:f.type,field:y==null||(g=y.scale)===null||g===void 0?void 0:g.field,items:this.getLegendItems(i)}}getLegendItems(i){const s=this.styleAttributeService.getLayerAttributeScale(i);return s?s.invertExtent?s.range().map(g=>({value:s.invertExtent(g),[i]:g})):s.ticks?s.ticks().map(g=>({value:g,[i]:s(g)})):s!=null&&s.domain?s.domain().filter(g=>!O6(g)).map(g=>({value:g,[i]:s(g)})):[]:[]}pick({x:i,y:s}){this.interactionService.triggerHover({x:i,y:s})}boxSelect(i,s){this.pickingService.boxPickLayer(this,i,s)}buildLayerModel(i){var s=this;return(0,nn.Z)(function*(){const{moduleName:f,vertexShader:g,fragmentShader:y,defines:_,inject:O,triangulation:A,styleOption:P,pickingEnabled:B=!0}=i,U=(0,ia.Z)(i,ST);s.shaderModuleService.registerModule(f,{vs:g,fs:y,defines:_,inject:O});const{vs:G,fs:vt,uniforms:$t}=s.shaderModuleService.getModule(f),{createModel:te}=s.rendererService;return new Promise(Te=>{const{attributes:Fe,elements:Ze,count:je}=s.styleAttributeService.createAttributesAndIndices(s.encodedData,A,P,s),Qe=[...s.layerModel.uniformBuffers,...s.rendererService.uniformBuffers];B&&Qe.push(s.getPickingUniformBuffer());const ln=(0,Je.Z)({attributes:Fe,uniforms:$t,fs:vt,vs:G,elements:Ze,blend:bg[Qa.normal],uniformBuffers:Qe,textures:s.layerModel.textures},U);je&&(ln.count=je);const wn=te(ln);Te(wn)})})()}createAttributes(i){const{triangulation:s}=i,{attributes:f}=this.styleAttributeService.createAttributes(this.encodedData,s);return f}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(i){const{enableHighlight:s=!0,enableSelect:f=!0}=this.getLayerConfig();let g=this.eventNames().indexOf(i)!==-1||this.eventNames().indexOf("un"+i)!==-1;return(i==="click"||i==="dblclick")&&f&&(g=!0),i==="mousemove"&&(s||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(g=!0),this.isVisible()&&g}buildModels(){return(0,nn.Z)(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var i=this;return(0,nn.Z)(function*(){yield i.buildModels()})()}renderMulPass(i){return(0,nn.Z)(function*(){yield i.render()})()}renderModels(i={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(s=>{s.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(i),textures:this.layerModel.textures},(i==null?void 0:i.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(i,s,f,g){const y=this.configService.getAttributeConfig(this.id)||{};return zd(y[i],{field:s,values:f})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(i)!==-1&&this.configService.setAttributeConfig(this.id,{[i]:{field:s,values:f}}),this.startInit?this.styleAttributeService.updateStyleAttribute(i,{scale:(0,Je.Z)({field:s},this.splitValuesAndCallbackInAttribute(f,this.getLayerConfig()[s]))},g):this.pendingStyleAttributes.push({attributeName:i,attributeField:s,attributeValues:f,updateOptions:g}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(i){console.warn("empty fn")}processData(i){return i}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var i=this;return(0,nn.Z)(function*(){i.models.forEach(f=>f.destroy()),i.models=[],i.uniformBuffers.forEach(f=>{f.destroy()}),i.uniformBuffers=[];const s=i.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});i.uniformBuffers.push(s),i.models=yield i.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(i){return{values:O2(i)?void 0:i,callback:O2(i)?i:void 0}}}function ET(a,i){return{enable:a,mask:255,func:{cmp:at.EQUAL,ref:i?1:0,mask:1}}}function tc(a){return a.maskOperation===Wl.OR?{enable:!0,mask:255,func:{cmp:at.ALWAYS,ref:1,mask:255},opFront:{fail:at.KEEP,zfail:at.REPLACE,zpass:at.REPLACE}}:{enable:!0,mask:255,func:{cmp:a.stencilType===Ds.SINGLE||a.stencilIndex===0?at.ALWAYS:at.LESS,ref:a.stencilType===Ds.SINGLE?1:a.stencilIndex===0?2:1,mask:255},opFront:{fail:at.KEEP,zfail:at.REPLACE,zpass:at.REPLACE}}}const wT={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Sg={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var Og=k(9187),ec=k.n(Og);function Eg(a){return Math.max(Math.ceil(a/4)*4,4)}function Ud(a,i,s,f=!0){const g=s===3;if(f){a=a.slice();const _=[];for(let O=0;O<a.length;O+=s){_[0]=a[O],_[1]=a[O+1],g&&(_[2]=a[O+2]);const A=mf(_,!0,{enable:!1,decimal:1});a[O]=A[0],a[O+1]=A[1],g&&(a[O+2]=A[2])}}return ec()(a,i,s)}const wg="ATTRIBUTE_LOCATION_";class Vr{get attributeLocation(){return(0,Je.Z)({},hs)}constructor(i){(0,ut.Z)(this,"triangulation",void 0),(0,ut.Z)(this,"uniformBuffers",[]),(0,ut.Z)(this,"textures",[]),(0,ut.Z)(this,"createTexture2D",void 0),(0,ut.Z)(this,"preStyleAttribute",{}),(0,ut.Z)(this,"encodeStyleAttribute",{}),(0,ut.Z)(this,"layer",void 0),(0,ut.Z)(this,"dataTexture",void 0),(0,ut.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,ut.Z)(this,"dataTextureTest",void 0),(0,ut.Z)(this,"configService",void 0),(0,ut.Z)(this,"shaderModuleService",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"iconService",void 0),(0,ut.Z)(this,"fontService",void 0),(0,ut.Z)(this,"styleAttributeService",void 0),(0,ut.Z)(this,"mapService",void 0),(0,ut.Z)(this,"cameraService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"pickingService",void 0),(0,ut.Z)(this,"attributeUnifoms",void 0),(0,ut.Z)(this,"commonUnifoms",void 0),this.layer=i,this.configService=i.getContainer().globalConfigService,this.rendererService=i.getContainer().rendererService,this.pickingService=i.getContainer().pickingService,this.shaderModuleService=i.getContainer().shaderModuleService,this.styleAttributeService=i.getContainer().styleAttributeService,this.mapService=i.getContainer().mapService,this.iconService=i.getContainer().iconService,this.fontService=i.getContainer().fontService,this.cameraService=i.getContainer().cameraService,this.layerService=i.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:s}=this.rendererService;this.createTexture2D=s}getBlend(){const{blend:i="normal"}=this.layer.getLayerConfig();return bg[Qa[i]]}getStencil(i){const{mask:s=!1,maskInside:f=!0,enableMask:g,maskOperation:y=Wl.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return tc({isStencil:!0,stencilType:Ds.SINGLE});if(i.isStencil)return tc((0,Je.Z)((0,Je.Z)({},i),{},{maskOperation:y}));const _=s||g&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return ET(_,f)}getDefaultStyle(){return{}}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const f=(0,Je.Z)((0,Je.Z)({},s.uniformsOption),i.uniformsOption);return Object.keys(f).forEach(g=>{typeof f[g]=="boolean"&&(f[g]=f[g]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(f.u_texture=this.textures[0]),f}getAnimateUniforms(){return{}}needUpdate(){return(0,nn.Z)(function*(){return!1})()}buildModels(){return(0,nn.Z)(function*(){throw new Error("Method not implemented.")})()}initModels(){return(0,nn.Z)(function*(){throw new Error("Method not implemented.")})()}clearModels(i=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(i){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(i){return[i.enable?0:1,i.duration||4,i.interval||.2,i.trailLength||.1]}startModelAnimate(){const{animateOption:i}=this.layer.getLayerConfig();i.enable&&this.layer.setAnimateStartTime()}getInject(){return E2(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const i=Object.keys(this.attributeLocation).reduce((s,f)=>{const g=wg+f;return s[g]=this.attributeLocation[f],s},{});return(0,Je.Z)({},i)}getStyleAttribute(){const i={};return this.layer.enableShaderEncodeStyles.forEach(s=>{if(!this.layer.encodeStyleAttribute[s]){const f=this.layer.getLayerConfig()[s];let g=typeof f=="undefined"?wT[s]:f;s==="stroke"&&(g=Lr(g)),i["u_"+s]=g}}),i}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(i=>{const s=vT(i);s&&this.styleAttributeService.registerStyleAttribute(s)})}registerPosition64LowAttribute(i=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:In.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:at.FLOAT},size:2,update:(s,f,g)=>i?[Ai(g[0]),Ai(g[1])]:[0,0]}})}updateEncodeAttribute(i,s){this.encodeStyleAttribute[i]=s}initUniformsBuffer(){const i=this.getUniformsBufferInfo(this.getStyleAttribute()),s=this.getCommonUniformsInfo();i.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(Eg(i.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),s.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(Eg(s.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(i){let s=0;const f=[];return Object.values(i).forEach(g=>{Array.isArray(g)?(f.push(...g),s+=g.length):typeof g=="number"?(f.push(g),s+=1):typeof g=="boolean"&&(f.push(Number(g)),s+=1)}),{uniformsOption:i,uniformsLength:s,uniformsArray:f}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var i,s;const{uniformsArray:f}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:g}=this.getCommonUniformsInfo();(i=this.attributeUnifoms)===null||i===void 0||i.subData({offset:0,data:new Uint8Array(new Float32Array(f).buffer)}),(s=this.commonUnifoms)===null||s===void 0||s.subData({offset:0,data:new Uint8Array(new Float32Array(g).buffer)})}}function E2(a,i){const s=[];let f="";a.forEach(_=>{const O=_.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),A=wg+O;i[_]?f+=`#define USE_ATTRIBUTE_${O} 0.0 
`:s.push(`  ${Sg[_]} u_${_};`),f+=`
#ifdef USE_ATTRIBUTE_${O}
layout(location = ${A}) in ${Sg[_]} a_${_.charAt(0).toUpperCase()+_.slice(1)};
#endif 
`});const g=s.length?`
layout(std140) uniform AttributeUniforms {
  ${s.join(`
`)}
};
`:"";f+=g;let y="";return a.forEach(_=>{const O=_.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();y+=`
  #ifdef USE_ATTRIBUTE_${O}
    ${Sg[_]} ${_} = a_${_.charAt(0).toUpperCase()+_.slice(1)};
  #else
    ${Sg[_]} ${_} = u_${_};
  #endif
  `}),{"vs:#decl":f,"fs:#decl":g,"vs:#main-start":y}}const Ag=100,E6=36,w6=40;function w2(a){return a/180*Math.acos(-1)}function Tg(a){const i=w2(a[0])+Math.PI/2,s=w2(a[1]),f=Ag+Math.random()*.4,g=f*Math.cos(s)*Math.cos(i),y=f*Math.cos(s)*Math.sin(i),_=f*Math.sin(s);return[y,_,g]}function A2(a,i){const s=mat4.create(),f=mat4.create(),g=vec3.fromValues(0,1,0),y=vec3.fromValues(0,0,0);i=i||{},a=typeof a!="undefined"?a:1;const O=2+(typeof i.segments!="undefined"?i.segments:32),A=2*O,P=[],B=[],U=[],G=[],vt=[],$t=[];for(let te=0;te<=O;te++){const Te=te/O,Fe=Te*Math.PI;for(let Ze=0;Ze<=A;Ze++){const je=Ze/A,Qe=je*Math.PI*2;mat4.identity(f),mat4.rotateZ(f,f,-Fe),mat4.identity(s),mat4.rotateY(s,s,Qe),vec3.transformMat4(y,g,f),vec3.transformMat4(y,y,s),vec3.scale(y,y,-a),U.push(y.slice()),G.push(...y.slice()),vec3.normalize(y,y),vt.push(...y.slice()),$t.push([je,1-Te]),G.push(je,1-Te)}if(te>0){const Ze=U.length;let je=Ze-2*(A+1);for(;je+A+2<Ze;je++)P.push([je,je+1,je+A+1]),B.push(je,je+1,je+A+1),P.push([je+A+1,je+1,je+A+2]),B.push(je+A+1,je+1,je+A+2)}}return{cells:P,positions:U,uvs:$t,positionsArr:G,indicesArr:B,normalArr:vt}}var ar=k(31437);const T2=ar.Ue(),A6=ar.Ue(),Bo=ar.Ue(),Nu=ar.Ue(),Zd=ar.Ue();function C2(a,i,s,f,g){ar.IH(a,s,f),ar.Fv(a,a),i=ar.al(-a[1],a[0]);const y=ar.al(-s[1],s[0]);return[g/ar.AK(i,y),i]}function Bu(a,i){return ar.t8(a,-i[1],i[0])}function Hd(a,i,s){return ar.lu(a,i,s),ar.Fv(a,a),a}function M2(a,i){return a[0]===i[0]&&a[1]===i[1]}function T6(a){const i=new Map;for(let s=0;s<a.length;s++){const f=a[0].toString()+"-"+a[1].toString();i.get(f)?(a.splice(s,1),s++):i.set(f,f)}return a}class AT{constructor(i={}){(0,ut.Z)(this,"complex",void 0),(0,ut.Z)(this,"join",void 0),(0,ut.Z)(this,"cap",void 0),(0,ut.Z)(this,"miterLimit",void 0),(0,ut.Z)(this,"thickness",void 0),(0,ut.Z)(this,"normal",void 0),(0,ut.Z)(this,"lastFlip",-1),(0,ut.Z)(this,"miter",ar.al(0,0)),(0,ut.Z)(this,"started",!1),(0,ut.Z)(this,"dash",!1),(0,ut.Z)(this,"totalDistance",0),(0,ut.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(i){const s=this.complex;if(i.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const f=i.length;let g=s.startIndex;for(let y=1;y<f;y++){const _=i[y-1],O=i[y],A=y<i.length-1?i[y+1]:null,P=this.simpleSegment(s,g,_,O,A);g+=P}if(this.dash)for(let y=0;y<s.positions.length/6;y++)s.positions[y*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}extrude(i){const s=this.complex;if(i.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const f=i.length;let g=s.startIndex;for(let y=1;y<f;y++){const _=i[y-1],O=i[y],A=y<i.length-1?i[y+1]:null,P=this.segment(s,g,_,O,A);g+=P}if(this.dash)for(let y=0;y<s.positions.length/6;y++)s.positions[y*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}simpleSegment(i,s,f,g,y){let _=0;const O=i.indices,A=i.positions,P=i.normals,B=Mo([g[0],g[1]]),U=Mo([f[0],f[1]]);Hd(Bo,B,U);let G=0;if(this.dash&&(G=this.lineSegmentDistance(B,U),this.totalDistance+=G),this.normal||(this.normal=ar.Ue(),Bu(this.normal,Bo)),this.started||(this.started=!0,this.extrusions(A,P,f,this.normal,this.thickness,this.totalDistance-G)),O.push(s+0,s+1,s+2),!y)Bu(this.normal,Bo),this.extrusions(A,P,g,this.normal,this.thickness,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),_+=2;else{const vt=Mo([y[0],y[1]]);M2(B,vt)&&ar.IH(vt,B,ar.Fv(vt,ar.$X(vt,B,U))),Hd(Nu,vt,B);const[$t,te]=C2(Zd,ar.Ue(),Bo,Nu,this.thickness);let Te=ar.AK(Zd,this.normal)<0?-1:1;this.extrusions(A,P,g,te,$t,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),Te=-1,ar.JG(this.normal,te),_+=2,this.lastFlip=Te}return _}segment(i,s,f,g,y){let _=0;const O=i.indices,A=i.positions,P=i.normals,B=this.cap==="square",U=this.join==="bevel",G=Mo([g[0],g[1]]),vt=Mo([f[0],f[1]]);Hd(Bo,G,vt);let $t=0;if(this.dash&&($t=this.lineSegmentDistance(G,vt),this.totalDistance+=$t),this.normal||(this.normal=ar.Ue(),Bu(this.normal,Bo)),!this.started)if(this.started=!0,B){const te=ar.Ue(),Te=ar.Ue();ar.IH(te,this.normal,Bo),ar.IH(Te,this.normal,Bo),P.push(Te[0],Te[1],0),P.push(te[0],te[1],0),A.push(f[0],f[1],f[2]|0,this.totalDistance-$t,-this.thickness,f[2]|0),this.complex.indexes.push(this.currentIndex),A.push(f[0],f[1],f[2]|0,this.totalDistance-$t,this.thickness,f[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,P,f,this.normal,this.thickness,this.totalDistance-$t);if(O.push(s+0,s+1,s+2),y){const te=Mo([y[0],y[1]]);M2(G,te)&&ar.IH(te,G,ar.Fv(te,ar.$X(te,G,vt))),Hd(Nu,te,G);const[Te,Fe]=C2(Zd,ar.Ue(),Bo,Nu,this.thickness);let Ze=ar.AK(Zd,this.normal)<0?-1:1,je=U;!je&&this.join==="miter"&&Te>this.miterLimit&&(je=!0),je?(P.push(this.normal[0],this.normal[1],0),P.push(Fe[0],Fe[1],0),A.push(g[0],g[1],g[2]|0,this.totalDistance,-this.thickness*Ze,g[2]|0),this.complex.indexes.push(this.currentIndex),A.push(g[0],g[1],g[2]|0,this.totalDistance,this.thickness*Ze,g[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push(...this.lastFlip!==-Ze?[s,s+2,s+3]:[s+2,s+1,s+3]),O.push(s+2,s+3,s+4),Bu(T2,Nu),ar.JG(this.normal,T2),P.push(this.normal[0],this.normal[1],0),A.push(g[0],g[1],g[2]|0,this.totalDistance,-this.thickness*Ze,g[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,_+=3):(this.extrusions(A,P,g,Fe,Te,this.totalDistance),O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),Ze=-1,ar.JG(this.normal,Fe),_+=2),this.lastFlip=Ze}else{if(Bu(this.normal,Bo),B){const te=ar.Ue(),Te=ar.Ue();ar.lu(Te,Bo,this.normal),ar.IH(te,Bo,this.normal),P.push(Te[0],Te[1],0),P.push(te[0],te[1],0),A.push(g[0],g[1],g[2]|0,this.totalDistance,this.thickness,g[2]|0),this.complex.indexes.push(this.currentIndex),A.push(g[0],g[1],g[2]|0,this.totalDistance,this.thickness,g[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,P,g,this.normal,this.thickness,this.totalDistance);O.push(...this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3]),_+=2}return _}extrusions(i,s,f,g,y,_){s.push(g[0],g[1],0),s.push(g[0],g[1],0),i.push(f[0],f[1],f[2]|0,_,-y,f[2]|0),this.complex.indexes.push(this.currentIndex),i.push(f[0],f[1],f[2]|0,_,y,f[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(i,s){const f=s[0]-i[0],g=s[1]-i[1];return Math.sqrt(f*f+g*g)}}let ju=function(a){return a.CYLINDER="cylinder",a.SQUARECOLUMN="squareColumn",a.TRIANGLECOLUMN="triangleColumn",a.HEXAGONCOLUMN="hexagonColumn",a.PENTAGONCOLUMN="pentagonColumn",a}({}),zu=function(a){return a.CIRCLE="circle",a.SQUARE="square",a.TRIANGLE="triangle",a.HEXAGON="hexagon",a.PENTAGON="pentagon",a}({});function Uu(a,i=0){const s=Math.PI*2/a,f=[];for(let y=0;y<a;y++)f.push(s*y+i*Math.PI/12);return f.map(y=>{const _=Math.sin(y+Math.PI/4),O=Math.cos(y+Math.PI/4);return[_,O,0]})}function Cg(){return Uu(30)}function Zu(){return Uu(4)}function Mg(){return Uu(3)}function Lg(){return Uu(6,1)}function L2(){return Uu(5)}const Pg={[zu.CIRCLE]:Cg,[zu.HEXAGON]:Lg,[zu.TRIANGLE]:Mg,[zu.SQUARE]:Zu,[zu.PENTAGON]:L2,[ju.CYLINDER]:Cg,[ju.HEXAGONCOLUMN]:Lg,[ju.TRIANGLECOLUMN]:Mg,[ju.SQUARECOLUMN]:Zu,[ju.PENTAGONCOLUMN]:L2};var Ir=k(77160);function Ig(a){const i=a[0][0],s=a[0][a[0].length-1];i[0]===s[0]&&i[1]===s[1]&&(a[0]=a[0].slice(0,a[0].length-1));const f=a[0].length,g=earcut.flatten(a),{vertices:y,dimensions:_}=g,O=[],A=[];for(let B=0;B<y.length/_;B++)_===2?O.push(y[B*2],y[B*2+1],1):O.push(y[B*3],y[B*3+1],1);const P=earcut(g.vertices,g.holes,g.dimensions);A.push(...P);for(let B=0;B<f;B++){const U=g.vertices.slice(B*_,(B+1)*_);let G=g.vertices.slice((B+1)*_,(B+2)*_);G.length===0&&(G=g.vertices.slice(0,_));const vt=O.length/3;O.push(U[0],U[1],1,G[0],G[1],1,U[0],U[1],0,G[0],G[1],0),A.push(...[0,2,1,2,3,1].map($t=>$t+vt))}return{positions:O,index:A}}function C6(a){const i=earcut.flatten(a),s=earcut(i.vertices,i.holes,i.dimensions);return{positions:i.vertices,index:s}}function Vd(a,i=!1){const s=a[0][0],f=a[0][a[0].length-1];s[0]===f[0]&&s[1]===f[1]&&(a[0]=a[0].slice(0,a[0].length-1));const g=a[0].length,y=ec().flatten(a),{vertices:_,dimensions:O,holes:A}=y,P=[],B=[],U=[];for(let vt=0;vt<_.length/O;vt++)P.push(_[vt*O],_[vt*O+1],1,-1,-1),U.push(0,0,1);const G=Ud(_,A,O,i);B.push(...G);for(let vt=0;vt<g;vt++){const $t=y.vertices.slice(vt*O,(vt+1)*O);let te=y.vertices.slice((vt+1)*O,(vt+2)*O);te.length===0&&(te=y.vertices.slice(0,O));const Te=P.length/5;P.push($t[0],$t[1],1,0,0,te[0],te[1],1,.1,0,$t[0],$t[1],0,0,.8,te[0],te[1],0,.1,.8);const Fe=TT([te[0],te[1],1],[$t[0],$t[1],0],[$t[0],$t[1],1],i);U.push(...Fe,...Fe,...Fe,...Fe),B.push(...[1,2,0,3,2,1].map(Ze=>Ze+Te))}return{positions:P,index:B,normals:U}}function TT(a,i,s,f=!1){const g=Ir.Ue(),y=Ir.Ue(),_=Ir.Ue();f&&(a=mf(a),i=mf(i),s=mf(s));const O=Ir.al(...a),A=Ir.al(...i),P=Ir.al(...s);Ir.lu(g,P,A),Ir.lu(y,O,A),Ir.kC(_,g,y);const B=Ir.Ue();return Ir.Fv(B,_),B}const Wd={};function nc(a){const i=$a(a.coordinates);return{vertices:[...i,...i,...i,...i],indices:[0,1,2,2,3,0],size:i.length}}function P2(a){const i=$a(a.coordinates),s=Tg(i);return{vertices:[...s,...s,...s,...s],indices:[0,1,2,2,3,0],size:s.length}}function I2(a){const{shape:i}=a,{positions:s,index:f,normals:g}=RT(i,!1);return{vertices:s,indices:f,normals:g,size:5}}function CT(a){const i=$a(a.coordinates);return{vertices:[...i],indices:[0],size:i.length}}function Hu(a){const{coordinates:i}=a,s=new AT({dash:!0,join:"bevel"});let f=i;f[0]&&!Array.isArray(f[0][0])&&(f=[i]),f.forEach(y=>{s.extrude(y)});const g=s.complex;return{vertices:g.positions,indices:g.indices,normals:g.normals,indexes:g.indexes,size:6}}function MT(a){const i=a.coordinates.flat(),s=1,f=1;return{vertices:[1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i,1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i],normals:[-s,2*f,1,2*f,-f,1,f,-f,1,f,-f,1,-s,-f,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Vu(a){const{coordinates:i}=a,s=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:f,totalDistance:g}=LT(i);return f.map(y=>{s.push(y[0],y[1],y[2],y[3],0,g)}),{vertices:s,indices:[],normals:[],size:6,count:f.length}}function M6(a){const{coordinates:i}=a,s=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],size:4,count:0};const{results:f}=Rg(i);return f.map(g=>{s.push(g[0],g[1],g[2],g[3])}),{vertices:s,indices:[],size:4,count:f.length}}function R2(a,i){const s=i[0]-a[0],f=i[1]-a[1];return Math.sqrt(s*s+f*f)}function nl(a,i){return a.length<3&&a.push(0),i!==void 0&&a.push(i),a}function LT(a){let i=a;Array.isArray(i)&&Array.isArray(i[0])&&Array.isArray(i[0][0])&&(i=a.flat());let s=0;if(i.length<2)return{results:i,totalDistance:0};{const f=[],g=nl(i[0],s);f.push(g);for(let _=1;_<i.length-1;_++){const O=R2(Mo(i[_-1]),Mo(i[_]));s+=O;const A=nl(i[_],s);f.push(A),f.push(A)}const y=R2(Mo(i[i.length-2]),Mo(i[i.length-1]));return s+=y,f.push(nl(i[i.length-1],s)),{results:f,totalDistance:s}}}function Rg(a){if(a.length<2)return{results:a};{const i=[],s=nl(a[0]);i.push(s);for(let f=1;f<a.length-1;f++){const g=nl(a[f]);i.push(g),i.push(g)}return i.push(nl(a[a.length-1])),{results:i}}}function Wu(a){const{coordinates:i}=a,s=ec().flatten(i),{vertices:f,dimensions:g,holes:y}=s;return{indices:Ud(f,y,g),vertices:f,size:g}}function PT(a){const{indices:i,vertices:s,size:f}=Wu(a);return{indices:i,vertices:IT(s),size:f+4}}function IT(a){const i=[],{center:s,radius:f}=QO(a);for(let g=0;g<a.length;g+=2){const y=a[g],_=a[g+1];i.push(y,_,0,...s,f)}return i}function k2(a){const i=a.coordinates,{positions:s,index:f,normals:g}=Vd(i,!0);return{vertices:s,indices:f,normals:g,size:5}}function L6(a){const{shape:i}=a,{positions:s,index:f}=D2(i);return{vertices:s,indices:f,size:3}}function Gd(a){const i=a.coordinates;return{vertices:[...i[0],0,0,0,...i[1],0,1,0,...i[2],0,1,1,...i[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function kg(a,i){const{segmentNumber:s=30}=i,f=a.coordinates,g=[],y=[];for(let _=0;_<s;_++)g.push(_,1,_,f[0][0],f[0][1],f[1][0],f[1][1],_,-1,_,f[0][0],f[0][1],f[1][0],f[1][1]),_!==s-1&&y.push(...[0,1,2,1,3,2].map(O=>_*2+O));return{vertices:g,indices:y,size:7}}function P6(a){const i=a.coordinates;i.length===2&&i.push(0);const s=Yd(-1,1),f=Yd(1,1),g=Yd(-1,-1),y=Yd(1,-1);return{vertices:[...i,...s,...i,...g,...i,...y,...i,...f],indices:[0,1,2,3,0,2],size:5}}function RT(a,i=!1){if(Wd&&Wd[a])return Wd[a];const s=Pg[a]?Pg[a]():Pg.cylinder(),f=Vd([s],i);return Wd[a]=f,f}function I6(a,i,s=3,f=!1){const g=new Float32Array(a.length/s*3);let y,_,O;const A=vec3.create(),P=vec3.create(),B=vec3.create();for(let U=0,G=i.length;U<G;U+=3){y=i[U+0]*3,_=i[U+1]*3,O=i[U+2]*3;let vt=[a[y],a[y+1]],$t=[a[_],a[_+1]],te=[a[O],a[O+1]];f&&(vt=lngLatToMeters(vt),$t=lngLatToMeters($t),te=lngLatToMeters(te));const[Te,Fe]=vt,Ze=vec3.fromValues(Te,Fe,a[y+2]),[je,Qe]=$t,ln=vec3.fromValues(je,Qe,a[_+2]),[wn,mn]=te,Mn=vec3.fromValues(wn,mn,a[O+2]);vec3.sub(A,Mn,ln),vec3.sub(P,Ze,ln),vec3.cross(B,A,P),g[y]+=A[0],g[y+1]+=A[1],g[y+2]+=A[2],g[_]+=A[0],g[_+1]+=A[1],g[_+2]+=A[2],g[O]+=A[0],g[O+1]+=A[1],g[O+2]+=A[2]}return kT(g),g}function kT(a){for(let i=0,s=a.length;i<s;i+=3){const f=vec3.fromValues(a[i],a[i+1],a[i+2]),g=vec3.create();vec3.normalize(g,f),a.set(g,i)}}function R6(a){const i=a[0][0],s=a[0][a[0].length-1];return i[0]===s[0]&&i[1]===s[1]}function D2(a){const i=["cylinder","triangleColumn","hexagonColumn","squareColumn"],s=geometryShape[a]?geometryShape[a]():geometryShape.circle();return i.indexOf(a)===-1?fillPolygon([s]):extrudePolygon([s])}function Yd(a,i){const s=(a+1)/2,f=(i+1)/2;return[s,f]}function DT(){const a=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:i,indicesArr:s,normalArr:f}=a;return{vertices:i,indices:s,size:5,normals:f}}function Gu(){const a=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:i,indicesArr:s,normalArr:f}=a;return{vertices:i,indices:s,size:5,normals:f}}const FT=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,NT=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,BT={solid:0,dash:1};class jT extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.NEAREST,min:at.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:g="solid",dashArray:y=[10,5],forward:_=!0,lineTexture:O=!1,iconStep:A=100,segmentNumber:P=30}=this.layer.getLayerConfig(),{animateOption:B}=this.layer.getLayerConfig();let U=y;g!=="dash"&&(U=[0,0]),U.length===2&&U.push(0,0);let G=0,vt=[0,0,0,0],$t=[0,0,0,0];if(i&&s&&(vt=Lr(i),$t=Lr(s),G=1),this.rendererService.getDirty()){var te;(te=this.texture)===null||te===void 0||te.bind()}const Te={u_animate:this.animateOption2Array(B),u_dash_array:U,u_sourceColor:vt,u_targetColor:$t,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:P,u_lineDir:_?1:-1,u_icon_step:A,u_line_texture:O?1:0,u_textureBlend:f==="normal"?0:1,u_blur:.9,u_line_type:BT[g||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:G};return this.getUniformsBufferInfo(Te)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:FT,vert:NT,type:""}}buildModels(){var i=this;return(0,nn.Z)(function*(){i.initUniformsBuffer();const{segmentNumber:s=30}=i.layer.getLayerConfig(),{frag:f,vert:g,type:y}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:"lineArc2d"+y,vertexShader:g,fragmentShader:f,defines:i.getDefines(),inject:i.getInject(),triangulation:kg,depth:{enable:!1},styleOption:{segmentNumber:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:In.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:In.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[Ai(f[3]),Ai(f[4]),Ai(f[5]),Ai(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:g,y}=s[f]||{x:0,y:0};return[g,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:In.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{thetaOffset:s=1}=i;return[s]}}})}}const F2=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,rl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,Dg={solid:0,dash:1};class N2 extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.NEAREST,min:at.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:g="solid",dashArray:y=[10,5],lineTexture:_=!1,iconStep:O=100,segmentNumber:A=30,globalArcHeight:P=10}=this.layer.getLayerConfig(),{animateOption:B}=this.layer.getLayerConfig();y.length===2&&y.push(0,0);let U=0,G=[0,0,0,0],vt=[0,0,0,0];if(i&&s&&(G=Lr(i),vt=Lr(s),U=1),this.rendererService.getDirty()){var $t;($t=this.texture)===null||$t===void 0||$t.bind()}const te={u_animate:this.animateOption2Array(B),u_dash_array:y,u_sourceColor:G,u_targetColor:vt,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Ag,u_global_height:P,segmentNumber:A,u_line_type:Dg[g]||0,u_icon_step:O,u_line_texture:_?1:0,u_textureBlend:f==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:U};return this.getUniformsBufferInfo(te)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:F2,vert:rl,type:""}}buildModels(){var i=this;return(0,nn.Z)(function*(){const{segmentNumber:s=30}=i.layer.getLayerConfig(),{frag:f,vert:g,type:y}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:"lineArc3d"+y,vertexShader:g,fragmentShader:f,defines:i.getDefines(),inject:i.getInject(),triangulation:kg,styleOption:{segmentNumber:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:In.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:In.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[Ai(f[3]),Ai(f[4]),Ai(f[5]),Ai(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:g,y}=s[f]||{x:0,y:0};return[g,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:In.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{thetaOffset:s=1}=i;return[s]}}})}}const B2={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},ho=1/2;function Yu(a,i){const{width:s=2,height:f=1}=i;return{vertices:[0,ho*a,1*a*s,-(f+ho)*a,1*a*s,(f-ho)*a,0,ho*a,1*a*s,-(f+ho)*a,1*a*s,(f-ho)*a],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*a,-2*a,1,-2*a,1.5*a,1,1*a,1.5*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function zT(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,1*a*s,1*f,1*a*s,-1*f,0,0,1*a*s,1*f,1*a*s,-1*f],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*a,1,2,1*a,1,-2,1*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function Fg(a,i){const{width:s=2,height:f=2}=i;return{vertices:[0,f/2,a*s*1,f/2,a*s*1,-f/2,0,-f/2,0,f/2,a*s*1,f/2,a*s*1,-f/2,0,-f/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function UT(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,1*s*a,.5*f,2*s*a,0,1*s*a,-.5*f,0,0,1*s*a,.5*f,2*s*a,0,1*s*a,-.5*f],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function ZT(a,i){const{width:s=2,height:f=3}=i;return{vertices:[0,0,2*a*s,1*f,1.5*a*s,0,2*a*s,-1*f,0,0,2*a*s,1*f,1.5*a*s,0,2*a*s,-1*f],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function HT(a,i){const{width:s=2,height:f=2}=i,g=Cg(),y=ec().flatten([g]),_=ec()(y.vertices,y.holes,y.dimensions),O=g.map(A=>[A[0]*s*a,A[1]*f]).flat();return{vertices:[...O,...O],dimensions:2,indices:_.map(A=>A+g.length),outLineIndices:_,normals:[...g.map(A=>[A[1]*f,A[0]*s*a,1]).flat(),...new Array(g.length*3).fill(0)]}}function VT(a,i=0,s){const f=typeof s.source=="object"?s.source.type:s.source,g=typeof s.target=="object"?s.target.type:s.target,{width:y=f?B2[f]:0}=typeof s.source=="object"?s.source:{},{width:_=g?B2[g]:0}=typeof s.target=="object"?s.target:{};return{vertices:[0,ho,1*y,...a,1,ho,-1*_,...a,1,-ho,-1*_,...a,0,-ho,1*y,...a,0,ho,1*y,...a,1,ho,-1*_,...a,1,-ho,-1*_,...a,0,-ho,1*y,...a],outLineIndices:[0,1,2,0,2,3].map(O=>O+i),indices:[4,5,6,4,6,7].map(O=>O+i),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function rc(a,i){const s=typeof a=="object"?a.type:a,f=i==="source"?1:-1,g=typeof a=="object"?a:{};switch(s){case"circle":return HT(f,g);case"triangle":return zT(f,g);case"diamond":return UT(f,g);case"rect":return Fg(f,g);case"classic":return ZT(f,g);case"halfTriangle":return Yu(f,g);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function Ng(a){const i=a.coordinates.flat(),s=1,f=1;return{vertices:[1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i,1,0,0,...i,1,2,-3,...i,1,1,-3,...i,0,1,0,...i,0,0,0,...i],normals:[-s,2*f,1,2*f,-f,1,f,-f,1,f,-f,1,-s,-f,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function k6(a,i){return i?j2(a,i):Ng(a)}function j2(a,i){const s=a.coordinates.flat(),{target:f="classic",source:g="circle"}=i,y=$u(rc(g,"source"),s,0,0),_=VT(s,y.vertices.length/7,i),O=$u(rc(f,"target"),s,1,y.vertices.length/7+_.vertices.length/7);return{vertices:[...y.vertices,..._.vertices,...O.vertices],indices:[...y.outLineIndices,..._.outLineIndices,...O.outLineIndices,...y.indices,..._.indices,...O.indices],normals:[...y.normals,..._.normals,...O.normals],size:7}}function $u(a,i,s=1,f=0){const g=[],{vertices:y,indices:_,dimensions:O,outLineIndices:A}=a;for(let P=0;P<y.length;P+=O)g.push(s,y[P+1],y[P],...i);return(0,Je.Z)((0,Je.Z)({},a),{},{vertices:g,indices:_.map(P=>P+f),outLineIndices:A.map(P=>P+f)})}const WT=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,z2=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class U2 extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:i=2,strokeWidth:s=1,strokeOpacity:f=1}=this.layer.getLayerConfig(),g={u_gap_width:i,u_stroke_width:s,u_stroke_opacity:f};return this.getUniformsBufferInfo(g)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return[yield i.layer.buildLayerModel({moduleName:"flow_line",vertexShader:z2,fragmentShader:WT,defines:i.getDefines(),inject:i.getInject(),triangulation:k6,styleOption:i.layer.getLayerConfig().symbol,primitive:at.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:In.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:In.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[Ai(f[3]),Ai(f[4]),Ai(f[5]),Ai(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y)=>y}})}}const GT=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,Bg=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,YT={solid:0,dash:1};class $T extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.NEAREST,min:at.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:g="solid",dashArray:y=[10,5],lineTexture:_=!1,iconStep:O=100,segmentNumber:A=30}=this.layer.getLayerConfig(),{animateOption:P}=this.layer.getLayerConfig();if(y.length===2&&y.push(0,0),this.rendererService.getDirty()){var B;(B=this.texture)===null||B===void 0||B.bind()}let U=0,G=[0,0,0,0],vt=[0,0,0,0];i&&s&&(G=Lr(i),vt=Lr(s),U=1);let $t=this.layer.getLayerAnimateTime();isNaN($t)&&($t=0);const te={u_animate:this.animateOption2Array(P),u_dash_array:y,u_sourceColor:G,u_targetColor:vt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:A,u_line_type:YT[g]||0,u_icon_step:O,u_line_texture:_?1:0,u_textureBlend:f==="normal"?0:1,u_time:$t,u_linearColor:U};return this.getUniformsBufferInfo(te)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,nn.Z)(function*(){const{segmentNumber:s=30}=i.layer.getLayerConfig();return[yield i.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:Bg,fragmentShader:GT,triangulation:kg,styleOption:{segmentNumber:s},defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:In.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[f[3],f[4],f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:In.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>[Ai(f[3]),Ai(f[4]),Ai(f[5]),Ai(f[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:g,y}=s[f]||{x:0,y:0};return[g,y]}}})}}let D6=function(a){return a[a.solid=0]="solid",a[a.dash=1]="dash",a}({}),Z2=function(a){return a.VERTICAL="vertical",a.HORIZONTAL="horizontal",a}({}),XT=function(a){return a.NORMAL="normal",a.REPLACE="replace",a}({}),jg=function(a){return a[a.pixel=0]="pixel",a[a.meter=1]="meter",a}({}),qT=function(a){return a.ALWAYS="always",a.DRAGEND="dragend",a}({});const zg=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,KT=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class Ug extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"textureEventFlag",!1),(0,ut.Z)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.NEAREST,min:at.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",lineType:g="solid",dashArray:y=[10,5,0,0],lineTexture:_=!1,iconStep:O=100,vertexHeightScale:A=20,strokeWidth:P=0,raisingHeight:B=0,heightfixed:U=!1,linearDir:G=Z2.VERTICAL,blur:vt=[1,1,1,0]}=this.layer.getLayerConfig();let $t=y;if(g!=="dash"&&($t=[0,0,0,0]),$t.length===2&&$t.push(0,0),this.rendererService.getDirty()&&this.texture){var te;(te=this.texture)===null||te===void 0||te.bind()}const{animateOption:Te}=this.layer.getLayerConfig();let Fe=0,Ze=[0,0,0,0],je=[0,0,0,0];i&&s&&(Ze=Lr(i),je=Lr(s),Fe=1);const Qe={u_animate:this.animateOption2Array(Te),u_dash_array:$t,u_blur:vt,u_sourceColor:Ze,u_targetColor:je,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:O,u_heightfixed:Number(U),u_vertexScale:A,u_raisingHeight:Number(B),u_strokeWidth:P,u_textureBlend:f===XT.NORMAL?0:1,u_line_texture:_?1:0,u_linearDir:G===Z2.VERTICAL?1:0,u_linearColor:Fe,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Qe)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.textureEventFlag||(i.textureEventFlag=!0,i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture)),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,nn.Z)(function*(){const{depth:s=!1}=i.layer.getLayerConfig(),{frag:f,vert:g,type:y}=i.getShaders();return i.layer.triangulation=Hu,[yield i.layer.buildLayerModel({moduleName:"line"+y,vertexShader:g,fragmentShader:f,triangulation:Hu,defines:i.getDefines(),inject:i.getInject(),depth:{enable:s}})]})()}getShaders(){return{frag:zg,vert:KT,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:In.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y,_)=>_===void 0?[f[3],10,f[4]]:[f[3],_,f[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:In.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f,g,y)=>[...y,f[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:g,y}=s[f]||{x:0,y:0};return[g,y]}}})}}const Zg=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,H2=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class V2 extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,lineType:f="solid",dashArray:g=[10,5,0,0],vertexHeightScale:y=20}=this.layer.getLayerConfig();let _=g;f!=="dash"&&(_=[0,0,0,0]),_.length===2&&_.push(0,0);let O=0,A=[0,0,0,0],P=[0,0,0,0];i&&s&&(A=Lr(i),P=Lr(s),O=1);const B={u_sourceColor:A,u_targetColor:P,u_dash_array:_,u_vertexScale:y,u_linearColor:O};return this.getUniformsBufferInfo(B)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}getShaders(){return{frag:Zg,vert:H2,type:"lineSimpleNormal"}}buildModels(){var i=this;return(0,nn.Z)(function*(){i.initUniformsBuffer();const{frag:s,vert:f,type:g}=i.getShaders();return[yield i.layer.buildLayerModel({moduleName:g,vertexShader:f,fragmentShader:s,triangulation:Vu,defines:i.getDefines(),inject:i.getInject(),primitive:at.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:In.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:4,update:(i,s,f)=>{const{size:g=1}=i,y=Array.isArray(g)?[g[0],g[1]]:[g,0];return[y[0],y[1],f[3],f[5]]}}})}}const W2=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,G2=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Y2 extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.NEAREST,min:at.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:i,targetColor:s,textureBlend:f="normal",heightfixed:g=!1,lineTexture:y=!1,iconStep:_=100,iconStepCount:O=1}=this.layer.getLayerConfig(),{animateOption:A}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var P;(P=this.texture)===null||P===void 0||P.bind()}let B=0,U=[0,0,0,0],G=[0,0,0,0];i&&s&&(U=Lr(i),G=Lr(s),B=1);const vt={u_animate:this.animateOption2Array(A),u_sourceColor:U,u_targetColor:G,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:_,u_heightfixed:Number(g),u_linearColor:B,u_line_texture:y?1:0,u_textureBlend:f==="normal"?0:1,u_iconStepCount:O,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(vt)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.updateTexture(),i.iconService.on("imageUpdate",i.updateTexture),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,nn.Z)(function*(){return[yield i.layer.buildLayerModel({moduleName:"lineWall",vertexShader:G2,fragmentShader:W2,triangulation:Hu,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},blend:i.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0],s[1]]:[s,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:In.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f)=>[f[3],f[4],f[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{texture:f}=i,{x:g,y}=s[f]||{x:0,y:0};return[g,y]}}})}}var Wr={arc:jT,arc3d:N2,greatcircle:$T,wall:Y2,line:Ug,simple:V2,flowline:U2,earthArc3d:N2};class il extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","LineLayer"),(0,ut.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,ut.Z)(this,"arrowInsertCount",0),(0,ut.Z)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel=new Wr[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[i]}getModelType(){var i;if(this.layerType)return this.layerType;const s=this.styleAttributeService.getLayerStyleAttribute("shape");return(s==null||(i=s.scale)===null||i===void 0?void 0:i.field)||"line"}processData(i){if(this.getModelType()!=="simple")return i;const s=[];return i.map(f=>{if(Array.isArray(f.coordinates)&&Array.isArray(f.coordinates[0])&&Array.isArray(f.coordinates[0][0])){const g=(0,Je.Z)({},f);f.coordinates.map(y=>{s.push((0,Je.Z)((0,Je.Z)({},g),{},{coordinates:y}))})}else s.push(f)}),s}}const $d=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,JT=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class za extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"raiseCount",0),(0,ut.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:i={enable:!1,speed:.01,repeat:!1},sourceColor:s,targetColor:f,pickLight:g=!1,heightfixed:y=!1,opacityLinear:_={enable:!1,dir:"up"},lightEnable:O=!0}=this.layer.getLayerConfig();let A=0,P=[0,0,0,0],B=[0,0,0,0];if(s&&f&&(P=Lr(s),B=Lr(f),A=1),this.raiseCount<1&&this.raiseRepeat>0&&i.enable){const{speed:vt=.01}=i;this.raiseCount+=vt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const U={u_pickLight:Number(g),u_heightfixed:Number(y),u_r:i.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:A,u_sourceColor:P,u_targetColor:B,u_opacitylinear:Number(_.enable),u_opacitylinear_dir:_.dir==="up"?1:0,u_lightEnable:Number(O)};return this.getUniformsBufferInfo(U)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{depth:s=!0,animateOption:{repeat:f=1}}=i.layer.getLayerConfig();return i.raiseRepeat=f,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:JT,fragmentShader:$d,triangulation:I2,defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:at.FRONT},depth:{enable:s}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:i=>{const{size:s}=i;if(s){let f=[];return Array.isArray(s)&&(f=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(f=[s,s,s]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:In.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:4,update:i=>{const s=$a(i.coordinates);return[s[0],s[1],Ai(s[0]),Ai(s[1])]}}})}}const pr=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Xu=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class ol extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:i=1,strokeWidth:s=0,blend:f,blur:g=0,raisingHeight:y=0,heightfixed:_=!1,unit:O="pixel"}=this.layer.getLayerConfig();let A=this.getAnimateUniforms().u_time;isNaN(A)&&(A=-1);const P={u_blur_height_fixed:[g,Number(y),Number(_)],u_stroke_width:s,u_additive:f==="additive"?1:0,u_stroke_opacity:i,u_size_unit:jg[O],u_time:A,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(P)}getAnimateUniforms(){const{animateOption:i={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(i),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),nc)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{frag:s,vert:f,type:g}=i.getShaders();return i.layer.triangulation=nc,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:g,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:nc,depth:{enable:!1}})]})()}getShaders(){return{frag:pr,vert:Xu,type:"pointFill"}}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){const i=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:In.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:(s,f,g,y)=>{const _=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=y%4*3;return[_[O],_[O+1],_[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:s=>{const{size:f=5}=s;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:In.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:s=>{const{shape:f=2}=s;return[i.indexOf(f)]}}})}}const qu=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,ic=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class ps extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=s({data:this.iconService.getCanvas(),mag:at.LINEAR,min:at.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var i;(i=this.texture)===null||i===void 0||i.bind()}const s=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},s.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:i=0,heightfixed:s=!1}=this.layer.getLayerConfig(),f={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(i),u_heightfixed:Number(s),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.iconService.on("imageUpdate",i.updateTexture),i.updateTexture(),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointImage",vertexShader:ic,fragmentShader:qu,triangulation:CT,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},primitive:at.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{shape:f}=i,{x:g,y}=s[f]||{x:-64,y:-64};return[g,y]}}})}}const Xd=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,al=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function Hg(a){const i=a.coordinates;return{vertices:[...i],indices:[0],size:i.length}}class qd extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const i={u_size_scale:.5};return this.getUniformsBufferInfo(i)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.layer.triangulation=Hg,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:al,fragmentShader:Xd,triangulation:Hg,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1},primitive:at.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}class $2{constructor(i,s,f){(0,ut.Z)(this,"boxCells",[]),(0,ut.Z)(this,"xCellCount",void 0),(0,ut.Z)(this,"yCellCount",void 0),(0,ut.Z)(this,"boxKeys",void 0),(0,ut.Z)(this,"bboxes",void 0),(0,ut.Z)(this,"width",void 0),(0,ut.Z)(this,"height",void 0),(0,ut.Z)(this,"xScale",void 0),(0,ut.Z)(this,"yScale",void 0),(0,ut.Z)(this,"boxUid",void 0);const g=this.boxCells;this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(s/f);for(let y=0;y<this.xCellCount*this.yCellCount;y++)g.push([]);this.boxKeys=[],this.bboxes=[],this.width=i,this.height=s,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/s,this.boxUid=0}insert(i,s,f,g,y){this.forEachCell(s,f,g,y,this.insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(s),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(y)}query(i,s,f,g,y){return this.queryHitTest(i,s,f,g,!1,y)}hitTest(i,s,f,g,y){return this.queryHitTest(i,s,f,g,!0,y)}insertBoxCell(i,s,f,g,y,_){this.boxCells[y].push(_)}queryHitTest(i,s,f,g,y,_){if(f<0||i>this.width||g<0||s>this.height)return y?!1:[];const O=[];if(i<=0&&s<=0&&this.width<=f&&this.height<=g){if(y)return!0;for(let P=0;P<this.boxKeys.length;P++)O.push({key:this.boxKeys[P],x1:this.bboxes[P*4],y1:this.bboxes[P*4+1],x2:this.bboxes[P*4+2],y2:this.bboxes[P*4+3]});return _?O.filter(_):O}const A={hitTest:y,seenUids:{box:{},circle:{}}};return this.forEachCell(i,s,f,g,this.queryCell,O,A,_),y?O.length>0:O}queryCell(i,s,f,g,y,_,O,A){const P=O.seenUids,B=this.boxCells[y];if(B!==null){const U=this.bboxes;for(const G of B)if(!P.box[G]){P.box[G]=!0;const vt=G*4;if(i<=U[vt+2]&&s<=U[vt+3]&&f>=U[vt+0]&&g>=U[vt+1]&&(!A||A(this.boxKeys[G]))){if(O.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[G],x1:U[vt],y1:U[vt+1],x2:U[vt+2],y2:U[vt+3]})}}}return!1}forEachCell(i,s,f,g,y,_,O,A){const P=this.convertToXCellCoord(i),B=this.convertToYCellCoord(s),U=this.convertToXCellCoord(f),G=this.convertToYCellCoord(g);for(let vt=P;vt<=U;vt++)for(let $t=B;$t<=G;$t++){const te=this.xCellCount*$t+vt;if(y.call(this,i,s,f,g,te,_,O,A))return}}convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}}var tC=$2;class Vg{constructor(i,s){(0,ut.Z)(this,"width",void 0),(0,ut.Z)(this,"height",void 0),(0,ut.Z)(this,"grid",void 0),(0,ut.Z)(this,"viewportPadding",100),(0,ut.Z)(this,"screenRightBoundary",void 0),(0,ut.Z)(this,"screenBottomBoundary",void 0),(0,ut.Z)(this,"gridRightBoundary",void 0),(0,ut.Z)(this,"gridBottomBoundary",void 0),this.width=i,this.height=s,this.viewportPadding=Math.max(i,s),this.grid=new tC(i+this.viewportPadding,s+this.viewportPadding,25),this.screenRightBoundary=i+this.viewportPadding,this.screenBottomBoundary=s+this.viewportPadding,this.gridRightBoundary=i+2*this.viewportPadding,this.gridBottomBoundary=s+2*this.viewportPadding}placeCollisionBox(i){const s=i.x1+i.anchorPointX+this.viewportPadding,f=i.y1+i.anchorPointY+this.viewportPadding,g=i.x2+i.anchorPointX+this.viewportPadding,y=i.y2+i.anchorPointY+this.viewportPadding;return!this.isInsideGrid(s,f,g,y)||this.grid.hitTest(s,f,g,y)?{box:[]}:{box:[s,f,g,y]}}insertCollisionBox(i,s){const f={featureIndex:s};this.grid.insert(f,i[0],i[1],i[2],i[3])}project(i,s,f){const g=ts.al(s,f,0,1),y=ts.Ue(),_=Er.fromValues(...i);return ts.fF(y,g,_),{x:(y[0]/y[3]+1)/2*this.width+this.viewportPadding,y:(-y[1]/y[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(i,s,f,g){return f>=0&&i<this.gridRightBoundary&&g>=0&&s<this.gridBottomBoundary}}function X2(a){let i=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0;break;default:i=.5}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0;break;default:s=.5}return{horizontalAlign:i,verticalAlign:s}}function Wg(a,i,s,f,g){if(!g)return;const y=a[f],_=y.glyph;if(_){const O=i[_].advance*y.scale,A=(a[f].x+O)*g;for(let P=s;P<=f;P++)a[P].x-=A}}function sl(a,i,s,f,g,y,_){const O=(i-s)*g,A=(-f*_+.5)*y;for(const P of a)P.x+=O,P.y+=A}function eC(a,i,s,f,g,y,_){let A=0,P=-8,B=0;const U=a.positionedGlyphs,G=y==="right"?1:y==="left"?0:.5,vt=U.length;s.forEach(Fe=>{if(Fe.split("").forEach(Ze=>{const je=i[Ze];je&&(U.push({glyph:Ze,x:A,y:P+0,vertical:!1,scale:1,metrics:je}),A+=je.advance+_)}),U.length!==vt){const Ze=A-_;B=Math.max(Ze,B),Wg(U,i,vt,U.length-1,G)}A=0,P-=f+5});const{horizontalAlign:$t,verticalAlign:te}=X2(g);sl(U,G,$t,te,B,f,s.length);const Te=P- -8;a.top+=-te*Te,a.bottom=a.top-Te,a.left+=-$t*B,a.right=a.left+B}function Kd(a,i,s,f,g,y,_){let A=0,P=-8,B=0;const U=a.positionedGlyphs,G=y==="right"?1:y==="left"?0:.5,vt=U.length;s.forEach(Fe=>{const Ze=i[Fe];if(Ze&&(U.push({glyph:Fe,x:Ze.advance/2,y:P+0,vertical:!1,scale:1,metrics:Ze}),A+=Ze.advance+_),U.length!==vt){const Qe=A-_;B=Math.max(Qe,B),Wg(U,i,vt,U.length-1,G)}A=0,P-=f+5});const{horizontalAlign:$t,verticalAlign:te}=X2(g);sl(U,G,$t,te,B,f,s.length);const Te=P- -8;a.top+=-te*Te,a.bottom=a.top-Te,a.left+=-$t*B,a.right=a.left+B}function Qd(a,i,s,f,g,y,_=[0,0],O){const A=a.split(`
`),P=[],B={positionedGlyphs:P,top:_[1],bottom:_[1],left:_[0],right:_[0],lineCount:A.length,text:a};return O?Kd(B,i,A,s,f,g,y):eC(B,i,A,s,f,g,y),P.length?B:!1}function nC(a,i=[0,0],s){const{positionedGlyphs:f=[]}=a,g=[];for(const y of f){const _=y.metrics,O=4,A=_.advance*y.scale/2,P=s?[y.x+A,y.y]:[0,0],B=s?[0,0]:[y.x+A+i[0],y.y+i[1]],U=(0-O)*y.scale-A+B[0],G=(0-O)*y.scale+B[1],vt=U+_.width*y.scale,$t=G+_.height*y.scale,te={x:U,y:G},Te={x:vt,y:G},Fe={x:U,y:$t},Ze={x:vt,y:$t};g.push({tl:te,tr:Te,bl:Fe,br:Ze,tex:_,glyphOffset:P})}return g}const Gg=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,Yg=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:Pi}=Nr;function rC(a){const i=this,s=a.id,f=[],g=[];if(!i.glyphInfoMap||!i.glyphInfoMap[s])return{vertices:[],indices:[],size:7};const y=i.glyphInfoMap[s].centroid,_=y.length===2?[y[0],y[1],0]:y;return i.glyphInfoMap[s].glyphQuads.forEach((O,A)=>{f.push(..._,O.tex.x,O.tex.y+O.tex.height,O.tl.x,O.tl.y,..._,O.tex.x+O.tex.width,O.tex.y+O.tex.height,O.tr.x,O.tr.y,..._,O.tex.x+O.tex.width,O.tex.y,O.br.x,O.br.y,..._,O.tex.x,O.tex.y,O.bl.x,O.bl.y),g.push(0+A*4,1+A*4,2+A*4,2+A*4,3+A*4,0+A*4)}),{vertices:f,indices:g,size:7}}class Ua extends Vr{constructor(...i){var s;super(...i),s=this,(0,ut.Z)(this,"glyphInfo",void 0),(0,ut.Z)(this,"glyphInfoMap",{}),(0,ut.Z)(this,"rawEncodeData",void 0),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"currentZoom",-1),(0,ut.Z)(this,"extent",void 0),(0,ut.Z)(this,"textureHeight",0),(0,ut.Z)(this,"textCount",0),(0,ut.Z)(this,"preTextStyle",{}),(0,ut.Z)(this,"mapping",(0,nn.Z)(function*(){s.initGlyph(),s.updateTexture(),yield s.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:i="#fff",strokeWidth:s=0,halo:f=.5,gamma:g=2,raisingHeight:y=0}=this.layer.getLayerConfig(),_=this.getFontServiceMapping(),O=this.getFontServiceCanvas();_&&Object.keys(_).length!==this.textCount&&O&&(this.updateTexture(),this.textCount=Object.keys(_).length),this.preTextStyle=this.getTextStyle();const A={u_stroke_color:Lr(i),u_sdf_map_size:[(O==null?void 0:O.width)||1,(O==null?void 0:O.height)||1],u_raisingHeight:Number(y),u_stroke_width:s,u_gamma_scale:g,u_halo_blur:f};return this.getUniformsBufferInfo(A)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.bindEvent(),i.extent=i.textExtent(),i.rawEncodeData=i.layer.getEncodedData(),i.preTextStyle=i.getTextStyle(),i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{textAllowOverlap:s=!1}=i.layer.getLayerConfig();return i.initGlyph(),i.updateTexture(),s||i.filterGlyphs(),[yield i.layer.buildLayerModel({moduleName:"pointText",vertexShader:Yg,fragmentShader:Gg,defines:i.getDefines(),inject:i.getInject(),triangulation:rC.bind(i),depth:{enable:!1}})]})()}needUpdate(){var i=this;return(0,nn.Z)(function*(){const{textAllowOverlap:s=!1,textAnchor:f="center",textOffset:g,padding:y,fontFamily:_,fontWeight:O}=i.getTextStyle();if(!Pi(y,i.preTextStyle.padding)||!Pi(g,i.preTextStyle.textOffset)||!Pi(f,i.preTextStyle.textAnchor)||!Pi(_,i.preTextStyle.fontFamily)||!Pi(O,i.preTextStyle.fontWeight))return yield i.mapping(),!0;if(s)return!1;const A=i.mapService.getZoom(),P=i.mapService.getBounds(),B=Kh(i.extent,P);return Math.abs(i.currentZoom-A)>.5||!B||s!==i.preTextStyle.textAllowOverlap?(yield i.reBuildModel(),!0):!1})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:In.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[5],f[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:In.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=12}=i;return Array.isArray(s)?[s[0]]:[s]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const i=this.mapService.getBounds();return qh(i,.5)}initTextFont(){const{fontWeight:i,fontFamily:s}=this.getTextStyle(),f=this.rawEncodeData,g=[];f.forEach(y=>{let{shape:_=""}=y;_=_.toString();for(const O of _)g.indexOf(O)===-1&&g.push(O)}),this.fontService.setFontOptions({characterSet:g,fontWeight:i,fontFamily:s,iconfont:!1})}initIconFontTex(){const{fontWeight:i,fontFamily:s}=this.getTextStyle(),f=this.rawEncodeData,g=[];f.forEach(y=>{let{shape:_=""}=y;_=`${_}`,g.indexOf(_)===-1&&g.push(_)}),this.fontService.setFontOptions({characterSet:g,fontWeight:i,fontFamily:s,iconfont:!0})}getTextStyle(){const{fontWeight:i="400",fontFamily:s="sans-serif",textAllowOverlap:f=!1,padding:g=[0,0],textAnchor:y="center",textOffset:_=[0,0],opacity:O=1,strokeOpacity:A=1,strokeWidth:P=0,stroke:B="#000"}=this.layer.getLayerConfig();return{fontWeight:i,fontFamily:s,textAllowOverlap:f,padding:g,textAnchor:y,textOffset:_,opacity:O,strokeOpacity:A,strokeWidth:P,stroke:B}}generateGlyphLayout(i){const s=this.getFontServiceMapping(),{spacing:f=2,textAnchor:g="center",textOffset:y}=this.layer.getLayerConfig(),_=this.rawEncodeData;this.glyphInfo=_.map(O=>{const{shape:A="",id:P,size:B=1}=O,U=O.textOffset?O.textOffset:y||[0,0],G=O.textAnchor?O.textAnchor:g||"center",vt=Qd(A.toString(),s,B,G,"left",f,U,i),$t=nC(vt,U,!1);return O.shaping=vt,O.glyphQuads=$t,O.centroid=$a(O.coordinates),this.glyphInfoMap[P]={shaping:vt,glyphQuads:$t,centroid:$a(O.coordinates)},O})}getFontServiceMapping(){const{fontWeight:i="400",fontFamily:s="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${s}_${i}`)}getFontServiceCanvas(){const{fontWeight:i="400",fontFamily:s="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${s}_${i}`)}filterGlyphs(){const{padding:i=[0,0],textAllowOverlap:s=!1}=this.layer.getLayerConfig();if(s)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:f,height:g}=this.rendererService.getViewportSize(),y=new Vg(f,g);this.glyphInfo.filter(O=>{const{shaping:A,id:P=0}=O,B=O.centroid,G=O.size/16,vt=this.mapService.lngLatToContainer(B),{box:$t}=y.placeCollisionBox({x1:A.left*G-i[0],x2:A.right*G+i[0],y1:A.top*G-i[1],y2:A.bottom*G+i[1],anchorPointX:vt.x,anchorPointY:vt.y});return $t&&$t.length?(y.insertCollisionBox($t,P),!0):!1}).forEach(O=>{this.glyphInfoMap[O.id]=O})}initGlyph(){const{iconfont:i=!1}=this.layer.getLayerConfig();i?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(i)}updateTexture(){const{createTexture2D:i}=this.rendererService,s=this.getFontServiceCanvas();this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=i({data:s,mag:at.LINEAR,min:at.LINEAR,width:s.width,height:s.height}),this.textures=[this.texture]}reBuildModel(){var i=this;return(0,nn.Z)(function*(){i.filterGlyphs();const s=yield i.layer.buildLayerModel({moduleName:"pointText",vertexShader:Yg,fragmentShader:Gg,triangulation:rC.bind(i),defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}});i.layer.models=[s]})()}}function cl(a){return $g.apply(this,arguments)}function $g(){return $g=(0,nn.Z)(function*(a){if(window.createImageBitmap){const i=yield fetch(a);return yield createImageBitmap(yield i.blob())}else{const i=new window.Image;return new Promise(s=>{i.onload=()=>s(i),i.src=a,i.crossOrigin="Anonymous"})}}),$g.apply(this,arguments)}const ll=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,li=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,hi=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Xg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,oc=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,Jd=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class qg extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:i,heightfixed:s=!1,raisingHeight:f=0,topsurface:g=!0,sidesurface:y=!0,sourceColor:_,targetColor:O}=this.layer.getLayerConfig();let A=0,P=[1,1,1,1],B=[1,1,1,1];_&&O&&(P=Lr(_),B=Lr(O),A=1);const U={u_sourceColor:P,u_targetColor:B,u_linearColor:A,u_topsurface:Number(g),u_sidesurface:Number(y),u_heightfixed:Number(s),u_raisingHeight:Number(f)};return i&&this.texture&&(U.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(U)}initModels(){var i=this;return(0,nn.Z)(function*(){return yield i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{frag:s,vert:f,type:g}=i.getShaders();return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:g,vertexShader:f,fragmentShader:s,depth:{enable:!0},defines:i.getDefines(),inject:i.getInject(),triangulation:k2})]})()}getShaders(){const{pickLight:i,mapTexture:s}=this.layer.getLayerConfig();return s?{frag:oc,vert:Jd,type:"polygonExtrudeTexture"}:i?{frag:li,vert:hi,type:"polygonExtrudePickLight"}:{frag:ll,vert:Xg,type:"polygonExtrude"}}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy(),this.textures=[]}registerBuiltinAttributes(){const i=this.layer.getSource().extent,s=i[2]-i[0],f=i[3]-i[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:In.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(g,y,_)=>{const O=_[0],A=_[1];return[(O-i[0])/s,(A-i[1])/f,_[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(g,y,_,O,A)=>A}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:g=>{const{size:y=10}=g;return Array.isArray(y)?[y[0]]:[y]}}})}loadTexture(){var i=this;return(0,nn.Z)(function*(){const{mapTexture:s}=i.layer.getLayerConfig(),{createTexture2D:f}=i.rendererService;if(i.texture=f({height:1,width:1}),s){const g=yield cl(s);i.texture=f({data:g,width:g.width,height:g.height,wrapS:at.CLAMP_TO_EDGE,wrapT:at.CLAMP_TO_EDGE,min:at.LINEAR,mag:at.LINEAR})}})()}}const ga=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,Kg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Qg extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const i={};return this.getUniformsBufferInfo(i)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{frag:s,vert:f,type:g}=i.getShaders();return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:g,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:k2,depth:{enable:!0}})]})()}getShaders(){return{frag:ga,vert:Kg,type:"polygonExtrude"}}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=10}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:In.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{extrusionBase:s=0}=i;return[s]}}})}}const q2=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,K2=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,Q2=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,J2=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class tx extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:i=0,opacityLinear:s={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),f={u_raisingHeight:Number(i),u_opacitylinear:Number(s.enable),u_dir:s.dir==="in"?1:0};return this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{frag:s,vert:f,triangulation:g,type:y}=i.getModelParams();return i.initUniformsBuffer(),i.layer.triangulation=g,[yield i.layer.buildLayerModel({moduleName:y,vertexShader:f,fragmentShader:s,defines:i.getDefines(),inject:i.getInject(),triangulation:g,primitive:at.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:i={enable:!1,dir:"in"}}=this.layer.getLayerConfig();i.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:In.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(s,f,g)=>[g[3],g[4],g[5]]}})}getModelParams(){const{opacityLinear:i={enable:!1}}=this.layer.getLayerConfig();return i.enable?{frag:K2,vert:Q2,type:"polygonLinear",triangulation:PT}:{frag:q2,vert:J2,type:"polygonFill",triangulation:Wu}}}const ex=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,nx=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Jg extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture1",void 0),(0,ut.Z)(this,"texture2",void 0),(0,ut.Z)(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{watercolor:i="#6D99A8",watercolor2:s="#0F121C"}=this.layer.getLayerConfig(),f={u_watercolor:Lr(i),u_watercolor2:Lr(s),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(f)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var i=this;return(0,nn.Z)(function*(){return i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:nx,fragmentShader:ex,defines:i.getDefines(),inject:i.getInject(),triangulation:Wu,primitive:at.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var i,s,f;(i=this.texture1)===null||i===void 0||i.destroy(),(s=this.texture2)===null||s===void 0||s.destroy(),(f=this.texture3)===null||f===void 0||f.destroy()}registerBuiltinAttributes(){const i=this.layer.getSource().extent,[s,f,g,y]=i,_=g-s,O=y-f;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:In.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:2,update:(A,P,B)=>{const[U,G]=B;return[(U-s)/_,(G-f)/O]}}})}loadTexture(){const{createTexture2D:i}=this.rendererService,s={height:0,width:0};this.texture1=i(s),this.texture2=i(s),this.texture3=i(s),f(y=>{this.texture1=g(y[0]),this.texture2=g(y[1]),this.texture3=g(y[2]),this.layerService.reRender()});function f(y){let _=0;const O=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(P=>{const B=new Image;B.crossOrigin="",B.src=P,O.push(B),B.onload=()=>{_++,_===3&&y(O)}})}function g(y){return i({data:y,width:y.width,height:y.height,wrapS:at.MIRRORED_REPEAT,wrapT:at.MIRRORED_REPEAT,min:at.LINEAR,mag:at.LINEAR})}}}const Ku=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,iC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class rx extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{speed:i=.5}=this.layer.getLayerConfig(),s={u_speed:i,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(s)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var i=this;return(0,nn.Z)(function*(){return i.loadTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:iC,fragmentShader:Ku,triangulation:Wu,defines:i.getDefines(),inject:i.getInject(),primitive:at.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){const i=this.layer.getSource().extent,[s,f,g,y]=i,_=g-s,O=y-f;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:In.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:2,update:(A,P,B)=>{const[U,G]=B;return[(U-s)/_,(G-f)/O]}}})}loadTexture(){const{waterTexture:i}=this.layer.getLayerConfig(),{createTexture2D:s}=this.rendererService;this.texture=s({height:1,width:1});const f=new Image;f.crossOrigin="",i?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),f.src=i):f.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",f.onload=()=>{this.texture=s({data:f,width:f.width,height:f.height,wrapS:at.MIRRORED_REPEAT,wrapT:at.MIRRORED_REPEAT,min:at.LINEAR,mag:at.LINEAR}),this.layerService.reRender()}}}var oC={fill:tx,line:Ug,extrude:qg,text:Ua,point_fill:ol,point_image:ps,point_normal:qd,point_extrude:za,water:rx,ocean:Jg,extrusion:Qg};class po extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","PolygonLayer"),(0,ut.Z)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel=new oC[s](i),yield i.initLayerModels()})()}getModelType(){var i;const s=this.styleAttributeService.getLayerStyleAttribute("shape"),f=s==null||(i=s.scale)===null||i===void 0?void 0:i.field;return f==="fill"||!f?"fill":f==="extrude"?"extrude":f==="extrusion"?"extrusion":f==="water"?"water":f==="ocean"?"ocean":f==="line"?"line":this.getPointModelType()}getPointModelType(){const i=this.getEncodedData(),{shape2d:s,shape3d:f}=this.getLayerConfig(),g=this.iconService.getIconMap(),y=i.find(_=>_.hasOwnProperty("shape"));if(y){const _=y.shape;return _==="dot"?"point_normal":(s==null?void 0:s.indexOf(_))!==-1?"point_fill":(f==null?void 0:f.indexOf(_))!==-1?"point_extrude":g.hasOwnProperty(_)?"point_image":"text"}else return"fill"}}class ix{constructor({rendererService:i,layerService:s,parent:f}){(0,ut.Z)(this,"tileResource",new Map),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"parent",void 0),(0,ut.Z)(this,"layerTiles",[]),this.rendererService=i,this.layerService=s,this.parent=f}get tiles(){return this.layerTiles}hasTile(i){return this.layerTiles.some(s=>s.key===i)}addTile(i){this.layerTiles.push(i)}getTile(i){return this.layerTiles.find(s=>s.key===i)}getVisibleTileBylngLat(i){return this.layerTiles.find(s=>s.isLoaded&&s.visible&&s.lnglatInBounds(i))}removeTile(i){const s=this.layerTiles.findIndex(g=>g.key===i),f=this.layerTiles.splice(s,1);f[0]&&f[0].destroy()}updateTileVisible(i){const s=this.getTile(i.key);if(i.isVisible)if(i.parent){const f=this.isChildrenLoaded(i.parent);s==null||s.updateVisible(f)}else s==null||s.updateVisible(!0);else if(i.parent){const f=this.isChildrenLoaded(i.parent);s==null||s.updateVisible(!f)}else s==null||s.updateVisible(!1)}isParentLoaded(i){const s=i.parent;if(!s)return!0;const f=this.getTile(s==null?void 0:s.key);return!!(f!=null&&f.isLoaded)}isChildrenLoaded(i){const s=i==null?void 0:i.children;return s.length===0?!0:s.every(f=>{const g=this.getTile(f==null?void 0:f.key);return g?(g==null?void 0:g.isLoaded)===!0:!0})}render(){var i=this;return(0,nn.Z)(function*(){const f=i.getRenderLayers().map(function(){var g=(0,nn.Z)(function*(y){yield i.layerService.renderTileLayer(y)});return function(y){return g.apply(this,arguments)}}());yield Promise.all(f)})()}getRenderLayers(){const i=this.layerTiles.filter(f=>f.visible&&f.isLoaded),s=[];return i.map(f=>s.push(...f.getLayers())),s}getLayers(){const i=this.layerTiles.filter(f=>f.isLoaded),s=[];return i.map(f=>s.push(...f.getLayers())),s}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(i=>i.destroy()),this.tileResource.clear()}}var tv=k(32676);function ev(a,i,s){s===void 0&&(s={});var f=Ye(a),g=Ye(i),y=tv.union(f.coordinates,g.coordinates);return y.length===0?null:y.length===1?ot(y[0],s.properties):Lt(y,s.properties)}var N6=ev;class nv{getCombineFeature(i){let s=null;const f=i[0];return i.map(g=>{const y=ot(g.coordinates);s===null?s=y:s=N6(s,y)}),f&&(s.properties=(0,Je.Z)({},f)),s}}const th="select",ul="active";class ox{constructor({layerService:i,tileLayerService:s,parent:f}){(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"tileLayerService",void 0),(0,ut.Z)(this,"tileSourceService",void 0),(0,ut.Z)(this,"parent",void 0),(0,ut.Z)(this,"tilePickID",new Map),this.layerService=i,this.tileLayerService=s,this.parent=f,this.tileSourceService=new nv}pickRender(i){const s=this.tileLayerService.getVisibleTileBylngLat(i.lngLat);if(s){const f=s.getMainLayer();f==null||f.layerPickService.pickRender(i)}}pick(i,s){var f=this;return(0,nn.Z)(function*(){const y=f.parent.getContainer().pickingService;if(i.type==="RasterLayer"){const _=f.tileLayerService.getVisibleTileBylngLat(s.lngLat);if(_&&_.getMainLayer()!==void 0){const O=_.getMainLayer();return O.layerPickService.pickRasterLayer(O,s,f.parent)}return!1}return f.pickRender(s),y.pickFromPickingFBO(i,s)})()}selectFeature(i){const[s,f,g]=i,y=this.color2PickId(s,f,g);this.tilePickID.set(th,y),this.updateHighLight(s,f,g,th)}highlightPickedFeature(i){const[s,f,g]=i,y=this.color2PickId(s,f,g);this.tilePickID.set(ul,y),this.updateHighLight(s,f,g,ul)}updateHighLight(i,s,f,g){this.tileLayerService.tiles.map(y=>{const _=y.getMainLayer();switch(g){case th:_==null||_.hooks.beforeSelect.call([i,s,f]);break;case ul:_==null||_.hooks.beforeHighlight.call([i,s,f]);break}})}setPickState(){const i=this.tilePickID.get(th),s=this.tilePickID.get(ul);if(i){const[f,g,y]=this.pickId2Color(i);this.updateHighLight(f,g,y,th);return}if(s){const[f,g,y]=this.pickId2Color(s);this.updateHighLight(f,g,y,ul);return}}color2PickId(i,s,f){return Os(new Uint8Array([i,s,f]))}pickId2Color(i){return _c(i)}getFeatureById(i){const s=this.tileLayerService.getTiles().filter(g=>g.visible),f=[];return s.forEach(g=>{f.push(...g.getFeatureById(i))}),f}pickRasterLayer(){return!1}}const B6=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,ax=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function rv(a){const i=a.coordinates;return{vertices:[...i],indices:[0],size:i.length}}class sx extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:i,strokeOpacity:s=1,strokeWidth:f=0,stroke:g="#fff"}=this.layer.getLayerConfig(),y={u_stroke_color:Lr(g),u_additive:i==="additive"?1:0,u_stroke_opacity:s,u_stroke_width:f};return this.getUniformsBufferInfo(y)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.layer.triangulation=rv,i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:ax,fragmentShader:B6,defines:i.getDefines(),inject:i.getInject(),triangulation:rv,depth:{enable:!1},primitive:at.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=1}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}const cx=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,lx=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:iv}=Nr;class eh extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"raiseCount",0),(0,ut.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:i={enable:!1,speed:.01,repeat:!1},opacity:s=1,sourceColor:f,targetColor:g,pickLight:y=!1,heightfixed:_=!0,opacityLinear:O={enable:!1,dir:"up"},lightEnable:A=!0}=this.layer.getLayerConfig();let P=0,B=[0,0,0,0],U=[0,0,0,0];if(f&&g&&(B=Lr(f),U=Lr(g),P=1),this.raiseCount<1&&this.raiseRepeat>0&&i.enable){const{speed:$t=.01}=i;this.raiseCount+=$t,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const G={u_sourceColor:B,u_targetColor:U,u_linearColor:P,u_pickLight:Number(y),u_heightfixed:Number(_),u_r:i.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:iv(s)?s:1,u_opacitylinear:Number(O.enable),u_opacitylinear_dir:O.dir==="up"?1:0,u_lightEnable:Number(A)};return this.getUniformsBufferInfo(G)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){const{animateOption:{repeat:s=1}}=i.layer.getLayerConfig();return i.raiseRepeat=s,[yield i.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:lx,fragmentShader:cx,triangulation:I2,depth:{enable:!0},defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:at.FRONT},blend:i.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:i=>{const{size:s}=i;if(s){let f=[];return Array.isArray(s)&&(f=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(f=[s,s,s]),f}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:In.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:at.STATIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g,y)=>y}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:In.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:i=>{const s=$a(i.coordinates);return Tg([s[0],s[1]])}}})}}const ux=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,fx=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class dx extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:i=1,strokeWidth:s=0,blend:f,blur:g=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const y={u_additive:f==="additive"?1:0,u_stroke_opacity:i,u_stroke_width:s,u_blur:g};return this.getUniformsBufferInfo(y)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.layer.triangulation=P2,[yield i.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:fx,fragmentShader:ux,triangulation:P2,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!0},blend:i.getBlend()})]})()}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:In.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g)=>{const[y,_,O]=f,A=Ir.al(0,0,1),P=Ir.al(y,0,O),B=y>=0?Ir.EU(A,P):Math.PI*2-Ir.EU(A,P),U=Math.PI*2-Math.asin(_/100),G=Er.create();Er.rotateY(G,G,B),Er.rotateX(G,G,U);const vt=Ir.al(1,1,0);Ir.fF(vt,vt,G),Ir.Fv(vt,vt);const $t=Ir.al(-1,1,0);Ir.fF($t,$t,G),Ir.Fv($t,$t);const te=Ir.al(-1,-1,0);Ir.fF(te,te,G),Ir.Fv(te,te);const Te=Ir.al(1,-1,0);Ir.fF(Te,Te,G),Ir.Fv(Te,Te);const Fe=[...vt,...$t,...te,...Te],Ze=g%4*3;return[Fe[Ze],Fe[Ze+1],Fe[Ze+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:In.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{shape:s=2}=i;return[this.layer.getLayerConfig().shape2d.indexOf(s)]}}})}}const hx=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,aC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class px extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"meter2coord",1),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"isMeter",!1),(0,ut.Z)(this,"radian",0),(0,ut.Z)(this,"updateTexture",()=>{const{createTexture2D:s}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=s({data:this.iconService.getCanvas(),mag:at.LINEAR,min:at.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:i=0,heightfixed:s=!1,unit:f="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var g;(g=this.texture)===null||g===void 0||g.bind()}const y={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(s),u_raisingHeight:Number(i),u_size_unit:jg[f]};return this.getUniformsBufferInfo(y)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),nc)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.iconService.on("imageUpdate",i.updateTexture),i.updateTexture(),i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:aC,fragmentShader:hx,triangulation:nc,depth:{enable:!1},defines:i.getDefines(),inject:i.getInject(),cull:{enable:!0,face:at.FRONT}})]})()}clearModels(){var i;this.iconService.off("imageUpdate",this.updateTexture),(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:i=>{const s=this.iconService.getIconMap(),{shape:f}=i,{x:g,y}=s[f]||{x:-64,y:-64};return[g,y]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:In.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g)=>{const y=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],_=g%4*3;return[y[_],y[_+1],y[_+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}const nh=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,gx=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class vx extends Vr{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:i,speed:s=1,unit:f="pixel"}=this.layer.getLayerConfig(),g={u_additive:i==="additive"?1:0,u_size_unit:jg[f],u_speed:s,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(g)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),nc)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:gx,fragmentShader:nh,triangulation:nc,defines:i.getDefines(),inject:i.getInject(),depth:{enable:!1}})]})()}animateOption2Array(i){return[i.enable?0:1,i.speed||1,i.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:In.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:3,update:(i,s,f,g)=>{const y=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],_=g%4*3;return[y[_],y[_+1],y[_+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:In.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:1,update:i=>{const{size:s=5}=i;return Array.isArray(s)?[s[0]]:[s]}}})}}var mx={fillImage:px,fill:ol,radar:vx,image:ps,normal:qd,simplePoint:sx,extrude:za,text:Ua,earthFill:dx,earthExtrude:eh};class rh extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","PointLayer"),(0,ut.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,ut.Z)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,ut.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel&&i.layerModel.clearModels(),i.layerModel=new mx[s](i),yield i.initLayerModels()})()}rebuildModels(){var i=this;return(0,nn.Z)(function*(){yield i.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:i,values:s}=this.shapeOption,{shape2d:f}=this.getLayerConfig(),g=this.iconService.getIconMap();if(i&&(f==null?void 0:f.indexOf(i))!==-1)return"fill";if(s==="text")return"text";if(s&&s instanceof Array){for(const y of s)if(typeof y=="string"&&g.hasOwnProperty(y))return"image"}}return"normal"}getDefaultConfig(){const i=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[i]}getModelType(){const i=this.getEncodedData(),{shape2d:s,shape3d:f,billboard:g=!0}=this.getLayerConfig(),y=this.iconService.getIconMap(),_=i.find(O=>O.hasOwnProperty("shape"));if(_){const O=_.shape;return O==="dot"?"normal":O==="simple"?"simplePoint":O==="radar"?"radar":this.layerType==="fillImage"||g===!1?"fillImage":(s==null?void 0:s.indexOf(O))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(f==null?void 0:f.indexOf(O))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":y.hasOwnProperty(O)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function yx(a){return a==="PolygonLayer"?po:a==="LineLayer"?il:rh}function cC(a){return["PolygonLayer","LineLayer"].indexOf(a)!==-1}class ac extends no.EventEmitter{constructor(i,s){super(),(0,ut.Z)(this,"x",void 0),(0,ut.Z)(this,"y",void 0),(0,ut.Z)(this,"z",void 0),(0,ut.Z)(this,"key",void 0),(0,ut.Z)(this,"parent",void 0),(0,ut.Z)(this,"sourceTile",void 0),(0,ut.Z)(this,"visible",!0),(0,ut.Z)(this,"layers",[]),(0,ut.Z)(this,"isLoaded",!1),(0,ut.Z)(this,"tileMaskLayers",[]),(0,ut.Z)(this,"tileMask",void 0),this.parent=s,this.sourceTile=i,this.x=i.x,this.y=i.y,this.z=i.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...i){}lnglatInBounds(i){const[s,f,g,y]=this.sourceTile.bounds,{lng:_,lat:O}=i;return _>=s&&_<=g&&O>=f&&O<=y}getLayerOptions(){var i;const s=this.parent.getLayerConfig();return(0,Je.Z)((0,Je.Z)({},s),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:cC(this.parent.type),mask:s.mask||((i=s.maskLayers)===null||i===void 0?void 0:i.length)!==0&&s.enableMask})}getMaskLayer(){const{maskLayers:i}=this.parent.getLayerConfig(),s=[];return i==null||i.forEach(f=>{if(!f.tileLayer)return s.push(f),f;const y=f.tileLayer.getTile(this.sourceTile.key),_=y==null?void 0:y.getLayers()[0];_&&s.push(_)}),s}addTileMask(){var i=this;return(0,nn.Z)(function*(){const s=new po({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[i.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),f=lu(i.parent.container);s.setContainer(f),yield s.init(),i.tileMask=s;const g=i.getMainLayer();return g!==void 0&&(g.tileMask=s),s})()}addMask(i,s){var f=this;return(0,nn.Z)(function*(){const g=lu(f.parent.container);s.setContainer(g),yield s.init(),i.addMask(s),f.tileMaskLayers.push(s)})()}addLayer(i){var s=this;return(0,nn.Z)(function*(){i.isTileLayer=!0;const f=lu(s.parent.container);i.setContainer(f),s.layers.push(i),yield i.init()})()}updateVisible(i){this.visible=i,this.updateOptions("visible",i)}updateOptions(i,s){this.layers.forEach(f=>{f.updateLayerConfig({[i]:s})})}getMainLayer(){return this.layers[0]}getFeatures(i){return[]}getFeatureById(i){return[]}destroy(){var i;(i=this.tileMask)===null||i===void 0||i.destroy(),this.layers.forEach(s=>s.destroy())}}class bx extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.getSourceOption(),f=s.data.features[0].properties,g=new il().source(s.data,s.options).size(1).shape("line").color("red"),y=new rh({minZoom:i.z-1,maxZoom:i.z+1,textAllowOverlap:!0}).source([f],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(i.key).style({stroke:"#fff",strokeWidth:2});yield i.addLayer(g),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:i.transforms}}}}const _x=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,ov=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class xx extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:i,brightness:s,contrast:f,saturation:g,gamma:y}=this.layer.getLayerConfig(),_={u_opacity:Ml(i,1),u_brightness:Ml(s,1),u_contrast:Ml(f,1),u_saturation:Ml(g,1),u_gamma:Ml(y,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(_)}initModels(){var i=this;return(0,nn.Z)(function*(){return yield i.loadTexture(),i.buildModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}loadTexture(){var i=this;return(0,nn.Z)(function*(){const{createTexture2D:s}=i.rendererService,g=yield i.layer.getSource().data.images;i.texture=s({data:g[0],width:g[0].width,height:g[0].height,mag:at.LINEAR,min:at.LINEAR})})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:ov,fragmentShader:_x,defines:i.getDefines(),triangulation:Gd,primitive:at.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}var lC={image:xx};class Sx extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","ImageLayer")}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel=new lC[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{image:{}}[i]}getModelType(){return"image"}}class uC extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=i.getSourceOption(),y=new Sx((0,Je.Z)({},f)).source(g.data,g.options);s&&Object.keys(s).forEach(_=>{var O,A;const P=_;y[P]((O=s[P])===null||O===void 0?void 0:O.field,(A=s[P])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}const Ox=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,cr=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Ex extends Vr{getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,color:s="#000"}=this.layer.getLayerConfig(),f={u_color:Lr(s),u_opacity:i||1};return this.getUniformsBufferInfo(f)}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initUniformsBuffer(),[yield i.layer.buildLayerModel({moduleName:"mask",vertexShader:cr,fragmentShader:Ox,defines:i.getDefines(),triangulation:Wu,depth:{enable:!1},pick:!1})]})()}clearModels(i=!0){i&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var Ax={fill:Ex};class av extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","MaskLayer")}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel=new Ax[s](i),yield i.initLayerModels()})()}getModelType(){return"fill"}}class Tx extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=i.getSourceOption(),y=new av((0,Je.Z)({},f)).source(g.data,g.options);s&&Object.keys(s).forEach(_=>{var O,A;const P=_;y[P]((O=s[P])===null||O===void 0?void 0:O.field,(A=s[P])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getFeatures(i){return i?this.sourceTile.data.getTileData(i):[]}getSourceOption(){const i=this.parent.getSource(),{sourceLayer:s,featureId:f}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(s)},options:{parser:{type:"geojson",featureId:f},transforms:i.transforms}}}}function Cx(a,i){return{type:a.type,field:"value",items:a.positions.map((s,f)=>({[i]:f>=a.colors.length?null:a.colors[f],value:s}))}}const Mx=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,dC=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class sv extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,clampLow:s=!0,clampHigh:f=!0,noDataValue:g=-9999999,domain:y,rampColors:_}=this.layer.getLayerConfig(),O=y||Bh(_);this.colorTexture=this.layer.textureService.getColorTexture(_,O);const A={u_domain:O,u_opacity:i||1,u_noDataValue:g,u_clampLow:s?1:0,u_clampHigh:(typeof f!="undefined"?f:s)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(A)}getRasterData(i){return(0,nn.Z)(function*(){if(Array.isArray(i.data))return{data:i.data,width:i.width,height:i.height};{const{rasterData:s,width:f,height:g}=yield i.data;return{data:Array.from(s),width:f,height:g}}})()}initModels(){var i=this;return(0,nn.Z)(function*(){return i.buildModels()})()}buildModels(){var i=this;return(0,nn.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f,queryVerdorInfo:g}=i.rendererService,y=s.data.dataArray[0],{data:_,width:O,height:A}=yield i.getRasterData(y);return i.texture=f({data:new Float32Array(_),width:O,height:A,format:g()==="WebGL1"?at.LUMINANCE:at.RED,type:at.FLOAT,alignment:1}),[yield i.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:dC,fragmentShader:Mx,defines:i.getDefines(),triangulation:Gd,primitive:at.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var i,s;(i=this.texture)===null||i===void 0||i.destroy(),(s=this.colorTexture)===null||s===void 0||s.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}const cv=["data"],Lx=["rasterData"],Px=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,Ix=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Rx extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0),(0,ut.Z)(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const i=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Je.Z)((0,Je.Z)({},i.uniformsOption),s.uniformsOption)}getCommonUniformsInfo(){const{opacity:i=1,noDataValue:s=0}=this.layer.getLayerConfig(),{rMinMax:f=[0,255],gMinMax:g=[0,255],bMinMax:y=[0,255]}=this.dataOption,_={u_rminmax:f,u_gminmax:g,u_bminmax:y,u_opacity:i||1,u_noDataValue:s,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(_)}getRasterData(i){var s=this;return(0,nn.Z)(function*(){if(Array.isArray(i.data)){const{data:_}=i,O=(0,ia.Z)(i,cv);return s.dataOption=O,(0,Je.Z)({data:_},O)}const f=yield i.data,{rasterData:g}=f,y=(0,ia.Z)(f,Lx);return s.dataOption=y,Array.isArray(g)?(0,Je.Z)({data:g},y):(0,Je.Z)({data:Array.from(g)},y)})()}initModels(){var i=this;return(0,nn.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f}=i.rendererService,g=s.data.dataArray[0],{data:y,width:_,height:O}=yield i.getRasterData(g);return i.texture=f({data:new Float32Array(y),width:_,height:O,format:at.RGB,type:at.FLOAT}),[yield i.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:Ix,fragmentShader:Px,defines:i.getDefines(),triangulation:Gd,primitive:at.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initModels()})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}const kx=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,Dx=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Fx extends Vr{constructor(...i){super(...i),(0,ut.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:i,clampLow:s=!0,clampHigh:f=!0,noDataValue:g=-9999999,domain:y,rampColors:_,colorTexture:O,rScaler:A=6553.6,gScaler:P=25.6,bScaler:B=.1,offset:U=1e4}=this.layer.getLayerConfig(),G=y||Bh(_);let vt=O;O?this.layer.textureService.setColorTexture(O,_,G):vt=this.layer.textureService.getColorTexture(_,G);const $t={u_unpack:[A,P,B,U],u_domain:G,u_opacity:i||1,u_noDataValue:g,u_clampLow:s,u_clampHigh:typeof f!="undefined"?f:s,u_texture:this.texture,u_colorTexture:vt};return this.textures=[this.texture,vt],this.getUniformsBufferInfo($t)}initModels(){var i=this;return(0,nn.Z)(function*(){i.initUniformsBuffer();const s=i.layer.getSource(),{createTexture2D:f}=i.rendererService,g=yield s.data.images;return i.texture=f({data:g[0],width:g[0].width,height:g[0].height,min:at.LINEAR,mag:at.LINEAR}),[yield i.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:Dx,fragmentShader:kx,defines:i.getDefines(),triangulation:Gd,primitive:at.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var i;(i=this.texture)===null||i===void 0||i.destroy()}buildModels(){var i=this;return(0,nn.Z)(function*(){return i.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:In.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:at.DYNAMIC_DRAW,data:[],type:at.FLOAT},size:2,update:(i,s,f)=>[f[3],f[4]]}})}}var Nx={raster:sv,rasterRgb:Rx,raster3d:sv,rasterTerrainRgb:Fx};class ih extends el{constructor(...i){super(...i),(0,ut.Z)(this,"type","RasterLayer")}buildModels(){var i=this;return(0,nn.Z)(function*(){const s=i.getModelType();i.layerModel=new Nx[s](i),yield i.initLayerModels()})()}getDefaultConfig(){const i=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[i]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(i){if(i!=="color")return{type:void 0,field:void 0,items:[]};const s=this.getLayerConfig().rampColors;return Cx(s,i)}}const Bx=["rasterData"];class jx extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=i.getSourceOption(),y=new ih((0,Je.Z)({},f)).source(g.data,g.options);s&&Object.keys(s).forEach(_=>{var O,A;const P=_;y[P]((O=s[P])===null||O===void 0?void 0:O.field,(A=s[P])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource(),s=this.sourceTile.data.data,{rasterData:f}=s,g=(0,ia.Z)(s,Bx);return{data:f,options:{parser:(0,Je.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},g),transforms:i.transforms}}}}class zx extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=i.getSourceOption(),y=new ih((0,Je.Z)({},f)).source(g.data,g.options);s&&Object.keys(s).forEach(_=>{var O,A;const P=_;y[P]((O=s[P])===null||O===void 0?void 0:O.field,(A=s[P])===null||A===void 0?void 0:A.values)}),yield i.addLayer(y),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:i.transforms}}}}const oh=["rasterData"],Ux={positions:[0,1],colors:["#000","#fff"]};class Zx extends ac{constructor(...i){super(...i),(0,ut.Z)(this,"colorTexture",void 0)}initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=i.getSourceOption(),{rampColors:y,domain:_}=i.getLayerOptions();i.colorTexture=i.parent.textureService.getColorTexture(y,_);const O=new ih((0,Je.Z)((0,Je.Z)({},f),{},{colorTexture:i.colorTexture})).source(g.data,g.options);s&&Object.keys(s).forEach(A=>{var P,B;const U=A;O[U]((P=s[U])===null||P===void 0?void 0:P.field,(B=s[U])===null||B===void 0?void 0:B.values)}),yield i.addLayer(O),i.isLoaded=!0})()}getSourceOption(){const i=this.parent.getSource(),s=this.sourceTile.data.data,{rasterData:f}=s,g=(0,ia.Z)(s,oh);return{data:f,options:{parser:(0,Je.Z)({type:"raster",extent:this.sourceTile.bounds},g),transforms:i.transforms}}}styleUpdate(...i){const{rampColors:s=Ux,domain:f}=i;this.colorTexture=this.parent.textureService.getColorTexture(s,f||Bh(s)),this.layers.forEach(g=>g.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(i=>i.destroy())}}class Qu extends ac{initTileLayer(){var i=this;return(0,nn.Z)(function*(){const s=i.parent.getLayerAttributeConfig(),f=i.getLayerOptions(),g=yx(i.parent.type),y=i.getSourceOption();if(!y){i.isLoaded=!0,i.emit("loaded");return}const _=new g((0,Je.Z)({},f)).source(y.data,y.options);Object.keys(s).forEach(O=>{var A,P;const B=O;_[B]((A=s[B])===null||A===void 0?void 0:A.field,(P=s[B])===null||P===void 0?void 0:P.values)}),yield i.addLayer(_),f.tileMask&&(yield i.addTileMask()),i.setLayerMinMaxZoom(_),i.isLoaded=!0,i.emit("loaded")})()}getSourceOption(){const i=this.parent.getSource(),{sourceLayer:s="defaultLayer",featureId:f="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(s)},options:{parser:{type:"geojson",featureId:f},transforms:i.transforms}}}setLayerMinMaxZoom(i){i.getModelType()==="text"&&i.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(i){return this.sourceTile.data.getTileData(i)}getFeatureById(i){const s=this.getMainLayer();return s?s.getSource().data.dataArray.filter(g=>g._id===i):[]}}function Hx(a){switch(a.type){case"PolygonLayer":return Qu;case"LineLayer":return Qu;case"PointLayer":return Qu;case"TileDebugLayer":return bx;case"MaskLayer":return Tx;case"RasterLayer":const{dataType:s}=a.getSource().parser;switch(s){case Wi.RGB:case Wi.CUSTOMRGB:return jx;case Wi.ARRAYBUFFER:case Wi.CUSTOMARRAYBUFFER:return Zx;case Wi.TERRAINRGB:case Wi.CUSTOMTERRAINRGB:return zx;default:return uC}default:return Qu}}const lv=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:pC}=Nr;class gC{constructor(i){(0,ut.Z)(this,"parent",void 0),(0,ut.Z)(this,"tileLayerService",void 0),(0,ut.Z)(this,"mapService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"rendererService",void 0),(0,ut.Z)(this,"pickingService",void 0),(0,ut.Z)(this,"tilePickService",void 0),(0,ut.Z)(this,"tilesetManager",void 0),(0,ut.Z)(this,"initedTileset",!1),(0,ut.Z)(this,"lastViewStates",void 0),(0,ut.Z)(this,"mapchange",()=>{var f;if(this.parent.isVisible()===!1)return;const{latLonBounds:g,zoom:y}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===y&&this.lastViewStates.latLonBounds.toString()===g.toString()||(this.lastViewStates={zoom:y,latLonBounds:g},(f=this.tilesetManager)===null||f===void 0||f.throttleUpdate(y,g))}),(0,ut.Z)(this,"viewchange",pC(this.mapchange,24)),this.parent=i;const s=this.parent.getContainer();this.rendererService=s.rendererService,this.layerService=s.layerService,this.mapService=s.mapService,this.pickingService=s.pickingService,this.tileLayerService=new ix({rendererService:this.rendererService,layerService:this.layerService,parent:i}),this.tilePickService=new ox({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:i}),this.parent.setLayerPickService(this.tilePickService),this.proxy(i),this.initTileSetManager()}initTileSetManager(){var i;const s=this.parent.getSource();if(this.tilesetManager=s.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:f,zoom:g}=this.getCurrentView();(i=this.tilesetManager)===null||i===void 0||i.update(g,f)}getCurrentView(){const i=this.mapService.getBounds(),s=[i[0][0],i[0][1],i[1][0],i[1][1]],f=this.mapService.getZoom();return{latLonBounds:s,zoom:f}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",i=>{}),this.tilesetManager.on("tile-unload",i=>{this.tileUnLoad(i)}),this.tilesetManager.on("tile-error",(i,s)=>{this.tileError(i)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(i){return this.tileLayerService.getTile(i)}tileLoaded(i){}tileError(i){console.warn("error:",i)}destroy(){var i;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(i=this.tilesetManager)===null||i===void 0||i.destroy(),this.tileLayerService.destroy()}reload(){var i;this.tilesetManager.clear();const{latLonBounds:s,zoom:f}=this.getCurrentView();(i=this.tilesetManager)===null||i===void 0||i.update(f,s)}tileUnLoad(i){this.tileLayerService.removeTile(i.key)}tileUpdate(){var i=this;return(0,nn.Z)(function*(){if(!i.tilesetManager)return;const s=i.parent.getMinZoom(),f=i.parent.getMaxZoom(),g=i.tilesetManager.tiles.filter(y=>y.isLoaded).filter(y=>y.isVisibleChange).filter(y=>y.data).filter(y=>y.z>=s&&y.z<f);yield Promise.all(g.map(function(){var y=(0,nn.Z)(function*(_){if(i.tileLayerService.hasTile(_.key))i.tileLayerService.updateTileVisible(_),i.tilePickService.setPickState(),i.layerService.reRender();else{const O=Hx(i.parent),A=new O(_,i.parent);yield A.initTileLayer(),i.tilePickService.setPickState(),A.getLayers().length!==0&&(i.tileLayerService.addTile(A),i.tileLayerService.updateTileVisible(_),i.layerService.reRender())}});return function(_){return y.apply(this,arguments)}}())),i.tilesetManager.isLoaded&&i.parent.emit("tiles-loaded",i.tilesetManager.currentTiles)})()}setPickState(i){}pickRender(i){this.tilePickService.pickRender(i)}selectFeature(i){this.tilePickService.selectFeature(i)}highlightPickedFeature(i){this.tilePickService.highlightPickedFeature(i)}proxy(i){lv.forEach(s=>{const f=i[s].bind(i);i[s]=(...g)=>(f(...g),this.getLayers().map(y=>{y[s](...g)}),s==="style"&&this.getTiles().forEach(y=>y.styleUpdate(...g)),i)})}}class z6 extends null{constructor(...i){super(...i),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",s=>{switch(s.stopPropagation(),s.type){case"touchcancel":case"touchend":case"mouseup":{var f;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(g=>{document.removeEventListener(g,this.move)}),(f=this.scene)===null||f===void 0||f.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(g=>{document.addEventListener(g,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let g;if("pageX"in s?g=s.pageX:s.touches&&s.touches.length&&s.touches[0].pageX?g=s.touches[0].pageX:s.changedTouches&&s.changedTouches.length&&(g=s.changedTouches[0].pageX),!g)break;const y=this.getContainerDOMRect(),_=this.getContainerSize(),O=_[0],A=(y==null?void 0:y.left)||0,P=g-A+window.scrollX-document.documentElement.clientLeft,B=O-Math.min(Math.max(0,O-P),O),U=B/O;this.setOptions({ratio:U}),this.emit("moving",{size:[B,_[1]],ratio:[U,0]})}else{let g;if("pageY"in s?g=s.pageY:s.touches&&s.touches.length&&s.touches[0].pageY?g=s.touches[0].pageY:s.changedTouches&&s.changedTouches.length&&(g=s.changedTouches[0].pageY),!g)break;const y=this.getContainerDOMRect(),_=this.getContainerSize(),O=_[1],A=(y==null?void 0:y.top)||0,P=g-A+window.scrollY-document.documentElement.clientTop,B=O-Math.min(Math.max(0,O-P),O),U=B/O;this.setOptions({ratio:U}),this.emit("moving",{size:[_[0],B],ratio:[0,U]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var s;if(!this.mapsService)return;const f=this.getMaskGeoData();(s=this.maskLayer)===null||s===void 0||s.setData(f)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const i=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",i);const{orientation:s="vertical",ratio:f=.5}=this.controlOption;return s==="horizontal"?(i.style.top=f*100+"%",i.style.left=""):(i.style.left=f*100+"%",i.style.top=""),i.classList.add(s),i}addTo(i){this.mapsService=i.mapService,this.renderService=i.rendererService,this.layerService=i.layerService,this.controlService=i.controlService,this.configService=i.globalConfigService,this.scene=i.sceneService,this.sceneContainer=i,this.isShow=!0,this.container=this.onAdd();const{className:s,style:f,layers:g,rightLayers:y}=this.controlOption;s&&this.setClassName(s),f&&this.setStyle(f),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const _=createLayerContainer(i);return this.maskLayer.setContainer(_),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(g,!1),this.addMaskToLayers(y,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var i;const{layers:s,rightLayers:f}=this.controlOption;this.removeMaskFromLayers(s),this.removeMaskFromLayers(f),(i=this.layerService)===null||i===void 0||i.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var i;const s=this.container;DOM.removeClass(s,"l7-control-swipe_hide");const{layers:f,rightLayers:g}=this.controlOption;f.forEach(y=>y.enableMask()),g.forEach(y=>y.enableMask()),(i=this.scene)===null||i===void 0||i.render(),this.isShow=!0,this.emit("show",this)}hide(){var i;const s=this.container;DOM.addClass(s,"l7-control-swipe_hide");const{layers:f,rightLayers:g}=this.controlOption;f.forEach(y=>y.disableMask()),g.forEach(y=>y.disableMask()),(i=this.scene)===null||i===void 0||i.render(),this.isShow=!1,this.emit("hide",this)}setOptions(i){const s=_objectSpread(_objectSpread({},this.controlOption),i);if(i.className&&this.setClassName(i.className),i.style&&this.setStyle(i.style),(i.orientation||i.ratio!==void 0)&&this.setOrientationAndRatio(s.orientation,s.ratio),i.layers){const f=i.layers,g=this.controlOption.layers;this.setLayers(f,g,!1)}if(i.rightLayers){const f=i.rightLayers,g=this.controlOption.rightLayers;this.setLayers(f,g,!0)}this.controlOption=s,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var i;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(i=this.mapsService)===null||i===void 0||i.off("camerachange",this.updateMask)}setOrientationAndRatio(i="vertical",s=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(i),i==="horizontal"?(this.container.style.top=s*100+"%",this.container.style.left=""):(this.container.style.left=s*100+"%",this.container.style.top="")}setLayers(i,s,f=!1){const g=i.filter(_=>s.includes(_)===!1),y=s.filter(_=>i.includes(_)===!1);this.addMaskToLayers(g,f),this.removeMaskFromLayers(y)}addMaskToLayers(i,s){i.forEach(f=>{f.updateLayerConfig({maskInside:!s}),f.addMask(this.maskLayer)})}removeMaskFromLayers(i){i.forEach(s=>{s.updateLayerConfig({maskInside:!0}),s.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:i=.5,orientation:s="vertical"}=this.controlOption,f=s==="vertical",[g,y]=this.getBounds(),[_,O]=g,[A,P]=y;let B;if(f){const G=_+(A-_)*i;B=[[_,P],[G,P],[G,O],g,[_,P]]}else{const G=this.getContainerSize(),$t=this.mapsService.containerToLngLat([G[0],G[1]*i]).lat;B=[[_,P],y,[A,$t],[_,$t],[_,P]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[B]}}]}}getContainerDOMRect(){var i;return(i=this.mapsService.getContainer())===null||i===void 0?void 0:i.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(i,s=!1){const f=Array.isArray(i)?i:[i];if(s){const g=this.controlOption.rightLayers.concat(...f);this.setOptions({rightLayers:g})}else{const g=this.controlOption.layers.concat(...f);this.setOptions({layers:g})}}removeLayer(i){const s=Array.isArray(i)?i:[i],f=this.controlOption.layers.filter(y=>s.includes(y)),g=this.controlOption.rightLayers.filter(y=>s.includes(y));this.setOptions({layers:f,rightLayers:g})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class vC extends null{constructor(...i){super(...i),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const s=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||s.getZoom()<=s.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(s.getZoom()))),(this.disabled||s.getZoom()>=s.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(i){return _objectSpread(_objectSpread({},super.getDefault(i)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(i){super.setOptions(i),this.checkUpdateOption(i,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const i=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(i),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),i}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(i){DOM.clearChildren(i),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",i,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",i)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",i,this.zoomOut),this.updateDisabled()}createButton(i,s,f,g,y){const _=DOM.create("button",f,g);return typeof i=="string"?_.innerHTML=i:_.append(i),_.title=s,y&&_.addEventListener("click",y),_}}class Vx extends no.EventEmitter{get lngLat(){var i;return(i=this.popupOption.lngLat)!==null&&i!==void 0?i:{lng:0,lat:0}}set lngLat(i){this.popupOption.lngLat=i}constructor(i){super(),(0,ut.Z)(this,"popupOption",void 0),(0,ut.Z)(this,"mapsService",void 0),(0,ut.Z)(this,"sceneService",void 0),(0,ut.Z)(this,"layerService",void 0),(0,ut.Z)(this,"scene",void 0),(0,ut.Z)(this,"closeButton",void 0),(0,ut.Z)(this,"container",void 0),(0,ut.Z)(this,"content",void 0),(0,ut.Z)(this,"contentTitle",void 0),(0,ut.Z)(this,"contentPanel",void 0),(0,ut.Z)(this,"tip",void 0),(0,ut.Z)(this,"isShow",!0),(0,ut.Z)(this,"onMouseMove",f=>{var g;const y=this.mapsService.getMapContainer(),{left:_=0,top:O=0}=(g=y==null?void 0:y.getBoundingClientRect())!==null&&g!==void 0?g:{};this.setPopupPosition(f.clientX-_,f.clientY-O)}),(0,ut.Z)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:f,lat:g}=this.lngLat,{x:y,y:_}=this.mapsService.lngLatToContainer([f,g]);this.setPopupPosition(y,_)}),(0,ut.Z)(this,"updateLngLatPositionWhenZoom",f=>{if(!this.mapsService||this.popupOption.followCursor)return;const g=f.map,y=g.getSize();y.x=y.x/2,y.y=y.y/2;const _=f.center,O=f.zoom,A=g.DE(this.lngLat,O,_);A.x=Math.round(A.x),A.y=Math.round(A.y),this.setPopupPosition(A.x,A.y,!0)}),(0,ut.Z)(this,"onKeyDown",f=>{f.keyCode===27&&this.remove()}),(0,ut.Z)(this,"onCloseButtonClick",f=>{f.stopPropagation&&f.stopPropagation(),this.hide()}),(0,ut.Z)(this,"updatePosition",(f,g=!0)=>{const y=!!this.lngLat,{className:_,style:O,maxWidth:A,anchor:P,stopPropagation:B}=this.popupOption;if(!this.mapsService||!y||!this.content)return;const U=this.mapsService.getMarkerContainer();if(!this.container&&U&&(this.container=Fi("div",`l7-popup ${_!=null?_:""} ${this.isShow?"":"l7-popup-hide"}`,U),O&&this.container.setAttribute("style",O),this.tip=Fi("div","l7-popup-tip",this.container),this.container.appendChild(this.content),B&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(G=>{this.container.addEventListener(G,vt=>{vt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),g?this.updateLngLatPositionWhenZoom(f):this.updateLngLatPosition(),Yh(this.container,`${Ce[P]}`),Me(this.container,P,"popup"),A){const{width:G}=this.container.getBoundingClientRect();G>parseFloat(A)&&(this.container.style.width=A)}else this.container.style.removeProperty("width")}),(0,ut.Z)(this,"updateWhenZoom",f=>{this.updatePosition(f,!0)}),(0,ut.Z)(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=(0,Je.Z)((0,Je.Z)({},this.getDefault(i!=null?i:{})),i);const{lngLat:s}=this.popupOption;s&&(this.lngLat=s)}getIsShow(){return this.isShow}addTo(i){this.mapsService=i.mapService,this.sceneService=i.sceneService,this.layerService=i.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=i,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:s,text:f,title:g}=this.popupOption;return s?this.setHTML(s):f&&this.setText(f),g&&this.setTitle(g),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&wa(this.content),this.container&&(wa(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(i){this.show();const{className:s}=this.popupOption;if(this.popupOption=(0,Je.Z)((0,Je.Z)({},this.popupOption),i),this.checkUpdateOption(i,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(wa(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(i,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(i,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(i,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(i,["html"])&&i.html?this.setHTML(i.html):this.checkUpdateOption(i,["text"])&&i.text&&this.setText(i.text),this.checkUpdateOption(i,["className"])){var f;s&&this.container.classList.remove(s!=null?s:""),this.container.classList.add((f=i.className)!==null&&f!==void 0?f:"")}if(this.checkUpdateOption(i,["style"])){var g;Gm(this.container,(g=i.style)!==null&&g!==void 0?g:"")}return this.checkUpdateOption(i,["lngLat"])&&i.lngLat&&this.setLnglat(i.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&Sc(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&Co(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(i){return this.popupOption.html=i,this.setDOMContent(i)}setText(i){return this.popupOption.text=i,this.setDOMContent(window.document.createTextNode(i))}setTitle(i){this.show(),this.popupOption.title=i,i?(this.contentTitle||(this.contentTitle=Fi("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),$h(this.contentTitle),$m(this.contentTitle,i)):this.contentTitle&&(wa(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:i,lat:s}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([i,s]),this}setLngLat(i){return this.setLnglat(i)}setLnglat(i){return this.show(),this.lngLat=i,Array.isArray(i)&&(this.lngLat={lng:i[0],lat:i[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(i){return this.popupOption.maxWidth=i,this.update(),this}isOpen(){return!!this.mapsService}getDefault(i){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:de.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(i){return this.show(),this.createContent(),$m(this.contentPanel,i),this.update(),this}updateCloseOnClick(i){const s=this.mapsService;s&&(s==null||s.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!i&&requestAnimationFrame(()=>{s==null||s.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(i){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!i&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(i){var s;const f=(s=this.mapsService)===null||s===void 0?void 0:s.getContainer();f&&(f==null||f.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!i&&(f==null||f.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&wa(this.content),this.contentTitle=void 0,this.content=Fi("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const i=M0("l7-icon-guanbi");Co(i,"l7-popup-close-button"),this.content.appendChild(i),this.popupOption.closeButtonOffsets&&(i.style.right=this.popupOption.closeButtonOffsets[0]+"px",i.style.top=this.popupOption.closeButtonOffsets[1]+"px"),i.setAttribute("aria-label","Close popup"),i.addEventListener("click",()=>{this.hide()}),i.addEventListener("pointerup",s=>{s.stopPropagation()}),i.addEventListener("pointerdown",s=>{s.stopPropagation()}),this.closeButton=i}else this.closeButton=void 0;this.contentPanel=Fi("div","l7-popup-content__panel",this.content)}setPopupPosition(i,s,f=!1){if(this.container){const{offsets:g}=this.popupOption;this.container.style.left=i+g[0]+"px",this.container.style.top=s-g[1]+"px",f?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(i,s){return s.some(f=>f in i)}}const{get:ah}=Nr;class mC extends null{constructor(...i){super(...i),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(s,f)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(s,f.featureId))this.hide();else{const{title:g,content:y}=this.getLayerInfoFrag(s,f);this.setDOMContent(y),this.setLnglat(f.lngLat),this.setTitle(g),this.setDisplayFeatureInfo({layer:s,featureId:f.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var i;const{config:s,items:f}=this.popupOption;return(i=s!=null?s:f)!==null&&i!==void 0?i:[]}addTo(i){return super.addTo(i),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(i){this.unbindLayerEvent();const s=_objectSpread({},i),f=s.trigger||this.popupOption.trigger,g=s.items||this.popupOption.items,y=(g==null?void 0:g.length)===0;s.followCursor=f==="hover"&&!y;const _=this.isShow;return super.setOptions(s),this.bindLayerEvent(),(y||!_)&&this.hide(),this}getDefault(i){const s=i.trigger!=="click";return _objectSpread(_objectSpread({},super.getDefault(i)),{},{trigger:"hover",followCursor:s,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:i,closeOnClick:s}=this.popupOption;this.layerConfigItems.forEach(f=>{var g;const y=this.getLayerByConfig(f);if(!y)return;const _=_objectSpread({},f);if(i==="hover"){const B=this.onLayerMouseMove.bind(this,y),U=this.onLayerMouseOut.bind(this,y);_.onMouseMove=B,_.onMouseOut=U,y==null||y.on("mousemove",B),y==null||y.on("mouseout",U)}else{var O;const B=this.onLayerClick.bind(this,y);_.onClick=B,y==null||y.on("click",B);const U=(O=this.mapsService)===null||O===void 0?void 0:O.getMapContainer();U&&s&&U.addEventListener("click",this.onSceneClick)}const A=y==null||(g=y.getSource)===null||g===void 0?void 0:g.call(y),P=this.onSourceUpdate.bind(this);A==null||A.on("update",P),_.onSourceUpdate=P,this.layerConfigMap.set(y,_)})}unbindLayerEvent(){this.layerConfigItems.forEach(i=>{var s;const f=this.getLayerByConfig(i),g=f&&this.layerConfigMap.get(f);if(!g)return;const{onMouseMove:y,onMouseOut:_,onClick:O,onSourceUpdate:A}=g;if(y&&f.off("mousemove",y),_&&f.off("mouseout",_),O&&f.off("click",O),A){var P;f==null||(P=f.getSource())===null||P===void 0||P.off("update",A)}const B=(s=this.mapsService)===null||s===void 0?void 0:s.getMapContainer();B&&B.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(i,s){if(!this.isSameFeature(i,s.featureId)){const{title:f,content:g}=this.getLayerInfoFrag(i,s);this.setDOMContent(g),this.setTitle(f),this.setDisplayFeatureInfo({layer:i,featureId:s.featureId}),this.show()}}onLayerMouseOut(i,s){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(i,s){const f=this.layerConfigMap.get(i);let g;const y=document.createDocumentFragment();if(f){let _=s.feature;_.type==="Feature"&&"properties"in _&&"geometry"in _&&(_=_.properties);const{title:O,fields:A,customContent:P}=f;if(O){g=document.createDocumentFragment();const B=O instanceof Function?O(_):O;DOM.appendElementType(g,B)}if(P){const B=P instanceof Function?P(_):P;DOM.appendElementType(y,B)}else A!=null&&A.length&&(A==null||A.forEach(B=>{var U,G;const{field:vt,formatField:$t,formatValue:te,getValue:Te}=typeof B=="string"?{field:B}:B,Fe=DOM.create("div","l7-layer-popup__row"),Ze=Te?Te(s.feature):ah(_,vt),je=(U=$t instanceof Function?$t(vt,_):$t)!==null&&U!==void 0?U:vt;let Qe=(G=te instanceof Function?te(Ze,_):te)!==null&&G!==void 0?G:Ze;const ln=DOM.create("span","l7-layer-popup__key",Fe);DOM.appendElementType(ln,je),DOM.appendElementType(ln,document.createTextNode("\uFF1A"));const wn=DOM.create("span","l7-layer-popup__value",Fe);Array.isArray(Qe)&&Qe.every(mn=>!(mn instanceof Object))&&(Qe=Qe.map(mn=>String(mn)).join(",")),DOM.appendElementType(wn,Qe),y.appendChild(Fe)}))}return{title:g,content:y}}getLayerByConfig(i){const s=i.layer;if(s instanceof Object)return s;if(typeof s=="string")return this.layerService.getLayer(s)||this.layerService.getLayerByName(s)}isSameFeature(i,s){const f=this.displayFeatureInfo;return f&&i===f.layer&&s===f.featureId}setDisplayFeatureInfo(i){const s=this.displayFeatureInfo;s&&s.layer.off("hide",this.onLayerHide),i&&i.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=i}}function sh(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var g=i.head||i.getElementsByTagName("head")[0];if(!g){g=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(g,y):i.documentElement.appendChild(g)}var _=i.createElement("style");return _.type="text/css",_.styleSheet?_.styleSheet.cssText=a:_.appendChild(i.createTextNode(a)),g.appendChild(_),_}}sh(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var Wx=k(81550),Gx=k.n(Wx),uv=class{constructor(a,i){const{buffer:s,offset:f,stride:g,normalized:y,size:_,divisor:O}=i;this.buffer=s,this.attribute={buffer:s.get(),offset:f||0,stride:g||0,normalized:y||!1,divisor:O||0},_&&(this.attribute.size=_)}get(){return this.attribute}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},Yx={[at.POINTS]:"points",[at.LINES]:"lines",[at.LINE_LOOP]:"line loop",[at.LINE_STRIP]:"line strip",[at.TRIANGLES]:"triangles",[at.TRIANGLE_FAN]:"triangle fan",[at.TRIANGLE_STRIP]:"triangle strip"},fv={[at.STATIC_DRAW]:"static",[at.DYNAMIC_DRAW]:"dynamic",[at.STREAM_DRAW]:"stream"},Ju={[at.BYTE]:"int8",[at.INT]:"int32",[at.UNSIGNED_BYTE]:"uint8",[at.UNSIGNED_SHORT]:"uint16",[at.UNSIGNED_INT]:"uint32",[at.FLOAT]:"float"},yC={[at.ALPHA]:"alpha",[at.LUMINANCE]:"luminance",[at.LUMINANCE_ALPHA]:"luminance alpha",[at.RGB]:"rgb",[at.RGBA]:"rgba",[at.RGBA4]:"rgba4",[at.RGB5_A1]:"rgb5 a1",[at.RGB565]:"rgb565",[at.DEPTH_COMPONENT]:"depth",[at.DEPTH_STENCIL]:"depth stencil"},bC={[at.DONT_CARE]:"dont care",[at.NICEST]:"nice",[at.FASTEST]:"fast"},$x={[at.NEAREST]:"nearest",[at.LINEAR]:"linear",[at.LINEAR_MIPMAP_LINEAR]:"mipmap",[at.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[at.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[at.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},dv={[at.REPEAT]:"repeat",[at.CLAMP_TO_EDGE]:"clamp",[at.MIRRORED_REPEAT]:"mirror"},$o={[at.NONE]:"none",[at.BROWSER_DEFAULT_WEBGL]:"browser"},Xx={[at.NEVER]:"never",[at.ALWAYS]:"always",[at.LESS]:"less",[at.LEQUAL]:"lequal",[at.GREATER]:"greater",[at.GEQUAL]:"gequal",[at.EQUAL]:"equal",[at.NOTEQUAL]:"notequal"},qx={[at.FUNC_ADD]:"add",[at.MIN_EXT]:"min",[at.MAX_EXT]:"max",[at.FUNC_SUBTRACT]:"subtract",[at.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},tf={[at.ZERO]:"zero",[at.ONE]:"one",[at.SRC_COLOR]:"src color",[at.ONE_MINUS_SRC_COLOR]:"one minus src color",[at.SRC_ALPHA]:"src alpha",[at.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[at.DST_COLOR]:"dst color",[at.ONE_MINUS_DST_COLOR]:"one minus dst color",[at.DST_ALPHA]:"dst alpha",[at.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[at.CONSTANT_COLOR]:"constant color",[at.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[at.CONSTANT_ALPHA]:"constant alpha",[at.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[at.SRC_ALPHA_SATURATE]:"src alpha saturate"},Kx={[at.NEVER]:"never",[at.ALWAYS]:"always",[at.LESS]:"less",[at.LEQUAL]:"lequal",[at.GREATER]:"greater",[at.GEQUAL]:"gequal",[at.EQUAL]:"equal",[at.NOTEQUAL]:"notequal"},sc={[at.ZERO]:"zero",[at.KEEP]:"keep",[at.REPLACE]:"replace",[at.INVERT]:"invert",[at.INCR]:"increment",[at.DECR]:"decrement",[at.INCR_WRAP]:"increment wrap",[at.DECR_WRAP]:"decrement wrap"},Qx={[at.FRONT]:"front",[at.BACK]:"back"},Jx=class{constructor(a,i){this.isDestroyed=!1;const{data:s,usage:f,type:g}=i;this.buffer=a.buffer({data:s,usage:fv[f||at.STATIC_DRAW],type:Ju[g||at.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:i}){this.buffer.subdata(a,i)}},t3=class{constructor(a,i){const{data:s,usage:f,type:g,count:y}=i;this.elements=a.elements({data:s,usage:fv[f||at.STATIC_DRAW],type:Ju[g||at.UNSIGNED_BYTE],count:y})}get(){return this.elements}subData({data:a}){this.elements.subdata(a)}destroy(){}},e3=class{constructor(a,i){const{width:s,height:f,color:g,colors:y}=i,_={width:s,height:f};Array.isArray(y)&&(_.colors=y.map(O=>O.get())),g&&typeof g!="boolean"&&(_.color=g.get()),this.framebuffer=a.framebuffer(_)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:a,height:i}){this.framebuffer.resize(a,i)}},tn=k(75334),n3=Object.defineProperty,hv=Object.defineProperties,r3=Object.getOwnPropertyDescriptors,pv=Object.getOwnPropertySymbols,i3=Object.prototype.hasOwnProperty,o3=Object.prototype.propertyIsEnumerable,gv=(a,i,s)=>i in a?n3(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,fl=(a,i)=>{for(var s in i||(i={}))i3.call(i,s)&&gv(a,s,i[s]);if(pv)for(var s of pv(i))o3.call(i,s)&&gv(a,s,i[s]);return a},_C=(a,i)=>hv(a,r3(i)),{isPlainObject:a3,isTypedArray:s3}=Nr,vv=class{constructor(a,i){this.destroyed=!1,this.uniforms={},this.reGl=a;const{vs:s,fs:f,attributes:g,uniforms:y,primitive:_,count:O,elements:A,depth:P,cull:B,instances:U}=i,G={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:tn.Fp.LOWER_LEFT,clipSpaceNearZ:tn.R$.NEGATIVE_ONE,supportMRT:!1},vt={};this.options=i,y&&(this.uniforms=this.extractUniforms(y),Object.keys(y).forEach(Ze=>{vt[Ze]=a.prop(Ze)}));const $t={};Object.keys(g).forEach(Ze=>{$t[Ze]=g[Ze].get()});const te=e1((0,tn.oX)(G,"frag",f,null,!1)),Te=e1((0,tn.oX)(G,"vert",s,null,!1)),Fe={attributes:$t,frag:te,uniforms:vt,vert:Te,colorMask:a.prop("colorMask"),lineWidth:1,blend:{enable:a.prop("blend.enable"),func:a.prop("blend.func"),equation:a.prop("blend.equation"),color:a.prop("blend.color")},stencil:{enable:a.prop("stencil.enable"),mask:a.prop("stencil.mask"),func:a.prop("stencil.func"),opFront:a.prop("stencil.opFront"),opBack:a.prop("stencil.opBack")},primitive:Yx[_===void 0?at.TRIANGLES:_]};U&&(Fe.instances=U),O?Fe.count=O:A&&(Fe.elements=A.get()),this.initDepthDrawParams({depth:P},Fe),this.initCullDrawParams({cull:B},Fe),this.drawCommand=a(Fe),this.drawParams=Fe}updateAttributesAndElements(a,i){const s={};Object.keys(a).forEach(f=>{s[f]=a[f].get()}),this.drawParams.attributes=s,this.drawParams.elements=i.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(a){const i={};Object.keys(a).forEach(s=>{i[s]=a[s].get()}),this.drawParams.attributes=i,this.drawCommand=this.reGl(this.drawParams)}addUniforms(a){this.uniforms=fl(fl({},this.uniforms),this.extractUniforms(a))}draw(a,i){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const s=fl(fl({},this.uniforms),this.extractUniforms(a.uniforms||{})),f={};Object.keys(s).forEach(g=>{const y=typeof s[g];y==="boolean"||y==="number"||Array.isArray(s[g])||s[g].BYTES_PER_ELEMENT?f[g]=s[g]:f[g]=s[g].get()}),f.blend=i?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(a),f.stencil=this.getStencilDrawParams(a),f.colorMask=this.getColorMaskDrawParams(a,i),this.drawCommand(f)}destroy(){var a,i;(i=(a=this.drawParams)==null?void 0:a.elements)==null||i.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(s=>{s==null||s.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:a},i){a&&(i.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:Xx[a.func||at.LESS],range:a.range||[0,1]})}getBlendDrawParams({blend:a}){const{enable:i,func:s,equation:f,color:g=[0,0,0,0]}=a||{};return{enable:!!i,func:{srcRGB:tf[s&&s.srcRGB||at.SRC_ALPHA],srcAlpha:tf[s&&s.srcAlpha||at.SRC_ALPHA],dstRGB:tf[s&&s.dstRGB||at.ONE_MINUS_SRC_ALPHA],dstAlpha:tf[s&&s.dstAlpha||at.ONE_MINUS_SRC_ALPHA]},equation:{rgb:qx[f&&f.rgb||at.FUNC_ADD],alpha:qx[f&&f.alpha||at.FUNC_ADD]},color:g}}getStencilDrawParams({stencil:a}){const{enable:i,mask:s=-1,func:f={cmp:at.ALWAYS,ref:0,mask:-1},opFront:g={fail:at.KEEP,zfail:at.KEEP,zpass:at.KEEP},opBack:y={fail:at.KEEP,zfail:at.KEEP,zpass:at.KEEP}}=a||{};return{enable:!!i,mask:s,func:_C(fl({},f),{cmp:Kx[f.cmp]}),opFront:{fail:sc[g.fail],zfail:sc[g.zfail],zpass:sc[g.zpass]},opBack:{fail:sc[y.fail],zfail:sc[y.zfail],zpass:sc[y.zpass]}}}getColorMaskDrawParams({stencil:a},i){return a!=null&&a.enable&&a.opFront&&!i?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:a},i){if(a){const{enable:s,face:f=at.BACK}=a;i.cull={enable:!!s,face:Qx[f]}}}extractUniforms(a){const i={};return Object.keys(a).forEach(s=>{this.extractUniformsRecursively(s,a[s],i,"")}),i}extractUniformsRecursively(a,i,s,f){if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||s3(i)||i===""||"resize"in i){s[`${f&&f+"."}${a}`]=i;return}a3(i)&&Object.keys(i).forEach(g=>{this.extractUniformsRecursively(g,i[g],s,`${f&&f+"."}${a}`)}),Array.isArray(i)&&i.forEach((g,y)=>{Object.keys(g).forEach(_=>{this.extractUniformsRecursively(_,g[_],s,`${f&&f+"."}${a}[${y}]`)})})}},xC=class{constructor(a,i){this.isDestroy=!1;const{data:s,type:f=at.UNSIGNED_BYTE,width:g,height:y,flipY:_=!1,format:O=at.RGBA,mipmap:A=!1,wrapS:P=at.CLAMP_TO_EDGE,wrapT:B=at.CLAMP_TO_EDGE,aniso:U=0,alignment:G=1,premultiplyAlpha:vt=!1,mag:$t=at.NEAREST,min:te=at.NEAREST,colorSpace:Te=at.BROWSER_DEFAULT_WEBGL,x:Fe=0,y:Ze=0,copy:je=!1}=i;this.width=g,this.height=y;const Qe={width:g,height:y,type:Ju[f],format:yC[O],wrapS:dv[P],wrapT:dv[B],mag:$x[$t],min:$x[te],alignment:G,flipY:_,colorSpace:$o[Te],premultiplyAlpha:vt,aniso:U,x:Fe,y:Ze,copy:je};s&&(Qe.data=s),typeof A=="number"?Qe.mipmap=bC[A]:typeof A=="boolean"&&(Qe.mipmap=A),this.texture=a.texture(Qe)}get(){return this.texture}update(a={}){this.texture(a)}bind(){this.texture._texture.bind()}resize({width:a,height:i}){this.texture.resize(a,i),this.width=a,this.height=i}getSize(){return[this.width,this.height]}destroy(){var a;this.isDestroy||(a=this.texture)==null||a.destroy(),this.isDestroy=!0}},ch=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),c3=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=a=>new vv(this.gl,a),this.createAttribute=a=>new uv(this.gl,a),this.createBuffer=a=>new Jx(this.gl,a),this.createElements=a=>new t3(this.gl,a),this.createTexture2D=a=>new xC(this.gl,a),this.createFramebuffer=a=>new e3(this.gl,a),this.useFramebuffer=(a,i)=>{this.gl({framebuffer:a?a.get():null})(i)},this.useFramebufferAsync=(a,i)=>ch(this,null,function*(){this.gl({framebuffer:a?a.get():null})(i)}),this.clear=a=>{var i;const{color:s,depth:f,stencil:g,framebuffer:y=null}=a,_={color:s,depth:f,stencil:g};_.framebuffer=y===null?y:y.get(),(i=this.gl)==null||i.clear(_)},this.viewport=({x:a,y:i,width:s,height:f})=>{this.gl._gl.viewport(a,i,s,f),this.width=s,this.height=f,this.gl._refresh()},this.readPixels=a=>{const{framebuffer:i,x:s,y:f,width:g,height:y}=a,_={x:s,y:f,width:g,height:y};return i&&(_.framebuffer=i.get()),this.gl.read(_)},this.readPixelsAsync=a=>ch(this,null,function*(){return this.readPixels(a)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var a,i,s;this.canvas=null,(s=(i=(a=this.gl)==null?void 0:a._gl)==null?void 0:i.getExtension("WEBGL_lose_context"))==null||s.loseContext(),this.gl.destroy(),this.gl=null}}init(a,i,s){return ch(this,null,function*(){this.canvas=a,s?this.gl=s:this.gl=yield new Promise((f,g)=>{Gx()({canvas:this.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,stencil:i.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(y,_)=>{(y||!_)&&g(y),f(_)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const a=this.getGLContext();a.disable(a.CULL_FACE)}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},l3=class{constructor(a,i){const{buffer:s,offset:f,stride:g,normalized:y,size:_,divisor:O,shaderLocation:A}=i;this.buffer=s,this.attribute={shaderLocation:A,buffer:s.get(),offset:f||0,stride:g||0,normalized:y||!1,divisor:O||0},_&&(this.attribute.size=_)}get(){return this.buffer}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},lh={[at.FLOAT]:Float32Array,[at.UNSIGNED_BYTE]:Uint8Array,[at.SHORT]:Int16Array,[at.UNSIGNED_SHORT]:Uint16Array,[at.INT]:Int32Array,[at.UNSIGNED_INT]:Uint32Array},SC={[at.POINTS]:tn.YV.POINTS,[at.LINES]:tn.YV.LINES,[at.LINE_LOOP]:tn.YV.LINES,[at.LINE_STRIP]:tn.YV.LINE_STRIP,[at.TRIANGLES]:tn.YV.TRIANGLES,[at.TRIANGLE_FAN]:tn.YV.TRIANGLES,[at.TRIANGLE_STRIP]:tn.YV.TRIANGLE_STRIP},u3={1:tn.ED.F32_R,2:tn.ED.F32_RG,3:tn.ED.F32_RGB,4:tn.ED.F32_RGBA},f3={[at.STATIC_DRAW]:tn.MP.STATIC,[at.DYNAMIC_DRAW]:tn.MP.DYNAMIC,[at.STREAM_DRAW]:tn.MP.DYNAMIC},h3={[at.REPEAT]:tn.OB.REPEAT,[at.CLAMP_TO_EDGE]:tn.OB.CLAMP_TO_EDGE,[at.MIRRORED_REPEAT]:tn.OB.MIRRORED_REPEAT},p3={[at.NEVER]:tn.wb.NEVER,[at.ALWAYS]:tn.wb.ALWAYS,[at.LESS]:tn.wb.LESS,[at.LEQUAL]:tn.wb.LEQUAL,[at.GREATER]:tn.wb.GREATER,[at.GEQUAL]:tn.wb.GEQUAL,[at.EQUAL]:tn.wb.EQUAL,[at.NOTEQUAL]:tn.wb.NOTEQUAL},g3={[at.FRONT]:tn.Wf.FRONT,[at.BACK]:tn.Wf.BACK},mv={[at.FUNC_ADD]:tn.bt.ADD,[at.MIN_EXT]:tn.bt.MIN,[at.MAX_EXT]:tn.bt.MAX,[at.FUNC_SUBTRACT]:tn.bt.SUBSTRACT,[at.FUNC_REVERSE_SUBTRACT]:tn.bt.REVERSE_SUBSTRACT},uh={[at.ZERO]:tn.zi.ZERO,[at.ONE]:tn.zi.ONE,[at.SRC_COLOR]:tn.zi.SRC,[at.ONE_MINUS_SRC_COLOR]:tn.zi.ONE_MINUS_SRC,[at.SRC_ALPHA]:tn.zi.SRC_ALPHA,[at.ONE_MINUS_SRC_ALPHA]:tn.zi.ONE_MINUS_SRC_ALPHA,[at.DST_COLOR]:tn.zi.DST,[at.ONE_MINUS_DST_COLOR]:tn.zi.ONE_MINUS_DST,[at.DST_ALPHA]:tn.zi.DST_ALPHA,[at.ONE_MINUS_DST_ALPHA]:tn.zi.ONE_MINUS_DST_ALPHA,[at.CONSTANT_COLOR]:tn.zi.CONST,[at.ONE_MINUS_CONSTANT_COLOR]:tn.zi.ONE_MINUS_CONSTANT,[at.CONSTANT_ALPHA]:tn.zi.CONST,[at.ONE_MINUS_CONSTANT_ALPHA]:tn.zi.ONE_MINUS_CONSTANT,[at.SRC_ALPHA_SATURATE]:tn.zi.SRC_ALPHA_SATURATE},dl={[at.REPLACE]:tn.Kd.REPLACE,[at.KEEP]:tn.Kd.KEEP,[at.ZERO]:tn.Kd.ZERO,[at.INVERT]:tn.Kd.INVERT,[at.INCR]:tn.Kd.INCREMENT_CLAMP,[at.DECR]:tn.Kd.DECREMENT_CLAMP,[at.INCR_WRAP]:tn.Kd.INCREMENT_WRAP,[at.DECR_WRAP]:tn.Kd.DECREMENT_WRAP},v3={[at.ALWAYS]:tn.wb.ALWAYS,[at.EQUAL]:tn.wb.EQUAL,[at.GEQUAL]:tn.wb.GEQUAL,[at.GREATER]:tn.wb.GREATER,[at.LEQUAL]:tn.wb.LEQUAL,[at.LESS]:tn.wb.LESS,[at.NEVER]:tn.wb.NEVER,[at.NOTEQUAL]:tn.wb.NOTEQUAL},OC={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function fh(a){return Object.prototype.toString.call(a)in OC}function m3(a,i){const s=a.length,f=Math.ceil(s/3),g=s+f,y=new Float32Array(g);for(let _=0;_<g;_+=4)y[_]=a[_/4*3],y[_+1]=a[_/4*3+1],y[_+2]=a[_/4*3+2],y[_+3]=i;return y}var y3=class{constructor(a,i){this.isDestroyed=!1;const{data:s,usage:f,type:g,isUBO:y,label:_}=i;let O;fh(s)?O=s:O=new lh[this.type||at.FLOAT](s),this.type=g,this.size=O.byteLength,this.buffer=a.createBuffer({viewOrSize:O,usage:y?tn.FB.UNIFORM:tn.FB.VERTEX,hint:f3[f||at.STATIC_DRAW]}),_&&a.setResourceName(this.buffer,_)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:i}){let s;fh(a)?s=a:s=new lh[this.type||at.FLOAT](a),this.buffer.setSubData(i,new Uint8Array(s.buffer))}};function br(a,i=0){return a+=i,a+=a<<10,a+=a>>>6,a>>>0}function yv(a){return a+=a<<3,a^=a>>>11,a+=a<<15,a>>>0}function bv(){return 0}var b3=class{constructor(){this.keys=[],this.values=[]}},dh=class{constructor(a,i){this.keyEqualFunc=a,this.keyHashFunc=i,this.buckets=new Map}findBucketIndex(a,i){for(let s=0;s<a.keys.length;s++)if(this.keyEqualFunc(i,a.keys[s]))return s;return-1}findBucket(a){const i=this.keyHashFunc(a);return this.buckets.get(i)}get(a){const i=this.findBucket(a);if(i===void 0)return null;const s=this.findBucketIndex(i,a);return s<0?null:i.values[s]}add(a,i){const s=this.keyHashFunc(a);this.buckets.get(s)===void 0&&this.buckets.set(s,new b3);const f=this.buckets.get(s);f.keys.push(a),f.values.push(i)}delete(a){const i=this.findBucket(a);if(i===void 0)return;const s=this.findBucketIndex(i,a);s!==-1&&(i.keys.splice(s,1),i.values.splice(s,1))}clear(){this.buckets.clear()}size(){let a=0;for(const i of this.buckets.values())a+=i.values.length;return a}*values(){for(const a of this.buckets.values())for(let i=a.values.length-1;i>=0;i--)yield a.values[i]}};function _3(a,i){return a=br(a,i.blendMode),a=br(a,i.blendSrcFactor),a=br(a,i.blendDstFactor),a}function EC(a,i){return a=_3(a,i.rgbBlendState),a=_3(a,i.alphaBlendState),a=br(a,i.channelWriteMask),a}function _v(a,i){return a=br(a,i.r<<24|i.g<<16|i.b<<8|i.a),a}function x3(a,i){var s,f,g,y,_,O,A,P;for(let B=0;B<i.attachmentsState.length;B++)a=EC(a,i.attachmentsState[B]);return a=_v(a,i.blendConstant||tn.Ab),a=br(a,i.depthCompare),a=br(a,i.depthWrite?1:0),a=br(a,(s=i.stencilFront)==null?void 0:s.compare),a=br(a,(f=i.stencilFront)==null?void 0:f.passOp),a=br(a,(g=i.stencilFront)==null?void 0:g.failOp),a=br(a,(y=i.stencilFront)==null?void 0:y.depthFailOp),a=br(a,(_=i.stencilBack)==null?void 0:_.compare),a=br(a,(O=i.stencilBack)==null?void 0:O.passOp),a=br(a,(A=i.stencilBack)==null?void 0:A.failOp),a=br(a,(P=i.stencilBack)==null?void 0:P.depthFailOp),a=br(a,i.stencilWrite?1:0),a=br(a,i.cullMode),a=br(a,i.frontFace?1:0),a=br(a,i.polygonOffset?1:0),a}function S3(a){let i=0;i=br(i,a.program.id),a.inputLayout!==null&&(i=br(i,a.inputLayout.id)),i=x3(i,a.megaStateDescriptor);for(let s=0;s<a.colorAttachmentFormats.length;s++)i=br(i,a.colorAttachmentFormats[s]||0);return i=br(i,a.depthStencilAttachmentFormat||0),yv(i)}function O3(a){let i=0;if(a.samplerBindings)for(let s=0;s<a.samplerBindings.length;s++){const f=a.samplerBindings[s];f!==null&&f.texture!==null&&(i=br(i,f.texture.id))}if(a.uniformBufferBindings)for(let s=0;s<a.uniformBufferBindings.length;s++){const f=a.uniformBufferBindings[s];f!==null&&f.buffer!==null&&(i=br(i,f.buffer.id),i=br(i,f.binding),i=br(i,f.offset),i=br(i,f.size))}if(a.storageBufferBindings)for(let s=0;s<a.storageBufferBindings.length;s++){const f=a.storageBufferBindings[s];f!==null&&f.buffer!==null&&(i=br(i,f.buffer.id),i=br(i,f.binding),i=br(i,f.offset),i=br(i,f.size))}if(a.storageTextureBindings)for(let s=0;s<a.storageTextureBindings.length;s++){const f=a.storageTextureBindings[s];f!==null&&f.texture!==null&&(i=br(i,f.texture.id),i=br(i,f.binding))}return yv(i)}function E3(a,i){var s,f,g,y;return((s=a.vertex)==null?void 0:s.glsl)===((f=i.vertex)==null?void 0:f.glsl)&&((g=a.fragment)==null?void 0:g.glsl)===((y=i.fragment)==null?void 0:y.glsl)}function w3(a){var i,s;return{vertex:{glsl:(i=a.vertex)==null?void 0:i.glsl},fragment:{glsl:(s=a.fragment)==null?void 0:s.glsl}}}var A3=class{constructor(a){this.device=a,this.bindingsCache=new dh(tn.PU,O3),this.renderPipelinesCache=new dh(tn.zC,S3),this.inputLayoutsCache=new dh(tn.F3,bv),this.programCache=new dh(E3,bv)}createBindings(a){var i;let s=this.bindingsCache.get(a);if(s===null){const f=(0,tn.LJ)(a);f.uniformBufferBindings=(i=f.uniformBufferBindings)==null?void 0:i.filter(({size:g})=>g&&g>0),s=this.device.createBindings(f),this.bindingsCache.add(f,s)}return s}createRenderPipeline(a){let i=this.renderPipelinesCache.get(a);if(i===null){const s=(0,tn.yA)(a);s.colorAttachmentFormats=s.colorAttachmentFormats.filter(f=>f),i=this.device.createRenderPipeline(s),this.renderPipelinesCache.add(s,i)}return i}createInputLayout(a){a.vertexBufferDescriptors=a.vertexBufferDescriptors.filter(s=>!!s);let i=this.inputLayoutsCache.get(a);if(i===null){const s=(0,tn.Id)(a);i=this.device.createInputLayout(s),this.inputLayoutsCache.add(s,i)}return i}createProgram(a){let i=this.programCache.get(a);if(i===null){const s=w3(a);i=this.device.createProgram(a),this.programCache.add(s,i)}return i}destroy(){for(const a of this.bindingsCache.values())a.destroy();for(const a of this.renderPipelinesCache.values())a.destroy();for(const a of this.inputLayoutsCache.values())a.destroy();for(const a of this.programCache.values())a.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},T3=class{constructor(a,i){const{data:s,type:f,count:g=0}=i;let y;fh(s)?y=s:y=new lh[this.type||at.UNSIGNED_INT](s),this.type=f,this.count=g,this.indexBuffer=a.createBuffer({viewOrSize:y,usage:tn.FB.INDEX})}get(){return this.indexBuffer}subData({data:a}){let i;fh(a)?i=a:i=new lh[this.type||at.UNSIGNED_INT](a),this.indexBuffer.setSubData(0,new Uint8Array(i.buffer))}destroy(){this.indexBuffer.destroy()}};function C3(a){return!!(a&&a.texture)}var M3=class{constructor(a,i){this.device=a,this.options=i,this.isDestroy=!1;const{wrapS:s=at.CLAMP_TO_EDGE,wrapT:f=at.CLAMP_TO_EDGE,aniso:g,mag:y=at.NEAREST,min:_=at.NEAREST}=i;this.createTexture(i),this.sampler=a.createSampler({addressModeU:h3[s],addressModeV:h3[f],minFilter:_===at.NEAREST?tn.X9.POINT:tn.X9.BILINEAR,magFilter:y===at.NEAREST?tn.X9.POINT:tn.X9.BILINEAR,mipmapFilter:tn.f$.NO_MIP,maxAnisotropy:g})}createTexture(a){const{type:i=at.UNSIGNED_BYTE,width:s,height:f,flipY:g=!1,format:y=at.RGBA,alignment:_=1,usage:O=es.SAMPLED,unorm:A=!1,label:P}=a;let{data:B}=a;this.width=s,this.height=f;let U=tn.ED.U8_RGBA_RT;if(i===at.UNSIGNED_BYTE&&y===at.RGBA)U=A?tn.ED.U8_RGBA_NORM:tn.ED.U8_RGBA_RT;else if(i===at.UNSIGNED_BYTE&&y===at.LUMINANCE)U=tn.ED.U8_LUMINANCE;else if(i===at.FLOAT&&y===at.LUMINANCE)U=tn.ED.F32_LUMINANCE;else if(i===at.FLOAT&&y===at.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(B&&(B=m3(B,0)),U=tn.ED.F32_RGBA):U=tn.ED.F32_RGB;else if(i===at.FLOAT&&y===at.RGBA)U=tn.ED.F32_RGBA;else if(i===at.FLOAT&&y===at.RED)U=tn.ED.F32_R;else throw new Error(`create texture error, type: ${i}, format: ${y}`);this.texture=this.device.createTexture({format:U,width:s,height:f,usage:O===es.SAMPLED?tn.v2.SAMPLED:tn.v2.RENDER_TARGET,pixelStore:{unpackFlipY:g,packAlignment:_},mipLevelCount:1}),P&&this.device.setResourceName(this.texture,P),B&&this.texture.setImageData([B])}get(){return this.texture}update(a){const{data:i}=a;this.texture.setImageData([i])}bind(){}resize({width:a,height:i}){(this.width!==a||this.height!==i)&&this.destroy(),this.options.width=a,this.options.height=i,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var a;!this.isDestroy&&!this.texture.destroyed&&((a=this.texture)==null||a.destroy()),this.isDestroy=!0}},L3=class{constructor(a,i){this.device=a,this.options=i,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(a=!1){const{width:i,height:s,color:f}=this.options;f&&(C3(f)?(a&&f.resize({width:i,height:s}),this.colorTexture=f.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=f.width,this.height=f.height):i&&s&&(this.colorTexture=this.device.createTexture({format:tn.ED.U8_RGBA_RT,usage:tn.v2.RENDER_TARGET,width:i,height:s}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=i,this.height=s))}createDepthRenderTarget(a=!1){const{width:i,height:s,depth:f}=this.options;f&&(C3(f)?(a&&f.resize({width:i,height:s}),this.depthTexture=f.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=f.width,this.height=f.height):i&&s&&(this.depthTexture=this.device.createTexture({format:tn.ED.D24_S8,usage:tn.v2.RENDER_TARGET,width:i,height:s}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=i,this.height=s))}get(){return this.colorRenderTarget}destroy(){var a,i;(a=this.colorRenderTarget)==null||a.destroy(),(i=this.depthRenderTarget)==null||i.destroy()}resize({width:a,height:i}){(this.width!==a||this.height!==i)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=a,this.options.height=i,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},P3=Object.defineProperty,I3=Object.defineProperties,R3=Object.getOwnPropertyDescriptors,xv=Object.getOwnPropertySymbols,Sv=Object.prototype.hasOwnProperty,k3=Object.prototype.propertyIsEnumerable,Ov=(a,i,s)=>i in a?P3(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,gs=(a,i)=>{for(var s in i||(i={}))Sv.call(i,s)&&Ov(a,s,i[s]);if(xv)for(var s of xv(i))k3.call(i,s)&&Ov(a,s,i[s]);return a},D3=(a,i)=>I3(a,R3(i)),{isPlainObject:F3,isTypedArray:N3,isNil:Ev}=Nr,B3=class{constructor(a,i,s){this.device=a,this.options=i,this.service=s,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:f,fs:g,attributes:y,uniforms:_,count:O,elements:A,diagnosticDerivativeUniformityEnabled:P}=i;this.options=i;const B=P?"":this.service.viewportOrigin===tn.Fp.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=s.renderCache.createProgram({vertex:{glsl:f},fragment:{glsl:g,postprocess:$t=>B+$t}}),_&&(this.uniforms=this.extractUniforms(_));const U=[];let G=0;Object.keys(y).forEach($t=>{const te=y[$t],Te=te.get();this.vertexBuffers.push(Te.get());const{offset:Fe=0,stride:Ze=0,size:je=1,divisor:Qe=0,shaderLocation:ln=0}=te.attribute;U.push({arrayStride:Ze||je*4,stepMode:tn.Kz.VERTEX,attributes:[{format:u3[je],shaderLocation:ln,offset:Fe,divisor:Qe}]}),G=Te.size/je}),O||(this.options.count=G),A&&(this.indexBuffer=A.get());const vt=s.renderCache.createInputLayout({vertexBufferDescriptors:U,indexBufferFormat:A?tn.ED.U32_R:null,program:this.program});this.inputLayout=vt,this.pipeline=this.createPipeline(i)}createPipeline(a,i){var s;const{primitive:f=at.TRIANGLES,depth:g,cull:y,blend:_,stencil:O}=a,A=this.initDepthDrawParams({depth:g}),P=!!(A&&A.enable),B=this.initCullDrawParams({cull:y}),U=!!(B&&B.enable),G=this.getBlendDrawParams({blend:_}),vt=!!(G&&G.enable),$t=this.getStencilDrawParams({stencil:O}),te=!!($t&&$t.enable),Te=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:SC[f],colorAttachmentFormats:[tn.ED.U8_RGBA_RT],depthStencilAttachmentFormat:tn.ED.D24_S8,megaStateDescriptor:{attachmentsState:[i?{channelWriteMask:tn.GI.ALL,rgbBlendState:{blendMode:tn.bt.ADD,blendSrcFactor:tn.zi.ONE,blendDstFactor:tn.zi.ZERO},alphaBlendState:{blendMode:tn.bt.ADD,blendSrcFactor:tn.zi.ONE,blendDstFactor:tn.zi.ZERO}}:{channelWriteMask:te&&$t.opFront.zpass===tn.Kd.REPLACE?tn.GI.NONE:tn.GI.ALL,rgbBlendState:{blendMode:vt&&G.equation.rgb||tn.bt.ADD,blendSrcFactor:vt&&G.func.srcRGB||tn.zi.SRC_ALPHA,blendDstFactor:vt&&G.func.dstRGB||tn.zi.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:vt&&G.equation.alpha||tn.bt.ADD,blendSrcFactor:vt&&G.func.srcAlpha||tn.zi.ONE,blendDstFactor:vt&&G.func.dstAlpha||tn.zi.ONE}}],blendConstant:vt?tn.Ab:void 0,depthWrite:P,depthCompare:P&&A.func||tn.wb.LESS,cullMode:U&&B.face||tn.Wf.NONE,stencilWrite:te,stencilFront:{compare:te?$t.func.cmp:tn.wb.ALWAYS,passOp:$t.opFront.zpass,failOp:$t.opFront.fail,depthFailOp:$t.opFront.zfail,mask:$t.opFront.mask},stencilBack:{compare:te?$t.func.cmp:tn.wb.ALWAYS,passOp:$t.opBack.zpass,failOp:$t.opBack.fail,depthFailOp:$t.opBack.zfail,mask:$t.opBack.mask}}});return te&&!Ev((s=O==null?void 0:O.func)==null?void 0:s.ref)&&(Te.stencilFuncReference=O.func.ref),Te}updateAttributesAndElements(){}updateAttributes(){}addUniforms(a){this.uniforms=gs(gs({},this.uniforms),this.extractUniforms(a))}draw(a,i){const s=gs(gs({},this.options),a),{count:f=0,instances:g,elements:y,uniforms:_={},uniformBuffers:O,textures:A}=s;this.uniforms=gs(gs({},this.uniforms),this.extractUniforms(_));const{renderPass:P,currentFramebuffer:B,width:U,height:G}=this.service;this.pipeline=this.createPipeline(s,i);const vt=this.service.device,$t=vt.swapChainHeight;if(vt.swapChainHeight=(B==null?void 0:B.height)||G,P.setViewport(0,0,(B==null?void 0:B.width)||U,(B==null?void 0:B.height)||G),vt.swapChainHeight=$t,P.setPipeline(this.pipeline),Ev(this.pipeline.stencilFuncReference)||P.setStencilReference(this.pipeline.stencilFuncReference),P.setVertexInput(this.inputLayout,this.vertexBuffers.map(te=>({buffer:te})),y?{buffer:this.indexBuffer,offset:0}:null),O&&(this.bindings=vt.createBindings({pipeline:this.pipeline,uniformBufferBindings:O.map((te,Te)=>{const Fe=te;return{binding:Te,buffer:Fe.get(),size:Fe.size}}),samplerBindings:A==null?void 0:A.map(te=>({texture:te.texture,sampler:te.sampler}))})),this.bindings&&(P.setBindings(this.bindings),Object.keys(this.uniforms).forEach(te=>{const Te=this.uniforms[te];Te instanceof M3?this.uniforms[te]=Te.get():Te instanceof L3&&(this.uniforms[te]=Te.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),y){const te=y.count;te===0?P.draw(f,g):P.drawIndexed(te,g)}else P.draw(f,g)}destroy(){var a,i,s;(a=this.vertexBuffers)==null||a.forEach(f=>f.destroy()),(i=this.indexBuffer)==null||i.destroy(),(s=this.bindings)==null||s.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:a}){if(a)return{enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:p3[a.func||at.LESS],range:a.range||[0,1]}}getBlendDrawParams({blend:a}){const{enable:i,func:s,equation:f,color:g=[0,0,0,0]}=a||{};return{enable:!!i,func:{srcRGB:uh[s&&s.srcRGB||at.SRC_ALPHA],srcAlpha:uh[s&&s.srcAlpha||at.SRC_ALPHA],dstRGB:uh[s&&s.dstRGB||at.ONE_MINUS_SRC_ALPHA],dstAlpha:uh[s&&s.dstAlpha||at.ONE_MINUS_SRC_ALPHA]},equation:{rgb:mv[f&&f.rgb||at.FUNC_ADD],alpha:mv[f&&f.alpha||at.FUNC_ADD]},color:g}}getStencilDrawParams({stencil:a}){const{enable:i,mask:s=4294967295,func:f={cmp:at.ALWAYS,ref:0,mask:4294967295},opFront:g={fail:at.KEEP,zfail:at.KEEP,zpass:at.KEEP},opBack:y={fail:at.KEEP,zfail:at.KEEP,zpass:at.KEEP}}=a||{};return{enable:!!i,mask:s,func:D3(gs({},f),{cmp:v3[f.cmp]}),opFront:{fail:dl[g.fail],zfail:dl[g.zfail],zpass:dl[g.zpass],mask:f.mask},opBack:{fail:dl[y.fail],zfail:dl[y.zfail],zpass:dl[y.zpass],mask:f.mask}}}initCullDrawParams({cull:a}){if(a){const{enable:i,face:s=at.BACK}=a;return{enable:!!i,face:g3[s]}}}extractUniforms(a){const i={};return Object.keys(a).forEach(s=>{this.extractUniformsRecursively(s,a[s],i,"")}),i}extractUniformsRecursively(a,i,s,f){if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||N3(i)||i===""||"resize"in i){s[`${f&&f+"."}${a}`]=i;return}F3(i)&&Object.keys(i).forEach(g=>{this.extractUniformsRecursively(g,i[g],s,`${f&&f+"."}${a}`)}),Array.isArray(i)&&i.forEach((g,y)=>{Object.keys(g).forEach(_=>{this.extractUniformsRecursively(_,g[_],s,`${f&&f+"."}${a}[${y}]`)})})}};function j3(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}var ef=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),{isUndefined:nf}=Nr,z3=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=a=>new B3(this.device,a,this),this.createAttribute=a=>new l3(this.device,a),this.createBuffer=a=>new y3(this.device,a),this.createElements=a=>new T3(this.device,a),this.createTexture2D=a=>new M3(this.device,a),this.createFramebuffer=a=>new L3(this.device,a),this.useFramebuffer=(a,i)=>{this.currentFramebuffer=a,this.beginFrame(),i(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(a,i)=>ef(this,null,function*(){this.currentFramebuffer=a,this.preRenderPass=this.renderPass,this.beginFrame(),yield i(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=a=>{const{color:i,depth:s,stencil:f,framebuffer:g=null}=a;if(g)g.clearOptions={color:i,depth:s,stencil:f};else{const y=this.queryVerdorInfo();if(y==="WebGL1"){const _=this.getGLContext();nf(f)?nf(s)||(_.clearDepth(s),_.clear(_.DEPTH_BUFFER_BIT)):(_.clearStencil(f),_.clear(_.STENCIL_BUFFER_BIT))}else if(y==="WebGL2"){const _=this.getGLContext();nf(f)?nf(s)||_.clearBufferfv(_.DEPTH,0,[s]):_.clearBufferiv(_.STENCIL,0,[f])}}},this.viewport=({width:a,height:i})=>{this.swapChain.configureSwapChain(a,i),this.createMainColorDepthRT(a,i),this.width=a,this.height=i},this.readPixels=a=>{const{framebuffer:i,x:s,y:f,width:g,height:y}=a,_=this.device.createReadback(),O=i.colorTexture,A=_.readTextureSync(O,s,this.viewportOrigin===tn.Fp.LOWER_LEFT?f:this.height-f,g,y,new Uint8Array(g*y*4));if(this.viewportOrigin!==tn.Fp.LOWER_LEFT)for(let P=0;P<A.length;P+=4){const B=A[P];A[P]=A[P+2],A[P+2]=B}return _.destroy(),A},this.readPixelsAsync=a=>ef(this,null,function*(){const{framebuffer:i,x:s,y:f,width:g,height:y}=a,_=this.device.createReadback(),O=i.colorTexture,A=yield _.readTexture(O,s,this.viewportOrigin===tn.Fp.LOWER_LEFT?f:this.height-f,g,y,new Uint8Array(g*y*4));if(this.viewportOrigin!==tn.Fp.LOWER_LEFT)for(let P=0;P<A.length;P+=4){const B=A[P];A[P]=A[P+2],A[P+2]=B}return _.destroy(),A}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var a;this.canvas=null,(a=this.uniformBuffers)==null||a.forEach(i=>{i.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(a,i){return ef(this,null,function*(){const{enableWebGPU:s,shaderCompilerPath:f,antialias:g}=i;this.canvas=a;const _=yield(s?new tn.zo({shaderCompilerPath:f}):new tn.j8({targets:["webgl2","webgl1"],antialias:g,onContextLost(A){console.warn("context lost",A)},onContextCreationError(A){console.warn("context creation error",A)},onContextRestored(A){console.warn("context restored",A)}})).createSwapChain(a);_.configureSwapChain(a.width,a.height),this.device=_.getDevice(),this.swapChain=_,this.renderCache=new A3(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const O=this.device.gl;this.extensionObject={OES_texture_float:!j3(O)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height)})}createMainColorDepthRT(a,i){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:tn.ED.U8_RGBA_RT,width:a,height:i,usage:tn.v2.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:tn.ED.D24_S8,width:a,height:i,usage:tn.v2.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:a,swapChain:i,mainColorRT:s,mainDepthRT:f}=this,g=a?a.colorRenderTarget:s,y=a?null:i.getOnscreenTexture(),_=a?a.depthRenderTarget:f,{color:O=[0,0,0,0],depth:A=1,stencil:P=0}=(a==null?void 0:a.clearOptions)||{},B=g?(0,tn.RH)(O[0]*255,O[1]*255,O[2]*255,O[3]):tn.Ab,U=_?A:void 0,G=_?P:void 0,vt=this.device.createRenderPass({colorAttachment:[g],colorResolveTo:[y],colorClearColor:[B],colorStore:[!0],depthStencilAttachment:_,depthClearValue:U,stencilClearValue:G});this.renderPass=vt}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const a=this.device.gl;return a.getParameter(a.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}},hh=["selectstart","selecting","selectend"],U3=class extends no.EventEmitter{constructor(a,i={}){super(),this.isEnable=!1,this.onDragStart=s=>{this.box.style.display="block",this.startEvent=this.endEvent=s,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=s=>{this.endEvent=s,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=s=>{this.endEvent=s,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=a,this.options=i}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:a}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const i=Fi("div",void 0,this.container);i.classList.add("l7-select-box"),a&&i.classList.add(a),i.style.display="none",this.box=i}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:a,y:i}=this.startEvent,{x:s,y:f}=this.endEvent,g=Math.min(a,s),y=Math.min(i,f),_=Math.abs(a-s),O=Math.abs(i-f);this.box.style.top=`${y}px`,this.box.style.left=`${g}px`,this.box.style.width=`${_}px`,this.box.style.height=`${O}px`}getLngLatBox(){const{lngLat:{lng:a,lat:i}}=this.startEvent,{lngLat:{lng:s,lat:f}}=this.endEvent;return en([[a,i],[s,f]])}},wC=Object.defineProperty,Z3=Object.defineProperties,H3=Object.getOwnPropertyDescriptors,V3=Object.getOwnPropertySymbols,W3=Object.prototype.hasOwnProperty,AC=Object.prototype.propertyIsEnumerable,wv=(a,i,s)=>i in a?wC(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,G3=(a,i)=>{for(var s in i||(i={}))W3.call(i,s)&&wv(a,s,i[s]);if(V3)for(var s of V3(i))AC.call(i,s)&&wv(a,s,i[s]);return a},Y3=(a,i)=>Z3(a,H3(i)),hl=(a,i,s)=>new Promise((f,g)=>{var y=A=>{try{O(s.next(A))}catch(P){g(P)}},_=A=>{try{O(s.throw(A))}catch(P){g(P)}},O=A=>A.done?f(A.value):Promise.resolve(A.value).then(y,_);O((s=s.apply(a,i)).next())}),U6=class{constructor(a){const{id:i,map:s,renderer:f="device"}=a,g=eA();this.container=g,s.setContainer(g,i),f==="regl"?g.rendererService=new c3:g.rendererService=new z3,this.sceneService=g.sceneService,this.mapService=g.mapService,this.iconService=g.iconService,this.fontService=g.fontService,this.controlService=g.controlService,this.layerService=g.layerService,this.debugService=g.debugService,this.debugService.setEnable(a.debug),this.markerService=g.markerService,this.interactionService=g.interactionService,this.popupService=g.popupService,this.boxSelect=new U3(this,{}),this.initComponent(i),this.sceneService.init(a),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(a){return hl(this,null,function*(){return this.sceneService.exportPng(a)})}exportMap(a){return hl(this,null,function*(){return this.sceneService.exportPng(a)})}registerRenderService(a){this.sceneService.loaded?new a(this).init():this.on("loaded",()=>{new a(this).init()})}setBgColor(a){this.mapService.setBgColor(a)}addLayer(a){this.loaded?this.preAddLayer(a):this.once("loaded",()=>{this.preAddLayer(a)})}preAddLayer(a){const i=lu(this.container);if(a.setContainer(i),this.sceneService.addLayer(a),a.inited){this.initTileLayer(a);const s=this.initMask(a);this.addMask(s,a.id)}else a.on("inited",()=>{this.initTileLayer(a);const s=this.initMask(a);this.addMask(s,a.id)})}initMask(a){const{mask:i,maskfence:s,maskColor:f="#000",maskOpacity:g=0}=a.getLayerConfig();return!i||!s?void 0:new av().source(s).shape("fill").style({color:f,opacity:g})}addMask(a,i){if(!a)return;const s=this.getLayer(i);if(s){const f=lu(this.container);a.setContainer(f),s.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(a){return this.layerService.getLayer(a)}getLayerByName(a){return this.layerService.getLayerByName(a)}removeLayer(a,i){return hl(this,null,function*(){yield this.layerService.remove(a,i)})}removeAllLayer(){return hl(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(a){this.layerService.setEnableRender(a)}addIconFont(a,i){this.fontService.addIconFont(a,i)}addIconFonts(a){a.forEach(([i,s])=>{this.fontService.addIconFont(i,s)})}addFontFace(a,i){this.fontService.once("fontloaded",s=>{this.emit("fontloaded",s)}),this.fontService.addFontFace(a,i)}addImage(a,i){return hl(this,null,function*(){yield this.iconService.addImage(a,i)})}hasImage(a){return this.iconService.hasImage(a)}removeImage(a){this.iconService.removeImage(a)}addIconFontGlyphs(a,i){this.fontService.addIconGlyphs(i)}addControl(a){this.controlService.addControl(a,this.container)}removeControl(a){this.controlService.removeControl(a)}getControlByName(a){return this.controlService.getControlByName(a)}addMarker(a){this.markerService.addMarker(a)}addMarkerLayer(a){this.markerService.addMarkerLayer(a)}removeMarkerLayer(a){this.markerService.removeMarkerLayer(a)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(a){this.popupService.addPopup(a)}removePopup(a){this.popupService.removePopup(a)}on(a,i){var s;hh.includes(a)?(s=this.boxSelect)==null||s.on(a,i):Kf.includes(a)?this.sceneService.on(a,i):this.mapService.on(a,i)}once(a,i){var s;hh.includes(a)?(s=this.boxSelect)==null||s.once(a,i):Kf.includes(a)?this.sceneService.once(a,i):this.mapService.once(a,i)}emit(a,i){Kf.indexOf(a)===-1?this.mapService.on(a,i):this.sceneService.emit(a,i)}off(a,i){var s;hh.includes(a)?(s=this.boxSelect)==null||s.off(a,i):Kf.includes(a)?this.sceneService.off(a,i):this.mapService.off(a,i)}getZoom(){return this.mapService.getZoom()}getCenter(a){return this.mapService.getCenter(a)}setCenter(a,i){return this.mapService.setCenter(a,i)}getPitch(){return this.mapService.getPitch()}setPitch(a){return this.mapService.setPitch(a)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(a){this.mapService.setRotation(a)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(a){this.mapService.panTo(a)}panBy(a,i){this.mapService.panBy(a,i)}getContainer(){return this.mapService.getContainer()}setZoom(a){this.mapService.setZoom(a)}fitBounds(a,i){const{fitBoundsOptions:s,animate:f}=this.sceneService.getSceneConfig();this.mapService.fitBounds(a,i||Y3(G3({},s),{animate:f}))}setZoomAndCenter(a,i){this.mapService.setZoomAndCenter(a,i)}setMapStyle(a){this.mapService.setMapStyle(a)}setMapStatus(a){this.mapService.setMapStatus(a)}pixelToLngLat(a){return this.mapService.pixelToLngLat(a)}lngLatToPixel(a){return this.mapService.lngLatToPixel(a)}containerToLngLat(a){return this.mapService.containerToLngLat(a)}lngLatToContainer(a){return this.mapService.lngLatToContainer(a)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(a){this.container.postProcessingPass.name=new a}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(a=!0){this.boxSelect.enable(),a&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(a,i){pn.REGISTERED_PROTOCOLS[a]=i}static removeProtocol(a){delete pn.REGISTERED_PROTOCOLS[a]}getProtocol(a){return pn.REGISTERED_PROTOCOLS[a]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(a){this.controlService.init({container:IO(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:a,logoPosition:i}=this.sceneService.getSceneConfig();a&&this.addControl(new Db({position:i}))}initTileLayer(a){a.getSource().isTile&&(a.tileLayer=new gC(a))}},Z6="2.22.1";class TC{constructor(i){(0,ut.Z)(this,"configService",void 0),(0,ut.Z)(this,"config",void 0),this.config=i}setContainer(i,s){this.configService=i.globalConfigService,i.mapConfig=(0,Je.Z)((0,Je.Z)({},this.config),{},{id:s}),i.mapService=new(this.getServiceConstructor())(i)}getServiceConstructor(){throw new Error("Method not implemented.")}}var ph=k(6158),rf=k.n(ph),$3=k(15671),X3=k(43144),CC=k(82963),MC=k(61120),LC=k(60136),gh=k(97326),Oo=k(97685);function pl(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function of(a,i){var s=ts.fF([],i,a);return ts.bA(s,s,1/s[3]),s}function H6(a,i){var s=a%i;return s<0?i+s:s}function V6(a,i,s){return s*i+(1-s)*a}function cc(a,i){if(!a)throw new Error(i||"viewport-mercator-project: assertion failed.")}var Xo=Math.PI,vh=Xo/4,va=Xo/180,Av=180/Xo,mh=512,gl=4003e4,q3=1.5;function Tv(a){return Math.pow(2,a)}function K3(a){return Math.log2(a)}function lc(a,i){var s=(0,Oo.Z)(a,2),f=s[0],g=s[1];cc(Number.isFinite(f)&&Number.isFinite(i)),cc(Number.isFinite(g)&&g>=-90&&g<=90,"invalid latitude"),i*=mh;var y=f*va,_=g*va,O=i*(y+Xo)/(2*Xo),A=i*(Xo-Math.log(Math.tan(vh+_*.5)))/(2*Xo);return[O,A]}function yh(a,i){var s=(0,Oo.Z)(a,2),f=s[0],g=s[1];i*=mh;var y=f/i*(2*Xo)-Xo,_=2*(Math.atan(Math.exp(Xo-g/i*(2*Xo)))-vh);return[y*Av,_*Av]}function PC(a){var i=a.latitude;assert(Number.isFinite(i));var s=Math.cos(i*va);return K3(gl*s)-9}function Q3(a){var i=a.latitude,s=a.longitude,f=a.zoom,g=a.scale,y=a.highPrecision,_=y===void 0?!1:y;g=g!==void 0?g:Tv(f),cc(Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(g));var O={},A=mh*g,P=Math.cos(i*va),B=A/360,U=B/P,G=A/gl/P;if(O.pixelsPerMeter=[G,-G,G],O.metersPerPixel=[1/G,-1/G,1/G],O.pixelsPerDegree=[B,-U,G],O.degreesPerPixel=[1/B,-1/U,1/G],_){var vt=va*Math.tan(i*va)/P,$t=B*vt/2,te=A/gl*vt,Te=te/U*G;O.pixelsPerDegree2=[0,-$t,te],O.pixelsPerMeter2=[Te,0,Te]}return O}function W6(a,i){var s=_slicedToArray(a,3),f=s[0],g=s[1],y=s[2],_=_slicedToArray(i,3),O=_[0],A=_[1],P=_[2],B=1,U=Q3({longitude:f,latitude:g,scale:B,highPrecision:!0}),G=U.pixelsPerMeter,vt=U.pixelsPerMeter2,$t=lc(a,B);$t[0]+=O*(G[0]+vt[0]*A),$t[1]+=A*(G[1]+vt[1]*A);var te=yh($t,B),Te=(y||0)+(P||0);return Number.isFinite(y)||Number.isFinite(P)?[te[0],te[1],Te]:te}function IC(a){var i=a.height,s=a.pitch,f=a.bearing,g=a.altitude,y=a.center,_=y===void 0?null:y,O=a.flipY,A=O===void 0?!1:O,P=pl();return Er.translate(P,P,[0,0,-g]),Er.scale(P,P,[1,1,1/i]),Er.rotateX(P,P,-s*va),Er.rotateZ(P,P,f*va),A&&Er.scale(P,P,[1,-1,1]),_&&Er.translate(P,P,Ir.tk([],_)),P}function J3(a){var i=a.width,s=a.height,f=a.altitude,g=f===void 0?q3:f,y=a.pitch,_=y===void 0?0:y,O=a.nearZMultiplier,A=O===void 0?1:O,P=a.farZMultiplier,B=P===void 0?1:P,U=_*va,G=Math.atan(.5/g),vt=Math.sin(G)*g/Math.sin(Math.PI/2-U-G),$t=Math.cos(Math.PI/2-U)*vt+g;return{fov:2*Math.atan(s/2/g),aspect:i/s,focalDistance:g,near:A,far:$t*B}}function RC(a){var i=a.width,s=a.height,f=a.pitch,g=a.altitude,y=a.nearZMultiplier,_=a.farZMultiplier,O=J3({width:i,height:s,altitude:g,pitch:f,nearZMultiplier:y,farZMultiplier:_}),A=O.fov,P=O.aspect,B=O.near,U=O.far,G=Er.perspective([],A,P,B,U);return G}function kC(a,i){var s=(0,Oo.Z)(a,3),f=s[0],g=s[1],y=s[2],_=y===void 0?0:y;return cc(Number.isFinite(f)&&Number.isFinite(g)&&Number.isFinite(_)),of(i,[f,g,_,1])}function tS(a,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,f=(0,Oo.Z)(a,3),g=f[0],y=f[1],_=f[2];if(cc(Number.isFinite(g)&&Number.isFinite(y),"invalid pixel coordinate"),Number.isFinite(_)){var O=of(i,[g,y,_,1]);return O}var A=of(i,[g,y,0,1]),P=of(i,[g,y,1,1]),B=A[2],U=P[2],G=B===U?0:((s||0)-B)/(U-B);return ar.t7([],A,P,G)}var eS=pl(),DC=function(){function a(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.width,f=i.height,g=i.viewMatrix,y=g===void 0?eS:g,_=i.projectionMatrix,O=_===void 0?eS:_;(0,$3.Z)(this,a),this.width=s||1,this.height=f||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=y,this.projectionMatrix=O;var A=pl();Er.multiply(A,A,this.projectionMatrix),Er.multiply(A,A,this.viewMatrix),this.viewProjectionMatrix=A;var P=pl();Er.scale(P,P,[this.width/2,-this.height/2,1]),Er.translate(P,P,[1,-1,0]),Er.multiply(P,P,this.viewProjectionMatrix);var B=Er.invert(pl(),P);if(!B)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=P,this.pixelUnprojectionMatrix=B,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,X3.Z)(a,[{key:"equals",value:function(s){return s instanceof a?s.width===this.width&&s.height===this.height&&Er.equals(s.projectionMatrix,this.projectionMatrix)&&Er.equals(s.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=f.topLeft,y=g===void 0?!0:g,_=this.projectPosition(s),O=kC(_,this.pixelProjectionMatrix),A=(0,Oo.Z)(O,2),P=A[0],B=A[1],U=y?B:this.height-B;return s.length===2?[P,U]:[P,U,O[2]]}},{key:"unproject",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=f.topLeft,y=g===void 0?!0:g,_=f.targetZ,O=(0,Oo.Z)(s,3),A=O[0],P=O[1],B=O[2],U=y?P:this.height-P,G=_&&_*this.pixelsPerMeter,vt=tS([A,U,B],this.pixelUnprojectionMatrix,G),$t=this.unprojectPosition(vt),te=(0,Oo.Z)($t,3),Te=te[0],Fe=te[1],Ze=te[2];return Number.isFinite(B)?[Te,Fe,Ze]:Number.isFinite(_)?[Te,Fe,_]:[Te,Fe]}},{key:"projectPosition",value:function(s){var f=this.projectFlat(s),g=(0,Oo.Z)(f,2),y=g[0],_=g[1],O=(s[2]||0)*this.pixelsPerMeter;return[y,_,O]}},{key:"unprojectPosition",value:function(s){var f=this.unprojectFlat(s),g=(0,Oo.Z)(f,2),y=g[0],_=g[1],O=(s[2]||0)/this.pixelsPerMeter;return[y,_,O]}},{key:"projectFlat",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}},{key:"unprojectFlat",value:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}}]),a}();function vs(a){var i=a.width,s=a.height,f=a.bounds,g=a.minExtent,y=g===void 0?0:g,_=a.maxZoom,O=_===void 0?24:_,A=a.padding,P=A===void 0?0:A,B=a.offset,U=B===void 0?[0,0]:B,G=(0,Oo.Z)(f,2),vt=(0,Oo.Z)(G[0],2),$t=vt[0],te=vt[1],Te=(0,Oo.Z)(G[1],2),Fe=Te[0],Ze=Te[1];if(Number.isFinite(P)){var je=P;P={top:je,bottom:je,left:je,right:je}}else cc(Number.isFinite(P.top)&&Number.isFinite(P.bottom)&&Number.isFinite(P.left)&&Number.isFinite(P.right));var Qe=new bh({width:i,height:s,longitude:0,latitude:0,zoom:0}),ln=Qe.project([$t,Ze]),wn=Qe.project([Fe,te]),mn=[Math.max(Math.abs(wn[0]-ln[0]),y),Math.max(Math.abs(wn[1]-ln[1]),y)],Mn=[i-P.left-P.right-Math.abs(U[0])*2,s-P.top-P.bottom-Math.abs(U[1])*2];cc(Mn[0]>0&&Mn[1]>0);var rr=Mn[0]/mn[0],Qn=Mn[1]/mn[1],Yn=(P.right-P.left)/2/rr,lr=(P.bottom-P.top)/2/Qn,Rr=[(wn[0]+ln[0])/2+Yn,(wn[1]+ln[1])/2+lr],qo=Qe.unproject(Rr),ml=Qe.zoom+Math.log2(Math.abs(Math.min(rr,Qn)));return{longitude:qo[0],latitude:qo[1],zoom:Math.min(ml,O)}}var bh=function(a){(0,LC.Z)(i,a);function i(){var s,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=f.width,y=f.height,_=f.latitude,O=_===void 0?0:_,A=f.longitude,P=A===void 0?0:A,B=f.zoom,U=B===void 0?0:B,G=f.pitch,vt=G===void 0?0:G,$t=f.bearing,te=$t===void 0?0:$t,Te=f.altitude,Fe=Te===void 0?1.5:Te,Ze=f.nearZMultiplier,je=f.farZMultiplier;(0,$3.Z)(this,i),g=g||1,y=y||1;var Qe=Tv(U);Fe=Math.max(.75,Fe);var ln=lc([P,O],Qe);ln[2]=0;var wn=RC({width:g,height:y,pitch:vt,bearing:te,altitude:Fe,nearZMultiplier:Ze||1/y,farZMultiplier:je||1.01}),mn=IC({height:y,center:ln,pitch:vt,bearing:te,altitude:Fe,flipY:!0});return s=(0,CC.Z)(this,(0,MC.Z)(i).call(this,{width:g,height:y,viewMatrix:mn,projectionMatrix:wn})),s.latitude=O,s.longitude=P,s.zoom=U,s.pitch=vt,s.bearing=te,s.altitude=Fe,s.scale=Qe,s.center=ln,s.pixelsPerMeter=Q3((0,gh.Z)((0,gh.Z)(s))).pixelsPerMeter[2],Object.freeze((0,gh.Z)((0,gh.Z)(s))),s}return(0,X3.Z)(i,[{key:"projectFlat",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return lc(f,g)}},{key:"unprojectFlat",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return yh(f,g)}},{key:"getMapCenterByLngLatPosition",value:function(f){var g=f.lngLat,y=f.pos,_=tS(y,this.pixelUnprojectionMatrix),O=lc(g,this.scale),A=ar.IH([],O,ar.tk([],_)),P=ar.IH([],this.center,A);return yh(P,this.scale)}},{key:"getLocationAtPoint",value:function(f){var g=f.lngLat,y=f.pos;return this.getMapCenterByLngLatPosition({lngLat:g,pos:y})}},{key:"fitBounds",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=this.width,_=this.height,O=vs(Object.assign({width:y,height:_,bounds:f},g)),A=O.longitude,P=O.latitude,B=O.zoom;return new i({width:y,height:_,longitude:A,latitude:P,zoom:B})}}]),i}(DC);class _h{constructor(){(0,ut.Z)(this,"viewport",new bh)}syncWithMapCamera(i){const{center:s,zoom:f,pitch:g,bearing:y,viewportHeight:_,viewportWidth:O}=i,A={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new bh((0,Je.Z)((0,Je.Z)({},A),{},{width:O,height:_,longitude:s&&s[0],latitude:s&&s[1],zoom:f,pitch:g,bearing:y}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(i,s){return this.viewport.projectFlat(i,s)}}class nS{constructor(i){(0,ut.Z)(this,"size",1e4),this.size=i||1e4}setSize(i){this.size=i}getSize(){return[this.size,this.size]}mercatorXfromLng(i){return(180+i)/360*this.size}mercatorYfromLat(i){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360)*this.size}lngFromMercatorX(i){return i/this.size*360-180}latFromMercatorY(i){const s=180-(1-i/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}project(i){const s=this.mercatorXfromLng(i[0]),f=this.mercatorYfromLat(i[1]);return[s,f]}unproject(i){const s=this.lngFromMercatorX(i[0]),f=this.latFromMercatorY(i[1]);return[s,f]}}const Cv={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Mv={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},rS=12;class ms{constructor(i){(0,ut.Z)(this,"version","DEFAUlTMAP"),(0,ut.Z)(this,"map",void 0),(0,ut.Z)(this,"simpleMapCoord",new nS),(0,ut.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,ut.Z)(this,"config",void 0),(0,ut.Z)(this,"configService",void 0),(0,ut.Z)(this,"coordinateSystemService",void 0),(0,ut.Z)(this,"eventEmitter",void 0),(0,ut.Z)(this,"markerContainer",void 0),(0,ut.Z)(this,"cameraChangedCallback",void 0),(0,ut.Z)(this,"$mapContainer",void 0),(0,ut.Z)(this,"handleCameraChanged",s=>{const{lat:f,lng:g}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[g,f],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=i.mapConfig,this.configService=i.globalConfigService,this.coordinateSystemService=i.coordinateSystemService,this.eventEmitter=new no.EventEmitter}setBgColor(i){this.bgColor=i}addMarkerContainer(){const i=this.map.getCanvasContainer();this.markerContainer=Fi("div","l7-marker-container",i),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(i,s){zf.indexOf(i)!==-1?this.eventEmitter.on(i,s):this.map.on(Mv[i]||i,s)}off(i,s){this.map.off(Mv[i]||i,s),this.eventEmitter.off(i,s)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const i=this.map.transform;return[i.width,i.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(i){return this.map.setZoom(i)}getCenter(){return this.map.getCenter()}setCenter(i){this.map.setCenter(i)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(i){this.map.setBearing(i)}zoomIn(i,s){this.map.zoomIn(i,s)}zoomOut(i,s){this.map.zoomOut(i,s)}setPitch(i){return this.map.setPitch(i)}panTo(i){this.map.panTo(i)}panBy(i=0,s=0){this.map.panBy([i,s])}fitBounds(i,s){this.map.fitBounds(i,s)}setMaxZoom(i){this.map.setMaxZoom(i)}setMinZoom(i){this.map.setMinZoom(i)}setMapStatus(i){i.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),i.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),i.dragEnable===!1&&this.map.dragPan.disable(),i.dragEnable===!0&&this.map.dragPan.enable(),i.rotateEnable===!1&&this.map.dragRotate.disable(),i.dragEnable===!0&&this.map.dragRotate.enable(),i.keyboardEnable===!1&&this.map.keyboard.disable(),i.keyboardEnable===!0&&this.map.keyboard.enable(),i.zoomEnable===!1&&this.map.scrollZoom.disable(),i.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(i,s){this.map.flyTo({zoom:i,center:s})}setMapStyle(i){var s;(s=this.map)===null||s===void 0||s.setStyle(this.getMapStyleValue(i))}meterToCoord(i,s){return 1}pixelToLngLat(i){return this.map.unproject(i)}lngLatToPixel(i){return this.map.project(i)}containerToLngLat(i){return this.map.unproject(i)}lngLatToContainer(i){return this.map.project(i)}getMapStyle(){try{var i;const s=(i=this.map.getStyle().sprite)!==null&&i!==void 0?i:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(s)?s==null?void 0:s.replace(/\/\w+$/,"").replace(/sprites/,"styles"):s}catch(s){return""}}getMapStyleConfig(){return Cv}getMapStyleValue(i){var s;return(s=this.getMapStyleConfig()[i])!==null&&s!==void 0?s:i}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(i,...s){this.eventEmitter.emit(i,...s)}once(i,...s){this.eventEmitter.once(i,...s)}getMapContainer(){return this.$mapContainer}exportMap(i){var s;const f=(s=this.map)===null||s===void 0?void 0:s.getCanvas();return i==="jpg"?f==null?void 0:f.toDataURL("image/jpeg"):f==null?void 0:f.toDataURL("image/png")}onCameraChanged(i){this.cameraChangedCallback=i}creatMapContainer(i){let s=i;return typeof i=="string"&&(s=document.getElementById(i)),s}updateView(i){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:i.bearing,center:i.center,viewportHeight:i.viewportHeight,pitch:i.pitch,viewportWidth:i.viewportWidth,zoom:i.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:i=!0}=this.config;this.viewport.getZoom()>rS&&i?this.coordinateSystemService.setCoordinateSystem(jf.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(jf.LNGLAT)}}const ys=["id","attributionControl","style","token","rotation","mapInstance"];function FC(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var g=i.head||i.getElementsByTagName("head")[0];if(!g){g=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(g,y):i.documentElement.appendChild(g)}var _=i.createElement("style");return _.type="text/css",_.styleSheet?_.styleSheet.cssText=a:_.appendChild(i.createTextNode(a)),g.appendChild(_),_}}FC(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=rf();let NC=0;const vl="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class iS extends ms{constructor(...i){super(...i),(0,ut.Z)(this,"version","MAPBOX"),(0,ut.Z)(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(i,s={x:0,y:0,z:0}){const{x:f,y:g}=this.lngLatToMercator(i,0);return[f-s.x,g-s.y]}lngLatToMercator(i,s){const{x:f=0,y:g=0,z:y=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(i,s);return{x:f,y:g,z:y}}getModelMatrix(i,s,f,g=[1,1,1],y={x:0,y:0,z:0}){const _=window.mapboxgl.MercatorCoordinate.fromLngLat(i,s),O=_.meterInMercatorCoordinateUnits(),A=Er.create();return Er.translate(A,A,Ir.al(_.x-y.x,_.y-y.y,_.z||0-y.z)),Er.scale(A,A,Ir.al(O*g[0],-O*g[1],O*g[2])),Er.rotateX(A,A,f[0]),Er.rotateY(A,A,f[1]),Er.rotateZ(A,A,f[2]),A}init(){var i=this;return(0,nn.Z)(function*(){const s=i.config,{id:f="map",attributionControl:g=!1,style:y="light",token:_=vl,rotation:O=0,mapInstance:A}=s,P=(0,ia.Z)(s,ys);i.viewport=new _h,!A&&!window.mapboxgl&&console.error(i.configService.getSceneWarninfo("SDK")),_===vl&&y!=="blank"&&!window.mapboxgl.accessToken&&!A&&console.warn(i.configService.getSceneWarninfo("MapToken")),!A&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=_),A?(i.map=A,i.$mapContainer=i.map.getContainer()):(i.$mapContainer=i.creatMapContainer(f),i.map=new window.mapboxgl.Map((0,Je.Z)({container:i.$mapContainer,style:i.getMapStyleValue(y),attributionControl:g,bearing:O},P))),i.map.on("load",()=>{i.handleCameraChanged()}),i.map.on("move",i.handleCameraChanged),i.handleCameraChanged()})()}destroy(){var i;(i=this.$mapContainer)===null||i===void 0||(i=i.parentNode)===null||i===void 0||i.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(i,...s){this.eventEmitter.emit(i,...s)}once(i,...s){this.eventEmitter.once(i,...s)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var i;return(i=this.getMapContainer())===null||i===void 0?void 0:i.querySelector(".mapboxgl-canvas-container")}meterToCoord(i,s){const f=new(rf()).LngLat(i[0],i[1]),g=new(rf()).LngLat(s[0],s[1]),y=f.distanceTo(g),_=rf().MercatorCoordinate.fromLngLat({lng:i[0],lat:i[1]}),O=rf().MercatorCoordinate.fromLngLat({lng:s[0],lat:s[1]}),{x:A,y:P}=_,{x:B,y:U}=O;return Math.sqrt(Math.pow(A-B,2)+Math.pow(P-U,2))*4194304*2/y}exportMap(i){const s=this.map.getCanvas();return i==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png")}creatMapContainer(i){let s=i;typeof i=="string"&&(s=document.getElementById(i));const f=document.createElement("div");return f.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,f.id="l7_mapbox_div"+NC++,s.appendChild(f),f}}function oS(a,i){var s=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,f=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(s||f)&&(i||(i=document),!!i)){var g=i.head||i.getElementsByTagName("head")[0];if(!g){g=i.createElement("head");var y=i.body||i.getElementsByTagName("body")[0];y?y.parentNode.insertBefore(g,y):i.documentElement.appendChild(g)}var _=i.createElement("style");return _.type="text/css",_.styleSheet?_.styleSheet.cssText=a:_.appendChild(i.createTextNode(a)),g.appendChild(_),_}}oS(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class aS extends TC{getServiceConstructor(){return iS}}var uc=k(67294),sS=k(85893),cS=function(i){var s=i.data,f=i.config,g=f===void 0?{}:f,y=(0,pt.hQ)();return(0,uc.useEffect)(function(){var _=new U6({id:y,map:new aS({pitch:0,style:"blank",center:[116.368652,39.93866],zoom:10.07})}),O=["#0A3663","#3771D9","#4D89E5","#64A5D3","#72BED6","#83CED6","#A6E1E0","#B8EFE2","#D7F9F0"].reverse(),A=g.field,P=g.domain_min,B=P===void 0?0:P,U=g.domain_max,G=U===void 0?100:U,vt=new po({autoFit:!0}).source(s);vt.color(A,O).scale(A,{type:"quantize",domain:[B,G]}).shape("fill").style({opacity:1}).active(!0);var $t=new il({zIndex:2}).source(s).color("#eee").size(.8).active(!0).style({lineType:"solid",dashArray:[2,2],opacity:1});_.addLayer(vt),_.addLayer($t);var te=new Vx({offsets:[0,0],closeButton:!1});vt.on("mousemove",function(Fe){te.setLnglat(Fe.lngLat).setHTML("<span>".concat(Fe.feature.properties.name,":").concat(Fe&&Fe.feature.properties[A]?Fe.feature.properties[A]:"-","</span>")),_.addPopup(te)}),vt.on("mouseout",function(Fe){_.removePopup(te)});var Te=new ua({position:"bottomright"});Te.onAdd=function(){var Fe=document.createElement("div");Fe.className="infolegend legend";for(var Ze=Math.floor(G/O.length),je=0;je<O.length;je++)Fe.innerHTML+='<i style="width: 18px;height: 18px;float: left;margin-right: 8px;opacity: 0.7;background:'+O[je]+'"></i> '+(B+je*Ze)+(O[je+1]?"\u2013"+Ze*(je+1)+"<br>":"+");return Fe},_.addControl(Te)},[]),(0,sS.jsx)("div",{id:y,style:{width:"100%",minHeight:300,position:"relative",overflow:"hidden",height:g.height}})},BC=cS},53463:function(ke,Se,k){"use strict";k.r(Se),k.d(Se,{PagePanelHeader:function(){return zt},default:function(){return nt}});var pt=k(15009),it=k.n(pt),_t=k(97857),qt=k.n(_t),q=k(99289),Zt=k.n(q),Bt=k(5574),Wt=k.n(Bt),ct=k(97584),ee=k(38345),K=k(1956),J=k(6466),Ct=k(7837),ft=k(98165),mt=k(63430),lt=k(79611),jt=k(78677),ue=k(80652),we=k(48054),Ne=k(7134),Ge=k(71230),ye=k(15746),Vt=k(14726),$=k(31418),ae=k(86250),Gt=k(48096),_e=k(8988),xe=k(27484),X=k.n(xe),Rt=k(67294),V=k(61503),Mt=k(89649),H=k(17003),N={pageHeaderContent:"pageHeaderContent___exWxI",avatar:"avatar___rptEO",content:"content___jBAzR",contentTitle:"contentTitle___TsVhT",extraContent:"extraContent___tNqx0",statItem:"statItem___jPU6u"},et=k(58092),ot=k(96486),At=k(92077),Dt=k.n(At),ie=k(36942),Tt=k(85893),zt=function(he){var yt,St=(0,Ct.useModel)("@@initialState"),F=St.initialState,T=F.currentUser,gt=T&&Object.keys(T).length;return gt?(0,Tt.jsxs)("div",{className:N.pageHeaderContent,children:[(0,Tt.jsx)("div",{className:N.avatar,children:(0,Tt.jsx)(Ne.C,{size:"large",src:T.avatar?T.avatar:F==null||(yt=F.settings)===null||yt===void 0||(yt=yt.adminSetting)===null||yt===void 0?void 0:yt.logo})}),(0,Tt.jsx)("div",{className:N.content,children:(0,Tt.jsx)("div",{className:N.contentTitle,children:(0,Tt.jsxs)(Ge.Z,{children:[(0,Tt.jsxs)(ye.Z,{span:12,children:[(0,Tt.jsx)(Ge.Z,{children:(0,Tt.jsxs)(ye.Z,{children:["\u4F60\u597D\uFF0C",T.realname?T.realname:T.name]})}),(0,Tt.jsx)(Ge.Z,{children:(0,Tt.jsxs)(ye.Z,{children:[T.rolename," ",(0,Tt.jsx)(Vt.ZP,{shape:"circle",type:"text",onClick:function(){var C;(C=he.flash)===null||C===void 0||C.call(he)},icon:(0,Tt.jsx)(ft.Z,{})})]})})]}),(0,Tt.jsx)(ye.Z,{span:12,style:{textAlign:"right"},children:(0,Tt.jsx)(Oe,{})})]})})})]}):(0,Tt.jsx)(we.Z,{avatar:!0,paragraph:{rows:1},active:!0})},Oe=function(){var he=(0,Rt.useState)(X()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),yt=Wt()(he,2),St=yt[0],F=yt[1],T=function gt(){F(X()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),setTimeout(function(){return gt()},1e3)};return setTimeout(function(){return T()},1e3),(0,Tt.jsx)(Tt.Fragment,{children:St})},Lt=function(he){var yt=he.url,St=yt===void 0?"":yt,F=(0,Rt.useState)(),T=Wt()(F,2),gt=T[0],ne=T[1],C=$.Z.useApp(),j=C.message,Pt=(0,Rt.useState)(),Jt=Wt()(Pt,2),se=Jt[0],Ae=Jt[1],Le=(0,Ct.useModel)("@@initialState"),De=Le.initialState,Ve=function(){var Ye=Zt()(it()().mark(function Xt(){var re,le,pe,Q=arguments;return it()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return re=Q.length>0&&Q[0]!==void 0?Q[0]:{},j.loading("\u52A0\u8F7D\u4E2D..."),Z.next=4,ct.ZP.get(St,{params:qt()(qt()({},se),re),then:function(){}});case 4:le=Z.sent,pe=le.data,j.destroy(),ne(pe);case 8:case"end":return Z.stop()}},Xt)}));return function(){return Ye.apply(this,arguments)}}();(0,Rt.useEffect)(function(){Ve()},[]);var We=function(Xt){var re,le,pe=Xt.type,Q=(re=Xt.config)===null||re===void 0?void 0:re.xField,D=(le=Xt.config)===null||le===void 0?void 0:le.yField;if(pe=="pie"){var Z,tt;Q=Xt.config.colorField,D=Xt.config.angleField;var Et=(0,ot.sum)(Xt.data.map(function(fe){return fe[D]}));return(0,Tt.jsx)(mt.Z,qt()({height:280,appendPadding:10,data:Xt.data,radius:.9,label:{position:"spider",text:function(Be){return console.log("item is ",Be),"".concat(Be[Q],": ").concat(Dt()(Be[D]).format("0,0"))}},annotations:[{type:"text",style:{text:`\u603B\u8BA1
`.concat(Et),x:"50%",y:"50%",textAlign:"center",fontSize:18}}],interactions:[{type:"element-active"}],legend:(Z=Xt.config)!==null&&Z!==void 0&&Z.legend?(tt=Xt.config)===null||tt===void 0?void 0:tt.legend:!1},Xt.config))}else if(pe=="bar"){var It;return(0,Tt.jsx)(lt.Z,qt()({xField:Q,yField:D,scale:{x:{paddingInner:.4}},data:Xt.data,tooltip:{name:(It=Xt.config)===null||It===void 0?void 0:It.name,field:D}},Xt.config))}else{if(pe=="column")return(0,Tt.jsx)(jt.Z,qt()({xField:Q,yField:D,scale:{x:{paddingInner:.4}},data:Xt.data},Xt.config));if(pe=="areaMap"){var ce=qt()({map:{type:"mapbox",style:"blank",center:[120.19382669582967,30.258134],zoom:13,pitch:0},source:{data:Xt.data,parser:{type:"geojson"}},autoFit:!0,color:{field:Xt.field,value:["#1A4397","#3165D1","#6296FE","#98B7F7","#DDE6F7","#F2F5FC"].reverse(),scale:{type:"quantile"}},style:{opacity:1,stroke:"#eee",lineWidth:.8,lineOpacity:1},state:{active:!0,select:{stroke:"blue",lineWidth:1.5,lineOpacity:.8}},label:{visible:!0,field:"name",style:{fill:"black",opacity:.5,fontSize:12,spacing:1,padding:[15,15]}},zoom:{position:"bottomright"},legend:{position:"bottomleft"}},Xt.config);return(0,Tt.jsx)("div",{style:{width:"100%",height:500},children:(0,Tt.jsx)(et.Z,{data:Xt.data,config:Xt})})}else return(0,Tt.jsx)(ue.Z,qt()({smooth:!0,shapeField:"smooth",height:280,data:Xt.data,xField:"x",yField:"y",title:{visible:!0,text:Xt.title,style:{fontSize:14}},meta:{y:{alias:Xt.y}},label:{content:function(Be){return Be.y},position:"top",style:{fill:"#000000",opacity:.6}}},Xt.config))}},$e=function Ye(Xt,re){var le;return(0,Tt.jsx)(ae.Z,{vertical:!0,gap:"middle",children:Xt==null||(le=Xt.row)===null||le===void 0?void 0:le.map(function(pe,Q){var D;return(0,Tt.jsxs)(Ge.Z,{gutter:[16,16],children:[pe.form?(0,Tt.jsx)(ye.Z,{span:24,children:(0,Tt.jsx)(ee.Z,{bodyStyle:{padding:0},children:(0,Tt.jsx)(K.Z,{layoutType:"QueryFilter",columns:(0,Mt.ab)({initRequest:!0,columns:pe.form.columns,devEnable:!1}),initialValues:se||pe.form.value,onFinish:function(tt){Ve(tt),console.log("onFinish",tt)}})})},Q+"form"):null,pe==null||(D=pe.col)===null||D===void 0?void 0:D.map(function(Z,tt){if(Z.row){var Et;return(0,Tt.jsx)(ye.Z,{span:Z.span?Z.span:24/((Et=pe.col)===null||Et===void 0?void 0:Et.length),children:Ye(Z,re)},tt)}else if(Z.tab){var It;return(0,Tt.jsx)(ye.Z,{span:Z.span?Z.span:24/((It=pe.col)===null||It===void 0?void 0:It.length),children:(0,Tt.jsx)(ee.Z,{style:{borderTopRightRadius:0,borderTopLeftRadius:0},children:(0,Tt.jsx)(Gt.Z,{style:{background:"none"},tabBarStyle:{paddingLeft:0,marginBottom:0},items:Z.tab.map(function(fe,Be){return{key:Be,label:fe.title,children:fe.row?Ye(fe,re):re(fe,Be,{notitle:!0})}})})},tt)},tt)}else{var ce;return(0,Tt.jsx)(ye.Z,{span:Z.span?Z.span:24/((ce=pe.col)===null||ce===void 0?void 0:ce.length),children:re(Z,tt)},tt)}})]},Q)})})};return(0,Tt.jsx)(ie.PageContainer404,{title:!1,path:he==null?void 0:he.path,children:(0,Tt.jsxs)(ae.Z,{vertical:!0,gap:"middle",children:[(0,Tt.jsx)(ee.Z,{children:(0,Tt.jsx)(zt,{flash:Ve})},"headcard"),$e(gt,function(Ye,Xt,re){return Ye.type=="card"?(0,Tt.jsx)(J.Z,{style:{height:"100%"},statistic:{title:Ye.title,value:Ye.value,prefix:Ye.prefix,suffix:Ye.suffix,description:Ye.href?(0,Tt.jsx)(Ct.Link,{to:Ye.href,style:{fontSize:12},children:"\u67E5\u770B\u66F4\u591A"}):""}},Xt+"card"):Ye.type=="table"?(0,Tt.jsx)(ee.Z,{style:{height:"100%"},children:(0,Tt.jsx)(_e.Z,qt()({columns:(0,H.S)({initRequest:!0,columns:Ye.columns,initialState:De,devEnable:!1}),dataSource:Ye.data,title:function(){return Ye.title},rowKey:"id"},Ye.props))},Xt+"table"):Ye.type=="mapDots"?(0,Tt.jsx)(ee.Z,{title:Ye.title,style:{height:"100%"},children:(0,Tt.jsx)(V.O1,qt()(qt()({},Ye.props),{},{dots:Ye.data}))},Xt+"mapDots"):(0,Tt.jsx)(J.Z,{style:{height:"100%"},title:re!=null&&re.notitle?(0,Tt.jsx)("div",{style:{height:20}}):Ye.title,chart:We(Ye)},Xt+"chart")})]})})},nt=Lt},98129:function(ke,Se,k){"use strict";var pt=k(60690);ke.exports=function(qt){qt=qt||{};var q=qt.reporter,Zt=pt.getOption(qt,"async",!0),Bt=pt.getOption(qt,"auto",!0);Bt&&!Zt&&(q&&q.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),Zt=!0);var Wt=it(),ct,ee=!1;function K(ue,we){!ee&&Bt&&Zt&&Wt.size()===0&&ft(),Wt.add(ue,we)}function J(){for(ee=!0;Wt.size();){var ue=Wt;Wt=it(),ue.process()}ee=!1}function Ct(ue){ee||(ue===void 0&&(ue=Zt),ct&&(lt(ct),ct=null),ue?ft():J())}function ft(){ct=jt(J)}function mt(){Wt={},batchSize=0,topLevel=0,bottomLevel=0}function lt(ue){var we=clearTimeout;return we(ue)}function jt(ue){var we=function(Ne){return setTimeout(Ne,0)};return we(ue)}return{add:K,force:Ct}};function it(){var _t={},qt=0,q=0,Zt=0;function Bt(ee,K){K||(K=ee,ee=0),ee>q?q=ee:ee<Zt&&(Zt=ee),_t[ee]||(_t[ee]=[]),_t[ee].push(K),qt++}function Wt(){for(var ee=Zt;ee<=q;ee++)for(var K=_t[ee],J=0;J<K.length;J++){var Ct=K[J];Ct()}}function ct(){return qt}return{add:Bt,process:Wt,size:ct}}},60690:function(ke){"use strict";var Se=ke.exports={};Se.getOption=k;function k(pt,it,_t){var qt=pt[it];return qt==null&&_t!==void 0?_t:qt}},8874:function(ke){"use strict";ke.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(ke,Se,k){var pt=k(8874),it=k(86851),_t=Object.hasOwnProperty,qt=Object.create(null);for(var q in pt)_t.call(pt,q)&&(qt[pt[q]]=q);var Zt=ke.exports={to:{},get:{}};Zt.get=function(ct){var ee=ct.substring(0,3).toLowerCase(),K,J;switch(ee){case"hsl":K=Zt.get.hsl(ct),J="hsl";break;case"hwb":K=Zt.get.hwb(ct),J="hwb";break;default:K=Zt.get.rgb(ct),J="rgb";break}return K?{model:J,value:K}:null},Zt.get.rgb=function(ct){if(!ct)return null;var ee=/^#([a-f0-9]{3,4})$/i,K=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,J=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Ct=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,ft=/^(\w+)$/,mt=[0,0,0,1],lt,jt,ue;if(lt=ct.match(K)){for(ue=lt[2],lt=lt[1],jt=0;jt<3;jt++){var we=jt*2;mt[jt]=parseInt(lt.slice(we,we+2),16)}ue&&(mt[3]=parseInt(ue,16)/255)}else if(lt=ct.match(ee)){for(lt=lt[1],ue=lt[3],jt=0;jt<3;jt++)mt[jt]=parseInt(lt[jt]+lt[jt],16);ue&&(mt[3]=parseInt(ue+ue,16)/255)}else if(lt=ct.match(J)){for(jt=0;jt<3;jt++)mt[jt]=parseInt(lt[jt+1],0);lt[4]&&(lt[5]?mt[3]=parseFloat(lt[4])*.01:mt[3]=parseFloat(lt[4]))}else if(lt=ct.match(Ct)){for(jt=0;jt<3;jt++)mt[jt]=Math.round(parseFloat(lt[jt+1])*2.55);lt[4]&&(lt[5]?mt[3]=parseFloat(lt[4])*.01:mt[3]=parseFloat(lt[4]))}else return(lt=ct.match(ft))?lt[1]==="transparent"?[0,0,0,0]:_t.call(pt,lt[1])?(mt=pt[lt[1]],mt[3]=1,mt):null:null;for(jt=0;jt<3;jt++)mt[jt]=Bt(mt[jt],0,255);return mt[3]=Bt(mt[3],0,1),mt},Zt.get.hsl=function(ct){if(!ct)return null;var ee=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,K=ct.match(ee);if(K){var J=parseFloat(K[4]),Ct=(parseFloat(K[1])%360+360)%360,ft=Bt(parseFloat(K[2]),0,100),mt=Bt(parseFloat(K[3]),0,100),lt=Bt(isNaN(J)?1:J,0,1);return[Ct,ft,mt,lt]}return null},Zt.get.hwb=function(ct){if(!ct)return null;var ee=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,K=ct.match(ee);if(K){var J=parseFloat(K[4]),Ct=(parseFloat(K[1])%360+360)%360,ft=Bt(parseFloat(K[2]),0,100),mt=Bt(parseFloat(K[3]),0,100),lt=Bt(isNaN(J)?1:J,0,1);return[Ct,ft,mt,lt]}return null},Zt.to.hex=function(){var ct=it(arguments);return"#"+Wt(ct[0])+Wt(ct[1])+Wt(ct[2])+(ct[3]<1?Wt(Math.round(ct[3]*255)):"")},Zt.to.rgb=function(){var ct=it(arguments);return ct.length<4||ct[3]===1?"rgb("+Math.round(ct[0])+", "+Math.round(ct[1])+", "+Math.round(ct[2])+")":"rgba("+Math.round(ct[0])+", "+Math.round(ct[1])+", "+Math.round(ct[2])+", "+ct[3]+")"},Zt.to.rgb.percent=function(){var ct=it(arguments),ee=Math.round(ct[0]/255*100),K=Math.round(ct[1]/255*100),J=Math.round(ct[2]/255*100);return ct.length<4||ct[3]===1?"rgb("+ee+"%, "+K+"%, "+J+"%)":"rgba("+ee+"%, "+K+"%, "+J+"%, "+ct[3]+")"},Zt.to.hsl=function(){var ct=it(arguments);return ct.length<4||ct[3]===1?"hsl("+ct[0]+", "+ct[1]+"%, "+ct[2]+"%)":"hsla("+ct[0]+", "+ct[1]+"%, "+ct[2]+"%, "+ct[3]+")"},Zt.to.hwb=function(){var ct=it(arguments),ee="";return ct.length>=4&&ct[3]!==1&&(ee=", "+ct[3]),"hwb("+ct[0]+", "+ct[1]+"%, "+ct[2]+"%"+ee+")"},Zt.to.keyword=function(ct){return qt[ct.slice(0,3)]};function Bt(ct,ee,K){return Math.min(Math.max(ee,ct),K)}function Wt(ct){var ee=Math.round(ct).toString(16).toUpperCase();return ee.length<2?"0"+ee:ee}},9187:function(ke){"use strict";ke.exports=Se,ke.exports.default=Se;function Se(V,Mt,H){H=H||2;var N=Mt&&Mt.length,et=N?Mt[0]*H:V.length,ot=k(V,0,et,H,!0),At=[];if(!ot||ot.next===ot.prev)return At;var Dt,ie,Tt,zt,Oe,Lt,nt;if(N&&(ot=Bt(V,Mt,ot,H)),V.length>80*H){Dt=Tt=V[0],ie=zt=V[1];for(var Ft=H;Ft<et;Ft+=H)Oe=V[Ft],Lt=V[Ft+1],Oe<Dt&&(Dt=Oe),Lt<ie&&(ie=Lt),Oe>Tt&&(Tt=Oe),Lt>zt&&(zt=Lt);nt=Math.max(Tt-Dt,zt-ie),nt=nt!==0?32767/nt:0}return it(ot,At,H,Dt,ie,nt,0),At}function k(V,Mt,H,N,et){var ot,At;if(et===Rt(V,Mt,H,N)>0)for(ot=Mt;ot<H;ot+=N)At=_e(ot,V[ot],V[ot+1],At);else for(ot=H-N;ot>=Mt;ot-=N)At=_e(ot,V[ot],V[ot+1],At);return At&&we(At,At.next)&&(xe(At),At=At.next),At}function pt(V,Mt){if(!V)return V;Mt||(Mt=V);var H=V,N;do if(N=!1,!H.steiner&&(we(H,H.next)||ue(H.prev,H,H.next)===0)){if(xe(H),H=Mt=H.prev,H===H.next)break;N=!0}else H=H.next;while(N||H!==Mt);return Mt}function it(V,Mt,H,N,et,ot,At){if(V){!At&&ot&&J(V,N,et,ot);for(var Dt=V,ie,Tt;V.prev!==V.next;){if(ie=V.prev,Tt=V.next,ot?qt(V,N,et,ot):_t(V)){Mt.push(ie.i/H|0),Mt.push(V.i/H|0),Mt.push(Tt.i/H|0),xe(V),V=Tt.next,Dt=Tt.next;continue}if(V=Tt,V===Dt){At?At===1?(V=q(pt(V),Mt,H),it(V,Mt,H,N,et,ot,2)):At===2&&Zt(V,Mt,H,N,et,ot):it(pt(V),Mt,H,N,et,ot,1);break}}}}function _t(V){var Mt=V.prev,H=V,N=V.next;if(ue(Mt,H,N)>=0)return!1;for(var et=Mt.x,ot=H.x,At=N.x,Dt=Mt.y,ie=H.y,Tt=N.y,zt=et<ot?et<At?et:At:ot<At?ot:At,Oe=Dt<ie?Dt<Tt?Dt:Tt:ie<Tt?ie:Tt,Lt=et>ot?et>At?et:At:ot>At?ot:At,nt=Dt>ie?Dt>Tt?Dt:Tt:ie>Tt?ie:Tt,Ft=N.next;Ft!==Mt;){if(Ft.x>=zt&&Ft.x<=Lt&&Ft.y>=Oe&&Ft.y<=nt&&lt(et,Dt,ot,ie,At,Tt,Ft.x,Ft.y)&&ue(Ft.prev,Ft,Ft.next)>=0)return!1;Ft=Ft.next}return!0}function qt(V,Mt,H,N){var et=V.prev,ot=V,At=V.next;if(ue(et,ot,At)>=0)return!1;for(var Dt=et.x,ie=ot.x,Tt=At.x,zt=et.y,Oe=ot.y,Lt=At.y,nt=Dt<ie?Dt<Tt?Dt:Tt:ie<Tt?ie:Tt,Ft=zt<Oe?zt<Lt?zt:Lt:Oe<Lt?Oe:Lt,he=Dt>ie?Dt>Tt?Dt:Tt:ie>Tt?ie:Tt,yt=zt>Oe?zt>Lt?zt:Lt:Oe>Lt?Oe:Lt,St=ft(nt,Ft,Mt,H,N),F=ft(he,yt,Mt,H,N),T=V.prevZ,gt=V.nextZ;T&&T.z>=St&&gt&&gt.z<=F;){if(T.x>=nt&&T.x<=he&&T.y>=Ft&&T.y<=yt&&T!==et&&T!==At&&lt(Dt,zt,ie,Oe,Tt,Lt,T.x,T.y)&&ue(T.prev,T,T.next)>=0||(T=T.prevZ,gt.x>=nt&&gt.x<=he&&gt.y>=Ft&&gt.y<=yt&&gt!==et&&gt!==At&&lt(Dt,zt,ie,Oe,Tt,Lt,gt.x,gt.y)&&ue(gt.prev,gt,gt.next)>=0))return!1;gt=gt.nextZ}for(;T&&T.z>=St;){if(T.x>=nt&&T.x<=he&&T.y>=Ft&&T.y<=yt&&T!==et&&T!==At&&lt(Dt,zt,ie,Oe,Tt,Lt,T.x,T.y)&&ue(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;gt&&gt.z<=F;){if(gt.x>=nt&&gt.x<=he&&gt.y>=Ft&&gt.y<=yt&&gt!==et&&gt!==At&&lt(Dt,zt,ie,Oe,Tt,Lt,gt.x,gt.y)&&ue(gt.prev,gt,gt.next)>=0)return!1;gt=gt.nextZ}return!0}function q(V,Mt,H){var N=V;do{var et=N.prev,ot=N.next.next;!we(et,ot)&&Ne(et,N,N.next,ot)&&$(et,ot)&&$(ot,et)&&(Mt.push(et.i/H|0),Mt.push(N.i/H|0),Mt.push(ot.i/H|0),xe(N),xe(N.next),N=V=ot),N=N.next}while(N!==V);return pt(N)}function Zt(V,Mt,H,N,et,ot){var At=V;do{for(var Dt=At.next.next;Dt!==At.prev;){if(At.i!==Dt.i&&jt(At,Dt)){var ie=Gt(At,Dt);At=pt(At,At.next),ie=pt(ie,ie.next),it(At,Mt,H,N,et,ot,0),it(ie,Mt,H,N,et,ot,0);return}Dt=Dt.next}At=At.next}while(At!==V)}function Bt(V,Mt,H,N){var et=[],ot,At,Dt,ie,Tt;for(ot=0,At=Mt.length;ot<At;ot++)Dt=Mt[ot]*N,ie=ot<At-1?Mt[ot+1]*N:V.length,Tt=k(V,Dt,ie,N,!1),Tt===Tt.next&&(Tt.steiner=!0),et.push(mt(Tt));for(et.sort(Wt),ot=0;ot<et.length;ot++)H=ct(et[ot],H);return H}function Wt(V,Mt){return V.x-Mt.x}function ct(V,Mt){var H=ee(V,Mt);if(!H)return Mt;var N=Gt(H,V);return pt(N,N.next),pt(H,H.next)}function ee(V,Mt){var H=Mt,N=V.x,et=V.y,ot=-1/0,At;do{if(et<=H.y&&et>=H.next.y&&H.next.y!==H.y){var Dt=H.x+(et-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(Dt<=N&&Dt>ot&&(ot=Dt,At=H.x<H.next.x?H:H.next,Dt===N))return At}H=H.next}while(H!==Mt);if(!At)return null;var ie=At,Tt=At.x,zt=At.y,Oe=1/0,Lt;H=At;do N>=H.x&&H.x>=Tt&&N!==H.x&&lt(et<zt?N:ot,et,Tt,zt,et<zt?ot:N,et,H.x,H.y)&&(Lt=Math.abs(et-H.y)/(N-H.x),$(H,V)&&(Lt<Oe||Lt===Oe&&(H.x>At.x||H.x===At.x&&K(At,H)))&&(At=H,Oe=Lt)),H=H.next;while(H!==ie);return At}function K(V,Mt){return ue(V.prev,V,Mt.prev)<0&&ue(Mt.next,V,V.next)<0}function J(V,Mt,H,N){var et=V;do et.z===0&&(et.z=ft(et.x,et.y,Mt,H,N)),et.prevZ=et.prev,et.nextZ=et.next,et=et.next;while(et!==V);et.prevZ.nextZ=null,et.prevZ=null,Ct(et)}function Ct(V){var Mt,H,N,et,ot,At,Dt,ie,Tt=1;do{for(H=V,V=null,ot=null,At=0;H;){for(At++,N=H,Dt=0,Mt=0;Mt<Tt&&(Dt++,N=N.nextZ,!!N);Mt++);for(ie=Tt;Dt>0||ie>0&&N;)Dt!==0&&(ie===0||!N||H.z<=N.z)?(et=H,H=H.nextZ,Dt--):(et=N,N=N.nextZ,ie--),ot?ot.nextZ=et:V=et,et.prevZ=ot,ot=et;H=N}ot.nextZ=null,Tt*=2}while(At>1);return V}function ft(V,Mt,H,N,et){return V=(V-H)*et|0,Mt=(Mt-N)*et|0,V=(V|V<<8)&16711935,V=(V|V<<4)&252645135,V=(V|V<<2)&858993459,V=(V|V<<1)&1431655765,Mt=(Mt|Mt<<8)&16711935,Mt=(Mt|Mt<<4)&252645135,Mt=(Mt|Mt<<2)&858993459,Mt=(Mt|Mt<<1)&1431655765,V|Mt<<1}function mt(V){var Mt=V,H=V;do(Mt.x<H.x||Mt.x===H.x&&Mt.y<H.y)&&(H=Mt),Mt=Mt.next;while(Mt!==V);return H}function lt(V,Mt,H,N,et,ot,At,Dt){return(et-At)*(Mt-Dt)>=(V-At)*(ot-Dt)&&(V-At)*(N-Dt)>=(H-At)*(Mt-Dt)&&(H-At)*(ot-Dt)>=(et-At)*(N-Dt)}function jt(V,Mt){return V.next.i!==Mt.i&&V.prev.i!==Mt.i&&!Vt(V,Mt)&&($(V,Mt)&&$(Mt,V)&&ae(V,Mt)&&(ue(V.prev,V,Mt.prev)||ue(V,Mt.prev,Mt))||we(V,Mt)&&ue(V.prev,V,V.next)>0&&ue(Mt.prev,Mt,Mt.next)>0)}function ue(V,Mt,H){return(Mt.y-V.y)*(H.x-Mt.x)-(Mt.x-V.x)*(H.y-Mt.y)}function we(V,Mt){return V.x===Mt.x&&V.y===Mt.y}function Ne(V,Mt,H,N){var et=ye(ue(V,Mt,H)),ot=ye(ue(V,Mt,N)),At=ye(ue(H,N,V)),Dt=ye(ue(H,N,Mt));return!!(et!==ot&&At!==Dt||et===0&&Ge(V,H,Mt)||ot===0&&Ge(V,N,Mt)||At===0&&Ge(H,V,N)||Dt===0&&Ge(H,Mt,N))}function Ge(V,Mt,H){return Mt.x<=Math.max(V.x,H.x)&&Mt.x>=Math.min(V.x,H.x)&&Mt.y<=Math.max(V.y,H.y)&&Mt.y>=Math.min(V.y,H.y)}function ye(V){return V>0?1:V<0?-1:0}function Vt(V,Mt){var H=V;do{if(H.i!==V.i&&H.next.i!==V.i&&H.i!==Mt.i&&H.next.i!==Mt.i&&Ne(H,H.next,V,Mt))return!0;H=H.next}while(H!==V);return!1}function $(V,Mt){return ue(V.prev,V,V.next)<0?ue(V,Mt,V.next)>=0&&ue(V,V.prev,Mt)>=0:ue(V,Mt,V.prev)<0||ue(V,V.next,Mt)<0}function ae(V,Mt){var H=V,N=!1,et=(V.x+Mt.x)/2,ot=(V.y+Mt.y)/2;do H.y>ot!=H.next.y>ot&&H.next.y!==H.y&&et<(H.next.x-H.x)*(ot-H.y)/(H.next.y-H.y)+H.x&&(N=!N),H=H.next;while(H!==V);return N}function Gt(V,Mt){var H=new X(V.i,V.x,V.y),N=new X(Mt.i,Mt.x,Mt.y),et=V.next,ot=Mt.prev;return V.next=Mt,Mt.prev=V,H.next=et,et.prev=H,N.next=H,H.prev=N,ot.next=N,N.prev=ot,N}function _e(V,Mt,H,N){var et=new X(V,Mt,H);return N?(et.next=N.next,et.prev=N,N.next.prev=et,N.next=et):(et.prev=et,et.next=et),et}function xe(V){V.next.prev=V.prev,V.prev.next=V.next,V.prevZ&&(V.prevZ.nextZ=V.nextZ),V.nextZ&&(V.nextZ.prevZ=V.prevZ)}function X(V,Mt,H){this.i=V,this.x=Mt,this.y=H,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Se.deviation=function(V,Mt,H,N){var et=Mt&&Mt.length,ot=et?Mt[0]*H:V.length,At=Math.abs(Rt(V,0,ot,H));if(et)for(var Dt=0,ie=Mt.length;Dt<ie;Dt++){var Tt=Mt[Dt]*H,zt=Dt<ie-1?Mt[Dt+1]*H:V.length;At-=Math.abs(Rt(V,Tt,zt,H))}var Oe=0;for(Dt=0;Dt<N.length;Dt+=3){var Lt=N[Dt]*H,nt=N[Dt+1]*H,Ft=N[Dt+2]*H;Oe+=Math.abs((V[Lt]-V[Ft])*(V[nt+1]-V[Lt+1])-(V[Lt]-V[nt])*(V[Ft+1]-V[Lt+1]))}return At===0&&Oe===0?0:Math.abs((Oe-At)/At)};function Rt(V,Mt,H,N){for(var et=0,ot=Mt,At=H-N;ot<H;ot+=N)et+=(V[At]-V[ot])*(V[ot+1]+V[At+1]),At=ot;return et}Se.flatten=function(V){for(var Mt=V[0][0].length,H={vertices:[],holes:[],dimensions:Mt},N=0,et=0;et<V.length;et++){for(var ot=0;ot<V[et].length;ot++)for(var At=0;At<Mt;At++)H.vertices.push(V[et][ot][At]);et>0&&(N+=V[et-1].length,H.holes.push(N))}return H}},2268:function(ke){"use strict";var Se=ke.exports={};Se.isIE=function(k){function pt(){var _t=navigator.userAgent.toLowerCase();return _t.indexOf("msie")!==-1||_t.indexOf("trident")!==-1||_t.indexOf(" edge/")!==-1}if(!pt())return!1;if(!k)return!0;var it=function(){var _t,qt=3,q=document.createElement("div"),Zt=q.getElementsByTagName("i");do q.innerHTML="<!--[if gt IE "+ ++qt+"]><i></i><![endif]-->";while(Zt[0]);return qt>4?qt:_t}();return k===it},Se.isLegacyOpera=function(){return!!window.opera}},17900:function(ke){"use strict";var Se=ke.exports={};Se.forEach=function(k,pt){for(var it=0;it<k.length;it++){var _t=pt(k[it]);if(_t)return _t}}},58229:function(ke,Se,k){"use strict";var pt=k(2268);ke.exports=function(it){it=it||{};var _t=it.reporter,qt=it.batchProcessor,q=it.stateHandler.getState;if(!_t)throw new Error("Missing required dependency: reporter.");function Zt(K,J){function Ct(){J(K)}if(pt.isIE(8))q(K).object={proxy:Ct},K.attachEvent("onresize",Ct);else{var ft=ct(K);if(!ft)throw new Error("Element is not detectable by this strategy.");ft.contentDocument.defaultView.addEventListener("resize",Ct)}}function Bt(K){var J=it.important?" !important; ":"; ";return(K.join(J)+J).trim()}function Wt(K,J,Ct){Ct||(Ct=J,J=K,K=null),K=K||{};var ft=K.debug;function mt(lt,jt){var ue=Bt(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),we=!1,Ne=window.getComputedStyle(lt),Ge=lt.offsetWidth,ye=lt.offsetHeight;q(lt).startSize={width:Ge,height:ye};function Vt(){function $(){if(Ne.position==="static"){lt.style.setProperty("position","relative",K.important?"important":"");var _e=function(xe,X,Rt,V){function Mt(N){return N.replace(/[^-\d\.]/g,"")}var H=Rt[V];H!=="auto"&&Mt(H)!=="0"&&(xe.warn("An element that is positioned static has style."+V+"="+H+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+V+" will be set to 0. Element: ",X),X.style.setProperty(V,"0",K.important?"important":""))};_e(_t,lt,Ne,"top"),_e(_t,lt,Ne,"right"),_e(_t,lt,Ne,"bottom"),_e(_t,lt,Ne,"left")}}function ae(){we||$();function _e(X,Rt){if(!X.contentDocument){var V=q(X);V.checkForObjectDocumentTimeoutId&&window.clearTimeout(V.checkForObjectDocumentTimeoutId),V.checkForObjectDocumentTimeoutId=setTimeout(function(){V.checkForObjectDocumentTimeoutId=0,_e(X,Rt)},100);return}Rt(X.contentDocument)}var xe=this;_e(xe,function(Rt){jt(lt)})}Ne.position!==""&&($(Ne),we=!0);var Gt=document.createElement("object");Gt.style.cssText=ue,Gt.tabIndex=-1,Gt.type="text/html",Gt.setAttribute("aria-hidden","true"),Gt.onload=ae,pt.isIE()||(Gt.data="about:blank"),q(lt)&&(lt.appendChild(Gt),q(lt).object=Gt,pt.isIE()&&(Gt.data="about:blank"))}qt?qt.add(Vt):Vt()}pt.isIE(8)?Ct(J):mt(J,Ct)}function ct(K){return q(K).object}function ee(K){if(q(K)){var J=ct(K);J&&(pt.isIE(8)?K.detachEvent("onresize",J.proxy):K.removeChild(J),q(K).checkForObjectDocumentTimeoutId&&window.clearTimeout(q(K).checkForObjectDocumentTimeoutId),delete q(K).object)}}return{makeDetectable:Wt,addListener:Zt,uninstall:ee}}},60787:function(ke,Se,k){"use strict";var pt=k(17900).forEach;ke.exports=function(it){it=it||{};var _t=it.reporter,qt=it.batchProcessor,q=it.stateHandler.getState,Zt=it.stateHandler.hasState,Bt=it.idHandler;if(!qt)throw new Error("Missing required dependency: batchProcessor");if(!_t)throw new Error("Missing required dependency: reporter.");var Wt=Ct(),ct="erd_scroll_detection_scrollbar_style",ee="erd_scroll_detection_container";function K(Vt){ft(Vt,ct,ee)}K(window.document);function J(Vt){var $=it.important?" !important; ":"; ";return(Vt.join($)+$).trim()}function Ct(){var Vt=500,$=500,ae=document.createElement("div");ae.style.cssText=J(["position: absolute","width: "+Vt*2+"px","height: "+$*2+"px","visibility: hidden","margin: 0","padding: 0"]);var Gt=document.createElement("div");Gt.style.cssText=J(["position: absolute","width: "+Vt+"px","height: "+$+"px","overflow: scroll","visibility: none","top: "+-Vt*3+"px","left: "+-$*3+"px","visibility: hidden","margin: 0","padding: 0"]),Gt.appendChild(ae),document.body.insertBefore(Gt,document.body.firstChild);var _e=Vt-Gt.clientWidth,xe=$-Gt.clientHeight;return document.body.removeChild(Gt),{width:_e,height:xe}}function ft(Vt,$,ae){function Gt(Rt,V){V=V||function(H){Vt.head.appendChild(H)};var Mt=Vt.createElement("style");return Mt.innerHTML=Rt,Mt.id=$,V(Mt),Mt}if(!Vt.getElementById($)){var _e=ae+"_animation",xe=ae+"_animation_active",X=`/* Created by the element-resize-detector library. */
`;X+="."+ae+" > div::-webkit-scrollbar { "+J(["display: none"])+` }

`,X+="."+xe+" { "+J(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+_e,"animation-name: "+_e])+` }
`,X+="@-webkit-keyframes "+_e+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,X+="@keyframes "+_e+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",Gt(X)}}function mt(Vt){Vt.className+=" "+ee+"_animation_active"}function lt(Vt,$,ae){if(Vt.addEventListener)Vt.addEventListener($,ae);else if(Vt.attachEvent)Vt.attachEvent("on"+$,ae);else return _t.error("[scroll] Don't know how to add event listeners.")}function jt(Vt,$,ae){if(Vt.removeEventListener)Vt.removeEventListener($,ae);else if(Vt.detachEvent)Vt.detachEvent("on"+$,ae);else return _t.error("[scroll] Don't know how to remove event listeners.")}function ue(Vt){return q(Vt).container.childNodes[0].childNodes[0].childNodes[0]}function we(Vt){return q(Vt).container.childNodes[0].childNodes[0].childNodes[1]}function Ne(Vt,$){var ae=q(Vt).listeners;if(!ae.push)throw new Error("Cannot add listener to an element that is not detectable.");q(Vt).listeners.push($)}function Ge(Vt,$,ae){ae||(ae=$,$=Vt,Vt=null),Vt=Vt||{};function Gt(){if(Vt.debug){var St=Array.prototype.slice.call(arguments);if(St.unshift(Bt.get($),"Scroll: "),_t.log.apply)_t.log.apply(null,St);else for(var F=0;F<St.length;F++)_t.log(St[F])}}function _e(St){function F(T){var gt=T.getRootNode&&T.getRootNode().contains(T);return T===T.ownerDocument.body||T.ownerDocument.body.contains(T)||gt}return!F(St)||window.getComputedStyle(St)===null}function xe(St){var F=q(St).container.childNodes[0],T=window.getComputedStyle(F);return!T.width||T.width.indexOf("px")===-1}function X(){var St=window.getComputedStyle($),F={};return F.position=St.position,F.width=$.offsetWidth,F.height=$.offsetHeight,F.top=St.top,F.right=St.right,F.bottom=St.bottom,F.left=St.left,F.widthCSS=St.width,F.heightCSS=St.height,F}function Rt(){var St=X();q($).startSize={width:St.width,height:St.height},Gt("Element start size",q($).startSize)}function V(){q($).listeners=[]}function Mt(){if(Gt("storeStyle invoked."),!q($)){Gt("Aborting because element has been uninstalled");return}var St=X();q($).style=St}function H(St,F,T){q(St).lastWidth=F,q(St).lastHeight=T}function N(St){return ue(St).childNodes[0]}function et(){return 2*Wt.width+1}function ot(){return 2*Wt.height+1}function At(St){return St+10+et()}function Dt(St){return St+10+ot()}function ie(St){return St*2+et()}function Tt(St){return St*2+ot()}function zt(St,F,T){var gt=ue(St),ne=we(St),C=At(F),j=Dt(T),Pt=ie(F),Jt=Tt(T);gt.scrollLeft=C,gt.scrollTop=j,ne.scrollLeft=Pt,ne.scrollTop=Jt}function Oe(){var St=q($).container;if(!St){St=document.createElement("div"),St.className=ee,St.style.cssText=J(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),q($).container=St,mt(St),$.appendChild(St);var F=function(){q($).onRendered&&q($).onRendered()};lt(St,"animationstart",F),q($).onAnimationStart=F}return St}function Lt(){function St(){var le=q($).style;if(le.position==="static"){$.style.setProperty("position","relative",Vt.important?"important":"");var pe=function(Q,D,Z,tt){function Et(ce){return ce.replace(/[^-\d\.]/g,"")}var It=Z[tt];It!=="auto"&&Et(It)!=="0"&&(Q.warn("An element that is positioned static has style."+tt+"="+It+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+tt+" will be set to 0. Element: ",D),D.style[tt]=0)};pe(_t,$,le,"top"),pe(_t,$,le,"right"),pe(_t,$,le,"bottom"),pe(_t,$,le,"left")}}function F(le,pe,Q,D){return le=le?le+"px":"0",pe=pe?pe+"px":"0",Q=Q?Q+"px":"0",D=D?D+"px":"0",["left: "+le,"top: "+pe,"right: "+D,"bottom: "+Q]}if(Gt("Injecting elements"),!q($)){Gt("Aborting because element has been uninstalled");return}St();var T=q($).container;T||(T=Oe());var gt=Wt.width,ne=Wt.height,C=J(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),j=J(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(F(-(1+gt),-(1+ne),-ne,-gt))),Pt=J(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Jt=J(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),se=J(["position: absolute","left: 0","top: 0"]),Ae=J(["position: absolute","width: 200%","height: 200%"]),Le=document.createElement("div"),De=document.createElement("div"),Ve=document.createElement("div"),We=document.createElement("div"),$e=document.createElement("div"),Ye=document.createElement("div");Le.dir="ltr",Le.style.cssText=C,Le.className=ee,De.className=ee,De.style.cssText=j,Ve.style.cssText=Pt,We.style.cssText=se,$e.style.cssText=Jt,Ye.style.cssText=Ae,Ve.appendChild(We),$e.appendChild(Ye),De.appendChild(Ve),De.appendChild($e),Le.appendChild(De),T.appendChild(Le);function Xt(){var le=q($);le&&le.onExpand?le.onExpand():Gt("Aborting expand scroll handler: element has been uninstalled")}function re(){var le=q($);le&&le.onShrink?le.onShrink():Gt("Aborting shrink scroll handler: element has been uninstalled")}lt(Ve,"scroll",Xt),lt($e,"scroll",re),q($).onExpandScroll=Xt,q($).onShrinkScroll=re}function nt(){function St(Pt,Jt,se){var Ae=N(Pt),Le=At(Jt),De=Dt(se);Ae.style.setProperty("width",Le+"px",Vt.important?"important":""),Ae.style.setProperty("height",De+"px",Vt.important?"important":"")}function F(Pt){var Jt=$.offsetWidth,se=$.offsetHeight,Ae=Jt!==q($).lastWidth||se!==q($).lastHeight;Gt("Storing current size",Jt,se),H($,Jt,se),qt.add(0,function(){if(Ae){if(!q($)){Gt("Aborting because element has been uninstalled");return}if(!T()){Gt("Aborting because element container has not been initialized");return}if(Vt.debug){var De=$.offsetWidth,Ve=$.offsetHeight;(De!==Jt||Ve!==se)&&_t.warn(Bt.get($),"Scroll: Size changed before updating detector elements.")}St($,Jt,se)}}),qt.add(1,function(){if(!q($)){Gt("Aborting because element has been uninstalled");return}if(!T()){Gt("Aborting because element container has not been initialized");return}zt($,Jt,se)}),Ae&&Pt&&qt.add(2,function(){if(!q($)){Gt("Aborting because element has been uninstalled");return}if(!T()){Gt("Aborting because element container has not been initialized");return}Pt()})}function T(){return!!q($).container}function gt(){function Pt(){return q($).lastNotifiedWidth===void 0}Gt("notifyListenersIfNeeded invoked");var Jt=q($);if(Pt()&&Jt.lastWidth===Jt.startSize.width&&Jt.lastHeight===Jt.startSize.height)return Gt("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Jt.lastWidth===Jt.lastNotifiedWidth&&Jt.lastHeight===Jt.lastNotifiedHeight)return Gt("Not notifying: Size already notified");Gt("Current size not notified, notifying..."),Jt.lastNotifiedWidth=Jt.lastWidth,Jt.lastNotifiedHeight=Jt.lastHeight,pt(q($).listeners,function(se){se($)})}function ne(){if(Gt("startanimation triggered."),xe($)){Gt("Ignoring since element is still unrendered...");return}Gt("Element rendered.");var Pt=ue($),Jt=we($);(Pt.scrollLeft===0||Pt.scrollTop===0||Jt.scrollLeft===0||Jt.scrollTop===0)&&(Gt("Scrollbars out of sync. Updating detector elements..."),F(gt))}function C(){if(Gt("Scroll detected."),xe($)){Gt("Scroll event fired while unrendered. Ignoring...");return}F(gt)}if(Gt("registerListenersAndPositionElements invoked."),!q($)){Gt("Aborting because element has been uninstalled");return}q($).onRendered=ne,q($).onExpand=C,q($).onShrink=C;var j=q($).style;St($,j.width,j.height)}function Ft(){if(Gt("finalizeDomMutation invoked."),!q($)){Gt("Aborting because element has been uninstalled");return}var St=q($).style;H($,St.width,St.height),zt($,St.width,St.height)}function he(){ae($)}function yt(){Gt("Installing..."),V(),Rt(),qt.add(0,Mt),qt.add(1,Lt),qt.add(2,nt),qt.add(3,Ft),qt.add(4,he)}Gt("Making detectable..."),_e($)?(Gt("Element is detached"),Oe(),Gt("Waiting until element is attached..."),q($).onRendered=function(){Gt("Element is now attached"),yt()}):yt()}function ye(Vt){var $=q(Vt);$&&($.onExpandScroll&&jt(ue(Vt),"scroll",$.onExpandScroll),$.onShrinkScroll&&jt(we(Vt),"scroll",$.onShrinkScroll),$.onAnimationStart&&jt($.container,"animationstart",$.onAnimationStart),$.container&&Vt.removeChild($.container))}return{makeDetectable:Ge,addListener:Ne,uninstall:ye,initDocument:K}}},63844:function(ke,Se,k){"use strict";var pt=k(17900).forEach,it=k(68452),_t=k(96199),qt=k(75805),q=k(79799),Zt=k(71724),Bt=k(2268),Wt=k(98129),ct=k(64258),ee=k(58229),K=k(60787);function J(lt){return Array.isArray(lt)||lt.length!==void 0}function Ct(lt){if(Array.isArray(lt))return lt;var jt=[];return pt(lt,function(ue){jt.push(ue)}),jt}function ft(lt){return lt&&lt.nodeType===1}ke.exports=function(lt){lt=lt||{};var jt;if(lt.idHandler)jt={get:function(N){return lt.idHandler.get(N,!0)},set:lt.idHandler.set};else{var ue=qt(),we=q({idGenerator:ue,stateHandler:ct});jt=we}var Ne=lt.reporter;if(!Ne){var Ge=Ne===!1;Ne=Zt(Ge)}var ye=mt(lt,"batchProcessor",Wt({reporter:Ne})),Vt={};Vt.callOnAdd=!!mt(lt,"callOnAdd",!0),Vt.debug=!!mt(lt,"debug",!1);var $=_t(jt),ae=it({stateHandler:ct}),Gt,_e=mt(lt,"strategy","object"),xe=mt(lt,"important",!1),X={reporter:Ne,batchProcessor:ye,stateHandler:ct,idHandler:jt,important:xe};if(_e==="scroll"&&(Bt.isLegacyOpera()?(Ne.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),_e="object"):Bt.isIE(9)&&(Ne.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),_e="object")),_e==="scroll")Gt=K(X);else if(_e==="object")Gt=ee(X);else throw new Error("Invalid strategy name: "+_e);var Rt={};function V(N,et,ot){function At(Lt){var nt=$.get(Lt);pt(nt,function(he){he(Lt)})}function Dt(Lt,nt,Ft){$.add(nt,Ft),Lt&&Ft(nt)}if(ot||(ot=et,et=N,N={}),!et)throw new Error("At least one element required.");if(!ot)throw new Error("Listener required.");if(ft(et))et=[et];else if(J(et))et=Ct(et);else return Ne.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var ie=0,Tt=mt(N,"callOnAdd",Vt.callOnAdd),zt=mt(N,"onReady",function(){}),Oe=mt(N,"debug",Vt.debug);pt(et,function(nt){ct.getState(nt)||(ct.initState(nt),jt.set(nt));var Ft=jt.get(nt);if(Oe&&Ne.log("Attaching listener to element",Ft,nt),!ae.isDetectable(nt)){if(Oe&&Ne.log(Ft,"Not detectable."),ae.isBusy(nt)){Oe&&Ne.log(Ft,"System busy making it detectable"),Dt(Tt,nt,ot),Rt[Ft]=Rt[Ft]||[],Rt[Ft].push(function(){ie++,ie===et.length&&zt()});return}return Oe&&Ne.log(Ft,"Making detectable..."),ae.markBusy(nt,!0),Gt.makeDetectable({debug:Oe,important:xe},nt,function(yt){if(Oe&&Ne.log(Ft,"onElementDetectable"),ct.getState(yt)){ae.markAsDetectable(yt),ae.markBusy(yt,!1),Gt.addListener(yt,At),Dt(Tt,yt,ot);var St=ct.getState(yt);if(St&&St.startSize){var F=yt.offsetWidth,T=yt.offsetHeight;(St.startSize.width!==F||St.startSize.height!==T)&&At(yt)}Rt[Ft]&&pt(Rt[Ft],function(gt){gt()})}else Oe&&Ne.log(Ft,"Element uninstalled before being detectable.");delete Rt[Ft],ie++,ie===et.length&&zt()})}Oe&&Ne.log(Ft,"Already detecable, adding listener."),Dt(Tt,nt,ot),ie++}),ie===et.length&&zt()}function Mt(N){if(!N)return Ne.error("At least one element is required.");if(ft(N))N=[N];else if(J(N))N=Ct(N);else return Ne.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");pt(N,function(et){$.removeAllListeners(et),Gt.uninstall(et),ct.cleanState(et)})}function H(N){Gt.initDocument&&Gt.initDocument(N)}return{listenTo:V,removeListener:$.removeListener,removeAllListeners:$.removeAllListeners,uninstall:Mt,initDocument:H}};function mt(lt,jt,ue){var we=lt[jt];return we==null&&ue!==void 0?ue:we}},68452:function(ke){"use strict";ke.exports=function(Se){var k=Se.stateHandler.getState;function pt(q){var Zt=k(q);return Zt&&!!Zt.isDetectable}function it(q){k(q).isDetectable=!0}function _t(q){return!!k(q).busy}function qt(q,Zt){k(q).busy=!!Zt}return{isDetectable:pt,markAsDetectable:it,isBusy:_t,markBusy:qt}}},75805:function(ke){"use strict";ke.exports=function(){var Se=1;function k(){return Se++}return{generate:k}}},79799:function(ke){"use strict";ke.exports=function(Se){var k=Se.idGenerator,pt=Se.stateHandler.getState;function it(qt){var q=pt(qt);return q&&q.id!==void 0?q.id:null}function _t(qt){var q=pt(qt);if(!q)throw new Error("setId required the element to have a resize detection state.");var Zt=k.generate();return q.id=Zt,Zt}return{get:it,set:_t}}},96199:function(ke){"use strict";ke.exports=function(Se){var k={};function pt(q){var Zt=Se.get(q);return Zt===void 0?[]:k[Zt]||[]}function it(q,Zt){var Bt=Se.get(q);k[Bt]||(k[Bt]=[]),k[Bt].push(Zt)}function _t(q,Zt){for(var Bt=pt(q),Wt=0,ct=Bt.length;Wt<ct;++Wt)if(Bt[Wt]===Zt){Bt.splice(Wt,1);break}}function qt(q){var Zt=pt(q);Zt&&(Zt.length=0)}return{get:pt,add:it,removeListener:_t,removeAllListeners:qt}}},71724:function(ke){"use strict";ke.exports=function(Se){function k(){}var pt={log:k,warn:k,error:k};if(!Se&&window.console){var it=function(_t,qt){_t[qt]=function(){var Zt=console[qt];if(Zt.apply)Zt.apply(console,arguments);else for(var Bt=0;Bt<arguments.length;Bt++)Zt(arguments[Bt])}};it(pt,"log"),it(pt,"warn"),it(pt,"error")}return pt}},64258:function(ke){"use strict";var Se="_erd";function k(_t){return _t[Se]={},pt(_t)}function pt(_t){return _t[Se]}function it(_t){delete _t[Se]}ke.exports={initState:k,getState:pt,cleanState:it}},26729:function(ke){"use strict";var Se=Object.prototype.hasOwnProperty,k="~";function pt(){}Object.create&&(pt.prototype=Object.create(null),new pt().__proto__||(k=!1));function it(Zt,Bt,Wt){this.fn=Zt,this.context=Bt,this.once=Wt||!1}function _t(Zt,Bt,Wt,ct,ee){if(typeof Wt!="function")throw new TypeError("The listener must be a function");var K=new it(Wt,ct||Zt,ee),J=k?k+Bt:Bt;return Zt._events[J]?Zt._events[J].fn?Zt._events[J]=[Zt._events[J],K]:Zt._events[J].push(K):(Zt._events[J]=K,Zt._eventsCount++),Zt}function qt(Zt,Bt){--Zt._eventsCount===0?Zt._events=new pt:delete Zt._events[Bt]}function q(){this._events=new pt,this._eventsCount=0}q.prototype.eventNames=function(){var Bt=[],Wt,ct;if(this._eventsCount===0)return Bt;for(ct in Wt=this._events)Se.call(Wt,ct)&&Bt.push(k?ct.slice(1):ct);return Object.getOwnPropertySymbols?Bt.concat(Object.getOwnPropertySymbols(Wt)):Bt},q.prototype.listeners=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];if(!ct)return[];if(ct.fn)return[ct.fn];for(var ee=0,K=ct.length,J=new Array(K);ee<K;ee++)J[ee]=ct[ee].fn;return J},q.prototype.listenerCount=function(Bt){var Wt=k?k+Bt:Bt,ct=this._events[Wt];return ct?ct.fn?1:ct.length:0},q.prototype.emit=function(Bt,Wt,ct,ee,K,J){var Ct=k?k+Bt:Bt;if(!this._events[Ct])return!1;var ft=this._events[Ct],mt=arguments.length,lt,jt;if(ft.fn){switch(ft.once&&this.removeListener(Bt,ft.fn,void 0,!0),mt){case 1:return ft.fn.call(ft.context),!0;case 2:return ft.fn.call(ft.context,Wt),!0;case 3:return ft.fn.call(ft.context,Wt,ct),!0;case 4:return ft.fn.call(ft.context,Wt,ct,ee),!0;case 5:return ft.fn.call(ft.context,Wt,ct,ee,K),!0;case 6:return ft.fn.call(ft.context,Wt,ct,ee,K,J),!0}for(jt=1,lt=new Array(mt-1);jt<mt;jt++)lt[jt-1]=arguments[jt];ft.fn.apply(ft.context,lt)}else{var ue=ft.length,we;for(jt=0;jt<ue;jt++)switch(ft[jt].once&&this.removeListener(Bt,ft[jt].fn,void 0,!0),mt){case 1:ft[jt].fn.call(ft[jt].context);break;case 2:ft[jt].fn.call(ft[jt].context,Wt);break;case 3:ft[jt].fn.call(ft[jt].context,Wt,ct);break;case 4:ft[jt].fn.call(ft[jt].context,Wt,ct,ee);break;default:if(!lt)for(we=1,lt=new Array(mt-1);we<mt;we++)lt[we-1]=arguments[we];ft[jt].fn.apply(ft[jt].context,lt)}}return!0},q.prototype.on=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!1)},q.prototype.once=function(Bt,Wt,ct){return _t(this,Bt,Wt,ct,!0)},q.prototype.removeListener=function(Bt,Wt,ct,ee){var K=k?k+Bt:Bt;if(!this._events[K])return this;if(!Wt)return qt(this,K),this;var J=this._events[K];if(J.fn)J.fn===Wt&&(!ee||J.once)&&(!ct||J.context===ct)&&qt(this,K);else{for(var Ct=0,ft=[],mt=J.length;Ct<mt;Ct++)(J[Ct].fn!==Wt||ee&&!J[Ct].once||ct&&J[Ct].context!==ct)&&ft.push(J[Ct]);ft.length?this._events[K]=ft.length===1?ft[0]:ft:qt(this,K)}return this},q.prototype.removeAllListeners=function(Bt){var Wt;return Bt?(Wt=k?k+Bt:Bt,this._events[Wt]&&qt(this,Wt)):(this._events=new pt,this._eventsCount=0),this},q.prototype.off=q.prototype.removeListener,q.prototype.addListener=q.prototype.on,q.prefixed=k,q.EventEmitter=q,ke.exports=q},69916:function(ke,Se){(function(k,pt){pt(Se)})(this,function(k){"use strict";function pt(Ct,ft,mt,lt){lt=lt||{};var jt=lt.maxIterations||100,ue=lt.tolerance||1e-10,we=Ct(ft),Ne=Ct(mt),Ge=mt-ft;if(we*Ne>0)throw"Initial bisect points must have opposite signs";if(we===0)return ft;if(Ne===0)return mt;for(var ye=0;ye<jt;++ye){Ge/=2;var Vt=ft+Ge,$=Ct(Vt);if($*we>=0&&(ft=Vt),Math.abs(Ge)<ue||$===0)return Vt}return ft+Ge}function it(Ct){for(var ft=new Array(Ct),mt=0;mt<Ct;++mt)ft[mt]=0;return ft}function _t(Ct,ft){return it(Ct).map(function(){return it(ft)})}function qt(Ct,ft){for(var mt=0,lt=0;lt<Ct.length;++lt)mt+=Ct[lt]*ft[lt];return mt}function q(Ct){return Math.sqrt(qt(Ct,Ct))}function Zt(Ct,ft,mt){for(var lt=0;lt<ft.length;++lt)Ct[lt]=ft[lt]*mt}function Bt(Ct,ft,mt,lt,jt){for(var ue=0;ue<Ct.length;++ue)Ct[ue]=ft*mt[ue]+lt*jt[ue]}function Wt(Ct,ft,mt){mt=mt||{};var lt=mt.maxIterations||ft.length*200,jt=mt.nonZeroDelta||1.05,ue=mt.zeroDelta||.001,we=mt.minErrorDelta||1e-6,Ne=mt.minErrorDelta||1e-5,Ge=mt.rho!==void 0?mt.rho:1,ye=mt.chi!==void 0?mt.chi:2,Vt=mt.psi!==void 0?mt.psi:-.5,$=mt.sigma!==void 0?mt.sigma:.5,ae,Gt=ft.length,_e=new Array(Gt+1);_e[0]=ft,_e[0].fx=Ct(ft),_e[0].id=0;for(var xe=0;xe<Gt;++xe){var X=ft.slice();X[xe]=X[xe]?X[xe]*jt:ue,_e[xe+1]=X,_e[xe+1].fx=Ct(X),_e[xe+1].id=xe+1}function Rt(zt){for(var Oe=0;Oe<zt.length;Oe++)_e[Gt][Oe]=zt[Oe];_e[Gt].fx=zt.fx}for(var V=function(zt,Oe){return zt.fx-Oe.fx},Mt=ft.slice(),H=ft.slice(),N=ft.slice(),et=ft.slice(),ot=0;ot<lt;++ot){if(_e.sort(V),mt.history){var At=_e.map(function(zt){var Oe=zt.slice();return Oe.fx=zt.fx,Oe.id=zt.id,Oe});At.sort(function(zt,Oe){return zt.id-Oe.id}),mt.history.push({x:_e[0].slice(),fx:_e[0].fx,simplex:At})}for(ae=0,xe=0;xe<Gt;++xe)ae=Math.max(ae,Math.abs(_e[0][xe]-_e[1][xe]));if(Math.abs(_e[0].fx-_e[Gt].fx)<we&&ae<Ne)break;for(xe=0;xe<Gt;++xe){Mt[xe]=0;for(var Dt=0;Dt<Gt;++Dt)Mt[xe]+=_e[Dt][xe];Mt[xe]/=Gt}var ie=_e[Gt];if(Bt(H,1+Ge,Mt,-Ge,ie),H.fx=Ct(H),H.fx<_e[0].fx)Bt(et,1+ye,Mt,-ye,ie),et.fx=Ct(et),et.fx<H.fx?Rt(et):Rt(H);else if(H.fx>=_e[Gt-1].fx){var Tt=!1;if(H.fx>ie.fx?(Bt(N,1+Vt,Mt,-Vt,ie),N.fx=Ct(N),N.fx<ie.fx?Rt(N):Tt=!0):(Bt(N,1-Vt*Ge,Mt,Vt*Ge,ie),N.fx=Ct(N),N.fx<H.fx?Rt(N):Tt=!0),Tt){if($>=1)break;for(xe=1;xe<_e.length;++xe)Bt(_e[xe],1-$,_e[0],$,_e[xe]),_e[xe].fx=Ct(_e[xe])}}else Rt(H)}return _e.sort(V),{fx:_e[0].fx,x:_e[0]}}function ct(Ct,ft,mt,lt,jt,ue,we){var Ne=mt.fx,Ge=qt(mt.fxprime,ft),ye=Ne,Vt=Ne,$=Ge,ae=0;jt=jt||1,ue=ue||1e-6,we=we||.1;function Gt(xe,X,Rt){for(var V=0;V<16;++V)if(jt=(xe+X)/2,Bt(lt.x,1,mt.x,jt,ft),ye=lt.fx=Ct(lt.x,lt.fxprime),$=qt(lt.fxprime,ft),ye>Ne+ue*jt*Ge||ye>=Rt)X=jt;else{if(Math.abs($)<=-we*Ge)return jt;$*(X-xe)>=0&&(X=xe),xe=jt,Rt=ye}return 0}for(var _e=0;_e<10;++_e){if(Bt(lt.x,1,mt.x,jt,ft),ye=lt.fx=Ct(lt.x,lt.fxprime),$=qt(lt.fxprime,ft),ye>Ne+ue*jt*Ge||_e&&ye>=Vt)return Gt(ae,jt,Vt);if(Math.abs($)<=-we*Ge)return jt;if($>=0)return Gt(jt,ae,ye);Vt=ye,ae=jt,jt*=2}return jt}function ee(Ct,ft,mt){var lt={x:ft.slice(),fx:0,fxprime:ft.slice()},jt={x:ft.slice(),fx:0,fxprime:ft.slice()},ue=ft.slice(),we,Ne,Ge=1,ye;mt=mt||{},ye=mt.maxIterations||ft.length*20,lt.fx=Ct(lt.x,lt.fxprime),we=lt.fxprime.slice(),Zt(we,lt.fxprime,-1);for(var Vt=0;Vt<ye;++Vt){if(Ge=ct(Ct,we,lt,jt,Ge),mt.history&&mt.history.push({x:lt.x.slice(),fx:lt.fx,fxprime:lt.fxprime.slice(),alpha:Ge}),!Ge)Zt(we,lt.fxprime,-1);else{Bt(ue,1,jt.fxprime,-1,lt.fxprime);var $=qt(lt.fxprime,lt.fxprime),ae=Math.max(0,qt(ue,jt.fxprime)/$);Bt(we,ae,we,-1,jt.fxprime),Ne=lt,lt=jt,jt=Ne}if(q(lt.fxprime)<=1e-5)break}return mt.history&&mt.history.push({x:lt.x.slice(),fx:lt.fx,fxprime:lt.fxprime.slice(),alpha:Ge}),lt}function K(Ct,ft,mt){mt=mt||{};for(var lt=mt.maxIterations||ft.length*100,jt=mt.learnRate||.001,ue={x:ft.slice(),fx:0,fxprime:ft.slice()},we=0;we<lt&&(ue.fx=Ct(ue.x,ue.fxprime),mt.history&&mt.history.push({x:ue.x.slice(),fx:ue.fx,fxprime:ue.fxprime.slice()}),Bt(ue.x,1,ue.x,-jt,ue.fxprime),!(q(ue.fxprime)<=1e-5));++we);return ue}function J(Ct,ft,mt){mt=mt||{};var lt={x:ft.slice(),fx:0,fxprime:ft.slice()},jt={x:ft.slice(),fx:0,fxprime:ft.slice()},ue=mt.maxIterations||ft.length*100,we=mt.learnRate||1,Ne=ft.slice(),Ge=mt.c1||.001,ye=mt.c2||.1,Vt,$=[];if(mt.history){var ae=Ct;Ct=function(_e,xe){return $.push(_e.slice()),ae(_e,xe)}}lt.fx=Ct(lt.x,lt.fxprime);for(var Gt=0;Gt<ue&&(Zt(Ne,lt.fxprime,-1),we=ct(Ct,Ne,lt,jt,we,Ge,ye),mt.history&&(mt.history.push({x:lt.x.slice(),fx:lt.fx,fxprime:lt.fxprime.slice(),functionCalls:$,learnRate:we,alpha:we}),$=[]),Vt=lt,lt=jt,jt=Vt,!(we===0||q(lt.fxprime)<1e-5));++Gt);return lt}k.bisect=pt,k.nelderMead=Wt,k.conjugateGradient=ee,k.gradientDescent=K,k.gradientDescentLineSearch=J,k.zeros=it,k.zerosM=_t,k.norm2=q,k.weightedSum=Bt,k.scale=Zt})},49685:function(ke,Se,k){"use strict";k.d(Se,{Ib:function(){return pt},WT:function(){return it}});var pt=1e-6,it=typeof Float32Array!="undefined"?Float32Array:Array,_t=Math.random;function qt(Wt){it=Wt}var q=Math.PI/180;function Zt(Wt){return Wt*q}function Bt(Wt,ct){return Math.abs(Wt-ct)<=pt*Math.max(1,Math.abs(Wt),Math.abs(ct))}Math.hypot||(Math.hypot=function(){for(var Wt=0,ct=arguments.length;ct--;)Wt+=arguments[ct]*arguments[ct];return Math.sqrt(Wt)})},35600:function(ke,Se,k){"use strict";k.d(Se,{Ue:function(){return it},al:function(){return Zt},xO:function(){return _t}});var pt=k(49685);function it(){var N=new pt.WT(9);return pt.WT!=Float32Array&&(N[1]=0,N[2]=0,N[3]=0,N[5]=0,N[6]=0,N[7]=0),N[0]=1,N[4]=1,N[8]=1,N}function _t(N,et){return N[0]=et[0],N[1]=et[1],N[2]=et[2],N[3]=et[4],N[4]=et[5],N[5]=et[6],N[6]=et[8],N[7]=et[9],N[8]=et[10],N}function qt(N){var et=new glMatrix.ARRAY_TYPE(9);return et[0]=N[0],et[1]=N[1],et[2]=N[2],et[3]=N[3],et[4]=N[4],et[5]=N[5],et[6]=N[6],et[7]=N[7],et[8]=N[8],et}function q(N,et){return N[0]=et[0],N[1]=et[1],N[2]=et[2],N[3]=et[3],N[4]=et[4],N[5]=et[5],N[6]=et[6],N[7]=et[7],N[8]=et[8],N}function Zt(N,et,ot,At,Dt,ie,Tt,zt,Oe){var Lt=new pt.WT(9);return Lt[0]=N,Lt[1]=et,Lt[2]=ot,Lt[3]=At,Lt[4]=Dt,Lt[5]=ie,Lt[6]=Tt,Lt[7]=zt,Lt[8]=Oe,Lt}function Bt(N,et,ot,At,Dt,ie,Tt,zt,Oe,Lt){return N[0]=et,N[1]=ot,N[2]=At,N[3]=Dt,N[4]=ie,N[5]=Tt,N[6]=zt,N[7]=Oe,N[8]=Lt,N}function Wt(N){return N[0]=1,N[1]=0,N[2]=0,N[3]=0,N[4]=1,N[5]=0,N[6]=0,N[7]=0,N[8]=1,N}function ct(N,et){if(N===et){var ot=et[1],At=et[2],Dt=et[5];N[1]=et[3],N[2]=et[6],N[3]=ot,N[5]=et[7],N[6]=At,N[7]=Dt}else N[0]=et[0],N[1]=et[3],N[2]=et[6],N[3]=et[1],N[4]=et[4],N[5]=et[7],N[6]=et[2],N[7]=et[5],N[8]=et[8];return N}function ee(N,et){var ot=et[0],At=et[1],Dt=et[2],ie=et[3],Tt=et[4],zt=et[5],Oe=et[6],Lt=et[7],nt=et[8],Ft=nt*Tt-zt*Lt,he=-nt*ie+zt*Oe,yt=Lt*ie-Tt*Oe,St=ot*Ft+At*he+Dt*yt;return St?(St=1/St,N[0]=Ft*St,N[1]=(-nt*At+Dt*Lt)*St,N[2]=(zt*At-Dt*Tt)*St,N[3]=he*St,N[4]=(nt*ot-Dt*Oe)*St,N[5]=(-zt*ot+Dt*ie)*St,N[6]=yt*St,N[7]=(-Lt*ot+At*Oe)*St,N[8]=(Tt*ot-At*ie)*St,N):null}function K(N,et){var ot=et[0],At=et[1],Dt=et[2],ie=et[3],Tt=et[4],zt=et[5],Oe=et[6],Lt=et[7],nt=et[8];return N[0]=Tt*nt-zt*Lt,N[1]=Dt*Lt-At*nt,N[2]=At*zt-Dt*Tt,N[3]=zt*Oe-ie*nt,N[4]=ot*nt-Dt*Oe,N[5]=Dt*ie-ot*zt,N[6]=ie*Lt-Tt*Oe,N[7]=At*Oe-ot*Lt,N[8]=ot*Tt-At*ie,N}function J(N){var et=N[0],ot=N[1],At=N[2],Dt=N[3],ie=N[4],Tt=N[5],zt=N[6],Oe=N[7],Lt=N[8];return et*(Lt*ie-Tt*Oe)+ot*(-Lt*Dt+Tt*zt)+At*(Oe*Dt-ie*zt)}function Ct(N,et,ot){var At=et[0],Dt=et[1],ie=et[2],Tt=et[3],zt=et[4],Oe=et[5],Lt=et[6],nt=et[7],Ft=et[8],he=ot[0],yt=ot[1],St=ot[2],F=ot[3],T=ot[4],gt=ot[5],ne=ot[6],C=ot[7],j=ot[8];return N[0]=he*At+yt*Tt+St*Lt,N[1]=he*Dt+yt*zt+St*nt,N[2]=he*ie+yt*Oe+St*Ft,N[3]=F*At+T*Tt+gt*Lt,N[4]=F*Dt+T*zt+gt*nt,N[5]=F*ie+T*Oe+gt*Ft,N[6]=ne*At+C*Tt+j*Lt,N[7]=ne*Dt+C*zt+j*nt,N[8]=ne*ie+C*Oe+j*Ft,N}function ft(N,et,ot){var At=et[0],Dt=et[1],ie=et[2],Tt=et[3],zt=et[4],Oe=et[5],Lt=et[6],nt=et[7],Ft=et[8],he=ot[0],yt=ot[1];return N[0]=At,N[1]=Dt,N[2]=ie,N[3]=Tt,N[4]=zt,N[5]=Oe,N[6]=he*At+yt*Tt+Lt,N[7]=he*Dt+yt*zt+nt,N[8]=he*ie+yt*Oe+Ft,N}function mt(N,et,ot){var At=et[0],Dt=et[1],ie=et[2],Tt=et[3],zt=et[4],Oe=et[5],Lt=et[6],nt=et[7],Ft=et[8],he=Math.sin(ot),yt=Math.cos(ot);return N[0]=yt*At+he*Tt,N[1]=yt*Dt+he*zt,N[2]=yt*ie+he*Oe,N[3]=yt*Tt-he*At,N[4]=yt*zt-he*Dt,N[5]=yt*Oe-he*ie,N[6]=Lt,N[7]=nt,N[8]=Ft,N}function lt(N,et,ot){var At=ot[0],Dt=ot[1];return N[0]=At*et[0],N[1]=At*et[1],N[2]=At*et[2],N[3]=Dt*et[3],N[4]=Dt*et[4],N[5]=Dt*et[5],N[6]=et[6],N[7]=et[7],N[8]=et[8],N}function jt(N,et){return N[0]=1,N[1]=0,N[2]=0,N[3]=0,N[4]=1,N[5]=0,N[6]=et[0],N[7]=et[1],N[8]=1,N}function ue(N,et){var ot=Math.sin(et),At=Math.cos(et);return N[0]=At,N[1]=ot,N[2]=0,N[3]=-ot,N[4]=At,N[5]=0,N[6]=0,N[7]=0,N[8]=1,N}function we(N,et){return N[0]=et[0],N[1]=0,N[2]=0,N[3]=0,N[4]=et[1],N[5]=0,N[6]=0,N[7]=0,N[8]=1,N}function Ne(N,et){return N[0]=et[0],N[1]=et[1],N[2]=0,N[3]=et[2],N[4]=et[3],N[5]=0,N[6]=et[4],N[7]=et[5],N[8]=1,N}function Ge(N,et){var ot=et[0],At=et[1],Dt=et[2],ie=et[3],Tt=ot+ot,zt=At+At,Oe=Dt+Dt,Lt=ot*Tt,nt=At*Tt,Ft=At*zt,he=Dt*Tt,yt=Dt*zt,St=Dt*Oe,F=ie*Tt,T=ie*zt,gt=ie*Oe;return N[0]=1-Ft-St,N[3]=nt-gt,N[6]=he+T,N[1]=nt+gt,N[4]=1-Lt-St,N[7]=yt-F,N[2]=he-T,N[5]=yt+F,N[8]=1-Lt-Ft,N}function ye(N,et){var ot=et[0],At=et[1],Dt=et[2],ie=et[3],Tt=et[4],zt=et[5],Oe=et[6],Lt=et[7],nt=et[8],Ft=et[9],he=et[10],yt=et[11],St=et[12],F=et[13],T=et[14],gt=et[15],ne=ot*zt-At*Tt,C=ot*Oe-Dt*Tt,j=ot*Lt-ie*Tt,Pt=At*Oe-Dt*zt,Jt=At*Lt-ie*zt,se=Dt*Lt-ie*Oe,Ae=nt*F-Ft*St,Le=nt*T-he*St,De=nt*gt-yt*St,Ve=Ft*T-he*F,We=Ft*gt-yt*F,$e=he*gt-yt*T,Ye=ne*$e-C*We+j*Ve+Pt*De-Jt*Le+se*Ae;return Ye?(Ye=1/Ye,N[0]=(zt*$e-Oe*We+Lt*Ve)*Ye,N[1]=(Oe*De-Tt*$e-Lt*Le)*Ye,N[2]=(Tt*We-zt*De+Lt*Ae)*Ye,N[3]=(Dt*We-At*$e-ie*Ve)*Ye,N[4]=(ot*$e-Dt*De+ie*Le)*Ye,N[5]=(At*De-ot*We-ie*Ae)*Ye,N[6]=(F*se-T*Jt+gt*Pt)*Ye,N[7]=(T*j-St*se-gt*C)*Ye,N[8]=(St*Jt-F*j+gt*ne)*Ye,N):null}function Vt(N,et,ot){return N[0]=2/et,N[1]=0,N[2]=0,N[3]=0,N[4]=-2/ot,N[5]=0,N[6]=-1,N[7]=1,N[8]=1,N}function $(N){return"mat3("+N[0]+", "+N[1]+", "+N[2]+", "+N[3]+", "+N[4]+", "+N[5]+", "+N[6]+", "+N[7]+", "+N[8]+")"}function ae(N){return Math.hypot(N[0],N[1],N[2],N[3],N[4],N[5],N[6],N[7],N[8])}function Gt(N,et,ot){return N[0]=et[0]+ot[0],N[1]=et[1]+ot[1],N[2]=et[2]+ot[2],N[3]=et[3]+ot[3],N[4]=et[4]+ot[4],N[5]=et[5]+ot[5],N[6]=et[6]+ot[6],N[7]=et[7]+ot[7],N[8]=et[8]+ot[8],N}function _e(N,et,ot){return N[0]=et[0]-ot[0],N[1]=et[1]-ot[1],N[2]=et[2]-ot[2],N[3]=et[3]-ot[3],N[4]=et[4]-ot[4],N[5]=et[5]-ot[5],N[6]=et[6]-ot[6],N[7]=et[7]-ot[7],N[8]=et[8]-ot[8],N}function xe(N,et,ot){return N[0]=et[0]*ot,N[1]=et[1]*ot,N[2]=et[2]*ot,N[3]=et[3]*ot,N[4]=et[4]*ot,N[5]=et[5]*ot,N[6]=et[6]*ot,N[7]=et[7]*ot,N[8]=et[8]*ot,N}function X(N,et,ot,At){return N[0]=et[0]+ot[0]*At,N[1]=et[1]+ot[1]*At,N[2]=et[2]+ot[2]*At,N[3]=et[3]+ot[3]*At,N[4]=et[4]+ot[4]*At,N[5]=et[5]+ot[5]*At,N[6]=et[6]+ot[6]*At,N[7]=et[7]+ot[7]*At,N[8]=et[8]+ot[8]*At,N}function Rt(N,et){return N[0]===et[0]&&N[1]===et[1]&&N[2]===et[2]&&N[3]===et[3]&&N[4]===et[4]&&N[5]===et[5]&&N[6]===et[6]&&N[7]===et[7]&&N[8]===et[8]}function V(N,et){var ot=N[0],At=N[1],Dt=N[2],ie=N[3],Tt=N[4],zt=N[5],Oe=N[6],Lt=N[7],nt=N[8],Ft=et[0],he=et[1],yt=et[2],St=et[3],F=et[4],T=et[5],gt=et[6],ne=et[7],C=et[8];return Math.abs(ot-Ft)<=glMatrix.EPSILON*Math.max(1,Math.abs(ot),Math.abs(Ft))&&Math.abs(At-he)<=glMatrix.EPSILON*Math.max(1,Math.abs(At),Math.abs(he))&&Math.abs(Dt-yt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Dt),Math.abs(yt))&&Math.abs(ie-St)<=glMatrix.EPSILON*Math.max(1,Math.abs(ie),Math.abs(St))&&Math.abs(Tt-F)<=glMatrix.EPSILON*Math.max(1,Math.abs(Tt),Math.abs(F))&&Math.abs(zt-T)<=glMatrix.EPSILON*Math.max(1,Math.abs(zt),Math.abs(T))&&Math.abs(Oe-gt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(gt))&&Math.abs(Lt-ne)<=glMatrix.EPSILON*Math.max(1,Math.abs(Lt),Math.abs(ne))&&Math.abs(nt-C)<=glMatrix.EPSILON*Math.max(1,Math.abs(nt),Math.abs(C))}var Mt=null,H=null},85975:function(ke,Se,k){"use strict";k.r(Se),k.d(Se,{add:function(){return Ft},adjoint:function(){return ee},clone:function(){return _t},copy:function(){return qt},create:function(){return it},determinant:function(){return K},equals:function(){return T},exactEquals:function(){return F},frob:function(){return nt},fromQuat:function(){return Mt},fromQuat2:function(){return Gt},fromRotation:function(){return Ge},fromRotationTranslation:function(){return ae},fromRotationTranslationScale:function(){return Rt},fromRotationTranslationScaleOrigin:function(){return V},fromScaling:function(){return Ne},fromTranslation:function(){return we},fromValues:function(){return q},fromXRotation:function(){return ye},fromYRotation:function(){return Vt},fromZRotation:function(){return $},frustum:function(){return H},getRotation:function(){return X},getScaling:function(){return xe},getTranslation:function(){return _e},identity:function(){return Bt},invert:function(){return ct},lookAt:function(){return zt},mul:function(){return gt},multiply:function(){return J},multiplyScalar:function(){return yt},multiplyScalarAndAdd:function(){return St},ortho:function(){return ie},orthoNO:function(){return Dt},orthoZO:function(){return Tt},perspective:function(){return et},perspectiveFromFieldOfView:function(){return At},perspectiveNO:function(){return N},perspectiveZO:function(){return ot},rotate:function(){return mt},rotateX:function(){return lt},rotateY:function(){return jt},rotateZ:function(){return ue},scale:function(){return ft},set:function(){return Zt},str:function(){return Lt},sub:function(){return ne},subtract:function(){return he},targetTo:function(){return Oe},translate:function(){return Ct},transpose:function(){return Wt}});var pt=k(49685);function it(){var C=new pt.WT(16);return pt.WT!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function _t(C){var j=new pt.WT(16);return j[0]=C[0],j[1]=C[1],j[2]=C[2],j[3]=C[3],j[4]=C[4],j[5]=C[5],j[6]=C[6],j[7]=C[7],j[8]=C[8],j[9]=C[9],j[10]=C[10],j[11]=C[11],j[12]=C[12],j[13]=C[13],j[14]=C[14],j[15]=C[15],j}function qt(C,j){return C[0]=j[0],C[1]=j[1],C[2]=j[2],C[3]=j[3],C[4]=j[4],C[5]=j[5],C[6]=j[6],C[7]=j[7],C[8]=j[8],C[9]=j[9],C[10]=j[10],C[11]=j[11],C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15],C}function q(C,j,Pt,Jt,se,Ae,Le,De,Ve,We,$e,Ye,Xt,re,le,pe){var Q=new pt.WT(16);return Q[0]=C,Q[1]=j,Q[2]=Pt,Q[3]=Jt,Q[4]=se,Q[5]=Ae,Q[6]=Le,Q[7]=De,Q[8]=Ve,Q[9]=We,Q[10]=$e,Q[11]=Ye,Q[12]=Xt,Q[13]=re,Q[14]=le,Q[15]=pe,Q}function Zt(C,j,Pt,Jt,se,Ae,Le,De,Ve,We,$e,Ye,Xt,re,le,pe,Q){return C[0]=j,C[1]=Pt,C[2]=Jt,C[3]=se,C[4]=Ae,C[5]=Le,C[6]=De,C[7]=Ve,C[8]=We,C[9]=$e,C[10]=Ye,C[11]=Xt,C[12]=re,C[13]=le,C[14]=pe,C[15]=Q,C}function Bt(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Wt(C,j){if(C===j){var Pt=j[1],Jt=j[2],se=j[3],Ae=j[6],Le=j[7],De=j[11];C[1]=j[4],C[2]=j[8],C[3]=j[12],C[4]=Pt,C[6]=j[9],C[7]=j[13],C[8]=Jt,C[9]=Ae,C[11]=j[14],C[12]=se,C[13]=Le,C[14]=De}else C[0]=j[0],C[1]=j[4],C[2]=j[8],C[3]=j[12],C[4]=j[1],C[5]=j[5],C[6]=j[9],C[7]=j[13],C[8]=j[2],C[9]=j[6],C[10]=j[10],C[11]=j[14],C[12]=j[3],C[13]=j[7],C[14]=j[11],C[15]=j[15];return C}function ct(C,j){var Pt=j[0],Jt=j[1],se=j[2],Ae=j[3],Le=j[4],De=j[5],Ve=j[6],We=j[7],$e=j[8],Ye=j[9],Xt=j[10],re=j[11],le=j[12],pe=j[13],Q=j[14],D=j[15],Z=Pt*De-Jt*Le,tt=Pt*Ve-se*Le,Et=Pt*We-Ae*Le,It=Jt*Ve-se*De,ce=Jt*We-Ae*De,fe=se*We-Ae*Ve,Be=$e*pe-Ye*le,ze=$e*Q-Xt*le,an=$e*D-re*le,Re=Ye*Q-Xt*pe,Ke=Ye*D-re*pe,cn=Xt*D-re*Q,pn=Z*cn-tt*Ke+Et*Re+It*an-ce*ze+fe*Be;return pn?(pn=1/pn,C[0]=(De*cn-Ve*Ke+We*Re)*pn,C[1]=(se*Ke-Jt*cn-Ae*Re)*pn,C[2]=(pe*fe-Q*ce+D*It)*pn,C[3]=(Xt*ce-Ye*fe-re*It)*pn,C[4]=(Ve*an-Le*cn-We*ze)*pn,C[5]=(Pt*cn-se*an+Ae*ze)*pn,C[6]=(Q*Et-le*fe-D*tt)*pn,C[7]=($e*fe-Xt*Et+re*tt)*pn,C[8]=(Le*Ke-De*an+We*Be)*pn,C[9]=(Jt*an-Pt*Ke-Ae*Be)*pn,C[10]=(le*ce-pe*Et+D*Z)*pn,C[11]=(Ye*Et-$e*ce-re*Z)*pn,C[12]=(De*ze-Le*Re-Ve*Be)*pn,C[13]=(Pt*Re-Jt*ze+se*Be)*pn,C[14]=(pe*tt-le*It-Q*Z)*pn,C[15]=($e*It-Ye*tt+Xt*Z)*pn,C):null}function ee(C,j){var Pt=j[0],Jt=j[1],se=j[2],Ae=j[3],Le=j[4],De=j[5],Ve=j[6],We=j[7],$e=j[8],Ye=j[9],Xt=j[10],re=j[11],le=j[12],pe=j[13],Q=j[14],D=j[15];return C[0]=De*(Xt*D-re*Q)-Ye*(Ve*D-We*Q)+pe*(Ve*re-We*Xt),C[1]=-(Jt*(Xt*D-re*Q)-Ye*(se*D-Ae*Q)+pe*(se*re-Ae*Xt)),C[2]=Jt*(Ve*D-We*Q)-De*(se*D-Ae*Q)+pe*(se*We-Ae*Ve),C[3]=-(Jt*(Ve*re-We*Xt)-De*(se*re-Ae*Xt)+Ye*(se*We-Ae*Ve)),C[4]=-(Le*(Xt*D-re*Q)-$e*(Ve*D-We*Q)+le*(Ve*re-We*Xt)),C[5]=Pt*(Xt*D-re*Q)-$e*(se*D-Ae*Q)+le*(se*re-Ae*Xt),C[6]=-(Pt*(Ve*D-We*Q)-Le*(se*D-Ae*Q)+le*(se*We-Ae*Ve)),C[7]=Pt*(Ve*re-We*Xt)-Le*(se*re-Ae*Xt)+$e*(se*We-Ae*Ve),C[8]=Le*(Ye*D-re*pe)-$e*(De*D-We*pe)+le*(De*re-We*Ye),C[9]=-(Pt*(Ye*D-re*pe)-$e*(Jt*D-Ae*pe)+le*(Jt*re-Ae*Ye)),C[10]=Pt*(De*D-We*pe)-Le*(Jt*D-Ae*pe)+le*(Jt*We-Ae*De),C[11]=-(Pt*(De*re-We*Ye)-Le*(Jt*re-Ae*Ye)+$e*(Jt*We-Ae*De)),C[12]=-(Le*(Ye*Q-Xt*pe)-$e*(De*Q-Ve*pe)+le*(De*Xt-Ve*Ye)),C[13]=Pt*(Ye*Q-Xt*pe)-$e*(Jt*Q-se*pe)+le*(Jt*Xt-se*Ye),C[14]=-(Pt*(De*Q-Ve*pe)-Le*(Jt*Q-se*pe)+le*(Jt*Ve-se*De)),C[15]=Pt*(De*Xt-Ve*Ye)-Le*(Jt*Xt-se*Ye)+$e*(Jt*Ve-se*De),C}function K(C){var j=C[0],Pt=C[1],Jt=C[2],se=C[3],Ae=C[4],Le=C[5],De=C[6],Ve=C[7],We=C[8],$e=C[9],Ye=C[10],Xt=C[11],re=C[12],le=C[13],pe=C[14],Q=C[15],D=j*Le-Pt*Ae,Z=j*De-Jt*Ae,tt=j*Ve-se*Ae,Et=Pt*De-Jt*Le,It=Pt*Ve-se*Le,ce=Jt*Ve-se*De,fe=We*le-$e*re,Be=We*pe-Ye*re,ze=We*Q-Xt*re,an=$e*pe-Ye*le,Re=$e*Q-Xt*le,Ke=Ye*Q-Xt*pe;return D*Ke-Z*Re+tt*an+Et*ze-It*Be+ce*fe}function J(C,j,Pt){var Jt=j[0],se=j[1],Ae=j[2],Le=j[3],De=j[4],Ve=j[5],We=j[6],$e=j[7],Ye=j[8],Xt=j[9],re=j[10],le=j[11],pe=j[12],Q=j[13],D=j[14],Z=j[15],tt=Pt[0],Et=Pt[1],It=Pt[2],ce=Pt[3];return C[0]=tt*Jt+Et*De+It*Ye+ce*pe,C[1]=tt*se+Et*Ve+It*Xt+ce*Q,C[2]=tt*Ae+Et*We+It*re+ce*D,C[3]=tt*Le+Et*$e+It*le+ce*Z,tt=Pt[4],Et=Pt[5],It=Pt[6],ce=Pt[7],C[4]=tt*Jt+Et*De+It*Ye+ce*pe,C[5]=tt*se+Et*Ve+It*Xt+ce*Q,C[6]=tt*Ae+Et*We+It*re+ce*D,C[7]=tt*Le+Et*$e+It*le+ce*Z,tt=Pt[8],Et=Pt[9],It=Pt[10],ce=Pt[11],C[8]=tt*Jt+Et*De+It*Ye+ce*pe,C[9]=tt*se+Et*Ve+It*Xt+ce*Q,C[10]=tt*Ae+Et*We+It*re+ce*D,C[11]=tt*Le+Et*$e+It*le+ce*Z,tt=Pt[12],Et=Pt[13],It=Pt[14],ce=Pt[15],C[12]=tt*Jt+Et*De+It*Ye+ce*pe,C[13]=tt*se+Et*Ve+It*Xt+ce*Q,C[14]=tt*Ae+Et*We+It*re+ce*D,C[15]=tt*Le+Et*$e+It*le+ce*Z,C}function Ct(C,j,Pt){var Jt=Pt[0],se=Pt[1],Ae=Pt[2],Le,De,Ve,We,$e,Ye,Xt,re,le,pe,Q,D;return j===C?(C[12]=j[0]*Jt+j[4]*se+j[8]*Ae+j[12],C[13]=j[1]*Jt+j[5]*se+j[9]*Ae+j[13],C[14]=j[2]*Jt+j[6]*se+j[10]*Ae+j[14],C[15]=j[3]*Jt+j[7]*se+j[11]*Ae+j[15]):(Le=j[0],De=j[1],Ve=j[2],We=j[3],$e=j[4],Ye=j[5],Xt=j[6],re=j[7],le=j[8],pe=j[9],Q=j[10],D=j[11],C[0]=Le,C[1]=De,C[2]=Ve,C[3]=We,C[4]=$e,C[5]=Ye,C[6]=Xt,C[7]=re,C[8]=le,C[9]=pe,C[10]=Q,C[11]=D,C[12]=Le*Jt+$e*se+le*Ae+j[12],C[13]=De*Jt+Ye*se+pe*Ae+j[13],C[14]=Ve*Jt+Xt*se+Q*Ae+j[14],C[15]=We*Jt+re*se+D*Ae+j[15]),C}function ft(C,j,Pt){var Jt=Pt[0],se=Pt[1],Ae=Pt[2];return C[0]=j[0]*Jt,C[1]=j[1]*Jt,C[2]=j[2]*Jt,C[3]=j[3]*Jt,C[4]=j[4]*se,C[5]=j[5]*se,C[6]=j[6]*se,C[7]=j[7]*se,C[8]=j[8]*Ae,C[9]=j[9]*Ae,C[10]=j[10]*Ae,C[11]=j[11]*Ae,C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15],C}function mt(C,j,Pt,Jt){var se=Jt[0],Ae=Jt[1],Le=Jt[2],De=Math.hypot(se,Ae,Le),Ve,We,$e,Ye,Xt,re,le,pe,Q,D,Z,tt,Et,It,ce,fe,Be,ze,an,Re,Ke,cn,pn,An;return De<pt.Ib?null:(De=1/De,se*=De,Ae*=De,Le*=De,Ve=Math.sin(Pt),We=Math.cos(Pt),$e=1-We,Ye=j[0],Xt=j[1],re=j[2],le=j[3],pe=j[4],Q=j[5],D=j[6],Z=j[7],tt=j[8],Et=j[9],It=j[10],ce=j[11],fe=se*se*$e+We,Be=Ae*se*$e+Le*Ve,ze=Le*se*$e-Ae*Ve,an=se*Ae*$e-Le*Ve,Re=Ae*Ae*$e+We,Ke=Le*Ae*$e+se*Ve,cn=se*Le*$e+Ae*Ve,pn=Ae*Le*$e-se*Ve,An=Le*Le*$e+We,C[0]=Ye*fe+pe*Be+tt*ze,C[1]=Xt*fe+Q*Be+Et*ze,C[2]=re*fe+D*Be+It*ze,C[3]=le*fe+Z*Be+ce*ze,C[4]=Ye*an+pe*Re+tt*Ke,C[5]=Xt*an+Q*Re+Et*Ke,C[6]=re*an+D*Re+It*Ke,C[7]=le*an+Z*Re+ce*Ke,C[8]=Ye*cn+pe*pn+tt*An,C[9]=Xt*cn+Q*pn+Et*An,C[10]=re*cn+D*pn+It*An,C[11]=le*cn+Z*pn+ce*An,j!==C&&(C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15]),C)}function lt(C,j,Pt){var Jt=Math.sin(Pt),se=Math.cos(Pt),Ae=j[4],Le=j[5],De=j[6],Ve=j[7],We=j[8],$e=j[9],Ye=j[10],Xt=j[11];return j!==C&&(C[0]=j[0],C[1]=j[1],C[2]=j[2],C[3]=j[3],C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15]),C[4]=Ae*se+We*Jt,C[5]=Le*se+$e*Jt,C[6]=De*se+Ye*Jt,C[7]=Ve*se+Xt*Jt,C[8]=We*se-Ae*Jt,C[9]=$e*se-Le*Jt,C[10]=Ye*se-De*Jt,C[11]=Xt*se-Ve*Jt,C}function jt(C,j,Pt){var Jt=Math.sin(Pt),se=Math.cos(Pt),Ae=j[0],Le=j[1],De=j[2],Ve=j[3],We=j[8],$e=j[9],Ye=j[10],Xt=j[11];return j!==C&&(C[4]=j[4],C[5]=j[5],C[6]=j[6],C[7]=j[7],C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15]),C[0]=Ae*se-We*Jt,C[1]=Le*se-$e*Jt,C[2]=De*se-Ye*Jt,C[3]=Ve*se-Xt*Jt,C[8]=Ae*Jt+We*se,C[9]=Le*Jt+$e*se,C[10]=De*Jt+Ye*se,C[11]=Ve*Jt+Xt*se,C}function ue(C,j,Pt){var Jt=Math.sin(Pt),se=Math.cos(Pt),Ae=j[0],Le=j[1],De=j[2],Ve=j[3],We=j[4],$e=j[5],Ye=j[6],Xt=j[7];return j!==C&&(C[8]=j[8],C[9]=j[9],C[10]=j[10],C[11]=j[11],C[12]=j[12],C[13]=j[13],C[14]=j[14],C[15]=j[15]),C[0]=Ae*se+We*Jt,C[1]=Le*se+$e*Jt,C[2]=De*se+Ye*Jt,C[3]=Ve*se+Xt*Jt,C[4]=We*se-Ae*Jt,C[5]=$e*se-Le*Jt,C[6]=Ye*se-De*Jt,C[7]=Xt*se-Ve*Jt,C}function we(C,j){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=j[0],C[13]=j[1],C[14]=j[2],C[15]=1,C}function Ne(C,j){return C[0]=j[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=j[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=j[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ge(C,j,Pt){var Jt=Pt[0],se=Pt[1],Ae=Pt[2],Le=Math.hypot(Jt,se,Ae),De,Ve,We;return Le<pt.Ib?null:(Le=1/Le,Jt*=Le,se*=Le,Ae*=Le,De=Math.sin(j),Ve=Math.cos(j),We=1-Ve,C[0]=Jt*Jt*We+Ve,C[1]=se*Jt*We+Ae*De,C[2]=Ae*Jt*We-se*De,C[3]=0,C[4]=Jt*se*We-Ae*De,C[5]=se*se*We+Ve,C[6]=Ae*se*We+Jt*De,C[7]=0,C[8]=Jt*Ae*We+se*De,C[9]=se*Ae*We-Jt*De,C[10]=Ae*Ae*We+Ve,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function ye(C,j){var Pt=Math.sin(j),Jt=Math.cos(j);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Jt,C[6]=Pt,C[7]=0,C[8]=0,C[9]=-Pt,C[10]=Jt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Vt(C,j){var Pt=Math.sin(j),Jt=Math.cos(j);return C[0]=Jt,C[1]=0,C[2]=-Pt,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=Pt,C[9]=0,C[10]=Jt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function $(C,j){var Pt=Math.sin(j),Jt=Math.cos(j);return C[0]=Jt,C[1]=Pt,C[2]=0,C[3]=0,C[4]=-Pt,C[5]=Jt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ae(C,j,Pt){var Jt=j[0],se=j[1],Ae=j[2],Le=j[3],De=Jt+Jt,Ve=se+se,We=Ae+Ae,$e=Jt*De,Ye=Jt*Ve,Xt=Jt*We,re=se*Ve,le=se*We,pe=Ae*We,Q=Le*De,D=Le*Ve,Z=Le*We;return C[0]=1-(re+pe),C[1]=Ye+Z,C[2]=Xt-D,C[3]=0,C[4]=Ye-Z,C[5]=1-($e+pe),C[6]=le+Q,C[7]=0,C[8]=Xt+D,C[9]=le-Q,C[10]=1-($e+re),C[11]=0,C[12]=Pt[0],C[13]=Pt[1],C[14]=Pt[2],C[15]=1,C}function Gt(C,j){var Pt=new pt.WT(3),Jt=-j[0],se=-j[1],Ae=-j[2],Le=j[3],De=j[4],Ve=j[5],We=j[6],$e=j[7],Ye=Jt*Jt+se*se+Ae*Ae+Le*Le;return Ye>0?(Pt[0]=(De*Le+$e*Jt+Ve*Ae-We*se)*2/Ye,Pt[1]=(Ve*Le+$e*se+We*Jt-De*Ae)*2/Ye,Pt[2]=(We*Le+$e*Ae+De*se-Ve*Jt)*2/Ye):(Pt[0]=(De*Le+$e*Jt+Ve*Ae-We*se)*2,Pt[1]=(Ve*Le+$e*se+We*Jt-De*Ae)*2,Pt[2]=(We*Le+$e*Ae+De*se-Ve*Jt)*2),ae(C,j,Pt),C}function _e(C,j){return C[0]=j[12],C[1]=j[13],C[2]=j[14],C}function xe(C,j){var Pt=j[0],Jt=j[1],se=j[2],Ae=j[4],Le=j[5],De=j[6],Ve=j[8],We=j[9],$e=j[10];return C[0]=Math.hypot(Pt,Jt,se),C[1]=Math.hypot(Ae,Le,De),C[2]=Math.hypot(Ve,We,$e),C}function X(C,j){var Pt=new pt.WT(3);xe(Pt,j);var Jt=1/Pt[0],se=1/Pt[1],Ae=1/Pt[2],Le=j[0]*Jt,De=j[1]*se,Ve=j[2]*Ae,We=j[4]*Jt,$e=j[5]*se,Ye=j[6]*Ae,Xt=j[8]*Jt,re=j[9]*se,le=j[10]*Ae,pe=Le+$e+le,Q=0;return pe>0?(Q=Math.sqrt(pe+1)*2,C[3]=.25*Q,C[0]=(Ye-re)/Q,C[1]=(Xt-Ve)/Q,C[2]=(De-We)/Q):Le>$e&&Le>le?(Q=Math.sqrt(1+Le-$e-le)*2,C[3]=(Ye-re)/Q,C[0]=.25*Q,C[1]=(De+We)/Q,C[2]=(Xt+Ve)/Q):$e>le?(Q=Math.sqrt(1+$e-Le-le)*2,C[3]=(Xt-Ve)/Q,C[0]=(De+We)/Q,C[1]=.25*Q,C[2]=(Ye+re)/Q):(Q=Math.sqrt(1+le-Le-$e)*2,C[3]=(De-We)/Q,C[0]=(Xt+Ve)/Q,C[1]=(Ye+re)/Q,C[2]=.25*Q),C}function Rt(C,j,Pt,Jt){var se=j[0],Ae=j[1],Le=j[2],De=j[3],Ve=se+se,We=Ae+Ae,$e=Le+Le,Ye=se*Ve,Xt=se*We,re=se*$e,le=Ae*We,pe=Ae*$e,Q=Le*$e,D=De*Ve,Z=De*We,tt=De*$e,Et=Jt[0],It=Jt[1],ce=Jt[2];return C[0]=(1-(le+Q))*Et,C[1]=(Xt+tt)*Et,C[2]=(re-Z)*Et,C[3]=0,C[4]=(Xt-tt)*It,C[5]=(1-(Ye+Q))*It,C[6]=(pe+D)*It,C[7]=0,C[8]=(re+Z)*ce,C[9]=(pe-D)*ce,C[10]=(1-(Ye+le))*ce,C[11]=0,C[12]=Pt[0],C[13]=Pt[1],C[14]=Pt[2],C[15]=1,C}function V(C,j,Pt,Jt,se){var Ae=j[0],Le=j[1],De=j[2],Ve=j[3],We=Ae+Ae,$e=Le+Le,Ye=De+De,Xt=Ae*We,re=Ae*$e,le=Ae*Ye,pe=Le*$e,Q=Le*Ye,D=De*Ye,Z=Ve*We,tt=Ve*$e,Et=Ve*Ye,It=Jt[0],ce=Jt[1],fe=Jt[2],Be=se[0],ze=se[1],an=se[2],Re=(1-(pe+D))*It,Ke=(re+Et)*It,cn=(le-tt)*It,pn=(re-Et)*ce,An=(1-(Xt+D))*ce,Gn=(Q+Z)*ce,Vn=(le+tt)*fe,fr=(Q-Z)*fe,yr=(1-(Xt+pe))*fe;return C[0]=Re,C[1]=Ke,C[2]=cn,C[3]=0,C[4]=pn,C[5]=An,C[6]=Gn,C[7]=0,C[8]=Vn,C[9]=fr,C[10]=yr,C[11]=0,C[12]=Pt[0]+Be-(Re*Be+pn*ze+Vn*an),C[13]=Pt[1]+ze-(Ke*Be+An*ze+fr*an),C[14]=Pt[2]+an-(cn*Be+Gn*ze+yr*an),C[15]=1,C}function Mt(C,j){var Pt=j[0],Jt=j[1],se=j[2],Ae=j[3],Le=Pt+Pt,De=Jt+Jt,Ve=se+se,We=Pt*Le,$e=Jt*Le,Ye=Jt*De,Xt=se*Le,re=se*De,le=se*Ve,pe=Ae*Le,Q=Ae*De,D=Ae*Ve;return C[0]=1-Ye-le,C[1]=$e+D,C[2]=Xt-Q,C[3]=0,C[4]=$e-D,C[5]=1-We-le,C[6]=re+pe,C[7]=0,C[8]=Xt+Q,C[9]=re-pe,C[10]=1-We-Ye,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function H(C,j,Pt,Jt,se,Ae,Le){var De=1/(Pt-j),Ve=1/(se-Jt),We=1/(Ae-Le);return C[0]=Ae*2*De,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Ae*2*Ve,C[6]=0,C[7]=0,C[8]=(Pt+j)*De,C[9]=(se+Jt)*Ve,C[10]=(Le+Ae)*We,C[11]=-1,C[12]=0,C[13]=0,C[14]=Le*Ae*2*We,C[15]=0,C}function N(C,j,Pt,Jt,se){var Ae=1/Math.tan(j/2),Le;return C[0]=Ae/Pt,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Ae,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,se!=null&&se!==1/0?(Le=1/(Jt-se),C[10]=(se+Jt)*Le,C[14]=2*se*Jt*Le):(C[10]=-1,C[14]=-2*Jt),C}var et=N;function ot(C,j,Pt,Jt,se){var Ae=1/Math.tan(j/2),Le;return C[0]=Ae/Pt,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Ae,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,se!=null&&se!==1/0?(Le=1/(Jt-se),C[10]=se*Le,C[14]=se*Jt*Le):(C[10]=-1,C[14]=-Jt),C}function At(C,j,Pt,Jt){var se=Math.tan(j.upDegrees*Math.PI/180),Ae=Math.tan(j.downDegrees*Math.PI/180),Le=Math.tan(j.leftDegrees*Math.PI/180),De=Math.tan(j.rightDegrees*Math.PI/180),Ve=2/(Le+De),We=2/(se+Ae);return C[0]=Ve,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=We,C[6]=0,C[7]=0,C[8]=-((Le-De)*Ve*.5),C[9]=(se-Ae)*We*.5,C[10]=Jt/(Pt-Jt),C[11]=-1,C[12]=0,C[13]=0,C[14]=Jt*Pt/(Pt-Jt),C[15]=0,C}function Dt(C,j,Pt,Jt,se,Ae,Le){var De=1/(j-Pt),Ve=1/(Jt-se),We=1/(Ae-Le);return C[0]=-2*De,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ve,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*We,C[11]=0,C[12]=(j+Pt)*De,C[13]=(se+Jt)*Ve,C[14]=(Le+Ae)*We,C[15]=1,C}var ie=Dt;function Tt(C,j,Pt,Jt,se,Ae,Le){var De=1/(j-Pt),Ve=1/(Jt-se),We=1/(Ae-Le);return C[0]=-2*De,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ve,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=We,C[11]=0,C[12]=(j+Pt)*De,C[13]=(se+Jt)*Ve,C[14]=Ae*We,C[15]=1,C}function zt(C,j,Pt,Jt){var se,Ae,Le,De,Ve,We,$e,Ye,Xt,re,le=j[0],pe=j[1],Q=j[2],D=Jt[0],Z=Jt[1],tt=Jt[2],Et=Pt[0],It=Pt[1],ce=Pt[2];return Math.abs(le-Et)<pt.Ib&&Math.abs(pe-It)<pt.Ib&&Math.abs(Q-ce)<pt.Ib?Bt(C):($e=le-Et,Ye=pe-It,Xt=Q-ce,re=1/Math.hypot($e,Ye,Xt),$e*=re,Ye*=re,Xt*=re,se=Z*Xt-tt*Ye,Ae=tt*$e-D*Xt,Le=D*Ye-Z*$e,re=Math.hypot(se,Ae,Le),re?(re=1/re,se*=re,Ae*=re,Le*=re):(se=0,Ae=0,Le=0),De=Ye*Le-Xt*Ae,Ve=Xt*se-$e*Le,We=$e*Ae-Ye*se,re=Math.hypot(De,Ve,We),re?(re=1/re,De*=re,Ve*=re,We*=re):(De=0,Ve=0,We=0),C[0]=se,C[1]=De,C[2]=$e,C[3]=0,C[4]=Ae,C[5]=Ve,C[6]=Ye,C[7]=0,C[8]=Le,C[9]=We,C[10]=Xt,C[11]=0,C[12]=-(se*le+Ae*pe+Le*Q),C[13]=-(De*le+Ve*pe+We*Q),C[14]=-($e*le+Ye*pe+Xt*Q),C[15]=1,C)}function Oe(C,j,Pt,Jt){var se=j[0],Ae=j[1],Le=j[2],De=Jt[0],Ve=Jt[1],We=Jt[2],$e=se-Pt[0],Ye=Ae-Pt[1],Xt=Le-Pt[2],re=$e*$e+Ye*Ye+Xt*Xt;re>0&&(re=1/Math.sqrt(re),$e*=re,Ye*=re,Xt*=re);var le=Ve*Xt-We*Ye,pe=We*$e-De*Xt,Q=De*Ye-Ve*$e;return re=le*le+pe*pe+Q*Q,re>0&&(re=1/Math.sqrt(re),le*=re,pe*=re,Q*=re),C[0]=le,C[1]=pe,C[2]=Q,C[3]=0,C[4]=Ye*Q-Xt*pe,C[5]=Xt*le-$e*Q,C[6]=$e*pe-Ye*le,C[7]=0,C[8]=$e,C[9]=Ye,C[10]=Xt,C[11]=0,C[12]=se,C[13]=Ae,C[14]=Le,C[15]=1,C}function Lt(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function nt(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function Ft(C,j,Pt){return C[0]=j[0]+Pt[0],C[1]=j[1]+Pt[1],C[2]=j[2]+Pt[2],C[3]=j[3]+Pt[3],C[4]=j[4]+Pt[4],C[5]=j[5]+Pt[5],C[6]=j[6]+Pt[6],C[7]=j[7]+Pt[7],C[8]=j[8]+Pt[8],C[9]=j[9]+Pt[9],C[10]=j[10]+Pt[10],C[11]=j[11]+Pt[11],C[12]=j[12]+Pt[12],C[13]=j[13]+Pt[13],C[14]=j[14]+Pt[14],C[15]=j[15]+Pt[15],C}function he(C,j,Pt){return C[0]=j[0]-Pt[0],C[1]=j[1]-Pt[1],C[2]=j[2]-Pt[2],C[3]=j[3]-Pt[3],C[4]=j[4]-Pt[4],C[5]=j[5]-Pt[5],C[6]=j[6]-Pt[6],C[7]=j[7]-Pt[7],C[8]=j[8]-Pt[8],C[9]=j[9]-Pt[9],C[10]=j[10]-Pt[10],C[11]=j[11]-Pt[11],C[12]=j[12]-Pt[12],C[13]=j[13]-Pt[13],C[14]=j[14]-Pt[14],C[15]=j[15]-Pt[15],C}function yt(C,j,Pt){return C[0]=j[0]*Pt,C[1]=j[1]*Pt,C[2]=j[2]*Pt,C[3]=j[3]*Pt,C[4]=j[4]*Pt,C[5]=j[5]*Pt,C[6]=j[6]*Pt,C[7]=j[7]*Pt,C[8]=j[8]*Pt,C[9]=j[9]*Pt,C[10]=j[10]*Pt,C[11]=j[11]*Pt,C[12]=j[12]*Pt,C[13]=j[13]*Pt,C[14]=j[14]*Pt,C[15]=j[15]*Pt,C}function St(C,j,Pt,Jt){return C[0]=j[0]+Pt[0]*Jt,C[1]=j[1]+Pt[1]*Jt,C[2]=j[2]+Pt[2]*Jt,C[3]=j[3]+Pt[3]*Jt,C[4]=j[4]+Pt[4]*Jt,C[5]=j[5]+Pt[5]*Jt,C[6]=j[6]+Pt[6]*Jt,C[7]=j[7]+Pt[7]*Jt,C[8]=j[8]+Pt[8]*Jt,C[9]=j[9]+Pt[9]*Jt,C[10]=j[10]+Pt[10]*Jt,C[11]=j[11]+Pt[11]*Jt,C[12]=j[12]+Pt[12]*Jt,C[13]=j[13]+Pt[13]*Jt,C[14]=j[14]+Pt[14]*Jt,C[15]=j[15]+Pt[15]*Jt,C}function F(C,j){return C[0]===j[0]&&C[1]===j[1]&&C[2]===j[2]&&C[3]===j[3]&&C[4]===j[4]&&C[5]===j[5]&&C[6]===j[6]&&C[7]===j[7]&&C[8]===j[8]&&C[9]===j[9]&&C[10]===j[10]&&C[11]===j[11]&&C[12]===j[12]&&C[13]===j[13]&&C[14]===j[14]&&C[15]===j[15]}function T(C,j){var Pt=C[0],Jt=C[1],se=C[2],Ae=C[3],Le=C[4],De=C[5],Ve=C[6],We=C[7],$e=C[8],Ye=C[9],Xt=C[10],re=C[11],le=C[12],pe=C[13],Q=C[14],D=C[15],Z=j[0],tt=j[1],Et=j[2],It=j[3],ce=j[4],fe=j[5],Be=j[6],ze=j[7],an=j[8],Re=j[9],Ke=j[10],cn=j[11],pn=j[12],An=j[13],Gn=j[14],Vn=j[15];return Math.abs(Pt-Z)<=pt.Ib*Math.max(1,Math.abs(Pt),Math.abs(Z))&&Math.abs(Jt-tt)<=pt.Ib*Math.max(1,Math.abs(Jt),Math.abs(tt))&&Math.abs(se-Et)<=pt.Ib*Math.max(1,Math.abs(se),Math.abs(Et))&&Math.abs(Ae-It)<=pt.Ib*Math.max(1,Math.abs(Ae),Math.abs(It))&&Math.abs(Le-ce)<=pt.Ib*Math.max(1,Math.abs(Le),Math.abs(ce))&&Math.abs(De-fe)<=pt.Ib*Math.max(1,Math.abs(De),Math.abs(fe))&&Math.abs(Ve-Be)<=pt.Ib*Math.max(1,Math.abs(Ve),Math.abs(Be))&&Math.abs(We-ze)<=pt.Ib*Math.max(1,Math.abs(We),Math.abs(ze))&&Math.abs($e-an)<=pt.Ib*Math.max(1,Math.abs($e),Math.abs(an))&&Math.abs(Ye-Re)<=pt.Ib*Math.max(1,Math.abs(Ye),Math.abs(Re))&&Math.abs(Xt-Ke)<=pt.Ib*Math.max(1,Math.abs(Xt),Math.abs(Ke))&&Math.abs(re-cn)<=pt.Ib*Math.max(1,Math.abs(re),Math.abs(cn))&&Math.abs(le-pn)<=pt.Ib*Math.max(1,Math.abs(le),Math.abs(pn))&&Math.abs(pe-An)<=pt.Ib*Math.max(1,Math.abs(pe),Math.abs(An))&&Math.abs(Q-Gn)<=pt.Ib*Math.max(1,Math.abs(Q),Math.abs(Gn))&&Math.abs(D-Vn)<=pt.Ib*Math.max(1,Math.abs(D),Math.abs(Vn))}var gt=J,ne=he},32945:function(ke,Se,k){"use strict";k.d(Se,{Fv:function(){return Dt},JG:function(){return _e},Jp:function(){return ee},Su:function(){return Vt},U_:function(){return Ne},Ue:function(){return q},al:function(){return Gt},dC:function(){return Rt},yY:function(){return Bt}});var pt=k(49685),it=k(35600),_t=k(77160),qt=k(98333);function q(){var nt=new pt.WT(4);return pt.WT!=Float32Array&&(nt[0]=0,nt[1]=0,nt[2]=0),nt[3]=1,nt}function Zt(nt){return nt[0]=0,nt[1]=0,nt[2]=0,nt[3]=1,nt}function Bt(nt,Ft,he){he=he*.5;var yt=Math.sin(he);return nt[0]=yt*Ft[0],nt[1]=yt*Ft[1],nt[2]=yt*Ft[2],nt[3]=Math.cos(he),nt}function Wt(nt,Ft){var he=Math.acos(Ft[3])*2,yt=Math.sin(he/2);return yt>glMatrix.EPSILON?(nt[0]=Ft[0]/yt,nt[1]=Ft[1]/yt,nt[2]=Ft[2]/yt):(nt[0]=1,nt[1]=0,nt[2]=0),he}function ct(nt,Ft){var he=Mt(nt,Ft);return Math.acos(2*he*he-1)}function ee(nt,Ft,he){var yt=Ft[0],St=Ft[1],F=Ft[2],T=Ft[3],gt=he[0],ne=he[1],C=he[2],j=he[3];return nt[0]=yt*j+T*gt+St*C-F*ne,nt[1]=St*j+T*ne+F*gt-yt*C,nt[2]=F*j+T*C+yt*ne-St*gt,nt[3]=T*j-yt*gt-St*ne-F*C,nt}function K(nt,Ft,he){he*=.5;var yt=Ft[0],St=Ft[1],F=Ft[2],T=Ft[3],gt=Math.sin(he),ne=Math.cos(he);return nt[0]=yt*ne+T*gt,nt[1]=St*ne+F*gt,nt[2]=F*ne-St*gt,nt[3]=T*ne-yt*gt,nt}function J(nt,Ft,he){he*=.5;var yt=Ft[0],St=Ft[1],F=Ft[2],T=Ft[3],gt=Math.sin(he),ne=Math.cos(he);return nt[0]=yt*ne-F*gt,nt[1]=St*ne+T*gt,nt[2]=F*ne+yt*gt,nt[3]=T*ne-St*gt,nt}function Ct(nt,Ft,he){he*=.5;var yt=Ft[0],St=Ft[1],F=Ft[2],T=Ft[3],gt=Math.sin(he),ne=Math.cos(he);return nt[0]=yt*ne+St*gt,nt[1]=St*ne-yt*gt,nt[2]=F*ne+T*gt,nt[3]=T*ne-F*gt,nt}function ft(nt,Ft){var he=Ft[0],yt=Ft[1],St=Ft[2];return nt[0]=he,nt[1]=yt,nt[2]=St,nt[3]=Math.sqrt(Math.abs(1-he*he-yt*yt-St*St)),nt}function mt(nt,Ft){var he=Ft[0],yt=Ft[1],St=Ft[2],F=Ft[3],T=Math.sqrt(he*he+yt*yt+St*St),gt=Math.exp(F),ne=T>0?gt*Math.sin(T)/T:0;return nt[0]=he*ne,nt[1]=yt*ne,nt[2]=St*ne,nt[3]=gt*Math.cos(T),nt}function lt(nt,Ft){var he=Ft[0],yt=Ft[1],St=Ft[2],F=Ft[3],T=Math.sqrt(he*he+yt*yt+St*St),gt=T>0?Math.atan2(T,F)/T:0;return nt[0]=he*gt,nt[1]=yt*gt,nt[2]=St*gt,nt[3]=.5*Math.log(he*he+yt*yt+St*St+F*F),nt}function jt(nt,Ft,he){return lt(nt,Ft),V(nt,nt,he),mt(nt,nt),nt}function ue(nt,Ft,he,yt){var St=Ft[0],F=Ft[1],T=Ft[2],gt=Ft[3],ne=he[0],C=he[1],j=he[2],Pt=he[3],Jt,se,Ae,Le,De;return se=St*ne+F*C+T*j+gt*Pt,se<0&&(se=-se,ne=-ne,C=-C,j=-j,Pt=-Pt),1-se>pt.Ib?(Jt=Math.acos(se),Ae=Math.sin(Jt),Le=Math.sin((1-yt)*Jt)/Ae,De=Math.sin(yt*Jt)/Ae):(Le=1-yt,De=yt),nt[0]=Le*St+De*ne,nt[1]=Le*F+De*C,nt[2]=Le*T+De*j,nt[3]=Le*gt+De*Pt,nt}function we(nt){var Ft=glMatrix.RANDOM(),he=glMatrix.RANDOM(),yt=glMatrix.RANDOM(),St=Math.sqrt(1-Ft),F=Math.sqrt(Ft);return nt[0]=St*Math.sin(2*Math.PI*he),nt[1]=St*Math.cos(2*Math.PI*he),nt[2]=F*Math.sin(2*Math.PI*yt),nt[3]=F*Math.cos(2*Math.PI*yt),nt}function Ne(nt,Ft){var he=Ft[0],yt=Ft[1],St=Ft[2],F=Ft[3],T=he*he+yt*yt+St*St+F*F,gt=T?1/T:0;return nt[0]=-he*gt,nt[1]=-yt*gt,nt[2]=-St*gt,nt[3]=F*gt,nt}function Ge(nt,Ft){return nt[0]=-Ft[0],nt[1]=-Ft[1],nt[2]=-Ft[2],nt[3]=Ft[3],nt}function ye(nt,Ft){var he=Ft[0]+Ft[4]+Ft[8],yt;if(he>0)yt=Math.sqrt(he+1),nt[3]=.5*yt,yt=.5/yt,nt[0]=(Ft[5]-Ft[7])*yt,nt[1]=(Ft[6]-Ft[2])*yt,nt[2]=(Ft[1]-Ft[3])*yt;else{var St=0;Ft[4]>Ft[0]&&(St=1),Ft[8]>Ft[St*3+St]&&(St=2);var F=(St+1)%3,T=(St+2)%3;yt=Math.sqrt(Ft[St*3+St]-Ft[F*3+F]-Ft[T*3+T]+1),nt[St]=.5*yt,yt=.5/yt,nt[3]=(Ft[F*3+T]-Ft[T*3+F])*yt,nt[F]=(Ft[F*3+St]+Ft[St*3+F])*yt,nt[T]=(Ft[T*3+St]+Ft[St*3+T])*yt}return nt}function Vt(nt,Ft,he,yt){var St=.5*Math.PI/180;Ft*=St,he*=St,yt*=St;var F=Math.sin(Ft),T=Math.cos(Ft),gt=Math.sin(he),ne=Math.cos(he),C=Math.sin(yt),j=Math.cos(yt);return nt[0]=F*ne*j-T*gt*C,nt[1]=T*gt*j+F*ne*C,nt[2]=T*ne*C-F*gt*j,nt[3]=T*ne*j+F*gt*C,nt}function $(nt){return"quat("+nt[0]+", "+nt[1]+", "+nt[2]+", "+nt[3]+")"}var ae=qt.d9,Gt=qt.al,_e=qt.JG,xe=qt.t8,X=qt.IH,Rt=ee,V=qt.bA,Mt=qt.AK,H=qt.t7,N=qt.kE,et=null,ot=qt.we,At=null,Dt=qt.Fv,ie=qt.I6,Tt=qt.fS,zt=function(){var nt=_t.Ue(),Ft=_t.al(1,0,0),he=_t.al(0,1,0);return function(yt,St,F){var T=_t.AK(St,F);return T<-.999999?(_t.kC(nt,Ft,St),_t.Zh(nt)<1e-6&&_t.kC(nt,he,St),_t.Fv(nt,nt),Bt(yt,nt,Math.PI),yt):T>.999999?(yt[0]=0,yt[1]=0,yt[2]=0,yt[3]=1,yt):(_t.kC(nt,St,F),yt[0]=nt[0],yt[1]=nt[1],yt[2]=nt[2],yt[3]=1+T,Dt(yt,yt))}}(),Oe=function(){var nt=q(),Ft=q();return function(he,yt,St,F,T,gt){return ue(nt,yt,T,gt),ue(Ft,St,F,gt),ue(he,nt,Ft,2*gt*(1-gt)),he}}(),Lt=function(){var nt=it.Ue();return function(Ft,he,yt,St){return nt[0]=yt[0],nt[3]=yt[1],nt[6]=yt[2],nt[1]=St[0],nt[4]=St[1],nt[7]=St[2],nt[2]=-he[0],nt[5]=-he[1],nt[8]=-he[2],Dt(Ft,ye(Ft,nt))}}()},31437:function(ke,Se,k){"use strict";k.d(Se,{$X:function(){return Wt},AK:function(){return ae},Fv:function(){return $},I6:function(){return At},IH:function(){return Bt},JG:function(){return q},Ue:function(){return it},al:function(){return qt},lu:function(){return Tt},t7:function(){return _e},t8:function(){return Zt},tk:function(){return ye}});var pt=k(49685);function it(){var yt=new pt.WT(2);return pt.WT!=Float32Array&&(yt[0]=0,yt[1]=0),yt}function _t(yt){var St=new glMatrix.ARRAY_TYPE(2);return St[0]=yt[0],St[1]=yt[1],St}function qt(yt,St){var F=new pt.WT(2);return F[0]=yt,F[1]=St,F}function q(yt,St){return yt[0]=St[0],yt[1]=St[1],yt}function Zt(yt,St,F){return yt[0]=St,yt[1]=F,yt}function Bt(yt,St,F){return yt[0]=St[0]+F[0],yt[1]=St[1]+F[1],yt}function Wt(yt,St,F){return yt[0]=St[0]-F[0],yt[1]=St[1]-F[1],yt}function ct(yt,St,F){return yt[0]=St[0]*F[0],yt[1]=St[1]*F[1],yt}function ee(yt,St,F){return yt[0]=St[0]/F[0],yt[1]=St[1]/F[1],yt}function K(yt,St){return yt[0]=Math.ceil(St[0]),yt[1]=Math.ceil(St[1]),yt}function J(yt,St){return yt[0]=Math.floor(St[0]),yt[1]=Math.floor(St[1]),yt}function Ct(yt,St,F){return yt[0]=Math.min(St[0],F[0]),yt[1]=Math.min(St[1],F[1]),yt}function ft(yt,St,F){return yt[0]=Math.max(St[0],F[0]),yt[1]=Math.max(St[1],F[1]),yt}function mt(yt,St){return yt[0]=Math.round(St[0]),yt[1]=Math.round(St[1]),yt}function lt(yt,St,F){return yt[0]=St[0]*F,yt[1]=St[1]*F,yt}function jt(yt,St,F,T){return yt[0]=St[0]+F[0]*T,yt[1]=St[1]+F[1]*T,yt}function ue(yt,St){var F=St[0]-yt[0],T=St[1]-yt[1];return Math.hypot(F,T)}function we(yt,St){var F=St[0]-yt[0],T=St[1]-yt[1];return F*F+T*T}function Ne(yt){var St=yt[0],F=yt[1];return Math.hypot(St,F)}function Ge(yt){var St=yt[0],F=yt[1];return St*St+F*F}function ye(yt,St){return yt[0]=-St[0],yt[1]=-St[1],yt}function Vt(yt,St){return yt[0]=1/St[0],yt[1]=1/St[1],yt}function $(yt,St){var F=St[0],T=St[1],gt=F*F+T*T;return gt>0&&(gt=1/Math.sqrt(gt)),yt[0]=St[0]*gt,yt[1]=St[1]*gt,yt}function ae(yt,St){return yt[0]*St[0]+yt[1]*St[1]}function Gt(yt,St,F){var T=St[0]*F[1]-St[1]*F[0];return yt[0]=yt[1]=0,yt[2]=T,yt}function _e(yt,St,F,T){var gt=St[0],ne=St[1];return yt[0]=gt+T*(F[0]-gt),yt[1]=ne+T*(F[1]-ne),yt}function xe(yt,St){St=St||1;var F=glMatrix.RANDOM()*2*Math.PI;return yt[0]=Math.cos(F)*St,yt[1]=Math.sin(F)*St,yt}function X(yt,St,F){var T=St[0],gt=St[1];return yt[0]=F[0]*T+F[2]*gt,yt[1]=F[1]*T+F[3]*gt,yt}function Rt(yt,St,F){var T=St[0],gt=St[1];return yt[0]=F[0]*T+F[2]*gt+F[4],yt[1]=F[1]*T+F[3]*gt+F[5],yt}function V(yt,St,F){var T=St[0],gt=St[1];return yt[0]=F[0]*T+F[3]*gt+F[6],yt[1]=F[1]*T+F[4]*gt+F[7],yt}function Mt(yt,St,F){var T=St[0],gt=St[1];return yt[0]=F[0]*T+F[4]*gt+F[12],yt[1]=F[1]*T+F[5]*gt+F[13],yt}function H(yt,St,F,T){var gt=St[0]-F[0],ne=St[1]-F[1],C=Math.sin(T),j=Math.cos(T);return yt[0]=gt*j-ne*C+F[0],yt[1]=gt*C+ne*j+F[1],yt}function N(yt,St){var F=yt[0],T=yt[1],gt=St[0],ne=St[1],C=Math.sqrt(F*F+T*T)*Math.sqrt(gt*gt+ne*ne),j=C&&(F*gt+T*ne)/C;return Math.acos(Math.min(Math.max(j,-1),1))}function et(yt){return yt[0]=0,yt[1]=0,yt}function ot(yt){return"vec2("+yt[0]+", "+yt[1]+")"}function At(yt,St){return yt[0]===St[0]&&yt[1]===St[1]}function Dt(yt,St){var F=yt[0],T=yt[1],gt=St[0],ne=St[1];return Math.abs(F-gt)<=glMatrix.EPSILON*Math.max(1,Math.abs(F),Math.abs(gt))&&Math.abs(T-ne)<=glMatrix.EPSILON*Math.max(1,Math.abs(T),Math.abs(ne))}var ie=null,Tt=Wt,zt=null,Oe=null,Lt=null,nt=null,Ft=null,he=function(){var yt=it();return function(St,F,T,gt,ne,C){var j,Pt;for(F||(F=2),T||(T=0),gt?Pt=Math.min(gt*F+T,St.length):Pt=St.length,j=T;j<Pt;j+=F)yt[0]=St[j],yt[1]=St[j+1],ne(yt,yt,C),St[j]=yt[0],St[j+1]=yt[1];return St}}()},77160:function(ke,Se,k){"use strict";k.d(Se,{$X:function(){return ct},AK:function(){return ae},EU:function(){return At},Fv:function(){return $},IH:function(){return Wt},JG:function(){return Zt},Jp:function(){return ee},TK:function(){return Ft},Ue:function(){return it},VC:function(){return H},Zh:function(){return yt},al:function(){return q},bA:function(){return jt},d9:function(){return _t},fF:function(){return V},fS:function(){return zt},kC:function(){return Gt},kE:function(){return qt},kK:function(){return Mt},lu:function(){return Oe},t7:function(){return _e},t8:function(){return Bt},tk:function(){return ye}});var pt=k(49685);function it(){var T=new pt.WT(3);return pt.WT!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0),T}function _t(T){var gt=new pt.WT(3);return gt[0]=T[0],gt[1]=T[1],gt[2]=T[2],gt}function qt(T){var gt=T[0],ne=T[1],C=T[2];return Math.hypot(gt,ne,C)}function q(T,gt,ne){var C=new pt.WT(3);return C[0]=T,C[1]=gt,C[2]=ne,C}function Zt(T,gt){return T[0]=gt[0],T[1]=gt[1],T[2]=gt[2],T}function Bt(T,gt,ne,C){return T[0]=gt,T[1]=ne,T[2]=C,T}function Wt(T,gt,ne){return T[0]=gt[0]+ne[0],T[1]=gt[1]+ne[1],T[2]=gt[2]+ne[2],T}function ct(T,gt,ne){return T[0]=gt[0]-ne[0],T[1]=gt[1]-ne[1],T[2]=gt[2]-ne[2],T}function ee(T,gt,ne){return T[0]=gt[0]*ne[0],T[1]=gt[1]*ne[1],T[2]=gt[2]*ne[2],T}function K(T,gt,ne){return T[0]=gt[0]/ne[0],T[1]=gt[1]/ne[1],T[2]=gt[2]/ne[2],T}function J(T,gt){return T[0]=Math.ceil(gt[0]),T[1]=Math.ceil(gt[1]),T[2]=Math.ceil(gt[2]),T}function Ct(T,gt){return T[0]=Math.floor(gt[0]),T[1]=Math.floor(gt[1]),T[2]=Math.floor(gt[2]),T}function ft(T,gt,ne){return T[0]=Math.min(gt[0],ne[0]),T[1]=Math.min(gt[1],ne[1]),T[2]=Math.min(gt[2],ne[2]),T}function mt(T,gt,ne){return T[0]=Math.max(gt[0],ne[0]),T[1]=Math.max(gt[1],ne[1]),T[2]=Math.max(gt[2],ne[2]),T}function lt(T,gt){return T[0]=Math.round(gt[0]),T[1]=Math.round(gt[1]),T[2]=Math.round(gt[2]),T}function jt(T,gt,ne){return T[0]=gt[0]*ne,T[1]=gt[1]*ne,T[2]=gt[2]*ne,T}function ue(T,gt,ne,C){return T[0]=gt[0]+ne[0]*C,T[1]=gt[1]+ne[1]*C,T[2]=gt[2]+ne[2]*C,T}function we(T,gt){var ne=gt[0]-T[0],C=gt[1]-T[1],j=gt[2]-T[2];return Math.hypot(ne,C,j)}function Ne(T,gt){var ne=gt[0]-T[0],C=gt[1]-T[1],j=gt[2]-T[2];return ne*ne+C*C+j*j}function Ge(T){var gt=T[0],ne=T[1],C=T[2];return gt*gt+ne*ne+C*C}function ye(T,gt){return T[0]=-gt[0],T[1]=-gt[1],T[2]=-gt[2],T}function Vt(T,gt){return T[0]=1/gt[0],T[1]=1/gt[1],T[2]=1/gt[2],T}function $(T,gt){var ne=gt[0],C=gt[1],j=gt[2],Pt=ne*ne+C*C+j*j;return Pt>0&&(Pt=1/Math.sqrt(Pt)),T[0]=gt[0]*Pt,T[1]=gt[1]*Pt,T[2]=gt[2]*Pt,T}function ae(T,gt){return T[0]*gt[0]+T[1]*gt[1]+T[2]*gt[2]}function Gt(T,gt,ne){var C=gt[0],j=gt[1],Pt=gt[2],Jt=ne[0],se=ne[1],Ae=ne[2];return T[0]=j*Ae-Pt*se,T[1]=Pt*Jt-C*Ae,T[2]=C*se-j*Jt,T}function _e(T,gt,ne,C){var j=gt[0],Pt=gt[1],Jt=gt[2];return T[0]=j+C*(ne[0]-j),T[1]=Pt+C*(ne[1]-Pt),T[2]=Jt+C*(ne[2]-Jt),T}function xe(T,gt,ne,C,j,Pt){var Jt=Pt*Pt,se=Jt*(2*Pt-3)+1,Ae=Jt*(Pt-2)+Pt,Le=Jt*(Pt-1),De=Jt*(3-2*Pt);return T[0]=gt[0]*se+ne[0]*Ae+C[0]*Le+j[0]*De,T[1]=gt[1]*se+ne[1]*Ae+C[1]*Le+j[1]*De,T[2]=gt[2]*se+ne[2]*Ae+C[2]*Le+j[2]*De,T}function X(T,gt,ne,C,j,Pt){var Jt=1-Pt,se=Jt*Jt,Ae=Pt*Pt,Le=se*Jt,De=3*Pt*se,Ve=3*Ae*Jt,We=Ae*Pt;return T[0]=gt[0]*Le+ne[0]*De+C[0]*Ve+j[0]*We,T[1]=gt[1]*Le+ne[1]*De+C[1]*Ve+j[1]*We,T[2]=gt[2]*Le+ne[2]*De+C[2]*Ve+j[2]*We,T}function Rt(T,gt){gt=gt||1;var ne=glMatrix.RANDOM()*2*Math.PI,C=glMatrix.RANDOM()*2-1,j=Math.sqrt(1-C*C)*gt;return T[0]=Math.cos(ne)*j,T[1]=Math.sin(ne)*j,T[2]=C*gt,T}function V(T,gt,ne){var C=gt[0],j=gt[1],Pt=gt[2],Jt=ne[3]*C+ne[7]*j+ne[11]*Pt+ne[15];return Jt=Jt||1,T[0]=(ne[0]*C+ne[4]*j+ne[8]*Pt+ne[12])/Jt,T[1]=(ne[1]*C+ne[5]*j+ne[9]*Pt+ne[13])/Jt,T[2]=(ne[2]*C+ne[6]*j+ne[10]*Pt+ne[14])/Jt,T}function Mt(T,gt,ne){var C=gt[0],j=gt[1],Pt=gt[2];return T[0]=C*ne[0]+j*ne[3]+Pt*ne[6],T[1]=C*ne[1]+j*ne[4]+Pt*ne[7],T[2]=C*ne[2]+j*ne[5]+Pt*ne[8],T}function H(T,gt,ne){var C=ne[0],j=ne[1],Pt=ne[2],Jt=ne[3],se=gt[0],Ae=gt[1],Le=gt[2],De=j*Le-Pt*Ae,Ve=Pt*se-C*Le,We=C*Ae-j*se,$e=j*We-Pt*Ve,Ye=Pt*De-C*We,Xt=C*Ve-j*De,re=Jt*2;return De*=re,Ve*=re,We*=re,$e*=2,Ye*=2,Xt*=2,T[0]=se+De+$e,T[1]=Ae+Ve+Ye,T[2]=Le+We+Xt,T}function N(T,gt,ne,C){var j=[],Pt=[];return j[0]=gt[0]-ne[0],j[1]=gt[1]-ne[1],j[2]=gt[2]-ne[2],Pt[0]=j[0],Pt[1]=j[1]*Math.cos(C)-j[2]*Math.sin(C),Pt[2]=j[1]*Math.sin(C)+j[2]*Math.cos(C),T[0]=Pt[0]+ne[0],T[1]=Pt[1]+ne[1],T[2]=Pt[2]+ne[2],T}function et(T,gt,ne,C){var j=[],Pt=[];return j[0]=gt[0]-ne[0],j[1]=gt[1]-ne[1],j[2]=gt[2]-ne[2],Pt[0]=j[2]*Math.sin(C)+j[0]*Math.cos(C),Pt[1]=j[1],Pt[2]=j[2]*Math.cos(C)-j[0]*Math.sin(C),T[0]=Pt[0]+ne[0],T[1]=Pt[1]+ne[1],T[2]=Pt[2]+ne[2],T}function ot(T,gt,ne,C){var j=[],Pt=[];return j[0]=gt[0]-ne[0],j[1]=gt[1]-ne[1],j[2]=gt[2]-ne[2],Pt[0]=j[0]*Math.cos(C)-j[1]*Math.sin(C),Pt[1]=j[0]*Math.sin(C)+j[1]*Math.cos(C),Pt[2]=j[2],T[0]=Pt[0]+ne[0],T[1]=Pt[1]+ne[1],T[2]=Pt[2]+ne[2],T}function At(T,gt){var ne=T[0],C=T[1],j=T[2],Pt=gt[0],Jt=gt[1],se=gt[2],Ae=Math.sqrt(ne*ne+C*C+j*j),Le=Math.sqrt(Pt*Pt+Jt*Jt+se*se),De=Ae*Le,Ve=De&&ae(T,gt)/De;return Math.acos(Math.min(Math.max(Ve,-1),1))}function Dt(T){return T[0]=0,T[1]=0,T[2]=0,T}function ie(T){return"vec3("+T[0]+", "+T[1]+", "+T[2]+")"}function Tt(T,gt){return T[0]===gt[0]&&T[1]===gt[1]&&T[2]===gt[2]}function zt(T,gt){var ne=T[0],C=T[1],j=T[2],Pt=gt[0],Jt=gt[1],se=gt[2];return Math.abs(ne-Pt)<=pt.Ib*Math.max(1,Math.abs(ne),Math.abs(Pt))&&Math.abs(C-Jt)<=pt.Ib*Math.max(1,Math.abs(C),Math.abs(Jt))&&Math.abs(j-se)<=pt.Ib*Math.max(1,Math.abs(j),Math.abs(se))}var Oe=ct,Lt=null,nt=null,Ft=we,he=null,yt=qt,St=null,F=function(){var T=it();return function(gt,ne,C,j,Pt,Jt){var se,Ae;for(ne||(ne=3),C||(C=0),j?Ae=Math.min(j*ne+C,gt.length):Ae=gt.length,se=C;se<Ae;se+=ne)T[0]=gt[se],T[1]=gt[se+1],T[2]=gt[se+2],Pt(T,T,Jt),gt[se]=T[0],gt[se+1]=T[1],gt[se+2]=T[2];return gt}}()},98333:function(ke,Se,k){"use strict";k.d(Se,{AK:function(){return ae},Fv:function(){return $},I6:function(){return H},IH:function(){return Bt},JG:function(){return q},Ue:function(){return it},al:function(){return qt},bA:function(){return lt},d9:function(){return _t},fF:function(){return X},fS:function(){return N},kE:function(){return Ne},t7:function(){return _e},t8:function(){return Zt},we:function(){return Ge}});var pt=k(49685);function it(){var Lt=new pt.WT(4);return pt.WT!=Float32Array&&(Lt[0]=0,Lt[1]=0,Lt[2]=0,Lt[3]=0),Lt}function _t(Lt){var nt=new pt.WT(4);return nt[0]=Lt[0],nt[1]=Lt[1],nt[2]=Lt[2],nt[3]=Lt[3],nt}function qt(Lt,nt,Ft,he){var yt=new pt.WT(4);return yt[0]=Lt,yt[1]=nt,yt[2]=Ft,yt[3]=he,yt}function q(Lt,nt){return Lt[0]=nt[0],Lt[1]=nt[1],Lt[2]=nt[2],Lt[3]=nt[3],Lt}function Zt(Lt,nt,Ft,he,yt){return Lt[0]=nt,Lt[1]=Ft,Lt[2]=he,Lt[3]=yt,Lt}function Bt(Lt,nt,Ft){return Lt[0]=nt[0]+Ft[0],Lt[1]=nt[1]+Ft[1],Lt[2]=nt[2]+Ft[2],Lt[3]=nt[3]+Ft[3],Lt}function Wt(Lt,nt,Ft){return Lt[0]=nt[0]-Ft[0],Lt[1]=nt[1]-Ft[1],Lt[2]=nt[2]-Ft[2],Lt[3]=nt[3]-Ft[3],Lt}function ct(Lt,nt,Ft){return Lt[0]=nt[0]*Ft[0],Lt[1]=nt[1]*Ft[1],Lt[2]=nt[2]*Ft[2],Lt[3]=nt[3]*Ft[3],Lt}function ee(Lt,nt,Ft){return Lt[0]=nt[0]/Ft[0],Lt[1]=nt[1]/Ft[1],Lt[2]=nt[2]/Ft[2],Lt[3]=nt[3]/Ft[3],Lt}function K(Lt,nt){return Lt[0]=Math.ceil(nt[0]),Lt[1]=Math.ceil(nt[1]),Lt[2]=Math.ceil(nt[2]),Lt[3]=Math.ceil(nt[3]),Lt}function J(Lt,nt){return Lt[0]=Math.floor(nt[0]),Lt[1]=Math.floor(nt[1]),Lt[2]=Math.floor(nt[2]),Lt[3]=Math.floor(nt[3]),Lt}function Ct(Lt,nt,Ft){return Lt[0]=Math.min(nt[0],Ft[0]),Lt[1]=Math.min(nt[1],Ft[1]),Lt[2]=Math.min(nt[2],Ft[2]),Lt[3]=Math.min(nt[3],Ft[3]),Lt}function ft(Lt,nt,Ft){return Lt[0]=Math.max(nt[0],Ft[0]),Lt[1]=Math.max(nt[1],Ft[1]),Lt[2]=Math.max(nt[2],Ft[2]),Lt[3]=Math.max(nt[3],Ft[3]),Lt}function mt(Lt,nt){return Lt[0]=Math.round(nt[0]),Lt[1]=Math.round(nt[1]),Lt[2]=Math.round(nt[2]),Lt[3]=Math.round(nt[3]),Lt}function lt(Lt,nt,Ft){return Lt[0]=nt[0]*Ft,Lt[1]=nt[1]*Ft,Lt[2]=nt[2]*Ft,Lt[3]=nt[3]*Ft,Lt}function jt(Lt,nt,Ft,he){return Lt[0]=nt[0]+Ft[0]*he,Lt[1]=nt[1]+Ft[1]*he,Lt[2]=nt[2]+Ft[2]*he,Lt[3]=nt[3]+Ft[3]*he,Lt}function ue(Lt,nt){var Ft=nt[0]-Lt[0],he=nt[1]-Lt[1],yt=nt[2]-Lt[2],St=nt[3]-Lt[3];return Math.hypot(Ft,he,yt,St)}function we(Lt,nt){var Ft=nt[0]-Lt[0],he=nt[1]-Lt[1],yt=nt[2]-Lt[2],St=nt[3]-Lt[3];return Ft*Ft+he*he+yt*yt+St*St}function Ne(Lt){var nt=Lt[0],Ft=Lt[1],he=Lt[2],yt=Lt[3];return Math.hypot(nt,Ft,he,yt)}function Ge(Lt){var nt=Lt[0],Ft=Lt[1],he=Lt[2],yt=Lt[3];return nt*nt+Ft*Ft+he*he+yt*yt}function ye(Lt,nt){return Lt[0]=-nt[0],Lt[1]=-nt[1],Lt[2]=-nt[2],Lt[3]=-nt[3],Lt}function Vt(Lt,nt){return Lt[0]=1/nt[0],Lt[1]=1/nt[1],Lt[2]=1/nt[2],Lt[3]=1/nt[3],Lt}function $(Lt,nt){var Ft=nt[0],he=nt[1],yt=nt[2],St=nt[3],F=Ft*Ft+he*he+yt*yt+St*St;return F>0&&(F=1/Math.sqrt(F)),Lt[0]=Ft*F,Lt[1]=he*F,Lt[2]=yt*F,Lt[3]=St*F,Lt}function ae(Lt,nt){return Lt[0]*nt[0]+Lt[1]*nt[1]+Lt[2]*nt[2]+Lt[3]*nt[3]}function Gt(Lt,nt,Ft,he){var yt=Ft[0]*he[1]-Ft[1]*he[0],St=Ft[0]*he[2]-Ft[2]*he[0],F=Ft[0]*he[3]-Ft[3]*he[0],T=Ft[1]*he[2]-Ft[2]*he[1],gt=Ft[1]*he[3]-Ft[3]*he[1],ne=Ft[2]*he[3]-Ft[3]*he[2],C=nt[0],j=nt[1],Pt=nt[2],Jt=nt[3];return Lt[0]=j*ne-Pt*gt+Jt*T,Lt[1]=-(C*ne)+Pt*F-Jt*St,Lt[2]=C*gt-j*F+Jt*yt,Lt[3]=-(C*T)+j*St-Pt*yt,Lt}function _e(Lt,nt,Ft,he){var yt=nt[0],St=nt[1],F=nt[2],T=nt[3];return Lt[0]=yt+he*(Ft[0]-yt),Lt[1]=St+he*(Ft[1]-St),Lt[2]=F+he*(Ft[2]-F),Lt[3]=T+he*(Ft[3]-T),Lt}function xe(Lt,nt){nt=nt||1;var Ft,he,yt,St,F,T;do Ft=glMatrix.RANDOM()*2-1,he=glMatrix.RANDOM()*2-1,F=Ft*Ft+he*he;while(F>=1);do yt=glMatrix.RANDOM()*2-1,St=glMatrix.RANDOM()*2-1,T=yt*yt+St*St;while(T>=1);var gt=Math.sqrt((1-F)/T);return Lt[0]=nt*Ft,Lt[1]=nt*he,Lt[2]=nt*yt*gt,Lt[3]=nt*St*gt,Lt}function X(Lt,nt,Ft){var he=nt[0],yt=nt[1],St=nt[2],F=nt[3];return Lt[0]=Ft[0]*he+Ft[4]*yt+Ft[8]*St+Ft[12]*F,Lt[1]=Ft[1]*he+Ft[5]*yt+Ft[9]*St+Ft[13]*F,Lt[2]=Ft[2]*he+Ft[6]*yt+Ft[10]*St+Ft[14]*F,Lt[3]=Ft[3]*he+Ft[7]*yt+Ft[11]*St+Ft[15]*F,Lt}function Rt(Lt,nt,Ft){var he=nt[0],yt=nt[1],St=nt[2],F=Ft[0],T=Ft[1],gt=Ft[2],ne=Ft[3],C=ne*he+T*St-gt*yt,j=ne*yt+gt*he-F*St,Pt=ne*St+F*yt-T*he,Jt=-F*he-T*yt-gt*St;return Lt[0]=C*ne+Jt*-F+j*-gt-Pt*-T,Lt[1]=j*ne+Jt*-T+Pt*-F-C*-gt,Lt[2]=Pt*ne+Jt*-gt+C*-T-j*-F,Lt[3]=nt[3],Lt}function V(Lt){return Lt[0]=0,Lt[1]=0,Lt[2]=0,Lt[3]=0,Lt}function Mt(Lt){return"vec4("+Lt[0]+", "+Lt[1]+", "+Lt[2]+", "+Lt[3]+")"}function H(Lt,nt){return Lt[0]===nt[0]&&Lt[1]===nt[1]&&Lt[2]===nt[2]&&Lt[3]===nt[3]}function N(Lt,nt){var Ft=Lt[0],he=Lt[1],yt=Lt[2],St=Lt[3],F=nt[0],T=nt[1],gt=nt[2],ne=nt[3];return Math.abs(Ft-F)<=pt.Ib*Math.max(1,Math.abs(Ft),Math.abs(F))&&Math.abs(he-T)<=pt.Ib*Math.max(1,Math.abs(he),Math.abs(T))&&Math.abs(yt-gt)<=pt.Ib*Math.max(1,Math.abs(yt),Math.abs(gt))&&Math.abs(St-ne)<=pt.Ib*Math.max(1,Math.abs(St),Math.abs(ne))}var et=null,ot=null,At=null,Dt=null,ie=null,Tt=null,zt=null,Oe=function(){var Lt=it();return function(nt,Ft,he,yt,St,F){var T,gt;for(Ft||(Ft=4),he||(he=0),yt?gt=Math.min(yt*Ft+he,nt.length):gt=nt.length,T=he;T<gt;T+=Ft)Lt[0]=nt[T],Lt[1]=nt[T+1],Lt[2]=nt[T+2],Lt[3]=nt[T+3],St(Lt,Lt,F),nt[T]=Lt[0],nt[T+1]=Lt[1],nt[T+2]=Lt[2],nt[T+3]=Lt[3];return nt}}()},50840:function(ke,Se,k){var pt;(function(it,_t,qt,q){"use strict";var Zt=["","webkit","Moz","MS","ms","o"],Bt=_t.createElement("div"),Wt="function",ct=Math.round,ee=Math.abs,K=Date.now;function J(kt,Yt,be){return setTimeout(Ne(kt,be),Yt)}function Ct(kt,Yt,be){return Array.isArray(kt)?(ft(kt,be[Yt],be),!0):!1}function ft(kt,Yt,be){var Xe;if(kt)if(kt.forEach)kt.forEach(Yt,be);else if(kt.length!==q)for(Xe=0;Xe<kt.length;)Yt.call(be,kt[Xe],Xe,kt),Xe++;else for(Xe in kt)kt.hasOwnProperty(Xe)&&Yt.call(be,kt[Xe],Xe,kt)}function mt(kt,Yt,be){var Xe="DEPRECATED METHOD: "+Yt+`
`+be+` AT 
`;return function(){var fn=new Error("get-stack-trace"),Tn=fn&&fn.stack?fn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Zn=it.console&&(it.console.warn||it.console.log);return Zn&&Zn.call(it.console,Xe,Tn),kt.apply(this,arguments)}}var lt;typeof Object.assign!="function"?lt=function(Yt){if(Yt===q||Yt===null)throw new TypeError("Cannot convert undefined or null to object");for(var be=Object(Yt),Xe=1;Xe<arguments.length;Xe++){var fn=arguments[Xe];if(fn!==q&&fn!==null)for(var Tn in fn)fn.hasOwnProperty(Tn)&&(be[Tn]=fn[Tn])}return be}:lt=Object.assign;var jt=mt(function(Yt,be,Xe){for(var fn=Object.keys(be),Tn=0;Tn<fn.length;)(!Xe||Xe&&Yt[fn[Tn]]===q)&&(Yt[fn[Tn]]=be[fn[Tn]]),Tn++;return Yt},"extend","Use `assign`."),ue=mt(function(Yt,be){return jt(Yt,be,!0)},"merge","Use `assign`.");function we(kt,Yt,be){var Xe=Yt.prototype,fn;fn=kt.prototype=Object.create(Xe),fn.constructor=kt,fn._super=Xe,be&&lt(fn,be)}function Ne(kt,Yt){return function(){return kt.apply(Yt,arguments)}}function Ge(kt,Yt){return typeof kt==Wt?kt.apply(Yt&&Yt[0]||q,Yt):kt}function ye(kt,Yt){return kt===q?Yt:kt}function Vt(kt,Yt,be){ft(_e(Yt),function(Xe){kt.addEventListener(Xe,be,!1)})}function $(kt,Yt,be){ft(_e(Yt),function(Xe){kt.removeEventListener(Xe,be,!1)})}function ae(kt,Yt){for(;kt;){if(kt==Yt)return!0;kt=kt.parentNode}return!1}function Gt(kt,Yt){return kt.indexOf(Yt)>-1}function _e(kt){return kt.trim().split(/\s+/g)}function xe(kt,Yt,be){if(kt.indexOf&&!be)return kt.indexOf(Yt);for(var Xe=0;Xe<kt.length;){if(be&&kt[Xe][be]==Yt||!be&&kt[Xe]===Yt)return Xe;Xe++}return-1}function X(kt){return Array.prototype.slice.call(kt,0)}function Rt(kt,Yt,be){for(var Xe=[],fn=[],Tn=0;Tn<kt.length;){var Zn=Yt?kt[Tn][Yt]:kt[Tn];xe(fn,Zn)<0&&Xe.push(kt[Tn]),fn[Tn]=Zn,Tn++}return be&&(Yt?Xe=Xe.sort(function(ei,xr){return ei[Yt]>xr[Yt]}):Xe=Xe.sort()),Xe}function V(kt,Yt){for(var be,Xe,fn=Yt[0].toUpperCase()+Yt.slice(1),Tn=0;Tn<Zt.length;){if(be=Zt[Tn],Xe=be?be+fn:Yt,Xe in kt)return Xe;Tn++}return q}var Mt=1;function H(){return Mt++}function N(kt){var Yt=kt.ownerDocument||kt;return Yt.defaultView||Yt.parentWindow||it}var et=/mobile|tablet|ip(ad|hone|od)|android/i,ot="ontouchstart"in it,At=V(it,"PointerEvent")!==q,Dt=ot&&et.test(navigator.userAgent),ie="touch",Tt="pen",zt="mouse",Oe="kinect",Lt=25,nt=1,Ft=2,he=4,yt=8,St=1,F=2,T=4,gt=8,ne=16,C=F|T,j=gt|ne,Pt=C|j,Jt=["x","y"],se=["clientX","clientY"];function Ae(kt,Yt){var be=this;this.manager=kt,this.callback=Yt,this.element=kt.element,this.target=kt.options.inputTarget,this.domHandler=function(Xe){Ge(kt.options.enable,[kt])&&be.handler(Xe)},this.init()}Ae.prototype={handler:function(){},init:function(){this.evEl&&Vt(this.element,this.evEl,this.domHandler),this.evTarget&&Vt(this.target,this.evTarget,this.domHandler),this.evWin&&Vt(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(N(this.element),this.evWin,this.domHandler)}};function Le(kt){var Yt,be=kt.options.inputClass;return be?Yt=be:At?Yt=Re:Dt?Yt=yr:ot?Yt=Fr:Yt=ce,new Yt(kt,De)}function De(kt,Yt,be){var Xe=be.pointers.length,fn=be.changedPointers.length,Tn=Yt&nt&&Xe-fn===0,Zn=Yt&(he|yt)&&Xe-fn===0;be.isFirst=!!Tn,be.isFinal=!!Zn,Tn&&(kt.session={}),be.eventType=Yt,Ve(kt,be),kt.emit("hammer.input",be),kt.recognize(be),kt.session.prevInput=be}function Ve(kt,Yt){var be=kt.session,Xe=Yt.pointers,fn=Xe.length;be.firstInput||(be.firstInput=Ye(Yt)),fn>1&&!be.firstMultiple?be.firstMultiple=Ye(Yt):fn===1&&(be.firstMultiple=!1);var Tn=be.firstInput,Zn=be.firstMultiple,Zr=Zn?Zn.center:Tn.center,ei=Yt.center=Xt(Xe);Yt.timeStamp=K(),Yt.deltaTime=Yt.timeStamp-Tn.timeStamp,Yt.angle=Q(Zr,ei),Yt.distance=pe(Zr,ei),We(be,Yt),Yt.offsetDirection=le(Yt.deltaX,Yt.deltaY);var xr=re(Yt.deltaTime,Yt.deltaX,Yt.deltaY);Yt.overallVelocityX=xr.x,Yt.overallVelocityY=xr.y,Yt.overallVelocity=ee(xr.x)>ee(xr.y)?xr.x:xr.y,Yt.scale=Zn?Z(Zn.pointers,Xe):1,Yt.rotation=Zn?D(Zn.pointers,Xe):0,Yt.maxPointers=be.prevInput?Yt.pointers.length>be.prevInput.maxPointers?Yt.pointers.length:be.prevInput.maxPointers:Yt.pointers.length,$e(be,Yt);var ii=kt.element;ae(Yt.srcEvent.target,ii)&&(ii=Yt.srcEvent.target),Yt.target=ii}function We(kt,Yt){var be=Yt.center,Xe=kt.offsetDelta||{},fn=kt.prevDelta||{},Tn=kt.prevInput||{};(Yt.eventType===nt||Tn.eventType===he)&&(fn=kt.prevDelta={x:Tn.deltaX||0,y:Tn.deltaY||0},Xe=kt.offsetDelta={x:be.x,y:be.y}),Yt.deltaX=fn.x+(be.x-Xe.x),Yt.deltaY=fn.y+(be.y-Xe.y)}function $e(kt,Yt){var be=kt.lastInterval||Yt,Xe=Yt.timeStamp-be.timeStamp,fn,Tn,Zn,Zr;if(Yt.eventType!=yt&&(Xe>Lt||be.velocity===q)){var ei=Yt.deltaX-be.deltaX,xr=Yt.deltaY-be.deltaY,ii=re(Xe,ei,xr);Tn=ii.x,Zn=ii.y,fn=ee(ii.x)>ee(ii.y)?ii.x:ii.y,Zr=le(ei,xr),kt.lastInterval=Yt}else fn=be.velocity,Tn=be.velocityX,Zn=be.velocityY,Zr=be.direction;Yt.velocity=fn,Yt.velocityX=Tn,Yt.velocityY=Zn,Yt.direction=Zr}function Ye(kt){for(var Yt=[],be=0;be<kt.pointers.length;)Yt[be]={clientX:ct(kt.pointers[be].clientX),clientY:ct(kt.pointers[be].clientY)},be++;return{timeStamp:K(),pointers:Yt,center:Xt(Yt),deltaX:kt.deltaX,deltaY:kt.deltaY}}function Xt(kt){var Yt=kt.length;if(Yt===1)return{x:ct(kt[0].clientX),y:ct(kt[0].clientY)};for(var be=0,Xe=0,fn=0;fn<Yt;)be+=kt[fn].clientX,Xe+=kt[fn].clientY,fn++;return{x:ct(be/Yt),y:ct(Xe/Yt)}}function re(kt,Yt,be){return{x:Yt/kt||0,y:be/kt||0}}function le(kt,Yt){return kt===Yt?St:ee(kt)>=ee(Yt)?kt<0?F:T:Yt<0?gt:ne}function pe(kt,Yt,be){be||(be=Jt);var Xe=Yt[be[0]]-kt[be[0]],fn=Yt[be[1]]-kt[be[1]];return Math.sqrt(Xe*Xe+fn*fn)}function Q(kt,Yt,be){be||(be=Jt);var Xe=Yt[be[0]]-kt[be[0]],fn=Yt[be[1]]-kt[be[1]];return Math.atan2(fn,Xe)*180/Math.PI}function D(kt,Yt){return Q(Yt[1],Yt[0],se)+Q(kt[1],kt[0],se)}function Z(kt,Yt){return pe(Yt[0],Yt[1],se)/pe(kt[0],kt[1],se)}var tt={mousedown:nt,mousemove:Ft,mouseup:he},Et="mousedown",It="mousemove mouseup";function ce(){this.evEl=Et,this.evWin=It,this.pressed=!1,Ae.apply(this,arguments)}we(ce,Ae,{handler:function(Yt){var be=tt[Yt.type];be&nt&&Yt.button===0&&(this.pressed=!0),be&Ft&&Yt.which!==1&&(be=he),this.pressed&&(be&he&&(this.pressed=!1),this.callback(this.manager,be,{pointers:[Yt],changedPointers:[Yt],pointerType:zt,srcEvent:Yt}))}});var fe={pointerdown:nt,pointermove:Ft,pointerup:he,pointercancel:yt,pointerout:yt},Be={2:ie,3:Tt,4:zt,5:Oe},ze="pointerdown",an="pointermove pointerup pointercancel";it.MSPointerEvent&&!it.PointerEvent&&(ze="MSPointerDown",an="MSPointerMove MSPointerUp MSPointerCancel");function Re(){this.evEl=ze,this.evWin=an,Ae.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}we(Re,Ae,{handler:function(Yt){var be=this.store,Xe=!1,fn=Yt.type.toLowerCase().replace("ms",""),Tn=fe[fn],Zn=Be[Yt.pointerType]||Yt.pointerType,Zr=Zn==ie,ei=xe(be,Yt.pointerId,"pointerId");Tn&nt&&(Yt.button===0||Zr)?ei<0&&(be.push(Yt),ei=be.length-1):Tn&(he|yt)&&(Xe=!0),!(ei<0)&&(be[ei]=Yt,this.callback(this.manager,Tn,{pointers:be,changedPointers:[Yt],pointerType:Zn,srcEvent:Yt}),Xe&&be.splice(ei,1))}});var Ke={touchstart:nt,touchmove:Ft,touchend:he,touchcancel:yt},cn="touchstart",pn="touchstart touchmove touchend touchcancel";function An(){this.evTarget=cn,this.evWin=pn,this.started=!1,Ae.apply(this,arguments)}we(An,Ae,{handler:function(Yt){var be=Ke[Yt.type];if(be===nt&&(this.started=!0),!!this.started){var Xe=Gn.call(this,Yt,be);be&(he|yt)&&Xe[0].length-Xe[1].length===0&&(this.started=!1),this.callback(this.manager,be,{pointers:Xe[0],changedPointers:Xe[1],pointerType:ie,srcEvent:Yt})}}});function Gn(kt,Yt){var be=X(kt.touches),Xe=X(kt.changedTouches);return Yt&(he|yt)&&(be=Rt(be.concat(Xe),"identifier",!0)),[be,Xe]}var Vn={touchstart:nt,touchmove:Ft,touchend:he,touchcancel:yt},fr="touchstart touchmove touchend touchcancel";function yr(){this.evTarget=fr,this.targetIds={},Ae.apply(this,arguments)}we(yr,Ae,{handler:function(Yt){var be=Vn[Yt.type],Xe=Cr.call(this,Yt,be);Xe&&this.callback(this.manager,be,{pointers:Xe[0],changedPointers:Xe[1],pointerType:ie,srcEvent:Yt})}});function Cr(kt,Yt){var be=X(kt.touches),Xe=this.targetIds;if(Yt&(nt|Ft)&&be.length===1)return Xe[be[0].identifier]=!0,[be,be];var fn,Tn,Zn=X(kt.changedTouches),Zr=[],ei=this.target;if(Tn=be.filter(function(xr){return ae(xr.target,ei)}),Yt===nt)for(fn=0;fn<Tn.length;)Xe[Tn[fn].identifier]=!0,fn++;for(fn=0;fn<Zn.length;)Xe[Zn[fn].identifier]&&Zr.push(Zn[fn]),Yt&(he|yt)&&delete Xe[Zn[fn].identifier],fn++;if(Zr.length)return[Rt(Tn.concat(Zr),"identifier",!0),Zr]}var jr=2500,Dr=25;function Fr(){Ae.apply(this,arguments);var kt=Ne(this.handler,this);this.touch=new yr(this.manager,kt),this.mouse=new ce(this.manager,kt),this.primaryTouch=null,this.lastTouches=[]}we(Fr,Ae,{handler:function(Yt,be,Xe){var fn=Xe.pointerType==ie,Tn=Xe.pointerType==zt;if(!(Tn&&Xe.sourceCapabilities&&Xe.sourceCapabilities.firesTouchEvents)){if(fn)zr.call(this,be,Xe);else if(Tn&&ki.call(this,Xe))return;this.callback(Yt,be,Xe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function zr(kt,Yt){kt&nt?(this.primaryTouch=Yt.changedPointers[0].identifier,si.call(this,Yt)):kt&(he|yt)&&si.call(this,Yt)}function si(kt){var Yt=kt.changedPointers[0];if(Yt.identifier===this.primaryTouch){var be={x:Yt.clientX,y:Yt.clientY};this.lastTouches.push(be);var Xe=this.lastTouches,fn=function(){var Tn=Xe.indexOf(be);Tn>-1&&Xe.splice(Tn,1)};setTimeout(fn,jr)}}function ki(kt){for(var Yt=kt.srcEvent.clientX,be=kt.srcEvent.clientY,Xe=0;Xe<this.lastTouches.length;Xe++){var fn=this.lastTouches[Xe],Tn=Math.abs(Yt-fn.x),Zn=Math.abs(be-fn.y);if(Tn<=Dr&&Zn<=Dr)return!0}return!1}var ui=V(Bt.style,"touchAction"),ri=ui!==q,Oi="compute",Ui="auto",Zo="manipulation",Xi="none",bo="pan-x",Xr="pan-y",ti=Qt();function rt(kt,Yt){this.manager=kt,this.set(Yt)}rt.prototype={set:function(kt){kt==Oi&&(kt=this.compute()),ri&&this.manager.element.style&&ti[kt]&&(this.manager.element.style[ui]=kt),this.actions=kt.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var kt=[];return ft(this.manager.recognizers,function(Yt){Ge(Yt.options.enable,[Yt])&&(kt=kt.concat(Yt.getTouchAction()))}),ht(kt.join(" "))},preventDefaults:function(kt){var Yt=kt.srcEvent,be=kt.offsetDirection;if(this.manager.session.prevented){Yt.preventDefault();return}var Xe=this.actions,fn=Gt(Xe,Xi)&&!ti[Xi],Tn=Gt(Xe,Xr)&&!ti[Xr],Zn=Gt(Xe,bo)&&!ti[bo];if(fn){var Zr=kt.pointers.length===1,ei=kt.distance<2,xr=kt.deltaTime<250;if(Zr&&ei&&xr)return}if(!(Zn&&Tn)&&(fn||Tn&&be&C||Zn&&be&j))return this.preventSrc(Yt)},preventSrc:function(kt){this.manager.session.prevented=!0,kt.preventDefault()}};function ht(kt){if(Gt(kt,Xi))return Xi;var Yt=Gt(kt,bo),be=Gt(kt,Xr);return Yt&&be?Xi:Yt||be?Yt?bo:Xr:Gt(kt,Zo)?Zo:Ui}function Qt(){if(!ri)return!1;var kt={},Yt=it.CSS&&it.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(be){kt[be]=Yt?it.CSS.supports("touch-action",be):!0}),kt}var de=1,Ce=2,Me=4,ge=8,ve=ge,Ue=16,He=32;function hn(kt){this.options=lt({},this.defaults,kt||{}),this.id=H(),this.manager=null,this.options.enable=ye(this.options.enable,!0),this.state=de,this.simultaneous={},this.requireFail=[]}hn.prototype={defaults:{},set:function(kt){return lt(this.options,kt),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(kt){if(Ct(kt,"recognizeWith",this))return this;var Yt=this.simultaneous;return kt=dn(kt,this),Yt[kt.id]||(Yt[kt.id]=kt,kt.recognizeWith(this)),this},dropRecognizeWith:function(kt){return Ct(kt,"dropRecognizeWith",this)?this:(kt=dn(kt,this),delete this.simultaneous[kt.id],this)},requireFailure:function(kt){if(Ct(kt,"requireFailure",this))return this;var Yt=this.requireFail;return kt=dn(kt,this),xe(Yt,kt)===-1&&(Yt.push(kt),kt.requireFailure(this)),this},dropRequireFailure:function(kt){if(Ct(kt,"dropRequireFailure",this))return this;kt=dn(kt,this);var Yt=xe(this.requireFail,kt);return Yt>-1&&this.requireFail.splice(Yt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(kt){return!!this.simultaneous[kt.id]},emit:function(kt){var Yt=this,be=this.state;function Xe(fn){Yt.manager.emit(fn,kt)}be<ge&&Xe(Yt.options.event+vn(be)),Xe(Yt.options.event),kt.additionalEvent&&Xe(kt.additionalEvent),be>=ge&&Xe(Yt.options.event+vn(be))},tryEmit:function(kt){if(this.canEmit())return this.emit(kt);this.state=He},canEmit:function(){for(var kt=0;kt<this.requireFail.length;){if(!(this.requireFail[kt].state&(He|de)))return!1;kt++}return!0},recognize:function(kt){var Yt=lt({},kt);if(!Ge(this.options.enable,[this,Yt])){this.reset(),this.state=He;return}this.state&(ve|Ue|He)&&(this.state=de),this.state=this.process(Yt),this.state&(Ce|Me|ge|Ue)&&this.tryEmit(Yt)},process:function(kt){},getTouchAction:function(){},reset:function(){}};function vn(kt){return kt&Ue?"cancel":kt&ge?"end":kt&Me?"move":kt&Ce?"start":""}function Ln(kt){return kt==ne?"down":kt==gt?"up":kt==F?"left":kt==T?"right":""}function dn(kt,Yt){var be=Yt.manager;return be?be.get(kt):kt}function Sn(){hn.apply(this,arguments)}we(Sn,hn,{defaults:{pointers:1},attrTest:function(kt){var Yt=this.options.pointers;return Yt===0||kt.pointers.length===Yt},process:function(kt){var Yt=this.state,be=kt.eventType,Xe=Yt&(Ce|Me),fn=this.attrTest(kt);return Xe&&(be&yt||!fn)?Yt|Ue:Xe||fn?be&he?Yt|ge:Yt&Ce?Yt|Me:Ce:He}});function On(){Sn.apply(this,arguments),this.pX=null,this.pY=null}we(On,Sn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pt},getTouchAction:function(){var kt=this.options.direction,Yt=[];return kt&C&&Yt.push(Xr),kt&j&&Yt.push(bo),Yt},directionTest:function(kt){var Yt=this.options,be=!0,Xe=kt.distance,fn=kt.direction,Tn=kt.deltaX,Zn=kt.deltaY;return fn&Yt.direction||(Yt.direction&C?(fn=Tn===0?St:Tn<0?F:T,be=Tn!=this.pX,Xe=Math.abs(kt.deltaX)):(fn=Zn===0?St:Zn<0?gt:ne,be=Zn!=this.pY,Xe=Math.abs(kt.deltaY))),kt.direction=fn,be&&Xe>Yt.threshold&&fn&Yt.direction},attrTest:function(kt){return Sn.prototype.attrTest.call(this,kt)&&(this.state&Ce||!(this.state&Ce)&&this.directionTest(kt))},emit:function(kt){this.pX=kt.deltaX,this.pY=kt.deltaY;var Yt=Ln(kt.direction);Yt&&(kt.additionalEvent=this.options.event+Yt),this._super.emit.call(this,kt)}});function un(){Sn.apply(this,arguments)}we(un,Sn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xi]},attrTest:function(kt){return this._super.attrTest.call(this,kt)&&(Math.abs(kt.scale-1)>this.options.threshold||this.state&Ce)},emit:function(kt){if(kt.scale!==1){var Yt=kt.scale<1?"in":"out";kt.additionalEvent=this.options.event+Yt}this._super.emit.call(this,kt)}});function zn(){hn.apply(this,arguments),this._timer=null,this._input=null}we(zn,hn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ui]},process:function(kt){var Yt=this.options,be=kt.pointers.length===Yt.pointers,Xe=kt.distance<Yt.threshold,fn=kt.deltaTime>Yt.time;if(this._input=kt,!Xe||!be||kt.eventType&(he|yt)&&!fn)this.reset();else if(kt.eventType&nt)this.reset(),this._timer=J(function(){this.state=ve,this.tryEmit()},Yt.time,this);else if(kt.eventType&he)return ve;return He},reset:function(){clearTimeout(this._timer)},emit:function(kt){this.state===ve&&(kt&&kt.eventType&he?this.manager.emit(this.options.event+"up",kt):(this._input.timeStamp=K(),this.manager.emit(this.options.event,this._input)))}});function Pn(){Sn.apply(this,arguments)}we(Pn,Sn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xi]},attrTest:function(kt){return this._super.attrTest.call(this,kt)&&(Math.abs(kt.rotation)>this.options.threshold||this.state&Ce)}});function Un(){Sn.apply(this,arguments)}we(Un,Sn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:C|j,pointers:1},getTouchAction:function(){return On.prototype.getTouchAction.call(this)},attrTest:function(kt){var Yt=this.options.direction,be;return Yt&(C|j)?be=kt.overallVelocity:Yt&C?be=kt.overallVelocityX:Yt&j&&(be=kt.overallVelocityY),this._super.attrTest.call(this,kt)&&Yt&kt.offsetDirection&&kt.distance>this.options.threshold&&kt.maxPointers==this.options.pointers&&ee(be)>this.options.velocity&&kt.eventType&he},emit:function(kt){var Yt=Ln(kt.offsetDirection);Yt&&this.manager.emit(this.options.event+Yt,kt),this.manager.emit(this.options.event,kt)}});function En(){hn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}we(En,hn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Zo]},process:function(kt){var Yt=this.options,be=kt.pointers.length===Yt.pointers,Xe=kt.distance<Yt.threshold,fn=kt.deltaTime<Yt.time;if(this.reset(),kt.eventType&nt&&this.count===0)return this.failTimeout();if(Xe&&fn&&be){if(kt.eventType!=he)return this.failTimeout();var Tn=this.pTime?kt.timeStamp-this.pTime<Yt.interval:!0,Zn=!this.pCenter||pe(this.pCenter,kt.center)<Yt.posThreshold;this.pTime=kt.timeStamp,this.pCenter=kt.center,!Zn||!Tn?this.count=1:this.count+=1,this._input=kt;var Zr=this.count%Yt.taps;if(Zr===0)return this.hasRequireFailures()?(this._timer=J(function(){this.state=ve,this.tryEmit()},Yt.interval,this),Ce):ve}return He},failTimeout:function(){return this._timer=J(function(){this.state=He},this.options.interval,this),He},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ve&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Dn(kt,Yt){return Yt=Yt||{},Yt.recognizers=ye(Yt.recognizers,Dn.defaults.preset),new fi(kt,Yt)}Dn.VERSION="2.0.7",Dn.defaults={domEvents:!1,touchAction:Oi,enable:!0,inputTarget:null,inputClass:null,preset:[[Pn,{enable:!1}],[un,{enable:!1},["rotate"]],[Un,{direction:C}],[On,{direction:C},["swipe"]],[En],[En,{event:"doubletap",taps:2},["tap"]],[zn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var tr=1,Ei=2;function fi(kt,Yt){this.options=lt({},Dn.defaults,Yt||{}),this.options.inputTarget=this.options.inputTarget||kt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=kt,this.input=Le(this),this.touchAction=new rt(this,this.options.touchAction),Ur(this,!0),ft(this.options.recognizers,function(be){var Xe=this.add(new be[0](be[1]));be[2]&&Xe.recognizeWith(be[2]),be[3]&&Xe.requireFailure(be[3])},this)}fi.prototype={set:function(kt){return lt(this.options,kt),kt.touchAction&&this.touchAction.update(),kt.inputTarget&&(this.input.destroy(),this.input.target=kt.inputTarget,this.input.init()),this},stop:function(kt){this.session.stopped=kt?Ei:tr},recognize:function(kt){var Yt=this.session;if(!Yt.stopped){this.touchAction.preventDefaults(kt);var be,Xe=this.recognizers,fn=Yt.curRecognizer;(!fn||fn&&fn.state&ve)&&(fn=Yt.curRecognizer=null);for(var Tn=0;Tn<Xe.length;)be=Xe[Tn],Yt.stopped!==Ei&&(!fn||be==fn||be.canRecognizeWith(fn))?be.recognize(kt):be.reset(),!fn&&be.state&(Ce|Me|ge)&&(fn=Yt.curRecognizer=be),Tn++}},get:function(kt){if(kt instanceof hn)return kt;for(var Yt=this.recognizers,be=0;be<Yt.length;be++)if(Yt[be].options.event==kt)return Yt[be];return null},add:function(kt){if(Ct(kt,"add",this))return this;var Yt=this.get(kt.options.event);return Yt&&this.remove(Yt),this.recognizers.push(kt),kt.manager=this,this.touchAction.update(),kt},remove:function(kt){if(Ct(kt,"remove",this))return this;if(kt=this.get(kt),kt){var Yt=this.recognizers,be=xe(Yt,kt);be!==-1&&(Yt.splice(be,1),this.touchAction.update())}return this},on:function(kt,Yt){if(kt!==q&&Yt!==q){var be=this.handlers;return ft(_e(kt),function(Xe){be[Xe]=be[Xe]||[],be[Xe].push(Yt)}),this}},off:function(kt,Yt){if(kt!==q){var be=this.handlers;return ft(_e(kt),function(Xe){Yt?be[Xe]&&be[Xe].splice(xe(be[Xe],Yt),1):delete be[Xe]}),this}},emit:function(kt,Yt){this.options.domEvents&&wi(kt,Yt);var be=this.handlers[kt]&&this.handlers[kt].slice();if(!(!be||!be.length)){Yt.type=kt,Yt.preventDefault=function(){Yt.srcEvent.preventDefault()};for(var Xe=0;Xe<be.length;)be[Xe](Yt),Xe++}},destroy:function(){this.element&&Ur(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ur(kt,Yt){var be=kt.element;if(be.style){var Xe;ft(kt.options.cssProps,function(fn,Tn){Xe=V(be.style,Tn),Yt?(kt.oldCssProps[Xe]=be.style[Xe],be.style[Xe]=fn):be.style[Xe]=kt.oldCssProps[Xe]||""}),Yt||(kt.oldCssProps={})}}function wi(kt,Yt){var be=_t.createEvent("Event");be.initEvent(kt,!0,!0),be.gesture=Yt,Yt.target.dispatchEvent(be)}lt(Dn,{INPUT_START:nt,INPUT_MOVE:Ft,INPUT_END:he,INPUT_CANCEL:yt,STATE_POSSIBLE:de,STATE_BEGAN:Ce,STATE_CHANGED:Me,STATE_ENDED:ge,STATE_RECOGNIZED:ve,STATE_CANCELLED:Ue,STATE_FAILED:He,DIRECTION_NONE:St,DIRECTION_LEFT:F,DIRECTION_RIGHT:T,DIRECTION_UP:gt,DIRECTION_DOWN:ne,DIRECTION_HORIZONTAL:C,DIRECTION_VERTICAL:j,DIRECTION_ALL:Pt,Manager:fi,Input:Ae,TouchAction:rt,TouchInput:yr,MouseInput:ce,PointerEventInput:Re,TouchMouseInput:Fr,SingleTouchInput:An,Recognizer:hn,AttrRecognizer:Sn,Tap:En,Pan:On,Swipe:Un,Pinch:un,Rotate:Pn,Press:zn,on:Vt,off:$,each:ft,merge:ue,extend:jt,assign:lt,inherit:we,bindFn:Ne,prefixed:V});var Di=typeof it!="undefined"?it:typeof self!="undefined"?self:{};Di.Hammer=Dn,pt=function(){return Dn}.call(Se,k,Se,ke),pt!==q&&(ke.exports=pt)})(window,document,"Hammer")},47443:function(ke,Se,k){var pt=k(42118);function it(_t,qt){var q=_t==null?0:_t.length;return!!q&&pt(_t,qt,0)>-1}ke.exports=it},1196:function(ke){function Se(k,pt,it){for(var _t=-1,qt=k==null?0:k.length;++_t<qt;)if(it(pt,k[_t]))return!0;return!1}ke.exports=Se},29750:function(ke){function Se(k,pt,it){return k===k&&(it!==void 0&&(k=k<=it?k:it),pt!==void 0&&(k=k>=pt?k:pt)),k}ke.exports=Se},41848:function(ke){function Se(k,pt,it,_t){for(var qt=k.length,q=it+(_t?1:-1);_t?q--:++q<qt;)if(pt(k[q],q,k))return q;return-1}ke.exports=Se},42118:function(ke,Se,k){var pt=k(41848),it=k(62722),_t=k(39375);function qt(q,Zt,Bt){return Zt===Zt?_t(q,Zt,Bt):pt(q,it,Bt)}ke.exports=qt},74221:function(ke){function Se(k,pt,it,_t){for(var qt=it-1,q=k.length;++qt<q;)if(_t(k[qt],pt))return qt;return-1}ke.exports=Se},62722:function(ke){function Se(k){return k!==k}ke.exports=Se},65464:function(ke,Se,k){var pt=k(29932),it=k(42118),_t=k(74221),qt=k(51717),q=k(6450),Zt=Array.prototype,Bt=Zt.splice;function Wt(ct,ee,K,J){var Ct=J?_t:it,ft=-1,mt=ee.length,lt=ct;for(ct===ee&&(ee=q(ee)),K&&(lt=pt(ct,qt(K)));++ft<mt;)for(var jt=0,ue=ee[ft],we=K?K(ue):ue;(jt=Ct(lt,we,jt,J))>-1;)lt!==ct&&Bt.call(lt,jt,1),Bt.call(ct,jt,1);return ct}ke.exports=Wt},45652:function(ke,Se,k){var pt=k(88668),it=k(47443),_t=k(1196),qt=k(74757),q=k(23593),Zt=k(21814),Bt=200;function Wt(ct,ee,K){var J=-1,Ct=it,ft=ct.length,mt=!0,lt=[],jt=lt;if(K)mt=!1,Ct=_t;else if(ft>=Bt){var ue=ee?null:q(ct);if(ue)return Zt(ue);mt=!1,Ct=qt,jt=new pt}else jt=ee?[]:lt;t:for(;++J<ft;){var we=ct[J],Ne=ee?ee(we):we;if(we=K||we!==0?we:0,mt&&Ne===Ne){for(var Ge=jt.length;Ge--;)if(jt[Ge]===Ne)continue t;ee&&jt.push(Ne),lt.push(we)}else Ct(jt,Ne,K)||(jt!==lt&&jt.push(Ne),lt.push(we))}return lt}ke.exports=Wt},23593:function(ke,Se,k){var pt=k(58525),it=k(28117),_t=k(21814),qt=1/0,q=pt&&1/_t(new pt([,-0]))[1]==qt?function(Zt){return new pt(Zt)}:it;ke.exports=q},39375:function(ke){function Se(k,pt,it){for(var _t=it-1,qt=k.length;++_t<qt;)if(k[_t]===pt)return _t;return-1}ke.exports=Se},74691:function(ke,Se,k){var pt=k(29750),it=k(14841);function _t(qt,q,Zt){return Zt===void 0&&(Zt=q,q=void 0),Zt!==void 0&&(Zt=it(Zt),Zt=Zt===Zt?Zt:0),q!==void 0&&(q=it(q),q=q===q?q:0),pt(it(qt),q,Zt)}ke.exports=_t},51584:function(ke,Se,k){var pt=k(44239),it=k(37005),_t="[object Boolean]";function qt(q){return q===!0||q===!1||it(q)&&pt(q)==_t}ke.exports=qt},18446:function(ke,Se,k){var pt=k(90939);function it(_t,qt){return pt(_t,qt)}ke.exports=it},14293:function(ke){function Se(k){return k==null}ke.exports=Se},81763:function(ke,Se,k){var pt=k(44239),it=k(37005),_t="[object Number]";function qt(q){return typeof q=="number"||it(q)&&pt(q)==_t}ke.exports=qt},52353:function(ke){function Se(k){return k===void 0}ke.exports=Se},30236:function(ke,Se,k){var pt=k(42980),it=k(21463),_t=it(function(qt,q,Zt,Bt){pt(qt,q,Zt,Bt)});ke.exports=_t},28117:function(ke){function Se(){}ke.exports=Se},97019:function(ke,Se,k){var pt=k(5976),it=k(45604),_t=pt(it);ke.exports=_t},45604:function(ke,Se,k){var pt=k(65464);function it(_t,qt){return _t&&_t.length&&qt&&qt.length?pt(_t,qt):_t}ke.exports=it},44908:function(ke,Se,k){var pt=k(45652);function it(_t){return _t&&_t.length?pt(_t):[]}ke.exports=it},73955:function(ke,Se,k){var pt=k(79833),it=0;function _t(qt){var q=++it;return pt(qt)+q}ke.exports=_t},92077:function(ke,Se,k){var pt,it;(function(_t,qt){pt=qt,it=typeof pt=="function"?pt.call(Se,k,Se,ke):pt,it!==void 0&&(ke.exports=it)})(this,function(){var _t,qt,q="2.0.6",Zt={},Bt={},Wt={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},ct={currentLocale:Wt.currentLocale,zeroFormat:Wt.zeroFormat,nullFormat:Wt.nullFormat,defaultFormat:Wt.defaultFormat,scalePercentBy100:Wt.scalePercentBy100};function ee(K,J){this._input=K,this._value=J}return _t=function(K){var J,Ct,ft,mt;if(_t.isNumeral(K))J=K.value();else if(K===0||typeof K=="undefined")J=0;else if(K===null||qt.isNaN(K))J=null;else if(typeof K=="string")if(ct.zeroFormat&&K===ct.zeroFormat)J=0;else if(ct.nullFormat&&K===ct.nullFormat||!K.replace(/[^0-9]+/g,"").length)J=null;else{for(Ct in Zt)if(mt=typeof Zt[Ct].regexps.unformat=="function"?Zt[Ct].regexps.unformat():Zt[Ct].regexps.unformat,mt&&K.match(mt)){ft=Zt[Ct].unformat;break}ft=ft||_t._.stringToNumber,J=ft(K)}else J=Number(K)||null;return new ee(K,J)},_t.version=q,_t.isNumeral=function(K){return K instanceof ee},_t._=qt={numberToFormat:function(K,J,Ct){var ft=Bt[_t.options.currentLocale],mt=!1,lt=!1,jt=0,ue="",we=1e12,Ne=1e9,Ge=1e6,ye=1e3,Vt="",$=!1,ae,Gt,_e,xe,X,Rt,V,Mt,H,N;if(K=K||0,Gt=Math.abs(K),_t._.includes(J,"(")?(mt=!0,J=J.replace(/[\(|\)]/g,"")):(_t._.includes(J,"+")||_t._.includes(J,"-"))&&(Mt=_t._.includes(J,"+")?J.indexOf("+"):K<0?J.indexOf("-"):-1,J=J.replace(/[\+|\-]/g,"")),_t._.includes(J,"a")&&(ae=J.match(/a(k|m|b|t)?/),ae=ae?ae[1]:!1,_t._.includes(J," a")&&(ue=" "),J=J.replace(new RegExp(ue+"a[kmbt]?"),""),Gt>=we&&!ae||ae==="t"?(ue+=ft.abbreviations.trillion,K=K/we):Gt<we&&Gt>=Ne&&!ae||ae==="b"?(ue+=ft.abbreviations.billion,K=K/Ne):Gt<Ne&&Gt>=Ge&&!ae||ae==="m"?(ue+=ft.abbreviations.million,K=K/Ge):(Gt<Ge&&Gt>=ye&&!ae||ae==="k")&&(ue+=ft.abbreviations.thousand,K=K/ye)),_t._.includes(J,"[.]")&&(lt=!0,J=J.replace("[.]",".")),Rt=K.toString().split(".")[0],V=J.split(".")[1],H=J.indexOf(","),jt=(J.split(".")[0].split(",")[0].match(/0/g)||[]).length,V?(_t._.includes(V,"[")?(V=V.replace("]",""),V=V.split("["),Vt=_t._.toFixed(K,V[0].length+V[1].length,Ct,V[1].length)):Vt=_t._.toFixed(K,V.length,Ct),Rt=Vt.split(".")[0],_t._.includes(Vt,".")?Vt=ft.delimiters.decimal+Vt.split(".")[1]:Vt="",lt&&Number(Vt.slice(1))===0&&(Vt="")):Rt=_t._.toFixed(K,0,Ct),ue&&!ae&&Number(Rt)>=1e3&&ue!==ft.abbreviations.trillion)switch(Rt=String(Number(Rt)/1e3),ue){case ft.abbreviations.thousand:ue=ft.abbreviations.million;break;case ft.abbreviations.million:ue=ft.abbreviations.billion;break;case ft.abbreviations.billion:ue=ft.abbreviations.trillion;break}if(_t._.includes(Rt,"-")&&(Rt=Rt.slice(1),$=!0),Rt.length<jt)for(var et=jt-Rt.length;et>0;et--)Rt="0"+Rt;return H>-1&&(Rt=Rt.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+ft.delimiters.thousands)),J.indexOf(".")===0&&(Rt=""),N=Rt+Vt+(ue||""),mt?N=(mt&&$?"(":"")+N+(mt&&$?")":""):Mt>=0?N=Mt===0?($?"-":"+")+N:N+($?"-":"+"):$&&(N="-"+N),N},stringToNumber:function(K){var J=Bt[ct.currentLocale],Ct=K,ft={thousand:3,million:6,billion:9,trillion:12},mt,lt,jt,ue;if(ct.zeroFormat&&K===ct.zeroFormat)lt=0;else if(ct.nullFormat&&K===ct.nullFormat||!K.replace(/[^0-9]+/g,"").length)lt=null;else{lt=1,J.delimiters.decimal!=="."&&(K=K.replace(/\./g,"").replace(J.delimiters.decimal,"."));for(mt in ft)if(ue=new RegExp("[^a-zA-Z]"+J.abbreviations[mt]+"(?:\\)|(\\"+J.currency.symbol+")?(?:\\))?)?$"),Ct.match(ue)){lt*=Math.pow(10,ft[mt]);break}lt*=(K.split("-").length+Math.min(K.split("(").length-1,K.split(")").length-1))%2?1:-1,K=K.replace(/[^0-9\.]+/g,""),lt*=Number(K)}return lt},isNaN:function(K){return typeof K=="number"&&isNaN(K)},includes:function(K,J){return K.indexOf(J)!==-1},insert:function(K,J,Ct){return K.slice(0,Ct)+J+K.slice(Ct)},reduce:function(K,J){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof J!="function")throw new TypeError(J+" is not a function");var Ct=Object(K),ft=Ct.length>>>0,mt=0,lt;if(arguments.length===3)lt=arguments[2];else{for(;mt<ft&&!(mt in Ct);)mt++;if(mt>=ft)throw new TypeError("Reduce of empty array with no initial value");lt=Ct[mt++]}for(;mt<ft;mt++)mt in Ct&&(lt=J(lt,Ct[mt],mt,Ct));return lt},multiplier:function(K){var J=K.toString().split(".");return J.length<2?1:Math.pow(10,J[1].length)},correctionFactor:function(){var K=Array.prototype.slice.call(arguments);return K.reduce(function(J,Ct){var ft=qt.multiplier(Ct);return J>ft?J:ft},1)},toFixed:function(K,J,Ct,ft){var mt=K.toString().split("."),lt=J-(ft||0),jt,ue,we,Ne;return mt.length===2?jt=Math.min(Math.max(mt[1].length,lt),J):jt=lt,we=Math.pow(10,jt),Ne=(Ct(K+"e+"+jt)/we).toFixed(jt),ft>J-jt&&(ue=new RegExp("\\.?0{1,"+(ft-(J-jt))+"}$"),Ne=Ne.replace(ue,"")),Ne}},_t.options=ct,_t.formats=Zt,_t.locales=Bt,_t.locale=function(K){return K&&(ct.currentLocale=K.toLowerCase()),ct.currentLocale},_t.localeData=function(K){if(!K)return Bt[ct.currentLocale];if(K=K.toLowerCase(),!Bt[K])throw new Error("Unknown locale : "+K);return Bt[K]},_t.reset=function(){for(var K in Wt)ct[K]=Wt[K]},_t.zeroFormat=function(K){ct.zeroFormat=typeof K=="string"?K:null},_t.nullFormat=function(K){ct.nullFormat=typeof K=="string"?K:null},_t.defaultFormat=function(K){ct.defaultFormat=typeof K=="string"?K:"0.0"},_t.register=function(K,J,Ct){if(J=J.toLowerCase(),this[K+"s"][J])throw new TypeError(J+" "+K+" already registered.");return this[K+"s"][J]=Ct,Ct},_t.validate=function(K,J){var Ct,ft,mt,lt,jt,ue,we,Ne;if(typeof K!="string"&&(K+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",K)),K=K.trim(),K.match(/^\d+$/))return!0;if(K==="")return!1;try{we=_t.localeData(J)}catch(Ge){we=_t.localeData(_t.locale())}return mt=we.currency.symbol,jt=we.abbreviations,Ct=we.delimiters.decimal,we.delimiters.thousands==="."?ft="\\.":ft=we.delimiters.thousands,Ne=K.match(/^[^\d]+/),Ne!==null&&(K=K.substr(1),Ne[0]!==mt)||(Ne=K.match(/[^\d]+$/),Ne!==null&&(K=K.slice(0,-1),Ne[0]!==jt.thousand&&Ne[0]!==jt.million&&Ne[0]!==jt.billion&&Ne[0]!==jt.trillion))?!1:(ue=new RegExp(ft+"{2}"),K.match(/[^\d.,]/g)?!1:(lt=K.split(Ct),lt.length>2?!1:lt.length<2?!!lt[0].match(/^\d+.*\d$/)&&!lt[0].match(ue):lt[0].length===1?!!lt[0].match(/^\d+$/)&&!lt[0].match(ue)&&!!lt[1].match(/^\d+$/):!!lt[0].match(/^\d+.*\d$/)&&!lt[0].match(ue)&&!!lt[1].match(/^\d+$/)))},_t.fn=ee.prototype={clone:function(){return _t(this)},format:function(K,J){var Ct=this._value,ft=K||ct.defaultFormat,mt,lt,jt;if(J=J||Math.round,Ct===0&&ct.zeroFormat!==null)lt=ct.zeroFormat;else if(Ct===null&&ct.nullFormat!==null)lt=ct.nullFormat;else{for(mt in Zt)if(ft.match(Zt[mt].regexps.format)){jt=Zt[mt].format;break}jt=jt||_t._.numberToFormat,lt=jt(Ct,ft,J)}return lt},value:function(){return this._value},input:function(){return this._input},set:function(K){return this._value=Number(K),this},add:function(K){var J=qt.correctionFactor.call(null,this._value,K);function Ct(ft,mt,lt,jt){return ft+Math.round(J*mt)}return this._value=qt.reduce([this._value,K],Ct,0)/J,this},subtract:function(K){var J=qt.correctionFactor.call(null,this._value,K);function Ct(ft,mt,lt,jt){return ft-Math.round(J*mt)}return this._value=qt.reduce([K],Ct,Math.round(this._value*J))/J,this},multiply:function(K){function J(Ct,ft,mt,lt){var jt=qt.correctionFactor(Ct,ft);return Math.round(Ct*jt)*Math.round(ft*jt)/Math.round(jt*jt)}return this._value=qt.reduce([this._value,K],J,1),this},divide:function(K){function J(Ct,ft,mt,lt){var jt=qt.correctionFactor(Ct,ft);return Math.round(Ct*jt)/Math.round(ft*jt)}return this._value=qt.reduce([this._value,K],J),this},difference:function(K){return Math.abs(_t(this._value).subtract(K).value())}},_t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(K){var J=K%10;return~~(K%100/10)===1?"th":J===1?"st":J===2?"nd":J===3?"rd":"th"},currency:{symbol:"$"}}),function(){_t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(K,J,Ct){var ft=_t._.includes(J," BPS")?" ":"",mt;return K=K*1e4,J=J.replace(/\s?BPS/,""),mt=_t._.numberToFormat(K,J,Ct),_t._.includes(mt,")")?(mt=mt.split(""),mt.splice(-1,0,ft+"BPS"),mt=mt.join("")):mt=mt+ft+"BPS",mt},unformat:function(K){return+(_t._.stringToNumber(K)*1e-4).toFixed(15)}})}(),function(){var K={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},J={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},Ct=K.suffixes.concat(J.suffixes.filter(function(mt){return K.suffixes.indexOf(mt)<0})),ft=Ct.join("|");ft="("+ft.replace("B","B(?!PS)")+")",_t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(ft)},format:function(mt,lt,jt){var ue,we=_t._.includes(lt,"ib")?J:K,Ne=_t._.includes(lt," b")||_t._.includes(lt," ib")?" ":"",Ge,ye,Vt;for(lt=lt.replace(/\s?i?b/,""),Ge=0;Ge<=we.suffixes.length;Ge++)if(ye=Math.pow(we.base,Ge),Vt=Math.pow(we.base,Ge+1),mt===null||mt===0||mt>=ye&&mt<Vt){Ne+=we.suffixes[Ge],ye>0&&(mt=mt/ye);break}return ue=_t._.numberToFormat(mt,lt,jt),ue+Ne},unformat:function(mt){var lt=_t._.stringToNumber(mt),jt,ue;if(lt){for(jt=K.suffixes.length-1;jt>=0;jt--){if(_t._.includes(mt,K.suffixes[jt])){ue=Math.pow(K.base,jt);break}if(_t._.includes(mt,J.suffixes[jt])){ue=Math.pow(J.base,jt);break}}lt*=ue||1}return lt}})}(),function(){_t.register("format","currency",{regexps:{format:/(\$)/},format:function(K,J,Ct){var ft=_t.locales[_t.options.currentLocale],mt={before:J.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:J.match(/([\+|\-|\)|\s|\$]*)$/)[0]},lt,jt,ue;for(J=J.replace(/\s?\$\s?/,""),lt=_t._.numberToFormat(K,J,Ct),K>=0?(mt.before=mt.before.replace(/[\-\(]/,""),mt.after=mt.after.replace(/[\-\)]/,"")):K<0&&!_t._.includes(mt.before,"-")&&!_t._.includes(mt.before,"(")&&(mt.before="-"+mt.before),ue=0;ue<mt.before.length;ue++)switch(jt=mt.before[ue],jt){case"$":lt=_t._.insert(lt,ft.currency.symbol,ue);break;case" ":lt=_t._.insert(lt," ",ue+ft.currency.symbol.length-1);break}for(ue=mt.after.length-1;ue>=0;ue--)switch(jt=mt.after[ue],jt){case"$":lt=ue===mt.after.length-1?lt+ft.currency.symbol:_t._.insert(lt,ft.currency.symbol,-(mt.after.length-(1+ue)));break;case" ":lt=ue===mt.after.length-1?lt+" ":_t._.insert(lt," ",-(mt.after.length-(1+ue)+ft.currency.symbol.length-1));break}return lt}})}(),function(){_t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(K,J,Ct){var ft,mt=typeof K=="number"&&!_t._.isNaN(K)?K.toExponential():"0e+0",lt=mt.split("e");return J=J.replace(/e[\+|\-]{1}0/,""),ft=_t._.numberToFormat(Number(lt[0]),J,Ct),ft+"e"+lt[1]},unformat:function(K){var J=_t._.includes(K,"e+")?K.split("e+"):K.split("e-"),Ct=Number(J[0]),ft=Number(J[1]);ft=_t._.includes(K,"e-")?ft*=-1:ft;function mt(lt,jt,ue,we){var Ne=_t._.correctionFactor(lt,jt),Ge=lt*Ne*(jt*Ne)/(Ne*Ne);return Ge}return _t._.reduce([Ct,Math.pow(10,ft)],mt,1)}})}(),function(){_t.register("format","ordinal",{regexps:{format:/(o)/},format:function(K,J,Ct){var ft=_t.locales[_t.options.currentLocale],mt,lt=_t._.includes(J," o")?" ":"";return J=J.replace(/\s?o/,""),lt+=ft.ordinal(K),mt=_t._.numberToFormat(K,J,Ct),mt+lt}})}(),function(){_t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(K,J,Ct){var ft=_t._.includes(J," %")?" ":"",mt;return _t.options.scalePercentBy100&&(K=K*100),J=J.replace(/\s?\%/,""),mt=_t._.numberToFormat(K,J,Ct),_t._.includes(mt,")")?(mt=mt.split(""),mt.splice(-1,0,ft+"%"),mt=mt.join("")):mt=mt+ft+"%",mt},unformat:function(K){var J=_t._.stringToNumber(K);return _t.options.scalePercentBy100?J*.01:J}})}(),function(){_t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(K,J,Ct){var ft=Math.floor(K/60/60),mt=Math.floor((K-ft*60*60)/60),lt=Math.round(K-ft*60*60-mt*60);return ft+":"+(mt<10?"0"+mt:mt)+":"+(lt<10?"0"+lt:lt)},unformat:function(K){var J=K.split(":"),Ct=0;return J.length===3?(Ct=Ct+Number(J[0])*60*60,Ct=Ct+Number(J[1])*60,Ct=Ct+Number(J[2])):J.length===2&&(Ct=Ct+Number(J[0])*60,Ct=Ct+Number(J[1])),Number(Ct)}})}(),_t})},3614:function(ke,Se,k){"use strict";ke.exports=it;var pt=k(80645);function it(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}it.Varint=0,it.Fixed64=1,it.Bytes=2,it.Fixed32=5;var _t=65536*65536,qt=1/_t,q=12,Zt=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");it.prototype={destroy:function(){this.buf=null},readFields:function(X,Rt,V){for(V=V||this.length;this.pos<V;){var Mt=this.readVarint(),H=Mt>>3,N=this.pos;this.type=Mt&7,X(H,Rt,this),this.pos===N&&this.skip(Mt)}return Rt},readMessage:function(X,Rt){return this.readFields(X,Rt,this.readVarint()+this.pos)},readFixed32:function(){var X=Vt(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=ae(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=Vt(this.buf,this.pos)+Vt(this.buf,this.pos+4)*_t;return this.pos+=8,X},readSFixed64:function(){var X=Vt(this.buf,this.pos)+ae(this.buf,this.pos+4)*_t;return this.pos+=8,X},readFloat:function(){var X=pt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=pt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var Rt=this.buf,V,Mt;return Mt=Rt[this.pos++],V=Mt&127,Mt<128||(Mt=Rt[this.pos++],V|=(Mt&127)<<7,Mt<128)||(Mt=Rt[this.pos++],V|=(Mt&127)<<14,Mt<128)||(Mt=Rt[this.pos++],V|=(Mt&127)<<21,Mt<128)?V:(Mt=Rt[this.pos],V|=(Mt&15)<<28,Bt(V,X,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2===1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,Rt=this.pos;return this.pos=X,X-Rt>=q&&Zt?_e(this.buf,Rt,X):Gt(this.buf,Rt,X)},readBytes:function(){var X=this.readVarint()+this.pos,Rt=this.buf.subarray(this.pos,X);return this.pos=X,Rt},readPackedVarint:function(X,Rt){if(this.type!==it.Bytes)return X.push(this.readVarint(Rt));var V=Wt(this);for(X=X||[];this.pos<V;)X.push(this.readVarint(Rt));return X},readPackedSVarint:function(X){if(this.type!==it.Bytes)return X.push(this.readSVarint());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==it.Bytes)return X.push(this.readBoolean());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==it.Bytes)return X.push(this.readFloat());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==it.Bytes)return X.push(this.readDouble());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==it.Bytes)return X.push(this.readFixed32());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==it.Bytes)return X.push(this.readSFixed32());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==it.Bytes)return X.push(this.readFixed64());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==it.Bytes)return X.push(this.readSFixed64());var Rt=Wt(this);for(X=X||[];this.pos<Rt;)X.push(this.readSFixed64());return X},skip:function(X){var Rt=X&7;if(Rt===it.Varint)for(;this.buf[this.pos++]>127;);else if(Rt===it.Bytes)this.pos=this.readVarint()+this.pos;else if(Rt===it.Fixed32)this.pos+=4;else if(Rt===it.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Rt)},writeTag:function(X,Rt){this.writeVarint(X<<3|Rt)},realloc:function(X){for(var Rt=this.length||16;Rt<this.pos+X;)Rt*=2;if(Rt!==this.length){var V=new Uint8Array(Rt);V.set(this.buf),this.buf=V,this.length=Rt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),$(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),$(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),$(this.buf,X&-1,this.pos),$(this.buf,Math.floor(X*qt),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),$(this.buf,X&-1,this.pos),$(this.buf,Math.floor(X*qt),this.pos+4),this.pos+=8},writeVarint:function(X){if(X=+X||0,X>268435455||X<0){ee(X,this);return}this.realloc(4),this.buf[this.pos++]=X&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=(X>>>=7)&127|(X>127?128:0),!(X<=127)&&(this.buf[this.pos++]=X>>>7&127)))},writeSVarint:function(X){this.writeVarint(X<0?-X*2-1:X*2)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(X.length*4),this.pos++;var Rt=this.pos;this.pos=xe(this.buf,X,this.pos);var V=this.pos-Rt;V>=128&&Ct(Rt,V,this),this.pos=Rt-1,this.writeVarint(V),this.pos+=V},writeFloat:function(X){this.realloc(4),pt.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),pt.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var Rt=X.length;this.writeVarint(Rt),this.realloc(Rt);for(var V=0;V<Rt;V++)this.buf[this.pos++]=X[V]},writeRawMessage:function(X,Rt){this.pos++;var V=this.pos;X(Rt,this);var Mt=this.pos-V;Mt>=128&&Ct(V,Mt,this),this.pos=V-1,this.writeVarint(Mt),this.pos+=Mt},writeMessage:function(X,Rt,V){this.writeTag(X,it.Bytes),this.writeRawMessage(Rt,V)},writePackedVarint:function(X,Rt){Rt.length&&this.writeMessage(X,ft,Rt)},writePackedSVarint:function(X,Rt){Rt.length&&this.writeMessage(X,mt,Rt)},writePackedBoolean:function(X,Rt){Rt.length&&this.writeMessage(X,ue,Rt)},writePackedFloat:function(X,Rt){Rt.length&&this.writeMessage(X,lt,Rt)},writePackedDouble:function(X,Rt){Rt.length&&this.writeMessage(X,jt,Rt)},writePackedFixed32:function(X,Rt){Rt.length&&this.writeMessage(X,we,Rt)},writePackedSFixed32:function(X,Rt){Rt.length&&this.writeMessage(X,Ne,Rt)},writePackedFixed64:function(X,Rt){Rt.length&&this.writeMessage(X,Ge,Rt)},writePackedSFixed64:function(X,Rt){Rt.length&&this.writeMessage(X,ye,Rt)},writeBytesField:function(X,Rt){this.writeTag(X,it.Bytes),this.writeBytes(Rt)},writeFixed32Field:function(X,Rt){this.writeTag(X,it.Fixed32),this.writeFixed32(Rt)},writeSFixed32Field:function(X,Rt){this.writeTag(X,it.Fixed32),this.writeSFixed32(Rt)},writeFixed64Field:function(X,Rt){this.writeTag(X,it.Fixed64),this.writeFixed64(Rt)},writeSFixed64Field:function(X,Rt){this.writeTag(X,it.Fixed64),this.writeSFixed64(Rt)},writeVarintField:function(X,Rt){this.writeTag(X,it.Varint),this.writeVarint(Rt)},writeSVarintField:function(X,Rt){this.writeTag(X,it.Varint),this.writeSVarint(Rt)},writeStringField:function(X,Rt){this.writeTag(X,it.Bytes),this.writeString(Rt)},writeFloatField:function(X,Rt){this.writeTag(X,it.Fixed32),this.writeFloat(Rt)},writeDoubleField:function(X,Rt){this.writeTag(X,it.Fixed64),this.writeDouble(Rt)},writeBooleanField:function(X,Rt){this.writeVarintField(X,!!Rt)}};function Bt(X,Rt,V){var Mt=V.buf,H,N;if(N=Mt[V.pos++],H=(N&112)>>4,N<128||(N=Mt[V.pos++],H|=(N&127)<<3,N<128)||(N=Mt[V.pos++],H|=(N&127)<<10,N<128)||(N=Mt[V.pos++],H|=(N&127)<<17,N<128)||(N=Mt[V.pos++],H|=(N&127)<<24,N<128)||(N=Mt[V.pos++],H|=(N&1)<<31,N<128))return ct(X,H,Rt);throw new Error("Expected varint not more than 10 bytes")}function Wt(X){return X.type===it.Bytes?X.readVarint()+X.pos:X.pos+1}function ct(X,Rt,V){return V?Rt*4294967296+(X>>>0):(Rt>>>0)*4294967296+(X>>>0)}function ee(X,Rt){var V,Mt;if(X>=0?(V=X%4294967296|0,Mt=X/4294967296|0):(V=~(-X%4294967296),Mt=~(-X/4294967296),V^4294967295?V=V+1|0:(V=0,Mt=Mt+1|0)),X>=18446744073709552e3||X<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Rt.realloc(10),K(V,Mt,Rt),J(Mt,Rt)}function K(X,Rt,V){V.buf[V.pos++]=X&127|128,X>>>=7,V.buf[V.pos++]=X&127|128,X>>>=7,V.buf[V.pos++]=X&127|128,X>>>=7,V.buf[V.pos++]=X&127|128,X>>>=7,V.buf[V.pos]=X&127}function J(X,Rt){var V=(X&7)<<4;Rt.buf[Rt.pos++]|=V|((X>>>=3)?128:0),X&&(Rt.buf[Rt.pos++]=X&127|((X>>>=7)?128:0),X&&(Rt.buf[Rt.pos++]=X&127|((X>>>=7)?128:0),X&&(Rt.buf[Rt.pos++]=X&127|((X>>>=7)?128:0),X&&(Rt.buf[Rt.pos++]=X&127|((X>>>=7)?128:0),X&&(Rt.buf[Rt.pos++]=X&127)))))}function Ct(X,Rt,V){var Mt=Rt<=16383?1:Rt<=2097151?2:Rt<=268435455?3:Math.floor(Math.log(Rt)/(Math.LN2*7));V.realloc(Mt);for(var H=V.pos-1;H>=X;H--)V.buf[H+Mt]=V.buf[H]}function ft(X,Rt){for(var V=0;V<X.length;V++)Rt.writeVarint(X[V])}function mt(X,Rt){for(var V=0;V<X.length;V++)Rt.writeSVarint(X[V])}function lt(X,Rt){for(var V=0;V<X.length;V++)Rt.writeFloat(X[V])}function jt(X,Rt){for(var V=0;V<X.length;V++)Rt.writeDouble(X[V])}function ue(X,Rt){for(var V=0;V<X.length;V++)Rt.writeBoolean(X[V])}function we(X,Rt){for(var V=0;V<X.length;V++)Rt.writeFixed32(X[V])}function Ne(X,Rt){for(var V=0;V<X.length;V++)Rt.writeSFixed32(X[V])}function Ge(X,Rt){for(var V=0;V<X.length;V++)Rt.writeFixed64(X[V])}function ye(X,Rt){for(var V=0;V<X.length;V++)Rt.writeSFixed64(X[V])}function Vt(X,Rt){return(X[Rt]|X[Rt+1]<<8|X[Rt+2]<<16)+X[Rt+3]*16777216}function $(X,Rt,V){X[V]=Rt,X[V+1]=Rt>>>8,X[V+2]=Rt>>>16,X[V+3]=Rt>>>24}function ae(X,Rt){return(X[Rt]|X[Rt+1]<<8|X[Rt+2]<<16)+(X[Rt+3]<<24)}function Gt(X,Rt,V){for(var Mt="",H=Rt;H<V;){var N=X[H],et=null,ot=N>239?4:N>223?3:N>191?2:1;if(H+ot>V)break;var At,Dt,ie;ot===1?N<128&&(et=N):ot===2?(At=X[H+1],(At&192)===128&&(et=(N&31)<<6|At&63,et<=127&&(et=null))):ot===3?(At=X[H+1],Dt=X[H+2],(At&192)===128&&(Dt&192)===128&&(et=(N&15)<<12|(At&63)<<6|Dt&63,(et<=2047||et>=55296&&et<=57343)&&(et=null))):ot===4&&(At=X[H+1],Dt=X[H+2],ie=X[H+3],(At&192)===128&&(Dt&192)===128&&(ie&192)===128&&(et=(N&15)<<18|(At&63)<<12|(Dt&63)<<6|ie&63,(et<=65535||et>=1114112)&&(et=null))),et===null?(et=65533,ot=1):et>65535&&(et-=65536,Mt+=String.fromCharCode(et>>>10&1023|55296),et=56320|et&1023),Mt+=String.fromCharCode(et),H+=ot}return Mt}function _e(X,Rt,V){return Zt.decode(X.subarray(Rt,V))}function xe(X,Rt,V){for(var Mt=0,H,N;Mt<Rt.length;Mt++){if(H=Rt.charCodeAt(Mt),H>55295&&H<57344)if(N)if(H<56320){X[V++]=239,X[V++]=191,X[V++]=189,N=H;continue}else H=N-55296<<10|H-56320|65536,N=null;else{H>56319||Mt+1===Rt.length?(X[V++]=239,X[V++]=191,X[V++]=189):N=H;continue}else N&&(X[V++]=239,X[V++]=191,X[V++]=189,N=null);H<128?X[V++]=H:(H<2048?X[V++]=H>>6|192:(H<65536?X[V++]=H>>12|224:(X[V++]=H>>18|240,X[V++]=H>>12&63|128),X[V++]=H>>6&63|128),X[V++]=H&63|128)}return V}},73807:function(ke){"use strict";var Se=ke.exports;ke.exports.isNumber=function(k){return typeof k=="number"},ke.exports.findMin=function(k){if(k.length===0)return 1/0;for(var pt=k[0],it=1;it<k.length;it++)pt=Math.min(pt,k[it]);return pt},ke.exports.findMax=function(k){if(k.length===0)return-1/0;for(var pt=k[0],it=1;it<k.length;it++)pt=Math.max(pt,k[it]);return pt},ke.exports.findMinMulti=function(k){for(var pt=Se.findMin(k[0]),it=1;it<k.length;it++)pt=Math.min(pt,Se.findMin(k[it]));return pt},ke.exports.findMaxMulti=function(k){for(var pt=Se.findMax(k[0]),it=1;it<k.length;it++)pt=Math.max(pt,Se.findMax(k[it]));return pt},ke.exports.inside=function(k,pt,it){return k<=it&&it<=pt}},53843:function(ke,Se,k){"use strict";var pt=50,it=2,_t=Math.log(2),qt=ke.exports,q=k(73807);function Zt(Wt){return 1-Math.abs(Wt)}ke.exports.getUnifiedMinMax=function(Wt,ct){return qt.getUnifiedMinMaxMulti([Wt],ct)},ke.exports.getUnifiedMinMaxMulti=function(Wt,ct){ct=ct||{};var ee=!1,K=!1,J=q.isNumber(ct.width)?ct.width:it,Ct=q.isNumber(ct.size)?ct.size:pt,ft=q.isNumber(ct.min)?ct.min:(ee=!0,q.findMinMulti(Wt)),mt=q.isNumber(ct.max)?ct.max:(K=!0,q.findMaxMulti(Wt)),lt=mt-ft,jt=lt/(Ct-1);return ee&&(ft=ft-2*J*jt),K&&(mt=mt+2*J*jt),{min:ft,max:mt}},ke.exports.create=function(Wt,ct){if(ct=ct||{},!Wt||Wt.length===0)return[];var ee=q.isNumber(ct.size)?ct.size:pt,K=q.isNumber(ct.width)?ct.width:it,J=qt.getUnifiedMinMax(Wt,{size:ee,width:K,min:ct.min,max:ct.max}),Ct=J.min,ft=J.max,mt=ft-Ct,lt=mt/(ee-1);if(mt===0)return[{x:Ct,y:1}];for(var jt=[],ue=0;ue<ee;ue++)jt.push({x:Ct+ue*lt,y:0});var we=function(_e){return Math.floor((_e-Ct)/lt)},Ne=Bt(Zt,K),Ge=Ne[K],ye=Ne[K-1]-Ne[K-2],Vt=0;Wt.forEach(function(_e){var xe=we(_e);if(!(xe+K<0||xe-K>=jt.length)){var X=Math.max(xe-K,0),Rt=xe,V=Math.min(xe+K,jt.length-1),Mt=X-(xe-K),H=xe+K-V,N=Ne[-K-1+Mt]||0,et=Ne[-K-1+H]||0,ot=Ge/(Ge-N-et);Mt>0&&(Vt+=ot*(Mt-1)*ye);var At=Math.max(0,xe-K+1);q.inside(0,jt.length-1,At)&&(jt[At].y+=ot*1*ye),q.inside(0,jt.length-1,Rt+1)&&(jt[Rt+1].y-=ot*2*ye),q.inside(0,jt.length-1,V+1)&&(jt[V+1].y+=ot*1*ye)}});var $=Vt,ae=0,Gt=0;return jt.forEach(function(_e){ae+=_e.y,$+=ae,_e.y=$,Gt+=$}),Gt>0&&jt.forEach(function(_e){_e.y/=Gt}),jt};function Bt(Wt,ct){for(var ee={},K=0,J=-ct;J<=ct;J++)K+=Wt(J/ct),ee[J]=K;return ee}ke.exports.getExpectedValueFromPdf=function(Wt){if(!(!Wt||Wt.length===0)){var ct=0;return Wt.forEach(function(ee){ct+=ee.x*ee.y}),ct}},ke.exports.getXWithLeftTailArea=function(Wt,ct){if(!(!Wt||Wt.length===0)){for(var ee=0,K=0,J=0;J<Wt.length&&(K=J,ee+=Wt[J].y,!(ee>=ct));J++);return Wt[K].x}},ke.exports.getPerplexity=function(Wt){if(!(!Wt||Wt.length===0)){var ct=0;return Wt.forEach(function(ee){var K=Math.log(ee.y);isFinite(K)&&(ct+=ee.y*K)}),ct=-ct/_t,Math.pow(2,ct)}}},32676:function(ke,Se,k){var pt=k(34155);(function(it,_t){ke.exports=_t()})(this,function(){"use strict";function it(Q,D){var Z={label:0,sent:function(){if(It[0]&1)throw It[1];return It[1]},trys:[],ops:[]},tt,Et,It,ce;return ce={next:fe(0),throw:fe(1),return:fe(2)},typeof Symbol=="function"&&(ce[Symbol.iterator]=function(){return this}),ce;function fe(ze){return function(an){return Be([ze,an])}}function Be(ze){if(tt)throw new TypeError("Generator is already executing.");for(;Z;)try{if(tt=1,Et&&(It=ze[0]&2?Et.return:ze[0]?Et.throw||((It=Et.return)&&It.call(Et),0):Et.next)&&!(It=It.call(Et,ze[1])).done)return It;switch(Et=0,It&&(ze=[ze[0]&2,It.value]),ze[0]){case 0:case 1:It=ze;break;case 4:return Z.label++,{value:ze[1],done:!1};case 5:Z.label++,Et=ze[1],ze=[0];continue;case 7:ze=Z.ops.pop(),Z.trys.pop();continue;default:if(It=Z.trys,!(It=It.length>0&&It[It.length-1])&&(ze[0]===6||ze[0]===2)){Z=0;continue}if(ze[0]===3&&(!It||ze[1]>It[0]&&ze[1]<It[3])){Z.label=ze[1];break}if(ze[0]===6&&Z.label<It[1]){Z.label=It[1],It=ze;break}if(It&&Z.label<It[2]){Z.label=It[2],Z.ops.push(ze);break}It[2]&&Z.ops.pop(),Z.trys.pop();continue}ze=D.call(Q,Z)}catch(an){ze=[6,an],Et=0}finally{tt=It=0}if(ze[0]&5)throw ze[1];return{value:ze[0]?ze[1]:void 0,done:!0}}}var _t=function(){function Q(D,Z){this.next=null,this.key=D,this.data=Z,this.left=null,this.right=null}return Q}();function qt(Q,D){return Q>D?1:Q<D?-1:0}function q(Q,D,Z){for(var tt=new _t(null,null),Et=tt,It=tt;;){var ce=Z(Q,D.key);if(ce<0){if(D.left===null)break;if(Z(Q,D.left.key)<0){var fe=D.left;if(D.left=fe.right,fe.right=D,D=fe,D.left===null)break}It.left=D,It=D,D=D.left}else if(ce>0){if(D.right===null)break;if(Z(Q,D.right.key)>0){var fe=D.right;if(D.right=fe.left,fe.left=D,D=fe,D.right===null)break}Et.right=D,Et=D,D=D.right}else break}return Et.right=D.left,It.left=D.right,D.left=tt.right,D.right=tt.left,D}function Zt(Q,D,Z,tt){var Et=new _t(Q,D);if(Z===null)return Et.left=Et.right=null,Et;Z=q(Q,Z,tt);var It=tt(Q,Z.key);return It<0?(Et.left=Z.left,Et.right=Z,Z.left=null):It>=0&&(Et.right=Z.right,Et.left=Z,Z.right=null),Et}function Bt(Q,D,Z){var tt=null,Et=null;if(D){D=q(Q,D,Z);var It=Z(D.key,Q);It===0?(tt=D.left,Et=D.right):It<0?(Et=D.right,D.right=null,tt=D):(tt=D.left,D.left=null,Et=D)}return{left:tt,right:Et}}function Wt(Q,D,Z){return D===null?Q:(Q===null||(D=q(Q.key,D,Z),D.left=Q),D)}function ct(Q,D,Z,tt,Et){if(Q){tt(""+D+(Z?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+Et(Q)+`
`);var It=D+(Z?"    ":"\u2502   ");Q.left&&ct(Q.left,It,!1,tt,Et),Q.right&&ct(Q.right,It,!0,tt,Et)}}var ee=function(){function Q(D){D===void 0&&(D=qt),this._root=null,this._size=0,this._comparator=D}return Q.prototype.insert=function(D,Z){return this._size++,this._root=Zt(D,Z,this._root,this._comparator)},Q.prototype.add=function(D,Z){var tt=new _t(D,Z);this._root===null&&(tt.left=tt.right=null,this._size++,this._root=tt);var Et=this._comparator,It=q(D,this._root,Et),ce=Et(D,It.key);return ce===0?this._root=It:(ce<0?(tt.left=It.left,tt.right=It,It.left=null):ce>0&&(tt.right=It.right,tt.left=It,It.right=null),this._size++,this._root=tt),this._root},Q.prototype.remove=function(D){this._root=this._remove(D,this._root,this._comparator)},Q.prototype._remove=function(D,Z,tt){var Et;if(Z===null)return null;Z=q(D,Z,tt);var It=tt(D,Z.key);return It===0?(Z.left===null?Et=Z.right:(Et=q(D,Z.left,tt),Et.right=Z.right),this._size--,Et):Z},Q.prototype.pop=function(){var D=this._root;if(D){for(;D.left;)D=D.left;return this._root=q(D.key,this._root,this._comparator),this._root=this._remove(D.key,this._root,this._comparator),{key:D.key,data:D.data}}return null},Q.prototype.findStatic=function(D){for(var Z=this._root,tt=this._comparator;Z;){var Et=tt(D,Z.key);if(Et===0)return Z;Et<0?Z=Z.left:Z=Z.right}return null},Q.prototype.find=function(D){return this._root&&(this._root=q(D,this._root,this._comparator),this._comparator(D,this._root.key)!==0)?null:this._root},Q.prototype.contains=function(D){for(var Z=this._root,tt=this._comparator;Z;){var Et=tt(D,Z.key);if(Et===0)return!0;Et<0?Z=Z.left:Z=Z.right}return!1},Q.prototype.forEach=function(D,Z){for(var tt=this._root,Et=[],It=!1;!It;)tt!==null?(Et.push(tt),tt=tt.left):Et.length!==0?(tt=Et.pop(),D.call(Z,tt),tt=tt.right):It=!0;return this},Q.prototype.range=function(D,Z,tt,Et){for(var It=[],ce=this._comparator,fe=this._root,Be;It.length!==0||fe;)if(fe)It.push(fe),fe=fe.left;else{if(fe=It.pop(),Be=ce(fe.key,Z),Be>0)break;if(ce(fe.key,D)>=0&&tt.call(Et,fe))return this;fe=fe.right}return this},Q.prototype.keys=function(){var D=[];return this.forEach(function(Z){var tt=Z.key;return D.push(tt)}),D},Q.prototype.values=function(){var D=[];return this.forEach(function(Z){var tt=Z.data;return D.push(tt)}),D},Q.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Q.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Q.prototype.minNode=function(D){if(D===void 0&&(D=this._root),D)for(;D.left;)D=D.left;return D},Q.prototype.maxNode=function(D){if(D===void 0&&(D=this._root),D)for(;D.right;)D=D.right;return D},Q.prototype.at=function(D){for(var Z=this._root,tt=!1,Et=0,It=[];!tt;)if(Z)It.push(Z),Z=Z.left;else if(It.length>0){if(Z=It.pop(),Et===D)return Z;Et++,Z=Z.right}else tt=!0;return null},Q.prototype.next=function(D){var Z=this._root,tt=null;if(D.right){for(tt=D.right;tt.left;)tt=tt.left;return tt}for(var Et=this._comparator;Z;){var It=Et(D.key,Z.key);if(It===0)break;It<0?(tt=Z,Z=Z.left):Z=Z.right}return tt},Q.prototype.prev=function(D){var Z=this._root,tt=null;if(D.left!==null){for(tt=D.left;tt.right;)tt=tt.right;return tt}for(var Et=this._comparator;Z;){var It=Et(D.key,Z.key);if(It===0)break;It<0?Z=Z.left:(tt=Z,Z=Z.right)}return tt},Q.prototype.clear=function(){return this._root=null,this._size=0,this},Q.prototype.toList=function(){return Ct(this._root)},Q.prototype.load=function(D,Z,tt){Z===void 0&&(Z=[]),tt===void 0&&(tt=!1);var Et=D.length,It=this._comparator;if(tt&&lt(D,Z,0,Et-1,It),this._root===null)this._root=K(D,Z,0,Et),this._size=Et;else{var ce=mt(this.toList(),J(D,Z),It);Et=this._size+Et,this._root=ft({head:ce},0,Et)}return this},Q.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Q.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Q.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Q.prototype.toString=function(D){D===void 0&&(D=function(tt){return String(tt.key)});var Z=[];return ct(this._root,"",!0,function(tt){return Z.push(tt)},D),Z.join("")},Q.prototype.update=function(D,Z,tt){var Et=this._comparator,It=Bt(D,this._root,Et),ce=It.left,fe=It.right;Et(D,Z)<0?fe=Zt(Z,tt,fe,Et):ce=Zt(Z,tt,ce,Et),this._root=Wt(ce,fe,Et)},Q.prototype.split=function(D){return Bt(D,this._root,this._comparator)},Q.prototype[Symbol.iterator]=function(){var D,Z,tt;return it(this,function(Et){switch(Et.label){case 0:D=this._root,Z=[],tt=!1,Et.label=1;case 1:return tt?[3,6]:D===null?[3,2]:(Z.push(D),D=D.left,[3,5]);case 2:return Z.length===0?[3,4]:(D=Z.pop(),[4,D]);case 3:return Et.sent(),D=D.right,[3,5];case 4:tt=!0,Et.label=5;case 5:return[3,1];case 6:return[2]}})},Q}();function K(Q,D,Z,tt){var Et=tt-Z;if(Et>0){var It=Z+Math.floor(Et/2),ce=Q[It],fe=D[It],Be=new _t(ce,fe);return Be.left=K(Q,D,Z,It),Be.right=K(Q,D,It+1,tt),Be}return null}function J(Q,D){for(var Z=new _t(null,null),tt=Z,Et=0;Et<Q.length;Et++)tt=tt.next=new _t(Q[Et],D[Et]);return tt.next=null,Z.next}function Ct(Q){for(var D=Q,Z=[],tt=!1,Et=new _t(null,null),It=Et;!tt;)D?(Z.push(D),D=D.left):Z.length>0?(D=It=It.next=Z.pop(),D=D.right):tt=!0;return It.next=null,Et.next}function ft(Q,D,Z){var tt=Z-D;if(tt>0){var Et=D+Math.floor(tt/2),It=ft(Q,D,Et),ce=Q.head;return ce.left=It,Q.head=Q.head.next,ce.right=ft(Q,Et+1,Z),ce}return null}function mt(Q,D,Z){for(var tt=new _t(null,null),Et=tt,It=Q,ce=D;It!==null&&ce!==null;)Z(It.key,ce.key)<0?(Et.next=It,It=It.next):(Et.next=ce,ce=ce.next),Et=Et.next;return It!==null?Et.next=It:ce!==null&&(Et.next=ce),tt.next}function lt(Q,D,Z,tt,Et){if(!(Z>=tt)){for(var It=Q[Z+tt>>1],ce=Z-1,fe=tt+1;;){do ce++;while(Et(Q[ce],It)<0);do fe--;while(Et(Q[fe],It)>0);if(ce>=fe)break;var Be=Q[ce];Q[ce]=Q[fe],Q[fe]=Be,Be=D[ce],D[ce]=D[fe],D[fe]=Be}lt(Q,D,Z,fe,Et),lt(Q,D,fe+1,tt,Et)}}const jt=(Q,D)=>Q.ll.x<=D.x&&D.x<=Q.ur.x&&Q.ll.y<=D.y&&D.y<=Q.ur.y,ue=(Q,D)=>{if(D.ur.x<Q.ll.x||Q.ur.x<D.ll.x||D.ur.y<Q.ll.y||Q.ur.y<D.ll.y)return null;const Z=Q.ll.x<D.ll.x?D.ll.x:Q.ll.x,tt=Q.ur.x<D.ur.x?Q.ur.x:D.ur.x,Et=Q.ll.y<D.ll.y?D.ll.y:Q.ll.y,It=Q.ur.y<D.ur.y?Q.ur.y:D.ur.y;return{ll:{x:Z,y:Et},ur:{x:tt,y:It}}};let we=Number.EPSILON;we===void 0&&(we=Math.pow(2,-52));const Ne=we*we,Ge=(Q,D)=>{if(-we<Q&&Q<we&&-we<D&&D<we)return 0;const Z=Q-D;return Z*Z<Ne*Q*D?0:Q<D?-1:1};class ye{constructor(){this.reset()}reset(){this.xRounder=new Vt,this.yRounder=new Vt}round(D,Z){return{x:this.xRounder.round(D),y:this.yRounder.round(Z)}}}class Vt{constructor(){this.tree=new ee,this.round(0)}round(D){const Z=this.tree.add(D),tt=this.tree.prev(Z);if(tt!==null&&Ge(Z.key,tt.key)===0)return this.tree.remove(D),tt.key;const Et=this.tree.next(Z);return Et!==null&&Ge(Z.key,Et.key)===0?(this.tree.remove(D),Et.key):D}}const $=new ye,ae=11102230246251565e-32,Gt=134217729,_e=(3+8*ae)*ae;function xe(Q,D,Z,tt,Et){let It,ce,fe,Be,ze=D[0],an=tt[0],Re=0,Ke=0;an>ze==an>-ze?(It=ze,ze=D[++Re]):(It=an,an=tt[++Ke]);let cn=0;if(Re<Q&&Ke<Z)for(an>ze==an>-ze?(ce=ze+It,fe=It-(ce-ze),ze=D[++Re]):(ce=an+It,fe=It-(ce-an),an=tt[++Ke]),It=ce,fe!==0&&(Et[cn++]=fe);Re<Q&&Ke<Z;)an>ze==an>-ze?(ce=It+ze,Be=ce-It,fe=It-(ce-Be)+(ze-Be),ze=D[++Re]):(ce=It+an,Be=ce-It,fe=It-(ce-Be)+(an-Be),an=tt[++Ke]),It=ce,fe!==0&&(Et[cn++]=fe);for(;Re<Q;)ce=It+ze,Be=ce-It,fe=It-(ce-Be)+(ze-Be),ze=D[++Re],It=ce,fe!==0&&(Et[cn++]=fe);for(;Ke<Z;)ce=It+an,Be=ce-It,fe=It-(ce-Be)+(an-Be),an=tt[++Ke],It=ce,fe!==0&&(Et[cn++]=fe);return(It!==0||cn===0)&&(Et[cn++]=It),cn}function X(Q,D){let Z=D[0];for(let tt=1;tt<Q;tt++)Z+=D[tt];return Z}function Rt(Q){return new Float64Array(Q)}const V=(3+16*ae)*ae,Mt=(2+12*ae)*ae,H=(9+64*ae)*ae*ae,N=Rt(4),et=Rt(8),ot=Rt(12),At=Rt(16),Dt=Rt(4);function ie(Q,D,Z,tt,Et,It,ce){let fe,Be,ze,an,Re,Ke,cn,pn,An,Gn,Vn,fr,yr,Cr,jr,Dr,Fr,zr;const si=Q-Et,ki=Z-Et,ui=D-It,ri=tt-It;Cr=si*ri,Ke=Gt*si,cn=Ke-(Ke-si),pn=si-cn,Ke=Gt*ri,An=Ke-(Ke-ri),Gn=ri-An,jr=pn*Gn-(Cr-cn*An-pn*An-cn*Gn),Dr=ui*ki,Ke=Gt*ui,cn=Ke-(Ke-ui),pn=ui-cn,Ke=Gt*ki,An=Ke-(Ke-ki),Gn=ki-An,Fr=pn*Gn-(Dr-cn*An-pn*An-cn*Gn),Vn=jr-Fr,Re=jr-Vn,N[0]=jr-(Vn+Re)+(Re-Fr),fr=Cr+Vn,Re=fr-Cr,yr=Cr-(fr-Re)+(Vn-Re),Vn=yr-Dr,Re=yr-Vn,N[1]=yr-(Vn+Re)+(Re-Dr),zr=fr+Vn,Re=zr-fr,N[2]=fr-(zr-Re)+(Vn-Re),N[3]=zr;let Oi=X(4,N),Ui=Mt*ce;if(Oi>=Ui||-Oi>=Ui||(Re=Q-si,fe=Q-(si+Re)+(Re-Et),Re=Z-ki,ze=Z-(ki+Re)+(Re-Et),Re=D-ui,Be=D-(ui+Re)+(Re-It),Re=tt-ri,an=tt-(ri+Re)+(Re-It),fe===0&&Be===0&&ze===0&&an===0)||(Ui=H*ce+_e*Math.abs(Oi),Oi+=si*an+ri*fe-(ui*ze+ki*Be),Oi>=Ui||-Oi>=Ui))return Oi;Cr=fe*ri,Ke=Gt*fe,cn=Ke-(Ke-fe),pn=fe-cn,Ke=Gt*ri,An=Ke-(Ke-ri),Gn=ri-An,jr=pn*Gn-(Cr-cn*An-pn*An-cn*Gn),Dr=Be*ki,Ke=Gt*Be,cn=Ke-(Ke-Be),pn=Be-cn,Ke=Gt*ki,An=Ke-(Ke-ki),Gn=ki-An,Fr=pn*Gn-(Dr-cn*An-pn*An-cn*Gn),Vn=jr-Fr,Re=jr-Vn,Dt[0]=jr-(Vn+Re)+(Re-Fr),fr=Cr+Vn,Re=fr-Cr,yr=Cr-(fr-Re)+(Vn-Re),Vn=yr-Dr,Re=yr-Vn,Dt[1]=yr-(Vn+Re)+(Re-Dr),zr=fr+Vn,Re=zr-fr,Dt[2]=fr-(zr-Re)+(Vn-Re),Dt[3]=zr;const Zo=xe(4,N,4,Dt,et);Cr=si*an,Ke=Gt*si,cn=Ke-(Ke-si),pn=si-cn,Ke=Gt*an,An=Ke-(Ke-an),Gn=an-An,jr=pn*Gn-(Cr-cn*An-pn*An-cn*Gn),Dr=ui*ze,Ke=Gt*ui,cn=Ke-(Ke-ui),pn=ui-cn,Ke=Gt*ze,An=Ke-(Ke-ze),Gn=ze-An,Fr=pn*Gn-(Dr-cn*An-pn*An-cn*Gn),Vn=jr-Fr,Re=jr-Vn,Dt[0]=jr-(Vn+Re)+(Re-Fr),fr=Cr+Vn,Re=fr-Cr,yr=Cr-(fr-Re)+(Vn-Re),Vn=yr-Dr,Re=yr-Vn,Dt[1]=yr-(Vn+Re)+(Re-Dr),zr=fr+Vn,Re=zr-fr,Dt[2]=fr-(zr-Re)+(Vn-Re),Dt[3]=zr;const Xi=xe(Zo,et,4,Dt,ot);Cr=fe*an,Ke=Gt*fe,cn=Ke-(Ke-fe),pn=fe-cn,Ke=Gt*an,An=Ke-(Ke-an),Gn=an-An,jr=pn*Gn-(Cr-cn*An-pn*An-cn*Gn),Dr=Be*ze,Ke=Gt*Be,cn=Ke-(Ke-Be),pn=Be-cn,Ke=Gt*ze,An=Ke-(Ke-ze),Gn=ze-An,Fr=pn*Gn-(Dr-cn*An-pn*An-cn*Gn),Vn=jr-Fr,Re=jr-Vn,Dt[0]=jr-(Vn+Re)+(Re-Fr),fr=Cr+Vn,Re=fr-Cr,yr=Cr-(fr-Re)+(Vn-Re),Vn=yr-Dr,Re=yr-Vn,Dt[1]=yr-(Vn+Re)+(Re-Dr),zr=fr+Vn,Re=zr-fr,Dt[2]=fr-(zr-Re)+(Vn-Re),Dt[3]=zr;const bo=xe(Xi,ot,4,Dt,At);return At[bo-1]}function Tt(Q,D,Z,tt,Et,It){const ce=(D-It)*(Z-Et),fe=(Q-Et)*(tt-It),Be=ce-fe,ze=Math.abs(ce+fe);return Math.abs(Be)>=V*ze?Be:-ie(Q,D,Z,tt,Et,It,ze)}const zt=(Q,D)=>Q.x*D.y-Q.y*D.x,Oe=(Q,D)=>Q.x*D.x+Q.y*D.y,Lt=(Q,D,Z)=>{const tt=Tt(Q.x,Q.y,D.x,D.y,Z.x,Z.y);return tt>0?-1:tt<0?1:0},nt=Q=>Math.sqrt(Oe(Q,Q)),Ft=(Q,D,Z)=>{const tt={x:D.x-Q.x,y:D.y-Q.y},Et={x:Z.x-Q.x,y:Z.y-Q.y};return zt(Et,tt)/nt(Et)/nt(tt)},he=(Q,D,Z)=>{const tt={x:D.x-Q.x,y:D.y-Q.y},Et={x:Z.x-Q.x,y:Z.y-Q.y};return Oe(Et,tt)/nt(Et)/nt(tt)},yt=(Q,D,Z)=>D.y===0?null:{x:Q.x+D.x/D.y*(Z-Q.y),y:Z},St=(Q,D,Z)=>D.x===0?null:{x:Z,y:Q.y+D.y/D.x*(Z-Q.x)},F=(Q,D,Z,tt)=>{if(D.x===0)return St(Z,tt,Q.x);if(tt.x===0)return St(Q,D,Z.x);if(D.y===0)return yt(Z,tt,Q.y);if(tt.y===0)return yt(Q,D,Z.y);const Et=zt(D,tt);if(Et==0)return null;const It={x:Z.x-Q.x,y:Z.y-Q.y},ce=zt(It,D)/Et,fe=zt(It,tt)/Et,Be=Q.x+fe*D.x,ze=Z.x+ce*tt.x,an=Q.y+fe*D.y,Re=Z.y+ce*tt.y,Ke=(Be+ze)/2,cn=(an+Re)/2;return{x:Ke,y:cn}};class T{static compare(D,Z){const tt=T.comparePoints(D.point,Z.point);return tt!==0?tt:(D.point!==Z.point&&D.link(Z),D.isLeft!==Z.isLeft?D.isLeft?1:-1:ne.compare(D.segment,Z.segment))}static comparePoints(D,Z){return D.x<Z.x?-1:D.x>Z.x?1:D.y<Z.y?-1:D.y>Z.y?1:0}constructor(D,Z){D.events===void 0?D.events=[this]:D.events.push(this),this.point=D,this.isLeft=Z}link(D){if(D.point===this.point)throw new Error("Tried to link already linked events");const Z=D.point.events;for(let tt=0,Et=Z.length;tt<Et;tt++){const It=Z[tt];this.point.events.push(It),It.point=this.point}this.checkForConsuming()}checkForConsuming(){const D=this.point.events.length;for(let Z=0;Z<D;Z++){const tt=this.point.events[Z];if(tt.segment.consumedBy===void 0)for(let Et=Z+1;Et<D;Et++){const It=this.point.events[Et];It.consumedBy===void 0&&tt.otherSE.point.events===It.otherSE.point.events&&tt.segment.consume(It.segment)}}}getAvailableLinkedEvents(){const D=[];for(let Z=0,tt=this.point.events.length;Z<tt;Z++){const Et=this.point.events[Z];Et!==this&&!Et.segment.ringOut&&Et.segment.isInResult()&&D.push(Et)}return D}getLeftmostComparator(D){const Z=new Map,tt=Et=>{const It=Et.otherSE;Z.set(Et,{sine:Ft(this.point,D.point,It.point),cosine:he(this.point,D.point,It.point)})};return(Et,It)=>{Z.has(Et)||tt(Et),Z.has(It)||tt(It);const{sine:ce,cosine:fe}=Z.get(Et),{sine:Be,cosine:ze}=Z.get(It);return ce>=0&&Be>=0?fe<ze?1:fe>ze?-1:0:ce<0&&Be<0?fe<ze?-1:fe>ze?1:0:Be<ce?-1:Be>ce?1:0}}}let gt=0;class ne{static compare(D,Z){const tt=D.leftSE.point.x,Et=Z.leftSE.point.x,It=D.rightSE.point.x,ce=Z.rightSE.point.x;if(ce<tt)return 1;if(It<Et)return-1;const fe=D.leftSE.point.y,Be=Z.leftSE.point.y,ze=D.rightSE.point.y,an=Z.rightSE.point.y;if(tt<Et){if(Be<fe&&Be<ze)return 1;if(Be>fe&&Be>ze)return-1;const Re=D.comparePoint(Z.leftSE.point);if(Re<0)return 1;if(Re>0)return-1;const Ke=Z.comparePoint(D.rightSE.point);return Ke!==0?Ke:-1}if(tt>Et){if(fe<Be&&fe<an)return-1;if(fe>Be&&fe>an)return 1;const Re=Z.comparePoint(D.leftSE.point);if(Re!==0)return Re;const Ke=D.comparePoint(Z.rightSE.point);return Ke<0?1:Ke>0?-1:1}if(fe<Be)return-1;if(fe>Be)return 1;if(It<ce){const Re=Z.comparePoint(D.rightSE.point);if(Re!==0)return Re}if(It>ce){const Re=D.comparePoint(Z.rightSE.point);if(Re<0)return 1;if(Re>0)return-1}if(It!==ce){const Re=ze-fe,Ke=It-tt,cn=an-Be,pn=ce-Et;if(Re>Ke&&cn<pn)return 1;if(Re<Ke&&cn>pn)return-1}return It>ce?1:It<ce||ze<an?-1:ze>an?1:D.id<Z.id?-1:D.id>Z.id?1:0}constructor(D,Z,tt,Et){this.id=++gt,this.leftSE=D,D.segment=this,D.otherSE=Z,this.rightSE=Z,Z.segment=this,Z.otherSE=D,this.rings=tt,this.windings=Et}static fromRing(D,Z,tt){let Et,It,ce;const fe=T.comparePoints(D,Z);if(fe<0)Et=D,It=Z,ce=1;else if(fe>0)Et=Z,It=D,ce=-1;else throw new Error(`Tried to create degenerate segment at [${D.x}, ${D.y}]`);const Be=new T(Et,!0),ze=new T(It,!1);return new ne(Be,ze,[tt],[ce])}replaceRightSE(D){this.rightSE=D,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const D=this.leftSE.point.y,Z=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:D<Z?D:Z},ur:{x:this.rightSE.point.x,y:D>Z?D:Z}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(D){return D.x===this.leftSE.point.x&&D.y===this.leftSE.point.y||D.x===this.rightSE.point.x&&D.y===this.rightSE.point.y}comparePoint(D){if(this.isAnEndpoint(D))return 0;const Z=this.leftSE.point,tt=this.rightSE.point,Et=this.vector();if(Z.x===tt.x)return D.x===Z.x?0:D.x<Z.x?1:-1;const It=(D.y-Z.y)/Et.y,ce=Z.x+It*Et.x;if(D.x===ce)return 0;const fe=(D.x-Z.x)/Et.x,Be=Z.y+fe*Et.y;return D.y===Be?0:D.y<Be?-1:1}getIntersection(D){const Z=this.bbox(),tt=D.bbox(),Et=ue(Z,tt);if(Et===null)return null;const It=this.leftSE.point,ce=this.rightSE.point,fe=D.leftSE.point,Be=D.rightSE.point,ze=jt(Z,fe)&&this.comparePoint(fe)===0,an=jt(tt,It)&&D.comparePoint(It)===0,Re=jt(Z,Be)&&this.comparePoint(Be)===0,Ke=jt(tt,ce)&&D.comparePoint(ce)===0;if(an&&ze)return Ke&&!Re?ce:!Ke&&Re?Be:null;if(an)return Re&&It.x===Be.x&&It.y===Be.y?null:It;if(ze)return Ke&&ce.x===fe.x&&ce.y===fe.y?null:fe;if(Ke&&Re)return null;if(Ke)return ce;if(Re)return Be;const cn=F(It,this.vector(),fe,D.vector());return cn===null||!jt(Et,cn)?null:$.round(cn.x,cn.y)}split(D){const Z=[],tt=D.events!==void 0,Et=new T(D,!0),It=new T(D,!1),ce=this.rightSE;this.replaceRightSE(It),Z.push(It),Z.push(Et);const fe=new ne(Et,ce,this.rings.slice(),this.windings.slice());return T.comparePoints(fe.leftSE.point,fe.rightSE.point)>0&&fe.swapEvents(),T.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),tt&&(Et.checkForConsuming(),It.checkForConsuming()),Z}swapEvents(){const D=this.rightSE;this.rightSE=this.leftSE,this.leftSE=D,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let Z=0,tt=this.windings.length;Z<tt;Z++)this.windings[Z]*=-1}consume(D){let Z=this,tt=D;for(;Z.consumedBy;)Z=Z.consumedBy;for(;tt.consumedBy;)tt=tt.consumedBy;const Et=ne.compare(Z,tt);if(Et!==0){if(Et>0){const It=Z;Z=tt,tt=It}if(Z.prev===tt){const It=Z;Z=tt,tt=It}for(let It=0,ce=tt.rings.length;It<ce;It++){const fe=tt.rings[It],Be=tt.windings[It],ze=Z.rings.indexOf(fe);ze===-1?(Z.rings.push(fe),Z.windings.push(Be)):Z.windings[ze]+=Be}tt.rings=null,tt.windings=null,tt.consumedBy=Z,tt.leftSE.consumedBy=Z.leftSE,tt.rightSE.consumedBy=Z.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const D=this.prev.consumedBy||this.prev;this._beforeState=D.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const D=this.beforeState();this._afterState={rings:D.rings.slice(0),windings:D.windings.slice(0),multiPolys:[]};const Z=this._afterState.rings,tt=this._afterState.windings,Et=this._afterState.multiPolys;for(let fe=0,Be=this.rings.length;fe<Be;fe++){const ze=this.rings[fe],an=this.windings[fe],Re=Z.indexOf(ze);Re===-1?(Z.push(ze),tt.push(an)):tt[Re]+=an}const It=[],ce=[];for(let fe=0,Be=Z.length;fe<Be;fe++){if(tt[fe]===0)continue;const ze=Z[fe],an=ze.poly;if(ce.indexOf(an)===-1)if(ze.isExterior)It.push(an);else{ce.indexOf(an)===-1&&ce.push(an);const Re=It.indexOf(ze.poly);Re!==-1&&It.splice(Re,1)}}for(let fe=0,Be=It.length;fe<Be;fe++){const ze=It[fe].multiPoly;Et.indexOf(ze)===-1&&Et.push(ze)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const D=this.beforeState().multiPolys,Z=this.afterState().multiPolys;switch($e.type){case"union":{const tt=D.length===0,Et=Z.length===0;this._isInResult=tt!==Et;break}case"intersection":{let tt,Et;D.length<Z.length?(tt=D.length,Et=Z.length):(tt=Z.length,Et=D.length),this._isInResult=Et===$e.numMultiPolys&&tt<Et;break}case"xor":{const tt=Math.abs(D.length-Z.length);this._isInResult=tt%2===1;break}case"difference":{const tt=Et=>Et.length===1&&Et[0].isSubject;this._isInResult=tt(D)!==tt(Z);break}default:throw new Error(`Unrecognized operation type found ${$e.type}`)}return this._isInResult}}class C{constructor(D,Z,tt){if(!Array.isArray(D)||D.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Z,this.isExterior=tt,this.segments=[],typeof D[0][0]!="number"||typeof D[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const Et=$.round(D[0][0],D[0][1]);this.bbox={ll:{x:Et.x,y:Et.y},ur:{x:Et.x,y:Et.y}};let It=Et;for(let ce=1,fe=D.length;ce<fe;ce++){if(typeof D[ce][0]!="number"||typeof D[ce][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let Be=$.round(D[ce][0],D[ce][1]);Be.x===It.x&&Be.y===It.y||(this.segments.push(ne.fromRing(It,Be,this)),Be.x<this.bbox.ll.x&&(this.bbox.ll.x=Be.x),Be.y<this.bbox.ll.y&&(this.bbox.ll.y=Be.y),Be.x>this.bbox.ur.x&&(this.bbox.ur.x=Be.x),Be.y>this.bbox.ur.y&&(this.bbox.ur.y=Be.y),It=Be)}(Et.x!==It.x||Et.y!==It.y)&&this.segments.push(ne.fromRing(It,Et,this))}getSweepEvents(){const D=[];for(let Z=0,tt=this.segments.length;Z<tt;Z++){const Et=this.segments[Z];D.push(Et.leftSE),D.push(Et.rightSE)}return D}}class j{constructor(D,Z){if(!Array.isArray(D))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new C(D[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let tt=1,Et=D.length;tt<Et;tt++){const It=new C(D[tt],this,!1);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.interiorRings.push(It)}this.multiPoly=Z}getSweepEvents(){const D=this.exteriorRing.getSweepEvents();for(let Z=0,tt=this.interiorRings.length;Z<tt;Z++){const Et=this.interiorRings[Z].getSweepEvents();for(let It=0,ce=Et.length;It<ce;It++)D.push(Et[It])}return D}}class Pt{constructor(D,Z){if(!Array.isArray(D))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof D[0][0][0]=="number"&&(D=[D])}catch(tt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let tt=0,Et=D.length;tt<Et;tt++){const It=new j(D[tt],this);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.polys.push(It)}this.isSubject=Z}getSweepEvents(){const D=[];for(let Z=0,tt=this.polys.length;Z<tt;Z++){const Et=this.polys[Z].getSweepEvents();for(let It=0,ce=Et.length;It<ce;It++)D.push(Et[It])}return D}}class Jt{static factory(D){const Z=[];for(let tt=0,Et=D.length;tt<Et;tt++){const It=D[tt];if(!It.isInResult()||It.ringOut)continue;let ce=null,fe=It.leftSE,Be=It.rightSE;const ze=[fe],an=fe.point,Re=[];for(;ce=fe,fe=Be,ze.push(fe),fe.point!==an;)for(;;){const Ke=fe.getAvailableLinkedEvents();if(Ke.length===0){const An=ze[0].point,Gn=ze[ze.length-1].point;throw new Error(`Unable to complete output ring starting at [${An.x}, ${An.y}]. Last matching segment found ends at [${Gn.x}, ${Gn.y}].`)}if(Ke.length===1){Be=Ke[0].otherSE;break}let cn=null;for(let An=0,Gn=Re.length;An<Gn;An++)if(Re[An].point===fe.point){cn=An;break}if(cn!==null){const An=Re.splice(cn)[0],Gn=ze.splice(An.index);Gn.unshift(Gn[0].otherSE),Z.push(new Jt(Gn.reverse()));continue}Re.push({index:ze.length,point:fe.point});const pn=fe.getLeftmostComparator(ce);Be=Ke.sort(pn)[0].otherSE;break}Z.push(new Jt(ze))}return Z}constructor(D){this.events=D;for(let Z=0,tt=D.length;Z<tt;Z++)D[Z].segment.ringOut=this;this.poly=null}getGeom(){let D=this.events[0].point;const Z=[D];for(let ze=1,an=this.events.length-1;ze<an;ze++){const Re=this.events[ze].point,Ke=this.events[ze+1].point;Lt(Re,D,Ke)!==0&&(Z.push(Re),D=Re)}if(Z.length===1)return null;const tt=Z[0],Et=Z[1];Lt(tt,D,Et)===0&&Z.shift(),Z.push(Z[0]);const It=this.isExteriorRing()?1:-1,ce=this.isExteriorRing()?0:Z.length-1,fe=this.isExteriorRing()?Z.length:-1,Be=[];for(let ze=ce;ze!=fe;ze+=It)Be.push([Z[ze].x,Z[ze].y]);return Be}isExteriorRing(){if(this._isExteriorRing===void 0){const D=this.enclosingRing();this._isExteriorRing=D?!D.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let D=this.events[0];for(let Et=1,It=this.events.length;Et<It;Et++){const ce=this.events[Et];T.compare(D,ce)>0&&(D=ce)}let Z=D.segment.prevInResult(),tt=Z?Z.prevInResult():null;for(;;){if(!Z)return null;if(!tt)return Z.ringOut;if(tt.ringOut!==Z.ringOut)return tt.ringOut.enclosingRing()!==Z.ringOut?Z.ringOut:Z.ringOut.enclosingRing();Z=tt.prevInResult(),tt=Z?Z.prevInResult():null}}}class se{constructor(D){this.exteriorRing=D,D.poly=this,this.interiorRings=[]}addInterior(D){this.interiorRings.push(D),D.poly=this}getGeom(){const D=[this.exteriorRing.getGeom()];if(D[0]===null)return null;for(let Z=0,tt=this.interiorRings.length;Z<tt;Z++){const Et=this.interiorRings[Z].getGeom();Et!==null&&D.push(Et)}return D}}class Ae{constructor(D){this.rings=D,this.polys=this._composePolys(D)}getGeom(){const D=[];for(let Z=0,tt=this.polys.length;Z<tt;Z++){const Et=this.polys[Z].getGeom();Et!==null&&D.push(Et)}return D}_composePolys(D){const Z=[];for(let tt=0,Et=D.length;tt<Et;tt++){const It=D[tt];if(!It.poly)if(It.isExteriorRing())Z.push(new se(It));else{const ce=It.enclosingRing();ce.poly||Z.push(new se(ce)),ce.poly.addInterior(It)}}return Z}}class Le{constructor(D){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ne.compare;this.queue=D,this.tree=new ee(Z),this.segments=[]}process(D){const Z=D.segment,tt=[];if(D.consumedBy)return D.isLeft?this.queue.remove(D.otherSE):this.tree.remove(Z),tt;const Et=D.isLeft?this.tree.add(Z):this.tree.find(Z);if(!Et)throw new Error(`Unable to find segment #${Z.id} [${Z.leftSE.point.x}, ${Z.leftSE.point.y}] -> [${Z.rightSE.point.x}, ${Z.rightSE.point.y}] in SweepLine tree.`);let It=Et,ce=Et,fe,Be;for(;fe===void 0;)It=this.tree.prev(It),It===null?fe=null:It.key.consumedBy===void 0&&(fe=It.key);for(;Be===void 0;)ce=this.tree.next(ce),ce===null?Be=null:ce.key.consumedBy===void 0&&(Be=ce.key);if(D.isLeft){let ze=null;if(fe){const Re=fe.getIntersection(Z);if(Re!==null&&(Z.isAnEndpoint(Re)||(ze=Re),!fe.isAnEndpoint(Re))){const Ke=this._splitSafely(fe,Re);for(let cn=0,pn=Ke.length;cn<pn;cn++)tt.push(Ke[cn])}}let an=null;if(Be){const Re=Be.getIntersection(Z);if(Re!==null&&(Z.isAnEndpoint(Re)||(an=Re),!Be.isAnEndpoint(Re))){const Ke=this._splitSafely(Be,Re);for(let cn=0,pn=Ke.length;cn<pn;cn++)tt.push(Ke[cn])}}if(ze!==null||an!==null){let Re=null;ze===null?Re=an:an===null?Re=ze:Re=T.comparePoints(ze,an)<=0?ze:an,this.queue.remove(Z.rightSE),tt.push(Z.rightSE);const Ke=Z.split(Re);for(let cn=0,pn=Ke.length;cn<pn;cn++)tt.push(Ke[cn])}tt.length>0?(this.tree.remove(Z),tt.push(D)):(this.segments.push(Z),Z.prev=fe)}else{if(fe&&Be){const ze=fe.getIntersection(Be);if(ze!==null){if(!fe.isAnEndpoint(ze)){const an=this._splitSafely(fe,ze);for(let Re=0,Ke=an.length;Re<Ke;Re++)tt.push(an[Re])}if(!Be.isAnEndpoint(ze)){const an=this._splitSafely(Be,ze);for(let Re=0,Ke=an.length;Re<Ke;Re++)tt.push(an[Re])}}}this.tree.remove(Z)}return tt}_splitSafely(D,Z){this.tree.remove(D);const tt=D.rightSE;this.queue.remove(tt);const Et=D.split(Z);return Et.push(tt),D.consumedBy===void 0&&this.tree.add(D),Et}}const De=typeof pt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ve=typeof pt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class We{run(D,Z,tt){$e.type=D,$.reset();const Et=[new Pt(Z,!0)];for(let Re=0,Ke=tt.length;Re<Ke;Re++)Et.push(new Pt(tt[Re],!1));if($e.numMultiPolys=Et.length,$e.type==="difference"){const Re=Et[0];let Ke=1;for(;Ke<Et.length;)ue(Et[Ke].bbox,Re.bbox)!==null?Ke++:Et.splice(Ke,1)}if($e.type==="intersection")for(let Re=0,Ke=Et.length;Re<Ke;Re++){const cn=Et[Re];for(let pn=Re+1,An=Et.length;pn<An;pn++)if(ue(cn.bbox,Et[pn].bbox)===null)return[]}const It=new ee(T.compare);for(let Re=0,Ke=Et.length;Re<Ke;Re++){const cn=Et[Re].getSweepEvents();for(let pn=0,An=cn.length;pn<An;pn++)if(It.insert(cn[pn]),It.size>De)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const ce=new Le(It);let fe=It.size,Be=It.pop();for(;Be;){const Re=Be.key;if(It.size===fe){const cn=Re.segment;throw new Error(`Unable to pop() ${Re.isLeft?"left":"right"} SweepEvent [${Re.point.x}, ${Re.point.y}] from segment #${cn.id} [${cn.leftSE.point.x}, ${cn.leftSE.point.y}] -> [${cn.rightSE.point.x}, ${cn.rightSE.point.y}] from queue.`)}if(It.size>De)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(ce.segments.length>Ve)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const Ke=ce.process(Re);for(let cn=0,pn=Ke.length;cn<pn;cn++){const An=Ke[cn];An.consumedBy===void 0&&It.insert(An)}fe=It.size,Be=It.pop()}$.reset();const ze=Jt.factory(ce.segments);return new Ae(ze).getGeom()}}const $e=new We;var pe={union:function(Q){for(var D=arguments.length,Z=new Array(D>1?D-1:0),tt=1;tt<D;tt++)Z[tt-1]=arguments[tt];return $e.run("union",Q,Z)},intersection:function(Q){for(var D=arguments.length,Z=new Array(D>1?D-1:0),tt=1;tt<D;tt++)Z[tt-1]=arguments[tt];return $e.run("intersection",Q,Z)},xor:function(Q){for(var D=arguments.length,Z=new Array(D>1?D-1:0),tt=1;tt<D;tt++)Z[tt-1]=arguments[tt];return $e.run("xor",Q,Z)},difference:function(Q){for(var D=arguments.length,Z=new Array(D>1?D-1:0),tt=1;tt<D;tt++)Z[tt-1]=arguments[tt];return $e.run("difference",Q,Z)}};return pe})},86851:function(ke,Se,k){"use strict";var pt=k(89594),it=Array.prototype.concat,_t=Array.prototype.slice,qt=ke.exports=function(Zt){for(var Bt=[],Wt=0,ct=Zt.length;Wt<ct;Wt++){var ee=Zt[Wt];pt(ee)?Bt=it.call(Bt,_t.call(ee)):Bt.push(ee)}return Bt};qt.wrap=function(q){return function(){return q(qt(arguments))}}},89594:function(ke){ke.exports=function(k){return!k||typeof k=="string"?!1:k instanceof Array||Array.isArray(k)||k.length>=0&&(k.splice instanceof Function||Object.getOwnPropertyDescriptor(k,k.length-1)&&k.constructor.name!=="String")}},69848:function(ke){(function(Se,k){ke.exports=k()})(this,function(){"use strict";function Se(Vt,$,ae,Gt,_e,xe){if(!(_e-Gt<=ae)){var X=Gt+_e>>1;k(Vt,$,X,Gt,_e,xe%2),Se(Vt,$,ae,Gt,X-1,xe+1),Se(Vt,$,ae,X+1,_e,xe+1)}}function k(Vt,$,ae,Gt,_e,xe){for(;_e>Gt;){if(_e-Gt>600){var X=_e-Gt+1,Rt=ae-Gt+1,V=Math.log(X),Mt=.5*Math.exp(2*V/3),H=.5*Math.sqrt(V*Mt*(X-Mt)/X)*(Rt-X/2<0?-1:1),N=Math.max(Gt,Math.floor(ae-Rt*Mt/X+H)),et=Math.min(_e,Math.floor(ae+(X-Rt)*Mt/X+H));k(Vt,$,ae,N,et,xe)}var ot=$[2*ae+xe],At=Gt,Dt=_e;for(pt(Vt,$,Gt,ae),$[2*_e+xe]>ot&&pt(Vt,$,Gt,_e);At<Dt;){for(pt(Vt,$,At,Dt),At++,Dt--;$[2*At+xe]<ot;)At++;for(;$[2*Dt+xe]>ot;)Dt--}$[2*Gt+xe]===ot?pt(Vt,$,Gt,Dt):(Dt++,pt(Vt,$,Dt,_e)),Dt<=ae&&(Gt=Dt+1),ae<=Dt&&(_e=Dt-1)}}function pt(Vt,$,ae,Gt){it(Vt,ae,Gt),it($,2*ae,2*Gt),it($,2*ae+1,2*Gt+1)}function it(Vt,$,ae){var Gt=Vt[$];Vt[$]=Vt[ae],Vt[ae]=Gt}function _t(Vt,$,ae,Gt,_e,xe,X){for(var Rt=[0,Vt.length-1,0],V=[],Mt,H;Rt.length;){var N=Rt.pop(),et=Rt.pop(),ot=Rt.pop();if(et-ot<=X){for(var At=ot;At<=et;At++)Mt=$[2*At],H=$[2*At+1],Mt>=ae&&Mt<=_e&&H>=Gt&&H<=xe&&V.push(Vt[At]);continue}var Dt=Math.floor((ot+et)/2);Mt=$[2*Dt],H=$[2*Dt+1],Mt>=ae&&Mt<=_e&&H>=Gt&&H<=xe&&V.push(Vt[Dt]);var ie=(N+1)%2;(N===0?ae<=Mt:Gt<=H)&&(Rt.push(ot),Rt.push(Dt-1),Rt.push(ie)),(N===0?_e>=Mt:xe>=H)&&(Rt.push(Dt+1),Rt.push(et),Rt.push(ie))}return V}function qt(Vt,$,ae,Gt,_e,xe){for(var X=[0,Vt.length-1,0],Rt=[],V=_e*_e;X.length;){var Mt=X.pop(),H=X.pop(),N=X.pop();if(H-N<=xe){for(var et=N;et<=H;et++)q($[2*et],$[2*et+1],ae,Gt)<=V&&Rt.push(Vt[et]);continue}var ot=Math.floor((N+H)/2),At=$[2*ot],Dt=$[2*ot+1];q(At,Dt,ae,Gt)<=V&&Rt.push(Vt[ot]);var ie=(Mt+1)%2;(Mt===0?ae-_e<=At:Gt-_e<=Dt)&&(X.push(N),X.push(ot-1),X.push(ie)),(Mt===0?ae+_e>=At:Gt+_e>=Dt)&&(X.push(ot+1),X.push(H),X.push(ie))}return Rt}function q(Vt,$,ae,Gt){var _e=Vt-ae,xe=$-Gt;return _e*_e+xe*xe}var Zt=function(Vt){return Vt[0]},Bt=function(Vt){return Vt[1]},Wt=function($,ae,Gt,_e,xe){ae===void 0&&(ae=Zt),Gt===void 0&&(Gt=Bt),_e===void 0&&(_e=64),xe===void 0&&(xe=Float64Array),this.nodeSize=_e,this.points=$;for(var X=$.length<65536?Uint16Array:Uint32Array,Rt=this.ids=new X($.length),V=this.coords=new xe($.length*2),Mt=0;Mt<$.length;Mt++)Rt[Mt]=Mt,V[2*Mt]=ae($[Mt]),V[2*Mt+1]=Gt($[Mt]);Se(Rt,V,_e,0,Rt.length-1,0)};Wt.prototype.range=function($,ae,Gt,_e){return _t(this.ids,this.coords,$,ae,Gt,_e,this.nodeSize)},Wt.prototype.within=function($,ae,Gt){return qt(this.ids,this.coords,$,ae,Gt,this.nodeSize)};var ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Vt){return Vt}},ee=Math.fround||function(Vt){return function($){return Vt[0]=+$,Vt[0]}}(new Float32Array(1)),K=function($){this.options=Ne(Object.create(ct),$),this.trees=new Array(this.options.maxZoom+1)};K.prototype.load=function($){var ae=this.options,Gt=ae.log,_e=ae.minZoom,xe=ae.maxZoom,X=ae.nodeSize;Gt&&console.time("total time");var Rt="prepare "+$.length+" points";Gt&&console.time(Rt),this.points=$;for(var V=[],Mt=0;Mt<$.length;Mt++)$[Mt].geometry&&V.push(Ct($[Mt],Mt));this.trees[xe+1]=new Wt(V,Ge,ye,X,Float32Array),Gt&&console.timeEnd(Rt);for(var H=xe;H>=_e;H--){var N=+Date.now();V=this._cluster(V,H),this.trees[H]=new Wt(V,Ge,ye,X,Float32Array),Gt&&console.log("z%d: %d clusters in %dms",H,V.length,+Date.now()-N)}return Gt&&console.timeEnd("total time"),this},K.prototype.getClusters=function($,ae){var Gt=(($[0]+180)%360+360)%360-180,_e=Math.max(-90,Math.min(90,$[1])),xe=$[2]===180?180:(($[2]+180)%360+360)%360-180,X=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)Gt=-180,xe=180;else if(Gt>xe){var Rt=this.getClusters([Gt,_e,180,X],ae),V=this.getClusters([-180,_e,xe,X],ae);return Rt.concat(V)}for(var Mt=this.trees[this._limitZoom(ae)],H=Mt.range(lt(Gt),jt(X),lt(xe),jt(_e)),N=[],et=0,ot=H;et<ot.length;et+=1){var At=ot[et],Dt=Mt.points[At];N.push(Dt.numPoints?ft(Dt):this.points[Dt.index])}return N},K.prototype.getChildren=function($){var ae=this._getOriginId($),Gt=this._getOriginZoom($),_e="No cluster with the specified id.",xe=this.trees[Gt];if(!xe)throw new Error(_e);var X=xe.points[ae];if(!X)throw new Error(_e);for(var Rt=this.options.radius/(this.options.extent*Math.pow(2,Gt-1)),V=xe.within(X.x,X.y,Rt),Mt=[],H=0,N=V;H<N.length;H+=1){var et=N[H],ot=xe.points[et];ot.parentId===$&&Mt.push(ot.numPoints?ft(ot):this.points[ot.index])}if(Mt.length===0)throw new Error(_e);return Mt},K.prototype.getLeaves=function($,ae,Gt){ae=ae||10,Gt=Gt||0;var _e=[];return this._appendLeaves(_e,$,ae,Gt,0),_e},K.prototype.getTile=function($,ae,Gt){var _e=this.trees[this._limitZoom($)],xe=Math.pow(2,$),X=this.options,Rt=X.extent,V=X.radius,Mt=V/Rt,H=(Gt-Mt)/xe,N=(Gt+1+Mt)/xe,et={features:[]};return this._addTileFeatures(_e.range((ae-Mt)/xe,H,(ae+1+Mt)/xe,N),_e.points,ae,Gt,xe,et),ae===0&&this._addTileFeatures(_e.range(1-Mt/xe,H,1,N),_e.points,xe,Gt,xe,et),ae===xe-1&&this._addTileFeatures(_e.range(0,H,Mt/xe,N),_e.points,-1,Gt,xe,et),et.features.length?et:null},K.prototype.getClusterExpansionZoom=function($){for(var ae=this._getOriginZoom($)-1;ae<=this.options.maxZoom;){var Gt=this.getChildren($);if(ae++,Gt.length!==1)break;$=Gt[0].properties.cluster_id}return ae},K.prototype._appendLeaves=function($,ae,Gt,_e,xe){for(var X=this.getChildren(ae),Rt=0,V=X;Rt<V.length;Rt+=1){var Mt=V[Rt],H=Mt.properties;if(H&&H.cluster?xe+H.point_count<=_e?xe+=H.point_count:xe=this._appendLeaves($,H.cluster_id,Gt,_e,xe):xe<_e?xe++:$.push(Mt),$.length===Gt)break}return xe},K.prototype._addTileFeatures=function($,ae,Gt,_e,xe,X){for(var Rt=0,V=$;Rt<V.length;Rt+=1){var Mt=V[Rt],H=ae[Mt],N=H.numPoints,et=void 0,ot=void 0,At=void 0;if(N)et=mt(H),ot=H.x,At=H.y;else{var Dt=this.points[H.index];et=Dt.properties,ot=lt(Dt.geometry.coordinates[0]),At=jt(Dt.geometry.coordinates[1])}var ie={type:1,geometry:[[Math.round(this.options.extent*(ot*xe-Gt)),Math.round(this.options.extent*(At*xe-_e))]],tags:et},Tt=void 0;N?Tt=H.id:this.options.generateId?Tt=H.index:this.points[H.index].id&&(Tt=this.points[H.index].id),Tt!==void 0&&(ie.id=Tt),X.features.push(ie)}},K.prototype._limitZoom=function($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))},K.prototype._cluster=function($,ae){for(var Gt=[],_e=this.options,xe=_e.radius,X=_e.extent,Rt=_e.reduce,V=_e.minPoints,Mt=xe/(X*Math.pow(2,ae)),H=0;H<$.length;H++){var N=$[H];if(!(N.zoom<=ae)){N.zoom=ae;for(var et=this.trees[ae+1],ot=et.within(N.x,N.y,Mt),At=N.numPoints||1,Dt=At,ie=0,Tt=ot;ie<Tt.length;ie+=1){var zt=Tt[ie],Oe=et.points[zt];Oe.zoom>ae&&(Dt+=Oe.numPoints||1)}if(Dt>At&&Dt>=V){for(var Lt=N.x*At,nt=N.y*At,Ft=Rt&&At>1?this._map(N,!0):null,he=(H<<5)+(ae+1)+this.points.length,yt=0,St=ot;yt<St.length;yt+=1){var F=St[yt],T=et.points[F];if(!(T.zoom<=ae)){T.zoom=ae;var gt=T.numPoints||1;Lt+=T.x*gt,nt+=T.y*gt,T.parentId=he,Rt&&(Ft||(Ft=this._map(N,!0)),Rt(Ft,this._map(T)))}}N.parentId=he,Gt.push(J(Lt/Dt,nt/Dt,he,Dt,Ft))}else if(Gt.push(N),Dt>1)for(var ne=0,C=ot;ne<C.length;ne+=1){var j=C[ne],Pt=et.points[j];Pt.zoom<=ae||(Pt.zoom=ae,Gt.push(Pt))}}}return Gt},K.prototype._getOriginId=function($){return $-this.points.length>>5},K.prototype._getOriginZoom=function($){return($-this.points.length)%32},K.prototype._map=function($,ae){if($.numPoints)return ae?Ne({},$.properties):$.properties;var Gt=this.points[$.index].properties,_e=this.options.map(Gt);return ae&&_e===Gt?Ne({},_e):_e};function J(Vt,$,ae,Gt,_e){return{x:ee(Vt),y:ee($),zoom:1/0,id:ae,parentId:-1,numPoints:Gt,properties:_e}}function Ct(Vt,$){var ae=Vt.geometry.coordinates,Gt=ae[0],_e=ae[1];return{x:ee(lt(Gt)),y:ee(jt(_e)),zoom:1/0,index:$,parentId:-1}}function ft(Vt){return{type:"Feature",id:Vt.id,properties:mt(Vt),geometry:{type:"Point",coordinates:[ue(Vt.x),we(Vt.y)]}}}function mt(Vt){var $=Vt.numPoints,ae=$>=1e4?Math.round($/1e3)+"k":$>=1e3?Math.round($/100)/10+"k":$;return Ne(Ne({},Vt.properties),{cluster:!0,cluster_id:Vt.id,point_count:$,point_count_abbreviated:ae})}function lt(Vt){return Vt/360+.5}function jt(Vt){var $=Math.sin(Vt*Math.PI/180),ae=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return ae<0?0:ae>1?1:ae}function ue(Vt){return(Vt-.5)*360}function we(Vt){var $=(180-Vt*360)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Ne(Vt,$){for(var ae in $)Vt[ae]=$[ae];return Vt}function Ge(Vt){return Vt.x}function ye(Vt){return Vt.y}return K})},5501:function(ke,Se,k){"use strict";var pt=k(90857);Se.Z=pt},89093:function(ke,Se,k){"use strict";var pt=k(38554);Se.Z=pt},90378:function(ke,Se,k){"use strict";k.d(Se,{ZP:function(){return Ge}});function pt(Tt,zt,Oe){Tt.prototype=zt.prototype=Oe,Oe.constructor=Tt}function it(Tt,zt){var Oe=Object.create(Tt.prototype);for(var Lt in zt)Oe[Lt]=zt[Lt];return Oe}function _t(){}var qt=.7,q=1/qt,Zt="\\s*([+-]?\\d+)\\s*",Bt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ct=/^#([0-9a-f]{3,8})$/,ee=new RegExp("^rgb\\(".concat(Zt,",").concat(Zt,",").concat(Zt,"\\)$")),K=new RegExp("^rgb\\(".concat(Wt,",").concat(Wt,",").concat(Wt,"\\)$")),J=new RegExp("^rgba\\(".concat(Zt,",").concat(Zt,",").concat(Zt,",").concat(Bt,"\\)$")),Ct=new RegExp("^rgba\\(".concat(Wt,",").concat(Wt,",").concat(Wt,",").concat(Bt,"\\)$")),ft=new RegExp("^hsl\\(".concat(Bt,",").concat(Wt,",").concat(Wt,"\\)$")),mt=new RegExp("^hsla\\(".concat(Bt,",").concat(Wt,",").concat(Wt,",").concat(Bt,"\\)$")),lt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pt(_t,Ge,{copy:function(zt){return Object.assign(new this.constructor,this,zt)},displayable:function(){return this.rgb().displayable()},hex:jt,formatHex:jt,formatHex8:ue,formatHsl:we,formatRgb:Ne,toString:Ne});function jt(){return this.rgb().formatHex()}function ue(){return this.rgb().formatHex8()}function we(){return N(this).formatHsl()}function Ne(){return this.rgb().formatRgb()}function Ge(Tt){var zt,Oe;return Tt=(Tt+"").trim().toLowerCase(),(zt=ct.exec(Tt))?(Oe=zt[1].length,zt=parseInt(zt[1],16),Oe===6?ye(zt):Oe===3?new Gt(zt>>8&15|zt>>4&240,zt>>4&15|zt&240,(zt&15)<<4|zt&15,1):Oe===8?Vt(zt>>24&255,zt>>16&255,zt>>8&255,(zt&255)/255):Oe===4?Vt(zt>>12&15|zt>>8&240,zt>>8&15|zt>>4&240,zt>>4&15|zt&240,((zt&15)<<4|zt&15)/255):null):(zt=ee.exec(Tt))?new Gt(zt[1],zt[2],zt[3],1):(zt=K.exec(Tt))?new Gt(zt[1]*255/100,zt[2]*255/100,zt[3]*255/100,1):(zt=J.exec(Tt))?Vt(zt[1],zt[2],zt[3],zt[4]):(zt=Ct.exec(Tt))?Vt(zt[1]*255/100,zt[2]*255/100,zt[3]*255/100,zt[4]):(zt=ft.exec(Tt))?H(zt[1],zt[2]/100,zt[3]/100,1):(zt=mt.exec(Tt))?H(zt[1],zt[2]/100,zt[3]/100,zt[4]):lt.hasOwnProperty(Tt)?ye(lt[Tt]):Tt==="transparent"?new Gt(NaN,NaN,NaN,0):null}function ye(Tt){return new Gt(Tt>>16&255,Tt>>8&255,Tt&255,1)}function Vt(Tt,zt,Oe,Lt){return Lt<=0&&(Tt=zt=Oe=NaN),new Gt(Tt,zt,Oe,Lt)}function $(Tt){return Tt instanceof _t||(Tt=Ge(Tt)),Tt?(Tt=Tt.rgb(),new Gt(Tt.r,Tt.g,Tt.b,Tt.opacity)):new Gt}function ae(Tt,zt,Oe,Lt){return arguments.length===1?$(Tt):new Gt(Tt,zt,Oe,Lt==null?1:Lt)}function Gt(Tt,zt,Oe,Lt){this.r=+Tt,this.g=+zt,this.b=+Oe,this.opacity=+Lt}pt(Gt,ae,it(_t,{brighter:function(zt){return zt=zt==null?q:Math.pow(q,zt),new Gt(this.r*zt,this.g*zt,this.b*zt,this.opacity)},darker:function(zt){return zt=zt==null?qt:Math.pow(qt,zt),new Gt(this.r*zt,this.g*zt,this.b*zt,this.opacity)},rgb:function(){return this},clamp:function(){return new Gt(V(this.r),V(this.g),V(this.b),Rt(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_e,formatHex:_e,formatHex8:xe,formatRgb:X,toString:X}));function _e(){return"#".concat(Mt(this.r)).concat(Mt(this.g)).concat(Mt(this.b))}function xe(){return"#".concat(Mt(this.r)).concat(Mt(this.g)).concat(Mt(this.b)).concat(Mt((isNaN(this.opacity)?1:this.opacity)*255))}function X(){var Tt=Rt(this.opacity);return"".concat(Tt===1?"rgb(":"rgba(").concat(V(this.r),", ").concat(V(this.g),", ").concat(V(this.b)).concat(Tt===1?")":", ".concat(Tt,")"))}function Rt(Tt){return isNaN(Tt)?1:Math.max(0,Math.min(1,Tt))}function V(Tt){return Math.max(0,Math.min(255,Math.round(Tt)||0))}function Mt(Tt){return Tt=V(Tt),(Tt<16?"0":"")+Tt.toString(16)}function H(Tt,zt,Oe,Lt){return Lt<=0?Tt=zt=Oe=NaN:Oe<=0||Oe>=1?Tt=zt=NaN:zt<=0&&(Tt=NaN),new ot(Tt,zt,Oe,Lt)}function N(Tt){if(Tt instanceof ot)return new ot(Tt.h,Tt.s,Tt.l,Tt.opacity);if(Tt instanceof _t||(Tt=Ge(Tt)),!Tt)return new ot;if(Tt instanceof ot)return Tt;Tt=Tt.rgb();var zt=Tt.r/255,Oe=Tt.g/255,Lt=Tt.b/255,nt=Math.min(zt,Oe,Lt),Ft=Math.max(zt,Oe,Lt),he=NaN,yt=Ft-nt,St=(Ft+nt)/2;return yt?(zt===Ft?he=(Oe-Lt)/yt+(Oe<Lt)*6:Oe===Ft?he=(Lt-zt)/yt+2:he=(zt-Oe)/yt+4,yt/=St<.5?Ft+nt:2-Ft-nt,he*=60):yt=St>0&&St<1?0:he,new ot(he,yt,St,Tt.opacity)}function et(Tt,zt,Oe,Lt){return arguments.length===1?N(Tt):new ot(Tt,zt,Oe,Lt==null?1:Lt)}function ot(Tt,zt,Oe,Lt){this.h=+Tt,this.s=+zt,this.l=+Oe,this.opacity=+Lt}pt(ot,et,it(_t,{brighter:function(zt){return zt=zt==null?q:Math.pow(q,zt),new ot(this.h,this.s,this.l*zt,this.opacity)},darker:function(zt){return zt=zt==null?qt:Math.pow(qt,zt),new ot(this.h,this.s,this.l*zt,this.opacity)},rgb:function(){var zt=this.h%360+(this.h<0)*360,Oe=isNaN(zt)||isNaN(this.s)?0:this.s,Lt=this.l,nt=Lt+(Lt<.5?Lt:1-Lt)*Oe,Ft=2*Lt-nt;return new Gt(ie(zt>=240?zt-240:zt+120,Ft,nt),ie(zt,Ft,nt),ie(zt<120?zt+240:zt-120,Ft,nt),this.opacity)},clamp:function(){return new ot(At(this.h),Dt(this.s),Dt(this.l),Rt(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var zt=Rt(this.opacity);return"".concat(zt===1?"hsl(":"hsla(").concat(At(this.h),", ").concat(Dt(this.s)*100,"%, ").concat(Dt(this.l)*100,"%").concat(zt===1?")":", ".concat(zt,")"))}}));function At(Tt){return Tt=(Tt||0)%360,Tt<0?Tt+360:Tt}function Dt(Tt){return Math.max(0,Math.min(1,Tt||0))}function ie(Tt,zt,Oe){return(Tt<60?zt+(Oe-zt)*Tt/60:Tt<180?Oe:Tt<240?zt+(Oe-zt)*(240-Tt)/60:zt)*255}},97582:function(ke,Se,k){"use strict";k.d(Se,{CR:function(){return jt},Jh:function(){return Ct},Q_:function(){return X},XA:function(){return lt},ZT:function(){return it},_T:function(){return qt},ev:function(){return Ne},mG:function(){return J},pi:function(){return _t}});var pt=function(ot,At){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Dt,ie){Dt.__proto__=ie}||function(Dt,ie){for(var Tt in ie)Object.prototype.hasOwnProperty.call(ie,Tt)&&(Dt[Tt]=ie[Tt])},pt(ot,At)};function it(ot,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");pt(ot,At);function Dt(){this.constructor=ot}ot.prototype=At===null?Object.create(At):(Dt.prototype=At.prototype,new Dt)}var _t=function(){return _t=Object.assign||function(At){for(var Dt,ie=1,Tt=arguments.length;ie<Tt;ie++){Dt=arguments[ie];for(var zt in Dt)Object.prototype.hasOwnProperty.call(Dt,zt)&&(At[zt]=Dt[zt])}return At},_t.apply(this,arguments)};function qt(ot,At){var Dt={};for(var ie in ot)Object.prototype.hasOwnProperty.call(ot,ie)&&At.indexOf(ie)<0&&(Dt[ie]=ot[ie]);if(ot!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Tt=0,ie=Object.getOwnPropertySymbols(ot);Tt<ie.length;Tt++)At.indexOf(ie[Tt])<0&&Object.prototype.propertyIsEnumerable.call(ot,ie[Tt])&&(Dt[ie[Tt]]=ot[ie[Tt]]);return Dt}function q(ot,At,Dt,ie){var Tt=arguments.length,zt=Tt<3?At:ie===null?ie=Object.getOwnPropertyDescriptor(At,Dt):ie,Oe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")zt=Reflect.decorate(ot,At,Dt,ie);else for(var Lt=ot.length-1;Lt>=0;Lt--)(Oe=ot[Lt])&&(zt=(Tt<3?Oe(zt):Tt>3?Oe(At,Dt,zt):Oe(At,Dt))||zt);return Tt>3&&zt&&Object.defineProperty(At,Dt,zt),zt}function Zt(ot,At){return function(Dt,ie){At(Dt,ie,ot)}}function Bt(ot,At,Dt,ie,Tt,zt){function Oe(C){if(C!==void 0&&typeof C!="function")throw new TypeError("Function expected");return C}for(var Lt=ie.kind,nt=Lt==="getter"?"get":Lt==="setter"?"set":"value",Ft=!At&&ot?ie.static?ot:ot.prototype:null,he=At||(Ft?Object.getOwnPropertyDescriptor(Ft,ie.name):{}),yt,St=!1,F=Dt.length-1;F>=0;F--){var T={};for(var gt in ie)T[gt]=gt==="access"?{}:ie[gt];for(var gt in ie.access)T.access[gt]=ie.access[gt];T.addInitializer=function(C){if(St)throw new TypeError("Cannot add initializers after decoration has completed");zt.push(Oe(C||null))};var ne=(0,Dt[F])(Lt==="accessor"?{get:he.get,set:he.set}:he[nt],T);if(Lt==="accessor"){if(ne===void 0)continue;if(ne===null||typeof ne!="object")throw new TypeError("Object expected");(yt=Oe(ne.get))&&(he.get=yt),(yt=Oe(ne.set))&&(he.set=yt),(yt=Oe(ne.init))&&Tt.unshift(yt)}else(yt=Oe(ne))&&(Lt==="field"?Tt.unshift(yt):he[nt]=yt)}Ft&&Object.defineProperty(Ft,ie.name,he),St=!0}function Wt(ot,At,Dt){for(var ie=arguments.length>2,Tt=0;Tt<At.length;Tt++)Dt=ie?At[Tt].call(ot,Dt):At[Tt].call(ot);return ie?Dt:void 0}function ct(ot){return typeof ot=="symbol"?ot:"".concat(ot)}function ee(ot,At,Dt){return typeof At=="symbol"&&(At=At.description?"[".concat(At.description,"]"):""),Object.defineProperty(ot,"name",{configurable:!0,value:Dt?"".concat(Dt," ",At):At})}function K(ot,At){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(ot,At)}function J(ot,At,Dt,ie){function Tt(zt){return zt instanceof Dt?zt:new Dt(function(Oe){Oe(zt)})}return new(Dt||(Dt=Promise))(function(zt,Oe){function Lt(he){try{Ft(ie.next(he))}catch(yt){Oe(yt)}}function nt(he){try{Ft(ie.throw(he))}catch(yt){Oe(yt)}}function Ft(he){he.done?zt(he.value):Tt(he.value).then(Lt,nt)}Ft((ie=ie.apply(ot,At||[])).next())})}function Ct(ot,At){var Dt={label:0,sent:function(){if(zt[0]&1)throw zt[1];return zt[1]},trys:[],ops:[]},ie,Tt,zt,Oe=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return Oe.next=Lt(0),Oe.throw=Lt(1),Oe.return=Lt(2),typeof Symbol=="function"&&(Oe[Symbol.iterator]=function(){return this}),Oe;function Lt(Ft){return function(he){return nt([Ft,he])}}function nt(Ft){if(ie)throw new TypeError("Generator is already executing.");for(;Oe&&(Oe=0,Ft[0]&&(Dt=0)),Dt;)try{if(ie=1,Tt&&(zt=Ft[0]&2?Tt.return:Ft[0]?Tt.throw||((zt=Tt.return)&&zt.call(Tt),0):Tt.next)&&!(zt=zt.call(Tt,Ft[1])).done)return zt;switch(Tt=0,zt&&(Ft=[Ft[0]&2,zt.value]),Ft[0]){case 0:case 1:zt=Ft;break;case 4:return Dt.label++,{value:Ft[1],done:!1};case 5:Dt.label++,Tt=Ft[1],Ft=[0];continue;case 7:Ft=Dt.ops.pop(),Dt.trys.pop();continue;default:if(zt=Dt.trys,!(zt=zt.length>0&&zt[zt.length-1])&&(Ft[0]===6||Ft[0]===2)){Dt=0;continue}if(Ft[0]===3&&(!zt||Ft[1]>zt[0]&&Ft[1]<zt[3])){Dt.label=Ft[1];break}if(Ft[0]===6&&Dt.label<zt[1]){Dt.label=zt[1],zt=Ft;break}if(zt&&Dt.label<zt[2]){Dt.label=zt[2],Dt.ops.push(Ft);break}zt[2]&&Dt.ops.pop(),Dt.trys.pop();continue}Ft=At.call(ot,Dt)}catch(he){Ft=[6,he],Tt=0}finally{ie=zt=0}if(Ft[0]&5)throw Ft[1];return{value:Ft[0]?Ft[1]:void 0,done:!0}}}var ft=Object.create?function(ot,At,Dt,ie){ie===void 0&&(ie=Dt);var Tt=Object.getOwnPropertyDescriptor(At,Dt);(!Tt||("get"in Tt?!At.__esModule:Tt.writable||Tt.configurable))&&(Tt={enumerable:!0,get:function(){return At[Dt]}}),Object.defineProperty(ot,ie,Tt)}:function(ot,At,Dt,ie){ie===void 0&&(ie=Dt),ot[ie]=At[Dt]};function mt(ot,At){for(var Dt in ot)Dt!=="default"&&!Object.prototype.hasOwnProperty.call(At,Dt)&&ft(At,ot,Dt)}function lt(ot){var At=typeof Symbol=="function"&&Symbol.iterator,Dt=At&&ot[At],ie=0;if(Dt)return Dt.call(ot);if(ot&&typeof ot.length=="number")return{next:function(){return ot&&ie>=ot.length&&(ot=void 0),{value:ot&&ot[ie++],done:!ot}}};throw new TypeError(At?"Object is not iterable.":"Symbol.iterator is not defined.")}function jt(ot,At){var Dt=typeof Symbol=="function"&&ot[Symbol.iterator];if(!Dt)return ot;var ie=Dt.call(ot),Tt,zt=[],Oe;try{for(;(At===void 0||At-- >0)&&!(Tt=ie.next()).done;)zt.push(Tt.value)}catch(Lt){Oe={error:Lt}}finally{try{Tt&&!Tt.done&&(Dt=ie.return)&&Dt.call(ie)}finally{if(Oe)throw Oe.error}}return zt}function ue(){for(var ot=[],At=0;At<arguments.length;At++)ot=ot.concat(jt(arguments[At]));return ot}function we(){for(var ot=0,At=0,Dt=arguments.length;At<Dt;At++)ot+=arguments[At].length;for(var ie=Array(ot),Tt=0,At=0;At<Dt;At++)for(var zt=arguments[At],Oe=0,Lt=zt.length;Oe<Lt;Oe++,Tt++)ie[Tt]=zt[Oe];return ie}function Ne(ot,At,Dt){if(Dt||arguments.length===2)for(var ie=0,Tt=At.length,zt;ie<Tt;ie++)(zt||!(ie in At))&&(zt||(zt=Array.prototype.slice.call(At,0,ie)),zt[ie]=At[ie]);return ot.concat(zt||Array.prototype.slice.call(At))}function Ge(ot){return this instanceof Ge?(this.v=ot,this):new Ge(ot)}function ye(ot,At,Dt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie=Dt.apply(ot,At||[]),Tt,zt=[];return Tt=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),Lt("next"),Lt("throw"),Lt("return",Oe),Tt[Symbol.asyncIterator]=function(){return this},Tt;function Oe(F){return function(T){return Promise.resolve(T).then(F,yt)}}function Lt(F,T){ie[F]&&(Tt[F]=function(gt){return new Promise(function(ne,C){zt.push([F,gt,ne,C])>1||nt(F,gt)})},T&&(Tt[F]=T(Tt[F])))}function nt(F,T){try{Ft(ie[F](T))}catch(gt){St(zt[0][3],gt)}}function Ft(F){F.value instanceof Ge?Promise.resolve(F.value.v).then(he,yt):St(zt[0][2],F)}function he(F){nt("next",F)}function yt(F){nt("throw",F)}function St(F,T){F(T),zt.shift(),zt.length&&nt(zt[0][0],zt[0][1])}}function Vt(ot){var At,Dt;return At={},ie("next"),ie("throw",function(Tt){throw Tt}),ie("return"),At[Symbol.iterator]=function(){return this},At;function ie(Tt,zt){At[Tt]=ot[Tt]?function(Oe){return(Dt=!Dt)?{value:Ge(ot[Tt](Oe)),done:!1}:zt?zt(Oe):Oe}:zt}}function $(ot){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=ot[Symbol.asyncIterator],Dt;return At?At.call(ot):(ot=typeof lt=="function"?lt(ot):ot[Symbol.iterator](),Dt={},ie("next"),ie("throw"),ie("return"),Dt[Symbol.asyncIterator]=function(){return this},Dt);function ie(zt){Dt[zt]=ot[zt]&&function(Oe){return new Promise(function(Lt,nt){Oe=ot[zt](Oe),Tt(Lt,nt,Oe.done,Oe.value)})}}function Tt(zt,Oe,Lt,nt){Promise.resolve(nt).then(function(Ft){zt({value:Ft,done:Lt})},Oe)}}function ae(ot,At){return Object.defineProperty?Object.defineProperty(ot,"raw",{value:At}):ot.raw=At,ot}var Gt=Object.create?function(ot,At){Object.defineProperty(ot,"default",{enumerable:!0,value:At})}:function(ot,At){ot.default=At};function _e(ot){if(ot&&ot.__esModule)return ot;var At={};if(ot!=null)for(var Dt in ot)Dt!=="default"&&Object.prototype.hasOwnProperty.call(ot,Dt)&&ft(At,ot,Dt);return Gt(At,ot),At}function xe(ot){return ot&&ot.__esModule?ot:{default:ot}}function X(ot,At,Dt,ie){if(Dt==="a"&&!ie)throw new TypeError("Private accessor was defined without a getter");if(typeof At=="function"?ot!==At||!ie:!At.has(ot))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Dt==="m"?ie:Dt==="a"?ie.call(ot):ie?ie.value:At.get(ot)}function Rt(ot,At,Dt,ie,Tt){if(ie==="m")throw new TypeError("Private method is not writable");if(ie==="a"&&!Tt)throw new TypeError("Private accessor was defined without a setter");if(typeof At=="function"?ot!==At||!Tt:!At.has(ot))throw new TypeError("Cannot write private member to an object whose class did not declare it");return ie==="a"?Tt.call(ot,Dt):Tt?Tt.value=Dt:At.set(ot,Dt),Dt}function V(ot,At){if(At===null||typeof At!="object"&&typeof At!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof ot=="function"?At===ot:ot.has(At)}function Mt(ot,At,Dt){if(At!=null){if(typeof At!="object"&&typeof At!="function")throw new TypeError("Object expected.");var ie,Tt;if(Dt){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");ie=At[Symbol.asyncDispose]}if(ie===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");ie=At[Symbol.dispose],Dt&&(Tt=ie)}if(typeof ie!="function")throw new TypeError("Object not disposable.");Tt&&(ie=function(){try{Tt.call(this)}catch(zt){return Promise.reject(zt)}}),ot.stack.push({value:At,dispose:ie,async:Dt})}else Dt&&ot.stack.push({async:!0});return At}var H=typeof SuppressedError=="function"?SuppressedError:function(ot,At,Dt){var ie=new Error(Dt);return ie.name="SuppressedError",ie.error=ot,ie.suppressed=At,ie};function N(ot){function At(zt){ot.error=ot.hasError?new H(zt,ot.error,"An error was suppressed during disposal."):zt,ot.hasError=!0}var Dt,ie=0;function Tt(){for(;Dt=ot.stack.pop();)try{if(!Dt.async&&ie===1)return ie=0,ot.stack.push(Dt),Promise.resolve().then(Tt);if(Dt.dispose){var zt=Dt.dispose.call(Dt.value);if(Dt.async)return ie|=2,Promise.resolve(zt).then(Tt,function(Oe){return At(Oe),Tt()})}else ie|=1}catch(Oe){At(Oe)}if(ie===1)return ot.hasError?Promise.reject(ot.error):Promise.resolve();if(ot.hasError)throw ot.error}return Tt()}var et={__extends:it,__assign:_t,__rest:qt,__decorate:q,__param:Zt,__metadata:K,__awaiter:J,__generator:Ct,__createBinding:ft,__exportStar:mt,__values:lt,__read:jt,__spread:ue,__spreadArrays:we,__spreadArray:Ne,__await:Ge,__asyncGenerator:ye,__asyncDelegator:Vt,__asyncValues:$,__makeTemplateObject:ae,__importStar:_e,__importDefault:xe,__classPrivateFieldGet:X,__classPrivateFieldSet:Rt,__classPrivateFieldIn:V,__addDisposableResource:Mt,__disposeResources:N}}}]);
}());