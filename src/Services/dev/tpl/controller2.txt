<?php
namespace App\Http\Controllers\admin$namespace$;
use Echoyl\Sa\Http\Controllers\admin\CrudController;
use App\Models$namespace$\$modelname$;
$use_namesapce$

class $name$Controller extends CrudController
{
	$crud_config$
	public $cid = 0;
    public function __construct()
	{
		$this->model = new $modelname$();

		$post_parent_id = request('parent_id', 0);
        $this->default_post = [
            'parent_id' => $post_parent_id ?: $this->cid,
            'displayorder' => 0,
        ];

		$this->parse_columns = $parse_columns$;

	}

	public function index()
    {
        //修改获取分类模式 直接递归 查询数据库获取数据
		$search = [];
        $this->parseWiths($search);
        return ['success' => true, 'msg' => '', 'data' => $this->model->getChild($this->cid,[],function($val){
			$this->parseData($val, 'decode', 'list');
			return $val;
		}), 'search' => $search];
    }
	
	public function listData(&$list)
	{
		/*
		foreach($list as $key=>$val)
		{
			
		}
		*/
		return;
	}

	public function postData(&$item)
	{
		return;
	}

	/**
	 * 编辑数据时 检测数据合法性
	 *
	 * @param [type] $item
	 * @return void
	 */
	public function checkPost($item)
	{
		if(false)
		{
			return ['code'=>1,'msg'=>'信息错误，请重试'];
		}
        return;
	}

	/**
	 * 提交数据时检测数据合法性
	 *
	 * @param [type] $data
	 * @param [type] $id
	 * @return void
	 */
	public function beforePost($data,$id = 0)
	{
		if(false)
		{
			return ['code'=>1,'msg'=>'数据错误，请重试'];
		}
        return;
	}

	public function handleSearch()
	{
		$m = $this->model;

		$search = [];

		return [$m,$search];

	}

}
